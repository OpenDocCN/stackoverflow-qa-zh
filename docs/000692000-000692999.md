# StackOverflow 问答 000692000-000692999

# linux - 如何在管道中使用“tee”时将标准错误写入文件？

> ID：692000
> 
> 赞同：675
> 
> 时间：2009-03-28T01:53:04.557
> 
> 标签：linux, bash, unix, tee

我知道如何使用`tee`to 编写输出（[标准输出](https://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29)）`aaa.sh`，`bbb.out`同时仍将其显示在终端中：

```
./aaa.sh | tee bbb.out 
```

我现在如何将[标准错误](https://en.wikipedia.org/wiki/Standard_streams#Standard_error_(stderr))写入名为 的文件`ccc.out`，同时仍然显示它？

* * *

## 回答 #1

> 赞同：940
> 
> 时间：2009-03-28T07:54:59.473

我假设您仍然希望在终端上看到 STDERR 和 STDOUT。您可以寻求 Josh Kelley 的答案，但我发现`tail`在后台保留一个周围的环境会输出您的日志文件非常笨拙和笨拙。请注意您需要如何保留一个额外的 FD，然后通过杀死它来进行清理，从技术上讲，应该在`trap '...' EXIT`.

有一种更好的方法可以做到这一点，而且您已经发现了它：`tee`.

只有，而不是仅仅将它用于您的标准输出，有一个用于标准输出的三通和一个用于标准错误。你将如何做到这一点？进程替换和文件重定向：

```
command > >(tee -a stdout.log) 2> >(tee -a stderr.log >&2) 
```

让我们分解并解释一下：

```
> >(..) 
```

`>(...)`（进程替换）创建一个 FIFO 并让我们`tee`监听它。然后，它使用`>`（文件重定向）将 STDOUT 重定向到您第一个正在侦听`command`的 FIFO 。`tee`

第二个也是一样的：

```
2> >(tee -a stderr.log >&2) 
```

我们再次使用进程替换来创建一个`tee`从 STDIN 读取并将其转储到`stderr.log`. `tee`将其输入输出回 STDOUT，但由于它的输入是我们的 STDERR，我们想再次将`tee`的 STDOUT 重定向到我们的 STDERR。然后我们使用文件重定向将`command`'s STDERR 重定向到 FIFO 的输入（`tee`'s STDIN）。

见[http://mywiki.wooledge.org/BashGuide/InputAndOutput](http://mywiki.wooledge.org/BashGuide/InputAndOutput)

进程替换是你选择`bash`作为你的 shell 而不是`sh`（POSIX 或 Bourne）的额外好处之一。

* * *

在`sh`中，您必须手动执行操作：

```
out="${TMPDIR:-/tmp}/out.$$" err="${TMPDIR:-/tmp}/err.$$"
mkfifo "$out" "$err"
trap 'rm "$out" "$err"' EXIT
tee -a stdout.log < "$out" &
tee -a stderr.log < "$err" >&2 &
command >"$out" 2>"$err" 
```

* * *

## 回答 #2

> 赞同：847
> 
> 时间：2011-08-09T05:02:55.287

简单地：

```
./aaa.sh 2>&1 | tee -a log 
```

这只是将标准错误重定向到标准输出，因此 tee 回显到*日志*和屏幕。也许我错过了一些东西，因为其他一些解决方案看起来真的很复杂。

**注意：**从 Bash 版本 4 开始，您可以`|&`使用`2>&1 |`:

```
./aaa.sh |& tee -a log 
```

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2013-10-09T18:21:29.733

这对于通过 Google 找到此内容的人可能很有用。只需取消注释您想尝试的示例。当然，您可以随意重命名输出文件。

```
#!/bin/bash

STATUSFILE=x.out
LOGFILE=x.log

### All output to screen
### Do nothing, this is the default

### All Output to one file, nothing to the screen
#exec > ${LOGFILE} 2>&1

### All output to one file and all output to the screen
#exec > >(tee ${LOGFILE}) 2>&1

### All output to one file, STDOUT to the screen
#exec > >(tee -a ${LOGFILE}) 2> >(tee -a ${LOGFILE} >/dev/null)

### All output to one file, STDERR to the screen
### Note you need both of these lines for this to work
#exec 3>&1
#exec > >(tee -a ${LOGFILE} >/dev/null) 2> >(tee -a ${LOGFILE} >&3)

### STDOUT to STATUSFILE, stderr to LOGFILE, nothing to the screen
#exec > ${STATUSFILE} 2>${LOGFILE}

### STDOUT to STATUSFILE, stderr to LOGFILE and all output to the screen
#exec > >(tee ${STATUSFILE}) 2> >(tee ${LOGFILE} >&2)

### STDOUT to STATUSFILE and screen, STDERR to LOGFILE
#exec > >(tee ${STATUSFILE}) 2>${LOGFILE}

### STDOUT to STATUSFILE, STDERR to LOGFILE and screen
#exec > ${STATUSFILE} 2> >(tee ${LOGFILE} >&2)

echo "This is a test"
ls -l sdgshgswogswghthb_this_file_will_not_exist_so_we_get_output_to_stderr_aronkjegralhfaff
ls -l ${0} 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-03-28T01:57:50.160

要将 stderr 重定向到文件，将 stdout 显示到屏幕，并将 stdout 保存到文件：

```
./aaa.sh 2>ccc.out | 发球台./bbb.out
```

**编辑**：要将 stderr 和 stdout 都显示到屏幕并将两者都保存到文件中，您可以使用 bash 的[I/O 重定向](http://tldp.org/LDP/abs/html/io-redirection.html)：

```
#!/bin/bash

# Create a new file descriptor 4, pointed at the file
# which will receive stderr.
exec 4<>ccc.out

# Also print the contents of this file to screen.
tail -f ccc.out &

# Run the command; tee stdout as normal, and send stderr
# to our file descriptor 4.
./aaa.sh 2>&4 | tee bbb.out

# Clean up: Close file descriptor 4 and kill tail -f.
exec 4>&-
kill %1 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2013-02-06T19:24:21.103

换句话说，您希望将 stdout 输送到一个过滤器 ( `tee bbb.out`) 并将 stderr 输送到另一个过滤器 ( `tee ccc.out`)。除了标准输出之外，没有标准的方法可以将任何东西通过管道传输到另一个命令中，但是您可以通过处理文件描述符来解决这个问题。

```
{ { ./aaa.sh | tee bbb.out; } 2>&1 1>&3 | tee ccc.out; } 3>&1 1>&2 
```

另请参阅[如何 grep 标准错误流 (stderr)？](https://unix.stackexchange.com/questions/3514/how-to-grep-standard-error-stream-stderr)你什么[时候会使用额外的文件描述符？](https://unix.stackexchange.com/questions/18899/when-would-you-use-an-additional-file-descriptor)

在 bash（以及 ksh 和 zsh）中，但在 dash 等其他 POSIX shell 中，您可以使用[进程替换](https://stackoverflow.com/questions/692000/how-do-i-write-stderr-to-a-file-while-using-tee-with-a-pipe/692407#692407)：

```
./aaa.sh > >(tee bbb.out) 2> >(tee ccc.out) 
```

请注意，在 bash 中`./aaa.sh`，即使`tee`命令仍在执行（ksh 和 zsh 确实等待子进程），此命令也会在完成后立即返回。如果您执行类似`./aaa.sh > >(tee bbb.out) 2> >(tee ccc.out); process_logs bbb.out ccc.out`. 在这种情况下，请改用文件描述符杂耍或 ksh/zsh。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-03-28T02:00:05.490

如果使用 bash：

```
# Redirect standard out and standard error separately
% cmd >stdout-redirect 2>stderr-redirect

# Redirect standard error and out together
% cmd >stdout-redirect 2>&1

# Merge standard error with standard out and pipe
% cmd 2>&1 |cmd2 
```

信用（不是从我的头顶回答）在这里：[http ://www.cygwin.com/ml/cygwin/2003-06/msg00772.html](http://www.cygwin.com/ml/cygwin/2003-06/msg00772.html)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-01-27T18:42:02.900

如果您使用的是**zsh**，则可以使用多个重定向，因此您甚至不需要`tee`：

```
./cmd 1>&1 2>&2 1>out_file 2>err_file 
```

在这里，您只是将每个流重定向到自身*和*目标文件。

* * *

**完整示例**

```
% (echo "out"; echo "err">/dev/stderr) 1>&1 2>&2 1>/tmp/out_file 2>/tmp/err_file
out
err
% cat /tmp/out_file
out
% cat /tmp/err_file
err 
```

请注意，这需要设置`MULTIOS`选项（这是默认设置）。

> `MULTIOS`
> 
> 尝试多次重定向时执行隐式`tee`s 或s（请参阅[Redirection](http://zsh.sourceforge.net/Doc/Release/Redirection.html#Multios)）。`cat`

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-05-31T12:41:38.760

在我的例子中，一个脚本正在运行命令，同时将 stdout 和 stderr 都重定向到一个文件，例如：

```
cmd > log 2>&1 
```

我需要对其进行更新，以便在出现故障时根据错误消息采取一些措施。我当然可以删除 dup`2>&1`并从脚本中捕获 stderr，但是错误消息不会进入日志文件以供参考。虽然@lhunath 接受的答案应该做同样的事情，但它会重定向`stdout`到`stderr`不同的文件，这不是我想要的，但它帮助我想出了我需要的确切解决方案：

```
(cmd 2> >(tee /dev/stderr)) > log 
```

有了上述内容，日志将拥有两者的副本，`stdout`并且`stderr`我可以从我的脚本中捕获`stderr`而不必担心`stdout`.

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-07-31T23:01:01.083

以下将适用于进程替换不可用的 KornShell (ksh)，

```
# create a combined (standard input and standard output) collector
exec 3 <> combined.log

# stream standard error instead of standard output to tee, while draining all standard output to the collector
./aaa.sh 2>&1 1>&3 | tee -a stderr.log 1>&3

# cleanup collector
exec 3>&- 
```

这里真正的技巧是`2>&1 1>&3`在我们的例子中将标准错误重定向到标准输出并将标准输出重定向到[文件描述符](https://en.wikipedia.org/wiki/File_descriptor)3 的序列。此时标准错误和标准输出还没有结合。

实际上，标准错误（作为标准输入）被传递到`tee`它记录到的位置`stderr.log`，并重定向到文件描述符 3。

文件描述符 3 一直在记录它`combined.log`。所以`combined.log`包含标准输出和标准错误。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-11-12T11:05:59.063

就像[lhunath 很好解释的接受的答案](https://stackoverflow.com/a/692407/6862843)一样，您可以使用

```
command > >(tee -a stdout.log) 2> >(tee -a stderr.log >&2) 
```

**请注意，如果您使用 bash，您可能会遇到一些问题**。

让我以[马修-威尔科克森](https://stackoverflow.com/users/266375/matthew-wilcoxson)为例。

> 对于那些“眼见为实”的人来说，一个快速测试：
> 
> ```
> (echo "Test Out";>&2 echo "Test Err") > >(tee stdout.log) 2> >(tee stderr.log >&2) 
> ```

就个人而言，当我尝试时，我得到了这个结果：

```
user@computer:~$ (echo "Test Out";>&2 echo "Test Err") > >(tee stdout.log) 2> >(tee stderr.log >&2)
user@computer:~$ Test Out
Test Err 
```

两条消息都没有出现在同一级别。为什么`Test Out`看起来好像是我以前的命令？
提示是在一个空白行，让我认为这个过程还没有完成，当我按下`Enter`这个修复它。
当我检查文件的内容时，没关系，重定向有效。

让我们再做一次测试。

```
function outerr() {
  echo "out"     # stdout
  echo >&2 "err" # stderr
}

user@computer:~$ outerr
out
err

user@computer:~$ outerr >/dev/null
err

user@computer:~$ outerr 2>/dev/null
out 
```

再次尝试重定向，但使用此功能。

```
function test_redirect() {
  fout="stdout.log"
  ferr="stderr.log"
  echo "$ outerr"
  (outerr) > >(tee "$fout") 2> >(tee "$ferr" >&2)
  echo "# $fout content :"
  cat "$fout"
  echo "# $ferr content :"
  cat "$ferr"
} 
```

就个人而言，我有这个结果：

```
user@computer:~$ test_redirect
$ outerr
# stdout.log content :
out
out
err
# stderr.log content :
err
user@computer:~$ 
```

空行没有提示，但是看不到正常输出，stdout.log内容好像有错，只有stderr.log好像没问题。如果我重新启动它，输出可能会有所不同......

所以为什么 ？

因为，[就像这里解释的那样](https://stackoverflow.com/a/14737103/6862843)：

> 请注意，在 bash 中，此命令会在 [first command] 完成后立即返回，即使 tee 命令仍在执行（ksh 和 zsh 会等待子进程）

所以，如果你使用 bash，最好使用[这个其他答案](https://stackoverflow.com/a/14737103/6862843)中给出的更好的例子：

```
{ { outerr | tee "$fout"; } 2>&1 1>&3 | tee "$ferr"; } 3>&1 1>&2 
```

它将解决以前的问题。

现在，问题是，如何检索退出状态码？
`$?`不起作用。
我没有找到比使用`set -o pipefail`（`set +o pipefail`关闭）打开管道故障并`${PIPESTATUS[0]}`像这样使用更好的解决方案

```
function outerr() {
  echo "out"
  echo >&2 "err"
  return 11
}

function test_outerr() {
  local - # To preserve set option
  ! [[ -o pipefail ]] && set -o pipefail; # Or use second part directly
  local fout="stdout.log"
  local ferr="stderr.log"
  echo "$ outerr"
  { { outerr | tee "$fout"; } 2>&1 1>&3 | tee "$ferr"; } 3>&1 1>&2
  # First save the status or it will be lost
  local status="${PIPESTATUS[0]}" # Save first, the second is 0, perhaps tee status code.
  echo "==="
  echo "# $fout content :"
  echo "<==="
  cat "$fout"
  echo "===>"
  echo "# $ferr content :"
  echo "<==="
  cat "$ferr"
  echo "===>"
  if (( status > 0 )); then
    echo "Fail $status > 0"
    return "$status" # or whatever
  fi
} 
```

```
user@computer:~$ test_outerr
$ outerr
err
out
===
# stdout.log content :
<===
out
===>
# stderr.log content :
<===
err
===>
Fail 11 > 0 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-22T13:05:32.250

发送到标准错误 ( `STDERR`) 的编译错误可以通过以下方式重定向或保存到文件中：

重击：

```
gcc temp.c &> error.log 
```

[C 外壳](https://en.wikipedia.org/wiki/C_shell)( `csh`):

```
% gcc temp.c |& tee error.log 
```

请参阅：*[如何将编译/构建错误重定向到文件？](https://www.linuxquestions.org/questions/linux-kernel-70/how-to-redirect-compilation-build-error-to-a-file-831099/)*

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-01T21:43:29.777

感谢[lhunath](https://stackoverflow.com/questions/692000/how-do-i-write-standard-error-to-a-file-while-using-tee-with-a-pipe/692407#692407)在 POSIX 中的回答。

这是我在 POSIX 中需要正确修复的更复杂的情况：

```
# Start script main() function
# - We redirect standard output to file_out AND terminal
# - We redirect standard error to file_err, file_out AND terminal
# - Terminal and file_out have both standard output and standard error, while file_err only holds standard error

main() {
    # my main function
}

log_path="/my_temp_dir"
pfout_fifo="${log_path:-/tmp}/pfout_fifo.$$"
pferr_fifo="${log_path:-/tmp}/pferr_fifo.$$"

mkfifo "$pfout_fifo" "$pferr_fifo"
trap 'rm "$pfout_fifo" "$pferr_fifo"' EXIT

tee -a "file_out" < "$pfout_fifo" &
    tee -a "file_err" < "$pferr_fifo" >>"$pfout_fifo" &
    main "$@" >"$pfout_fifo" 2>"$pferr_fifo"; exit 
```

# cobol - COBOL 混乱

> ID：692005
> 
> 赞同：3
> 
> 时间：2009-03-28T01:55:01.150
> 
> 标签：cobol

嘿大家。我在尝试使用 COBOL 在 zOS 环境中解决的编码项目中遇到了一些麻烦。我需要读入一个文件并将它们放入一个索引表中（我知道会有少于 90 条记录）。

让我感到震惊的是，我们受项目参数的约束以使用名为“Table-Size”的变量（在声明时设置为零）。

鉴于这一切，我需要做一些类似“根据表大小发生 1 到 90 次”的事情，但我不明白如果表大小必须（据我所知）这将如何工作，因为表 -大小随着添加到表中的每个条目而增加。谁能帮我解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T04:34:37.460

听起来您主要关心的是：如果大小在运行时发生变化，编译器如何知道在数组中分配多少？

答案是它分配了*最大*的空间量（足够 90 个条目）。请注意，这是用于*工作存储*空间的。将记录写入*文件*时，仅写入相关部分。

一个例子：

```
01  TABLE-SIZE  PIC 9
01  TABLE OCCURS 1 TO 9 TIMES DEPENDING ON TABLE-SIZE
    03 FLD1  PIC X(4) 
```

`TABLE`这将为工作存储分配 36 个字符（9 乘以 4） 。如果`TABLE-SIZE`在将记录写入*文件时设置为 2，*则只会写入 8 个字符`TABLE`（当然，超出为 写入的字符`TABLE-SIZE`）。

因此，例如，如果被 占用的内存`TABLE`，`AaaaBbbbCcccDdddEeeeFfffGgggHhhhIiii`则写入文件的日期可能会缩短（包括大小）：`2AaaaBbbb`。

同样，当重新读入记录时，将从文件中填充两者`TABLE-SIZE`和相关位（仅设置大小和前两个元素）。`TABLE`

我不相信发生这种情况时未使用的`TABLE`条目会被初始化为*任何东西*。如果您需要向表中添加另一个项目，最好不要假设，并明确填充它们。

为了提高效率，您可能需要考虑将 设置`TABLE-SIZE`为`USAGE IS COMP`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T04:16:14.477

我们这里没有足够的信息，但基本的事情是在 DEPENDING ON 子句中命名的变量必须对变量组数进行计数。所以你需要类似的东西

```
01   TABLE-SIZE     PIC 99
01   TABLE OCCURS 1 TO 90 TIMES
       DEPENDING ON TABLE-SIZE
    03 FIELD-1
    03 FIELD-2 
```

等等。

请参阅[本文](http://www.3480-3590-data-conversion.com/article-cobol-occurs.html)或Publib 上的[本文。](http://publib.boulder.ibm.com/infocenter/ratdevz/v7r5/index.jsp?topic=/com.ibm.etools.cbl.win.doc/topics/tptbl27.htm)

# facebook - 如何从应用程序获取 Facebook 数据？

> ID：692010
> 
> 赞同：0
> 
> 时间：2009-03-28T01:59:00.780
> 
> 标签：facebook

我正在编写一种可视化桌面（非 Web）应用程序，只是为了好玩。
但是，理想情况下，我希望它能够从用户的 Facebook 帐户中提取信息。（当然，在获得证书之后）
这样做的最佳方法是什么？我是否应该注册一个新的“facebook 应用程序”，即使我并没有真正使它基于网络？我以前从未编写过 Facebook 应用程序。

我使用 Java 作为我的编程语言，顺便说一句。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T02:02:49.400

是的。Facebook 支持桌面应用程序，但它们必须通过特殊的身份验证机制。本质上，作为身份验证过程的一部分，用户需要通过 Web 浏览器窗口被引导至 Facebook。

以下是有关身份验证过程的文档：[http ://wiki.developers.facebook.com/index.php/Login_Desktop_App](http://wiki.developers.facebook.com/index.php/Login_Desktop_App)

这里有一个相对完善的 facebook Java 库：[http ://code.google.com/p/facebook-java-api/](http://code.google.com/p/facebook-java-api/)

如果上面的 Java 库不能满足你的需求，你可以自己构建一个实现。本质上，您需要与 Facebook REST 服务器进行交互，如页面顶部所述：http: [//wiki.developers.facebook.com/index.php/API](http://wiki.developers.facebook.com/index.php/API)

编辑：在做了更多的研究之后，我有更多的资源可以提供：这里列出了一些使用 Java 为 facebook 编写的应用程序：

[http://wiki.developers.facebook.com/index.php/Facebook_apps_written_in_Java](http://wiki.developers.facebook.com/index.php/Facebook_apps_written_in_Java)

这里甚至还有一个简洁的开源桌面应用程序：

[http://code.google.com/p/fb-photo-uploader/](http://code.google.com/p/fb-photo-uploader/)

祝你好运！

# c# - 为每个项目中的字段分配值的扩展方法？

> ID：692022
> 
> 赞同：2
> 
> 时间：2009-03-28T02:07:23.070
> 
> 标签：c#, linq, extension-methods, iqueryable

我本可以发誓已经为 Queryable 类构建了一个扩展方法，但我找不到，但也许我在想一些不同的东西。

我正在寻找类似的东西：

```
IQueryable<Entity> en = from e in IDB.Entities select e;
en.ForEach(foo => foo.Status = "Complete"); 
```

en.Foreach() 必须执行：

```
foreach(Entity foo in en){
   foo.Status = "Complete";
} 
```

这已经写了吗？如果没有，是否可以编写所述扩展方法，最好允许任何 LINQ 表和该表上的任何字段。从哪里开始是个好地方？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T07:16:02.063

基类库中没有任何内容。然而，*许多*开发人员在他们自己的公共库中都有这个，我们在[MoreLINQ](http://code.google.com/p/morelinq/)中也有。

这有点违背 LINQ 的精神，因为它都是关于副作用的——但它真的很有用，所以我认为实用主义在这里胜过教条。

需要注意的一件事 - 在您的示例中使用查询表达式确实没有意义。（这并不*完全是*多余的，但如果你不公开值也没关系。） select 在这里没有做任何有用的事情。你可以这样做：

```
IDB.Entities.ForEach(foo => foo.status = "Complete"); 
```

即使你想做一个单一的“where”或“select”，我通常会使用点表示法：

```
IDB.Entities.Where(foo => foo.Name == "fred")
            .ForEach(foo => foo.status = "Complete"); 
```

仅在它们实际上使代码更简单的地方使用查询表达式:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T02:16:31.800

```
public static void ForEach<T>(this IEnumerable<T> sequence, Action<T> action)
{
    foreach (var item in sequence)
    {
        action(item);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T02:16:07.993

List<> 上有一个 foreach。大致如下：

```
IQueryable<Entity> en = from e in IDB.Entities select e;
en.ToList().ForEach(foo => foo.status = "Complete"); 
```

# php - 我应该使用方法还是常量标志？

> ID：692023
> 
> 赞同：0
> 
> 时间：2009-03-28T02:08:19.043
> 
> 标签：php, switch-statement, if-statement

如果我有一个包含可以有多个状态的标志的数据库表，我应该这样做吗

```
if ($Object->isStateOne()) {
  // do something
}
else if ($Object->isStateTwo()) {
  // do something else
}
else if ($Object->isStateThree()) {
  // do yet something else
} 
```

或这个

```
switch ($Object->getSomeFlag()) {
  case ObjectMapper::STATE_ONE:
    // do something
    break;

  case ObjectMapper::STATE_TWO:
    // do something else
    break;

  case ObjectMapper::STATE_THREE:
    // do yet something else
    break;
} 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T02:15:43.987

当然，无论哪个有意义。

开关看起来更干净。但是，您正在检查的这个“状态”是什么？例如，如果您要翻译字符串，请使用数组。

if 具有与 switch 不同的行为。方法调用可能有副作用。但是，如果多个状态可以同时在对象上处于活动状态，则 if 会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T02:38:40.717

从 OO 的角度来看，两者都不鼓励。如果您有不同的状态，您可能想要创建一个虚拟方法，并在继承的类中覆盖它。然后基于多态性，可以避免 if 和 switch 语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T02:28:13.863

第二种选择似乎是更好的解决方案。恕我直言，与第一个解决方案的方法相伴的比较代码的难看重复对我来说将是阻碍，例如：

```
public function isStateOne() {
  if(strcmp(ObjectMapper::STATE_ONE, '1') == 0) {
      return true;
  }
}
public function isStateTwo() {
  if(strcmp(ObjectMapper::STATE_TWO, '2') == 0) {
      return true;
  }
}
public function isStateThree() {
  if(strcmp(ObjectMapper::STATE_THREE, '3') == 0) {
      return true;
  }
} 
```

当然，其他人可能不同意。我只是不喜欢用“几乎相同”的方法把类弄得乱七八糟。

# unit-testing - Rhino Mocks：“验证”与“断言”

> ID：692027
> 
> 赞同：7
> 
> 时间：2009-03-28T02:12:55.227
> 
> 标签：unit-testing, rhino-mocks

使用 Rhino Mocks 时，什么时候适合使用“VerifyAll”，什么时候应该使用“Asserts”？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T02:29:06.497

VerifyAll 和 Verify 用于检查是否调用了某些方法（并可能验证调用它们的参数）。这被认为是“基于交互的测试”，当您想要验证被测系统是否在其依赖项之一上调用方法时使用。

断言通常意味着您要确保返回的值具有正确的值。断言用于所谓的“基于状态的测试”，它本质上是在被测试系统被执行后验证它的状态。

验证一下，[看看这个](http://ayende.com/Wiki/Comparison+of+different+Rhino+Mocks+syntaxes.ashx)。

另外，区分[Mock 和 Stub](http://codebetter.com/blogs/james.kovacs/archive/2009/02/09/mocks-vs-stubs.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T03:52:37.403

我相信 VerifyAll 属于使用 RhinoMocks 的旧风格，您将有一个记录步骤和一个回放步骤，之后您将验证所有期望。在此模型中，您将在记录步骤中设置一个期望（例如，期望此方法将使用参数 x、y 和 z 等调用）。

较新版本的 RhinoMocks 引入了[Arrange-Act-Assert (AAA)](http://ayende.com/Blog/archive/2008/05/16/Rhino-Mocks--Arrange-Act-Assert-Syntax.aspx)语法作为首选模式；使用这种模式，在测试方法结束时使用断言更有意义。仍然可以使用 VerifyAllExpectations()，但我个人认为，如果您的所有断言在测试结束时都发生在一个块中，它会更容易阅读。

所以我想答案（无论如何对我来说）是个人喜好。请参阅上面的链接，其中他有几个相同测试的示例，然后选择最适合您的一个。

# c# - 有没有其他方法可以在 VB.NET 2005 或 C#.NET 2005 中创建图表

> ID：692028
> 
> 赞同：-1
> 
> 时间：2009-03-28T02:13:10.577
> 
> 标签：c#, vb.net

我在 VB.NET 2005 中做 Windows 应用程序。我想在我的项目中使用图表。我已经在这个网站上问过这个问题。但观众表示解决方案使用“MSChartControl”（但这是针对Visual Studio 2008 的。）。有没有其他方法可以在我们自己的代码中创建图表（不使用其他第三方 dll）。需要帮助。提前致谢。

西瓦库玛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T15:03:29.070

您可以使用 System.Drawing.Graphics 对象的方法自己绘制一个。这可以直接在表单的 OnPaint 覆盖/事件中完成，也可以封装在单独的组件/控件中。

```
Public Class Form1
Protected Overrides Sub OnCreateControl()
  MyBase.OnCreateControl()
  SetStyle(ControlStyles.ResizeRedraw, True)
End Sub
Protected Overrides Sub OnPaint(ByVal e As System.Windows.Forms.PaintEventArgs)
  MyBase.OnPaint(e)

  With e.Graphics
     .DrawLines(SystemPens.WindowText, New Point() { _
                New Point(60, 0), _
                New Point(60, ClientRectangle.Bottom - 60), _
                New Point(ClientRectangle.Right, ClientRectangle.Bottom - 60)})
     For y = 0 To 100 Step 15
        Dim wid = e.Graphics.MeasureString(y.ToString, Font).Width
        .DrawString(y.ToString, Font, SystemBrushes.WindowText, 60 - wid, CSng(ClientRectangle.Bottom - 60 - (y * (ClientRectangle.Size.Height - 60) / 100)))
     Next

     Dim sf As New System.Drawing.StringFormat(System.Drawing.StringFormatFlags.DirectionVertical)
     For x = 0 To 5
        Dim dateStr = DateTime.Today.AddDays(x).ToShortDateString()
        Dim xCoord As Integer = CInt(60 + (ClientSize.Width - 60) * (x + 0.5) / 6)
        Dim yBottom As Integer = ClientRectangle.Bottom - 60
        .DrawString(dateStr, Font, SystemBrushes.WindowText, xCoord, yBottom, sf)
        Dim yTop As Integer = CInt(yBottom - (CInt(Date.Today.AddDays(x).DayOfWeek) + 2) * (ClientSize.Height - 60) / 10)
        Dim bar As Rectangle = New Rectangle(xCoord, yTop, 18, yBottom - yTop)
        .FillRectangle(Brushes.LightBlue, bar)
        .DrawRectangle(SystemPens.WindowText, System.Drawing.Rectangle.Round(bar))
     Next
  End With
End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-05T14:13:36.273

有一篇关于这个主题的旧 MSDN 杂志文章。 [http://msdn.microsoft.com/en-us/magazine/cc301375.aspx](http://msdn.microsoft.com/en-us/magazine/cc301375.aspx)

您还可以查看 CodePlex 是否有任何开源 .NET 图表组件。 [http://www.codeplex.com](http://www.codeplex.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-11T17:03:57.723

javascript图表怎么样？

[http://code.google.com/p/flot/](http://code.google.com/p/flot/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-03T12:35:55.690

您可能最好使用[ZedGraph](http://zedgraph.org/wiki/index.php?title=Main_Page) ，而不是自己开发。

# common-lisp - 将制表符分隔字符串中的值添加到 plist

> ID：692030
> 
> 赞同：2
> 
> 时间：2009-03-28T02:14:56.827
> 
> 标签：common-lisp

我将如何将制表符分隔字符串中的值添加到 plist？

```
  (dolist (x *行*)
    (cl-ppcre:split "\t" x))

```

`*lines*`是从文件加载的制表符分隔字符串的列表，我想制作一个表单的 plist

```
（：a值1：b值2：c值3）

```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T04:04:19.577

```
(let ((line '("foo" "bar" "baz")))
   (loop for item in line and key in '(:a :b :c) collect key collect item))

=> (:A "foo" :B "bar" :C "baz")

(mapcan 'list '(:a :b :c) '("foo" "bar" "baz"))

=> (:A "foo" :B "bar" :C "baz") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T05:24:03.363

您应该从文件中读取这些行，CL-PPCRE:SPLIT 它们以获取列表，并逐步浏览此列表：

```
(loop
   for (key value) on (cl-ppcre:split " " "a value1 b value2 c value3") by #'cddr
   appending (list (intern (string-upcase key) (find-package :keyword))
                   value)) 
```

# python - 将类方法作为实例中的方法调用是不好的形式吗？

> ID：692040
> 
> 赞同：49
> 
> 时间：2009-03-28T02:21:05.283
> 
> 标签：python, class-method

前任。

如果我有这样的事情：

```
class C(object):
    @classmethod
    def f(cls, x):
       return x + x 
```

这将起作用：

```
c = C()

c.f(2)
4 
```

但这是不好的形式吗？我应该只打电话吗

```
C.f() 
```

或者

```
c.__class__.f() 
```

显然，这只有在 f 不与 self/cls 交互并期望它是类的情况下才有意义。

?

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-28T07:35:40.223

如果您想从实例调用类方法，您可能不需要类方法。

在示例中，由于您的最后一句话（没有 self/cls 交互），您给出的静态方法会更合适。

```
class C(object):
    @staticmethod
    def f(x):
       return x + x 
```

这样，两者兼而有之是“好形式”

```
c = C()
c.f(2) 
```

和

```
C.f(2) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-28T04:28:11.750

我不记得在类外部使用过这样的类方法，但实例方法可以在其自身上调用类方法（例如，类方法在`self.foo()`哪里`foo`）。这确保了继承按预期进行，并将调用`.foo()`正确的子类而不是基类。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-28T02:29:35.670

它主要只是令人困惑的外观。如果我在使用你的课程并看到这个，我会想知道那里还有什么其他惊喜，它看起来像是糟糕的设计。

它不仅仅是一个静态方法有什么原因吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-28T02:31:12.123

`C.f()`比 更清晰`c_instance.f()`，而且`c_instance.__class__.f()`丑陋。由于清晰和美丽是 python 社区中深受喜爱的特性，我倾向于说 Cf() 是最好的方法。

您是否有任何特殊原因甚至想以其他任何一种方式调用它？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-28T02:41:35.813

如果您已经有 C 的实例，为什么需要 f() 作为类方法？它不仅形式不好，而且通常没有必要。网上有人说：“这很糟糕，因为它给人的印象是使用了对象中的某些实例变量，但事实并非如此。”

虽然，[学习 python](http://books.google.com/books?id=nEJ-jcYF2fMC&printsec=frontcover&dq=learning+python&ei=BY_NSfCpJ4KEygSFkODeCA)的第 484 页指出，您可以以任何一种方式调用该方法，只要您传入相同的实例，它就会完全相同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-11T16:49:07.380

我遇到了这个问题，我正在从非类方法调用一些类方法（需要是类方法，以便我仍然可以引用该类），如下所示。

```
class A:
  def a(self, number):
    print("a", self, number)
    self.b(number)

  @classmethod
  def b(cls, number):
    print("b", cls, number + 1)
    cls.c(number)

  @classmethod
  def c(cls, number):
    print("c", cls, number * 2)

b = A()
b.a(3) 
```

上面的代码产生以下结果：

```
a <__main__.A object at 0x000001FAC09FE358> 3
b <class '__main__.A'> 4
c <class '__main__.A'> 6 
```

我并不是说这是最好的约定，但它不会破坏 Python 3.6 中的任何内容

# wpf - WPF 样式活动项

> ID：692049
> 
> 赞同：0
> 
> 时间：2009-03-28T02:27:47.937
> 
> 标签：wpf, custom-controls, uinavigationbar

我正在尝试在 WPF 中创建可重用的导航样式**自定义控件**，例如网站上的导航栏。它将包含指向我的应用程序中所有主要页面的链接。这个控件可以放在我的 NavigationWindow 中的所有页面之上。在页面之间提供一致的外观和感觉，例如网站。

我的问题是当前页面链接的样式与其他页面的链接不同，这样您就可以快速浏览它并查看您所在的页面。由于每个页面上的控件都是相同的，我需要告诉它哪个页面是“活动的”，并让它适当地设置该链接的样式。

我的第一个想法是简单地将 Is<Page>Active 属性放在控件上，每个页面一个，然后在页面上将相应的属性设置为 true。（或者我可以使用一个接受 Enum 值的属性，而不是拥有许多属性，无论哪种方式）

例子：

```
<local:Header IsHomePageActive="True" /> 
```

现在在我的 Header Custom Control 的控件模板中，我可以创建一个监视此属性的 DataTrigger：

```
<Style.Triggers>
  <DataTrigger Binding="{Binding RelativeSource FindAncestor, AncestorType={x:Type local:Header}}, Path=IsHomePageActive}" Value="true">
    <Setter ... />
    <Setter ... />
    <Setter ... />
  </DataTrigger>
</Style> 
```

**在所有这些背景之后，这是我的问题。** 这可行，但我将不得不为我拥有的每个页面复制该 DataTrigger 以及其中的所有 Setter，因为触发器必须直接引用仅适用于一个链接的“IsHomePageActive”属性。所以我需要为每个链接使用不同的样式，即使它描述的实际样式完全相同（我的意思是，设置器是相同的）。唯一的区别是触发器正在监视什么属性。

有没有办法做到这一点（或具有相同最终结果的东西），而不会以数百行重复的 XAML 结束？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T05:24:52.860

如何使用主/细节模式（），列表框（比如）作为主，你的页面作为细节。

然后为列表中的选定项目指定您的样式。

The page will change when a different list item is selected and it will look different to the other items.

如果您有一个依赖属性，例如 List Pages 其中 Page 继承自 UserControl 并且有一个字符串 Title 您可以使用

```
 <ListBox
                 ItemsSource="{Binding Pages}"
                 IsSynchronizedWithCurrentItem="true">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding Title}" />
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <ScrollViewer VerticalScrollBarVisibility="Auto"
                      Content="{Binding Pages/}" /> 
```

然后只需为列表框上的选定项目设置样式

# c# - 保存到 SQL 数据库？

> ID：692051
> 
> 赞同：0
> 
> 时间：2009-03-28T02:28:17.763
> 
> 标签：c#, sql, database

我制作了一个小型 SQL 数据库来保存一些关于学生的信息。我想将数据保存到数据库中。我一直在使用数据源向导来显示/管理/保存我的数据。在我需要保存之前，这一切都有效。我双击保存按钮，这是其中的代码：

```
this.Validate();
this.studentsBindingSource.EndEdit();
this.studentsTableAdapter.Update(this.studentsDataSet.FirstClass); 
```

为什么这不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T02:35:46.903

确保将关键字段设置为数据库中的主键。如果您忘记将该字段标记为主键，数据集将很好地填充，但您将无法更新。据我记得，它要么不会引发错误，要么在某些情况下错误不清楚。

# php - 如何使用 dompdf 生成目录？

> ID：692060
> 
> 赞同：5
> 
> 时间：2009-03-28T02:36:15.670
> 
> 标签：php, report, dompdf

我正在使用 php 的 dompdf 库从 HTML 模板生成 PDF 报告。在那个 html 模板中有一个部分目录。生成 PDF 时，我需要更新目录的页码。有谁知道我如何在 php 的 dompdf 库中实现这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-30T12:18:32.390

我已经在 Drupal 中实现了这一点，并且猜测它也适用于其他 php 开源和框架。我已将此代码保存在脚本标记中

```
$GLOBALS['entity_page'][] =  $pdf->get_page_number(); 
```

在存储页码的模板中。*模板扩展名为 tpl.php* 现在在模块中，在我添加了其他导出代码之后......

```
$canvas = $dompdf->get_canvas();
    $font = Font_Metrics::get_font("helvetica", "normal");
    $canvas->page_text(520, 805, "Page {PAGE_NUM}", $font, 9, array(0.4, 0.4, 0.4));

    foreach ($GLOBALS['entity_page'] as $key => $val) {
        $GLOBALS["entity_val"] = 0;
        $GLOBALS["entity_y"] = 110;
        $canvas->page_script('if($PAGE_NUM == 3 && $PAGE_NUM < 4){
                 $font = Font_Metrics::get_font("helvetica", "normal");
                 $x = 380;
                 $y = $GLOBALS["entity_y"];

                 $pdf->text($x, $y, "-------------------------".$GLOBALS["entity_page"][$GLOBALS["entity_val"]]."", $font, 12, array(0, 0, 0, 0.8));
                 $GLOBALS["entity_y"] = $GLOBALS["entity_y"] + 33;
                 $GLOBALS["entity_val"] = $GLOBALS["entity_val"] + 1;

                }');
    } 
```

$pdf->text 这部分在 y 轴位置以恒定增量添加页码。其他全局变量 entity_y 和 entity_val 用于存储值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-15T07:38:50.017

从 HTML 生成目录（使用 h1、h2、h3），我执行了以下操作：

*   首先给每个标头一个唯一的 ID（因为我们使用的是 PrinceXML），这是一个很好的做法。
*   然后创建它的 OL/LI 结构，尽管那段代码可能包含错误。

```
 $matches = null;
    $smatches = null;
    $had_headers = array();
    preg_match_all('/<h[0-9].*?>.*?<\/h[0-9]>/i', $content, $matches);
    if (!empty($matches[0]) && count($matches[0]) > 0)
    foreach ($matches[0] as $headertag) {
        preg_match('/>(.*?)<\/(h[0-9])>/i', $headertag, $smatches);

        if (!empty($smatches[1]) && count($smatches[1]) > 0) {
            $headerid = strip_tags($headertag);
            $headerid = trim(strtolower(preg_replace('/[^a-z0-9]/i', '', $headerid)));
            $smatches[2] = strtolower($smatches[2]);
            $header_depth = intval(trim(str_ireplace('h', '', $smatches[2])));

            while (in_array($headerid, $had_headers)) {
                $headerid .= '1';
            }
            $had_headers[] = $headerid;

            $content = str_replace($headertag, '<'. $smatches[2] . ' id="' . htmlentities($headerid) . '">' . $smatches[1] . '</' . $smatches[2] . '>', $content);
        }
    }

    $matches = null;
    $smatches = null;
    $toc_html = '<ol id="toc">' . "\n";
    $old_depth = 0;
    $hadfirst = false;
    preg_match_all('/<h[0-9].*?>.*?<\/h[0-9]>/i', $content, $matches);
    if (!empty($matches[0]) && count($matches[0]) > 0)
    for ($i=0; $i < count($matches[0]); $i++) {
        $headertag = $matches[0][$i];

        preg_match('/<h[0-9][^>]*?id="(.*?)".*?>(.*?)<\/(h[0-9])>/i', $headertag, $smatches);

        if (!empty($smatches[1]) && count($smatches[1]) > 0) {
            $headerid = trim($smatches[1]);
            $header_depth = intval(trim(str_ireplace('h', '', $smatches[3]))) - 1;

            // don't take heigher than h3 in TOC
            if ($header_depth > 2)
                continue;

            if ($header_depth < $old_depth) {
                $diff = $old_depth - $header_depth; //if going multiple levels up
                $toc_html .= '</li>'.str_repeat('</ol></li>', $diff);
            } elseif ($header_depth > $old_depth) {
                $toc_html .= '<ol>';
            } else {
                $toc_html .= ($hadfirst) ? '</li>' : null;
            }

            $toc_html .= '<li><a href="#' . $headerid . '">' . htmlentities(trim(strip_tags($smatches[2]))) . '</a>';

            $old_depth = $header_depth;
            $hadfirst = true;
        }
    }
    $toc_html .=  str_repeat('</li></ol>', ($old_depth + 1)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-23T07:05:05.550

你可能已经解决了这个问题？我没有使用过 dompdf，但我在 Zend_Pdf 中做了类似的事情：我为目录制作了一个空白页，然后继续创建所有其他后续页面，保留 page_number => title 的数组。最后，我返回并使用之前保存的参考更新了内容页面......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-04T12:57:32.780

我在 pdf 中创建 TOC 的想法如下：

1.  生成pdf，其中页面标题将包含随机标记而不是名称
2.  解析生成的 pdf（使用 Smalot\PdfParser）并找到包含令牌的页码
3.  生成pdf，其中用真实姓名替换令牌并找到页码。

例子：

```
$html = "<html>
<div class='toc'>
<a>Article1 ..... {article_1_num}</a>
</div>
...
<div class='article'>
    <div>{article_1_title}</div>
    <div>Article content</div>
</div>
</html>";
//prepare variables to replace in template with random token
$vars = ["{article_1_title}"=>'676TGZGHVGFTRR655R66TTFTF', "{article_1_num}"=>0];
//genetate pdf
$options = new Options();
$options->set('defaultFont', 'Courier');
$options->set('isRemoteEnabled', TRUE);
$options->set('debugKeepTemp', TRUE);
$options->set('isPhpEnabled', TRUE);
$options->set('isHtml5ParserEnabled', true);
$dompdf = new Dompdf($options);
//load html with variables replaced
$dompdf->loadHtml(strtr($html, $vars));
$dompdf->setPaper('A4');
@$dompdf->render();
//create tamporary file
$temp = tempnam(sys_get_temp_dir(), 'prefix');
$output = $dompdf->output();
//save to temporary file
file_put_contents($temp, $output);

// parse pdf 
$parser = new \Smalot\PdfParser\Parser();
$pdf = $parser->parseFile($temp);
$pages = $pdf->getPages();
$pageNum = 0;
//loop the pages and find the one with the token
foreach ($pages as $k=>$page) {
    if(strpos($page,'676TGZGHVGFTRR655R66TTFTF') !== false){
       $pageNum = $k+1;
       break;
    }
}
// remove temp file
unlink($temp);
//prepare variables with real values to replace in template
$vars = ["{article_1_title}"=>'Article no. 1', "{article_1_num}"=>$pageNum];
// generate pdf and stream it to user
$options = new Options();
$options->set('defaultFont', 'Courier');
$options->set('isRemoteEnabled', TRUE);
$options->set('debugKeepTemp', TRUE);
$options->set('isPhpEnabled', TRUE);
$options->set('isHtml5ParserEnabled', true);
$dompdf = new Dompdf($options);
//load html with variables replaced
$dompdf->loadHtml(strtr($html, $vars));
$dompdf->setPaper('A4');
@$dompdf->render();
$dompdf->stream("pdf.pdf", array('Attachment' => 0)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-12T17:49:36.103

作为对 vicky shrestha 的回答的扩展，我所拥有的目录可以扩展不止一个页面。

36 只是适合设计的任意数量的项目。

```
foreach ($GLOBALS['entity_page'] as $key => $val) {
    $GLOBALS["entity_y"] = 88;
    $GLOBALS["entity_val"]  = 0;
    $GLOBALS["entity_per_page"] = 36;
    if($val) {
        $canvas->page_script('
        if(isset($GLOBALS["entity_page"][$GLOBALS["entity_val"]])) {
            if($PAGE_NUM == $GLOBALS["entity_page_number"]){
                $x = 505;
                $y = $GLOBALS["entity_y"];
                $font = $fontMetrics->get_font("Open Sans", "Helvetica Neue", "Helvetica, Arial, sans-serif");

                $pdf->text($x, $y, $GLOBALS["entity_page"][$GLOBALS["entity_val"]]."", $font, 7, array(0, 0, 0, 1));
                $GLOBALS["entity_y"] = $GLOBALS["entity_y"] + 19;
                $GLOBALS["entity_val"] = $GLOBALS["entity_val"] + 1;
                if (($GLOBALS["entity_val"] + 1) % $GLOBALS["entity_per_page"] == 0 ) {
                    $GLOBALS["entity_page_number"] = $GLOBALS["entity_page_number"] + 1;
                    $GLOBALS["entity_y"] = 31;
                }
            }
        }');
    }
} 
```

isset 很重要，因为由于某种原因，foreach 会额外循环一次，最后你会得到一个越界异常。

# iphone - 清理 iPhone 模拟器

> ID：692064
> 
> 赞同：110
> 
> 时间：2009-03-28T02:37:21.080
> 
> 标签：iphone, xcode, ios-simulator

在为 iPhone 模拟器构建时，是否有一种简单的方法来清理 xcode 部署应用程序的目录？我有一个 sqlite 数据库，如果需要，它会在启动时复制到 Documents 文件夹中。问题是我可能会更改我的架构，但不会复制新数据库，因为一个已经存在。

理想情况下，每次我构建时，它都会破坏以前的内容。这可能吗，还是我必须手动完成？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2010-08-09T16:59:40.663

来自 Apple 开发资源：

> 要将模拟器的用户内容和设置设置为出厂状态并删除已安装的应用程序，请选择 **Device > Erase All Content and Settings**。

*（在旧版本上：iPhone 模拟器 > 重置内容和设置。）*

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-03-28T02:59:15.083

模拟器将应用程序安装到：

```
"$HOME/Library/Application Support/iPhone Simulator/User/Applications" 
```

还要检查：

```
"$HOME/Library/Developer/CoreSimulator/Devices" 
```

GUID 文件和目录与模拟器安装的应用程序相匹配。

手动删除所有这些文件/目录以从模拟器中删除所有应用程序。

我知道有一些方法可以将脚本添加到 XCode 的构建过程中。

此外，看起来 XCode 似乎更改了它在每个构建中使用的 GUID（我的应用程序所在的目录在 XCode 中的构建之间发生变化），因此尝试一直删除同一个目录是行不通的。如果您一次只在一个应用程序上工作，那么清除整个目录将是一种选择。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-08-06T11:27:21.257

我这样做的方法是在模拟器中简单地单击并按住我的应用程序的图标 - 然后当它开始摆动时单击黑色和白色 (x)。将弹出一条消息，询问您是否真的要删除，然后单击“是”。下次您构建和部署应用程序时，它将顺利使用新的 sqlite db，您不必在文件系统中四处乱窜。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-01-24T03:04:29.887

在 Mac OS X Lion 上的 iOS 5 之后，您可以尝试：

1.  创建一个名为的脚本`RemoveSimulatorApps.command`，其中包含：

    ```
    rm -rf "$HOME/Library/Application Support/iPhone Simulator/5.0/Applications/*"

    ```

2.  将此脚本保存到`PATH`.
3.  使文件可执行，例如：

    ```
    chmod +x RemoveSimulatorApps.command
    ```

## 假设

*   您可能希望从键盘收藏按钮调用它，例如在带有可编程键的 Logitech 或 Microsoft 键盘上（因此，将其保存为 .command 文件而不是 .sh）
*   你可以把 iOS 模拟器中的所有东西都搞定（如果你只是在积极地开发一个应用程序，这是理想的选择）
*   其他人的所有注释都适用于成为一个好的可升级应用程序等。（我个人觉得这很有用，但是 b/c 我有开发模式开关，可以在特定状态下重新加载数据库，我试图做一些一致的鲁棒性/错误处理）

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-09-10T14:24:19.050

这可能是矫枉过正但是..

您还可以使用菜单和“重置内容和设置...”

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-02T05:43:15.960

如果您更改了架构，您真正想做的是清除数据库。一种方法是检查你的 sqlite 表的版本，如果它已经改变，然后丢弃旧文件并使用捆绑包中的那个。

当您发布具有新架构的新版本时，寻找清理模拟器的方法无助于解决如何清理客户 iPhone 的现实问题。

另外，在确定遇到旧模式后，您可能希望在不破坏旧模式的情况下复制新数据库，并将任何有趣的数据从旧数据库中加载到新数据库中。然后吹掉旧数据库。这样，您可以保留用户对数据库的添加。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-07-24T07:09:05.233

对于 Xcode >= 6

```
xcrun simctl list | grep -oh '[A-Z0-9]\{8\}-[A-Z0-9]\{4\}-[A-Z0-9]\{4\}-[A-Z0-9]\{4\}-[A-Z0-9]\{12\}' | xargs -n1 xcrun simctl erase 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2018-09-03T08:29:45.757

如果您使用的是 Xcode 9 ->***菜单栏***->***硬件***->***擦除所有内容和设置***

[![Xcode -> 硬件 -> 擦除所有内容和设置](https://i.stack.imgur.com/p7Q5o.png)](https://i.stack.imgur.com/p7Q5o.png)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-09-10T06:49:07.717

从 Xcode 6 开始，您可以从命令行执行此操作：xcrun simctl erase

此外，iOS Simulator 应用程序（Xcode 6 版本和旧版本）有一个名为“重置内容和设置”的菜单项，可用于擦除当前启动的设备。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-09-26T10:43:25.963

这适用于 Xcode 6：

```
xcrun simctl list | grep -oh '[A-Z0-9]\{8\}-[A-Z0-9]\{4\}-[A-Z0-9]\{4\}-[A-Z0-9]\{4\}-[A-Z0-9]\{12\}' | xargs -I{} xcrun simctl erase {} 
```

对于 .bash_profile

```
alias cleansim="xcrun simctl list | grep -oh '[A-Z0-9]\{8\}-[A-Z0-9]\{4\}-[A-Z0-9]\{4\}-[A-Z0-9]\{4\}-[A-Z0-9]\{12\}' | xargs -I{} xcrun simctl erase {}" 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-10-15T18:13:03.370

从 Xcode 6 开始：

`xcrun simctl erase <sim udid>`<- 重置模拟器。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2021-03-07T02:12:45.900

终端中的以下运行将清除所有模拟器，就像您刚刚安装它们一样。

$`xcrun simctl erase all`

我在运行模拟器/xcode 之前关闭它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-09-25T15:16:57.263

**清除 Xcode 缓存；**

> Command+Option+Shift+K
> 
> 命令+Shift+K

*（同时使用它们，因为它们具有不同的功能）*

**清除派生数据内容；**

> 菜单栏 -> 窗口 -> 管理器 -> 项目 -> 选择您的项目

*右窗格显示文件夹的名称，右侧的删除按钮允许您删除所有派生数据内容。*

**清除模拟器缓存；**

> 菜单栏 -> iOS 模拟器 -> 重置内容和设置

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-08-05T13:34:07.197

正如我在[经过验证的答案](https://stackoverflow.com/a/692084/2003763)下的评论中解释的那样：

我正在测试添加和删除日历订阅。*在真实设备上，您可以在Settings*、*Accounts*中删除日历订阅，但 iOS 模拟器中不存在此菜单，我不想重置整个模拟器。

因此，我最终使用 git 对我的*Device文件夹进行***本地**版本控制，并在添加日历订阅后执行以下命令来删除它：

 *```
$ git reset HEAD --hard
$ git clean -f 
```

所以步骤是：

1.  在 iOS 模拟器上安装你的应用程序并做你必须做的事情
2.  识别您的设备`~/Library/Developer/CoreSimulator/Devices/`并`cd`对其执行操作，然后`git init`创建一个 git 存储库
3.  一旦你想保存状态，执行`git commit -a "Message"`
4.  做任何更改设置（例如：添加日历订阅）并执行测试
5.  关闭模拟器
6.  做`git reset --hard HEAD`
7.  启动模拟器，之后所做的所有更改`git commit`都消失了。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-09-15T10:39:53.047

在 XCode 中，转到 Window 菜单选项，选择 Devices，然后您可以删除不再需要的那些。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-09-16T14:59:27.957

**对于 Xcode <= 5**

我将以下内容添加到我的`~/.bash_profile`

```
alias cleansim='rm -r ~/Library/Application\ Support/iPhone\ Simulator/5.1/Applications/*' 
```

它只会破坏 sim 卡上的所有应用程序。

# delphi - 通过使用免费库（非activeX）在程序（delphi）中查看pdf

> ID：692071
> 
> 赞同：-1
> 
> 时间：2009-03-28T02:41:24.267
> 
> 标签：delphi, pdf

是否有任何开源或免费软件库可以在我的 Delphi 程序中显示 PDF 文件？

我一直在寻找一个，但其中大多数是商业的或功能不全的。

PS：此解决方案需要使用wine跨平台。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T20:33:45.237

一种可能的解决方案可能是将开源 SumatraPDF 查看器包含在您的程序中，并使用它来显示 pdf。 [http://blog.kowalczyk.info/software/sumatrapdf/index.html](http://blog.kowalczyk.info/software/sumatrapdf/index.html)

除了开源之外，SumatraPDF 的一个优点是它不需要安装。它仅包含一个 .exe，因此您可以将 .exe 粘贴到应用程序的文件夹中并调用它来显示 pdf。SumatraPDF 是一个非常简单的查看器，因此它可能是您已经看过并被拒绝为“功能不全”的查看器之一，但我不确定您是否会找到任何完美的开源解决方案.

正如其他人在从这个链接的类似线程中提出的那样，您可能会考虑使用 Gnostice 库或 WPCubed wpdfviewer 组件。您必须为这些购买开发者许可证，然后可以将它们合并到您的应用程序中，并根据需要进行部署，而无需支付运行时许可费用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T02:53:22.757

我对[这个](https://stackoverflow.com/questions/428274/displaying-pdfs-within-a-desktop-app)问题的回答讨论了 Adob​​e API。

我错过了PS。对同一问题的其他一些答案可能会有所帮助。

# database - 是否有任何团体或基金会正在开发一种算法来更好地存储大量数据？

> ID：692073
> 
> 赞同：0
> 
> 时间：2009-03-28T02:42:35.980
> 
> 标签：database, database-design

我已经研究了存储大量数据的数据库的企业架构的几种方法，通常归结为更多的硬件、数据库分片和存储 JSON 对象。是否有任何小组在进行研究，或者是否有人有更动态的方法来处理可用数据并告诉您如何更好地存储它，然后在给定新存储方法的情况下指导您如何检索它？我知道这听起来有点幻想，但我想我还是会问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T03:14:47.167

您可能会觉得这很有趣：
[http ://en.wikipedia.org/wiki/BigTable](http://en.wikipedia.org/wiki/BigTable)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T03:00:45.080

非常有趣的问题。在我看来，语义网的人们可能很快就不得不处理这个问题。在我看来，他们还拥有一些至少可以提供部分解决方案的技术。例如，查看[OWL](http://www.w3.org/TR/owl-features/)规范。

# localization - 制作本地化网站的最佳方法

> ID：692082
> 
> 赞同：9
> 
> 时间：2009-03-28T02:54:01.257
> 
> 标签：localization

将网站本地化为多语言的最佳方法是什么？

我正在开发一个网站，我们的经理希望它是这样的：

[http://www.website.com](http://www.website.com) - 默认为英语 [http://fr.website.com](http://fr.website.com) - 法语 [http://de.website.com](http://de.website.com) - 德语

他说这对 SEO 有好处，一些开发人员希望根据 cookie 和用户的接受语言来制作它，因此 url 将始终是[http://website.com](http://website.com)但内容将基于 cookie/accept-language。

你认为呢？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T03:03:31.657

这篇文章似乎对您的问题有很好的指导：[http ://www.antezeta.com/blog/domains-seo/](http://www.antezeta.com/blog/domains-seo/)

本质上，他们建议使用 TLD 进行本地化，其次是子域，然后是目录

Cookie 是个坏主意，因为 Google 将无法索引您的本地化内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-06T13:48:20.243

这可能是迟到的答案，但无论如何我都会给你（我希望它会造福其他人）。

## http://www.example.com/ 应该默认为英文吗？

不，您应该始终**检测**用户的首选语言。也就是说，Web 浏览器将为您提供带有最终用户能够理解的语言的 AcceptLanguage 标头。如果碰巧最喜欢的语言不是您的网站/Web 应用程序支持的语言，您应该尝试从 AcceptLanguage 退回到下一种语言。只有在不合适的情况下，您才应该回退到您的默认语言（通常是英语、美国）。

## 我们应该使用语言作为领域的一部分吗？

这似乎是个好主意。当您检测到语言时，您可能希望将用户重定向到适当的页面。它可能类似于[http://french.example.com/](http://french.example.com/)、[http://german.example.com/](http://german.example.com/)或[http://www.example.com/index.html?lang=fr](http://www.example.com/index.html?lang=fr)。
实现这样的机制是一件好事——在这种情况下，实际上可以为正确的语言添加书签。当然，如果有人以语言作为参数导航到您的网站，您将***跳过检测***，因为此时检测毫无意义。

## 总结一下：

您可能应该检测网络浏览器为您服务的语言，并显示为您有多个网站（每个网站一种语言）。这就是用户可以选择收藏哪一个的方式。当然，网络搜索引擎可能会单独索引内容，但他们更愿意寻找 robots.txt，所以……无论哪种方式，最好显示为几个特定于语言的网站。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T03:02:26.837

我曾经听我的一位老师说，当他这样做时，他会简单地制作名为“eng.php”“fr.php”的php文件等等......

在这些文件中是关联数组。密钥始终相同，但翻译不同。

然后，您只需要在 PHP 文件的顶部需要正确的语言文件，如果您解析密钥，它将始终使用正确的语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-22T15:27:06.420

随着副本和代码变得更加复杂，大多数本地化和全球化的开源方法都涉及大量开发人员开销和维护复杂性。

我目前的公司 Localize.js 通过跟踪网站短语变化、自动排序翻译以及为您动态呈现语言，无缝地解决了这个复杂的痛点。

[https://localizejs.com/](https://localizejs.com/)

如果您有任何问题，请随时给我发电子邮件@johnny@localizejs.com

# assembly - CPU 如何实现 MUL/MULT 等指令？

> ID：692083
> 
> 赞同：10
> 
> 时间：2009-03-28T02:54:11.350
> 
> 标签：assembly, boolean, cpu, low-level, digital-logic

在不同的汇编语言中，MUL (x86)/MULT (mips) 指的是乘法。它是程序员的黑匣子。无论架构如何，我都对 CPU 实际如何完成乘法感兴趣。假设我的寄存器中有两个 16 位值，并且我是 CPU，所以我必须使用我拥有的其他位摆弄指令（and、or、xor、not、shl、shr 等）来实现 MUL。我该怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T03:00:27.687

[Wikipedia 上的http://en.wikipedia.org/wiki/Multiplication_ALU](http://en.wikipedia.org/wiki/Multiplication_ALU)列出了在数字电路中进行乘法运算的不同方法。

早在大学时，当我在 Verilog 中为一个类似 DEC Alpha 的处理器添加 SIMD 指令的项目时，我们实现了一个[华莱士树乘法器](http://en.wikipedia.org/wiki/Wallace_tree)，主要原因是它以固定数量的周期运行并且易于流水线化。

[显然](https://stackoverflow.com/questions/26370287/how-modern-x86-processors-actually-compute-multiplications/62117473#62117473)，[Dadda 乘法器](https://en.wikipedia.org/wiki/Dadda_multiplier)（几乎？）普遍用于现实生活中的 CPU ALU，包括现代 x86。与华莱士乘法器一样，它也可以以固定延迟进行流水线化。

* * *

编辑：您提到使用其他位摆弄指令，在现代处理器上乘法不会像这样被微编码；这会变慢，处理器会在基准测试中被宰杀。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T03:07:56.933

[此页面](http://www.elo.utfsm.cl/~lsb/elo211/aplicaciones/katz/chapter5/chapter05.doc5.html)显示 4 * 4 组合多路器的逻辑门。你可以从那里开始工作。

[这是某人的实验室](http://www-unix.ecs.umass.edu/~smckenna/)，他们描述了从 4 个 4 位乘法器构建一个 16 位乘法器，每个乘法器都带有与门和全加器。完整的设计、芯片布局和仿真波形。

# programming-languages - 什么是类型推断？

> ID：692088
> 
> 赞同：3
> 
> 时间：2009-03-28T03:01:43.517
> 
> 标签：programming-languages, types, type-inference, type-systems

它只存在于静态类型语言中吗？只有当语言不是强类型时才存在（即，Java 有强类型）吗？此外，它属于哪里 - 在编译阶段假设它是一种编译语言？

一般来说，当类型不明确时，规则是由语言规范规定还是由实现决定？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T03:20:18.263

类型推断是一些静态类型语言的特性。它由编译器完成，以将类型分配给否则缺少任何类型注释的实体。编译器实际上只是代表程序员“填写”静态类型信息。

类型推断在具有许多隐式强制和歧义的语言中往往效果较差，因此大多数类型推断语言都是函数式语言，几乎没有强制、重载等方式。

类型推断是语言规范的一部分，例如 F# 规范详细介绍了类型推断算法和规则，因为这有效地确定了“什么是合法程序”。

尽管某些（大多数？）语言支持某些有限形式的类型推断（例如 C# 中的“var”），但在大多数情况下，人们使用“类型推断”来指代绝大多数类型是推断而不是显式推断的语言（例如在 F# 中，除了局部变量之外，通常还会推断函数和方法签名；与 C# 相反，C# 中的“var”允许推断局部变量，但方法声明需要完整的类型信息）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T03:11:02.183

类型推断器根据上下文确定变量的类型。它依赖于强类型来做到这一点。例如，函数式语言是非常强的静态类型的，但完全依赖于类型推断。

C# 和 VB.Net 是具有类型推断的静态类型语言的其他示例（它们提供它以使泛型可用，并且它是 LINQ 中的查询所必需的，特别是支持投影）。

动态语言不推断类型，它是在运行时发现的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T03:12:39.560

类型推断是一些静态语言中的一种折衷方案。*您可以在不指定类型的情况下声明变量，前提是可以在编译时*推断类型。它不提供潜在输入的灵活性，但您确实获得了类型安全，并且您不必编写那么多。

请参阅[维基百科文章](http://en.wikipedia.org/wiki/Type_inference)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-09T13:18:11.607

类型推断器是使用类型推断算法静态推断类型的任何东西。因此，它不仅仅是静态语言的一个特性。

您可以为动态语言或具有不安全或隐式类型转换的语言构建静态分析工具，类型推断将是其工作的主要部分。但是，对于具有不安全或动态类型系统或包含隐式转换的语言的类型推断，在一般情况下不能用于证明程序的类型安全。

因此使用了类型推断：

*   避免静态语言中的类型注释，
*   优化动态语言的编译器（即 Scheme、Self 和 Python），
*   用于动态语言的错误检查工具、编译器和安全分析。

# .net - WinForms 的“折叠”面板控件边框

> ID：692091
> 
> 赞同：1
> 
> 时间：2009-03-28T03:03:35.493
> 
> 标签：.net, winforms

WinForms 中是否有任何方法可以模拟 CSS 中的边框折叠？

想象一下：你有一个带有 FixedSingle 边框的 Panel 控件，给它一个 1px 的黑色边框，停靠在窗体的顶部。您添加第二个具有相同边框并停靠在顶部的 Panel 控件，实际上是将该 Panel 堆叠在第一个 Panel 下方。问题是，在顶部面板的底部与底部面板的顶部接触的地方，边框现在是 2px 宽（顶部面板的底部 (1px) + 底部面板的顶部 (1px) = 2px）。

我一直在弄乱面板控件属性，但我看不到任何让这些接触边缘重叠的东西，所以面板之间只有 1px 的边框。有人有想法么？

（我正在使用 Visual Basic .NET 2008）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T15:53:16.580

只需创建您自己的面板派生控件。通过按照您想要的方式绘制边框来伪造边框。例如：

```
using System;
using System.Drawing;
using System.Windows.Forms;

public class MyPanel : Panel {
  public MyPanel() {
    this.Dock = DockStyle.Top;
    this.DoubleBuffered = true;
    this.SetStyle(ControlStyles.ResizeRedraw, true);
  }
  protected override void OnPaintBackground(PaintEventArgs e) {
    base.OnPaintBackground(e);
    int y = this.ClientSize.Height - 1;
    int x = this.ClientSize.Width-1;
    e.Graphics.DrawLine(Pens.Black, 0, 0, 0, y);
    e.Graphics.DrawLine(Pens.Black, 0, y, x, y);
    e.Graphics.DrawLine(Pens.Black, x, 0, x, y);
  }
} 
```

向您的项目添加一个新类并粘贴上面显示的代码。编译。将新控件从工具箱顶部拖放到表单上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T03:10:03.670

与大多数内置控件一样，Panel 的边框属性是一种全有或全无的属性。指定 Panel 的哪一侧有边框会很方便，但可惜没有。如果您的目的是创建一个包含少量单元格的网格样式视图，您最好自己将数据（和相关的网格线）绘制到单个面板中。

# objective-c - Objective-C 内存管理——返回对象时的最佳实践？

> ID：692108
> 
> 赞同：13
> 
> 时间：2009-03-28T03:13:00.977
> 
> 标签：objective-c, memory-management

假设我有这样的功能：

```
- (NSSet *) someFunction {
    //code...
    return [[[NSSet alloc] initWithObjets:obj1, obj2, nil] autorelease];
} 
```

当我调用这个函数时，我需要保留/释放返回值吗？我假设我会。

但是，如果我不做自动释放怎么办，所以 someFunction 现在看起来像这样：

```
- (NSSet *) someFunction {
    //code...
    return [[NSSet alloc] initWithObjets:obj1, obj2, nil];
} 
```

在这种情况下，我假设我需要释放但不保留返回值。

我的问题是，对于这些情况，建议/最佳做法是什么？是否推荐使用 someFunction 的一个或另一个版本？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-28T03:38:01.887

您应该花一些时间阅读[Cocoa 的内存管理编程指南](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html)。

简而言之，如果您通过以“alloc”或“new”开头或包含“copy”的方法获取引用，则您拥有该引用并且不必保留它。您确实提供了它的发布，无论是通过直接发布还是通过使用自动发布。

如果您以任何其他方式（通过类方法或您拥有的）获得引用，则您不拥有引用，因此您不必释放。如果要保留引用，则必须保留它。

总而言之，它确实非常简单有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T03:33:53.753

唔...

通常，我遵循这种“方式”。

```
+ (id)MyObj {
  return [[[MyObj alloc] init] autorelease];
} 
```

在返回对象之前释放它，对象将在它到达调用对象之前被释放。这将产生错误。通过使用自动释放池来避免此错误。最初是由 Theocacao 的 Scott Stevenson 介绍给我的。这是他和许多 Obj-C 1.0 的首选方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T03:38:33.943

您应该执行第二个示例中的代码的唯一原因是您的方法名称是否以 new、alloc、create、copy 或类似名称开头。

否则，您有责任释放（或自动释放）您分配的任何对象。第一个例子是做大多数事情的正确方法。

如果调用函数希望它在函数范围之外持续存在，则它应该保留该值，但它随后负责在稍后的某个时间释放它。

# c - 在 C 中释放内存的模式？

> ID：692119
> 
> 赞同：5
> 
> 时间：2009-03-28T03:23:30.143
> 
> 标签：c, memory-management, free

我目前正在开发一个基于 C 的应用程序，有点坚持以非反模式方式释放内存。我是一个内存管理爱好者。

我的主要问题是我在各种不同的范围内声明内存结构，这些结构通过引用其他函数来传递。其中一些函数可能会抛出错误并退出（）。

如果我 exit() 在一个范围内，但并非所有数据结构都在该范围内，我该如何释放我的结构？

我觉得我需要将它全部包装在一个伪异常处理程序中并让处理程序处理释放，但这仍然看起来很丑陋，因为它必须知道我可能需要或可能不需要释放的所有内容......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T03:26:03.740

调用 exit() 时，您无需担心释放内存。当进程退出时，操作系统将释放所有相关的内存。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T04:08:03.140

考虑包装器`malloc`并以规范的方式使用它们。跟踪您分配的内存（可能在链表中）并使用包装器退出以枚举您的内存以释放它。您还*可以*使用附加参数和链接列表结构的成员来命名内存。在分配的内存高度依赖于范围的应用程序中，您会发现自己正在泄漏内存，这可能是转储和分析内存的好方法。

**更新：** 您的应用程序中的线程将使这非常复杂。请参阅有关线程问题的其他答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T04:23:05.850

我认为要恰当地回答这个问题，我们需要了解您的整个程序（或系统，或任何情况）的架构。

答案是：视情况而定。您可以使用多种策略。

正如其他人所指出的，在现代桌面或服务器操作系统上，您可以`exit()`不用担心程序分配的内存。

`exit()`例如，如果您在可能无法清理所有内容的嵌入式操作系统上进行开发，则此策略会发生变化。通常我看到的是，当个别函数由于错误而返回时，他们会确保清理他们自己分配的任何东西。`exit()`在调用 10 个函数之后，您将看不到任何调用。每个函数在返回时会依次指示错误，并且每个函数都会自行清理。原始`main()`函数（如果你愿意的话——它可能不会被调用`main()`）会检测到错误，清理它分配的所有内存，并采取适当的措施。

当您只有范围内的范围时，这不是火箭科学。如果您有多个执行线程和共享数据结构，则变得困难。然后，您可能需要一个垃圾收集器或一种方法来计算引用并在结构的最后一个用户完成它时释放内存。例如，如果您查看 BSD 网络堆栈的源代码，您会发现它`refcnt`在某些结构中使用（引用计数）值，这些结构需要长时间保持“活动”并在不同用户之间共享. （这基本上也是垃圾收集器所做的。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T04:13:17.293

您可以为作用域/函数之间共享的 malloc 内存创建一个简单的内存管理器。

在 malloc 时注册它，在释放它时取消注册。有一个函数可以在调用 exit 之前释放所有已注册的内存。

它增加了一些开销，但它有助于跟踪内存。它还可以帮助您查找讨厌的内存泄漏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T05:39:06.773

Michael 的建议是合理的 - 如果您要退出，则无需担心释放内存，因为系统无论如何都会回收它。

一个例外是共享内存段——至少在 System V Shared Memory 下。这些段可以比创建它们的程序持续更长时间。

到目前为止没有提到的一个选项是使用基于竞技场的内存分配方案，建立在标准之上`malloc()`。如果整个应用程序使用单个区域，您的清理代码可以释放该区域，然后立即释放所有区域。（APR - Apache Portable Runtime - 提供了一个池功能，我认为它是相似的；David Hanson 的“C 接口和实现”提供了一个基于竞技场的内存分配系统；我已经写了一个，如果你愿意，你可以使用它。）你可以将其视为“穷人的垃圾收集”。

作为一般的内存规则，每次动态分配内存时，都应该了解哪些代码将释放它以及何时可以释放它。有一些标准模式。最简单的就是“在这个函数中分配；在这个函数返回之前释放”。这可以使内存在很大程度上受到控制（如果您不在包含内存分配的循环上运行太多迭代），并对其范围进行限制，以便它可以用于当前函数及其调用的函数。显然，您必须合理地确保您调用的函数不会隐藏（缓存）指向数据的指针，并在您释放和重用内存后尝试重用它们。

下一个标准模式以`fopen()`and为例`fclose()`；有一个函数分配一个指向某个内存的指针，调用代码可以使用它，然后在程序完成它时释放它。`fclose()`但是，这通常与第一种情况非常相似——调用也调用的函数通常是一个好主意`fopen()`。

大多数剩余的“模式”都有些*临时性*。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-14T20:28:59.897

人们已经指出，如果您只是在出现错误时退出（或中止）代码，您可能不需要担心释放内存。但以防万一，这是我开发的一种模式，并在出现错误时大量使用它来创建和拆除资源。注意：我在这里展示一个模式来说明一点，而不是编写真正的代码！

```
int foo_create(foo_t *foo_out) {
    int res;
    foo_t foo;
    bar_t bar;
    baz_t baz;
    res = bar_create(&bar);
    if (res != 0)
        goto fail_bar;
    res = baz_create(&baz);
    if (res != 0)
        goto fail_baz;
    foo = malloc(sizeof(foo_s));
    if (foo == NULL)
        goto fail_alloc;
    foo->bar = bar;
    foo->baz = baz;
    etc. etc. you get the idea
    *foo_out = foo;
    return 0; /* meaning OK */

    /* tear down stuff */
fail_alloc:
    baz_destroy(baz);
fail_baz:
    bar_destroy(bar);
fail_bar:
    return res; /* propagate error code */
} 
```

我敢打赌我会得到一些评论说“这很糟糕，因为你使用了 goto”。但这是对 goto 的规范和结构化使用，如果一致应用，它会使代码更清晰、更简单且更易于维护。没有它，您将无法通过代码实现简单的、记录在案的拆卸路径。

如果您想在实际使用中的商业代码中看到这一点，请查看[MPS 中的 arena.c](http://www.ravenbrook.com/project/mps/master/code/arena.c)（巧合的是，它是一个内存管理系统）。

这是一种穷人的尝试...完成处理程序，并为您提供了一些类似于析构函数的东西。

我现在听起来像白胡子，但在我多年从事其他人的 C 代码工作时，缺乏清晰的错误路径通常是一个非常严重的问题，尤其是在网络代码和其他不可靠的情况下。介绍他们偶尔会给我带来相当多的咨询收入。

关于你的问题还有很多其他的事情要说——我只是把它留在这个模式中，以防万一有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T05:30:13.287

很简单，为什么没有引用计数的实现，所以当你创建一个对象并传递它时，你会增加和减少引用计数的数量（如果你有多个线程，请记住是原子的）。

这样，当不再使用某个对象（零引用）时，您可以安全地删除它，或者在引用计数递减调用中自动删除它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-13T06:26:43.260

这听起来像是 Boehm 垃圾收集器的任务。

[http://www.hpl.hp.com/personal/Hans_Boehm/gc/](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)

当然，取决于您是否可以或应该负担得起使用它的系统。

# c# - 如何在运行时为 ListView 传递行索引？

> ID：692120
> 
> 赞同：2
> 
> 时间：2009-03-28T03:23:34.603
> 
> 标签：c#, .net, asp.net, .net-3.5

我有一个问题，在我的页面上我有一个 ListView 控件，我还有一个具有 CommandArgument 的按钮。我知道我可以阅读并在 ListView 中找到一个控件：

```
ListView.Items[i].FindControl("controlname"); 
```

我在 ListView 中的按钮就是这样

```
 asp:Button ID="WisdomButton" runat="server" CommandName="UpdateWisdom"  CommandArgument='<%# need my index for Item[i] to post here %>' 
                                  OnCommand="UpdateWisdom" Text="Update"   /> 
```

我想在运行时将索引值添加到 CommantParameter，所以当我转到函数 onCommand 时，我会确切地知道从哪一行 [i] 我需要从 ListView 获取我的控件。

所以我的问题是，我如何在运行时将 ListView.Rows[i] 的索引动态添加到 CommmandArgument 的 Button 中？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T04:00:43.267

查看 API

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewcommandeventargs.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewcommandeventargs.aspx)

ListViewCommandEventArgs 项目有一个索引，即它已经在参数中可用

```
ListViewDataItem dataItem = (ListViewDataItem)e.Item;
int i = dataItem.DisplayIndex; 
```

但是从这里您将可以访问这些控件

```
e.Item.FindConrol("controlName"); 
```

如果您以不同的方式调用该方法，则可以通过 ItemDataBound 事件分配索引

```
void MyListView_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    ((Button)e.Item.FindControl("WisdomButton")).CommandArgument = ((ListViewDataItem)e.Item).DisplayIndex;
} 
```

或者尝试这样的笑声

```
<asp:Button runat="server" CommandArgument='<%# DisplayIndex %>'/>
// OR
<asp:Button runat="server" CommandArgument='<%# NextIndex() %>'/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T04:25:18.153

了解更多关于您正在尝试做的事情可能会有所帮助。如果您的最终目标是从绑定对象中获取任何属性，您可以从ItemCommand 事件的[ListViewCommandEventArgs中转换 dataItem。](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewcommandeventargs.aspx)您根本不需要保留索引或调用 FindControl。

这是一个如何获取绑定的 Customer 对象的示例。

**列表显示**

```
<asp:ListView runat="server" id="Customers" ItemCommand="Customers_ItemCommand">
  <LayoutTemplate>
    <ul>
      <asp:placeholder runat="server" id="itemPlaceholder" />
    </ul>
  </LayoutTemplate>
  <ItemTemplate>
    <li>
      <asp:Button runat="server" id="Select" CommandName="Select" />
      <%# Eval("Name")%>
    </li>
  </ItemTemplate>
</asp:ListView> 
```

**代码隐藏**

```
public void Page_Load()
{
  if (!Page.IsPostBack)
  {
    this.Customers.DataSource = GetCustomers();
    this.Customers.DataBind();
  }
}

public void Customers_ItemCommand(object sender, ListViewCommandEventArgs e)
{
  if (e.CommandName == "Select")
  {
    if (e.Item.ItemType != ListViewItemType.DataItem)
      return;
    var customer = ((ListViewDataItem)e.Item).DataItem as Customer;
    if (customer != null)
    {
      // Now work directly with the customer object.
      Response.Redirect("viewCustomer.aspx?id=" + customer.Id);
    }
  }
} 
```

**编辑：**此外，当您将项目转换为 ListViewDataItem 时，您还会公开 ((ListViewDataItem)e.Item)。可能对您有所帮助的[DataItemIndex属性。](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewdataitem_properties.aspx)

# html - html中的转义标签

> ID：692123
> 
> 赞同：42
> 
> 时间：2009-03-28T03:26:26.670
> 
> 标签：html, tags, escaping

什么是 html 中的转义标签？

他们`&#34;` `&#60;` `&#62;`要代表`"` `<` `>`吗？
这些是如何工作的？
那是十六进制，还是它是什么？
它是如何制作的，为什么它们不只是角色本身？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-28T03:32:49.870

以下是一些常见的[实体](http://www.w3schools.com/HTML/html_entities.asp)。您不需要使用完整的代码 - 经常使用的实体有通用别名。例如，您可以使用 < 和 > 来表示小于和大于符号。& 是和号等。

编辑：那应该是-`&lt; &gt; and &amp;`

编辑：另一个常见的字符是`&nbsp`通常用于表示`<code>`段中的选项卡

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-03-28T03:35:57.867

**这些是如何工作的？**

任何内容`&#num;`都替换为 ASCII 表中的字符，与`num`.

**那是十六进制，还是它是什么？**

它不是十六进制的，数字代表 ASCII 表中十进制的字符数。查看[ASCII 表](http://www.asciitable.com/)。检查 Dec 和 HTML 列。

**为什么他们不只是角色本身？**

看这个例子：

```
<div>Hey you can use </div> to end div tag!</div> 
```

它会弄乱解释器。这是一个不好的例子，但你明白了。

**为什么不能像编程语言那样使用转义字符？**

对此我没有确切的答案。但是与 xml 相同的 html 是一种标记语言而不是编程语言，答案可能在于标记语言如何成为现在的历史。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-28T03:31:32.137

不，它不是十六进制，而是十进制。十六进制等效值为 < 但是通常使用 < （小于）对于 < 和 > 为 > 代替。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-01-17T02:04:08.680

这是html实体的完整参考：

[完整的 HTML 实体](https://www.freeformatter.com/html-entities.html)

它用于正确的字符格式

HTML 有一组特殊字符，浏览器将其识别为 HTML 语言本身的一部分。例如，浏览器知道当它们在 HTML 代码中遇到 < 字符时，它们会将其解释为标记的开始。> 是保留字符的示例之一。因此使用 html 字符来避免任何问题并正确练习

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T03:31:53.647

这些转义是十进制 ascii 转义。您可以在[此处](http://www.asciitable.com/)查看值。查看 HTML 列。

# objective-c - 在 NSMutableArray 方法中，removeObject: vs removeObjectIdenticalTo:

> ID：692124
> 
> 赞同：14
> 
> 时间：2009-03-28T03:28:30.800
> 
> 标签：objective-c

关于 NSMutableArray，**removeObject:**和**removeObjectIdenticalTo 有什么区别：**

API 参考中的措辞似乎非常相似：

> rO：删除给定对象的接收者中的所有事件
> 
> rOIT：删除接收器中给定对象的所有出现

我错过了什么？

**更新：**我的意思是，我将如何在它们之间进行选择。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-28T03:31:53.303

`removeObjectIdenticalTo:`将删除指向的对象，`removeObject:`将对数组中的所有项目运行 a`isEqual:`并在返回 true 时将其删除。

编辑：

`removeObjectIdenticalTo:`如果你知道你有相同的对象（比如 NSViews 或类似的），你应该使用它，并且`removeObject:`对于字符串和对象，它可能不是同一个对象，但出于实际目的应该被认为是相等的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-09T09:53:02.160

@cobbal 真的很棒的答案:) 看到你的答案后，我真的明白了其中的区别。但起初我似乎并不感到困惑，因为我是 Objective-C 编程的新手，所以我只想通过提供一个例子来增强你的答案。希望其他新手在查看示例时有所帮助:)

```
#import<Foundation/Foundation.h>
int main()
{   int i;
    printf("Enter 1 to perform removeObject function.\n Enter 2 to perform removeObjectIdenticalTo functionality.\n ");
    scanf("%d",&i);
    @autoreleasepool{
    NSString* color;// int count;
    NSString * s1 = [NSMutableString stringWithString: @"Red"];
    NSString * s2 = [NSMutableString stringWithString: @"Yellow"];
    NSString * s3 = [NSMutableString stringWithString: @"Red"];
    NSString * s4 = [NSMutableString stringWithString: @"Cyan"];
    NSMutableArray * myColors = [NSMutableArray arrayWithObjects: s1,s2,s3,s4,nil];

    if(i == 1)
    {
        [myColors removeObject: s1];    //will remove both s1 and s3 object because their contents are same
//we can also use [myColors removeObject: @"Red"]; instead of above statement. However the functionality remains same . 
        for(color in myColors)NSLog(@"%@",color); 
    }

    else if (i == 2){
        [myColors removeObjectIdenticalTo: s1];  //deletes only s1 object in the array myColor  
        for(color in myColors)NSLog(@"%@",color);
    }

    }
    return 0;
    } 
```

PS：这只是一个例子。你可以在@cobbal 的回答中找到答案。

# apache-flex - BlazeDS 身份验证

> ID：692126
> 
> 赞同：8
> 
> 时间：2009-03-28T03:29:44.760
> 
> 标签：apache-flex, http, blazeds

我对使用 BlazeDS 进行身份验证感到困惑。我在 BlazeDS 中找到的用于身份验证和授权的少数示例中的大多数，因此 Java Servlet 通常使用 HTTP 基本和摘要身份验证以及授权领域。这些示例非常简单，涉及带有用户凭据的 XML 文件，而不是使用数据库。我过去在 Web 应用程序方面的经验使用基于表单的登录和会话进行身份验证和授权，但我不确定如何使用带有 BlazeDS 后端的 Flex 应用程序来做到这一点。

我想要做的是有某种方法可以访问后端的某些服务以处理诸如 HTML 表单之类的身份验证以及某种将会话数据存储在 cookie 中以进行授权的方法，但是我无法使用 BlazeDS 和 Flex 中的 cookie 找到相关详细信息应用程序。

如果使用基本身份验证或摘要身份验证的 HTTP 身份验证是最好的方法，那么是否有任何资源可以找出如何使用存储在数据库中而不是 XML 文件中的凭据来对用户进行身份验证？

我对 Web 框架并不是特别感兴趣，因为我想了解如何使用普通的 Servlet 和 BlazeDS 对用户进行身份验证/授权。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T14:29:19.557

使用 BlazeDS 和 Flex 进行身份验证与使用传统 Web 应用程序没有什么不同。Flex 使用与浏览器相同的网络堆栈。因此，只需按照说明保护您的应用服务器，它就可以正常工作。如果您想在 Flex 中使用登录表单，那么您只需将凭据发送到 j_security_check（用于基于表单的身份验证）。或者，您可以在 channelSet 上调用 login。Spring Security 和 Spring BlazeDS Integration M2 使这变得非常容易。查看[Test Drive](http://coenraets.org/blog/2009/03/springblazeds-integration-test-drive-m2-update-available/)以获得一个很好的示例（用户名和密码仍在 XML 文件中，但您可以轻松地按照 Spring 文档将它们移动到数据库或 LDAP 服务器）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T00:40:41.190

使用 Spring Security 并检查此网站[链接文本](http://www.mindtheflex.com/?p=80)。我希望它会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-15T18:15:21.193

您可能还想查看：[http ://livedocs.adobe.com/blazeds/1/blazeds_devguide/help.html?content=services_security_1.html](http://livedocs.adobe.com/blazeds/1/blazeds_devguide/help.html?content=services_security_1.html)

# silverlight-2.0 - Silverlight 2.0 VS2008 SP1 工具的最新版本是什么

> ID：692127
> 
> 赞同：0
> 
> 时间：2009-03-28T03:30:25.837
> 
> 标签：silverlight-2.0

我想开发一个silverlight 2.0 应用程序。

请问我需要为VS2008 SP1安装哪些最新版本？

马尔科姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T03:33:21.040

[适用于 Visual Studio 2008 SP1 的 Silverlight 2 工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=c22d6a7b-546f-4407-8ef6-d60c8ee221ed&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T03:37:12.870

在 SilverLight 2 工具之上。您可以考虑使用 Microsoft Expression Blend。确保您还将 Blend 更新到 SP1。Blend 对于编辑 XAML 文件非常有用。VS 2008 没有提供很好的用户界面来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T04:50:15.487

如果您真的对开始使用 silverlight 所需的一切感兴趣，请查看他们网站上的指南。这有指向 Visual Studio 的适当 Silverlight 工具的链接

[http://silverlight.net/getstarted](http://silverlight.net/getstarted)

也是 Silverlight 3.0 的最新版本（不能与 2.0 同时安装）

[http://silverlight.net/getstarted/silverlight3/default.aspx](http://silverlight.net/getstarted/silverlight3/default.aspx)

# cakephp - 模型不会更新

> ID：692135
> 
> 赞同：0
> 
> 时间：2009-03-28T03:35:29.147
> 
> 标签：cakephp, model

使用 cakephp：我正在尝试更新客户信息和客户链接的地址。这样 Customer.address_id = Address.id，并且

客户模型

```
$belongsTo = 'Address'; 
```

来自customers_controller

```
function profile($id = null)
{
  if (empty($this->data['Customer']))
  { 
    $this->Customer->id = $id;
    $this->data = $this->Customer->read();
  }
  else
  {
    $this->Customer->id = $this->data['Customer']['id'];
    $this->Customer->read();
    $this->Customer->save($this->data['Customer']);
    $this->Customer->Address->save($this->data['Address']);
  }
} 
```

客户正确更新，但地址总是插入一个新行。我如何让这个地址更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T10:21:16.597

首先，去掉第 11 和 12 行。那些没有用。确保您的视图包含 Customer.id 和 Address.id 的表单元素。如果您只是更新地址，您也不需要第 13 行。简短的回答是，如果缺少主键，Cakephp 将插入行而不是更新。在您的情况下，这意味着 [地址] [id]。

# java - Java 什么时候有 JIT 编译器？

> ID：692136
> 
> 赞同：8
> 
> 时间：2009-03-28T03:35:42.127
> 
> 标签：java, history

Java 什么时候第一次获得用于生产代码的 JIT 编译器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T03:38:50.213

[http://java.sun.com/features/2000/06/time-line.html](http://java.sun.com/features/2000/06/time-line.html)

1996 年 10 月 25 日 Sun 发布了第一个用于 Java 平台的即时 (JIT) 编译器

此外，来自维基百科：自 JRE 1.2 版以来，Sun 的 JVM 实现包括一个即时编译器而不是解释器。 [http://en.wikipedia.org/wiki/Java_(Sun)](http://en.wikipedia.org/wiki/Java_(Sun))

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-28T04:03:56.567

Borland 拥有第一个，紧随其后的是 Symantec。Sun 获得了赛门铁克的许可。赛门铁克在 1996 年 3 月演示了他们的产品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T03:38:47.547

我相信 HotSpot 在 1.3 中首次亮相，尽管它可以作为 1.2 的插件使用。

更多信息请访问[http://en.wikipedia.org/wiki/HotSpot](http://en.wikipedia.org/wiki/HotSpot)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-28T03:40:41.457

定义生产 :) Hotspot 有 JIT。

# php - PHP5：为什么 try/catch 失败？

> ID：692144
> 
> 赞同：1
> 
> 时间：2009-03-28T03:40:18.073
> 
> 标签：php, exception, xampp, try-catch

在我的 XAMPP/Win XP 构建中，PHP5.2.3 无法捕获任何异常。这些[示例](http://www.php.net/manual/en/language.exceptions.php)都不起作用，并且：

```
try {
    throw new Exception('Fail');
} catch (Exception $e) {
    echo 'Succeed';
} 
```

...结果是：

> **致命错误**：M:\path\to\test.php:4 中未捕获的异常 'Exception' 和消息 'Fail' 堆栈跟踪：#0 {main}在第**4** 行的**M:\path\to\test.php中抛出**

 **PHP 的所有错误设置似乎都是标准的。服务器是 Apache/2.2.4

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T04:10:18.313

这取决于**eAccelerator**在 XAMPP 中的构建。有一次，它在[优化 try/catch 语句时遇到了麻烦](http://eaccelerator.net/ticket/242)，只是忽略了它们。

问题出在 0.9.5 中。XAMPP 目前与 eAccelerator 0.9.5.3 捆绑在一起，但默认情况下它是禁用的。所以这可能不是你的问题。

根据[ChangeLog](http://www.apachefriends.org/winxampp/xampp-changes.txt)，XAMPP 已经很久没有使用 PHP 5.2.3 和 Apache 2.2.4 了，这也是 eAccelerator 漏洞出现的时候。我建议检查您的 eAccelerator 版本并可能升级 XAMPP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T04:11:03.677

我得到“成功”作为运行脚本的输出，无论是在命令行上独立运行，还是通过网络服务器上的 apache 以及 XAMPPLITE 运行。不知道你的设置有什么不同

# c# - 如何在字符串类型的元素上具有属性

> ID：692147
> 
> 赞同：1
> 
> 时间：2009-03-28T03:44:11.323
> 
> 标签：c#, xml-serialization

如果我有

```
[XmlElement(ElementName = "Title")]
public string Title; 
```

我如何在标题中包含一个属性而不声明一个类（它的类型只是一个字符串）？这样当我使用 XML 序列化程序进行序列化时，输出是这样的：

```
<Movie>
  <Title x:uid="movie_001">Armagedon</Title>
  <Date>010101</Date>
<Movie> 
```

而不是这样：

```
<Movie>
  <Title x:uid="movie_001" MovieTile="Armagedon"\>
  <Date>010101</Date>
<Movie> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T04:07:02.487

如果没有 Title 是自定义类型或显式实现序列化方法，我认为这是不可能的。

你可以像这样做一个自定义类..

```
class MovieTitle
{
    [XmlText]
    public string Title { get; set; }
    [XmlAttribute(Namespace="http://www.myxmlnamespace.com")]
    public string uid { get; set; }
    public override ToString() { return Title; }
}

[XmlElement(ElementName = "Title")]
public MovieTitle Title; 
```

这应该产生：

```
<Title x:uid="movie_001">Armagedon</Title> 
```

尽管序列化器可以用未知的命名空间做一些有趣的事情。

您可以通过声明命名空间并将对象提供给序列化程序来避免奇怪的行为。

```
 XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
  ns.Add("x", "http://www.myxmlnamespace.com"); 
```

# delphi - 与构建配置相关的 Delphi 2007（或 2009）构建事件？

> ID：692152
> 
> 赞同：4
> 
> 时间：2009-03-28T03:54:05.310
> 
> 标签：delphi, delphi-2007

是否可以仅为 Delphi 2007 中的特定构建配置添加构建事件？

我使用 2007 年，但也会对您在 2009 年可以做什么感兴趣。

干杯山姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-26T11:50:45.303

是的！

因为您可以在每个构建配置中有单独的定义。您可以检查项目定义的条件构建处理。

我使用类似的东西：

```
echo $(DEFINES) | find "RELEASE"> nul
if not errorlevel 1 goto
release

echo $(DEFINES) | find "DEBUG" > nul
if not errorlevel 1 goto debug

goto end

:release
echo Processing RELEASE Build:
...
goto end

:debug
echo Processing DEBUG Build:
..
goto end

:end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T19:56:44.053

不。

您可以在 Delphi 2009 中为每个构建配置设置（资源）编译器设置。但这不适用于其他设置。

您可以伪造它，但这需要一些时间：

1.  在预构建中，删除 conf*.dcu 文件。
2.  为调试配置定义 DEBUG。
3.  将以下内容添加到项目文件中：

代码：

```
uses
  ..
{$IFDEF DEBUG}
  confDebug,
{$ELSE}
  confRelease,
{$ENDIF}
  .. 
```

1.  现在让构建后步骤检查是否存在 confDebug.dcu 或 confRelease.dcu 以查找使用了哪个构建配置。

这有点麻烦，但你可以做你想做的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-14T21:13:15.767

试试这个：

```
if $(Config) == Release do_something 
```

[在这里](http://codeverge.com/embarcadero.cppbuilder.ide/build-event/1069002)你可以找到一些额外的信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-31T22:19:29.220

使用 XE 时，如果您有兴趣，我将其范围缩小到更简单的范围：

```
goto $(Config)

:Release
compil32 /cc f:\dev\MyProject\Installer\MyProject.iss"
etc.

:Debug 
```

只有当我将构建配置设置为发布时，它才会构建我的安装程序。如果你想变得更高级，你可以打电话给 Jenkins，让它接管预发布任务。在 Delphi 10.x 中，您不再需要这个技巧了。

# asp.net - System.Web.UI.WebControls.Calendar 是否可以更改单个选择的颜色？

> ID：692154
> 
> 赞同：1
> 
> 时间：2009-03-28T03:55:31.343
> 
> 标签：asp.net, controls, calendar

我有代码可以在日历控件中进行多项选择，但我想将最初选择的日期的颜色更改为绿色，将结束日期更改为红色。从视觉上看，这将指示要提供的特定服务的开始日期和结束日期。我应该为我的日历研究 RenderControl 方法还是更多地研究在控件中设置某些日期的属性？

多选代码归功于 [Steve Wellins](http://weblogs.asp.net/SteveWellens/)

```
protected void Calendar1_SelectionChanged(object sender, EventArgs e)
    {
        System.Web.UI.WebControls.Calendar TheCalendar = sender as System.Web.UI.WebControls.Calendar;

        // create new list of dates or get stored list of dates
        List SelectedDates;

        if (ViewState["SelectedDates"] == null)
            SelectedDates = new List();
        else
            SelectedDates = ViewState["SelectedDates"] as List;

        // if date is already in list, remove it, otherwise, add it
        if (SelectedDates.Contains(TheCalendar.SelectedDate) == false)
            SelectedDates.Add(Calendar1.SelectedDate);
        else
            SelectedDates.Remove(Calendar1.SelectedDate);

        // set the calendar to our list of dates
        TheCalendar.SelectedDates.Clear();
        foreach (DateTime Date in SelectedDates)
            TheCalendar.SelectedDates.Add(Date);

        // store list for next postback
        ViewState["SelectedDates"] = SelectedDates;
    } 
```

* * *

此代码可能会覆盖应用于日历的任何日期或格式，但我不能将这种格式保存和恢复到日历。

* * *

```
foreach (DateTime Date in SelectedDates)
                TheCalendar.SelectedDates.Add(Date); 
```

如果您指出正确的路径或要搜索的术语，我很高兴研究潜在客户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T04:55:38.623

从 MSDN 站点，Calendar..::.OnDayRender 方法在每一天被渲染时被调用。我是一个 .NET 菜鸟......如何使用它？

# c# - 如何正确序列化

> ID：692156
> 
> 赞同：0
> 
> 时间：2009-03-28T03:57:03.213
> 
> 标签：c#, xml-serialization

如果我有一个类 MovieClass

```
[XmlRoot("MovieClass")]
public class Movie
{
   [XmlElement("Novie")]
   public string Title;

   [XmlElement("Rating")]
   public int rating; 
} 
```

如何在我的“电影”元素中有一个属性“x：uid”，以便使用时的输出`XmlSerializer XmlSerializer s = new XmlSerializer(typeof(MovieClass))`如下所示：

```
<?xml version="1.0" encoding="utf-16"?>
<MovieClass>
   <Movie x:uid="123">Armagedon</Movie>
</MovieClass> 
```

而不是这样

```
<?xml version="1.0" encoding="utf-16"?>
<MovieClass xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <Movie x:uid="123" Title="Armagedon"/>
</MovieClass> 
```

注意：`xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"`如果可能的话，我想要删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T04:19:22.817

我在您的原始帖子中回答了这个问题，但我认为这个措辞更好，所以我也会在这里发布，如果它被关闭为重复，您可以修改您的原始帖子以反映这个问题。

如果没有 Title 是自定义类型或显式实现序列化方法，我认为这是不可能的。

你可以像这样做一个自定义类..

```
class MovieTitle
{
    [XmlText]
    public string Title { get; set; }
    [XmlAttribute(Namespace="http://www.myxmlnamespace.com")]
    public string uid { get; set; }
    public override ToString() { return Title; }
}

[XmlRoot("MovieClass")]
public class Movie
{
   [XmlElement("Movie")]
   public MovieTitle Title;
} 
```

这将产生：

```
<MovieClass xmlns:x="http://www.myxmlnamespace.com">
  <Movie x:uid="movie_001">Armagedon</Movie>
</MovieClass> 
```

尽管序列化程序会以您可能不会想到的结果来补偿未知名称空间。

您可以通过声明命名空间并将对象提供给序列化程序来避免奇怪的行为。

```
 XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
  ns.Add("x", "http://www.myxmlnamespace.com"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T04:55:13.727

如果您没有将 x 声明为命名空间前缀，则它不是有效的 XML。Quintin 的回复告诉您如何获取有效的 XML。

# php - 你能把脚本标签放在php标签之间吗？

> ID：692157
> 
> 赞同：0
> 
> 时间：2009-03-28T03:57:16.097
> 
> 标签：php, javascript, jquery, forms

在表单在推送提交后验证用户输入后，我正在尝试使用 jquery 使 div 淡出。我试图避免表单在验证之前淡出，以防用户没有输入正确的信息。

我想知道我是否可以在我的 php 标签之间添加脚本标签，这样一旦验证完成，我就可以快速运行 javascript，然后使用其余的 php，如下所示：

```
<?php

    $name = trim($_POST['name']);
    $email = $_POST['email'];
    $comments = $_POST['comments'];

    $site_owners_email = 'zeckdude@gmail.com'; // Replace this with your own email address
    $site_owners_name = 'Chris Seckler'; // replace with your name

    if (strlen($name) < 2) {
        $error['name'] = "Please enter your name";  
    }

    if (!preg_match('/^[a-z0-9&\'\.\-_\+]+@[a-z0-9\-]+\.([a-z0-9\-]+\.)*+[a-z]{2}/is', $email)) {
        $error['email'] = "Please enter a valid email address"; 
    }

    if (strlen($comments) < 3) {
        $error['comments'] = "Please leave a comment.";
    }

    if (!$error) {

        require_once('phpMailer/class.phpmailer.php');
        $mail = new PHPMailer();

        $mail->From = $email;
        $mail->FromName = $name;
        $mail->Subject = "Website Contact Form";
        $mail->AddAddress($site_owners_email, $site_owners_name);
        $mail->AddAddress('zeckdude@gmail.com', 'Chris Seckler');
        $mail->Body = $comments;

        $mail->Send();
?>

<script type="text/javascript">
   $(function(){
      $('#container').fadeOut(1000);
   });
</script>

<?php 
        echo "<li class='success'> Congratulations, " . $name . ". We've received your email. We'll be in touch as soon as we possibly can! </li>";
        echo nl2br("<b>Message Sent:</b>

         From: $name

         Email: $email

         Message: $comments

         <br/><a href='http://www.google.com'>Link</a>");

    } # end if no error
    else {

        $response = (isset($error['name'])) ? "<li>" . $error['name'] . "</li> \n" : null;
        $response .= (isset($error['email'])) ? "<li>" . $error['email'] . "</li> \n" : null;
        $response .= (isset($error['comments'])) ? "<li>" . $error['comments'] . "</li>" : null;

        echo $response;
    } # end if there was an error sending

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T04:00:48.273

是的，但你的结果不会是你想要的。

PHP 在文档发送到客户端（用户）之前全部执行。Javascript 在客户端收到文档后执行。

不太相关的评论：您的脚本很容易通过 POST 受到跨站点脚本 (XSS) 的攻击。在解决此问题之前，请勿在真实站点上使用它。

您可以完成您可能打算做的事情的一种方法是让您的 php 代码的第二部分在隐藏的 div 中呈现 html 内容`<div id='content' style="display:none">...other content...</div>`。然后，在淡出完成后的javascript中，使用javascript清除div中的display：none属性使其出现。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T04:01:35.247

为什么不试试呢？您已经编写了代码。从我在您的代码中看到的内容来看，您应该可以毫无问题地做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T04:03:41.747

不，这肯定不会按照您想要的方式工作 - 您的 php 脚本与浏览器没有那种亲密的交互，并且无法返回并使现有表单以这种方式执行其他操作。一旦 php 开始产生输出并发送页眉，它就是一个全新的网页，你不能只是让旧网页消失。

您可能应该考虑查看[jquery forms plugin](http://malsup.com/jquery/form/)。然后，您可以使用 ajax 提交表单，并使活动表单可见。一旦您从 ajax 提交成功返回，*然后*淡化表单并继续下一步

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T04:16:58.047

实际上，我只是尝试了上面向您展示的代码，并且效果很好。至少看起来不错。这是现场直播：[示例表格](http://www.idea-palette.com/official2/formtest/contact_form/index.php)

我现在要做的是让最后回显的消息真正淡入而不是突然出现。

我认为乔治·德格林的回答，

> 让您的 php 代码的第二部分在隐藏的 div 中呈现 html 内容。

```
<div id='content' style="display:none">
   ...other content...
</div> 
```

> 然后，在淡出完成后的javascript中，使用javascript清除div中的display：none属性使其出现。

很可能会为此工作。

# asp.net - 使用 Web 服务作为 .NET 中数据访问层的接口

> ID：692159
> 
> 赞同：0
> 
> 时间：2009-03-28T03:59:26.890
> 
> 标签：asp.net, .net, web-services, interface

我目前正在为学校做一个[CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)项目，基本上他们希望我们有这种结构（3 个项目）：

*   类库

    *   包含所有数据访问逻辑（使用标准 ADO.NET 的 LINQ 从数据库中检索数据）。
*   网络服务

    *   具有对类库的引用并提供从类库访问方法的 [WebMethod]
*   ASP.NET 网站

    *   拥有对 Web 服务的服务引用并使用 WebMethods 检索数据

这基本上意味着我们不能直接从网站访问类库：

```
Website
       \
        \
         Web Service
                    \
                     \
                      Class Library 
```

* * *

当然，现在有多种解决方案可供选择，以在 Web 服务中提供抽象以分离例如检索文章的方法和检索类别的方法（它们是两个不同的实体，在类库中有两个单独的类）：

*   我可以做一个包含所有方法（GetAllArticles、GetAllCategories、GetArticleByID 等）的 Web 服务，并且该网站只引用这个 Web 服务。但这当然会导致所有方法都在一个类中（即一个 Web 服务）
*   或者我可以创建多个 Web 服务（`Articles.asmx`等`Categories.asmx`）并从网站上引用所有这些服务，然后根据我需要检索的数据调用我需要的服务。

但我的意思是，上述解决方案并不是很理想，因为如果我有第一个解决方案，我将在一个类中拥有大量方法（没有任何抽象），而在第二个解决方案中，我将不得不参考大约 10 个与网站不同的 Web 服务（一种用于文章，一种用于类别等）

在学校，他们告诉我们使用 Web 服务（或 Web 服务）来访问类库，然后使用 Web 方法从类库中检索数据，但是我前面提到的两种解决方案似乎都有些狡猾。

* * *

有没有更好的方法来实现这个结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T04:05:44.987

在您的示例中，您建议为文章提供一项服务，为类别建议一项服务。这当然可能只是一个示例，但在这种情况下，将它们分开是没有意义的，因为查询和/或例程同时使用类别数据和文章数据是很可能和常见的。

考虑到这一点，通常最有意义的做法是按照它们彼此相关的程度对它们进行分组。如果您可以将所有可能的例程分成三个几乎没有重叠的干净组，那么拥有三个服务是有意义的。如果您不能清楚地分离任何例程，则应将自己限制为一个 Web 服务。

但是关于您的陈述“没有抽象”是一项网络服务的缺点 - 这不一定是真的。您始终可以在 Web 服务*背后*创建抽象层，以便服务类本身只是一个具有许多瘦方法调用的外观，这些方法调用会在其他地方进入更庞大的逻辑。

最后，唯一真正重要的方法是，因为它是唯一有效的方法：**采用最简单的方法，*只*构建您需要构建的层，尽可能少；仅当您遇到无法以**比增加复杂性更好的方式解决的问题时才增加复杂性。增加复杂性总是比消除复杂性更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T04:52:56.120

我会把所有的 webmethods 放到同一个类中。webmethods 应该只是您业务类的包装器以及您需要的任何输入验证和授权。

由于 Web 服务通常由机器而不是人类使用，因此没有迫切需要层次结构。如果您为每个业务类创建一个 webmethod 类，那么管理 URL 和 Web 服务器可能会成为一种负担。

如果您计划使用浏览器自动生成的 HTML 页面来调用您的 Web 服务作为您的主要用户界面，您需要小心一点。例如，如果您需要对请求进行身份验证，您将无法依赖 SOAP 标头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T02:15:24.633

为什么不使用 ADO.Net 数据服务？

# asp.net-mvc - Html.RouteLink 被破坏？

> ID：692164
> 
> 赞同：0
> 
> 时间：2009-03-28T04:03:14.587
> 
> 标签：asp.net-mvc

为什么这段代码会产生这些结果？

代码：

```
 <%@ Control Language="C#" 
            Inherits="System.Web.Mvc.ViewUserControl< RoomsAlive.ViewModels.ProductCatalogViewModel >" %>

<div id="product_nav">
    <ul>
    <%--ADD PREV TAB--%>
    <% if (Model.HasPreviousPage) %>
    <% { %>
        <li><%= Html.RouteLink("<<", "CatalogMenu", new { controller = "Catalog", action = "Index", style = (Model.GroupName), position = (Model.PageIndex - 1) })%></li>
    <% } %>
    <%--LOOP HERE--%>
    <%  foreach (RoomsAlive.Models.ProductMenuView myFPV in Model.ProductMenu)
        { %>
        <li><%= Html.RouteLink(myFPV.Name, "CatalogMenu", new { controller = "Catalog", action = "Index", group = Model.GroupName })%></li>
    <%  } %>
    <%--ADD NEXT TAB--%>
    <% if (Model.HasNextPage) %>
    <% { %>
        <li><%= Html.RouteLink(">>", "CatalogMenu", new { controller = "Catalog", action = "Index", position = (Model.PageIndex + 1) })%></li>
    <% } %>
    </ul>
</div> 
```

结果：

```
<div id="product_nav">
    <ul>
        <li><a href="">LifeStyle</a></li>
        <li><a href="">Rooms</a></li>
    </ul>
</div> 
```

顺便说一句：如果我使用 <% %> 表单而不是 <%= %> 表单，它会产生以下结果：

```
<div id="product_nav">
    <ul>
        <li></li>
        <li></li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T18:13:23.443

为什么要在 Actionlink 的对象部分指定控制器和操作？

这样做不是最好的吗：

```
<%= Html.RouteLink("<<", "Index", "Catalog", new { style = Model.GroupName, position = (Model.PageIndex - 1) }, null)%> 
```

ActionLink 的第二个属性始终是所需的操作名称，您将其设置为 CatalogMenu，但随后您将创建一个显示“索引”的对象。出于这个原因（因为我不知道你想要“CatalogMenu”是什么），我把它拿出来了。

另请注意 routeValues 对象后的 null。这是因为 Html.ActionLink 的 10 个构造函数，这个最适合：

```
ActionLink(LinkText, ActionName, ControllerName, RouteValues, HtmlAttributes) 
```

此外，如果您使用 <% ... %> 而不是 <%= ... %>，则不会输出链接。这是因为 ActionLink 返回一个字符串。标签中的所有'='实际上都是一个Response.Write。

希望这能解释它。

# c# - 要求在 C# 中存在静态方法

> ID：692171
> 
> 赞同：1
> 
> 时间：2009-03-28T04:06:25.203
> 
> 标签：c#, generics, static, methods, constraints

给定一组具有一组通用属性和方法以支持给定域逻辑的对象，是否有一种方法可以强制在这些对象上存在某些静态方法？

我得出的结论是，实现接口并不能实现这一点（方法只是实例），并且不能将静态方法标记为覆盖、虚拟或抽象。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T04:11:24.253

不。

（注意：在 F# 中，您可以使用“内联”函数和“^”类型（例如，对于所有类型 T，其中 T 具有返回“int”的静态方法 ToInt(T)）来表达此类约束。编译器有效地自动扩展每个调用站点到特定类型。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T04:12:06.127

强制类型具有静态成员的唯一方法是从它继承。所有类型都将具有静态成员，如果您需要在派生类型上覆盖它们，您可以使用“new”关键字：

```
static void Main(string[] args)
{
    Console.WriteLine(Base.Hello());
    Console.WriteLine(Derived.Hello());
    Console.Read();
    /* output will be:
    Hello
    World
    */
}

public class Base
{
    public static object Hello()
    {
        return "Hello";
    }
}

public class Derived : Base
{
    public static new object Hello()
    {
        return "World";
    }
} 
```

它与抽象/覆盖并不完全相同，但从消费者的角度来看，工作方式类似。

# javascript - 用户按下提交后，如何显示带有选择的确认厚框？

> ID：692172
> 
> 赞同：0
> 
> 时间：2009-03-28T04:06:44.220
> 
> 标签：javascript, jquery, user-interface, modal-dialog

如何显示带有表单信息的确认模式对话框，以便用户可以确认他们在表单中选择的内容，并且只有在用户这样说的情况下才提交？

```
confirm.$("#submit-button").click( function(){
    if (validator.form()==true) {
        tb_show("Countdown", "are_you_sure.html?height=100&width=200&modal=true", "");
    //some check here maybe?    
    }
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T04:21:52.437

tb_show 可以显示一个隐藏的 DIV，所以最好的方法是用您希望用户确认的内容填充该 div，然后简单地显示它。DIV 可以保持一个“是”按钮，单击该按钮执行实际提交

```
<script>
$('#confirmDiv').html("Are you sure you want to...");
tb_show("Countdown", "#TB_inline?height=100&width=200&inlineId=confirmDiv");
...

<body>
...
<div id='confirmDiv' style='display:none'></div> 
```

# delphi - 相互使用的类的循环引用问题

> ID：692173
> 
> 赞同：1
> 
> 时间：2009-03-28T04:06:45.030
> 
> 标签：delphi, custom-component, circular-dependency, delphi-units

我有以下两个课程：

```
TcmTPDataPanel = class(TcmTPBasePanel)
    Database: TnxDatabase;
    Session: TnxSession;
  private
    FDataConnector: TcmTPDataConnector;
    MyNxDataBase: TnxDatabase;
    MyNxSession: TnxSession;
    MyRefNxDataBase: TnxDatabase;
  protected
    procedure Disconnect; virtual; abstract;
    procedure Refresh; virtual;
    procedure Requery; virtual; abstract;
  public
    procedure Connect;
  published
    property DataConnector: TcmTPDataConnector read FDataConnector write
        FDataConnector;
  end;

TcmTPDataConnector = class(TComponent)
  private
    FDatabase: TnxDatabase;
    FObservers: TList;
    FTableForCategories: TnxTable;
    FTableForItemCategoryLinks: TnxTable;
    FTableForItems: TnxTable;
    procedure SetTableForItemCategoryLinks(const Value: TnxTable);
  protected
    procedure IterateObservers;
  public
    constructor Create;
    destructor Destroy; override;
    procedure Register(Instance: TcmTPDataPanel);
    procedure Unregister(Instance: TcmTPDataPanel);
  published
    property Database: TnxDatabase read FDatabase write FDatabase;
    property TableForCategories: TnxTable read FTableForCategories write
        FTableForCategories;
    property TableForItemCategoryLinks: TnxTable read
        FTableForItemCategoryLinks write SetTableForItemCategoryLinks;
    property TableForItems: TnxTable read FTableForItems write FTableForItems;
  end; 
```

TcmDataPanel 是（第 3 代）TFrame 后代。它不是直接使用的，而是从它衍生出的多个其他复合组件。

TcmDataConnector 是一个保存这些其他组件的数据库连接信息的组件。

我正在使用 ModelMaker，并正在尝试实现观察者模式，以便在“数据连接器”更改状态时自动更新多个“数据面板”。

这是我的问题：我似乎无法解决“循环引用”问题，因为每个类在接口部分都使用另一个。将相关的“使用”引用放在“接口”部分并不能解决“未声明的标识符”问题，并且将它们放在同一个单元中也不会。现在它们在同一个单元中（我已经在单独的单元中尝试过它们，并且一起尝试过），并且我收到“未声明的标识符：TcmTPDataConnector”错误。

我怎样才能解决这个问题？

================
更新：

现在是周五晚上 9:30 晚上我所在的地方，我完全被困住了。在我发帖后几分钟，你们拯救了这一天！！（晚上！）谢谢！

伙计，我喜欢 StackOverflow ......所以我的朋友在这个疯狂的学习季节。： ） 谢谢你，谢谢你，谢谢你...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T04:14:56.197

在同一单元上，尝试以下操作：

```
TcmTPDataConnector = class(TComponent);

TcmTPDataPanel = class(TcmTPBasePanel)
   ... 
end;

TcmTPDataConnector = class(TComponent)
  ...
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T08:54:50.110

另一种选择是使用接口，但我认为在这种情况下它会被过度设计。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T04:17:08.327

两种选择：

1）将它们放在同一个单元中，其中的相同类型块。转发声明TcmTPDataConnector，声明其他类型再声明。（见 jcinacio 的帖子）

2) 创建一个 TcmTPDataConnector 的祖先，其中包含需要在外部可用的内容，并使您的引用成为那个。这更令人头疼，但允许您跨多个单元执行此操作。

# asp.net - 大文件上传到 asp.net MVC

> ID：692184
> 
> 赞同：20
> 
> 时间：2009-03-28T04:15:35.307
> 
> 标签：asp.net, asp.net-mvc, swfupload, chunking, neatupload

我需要一种在 asp.net mvc 网站上上传大文件（600 mb 到 4 gb）的方法。目前我正在使用[swfupload](http://blog.codeville.net/2008/11/24/jquery-ajax-uploader-plugin-with-progress-bar/)；它工作得很好，但它对网络服务器造成了巨大的打击，因为它通过一次大上传发送它，而且我必须在 web.config 中设置它以允许这么大的文件，这是一个巨大的安全风险。过去，当我进行 Web 表单开发时，我使用[Neatupload](http://www.brettle.com/neatupload)将文件分成块并单独上传。我正在寻找一种在 mvc 中上传大文件的方法，该文件通过分块上传。关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-19T13:04:35.767

[Silverlight 文件上传](http://www.codeplex.com/SilverlightFileUpld)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-20T20:00:02.390

我最终使用[Darren Johnstone 的 ASP.NET 文件上传模块](https://web.archive.org/web/20100729094033/http://darrenjohnstone.net/2008/07/15/aspnet-file-upload-module-version-2-beta-1)来处理服务器端的上传。虽然我稍微修改了它，以便它可以在查询字符串上使用一个 guid，它将临时文件保存到该 guid 名称。

这很好，因为它在文件到达服务器时保存了文件，并将文件从发布的数据中剥离出来，然后将其发送到指定的控制器上的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-18T16:16:40.957

我认为的例子：

```
<input id="FileGUID" name="FileGUID" type="hidden" value="f632c00b-9b66-4716-8075-79df63b780fb" />
    <input type="file" id="FileUpload1" name="fileUpload1" />

    <script type="text/javascript">
        var UploadUrl = '/Video/AsyncUpload?FileGUID=f632c00b-9b66-4716-8075-79df63b780fb';
        $(function() {
            $("#FileUpload1").makeAsyncUploader({
                upload_url: UploadUrl,
                flash_url: '/Content/Flash/swfupload.swf',
                button_image_url: '/Content/Images/blank-button.png',
                button_text: '<font face="Helvetica, Arial" size="13pt" color="#ffffff">Upload File</font>',
                disableDuringUpload: 'input[type="submit"]',
                file_size_limit: '8024 MB',
                button_text_top_padding: 2
            });
        });
    </script> 
```

然后在此页面的实际保存操作中，我查找一个文件，其中 asyncupload 操作将根据 FileGUID 保存文件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-09T01:22:38.547

可以在[此处](http://blog.appsoftware.com/2014/03/aspnet-file-uploader-with-signalr.html)找到 SignalR 实现示例。

这还包括使用 HttpContext.Request.GetBufferlessInputStream() 的功能，它允许您在完全上传之前开始处理发布数据。

# javascript - POST 请求 (Javascript)

> ID：692196
> 
> 赞同：23
> 
> 时间：2009-03-28T04:30:36.207
> 
> 标签：javascript, html, post

如何在不使用表单且不回发的情况下用 Javascript 发出简单的 POST 请求？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2014-08-21T09:26:05.400

虽然我从@sundeep 答案中获取了代码示例，但为了完整起见，在这里发布代码

```
var url = "sample-url.php";
var params = "lorem=ipsum&name=alpha";
var xhr = new XMLHttpRequest();
xhr.open("POST", url, true);

//Send the proper header information along with the request
xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

xhr.send(params); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T05:09:46.970

您可以使用 AJAX 调用（XMLHttpRequest 对象）来执行此操作

[http://www.openjs.com/articles/ajax_xmlhttp_using_post.php](http://www.openjs.com/articles/ajax_xmlhttp_using_post.php)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-21T10:12:42.510

我制作了一个功能，**无需刷新页面**、无需打开页面且**无需 AJAX**即可发送请求。该过程对用户是不可见的。我使用错误的 iframe 发送请求：

```
/**
* Make a request without ajax and without refresh the page
* Invisible for the user
* @param url string
* @param params object
* @param method string get or post
**/
function requestWithoutAjax( url, params, method ){

    params = params || {};
    method = method || "post";

    // function to remove the iframe
    var removeIframe = function( iframe ){
        iframe.parentElement.removeChild(iframe);
    };

    // make a iframe...
    var iframe = document.createElement('iframe');
    iframe.style.display = 'none';

    iframe.onload = function(){
        var iframeDoc = this.contentWindow.document;

        // Make a invisible form
        var form = iframeDoc.createElement('form');
        form.method = method;
        form.action = url;
        iframeDoc.body.appendChild(form);

        // pass the parameters
        for( var name in params ){
            var input = iframeDoc.createElement('input');
            input.type = 'hidden';
            input.name = name;
            input.value = params[name];
            form.appendChild(input);
        }

        form.submit();
        // remove the iframe
        setTimeout( function(){ 
            removeIframe(iframe);
        }, 500);
    };

    document.body.appendChild(iframe);
} 
```

现在你可以做到了：

```
requestWithoutAjax('url/to', { id: 2, price: 2.5, lastname: 'Gamez'}); 
```

看看如何工作！： http: [//jsfiddle.net/b87pzbye/10/](http://jsfiddle.net/b87pzbye/10/)。

# oracle - Oracle 空字符串

> ID：692202
> 
> 赞同：7
> 
> 时间：2009-03-28T04:35:30.563
> 
> 标签：oracle, orm, varchar2

你们如何使用 Oracle 处理空字符串？

**语句#1**：Oracle 在“varchar2”字段中将空字符串（例如''）视为NULL。
**声明 #2**：我们有一个定义抽象“表结构”的模型，其中我们有字段，**不能**为 NULL，但**可以**为“空”。该模型适用于各种 DBMS；几乎在所有地方，一切都很好，但不是 Oracle。您只是不能将空字符串插入“非空”字段。
**声明#3**：在我们的例子中不允许非空的默认值。

那么，有人会这么好心地告诉我 - 我们如何解决它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T04:41:20.970

这就是为什么我一直不明白 Oracle 为何如此受欢迎的原因。他们实际上并没有遵循 SQL 标准，这是基于他们多年前做出的一个愚蠢决定。

Oracle 9i SQL Reference 指出（这至少存在三个主要版本）：

> Oracle 当前将长度为零的字符值视为空值。但是，在未来的版本中，这可能不会继续存在，Oracle 建议您不要将空字符串视为与 null 相同。

但他们没有说*你*应该做什么。我发现解决此问题的唯一方法是：

*   有一个不能出现在您的真实数据中的标记值来表示 NULL（例如，姓氏字段的“脱氧核糖核酸”，并希望电影明星不要开始给他们的孩子起奇怪的姓氏和奇怪的名字 :-)。
*   有一个单独的字段来指示第一个字段是否有效，基本上是真实数据库对 NULL 所做的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T05:27:06.897

我们是否可以说“在支持标准 SQL 行为之前不支持 Oracle”？在许多方面，这似乎是最不痛苦的方式。

如果您不能强制（使用）单个空格，或者可能是 Unicode 零宽度不间断空格 (U+FEFF)，那么您可能必须全力以赴并使用诸如 32 Z 之类的不合理的东西来表示数据应该是空白的，但不是因为使用的 DBMS 是 Orrible。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T10:56:56.987

Oracle中的空字符串和NULL是一回事。您希望允许空字符串但不允许 NULL。

您在表上放置了 NOT NULL 约束，这与非空字符串约束相同。如果你去掉那个约束，你会失去什么？

# c# - 你如何使用 C# 编写一个简单的屏幕共享程序？

> ID：692207
> 
> 赞同：1
> 
> 时间：2009-03-28T04:39:04.250
> 
> 标签：c#, remote-desktop

我有兴趣尝试在 C# 中创建屏幕共享程序。[我在 Windows 桌面共享 API ( http://blogs.msdn.com/ts/archive/2007/03/08/windows-desktop-sharing-api.aspx](http://blogs.msdn.com/ts/archive/2007/03/08/windows-desktop-sharing-api.aspx) )上找到了一篇博文，但我不确定如何甚至开始使用它。有没有人可以分享一个简单的例子（最好是在 C# 或 VB.net 中）如何使用这个 API 或使用不同的方法？...还是不实用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T06:54:16.110

此[链接](http://www.teknoportal.gen.tr/english/technology_news.asp?haber=385)可能会让您朝着正确的方向开始。它有一些用 vb.net 编写的示例代码，请查看。

# cron - 如何在 cron 中运行 php 脚本

> ID：692208
> 
> 赞同：4
> 
> 时间：2009-03-28T04:39:36.137
> 
> 标签：cron, php

我发现了很多关于这个的问题和文章，但我仍然有一些困难。我正在使用以下命令 /usr/bin/php home/domain.com/public_html/cron/script.php 我收到以下错误状态：404 Not Found X-Powered-By: PHP/5.2.8 Content-type ：文本/html

未指定输入文件。

我正在使用 Cpanel，该文件托管在 domain.com/cron/script.php Anyideas，谢谢：p

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-28T04:44:58.887

在脚本名称上放一个前导斜杠，即

```
/usr/bin/php /home/domain.com/public_html/cron/script.php 
```

除非您真的打算通过网络运行脚本，如 lacqui 的回答，*并且*您不介意随机的第三方能够随时运行它，否则您没有理由将它放在您的 public_html 目录中；恰恰相反。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-28T04:42:24.273

尝试：

```
wget -O - http://domain.com/cron/script.php 
```

看看你是否能得到更好的结果。

编辑：添加“- O -”以不将输出写入主文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T05:08:00.530

您可能需要使用称为 php-cli 的二进制文件，而不仅仅是 php。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T18:44:15.267

我意识到这是一个老问题，您可能已经找到了解决方案，但上面的答案都没有帮助我，而且当我运行 cron 脚本时，我遇到了同样的 404 错误。

问题与编写 php 脚本路径的方式有关。路径必须像这样从 public_html 开始`/usr/bin/php public_html/public/index.php`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-09T09:18:14.707

在几个共享主机`wget`和`curl`命令中，cron 不可用。如果想要执行`web (http)`来自 cron 的请求，那么可以通过在 cron php 脚本中调用所需的 web url 作为 php curl 来完成。

下面是要放入 cron php 文件中的示例代码：

```
<?php
function callRemoteHttp($url)
{

    $curl = curl_init();    

    curl_setopt($curl, CURLOPT_URL, $url);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);

    $result = curl_exec($curl);
    $ret_arr = array('data' => $result, 'status_code' => curl_getinfo($curl, CURLINFO_HTTP_CODE));
    curl_close($curl);

    return $ret_arr;
}
$ret = callRemoteHttp('http://example.com?param1=value1&param2=value2');
?> 
```

# asp.net - 在论坛中插入代码

> ID：692209
> 
> 赞同：0
> 
> 时间：2009-03-28T04:39:44.047
> 
> 标签：asp.net

如果我们在 asp.net 论坛中插入代码，我们必须在代码中添加任何额外的标签来显示？因为有很多方面我的代码没有出现问题，但如果我们要编辑问题，代码就会出现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T04:44:02.430

查看论坛帮助...大多数论坛允许在块中定义某种类型的内联代码，例如 SO 中的“代码示例”前标记：

```
void main()
{
    printf("Hello World\n");
    return;
} 
```

如果您专门讨论的是 Microsoft 的 ASP.NET 论坛，请单击代码按钮（如下所示： [alt text http://forums.asp.net/tiny_mce/jscripts/tiny_mce/plugins/sourcecode/images/code.gif](http://forums.asp.net/tiny_mce/jscripts/tiny_mce/plugins/sourcecode/images/code.gif)）并将您的代码粘贴到弹出的窗口中。该网站将为您完成所有 HTML 标签翻译。

# c# - 在 C# 中创建 Outlook 投票按钮和跟踪响应？

> ID：692221
> 
> 赞同：1
> 
> 时间：2009-03-28T04:49:16.487
> 
> 标签：c#, outlook

使用 C# 2.0 我想：

1.  在 Outlook 邮件消息中添加投票按钮并发送。
2.  跟踪响应。

我可以看到一些参考资料来阅读邮件内容，因此可能会进行跟踪，但是如何实现投票按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T18:10:36.560

您必须将此 VB 代码翻译成 c#

`ActiveInspector.CurrentItem.VotingOptions = "Yes;No;Maybe"`

为了进行跟踪，您必须参考使用投票选项发送的电子邮件。

```
 for i = 1 to ActiveInspector.CurrentItem.Recipients.Count
    if ActiveInspector.CurrentItem.TrackingStatus = olTrackingReplied then
        debug.Print ActiveInspector.CurrentItem.Recipients(i).AutoResponse 
    endif
next 

```

编辑：这里`ActiveInspector.CurrentItem`指的是与投票按钮一起发送的 MailItem 实例。您可以通过使用引用 的变量来优化此代码， `ActiveInspector.CurrentItem`并在代码中使用该变量。

# c# - 就实际应用而言，C、C# 和 C++ 之间有什么区别？

> ID：692225
> 
> 赞同：43
> 
> 时间：2009-03-28T04:51:32.537
> 
> 标签：c#, c++, c, comparison

正如我之前[在这里](https://stackoverflow.com/questions/388156/what-web-oriented-language-should-i-learn-after-php)发布的那样，我决定尝试其中一个，但鉴于我作为 Web 开发人员的兴趣，我想知道它们在实际应用程序中的区别。

**编辑说明：**

虽然我是一名网络开发人员，但请不要让这限制你的答案。我已经 30 岁了……我已经有多年的职业生涯改变了。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-03-28T09:11:27.233

请记住，我说的是[ASFAC++B](http://www.earwicker.com/asfacppb.html)。:) 我把最重要的差异化因素放在首位。

**垃圾收集**

垃圾收集 (GC) 是区分这些语言的最重要因素。

虽然 C 和 C++ 可以与 GC 一起使用，但它是事后才想到的，不能很好地工作（[最著名的是这里](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)）——它必须是“保守的”，这意味着它不能收集所有未使用的内存。

C# 从一开始就被设计为在 GC 平台上工作，标准库也以这种方式设计。它对开发人员的生产力产生了绝对根本的影响，必须经历过才能相信。

C/C++ 用户普遍认为 GC 等同于“糟糕的性能”。但这是过时的民间传说（即使是 C/C++ 上的 Boehm 收集器也比大多数人预期的要好得多）。典型的恐惧是程序停止的“长时间停顿”，以便 GC 可以做一些工作。但实际上，这些长时间的停顿发生在非 GC 程序上，因为它们运行在虚拟内存系统之上，该系统偶尔会中断以在物理内存和磁盘之间移动数据。

人们还普遍认为 GC 可以替换为[shared_ptr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/shared_ptr.htm)，但它不能；具有讽刺意味的是，在多线程程序中，`shared_ptr`它比基于 GC 的系统慢。

有些环境非常节俭，以至于 GC 不实用——但这些环境越来越少见。手机通常有 GC。C# 通常在其上运行的 CLR 的 GC 似乎是最先进的。

自从大约 18 个月前采用 C# 以来，我已经经历了几个使用分析器进行纯性能调整的阶段，GC 非常高效，在程序运行过程中几乎不可见。

GC 不是万能的，它不能解决所有的编程问题，它只是真正清理内存分配，如果你分配非常大的内存块，那么你仍然需要小心，它仍然可能有什么相当于一个足够复杂的程序中的内存泄漏——然而，GC 对生产力的影响使它非常接近于灵丹妙药！

**未定义的行为**

C++ 建立在未定义行为的概念之上。也就是说，语言规范定义了语言特征的某些狭义用法的结果，并将所有其他用法描述为导致*未定义的行为*，这意味着原则上该操作可能有任何结果（实际上这意味着难以诊断涉及显然是非确定性数据损坏的错误）。

几乎所有关于 C++ 的内容都涉及未定义的行为。即使是非常好的即将出现的特性，如 lambda 表达式，也可以很容易地用作破坏堆栈的便捷方式（通过引用捕获本地，允许 lambda 实例比本地更长寿）。

C# 建立在所有可能的操作都应该具有定义的行为的原则之上。可能发生的最坏情况是抛出异常。这彻底改变了软件构建的体验。

（有不安全模式，它具有指针，因此具有未定义的行为，但强烈建议不要将其用于一般用途 - 将其视为类似于嵌入式汇编语言。）

**复杂**

就复杂性而言，必须将 C++ 单独挑出来，特别是如果我们考虑到即将标准化的新版本。C++ 绝对尽其所能使自己有效，而不是假设 GC，因此它有一个很棒的学习曲线。语言设计者通过说“这些功能仅适用于库作者，而不是普通用户”来原谅这一点 - 但要在任何语言中真正有效，您需要将代码构建为可重用的库。所以你无法逃脱。

从积极的方面来说，C++ 非常复杂，就像书呆子的游乐场！我可以向您保证，学习如何将它们组合在一起会很有趣。但我不能认真推荐它作为主流平台上富有成效的新工作（哦，浪费的岁月......）的基础。

C 使语言保持简单（在“编译器易于编写”的意义上简单），但这使得编码技术更加神秘。

请注意，并非所有新的语言功能都等同于增加的复杂性。一些语言特性被描述为“语法糖”，因为它们是编译器为您扩展的简写。这是考虑近年来 C# 的大量改进的好方法。语言标准甚至通过将翻译指定为普通形式来指定某些功能，例如`using`将语句扩展为`try`/ `finally`。

在某一时刻，可以以同样的方式考虑 C++ 模板。但是它们已经变得如此强大，以至于它们现在形成了语言的一个完整独立维度的基础，拥有自己[热情的用户社区和习语](http://www.boost.org/doc/libs/1_38_0/libs/mpl/doc/index.html)。

**图书馆**

C 和 C++ 最奇怪的是它们没有标准的可互换形式的预编译库。将其他人的代码集成到您的项目中总是有点繁琐，要做出关于如何链接到它的模糊决定。

此外，标准库非常基础——C++ 有一套完整的数据结构和一种表示字符串 ( `std::string`) 的方法，但这仍然是最小的。是否有在目录中查找文件列表的标准方法？令人惊讶的是，不！是否有用于解析或生成 XML 的标准库支持？不。访问数据库怎么样？严肃点！写一个网站后端？你疯了吗？等等

所以你必须去更远的地方打猎。对于 XML，请尝试[Xerces](http://projects.apache.org/projects/xerces_c++_xml_parser.html)。但它是`std::string`用来表示字符串的吗？当然不是！

所有这些第三方库在命名类和函数时都有自己的奇怪习惯吗？完全正确！

C# 中的情况完全不同。基础从一开始就到位，所以一切都可以很好地互操作（并且因为基础是由 CLR 提供的，所以有跨语言支持）。

这并不完美。泛型应该从一开始就存在，但没有，这确实在一些较旧的库上留下了明显的伤疤；但是从外部解决这个问题通常是微不足道的。还有一些流行的库是从 Java 移植过来的，这并不像它最初出现的那样合适。

**闭包（带有局部变量捕获的匿名方法）**

Java 和 C 实际上是最后剩下的缺少闭包的主流语言，并且库可以设计和使用它们比没有它们时更加整洁（这就是移植的 Java 库有时对 C# 用户来说显得笨拙的一个原因）。

关于 C++ 的有趣之处在于，它的标准库被设计成在语言中可以使用闭包（容器类型、、、`<algorithm>`）`<functional>`。然后十年过去了，现在他们终于被添加了！它们将产生巨大的影响（尽管如上所述，它们泄露了欠精细的行为）。

C# 和 JavaScript 是“惯用地建立”闭包的最广泛使用的语言。（这些语言之间的主要区别在于 C# 是静态类型的，而 JavaScript 是动态类型的）。

**平台支持**

我把它放在最后只是因为它似乎并没有像你想象的那样区分这些语言。所有这些语言都可以在多种操作系统和机器架构上运行。[C 是最广泛支持的，然后是 C++，最后是 C#（尽管由于名为Mono](http://www.mono-project.com/Main_Page)的开源实现，C# 可以在大多数主要平台上使用）。

我在 Windows 和各种 Unix 风格之间移植 C++ 程序的经历令人不快。我从未尝试将 C# 中非常复杂的任何东西移植到 Mono，所以我无法对此发表评论。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-03-28T05:28:10.373

C 和 C++ 都为您提供了较低级别的抽象，随着复杂性的增加，提供了对其他语言不一定公开的底层机器功能的广泛访问。与 C 相比，C++ 增加了完全面向对象语言的便利性（减少了开发时间），这可能会增加额外的性能成本。就现实世界的应用而言，我看到这些语言应用于以下领域：

C

*   内核级软件。
*   硬件设备驱动程序
*   需要访问旧的稳定代码的应用程序。

C,C++

*   需要微调内存管理的应用程序或服务器开发（不能留给通用垃圾收集解决方案）。
*   需要访问与更现代的托管语言无法很好交互的库的开发环境。
*   尽管托管 C++ 可用于访问 .NET 框架，但它不是无缝过渡。

C# 提供了一个托管内存模型，它再次添​​加了更高级别的抽象。这种抽象级别增加了便利性并缩短了开发时间，但使访问较低级别的 API 变得复杂，并使专门的性能要求成为问题。

在托管内存环境中实现性能极高的软件当然是可能的，但了解其含义至关重要。

C# 的语法肯定比 C/C++ 要求低（并且容易出错），并且对于初学者来说，学习曲线更浅。

C＃

*   快速的客户端应用程序开发。
*   受益于 .NET 框架的高性能服务器开发（例如 StackOverflow）。
*   需要使用 .NET 框架的设计语言优势的应用程序。

[Johannes Rössel](https://stackoverflow.com/users/73070/johannes-r246ssel)指出使用 C# Pointers、Unsafe 和 Unchecked 关键字突破了构建 C# 的抽象层这一点是有效的。我要强调的是，编程类型是大多数 C# 开发场景的例外，而不是语言的基本部分（就像 C/C++ 的情况一样）。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-28T05:28:13.697

C 是准系统、简单、干净的语言，可以让你自己做所有事情。它不会握住你的手，也不会阻止你朝自己的脚开枪。但它拥有你做你想做的一切所需的一切。

C++ 是添加了类的 C，然后是一大堆其他的东西，然后是更多的东西。它不会牵着你的手，但它会让你牵着自己的手，带有附加的 GC 或 RAII 和智能指针。如果您想要完成某些事情，那么很可能有一种方法可以滥用模板系统来为您提供相对简单的语法。（对于 C++0x 更是如此）。这种复杂性还使您能够意外地创建十几个自己的实例并将它们全部击中。

C# 是微软在 C++ 和 Java 上改进的尝试。大量的语法特性，但远不及 C++ 的复杂性。它在完全托管的环境中运行，因此为您完成了内存管理。如果需要，它确实让您“弄脏”并使用不安全的代码，但这不是默认设置，您必须做一些工作才能射击自己。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-28T05:45:14.093

我的意见是 C# 和 ASP.NET 将是三者中最好的，用于偏向 web 的开发。

我怀疑有人用 C 或 C++ 编写新的 Web 应用程序了。它是在 10 年前完成的，可能还有很多遗留代码仍在使用，但它们并不是特别适合，似乎没有那么多（持续的）工具支持，而且它们可能有少量活动进行 Web 开发的社区（可能 Web 服务器开发除外）。我当时写了很多网站 C++ COM 对象，但是 C# 的生产力要高得多，除非你需要，否则没有令人信服的理由来编写 C 或 C++（在这种情况下）。

如有必要，我仍然会编写 C++，但它通常用于一个小问题域。例如，通过 P/Invoke 从 C# 与旧的 C 样式 dll 进行通信——在 C# 中做一些完全笨拙的事情是轻而易举地创建一个 C++ COM 对象作为桥梁。

C# 的好处是您还可以轻松转移到编写 Windows 和控制台应用程序并留在 C# 中。使用 Mono，您也不仅限于 Windows（尽管您可能受限于您使用的库）。

无论如何，这都是从网络偏见的角度来看的。如果您询问嵌入式设备，我会说 C 或 C++。您可能会说这些都不适合 Web 开发，但 C#/ASP.NET 非常漂亮，运行良好，有大量在线资源、庞大的社区和免费的开发工具。

因此，从现实世界的角度来看，根据要求只选择 C#、C++ 和 C 中的一个，作为一般规则，您最好坚持使用 C#。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-08-11T15:10:15.073

C - 一种较旧的编程语言，被描述为 Hands-on。作为程序员，您必须告诉程序做所有事情。此外，这种语言几乎可以让你做任何事情。它不支持面向对象的代码。因此没有课。

C++ - C 本身的一种扩展语言。在 C 代码中 ++ 表示增量 1。因此 C++ 比 C 更好。它允许高度受控的面向对象的代码。又一次非常实用的语言，涉及到很多细节。

C# - 类似于 C/C++ 代码风格的完整面向对象的代码。这真的更接近于JAVA。C# 是 C 风格语言的最新版本，非常适合开发 Web 应用程序。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-28T05:27:21.157

从您的其他帖子中，我猜您想学习一门新语言以获得新技能。我的建议是语言并不是很重要，重要的是其社区的质量（建议，还有你可以阅读和学习的现有代码）和可用的库/框架。在这方面，我认为“C族”对你来说不是最好的选择：Web库和框架很少，不便携也不是很好，你可以学习的代码编码风格变化很大，可能会让你很困惑（虽然 C 是我最喜欢的语言）。

我建议只学习 C，并尝试真正理解指针的概念，然后转向更适合 Web 的其他语言（想到[Python](https://en.wikipedia.org/wiki/Python_%28programming_language%29)或[JavaScript - 甚至是](https://en.wikipedia.org/wiki/JavaScript)[Java](https://en.wikipedia.org/wiki/Java_%28programming_language%29)）。此外，在我看来，在 C 系列中，[Objective-C](https://en.wikipedia.org/wiki/Objective-C)是功能和简单性的最佳组合，但却是一个小众玩家。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T04:56:31.667

对于原始速度，使用 C。对于功率，使用 C++。对于 .NET 兼容性，请使用 C#。

随着语言的发展，它们都非常复杂。C 经历了几十年的逐渐积累，C++ 经历了多年的快速增强，C# 经历了微软的强大。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-23T21:33:50.687

C 是最接近并直接翻译为 CPU 机器代码的核心语言。CPU 遵循移动、添加、逻辑组合、比较、跳转、推送和弹出的指令。C 使用更简单的语法来做到这一点。如果您学习反汇编，您可以学习编写与汇编一样快速和紧凑的 C 代码。这是我在内存有限的 8 位微控制器上的首选语言。如果你用 C 编写一个大型的 PC 程序，你会因为其有限的组织而遇到麻烦。这就是面向对象编程变得强大的地方。C++ 和 C# 类共同包含数据和函数的能力加强了组织，这反过来又允许在 C 上进行更复杂的可操作性。在过去，当 CPU 只有一个内核时，C++ 对于快速处理至关重要。我现在开始学习 C#。它的类结构似乎比 C++ 执行更高程度的组织，这最终会导致更快的开发并促进代码共享。C# 不像 VB 那样被解释。它在开发时进行部分编译，然后在运行时进一步翻译以变得更加平台友好。

# silverlight-2.0 - 如何在 Silverlight 2.0 中模拟分页？

> ID：692237
> 
> 赞同：0
> 
> 时间：2009-03-28T05:01:59.423
> 
> 标签：silverlight-2.0

我正在尝试锻炼我的 silverlight 应用程序将如何工作。

我想让它填满浏览器。

我将有一个允许登录的类似主页。

然后它会打开一个搜索页面来列出数据

然后在选择时转到所选项目的详细信息页面。

但我的问题是如何构建应用程序以转到我所说的这些“页面”。

我是否有每个逻辑页面的用户控件，然后加载该用户控件？

在代码加载用户控件中是如何完成的，你能解释一下吗？是否必须有基本用户控件？？？

马尔科姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T05:09:51.167

在 Silverlight 2.0 中进行此操作的最简单方法是在您的页面中放置一个 ContentControl，以及导航控件（如果您有多个根页面，则使用菜单或一些按钮来选择页面）。

每个“页面”都是作为用户控件创建的，您可以通过将内容控件的 Content 属性设置为用户控件的实例来显示它。

因此，例如： Page（继承自 UserControl，由 VS 创建）：包含一个 ContentControl，名为 MainContent

登录（从 UserControl 继承） 搜索（从 UserControl 继承） 详细信息（从 UserControl 继承）等

例如，从搜索转到 Details 时，如果 Details 采用要显示的对象的 Id： MainContent.Content = New Details(SelectedItem.Id)

如果您需要更多详细信息，请告诉我，这取决于您对 xaml 和 silverlight 的熟练程度。

旁注：Silverlight 3 附带了一个内置机制，但这对你现在没有帮助。

编辑：Silverlight 爱好者会注意到 Silverlight 2.0 中没有“Page”类，我说的是由 VS 创建的名为“Page”的类，它是一个 UserControl。我更正了我的输入

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T05:09:51.447

看看这篇博文

[http://blogs.msdn.com/dphill/archive/2008/10/07/silverlight-navigation-part-1.aspx](http://blogs.msdn.com/dphill/archive/2008/10/07/silverlight-navigation-part-1.aspx)

# java - Fowler 的“企业应用架构模式”仍然适用吗？

> ID：692241
> 
> 赞同：78
> 
> 时间：2009-03-28T05:05:50.880
> 
> 标签：java, jakarta-ee, architecture, poeaa

我正在考虑购买 Martin Fowler 的“企业应用程序架构模式”。

在我看来，这似乎是一本很棒的书，一本偏向于企业 Java 的架构书——正是我所需要的。

但是，在计算机时代，它已经很老了。2003 年是很久以前的事了，从那以后事情发生了很大的变化。

所以我想知道是否有人可以告诉我：这本书仍然相关，值得一读吗？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-03-28T05:08:13.213

是的，它仍然非常相关并且是一个极好的资源。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-01T14:15:30.370

这本书，以及[Eric Evans 关于领域驱动设计](http://domaindrivendesign.org/books#DDD)的书，都是我的年度书籍——每年 ;) ...

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-28T20:52:55.190

这是非常相关的。我经常向其他开发人员介绍该书中的特定模式，例如指向他的站点 ( [http://www.martinfowler.com/eaaCatalog/](http://www.martinfowler.com/eaaCatalog/) ) 的链接，例如[数据传输对象](http://www.martinfowler.com/eaaCatalog/dataTransferObject.html)和[服务层](http://www.martinfowler.com/eaaCatalog/serviceLayer.html)。

后者是我认为我“发明”的一个，直到我看到 Fowler 已经写过它。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-11-09T15:53:26.853

Given that the answers to this question are now three years old, I felt it important to restate the relevance of Martin Fowler's patterns.

The GOF design patterns book was first published in 1994, and many of its patterns are still considered relevant. We may have come to a deeper understanding of them and produced subtle variants, but they are there as the foundation of any good OO design.

Modern languages increasingly implement some of the patterns behind the scenes so that the developer in theory doesn't have to know about them (an example is the Iterator pattern through the `yield` statement in C#). But, the developer is a better one for knowing them.

Moving on the Martin's book - this absolutely is still relevant. Its true that many libraries now support these patterns in the background, once again abstracting them away from the developer, but again they are at the core of enterprise application software development.

They solve problems that occurr again and again, regardless of language, system, or platform.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-28T15:17:48.537

我不同意“偏向 Java”的说法。就其本质而言，模式与语言无关。它们被定义为常见问题的解决方案。Fowler 的书有 Java 和 C# 的示例，所以我看不出“偏见”来自哪里。它们是最常见的面向对象语言，他正在谈论企业问题的面向对象解决方案。

GoF 书中有 Smalltalk 和 C++ 的示例。为什么他们对 Java 和 C# 如此“有偏见”？提示：写这本书时语言并不存在，但模式与以往一样相关。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-28T20:56:50.657

目前是[我大学](http://rit.edu/) [信息系统设计原理课程](http://register.rit.edu/courseSchedule/4010443)使用的教材。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-08-25T06:40:28.300

绝对地！

The book is a classic. I've just been re-reading it to help with some work on event-driven accounting systems.

Fowler has been revisiting some of the patterns since and you can see his [works in progress](https://www.martinfowler.com/eaaDev/).

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-12-10T19:48:34.733

Very relevant, and certainly not chained to one language. Witness the upcoming Rails move to Merb, in a very real sense a move from one pattern in POEAA (ActiveRecord) to another (DataMapper).

Many other concepts, from ORM strategies to session management, are both relevant and language-agnostic. I'm still floored when I read this how vast Fowler's influence is. He didn't invent all of the concepts here, but he certainly codified and put names to these ideas in such an concise and accessible way as to make them common parlance across the industry. Still essential.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-18T11:54:59.780

是的，这本书仍然是相关的。如果您担心它的价值，您可以在亚马逊上取用二手副本并通过同一渠道出售。

# git - 在 Git 中撤消对一个文件的工作副本修改？

> ID：692246
> 
> 赞同：1852
> 
> 时间：2009-03-28T05:09:02.883
> 
> 标签：git, file, version-control, dvcs, undo

在最后一次提交之后，我修改了工作副本中的一堆文件，但我想撤消对其中一个文件的更改，因为将其重置为与最近提交相同的状态。

但是，我只想单独撤消该文件的工作副本更改，没有其他内容。

我怎么做？

* * *

## 回答 #1

> 赞同：2490
> 
> 时间：2009-03-28T06:12:51.403

您可以使用

```
git checkout -- file 
```

您可以不使用`--`（如 nimrodm 所建议的那样），但如果文件名看起来像一个分支或标签（或其他修订标识符），它可能会混淆，因此`--`最好使用。

您还可以签出文件的特定版本：

```
git checkout v1.2.3 -- file         # tag v1.2.3
git checkout stable -- file         # stable branch
git checkout origin/master -- file  # upstream master
git checkout HEAD -- file           # the version from the most recent commit
git checkout HEAD^ -- file          # the version before the most recent commit 
```

* * *

## 回答 #2

> 赞同：175
> 
> 时间：2009-03-28T05:55:51.133

只需使用

```
git checkout filename 
```

这将用当前分支中的最新版本替换文件名。

**警告：您的更改将被丢弃 - 不会保留任何备份。**

* * *

## 回答 #3

> 赞同：142
> 
> 时间：2009-03-28T10:25:25.557

```
git checkout <commit> <filename> 
```

我今天使用了这个，因为我意识到我的网站图标在我升级到 drupal 6.10 的几个提交之前被覆盖了，所以我必须把它拿回来。这是我所做的：

```
git checkout 088ecd favicon.ico 
```

* * *

## 回答 #4

> 赞同：89
> 
> 时间：2012-07-03T05:46:09.310

如果您的文件已暂存（在编辑文件后执行 git add 等操作时发生）以取消暂存更改。

采用

```
git reset HEAD <file> 
```

然后

```
git checkout <file> 
```

如果尚未上演，只需使用

```
git checkout <file> 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2018-04-10T14:54:10.893

**我已经通过 git bash 完成：**

***`(use "git checkout -- <file>..." to discard changes in working directory)`***

1.  **吉特状态。**[所以我们已经看到一个文件被修改了。]
2.  **git checkout -- index.html** [我已更改 index.html 文件：
3.  **git status** [现在这些更改已删除]

[![在此处输入图像描述](https://i.stack.imgur.com/onOB1.jpg)](https://i.stack.imgur.com/onOB1.jpg)

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2009-03-28T05:25:58.850

如果您只想撤消上一次提交对该文件的更改，可以尝试以下操作：

```
git checkout branchname^ filename 
```

这将像上次提交之前一样签出文件。如果您想返回更多提交，请使用该`branchname~n`符号。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2016-02-09T08:56:33.543

我总是对此感到困惑，所以这里有一个提醒测试用例；假设我们有这个`bash`脚本要测试`git`：

```
set -x
rm -rf test
mkdir test
cd test
git init
git config user.name test
git config user.email test@test.com
echo 1 > a.txt
echo 1 > b.txt
git add *
git commit -m "initial commit"
echo 2 >> b.txt
git add b.txt
git commit -m "second commit"
echo 3 >> b.txt 
```

* * *

此时，更改并未暂存于缓存中，因此`git status`是：

```
$ git status
On branch master
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   b.txt

no changes added to commit (use "git add" and/or "git commit -a") 
```

如果从这一点开始，我们这样做`git checkout`，结果是这样的：

```
$ git checkout HEAD -- b.txt
$ git status
On branch master
nothing to commit, working directory clean 
```

如果我们这样做`git reset`，结果是：

```
$ git reset HEAD -- b.txt
Unstaged changes after reset:
M   b.txt
$ git status
On branch master
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   b.txt

no changes added to commit (use "git add" and/or "git commit -a") 
```

因此，在这种情况下 - 如果未暂存更改，`git reset`则没有区别，同时会`git checkout`覆盖更改。

* * *

现在，假设上面脚本的最后一个更改是暂存/缓存的，也就是说我们`git add b.txt`最后也做了。

在这种情况下，`git status`此时是：

```
$ git status
On branch master
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    modified:   b.txt 
```

如果从这一点开始，我们这样做`git checkout`，结果是这样的：

```
$ git checkout HEAD -- b.txt
$ git status
On branch master
nothing to commit, working directory clean 
```

如果我们这样做`git reset`，结果是：

```
$ git reset HEAD -- b.txt
Unstaged changes after reset:
M   b.txt
$ git status
On branch master
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   b.txt

no changes added to commit (use "git add" and/or "git commit -a") 
```

因此，在这种情况下 - 如果更改是分阶段的，`git reset`则基本上会将分阶段的更改变为非分阶段`git checkout`的更改 - 同时会完全覆盖更改。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-01-23T21:26:27.320

此答案适用于撤消位于相同或多个文件夹（或目录）中的多个特定文件中的本地更改所需的命令。此答案专门解决了用户拥有多个文件但用户不想撤消所有本地更改的问题：

> 如果您有一个或多个文件，您可以将相同的命令 ( `git checkout -- file`) 应用于每个文件，方法是列出用空格分隔的每个位置，如下所示：

```
git checkout -- name1/name2/fileOne.ext nameA/subFolder/fileTwo.ext 
```

> 注意 name1/name2/fileOne.ext nameA/subFolder/fileTwo.ext 之间的空格

对于同一文件夹中的多个文件：

> 如果您碰巧需要放弃对某个目录中所有文件的更改，请使用 git checkout，如下所示：

```
git checkout -- name1/name2/* 
```

上面的星号可以撤消 name1/name2 下该位置的所有文件。

> 而且，类似地，以下可以撤消多个文件夹的所有文件中的更改：

```
git checkout -- name1/name2/* nameA/subFolder/* 
```

> 再次注意上面的 name1/name2/* nameA/subFolder/* 之间的空格。

注意：name1、name2、nameA、subFolder - 所有这些示例文件夹名称都表示相关文件可能所在的文件夹或包。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2021-04-12T15:00:31.773

Git 2.23 引入了一个`restore`来做这件事，我认为是为了让这些问题的答案变得简单。

```
git restore [--] <pathspec>... 
```

与往常一样，`--`可能需要，但当文件名以破折号开头时。（这里不可能与分支名称混淆，因为`restore`的周长不包括分支，这与 do-all 不同`checkout`）

为了完整起见，`restore`还可以使用 恢复暂存文件`--staged`，并从与 不同的提交`HEAD`中恢复`--source=<tree>`。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2012-05-22T20:39:17.570

我使用 SHA id 恢复我的文件，我所做的是`git checkout <sha hash id> <file name>`

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-08-19T14:28:04.030

对我来说只有这个有效

```
git checkout -p filename 
```

[![在此处输入图像描述](https://i.stack.imgur.com/Ev1Zj.png)](https://i.stack.imgur.com/Ev1Zj.png)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-04-30T19:45:13.070

如果您尚未推送或以其他方式共享您的提交：

```
git diff --stat HEAD^...HEAD | \
fgrep filename_snippet_to_revert | cut -d' ' -f2 | xargs git checkout HEAD^ --
git commit -a --amend 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-26T19:17:07.237

如果它已经提交，您可以恢复文件的更改并再次提交，然后用最后一次提交压缩新提交。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2018-12-31T15:55:01.847

```
git checkout a3156ae4913a0226caa62d8627e0e9589b33d04c -p */SearchMaster.jsp 
```

细分：a3156ae4913a0226caa62d8627e0e9589b33d04c = 这是提交的哈希值。它在我自己的个人分支上（不是主人）。

-p 标志是路径。

*/SearchMaster.jsp 是文件名。

# objective-c - 如何使用 JSON 框架和 Objective-C/iPhone/Xcode 解析嵌套的 JSON 对象？

> ID：692247
> 
> 赞同：6
> 
> 时间：2009-03-28T05:09:07.860
> 
> 标签：objective-c, iphone, xcode, json

我正在使用 JSON 框架编写一个 iPhone 原生应用程序。

我的应用程序正在使用 JSON 访问 Web 服务。我们发送的 JSON 数据有嵌套对象，下面是提供的数据示例：

```
{
    "model": {
        "JSONRESPONSE": {
            "authenticationFlag": true,
            "sessionId": "3C4AA754D77BFBE33E0D66EBE306B8CA",
            "statusMessage": "Successful Login.",
            "locId": 1,
            "userName": "Joe Schmoe"
        }
    }
} 
```

我在使用 objectForKey 和 valueForKey NSDictionary 方法解析时遇到问题。我不断收到 invalidArgumentException 运行时错误。

例如，我想查询“authenticationFlag”元素的响应数据。

谢谢，迈克西雅图

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-29T02:45:44.233

如果没有更多细节（例如您正在使用的 JSON 解析代码），很难说清楚，但有两件事让我印象深刻：

1.  您没有使用完整路径进行查询。在上述情况下，您需要首先获取封闭模型、json 响应，然后才向 json 响应字典询问 authenticationFlag 值：

    `[[[jsonDict objectForKey:@"model"] objectForKey:@"JSONRESPONSE"] objectForKey:@"authenticationFlag"]`

2.  也许您使用 c-strings ( `""`) 而不是 NSStrings ( `@""`) 作为键（尽管这可能会严重崩溃或无法编译）。密钥应该是不能转换为 id 的东西。

虽然可能，但两者都可能是错误的，因此请提供更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-02T10:02:36.660

以下内容直接取自 Dan Grigsby 的教程 - [http://mobileorchard.com/tutorial-json-over-http-on-the-iphone/](http://mobileorchard.com/tutorial-json-over-http-on-the-iphone/) - 请注明，偷窃是恶业。

通过 HTTP 获取 JSON

我们将使用 Cocoa 的 NSURLConnection 发出 HTTP 请求并检索 JSON 数据。

Cocoa 为发出 HTTP 请求提供了同步和异步选项。从应用程序的主运行循环运行的同步请求会导致应用程序在等待响应时停止。异步请求使用回调来避免阻塞并且易于使用。我们将使用异步请求。

我们需要做的第一件事是更新视图控制器的接口以包含一个 NSMutableData 来保存响应数据。我们在接口中（而不是在方法中）声明了这一点，因为响应是以我们拼接在一起的片段连续返回的，而不是一个完整的单元。

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController {
    IBOutlet UILabel *label;
    NSMutableData *responseData;
} 
```

为简单起见，我们将启动来自 viewDidLoad 的 HTTP 请求。

替换以下内容：

```
#import "JSON/JSON.h"

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];

    responseData = [[NSMutableData data] retain];
    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:@"XYZ.json"]];
    [[NSURLConnection alloc] initWithRequest:request delegate:self];
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    [responseData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [responseData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    label.text = [NSString stringWithFormat:@"Connection failed: %@", [error description]];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    [connection release];
}

- (void)dealloc {
    [super dealloc];
}

@end 
```

这个主要是样板代码初始化 responseData 变量以准备好保存数据并在 viewDidload 中启动连接；当它们进入 didReceiveData 时，它会收集碎片；并且空的 connectionDidFinishLoading 准备好对结果做一些事情。使用 JSON 数据

接下来，我们将充实 connectionDidFinishLoading 方法，以利用在上一步中检索到的 JSON 数据。

更新 connectionDidFinishLoading 方法：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    [connection release];

    NSString *responseString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];
    [responseData release];

    NSArray *luckyNumbers = [responseString JSONValue];

    NSMutableString *text = [NSMutableString stringWithString:@"Lucky numbers:\n"];

    for (int i = 0; i < [luckyNumbers count]; i++)
        [text appendFormat:@"%@\n", [luckyNumbers objectAtIndex:i]];

    label.text =  text;
} 
```

它创建了一个 NSArray。解析器非常灵活并返回对象——包括嵌套对象——将 JSON 数据类型与 Objective-C 数据类型适当匹配。更好的错误处理

到目前为止，我们一直在使用方便的高级扩展 NSString 方法来解析 JSON。我们这样做是有充分理由的：将 JSONValue 消息简单地发送到字符串以访问解析的 JSON 值很方便。

不幸的是，使用这种方法会使有用的错误处理变得困难。如果 JSON 解析器由于任何原因失败，它只会返回一个 nil 值。但是，如果您在发生这种情况时查看控制台日志，您将看到准确描述导致解析器失败的原因的消息。

能够将这些错误详细信息传递给用户会很好。为此，我们将切换到 JSON SDK 支持的第二种面向对象的方法。

更新 connectionDidFinishLoading 方法：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    [connection release];

    NSString *responseString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];
    [responseData release];

    NSError *error;
    SBJSON *json = [[SBJSON new] autorelease];
    NSArray *luckyNumbers = [json objectWithString:responseString error:&error];
    [responseString release];   

    if (luckyNumbers == nil)
        label.text = [NSString stringWithFormat:@"JSON parsing failed: %@", [error localizedDescription]];
    else {
        NSMutableString *text = [NSMutableString stringWithString:@"Lucky numbers:\n"];

        for (int i = 0; i < [luckyNumbers count]; i++)
            [text appendFormat:@"%@\n", [viewcontroller objectAtIndex:i]];

        label.text =  text;
    }
} 
```

使用此方法为我们提供了一个指向底层 JSON 解析器的错误对象的指针，我们可以将其用于更有用的错误处理。

结论 ：

JSON SDK 和 Cocoa 对 HTTP 的内置支持使得将 JSON Web 服务添加到 iPhone 应用程序变得简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-09T18:49:33.563

```
 NSString* aStr;
    aStr = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding];
    NSDictionary *dictionary = [aStr JSONValue];
    NSArray *keys = [dictionary allKeys];

    // values in foreach loop
    for (NSString *key in keys) {
    NSArray *items = (NSArray *) [dictionary objectForKey:key];  

        for (id *item in items) {  

            NSString* aStrs=  item;
            NSLog(@" test %@", aStrs);

            NSDictionary *dict = aStrs;
            NSArray *k = [dict allKeys];

        for (id *it in k) {  
                            NSLog(@"the  child item: %@", [NSString stringWithFormat:@"Child Item -> %@ value %@", (NSDictionary *) it,[dict objectForKey:it]]);                
                        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T12:46:09.977

现在，Objective c 在构建类中引入了 JSON Parsing。

```
 NSError *myError = nil;
 NSDictionary *resultDictionary = [NSJSONSerialization JSONObjectWithData:self.responseData options:NSJSONReadingMutableLeaves error:&myError]; 
```

[http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)

所以利用这个类，让你的应用程序没有错误......:)

# c# - 在 VB.NET 2005 或 C#.NET 2005 中使用多个数据读取器，并以 MySQL 5.0 作为后端

> ID：692254
> 
> 赞同：0
> 
> 时间：2009-03-28T05:10:22.553
> 
> 标签：c#, mysql, vb.net

我使用 MySQL 5.0 作为后端。我在我的项目中使用 MySqlData.dll。当我尝试执行以下代码时，

试试 Dim cnData As New MySql.Data.MySqlClient.MySqlConnection Dim lcmd, lcmd1 As New MySql.Data.MySqlClient.MySqlCommand Dim ldr, ldr1 As MySql.Data.MySqlClient.MySqlDataReader

```
 cnData.ConnectionString = "SERVER=localhost;Uid=root;Pwd=root;Database=mytestdatabase"
        cnData.Open()
        lcmd = New MySql.Data.MySqlClient.MySqlCommand("select uom_id,uom_name from uom", cnData)
        ldr = lcmd.ExecuteReader
        While ldr.Read
            lcmd1 = New MySql.Data.MySqlClient.MySqlCommand("select uom_id,uom_name from uom1 where uom_id=" & ldr.Item("uom_id") & "", cnData)
            ldr1 = lcmd1.ExecuteReader
            While ldr1.Read
                MsgBox(ldr1.Item("uom_id"))
                MsgBox(ldr1.Item("uom_name"))
            End While
            ldr1.Close()
        End While
        ldr.Close()
        con.Close()
    Catch ex As Exception
        MsgBox(ex.Message)
    End Try 
```

我收到错误消息，因为“已经有一个与此连接关联的 OpenDataReader，必须先关闭。” 我必须使用重叠的多个数据读取器。我哪里出错了？谁能帮助我。这对我很有帮助。

西瓦库玛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T05:40:31.297

此代码等效于您尝试执行的操作：

```
Try
    Dim cnData As New MySql.Data.MySqlClient.MySqlConnection
    Dim lcmd As MySql.Data.MySqlClient.MySqlCommand
    Dim ldr As MySql.Data.MySqlClient.MySqlDataReader

    cnData.ConnectionString = "SERVER=localhost;Uid=root;Pwd=root;Database=mytestdatabase"
    cnData.Open()
    lcmd = New MySql.Data.MySqlClient.MySqlCommand("select uom1.uom_id, uom1.uom_name from uom join uom1 ON uom.uom_id = uom1.uom_id ORDER BY uom_id", cnData)
    ldr = lcmd.ExecuteReader
    While ldr.Read
        MsgBox(ldr.Item("uom_id"))
        MsgBox(ldr.Item("uom_name"))
    End While
    ldr.Close()
    cnData.Close()

Catch ex As Exception
    MsgBox(ex.Message)
End Try 
```

# python - 如何在 Python 中跟踪动画对象？

> ID：692259
> 
> 赞同：0
> 
> 时间：2009-03-28T05:14:57.567
> 
> 标签：python, animation, image-manipulation

我想用 Python 自动玩视频游戏。我想编写一个脚本，可以抓取屏幕图像，将其与下一帧进行比较并跟踪要单击的对象。除了 PIL 之外，还有哪些库对此有用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T07:41:06.527

答案也取决于平台和游戏。例如，我曾经为直升机 Flash 游戏做过类似的事情，因为它是非常简单的 2d 游戏，具有明确定义的彩色迷宫。它是在寡妇身上，使用 python 的 win32api 绑定复制到剪贴板和 win32 关键事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T05:43:24.907

这里有几个选项。除非您跟踪的内容非常一致，否则蛮力差异方法将导致很多挫败感。为此，您可以使用任意数量的遗传方法来训练您的程序要遵循的内容。经过足够多的世代后，它会可靠地做正确的事情。如果您要跟踪的东西在视觉上很明显（例如白屏上的红球），那么您可以通过对位图的简单暴力扫描自己检测到它。

另一种方法是查看正在运行的应用程序的内存，并找出控制对象位置的区域。有关这方面的更多信息和想法，请参阅 mumble 如何让 3D 位置音频在各种游戏中工作。

[http://mumble.sourceforge.net/HackPositionalAudio](http://mumble.sourceforge.net/HackPositionalAudio)

# ruby-on-rails - Rails 应用程序管理部分

> ID：692260
> 
> 赞同：7
> 
> 时间：2009-03-28T05:16:19.293
> 
> 标签：ruby-on-rails, ruby

我正在开发我的第一个 Rails 应用程序并想创建一个管理部分。

我是否想将我的视图和控制器完全分开（即在单独的目录中）以用于管理部分和站点的其余部分？

如何在自定义目录中组织视图/控制器（如何配置路由）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T05:34:06.553

要创建您的管理控制器：

```
script/generate controller admin/articles 
```

然后在你的 routes.rb 文件中

```
map.resource :admin do |admin|
  admin.resources :articles, :path_prefix => "admin", :name_prefix => "admin_", :controller => "admin/articles"
end 
```

然后，您可以为此访问索引 url：

```
<%= link_to "Articles Admin", admin_articles_path %> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-28T06:07:47.640

您还可以将应用程序和控制器保留在它们通常的位置，并使用*Rails 过滤器*来控制访问，这就是我认为您在这里寻找的。

如果您手边有 AWDWR 书，请翻到第 11 章任务 F Administrivia

*   基本上在 app\controllers\application.rb 中定义一个授权方法，它检查授权，如果没有登录则重定向到登录页面 et.all
*   `before_filter`用s标记要限制访问的控制器

.

```
class AdminController < ApplicationController
   before_filter :authorize
   #  ... the rest of the code
end 
```

这将拦截对 AdminController 中定义的操作的所有调用，并强制它们通过授权

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-28T13:12:36.420

```
map.namespace :admin do |admin|
  admin.register :controller => 'main', :action => 'register'
  admin.login, :controller => 'main', action => 'login'
  # ...
end 
```

这就是您命名事物的方式，将其添加到此处有关授权事物的其他评论中，您就离开了。看看 restful_authentication 插件来做你的用户管理，比滚动你自己的更快更容易。

上述路由假设控制器及其视图位于名为 admin 的子目录中，我认为这正是您想要的。

# c# - System.IO.Stream 一次性使用阅读器

> ID：692263
> 
> 赞同：1
> 
> 时间：2009-03-28T05:17:31.943
> 
> 标签：c#, .net, file-io, stream

不记得我在哪里读过它，但我记得一个 MS 家伙说，一旦你围绕 System.IO.Stream 创建了一个阅读器，那么流不再负责处理流。

这是真的？有人可以证实这一点吗？也许提供参考。

这意味着此代码中的外部使用是多余的

```
using (var s = new FileStream(@"c:\file.txt",FileMode.Open)) {
    using (var reader = new StreamReader(s)) {
         reader.ReadToEnd();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T05:24:11.320

阅读此问题的批准答案：

[谁处置 IDisposable 公共财产？](https://stackoverflow.com/questions/674879/who-disposes-of-an-idisposable-public-property/675001#675001)

它说 StreamReader 总是处理底层流。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T05:24:38.400

Both`FileStream`和`StreamReader`implement `IDisposable`，所以我会使用 both `using`'s 不管，如果底层实现发生变化，无论多么不可能，你的代码仍然是好的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T10:18:30.760

If 不是多余的，因为 " `new StreamReader(s)`" 行可能会失败（抛出异常）。这意味着*没有* `using`块进入`Dispose()`流。实际上，这不太可能……但它可以！例如，流可能是不可读的（或其他）。

因此，最好始终保护这种初始化；处理两次总比不处理好得多。此外，它让读者（以及任何代码分析工具）清楚地看到，您已经**自行**清理过了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T10:15:22.717

作为参考，您必须查看[受保护的 Dispose(bool) 的 MSDN 页面，该页面](http://msdn.microsoft.com/en-us/library/hh40558e.aspx)确实声明 TextReader 将关闭底层流。

但我同意 Mitch Wheat 的观点，即使用嵌套仍然是一个好主意`using{}`，这个[MSDN 示例](http://msdn.microsoft.com/en-us/library/yhfzs7at.aspx)也是这样做的。

# rss - 如何抓取提要

> ID：692266
> 
> 赞同：3
> 
> 时间：2009-03-28T05:20:16.867
> 
> 标签：rss, web-crawler, feed, atom-feed

我的应用程序需要跟踪 RSS/Atom 提要并将新条目保存在数据库中。我的问题是，**确定提要中的条目是否已被抓取的最可靠方法是什么？**

我使用[Universal Feed Parser](http://www.feedparser.org/)模块来解析提要。我当前的实现会记录 的最新值`feed.entry[i].updated_parsed`，当抓取时，如果`updated_parsed`条目的值大于记录的值，则该条目将保存在数据库中。这里的问题是许多提要没有发布日期或更新日期。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T05:25:46.713

您应该确定您是否已经通过主要参考条目（在没有 a 的情况`<guid>`下回退到）来抓取条目，以及仅作为辅助分析与日期有关的任何事情。`<link>``<guid>`

# html - 变形验证码的想法

> ID：692279
> 
> 赞同：2
> 
> 时间：2009-03-28T05:28:10.700
> 
> 标签：html, flash, captcha, morphing

我一直在考虑一种创建使用变形形状或动态颜色的验证码的动态方法。

我的第一个想法是制作一个图形，闪光灯或其他东西，逐渐从正方形变成球形。当按钮变得足够球形时，用户将需要单击该按钮。

第二个想法是让一个颜色区域慢慢地从红色变为蓝色，当它变成足够蓝色时，用户将需要按下按钮。

第三个想法是两种方法的结合。

我想说困难在于将点击与转换相匹配。但是自动化代码应该很难检测阴影或形状。

人们可以对我的想法提出一些意见。

*   编辑 -

感谢您的反馈。我现在正在考虑使用基于 Flash 的视频播放服务器馈送的视频馈送，这些视频馈送有一些颜色形状会变形为其他颜色形状。当颜色和形状与一些预设问题匹配时，用户将被要求暂停提要：例如：当您看到两个绿色方块变成 3 个蓝色三角形时单击视频。这些形状将在重叠和移动的变形形状之间。全家人的乐趣！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T05:46:11.407

颜色是个坏主意，因为 (a) 它很容易被计算机检测到；(b) 对一些人——色盲——来说很难察觉。即使您可以拒绝残疾人访问，您也必须担心不同的显示器、系统、照明条件等会导致不同的颜色感知。

您认为计算机比较一个像素（或多个像素的平均值）中的红色分量和蓝色分量有多难？琐碎的。所以这对电脑来说不是问题。

同样，编程正方形和圆形之间的差异并不难。一个有直线，一个没有！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T05:36:27.373

好主意，你也可以这样做，让形状保持转动或移动。我不知道它是否比普通字母 capcha 更安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T05:37:53.830

我不确定为什么您认为颜色比文本更难检测。形状可能，但它们必须比 n 边多边形更复杂。然而，渐变动画是个好主意。但是，如果您可以对其进行编码以显示，那么有人可以编写一些可以观看它的东西。

真正的考验是通过识别语义而不是句法意义来证明人性。

例如显示动物的图片并在鸟出现时让用户点击。或者只是说“点击会飞的东西”。并展示一些动物的图片。在对所有图像进行编目之前，这对于机器来说是无与伦比的。CAPTCHA 的问题当然是试图用语法来表达语义。因此，从一开始就打败了自己。

你走在正确的轨道上，我相信你的概念证明很有趣。但请记住：由计算机制造：由计算机解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T09:14:52.560

尽管这些想法几乎肯定会奏效，但它是一种通过默默无闻的安全效应。经典的 CAPTCHA 图像是“单向”的，因为计算机不能（理论上）推断出正确的答案。说“当图像变为蓝色时单击此处”的问题在于，如果有人认为值得为其开发程序，计算机可以轻松地做到这一点。

此外，不寻常的验证码会迫使您的用户思考。根据您的受众，这可能意味着失去一些用户。

在开发 CAPTCHA 系统时，我做了一些研究，将文本打印到图像的经典方法似乎是最有效的。诀窍不在于文本后面有很多“背景噪音”或不同的颜色。这与以下两件事有关：

1) 随机文本字距调整，大多数或所有字母彼此略微重叠。

2) 文本的随机扭曲、平移和旋转。

如果您查看 Google 的 CAPTCHA，它们很可能*只有*这两个功能：[https ://www.google.com/accounts/NewAccount?service=mail](https://www.google.com/accounts/NewAccount?service=mail)

# .net - 从 PHP 调用 .NET 类的最佳方式？

> ID：692281
> 
> 赞同：5
> 
> 时间：2009-03-28T05:28:43.837
> 
> 标签：.net, php, com

将 PHP 应用程序连接到 .NET 库中的逻辑的最佳选择是什么？

PHP，从 v5.0 开始，支持[一个 DOTNET 类](http://us2.php.net/manual/en/class.dotnet.php)，它应该让我从 PHP 脚本调用 .NET 逻辑。但似乎有很多问题 - 我无法让它可靠地工作，使用任意 .NET 类。该文档有点苗条，记录的内容*并不*正确。这门课网上的问题很多，php.net上的错误报告也很多。

我已经能够让 PHP 通过 COM 互操作与 .NET 连接 - 但这要求 .NET 类是 ComVisible。据我所知，由于 COM 要求，这仅适用于 Windows。

我听说过[Phalanger 项目](http://phalanger.codeplex.com/)，但不知道很多细节。它适用于任意 PHP 脚本吗？在 Linux 上工作？它是否具有严重的性能或运行时影响？

这样做是否有意义，或者它是那些你可以做但你不应该做的事情之一？

编辑：我想听听一般情况：有各种各样的 .NET 类库可用，如果能够从包括 PHP 在内的不同环境中利用它们，那就太好了。示例可能是加密、日志记录、数据访问、HPC 集群的客户端。特定的直接场景是带有 AES 加密的 ZIP 库，可在 .NET 中使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T08:05:38.980

Microsoft 不提供或支持 Linux 上的 .NET。如果你不想在 Linux 上运行 .NET 代码，那么你应该看看 Mono。我不知道 PHP 5 是否支持 Mono 以及 MicroSoft.NET

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-03T14:18:12.653

[使用 .net 类和从Phalanger](http://phalanger.codeplex.com)调用 .net 方法非常容易，因为它是 .NET 的 PHP 编译器。您可以查看这篇文章[PHP for .NET: Introduction for .NET developers](http://www.codeproject.com/KB/cross-platform/phalanger-intro.aspx)，该文章较旧（2007 年），因此可能很少有过时的示例，但原则适用。

在 Linux 上 Phalanger 在 Mono 上运行良好，这里最大的限制是您不能使用仅在 Windows 上受支持的本机扩展（来自 PHP 发行版）（Phalanger 中的扩展管理器是用不受支持的 C++/CLI 构建的在单声道上）。但是您仍然可以使用一些可用的 Phalanger 托管扩展。

Phalanger 在实际版本（2011 年 2 月发布）中的性能通过 FastCGI 比 PHP 5.3.5 快约 2 倍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-16T23:30:37.873

NetPhp 是一个在 PHP 的 com_dotnet 扩展之上工作的包装器，因此您可以在 PHP 中调用任何 .Net 程序集，即使它不是 COM Visible 并且适用于任何版本的 .Net 框架。

[https://github.com/david-garcia-garcia/netphp](https://github.com/david-garcia-garcia/netphp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-10T18:04:28.547

我认为最好的方法是通过 COM 来完成。

# c# - 十进制的0x10是什么？

> ID：692286
> 
> 赞同：13
> 
> 时间：2009-03-28T05:33:05.337
> 
> 标签：c#, numbers, hex

我有以下代码：

```
SN.get_Chars(5) 
```

`SN`是一个字符串，所以这应该给出第 5 个字符。行！

现在我有另一个代码，但是：`SN.get_Chars(0x10)`

我想知道0x10是什么？是数字吗？如果是这样，那么十进制表示法是什么？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-03-28T05:54:06.240

`0xNNNN`（不一定是四位数字）至少在 C 中表示十六进制（base-16，因为 'hex' 是 6 而 'dec' 在拉丁衍生语言中是 10）数字，其中`N`一个数字是`0`通过`9`或`A`通过`F`（或它们的小写等价物，代表 10 到 15），并且数字中可能有 1 个或多个这些数字。表示它的另一种方式是 NNNN [16]。

它在计算机世界中非常有用，因为一个十六进制数字代表四位（二进制数字）。那是因为四位，每一个都有两个可能的值，给你一个总数`2 x 2 x 2 x 2`or `16`(2 ⁴ ) 个值。换句话说：

```
 _____________________________________bits____________________________________
 /                                                                             \
+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+
| bF | bE | bD | bC | bB | bA | b9 | b8 | b7 | b6 | b5 | b4 | b3 | b2 | b1 | b0 |
+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+
 \_________________/ \_________________/ \_________________/ \_________________/ 
      Hex digit           Hex digit           Hex digit           Hex digit 
```

一个以 X 为底的数字是一个数字，其中每个位置代表 X 的幂的倍数。

* * *

在我们人类习惯的以 10 为底的情况下，使用的数字是`0`through `9`，数字 7304 [10]是：

*   (7 x 10 ³ ) = 7000 [10] ; 加
*   (3 x 10 ² ) = 300 [10] ; 加
*   (0 x 10 ¹ ) = 0 [10] ; 加
*   (4 x 10 ⁰ ) = 4 [10] ; 等于 7304。

* * *

在八进制中，数字`0`通过`7`. 数字 754 [8]是：

*   (7 x 8 ² ) = 448 [10] ; 加
*   (5 x 8 ¹ ) = 40 [10] ; 加
*   (4 x 8 ⁰ ) = 4 [10] ; 等于 492 [10]。

C 中的八进制数以字符开头，`0`因此`0123`不是 123，而是 (1 * 64) + (2 * 8) + 3 或 83。

* * *

在二进制中，数字是`0`和`1`。数字 1011 [2]是：

*   (1 x 2 ³ ) = 8 [10] ; 加
*   (0 x 2 ² ) = 0 [10] ; 加
*   (1 x 2 ¹ ) = 2 [10] ; 加
*   (1 x 2 ⁰ ) = 1 [10] ; 等于 11 [10]。

* * *

在十六进制中，数字是`0`直通`9`和`A`直通`F`（表示“数字”`10`直通`15`）。数字 7F24 [16]是：

*   (7 x 16 ³ ) = 28672 [10] ; 加
*   (F x 16 ² ) = 3840 [10] ; 加
*   (2 x 16 ¹ ) = 32 [10] ; 加
*   (4 x 16 ⁰ ) = 4 [10] ; 等于 32548 [10]。

您相对简单的 number `0x10`（即 C 表示 10 [16]的方式）就是：

*   (1 x 16 ¹ ) = 16 [10] ; 加
*   (0 x 16 ⁰ ) = 0 [10] ; 等于 16 [10]。

顺便说一句，不同的数字基数用于许多事情。

*   如前所述，我们手上有 10 个数字的人使用 base 10。
*   由于用电路表示两个二进制状态相对容易，因此计算机使用 base 2。
*   base 8 几乎专门用于 UNIX 文件权限，因此每个八进制数字代表二进制权限的 3 元组（读/写/执行）。它还用于基于 C 的语言和 UNIX 实用程序中，以将二进制字符注入到其他可打印的仅字符数据流中。
*   以 16 为基数是一种将四位表示为一个数字的便捷方式，尤其是在当今大多数体系结构的字长是四位的倍数的情况下。
*   base 64 用于对邮件进行编码，以便可以仅使用可打印字符发送二进制文件。每个数字代表六个二进制数字，因此您可以将三个八位字符打包成四个六位数字（文件大小增加 25%，但保证通过邮件网关不受影响）。
*   作为一个半有用的片段，基数 60 来自一些非常古老的文明（巴比伦、苏美尔、美索不达米亚或类似的东西），并且是每分钟 60 秒/分钟、360 度圆周、60 分钟的来源（弧）在一定程度上等等[与计算机行业没有真正的关系，但仍然很有趣]。
*   作为一个更没用的片段，[《银河系漫游指南》](http://en.wikipedia.org/wiki/The_Hitchhiker%27s_Guide_to_the_Galaxy)中的终极问题和答案是“当你将 6 乘以 9 时，你会得到什么？” 和“42”。虽然同样说这是因为地球计算机有故障，但其他人认为这是创造者有 13 个手指的证据 :-)

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-03-28T05:34:29.377

0x 表示数字是[十六进制](http://en.wikipedia.org/wiki/Hexadecimal)，或以 16 为基数。

0x10 是 16。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-05-19T22:16:57.753

简单的版本是 0x 是一个前缀，表示一个十六进制数[source](https://en.wikipedia.org/wiki/Hexadecimal)。

因此，您要计算的值位于前缀*之后*，在本例中为 10。

但这不是数字 10。最高有效位`1`表示十六进制值，而`0`表示单位。

所以你要做的简单数学是

**0x10**

```
1 * 16 + 0 = 16 
```

注意 - 您使用 16，因为十六进制是 16。

另一个例子：

**0xF7**

```
15 * 16 + 7 = 247 
```

您可以通过搜索十六进制表来获取值列表。例如，在此[图表](https://www.google.com/search?q=hex+table&rlz=1C1GKLB_enUS640US640&source=lnms&tbm=isch&sa=X&ved=0ahUKEwiOpMOr_fzTAhUHw2MKHbjUAtoQ_AUICigB&biw=1920&bih=950#imgrc=2U31hF4tTw886M:)中，通知 F 对应于 15。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-28T05:34:54.257

它是一个十六进制数，是十进制的 16。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-21T06:51:49.937

请注意，“10”是该基数中基数的表示：

10 在 base-2 中是 2（十进制）

10 在 base-3 中是 3（十进制）

...

10 是以 10 为底的 10（十进制）

...

10 是 base-16（十六进制）中的 16（十进制）

...

10 是 1024（十进制），以 1024 为底

...等等

# python - 升级到 ubuntu 9.04 django 测试现在很慢

> ID：692294
> 
> 赞同：0
> 
> 时间：2009-03-28T05:36:45.063
> 
> 标签：python, django, ubuntu, testing, ubuntu-9.04

将我的笔记本电脑升级到 Ubuntu 9.04 并运行最新的 django 主干，我的测试套件运行时间增加了两倍。

```
Python2.6
Mysql
Django 1.1 beta 1 SVN-10137 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T22:47:52.940

来自官方 Jaunty IRC 的引述（#ubuntu+1 on Freenode）

> Jaunty 未发布且不受支持。它肯定会破坏你的系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T01:28:04.927

您应该验证您的测试是否在事务中运行。MySQL 是使用 InnoDB 还是 MyISAM 后端？如果你之前和现在都使用 InnoDB，MyISAM 中没有事务支持。

# iphone - 使用私有框架在 XCode 中编译的 iPhone 应用程序在 iPhone 中不起作用

> ID：692307
> 
> 赞同：0
> 
> 时间：2009-03-28T05:52:15.837
> 
> 标签：iphone, iphone-privateapi

我正在编写一个需要直接访问相机的 iPhone 应用程序。由于它是内部的，我对使用全套标头和私有框架没有任何疑虑。
我在应用程序中包含了 PhotoLibrary 框架。它为 2.0 固件编译，我可以将它放在设备上并运行它。但是，一旦启动，它就会退出并返回主屏幕。

我认为 PhotoLibrary 框架没有被加载或类似的东西。

我会发布一些调试输出，但我实际上还没有电话。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T23:27:58.407

这可能是也可能不是问题。iPhone 模拟器可以让您摆脱*许多*在实际设备上无法使用的东西——模拟器应用程序可以使用许多手机上不存在的类（例如 NSXMLDocument，在 Mac OS 上可用X 和 iPhone 模拟器，但不是真正的 iPhone）。拿到手机，运行应用程序，然后使用 Xcode 查看手机的系统控制台，了解它崩溃的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T21:15:08.687

感谢所有的帮助。

事实证明，我试图将 iPhone 2.0 SDK 中的类与具有 2.2.1 的 iPhone 一起使用。因此，当我在 Xcode 中将设备设置为 2.0 时，它会正确编译，但在 iPhone 上会失败，因为旧类不再存在。

我通过从 2.2.1 SDK 获取类来解决我的问题。现在我的程序在 iPhone 上运行良好。

# linux - 从文件中随机选择行而不用 Unix 啜饮它

> ID：692312
> 
> 赞同：52
> 
> 时间：2009-03-28T05:55:00.700
> 
> 标签：linux, unix, awk, random-sample, file-processing

我有一个 10^7 行的文件，我想从文件中随机选择 1/100 行。这是我拥有的 AWK 代码，但它会预先删除所有文件内容。我的电脑内存无法处理这样的啜饮。还有其他方法吗？

```
awk 'BEGIN{srand()}
!/^$/{ a[c++]=$0}
END {  
  for ( i=1;i<=c ;i++ )  { 
    num=int(rand() * c)
    if ( a[num] ) {
        print a[num]
        delete a[num]
        d++
    }
    if ( d == c/100 ) break
  }
 }' file 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-03-28T06:04:56.290

如果你有那么多行，你确定你想要**1** % 还是统计估计就足够了？

在第二种情况下，只需在每行随机化 1%...

```
awk 'BEGIN {srand()} !/^$/ { if (rand() <= .01) print $0}' 
```

如果您想要标题行加上后面的随机行样本，请使用：

```
awk 'BEGIN {srand()} !/^$/ { if (rand() <= .01 || FNR==1) print $0}' 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-03-28T06:02:08.140

您使用了 awk，但我不知道它是否需要。如果不是，这是使用 perl 的一种简单方法（并且无需将整个文件加载到内存中）：

```
cat your_file.txt | perl -n -e 'print if (rand() < .01)' 
```

（更简单的形式，来自评论）：

```
perl -ne 'print if (rand() < .01)' your_file.txt 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-28T07:46:07.750

我在 Gawk 中编写了这个确切的代码——你很幸运。它很长，部分原因是它保留了输入顺序。可能可以进行性能增强。

在事先不知道输入大小的情况下，该算法是正确的。我在这里贴了一个[罗塞塔石碑。](https://stackoverflow.com/questions/321637/rosetta-stone-reservoir-random-sampling-algorithm)（我没有发布这个版本，因为它做了不必要的比较。）

原始线程：[已提交供您审核——awk 中的随机抽样。](http://groups.google.com/group/comp.lang.awk/browse_thread/thread/68c2cfb90119839e/a5322e7012567076?hl=en&ie=UTF-8&oe=utf-8&q=random+sampling+in+awk#a5322e7012567076)

```
# Waterman's Algorithm R for random sampling
# by way of Knuth's The Art of Computer Programming, volume 2

BEGIN {
    if (!n) {
        print "Usage: sample.awk -v n=[size]"
        exit
    }
    t = n
    srand()

}

NR <= n {
    pool[NR] = $0
    places[NR] = NR
    next

}

NR > n {
    t++
    M = int(rand()*t) + 1
    if (M <= n) {
        READ_NEXT_RECORD(M)
    }

}

END {
    if (NR < n) {
        print "sample.awk: Not enough records for sample" \
            > "/dev/stderr"
        exit
    }
    # gawk needs a numeric sort function
    # since it doesn't have one, zero-pad and sort alphabetically
    pad = length(NR)
    for (i in pool) {
        new_index = sprintf("%0" pad "d", i)
        newpool[new_index] = pool[i]
    }
    x = asorti(newpool, ordered)
    for (i = 1; i <= x; i++)
        print newpool[ordered[i]]

}

function READ_NEXT_RECORD(idx) {
    rec = places[idx]
    delete pool[rec]
    pool[NR] = $0
    places[idx] = NR  
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-03-29T05:36:11.173

这应该适用于大多数 GNU/Linux 机器。

```
$ shuf -n $(( $(wc -l < $file) / 100)) $file 
```

如果 GNU shuf 命令不恰当地完成内存管理，我会感到惊讶。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-09-21T18:20:44.597

我不知道**awk**，但是有一种很好的技术可以解决您所描述的问题的更一般版本，并且在一般情况下，*如果 rand < 0.01，它比文件返回行中的 for 行*快得多方法，因此如果您打算多次（数千次，数百万次）执行上述任务，它可能会很有用。它被称为[水库采样](http://en.wikipedia.org/wiki/Reservoir_sampling)，[此页面](http://www.javamex.com/tutorials/random_numbers/random_sample.shtml)对适用于您的情况的版本进行了很好的解释。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-11-22T23:02:44.773

如何从大量（未知大小）中均匀采样 N 个元素的问题被称为[Reservoir Sampling](http://en.wikipedia.org/wiki/Reservoir_sampling)。（如果您喜欢算法问题，请花几分钟尝试解决它，而无需阅读 Wikipedia 上的算法。）

在网络上搜索“Reservoir Sampling”会发现很多实现。[这](http://data-analytics-tools.blogspot.com/2009/09/reservoir-sampling-algorithm-in-perl.html)是实现您想要的 Perl 和 Python 代码，[这](https://stackoverflow.com/questions/2612648/reservoir-sampling)是另一个讨论它的 Stack Overflow 线程。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-02-19T15:52:00.353

在这种情况下，获取精确*k*值的水库采样是微不足道的`awk`，我很惊讶没有任何解决方案建议这样做。我必须解决同样的问题，我编写了以下`awk`采样程序：

```
#!/usr/bin/env awk -f
BEGIN{
    srand();
    if(k=="") k=10
}

NR <= k {
    reservoir[NR-1] = $0;
    next;
}

{ i = int(NR * rand()) }

i < k { reservoir[i] = $0 }

END {
    for (i in reservoir) {
        print reservoir[i];
    }
} 
```

如果保存为`sample_lines`可执行文件，它可以像这样运行：`./sample_lines -v k=5 input_file`. 如果`k`未给出，则默认使用 10。

然后弄清楚*k*是什么必须单独完成，例如通过设置`-v "k=$(dc -e "$(cat input_file | wc -l) 100 / n")"`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-28T06:23:19.897

您可以分两次完成：

*   遍历文件一次，只是为了计算有多少行
*   随机选择要打印的行的行号，将它们存储在排序列表（或集合）中
*   再次运行文件并选择选定位置的行

python中的示例：

```
fn = '/usr/share/dict/words'

from random import randint
from sys import stdout

count = 0
with open(fn) as f:
   for line in f:
      count += 1

selected = set()
while len(selected) < count//100:
   selected.add(randint(0, count-1))

index = 0
with open(fn) as f:
   for line in f:
      if index in selected:
          stdout.write(line)
      index += 1 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-28T06:03:30.163

与其等到最后随机选择 1% 的行，不如在“/^$/”中每 100 行执行一次。这样，您一次只能保存 100 行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-11T08:06:32.783

如果目的只是避免内存耗尽，并且文件是常规文件，则无需执行存储库采样。如果您在文件中执行两次传递，则可以知道文件中的行数，一次获取行数（如 with `wc -l`），一次选择样本：

```
file=/some/file
awk -v percent=0.01 -v n="$(wc -l < "$file")" '
  BEGIN {srand(); p = int(n * percent)}
  rand() * n-- < p {p--; print}' < "$file" 
```

# iphone - 有时 NSString 变得无效？

> ID：692318
> 
> 赞同：1
> 
> 时间：2009-03-28T06:03:10.350
> 
> 标签：iphone, nsstring

在我自己的 iPhone 应用程序中，我使用了许多 nsstring 变量来存储值。但有时它的值会变得无效！有谁知道可能是什么原因？或者告诉我 nsstring 变量变为 Invalid 的情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T08:16:33.883

`NSString`s 也是对象。它们遵循相同的内存管理规则。如果你违反了这些规则，你会得到一个指向无效内存的指针，它看起来像“无效”数据。

例如：

```
myString = [NSString stringWithString:@"foo"]; 
```

这将创建一个`NSString*`启用了自动释放的文件。当您将其分配给 ivar 时，自动释放池将很快弹出，将保留计数恢复为 0 并`dealloc`在您仍然引用它的同时对其进行操作！

淘气。

相反，要么保留它，要么使用：

```
myString = [[NSString alloc] initWithString:@""]; 
```

这将返回一个拥有引用。记得`[myString release];`在`dealloc`.

这只是糟糕的内存管理的一个例子/案例。阅读有关如何正确管理对象生命周期的文档。真的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T07:55:35.167

它们正在自动发布。如果您使用方便的方法（stringWithString、stringWithFormat）创建一个字符串，它将被添加到自动释放池中。

要停止它自动释放，请在使用完毕后向它发送一条保留消息和一条释放消息，以便释放内存。当您将字符串分配给成员变量时，您还可以设置属性以半自动执行此操作

SO和互联网上有很多关于iPhone（和Mac）内存管理的文章。谷歌自动发布。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T06:21:03.687

如果这是针对资源相当有限的设备（例如 iPhone），您应该使用`[[NSString alloc] init*]`静态便捷方法，因为您将减少对自动释放池的压力并降低内存使用量。每个消息循环都会耗尽池，因此要枚举的对象越少越好。

您还应该知道，除非您管理本地自动释放池，否则循环中的自动释放对象会产生大量垃圾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T07:16:46.290

您是否***复制***或***保留***了 NSString ？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-22T00:13:15.037

我问了同样的问题。以下答案是最好的方便。只需使用：

```
[myString retain]; 
```

然后在 dealloc 方法中（例如 viewDidUnload）：

```
[myString release]; 
```

# c# - 什么时候应该使用 Environment.Exit 来终止控制台应用程序？

> ID：692323
> 
> 赞同：40
> 
> 时间：2009-03-28T06:07:17.830
> 
> 标签：c#, .net, console-application

我在工作中维护了许多控制台应用程序，我注意到其中的一件事是它们调用 Environment.Exit(0)。

示例程序如下所示：

```
public class Program
{
    public static void Main(string[] args)
    {
        DoStuff();
        Environment.Exit(0);
    }
} 
```

我不明白原始程序员这样做的意图是什么？在我看来，即使没有 Environment.Exit 语句，程序也应该正常退出。也就是说，对于其中一个程序，它的控制台窗口即使在它应该关闭之后仍然存在，所以我真的不确定那里发生了什么......

我在这里错过了什么吗？或者在这种情况下应该调用 Environment.Exit 是否有原因？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-28T07:10:18.613

调用 Main 方法的最后一行的唯一原因`Exit()`是是否可能有其他前台线程正在运行。如果执行刚刚结束，它们将继续运行`Main`。即使在这种情况下，将一些显式的优雅终止放入其他线程通常是一个更好的主意 - 或者让它们从后台线程开始。

如果您想从其返回不同的退出代码`Main`，实现此目的的更简单方法是将其声明为 return `int`。

简而言之，我认为你不需要`Environment.Exit()`在这里，值得问问你的同事他们为什么要使用它——他们可能无法给你一个很好的理由，这是你可以剪掉的另一点绒毛出去。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-28T06:13:27.223

基本上，该语句`Environment.Exit(0)`告诉操作系统这是一个“干净”的退出。还有其他数字，每个数字都有不同的含义，例如，`Environment.Exit(1)`。

但是，需要注意的一点是“Main”已被声明为不返回任何“void”，因此退出代码实际上没有任何意义。

如果您想了解更多有关不同退出代码的信息，请查看此处：

*[系统错误代码 (0-499)](https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes--0-499-)*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T06:27:31.823

这是（兼容性）命令行程序向底层 shell 指示成功或失败，并且继承自旧的 C 风格的主循环，其中 main 函数的原型是

```
int main(void);

int main(int argc, char *argv[]); 
```

返回值 0 传统上意味着成功，而非零则意味着失败或其他，这取决于程序员的决定。

### 参考

*   `main`有关该功能的更多信息，请[参见 Wikipedia 。](https://en.wikipedia.org/wiki/Entry_point#C_and_C++)

*   [MSDN](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx)文档`Environment.Exit()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-04T15:01:41.260

当其他应用程序正在等待您的控制台应用程序的结果时，这确实会被使用。例如，[SQL Server Reporting Services](https://en.wikipedia.org/wiki/SQL_Server_Reporting_Services) (SSRS)（工具）可以启动控制台应用程序并等待返回成功的失败响应。Environment.Exit(0) 发送回一个成功的执行消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-24T02:57:06.813

在[SSIS](https://en.wikipedia.org/wiki/SQL_Server_Integration_Services)中，当您有一个执行流程任务并且您想知道流程是否失败时，此方法很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-24T04:27:28.800

在[.NET Core](https://en.wikipedia.org/wiki/.NET_Core)中，到目前为止，必须使用`Environment.Exit`来终止他们在 Mac 上的程序。纯粹从返回`main`不会停止进程，它会一直运行直到用户中止它。像这样的模式：

```
public class Program
{
    public static void Main(string[] args)
    {
        Environment.Exit(TryRun(args));
    }
} 
```

在我的工作场所很常见，因为我们想同时为 Windows 和 Mac 发货。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-14T16:49:17.480

我目前正在`Environment.Exit()`控制台应用程序中使用，我不想将丑陋的异常文本扔回控制台。相反，我只是注意到这种情况，在屏幕上写一条用户友好的消息，说明发生了什么，然后调用`Environment.Exit()`.

否则，您不需要`Main()`在基本控制台应用程序中调用它。

# java - 在网页上播放音频流

> ID：692327
> 
> 赞同：0
> 
> 时间：2009-03-28T06:10:09.040
> 
> 标签：java, flash, audio, applet, audio-streaming

我有一个广播电台列表，主要是 .mp3 和 .ogg。我想在可以用 JavaScript 控制的网页上有一个播放器。现在我使用[jlgui](http://www.javazoom.net/applets/jlguiapplet/jlguiapplet.html)，但它有点有限。

你知道jlgui的任何替代品吗？最好是 java 小程序，但我可以容忍特定内容类型的 flash 甚至系统默认媒体播放器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T23:47:47.127

有一千个用于 Flash 的 MP3 播放器，使用本机流媒体内容。不幸的是，这通常不能很好地处理流式 MP3（通过 Icecast HTTP，或者在 SHOUTcast ICY 下更是如此）。通常，播放器必须每隔一段时间重新连接到流，从而导致播放故障，否则内存只会填满 MP3 数据。

OGG更难。没有原生支持，但在 Flash 10 中，您可以播放任何可以自己解码的旧样本，因此可以实现自己的 OGG 解码器。但是，它需要客户端上的大量 CPU。请参阅[http://barelyfocused.net/blog/2008/10/03/flash-vorbis-player/](http://barelyfocused.net/blog/2008/10/03/flash-vorbis-player/)  — 我不知道有人将它修复为一个可以从同一界面播放 MP3 和 OGG 的播放器然而，但没有理由不应该是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-12T18:38:28.267

我发现 JPlayer 如果可用则使用 HTML5，否则它会退回到 Flash。几乎和 JLgui 一样好用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T06:17:53.873

我猜你可以使用 JMF： [link](http://en.wikipedia.org/wiki/Java_Media_Framework)

[JMF 小程序](http://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/guide/JMFApp-Applet.html)

# wpf - 在 WPF 中，创建工具栏按钮以正确缩放图像的最佳方法是什么？

> ID：692334
> 
> 赞同：4
> 
> 时间：2009-03-28T06:16:53.080
> 
> 标签：wpf, visual-studio, user-interface, icons, toolbar

具体来说，我希望使用 VS2008ImageLibrary 中包含的 16*16 32 位 png 图像。我试过手动设置图像的高度和宽度属性，调整边距和填充，调整拉伸和渲染选项。[我创建工具栏按钮的尝试都导致缩放不当（图标模糊）、图标上的底行像素被截断或工具栏按钮的大小不正确——更不用说这里](https://stackoverflow.com/questions/684324/disappearing-icons-in-wpf)已经提到的消失的图标了。有没有人找到制作在 WPF 中正确显示的标准 VisualStudio/WinForms 样式工具栏按钮的最佳方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T07:43:11.147

首先，将图像分辨率更改为 96DPI，这可以使用免费的 Paint.net ( [http://www.getpaint.net](http://www.getpaint.net) ) 打开文件，从菜单中选择 Image->Canvas Size 并将“分辨率”调整为96和储蓄。

如果这对您没有帮助，您可以使用我在博客中写的解决方案[http://www.nbdtech.com/blog/archive/2008/11/20/blurred-images-in-wpf.aspx](http://www.nbdtech.com/blog/archive/2008/11/20/blurred-images-in-wpf.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T19:55:40.087

最好的方法是使用矢量图形而不是 png。我知道以下内容并不完全符合您的要求，但恕我直言，没有更好看的图标。它还可以帮助您摆脱边距和填充。（好吧，如果你想用照片你就完蛋了）

坏消息是您可能需要重新绘制所有图标。您可以使用 MS Expression Blend（它能够将绘制的图像保存为 .xaml）来执行此操作，或者您可以使用文本编辑器自己制作它们。我更喜欢 Border.Background 而不是 Image.Source 来放置图标，这允许我将文本放在图像上。这看起来像这样：

```
<Window.Resources>
   <ResourceDictionary Source="Resources/Icons.xaml"/>
</Window.Resources>
<!--
...
-->
<Button>
   <Border Background="{StaticResource IconName}" Height="16" Width="16" />
</Button> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T17:02:20.720

我能想到的最好的解决方法是：

```
<Image x:Key="TB_NewIcon" Source="Toolbar Images/NewDocumentHS.png" Height="16" Width="16" SnapsToDevicePixels="True" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
...
<Button Command="ApplicationCommands.New" Content="{StaticResource TB_NewIcon}" Padding="2,2,2,1"/> 
```

或者：

```
<BitmapImage x:Key="TB_NewIcon" UriSource="Toolbar Images\NewDocumentHS.png"/>
...
<Button Command="ApplicationCommands.New" Padding="2,2,2,1">
    <Image Source="{StaticResource TB_NewIcon}" Height="16" Width="16" SnapsToDevicePixels="True" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
</Button> 
```

对于 Button Tag，需要 Padding 属性来确保图像不会在 15 像素的高度处被截断，并且按钮不会调整大小以适应图像。或者，我们可以指定 Padding="1"，但是我们必须手动设置 Height="21" 和 Width="22" 以确保按钮不会调整大小以适应图像
在图像选项卡上，高度和宽度是需要确保图像不被拉伸。SnapsToDevicePixels 和 RenderOptions.BitMapScalingMode 都需要确保没有模糊。我不能保证这适用于所有分辨率。

注意：对于引起最多问题的 NewDocumentHS.png 图标，由于它占据了整整 16 个像素的高度，您可能需要将填充调整为“1,1,3,2”，以便底部与其他图标更正确地对齐。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-29T02:19:23.800

您可能需要考虑尝试**WPF4**中现在可用的新属性。`RenderOptions.BitmapScalingMode`将其留给*HighQuality*或只是不声明它。

在您的根元素（即您的主窗口）上添加此属性：**`UseLayoutRounding="True"`**.

以前仅在 Silverlight 中可用的属性现在已修复所有位图大小问题。:)

> ***请注意 -***布局舍入可能对精确布局产生一些影响：
> 
> *   元素的宽度和/或高度最多可以增长或缩小 1 个像素
>     
>     
> *   物体的放置最多可以移动 1 个像素
>     
>     
> *   居中的元素可以垂直或水平偏离中心最多 1 个像素

在这里找到更多信息：http: [//blogs.msdn.com/text/archive/2009/08/27/layout-rounding.aspx](http://blogs.msdn.com/text/archive/2009/08/27/layout-rounding.aspx)

# .net - .Net HttpWebRequest.GetResponse() 在返回 http 状态代码 400（错误请求）时引发异常

> ID：692342
> 
> 赞同：221
> 
> 时间：2009-03-28T06:40:02.650
> 
> 标签：.net, httpwebrequest

我的情况是，当我从服务器获取 HTTP 400 代码时，服务器告诉我我的请求出了什么问题是一种完全合法的方式（使用 HTTP 响应内容中的消息）

但是，当状态码为 400 时，.NET HttpWebRequest 会引发异常。

我该如何处理？对我来说，400 是完全合法的，而且很有帮助。HTTP 内容包含一些重要信息，但异常让我偏离了方向。

* * *

## 回答 #1

> 赞同：382
> 
> 时间：2009-03-28T07:07:08.280

如果有某种方法可以关闭“抛出非成功代码”，那就太好了，但是如果你捕获 WebException，你至少可以使用响应：

```
using System;
using System.IO;
using System.Web;
using System.Net;

public class Test
{
    static void Main()
    {
        WebRequest request = WebRequest.Create("http://csharpindepth.com/asd");
        try
        {
            using (WebResponse response = request.GetResponse())
            {
                Console.WriteLine("Won't get here");
            }
        }
        catch (WebException e)
        {
            using (WebResponse response = e.Response)
            {
                HttpWebResponse httpResponse = (HttpWebResponse) response;
                Console.WriteLine("Error code: {0}", httpResponse.StatusCode);
                using (Stream data = response.GetResponseStream())
                using (var reader = new StreamReader(data))
                {
                    string text = reader.ReadToEnd();
                    Console.WriteLine(text);
                }
            }
        }
    }
} 
```

您可能希望将“即使它不是成功代码也给我回复”位封装在一个单独的方法中。（如果没有响应，我建议你仍然抛出，例如，如果你无法连接。）

如果错误响应可能很大（这是不寻常的），您可能需要调整[`HttpWebRequest.DefaultMaximumErrorResponseLength`](https://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.defaultmaximumerrorresponselength)以确保获得整个错误。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-01-17T17:56:48.930

我知道很久以前就已经回答了这个问题，但我做了一个扩展方法，希望能帮助其他遇到这个问题的人。

**代码：**

```
public static class WebRequestExtensions
{
    public static WebResponse GetResponseWithoutException(this WebRequest request)
    {
        if (request == null)
        {
            throw new ArgumentNullException("request");
        }

        try
        {
            return request.GetResponse();
        }
        catch (WebException e)
        {
            if (e.Response == null)
            {
                throw;
            }

            return e.Response;
        }
    }
} 
```

**用法：**

```
var request = (HttpWebRequest)WebRequest.CreateHttp("http://invalidurl.com");

//... (initialize more fields)

using (var response = (HttpWebResponse)request.GetResponseWithoutException())
{
    Console.WriteLine("I got Http Status Code: {0}", response.StatusCode);
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-04-20T15:29:56.047

有趣的是，`HttpWebResponse.GetResponseStream()`您`WebException.Response`从服务器获得的响应流与您从服务器收到的响应流不同。**在我们的环境中，当使用对象将400 HTTP 状态**代码返回给客户端时，我们会丢失实际的服务器响应`HttpWebRequest/HttpWebResponse`。从我们所见，与 相关联的响应流`WebException's HttpWebResponse`是在客户端生成的，不包括来自服务器的任何响应主体。非常令人沮丧，因为我们想向客户反馈错误请求的原因。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-07-19T23:02:48.150

我在尝试连接到 Google 的 OAuth2 服务时遇到了类似的问题。

我最终手动编写了 POST，而不是使用 WebRequest，如下所示：

```
TcpClient client = new TcpClient("accounts.google.com", 443);
Stream netStream = client.GetStream();
SslStream sslStream = new SslStream(netStream);
sslStream.AuthenticateAsClient("accounts.google.com");

{
    byte[] contentAsBytes = Encoding.ASCII.GetBytes(content.ToString());

    StringBuilder msg = new StringBuilder();
    msg.AppendLine("POST /o/oauth2/token HTTP/1.1");
    msg.AppendLine("Host: accounts.google.com");
    msg.AppendLine("Content-Type: application/x-www-form-urlencoded");
    msg.AppendLine("Content-Length: " + contentAsBytes.Length.ToString());
    msg.AppendLine("");
    Debug.WriteLine("Request");
    Debug.WriteLine(msg.ToString());
    Debug.WriteLine(content.ToString());

    byte[] headerAsBytes = Encoding.ASCII.GetBytes(msg.ToString());
    sslStream.Write(headerAsBytes);
    sslStream.Write(contentAsBytes);
}

Debug.WriteLine("Response");

StreamReader reader = new StreamReader(sslStream);
while (true)
{  // Print the response line by line to the debug stream for inspection.
    string line = reader.ReadLine();
    if (line == null) break;
    Debug.WriteLine(line);
} 
```

写入响应流的响应包含您所关注的特定错误文本。

特别是，我的问题是我在 url 编码的数据片段之间放置了端线。当我把它们拿出来时，一切正常。您也许可以使用类似的技术连接到您的服务并阅读实际的响应错误文本。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-03-25T15:02:54.267

试试这个（它是 VB 代码 :-)：

```
Try

Catch exp As WebException
  Dim sResponse As String = New StreamReader(exp.Response.GetResponseStream()).ReadToEnd
End Try 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-02-10T16:25:33.987

扩展函数的异步版本：

```
 public static async Task<WebResponse> GetResponseAsyncNoEx(this WebRequest request)
    {
        try
        {
            return await request.GetResponseAsync();
        }
        catch(WebException ex)
        {
            return ex.Response;
        }
    } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-07-22T11:21:54.250

这为我解决了这个问题：
[https ://gist.github.com/beccasaurus/929007/a8f820b153a1cfdee3d06a9c0a1d7ebfced8bb77](https://gist.github.com/beccasaurus/929007/a8f820b153a1cfdee3d06a9c0a1d7ebfced8bb77)

TL;DR：
**问题：**
本地主机返回预期内容，远程 IP 将 400 内容更改为“错误请求”
**解决方案：**
添加`<httpErrors existingResponse="PassThrough"></httpErrors>`为`web.config/configuration/system.webServer`我解决了这个问题；现在，无论我返回的 IP 地址和/或 HTTP 代码如何，所有服务器（本地和远程）都返回完全相同的内容（由我生成）。

# git - 将更改提交到存储库的良好标准是什么？

> ID：692344
> 
> 赞同：3
> 
> 时间：2009-03-28T06:41:26.173
> 
> 标签：git, version-control, commit

我目前正在使用 git 管理多个项目，但是，最近有一个问题一直困扰着我：向主分支和辅助分支提交修改的好基调是什么？应该是“编译时提交”、“工作时提交”还是其他什么？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T08:12:41.680

第一：忽略颠覆策略和源于这种心态的策略。保存更改和发布更改是有区别的。

提交就是保存更改。虽然我不建议提交计时器，但我建议您将其视为保存文件而不是发布版本。当你担心你可能需要回来，但又害怕否则很难回到你所在的地方时，请这样做。

但是，在发布之前重写提交（例如 git rebase -i origin/master #）。在你弄得一团糟中找到意义，并创建一组具有良好提交消息的可理解和干净的提交，并确保每个提交都通过了你可能进行的任何质量检查。然后发布它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T06:55:01.617

这真的取决于，这是您的个人仓库还是许多开发人员共享的仓库？你对这个项目有多远？

就我个人而言，当我完成一个方面并且一切都编译时，我会提交我的 subversion 存储库。它不必是完整的，只是不要被破坏。我宁愿一开始就不会把事情弄坏。

可以签入一半编写的代码，但只能在我的个人分支中签入，通常会附有关于我当时正在做什么以及还需要完成什么的注释。由于我使用 Subversion 并且这是我的个人存储库，因此我主要使用它来离开我的桌面并从我离开笔记本电脑的地方重新开始。

通常，每次提交一个错误/问题/功能很好，但可能不适合您的开发风格。如果这是一个更完整的项目，它可能会成功，因为提交意味着您正在某个地方从列表中划掉项目，这意味着现在又完成了一个项目。

其他需要考虑的事情，对于需要签入的更改有什么重要意义？例如，我昨晚签入了显着更改内部 API 的代码，这意味着我必须记录提交消息和文档中的更改。同时我也修改了一些评论来修正错别字。这会在提交消息上得到一个小的子注释，但我认为这不是一个足够大的问题来单独提交。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T08:40:39.240

一些基本的东西：

1.  努力提交每个“逻辑更改”；错误修复，重构，功能，...
2.  在提交代码之前运行单元测试；确保你没有破坏任何明显的东西（你确实有单元测试，不是吗）。
3.  如果在多开发人员环境中；从 repo 更新并再次运行单元测试，以确保没有冲突的更改破坏了某人的代码（您的或他们的）。
4.  根据需要修复并从 3 开始重复，直到没有任何损坏。
5.  立即提交并交叉手指。
6.  依靠您的持续集成测试来告诉您是否有其他问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T06:49:51.987

如果您使用的是工单管理系统，我会说当任务修复时提交。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T06:50:02.423

我自己选择“尽早提交，经常提交”。如果你有一个自动结帐并继续构建，这显然是行不通的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T08:18:31.010

一次只提交一种**类型**的更改。

每个项目的“类型”意味着不同，但一些流行的例子包括“外观变化”与“功能变化”和“重构”与“添加新”。这使得在查看日志时更容易跟踪更改，也更容易恢复到修订。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T06:48:46.590

退后一步，我尝试处理可以在短时间内完成的问题/错误/功能。如果要花一天以上的时间才能到达一个好的停止点，那么任务就太大了。

也就是说，我认为最佳实践是在代码编译并经过充分测试时提交您的更改（理想情况下，使用随着代码更改提交的单元或集成测试）。

如果编译 + 功能正确 + 经过良好测试 == 'commit when it works' 那么这似乎是适当的规则。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-28T06:52:23.917

***当它起作用时提交***。在我的情况下，这意味着：***自动化冒烟测试，运行它并提交***。

注意：它只是我在提交之前自动化/运行的冒烟测试。回归测试留给持续集成。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-28T08:41:40.097

提交您不想再次编写的任何代码:)

# svn - 使用 SVN 向开源项目提交错误修正的最简单方法是什么？

> ID：692346
> 
> 赞同：1
> 
> 时间：2009-03-28T06:47:50.167
> 
> 标签：svn, open-source, tortoisesvn, patch

使用 SVN 向开源项目提交工作补丁或错误修复的最简单方法是什么？

理想情况下，我想提交一个修订版或补丁，以便他们在批准后可以轻松地将其直接应用到他们的存储库中。

如果重要的话，我正在使用 TortoiseSVN。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T07:01:45.093

右键单击->乌龟svn->创建补丁

这会将工作副本中的更改保存在补丁文件中。这样做时，您将看到您所做更改的完整列表:)

附言。注意如何使用 ->apply patch，任何人都可以轻松地将保存的补丁应用到本地版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T13:32:59.600

这是你应该做的：

1.  确保错误尚未修复（在主干或分支上）。通常，版本中存在的错误已经在开发代码中修复。
2.  获取代码的工作副本
3.  修复工作副本中的错误，编译并测试它
4.  修复错误时，使用与现有代码相同的编码风格（例如，制表符/空格、缩进、变量命名……）
5.  由于您使用的是 TortoiseSVN：右键单击您的工作副本，TSVN 子菜单->创建补丁。将补丁文件保存在某处。
6.  压缩补丁文件（大多数电子邮件应用程序会在附加的文本文件中混淆空格，并且补丁文件根本不应该被混淆 - 压缩它可以防止这种情况发生）
7.  将补丁文件发送到项目邮件列表（或项目开发人员），描述您修复的错误、如何重现错误（或您如何检测到它）以及您如何修复它
8.  检查邮件列表，了解开发人员可能对您的补丁有任何疑问

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T06:53:29.437

不寻常的是，SVN 访问权限仅供开发人员使用，只是为了防止可能不知道代码的人发生意外，甚至想拆除存储库。补丁可以通过 bugtrackers 发送——您进行检查，然后修改您的工作副本。因为您无法使用 SVN 将更改发回，所以您创建一个差异文件（补丁）并将其发布在项目讨论板或 bugtracker 上，具体取决于它解决的问题。如果用户和开发人员喜欢它，他们会将其与官方存储库集成。使用差异文件，这很容易。

请注意，有时可以获得您自己的项目分支。例如，开源游戏 OpenTTD 为想要维护自己的补丁或新功能的人提供了 git 存储库。其他项目可能会使用 Launchpad。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T06:57:36.150

您需要确保您拥有源代码的最新更新，并确保您所做的任何更改仍然正确地合并到代码中。之后，您将希望对原始源代码和您编写的新源代码（svn diff）进行比较。

您获取此差异，并将其发送到适当的位置，例如邮件列表、某种错误跟踪器，或者如果项目由一个人运行，则发送给原始作者。

# ruby-on-rails - Rails Resource Restful Routes Helper 函数和 nil oject 错误

> ID：692347
> 
> 赞同：1
> 
> 时间：2009-03-28T06:47:59.120
> 
> 标签：ruby-on-rails, activerecord, routes

尝试使用资源路由辅助函数时出现错误

```
 <%= link_to_remote "Delete", {
        :method => :delete, 
        :url=> phone_numbers_url(phone_number_display.id), 
        :update => "section_phone"
        }%> 
```

在我的路线中，我有

```
 map.resources :phone_numbers 
```

我收到以下错误

```
 You have a nil object when you didn't expect it!
 The error occurred while evaluating nil.to_sym 
```

当我使用

```
:url=> phone_numbers_url(:id => phone_number_display.id) 
```

我不再收到错误，但我得到了不安的网址

```
 http://localhost:3000/phone_numbers?id=1 
```

我不明白这个错误，因为 phone_number_display.id 不为空

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T17:04:33.693

您想要路线的单数版本：

```
phone_number_url(phone_number_display) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T08:25:41.383

不需要将尾随参数括在 {} 中，因为无论如何它们都会被转换为 Hash。请参阅[link_to_remote 的 api](http://apidock.com/rails/ActionView/Helpers/PrototypeHelper/link_to_remote)。我不知道这是否是导致问题的原因，但这是我要尝试的第一件事。

```
 <%= link_to_remote "Delete",
            :method => :delete, 
            :url=> phone_numbers_url(phone_number_display.id), 
            :update => "section_phone"
            %> 
```

在那之后，如果它仍然无法正常工作，我会查看该`phone_numbers_url(phone_number_display.id)`部件，以检查我是否得到了我所期望的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T16:46:35.883

`phone_numbers_`**使用路径**也可能更可取，`(phone_number_display.id)`因为这将为您提供相对路径“ `/phone_numbers?id=1`”而不是完整`http://localhost.../..`路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T08:24:52.023

如果您刚刚创建了这条路线，您可能需要重新启动您的 mongrel。

您也可能需要运行 rake 路线来仔细检查命名路线。

# django - 用于 OS X 的独立 Django 应用程序

> ID：692354
> 
> 赞同：1
> 
> 时间：2009-03-28T06:52:34.460
> 
> 标签：django, distribution

对于学校，我在 django 中为我的软件主要评估任务制作了一个 CMS。我的老师要求获取源代码，如果适用，还需要编译程序。

现在，因为我不想让我的老师安装 django（可能会出错，他可能会得到不同的版本，缺少依赖项），我如何打包我的 django 应用程序，加上 django 源并使整个东西可以运行（在开发服务器）通过运行单个脚本？

他有 python，所以不需要包含它，目标操作系统是 OS X，但 Windows 也可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T12:06:10.743

Pip 和 VirtualENV 将使这项任务变得更加容易。（虽然不确定是否支持 Windows）

PIP 将帮助安装需求。 [http://pypi.python.org/pypi/pip](http://pypi.python.org/pypi/pip)

VirtualENV 提供了一个隔离的 python 环境。网址： http: [//pypi.python.org/pypi/virtualenv](http://pypi.python.org/pypi/virtualenv)

阅读这篇关于安装 Pinax 的博文将使您对两者如何协同工作有一个很好的理解：http: [//uswaretech.com/blog/2009/03/create-a-new-social-networking-site-in-few -小时-使用-pinax-平台-django/](http://uswaretech.com/blog/2009/03/create-a-new-social-networking-site-in-few-hours-using-pinax-platform-django/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T06:56:46.977

也许[Instant Django](http://www.instantdjango.com/)会让您朝着正确的方向前进。它适用于Windows，但可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-15T23:11:21.037

在没有实际测试的情况下，您应该能够将主 django 目录（对我来说是 /usr/lib/python2.6/site-packages/django）复制到您的项目目录中，并将整个内容存档。这将继续保持所有可导入的内容（来自 django import ...），并使其只有一个存档可供提取。

现在，我不会说这是一个*好*方法，但它很简单，而且我认为它会起作用。我认为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-08T05:34:37.887

我相信[这](http://misunderstandings.wordpress.com/2008/06/26/django-desktop-app/)就是您要寻找的东西（它不漂亮，但可以完成工作）。它描述了如何打包 django、Web 服务器以及制作独立 django 应用程序所需的一切。为了使它适用于 osx，您应该能够替换 py2app (http://svn.pythonmac.org/py2app/py2app/trunk/doc/index.html) 而不是 py2exe，它应该（交叉手指）工作，但是我还没有测试过。希望这可以帮助！

Ps：很抱歉没有超链接 py2app 我是一个新用户，还不能发布 2 个链接 :(

# ruby-on-rails - 如何在ruby中解析字符串中最后一组括号之间的子字符串

> ID：692355
> 
> 赞同：1
> 
> 时间：2009-03-28T06:52:38.580
> 
> 标签：ruby-on-rails, ruby, regex

在我的 ruby​​ on rails 应用程序中，我正在尝试构建一个解析器来从字符串中提取一些元数据。

假设示例字符串是：

> 敏捷的红狐狸 (frank, 10) 跳过了懒惰的棕色狗 (ralph, 20)。

我想从 ( ) 的最后一次出现中提取子字符串。

所以，无论字符串中有多少（），我都想得到“ralph，20”。

有没有最好的方法来创建这个红宝石字符串提取......正则表达式？

谢谢，

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T07:03:06.247

看起来你想要一个[sexeger](http://japhy.perlmonk.org/sexeger/sexeger.html)。它们通过反转字符串、对字符串运行反转的正则表达式，然后反转结果来工作。这是一个示例（请原谅代码，我不太了解 Ruby）：

```
#!/usr/bin/ruby

s = "The quick red fox (frank,10) jumped over the lazy brown dog (ralph, 20).";

reversed_s = s.reverse;
reversed_s =~ /^.*?\)(.*?)\(/;
result = $1.reverse;
puts result; 
```

这没有得到支持的事实告诉我，没有人点击阅读您为什么要使用性交，所以这里是一个基准测试的结果：

```
do they all return the same thing?
ralph, 20
ralph, 20
ralph, 20
ralph, 20
                        user     system      total        real
scan greedy         0.760000   0.000000   0.760000 (  0.772793)
scan non greedy     0.750000   0.010000   0.760000 (  0.760855)
right index         0.760000   0.000000   0.760000 (  0.770573)
sexeger non greedy  0.400000   0.000000   0.400000 (  0.408110) 
```

这是基准：

```
#!/usr/bin/ruby

require 'benchmark'

def scan_greedy(s)
    result = s.scan(/\([^)]*\)/x)[-1]
    result[1 .. result.length - 2]
end

def scan_non_greedy(s)
    result = s.scan(/\(.*?\)/)[-1]
    result[1 .. result.length - 2]
end

def right_index(s)
    s[s.rindex('(') + 1 .. s.rindex(')') -1]
end

def sexeger_non_greedy(s)
    s.reverse =~ /^.*?\)(.*?)\(/
    $1.reverse
end

s = "The quick red fox (frank,10) jumped over the lazy brown dog (ralph, 20).";

puts "do they all return the same thing?", 
    scan_greedy(s), scan_non_greedy(s), right_index(s), sexeger_non_greedy(s)

n = 100_000
Benchmark.bm(18) do |x|
    x.report("scan greedy")        { n.times do; scan_greedy(s); end }
    x.report("scan non greedy")    { n.times do; scan_non_greedy(s); end }
    x.report("right index")        { n.times do; scan_greedy(s); end }
    x.report("sexeger non greedy") { n.times do; sexeger_non_greedy(s); end }
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T06:57:40.253

我会试试这个（这里我的正则表达式假设第一个值是字母数字，第二个值是数字，相应调整）。在这里，扫描将所有出现作为一个数组获取，-1 告诉我们只抓取最后一个，这似乎正是您所要求的：

```
>> foo = "The quick red fox (frank,10) jumped over the lazy brown dog (ralph, 20)."
=> "The quick red fox (frank,10) jumped over the lazy brown dog (ralph, 20)."
>> foo.scan(/\(\w+, ?\d+\)/)[-1]
=> "(ralph, 20)" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T08:35:20.003

一个简单的非正则表达式解决方案：

```
string = "The quick red fox (frank,10) jumped over the lazy brown dog (ralph, 20)."
string[string.rindex('(')..string.rindex(')')] 
```

例子：

```
irb(main):001:0> string =  "The quick red fox (frank,10) jumped over the lazy brown dog (ralph, 20)."
=> "The quick red fox (frank,10) jumped over the lazy brown dog (ralph, 20)."
irb(main):002:0> string[string.rindex('(')..string.rindex(')')]
=> "(ralph, 20)" 
```

并且没有括号：

```
irb(main):007:0> string[string.rindex('(')+1..string.rindex(')')-1]
=> "ralph, 20" 
```

# sql - 快速 SQL 问题：在 H2 中创建具有主键的表的正确语法？

> ID：692363
> 
> 赞同：14
> 
> 时间：2009-03-28T06:59:04.040
> 
> 标签：sql, database, h2, create-table

我目前正在使用[H2 数据库](http://www.h2database.com/html/main.html)启动一个新的 Java 应用程序，但我对创建表的基本 SQL 使用有些困惑。如何制作一个条目（字符串）表，每个条目（字符串）都有唯一的、自动递增的、非空的、整数主键？最基本的事情之一，但我不确定使用 H2 的正确方法是什么。

我将这些归咎于我的困惑（指定了在不同数据库之间做同样事情的不止一种方法；但无法为 H2 找到正确的方法）： http: [//www.w3schools.com/Sql/sql_primarykey.asp](http://www.w3schools.com/Sql/sql_primarykey.asp) [http ://www.w3schools.com/Sql/sql_autoincrement.asp](http://www.w3schools.com/Sql/sql_autoincrement.asp)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-28T07:14:37.247

如果我正确阅读 H2 文档，这应该有效：

```
CREATE TABLE MyTableName(PKFieldName IDENTITY PRIMARY KEY, StringFieldName VARCHAR(255)) 
```

基本上，您只想将您的键列声明为 type `IDENTITY`。

`IDENTITY`类型见：http [://www.h2database.com/html/datatypes.html#identity_type](http://www.h2database.com/html/datatypes.html#identity_type)
语法`CREATE TABLE`见：[http ://www.h2database.com/html/grammar.html#create_table](http://www.h2database.com/html/grammar.html#create_table)

# php - 你觉得 PHP 框架中的视图实现方便吗？

> ID：692379
> 
> 赞同：1
> 
> 时间：2009-03-28T07:18:56.817
> 
> 标签：php, frameworks, view, template-engine

今天所有流行的 PHP 框架都使用他们自己的视图层实现，它基于纯 PHP 模板和许多帮助程序。我已经尝试了其中的一些，并且总是发现这种方法给非常简单的事情带来了巨大的复杂性。例如，在 Zend Framework 中，表单和分页使用它们自己的解决方案来定制这些项目的外观。助手重新发明了循环，也提供了相当慢的解决方案，而整个视图层在我看来并不作为一个部分存在，但它的许多功能都委托给了脚本的其他部分。Symfony 和管理生成器中也出现了相同的配置问题，而在 Kohana 中，我被迫在所有表单中复制相同的代码。PHP 真的是视图层的好选择吗？您是否还发现这些实现不方便，或者，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T07:52:52.507

还有其他几个模板引擎。但是我一直发现纯 php 是最方便的。我只是更舒服。

我不喜欢 ZF 中的视图助手的一点是，它通常使我的代码更加臃肿而不是更干净。我特别在谈论 $this->url() 助手:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T08:06:19.573

现在我喜欢 PHP，但归根结底，它是一种模板语言，不是通用编程语言[，也不是面向对象的语言](http://michaelkimsal.com/blog/php-is-not-object-oriented/)。不要与之抗争。拥抱它。

我查看了一些不同的 MVC 框架，例如 Symfony、CakePHP 和 Zend，但我很难理解这些示例。通常它们是“使用这 17 个文件，您可以制作一个‘Hello world’程序！” 啊？！？！

存在复杂性之类的东西，并在遇到问题之前解决问题，我还不能相信这些重量级（它们**是**重量级）框架确实增加了价值。

我更喜欢[“无框架”框架](http://toys.lerdorf.com/archives/38-The-no-framework-PHP-MVC-framework.html)。这真的是“自己动手”，但我认为它会带来最精简、最干净的最终结果。

我对Smarty也有同样的感觉。SO 上的很多人都是 Smarty 的忠实拥护者，但对我来说，为什么要在...模板语言中添加模板语言从来没有意义。

最终我最终大部分时间都在编写这种 PHP 脚本

```
<?
require 'config.h'; // set up constants, DB connections and so on
page_header('My Page'); // page header, site menu and so on
deny_unregistered(); // security
if (/* user submitted page */) {
  $valid = validate_form(/* validation rules */);
  if ($valid === true) {
    // do db changes
    // redirect user ie POST+REDIRECT+GET
  } else {
    // output error messages
  }
}
?>
// display page
<? page_footer(); ?> 
```

通过明智地使用辅助函数（例如分页链接），上述内容非常容易阅读和调试。我也更喜欢这个模型：

网址：/index.php?inc=blah

索引.php：

```
<?
require "$inc.php"; // hopefully you sanitize this but so many don't
?> 
```

我觉得这很丑陋，容易出错，甚至很危险。我有一个 PHP 文件的层次结构，它反映了每个页面都是 PHP 脚本的站点结构（从菜单的角度来看）。如果他们有共同的行为，他们都需要它（[**不是 require_once**](http://www.techyouruniverse.com/software/php-performance-tip-require-versus-require_once)，它通常用作不良组织的黑客）。

简单、容易、易懂、直接。

似乎很多程序员会在真正需要之前将框架投入其中。我认为这是一种相当懒惰的做法，而且成本很高：今天做出的每一个决定以后都会变得更难改变，所以尽可能推迟做出这样的决定。稍后再引入比现在引入更容易，发现它并没有真正做到你想要的，然后再改变它。

# c - C 风格：宏还是预处理器？

> ID：692382
> 
> 赞同：4
> 
> 时间：2009-03-28T07:24:40.967
> 
> 标签：c, macros, preprocessor, c-preprocessor

我编写了一个库来将字符串与一组模式进行匹配，现在我可以轻松地将词法扫描器嵌入到 C 程序中。

我知道有许多完善的工具可用于创建词法扫描器（lex 和 re2c，仅列出想到的前两个）**这个问题与词法分析器无关，而是关于“扩展”C 语法的最佳方法**。词法分析器示例只是一般问题的具体案例。

我可以看到两种可能的解决方案：

1.  **编写一个预处理器**，将带有嵌入式词法分析器的源文件转换为纯 C 文件，并可能转换为要在编译中使用的一组其他文件。
2.  **编写一组 C 宏**来以更易读的形式表示词法分析器。

我已经做了这两个，但问题是：**“根据以下标准，你认为哪一个更好？”**

*   可读性。词法分析器逻辑应该清晰易懂
*   可维护性。查找和修复错误不应该是一场噩梦！
*   干扰构建过程。预处理器在构建过程中需要一个额外的步骤，预处理器必须在路径中等等。

换句话说，如果你必须维护或编写一个使用这两种方法之一的软件，哪一种会让你失望更少？

例如，以下是针对以下问题的词法分析器：

*   对所有数字求和（可以是十进制形式，包括像 1.3E-4.2 这样的指数形式）
*   跳过字符串（双引号和单引号）
*   跳过列表（类似于 LISP 列表： (3 4 (0 1)() 3) ）
*   在遇到单词 end（大小写无关）或缓冲区末尾时停止

在两种风格中。

```
/**** SCANNER STYLE 1 (preprocessor) ****/
#include "pmx.h"

t = buffer

while (*t) {
  switch pmx(t) { /* the preprocessor will handle this */
    case "&q" :         /* skip strings */
      break; 

    case "&f<?=eE>&F" : /* sum numbers */ 
      sum += atof(pmx(Start,0));
      break;

    case "&b()":        /* skip lists */
      break;

    case "&iend" :      /* stop processing */ 
      t = "";
      break;

    case "<.>":         /* skip a char and proceed */
      break;
  }
} 
```

* * *

```
/**** SCANNER STYLE 2 (macros) ****/
#include "pmx.h"
/* There can be up to 128 tokens per scanner with id x80 to xFF */
#define TOK_STRING x81
#define TOK_NUMBER x82
#define TOK_LIST   x83
#define TOK_END    x84
#define TOK_CHAR   x85

pmxScanner(   /* pmxScanner() is a pretty complex macro */
   buffer
 ,
   pmxTokSet("&q"         , TOK_STRING)
   pmxTokSet("&f<?=eE>&F" , TOK_NUMBER)
   pmxTokSet("&b()"       , TOK_LIST)
   pmxTokSet("&iend"      , TOK_END)
   pmxTokSet("<.>"        , TOK_CHAR)
 ,
   pmxTokCase(TOK_STRING) :   /* skip strings */
     continue; 

   pmxTokCase(TOK_NUMBER) :   /* sum numbers */ 
     sum += atof(pmxTokStart(0));
     continue;

   pmxTokCase(TOK_LIST):      /* skip lists */
     continue;

   pmxTokCase(TOK_END) :      /* stop processing */ 
     break; 

   pmxTokCase(TOK_CHAR) :     /* skip a char and proceed */
     continue;
); 
```

如果有人对当前的实现感兴趣，代码在这里：[http](http://sites.google.com/site/clibutl) ://sites.google.com/site/clibutl 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T07:36:29.533

预处理器将提供更健壮和通用的解决方案。另一方面，宏可以快速启动，提供良好的概念验证，并且在示例关键字/标记空间较小时很容易。在某个点之后，使用宏扩展/包含新功能可能会变得乏味。我会说启动宏开始，然后将它们转换为您的预处理器命令。

此外，如果可能的话，尽量使用通用预处理器而不是编写自己的预处理器。

> [...] 我将有另一个依赖项来处理（例如 Windows 的 m4）。

是的。但是你写的任何解决方案也是如此:)——*你*必须维护它。您命名的大多数程序都有可用的 Windows 端口（例如，请参阅[m4 for windows](http://gnuwin32.sourceforge.net/packages/m4.htm)）。使用这种解决方案的优点是您可以节省*大量*时间。当然，不利的一面是，如果出现奇怪的错误，您可能必须尽快了解源代码（尽管维护这些错误的人非常有帮助，并且肯定会确保您得到所有​​帮助）。

再说一次，是的，我更喜欢打包的解决方案而不是我自己的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T07:35:14.843

自定义预处理器是解析器/解释器生成器中的典型方法，因为宏的可能性非常有限，并且在扩展阶段会出现潜在问题，从而使调试变得非常困难。

我建议您使用久经考验的工具，例如经典的 Yacc/Lex Unix 程序，或者如果您想“扩展”C，请使用 C++ 和 Boost::spirit，这是一个广泛使用模板的解析器生成器。

# datetime - 日期范围和时期的好图书馆

> ID：692384
> 
> 赞同：2
> 
> 时间：2009-03-28T07:31:16.240
> 
> 标签：datetime, calendar

这个问题是[90308的一个子集](https://stackoverflow.com/questions/90308/what-languages-do-date-time-and-calendar-operations-really-well)

我正在寻找可以处理周期性概念的任何语言的良好日期库

独立于年份的日期范围/集合：

```
 dr = 1 May - 31 August

  (4 May 2010) in dr 
```

真的

```
 (4 May 2011) in dr 
```

真的

```
 (4 March 2012) in dr 
```

错误的

日集：

```
 ds = m tu w sa su

  (Mon, 4 May 2010) in ds 
```

真的

```
 (Thurs, 7 May 2010) in ds 
```

错误的

上面还有很好的类似集合的操作，例如交集、联合和逆

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T14:47:29.560

如果您熟悉 C++，则可以使用 boost::date_time。[请参阅http://www.boost.org/doc/libs/1_38_0/doc/html/date_time/examples.html#date_time.examples.date_period_calc](http://www.boost.org/doc/libs/1_38_0/doc/html/date_time/examples.html#date_time.examples.date_period_calc)中的示例

# .net - .NET 框架 3.0 服务包 1

> ID：692400
> 
> 赞同：0
> 
> 时间：2009-03-28T07:45:18.750
> 
> 标签：.net, .net-3.5, 64-bit

我很困惑，没有 64 位 .NET Framework 3.0 Service Pack 1 下载？如果有的话，谁能给我一个链接吗？我的操作系统是 Windows Server 2003 x64。谢谢。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T07:49:42.653

只需[下载 3.5 SP1](http://www.microsoft.com/downloads/details.aspx?FamilyID=AB99342F-5D1A-413D-8319-81DA479AB0D7&displaylang=en)即可。它包括 2.0 SP2 和 3.0 SP2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T09:11:12.817

经过一番搜索，我认为[这个链接](http://go.microsoft.com/fwlink/?LinkId=98106)（NetFx30SP1_x64.exe）就是你想要的。

我从[这个页面](http://social.msdn.microsoft.com/Forums/en-US/netfxsetup/thread/1b49eb80-093a-4201-982d-b525a5e90c70/)得到了信息。

# .net - 你好，带有 C# 和单声道的操作系统？

> ID：692410
> 
> 赞同：4
> 
> 时间：2009-03-28T07:55:47.773
> 
> 标签：.net, mono

有没有办法用 C# 代码识别我们在哪个操作系统中运行单声道？

某种 Hello World，但不是使用固定字符串作为输出，而是使用当前操作系统？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T07:58:53.070

尝试`System.Environment.OSVersion`

您还可以检测您的代码是在 Mono 还是 MS.NET 下运行：

```
if (Type.GetType("Mono.Runtime") != null) 
{
    // we're on Mono
    IsMono = true;
} 
else
    IsMono = false; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T08:01:13.237

此链接： http://mono-project.com/FAQ: [_Technical#How_to_detect_the_execution_platform_.3F](http://mono-project.com/FAQ:_Technical#How_to_detect_the_execution_platform_.3F)

给出这个代码：

使用系统；

```
class Program {

    static void Main ()
    {
            int p = (int) Environment.OSVersion.Platform;
            if ((p == 4) || (p == 6) || (p == 128)) {
                    Console.WriteLine ("Running on Unix");
            } else {
                    Console.WriteLine ("NOT running on Unix");
            }
    }
} 
```

# php - 使用php GD库输出带下划线文本的图像

> ID：692411
> 
> 赞同：3
> 
> 时间：2009-03-28T07:56:32.437
> 
> 标签：php, gd

使用 GD 或任何其他库显示带下划线的文本并将结果输出为图像的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T11:39:10.357

您可以尝试使用 Unicode 下划线组合字符`U+0332`。

```
<?php
// Set the content-type
header('Content-type: image/png');

// Create the image
$im = imagecreatetruecolor(400, 30);

// Create some colors
$white = imagecolorallocate($im, 255, 255, 255);
$black = imagecolorallocate($im, 0, 0, 0);
imagefilledrectangle($im, 0, 0, 399, 29, $white);

// The text to draw
$text = "&#x0332;U&#x0332;d&#x0332;e&#x0332;r&#x0332;l&#x0332;i&#x0332;n&#x0332;e";
// Replace path by your own font path
$font = 'arial.ttf';

// Add the text
imagettftext($im, 20, 0, 10, 20, $black, $font, $text);

// Using imagepng() results in clearer text compared with imagejpeg()
imagepng($im);
imagedestroy($im);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T08:59:00.053

有很多免费的 PHP CAPTCHA 带有很多自定义，下载一个看看幕后到底发生了什么。也看看这个[链接](http://www.thesitewizard.com/php/create-image.shtml)

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T10:43:06.963

我正在使用这个...

```
 $font = imageloadfont($font_file);  
$font_width = ImageFontWidth($font);
$font_height = ImageFontHeight($font);
    $str_width = strlen($text)*$font_width;
    ImageLine($image, $left, $top+$font_height, $left+$str_width,  $top+$font_height, $color); 
```

# .net - 如何学习 .NET 框架

> ID：692418
> 
> 赞同：31
> 
> 时间：2009-03-28T08:03:01.327
> 
> 标签：.net

考虑到 .net 是一个庞大的类、结构、接口、方法等集合的事实，什么是开始和理解框架基础的正确和适当的方法。

牢记两个事实，经验无可​​替代，学习无止境。

非常感谢。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-28T08:09:52.013

首先选择一种 .Net 语言进行学习。我个人会选择 C# 作为 .Net 开发的中流砥柱。然后去编写一些代码，比如[Project Euler 中的问题](http://www.google.com.au/search?hl=en-GB&q=project+euler&sourceid=navclient-ff&rlz=1B3GGGL_en-GBAU319AU319&ie=UTF-8)。

一旦您掌握了该语言的基础知识（如数据类型、语言结构等），那么现在是开始学习一个或多个 .Net 框架的合适时机。在这里，您只需选择您感兴趣的任何内容，无论是用于桌面开发的 WPF、用于 Web 开发的 ASP.NET/ASP.NET MVC、WCF 等。

语言第一，图书馆第二。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-21T17:36:17.957

就像其他人所说的那样，我首先要选择 .Net 框架的语言。确定语言后，再决定要开发的应用程序类型。.Net 有用于学习每种应用程序类型的门户。

Windows 客户端（WinForms 或 WPF）- [http://windowsclient.net/](http://windowsclient.net/)

Web 客户端（ASP.Net 或 ASP.Net MVC）- [http://asp.net/](http://asp.net/)

Silverlight/RIA 应用程序 - [http://www.silverlight.net/](http://www.silverlight.net/)

这些站点中的每一个都有专门针对的教程，这些教程将帮助您学习语言以及如何将它们应用到您想要开发的应用程序类型中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T08:15:08.663

这取决于你的性格。有些人喜欢书本方法——找到类似[70-536 教学大纲](http://www.microsoft.com/learning/en/us/exams/70-536.aspx)的内容，然后开始阅读。就个人而言，我更“亲力亲为”——选择一种技术（例如 ASP.NET MVC）和一种语言（通常是 C# 或 VB）并开始尝试。当您遇到困难或不确定时，请查看此处（先搜索），然后询问；-p

请注意，该语言在许多方面是次要的，但人们倾向于对它产生宗教信仰......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T08:11:55.300

改为学习 C。

不只是在开玩笑。你有其他编程语言的经验吗？如果有，是哪一种？您的正确方法将在很大程度上取决于此。如果您有任何 Java 经验，您应该尝试 C#。如果 VB 试试 VB.Net。如果 Python 尝试 IronPython。如果 Ruby 尝试 IronRuby。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T09:04:56.233

你不需要学习整个框架，选择一本好书开始学习它。在学习的过程中你会遇到问题，你会看到其他人的代码对你有帮助。试着买一本有很多例子的书。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T09:42:42.743

您只需了解您需要的示例，如果您想开发 Web 应用程序，您不会去学习如何制作 WPF 或 Windows 窗体应用程序，但您需要了解 ASP.NET

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T10:00:08.083

我认为学习 .NET 的最佳方法是编写 .NET 旨在执行的应用程序（不必很大或很复杂），例如使用组件而不是直接编写 html 设计的数据驱动的 Web 应用程序、桌面应用程序使用 Web 服务、可与其他平台互操作的服务等。诸如此类的东西。

像 Twitter 客户端这样的东西一开始会很有趣。您可以从简单开始，随着您对 .NET 的更多了解逐渐添加功能。当您使用 C# 阅读和写作时，您最终会掌握该语言。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-09-21T17:32:07.220

从哪里开始很大程度上取决于您的学习方式。就个人而言，我喜欢在解决问题**之前对可用的工具进行评估。**我想知道工具箱里有什么，并了解每个工具的作用。其他人更喜欢在知道他们正在寻找什么类型的工具后才深入研究问题并打开工具箱。对我来说，这比较慢，并且增加了选择错误工具的可能性。

如果您像我一样，我会推荐（如 Marc Gravell）70-536 培训指南。这些例子可能太微不足道而无法应用于现实世界，但这不是重点。其目的是为您提供工具箱的导览。从这里开始了解**核心**框架，然后继续阅读其中一本书（或在线教程），它们将指导您利用框架的各个部分来完成一些实用的事情。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-23T13:42:22.943

这将是一个快速入门 >> [.NET 教程](http://mottishaked.com/training/dot-net-tutorial)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-17T13:41:50.457

Visual Studio 中视图菜单下的对象浏览器怎么样？您可以搜索并且方法的文档就在那里。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-05-09T12:00:05.193

为了让您自己更轻松：如果您熟悉 vb6，请从 vb 开始。net 或者，如果您对 c++ 感到满意，可以从 c# 开始。如果您要设计单用户 GUI 应用程序，我建议您坚持使用 vb.net。但是，如果您打算开发动态网站（使用 ASP.NET），c# 是更好的选择。同时精通面向对象编程原理的概念。顺便说一句，我翻阅了一本关于亚马逊的好书，请查看此链接[http://www.amazon.in/Guide-NET-1st-2011/dp/8192113043/ref=sr_1_61?s=books&ie=UTF8&qid=1431171630&sr=1- 61&keywords=a+guide+to+.net](http://www.amazon.in/Guide-NET-1st-2011/dp/8192113043/ref=sr_1_61?s=books&ie=UTF8&qid=1431171630&sr=1-61&keywords=a+guide+to+.net)帮助我更好地掌握 .net

# c++ - 是提升 shared_ptr 线程安全吗？

> ID：692438
> 
> 赞同：32
> 
> 时间：2009-03-28T08:21:16.713
> 
> 标签：c++, boost, thread-safety, shared-ptr, boost-smart-ptr

我有一个关于`boost::shared_ptr<T>`.

有很多线程。

```
using namespace boost;

class CResource
{
  // xxxxxx
}

class CResourceBase
{
public:
   void SetResource(shared_ptr<CResource> res)
   {
     m_Res = res;
   }

   shared_ptr<CResource> GetResource()
   {
      return m_Res;
   }
private:
   shared_ptr<CResource> m_Res;
}

CResourceBase base;

//----------------------------------------------
// Thread_A:
    while (true)
    {
       //...
       shared_ptr<CResource> nowResource = base.GetResource();
       nowResource.doSomeThing();
       //...
    }

// Thread_B:
    shared_ptr<CResource> nowResource;
    base.SetResource(nowResource);
    //... 
```

## 第一季度

如果**Thread_A**不关心`nowResource`是最新的，这部分代码会有问题吗？

我的意思是当**Thread_B**不`SetResource()`完全时，**Thread_A**得到一个错误的智能点`GetResource()`？

## 第二季度

线程安全是什么意思？

如果我不关心资源是否是最新`shared_ptr<CResource> nowResource`的，释放时程序会崩溃`nowResource`还是问题会破坏`shared_ptr<CResource>`？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-28T16:13:55.377

`boost::shared_ptr<>`提供一定程度的线程安全。引用计数以线程安全的方式进行操作（除非您将 boost 配置为禁用线程支持）。

因此，您可以复制 a`shared_ptr`并正确维护 ref_count。您不能在多个线程中安全地做的是从多个线程修改实际`shared_ptr`对象实例本身（例如从多个线程调用`reset()`它）。所以你的使用是不安全的——你`shared_ptr`在多个线程中修改实际实例——你需要有自己的保护。

在我的代码中，`shared_ptr`'s 通常是局部变量或按值传递的参数，所以没有问题。将它们从一个线程转移到另一个我通常使用线程安全队列。

当然，这些都没有解决访问指向的对象的线程安全问题`shared_ptr`- 这也取决于您。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-03-28T08:27:34.170

从升压[文档](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/shared_ptr.htm#ThreadSafety)：

> `shared_ptr`对象提供与内置类型相同级别的线程安全。`shared_ptr`多个线程可以同时“读取”一个实例（仅使用 const 操作访问）。*多个线程可以同时“写入”不同* `shared_ptr` 的实例（使用可变操作（例如`operator=`或重置）访问）（即使这些实例是副本，并且在下面共享相同的引用计数。）
> 
> 任何其他同时访问都会导致未定义的行为。

所以你的使用是不安全的，因为它使用同时读取和写入`m_res`. boost 文档中的*示例 3也说明了这一点。*

您应该使用单独的[互斥锁](http://www.boost.org/doc/libs/1_38_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_types)来保护对`m_res`in `SetResource`/的访问`GetResource`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-08T13:45:43.540

好吧，tr1::shared_ptr（基于 boost）文档讲述了一个不同的故事，这意味着资源管理是线程安全的，而对资源的访问则不是。

“……

线程安全

仅限 C++0x 的功能是：rvalue-ref/move 支持、分配器支持、别名构造函数、make_shared 和 allocate_shared。此外，采用 auto_ptr 参数的构造函数在 C++0x 模式下已弃用。

Boost shared_ptr 文档的线程安全部分说“shared_ptr 对象提供与内置类型相同级别的线程安全”。实现必须确保对单独的 shared_ptr 实例的并发更新是正确的，即使这些实例共享一个引用计数，例如

shared_ptr a(新 A); shared_ptr b(a);

// 线程 1 // 线程 2

a.reset(); b.reset();

动态分配的对象必须由其中一个线程销毁。弱引用使事情变得更加有趣。用于实现 shared_ptr 的共享状态必须对用户透明，并且必须始终保留不变量。共享状态的关键部分是强引用计数和弱引用计数。这些更新需要是原子的并且对所有线程都是可见的，以确保正确清理托管资源（毕竟这是 shared_ptr 的工作！）在多处理器系统上可能需要内存同步，以便引用计数更新和销毁的托管资源是无竞争的。

……”

见 [http://gcc.gnu.org/onlinedocs/libstdc++/manual/memory.html#std.util.memory.shared_ptr](http://gcc.gnu.org/onlinedocs/libstdc++/manual/memory.html#std.util.memory.shared_ptr)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-13T03:25:20.673

**m_Res**不是线程安全的，因为它同时读/写，你需要 boost::atomic_store/load 函数来保护它。

```
//--- Example 3 ---
// thread A
p = p3; // reads p3, writes p
// thread B
p3.reset(); // writes p3; undefined, simultaneous read/write 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-06-15T02:46:24.970

添加，你的类有一个循环引用条件；`shared_ptr<CResource> m_Res`不能成为 的成员`CResourceBase`。你可以`weak_ptr`改用。

# .net - .NET 3.5SP1 ORM - 与数据库无关

> ID：692439
> 
> 赞同：1
> 
> 时间：2009-03-28T08:22:21.623
> 
> 标签：.net, sql-server, oracle, orm

我们正在开发一个从 Oracle DB 和 SQLServer 中挖掘数据的应用程序。需要（可能是免费的）ORM 解决方案，我想使用实体框架，但它不支持 Oracle。

有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T09:27:18.787

NHibernate 是一个出色的 .NET ORM 解决方案。我在很多项目中都使用过它。

*   [http://www.hibernate.org/343.html](http://www.hibernate.org/343.html)

一种更封闭的微软 ORM 解决方案是 Deklarit。有用。新手可能更容易使用。但是，当您遇到问题时，您会更加依赖 Deklarit 供应商。我个人会使用 NHibernate 而不是 Deklarit，除非您是数据库工具的新手并且您非常喜欢集成到 Visual Studio 中的开发工具。

*   [http://www.deklarit.com](http://www.deklarit.com/)

另请参阅 csharp-source.net 以获取持久性框架列表：

*   [http://csharp-source.net/open-source/persistence](http://csharp-source.net/open-source/persistence)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T10:03:48.247

实体框架是可插拔的；应该有许多用于 Oracle 的 3rd 方 Oracle 提供商，例如[dotConnect](http://www.devart.com/dotconnect/oracle/)（[教程](http://www.devart.com/dotconnect/oracle/articles/tutorial_ef.html)）。

或者; [DbLinq](http://code2code.net/DB_Linq/)是 LINQ-to-SQL/DataContext 的变体，并具有 Oracle 支持（加号是免费的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T09:07:15.683

[NHibernate](http://www.hibernate.org/343.html) -[支持的数据库列表](http://www.hibernate.org/361.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-29T14:25:18.967

NHibernate：http: [//community.jboss.org/wiki/DatabasessupportedbynHibernate](http://community.jboss.org/wiki/DatabasessupportedbynHibernate)

# asp.net - 将 .dbml 文件编译成单独的程序集

> ID：692440
> 
> 赞同：3
> 
> 时间：2009-03-28T08:22:22.123
> 
> 标签：asp.net, linq-to-sql, assemblies

我有一个网站项目，并在其中使用 Linq to SQL。目前，我的 .dbml 文件位于 App_Code 目录中，但我想将其分离到不同的项目中，以便将其编译为单独的 dll；是否可以？

我尝试将数据库项目添加到我的解决方案中，但运气不佳。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T09:04:32.803

是的，有可能。

只需创建一个**类库**类型的新项目，然后将您的 .dbml 复制并粘贴到新项目中。最后在您的网站项目中添加对新项目（类库）的引用。

我相信数据库项目只是一种存储要对数据库执行的 SQL 脚本的方法。

# django - 如何动态添加自定义字段到模型

> ID：692441
> 
> 赞同：1
> 
> 时间：2009-03-28T08:22:33.293
> 
> 标签：django, django-models

如何动态添加自定义字段？我正在尝试，但是当我同步数据库时，该字段不会插入数据库：

```
#It use as register(MyModel)
def register(model, attr="my_attr"):

    if model in registry:
        raise AlreadyRegistered(
            _('The model %s has already been registered.') % model.__name__)

    registry.append(model)
    setattr(model, attr, MyField())

    MyField().contribute_to_class(model, attr) 

#MyField.contribute_to_class
def contribute_to_class(self, cls, name):
     super(MyField, self).contribute_to_class(cls, name)

     setattr(cls, self.name, self)
     cls.add_to_class('%s_manager' %  name, MyDescriptor())

     signals.post_save.connect(self._save, cls, True) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T15:58:04.227

如果不侵入 Django 的内部，你可能无法做到这一点。该`syncdb`命令检查每个模型的元对象以获取要创建的字段列表，该列表是在类构建时通过`django.db.models.Model`基类的元类创建的：

```
class MyModel(models.Model):
    my_filed = models.CharField(...)

# Here, class construction is complete and your class has a _meta member.
# If you want, you can check it out in the interactive shell.
meta = MyModel._meta 
```

类构造完成后，例如在`class`语句后面的 DEDENT 之后，元对象是固定的（不受修改模型类的影响），您将不得不破解元（这当然是可能的）以添加动态字段. 但是由于你在这里搞乱了内部对象，它可能会使你的应用程序与 Django 的未来版本不兼容。

剩下的问题是：你为什么要这样做？由于数据库表通常只在部署应用程序时创建一次，因此模型是一种“静态”的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T09:54:30.650

我一直在寻找同样的东西，不得不接受原始 SQL。尽管您可以使用 SQLAlchemy 之类的东西。

# internet-explorer - Internet Explorer 上的“第 0 行堆栈溢出”

> ID：692443
> 
> 赞同：0
> 
> 时间：2009-03-28T08:23:10.983
> 
> 标签：internet-explorer, stack-overflow

今天我的博客突然弹出这个错误，我在谷歌上搜索但仍然没有找到任何东西。但它不会发生在 Firefox 上，只发生在 IE7 和 IE8 上。我已经停用了所有 wordpress 的插件，但仍然出现错误。

我已经上传了截图

![替代文字](https://img2.pict.com/ba/dd/f6/db396a6f27b1aa240e5a37c6e5/ObyuD/20090328160649.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T08:35:19.660

这是一个关于技术编程问题的网站，而不是解决软件中的堆栈溢出错误:)（尽管它们具有相同的名称）。我建议你联系制作你的博客软件的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T08:31:11.260

那是一个javascript错误；你使用广告或计数器或类似的东西吗？

# c# - 如何在 C# 中将字节数组作为指针传递

> ID：692451
> 
> 赞同：1
> 
> 时间：2009-03-28T08:27:56.790
> 
> 标签：c#, lpbyte

我有两个问题。它们都与 C++ 中的空白有关，我正在尝试用 C# 翻译。

C++ 代码

```
void Func_X_2(LPBYTE stream, DWORD key, BYTE keyByte)
{
stream[0] ^= (stream[0] + LOBYTE(LOWORD(key)) + keyByte);
stream[1] ^= (stream[1] + HIBYTE(LOWORD(key)) + keyByte);
stream[2] ^= (stream[2] + LOBYTE(HIWORD(key)) + keyByte);
stream[3] ^= (stream[3] + HIBYTE(HIWORD(key)) + keyByte);
stream[4] ^= (stream[4] + LOBYTE(LOWORD(key)) + keyByte);
stream[5] ^= (stream[5] + HIBYTE(LOWORD(key)) + keyByte);
stream[6] ^= (stream[6] + LOBYTE(HIWORD(key)) + keyByte);
stream[7] ^= (stream[7] + HIBYTE(HIWORD(key)) + keyByte);
} 
```

第一个问题：

DWORD 是 UInt32，BYTE 是字节，但 LPBYTE 是什么？如何将其用作数组？

第二个问题：

如何在 C# 中使用 LOBYTE、HIBYTE、LOWORD、HIWORD？

**编辑**

这就是函数的调用方式：C++ 代码

```
Func_X_2((LPBYTE)keyArray, dwArgs[14], keyByte); 
```

keyArray 是一个 DWORD(UInt32)，dwArgs 是一个 dword 数组。KeyByte 是一个字节。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T08:59:26.077

LPBYTE 是指向字节数组的指针。C# 中的等价物是 byte[] 类型的变量。所以你可以像这样翻译你的函数：

```
public static void Func_X_2(byte[] stream, int key, byte keyByte)
{
    stream[0] ^= (byte)(stream[0] + BitConverter.GetBytes(LoWord(key))[0]);
    stream[1] ^= (byte)(stream[1] + BitConverter.GetBytes(LoWord(key))[1]);
    stream[2] ^= (byte)(stream[2] + BitConverter.GetBytes(HiWord(key))[0]);
    stream[3] ^= (byte)(stream[3] + BitConverter.GetBytes(HiWord(key))[1]);
    stream[4] ^= (byte)(stream[4] + BitConverter.GetBytes(LoWord(key))[0]);
    stream[5] ^= (byte)(stream[5] + BitConverter.GetBytes(LoWord(key))[1]);
    stream[6] ^= (byte)(stream[6] + BitConverter.GetBytes(HiWord(key))[0]);
    stream[7] ^= (byte)(stream[7] + BitConverter.GetBytes(HiWord(key))[1]);
}

public static int LoWord(int dwValue)
{
    return (dwValue & 0xFFFF);
}

public static int HiWord(int dwValue)
{
    return (dwValue >> 16) & 0xFFFF;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T08:36:44.553

LPBYTE 代表 Long Pointer to Byte，因此它实际上是一个 Byte 数组。

如果你有一个 uint32，你（必须小心移动有符号数量）：

```
LOWORD(u) =  (u & 0xFFFF);
HIWORD(u) =  (u >> 16); 
```

假设仅设置了底部 16 位（即顶部 16 位为零）：

```
LOBYTE(b) = (b & 0xFF);
HIBYTE(b) = (b >> 8); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T08:37:51.947

> [...] 什么是 LPBYTE？如何将其用作数组？

它是一个指向`BYTE`: 类型定义的指针，通常用于`unsigned char`. 您可以像使用 an 一样使用它`unsigned char*`来指向无符号字符数组的第一个元素。它定义在`windef.h`：

```
typedef unsigned char       BYTE;    
typedef BYTE far            *LPBYTE; 
```

> 如何在 C# 中使用 LOBYTE、HIBYTE、LOWORD、HIWORD？

这些是用于获取`WORD`. 它们很容易实现（作为比特摆弄操作）。这些也在 中定义`windef.h`。您可以简单地取出定义并将其粘贴到自定义 C# 函数中：

```
#define LOWORD(l)           ((WORD)((DWORD_PTR)(l) & 0xffff))
#define HIWORD(l)           ((WORD)((DWORD_PTR)(l) >> 16))
#define LOBYTE(w)           ((BYTE)((DWORD_PTR)(w) & 0xff))
#define HIBYTE(w)           ((BYTE)((DWORD_PTR)(w) >> 8)) 
```

您可能还想查看[这篇](https://stackoverflow.com/questions/93744/most-common-c-bitwise-operations)SO 帖子以了解 C# 中的位操作。

# c# - 从 .NET 到单声道的系统调用

> ID：692453
> 
> 赞同：4
> 
> 时间：2009-03-28T08:29:11.670
> 
> 标签：c#, mono, system-calls

我正在尝试使用单声道进行外部系统调用。我想知道是否可以模拟下面的示例（当然我正在寻找跨平台支持）。

```
public static int ExecuteExternalApp()
            {
                int ExitCode = -1;
                Process Process = new Process(); ;

                //Defining the filename of the app
                Process.StartInfo.FileName = "java";

                //Assigning the args to the filename
                Process.StartInfo.Arguments = @"-jar """ + ConfigurationManager.AppSettings["JarPath"].ToString();

                try
                {
                    //Starting the process
                    Process.Start();

                    //Waiting for the process to exit
                    Process.WaitForExit();

                    //Grabbing the exit code
                    ExitCode = Process.ExitCode;

                    //Close the process
                    Process.Close();
                }
                catch (Exception ex)
                {
                    throw new Exception(ex.Message);
                }

                return ExitCode;
            } 
```

**更新：此代码确实适用于单声道。由于不存在对 System 命名空间的引用（不知道这是如何发生的），第一个实现不起作用，只要使用 System.Diagnostics 命名空间，此代码块就可以工作。

# jquery - ie中的iframe问题

> ID：692454
> 
> 赞同：2
> 
> 时间：2009-03-28T08:30:19.047
> 
> 标签：jquery, internet-explorer, iframe

每当用户在输入验证码文本时出错时，我都会使用 iframe 刷新验证码。

这个 iframe 在一个看起来像这样的表单中......

```
<iframe id="cvbnm" frameborder="0" width="176" height="75" marginheight="0" marginwidth="0">     </iframe> 
```

每当用户输入错误的验证码时，我正在使用

```
 $("#cvbnm").attr("src", "captcha.php"); 
```

其中 captcha.php 是包含验证码文件的不同页面。

这在 Firefox 中运行良好......但在 ie 中没有刷新......请帮助我......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T08:41:03.937

您可能想为这个问题添加一个 jQuery 标记。

可能发生的情况是，由于 src 保持不变，IE 不会为页面生成新请求。

尝试

```
$('#cvbnm').removeAttr('src').attr('src', 'captcha.php'); 
```

或者

```
$('#cvbnm').attr('src', '').attr('src', 'captcha.php'); 
```

更新：

好的，如何添加

```
parent.frames[FrameID].window.location.reload(); 
```

或者

```
document.getElementById(FrameID).contentDocument.location.reload(true); 
```

我必须承认我从[这里得到这个](http://www.webdeveloper.com/forum/showthread.php?t=64667)

# iphone - 通过电子邮件发送 iPhone 应用程序的全屏

> ID：692464
> 
> 赞同：2
> 
> 时间：2009-03-28T08:37:17.517
> 
> 标签：iphone, email, screenshot

我正在开发一个 iPhone 应用程序，用于使用内置图形和用户定义的文本创建图像。

我希望能够让我的应用程序具有内置图形和用户定义的文本，然后可以将其作为单个图像（很像屏幕截图）发送到电子邮件应用程序以通过电子邮件发送。

有没有办法做到这一点，而无需截取屏幕截图、离开应用程序、进入照片应用程序、选择屏幕截图并从那里通过电子邮件发送？

最终，我希望能够在我的应用程序中有一个用户可以点击的按钮，整个屏幕将被捕获并直接发送到邮件应用程序。

任何指针感激地接受！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T15:15:02.490

为了扩展 Brent 的答案，以下代码将截取屏幕截图并将其作为名为 screenshot.png 的 PNG 保存到 Documents 目录中：

```
UIWindow *screenWindow = [[UIApplication sharedApplication] keyWindow];

UIGraphicsBeginImageContext(screenWindow.frame.size);
[screenWindow.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *screenshot = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

NSData *screenshotPNG = UIImagePNGRepresentation(screenshot);

NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];

NSError *error = nil;
[screenshotPNG writeToFile:[documentsDirectory stringByAppendingPathComponent:@"screenshot.png"] options:NSAtomicWrite error:&error]; 
```

这有点粗糙，因为它会在屏幕顶部附近为标题栏留下一个空白点，并且似乎不会从 CAEAGLLayers 中获取内容。

另外，我不相信您可以使用标准的 mailto:// URL 构造，然后是 openURL，来发送 MIME 编码的附件。也许 3.0 SDK 解决了这个问题，但我还没有玩过它。您可能需要使用类似[sksmtpmessage](http://code.google.com/p/skpsmtpmessage/)的东西直接从您的应用程序中发送消息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T15:48:14.260

还有私有 API `UIGetScreenImage`。它是这样使用的：

```
CGImageRef UIGetScreenImage();
@interface UIImage (ScreenImage)
+ (UIImage *)imageWithScreenContents;
@end

@implementation UIImage (ScreenImage)
+ (UIImage *)imageWithScreenContents
{
    CGImageRef cgScreen = UIGetScreenImage();
    if (cgScreen) {
        UIImage *result = [UIImage imageWithCGImage:cgScreen];
        CGImageRelease(cgScreen);
        return result;
    }
    return nil;
}
@end 
```

此功能可以与`UIImagePNGRepresentation`生成 PNG。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-17T17:36:20.843

苹果[现在允许](https://devforums.apple.com/message/149553)应用程序使用；

```
CGImageRef UIGetScreenImage(void); 
```

功能。尽管您必须记住它返回一个保留的 CGImageRef 并且您必须相应地管理您的内存。

他们还说，“ *……iPhone OS 的未来版本可能会提供与此功能等效的公共 API。此时，所有使用 UIGetScreenImage() 的应用程序都必须采用公共 API。* ”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T22:49:29.050

[skpsmtpmessage](http://code.google.com/p/skpsmtpmessage/)很棒。如果真的很好，我去克隆它并在github上添加了示例项目。下面的示例 GUI 添加了一些花里胡哨，如进度条和其他一些好东西，但它基本上维护了核心 skpsmtpmessage 代码。

[http://github.com/kailoa/iphone-smtp/tree/master](http://github.com/kailoa/iphone-smtp/tree/master)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T12:43:40.467

我不知道这是否可行，但您可以尝试创建一个支持位图的图形上下文，然后获取根视图的核心动画层并调用它的 -renderInContext: 方法。这*可能会*做到，但我从未尝试过。

不过，也许您应该考虑另一种方法。仅仅是您编写了一堆在屏幕上可见的自定义绘图代码，并且您也希望能够绘制到文件或内存缓冲区中吗？如果是这样，也许您应该将该绘图代码从您的视图中分离出来并放入您的视图简单使用的单独对象中。这将使您可以很容易地以两种方式绘制它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-24T06:08:25.830

在 OS 3.0 中，您可以使用 MFMailComposeViewController：

```
MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
picker.mailComposeDelegate = self;
[picker addAttachmentData:screenshotPNG mimeType:@"image/png" fileName:@"PNGfromMyApp"]; 
```

# iphone - 关于 iPhone 上的 Socket Streams 的问题

> ID：692476
> 
> 赞同：0
> 
> 时间：2009-03-28T08:55:05.727
> 
> 标签：iphone, objective-c, sockets, stream

我想通过套接字将 UIImage 发送到服务器。我正在使用来自 ADC 的代码：

```
 - (IBAction)searchForSite:(id)sender

{

    NSString *urlStr = [sender stringValue];

    if (![urlStr isEqualToString:@""]) {

        [searchField setEnabled:NO];

        NSURL *website = [NSURL URLWithString:urlStr];

        if (!website) {

            NSLog(@"%@ is not a valid URL");

            return;

        }

        NSHost *host = [NSHost hostWithName:[website host]];

        // oStream is instance variable

        [NSStream getStreamsToHost:host port:80 inputStream:nil
            outputStream:&oStream];

        [oStream retain];

        [oStream setDelegate:self];

        [oStream scheduleInRunLoop:[NSRunLoop currentRunLoop]

            forMode:NSDefaultRunLoopMode];

        [oStream open];

    }

} 
```

第一个问题：我想创建一个 NSOutputStream 对象，但我发现它只能用文件、缓冲区或内存来初始化。那么如何将流输出到套接字呢？

第二个问题：ADC 的引用告诉我们方法 getStreamsToHost:port:inputStream:outputStream: 将表示输出流的对象返回到远程主机。主机如何将输出流返回给自己？我在哪里可以在代码中添加输出流以发送到主机

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T11:16:39.973

**第一个问题**：

您**已经使用***socket*对其进行了初始化。NSStream 的 getStreamsToHost 消息已经为您提供了一个与指定主机通信的套接字，post。每当您想写入套接字时，只需使用**oStream**。

**第二个问题**：

在第一个问题中得到了回答。请记住，您正在打开一个到端口**80**的套接字。因此，您可能正在远程主机上运行 WebServer。为了能够将图像发送到远程服务器，您需要实现**HTTP**协议。在下面检查我的建议。我认为这会让你的生活更轻松。

* * *

一个小建议：

我知道你没有问这个，但让我给你一个建议。您正在尝试通过套接字发送图像。我会使用更高级别的协议，例如**HTTP**或**FTP**来做到这一点。使用普通套接字将迫使您自己实现一个新协议，更不用说服务器端代码来处理传入的图像了。

因此，如果您使用**HTTP**，只需在您最喜欢的 WEB 开发平台（.NET、PHP、Java、Python、RoR、CGI 等）中编写一个小的服务器端脚本，然后使用[此](http://iphone.zcentric.com/2008/08/29/post-a-uiimage-to-the-web/)网页上的指南将图像提交到 iPhone 上。这要容易得多。

# line-numbers - 从 SyntaxHighlighter 中删除行号

> ID：692489
> 
> 赞同：7
> 
> 时间：2009-03-28T09:09:05.350
> 
> 标签：line-numbers, syntaxhighlighter

有没有办法删除[SyntaxHighlighter](http://code.google.com/p/syntaxhighlighter/)的行号？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-21T00:04:27.250

您可以将 SyntaxHighliter 的装订线配置设置为 false。这将从您的代码中删除行号。

```
<pre class="brush: java; gutter: false;"></pre> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T09:11:12.677

点击“查看平原”链接？

查看[SyntaxHighlighter 演示](http://alexgorbatchev.com/wiki/SyntaxHighlighter:Demo)，您会看到它在右上角有按钮，您可以单击这些按钮将代码复制到剪贴板、查看实际源代码（删除标记）或打印它。

您是在问我们如何删除添加行号的实际功能，同时仍保留其余功能？你要求我们为你做这件事吗？

回应评论：

如果您想保留功能，并且只删除行号，您需要自己下载 javascript 文件的副本并删除您不想要的功能。[SyntaxHighlighter 下载](http://alexgorbatchev.com/wiki/SyntaxHighlighter:Download)页面允许您下载您自己的荧光笔版本，它还告诉您已获得 LGPL 3 许可，这意味着您在进行和使用修改时必须遵守这些规则。

如果您愿意，如果您卡在某个特定位置，您可以回来询问个别 Javascript 问题，但我们不是 TopCoder，也不会为您重新编写代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-21T08:24:33.083

如果您不想编辑现有标记，可以通过编辑`shCore.js`文件来全局关闭它：

```
var sh = {
defaults : {

    ...
    ...
    ...

    /** Enables or disables gutter. */
    'gutter' : false,

    ...
    ...
    ...

},

...
...
...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-24T03:48:48.877

您可以通过编辑文件 syntaxhighlighter.php 在 SyntaxHighlighter Evolved 版本 3.2.1 中设置默认值 'gutter' => 0。在文件中查找：

```
// Create array of default settings (you can use the filter to modify these)
        $this->defaultsettings = (array) apply_filters( 
            'syntaxhighlighter_defaultsettings', array(
            'theme'          => 'default',
            'loadallbrushes' => 0,
            'shversion'      => 3,
            'title'          => '',
            'autolinks'      => 1,
            'classname'      => '',
            'collapse'       => 0,
            'firstline'      => 1,
            'gutter'         => 0,
            'htmlscript'     => 0,
            'light'          => 0,
            'padlinenumbers' => 'false',
            'smarttabs'      => 1,
            'tabsize'        => 4,
            'toolbar'        => 0,
            'wraplines'      => 1, // 2.x only
        ) ); 
```

# c# - 多线程和死锁

> ID：692496
> 
> 赞同：-1
> 
> 时间：2009-03-28T09:27:33.013
> 
> 标签：c#, .net, vb.net

在哪些情况下我们可以做多线程和死锁的概念。可以举一些例子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T09:35:32.290

多线程基本上是使用*线程*，它们是可以访问进程中相同内存空间的某些实体，以同时运行进程的不同部分。

然而，并发编程是困难、复杂和危险的。*死锁*是由此产生的危险之一，这意味着两个线程相互等待以完成任务，最终陷入锁定状态。假设你在给我 5 美元之前等我给你 5 美元，我也在做同样的事情。我们都在等待对方，所以什么都不会发生。

就像我说的，这是一个非常复杂的主题，绝对不是一个答案可以在这里教授的东西。我建议您做一些研究并找到有用的资源，这些资源可以帮助您更牢固地掌握并发编程的概念。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T20:06:18.327

您通常会得到使用 BackgroundWorker 组件来实现线程的建议。这是导致它死锁的示例：

```
private void button1_Click(object sender, EventArgs e) {
  backgroundWorker1.RunWorkerAsync();
  // Do something while the BGW runs
  //...
  System.Threading.Thread.Sleep(500);
  // Wait for the result to be available
  while (backgroundWorker1.IsBusy)
    System.Threading.Thread.Sleep(10);
}

private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e) {
  // Do some work
  //...
  System.Threading.Thread.Sleep(1000);  // Pretend to do some work
  e.Result = 42;
}

private void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e) {
  // Store the result...
} 
```

发生死锁是因为 BGW 必须在完成之前调用 RunWorkerCompleted 事件。在 UI 线程空闲之前，这不会发生。这不会发生在这里，它卡在等待BGW完成的循环中。

只是一个例子，有无穷无尽的方法来陷入这样的麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T09:37:22.240

假设您要问在多线程环境中如何发生死锁。

假设我们有两个线程和两个资源，时间线是这样的：

```
+===+============================+============================+
| # | Thread 1                   | Thread 2                   |
+===+============================+============================+
| 1 | Allocate resource A, okay. |                            |
+---+----------------------------+----------------------------+
| 2 |                            | Allocate resource B, okay. |
+---+----------------------------+----------------------------+
| 3 | Allocate resource B, lock. |                            |
+---+----------------------------+----------------------------+
| 4 |                            | Allocate resource A, lock. |
+===+============================+============================+ 
```

现在你有两个线程被锁定，每个线程都在等待一个永远不会被释放的资源，因此死锁。

无法释放资源的原因是因为唯一可以释放它们的线程被锁定。这就是为什么总是让你的线程以彼此相同的顺序分配资源是一个好主意。

# c# - 以管理员身份运行的程序重新启动后，SysTray 图标不可见

> ID：692497
> 
> 赞同：1
> 
> 时间：2009-03-28T09:27:36.210
> 
> 标签：c#, windows-vista, system-tray, administrator, runas

我有一个最简单的应用程序形式，其中显示了一个 SysTray 图标并在启动项中添加了该应用程序。应用程序是用 C# 开发的。我希望即使在机器重新启动后也能显示托盘图标。目前，我在使用“以管理员身份运行”运行 exe 时遇到了一个奇怪的行为。当我在管理员权限下使用时，机器重启后图标不会出现（尽管 exe 仍在运行）。我在元数据“requestedExecutionLevel level="asInvoker" uiAccess="false"”中使用以下元数据值：

我不得不使用“invoker”（而不是“administrator”），因为没有它就不会将它添加为启动项。如果我使用双击运行 exe（因为现在它在当前用户域而不是管理员下运行），它工作正常，但是这个 exe 将由安装程序启动，因此在系统域中启动。谁能帮我解决这个问题？

要么为我提供解决方案，以便它可以在以管理员身份运行时显示 Systray 图标，或者如果你可以提供任何方式让我可以在当前用户域而不是管理员下启动这个 Exe 更好？

问候 Sumeet Garg

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-24T12:14:56.750

我现在从另一个组件（Shell 扩展）调用 exe，该组件始终在用户域中运行。因此默认情况下称为 exe 工作用户域。感谢所有的支持。

# asp.net - Windows 集成身份验证与具有集成安全性的 MS-SQL 2000 数据库连接冲突

> ID：692500
> 
> 赞同：0
> 
> 时间：2009-03-28T09:30:04.207
> 
> 标签：asp.net, sql-server, iis-6, windows-authentication, integrated-security

我们正在.NET 2.0 平台上开发一个 Intranet Web 应用程序。该应用程序使用集成 Windows 身份验证进行单点登录。用户有权根据他们所在的 Active Directory 组使用不同的模块。

直到完成身份验证和授权为止，一切正常。但是当应用程序尝试连接到 MSSQL Server 上的数据库时，问题就开始了。

根据我们客户的安全政策，即使已加密，也不应将数据库用户或密码数据保存在连接字符串或注册表中。所以我们被迫在连接字符串中使用 Integrated Security=SSPI。

IIS 上的应用程序池由他们使用有权访问数据库的身份用户配置。

当我们停用 Windows 集成身份验证时，我们使用应用程序池的身份用户连接到数据库。但是，当启用集成身份验证时，应用程序会尝试使用登录用户凭据连接到数据库。

我们尝试了集成身份验证的每一种组合，无论有没有模拟，都可以解决这个问题。

有没有办法解决这个冲突？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T09:44:00.040

通常，您的操作方式应该可以工作。您是否启用了启用委派的 Kerberos？

也许这有帮助：

*   [如何：使用 Windows 集成安全性访问 SQL Server](http://msdn.microsoft.com/en-us/library/bsz5788z.aspx)

*   [http://blogs.msdn.com/sql_protocols/archive/2006/12/02/understanding-kerberos-and-ntlm-authentication-in-sql-server-connections.aspx](http://blogs.msdn.com/sql_protocols/archive/2006/12/02/understanding-kerberos-and-ntlm-authentication-in-sql-server-connections.aspx)

编辑：如果 SQL 和 IIS 在同一台机器上，您需要关闭模拟：

*   <身份验证模式="Windows" />
*   <identity impersonate="false" />

# jsp - 与 Java Bean 一起使用时会话范围的问题

> ID：692504
> 
> 赞同：0
> 
> 时间：2009-03-28T09:32:32.377
> 
> 标签：jsp

## FIRST.JSP

```
<jsp:useBean id="Bean" scope="session" class="Bean.Student_Enrollment_Bean" />
<jsp:setProperty name="Bean" property="*"/>

<tr>
    <td >Student First Name</td>
    <td>
    <% if( (Bean.getStudent_first_name()==null) || (Bean.getStudent_first_name().trim().length()==0) || Bean.getStudent_first_name().equals("null"))  {  %>
        <input type="text" name="student_first_name" >
    <% } else { %>
        <input type="text" name="student_first_name" value="<%=Bean.getStudent_first_name()%>">
    <%  } %>
    </td>
</tr> 
```

## 第二个.JSP

```
<jsp:useBean id="Bean" scope="session" class="Bean.Student_Enrollment_Bean" />
<jsp:setProperty name="Bean" property="*"/>

<tr> 
    <td >SSLC Name</td>
    <td>
    <% if( (Bean.getName_sslc()==null) || (Bean.getName_sslc().trim().length()==0) || Bean.getName_sslc().equals("null"))  {  %>
        <input type="text" name="name_sslc">
    <% } else { %>
        <input type="text" name="name_sslc" value="<%=Bean.getName_sslc()%>">
    <%  } %>
    </td> 
</tr> 
```

## JAVABean.JAVA

```
public class Student_Enrollment_Bean 
{

    private String student_first_name="";
    private String name_sslc;

    public String getStudent_first_name() {
        return student_first_name;
    }

    public void setStudent_first_name(String student_first_name) {
        this.student_first_name = student_first_name;
    }

    public String getName_sslc() {
        return name_sslc;
    }

    public void setName_sslc(String name_sslc) {
        this.name_sslc = name_sslc;
    }

} 
```

大家好，以上是我的代码.....我的jsp会话范围有问题......在第一页我输入名字作为“名字”然后我要去第二页，在这个页面我输入学校名称“学校名称”......现在我要回到第一页，在这个（第一）页中，值（“名字”）在我输入的文本框中......现在我删除了这个值，我将该文本字段留为空白，我将转到第二页，然后返回第一页...现在我只想要空白文本字段....但它显示了我输入的值（“名字”）第一次。请让我知道该代码背后的问题和问题所在。

我不想要通过设置为隐藏变量或 session.setAttribute 的逻辑。请建议我任何其他解决方案。为什么bean没有得到空字符串的值......？

提前致谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-19T20:55:29.373

功能要求很不清楚，所以我不能给出一个非常合适的答案。

但是我可以看到您已经声明`jsp:useBean`自己使用会话范围。这才是真正的问题。您似乎希望保持数据请求的范围。在这种情况下，只需将范围更改为`request`. 您已经在使用`jsp:setProperty`with `property="*"`，这会根据属性名称自动将请求参数放入 bean 中。只需明智地使用它。进一步，我建议使用[表达式语言](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/JSPIntro7.html)而不是那些 afwul scriptlet。

例如

```
<input type="text" name="student_first_name" value="${Bean.student_first_name}"> 
```

然后在 second.jsp 中将其作为隐藏参数传递：

```
<input type="hidden" name="student_first_name" value="${Bean.student_first_name}"> 
```

就这样。`null`不，当实际值为空时它不会打印。这就是EL的好处。

也就是说，我建议放弃那些 PHP/C 命名约定并使用真正的[Java 命名约定](http://java.sun.com/docs/codeconv/html/CodeConventions.doc8.html)。变量不应该以大写开头，你应该使用 CamelCase。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T09:57:30.217

您只在两个页面中使用**输入**标签，而没有实际使用**表单**标签来明确定义应用程序在用户填写文本字段时应采取的操作。

我的建议是在 google 上搜索如何使用 JSP 和表单。**如果**您的解决方案显示的 scriptlet，您的 JSP 页面不需要。

参见例如[http://www.jsptut.com/Forms.jsp](http://www.jsptut.com/Forms.jsp)

# python - 解决模块之间的python依赖关系

> ID：692506
> 
> 赞同：-2
> 
> 时间：2009-03-28T09:33:53.357
> 
> 标签：python, dependencies

我是python的新手。我确实有两个模块。型号 M1 和模块 m2。从 m2 ，我需要引用 m1 和 m2 ，而 m1 位于磁盘中的两个不同位置。

当我在执行 m2 之前尝试导入 m1 时，当然是说找不到 m1。如何将我的解释器指向 m1 的位置。

谢谢J

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T09:46:32.640

目前尚不*完全*清楚您的具体问题是什么（提供更多详细信息！），但您可能会发现这些很有用（进一步谷歌搜索将帮助您针对您的特定需求找到具体答案）：

*   PYTHONPATH 环境变量
*   PYTHONPATH 中出现的目录中的 .pth 文件
*   在导入之前操作 sys.path

但是，如果 m2 依赖于 m1，并且它们分布在一起，那么使用[packages](http://www.packtpub.com/article/writing-a-package-in-python)将它们放在同一个目录树中可能是一个更好的主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T09:49:57.700

如果您无法修改 shell 环境，您可以附加任何您希望解释器`sys.path`从脚本中搜索模块的目录。事实上，`PYTHONPATH`环境变量被读取并用于初始化`sys.path`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T09:52:36.040

可能的情况取决于模块的详细信息，但通常您可以从模块中导入所需的具体对象，如下所示：

在 B.py 中

```
from A import classA1, funA1 
```

在 A.py 中

```
from B import classB1, funB1 
```

这样您就只导入需要的东西。如果依赖关系更复杂，这可能不起作用，但一般来说应该是可能的（除非您实际上在对象级别具有真正的相互递归依赖关系，您无法解决！）。

# database - 在数据库中存储数据包

> ID：692509
> 
> 赞同：4
> 
> 时间：2009-03-28T09:35:29.920
> 
> 标签：database, database-design, binary-data

**问题描述：** 在我的应用程序中，我必须以某种格式呈现数据包的内容。一个例子：

**示例** 任何打包的二进制数据，例如：4 字节头、4 字节类型（类型代码具有预先定义的含义），然后是源地址、目标地址等。

以前，我制作了将数据存储在二进制文件中的自制实现（固定记录长度允许快速查找），但随着时间的推移，我意识到我正在发明某种数据库。例如，我正在为非常大的数据文件实现我自己的高效二进制存储格式。我还实现了自己的索引以在某些字段上快速运行搜索。我认为一个真正的数据库（甚至是简单的 SQLite）可以使这些东西变得透明简单。

**问题#1：**数据库对存储此类数据有用吗？应该如何做？请注意，这里没有一对多、多对多的映射和其他高级的东西，它只是一个简单的数据包序列，具有一定的内部结构，我想向用户显示并让他与之交互（即搜索由某个领域）。

**问题#2：**现在假设用户自己可以指定他的数据包的格式，即在配置文件中：每个字段的长度、它的类型、它的值的含义（在枚举的情况下）等等。如何为此扩展由数据库支持的实现？用户应该定义数据库模式吗？配置文件是否应该自动翻译成这个模式？奥姆？

**问题#3：**更高级……现在假设数据包的长度和内容可以不同。即，对于类型#2 的包，有一些字段，对于类型#3，还有一些其他字段，等等。但我仍然希望我的应用程序能够处理它，很好地显示所有内容并允许用户在配置文件中指定格式。它是如何完成的？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T00:31:44.880

一个简单的规则是：如果您要查询数据，那么它应该是数据库中表中的离散字段。如果没有，您可以存储 BLOB 并完成它。

也就是说，如果您想从 BLOB 中获取“元数据”并对其进行索引，那么您也可以轻松地做到这一点。

如果您的数据类型与数据库可以支持（或可以准确转换）的数据类型一致，那么将 BLOB 分解为可以很好地映射到 DB 列的组件部分可能会有一些价值。

定义“动态表格”（这很容易完成）的问题不在于表格的定义，而在于表格的潜在变化。正在更改的表（即添加或删除的列等）在更改期间往往无法使用。100 行不是问题。数百万行的真正问题。

如果数据定义是相当静态的，则创建一个映射工具，让您的用户描述 BLOB，然后您使用该定义来创建兼容表并在导入期间适当地转换 BLOB。

至于“不同类型的不同行”，您仍然可以将该数据填充到单个表中。与其他行相比，某些行具有“未使用”列，每行都按类型标识。如果您有很多行定义和大量差异，那么这样做会浪费大量空间。然后，您可能希望为每种行类型创建一个表，以及一个包含行类型和对实际表中实际行的引用的主表。如果您关心原始数据包之间的关系，则仅需要此主表（然后您可以按接收顺序存储它们，例如等）。

真的，这一切都归结为您拥有多少数据，您期望多少，您想要做多少工作与您已经完成了多少，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T00:42:02.983

> 问题#1：数据库对存储此类数据有用吗？应该如何做？

当然，数据库对于此应用程序很有用。您可以实现自己的专用数据存储，也许它对您的特定应用程序更有效，因为您可以针对该专业进行设计。关系数据库更通用，但您可以通过使用数据库来避免数周或数月的开发时间。

我今天早些时候回答了另一个关于如何处理可扩展类型的问题，其中每个新的子类型都有自己独特的一组属性。

“[产品表，多种产品，每个产品都有很多参数](https://stackoverflow.com/questions/695752/product-table-many-kind-of-product-each-product-have-many-parameters/695860#695860)。”

对于您的应用程序，我会选择[Concrete Table Inheritance](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)设计。

> 问题#2：现在假设用户自己可以指定他的数据包的格式，即在配置文件中：每个字段的长度、它的类型、它的值的含义（在枚举的情况下）等等。如何为此扩展由数据库支持的实现？

我假设数据包类型的数量相对较少，然后以几乎相同的结构插入许多数据包。所以你应该使用数据库管理元数据的能力。我将为每种新的数据包类型定义一个附加表。

我还将存储“爆炸”的数据包，因此数据包的每个字段都存储在单独的数据库列中。这样，您可以单独索引每一列，以支持高效搜索。

您还可以定义约束，以便某些字段是必需的 ( `NOT NULL`) 或其值受查找表约束。同样，利用数据库的功能使用元数据在需要的地方实施一致的结构。

SQL 已经支持一种标准的声明性语言，用于指定具有数据类型、约束等的字段。为什么要开发一种不同的语言，然后必须将其翻译成 SQL？

> 问题#3：更高级……现在假设数据包的长度和内容可以不同。

给定数据包类型中的可选字段应`NULL`在相应列中允许。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T01:17:30.357

您可能希望考虑的另一个选择是[Berkeley DB](http://www.oracle.com/technology/products/berkeley-db/db/index.html)或其克隆之一。BDB 级别很低，没有 SQL。它几乎是一个非常小、非常快的文件支持哈希表。它一直存在，并被用于许多速度和简单性至关重要的地方。不过，您需要在顶部添加一些功能才能完成您想要完成的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T13:23:10.363

尽管您说没有一对多的关系，但还是有:)

我建议为数据包存储创建两个表。一种用于存储“标头”或“标量”信息，这是数据包共有的，虽然它可以定义存在什么数据，但它不是数据包中存储的实际数据。

您的第二个表将存储每个数据包的数据，每个字段值组合代表此表中的一行。例如以下两个表：

```
create table packet
(
    packet_id int identity(1, 1) primary key,
    destination varchar(50),
    sender varchar(50),
    packet_type_id int not null
)

create table packet_field
(
    packet_field_id int identity(1, 1) primary key,
    packet_id int not null references packet (packet_id),
    field_id int not null,
    data varbinary(500)
) 
```

显然，这两个表对所存储数据的类型和大小进行了假设，并且并未详尽说明它们需要存储的内容。但是，这种基本结构将允许动态定义的数据包格式，并且是一种易于索引的模式（例如，在`packet_id+field_id`in上添加索引`packet_field`将是不费吹灰之力）。

然后，您的所有应用程序负责解包数据包并将其存储在此模式中的数据库中，然后重新打包（如有必要）。

当然，从这一点开始，您将需要存储数据包实际格式的表。就像是...

```
create table packet_type
(
    packet_type_id int identity(1, 1) primary key,
    name varchar(200) not null
)

create table packet_type_field
(
    field_id int identity(1, 1) primary key,
    packet_type_id int not null references packet_type (packet_type_id)
    field_offset int not null,
    name varchar(200) not null
) 
```

同样，显然简化了，但它显示了基本思想。对于每种数据包格式，您的表中将有一条记录，在给定数据包中的每个字段中都有`packet_type`一行。`packet_type_field`这应该为您提供将任意二进制数据块处理到上述数据包存储模式所需的大部分信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-12T13:01:31.117

想到了三种方法。

sFlow 和 IPFlow 可以传输一组有限的数据包内容。这可以直接记录到几个不同的数据库中。

另一种更有针对性的方法是编写一个非常简单的 snort 规则，例如源地址或目标地址。然后让 snort 捕获数据包的有效负载。这样你只会得到你需要的实际数据。例如，您可以只获取数据包内的数据字段。例如密码等。

ngrep 还可以立即获取选择性数据。

当然，如果您不在服务器/工作站本身上进行捕获，则其中每一个都可能需要在端口上进行点击或监视会话。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T16:53:50.177

虽然我不是这个实现的忠实拥护者，但我们有一些软件基本上可以为某些呼叫列表执行此操作。本质上，这就是他们所做的：

1.  具有列定义的表 - 称之为 tblColumnDefs。此表包含“名称”、“类型”、“长度”和“描述”等列
2.  实例主表 (tblPacketNames)。本质上，您定义的每种数据包类型只有“PacketTypeID”、“PacketName”和“描述”
3.  一个实例定义表（对您来说，这将是 tblPacketColumns）。此表将预定义的列收集在一起以形成您要存储的数据结构。例如，它可能包含“PacketTypeID”、“ColumnNumber”、“ColumnID”。在数据库规范化中，这是一个多对多表，因为它将列映射到使用它们的数据包。
4.  在第二个数据库中（由于此步骤的动态 SQL/注入影响），动态创建表以保存实际数据。例如，如果您已定义（在步骤 2/3 中）名为“PING”的数据包类型，则您的数据库中可能有一个名为“PING”的表来保存该数据。您将使用链接到 tblColumnDefs 的 tblPacketColumns 来确定要创建的字段类型以及它们应该有多大。使用步骤 1 中的列，您最终会得到一组与步骤 3 中的数据包类型定义匹配的表。

**注意：我并不特别喜欢第 4 步的 SQL 注入影响。如果安全性设计不当并且应用程序中任何用户输入字段的输入未正确清除，动态创建表可能会导致一些后果，特别是如果此应用程序有一个可供不受信任的调用者使用的接口（即 Internet）。**

使用它，您可以在创建表时创建所需的索引（也许您在步骤 1 中有一个列，您将某些列标记为“可索引”，并在创建表时在它们之上创建索引。

# vb.net - 如何在 vb.net 中更改表单形状

> ID：692514
> 
> 赞同：0
> 
> 时间：2009-03-28T09:38:43.610
> 
> 标签：vb.net, winforms, winapi, pinvoke

我曾经使用以下代码在 VB 6.0 中更改表单形状：

```
Private Declare Function CreateRoundRectRgn Lib "gdi32" (ByVal X1 As Long, ByVal Y1 As Long, ByVal X2 As Long, ByVal Y2 As Long, ByVal X3 As Long, ByVal Y3 As Long) As Long

Private Declare Function SetWindowRgn Lib "user32" (ByVal hWnd As Long, ByVal hRgn As Long, ByVal bRedraw As Boolean) As Long

Private Sub MakeRoundObject(objObject As Object, Value As Long)
  Static lngHeight, lngLong, lngReturn, lngWidth As Long
  lngWidth = objObject.Width / Screen.TwipsPerPixelX
  lngHeight = objObject.Height / Screen.TwipsPerPixelY
  SetWindowRgn objObject.hWnd, CreateRoundRectRgn(10, 50, lngWidth, lngHeight, Value + 10, Value), True
End Sub

Private Sub Form_Load()
   Call MakeRoundObject(Form1, 50)
End Sub 
```

以同样的方式，我使用 VB.NET 代码如下：

```
Imports Microsoft.VisualBasic.Compatibility

Public Class Form1
  Private Declare Function CreateRoundRectRgn Lib "gdi32" (ByVal X1 As Integer, ByVal Y1 As Integer, ByVal X2 As Integer, ByVal Y2 As Integer, ByVal X3 As Integer, ByVal Y3 As Integer) As Integer
  Private Declare Function ReleaseCapture Lib "user32" () As Integer
  Private Declare Function SetWindowRgn Lib "user32" (ByVal hWnd As Integer, ByVal hRgn As Integer, ByVal bRedraw As Boolean) As Integer

  Private Sub MakeRoundObject(ByRef objObject As Object, ByRef Value As Integer)
    Static lngLong, lngHeight, lngReturn As Object
    Static lngWidth As Integer
    lngWidth = objObject.Width / VB6.TwipsPerPixelX
    lngHeight = objObject.Height / VB6.TwipsPerPixelY
    SetWindowRgn(objObject.hWnd, CreateRoundRectRgn(0, 0, lngWidth, lngHeight, Value, Value), True)

  End Sub

  Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    MakeRoundObject(Me, 20)
  End Sub

End Class 
```

但在后一种情况下，我收到一条错误消息 - “未找到类型 'Form1' 上的公共成员 'hWnd'。”

我所做的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T15:45:01.343

您不必使用 P/Invoke 来执行此操作。Form.Region 属性就是为此而设计的。一个简单的例子：

```
Public Class Form1
  Public Sub New()
    InitializeComponent()
    Dim path As New Drawing2D.GraphicsPath()
    path.AddEllipse(0, 0, Me.Width, Me.Height)
    Me.Region = New Region(path)
  End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T11:55:25.473

另一种方法是将 TransparencyKey 设置为像洋红色这样的颜色或表单上未使用的任何其他颜色。然后将 BackgroundImage 属性设置为某些图像，洋红色将代表透明区域。通过该程序，您可以轻松获得任何形状。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T09:41:41.543

该属性现在是 Handle，而不是 hWnd。

如果您打开 option strict ，那么编译器会告诉您 hWnd 不再存在。同样在 .NET 中，您应该使用 ByVal 而不是 ByRef，除非您需要调用者查看对该参数所做的更改的能力，否则传递 ByVal 不再会降低性能。您还应该将 MakeRoundObject Sub 的参数类型更改为正确的数据类型，而不是 Object。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T10:31:17.010

也许另一种获得您可能没有想到的非矩形表单形状的方法：在表单上设置透明背景颜色并使用它。

我经常对 .NET 中的关于屏幕之类的事情执行以下操作：将背景颜色设置为实际表单中未使用的颜色（如深紫色）并使用 GDI+ 在表单边界内以您希望的颜色绘制填充形状.

实际上并没有将表单区域从矩形更改为其他内容，但它确实有效。并且通常更容易使用表单的“脱节形状”。

# javascript - 在 IE 中获取自动高度元素的实际高度

> ID：692523
> 
> 赞同：2
> 
> 时间：2009-03-28T09:51:14.640
> 
> 标签：javascript, html, css, internet-explorer, internet-explorer-7

我很困惑！有了这个：

```
...
<div id="main">         
    <div id="content">
        <div class="col1">
        ...COLUMN1 CONTENT GOES HERE...
        </div>

        <div class="col2">
        ...COLUMN2 CONTENT GOES HERE...
        </div>
    </div><!-- #content -->
</div><!-- #main -->
... 
```

如您所见，有列，我想将它们的容器元素的高度设置为两列的最大大小（加上 130 像素）。所以通过使用原型框架：

```
//fixing column height problem
Event.observe(window,"load",function(){             
    if(parseInt($('col1').getStyle('height')) > parseInt($('col2').getStyle('height')))
        $('main').setStyle({'height' : parseInt($('col1').getStyle('height'))+130+'px'});
    else
        $('main').setStyle({'height' : parseInt($('col2').getStyle('height'))+130+'px'});
});//observe 
```

它在 Firefox、Opera、Safari 和 Chrome 中运行良好，但无法返回列的实际高度。在 IE7+（未在 IE6 中测试）中，它返回**NaN**作为列高。
我设法找出这是因为：

```
.col1,.col2{"height:auto;"} 
```

我还使用了“$('col1').offsetHeight”，它返回 0 作为每列的高度值。

HTML 的样式是这样的：

```
#main{
height: 455px;
background: #484848 url(../images/mainbg.png) repeat-x;
}
#content{
/*height:80%;*/
width: 960px;
direction: rtl;
margin-top: 50px;
margin-left: auto;
margin-right: auto;
position: relative;
}
.col1,.col2{
width: 33%;
text-align: right;
margin-left:3px;
padding-right:3px;
line-height:17px;
}
.col1{padding-top:20px;}
.col1 ul{
margin:0;
padding:0;
list-style: url(../images/listBullet.gif);
}
.col1 ul li{
margin-bottom:20px;
}
.col2{
top: 0;
right: 70%;
position: absolute;
} 
```

请对这个问题有任何想法？！

**更新**/ 花了三天时间解决，我冒着获得赏金的风险！
有关解决方案，请查看[此问题/答案](https://stackoverflow.com/questions/697271/javascript-event-hierarchy-in-prototype-framework)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T10:23:15.000

作为马克回答的补充；在 Prototype 中有一个 jQuery 的*height()等价函数：*

```
$('col1').getDimensions().height //or .width ofcourse 
```

这是文档： http: [//prototypejs.org/api/element/getDimensions](http://prototypejs.org/api/element/getDimensions)

**更新：**我同意下面的[crescentfresh](https://stackoverflow.com/questions/692523/getting-actual-height-of-an-auto-heighted-element-in-ie/692670#692670)。由于我过去遇到过同样的问题，因此我搜索了所有可能的方法来查找维度属性，但我失败了。请看一下：

```
function getStyle(oElm, strCssRule){
    var strValue = "";
    if(document.defaultView && document.defaultView.getComputedStyle){
        strValue = document.defaultView.getComputedStyle(oElm, "").getPropertyValue(strCssRule);
    }
    else if(oElm.currentStyle){
        strCssRule = strCssRule.replace(/\-(\w)/g, function (strMatch, p1){
            return p1.toUpperCase();
        });
        strValue = oElm.currentStyle[strCssRule];
    }
    return strValue;
} 
```

如您所见，[已编写](http://robertnyman.com/2006/04/24/get-the-rendered-style-of-an-element/)该函数以获取*元素的计算渲染当前样式*，但在我们的示例中，我猜即使此方法也会失败。（值得一试）

因此，正如 crescentfresh[所说](https://stackoverflow.com/questions/692523/getting-actual-height-of-an-auto-heighted-element-in-ie/692670#692670)，您必须在 CSS 定位方法中找到问题，同时不要浪费时间寻找能够发挥魔力的合适的 javascript 函数。让我们首先删除该*#content* DIV 并让*#main*成为所述列的唯一包装器，然后对剩余部分进行样式设置以实现预期目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T14:36:03.097

既然 IE 想让你难受，你可以给它一些特别的关注，并使用一个我相信它会识别的属性......

```
var height;
if(document.all) { //This means it is IE
  height = document.getElementById('col1').offsetHeight;
}
else {
  height = //Use what is working in other browsers now
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T12:02:02.890

来自： [当firebug说它是34时，为什么jquery会为offsetHeight返回0？](https://stackoverflow.com/questions/636474/why-would-jquery-return-0-for-an-offsetheight-when-firebug-says-its-34)

> 一个实际上没有参与文档渲染过程的元素没有尺寸，并且将给出 0 的 offsetWidth/Height。

Prototype`getDimensions()`和 jQuery都`height()`读取了`offsetHeight`or`clientHeight`属性，您已经尝试并得到了 0。因此，在您的代码中的某处必须有*一些东西*从渲染流中取出`#col`。这就是我能想到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T09:58:24.140

Artarad，
上面的样式ie css显示你没有指定高度。请尝试在类中添加 _height:auto 看起来像

```
 .col1,.col2{
width: 33%;
_height:auto;
height:auto;
text-align: right;
margin-left:3px;
padding-right:3px;
line-height:17px;
} 
```

基本上，当分配给特定的 div 或任何元素时，许多浏览器无法识别高度。在这种情况下，我们使用上述解决方法。希望以上对你有所帮助。

谢谢，
萨米克沙

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T09:58:49.677

我不知道它是否会起作用（未经测试），但您可以尝试 jQuery 和[height()](http://docs.jquery.com/CSS/height)；这（理论上）给出了计算的高度。值得一试...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-28T16:00:37.077

我知道这是一个老问题，但我找到了比“修复 css 并忘记 javascript”更好的答案。

我遇到了同样的问题并使用`.innerHeight()`它，它迫使 jQuery 计算高度。由于某种原因在解决问题`.outerHeight()`时不起作用。`.innerHeight()`不确定原型是否有类似的方法。您可以查看 jQuery 库并了解其`.innerHeight()`工作原理，然后编写自己的库。

# php - php代码中的额外神秘空间

> ID：692526
> 
> 赞同：0
> 
> 时间：2009-03-28T09:55:40.683
> 
> 标签：php, javascript, ajax

我正在尝试将一个变量 frm php 传递给一个 javascript 函数，但是一个空间不断增加，我看不到如何。

相关的php代码片段：

```
<p><a href='#' onclick=\"makewindows(" . $html . "); return false;\">Click for full description </a></p>".$brand."
        <p><a href=\"#\" onclick=\"deleteRec('".$ARTICLE_NO."', '".$brand."', '".$pg."', '".$nextArticleNo."')\">DELETE</a> 
```

$brand 是我要传递的，而 deleteRec 是函数的名称。

在第一行的末尾，我在指向 deleteRec 的链接之前呼应了品牌，并且它不包含空格。在我的测试用例中，它设置为简单的“o”。

但是，为 deleteRec 生成的链接显然包含一个空格，我不知道它来自哪里。

```
<a href="#" onclick="deleteRec('190274380300', ' o', '2', '250343889611')">DELETE</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T10:02:01.370

执行 var_dump($brand) 并仔细查看 - 几乎可以肯定其中有一个空格！

[在这种情况下，您可以使用trim](http://php.net/trim)来防范它

```
$brand=trim($brand); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T09:58:39.520

改变：

```
<p><a href=\"#\" onclick=\"deleteRec('".$ARTICLE_NO."', '".$brand."', '".$pg."', '".$nextArticleNo."')\">DELETE</a> 
```

到：

```
<p><a href=\"#\" onclick=\"deleteRec('".$ARTICLE_NO."', '".trim($brand)."', '".$pg."', '".$nextArticleNo."')\">DELETE</a> 
```

并告诉我们进展如何。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T10:35:55.377

尝试回显以下内容：

```
echo "--$brand--"; 
```

这样您就可以查看变量中是否有空格。

作为一般的风格问题，我会改变第二个链接：

```
<a href=\"#\" onclick=\"
      deleteRec('".$ARTICLE_NO."', '".$brand."', '".$pg."', '".$nextArticleNo."')\">DELETE</a> 
```

到：

```
<?php
$deleteRecArgs = "'$ARTICLE_NO', '$brand', '$pg', '$nextArticleNo'";
?>
<a href="#" onclick="deleteRec(<?php echo $deleteRecArgs?>)">DELETE</a> 
```

它更易于阅读和维护。

# macos - Mac OS X终端killall不会杀死正在运行的进程

> ID：692528
> 
> 赞同：12
> 
> 时间：2009-03-28T09:56:15.067
> 
> 标签：macos, terminal

我有一个运行 lighttpd 的实例。当我执行“ps -axc”时，该过程被列为

```
"614 ?? 0:00.15 lighttpd" 
```

但是当我做“killall lighttpd”时，我得到了

```
No matching processes belonging to you were found 
```

我在 Mac OS X 10.5.6 上。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-28T10:02:06.360

根据其他回复，如果这不是您的流程，`sudo`如果您是管理员，请在前面添加。如果没有，你可能不走运。

另外，尝试`sudo killall -9 lighttpd`发送特定信号 KILL 而不是 TERM。

只是为了确保您也可以尝试`sudo kill -9 614`使用 PID。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-07T22:34:50.037

ps aux 列表中的任务是否写在括号中？如果是这样，它就是一个僵尸，它正在等待一些 I/O 任务，它可能永远不会完成。据我所知，你不能杀死它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T10:02:04.520

它属于你吗？如果你这样做

```
ps aux | grep lighttpd 
```

这将为您提供与该进程关联的用户 ID（我猜它是`chowned`给另一个用户的）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-30T16:30:53.870

有用：`killall -u root -c lighttpd`

# xaml - 如何在 UserControl.Resources 中实例化对象？

> ID：692529
> 
> 赞同：3
> 
> 时间：2009-03-28T09:56:41.880
> 
> 标签：xaml, silverlight-2.0

我正在设计一个列表框，我想在其中包含设计时数据。

如果我的命名空间中有一个类，我该如何在用户控件 XAML 的资源中实例化该类的对象？

马尔科姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T13:06:44.063

```
<UserControl.Resources>
    <my:CustomObject xmlns:my="clr-namespace:MyNamespace" 
                     x:Key="MyCustomObj"
                     Property="Value"
    />
</UserControl.Resources> 
```

# c# - .Net (C#/VB.NET) 中泛型的使用示例

> ID：692540
> 
> 赞同：29
> 
> 时间：2009-03-28T10:06:58.550
> 
> 标签：c#, .net, vb.net, generics

在 C#/VB.NET 中使用泛型的地方有哪些示例，为什么要使用泛型？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-28T10:19:47.503

简单地说，你声明一个带有额外标签的类型或方法来指示通用位：

```
class Foo<T> {
    public Foo(T value) {
        Value = value;
    }
    public T Value {get;private set;}
} 
```

上面定义了一个通用类型`Foo`“of `T`”，其中`T`由调用者提供。按照惯例，泛型类型参数以 T 开头。如果只有一个，那`T`很好 - 否则将它们都命名为有用的名称：`TSource`、`TValue`等`TListType`

与 C++ 模板不同，.NET 泛型由运行时提供（不是编译器技巧）。例如：

```
Foo<int> foo = new Foo<int>(27); 
```

上面所有`T`的 s 都被替换了`int`。如有必要，您可以使用约束来限制泛型参数：

```
class Foo<T> where T : struct {} 
```

现在`Foo<string>`将拒绝编译 - 因为`string`不是结构（值类型）。有效的约束是：

```
T : class // reference-type (class/interface/delegate)
T : struct // value-type except Nullable<T>
T : new() // has a public parameterless constructor
T : SomeClass // is SomeClass or inherited from SomeClass
T : ISomeInterface // implements ISomeInterface 
```

约束还可以涉及其他泛型类型参数，例如：

```
T : IComparable<T> // or another type argument 
```

您可以根据需要拥有尽可能多的通用参数：

```
public struct KeyValuePair<TKey,TValue> {...} 
```

其他需要注意的事项：

*   静态成员等是**根据泛型类型组合**定义的 - 因此静态字段 on与 on`Foo<int>`是分开的`Foo<float>`。
*   方法也可以是通用的 - 尽量避免使用与类使用相同的名称，因为您将无法消除歧义
*   嵌套类型从其父类继承泛型类型

例如：

```
class Foo<T> {
    class Bar<TInner> {} // is effectively Bar<T,TInner>, for the outer T
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T10:53:07.027

示例 1：您要创建三元类

```
Class Triple<T1, T2, T3>
{
   T1 _first;
   T2 _second;
   T3 _Third;
} 
```

示例 2：一个帮助类，它将解析给定数据类型的任何枚举值

```
static public class EnumHelper<T>
{
   static public T Parse(string value)
   {
       return (T)Enum.Parse(typeof(T), value);
   }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T12:07:13.953

泛型的一种常见且非常有用的用法是强类型集合类。传统上，所有集合类都必须传递对象，并在查询时返回对象。您必须自己处理所有类型转换。使用泛型，您不必这样做。你可以有 List(Of Integer)，当你从它请求值时，你会得到整数。您不会得到必须转换为整数的对象。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-20T18:08:10.147

前面提到的 MSDN 文档中描述了泛型的最常见原因和用例。我想补充的泛型的一个好处是它们可以增强开发过程中的工具支持。诸如集成在 Visual Studio 或 ReSharper 中的重构工具依赖于静态类型分析来在编码时提供帮助。由于泛型通常会向您的对象模型添加更多类型信息，因此此类工具有更多信息可以分析并帮助您编码。

在概念层面上，泛型可以帮助您独立于应用程序域解决“横切”问题。无论您是在开发金融应用程序还是书店，您迟早都需要维护收藏品，无论是账户、书籍还是其他任何东西。此类集合的实现通常需要对这些集合中要维护的内容知之甚少。因此，.NET 框架附带的泛型集合是泛型用例的主要示例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-10-25T21:18:58.390

```
 private void button1_Click_1(object sender, RoutedEventArgs e)
    {
        TextValue<string, int> foo = new TextValue<string, int>("",0);
        foo.Text = "Hi there";
        foo.Value = 3995;
        MessageBox.Show(foo.Text);
    }

    class TextValue<TText, TValue>
    {
        public TextValue(TText text, TValue value)
        {
            Text = text;
            Value = value;
        }
        public TText Text { get; set; }
        public TValue Value { get; set; }
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-30T03:43:56.023

一个基本的例子是：

```
class Other{
 class Generic<T>
{
  void met1(T x);
}
static void Main()
{
  Generic<int> g = new Generic<int>();
  Generic<string> s = new Generic<string>();
}
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-25T21:53:11.503

```
 private void button1_Click_1(object sender, RoutedEventArgs e)
    {
        TextValue<string, int> foo;
        List<TextValue<string, int>> listTextValue = new List<TextValue<string, int>>();
        for (int k = 0; k < 5; ++k)
        {
            foo = new TextValue<string, int>("",0);
            foo.Text = k.ToString();
            foo.Value = k;
            listTextValue.Add(foo);
            otherList.
            MessageBox.Show(foo.Text);
        }

    }

    class TextValue<TText, TValue>
    {
        public TextValue(TText text, TValue value){Text = text; Value = value;}
        public TText Text { get; set; }
        public TValue Value { get; set; }
    } 
```

# c++ - C++模板静态成员指针初始化

> ID：692541
> 
> 赞同：4
> 
> 时间：2009-03-28T10:07:33.400
> 
> 标签：c++, templates, static, initialization

我有一个模板类，它有一个指向成员的静态指针，如下所示：

```
template<class T, T* T::*nextptr>
class Queue
{
    T* head;
    T* tail;
    static T* T::*pnext;
}; 
```

我的问题是如何编写静态成员指针的初始化程序。我尝试了明显的案例：

```
template<class T, T* T::*nextptr> T* Queue<T, nextptr>::*pnext(nextptr); 
```

但这没有用。任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T10:20:08.487

您真的需要与模板参数具有相同值的模板的静态成员变量吗？

唯一的用途是，如果它的值在程序的整个生命周期内发生变化，但我真的想不出任何情况，这会产生比引起混乱更多的好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T10:14:49.217

`Queue<T, nextptr>::pnext`被声明为 type `T* T::*`，所以它应该是这样的：

```
template<class T, T* T::*nextptr>
T* T::* Queue<T, nextptr>::pnext(nextptr); 
```

# sql - 确保原子性 sql

> ID：692544
> 
> 赞同：7
> 
> 时间：2009-03-28T10:13:10.873
> 
> 标签：sql, atomic

我只是在阅读 RDBMS，RDBMS 的一个属性是原子性。因此，如果从一个帐户中提取资金并转移到另一个帐户，则交易要么完全发生，要么根本不发生。没有部分交易。但实际上如何保证？

上述场景的 Sql 查询可能看起来像 (i) UPDATE `accounts`set balance = balance - amount WHERE ac_num = 101 (ii) UPDATE `accounts`set balance = balance + amount WHERE ac_num = 102

这决不能确保原子性。那么它实际上是如何发生的呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T10:25:58.440

如果你这样做

```
BEGIN TRANSACTION
UPDATE accounts set balance = balance - amount WHERE ac_num = 101
UPDATE accounts set balance = balance + amount WHERE ac_num = 102
COMMIT TRANSACTION 
```

数据库系统将对帐户 101 所做的更改写入注释。然后，如果帐户 102 上的工作失败，RDBMS 将使用这些注释撤消对 101 的工作。

此外，当它在帐户 101 上开始工作时，它会锁定数据库，这样其他人就无法读取帐户 101 中更新但未提交的数据。（这里的锁定基本上只是某处的注释“我在这里工作，请勿触摸。”）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T11:58:09.717

要成为原子事务，事务需要：

*   防止其他事务干扰它们正在写入或读取的行
*   确保在事务提交时，事务所做的所有更改或没有更改将在数据库中。

第一个是通过[锁定](http://tinyurl.com/c2335l)事务在执行期间读取或写入的行来实现的。

Second one is done so that transactions write their actions into a [transaction log](http://en.wikipedia.org/wiki/Transaction_log). This makes the database able to recover even when the server loses power during a transaction. In this case the recovery process will read the log, make sure that active (uncommited) transactions get aborted and changes made by them are canceled.

# sql-server - 在 TSQL 中使用逻辑

> ID：692548
> 
> 赞同：2
> 
> 时间：2009-03-28T10:14:52.867
> 
> 标签：sql-server, sql-server-2005, tsql

我想在 TSQL (SQL Server 2005) 中做这样的事情：

```
IF (Column1 = x)
{
     --CTE statement
}
ELSE
{
    --SQL statement
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T10:36:36.497

那是查询的一部分吗？还是靠自己？

在 之外`SELECT`，您有：

```
IF ([test])
BEGIN
     [true branch]
END
ELSE
BEGIN
    [false branch]
END 
```

分支可以做任何事情，包括使用 CTE 等。

在查询中，您有[`CASE`](http://msdn.microsoft.com/en-us/library/ms181765.aspx)：

```
SELECT ..., CASE WHEN Column1=x THEN [answer1]
                 ELSE [answer2] END, ... 
```

但是，你不能在里面做 CTE`CASE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T11:20:43.037

CTE 适用于整个声明并且不是独立的。它是较大 SQL 构造中的子句或子构造。

如果每个语句的输出不同，则此方法有效

```
IF EXISTS (SELECT * FROM table WHERE Column1 = x)
BEGIN
    ;WITH cStuff AS
    (
        ...
    )
    SELECT 
        ...
    FROM
        tables and cStuff
END
ELSE
BEGIN
    SELECT 
        ...
    FROM
        tables
END 
```

如果输出相同，则此方法有效：

```
;WITH cStuff AS
(
    ...
)
SELECT 
    ...
FROM
    tables and cStuff
WHERE
    column1 = x
UNION ALL
SELECT 
    ...
FROM
    tables
WHERE
    column1 <> x 
```

否则，我不确定你想要实现什么......

# c# - C#记事本类似文件读取

> ID：692549
> 
> 赞同：1
> 
> 时间：2009-03-28T10:19:25.977
> 
> 标签：c#

我有一个文件。当我在记事本中打开它时，我会在一行中看到字符。但是，如果我在[WordPad](http://en.wikipedia.org/wiki/WordPad)或[Notepad++](http://en.wikipedia.org/wiki/Notepad++)等任何其他应用程序中打开该文件。我可以看到字符之间不规则的换行符，它们出现在多行中。如果我这样做，这些换行符也会出现`reader.Readline()`。如何在 C# 中执行像行读取一样的记事本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T10:25:11.813

这种差异通常是因为文件使用的编码不明确。如果您希望正确解析文件顶部，则需要使用正确的编码。哪些字符会导致问题？此外 - 如果字节在使用的编码中不合法，则所有赌注都关闭；-p

您可以在创建（例如）`StreamReader`文件时指定编码：

```
 using (Stream stream = File.OpenRead(path))
    using (StreamReader reader = new StreamReader(stream, Encoding.UTF8))
    {
        string line;
        while ((line = reader.ReadLine()) != null)
        {
            Console.WriteLine(line);
        }
    } 
```

* * *

发布 base-64 后，问题`\r`出在行的中间。要将其读取为基本字符串，您可以使用：

```
 byte[] data = File.ReadAllBytes(path);
 string txt = Encoding.UTF8.GetString(data); 
```

要不就：

```
 string text = File.ReadAllText("foo.txt"); 
```

但是，您将始终难以显示此内容。您现在可以`Split`在您**选择**的行尾（大概是crlf）上。`StreamReader`正在分裂任何看起来*像*行尾的东西。

```
string[] lines = s.Split(new string[] {"\r\n"}, StringSplitOptions.None); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T12:16:57.893

很抱歉我的第二个回答，但我刚刚意识到您可以使用 peek 来获取下一个字符并检查当前和下一个是否为 \r\n，如下所示：

```
var path = "c:/test.txt";

File.WriteAllText(path, "a\nb\r\nc");

using (var stream = File.OpenRead(path))
using (var reader = new StreamReader(stream, Encoding.ASCII))
{
    var lineBuilder = new StringBuilder();
    string line;
    char currentChar;
    int nextChar;
    while (!reader.EndOfStream)
    {
        currentChar = (char)reader.Read();
        nextChar = reader.Peek();

        if (!(currentChar == '\r' && nextChar == '\n'))
        {
            lineBuilder.Append(currentChar);
        }

        if((currentChar == '\r' && nextChar == '\n') || nextChar == -1)
        {
            line = lineBuilder.ToString();
            Console.WriteLine(line);

            lineBuilder = new StringBuilder();

            reader.Read();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T10:46:10.530

如果这不是那么重要，您可以加载所有文本并使用正则表达式或其他东西将其分成几行，

```
var path = "c:/test.txt";

File.AppendAllText(path, "lala\nlala\nlalal");
var text = File.ReadAllText(path);

Console.WriteLine(Regex.Split(text, Environment.NewLine).Length); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-18T23:31:49.543

采用

```
String[] lines = File.ReadAllLines("c:\\text.txt"); 
```

一次提取所有线条

# visual-c++ - 如何使用键盘作为命令来放大opengl？

> ID：692550
> 
> 赞同：-1
> 
> 时间：2009-03-28T10:19:30.640
> 
> 标签：visual-c++, opengl, keyboard, zooming

谁能告诉我怎么做？

我以前从未这样做过，所以我不确定要使用哪个库以及如何调用按键作为指令而不是输入的命令。

我正在用 Visio C++ 编写一个 OpenGL 程序

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T10:24:05.543

放大 OpenGL 和获取键盘输入是两件不同的事情。您可以使用任何 GUI（MFC、wxWidgets、Qt、.Net）来捕获键盘事件作为输入。然后，您可以调用 OpenGL 函数 (glTranslate) 来更改缩放，然后重绘场景中的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T10:41:35.377

在 Win32 中，您可以执行以下操作来获取键的状态：

```
#define KEY_DOWN(vKey)    (GetAsyncKeyState(vKey) & 0x8000) ? true : false
#define KEY_UP(vKey)      (GetAsyncKeyState(vKey) & 0x8000) ? false: true 
```

vKey 是一个表示键 ASCII 值的 int。

当您知道正在按下“缩放”键时，您可以进行翻译

```
glPushMatrix();
    glTranslate3f(5.0,0.0,0.0); // moves the camera +5 down the x-axis
    ...
glPopMatrix(); 
```

实际上，您会使用更复杂的代码来进行缩放，因为这当然取决于视图方向。此外，您将拥有一个更复杂的键状态函数，该函数将位于您的消息循环中并保存您的应用程序将使用的所有键的状态，包括鼠标位置和鼠标按钮。

# javascript - Javascript：从主窗口中的图像弹出电影

> ID：692557
> 
> 赞同：3
> 
> 时间：2009-03-28T10:23:30.507
> 
> 标签：javascript, image, timeout, popup, cycle

我是一个主要是新手 Javascript'er，我正在一个网页上尝试它，按下按钮后，会弹出一个窗口，显示一个带有来自主窗口的图像的循环“电影”。从我尝试谷歌搜索的结果来看，我可以感觉到我已经很接近了，但是有些东西正在躲避我。

我知道接下来会导致两个不同的问题，这值得两个不同的帖子。但我认为因为两者都与相同的问题/目标有关，所以这可能属于一个（虽然很长）的帖子。所以我希望它的大小不会激怒人们太多...... ;-)

无论如何，这是我认为相关代码的快照：

```
<html>
<head>
<script language="javascript">
function wait() {}
function anim() {
  var timeout; var next;
  var popuptitle='Movie';
  var main=parent;
  var popup=parent.open("","",
      "width="+main.document.images[0].width+",height="+(main.document.images[0].height+40)+
      "toolbar=no,location=no,directories=no,status=no,"+
      "menubar=no,scrollbars=no,copyhistory=no,resizable=no");
  popup.document.write('<html><head><title>'+popuptitle+'</title></head><body>'+
    '<p align="center"><img name="anim" width="100%" alt=""></p>'+
    '<p align="center"><button name="close" onclick="javascript:window.close();">Close</button></p>'+
    '</body></html>');
  /*while(true)*/
  for(i=0; i<main.document.images.length; i++) {
    next=main.document.images[i].src;
    popup.document.images[0].src=next;
    timeout=setTimeout('wait();',500);
  }
}
</script>
</head>
<body><h1>Pictures + animation</h1>
<p><button name="exec" onclick="javascript:anim();">Animate (popup)</button></p>
<p><img src="img1.jpg"></p>
....
<p><img src="img16.jpg"></p>
</body>
</html> 
```

我为相关性输入/改编了这个；我希望我没有写错别字...

我正在使用 Debian Etch 的*Iceweasel*（Firefox 2.x 更名）；我没有在其他浏览器上尝试过。在 Iceweasel 中，会发生以下情况：

1.  弹出窗口按预期显示，但似乎循环直接进入最后一张图片。`setTimeout`似乎对图片之间的“暂停”没有影响。
2.  显示了最后一张图片，并且弹出窗口的状态栏在中途显示其进度条，表明正在加载某些内容。

所以我的问题是：

1.  我究竟应该如何在`setTimeout`这里使用电话？我试图让它调用一个“空”函数，所以它在具有 的循环中作为“暂停”工作，循环`setTimeout()`从主窗口的图像数组中更新弹出的单个图像。
2.  我发现，如果我通过从外部文件 ( `anim.html`) 加载 HTML 代码来加载弹出窗口，状态栏似乎从“进度条”显示窗口一直期待重新加载。我仍然会尝试它是否来自其他地方，但我想知道我从外部文件加载 HTML 页面是否重要/相关`window.open()`，而不是加载一个空窗口并对其执行 writeln 到“写” HTML。
3.  我已经`while(true)`在循环中评论了，否则浏览器会停止响应并且计算机会进入 100% CPU。我可以`if`在`for`循环中设置一个在最后一项之前将计数器设置回零，但是是否有另一种“优雅”或“更合适”的方式来使这个无限循环 - 或者`while(true)`做得很好？

我提前感谢您的评论，如果可能的话，请指向描述类似解决方案的现有参考书目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T11:44:44.587

我不认为这意味着你认为它意味着什么：

```
timeout=setTimeout('wait();',500); 
```

显然，您正在尝试`sleep()`解决此问题。这不是 JS[超时](https://developer.mozilla.org/en/DOM/window.setTimeout)的工作方式——这发生`onclick`在你的代码中：你循环遍历图像数组，立即将图像从第 0 个切换到第 1 个……到最后一个；*此外，*在每个开关上，您都会说“运行该`wait()`功能，从现在开始 500 毫秒”。

`window.setTimeout(foo,bar,baz)`这样做：它设置一个以`bar`毫秒为单位的计时器并返回。代码继续执行下一条语句。`bar`毫秒后，函数`foo(baz)`被自动调用。的第三个和后面的参数`setTimeout`是可选的，将在第一个参数中传递给函数。

你可以做什么：

```
function anim() { 
  var timeout; var next;
  var popuptitle='Movie';
  var main=parent;
  var popup=parent.open("","",
      "width="+main.document.images[0].width+",height="+
      (main.document.images[0].height+40)+
      "toolbar=no,location=no,directories=no,status=no,"+
      "menubar=no,scrollbars=no,copyhistory=no,resizable=no");
  popup.document.write('<html><head><title>'+popuptitle+
    '</title></head><body>'+
    '<p align="center"><img name="anim" width="100%" alt=""></p>'+
    '<p align="center"><button name="close" ' + 
    'onclick="javascript:window.close();">Close</button></p>'+
    '</body></html>');

  // *changed below*
  // start the animation with the 0th image
  next_image(0,main.document.images,popup.document.images[0]);
}

function next_image(index,source_image_array,target_image) {
    // if not at end of array
    if (source_image_array.length < index) { 
        next=source_image_array[index].src;
        target_image.src=next;

        // do this again in 500 ms with next image
        window.setTimeout(next_image,500, index+1 ,
                            source_image_array,target_image);
    }
} 
```

这样，在`anim()`函数结束时，您调用`next_image(0)`，它将图像设置为数组中的第 0 个并设置一个计时器以`next_image(1)`在 500 毫秒内调用；发生这种情况时，图像将设置为第一个，并且将设置一个计时器以`next_image(2)`在另一个 500 毫秒内调用，依此类推，直到数组中没有更多图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T12:20:55.263

这不是您问题的直接答案，但是通过使用 JavaScript 框架[jQuery](http://jquery.com/)和[插件](http://plugins.jquery.com/)，您可以轻松地制作图像幻灯片。我认为你想从头开始学习 JavaScript 很棒，但是走 jQuery+插件路线可以为你节省很多很多时间。哎呀，即使你想 DIY，我仍然建议使用 jQuery，因为它使 DOM 操作变得更加容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T13:35:03.743

致 Piskvor：感谢您的回复，这正是我需要知道的：

> `setTimeout(foo,bar,baz)`这样做：它设置一个以`bar`毫秒为单位的计时器并返回。代码继续执行下一条语句。`bar`毫秒后，函数`foo(baz)`被自动调用。的第三个和后面的参数`setTimeout`是可选的，将在第一个参数中传递给函数。

因此，这里遵循更正的示例；我希望它可以帮助其他 Google 员工 ;-)

```
<html>
<head>
<script language="javascript">
function display(img,i, popup) {
  var next; var after_ms=750; var max=img.length;
  if(i>=max) i=0;  /* so we can cycle infinitely */
  next=img[i].src; popup.document.images[0].src=next;
  setTimeout(display,(i+1<max?after_ms:4*after_ms), img,i+1,popup);
}
function anim() {
  var popuptitle='Movie';
  var popup_properties="width="+document.images[0].width+
      ",height="+(document.images[0].height+40)+
      ",toolbar=no,location=no,directories=no,status=no"+
      ",menubar=no,scrollbars=no,copyhistory=no,resizable=no"
  var popup=parent.open("", popuptitle, popup_properties);
  popup.document.write('<html><head><title>'+popuptitle+'</title></head><body>'+
    '<p align="center"><img name="anim" width="100%" alt=""></p>'+
    '<p align="center"><button name="close" onclick="javascript:window.close();">Close</button></p>'+
    '</body></html>');
  display(document.images,0, popup);
}
</script>
</head>
<body><h1>Pictures + animation</h1>
<p><button name="exec" onclick="javascript:anim();">Animate (popup)</button></p>
<p><img name="1"  src="img1.jpg"></p>
// .... 
<p><img name="16" src="img16.jpg"></p>
</body>
</html> 
```

我还学到了什么：

1.  这`while(true)`是邪恶的，它使浏览器挂起。相反，我在`anim()`函数中使用了一个条件，当它到达末尾时将索引设置回零。

# c - C编程中void指针的概念

> ID：692564
> 
> 赞同：132
> 
> 时间：2009-03-28T10:33:44.040
> 
> 标签：c, void-pointers

在 C 编程语言中是否可以在不进行类型转换的情况下取消引用 void 指针？

另外，有什么方法可以泛化一个可以接收指针并将其存储在 void 指针中的函数，并且通过使用该 void 指针，我们可以制作一个泛化函数吗？

例如：

```
void abc(void *a, int b)
{
   if(b==1)
      printf("%d",*(int*)a);     // If integer pointer is received
   else if(b==2)
      printf("%c",*(char*)a);     // If character pointer is received
   else if(b==3)
      printf("%f",*(float*)a);     // If float pointer is received
} 
```

我想在不使用 if-else 语句的情况下使这个函数通用 - 这可能吗？

此外，如果有很好的 Internet 文章解释了 void 指针的概念，那么如果您能提供 URL 将是有益的。

此外，是否可以使用 void 指针进行指针运算？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-03-28T10:36:15.110

> *是否可以在不使用 C 编程语言进行类型转换的情况下取消引用 void 指针...*

不，`void`表示没有类型，它不是您可以取消引用或分配的东西。

> *有什么方法可以泛化一个函数，它可以接收指针并将其存储在 void 指针中，通过使用该 void 指针，我们可以创建一个泛化函数。*

您不能只是以可移植的方式取消引用它，因为它可能没有正确对齐。这可能是某些架构（如 ARM）的问题，其中指向数据类型的指针必须在数据类型大小的边界处对齐（例如，指向 32 位整数的指针必须在 4 字节边界处对齐才能取消引用）。

例如，`uint16_t`读取`void*`：

```
/* may receive wrong value if ptr is not 2-byte aligned */
uint16_t value = *(uint16_t*)ptr;
/* portable way of reading a little-endian value */
uint16_t value = *(uint8_t*)ptr
                | ((*((uint8_t*)ptr+1))<<8); 
```

> *此外，是否可以使用 void 指针进行指针运算...*

`void`由于指针下方缺乏具体值以及大小，因此指针算术不可能在指针上进行。

```
void* p = ...
void *p2 = p + 1; /* what exactly is the size of void?? */ 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-28T10:42:38.760

在 C 中，`void *`可以将 a 转换为指向不同类型对象的指针，而无需显式强制转换：

```
void abc(void *a, int b)
{
    int *test = a;
    /* ... */ 
```

但是，这无助于以更通用的方式编写函数。

您不能取消引用 a`void *`并将其转换为不同的指针类型，因为取消引用指针正在获取指向对象的值。裸体`void`不是有效类型，因此无法取消引用 a `void *`。

指针算术是关于将指针值更改为所指向对象的倍数`sizeof`。同样，因为`void`不是真正的类型，`sizeof(void)`所以没有意义，所以指针算术在`void *`. （一些实现允许它，使用等效的指针算法`char *`。）

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-06-04T07:43:13.440

您应该知道，在 C 中，与 Java 或 C# 不同，绝对不可能成功“猜测”`void*`指针指向的对象类型。类似的东西`getClass()`根本不存在，因为该信息无处可寻。出于这个原因，您正在寻找的那种“通用”总是带有明确的元信息，例如您的示例中的或函数系列中`int b`的格式字符串。`printf`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-10-22T15:25:27.643

void 指针称为泛型指针，它可以引用任何数据类型的变量。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-09-19T09:02:35.173

到目前为止，我对 void 指针的理解如下。

当使用关键字 void 声明指针变量时，它将成为通用指针变量。任何数据类型（char、int、float 等）的任何变量的地址都可以分配给 void 指针变量。

```
main()
{
    int *p;

    void *vp;

    vp=p;
} 
```

由于其他数据类型的指针可以赋值给void指针，所以我在absolut_value（代码如下）函数中使用了它。做一个通用的功能。

## 我尝试编写一个简单的 C 代码，它将整数或浮点数作为参数，并尝试使其为 +ve，如果为负数。我写了以下代码，

```
#include<stdio.h>

void absolute_value ( void *j) // works if used float, obviously it must work but thats not my interest here.
{
    if ( *j < 0 )
        *j = *j * (-1);

}

int main()
{
    int i = 40;
    float f = -40;
    printf("print intiger i = %d \n",i);
    printf("print float f = %f \n",f);
    absolute_value(&i);
    absolute_value(&f);
    printf("print intiger i = %d \n",i);
    printf("print float f = %f \n",f);
    return 0;
} 
```

* * *

但是我遇到了错误，所以我开始知道我对 void 指针的理解是不正确的 :(。所以现在我将继续收集积分，为什么会这样。

我需要了解更多关于 void 指针的事情是。

我们需要对 void 指针变量进行类型转换以取消引用它。这是因为 void 指针没有与之关联的数据类型。编译器无法知道（或猜测？） void 指针指向的数据类型。因此，为了获取 void 指针指向的数据，我们使用 void 指针位置中保存的正确数据类型对其进行类型转换。

```
void main()

{

    int a=10;

    float b=35.75;

    void *ptr; // Declaring a void pointer

    ptr=&a; // Assigning address of integer to void pointer.

    printf("The value of integer variable is= %d",*( (int*) ptr) );// (int*)ptr - is used for type casting. Where as *((int*)ptr) dereferences the typecasted void pointer variable.

    ptr=&b; // Assigning address of float to void pointer.

    printf("The value of float variable is= %f",*( (float*) ptr) );

} 
```

如果程序员不确定最终用户输入的数据的数据类型，则 void 指针非常有用。在这种情况下，程序员可以使用 void 指针来指向未知数据类型的位置。程序可以设置为要求用户告知数据的类型，并且可以根据用户输入的信息进行类型转换。下面给出了一个代码片段。

```
void funct(void *a, int z)
{
    if(z==1)
    printf("%d",*(int*)a); // If user inputs 1, then he means the data is an integer and type casting is done accordingly.
    else if(z==2)
    printf("%c",*(char*)a); // Typecasting for character pointer.
    else if(z==3)
    printf("%f",*(float*)a); // Typecasting for float pointer
} 
```

关于 void 指针，您应该记住的另一个重要点是 – 指针算术不能在 void 指针中执行。

```
void *ptr;

int a;

ptr=&a;

ptr++; // This statement is invalid and will result in an error because 'ptr' is a void pointer variable. 
```

所以现在我明白了我的错误是什么。我正在纠正同样的问题。

参考 ：

[http://www.antoarts.com/void-pointers-in-c/](http://www.antoarts.com/void-pointers-in-c/)

[http://www.circuitstoday.com/void-pointers-in-c](http://www.circuitstoday.com/void-pointers-in-c)。

新代码如下所示。

* * *

```
#include<stdio.h>
#define INT 1
#define FLOAT 2

void absolute_value ( void *j, int *n)
{
    if ( *n == INT) {
        if ( *((int*)j) < 0 )
            *((int*)j) = *((int*)j) * (-1);
    }
    if ( *n == FLOAT ) {
        if ( *((float*)j) < 0 )
            *((float*)j) = *((float*)j) * (-1);
    }
}

int main()
{
    int i = 0,n=0;
    float f = 0;
    printf("Press 1 to enter integer or 2 got float then enter the value to get absolute value\n");
    scanf("%d",&n);
    printf("\n");
    if( n == 1) {
        scanf("%d",&i);
        printf("value entered before absolute function exec = %d \n",i);
        absolute_value(&i,&n);
        printf("value entered after absolute function exec = %d \n",i);
    }
    if( n == 2) {
        scanf("%f",&f);
        printf("value entered before absolute function exec = %f \n",f);
        absolute_value(&f,&n);
        printf("value entered after absolute function exec = %f \n",f);
    }
    else
    printf("unknown entry try again\n");
    return 0;
} 
```

* * *

谢谢，

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T00:35:24.630

```
void abc(void *a, int b) {
  char *format[] = {"%d", "%c", "%f"};
  printf(format[b-1], a);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-28T10:37:08.697

不，这是不可能的。取消引用的值应该有什么类型？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-03-04T05:31:58.590

以下是关于`void`指针的简要说明：[https ://www.learncpp.com/cpp-tutorial/613-void-pointers/](https://www.learncpp.com/cpp-tutorial/613-void-pointers/)

> ## 6.13 — 空指针
> 
> 因为void指针不知道它指向的是什么类型的对象，所以不能直接解引用！相反，在取消引用之前，void 指针必须首先显式转换为另一种指针类型。
> 
> 如果一个 void 指针不知道它指向什么，我们怎么知道要把它转换成什么？最终，这取决于你来跟踪。
> 
> ### 空指针杂项
> 
> 不可能对 void 指针进行指针运算。这是因为指针运算需要指针知道它所指向的对象大小，因此它可以适当地递增或递减指针。

假设机器的内存是字节可寻址的并且不需要对齐访问，解释 a 的最通用和原子（最接近机器级表示）的方式`void*`是作为一个字节的指针，`uint8_t*`. 例如，将a`void*`转换为 a`uint8_t*`将允许您打印出从该地址开始的前 1/2/4/8/however-many-you-desire 字节，但您无能为力。

```
uint8_t* byte_p = (uint8_t*)p;
for (uint8_t* i = byte_p; i < byte_p + 8; i++) {
  printf("%x ",*i);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-29T10:13:08.200

> 我想让这个函数通用，而不使用 ifs；可能吗？

我看到的唯一简单的方法是使用重载 .. 这在 C 编程语言 AFAIK 中不可用。

您是否为您的程序考虑过 C++ 编程语言？或者是否有任何限制禁止其使用？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-11-10T23:20:11.197

void 指针是没有与之关联的数据类型的指针。void 指针可以保存任何类型的地址，并且可以类型转换为任何类型。但是，不能直接取消引用 void 指针。

```
int x = 1;
void *p1;
p1 = &x;
cout << *p1 << endl; // this will give error
cout << (int *)(*p) << endl; // this is valid 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-15T07:31:16.277

您可以轻松打印空打印机

```
int p=15;
void *q;
q=&p;
printf("%d",*((int*)q)); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-06-03T00:48:27.967

您不能在不指定指针类型的情况下取消引用指针，因为不同的数据类型在内存中具有不同的大小，即 int 为 4 个字节，char 为 1 个字节。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-05-03T11:26:59.433

void指针是一个通用指针。任何变量的任何数据类型的地址都可以分配给一个void指针。

```
int a = 10;
float b = 3.14;
void *ptr;
ptr = &a;
printf( "data is %d " , *((int *)ptr)); 
//(int *)ptr used for typecasting dereferencing as int
ptr = &b;
printf( "data is %f " , *((float *)ptr));
//(float *)ptr used for typecasting dereferencing as float 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-25T11:45:34.047

因为 C 是静态类型的强类型语言，所以必须在编译前确定变量的类型。当您尝试在 C 中模拟泛型时，您最终会尝试再次重写 C++，因此最好使用 C++。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2019-05-15T23:12:23.090

从根本上说，在 C 中，“类型”是一种解释内存中字节的方法。比如下面的代码是什么

```
struct Point {
  int x;
  int y;
};

int main() {
  struct Point p;
  p.x = 0;
  p.y = 0;
} 
```

说“当我运行 main 时，我想分配 4（整数大小）+ 4（整数大小）= 8（总字节）的内存。当我将 '.x' 作为左值写入具有类型标签的值时指向编译时，从指针的内存位置加上四个字节检索数据。将返回值指定为编译时标签“int”。

在运行时在计算机内部，您的“点”结构如下所示：

```
00000000 00000000 00000000 00000000 00000000 00000000 00000000 
```

以下是您的`void*`数据类型可能的样子：（假设是 32 位计算机）

```
10001010 11111001 00010010 11000101 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2017-06-27T02:05:41.913

这是行不通的，但是 void * 在定义指向函数的通用指针并将其作为参数传递给另一个函数（类似于 Java 中的回调）或将其定义为类似于 oop 的结构时有很大帮助。

# .net - 您如何以编程方式（重新）签署具有强名称的 .NET 程序集？

> ID：692565
> 
> 赞同：6
> 
> 时间：2009-03-28T10:34:15.847
> 
> 标签：.net, strongname

除了调用命令行向程序集添加强名称之外，是否有任何 API 可以让您在程序集被剥夺其强名称后退出该程序集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-10-11T01:28:48.957

这取决于您所说的“剥夺其强名称”的程序集是什么意思。如果程序集没有强命名，则在使用强名称重新构建程序集之前，没有任何东西（甚至 sn.exe）可以退出程序集。

但要回答您的问题：所有强命名功能都通过 CLR 的[非托管强命名 API](http://msdn.microsoft.com/en-us/library/dd409349.aspx)公开。具体来说，您需要[`StrongNameSignatureGenerationEx`](http://msdn.microsoft.com/en-us/library/ff844051.aspx)，正如您会注意到的那样，它在功能上等同于`sn -R[a]`命令。

话虽*如此*`sn.exe`，调用自身要简单得多。访问非托管强名称 API 并不适合胆小的人，因为（从 .NET 4 开始）您必须首先通过 CLR 的元托管 API。出于这个原因，您也几乎不得不完全在非托管代码中执行此操作。（我确实[在 CodePlex 上找到了 Microsoft 的托管包装器](http://clractivation.codeplex.com/wikipage?title=How%20to%20use%20the%20managed%20wrapper%20API&referringTitle=Home)，但我无法`StrongNameSignatureGenerationEx`通过它正常工作。）

但是，如果您必须这样做，以下是如何从非托管代码访问强命名 API 的粗略概述：

*   通过调用来获取`ICLRMetaHost`或的实例。`ICLRMetaHostPolicy`[`CLRCreateInstance`](http://msdn.microsoft.com/en-us/library/dd537633.aspx)
*   使用该实例，获取当前运行时的实例（即`ICLRRuntimeInfo`实例）。有很多方法可以做到这一点；有关血腥细节，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/01918c6x.aspx)。
*   一旦有了 的实例，就可以通过调用的方法`ICLRRuntimeInfo`获取 的实例，传入和用于类/接口标识符。`ICLRStrongName``ICLRRuntime`[`GetInterface`](http://msdn.microsoft.com/en-us/library/dd233135.aspx)`CLSID_CLRStrongName``IID_ICLRStrongName`

现在你有了一个 的实例`ICLRStrongName`，你终于可以`StrongNameSignatureGenerationEx`使用它来调用了：

```
// This is the ICLRStrongName instance you'll need. Assume GetStrongNameAPI
// corresponds to an implementation of the rough process I outlined above.
ICLRStrongName *snAPI = GetStrongNameAPI();

// You'll have to load the .snk file into memory yourself using the Win32
// file APIs, the details of which I've omitted for the sake of brevity.
BYTE *keyPairBlob = NULL;
DWORD keyPairBlobSize = 0;
LoadKeyPair(&keyPairBlob, &keyPairBlobSize);

// Once you've got the key pair blob, you can now (re-)sign the assembly
HRESULT hr = snAPI->StrongNameSignatureGenerationEx(
    L"path\\to\\your\\assembly.dll", 
    NULL,
    keyPairBlob,
    keyPairBlobSize,
    NULL,
    NULL,
    0
);

// Do whatever error handling needs to be done with the given HRESULT 
```

（或者，如果您想使用密钥容器而不是`.snk`密钥对进行签名，您可以将密钥容器的名称作为第二个参数传入，并将密钥对 blob/大小参数保留为 NULL。）

**底线：如您所见，除非您真的必须通过强大的命名 API，否则仅通过调用 sn.exe 本身来（重新）签署程序集要容易*得多。***

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T10:59:35.100

您可以查看[`mscoree`'s strong name APIs](http://msdn.microsoft.com/en-us/library/aa964998.aspx)，但我不推荐它。

# python - python中的图形用户界面

> ID：692566
> 
> 赞同：4
> 
> 时间：2009-03-28T10:34:16.127
> 
> 标签：python, user-interface

### 复制：

> [用于部署 Python 应用程序的跨平台 gui 工具包](https://stackoverflow.com/questions/520015/cross-platform-gui-toolkit-for-deploying-python-applications)

我想在 python 中创建一个 GUI 应用程序。哪个图书馆最好？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T10:52:29.360

从问题[Cross-platform gui toolkit for deploying Python applications](https://stackoverflow.com/questions/520015/cross-platform-gui-toolkit-for-deploying-python-applications)：

> # [PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro)
> 
> 它建立在C++ 框架[Qt](http://qt.nokia.com/)之上。它非常先进，并且有一些很好的工具，比如 Qt Designer 来设计你的应用程序。不过你应该知道，它感觉不像是 Python 100%，而是接近它。
> 
> 这个框架真的很好。它由诺基亚拥有的奇趣科技积极开发。Python 的绑定由 Riverbank 开发。
> 
> 诺基亚宣布他们将从 Qt 4.5 开始将 LGPL 用于 Qt-Framework（我认为将在 4 月发布），但尚不确定 Riverbank 是否遵循这一点并在 LGPL 下发布 Python 的绑定。（他们目前拥有商业和 GPL 许可证。）
> 
> Qt 不仅是一个 GUI 框架，而且还有许多其他类，只需使用 Qt 类就可以创建应用程序。（如 SQL、网络……）
> 
> Qt 不使用本机 GUI 元素，但 wikipedia 提到在最近的版本中，[Qt](http://en.wikipedia.org/wiki/Qt_toolkit#Use_of_native_UI-rendering_APIs)尽可能使用本机小部件。我没有在 [文档中找到证据，但对于 Mac OS X](http://doc.qt.nokia.com/4.4/qtmac-as-native.html)。
> 
> # [wxPython](http://www.wxpython.org/)
> 
> wxPython 是使用[wxWidgets](http://www.wxwidgets.org/) -Framework 的 Python 绑定。该框架在 LGPL 许可下，由开源社区开发。
> 
> 我真正缺少的是设计界面的好工具，它们大约有 3 个，但没有一个可用。
> 
> 我应该提到的一件事是，尽管我没有使用任何先进的东西，但我在选项卡视图中发现了一个错误。（仅在 Mac OS X 上）我认为 [wxWidgets](http://www.wxwidgets.org/)不如[Qt](http://qt.nokia.com/)优美。
> 
> wxPython 实际上只是关于 GUI 类，没有太多其他内容。
> 
> wxWidgets 使用原生 GUI 元素。
> 
> # 其他
> 
> 我对其他 GUI 框架没有任何经验，也许其他人有。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-28T10:43:31.770

wxWidgets（Python 风格称为[wxPython](http://wxpython.org)）目前是您最好的选择，恕我直言，它们支持多平台（Mac、Window、Linux），并且该框架非常易于使用。

[从网站](http://www.wxwidgets.org)：

*wxWidgets 允许开发人员使用一个代码库为 Win32、Mac OS X、GTK+、X11、Motif、WinCE 等创建应用程序。它可以用于 C++、Python、Perl 和 C#/.NET 等语言。与其他跨平台工具包不同，wxWidgets 应用程序的外观和感觉都是原生的。这是因为 wxWidgets 使用平台自己的原生控件而不是模拟它们。它也是广泛的、免费的、开源的和成熟的。为什么不试一试，比如*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T10:54:45.127

我喜欢[PyQt](http://wiki.python.org/moin/PyQt)。wxPython 有很多缺点，而且你用 PyQt 编写的代码通常要干净得多。UI设计师也很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T10:50:31.143

对于通用 GUI 应用程序，我会推荐[wxPython](http://www.wxpython.org/)。[这是wxWidgets](http://wxwidgets.org/)项目的 python 风格。它易于使用、跨平台、功能齐全，而且演示实际上是一个很棒的教程。

对于类似游戏的 GUI，我会选择[pyGame](http://www.pygame.org/)。它也非常简单和强大：您可以在几分钟内编写一个小游戏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T10:40:44.677

我会推荐你[​​ wxPython](http://www.wxpython.org/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-28T11:17:15.977

TKInter。最简单的。

# visual-studio-2008 - 来自 Mac 的远程桌面上的 Visual Studio - 有什么问题吗？

> ID：692568
> 
> 赞同：9
> 
> 时间：2009-03-28T10:34:32.260
> 
> 标签：visual-studio-2008, macos, remote-desktop

我需要一台新的笔记本电脑，我正在考虑购买一台 Mac。但是，我日常工作的一个重要部分涉及到我的办公室计算机 (Vista) 的远程桌面，以及运行 Visual Studio 2008。有人这样做过吗？是否有需要注意的具体问题？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-05-12T16:37:57.040

远程桌面工作没有缺陷。

广告功能键 - 伙计们，你检查了吗？

`System Preferences`->`Keyboard`并在“键盘选项卡”下选中带有文本的复选框：

![在此处输入图像描述](https://i.stack.imgur.com/PabNa.jpg)

在此之后，您的功能键将按预期工作......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-07T18:07:07.710

如果您想使用 Visual Studio 默认值进行调试，您只需要在功能键之外使用命令键，例如，“step over”是 command-f10 而不是简单的 f10。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-28T10:36:36.403

它工作得很好。我已经在家里做了很多次了。使用我的 MacBook Air 在我的四核工作站上远程开发。我能想到的唯一问题（键盘快捷键除外）是您没有可用的 Aero :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-12T15:47:58.350

根据 Aaron 的建议，我今天只需要这样做，并且 fn-ctrl-[function key] 而不是 command-[function key] 在我的 MacBook Pro 上适用于大多数功能键，但它很快就会变得混乱，尤其是当你的快捷键需要多个键。即 Shift-F5 停止调试变为 shift-fn-ctrl-F5。如果您是 resharper 用户，您可能还会发现禁用 resharper 快捷方式以避免混淆很有用。

我不确定这是否是 Mac、RDP、VS 和/或 Resharper 之间的键映射冲突问题，但 fn-ctrl-F11 最初不适用于 debug-step into 命令。我必须在 VS 中的 options=>environment=>keyboard=>Debug.StepInto 下明确设置命令。可能还有其他类似的问题。

总之，您可能需要做的大部分事情都可以完成，但您可能会发现自己在远程工作时会更改设置，并且必须记住一组新的快捷方式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-08T06:15:53.410

从我的 Mac 到多个 Windows 2008 R2 服务器，我一直使用远程桌面连接。它工作得很好。它已经在我身上撞了几次，但这种情况很少见。我在 Mac 上使用了一个名为[Palua](http://itunes.apple.com/us/app/palua/id431494195?mt=12)的应用程序，它会根据正在使用的应用程序自动打开和关闭 fn 键。我也为 VMWare Fusion 打开它。

我正在考虑使用 RDP 而不是虚拟机进行开发。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T12:03:34.447

我会将 Visual Studios 快捷方式更改为类似于 X-Code 的快捷方式。需要时间，但这是值得的。而且我还记得 Mac 的远程桌面可以重新映射 Mac 键以充当 Windows 键 - 如果我没记错的话，请尝试这样做。否则远程桌面工作正常，完全没有问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T11:24:30.640

它确实工作得很好。我只想在键盘快捷键上强调*Mehrdad*点。你一定会想念他们的。**很多！**. 我知道这可能只是我不知道该怎么做，但是直到今天，我还无法使 F10 和 F11（非常重要的调试键）正常工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-10T20:25:15.227

我在 MBP2015 上，并使用 Visual Studio 2013 远程桌面进入我的 Win10 工作环境。例如调试键 F10、F11（我也假设其他键）不起作用。我尝试了其他人使用 Command+F10 的建议，但这不起作用。然后我尝试了 Command + fn + F10 并且有效。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-19T20:05:39.713

如果您在 bootcamp 中使用 Windows 10 并连接到另一个远程桌面（也就是 Windows 10），则 Visual Studio 将不会接受您的 F5 到 F12 键而不按下 Fn 键。如果您想避免使用 Fn 键，请从系统托盘打开 Boot Camp 控制面板并勾选“使用所有 F1、F2 等键..”，如屏幕截图所示。 [![训练营设置](https://i.stack.imgur.com/0wUGY.png)](https://i.stack.imgur.com/0wUGY.png)

# java - 如何计算在 Java 中完成一个函数所需的时间？

> ID：692569
> 
> 赞同：57
> 
> 时间：2009-03-28T10:35:15.300
> 
> 标签：java, profiling

我需要测量一个函数在 Java 中完成所需的时间。我怎样才能做到这一点？

### 笔记：

我想测量**函数**的时间消耗，而不是整个程序的时间消耗。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-03-28T10:43:29.320

```
long start = System.nanoTime();    
methodToBeTimed();
long elapsedTime = System.nanoTime() - start; 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-28T10:49:12.737

这是如何计算经过的时间。

```
// Get current time
long start = System.currentTimeMillis();

// Do something ...

// Get elapsed time in milliseconds
long elapsedTimeMillis = System.currentTimeMillis()-start;

// Get elapsed time in seconds
float elapsedTimeSec = elapsedTimeMillis/1000F;

// Get elapsed time in minutes
float elapsedTimeMin = elapsedTimeMillis/(60*1000F);

// Get elapsed time in hours
float elapsedTimeHour = elapsedTimeMillis/(60*60*1000F);

// Get elapsed time in days
float elapsedTimeDay = elapsedTimeMillis/(24*60*60*1000F); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-06-10T09:45:51.023

如果您使用 Guava，请考虑使用[`Stopwatch`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Stopwatch.html)，例如：

```
final Stopwatch sw = Stopwatch.createStarted();
methodToBeTimed();
final long elapsedMillis = sw.elapsed(TimeUnit.MILLISECONDS); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-28T12:23:00.143

[使用](http://java-source.net/open-source/profilers) [分析器](http://www.eclipse.org/tptp/)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-28T14:52:38.177

如果您有多个功能，探查器是正确的答案。

到目前为止，我看到的所有建议的另一个问题是它们对于单个函数工作正常，但是您的代码将充满您无法关闭的计时内容。

如果您知道如何进行面向方面的编程，那么将时序代码保存在一个地方并以声明方式应用它是一种好方法。如果您使用 Log4J 之类的东西来输出值，您可以选择关闭或打开它。这是一个穷人的剖析器。

看看 AspectJ 或 Spring 的 AOP。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-28T16:10:09.207

上面的所有代码片段都测量了从调用方法到方法返回/抛出异常的大致时间。此类技术不解决线程调度、GC 引起的暂停等问题。

是的，一些分析器会做一个合理的工作。

如果您使用 Java 1.6 及更高版本，则可以使用基于 JMX 的 VM 管理和监控支持。例如，您可能会发现[ThreadMXBean.getCurrentThreadCpuTime()](http://java.sun.com/javase/6/docs/api/java/lang/management/ThreadMXBean.html#getCurrentThreadCpuTime())的值。在方法调用之前和之后计算此值的差异将为您提供：

> "... 当前线程的总 CPU 时间，以纳秒为单位。返回值是纳秒精度，但不一定是纳秒精度。如果实现区分用户模式时间和系统模式时间，则返回的 CPU 时间是时间量当前线程已在用户模式或系统模式下执行。”

如果您的方法产生工作线程，那么您的计算将需要更加精细;-)

一般而言，我建议在[java.lang.mangement](http://java.sun.com/javase/6/docs/api/java/lang/management/package-summary.html)包周围留心。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-28T10:45:12.530

[System.nanoTime](http://java.sun.com/javase/6/docs/api/java/lang/System.html#nanoTime())应该用于准确测量两次微基准测试之间的增量。

```
public class CountTime {

  private static void walk() {
    for (int i = 0; i < Integer.MAX_VALUE; i++)
      ;
  }

  public static void main(String[] args) {
    long t0 = System.nanoTime();
    walk();
    long t1 = System.nanoTime();
    System.out.println("Elapsed time =" + (t1 - t0)
        + " nanoseconds");
  }

} 
```

[System.currentTimeMillis](http://java.sun.com/javase/6/docs/api/java/lang/System.html#currentTimeMillis())以毫秒为单位返回当前时间。您可以使用它来获取当前时间。这对于较旧的 VM 或运行时间较长的进程可能很有用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-28T10:46:57.750

使用 System.currentTimeMillis() 或 System.nanoTime()：

```
int someMethod() {
    long tm = System.nanoTime();
    try {
        ...
    } finally {
        tm = System.nanoTime()-tm;
        System.out.println("time spent in someMethod(): " + tm + "ns");
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-21T04:04:33.957

这个模拟秒表也是我们的另一种选择......在[这里查看 Java2s.com。](http://www.java2s.com/Code/Java/Development-Class/Simulatesastopwatchwithalapcounter.htm)

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-03-28T10:38:13.513

如果要获取当前时间，请使用`java.util.Date`.

# asp.net - 今天为 ASP.net 推荐哪个数据访问层？

> ID：692572
> 
> 赞同：2
> 
> 时间：2009-03-28T10:36:18.493
> 
> 标签：asp.net, ado.net, data-access-layer, data-access

我目前正在建立一个小型网站，我会在其中写下出现的问题并给出答案，以供其他人查看。目前我使用的 DAL 与[此处](http://weblogs.asp.net/scottgu/archive/2006/01/15/435498.aspx)描述的非常相似。现在我一直在研究其他模型，特别是使用 Linq2SQL 和 ADO.net Entries 框架的基于 linq 的模型。我意识到我正在以某种方式将数据访问移动到代码层，因为然后我会过滤掉例如带有 linq 查询的顶级列表。我开始这样做的原因是因为 DAL 并没有真正与数据库同步，并且当我更改数据库中的某些内容时，可空类型变得不可空。然后，如果我将表重新导入数据表，我的查询将丢失。

我的简单问题是，如果您今天想要一个适用于 ASP.net 的良好 DAL，那会是什么？建议，经验非常受欢迎。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T10:44:12.097

我个人更喜欢**[LINQ to SQL](http://msdn.microsoft.com/en-us/library/bb425822.aspx)**和**[ADO.NET Entity Framework](http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework)**。微软的人也在他们最新的项目中使用这些技术（例如看看**[KOBE](http://msdn.microsoft.com/en-us/architecture/bb194897.aspx)**项目）。因此，微软也推荐这两个。

虽然.. 有时，当我需要最大程度地控制它的功能和实现时，我会使用[企业库](http://www.codeplex.com/entlib)中的数据访问应用程序块和手动 DAL 编码。

其他替代方案是：[NHibernate](http://www.hibernate.org/)、[SubSonic](http://subsonicproject.com/)、不同的 ORM 解决方案，如[LLBLGen Pro](http://www.llblgen.com/)。

* * *

关于这个主题的好书：

*   [Pro LINQ：](https://rads.stackoverflow.com/amzn/click/com/1590597893) Jr.，Joseph C. Rattz在 C# 2008 中的语言集成查询
*   [LINQ in Action](https://rads.stackoverflow.com/amzn/click/com/1933988169) by Fabrice Marguerie
*   Julia Lerman 编写的[实体框架编程](https://rads.stackoverflow.com/amzn/click/com/059652028X)
*   [Murach 的 ADO.NET 3.5、LINQ 和带有 VB 2008 的实体框架，](https://rads.stackoverflow.com/amzn/click/com/1890774529)作者 Anne Boehm

* * *

相关工具：

*   [LINQPad](http://www.linqpad.net/)也是学习 LINQ 的好方法：它预装了书中的 200 个示例，[C# 3.0 in a Nutshell](https://rads.stackoverflow.com/amzn/click/com/0596527578)。没有更好的方式来体验 LINQ 和函数式编程的酷炫。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T10:39:32.293

有很多选择，根据您的具体情况，每个选项都可能会更好。一些选项包括：

*   LINQ 到 SQL
*   ADO.NET 实体框架
*   休眠
*   亚音速
*   手动写一个:)

我的默认选择是 LINQ to SQL。不过，这完全是个人喜好。许多人都是 NHibernate 的拥护者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T20:17:42.713

我在当前项目中使用[OPF3](http://opf3.com/)，主要是因为它对 Pervasive.SQL v9.5 有很好的支持。支持也很棒。

# wpf - UIElement.ClipToBounds 在 WPF 中，但不在 Silverlight 中。如何在 Silverlight 中进行模拟？

> ID：692585
> 
> 赞同：4
> 
> 时间：2009-03-28T10:43:13.143
> 
> 标签：wpf, silverlight

我在 WPF 中有一个 Canvas，我想防止它的子级被绘制到 Canvas ara 的边缘之外。在 WPF 中，这很简单，因为您只需将 Canvas 上的 ClipToBounds 属性设置为 True，它就会按预期进行。

将示例 XAML 移植到 Silverlight 存在问题，因为 ClipToBounds 不存在！有没有办法模拟这个功能？我很高兴从 Canvas 派生并在需要时覆盖 Measure/Arrange 方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T03:49:27.700

我自己找到了解决方案。像这样覆盖 ArrangeOverride 方法...

```
protected override Size ArrangeOverride(Size finalSize)
{
    RectangleGeometry clipRectGeometry = new RectangleGeometry();
    clipRectGeometry.Rect = new Rect(new Point(0,0), finalSize);
    Clip = clipRectGeometry;

    return base.ArrangeOverride();
} 
```

# vb.net - 使用 GSM 调制解调器呼叫

> ID：692592
> 
> 赞同：3
> 
> 时间：2009-03-28T10:47:06.817
> 
> 标签：vb.net, modem, gsm

我正在 vb.net 中开发短信项目。我可以轻松地发送和接收短信。我可以接听来电和拨号。但不能听和说。我连接了 com 端口。这对于谈话和听力来说是可能的，也可能不是。请告诉我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-02T10:37:59.520

发起拨号/连接/发送数据短信是在**数字**连接上，因此串行端口，另一方面处理语音，这是**模拟**的（除非将模拟转换为数字并通过数字形式发送 - VoIP），你需要能够连接到扬声器和麦克风。我建议使用[http://arduino.cc/en/Guide/ArduinoGSMShield](http://arduino.cc/en/Guide/ArduinoGSMShield) --> 易于使用并支持所有短信（数字）和语音（模拟）。但是，启动工作的应用程序可以使用 VB.net

希望这有帮助。

# c# - 为整个项目全局声明预处理器符号（如 DEBUG）

> ID：692595
> 
> 赞同：6
> 
> 时间：2009-03-28T10:49:35.513
> 
> 标签：c#, .net, visual-studio, nunit, c-preprocessor

我想像这样在 NUnit 和 VS 测试之间切换：

```
#if !NUNIT
using Microsoft.VisualStudio.TestTools.UnitTesting;
#else
  using NUnit.Framework;
  using TestClass = NUnit.Framework.TestFixtureAttribute;
  using TestMethod = NUnit.Framework.TestAttribute;
  using TestInitialize = NUnit.Framework.SetUpAttribute;
  using TestCleanup = NUnit.Framework.TearDownAttribute;
  using TestContext = System.String;
  using DeploymentItem = NUnit.Framework.DescriptionAttribute;
#endif 
```

我的问题是，我如何在一个地方声明 NUNIT 预处理器符号（App.config 左右，会很棒），以便在 NUnit 和 VSTests 之间轻松切换？因为当我使用时`#define NUNIT`，它仅适用于写入它的文件。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T10:50:13.610

使用项目属性对话框。您可以在那里定义全局符号：

> 右键项目 -> 属性 -> 构建选项卡 -> 条件编译符号

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-28T10:52:01.607

每个项目执行此操作的唯一方法是通过项目/构建本身（项目属性 -> 构建 -> 条件编译符号）。您可以为一个项目定义多个“配置”（定义了不同的符号），并使用您想要的那个。

要添加新配置，请使用配置管理器（在调试/发布下拉列表的底部）并基于现有的（调试/发布/等）创建一个新配置。现在在项目属性中，您可以选择此选项来为该配置设置不同的符号。

# java-me - 运行 j2me jar 文件

> ID：692603
> 
> 赞同：1
> 
> 时间：2009-03-28T10:56:09.087
> 
> 标签：java-me, opera, nokia

我已经从[http://www.opera.com/mini/download/nokia/nokia_6600/下载了 Opera mini](http://www.opera.com/mini/download/nokia/nokia_6600/)

我下载了jad和jar文件，opera-mini-4.2.13918-advanced-en.jadopera-mini-4.2.13918-advanced-en.jar，复制到Sun java无线工具包的bin目录下，[C :\j2me 模拟器\emulator\bin]

为了运行文件，我使用以下命令

```
emulator -Xdevice:DefaultColorPhone -Xdescriptor:opera-mini-4.2.13918-advanced-en.jad -Dcom.sun.midp.io.http.proxy=10.0.0.10:9401 
```

我的互联网连接是通过代理服务器，每当我启动应用程序时，它都会说“无法连接到互联网”帮助我我正在使用 Sun_Java_TM__Wireless_Toolkit_2_5_1_for_CLDC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T12:49:30.123

我建议您从不在代理服务器后面的计算机上尝试设置。然后，您将（希望）知道是否是代理服务器导致了您的问题。

# embedded - (avr-gcc) 子目录的 Makefile 支持

> ID：692604
> 
> 赞同：0
> 
> 时间：2009-03-28T10:56:42.407
> 
> 标签：embedded, makefile, avr, subdirectory

我正在开发一个 AVR 项目，并且有多个文件夹包含我的代码。

我使用的 makefile 是 Pat Deegan 的“Standardized AVR Makefile Template”。它能够正确编译每个文件夹中的每个 cpp 文件并生成正确的对象 (.o) 文件。

但是，链接器失败，因为它尝试在子文件夹中查找 .o 文件（编译器将它们放在主文件夹中）。这是我得到的错误示例：

> avr-gcc: subfolder/module.o: 没有这样的文件或目录 make: ***
> 
> [GrandCanyon.out] 错误 1

你能帮我修改它，以便链接器和编译器将文件（.o）放在同一个文件夹中并检查它们吗？

谢谢

你可以在这里得到makefile：http: [//electrons.psychogenic.com/articles/Makefile.tpl](http://electrons.psychogenic.com/articles/Makefile.tpl)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:42:46.627

问题是过滤器命令，它删除目录并只留下文件名（[链接](http://www.linuxdevcenter.com/pub/a/linux/2002/02/14/makefiles.html?page=2)）。因此，不要在一行中定义所有文件并执行以下操作：

```
#  C
CFILES=$(filter %.c, $(PRJSRC))
#  Assembly
ASMFILES=$(filter %.S, $(PRJSRC)) 
```

您需要为每种类型手动定义文件列表：

```
CCFILES = sub1/file1.c sub2/file2.c
ASMFILES = sub1/file1.asm sub3/file2.asm 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-26T21:08:25.987

嗨，我只在 C 中编程 avr MCU，而不是在 C++ 中。所以我在 CFLAGS 部分中将 makefile 扩展了大约一行

```
CFLAGS=-I. $(INC) -g -mmcu=$(MCU) -O$(OPTLEVEL) \ 
    -fpack-struct -fshort-enums             \ 
    -funsigned-bitfields -funsigned-char    \ 
    -Wall -Wstrict-prototypes               \ 
    -o $(firstword $(filter %.o, $(<:.c=.o))) \
    -Wa,-ahlms=$(firstword $(filter %.lst, $(<:.c=.lst))) 
```

当我在子目录中有源文件时，这对我有用。我希望这对您有所帮助，尽管这不适用于 C++

# java - java.io.File 列表非英文文件名

> ID：692606
> 
> 赞同：2
> 
> 时间：2009-03-28T10:57:09.147
> 
> 标签：java, filenames

我决定编写一个列出所有文件和目录的程序，但是在处理非英文文件名时遇到了问题。

问题是我的程序不能保证这些目录和文件名是英文的，如果某些文件名使用日文或中文字符，它会将一些字符显示为“？”。

J2SE 提供了多种 java.io.File list() 函数：[https](https://docs.oracle.com/javase/1.5.0/docs/api/java/io/File.html) ://docs.oracle.com/javase/1.5.0/docs/api/java/io/File.html 。

但它似乎不处理非英文文件名。

有没有人有同样的问题？我应该向哪个方向寻找解决方案？

我搜索了诸如“java list non-english filename”、“java.io.file list non-english filename”之类的关键字，但不幸的是我找不到解决方案。

我希望人们给我一些想法，无论是在谷歌搜索关键字，还是程序方向。

谢谢~

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T14:08:19.437

从 Java 向 Windows 命令提示符发出“国际”字符的问题有三个：

1.  默认光栅字体不支持
2.  默认的 8 位代码页可以追溯到 DOS 时代，与系统上的默认 Windows 编码不同
3.  Java ( *System.out* ) 以默认操作系统编码对输出进行编码，这在 Windows 上将是一个固有的有损过程

要让 Java 发出字符，可以：

1.  安装[MUI](http://msdn.microsoft.com/en-us/goglobal/bb978454.aspx)并切换到允许您想要的字符的设置（您可能仍需要使用*chcp*来切换编码）
2.  将控制台切换到包含字符的 Unicode TrueType 字体并使用本机方法 ( [WriteConsoleW](http://msdn.microsoft.com/en-us/library/ms687401(VS.85).aspx) ) 发出文本。

解释一切的链接：

*   [I18N：Windows 命令提示符下的 Unicode（C++；.Net；Java）](http://illegalargumentexception.blogspot.com/2009/04/i18n-unicode-at-windows-command-prompt.html)
*   [Java：Windows 命令行上的 Unicode](http://illegalargumentexception.blogspot.com/2009/04/java-unicode-on-windows-command-line.html)

* * *

在 Swing 下显示字符可能会更好。您可以使用这样的应用程序来测试 Swing 可用的字体，以查看它们是否呈现您的角色：

```
public class FontTest {

  // a Cyrillic and two CJK characters    
  private final String filename = "\u044F\u4E10\u4E20.txt";

  private ComboBoxModel createModel() {
    GraphicsEnvironment genv = GraphicsEnvironment
        .getLocalGraphicsEnvironment();
    Vector<Font> fonts = new Vector<Font>();
    for (Font font : genv.getAllFonts()) {
      Font newFont = new Font(font.getFontName(), font
          .getStyle(), 12);
      fonts.add(newFont);
    }
    DefaultComboBoxModel model = new DefaultComboBoxModel(
        fonts);
    return model;
  }

  private JFrame createGui() {
    final JLabel label = new JLabel();
    label.setText(filename);

    final JComboBox combo = new JComboBox();
    combo.setEditable(false);
    combo.setModel(createModel());
    combo.addActionListener(new ActionListener() {
      @Override
      public void actionPerformed(ActionEvent e) {
        Font font = (Font) combo.getSelectedItem();
        label.setFont(font);
      }
    });

    label.setFont((Font) combo.getItemAt(0));

    JFrame frame = new JFrame();
    Container contentPane = frame.getContentPane();
    contentPane.setLayout(new GridLayout(0, 1));
    contentPane.add(label);
    contentPane.add(combo);
    frame.pack();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    return frame;
  }

  public static void main(String[] args) {
    JFrame frame = new FontTest().createGui();
    frame.setVisible(true);
  }

} 
```

XP 下的 Java 6 使用默认的 JLabel 字体完美显示所有字符（Dialog - 这是一个映射到其他东西的逻辑名称，因此您不会在charmap 中看到它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T11:04:50.173

你如何显示文件名？问题可能在于显示而不是获取字符串。

我建议您打印出每个字符的 Unicode 值（用于`charAt()`获取每个字符，然后将其转换为`int`）并将它们与[Unicode 代码图表](http://www.unicode.org/charts/)进行比较。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-28T10:58:45.243

字符串是 Java 中的 Unicode（如文档所说的 utf-16）。所以只需像这样传递文件名。当然，底层操作系统应该支持这一点。

# iphone - 横向模式下的 Cocos 2d & CGPoint 混淆

> ID：692609
> 
> 赞同：2
> 
> 时间：2009-03-28T11:00:56.330
> 
> 标签：iphone, objective-c, cocoa, cocos2d-iphone

所有，我再次与另一个菜鸟 Cocos2d iphone 问题。

我已经将我的 Director 设置为横向，但是当我查看“触摸事件”的坐标时，它仍然在拾取它们，就好像屏幕是纵向的一样。所以他们基本上被颠倒了。

```
x = 100, y = 50 
```

本来应该

```
x = 50, y = 100 
```

没什么大不了的，它很容易通过创建一个新的 CGPoint 并交换值来解决。但是，感觉应该有一些更简洁的方法来做到这一点。但我一直无法找到任何参考。这是唯一的方法还是 Cocoa Touch 或 Cocos2d 中内置了一些东西来解决这个问题。

题外话：我的上帝，iPhone 是一个很好的开发平台。而 Obj-C 就像黄瓜一样酷。抱歉，我不得不把它从我的系统中取出，我的朋友都不是程序员。他们不了解 Internet Explorer 的痛苦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T18:20:48.317

```
cocosTouchPoint = [[Director sharedDirector] convertToGL:touchPoint]; 
```

# mysql - Mysql 按评级排序 - 但捕获所有

> ID：692614
> 
> 赞同：0
> 
> 时间：2009-03-28T11:12:23.620
> 
> 标签：mysql, inner-join, rating

我有这个 PHP/MYSQL 代码，它从按评级排序的表中返回记录，从最高评级到最低评级：

```
<table width="95%">
    <tr>
    <?php
        if (isset($_GET['p'])) {
            $current_page = $_GET['p'];
        } else {
            $current_page = 1;
        }
        $cur_category = $_GET['category'];
        $jokes_per_page = 40;
        $offset = ($current_page - 1) * $jokes_per_page;

        $result = mysql_query("
        select jokedata.id as joke_id, jokedata.datesubmitted as datesubmitted,
        jokedata.joketitle as joke_title, sum(ratings.rating)/count(ratings.rating) as average
        from jokedata inner join ratings
        on ratings.content_type = 'joke' and ratings.relative_id = jokedata.id
        WHERE jokecategory = '$cur_category'
        group by jokedata.id
        order by average desc
        limit $offset, $jokes_per_page
        ");

        $cell = 1;
        while ($row = mysql_fetch_array($result)) {
            if ($cell == 5) {
                echo "</tr><tr class=\"rowpadding\"><td></td></tr><tr>";
                $cell = 1;
            }
            $joke_id = $row['joke_id'];
            $joke_title = $row['joke_title'];
            $joke_average = round($row['average'], 2);

            echo "<td><strong><a class=\"joke_a\" href=\"viewjoke.php?id=$joke_id\">$joke_title</a></strong> -average rating $joke_average.</td>";
            $cell++;
        }
    ?>
    </tr>
    <tr class="rowpadding"><td></td></tr>
</table> 
```

它工作得很好，但有一个问题——如果一个项目没有至少一个评级，它根本不会被查询选中！

我该如何补救？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T16:04:18.283

我会推荐以下内容：

*   用于`left outer join`获取没有评分的笑话
*   使用`avg()`而不是手动计算平均值
*   可能用于`coalesce()`避免`null`结果中的值

这是您的表格的简化版本：

```
create table joke(jokeid int primary key, jokedata varchar(50));
create table ratings(rating int, relative_id int);
insert into joke values(1, "killing");
insert into joke values(2, "no rating");
insert into ratings values(5, 1);
insert into ratings values(10, 1); 
```

还有一些示例查询：

```
select joke.jokeid, avg(ratings.rating) as average 
   from joke 
   left outer join ratings 
     on ratings.relative_id = joke.jokeid 
   group by joke.jokeid;
+--------+---------+
| jokeid | average |
+--------+---------+
|      1 |  7.5000 | 
|      2 |    NULL | 
+--------+---------+ 
```

或者，使用`coalesce()`：

```
select joke.jokeid, avg(coalesce(ratings.rating, 0)) as average 
  from joke 
  left outer join ratings 
    on ratings.relative_id = joke.jokeid 
  group by joke.jokeid;
+--------+---------+
| jokeid | average |
+--------+---------+
|      1 |  7.5000 | 
|      2 |  0.0000 | 
+--------+---------+ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T08:45:01.980

尝试这个：

```
SELECT  jokedata.id as joke_id,
        jokedata.datesubmitted as datesubmitted,
        jokedata.joketitle as joke_title,
        COALESCE(
        (
        SELECT  AVG(rating)
        FROM    ratings
        WHERE   ratings.relative_id = jokedata.id
                AND ratings.content_type = 'joke'
        ), 0) AS average
FROM    jokedata
ORDER BY
        average DESC
LIMIE   $offset, $jokes_per_page 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T11:20:56.250

您需要使用左连接而不是内连接，然后处理 rating.ratings 为空的情况：

```
$result = mysql_query("
            SELECT jokedata.id AS joke_id, 
            jokedata.datesubmitted AS datesubmitted,
            jokedata.joketitle AS joke_title, 
            -- average is 0 if count or sum is null
            IFNULL(SUM(ratings.rating)/COUNT(ratings.rating), 0) AS average
            FROM jokedata 
            -- return all rows from left table (jokedata), and all nulls for ratings
            -- data when there is no matching row in the right table (ratings)
            LEFT JOIN ratings ON ratings.content_type = 'joke' AND jokedata.id = ratings.relative_id 
            WHERE jokecategory = '$cur_category'
            GROUP BY jokedata.id
            ORDER BY average desc
            LIMIT $offset, $jokes_per_page
            "); 
```

左连接将返回所有来自 jokedata 的结果，并且将只返回所有不满足连接条件的行的评级的空值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T03:57:45.570

在我看来，使用平均值有点不公平。如果笑话 A 有 1 个评分为 5，笑话 B 有 25 个评分为 4，则笑话 A 的排名将高于笑话 B。它使不受欢迎的笑话更有优势，排名更高。

我建议将权重与评级相关联，然后按权重排名。例如，在 1 到 5 的范围内，1 会得到 -2，2 会得到 -.5，3 会得到 0，4 会得到 +.5，5 会得到 +2。因此，这将允许具有 5 个“4”评级的笑话排名高于具有 1 个“5”评级的笑话。

-2 到 +2 的比例可能需要一些调整，但希望你能明白我的意思。

# java - EL 中的方法调用

> ID：692615
> 
> 赞同：5
> 
> 时间：2009-03-28T11:13:14.740
> 
> 标签：java, jsp, jstl

当我编写 Java webapps 时，我通常使用 JSTL 标签。我认为这些标签很棒，除了让我生气的一件事：虽然表达式语言允许您访问 bean 属性，但它不允许您调用它的方法。

在 1.0 版中，甚至无法获取字符串的长度或集合中的元素数量。从 1.1 版开始，添加了 fn:length 函数，因此您可以执行以下操作：

```
...
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
...
<c:if test="${fn:length(str) > 10}">
    ...
</c:if>
... 
```

哪个比以下更冗长和丑陋（恕我直言）：

```
...
<c:if test="${str.length() > 10}">
    ...
</c:if>
... 
```

JSTL 2.0 似乎允许您定义新函数，但您需要专门为此目的编写一个类，在其中定义您的（静态）方法，并且您还需要编写一个 TLD 文件，该文件将包含在将使用这些功能的每个 jsp 中。

无论您是定义自定义函数还是使用其他解决方法，您都需要编写大量额外的代码。

我在某处读到 JCP 自愿禁止从表达式语言调用方法。

你们中的任何人都可以帮我理解为什么JCP要对我们这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T23:30:15.140

> 你们中的任何人都可以帮我理解为什么JCP要对我们这样做吗？

这是某些 Java 程序员子集的[束缚和纪律](http://www.catb.org/~esr/jargon/html/B/bondage-and-discipline-language.html)心态的一部分，他们知道每个人都应该编写应用程序的唯一正确方法。

在编写模板时，你不能相信你有一个功能强大的语言供你使用，因为你可能会滥用它来混合业务逻辑和表示，就像那些糟糕、粗俗的 PHP 编码人员所做的那样。呃，想象一下！

程序员是敌人，必须防止做恶。事实证明，程序员实际上只是您尝试调试某些东西，或者快速破解以使应用程序暂时运行。或者可能会证明存在表示逻辑之类的东西，并且让您将这些东西移到应用程序中的一堆标记和 bean 类中，这与相反的方式一样令人不快。

不过没关系！为维护 Java 的纯洁性而服务，给您带来不便是非常值得的。

[对不起，这已经是一个很无聊的问题了。嗯。]

PS。我想总是有 Groovy 的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T14:24:19.787

您想要的功能在[JSR 245](http://jcp.org/en/jsr/detail?id=245)中定义（[更多信息在这里](http://blogs.oracle.com/kchung/entry/jsr_245_mr_part_i)）。如果您现在需要它，请从[UEL 项目](https://uel.dev.java.net/)或替代实现（例如[JUEL](http://juel.sourceforge.net/)）下载它。如果您需要等待它成为标准的一部分，它将包含在 JEE6 中。在那之前……好吧，你已经知道你的选择了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T12:39:20.687

看看[缝](http://seamframework.org/)！有了 Seam，EL 就成为了它应有的样子。即使使用参数调用方法也很容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T12:19:29.433

我希望目标是强制执行严格的模型视图分离，就像在[StringTemplate](http://www.antlr.org/wiki/display/ST/Introduction#Introduction-MotivationAndPhilosophy)中一样。

这个想法非常简单：如果您无法访问方法，那么您将被迫在控制器中计算所有数据，然后在视图中对其进行格式化。当然，他们通过允许您访问函数来混淆消息，并且他们没有得到帮助，因为在 Java 中建立元组映射列表（阅读：没有类的结构化数据）并不像在Python、Ruby 等

无论如何，这是一篇关于编写允许您调用[任意方法](http://www.javaworld.com/javaworld/jw-05-2003/jw-0523-calltag.html)的标签的文章，可能会有所帮助。

# vb.net - 在 vb.net 中搜索数组

> ID：692617
> 
> 赞同：-1
> 
> 时间：2009-03-28T11:13:51.883
> 
> 标签：vb.net

嗨，我用数组代码搜索 index = Array.IndexOf(_arrayName, "Text")。我给出了完整的字这工作正常。但给一些性格这是行不通的。例如

```
dim arr() as string ={"ravi","somu","arul"} 
```

在这里，我给“somu”该代码返回 1。但我给“so”该代码返回 -1。但我想要喜欢搜索。这是否可以通过。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T11:24:09.987

`IndexOf`搜索完全匹配。要自定义匹配条件，可以使用以下`FindIndex`方法：

```
// Finds first element of the array that contains `inputString`
Array.FindIndex(arr, Function(s) s.Contains(inputString))

// Finds first element of the array that begins with `inputString`
Array.FindIndex(arr, Function(s) s.StartsWith(inputString)) 
```

**编辑以澄清`Function(s)`和 lambdas：**

`Array.FindIndex`接受两个参数，第一个是您要处理的数组，后者是`Delegate`表示要检查的谓词。

`FindIndex`不知道你想要什么样的元素。它使您可以灵活地指定它。你可以通过传入一个函数来告诉它，该函数接受一个数组元素并返回一个布尔值，指示你是否想要它。它本质上用数组的每个元素调用该函数，并返回该函数返回 true 的第一个元素的索引。

无需编写整个函数并使用 传递它`AddressOf MyPredicate`，我们可以轻松地使用`Function(s) s.Contains(inputString)`. 它相当于：

```
Function MyPredicate(s As String) As Boolean
    Return s.Contains(inputString)
End Function

Array.FindIndex(arr, AddressOf MyPredicate) 
```

当然，如果我们这样做，我们必须存储`inputString`该方法可访问的某个地方。这是很多脏代码。一个 lambda 表达式减少了所有这些麻烦。

**编辑2：**

我可以验证此代码打印“1”：

```
Module Module1
    Sub Main()
        Dim arr() As String = {"ravi", "somu", "arul"}
        Console.WriteLine(Array.FindIndex(arr, Function(s) s.Contains("so")))
    End Sub
End Module 
```

# .net - 网络浏览器控制窃取快捷方式

> ID：692620
> 
> 赞同：5
> 
> 时间：2009-03-28T11:16:45.620
> 
> 标签：.net, winforms, webbrowser-control, shortcut

我的 .NET Windows 窗体应用程序中的 Web 浏览器控件在获得焦点时会窃取快捷方式。为了能够使用，`Alt + F4`我必须先单击一个控件。

目前“ `WebbrowserShortcuts = false`”，但它仍然是一样的。

有没有办法阻止这种恼人的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-19T17:16:53.693

我在 winforms WebBrowser 中加载 Silverlight 时遇到了这个问题，我通过在`<body>`元素中添加以下内容来解决它：

```
onload="document.getElementById('silverlightControl').focus()" 
```

...当然，这意味着我必须给`silverlightControl`我的`<object>`元素一个 id ：

```
<object id="silverlightControl" data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="100%"> 
```

如果您只有 HTML，也许您可​​以调用`focus()`第`document`一个超链接或第一个超链接？

# ssis - SSIS - 您可以使用参数化查询来填充查找转换吗？

> ID：692623
> 
> 赞同：1
> 
> 时间：2009-03-28T11:17:55.353
> 
> 标签：ssis

我正在使用存储过程来填充查找转换，但想限制查找缓存的大小。

我可以通过向存储过程提供一个参数来做到这一点，但是我看不到任何参数化查找转换组件上的查询的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T20:03:51.110

如果您使用的是 SQL Server 2008，那么您可以使用新的缓存转换。它可以从 OLE DB 源中填充（当然，您可以对其进行参数化），并且可以将其行保存在内存中以供一个或多个查找转换使用，或者可以将缓存的行保存在文件中，它们可以被几个不同的查找转换使用，即使在不同的包中。

请参阅[如何：在完全缓存模式下实现查找转换（SQL Server 视频）](http://msdn.microsoft.com/en-us/library/cc952929.aspx#)。它只有九分钟，但显示了要领。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-23T12:27:45.150

您可以使用 Lookup Transformation 属性的**Advanced**页面来**修改 SQL 语句**。这允许使用参数。但是您需要将缓存模式更改为部分或无缓存，否则无法更改语句。

# entity-framework - 实体框架和外键

> ID：692631
> 
> 赞同：0
> 
> 时间：2009-03-28T11:23:36.727
> 
> 标签：entity-framework, foreign-keys, entity

我有两个表，一个包含汽车不同属性的汽车表，另一个`carmodeldefinition`是同名表的外键。该`cardefinition`表包含不同的汽车和型号。我已将它们映射到实体框架中。

![图片](https://i.stack.imgur.com/fFWUY.jpg)

当我尝试在其中添加一辆新车`carmodeldefinition`时，只需添加一辆新车`cardefinition`，而不仅仅是使用它找到的那辆。它的代码可以在下面找到：

```
 DataLayer.Car car = new DataLayer.Car();
   car.URL = carBulk.URL;
   car.SellerCity = carBulk.SellerCity.ToString();
   car.Color = carBulk.Color.ToString();
   car.SellerStreet = carBulk.SellerStreet;
   car.SellerName = carBulk.SellerName;
   car.SellerCountry = carBulk.SellerCountry.ToString();
   if (cdDTO != null && cdDTO.CarDefinitionId > 0)
   {
       car.CarModelDefinition = cdDTO.Transform(cdDTO);
   }

   mee.AddToCar(car);
   mee.SaveChanges(); 
```

将`cdDTO.Transform(cdDTO)`转换为`datatransferobject`可以映射到数据库的对象。奇怪的是它`cdDTO.Transform(cdDTO);`返回正确的对象和正确的对象`cardefintionId`，但是当它被插入时，它只是用一个新的`cardefinitionid`（即pk）插入底部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T20:13:59.200

我找到了答案。尽管我很愚蠢，但我将关系设置为 1-1 而不是 1-many。

# c# - 在 WPF 中动态更改旋转动画

> ID：692634
> 
> 赞同：10
> 
> 时间：2009-03-28T11:24:54.337
> 
> 标签：c#, wpf, xaml, animation, transform

我正在使用 DoubleAnimation 对 RotationTransform 的 Angle 属性进行动画处理。每秒几次，我需要更改旋转速率以响应外部数据，以便随着时间的推移旋转加快和/或减慢（平稳）。我目前正在通过使用从 0.0 到 360.0 以持续时间 X 永远重复的 DoubleAnimation 来执行此操作，然后每秒重复几次：

*   从外部数据中获取新价值
*   将 DoubleAnimation 上的速率修改为该值
*   再次将 DoubleAnimation 重新应用到 Angle 属性

注意：我确实发现我必须将动画上的 To 和 From 属性更改为“当前角度”和“当前角度+360”——幸运的是，RotationTransform 在角度 > 360 度时没有问题——以防止开始旋转再次从零角度。

我的问题是：这合理吗？似乎并非如此。不断地将新的 DoubleAnimations 应用于旋转变换的 Angle 属性似乎是错误的 - 有点像我让 WPF 为旋转设置动画，而*我*自己在为旋转速度设置动画。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T15:08:18.217

在故事板上有一个 SpeedRatio 设置，它是持续时间的乘数。但是，您不能绑定到它，因为它不是依赖属性。

要解决这个问题，您可以使用情节提要上的 SetSpeedRatio 函数。请注意，这仅在故事板以代码启动时才有效（否则您会收到错误）。

下面的代码是如何在对象中引发事件以影响旋转矩形动画速度的完整示例。文本框和数据绑定的目的是更新背景对象。该按钮只是使文本框失去焦点并更新对象。

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
      <Rectangle Margin="50" Width="50" Height="50" Fill="Red" x:Name="rc">
        <Rectangle.RenderTransform>
          <RotateTransform x:Name="TransRotate"
                           CenterX="25" CenterY="25" Angle="0" />
        </Rectangle.RenderTransform>
        <Rectangle.Resources>
          <Storyboard x:Key="spin">
            <DoubleAnimation x:Name="da" 
                             Storyboard.TargetName="TransRotate" 
                             Storyboard.TargetProperty="Angle"
                             By="360" 
                             Duration="0:0:10"  
                             AutoReverse="False" 
                             RepeatBehavior="Forever" />
          </Storyboard>
        </Rectangle.Resources>
      </Rectangle>
      <TextBox Text="{Binding Speed}" />
      <Button>Update Speed</Button>
    </StackPanel>
</Window> 
```

然后是C#代码

```
{
    public Window1()
    {
        InitializeComponent();

        //create new  object
        BackgroundObject bo = new BackgroundObject();

        //binding only needed for the text box to change speed value
        this.DataContext = bo;

        //Hook up event
        bo.SpeedChanged += bo_SpeedChanged;

        //Needed to prevent an error
        Storyboard sb = (Storyboard)rc.FindResource("spin");
        sb.Begin(); 
    }

    //Change Speed
    public void bo_SpeedChanged(  object sender, int newSpeed)
    {
        Storyboard sb = (Storyboard)rc.FindResource("spin");
        sb.SetSpeedRatio(newSpeed);
    }
}

public delegate void SpeedChangedEventHandler(object sender, int newSpeed);

public class BackgroundObject
{
    public BackgroundObject()
    {
        _speed = 10;
    }

    public event SpeedChangedEventHandler SpeedChanged;

    private int _speed;
    public int Speed
    { 
        get { return _speed; }
        set { _speed = value; SpeedChanged(this,value); }
    }
} 
```

我相信你可以适应你的使用。

# iphone - 从另一个 UIView 访问 UIView 的成员变量

> ID：692635
> 
> 赞同：0
> 
> 时间：2009-03-28T11:27:26.657
> 
> 标签：iphone, objective-c

我在 iphone 上有三种不同的观点。我成功地在不同的视图之间切换，但我想在第二个视图的 ViewDidLoad 方法中访问第一个视图的变量，但我无法得到它，所以请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T12:25:28.950

有两个 UIView 子类声明如下：

```
@interface ViewOne : UIView {
    NSString *someVar;
}

@property (nonatomic, copy) NSString *someVar;

@end

@interface ViewTwo : UIView {
    NSString *referenceToSomeVar;
}

@property (nonatomic, retain) NSString *referenceToSomeVar;

@end 
```

您可以执行以下操作，参考第一个视图中的“someVar”变量

```
ViewOne *view1 = [[ViewOne alloc] init];
view1.someVar = @"This is the original variable";

ViewOne *view2 = [[ViewOne alloc] init];
view2.referenceToSomeVar = view1.someVar; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T11:30:57.303

您需要在第二个视图上引用第一个视图。因此，当您实例化第二个视图时，请实现一条消息，该消息将接收第一个视图并存储对它的引用。

让我指出，最好使用**ViewController**模式来编排从一个视图流向另一个视图的数据和行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-07T09:51:21.463

我想在上面发布的代码中添加一些内容。想象一下，您想使用 ViewOne 中的变量并将其分配给 ViewTwo 中的第二个变量。

```
@interface ViewOne : UIView {
BOO someVar;
}

@property (readwrite) someVar;

@end

@interface ViewTwo : UIView {
BOO referenceToSomeVar;
}

@property (readwrite) BOO referenceToSomeVar;

@end 
```

所以你必须放入 ViewOne .m

```
 ViewOne *view1 = [[ViewOne alloc] init];
 view1.someVar = TRUE; 
```

在 SecondView .m

```
 referenceToSomeVar = view1.someVar; 
```

# c - 即使没有传递指针，线程中的所有函数都可以访问动态分配的内存（堆），还是它是函数的本地函数？

> ID：692636
> 
> 赞同：1
> 
> 时间：2009-03-28T11:27:44.220
> 
> 标签：c, memory-management, dynamic, heap-memory

我有一个非常基本的问题，需要帮助。我试图了解动态分配的内存（在堆上）的范围是什么。

```
#include <stdio.h>
#include <malloc.h>

//-----Struct def-------
struct node {
        int x;
        int y;
};

//------GLOBAL DATA------

//-----FUNC DEFINITION----
void funct(){
  t->x = 5; //**can I access 't' allocated on heap in main over here ?**
  t->y = 6; //**can I access 't' allocated on heap in main over here ?**
  printf ("int x = %d\n", t->x);
  printf ("int y = %d\n", t->y);
  return;
}

//-----MAIN FUNCTION------
int main(void){
      struct node * t = NULL;// and what difference will it make if I define 
                                 //it outside main() instead- as a global pointer variable
          t = (struct node *) malloc (sizeof(struct node));
      t->x = 7;
      t->y = 12;
      printf ("int x = %d\n", t->x);
      printf ("int y = %d\n", t->y);

    funct(); // FUNCTION CALLED**
    return 0;
} 
```

`t`在这里，`funct()`即使在`main()`没有传递参数（指向的指针`t`）的情况下分配了内存，我也可以访问结构`function funct`吗？因为堆对于线程来说是公用的？如果我`struct node * t = NULL`在外部定义`main()`为全局变量会有什么不同并且它有什么问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T11:40:35.360

当您使用 malloc() 时，可以在代码中的任何位置访问由它返回的内存，假设您可以看到具有 malloc() 返回的指针的变量。

所以在你的代码中，如果 t 是全局的，它将在 main 和 funct() 中可见，是的，你可以在两者中使用它。

事实上，正如前面的答案所提到的，funct() 不知道 t 是什么，因为 t 的声明和定义在 main 中；t 超出功能范围。*如果*funct 知道 t 是什么，您分配给 t 的内存*将*可以在 funct 中使用。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T11:36:53.217

不，您将无法像那样访问 t ，因为即使在 main 中您使 t 指向堆上可全局访问的东西，变量 t 本身也是 main 本地的指针（并且位于堆栈上）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T11:36:58.130

要访问一个变量，函数需要知道这个变量的地址——“t”指针的值。所以你必须将它传递给函数，否则函数将无法知道要访问什么。

您也可以声明一个全局变量 pinter "t" 并从任何函数中使用它，但再次显式地使用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T11:37:35.213

分配的内存可以访问，但这不是你的问题。变量 't'仅在*main中**可见*，因为那是您声明它的地方。这是您需要了解的两个不同概念。数据的存储与引用它的变量不同。

 ** * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T11:36:21.097

在您的代码中，'t' 是 main() 的局部变量 - 它不能从其他任何地方访问。这与线程无关。请更正您的代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T11:40:17.810

不，您需要将 t 设为全局，或将指针传递给 funct()，我建议您执行第二个。现在， t 仅在 main() 的范围内。

如果您计划让多个线程同时在 t 上运行，您也可以考虑在结构中添加一个互斥锁。如果你这样做，还要考虑 mlock() 以确保结构不会被分页，否则锁会变慢。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T11:45:10.980

只需更改您的函数以接受指向该内存的指针。

```
/* changing the variable name to make it clear that p is scoped to funct() */
/* when it's passed, just as t is local to main() */
void funct(struct node *p){
p->x = 5;
p->y = 6;
printf ("int x = %d\n", p->x);
printf ("int y = %d\n", p->y);
return;
} 
```

...

```
funct(t);

/* now free the memory you allocated */
free(t);
return 0; 
```

这是在堆上分配内存的重点——自动（堆栈）变量仅限于您在其中声明它们的块的范围。堆内存在任何地方都可用-您只需要传递一个指针，以便其他函数知道在哪里找到您存储的内容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-28T11:59:01.603

接受的答案有点误导。

> 当您使用 malloc() 时，可以在代码中的任何位置访问由它返回的内存，假设您可以看到具有 malloc() 返回的指针的变量。

这同样适用于在 C 或 C++ 中分配的任何内存，无论是堆、堆栈还是静态。只需将 & 放在局部变量的前面，您现在就拥有了允许程序的任何其他部分获取该变量的存储空间的密钥，并像他们可以看到变量名本身一样有效地使用它。

局部变量名称仅在它们声明的范围内可见，但它们的存储可以从任何地方、任何线程中访问，假设地址已被获取并传递。

在 C/C++ 中获取局部变量的地址是危险的，但经常是必要的，因此不幸的是，如果不理解这一点，就不可能有效地使用这些语言。

**更新**

@kevinf 说：

> 在本地范围内使用本地地址很好，但您的建议不是内存安全的

区分*范围*和*生命周期*很重要。范围是指标识符（例如变量名），它是代码中可以提及标识符的一组位置。这是一个编译时的概念。

这是与内存安全或存储位置中对象的生命周期不同的概念。这是一个运行时概念。例如：

```
void g(int *p)
{
    (*p)++;
}

void f()
{
    int n = 1;
    g(&n);
} 
```

此处，标识符`n`仅在`f`. 它命名运行时存在的存储位置`f`。我们获取该`&n`存储位置的地址并将其传递给`g`. 注意`g`不能`n`直接使用名称。`n`不在此范围内！*然而，存储位置在此示例*中完全可用，因为`f`仍未完成（等待`g`完成）。

大多数真正的 C 和 C++ 程序经常这样做，而且标准允许这样做。它既不是一般安全的，也不是一般不安全的。它有时是安全的，有时不是。这是 C 和 C++ 的核心挑战。未定义的行为并不总是可以从函数的本地检查中检测到；你必须知道它是如何在更广泛的背景下使用的。

最近对该语言的更改（在 g++ 中使用`-std=c++14`选项来编译它）引入了探索这个灰色区域的其他方法：

```
auto f()
{
    int n = 1;

    auto g = [&] 
    { 
        ++n; 
        cout << "Incremented to " << n << endl;
    };

    g();

    return g;
}

void h()
{
    auto g = f();

    cout << "Returned into h" << endl;

    g();
} 
```

内`f`，`n`在范围内。并`g`拥有一个 lambda 实例，其主体也是`n`. 对`g`inside的调用`f`非常好。但是`f`当我们将 lambda 存储在另一个名为 的变量中时`g`，不允许对其进行后续调用！我们在没有使用过的情况下`&n`，隐式捕获了一个我们不再可用的存储位置，因为它的生命周期仅限于我们调用`f`.

顺便说一句，当我说不允许时，它会编译。但在我的系统上它打印：

```
Incremented to 2
Returned into h
Incremented to 167772162 
```

这清楚地表明了未定义的行为。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-29T07:44:23.377

因为 t 是指向函数 main 中定义的结构的指针。您无法在funct() 中访问它。将 t 设为全局，以便可以在 funct() 中访问它或将指针作为参数传递给 funct()。使其全球化并不是最佳选择。在多线程环境中，多个线程可能会尝试访问它，因此您需要有某种锁定机制来避免同时访问。添加锁定它的功能可能会导致其他开销，因此最好的选择应该是将其作为参数传递。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-08T08:27:36.560

t 是 main() 的本地指针变量，但 't' 中的内容存在于整个程序中，直到/除非我们明确释放它。 t 持有的地址的生命周期在整个程序中动态分配在堆中。所以你可以在程序中的任何地方使用该内存地址，但不能使用变量局部变量't'。由于 t 是一个局部变量，它只有那个块范围，只能在 main 中使用()>因此，使用 t 及其内容的最佳方式是声明 t，然后在全局范围内动态分配内存。

In short variable 't' is local but the value in 't' is in heap.Only way to acess the heap memory is via 't'.So declare t in the global space,so we can acess the heap memory anywhere in the program via 't' .Else how you will acess the heap memory,when t goes out of scope

# jquery - 执行 jquery ajax 发布时如何从我的 asp.net mvc 控制器返回错误？

> ID：692640
> 
> 赞同：1
> 
> 时间：2009-03-28T11:35:04.283
> 
> 标签：jquery, asp.net-mvc, validation

我正在用 ASP.NET MVC 创建一个网站，但偶然发现了一些我真的无法弄清楚的东西。

我有一个用户个人资料页面，允许用户更改他的密码。在服务器端，我想在允许更改之前验证用户是否输入了正确的“当前”密码。

当密码不正确时，返回我的视图的最佳方式是什么？我尝试使用 ModelState.AddModelError 然后返回 Json(View()) 但我在返回给浏览器的 JSON 对象中的任何地方都看不到错误消息。

在客户端使用 jquery 的最佳方法是什么？

/杰斯珀

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T11:44:37.240

我会创建类

```
JsonOK : JsonResult { ... }
JsonError : JsonResult { ... } 
```

并将这 2 个用于 OK 和 Error 响应。

```
try
{
    ...
}
catch (Exception ex)
{
    return JsonError(ex.Message);
    // or output your own message
    // or pass into it ModelState with your errors
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T11:36:38.193

ModelState 不会自动对返回的`Json`. 您应该使用要返回给客户端的数据手动填充模型对象。

或者，如果您想向客户端报告*错误*，您可以在控制器操作方法中抛出异常并在 jQuery 中处理它。

# powershell - PowerShell“Advance”解析以根据日志文件计算组件安装时间

> ID：692664
> 
> 赞同：1
> 
> 时间：2009-03-28T11:57:14.883
> 
> 标签：powershell, scripting

我有一个创建以下格式的日志文件的应用程序：

```
2009-03-27 15:30:50 Start
2009-03-27 15:30:51 Starting Component 1 Installation
2009-03-27 15:30:52 blah
2009-03-27 15:30:53 blah
2009-03-27 15:30:54 blah
2009-03-27 15:30:55 ~~~ Finished Component 1 Installation ~~~
2009-03-27 15:30:56 Starting Component 2 Installation
2009-03-27 15:30:57 blah
2009-03-27 15:30:58 blah
2009-03-27 15:30:59 blah
2009-03-27 15:30:60 ~~~ Finished Component 2 Installation ~~~
2009-03-27 15:30:61 Starting Component 3 Installation
2009-03-27 15:30:62 blah
2009-03-27 15:30:63 blah
2009-03-27 15:30:64 blah
2009-03-27 15:30:65 ~~~ Finished Component 3 Installation ~~~
2009-03-27 15:30:66 Finished 
```

我想你明白格式的重点。

我想要实现的是拥有一个 powershell 脚本，它将返回一个结果表

1.  组件名称
2.  开始时间
3.  时间结束
4.  花的时间

我称它为“高级”脚本，因为它可能包括：解析、格式化、创建新对象等

*   我是powershell的新手

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T12:33:07.433

以下脚本可能会为您执行此操作...**如果**您采用合理的时间值...一分钟内超过 60 秒是很奇怪的（并且在这里给了我一些例外情况，这些例外情况会导致日期/时间解析的严重头痛，直到我注意到为什么抛出异常......）

```
$logfile = $args[0]

$log = get-content $logfile

$Components = @()

switch -regex ($log) {
    "(.*) Starting (.*) Installation" {
        $c = New-Object PSObject
        $st = [DateTime]::ParseExact($Matches[1], "yyyy'-'MM'-'dd HH':'mm':'ss", $null)
        $c | Add-Member -Type NoteProperty -Name Component -Value $Matches[2]
        $c | Add-Member -Type NoteProperty -Name StartTime -Value $st
    }
    "(.*) ~~~ Finished" {
        $et = [DateTime]::ParseExact($Matches[1], "yyyy'-'MM'-'dd HH':'mm':'ss", $null)
        $c | Add-Member -Type NoteProperty -Name EndTime -Value $et
        $c | Add-Member -Type NoteProperty -Name TimeTaken -Value ($c.EndTime - $c.StartTime)
        $Components += $c
    }
}

$Components 
```

我可以使用以下代码将执行时间缩短一点（大约 25%）：

```
$logfile = $args[0]

foreach ($l in Get-Content $logfile) {
    if ($l.Length -ge 30) {
        if ($l.Substring(20,8) -eq "Starting") {
            $c = New-Object PSObject
            $st = [DateTime]::ParseExact($l.Substring(0,19), "yyyy'-'MM'-'dd HH':'mm':'ss", $null)
            $c | Add-Member -Type NoteProperty -Name Component -Value $l.Substring(29, $l.Length - 42)
            $c | Add-Member -Type NoteProperty -Name StartTime -Value $st
        } elseif ($l.Substring(24,8) -eq "Finished") {
            $et = [DateTime]::ParseExact($l.Substring(0,19), "yyyy'-'MM'-'dd HH':'mm':'ss", $null)
            $c | Add-Member -Type NoteProperty -Name EndTime -Value $et
            $c | Add-Member -Type NoteProperty -Name TimeTaken -Value ($c.EndTime - $c.StartTime)
            $c
        }
    }
} 
```

但我发现它比第一个解决方案更不可读（更不用说可维护性了）。这与日志文件的布局有非常严格的联系。

# linux - 如何使用 nagios 或 munin 从外部应用程序/服务器中查询统计信息

> ID：692669
> 
> 赞同：1
> 
> 时间：2009-03-28T12:01:18.883
> 
> 标签：linux, api, monitoring

我有几台 linux (ubuntu) 服务器，它们每晚都一起工作以进行繁重的处理。说。我有 2 台工作服务器和 1 台大型索引服务器。工作服务器为索引服务器提供数据。索引服务器在高负载下运行（基于它从工作服务器获得的输入。）

我希望能够让工作服务器根据索引服务器的负载以一定速度工作，以确保最大吞吐量。我知道吞吐量会受到其他因素的影响，但索引服务器本质上是受 cpu 限制的，粗略的指导（据我所知）是确保测量的负载大致等于索引服务器中实际处理器的 nr。

为此，我需要在工作服务器上运行的工作应用程序中定期查询索引服务器的负载（10 秒？、1 分钟、5 分钟等）。

现在，无论如何，在不久的将来我都需要像 Nagious 或 Munin 这样的监控解决方案，所以想知道如何使用其中一个或另一个从应用程序中查询统计信息？

谢谢，布里茨克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T12:14:42.580

如果您的需求是基本的，您可以考虑只使用 SNMP。大多数 Linux 发行版都有 snmp-devel、php-snmp（或几乎所有其他语言）API 来轻松解析数据。

我曾经遇到的一个陷阱是，负载过重的服务器有时网络 I/O 很慢，因此获取远程机器信息的 API 调用可能会阻塞，直到发生超时。您可能会考虑将一个子线程/线程专门用于监视其他线程的任务。

另一种选择是在每台服务器 curl()ing （或其他方法）上放置一些东西，将其重要信息放到其他人可以读取的某个位置。因为听起来您最需要 /proc/loadavg 和 /proc/meminfo 的内容，所以这可能会更好。

# php - 为什么我的评论 会导致我的代码在 PHP 中奇怪地显示在浏览器中？

> ID：692671
> 
> 赞同：2
> 
> 时间：2009-03-28T12:03:28.910
> 
> 标签：php, comments

从什么时候开始：

```
//echo "[$sql][$result][$rows][$e]<BR>"; 
```

导致错误？此评论后面的代码在浏览器中作为源代码被喷出！请记住，我每天都使用 php，我以前从未见过这个！我正在将一个古老的 php 应用程序从一个旧的 Win2k 机器移植到一个新的 Windoze 2003 服务器 - apache 2.2、mysql 5.1.32、php 5.2.9，并且该应用程序正在到处轰炸，因为到处都是注释掉的代码。有什么开关可以阻止它对评论如此敏感吗？我知道`//`然后`?>`代码会在`?>`终止 php 时中断，但是 BR 标签？肯定不是。

更多细节：代码块是

```
if ($condition){
  // do stuff
} else {
  $sql="select * from person where percode='$person'";
  $result=mysql_db_query($db,$sql,$conn);
  @$rows=mysql_num_rows($result);
  $e=mysql_errno()." ".mysql_error();
  //echo "[$sql][$result][$rows][$e]<br>";
  $perfname=mysql_result($result,0,"perfname");
  $persname=mysql_result($result,0,"persname");
  $peraddr1=mysql_result($result,0,"peraddr1");
}
?> 
```

注释之前的代码运行良好。注释到 ?> 之后的代码被吐到浏览器中。之后，HTML 显示就很好了。删除注释（甚至只是 BR 周围的 < 和 > 也可以使代码正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T12:15:50.563

您可以在要移动到的新服务器的 php.ini 文件中关闭[短打开标记设置。](http://au2.php.net/ini.core)如果关闭此设置，您的所有`<?`标签都将被忽略，并且只有完整之间的代码

`<?php`并且`?>`标签被解析为 PHP 代码。查看该设置是否已关闭，如果打开它可以修复它。

如果没有，请检查您是否在`'?>`评论之前错误地做任何事情。此外，共享完整的代码块也会有所帮助。

# java - AtomicIntegerArray 与 AtomicInteger[]

> ID：692677
> 
> 赞同：16
> 
> 时间：2009-03-28T12:13:57.403
> 
> 标签：java, concurrency, atomic-values

`AtomicIntegerArray`和的含义有什么不同`AtomicInteger[]`吗？哪一个使用起来更快？（我唯一注意到的是，首先占用的空间要少得多，但这意味着每次重新检查都在检查数组的边界，这样会使其变慢吗？）

编辑：在数组预先初始化的情况下。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T12:19:41.913

`AtomicInteger[]`每个元素都需要一个对象。`AtomicIntegerArray`只需要`AtomicIntegerArray`对象和数组对象。因此，如果可能，请使用后者。

即使对于普通数组，边界检查的成本也很小。可能重要的是，从多个处理器访问同一高速缓存行中的数据可能会导致严重的性能问题。因此，单独的对象或故意避免数组中的紧密元素会有所帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-28T14:23:10.617

*   AtomicInteger[] 是一个线程安全整数数组。
*   AtomicIntegerArray 是一个线程安全的整数数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T16:39:29.823

下面，AtomicInteger 和 AtomicIntegerArray 通常使用相同的低级 API 来执行读取、写入和其他 CAS 操作。（例如，OpenSDK 7 使用`sun.misc.Unsafe`在这两个类中执行 CAS 操作。）因此使用 AtomicInteger[] 几乎没有性能优势。正如您已经注意到的，使用 AtomicIntegerArray*确实*具有显着的内存优势。

实际上，使用后者也使您不必构建所有 AtomicInteger 实例。请记住，由于并发原因，您不能天真地懒惰地分配它们；您将不得不预先分配或使用一些安全的发布机制。因此，除了内存优势之外，您的代码也更干净。

同样，如果您有一堆具有 AtomicInteger 成员的对象，例如：

```
class ReadCounter {
  private final String _fileName;
  private final AtomicInteger _readCount;
  ...
}

private final Map<String, ReadCounter> _counterByName = ...; 
```

`_readCount`然后，您可以通过将成员变量建模为 a`volatile int`并使用来实现类似的内存改进[`AtomicIntegerFieldUpdater`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/atomic/AtomicIntegerFieldUpdater.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T13:42:28.047

我同意[Tom Hawtin 的第一段](https://stackoverflow.com/a/692687/7769052)……</p>

> `AtomicInteger[]`每个元素都需要一个对象。`AtomicIntegerArray`只需要`AtomicIntegerArray`对象和数组对象。因此，如果可能，请使用后者。

…但也应该注意这`AtomicInteger[]`不是线程安全的。`AtomicInteger`具体来说，如果从多个线程访问，数组对单个对象的引用可能正确，也可能不正确。不过，同步对数组对象本身的访问将消除此问题。

# iphone - iphone：事件问题

> ID：692690
> 
> 赞同：0
> 
> 时间：2009-03-28T12:22:11.250
> 
> 标签：iphone, objective-c

# 主视图控制器.h

```
@class EventViewController;
@class MainViewController;

@interface MainViewController : UIViewController {
    EventViewController *eventViewController;
    MainViewController *mainViewController;
    //extern int i;
@public
    NSString *titlegame;
}

@property (retain,nonatomic) EventViewController *eventViewController;
@property (retain,nonatomic) MainViewController *mainViewController;
@property (retain,nonatomic)IBOutlet NSString *titlegame;

@end 
```

# 主视图控制器.m

```
-(IBAction)buttonClick:(id)sender{
    titlegame = [sender titleForState: UIControlStateNormal];
    UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"You selecet!!!!"
                                                   message:titlegame
                                                  delegate:nil
                                         cancelButtonTitle:@"OK"
                                         otherButtonTitles:nil];

    [alert show];
    //[titlegame release];
    [alert release];

    ////////
    if([titlegame isEqualToString: @"FootBall"]==YES)
        NSLog( @"Equal");
    else
        NSLog( @"NotEqual");
    EventViewController *eventController = [[EventViewController alloc]
                                           initWithNibName: @"EventView"
                                                    bundle:nil];
    self.eventViewController = eventController;
    [eventController release];

    [[self mainViewController] dismissModalViewControllerAnimated:YES];
    [eventViewController.view removeFromSuperview];
    [self.view addSubview: eventController.view];

    // eventController.labelgame.text = titlegame;
    eventViewController.labelgame.text =titlegame;
    NSLog(@"title==>%@",eventController.labelgame.text);
    NSLog(@"title1==>%@",eventViewController.labelgame.text);
    [eventViewController.labelgame retain];
} 
```

它工作正常

但在 EventViewController 的 ViewDidLoad 方法中，我无法确定该标签的值..

# 事件视图控制器.m：

```
- (void)viewDidLoad {
    NSLog(@"titlegame==>%@",labelgame.text);
} 
```

# EventWiseViewController.m：

```
-(IBAction)BackPressed :(id) sender
{
    EventViewController *eventController = [[EventViewController alloc]
                                           initWithNibName: @"EventView"
                                                    bundle:nil];
    self.eventWiseViewController = eventController;
    [eventController release];

    [[self eventWiseViewController] dismissModalViewControllerAnimated:YES];
    [eventViewController.view removeFromSuperview];
    [self.view addSubview: eventController.view];

    NSLog(@"final=---->%@",eventController.game1);
    eventController.labelgame.text = mainViewController.titlegame;
    NSLog(@"gmename1 ==>%@", [mainViewController titlegame]);
    NSLog(@"gamename2 ==>%@", mainViewController.titlegame);

    //NSLog(@"gmename1 ==>%@",eventController.labelgame.text);
    //NSLog(@"gmename2 ==>%@",eventController.game1);
} 
```

但是在这里，当我回到 EventViewController 时，标签变为空白，为什么？请告诉我..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T20:48:24.297

我相信你需要使用这样的东西来从不同的控制器访问 titlegame 字段

```
[AppDelegate sharedDelegate].mainViewController.titlegame; 
```

这可能并不完全正确。但我认为你遇到的问题与这个概念有关。

# css - 在带有块元素的div中如何使用css在右侧对齐文本

> ID：692692
> 
> 赞同：11
> 
> 时间：2009-03-28T12:23:34.493
> 
> 标签：css

我希望在我的页面上的标题 div 中生成以下布局，仅使用 CSS

```
+-----------+
+ +
+ 图片 + 标题文本 一些文本在右侧对齐
+ +
+-----------+

```

我无法对齐右侧的文本。它保持立即对齐到标题文本下方的右侧和一行，如下所示

```
+-----------+
+ +
+ 图片 + 标题文字                         
+ + 一些文字在右边对齐
+-----------+

```

这是我当前的标记。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"  
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">  
  <html>  
    <head>  
      <style type="text/css">  
        #header, #footer { padding: 0.3em 0; border-bottom: 1px solid; }  
        #header img   { display: inline;}  
        #header h1    { display: inline; margin: 0px; padding: 0px; 
                        vertical-align: 50%; position: left;}  
        #login-status { margin: 0px; padding: 0px; 
                        display: inline;text-align: right; position: right;}
        </style>

        <title>Models</title>            
      </head>  
      <body>  
        <div id="header">  
          <img alt="Logo" height="110" width="276" 
            src="http://www.google.co.uk/intl/en_uk/images/logo.gif" width="276" />  
          <h1>Models</h1>  
          <p id="login-status">You are currently logged in as steve</p>  
        </div> <!-- end of header -->  
      </body>  
    </html> 
```

我曾预计内联样式不会在 h1 元素之后导致换行，但事实并非如此。谁能建议我做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-28T13:59:30.020

```
#header, #footer { padding: 0.3em 0; border-bottom: 1px solid; overflow: hidden; zoom: 1; }  
    #header img   { float: left;}  
    #header h1    { float: left; margin: 0px; padding: 0px; }  
    #login-status { margin: 0px; padding: 0px; float: right; } 
```

浮动时不需要元素周围的额外 div 或清除 div。我经常使用上述技术来做你想做的事。溢出：隐藏；使标题清除浮动，但如果没有指定宽度，则需要缩放：1；对于 IE6。zoom 没有通过验证，但它可以完美运行，如果需要，您可以将其添加到仅 ie6 的 css 文件中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T12:37:23.603

你很可能不得不做这样的事情......

```
<head>
    <style type="text/css">
        #header, #footer
        {
            padding: 0.3em 0;
            border-bottom: 1px solid;
        }
        #login-status
        {
            margin: 0px;
            padding: 0px;
            line-height: 110px;
            vertical-align: middle;
        }
    </style>
    <title>Models</title>
</head>
<body>
    <div id="header">
        <div style="float: left">
            <img alt="Logo" src="http://www.google.co.uk/intl/en_uk/images/logo.gif" style="width: 276px;
                height: 110px" />
        </div>
        <div style="float: left; margin: 0px 8px 0px 8px; 
            line-height: 110px; vertical-align: middle;">
            <h1>Models</h1>
        </div>
        <div id="login-status" style="float: right;">
            You are currently logged in as steve
        </div>
        <div style="clear: both">
        </div>
    </div>
    <!-- end of header -->
</body> 
```

在某处需要“清除”以清除浮动，但它可以应用于另一个 div 标签，该标签将跟随您的标题而不是包含在标题中。

注意...我对此进行了一些更改，以使图像右侧的文本区域垂直对齐“中间”。您可以将样式更改为基于 css，但这应该可以满足您的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T12:34:42.827

```
img  float: left;  title text  float: left;    some text   float: right; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T12:28:04.357

使用“浮动：对；”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T19:14:47.017

我对此进行了更多尝试，因为使用缩放和非大小浮动的 css 都未能通过验证。我也不喜欢垂直居中显示登录状态。

我得出的最终解决方案（来自 Bryan 的大量抄袭）如下：-

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"  
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">  
  <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">  
    <head>  
      <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />  
      <style type="text/css">  
        #header, 
        #footer       { padding: 0.3em 0; border-bottom: 1px solid; 
                        height: 110px; }  
        #header img   { margin: 0px; padding: 0px; display: inline; }  
        #header h1    { line-height: 110px; vertical-align: middle; 
                        display: inline; position: absolute; left: 300px; 
                        margin: 0px; }  
        #login_status { font-size: 14px; margin: 0px; position: absolute; 
                        top: 100px; right: 10px; display: inline; 
                        text-align: right; }  
    </style>  
    <title>Models</title>     
  </head>  
  <body>  
    <div id="header">  
      <img alt="Logo" height="110" 
        src="http://www.google.co.uk/intl/en_uk/images/logo.gif" width="276" />   
      <h1>Models</h1>  
      <span id="login_status">You are currently logged in as stevew</span>    
    </div> <!-- end of header -->  
  </body>  
</html> 
```

# c# - LinQ to Entity：Lambda 表达式

> ID：692698
> 
> 赞同：0
> 
> 时间：2009-03-28T12:26:39.510
> 
> 标签：c#, linq, entity-framework

我想翻译这个

```
 var db = new PracticeEntities();
var destinations = db.DestinationDetails.
          Where(dd => dd.Language.Lang == "en-US" &&
          dd.Destination.Client.Any(c => c.Email == "abc@yahoo.com")); 

```

类似于：

```
 var destinations =
    from destinations in db.DestinationDetails
       where detail.Language.Lang == "en-US" &&
             dd.Destination.Client.Any(db.Client 

```

但是，我不知道怎么做。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T12:32:36.453

```
var destinations = from dd in db.DestinationDetails
                   where dd.Language.Lang == "en-US" &&
                         dd.Destination.Client.Any(c => c.Email == "abc@yahoo.com"); 
```

`dd`后面的变量名`from`取代了原始版本中 lambda 中的参数声明。

# c# - MVC 创建艺术家，其中包括联系人数据

> ID：692707
> 
> 赞同：0
> 
> 时间：2009-03-28T12:35:44.697
> 
> 标签：c#, asp.net-mvc, entity-framework

我对 MVC 框架相当陌生，并且在过去的几天/晚上都在学习教程。我与服务和提供者有一个松散耦合的设计，并且正在使用实体框架。我正在使用所有最新的软件，Visual Studio 2008、.Net 3.5 Framework、MVC、Entity Framework。

我正在尝试创建一个视图艺术家/创建，用户必须在其中输入所有艺术家和所有联系人字段。这是我所拥有的：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Mvc.Ajax;
using System.Text.RegularExpressions;
using Website.Models;
using Website.Models.Validation;
using Website.Models.Services;

namespace Website.Controllers
{
public class ArtistController : Controller
{
    private IArtistService _service;
    private ModelStateWrapper _msw;

    public ArtistController()
    {
        _msw = new ModelStateWrapper(this.ModelState);
        _service = new ArtistService(_msw);
    }

    public ArtistController(IArtistService service)
    {
        _service = service;
    }

    //
    // GET: /Artist/

    public ActionResult Index()
    {
        return View(_service.ListArtists());
    }

    public ActionResult Create()
    {
        ViewData["Countries"] = new SelectList(new CountryService(_msw).ListCountries().OrderBy(c => c.Name),"ID","Name");
        return View();
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create([Bind(Exclude = "Id")] Artist artist)
    {
        ViewData["Countries"] = new SelectList(new CountryService(_msw).ListCountries().OrderBy(c => c.Name), "ID", "Name");
        if (_service.CreateArtist(artist))
            return RedirectToAction("Index");
        return View("Create");
    }

    public ActionResult Edit(string name)
    {
        return View(_service.GetArtist(name));
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Edit(Artist artistToEdit)
    {
        if (_service.EditArtist(artistToEdit))
            return RedirectToAction("Index");
        return View();
    }

    public ActionResult Delete(string name)
    {
        return View(_service.GetArtist(name));
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Delete(Artist artistToDelete)
    {
        if (_service.DeleteArtist(artistToDelete))
            return RedirectToAction("Index");
        return View();
    }
}
} 
```

这是 View Artist/Create.aspx

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage" %>
   <asp:Content ID="Content3" ContentPlaceHolderID="HeadContent" runat="server">
    <title>Artist</title>
    <link href="../../Content/ui-lightness/jquery-ui-1.7.1.custom.css" rel="stylesheet" type="text/css" media="screen" />
    <script src="../../Scripts/jquery-1.3.2.js" type="text/javascript"></script>
    <script src="../../Scripts/ui.core.js" type="text/javascript"></script>
    <script src="../../Scripts/ui.datepicker.js" type="text/javascript"></script>
    <script src="../../Scripts/jquery-ui-1.7.1.custom.min.js" type="text/javascript"></script>
    <script src="../../Scripts/ui.qtips.js" type="text/javascript"></script>
   </asp:Content>
   <asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
<h2>Create Artist</h2>
<%= Html.ValidationSummary() %>

<% using (Html.BeginForm()) {%>

    <fieldset class="fields">
        <legend>Create New Artist</legend>
        <p>
            <label for="Name">Name:</label>
            <%= Html.TextBox("Name", "", new { watermark = "Name", title = "Please enter your Artist name." })%>
            <%= Html.ValidationMessage("Name", "*") %>
        </p>

        <fieldset class="fields">
            <legend>Contact Information</legend>
            <p>
                <label for="FirstName">First Name:</label>
                <%= Html.TextBox("FirstName", "", new { watermark = "FirstName", title = "Please enter your first name." }) %>
                <%= Html.ValidationMessage("FirstName", "*") %>
            </p>
            <p>
                <label for="LastName">Last Name:</label>
                <%= Html.TextBox("LastName", "", new { watermark = "Lastname", title = "Please enter your last name." })%>
                <%= Html.ValidationMessage("LastName", "*") %>
            </p>
            <p>
                <label for="Phone">Phone:</label>
                <%= Html.TextBox("Phone", "", new { watermark = "+12 123 123456", title = "Please enter your phone number." })%>
                <%= Html.ValidationMessage("Phone", "*") %>
            </p>
            <p>
                <label for="Email">Email:</label>
                <%= Html.TextBox("Email", "", new { watermark = "example@musicflock.com", title = "Please enter your email address." })%>
                <%= Html.ValidationMessage("Email", "*") %>
            </p>
            <p>
                <label for="BirthDate">Date of Birth:</label> 
                <%= Html.TextBox("Birthdate", "", new { Class = "date-pick", watermark = "mm/dd/yyyy", title = "Please select your date of birth." })%> 
                <%= Html.ValidationMessage("Birthdate", "*") %>
            </p>
            <p>
                <label for="AddressLine1">Address:</label>
                <%= Html.TextBox("AddressLine1", "", new { watermark = "", title = "Please enter your address." })%>
                <%= Html.ValidationMessage("AddressLine1", "*") %>
            </p>
            <p>
                <label for="AddressLine2"></label>
                <%= Html.TextBox("AddressLine2", "", new { watermark = "First", title = "Optional additional addressline." })%>
                <%= Html.ValidationMessage("AddressLine2", "*") %>
            </p>
            <p>
                <label for="Country">Country:</label>
                <%= Html.DropDownList("City", (IEnumerable<SelectListItem>)ViewData["Countries"],string.Empty, new { watermark = "First", title = "Please enter your email address." })%>
                <%= Html.ValidationMessage("City", "*") %>
            </p>
            <p>
                <label for="City">City:</label>
                <%= Html.TextBox("City", "", new { watermark = "", title = "Please specify your City.", @class="tooltip" })%>
                <%= Html.ValidationMessage("City", "*") %>
            </p>
            <p>
                <label for="ZipCode">ZipCode:</label>
                <%= Html.TextBox("ZipCode", "", new { watermark = "", title = "Please specify your Zipcode." })%>
                <%= Html.ValidationMessage("ZipCode", "*") %>
            </p>
            <fieldset class="fields">
                <legend>Sex/Gender</legend>
                <label for="SexMale">Male</label>
                <%= Html.RadioButton("Sex", "Male", new { @id = "Sex.Male" })%>
                <label for="SexFemale">Female</label>
                <%= Html.RadioButton("Sex", "Female", new { @id = "Sex.Female" })%>
                <%= Html.ValidationMessage("Sex", "*") %>
            </fieldset>

        </fieldset>
        <p class="submit">
            <input type="submit" value="Create" />
        </p>
    </fieldset>

<% } %>
<!-- jquery plugins -->
<script type="text/javascript">
    $(function() {
       $('.date-pick').datepicker({
           changeMonth: true,
           changeYear: true,
           yearRange: '1900:' + (new Date()).getFullYear()
       });
       $('.tooltip').qtip({ content: 'this is a nice tooltip', position: 'center' });
   });
</script>
<!-- /jquery plugins -->
</asp:Content> 
```

我可以很好地打开这个页面并输入所有数据。这是我尝试使用 ArtistService 保存艺术家的地方（这是出错的地方）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Text.RegularExpressions;
using Website.Models.Repositories;
using Website.Models.Validation;

namespace Website.Models.Services
{
    public class ArtistService : IArtistService
    {
        private IValidationDictionary _validationDictionary;
        private IArtistRepository _repository;

        public ArtistService(IValidationDictionary validationDictionary) 
            : this(validationDictionary, new EntityArtistRepository()){}

        public ArtistService(IValidationDictionary validationDictionary, IArtistRepository repository)
        {
            _validationDictionary = validationDictionary;
            _repository = repository;
        }

        public bool ValidateArtist(Artist artist)
        {
            ContactService contactService = new ContactService(_validationDictionary);
            if (contactService.ValidateContact(artist.Contact))
                _validationDictionary.AddError("Contact", "Invalid Contact information.");

            if (_validationDictionary.IsValid)
            {
                CountryService countryService = new CountryService(_validationDictionary);
                if (artist.Contact.Country != null && countryService.ValidateCountry(artist.Contact.Country))
                    _validationDictionary.AddError("Country", "Country is required.");
            }

            if (artist.Name == null || artist.Name.Trim().Length == 0) {
                _validationDictionary.AddError("Name", "Artist name is required.");
            }

            return _validationDictionary.IsValid;
        }

        #region IArtistService Members

        public bool CreateArtist(Artist artist)
        {
            // Validation logic
            if (!ValidateArtist(artist))
                return false;

            // Database logic
            try
            {
                _repository.CreateArtist(artist);
            }
            catch
            {
                return false;
            }
            return true;
        }

        public bool EditArtist(Artist artist)
        {
            // Validation logic
            if (!ValidateArtist(artist))
                return false;

            // Database logic
            try
            {
                _repository.EditArtist(artist);
            }
            catch
            {
                return false;
            }
            return true;
        }

        public Artist GetArtist(int Id)
        {
            return _repository.GetArtist(Id);
        }

        public bool DeleteArtist(Artist artist)
        {
            try
            {
                _repository.DeleteArtist(artist);
            }
            catch
            {
                return false;
            }
            return true;
        }

        public IEnumerable<Artist> ListArtists()
        {
            return _repository.ListArtists();
        }

        public Artist GetArtist(string name)
        {
            return _repository.GetArtist(name);
        }

        #endregion
    }
} 
```

谁能告诉我为什么每次在 ValidateArtist 中，Artist Entity 的 Contact 属性似乎都是空的？我如何告诉 MVC 它应该将联系人输入字段链接到艺术家实体的联系人属性？

我希望我在这里粘贴所有代码没问题，看起来很多......

谢谢，彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T12:44:53.193

您实际上有两个正在创建的模型。尝试将联系人指示符添加到联系人字段。

```
 <p>
            <label for="Contact_Phone">Phone:</label>
            <%= Html.TextBox("Contact.Phone", "", new { watermark = "+12 123 123456", title = "Please enter your phone number." })%>
            <%= Html.ValidationMessage("Contact.Phone", "*") %>
     </p> 
```

然后，如果它没有在您的操作中填充 Contact 字段，请尝试将 Contact 参数添加到操作方法并从中设置艺术家的 Contact 属性。

```
public ActionResult Create([Bind(Exclude = "Id")] Artist artist,
                           [Bind(Prefix = "Contact")] Contact contact )
{
    artist.Contact = contact;
    ...
} 
```

# c# - 是否可以在单个语句中声明和使用匿名函数？

> ID：692708
> 
> 赞同：3
> 
> 时间：2009-03-28T12:37:07.533
> 
> 标签：c#, lambda

有没有办法将以下两行组合成一个语句？

```
Func<XmlNode> myFunc = () => { return myNode; };
XmlNode myOtherNode = myFunc(); 
```

我一直在尝试类似下面的事情，但无法让它工作，也无法从文档中确定它是否应该工作？

```
XmlNode myOtherNode = ((Func<XmlNode>) () => { return myNode; })(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T12:43:01.153

我不确定您为什么要这样做，但是..

```
XmlNode myOtherNode = new Func<XmlNode>( () => { return myNode; } )(); 
```

应该做的伎俩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T12:47:58.117

“诀窍”是您需要创建一个委托的实例才能使其工作，在您的示例中，这是在您执行分配时隐式完成的（myFunc = ...）。此外，您可以将函数表示为 () => myNode 以使其更短。

```
XmlNode myOtherOne = new Func<XmlNode>( () => myNode )(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T12:53:08.917

“headsling”发布的语法有效。

奇怪的是，即使您不能将原始语法与 lambda ( `=>`) 一起使用，您也可以使用`delegate`：

```
XmlNode myOtherNode = ((Func<XmlNode>) delegate { return myNode; })(); 
```

当然，真正的问题是……为什么？出什么问题了...

```
XmlNode myOtherNode = myNode; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-20T06:22:21.867

只是想我会把这个结构的另一个有趣的用途加入到组合中：

```
namespace FunWithContractsAndAnonymousDelegates
{
    using System;
    using System.Collections.Generic;
    using System.Diagnostics.Contracts;
    using System.Linq;

    internal static class Program
    {
        private static void MySort<T>(T[] array, int index, int length, IComparer<T> comparer)
        {
            Contract.Requires<ArgumentNullException>(array != null);
            Contract.Requires<ArgumentOutOfRangeException>(index >= 0 && index <= array.Length);
            Contract.Requires<ArgumentOutOfRangeException>(length >= 0 && index + length <= array.Length);
            Contract.Ensures(new Func<T[], int, int, IComparer<T>, bool>((_array, _index, _length, _comparer) =>
                {
                    T[] temp = (T[])_array.Clone();
                    Array.Sort(temp, _index, _length, _comparer);
                    return temp.SequenceEqual(_array);
                })(array, index, length, comparer));

            // TODO: Replace with my heavily optimized and parallelized sort implementation...
            Array.Sort(array, index, length, comparer);
        }

        private static void Main(string[] args)
        {
            int[] array = { 3, 2, 6, 1, 5, 0, 4, 7, 9, 8 };
            MySort(array, 0, array.Length, Comparer<int>.Default);
            foreach (int value in array)
            {
                Console.WriteLine(value);
            }
        }
    }
} 
```

声明和调用匿名委托意味着我不必声明一个我将只使用一次来检查后置条件的方法（即在对 Contract.Ensures 的调用中）。

尽管这看起来很做作，但我今天真的用了这个......

# .net - 是否将数据库连接封装在业务对象中？

> ID：692713
> 
> 赞同：3
> 
> 时间：2009-03-28T12:43:46.130
> 
> 标签：.net, database

我通常喜欢自己创建数据库连接并使用“使用{}”手动控制其生命周期。例如：

```
SqlConnection sqlConnection = new SqlConnection( connectionString );
using( sqlConnection ) {
    BusinessObject myBusinessObject = new BusinessObject( sqlConnection );
    // do stuff with the business object
    ...
} 
```

通过这种方式，很明显我正在使用需要适当清理的资源。然而，这最终会成为很多重复性的工作。我很想在业务对象内创建 Sql 连接并在其上实现 IDisposable。我会在 Dispose() 方法中关闭连接。

```
using( BusinessObject myBusinessObject = new BusinessObject() ) {
    // do stuff with myBusinessObject
    ...
} 
```

我遇到的问题是，除非您看到它在使用中，否则需要处置业务对象可能并不那么明显。

你们会怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T12:55:02.670

相对于数据库，业务对象应该是合理（或完全）哑的。您应该实现某种访问层对象（存储库或数据上下文），该对象知道如何将业务对象持久保存到数据库并将连接逻辑保留在那里，而不是将代码放入每个业务对象中。您的存储库或上下文将是一次性的，以便它可以自行清理。@Marc 建议您遵循工作单元模式是一个很好的建议。

如果您坚持编写自己的数据层，您可能想查看 LINQtoSQL、nHibernate、Subsonic 等以使用它们，或者至少了解如何构建一个好的数据层。根据个人经验，我可以告诉您，使用现有技术比编写和维护自己的技术要容易得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T12:47:39.910

好吧，首先我会留下与存储库的连接。

其次，我不会在对象上保持连接——我只会将它用于一个工作单元（即单一方法）。有可能（由于池化）无论如何您都会恢复相同的物理连接。该系统在处理此类事情方面已经走了很长一段路，因此您不必这样做。

更棘手的情况是事务，这`TransactionScope`比传递 db-transaction 对象要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T14:49:09.557

我认为业务对象不应该知道或关心它是否是持久的。单个持久业务对象无法知道它何时是更大工作单元的一部分；那是服务层的责任。将连接排除在业务对象之外。服务层是获取连接的正确位置，通常来自连接池、设置事务边界、提交或回滚以及清理。

# php - 基于 PHP 的搜索框架

> ID：692716
> 
> 赞同：3
> 
> 时间：2009-03-28T12:45:22.913
> 
> 标签：php, frameworks, full-text-search, search

我将制作一个需要高级搜索功能的小型网站。由于重新发明轮子并不是一项值得做的活动，所以我做了一些谷歌搜索，发现有一些基于 PHP 的搜索框架，其中一个集成到 Zend 框架中。

我想在框架中拥有什么：

1.  全文和目录搜索功能
2.  显示按相关性排序的结果
3.  能够按类别过滤结果
4.  按各种标准对结果进行排序
5.  快速搜索
6.  不需要快速插入

由于该站点将包含相当多的静态内容（一些文本和产品目录），我可能会使用一些预先生成的索引。

是否有任何（免费）框架可以满足上述要求？建议、提示和想法非常受欢迎。如果您能分享您实施搜索系统的经验，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T12:56:18.907

如果站点只有静态内容，您可能希望使用[Joomla](http://www.joomla.org/)或[Drupal等 CMS。](http://drupal.org/)两者都有很好的搜索系统。但是，搜索实际上取决于您拥有的内容类型。如果它只是搜索页面的 HTML，那是一回事，但在数据库中搜索特定型号的产品是另一回事，在这种情况下，您需要一个购物车/电子商务系统而不是 CMS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T13:06:55.823

查看**Omega**（基于 Xapian） - [Xapian 项目页面的链接](http://xapian.org/features)

你可以集成它 cgi-wise。因为它基于令人眼花缭乱的快速 Xapian，如果您正确设置它，它将是最快的选项之一。它可以做你要求的一切（包括搜索结果的相关性、索引网络服务器文档（html、pdf、word、excel、sql 数据库......）做'stemming'等......）

另一个（也是非常好的选择）当然是[Apache Lucene](http://lucene.apache.org/java/docs/features.html) --> 您引用的 Zend 框架中包含的就是这个（“Zend Search”）。它可以做所有相同的技巧，虽然我个人更喜欢 Xapian。

**编辑：**请注意，如果我没记错的话，Omega（和 Xapian）是 GPL，而 Apache Lucene 是 LGPL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T23:19:54.923

绝对使用[SOLR](http://lucene.apache.org/solr/)。Solr 使用 lucene。这对中/大型网站有用吗....

好消息是您可以从 solr 请求 php 序列化格式的结果...

编辑：

这就是您要找的东西，我完全忘记了：[Zend 的 Lucene Port To PHP](http://framework.zend.com/manual/en/zend.search.lucene.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T13:27:19.363

我最近开发了一个建议全文搜索，用于我的基于 Zend Framework 的 Web 应用程序 - 我找不到任何适合我要求的现成解决方案，所以我全力以赴，从头开始开发了一个简单的（全文）关键字搜索机制。我发现以下文章很有帮助：

[http://devzone.zend.com/node/view/id/1304](http://devzone.zend.com/node/view/id/1304)

[http://dev.mysql.com/doc/refman/5.1/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.1/en/fulltext-search.html)

我现在拥有的是一个系统，它根据在数据库中保存（或更新）项目时生成的“文本摘要”来匹配项目。我有一个名为 kw_search_summary 的表，其中包含每个项目（生成的脚本）的文本摘要、其 ID 和类别 ID。'summary' 列是 mysql 全文索引，所以我只需 MATCH() 汇总列 AGAINST() 一个给定的表达式，并按相关性显示结果。构建这个查询的代码看起来有点像这样：

```
 $select = $this->db->select()
                 ->from(array('kwi' => 'kw_search_index'),
                        array('id','prodcatid','itemid','useradid','summary','relevance' => "match(summary) against($safeExp in boolean mode)"))
                 ->where("match(summary) against($safeExp in boolean mode)")
                 ->order('relevance desc')
                 ->limitPage($currentPage,self::RESULTS_PER_PAGE); 
```

希望这至少有点帮助。

# performance - 每条汇编指令需要多少个 CPU 周期？

> ID：692718
> 
> 赞同：62
> 
> 时间：2009-03-28T12:46:28.540
> 
> 标签：performance, assembly, x86, cpu-architecture, cpu-cycles

我听说网上有英特尔的书，它描述了特定汇编指令所需的 CPU 周期，但我找不到（经过努力）。谁能告诉我如何找到CPU周期？

这是一个例子，在下面的代码中，mov/lock 是 1 个 CPU 周期，xchg 是 3 个 CPU 周期。

```
// This part is Platform dependent!
#ifdef WIN32
inline int CPP_SpinLock::TestAndSet(int* pTargetAddress, 
                                              int nValue)
{
    __asm
    {
        mov edx, dword ptr [pTargetAddress]
        mov eax, nValue
        lock xchg eax, dword ptr [edx]
    }
    // mov = 1 CPU cycle
    // lock = 1 CPU cycle
    // xchg = 3 CPU cycles
}

#endif // WIN32 
```

顺便说一句：这是我发布的代码的 URL：http: [//www.codeproject.com/KB/threads/spinlocks.aspx](http://www.codeproject.com/KB/threads/spinlocks.aspx)

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2017-07-07T23:13:21.273

现代 CPU 是复杂的野兽，使用[流水线](https://en.wikipedia.org/wiki/Instruction_pipelining)、[超标量执行](https://en.wikipedia.org/wiki/Superscalar_processor)和[乱序执行](https://en.wikipedia.org/wiki/Out-of-order_execution)以及其他使性能分析变得困难的技术……**但并非不可能**！

虽然您不能再简单地将指令流的延迟相加以获得总运行时间，但您仍然可以（通常）高度准确地分析某些代码（尤其是循环）的行为，如下所述和其他链接资源。

## 指令时间

首先，您需要实际的时间。这些因 CPU 架构而异，但目前 x86 时序的最佳资源是 Agner Fog 的[指令表](http://www.agner.org/optimize/#manual_instr_tab)。这些表涵盖不少于*三十种不同的微架构，列出了指令**延迟*，这是一条指令从准备好输入到可用输出的最小/典型时间。用阿格纳的话来说：

> **延迟：** 这是指令在依赖链中生成的延迟。数字是最小值。高速缓存未命中、未对齐和异常可能会显着增加时钟计数。在启用超线程的情况下，在另一个线程中使用相同的执行单元会导致性能下降。非正规数、NAN 和无穷大不会增加延迟。使用的时间单位是核心时钟周期，而不是时间戳计数器给出的参考时钟周期。

因此，例如，该`add`指令具有一个周期的延迟，因此如图所示，一系列*相关*的加法指令将具有每个周期 1 个周期的延迟`add`：

```
add eax, eax
add eax, eax
add eax, eax
add eax, eax  # total latency of 4 cycles for these 4 adds 
```

请注意，这并不意味着`add`每条指令只需 1 个周期。例如，如果 add 指令**不**依赖，那么在现代芯片上，所有 4 个 add 指令都可以在同一个周期内独立执行：

```
add eax, eax
add ebx, ebx
add ecx, ecx
add edx, edx # these 4 instructions might all execute, in parallel in a single cycle 
```

Agner 提供了一个衡量这种潜在并行性的指标，称为*互惠吞吐量*：

> **倒数吞吐量：** 同一线程中一系列同类独立指令的每条指令的平均核心时钟周期数。

因为`add`这被列为`0.25`意味着`add`每个周期最多可以执行 4 条指令（给出倒数的吞吐量`1 / 4 = 0.25`）。

倒数的吞吐量数也暗示了指令的*流水线*能力。例如，在最新的 x86 芯片上，`imul`指令的常见形式具有 3 个周期的延迟，并且在内部只有一个执行单元可以处理它们（不像`add`通常有四个可添加的单元）。然而，对于一长串独立`imul`指令，观察到的吞吐量是 1 个/周期，而不是您可能期望的每 3 个周期 1 个，因为延迟为 3。原因是该`imul`单元是流水线的：它可以在*每个周期**开始*一个新的，即使在之前的乘法还没有完成。`imul`

 *这意味着一系列*独立* `imul`指令每个周期最多可以运行 1 个，但一系列*相关* `imul`指令每 3 个周期只能运行 1 个（因为下一个指令`imul`在前一个指令的结果准备好之前无法开始）。

因此，有了这些信息，您就可以开始了解如何分析现代 CPU 上的指令时序。

## 详细分析

尽管如此，以上只是表面上的。您现在可以通过多种方式查看一系列指令（延迟或吞吐量），并且可能不清楚使用哪种方式。

此外，还有其他一些限制，例如某些指令在 CPU 内竞争相同的资源，以及 CPU 流水线其他部分的限制（例如指令解码）可能导致较低的总吞吐量比您仅通过查看延迟和吞吐量来计算的。除此之外，您还有“ALU 之外”的因素，例如内存访问和分支预测：整个主题本身——您可以很好地对这些进行建模，但这需要工作。例如，这是[最近](https://stackoverflow.com/a/45114487/149138)的一篇文章，其中答案详细介绍了大多数相关因素。

涵盖所有细节会使这个已经很长的答案的大小增加 10 倍或更多，所以我只会为您指出最佳资源。Agner Fog 有一个*Optimizing Asembly* [指南](http://www.agner.org/optimize/#manual_asm)，其中详细介绍了包含十几个指令的循环的精​​确分析。请参阅 PDF 当前版本的第 95 页开始的“ **12.7**矢量循环中的瓶颈分析示例”。

基本思想是创建一个表，每条指令有一行，并标记每条指令使用的执行资源。这让您可以看到任何吞吐量瓶颈。此外，您需要检查循环中携带的依赖项，以查看是否有任何限制吞吐量（有关复杂情况，请参阅“ **12.16**分析依赖项”）。

如果您不想手动进行，英特尔发布了[英特尔架构代码分析器](https://software.intel.com/en-us/articles/intel-architecture-code-analyzer)，这是一个自动执行此分析的工具。它目前尚未在 Skylake 之外进行更新，但对于 Kaby Lake 而言，结果在很大程度上仍然是合理的，因为微架构没有太大变化，因此时间保持可比性。[这个答案](https://stackoverflow.com/a/26021338/149138)涉及很多细节并提供了示例输出，[用户指南](https://software.intel.com/sites/default/files/m/d/4/1/d/8/Intel_Architecture_Code_Analyzer_2.0_Users_Guide.pdf)也不错（尽管它相对于最新版本已经过时）。

## 其他来源

Agner 通常会在新架构发布后不久为其提供时序，但您也可以查看[instlatx64](http://instlatx64.atw.hu/)`InstLatX86`以了解在和`InstLatX64`结果中类似组织的时序。结果涵盖了很多有趣的旧筹码，而新筹码通常会很快出现。结果与 Agner 的结果基本一致，除了一些例外。您还可以在此页面上找到内存延迟和其他值。

您甚至可以在**附录 C：指令延迟和吞吐量的**[IA32 和 Intel 64 优化手册](https://www.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-optimization-manual.html)中直接从 Intel 获得时序结果。我个人更喜欢 Agner 的版本，因为它们更完整，通常在英特尔手册更新之前到达，并且更易于使用，因为它们提供了电子表格和 PDF 版本。

 **最后，[x86 标签 wiki](https://stackoverflow.com/tags/x86/info)有大量关于 x86 优化的资源，包括指向如何对代码序列进行循环精确分析的其他示例的链接。

如果您想更深入地了解上述“数据流分析”的类型，我会推荐[A Whirlwind Introduction to Data Flow Graphs](https://fgiesen.wordpress.com/2018/03/05/a-whirlwind-introduction-to-dataflow-graphs/)。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-03-28T13:00:30.223

鉴于流水线、乱序处理、微码、多核处理器等，无法保证汇编代码的特定部分将占用 x CPU 周期/时钟周期/任何周期。

如果存在这样的参考，它只能提供给定特定架构的广泛概括，并且根据微代码的实现方式，您可能会发现 Pentium M 与 Core 2 Duo 不同，Core 2 Duo 与 AMD 双核不同， ETC。

请注意，这篇文章是在 2000 年更新的，并且写得更早。即使是 Pentium 4 也很难确定指令时序 - PIII、PII 和原始的 pentium 更容易，并且引用的文本可能基于那些具有更明确的指令时序的早期处理器。

如今，人们通常使用统计分析来进行代码时序估计。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-03-28T14:02:06.613

其他答案所说的无法准确预测在现代 CPU 上运行的代码的性能是正确的，但这并不意味着延迟是未知的，或者知道它们是没有用的。

英特尔和 AMD 处理器的确切延迟列在[Agner Fog 的指令表](http://agner.org/optimize/)中。另请参阅[Intel® 64 和 IA-32 架构优化参考手册](http://www.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-optimization-manual.html)，以及[AMD 和 Intel x86 处理器的指令延迟和吞吐量](http://gmplib.org/~tege/x86-timing.pdf)（来自 Can Berk Güder 现在已删除的仅链接答案）。AMD 在他们自己的网站上也有带有官方价值观的 pdf 手册。

对于（微）优化紧密循环，了解每条指令的延迟对于手动尝试调度代码有很大帮助。程序员可以做很多编译器做不到的优化（因为编译器不能保证不会改变程序的意思）。

当然，这仍然需要你了解 CPU 的很多其他细节，比如流水线的深度、每个周期可以发出多少条指令、执行单元的数量等等。当然，这些数字因不同的 CPU 而异。但是您通常可以得出一个或多或少适用于所有 CPU 的合理平均值。

不过值得注意的是，在这个级别上优化几行代码也需要做很多工作。而且很容易做出结果是悲观的事情。现代 CPU 非常复杂，它们非常努力地从糟糕的代码中获得良好的性能。但也有一些情况他们无法有效地处理，或者你*认为*你很聪明并且可以编写高效的代码，结果会降低 CPU 的速度。

**编辑** 查看英特尔的优化手册，表 C-13：第一列是指令类型，然后每个 CPUID 都有许多列延迟。CPUID 指示编号适用于哪个处理器系列，并在文档的其他地方进行了说明。延迟指定在指令结果可用之前需要多少个周期，因此这是您要查找的数字。

吞吐量列显示每个周期可以执行多少此类指令。

在这张表中查找 xchg，我们看到根据 CPU 系列的不同，它需要 1-3 个周期，而一个 mov 需要 0.5-1。这些是用于指令的寄存器到寄存器形式，而不是用于`lock xchg`内存，这要慢得多。更重要的是，巨大的延迟和对周围代码的影响（当与另一个核心争用时会慢得多），所以只看最好的情况是错误的。（我没有查看每个 CPUID 的含义，但我认为 0.5 用于 Pentium 4，它以双倍速度运行芯片的某些组件，允许它在半个周期内完成任务）

但是，我真的不知道您打算将这些信息用于什么目的，但是如果您知道代码正在运行的确切 CPU 系列，那么将延迟相加会告诉您执行此指令序列所需的最小周期数.

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-28T13:09:11.047

在 x86 上测量和计算 CPU 周期不再有意义。

首先，问问自己你在计算哪个 CPU 的周期？核心2？速龙？奔腾-M？原子？所有这些 CPU 都执行 x86 代码，但它们都有不同的执行时间。执行甚至在同一 CPU 的不同步进之间有所不同。

最后一个循环计数有意义的 x86 是 Pentium-Pro。

还要考虑到，在 CPU 内部，大多数指令都被转码为微码，并由内部执行单元乱序执行，该执行单元甚至看起来都不像 x86。单条 CPU 指令的性能取决于内部执行单元中有多少资源可用。

因此，一条指令的时间不仅取决于指令本身，还取决于周围的代码。

无论如何：您可以估计不同处理器的吞吐量资源使用和指令延迟。相关信息可在 Intel 和 AMD 网站上找到。

Agner Fog 在他的网站上有一个很好的总结。请参阅指令表了解延迟、吞吐量和 uop 计数。请参阅微架构 PDF 以了解如何解释这些内容。

[http://www.agner.org/optimize](http://www.agner.org/optimize)

但请注意，`xchg`-with-memory 没有可预测的性能，即使您只查看一种 CPU 型号。即使在 L1D 缓存中缓存线已经很热的无争用情况下，作为一个完整的内存屏障也意味着它的影响在很大程度上取决于加载和存储到周围代码中的其他地址。

* * *

顺便说一句-因为您的示例代码是无锁数据结构的基本构建块：您是否考虑过使用编译器内置函数？在 win32 上，您可以包含 intrin.h 并使用 _InterlockedExchange 等函数。

这将为您提供更好的执行时间，因为编译器可以内联指令。内联汇编器总是强制编译器禁用围绕 asm 代码的优化。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-01-04T14:21:44.513

锁定 xchg eax, dword ptr [edx]

请注意，锁会为所有内核的内存获取锁定内存，这在某些多核上可能需要 100 个周期，并且还需要刷新缓存行。它还会使管道停滞。所以我不会担心其余的。

因此，最佳性能又回到了调整算法的关键区域。

请注意，在单核上，您可以通过移除锁来优化这一点，但多核需要它。

# c# - XPath：选择所有A节点和不在A节点内的所有B节点

> ID：692723
> 
> 赞同：1
> 
> 时间：2009-03-28T12:50:32.820
> 
> 标签：c#, vb.net, xpath

在一个 XPath 表达式中是否可能出现以下情况（请参见下面的示例）：

选择所有**（msg 类的 span 标签）**和所有**（（具有非空 alt 属性的 img 标签）** AND **（不位于 msg 类的 span 标签内））**

简化样本：

```
<span class="msg">Message text A</span>
<img alt="" />
<span class="msg">Message text B <img alt="text A" /></span>
<span class="err">Error text C <img alt="text B" /></span>
<img alt="text C" />
<span class="err">Error text D</span> 
```

生成的节点集应包含：

```
<span class="msg">Message text A</span>
<span class="msg">Message text B <img alt="text A" /></span>
<img alt="text B" />    
<img alt="text C" /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T12:56:14.117

未经测试，但类似？

```
//span[@class='msg'] | //img[@alt!='' and not(ancestor::span[@class='msg'])] 
```

# c# - C# 等效于 Java 实例初始化程序

> ID：692735
> 
> 赞同：8
> 
> 时间：2009-03-28T13:01:32.030
> 
> 标签：c#, java

在`Java`实例中，变量可以由初始化块初始化，如下所示：

```
class Example {
    private int varOne;
    private int varTwo;

    {
        // Instance Initializer
        varOne = 42;
        varTwo = 256;
    }
} 
```

中是否有等效的构造`C#`？

**[编辑]**我知道这可以与实例变量声明内联。但是，我正在寻找类似于静态构造函数的东西，`C#`但用于实例变量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T13:15:26.833

C# 中确实没有等价物。C#只有两种初始化实例变量的方法

1.  在构造函数中
2.  通过在声明点显式初始化变量

在创建对象之后但在构造函数运行之前，无法进行初始化。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-28T15:03:45.967

创建一个实例构造函数，任何其他本地构造函数都将在初始化列表中调用：

```
private Example ()
{
    //initialize all fields here
}

public Example (/*list of parameters*/) : this()
{
    //do specific work here
} 
```

如果应用程序的逻辑已经需要默认构造函数，则替换

```
private Example () 
```

和

```
private Example (object dummy) 
```

当然，相应地修改初始化调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-11T06:31:22.913

如果这是您在特定情况下想要的，那么可能的范围如下：

```
class Example {
    public int varOne;
    public int varTwo;

    public Example(){
        Console.WriteLine("varOne : " + varOne + ", varTwo : " + varTwo);
    }

    public void getValues()
    {
        Console.WriteLine("varOne : " + varOne + ", varTwo : " + varTwo);
    }
}

static void Main(string[] args)
    {
        Example e = new Example{ varOne = 42, varTwo = 256};
        e.getValues();
    } 
```

在这里，您需要公开实例变量。

# windows - 如何使用 Windows API 以编程方式调整窗口大小和移动窗口？

> ID：692742
> 
> 赞同：28
> 
> 时间：2009-03-28T13:09:13.073
> 
> 标签：windows, winapi

如何使用 Windows API 以编程方式调整窗口大小和移动窗口？

场景是：我想垂直平铺两个窗口（80%/20% 宽度比例）。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-28T13:33:35.963

对于无闪烁、同时定位两个（或更多）窗口，最好的办法是使用 *[BeginDeferWindowPos()](http://msdn.microsoft.com/en-us/library/ms632672(VS.85).aspx)*、*[DeferWindowPos()](http://msdn.microsoft.com/en-us/library/ms632681(VS.85).aspx)*和*[EndDeferWindowPos()](http://msdn.microsoft.com/en-us/library/ms633440(VS.85).aspx)*。在您的情况下，由于您同时移动两个，这是您最好的选择。

您还可以考虑三个较旧、更简单的函数是[SetWindowPos()](http://msdn.microsoft.com/en-us/library/ms633545.aspx)、[MoveWindow()](http://msdn.microsoft.com/en-us/library/ms633534(VS.85).aspx)和[AdjustWindowRectEx()](http://msdn.microsoft.com/en-us/library/ms632667(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-28T13:11:48.980

在 Windows API 中使用[SetWindowPos() 。](http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx)

给定一个 HWND，您可以更改 z 顺序、位置（左上角）、大小以及许多其他标志（如显示或隐藏、使其成为活动窗口或不成为活动窗口等）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-28T13:18:32.177

您正在寻找[SetWindowPos](http://msdn.microsoft.com/en-us/library/ms633545.aspx)、[MoveWindow](http://msdn.microsoft.com/en-us/library/ms633534(VS.85).aspx)和[AdjustWindowRectEx 之一](http://msdn.microsoft.com/en-us/library/ms632667(VS.85).aspx)。

您能否更具体地了解该场景，以便我们推荐最合适的 API？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-28T13:15:15.430

SetWindowPos 或 MoveWindow 将为您完成此任务

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-28T13:12:18.637

在您的 SDK 文档中查找**MoveWindow 。**

# ruby-on-rails - 保存 has_and_belongs_to_many 孩子

> ID：692747
> 
> 赞同：1
> 
> 时间：2009-03-28T13:12:41.287
> 
> 标签：ruby-on-rails, ruby, has-and-belongs-to-many

我有一个用户模型和一个角色模型。它们由 has_and_belongs_to_many 关系连接。当管理员创建用户时，我希望他们能够为用户分配角色并在我调用 @user.save 时将其保存

但问题是我收到一个警告，说我无法批量分配角色关系。

关于如何去做的任何建议，我在 Rails 2.3.2

谢谢。

编辑：按要求编码。

用户.rb

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :roles,
                          :join_table => "users_roles",
                          :foreign_key => "role_id",
                          :associated_foreign_key => "user_id"
end 
```

角色.rb

```
class Role < ActiveRecord::Base
  has_and_belongs_to_many :users,
                          :join_table => "users_roles", 
                          :foreign_key => "user_id", 
                          :association_foreign_key => "role_id"
end 
```

查看：new.html.haml

```
- form_for(@user, users_path(:subdomain => current_account.subdomain)) do |f|
  .input_set
    = f.label(:login, "Username")
    = f.text_field(:login)
  .input_set
    = f.label(:name)
    = f.text_field(:name)
  .input_set
    = f.label(:email)
    = f.text_field(:email)
    - fields_for("user[roles][]", Role)do |user_role|
      .input_set
        %label Role
        = user_role.select(:name, Role.all.map{|r| [r.name, r.id] })
  .input_set
    = f.label(:password)
    = f.password_field(:password)
  .input_set
    = f.label(:password_confirmation, "Password Again")
    = f.password_field(:password_confirmation)
  .input_set
    %label
    = f.submit "Add User" 
```

我希望通过在我的创建选项中调用 @user.save 将角色保存给用户。那可能吗？或者这是我不能用那种方式使用的关系，我是否需要一个 has_many 关系才能做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T04:48:52.760

我相信您需要对要保存的模型中的属性调用 attr_accessible 以避免批量分配错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T17:37:09.970

您不能将accepts_nested_attributes_for 用于habtm 关系。

但是，您可以设置 role_ids，有关详细信息，请参阅 Railscast 第 17 集

在您的情况下，问题是您只设置了一个角色但有一个habtm 关系，为什么不属于belongs_to？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-26T06:05:35.880

考虑到自提出问题以来的时间，您可能已经自己解决了这个问题......

> 但问题是我收到一个警告，说我无法批量分配角色关系。

这是由用户模型中的两件事之一引起的。

1.  您调用了 attr_accessible 并且提供的符号列表不包括 :roles
2.  您调用了 attr_protected 并且符号列表包括 :roles

将 :roles 添加到您的 attr_accessible 调用或将其从 attr_protected 调用中删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T22:27:24.900

您是否使用新的[accepts_nested_attributes_for](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html#M002076)方法？

它可能看起来像这样：

```
class User < ActiveRecord::Base 
  accepts_nested_attributes_for :roles, :allow_destroy => true
end 
```

[查看此示例应用程序以获取更多详细信息。](http://github.com/alloy/complex-form-examples/tree/master)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-26T05:39:32.420

如果我可以编辑/添加到答案，我会的。我需要与@EmFi 提到的类似的东西。我设置了 attr_accessible ，并且必须添加相当于

```
:role_ids 
```

到用户模型的 attr_accessible 。注意复数。以下选项**不起作用**：

*   ：角色
*   :角色
*   :role_id

只是为了清楚我收到的错误消息：

```
WARNING: Can't mass-assign these protected attributes: role_ids 
```

由于我使用的是 habtm 关系，因此该警告对我来说没有多大意义。尽管如此，它是正确的。

# c++ - 模板类型的命名约定？

> ID：692752
> 
> 赞同：30
> 
> 时间：2009-03-28T13:17:23.710
> 
> 标签：c++, templates, naming-conventions

传统上，模板类型的名称只是一个大写字母：

```
template<class A, class B, class C>
class Foo {}; 
```

但我犹豫要不要这样做，因为它是非描述性的，因此难以阅读。所以，这样的事情不是更好吗：

```
template<class AtomT, class BioT, class ChemT>
class Foo {}; 
```

我也倾向于认为以下不是一个坏主意：

```
template<class ATOM, class BIO, class CHEM>
class Foo {}; 
```

它使它们脱颖而出（而且，它又是大写字母）。你怎么看？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-28T13:20:00.583

对于 C++ 模板，我有几个模式

如果只有一个模板参数，我将其命名为 T（或嵌套模板的 U,V）。

当有多个参数并且使用不是很明显时，我会使用带有 T 前缀的描述性名称。例如，TKey、TValue、TIdentifiier 等……这使得在整个模板使用过程中很容易发现参数。

不过，我会避免使用全大写版本。大多数人使用 C/C++ 中的所有大写标识符来表示宏定义。为模板参数重复该模式可能会使人们感到困惑。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-28T13:34:17.427

我对模板参数使用约定 TName，对存储的模板参数使用 NameT。

```
template <typename TFirst, typename TSecond>
class Templated
{
    typedef TFirst FirstT;
    typedef TSecond SecondT;
}

typedef Templated<int, std::string> MyTemplated;
...
const MyTemplated::FirstT size; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-28T13:19:39.023

通常，如果只有一种类型参数，传统的方法是使用 T。如果还有更多，使用 T 作为前缀，例如 TAtom。“T”前缀有助于立即看到它的类型参数。对单个类型参数使用 TAtom 也是有效的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T13:27:56.537

您不应该对模板使用特殊的命名约定，只需使用与该类型的任何其他类型（如类或变量）相同的约定。无论您是使用模板类型/值还是普通类型/值，在代码中都无关紧要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T13:27:17.507

如果我有一个类型参数的类，我使用名称 T。这也意味着这个类中的所有操作都使用 T。

如果我在你的例子中命名的参数很少 AtomT, BioT
...比较。

有时为了避免混合样式，我在类中制作 typedef：
typedef T value_type;

--
Boost 命名约定 ( [http://www.boost.org/development/requirements.html#Naming_consistency](http://www.boost.org/development/requirements.html#Naming_consistency) ) 接下来介绍模板参数：
模板参数名称以大写字母开头。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T13:32:18.743

我尝试遵循我的编译器供应商使用的概念：它不太短，也不太冗长。并帮助我阅读使用标准模板收到的错误消息。`const T&`（这是我从 切换到的另一个原因`T const&`）。就像是：

```
template <class Ty, class Container>
class my_algo { ... 
```

我的编译器通常会使用：

```
template <class _Ty, class _Container>
class std_algo { ... 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T19:11:17.540

在我们的商店，我们使用 HungF##ngarian 表示法。模板参数和所有其他参数一样只是参数，除了它们不是常量，也不是变量，而是类型。

```
template< typename at_Container, typename at_Functor > 
at_Functor& foreach( const at_Container& ac_Cont, at_Functor& av_Func ) {
    return std::foreach( ac_Cont.begin(), ac_Cont.end(), av_Func );
} 
```

前缀描述了类型，而名称则说明了参数在定义函数的上下文中所起的作用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-28T14:18:17.073

我遵循与命名类和结构相同的通用约定命名模板参数类型名，即将第一个字母或每个单词大写，如下所示：

```
class MyGizmo
{
};

struct Thingy
{
};

class TPSReport 
{
};

template<class ValType> ...

template<typename Number> ... 
```

# windows - 是否可以启动一个新进程并将其主窗口设置为我的 MDI 应用程序的子窗口？

> ID：692753
> 
> 赞同：2
> 
> 时间：2009-03-28T13:17:30.807
> 
> 标签：windows, mdi

是否可以启动一个新进程并将其主窗口设置为我的 MDI 应用程序的子窗口？

场景是：我有一个 MDI 应用程序，我想将 Adob​​e Acrobat 作为 MDI 应用程序的子窗口启动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T13:27:05.497

理论上，我相信使用[SetParent 是可能的。](http://msdn.microsoft.com/en-us/library/ms633541(VS.85).aspx)

但是，在实践中，这可能比您预期的要困难一些。此外，您需要做一些工作来同步样式等。

不过，只是一个想法-如果您尝试嵌入 Acrobat Reader（不是完整的 Acrobat），则可以通过嵌入 web 控件并在其中使用 acrobat reader 插件来更轻松地完成此操作...

* * *

以下是一些制作这项工作的人的样本（至少部分）：

[与特定问题的解决方法相关的 SO](https://stackoverflow.com/questions/170800/embedding-hwnd-into-external-process-using-setparent)问题。

[使用 SetParent 的 CodeProject 文章](http://www.codeproject.com/KB/vb/ByPassAutomation.aspx?display=Print)

关于在 win32 应用程序中嵌入 java 应用程序的[专家交流问题。](http://www.experts-exchange.com/Programming/System/Windows__Programming/Q_22842901.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T13:33:04.187

我不相信这是可能的，至少不使用 SetParent。引用 SetParent 文档：

> 应用程序可以使用 SetParent 函数来设置弹出窗口、重叠窗口或子窗口的父窗口。新的父窗口和子窗口必须属于同一个应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T13:42:40.527

我不认为你想要的东西很容易做到，但它可能是尝试集成其中一个开源 PDF 查看器的一种选择（如果你准备好使用 GPL，因为这可能是其中大多数的许可证）。一些链接：

*   [epdfview](http://trac.emma-soft.com/epdfview/)
*   [xpdf](http://www.foolabs.com/xpdf/home.html)
*   [表明](http://projects.gnome.org/evince/)
*   [okular](http://okular.kde.org/)

# grails - Groovy 域类中的“public class Foo”与“class Foo”

> ID：692754
> 
> 赞同：2
> 
> 时间：2009-03-28T13:18:04.177
> 
> 标签：grails, groovy, grails-orm

以下 Groovy 代码在写入 grails-app/domain/Foo.groovy 时创建了一个名为 Foo 的 GORM 持久域类：

```
class Foo {
  String someField
} 
```

但是，如果我改为编写“public class Foo”，则该类不会被 GORM 持久化（即没有注入 save() 方法，没有创建数据库表等）：

```
public class Foo {
  String someField
} 
```

我正在运行 Grails (1.1) 的最新稳定版本。

问题：**这是一个错误还是预期的行为？为什么？**

**更新#1：**相关子问题：我是唯一遇到这个问题的人吗？很高兴知道其他人是否能够复制这一点。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T19:00:51.213

听起来像一个错误。

我会将详细信息输入 JIRA 并从源头获取答案。

[http://jira.codehaus.org/browse/GRAILS](http://jira.codehaus.org/browse/GRAILS)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-22T19:06:26.440

Groovy 类默认是公共的（对于 Groovy 方法也是如此），因此如果添加`public`. 但是，我无法在 Grails 1.1.1 中重现此行为/错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-26T04:30:35.837

我在 1.3.3 上没有出现这种行为

检查 DomainClassArtefactHandler.groovy 中的“isDomainClass”方法。你会看到（至少在 1.3.3 中）唯一被排除的类型是闭包和枚举

# c# - COM Interop IDictionary - 如何在 C# 中检索值？

> ID：692760
> 
> 赞同：1
> 
> 时间：2009-03-28T13:21:48.300
> 
> 标签：c#, interop, idictionary

使用：VS2008，C#

我有一个需要在 .NET 项目中使用的 COM dll。在那里，我有一个带有返回 IDictionary 对象的方法的类。IDictionary 是在 COM dll 中定义的，所以我不确定它是否与 .NET 中的 IDictionary 相同。

我的问题：我知道字典键，我想检索值。此 COM dll 的文档提供了经典 ASP 中的代码，例如

```
someValue = oMyDictionary.someDictionaryKey 
```

我的问题：如何检索 C# 中特定键的值？

当我像这样在 C# 中创建 IDictionary 对象时：

```
IDictionary oDictConfig = oAppConfig.GetOptionsDictionary(""); 
```

VS2008 认为这个字典对象（接口）有以下方法和属性：

```
Cast<>
Count
Equals
GetEnumerator
GetHashCode
GetMultiple
GetType
let_Value
OfType<>
Prefix
PutMultiple
ToString 
```

抱歉，如果这是一个愚蠢的问题，但我看不到如何通过键检索值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T13:30:54.940

[IDictionary](http://msdn.microsoft.com/en-us/library/system.collections.idictionary.aspx)在其[成员](http://msdn.microsoft.com/en-us/library/system.collections.idictionary_members.aspx)中有一个 Item 属性，您可以通过 [ ] 访问该属性。

```
var obj = oDictConfig[key]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T13:31:27.060

试试这个：

```
dicObject["myKey"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T15:06:43.930

看起来您正在使用 BizTalk Server 2000 中的 IDictionary COM 接口：

[http://msdn.microsoft.com/en-us/library/ms936717.aspx](http://msdn.microsoft.com/en-us/library/ms936717.aspx)

这个接口还应该有一个 NewEnum 属性（检查 Reflector 中的互操作程序集），它*应该*返回一个 IEnumerable 给你。此 IEnumerable 将是键的枚举，然后您可以使用它来调用 Value 属性（当然使用适当的键）来获取值。

# ruby-on-rails - Rails 分页错误

> ID：692761
> 
> 赞同：0
> 
> 时间：2009-03-28T13:22:01.233
> 
> 标签：ruby-on-rails, pagination

我正在使用 will_paginate 插件，仅当我在服务器上而不是本地运行时才会收到以下错误：

```
undefined method `total_pages' for []:Array
Extracted source (around line #8):

5:  <% session[:page] = params[:page] %>
6:  <h2>Previous Scenario</h2>
7: <% end %>
8:  <%= will_paginate @scenarios, :next_label => 'Older', :prev_label => 'Newer' %>
9: <div class="box">
10: <% for scenario in @scenarios %>
11:     <% @created = scenario.created_at %> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T13:31:38.837

您的控制器是否有等式的另一半，例如

```
@scenario = Scenario.paginate(:page => params[:page]||1) 
```

或者，我认为您可能在服务器端有一个插件，可以将您的 Active Record 集转换为普通数组。我需要更多信息才能看到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T02:57:31.817

不知何故，`@scenarios`对您来说是一个普通的数组，它不能来自`Scenario.paginate()`方法，因为它总是返回一个`WillPaginate::Collection`对象。

# .net - 在默认浏览器中打开 URL 的安全方法是什么？

> ID：692767
> 
> 赞同：2
> 
> 时间：2009-03-28T13:27:19.550
> 
> 标签：.net, security, process

基本上我试图在我的 .NET 应用程序中打开一个 URL。这可以通过以下方式轻松实现：

```
Process.Start("http://www.google.com") 
```

但是在我的情况下，URL 可以由外部用户控制，因此我不希望他们通过注入元字符等来执行系统中的命令。

所以安全的方法是：

*   阅读注册表并查看默认浏览器是什么
*   `New Process()`使用默认浏览器的可执行文件创建
*   提供 URL 作为参数
*   启动流程

在实现这个之前，我只是想确保我没有让这个变得过于复杂。你怎么看？

*我不热衷于对输入实施过滤，这只是一个肮脏的解决方案*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T13:31:01.460

为什么不通过解析它来确保它是一个有效的 HTTP url？

```
Uri target = null;
if ( Uri.TryCreate(userSuppliedString, UriKind.Absolute, out target) &&
      (Uri.UriSchemeHttp == target.Scheme || Uri.UriSchemeHttps == target.Scheme) )
{
  // It's an URI that I can use 
  Process.Start(target.ToString());
} 
```

请注意，此示例不使用 userSupplied 字符串来创建流程。它让 Uri 类格式化传递给 Start 调用的字符串。

您可以扩展方案检查以包括您认为有效的所有方案（例如 FTP）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T13:31:57.887

我宁愿验证输入。使用 Uri 类应该很容易。

# c++ - 指针问题向量

> ID：692779
> 
> 赞同：0
> 
> 时间：2009-03-28T13:33:52.873
> 
> 标签：c++, pointers, vector, opencv, segmentation-fault

我在尝试将自定义类的对象 push_back 到以我的自定义类作为类型的指针向量时遇到了很多麻烦。请参阅下面的代码以及收到的错误。我在 windows xp 上使用带有 CDT 插件和 OpenCV 的 Eclipse。

我花了很多时间试图找到答案，但无济于事！ps我是学生，指针等不是我的事！

```
 std:: vector<RoadLine>* LaneChangeDetector::roadLines(IplImage* img_8uc1, IplImage* img_8uc3, IplImage* img_edge, std::vector <RoadLine>* roadVector){

    CvMemStorage* storage = cvCreateMemStorage(0);
    CvSeq* lines = 0;
    CvMemStorage* roadStorage = cvCreateMemStorage(0);
    CvSeq* roadLines = 0;

    // Probabalistic Hough transform returns line segments from edge detected image
    lines = cvHoughLines2( img_edge, storage, CV_HOUGH_PROBABILISTIC, 1, CV_PI/180, 50, 200, 200 );

    // Sequence roadlines, lines with correct slope are added to this sequence
    roadLines = cvCreateSeq(0, lines->header_size, lines->elem_size, roadStorage);

    // slope
    double m = 0.0;

    // Point of intersection
    CvPoint poi;

    for(int i = 0; i < lines->total; i++ ){
        CvPoint* line = (CvPoint*)cvGetSeqElem(lines,i);
        CvPoint pt1 = line[0];
        CvPoint pt2 = line[1];

        double x1 = double(pt1.x);
        double y1 = double(pt1.y);
        double x2 = double(pt2.x);
        double y2 = double(pt2.y);

        if(pt1.x == pt2.x){
            m = 1.0;
        }
        else{
            m = (double(y2 - y1)/(double(x2 - x1)));
        }

        if( ((m>0.45) && (m<0.75)) || ((m<-0.45) && (m>-0.75)) ){

            // If the slope is between measured parameters add to roadLines sequence for further analysis
            cvSeqPush(roadLines, line);
        }
    }

    // otherRoadLine used for comparison
    CvPoint* otherRoadLine;

    for(int a=0; a<roadLines->total; a++){

        CvPoint* roadLine = (CvPoint*)cvGetSeqElem(roadLines,a);
        CvPoint rl1 = roadLine[0];
        CvPoint rl2 = roadLine[1];
        int lineCount = 0;

        if(a>0){

            // Test the current line against all the previous lines in the sequence.
            // If the current line is far enough away from all other lines then draw it
            for(int b=0; b<a; b++){
                otherRoadLine = (CvPoint*)cvGetSeqElem(roadLines,b);
                if((roadLine->x > ((otherRoadLine->x) + 200)) || (roadLine->x < ((otherRoadLine->x) - 200)) ){
                    lineCount++;
                }
            }
            if(lineCount == a){
                cvLine(img_final, roadLine[0], roadLine[1], CV_RGB(0,0,255), 3, CV_AA, 0 );
                RoadLine myLine = RoadLine(roadLine, 1);
                roadVector->push_back(myLine); //ERROR OCCURS HERE
                cvShowImage("Plate Detection", img_final);
                cvWaitKey(0);
            }
        }
        else{
            cvLine(img_final, roadLine[0], roadLine[1], CV_RGB(0,0,255), 3, CV_AA, 0 );
            RoadLine myLine = RoadLine(roadLine, 1);
            roadVector->push_back(myLine //ERROR OCCURS HERE
            cvShowImage("Plate Detection", img_final);
            cvWaitKey(0);
        }
    }

    if(roadVector->size() >= 2){
        int pos = 0;
        RoadLine line1 = roadVector->at(pos);
        RoadLine line2 = roadVector->at(pos + 1);

        CvPoint* A = line1.line;
        CvPoint p1 = A[0];
        CvPoint p2 = A[1];

        int A1 = p1.y - p2.y;
        int B1 = p1.x - p2.x;
        int C1 = (p1.x*p2.y) - (p1.y*p2.x);

        CvPoint* B = line2.line;
        CvPoint p3 = B[0];
        CvPoint p4 = B[1];

        int A2 = p3.y - p4.y;
        int B2 = p3.x - p4.x;
        int C2 = (p3.x*p4.y) - (p3.y*p4.x);

        int det = A2*B1 - A1*B2;

        if(det == 0){
            printf("Lines are parallel");
        }
        else{
            int x = ( C1*(p3.x - p4.x) - (p1.x - p2.x)*C2 )/det;
            int y = ( C1*(p3.y - p4.y) - (p1.y - p2.y)*C2 )/det;

            poi.x = x;
            poi.y = y;

            horizon = poi.x;

            cvCircle(img_final, poi, 10, CV_RGB(255, 0, 0), 2, CV_AA, 0);
        }
    }

    cvShowImage("Plate Detection", img_final);
    cvWaitKey(0);

    return roadVector;
} 
```

自定义类 RoadLine 可以在这里看到

```
 #include <cv.h>
class RoadLine{
private:
CvPoint* line;
int lane;
public:
RoadLine(CvPoint*, int);
};
RoadLine::RoadLine(CvPoint* aLine, int aLane){
line = aLine;
lane = aLane;
} 
```

从调试中我可以看到“std::vector <RoadLine>* roadVector”正在正确初始化。

这是 Eclipse 告诉我的：

```
3 std::vector<RoadLine, std::allocator<RoadLine> >::push_back() F:\MinGW\include\c++\3.4.5\bits\stl_vector.h:560 0x0043e3f9

4 void std::_Construct<RoadLine, RoadLine>() F:\MinGW\include\c++\3.4.5\bits\stl_construct.h:81 0x0044015d 
```

并且程序跳转到stl_construct.h中的这一段代码

```
 template<typename _T1, typename _T2>
inline void
_Construct(_T1* __p, const _T2& __value)
{
  // _GLIBCXX_RESOLVE_LIB_DEFECTS
  // 402\. wrong new expression in [some_]allocator::construct
  ::new(static_cast<void*>(__p)) _T1(__value); //DEBUG THROWS ME TO THIS LINE
} 
```

再次任何帮助将不胜感激。

干杯

拍

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T13:40:56.803

您不使用指针向量，而是使用对象向量。在这种情况下，您的类需要有一个复制构造函数，因为 push_back 存储对象的副本。

作为一般调试建议，尝试通过删除尽可能多的代码来解决问题，但仍然会看到不正确的行为。尝试找到最简单的失败示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T17:28:24.260

您的新 RoadLine 课程肯定会导致灾难：

```
RoadLine::RoadLine(CvPoint* aLine, int aLane){
    line = aLine;
    lane = aLane;
}

RoadLine::RoadLine(const RoadLine & myRoadLine){
    line = myRoadLine.line;
    lane = 1;
}

RoadLine::~RoadLine(){
    delete line;
} 
```

使用它的代码：

```
 if(lineCount == a){
                                cvLine(img_final, roadLine[0], roadLine[1], CV_RGB(0,0,255), 3, CV_AA, 0 );
                                RoadLine myLine = RoadLine(roadLine, 1);//create object on the Stack
                                roadVector->push_back(myLine); //Push COPY of myLine
                                cvShowImage("Plate Detection", img_final);
                                cvWaitKey(0);
                        }//Stack-based object "myLine" is automatically destroyed here (leaves scope) 
```

“myLine”的自动销毁将删除“myLine.line”（在 RoadLine 的 dtor 中），但“myLine.line”仍然在向量中被引用（你只是推了它）。

您必须制作一个 DEEP COPY 行（如其他人建议的那样），如下所示：

```
RoadLine::RoadLine(const RoadLine & myRoadLine){
    line = new CvPoint(*myRoadLine.line);//assuming CvPoint can be copy-constructed
    lane = 1;
} 
```

或者使用 CvLine 对象而不是指针（或其他东西，需要更多上下文）

编辑：Dirk Gently 的 copy-ctor 有一个错误，因为它会将内存泄漏到前“行”成员应该是：

```
RoadLine& operator=(const RoadLine & o){
     if (this != &o) { //Remember to check for self-assignment.
      delete []line;//delete[] vs. delete !
      line = 0;//if next line throws at least we won't double-delete line
      line = new CvPoint[ 2 ]; //this might throw ! should catch (or redesign to get rid of new (prefered)
      line[ 0 ] = o.line[ 0 ];
      line[ 1 ] = o.line[ 1 ];
      lane = o.lane;
     }
     return *this;
}
//consistent constructor !
RoadLine::RoadLine(CvPoint* aLine, int aLane)
    :line(new CvPoint[2]),//might throw, but its better to throw in initializer ! (if you just have one pointer it might be ok to do it like this)
    lane(aLane)
{
     line[0] = aLine[0];
     line[1] = aLine[1];
}
RoadLine::~RoadLine(){
    delete[] line;//also use delete[] vs. normal delete here !
} 
```

编辑 2：我几乎忘记了我知道它为什么会崩溃！也许您尝试使用 last 和 last+1 CvPoint 构建一对（就像这个明显错误的代码）？

```
CvPoint Pnts[2] = {CvPoint(0,0),CvPoint(1,1)};
Roadline Line(&Pnts[1],1);//tries to access Pnts[2] which is one past end ! 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T13:37:37.233

您的`RoadLine`班级缺少适当的复制员。现在，由于您有一个指向`CvPoint`对象的成员，因此您每次`push_back`. 这可能是不可取的。

```
RoadLine::RoadLine(const RoadLine & o){
     line = new CvPoint[ 2 ]; 
     line[ 0 ] = o.line[ 0 ];
     line[ 1 ] = o.line[ 1 ];
     lane = o.lane;
}

RoadLine& operator=(const RoadLine & o){
     if (this != &o) { //Remember to check for self-assignment.
      line = new CvPoint[ 2 ]; 
      line[ 0 ] = o.line[ 0 ];
      line[ 1 ] = o.line[ 1 ];
      lane = o.lane;
     }
     return *this;
} 
```

缩短代码：尝试隔离问题：

```
int main() {
    CvPoint pa[] = { CvPoint(0, 0), CvPoint(100, 100) };
    RoadLine rl1(pa, 1);

    vector<RoadLine> v;
    v.push_back(rl1);

    return 0;
} 
```

这会崩溃吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T19:21:23.653

C++ 的诀窍是把“~”键想象成又大又红，只要你按下它就会响起警铃，即。每当您考虑向类添加析构函数时。

如果要添加析构函数，则需要复制构造函数和赋值运算符。没有例外。即使您不打算复制对象，您仍然应该在私有部分中声明它们，这样如果不小心使用它们，编译器就会出错。

每当控制对象的生命周期时，您还应该使用引用计数指针而不是原始 C 样式指针（在 C++ 中，这是“RAII”）。如果你这样做，析构函数将从 RoadLine 中消失，而且，神奇的是，你的问题也会消失。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T20:50:43.673

您没有指针向量。

```
std::vector<RoadLine>* roadVector 
```

是一个指向 RoadLine 对象向量的指针。如果你想要一个指针向量，你应该这样做：

```
std::vector<RoadLine*> roadVector 
```

这可能会对您有所帮助（因为向量将不再调用复制构造函数），但您仍然应该按照其他人的建议将它们整理出来。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-28T13:58:49.273

这些类型的错误通常是由不正确的内存管理引起的。可悲的是，您还没有发布如何管理记忆的方式。

如果你可以让它在 linux 系统上运行，你可以尝试在 valgrind 下运行你的程序，这有助于追踪不正确的内存访问/释放。不幸的是，valgrind 在 windows 下不可用，但可能有替代品。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T16:53:47.963

我已将 RoadLine 的类定义更改为：

```
#include <cv.h>

class RoadLine{

private:
    int lane;
public:
    CvPoint* line;
    RoadLine(CvPoint*, int);
    RoadLine(const RoadLine &);
    ~RoadLine();
    RoadLine& operator=(const RoadLine & o);
};

RoadLine::RoadLine(CvPoint* aLine, int aLane){
    line = aLine;
    lane = aLane;
}

RoadLine::RoadLine(const RoadLine & myRoadLine){
    line = new CvPoint[ 2 ]; // CRASHES HERE
    line[ 0 ] = myRoadLine.line[ 0 ];
    line[ 1 ] = myRoadLine.line[ 1 ];
    //line = new CvPoint(*myRoadLine.line);
    lane = myRoadLine.lane;
}

RoadLine::~RoadLine(){
    delete line;
}

RoadLine& RoadLine::operator=(const RoadLine & o){
     if (this != &o) { //Remember to check for self-assignment.
      line = new CvPoint[ 2 ];
      line[ 0 ] = o.line[ 0 ];
      line[ 1 ] = o.line[ 1 ];
      lane = o.lane;
     }
     return *this;
} 
```

这是 RoadLine 类的当前版本

这就是我实现课程的方式：

```
else{
        cvLine(img_final, roadLine[0], roadLine[1], CV_RGB(0,0,255), 3, CV_AA, 0 );
        RoadLine myLine(roadLine, 1);
        roadVector->push_back(myLine); // FROM HERE
        cvShowImage("Plate Detection", img_final);
        cvWaitKey(0);
} 
```

当 push_back 被调用时，它调用复制构造函数，但程序在上面突出显示的地方崩溃

定义了我的向量这一事实有什么不同？

```
std::vector<RoadLine>* roadVector 
```

并且我有一个 CvPoint* 而不是 CvPoint[]

对不起，如果这些看起来很基本的问题

# xml - I18N 的 XML 文档

> ID：692789
> 
> 赞同：5
> 
> 时间：2009-03-28T13:44:19.837
> 
> 标签：xml, localization, internationalization

我即将决定如何处理基于 XML 的 UI 描述格式的国际化。

格式通常如下所示：

```
...
<devif>
  <screen id="scr1" title="Settings for this and that">
    <header text="Climate readings"/>
    <rd setp="123" text="Air temperature" unit="°C"/>
    <rd setp="234" text="Humidity" unit="%RH"/>
    <rd setp="345" text="CO2" unit="ppm"/>

    <header text="Settings"/>
    <wr setp="567" text="Air temperature demand" unit="°C"/>
  </screen>
  ...
</devif> 
```

每个文件包含很多屏幕，最多可达 10.000 行，我们的应用程序中有十几个这样的文件。

我仍然可以更改格式以最适合我们的需要。那么你将如何翻译这个？

我一直在考虑一些可能的方法来处理这个问题：

*   包含英文文本和翻译文本的每种语言的单独文件
*   为每个标签使用一个 ID，并为每个 ID 使用带有翻译文本的单独文件
*   将所有翻译放在同一个文件中

第一个解决方案的问题是英文文本可能会根据上下文翻译成不同的消息。

第二种解决方案使源文件的可读性降低（虽然不是很多），并且它不能轻松处理属性的转换。

一旦文件被翻译成大约 5-6 种语言，第三种解决方案会使文件变得非常大且难以处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T13:59:28.850

我们使用标准的[TMX](https://en.wikipedia.org/wiki/Translation_Memory_eXchange)文件，即标准的 XML 文件来保存国际化的文字。每个条目都由一个标签标识，该标签在代码周围都是引用。每个条目都有所有可能的翻译，最重要的是 TMX 是翻译程序和专业人士使用的标准。

如果您已经有 XML 文件来保存您的文字，您可以通过 XSLT 样式表来转换它们。

以下是格式示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<tmx>
    <body>
        <tu tuid="$ALARM_BARCODE_READER_COMMS">
            <tuv lang="ES">
                <seg>Lector códigos de barras: No Operativo</seg>
            </tuv>
            <tuv lang="EN">
                <seg>Barcode reader: Not operative</seg>
            </tuv>
            <tuv lang="ZH">
                <seg>读卡器：通讯错误</seg>
            </tuv>
        </tu>
        <tu tuid="$ALARM_BARCODE_READER_FAIL">
            <tuv lang="ES">
                <seg>Lector códigos de barras: Fallo</seg>
            </tuv>
            <tuv lang="EN">
                <seg>Barcode Reader: Fail</seg>
            </tuv>
            <tuv lang="ZH">
                <seg>读卡器：故障</seg>
            </tuv>
        </tu>
        <tu tuid="$NO_PAYMENT_MODE_AVAILABLE">
            <tuv lang="ES">
                <seg>No hay sistemas de pago disponibles</seg>
            </tuv>
            <tuv lang="EN">
                <seg>No payment systems available</seg>
            </tuv>
            <tuv lang="ZH">
                <seg>读卡器：故障</seg>
            </tuv>
        </tu>       
        <tu tuid="$ALARM_BLACKLIST_CARD">
            <tuv lang="ES">
                <seg>Tarjeta de pago en lista negra</seg>
            </tuv>
            <tuv lang="EN">
                <seg>Payment card in blacklist</seg>
            </tuv>
            <tuv lang="ZH">
                <seg>付费的ＩＣ卡是黑名单卡&lt;/seg>
            </tuv>
        </tu>
   </body>
</tmx> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T13:50:56.217

为什么不使用 XML 实体来定义必须本地化的术语并且它们对每种语言都有单独的 DTD？这本质上是 Firefox XUL 使用的方法，例如：[MDN 上的本地化](https://developer.mozilla.org/en/XUL_Tutorial/Localization)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T13:57:04.707

我会创建一个模板文件，例如名为“somename.xml.template”

```
<devif>
  <screen id="scr1" title="[SettingsForThisCard]">
    <header text="[ClimateReadings]"/>
    <rd setp="123" text="[AirTemperature]" unit="°C"/>
... 
```

然后，您可以为每种语言创建一堆类似 ini 的文件，其中包含：

SettingsForThisCard=给定语言的信息

然后，您可以将标签替换为从 ini 文件中读取的消息。优点是如果有没有翻译的标签，很容易检测到，不会浪费翻译的精力。此外，它非常简单，因此可能不是满足您特定要求的最佳选择。

# javascript - ASDoc 从哪里获得其内在的类定义？

> ID：692791
> 
> 赞同：2
> 
> 时间：2009-03-28T13:46:54.167
> 
> 标签：javascript, apache-flex, actionscript-3, ant, asdoc

我的意思是内置的 ECMA 对象：String、Number、Object、Function、RegExp、Error、Boolean 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T00:16:40.627

从我对驱动器的广泛搜索中发现，它来自 Flash 安装，如下所示，尽管它可能只是语法 - 突出显示和完成代码。

找到你的 Adob​​e Flash 安装，以下是 CS4，Flash Player 10。

```
c:\Program Files\Adobe\Adobe Flash CS4\Common\Configuration\ActionScript 3.0\FP10\playerglobal.swc 
```

在 WinRAR 或类似文件中打开上面的 .swc，您将看到一个似乎作为服务器参考的 XML 文件，以及一个包含所有代码的 SWF 文件“library.swf”。

希望这可以帮助。

# ruby-on-rails - 渴望从 Rails 中的关联加载 named_scope

> ID：692796
> 
> 赞同：5
> 
> 时间：2009-03-28T13:53:46.710
> 
> 标签：ruby-on-rails

有什么方法可以从关联中急切加载 named_scope 吗？

我有我的文章模型：

```
class Article < ActiveRecord::Base
  has_many :comments
end 
```

和我的评论模型：

```
class Comment < ActiveRecord::Base
  belongs_to :article

  named_scope :approved, :conditions => { :approved => true }
  named_scope :unapproved, :conditions => { :approved => false }
end 
```

我可以急切地加载一篇文章的所有评论：

```
@article = Article.find(params[:id], :include => :comments) 
```

我该如何做同样的事情，但仅限于批准的评论？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T19:51:12.090

~~目前它还没有内置到 Rails 中，但 Ryan Daigle 创建了一个名为 utility_scopes 的插件，它添加了一个 with() 范围，因此您可以执行以下操作：~~

 ~~```
Article.approved.with(:comments) 
```~~ 

博客文章：[http:](http://ryandaigle.com/articles/2008/8/20/named-scope-it-s-not-just-for-conditions-ya-know) //ryandaigle.com/articles/2008/8/20/named-scope-it-s-not-just-for-conditions-ya-know Github Repo：http: [//github.com/yfactorial /utility_scopes](http://github.com/yfactorial/utility_scopes)

 ~~[根据评论更新]

我的错。我读得不够好。我不认为有任何东西可以让您调用这样的名为named_scope 的关联。我能想到的最接近的事情是在文章上创建一个 named_scope：

```
class Article < ActiveRecord::Base
   named_scope :with_approved_comments, {:include => :comments, :conditions => ['comments.approved = ?', true]}
end 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-18T15:46:16.787

另一个答案对我不起作用，因为我必须在某些模型上加载许多关联和这些关联的关联。我发现我有两个选择，将关联更改为具有条件，从而为我想要的每个范围建立关联，或者将它们转换为具有 has_many 关联的类上的方法。我需要按照以下方式做一些事情：

```
@newspaper = Newspaper.find params[:id], :include => {
  :articles => {
    :author => true,
    :source => true
  }
} 
```

所以在我的例子中我改变了：

```
class Newspaper < ActiveRecord::Base
  has_many :articles
end

class Article
  belongs_to :newspaper
  belongs_to :author
  has_one :source

  named_scope :private, :conditions => { :private => true }
  named_scope :public, :conditions => { :private => false }
end 
```

到：

```
class Newspaper < ActiveRecord::Base
  has_many :articles

  def articles_public
    articles.reject &:private
  end

  def articles_private
    articles.select &:private
  end
end

class Article
  belongs_to :newspaper
  belongs_to :author
  has_one :source
end 
```

我发现这种方式更可取，因为我现在可以在查找报纸时急切加载文章，只需将所有 article.private 更改为 article_private。如果我创建了两个关联，例如：

```
has_many :articles_private, :class_name => 'Article', :conditions {:private => true}
has_many :articles_public, :class_name => 'Article', :conditions {:private => false} 
```

在我需要所有相关文章的情况下，我将不得不急切地加载它们。

# php - RealPath 安全吗？

> ID：692799
> 
> 赞同：0
> 
> 时间：2009-03-28T13:59:12.687
> 
> 标签：php, realpath

```
<?php
if (preg_match('/^[a-z0-9]+$/', $_GET['p'])) {
$page = realpath('pages/'.$_GET['p'].'.php');
$tpl = realpath('templates/'.$_GET['p'].'.html');
if ($page && $tpl) {
    include $page;
    include $tpl;
} else {
    include('error.php');
}
}
?> 
```

你会说这有多安全？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:07:40.697

我将它用于模板文件，因此它可以包含“页面”，而不必将单个文件与大量函数/字符串/switch-cases/elseifs（随你选）或创建大量具有相同布局的文件混为一谈。

它检查包含目录的实际路径应该在和要包含的文件的实际路径，如果文件的实际路径以包含目录开头，则允许包含。

```
<?
#If you're worried about funky characters messing with stuff, use this
#preg_replace("/[^A-Za-z0-9_\-]+/","",$str);

if (isset($_REQUEST['page'])) {
    $path=realpath("../inc/page").DIRECTORY_SEPARATOR;
    $full_page=realpath($path.$_REQUEST['page'].".php");
    if (file_exists($full_page)&&(strpos($full_page,$path)===0)) {
        include($full_page);
    } else {
        echo "FAILED";
    }
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T15:20:13.883

好吧，实际上[`realpath`](http://www.php.net/manual/en/function.realpath.php)在这种情况下它不提供任何安全性。实际上，这种情况根本没有任何作用，因为`include`内部会扩展路径。您在这里的安全性实际上取决于[`preg_match`](http://www.php.net/manual/en/function.preg-match.php). 但是请注意，您使用的正则表达式不允许您使用任何带有大写字母、下划线或破折号的页面。

无论如何，我不认为包含基于请求中传递的参数的文件是个好主意。如果您需要，您的设计有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T14:11:01.333

[在这种情况下， realpath](http://php.net/realpath)对您没有帮助，因为`include`可以将页面路径解析为同一文件，无论它是 realpath 还是原始相对文件。它“似乎”是有效的，但我个人不会相信那段代码。我确信有人想出了一种巧妙的方法来将空字符注入输入，从而对字符串终止造成严重破坏。

为了安全起见，您需要做的是保留所有允许的输入/页面的白名单（或黑名单，如果它恰好更适合，但更喜欢白名单）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T14:19:07.350

好像很安全......

但效率不高。在 MVC 中，您有控制器和视图目录预设和预先知道。做一个统计来检查视图/控制器是否存在是没有意义的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T10:40:22.080

[`realpath()`](http://de3.php.net/realpath)在这种情况下实际上会产生一些影响，因为`FALSE`如果目标文件不退出，它将返回。但正如其他海报已经说过的那样——这不会给代码增加任何安全性。

在指定文件不存在的情况下，这是一种错误处理方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T22:12:02.927

我无法评论 PHP realpath，但如果它只是系统 realpath 函数的包装器，那么需要注意一件事：在某些系统（例如 Solaris）上，如果进程在 realpath 执行时收到信号，它将返回空字符串...在这种情况下，您必须确保您的代码设置为处理这种情况（除非 PHP 实现为您解决了该特定困境）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T09:34:40.303

更好地在 $_GET['p'] 上运行 basename()。肯定没有目录遍历攻击。

# django - 如何在没有模板的情况下从 django 视图模拟 HTTP Post 请求

> ID：692802
> 
> 赞同：13
> 
> 时间：2009-03-28T14:00:45.133
> 
> 标签：django, unit-testing, http

我正在写视图，不那么热衷于马上写模板。

但是我需要通过提交发布请求来测试我的程序。

我如何从 django 视图中模拟 HTTP Post

我知道 python 的 urllib2 和 httplib 模块允许很多选项，但我正在寻找可以优雅地集成到 django 视图中的东西。

你会创建一个执行 post 的方法，你会从哪里调用它？

更新：一些答案通过向我的应用程序发送 POST 来处理测试。如果我想 POST 到外部服务并处理 POST 响应怎么办。不写模板怎么办。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-28T14:36:55.280

Django 有一个内置的[模拟客户端实用程序](http://docs.djangoproject.com/en/dev/topics/testing/tools/#making-requests)，可以模拟请求，就好像它们来自浏览器一样。如果您不需要完全模仿浏览器而只想直接从测试中调用视图，请考虑改用[RequestFactory](http://docs.djangoproject.com/en/dev/topics/testing/advanced/#django.test.RequestFactory)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T21:28:18.177

对于这种情况，我认为[RequestFactory](https://docs.djangoproject.com/en/dev/topics/testing/?from=olddocs#django.test.client.RequestFactory)非常适合。

它就像 django 的测试客户端一样工作，不同之处在于它可以让您创建一个可以在任何地方使用的请求对象。因此，您可以创建自己的请求对象并将其传递给您的视图或表单进行测试。

比起使用测试客户端，我更喜欢这种测试方法，因为它更接近于`pure`单元测试。也就是说，测试一段代码。如果您使用的是测试客户端，则在到达您正在测试的实际代码之前会添加更多层。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-17T05:52:54.140

为了避免自己创建请求对象的痛苦，您可以在[Django 片段上使用此技巧](http://www.djangosnippets.org/snippets/963/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T14:20:03.323

听起来您正在寻找单元测试或验收测试。看看 unittest ，它是标准库的一部分。

为了在开发 Web 应用程序时进行快速的临时测试，我喜欢使用 curl。它是一个简单的命令行工具，可以轻松生成各种 HTTP 请求。您可以使用以下命令发布：

```
curl -i -d field=value http://localhost:8080/sample/something 
```

Curl 在很多平台上都可用。[在http://curl.haxx.se/](http://curl.haxx.se/)上查看

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T14:31:26.057

如果您从编写单元测试的上下文中查看这一点，您可以考虑自己创建 Request 对象并直接调用视图函数。你甚至可以模拟它，以及视图可能采用的任何其他参数。

# c# - 使用 Blowfish NET 的 C# 问题：如何从 Uint32[] 转换为 byte[]

> ID：692810
> 
> 赞同：2
> 
> 时间：2009-03-28T14:08:19.733
> 
> 标签：c#, byte, blowfish, uint32

在 C# 中，我使用 Blowfish.NET 2.1.3 的 BlowfishECB.cs 文件（[可以在这里找到](http://www.hotpixel.net/software.html)）

在 C++ 中，它是未知的，但它是相似的。

在 C++ 中，Initialize(blowfish) 过程如下：

```
void cBlowFish::Initialize(BYTE key[], int keybytes) 
```

在 C# 中，Initialize(blowfish) 过程是相同的

```
public void Initialize(byte[] key, int ofs, int len) 
```

这就是问题：

这就是在 C++ 中初始化密钥的方式

```
DWORD keyArray[2] = {0}; //declaration
...some code
blowfish.Initialize((LPBYTE)keyArray, 8); 
```

如您所见，键是一个由两个 DWORD 组成的数组，总共 8 个字节。

在 C# 我这样声明它，但我得到一个错误

```
BlowfishECB blowfish = new BlowfishECB();
UInt32[] keyarray = new UInt32[2];
..some code
blowfish.Initialize(keyarray, 0, 8); 
```

错误是：

参数 '1'：无法从 'uint[]' 转换为 'byte[]'

我究竟做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T14:10:47.480

您可以使用[BitConverter](http://msdn.microsoft.com/en-us/library/1184xdy4.aspx)从 UInt32 获取字节。

* * *

为此，您需要在循环中转换每个元素。我会做类似的事情：

```
`private byte[] ConvertFromUInt32Array(UInt32[] array)
{
    List<byte> results = new List<byte>();
    foreach(UInt32 value in array)
    {
        byte[] converted = BitConverter.GetBytes(value);
        results.AddRange(converted);
    }
    return results.ToArray();
}` 
```

`回去：`

 ````
`private UInt32[] ConvertFromByteArray(byte[] array)
{
    List<UInt32> results = new List<UInt32>();
    for(int i=0;i<array.Length;i += 4)
    {
        byte[] temp = new byte[4];
        for (int j=0;j<4;++j)
            temp[j] = array[i+j];
        results.Add(BitConverter.ToUInt32(temp);
    }
    return results.ToArray();
}` 
```

* * *

 `## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T14:22:53.597

如果您使用的是 VS2008 或 C# 3.5，请尝试以下 LINQ + BitConverter 解决方案

```
var converted = 
  keyArray
    .Select(x => BitConverter.GetBytes(x))
    .SelectMany(x => x)
    .ToArray(); 
```

打破这个

*   Select 将每个 UInt32 转换为 byte[]。结果是一个 IEnumerable<byte[]>
*   SelectMany 调用将 IEnumerable<byte[]> 扁平化为 IEnumerable<byte>
*   ToArray() 只是将可枚举转换为数组

**编辑**同样有效的非 LINQ 解决方案

```
List<byte> list = new List<byte>();
foreach ( UInt32 k in keyArray) {
  list.AddRange(BitConverter.GetBytes(k));
}
return list.ToArray(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-12T11:43:00.693

如果您需要一种**更快**的方法来转换值类型，可以使用我在以下答案中描述的技巧：[将 float[] 转换为 byte[] 的最快方法是什么？](https://stackoverflow.com/questions/619041/what-is-the-fastest-way-to-convert-a-float-to-a-byte/619307#619307)

这种 hack 避免了内存分配和迭代。它为您提供了 O(1) 中数组的不同视图。

当然，只有在性能有问题时才应该使用它（避免过早优化）。

# c# - 如何将文件中的 xml 绑定到 WPF Treeview？

> ID：692812
> 
> 赞同：0
> 
> 时间：2009-03-28T14:09:03.537
> 
> 标签：c#, wpf, xml

我花了一天的大部分时间试图弄清楚这一点。据我了解，我需要使用 XmlDataProvider 但在调试时我发现它不包含任何数据。

有人可以演示如何做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T14:21:41.963

尝试查看[MSDN 上的这篇博文](http://blogs.msdn.com/tolong/archive/2006/12/20/bind-controls-to-rss-feed-using-wpf.aspx)。

在这里，它们绑定到从 RSS 提要中提取的 XML。它非常详细地介绍了整个过程。

# nhibernate - 在 NHibernate 中加载具有多个候选键的实体？

> ID：692834
> 
> 赞同：0
> 
> 时间：2009-03-28T14:34:49.373
> 
> 标签：nhibernate

好的，简单的问题.. :)

在我的门户网站中，我得到了显然需要登录的用户。

我在 MSSQL-DB 中有一张用户表：

*   PK - GUID - 用户 ID
*   CK - nvarchar - 电子邮件
*   CK - nvarchar - 电话号码

现在，我希望用户能够使用他们的电话号码或电子邮件登录到我的网站，因此我需要以某种方式使用电话号码或电子邮件（两者都保证是唯一的）来获取用户。

在 NHibernate 中，ISession 只允许我使用主键（在我的情况下基本上是代理键）加载实体。反正有没有使用候选键加载实体？

我在数据库设计方面非常生疏，所以这可能是糟糕的设计，但我真的认为有这样的方案有点普遍 - 但如果设计糟糕，请告诉我:)

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T15:18:11.547

没有使用过 NHibernate，但是在 Java 中，使用带有一些简单 HQL 的 Session::executeQuery 会获取正确的对象。首先，我假设 Hibernate 的“Session”等同于 NHibernates“ISession”。其次，我假设两者的 HQL 是相同的。如果这两个都是真的，你可能会使用类似的东西：

```
user = isession.executeQuery('from Users where Email = ?'); 
```

或者

```
user = isession.executeQuery('from Users where PhoneNumber = ?'); 
```

同样，因为我没有使用过 NHibernate，所以语法上可能存在一些差异。希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T15:16:55.810

哦，我的..我自己找到了答案:)

把它贴在这里，以防有人遇到同样的问题。

我们需要的是 NHibernate Criterias 或 NQL。我在这里找到了我需要的信息： [http ://www.beansoftware.com/asp.net-tutorials/nhibernate-log4net.aspx](http://www.beansoftware.com/asp.net-tutorials/nhibernate-log4net.aspx)

- 在“查询和标准”下 - 向下滚动大约 4/5。

（不要以为我允许在这里引用信息，所以我最好不要）

# c# - 如何在c#中将具有十六进制内容的字节数组转换为具有十进制的字符串

> ID：692842
> 
> 赞同：0
> 
> 时间：2009-03-28T14:37:36.013
> 
> 标签：c#

语言：C#

基本上我有一个包含十六进制内容的字节数组。

我想将其转换为字符串，并且十六进制内容也应转换为十进制内容。

我的最终字符串应该包含初始字节数组中包含的十六进制值的等效十进制值。

我使用 System.Text.Encoding.GetEncoding(1251).GetString 将字节数组转换为字符串

但是如何将十六进制转换为十进制？即使我们可以在多个步骤中完成它也不是问题。

抱歉问愚蠢的疑问，请备用。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T14:50:29.320

It's not entirely clear what you mean.

Byte arrays just contain byte values - they're just numbers. In other words:

```
byte x = 0x20;
byte y = 32; 
```

are exactly the same - they both just set the value to be 32.

Now, if you want to convert a byte array into a number, look at [`BitConverter`](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx) and its methods like [`BitConverter.ToInt32`](http://msdn.microsoft.com/en-us/library/system.bitconverter.toint32.aspx). That will convert the byte array into a number (an `int` in that particular case) - you can then just call `ToString()` on the number to get a decimal representation as a string.

How many bytes is your original data? That will be a key factor in determining which `BitConverter` method to call. You will also need to know the endianness of the data - if `BitConverter` in "normal" .NET is little endian; you might be interested in the `EndianBitConverter` class in my [MiscUtil library](http://pobox.com/~skeet/csharp/miscutil) if your data is really big-endian.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T14:52:57.363

我有点不确定你想做什么。您是否正在尝试创建一个逗号分隔的十进制数字字符串 - 例如：

```
byte[] hexValues = { 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF };
string decimalValuesAsStringList = string.Join(",", hexValues.Select(i => i.ToString()).ToArray()); 
```

...或者像这样：

```
char[] hexCharacters = { '9', 'A', 'B', 'C', 'D', 'E', 'F' };
byte[] hexValues = hexCharacters.Select(c => Convert.ToByte(c)).ToArray();
string decimalValuesAsStringList = string.Join(",", hexValues.Select(i => Convert.ToInt32(((char)i).ToString(), 16).ToString()).ToArray()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T15:30:41.877

如果您的数组确实包含数字的十六进制表示的字符代码，那么您不必费心解码。由于这些字符的字符代码在所有常规编码中都相同，因此您只需将字节转换为字符即可。

我写了一个将字符流解析为字节流的扩展：

```
static class Hex {

    public static IEnumerable<byte> ParseHex(this IEnumerable<char> chars) {
        int buffer = 0;
        bool first = true;
        foreach (char c in chars) {
            int b = (c - '0') % 32;
            if (b > 9) b -= 7;
            if (first) {
                buffer |= b << 4;
            } else {
                yield return (byte)(buffer | b);
                buffer = 0;
            }
            first = !first;
        }
        if (!first) {
                yield return (byte)buffer;
        }
    }

} 
```

（如果有人识别出部分代码，则基于我在[此](https://stackoverflow.com/questions/684925/what-is-the-best-way-to-convert-a-hexidecimal-string-to-a-byte-array-net/685103#685103)答案中的代码。）

用法：

```
byte[] data = { 48, 70, 51, 67, 70, 56, 48, 55, 57, 49 };

string result = string.Join(",",
    data.Cast<char>().ParseHex().Select(b => b.ToString()).ToArray()
); 
```

# c - 链表还是哈希表？

> ID：692845
> 
> 赞同：2
> 
> 时间：2009-03-28T14:39:33.073
> 
> 标签：c, linux, data-structures

我有一个包含大约 5000 个条目的链接列表（“NOT”同时插入），我正在遍历列表，有时会寻找一个特定的条目（虽然这不是很常见），我是否应该将哈希表视为更佳的选择对于这种情况，替换链表（它是双向链接和线性的）？？在 Linux 中使用 C。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T14:42:50.197

使用哈希表是否更优化取决于用例，您没有详细描述。但更重要的是，确保性能的瓶颈在这部分代码中。如果这段代码只是偶尔被调用一次，而不是在关键路径中，那么费心去修改代码是没有用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T14:52:50.623

如果您没有通过分析器发现代码是应用程序的慢速部分，那么您不应该对此做任何事情。

如果速度很慢，但代码已经过测试、工作且清晰，并且还有其他较慢的领域可以加快速度，请先做这些。

如果它有问题，那么无论如何您都需要修复它，请使用哈希表，因为它会比列表更快。这假设遍历数据的顺序无关紧要，如果您关心插入顺序是什么，那么请坚持使用列表（您可以使用哈希表来做事并保持顺序，但这会使代码更加棘手）。

鉴于您只需要偶尔搜索列表，这成为代码中重要瓶颈的可能性很小。

另一个要查看的数据结构是“跳过列表”，它基本上可以让您跳过列表的大部分。但是，这需要对列表进行排序，这取决于您在做什么，这可能会使代码整体变慢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T14:44:16.747

您是否测量并发现查找对性能有影响？一个`hash_map`或`hash table`应该是好的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T14:52:18.223

如果您需要按顺序遍历列表（不是作为搜索元素的一部分，而是说用于显示它们），那么链表是一个不错的选择。如果您只是存储它们以便您可以查找元素，那么哈希表将大大优于链表（除了最糟糕的哈希函数之外）。

如果您的应用程序需要两种类型的操作，您可能会考虑保留这两种类型，并使用适合特定任务的任何一种。内存开销会很小，因为您只需要在内存中保留每个元素的一份副本，并让数据结构存储指向这些对象的指针。

与您采取的任何优化步骤一样，请确保在进行任何更改之前测量您的代码以找到真正的瓶颈。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T14:43:02.817

如果您关心性能，那么您绝对应该这样做。如果您正在遍历事物以找到具有任何规律性的某个元素，那么使用哈希表将是值得的。但是，如果这是一种罕见的情况，并且列表的普通使用不是搜索，那么就没有理由担心它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-28T14:45:11.813

如果您只遍历集合，我看不到使用哈希图的任何优势。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T17:16:10.123

我建议在几乎所有情况下都不要使用哈希。

有两个原因；首先，哈希的大小是固定的。

其次，更重要的是；哈希算法。你怎么知道你做对了？它将如何处理真实数据而不是测试数据？

我建议使用平衡的 b 树。总是 O(log n)，关于散列算法没有不确定性，也没有大小限制。

# c++ - 卷影复制 (VSS)

> ID：692848
> 
> 赞同：3
> 
> 时间：2009-03-28T14:42:24.050
> 
> 标签：c++, recursion, shadow-copy

任何人都可以澄清一个问题吗？我在自制备份实用程序*中使用 VSS API（使用 VSS2008 的 C++ 和在 XP SP3 上运行的最新 SDK）。

VSS 快照操作适用于没有子文件夹的文件夹 - 即我的电子邮件和 SQL 服务器卷。但是，当我拍摄包含子文件夹的文件夹的快照时，嵌套结构在快照中被“展平”——所有子目录都不存在了。

所以这里有一个问题：我知道在 XP 上对 VSS 的支持有点有限，但是有没有办法指定快照是非递归的？文档不是很有帮助...

*   我真的厌倦了那些花费大量船费并且每隔几天就会失败的垃圾车，所以我想我会自己动手。它会在某个时候进入 CodeProject。如果有人有兴趣让我知道，当它准备好时，你可以有一个（源）副本......

谢谢++

杰瑞

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T19:41:59.283

你的问题令人困惑...

VSS 不能在“文件夹”级别工作。它工作在“音量”级别。

您“捕捉”一个卷，您将拥有一个设备路径，您可以使用文件系统 api（它将自动使用文件系统挂载设备卷）在一个文件上“打开”该设备路径，或者您可以直接访问设备（扇区部门）。

备份快照设备卷上的所有文件应该很容易（不要忘记 NTFS 文件的所有文件流和 ACL），您的问题将是恢复它们...... VSS 不会帮助您恢复。主要问题将是恢复系统卷，您将需要另一个操作系统来启动，如 WinPE 或 DOS 或其他东西。如果您不担心系统卷，那么恢复很容易。

如果您按扇区备份数据，那么您将获得额外的好处，即如果您为它编写一个卷设备驱动程序（看起来像一个卷或 HD），那么 Windows 将为它自动加载一个文件系统驱动程序。这为您提供了一个免费的资源管理器应用程序，这是大多数基于扇区的备份应用程序所做的。它也为他们提供了虚拟机的可能性。

即使您正在进行简单的文件备份，它也有助于了解文件系统（NTFS、FAT 等），以便您知道可以/应该备份和恢复什么。你知道什么是 NTFS 重解析点吗？如果您在备份期间击中了一个，您将如何处理它？您是否知道 Windows 实际如何启动以及需要备份和恢复哪些文件以及“修补”才能有机会启动。在还原时，如何最好地布置 NTFS 卷以免影响还原卷上的 NTFS 性能？您是否要支持将系统卷恢复到新硬件，这需要您做什么才能有机会工作？问题是无止境的。

系统备份/恢复并不容易，有很多边缘情况（请参阅上面的一些问题）直到您遇到它们才知道。

祝你项目好运，我希望我没有让你失望太多，我只是说要交付一个大多数人不知道的备份应用程序还有很多工作要做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-10T13:14:58.707

对上述内容进行评论 - 如果“作家”正在玩 VSS 游戏，那么它将确保文件系统处于正常状态，作为 VSS 设置的一部分。

对于 MS SQL Server - 检查它是否是 VSS 编写器。如果是，那么您的数据库文件快照应该没问题。如果不是，那么它处于所谓的“崩溃状态”。因此，例如，如果您使用 MySQL 或其他一些非 MS、非 VSS 感知 SQL 数据库 - 您的备份可能是连贯的，也可能不是连贯的（“好一个”）。在那种情况下，它可能总比没有好，但它也可能仍然无用。使用 VSS*可能*会导致更好的完整性来进行备份，但文件是打开的，它们是打开的，如果应用程序没有在 VSS 猪圈中播放，那么您可能会或可能不会被软管。

# svn - 我可以返回并编辑 SVN 签入的评论吗？

> ID：692851
> 
> 赞同：59
> 
> 时间：2009-03-28T14:42:54.347
> 
> 标签：svn, tortoisesvn

我在 SVN 的评论中写错了。签入后可以编辑吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-03-28T14:52:12.780

提交消息是[“未版本化的属性”](http://svnbook.red-bean.com/en/1.0/ch05.html#svn-ch-5-sect-1.2)，可以使用[svn propset](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.propset.html)命令更改，例如

```
$ svn propset --revprop -r 25 svn:log "Journaled about trip to New York."
property 'svn:log' set on repository revision '25' 
```

这是在修订版 25 上设置名为“svn:log”的修订版属性

## 配置颠覆以允许修订属性更改

因为这些是未版本化的，所以 subversion 的默认安装不会让您修改这些属性，除非您提供 [pre-revprop-change](http://svnbook.red-bean.com/en/1.4/svn.ref.reposhooks.pre-revprop-change.html)挂钩脚本。

这是一个典型的脚本，来自我系统上的 /var/lib/svn/hooks/pre-revprop-change：

```
#!/bin/sh

REPOS="$1"
REV="$2"
USER="$3"
PROPNAME="$4"
ACTION="$5"

if [ "$ACTION" = "M" -a "$PROPNAME" = "svn:log" ]; then 
  echo "$1 $2 $3 $4 $5" >> /var/lib/svn/logchanges.log
  exit 0; 
fi

echo "Changing revision properties other than svn:log is prohibited" >&2
exit 1 
```

这会记录对 svn:log 修订属性的更改，并允许使用退出 0 进行编辑，使用退出 1 拒绝任何其他修订属性更改。请参阅 patmortech 的 Windows 等效答案。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-03-28T16:17:09.783

要启用修订属性修改，您需要创建 pre-revprop-change 挂钩脚本。可以在这里阅读：[http](http://svnbook.red-bean.com/en/1.0/ch05s02.html) ://svnbook.red-bean.com/en/1.0/ch05s02.html （查找 Hook Scripts 部分）。

对于 Windows，这里是一个示例批处理文件的链接，它只允许更改日志消息（而不是其他属性）：[http](http://ayria.livejournal.com/33438.html) ://ayria.livejournal.com/33438.html 。基本上将下面的代码复制到一个文本文件中，并将其命名为 pre-revprop-change.bat 并将其保存在存储库的 /hooks 子目录中。

```
@ECHO OFF
:: Set all parameters. Even though most are not used, in case you want to add
:: changes that allow, for example, editing of the author or addition of log messages.
set repository=%1
set revision=%2
set userName=%3
set propertyName=%4
set action=%5

:: Only allow the log message to be changed, but not author, etc.
if /I not "%propertyName%" == "svn:log" goto ERROR_PROPNAME

:: Only allow modification of a log message, not addition or deletion.
if /I not "%action%" == "M" goto ERROR_ACTION

:: Make sure that the new svn:log message is not empty.
set bIsEmpty=true
for /f "tokens=*" %%g in ('find /V ""') do (
set bIsEmpty=false
)
if "%bIsEmpty%" == "true" goto ERROR_EMPTY

goto :eof

:ERROR_EMPTY
echo Empty svn:log messages are not allowed. >&2
goto ERROR_EXIT

:ERROR_PROPNAME
echo Only changes to svn:log messages are allowed. >&2
goto ERROR_EXIT

:ERROR_ACTION
echo Only modifications to svn:log revision properties are allowed. >&2
goto ERROR_EXIT

:ERROR_EXIT
exit /b 1 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-19T00:57:19.823

无需创建 pre-revprop-change 挂钩脚本即可快速更改日志消息的一种方法是使用以下`svnadmin` [命令](http://subversion.tigris.org/faq.html#change-log-msg)：

```
svnadmin setlog --bypass-hooks REPOS_PATH -r N FILE 
```

其中`REPOS_PATH`是服务器上存储库的路径（例如 /srv/svn/repository），`N`是修订号（例如 25），FILE 是包含正确提交日志条目的文本文件。

两件事：这需要文件系统访问存储库文件，但创建 pre-revprop-change 钩子脚本也是如此...其次，此命令将绕过可能存在的任何钩子脚本，因此建议使用...

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-30T16:12:05.083

使用 Tortoise SVN 将使这对您来说非常容易。只需打开日志消息窗口，右键单击要编辑的修订日志，然后从上下文菜单中选择编辑日志。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-01-16T02:22:53.530

在 Tortoise SVN 中，您可以按照以下步骤操作。
1\. 转到存储库浏览器。
2\. 右键单击​​要处理的文件夹。
3\. 单击显示日志。
4\. 在修订列表中，选择并右键单击所需的修订。
5\. 单击编辑日志消息。

您现在可以在 svn checkin 修订版中编辑您的评论。

谢谢！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-28T14:46:07.770

```
svn propset svn:log --revprop -r <REVISION> "My corrected log message" <PATH-TO-REPOSITORY> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-02-16T17:13:50.903

在 Eclipse（或 Rational Application Developer）中使用 Subclipse：

选择 Team --> Show History 然后右键单击要更改其评论的修订，然后选择“Set Commit Properties”，您可以更改评论和/或作者。

# .net - 哪个集合用于存储唯一字符串？

> ID：692853
> 
> 赞同：13
> 
> 时间：2009-03-28T14:43:17.340
> 
> 标签：.net, collections, dictionary

我正在寻找一个类似的集合，`Dictionary(OF Key, Value)`但我实际上并不需要键和值。钥匙本身就足够了。所以像`Collection(Key)`. 它不应该接受重复的键。

我在 .NET Framework 中查找了几个集合，但找不到我想要的。目前我一直在滥用`Dictionary(OF String, String)`和设置价值`Nothing`。

我应该继续滥用 Dictionary(OF T,T) 吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-28T14:45:13.700

我认为您想要的是[HashSet<T>](http://msdn.microsoft.com/en-us/library/bb359438.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T14:45:26.493

[HashSet<T>](http://msdn.microsoft.com/en-us/library/bb359438.aspx)将为此工作。它使您可以存储一组唯一的值，而不会“滥用”字典。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T14:45:56.553

[如这个半重复问题](https://stackoverflow.com/questions/669106/best-string-container-stringcollection-collectionstring-liststring-arraylist)中所述，List 会比 Collection 更好。

3.5 中的哈希集会更好。您使用的是哪个版本的 .net？

# reporting-services - 图表图例上的文字可以更改吗？

> ID：692855
> 
> 赞同：1
> 
> 时间：2009-03-28T14:44:17.917
> 
> 标签：reporting-services, reportingservices-2005, ssrs-2008

我有要求在图表上显示前两个月的销售额，访问量等统计数据，当然图例应该显示两个月的名称。我决定将商店表设计为：1）产品一月二月

随着时间的推移，一月二月可以更改为三月，四月。因此，对于这种设计，我认为每个月都会更改列名，并且无法自动绑定数据集。那是对的吗？

2）设计如下：产品M1 M2

M1，M2代表上个月，选择的时候，使用列别名作为月份名称，但是这种情况下，数据集列也会随着时间的推移而变化，我不认为SSRS图表可以绑定数据集的哪些列名称会改变。

那么，如何处理这样的要求，有没有更好的方法呢？我现在用的是ssrs2005，ssrs2008可以处理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-08T17:47:03.280

**您应该右键单击图表中的系列字段，请参见下图** ![您应该右键单击图表中的系列字段，请参见下图](https://i.stack.imgur.com/uZapE.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T04:40:49.180

> 因此，对于这种设计，我认为每个月都会更改列名，并且无法自动绑定数据集。那是对的吗？

正确的。

> M1，M2代表上个月，选择的时候，使用列别名作为月份名称，但是这种情况下，数据集列也会随着时间的推移而变化，我不认为SSRS图表可以绑定数据集的哪些列名称会改变。

数据集列将如何随时间变化？加上M3、M4等？在这种情况下，最好的解决方案是像这样旋转表格：产品、月份、金额。

如果您无法更改表格，那么您将不得不在数据集查询中使用动态 SQL 语句自己轮换表格。您将查询系统表以获取列列表，组装一个 SELECT 语句并执行它。

# sqlite - 在 SQLite 中设置 AUTOINCREMENT 的起始值

> ID：692856
> 
> 赞同：63
> 
> 时间：2009-03-28T14:44:19.053
> 
> 标签：sqlite

如何在 SQLite 中设置 AUTOINCREMENT 字段的起始值？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-03-28T14:50:21.537

从[SQLite 网站](http://www.sqlite.org/autoinc.html)：

> SQLite 使用特殊表跟踪一个表曾经拥有的最大 ROWID `SQLITE_SEQUENCE`。`SQLITE_SEQUENCE`每当创建包含 AUTOINCREMENT 列的普通表时，就会自动创建和初始化该表。`SQLITE_SEQUENCE`可以使用普通的 UPDATE、INSERT 和 DELETE 语句修改表的内容。**但是对这个表进行修改可能会扰乱 AUTOINCREMENT 密钥生成算法。在进行此类更改之前，请确保您知道自己在做什么。**

我试过这个，它的工作原理：

```
UPDATE SQLITE_SEQUENCE SET seq = <n> WHERE name = '<table>' 
```

其中*n* +1 是您想要的下一个 ROWID，*table*是表名。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-28T14:45:31.237

将 显式插入`value-1`表中，然后删除该行。

编辑：下一条评论，讨论`SQLITE_SEQUENCE`直接编辑表格可能更可取：[https ://stackoverflow.com/a/692871/10093](https://stackoverflow.com/a/692871/10093)

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2014-10-13T03:32:00.097

我正在使用下面的查询来解决当 sqlite_sequence 没有表的记录时的问题（即第一条记录尚未添加到表中），否则它会更新序列。

```
BEGIN TRANSACTION;

UPDATE sqlite_sequence SET seq = <n> WHERE name = '<table>';

INSERT INTO sqlite_sequence (name,seq) SELECT '<table>', <n> WHERE NOT EXISTS 
           (SELECT changes() AS change FROM sqlite_sequence WHERE change <> 0);
COMMIT; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-28T14:46:34.523

一种方法是插入第一行，**明确指定要开始的行 id**。SQLite 然后将插入高于前一个最高值的行 ID。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-01-29T12:50:20.443

在使用 SQLITE_SEQUENCE 表的解决方案中，该表的条目似乎是在第一次插入具有自动增量列的表之后添加的。在某些情况下，这可能会导致麻烦（即自动增量仍然从 1 开始，而不是从想要的值开始）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-07-06T05:26:43.070

只是想在 iTech 非常感谢的回答中添加一些注释：

*   sqlite_sequence 中的 name 列区分大小写。（也许只有我一个人，但来自其他数据库，我总是认为字符串比较不区分大小写）。
*   SQLite 似乎很健壮：如果 sqlite_sequence 中的数字错误并且会导致重复的 rowid 值，sqlite 将使用下一个可用数字作为 rowid（使用 sqlite 3.28 检查）
*   如果 sqlite_sequence 中的行被删除，也是如此。
*   我按照评论中的建议使用“从 sqlite_sequence WHERE name = 'table' 中选择名称”而不是检查“changes()”

# c# - C#：多线程和大量 I/O 性能不佳

> ID：692857
> 
> 赞同：2
> 
> 时间：2009-03-28T14:45:06.057
> 
> 标签：c#, performance, multithreading

我用 C# 编写了一个应用程序，可以将 jpgs 从一组目录同时移动到另一组目录（每个固定子目录一个线程）。代码看起来像这样：

```
 string destination = "";
        DirectoryInfo dir = new DirectoryInfo("");
        DirectoryInfo subDirs = dir.GetDirectories();
        foreach (DirectoryInfo d in subDirs)
        {
            FileInfo[] files = subDirs.GetFiles();
            foreach (FileInfo f in files)
            {
                f.MoveTo(destination);
            }
        } 
```

然而，应用程序的性能是可怕的——每秒有大量的页面错误。每个子目录中的文件数量可能会很大，所以我认为一个很大的性能损失来自上下文切换，它不能同时将所有不同的文件数组保存在 RAM 中，这样它就会进入磁盘几乎每次。

我能想到两种不同的解决方案。第一个是用 C 或 C++ 重写这个，第二个是使用多进程而不是多线程。

编辑：文件基于时间戳命名，它们移动到的目录基于该名称。所以他们移动到的目录将对应于它的创建时间；例如 3-27-2009/10。

我们正在为每个目录创建一个后台工作线程以进行线程化。

有什么建议么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-28T14:55:30.960

经验法则，不要将操作与串行依赖项并行化。在这种情况下，您的硬盘驱动器是瓶颈，并且对于许多线程来说只会使性能变得更糟。

如果您要使用线程，请尝试将数量限制为可用资源的数量、内核和硬盘数量，而不是待处理的作业数量、要复制的目录数量。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-28T15:11:44.293

**重新考虑的答案**

我一直在重新考虑下面的原始答案。我仍然怀疑使用更少的线程可能是一个好主意，但是由于您只是在*移动*文件，因此它实际上不应该是 IO 密集型的。仅*列出*文件可能会占用大量磁盘工作。

但是，我怀疑您是否真的耗尽了文件的内存。你有多少内存？进程占用多少内存？您正在使用多少个线程，您有多少个内核？（使用比核心多得多的线程是个坏主意，IMO。）

我建议以下攻击计划：

*   找出瓶颈实际在哪里。尝试获取文件列表但不移动它们。查看磁盘受到的撞击程度以及需要多长时间。
*   尝试不同数量的线程，还有一个目录队列需要处理。
*   密切关注内存使用和垃圾收集。CLR 的 Windows 性能计数器对此很有用。

**原始答案**

用 C 或 C++ 重写无济于事。使用多个进程无济于事。您所做的类似于为单个处理器提供一百个线程 - 除了您使用磁盘来执行此操作。

*如果还*涉及大量计算，则并行化使用 IO 的任务是有意义的，但如果它已经受磁盘限制，要求磁盘同时处理大量文件只会让事情变得更糟。

您可能对我最近运行的基准测试（[描述](http://msmvps.com/blogs/jon_skeet/archive/2009/03/20/benchmarking-io-buffering-vs-streaming.aspx)和[初始结果）感兴趣，测试文件各行的“加密”。](http://msmvps.com/blogs/jon_skeet/archive/2009/03/24/buffering-vs-streaming-benchmark-first-results.aspx)当“加密”级别较低（即它几乎不做任何 CPU 工作）时，最好的结果总是使用单个线程。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-28T14:56:07.513

如果你有一个依赖于系统瓶颈的工作块，在这种情况下是磁盘 IO，你最好不要使用多个线程或进程。您最终要做的就是在等待磁盘时产生大量额外的 CPU 和内存活动。如果您使用单个线程来执行移动，您可能会发现应用程序的性能有所提高。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T15:17:45.323

看来您正在移动一个目录，当然只需重命名/移动目录就足够了。如果您在同一个源和硬盘上，那将是即时的。

也不需要为每个文件捕获所有文件信息，文件名就足够了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T15:18:51.437

性能问题来自硬盘驱动器没有必要用 C/C++ 重做所有事情，也没有多个进程

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T15:30:59.770

您是否正在查看页面错误计数并从中推断内存压力？您可能会发现底层 Win32/OS 文件副本正在使用映射文件/页面错误来完成其工作，并且这些错误无论如何都不是问题的迹象。Window 自己的大部分文件处理都是通过页面错误（例如“加载”可执行代码）完成的——它们本身并不是一件坏事。

如果您*遭受*内存压力，那么我推测它更有可能是由创建大量线程（非常昂贵）引起的，而不是由文件复制引起的。

不要在没有分析的情况下改变任何东西，如果你分析并发现时间花在框架方法上，这些框架方法只是 Win32 函数的包装器（下载框架源代码并看看这些方法是如何工作的），那么不要浪费时间在 C++ 上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T15:03:46.433

如果 GetFiles() 确实返回了大量数据，您可以编写一个枚举器，如下所示：

```
IEnumerable<string> GetFiles(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-25T03:20:17.253

所以，您一次一个地移动文件，从一个子文件夹到另一个子文件夹？当驱动器磁头来回移动时，您不会导致大量磁盘寻道吗？通过将文件读入内存（至少分批，如果不是一次全部），将它们写入磁盘，然后从磁盘中删除原始文件，您可能会获得更好的性能。

而且，如果您在不同的线程中处理多组文件夹，那么您将更多地移动磁盘磁头。这是多线程对您不利的一种情况（尽管如果您有 RAID 或 SAN 等，您可能会获得一些好处）。

如果您正在以某种方式处理文件，那么如果不同的 CPU 可以同时计算多个文件，那么多线程可能会有所帮助。但是你不能让四个 CPU 一次将一个磁头移动到四个不同的位置。

# c++ - TCP：seq / ack 数字是如何生成的？

> ID：692880
> 
> 赞同：20
> 
> 时间：2009-03-28T14:54:47.377
> 
> 标签：c++, networking, tcp, winpcap

我目前正在开发一个程序，该程序可以嗅探从特定地址发送和接收的 TCP 数据包。我想要完成的是用定制的数据包回复某些收到的数据包。我已经完成了解析。我已经可以生成有效的以太网、IP 和——在大多数情况下——TCP 数据包。

我唯一无法弄清楚的是如何确定 seq / ack 数字。

虽然这可能与问题无关，但该程序是使用 WinPCap 用 C++ 编写的。我正在寻求任何可能对我有帮助的提示、文章或其他资源。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-28T15:02:37.420

当建立 TCP 连接时，每一端都会生成一个随机数作为其初始序列号。它是一个强随机数：如果互联网上的任何人都可以猜出序列号，就会存在安全问题，因为他们可以很容易地伪造数据包以注入 TCP 流。

此后，对于传输的每个字节，序列号将增加 1。ACK 字段是来自另一侧的序列号，发送回以确认接收。

[RFC 793](https://www.rfc-editor.org/rfc/rfc793)，原始的 TCP 协议规范，可以提供很大的帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-07-08T10:49:15.493

我有同样的工作要做。首先，初始 seq# 将随机生成（0-4294967297）。然后接收方会统计它接收到的数据的长度，并发送ACK`seq# + length = x`给发送方。然后序列将是 x 并且发送方将发送数据。类似地，接收器将计算长度`x + length = y`并发送 ACK `y`，依此类推……它是如何生成 seq/ack 的……

如果您想实际展示它，请尝试在 Wireshark 中嗅探数据包并跟踪 TCP 流并查看场景...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-28T16:16:50.203

如果我对您的理解正确 - 您正在尝试安装[TCP SEQ 预测攻击](http://www.tech-faq.com/tcp-sequence-prediction.shtml)。如果是这种情况，您将需要研究目标操作系统的[初始序列号](http://www.ietf.org/rfc/rfc1948.txt)生成器的细节。

几乎[所有主要的操作系统都](http://lcamtuf.coredump.cx/newtcp/)存在广泛宣传的漏洞，只要它们的 ISN 生成器是可预测的。我没有密切关注后果，但我的理解是大多数供应商都发布了补丁来[随机化他们的 ISN 增量](http://msdn.microsoft.com/en-us/library/ms819768.aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-28T15:07:01.747

似乎其余的答案几乎解释了在哪里可以找到有关 ACK 的详细和官方信息，即[TCP RFC](https://www.rfc-editor.org/rfc/rfc793)

这是我在进行类似实现时发现的一个更实用且“易于理解”的页面，它也可能有助于[TCP 分析 - 第 2 节：序列和确认号](http://www.firewall.cx/tcp-analysis-section-2.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T15:00:05.193

[RFC 793](http://www.faqs.org/rfcs/rfc793.html)第 3.3 节涵盖序列号。上次我在那个级别编写代码时，我想我们只是为持续存在的序列号保留了一个单计数器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T15:00:42.510

这些值引用了数据包的有效负载开始相对于连接的初始序列号的预期偏移量。

[参考](http://en.wikipedia.org/wiki/Transmission_Control_Protocol)

> 序列号（32 位）——具有双重作用 如果设置了 SYN 标志，则这是初始序列号。实际第一个数据字节的序列号将是这个序列号加 1。如果 SYN 标志没有设置，那么这是第一个数据字节的序列号
> 
> 确认号（32 位）——如果设置了 ACK 标志，则该字段的值是接收器期望的下一个预期字节。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T15:01:03.040

数字是从双方随机生成的，然后增加发送的八位字节（字节）数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-28T14:59:40.997

建立连接后，序号递增。理想情况下，新连接上的初始序列号是随机选择的，但许多操作系统都有一些半随机算法。RFC 是查找更多[TCP RFC](http://www.faqs.org/rfcs/rfc793.html)的最佳场所。

# c++ - 跨平台 C++ IDE？

> ID：692885
> 
> 赞同：5
> 
> 时间：2009-03-28T14:58:05.790
> 
> 标签：c++, ide

我正在寻找具有以下大部分或全部属性的 C++ IDE（嗯，前 4 或 5 个是强制性的）：

1.  跨平台（至少 Mac、Linux）

2.  当然，语法高亮和其他基本的编码编辑器功能

    *   响应迅速的 GUI，在中型（比如 100 个文件）项目上不会太迟钝（我的 Linux 和 Mac 计算机都 5 年了）

    *   代码完成

    *   与集成`gdb`

    *   SVN集成也不错

    *   重构（在整个代码库中半自动重命名变量等）

    *   可以显示类层次结构

    *   可以将超文本样式的链接添加到代码中（因此您可以单击函数/类名，它会将您带到声明），

    *   可以显示（可能）调用我的函数的代码部分（我知道这对于 C++ 来说很难做到，所以我添加了*潜在*的）

到目前为止，我一直在使用[Emacs](http://www.gnu.org/software/emacs/)来处理所有事情，但我认为像最后三个一样为我提供更多概览和搜索功能的高级功能会很好。我厌倦了只在我的代码库上使用`grep`和`find`。

基本上，我想要 Java IDE 通常为 C++ 开发做的大部分事情。

我看到[Netbeans](http://www.netbeans.org/features/cpp/)可用于 C++ 以及[Eclipse](http://www.eclipse.org/cdt/)。我认为它们符合我的要求。有没有人实际使用它们进行日常编码？有什么区别？你有什么经验？[Code::Blocks](http://www.codeblocks.org/)更轻量级，并没有做上面列出的很多事情，对吧？

注意：我不需要 GUI 构建器。

**更新：**对于要点 10，我的意思是我可以给它一个函数名称（例如），它向我展示了在我的代码库中调用`Foo::setValue`这个特定函数（而不是其他同名函数，如 ）的所有事件。`Bar::setValue`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T15:01:25.020

Code::Blocks 执行前 5 个，并且它还具有类方法浏览（尽管不是层次结构显示）。这是一个比 Eclipse 或 NetBeans 更轻量级的解决方案，但如果您喜欢极简主义的方法，它非常好。

总结 CB 与您的要求：

1.  是的
2.  是的
3.  是的
4.  是的
5.  是的
6.  否 - 但您可以轻松添加
7.  不
8.  不，但类似的功能
9.  不
10.  可以从定义到 decl，反之亦然，但没有调用者列表

由于您提到的所有解决方案都是免费的，您可以随时尝试所有解决方案，然后决定坚持使用哪一个。这就是我所做的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T15:22:15.343

除了上面提到的，还有[QTCreator](http://www.qtsoftware.com/products/appdev/developer-tools/developer-tools)，它有“快速代码导航工具”，虽然我没用过。

我认为虽然非必要的要求不是很好，但您可以使用搜索轻松查看调用方法的位置！（当然，如果你有一个巨大的类层次结构，其中每个类都有相同的命名方法，那么你只能怪你自己 :) 如果你没有以易于理解的方式布置你的类）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T15:14:13.960

基于 Java 的 IDE（Netbeans 和 Eclipse）有时有点慢。他们的主要关注点也是Java。Eclipse 的一个问题是它很难用于小屏幕，例如笔记本电脑。我更喜欢通常在 vim + ctags 中工作（执行 grep 和 find 的功能），当我有一些高级操作（例如比较两个目录层次结构）时，我使用 Eclipse。我没有经常使用 Code::Blocks，但我听到了一些关于它的好消息。

来自 Emacs，我认为您更喜欢轻量级而不是重量级的东西。我会认为 Code::Blocks 是一个很好的探索候选者。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T15:20:17.533

我会推荐 Netbeans，在 6.5 中，它非常快的 IDE 并提供了您的所有 10 个要求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-28T15:20:56.237

我最近问了同样的问题。我最终选择了带有 CDT 插件和 Cygwin 库的 Eclipse。我对此非常满意，只是我还没有完全掌握调试器的窍门。在调试透视图中浏览源代码的窗口非常小，出于某种原因，我还没有弄清楚如何查看数组，我想我敲掉了一个用于显示变量的窗口并且不知道如何获取回来了。我最终放弃了调试器的视角，只是在正常的视角下进行调试。

此外，我使用 Eclipse for Java，因此有助于最大限度地减少学习曲线。它可以进行重构，您可以集成 svn。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T15:00:51.947

代码块是开源的！

[http://www.codeblocks.org/](http://www.codeblocks.org/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T15:03:56.213

去日食。如果你有一台像样的电脑，它的速度足够快，而且它的插件有最好的可能性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-28T15:09:22.037

代码块有很多[功能](http://www.codeblocks.org/features)，只需检查它们！它是免费的！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-28T15:28:26.453

如果您已经了解 Emacs，那么开始使用更多的包可能比学习一个全新的 IDE 更容易。

例如，您可以使用 Emacs 轻松执行 #9：只需运行一次标签，然后运行 ​​M-。RET 任何地方。

您还必须权衡 IDE 的功能与您的损失。例如，大多数 IDE 不倾向于具有 Emacs 的简单宏功能或数字前缀，这通常类似于更通用的重构形式。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-28T15:37:51.000

重要的不仅仅是 IDE——您可能需要能够在 IDE 之外构建您的应用程序（即持续集成）。

考虑使用[CMake](http://www.cmake.org/cmake/help/examples.html)创建构建脚本的跨平台描述。一旦你有了 CMake 脚本（这很简单），你就可以从中为你选择的 IDE 生成项目文件——eclipse、kdevelop、Visual Studio、代码块等。

我建议使用 eclipse 作为 IDE。如何在 eclipse 中使用 CMake 的选项很少。到处玩，找到最适合你的。

再一次 - CMake 不仅是**跨平台的**，它也是**跨 IDE 的**。而且 CMake 脚本非常易读，一个简单的 make 文件看起来像这样：

```
project(hello) 
add_executable(hello hello.cpp) 
```

现在将其与 makefile 或在您最喜欢的 IDE 中设置项目进行比较！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-08T19:43:01.090

我的两分钱（没有特别的顺序......而且并非所有这些选项都是c ++）：

1.  Qt ...我的第一个高效的 GUI 构建框架
2.  Lazarus ...多么酷的名字，而且非常高效的工具（虽然不是 c++）
3.  MonoDevelop ...我爱上了 c# 开发（非常像 c++）
4.  Java ...无处不在（有点像 C++）

干杯！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-19T18:49:56.283

Sublime Text Editor 是迄今为止我见过的最好的跨平台编辑器。尝试使用它[http://www.sublimetext.com/](http://www.sublimetext.com/)。它带有无限的演示期，而不会抑制其任何功能。但如果您对此感到满意，请购买并使用它来感谢作者。

# macos - Mac OS X 上有哪些用于制作架构图的软件的选项？

> ID：692888
> 
> 赞同：5
> 
> 时间：2009-03-28T15:00:34.927
> 
> 标签：macos, diagram

我是 OS X 用户。通常，我需要以可视化的方式与经理和开发人员共享架构、工作流和其他数据。

谁能推荐我一些软件并告诉我为什么它很棒？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T15:03:52.220

我喜欢 OmniGraffle 的图表 [http://www.omnigroup.com/applications/omnigraffle/](http://www.omnigroup.com/applications/omnigraffle/) 易于使用，结果看起来很棒，并且支持各种程序员的东西，比如 UML。比visio好很多

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T11:04:29.447

[我是ConceptDraw Pro](http://www.conceptdraw.com/en/products/cd5/main.php)的忠实粉丝

# c++ - 如何为 Linux 编写自己的自定义启动画面？

> ID：692893
> 
> 赞同：7
> 
> 时间：2009-03-28T15:01:08.157
> 
> 标签：c++, c, linux

> 这不是关于普通的无聊定制的问题；我实际上想用源代码等创建一个程序......

我正在考虑编写自己的媒体中心界面，我认为如果我在操作系统加载时编写自己的启动画面会更好看。

*注意：*媒体中心界面将在 X 中运行，但这个问题是关于在 X 服务器加载之前会发生什么。

简单地说，我想制作一个闪屏应用程序来隐藏 linux 内核启动消息。有没有一种方法可以让我在其中编写一些动画，例如某种动画进度条？我假设我无法编写任何 2D/3D 图形（因为那需要 X 运行，对吗？），那么我将如何生成它呢？

我更喜欢在 C++ 中执行此操作，但 C 也是一种选择。

*注意：*我不打算使用任何现有的“主题”或类似的东西，只是对事物的编程方面感兴趣。

### 更新：

一些建议是使用标准图像（.bmp、.jpeg 等），**我对将图像加载**到现有应用程序不感兴趣。但显然我可能想将图像加载到我将制作的启动屏幕应用程序中。

我没有绑定到 Linux 发行版，所以这可以适用于任何东西，尽管 Debian 或基于 Debian 的发行版会很好。

我喜欢关于尽早加载 X 服务器并从那里运行加载屏幕的建议，但是没有更直接的方法吗？当然，您可以制作一个隐藏启动消息并显示自定义程序的程序吗？显然这将是非常低级的编程，但这就是我正在寻找的......

另外，我对更改引导加载程序（LILO、GRUB 等）**不感兴趣。**

### 更新 2：

到目前为止，好的建议是查看像 splashy 和 fbsplash 这样的应用程序的*源代码*。有人可以改进这个建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T15:16:09.117

我会研究[引人注目的](http://splashy.alioth.debian.org/wiki/)源代码。但是你需要用 C 编写代码。

如果你有技能，你可以实现一个基于软件的 3D 引擎（就像过去一样）。一个简单的旋转立方体不应该很难编码，并且有大量的教程。缺点是你会增加启动时间，这在媒体中心不是很愉快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T19:03:42.707

对于图形输出，您可以使用[Linux 帧缓冲区](http://en.wikipedia.org/wiki/Linux_framebuffer)，对于应用程序开发，您可以使用支持直接渲染到帧缓冲区[GtkFB](http://www.linuxdevices.com/articles/AT9024868021.html)的 gtk 。

对于视频等，您可以使用也支持渲染到帧缓冲区的 mplayer。

对于初始化，您必须查看使用的系统，debian 使用 sysv init 样式初始化[http://www.debian-administration.org/articles/212](http://www.debian-administration.org/articles/212)，ubuntu 使用 upstart。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T17:41:09.177

事情是这样的：有一个库/内核补丁[fbsplash](http://fbsplash.berlios.de/wiki/doku.php)，它已经被编写为*完全按照*您想要的方式执行。它将显示一个图像来代替正常的启动消息，它还可以包含一个进度条。当您尝试做一些已经存在完善的开源实现的事情时，没有比查看源代码更好的方法来学习如何自己做。

即使您正在寻找更复杂的东西（例如，如果您想创建一些比进度条更精美的动画），您也可以从 fbsplash 开始并对其进行修改以满足您的需要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T15:20:18.000

有几种方法可以做到这一点。您可以很早就加载 X 服务器，然后编写一个程序来显示启动屏幕。您也可以使用帧缓冲设备。如果您使用 Intel 硬件，或者愿意使用 OSS AMD 驱动程序，或者 Nvidia 的 Nouveau，您可以使用内核模式设置。为此，我会看看 Fedora 的 Plymouth。你可以写一个 Plymouth 插件来显示你的启动画面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T15:08:14.800

初始屏幕只是一个图像（.bmp、.jpg*等*），可以由引导加载程序加载。由于您没有指定您正在使用的发行版，请查看 LILO、grub 或任何合适的发行版。检查`/boot`目录以获取指导您搜索的线索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-09T19:21:33.567

如果您想要做的只是拥有一个带有您自己的启动画面并且绝对没有启动消息的干净启动序列，您可以执行以下操作：

首先，使 grub、启动消息和控制台光标静音：

```
GRUB_CMDLINE_LINUX_DEFAULT = quiet fastboot splash vt.cur_default=1 loglevel=0
GRUB_TIMEOUT               = 0 
```

这将非常快速且无声地（淡入黑色）将您带到您的登录屏幕，您可以在其中放置一个启动画面。您的发行版可能会短暂显示它自己的启动画面，您可以根据需要进行更改。

这产生了一个专业的干净启动序列，没有所有常见的 linux 缺陷和皱纹。（如 OSX 和 Windows）。

我个人将 Ubunutu 与 LXDE 一起使用，即使在较旧的硬件上，也可以在 3 秒内完成干净的启动。

# ruby-on-rails - 在 Rails 中，如何生成不带符号的表单标签，仍然可以创建正确的“for”属性？

> ID：692896
> 
> 赞同：9
> 
> 时间：2009-03-28T15:02:06.220
> 
> 标签：ruby-on-rails, forms

在 Rails 中，如何生成不带符号的表单标签，仍然可以创建正确的“for”属性？

如果我采用这种形式：

```
<% form_for(@thing) do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </p>
  <p>
    <%= f.submit 'Create' %>
  </p>
<% end %> 
```

并对其进行修改以提高该领域预期内容的清晰度：

```
<% form_for(@thing) do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label "What would you like to call your thing?" %><br />
    <%= f.text_field :name %>
  </p>
  <p>
    <%= f.submit 'Create' %>
  </p>
<% end %> 
```

label 标签上的**for**属性将显示“thing_What would you like to call your thing?”，这显然破坏了它与预期合作伙伴字段的关系。

那么如何在保留这种关系的同时更改标签文本呢？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-28T15:22:52.533

```
<%= f.label :name, "What would you like to call your thing?" %> 
```

请参阅[`label`的文档](http://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-label)（以及[APIdock 上](http://apidock.com/rails/ActionView/Helpers/FormBuilder/label)）。

# php - 捕获从 PHP 中的函数返回的数据的最佳方法是什么？

> ID：692904
> 
> 赞同：2
> 
> 时间：2009-03-28T15:03:57.430
> 
> 标签：php, wordpress

我是使用 Wordpress 编程和学习的新手。

```
the_title(); //outputs the title of the page 
```

我想将页面的标题捕获到一个字符串变量中，这样我就可以使用`strtolower`和`str_replace`函数来操作它。

我让它工作的唯一方法是使用输出缓冲。

```
ob_start();
the_title();
$result = ob_get_clean();

echo str_replace(" ","-",strtolower($result));

/*there has got to be an easier way....
i dont fully understand why */

str_replace(" ","-",strtolower(the_title())); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T15:08:03.240

如果您真正要查找的是`wp_title`函数，则它采用的第二个参数是一个布尔值，它是否应该显示它或返回它。将其传递给 false 以便将其返回给 var，然后您可以执行以下操作：

```
$mytitle = wp_title(null, false); 
```

否则，您唯一的选择是找到您要查找的函数并修改源代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T15:07:20.077

没有更简单的方法。您的函数不*返回*字符串，而是*打印*它，因此如果您想捕获输出，则必须使用输出缓冲。

这是以下示例中 f1() 和 f2() 之间的区别。

```
// Returns a string, prints nothing.
function f1() {
    return "String";
}

// Prints a string, returns nothing.
function f2() {
    echo "String";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T15:13:32.510

Wordpress 是一个***可怕***的应用程序来学习如何编程。它使用这些“正常工作”的全局函数，但它们在“循环”内部执行非常具体的任务。正如我所说，这是一个很好的代码应该是什么的可怕例子。

谢天谢地（对你来说）还有其他函数可以返回你正在寻找的部分。而不是我只写你需要的东西，你可以[在这里阅读完整的清单](http://codex.wordpress.org/Function_Reference)。请注意记下哪些必须在神话循环中，哪些可以在任何地方使用。

碰巧有更多的方法来获得标题，但我真的在想象这个例子你会做这样的事情：

```
$this_post = get_post($post); // I *think* $post is the post ID inside the loop though I could be wrong
echo $this_post->post_title; 
```

但正如另一张海报（正确）所说，您可以使用一个相当简单的 wp_title() 函数来获取当前循环标题。

这让我回到了可能想要解释为什么从 Wordpress 学习编程是一个坏主意的问题上。他们有太多该​​死的方法来做同样该死的事情，以至于几乎不可能保持领先地位。

博客是一组非常简单的数据（在 WP 的情况下更是如此，因为它没有完全标准化），但不仅仅是用一种方式来输出标题`<?php echo $post->title; ?>`，你还有很多方式，都在做微妙的不同的事情。

如果你真的想学习如何编程（而不是绕开 WP 内部的废话），创建一个简单的博客引擎是相当快速和有趣的......这当然是很多人进入一门新语言的方式或框架。

如果你*真的*想玩得开心，看看 Django。

* * *

受够了 WordPress 的咆哮。如果您将来要与没有 100 种方法的此类事情作斗争，我真的不建议使用输出缓冲区捕获。它为一些相对简单的事情消耗了大量资源。

最简单的方法可以很简单，只需获取原始函数的源代码，将其粘贴到新函数中并替换`echo`为`return`.

请注意，可能存在一些数据库连接来处理过早返回可能会中断......因此，如果 echo 不是最后一个语句，而不是直接返回，将字符串存储为变量并在函数末尾返回。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T17:27:33.483

只是想我与你们分享我的最终解决方案。

这是为了给我的身体标签在 wordpress 中的唯一 ID。*/

```
$title =wp_title(null,false);
echo strtolower(str_replace(' ','-',ltrim($title)));

//without the ltrim() 2 dashes are created before the title. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T05:19:20.707

Wordpress 中几乎每个 ' `the_*`' 函数都有一个 ' `get_the_*`' 对应项。所以，你只需要使用

```
echo str_replace(" ","-",get_the_title()); 
```

它会像魅力一样发挥作用。还有`get_the_excerpt()`， get_the_content() 和 the_permalink() 以某种方式违反了命名约定（天知道我写了多少次 " `get_the_permalink()`" 并且对它为什么不起作用感到沮丧）

干杯!

# http - HTTP 传输编码和请求

> ID：692910
> 
> 赞同：5
> 
> 时间：2009-03-28T15:07:21.603
> 
> 标签：http, http-headers, transfer-encoding

HTTP 规范规定，请求允许使用 Transfer-Encoding 标头 - 但是如果服务器不理解给定的 Transfer-Encoding，它应该响应什么错误代码。

据我所知，HTTP 标准并未涵盖这种可能性，但也许我只是忽略了它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T15:18:28.097

未知的传输编码应引发 HTTP 错误 501“未实现”。至少 Apache 就是这样做的。

另请参阅[http://argray.com/unixfaq/httpd_error_codes.shtml](http://argray.com/unixfaq/httpd_error_codes.shtml)

**编辑：**指向相应 RFC 部分的指针：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.2](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T12:00:44.017

我同意这个问题的答案并不明显，并且已经跟进了[HTTP WG 的邮件列表](http://lists.w3.org/Archives/Public/ietf-http-wg/2009JanMar/0274.html)。

更新：Björn H. 正确地指出：

> RFC 2616 的第 3.6 节：
> 
> 接收到带有它不理解的传输编码的实体主体的服务器应该返回 501（未实现），并关闭
> 连接。
> 
> 所以它确实已经解决了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T01:09:46.537

主要是个人意见。

我一直认为 5xx 错误是实际的编程错误，就像什么东西摔倒了一样。如果服务器不理解请求，我会说 4xx 错误是更好的响应，因为问题在于请求不是服务器上的失败进程。我不确定是哪个 4xx，但有几个，所以选择一个应该不难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T15:11:35.137

`Transfer-Encoding`HTTP 版本无效的请求格式错误。因此，服务器应以`400 Bad Request`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T13:35:07.937

可以说无法理解分块编码应该是**500 Internal Server Error**而不是 501，因为 RFC-2616 说服务器必须理解它。

但是，如果服务器选择不接受带有分块正文的请求，并且它想为此责备客户端，那么合法的一种方法是**411 Length Required** ——因为不能在以下位置使用 Content-Length 和 Transfer-Encoding同时，无论如何都发送请求是不切实际的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-28T15:10:35.200

RFC 有点不清楚，但恕我直言，它应该是**406 Not Acceptable**。

# design-patterns - 动态响应事件

> ID：692915
> 
> 赞同：0
> 
> 时间：2009-03-28T15:09:38.150
> 
> 标签：design-patterns

我有三个组件。一个 Windows 窗体控件（定制）、一个主类和一个插件类。

该插件会生成一个更新事件，其中应将某些内容添加到控件中。这可能是一个字符串，一个带有 url 的字符串，或者另一个控件，但将来可能是别的东西。

设计这样的东西的最佳方法是什么？

**编辑：**

我应该更清楚一点。我要解决的问题是如何对特定项目做出不同的反应。

例如：插件可能会选择只添加一些文本。它调度一个事件，主类应该调用相应的方法。但是另一个插件可能会选择添加自定义控件，所以主类需要调用不同的方法。

我如何设计主类对特定事件的不同作用的部分。

（顺便说一句，不要太从字面上理解插件这个词。现在，它们只是项目中的类）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T15:57:59.203

听起来很简单。我建议为您的插件类使用接口。

```
interface IPlugin
{
    event EventHandler PluginUpdateEvent;
} 
```

您的表单类或主类将包含一个集合或插件数组，无论需求是什么，并根据需要发现它们 - 通过反射、构造函数注入、配置文件，无论是最好的。

加载插件后，您将确保表单订阅了该插件的 PluginUpdateEvent，并添加一个事件处理程序来处理该事件并向表单添加任何必要的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T16:18:53.553

您可以使用[事件聚合器模式](http://www.martinfowler.com/eaaDev/EventAggregator.html)

另请查看[http://codebetter.com/blogs/jeremy.miller/archive/2007/06/29/build-your-own-cab-11-event-aggregator.aspx](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/29/build-your-own-cab-11-event-aggregator.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-25T04:18:00.737

使用模型-视图-控制设计模式，并在您的视图中传递您希望它们运行的​​ callBackFunctions。看到这个：

```
-- the code is in LUA
-- **** I create an answerBox, and when user tap this answerBox I want to print->"test"

local answerBox = require "view.answerBox"
local test = answerBox:new()
test.init("text for your answerBox", "1", function () print "answerBox was tapped by the user" end) 
```

在 answerBox 类中，我得到该函数并在点击对象时调用它：

```
-- constructor
function new( self, message, id, callBackFunction, obj )
    function callBackFunction( event )            
        callBackFunction(event)
    end
    obj.answerBox:addEventListener( "tap", callBackFunction )
end 
```

使用此结构时要小心。在这个结构中，answerBox 类在 View 中，而 CallBackFunction 在控制器中。您甚至可以使用模型中的一些逻辑而不是`function () print "test" end`

希望这可以帮助。;)

# sql - 带有连接、求和、分组依据等的 SQL 查询

> ID：692916
> 
> 赞同：1
> 
> 时间：2009-03-28T15:10:01.940
> 
> 标签：sql, sql-server

我正在尝试构建一个如下所示的报告：

```
 jan feb mar apr may jun jul ago sep oct nov dec
food   0   1   1   2   0   0   3   1   0   0   1   1
car    1   0   0   0   1   2   1   0   1   2   3   4
home   0   0   1   2   2   2   5   1   2   4   0   0
other  0   0   0   0   0   0   0   0   0   0   0   0 
```

我有两张桌子：`t_item`和`t_value`。`t_item`有 2 列：`itemID`和`itemName`。`t_value`有 3 列：`itemID`, `value`, `date`.

通过以下查询，我可以生成一个包含所有项目的列表，即使是空项目。

```
SELECT t_item.itemID, ISNULL(SUM(t_value.value), 0) AS value
FROM t_value RIGHT OUTER JOIN t_item ON t_value.itemID = t_item.itemID
GROUP BY t_item.itemID 
```

但是，如果我尝试包含一个 MONTH 列（如下所示），结果将只显示具有值的项目......

```
SELECT t_item.itemID, ISNULL(SUM(t_value.value), 0) AS value, MONTH(date) AS date
FROM t_value RIGHT OUTER JOIN t_item ON t_value.itemID = t_item.itemID
GROUP BY t_item.itemID, MONTH(date) 
```

有可能做到吗？如何将没有值的项目包含在结果中并按月分组？

TIA,

鲍勃

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T15:24:17.943

对于数据中的“漏洞”，您需要一个填充表。在月份通过完全外部联接将此表加入到事实表。

```
month
------
month --values jan through dec 
```

对于格式化，您有几个选择。

*   在您的报告工具中使用交叉表或矩阵功能。
*   在 SQL 中使用 CASE 函数。
*   在 SQL 中使用 Pivot 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T15:35:41.723

您是否使用具有类似交叉表功能的报告工具？

如果没有，您可以为每个月创建一个总和列。所以你的结果集实际上看起来像那个报告样本。

```
SELECT t_item.itemID, 

--ISNULL(SUM(t_value.value), 0) AS value, 

sum(case when MONTH(date) = 1 then t_value.value else 0 end) AS m1_sum,
sum(case when MONTH(date) = 2 then t_value.value else 0 end) AS m2_sum,
sum(case when MONTH(date) = 3 then t_value.value else 0 end) AS m3_sum,
--etc

FROM t_value RIGHT OUTER JOIN t_item ON t_value.itemID = t_item.itemID
GROUP BY t_item.itemID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T16:06:23.227

这是一个例子：

```
create table #months (value int, name varchar(12))
create table #items (value int, name varchar(24))
create table #sales (month int, item int, sales int)

insert into #months values (1, 'jan')
insert into #months values (2, 'feb')
insert into #months values (3, 'mar')

insert into #items values (1, 'apple')
insert into #items values (2, 'pear')
insert into #items values (3, 'nut')

insert into #sales values (1,1,12)
insert into #sales values (2,2,3)
insert into #sales values (2,2,5)
insert into #sales values (3,3,7) 
```

您可以使用 PIVOT 表查询它，例如：

```
select *
from (
    select
        item = #items.name
    ,   month = #months.name
    ,   sales = isnull(sum(#sales.sales),0)
    from #months
    cross join #items
    left join #sales on #months.value = #sales.month 
         and #items.value = #sales.item
    group by #months.name, #items.name
) vw
pivot (sum(sales) for month in ([jan],[feb],[mar])) as PivotTable 
```

或者作为替代方案，常规查询：

```
select
    item = #items.name
,   jan = sum(case when #sales.month = 1 then sales else 0 end)
,   feb = sum(case when #sales.month = 2 then sales else 0 end)
,   mar = sum(case when #sales.month = 3 then sales else 0 end)
from #items
left join #sales on #items.value = #sales.item
group by #items.name 
```

两者都导致：

```
item        jan     feb     mar
apple       12      0       0
nut         0       0       7
pear        0       8       0 
```

在第一个示例中，“交叉连接”确保所有月份和值都存在。然后它们被“左连接”，因此即使是没有值的行也会显示出来。

IsNull() 只是为了在该特定商品未售出的一个月内显示 0 而不是 NULL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T16:16:13.497

```
WITH    calendar(mon) AS
        (
        SELECT  1
        UNION ALL
        SELECT  mon + 1
        FROM    calendar
        WHERE   mon < 12
        )
SELECT  itemID, mon, SUM(value)
FROM    calendar c, t_item i
LEFT OUTER JOIN
        t_value v
ON      v.itemID = i.itemID
        AND MONTH(date) = mon
GROUP BY
        i.itemID, mon 
```

# html - 如何对字符串进行 HTML 编码/转义？有内置的吗？

> ID：692921
> 
> 赞同：104
> 
> 时间：2009-03-28T15:12:27.333
> 
> 标签：html, ruby-on-rails, ruby, escaping, encode

我有一个不受信任的字符串，我想在 HTML 页面中显示为文本。我需要将字符 ' `<`' 和 ' `&`' 转义为 HTML 实体。越少吵架越好。

我正在使用 UTF8 并且不需要其他实体来处理重音字母。

Ruby 或 Rails 中是否有内置函数，或者我应该自己滚动？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2010-09-30T13:52:33.240

查看 Ruby [CGI](http://ruby-doc.org/stdlib/libdoc/cgi/rdoc/classes/CGI.html#M000067)类。有一些方法可以对 HTML 和 URL 进行编码和解码。

```
CGI::escapeHTML('Usage: foo "bar" <baz>')
# => "Usage: foo &quot;bar&quot; &lt;baz&gt;" 
```

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2009-03-28T15:14:54.067

`h`辅助方法：

```
<%=h "<p> will be preserved" %> 
```

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2011-06-08T07:43:53.400

在 Ruby on Rails 3 中，HTML 默认会被转义。

对于非转义字符串，请使用：

```
<%= raw "<p>hello world!</p>" %> 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-02-09T11:15:59.717

[ERB::Util.html_escape](http://api.rubyonrails.org/classes/ERB/Util.html#method-c-html_escape)可以在任何地方使用。无需`require`在 Rails 中使用即可使用。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2013-01-28T20:00:55.200

除了克里斯托弗布拉德福德在任何地方使用 HTML 转义的答案之外，由于现在大多数人不使用`CGI`，您还可以使用`Rack`：

```
require 'rack/utils'
Rack::Utils.escape_html('Usage: foo "bar" <baz>') 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-03-29T19:59:47.507

您可以使用`h()`或`html_escape()`，但大多数人`h()`按惯例使用。 `h()`是`html_escape()`导轨中的缩写。

在您的控制器中：

```
@stuff = "<b>Hello World!</b>" 
```

在您看来：

```
<%=h @stuff %> 
```

如果您查看 HTML 源代码：您将看到输出，但实际上并未将数据加粗。即它被编码为`&lt;b&gt;Hello World!&lt;/b&gt;`.

它会显示为`<b>Hello World!</b>`

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2017-02-23T22:06:23.843

不同方法的比较：

```
> CGI::escapeHTML("quote ' double quotes \"")
=> "quote &#39; double quotes &quot;"

> Rack::Utils.escape_html("quote ' double quotes \"")
=> "quote &#x27; double quotes &quot;"

> ERB::Util.html_escape("quote ' double quotes \"")
=> "quote &#39; double quotes &quot;" 
```

我编写了自己的代码以兼容 Rails ActiveMailer 转义：

```
def escape_html(str)
  CGI.escapeHTML(str).gsub("&#39;", "'")
end 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-06T22:11:52.020

`h()`对于转义引号也很有用。

例如，我有一个使用文本字段生成链接的视图`result[r].thtitle`。文本可以包含单引号。如果我没有`result[r].thtitle`在确认方法中转义，Javascript 会中断：

```
&lt;%= link_to_remote "#{result[r].thtitle}", :url=>{ :controller=>:resource,
:action         =>:delete_resourced,
:id     => result[r].id,
:th     => thread,                                                                                                      
:html       =>{:title=> "<= Remove"},                                                       
:confirm    => h("#{result[r].thtitle} will be removed"),                                                   
:method     => :delete %>

&lt;a href="#" onclick="if (confirm('docs: add column &amp;apos;dummy&amp;apos; will be removed')) { new Ajax.Request('/resource/delete_resourced/837?owner=386&amp;th=511', {asynchronous:true, evalScripts:true, method:'delete', parameters:'authenticity_token=' + encodeURIComponent('ou812')}); }; return false;" title="&lt;= Remove">docs: add column 'dummy'</a> 
```

注意：`:html`标题声明被 Rails 神奇地转义了。

# maven-2 - 如何在 NetBeans 6.5 中设置 JBoss Maven 存储库？

> ID：692924
> 
> 赞同：4
> 
> 时间：2009-03-28T15:14:44.143
> 
> 标签：maven-2, netbeans, jboss, maven-plugin, netbeans6.5

[我尝试按照http://wiki.netbeans.org/MavenBestPractices#section-MavenBestPractices](http://wiki.netbeans.org/MavenBestPractices#section-MavenBestPractices-UtilizingAndManagingMavenRepositories)上的指南配置 Maven 插件（版本 4）以在[http://repository.jboss.com/maven2/添加 JBoss Maven 存储库](http://repository.jboss.com/maven2/)[-UtilizingAndManagingMavenRepositories](http://wiki.netbeans.org/MavenBestPractices#section-MavenBestPractices-UtilizingAndManagingMavenRepositories)。

新存储库出现在 Maven 存储库列表中，但我看不到任何项目（工件），更新索引没有帮助。

它看起来像是 Maven 插件的问题。也许它需要一个 JBoss 服务器上不可用的“.index”子目录。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T20:59:18.357

[JBoss 存储库在http://repository.jboss.com/maven2/.index/](http://repository.jboss.com/maven2/.index/)有一个 Nexus 索引。我认为问题在于 Netbeans 可能没有使用该索引。我建议安装 Nexus，将 JBoss 存储库添加到公共组，然后将您的 Netbeans 实例指向 Nexus 的本地实例。

1.  [从http://nexus.sonatype.org](http://nexus.sonatype.org)下载 Nexus

2.  通过在您的机器上解压 tar.gz 或 zip 来安装它

3.  通过运行 bin/jsw//nexus start 启动它

4.  转到[http://localhost:8081/nexus](http://localhost:8081/nexus)

5.  以默认管理员用户身份登录：admin/admin123 是用户名/密码

6.  单击存储库

7.  单击添加... 按钮

8.  为 JBoss 存储库添加一个新存储库，远程位置为：[http ://repository.jboss.com/maven2/](http://repository.jboss.com/maven2/)

9.  保存新的存储库。（您还需要确保选择了下载远程索引）

10.  通过单击公共组并将新的 JBoss 存储库拖动到选定的存储库，将存储库添加到您的公共组。

11.  将 ~/.m2/settings.xml 文件配置为与以下内容相同： http: [//www.sonatype.com/books/nexus-book/reference/maven-sect-single-group.html](http://www.sonatype.com/books/nexus-book/reference/maven-sect-single-group.html)

此时，您的所有存储库请求都将通过 Nexus。Nexus 已经为 Central 提供了代理存储库。因此，您所做的只是添加到 JBoss 存储库中，然后将其添加到公共组中。一旦你这样做了，你会发现你的构建会变得非常非常快。

# makefile - 子项目的主 Makefile 不会编译子项目

> ID：692925
> 
> 赞同：3
> 
> 时间：2009-03-28T15:14:53.053
> 
> 标签：makefile, compilation

我有一个正在发布的项目，它实际上包含 3 个子项目，所有这些子项目都需要一次性编译。我的 makefile 大致如下所示：

```
all: a b c

a:
    @cd a && make

b:
    @cd b && make

c:
    @cd c && make 
```

项目 A 和 B 都编译得很好，但是对于第三个项目，它告诉我没有什么可做的，尽管切换到 C 目录并运行 make 实际上可以编译代码。

更具体一点：上例中的项目 C 实际上是 Mozilla 的 SpiderMonkey。A 和 B 是我编写的代码/makefile，而 C 只是来自 Mozilla 网站的 SpiderMonkey 的原始副本。它的实际编译命令是：

```
make JS_DIST=/usr JS_THREADSAFE=1 JS_HAS_FILE_OBJECT=1 
```

在我的主 Makefile 中，我有：

```
spidermonkey:
    @cd spidermonkey/src && $(MAKE) JS_DIST=/usr JS_THREADSAFE=1 JS_HAS_FILE_OBJECT=1 
```

运行“make spidermonkey”会输出“make: Nothing to be done for `spidermonkey'。” 如何让 make 运行命令？

编辑：我尝试将以下行添加到我的生成文件中：

```
.PHONY: spidermonkey 
```

以及将 spidermonkey 规则重命名为 sm，但仍然没有变化。

编辑：我的错！当我应该有一个标签时，我有空格。哦！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T15:34:02.833

您可能在顶层有一个名为“spidermonkey”的文件或目录。Make认为这是它应该创造的东西，既然它已经在那里，那就停下来。

编写 makefile 时要遵循的最重要规则之一是**每个目标都应该创建一个与目标同名的文件**。换句话说，如果你有

```
 a:
       <some command> 
```

该命令应该生成一个名为“a”的文件。

不生成文件但仅作为占位符存在的规则称为**伪目标**，它们应该这样声明：

```
 .PHONY: a 
```

然后 Make 将始终假定 a 必须重新制作。

此外，作为一般规则**，不要使用“make”来递归调用 make，而是使用 $(MAKE)**。

编辑：将“伪”更改为“假”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T15:31:05.930

Make 只检查与规则目标名称相同的文件（或目录）是否存在，如果存在（并且它比依赖项更新），那么从 make 的角度来看，没有什么可做的了。

所以你的问题是你有一个 spidermonkey 规则（没有依赖项）以及一个名为 spidermonkey 的目录，然后 make 认为“目标已经完成，我无所事事”。要让 make 做你想做的事，重命名 spidermonkey 规则（或目录）。

顺便说一下递归 make，这不一定是一个好主意，请参阅[Recursive Make Considered Harmful](http://miller.emu.id.au/pmiller/books/rmch/)。

# iphone - 覆盖数据库或更新（iPhone）？

> ID：692928
> 
> 赞同：0
> 
> 时间：2009-03-28T15:15:34.890
> 
> 标签：iphone, objective-c, cocoa, sqlite

我有一个基于内容的只读 iPhone 应用程序。用户可以选择我需要跟踪的喜欢的主题。我想通过 App Store 在应用更新之间提供一些主题。在 App Store 更新可用之前，我需要跟踪用户是否下载了这些特定主题。这种方法将包含两个用于用户跟踪的表。所有其他表格主要包含静态内容，保存任何新下载的条目。

在我开始跟踪用户内容之前，我总是将数据库部署在应用程序更新上。覆盖 - 简单。但现在我需要跟踪某些用户配置。与其尝试跟踪用户拥有的应用程序版本并以正确的顺序运行 sql 脚本列表，因此用户处于正确的数据库版本，我想使用两个数据库。一个包含静态内容，另一个包含用户数据。静态内容数据库总是被覆盖。这让事情变得简单。该数据库目前为 250kb。它会长得很慢。

我还计划使用 SDK 3.0 推送通知和点对点，它将任何用户配置数据存储在用户数据库中。

有人看到这种方法有问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T17:13:50.833

这对我来说听起来不错。如果您使用的是 SQLite，您可能需要查看该`ATTACH DATABASE`命令，该命令可让您在同一连接上保持两个数据库打开。

# .net - MS StyleCop 和 CruiseControl.NET

> ID：692931
> 
> 赞同：16
> 
> 时间：2009-03-28T15:17:28.553
> 
> 标签：.net, cruisecontrol.net, stylecop

我想知道是否有人尝试将 StyleCop 集成到 CruiseControl.NET 中。

有人知道吗？或者至少有人创建并发布了一个 xsl 文件，用于在 CCNet 的仪表板上显示 StyleCop 结果？

编辑：我找到了这个[项目](http://stylecopcmd.wiki.sourceforge.net/Building+StyleCopCmd)，它为 StyleCop 提供了 cmd 接口，以 xml 格式生成结果，还提供了用于将此 xml 转换为 html 的 xsl。现在把这些东西和CCNet放在一起。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-02-17T18:04:53.640

2009 年 10 月 5 日，Yves Tremblay向 CCNET 社区添加了一个不错的[StyleCop 集成。](http://confluence.public.thoughtworks.org/display/CCNETCOMM/StyleCop+4.3+Integration)我们从 StyleCopCmd 切换到此解决方案，并没有后悔。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-29T07:58:07.430

我一直在使用 StyleCop 作为[TeamCity](http://www.jetbrains.com/teamcity/)构建环境的一部分。

（TeamCity 类似于 CruiseControl.NET，但具有良好的文档，几乎零需要使用 Xml 配置文件。）

我为 StyleCop 编写了自己的前端来完成这项工作。

见[http://www.nichesoftware.co.nz/content/stylecop-cmd](http://www.nichesoftware.co.nz/content/stylecop-cmd)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T19:01:19.857

[MSBuild 扩展包](http://msbuildextensionpack.codeplex.com/)

支持 StyleCop....

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-28T16:22:13.577

也许这可以帮助你：[http ://stylecopcmd.wiki.sourceforge.net/](http://stylecopcmd.wiki.sourceforge.net/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-02-04T19:47:02.300

您不需要为您的 CI 产品做任何特定的事情。
StyleCop 开箱即用地集成得很好：

你只需要做两件事一次：

*   将一些 StyleCop 文件放入您的项目文件夹（并放入源代码管理！）
*   在解决方案中的每个 .csproj 文件中添加两行。

这使得 StyleCop 可以在每次编译时运行，无论是在 Visual Studio 中完成还是直接使用 MSBuild 在任何机器上完成，而无需安装任何东西。

任何违反 StyleCop 规则的行为都会导致编译错误，因此如果您的代码不符合 StyleCop 的规则，则完整构建将失败。

以下是如何设置的解释：http: [//blogs.msdn.com/b/sourceanalysis/archive/2008/05/24/source-analysis-msbuild-integration.aspx](http://blogs.msdn.com/b/sourceanalysis/archive/2008/05/24/source-analysis-msbuild-integration.aspx) *（尤其是最后一段，“团队发展” )*

# c - 在 21 天内自学 C

> ID：692932
> 
> 赞同：2
> 
> 时间：2009-03-28T15:17:42.030
> 
> 标签：c

在过去的两年半里，我一直在（断断续续地）学习 C，从像 k&r 这样的书。我很快意识到我发现我发现散文很难理解等等。我先读了《21天自学C》这本书，但我什至看不懂。现在我对如何使用 C 的基础知识有了相当的了解（这不包括指针/结构，但基本设计）我正在考虑在 21 天内再次阅读自学 C，从指针开始，所以我可以开始从事程序工作。我没有完成k&r，因为它的散文和一些练习的难度。我认识很多人，他们甚至没有使用书籍来学习如何编码。所以，我在问，如果有人认为我刚读完这本 21 天的书，然后从那里往前走是个好主意，

它的散文很容易理解，我真的很想进入一些项目，在那里我可能会意识到自己的某些陷阱。

你能给我任何建议吗？我不着急，但我渴望把事情做好！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T15:24:40.003

K&R 是学习 C 语言的最佳书籍，IMO。

我同意[Peter Norvig](http://norvig.com/21-days.html)的观点：21 天内不可能精通任何事情。你要做的就是感受一下语法，这样你就可以开始编写简单的程序了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-28T15:21:55.297

我认为您需要尽快开始编写一些简单的程序。尝试你所知道的并适应它。然后阅读新章节并尝试一下。

编写代码使其栩栩如生。看书很枯燥。我有时会从头到尾读一本书来学习一门新语言，但这只是因为我现在已经学了很多语言，所以我没有学习概念——只是语法和奇怪的新功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T00:53:00.603

===根据我的个人经验和IMO，您正在倒退。**从你好世界开始！**===

当我学习一门新的编程语言时，我不只是说我“会学习这门语言，因为我听说它很好学”。我**需要**有一个学习语言的**理由。**否则，如果我没有理由学习该语言，我将不会学习或保留我读到的有关新编程语言的任何内容。

**我边做边学**，这就是为什么我从做[“hello world”示例](http://en.wikipedia.org/wiki/Hello_world)开始。

C 不是对用户最友好的语言，也没有很多“简单的小程序”可以实现并做一些很酷的事情……这就是它很难进入的原因。

这就是为什么我认为**你真的需要一个好的动机来学习 C。**

现在你的当前动机是“我应该学习 C，因为人们说学习 C 很好”......我认为这不足以成为学习 C 的动机。**一个建议是编写 GTK GUI在 C 中的应用程序......这将教你很多关于 C 的知识，最终产品将是非常具体和酷的东西（因此是一个很好的动力）。**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T15:35:43.890

最快的学习方法是需要知道它。如果您有需要解决的问题，例如，您需要为社区的足球队计算最佳锦标赛顺序，那么您将更有动力学习如何解决问题。在你学习的过程中，你最终会遇到一个又一个的困难，但它们的形式总是“我的程序不做 x”而不是“我真的没有得到 x”。每次修正每个缺点的练习都会教你关于语言的新知识**以及如何使用它们**。心中有一个明确的目标，一路上取得许多小成功，这将让你保持精力充沛，并为你的学习提供积极的反馈。

K&R C 书将为您提供使用 C 习语解决问题的正确工具。

如果您需要一些通用的想法来解决问题，请尝试[projecteuler.net](http://projecteuler.net)，或在此处搜索有关堆栈溢出的相关问题

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T15:37:52.187

天哪，2.5 年似乎是一个非常长的时间！我曾经是一家商业培训公司的讲师，我们的 C 课程涵盖了整个语言，包括函数指针之类的“高级”内容，只用了 4 天！你觉得哪一点特别困难？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-28T15:33:17.237

K&R 是一本很棒的书（也许这就是您赚取 C 所需要的全部）您所需要的只是一些耐心和努力

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T15:40:29.153

通过在 K&R 中做练习来利用这 21 天。

先选容易的。当你遇到困难时，你可以问 Stackoverflow。;)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-28T15:44:33.293

学习 C 的最佳方法是将正在学习的主题付诸实践。

例如，如果您正在学习循环和 if 语句等基本原理，您可以自己构建一个小程序来模拟自动售货机上的变化计数功能。

一旦你转向更高级的主题，如指针和数据结构，你就可以构建一个 Logo 类程序。用户可以输入海龟运动的每一步，您可以将其存储在链表中。之后，您可以通过删除、反转或添加节点来对数据结构执行指针操作。

所以这个想法是开始编码来测试你学到的东西。你会发现有些时候你并没有真正理解，即使在书中看起来很清楚。作为一名优秀的程序员，您最终将不得不重新审视这些主题，直到您真正了解它为止。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-28T16:04:55.663

在 21 天内自学 C 就像在 2 分钟内自学手枪安全。两者的结果都是不确定的，除了 C 缺乏安全或解除机制。

实际上，要达到对精通的任何定义，都需要两年的大部分时间。您将通过反复射击自己的脚来获得这一点，同时学习使用 C 解决实际问题的决心。

发现眨眼需要 9 个月的大部分时间，而眨眼是一个非常复杂的过程，C 并不总是本能的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-28T16:41:15.903

我认为你必须使用一些像 GWT 这样的库，因为当我们看到如何使用其他人的代码时，我们会学到更多。做一些 UI 比编写控制台应用程序更有动力。操作 Windows、Button、CheckBox 比操作 int、float、double 更有趣（而且没那么难）。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-03-28T15:25:01.670

首先，如果你完全没有编程经验，21天是学不会一门语言的。你最多需要几个月。

另一方面，如果你有编程经验，我认为你能做的最好的事情就是找到一本“食谱”，就像[这里](http://pleac.sf.net)提供的那样。我认为 Deitel 有类似 C 食谱的东西，你应该访问他们的网站看看。找到这样的书后，您必须开始编写代码，各种代码，以涵盖您在项目中可能遇到的大多数问题：内存管理/数据结构、输入/输出、网络等。

祝你好运！

# ruby-on-rails - Rails ActiveRecord 关系

> ID：692945
> 
> 赞同：1
> 
> 时间：2009-03-28T15:22:46.043
> 
> 标签：ruby-on-rails, ruby, database, activerecord

当仅更改模型时，这些关系如何神奇地发挥作用？

**如果我想要一个“has__and___belongs___to__many”关系，我应该为包含两个外键的表命名（以便 Rails 可以使用它）？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T15:26:41.387

这是有效的，因为您遵循“约定优于配置”。

如果您声明一个客户模型有很多订单，那么 rails 预计订单表上有一个 customer_id 字段。

如果您遵循了这些约定，那么 rails 将使用它们并能够构建必要的 SQL 来查找给定客户的所有订单。

如果您在开发应用程序时查看 development.log 文件，您将能够看到正在构建的必要 SQL 以选择给定客户的所有订单。

没有您的要求，Rails 不会创建表。通过生成将为您创建/更改表的迁移来实现表的创建。您创建一个客户模型，然后在其中声明它 has_many :orders 不会为您创建一个订单表。您需要在迁移中自己执行此操作以创建订单表。在该迁移中，您将需要添加 customer_id 列或使用 belongs_to: customer 语句将 customer_id 字段添加到订单表中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T16:14:09.167

简短的回答：你不能只告诉模型它们是相关的；数据库中也必须有列。

当您设置相关模型时，Rails 假定您遵循了允许它找到您编写的内容的约定。这是发生的事情：

1.  你摆好桌子。

    遵循 Rails 中的约定，您可以以特定的、可预测的方式命名表（复数名词，例如`people`）。在此表中，当您与另一个表有关系时，您必须创建该列并以另一种可预测的方式命名（例如`bank_account_id`，如果您与该`bank_accounts`表相关）。

2.  你编写了一个继承自 ActiveRecord::Base 的模型类

    `class Person < ActiveRecord::Base`

    当您实例化其中一个模型时，ActiveRecord::Base 构造函数会查看类的名称，将其转换为小写字母并将其复数。在这里，通过读取`Person`，它会产生`people`我们之前创建的表的名称。现在 ActiveRecord 知道从哪里获取有关一个人的所有信息，并且它可以读取 SQL 输出以确定列是什么。

3.  您将关系添加到模型`has_many`：`belongs_to`或`has_one`。

    当您键入类似的内容时`has_many :bank_accounts`，它会假设一些事情：

    1.  您关联的模型名称是 BankAccount （来自 camel-casing `:bank_accounts`）。

    2.  `people`表中涉及银行帐户的列的名称是`bank_account_id`（来自单数化`:bank_accounts`）。

    3.  由于关系是`has_many`，ActiveRecord 知道给你方法，比如`john.bank_accounts`，使用复数名称来表示事物。

将所有这些放在一起，ActiveRecord 知道如何进行 SQL 查询，从而为您提供一个人的银行帐户。它知道在哪里可以找到所有内容，因为您遵循了在创建表及其列时它理解的命名约定。

Ruby 的优点之一是您可以在整个类上运行方法，并且这些方法可以将其他方法添加到类中。这正是`has_many`和朋友们正在做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T16:49:47.257

[导轨指南](http://guides.rubyonrails.org/association_basics.html)非常有用

# iphone - 访问 iPhone/iPod Touch 中的 ANT 无线和 GPS 接收器模块

> ID：692950
> 
> 赞同：1
> 
> 时间：2009-03-28T15:24:59.067
> 
> 标签：iphone, gps, ipod, nike, antplus

我是 iPhone/iPod-touch 新手，想使用内置的[ANT](http://www.thisisant.com)无线电编写一个 iPhone 应用程序。我发现 iPhone 和 iPod Touch 都有一个 ANT 无线模块，用于[Nike+iPod Sport Kit](http://www.apple.com/de/ipod/nike)中的 Nike 传感器与 iPhone/iPod 的连接。

经过一些谷歌搜索，我没有找到太多（一篇[文章](http://www.cs.washington.edu/research/systems/nikeipod/tracker-paper.pdf)很有趣，但不是我要找的）。

所以我的问题：

*   是否可以访问 iPhone/iPod Touch 中内置的 ANT Wireless 设备？
*   是否可以访问 iPhone 中的内置 GPS 模块？
*   是否有一些 API 或 SDK 提供对 ANT 或 GPS 模块的访问？

我可以想象，Apple 并不急于开放对所有 iPhone 功能的访问。但至少 GPS 模块应该可以访问。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T17:30:42.307

GPS 无线电只能通过核心位置 API 访问，这将为您提供所需精度级别的纬度和经度修复，但不提供对无线电的任何低级别访问。使用公共 API 无法使用 ANT 收音机，尽管可以在越狱电话上与它通话。但是，任何此类应用程序都无法通过 App Store 分发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T17:29:41.560

没有 API 可以利用 ANT 协议。但是，有一个 API 可以利用集成 GPS，称为核心位置，并且相当容易使用。

即将推出的 SDK 3.0 支持通过电缆和蓝牙连接连接到外部设备。

# web - 什么网络照片库软件可以满足我所有的挑剔要求？

> ID：692952
> 
> 赞同：1
> 
> 时间：2009-03-28T15:25:58.173
> 
> 标签：web, photo, image-gallery, photo-management

我有一组照片（大约 30,000 张），我想把它们放到网上。多年来，我曾尝试过使用静态图片库、Gallery2 等应用程序和自卷脚本来执行此操作。没有一个工作得那么好，因为我的要求很繁琐，但看起来这应该是一个已解决的问题。

我的照片目前`YYYY-MM-DD short album title`使用[Digikam](http://www.digikam.org)组织到名为的文件夹中。

我需要一个系统：

1.  是免费软件，本质上是功能完整的，并且有一个活跃的开发者社区。
2.  允许自动添加和更新新照片和相册，与将`rsync`我计算机上的源目录连接到 Web 服务器并重新扫描相比，只需很少的手动干预。
3.  允许访问者发表评论
    1.  允许重新验证码或等效的垃圾邮件过滤和批量审核这些评论。
4.  从 IPTC 关键字字段读取标签。
    1.  如果发现一个名为“朋友”的标签，则要求用户输入密码才能查看。
    2.  如果发现一个名为“family”的标签，则要求用户输入不同的密码才能查看。
    3.  如果它找到一个名为“private”的标签，则根本不显示照片，或者更好的是，不会将其上传到实时网络服务器。
5.  从 IPTC Caption 字段中读取说明。
6.  创建健全的永久链接，例如`http://example.com/2009/03/28/shortalbumtitle/IMG_0001.jpg`

我承认我可能会要求一些不存在的东西，但我希望它确实存在。

我承认答案可能类似于“使用 Django 并编写自己不存在的代码”，在这种情况下您有什么提示吗？:)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T15:35:40.927

使用 Django 并编写自己不存在的代码。

严重地。我本来打算写的，当我看到你自己写的时候不想写，但如果你对它有任何熟悉，它确实是最有意义的！

1.  我将从 django-photologue 2 开始。获取一个带有标签和评论的基本画廊。您将需要几个 pl 的可选依赖项。
2.  然后我会编写一个自定义导入包装器，它允许您同步到一个目录并更新您的库。
3.  评论是在内部处理的（我认为是通过 photologue），但如果不是，那么有很多评论应用程序“正常工作”。有一个 recaptcha 脚本，它只是另一个表单域。
4.  PIL 可以读取 IPTC
5.  URL 结构由您决定 =)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-17T17:19:24.767

我终于开始做这件事了。我正在使用本地 python 脚本使用 pyexiv2 提取图像元数据（标签、标题和时间戳），然后根据其 EXIF 方向标签（如果合适）使用 PIL 旋转图像，并将文件层次结构导出到临时目录，其中rsync 将其上传到我的主机，远程 python 脚本（实际上是 Django 应用程序）将元数据导入 Django DB。

# jquery - 使用 jquery 选择类的问题

> ID：692959
> 
> 赞同：0
> 
> 时间：2009-03-28T15:32:21.090
> 
> 标签：jquery, multithreading, comments, css-selectors, each

我一直在用头撞墙试图让这项工作有一段时间了。我正在尝试将评论正文缩短为一行以进行紧凑的评论预览。我正在使用 jquery .each 函数来遍历我的线程评论系统中的每个 .cbody （评论正文），并将其放在 chead 内的 cshort div 中。它应该可以工作，但我不能在第一行选择 cshort 类。非常感谢任何帮助。据我所见，我的 jquery 应该是这样的：

```
$('.cbody').each(function(Ind1){
         var str = $(this).text();
         $(this).parent().siblings('.chead').next('.cshort').html(str); 
    });
}); 
```

这是评论的html：

```
<ul>
<li>
<div id="23">
<a name="23">
</a>
<div class="chead">
<a href="#" class="unord">
<img src="images/plus.gif" border="0">
</a>
<a href="userinfo.php?user=muuuuuuuu">
<img src="include/avatar/n.jpg" border="0">
</a>
<span style="display: none;" class="uname">
usersname
</span>
&nbsp;,

<span class="cshort">
</span>
<span class="votes_up" id="votes_up23">
2
</span>
-
<span class="votes_down" id="votes_down23">
0
</span>
<span class="vote_buttons" id="vote_buttons23">
<a href="javascript:;" class="vote_up" id="23">
</a>
<a href="javascript:;" class="vote_down" id="23">
</a>
</span>
</div>
<div class="cbody">
<br>
The comment text funny lol
</div>
<a style="display: none;" href="#" class="reply" id="23">
Reply
</a>
<a style="display: none;" href="#21" class="cparent">
Parent
</a>
</div>
</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T15:38:49.827

cbody 的父母似乎没有兄弟姐妹，所以有点

```
$(this).parent().siblings('.chead') 
```

没有返回任何东西，你很可能想要

```
$(this).parent().find('.chead') 
```

或者

```
$(this).siblings('.chead') 
```

要最直接地访问 cshort，请使用

```
$(this).parent().find('.cshort') 
```

编辑：

您的 HTML 层次结构如下所示：

```
ul
| li
| | div#23
| | | a
| | | div.chead
| | | div.cbody
| | | ... 
```

*   `$(this)`指 cbody
*   `$(this).parent()`指 div#23
*   `$(this).parent().siblings()`返回的所有其他子节点`li`（在您的示例代码的情况下为空）
*   `$(this).siblings()`指 div.chead 和一些`a`元素

由于 chead 是 cbody 的兄弟，因此选择它的最佳方法是

```
$(this).siblings('.chead') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T15:39:00.623

尝试改变这个：

```
$(this).parent().siblings('.chead').next('.cshort').html(str); 
```

对此：

```
$(this).siblings('.chead').children('.cshort').html(str); 
```

`.chead`并且`.cbody`是兄弟姐妹，所以你不需要看`.cbody`' 的父母。此外，`.cshort`是 的孩子`.chead`，因此您查看`.chead`的是 的孩子，而不是其兄弟姐妹（通过`.next`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T15:40:33.880

不应该追加最后一个方法吗？

.html(str) 每次都会替换它，你只会得到最后一个。

# php - 如何使用PHP将网页放入变量中

> ID：692962
> 
> 赞同：1
> 
> 时间：2009-03-28T15:34:37.530
> 
> 标签：php, authentication, curl, file-get-contents

我想从网上下载一个页面，当您使用像 Firefox 这样的简单浏览器时允许这样做，但是当我使用“file_get_contents”时，服务器拒绝并回复它理解命令但不允许这样的下载。

那么该怎么办？我想我在一些脚本（在 Perl 上）中看到了一种通过创建用户代理和 cookie 使您的脚本像一个真正的浏览器的方法，这使服务器认为您的脚本是一个真正的 Web 浏览器。

有没有人对此有任何想法，如何做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-28T15:37:36.960

使用卷曲。

```
<?php
        // create curl resource
        $ch = curl_init();

        // set url
        curl_setopt($ch, CURLOPT_URL, "example.com");

        //return the transfer as a string
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

        // set the UA
        curl_setopt($ch, CURLOPT_USERAGENT, 'My App (http://www.example.com/)');

        // Alternatively, lie, and pretend to be a browser
        // curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

        // $output contains the output string
        $output = curl_exec($ch);

        // close curl resource to free up system resources
        curl_close($ch);     
?> 
```

（来自[http://uk.php.net/manual/en/curl.examples-basic.php](http://uk.php.net/manual/en/curl.examples-basic.php)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T16:28:01.287

是的，CUrl 在获取页面内容方面非常好。[我将它与DOMDocument](http://us2.php.net/domdocument)和[DOMXPath](http://us2.php.net/domxpath)等类一起使用，以将内容研磨成可用的形式。

```
function __construct($useragent,$url)
    {
        $this->useragent='Firefox (WindowsXP) - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.'.$useragent;
        $this->url=$url;

        $ch = curl_init();
        curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
        curl_setopt($ch, CURLOPT_URL,$url);
        curl_setopt($ch, CURLOPT_FAILONERROR, true);
        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
        curl_setopt($ch, CURLOPT_AUTOREFERER, true);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
        curl_setopt($ch, CURLOPT_TIMEOUT, 10);
        $html= curl_exec($ch);
        $dom = new DOMDocument();
        @$dom->loadHTML($html);
        $this->xpath = new DOMXPath($dom);
    }
...
public function displayResults($site)
$data=$this->path[0]->length;
    for($i=0;$i<$data;$i++)
    {   
    $delData=$this->path[0]->item($i);

    //setting the href and title properties 
$urlSite=$delData->getElementsByTagName('a')->item(0)->getAttribute('href'); 
                $titleSite=$delData->getElementsByTagName('a')->item(0)->nodeValue;

    //setting the saves and additoinal
                  $saves=$delData->getElementsByTagName('span')->item(0)->nodeValue;
    if ($saves==NULL)
    {
        $saves=0;
    }

    //build the array
    $this->newSiteBookmark[$i]['source']='delicious.com';
    $this->newSiteBookmark[$i]['url']=$urlSite;
    $this->newSiteBookmark[$i]['title']=$titleSite;
    $this->newSiteBookmark[$i]['saves']=$saves;

                } 
```

后者是从*delicious.com*抓取数据的类的一部分。虽然不是很合法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T15:59:38.857

该答案将您对 Rich 答案的评论牢记在心。

该站点可能正在使用 HTTP 引用或用户代理字符串检查您是否是真实用户。尝试为您的 curl 设置这些：

```
 //pretend you came from their site already
curl_setopt($ch, CURLOPT_REFERER, 'http://domainofthesite.com');
 //pretend you are firefox 3.06 running on windows Vista
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.6) Gecko/2009011913 Firefox/3.0.6'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T16:17:08.177

另一种方法（尽管其他人指出了更好的方法）是使用 PHP 的 fopen() 函数，如下所示：

```
$handle = fopen("http://www.example.com/", "r");//open specified URL for reading 
```

如果 cURL 不可用，它特别有用。

# nhibernate - NHibernate：分组和计数

> ID：692975
> 
> 赞同：4
> 
> 时间：2009-03-28T15:40:58.450
> 
> 标签：nhibernate

我有一个 User、Book 和 UserBooks 关联表。像这样的 UserBooks 表

```
|UserID | BookID  | Status    |
   1        34      Read
   1        35      Unread 
   2        34      Read
   2        70      Read
   2        32      Unread  
   ................... 
```

我的域类是**User**、**Book**和**UserBook**。在 NHibernate 中，我如何获得用户阅读次数最多的前 10 本书及其阅读次数？

十大阅读书籍

```
| BookID | ReadCount |
   34         2
   70         1
   ............... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-28T17:26:01.287

假设您使用复合元素来映射您的 UserBook 类：

```
var top10Books = session
    .CreateQuery(@"select b.Book 
                   from User u 
                   join fetch u.Books b 
                   where b.Status = :status")
    .SetParameter("status", "Read")
    .SetMaxResults(10)
    .SetResultTransformer(CriteriaSpecification.DistinctRootEntity)
    .List<Book>(); 
```

这是完整源代码的[链接。](http://snipt.org/Pgo)

编辑：

我看到您需要阅读一本书的次数。这是查询：

```
var top = session
    .CreateQuery(@"select b.Book, count(b.Book.Id) 
                   from User u join fetch u.Books b 
                   where b.Status = :status 
                   group by b.Book")
    .SetParameter("status", "Read")
    .SetMaxResults(10)
    .List<object[]>();

    foreach (var item in top)
    {
        var book = (Book)item[0];
        var readCount = (long)item[1];
        Console.WriteLine("book id: {0}, read count: {1}", book.Id, readCount);
    } 
```

# delphi - 如何检测鼠标未移动且按钮仍被按下？

> ID：692976
> 
> 赞同：1
> 
> 时间：2009-03-28T15:41:09.293
> 
> 标签：delphi, scrollbar, onchange, mousepress

在 Delphi 中，我在表单的右侧添加了一个滚动条组件（垂直方向）。

我添加了一个 Scrollbar OnChange 事件，因此当用户用鼠标单击 UpArrow 或 DownArrow 按钮时，我可以更改表单的视图和滚动条拇指的位置，这很好用。

但是 OnChange 事件似乎仅在最初在箭头上按下鼠标按钮时才会触发。

我注意到所有滚动条控件都重复命令并继续滚动，而鼠标仍然按下箭头，我想实现这种行为。

那么如何轻松检测用户是否没有移动鼠标并在鼠标停留在箭头上方时继续按下鼠标按钮？

* * *

结论。不知何故，我项目中滚动条中的某些内容已损坏。在我删除 ScrollBar 并再次添加后，问题就消失了。

这是我花了很多时间解决的棘手问题之一。谢谢你的帮助。我要结束这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T15:46:23.197

使用**OnScroll**事件。

只要鼠标按住滚动条箭头按钮，以下代码就会将“xxx”添加到备忘录中。用德尔福 6 测试。

```
procedure TForm1.ScrollBar1Scroll(Sender: TObject; ScrollCode: TScrollCode;
  var ScrollPos: Integer);
begin
    Memo1.Lines.Add( 'xxx' );
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T16:30:25.477

处理自动重复的常用方法是启用*TTimer*并在*OnTimer()*事件处理程序中检查是否需要再次执行操作，如果不需要，则停用计时器。如果您需要示例代码，我似乎记得[SynEdit](http://synedit.sourceforge.net/)控件在拖放操作中使用了类似的自动滚动技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T16:42:10.143

如果一个组件没有封装您正在寻找的行为，并且您无法使用可用的方法轻松地模拟该行为，那么您实际上应该将最接近的组件子类化为您需要的大部分功能并添加缺少的行为。

我知道这涉及到一些额外的工作，但这确实是更好的方法。现在使用 Delphi，我似乎记得子类化组件还需要一些额外的工作才能从 IDE 中用于表单设计，也许从版本 7 开始这已经改变了。

# c# - Linq to Sql：向结果添加附加数据

> ID：692978
> 
> 赞同：2
> 
> 时间：2009-03-28T15:42:18.243
> 
> 标签：c#, linq-to-sql, iqueryable

在这里遇到了奇怪的情况。尝试在某个位置（纬度/经度）的特定范围内从 sql 数据库中提取汽车，然后返回一个 IQueryable 以在结果集上执行附加逻辑。

```
public IQueryable<Car> QueryAllCarsByDistance(float latitude, float longitude, int distance)
{
    var cars = from car in QueryAllCars()
               join i in sqlContext.QueryContactsByDistance(latitude, longitude, distance)
               on car.ContactId equals i.Id
               orderby i.Distance
               select car;

    return cars;
} 
```

QueryContactByDistance 是 SQL 数据库中的一个函数，QueryAllCars 只返回数据库中的所有汽车。

我现在的问题是：如何将距离（i.Distance）附加到汽车？我不想选择新车{距离 = i.Distance, Id = car.Id, ... }。但是如何将这个附加值附加到汽车对象上呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T15:49:39.083

不幸的是，没有办法做到这一点。对于大多数正常的编码目的，C# 和 VB.Net 发出的类型**定义是不可变的。**不能在运行时添加或删除字段和属性。

您所能做的就是创建一个包装 Car 类型并提供附加属性的新类型。或者创建一个具有所有所需属性的 AnonymousType。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T15:57:10.657

解决此问题的一种方法是您可以为此设置一个部分类（如果您还没有）向其添加一个名为 DistanceToReferencePoint 的新属性，然后在查询中将该属性设置为距离，然后它不会保存在数据库中但是会给你访问它。

# ios - 用户退出时如何保存当前标签栏项目并在重新启动时重新加载到该项目？

> ID：692979
> 
> 赞同：3
> 
> 时间：2009-03-28T15:43:50.283
> 
> 标签：ios, objective-c, iphone, cocoa, cocoa-touch

我想在用户退出应用程序时保存用户所在的当前选项卡，以便在用户重新进入应用程序时加载该选项卡并突出显示该应用程序。

我想我在我的应用程序委托中使用以下方法来保存当前选项卡

`- (void)applicationWillTerminate:(UIApplication *)application`

但是我如何访问当前选项卡 - 重新加载它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T17:24:02.010

在 applicationWillTerminate 中，将 tabbarcontroller 的 selectedIndex 保存为默认值。

```
 [[NSUserDefaults standardUserDefaults] setInteger:[tabBarController selectedIndex] forKey:@"tabBarIndex"]; 
```

然后在启动时，从 NSDefaults 中读取索引，然后设置选项卡。

```
 setIndex = [[NSUserDefaults standardUserDefaults] objectForKey:@"tabBarIndex"];
    [[NSUserDefaults standardUserDefaults] synchronize]; 
```

setIndex 是一个 NSUInteger。然后在 viewDidLoad 中设置 TabBarController，如下所示：

```
[tabBarController selectedIndex:setIndex]; 
```

这是来自记忆，因此您需要尝试一下，但这是一般方法。

干杯，乔丹

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-23T03:25:42.493

乔丹的回答对我有用，除了 selectedIndex 是一个属性，而不是一个方法；所以：

```
tabBarController.selectedIndex = setIndex; 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-28T17:16:22.543

UITabBarController 有一个属性，它会给你当前选择的视图控制器的索引；如果您在终止时将其保存到 NSUserDefaults 并在应用程序再次启动时恢复它，这将恢复用户的选择。

我故意在这里含糊其辞，因为 UITabBarController 和 NSUserDefaults 的详细信息都在文档中，在向其他人寻求帮助之前，您需要学习阅读这些内容。您需要的所有其他内容都应该在您的 Xcode 文档浏览器中，或者，如果您尚未安装文档，请访问[http://developer.apple.com](http://developer.apple.com)。

# c# - TransactedInstaller 与嵌套安装程序

> ID：692986
> 
> 赞同：3
> 
> 时间：2009-03-28T15:48:54.280
> 
> 标签：c#, installation, service-installer

这之间有区别吗（嵌套安装程序）

```
ServiceInstaller si = new ServiceInstaller();
si.ServiceName = "MyService";

ServiceProcessInstaller spi = new ServiceProcessInstaller();
spi.Account = ServiceAccount.LocalSystem;

spi.Installers.Add(si);

this.Installers.Add(spi); 
```

还有这个？(TransactedInstaller)

```
TransactedInstaller ti = new TransactedInstaller();

ServiceInstaller si = new ServiceInstaller();
si.ServiceName = "MyService";
ti.Installers.Add(si);

ServiceProcessInstaller spi = new ServiceProcessInstaller();
spi.Account = ServiceAccount.LocalSystem;
ti.Installers.Add(spi);

this.Installers.Add(ti); 
```

嵌套安装程序是否默认进行交易？应该首选哪种风格？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T10:07:53.977

*如果自定义操作成功/失败， ***TransactedInstaller将自动调用 Commit/Rollback。****

 *使用***嵌套安装程序***，您将需要在发生错误时对回滚/提交进行排序，如果您没有明确告诉它们运行，它们将不会被调用。

# servlets - WEB-INF 在 Java EE Web 应用程序中代表什么？

> ID：692988
> 
> 赞同：62
> 
> 时间：2009-03-28T15:49:48.490
> 
> 标签：servlets, jakarta-ee, web-applications, web-inf

互联网上的大多数地方都说它代表**WEB INF**格式。

我比较怀疑。该文件夹包含可执行文件。**信息**不是它的合适名称。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-28T16:02:22.987

据我所知，正如您所说，“INF”代表“信息”。它可能是因为与JAR 文件中`WEB-INF`的目录相似而命名的。`META-INF`有时，目录的含义会随着时间的推移发生很大变化，以至于它不再有意义。例如，`bin`Unix/Linux 中的目录通常包含非二进制“可执行”文件，例如 shell 脚本。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-28T16:02:57.553

我相信它真的被命名为WEB-INF来镜像一个jar文件中的META-INF目录，其中包含元信息。我确实明白你的意思是关于可执行文件和“信息”一样多，但重点是它不包含应用程序的文档。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-07-02T23:53:03.947

它是一个存储私有应用程序内容的目录。您的应用程序需要但您的客户端不需要的任何东西都可以存储在那里。该目录中的任何内容对网络都是不可见的。

来源：

[http://tomcat.apache.org/tomcat-7.0-doc/appdev/source.html#Directory_Structure](http://tomcat.apache.org/tomcat-7.0-doc/appdev/source.html#Directory_Structure) [http://docs.oracle.com/cd/E13222_01/wls/docs70/webapp/basics.html#136976](http://docs.oracle.com/cd/E13222_01/wls/docs70/webapp/basics.html#136976)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-10-21T13:18:42.507

我认为，唯一合乎逻辑的定义是 WEB-INF 是 META-INF 的镜像。命名对于初学者来说非常重要，如果它令人困惑，那么这个主题就会变得越来越难以理解。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-18T11:03:56.690

该`WEB_INF`文件夹包含`web.xml`（部署描述符）文件、类、外部库等，并且`web.xml`文件包含有关容器 url、文件等的信息，该文件夹称为`WEB-INF`.

# apache - htaccess 重定向

> ID：692989
> 
> 赞同：0
> 
> 时间：2009-03-28T15:50:56.227
> 
> 标签：apache, .htaccess, redirect

这就是我试图用 htaccess 做的事情：

*   强制从 url 中删除 www
*   能够使用 http://website.com/site/ 来访问 http://website.com/site.php，并且强制最后一个斜线，即使它不是由用户添加的。所以如果我写 http://website.com/site 它将被转换为 http://website.com/site/
*   还将 http://website.com/download.php?=file.exe 翻译成 http://website.com/download/file.exe。也将 http://website.com/news.php?article=43532 改成 http://website.com/news/article/43532

htaccess 代码不应该包含将要使用的域。

多年来，我一直试图在网上找到类似的东西，但我只找到每个部分，它们不能一起工作。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T16:15:55.247

只是把这些从我的脑海中写下来，他们可能有错误......但认为 jist 是正确的。如果有错误请评论，我会看看。

对于 www 位：

```
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

网站位：

```
RewriteRule ^([^/]*)$ /$1/ [R=301,L]
RewriteRule ^([^/]*/)$ /$1.php 
```

下载：

```
RewriteRule ^download/(.+)$ /download.php?file=$1 
```

消息

```
RewriteRule ^news/article/([0-9]+)$ /news.php?article=$1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T22:38:02.020

好的，这是我的尝试。请注意，[Apache 手册](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)非常好。我在“站点”部分与[benlumley不同。](https://stackoverflow.com/questions/692989/htaccess-redirect/693028#693028)此外，如果您的新闻文章名称不全是数字，您可能只想替换`([0-9]+)`为。`(.+)`

```
# Ensure that rewriting is enabled
RewriteEngine on

# First strip the www as benlumley did
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

# Then convert /site to /site/, reflecting the change in the address bar
RewriteRule ^([^/.]+)$ /$1/ [R=301,L]
# Finally map /site/ to /site.php
RewriteRule ^([^/.]+)/$ /$1.php

# Finally, fix download and news as benlumley did
RewriteRule ^download/(.+)$ /download.php?file=$1
RewriteRule ^news/article/([0-9]+)$ /news.php?article=$1 
```

**编辑**：修复了“strip www”部分的复制/粘贴错误。

**注意**：现在需要将您拥有的任何`<link href="...">`或标记指定为绝对路径，因为您已经有效地更改了页面出现的目录。`<script src="...">`

例如，考虑 blog.php 中的以下行：

```
<link rel="stylesheet" type="text/css" href="style.css"> 
```

以前浏览器看到[http://site/blog.php](http://site/blog.php)并因此尝试检索[http://site/style.css](http://site/style.css)，这很有效。

现在浏览器看到的是[http://site/blog/](http://site/blog/)，上面的相对 URL 被解释为[http://site/blog/style.css](http://site/blog/style.css)，它不存在。因此，href 需要更改为：

```
<link rel="stylesheet" type="text/css" href="/style.css"> 
```

# java - 在java中验证嵌套字符串

> ID：692996
> 
> 赞同：1
> 
> 时间：2009-03-28T15:56:41.017
> 
> 标签：java, validation, nested

嗨，在 java 中验证嵌套字符串的最佳方法是什么？

示例有效字符串是 [aaaa{bbb}] 而 [{ss]} 不是。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T16:07:01.430

我会使用堆栈。遍历字符串中的字符，每次看到左大括号时，我都会将相应的右大括号压入堆栈。每次看到右大括号时，我都会检查它是否与堆栈顶部匹配。如果是这样，我从堆栈中弹出角色并继续前进。否则，它是一个无效的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T16:08:20.757

通过“{”和“}”拆分字符串，同时将令牌推入堆栈。在您到达最后一个“}”时查看是否所有内容都已检查完毕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T16:05:20.873

恐怕你必须比这更具体一点。如果您只是在寻找某个子字符串，那么`String.contains()`如果您想验证“aaabbb cccddd eeefff”之类的内容，您必须检查每个子字符串是否恰好三个字母，那么这是正则表达式的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T16:14:58.900

我喜欢堆栈答案，但根据有效字符串的规则，这可能会变得复杂。如果您可以构造一个语法来描述有效的字符串，您可能会使用类似[ANTLR](http://www.antlr.org/)的东西生成一个解析器。*``~~********