# StackOverflow 问答 000366000-000366999

# facebook - 从个人资料框链接到应用程序选项卡（Facebook 应用程序）

> ID：366005
> 
> 赞同：2
> 
> 时间：2008-12-14T00:48:50.153
> 
> 标签：facebook

我想从我的应用程序的窄配置文件框中放置一个链接到同一配置文件上的应用程序选项卡。

我已经梳理了 FBML 文档，但无济于事。我已经在 Facebook 开发者论坛上发布了这个问题。我已经尝试将选项卡的 URL 粘贴到配置文件框链接中，但没有成功（ajax 可能会妨碍您？）。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-08-30T22:31:05.083

你很久以前问过这个问题，但它在谷歌中的一些搜索词排名很好，所以这里是：

要链接到特定的个人资料选项卡，您可以在锚点中使用以下 href

facebook.com/profile.php?id=123456&v=app_654321

显然，您需要用正确的值替换配置文件 ID 和应用程序 ID。

使用新的短网址，您可以使用此 href

facebook.com/shorturl?v=app_654321

两者都将加载已选择您的应用程序选项卡的用户个人资料。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-16T12:43:49.580

这是可能的，但不是 profile.php ......它总是重定向到页面墙，无论 v 参数如何。我知道的唯一方法是提供直接链接，即。

[http://www.facebook.com/MichaelJordan?v=info](http://www.facebook.com/MichaelJordan?v=info)

问题是你必须在链接中知道这个名字（MichaelJordan）。

要转到应用程序的选项卡，您需要参数 v=app_APPID

# web-services - 现实生活中的 Atom 发布协议

> ID：366013
> 
> 赞同：12
> 
> 时间：2008-12-14T00:55:47.797
> 
> 标签：web-services, language-agnostic, atompub

我知道一些大玩家已经接受了它，并且实际上已经以 APP 兼容的方式公开了他们的一些服务。但是，我在这个领域还没有找到很多其他（较小的）玩家。您知道任何使用 APP 作为其公共 API 协议的 Web 应用程序/服务吗？*您*对 AtomPub 的看法是什么？你有使用它的实际经验吗？它的局限性和缺点是什么？您喜欢 AtomPub 作为您的 REST 风格，还是有其他喜欢的风格？为什么？

我知道，这些问题很多，而不仅仅是一个。不过，我在这里感兴趣的事情很简单——APP 标准是如何进入市场的，尤其是它在 Web 开发人员中的采用情况如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T10:27:28.107

我工作的公司正在开发大量的 RESTful 服务。然而，它们都没有公开公共 API。（从某种意义上说，所有服务都由我们自己的客户在内部使用）。我们选择 REST 架构风格的原因是我们希望我们的服务易于使用，更重要的是可以很好地扩展。

根据我自己的实践经验，我得出的结论是 HTTP + ATOM 联合格式是一个好主意，前提是您希望保持灵活性（在不同的内容模型、附加和扩展与有效负载相关的元数据、统一解析等方面） . ATOM 确保每个人都以统一的方式解释有效载荷，没有任何歧义。

但是，如果没有任何如此复杂的要求或没有预见到这样的要求，那么 ATOM 格式可能会有点开销。（例如，作者、标题等元素在博客/RSS 世界中更有意义，而在您的特定问题域中可能没有意义）。

此外，如果目标只是在一端序列化数据结构并在另一端重构它，那么大多数 Web 框架（如 WCF）都具有更吸引人的自定义格式。

所以在我看来，如果您需要数据表示方面的灵活性，并且如果有不同类型的客户的竞争环境很大，那么 ATOM Pub 是很好的选择。

但是，如果您对潜在客户端和服务器/客户端使用模式有很好的了解，那么自定义格式可能是一个好主意。

如果客户端是基于浏览器的，那么像 JSON 这样的格式非常有吸引力。

希望这能回答你的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T18:08:36.607

My own research so far:

*   [Wordpress](http://codex.wordpress.org/AtomPub) supports AtomPub as its API protocol since version 2.3
*   [GData](http://code.google.com/apis/gdata/) is probably the biggest shot in the AtomPub field so far
*   [Habari](http://habariproject.org) - new promising blogging system promotes APP as one of its main features
*   [BlogSvc.net](http://www.codeplex.com/blogsvc) - an AtomPub server, blog engine for .NET platform, written in C#
*   [Jangle](http://jangle.org) - an open source project designed to facilitate API access to Library Systems

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T21:04:21.497

还有[mod_atom](http://kenai.com/projects/mod-atom) - 一个在文件系统中存储条目的 Apache 模块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T21:41:03.327

上次我检查（2007 年左右）Atompub 实施起来相当复杂。虽然您可以在午休期间将发出有效 Atom 提要的东西拼凑起来，但实现 AtomPub 是一项相当大的任务。

由于更好的库和工具，这可能已经改变，但它仍然可能太复杂而无法仅仅因为它很酷而由较小的方面实现。

并且缺乏杀手级 AtomPub 客户端应用程序对服务器运营商提供 AtomPub 接口的压力很小或根本没有。

# c - What is the size of an enum in C?

> ID：366017
> 
> 赞同：150
> 
> 时间：2008-12-14T01:07:03.033
> 
> 标签：c, enums

I'm creating a set of enum values, but I need each enum value to be 64 bits wide. If I recall correctly, an enum is generally the same size as an int; but I thought I read somewhere that (at least in GCC) the compiler can make the enum any width they need to be to hold their values. So, is it possible to have an enum that is 64 bits wide?

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-12-14T01:23:26.837

Taken from the current C Standard (C99): [http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)

> 6.7.2.2 Enumeration specifiers
> [...]
> Constraints
> The expression that defines the value of an enumeration constant shall be an integer constant expression that has a value representable as an int.
> [...]
> Each enumerated type shall be compatible with char, a signed integer type, or an unsigned integer type. The choice of type is implementation-defined, but shall be capable of representing the values of all the members of the enumeration.

Not that compilers are any good at following the standard, but essentially: If your enum holds anything else than an int, you're in deep "unsupported behavior that may come back biting you in a year or two" territory.

Update: The latest publicly available draft of the C Standard (C11): [http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1570.pdf](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1570.pdf) contains the same clauses. Hence, this answer still holds for C11.

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2008-12-14T01:16:19.083

An `enum` is only guaranteed to be large enough to hold `int` values. The compiler is free to choose the actual type used based on the enumeration constants defined so it can choose a smaller type if it can represent the values you define. If you need enumeration constants that don't fit into an `int` you will need to use compiler-specific extensions to do so.

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-06-05T18:18:58.300

While the previous answers are correct, some compilers have options to break the standard and use the smallest type that will contain all values.

Example with [GCC](http://en.wikipedia.org/wiki/GNU_Compiler_Collection) (documentation in [the GCC Manual](https://gcc.gnu.org/onlinedocs/gcc-3.3.2/gcc/Type-Attributes.html#Type%20Attributes)):

```
enum ord {
    FIRST = 1,
    SECOND,
    THIRD
} __attribute__ ((__packed__));
STATIC_ASSERT( sizeof(enum ord) == 1 ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-14T22:21:10.233

Just set the last value of the enum to a value large enough to make it the size you would like the enum to be, it should then be that size:

```
enum value{a=0,b,c,d,e,f,g,h,i,j,l,m,n,last=0xFFFFFFFFFFFFFFFF}; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-01-23T09:53:14.730

We have no control over the size of an `enum` variable. It totally depends on the implementation, and the compiler gives the option to store a name for an integer using `enum`, so `enum` is following the size of an integer.

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2017-12-29T14:02:10.867

In C language, an `enum` is guaranteed to be of size of an `int`. There is a compile time option (`-fshort-enums`) to make it as short (This is mainly useful in case the values are not more than 64K). There is no compile time option to increase its size to 64 bit.

* * *

## 回答 #7

> 赞同：-8
> 
> 时间：2015-11-14T20:31:13.217

Consider this code:

```
enum value{a,b,c,d,e,f,g,h,i,j,l,m,n};
value s;
cout << sizeof(s) << endl; 
```

It will give 4 as output. So no matter the number of elements an `enum` contains, its size is always fixed.

# c++ - 什么是好的 C/C++ CSS 解析器？

> ID：366028
> 
> 赞同：6
> 
> 时间：2008-12-14T01:17:25.790
> 
> 标签：c++, c, css, parsing

什么是好的 C/C++ CSS 解析器？我能找到的只是[CSSTidy](http://csstidy.sourceforge.net/)，它似乎更像是一个应用程序而不是解析库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-14T01:40:00.393

我用谷歌搜索：

```
“CSS 解析器”C++
```

第一个结果是[http://sourceforge.net/projects/htmlcxx](http://sourceforge.net/projects/htmlcxx)。它是 C++ 的 CSS/HTML API。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-22T18:14:01.357

libcs​​s 似乎也是一个常见的谷歌热门，它看起来不错

[http://www.netsurf-browser.org/projects/libcs​​s/](http://www.netsurf-browser.org/projects/libcss/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-16T07:37:19.267

一个不错的选择是通读 Mozilla 或 Safari 代码库。如果您需要其他程序更容易访问的东西，可以在[http://www.antlr3.org/grammar/1214945003224/csst3.g 找到](http://www.antlr3.org/grammar/1214945003224/csst3.g)一个 ANTLR 语法（您可以使用它来创建 C++ 代码） 。W3 验证器位于[http://dev.w3.org/cvsweb/2002/css-validator/](http://dev.w3.org/cvsweb/2002/css-validator/)，但它是 Java。

# javascript - 在 JavaScript 中实现类似数组的行为而不使用数组

> ID：366031
> 
> 赞同：19
> 
> 时间：2008-12-14T01:19:37.970
> 
> 标签：javascript, arrays, overloading

有没有办法在 JavaScript 中创建一个类似数组的对象，而不使用内置数组？我特别关心这样的行为：

```
var sup = new Array(5);
//sup.length here is 0
sup[0] = 'z3ero';
//sup.length here is 1
sup[1] = 'o3ne';
//sup.length here is 2
sup[4] = 'f3our';        
//sup.length here is 5 
```

**我在这里看到的特殊行为是 sup.length 在没有调用任何方法的情况下发生变化。**我从[这个问题](https://stackoverflow.com/questions/365975/how-are-javascript-arrays-implemented)中了解到， [] 运算符在数组的情况下被重载，这解释了这种行为。是否有一种纯 JavaScript 方式来复制这种行为，或者语言不够灵活？

根据[Mozilla docs](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array)，正则表达式返回的值也可以用这个索引做一些时髦的事情。这可以用普通的javascript吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-14T01:39:32.920

[] 运算符是访问对象属性的本机方式。它不能在语言中覆盖以更改其行为。

如果您想要在 [] 运算符上返回计算值，那么您不能在 JavaScript 中这样做，因为该语言不支持计算属性的概念。唯一的解决方案是使用与 [] 运算符相同的方法。

```
MyClass.prototype.getItem = function(index)
{
    return {
        name: 'Item' + index,
        value: 2 * index
    };
} 
```

如果您想要的行为与您的类中的本机 Array 相同，则始终可以直接在您的类上使用本机 Array 方法。在内部，您的类将像原生数组一样存储数据，但会保持其类状态。jQuery 这样做是为了使 jQuery 类在保留其方法的同时具有数组行为。

```
MyClass.prototype.addItem = function(item)
{
    // Will add "item" in "this" as if it was a native array
    // it will then be accessible using the [] operator 
    Array.prototype.push.call(this, item);
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-14T04:00:25.197

是的，您可以在 JavaScript 中轻松地将数组子类化为类似数组的对象：

```
var ArrayLike = function() {};
ArrayLike.prototype = [];
ArrayLike.prototype.shuffle = // ... and so on ... 
```

然后，您可以实例化新数组，如对象：

```
var cards = new Arraylike;
cards.push('ace of spades', 'two of spades', 'three of spades', ... 
cards.shuffle(); 
```

不幸的是，这在 MSIE 中不起作用。它不跟踪`length`财产。这反而使整个事情泄气了。

这个问题在 Dean Edwards 的[How To Subclass The JavaScript Array Object](http://dean.edwards.name/weblog/2006/11/hooray/)上有更详细的说明。后来证明他的解决方法并不安全，因为一些弹出窗口阻止程序会阻止它。

**更新：**值得一提的是 Juriy “kangax” Zaytsev 关于这个主题的[绝对史诗般的帖子](http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/)。它几乎涵盖了这个问题的各个方面。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-06-10T23:19:05.723

现在我们有了 ECMAScript 2015（ECMA-262 第 6 版；ES6），我们有了[代理对象](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)，它们允许我们`Array`在语言本身中实现行为，类似于：

```
function FakeArray() {
  const target = {};

  Object.defineProperties(target, {
    "length": {
      value: 0,
      writable: true
    },
    [Symbol.iterator]: {
      // http://www.ecma-international.org/ecma-262/6.0/#sec-array.prototype-@@iterator
      value: () => {
        let index = 0;

        return {
          next: () => ({
            done: index >= target.length,
            value: target[index++]
          })
        };
      }
    }
  });

  const isArrayIndex = function(p) {
    /* an array index is a property such that
       ToString(ToUint32(p)) === p and ToUint(p) !== 2^32 - 1 */
    const uint = p >>> 0;
    const s = uint + "";
    return p === s && uint !== 0xffffffff;
  };

  const p = new Proxy(target, {
    set: function(target, property, value, receiver) {
      // http://www.ecma-international.org/ecma-262/6.0/index.html#sec-array-exotic-objects-defineownproperty-p-desc
      if (property === "length") {
        // http://www.ecma-international.org/ecma-262/6.0/index.html#sec-arraysetlength
        const newLen = value >>> 0;
        const numberLen = +value;
        if (newLen !== numberLen) {
          throw RangeError();
        }
        const oldLen = target.length;
        if (newLen >= oldLen) {
          target.length = newLen;
          return true;
        } else {
          // this case gets more complex, so it's left as an exercise to the reader
          return false; // should be changed when implemented!
        }
      } else if (isArrayIndex(property)) {
        const oldLenDesc = Object.getOwnPropertyDescriptor(target, "length");
        const oldLen = oldLenDesc.value;
        const index = property >>> 0;
        if (index > oldLen && oldLenDesc.writable === false) {
          return false;
        }
        target[property] = value;
        if (index > oldLen) {
          target.length = index + 1;
        }
        return true;
      } else {
        target[property] = value;
        return true;
      }
    }
  });

  return p;
} 
```

我不能保证这实际上是完全正确的，并且它不能处理您将长度更改为小于其先前值的情况（正确的行为有点复杂；大致它会删除属性以便`length`属性不变量成立），但它给出了如何实现它的粗略概述。它也不模仿 [[Call]] 和 [[Construct]] on 的行为`Array`，这是在 ES6 之前你不能做的另一件事——在 ES 代码中两者之间不可能有不同的行为，尽管这些都不难。

这`length`以与规范定义它的工作方式相同的方式实现该属性：它拦截对对象属性的分配，并在`length`它是“数组索引”时更改该属性。

与使用 ES5 和 getter 可以做的不同，这允许人们`length`在恒定时间中获取（显然，这仍然取决于 VM 中的底层属性访问是恒定时间），并且它提供非恒定时间性能的唯一情况是删除属性时未实现的情况`newLen - oldLen`（并且在大多数 VM 中删除速度很慢！）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-14T17:25:17.800

这是你要找的吗？

```
Thing = function() {};
Thing.prototype.__defineGetter__('length', function() {
    var count = 0;
    for(property in this) count++;
    return count - 1; // don't count 'length' itself!
});

instance = new Thing;
console.log(instance.length); // => 0
instance[0] = {};
console.log(instance.length); // => 1
instance[1] = {};
instance[2] = {};
console.log(instance.length); // => 3
instance[5] = {};
instance.property = {};
instance.property.property = {}; // this shouldn't count
console.log(instance.length); // => 5 
```

唯一的缺点是“长度”将在 for..in 循环中被迭代，就好像它是一个属性一样。太糟糕了，没有办法设置[属性属性](http://bclary.com/2004/11/07/#a-8.6.1)（这是我真的希望我能做的一件事）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-14T04:08:36.457

答案是：目前还没有办法。数组行为在 ECMA-262 中被定义为这种行为方式，并且具有关于如何处理获取和设置**数组**属性（而不是通用对象属性）的明确算法。这让我有些沮丧=(。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-14T01:38:43.717

大多数情况下，您不需要 javascript 中数组的预定义索引大小，您可以这样做：

```
var sup = []; //Shorthand for an empty array
//sup.length is 0
sup.push(1); //Adds an item to the array (You don't need to keep track of index-sizes)
//sup.length is 1
sup.push(2);
//sup.length is 2
sup.push(4);
//sup.length is 3
//sup is [1, 2, 4] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-14T01:40:41.000

如果您担心稀疏数组的性能（尽管您可能不应该）并希望确保结构仅与您传递的元素一样长，您可以这样做：

```
var sup = [];
sup['0'] = 'z3ero';
sup['1'] = 'o3ne';
sup['4'] = 'f3our';        
//sup now contains 3 entries 
```

同样，值得注意的是，这样做您不太可能看到任何性能提升。我怀疑 Javascript 已经很好地处理了稀疏数组，非常感谢。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-27T20:41:12.437

您还可以创建自己的长度方法，例如：

```
Array.prototype.mylength = function() {
    var result = 0;
    for (var i = 0; i < this.length; i++) {
        if (this[i] !== undefined) {
            result++;
        }
    }
    return result;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-17T07:51:41.043

## 接口和实现

案例是对原数组封装的简单实现，可以替换数据结构，参考通用接口即可实现。

```
export type IComparer<T> = (a: T, b: T) => number;

export interface IListBase<T> {
  readonly Count: number;
  [index: number]: T;
  [Symbol.iterator](): IterableIterator<T>;
  Add(item: T): void;
  Insert(index: number, item: T): void;
  Remove(item: T): boolean;
  RemoveAt(index: number): void;
  Clear(): void;
  IndexOf(item: T): number;
  Sort(): void;
  Sort(compareFn: IComparer<T>): void;
  Reverse(): void;
}

export class ListBase<T> implements IListBase<T> {
  protected list: T[] = new Array();
  [index: number]: T;
  get Count(): number {
    return this.list.length;
  }
  [Symbol.iterator](): IterableIterator<T> {
    let index = 0;
    const next = (): IteratorResult<T> => {
      if (index < this.Count) {
        return {
          value: this[index++],
          done: false,
        };
      } else {
        return {
          value: undefined,
          done: true,
        };
      }
    };

    const iterator: IterableIterator<T> = {
      next,
      [Symbol.iterator]() {
        return iterator;
      },
    };

    return iterator;
  }
  constructor() {
    return new Proxy(this, {
      get: (target, propKey, receiver) => {
        if (typeof propKey === "string" && this.isSafeArrayIndex(propKey)) {
          return Reflect.get(this.list, propKey);
        }
        return Reflect.get(target, propKey, receiver);
      },
      set: (target, propKey, value, receiver) => {
        if (typeof propKey === "string" && this.isSafeArrayIndex(propKey)) {
          return Reflect.set(this.list, propKey, value);
        }
        return Reflect.set(target, propKey, value, receiver);
      },
    });
  }
  Reverse(): void {
    throw new Error("Method not implemented.");
  }
  Insert(index: number, item: T): void {
    this.list.splice(index, 0, item);
  }
  Add(item: T): void {
    this.list.push(item);
  }
  Remove(item: T): boolean {
    const index = this.IndexOf(item);
    if (index >= 0) {
      this.RemoveAt(index);
      return true;
    }
    return false;
  }
  RemoveAt(index: number): void {
    if (index >= this.Count) {
      throw new RangeError();
    }
    this.list.splice(index, 1);
  }
  Clear(): void {
    this.list = [];
  }
  IndexOf(item: T): number {
    return this.list.indexOf(item);
  }
  Sort(): void;
  Sort(compareFn: IComparer<T>): void;
  Sort(compareFn?: IComparer<T>) {
    if (typeof compareFn !== "undefined") {
      this.list.sort(compareFn);
    }
  }
  private isSafeArrayIndex(propKey: string): boolean {
    const uint = Number.parseInt(propKey, 10);
    const s = uint + "";
    return propKey === s && uint !== 0xffffffff && uint < this.Count;
  }
} 
```

## 案子

```
const list = new List<string>(["b", "c", "d"]);
const item = list[0]; 
```

## 参考

*   [代理](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)
*   [[符号.迭代器]()](https://javascript.info/iterable)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-12-14T01:24:59.503

当然，您可以在 JavaScript 中复制几乎任何数据结构，所有基本构建块都在那里。然而，你最终会变得更慢，更不直观。

但是为什么不直接使用 push/pop 呢？

# python - 使用 Python 跟踪重定向和 cookie

> ID：366037
> 
> 赞同：5
> 
> 时间：2008-12-14T01:26:04.040
> 
> 标签：python, redirect, urllib2

我希望能够使用 Python 跟踪和跟踪由不同网页设置的重定向和 cookie（有点像 Firefox 的篡改插件）。

因此，如果 website1 重定向到 website2 然后重定向到 website3，我想遵循它并查看每个网站设置的 cookie。我一直在查看 Urllib2，但它会自行重定向，而且我还没有看到跟踪重定向的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T11:25:19.400

对此有详细的教程。在[潜入 python](http://diveintopython.net/http_web_services/redirects.html)和[voidspace](http://www.voidspace.org.uk/python/articles/urllib2.shtml)中。简短的版本是 urllib2 提供处理程序（您可以覆盖）来控制重定向和 cookie。

# curl - cURL 在这里的行为似乎不正确

> ID：366042
> 
> 赞同：0
> 
> 时间：2008-12-14T01:34:34.770
> 
> 标签：curl

我正在我的 shell 上尝试以下命令：

```
curl -b usptoCookies -L -d "patentNum=6836866&applicationNum=10007391&maintFeeAction=Get+Bibliographic+Data&maintFeeYear=04" https://ramps.uspto.gov/eram/getMaintFeesInfo.do;jsessionid=0000Nmdd1Q_YsDF90HKmb9EIIgq:11g0uehq7 
```

相当直截了当。它试图将一些变量发布到表单中。您可以在此处查看网页： [https ://ramps.uspto.gov/eram/](https://ramps.uspto.gov/eram/)

尝试输入专利号和申请号：6836866 和 10007391。然后点击获取书目数据按钮。

网页返回内容（“整齐”格式化的表格），但 curl 调用似乎遇到了“一些”问题。我很茫然。我在浏览器上使用了 firebug 来确认以上三个变量都是完成表单发布所需的。

这不是 https 的问题，因为我确实收到了回复。我需要帮助。

任何人？

沙希布·罗斯汉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T01:41:21.403

该表单中还有许多其他隐藏字段，包括“签名”。每次请求页面时，这似乎是一些唯一的字符串。这可能是用于确保您不会从他们的数据库中删除所有信息的功能。

当我清空隐藏的签名字段时，它返回了一个错误。如果您想编写一个程序来获取此信息，您可能需要做一些更复杂的事情，并首先获取带有“签名”的页面，这样您就可以将该值发布回站点以获取适当的回应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T17:47:09.660

我认为可能是这种情况，所以在我的一次抓取中，我让它将内容输出到可以在浏览器中打开的页面。这使我能够操纵表单元素并重新提交以查看删除某些隐藏字段是否会影响帖子。当我打开页面并删除所有隐藏字段（包括 sessionId、签名和加载时间）时，我仍然能够提交表单以获得有效响应。

认为这可能指向一些 cookie 或会话相关的问题，我启动了 Selenium（通过 Testing_Selenium 包）并尝试了相同的抓取。这个想法是，由于 Selenium 实际上使用的是真正的浏览器，因此应该消除任何会话/cookie 问题。

当 Selenium 运行以与 curl 运行相同的方式失败时，我束手无策。

我希望有人能在这个页面上看到一些奇怪或不寻常的东西，这可能会解释失败。

谢谢你的意见，你怎么看？

沙希布·R。

# javascript - 可以在纯 JavaScript 中实现只读属性吗？

> ID：366047
> 
> 赞同：55
> 
> 时间：2008-12-14T01:40:01.220
> 
> 标签：javascript, browser

查看[mozilla 文档](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array)，查看正则表达式示例（标题为“使用匹配结果创建数组”），我们有如下语句：

> 输入：一个只读属性，反映与正则表达式匹配的原始字符串。
> 
> index：只读属性，它是字符串中匹配项的从零开始的索引。

等等...是否可以在 JavaScript 中创建您自己的具有只读属性的对象，或者这是为特定浏览器实现的内置类型保留的特权？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2010-06-03T10:05:53.700

使用[任何实现 ECMAScript 5 的 javascript 解释器，](http://kangax.github.io/compat-table/es5/#Object.defineProperty "显示浏览器支持")您都可以使用 Object.defineProperty 来定义只读属性。在松散模式下，解释器将忽略对属性的写入，在严格模式下，它会抛出异常。

来自[ejohn.org](http://ejohn.org/blog/ecmascript-5-objects-and-properties/)的示例：

```
var obj = {};
Object.defineProperty( obj, "<yourPropertyNameHere>", {
  value: "<yourPropertyValueHere>",
  writable: false,
  enumerable: true,
  configurable: true
}); 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-12-14T02:27:11.793

**编辑：**`Object.defineProperty`自从编写了这个答案以来，在 EcmaScript 5 中已经标准化了一种新的、更好的使用方式，并支持更新的浏览器。请参阅[Aidamina 的回答](https://stackoverflow.com/questions/366047/can-read-only-properties-be-implemented-in-pure-javascript/2964881#2964881)。如果您需要支持“旧”浏览器，您可以使用此答案中的一种方法作为后备。

* * *

在 Firefox、Opera 9.5+ 和 Safari 3+、Chrome 和 IE（使用 v11 测试）中，您可以定义 getter 和 setter 属性。如果您只定义一个 getter，它会有效地创建一个只读属性。您可以在对象字面量中定义它们，也可以通过调用对象上的方法来定义它们。

```
var myObject = {
    get readOnlyProperty() { return 42; }
};

alert(myObject.readOnlyProperty); // 42
myObject.readOnlyProperty = 5;    // Assignment is allowed, but doesn't do anything
alert(myObject.readOnlyProperty); // 42 
```

如果你已经有一个对象，你可以调用`__defineGetter__`and `__defineSetter__`：

```
var myObject = {};
myObject.__defineGetter__("readOnlyProperty", function() { return 42; }); 
```

当然，这在网络上并不是很有用，因为它在 Internet Explorer 中不起作用。

您可以从[John Resig 的博客](http://ejohn.org/blog/javascript-getters-and-setters/)或[Mozilla 开发人员中心](https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide/Creating_New_Objects/Defining_Getters_and_Setters)了解更多信息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-14T02:19:13.230

JavaScript 中可以有只读属性，这些属性可以通过 getter 方法获得。这通常称为“模块”模式。

YUI 博客有一篇很好的文章：http: [//yuiblog.com/blog/2007/06/12/module-pattern/](http://yuiblog.com/blog/2007/06/12/module-pattern/)

来自帖子的片段：

```
YAHOO.myProject.myModule = function () {

//"private" variables:
var myPrivateVar = "I can be accessed only from within YAHOO.myProject.myModule.";

//"private" method:
var myPrivateMethod = function () {
    YAHOO.log("I can be accessed only from within YAHOO.myProject.myModule");
}

return  {
    myPublicProperty: "I'm accessible as YAHOO.myProject.myModule.myPublicProperty."
    myPublicMethod: function () {
        YAHOO.log("I'm accessible as YAHOO.myProject.myModule.myPublicMethod.");

        //Within myProject, I can access "private" vars and methods:
        YAHOO.log(myPrivateVar);
        YAHOO.log(myPrivateMethod());

        //The native scope of myPublicMethod is myProject; we can
        //access public members using "this":
        YAHOO.log(this.myPublicProperty);
    }
};

}(); // the parens here cause the anonymous function to execute and return 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-05-22T03:29:56.017

作为这里的只读属性或变量。

正如[aidamina 所说](https://stackoverflow.com/a/2964881/2985029)，顺便说一下，这是一个用于测试的简短代码，现在非常有用，因为 JQuery 假装弃用了选择器属性。

```
<script>
Object.defineProperties(window, {
  "selector": { value: 'window', writable: false }
});

alert (window.selector);  // outputs window

selector ='ddd';          // testing because it belong to the global object
alert (window.selector);  // outputs window
alert (selector);         // outputs window

window.selector='abc';
alert (window.selector);   // outputs window
alert (selector);          // outputs window
</script> 
```

所以你有一个只读属性或变量测试。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-09-19T19:03:49.487

是的，我们可以在 JavaScript 中拥有一个对象的只读属性。可以通过私有变量和`object.defineProperty()`方法来实现，

请参阅以下示例，该示例说明了具有只读属性的对象，

```
function Employee(name,age){
    var _name = name;
    var _age = age;

    Object.defineProperty(this,'name',{
        get:function(){
            return _name;
        }
    })
}

var emp = new Employee('safeer',25);
console.log(emp.name); //return 'safeer'
emp.name='abc';
console.log(emp.name); //again return 'safeer', since name is read-only property 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-14T03:32:59.120

这是道格拉斯·克罗克福德 (Douglas Crockford) 的“Javascript 中的私人成员”页面的链接……在我看来，只有在仅提供 getter 方法且不提供 setter 的情况下才能读取这些内容：

[http://javascript.crockford.com/private.html](http://javascript.crockford.com/private.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-08T03:31:02.633

你会看到我已经为颜色定义了一个 setter 和 getter，所以它可以被修改。另一方面，一旦定义了对象，品牌就会变成只读的。我相信这是您正在寻找的功能。

```
 function Car(brand, color) {
            brand = brand || 'Porche'; // Private variable - Not accessible directly and cannot be frozen
            color = color || 'Red'; // Private variable - Not accessible directly and cannot be frozen
            this.color = function() { return color; }; // Getter for color
            this.setColor = function(x) { color = x; }; // Setter for color
            this.brand = function() { return brand; }; // Getter for brand
            Object.freeze(this); // Makes your object's public methods and properties read-only
        }

        function w(str) {
            /*************************/
            /*choose a logging method*/
            /*************************/
            console.log(str);
            // document.write(str + "<br>");
        }

        var myCar = new Car;
        var myCar2 = new Car('BMW','White');
        var myCar3 = new Car('Mercedes', 'Black');

        w(myCar.brand()); // returns Porche
        w(myCar.color()); // returns Red

        w(myCar2.brand()); // returns BMW
        w(myCar2.color()); // returns White

        w(myCar3.brand()); // returns Mercedes
        w(myCar3.color()); // returns Black

        // This works even when the Object is frozen
        myCar.setColor('Green');
        w(myCar.color()); // returns Green

        // This will have no effect
        myCar.color = 'Purple';
        w(myCar.color()); // returns Green
        w(myCar.color); // returns the method

        // This following will not work as the object is frozen
        myCar.color = function (x) {
            alert(x);
        };

        myCar.setColor('Black');
        w(
            myCar.color(
                'This will not work. Object is frozen! The method has not been updated'
            )
        ); // returns Black since the method is unchanged 
```

以上已在 Chromium 版本 41.0.2272.76 Ubuntu 14.04 上进行了测试，并产生了以下输出：

> ```
>  Porche
>           Red
>           BMW
>           White
>           Mercedes
>           Black
>           Green
>           Green
>           function () { return color; }
>           Black 
> ```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-29T21:01:22.817

[bob.js 框架](http://www.bobjs.com)提供了一种声明只读属性的方法。在底层，它声明了一个私有字段并为其公开了 getter/setter 函数。bob.js 提供了多种方式来做同样的事情，具体取决于便利性和特定目标。这是一种使用面向对象实例的`Property`方法（其他方法允许在对象本身上定义 setter/getter）：

```
var Person = function(name, age) {  
    this.name = new bob.prop.Property(name, true); 
    var setName = this.name.get_setter(); 
    this.age = new bob.prop.Property(age, true); 
    var setAge = this.age.get_setter();  
    this.parent = new bob.prop.Property(null, false, true);  
};  
var p = new Person('Bob', 20);  
p.parent.set_value(new Person('Martin', 50));  
console.log('name: ' + p.name.get_value());  
console.log('age: ' + p.age.get_value());  
console.log('parent: ' + (p.parent.get_value ? p.parent.get_value().name.get_value() : 'N/A')); 
// Output: 
// name: Bob 
// age: 20 
// parent: N/A 
```

最后，`p.name.set_value`未定义，因为这是一个只读属性。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-10-08T07:29:48.460

因此，它仅在尚未定义的情况下才有效，但是您可以使用 const 将变量设为只读。

# regex - 正则表达式：如何在 XML 属性值周围加上单引号？

> ID：366054
> 
> 赞同：5
> 
> 时间：2008-12-14T01:46:13.250
> 
> 标签：regex

我有一个看起来像的字符串

```
"<input id=a/>"<input id=b/>"<input id=c/>etc. 
```

我需要将其更改为

```
"<input id='a'/>"<input id='b'/>"<input id='c'/>etc, 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T02:46:07.607

在 C# 中，您可以将其编写为：

```
resultString = Regex.Replace(subjectString, @"(<.*?id\s*=\s*)(\w+)(.*?>)", "$1'$2'$3", RegexOptions.Multiline); 
```

在 VB.Net 中，它只是：

```
ResultString = Regex.Replace(SubjectString, "(<.*?id\s*=\s*)(\w+)(.*?>)", "$1'$2'$3", RegexOptions.Multiline) 
```

在规范的 Perl 中，您可以将其写为：

```
$subject =~ s/(<.*?id\s*=\s*)(\w+)(.*?>)/$1'$2'$3/mg; 
```

在 PHP 中：

```
$result = preg_replace('/(<.*?id\s*=\s*)(\w+)(.*?>)/m', '$1\'$2\'$3', $subject); 
```

在 Java 中：

```
resultString = subjectString.replaceAll("(?m)(<.*?id\\s*=\\s*)(\\w+)(.*?>)", "$1'$2'$3"); 
```

在 Javascript 中：

```
result = subject.replace(/(<.*?id\s*=\s*)(\w+)(.*?>)/mg, "$1'$2'$3"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T02:30:54.063

这个怎么样：

```
%s/"<input id=\(.\)\/>/"<input id='\1'\/>/g 
```

这也可以：

```
%s/\("<input id=\)\(.\)\/>/\1'\2'\/>/g 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T13:18:29.077

仅用一个小样本很难真正回答这个问题。对于给定的示例文本，您可以搜索正则表达式：

```
=(\w) 
```

并将其替换为：

```
='$1' 
```

或者：

```
='\1' 
```

取决于您使用的编程语言是否将 $1 或 \1 解释为对替换文本中第一个捕获组的引用。

这个简单的搜索和替换非常适合您给定的示例文本。

我担心它不适用于您的实际数据。如果是这种情况，那是因为您的示例文本不代表您的实际数据。创建正则表达式最难的部分是弄清楚你想要匹配什么，以及你不想匹配什么。这是您必须在问题中指定的内容。

# .net - .Net 有什么好的解析库吗？

> ID：366062
> 
> 赞同：5
> 
> 时间：2008-12-14T01:57:08.017
> 
> 标签：.net, parsing

我正在寻找一些易于使用且语法易于定义的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-14T02:06:17.517

虽然我以前从未使用过它，但[ANTLR](http://www.antlr.org/)有 C# 运行时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-14T02:06:19.090

如果您使用 F#，请查看[FParsec](http://www.quanttec.com/fparsec/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-16T15:54:29.573

刚刚发现[Irony](http://www.codeplex.com/irony)。用于编写[DSL](http://en.wikipedia.org/wiki/Domain-specific_language)。
以为我会把它添加到列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T02:02:01.783

System.Text.RegularExpressions？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-14T03:41:03.410

看看[Coco/R for C#](http://www.ssw.uni-linz.ac.at/Research/Projects/Coco/#CS)。

# wpf - 如何在父画布中定位 UserControl

> ID：366068
> 
> 赞同：1
> 
> 时间：2008-12-14T02:01:37.383
> 
> 标签：wpf, user-controls, wpf-positioning

我想把这个 UserControl 放在 Canvas.Left="168", Canvas.Top="213"。

但是，控件出现在一个角落。我该怎么办？

如果我将值放在此类的使用点，则值将返回为 NaN 在这种情况下，我怎样才能获得正确的左值和上值？

用法：

```
<Canvas x:Name="DesignerCanvas"
        ClipToBounds="True"
        SnapsToDevicePixels="True">
<Gr:BareNode />
</Canvas> 
```

用户控制：

```
<UserControl x:Class="DiagramDesigner.BareNode"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

<Grid>
    <ContentControl Width="50"
                  Height="50"
                  Padding="2"    
                  Canvas.Left="168" Canvas.Top="213">
        <Ellipse IsHitTestVisible="False" >
            <Shape.Fill>
                <RadialGradientBrush Center="0.2, 0.2" GradientOrigin="0.2, 0.2" RadiusX="0.8" RadiusY="0.8">
                    <GradientStop Color="LightBlue" Offset="0"/>
                    <GradientStop Color="Blue" Offset="0.9"/>
                </RadialGradientBrush>
            </Shape.Fill>
        </Ellipse>
    </ContentControl>
   </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T02:35:03.603

我不确定您是否尝试过此操作，但仅从查看 XAML 来看，您似乎正在尝试在用户控件内设置用户控件的位置。那是行不通的。你需要把它放在你使用用户控件的地方

```
<Canvas x:Name="DesignerCanvas"
    ClipToBounds="True"
    SnapsToDevicePixels="True">
   <Gr:BareNode Canvas.Left="168" Canvas.Top="213"/>
</Canvas> 
```

将 Canvas.Left="168" Canvas.Top="213" 部分从用户控件内部的 ContentControl 声明中取出。

# objective-c - 在 switch 块中实例化新对象 - 为什么会失败？

> ID：366073
> 
> 赞同：4
> 
> 时间：2008-12-14T02:06:47.873
> 
> 标签：objective-c

为什么

```
switch ([document currentTool]) {
    case DrawLine:
        NSBezierPath * testPath = [[NSBezierPath alloc]init];
        //...rest of code that uses testPath.... 
```

导致

`error:syntax error before "*" token`

测试路径？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-14T02:46:32.100

除非将对象放在新范围内，否则不能在 case 语句中实例化对象。这是因为否则您可以执行以下操作：

```
switch( ... ) {
    case A:
       MyClass obj( constructor stuff );
       // more stuff
       // fall through to next case
    case B:
       // what is the value of obj here? The constructor was never called
    ...
} 
```

如果您希望对象在案件期间持续存在，您可以这样做：

```
switch( ... ) {
    case A: {
       MyClass obj( constructor stuff );
       // more stuff
       // fall through to next case
    }
    case B:
       // obj does not exist here
    ...
} 
```

这在 Objective C 以及 C 和 C++ 中是相同的。

# c# - C# 解释语言

> ID：366077
> 
> 赞同：1
> 
> 时间：2008-12-14T02:11:35.507
> 
> 标签：c#, parsing, interpreted-language

我正在寻找用 C# 编写解释型语言，我应该从哪里开始？我知道如何使用有趣的字符串解析来做到这一点，但正确的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-14T02:31:12.177

做正确的事可能是一项相当困难的努力。

如果您对编译器理论没有太多了解，您可能应该首先开始阅读它。
如果我正确理解该术语，仅使用“有趣的字符串解析”根本不会让您走得太远。

第一个基本步骤是编写定义该语言有效语法的语言语法。
像[ANTLR](http://www.antlr.org/)这样的工具可以帮助您将各个部分组合在一起，但我建议您阅读[Dragon 的书](http://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools)，因为它是加快了解该主题的规范起点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-14T03:31:17.517

如果您想在 .NET 上构建解释型语言，DLR 是您的最佳选择 - 请查看 Martin Maly 的 LOLCODE 示例，网址为[http://www.iunknown.com/2007/11/lolcode-on-dlr.html](http://www.iunknown.com/2007/11/lolcode-on-dlr.html)

编辑：这是 Scott Hanselman 提供的更多信息的另一个链接：[http ://www.hanselman.com/blog/TheWeeklySourceCode11LOLCodeDLREdition.aspx](http://www.hanselman.com/blog/TheWeeklySourceCode11LOLCodeDLREdition.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T03:18:04.220

查看Microsoft的[Phoenix 编译器。](http://connect.microsoft.com/Phoenix)这将提供许多您需要的工具来构建针对本机或托管环境的编译器。在这些工具中，我们有一个优化后端。

我支持 Cycnus 关于阅读 Aho Sethi 和 Ullman 的“龙之书”（[维基百科](http://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools)，[亚马逊](https://rads.stackoverflow.com/amzn/click/com/0321486811)）的建议。

RGR

# apache-flex - Flex Builder 3 中带有纯 ActionScript 项目的 flexunit

> ID：366088
> 
> 赞同：2
> 
> 时间：2008-12-14T02:28:41.417
> 
> 标签：apache-flex, actionscript, flexbuilder, flexunit

如果您在 Flex Builder 3 中创建一个纯 ActionScript 项目并想使用 flexunit 进行单元测试，那么最好的选择是什么？

内置的 Flex 构建器将拒绝构建包含 TestRunnerBase 组件的 mxml 文件，因为它是一个纯 ActionScript 项目（不允许使用 Flex）。无法将 mxml 文件添加到项目设置中的“ActionScript 应用程序”列表中。

现在我可以看到两个选项，都是不可取的。

1.  将单元测试 mxml 文件添加到项目中，并创建一个外部工具设置来构建和运行它。这是我现在采用的方法，它工作正常，除了交互式调试是不可能的。
2.  为测试 mxml 文件创建一个新的 Flex 项目，并将主项目的 src 目录添加为构建选项中的附加源目录。我不喜欢这种方法，因为除了维护两个项目的丑陋之外，它还要求我将 mxml 文件保存在与所有其他源文件不同的目录树中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T13:31:12.080

总是有[ASUnit](http://www.asunit.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T17:10:53.867

我最终将单元测试 mxml 文件放在原始项目中，创建一个新的 Flex 项目，删除 src 目录，并将其替换为 Eclipse 链接文件夹到 ActionScript 项目的 src 目录。这个设置似乎工作正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T09:39:10.300

为了让 FlexUnit 与 CruiseControl.net（持续集成服务器）一起工作，我们做了类似的事情。

在我们的实现中，我们在 Application 类的 FlexEvent.CREATION_COMPLETE 处理程序中运行以下代码。

如何输出单元测试的结果完全取决于您。我们的实现已与 AIR 和 Zinc3 一起使用，并且都输出 NUnit 友好的 XML 表示，然后退出应用程序（如果任何测试失败，退出代码为 -1）。

```
// import mx.core.Application;
// import flexunit.framework.*;

// class AutomatedTestHarness extends Application implements TestListener

private function creationCompleteHandler(event : Event) : void
{
    this._result = new TestResult();
    this._result.addListener(this);

    var testSuite : TestSuite = new TestSuite();
    this.addUnitTests(testSuite);

    testSuite.runWithResult(_result);
}

/**
  * Implement these as part of TestResult.addListener
  * If you want to output xml after the tests run, do so here
  * (Tip: Count tests in endTest and compare the count to testSuite.countTestCases()
  * to find out when all tests have completed)
  */
function startTest(test : Test) : void {}
function endTest(test : Test) : void {}
function addError(test : Test, error : Error) : void {}
function addFailure(test : Test, error : AssertionFailedError) : void {} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T05:57:17.207

也许您可以使用 flexunit.textui.TestRunner，它将结果输出到控制台。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T06:04:26.117

我们已经将要测试的所有代码分解到库项目中。然后，我们只需要一个单独的项目来进行测试，这是一个 flex 项目，它依赖于被测项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-04T03:38:00.630

从 libspark尝试[AS3Unit 。](http://www.libspark.org/wiki/yossy/AS3Unit/en/index)他们还有一个异步 beta 测试套件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-04T03:34:39.770

从 libspark 尝试 AS3Unit。他们还有一个异步 beta 测试套件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-06T02:09:07.570

删除项目的 .actionScriptProperties 文件中的“excludedEntries”元素应该可以工作，我使用这种方式在我的纯 actionscript 项目中构建 mxml 文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-06T02:22:54.203

您可以查看我们如何使用 FlexUnit4 及其 CI ant 任务[为 Robotlegs 设置构建。](http://github.com/robotlegs/robotlegs-framework)

对于版本控制，我们删除了所有 Flex/Flash Builder 项目文件。src 和 test 文件夹都设置为 src 路径。测试是通过 ant 构建进行的。或者，如果您生活在视觉测试运行器中，则可以设置带有运行器的第二个项目。

它在许多贡献者中非常有效且易于使用。

# git - Git 提交针对没有分支的标签

> ID：366093
> 
> 赞同：57
> 
> 时间：2008-12-14T02:36:17.893
> 
> 标签：git, branch, tags, commit

如果我在没有创建分支的情况下签出源代码的标记版本，Git 会表明我根本没有与任何分支相关联。很高兴让我进行更改并签入。这些变化去哪儿了？如果我切换回“主”，它们就会消失（被主中的内容覆盖），我似乎再也找不到它们了。是什么赋予了？如果 Git 允许我对本质上是匿名的分支提交更改，我肯定可以将它们取回吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-12-14T03:47:18.000

因为您的**提交不在任何分支上**，所以您无法在工作目录中看到它，除非您使用其 SHA1 签出该特定提交。`reflog`您可以通过查看您从 repo 中签出的内容中的哪些跟踪更改来找到提交。如果您的标签是，`XXX`您会看到如下内容：

```
$ git reflog
7a30fd7... HEAD@{0}: checkout: moving from master to XXX
ddf751d... HEAD@{1}: checkout: moving from 96c3b0300ccf16b64efc260c21c85ba9030f2e3a to master
96c3b03... HEAD@{2}: commit:  example commit on tag XXX, not on any branch
7a30fd7... HEAD@{3}: checkout: moving from master to XXX 
```

这告诉您`checkout`为了在工作目录中看到您的提交，您必须使用 SHA1。

```
$ git checkout 96c3b03
Note: moving to "96c3b03" which isn't a local branch
If you want to create a new branch from this checkout, you may do so
(now or later) by using -b with the checkout command again. Example:
  git checkout -b <new_branch_name>
HEAD is now at 96c3b03... example commit on tag XXX, not on any branch
$ git checkout -b newbranch
$ git branch                #lists all branches
    feature1
    master
  * newbranch 
```

起初这一切对我来说似乎有点奇怪，直到我意识到 git`checkout`将所有项目文件*作为特定提交*放入我的文件系统（工作目录）中。实际上，工作目录充当本地 Git 存储库上的浏览器。因此，您的更改并没有*在存储库中*被覆盖，当您签出主文件时，它们只是没有显示在您的工作目录中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-14T02:49:34.527

是的，他们将在 reflogs 中。

您可以随时像这样命名分支：

```
git checkout -b my-branch-name 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-01-06T16:08:21.700

或者，您可以通过查找其 SHA1（如上使用 git reflog ）将提交合并回 master 而无需新分支，然后：

```
git checkout master
git merge SHA1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-04T22:31:52.840

要回答第二个问题，您可以使用 git reset --hard yourtagname

至于会发生什么，你基本上在标记名处分叉了你的分支并留在同一个分支上。您在旧分叉中的提交仍然存在......他们很难看到。您可能必须使用 reflog 来查找旧分叉。

# .net - 在 FxCop 中创建自定义规则

> ID：366095
> 
> 赞同：4
> 
> 时间：2008-12-14T02:39:49.163
> 
> 标签：.net, code-analysis, static-analysis, fxcop

我想在 FXCop 中创建额外的规则。自定义规则，以帮助确保特定的最佳实践，例如检查内联 sql。

我真的在寻找好的资源和例子。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-14T10:48:17.773

[本教程](http://www.binarycoder.net/fxcop/html/index.html)似乎非常全面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T16:47:28.403

您还可以使用商业工具[NDepend](http://www.NDepend.com)[在 LINQ 查询 (CQLinq)](http://www.ndepend.com/Features.aspx#CQL)上编写自定义代码规则。*免责声明：我是该工具的开发人员之一*

默认提出超过[200 条代码规则。](http://www.ndepend.com/DefaultRules/webframe.html)

CQLinq 优于 FxCop API 或其他工具的优势在于，**它可以直接编写代码规则**，并*立即*获得结果。建议使用设施来浏览匹配的代码元素。例如：

![CQLinq 代码规则](https://i.stack.imgur.com/OHPhy.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-24T13:03:28.807

上面的教程很不错。我拼凑了一个也可能有用的示例 VS 项目，因为我找不到任何示例项目 [http://www.doogal.co.uk/files/FxCopRules.zip](http://www.doogal.co.uk/files/FxCopRules.zip)

# flash - Flash添加错误

> ID：366104
> 
> 赞同：1
> 
> 时间：2008-12-14T02:52:58.077
> 
> 标签：flash, actionscript-3, math, floating-point

在 Flash 中创建一个**新的 AS3 文档，****粘贴**以下代码并**运行它：**

```
var a:Number=0;
trace(a)  //  0
a+=0.3;
trace(a)  //  0.3
a+=0.3;
trace(a)  //  0.6
a+=0.3;

trace(a)  //  0.8999999999999999
a+=0.3;
trace(a)  //  1.2
a+=0.3;
trace(a)  //  1.5
a+=0.3;
trace(a)  //  1.8
a+=0.3;
trace(a)  //  2.1
a+=0.3;
          //  ^ This is the output. Notice the inaccuracy starting from 0.9 / 0.89 
```

**为什么会出错？**我只是在做一个普通的高分辨率加法。

任何**解决方法？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-14T02:59:31.917

这是一个标准的浮点问题。二进制浮点数不能完全准确地表示十进制数的全部范围，您需要按照以下方式做一些事情

```
trace (round (a, 1)) 
```

或者，更好的是，把它变成一个字符串，去掉第一个小数位之后的所有内容（因为round的结果也可能不容易用二进制表示）。

虽然我不知道 ActionScript。这仍然是一个众所周知的问题，并且不仅限于 AS3。

参见例如[为什么我看到一个双变量初始化为某个值，如 21.4 作为 21.399999618530273？](https://stackoverflow.com/questions/177506/why-do-i-see-a-double-variable-initialized-to-some-value-like-214-as-2139999961)或[Java 程序中奇怪的浮点行为](https://stackoverflow.com/questions/327544/strange-floating-point-behaviour-in-a-java-program)或[什么是浮点/舍入错误的简单示例？](https://stackoverflow.com/questions/249467/what-is-a-simple-example-of-floating-pointrounding-error).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T06:08:01.333

一种解决方法是使用缩放的整数类型。对于此示例，您可以增加 3，然后在输出前除以 10。这避免了浮点运算中固有的所有舍入误差。

# java - JTable整表数据变化

> ID：366107
> 
> 赞同：0
> 
> 时间：2008-12-14T02:59:06.240
> 
> 标签：java, jtable

是否有一种相对简单的方法来更改 JTable 中的所有数据？例如，如果我有一个名为 books 的 JTable，其中包含某个作者的所有书籍的信息，然后用户更改了作者，我将不得不用一组全新的信息更新该表（注意，因为体积有问题的数据，在表上使用过滤器并更新过滤器是不切实际的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T03:05:10.487

听起来您应该使用自定义表格模型，它可以调用 fireTable*** 方法（AbstractTableModel）来通知相关更改。

# vb6 - 如何修复 VB6 程序中的错误“无法加载控件 SSPanel；未找到许可证”

> ID：366109
> 
> 赞同：12
> 
> 时间：2008-12-14T03:00:41.760
> 
> 标签：vb6

我有一个需要更改的 VB6 遗留程序。我无法从 IDE 运行程序。当我在 IDE 中激活其中一个表单时，我收到一个错误，它将我指向一个错误日志文件。日志文件中包含以下内容

“无法加载控制 SSPanel；未找到许可证”

SSPanel 是 Sheridan 3D 控件 (THREED32.ocx) 的一部分，并且该组件已被选中。

如何修复错误？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-14T03:00:55.847

对我有用的解决方案是执行安装盘（common/tools/VB/controls）上的文件 VBCTRLS.REG。它注册了控件。我停止收到错误，并且能够从 IDE 运行程序

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-22T16:06:23.670

只需要在一些遗留代码中处理这个问题。问题似乎与在 vb6 之前停止的控件有关。没有现成的安装盘，所以我稍微挖掘了一下，找到了一个可以从 microsoft.com 下载的可执行文件。

Microsoft 有一篇 kb 文章解决了这个问题： [https](https://jeffpar.github.io/kbarchive/kb/177/Q177799/) ://jeffpar.github.io/kbarchive/kb/177/Q177799/ （存档副本）

文件 VBUSC.exe 似乎已修复它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-26T04:28:38.107

*   如果您已在多个地方注册，请取消注册您的所有threed32.ocx。

*   在 sys32 文件夹中注册threed32.ocx。

*   运行 VBCTRLS.REG（有时会在 sys32 中，有时会在 common/tools/VB/controls 中）

现在试试，我相信它会起作用

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-08T10:15:17.867

遇到这个问题，并尝试了所有答案都没有成功，我想我会添加一条额外的信息来为我解决这个问题。

该问题似乎与 Windows 7 更新包有关。一位运行稍微过时版本的操作系统的同事设法让我们的 VB6 项目正常工作，但我安装了最新 Win7 的新机器出现了这个问题。

无论如何，解决方案是这样的：

*   定位`regtlibv12.exe`（它通常在`C:\Windows\Microsoft.NET\Framework\[version]`.. 例如`C:\Windows\Microsoft.NET\Framework\v4.0.30319`，如果这是你已经安装的）

*   以管理员身份运行命令提示符并导航到该文件的位置

*   `regtlibv12.exe C:\Windows\SysWOW64\msdatsrc.tlb`对 64 位窗口执行

*   对 32 位窗口执行`regtlibv12.exe C:\Windows\System32\msdatsrc.tlb`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-06T13:26:13.387

我使用 cmd 窗口注册了 DLL（以管理员身份运行）：

```
%systemroot%\SysWow64\regsvr32 threed32.ocx 
```

然后使用存储VB6的文件夹

```
(\Visual Basic 6\en_vb6_ent_cd1\Common\Tools\VB\controls) 
```

我跑了`vbctrls.reg`

错误消失了，具有 ThreeD Panel 的旧程序现在可以正常加载和运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-12T00:58:47.000

一种可能性是在 Microsoft 文章 kb177799“**未找到此组件的许可证信息错误**”（也是 Q177799）中

原文虽不见了，但[这里](https://web.archive.org/web/20150118121341/http://support.microsoft.com/kb/177799)和[这里](https://jeffpar.github.io/kbarchive/kb/177/Q177799/)都有存档，相关文字转载如下：

> **症状**
> 
> 当您尝试将控件添加到窗体时，可能会出现以下消息：
> 
> `License information for this component not found. You do not have an appropriate license to use this functionality in the design environment.`
> 
> **原因**
> 
> 当安装控件仅用于运行时（例如由使用 Visual Basic 创建的应用程序安装的控件）时，如果 Visual Basic 开发环境随后安装到同一台机器上，并且现有控件的版本等于或高于从CD，该控件的许可证密钥未更新。
> 
> **解析度**
> 
> 如果有问题的控件是下面列出的任何控件，则找到并双击 Visual Basic CD-ROM 上的文件 Vbctrls.reg：
> 
> *   AniBtn32.ocx
>     
>     
> *   Gauge32.ocx
>     
>     
> *   Graph32.ocx
>     
>     
> *   Grid32.ocx
>     
>     
> *   KeySta32.ocx
>     
>     
> *   MSOutl32.ocx
>     
>     
> *   Spin32.ocx
>     
>     
> *   Threed32.ocx
>     
>     
> 
> 这将更新这些控件的设计时许可证。
> 
> 对于 Visual Basic 5.0，Vbctrls.reg 位于 \Tools\Controls 文件夹中。对于 Visual Basic 6.0，它位于磁盘 1 的 \Common\Tools\Vb\Controls 文件夹中，而对于 Visual Studio 6.0，它位于磁盘 3 的同一文件夹中。
> 
> Visual Basic 6.0 CD-ROM 还包含在 Visual Basic 6.0 中停止使用的 Visual Basic 5.0 自定义控件的这些文件：
> 
> *   dbgrid.reg
>     
>     
> *   图表注册
>     
>     
> 
> *如果有问题的控件不在上面列出的控件中*，请执行以下操作：
> 
> 1.  在您的计算机上找到 Regsvr32.exe。注意它的路径。
>     
>     
> 2.  找到有问题的 OCX 文件，通常位于 Windows\System 文件夹中...
>     
>     
> 3.  在开始菜单上，单击运行。
>     
>     
> 4.  在“运行”对话框中，键入以下内容：
>     
>     
>     
>     `<Path to RegSvr32>\REGSVR32.EXE /u <Path to OCX>\OCXFILE.OCX`
>     
>     
> 5.  例如：
>     
>     
>     
>     `C:\Devstudio\VB\REGSVR32.EXE /u C:\Winnt\System32\COMCTL32.OCX`
>     
>     
> 6.  如果您要重新安装旧版本的控件，您应该删除/删除 .OCX、.OCA 和 .DEP 文件，以便替换它们。
>     
>     
> 7.  对每个有问题的 OCX 重复前 3 个步骤。
>     
>     
> 8.  在控制面板上，单击添加\删除程序。
>     
>     
> 9.  选择 Visual Basic，然后单击添加\删除。
>     
>     
> 10.  出现选项（添加\删除，删除全部，重新安装）对话框时，单击重新安装。
>     
>     
> 11.  重新应用最新的 Visual Studio Service Pack

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-12T01:04:02.583

另一种可能性是 Microsoft 文章 Q195353 ，[在此处](https://web.archive.org/web/20150215151050/http://support.microsoft.com:80/kb/195353/EN-US)和[此处](https://jeffpar.github.io/kbarchive/kb/195/Q195353/)`FILE: VBUSC.EXE Provides Licensing for Discontinued Controls`存档。

关键摘要：**如果在计算机上检测到 Visual Basic，VBUSC.EXE 会为上面列出的控件安装设计时许可证。**

VBUSC 程序可在[此处](http://download.microsoft.com/download/VB60Pro/Install/2/Win98/En-US/VBUSC.exe)下载（仍直接从 Microsoft 下载）。

* * *

文章原文为：

```
SUMMARY
=======

VBUSC.EXE is a file that installs the Design-Time Licenses for ActiveX controls
that shipped with earlier versions of Visual Basic, but are no longer supported
and have been discontinued with the current version.

MORE INFORMATION
================

The following file is available for download from the Microsoft Download
Center:

  VBUSC.exe
  (http://download.microsoft.com/download/VB60Pro/Install/2/Win98/En-US/VBUSC.exe)

Release Date: August 15, 2000

For additional information about how to download Microsoft Support files, click
the following article number to view the article in the Microsoft Knowledge
Base:

  Q119591 How to Obtain Microsoft Support Files from Online Services

Microsoft scanned this file for viruses. Microsoft used the most current
virus-detection software that was available on the date that the file was
posted. The file is stored on secure servers that prevent any unauthorized
changes to the file.

   FileName               Size
  ---------------------------------------------------------
  VBUSC.EXE                88k

The following controls are no longer supported by Microsoft Visual Basic:

ActiveX Control Name                Filename
------------------------------------------------
Desaware Animated Button Control    ANIBTN32.OCX
Microhelp Gauge Control             GAUGE32.OCX
Pinnacle-BPS Graph Control          GRAPH32.EXE
Microsoft Grid Control              GRID32.OCX
Microhelp Key State Control         KEYSTA32.OCX
Microsoft Outline Control           MSOUTL32.OCX
Outrider SpinButton Control         SPIN32.OCX
Sheridan 3D Controls                THREED32.OCX

The ActiveX controls listed above are no longer supported, but ship with the
Professional and Enterprise Editions of Microsoft Visual Basic for backward
compatibility when upgrading existing projects.

These controls do not ship with the Learning Edition of Microsoft Visual Basic.

For the Professional and Enterprise Editions, the controls are located on the
installation CDs at the following locations:

Microsoft Visual Basic Edition        Location
----------------------------------------------------------------------
Professional 6.0                      \Common\Tools\VB\Controls
Enterprise 6.0                        \Common\Tools\VB\Controls
Visual Studio Professional 6.0        \Common\Tools\VB\Controls (CD2)
Visual Studio Enterprise 6.0          \Common\Tools\VB\Controls (CD3)

Each of these directories contain a README.TXT with instructions on how to
install the controls for design-time use.

NOTE: Using the Learning Edition to upgrade a project developed in an earlier
version of Microsoft Visual Basic might result in licensing problems for these
controls.

The VBUSC.EXE installs the design-time licenses for the controls listed above if
Visual Basic is detected on the computer. 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-27T15:10:19.063

如果您有“无法加载控制**系统信息**；未找到许可证”。

此 reg 解决了问题：

```
[HKEY_CLASSES_ROOT\Licenses\E32E2733-1BC5-11d0-B8C3-00A0C90DCA10]
@="kmhfimlflmmfpffmsgfmhmimngtghmoflhsg" 
```

# c# - 在 .Net 应用程序中使用 tinyurl.com ...可能吗？

> ID：366115
> 
> 赞同：18
> 
> 时间：2008-12-14T03:07:16.503
> 
> 标签：c#, .net, asp.net, api, tinyurl

我找到了以下代码来创建 tinyurl.com 网址：

```
http://tinyurl.com/api-create.php?url=http://myurl.com 
```

这将自动创建一个 tinyurl 网址。有没有办法使用代码，特别是 ASP.NET 中的 C# 来做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-14T03:49:21.910

您可能应该添加一些错误检查等，但这可能是最简单的方法：

```
System.Uri address = new System.Uri("http://tinyurl.com/api-create.php?url=" + YOUR ADDRESS GOES HERE);
System.Net.WebClient client = new System.Net.WebClient();
string tinyUrl = client.DownloadString(address);
Console.WriteLine(tinyUrl); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-14T03:34:28.040

在做了更多研究之后......我偶然发现了以下代码：

```
 public static string MakeTinyUrl(string url)
    {
        try
        {
            if (url.Length <= 30)
            {
                return url;
            }
            if (!url.ToLower().StartsWith("http") && !Url.ToLower().StartsWith("ftp"))
            {
                url = "http://" + url;
            }
            var request = WebRequest.Create("http://tinyurl.com/api-create.php?url=" + url);
            var res = request.GetResponse();
            string text;
            using (var reader = new StreamReader(res.GetResponseStream()))
            {
                text = reader.ReadToEnd();
            }
            return text;
        }
        catch (Exception)
        {
            return url;
        }
    } 
```

看起来它可以解决问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-14T03:13:00.017

您必须从代码中调用该 URL，然后从服务器读回输出并进行处理。

看看[System.Net.WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)类，[DownloadString](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloadstring.aspx)（或更好的：[DownloadStringAsync](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloadstringasync.aspx)）似乎是你想要的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-14T03:34:29.880

请记住，如果您正在开发一个完整的应用程序，那么您正在与 TinyURL 的 URL/API 方案建立一个非常特定的依赖关系。也许他们保证他们的 URL 不会改变，但值得一试

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-26T09:45:51.927

根据[这篇](https://medium.com/@adhasmana/system-design-create-a-url-shortening-service-part-1-overview-26aae5597914)文章，您可以像这样实现它：

```
public class TinyUrlController : ControllerBase
{
    Dictionary dicShortLohgUrls = new Dictionary();

    private readonly IMemoryCache memoryCache;

    public TinyUrlController(IMemoryCache memoryCache)
    {
        this.memoryCache = memoryCache;
    }

    [HttpGet("short/{url}")]
    public string GetShortUrl(string url)
    {
        using (MD5 md5Hash = MD5.Create())
        {
            string shortUrl = UrlHelper.GetMd5Hash(md5Hash, url);
            shortUrl = shortUrl.Replace('/', '-').Replace('+', '_').Substring(0, 6);

            Console.WriteLine("The MD5 hash of " + url + " is: " + shortUrl + ".");

            var cacheEntryOptions = new MemoryCacheEntryOptions().SetSlidingExpiration(TimeSpan.FromSeconds(604800));
            memoryCache.Set(shortUrl, url, cacheEntryOptions);

            return shortUrl;
        }
    }

    [HttpGet("long/{url}")]
    public string GetLongUrl(string url)
    {
        if (memoryCache.TryGetValue(url, out string longUrl))
        {
            return longUrl;
        }

        return url;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-26T08:53:33.037

这是我的实现版本：

```
static void Main()
{
    var tinyUrl = MakeTinyUrl("https://stackoverflow.com/questions/366115/using-tinyurl-com-in-a-net-application-possible");

    Console.WriteLine(tinyUrl);

    Console.ReadLine();
}

public static string MakeTinyUrl(string url)
{
    string tinyUrl = url;
    string api = " the api's url goes here ";
    try
    {
        var request = WebRequest.Create(api + url);
        var res = request.GetResponse();
        using (var reader = new StreamReader(res.GetResponseStream()))
        {
            tinyUrl = reader.ReadToEnd();
        }
    }
    catch (Exception exp)
    {
        Console.WriteLine(exp);
    }
    return tinyUrl;
} 
```

# c# - 使用 C# 在文本中插入制表符

> ID：366124
> 
> 赞同：306
> 
> 时间：2008-12-14T03:22:07.893
> 
> 标签：c#, .net

我正在构建一个应用程序，我应该在其中捕获多个值并使用它们构建一个文本：`Name`、`Age`等。

输出将是纯文本转换为`TextBox`.

我试图让这些信息以 . 的形式出现`columns`，因此我试图将它们分开`tab`以使其更清晰。

例如，而不是：

```
Ann 26
Sarah 29
Paul 45 
```

我希望它显示为：

安*标签*26 莎拉*标签*29 保罗*标签*45

关于如何`insert`在我的文本中添加标签的任何提示？

* * *

## 回答 #1

> 赞同：512
> 
> 时间：2008-12-14T03:25:13.970

尝试使用`\t`字符串中的字符

* * *

## 回答 #2

> 赞同：475
> 
> 时间：2008-12-14T03:31:46.390

哈扎尔的`\t`. 以下是 C# 转义字符的完整列表：

`\'`单引号。

`\"`双引号。

`\\`为反斜杠。

`\0`为空字符。

`\a`为警觉字符。

`\b`退格。

`\f`换页。

`\n`换一条新线。

`\r`回车。

`\t`对于水平标签。

`\v`对于垂直标签。

`\uxxxx`对于 unicode 字符十六进制值（例如`\u0020`）。

`\x`与 相同`\u`，但您不需要前导零（例如`\x20`）。

`\Uxxxxxxxx`对于 unicode 字符十六进制值（生成代理项需要更长的形式）。

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2008-12-14T05:22:31.973

使用它也很有用`String.Format`，例如

```
String.Format("{0}\t{1}", FirstName,Count); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-05-11T10:43:21.620

```
var text = "Ann@26"

var editedText = text.Replace("@", "\t"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-01-30T06:56:10.087

使用`Microsoft Winform controls`，如果没有我将在下面解释的一些解决方法，就不可能正确解决您的问题。

**问题**

使用 simple `"\t"`or的问题`vbTab`是，当显示多个 TextBox 并且所有 TextBox 都必须遵守对齐方式时，唯一`"\t"`或`vbTab`解决方案将显示不总是正确对齐的内容。

VB.Net 中的示例：

```
Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    TextBox1.Text = "Bernard" + vbTab + "32"
    TextBox2.Text = "Luc" + vbTab + "47"
    TextBox3.Text = "François-Victor" + vbTab + "12"
End Sub 
```

将显示

[![在此处输入图像描述](https://i.stack.imgur.com/mRVu8.png)](https://i.stack.imgur.com/mRVu8.png)

如您所见，`age`值 for`François-Victor`向右移动，并且与`age`另外两个 TextBox 的值不对齐。

**解决方案**

要解决此问题，您必须使用特定的`SendMessage()`user32.dll API 函数设置 Tabs 位置，如下所示。

```
Public Class Form1

    Public Declare Function SendMessage _
        Lib "user32" Alias "SendMessageA" _
        ( ByVal hWnd As IntPtr _
        , ByVal wMsg As Integer _
        , ByVal wParam As Integer _
        , ByVal lParam() As Integer _
        ) As Integer

    Private Const EM_SETTABSTOPS As Integer = &HCB

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Dim tabs() As Integer = {4 * 25}

        TextBox1.Text = "Bernard" + vbTab + "32"
        SendMessage(TextBox1.Handle, EM_SETTABSTOPS, 1, tabs)
        TextBox2.Text = "Luc" + vbTab + "47"
        SendMessage(TextBox2.Handle, EM_SETTABSTOPS, 1, tabs)
        TextBox3.Text = "François-Victor" + vbTab + "12"
        SendMessage(TextBox3.Handle, EM_SETTABSTOPS, 1, tabs)
    End Sub

End Class 
```

并显示以下表格

[![在此处输入图像描述](https://i.stack.imgur.com/VnEvJ.png)](https://i.stack.imgur.com/VnEvJ.png)

您现在可以看到，所有值都正确对齐:-)

**评论**

`Multiline`TextBox 的属性**必须设置为 True**。如果此属性设置为 False，则选项卡的位置与以前一样。

如何`AcceptsTab`分配财产并不重要（我已经测试过）。

这个问题已经在[StackOverflow上处理过了](https://stackoverflow.com/questions/1298406/how-to-set-the-tab-width-in-a-windows-forms-textbox-control)

注意：制表位置的测量单位不是字符，而是似乎是字符的 1/4 的东西。这就是为什么我将长度乘以 4。

**C# 解决方案**

```
using System;
using System.Windows.Forms;
using System.Runtime.InteropServices;

namespace WindowsFormsApp1
{
    public partial class Form1 : Form
    {
        [DllImport("User32.dll", CharSet = CharSet.Auto)]
        private static extern IntPtr SendMessage(IntPtr h, int msg, int wParam, uint[] lParam);
        private const int EM_SETTABSTOPS = 0x00CB;
        private const char vbTab = '\t';

        public Form1()
        {
            InitializeComponent();

            var tabs = new uint[] { 25 * 4 };

            textBox1.Text = "Bernard" + vbTab + "32";
            SendMessage(textBox1.Handle, EM_SETTABSTOPS, 1, tabs);
            textBox2.Text = "Luc" + vbTab + "47";
            SendMessage(textBox2.Handle, EM_SETTABSTOPS, 1, tabs);
            textBox3.Text = "François-Victor" + vbTab + "12";
            SendMessage(textBox3.Handle, EM_SETTABSTOPS, 1, tabs);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-06-27T06:38:56.050

有几种方法可以做到这一点。最简单的是`\t`在您的文本中使用。但是，在某些情况下可能`\t`不起作用，例如`PdfReport`nuget 包。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-08-29T01:38:07.783

使用文字字符串（以 @" 开头）时，这可能更容易

```
char tab = '\u0009';
string A = "Apple";
string B = "Bob";
string myStr = String.Format(@"{0}:{1}{2}", A, tab, B); 
```

会导致`Apple:<tab>Bob`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-15T12:54:41.827

```
string St = String.Format("{0,-20} {1,5:N1}\r", names[ctr], hours[ctr]);
richTextBox1.Text += St; 
```

这很好用，但您必须使用等距字体。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-09-24T07:39:34.620

除了上面的 anwsers，您还可以使用 PadLeft 或 PadRight：

```
string name = "John";
string surname = "Smith";

Console.WriteLine("Name:".PadRight(15)+"Surname:".PadRight(15));
Console.WriteLine( name.PadRight(15) + surname.PadRight(15)); 
```

这将用左边或右边的空格填充字符串。

# c++ - 您可以在 C++ 中将指针声明为 extern 吗？

> ID：366134
> 
> 赞同：1
> 
> 时间：2008-12-14T03:34:15.873
> 
> 标签：c++, pointers, legacy

我有以下无法编译的遗留 C++ 代码：

```
#include <stdio.h>
#include <iostream>

extern ostream *debug; 
```

GCC（g++）抱怨：“'*'令牌之前的预期初始化程序”

环顾四周，将这些声明为外部引用似乎更常见，如下所示：

```
extern ostream& debug; 
```

为什么指针无效，但引用在这种情况下？

解决方案：

如下所述，真正的问题是缺少 std:: 命名空间说明符。显然，这在较旧的 C++ 代码中很常见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-14T03:35:42.513

是的，您可以使用 extern 声明一个指针。您的错误很可能是您忘记使用`std::`：

```
// note the header is cstdio in C++. stdio.h is deprecated
#include <cstdio>
#include <iostream>

extern std::ostream *debug; 
```

# php - 文件存在php代码

> ID：366137
> 
> 赞同：1
> 
> 时间：2008-12-14T03:34:54.247
> 
> 标签：php

```
<?php

function data_info($data)
{
    if ($data) {
        while (!feof($data)) {
            $buffer = fgets($data);
            if (file_exists($buffer)) {
            $bufferArray[$buffer]['Exists'] = (file_exists($buffer));
            $bufferArray[$buffer]['Readable'] = (is_readable($buffer));
            $bufferArray[$buffer]['Writable'] = (is_writable($buffer));
            $bufferArray[$buffer]['Size'] = (filesize($buffer));
            } else {
                $bufferArray[$buffer]['Exists'] = "No";
            }
        }
        print_r($bufferArray);
    } else {
        echo "The file could not be opened";
    }
}

$data = fopen("D:/xampp/htdocs/Practice/ficheros.txt", "r");
data_info($data);

?> 
```

如果我有这个： ficheros.txt: ExistingFile.txt ExistingFile2.txt ExistingFile3.txt... ... 它可以工作，但如果我至少有 1 个不存在的文件，那么它也会将每个文件都视为不存在的文件。

怎么了？我相信内在的 if 条件。

* * *

我的意思是，整个代码有什么问题。

我只需要创建一个包含数组的数组，一个好的结果是：

```
 array
(
    'text.txt' => array
        (
        'exists' => true,
        'readable' => true,
        'writable' => true,
        'Size' => 64
        ),

    'document.doc' => array
        (
        'exists' => false
        ),

    'photo.jpg' => array
        (
    'exists' => true,
    'readable' => true,
    'writable' => false,
    'size' => 354915
        )
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T03:49:27.043

嗯，这在 Linux 中工作得很好（尽管我必须先修剪文件名`$buffer`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T03:55:29.353

是的，如果我在 ficheros.txt 中，它也适用于我

```
Existingfile.txt
AnotherExistingfile.txt 
```

或者

```
FakeFile.txt
FakeFile2.txt 
```

但如果我将它们结合起来：

```
Fakefile.txt
Existingfile.txt 
```

它不起作用，最后一种情况下的脚本将两个文件都视为不存在的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T04:34:57.997

我不是 100%**为什么**你不是，但我玩过它，这是有效的：

```
<?php

function data_info($data)
{
    if (!$data){return "The file could not be opened";}
    while (!feof($data))
     {
        $buffer = implode('',fgetcsv($data));//fgetcsv will only return an array with 1 item so impload it
        if(file_exists($buffer))
         {
            $bufferArray[$buffer]['Exists'] = (file_exists($buffer));
            $bufferArray[$buffer]['Readable'] = (is_readable($buffer));
            $bufferArray[$buffer]['Writable'] = (is_writable($buffer));
            $bufferArray[$buffer]['Size'] = (filesize($buffer));
         }
        else
         {
            $bufferArray[$buffer]['Exists'] = "No";
         }
     }
    print_r($bufferArray);
}

$data = fopen("c:/file.txt", "r");
data_info($data);

?> 
```

我使用的文件的结果：

```
Array
(
    [c:/messageService.log] => Array
        (
            [Exists] => 1
            [Readable] => 1
            [Writable] => 1
            [Size] => 0
        )

    [c:/setup.log] => Array
        (
            [Exists] => 1
            [Readable] => 1
            [Writable] => 1
            [Size] => 169
        )

    [c:/fake1.txt] => Array
        (
            [Exists] => No
        )

    [c:/fake2.txt] => Array
        (
            [Exists] => No
        )

) 
```

在查看您的一些评论后重新考虑，尝试使用确切的路径而不是文件名。

# javascript - 使用 Javascript 进行图像处理？

> ID：366145
> 
> 赞同：6
> 
> 时间：2008-12-14T03:44:47.300
> 
> 标签：javascript, image-manipulation, greasemonkey

我正在尝试编写一个greasemonkey脚本，它最好能够处理图像（特别是找到图像中最暗的像素）。有没有办法做到这一点或者我必须嵌入闪存？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-14T04:07:42.420

由于它是 Firefox 特定的，因此您可以使用画布元素。我从来没有写过greasemonkey脚本，所以我不知道你会怎么做，但想法是，你创建一个新的画布元素并将图像绘制到画布上。然后，您可以从画布中获取像素值。

```
// Create the canvas element
var canvas = document.createElement("canvas");
canvas.width = image.width;
canvas.height = image.height;

// Draw the image onto the canvas
var ctx = canvas.getContext("2d");
ctx.drawImage(image, 0, 0);

// Get the pixel data
var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);

// Loop through imageData.data - an array with 4 values per pixel: red, green, blue, and alpha
for (int x = 0; x < imageData.width; x++) {
    for (int y = 0; y < imageData.height; y++) {
        var index = 4 * (y * imageData.width + x);
        var r = imageData.data[index];
        var g = imageData.data[index + 1];
        var b = imageData.data[index + 2];
        var a = imageData.data[index + 3];

        // Do whatever you need to do with the rgba values
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-13T03:02:13.713

报废

```
var r = imageData.data[index];
var g = imageData.data[index + 1];
var b = imageData.data[index + 2];
var a = imageData.data[index + 3]; 
```

部分，Javascript 不通过引用传递。

# asp.net - ASP.NET MVC 不适用于 ViewState 和 Postback？

> ID：366151
> 
> 赞同：19
> 
> 时间：2008-12-14T03:49:53.907
> 
> 标签：asp.net, asp.net-mvc, controls, postback

也许这是一个幼稚的问题。据我了解，ASP.NET MVC 不能与 ViewState 和 Postback 一起使用，这是 ASP.NET 表单的基础。那是对的吗？

如果是这样，那么所有依赖于 ViewState 和 Postback 的 ASP.NET Web 控件都不能在 ASP.NET MVC 中使用，对吧？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-14T04:19:53.097

ASP.NET 的服务器端控件使用 WebForms，而不是 MVC。MVC 不使用传统 ASP.NET 意义上的控件（至少目前如此）。

MVC 模型与 WebForms 模型有很大不同；没有更好或更坏，但非常不同。使用 MVC 使开发人员更接近生成的 HTML，更本质上更适合单元测试，并在 UI 和填充该 UI 的代码之间提供了强大的关注点分离。

乍一看，尤其是对于 ASP.NET 的老手来说，MVC 似乎是一个巨大的倒退（如果您当时正在编码，那么 ASP COM 开发的愿景可能会在您的脑海中翩翩起舞）。

但是试试 MVC。它非常有趣，一旦你习惯了它的模型，它就会非常引人注目。

在这里阅读更多：http: [//quickstarts.asp.net/previews/mvc/mvc_HowToRenderFormUsingHtmlHelpers.htm](http://quickstarts.asp.net/previews/mvc/mvc_HowToRenderFormUsingHtmlHelpers.htm)

另外，查看这个使用 MVC 的有趣博客引擎：http: [//www.codeplex.com/oxite](http://www.codeplex.com/oxite)

最后，查看 Rob Conery 的 MVC 店面项目： [http ://wekeroad.com/category/mvc-storefront](http://wekeroad.com/category/mvc-storefront)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-10T10:16:54.510

> 这可能会让您感到惊讶，但我不小心在 MVC 页面上放置了一个 Button，并实现了 Click 事件，它确实有效！

如果我错了，请纠正我，但我认为不需要 ViewState。它应该创建一个简单的 HTML 标记，如果您在运行时不更改按钮的属性（文本、事件等），则不需要**VIEWSTATE**。

也许这就是它起作用的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T08:12:48.617

这可能会让您感到惊讶，但我不小心在 MVC 页面上放置了一个 Button，并实现了 Click 事件，它确实有效！

我很惊讶，也许它只适用于这个简单的案例（它是当时页面上唯一的元素），以及响应以重定向结束的事实，但在某些情况下它似乎可以工作:)

# design-patterns - 已发布和公共方法/属性之间有什么区别？

> ID：366156
> 
> 赞同：1
> 
> 时间：2008-12-14T03:55:13.397
> 
> 标签：design-patterns, public-method

根据 Martin Fowler 的说法，“有些东西可以公开，但这并不意味着你已经发布了它。” 这是否意味着这样的事情：

```
public interface IRollsRoyceEngine
{
    void Start();
    void Stop();
    String GenerateEngineReport();
}

public class RollsRoyceEngine : IRollsRoyceEngine
{
    public bool EngineHasStarted { get; internal set; }

    public bool EngineIsServiceable { get; internal set; }

    #region Implementation of IRollsRoyceEngine

    public void Start()
    {
        if (EngineCanBeStarted())
            EngineHasStarted = true;
        else
            throw new InvalidOperationException("Engine can not be started at this time!");
    }

    public void Stop()
    {
        if (EngineCanBeStopped())
            EngineHasStarted = false;
        else
            throw new InvalidOperationException("Engine can not be started at this time!");
    }

    public string GenerateEngineReport()
    {
        CheckEngineStatus();
        return EngineIsServiceable ? "Engine is fine for now" : "Hmm...there may be some problem with the engine";
    }

    #endregion

    #region Non published methods

    public bool EngineCanBeStarted()
    {
        return EngineIsServiceable ? true : false;
    }

    public bool EngineCanBeStopped()
    {
        return EngineIsServiceable ? true : false;
    }

    public void CheckEngineStatus()
    {
        EngineIsServiceable = true;
        //_EngineStatus = false;
    }

    #endregion

} 
```

可以说这个发布的接口是IRollsRoyceEngine而不是RollsRoyceEngine中的任何东西吗？

如果是这样，公共方法和已发布方法之间的真正区别是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-14T04:02:03.477

我认为他的意思是合同为王——仅仅因为你的类中的一个方法是公共的，并不能使客户假设他们可以调用它，或者他们知道它的作用，或者它会在下一个版本。API 不是由源定义的，它们是由合同定义的，通常以文档的形式。

客户有责任不调用未记录（未发布）的函数，而不是实现者有责任隐藏不应调用的方法。

有些人可能不同意这一点——通常是那些不信任文档的人，他们宁愿通过查看源代码来了解它的*实际*作用，而不是作者*声称*的作用。他们可能很有道理，尤其是在处理文档不足的代码时。但我认为这与 Fowler 所说的相反，即功能应该被正式定义，而不是通过检查特定实现来推断。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T16:39:20.920

In my opinion mentioned white paper talks about target audience of the API rather than the distinction between interface and its implementation.

You can find analogy in [Framework Design Guidelines](https://rads.stackoverflow.com/amzn/click/com/0321246756) which says that once your API shipped you have a contract with consumers. For example, if you shipped in v1 of your framework IService interface you cannot change it in v2 because it will introduce breaking changes to end developers. Instead you must create new interface IService2 inhereted from IService and ship it with v2.

So basically public API becomes published once you "sign a contract" with end developers.

Returning back to your code - it will be published when you ship it to development community for example.

Hope this explanation will help.

# c# - 我应该为我使用的每个数据库设置一个类吗？

> ID：366160
> 
> 赞同：4
> 
> 时间：2008-12-14T04:02:00.310
> 
> 标签：c#, database, business-objects

首先，让我解释一下我在做什么。我需要一个订单，它被分成不同的数据库，并打印出这个非常大的订单。我从订单中需要的是来自不同数据库的大约 100 列左右。我正在做的方式是使用连接查询并将所有列值分配给我的一个大型 Order 类中的一个变量。这已经开始变得麻烦了。我想知道不是有一个由 100 名左右的成员组成的班级来组成订单。我应该为我使用的每个数据库设置一个类，然后使用它吗？

让我补充一下。基本上，将对象映射到原始数据库表还是结果集更好。因为我将对象映射到结果集而不是单个表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T04:58:49.087

我会推荐一个面向对象的解决方案。大概您的数据库设计有表示数据逻辑分组的表。这些表中的每一个都可能映射到系统中的一个类，尽管在某些情况下，它可能由多个表组成一个对象，或者一个表可能使用子类映射到多个类。如果您需要显示来自多个表的数据——比如说一个订单列表以及与订单相关的客户的一些数据——那么你可以使用视图、连接或存储过程来构造一个视图类的对象，该对象表示view/join/sp 中选择的数据。

本质上，我所描述的是一个 N 层数据架构，其中您有一个低级数据访问层，用于处理来自 SQL 方向的数据——表、视图、存储过程。在此之上可能是处理通用数据对象并与数据访问层接口以从数据库存储/检索对象的通用对象层。最后，在此之上，您有一个强类型的业务对象层，您的应用程序使用语义链接到您的应用程序的类——订单、客户、发票等。实现这种类型的通用架构有许多不同的模式，您应该调查几个，看看哪个最适合您的应用程序需要。

就个人而言，我认为构建应用程序以处理域上下文中的对象，而不是简单地作为表数据，将改进您的代码。它应该提高可理解性和可维护性。您将能够将行为封装在您的域类中，而不是将其传播到整个应用程序中。当然，这假设您遵循良好的设计实践，但使用 OO 设计会鼓励这一点。从显示逻辑中分离出业务和数据逻辑也将使您的应用程序更加可测试，将单体类分解为更小、更集中且相互关联的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T04:31:20.017

为什么不单独从单个数据库中加载数据？

例如，您的 Order 对象的构造函数如下所示：

```
Method New Order(orderId) {
   Get Database 1 Details
   Load Details into appropriate Variables
   Get Database 2 Details 
   Load Details into appropriate Variables
   Get Database **N** Details 
   Load Details into appropriate Variables
} 
```

它使维护涉及单个数据库的 sql 变得更容易，并且每个数据库都不会有十几个不同的类。

另一种选择是有一个存储过程，它返回多个结果集，您可以通过代码中的 DataSet 访问这些结果集。

或者，您可以通过将其转换为您的一个数据库中的视图来使您的连接更易于处理和维护。

您真正需要考虑的一件事是维护。六个月不阅读代码对你来说是多么容易维护，甚至对于其他一些开发人员来说，在没有先验知识的情况下维护代码是多么容易。选择您认为最容易维护的范例，然后以这种方式编码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T07:49:05.903

解决此问题的一种优雅而简单的方法是 Active Record 模式：

[http://en.wikipedia.org/wiki/Active_record_pattern](http://en.wikipedia.org/wiki/Active_record_pattern)

当然，它可能并非在所有情况下都可行。正如其他答案所暗示的那样，它也可以与其他模式集成。我相信无论您选择哪种方法，您都将面临权衡取舍。祝一切顺利！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-14T04:10:30.527

这听起来就像你对我的偏好。您希望如何使用它？将其作为单独的 C# 对象使用会更容易，还是将其作为多个 SQL 表使用会更容易？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-14T06:44:01.260

我会考虑创建一个类来处理每个单独的数据存储中的数据。

然后，我会考虑使用一种模式，比如 Facade 将这些子系统组合在一起。在网络上搜索“设计模式”和“外观”以获取更多信息。然后，外观可以解释单独数据存储中的数据之间的任何特定交互。

对我来说，维护逻辑分组的代码要容易得多，并且为单独的数据存储设置单独的类对我来说很有意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T17:39:46.850

我在这里违背了原则，但我会说保持这个对象映射到结果集，并将连接保持在数据库中，可能是一个更好的主意。

对于业务逻辑，“订单”通常是一个单一的有凝聚力的概念（至少，这就是您开始构建它的方式）。它被映射到多个表（或数据库）这一事实是否可能是数据捕获方式的产物？在分解之前，我会问自己这些问题：

*   用其他对象组合顺序是否有实实在在的好处？
*   属性是否有不同的基数？即一些是按订单的，而另一些是按行项目的？
*   您可以为组合对象重用现有代码吗？
*   您是否启用了更容易与多个对象进行的其他交互？

如果您对这些问题中的任何一个都没有回答是，我敢打赌，如果您的代码仅将订单作为原子对象处理，并且让数据库隐藏它来自何处的复杂性（你甚至可以为此使用视图）。

绝对数量的属性通常不是分解接口的理由。但是，如果订单对象本身的复杂性（或大小）让您失望，您可能会尝试在内部简化它以使用某种通用访问器方法，例如：

```
private object GetOrderAttribute(string attributeName){
    // use a data structure (like a hash table) to store and access internally
}
...
output("Quantity: " + GetOrderAttribute("quantity"));
// etc. 
```

另一个注意事项：虽然在逻辑系统设计中性能很少是您*首先*关注的问题，但如果数据库执行连接，大多数涉及数据库表连接的情况会执行得更好，因为 DBMS 可以使用索引和其他机制来有效地执行连接并避免加载磁盘中不需要的页面。也许你所有的个人查询也这样做，但通常这是数据库可以比业务逻辑代码更有效地执行一个数量级的事情。（当然，如果连接跨越物理数据库边界，则可能会失去这种好处。）

# oop - 帮助设计

> ID：366175
> 
> 赞同：1
> 
> 时间：2008-12-14T04:22:47.880
> 
> 标签：oop, ooad

我认为我很擅长编程 C# 语法。我现在正在寻找一些资源、书籍（首选）、网站、博客，它们处理设计面向对象的桌面应用程序和 Web 应用程序的最佳方式，尤其是在数据和数据库方面。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-14T05:19:58.560

你要求从消防水管里喝水。让我鼓励您在处理大程序之前编写一些小程序。然而，这里有几本关于设计的书和一篇认为很多设计不能从书本中学到的论文：

*   [On System Design](http://research.sun.com/techrep/Perspectives/PS-2006-6.pdf)是一篇很好的短文，**阐述了许多有经验的程序员**对设计艺术的看法。

*   [Jon Bentley 的Programming Pearls](http://www.cs.bell-labs.com/cm/cs/pearls/)展示了一些可爱**的小型设计**示例。这是一个有趣的阅读，包括许多经典故事。

*   [Kernighan 和 Pike的 Unix Programming Environment](http://cm.bell-labs.com/cm/cs/upe/)提出了 20 世纪**最伟大的软件设计哲学之一。**近 25 年后仍然需要阅读。

*   [Pascal](https://rads.stackoverflow.com/amzn/click/com/0201103427)中的软件工具更窄更深，但会告诉你很多关于**构建软件工具**的细节和设计理念。

*   [Barbara Liskov 和 John Guttag的程序开发中的抽象和规范](http://catalogue.nla.gov.au/Record/1894481)将教您如何**设计单个模块，以便它们可以与其他模块相适应**以形成出色的库。它已绝版，但您当地的大学图书馆可能有。

*   [C 接口和实现](http://www.cs.princeton.edu/cii/)提供了**一个设计良好的库**，它为 C 程序员提供了在更高级别语言中发现的抽象。

*   最后，[测试驱动开发](https://rads.stackoverflow.com/amzn/click/com/0321146530)将教你**如何**通过重要的东西来表达和开发设计：你的软件实际上做了什么。

我从Glenford Myers的[Composite/Structured Design中学到了很多东西，但它与您所询问的主题的直接关系稍差。](https://rads.stackoverflow.com/amzn/click/com/0884055841)它主要讨论**模块相互依赖的好方法和坏方法**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T04:34:26.857

对于如何开发软件的书，我会推荐[The Pragmatic Programmer](http://www.pragprog.com/titles/tpp/the-pragmatic-programmer)。对于设计，您可能需要查看[面向接口的设计](http://www.pragprog.com/titles/kpiod/interface-oriented-design)。 [Code Complete](http://cc2e.com/)是关于开发软件的“A 到 Z”参考。您可能还想考虑 O'Reilly [Head First](http://headfirstlabs.com/)书籍，尤其是[Head First Object-Oriented Analysis and Design](http://www.headfirstlabs.com/books/hfooad/)，因为它更容易开始。

**编辑**我不知道我是怎么忘记 Bob Martin 的，但你也可以阅读 Object Mentor 在其任何列表中的任何书籍。这是他们关于[软件设计](http://objectmentor.com/resources/books_design.html)的部分。我特别推荐[敏捷软件开发：原则、模式和实践](https://rads.stackoverflow.com/amzn/click/com/0135974445)（亚马逊，但它也是 Object Mentor 列表中的第二本书）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T05:04:06.563

我对最近的任何一本书都不感兴趣，以至于我正在认真考虑写一本新书。“Head First”的书通常比“For Dummies”的书高出一步（公平地说，我没有读过那本书。）

我其实很喜欢 Peter Coad 的[Java Design](https://rads.stackoverflow.com/amzn/click/com/0139111816)；你可以买到便宜的，它不再印刷了。显然，它的 Java 很重，但设计部分很好，而且相当轻量级。

Ivar Jacobson 的[面向对象软件工程](https://rads.stackoverflow.com/amzn/click/com/0201544350)也非常好（它引入了“用例”等概念）并且似乎仍在印刷中，但周围有数以万计的二手副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T05:55:37.803

我从您的问题中选择了以下关键字：面向对象（建模和编程）、构建桌面应用程序、构建 Web 应用程序和数据库设计。因为你没有提到任何特定的语言，所以很难为你推荐。所以我假装我是问这个问题并且认识我的人，我向自己推荐：

1.  OO：Bruce Eckel 用 C++ 思考或用 Java 思考。
2.  构建桌面应用程序：[Ultimate++](http://www.ultimatepp.org/)
3.  和网络应用程序开发： http: [//www.djangoproject.com/](http://www.djangoproject.com/)
4.  数据库：我没有什么好的建议。

我提出上述建议的理由：

1.  我不想推荐十几本书或更多。您不必全部阅读。
2.  Bruce Eckel 的“Thinking”书籍可以涵盖主要的 OO 概念，因为学习一门新语言不会有任何问题，因为这只是语法问题。
3.  Ultimate++ 可以生成最精简的桌面应用程序，并且它们非常积极地使用模板，从而产生非常优雅的代码。与 MFC、WPF、java Swing Java SWT、Python 等相比，使用 U++ 的另一个优点是您的可执行文件没有任何包袱或依赖项。它不需要您的用户安装 JRE、.NET 框架、MFC DLL 或 Python 等。这是我的选择，因此我提出了这个建议。
4.  Django，因为我了解并喜欢 Python，但我不太了解 Ruby。Ruby 专家会说 RubyOnRails 或 C# 专家会说 ASP MVC。Java 可能会说 Struts、JSF、Stripes，但我认为 Java 现在没有任何东西可以与 Python、Ruby、C# 甚至 PHP 的框架竞争。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-14T06:14:41.367

我很惊讶还没有人提到“四人帮”的设计模式。正是这本书真正巩固了我应该如何真正使用 OO。前几章特别有启发性，说明在一个好的系统中应该如何工作。这不是最简单的阅读，但我认为它是最好的。如果您想要更轻松地了解同一主题，请查看 Head First Design Patterns。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-14T06:41:28.460

Martin Fowler 的[Enterprise-Application-Architecture](https://rads.stackoverflow.com/amzn/click/com/0321127420) 是一本关于常见模式的好书，您将在许多客户端服务器应用程序中看到。

更多关于思​​考面向对象问题的书是 Eric Evan 的[领域驱动设计：解决软件核心的复杂性](https://rads.stackoverflow.com/amzn/click/com/0321125215)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-14T07:04:24.637

多年前，作为做过一些 Windows 3.1 编程的 ac 程序员，我通过使用开发框架，特别是 Borland 的 Object Windows Library，学到了很多关于面向对象设计的知识。他们当时的软件包还为他们的数据库引擎提供了一个精心设计的数据库对象库。如今，所有数据库的东西都是 SQL，它不适合展示，恕我直言，好的设计。

因此，我的建议是使用设计良好的对象库对您有点熟悉的东西进行一些编程。我不知道该指向哪里 - Visual Studio 有点庞大，Office 对象模型有点难以掌握，直到你花了一些时间使用它们......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T04:43:31.753

您还应该有**面向对象的分析和设计应用程序 - Grady Booch**。

对于对 OOAD 感兴趣的人来说，这是必须的

# .net - 如何使用 NHibernate 模式生成更新数据库表模式？

> ID：366176
> 
> 赞同：54
> 
> 时间：2008-12-14T04:28:27.183
> 
> 标签：.net, nhibernate, orm, fluent-nhibernate, schema

我试图弄清楚如何使用 NHibernate 配置和映射来更新表模式，而不是删除和重新创建它们。

目前我正在使用`NHibernate.Tool.hbm2ddl.SchemaExport`带有 FluentNHibernate 的 obj 来为 mysql 数据库生成数据库模式。虽然我不能说这是一个大问题，但每当我调用`SchemaExport.Execute`数据库时，它都会删除所有表，然后重新创建它们。

更酷的是，如果我可以让它更新现有的表结构，尽可能地保留数据。但我真的不想使用商业产品或代码生成器，因为我一般不喜欢代码生成，而且我不需要这个，我会考虑为此付费。因此，希望任何答案都能牢记这些警告。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-02T15:49:51.033

**SchemaUpdate**对象通过在 调用它的函数时显然生成和执行一系列**SQL UPDATE**语句（以及约束语句）来提供数据库模式更新。`void Execute(bool script, bool doUpdate)`SchemaUpdate 类位于`NHibernate.Tool.hbm2ddl`命名空间中，可以在 Nhibernate.dll 文件中找到。

SchemaUpdate 在 nhibernate 1.0.2 工具集指南的第 15 章中提到，[here](http://users.telenet.be/christianr/a_nodig_samen/VBNet/NHibernate%20Reference.pdf)（第 15.1.5 节）。

“NHibernate FAQ”有（链接现已过期）如何使用 SchemaUpdate 的更完整示例：

```
[Test]
public void Update_an_existing_database_schema()
{
    _cfg = new Configuration();
    _cfg.Configure();
    _cfg.AddAssembly(Assembly.LoadFrom("DataLayer.dll"));
    var update = new SchemaUpdate(_cfg);
    update.Execute(true, false);
} 
```

# php - Hotmail / Yahoo（其他？）阻止电子邮件通知？

> ID：366183
> 
> 赞同：1
> 
> 时间：2008-12-14T04:40:28.173
> 
> 标签：php, email-notifications, email-bounces

我有一个网站（目前正在为第三方开发，很抱歉我无法显示），要求用户在注册网站时点击发送到他们电子邮件地址的链接来确认他们的联系信息.

这是一种非常标准的做法，不是非常技术性或独特性，这就是为什么我惊讶地发现 Hotmail 和 Yahoo（也许还有其他人，我不确定）正在阻止通过运行的 PHP 代码动态生成的任何电子邮件网站。

我正在使用 PHP 框架 CodeIgniter，并使用他们的电子邮件库。我检查了我的代码，一切看起来都很棒，我还查看了电子邮件类，它看起来也很不错。

更不用说，发送的邮件会发送到我尝试过的所有其他邮件服务，包括 gmail 和几个 POP 帐户。这让我相信问题出在 Hotmail/Yahoo 端。

我怀疑他们是因为格式、主题内容或其他一些任意问题而故意拒绝/退回邮件。

HTML 电子邮件设计极少，仅真正将 HTML 用于标题标签和链接。消息的主题只是简单地说“欢迎来到____”，地址是“support@______.com”。

我的问题是，是否有任何与可能导致此问题的原因相关的文章，我可以阅读这些文章以更好地了解邮件被拒绝的原因，以便我可以解决问题？

文章或文档最好来自 Hotmail 和 Yahoo（带有内部信息），或者来自遇到相同问题并找到解决方案的人。

此外，是否有任何可用的实用程序来测试消息到达服务器后实际发生的情况（即它是被退回还是其他什么？）

非常感谢你！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T08:39:23.930

确保您的域有[SPF 记录](http://www.openspf.org/)，并且它们设置正确。这将有很长的路要走。

电子邮件可传递性是一个复杂的话题。在之前的演出中，我是[ESPC](http://www.espcoalition.org/)的成员。此[PDF 链接](http://www.espcoalition.org/ESPC_Authentication_Report.pdf)可能有用，也可能已过时。另请参阅this other [similar SO question](https://stackoverflow.com/questions/250234/sending-mail-with-php-escaping-hotmails-junk-folder)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T04:53:27.133

我的朋友有一个通知系统，他的 PHP 代码使用 SMTP 发送通知。所以他的通知实际上是从他的 Gmail 帐户发送的。他这样做是为了防止 hotmail/etc 自动阻止电子邮件。

我不知道这是否有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T22:03:31.203

您的电子邮件以什么标题结尾？它是否在电子邮件中包含足够的“有价值的文本”，或者它是否主要是链接（到您的站点、确认链接、“联系我们”链接……）。这可以在垃圾邮件过滤器中发挥重要作用，以确定电子邮件是否包含原始和有价值的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T13:38:48.677

我遇到了类似的问题 - 只有 hotmail.com。Gmail 和当地的国家供应商工作正常。我的邮件是这样组合的：

```
 $headers  = "MIME-Version: 1.0\r\n";
 $headers .= "Content-type: text/plain; charset=iso-8859-1\r\n";
 $headers .= "X-Priority: 1\r\n";
 $headers .= "X-MSMail-Priority: High\r\n";
 $headers .= "X-Mailer: Company name\r\n";
 $headers .= "From: \"Company name\" <info@company.ee>";
 mail($email, "title", $message, $headers,"-finfo@company.ee"); 
```

欢迎所有建议

# sql-server - Sql Server 唯一键也是索引吗？

> ID：366186
> 
> 赞同：52
> 
> 时间：2008-12-14T04:47:54.460
> 
> 标签：sql-server, indexing, unique-key

我在表中有一个列（例如用户名），我想确保它是唯一的。因此，我为该列创建了一个唯一键并将其命名为 IX_Users_UserName。

现在，如果我根据用户名进行大量搜索，我想确保该字段有一个索引。

我是否需要创建单独的索引，或者唯一键是否也被视为索引，就像主键是聚集唯一键一样？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-14T05:11:54.660

> 唯一键：唯一键强制在其上定义它们的列的唯一性。Unique Key 在列上创建一个非聚集索引。Unique Key 只允许一个 NULL 值。
> 
> 更改表以向列添加唯一约束：
> 
> ALTER TABLE 作者添加约束 IX_Authors_Name UNIQUE(Name) GO

[来源](http://blog.sqlauthority.com/2007/02/05/sql-server-primary-key-constraints-and-unique-key-constraints/)

[来自MSDN](http://msdn.microsoft.com/en-us/library/aa224827(SQL.80).aspx)的更多信息。

FWIW - 如果您的约束不创建索引，我会避免命名它`IX_`，因为通常假定它与一个（IX = 索引）相关联。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-16T21:39:48.223

基本上，在 SQL Server 中，唯一约束确实是通过唯一索引来实现的。

UNIQUE 约束和 UNIQUE INDEX 之间的区别非常微妙，真的。如果创建 UNIQUE INDEX，则可以在另一个表的外键约束中引用它（如果创建 UNIQUE 约束则不起作用....）。

那么有什么区别呢？好吧 - 唯一约束实际上更像是表上的逻辑事物 - 您想要表达给定列（或列组）的内容是唯一的意图。

唯一索引（像大多数索引一样）更多的是“幕后”实现细节。

从我的角度来看，除非你真的有问题，否则我总是使用 UNIQUE INDEX - 作为参照完整性约束的一部分的好处是非常有效的，并且在某些情况下非常有用。在功能上，实际上，使用唯一约束与唯一索引之间没有区别，真的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T04:51:55.620

唯一键是我怀疑几乎所有数据库产品中的索引。必须如此，否则数据库将很难执行它：当您插入一个值时，数据库必须回答“该值是否已经存在？” 明智的做法是查阅索引。

我面前没有要测试的 SQL Server，但如果没有，我会感到震惊。

# language-agnostic - 程序化音频入门

> ID：366187
> 
> 赞同：35
> 
> 时间：2008-12-14T04:50:02.850
> 
> 标签：language-agnostic, audio

我正在寻求帮助，开始以编程方式处理音频。

具体来说，我正在使用的平台公开 API 以从资源（如 MP3）中提取音频数据，或将任意数据作为音频播放。在这两种情况下，实际数据都是代表 44.1 KHz 立体声的 32 位浮点字节数组。我正在寻找的是帮助理解这些浮动代表什么，以及可以用它们做什么样的事情来动态分析或修改它们所代表的声音。

我需要学习什么样的概念才能以这种方式处理音频？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-12-14T06:57:19.037

正如一些人在评论中指出的那样，您要查看的是[PCM audio](http://en.wikipedia.org/wiki/Pulse-code_modulation)。

简而言之，[声音](http://en.wikipedia.org/wiki/Sound)是一种在空气中传播的波。为了捕捉这种声音，我们使用了一个[麦克风](http://en.wikipedia.org/wiki/Microphone)，它包含一个薄膜，当声波撞击它时会振动。这种振动被转化为电信号，电压在此上升和下降。然后，这种电压变化由[模数转换器](http://en.wikipedia.org/wiki/Analog-to-digital_converter)(ADC) 通过每秒采样一定次数（“[采样率](http://en.wikipedia.org/wiki/Sampling_rate)” - 44 KHz，或每秒 44,100 个样本）转换为数字信号，并且在当前情况下，存储为脉冲编码调制 (PCM) 音频数据。

[扬声器](http://en.wikipedia.org/wiki/Loudspeaker)在对面工作；PCM 信号通过[数模转换器](http://en.wikipedia.org/wiki/Digital-to-analog_converter)(DAC) 转换为模拟信号，然后模拟信号进入扬声器，在扬声器中振动薄膜，在空气中产生振动，从而产生声音。

**操纵音频**

有许多库可以用于许多语言，您可以使用它们来处理音频，但是您已将此问题标记为“与语言无关”，我将提到一些简单的方法（因为这就是我所知道的！），您将能够以您喜欢的语言处理音频。

我将以伪代码的形式展示代码示例。

伪代码将使每个音频样本的幅度在 -1 到 1 的范围内。这取决于您用于存储每个样本的数据类型。（我之前没有处理过 32-bit `float`，所以这可能会有所不同。）

**放大**

为了放大音频（因此，增加声音的音量），您需要使扬声器的振动更大，从而增加声波的幅度。

为了使扬声器移动得更多，您必须增加每个样本的值：

```
original_samples = [0, 0.5, 0, -0.5, 0]

def amplify(samples):
    foreach s in samples:
        s = s * 2

amplified_samples = amplify(original_samples)

// result: amplified_samples == [0, 1, 0, -1, 0] 
```

生成的样本现在被放大了 2，在播放时，它听起来应该比以前响亮得多。

**安静**

当没有振动时，就没有声音。可以通过将每个样本降至 0 或任何特定值来实现静音，但样本之间的幅度没有任何变化：

```
original_samples = [0, 0.5, 0, -0.5, 0]

def silence(samples):
    foreach s in samples:
        s = 0

silent_samples = silence(original_samples)

// result: silent_samples == [0, 0, 0, 0, 0] 
```

播放上述内容应该不会发出声音，因为扬声器上的膜根本没有移动，因为样本中的幅度没有变化。

**加速和减速**

加速和减速可以通过两种方式实现：（1）改变回放采样率或（2）改变样本本身。

将播放采样率从 44100 Hz 更改为 22050 Hz 将使播放速度降低 2。这将使声音变慢且音调较低。从 22 KHz 音源以 44 KHz 播放，声音会非常快且高音，就像鸟儿的啁啾。

更改样本本身（并保持恒定的播放采样率）意味着样本（a）被丢弃或（b）被添加。

*要加快*音频的播放速度，请丢弃样本：

```
original_samples = [0, 0.1, 0.2, 0.3, 0.4, 0.5]

def faster(samples):
    new_samples = []
    for i = 0 to samples.length:
        if i is even:
            new_samples.add(samples[i])
    return new_samples

faster_samples = faster(original_samples)

// result: silent_samples == [0, 0.2, 0.4] 
```

上述程序的结果是音频将加速 2 倍，类似于以 44 KHz 播放以 22 KHz 采样的音频。

*要减慢*音频的播放速度，请输入一些示例：

```
original_samples = [0, 0.1, 0.2, 0.3]

def slower(samples):
    new_samples = []
    for i = 0 to samples.length:
        new_samples.add(samples[i])
        new_samples.add(interpolate(s[i], s[i + 1]))
    return new_samples

slower_samples = slower(original_samples)

// result: silent_samples == [0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3] 
```

在这里，添加了额外的样本，从而减慢了播放速度。在这里，我们有一个`interpolation`函数可以“猜测”如何填充需要添加的额外空间。

**通过 FFT 进行频谱分析和声音修改**

使用一种称为[快速傅里叶变换](http://en.wikipedia.org/wiki/Fast_Fourier_transform)(FFT) 的技术，可以将幅度-时间域中的声音数据映射到频率-时间域以找出音频的频率分量。这可用于生成您可能在您最喜欢的音频播放器上看到的[频谱分析仪。](http://en.wikipedia.org/wiki/Spectrum_analyzer)

不仅如此，因为现在你有了音频的频率分量，如果你改变

如果要截断某些频率，可以使用 FFT 将声音数据转换到频时域，并将不需要的频率分量清零。这称为[过滤](http://en.wikipedia.org/wiki/Band_pass_filter)。

*制作一个允许高于某个频率的频率的[高通滤波器](http://en.wikipedia.org/wiki/High-pass_filter)*可以这样执行：

```
data = fft(orignal_samples)

for i = (data.length / 2) to data.length:
    data[i] = 0

new_samples = inverse_fft(data) 
```

在上面的示例中，中途标记上的所有频率都被截止。因此，如果音频可以产生 22 KHz 作为最大频率，则任何高于 11 KHz 的频率都将被切断。（对于以 44 KHz 播放的音频，可以产生的最大理论频率为 22 KHz。请参阅[Nyquist-Shannon 采样定理](http://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem)。）

如果您想做一些诸如增加低频范围（类似于低音增强效果）之类的操作，请取 FFT 转换数据的低端并增加其幅度：

```
data = fft(orignal_samples)

for i = 0 to (data.length / 4):
    increase(data[i])

new_samples = inverse_fft(data) 
```

这个例子增加了音频的低频分量的四分之一，导致低频变得更响亮。

* * *

可以对样本做很多事情来操纵音频。继续尝试吧！这是最令人兴奋的学习方式。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-14T06:15:04.800

看来您想了解更多有关[PCM 音频的信息](http://en.wikipedia.org/wiki/Pulse-code_modulation)

基本上每个 32 位值代表指定时间的电压电平。由于采样频率为 44100Hz，因此每个通道每秒可获得 441000 个 32 位值（* 2，因为您有立体声）

对于立体声，左右声道通常是交错的，因此第一个样本代表左声道，第二个样本代表右声道，依此类推。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T09:42:52.640

要了解这些 32 位浮点数数组代表什么，您需要阅读一篇很好的 Digital Audio 简介。

如果您在 Curtis Roads 的“计算机音乐教程”图书馆附近，可能会有用。特别是第一章“数字音频概念”。（虽然我已经很久没有读过这本书了）。

一旦你了解了数字音频，就有很多方法可以操纵它。当您准备好时，这些链接可能会有所帮助。

KVR Audio的[Dsp + 插件开发论坛](http://www.kvraudio.com/forum/viewforum.php?f=33)是提问的地方。这里的帖子通常分为一般音频 DSP 和 VST 插件主题。

[MusicDsp](http://www.musicdsp.com/ "音乐DSP")有很多代码片段。

[The Scientist and Engineer's Guide to Digital Signal Processing](http://www.dspguide.com/) 是一本免费的在线教科书，深入探讨了标准 DSP 主题。其中大部分也适用于数字音频。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-27T21:34:36.750

我最近发布了一个类似的问题：[good audio dsp tutorials](https://stackoverflow.com/questions/5175874/where-can-i-find-good-tutorials-on-writing-audio-dsp-filters-lowpass-etc)。

黄金链接当然是[The Audio EQ Cookbook](http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt)，如果您想编写并理解 EQ，但更一般地说，[musicdsp.org 档案](http://www.musicdsp.org/archive.php)是我找到的音频 DSP 编码的最佳资源。

这是我在 Flash 中共同制作的合成器（“Soundoid”）的视频： [http ://www.youtube.com/watch?v=O-1hHiA7y4o](http://www.youtube.com/watch?v=O-1hHiA7y4o)

你可以在这里玩它：[http ://www.zachernuk.com/2011/03/28/soundoid-audio-synthesizer-v0-5/](http://www.zachernuk.com/2011/03/28/soundoid-audio-synthesizer-v0-5/)

# sql-server-2008 - 我需要对这个表有一个特殊的数据库约束吗？

> ID：366189
> 
> 赞同：1
> 
> 时间：2008-12-14T04:52:01.177
> 
> 标签：sql-server-2008, unique-constraint

我在我们的数据库中有一个评论系统。就像 stackoverflow -> 每个帖子都有一个评论列表。科尔。

匿名用户也可以添加评论或注册用户。

在我的表中，我正在考虑以下内容：

*   用户ID int NULLABLE
*   AnonymousNickname varchar(100) NULLABLE
*   AnonymousEmail varchar(200) NULLABLE

现在它只能是其中之一。你要么注册，要么没有。

所以我应该强制执行某种类型的约束，说*一个或另一个*..如果是这样，怎么做？

注意：数据库是 Microsoft Sql Server 2008。

干杯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T05:04:33.380

一个简单的约束是

```
(Userid is not null and AnonymousNickname is null and AnonymousEmail is null)
or (Userid is null and AnonymousNickname is not null and AnonymousEmail is not null) 
```

这将强制只设置一个或另一个。根据您的应用程序，这听起来是合理的。由您决定在数据库或应用程序中强制执行它。如果它是应用程序的其他部分所依赖的硬约束，那么我可能会在数据库中强制执行它并通过代码中的验证来检测它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T06:21:24.350

我不会包括约束。您应该将匿名名称字段重命名为 name。当注册用户发表评论时，将他们的用户名输入名称字段。当您列出您的评论时，这可以节省您对用户表的查找。此外，如果从用户表中删除用户，他们的评论会比他们更长寿。

# java - 正则表达式用于在没有被单引号或双引号包围时使用空格分割字符串

> ID：366202
> 
> 赞同：126
> 
> 时间：2008-12-14T05:18:30.887
> 
> 标签：java, regex, split

我是正则表达式的新手，非常感谢您的帮助。我正在尝试组合一个表达式，该表达式将使用所有未被单引号或双引号包围的空格来拆分示例字符串。我的最后一次尝试看起来像这样：`(?!")`并且不太有效。它在报价前的空间上分裂。

示例输入：

```
This is a string that "will be" highlighted when your 'regular expression' matches something. 
```

期望的输出：

```
This
is
a
string
that
will be
highlighted
when
your
regular expression
matches
something. 
```

请注意`"will be"`并`'regular expression'`保留单词之间的空格。

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2008-12-14T13:07:29.240

我不明白为什么所有其他人都提出如此复杂的正则表达式或如此长的代码。本质上，您想从字符串中获取两种内容：不是空格或引号的字符序列，以及以引号开头和结尾的字符序列，两者之间没有引号，用于两种引号。您可以使用此正则表达式轻松匹配这些内容：

```
[^\s"']+|"([^"]*)"|'([^']*)' 
```

我添加了捕获组，因为您不希望列表中出现引号。

此 Java 代码构建列表，如果匹配则添加捕获组以排除引号，如果捕获组不匹配（匹配未引用的单词），则添加整体正则表达式匹配。

```
List<String> matchList = new ArrayList<String>();
Pattern regex = Pattern.compile("[^\\s\"']+|\"([^\"]*)\"|'([^']*)'");
Matcher regexMatcher = regex.matcher(subjectString);
while (regexMatcher.find()) {
    if (regexMatcher.group(1) != null) {
        // Add double-quoted string without the quotes
        matchList.add(regexMatcher.group(1));
    } else if (regexMatcher.group(2) != null) {
        // Add single-quoted string without the quotes
        matchList.add(regexMatcher.group(2));
    } else {
        // Add unquoted word
        matchList.add(regexMatcher.group());
    }
} 
```

如果您不介意返回列表中包含引号，则可以使用更简单的代码：

```
List<String> matchList = new ArrayList<String>();
Pattern regex = Pattern.compile("[^\\s\"']+|\"[^\"]*\"|'[^']*'");
Matcher regexMatcher = regex.matcher(subjectString);
while (regexMatcher.find()) {
    matchList.add(regexMatcher.group());
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-14T06:34:05.820

StackOverflow 上有几个问题使用正则表达式在各种上下文中涵盖了相同的问题。例如：

*   [解析字符串：提取单词和短语](https://stackoverflow.com/questions/64904/)
*   [解析空格分隔文本的最佳方法](https://stackoverflow.com/questions/54866/)

**更新**：用于处理单引号和双引号字符串的示例正则表达式。参考：[我如何在字符串上拆分，除非在引号内？](http://www.perlmonks.org/?node_id=29461)

```
m/('.*?'|".*?"|\S+)/g 
```

使用快速 Perl 片段对此进行了测试，输出如下所示。如果它们在引号之间（不确定是否需要），也适用于空字符串或仅限空格的字符串。

```
This
is
a
string
that
"will be"
highlighted
when
your
'regular expression'
matches
something. 
```

请注意，这确实在匹配值中包含引号字符本身，尽管您可以使用字符串替换将其删除，或者修改正则表达式以不包含它们。我暂时把它作为练习留给读者或另一张海报，因为凌晨 2 点太晚了，不能再弄乱正则表达式了；）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-14T06:45:11.790

如果你想在字符串中允许转义引号，你可以使用这样的东西：

```
(?:(['"])(.*?)(?<!\\)(?>\\\\)*\1|([^\s]+)) 
```

带引号的字符串将是第 2 组，单个未引用的单词将是第 3 组。

您可以在此处尝试各种字符串：[http](http://www.fileformat.info/tool/regex.htm) ://www.fileformat.info/tool/regex.htm或[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-12T09:17:21.530

Jan Goyvaerts 的正则表达式是我迄今为止找到的最佳解决方案，但也创建了空（null）匹配，他在他的程序中排除了这些匹配。这些空匹配也出现在正则表达式测试器中（例如 rubular.com）。如果您将搜索转为 arround（首先查找引用的部分，然后查找空格分隔的单词），那么您可以使用以下方法进行一次：

```
("[^"]*"|'[^']*'|[\S]+)+ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-15T03:33:39.260

```
(?<!\G".{0,99999})\s|(?<=\G".{0,99999}")\s 
```

这将匹配没有被双引号包围的空格。我必须使用 min,max {0,99999} 因为 Java 不支持 * 和 + 在后视。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-14T06:02:47.960

搜索字符串，抓取每个部分，而不是拆分它可能会更容易。

原因是，您可以在 之前和之后的空格处拆分它`"will be"`。但是，我想不出任何方法来指定忽略拆分内部之间的空间。

*（不是实际的 Java）*

```
string = "This is a string that \"will be\" highlighted when your 'regular expression' matches something.";

regex = "\"(\\\"|(?!\\\").)+\"|[^ ]+"; // search for a quoted or non-spaced group
final = new Array();

while (string.length > 0) {
    string = string.trim();
    if (Regex(regex).test(string)) {
        final.push(Regex(regex).match(string)[0]);
        string = string.replace(regex, ""); // progress to next "word"
    }
} 
```

* * *

此外，捕获单引号可能会导致问题：

```
"Foo's Bar 'n Grill"

//=>

"Foo"
"s Bar "
"n"
"Grill" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-14T06:16:35.920

`String.split()`在这里没有帮助，因为无法区分引号内的空格（不要拆分）和引号外的空格（拆分）。`Matcher.lookingAt()`可能是你需要的：

```
String str = "This is a string that \"will be\" highlighted when your 'regular expression' matches something.";
str = str + " "; // add trailing space
int len = str.length();
Matcher m = Pattern.compile("((\"[^\"]+?\")|('[^']+?')|([^\\s]+?))\\s++").matcher(str);

for (int i = 0; i < len; i++)
{
    m.region(i, len);

    if (m.lookingAt())
    {
        String s = m.group(1);

        if ((s.startsWith("\"") && s.endsWith("\"")) ||
            (s.startsWith("'") && s.endsWith("'")))
        {
            s = s.substring(1, s.length() - 1);
        }

        System.out.println(i + ": \"" + s + "\"");
        i += (m.group(0).length() - 1);
    }
} 
```

产生以下输出：

```
0: "This"
5: "is"
8: "a"
10: "string"
17: "that"
22: "will be"
32: "highlighted"
44: "when"
49: "your"
54: "regular expression"
75: "matches"
83: "something." 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-21T20:27:48.477

我喜欢 Marcus 的方法，但是，我对其进行了修改，以便允许引号附近的文本，并支持 " 和 ' 引号字符。例如，我需要 a="some value" 而不将其拆分为 [a=, "一些价值”]。

```
(?<!\\G\\S{0,99999}[\"'].{0,99999})\\s|(?<=\\G\\S{0,99999}\".{0,99999}\"\\S{0,99999})\\s|(?<=\\G\\S{0,99999}'.{0,99999}'\\S{0,99999})\\s" 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-05-27T01:46:21.247

Jan 的方法很棒，但这是另一种记录。

如果您确实想按照标题中所述进行拆分，将引号保留在`"will be"`and中`'regular expression'`，那么您可以使用这种方法，该方法直接[匹配（或替换）模式，但在 s1、s2、s3 等情况下除外](https://stackoverflow.com/questions/23589174/match-or-replace-a-pattern-except-in-situations-s1-s2-s3-etc/23589204#)

正则表达式：

```
'[^']*'|\"[^\"]*\"|( ) 
```

左边的两个交替匹配完成`'quoted strings'`和`"double-quoted strings"`。我们将忽略这些匹配。右侧匹配并捕获第 1 组的空格，我们知道它们是正确的空格，因为它们没有被左侧的表达式匹配。`SplitHere`我们用then split on替换那些`SplitHere`。同样，这是针对您想要的真正拆分案例`"will be"`，而不是`will be`.

这是一个完整的工作实现（参见[在线演示](http://ideone.com/rorUqp)的结果）。

```
import java.util.*;
import java.io.*;
import java.util.regex.*;
import java.util.List;

class Program {
public static void main (String[] args) throws java.lang.Exception  {

String subject = "This is a string that \"will be\" highlighted when your 'regular expression' matches something.";
Pattern regex = Pattern.compile("\'[^']*'|\"[^\"]*\"|( )");
Matcher m = regex.matcher(subject);
StringBuffer b= new StringBuffer();
while (m.find()) {
    if(m.group(1) != null) m.appendReplacement(b, "SplitHere");
    else m.appendReplacement(b, m.group(0));
}
m.appendTail(b);
String replaced = b.toString();
String[] splits = replaced.split("SplitHere");
for (String split : splits) System.out.println(split);
} // end main
} // end Program 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-11-23T11:12:35.763

如果您使用的是 c#，则可以使用

```
string input= "This is a string that \"will be\" highlighted when your 'regular expression' matches <something random>";

List<string> list1 = 
                Regex.Matches(input, @"(?<match>\w+)|\""(?<match>[\w\s]*)""|'(?<match>[\w\s]*)'|<(?<match>[\w\s]*)>").Cast<Match>().Select(m => m.Groups["match"].Value).ToList();

foreach(var v in list1)
   Console.WriteLine(v); 
```

我特别添加了“ **|<(?[\w\s]*)>** ”以突出显示您可以指定任何字符来分组短语。（在这种情况下，我使用**< >**进行分组。

输出是：

```
This
is
a
string
that
will be
highlighted
when
your
regular expression 
matches
something random 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-04-09T11:58:35.377

*第一个使用 String.split() 的单线*

```
String s = "This is a string that \"will be\" highlighted when your 'regular expression' matches something.";
String[] split = s.split( "(?<!(\"|').{0,255}) | (?!.*\\1.*)" ); 
```

`[This, is, a, string, that, "will be", highlighted, when, your, 'regular expression', matches, something.]`

*不要在空格处拆分，如果空格被单引号或双引号包围，*
当左侧的 255 个字符和空格右侧的所有字符既不是单引号也不是双引号时，在空格处拆分

改编自[原始帖子](https://stackoverflow.com/questions/61104216/java-split-string-with-regex-anything-inside-double-quotes/61106447#61106447) *（仅处理双引号）*

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-14T06:31:27.497

我有理由确定仅使用正则表达式是不可能的。检查某些东西是否包含在其他标签中是一种解析操作。这似乎与尝试使用正则表达式解析 XML 的问题相同——它无法正确完成。您可以通过重复应用与引用字符串匹配的非贪婪、非全局正则表达式来获得所需的结果，然后一旦找不到其他任何内容，将其拆分为空格......问题，包括跟踪所有子字符串的原始顺序。最好的办法是编写一个非常简单的函数，它遍历字符串并取出你想要的标记。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-03-11T23:47:51.253

对 Jan 接受的答案进行了一些希望有用的调整：

```
(['"])((?:\\\1|.)+?)\1|([^\s"']+) 
```

*   允许在带引号的字符串中转义引号
*   避免重复单引号和双引号的模式；如果需要，这也简化了添加更多引用符号的过程（以另外一个捕获组为代价）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-09-12T14:01:17.297

你也可以试试这个：

```
 String str = "This is a string that \"will be\" highlighted when your 'regular expression' matches something";
    String ss[] = str.split("\"|\'");
    for (int i = 0; i < ss.length; i++) {
        if ((i % 2) == 0) {//even
            String[] part1 = ss[i].split(" ");
            for (String pp1 : part1) {
                System.out.println("" + pp1);
            }
        } else {//odd
            System.out.println("" + ss[i]);
        }
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-07-22T18:30:10.627

下面返回一个参数数组。除非包含在单引号或双引号中，否则参数是按空格分隔的变量“命令”。然后修改匹配以删除单引号和双引号。

```
using System.Text.RegularExpressions;

var args = Regex.Matches(command, "[^\\s\"']+|\"([^\"]*)\"|'([^']*)'").Cast<Match>
().Select(iMatch => iMatch.Value.Replace("\"", "").Replace("'", "")).ToArray(); 
```

# windows - EmacsW32：可以同时使用“windows key”和“alt key”绑定吗？

> ID：366211
> 
> 赞同：3
> 
> 时间：2008-12-14T05:48:53.387
> 
> 标签：windows, emacs, binding, keyboard, editor

**问题：** EmacsW32 是 Emacs 的一个版本，它允许用户让 Emacs 将“Windows”键视为“Meta”键（而不是将 Alt 键视为“Meta”键）。尽管这如宣传的那样有效，但问题是当您想为“Alt”键创建 Emacs 键绑定时会发生什么？

**问题：**在这种情况下，有没有办法允许 Emacs 捕获并创建与“Alt”键的键绑定，即使它现在认为“Windows”键是新的 Meta？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T15:08:15.613

要确定 Emacs 是否完全识别了您的 Alt 键：输入`C-h c`，然后输入一些以 Alt 开头的组合键，例如 Alt-f。
如果它显示“ `M-f runs the command forward-word`”（例如），那么 Emacs 也将您的 Alt 键视为 Meta 键，并且您绑定到 Meta 的任何内容都将与 Windows 键和 Alt 键一起使用，因此无法使 Alt键的工作方式与 Windows 键不同。
如果它显示“ `Hyper f is undefined`”或“ `Super f is undefined`”（例如），那么 Emacs 将您的 Alt 键分别识别为 Hyper 或 Super，并且您可以将命令绑定到以 Hyper 或 Super 开头的键绑定，并且这些将与您的 Alt 键一起使用。
如果它根本没有反应，则意味着它没有将 Alt 键识别为任何东西，并且您在 Emacs 中无能为力：Emacs 甚至没有获得该键。在这种情况下，正如另一个答案所说，您应该查找`xmodmap`Windows 的等价物——这与注册表有关；Windows 版 GNU Emacs 常见问题解答部分关于[如何交换 CapsLock 和 Control？](http://www.gnu.org/software/emacs/windows/Installing-Emacs.html#index-scan-codes_002c-modifying-73)有一些关于这个的相关细节（“扫描码”）；另见[这个页面](http://www.calmar.ws/vim/win-map/keymapping_win.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T10:54:59.553

您可以将 Windows 和 Alt 键都绑定到`Meta`，也可以将 Alt 键分配给不同的更改键。Emacs 提供了这些可能的绑定：

`Shift`
`Control`
`Meta`
`Hyper`
`Super`

您将不得不查看系统文档以了解如何将物理键绑定到这些（例如`man xmodmap`X 窗口）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T14:13:41.430

您可能想查看[EmacsW32 中 Super 和 Hyper 键上的线程。](https://stackoverflow.com/questions/356724/is-there-some-way-to-get-more-than-meta-and-ctrl-on-windows-long-time-emacs-use#364137)

我还没有反弹我的 Meta 键（仍然在 Alt 上——我最常使用它）但是 Super 和 Hyper 可以绑定到各种 windows 和 app 键。

# http - 代码是 HttpClient 或 servlet API 来解析 Cookie 头

> ID：366214
> 
> 赞同：3
> 
> 时间：2008-12-14T05:54:24.637
> 
> 标签：http, header, cookies, httpclient

Apache HttpClient 或 servlet API 中是否有任何现有代码来解析 Cookie 标头并从包含“name1=value1;name2=value2;...”的字符串中获取 Cookie 列表？编写代码来解析这个似乎并不难，但如果已经有一些现有的代码，我想使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T07:11:48.413

如果您在对象上调用[getCookies()](http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/http/HttpServletRequest.html#getCookies())`HttpServletRequest`，它将返回一个`Cookie`对象数组。如果您需要经常按名称查找 cookie，那么将它们放入 Map 中可能会更容易，因此查找它们很容易（而不是每次都遍历 Array）。像这样的东西：

```
public static Map<String,Cookie> getCookieMap(HttpServletRequest request) {
    Cookie[] cookies = request.getCookies();
    HashMap<String,Cookie> cookieMap = new HashMap<String,Cookie>();
    if (cookies != null) {
        for (Cookie cookie : cookies) {
            cookieMap.put(cookie.getName(), cookie);
        }
    }
    return cookieMap;
} 
```

如果您使用的是 HttpClient 而不是 servlet，则可以`Cookie`使用以下方法获取数组：

```
client.getState().getCookies() 
```

其中 client 是您的 HttpClient 对象。

# c# - C# 1.0 和 Alpha 通道中的系统图标检索

> ID：366219
> 
> 赞同：1
> 
> 时间：2008-12-14T06:09:33.733
> 
> 标签：c#, .net, winapi, api, icons

在 .NET 1.0 C# 应用程序中，我希望在列表视图控件中显示文件和文件夹列表。我想以编程方式从 Windows 检索文件或文件夹的图标，以便在列表视图中适当地显示它们。

目前，我使用的是 Windows API Shell32.dll，但图标中的 alpha 通道出现问题（图标的背景显示为黑色，而不是白色/透明）。

下面是两个代码摘录，显示了我正在尝试使用的 API，以及用于检索文件夹系统图标的实现代码（文件的代码类似）。

```
 [DllImport("Shell32.dll")]
    public static extern IntPtr SHGetFileInfo(
        string pszPath,
        uint dwFileAttributes,
        ref SHFILEINFO psfi,
        uint cbFileInfo,
        uint uFlags
        ); 
```

... *（注意：Shell32 是上述 API 的包装类）*

```
// Get the folder icon
            Shell32.SHFILEINFO shfi = new Shell32.SHFILEINFO();
            Shell32.SHGetFileInfo(  null, 
                Shell32.FILE_ATTRIBUTE_DIRECTORY, 
                ref shfi, 
                (uint) System.Runtime.InteropServices.Marshal.SizeOf(shfi), 
                flags );

            System.Drawing.Icon.FromHandle(shfi.hIcon); // Load from the handle

            // Get the icon for storage in an imagelist //
            System.Drawing.Icon icon = (System.Drawing.Icon)System.Drawing.Icon.FromHandle(shfi.hIcon).Clone(); 
```

这是正确的方法吗？

有没有更好的方法来实现这一点？

或者，我需要做些什么来正确设置图标中的 Alpha 通道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T05:22:04.047

.NET 1.x 中有一个错误，在[KB822488](http://support.microsoft.com/kb/822488)中记录（某种程度） ，其中图标中的 alpha 通道在转换为图像期间丢失（就像将它们加载到 ImageList 时一样）。不幸的是，文章中的解决方法对 ListViews 并不是特别有用。

您可以使用 Windows API 直接将图标加载到列表视图的图像列表中，绕过错误的 .NET 代码。[本文](http://vbaccelerator.com/home/NET/Code/Libraries/Shell_Projects/SysImageList/article.asp)讨论了从系统图像列表中获取图标并通过 Windows API 将它们加载到 ListView 中，以便您可以从那里获得所需的内容。

# ada - Ada 在哪里使用（除了安全关键软件）？

> ID：366225
> 
> 赞同：30
> 
> 时间：2008-12-14T06:29:32.303
> 
> 标签：ada

当人们想到艾达时，人们通常会想到航空电子设备。

我感兴趣的是 Ada 的其他一些应用？它在哪里使用？是否有任何用 Ada 编写的已交付应用程序？

例如，其中是否编写了 CRUD 应用程序？还是游戏？等等。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-14T15:51:29.003

Michael Feldman 积极维护“[谁在使用 Ada/Real-World Projects](http://www.seas.gwu.edu/~mfeldman/ada-project-summary.html) ”列表，其中列出了所有类型的军事和商业项目。而且因为他对贡献者保密，项目将在那里出现，否则他们的公司赞助商不会将其作为“Ada Inside”项目进行讨论。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-14T10:59:16.817

除了安全关键系统之外，只有当您有许多团队在一个非常大的项目上工作并且逻辑源代码行数超过大约 1 或 200 万行时，Ada 才会真正发挥作用。

正是在那个时候，你有时认为有点迂腐并增加了太多代码大小的所有 Ada 语言定义的运行时检查变得非常有用。修复数百万行代码中的某个错误从来都不是一件有趣的事；运行时检查确实有助于更早、更接近地发现问题。

不幸的是，许多专业使用过 Ada 83 或 Ada 95 的软件开发人员无法告诉您他们从事的项目。我听说它也用于空中交通管制系统（在各个国家）、铁路运输系统（如巴黎地铁和香港地铁）和银行/金融（路透社等）领域。

它是一种非常好的语言，有人提倡使用它，因为它是一种很好的语言，但有时，当你几个月或几年没有看到分段错误或真正令人讨厌的崩溃时，你开始想用 C++ 编写代码再次...

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-09T17:45:10.437

它最初是 DoD 的首选语言，因此您会在 DoD 程序中找到它。NASA 和 FAA 也是大用户。由于这个基础，许多商业航空航天也使用它（尽管这可能是“安全关键”）。例如，我认为波音 777 中的大部分软件都是在 Ada 开发的。我认为欧洲航天局也经常使用它。

也就是说，它真的没有被使用得足够多。例如，它自然几乎不受缓冲区溢出漏洞的影响，因此它确实应该是操作系统开发的首选语言。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-14T06:38:41.180

Ada 最初被设想为一种语言，用于整合用于为美国军方构建系统的大量语言。因此，您会发现它在防御系统领域的应用程序中被大量使用。有关此类应用程序的示例，请查看[Tokeneer](http://www.nsa.gov/techtrans/tokeneer_password.pdf)案例研究，其源代码现已[在线提供](http://www.adacore.com/home/gnatpro/tokeneer/)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-14T09:42:10.917

不在数量上。在[GNAT](http://www.gnu.org/software/gnat/gnat.html)出现之前，Ada 编译器和开发工具非常昂贵，通常只支持昂贵的硬件，如 Suns、Vaxen 或 IBM 大型机。

周围有一些 - 各种服装都使用[SPARK](http://en.wikipedia.org/wiki/SPARK_programming_language)做对安全至关重要的事情，但它倾向于（尽管不是唯一的）定制工作。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-14T12:14:05.183

我不确定，但是，在阅读了很多关于 Ada 的内容后，我认为它非常适合所有与物理相关的计算/自动化任务，因为所有这些编译时和运行时检查（一个很好的事情是您可以制作两种不兼容的浮点类型，例如长度和质量）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-21T20:50:19.330

Ada 在庞大的、遗留的、以政府为目标的项目中仍然很受欢迎。它也是[VHDL](https://stackoverflow.com/questions/tagged/vhdl)的基础。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-02T21:42:48.150

Ada 可以在游戏中使用。看一下这个：

[https://sourceforge.net/projects/adagate/](https://sourceforge.net/projects/adagate/)

这是将现代 OpenGL 与 Ada 结合使用的新示例（2015 年）。

# c++ - .def 文件 C/C++ DLL

> ID：366228
> 
> 赞同：26
> 
> 时间：2008-12-14T06:31:52.720
> 
> 标签：c++, c, dll

我不理解将 .def 文件与 DLL 一起使用的意义。

它似乎取代了在您的 DLL 代码中使用显式导出的需要（即显式 __declspec(dllexport)）但是我无法在不使用这些文件时生成 lib 文件，然后在使用 DLL 时会产生链接器问题。

那么在与客户端应用程序链接时如何使用 .defs，它们是否取代了使用头文件或 .lib 文件的需要？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-28T05:47:15.770

我发现同时使用 __declspec(dllexport) 和 .def 文件有助于创建可移植 DLL，即可以从使用不同编译器或不同编译器设置编译的代码调用的 DLL。

只需将 __declspec(dllexport) 放在您的函数声明中，就会导致这些函数被您的 DLL（至少在 Windows 上）“导出”，以便可以从 DLL 外部调用它们。

但是，将列出所有导出函数的 .def 文件添加到构建中可以让您阻止 Microsoft 编译器（例如）将前导下划线和尾随参数宽度信息添加到导出函数名称（至少在与 __stdcall 结合使用时）指令，对于可移植性也很有用）。例如函数声明

```
void foo(int i); 
```

如果您不注意调用约定和 .def 文件的使用，最终可能会被导出为“_foo@4”。

在将 GetProcAddress() 调用作为在运行时显式加载和挂钩到 DLL 的一部分时，保持符号表中导出的函数名称没有此类名称修饰非常方便。即在运行时获取指向上述函数 foo() 的指针（假设它完全被导出），理想情况下你只想调用：

```
HANDLE dllHandle = LoadLibrary("mydll.dll");
void* fooFcnPtr = GetProcAddress(dllHandle, "foo"); 
```

当然还有一些适当的错误案例检查！

在构建 DLL 时，在函数声明中使用 .def 文件以及 __stdcall、__declspec(dllexport) 和 extern "C" 将确保上述客户端代码适用于各种编译器和编译器设置。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-14T07:27:57.477

我的理解是 .def 文件提供了 __declspec(dllexport) 语法的替代方案，另外还有一个好处是能够显式指定导出函数的序号。如果您仅按序号导出某些函数，这将很有用，这不会显示有关函数本身的太多信息（例如：许多操作系统内部 DLL 的导出函数仅按序号）。

请参阅[参考页](https://docs.microsoft.com/en-us/cpp/build/exporting-from-a-dll-using-def-files)。

请注意，.def 文件中的名称必须与二进制文件中的名称匹配。因此，如果您将 C 或 C++ 与 'extern "C" { ... }' 一起使用，则名称不会被破坏；否则，您必须为用于生成 DLL 的特定版本的编译器使用正确的名称。__declspec() 函数自动完成这一切。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-18T02:57:46.457

对于那些仍然感兴趣的人......为了能够链接到 dll 和 def 文件，您还需要一个 lib 文件。在 Windows 中，这可以使用“LIB”工具从 def 中创建。有关执行此操作的命令行方式的示例，请参见下文。

```
lib /machine:i386 /def:sqlite3.def 
```

希望这对其他人有帮助。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-14T14:41:04.263

.DEF 文件在 16 位窗口中更常见，它们通常是指定应导出哪些符号的唯一方法。

此外，它们提供了一种按序数值（@1、@2 等）而不是按名称指定导出的方法。当性能非常重要时使用这种查找符号的方法，例如在视频驱动程序中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-14T06:41:58.240

我没有过多地使用 DLL，但我的理解是，对于导出的 C++ 函数，您应该使用“__declspec(dllexport)”，而对于导出的 C 函数，您应该编写 .def 文件。这可能是因为 C++ 函数支持重载，但 C 函数不支持。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-14T17:33:38.453

我的理解是 .def 文件实际上并没有指定需要导出哪些所有 api。它只包含导出的 api 及其序号。如果要实际导出特定的 api，则需要在 api 的定义中指定 __declspec(dllexport) 并在声明中指定 __declspec(dllimport)。

def 文件的优点是，它可以帮助您保持与已经实现的 dll 的后缀兼容性。即它维护apis 的序数。假设您在 dll 中添加了一个新的 api，然后链接器查看您的 .def 文件生成新 wapi 的序号，以便旧 api 的序号保持不变。

因此，如果客户端代码使用最新的 dll，它不会破坏现有的 api。

# java - java中的Strictfp方法有什么用？

> ID：366232
> 
> 赞同：3
> 
> 时间：2008-12-14T06:39:50.647
> 
> 标签：java, jvm

> **可能重复：**
> [何时在 java 中使用“strictfp”关键字？](https://stackoverflow.com/questions/517915/when-to-use-strictfp-keyword-in-java)

java中的Strictfp方法有什么用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-14T07:29:55.413

`strictfp`是一种方法或类修饰符，它强制 JVM 以某种方式进行浮点数学运算，这种方式保证在不同的 JVM 实现中是相同的（阻止 JVM 偷工减料以提高性能并可能失去一些精度/准确性）。

更多信息可以在[wikipedia entry](http://en.wikipedia.org/wiki/Strictfp)中找到，但细节很少。核心信息（如果您关心的话）可以在[JVM 规范](https://rads.stackoverflow.com/amzn/click/com/0201432943)中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T07:29:56.427

`strictfp`确保标记代码中的浮点运算在所有平台上的行为都相同。这是您可能在 2D/3D 编程中使用的东西，您需要确保无论您在什么平台上运行程序，都能获得完全相同的结果。

# java - 双精度值返回 0

> ID：366237
> 
> 赞同：9
> 
> 时间：2008-12-14T06:43:44.537
> 
> 标签：java, division

这是一个例子：

```
Double d = (1/3);
System.out.println(d); 
```

这将返回 0，而不是 0.33333...。

有人知道吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-12-14T06:48:11.707

那是因为`1`and`3`被视为`integers`当您没有另外指定时，所以`1/3`评估为`integer` `0`which 然后转换为`double` `0`. 要修复它，请尝试`(1.0/3)`，或者`1D/3`明确声明您正在处理双精度值。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-14T07:00:27.827

如果您有`int`要使用浮点除法除法的 s ，则必须将 s`int`转换为 a `double`：

```
double d = (double)intValue1 / (double)intValue2 
```

（实际上，我相信只有强制转换`intValue2`就足以让`intValue1`自动转换为。）`double`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T07:05:10.783

除非您需要在对象意义上使用这些值，否则请使用**double**而不是**Double 。**注意[自动装箱](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)概念

# html - 我有什么替代方法可以丑陋提交 html 表单中的按钮？

> ID：366245
> 
> 赞同：8
> 
> 时间：2008-12-14T06:54:14.703
> 
> 标签：html, forms

我想制作一个简单的 html 表单，人们可以在其中对项目进行投票或投票。但是我不喜欢 a 的默认外观`<input type="submit">`。除了笨重的默认按钮，我还有什么其他选项可以发送 POST 请求？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-14T10:24:48.273

您也可以仅使用 css 制作漂亮的按钮，这是一篇不错的文章：

[http://particletree.com/features/rediscovering-the-button-element/](http://particletree.com/features/rediscovering-the-button-element/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-14T06:57:40.687

您可以使用[图像按钮](http://www.cs.tut.fi/~jkorpela/forms/imagebutton.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-14T06:59:32.087

您也可以直接从 javascript 调用“提交”。见[这里](http://www.javascript-coder.com/javascript-form/javascript-form-submit.phtml)。

```
document.myform.submit(); 
```

这使您基本上可以使用任何东西作为提交表单的控件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-14T10:29:12.320

查看[此页面](http://www.cssbuttons.net/examples.php?skin=sample&skinName=Sample&skinClass=sample%20b#skintest)，了解使用 CSS 样式按钮可以做什么...它们会让您的网站感觉更生动，对用户而言更具交互性。

不要忘记，**您希望您的用户在您的网站上做的最后一件事就是*思考***......所以拥有明确定义的按钮是一个很大的帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-14T11:06:57.033

您可以使用 JQuery 框架的 javascript 库，您可以使用默认图像或 span 或 div 或其他任何东西甚至锚标记来提交按钮，它易于使用，并且可以通过 post 方法发布表单数据或通过 ajax 获取方法只需访问 JQuery 网站：[jQuery](http://www.jquery.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T11:25:05.827

像上面提到的技术一样，我建议使用图像按钮或设计框来创建一个漂亮而简单的 css 按钮。

简单可以很好地使用。

CSS电源：[http ://www.zengarden.com](http://www.zengarden.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-14T12:19:43.940

您可以在 YUI 中使用高度可配置的组件，例如[Button](http://developer.yahoo.com/yui/button/)。你有机会修改它的外观和很多（可能对你的需要来说太多了）额外的功能作为最重要的奖励。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-14T12:33:03.820

您可以使用 CSS 轻松设置这些按钮的样式。不幸的是，IE 不支持按钮的 :active 选择器，因此如果您对按下的按钮有单独的样式，则必须使用 JavaScript。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-14T13:39:47.723

如果您想以 ajax/web2 样式（如 stackoverflow）对项目进行投票/反对，请不要使用表单。使用 javascript，并发送异步 POST 请求并手动填充它。你可以使用 jQuery 来帮助你自动化一些东西。

快速搜索“ajax jquery”会给出一堆结果，[这是其中一个](http://www.sitepoint.com/article/ajax-jquery/)

# prototypejs - 使用原型和脚本隐藏和显示 div 元素

> ID：366251
> 
> 赞同：3
> 
> 时间：2008-12-14T06:58:32.840
> 
> 标签：prototypejs

我正在尝试使用原型和 scriptaculous 来隐藏和显示 div 元素，但是利用原型 setStyle 属性的函数（如下）不起作用，我不确定问题是什么。

```
<script type="text/javascript" language="javascript">
    function bodyOnload() {
            $('content1').setStyle({ display: 'none' });
            $('content2').setStyle({ display: 'none' });
    }
</script>    

<script type="text/javascript" language="javascript">

    var currentId = null;

    Effect.Accordion = function (contentId) {
        var slideDown = 0.5;
        var slideUp = 0.5;

        contentId = $(contentId);

        if (currentId != contentId) {
            if (currentId == null) {
                new Effect.SlideDown(contentId, {duration: slideDown});
                } else {
                new Effect.SlideUp(currentId, {duration: slideUp});
                new Effect.SlideDown(contentId, {duration: slideDown});
            }
            currentId = contentId; 
        } else {
            new Effect.SlideUp(currentId, {duration: slideUp});
            currentId = null;
        }
    };
    </script> 
```

前面的函数是这样调用的：

```
<div id="accordion">
    <div id="part1">
        <div id="nav1" onclick="new Effect.Accordion('content1');">
            Post a comment 1
        </div>
        <div id="content1">
            <form id="form" name="form" action="post.php" method="post">
            <textarea name="commentbody" cols="20" rows="10"></textarea>
            <button type="submit">Post Comment</button>
            <input type="hidden" name="blogID" value="1" />
            <input type="hidden" name="userID" value="3" />
            <input type="hidden" name="parentID" value="7" />
            <div class="spacer"></div></form>
        </div>
    </div>
        <div id="part2">
        <div id="nav2" onclick="new Effect.Accordion('content2');">
            Post a comment 2
        </div>
        <div id="content2">
            <form id="form" name="form" action="post.php" method="post">
            <textarea name="commentbody" cols="20" rows="10"></textarea>
            <button type="submit">Post Comment</button>
            <input type="hidden" name="blogID" value="1" />
            <input type="hidden" name="userID" value="3" />
            <input type="hidden" name="parentID" value="7" />
            <div class="spacer"></div></form>
        </div>
    </div>
</div> 
```

这是代码发生的情况。

*   在 ie 和 firefox 中，它什么都不做，但当您单击调用 effect.accordion 方法的链接时，该方法按预期工作。问题在于不隐藏元素的原型函数。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-14T08:31:07.770

[maxnk](https://stackoverflow.com/questions/366251/#366297)已经涵盖了主要问题。

但是，Prototype 建议使用[`dom:loaded`](http://www.prototypejs.org/api/document/observe)事件而不是`window.onload`：

```
document.observe("dom:loaded", bodyOnload); 
```

此外，您可以尝试使用 Prototype[`Element#toggle`](http://www.prototypejs.org/api/element/toggle)或[`Element#hide`](http://prototypejs.org/api/element/hide)代替`Element#setStyle`（除非每个页面上的警告适用于您的 CSS）。

```
function bodyOnload() {
    $('content1').hide();
    $('content2').hide();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T08:17:47.767

如果你想最初隐藏元素，写“函数bodyOnload”是不够的。这个函数应该在页面加载时调用，使用类似的东西：

```
window.onload = bodyOnload; 
```

当然，我建议你试试 jQuery :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T09:32:25.540

伟大的！现在可以了。你知道这是我试图学习的书中的一个例子。作者忽略了这个非常重要的部分，就像他误导性地说在 scriptaculous 中引用效果库的最佳方法是这样的：

```
<script type="text/javascript" src="javascripts/prototype.js"></script>
<script type="text/javascript" src="javascripts/scriptaculous.js?load=effects"></script> 
```

而不是喜欢：

```
<script type="text/javascript" src="javascripts/prototype.js"></script>
<script type="text/javascript" src="javascripts/effects.js"></script> 
```

这本书在亚马逊上有很好的评论，但我认为没有任何评论者试图使用这本书。他们都审查它的数量，而不是本书的实质内容。我在书中尝试使用的例子都没有奏效。我必须自己弄清楚。我想你可能会说我必须阅读本书的其他部分才能理解某个例子，但是对于这么大的一本书，真的可以做到吗？如果我必须知道作者之前提到的一些东西，我不应该被提醒一下吗，至少就一本这么大的书来说，实际上是一本参考书？如果您想知道：[Ajax：权威指南，Anthony T. Holdener III](https://rads.stackoverflow.com/amzn/click/com/0596528388)

**更新：**作者使用了旧版本的 Scriptaculous 和 Prototype 库，这就是产生误解的原因。如果你拿到这本书，请记住这一点。实际上，我现在对这本书怀有深深的敬意，即使只是因为它的剪切量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-24T16:27:03.273

感谢 SlideUp 和 SlideDown 的这些应用。

一个重要的说明：如果您没有为要显示或隐藏的 div 设置宽度，它在 ie7 和 ie8 下不起作用。

文森特

# javascript - showModelessDialog - onLoad 失败 - IE 7

> ID：366255
> 
> 赞同：4
> 
> 时间：2008-12-14T07:02:42.177
> 
> 标签：javascript, internet-explorer-7, onload

如果目标页面中有 Javascript 警报，MSIE v7 不会（在我手中）打开无模式对话框或触发 onLoad 事件。以下在 MSIE v7 中失败，但在 v6 中正常（如果需要，可以使用完整源代码的 zip 文件）。

希望其他人确认这一点并讨论为什么会这样。

index.htm（此处仅显示 javascript 函数）

```
function openDialog(n) {
  if (typeof(window.showModalDialog) == 'object')  { /* Ensure of browser support */
    var sURL = 'modeless.htm';                       /* Set the URL */
    var oWin = window.showModelessDialog(sURL);      /* Create new modeless window */
  }
  else {
    alert('"showModlessDialog" not supported!');
  }
} 
```

无模式.htm

```
<html>
  <head>
    <title>Modeless dialog</title>
  </head>
  <body bgcolor="#ff0000" text="#ffffff" onLoad="alert('Modeless is now loaded')">
    <center>
      <h1>Modeless</h1>
    </center>
    <script type="text/javascript" language="JavaScript">
      /* If the next line is included, it prevents the onLoad event occurring in MSIE v7 */
      alert('This alert stops the onLoad event in MSIE v7!');
    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T18:42:05.470

看来 IE7 正在显示正确的行为。HTML 是按顺序读取和解析的，包括脚本。当解析器到达 javascript 警报时，它会执行它并等待返回。然后，它可以完成页面解析并引发 onLoad 事件。

如果您希望在页面加载后显示警报，您必须自己处理 onLoad 事件。您可以通过以下方式本机执行此操作：

```
window.onload = function() {
    //do stuff here
} 
```

或者，您可以使用任意数量的 javascript 库来执行此操作，例如 jQuery：

```
$(document).ready(function() {
    //do stuff here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T19:00:35.877

Are you sure it's not your inline onload event that's stopping it? The code below works for me.

Index.htm

```
<html>
 <head>
  <title>Index</title>
  <script type="text/javascript" language="JavaScript">

   function openDialog() {
    if (window.showModalDialog)  { 
     var sURL = 'Modeless.htm';                       
     var oWin = window.showModelessDialog(sURL);      
    }
    else
    {
     alert('"showModlessDialog" not supported!');
    }
   }

   function addEventSimple(obj,evt,fn) {
    if (obj.addEventListener)
     obj.addEventListener(evt,fn,false);
    else if (obj.attachEvent)
     obj.attachEvent('on'+evt,fn);
    }

   function removeEventSimple(obj,evt,fn) {
    if (obj.removeEventListener)
     obj.removeEventListener(evt,fn,false);
    else if (obj.detachEvent)
     obj.detachEvent('on'+evt,fn);
    }

    addEventSimple(window, "load", openDialog);
  </script>
 </head>
 <body text="#ffffff">
  <h1 align="center">Index</h1>
 </body>
</html> 
```

Modeless.htm

```
<html>
<head>
 <title>Modeless dialog</title>
  <script type="text/javascript" language="JavaScript">
   addEventSimple(window, "load", showAlert);

   function showAlert() {
    alert('Modeless is now Loaded');
   }

   function addEventSimple(obj,evt,fn) {
    if (obj.addEventListener)
     obj.addEventListener(evt,fn,false);
    else if (obj.attachEvent)
     obj.attachEvent('on'+evt,fn);
    }

    function removeEventSimple(obj,evt,fn) {
     if (obj.removeEventListener)
     obj.removeEventListener(evt,fn,false);
    else if (obj.detachEvent)
     obj.detachEvent('on'+evt,fn);
    }
  </script>
</head>
<body text="#ffffff" >
 <h1 align="center">Modeless</h1>
  <script type="text/javascript" language="JavaScript">
   /* If the next line is included, it prevents the onLoad event occurring in MSIE v7 */
   alert('This alert stops the onLoad event in MSIE v7!');
  </script>
</body>
</html> 
```

Note: For some reason I need to clear my browser cache to get any changes to the modeless window to update.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T17:01:18.853

我认为在无模式对话框的 HTML 正文中使用 alert() 存在一些混淆。以下几点将更容易解释观察到的行为：

1.  代码检查是否支持无模式对话框（对象检测）
2.  如果是，则在上述检查中，然后进行下一步，否则显示警报。
3.  [在模态对话框中，HTML 正文由浏览器下载并按顺序解析，如另一个答案中](https://stackoverflow.com/questions/366255/showmodelessdialog-onload-failure-ie-7#387002)所指出的那样。
4.  脚本标签可以出现在正文中的任何位置，并将由 MS Windows Script Host（MSIE 的 JavaScript 引擎）解析和执行。由于模态对话框中的警报不存在于函数中，因此它最终被视为全局代码块，并在 JS 引擎执行脚本块时立即执行。
5.  警报会停止 JavaScript 的任何进一步执行。只有当用户关闭警报时，JavaScript 才会恢复执行。
6.  仅当文档已完全下载和呈现时才会触发 onload 处理程序。因此，警报的执行将延迟 onload 处理程序的执行，直到用户关闭警报，并且文档的其余部分被解析和呈现。

    [Opera 开发者社区关于 JavaScript 中的时间和同步的文章](http://dev.opera.com/articles/view/timing-and-synchronization-in-javascript/)（尽管它没有专门讨论 IE）在这种情况下是一篇非常有用的文章。

    **更新**：我尝试在服务器（Apache Tomcat）和文件系统之外运行类似的代码。看起来当我从文件系统而不是从服务器打开 index.html 时，会发生所描述的行为。IE 的区域设置可能在这里起作用。

# c++ - C++ 开发人员应该了解的有关网络编程的所有信息？

> ID：366257
> 
> 赞同：11
> 
> 时间：2008-12-14T07:03:10.427
> 
> 标签：c++, network-programming, network-protocols

因此，我正在使用 Boost::Asio（或者如果你愿意的话，也可以只使用 Asio）进行大量高性能网络编程，并且对 TCP 和 UDP 协议的基本知识有相当扎实的掌握。不过我想知道，因为尽管我有知识，但我仍然不认为自己是网络专家，什么是构建网络程序员应该知道的基本知识的好方法，特别是对于那些试图提高基于大型网络的性能的人应用程序？

有一篇关于程序员以及他们应该了解的关于内存的好文章（见下文），所以我想知道是否有人为网络整理了类似的东西。

[每个程序员都应该知道的关于内存的知识](http://people.redhat.com/drepper/cpumemory.pdf)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-14T07:25:01.350

我的一些要点是你应该知道的：

*   TCP 的工作原理和原理... 3 次握手、确认、延迟确认、nagling、滑动窗口协议。这些功能中的每一个都有一个具体的原因......如果处理不当，它们都会破坏您的应用程序的性能。
*   UDP 多播……即使您从不认为自己会使用它，您也需要知道它存在的原因，以便在设计系统时做出明智的决定。
*   IP 分片，以及 MTU 的影响。
*   二进制序列化和网络字节排序（即使您只是要使用 Google proto 缓冲区，也很高兴了解它们*为何高效）。*
*   `\r\n\r\n`Ascii 序列化和消息框架（在 HTTP中是什么意思？）
*   不同的 I/O 调度模型：Apache 风格的 preforking、thread-per-connection、基于事件的单线程、基于事件的工作线程等。
*   网络应用程序中缓冲区溢出漏洞的影响
*   基于协议的设计，与基于 API 或库的设计相反
*   异步与同步协议。许多高性能系统是异步的。HTTP 是同步的，除非你使用流水线，即使那样，对可能的事情也有很多限制……例如，没有无序响应。

* * *

更新：基于协议的设计是什么意思？

考虑一下 HTTP，Web 的协议。Apache、IIS、Lighttpd、Firefox、Opera、WebKit 等……所有这些软件都使用 HTTP。很可能他们都没有共享代码来这样做。当然，不利的一面是由于代码的净量而增加了错误的可能性。有很多好处：

*   任何程序都可以通过 HTTP 进行通信，无论实现语言如何
*   轻量级/嵌入式环境可以挑选协议的一个子集，而不是使用整个协议
*   可以针对特定情况优化协议处理程序。在不牺牲通用性的情况下优化库是不可能的。
*   各种不同的实现迫使库提供者解决错误（而不是仅仅因为每个人都使用同一个库而将它们吹走）。
*   HTTP 的用户没有组织或合同负担，也没有许可费用。

当你设计一个网络协议时，你可以自己构建几个 API，每个 API 都是针对特定用例量身定制的。或者你可以建立一个，这取决于你。联网的软件组件可以相互独立升级。基本上，您听到的所有关于 Java/C# 接口和 C++ 抽象类的优点，但都应用于网络层而不是编程语言层。

# javascript - 在 Javascript 数组中搜索 Regex，如果找到则返回 True/False (0/1)

> ID：366262
> 
> 赞同：2
> 
> 时间：2008-12-14T07:11:06.247
> 
> 标签：javascript, regex, arrays, search, grep

我需要知道如何在数组中搜索一些文字文本并将其用作是否继续的条件。

原因如下：每次执行函数时，我都会将其作用的属性的 ID 推送到数组中。我需要我的函数来检查该 ID 是否已经在数组中，如果是，请将其删除并执行我的其他函数（相反）。

这是一个示例数组：

```
var myArray = new Array();
myArray.push([1.000,1.000,"test1"]);
myArray.push([2.000,2.000,"test2"]);
myArray.push([3.000,3.000,"test3"]); 
```

我知道 Grep 函数可以搜索，但如果它找到某些东西，我无法让它评估真假。

这是我对搜索评估的理想使用。

```
function searcher(id){
    if(myArray.grep(id);){
        oppositeFunction(id);
    }else{
        function(id);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T07:37:06.600

Grep 不是标准的 javascript 数组方法。您是否使用已将此方法添加到 Array 的 javascript 库？如果是这样，你可能想看看它的实现。由于您将数组推送到数组中，因此需要能够搜索数组中每个元素的元素，而不是搜索数组本身的 id。做你想做的事情的功能是：

```
 function superContains(aray,id)
 {
      var contains = false;
      for (var i=0, len = aray.length; !contains && i < len; ++i)
      {
           var elem = aray[i];
            if (elem.constructor && elem.constructor == Array)
            {
                 contains = superContains(elem,id);
            }
            else
            {
                 contains = elem == id;   //  or elem.match(id)
            }
      }
      return contains;
 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-14T09:41:31.060

看起来您想改用哈希映射：

```
var myhash = {};

myhash["test1"] = [1.000,1.000];
myhash["test2"] = [2.000,2.000];
myhash["test3"] = [3.000,3.000];

function searcher(id){
  if (myhash[id]) {
        delete myhash[id];
        oppositeFunction(id);
    }else{
        normalFunction(id);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T07:31:50.557

```
function arraytest(){
    var myArray = new Array();  
    myArray.push(["test1"]);  
    myArray.push(["test2"]);  
    myArray.push(["test3"]);  
    for(i=0;i<myArray.length;i++){
        if(myArray[i]=="test1"){
            successFunction("Celebration\!");
        }
    }
} 
```

是一个迭代循环，它将搜索每个数组元素中的第一个对象，但它不会搜索嵌套元素，例如在我的演示数组中

# c - 64位除法

> ID：366273
> 
> 赞同：-2
> 
> 时间：2008-12-14T07:39:09.403
> 
> 标签：c, algorithm, 64-bit

谁能给我发送 ac 代码来划分 2 个 64 位数字。我的编译器只支持 32/32 除法。

感谢和问候

玛尼

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-14T08:19:26.577

您确定您的编译器不支持 64 位除法吗？如果您的 C 编译器支持 C99，则应该可以：

```
#include <stdint.h>
#include <stdio.h>
int main(void)
{
    int64_t numerator = 123;
    int64_t denominator = 10;
    int64_t quotient = numerator / denominator
    printf("%" PRId64 " / %" PRId64 " = %" PRId64 "\n",
           numerator, denominator, quotient);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-14T07:55:10.073

该代码在 linux 中可用，请参阅[div64.c](http://lxr.linux.no/linux+v2.6.22/lib/div64.c)。你能复制那个吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-14T08:56:35.923

更一般的想法是使用多精度库，如[GMP](http://gmplib.org/)。

> GMP 是用于任意精度算术的免费库，可对有符号整数、有理数和浮点数进行操作。除了运行 GMP 的机器中的可用内存所暗示的精度外，对精度没有实际限制。GMP具有丰富的功能集，并且功能具有规则的接口。

浮点除法处理`void mpf_div (mpf_t rop, mpf_t op1, mpf_t op2)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T19:20:33.103

很可能，除法限制源于您正在编译 32 位而不是 64 位这一事实。

我不记得看到处理 x86 的 64 位的整数除法指令。它会将 2 个 32 位整数相乘，然后将结果拆分到 2 个寄存器中，但据我记得不是除法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-11T01:33:56.840

在 Linux 内核中寻找其他地方：[udivdi3.c](http://lxr.linux.no/#linux+v2.6.12/arch/arm/lib/udivdi3.c)

这应该准确地提供 GCC 在遇到 64 位除法时使用的功能。

# user-interface - 没有 Linux 的嵌入式系统的图形库？

> ID：366278
> 
> 赞同：10
> 
> 时间：2008-12-14T07:47:53.847
> 
> 标签：user-interface, graphics, embedded, microcontroller

似乎任何类型的图形库，如[DirectFB](http://www.directfb.org/)或[MiniGui 都](http://www.minigui.org/)需要某种底层操作系统，如 Linux 或 uClinux。

我面临着为只有 512kb 闪存、LCD 显示屏和触摸屏的微控制器编写软件来显示和处理一些图片和 GUI 部件的挑战。

你知道任何库只需要一个指向视频内存的指针，也可以处理线条、图像和字体吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T14:49:47.787

多年来，我们一直使用 Swellsoftware 的 C++ 版本“PEG”。它是商业软件，不是免费的，但底层屏幕驱动程序可以只使用指向图形内存的指针，并且它们为不同类型的图形硬件提供了许多示例驱动程序。我们使用示例驱动程序作为参考，为我们的专有硬件编写了自己的自定义驱动程序。我们一直都有某种 RTOS，但我相信 PEG+ 也可以在没有操作系统的情况下运行。

在这里查看： [http ://www.swellsoftware.com/](http://www.swellsoftware.com/)

祝你好运，

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T22:19:16.897

当您合并一些第三方解决方案时，您可能只是自己编写了它。

对于大多数（如果不是全部）环境来说，屏幕只是一个二维像素阵列。有时托盘化有时没有，但这没关系，你可以随心所欲地写你的。

有大量的免费代码用于绘制线条和弧线等。

杀手可能是字体，但我认为您会发现第三方应用程序只会在处理字体时占用您所有的内存，您的资源有限，因此您需要预先计算字体并复制位。

制作一个二维数据数组，首先在您喜欢的主机上完成所有工作，如果您想查看您正在绘制的内容，保存 .bmp 文件很简单，将一系列 .bmp 文件转换为 .bmp 文件也很简单视频，如果你想看一些动作。

如果您使用通用 C，并且没有 libc 调用（编写您自己的 memcpy、memset 等），则此代码将在任何地方运行，在用于开发的主机上和目标上。

字体将成为你的杀手，你必须预先计算它们，但设法将这些信息压缩到尽可能小，并在运行时提取数据并将每个字母的位尽可能快地复制到虚拟屏幕中.

或者只是购买为您完成所有这些工作的众多 lcd 解决方案中的一种，您只需向它发送命令，例如 draw "Hello World!" 在某些 (x,y) 处，使用蓝色作为前景，白色作为背景。

基本上我认为非操作系统解决方案仍然会使用太多库并且对于您的特定应用程序来说太大了。2d 字节或像素数组很容易管理自己。即使您正在为桌面平台编写应用程序，我也会这样做，并在最后一刻将完全渲染的屏幕更新复制到一些依赖于操作系统的库（允许从一个操作系统到另一个操作系统的最大可移植性）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-14T08:39:06.787

如果您对交互性和 GUI 小部件的要求非常适中（或者您可以设计自己的小部件），请查看[LibGD](http://www.libgd.org/)。使用库的函数绘制您希望出现在屏幕上的图像，然后使用 gdImagePngToSink() 将其写入帧缓冲区。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T13:59:17.973

您应该关注的重要事情是 LCD 和触摸屏的控制器。该任务有大量的 C 库（不是免费的）。一个快速的谷歌让我得到了这些结果：[Simplify Technologies](http://www.simplify-technologies.de/gui_library/index.html)和[Ramtex](http://www.ramtex.dk/products/prodgui.htm)。

如果你想找到一些开源的东西，那么从你的控制器类型开始，搜索嵌入式设备论坛（即使它不是 ARM，你也可以轻松移植 C 代码）。一些建议：

*   [AVRFreaks](http://www.avrfreaks.net/)
*   [手臂论坛](http://forums.arm.com/)

此外，一些套件制造商在他们的板上提供了一个 SDK（有和没有 Linux）。购买电路板通常会给您使用代码的许可。搜索具有相同 LCD 控制器的开发板。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T14:25:17.147

不是免费的，但在低资源系统上很好：[http](http://www.tat.se) : //www.tat.se 及其产品 Kastor 和 Cascades。它只需要一个指向视频内存、malloc 和看起来像文件系统的东西的指针。最后两个要求也不是绝对必要的。不需要操作系统。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-25T23:13:48.840

对于尽可能小的占用空间，您应该真正考虑 RamTEX。我已经在两个带有 8 位 PICS 的项目中使用了它。在我的应用程序中，ROM 空间约为 35K，RAM 约为 1K（数量取决于您是否需要 RAM 缓冲用于显示）。ROM 空间取决于您想要或需要的图形功能。

他们提供完整的来源，一次性价格相当不错，不到 1000 美元（请注意，他们网站上列出的价格必须转换为美元，或者您的货币是什么）。没有版税或每个产品的限制。

它们提供了许多不同大小和样式的字体和基本的绘图调用（线、像素、框等）。它没有任何已定义的“对象”，例如按钮或菜单，但我能够轻松实现弹出菜单。它确实支持“视口”，可用于定义文本框、菜单等，每个都有自己的属性。

它还带有一个在 PC 上运行的模拟器，因此您可以在迁移到嵌入式系统之前在桌面上开发显示代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T09:40:24.673

您可能需要使用运行长度编码 (RLE) 来压缩字体。有关示例，请参阅 .pcx 文件格式，尽管最好设计一个自定义 RLE。您没有指定 LCD 的位深度，但如果不需要抗锯齿，字体需要每像素一位，或者使用抗锯齿最多需要三个 BPP。每个字符都必须有自己的宽度，因为等宽文本不好。您应该使用优化的例程直接从 RLE 压缩字体渲染到屏幕。

SDL 是一个非常便携的图形库。它用于嵌入式 Linux 系统，但我认为它可以在没有操作系统的情况下使用。SDL 的好处是您可以使用 Windows / Linux 来开发和测试您的 UI，然后以您的嵌入式系统为目标。无需更改应用程序代码！

您还可以在 SDL 之上使用 Anti-Grain 几何库 ( [http://www.antigrain.com/about/index.html )。](http://www.antigrain.com/about/index.html)使用 16 或 24 位 LCD，它可以产生令人惊叹的图形。对于您的环境来说，它可能有点太大了，因为我在 ARM/Linux 系统上的可执行文件大约是 1 兆字节。它包含用于字体渲染的 SDL、AGG 和 libfreetype2。AGG 也有点慢，但会产生漂亮的结果。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-24T12:36:57.710

（老问题，但我想发表我关于这个主题的发现）

对于高质量的图形，Anti-Grain Geometry 是一个不错的选择。它编译到大约 50kB，可以定制写入各种帧缓冲区和渲染设备： [http ://www.antigrain.com/](http://www.antigrain.com/)

对于用户界面，Gwen 似乎是一个不错的选择。它很容易移植，可以定制为渲染位图皮肤控件或矩形/圆形/线条形式： [https ://github.com/garrynewman/GWEN](https://github.com/garrynewman/GWEN)

然后，如果您还选择 RTOS，NuttX 有它自己的图形子系统和小部件工具包：http: [//nuttx.sourceforge.net/](http://nuttx.sourceforge.net/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T22:01:39.867

我的猜测是，像 FreeDOS 这样的东西，结合作为工具链的 DJGPP，以及作为图形库的 Allegro 可能适合 512k 的闪存并且仍然可以做合理的工作（我假设你有一个 x86，它有几 Mb 的内存)

但是这些东西是 x86 特定的（虽然 Allegro 不是）。

在 512k 内获取 Linux 内核和有用数量的用户空间软件是很棘手的（但可能会得到一些东西）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-24T12:39:48.270

你应该试试[easyGUI](http://www.easygui.com/)。

easyGUI 是一个 GUI 图形软件/库，专门设计用于小型（er）嵌入式系统。

不需要操作系统。一个基本的循环执行程序就足够了。512kb 的 Flash 应该是可以的。easyGUI 提供的库非常灵活，可以帮助您最大限度地减少所需的 Flash 数量。

支持字体、图形、位图、触摸屏和一堆开箱即用的视频控制器。

此外，它真的很便宜（没有许可费，每个席位只需固定金额），并带有一个 PC 程序来设计屏幕和生成代码。PC 程序需要一段时间来适应，但最终在 PC 上尝试某些东西然后生成并观察它在您的目标上运行是非常好的。

他们的网站上有一个演示应用程序。值得一试。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-14T08:14:13.997

512kb 很小。祝你好运！

您可能想尝试将[dsl](http://www.damnsmalllinux.org/)与[mplayer](http://www.mplayerhq.hu/)结合使用。后者不需要 GUI 来显示电影。我想它也可以显示图像。

尽管如此，我担心它对你的闪光灯来说太过分了。也许这些链接的来源会有所帮助。

# delphi - Delphi 7 & ICS 发送删除请求

> ID：366291
> 
> 赞同：3
> 
> 时间：2008-12-14T08:11:31.303
> 
> 标签：delphi, rest, delphi-7

如何使用 delphi 7 和 ICS 组件发送 DELETE 请求，以便我可以访问 REST api？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T22:33:23.277

我能找到的一切...

[http://wiki.overbyte.be/wiki/index.php/THttpCli.OnBeforeHeaderSend](http://wiki.overbyte.be/wiki/index.php/THttpCli.OnBeforeHeaderSend)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:05:56.350

另一种选择是使用[突触](http://www.ararat.cz/synapse/doku.php)库。它非常易于使用和扩展。我已经修改它以用于 REST api，没有任何重大问题。

# ruby-on-rails - 您如何使用 Ajax 请求处理 Rail 的 flash？

> ID：366311
> 
> 赞同：77
> 
> 时间：2008-12-14T08:40:04.287
> 
> 标签：ruby-on-rails, ajax

[我对我提出的解决方案](http://whatcodecraves.com/posts/2008/12/13/rails-flash-with-ajax.html)感到非常满意。基本上，我有一个辅助方法可以重新加载内联闪存，然后我有一个 after_filter，如果请求是 xhr，则清除闪存。有没有人有比这更简单的解决方案？

**更新：**上面的解决方案是在 Rails 1.x 中写回的，不再受支持。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2010-04-28T12:43:41.853

您还可以使用 after_filter 块将 flash 消息存储在响应标头中，并使用 javascript 显示它们：

```
class ApplicationController < ActionController::Base
after_filter :flash_to_headers

def flash_to_headers
  return unless request.xhr?
  response.headers['X-Message'] = flash[:error]  unless flash[:error].blank?
  # repeat for other flash types...

  flash.discard  # don't want the flash to appear when you reload page
end 
```

并在 application.js 添加一个全局 ajax 处理程序。对于 jquery 做这样的事情：

```
$(document).ajaxError(function(event, request) {
  var msg = request.getResponseHeader('X-Message');
  if (msg) alert(msg);
}); 
```

用您自己的 javascript flash 函数替换 alert() 或尝试 jGrowl。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-04-16T01:14:00.063

这是我基于@emzero 的版本，经过修改以使用 jQuery，在 Rails 3.2 上测试

### application_controller.rb

```
class ApplicationController < ActionController::Base
    protect_from_forgery

    after_filter :flash_to_headers

    def flash_to_headers
        return unless request.xhr?
        response.headers['X-Message'] = flash_message
        response.headers["X-Message-Type"] = flash_type.to_s

        flash.discard # don't want the flash to appear when you reload page
    end

    private

    def flash_message
        [:error, :warning, :notice].each do |type|
            return flash[type] unless flash[type].blank?
        end
    end

    def flash_type
        [:error, :warning, :notice].each do |type|
            return type unless flash[type].blank?
        end
    end
end 
```

### 应用程序.js

```
// FLASH NOTICE ANIMATION
var fade_flash = function() {
    $("#flash_notice").delay(5000).fadeOut("slow");
    $("#flash_alert").delay(5000).fadeOut("slow");
    $("#flash_error").delay(5000).fadeOut("slow");
};
fade_flash();

var show_ajax_message = function(msg, type) {
    $("#flash-message").html('<div id="flash_'+type+'">'+msg+'</div>');
    fade_flash();
};

$(document).ajaxComplete(function(event, request) {
    var msg = request.getResponseHeader('X-Message');
    var type = request.getResponseHeader('X-Message-Type');
    show_ajax_message(msg, type); //use whatever popup, notification or whatever plugin you want
}); 
```

### 布局：application.html.haml

```
 #flash-message
            - flash.each do |name, msg|
                = content_tag :div, msg, :id => "flash_#{name}" 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-01-15T21:40:48.933

我是这样弄的。。

**控制器**：

> ```
> respond_to do |format|
>     flash.now[:notice] = @msg / 'blah blah...'
>     format.html 
>     format.js
>   end 
> ```

**看法：**

```
<div id='notice'>
    <%= render :partial => 'layouts/flash' , :locals => { :flash => flash } %>
</div> 
```

**布局/_flash.html.erb**

```
<% flash.each do |name, msg| %>
            <div class="alert-message info"> 
                <a class="close dismiss" href="#">x</a> 
                <p><%= msg %></p>
            </div>
<% end %> 
```

**post.js.erb**

```
$("#notice").html("<%= escape_javascript(render :partial => 'layouts/flash' , :locals => { :flash => flash }).html_safe %>"); 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-01-08T11:28:14.123

这是 js 响应中需要的

*如果您使用的是 RSJ：*

```
page.replace_html :notice, flash[:notice]
flash.discard 
```

*如果您使用的是 jQuery：*

```
$("#flash_notice").html(<%=escape_javascript(flash.delete(:notice)) %>'); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-09-14T10:11:42.113

建立在他人之上——

（我们将完整的 flash 对象作为 JSON 传递，使我们能够在浏览器中重构完整的 flash 对象。这可用于确保在 Rails 生成多个 flash 消息时显示所有 flash 消息。）

```
#application_controller.rb
class ApplicationController < ActionController::Base
  after_filter :flash_to_headers

  def flash_to_headers
    if request.xhr?
      #avoiding XSS injections via flash
      flash_json = Hash[flash.map{|k,v| [k,ERB::Util.h(v)] }].to_json
      response.headers['X-Flash-Messages'] = flash_json
      flash.discard
    end
  end
end 
```

```
//application.js
$(document).ajaxComplete(function(event, request){
  var flash = $.parseJSON(request.getResponseHeader('X-Flash-Messages'));
  if(!flash) return;
  if(flash.notice) { /* code to display the 'notice' flash */ $('.flash.notice').html(flash.notice); }
  if(flash.error) { /* code to display the 'error' flash */ alert(flash.error); }
  //so forth
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-01T18:51:45.160

看起来您需要的是`flash.now[:notice]`，它仅在当前操作中可用，而在下一个操作中不可用。您可以在这里查看文档：http: [//api.rubyonrails.com/classes/ActionController/Flash/FlashHash.html#M000327](http://api.rubyonrails.com/classes/ActionController/Flash/FlashHash.html#M000327)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-08-05T11:08:39.030

像这样在控制器中分配消息：

```
 flash.now[:notice] = 'Your message' 
```

app/views/layouts/application.js.erb - Ajax 请求的布局。在这里您可以简单地使用

```
 <%= yield %>
  alert('<%= escape_javascript(flash.now[:notice]) %>'); 
```

或使用 Gritter 制作一些丰富的动画：http: [//boedesign.com/demos/gritt/](http://boedesign.com/demos/gritter/)

```
 <%= yield %>
  <% if flash.now[:notice] %>
    $.gritter.add({
      title: '--',
      text: '<%= escape_javascript(flash.now[:notice]) %>'
    });
  <% end %> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-09-12T14:20:10.500

这是我的版本（使用多个 Flash 通知和特殊字符 UTF-8 编码）：

内部应用程序控制器：

```
after_filter :flash_to_headers
def flash_to_headers
  return unless request.xhr?
  [:error, :warning, :notice].each do |type|
    if flash[type]
      response.headers["X-Ajax-#{type.to_s.humanize}"] = flash[type]
    end
  end
  flash.discard
end 
```

在我的咖啡脚本中（推特引导版本）：

```
css_class = {
    Notice: 'success',
    Warning: 'warning',
    Error: 'error'
}
$(document).ajaxComplete (event, request) ->
  for type in ["Notice", "Warning", "Error"]
    msg = request.getResponseHeader("X-Ajax-#{type}")
    if msg?
      $('#notices').append("<div class=\"alert #{css_class[type]}\">#{decodeURIComponent(escape(msg))}</div>") 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-03-26T01:49:40.443

有一个名为[Unobtrusive Flash](https://github.com/leonid-shevtsov/unobtrusive_flash)的 gem ，它会自动将 flash 消息编码到 cookie 中。客户端的 javascript 检查闪存并以您想要的任何方式显示它。这在正常和 ajax 请求中都可以无缝工作。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-09-07T23:37:58.093

我修改了 Victor S 的答案，以修复一些`flash[type].blank?`在评论中很少有人指出的不起作用的情况。

```
after_filter :flash_to_headers

def flash_to_headers
   return unless request.xhr?
   response.headers['X-Message'] = flash_message
   response.headers["X-Message-Type"] = flash_type.to_s

   flash.discard # don't want the flash to appear when you reload page
end

private

def flash_message
   [:error, :warning, :notice, nil].each do |type|
     return "" if type.nil?
     return flash[type] unless flash[type].blank?
   end
end

def flash_type
   [:error, :warning, :notice, nil].each do |type|
       return "" if type.nil?
       return type unless flash[type].blank?
   end
end 
```

然后休息是一样的

```
// FLASH NOTICE ANIMATION

var fade_flash = function() {
    $(".flash_notice").delay(5000).fadeOut("slow");
    $(".flash_alert").delay(5000).fadeOut("slow");
    $(".flash_error").delay(5000).fadeOut("slow");
};

var show_ajax_message = function(msg, type) {
    $(".flash_message").html('<div class="flash_'+type+'">'+msg+'</div>');
    fade_flash();
};

$( document ).ajaxComplete(function(event, request) {
    var msg = request.getResponseHeader('X-Message');
    var type = request.getResponseHeader('X-Message-Type');
    show_ajax_message(msg, type); //use whatever popup, notification or whatever plugin you want

}); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-02-15T18:09:28.900

基于 gudleik 回答：

```
class ApplicationController < ActionController::Base
  after_filter :flash_to_headers

def flash_to_headers
  return unless request.xhr?
  response.headers['X-Message'] = flash_message
  response.headers["X-Message-Type"] = flash_type

  flash.discard # don't want the flash to appear when you reload page
end

private

def flash_message
  [:error, :warning, :notice].each do |type|
    return flash[type] unless flash[type].blank?
  end
end

def flash_type
  [:error, :warning, :notice].each do |type|
    return type unless flash[type].blank?
  end
end 
```

然后在您的 application.js（如果您使用 Rails 原生 Prototype 助手）上添加：

```
Ajax.Responders.register({
onComplete: function(event, request) {
   var msg = request.getResponseHeader('X-Message');
   var type = request.getResponseHeader('X-Message-Type');
   showAjaxMessage(msg, type); //use whatever popup, notification or whatever plugin you want
   }
}); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-11T12:38:22.400

另一种方法是使用来自 Ajax 请求“OnFailure”处理程序的消息更新/显示“通知”div。它使您能够以所需的效果显示这些闪存消息。我用这个

```
渲染 :text => "发生了一些错误", :status => 444

```

在 Javascript 中

```
新的 AjaxRequest(...

  ,
   OnFailure：功能（运输）{
      $("#notice").update(transport.responseText);
     // 显示消息  
   }

);

```

高温高压

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-01-15T15:06:00.283

我构建了一个引擎，其中包含一些对 application_controller 的行为，以按照你们中的一些人的建议在响应标头中发送 flash 消息。

[https://github.com/bonzofenix/flajax](https://github.com/bonzofenix/flajax)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-15T11:24:36.390

我能想到的唯一改进是将 page.reload_flash 设为默认值（不必将其放在每个 rjs 文件中，如果您不想重新加载闪存，则使其显式，例如 page.keep_flash。

我不知道从哪里开始，但知道一些轨道我敢肯定这并不难。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-07-02T19:35:18.737

如果您想使用 AJAX 调用，则不应在控制器中使用 redirect_to。相反，应该明确表示 flash 消息：

**在你的控制器中：**

```
respond_to :js

def your_ajax_method
  flash[:notice] = 'Your message!'
end 
```

在 your_ajax_method_in_the_controller 命名的视图中

**your_ajax_method_in_the_controller.js.haml**

```
:plain
  $("form[data-remote]")
    .on("ajax:success", function(e, data, status, xhr) {
      $('.messages').html("#{escape_javascript(render 'layouts/messages')}");
      setTimeout(function(){ $(".alert").alert('close') }, 5000);
    }) 
```

请注意，*消息*类是呈现消息的锚点。此类应出现在您的视图或应用程序布局中。如果您使用 ERB，则该行变为`$('.messages').html("<%= j(render 'layouts/messages') %>");`

上述嵌入到 HAML/ERB 中的 JavaScript 是使用 AJAX 时显示 flash 消息的关键。对于非 AJAX 调用，所有其他组件保持不变。

您可以使用`your_ajax_method_in_the_controller.js.coffee`或普通的 .js，但随后 JS/Coffee 将无法使用 rails 变量。尽管我在这里不使用变量，但我更喜欢将 JS 包装在 HAML 中以保持代码库的一致性。

我利用 Twitter Bootstrap 来设置消息样式，从而`$(".alert").alert('close')`消除通知。这是部分*消息*：

**布局/_messages.html.haml**

```
- flash.each do |name, msg|
  - if msg.is_a?(String)
    .alert-messages
      %div{class: "alert alert-#{name == :notice ? "success" : "error"} fade in"}
        %a.close{"data-dismiss" => "alert"} 
          %i.icon-remove-circle
        = content_tag :div, msg, id: "flash_#{name}" 
```

以防万一，警报的CSS如下

```
.alert-messages {
  position: fixed;
  top: 37px;
  left: 30%;
  right: 30%;
  z-index: 7000;
} 
```

# wmi - 使用 WMI 为远程进程设置工作文件夹

> ID：366321
> 
> 赞同：1
> 
> 时间：2008-12-14T09:03:17.643
> 
> 标签：wmi, process, remote-process, working-directory

我正在使用[这篇文章](http://www.codeproject.com/KB/cs/Remote_Process_using_WMI_.aspx?fid=1531475&select=2815994#xx2815994xx)在使用 WMI 的远程机器上启动一个进程。如何控制该进程将在其中启动的工作目录？

（无需将我重定向到 psexec，我收到错误消息，目前正在尝试 WMI 方法）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T09:10:21.310

[在这里](http://msdn.microsoft.com/en-us/library/aa389388(VS.85).aspx)找到答案并进行推断。

对文章中的代码稍作修改：

inParams["CurrentDirectory"] = @"c:\WorkingDirectory";

# javascript - Javascript Window.Onload 函数链接

> ID：366324
> 
> 赞同：1
> 
> 时间：2008-12-14T09:13:16.733
> 
> 标签：javascript, function, onload, method-chaining

只是为了实验，我一直在尝试确定`window.onload`在网络浏览器中非破坏性链接功能的不同方法。这是我到目前为止的想法：

```
var load = window.onload;
var newFunction = function(){
    alert("ha!");
}
window.onload = function(){
    load();
    newFunction();
} 
```

我看到的问题是每次链接一个函数时，它都会向堆栈添加另一级函数调用。有没有更好的方法来解决这个问题，不会给调用堆栈增加不必要的深度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T09:30:27.900

使用 addEventListener/attachEvent 会更好吗？

[高级事件注册模型](http://www.quirksmode.org/js/events_advanced.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T09:29:47.090

你可以看看[jQuery](http://jquery.com/)他们是如何处理这个问题的。

来自[jQuery 文档](http://docs.jquery.com/Events/ready#fn)：

> 您可以在页面上设置任意数量的 $(document).ready 事件。然后按照添加的顺序执行这些函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T09:33:39.703

我宁愿使用“足够好”的 addEvent：

```
var addEvent = function( obj, type, fn ) {
        if (obj.addEventListener)
                obj.addEventListener(type, fn, false);
        else if (obj.attachEvent) 
                obj.attachEvent('on' + type, function() { return fn.apply(obj, new Array(window.event));});
} 
```

来自：[http ://www.ilfilosofo.com/blog/2008/04/14/addevent-preserving-this/](http://www.ilfilosofo.com/blog/2008/04/14/addevent-preserving-this/)

# .net - 等待远程进程在 .net 中完成

> ID：366326
> 
> 赞同：2
> 
> 时间：2008-12-14T09:20:01.307
> 
> 标签：.net, remote-process, waitforexit

我们都知道并喜欢 Process.WaitForExit()。

给定远程机器上进程的 pid（由 WMI/psexec 创建），我如何等待它结束？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T12:16:57.330

对我来说 Process.GetProcessByID() 只是没有工作（它声称它无法连接到机器）。这有效：

```
public static bool WaitForProcess(int pid, string machine, TimeSpan timeout)
{
  // busy wait
  DateTime start = DateTime.Now;
  while (IsAlive(pid, machine))
  {
    if (start.Add(timeout).CompareTo(DateTime.Now) <= 0)
      return false;

    Thread.Sleep(1000);
  }
  return true;
}

public static bool IsAlive(int pid, string machine)
{
  // doesn't work for me (throws "The network path was not found" exception)
  //return Process.GetProcessById(pid, @"\\" + machine) != null;
  string user;
  string domain;
  GetProcessInfoByPID(pid, machine, out user, out domain);
  return !string.IsNullOrEmpty(user);
}

public static string GetProcessInfoByPID(int PID, string machine, out string User, out string Domain)
{
  // copied from http://www.codeproject.com/KB/cs/processownersid.aspx?fid=323674&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2076667
  // with slight modifications
  ConnectionOptions connOptions = new ConnectionOptions();
  connOptions.Impersonation = ImpersonationLevel.Impersonate;
  connOptions.EnablePrivileges = true;
  ManagementScope manScope = new ManagementScope(String.Format(@"\\{0}\ROOT\CIMV2", machine), connOptions);
  manScope.Connect();

  User = String.Empty;
  Domain = String.Empty;
  string OwnerSID = String.Empty;
  string processname = String.Empty;
  try
  {
    ObjectQuery sq = new ObjectQuery
      ("Select * from Win32_Process Where ProcessID = '" + PID + "'");
    ManagementObjectSearcher searcher = new ManagementObjectSearcher(manScope, sq);
    if (searcher.Get().Count == 0)
      return OwnerSID;
    foreach (ManagementObject oReturn in searcher.Get())
    {
      string[] o = new String[2];
      //Invoke the method and populate the o var with the user name and domain
      oReturn.InvokeMethod("GetOwner", o);

      //int pid = (int)oReturn["ProcessID"];
      processname = (string)oReturn["Name"];
      //dr[2] = oReturn["Description"];
      User = o[0];
      if (User == null)
        User = String.Empty;
      Domain = o[1];
      if (Domain == null)
        Domain = String.Empty;
      string[] sid = new String[1];
      oReturn.InvokeMethod("GetOwnerSid", sid);
      OwnerSID = sid[0];
      return OwnerSID;
    }
  }
  catch
  {
    return OwnerSID;
  }
  return OwnerSID;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T10:45:27.263

```
Process.GetProcessById(processId, machineName).WaitForExit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T10:49:00.393

使用 SysInternals 的 PSLIST 轮询远程计算机。

# delphi - 为什么 Delphi 变体不能保存对象？

> ID：366329
> 
> 赞同：14
> 
> 时间：2008-12-14T09:27:08.703
> 
> 标签：delphi, oop, variant

为什么 Delphi 变体不能保存对象？更重要的是，这种限制背后的原因是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-14T10:03:53.993

您绝对可以将对象*存储*在 Variant 变量中 - 只需将其转换为 NativeUInt。无论如何，对象只是一个指针。

```
obj := TObject.Create;
v := NativeUInt(obj);
obj := TSomeObject(NativeUInt(v)); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-14T09:44:18.510

根据我对变体可以做什么和不能做什么的经验，这只是一种观点。

如果您将 COM 对象放入其中，它将存储为 IDispatch 引用，因此您在此对象上访问的任何方法调用或属性都将转换为查找方法/属性的内部 DISPID 的一些代码，一个数组将构造带有方法参数的方法，并通过 IDispatch 接口调用该方法。

换句话说，IDispatch 为您处理，您通常必须这样做，但它是由编译器自动完成的。

然而，对于普通的 Delphi 对象，事情变得更加困难。您可以使用 RTTI 来查找和调用已发布的方法和属性，仅此而已。如果您有一个未发布的、非虚拟方法的名称，Delphi 无法在您的方法上找到它的正确地址。

换句话说，你所能做的就是*拿着*这个物体，你将无法使用它。也许他们可以增加对释放它的支持，但同样，可能就是这样。

我知道一个事实，如果您正确实现 IDispatch，您可以安全地存储，并通过变体使用该对象。我有一个类可以用作您想要执行此操作的 Delphi 对象的基类。它会自动公开发布的方法/属性，如果你想通过一些受保护的方法调用，你可以添加更多。如果对这样的课程感兴趣，我可以将其放在某个地方。

但同样，这是通过 IDispatch，它使用已发布的方法，其余的是手动代码，因此对变体的支持必须由您构建到您的对象中。

这就是为什么我认为他们只是说：这只会产生抱怨，我们可以持有一个对象，但它只是没用。

但这只是我的想法。也许某个官员有一个更好的答案。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-14T14:52:33.770

我过去曾使用 Variant 来使用 Variant 内部来保存对象，代码是这样的：

```
var
  MyObject: TMyObject;
  Value: Variant;
begin
  MyObject:= TMyObject.Create;
  TVarData(Value).VType:= VarByRef or VarUnknown;
  TVarData(Value).VPointer:= MyObject; 
```

# c# - 使用 GetProperty 获取子属性的最佳方法

> ID：366332
> 
> 赞同：27
> 
> 时间：2008-12-14T09:31:15.213
> 
> 标签：c#, reflection, getproperty

```
public class Address
{
    public string ZipCode {get; set;}
}

public class Customer
{
    public Address Address {get; set;}
} 
```

如何通过反射访问“ZipCode”或“Address.ZipCode”？例如：

```
Typeof(Customer).GetProperty("ZipCode")? 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-12-14T09:36:31.523

你需要类似的东西：

```
PropertyInfo addressProperty = typeof(Customer).GetProperty("Address");
ProportyInfo zipCodeProperty = addressProperty.PropertyType.GetProperty("ZipCode");

object address = addressProperty.GetValue(customer, null);
object zipCode = zipCodeProperty.GetValue(address, null); 
```

基本上，如果您想获取字符串“Address.ZipCode”并向下导航，则需要将其拆分为“。” 然后在每一步调用相应类型的 GetProperty 以获取属性本身，然后 PropertyInfo.GetValue 以获取链中的下一个值。像这样的东西：

```
public static object FollowPropertyPath(object value, string path)
{
    Type currentType = value.GetType();

    foreach (string propertyName in path.Split('.'))
    {
        PropertyInfo property = currentType.GetProperty(propertyName);
        value = property.GetValue(value, null);
        currentType = property.PropertyType;
    }
    return value;
} 
```

像这样称呼它：

```
object zipCode = FollowPropertyPath(customer, "Address.ZipCode"); 
```

请注意，这适用于属性的编译时类型。如果您希望它处理执行时间类型（例如，如果 customer.Address 没有 ZipCode 属性，但 Address 返回的实际类型有），则更`property.PropertyType`改为`property.GetType()`.

另请注意，这没有任何错误处理等:)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-02-14T10:03:57.883

Jon Skeet 的回答很好，不过我不得不稍微扩展他的方法，以便解释属性路径中的派生实例：

```
public static class ReflectorUtil
{
    public static object FollowPropertyPath(object value, string path)
    {
        if (value == null) throw new ArgumentNullException("value");
        if (path == null) throw new ArgumentNullException("path");

        Type currentType = value.GetType();

        object obj = value;
        foreach (string propertyName in path.Split('.'))
        {
            if (currentType != null)
            {
                PropertyInfo property = null;
                int brackStart = propertyName.IndexOf("[");
                int brackEnd = propertyName.IndexOf("]");

                property = currentType.GetProperty(brackStart > 0 ? propertyName.Substring(0, brackStart) : propertyName);
                obj = property.GetValue(obj, null);

                if (brackStart > 0)
                {
                    string index = propertyName.Substring(brackStart + 1, brackEnd - brackStart - 1);
                    foreach (Type iType in obj.GetType().GetInterfaces())
                    {
                        if (iType.IsGenericType && iType.GetGenericTypeDefinition() == typeof(IDictionary<,>))
                        {
                            obj = typeof(ReflectorUtil).GetMethod("GetDictionaryElement")
                                                 .MakeGenericMethod(iType.GetGenericArguments())
                                                 .Invoke(null, new object[] { obj, index });
                            break;
                        }
                        if (iType.IsGenericType && iType.GetGenericTypeDefinition() == typeof(IList<>))
                        {
                            obj = typeof(ReflectorUtil).GetMethod("GetListElement")
                                                 .MakeGenericMethod(iType.GetGenericArguments())
                                                 .Invoke(null, new object[] { obj, index });
                            break;
                        }
                    }
                }

                currentType = obj != null ? obj.GetType() : null; //property.PropertyType;
            }
            else return null;
        }
        return obj;
    }

    public static TValue GetDictionaryElement<TKey, TValue>(IDictionary<TKey, TValue> dict, object index)
    {
        TKey key = (TKey)Convert.ChangeType(index, typeof(TKey), null);
        return dict[key];
    }

    public static T GetListElement<T>(IList<T> list, object index)
    {
        return list[Convert.ToInt32(index)];
    }

} 
```

使用 property.PropertyType 将为您获取在 obj 类上定义的属性类型，而使用 obj.GetType() 将为您获取属性实例的实际类型。

编辑：@Oliver - 你是绝对正确的，谢谢你注意到这一点。我调整了方法以允许通用列表和字典。虽然我不喜欢解析部分，但我在[这个线程](https://stackoverflow.com/questions/852233/getting-values-of-a-generic-idictionary-using-reflection)中使用了 Marc Gravell 的聪明想法来获取索引器属性的值。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-14T09:52:40.117

现有的答案很好；只是另一种观点：在许多场景中，最好使用 System.ComponentModel 而不是直接反射，因为这允许运行时属性场景 - 即 DataTable 的 DataView 如何将列公开为*属性*。

性能方面 - 默认情况下，这在很大程度上是相同的，但如果您正在做很多这样的事情（例如，批量数据导入/导出），您实际上可以使用这种方法获得显着的性能提升，这由[HyperDescriptor](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)提供。

要使用 System.ComponentModel，代码类似，但略有不同：

```
static void Main()
{
    object obj = new Customer { Address = new Address { ZipCode = "abcdef" } };

    object address = GetValue(obj, "Address");
    object zip = GetValue(address, "ZipCode");

    Console.WriteLine(zip);
}
static object GetValue(object component, string propertyName)
{
    return TypeDescriptor.GetProperties(component)[propertyName].GetValue(component);
} 
```

然后，这将为您提供与使用数据绑定绑定到“Address.ZipCode”相同的处理方式（对列表等一些细节进行修饰）。

（请注意，如果您知道这是预期的类型，您可以将 zip 转换为字符串等）

要从深层路径（包括数据绑定使用的相同列表处理）中获取值，您可以使用以下内容：

```
static object ResolveValue(object component, string path) {
    foreach(string segment in path.Split('.')) {
        if (component == null) return null;
        if(component is IListSource) {
            component = ((IListSource)component).GetList();
        }
        if (component is IList) {
            component = ((IList)component)[0];
        }
        component = GetValue(component, segment);
    }
    return component;
} 
```

列表内容*大致*反映了常规数据绑定的行为（尽管它省略了一些内容，如绑定上下文、货币管理器等）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-14T09:35:58.310

```
typeof (Customer).GetProperty("Address").PropertyType.GetProperty("ZipCode") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-02T16:09:44.240

阿达拜伦，

当您只需要获取类型并且没有实际的对象实例时，我创建了您的代码版本。

```
 public static Type FollowPropertyPath<T>(string path)
    {
        if (path == null) throw new ArgumentNullException("path");

        Type currentType = typeof(T);

        foreach (string propertyName in path.Split('.'))
        {
            int brackStart = propertyName.IndexOf("[");

            var property = currentType.GetProperty(brackStart > 0 ? propertyName.Substring(0, brackStart) : propertyName);

            if (property == null)
                return null;

            currentType = property.PropertyType;

            if (brackStart > 0)
            {
                foreach (Type iType in currentType.GetInterfaces())
                {
                    if (iType.IsGenericType && iType.GetGenericTypeDefinition() == typeof (IDictionary<,>))
                    {
                        currentType = iType.GetGenericArguments()[1];
                        break;
                    }
                    if (iType.IsGenericType && iType.GetGenericTypeDefinition() == typeof (ICollection<>))
                    {
                        currentType = iType.GetGenericArguments()[0];
                        break;
                    }
                }
            }
        }

        return currentType;
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-09-17T06:11:11.297

**问题：弱类型变量：**

@jonskeet 的 FollowPropertyPath(...) 方法*几乎*完全满足了我的需求；除了我的属性是弱类型的；因此，`currentType = property.PropertyType`只需返回 System.Object 并在 foreach 循环的下一次迭代中失败。

**解决方案：** 为了使用运行时类型而不是设计时类型，我将方法调整如下：

```
public static object FollowPropertyPath(object value, string path)
{
    Type currentType = value.GetType();

    foreach (string propertyName in path.Split('.'))
    {
        PropertyInfo property = currentType.GetProperty(propertyName);
        value = property.GetValue(value, null);
        currentType = value.GetType();    // <-- Change
    }
    return value;
} 
```

# c# - 在 Windows 窗体应用程序中使用 Console.WriteLine

> ID：366345
> 
> 赞同：6
> 
> 时间：2008-12-14T09:42:14.443
> 
> 标签：c#, winforms, debugging, logging

我有一个外部 DLL，其源代码是 C#。从 DLL 的文档中，我确定它使用`Console.WriteLine`.

我想在 WinForms 应用程序中使用这个 DLL。但是，我发现我看不到 DLL 发出的调试消息，因为 WinForms 应用程序没有控制台。

有没有办法捕获这些调试消息，甚至可能是一个简单的日志文件？当然，使用`ProcessInfo.RedirectStandartOutput`不会起作用，因为我不将 DLL 用作进程。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-14T09:46:20.770

使用您控制的 TextWriter（例如 StringWriter）调用[Console.SetOut 。](http://msdn.microsoft.com/en-us/library/system.console.setout.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-14T11:32:52.160

最好使用 System.Diagnostics 命名空间和 Debug.WriteLine 来代替。调试支持可以在运行时或通过 app/web.config 文件添加的“侦听器”。例如：-

```
 Debug.Listeners.Add(new ConsoleTraceListener()) 
```

如果您将任何自定义调试日志记录为跟踪侦听器，则可以非常轻松地在应用程序范围内捕获跟踪消息。

# iis - IIS6 可用于 32 位应用程序和 x64 操作系统（32Gb 内存）上的 Web Garden 的可用内存

> ID：366349
> 
> 赞同：1
> 
> 时间：2008-12-14T09:43:58.013
> 
> 标签：iis, iis-6, 64-bit, 32-bit, web-garden

我们在具有 32Gb 物理 RAM 的 64 位 Windows 2003 服务器上运行 IIS6。由于我们的 .NET 3.5 ASP.NET 应用程序中存在一些较旧的 32 位依赖项，我们目前被迫在 32 位 wow64 模式下运行我们的 IIS 工作进程，据我所知，这使我们可以访问 4Gb 的内存用于我们的工作进程。

我的问题是，如果我们使用 Web Garden 设置并配置 4 个工作进程，每个工作进程能否分别访问 4Gb 的内存，从而使我们能够访问大约 16Gb 的内存。还是我们被 ASP.NET 应用程序的 4Gb 限制所困扰？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-14T09:49:39.170

是的，每个进程限制为 4GB。在 64 位内核上运行的每个 32 位进程都有 4GB 的私有地址空间限制（顺便说一下，它不像在 32 位系统中那样与内核共享）。您可以访问 4x4GB=16GB 的内存，但是，这 16GB 不能一次用于单个进程。每个只能直接访问自己的 4GB 私有内存。您应该使用一些进程间通信介质从其他进程访问内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T19:21:25.687

上面回答了“每个工作进程每个访问 4Gb 内存”的答案 - 默认情况下，除非您使用 /3GB 开关，否则您将在用户模式下拥有 2GB 的 RAM，您可能会或可能不会根据要求使用该开关您的应用程序/服务器设置。您可能会饿死内核模式资源。

您问题的第二部分“因此让我们可以访问大约 16Gb 的内存”取决于您所说的“访问”是什么意思。Web 园通过为传入请求启动另一个 w3wp.exe 来工作，直到您达到为应用程序池设置的工作进程数。由于每个网络花园实例都在自己的进程中，就好像它是一个不同的应用程序池，因此它们不共享相同的地址空间。因此，当您的应用程序消耗更多内存时，这仅仅是因为您正在运行同一应用程序的多个实例，每个实例都受到 32 位限制。 [http://bytes.com/groups/asp/54826-asp-sessions-web-gardens](http://bytes.com/groups/asp/54826-asp-sessions-web-gardens) [http://msdn.microsoft.com/en-us/library/ms791558.aspx](http://msdn.microsoft.com/en-us/library/ms791558.aspx)

# sql - 在 SQL Server 2000 中存储视频的数据类型

> ID：366358
> 
> 赞同：2
> 
> 时间：2008-12-14T09:53:50.053
> 
> 标签：sql, sql-server, types

在 sql server2000 中存储视频文件将使用什么数据类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-14T10:55:53.780

在大多数情况下，数据库并不是视频的理想场所。您可以强制使用它（varbinary(max)，或旧版本上的图像），但如果您*这样做*，您需要非常小心地使用 steraming 访问而不是“获取所有”访问（如果您明白我的意思） . 而且您可能希望视频位于与常规数据不同的文件组（可能还有驱动器）上。

在 SQL Server 2008 中有[filestream](http://msdn.microsoft.com/en-us/library/bb933993.aspx)类型，它是 db 和文件系统的混合体。也许这会做你需要的？

如果没有，只需使用文件系统。

不在数据库中使用视频的另一个原因；如果您有一个小型系统，SQL Server Express 可能是理想的 - 但有一个数据库大小上限，视频会很快淹没。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-14T09:57:26.597

使用 BLOB（二进制大对象）。[文档在这里](http://www.microsoft.com/technet/prodtechnol/sql/2000/reskit/part3/c1161.mspx)。更具体地说：

> 在 SQL Server 中，BLOB 可以是 text、ntext 或 image 数据类型
> 
> **图片**
> 
> 从 0 到 231 - 1 (2,147,483,647) 字节的可变长度二进制数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T17:08:01.953

在 SQL Server 2000 中，对 BLOB 的支持不够好，您应该明确地将文件直接存储在磁盘上。在 SQL Server 2008 中，对在数据库中存储文件的支持应该要好得多。我从来没有尝试过，因为我们已经构建了我们的应用程序来将文件存储在磁盘上。但我认为我仍然建议将文件存储在磁盘上，因为它在存储方面提供了更大的灵活性；您可以轻松地备份它并移动文件。它还减少了数据库的大小，这可能会使其更快。

因此，将路径存储在数据库中，并将实际文件存储在文件系统中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T17:18:56.767

我同意 Tomalak 的观点，即使是图片和其他较小的资产在数据库之外也能得到更好的服务。我们的产品仅使用数据库中资产的引用路径，而数据库用作位置的字典。

当然，不利的一面是文件系统和数据库条目之间可能会出现断开连接，因此您需要特别注意如何设置它并以持续的方式对其进行维护。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-14T10:38:12.070

省去你的麻烦，把它们存储在文件系统上。将路径存储在数据库中。

目前，当有可用的文件系统时，我想不出将视频存储在数据库中的*真正好理由。*你的是什么？

# php - 您如何看待这个关于如何配置开发/登台/生产实例的奇怪想法？

> ID：366364
> 
> 赞同：2
> 
> 时间：2008-12-14T10:04:10.187
> 
> 标签：php, apache, mod-rewrite, litespeed

我只是对如何配置与环境相关的参数有一个奇怪的想法。您可以在 Rails 的 config/database.yml 中找到类似的参数

在我当前的项目中，我使用 PHP 和 Litespeed Web 服务器（尽管同样的技术适用于 PHP + Apache），我想……“为什么不使用 mod_rewrite 呢？”。我为每个环境都有单独的虚拟主机配置（目前是开发/生产）

我现在拥有的是：

```
 RewriteRule (.*) $1 [env=development:1] 
```

 `用于开发环境 vhost。但是，如果它会是这样的呢？

```
 RewriteRule (.*) $1 [env=development:1,env=mysql_host:localhost,env=mysql_port:3306,env=mysql_user:root,env=mysql_pass:,env=mysql_db:mydbname] 
```

 `这有意义还是会引起一些问题？你怎么看？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T10:56:02.173

我不相信重写规则是一个特别直观的地方来放置这样的配置信息。也许我误解了一些东西，但开发、登台和生产环境之间的唯一区别是数据库连接吗？通常代码也是不同的（至少一旦进行了更改），因此如果您使用的是修订控制系统，我认为拥有一个您复制的模板配置文件（database.cfg.template）可能是一个更好的主意（并告诉您的版本控制系统忽略）和修改（到 database.cfg）。那么很明显这些信息在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T23:51:27.273

你是对的——这是一个奇怪的想法。

IMO，这对 mod_rewrite 来说真的很糟糕。的确，配置信息属于机器，而不是代码库（我看到人们一直犯的错误），但它也不一定属于网络服务器配置。

我会推荐一个不受版本控制管理的配置文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-21T06:25:07.673

如果您想在虚拟主机中设置环境，您可以执行类似的操作

```
php_value ENV "development" 
```

然后从`$_SERVER`数组中读取

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T04:23:20.220

首先，如果您实际上并没有更改 URL，请不要使用 $1 作为替换，只需使用破折号。根据文档：

> 破折号表示不应执行替换（现有路径通过未触及）。当需要在不更改路径的情况下应用标志（见下文）时使用此选项。

但实际上，我认为答案是[mod_env](http://httpd.apache.org/docs/2.2/mod/mod_env.html#setenv)。SetEnv 指令可以放在 <VirtualHost> 块中，避免不必要的 RewriteRule foo。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-02T08:08:55.113

您应该定义当前环境的最佳且唯一的地方是引导程序。

查看[symfony](http://svn.jobeet.org/tags/release_day_24/web/index.php)或[agavi](http://svn.agavi.org/branches/1.0/samples/pub/index.php)引导文件。

# c# - 你能给我解释一下 MVC 控制器方法的动作参数吗？

> ID：366375
> 
> 赞同：1
> 
> 时间：2008-12-14T10:27:43.603
> 
> 标签：c#, asp.net, asp.net-mvc

有人可以解释或链接到解释如何填充传递到控制器操作的参数的文章吗？当您拥有 Controller/Action/ID 并且 ID 作为变量传入时，我了解基本映射，如果它没有转换为您要求的类型，那么它将不会传递给该操作。

但是我一直在查看 MVCContrib 子控制器代码，并且有以下示例：

```
public ActionResult Index(FirstLevelSubController firstLevel) 
```

我想知道这个参数是如何被填充的，因为据我所知，没有任何东西被传入来填充这个？

假设我创建了以下操作，这是控制器中的唯一操作：

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Index(Task task, ToDoList list) 
```

我会被传回什么，为什么？（我知道我可以做一个快速测试，看看他们是否真的回来了，但这会让我不知道为什么。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T16:33:13.943

首先，将参数传递给具有 [AcceptVerbs(HttpVerbs.Get)] 属性的方法的唯一方法是通过查询参数。例子：

```
http://localhost/Task/Index/?task=mytask&todolist=a,b,c,d 
```

您看到的许多带有复杂参数的操作方法都是通过 post 调用的，并且很可能是 [AcceptVerbs(HttpVerbs.Post)] 的候选方法。

创建以下示例方法：

```
public ActionResult Index(int id, FormCollection form)
{

} 
```

如果您在哪里检查表单集合，您可能会在表单发布后出现以下内容：

```
form["name"] = "bob"
form["city"] = "LA"
form["state"] = "CA"
form["zip"] = "90210" 
```

在这种情况下，asp.net mvc 只是简单地解析表单值并将它们扔到表单集合对象中。当然，现在您必须手动提取每个参数才能访问这些值。如果 asp.net mvc 可以为您处理该过程，那不是很好吗？如果您有以下课程：

```
public class User
{
    string string Name {get; set;}
    string string City {get; set;}
    string string State {get; set;}
    string string Zip {get; set;}
} 
```

并将其添加到您的操作方法中

```
public ActionResult Index(int id, User user) 
```

asp.net mvc 将在调用您的操作方法之前使用反射来填充用户参数。实际上，它正在执行以下操作，对于表单集合中的每个键，它使用反射从您的操作方法中声明的参数列表中定位该属性。如果它找到匹配的属性，它将尝试设置它的值。

```
user.Name = form["name"]
user.City = form["city"]
user.State = form["state"]
user.Zip = int.Parse(form["zip"]) 
```

但是，id 值是从路由值而不是表单集合中设置的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T10:46:38.493

一般是ControllerActionInvoker的一个函数。对象在自定义 ControllerActionInvoker 实现中实例化后传递到操作中。有关 ControllerActionInvoker 如何工作的更多信息，请查看[ASP.NET MVC - ControllerActionInvoker：第 1 部分](http://lostintangent.com/2008/07/03/aspnet-mvc-controlleractioninvoker-part-1/)

还有一个称为“模型绑定”的功能，它可以帮助您将请求参数绑定到您的对象，因此在大多数情况下，您不需要制作自己的 ControllerActionInvoker 实现。看看这个： [来自 ScottGu 的 ASP.NET MVC 模型绑定](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx#three)

# jquery - 如何找到被 JQuery 隐藏的第一个元素

> ID：366379
> 
> 赞同：6
> 
> 时间：2008-12-14T10:37:00.557
> 
> 标签：jquery

我想显示被 jquery 隐藏的第一个元素。我的html代码是：

```
<ol>
    <li>1</li>
    <li style="display:none">2</li>
    <li style="display:none">3</li>
    <li style="display:none">4</li>
    <li style="display:none">5</li>
    <li><a class="add">Add More ...</a></li>
</ol> 
```

我想显示第一个隐藏的 LI，每次单击“a”元素时。我的解决方案如下。但我认为存在更好的方法。

```
$("a.add").click(function(){
        var hiddens=$(":hidden",$(this).parent().parent());
        if (hiddens.length>0)
        {
            hiddens.each(function(index,el){
                if(index==0)
                {
                    $(this).slideToggle("fast");
                }
            });
        }

        if (hiddens.length==1)
        {
            $(this).parent().hide();
        } 
```

坦克斯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-14T10:59:04.617

只需在获得 :hidden 集合后添加一个 :first 选择器，以便从 :hidden 选择器找到的集合中获取第一个元素

```
$("a.add").click(function(){
    $(":hidden:first").slideToggle("fast");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T10:55:07.543

这是解决方案：

```
$("a.add").click(function(){
    $(":hidden:first").show();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T09:03:05.193

谢谢“以太”：在您回答后我找到了以下解决方案：

```
$(":hidden:eq(0)",$(this).parent().parent()) 
```

或者

```
$(":hidden:lt(1)",$(this).parent().parent()) 
```

# c++ - 使用 BOOST_FOREACH 时如何使 Eclipse CDT 自动缩进？

> ID：366380
> 
> 赞同：9
> 
> 时间：2008-12-14T10:38:08.107
> 
> 标签：c++, eclipse, boost, formatting, indentation

我在 Eclipse 3.4.1 (CDT 5.0.1) 中编写了这个小小的 C++ 示例：

```
#include <iostream>
#include <vector>
#include <boost/foreach.hpp>

int foo()
{
  std::vector<int> numbers;
  BOOST_FOREACH(int n, numbers)
  {
    std::cout << n << std::endl;
  }
  std::cout << numbers.size << std::endl;
} 
```

然后我按 Shift+Ctrl+F 来格式化我的代码，它变成：

```
#include <iostream>
#include <vector>
#include <boost/foreach.hpp>

int foo()
{
    std::vector<int> numbers;
    BOOST_FOREACH(int n, numbers)
{   std::cout << n << std::endl;
}
std::cout << numbers.size << std::endl;
} 
```

这是 BSD/Allman 代码风格。其他样式显然会改变格式化代码的外观，但没有一个给出正确的缩进。

当我在一段较大的代码上使用格式功能时，后续的函数或方法也会受到缩进太少的影响，这使得格式帮助非常无用。

我可以做些什么来使缩进与 BOOST_FOREACH 一起正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-02-03T20:43:57.687

将此添加到您的代码使用的一些标头中：

```
#ifdef __CDT_PARSER__
    #undef BOOST_FOREACH
    #define BOOST_FOREACH(a, b) for(a; ; )
#endif 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T22:02:13.903

您可能想尝试[astyle eclipse 插件](http://astyleclipse.sourceforge.net/)。它似乎比 C++ 缩进的默认 Eclipse 风格要好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-05T12:58:45.900

它在当前的开普勒 CDT 中仍然存在问题。但是 Eclipse 的 Bugzilla 中有一个错误（在[此处](https://bugs.eclipse.org/bugs/show_bug.cgi?id=358983)查看其状态）。它最终会被修复:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T15:37:10.300

奇怪，这曾经与 CDT 4 一起使用。所以如果你真的需要这个，我建议你降级你的 CDT :-/

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T21:36:39.410

呃……你不能吗？尝试下一个 CDT 版本... :_(

# asp.net-mvc - 如何对使用 FormsAuthentication 的 ASP.NET MVC 控制器进行单元测试？

> ID：366388
> 
> 赞同：47
> 
> 时间：2008-12-14T10:48:08.273
> 
> 标签：asp.net-mvc, unit-testing, tdd, mocking, forms-authentication

我正在以测试驱动的方式使用 ASP.NET MVC 解决方案，我想使用表单身份验证将用户登录到我的应用程序。我想在控制器中结束的代码如下所示：

```
FormsAuthentication.SetAuthCookie(userName, false); 
```

我的问题是如何编写测试来证明此代码的合理性？

有没有办法检查是否使用正确的参数调用了 SetAuthCookie 方法？

有没有办法注入一个假的/模拟的 FormsAuthentication？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-12-14T11:20:11.813

我将首先编写一个接口和一个封装此逻辑的包装类，然后在我的控制器中使用该接口：

```
public interface IAuth 
{
    void DoAuth(string userName, bool remember);
}

public class FormsAuthWrapper : IAuth 
{
    public void DoAuth(string userName, bool remember) 
    {
        FormsAuthentication.SetAuthCookie(userName, remember);
    }
}

public class MyController : Controller 
{
    private readonly IAuth _auth;

    public MyController(IAuth auth) 
    {
        _auth = auth;
    }

} 
```

现在`IAuth`可以在单元测试中轻松地模拟并验证控制器是否调用了预期的方法。我不会对这个`FormsAuthWrapper`类进行单元测试，因为它只是将调用委托给`FormsAuthentication`它应该做的事情（微软保证:-)）。

# java - Java GUI - 一般

> ID：366391
> 
> 赞同：2
> 
> 时间：2008-12-14T10:49:40.610
> 
> 标签：java, user-interface, jbutton

你好所有你乐于助人的人@stackoverflow！

Java GUI 的最佳资源？

查看 Java 文档，很容易弄清楚 JButtons、JFrames 等的基础知识，但掌握从框架访问 JComponents 的概念、创建不同的面板的作用等并不是很容易理解。

是否有一些教程教授有关 Java GUI 的基础知识，例如 swing 和现实生活中的示例？

书籍建议总是受欢迎的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T11:14:35.757

嗯……你看过[The Swing 教程](http://java.sun.com/docs/books/tutorial/uiswing/index.html)吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T14:59:01.513

完成[Swing 教程](http://java.sun.com/docs/books/tutorial/uiswing/index.html)后，您应该看看[Java Swing](http://books.google.com/books?id=cPxGfk-FZNUC&dq=java+swing&pg=PP1&ots=gFtz5Zntal&source=bn&sig=hKGpY7QtUTZrNjav41bPRuN4VcI&hl=en&sa=X&oi=book_result&resnum=4&ct=result)。是一本比较全面的书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T12:56:33.273

[java2s.com](http://www.java2s.com/)很好地覆盖了[Swing 库](http://www.java2s.com/Tutorial/Java/0240__Swing/Catalog0240__Swing.htm)，包括常见任务的示例代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-14T13:12:23.723

对于技术方面的东西，Swing[教程](http://java.sun.com/docs/books/tutorial/uiswing/index.html)和之后的[Javadoc](http://java.sun.com/javase/6/docs/api/index.html?javax/swing/package-summary.html) API 文档对大多数人来说已经足够了。

了解如何制作有意义的用户界面[Java 外观设计指南](http://java.sun.com/products/jlf/ed2/book/index.html)将很有帮助。

我能给你的最好的建议是在你的用户界面上从其他人那里获得输入。当您自己构建*和测试*界面时，您对什么构成逻辑和简单的用户体验的看法会被扭曲。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T17:05:09.370

我使用 SWT/JFace 而不是 Swing（主要是为了原生的外观和感觉。）

[SWT/JFace In Action](https://rads.stackoverflow.com/amzn/click/com/1932394273)是我找到的最好的资源。

此外，SWT 项目提供的[SWT Widgets](http://www.eclipse.org/swt/widgets/)参考。

# linux - Linux 上的 Silverlight

> ID：366398
> 
> 赞同：2
> 
> 时间：2008-12-14T10:56:05.137
> 
> 标签：linux, silverlight

有人尝试在 Linux 机器上查看 Silverlight 站点吗？afaik，在 Linux 上有一种叫做 mono 的东西，它试图在 Linux 机器上移植 .NET，但有人真的尝试过使用它吗？它起作用了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T11:07:41.650

Moonlight 是 SilverLight 的单声道实现。 [http://www.mono-project.com/Moonlight](http://www.mono-project.com/Moonlight)

在一次采访中，他们说微软为他们提供了他们在 Silverlight 上使用的相同测试套件，所以我认为作为[http://www.hanselminutes.com/default.aspx?showID=157之后的一个版本，实现非常好](http://www.hanselminutes.com/default.aspx?showID=157)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T11:20:47.147

目前，在 Linux 上实现 Silverlight 的 Moonlight 处于测试阶段。根据他们的路线图，Moonlight 1.0 的最终版本应该在 2009 年 1 月 20 日发布。正如 MrChrister 所说，他们是“落后的版本”，因为我们已经有了 Silverlight 2。但是，根据相同的路线图，他们计划明年某个时候赶上。在那之前，我不认为 Linux 上的 Silverlight 是一个可以考虑的选项。

# python - 如何从 turbogears/cherrypy 应用程序浏览到外部 url？

> ID：366421
> 
> 赞同：0
> 
> 时间：2008-12-14T11:23:21.447
> 
> 标签：python, url-routing, cherrypy, turbogears

我正在编写一个 tinyurl 克隆来学习涡轮齿轮。我想知道如何将我的浏览器从我的cherrypy/turbogears 应用程序重定向到外部网站（比如 www.yahoo.com）？

我用谷歌搜索了它，但找不到太多有用的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T11:32:32.787

只需引发一个 HTTPRedirect 异常，它位于cherrypy 命名空间中。像这样：

```
raise cherrypy.HTTPRedirect("http://www.yahoo.com") 
```

# python - 避免空列表的默认参数的pythonic方法是什么？

> ID：366422
> 
> 赞同：181
> 
> 时间：2008-12-14T11:23:54.863
> 
> 标签：python

有时，有一个空列表的默认参数似乎很自然。然而[Python 在这些情况下会产生意想不到的行为](https://stackoverflow.com/questions/1132941/least-astonishment-and-the-mutable-default-argument)。

例如，如果我有一个功能：

```
def my_func(working_list=[]):
    working_list.append("a")
    print(working_list) 
```

第一次调用时，默认值将起作用，但之后调用将更新现有列表（`"a"`每次调用一个）并打印更新的版本。

那么，获得我想要的行为的 Pythonic 方法是什么（每次调用都有一个新列表）？

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2008-12-14T11:27:30.207

```
def my_func(working_list=None):
    if working_list is None: 
        working_list = []

    # alternative:
    # working_list = [] if working_list is None else working_list

    working_list.append("a")
    print(working_list) 
```

[文档](https://docs.python.org/reference/compound_stmts.html#function-definitions)说您应该将`None`其用作默认值并在函数体中[对其进行显式测试。](https://stackoverflow.com/questions/3257919/what-is-the-difference-between-is-none-and-none)

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2017-05-30T21:15:43.210

其他答案已经提供了所要求的直接解决方案，但是，由于这对于新的 Python 程序员来说是一个非常常见的陷阱，因此值得添加解释为什么 Python 会以这种方式运行，这在 Python 的 Hitchhikers Guide 中得到了很好的[*总结*](https://docs.python-guide.org/writing/gotchas/)[*可变默认参数*](https://docs.python-guide.org/writing/gotchas/#mutable-default-arguments)：

> Python 的默认参数在定义函数时计算*一次*，而不是每次调用函数时（就像在 Ruby 中一样）。这意味着，如果您使用可变的默认参数并对其进行变异，您*将*并且已经对该对象进行了变异，以便将来调用该函数。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-12-14T11:43:57.957

在这种情况下并不重要，但您可以使用对象标识来测试无：

```
if working_list is None: working_list = [] 
```

您还可以利用布尔运算符或在 python 中定义的方式：

```
working_list = working_list or [] 
```

尽管如果调用者给你一个空列表（算作假）作为 working_list 并期望你的函数修改他给它的列表，这将出现意外行为。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-01-07T16:09:07.830

如果函数的意图是*修改*作为传递的参数`working_list`，请参阅 HenryR 的答案（=None，检查 None 内部）。

但是，如果您不打算改变参数，只需将其用作列表的起点，您可以简单地复制它：

```
def myFunc(starting_list = []):
    starting_list = list(starting_list)
    starting_list.append("a")
    print starting_list 
```

（或者在这个简单的情况下，`print starting_list + ["a"]`但我想这只是一个玩具示例）

一般来说，改变你的论点在 Python 中是不好的风格。唯一完全期望改变对象的函数是对象的方法。改变可选参数甚至更罕见——仅在某些调用中发生的副作用真的是最好的接口吗？

*   如果你是按照 C 的“输出参数”习惯来做的，那是完全没有必要的——你总是可以将多个值作为一个元组返回。

*   如果您这样做是为了有效地构建一长串结果而不构建中间列表，请考虑将其编写为生成器并`result_list.extend(myFunc())`在调用它时使用。这样，您的调用约定仍然非常干净。

经常更改可选参数*的*一种模式是递归函数中隐藏的“备忘录”参数：

```
def depth_first_walk_graph(graph, node, _visited=None):
    if _visited is None:
        _visited = set()  # create memo once in top-level call

    if node in _visited:
        return
    _visited.add(node)
    for neighbour in graph[node]:
        depth_first_walk_graph(graph, neighbour, _visited) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-15T08:33:39.013

我可能跑题了，但请记住，如果您只想传递可变数量的参数，pythonic 方法是传递一个元组`*args`或一个字典`**kargs`。这些是可选的并且比语法更好`myFunc([1, 2, 3])`。

如果你想传递一个元组：

```
def myFunc(arg1, *args):
  print args
  w = []
  w += args
  print w
>>>myFunc(1, 2, 3, 4, 5, 6, 7)
(2, 3, 4, 5, 6, 7)
[2, 3, 4, 5, 6, 7] 
```

如果要传递字典：

```
def myFunc(arg1, **kargs):
   print kargs
>>>myFunc(1, option1=2, option2=3)
{'option2' : 2, 'option1' : 3} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-16T15:54:29.567

引用自[https://docs.python.org/3/reference/compound_stmts.html#function-definitions](https://docs.python.org/3/reference/compound_stmts.html#function-definitions)

> 执行函数定义时，从左到右计算默认参数值。这意味着表达式在定义函数时被计算一次，并且每次调用都使用相同的“预计算”值。当默认参数是可变对象（例如列表或字典）时，这一点尤其重要：如果函数修改了对象（例如，通过将项目附加到列表中），则默认值实际上已被修改。这通常不是预期的。解决此问题的一种方法是使用 None 作为默认值，并在函数体中显式测试它，例如：

```
def whats_on_the_telly(penguin=None):
    if penguin is None:
        penguin = []
    penguin.append("property of the zoo")
    return penguin 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-04T09:57:56.790

已经提供了好的和正确的答案。我只是想提供另一种语法来编写您想做的事情，例如，当您想要创建一个具有默认空列表的类时，我发现它更漂亮：

```
class Node(object):
    def __init__(self, _id, val, parents=None, children=None):
        self.id = _id
        self.val = val
        self.parents = parents if parents is not None else []
        self.children = children if children is not None else [] 
```

此代码段使用 if else 运算符语法。我特别喜欢它，因为它是一个简洁的小单行字，没有冒号等。它读起来几乎就像一个正常的英文句子。:)

在你的情况下，你可以写

```
def myFunc(working_list=None):
    working_list = [] if working_list is None else working_list
    working_list.append("a")
    print working_list 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-19T13:11:10.877

也许最简单的事情就是在脚本中创建列表或元组的副本。这避免了检查的需要。例如，

```
 def my_funct(params, lst = []):
        liste = lst.copy()
         . . 
```

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2019-06-30T07:01:51.650

我参加了UCSC扩展课`Python for programmer`

这是真的： def Fn(data = []):

> a) 是一个好主意，这样您的数据列表在每次调用时都是空的。
> 
> b) 是一个好主意，这样所有在调用中不提供任何参数的函数调用都将获得空列表作为数据。
> 
> c) 是一个合理的想法，只要您的数据是字符串列表。
> 
> d) 是个坏主意，因为默认的 [] 会累积数据，而默认的 [] 会随着后续调用而改变。

回答：

> d) 是个坏主意，因为默认的 [] 会累积数据，而默认的 [] 会随着后续调用而改变。

# c++ - 扩展 std::list

> ID：366432
> 
> 赞同：6
> 
> 时间：2008-12-14T11:30:16.253
> 
> 标签：c++, templates, list, linker

我需要为我的程序使用列表，并且需要决定是使用 std::vector 还是 std::list。vector 的问题是没有 remove 方法，而 list 的问题是没有运算符 []。所以我决定编写自己的类来扩展 std::list 并重载 [] 运算符。

我的代码如下所示：

```
#include <list>

template <class T >
class myList : public std::list<T>
{
public:
T operator[](int index);
T operator[](int & index);
myList(void);
~myList(void);
};

#include "myList.h"

template<class T>
myList<T>::myList(void): std::list<T>() {}

template<class T>
myList<T>::~myList(void)
{
std::list<T>::~list();
}

template<class T>
T myList<T>::operator[](int index) {
int count = 0;
std::list<T>::iterator itr = this->begin();
while(count != index)itr++;
return *itr;    
}

template<class T>
T myList<T>::operator[](int & index) {
int count = 0;
std::list<T>::iterator itr = this->begin();
while(count != index)itr++;
return *itr;
} 
```

我可以编译它，但如果我尝试使用它，我会收到链接器错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-14T16:44:13.983

根据您的需要，您应该使用`std::vector`（如果您需要经常在末尾添加/删除，以及随机访问），或者`std::deque`（如果您需要经常在末尾或开头添加/删除，并且您的数据集很大，并且仍然想要随机访问）。这是一张很好的图片，向您展示了如何做出决定：

[![容器选择](https://i.stack.imgur.com/qWf2C.png)](https://i.stack.imgur.com/qWf2C.png)
[（来源：[adrinael.net](http://adrinael.net/containerchoice.png)）]

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-14T12:07:45.867

鉴于您最初的问题陈述，

> 我需要为我的程序使用列表，并且需要决定是使用 std::vector 还是 std::list。vector 的问题是没有 remove 方法，而 list 的问题是没有运算符 []。

无需创建自己的列表类（无论如何这不是明智的设计选择，因为`std::list`没有虚拟析构函数，这强烈表明它不打算用作基类）。

您仍然可以实现您想要使用`std::vector`的功能和`std::remove`功能。如果`v`是 a `std::vector<T>`，那么要删除 value `value`，您可以简单地编写：

```
#include <vector>
#include <algorithm>
T value = ...; // whatever
v.erase(std::remove(v.begin(), v.end(), value), v.end()); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-14T11:34:18.743

所有模板代码都应该放在头文件中。此填充修复链接问题（这是最简单的方法）。它发生的原因是因为编译器将每个源 (.cc) 文件与其他文件分开编译。另一方面，它需要知道它究竟需要创建什么代码（即模板中的 T 被替换为什么），除非程序员明确告诉它或在模板时包含所有代码，否则它没有其他方法可以知道它实例化发生。即当 mylist.cc 被编译时，它对 mylist 用户和需要创建什么代码一无所知。另一方面，如果 listuser.cc 被编译，并且所有 mylist 代码都存在，编译器会创建所需的 mylist 代码。[您可以在此处](http://www.iis.sinica.edu.tw/~kathy/vcstl/templates.htm)或在 Stroustrup中阅读有关它的更多信息。

您的代码有问题，如果用户请求否定或太大（超过列表中的元素数量）怎么办。而且我没有看太多。

此外，我不知道你打算如何使用它，但你的 operator[] 是 O(N) 时间，这可能很容易导致 O(N*N) 循环......

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-14T11:34:13.313

向量具有可以删除元素的[擦除方法。](http://www.cppreference.com/wiki/stl/vector/erase)这还不够吗？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-14T14:48:18.927

除了其他优秀的评论外，扩展标准容器的最佳方式不是派生，而是编写自由函数。例如，了解如何使用[Boost 字符串算法](http://www.boost.org/doc/libs/1_37_0/doc/html/string_algo.html)来扩展`std::string`和其他字符串类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-14T11:34:16.357

您必须将所有模板代码移动到标题中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-14T12:34:42.723

明显的东西已经详细描述了：

但是您选择实施的方法？

*   析构函数。
    *   不需要的编译器会为您生成。
*   operator[] 的两个不同版本毫无意义
    *   你也应该使用 std::list::size_type 作为索引
    *   除非您打算支持负索引。
*   没有 const 版本的 operator[]
*   如果你要实现 [] 你也应该做 at()
*   您错过了构建列表的所有不同方式。
*   容器应该在内部定义几种类型
    *   见[http://www.sgi.com/tech/stl/Container.html](http://www.sgi.com/tech/stl/Container.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-14T15:03:46.090

无需调用 std::list 的析构函数，因为当自动为 myList 调用析构函数时，您已经从 std::list 派生了 std::list 析构函数。

# java - Java中的可变事件

> ID：366438
> 
> 赞同：0
> 
> 时间：2008-12-14T11:34:40.193
> 
> 标签：java, compilation

我正在编程的克朗代克纸牌有问题。它几乎完成了，但是现在当我尝试编译时（我正在使用 Dr. Java，是的，我知道），它不断弹出 2 个错误。

1.  找不到符号：变量事件
2.  找不到符号：方法“findbunki”（java.awt.Point）

我已经导入了 java.awt，所以不可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T12:53:25.353

如果没有代码，这将是我的猜测：

1）您使用了一个名为“事件”的变量，但它不是您方法中的参数之一。（或者：你忘了声明它，但从名字我猜它属于方法调用）

2) 您在 java.awt.Point 类型的对象上调用方法 'findbunki' - Point 没有该方法。找到具有fundbunki 方法的类（可能是您自己的类之一）并在该类型的对象上调用该方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-14T21:14:00.470

你应该是 import java.awt.event.*;

# macos - 开始为 Mac 制作应用程序有多容易？

> ID：366451
> 
> 赞同：2
> 
> 时间：2008-12-14T11:51:36.040
> 
> 标签：macos, cocoa

我对 AppleScript 进行了一些研究，但我对制作半有用的 Mac 应用程序需要多长时间和多难感兴趣。

除了 Apple 文档，还有什么真正好的资源？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-14T12:35:46.573

Aaron Hillegass 的“Mac OS X 的 Cocoa 编程”。一本很好的书，介绍了 Objective C 和 Cocoa 编程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T12:54:15.087

正如 stesch 所说，“Mac OS X 的 Cocoa 编程”是介绍 Cocoa 和 Objective-C 的最佳书籍。但是，如果您已经了解 python 或 ruby​​，则可以使用它们的 cocoabindings 轻松制作漂亮的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T09:41:49.700

“这将花费多少困难和多长时间”取决于您已经知道的内容。如果您可以使用 C、Java 或 C++ 进行编程，并且对面向对象有很好的理解，并且对模型-视图-控制器设计范式的工作原理有一个模糊的概念，那么您将处于有利地位。

想出一个小而有趣的想法，让你有动力继续学习 Cocoa/Objective-C，因为一开始学习曲线可能很陡峭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-14T12:39:08.940

如果你想制作小部件，它们实际上是小网页，通常使用 JavaScript。

# c# - 调试的最佳实践

> ID：366453
> 
> 赞同：11
> 
> 时间：2008-12-14T11:56:22.147
> 
> 标签：c#, .net, debugging

最近我一直在使用 Visual Studio 和 WinDbg 对托管应用程序进行大量调试，因此我经常被要求在调试情况下协助同事。有几次我发现人们只是在这里和那里插入断点并希望最好。以我的经验，这很少是一种有用的技术。

我的方法是这样的。

*   重现问题。理想情况下尽可能减少输入。

*   检查哪里出了问题并列出错误可能在哪里的理论。

*   通过调试代码的特定区域，一次检查一个理论。

根据需要重复步骤。

对于复杂的调试问题，我经常和同事一起工作。对于 WinDbg，这特别有用。

还有其他有用的调试技巧或最佳实践吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-14T12:33:12.913

如果有一个关于调试的提示我可以给每个人，那就是再次打破它。

也就是说，当您认为您已经找到了解决方案并且系统似乎可以正常工作时。退出修复程序，看看系统是否再次中断。

有时，您可能会迷失在您尝试过的潜在解决方案的序列中，并且在调试问题时会在系统的完全不同区域完成。然后你会忘记你在原来工作的地方所做的改变。

支持修复然后重现问题可确保候选修复不依赖于您在系统的另一部分中更改的其他内容。您的修复补丁是正确的独立解决方案。

HTH。

干杯，

抢

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-14T12:15:57.520

一种最佳实践不是立即深入调试器，而是查看代码并*努力思考*一段时间。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-02T21:08:53.247

我不确定我在哪里读到“Rubber Duck Debugging”，但我认为它很棒。基本的想法是在你的桌子上放一只橡皮鸭，并向它解释代码。这个想法是，当您向鸭子解释代码时，您最终会发现自己在说“现在，这发生了”，并且您会注意到“这”不是您打算发生的事情。

没有鸭子，我发现我只是浏览代码并向自己解释。它有效，但我仍然认为我可能会带来一只鸭子。

[编辑] 我发现我在哪里读到了橡皮鸭[Rubber Duck Debugging](http://lists.ethernal.org/oldarchives/cantlug-0211/msg00174.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-14T12:19:14.657

正如另一位发帖人所说，经过深思熟虑，如果您了解发生了什么，通常可能只看到逻辑错误。

但通常我们认为我们做到了，但我们没有，或者我们只是被要求修复一些我们不太了解的东西，所以它回到了第一原则。

重现问题无疑是至关重要的第一步。如果你不能做到这一点，那么你就没有机会找到问题，除非是偶然的。

下一步是确定发生错误时实际执行的代码的路径。在可能有许多事件和多个线程的 WinForms 应用程序中，这绝不是一项微不足道的练习。

除非您确切知道代码的去向，否则世界上所有关于错误可能在哪里的理论都是毫无价值的。如果代码很复杂，发现代码没有在断点处停止可以像让它停止一样提供信息。

因此，根据我的经验，尽早并经常使用断点可能是发现代码如何工作的重要工具。

我经常发现，当一个问题看起来特别棘手时，那是因为我对正在发生的事情做了一个致命的假设，而没有真正验证它。

所以我的“最佳实践”是在我确定我理解而不是猜测之前不要继续前进。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-14T12:53:49.753

与调试没有直接关系，但为了让以后的调试更容易，有几点需要考虑：

*   实施单元测试，最好以 TDD 的形式，迫使您继续完成任务并仅以通过测试为目标进行开发。当您为测试而不是任务编码时，更难“徘徊”。
*   练习定期重构代码。与单一的“万事通”方法相比，小型的现场方法更容易调试。
*   利用你的团队成员。通常添加一组额外的眼睛可以帮助冲洗掉一些东西。很有可能，如果您没有以相对较快的方式找到某些东西，您将继续忽略它一段时间。
*   您始终可以回滚版本控制系统中的代码，以尝试隔离导致引入错误的文件版本。一旦你这样做了，你就可以区分最后一个好的和第一个坏的，只关注两者之间的变化。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-14T12:30:23.857

使用 C# 或 VB.NET 之类的语言在 VS.NET 中使用调试器的入门门槛非常低，以至于通常更容易在您知道问题所在的地方插入一两个断点，然后单步执行。

有时我发现自己使用“编辑并继续”来编写代码。这很棒。您可以立即看到结果。当有一些算法或相对难以理解的循环时，它通常最有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-02T21:03:30.203

老实说，这本书是我读过的关于调试的最好的书，尤其是当你超出正常的调试情况时。它包含许多技巧，并且与所有“真实故事”一起阅读很有趣。如果您正在处理大量不是您自己编写的代码，特别是如果它很糟糕，那么这本书是必须的！

[http://www.amazon.com/Debugging-Applications-Microsoft%C2%AE-Microsoft-Pro-Developer/dp/0735615365/ref=sr_1_1?ie=UTF8&s=books&qid=1238705836&sr=1-1](https://rads.stackoverflow.com/amzn/click/com/0735615365)

[替代文字 http://ecx.images-amazon.com/images/I/51RQ146x9VL._SS500_.jpg](http://ecx.images-amazon.com/images/I/51RQ146x9VL._SS500_.jpg)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-02T21:20:29.680

有一些帮助，尤其是当您不熟悉调试时，保留某种调试日志，其中包含您过去解决的问题的解决方案。大多数错误遵循相对常见的模式（例如，非线程应用程序中的明显随机问题通常是由于未定义的变量或类似使用未初始化的内存）并且通过跟踪这些模式，您将更好地确定未来的问题。

过了一会儿，你就形成了必要的直觉（然后你的日记就变成了一个非常有趣的记忆，你已经征服了所有讨厌的敌人）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-14T22:36:29.297

就像[概念大片](https://rads.stackoverflow.com/amzn/click/com/0201550865)建议的那样，每当我遇到困难时，我都喜欢尝试不同的方法。“printf 调试”，考虑行为，对代码进行二进制搜索，对版本控制提交进行二进制搜索，编写单元测试以澄清，[从头重构](http://www.oxtremists.co.uk/?p=133)，以及触发调试器。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-14T22:59:41.930

IMO 过多的准备是浪费时间。如果您相当了解代码库，您通常可以立即想到问题出现的几个关键位置。把断点放在那里，看看你是否正确。每当您看到更好的关键点时，移动您的断点以更接近问题。

当您追踪诸如空指针之类的不良数据时，这取决于它的来源：如果它作为参数传递，请查看调用堆栈以找到它的来源。如果它是某些数据结构或对象的一部分（更简单的情况），请在此处放置一个断点以查看何时以及如何对其进行修改。

条件断点可以提供很大帮助，否则您可以通过添加包含无操作的 if 语句来模拟它们。如果您在热点中的断点在您遇到问题之前经常被击中，请停用它并将另一个断点放在您知道在问题出现之前不久就会被击中的地方，然后激活热点中的断点。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-15T09:49:40.280

一个好的做法是确保您不是在解决症状，而是在解决原因。

通常，在调试时可能会看到一个奇怪的值并在那里修复它，而没有首先检查导致该值到达那里的原因。当然，这是一个非常糟糕的主意。

顺便说一句，这就是 Linus 反对为内核调试添加内置支持的原因。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-02T20:54:28.073

我将[在类似的线程上解释我的答案](https://stackoverflow.com/questions/711431/what-are-your-best-practices-for-bugs-that-are-hard-to-solve/711463#711463)（这基本上是[joseph.ferris*对此*线程](https://stackoverflow.com/questions/366453/best-practices-for-debugging/366513#366513)的回答中的最后一个要点）：

使用您的版本控制系统，使用二叉搜索树方法隔离引入错误的文件修订。

将源文件的该版本与以前的版本进行比较。差异可能会使错误的原因变得明显。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-10-22T10:30:57.640

这绝不是技术提示，但它通常适用于我的情况。

停止**努力**寻找根本原因或修复错误。放松片刻：散散步，吃晚饭，或者只是换个任务（希望更容易）——随便你……

......然后再考虑一个问题，当你再次“新鲜”时。追溯您已经经历过的所有调试心理过程（您所做的理论、实验、假设等）。您可能会立即看到一些您之前忽略的关键因素；）。

程序员（或者至少是我）倾向于在长时间的调试过程中逐渐缩小他们对问题的看法，并逐渐丧失创造力。但开阔的视野加上创意是人类与虫子战斗的最有力武器！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-14T16:18:30.103

我刚刚在[另一篇文章](https://stackoverflow.com/questions/365424/how-to-learn-c-debugging-and-best-practices#365575)中重播，问题是 C 调试，但正如我在重播中所说，我认为调试技术与语言无关。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-15T09:57:05.660

我想强调的一件事是，当您有一个实例工作而一个实例不工作（例如生产和开发）时，这是关于差异的，您需要清楚地确定它们可能是什么并一次处理*一个*。环境问题可能是最难追踪的，如果你不系统地工作，你会发疯的。

顺便说一句，这是我习惯性地通过 IIS 而不是 cassini 运行我的 VS webapp 项目的原因之一。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-07-03T17:50:47.240

我开始对我的所有项目做的另一件事是添加一个 TraceListener（或派生类）并使用它来获取我的应用程序的关键快照。

这通常能让我很好地了解我最初的调试工作应该集中在哪里。

另外，我可以使用配置文件开关打开/关闭它，因此我什至可以在生产系统上获得提示，而无需重新编译代码。

# vb.net - 我需要帮助制作我的 VB 2008 Express Web 浏览器

> ID：366454
> 
> 赞同：0
> 
> 时间：2008-12-14T11:56:29.150
> 
> 标签：vb.net, browser, window, tabbed

每次单击链接时，它都会在 Internet Explorer 中打开，但我希望它在我的 Web 浏览器的另一个窗口中打开。

详细信息：我创建了一个使用选项卡控件的选项卡式 Web 浏览器。其他控件将是普通的网络浏览器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-14T14:42:57.987

您必须像这样连接（旧的 activex）浏览器控件事件的 newwindow2：

```
Private Sub AxWebBrowser1_NewWindow2(ByVal sender As Object, ByVal e As AxSHDocVw.DWebBrowserEvents2_NewWindow2Event) Handles AxWebBrowser1.NewWindow2
    Dim frmWB As Form1
    frmWB = New Form1()

    frmWB.AxWebBrowser1.RegisterAsBrowser = True
    e.ppDisp = frmWB.AxWebBrowser1.Application
    frmWB.Visible = True
End Sub 
```

详细信息可以在这里找到[http://support.microsoft.com/?scid=kb%3Ben-us%3B311282&x=8&y=21](http://support.microsoft.com/?scid=kb%3Ben-us%3B311282&x=8&y=21)

# flash - （如何）你能在 Flash 中实现蜗牛 HTTP（彗星/长寿命连接）吗？

> ID：366485
> 
> 赞同：1
> 
> 时间：2008-12-14T12:24:08.017
> 
> 标签：flash, streaming, comet

我对 Web 应用程序的流式数据非常感兴趣。我已经尝试了一些 javascript 库，但是黑客和浏览器不兼容让我发疯了！HTML5 有望将流数据标准化，但在那之前，我希望我可以借助 Flash 使其在所有浏览器中都能正常工作。不幸的是，我对 Flash 提供的所有功能都不是很熟悉。

我在 Flash 8 中尝试过 loadVariables.onData，但它不支持流数据。数据仅在请求完成后可用。每次返回新数据时有什么方法可以调用函数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T02:34:08.927

尽管我不熟悉您在做什么，但听起来您应该查看[URLStream](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/index.html)。当您加载 Flash 可以直观理解的内容（MP3、JPG、SWF 等）时，您通常会使用[Loader](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/Loader.html)，然后您也可以获得[进度事件](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/LoaderInfo.html#event:progress)，但我猜您是在谈论加载任意数据到 ByteArray 中，并且 URLStream 应该为您提供所需的所有低级访问。

这是假设您使用的是 AS3 和 Flash Player 9+。我不会发誓，但我很确定你正在寻找的东西在 AS2 下是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T04:35:09.243

如果您只想流式传输单个文件，请按照 fenomas 的建议使用 URLStream。如果您想要一个可以发送和接收数据的开放连接，您正在寻找的类是[XMLSocket](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/net/XMLSocket.html)。应该适用于 Flash 5 之后的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T04:48:11.430

正如 Moss Collum 和 fenomas 所建议的，有`URLStream`和`XMLSocket`。但是，如果您想在二进制级别上与服务器交互，您可以使用`Socket`对象读取和写入字节。

请记住，任何网络通信都受制于 Flash Player 非常严格的安全模型。您可能会发现学习这方面的时间非常值得。

# asp.net-mvc - 使用 asp.net MVC 和 RouteUrl 创建 url

> ID：366498
> 
> 赞同：3
> 
> 时间：2008-12-14T12:36:33.717
> 
> 标签：asp.net-mvc, model-view-controller, routes

我想获取当前 URL 并将附加参数附加到 url（例如 ?id=1）

我已经定义了一条路线：

```
 routes.MapRoute(
            "GigDayListings",                                   // Route name
            "gig/list/{year}/{month}/{day}",                    // URL with parameters
            new { controller = "Gig", action = "List" }         // Parameter defaults
        );

        In my view I have a helper that executes the following code: 

        // Add page index
        _helper.ViewContext.RouteData.Values["id"] = 1;

        // Return link
        var urlHelper = new UrlHelper(_helper.ViewContext);
        return urlHelper.RouteUrl( _helper.ViewContext.RouteData.Values); 
```

但是，这不起作用。

如果我的原始网址是：gig/list/2008/11/01

我明白了

gig/list/?year=2008&month=11&day=01&id=1

我希望网址为：controller/action/2008/11/01?id=1

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-14T12:47:31.073

规则的顺序是有意义的。尝试首先插入此规则。

如果需要，也不要忘记定义约束 - 这将导致更好的规则匹配：

```
routes.MapRoute(
    "GigDayListings",                                // Route name
    "gig/list/{year}/{month}/{day}",                // URL with parameters
    new { controller = "Gig", action = "List" },    // Parameter defaults
    new
        {
            year = @"^[0-9]+$",
            month = @"^[0-9]+$",
            day = @"^[0-9]+$"
        }    // Constraints
); 
```

# oop - 只使用一次的长方法应该在它自己的类中还是在函数中？

> ID：366507
> 
> 赞同：1
> 
> 时间：2008-12-14T12:47:37.127
> 
> 标签：oop

很多时候，在互联网上的代码或我同事的代码中，我看到他们只用一种方法创建了一个对象，该方法只在整个应用程序中使用一次。像这样：

```
 class iOnlyHaveOneMethod{
   public function theOneMethod(){
     //loads and loads of code, say 100's of lines
     // but it only gets used once in the whole application
   }
 }

 if($foo){ 
  $bar = new iOnlyHaveOneMEthod;
  $bar->theOneMethod();
 } 
```

那真的更好吗：

```
if($foo){
 //loads and loads of code which only gets used here and nowhere else
} 
```

?
为了可读性，将代码的负载和负载移开是有意义的，但它不应该只是在一个函数中吗？

```
function loadsAndLoadsOfCode(){
 //Loads and loads of code
}
if($foo){ loadsAndLoadsOfCode(); } 
```

将代码移动到一个新对象真的比创建一个函数或直接将代码放在那里更好吗？
对我来说，函数部分更有意义，看起来更易读，然后创建一个几乎没有任何用处的对象，因为它只包含一个方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-14T12:55:21.120

问题不在于它是在函数中还是在对象中。

问题是一个blob中有数百行。大量代码是在对象的方法中还是只是在一个类中，对我来说似乎或多或少无关紧要，只是次要的语法糖。

那数百行在做什么？这是实现面向对象最佳实践的地方。

如果您的其他开发人员真的认为使用对象而不是函数会使其更加“面向对象”，但是拥有数百行函数/方法并不被视为代码味道，那么我认为从组织上讲，您需要接受一些教育.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-14T12:54:28.003

好吧，如果方法中确实存在“加载和加载”代码，那么它应该在该类中分解为几个受保护的方法，在这种情况下使用类范围是合理的。

也许该代码不可重用，因为它没有被很好地分解为几个不同的方法。通过将其移动到一个类中并将其分解，您可能会发现它可以更好地在其他地方重用。至少它会更易于维护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-14T13:26:12.150

虽然具有数百行代码的函数清楚地表明了一个问题（正如其他人已经指出的那样），但将它放在单独的实例类而不是静态函数*中确实*具有优势，您可以通过重新调整您的示例来利用它：

```
// let's instead assume that $bar was set earlier using a setter
if($foo){ 
    $bar = getMyBar();
    $bar->theOneMethod();
} 
```

现在，这为您提供了几个优势：

*   这是[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)的一个简单示例。如果`$bar`实现了提供的接口，`theOneMethod()`那么您可以动态切换该方法的实现；

*   独立测试您的课程`$bar->theOneMethod()`要容易得多，因为您可以`$bar`在测试时用模拟代替。

如果您只使用静态函数，则这些优点均不可用。

我认为，虽然简单的静态函数有它们的位置，但重要的方法（因为这显然是“数百行”评论）无论如何都应该有自己的实例：

*   分离关注点；
*   帮助测试；
*   以帮助重构和重新实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T13:45:04.890

你真的在这里问两个问题：

*   只是声明一个函数比创建一个只保存这个函数的对象更好吗？
*   任何函数都应该包含“大量代码”吗？

第一部分：如果您希望能够动态切换功能，您可能需要显式对象封装作为无法以这种方式处理功能的语言的解决方法。当然，当您只想调用一个函数时，必须分配一个新对象，将其分配给一个变量，然后从该变量调用函数有点愚蠢。

第二部分：理想情况下不是，但“负载”没有明确的定义，在某些情况下可能是合适的做法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-14T12:56:53.850

是的，负载和代码负载的存在是[Code Smell](http://en.wikipedia.org/wiki/Code_smell)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T12:57:05.847

我会说你几乎从不想拥有一个包含大量代码的块或方法——不管它是否在它自己的类中。

将它移动到一个对象可能是重构的第一步，'虽然 - 所以它可能以这种方式有意义。首先将其移动到自己的类中，然后将其拆分为几个较小的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-14T13:03:34.053

好吧，我想说这取决于代码块与代码调用部分的耦合程度。

如果它耦合得如此紧密，以至于我无法想象它会在其他任何地方使用，我宁愿将它粘贴在调用类的私有方法中。这样它就不会被系统的其他部分看到，保证它不会被其他人滥用。

另一方面，如果代码块足够通用（即电子邮件验证），可能在系统的其他部分中很有趣，我可以毫无问题地将该部分提取到它自己的类中，然后认为这是一个实用程序类。即使这意味着它将是一个单一方法类。

如果您的问题更多是“如何处理数百行代码”，那么您确实需要进行一些重构。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-14T13:04:10.027

具有大量代码的单一方法是一种代码气味。我的第一个想法是至少使方法静态。类中没有数据，因此无需创建对象。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-14T13:05:41.023

我想我会重新表述你提出的问题。我想你要问的问题是我班配套的[单打责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。有没有办法将你的类的各个部分分解成单独的更小的部分，这些部分可能会相互独立地改变（数据访问和解析等）。你能轻松地对你的课程进行单元测试吗？.

如果您可以对上述项目说“是”，我不会担心方法与新类，因为这里的重点是您拥有可读、可维护的代码。

在我的团队中，如果一个类变得很长（超过 x 行），我们会有危险信号，但这只是一种启发式方法，就好像你的类有 2000 行代码它可能会被分解并且可能不支持 SRP。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-14T14:09:44.513

为了可测试性，最好将其分解为具有单独方法的单独类。为单个方法编写单元测试比作为代码隐藏文件或其他文件中的内联 if 语句的一部分要容易得多。

话虽如此，我同意其他所有人的观点，即该方法应分解为单一职责方法，而不是数百行代码。这也将使它更具可读性和更容易测试。并且希望您可以从那一大堆代码中包含的一些逻辑中得到一些重用。

# c# - 学习 windbg 的功能和优点的最佳资源是什么？

> ID：366517
> 
> 赞同：4
> 
> 时间：2008-12-14T12:55:17.050
> 
> 标签：c#, debugging, windbg

学习 windbg 的功能和优点的最佳资源是什么？我希望能够讨论调查内存问题（句柄、对象）、性能问题等。. .

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-14T14:19:40.123

这些是我喜欢的一些：

*   [Maoni Stephens 和 Claudio Caldato 在 MSDN 上的文章](http://msdn.microsoft.com/en-us/magazine/cc163528.)
*   [毛尼的博客](http://blogs.msdn.com/maoni/)（最近没更新但是里面有很多有用的资料）
*   [Tess Fernandez](http://blogs.msdn.com/tess/)有很多关于 Windbg 的信息，请查看她在 Barcellona 的 teched 视频。她还有一篇名为“ [Learning .NET Debugging](http://blogs.msdn.com/tess/archive/2008/01/30/learning-net-debugging.aspx) ”的文章，肯定会有所帮助。我建议你订阅这个博客，它总是充满关于调试的新鲜信息。
*   [来自 Wintellect 的 John Robbins](http://www.wintellect.com/CS/blogs/jrobbins/default.aspx)在 MSDN 杂志上有一个名为[BUGSLAYER](http://msdn.microsoft.com/en-us/magazine/cc163322.aspx)的专栏，因此请查看它，并且他的书[Debugging Microsoft .NET 2.0 Application](https://rads.stackoverflow.com/amzn/click/com/0735622027) s 有几章专门针对 winDbg
*   [安装 WinDBG](http://blogs.msdn.com/johan/archive/2007/01/11/how-to-install-windbg-and-get-your-first-memory-dump.aspx)
*   入门[第 1](http://blogs.msdn.com/johan/archive/2007/11/13/getting-started-with-windbg-part-i.aspx)部分和[第 2 部分](http://blogs.msdn.com/johan/archive/2007/11/26/getting-started-with-windbg-part-ii.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T13:43:26.203

这里的资源也不错！

[http://bartdesmet.net/blogs/bart](http://bartdesmet.net/blogs/bart)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T13:37:15.937

下面，我链接了一个关于如何将 Windbg 用于 ASP.NET 应用程序的视频。我不知道为什么标题是另一种语言，但视频是英文的。

[第 9 频道 - Windbg 和 ASP.NET](http://channel9.msdn.com/posts/deurell/ASPnet-hanganalys-med-WinDbg-Del-1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T14:45:23.880

检查[DumpAnalysis.org](http://www.dumpanalysis.org/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-14T17:36:00.120

Check out [Tess Ferrandez' blog](http://blogs.msdn.com/tess/default.aspx). Very good advice and lots of details. There are excellent labs as well to help you practice your skills.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T13:58:18.827

当然，[SOS 调试扩展参考](http://msdn.microsoft.com/en-us/library/bb190764.aspx)也非常好！

# apache-flex - ActionScript 中的语法高亮库

> ID：366528
> 
> 赞同：6
> 
> 时间：2008-12-14T13:05:09.917
> 
> 标签：apache-flex, flash, actionscript, syntax-highlighting

我让用户在我的 Flex3 (Flash 10) 应用程序中输入一些代码，我想做语法高亮。

有没有可以帮助我的开源库？

我需要 Lua 语法支持，但如果库有一个合理的接口来执行此操作，我可以自己添加它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T12:26:42.077

2009 年 1 月 21 日更新：

查看[Anirudh 的 google-code-prettify 到 ActionScript3 的端口](http://code.google.com/p/as3syntaxhighlight/)，它也有一个非常好的示例应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T15:29:19.627

我想这直到现在都不可行。

有了新的[Flash 文本引擎](http://opensource.adobe.com/wiki/display/flexsdk/Gumbo+Text+Primitives)，也许这种基于文本的功能会开始出现，并希望像[FlashEff](http://www.flasheff.com)库一样工作的开源库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T09:44:18.573

我也想做语法高亮，我找到了一个例子 [http://labs.searchcoders.com/text/](http://labs.searchcoders.com/text/)

您将需要获取他们的动作脚本代码，当人们更改您的文本区域中的文本时，您将需要重新绘制语法突出显示。

基本上我这样做是因为我在 FLEX 中制作自己的 IDE/Language。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-23T14:39:27.743

试试这个：[http](http://www.flashtexteditor.com/ftf/) ://www.flashtexteditor.com/ftf/ 或者这个： http: [//www.matthijskamstra.nl/blog/index.php/2008/06/04/actionscript-syntax-highlighting/](http://www.matthijskamstra.nl/blog/index.php/2008/06/04/actionscript-syntax-highlighting/)

# shell - 如何从文件中删除第一行的列表中运行第一个进程，就好像该文件是一个队列并且我称之为“pop”？

> ID：366533
> 
> 赞同：3
> 
> 时间：2008-12-14T13:09:11.267
> 
> 标签：shell, unix, queue

如何从存储在文件中的进程列表中运行第一个进程并立即删除第一行，就好像该文件是一个队列并且我称之为“pop”？

我想以类似弹出的方式调用简单文本文件中列出的第一个命令，其中 \n 作为分隔符：

*图1：*

```
cmdqueue.lst :

proc_C1
proc_C2
proc_C3
.
. 
```

*图 2：*

通过以下方式弹出第一个命令`popcmd`：

```
proc_A | proc_B | popcmd cmdqueue.lst | proc_D 
```

*图 3：*

```
cmdqueue.lst :

proc_C2
proc_C3
proc_C4
.
. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T13:33:45.443

弹出-cmd.py：

```
#!/usr/bin/env python
import os, shlex, sys
from subprocess import call
filename = sys.argv[1]
lines = open(filename).readlines()
if lines:
    command = lines[0].rstrip()
    open(filename, "w").writelines(lines[1:])
    if command:
        sys.exit(call(shlex.split(command) + sys.argv[2:])) 
```

例子：

```
proc_A | proc_B | python pop-cmd.py cmdstack.lst | proc_D 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-14T14:47:47.603

哦，这是一个有趣的单线。

好的，这是交易。你想要的是一个程序，当被调用时，将文件的第一行打印到标准输出，然后从文件中删除该行。听起来像是*sed(1)*的工作。

尝试

```
proc_A | proc_B | `(head -1 cmdstack.lst; sed -i -e '1d' cmdstack.lst)` | proc_D 
```

我敢肯定，已经喝过咖啡的人可以将 sed 程序更改为不需要*head(1)*调用，但这很有效，并展示了使用子shell（“（ foo ）”在子进程中运行。 )

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-14T20:26:38.090

我假设您也不断地附加到文件中，因此重写文件会使您面临覆盖数据的危险。对于这种类型的任务，我认为您最好为每个队列条目使用单独的文件，使用日期/时间来确定顺序，然后在处理每个文件时，您可以将数据附加到日志文件，然后删除触发器文件。

确实需要更多信息才能提出一个好的解决方案。了解文件是如何更新的很重要。是不是有很多单独的进程，只有一个进程，等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T13:21:02.677

我认为您需要重写文件 - 例如运行命令列出除第一行之外的所有行，将其写入临时文件并将其重命名为原始文件。这可以使用 tail 或 awk 或 perl 来完成，具体取决于您可用的命令。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-14T13:42:09.763

如果您想将文件视为堆栈，那么更好的方法是将堆栈的顶部放在文件的末尾。

因此，您可以轻松地在最后一行 (= pop) 的开头切断文件，并在推送时简单地附加到文件中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-14T15:19:11.457

您可以使用一点 bash 脚本；将其命名为“popcmd”：

```
#!/bin/bash
cmd=`head -n 1 $1`
尾 -n +2 $1 > ~tmp~
mv -f ~tmp~ $1
$cmd
```

*编辑：*使用 sed 作为中间两行，就像查理·马丁展示的那样，当然要优雅得多：

```
#!/bin/bash
cmd=`head -n 1 $1`
sed -i -e '1d' $1
$cmd
```

*编辑：*您可以完全按照您的示例使用代码使用它：

```
proc_A | proc_B | popcmd cmdstack.lst | proc_D
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-14T14:54:22.347

您不能写入文件的开头，因此删除第 1 行将是很多工作（重写文件的其余部分（这对程序员来说实际上并没有那么多工作（这是所有其他答案帖子的内容）为你写的:) ) ) )。

我建议将整个内容保存在内存中并使用经典堆栈而不是文件。

# c# - 使用自定义 IEqualityComparer 对 Dictionary 进行 XML 序列化

> ID：366541
> 
> 赞同：3
> 
> 时间：2008-12-14T13:18:18.360
> 
> 标签：c#, serialization, dictionary, xml-serialization

我想序列化具有自定义`IEqualityComparer`.

我试过使用`DataContractSerializer`，但我无法`Comparer`序列化。

`BinaryFormatter`因为[这个](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=303278&wa=wsignin1.0)我不能用。

我总是可以做类似的事情：

```
var myDictionary = new MyDictionary(deserializedDictionary, myComparer); 
```

但这意味着我需要两倍于字典使用的内存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-14T19:54:24.520

为什么自定义的 Comparer 甚至需要序列化？这是一个适合我的测试用例。

```
使用系统；
使用 System.Collections.Generic；
使用 System.Runtime.Serialization；
使用 System.IO；

公共类 MyKey {
    公共字符串名称 { 获取；放; }
    公共字符串 ID { 获取；放; }
}

公共类 MyKeyComparer :IEqualityComparer {
    公共布尔等于（MyKey x，MyKey y）{
        返回 x.Id.Equals( y.Id ) ;
    }
    公共int GetHashCode（MyKey obj）{
        如果（obj == null）
            抛出新的 ArgumentNullException();

        return ((MyKey)obj).Id.GetHashCode();
    }
}

公共类我的字典：字典{
    公共我的字典（）
        :base(新的MyKeyComparer())
    {}
}

类程序{
    静态无效主要（字符串[] args）{
        var myDictionary = new MyDictionary();
        myDictionary.Add(new MyKey() { Name = "MyName1", Id = "MyId1" }, "MyData1" );
        myDictionary.Add(new MyKey() { Name = "MyName2", Id = "MyId2" }, "MyData2" );

        var ser = new DataContractSerializer( typeof( MyDictionary ) );

        使用（FileStream writer = new FileStream（“Test.Xml”，FileMode.Create））
            ser.WriteObject（作家，我的字典）；

        使用（文件流阅读器=新文件流（“Test.Xml”，FileMode.Open））
            myDictionary = (MyDictionary)ser.ReadObject( reader );
    }
}

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T15:52:59.250

我刚刚阅读了错误报告...

> 对于超过 1320 万个对象的对象图，二进制序列化失败。

如果你有一个那么大的图表，你总是可能会遇到一些问题。

您想尝试替代序列化程序吗？“protobuf-net”是一个定制的二进制序列化器，遵循 Google 的协议缓冲区格式，可能适用于更大的集合，尤其是在“组”模式下。

# javascript - 如何将 Microsoft.Matrix 过滤器等同于画布旋转？

> ID：366548
> 
> 赞同：0
> 
> 时间：2008-12-14T13:27:55.953
> 
> 标签：javascript, image, html, canvas, rotation

有没有人可以帮助使用这个通用旋转功能（它适用于 jQuery，但这是 JavaScript 的东西）？

我更改了非 IE 画布代码，使其围绕图像的中心旋转（请参阅Firefox 中的[http://uptowar.com/jquery](http://uptowar.com/jquery)）。现在我需要更改 IE Microsoft 过滤器以执行相同的操作（请参阅 Internet Explorer 中的相同 URL）。但是，怎么做？该过滤器几乎没有可理解的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-14T21:12:46.873

假设您有一个以弧度为单位的角度 nAngle，则旋转矩阵将如下所示：

```
var nCos = Math.cos(nAngle).toFixed(3),
    nSin = Math.sin(nAngle).toFixed(3);

var sFilter = "progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11=" + nCos + ", M12=" + (-nSin) + ", M21=" + nSin + ", M22=" + nCos + ")";

```

您可能还想查看规范：[矩阵过滤器](http://msdn.microsoft.com/en-us/library/ms533014(VS.85).aspx)

# php - 在 Mac OSX 上使用 MAMP 时，如何让 CakePHP 烘焙以查找 mysql.sock 并识别 MySQL？

> ID：366550
> 
> 赞同：3
> 
> 时间：2008-12-14T13:29:58.087
> 
> 标签：php, mysql, cakephp

我目前正在阅读 David Golding 的“Beginning CakePHP:From Novice to Professional”。有一次我必须使用 CLI 命令“cake bake”，我得到了欢迎屏幕，但是当我尝试烘焙控制器时，我收到以下错误消息：

```
Warning: mysql_connect(): Can't connect to local MySQL server through socket '/var/mysql/mysql.sock' (2) in /Applications/MAMP/htdocs/blog/cake/libs/model/datasources/dbo/dbo_mysql.php on line 117

Warning: mysql_select_db(): supplied argument is not a valid MySQL-Link resource in /Applications/MAMP/htdocs/blog/cake/libs/model/datasources/dbo/dbo_mysql.php on line 122

Warning: mysql_get_server_info(): supplied argument is not a valid MySQL-Link resource in /Applications/MAMP/htdocs/blog/cake/libs/model/datasources/dbo/dbo_mysql.php on line 130

Warning: mysql_query(): supplied argument is not a valid MySQL-Link resource in /Applications/MAMP/htdocs/blog/cake/libs/model/datasources/dbo/dbo_mysql.php on line 154
Error: Your database does not have any tables. 
```

我怀疑错误消息与php试图访问错误的mysql-socket有关，即默认的osx mysql-socket - 而不是MAMP使用的那个。因此，我更改了我的数据库配置以连接到 UNIX mysql-socket (:/Applications/MAMP/tmp/mysql/mysql.sock)：

```
class DATABASE_CONFIG {

    var $default = array(
        'driver' => 'mysql',
        'connect' => 'mysql_connect',
        'persistent' => false,
        'host' =>':/Applications/MAMP/tmp/mysql/mysql.sock', // UNIX MySQL-socket
        'login' => 'my_user',
        'password' => 'my_pass',
        'database' => 'blog',
        'prefix' => '',
    );

} 
```

但是我收到与新套接字相同的错误消息：

```
Warning: mysql_connect(): Can't connect to local MySQL server through socket '/Applications/MAMP/tmp/mysql/mysql.sock:3306' (2) in /Applications/MAMP/htdocs/blog/cake/libs/model/datasources/dbo/dbo_mysql.php on line 117

Warning: mysql_select_db(): supplied argument is not a valid MySQL-Link resource in /Applications/MAMP/htdocs/blog/cake/libs/model/datasources/dbo/dbo_mysql.php on line 122

Warning: mysql_get_server_info(): supplied argument is not a valid MySQL-Link resource in /Applications/MAMP/htdocs/blog/cake/libs/model/datasources/dbo/dbo_mysql.php on line 130

Warning: mysql_query(): supplied argument is not a valid MySQL-Link resource in /Applications/MAMP/htdocs/blog/cake/libs/model/datasources/dbo/dbo_mysql.php on line 154
Error: Your database does not have any tables. 
```

此外，即使我使用 MAMP 在其欢迎屏幕上显示的 UNIX 套接字，当使用此套接字而不是 localhost 时，CakePHP 也会丢失数据库连接。

关于如何让烘焙工作的任何想法？

**-- 编辑 1 --**

谢谢你们帮助我！:)

我无法确定在 my.cnf 中的哪个位置进行编辑以让 MySQL 监听 TCP/IP 请求。我能找到提到 TCP/IP 的唯一段落如下：

```
# Don't listen on a TCP/IP port at all. This can be a security enhancement,
# if all processes that need to connect to mysqld run on the same host.
# All interaction with mysqld must be made via Unix sockets or named pipes.
# Note that using this option without enabling named pipes on Windows
# (via the "enable-named-pipe" option) will render mysqld useless!
# 
#skip-networking 
```

这使我可以完全关闭 TCP/IP，这与我的意图相反。我不知道如何去做你的建议，如果你能更详细一点，那就太好了。在这些问题上我完全不知道：S

注册。连接到本地套接字：我删除了主机参数中的前导冒号，结果相同。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-08-23T16:22:14.003

我找到了解决这个问题的方法：在 cakephp app/config/database.php 文件中添加一个套接字配置

```
class DATABASE_CONFIG {

var $default = array(
    'driver' => 'mysql',
    'persistent' => false,
    'host' => 'localhost',
    'port' => '/Applications/MAMP/tmp/mysql/mysql.sock', // here is the key !
    'login' => 'you',
    'password' => 'yourpass',
    'database' => 'yourdb',
    'prefix' => '',

); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-14T13:37:18.073

从错误来看，它似乎正在尝试连接到实际 IP 地址而不是 UNIX 套接字，请看：

```
'/Applications/MAMP/tmp/mysql/mysql.sock:3306'

```

它在套接字上附加了一个端口，这是错误的。

因此，我首先尝试将 MySQL 配置为侦听 TCP/IP 请求（编辑 my.cnf 中的适当部分）并尝试提供 127.0.0.1 而不是套接字。

如果您[不会向下滚动](https://stackoverflow.com/a/1318934/5190)：

要在 CakePHP 级别修复它，请将 database.php 上的主机更改为“localhost”并添加一个端口指令，并将其值设置为套接字名称“/Applications/MAMP/tmp/mysql/mysql.sock”

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-23T09:55:35.693

对于在使用 CakePHP 2.0 时遇到此问题的任何人：对我来说，上面的数据库配置文件并没有解决问题。找到了对我有用的“unix_socket”属性：

```
<?php
class DATABASE_CONFIG {

    public $default = array(
        'datasource' => 'Database/Mysql',
        'driver' => 'mysql',
        'persistent' => false,
        'host' => 'localhost',
        'unix_socket' => '/tmp/mysql.sock',
        'login' => 'xxx',
        'password' => 'xxx',
        'database' => 'xxx',
        'encoding' => 'UTF8',
        'prefix' => ''
    );

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T02:37:02.723

在使用 MAMP 和 Cake CLI 时，我遇到了同样的问题。我正在运行 CakePHP 1.1xxx 和 MAMP 1.7。

问题是，找不到 MySQL 套接字：D

打开终端并输入以下内容：

```
my-macbook:~ chris$ php -i | grep mysql.default_socket
mysql.default_socket => no value => no value
my-macbook:~ chris$ php -i -c /Applications/MAMP/conf/php5 | grep mysql.default_socket
mysql.default_socket => /Applications/MAMP/tmp/mysql/mysql.sock => /Applications/MAMP/tmp/mysql/mysql.sock 
```

问题是，如果没有明确地为 php 二进制文件提供其（读取 MAMP 的）配置文件的路径，则 mysql.default_socket 未设置。

使用它我不需要更改我的数据库配置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T14:32:11.270

```
sudo ln -s /Applications/MAMP/tmp/mysql/mysql.sock /tmp/mysql.sock 
```

我对 mamp 有同样的问题，并用上面的命令修复了它。我认为每次重新启动计算机时都必须运行此命令。也许有更好的方法可以做到这一点，但我将它与 clix.app 一起使用，所以它通常很快。另外，将您的主机更改为 localhost。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-24T21:45:36.487

对我来说，我忘了在主机上设置端口，因为我没有在 MAMP 中使用默认的 MySQL 端口。

即如果你的 MySQL 端口是 8889，设置`host`为`localhost:8889`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-14T17:19:07.563

是的，有一个类似的问题，我认为像 Vinko 建议的那样指向 socket:portno 可能会起作用 - 但是，如果你使用 IP 地址/本地主机，你会没事的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-02T17:52:03.010

```
 class DATABASE_CONFIG
{
    public $default  =   array(
        'driver'        =>  'mysql',
        'persistent'    =>  false,
        'host'          =>  'localhost',
        'login'         =>  'account',
        'password'      =>  'password',
        'database'      =>  'database',
        'prefix'        =>  '',
        'port'          =>  '/var/mysql/mysql.sock'
    );
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-06T04:42:23.927

这对我有用：

```
class DATABASE_CONFIG
{
        public $default  =       array(
                'driver'                =>      'mysql',
                'persistent'    =>      false,
                'host'                  =>      'localhost',
                'login'                 =>      'account',
                'password'              =>      'password',
                'database'              =>      'database',
                'prefix'                =>      '',
                'port'                  =>      '/Applications/MAMP/tmp/mysql/mysql.sock'
        );
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-08-10T08:38:31.930

尝试配置你的防火墙......对我来说就是这种情况！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-09-21T10:40:51.543

你也可以做一个符号链接，bake 是在 /tmp 中寻找 mysql.sock

像这样：

ln -s /Applications/MAMP/tmp/mysql/mysql.sock /tmp/mysql.sock

干杯，埃博特。

# c# - Mono 在客户端和服务器上共享代码。.

> ID：366562
> 
> 赞同：3
> 
> 时间：2008-12-14T13:46:10.207
> 
> 标签：c#, java, shared-libraries

我们正在尝试提出我们的客户端和服务器标准，并且存在很大的争论。一种思想流派是 C# 客户端和 Java 服务器使用某种类型的专有消息库来共享数据对象（想想类似 XML 的结构......）

此模型的问题在于，如果您在服务器上也使用 C#，则需要复制大量代码（验证、解析），这些代码可以简单地重用。如果大力推动使用 linux 机器，那么 mono 不会支持您的目标。.

其他人有这个困境吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T16:02:46.920

有这方面的框架。ICE（ZeroC）、“协议缓冲区”等。

例如，我的协议缓冲区实现（protobuf-net）适用于单声道、MS .NET、CF、Silverlight 等 - 二进制格式与*一系列*语言（java 等）兼容。如果您从 .proto（一种定制的定义语言）开始，您可以使用它以您需要的每种语言生成对象层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T16:49:54.377

在任何情况下，我都会使用 Protocol Buffers 或其他以中性语言形式定义的通信，以确保您将来不受限制。

完成后，您可以从 Mono 上的 C# 开始。然后，如果这被证明不可行，您可以切换到另一种语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T16:56:46.127

我建议您使用一些旧但很好的标准在两者之间传输数据，例如 SOAP 和 XML-RPC。如果其中任何一个可行或可行，您可能想尝试 JSON 或编写自己的 XML 格式。最近很多人提到了协议缓冲区，但我还没有研究过，所以我真的无话可说。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-14T13:59:30.603

我会尝试使客户端和服务器保持相同的运行时（Java 或 CLR）。我们使用 Mono 和 .Net 客户端/服务器的组合取得了很多成功。

# apache - .htaccess 子域的重写规则

> ID：366586
> 
> 赞同：8
> 
> 时间：2008-12-14T14:24:52.267
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

我使用 codeigniter 作为我在主域上的主要安装。我创建了一个子域和一个名为 live 的文件夹，例如 live.domain.com 映射到 public/live 。但是在公共场合我使用codeigniter。

我现在有动态 codeigniter url：

```
http://domain.com/api/
```

我想映射到我的子域：

```
https://live.domain.com
```

所以要去：

```
https://live.domain.com/api/functioname
```

将使用脚本：

```
http://domain.com/api/apifunctioname
```

并且可能：

```
http://domain.com/api/apifunctioname/parameter1/parameter
```

一切都在同一台服务器上，因此不需要重定向。

有人对使用哪些重写规则有任何想法吗？

```
Options +FollowSymLinks

RewriteEngine On

RewriteCond %{HTTP_HOST} ^live\.domain\.com [NC]
RewriteRule (.+)$ "http://domain.com/api/$1" [L] 
```

以上作为重写非常有效，但重定向到[http://domain.com/api/functionname](http://domain.com/api/functionname)而不是我希望它路由；这样当去：

```
https://live.domain.com/api/functioname
```

它停留在该网址，但使用的脚本

```
http://domain.com/api/functionname
```

非常感谢，

冰

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-14T14:38:58.977

像下面这样的东西怎么样：

```
重写引擎开启
RewriteCond %{HTTP_HOST} ^live\.domain\.com$ [NC]
RewriteRule (.+)$ "https://domain.com/api/$1" [L,P]

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-03-24T18:03:43.617

只需添加 index.php，见下文

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^live\.domain\.com$ [NC]
RewriteRule (.+)$ "https://domain.com/index.php/api/$1" [L,P] 
```

# coding-style - 一个好的程序员的代码是什么样的？

> ID：366588
> 
> 赞同：91
> 
> 时间：2008-12-14T14:31:36.310
> 
> 标签：coding-style

我是一名业余程序员（从 VBA 开始以使 excel 更快）并且一直在使用 VB.NET / C#.NET 并且正在尝试学习 ADO.NET。

一直让我感到沮丧的编程方面是“好”是什么样的？我不是专业人士，所以没什么可比较的。是什么造就了一个更好的程序员？是吗：

*   他们对给定语言中的所有对象/类/方法有更好的理解吗？
*   他们的程序更有效率？
*   他们的程序设计在更好的文档、更好的函数名称选择等方面要好得多？

换句话说，如果我要查看专业程序员的代码，我首先会注意到他们的代码相对于我的代码是什么？例如，我阅读了 Wrox 出版社的“Professional ASP.NET”之类的书。那本书中的代码示例是“世界级”吗？那是巅峰吗？任何顶级程序员都会看到该代码并认为它​​是好代码吗？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2008-12-14T14:51:43.897

下面的列表并不全面，但这些是我在考虑您的问题时想到的。

*   好的代码是组织良好的。类中的数据和操作结合在一起。类之间没有无关的依赖关系。它看起来不像“意大利面”。

*   好的代码注释解释了为什么事情没有完成而不是做了什么。代码本身解释了做了什么。对评论的需求应该是最小的。

*   好的代码对除了最短暂的对象之外的所有对象都使用有意义的命名约定。某物的名称提供了有关何时以及如何使用该对象的信息。

*   好的代码是经过良好测试的。测试作为代码的可执行规范及其使用示例。

*   好的代码不是“聪明”的。它以简单明了的方式做事。

*   好的代码是在小的、易于阅读的计算单元中开发的。这些单元在整个代码中被重用。

我还没有读过，但我打算读的关于这个主题的书是Robert C. Martin 的[Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882)。

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2008-12-14T14:42:04.137

您会注意到的第一件事是他们的代码遵循一致的[编码风格](http://en.wikipedia.org/wiki/Programming_style)。他们总是写同样的结构块，虔诚地缩进并在适当的地方发表评论。

您会注意到的第二件事是，他们的代码被分割成最多不超过几十行的小方法/函数。他们还使用自我描述的方法名称，并且通常他们的代码非常易读。

在您稍微弄乱代码之后，您会注意到的第三件事是逻辑易于遵循，易于修改 - 因此易于维护。

之后，您将需要一些软件设计技术方面的知识和经验，以了解他们在构建代码架构时所采取的具体选择。

关于书籍，我还没有看到很多书籍可以将代码视为“世界级”。在书中，他们主要尝试提供简单的示例，这些示例可能与解决非常简单的问题相关，但不能反映更复杂的情况。

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2008-12-14T17:07:30.987

引用福勒，总结可读性：

> **任何傻瓜都可以编写计算机可以理解的代码。
> 优秀的程序员编写人类可以理解的代码。**

'不够说。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2008-12-14T15:54:28.250

就个人而言，我不得不引用Tim Peters*的“The Zen of Python”*。它告诉 Python 程序员他们的代码应该是什么样子，但我发现它基本上适用于所有代码。

> 美丽总比丑陋好。
> 显式优于隐式。
> 简单胜于复杂。
> 复杂胜于复杂。
> 平面优于嵌套。
> 稀疏比密集好。
> 可读性很重要。
> 特殊情况不足以打破规则。
> 虽然实用胜过纯洁。
> 错误永远不应该悄无声息地过去。
> 除非明确沉默。
> 面对模棱两可，拒绝猜测的诱惑。
> 应该有一种——最好只有一种——明显的方法来做到这一点。
> 虽然这种方式一开始可能并不明显，除非你是荷兰人。
> 现在总比没有好。
> 虽然从不经常比*现在*。
> 如果实现很难解释，那是个坏主意。
> 如果实现很容易解释，那可能是个好主意。
> 命名空间是一个很棒的想法——让我们做更多的事情！

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-12-14T14:39:06.387

代码就是诗。

从这个逻辑点开始，您可以推导出许多理想的代码品质。最重要的是，请注意阅读的代码远多于编写的代码，因此为读者编写代码。为读者重写、重命名、编辑和重构。

后续推论：

读者将是您在代码创建之日起的 n 时间。为读者编写代码的回报是 n 的单调递增函数。n == infinity 表示第一次查看您的代码的读者。

换句话说，从编写代码到重新访问代码的时间间隔越大，您就越会感谢您为读者编写的努力。此外，您将代码交给任何人都将从以读者为首要考虑编写的代码中受益匪浅。

第二个推论：

不考虑读者而编写的代码可能会不必要地难以理解或使用。当读者的考虑下降到某个阈值以下时，读者从代码中获得的价值低于通过重写代码获得的价值。发生这种情况时，以前的代码被丢弃，可悲的是，在重写期间重复了许多工作。

第三个推论：

众所周知，推论二会在文档记录不佳的代码随后强制重写的恶性循环中重复多次。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-12-14T14:49:17.287

我已经编程了 28 年，我发现这是一个很难回答的问题。对我来说，好的代码是一个完整的包。代码写得很干净，带有有意义的变量和方法名称。它有很好的注释来注释代码的意图，而不仅仅是反刍您已经阅读的代码。该代码以一种有效的方式完成了它应该做的事情，而不会浪费资源。它的编写还必须着眼于可维护性。

但最重要的是，它对不同的人意味着不同的事情。我可能将其标记为别人可能讨厌的好代码。好的代码将具有一些我认为我在上面已经确定的共同特征。

你能做的最好的事情就是让自己接触代码。看看别人的代码。开源项目是一个很好的来源。你会发现好的代码和坏的代码。你看的越多，你就越能识别出你认为是好的代码和坏的代码。

最终，您将成为自己的法官。当你找到你喜欢的风格和技术时，随着时间的推移，你会想出自己的风格，并且会随着时间的推移而改变。这里没有人可以挥动魔杖说什么是好的，什么是坏的。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-12-14T15:07:57.640

阅读《代码完成》一书。这解释了很多关于如何构建代码的想法以及这样做的原因。阅读它应该会缩短您获得分辨好坏所需的经验的时间。

[http://www.amazon.com/Code-Complete-Practical-Handbook-Construction/dp/0735619670/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1229267173&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0735619670)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-12-15T00:52:36.760

我自己已经编程了近 10 年，并且与其他人一起工作过，我可以毫无偏见地说，**优秀的程序员和普通程序员的代码没有区别**

所有合格的程序员：

*   正确评论
*   高效结构
*   文件干净

我曾经无意中听到一位同事说“*我一直非常有逻辑和理性。我认为这就是我喜欢开发的原因*”

在我看来，这是一个普通程序员的想法。从规则和逻辑的角度看待世界并最终在设计和编写程序时遵守这些规则的人。

专家程序员了解规则，也了解它们的上下文。这最终导致他们提出新的想法和实现，这是专家程序员的标志。**编程最终是一种艺术形式。**

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-12-14T16:57:17.233

简而言之，**一个好的程序员的代码是可以阅读和理解的。**

在我看来，一个**好的程序员的代码是与语言无关的**；无论使用何种编程语言，编写良好的代码都可以在短时间内以最少的思考被阅读和理解。无论代码是用 Java、Python、C++ 还是 Haskell 编写的，编写良好的代码对于那些甚至不使用该特定语言进行编程的人来说都是可以理解的。

易于阅读的代码的一些特征是，命名良好的方法，没有“技巧”和复杂的“优化”，类设计良好，仅举几例。正如其他人所提到的，**编码风格是一致的、简洁的和直接的**。

例如，前几天，我正在查看[TinyMCE](http://tinymce.moxiecode.com/)的代码，以回答 Stack Overflow 上的一个问题。它是用 JavaScript 编写的，这是一种我几乎没有使用过的语言。然而，由于编码风格和包含的注释，以及代码本身的结构，它是相当容易理解的，我能够在几分钟内浏览代码。

在阅读优秀程序员的代码方面，一本让我**大开眼界的书是**[**Beautiful Code**](http://oreilly.com/catalog/9780596510046/)。它有许多由各种编程项目的作者用各种编程语言撰写的文章。然而，当我阅读它时，我可以理解作者在他的代码中写了什么，尽管事实上我从来没有用那种特定的语言编程过。

或许我们应该记住的是，**编程也是一种沟通，不仅是对计算机，对人**也是如此，所以好的程序员的代码就像一本写得很好的书，可以向读者传达它想要传达的思想.

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-12-14T19:12:59.363

*   易于阅读
*   容易写
*   易于维护

其他一切都是花丝

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-12-14T14:39:36.607

好的代码应该易于理解。
应该好好评论。
困难的部分应该得到更好的评论。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-12-14T14:40:56.417

好的代码是可读的。在第一次通读由优秀的专业程序员编写的代码时，您将毫不费力地理解代码在做什么。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-12-14T18:06:11.743

与其重复其他人的好建议，我建议您阅读史蒂夫·麦康奈尔（Steve McConnell）的《[代码完成》一书](https://rads.stackoverflow.com/amzn/click/com/0735619670)

从本质上讲，它是一本充满功能和风格的编程最佳实践的书。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-12-14T14:53:55.860

【纯主观回答】
对我来说，好的代码是一种艺术形式，就像一幅画。我可能会更进一步说，它实际上是一幅包含字符、颜色、代码“形式”或“结构”的绘图，并且所有这些都非常可读/高性能。可读性、结构（即列、缩进，甚至相同长度的变量名！）、颜色（类名、变量名、注释等）的组合都使我喜欢看到的“美丽”图片可以让我对自己的代码感到非常自豪或非常厌恶。

（如前所述，非常主观的答案。对不起我的英语。）

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-12-14T15:47:00.930

我赞同 Bob Martin 的“清洁代码”的建议。

几年前，《美丽密码》获得了高度评价。

麦康奈尔的任何一本书都值得一读。

也许“实用程序员”也会有所帮助。

%

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-12-14T18:28:43.227

只是想在您的代码中添加我的 2 美分... 注释 - 以及您的代码本身，通常 - 应该说明您的代码做什么，现在它是如何做的。一旦你有了“客户端”代码的概念，即调用其他代码的代码（最简单的例子是调用方法的代码），你应该总是最担心从“客户端”的角度理解你的代码。随着代码的增长，您会发现这是……嗯，很好。

很多关于好代码的其他内容是关于你将做出的精神飞跃（当然，如果你注意的话）......其中 99% 与现在做更多的工作有关，以节省大量以后工作​​，以及可重用性。还有做正确的事情：我几乎总是想以另一种方式运行而不是使用正则表达式，但每次我进入它们时，我都会明白为什么**每个人**都在我工作的每一种语言中都使用它们（它们很深奥，但是工作，可能再好不过了）。

至于要不要看书，根据我的经验我**肯定不会**。查看 API 和框架、代码约定和其他人的代码，并运用自己的直觉，尝试理解事物为何如此，以及事物的含义是什么。书中的代码几乎从不做的事情是为计划外的事情做计划，这就是错误检查的全部内容。只有当有人向您发送电子邮件并说“我收到错误 321”而不是“嘿，应用程序坏了，哟”时，这才有回报。

***从程序员的角度和用户的角度来看，编写好的代码都是着眼于未来的。***

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-12-14T21:02:53.197

这在 Fowler 的《重构》一书中得到了很好的回答，他在整本书中描述的所有“气味”都没有。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-12-14T21:05:49.570

我还没有看过“专业 ASP.NET”，但如果它比 OK 更好，我会感到惊讶。请参阅[此问题](https://stackoverflow.com/questions/282470/which-books-have-really-interesting-source-code-and-explain-it-well)以获取一些具有非常好的代码的书籍。（当然，它会有所不同，但公认的答案很难被击败。）

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-12-14T21:50:34.987

这似乎是（应该是）一个常见问题解答。最近有[一篇](http://acmqueue.com/modules.php?name=Content&pa=showpage&pid=559)关于漂亮代码的 ACM 文章。似乎有很多强调易于阅读/理解。我会用“领域专家易于阅读/理解”来限定它。真正优秀的程序员倾向于对任何给定的问题使用最好的算法（而不是简单易懂的 O(n^2) 算法），如果你不熟悉算法，即使好的算法也很难理解。程序员给出了算法的参考。

没有人是完美的，包括优秀的程序员，但他们的代码倾向于*争取*：

1.  经过验证的算法的正确性和效率（而不是幼稚和临时黑客）
2.  清晰度（参考非平凡算法的意图评论）
3.  涵盖基础知识（编码约定、版本控制、文档、单元测试等）的完整性
4.  简洁性（干）
5.  稳健性（对任意输入和变更请求中断具有弹性）

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-12-14T22:49:13.217

我支持鲍勃叔叔的“干净代码”的建议。但您可能希望查看[http://www.amazon.com/Implementation-Patterns-Addison-Wesley-Signature-Kent/dp/0321413091](https://rads.stackoverflow.com/amzn/click/com/0321413091)，因为我认为这可以更好地解决您的具体问题。好的代码应该跳出页面并告诉你它做什么/它是如何工作的。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-12-14T23:27:03.483

Jeff Atwood 写了一篇关于编码员如何成为打字员第一参考的好文章：http: [//www.codinghorror.com/blog/archives/001188.html](http://www.codinghorror.com/blog/archives/001188.html)

作为一名打字员，您总是需要在工作中保持优雅，具有结构和适当的“语法”非常重要。现在将其转换为“编程”类型将获得相同的结果。

**结构**

**评论**

**地区**

我是一名软件工程师，这意味着在我的教育过程中我遇到了许多不同的语言，但我的编程总是“感觉”相同，就像我在 fekberg.wordpress.com 上的写作一样，我有一种“特殊”的打字方式。

现在用不同的语言编写不同的应用程序，例如 Java、C#、Assembler、C++、C，我已经达到了我喜欢的写作“标准”。

我将所有内容都视为“框”或区域，每个区域都有解释性评论。一个区域可能是“类人”，在这个区域内我有几个属性方法，我可以称之为“访问方法”等，每个属性和区域都有自己的解释性评论。

**这是非常重要的，当创建 API 结构和优雅非常**重要时，我总是将我所做的代码视为“作为 api 的一部分” 。

想想这个。另请阅读我的论文，`Communication issues when adapting outsourcing`其中粗略地解释了糟糕的代码如何冲突，随心所欲地输入：http: [//fekberg.wordpress.com/2008/12/14/communication-issues-when-adapting-outsourcing/](http://fekberg.wordpress.com/2008/12/14/communication-issues-when-adapting-outsourcing/)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-12-14T14:42:24.977

好的代码易于理解、易于维护和易于添加。理想情况下，在不牺牲其他指标的情况下，它也尽可能高效。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-12-14T14:42:55.990

对我来说，伟大的代码是易于掌握但复杂的东西。让你去的东西，“哇，当然，我为什么不这么想呢？”。真正好的代码并不难理解，它只是以直接的方式（或递归方式，如果更简单的话）解决了手头的问题。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-12-14T14:49:24.573

好的代码是您从名称中知道该方法的作用的地方。糟糕的代码是你必须弄清楚代码的作用，才能理解名称的地方。

好的代码是如果你阅读它，你可以在不超过阅读它的时间里理解它在做什么。糟糕的代码是您最终查看它的地方，试图解决它确实如此。

好的代码的命名方式使得琐碎的注释变得不必要。

好的代码往往很短。

好的代码可以在其他任何地方重复使用，因为它不依赖于与其目的真正无关的东西。

好的代码通常是一组用于完成简单工作的简单工具（以组织良好的方式组合在一起以完成更复杂的工作）。糟糕的代码往往是易于破解且难以使用的大型多功能工具。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-12-14T15:19:53.483

代码是程序员技能和思维方式的反映。优秀的程序员总是着眼于未来——当需求或环境与今天不完全一样时，代码将如何运行。它将有多大的可扩展性？当我不是维护此代码的人时，它会有多方便？代码的可重用性如何，以便做类似事情的其他人可以重用代码而无需再次编写。当其他人试图理解我编写的代码时怎么办。

当程序员有这种心态时，所有其他东西都会很好地到位。

注意：随着时间的推移，许多程序员都在开发代码库，并且通常没有特定的代码库指定给程序员。因此，良好的代码是公司所有标准和员工素质的反映。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-12-14T15:32:44.097

（我在下面使用“他”，因为这是我*渴望*成为的人，有时会成功）。

我相信一个好的程序员哲学的核心是他总是在想“我在将来为自己编码时，我会忘记所有关于这个任务，我为什么要工作，有什么风险，甚至是如何做到的代码应该可以工作。”

因此，他的代码必须：

1.  工作（代码得到错误答案的速度有多快并不重要。现实世界中没有部分功劳）。
2.  解释他是如何知道这段代码有效的。这是文档（javadoc 是我选择的工具）、异常处理和测试代码的组合。在一个非常真实的意义上，我相信，逐行测试代码比功能代码更有价值，如果没有其他原因只是它解释了“这个代码有效，这就是它应该被使用的方式，这就是为什么我应该得到有薪酬的。”
3.  得到维护。死代码是一场噩梦。遗留代码维护是一件苦差事，但必须完成（记住，它离开你办公桌的那一刻就是“遗留”）。

另一方面，我认为优秀的程序员永远不应该做这些事情：

1.  痴迷于格式化。有很多 IDE、编辑器和漂亮的打印机可以将代码格式化为您认为合适的标准或个人偏好。我使用 Netbeans，我设置了一次格式选项，然后不时按 alt-shift-F。确定您希望代码的外观，设置您的环境并让工具完成繁重的工作。
2.  以牺牲人类交流为代价沉迷于命名约定。如果命名约定导致您将类命名为“IElephantProviderSupportAbstractManagerSupport”而不是“Zookeeper”，请在让下一个人更难之前更改标准。
3.  忘记他与真正的人类一起工作。
4.  忘记编码错误的主要来源是现在坐在他的键盘上。如果有错误或错误，他应该先看自己。
5.  忘记周围发生的事情。他现在所做的任何让未来的读者更容易访问他的代码的工作几乎肯定会直接使他受益（因为谁将是第一个被要求查看他的代码的人？他是）。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-12-14T17:19:07.033

如果您编写 C++ 代码，有一本非常好的书，其中包含优秀的编码标准，我们在 uni 参考了这本书：Herb Sutter、Andrei Alexandrescu 和 Bjarne Stroustrup 所著的《**C++ 编码标准：101 条规则、指南和最佳实践**》。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-12-14T18:12:28.063

1.  有用
2.  它有单元测试证明它有效

剩下的就是结冰了……

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-12-14T20:45:17.867

*   最好的代码有一定的优雅，你一看到它就认出来。
*   它看起来精心制作，注重细节。它显然是由有技巧的人制作的，并且有艺术——你可以说它看起来经过雕刻和抛光，而不是粗糙和准备好了。
*   它是一致的并且易于阅读。
*   它被分成小的、高度内聚的功能，每个功能都做一件事并且做得很好。
*   它是最小耦合的，这意味着依赖项很少并且受到严格控制，通常由...
*   函数和类依赖于*抽象*而不是实现。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-12-14T22:00:45.093

具有讽刺意味的是**，程序员越好，**他/她变得越**不不可或缺**，因为生成的代码更容易被任何人维护（正如 Eran Galperin 普遍同意的那样）。

我的经验告诉相反的情况也是如此。**程序员越差，**他/她的代码就越难维护，因此他**/她变得****更加不可或缺**，因为没有其他灵魂可以理解所产生的谜语。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-12-15T20:08:54.833

我有一个很好的例子：

阅读 GWT (google web takeit) 源代码，你会发现每个傻瓜都懂（有些英文书比这段代码更难读）。

# jquery - Jeditable - 通过单击 Y 激活 X 的编辑

> ID：366595
> 
> 赞同：15
> 
> 时间：2008-12-14T14:41:06.430
> 
> 标签：jquery, jeditable

我正在尝试使用[Jeditable](http://www.appelsiini.net/projects/jeditable)作为内联编辑解决方案。

默认行为（单击元素进行编辑）效果很好，但我想通过单击另一个元素来激活一个元素。

例如点击 a.activateEdit 将激活下一个 div.edit（显然应该使用 jQuery 选择器来完成）。

我为此查看了 Jeditable 文档，但找不到正确的语法

仅供参考，默认的 Jeditable 语法类似于：

```
 $(document).ready(function() {
     $('.edit').editable('http://www.example.com/save.php');
 }); 
```

***编辑：找到[更好的解决方案](http://groups.google.com/group/jquery-en/browse_thread/thread/33c18dcf32276c89/7711363c7496fcb3?hide_quotes=no)***

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-07-10T10:58:18.613

上面的代码也不是很正确。它在所有 Jeditable 实例上触发点击事件。

有很多方法可以做到这一点，这完全取决于您的 HTML，但例如，如果您有以下 HTML：

```
<div class="edit" id="unique_id">Editable text</div> 
<a href="#" class="edit_trigger">Edit me!!</a> 
```

然后您可以使用以下 JavaScript：

```
/* Bind Jeditable instances to "edit" event. */
$(".edit").editable("http://www.example.com/save.php", {
    event     : "edit"
});
/* Find and trigger "edit" event on correct Jeditable instance. */
$(".edit_trigger").bind("click", function() {
    $(this).prev().trigger("edit");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T16:40:15.893

您可以将此代码放在另一个元素的单击功能中。例子：

HTML：

```
<a class="clickme">Click me to edit</a>
<div class="edit">Edit Me!</div> 
```

jQuery：

```
$(document).ready(function() {
$("a.clickme").click(function(){
     $('.edit').editable('http://www.example.com/save.php');
});
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-14T22:08:27.433

好的，[Ata 的回答](https://stackoverflow.com/questions/366595/jeditable-activate-edit-of-x-by-clicking-on-y#366704)不太奏效，但它确实让我走上了正确的道路：

```
$(document).ready(function() {
    $('.edit').editable('http://www.example.com/save.php');
    $("a.clickme").click(function(){
          $('.edit').click();
   });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-06T06:59:57.597

我结合了前两个响应的力量来定位下一个可编辑元素，如下所示：

`/* Find and trigger "edit" event on next Jeditable instance. */ $(".edit_trigger").livequery( 'click', function() { $(this).next().click(); });`

# javascript - 如何说服 Firefox 重绘 CSS 伪元素？

> ID：366601
> 
> 赞同：3
> 
> 时间：2008-12-14T14:45:52.973
> 
> 标签：javascript, html, css, firefox

当动态更改其类时，我在让 Firefox 更新网页时遇到问题。

我正在使用 HTML`table`元素。当用户单击表头中的单元格时，我的脚本会在 和 之间来回切换`sorted_asc`类`sorted_des`。我有一个伪元素，它根据单元格当前是哪个类添加一个箭头字形（向上或向下）。

```
.thead .tr .sorted_asc .cell:after {
    content: ' \25B2';
} 
```

问题是，当您再次单击单元格标题时，页面不会更新箭头......直到用户将鼠标移离元素。我认为这是一个错误，因为它在 Safari 中运行良好，而且我`:hover`在我的 CSS 或其他条目中看不到任何可能干扰的标签。

任何人以前见过这个，或者知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T15:27:17.633

这有点俗气，但是由于您无论如何都在使用javascript，请在​​更改类名后尝试以下操作：

```
document.body.style.display = 'none';
document.body.style.display = 'block'; 
```

这将重新渲染布局并经常解决这类错误。不过，并非总是如此。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-28T12:40:06.277

这是 2014 年，此页面上提出的解决方案似乎都不起作用。我找到了另一种方法：从 DOM 中分离元素并将其附加回原来的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T20:40:04.273

你能不依赖 :after 伪选择器而使用不同的 CSS 来完成同样的事情吗？您也许可以简单地定义一个您根据需要对齐的背景图像（我假设您想要右侧的箭头）。

例如：

```
.thead .tr .sorted_asc .sorted_asc {
  background: url(images/down_arrow.png) no-repeat right;
}

.thead .tr .sorted_asc .sorted_des {
  background: url(images/up_arrow.png) no-repeat right;
} 
```

我只建议这样做，因为我认为没有特定原因需要使用 :after 伪类。如果您确实需要使用它，请更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-07T15:01:22.110

The bug can still be triggered in Firefox 58\. Thankfully the opacity trick also still works. Just make sure to time it correctly. You might need to set a timeout between opacity changes.

# c++ - 如何将虚拟内存地址转换为物理地址？

> ID：366602
> 
> 赞同：21
> 
> 时间：2008-12-14T14:46:42.473
> 
> 标签：c++, windows, memory, virtual-address-space

在我的 C++ 程序（在 Windows 上）中，我分配了一块内存，并且可以确保它在物理内存中保持锁定（未交换且连续）（即使用 VirtualAllocEx()、MapUserPhysicalPages() 等）。

在我的进程上下文中，我可以获得该块的虚拟内存地址， **但我需要找出它的物理内存地址**才能将其传递给某个外部设备。

**1.**有什么方法可以在我的程序中以用户模式将虚拟地址转换为物理地址？

**2.**如果没有，我只能在 KERNEL 模式下找到这个虚拟到物理的映射。我想这意味着我必须编写一个驱动程序来做到这一点......？您是否知道我可以使用的任何现成的驱动程序/DLL/API，我的应用程序（程序）将与之交互以进行翻译？

**3.**如果我必须自己编写驱动程序，我该如何翻译？我使用哪些功能？是**mmGetPhysicalAddress()**吗？我该如何使用它？

**4.**另外，如果我理解正确， mmGetPhysicalAddress() 返回调用进程上下文中的虚拟基地址的物理地址。但是，如果调用进程是驱动程序，并且我正在使用我的应用程序来调用该功能的驱动程序，那么我正在更改上下文并且在调用 mmGetPhysicalAddress 例程时我不再处于应用程序的上下文中......所以如何转换应用程序（用户模式）内存空间中的虚拟地址，而不是驱动程序？

任何答案、提示和代码摘录将不胜感激！！

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-14T19:11:08.913

*在我的 C++ 程序（在 Windows 上）中，我分配了一块内存，并且可以确保它在物理内存中保持锁定（未交换且连续）（即使用 VirtualAllocEx()、MapUserPhysicalPages() 等）。*

不，您不能真正确保它保持锁定状态。如果您的进程崩溃或提前退出怎么办？如果用户杀死它怎么办？该内存将用于其他用途，如果您的设备仍在执行 DMA，最终将导致数据丢失/损坏或错误检查 (BSOD)。

此外，`MapUserPhysicalPages`它是 Windows AWE（地址窗口扩展）的一部分，用于在 32 位版本的 Windows Server 上处理超过 4 GB 的 RAM。我不认为它是用来破解用户模式 ​​DMA 的。

*1.有什么方法可以在我的程序中以用户模式将虚拟地址转换为物理地址？*

有一些驱动程序可以让您执行此操作，但您无法在 Windows 上从用户模式对 DMA 进行编程，并且仍然拥有稳定且安全的系统。让作为受限用户帐户运行的进程读/写物理内存允许该进程拥有系统。如果这是一次性系统或原型，这可能是可以接受的，但如果您希望其他人（尤其是付费客户）使用您的软件和设备，您应该编写一个驱动程序。

*2\. 如果没有，我只能在 KERNEL 模式下找到这个虚拟到物理的映射。我想这意味着我必须编写一个驱动程序来做到这一点......？*

这是解决此问题的推荐方法。

*您是否知道我可以使用的任何现成的驱动程序/DLL/API，我的应用程序（程序）将与之交互以进行翻译？*

您可以使用[MDL（内存描述符列表）](http://msdn.microsoft.com/en-us/library/aa489506.aspx)锁定任意内存，包括用户模式进程拥有的内存缓冲区，并将其虚拟地址转换为物理地址。`DeviceIoControl`您还可以让 Windows 为使用[`METHOD_IN_DIRECT`](http://msdn.microsoft.com/en-us/library/ms795857.aspx)或传递给调用的缓冲区临时创建一个 MDL [`METHOD_OUT_DIRECT`](http://msdn.microsoft.com/en-us/library/ms795857.aspx)。

请注意，虚拟地址空间中的连续页面在物理地址空间中几乎从不连续。希望您的设备能够处理这个问题。

*3\. 如果我必须自己编写驱动程序，我该如何翻译？我使用哪些功能？是 mmGetPhysicalAddress() 吗？我该如何使用它？*

编写驱动程序不仅仅是调用一些 API。[如果您要编写驱动程序，我建议您从MSDN](http://msdn.microsoft.com/en-us/library/aa973498.aspx)和[OSR](http://www.osronline.com/)阅读尽可能多的相关材料。[另外，请查看Windows Driver Kit](http://www.microsoft.com/whdc/devtools/wdk/default.mspx)中的示例。

*4\. 另外，如果我理解正确，mmGetPhysicalAddress() 返回调用进程上下文中的虚拟基地址的物理地址。但是，如果调用进程是驱动程序，并且我正在使用我的应用程序来调用该函数的驱动程序，那么我正在更改上下文并且在调用 mmGetPhysicalAddress 例程时我不再处于应用程序的上下文中......所以如何转换应用程序（用户模式）内存空间中的虚拟地址，而不是驱动程序？*

驱动程序不是进程。驱动程序可以在任何进程的上下文以及各种提升的上下文（中断处理程序和 DPC）中运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-18T22:32:21.133

您不能从用户空间访问页表，它们是在内核中映射的。

如果你在内核中，你可以简单地检查 CR3 的值来定位基页表地址，然后开始你的解析。

[这个博客系列](http://blogs.msdn.com/b/ntdebugging/archive/2010/02/05/understanding-pte-part-1-let-s-get-physical.aspx)很好地解释了如何做到这一点。您不需要任何操作系统工具/API 来解析虚拟<->物理地址。

> 虚拟地址：f9a10054
> 
> ```
> 1: kd> .formats 0xf9a10054
> Binary:  11111001 10100001 00000000 01010100
> 
> Page Directory Pointer Index(PDPI)       11                        Index into 
> ```
> 
> 1st table(Page Directory Pointer Table) Page Directory Index(PDI)
> 111001 101 Index into 2nd table(Page Directory Table) Page Table Index(PTI)
> 00001 0000 Index into 3rd table(Page Table) Byte Index
> 0000 01010100 0x054, 偏移量物理内存页

在他的示例中，他们使用 windbg，!dq 是物理内存读取。

![在此处输入图像描述](https://i.stack.imgur.com/Xh54V.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-14T16:56:06.033

1) 没有

2）是的，你必须写一个驱动程序。最好是虚拟驱动程序，或更改特殊外部设备的驱动程序。

3）这在这里变得非常混乱。`MmGetPhysicalAddress`应该是您正在寻找的方法，但我真的不知道物理地址如何映射到银行/芯片/等。在物理内存上。

4）您不能使用分页内存，因为它会被重新定位。您可以在 MDL 上锁定分页内存，`MmProbeAndLockPages`您可以在从用户模式调用上下文传入的内存上构建。但最好分配非分页内存并将其交给您的用户模式应用程序。

```
PVOID p = ExAllocatePoolWithTag( NonPagedPool, POOL_TAG );
PHYSICAL_ADDRESS realAddr = MmGetPhysicalAddress( p );

// use realAddr 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-11T00:09:59.333

您的应用程序中有一个几乎连续的缓冲区。正如您所指出的，该虚拟内存范围仅在您的应用程序的上下文中可用，其中一些可能随时被调出。因此，为了从设备访问内存（也就是说，进行 DMA），您需要将其锁定并获取可以传递给设备的描述。

您可以通过使用 METHOD_IN_DIRECT 或 METHOD_OUT_DIRECT 向驱动程序发送 IOCTL（通过 DeviceControl 函数）来获取称为 MDL 或内存描述符列表的缓冲区的描述。有关定义 IOCTL 的讨论，请参见下一页。

[http://msdn.microsoft.com/en-us/library/ms795909.aspx](http://msdn.microsoft.com/en-us/library/ms795909.aspx)

现在您已经在设备的驱动程序中对缓冲区进行了描述，您可以将其锁定，以便缓冲区在您的设备可能对其进行操作的整个期间都保留在内存中。在 MSDN 上查找 MmProbeAndLockPages。

您的设备可能无法读取或写入缓冲区中的所有内存。该设备可能仅支持 32 位 DMA，并且机器可能有超过 4GB 的 RAM。或者您可能正在处理具有 IOMMU、GART 或其他一些地址转换技术的机器。为了适应这一点，请使用各种 DMA API 来获取一组适合您的设备使用的逻辑地址。在许多情况下，这些逻辑地址将等同于您的问题最初询问的物理地址，但并非总是如此。

您使用哪种 DMA API 取决于您的设备是否可以处理分散/收集列表等。您的驱动程序在其设置代码中将调用 IoGetDmaAdapter 并使用它返回的一些函数。

通常，您会对 GetScatterGatherList 和 PutScatterGatherList 感兴趣。您提供一个函数（ExecutionRoutine），它实际上对您的硬件进行编程以进行传输。

涉及很多细节。祝你好运。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-14T19:28:18.410

你**真的**不应该在用户模式下做这样的事情；正如克里斯托弗所说，您需要锁定页面，以便 mm 在设备使用它时不会决定调出您的后备内存，这最终会破坏随机内存页面。

> 但是，如果调用进程是驱动程序，并且我正在使用我的应用程序来调用该函数的驱动程序，那么我正在更改上下文并且在调用 mmGetPhysicalAddress 例程时我不再处于应用程序的上下文中

驱动程序没有用户模式应用程序那样的上下文；如果您通过 IOCTL 或其他方式调用驱动程序，您通常（但不能保证！）处于调用用户线程的上下文中。但实际上，这与您的要求无关，因为无论您身在何处，内核模式内存（0x80000000 以上的任何内容）都是相同的映射，并且您最终会在内核端分配内存。但同样，**编写一个适当的驱动程序**。使用 WDF ( [http://www.microsoft.com/whdc/driver/wdf/default.mspx](http://www.microsoft.com/whdc/driver/wdf/default.mspx) )，它将使编写正确的驱动程序变得更加容易（虽然仍然很棘手，但 Windows 驱动程序的编写并不容易）

编辑：只是想我会扔掉一些参考书来帮助你，你绝对应该（即使你不追求编写驱动程序）阅读 Russinovich 和 Solomon 的 Windows Internals（[http://www.amazon.com /Microsoft-Windows-Internals-4th-Server/dp/0735619174/ref=pd_bbs_sr_2?ie=UTF8&s=books&qid=1229284688&sr=8-2](https://rads.stackoverflow.com/amzn/click/com/0735619174) ); 对 Microsoft Windows 驱动程序模型进行编程也很好（[http://www.amazon.com/Programming-Microsoft-Windows-Driver-Second/dp/0735618038/ref=sr_1_1?ie=UTF8&s=books&qid=1229284726&sr=1-1](https://rads.stackoverflow.com/amzn/click/com/0735618038)）

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-12-14T20:28:38.383

等等，还有更多。为了在您客户的 Vista 64 位上运行的特权，您将花费更多的时间和金钱来让您的内核模式驱动程序退出我的微软，

# sql - 仅在 Datetime 列上按日期分组

> ID：366603
> 
> 赞同：209
> 
> 时间：2008-12-14T14:47:19.303
> 
> 标签：sql, mysql

有一个包含如下列的表：`mydate DATETIME`...

我有一个查询，例如：

```
SELECT SUM(foo), mydate FROM a_table GROUP BY a_table.mydate; 
```

这将按完整分组`datetime`，包括小时和分钟。我希望按日期`YYYY/MM/DD`而不是按日期进行分组`YYYY/MM/DD/HH/mm`。

这该怎么做？

* * *

## 回答 #1

> 赞同：330
> 
> 时间：2008-12-14T14:50:57.957

将日期时间转换为日期，然后使用以下语法进行 GROUP BY：

```
SELECT SUM(foo), DATE(mydate) FROM a_table GROUP BY DATE(a_table.mydate); 
```

或者您可以按照@orlandu63 的建议对别名进行分组：

```
SELECT SUM(foo), DATE(mydate) DateOnly FROM a_table GROUP BY DateOnly; 
```

虽然我认为它不会对性能产生任何影响，但它更清晰一些。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-03-28T11:57:51.000

我发现我需要按月和年分组，所以上述方法都不适合我。相反，我使用 date_format

```
SELECT date
FROM blog 
GROUP BY DATE_FORMAT(date, "%m-%y")
ORDER BY YEAR(date) DESC, MONTH(date) DESC 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-12-14T15:25:02.503

或者：

```
SELECT SUM(foo), DATE(mydate) mydate FROM a_table GROUP BY mydate; 
```

更有效（我认为。）因为您不必每行两次施放 mydate 。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-07-30T14:49:11.583

```
SELECT SUM(No), HOUR(dateofissue) 
FROM tablename 
WHERE dateofissue>='2011-07-30' 
GROUP BY HOUR(dateofissue) 
```

它将从特定的一天开始按小时计算！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-26T21:34:28.423

这对我有用

```
select 
  CONVERT(date, CONVERT(VARCHAR(10),sd.Date,112)) as Date, 
  sd.CodId as CodId,
  p.Description ,
  sum(sd.Quantity)as Quantity,
  sum(sd.TotalQuantityXPriceWithIva) as TotalWithIva 
from 
  SaleDetails sd 
  join Sales s on sd.SaleId = s.SaleId 
  join Products p on sd.ProductId = p.ProductId 
Where 
  (
    sd.Date >=' 1/1/2021 00:00:00' 
    and sd.Date <= '26/10/2021 23:59:59' 
    and p.BarCode = '7790628000034'
    and ((s.VoucherTypeId >= 16 and s.VoucherTypeId <= 18) 
      or s.VoucherTypeId = 32  )) 
group by 
  CONVERT(VARCHAR(10),sd.Date,112), 
  sd.CodId , 
  p.Description 
order by CONVERT(VARCHAR(10),sd.Date,112) desc 
```

# amazon-ec2 - 关于 RightScale 和 Scalr 用于动态 Ec2 实例管理的任何想法

> ID：366612
> 
> 赞同：15
> 
> 时间：2008-12-14T14:51:34.727
> 
> 标签：amazon-ec2, scalability, haproxy, rightscale, scalr

我正在寻找一种成本效益高的工具来管理 Ec2 上的 Web 应用程序。Rightscale 在大狗看来并为此收费。Scalr 看起来是一种更具成本效益的解决方案，但很难找到任何真实的客户体验。

我正在寻找的关键方面是负载均衡器（http 和 https）以及一种在负载增加时自动使额外的 Web 服务器容量在线以及在负载下降时终止实例的方法。

据我所知，很多人都在这里推出自己的东西。我们正在尝试发布一个应用程序，并且真的不想打太多繁重的系统管理员之战。鉴于性能等的重要性，我很高兴能听到来自该领域的建议和经验。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-24T02:12:02.470

我是 Scalr 用户，Scalr.net 订阅者，并且已经成为 Scalr 爱好者。我买不起 Rightscale。

Scalr 可以满足您的要求。

Scalr 有三个图像（每个都有 32/64 位版本），加上一个基本（通用）图像：

1) 一个负载均衡器镜像，运行 nginx。高可用性设置需要其中两个。Scalr 将管理您的名称服务，并在它们之间进行循环。如果一个实例出现故障，Scalr 会将其从 DNS 中删除并启动另一个实例。可以运行其他负载均衡器，但默认使用 nginx。

2) 有几个应用服务器镜像可用，运行 Apache/Tomcat/Rails。你在这里设置你的应用程序，无论是 PHP/Perl/Python/Java/Ruby/whatever。nginx 在这些实例之间路由请求，这些实例按唯一用户分组（基于 IP + 浏览器）。Scalr 也监视这些状态，并替换损坏的实例。

3) MySQL 数据库映像，具有自动主/从复制功能。只需部署您的架构，Scalar 就会处理复制并替换已失效的服务器。它还会定期备份您的数据。Scalar 的 DNS 提供主从主机名，因此您可以让您的应用程序从从属读取并写入主控。

所有这些实例类型都将根据负载自动扩展。您从最接近您正在做的事情的基本映像开始，然后为您的应用程序自定义它们。例如，我们在 apache 服务器实例上部署 Perl/Catalyst 应用程序，但我们从 nginx 前端服务器提供静态内容。我们不得不稍微修改我们的应用程序以使用读/写数据库句柄。

总而言之，我们花了大约三周的时间来解决 Scalr 中的错误，以使我们的应用程序达到可靠状态，我相信它在 Scalr 上是高度可用的。他们的支持非常出色，所以这些错误并没有给我带来太多困扰，而且这个系统真的出现了。它正在接近严重的可靠性。

附带说明一下，Scalr 的最佳功能是“同步到所有”功能，它会自动捆绑您的 AMI 并将其重新部署到新实例上——所有这些都不会中断服务。这可以节省您完成冗长的 EC2 映像/AMI 创建过程的时间，否则非常简单的管理任务可能需要 20 分钟。无论您是否扩展服务器场，您都可以使用它 - 即使在单个实例上也非常方便。

我每月向 Scalr.net 支付 50 美元来为我托管该服务，因为我认为它可以节省我的时间和金钱。到目前为止的底线是这样的：在我的最后一次演出中，我们有一个系统人员在我们的高可用性 Linux DB + 应用服务器设置上工作了一年......他未能达到我在三周内达到的那种可靠性. 与滚动我自己的相比，使用 Scalr 所节省的成本是极端的。

话虽如此，如果我负担得起 Rightscale，我会使用 Rightscale。但预付费用和每月 500 美元的费用使这成为不可能。一直在谈论挥舞前期费用以换取挥舞其中包含的咨询，但每月的服务费不会去任何地方。

我应该提一下，目前 sclar.net 的网站已经关闭，所以如果我想管理我的任何服务器场（不要让它们在 atm 上运行），我现在根本做不到。目前尚不清楚缩放是否适用于 scalr.net 订阅者。也就是说……这可能还不是一个成熟的解决方案。这种情况并不经常发生，在今晚之前，我经历过的唯一停机时间是一次几分钟。但是，是的......它现在就下来了，所以我必须提到它:)

我建议在做出决定之前彻底阅读[http://groups.google.com/group/scalr-discuss上的支持小组。](http://groups.google.com/group/scalr-discuss)如果您选择 Scalr，请准备好测试您的设置并解决您在 google 组中遇到的任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T05:20:23.143

我将对您的问题发表评论，因为给出具体答案有点雄心勃勃。

首先，我看到您的标签上有 haproxy。这绝对是EC2 中**证明的最好的负载均衡软件。**AWS 论坛中有关于使用 haproxy 的文档和经验。

我无法就 scalr 发表意见，但 Rightscale 正朝着正确的方向发展。RightScale 路线图中最有趣的功能之一是，它们是适用于任何云的管理云系统，而不仅仅是 Amazon 的 EC2。这使得它们在尝试请求负载平衡和升级时非常有前途。

您还可以在 rightscale 上注册一个开发人员免费帐户，您可以测试他们的一些 AMI 和免费脚本，它们非常令人印象深刻。

好吧，这听起来像是我在那里工作或其他什么，但我只是一个云用户，与他们没有任何联系。如果你想到了。

我希望这会有所帮助，至少可以增加讨论。

地理

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-24T19:46:41.750

已经使用 Scalr 大约两个月了，并且已经慢慢地将几个生产应用程序转换到该平台，并取得了良好的效果。我强烈推荐他们快速周转/支持和价值。我希望看到他们提高平台的可用性。

总而言之，非常适合基于所呈现的简单用例的原始海报。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-24T08:11:51.403

每项服务都有糟糕的一天。AWS 服务可以看到停机时间。但是，仍有用户在 AWS 上运行他们的应用程序。

我在 Scalr.net 上有几个农场，并与 Rightscale 进行了比较。我不必付出一条胳膊和一条腿。

总的来说，服务非常可靠。现在有了脚本引擎，我可以设置自己的脚本来管理我的实例。

问候哈雷姆·哈克

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-26T17:22:01.570

两种服务（rightscale 和 scalr）都很棒。报价不一样，价格也不一样。但它们都是我想要的。关于我们的预算标量符合我的需要。一开始我发现通过一个google group的支持很奇怪，但它非常快速和高效。

他们的解决方案也是开源的（不错），他们的路线图中也有一个 V2 版本，并支持其他提供商。

拭目以待，但到目前为止，我对此感到非常满意

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-21T18:43:25.113

做出正确选择的决定可能并不像每个人预期的那么简单。我见过 Scalr 并听取了关于他们平台的谈话，也听过 RightScale 讨论他们的平台。如果您有一个简单的 SOA（应用服务器 - 数据库服务器 - 文件服务器），那么任何一种选择都适合您的公司。

最终，如果您创建了一些自定义中间件并且您依赖已知的套接字或特定的握手点，您将需要考虑负载平衡和自动缩放，而对于无法管理的问题则回退到您自己的解决方案使用这些服务中的任何一项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T11:27:21.627

[有人说自动缩放解决不了问题](http://broadcast.oreilly.com/2008/12/why-i-dont-like-cloud-auto-scaling.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-30T22:25:00.107

我现在正在研究 Scalr，虽然看起来一切都很好，但我决定继续使用我自己的脚本来实现云管理/扩展。我现在有 8 台服务器，只支付 AWS 费用。我使用 chef（自托管）、nagios 和许多其他工具。我的数据库是mysql和mongodb，负载均衡器是haproxy，应用层是rails。在我需要 100 台服务器之前，我想我会继续编写脚本';-)

# c# - 如何从我的 C# 应用程序发送电子邮件？

> ID：366629
> 
> 赞同：6
> 
> 时间：2008-12-14T15:03:08.477
> 
> 标签：c#, email, smtpclient, mailmessage

这是我写的代码：

```
 MailMessage mail = new MailMessage("test@gmail.com", "me@myurl.com");

        mail.Subject = "This is a test!!";
        mail.Body = "testing...";

        SmtpPermission connectAccess = new SmtpPermission(SmtpAccess.Connect);
        System.Console.WriteLine("Access?  " + connectAccess.Access);

        SmtpClient client = new SmtpClient("mail.myurl.com", 2525);
        client.Send(mail); 
```

它不工作。我在“client.Send(mail)”行出现异常，显示“邮箱不可用。服务器响应为 (MYLOCALCOMPUTERNAME) [MY LOCAL IP]:3045 当前不允许中继。”

connectAccess.Access 确实返回“连接”（我不确定这是否有必要......我添加它以开始故障排除过程。）

这是否意味着我的本地机器必须以某种方式进行配置？当我将我的应用程序部署到其他人的机器时呢？那里需要本地配置吗？我只是想从我的应用程序中创建一个“发送反馈”类型的链接。

（注意：在我的真实应用程序中，我在“收件人”和“发件人”中都使用了我的真实电子邮件地址，而我的 smtp 实际上是我在托管我的 url/网站的地方的 smtp 地址）

谢谢！

-阿迪娜

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-14T16:26:14.237

@迈克尔：感谢您的链接。这很有帮助。

我*想*我发现了我的问题。创建“客户端”对象后，我确实需要添加登录凭据。我添加了以下行：

```
 client.Credentials = new System.Net.NetworkCredential("myloginat+myurl.com", "mypassword"); 
```

（对不起 - 我有这个习惯，在我在网上搜索答案并通过我的手册 2 小时后，我终于分解并发布了问题，然后 5 分钟后弄清楚了。:) 我认为写作的行为这个问题对我的帮助比其他任何事情都多）

所以它正在工作......虽然我不会声称我了解它如何以及为什么工作的一切，所以我确实希望在我将我的程序提供给其他人使用时遇到一些问题。即，每个使用具有 Internet 连接的程序的人都能够打开到我的服务器的这个 smtp 连接吗？我不知道答案......我将不得不等待，看看，并了解更多。

谢谢！:)

-阿迪娜

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-14T15:12:11.453

目标地址是否与您的 smtp 服务器在同一主机上？如果不是，这将解释中继错误。

您使用的 SMTP 服务器必须是邮件消息的最终目的地或邮件交换中的第一跳。例如，如果您要从 gmail 地址向 yahoo 地址发送邮件，则第一个看到该邮件的邮件服务器必须是您的 gmail 服务器或 yahoo 服务器。中间的服务器将拒绝该消息，因为它们已禁用中继（以减少垃圾邮件等）。

如果它们是同一主机，您是否可以通过其他方式直接向其发送邮件？

通过 telnet 尝试此测试以查看您的 smtp 服务器是否正常运行：[http ://www.messagingtalk.org/content/470.html](http://www.messagingtalk.org/content/470.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T10:56:24.687

检查你的防火墙。2525的帖子开了吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T11:42:18.520

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Mail;

namespace SendMail
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            try
            {
                SmtpClient client = new SmtpClient("smtp.gmail.com", 25);
                MailMessage msg = new MailMessage();

                NetworkCredential cred = new NetworkCredential("x@gmail.com", "password");
                msg.From = new MailAddress("x@gmail.com");
                msg.To.Add("y@gmail.com");
                msg.Subject = "A subject";
                msg.Body = "Hello,Raffi";

                client.Credentials = cred;
                client.EnableSsl = true;
                label1.Text = "Mail Sended Succesfully";
                client.Send(msg);

            }
            catch
            {
                label1.Text = "Error";
            }
        }

    }
} 
```

# asp.net - ASP.NET FileUpload：选择文件后如何自动回发？

> ID：366631
> 
> 赞同：26
> 
> 时间：2008-12-14T15:05:23.997
> 
> 标签：asp.net

我正在开发一个 ASP.NET 应用程序，我需要在 FileUpload 控件中选择文件后回发到服务器，而无需让用户明确单击“提交”按钮。这可能吗？如果是这样，如何？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-14T15:23:36.487

我假设您想立即开始上传。如果是这样，您应该`change`在 JavaScript 中对事件做出反应，并简单地使其提交表单。

```
<!-- HTML code --->
<input 
  type="file" 
  onchange="if (confirm('Upload ' + this.value + '?')) this.form.submit();"
> 
```

建议要求用户确认，这样他们就可以控制整个过程，如果他们不小心选择了错误的文件，可以取消。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-14T23:13:10.110

第一个答案有正确的 javascript，但 ASP.NET 不一定直接公开输入控件，因此最好将 onchange 事件放在 FileUpload 控件上。

```
<asp:FileUpload ID="myFileUpload" onchange="if (confirm('Upload ' + this.value + '?')) this.form.submit();" runat="server" /> 
```

另一种方法是通过 flash/silverlight/ajax 提供丰富的上传。可以在[Ajax Uploader](http://www.ajaxuploader.com/)找到一个很棒的组件，价格约为 100 美元

# sharepoint - 将网站内容迁移到新 SharePoint 网站的最佳方式

> ID：366633
> 
> 赞同：4
> 
> 时间：2008-12-14T15:06:08.753
> 
> 标签：sharepoint, migration

我的团队正在开展一个将 .com 网站迁移到 SharePoint 的项目。

创建完所有外观资产、母版页、内容类型和页面布局后，我们需要将实际网站页面实际“移动”到 SharePoint 中。

我试图想出最有效的方法来做到这一点。我们的拓扑结构由创作环境和生产环境组成。我们计划使用 SharePoint 内容部署从创作填充生产。

但是，我们显然需要对创作环境进行某种初始填充。我不想使用内容部署从开发环境中填充创作，因为我不想最初从空白站点定义创建创作。

以下是我提出的选项，希望得到一些您认为是最佳方法的反馈：

*   在开发环境中创建站点内容并使用诸如 SPDeploy 之类的工具将其迁移到创作环境中

*   直接在创作环境中创建内容

*   使用类似于如何在功能中配置列表项实例的技术。我们将使用功能创建和填充我们所有的内容

    *   我不确定这是否真的可行，但因为我知道您可以在功能中配置列表时创建列表项实例而得到了这个想法。毕竟，我们的页面库是一个页面列表 - 但是涉及多种内容类型。

谢谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T22:17:36.370

如果只是迁移文件的问题，您实际上可以使用内容迁移框架。此框架的核心类是 Microsoft.SharePoint.Deployment 命名空间中的 SPExport 和 SPImport 类。您可以使用相当少的代码将单个文件导出到磁盘，然后再次将它们导入到新位置。或者，在此处尝试 CodePlex 上的 SharePoint 内容部署向导：http: [//www.codeplex.com/SPDeploymentWizard](http://www.codeplex.com/SPDeploymentWizard)。它将为您节省编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T08:06:29.427

备份和恢复内容数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T17:40:10.047

您能否澄清一下为什么您不想使用内容部署来创建您的初始创作站点？为什么您不想从空白站点定义开始？无论如何，它会在部署过程中被覆盖。stsadm -export / -import 怎么样？

对不起，我还不清楚整个情况。你有一个开发环境（大概是创建结构的地方，但不是任何用于生产的内容），一个创作环境（我理解为输入和批准内容的锁定环境），然后是一个只读生产环境部署了哪些已批准的项目。如果是这种情况，那么我可以说我的一个项目有类似的设置。

就我而言，我最初是在我的开发环境中开发站点结构，然后备份并恢复到创作和生产。对这两种环境的后续结构更改都是手动进行的。创作在结构上几乎与 prod 完全相同。只是安全性不同。每天从创作到生产多次部署内容。我们直接在创作环境中进行内容更改。

# sharepoint - 是否可以在不使用域的情况下在 DMZ 中创建多服务器 SharePoint 场？

> ID：366639
> 
> 赞同：1
> 
> 时间：2008-12-14T15:12:28.583
> 
> 标签：sharepoint, dns

我正在与客户合作，为面向公众的 SharePoint Internet 站点规划拓扑。

SharePoint 安装将位于客户端的 DMZ 中，并且计划使用现有的 SQL Server 计算机来托管 SharePoint 数据库。

问题是 DMZ 中没有域 - 并且客户不想在没有经过适当的规划过程的情况下创建一个域。

据我了解，如果不使用域帐户最初将 SharePoint 管理中心连接到 SQL，就无法配置多服务器 SharePoint 场。

我很确定（并且已经尝试过）在首次使用生产和技术向导配置管理中心时，您不能使用 SQL Server 身份验证将场连接到 SQL Server。

我的另一个选择是单服务器安装，我承认如果我们需要添加另一个 WFE，这会限制我们未来的增长。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T00:43:40.973

[不，主要是。](http://blogs.msdn.com/fooshen/archive/2007/02/01/installing-moss-without-ad.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-23T15:20:56.197

这是可能的，因为它在我工作的公司中以这种方式工作。

我们基本上在两台服务器（Web 前端服务器和 SQL 数据库服务器）上都有一个同名的用户帐户。此帐户有权访问数据库。

# javascript - JavaScript 中的设计模式有用吗？它们到底是什么？

> ID：366647
> 
> 赞同：8
> 
> 时间：2008-12-14T15:27:57.100
> 
> 标签：javascript, design-patterns

我一直在学习越来越多的 javascript；这是我工作的必需品。我们有一个使用大量 javascript 的 Web 应用程序，我每天都会做越来越多的事情。我已经阅读了有关设计模式的零碎文章，但想知道是否有人可以给我一个简单明了的示例和定义。它们是对我有益的东西吗？还是更高层次？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-14T15:41:51.533

设计模式是通用的，通常是对众所周知的编程问题的优雅解决方案。在不知道您正在解决什么问题的情况下，我会说“是”，它们可以帮助您的代码更易于管理。

[此链接](https://addyosmani.com/resources/essentialjsdesignpatterns/book/)和[此链接](https://www.oreilly.com/library/view/ajax-design-patterns/0596101805/ch03.html)对 Javascript 中的设计模式进行了一些参考。他们可能值得回顾。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-14T16:21:37.897

我遇到过的最实用和最容易使用的 JavaScript 特定设计模式之一是[Module Pattern](http://yuiblog.com/blog/2007/06/12/module-pattern/)，它是一种修改过的[Singleton 模式](http://en.wikipedia.org/wiki/Singleton_pattern)，可以“命名空间”相关代码并防止全局范围被可能冲突的变量和函数弄乱彼此在一个复杂的页面中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-14T15:46:23.040

还有一本关于javascript 中[经典设计模式的书。](http://jsdesignpatterns.com/)您可以从它的网站下载示例。

但根据我的经验，使用大量 javascript 实现项目显然更难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T18:29:09.637

由于设计模式与语言无关，我建议阅读有关该主题的经典书籍之一。我最喜欢的是：

*   Martin Fowler 的企业应用架构模式 ( [http://www.amazon.com/Enterprise-Application-Architecture-Addison-Wesley-Signature/dp/0321127420](https://rads.stackoverflow.com/amzn/click/com/0321127420) )
*   设计模式：“四人帮”（[http://www.amazon.com/Design-Patterns-Object-Oriented-Addison-Wesley-Professional/dp/0201633612/ref=sr_1_1?即=UTF8&s=books&qid=1229278937&sr=1-1](https://rads.stackoverflow.com/amzn/click/com/0201633612) )。这有点经典。

但是，这些绝不是初学者书籍，您可能会从那里的许多网络资源和教程中获得更多价值（维基百科有一些合理的解释）。

我自己的经验是，javascript 中的对象模型比 PHP 或 Ruby 等其他对象模型更难理解，因此，应用设计模式并不总是那么容易。Prototype 等库提供了使继承更易于使用的功能，这使得以 OO 方式编写 Javascript 变得更加容易。

我最近使用 Javascript 来使用 Prototype 实现[Active Record 模式](http://en.wikipedia.org/wiki/Active_record_pattern)，如果需要，您可以在此处阅读更多信息：http: [//codeinthehole.com/archives/6-Active-record-javascript-objects-using-cookies.html](http://codeinthehole.com/archives/6-Active-record-javascript-objects-using-cookies.html)

# java - Java 6 内存使用过多

> ID：366658
> 
> 赞同：22
> 
> 时间：2008-12-14T15:34:26.010
> 
> 标签：java, memory-management

对于大型应用程序，Java 6 消耗的内存是否比您预期的要多？

我有一个多年来一直在开发的应用程序，到目前为止，在我的特定测试配置中占用了大约 30-40 MB；现在使用 Java 6u10 和 11，它在活动时需要数百个。它反弹很多，在 50M 和 200M 之间的任何地方，当它空闲时，它*会执行*GC 并立即丢弃内存。此外，它还会产生数百万个页面错误。所有这些都是通过 Windows 任务管理器观察到的。

因此，我在我的分析器 (jProfiler) 下运行它并使用 jVisualVM，它们都表明通常的中等堆和 perm-gen 使用量合计约为 30M，即使在我的负载测试周期完全活跃时也是如此。

所以我很迷惑！它不仅从 Windows 虚拟内存池请求更多内存 - 这显示为 200M“内存使用”。

澄清：我想非常清楚这一点 - 在 18 小时内使用 Java VisualVM 观察到类堆和 perm gen 堆非常稳定。分配的易失性堆（eden 和tenured）保持不动，为 16MB（它在最初几分钟内达到），并且此内存的使用以完美的模式波动，从 8MB 均匀增长到 16MB，此时 GC 启动将其降回 8MB。在这 18 小时内，系统处于恒定的最大负载下，因为我正在运行压力测试。这种行为是*完美*且*一致*地可重现的，在多次运行中都可以看到。唯一的异常是，当这发生在从 Windows 获取的内存时，通过任务管理器观察到，从 64MB 到 900+MB 到处波动。

更新 2008-12-18：我已经使用 -Xms16M -Xmx16M 运行程序，没有任何明显的不利影响 - 性能很好，总运行时间大致相同。但短期内存使用量仍达到 180M 左右的峰值。

2009-01-21 更新：似乎答案可能在于线程数 - 请参阅下面的答案。

* * *

编辑：我的意思是字面上的数百万个页面错误 - 在 30M+ 的区域内。

编辑：我有一台 4G 机器，所以 200M 在这方面并不重要。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-15T10:12:51.247

为了回应对 Ran 的回答的评论中的讨论，这里有一个测试用例，证明 JVM*会*在某些情况下将内存释放回操作系统：

```
public class FreeTest
{
    public static void main(String[] args) throws Exception
    {
        byte[][] blob = new byte[60][1024*1024];
        for(int i=0; i<blob.length; i++)
        {
            Thread.sleep(500);
            System.out.println("freeing block "+i);
            blob[i] = null;
            System.gc();
        }
    }
} 
```

在 Java 1.4 和 Java 6 JVM（来自 Sun）上，当计数达到 40 左右时，我看到 JVM 进程的大小减小。

您甚至可以使用[-XX:MaxHeapFreeRatio 和 -XX:MinHeapFreeRatio 选项](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp#PerformanceTuning)调整确切的行为——该页面上的一些选项也可能有助于回答原始问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-14T17:45:12.317

我不知道页面错误。但是关于为 Java 分配的巨大内存：

1.  Sun 的 JVM~~只分配内存，从不释放它（直到 JVM 死亡）~~只有在内部内存需求和分配的内存之间的特定比率下降到（可调）值以下时才会释放内存。JVM 以 -Xms 中指定的数量开始，并且可以扩展到 -Xmx 中指定的数量。我不确定默认值是什么。每当 JVM 需要更多内存（新对象/原语/数组）时，它都会从操作系统分配整个块。但是，当需求消退时（暂时的需求，也请参见 2），它不会*立即*将内存释放回操作系统，而是将其保留给自己，直到达到该比例。曾经有人告诉我 JRockit 表现得更好，但我无法验证它。

2.  Sun 的 JVM 基于多个触发器运行完整的 GC。其中之一是可用内存量——当它下降太多时，JVM 会尝试执行完整的 GC 以释放更多内存。因此，当从操作系统（暂时需要）分配更多内存时，完整 GC 的机会就会降低。这意味着虽然您可能会看到 30Mb 的“活动”对象，但可能还有更多“死”对象（无法访问），只是在等待 GC 发生。我知道 yourkit 有一个很棒的视图，称为“dead objects”，您可能会在其中看到这些“left-overs”。

3.  在“-server”模式下，Sun 的 JVM 以并行模式运行 GC（相对于旧的串行“stop the world”GC）。这意味着虽然可能有垃圾需要收集，但可能不会立即收集，因为其他线程占用了所有可用的 CPU 时间。它将在内存不足之前被收集（嗯，有点。见[http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html](http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html)），如果可以从操作系统分配更多内存，它可能在 GC 运行之前。

结合起来，较大的初始内存配置和创建大量短期对象的短脉冲可能会创建所描述的场景。

*编辑：将“从不解除涂层”更改为“仅在达到比率后”。*

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-22T01:11:07.040

过多的线程创建完美地解释了您的问题：

*   每个线程都有自己的堆栈，它与堆内存分开，因此不会被分析器注册
*   默认线程堆栈大小相当大，IIRC 256KB（至少[它是用于 Java 1.3 的](http://java.sun.com/docs/hotspot/threads/threads.html)）
*   线程堆栈内存可能没有被重用，所以如果你创建和销毁大量线程，你会得到很多页面错误

如果您真的需要周围有数百个线程，可以通过 -Xss 命令行参数配置线程堆栈大小。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-15T14:46:36.700

垃圾收集是一门相当神秘的科学。随着最先进技术的发展，未调整的行为将随之改变。

Java 6 与早期 JVM 版本具有不同的默认 GC 行为和不同的“人机工程学”。如果您告诉它它可以使用更多内存（在命令行中明确显示，或者通过未指定更明确的内容而隐含地），如果它认为这可能会提高性能，它将使用更多内存。

在这种情况下，Java 6 似乎相信保留堆可以增长到的额外空间会给它更好的性能——大概是因为它认为这会导致更多的对象在 Eden 空间中死亡，并限制提升到的对象的数量。终身代空间。而且从你的硬件规格来看，JVM 并不认为这个额外的保留堆空间会导致任何问题。请注意，JVM 在得出结论时做出的许多（尽管不是全部）假设都是基于“典型”应用程序，而不是您的特定应用程序。它还根据您的硬件和操作系统配置文件做出假设。

如果 JVM 做出了错误的假设，您可以通过命令行影响它的行为，尽管很容易出错......

可以在[此处](http://java.sun.com/performance/reference/whitepapers/6_performance.html#2.3)找到有关 java 6 中性能变化的信息。

[内存管理白皮书](https://java.sun.com/j2se/reference/whitepapers/memorymanagement_whitepaper.pdf)中讨论了内存管理和性能影响。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-22T00:46:47.137

在过去的几周里，我有理由调查并纠正线程池对象（Java 6 之前的多线程执行池）的问题，其中启动的线程数量远远超过所需的线程。在有问题的作业中可能有多达 200 个不必要的线程。线程不断死亡，新的线程取代了它们。

纠正了这个问题后，我想再次运行测试，现在看来内存消耗是稳定的（尽管比旧 JVM 高 20 MB 左右）。

所以我的结论是内存中的峰值与运行的线程数（几百个）有关。不幸的是，我没有时间进行实验。

如果有人想试验并用他们的结论来回答这个问题，我会接受这个答案；否则我会接受这个（在 2 天的等待期之后）。

此外，页面错误率也大大降低（降低了 10 倍）。

此外，对线程池的修复更正了一些争用问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-07T09:44:10.177

升级到 Java 6u10 后在 Java 堆外分配了大量内存？只能是一件事：

[Java6 u10 发行说明](http://www.oracle.com/technetwork/java/javase/6u10-142936.html)：**“默认启用新的 Direct3D 加速渲染管道 (...)”**

Sun 在 Java 6u10 中默认启用 Direct 3D 加速。此选项创建大量（临时？）本机内存缓冲区，这些缓冲区分配在 Java 堆之外。添加以下 vm 参数以再次禁用它：

-Dsun.java2d.d3d=假

请注意，这不会禁用 2D 硬件加速，只会禁用一些可以使用 3D 硬件加速的功能。您将看到您的 Java 堆使用量最多将增加 7MB，但这是一个很好的折衷方案，因为您将节省大约 100MB(+) 的临时易失性内存。

我在两个平台上的 2 Swing 桌面应用程序中进行了大量测试：

*   配备 nVidia GTX 260 显卡的高端 Intel-i7，
*   使用 Intel 显卡的 3 年笔记本电脑。

在两个硬件平台上，该选项几乎使主观差异为零。（测试包括：滚动表格、缩放图形流程图、图表等）。在一些略有不同的测试中，禁用 d3d 会反直觉地*提高*性能。我怀疑内存管理/带宽问题抵消了 d3d 加速功能应该实现的任何好处。（你的旅费可能会改变！）

如果您需要进行一些性能调整，这里有一个[很好的参考资料](http://www.oracle.com/technetwork/java/javase/index-142560.html)（例如“Troubleshooting Java 2D”）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-16T22:38:14.610

您在使用 ConcMarkSweep 收集器吗？由于内存碎片增加和“浮动垃圾”（仅在收集器检查它们后才变得无法访问的对象，因此直到下一次通过时才被收集），它可能会增加应用程序所需的内存量。

# python - 如何限制函数调用的执行时间？

> ID：366682
> 
> 赞同：87
> 
> 时间：2008-12-14T16:20:24.203
> 
> 标签：python, multithreading

我的代码中有一个与套接字相关的函数调用，该函数来自另一个模块，因此不受我的控制，问题是它偶尔会阻塞几个小时，这是完全不可接受的，如何从我的代码中限制函数执行时间？我想解决方案必须使用另一个线程。

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-03-02T03:14:25.030

@rik.the.vik 的答案的改进是使用该[`with`语句](http://www.python.org/dev/peps/pep-0343/)为超时函数提供一些语法糖：

```
import signal
from contextlib import contextmanager

class TimeoutException(Exception): pass

@contextmanager
def time_limit(seconds):
    def signal_handler(signum, frame):
        raise TimeoutException("Timed out!")
    signal.signal(signal.SIGALRM, signal_handler)
    signal.alarm(seconds)
    try:
        yield
    finally:
        signal.alarm(0)

try:
    with time_limit(10):
        long_function_call()
except TimeoutException as e:
    print("Timed out!") 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-12-14T17:27:50.433

我不确定这可能是多么跨平台，但使用信号和警报可能是看待这个问题的好方法。通过一些工作，您可以使其完全通用并且在任何情况下都可以使用。

[http://docs.python.org/library/signal.html](http://docs.python.org/library/signal.html)

所以你的代码看起来像这样。

```
import signal

def signal_handler(signum, frame):
    raise Exception("Timed out!")

signal.signal(signal.SIGALRM, signal_handler)
signal.alarm(10)   # Ten seconds
try:
    long_function_call()
except Exception, msg:
    print "Timed out!" 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2014-10-30T22:05:02.787

这是限制函数运行时间的 Linux/OSX 方法。这是为了防止您不想使用线程，并希望您的程序等到函数结束或时间限制到期。

```
from multiprocessing import Process
from time import sleep

def f(time):
    sleep(time)

def run_with_limited_time(func, args, kwargs, time):
    """Runs a function with time limit

    :param func: The function to run
    :param args: The functions args, given as tuple
    :param kwargs: The functions keywords, given as dict
    :param time: The time limit in seconds
    :return: True if the function ended successfully. False if it was terminated.
    """
    p = Process(target=func, args=args, kwargs=kwargs)
    p.start()
    p.join(time)
    if p.is_alive():
        p.terminate()
        return False

    return True

if __name__ == '__main__':
    print run_with_limited_time(f, (1.5, ), {}, 2.5) # True
    print run_with_limited_time(f, (3.5, ), {}, 2.5) # False 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2016-06-06T01:41:39.750

我更喜欢上下文管理器方法，因为它允许在一个语句中执行多个 python`with time_limit`语句。因为windows系统没有`SIGALARM`，一个更便携也可能更直接的方法可能是使用`Timer`

```
from contextlib import contextmanager
import threading
import _thread

class TimeoutException(Exception):
    def __init__(self, msg=''):
        self.msg = msg

@contextmanager
def time_limit(seconds, msg=''):
    timer = threading.Timer(seconds, lambda: _thread.interrupt_main())
    timer.start()
    try:
        yield
    except KeyboardInterrupt:
        raise TimeoutException("Timed out for operation {}".format(msg))
    finally:
        # if the action ends in specified time, timer is canceled
        timer.cancel()

import time
# ends after 5 seconds
with time_limit(5, 'sleep'):
    for i in range(10):
        time.sleep(1)

# this will actually end after 10 seconds
with time_limit(5, 'sleep'):
    time.sleep(10) 
```

这里的关键技术是使用`_thread.interrupt_main`从定时器线程中断主线程。需要注意的是，主线程并不总是快速响应`KeyboardInterrupt`引发的问题`Timer`。例如，`time.sleep()`调用一个系统函数，因此 a`KeyboardInterrupt`将在`sleep`调用后处理。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-07-11T20:30:32.967

从信号处理程序中执行此操作是危险的：您可能在引发异常时位于异常处理程序中，并使事情处于损坏状态。例如，

```
def function_with_enforced_timeout():
  f = open_temporary_file()
  try:
   ...
  finally:
   here()
   unlink(f.filename) 
```

如果在此处（）引发您的异常，则永远不会删除临时文件。

这里的解决方案是将异步异常推迟到代码不在异常处理代码中（except 或 finally 块），但 Python 不这样做。

请注意，这不会在执行本机代码时中断任何内容；它只会在函数返回时中断它，所以这可能无助于这种特殊情况。（SIGALRM 本身可能会中断阻塞的调用——但套接字代码通常只是在 EINTR 之后重试。）

使用线程执行此操作是一个更好的主意，因为它比信号更便携。由于您正在启动一个工作线程并阻塞直到它完成，所以没有通常的并发问题。不幸的是，没有办法将异常异步传递给 Python 中的另一个线程（其他线程 API 可以做到这一点）。在异常处理程序期间发送异常也会有同样的问题，并且需要相同的修复。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2021-02-10T19:40:00.683

这里：获得所需效果的简单方法：

[https://pypi.org/project/func-timeout](https://pypi.org/project/func-timeout)

这救了我的命。

现在举一个关于它如何工作的例子：假设你有一个巨大的项目列表要处理，并且你正在对这些项目迭代你的函数。但是，由于某些奇怪的原因，您的函数卡在第 n 项上，而没有引发异常。您需要对其他项目进行处理，越多越好。在这种情况下，您可以设置处理每个项目的超时时间：

```
import time
import func_timeout

def my_function(n):
    """Sleep for n seconds and return n squared."""
    print(f'Processing {n}')
    time.sleep(n)
    return n**2

def main_controller(max_wait_time, all_data):
    """
    Feed my_function with a list of itens to process (all_data).

    However, if max_wait_time is exceeded, return the item and a fail info.
    """
    res = []
    for data in all_data:
        try:
            my_square = func_timeout.func_timeout(
                max_wait_time, my_function, args=[data]
                )
            res.append((my_square, 'processed'))
        except func_timeout.FunctionTimedOut:
            print('error')
            res.append((data, 'fail'))
            continue

    return res

timeout_time = 2.1  # my time limit
all_data = [i for i in range(1, 10)]  # the data to be processed

res = main_controller(timeout_time, all_data)
print(res) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-12-14T17:13:12.817

您不必使用线程。您可以使用另一个进程来完成阻塞工作，例如，可能使用[subprocess](http://docs.python.org/library/subprocess.html)模块。如果你想在程序的不同部分之间共享数据结构，那么[Twisted](http://twistedmatrix.com/trac/)是一个很好的库，可以让你自己控制它，如果你关心阻塞并且希望有很多麻烦，我会推荐它。Twisted 的坏消息是你必须重写你的代码以避免任何阻塞，并且有一个公平的学习曲线。

您*可以*使用线程来避免阻塞，但我认为这是最后的手段，因为它会让您面临整个世界的痛苦。在考虑在生产中使用线程之前阅读一本关于并发的好书，例如 Jean Bacon 的“并发系统”。我和一群用线程做非常酷的高性能工作的人一起工作，除非我们真的需要线程，否则我们不会将线程引入项目中。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-12-14T17:20:18.497

在任何语言中，唯一“安全”的方法是使用辅助进程来执行该超时操作，否则您需要以这样一种方式构建代码，使其自身安全超时，例如通过检查循环中经过的时间或类似的时间。如果更改方法不是一种选择，那么线程将不够用。

为什么？因为当你这样做时，你会冒着让事情处于糟糕状态的风险。如果线程在方法中被简单地杀死，被持有的锁等将被持有，并且不能被释放。

所以看进程方式，不要*看*线程方式。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-01-27T13:38:35.507

我通常更喜欢使用@josh-lee 建议的上下文管理器

但如果有人有兴趣将其作为装饰器实现，这里有一个替代方案。

这是它的样子：

```
import time
from timeout import timeout

class Test(object):
    @timeout(2)
    def test_a(self, foo, bar):
        print foo
        time.sleep(1)
        print bar
        return 'A Done'

    @timeout(2)
    def test_b(self, foo, bar):
        print foo
        time.sleep(3)
        print bar
        return 'B Done'

t = Test()
print t.test_a('python', 'rocks')
print t.test_b('timing', 'out') 
```

这是`timeout.py`模块：

```
import threading

class TimeoutError(Exception):
    pass

class InterruptableThread(threading.Thread):
    def __init__(self, func, *args, **kwargs):
        threading.Thread.__init__(self)
        self._func = func
        self._args = args
        self._kwargs = kwargs
        self._result = None

    def run(self):
        self._result = self._func(*self._args, **self._kwargs)

    @property
    def result(self):
        return self._result

class timeout(object):
    def __init__(self, sec):
        self._sec = sec

    def __call__(self, f):
        def wrapped_f(*args, **kwargs):
            it = InterruptableThread(f, *args, **kwargs)
            it.start()
            it.join(self._sec)
            if not it.is_alive():
                return it.result
            raise TimeoutError('execution expired')
        return wrapped_f 
```

输出：

```
python
rocks
A Done
timing
Traceback (most recent call last):
  ...
timeout.TimeoutError: execution expired
out 
```

请注意，即使`TimeoutError`抛出 ，被装饰的方法将继续在不同的线程中运行。如果您还希望该线程被“停止”，请参阅：[Is there any way to kill a Thread in Python?](https://stackoverflow.com/questions/323972/is-there-any-way-to-kill-a-thread-in-python)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-15T04:41:19.027

这是我想通过谷歌找到的超时功能，它对我有用。

来自： [http ://code.activestate.com/recipes/473878/](http://code.activestate.com/recipes/473878/)

```
def timeout(func, args=(), kwargs={}, timeout_duration=1, default=None):
    '''This function will spwan a thread and run the given function using the args, kwargs and 
    return the given default value if the timeout_duration is exceeded 
    ''' 
    import threading
    class InterruptableThread(threading.Thread):
        def __init__(self):
            threading.Thread.__init__(self)
            self.result = default
        def run(self):
            try:
                self.result = func(*args, **kwargs)
            except:
                self.result = default
    it = InterruptableThread()
    it.start()
    it.join(timeout_duration)
    if it.isAlive():
        return it.result
    else:
        return it.result 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-11T22:37:50.283

@user2283347 中的方法经过测试可以正常工作，但我们希望摆脱回溯消息。[在 Ctrl-C 上使用 Remove traceback in Python 中的](https://stackoverflow.com/questions/7073268/remove-traceback-in-python-on-ctrl-c)传递技巧，修改后的代码为：

```
from contextlib import contextmanager
import threading
import _thread

class TimeoutException(Exception): pass

@contextmanager
def time_limit(seconds):
    timer = threading.Timer(seconds, lambda: _thread.interrupt_main())
    timer.start()
    try:
        yield
    except KeyboardInterrupt:
        pass     
    finally:
        # if the action ends in specified time, timer is canceled
        timer.cancel()

def timeout_svm_score(i):
     #from sklearn import svm
     #import numpy as np
     #from IPython.core.display import display
     #%store -r names X Y
     clf = svm.SVC(kernel='linear', C=1).fit(np.nan_to_num(X[[names[i]]]), Y)
     score = clf.score(np.nan_to_num(X[[names[i]]]),Y)
     #scoressvm.append((score, names[i]))
     display((score, names[i])) 

%%time
with time_limit(5):
    i=0
    timeout_svm_score(i)
#Wall time: 14.2 s

%%time
with time_limit(20):
    i=0
    timeout_svm_score(i)
#(0.04541284403669725, '计划飞行时间')
#Wall time: 16.1 s

%%time
with time_limit(5):
    i=14
    timeout_svm_score(i)
#Wall time: 5h 43min 41s 
```

我们可以看到，这种方法可能需要很长的时间来中断计算，我们要求 5 秒，但它在 5 小时内完成。

# user-interface - 如何设计一个好的关于盒子？

> ID：366683
> 
> 赞同：6
> 
> 时间：2008-12-14T16:20:34.047
> 
> 标签：user-interface, about-box

**关于框**的布局没有官方标准 ，其中显示计算机软件的学分和其他信息。

**一个好的关于盒子应该包含什么？** *还有……*放一个[复活节彩蛋](http://en.wikipedia.org/wiki/Easter_egg_(virtual))可以吗？

[![替代文字](https://i.stack.imgur.com/JRrXj.png)](https://i.stack.imgur.com/JRrXj.png)
[（来源：[seasip.info](http://www.seasip.info/Gem/History/gem2about.png)）]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-14T16:55:07.223

我通常更喜欢制作标签式“关于”框。第一个选项卡通常显示有关应用程序的信息（名称、版本、版权等）。另一个选项卡通常是更改日志，最近的更改位于顶部。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-15T02:18:56.820

法律部门想要他们的版权和资料，营销部门想要他们的品牌（即使用户已经购买了产品），开发团队想要他们的名字以液晶显示，但*用户*需要什么？

1.  应用名称和版本号。用户可能需要它来解决问题，可能在与技术支持联系或使用知识库时。使用版本号系统，这样用户就需要指定他们的构建。用户还需要版本号才能知道他们是否可以升级。

2.  应用程序功能的简要说明（例如，“照片和图片组织者”）。用户最终会得到他们无法猜测其用途的软件。“关于”是告诉用户应用程序是关于什么的合乎逻辑的地方。

将上述内容放在关于顶部的显眼文本中。有一个确定按钮。您公司中其他人可能需要的所有其他内容实际上对用户没有任何兴趣，并且都可以在“精美印刷品”中。

如果您可以依靠它多年来的稳定性，您还可以包括网站或电子邮件以获得技术支持，但通常用户在转到“关于”框*之前已经有了它。*

如果您认为在您的应用程序中获得一点乐趣是合适的，并且您的用户倾向于事物的极客方面，那么复活节彩蛋就很好。只要确保它不会让低端用户（或未来的高端开发人员）感到震惊；请参阅：http: [//blogs.msdn.com/jensenh/archive/2005/10/20/483041.aspx](http://blogs.msdn.com/jensenh/archive/2005/10/20/483041.aspx)）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-14T16:29:10.660

看一些关于框的例子：

*   软件名称
*   出版商/作者姓名
*   版权和许可信息
*   版本信息
*   一个不错的标志

这些天来，有一种方法可以直接访问“关于”框中的软件网站，这可能不会有什么坏处。

Microsoft 的[Windows Vista 用户体验指南](http://msdn.microsoft.com/en-us/library/aa511258.aspx)往往包含有关设计良好用户界面的有用信息。我无法找到特定于关于框的信息，但[对话框](http://msdn.microsoft.com/en-us/library/aa511268.aspx)部分可能有些相关。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-14T19:33:33.313

我工作场所的一个团队实际上制作了有史以来最酷的 About 框：

每次打开它，它都会显示一个不同的简单游戏，并带有开发者的图片。团队（记忆游戏，井字游戏，数独等）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-12-09T03:36:42.447

至于关于页面内容，这是获得版本/发布信息的最佳位置，因此您可以提供轻松的支持。

我使用我的作为摘要描述以及指向法律页面和学分页面的链接。如果你有一个网站，它的 URL 也应该在那里——不妨将其设置为可点击进入你自己的网络视图浏览器，进入你的网络服务器上的大“公司简介”页面（不要启动真正的浏览器，或者用户刚刚离开您的应用程序）。

让阅读变得愉快，但要简洁。避免任何滚动或分页——除非是一组完全不同的信息屏幕。

此外，让它变得明显且易于忽略。

顺便说一句，如果您将复活节彩蛋添加到提交到 Apple Store 的应用程序中，您必须披露顺序供 Apple 进行“测试”；他们承诺对序列保密。如果他们稍后发现它，这将通过论坛等方式将其返回给他们，那么他们将自动从商店中提取它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-14T16:29:03.217

我倾向于添加程序名称、版本、公司版权、联系信息、许可证信息。我还添加了各种变量来解决问题。Winows 版本、服务包、dll 版本（如果我使用关键 dll 等）。一个大的应用程序图标。有时我会添加一个复活节彩蛋或一些组合键来启动程序的一部分，用于调试和支持目的。

# language-agnostic - 在日常编程中，您需要多久创建一次真正的类层次结构？

> ID：366685
> 
> 赞同：2
> 
> 时间：2008-12-14T16:21:30.893
> 
> 标签：language-agnostic, oop

我创建使用大量数据库的业务应用程序。大多数编程工作只是将组件连接到数据库并修改组件以适应一般的界面行为。我主要使用 Delphi 及其丰富的 VCL 库，并且通常购买所需的组件。我将大部分业务逻辑保留在数据库中。我很少有机会自下而上构建一个好的类层次结构，因为确实没有必要。其他人有这种经验吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T18:07:46.047

对我来说，子类化有时会更清楚或更容易地解决问题，但并不常见。

这在给定的设计中也发生了很大的变化，因为它被重构了。

我最大的问题是编程课程和课本通过基类（与接口或动态类型相比）非常重视继承、层次结构和多态性。这有助于创建大量程序员，将所有事物及其母亲子类化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-14T17:11:29.763

这个问题的答案并不完全与语言无关。

像 Java 这样的一些语言的可用语言功能集相当有限，这意味着子类化经常被使用，因为它是一种方便的重用方法，技术继承。

由于技术原因，C# 的闭包和 lambdas 使继承变得不那么重要。所以通常继承是出于语义原因（如 cat 扩展动物）。

我参与的最后一个 C# 项目，我们或多或少地在几周内完成了所有的类层次结构。在那之后，它或多或少地结束了。

在我当前的 java 项目中，我们一直在创建新的类层次结构。

其他语言将具有类似影响此组合的其他功能（想到 mixin）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T16:29:16.290

我大概每个月戴上一两次我的建筑/课程设计帽子。这可能是我拥有的最好的帽子，而且戴起来最有趣。

不过，这取决于您的项目处于生命周期的哪个阶段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T16:34:53.283

当您处理您熟悉的问题域并且已经有一个通用的代码库可供使用时，您通常不需要创建新的类层次结构。当您偶然发现没有现成解决方案的问题时，您开始构建自己的解决方案。

它还非常依赖于您开发的应用程序的类型。如果您的域已经有公认的约定和库可供使用，则可能不需要重新发明轮子（个人/学术兴趣除外）。有些领域本来就可以使用的可用资源较少，而在这些领域中，您会发现自己大部分时间都是从头开始构建一切。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-14T17:01:33.417

大多数应用程序，尤其是业务应用程序，至少包含某种业务逻辑。我认为业务不应该在数据库中，而应该在应用程序中。您可以将参照完整性放在数据库中，因为我认为这是一个不错的选择，但业务逻辑应该只在应用程序中。

通过类层次结构，我想你的意思是你总是必须在你的对象模型中得到一些继承，那么答案是否定的。但是您经常可以找到一些通用代码，将其分解并创建一个基类来包含通用代码。

如果您同意我的观点，即业务逻辑不应该在数据库中，而应该在应用程序中，那么我建议您查看 MVC 设计模式来指导您的设计。您会发现您的设计包含类或对象。您的 VCL 将代表您的视图，并且您可以让您的模型类直接映射到数据库表，即模型中类中的每个成员对应于数据库表中的一个字段（同样，这是常态，但会有例外，这种简单性不适用）。然后，您需要一个层来处理模型类对数据库表的 CRUD（创建、读取、更新、删除）。您最终会得到一个更易于维护和增强的“分层”应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-14T18:43:07.457

这取决于您所说的层次结构 - 继承还是分层？

当面向对象语言第一次出现时，继承被过度使用。复杂的等级制度很常见。现在，接口（如在 Java 和 C# 中）提供了一种更简单的方法来获得多态性的好处，而不会带来继承的复杂性。我很少使用继承了。

然而，在创建大型应用程序时，分层至关重要。分层可防止一般的低级类（如列表）直接引用特定的高级类（如 Web 浏览器窗口）。据我所知，没有一种正式的方式来描述分层，但是有一些通用的指导方针（模型-视图-控制器（MVC）、将 GUI 逻辑与业务逻辑分开、将数据与表示分开等）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-14T16:56:37.563

这实际上取决于您正在从事的项目的类型/阶段。我碰巧每天都这样做，因为我正在研究新数据库的数据库内部结构，创建相关的库/框架。如果我在使用其他人的库的成熟框架中工作，我会想象这样做会少很多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-14T18:13:13.837

我发现类层次结构最有益的时间是对象之间的关系实际上与域中真正的“is-a”关系相匹配。

但是，如果我可以避免大型层次结构，我会因为它们通常更难以映射到关系数据库并且确实会使您的数据库设计复杂化。由于您说您的大多数应用程序都大量使用数据库，因此需要考虑这一点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-14T21:24:42.047

我正在为我们公司的产品做基础设施，所以我正在编写很多代码，稍后将被其他团队的人使用。所以我最终写了很多抽象类、接口、层次结构等等。大多数情况下，它只是“抽象/虚拟类中的默认行为，其他程序员可能会覆盖”的一种模式。

非常具有挑战性，我必须说。

# asp.net-mvc - 在 Mono 上运行 ASP.NET 应用程序的主要问题

> ID：366688
> 
> 赞同：4
> 
> 时间：2008-12-14T16:25:27.313
> 
> 标签：asp.net-mvc, mono

假设我有一个 ASP.NET MVC 应用程序没有做任何太花哨的事情（没有 P/Invoke，没有不安全等）。

我考虑过在 Mono 上运行以支持 Linux 以及其他平台的想法。好久没用过Mono了。我可能面临的首要问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T16:44:52.967

*   Mono 不支持主题
*   Mono 没有出色的 GC，这意味着它会泄漏更多内存并为您分割 RAM
*   Mono 不会像 .Net 为“空白”创建文本控件那样创建文本控件，这可能是一个问题

除了那些问题，据我所知，你应该对 ASP.NET 2.0 是安全的......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T20:09:01.987

asp.net mvc 的目标是单声道 2.6，该版本将于 2009 年[9 月到期](http://www.mono-project.com/Roadmap)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T16:56:03.803

您提到了在 .net 3.5 上运行的 ASP.NET MVC，而 mono 用于 framework 2.0。
ScottHansleman 写了一篇关于如何在 2.0 上运行 mvc 的博文，你可以试试。或者使用开箱即用的 Monorail（或 ProMesh.NET）。它们都是 .net 的 MVC 框架...

# javascript - jQuery 对话框

> ID：366696
> 
> 赞同：35
> 
> 时间：2008-12-14T16:34:13.253
> 
> 标签：javascript, jquery, jquery-ui, dialog

我试图用 jquery 做一个对话框。在此对话框中，我将有条款和条件。问题是该对话框仅在第一次显示。

这是代码。

JavaScript：

```
function showTOC()
{
    $("#TOC").dialog({ 
        modal: true, 
        overlay: { 
            opacity: 0.7, 
            background: "black" 
        } 
    })
} 
```

HTML（一个href）：

```
<a class="TOClink" href="javascript:showTOC();">View Terms & Conditions</a>

<div id="example" title="Terms & Conditions">1..2..</div> 
```

我认为的问题是，当您关闭对话框时，DIV 会从 html 代码中销毁，因此它永远无法再次显示在屏幕上。

你能帮忙吗！

谢谢

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-01-06T15:12:27.913

我遇到了同样的问题（对话框只会打开一次，关闭后就不会再次打开），并尝试了上面的解决方案，但没有解决我的问题。我回到文档并意识到我对对话框的工作原理有一个根本的误解。

$('#myDiv').dialog() 命令创建/实例化对话框，但不一定是**打开**它的正确方法。打开它的正确方法是使用 dialog() 实例化对话框，然后使用 dialog('open') 显示它，并使用 dialog('close') 关闭/隐藏它。这意味着您可能希望将 autoOpen 选项设置为 false。

所以过程是：在文档准备好时实例化对话框，然后监听单击或您想要显示对话框的任何操作。然后它会工作，一次又一次！

```
<script type="text/javascript"> 
        jQuery(document).ready( function(){       
            jQuery("#myButton").click( showDialog );

            //variable to reference window
            $myWindow = jQuery('#myDiv');

            //instantiate the dialog
            $myWindow.dialog({ height: 350,
                width: 400,
                modal: true,
                position: 'center',
                autoOpen:false,
                title:'Hello World',
                overlay: { opacity: 0.5, background: 'black'}
                });
            }

        );
    //function to show dialog   
    var showDialog = function() {
        //if the contents have been hidden with css, you need this
        $myWindow.show(); 
        //open the dialog
        $myWindow.dialog("open");
        }

    //function to close dialog, probably called by a button in the dialog
    var closeDialog = function() {
        $myWindow.dialog("close");
    }

</script>
</head>

<body>

<input id="myButton" name="myButton" value="Click Me" type="button" />
<div id="myDiv" style="display:none">
    <p>I am a modal dialog</p>
</div> 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-14T16:58:30.740

看起来您发布的代码有问题。您显示 T&C 的功能引用了错误的 div id。加载文档后，您还应该考虑将 showTOC 函数分配给 onclick 属性：

```
$(document).ready({
    $('a.TOClink').click(function(){
        showTOC();
    });
});

function showTOC() {
    $('#example').dialog({modal:true});
} 
```

使用 jQuery UI 对话框实现所需效果的更简洁示例是：

```
 <div id="terms" style="display:none;">
       Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
   </div>
   <a id="showTerms" href="#">Show Terms &amp; Conditions</a>      
   <script type="text/javascript">
       $(document).ready(function(){
           $('#showTerms').click(function(){
               $('#terms').dialog({modal:true});   
           });
       });
   </script> 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-27T08:20:23.037

我有同样的问题，正在寻找一种方法来解决它，这让我来到了这里。在查看了 RaeLehman 提出的建议后，我找到了解决方案。这是我的实现。

在我的 $(document).ready 事件中，我使用 autoOpen 设置为 false 来初始化我的对话框。我还选择将单击事件绑定到一个元素，例如一个按钮，这将打开我的对话框。

```
$(document).ready(function(){

    // Initialize my dialog
    $("#dialog").dialog({
        autoOpen: false,
        modal: true,
        buttons: {
        "OK":function() { // do something },
        "Cancel": function() { $(this).dialog("close"); }
    }
    });

    // Bind to the click event for my button and execute my function
    $("#x-button").click(function(){
        Foo.DoSomething();
    });
}); 
```

接下来，我确保定义了该函数，这就是我实现对话框打开方法的地方。

```
var Foo = {
    DoSomething: function(){
        $("#dialog").dialog("open");
    }
} 
```

顺便说一句，我在 IE7 和 Firefox 中对此进行了测试，效果很好。希望这可以帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-14T19:02:12.663

如果您需要在一个页面上使用多个对话框并打开、关闭并重新打开它们，则以下操作效果很好：

```
 JS CODE:
    $(".sectionHelp").click(function(){
        $("#dialog_"+$(this).attr('id')).dialog({autoOpen: false});
        $("#dialog_"+$(this).attr('id')).dialog("open");
    });

 HTML: 
    <div class="dialog" id="dialog_help1" title="Dialog Title 1">
        <p>Dialog 1</p>
    </div>
    <div class="dialog" id="dialog_help2" title="Dialog Title 2">
        <p>Dialog 2 </p>
    </div>

    <a href="#" id="help1" class="sectionHelp"></a>
    <a href="#" id="help2" class="sectionHelp"></a>

 CSS:
    div.dialog{
      display:none;
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-02T18:26:17.720

```
<script type="text/javascript">
// Increase the default animation speed to exaggerate the effect
$.fx.speeds._default = 1000;
$(function() {
    $('#dialog1').dialog({
        autoOpen: false,
        show: 'blind',
        hide: 'explode'
    });

    $('#Wizard1_txtEmailID').click(function() {
        $('#dialog1').dialog('open');
        return false;
    });
    $('#Wizard1_txtEmailID').click(function() {
        $('#dialog2').dialog('close');
        return false;
    });
    //mouseover
    $('#Wizard1_txtPassword').click(function() {
        $('#dialog1').dialog('close');
        return false;
    });

});

/////////////////////////////////////////////////////
 <div id="dialog1" title="Email ID">
                                                                                                                <p>
                                                                                                                    (Enter your Email ID here.)
                                                                                                                    <br />
                                                                                                                </p>
                                                                                             </div>
 ////////////////////////////////////////////////////////

<div id="dialog2" title="Password">
                                                                                                                <p>
                                                                                                                    (Enter your Passowrd here.)
                                                                                                                    <br />
                                                                                                                </p>
                                                                                              </div> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-28T21:00:11.737

如果您只想生成一次对话框的内容（或仅使用 javascript 修改它），RaeLehman 的解决方案就可以工作。如果您确实想每次都重新生成对话框（例如，使用视图模型类和 Razor），那么您可以使用 $(".ui-dialog-titlebar-close").click(); 关闭所有对话框。并将 autoOpen 设置为其默认值 true。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-09T00:03:46.507

这更简洁一点，还允许您根据不同的点击事件拥有不同的对话框值等：

```
$('#click_link').live("click",function() {
    $("#popup").dialog({modal:true, width:500, height:800});

    $("#popup").dialog("open");

    return false;
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-23T09:59:04.330

我的解决方案：删除一些初始化选项（例如显示），因为如果某些东西不工作（例如幻灯片效果），构造函数不会产生。我的函数没有动态 html 插入：

```
function ySearch(){ console.log('ysearch');
    $( "#aaa" ).dialog({autoOpen: true,closeOnEscape: true, dialogClass: "ysearch-dialog",modal: false,height: 510, width:860
    });
    $('#aaa').dialog("open");

    console.log($('#aaa').dialog("isOpen"));
    return false;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-22T08:34:27.253

甚至我也面临类似的问题。这就是我能够解决相同问题的方法

```
 $("#lnkDetails").live('click', function (e) {

        //Create dynamic element after the element that raised the event. In my case a <a id="lnkDetails" href="/Attendance/Details/2012-07-01" />
        $(this).after('<div id=\"dialog-confirm\" />');

        //Optional : Load data from an external URL. The attr('href') is the href of the <a> tag.
        $('#dialog-confirm').load($(this).attr('href'));

        //Copied from jQueryUI site . Do we need this?
        $("#dialog:ui-dialog").dialog("destroy");

        //Transform the dynamic DOM element into a dialog
        $('#dialog-confirm').dialog({
            modal: true,
            title: 'Details'
        });

        //Prevent Bubbling up to other elements.
        return false;
    }); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-03T12:47:44.587

如果您想更改所有对话框的不透明度，请更改 jquery-ui.css

```
/* Overlays */
.ui-widget-overlay
{
    background: #5c5c5c url(images/ui-bg_flat_50_5c5c5c_40x100.png) 50% 50% repeat-x;
    opacity: .50;
    filter: Alpha(Opacity=80);
} 
```

# asp.net-mvc - 使 Linq 实体对象适应域对象

> ID：366697
> 
> 赞同：1
> 
> 时间：2008-12-14T16:34:26.687
> 
> 标签：asp.net-mvc, linq, dns, adaption

我有以下代码使 linq 实体适应我的域对象：

```
return from g in DBContext.Gigs
               select new DO.Gig
               {
                   ID = g.ID,
                   Name = g.Name,
                   Description  = g.Description,
                   StartDate    = g.Date,
                   EndDate      = g.EndDate,
                   IsDeleted    = g.IsDeleted,
                   Created      = g.Created,
                   TicketPrice  = g.TicketPrice

               }; 
```

这非常有效。

但是，我现在想填充域对象 Venue 对象并将其添加到同一语句中的 gig 中。这是我的尝试....

```
return from g in DBContext.Gigs
               join venue in DBContext.Venues on g.VenueID equals venue.ID
               select new DO.Gig
               {
                   ID = g.ID,
                   Name = g.Name,
                   Description  = g.Description,
                   StartDate    = g.Date,
                   EndDate      = g.EndDate,
                   IsDeleted    = g.IsDeleted,
                   Created      = g.Created,
                   TicketPrice  = g.TicketPrice,
                   Venue        =     from v in DBContext.Venues
                                        where v.ID == g.VenueID
                                        select new DO.Venue
                                        {
                                            ID           = v.ID,
                                            Name         = v.Name,
                                            Address      = v.Address,
                                            Telephone    = v.Telephone,
                                            URL          = v.Website 
                                        }

               }; 
```

但是，这不会编译！！！

是否可以使用“选择新”方法调整子对象？

我在做什么非常非常错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T19:00:45.767

您的内部 LINQ 查询返回多个对象，而不仅仅是一个。你想用这样的调用来包装它：

```
Venue = (from v in DBContext.Venues
         where v.ID == g.VenueID
         select new DO.Venue
         {
             ID           = v.ID,
             Name         = v.Name,
             Address      = v.Address,
             Telephone    = v.Telephone,
             URL          = v.Website 
         }).SingleOrDefault() 
```

您对 Single() 与 SingleOrDefault() 与 First() 与 FirstOrDefault() 的选择取决于它是哪种查询，但我猜您想要前两个中的一个。（如果查询没有数据，则“OrDefault”变体返回 null；其他变体抛出。）

我也同意迈克的观点，如果涉及单一关系，加入可能更符合您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T16:53:07.820

你为什么要做一个连接和一个子选择？您可以只使用您加入的结果来创建一个新的场地。请注意，如果演出和场地之间没有一对一的关系，您可能会遇到麻烦。

尝试这个：

```
return from g in DBContext.Gigs 
    join venue in DBContext.Venues on g.VenueID equals venue.ID 
    select new DO.Gig { ID = g.ID, Name = g.Name, Description = g.Description,
        StartDate = g.Date, EndDate = g.EndDate, IsDeleted = g.IsDeleted, 
        Created = g.Created, TicketPrice = g.TicketPrice, 
        Venue = new DO.Venue { ID = venue.ID, Name = venue.Name, 
            Address = venue.Address, Telephone = v.Telephone, 
            URL = v.Website } 
```

# project-management - 如何免费管理项目？

> ID：366702
> 
> 赞同：-2
> 
> 时间：2008-12-14T16:39:37.253
> 
> 标签：project-management

我被要求管理和开发一个项目。客户并不真正关心我是雇用愿意做的人还是我自己做。因此，我决定成为更多的经理而不是开发人员。

是否有任何（免费/低成本）网络项目可以帮助我与互联网上的每个“子开发人员”进行交流？

我期望有与 basecamp 类似的项目，但是子开发人员不会互相了解，因为我将成为他们之间的沟通者。basecamp 可能包含这种服务，但我不会为了解这一点而向所有可能的类似服务付费。

如果您对我即将遇到的此类问题有一些实际经验，请写在这里。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T18:11:38.130

正如许多开源项目所发现的那样，[trac](http://trac.edgewall.org/)非常适合 - 具有集成[颠覆](http://svn.tigris.org/)接口的轻量级项目管理：

> Trac 是用于软件开发项目的增强型 wiki 和问题跟踪系统。Trac 使用简约的方法进行基于 Web 的软件项目管理。我们的使命是帮助开发人员编写出色的软件，同时不碍事。Trac 应尽可能少地强加于团队已建立的开发流程和政策。
> 
> 它提供了一个 Subversion 接口、一个集成的 Wiki 和方便的报告工具。
> 
> Trac 允许在问题描述和提交消息中添加 wiki 标记，在错误、任务、变更集、文件和 wiki 页面之间创建链接和无缝引用。时间线按顺序显示所有当前和过去的项目事件，使获取项目概览和跟踪进度非常容易。路线图显示了前进的道路，列出了即将到来的里程碑。

[trac](http://trac.edgewall.org/)和[subversion](http://svn.tigris.org/)都可以在 Web 上的任何地方使用，使用免费或低成本的提供程序之一（有关一些参考资料，请参阅[TracUsers](http://trac.edgewall.org/wiki/TracUsers)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T17:14:10.710

如果我是你，我会设置共享点。它非常适合处理项目和与成员交谈。还设置了几个邮件列表，你们都可以轻松地交流。

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T02:45:12.240

我建议看一下[Assembla](http://www.assembla.com)，它包含问题跟踪、版本控制和 Trac 支持——而且它是免费的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-14T19:18:44.157

您可以使用免费版本的[AceProject](http://www.aceproject.com/)来做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-22T07:07:01.063

有很多软件可用于轻松管理项目，在这里我建议您查看 ProofHub - [https://www.proofhub.com](https://www.proofhub.com/?ref=nan)（注意 - 我在那里工作）。它允许您捕获计划和进度的全貌和详细快照。甘特图和任务管理功能为您提供了清晰的画面，让您了解正在处理的工作和需要完成的工作。您可以在甘特图上跟踪任务依赖关系，以查看项目的进度。这是它的外观： [ProofHub 概述](http://i.stack.imgur.com/42ed9.jpg)

# python - Python中的按位减法

> ID：366706
> 
> 赞同：9
> 
> 时间：2008-12-14T16:41:28.263
> 
> 标签：python, low-level

[这是我昨天的问题](https://stackoverflow.com/questions/365522/what-is-the-best-way-to-add-two-numbers-without-using-the-operator)的后续行动：

CMS 好心地提供了这个使用位运算符在 C 中添加两个数字的示例：

```
#include<stdio.h>

int add(int x, int y) {
    int a, b;
    do {
        a = x & y;
        b = x ^ y;
        x = a << 1;
        y = b;
    } while (a);
    return b;
}

int main( void ){
    printf( "6 + 3 = %d", add(6,3));
    printf( "6 - 3 = %d", add(6,-3));
    return 0;
} 
```

它工作得很好，然后我将它移植到 Python，如下所示：

```
def add(x, y):
    while True:
        a = x & y
        b = x ^ y
        x = a << 1
        y = b
        if a == 0:
            break
    return b

print "6 + 3 = %d" % add(6,3)
print "6 - 3 = %d" % add(6,-3) 
```

它们都适用于加法，C 程序也适用于减法。但是，Python 程序会进入一个无限循环进行减法。我试图深入了解并在此处发布程序以供进一步实验：[http ://codepad.org/pb8IuLnY](http://codepad.org/pb8IuLnY)

谁能告诉我为什么 C 处理这个问题的方式和 CPython 处理这个问题的方式会有所不同？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-14T17:06:34.233

正如我在昨天对 CMS 的回答中指出的那样，左移一个负数是 C 中未定义的行为，所以这甚至不能保证在 C 中工作（问题是如何处理有符号位，你是否移动它像一个值位还是不受移位的影响？标准委员会无法就行为达成一致，因此未定义）。

当这恰好在 C 中起作用时，它依赖于固定位宽的整数，以便在您进行移位时最左边的位被推到末尾（它还需要将符号位视为值位以进行移位）。C 中的所有整数类型都是固定位的，但 Python 数字可以任意大。在 Python 中左移一个数字只会导致它不断变大：

```
>>> 1 << 100
1267650600228229401496703205376L 
```

你可以尝试这样的事情：

```
x = (a << 1) & 0xffffffff 
```

要将结果限制为 32 位，问题在于 Python 中的左移运算符不会移动有符号数的符号位（这是使此特定解决方案工作所需的一部分）。可能有一种方法可以改变班次操作员的行为，但我不知道如何。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T17:04:34.223

移动负数在 python 和 C 之间没有一致的解释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-15T13:43:38.657

如果`i`,`j`是两个整数：

添加：

```
printf("%d",(i^j)|((i&j)<<1)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-11T16:46:23.403

我注意到您假设 python 处理数字的方式与 C 相同。
这并不完全正确。这意味着 C 的 int 数具有 16 位的固定长度。有关 C 数据类型的详细信息，您可以参考[en.wikipedia.org](http://en.wikipedia.org/wiki/C_data_types)
上的 C_data_types 另一方面，据说对于 int 数而言，Python 的长度几乎是无限的。
添加正整数可能以相同的方式工作。但负整数的减法或加法不应该是简单的映射转换。
理解这一点的简单方法是一个关于负数的小例子：想象一个 3 位的固定长度整数表示：
#Unsigned#

*   `000`: 0
*   `001`: 1
*   `010`: 2
*   `011`: 3
*   `100`: 4
*   `101`: 5
*   `110`: 6
*   `111`: 7

＃签：＃

*   `000`: 0
*   `001`: 1
*   `010`: 2
*   `011`: 3
*   `100`：-4
*   `101`：-3
*   `110`：-2
*   `111`：-1

这很酷，因为您可以看到`1-3=1+(-3)`，-3`101`如果未签名，则为 5。所以`1+5=6`6 : `110`: -2。这意味着`1-3=-2`.
溢出时也会出现问题：

*   `-4 + -1 = 3`不是-5，因为它超出了范围！
*   `3 + 1 = -4`不是 4，因为它超出了范围！

正如您可能看到的那样，这适用于固定长度，但在 Python 中却不是这样。

# c# - 收集崩溃数据的最佳方法是什么？

> ID：366718
> 
> 赞同：6
> 
> 时间：2008-12-14T16:51:20.850
> 
> 标签：c#, exception, exception-handling

因此，我对尝试从程序自动收集数据的概念感到满意——即，当出现问题时，弹出一个对话框，要求用户发送报告。

我在 MS Visual Studio C# 中工作。

从实现的角度来看，在我的主 program.cs 文件中放置一个 try/catch 循环是否有意义，在应用程序运行的位置周围？像这样：

```
 try
        {
            Application.Run(new myMainForm());
        }
        catch (Exception ex)
        {
            //the code to build the report I want to send and to 
            //pop up the Problem Report form and ask the user to send

        } 
```

或者将 try/catch 循环放在代码片段中以捕获更具体的异常类型是否有意义？（我认为不是因为这是一个新应用程序，并且放入更具体的异常捕获意味着我知道会出现什么问题......我不知道，这就是为什么上面对我来说似乎有意义.)

-阿迪娜

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-14T17:00:10.317

我认为你是对的，你不会知道会出什么问题，这就是重点。

但是，您不妨考虑将处理程序添加到[ThreadException](http://www.digcode.com/default.aspx?page=ed51cde3-d979-4daf-afae-fa6192562ea9&article=5c26d313-2435-442f-91e8-a73e9aff021b)事件。

上面的代码可以工作，但在某些情况下，此类代码可能会出现多线程问题，因为并非 Windows 窗体程序中的所有代码都将在主 Application.Run 循环线程中运行。

这是链接文章中的示例代码：

```
[STAThread]
static void Main() 
{
   System.Windows.Forms.Application.ThreadException += new ThreadExceptionEventHandler(ReportError);
   System.Windows.Forms.Application.Run(new MainForm());
}

private static void ReportError(object sender, ThreadExceptionEventArgs e)
{
   using (ReportErrorDialog errorDlg = new ReportErrorDialog(e.Exception))
   {
    errorDlg.ShowDialog();
   }
} 
```

[有关MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)的更多文档。

在次要的一点上，使用 ThreadException 事件还允许您的主消息循环继续运行，以防异常不是致命的（即容错方案），而 try/catch 方法可能需要您重新启动主消息循环，这可能引起副作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-11T10:30:29.780

如果您确实想自动获取堆栈跟踪，Microsoft 确实允许您通过错误报告服务提交它们。您需要做的就是从 VeriSign 注册一个数字证书并在 Microsoft 注册（免费）。

然后，Microsoft 会为您提供一个登录名，以便您从网站下载迷你转储，当用户单击“发送错误报告”时提交这些迷你转储。

尽管人们可以点击“不要发送”，但至少它是一个 Microsoft 对话框，可能不需要您自己编写代码。它将 24/7 全天候运行，您不必担心 Web 服务器的正常运行时间，您可以为用户提交解决方法详细信息，并且您可以通过 Windows Update 提供更新。

有关此服务的信息位于此“ [Windows 错误报告：入门](http://www.microsoft.com/whdc/winlogo/maintain/StartWER.mspx)”文章中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T17:20:49.027

> 从实现的角度来看，在我的主 program.cs 文件中放置一个 try/catch 循环是否有意义，在应用程序运行的位置周围？

当然，永远。

你应该在任何关键的地方使用 Try/Catch-Blocks，这可能会引发异常。

因此，你不能真正坚持一个模式，因为你现在应该，什么时候会引发什么异常。否则这些都是未处理的异常，会让你的程序崩溃。

但是有许多异常，不需要完全停止应用程序，异常可以被吞掉，因为它们是预期的，并不需要应用程序停止。例如，使用程序移动或访问数据时出现 UnauthorizedAccessExceptions。

由于性能原因，您应该尽量使 Try/Catch-Blocks 尽可能小，并且不要使用太多。

有些使用 Try/Catch 来控制程序的执行。应尽可能完全避免这种情况，因为引发异常是性能杀手数 1。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T17:26:04.337

在整个应用程序周围包装一个 try catch 意味着应用程序将在出错时退出。

虽然对每种方法都使用 try and catch 是很难维护的。

最佳实践是在代码单元周围使用特定的 try catch，这些代码单元将抛出特定的异常类型，例如 FormatException，并将一般异常处理留给应用程序级事件处理程序。

```
try
        {
            //Code that could error here
        }
        catch (FormatException ex)
        {
            //Code to tell user of their error
            //all other errors will be handled 
            //by the global error handler
        } 
```

经验会告诉你可能出错的事情类型。随着时间的推移，您会注意到您的应用程序经常抛出有关文件访问的 IO 异常，因此您以后可能会捕获这些异常并为用户提供更多信息。

错误的全局处理程序将捕获其他所有内容。您可以通过将事件处理程序连接到两个事件 System.Windows.Forms.Application.ThreadException（[请参阅 MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)）和 AppDomain.UnhandledException（[请参阅 MSDN](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)）来使用它们

请注意，内存不足异常和 StackOverflowException 可能不会被任何错误捕获捕获。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-14T20:12:21.770

如果您只想捕获崩溃，则忽略所有错误并让 DrWatson 为您生成一个小型转储。然后你可以查看那个 ina 调试器（windbg 是 minidump 的首选），它会显示你的代码出错的行，以及所有参数、堆栈跟踪和寄存器。您可以将 Drwatson 设置为生成完整转储，您将在其中获取整个内存核心转储以进行调查。

我不建议在整个应用程序中使用 try/catch，除非您希望您的应用程序永远不会在用户面前“崩溃” - 它总是会被处理，并且可能会被忽略，因为您无能为力那一点。

不过，将 minidump 发送给您是另一回事，[这里有一篇文章](http://msdn.microsoft.com/en-us/magazine/cc163530.aspx)，您必须做一些工作才能通过 email/http/ftp/etc 发送它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T17:57:58.530

最好的方法是为 [AppDomain.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)和[Application.ThreadException](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)在你的应用程序的 main 函数中调用。这将允许您在应用程序中记录任何未处理的异常。在 try catch 块中包装 run 并不能捕获所有内容。

# oop - 客观良好的OO设计原则

> ID：366719
> 
> 赞同：2
> 
> 时间：2008-12-14T16:52:01.753
> 
> 标签：oop, principles

# 前提

我相信有一种方法可以客观地定义“好”和“坏”的面向对象设计技术，并且作为一个社区，我们可以确定它们是什么。这是一个学术练习。如果以认真和决心完成，我相信这将对整个社区大有裨益。社区将受益于拥有一个我们都可以指出的地方，“这种技术是‘好’或‘坏’，除非有特殊情况，否则我们应该或不应该使用它。”

# 计划

对于这项工作，我们应该关注面向对象的原则（而不是函数式、基于集合或其他类型的语言）。

我不打算接受一个答案，而是希望这些答案有助于最终收集或成为对问题的理性辩论。

我意识到这可能会引起争议，但我相信我们可以解决一些问题。大多数规则都有例外，我相信这就是分歧所在。我们应该作出声明，然后注意相关的例外情况和反对者的反对意见。

# 基础

我想尝试定义“好”和“坏”：

*   “好” - 这种技术将第一次起作用，并且是一个持久的解决方案。以后很容易更改，并且会很快支付其实施的时间投资。它可以在未来得到维护程序员的一致应用和轻松识别。总体而言，它有助于实现良好的功能并降低产品生命周期内的维护成本。

*   “坏” - 这种技术可能在短期内有效，但很快就会成为一种负担。很难立即改变或随着时间的推移变得更加困难。初始投资可大可小，但很快就会成为不断增长的成本，最终成为沉没成本，必须不断消除或解决。它是主观应用且不一致的，将来可能会令人惊讶或不容易被维护程序员识别。总体而言，它会导致最终增加维护和/或操作产品的成本，并抑制或阻止对产品的更改。通过抑制或阻止变化，它不仅成为直接成本，而且成为机会成本和重大责任。

# 起动机

作为一个我认为好的贡献应该是什么样子的例子，我想提出一个“好的”原则：

## 关注点分离

[简短的介绍]

### 例子

[代码或其他类型的示例]

### 目标

[解释这个原则可以防止什么问题]

### 适用性

[为什么，在哪里，什么时候使用这个原则？]

### 例外

[我什么时候不使用这个原理，或者它实际上在哪里有害？]

### 异议

[请在此处注意来自社区的任何不同意见或反对意见]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T18:33:21.547

有一些很好理解的原则可能会形成一个很好的起点：

*   [开闭原则](http://en.wikipedia.org/wiki/Open/closed_principle)
*   [里氏替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)
*   [得墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)

研究现有的设计模式以找到它们背后的原则也是一个好主意，最重要的是（通常）更喜欢组合而不是继承。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T17:59:11.790

关注点分离

## 更喜欢聚合而不是 Mixin 风格的继承

虽然可以通过从实用程序类继承来获得功能，但在许多情况下，它都可以通过使用所述类的成员来获得。

### 示例（Boost.Noncopyable）：

Boost.Noncopyable 是一个缺少复制构造函数或赋值运算符的 C++ 类。它可以用作基类，以防止子类被复制或分配（这是常见的行为）。它也可以用作直接成员

转换这个：

```
class Foo : private boost::noncopyable { ... }; 
```

对此：

```
class Foo {
    ...
private:
    boost::noncopyable noncopyable_;
}; 
```

### 示例（可锁定对象）：

Java 引入了`synchronized`关键字作为习惯用法，以允许以线程安全的方式使用任何对象。这可以在其他语言中进行镜像，以向任意对象提供互斥锁。一个常见的例子是数据结构：

```
class ThreadsafeVector<T> : public Vector<T>, public Mutex { ... }; 
```

相反，这两个类可以聚合在一起。

```
struct ThreadsafeVector<T> {
    Vector<T> vector;
    Mutex mutex;
} 
```

## 目标

继承经常被滥用为代码重用机制。如果继承用于除 Is-A 关系之外的任何内容，则整体代码清晰度会降低。

随着更深的链，mixin 基类大大增加了“死亡钻石”场景的可能性，其中子类最终继承了 mixin 类的多个副本。

## 适用性

任何支持多重继承的语言。

## 例外

mixin 类提供或需要重载成员的任何情况。在这种情况下，继承通常意味着 Is-Implemented-In-Terms-Of 关系，并且聚合是不够的。

## 异议

这种转换的结果可能会导致公共成员（例如，`MyThreadSafeDataStructure`可能有一个可公开访问`Mutex`的组件）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T18:32:51.393

我认为简短的回答是“好的”面向对象设计在变化下是健壮的，对于任何需求变化的代码破坏最少。如果您考虑所有通常的规则，它们都会得出相同的结论。

困难在于你无法在没有上下文的情况下评估设计的“好”；我相信，对于任何模块化来说，都会存在一个定理，要求的变化将最大限度地破坏，导致每个类在每个方法中都被触及。

如果你想严谨一点，你可以开发一个“变更案例”的集合，并按照概率顺序对它们进行排序，这样就可以最大限度地减少最高概率变更的破坏。

但是，在大多数情况下，一些成熟的直觉会大有帮助：特定于设备或特定于平台的事物往往会发生变化，业务规则和业务流程往往会发生变化，而算术的实现则很少发生变化。（不是，正如您想象的那样，永远不会。例如，考虑一个可能或可能无法使用平台支持的 BCD 算法的业务系统。）

# python - 如何以可以在单个命令中运行所有测试的方式组织 python 测试？

> ID：366720
> 
> 赞同：16
> 
> 时间：2008-12-14T16:52:50.563
> 
> 标签：python, unit-testing, python-nose

目前我的代码按以下树形结构组织：

```
src/
    module1.py
    module2.py
    test_module1.py
    test_module2.py
    subpackage1/
        __init__.py
        moduleA.py
        moduleB.py
        test_moduleA.py
        test_moduleB.py 
```

其中`module*.py`文件包含源代码，并且`test_module*.py`包含`TestCase`相关模块的 s。

使用以下命令，我可以运行包含在单个文件中的测试，例如：

```
$ cd src
$ nosetests test_filesystem.py
..................
----------------------------------------------------------------------
Ran 18 tests in 0.390s

OK 
```

如何运行所有测试？我试过了，`nosetests -m 'test_.*'`但它不起作用。

```
$cd src
$ nosetests -m 'test_.*'

----------------------------------------------------------------------
Ran 0 tests in 0.000s

OK 
```

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-14T18:41:31.313

你是否分开或混合测试和模块可能是一个品味问题，尽管我强烈主张将它们分开（设置原因，代码统计等）。

当您使用鼻子测试时，请确保所有带有测试的目录都是真实的包：

```
src/
    module1.py
    module2.py
    subpackage1/
        __init__.py
        moduleA.py
        moduleB.py
tests/
    __init__.py
    test_module1.py
    test_module2.py
    subpackage1/
        __init__.py
        test_moduleA.py
        test_moduleB.py 
```

这样，您只需`nosetests`在顶层目录中运行，就会找到所有测试。但是，您需要确保它`src/`位于 上`PYTHONPATH`，否则所有测试都将由于缺少导入而失败。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-16T23:28:39.533

如果他们都开始，`test`那么就`nosetest`应该工作。Nose 会自动搜索以“test”开头的任何文件。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-15T08:15:09.767

我不知道鼻子测试，但你可以用标准的单元测试模块来实现。你只需要`test_all.py`在你的根目录下创建一个文件，然后导入你所有的测试模块。在你的情况下：

```
import unittest
import test_module1
import test_module2
import subpackage1
if __name__ == "__main__":
    allsuites = unittest.TestSuite([test_module1.suite(), \
                                test_module2.suite(), \
                                subpackage1.test_moduleA.suite(), \
                                subpackage1.test_moduleB.suite()]) 
```

每个模块都应提供以下功能（例如带有两个单元测试的模块：`Class1`和`Class2`）：

```
def suite():
    """ This defines all the tests of a module"""
    suite = unittest.TestSuite()
    suite.addTest(unittest.makeSuite(Class1))
    suite.addTest(unittest.makeSuite(Class2))
    return suite
if __name__ == '__main__':
   unittest.TextTestRunner(verbosity=2).run(suite()) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-14T17:37:18.680

这可能是一个激烈争论的话题，但我建议您将测试与模块分开。设置这样的东西...

用于`setup.py`将这些安装到系统路径中（或者您可以修改环境变量以避免需要“安装”步骤）。

```
foo/
    module1.py
    module2.py
    subpackage1/
        __init__.py
        moduleA.py
        moduleB.py 
```

现在任何地方的任何 python 脚本都可以访问这些模块，而不是依赖于在本地目录中找到它们。像这样把你的测试放在一边：

```
tests/
    test_module1.py
    test_module2.py
    test_subpackage1_moduleA,py
    test_subpackage2_moduleB.py 
```

我不确定你的`nosetests`命令，但现在你的测试都在同一个目录中，编写一个简单地导入同一个目录中的所有其他测试的包装脚本变得容易得多。或者，如果这不可能，您至少可以摆脱一个简单的`bash`循环，一个一个地获取您的测试文件：

```
#!/bin/bash
cd tests/
for TEST_SCRIPT in test_*.py ; do
    nosetests -m $TEST_SCRIPT
done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-14T18:32:47.073

我会给出一个[Testoob](http://www.testoob.org)的答案。

在单个文件中运行测试就像鼻子：

```
testoob test_foo.py 
```

要在许多文件中运行测试，您可以使用 Testoob 收集器创建套件（在每个子包中）

```
# src/subpackage?/__init__.py
def suite():
  import testoob
  return testoob.collecting.collect_from_files("test_*.py") 
```

和

```
# src/alltests.py
test_modules = [
    'subpackage1.suite',
    'subpackage2.suite',
]

def suite():
    import unittest
    return unittest.TestLoader().loadTestsFromNames(test_modules)

if __name__ == "__main__":
    import testoob
    testoob.main(defaultTest="suite") 
```

我没有尝试过你的具体情况。

# visual-studio - 在 Visual Studio.NET 2005 中无法打开 minidump 文件 (*.dmp)？

> ID：366728
> 
> 赞同：1
> 
> 时间：2008-12-14T16:57:00.103
> 
> 标签：visual-studio, minidump

我已经使用 win32 api [DllImport("DbgHelp.dll", SetLastError = true)] 创建了一个小型转储 private static extern bool MiniDumpWriteDump(

dmp 文件创建成功。

我正在尝试在另一个 Visual Studio 实例中打开此 *.dmp 文件以找到崩溃的位置，

在 Visual Studio --> 文件 --> 打开项目中，dmp 文件选项不可用。

我在文件打开菜单中选择了所有文件，然后打开了 dmp 文件。但我无法调试，

知道为什么我在 Visual Studio 中的转储文件选项被禁用。

我知道我可以使用 windbg 和其他工具，我可以轻松使用 Visual Studio，因为它可供我使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T18:48:54.683

我不是百分百确定。但是，我认为即使您在 VisualStudio 中打开它，VS 也不支持 WinDbg 用于分析 dmp 的命令的一半。所以，我会坚持使用 WinDbg。WinDbg 是免费下载的......所以你也可以使用它。它不是最容易使用的，我总是要打开帮助才能找到我想要的命令，但它确实做得很好。

在此处下载 32 位：http:
[//www.microsoft.com/whdc/devtools/debugging/installx86.Mspx](http://www.microsoft.com/whdc/devtools/debugging/installx86.Mspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T19:54:19.450

听起来您正在正确打开转储。

这是 Visual Studio 帮助文件中的内容：

> "打开转储文件 在“文件”菜单上，单击“打开”，然后单击“项目”。
> 
> 在“打开项目”对话框中，找到并选择转储文件。
> 
> 它通常具有 .dmp 扩展名。
> 
> 单击确定。
> 
> 要查找用于调试故障转储的二进制文件，Visual Studio 2005 会查找符号搜索路径。要确保 Visual Studio 2005 找到二进制文件，您可以在“选项”对话框或“模块”窗口中添加符号搜索路径。有关更多信息，请参阅如何：指定符号路径。”

你自己说，

> “...并打开了 dmp 文件。但我无法调试”

所以你在 Visual Studio 中打开转储文件 OK，但你的意思是，“我无法调试？”

如果看不到源代码，那是因为 Visual Studio 不知道它在哪里。按照说明设置符号搜索路径。

如果您无法单步执行您的代码，那是因为您无法使用小型转储来执行此操作。产生 minidump 的进程已经消失，无法进一步执行。

如果您无法检查调用堆栈或变量内容，那是因为 Visual Studio 找不到包含调试信息的 .pdb 文件。

# c++ - 在 OpenGL 中创建环境堆栈

> ID：366742
> 
> 赞同：2
> 
> 时间：2008-12-14T17:11:36.737
> 
> 标签：c++, c, opengl, abstraction

我想在 OpenGL 中创建一个类似于矩阵堆栈的环境设置（混合、模板、深度等）的抽象。压入堆栈，进行所需的任何更改，绘制对象，然后弹出堆栈并返回之前的设置。

例如，目前你可能有这样的绘图代码：

```
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
glDisable(GL_DEPTH_TEST);
//Draw operations
glEnable(GL_DEPTH_TEST);
glDisable(GL_BLEND); 
```

但是使用环境堆栈，它看起来像这样：

```
glPushEnv();
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
glDisable(GL_DEPTH_TEST);
//Draw operations
glPopEnv(); 
```

在我看来，只有两种方法可以做到这一点：

1.  为每个环境设置函数创建我自己的“风格”并调用它。它将依次更新当前的 EnvStack 数据结构并调用 OpenGL 环境函数。
2.  更改 OpenGL 环境函数以指向**我的**环境函数，这将再次更新当前的 EnvStack 数据结构并调用原始的 OpenGL 环境函数。

所以选项1显然要简单得多。但是，如果我使用其他人的代码，我会遇到一个问题，因为我不一定知道它对环境做出了什么改变，因此我的数据结构会不同步。而且由于重点是有一个简单的方法来确保环境设置正确，这并不酷。

所以我的问题是，在这种情况下，如何更改 OpenGL 环境函数指向的函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-14T17:39:26.447

OpenGL 已经包含此功能。你想要`glPushAttrib(GL_ALL_ATTRIB_BITS);`和`glPopAttrib();`。有关更多信息，请参阅[http://opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/pushattrib.html](http://opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/pushattrib.html)。

# outlook - 我可以访问 VBA 中的 Outlook 电子邮件联系人字段吗？

> ID：366758
> 
> 赞同：3
> 
> 时间：2008-12-14T17:23:48.333
> 
> 标签：outlook

我想在 Outlook 中访问电子邮件（电子邮件选项）上的联系人字段。通常，此字段将电子邮件与联系人联系起来。由于它是选项对话框中可用的自由格式文本字段，因此我尝试使用它来为我的电子邮件存储“下一步操作”。我想根据主题设置下一个操作，但我不知道如何从 outlook.mailitem 对象访问该字段

谢谢吉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T19:23:50.837

我认为这会回答这个问题：该字段被埋在半通用的“链接”属性中，具有 olContact 类型。要测试以下代码，请打开一封新电子邮件，在联系人字段中输入一些内容，然后运行代码：

```
Sub ShowContactsField()
  Dim objApp As Outlook.Application
  Dim ActiveMailItem As Inspector
  Dim currLink As Link

Set objApp = CreateObject("Outlook.Application")
  If TypeName(objApp.ActiveWindow) = "Inspector" Then
    If objApp.ActiveInspector.CurrentItem.Class = olMail Then
      For Each currLink In objApp.ActiveInspector.CurrentItem.Links
        If currLink.Type = olContact Then
          MsgBox currLink.Name
        End If
      Next
    End If
  End If
  Set objApp = Nothing
End Sub 总的来说，我同意奥利弗的观点；这可能不是存储您要查找的内容的最佳位置，但至少它以本机形式公开。检查字段长度，我认为它可能限制为 255。

            回答 #2

赞同：0

时间：2008-12-19T08:52:57.597

Hmm, I also couldn't figure out how to access the Contacts field but from your description it sounds like you're not intending to use it for its intended purpose at all but rather just have the need to associate some arbitrary string data with an email item. If that is correct, I would recommend adding fields to the `UserProperties` collection instead.

            回答 #3

赞同：0

时间：2009-07-14T20:17:39.733

有更简单的方法来获取联系人列表 - 通过使用 oMailItem 对象的 Links 属性：

```
 For i = 1 To mailItem.Links.Count
        If mailItem.Links.item(i).Type = olContact Then
                Debug.Print mailItem.Links.item(i).Name
        End If
Next i 
```

        linq-to-sql - LINQ 到 SQL

ID：366766

赞同：3

时间：2008-12-14T17:30:18.430

标签：linq-to-sql

在尝试使用 LINQ to SQL 时，我遇到了几个问题。

**我有餐桌人员：**

*   整数ID
*   字符串名字
*   字符串姓氏

**并且表格注释具有：**

*   整数ID
*   字符串注释文本
*   字符串创建者
*   日期时间创建日期
*   整数个人ID

PersonID 是外键，关系是 1:n

我尝试使用 LINQ to SQL 为每个人创建一个人和一些注释。

```
Person person =  new person();
Person.firstName = "me";
Person.note = new note();   
Person.note.noteText = "some text…"; 

_DataContext.Persons.InsertOnSubmit(person);   
_DataContext.SubmitChanges(); 
```

问题是数据库中尚不存在 person 对象，因此它还没有 ID。所以note.personID字段的值为0……（id字段是sql server中的一个identity字段）

我找到的唯一解决方案是创建一个人，提交更改，然后创建一个注释并再次提交更改。

我是否在这里遗漏了一些东西，或者也许这就是使用 LINQ to SQL 的方式？

如何使用 LTS 为每个人添加多个笔记？我有一个 1:n 的关系，我看不到它与 LTS。

如果一个人有 10000 条笔记，我不希望 person 对象构造函数加载他拥有的所有笔记。我只想在引用它们时加载它们。如何配置 LTS 以按需加载笔记？

            回答 #1

赞同：3

时间：2008-12-14T18:48:41.110

如果您不使用 LinqToSql 类设计器，则应该考虑使用它。它生成的类将支持您概述的插入方案。

我可以告诉你没有使用设计器，因为它会给你一个关于 Person 的 Notes（复数）属性......因为 Person 是 1 到 Many with Notes。

如何配置 LTS 以按需加载笔记？

设计器将生成一个 EntitySet(Note) 类型的属性，它将按需加载 Notes。

        c++ - 在 C++ (win32) 中将位图转换为内存中的 PNG

ID：366768

赞同：19

时间：2008-12-14T17:34:31.790

标签：c++, winapi, png

我可以仅使用 Platform SDK 将内存中的位图转换为 PNG（即不写入文件）吗？（即没有libpng等）。

我还希望能够为此图像定义透明颜色（不是 Alpha 通道）。

**GdiPlus 解决方案似乎仅限于宽度可被 4 整除的图像**。在调用 Save() 期间，其他任何事情都会失败。有谁知道这个限制的原因以及我如何/是否可以解决它？

**更新：赏金**

我开始赏金（我真的希望这个工作）。我实现了 GDI+ 解决方案，但正如我所说，它仅限于四边形宽度的图像。赏金将颁发给任何能够解决此宽度问题（不更改图像尺寸）或可以提供替代的非 GDI+ 解决方案的人。

            回答 #1

赞同：20

时间：2009-02-14T19:31:05.200

[LodePNG](https://lodev.org/lodepng/) ( [GitHub](https://github.com/lvandeve/lodepng) ) 是一个无库的 PNG 编码器/解码器。

            回答 #2

赞同：15

时间：2009-02-11T20:57:32.147

[我使用libpng](http://www.libpng.org/pub/png/libpng.html)读写 PNG ，它似乎可以处理我扔给它的所有东西（我在单元测试中使用了它，比如 257x255 图像，它们不会造成任何麻烦）。我相信[API](http://www.libpng.org/pub/png/libpng-1.2.5-manual.html)足够灵活，不会被绑定到文件 I/O（或者至少您可以覆盖其默认行为，例如参见[自定义](http://www.libpng.org/pub/png/libpng-1.2.5-manual.html#section-5)`png_set_write_fn`部分）

在实践中，我总是通过更干净的[boost::gil ](http://www.boost.org/doc/libs/1_38_0/libs/gil/doc/index.html) [PNG IO 扩展](http://stlab.adobe.com/gil/html/group___p_n_g___i_o.html)来使用它，但不幸的是，它需要`char*`文件名，如果你深入研究它的实现中的`png_writer`和`file_mgr`类，它似乎与它非常相关`FILE*`（尽管如果你在 Linux 上使用的版本fmemopen 和内存缓冲区可能很容易被煮熟）。

            回答 #3

赞同：12

时间：2008-12-14T17:54:49.613

在此站点上，代码显示了如何将位图转换为 PNG 并将其写入文件：[http](http://dotnet-snippets.de/dns/gdi-speichern-eines-png-SID814.aspx) ://dotnet-snippets.de/dns/gdi-speichern-eines-png-SID814.aspx 。除了写入文件，`Save`Bitmap 的方法还支持写入`IStream`（[http://msdn.microsoft.com/en-us/library/ms535406%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms535406%28VS.85%29.aspx)）。`CreateStreamOnHGlobal`您可以使用API 函数创建由内存备份的 Stream 。（[http://msdn.microsoft.com/en-us/library/aa378980%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa378980%28VS.85%29.aspx)）。使用的库 GDI+ 包含在 Windows XP 以上的 Windows 中，并且可以在 Windows 98 以上的 Windows 中运行。我从来没有用它做过什么，只是用谷歌搜索了一下。不过，看起来你可以使用它。

            回答 #4

赞同：8

时间：2009-02-12T10:40:09.207

CImage 类 (ATL/MFC) 支持保存为 PNG 格式。与 GDI+ 解决方案一样，它也支持保存到流。这是我用来将其保存到 CByteArray 的一些代码：

```
CByteArray baPicture;
IStream *pStream = NULL;
if (CreateStreamOnHGlobal(NULL, TRUE, &pStream) == S_OK)
{
    if (image.Save(pStream, Gdiplus::ImageFormatPNG) == S_OK)
    {
    ULARGE_INTEGER ulnSize;
        LARGE_INTEGER lnOffset;
        lnOffset.QuadPart = 0;
        if (pStream->Seek(lnOffset, STREAM_SEEK_END, &ulnSize) == S_OK)
        {
            if (pStream->Seek(lnOffset, STREAM_SEEK_SET, NULL) == S_OK)
            {                       
                baPicture.SetSize(ulnSize.QuadPart);
                ULONG ulBytesRead;
                pStream->Read(baPicture.GetData(), ulnSize.QuadPart, &ulBytesRead);
            }
        }
    }
}
pStream->Release(); 
```

不过，我不知道您是否想使用 ATL 或 MFC。

            回答 #5

赞同：6

时间：2008-12-14T18:38:26.920

我使用 GDI+ 将位图作为 PNG 保存到文件中。[您可能应该在此处查看](http://msdn.microsoft.com/en-us/library/ms533798(VS.85).aspx)有关 GDI+ 的 MSDN 信息，尤其是此功能[GdipSaveImageToStream](http://msdn.microsoft.com/en-us/library/ms534041(VS.85).aspx)。

[此处](http://www.mvps.org/user32/gditutorial.html)的本教程可能也会提供一些帮助。

            回答 #6

赞同：5

时间：2009-02-11T19:57:51.497

GDI（老派，非加号）有一种`GetDIBits`方法可以要求使用 PNG 压缩（`BITMAPINFOHEADER::biCompression`  == `BI_PNG`）输出位。我想知道这是否可以用来创建PNG文件？用于`GetDIBits`编写标准位图文件已经足够复杂了——所以我怀疑这会更加困难。

            回答 #7

赞同：3

时间：2009-02-12T03:34:06.903

如果您只想使用 Windows API，[WIC](http://msdn.microsoft.com/en-us/library/ee719654)是实现此目的的方法，它同时支持位图和 PNG。

            回答 #8

赞同：2

时间：2008-12-14T17:51:11.553

使用库而不是自己重新发明轮子可能会更好。

查看[freeImage](http://freeimage.sourceforge.net/)

        winapi - 使用 Windbg 获取第 3 方模块的列表？

ID：366772

赞同：2

时间：2008-12-14T17:38:55.557

标签：winapi, windbg, crash-dumps

我正在使用 windbg 检查应用程序发送的一些故障转储。我看到的崩溃与将某个第 3 方 DLL 加载到进程中（我怀疑是一个不稳定的 Winsock LSP）之间似乎存在某种关联。为了让这种分析在未来更容易，是否有一个 windbg 脚本可以显示非 Microsoft 模块的列表？这将使崩溃之间的模式对我来说更加明显。我正在使用“lm D sm”，但现在手动浏览列表很痛苦。

谢谢！

            回答 #1

赞同：3

时间：2008-12-22T20:23:50.240

尝试使用“lm e”并将您的符号路径设置为 Microsoft 的符号服务器（并且仅加载 MS 符号）。这将导致 WinDbg 显示具有任何类型的符号“问题”的所有模块的列表，包括尚未加载的模块。

完成这项工作的关键是：

1.  sympath 仅设置为使用 MS 符号存储（使用“.symfix”来实现此目的）
2.  已使用上述 sympath 加载符号

从那里您可以添加“lm”的其他选项以获取完整路径等信息。

            回答 #2

赞同：1

时间：2008-12-14T19:23:32.430

您可以使用 cdb 编写调试器脚本，它只打印到标准输出 - 打开故障转储，让它打印加载的模块列表然后退出，然后您可以使用您最喜欢的文本操作工具（提示：它的名称是 Perl ;)）搜索列表。

编辑：只是为了添加一些额外的信息，cdb 是 WinDbg 的命令行版本；他们都使用相同的引擎，只是前端不同。

            回答 #3

赞同：0

时间：2008-12-14T19:25:05.423

我不确定我明白你为什么要这样做，但你可以从 WinDbg 输出到日志并与 DLL 列表相关联。这在任何脚本语言（如 Perl、Python 等）中都很容易做到。

            回答 #4

赞同：0

时间：2009-07-26T19:27:28.413

不久前，我编写了一个小型命令行应用程序来解决这个问题。

[http://www.sleep1000.com/software/dumpmod](http://www.sleep1000.com/software/dumpmod)

            回答 #5

赞同：0

时间：2009-02-21T22:19:44.103

我现在执行此操作的方式是从 Windows 调试工具安装的 CLR10 目录中运行**sos.dll 。**

```
.load clr10\sos
!sam c:\temp\modules 
```

我在 Windows 资源管理器中打开目录 c:\temp\modules。我右键单击标题列并添加公司列。然后我对公司进行排序并将带有“Microsoft Corporation”公司的DLL移动到一个名为“Microsoft”的单独子目录中

目录中留下的任何 DLL 通常是第 3 方或自定义开发的代码。

谢谢，亚伦

        sql-server - 从 VS 2008 添加到 SQL Server 2008 的数据连接

ID：366775

赞同：2

时间：2008-12-14T17:40:18.113

标签：sql-server, visual-studio

我正在尝试使用 Visual Studio 2008 在 SQL Server 2008 中添加到数据库的连接。在测试连接时，它说它是成功的。但是，一旦我说好的，它就会抱怨说：“无法添加数据连接。对象引用未设置为对象的实例。”

如何使用 Visual Studio 2008 向 SQL Server 2008 添加数据连接？

            回答 #1

赞同：1

时间：2008-12-14T18:25:37.443

通过代码将类似于：

```
var conn = new SqlConnection([connectionString]);
conn.Open(); 
```

            回答 #2

赞同：0

时间：2009-01-07T15:01:00.917

“对象引用未设置为对象的实例”通常表明未使用关键字“新建”。

        c# - 将 JavaScript 与 C# 一起用于非基于浏览器的操作

ID：366778

赞同：0

时间：2008-12-14T17:47:38.100

标签：c#, javascript

我最近不得不快速浏览一下 Adob​​e InDesign 服务器。在这个环境中，您通过 JavaScript 编写与服务器库的交互。

这让我开始思考，如何在 C# 应用程序中使用 Javascript 语言，以便我可以公开我的 API/框架的一些功能，并允许其他人使用 JavaScript 编写小型插件。

由于 JS 是一种非常流行的语言，所以我认为我不必编写自己的解释器或其他任何东西，但我可能错了。有什么想法可以从这样的事情开始吗？

干杯，克里斯。

            回答 #1

赞同：2

时间：2008-12-14T17:51:51.227

检查这个问题：

[从 .NET 应用程序引用 Google 的 V8 引擎](https://stackoverflow.com/questions/356948/referencing-googles-v8-engine-from-a-net-app)

这篇文章可能很有趣：

[从 C# 评估 JavaScript 代码](http://www.west-wind.com/WebLog/posts/10688.aspx)（使用 MS JScript 引擎）

            回答 #2

赞同：1

时间：2008-12-14T19:04:59.363

当 Microsoft 发布托管 JScript ( [http://blogs.msdn.com/deepak/archive/2007/05/02/managed-jscript-is-availaible.aspx](http://blogs.msdn.com/deepak/archive/2007/05/02/managed-jscript-is-availaible.aspx) )时，这将**变得容易得多**

如果您暂时不使用 Javascript，我会查看 IronPython ( [http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython) ) - 托管 API 与 Microsoft 将发布的相同JS 尽可能简单，并且在 3 种 DLR 语言（IPy、IronRuby 和托管 JS）之间切换是微不足道的。

编辑：哎呀，显然它现在作为 ASP.NET Futures 的一部分可用——我以为它只在 Silverlight 中；去吧！

            回答 #3

赞同：0

时间：2010-07-08T12:15:20.570

尝试 Javascript .NET：

[http://javascriptdotnet.codeplex.com/](http://javascriptdotnet.codeplex.com/)

它实现了谷歌 V8。您可以使用它直接从 .NET 代码编译和运行 Javascript，并提供 CLI 对象以供 Javascript 代码使用。就性能而言，V8 可能是有史以来最好的引擎，它从 Javascript 生成本机代码。

        php - 多词 PHP 数组替换

ID：366794

赞同：1

时间：2008-12-14T18:06:26.470

标签：php, arrays

```
<?php
$string = 'The quick brown fox jumped over the lazy dog.';
$patterns[0] = '/quick/';
$patterns[1] = '/brown/';
$patterns[2] = '/fox/';
$replacements[0] = 'slow';
$replacements[1] = 'black';
$replacements[2] = 'bear';
echo preg_replace($patterns, $replacements, $string);
?> 
```

好的，伙计们，现在我有了上面的代码。它运作良好。例如，现在我也想用“慢”替换“懒惰”和“狗”我现在要做的是看起来像这样，对吧？

```
<?php
$string = 'The quick brown fox jumped over the lazy dog.';
$patterns[0] = '/quick/';
$patterns[1] = '/brown/';
$patterns[2] = '/fox/';
$patterns[3] = '/lazy/';
$patterns[4] = '/dog/';
$replacements[0] = 'slow';
$replacements[1] = 'black';
$replacements[2] = 'bear';
$replacements[3] = 'slow';
$replacements[4] = 'slow';
echo preg_replace($patterns, $replacements, $string);
?> 
```

行。

所以我的问题是，有什么办法我可以这样做

```
$patterns[0] = '/quick/', '/lazy/', '/dog/';
$patterns[1] = '/brown/';
$patterns[2] = '/fox/';
$replacements[0] = 'slow';
$replacements[1] = 'black';
$replacements[2] = 'bear'; 
```

谢谢

            回答 #1

赞同：2

时间：2008-12-14T18:10:23.530

您可以将管道用于[“交替”](http://perldoc.perl.org/perlre.html#Regular-Expressions)：

```
$patterns[0] = '/quick|lazy|dog/'; 
```

            回答 #2

赞同：2

时间：2008-12-14T20:47:14.367

为什么不使用 str_replace ？

```
$output = str_replace(array('quick', 'brown', 'fox'), array('lazy', 'white', 'rabbit'), $input) 
```

            回答 #3

赞同：0

时间：2008-12-14T19:32:18.793

您也可以像这样分配数组：

```
$patterns = array('/quick/','/brown/','/fox/','lazy/',/dog/'); 
```

当然分配 0-4

        javascript - 如何使用 javascript 或 jquery 更改 html 元素的 css 属性

ID：366805

赞同：1

时间：2008-12-14T18:18:48.880

标签：javascript, jquery, css, jquery-ui, jquery-ui-dialog

我怎样才能`CSS`从`javascript`.

我正在使用`jQuery-ui Dialog`并且我想`DIV`从 javascript 更改 a 的样式。

谢谢

            回答 #1

赞同：8

时间：2008-12-14T18:23:27.230

查看[jQuery 文档](http://docs.jquery.com/CSS/css)。如果你想要什么，它就会在那里。

总之，如果你想给元素添加样式，你需要使用这个`css`函数，它有几个变种。

```
$(selector).css(properties);  // option 1
$(selector).css(name, value); // option 2 
```

所以如果你有一个 ID 为“mydiv”的 DIV 并且你想让背景变成红色，你会这样做

```
$("div#mydiv").css({'background-color' : 'red'}); // option 1
$("div#mydiv").css('background-color','red');     // option 2 
```

如果您一次设置多个东西，第一种方法会更容易。

如果要检查当前设置的属性，可以使用第二个选项的变体，只需省略该值。

```
var color = $("div#mydiv").css('background-color'); 
```

例如，如果您已经在上面设置了它，则将使 var`color`成为。`red`

您还可以添加和删除类，执行类似的操作

```
$(selector).addClass(class_name);
$(selector).removeClass(class_name); 
```

            回答 #2

赞同：2

时间：2008-12-14T18:32:12.033

*即使没有 jQuery，这个答案也有效。*

所以你有这样的事情：

```
<style type="text/css">
    .foo { color: Red; }
    .bar { color: Blue; }
</style>
<div class="foo" id="redtext"> some red text here </div> 
```

如果您只想更改某些属性，您始终可以使用

```
var div = document.getElementById('redtext'); 
```

功能，然后通过更改附加的颜色样式

```
div.style.color = 'Green'; 
```

使您的红色文本显示为绿色。

如果要将为 div 定义的类更改为另一个样式类，可以执行以下操作：

```
div.className = 'bar'; 
```

使 div 现在使用类栏，这会使您以前的绿色文本变为蓝色。

            回答 #3

赞同：1

时间：2008-12-14T18:22:28.293

有几种方法可以使用 jQuery 框架来操作元素样式。查看与 CSS 和更改属性相关的文档：

*   [http://docs.jquery.com/Attributes/addClass#class](http://docs.jquery.com/Attributes/addClass#class)
*   [http://docs.jquery.com/CSS](http://docs.jquery.com/CSS)

            回答 #4

赞同：0

时间：2017-05-29T10:13:34.980

试试这个。这是 jquery 代码。

```
 $("myDiv").css({"color":"red","display":"block"}) 
```

如果你使用 vanila javacript，试试这个。

```
var myDiv = document,getElementById("myDiv");

myDiv.style.display = "block";

myDiv.style.color = "red"; 
```

        regex - 正则表达式：懒惰更糟吗？

ID：366822

赞同：12

时间：2008-12-14T18:36:08.577

标签：regex, regex-greedy, non-greedy, reluctant-quantifiers

我一直写这样的正则表达式

```
<A HREF="([^"]*)" TARGET="_blank">([^<]*)</A> 
```

但是我刚刚了解到这个[懒惰的东西](http://www.regular-expressions.info/examples.html)，我可以这样写

```
<A HREF="(.*?)" TARGET="_blank">(.*?)</A> 
```

使用第二种方法有什么缺点吗？正则表达式肯定更紧凑（甚至 SO 也能更好地解析它）。

**编辑**：这里有两个最佳答案，指出表达式之间的两个重要区别。ysth 的回答指出了非贪婪/懒惰的弱点，其中超链接本身可能包含 A 标签的其他属性（绝对不好）。Rob Kennedy 指出了贪婪示例中的一个弱点，即锚文本不能包含其他标签（绝对不行，因为它也不会抓取所有锚文本）......所以答案是，正则表达式就是他们是，看似相同的惰性和非惰性解决方案可能在语义上并不等效。

**编辑**：第三个最佳答案是 Alan M 关于表达式的相对速度。暂时，我会将他标记为最佳答案，以便人们给他更多积分:)

            回答 #1

赞同：12

时间：2008-12-15T01:57:52.400

要考虑的另一件事是目标文本有多长，以及量化子表达式将匹配多少。例如，如果您尝试匹配大型 HTML 文档中的整个 <BODY> 元素，您可能会想使用这个正则表达式：

```
/<BODY>.*?<\/BODY>/is 
```

但这会做很多不必要的工作，一次匹配一个字符，同时在每个字符之前有效地进行负前瞻。您知道 </BODY> 标记将非常接近文档的末尾，因此明智的做法是使用正常的贪婪数量；让它吞噬整个文档的其余部分，然后回溯匹配结束标记所需的几个字符。

在大多数情况下，您不会注意到贪婪量词和不情愿量词之间的任何速度差异，但请记住这一点。你应该明智地使用不情愿量词的主要原因是其他人指出的：他们可能不情愿地这样做，但如果这是实现整体所需的，他们会比你想要的更多。匹配。

            回答 #2

赞同：8

时间：2008-12-14T19:51:33.030

补充字符类更严格地定义了您要匹配的内容，因此只要可以，我就会使用它。

非贪婪的正则表达式将匹配您可能不想要的东西，例如：

```
<A HREF="foo" NAME="foo" TARGET="_blank">foo</A> 
```

你的第一个.*在哪里？火柴

```
foo" NAME="foo 
```

            回答 #3

赞同：7

时间：2008-12-14T19:16:50.447

请注意，您的示例不等效。您的第一个正则表达式不会选择任何包含其他标签的链接，例如`img`或`b`。第二个正则表达式会，我希望这可能是你想要的。

除了含义上的差异之外，我能想到的唯一缺点是对非贪婪修饰符的支持并不像字符类否定那样普遍。[在我检查之前，它的支持比我想象的要广泛，但值得注意的是 GNU Grep 不在列表中。](http://en.wikipedia.org/wiki/Comparison_of_regular_expression_engines)如果您使用的正则表达式评估器支持它，那么继续使用它。

            回答 #4

赞同：3

时间：2008-12-14T18:40:29.583

这不是更好或更坏。我见过最多的术语是贪婪与非贪婪，但无论你怎么说，它们都会做两件不同的事情。您想为任务使用正确的。即，当您不想在一行中捕获多个匹配项时，请关闭贪婪选项。

            回答 #5

赞同：1

时间：2008-12-14T18:40:22.080

“懒惰”在这里是错误的词。你的意思是非贪婪而不是贪婪。据我所知，使用它没有缺点。但是在您的特殊情况下，它也不应该*更*有效。

            回答 #6

赞同：1

时间：2008-12-14T18:42:38.050

不贪婪更好，不是吗？它向前工作，每次检查匹配并在找到匹配时停止，而正常的 kleene 闭包 (*) 向后工作，匹配输入的其余部分并删除内容，直到找到匹配。

最后，他们做不同的事情，但我认为非贪婪胜过贪婪。请记住，我没有对此进行测试，但现在我很好奇。

        c# - 是否可以以编程方式“清理”电子邮件？

ID：366834

赞同：4

时间：2008-12-14T18:44:11.010

标签：c#, .net, email, email-processing

有人对我如何清理传入电子邮件的正文有任何建议吗？我想删除免责声明、图像以及可能存在的任何以前的电子邮件文本，这样我就只剩下正文内容了。我的猜测是不可能以任何可靠的方式实现，但是有人尝试过吗？是否有任何图书馆适合这种事情？

            回答 #1

赞同：5

时间：2008-12-14T19:06:08.067

在电子邮件中，有几个约定的标记表示您希望删除的内容。[您可以使用正则表达式](http://www.regular-expressions.info/)查找这些行。我怀疑你不能很好地“清理”你的电子邮件，但你可以寻找一些东西：

1.  以“>”开头的行（大于空格）标记一个引号
2.  带有“--”的行（两个连字符，然后是空格，然后是换行符）标志着签名的开始，请参阅[Wikipedia 上的签名块](http://en.wikipedia.org/wiki/Signature_block)
3.  多部分消息，边界以**--**开头，除此之外，您需要进行一些搜索以将消息正文部分与不需要的部分（如 base64 图像）分开

至于实际的 C# 实现，我将其留给您或其他 SOers。

            回答 #2

赞同：3

时间：2008-12-14T19:15:56.063

一些显而易见的事情要注意：  

1.  如果邮件不是纯文本，则邮件将是多部分的 mime。任何类型为“image/*”（image/jpeg 等）的部分都可能被删除。很可能任何类型不是“text/*”的部分都可以通过。  
2.  HTML 消息可能有一部分类型为“multipart/alternative”（我认为），并且有两部分，一个“text/plain”和一个“text/html”。这两个部分应该差不多，所以您可以删除 HTML 部分。如果唯一存在的部分是 HTML 位，您可能需要进行 HTML 到纯文本的转换。  
3.  引用文本的通常格式是在文本前加一个“>”字符。您应该能够删除这些行，除非该行以“>From”开头，在这种情况下，“>”已被插入以防止邮件阅读器认为“From”是新邮件的开始。  
4.  签名应该以“-- \r\n”开头，尽管很有可能缺少尾随空格。  

            回答 #3

赞同：2

时间：2008-12-14T20:49:50.447

OSBF-Lua 版本 3 有一个邮件解析库，它将处理 MIME 并将消息拆分为其 MIME 部分等等。我目前有一堆 Lua 脚本，它们可以做一些事情，比如忽略大多数非文本附件，喜欢纯文本而不是 HTML，等等。（我还在尝试保留引用时将长行换成了 80 个字符。）

至于删除以前引用的邮件，上面的建议都很好（你必须订阅一些无礼的邮件列表）。

可靠地删除免责声明可能会很困难。我的第一个选择是简单地维护一个免责声明库，该库将被从每封邮件的末尾剥离；我会编写一个脚本来方便我添加到库中。对于更复杂的东西，我会尝试某种机器学习。

自 2007 年 2 月以来，我一直致力于垃圾邮件过滤，我了解到与电子邮件有关的任何事情都是一团糟。一个好的经验法则是，无论你想做什么都比你想象的要难得多:-(

            回答 #4

赞同：1

时间：2008-12-14T21:08:44.510

鉴于您的问题“是否可以以编程方式'清理'电子邮件？”，我会回答“不，不可靠”。

你面临的危险并不是真正的技术危险，而是社会学危险。

很容易发现和过滤掉消息的某些方面——比如图像。同样，过滤掉签名和免责声明也是可能的（尽管更具挑战性）。

真正的问题是错误的代价。

如果您的过滤器恰好删除了消息的关键部分，会发生什么？您可以追溯它以找到丢失的部分，还是您的过滤具有破坏性？更糟糕的是，你会注意到这件作品丢失了吗？

几年前我看过一个经典的喜剧小品就说明了这一点。两个人一起在汽车上工作。一个在下面做工作，另一个坐在附近阅读服务手册的说明——很明显，两个人都不知道自己在做什么，但他们正在尽力而为。

手动的家伙，大声朗读：“取消油底壳中心的粗体......” [翻页]

工具人：“好的，出来了。”

手动的家伙：“……在任何情况下。”

            回答 #5

赞同：0

时间：2008-12-14T18:47:21.503

如果您创建自己的应用程序，我会查看正则表达式，查找文本并替换它。为了使应用程序更好一点，我将创建一个名为 Email 的类，在该类中我有一个名为 RAW 的属性和一个名为 Stripped 的属性。

只是一些提示，当您查看正则表达式时，您将收集其余部分！

            回答 #6

赞同：0

时间：2019-11-22T21:16:56.847

[SigParser](https://sigparser.com/developers/extract-reply-chains-from-emails/)有一个可以在 .NET 中使用的程序集。它以 HTML 和文本形式为您提供了正文，而其余的东西被剥离了。如果您给它一个 HTML 电子邮件，它会在需要时将电子邮件转换为文本。

```
var parser = new SigParser.EmailParsing.EmailParser();
var result = await parser.GetCleanedBodyAsync(new SigParser.EmailParsing.Models.CleanedBodyInput {
    FromEmailAddress = "john.smith@example.com",
    FromName = "John Smith",
    TextBody = @"Hi Mark,
This is my message.

Thanks
John Smith
888-333-4434"
            });

// This would print "Hi Mark,\r\nThis is my message."
Console.WriteLine(result.CleanedBodyPlain); 
```

        python - 如何本地化 Django 应用程序的内容

ID：366838

赞同：9

时间：2008-12-14T18:48:49.707

标签：python, django, localization, internationalization

嘿，我目前正在为我的学习开发一个 django 应用程序，并达到了 l18n 的程度。本地化网站本身非常容易，但现在我必须允许用户翻译应用程序的动态内容。用户可以在数据库中保存“产品”并为其命名和描述，但由于整个站点都应该本地化，我必须提供一种将这些名称和描述翻译给用户的方法。

django 中是否有一种自然的方法可以做到这一点？还是我必须将其作为应用程序的一部分来实现（通过在数据模型中表示翻译）

谢谢， 亚诺施

            回答 #1

赞同：10

时间：2008-12-15T07:40:50.773

我建议查看[django-multilingual](http://code.google.com/p/django-multilingual/)。它是一个第三方应用程序，可让您在模型上定义翻译字段。

当然，您仍然需要输入实际的翻译，但它们透明地存储在数据库中（与静态 PO 文件相反），我相信这就是您要问的问题。

            回答 #2

赞同：5

时间：2008-12-16T10:15:17.963

我使用[django-multilingual](http://code.google.com/p/django-multilingual/)来本地化内容，使用[django-localeurl](http://code.google.com/p/django-localeurl/)来选择基于 url 的语言（例如 mypage/en/）。

您可以在[JewishKrakow.net](http://www.jewishkrakow.nwt/)页面上查看多语言和 localeurl 的工作原理。

            回答 #3

赞同：4

时间：2008-12-15T07:42:14.733

Django 中的可翻译内容有两个值得注意的项目：
 [http://code.google.com/p/django-multilingual/](http://code.google.com/p/django-multilingual/) 
[http://code.google.com/p/transdb/](http://code.google.com/p/transdb/)

            回答 #4

赞同：2

时间：2012-09-18T17:49:24.870

我的网站上有 2 种语言：英语和阿拉伯语 用户可以通过单击标志在语言之间切换。在模型中，我使用代理模型：

```
class Product(models.Model):
    name=models.CharField(max_length=100)
    name_ar=models.CharField(max_length=100, default='')

    def __unicode__(self):
        return self.name

class Product_ar(Product):
    def __unicode__(self):
        return self.name_ar
    class Meta:
        proxy=True 
```

在表单中，我使用 2 种形式而不是一种形式：

```
class CollectionEditForm_en(forms.Form):
    name = forms.CharField(label=_('Name'), max_length=100, widget=forms.TextInput(attrs={'size':'50'}))
    product = forms.ModelChoiceField(label=_('product'), queryset=Product.objects.filter(enabled=True), empty_label=None)

class CollectionEditForm_ar(forms.Form):
    name = forms.CharField(label=_('Name'), max_length=100, widget=forms.TextInput(attrs={'size':'50'}))
    product = forms.ModelChoiceField(label=_('product'), queryset=Product_ar.objects.filter(enabled=True), empty_label=None) 
```

以这种方式在代码检查语言中：

```
if request.LANGUAGE_CODE=='ar':
    CollectionEditForm=CollectionEditForm_ar
else:
    CollectionEditForm=CollectionEditForm_en 
```

所以在模板中我检查：

```
{% if LANGUAGE_CODE == "ar" %}
  <a href="/product/{{product.alias}}/">{{product.name_ar}}</a>
{% else %}
  <a href="/product/{{product.alias}}/">{{product.name}}</a>
{% endif %} 
```

希望这个解决方案能帮助某人

            回答 #5

赞同：1

时间：2008-12-14T23:00:27.967

“我必须提供一种将这些名称和描述翻译给用户的方法。”

“在 django 中是否有一种自然的方式来做到这一点？”

您是在问 Django 是否可以从一种语言翻译到另一种语言？您是否在询问类似[http://translate.google.com/](http://translate.google.com/)的内容？

我不认为 Django 可以将用户输入翻译成另一种语言。

如果您要为您的用户进行翻译，这必须是您的数据模型的一部分。

Django 的 i18n 过滤器允许您拥有一个翻译字符串表。[文档](http://docs.djangoproject.com/en/dev/topics/i18n/#topics-i18n)说明了这一点。

1.  在 Python 代码和模板中嵌入翻译字符串。  
2.  以您想要支持的任何语言获取这些字符串的翻译。  **这是您手动完成的事情，通过雇用翻译或自己了解很多语言。**
3.  在 Django 设置中激活区域设置中间件。

            回答 #6

赞同：0

时间：2008-12-14T21:43:39.840

这取决于谁将提供翻译。如果您想为翻译提供 Web 界面，那么您需要自己开发，并在数据库中表示翻译。

如果翻译网站的同一位翻译人员也翻译数据，您可以为他们提供与网站相同的模型（可能是 gettext），然后您也可以使用 gettext 来处理此内容。

            回答 #7

赞同：0

时间：2009-08-24T22:46:21.757

也在寻找内容本地化插件，或者如何编写它。可以添加到列表  [django-i18n-model](http://github.com/foxbunny/django-i18n-model/tree/master)

            回答 #8

赞同：0

时间：2010-10-06T08:22:18.363

我认为你应该分两步操作：

1.  获取翻译
2.  显示翻译的字符串

第一步，你应该告诉 Django 用户插入的字符串将被翻译。我认为没有本地方法可以做到这一点。也许您可以从数据库中提取字符串，将它们放入特定于语言环境的文件中，在它们上运行“makemessages”，获取 django.po 文件并进行翻译。

其次，使用 ugettext 在您的 Web 应用程序中显示这些字符串。

希望这可以帮助那些有同样问题的人。

            回答 #9

赞同：0

时间：2010-10-09T07:32:44.590

或者试试这个：

[http://packages.python.org/django-easymode/i18n/index.html](http://packages.python.org/django-easymode/i18n/index.html)

它与您通常使用 django 模型的方式非常接近，您只需在模型上方添加 1 个装饰器。它具有对翻译字段的管理员支持，包括内联和通用内联。几乎所有你可以用常规模型和管理类做的事情，你都可以用国际化版本做。

        backup - 如何在不关闭 Jackrabbit 的情况下备份 apache Jackrabbit 存储库？

ID：366842

赞同：8

时间：2008-12-14T18:54:03.503

标签：backup, jackrabbit, jcr

在您的应用程序中将 Apache Jackrabbit JCR 作为嵌入式服务运行时，是否有一种快速的方法可以在不关闭 Jackrabbit 的情况下获得对 Jackrabbit 存储库内容的健全且一致的备份？如果有怎么办？

            回答 #1

赞同：6

时间：2008-12-15T10:37:44.253

有关选项列表，请参阅[Jackrabbit Wiki 上的 BackupAndMigration 。](https://jackrabbit.apache.org/archive/wiki/JCR/BackupAndMigration_115513344.html)

我建议使用 XML 导出（系统视图），因为它是最简单的解决方案。此外，因为它是 JCR 标准的一部分，所以它也应该适用于其他 JCR 实现。

请注意，这种方法有一个缺点：目前无法重新导入完整的导出，即。从根节点开始，包括包含版本存储的 jcr:system 子节点，因为 jcr:system 部分，尤其是版本存储是不可写的（这主要是因为 JCR 没有指定如何导入版本）。这是Jackrabbit 邮件列表上的[一些解释。](http://markmail.org/message/fe7spq4lwaeo4vvm)

        algorithm - 生成字符串的随机固定长度排列

ID：366849

赞同：1

时间：2008-12-14T19:07:18.267

标签：algorithm, random

假设我的字母表包含 X 个字母，而我的语言只支持 Y 个字母单词（当然是 Y < X）。我需要以随机顺序生成所有可能的单词。

例如字母=a,b,c,d,e,f,g Y=3

所以这些词是：aaa aab aac aba .. bbb ccc .. （上面应该以随机顺序生成）

最简单的方法是生成单词，然后随机化列表。我不想那样做。我想以随机顺序生成单词。

rondom(n)=letter[x].random(n-1) 将不起作用，因为这样您将拥有一个以 letter[x].. 开头的单词列表，这将使列表不那么随机。

任何代码/伪代码表示赞赏。

            回答 #1

赞同：1

时间：2009-06-22T16:09:05.710

正如其他答案所暗示的那样，有两种主要方法：1）跟踪您已经生成的内容（此类别中的建议解决方案可能永远不会终止），或 2）跟踪尚未生成的排列（这意味着必须预先生成排列，这在要求中是明确不允许的）。这是另一种保证终止且不需要预生成的解决方案，但可能无法满足您的随机化要求（此时还很模糊）。  

一般概述：生成一棵树以跟踪已生成的内容或剩余的内容。通过遍历树中的随机链接来“选择”新的排列，在生成该排列后在叶子处修剪树以防止再次生成它。

如果没有白板来绘制图表，我希望这个描述足以描述我的意思：创建一个“节点”，它具有指向字母表中每个字母的其他节点的链接。这可以使用字母到节点的通用映射来实现，或者如果您的字母是固定的，您可以创建特定的引用。该节点表示字母表中的可用字母，接下来可以“生成”以生成排列。通过访问根节点开始生成排列，从该节点的可用字母中选择一个随机字母，然后遍历该引用到下一个节点。每次遍历都会为排列生成一个字母。当到达叶子时（即完全构造了一个排列），你' d 回溯树以查看父节点是否还有任何可用的排列；如果没有，则可以修剪父节点。

作为实现细节，节点可以存储在该点不能产生的字母集合或在那个点仍然可以产生的字母集合。为了可能减少存储要求，您还可以允许节点存储*带有*指示它正在执行的标志的标志，以便当节点允许超过一半的字母表时，它存储到目前为止产生的字母并切换到使用剩余的字母时可用的字母不到一半。

使用这样的树结构限制了无需预先生成所有组合即可生成的内容，因为您不需要预先构建整个树（可以在生成排列时构建它）并且您可以保证完成，因为清除节点（即，当这是未产生的排列的允许组合时，您只遍历到节点的链接）。

然而，我认为该技术的随机化有点奇怪，而且我认为在任何给定时间生成每种组合的可能性并不相同，尽管我还没有真正考虑过这一点。还可能值得注意的是，即使不一定要预先生成完整的树，所涉及的开销也可能足以使您最好预先生成所有排列。

            回答 #2

赞同：0

时间：2008-12-14T19:18:02.113

我认为您可以通过根据您拥有的字母（在 c# 中）生成一个随机字符数组来做一些非常简单的事情：

```
 char[] alphabet = {'a', 'b', 'c', 'd'};
        int wordLength = 3;

        Random rand = new Random();

        for (int i = 0; i < 5; i++)
        {
            char[] word = new char[wordLength];
            for (int j = 0; j < wordLength; j++)
            {
                word[j] = alphabet[rand.Next(alphabet.Length)];
            }
            Console.WriteLine(new string(word));
        } 
```

显然，这可能会产生重复，但如果需要，您可以将结果存储在 hashmap 或其他东西中以检查重复。

            回答 #3

赞同：0

时间：2009-06-22T15:21:14.167

所以我认为你想要的是使用尽可能少的内存来产生集合的排列。

首先，它不能不使用内存来完成。对于您的第一个字符串，您需要一个可以产生任何具有相同可能性的字符串的函数。假设该函数称为 nextString()。如果您再次调用 nextString() 而不更改状态中的任何内容，当然它将再次能够生成任何字符串。

所以你需要存储一些东西。问题是，您需要存储什么，需要多少空间？

字符串可以看作数字 0 - X^Y。(aaa=0, aab=1,aac=2...aba=X...) 因此，要尽可能高效地存储单个字符串，您需要 lg(X^Y) 位。假设 X = 16 且 Y = 2。然后你需要 1 个字节的存储空间来唯一地指定一个字符串。

当然，最简单的算法是在生成每个字符串时对其进行标记，这需要 X^Y 位，在我的示例中是 256 位（32 字节）。这就是你说你不想做的事。您可以使用此问题中讨论的 shuffle 算法：[Creating a random ordered list from an ordered list](https://stackoverflow.com/questions/168037/creating-a-random-ordered-list-from-an-ordered-list)（您不需要在通过 shuffle 算法生成字符串时存储字符串，但仍需要标记它们）。

好的，现在的问题是，我们能做得更好吗？我们总共需要存储多少？

好吧，在第一次通话时，我们不需要任何存储空间。在第二次调用时，我们需要知道之前生产的是哪一个。在最后一个调用中，我们只需要知道哪个是最后一个。所以最坏的情况是当我们进行到一半时。当我们进行到一半时，已经生产了 128 根弦，还有 128 根要走。我们需要知道还有哪些需要生产。假设这个过程是真正随机的，任何分裂都是可能的。有（256 种选择 128）种可能性。为了能够存储这些中的任何一个，我们需要 lg(256 选择 128) 位，根据谷歌计算器，它是 251.67。因此，如果你真的很聪明，你可以将信息压缩到比简单算法少 4 位。可能不值得。

如果您只是希望它看起来随机且存储空间很小，请参阅以下问题：[寻找一种算法以（伪）随机顺序吐出一系列数字](https://stackoverflow.com/questions/732700/looking-for-an-algorithm-to-spit-out-a-sequence-of-numbers-in-a-pseudo-random-o)

        c# - C# 十进制数据类型性能

ID：366852

赞同：65

时间：2008-12-14T19:08:33.380

标签：c#, performance, decimal

我正在用 C# 编写一个财务应用程序，其中性能（即速度）至关重要。因为它是一个金融应用程序，所以我必须大量使用 Decimal 数据类型。

在分析器的帮助下，我已经尽可能地优化了代码。在使用 Decimal 之前，一切都是用 Double 数据类型完成的，速度快了好几倍。但是，由于其二进制性质，Double 不是一种选择，在多次操作过程中会导致很多精度错误。

是否有任何可以与 C# 接口的十进制库，它可以让我在 .NET 中的原生 Decimal 数据类型上提高性能？

根据我已经得到的答案，我注意到我不够清楚，所以这里有一些额外的细节：

*   该应用程序必须尽可能快（即，与使用 Double 而不是 Decimal 时一样快将是一个梦想）。Double 比 Decimal 快大约 15 倍，因为操作是基于硬件的。
*   硬件已经是一流的（我在双氙气四核上运行）并且应用程序使用线程，因此机器上的 CPU 利用率始终为 100%。此外，该应用程序在 64 位模式下运行，这使其比 32 位具有可测量的性能优势。
*   我已经优化到了理智点（超过一个半月的优化；信不信由你，现在它需要大约 1/5000 来完成我最初用作参考的相同计算）；这种优化涉及到一切：字符串处理、I/O、数据库访问和索引、内存、循环、改变一些东西的制作方式，甚至在任何地方都使用“switch”而不是“if”。分析器现在清楚地表明剩余的性能罪魁祸首是 Decimal 数据类型运算符。没有其他任何东西加起来相当长的时间。
*   你必须相信我：我已经尽我所能在 C#.NET 领域优化应用程序，我对它目前的性能感到非常惊讶。我现在正在寻找一个好主意，以便将 Decimal 性能提高到接近 Double 的水平。我知道这只是一个梦想，但只是想检查一下我想到了一切可能的事情。:)

谢谢！

            回答 #1

赞同：44

时间：2008-12-14T20:04:21.113

您可以使用长数据类型。当然，您将无法在其中存储分数，但是如果您将应用程序编码为存储便士而不是英镑，那么您会没事的。长数据类型的准确性是 100%，除非您使用大量数字（使用 64 位长类型），否则您会没事的。

如果您不能强制存储便士，那么将一个整数包装在一个类中并使用它。

            回答 #2

赞同：25

时间：2008-12-14T19:55:15.690

你说它需要快，但你有具体的速度要求吗？如果没有，你可能会优化到理智点:)

正如坐在我旁边的朋友刚刚建议的那样，你可以升级你的硬件吗？这可能比重写代码便宜。

最明显的选择是使用整数而不是小数 - 其中一个“单位”类似于“千分之一美分”（或任何你想要的 - 你明白了）。这是否可行将取决于您对十进制值执行的操作。处理这个问题时你需要*非常*小心——很容易出错（至少如果你像我一样）。

分析器是否显示了您可以单独优化的应用程序中的特定热点？例如，如果您需要在一小段代码中进行大量计算，您可以将十进制转换为整数格式，进行计算然后再转换回来。这可以使大部分代码的*API*保持小数形式，这很可能使其更易于维护。但是，如果您没有明显的热点，那可能是不可行的。

+1 用于分析并告诉我们速度是一个明确的要求，顺便说一句:)

            回答 #3

赞同：14

时间：2015-12-17T10:37:27.367

这个问题得到了很好的讨论，但是由于我已经研究了这个问题一段时间，所以我想分享一些我的结果。

**问题定义：**众所周知，小数比双精度数要慢得多，但金融应用程序不能容忍对双精度数执行计算时出现的任何伪影。

**研究**

我的目标是测量存储浮点数的不同方法，并得出结论应该将哪一种用于我们的应用程序。

如果我们可以使用它`Int64`来存储具有固定精度的浮点数是可以接受的。10^6 的乘数给了我们两个：足够的数字来存储分数，并且仍然有很大的范围来存储大量。当然，您必须小心使用这种方法（乘法和除法运算可能会变得很棘手），但我们已经准备好并且也想测量这种方法。除了可能的计算错误和溢出之外，您必须记住的一件事是，通常您不能将这些长数字公开给公共 API。因此，所有内部计算都可以使用 long 执行，但在将数字发送给用户之前，它们应该转换为更友好的东西。

我已经实现了一个简单的原型类，它将一个 long 值包装到一个类似小数的结构（称为 it `Money`）并将其添加到测量中。

```
public struct Money : IComparable
{
    private readonly long _value;

    public const long Multiplier = 1000000;
    private const decimal ReverseMultiplier = 0.000001m;

    public Money(long value)
    {
        _value = value;
    }

    public static explicit operator Money(decimal d)
    {
        return new Money(Decimal.ToInt64(d * Multiplier));
    }

    public static implicit operator decimal (Money m)
    {
        return m._value * ReverseMultiplier;
    }

    public static explicit operator Money(double d)
    {
        return new Money(Convert.ToInt64(d * Multiplier));
    }

    public static explicit operator double (Money m)
    {
        return Convert.ToDouble(m._value * ReverseMultiplier);
    }

    public static bool operator ==(Money m1, Money m2)
    {
        return m1._value == m2._value;
    }

    public static bool operator !=(Money m1, Money m2)
    {
        return m1._value != m2._value;
    }

    public static Money operator +(Money d1, Money d2)
    {
        return new Money(d1._value + d2._value);
    }

    public static Money operator -(Money d1, Money d2)
    {
        return new Money(d1._value - d2._value);
    }

    public static Money operator *(Money d1, Money d2)
    {
        return new Money(d1._value * d2._value / Multiplier);
    }

    public static Money operator /(Money d1, Money d2)
    {
        return new Money(d1._value / d2._value * Multiplier);
    }

    public static bool operator <(Money d1, Money d2)
    {
        return d1._value < d2._value;
    }

    public static bool operator <=(Money d1, Money d2)
    {
        return d1._value <= d2._value;
    }

    public static bool operator >(Money d1, Money d2)
    {
        return d1._value > d2._value;
    }

    public static bool operator >=(Money d1, Money d2)
    {
        return d1._value >= d2._value;
    }

    public override bool Equals(object o)
    {
        if (!(o is Money))
            return false;

        return this == (Money)o;
    }

    public override int GetHashCode()
    {
        return _value.GetHashCode();
    }

    public int CompareTo(object obj)
    {
        if (obj == null)
            return 1;

        if (!(obj is Money))
            throw new ArgumentException("Cannot compare money.");

        Money other = (Money)obj;
        return _value.CompareTo(other._value);
    }

    public override string ToString()
    {
        return ((decimal) this).ToString(CultureInfo.InvariantCulture);
    }
} 
```

**实验**

我测量了以下操作：加法、减法、乘法、除法、相等比较和相对（更大/更少）比较。我正在测量以下类型的操作：`double`、`long`和. 每个操作执行 1.000.000 次。所有数字都预先分配在数组中，因此在构造函数中调用自定义代码不应影响结果。`decimal``Money``decimal``Money`

```
Added moneys in 5.445 ms
Added decimals in 26.23 ms
Added doubles in 2.3925 ms
Added longs in 1.6494 ms

Subtracted moneys in 5.6425 ms
Subtracted decimals in 31.5431 ms
Subtracted doubles in 1.7022 ms
Subtracted longs in 1.7008 ms

Multiplied moneys in 20.4474 ms
Multiplied decimals in 24.9457 ms
Multiplied doubles in 1.6997 ms
Multiplied longs in 1.699 ms

Divided moneys in 15.2841 ms
Divided decimals in 229.7391 ms
Divided doubles in 7.2264 ms
Divided longs in 8.6903 ms

Equility compared moneys in 5.3652 ms
Equility compared decimals in 29.003 ms
Equility compared doubles in 1.727 ms
Equility compared longs in 1.7547 ms

Relationally compared moneys in 9.0285 ms
Relationally compared decimals in 29.2716 ms
Relationally compared doubles in 1.7186 ms
Relationally compared longs in 1.7321 ms 
```

**结论**

1.  加法、减法、乘法、比较运算`decimal`比`long`or慢约 15 倍`double`；除法要慢约30倍。
2.  由于缺乏 CLR 的支持，类包装器的性能`Decimal`优于`Decimal`但仍明显低于 的性能。`double``long`
3.  以绝对数字执行计算`Decimal`非常快：每秒 40.000.000 次操作。

**建议**

1.  除非您有一个非常繁重的计算案例，否则请使用小数。在相对数字上，它们比 long 和 double 慢，但绝对数字看起来不错。
2.  `Decimal`由于缺乏 CLR 的支持，用您自己的结构重新实现没有多大意义。你可能会比它更快，`Decimal`但它永远不会像`double`.
3.  如果`Decimal`您的应用程序的性能不够，您可能需要考虑将计算切换为`long`固定精度。在将结果返回给客户端之前，应将其转换为`Decimal`.

            回答 #4

赞同：8

时间：2008-12-14T19:16:36.110

问题基本上是硬件支持双精度/浮点数，而十进制等不支持。即，您必须在速度 + 有限精度和更高的精度 + 更差的性能之间做出选择。

            回答 #5

赞同：3

时间：2010-06-24T03:14:41.083

我不认为 SSE2 指令可以轻松使用 .NET Decimal 值。.NET Decimal 数据类型是**128bit 十进制浮点**类型[http://en.wikipedia.org/wiki/Decimal128_floating-point_format，SSE2](http://en.wikipedia.org/wiki/Decimal128_floating-point_format)指令使用**128bit 整数类型**。

            回答 #6

赞同：3

时间：2019-08-14T16:31:39.877

[在我之前的回答](https://stackoverflow.com/a/34332452/1921819)4 年后，我想根据我们多年来在使用浮点数进行高性能计算方面的经验添加另一个答案。
`Decimal`高性能计算中的数据类型存在两个主要问题：

1.  CLR 将此类型视为常规结构（没有对其他内置类型的特殊支持）
2.  它是 128 位的

虽然你不能对第一个问题做太多，但第二个看起来更重要。使用 64 位数字进行操作时，内存操作和处理器非常高效。128 位操作要重得多。因此，.NET 的实现在`Decimal`设计上比`Double`对读/写操作的操作要慢得多。
如果您的应用程序需要浮点计算的准确性和此类操作的性能，那么既不适合`Double`也不`Decimal`适合该任务。[我们在我的公司（金融科技领域）采用的解决方案是在英特尔® 十进制浮点数学库](https://software.intel.com/en-us/articles/intel-decimal-floating-point-math-library)之上使用包装器。它实现了`IEEE 754-2008 Decimal Floating-Point Arithmetic specification`提供的 64 位浮点小数。
评论。`Decimals`应该只用于存储浮点数和对它们的简单算术运算。所有繁重的数学运算，例如计算技术分析指标，都应该在`Double`数值上执行。
**UPD 2020：**我们开源了小数[DFP](https://github.com/deltixlab/DFP)库。它是双语的（`C#`和`java`）。请`java`记住，您不能在`java`. 但这超出了本次讨论的范围。随意使用。

            回答 #7

赞同：2

时间：2013-05-16T10:34:06.223

老问题，但仍然非常有效。

这里有一些数字来支持使用 Long 的想法。

执行 100'000'000 次加法所需的时间

```
Long     231 mS
Double   286 mS
Decimal 2010 mS 
```

简而言之，十进制比 Long 或 Double 慢约 10 倍。

代码：

```
Sub Main()
    Const TESTS = 100000000
    Dim sw As Stopwatch

    Dim l As Long = 0
    Dim a As Long = 123456
    sw = Stopwatch.StartNew()
    For x As Integer = 1 To TESTS
        l += a
    Next
    Console.WriteLine(String.Format("Long    {0} mS", sw.ElapsedMilliseconds))

    Dim d As Double = 0
    Dim b As Double = 123456
    sw = Stopwatch.StartNew()
    For x As Integer = 1 To TESTS
        d += b
    Next
    Console.WriteLine(String.Format("Double  {0} mS", sw.ElapsedMilliseconds))

    Dim m As Decimal = 0
    Dim c As Decimal = 123456
    sw = Stopwatch.StartNew()
    For x As Integer = 1 To TESTS
        m += c
    Next
    Console.WriteLine(String.Format("Decimal {0} mS", sw.ElapsedMilliseconds))

    Console.WriteLine("Press a key")
    Console.ReadKey()
End Sub 
```

            回答 #8

赞同：1

时间：2008-12-29T22:07:50.463

由于我刚刚开始堆栈溢出，因此我无法发表评论或投反对票。我对 alexsmart 的评论（发布于 2008 年 12 月 23 日 12:31）是表达式 Round(n/precision,precision)，其中 n 是 int 并且精度是 long 不会像他想的那样做：

1) n/precision 将返回一个整数除法，即它已经被四舍五入，但您将无法使用任何小数。舍入行为也不同于 Math.Round(...)。

2) 由于 Math.Round(double, int) 和 Math.Round(decimal, int) 之间的歧义，代码“ *return Math.Round(n/precision,precision).ToString()* ”无法编译。您必须转换为十进制（不是 double，因为它是一个金融应用程序），因此也可以首先使用十进制。

3) n/precision，其中精度为 4 不会截断为四位小数，而是除以 4。例如，*Math.Round( (decimal) (1234567/4), 4)*返回 308641。 (1234567/4 = 308641.75)，而你可能想要的是得到 1235000（从尾随的 567 四舍五入到 4 位的精度）。请注意， Math.Round 允许舍入到固定点，而不是固定精度。

更新：我现在可以添加评论，但是没有足够的空间将这个放到评论区。

            回答 #9

赞同：1

时间：2009-08-03T09:28:07.100

MMX/SSE/SSE2 怎么样？

我认为这会有所帮助...所以...十进制是 128 位数据类型，SSE2 也是 128 位...它可以在 1 个 CPU 滴答声中添加、sub、div、mul 十进制...

您可以使用 VC++ 为 SSE2 编写 DLL，然后在您的应用程序中使用该 DLL

例如//你可以做这样的事情

**VC++**

```
#include <emmintrin.h>
#include <tmmintrin.h>

extern "C" DllExport __int32* sse2_add(__int32* arr1, __int32* arr2);

extern "C" DllExport __int32* sse2_add(__int32* arr1, __int32* arr2)
{
    __m128i mi1 = _mm_setr_epi32(arr1[0], arr1[1], arr1[2], arr1[3]);
    __m128i mi2 = _mm_setr_epi32(arr2[0], arr2[1], arr2[2], arr2[3]);

    __m128i mi3 = _mm_add_epi32(mi1, mi2);
    __int32 rarr[4] = { mi3.m128i_i32[0], mi3.m128i_i32[1], mi3.m128i_i32[2], mi3.m128i_i32[3] };
    return rarr;
} 
```

**C＃**

```
[DllImport("sse2.dll")]
private unsafe static extern int[] sse2_add(int[] arr1, int[] arr2);

public unsafe static decimal addDec(decimal d1, decimal d2)
{
    int[] arr1 = decimal.GetBits(d1);
    int[] arr2 = decimal.GetBits(d2);

    int[] resultArr = sse2_add(arr1, arr2);

    return new decimal(resultArr);
} 
```

            回答 #10

赞同：0

时间：2015-12-13T01:03:19.010

使用 double 存储“便士”。除了解析输入和打印输出之外，您的速度与您测量的相同。你克服了 64 位整数的限制。你有一个没有截断的除法。注意：由您决定如何在除法后使用双重结果。在我看来，这似乎是满足您要求的最简单方法。

        javascript - jQuery UI 对话框 - 关闭后不打开

ID：366854

赞同：79

时间：2008-12-14T19:09:21.973

标签：javascript, jquery, jquery-ui, modal-dialog, jquery-ui-dialog

我有一个问题[`jquery-ui dialog box`](https://jqueryui.com/dialog/)。

**问题是当我关闭对话框然后单击触发它的链接时，除非我刷新页面，否则它不会再次弹出。** 

如何在不刷新实际页面的情况下调用对话框。

下面是我的代码：

```
$(document).ready(function() {
    $('#showTerms').click(function()
    {
        $('#terms').css('display','inline');
        $('#terms').dialog({
            resizable: false,
            modal: true,
            width: 400,
            height: 450,
            overlay: { backgroundColor: "#000", opacity: 0.5 },
            buttons:{ "Close": function() { $(this).dialog("close"); } },
            close: function(ev, ui) { $(this).remove(); },
    }); 
}); 
```

谢谢

            回答 #1

赞同：110

时间：2009-04-13T22:43:16.897

你实际上应该用来`$("#terms").dialog({ autoOpen: false });`初始化它。然后您可以使用`$('#terms').dialog('open');`打开对话框并`$('#terms').dialog('close');`关闭它。

            回答 #2

赞同：14

时间：2008-12-14T19:42:19.473

我解决了。
我使用了destroy而不是close函数（它没有任何意义），但它起作用了。

```
$(document).ready(function() {
$('#showTerms').click(function()
{
    $('#terms').css('display','inline');
    $('#terms').dialog({resizable: false,
        modal: true,
        width: 400,
        height: 450,
        overlay: { backgroundColor: "#000", opacity: 0.5 },
        buttons:{ "Close": function() { $(this).dialog('**destroy**'); } },
        close: function(ev, ui) { $(this).close(); },
    });         
});   
$('#form1 input#calendarTEST').datepicker({ dateFormat: 'MM d, yy' });
}); 
```

            回答 #3

赞同：12

时间：2008-12-14T19:37:11.747

在最后一行，不要使用`$(this).remove()`use`$(this).hide()`代替。

编辑：澄清一下，在关闭单击事件中，您正在`#terms`从 DOM 中删除 div，这就是它不回来的原因。你只需要隐藏它。

            回答 #4

赞同：9

时间：2009-10-27T23:40:29.890

我相信您只能初始化对话框一次。上面的示例尝试在每次单击#terms 时初始化对话框。这会导致问题。相反，初始化应该发生在点击事件之外。您的示例应该如下所示：

```
$(document).ready(function() {
    // dialog init
    $('#terms').dialog({
        autoOpen: false,
        resizable: false,
        modal: true,
        width: 400,
        height: 450,
        overlay: { backgroundColor: "#000", opacity: 0.5 },
        buttons: { "Close": function() { $(this).dialog('close'); } },
        close: function(ev, ui) { $(this).close(); }
    });
    // click event
    $('#showTerms').click(function(){
        $('#terms').dialog('open').css('display','inline');      
    });
    // date picker
    $('#form1 input#calendarTEST').datepicker({ dateFormat: 'MM d, yy' });
}); 
```

我认为，一旦您清除了它，它应该可以解决您描述的“从链接打开”问题。

            回答 #5

赞同：3

时间：2010-05-25T09:48:53.727

对我来说，这种方法有效：

可以通过单击对话框上的 X 或单击“注意”来关闭对话框。我正在添加一个（任意）id，因为我需要确保添加到 dom 的每一位 html 都在之后被删除。

```
$('<div id="dossier_edit_form_tmp_id">').html(data.form)
.data('dossier_id',dossier_id)
.dialog({
        title: 'Opdracht wijzigen',
        show: 'clip',
        hide: 'clip',
        minWidth: 520,
        width: 520,
        modal: true,
        buttons: { 'Bewaren': dossier_edit_form_opslaan },
        close: function(event, ui){ 
                                  $(this).dialog('destroy'); 
                                  $('#dossier_edit_form_tmp_id').remove();
               }
}); 
```

            回答 #6

赞同：3

时间：2012-12-07T11:22:40.467

```
 <button onClick="abrirOpen()">Open Dialog</button>

<script type="text/javascript">
var $dialogo = $("<div></div>").html("Aqui tu contenido(here your content)").dialog({
       title: "Dialogo de UI",
       autoOpen: false,
       close: function(ev, ui){
               $(this).dialog("destroy");
       }
 function abrirOpen(){
       $dialogo.dialog("open");
 }
});

//**Esto funciona para mi... (this works for me)**
</script> 
```

            回答 #7

赞同：3

时间：2013-10-23T16:52:35.063

这是一个超级旧的线程，但由于答案甚至说“这没有任何意义”，我想我会添加答案......

原帖使用 $(this).remove(); 在关闭处理程序中，这实际上会从 DOM 中删除对话框 div。尝试再次初始化对话框将无法正常工作，因为 div 已被删除。

使用 $(this).dialog('destroy') 调用在对话框对象中定义的方法 destroy 不会将其从 DOM 中删除。

从文档中：

破坏（）

> 完全删除对话框功能。这会将元素返回到其 >>pre-init 状态。此方法不接受任何参数。

也就是说，只有在您有充分理由的情况下才在关闭时销毁或移除。

            回答 #8

赞同：2

时间：2009-04-13T22:29:53.980

```
$(this).dialog('destroy'); 
```

作品！

            回答 #9

赞同：1

时间：2010-01-28T14:50:52.550

.close() 更通用，可用于引用更多对象。.dialog('close') 只能与对话框一起使用

            回答 #10

赞同：1

时间：2010-09-27T13:42:23.937

我将对话框用作对话框文件浏览器和上传器，然后我像这样重写代码

```
var dialog1 = $("#dialog").dialog({ 
              autoOpen: false, 
              height: 480, 
              width: 640 
}); 
$('#tikla').click(function() {  
    dialog1.load('./browser.php').dialog('open');
}); 
```

一切似乎都很好。

            回答 #11

赞同：1

时间：2011-06-06T16:25:43.020

我对 jquery-ui 覆盖对话框有同样的问题 - 它只会工作一次然后停止，除非我重新加载页面。我在他们的一个示例中找到了答案 -

同一页面上的多个叠加层

[flowplayer_tools_multiple_open_close](http://flowplayer.org/tools/demos/overlay/multiple.html)

 - 谁会有，对吧？:-) -  

重要的设置似乎是

```
oneInstance: false 
```

所以，现在我有这样的 -

```
$(document).ready(function() {

 var overlays = null;

 overlays = jQuery("a[rel]");

 for (var n = 0; n < overlays.length; n++) {

    $(overlays[n]).overlay({
        oneInstance: false, 
        mask: '#669966',
        effect: 'apple',
        onBeforeLoad: function() {
            overlay_before_load(this);
        }
    });

  }

} 
```

一切正常

希望这可以帮助某人

O。

            回答 #12

赞同：0

时间：2010-04-12T21:40:50.690

jQuery 文档有一个指向这篇文章“ [jQuery UI 对话框](http://blog.nemikor.com/2009/04/08/basic-usage-of-the-jquery-ui-dialog/)的基本用法”的链接，它解释了这种情况以及如何解决它。

        c# - 如何将 C# StructureMap 初始化转换为 VB.NET？

ID：366856

赞同：4

时间：2008-12-14T19:09:37.870

标签：c#, vb.net, structuremap

我正要把头伸进这扇滑动玻璃门。我不知道如何在 VB.NET 中执行以下代码来挽救我的生命。

```
private static void InitStructureMap()
    {
        ObjectFactory.Initialize(x =>
                                     {
                                         x.AddRegistry(new DataAccessRegistry());
                                         x.AddRegistry(new CoreRegistry());
                                         x.AddRegistry(new WebUIRegistry());

                                         x.Scan(scanner =>
                                                    {
                                                        scanner.Assembly("RPMWare.Core");
                                                        scanner.Assembly("RPMWare.Core.DataAccess");
                                                        scanner.WithDefaultConventions();
                                                    });
                                     });
    } 
```

            回答 #1

赞同：9

时间：2008-12-14T20:15:27.583

目前，这根本不可能。当前版本的 VB 不支持多行（或语句）lambda。每个 lambda 只能包含一个表达式。下一版本的 VB 将解决这个问题（上一个版本根本没有足够的时间）。

与此同时，您将不得不与代表凑合：

```
Private Shared Sub Foobar(x As IInitializationExpression)
    x.AddRegistry(New DataAccessRegistry)
    x.AddRegistry(New CoreRegistry)
    x.AddRegistry(New WebUIRegistry)
    x.Scan(AddressOf Barfoo)
End Sub

Private Shared Sub Barfoo(ByVal scanner As IAssemblyScanner) 
    scanner.Assembly("RPMWare.Core")
    scanner.Assembly("RPMWare.Core.DataAccess")
    scanner.WithDefaultConventions
End Sub

' … '
ObjectFactory.Initialize(AddressOf Foobar) 
```

            回答 #2

赞同：2

时间：2009-05-13T22:44:05.893

您可以在以下位置看到另一种方法：

[http://blogs.lessthandot.com/index.php/DesktopDev/MSTech/structuremap-is-way-cool-even-in-vb-net](http://blogs.lessthandot.com/index.php/DesktopDev/MSTech/structuremap-is-way-cool-even-in-vb-net)

            回答 #3

赞同：1

时间：2008-12-14T19:28:13.747

我的 VB.NET 没有达到标准，所以我无法直接帮助您编写代码。然而，我可以告诉你的是如何自己做，这很麻烦。基本上，您需要使用[Reflector](http://www.red-gate.com/products/reflector/)来读取包含此代码的可执行文件 - 然后您可以选择将其输出为 VB.NET - 这太酷了，而且这个技巧可以双向工作。

            回答 #4

赞同：0

时间：2008-12-14T19:39:21.837

这太棒了，但无论出于何种原因，它都无法编译。啊。

这是它的想法：

```
Private Shared Sub InitStructureMap()
ObjectFactory.Initialize(Function (ByVal x As IInitializationExpression) 
    x.AddRegistry(New DataAccessRegistry)
    x.AddRegistry(New CoreRegistry)
    x.AddRegistry(New WebUIRegistry)
    x.Scan(Function (ByVal scanner As IAssemblyScanner) 
        scanner.Assembly("RPMWare.Core")
        scanner.Assembly("RPMWare.Core.DataAccess")
        scanner.WithDefaultConventions
    End Function)
End Function)
End Sub 
```

我尝试添加 _ 使其成为一行（这也不起作用）

```
 Private Shared Sub InitStructureMap()
ObjectFactory.Initialize(Function (ByVal x As IInitializationExpression) _
    x.AddRegistry(New DataAccessRegistry) _
    x.AddRegistry(New CoreRegistry) _
    x.AddRegistry(New WebUIRegistry) _
    x.Scan(Function (ByVal scanner As IAssemblyScanner) _
    scanner.Assembly("RPMWare.Core") _
    scanner.Assembly("RPMWare.Core.DataAccess") _
    scanner.WithDefaultConventions() _
    End Function) _
End Function) 
End Sub 
```

还有人讨厌他们的旧版应用程序吗？:P

        asp.net-mvc - 类似于 stackoverflow 的通知面板

ID：366857

赞同：26

时间：2008-12-14T19:10:02.580

标签：asp.net-mvc

还记得显示在页面顶部的小 div 通知我们事情（如新徽章）吗？

我也想实现类似的东西，并且正在寻找一些最佳实践或模式。

我的网站也是一个 ASP.NET MVC 应用程序。理想情况下，答案将包括诸如“将*其*放在母版页中”和“在控制器中执行*此操作”之类的细节。*

只是为了让您不必看自己，这是我在未登录 stackoverflow 时收到的欢迎消息中看到的代码。

```
<div class="notify" style="">
  <span>
    First time at Stack Overflow? Check out the
    <a href="/messages/mark-as-read?returnurl=%2ffaq">FAQ</a>!
  </span>
  <a class="close-notify" onclick="notify.close(true)" title="dismiss this notification">×</a>
</div>

<script type="text/javascript">

  $().ready(function() {
    notify.show();
  });

</script> 
```

我想补充一点，我完全理解这一点，也理解 jquery 的参与。我只是对谁将代码放入标记以及何时（“谁”作为 ASP.NET MVC 应用程序中的哪些实体）感兴趣。

谢谢！

            回答 #1

赞同：12

时间：2009-05-18T14:30:55.870

[这个答案](https://stackoverflow.com/questions/659199/how-to-show-popup-message-like-in-stackoverflow/659243#659243)有一个完整的解决方案。

复制粘贴：

这是标记，最初是隐藏的，因此我们可以将其淡入：

```
<div id='message' style="display: none;">
    <span>Hey, This is my Message.</span>
    <a href="#" class="close-notify">X</a>
</div> 
```

以下是应用的样式：

```
#message {
    font-family:Arial,Helvetica,sans-serif;
    position:fixed;
    top:0px;
    left:0px;
    width:100%;
    z-index:105;
    text-align:center;
    font-weight:bold;
    font-size:100%;
    color:white;
    padding:10px 0px 10px 0px;
    background-color:#8E1609;
}

#message span {
    text-align: center;
    width: 95%;
    float:left;
}

.close-notify {
    white-space: nowrap;
    float:right;
    margin-right:10px;
    color:#fff;
    text-decoration:none;
    border:2px #fff solid;
    padding-left:3px;
    padding-right:3px
}

.close-notify a {
    color: #fff;
} 
```

这是javascript（使用jQuery）：

```
$(document).ready(function() {
    $("#message").fadeIn("slow");
    $("#message a.close-notify").click(function() {
        $("#message").fadeOut("slow");
        return false;
    });
}); 
```

瞧。根据您的页面设置，您可能还希望在显示时编辑 body margin-top。

[这是它的实际演示](http://jsbin.com/owuje)。

            回答 #2

赞同：11

时间：2009-09-17T23:22:46.483

在窥探一下代码之后，这里有一个猜测：

以下通知容器始终位于视图标记中：

```
<div id="notify-container"> </div> 
```

该通知容器默认是隐藏的，并且在某些情况下由 javascript 填充。它可以包含任意数量的消息。

**如果用户未登录**

*持久性*：Cookie 用于跟踪消息是否显示。

*视图中的服务器端生成代码*：我认为如果您没有登录，stackoverflow 只会显示一条消息。以下代码被注入到视图中：

```
<script type="text/javascript">
    $(function() { notify.showFirstTime(); });
</script> 
```

showFirstTime() javascript 方法只是确定是否显示“这是你第一次来这里吗？” 基于是否设置了 cookie 的消息。如果没有 cookie，则会显示该消息。如果用户采取行动，则设置 cookie，并且将来不会显示该消息。nofity.showFirstTime() 函数处理对 cookie 的检查。

**如果用户已登录**

*持久性*：数据库用于跟踪消息是否已显示。  

*视图中的服务器端生成代码*：当请求页面时，服务器端代码检查数据库以查看需要显示哪些消息。然后，服务器端代码将 json 格式的消息注入到视图中，并对 showMessages() 进行 javascript 调用。

例如，如果我登录到一个视图，我会在 SO 的标记中看到以下内容：

```
 <script type="text/javascript">
1
2 var msgArray = [{"id":49611,"messageTypeId":8,"text":"Welcome to Super User! Visit your \u003ca href=\"/users/00000?tab=accounts\"\u003eaccounts tab\u003c/a\u003e to associate with our other websites!","userId":00000,"showProfile":false}];
3 $(function() { notify.showMessages(msgArray); });
4
</script> 
```

因此，如果用户未登录，服务器端代码要么注入代码以调用“showFirstTime”方法，要么注入消息并为已登录用户调用“showMessages”。

**更多关于客户端代码**

另一个关键组件是 Picflight 已取消缩小的“通知”JavaScript 模块（您可以使用 yslow 为 firebug 做同样的事情）。notify 模块根据服务器端生成的 javascript 处理通知 div 的填充。

**未登录，客户端**

如果用户未登录，则模块会在用户 X 退出通知或通过创建 cookie 转到常见问题解答时处理事件。它还通过检查 cookie 来确定是否显示第一次消息。

**登录，客户端**

如果用户已登录，则通知模块将服务器生成的所有消息添加到通知 div 中。当用户关闭消息时，它也很可能使用 ajax 来更新数据库。

            回答 #3

赞同：4

时间：2008-12-14T19:15:35.830

虽然这些绝不是官方的，但我遵循的常见做法会导致这样的结果：

*   **在标记中**创建将充当通知容器的元素，但默认隐藏它（这可以通过多种方式完成 - JavaScript、外部 CSS 或内联样式）。
*   让脚本负责**标记之外的**通知行为。在上面的示例中，您可以看到`onclick`标记中包含一个以及另一个在页面加载时触发的函数。虽然它有效，但我认为这是混合呈现和行为。
*   将通知消息的显示保留在外部样式表中。

同样，这些只是我在您的问题中陈述的常见做法。正如您的问题的性质已经表明的那样，Web 开发的问题在于，有很多方法可以用相同的结果来做同样的事情。

            回答 #4

赞同：4

时间：2009-09-02T20:33:42.867

我看到以下 jQuery 函数？我相信将 html 注入到 id 为 notify-container 的 div 中。

我不明白这个JS是如何根据某些事件使用和调用的，也许有人可以解释一下。

```
var notify = function() {
var d = false;
var e = 0;
var c = -1;
var f = "m";
var a = function(h) {
    if (!d) {
        $("#notify-container").append('<table id="notify-table"></table>');
        d = true
    }
    var g = "<tr" + (h.messageTypeId ? ' id="notify-' + h.messageTypeId + '"' : "");
    g += ' class="notify" style="display:none"><td class="notify">' + h.text;
    if (h.showProfile) {
        var i = escape("/users/" + h.userId);
        g += ' See your <a href="/messages/mark-as-read?messagetypeid=' + h.messageTypeId + "&returnurl=" + i + '">profile</a>.'
    }
    g += '</td><td class="notify-close"><a title="dismiss this notification" onclick="notify.close(';
    g += (h.messageTypeId ? h.messageTypeId : "") + ')">&times;</a></td></tr>';
    $("#notify-table").append(g)
};
var b = function() {
    $.cookie("m", "-1", {
        expires: 90,
        path: "/"
    })
};
return {
    showFirstTime: function() {
        if ($.cookie("new")) {
            $.cookie("new", "0", {
                expires: -1,
                path: "/"
            });
            b()
        }
        if ($.cookie("m")) {
            return
        }
        $("body").css("margin-top", "2.5em");
        a({
            messageTypeId: c,
            text: 'First time here? Check out the <a onclick="notify.closeFirstTime()">FAQ</a>!'
        });
        $(".notify").fadeIn("slow")
    },
    showMessages: function(g) {
        for (var h = 0; h < g.length; h++) {
            a(g[h])
        }
        $(".notify").fadeIn("slow");
        e = g.length
    },
    show: function(g) {
        $("body").css("margin-top", "2.5em");
        a({
            text: g
        });
        $(".notify").fadeIn("slow")
    },
    close: function(g) {
        var i;
        var h = 0;
        if (g && g != c) {
            $.post("/messages/mark-as-read", {
                messagetypeid: g
            });
            i = $("#notify-" + g);
            if (e > 1) {
                h = parseInt($("body").css("margin-top").match(/\d+/));
                h = h - (h / e)
            }
        } else {
            if (g && g == c) {
                b()
            }
            i = $(".notify")
        }
        i.children("td").css("border-bottom", "none").end().fadeOut("fast", function() {
            $("body").css("margin-top", h + "px");
            i.remove()
        })
    },
    closeFirstTime: function() {
        b();
        document.location = "/faq"
    }
 }
} (); 
```

            回答 #5

赞同：2

时间：2008-12-14T20:50:12.787

StackOverflow 使用[jQuery](http://jquery.com/) - 您从 SO 发布的 JS 代码是一个 jQuery 调用。它几乎不需要代码就可以完全满足您的要求。强烈推荐。

            回答 #6

赞同：0

时间：2011-02-14T22:50:07.457

我编写了这段 Javascript，它的功能包括堆叠、像 Stack Overflow 一样在滚动时与您同在，并在添加新栏时将整个页面向下推。酒吧也过期了。酒吧也滑入存在。

```
// Show a message bar at the top of the screen to tell the user that something is going on.
// hideAfterMS - Optional argument. When supplied it hides the bar after a set number of milliseconds.
    function AdvancedMessageBar(hideAfterMS) {
        // Add an element to the top of the page to hold all of these bars.
        if ($('#barNotificationContainer').length == 0) 
        {               

        var barContainer = $('<div id="barNotificationContainer" style="width: 100%; margin: 0px; padding: 0px;"></div>');
        barContainer.prependTo('body');

        var barContainerFixed = $('<div id="barNotificationContainerFixed" style="width: 100%; position: fixed; top: 0; left: 0;"></div>');
        barContainerFixed.prependTo('body');
    }

    this.barTopOfPage = $('<div style="margin: 0px; background: orange; width: 100%; text-align: center; display: none; font-size: 15px; font-weight: bold; border-bottom-style: solid; border-bottom-color: darkorange;"><table style="width: 100%; padding: 5px;" cellpadding="0" cellspacing="0"><tr><td style="width: 20%; font-size: 10px; font-weight: normal;" class="leftMessage" ></td><td style="width: 60%; text-align: center;" class="messageCell"></td><td class="rightMessage" style="width: 20%; font-size: 10px; font-weight: normal;"></td></tr></table></div>');
    this.barTopOfScreen = this.barTopOfPage.clone();

    this.barTopOfPage.css("background", "transparent");
    this.barTopOfPage.css("border-bottom-color", "transparent");
    this.barTopOfPage.css("color", "transparent");

    this.barTopOfPage.prependTo('#barNotificationContainer');
    this.barTopOfScreen.appendTo('#barNotificationContainerFixed');

    this.setBarColor = function (backgroundColor, borderColor) {     

        this.barTopOfScreen.css("background", backgroundColor);
        this.barTopOfScreen.css("border-bottom-color", borderColor);
    };

    // Sets the message in the center of the screen.
    // leftMesage - optional
    // rightMessage - optional
    this.setMessage = function (message, leftMessage, rightMessage) {
        this.barTopOfPage.find('.messageCell').html(message);
        this.barTopOfPage.find('.leftMessage').html(leftMessage);
        this.barTopOfPage.find('.rightMessage').html(rightMessage);

        this.barTopOfScreen.find('.messageCell').html(message);
        this.barTopOfScreen.find('.leftMessage').html(leftMessage);
        this.barTopOfScreen.find('.rightMessage').html(rightMessage);
    };

    this.show = function() {
        this.barTopOfPage.slideDown(1000);
        this.barTopOfScreen.slideDown(1000);
    };

    this.hide = function () {
        this.barTopOfPage.slideUp(1000);
        this.barTopOfScreen.slideUp(1000);
    };

    var self = this;   

    if (hideAfterMS != undefined) {
        setTimeout(function () { self.hide(); }, hideAfterMS);
    }    
} 
```

要使用它，您必须使用 jQuery 并确保页面正文没有边距或填充。

AdvancedMessageBar 采用的参数是可选的。如果提供，它将导致条形图在一定时间（以毫秒为单位）后消失。

```
var mBar = new AdvancedMessageBar(10000);
mBar.setMessage('This is my message', 'Left Message', 'Right Message');
mBar.show(); 
```

如果您想堆叠这些，那么只需创建更多 AdvancedMessageBar 对象，它们就会自动堆叠。

        git - 你什么时候会使用不同的 git 合并策略？

ID：366860

赞同：454

时间：2008-12-14T19:12:11.860

标签：git, merge, git-merge

从 git-merge 的手册页中，您可以使用许多合并策略。  

*   *解决*- 这只能使用 3 路合并算法解决两个头（即当前分支和您从中提取的另一个分支）。它试图仔细检测交叉合并歧义，并且通常被认为是安全和快速的。

*   *递归*- 这只能使用 3 路合并算法解决两个头。当有多个共同祖先可用于三向合并时，它会创建共同祖先的合并树并将其用作三向合并的参考树。据报道，通过对取自 Linux 2.6 内核开发历史的实际合并提交进行的测试，这可以减少合并冲突，而不会导致错误合并。此外，这可以检测和处理涉及重命名的合并。这是拉取或合并一个分支时的默认合并策略。

*   *章鱼*- 这解决了两个以上的情况，但拒绝进行需要手动解决的复杂合并。它主要用于将主题分支头捆绑在一起。这是拉取或合并多个分支时的默认合并策略。

*   *我们*的 - 这解决了任意数量的头，但合并的结果始终是当前分支头。它旨在用于取代分支的旧开发历史。

*   *子树*- 这是一种修改后的递归策略。合并树 A 和 B 时，如果 B 对应 A 的子树，则首先调整 B 以匹配 A 的树结构，而不是读取同级树。对共同祖先树也进行了这种调整。

我什么时候应该指定不同于默认值的东西？什么场景最适合？

            回答 #1

赞同：324

时间：2008-12-14T20:25:49.760

我不熟悉resolve，但我用过其他的：

递归的

递归是非快进合并的默认值。我们都熟悉那个。

章鱼

当我有几棵需要合并的树时，我使用了章鱼。您可以在大型项目中看到这一点，其中许多分支都进行了独立开发，并且已经准备好整合到一个单一的头部。

章鱼分支在一次提交中合并多个头，只要它可以干净地完成。

举例来说，假设您有一个项目，该项目有一个 master，然后是三个要合并的分支（称为 a、b 和 c）。

一系列递归合并看起来像这样（请注意，第一次合并是快进，因为我没有强制递归）：

[![一系列递归合并](https://i.stack.imgur.com/y9LeY.png)](https://i.stack.imgur.com/y9LeY.png)

但是，单个章鱼合并看起来像这样：

```
commit ae632e99ba0ccd0e9e06d09e8647659220d043b9
Merge: f51262e... c9ce629... aa0f25d... 
```

[![章鱼合并](https://i.stack.imgur.com/jctXz.png)](https://i.stack.imgur.com/jctXz.png)

我们的

我们的 == 我想引入另一个头部，但丢弃头部引入的所有变化。

这会保留分支的历史记录，而不会受到分支的任何影响。

（阅读：甚至没有查看这些分支之间的更改。分支只是合并，文件没有做任何事情。如果你想在另一个分支中合并并且每次出现“我们的文件版本或他们的文件版本”的问题版本”你可以使用`git merge -X ours`）

子树

当您想将另一个项目合并到当前项目的子目录中时，子树很有用。当您有一个不想包含为子模块的库时很有用。

            回答 #2

赞同：51

时间：2008-12-15T00:56:24.037

实际上，如果您想放弃分支带来的更改，那么您唯一要选择的两种策略是**我们**的策略，但保留历史中的分支，如果您将独立项目合并到超级项目的子目录中（如 'git-gui' in **'** git'存储库）。

*章鱼*合并在合并两个以上的分支时自动使用。  *解决*主要是出于历史原因，以及当您遇到*递归*合并策略极端情况时。

            回答 #3

赞同：30

时间：2012-05-17T13:15:38.813

“解决”与“递归”合并策略
递归是当前默认的双头策略，但经过一番搜索，我终于找到了一些关于“解决”合并策略的信息。
摘自 O'Reilly 的书《[使用 Git 进行版本控制](http://books.google.com/books?id=e9FsGUHjR5sC&pg=PA142&lpg=PA142&dq=git%20merge%20%22-s%20resolve%22&source=bl&ots=Zi5h3H_bqh&sig=Lp_-I3uOvMbYBcsraQEe6WbFMhU&hl=en&sa=X&ei=cPW0T7qzEsae2gWeq9w9&ved=0CGQQ6AEwAw#v=onepage&q=git%20merge%20%22-s%20resolve%22&f=false)》 （[亚马逊](https://rads.stackoverflow.com/amzn/click/com/B002L4EXHO)）（释义）：

最初，“解决”是 Git 合并的默认策略。

在交叉合并的情况下，有多个可能的合并基础，解决策略的工作原理如下：选择一个可能的合并基础，并希望最好。这实际上并不像听起来那么糟糕。事实证明，用户一直在处理代码的不同部分。在这种情况下，Git 检测到它正在重新合并一些已经存在的更改并跳过重复的更改，从而避免冲突。或者，如果这些是确实会导致冲突的细微更改，那么至少开发人员应该可以轻松处理冲突。

我已经使用默认递归策略失败的“resolve”成功合并了树。我遇到了`fatal: git write-tree failed to write a tree`错误，感谢[这篇博文](http://www.tommymorgan.com/2011/04/git-merge-fails-with-fatal-git-write.html)（[mirror](http://web.archive.org/web/20110911184425/http://www.tommymorgan.com/2011/04/git-merge-fails-with-fatal-git-write.html)），我尝试了“-s resolve”，它奏效了。我仍然不确定为什么......但我认为这是因为我在两棵树中都有重复的更改，并正确解决“跳过”它们。

            回答 #4

赞同：4

时间：2020-11-22T02:20:23.097

随着 Git 2.30（2021 年第一季度），将会有一个*新*的合并策略：**ORT**（“ **Ostensibly Recursive's Twin** ”）。

```
git merge -s ort 
```

这来自以利亚纽伦的[这个帖子：](https://public-inbox.org/git/CABPp-BFRftNf8hoj8nTDiw+akci=w2qVAgamVDyRw1NUk-QCNA@mail.gmail.com/)

现在，我称它为“表面上递归的双胞胎”，或简称为“ort”。> 起初，人们不应该注意到它与当前递归策略之间的任何区别，除了我认为我可以让它更快一点（尤其是对于大回购）。

但它应该允许我修复一些在当前设计中更难处理的（不可否认的极端情况）错误，我认为合并不会触及`$GIT_WORK_TREE`或`$GIT_INDEX_FILE`允许一些有趣的新功能。

无论如何，这就是希望。

[问题](https://public-inbox.org/git/xmqqd147kpdm.fsf@gitster.mtv.corp.google.com/)：

在理想的世界中，我们应该：

*   要求`unpack_trees()`做“ `read-tree -m`”没有“ `-u`”；

*   在内核中执行所有合并递归计算并准备结果索引，同时保持当前索引不变；

*   比较当前的in-core index和生成的in-core index，注意工作树中需要添加、更新或删除的路径，保证变化反映到工作树时不丢失信息树; 

    例如，结果想要创建一个文件，其中工作树当前有一个目录，其中包含不可消耗的内容，结果想要删除工作树文件具有本地修改的文件等；

    然后最后

*   执行工作树更新以使其与生成的核心索引所显示的内容相匹配。

结果：
请参阅[Elijah Newren](https://github.com/git/git/commit/14c4586c2dfa94d86d71a60481dd20bc5b56e562) ( ) 的提交 14c4586（ 2020 年 11 月 2 日）、[提交 fe1a21d](https://github.com/git/git/commit/fe1a21d5267cae88d4312e3595909720717eb31c)（2020 年 10 月 29 日）和[提交 47b1e89](https://github.com/git/git/commit/47b1e890e3f7ba57e8c5bc364dcb04d8b2dc1c58)、[提交 17e5574](https://github.com/git/git/commit/17e5574b0446836af08136ae269b30767c05b1d7) [（`newren`](https://github.com/newren) 2020 年 10 月 27 日[）](https://github.com/newren)。

^(（由[Junio C Hamano 合并 -- `gitster`--](https://github.com/gitster)在[提交 a1f9595](https://github.com/git/git/commit/a1f95951efc55c97477e32287b06e204553be5c2)中，2020 年 11 月 18 日）)

## [`merge-ort`](https://github.com/git/git/commit/17e5574b0446836af08136ae269b30767c05b1d7)：具有空实现的新合并策略的准系统 API

^(签字人：以利亚·纽伦)

这是新合并策略的开始。

虽然存在一些 API 差异，并且实现在行为上也存在一些差异，但它本质上是作为[`merge-recursive.c`](https://github.com/git/git/blob/17e5574b0446836af08136ae269b30767c05b1d7/merge-recursive.c).

但是，它被构建为与合并递归并存，因此我们有足够的时间来找出这些差异在现实世界中是如何出现的，而人们仍然可以退回到合并递归。

（另外，我打算避免在此过程中修改合并递归，以保持稳定。）

这里值得注意的主要区别是工作树和索引的更新不是与合并算法同时完成的，而是一个单独的后处理步骤。

新的 API 被设计成可以重复合并（例如在 rebase 或cherry-pick 期间），并且只在最后更新一次索引和工作树，而不是用每个中间结果更新它。

此外，可以在两个分支之间执行合并，这两个分支都不匹配索引或工作树，而不会破坏索引或工作树。

和：
请参阅[Elijah Newren ( ) 的提交](https://github.com/newren)[848a856](https://github.com/git/git/commit/848a856b136c6aaeb2b7944add318485c6c6d6ae)、提交[fd15863](https://github.com/git/git/commit/fd15863ec8a90a4c2b4429f5f5de370c8599e700)、提交[23bef2e](https://github.com/git/git/commit/23bef2e33c3290ae308c2ce37e290a25eb5b97bc)、[提交 c8c35f6](https://github.com/git/git/commit/c8c35f6a02f3841d4383a5ce4c9d8e426776d151)、[提交 c12d1f2](https://github.com/git/git/commit/c12d1f2ac227cbec44be27de83ef07d135f243c2)、[提交 727c75b](https://github.com/git/git/commit/727c75b23f25f752810f412e936d420f5c7fee04)、[提交 489c85f](https://github.com/git/git/commit/489c85ff43b292cc22ae2e003fad74c75f7ae190)、[提交 ef52778](https://github.com/git/git/commit/ef527787089ce9a5c137ffde24701dfb7fda841c)、[提交 f06481f](https://github.com/git/git/commit/f06481f12732e846c0572a0109e2c5b5684f508a)（2020 年 10 月 26 日[）](https://github.com/newren)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 66c62ea](https://github.com/git/git/commit/66c62eaec66bb585caabf560a5e1e49cd64e7a1f))^(中，2020 年 11 月 18 日）)[`newren`](https://github.com/newren)

^([`gitster`](https://github.com/gitster))

## [`t6423, t6436`](https://github.com/git/git/commit/23bef2e33c3290ae308c2ce37e290a25eb5b97bc)：注意改进了脏文件的 ort 处理

^(签字人：以利亚·纽伦)

“递归”后端依赖于`unpack_trees()`检查未暂存的更改是否会被合并覆盖，但`unpack_trees()`不理解重命名 - 一旦它返回，它已经向工作树和索引写入了许多更新。

因此，“递归”必须进行特殊的 4 路合并，它还需要将工作副本视为额外的差异来源，我们必须小心避免覆盖并导致将文件移动到新位置以避免冲突。

**相比之下，“ort”后端在内存中进行完整的合并，并且仅在后处理步骤中更新索引和工作副本**。

如果途中有脏文件，它可以简单地中止合并。

## [`t6423`](https://github.com/git/git/commit/c12d1f2ac227cbec44be27de83ef07d135f243c2)：期望在 ort 后端改进冲突标记标签

^(签字人：以利亚·纽伦)

冲突标记带有 REF-OR-COMMIT:FILENAME 形式的额外注释，以帮助区分内容的来源，`:FILENAME`如果历史的双方相同，则忽略该片段（因此只有带有内容冲突的重命名带有注释的那一部分）。

但是，在某些情况下`:FILENAME`，由于合并递归的每个代码路径需要所有特殊情况代码格式的副本，注释被意外遗漏了。

## [`t6404, t6423`](https://github.com/git/git/commit/727c75b23f25f752810f412e936d420f5c7fee04)：期望在 ort 后端改进重命名/删除处理

^(签字人：以利亚·纽伦)

当文件被重命名并且有内容冲突时，merge-recursive 在索引中没有旧文件名的一些阶段和新文件名的一些阶段；相反，它将与旧文件名对应的所有阶段复制到新文件名的相应位置，因此三个更高阶阶段都对应于新文件名。

这样做使用户更容易访问不同的版本并解决冲突（无需手动' [`git rm`](https://github.com/git/git/blob/727c75b23f25f752810f412e936d420f5c7fee04/Documentation/git-rm.txt)' ^(（[man](https://git-scm.com/docs/git-rm)）)旧版本以及' [`git add`](https://github.com/git/git/blob/727c75b23f25f752810f412e936d420f5c7fee04/Documentation/git-add.txt)' ^(（[man](https://git-scm.com/docs/git-add)）)新版本）。

重命名/删除应该以类似方式处理——重命名文件应该有两个阶段，而不仅仅是一个阶段。

我们现在不想破坏合并递归，因此更新相关测试以根据“ `recursive`”或“ `ort`”合并策略是否正在使用而具有不同的期望。

使用 Git 2.30（2021 年第一季度），为新的合并策略做准备。
请参阅[Elijah Newren ( ) 的提交](https://github.com/newren)[848a856](https://github.com/git/git/commit/848a856b136c6aaeb2b7944add318485c6c6d6ae)、提交[fd15863](https://github.com/git/git/commit/fd15863ec8a90a4c2b4429f5f5de370c8599e700)、提交[23bef2e](https://github.com/git/git/commit/23bef2e33c3290ae308c2ce37e290a25eb5b97bc)、[提交 c8c35f6](https://github.com/git/git/commit/c8c35f6a02f3841d4383a5ce4c9d8e426776d151)、[提交 c12d1f2](https://github.com/git/git/commit/c12d1f2ac227cbec44be27de83ef07d135f243c2)、[提交 727c75b](https://github.com/git/git/commit/727c75b23f25f752810f412e936d420f5c7fee04)、[提交 489c85f](https://github.com/git/git/commit/489c85ff43b292cc22ae2e003fad74c75f7ae190)、[提交 ef52778](https://github.com/git/git/commit/ef527787089ce9a5c137ffde24701dfb7fda841c)、[提交 f06481f](https://github.com/git/git/commit/f06481f12732e846c0572a0109e2c5b5684f508a)（2020 年 10 月 26 日[）](https://github.com/newren)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 66c62ea](https://github.com/git/git/commit/66c62eaec66bb585caabf560a5e1e49cd64e7a1f))^(中，2020 年 11 月 18 日）)[`newren`](https://github.com/newren)

^([`gitster`](https://github.com/gitster))

## [`merge tests`](https://github.com/git/git/commit/ef527787089ce9a5c137ffde24701dfb7fda841c)：期望在 ort 中改进目录/文件冲突处理

^(签字人：以利亚·纽伦)

[`merge-recursive.c`](https://github.com/git/git/blob/ef527787089ce9a5c137ffde24701dfb7fda841c/merge-recursive.c)建立在跑步的想法上`unpack_trees()`，然后“做一些小的修饰”以获得结果。

不幸的是，`unpack_trees()`它以“即用即更新”模式运行，导致[`merge-recursive.c`](https://github.com/git/git/blob/ef527787089ce9a5c137ffde24701dfb7fda841c/merge-recursive.c)紧随其后并最终得到立即评估和“即用即修复”设计。

诸如目录/文件冲突之类的某些事情在索引数据结构中不能很好地表示，并且需要特殊的额外代码来处理。

但是后来发现目录/文件冲突也可能涉及重命名/删除冲突时，必须将特殊的目录/文件冲突处理代码复制到重命名/删除代码路径中。

...然后必须复制它以进行修改/删除，以及重命名/重命名（1to2）冲突，...但它仍然错过了一些。

此外，当发现还存在文件/子模块冲突和子模块/目录冲突时，我们需要将特殊子模块处理代码复制到整个代码库中的所有特殊情况。

然后发现我们对目录/文件冲突的处理不是最理想的，因为它会创建未跟踪的文件来存储冲突文件的内容，如果有人运行' [`git merge --abort`](https://github.com/git/git/blob/ef527787089ce9a5c137ffde24701dfb7fda841c/Documentation/git-merge.txt#L95)' ^(（[man](https://git-scm.com/docs/git-merge#Documentation/git-merge.txt---abort)）)或' [`git rebase --abort`](https://github.com/git/git/blob/ef527787089ce9a5c137ffde24701dfb7fda841c/Documentation/git-rebase.txt#L250)' ，这些文件将不会被清理^(（[男](https://git-scm.com/docs/git-rebase#Documentation/git-rebase.txt---abort)）)。

考虑到索引中的目录/文件冲突，尝试添加或删除与这些文件对应的索引条目也是困难或可怕的。

但是更改[`merge-recursive.c`](https://github.com/git/git/blob/ef527787089ce9a5c137ffde24701dfb7fda841c/merge-recursive.c)以正确处理这些是一件非常痛苦的事情，因为代码中有很多站点具有相似但不相同的代码来处理目录/文件/子模块冲突，都需要更新。

我一直在努力通过单个代码路径在 merge-ort 中推送所有目录/文件/子模块冲突处理，并避免创建未跟踪的文件来存储跟踪的内容（它确实在备用路径上记录内容，但确保它们具有更高阶的阶段在索引中）。

随着 Git 2.31（2021 年第一季度），“正确完成”的合并后端开始出现。

例子：
请参阅[Junio C Hamano ( ) 的](https://github.com/gitster)[提交 6d37ca2](https://github.com/git/git/commit/6d37ca21651408b6d29b86a67d0179eb98629fd8)（2020 年 11 月 11 日[）](https://github.com/gitster)。
请参阅[提交89422D2](https://github.com/git/git/commit/89422d29b1d63004683aaa6d11faa65ba734d46f)，[提交7681CE5](https://github.com/git/git/commit/ef2b369387004f4f11497a55174d0d9859549054)，[提交9fefce6](https://github.com/git/git/commit/70912f66de751b2f1af145887dc64c9c0d06de36)，[提交BB470F4](https://github.com/git/git/commit/6681ce5cf6a869aa73cfe56d041dce133262587a)，[提交EE4012D](https://github.com/git/git/commit/9fefce68dc85d96781090f86c067d83f7c50b617)，[提交A9945BB](https://github.com/git/git/commit/bb470f4e13e90889030d48f618ded5c0961943a3)，[Commit 8ADFFAA，提交6A02DD9，Commit 291F29C](https://github.com/git/git/commit/ee4012dcf962fa26ae83d1e7ff28263b9d2d1452)，[提交98BF984](https://github.com/git/git/commit/a9945bba600914bc8feb7aa52dce7b8e41237649)，[Commit 34E557A，提交D2BC199，提交0C0D705，提交0C0D705，提交D2BC199](https://github.com/git/git/commit/8adffaa818d17595b23959e995ad395c8cd0b0be)，[提交885595BB](https://github.com/git/git/commit/6a02dd90c99c59eada5e5b80e7140e56c1d4a2b0)，[Commit 8ADFFCE6](https://github.com/git/git/commit/291f29caf6b045576f9953f0ea41fc8367966750)，[Commit 9fefce6](https://github.com/git/git/commit/98bf98416726430b6cbc8670725f008588e478a7)，[Commit 9fefce6](https://github.com/git/git/commit/34e557af5469299453f63d3594d5b392a09937d1)，[Commit 9fefce6](https://github.com/git/git/commit/885f0063e9962068d381ca5256ca49070bb2480c)，[Commit 9fefce6](https://github.com/git/git/commit/d2bc1994f363ac2049da0cdd0b8a7bed61eeaab0)，[Commit 9fefce6](https://github.com/git/git/commit/0c0d705b5cba39c70b01b8b21e2c4d3ca014daf3)，[Commit 。](https://github.com/git/git/commit/c8017176ac8fb5cc85ca8742bbdeec8943427340) [c801717](https://github.com/git/git/commit/c8017176ac8fb5cc85ca8742bbdeec8943427340)[`gitster`](https://github.com/gitster)
，[提交 e4171b1](https://github.com/git/git/commit/e4171b1b6d32a147638f52c3199477d3ea161b3e)，[提交 231e2dd](https://github.com/git/git/commit/231e2dd49d11c1ea5d19956920651bd3a90ccfce)，[提交 5b59c3d](https://github.com/git/git/commit/5b59c3db059d85306ebeb680c4d322a69ee29fde)（2020 年 12 月 13 日），作者[Elijah Newren ( `newren`)](https://github.com/newren)。

^(（由[Junio C Hamano 合并 -- `gitster`--](https://github.com/gitster)在[提交 f9d29da](https://github.com/git/git/commit/f9d29daba64ae2c81ed62d0c1f4c5e4493247f6b)中，2021 年 1 月 6 日）)

## [`merge-ort`](https://github.com/git/git/commit/ef2b369387004f4f11497a55174d0d9859549054): 添加实现`record_conflicted_index_entries()`

^(签字人：以利亚·纽伦)

之后`checkout()`，工作树具有相应的内容，并且索引与工作副本匹配。

这意味着所有未修改和干净合并的文件都有正确的索引条目，但需要更新冲突的条目。

我们通过遍历冲突的条目来做到这一点，用 标记路径的现有索引条目，`CE_REMOVE`在索引末尾为路径添加新的高阶暂存（忽略正常的索引排序顺序），然​​后在循环结束时删除`CE_REMOVED-marked`缓存条目并对索引进行排序。

在 Git 2.31（2021 年第一季度）中，重命名检测被添加到“ORT”合并策略中。
请参阅[提交 6fcccbd](https://github.com/git/git/commit/6fcccbd75556d1dcc80493f6eb51109f53a5dc83)、[提交 f1665e6](https://github.com/git/git/commit/f1665e69188f54c941f9bf10ed388a72a91cc2a1)、[提交 35e47e3](https://github.com/git/git/commit/35e47e3514b5129e6075a67fa9f4659da2f1a1a1)、[提交 2e91ddd](https://github.com/git/git/commit/2e91ddd24e7240460fd2a9aee1962345ed858b6b)、[提交 53e88a0](https://github.com/git/git/commit/53e88a03539db70a7e990489784400b0b2916fa9)、[提交 af1e56c](https://github.com/git/git/commit/af1e56c49e61a39d5a7d78cecb97f350b5a3834a)（2020 年 12 月 15 日）和[提交 c2d267d](https://github.com/git/git/commit/c2d267df0215d49f06638463889465389134021a) [、](https://github.com/newren)提交[965a7bc](https://github.com/git/git/commit/965a7bc21c6bb11fb15eb798fd472ec9deb5e3fa)、[提交 f39d05c](https://github.com/git/git/commit/f39d05ca2637dfcbf0498824d06e7854427936a5)、[提交 e1a124e](https://github.com/git/git/commit/e1a124e8dc3d21afedc80cc2842d705c1d5a90c9)、[提交 864075e](https://github.com/git/git/commit/864075ec433644e5908589fe79f8b3296f896867)（14 月 14日[）](https://github.com/newren)^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 2856089](https://github.com/git/git/commit/2856089e367cc126f70d0a3d6d6ff5290d204f2e))^(中，2021 年 1 月 25 日）)[`newren`](https://github.com/newren)

^([`gitster`](https://github.com/gitster))
例子：

## [`merge-ort`](https://github.com/git/git/commit/f1665e69188f54c941f9bf10ed388a72a91cc2a1): 添加正常重命名处理的实现

^(签字人：以利亚·纽伦)

实现对正常重命名的处理。

此代码替换以下内容`merge-recurisve.c`：

*   `RENAME_NORMAL`与in相关的代码`process_renames()`

*   的`RENAME_NORMAL`情况`process_entry()`

此外，还有一些来自[`merge-recursive.c`](https://github.com/git/git/blob/f1665e69188f54c941f9bf10ed388a72a91cc2a1/merge-recursive.c)多个不同重命名案例的共享代码，我们将不再需要这种情况（或其他重命名案例）：

*   `handle_rename_normal()`

*   `setup_rename_conflict_info()`

通过改变设计将四个独立的代码路径合并为一个成为可能：`process_renames()`调整其中的`conflict_info`条目`opt->priv->paths`，以便`process_entry()`可以正交处理所有非重命名冲突类型（目录/文件、修改/删除等）。

这意味着我们不太可能错过某种冲突类型组合的特殊实现（参见[66c62ea](https://github.com/git/git/commit/66c62eaec66bb585caabf560a5e1e49cd64e7a1f)引入的提交（“Merge branch 'en/merge-tests'”，2020-11-18，Git v2.30.0 -rc0 --批处理中列出的[合并](https://github.com/git/git/commit/66c62eaec66bb585caabf560a5e1e49cd64e7a1f)[#6](https://github.com/git/git/commit/faefdd61ec7c7f6f3c8c9907891465ac9a2a1475)），尤其是[提交 ef52778](https://github.com/git/git/commit/ef527787089ce9a5c137ffde24701dfb7fda841c)（“合并测试：期望在 ort 中改进目录/文件冲突处理”，2020-10-26，Git v2.30.0-rc0 --批处理中列出的[合并](https://github.com/git/git/commit/66c62eaec66bb585caabf560a5e1e49cd64e7a1f)[# 6](https://github.com/git/git/commit/faefdd61ec7c7f6f3c8c9907891465ac9a2a1475)）了解更多详情）。

这与让工作树/索引更新在`merge_switch_to_result()`函数中正交处理一起，极大地简化了各种特殊重命名情况的代码。

（公平地说，处理正常重命名的代码之前并没有那么复杂，但现在它仍然简单得多。）

而且，仍然使用 Git 2.31（2021 年第一季度），使用 Git 2.31（2021 年第一季度），oRT 合并策略学习了对合并冲突的更多支持。
请参阅[Elijah](https://github.com/git/git/commit/4ef88fc3a8d402de272c6bfa36538bd8e4cdd439) [Newren (](https://github.com/newren) ) 提交的 4ef88fc 、[commit 4204cd5](https://github.com/git/git/commit/70f19c7fced2ec49fd9bca827370835d84d782c7)、[commit](https://github.com/git/git/commit/4204cd591b62f3e184f617d01b282b9847298dbd) 70f19c7 、 commit [c73cda7](https://github.com/git/git/commit/c73cda76b104795d1455ecbf031a18045ab37a84)、[commit f591c47](https://github.com/git/git/commit/f591c4724615b2fc1e4dc3d6bfe5da96a88eacbe)、[commit 62fdec1](https://github.com/git/git/commit/62fdec17a111e419b750938d24b6d65e3076b76d)、[commit 991bbdc](https://github.com/git/git/commit/991bbdcab94d93c2a325c4ce74cff139f0f49d97)、[commit 5a1a1e8](https://github.com/git/git/commit/5a1a1e8ea9fdd4a575c711b91f176838ea502e44)、[commit 23366d2](https://github.com/git/git/commit/23366d2aa97544fe76bc86964f4493b7b89e7b22)、[commit 0ccfa4e](https://github.com/git/git/commit/0ccfa4e5d8489abe7c5d3fe29b68e4fe0cae6fe1) (01 Jan 2021 [)](https://github.com/newren)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 b65b9ff](https://github.com/git/git/commit/b65b9ff1ff8a809246cc6bd8ad9051b28e5bf330))^(中，2021 年 2 月 5 日）)[`newren`](https://github.com/newren)

^([`gitster`](https://github.com/gitster))

## [`merge-ort`](https://github.com/git/git/commit/4ef88fc3a8d402de272c6bfa36538bd8e4cdd439): 在同一路径添加对不同类型文件的处理

^(签字人：以利亚·纽伦)

添加一些明确考虑以下类型冲突的处理：

*   文件/子模块

*   文件/符号链接

*   submodule/symlink> 将它们作为冲突留在同一路径上对于用户来说很难解决，因此将它们中的一个或两个移到一边，以便他们各自获得自己的路径。

请注意，在递归处理（即

`call_depth > 0`）的情况下，我们可以只使用两个合并基的合并基作为合并结果，就像我们对修改/删除冲突、二进制文件、冲突子模块值等所做的那样。

        java - Java Driver.getConnection() 在实时系统上从 mysql 产生“拒绝连接”，而不是 dev

ID：366861

赞同：3

时间：2008-12-14T19:12:47.897

标签：java, mysql, jdbc

很简单的东西，在这里——我只是对mysql不够好，无法理解它对我的要求。

我有一个简短的 java 测试用例，它在我的开发系统上的 mysql 上打开一个连接，但是当我尝试将它放到我的服务器上时，它失败了。

任何有助于追踪这一点的帮助将不胜感激。

谢谢！

**测试代码**

```
import  java.util.*;
import  java.sql.*;

public  class   mysqltest {

    static  public  void  getDBConnection() {
        System.out.println ("Start of getDBConnection.");

        Connection  conn        = null;
        String      url         = "jdbc:mysql://localhost:3306/";
        String      dbName      = "magnets_development";
        String      driver      = "com.mysql.jdbc.Driver";
        String      userName    = "*****";  // blanked for publication
        String      password    = "*****";

        try {
            Class.forName (driver).newInstance();
            System.out.println ("driver.newInstance gotten.");
            conn = DriverManager.getConnection (url+dbName, userName, password);
            System.out.println ("Connection gotten: " + conn + ".");
            Statement sql     = conn.createStatement ();
            ResultSet results = sql.executeQuery ("use " + dbName + ";");
        }
        catch (Exception ex) {
            System.out.println ("*** Got exception.");
            ex.printStackTrace();
        }
    }

    public static void main(String args[]) {
        System.out.println ("Main started.");
        mysqltest.getDBConnection();
    }
} 
```

**开发系统输出** *（预期/正确响应）*

```
olie$ java mysqltest
Main started.
Start of getDBConnection.
Properties set.
driver.newInstance gotten.
Connection gotten: com.mysql.jdbc.Connection@c980c9.
olie$ 
```

**服务器输出** *（我正在尝试追踪的错误）*（删除了一些空白行。）

```
mini$ java mysqltest
Main started.
Start of getDBConnection.
Properties set.
driver.newInstance gotten.
*** Got exception.
com.mysql.jdbc.CommunicationsException: Communications link failure due to underlying exception: 

** BEGIN NESTED EXCEPTION ** 

java.net.ConnectException
MESSAGE: Connection refused

STACKTRACE:

java.net.ConnectException: Connection refused
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:432)
    at java.net.Socket.connect(Socket.java:520)
    at java.net.Socket.connect(Socket.java:470)
    at java.net.Socket.<init>(Socket.java:367)
    at java.net.Socket.<init>(Socket.java:209)
    at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:256)
    at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:271)
    at com.mysql.jdbc.Connection.createNewIO(Connection.java:2771)
    at com.mysql.jdbc.Connection.<init>(Connection.java:1555)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:285)
    at java.sql.DriverManager.getConnection(DriverManager.java:525)
    at java.sql.DriverManager.getConnection(DriverManager.java:140)
    at mysqltest.getDBConnection(mysqltest.java:34)
    at mysqltest.main(mysqltest.java:49)

** END NESTED EXCEPTION **

Last packet sent to the server was 3 ms ago.
    at com.mysql.jdbc.Connection.createNewIO(Connection.java:2847)
    at com.mysql.jdbc.Connection.<init>(Connection.java:1555)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:285)
    at java.sql.DriverManager.getConnection(DriverManager.java:525)
    at java.sql.DriverManager.getConnection(DriverManager.java:140)
    at mysqltest.getDBConnection(mysqltest.java:34)
    at mysqltest.main(mysqltest.java:49)
mini$ 
```

            回答 #1

赞同：16

时间：2011-04-07T05:33:43.953

只是关于这个主题的有用说明。我花了至少 30 分钟尝试调试相同的错误，这是我的错误。

在我的 MySQL conf 文件中，我碰巧将*BIND ADDR*设置为机器的 IP。我没有将其设置为`127.0.0.1`, 或`0.0.0.0`。所以 MySQL 会接受来自外部的 JDBC 连接，但不会接受内部的 JDBC 连接。仅当从本地计算机连接时，我才收到拒绝连接。

更改该地址以`0.0.0.0`允许它侦听对任何 IP 的请求。这允许内部和外部 IP。  

希望这可以帮助那些犯了同样愚蠢错误的人。用上面关于`netstat -an | grep 3306`.

            回答 #2

赞同：6

时间：2008-12-15T05:20:42.583

呸! 抱歉——我刚刚设置了“仅限本地连接”。我对 java 应用程序在本地运行这一事实感到困惑（所以看起来是“本地连接”，但是因为它是通过 TCP 连接的，所以它是一个“远程”连接，即使它起源于 localhost。

我最终将学习如何管理这些事情。同时，我希望别人能从我的错误中吸取教训。

感谢所有花时间帮助我的人。从那以后我允许“远程”连接，但我所有的用户帐户都只是“用户名”@“本地主机”（*即*，没有“用户名”@“%”，这将允许任何机器连接。）希望，至少我说对了那部分。

再次感谢！

            回答 #3

赞同：2

时间：2008-12-14T20:37:21.377

此外，请确保您的 MySQL 服务器的数据库用户帐户允许来自除 localhost 之外的其他地址的连接。出于安全原因，在较小的服务器中，可以（并且可能是默认设置？）限制与 localhost 的连接，以便只有本地 Web 应用程序可以使用幻数用户/密码组合访问数据库。

            回答 #4

赞同：1

时间：2008-12-14T21:16:56.040

“连接被拒绝”消息只有一个原因，不管它是 mysql 还是任何其他服务。服务器没有在听。尝试“netstat -an”和 grep 端口 3306 来验证它。

            回答 #5

赞同：0

时间：2008-12-14T19:17:29.087

您是否验证了您可以使用名称和密码连接到服务器上的数据库。  

此外，如果您通过 url 连接，则不需要以下行。

```
properties.setProperty("socket", "/Applications/MAMP/tmp/mysql/mysql.sock"); 
```

上面的属性似乎是 OS X 特有的。你是在 os X 上运行服务器吗？

            回答 #6

赞同：0

时间：2008-12-14T20:33:59.667

您的 URL 中包含 localhost。您是否尝试连接到网络上的此服务器？您的网址可能不正确。

            回答 #7

赞同：0

时间：2013-06-25T03:35:05.063

/* 回答日期是过期，但我的回答是未来 */

我也有同样的问题。

我该如何解决？

回答：

打开您的 Xammp 或其他服务器，然后运行 ​​MYSQL...。如果 SQL 未运行，则会抛出异常。

            回答 #8

赞同：-1

时间：2008-12-15T04:13:19.817

这是我在 os X 上的 mysql 上工作的代码

```
public SQL(String host, String port, String database, String userid, String password)
    {
        queryType = QUERYTYPE.Single;
        String driver = "org.gjt.mm.mysql.Driver";
        String url = "jdbc:mysql://" + host;
        if (port != null)
            {
                url += ":" + port;
            }
        else
            {
                url += ":" + defaultPort;
            }
        url += "/" + database;
        try
            {
                Class.forName(driver);

                connection = DriverManager.getConnection(url, userid, password);
            }
        catch (Exception e)
            {
                e.printStackTrace();
            }
    } 
```

        sql - 有没有办法避免使用约束或触发器在特定表上删除行？

ID：366883

赞同：9

时间：2008-12-14T19:30:45.893

标签：sql, sql-server, database, constraints

有没有办法避免使用约束在特定表上删除行？

如果 id 为 0,1 或 2，我想（例如）拒绝删除行

这是为了避免用户删除应用程序的主帐户，即使有人直接使用 sql 尝试（错误地），我也想避免它。

谢谢！

**编辑：**

这个问题的整个想法是不要触及应用程序。这不是安全问题，我只需要知道是否可以使用约束或 SQL Server 具有的任何其他东西来做我所要求的事情（它不需要是标准的数据库解决方案）。

**编辑2：**

代码示例非常非常感谢：D

            回答 #1

赞同：10

时间：2008-12-14T20:04:12.130

至于在*约束*中执行这一点，我的解决方案是创建一个依赖表，因此不能删除引用的行。  

```
CREATE TABLE NoKillI (
  id INT NOT NULL, FOREIGN KEY (id) REFERENCES Accounts(id) ON DELETE RESTRICT
);
INSERT INTO NoKillI (id) VALUES (0);
INSERT INTO NoKillI (id) VALUES (1);
INSERT INTO NoKillI (id) VALUES (2); 
```

现在没有人可以删除`Accounts`id 值为 0、1 或 2 的行，除非他们先删除`NoKillI`. 您可以使用 SQL 权限限制对依赖表的删除。

            回答 #2

赞同：5

时间：2008-12-14T19:45:40.903

您可以通过为相关表编写一个在 DELETE 上触发的数据库触发器来完成此操作。如果 ID 无效，它需要做的就是抛出异常。

            回答 #3

赞同：3

时间：2008-12-14T20:15:21.093

如果您不信任您的用户，请添加安全性。

1.  添加一个存储过程，允许用户删除他们想要的行，但根据您自己的规则禁止您想要的任何行。然后拒绝对表的删除访问，并允许对存储过程的执行访问
2.  添加带有外键引用的辅助表，调用表 MasterAccounts 或类似的表，拒绝更新/删除对该表的访问，并将对该表的引用添加到相关帐户，这将防止任何人删除帐户，只要有此表对它的引用
3.  [按照OrbMan](https://stackoverflow.com/users/39430/orbman)的建议添加触发器
4.  添加可以删除行的视图，使视图跳过所有不允许删除的帐户，拒绝对主表的删除访问，并允许删除访问查看

话虽如此，如果您的用户有足够的访问权限通过 SQL 与您的数据库对话，那么您实际上只是在自找麻烦。您应该加强安全性，并且只允许通过您的应用程序和已建立的协议访问数据库。然后你有很多选择来避免这样的问题。

            回答 #4

赞同：1

时间：2008-12-14T22:16:22.660

我正在使用以下触发器：

```
CREATE TRIGGER [dbo].[mytable_trd] ON [dbo].[mytable]
WITH EXECUTE AS CALLER
INSTEAD OF DELETE
AS
BEGIN
SET NOCOUNT ON
DECLARE @tn varchar(255)
SELECT @tn = object_name(parent_obj)
FROM sysobjects
WHERE id = @@procid;

SET @tn = 'Deletes not allowed for this table: ' + @tn;
-- Add your code for checking the values from deleted
IF EXISTS(select * from deleted where mycolumn = 1)
  RAISERROR (@tn, 16, 1)    
END
GO 
```

            回答 #5

赞同：0

时间：2008-12-14T20:55:58.343

您确定您永远不希望任何人删除这些行是真的吗？甚至你自己，还是dba？还是 dbms 维护工作？

如果只是*一些*用户，那么您将需要具有权限的用户表之类的东西，以便可以在触发器中查询它以区分未经授权的用户和授权用户。

            回答 #6

赞同：0

时间：2008-12-14T22:37:28.980

我更喜欢的解决方案使用关系模型及其完整性规则。

对于`Tbl_Account`无法删除的每条记录，我会在`Tbl_AccountMaster`其中添加`Tbl_Account.id_Account`一条外键记录。`Tbl_AccountMaster`不可用于更新，除非由数据库管理员提供。然后没有其他人可以删除`Tbl_Account`链接到的记录`Tbl_AccountMaster`。

[编辑：我刚刚注意到这里](https://stackoverflow.com/questions/366883/is-there-a-way-to-avoid-row-deletion-on-an-specific-table-using-constrains-or-t#366918)提出了同样的想法。谢谢比尔！

            回答 #7

赞同：-1

时间：2008-12-14T19:36:48.503

您可以尝试通过使用检查以确保用户不会尝试删除您的主帐户的功能来过滤您的查询。

        javascript - 使用 Javascript 的“好部分”的最佳方式

ID：366887

赞同：14

时间：2008-12-14T19:34:00.413

标签：javascript, abstraction

在 Stackers 的推荐下，我一直在阅读 Crockford 的优秀*Javascript: The Good Parts*。

这是一本很棒的书，但由于其中大部分内容都致力于描述使用 Javascript 基本功能的最佳方式，我不确定如何在不重复许多其他 Javascript 程序员的努力的情况下将他的建议付诸实践。

以这段话为例：

当您制作一个新对象时，您可以选择应该作为其原型的对象。Javascript 提供的用于执行此操作的机制混乱而复杂，但可以大大简化。我们将向函数添加一个`create`方法`Object`。该`create`方法创建一个使用旧对象作为其原型的新对象。

```
if (typeof Object.create !== 'function') {
 Object.create = function(o) {
  var F = function () {};
  F.prototype = o;
  return new F();
} 
```

我可以手动将此代码添加到我所有的 Javascript 项目中，但跟踪所有内容将是一个巨大的痛苦。

**是否有任何库实现了*The Good Part*的建议，从而省去了我必须跟踪它们的麻烦（/将它们全部输入）？**

            回答 #1

赞同：5

时间：2008-12-14T20:01:51.680

[Prototype](http://prototypejs.org/)有很多很棒的特性，包括一个通过对象原型处理 JS“继承”细节的[Class helper 。](http://prototypejs.org/api/class)

编辑：该死，我一直忘记 jQuery（我自己选择的库）有[jQuery.extend](http://docs.jquery.com/Utilities/jQuery.extend)

            回答 #2

赞同：1

时间：2008-12-14T22:06:33.317

他不是为雅虎工作吗？您总是可以使用[Yahoo 用户界面库](http://developer.yahoo.com/yui/)。

就个人而言，我偏爱[JQuery](http://jquery.com/)，因为它让我觉得更简洁，但你知道：课程的马。

            回答 #3

赞同：1

时间：2008-12-14T22:52:20.480

[Dojo](http://dojotoolkit.org "Dojo：JavaScript 工具包")非常密切地遵循 Crockford 的想法。例如，您在函数下实现了上面的代码片段的实现`dojo.delegate`（以更快的形式）。

我不认为有一个特定的项目遵循他的建议。大多数工具包实际上不同意他的许多建议和模式。如果您想了解特定功能，例如上面的代码片段，那么值得询问您希望在项目中使用本书中的哪些特定工具。

            回答 #4

赞同：0

时间：2010-11-28T08:42:57.577

我认为 YUI 最接近 Crockford 在他的书中所教的内容。（他也是雅虎架构师，这很有意义）

            回答 #5

赞同：0

时间：2012-08-03T15:00:24.667

看看[es5-shim](https://github.com/kriskowal/es5-shim/)`Object.create()` ，一个为其他东西提供 - 尽管不完整 - shim 的库。

        iphone - 以编程方式更改 iPhone 上的背光亮度

ID：366889

赞同：2

时间：2008-12-14T19:34:41.050

标签：iphone, backlight

SDK 是否提供任何方法来改变背光的亮度，或者暂时关闭它？

            回答 #1

赞同：5

时间：2009-01-21T21:12:39.317

我正在尝试做同样的事情。碰巧的是，互联网上有许多帖子为此提供了“解决方案”。

最详细的[在这里](http://idevkit.com/forums/tutorials-code-samples-toolchain/14-controlling-brightness.html?t-14.html=)
这个比较[简洁](http://tlog.fabiocaseri.com/post/28024696/change-backlight-brightness-on-iphone "简洁")

问题是我已经尝试过这些，它们都依赖于调用这个函数

```
GSEventSetBacklightLevel(); 
```

这需要导入此标头

```
#import <GraphicsServices/GraphicsServices.h> 
```

并且在 SDK 报告找不到头文件时导入失败。

我已经搜索了一些解决方案，但没有找到。有一些关于“构建工具链”的讨论（有关我找到的最佳描述，请参见[此处](http://www.saurik.com/id/4)），但这似乎涉及完全绕过 SDK。相当激烈。

摘要：这是可能的，但不能使用标准的 iPhone SDK。我想 SDK 的更新很快就会到来，应该允许它。

如果您找到任何其他解决方案，请告诉我。

            回答 #2

赞同：1

时间：2008-12-14T20:36:44.950

不，这在 SDK 中不可用。如果它是您认为有用的东西，我建议您[提交增强请求](http://bugreporter.apple.com)。

            回答 #3

赞同：0

时间：2011-08-04T08:08:31.923

```
-(void)changeLight{

    GSEventSetBacklightLevel(float number);//number between 0.0 - 1.0
} 
```

使用调用上述方法

```
[self performSelector:@selector(changeLight) withObject:nil afterDelay:0.0]; 
```

您可以通过从 /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS4.2.sdk/System/Library/PrivateFrameworks/GraphicsServices.framework 拖放到您的 xcode 项目来添加私有框架。

还要在您的 .h 文件中添加 #import "GraphicsServices.h" 标头。*请记住：由于您使用的是私有框架，因此您的应用程序将在应用商店推送中拒绝*

            回答 #4

赞同：0

时间：2012-03-07T13:37:08.453

在我的 SDK (5.0.1) 中，“GraphicsServices.h”似乎不再存在，但您可以自己声明它：

```
void GSEventSetBacklightLevel(float level); 
```

请注意，链接器会报错，除非您在项目中包含框架 GraphicsServices.framework。

关于您关于关闭背光的问题，我发现您可以通过将一个非常大的负数传递给 GSEventSetBacklightLevel 来做到这一点，如下所示：

```
GSEventSetBacklightLevel(-INFINITY); 
```

在我的测试中，这将使屏幕完全变黑。

请记住，如果您显示静态图形，即使背光关闭，这仍可能导致 LCD 像素老化。如果提交到应用商店，此调用将导致拒绝。

            回答 #5

赞同：0

时间：2013-01-30T16:31:41.710

试试这个代码。我希望它有帮助...

//在视图中将出现

float prevBrightnessLevel = [UIScreen mainScreen].brightness;

[UIScreen mainScreen].brightness = 1.0;

//在视图中将消失

[UIScreen mainScreen].brightness = prevBrightnessLevel;

        delphi - 如何覆盖嵌套类型的方法？

ID：366896

赞同：2

时间：2008-12-14T19:40:24.503

标签：delphi, delphi-2009, nested-class

我在 Delphi 2009 中有一个自定义的 TObjectList 后代，我想稍微玩一下它的枚举器并向 MoveNext 方法添加一些过滤功能，以使其跳过某些对象。MoveNext 由 DoMoveNext 调用，它是一个虚拟方法，所以这应该不难重写……除了一件事。TObjectList 的 TEnumerator 不是它自己的类；它在 TObjectList 声明中声明为嵌套类型。

有什么简单的方法可以在我的后代类中覆盖 TEnumerator.DoMoveNext，还是我必须重新实现整个 TEnumerator？这不是一个很大的课程，但如果可以的话，我宁愿将冗余保持在最低限度......

            回答 #1

赞同：8

时间：2008-12-14T20:19:17.527

枚举*器是*它自己的类。它只有一个嵌套范围。要为其编写后代，您只需像往常一样声明一个类，并在指定新类的祖先时，给出完全限定的类型名称。

```
type
  TMasonEnumerator = class(TObjectList.TEnumerator)
  protected
    function DoMoveNext: Boolean; override;
  end; 
```

            回答 #2

赞同：0

时间：2008-12-14T21:01:35.803

关于枚举器的[优秀主题。](http://17slon.com/blogs/gabr/2007/03/fun-with-enumerators.html)

        java - 好的设计：如何将 InputStreams 作为参数传递？

ID：366897

赞同：8

时间：2008-12-14T19:41:24.000

标签：java, inputstream

我有一个大文件，我正在打开一个 FileInputStream。这个文件包含一些文件，每个文件都有一个从开始的偏移量和一个大小。此外，我有一个解析器应该评估这样一个包含的文件。

```
File file = ...; // the big file
long offset = 1734; // a contained file's offset
long size = 256; // a contained file's size
FileInputStream fis = new FileInputStream(file );
fis.skip(offset);
parse(fis, size);

public void parse(InputStream is, long size) {
   // parse stream data and insure we don't read more than size bytes
   is.close();
} 
```

我觉得这不是一个好的做法。有没有更好的方法来做到这一点，也许使用缓冲？

此外，我觉得 skip() 方法会大大减慢阅读过程。

            回答 #1

赞同：6

时间：2008-12-14T19:49:38.743

听起来您真正想要的是一种“部分”输入流 - 有点像 ZipInputStream，您在流中有一个流。

您可以自己编写，将所有 InputStream 方法代理到原始输入流，对偏移量进行适当调整并检查子文件末尾的读取。

你说的是那种东西吗？

            回答 #2

赞同：3

时间：2008-12-14T19:59:17.350

首先，[FileInputStream.skip() 有一个错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6294974)，它可能会使下面的文件跳过文件的 EOF 标记，所以要小心那个。

与使用 FileReader 和 FileWriter 相比，我个人发现使用 Input/OutputStreams 是一件痛苦的事情，您正在展示我对它们的主要问题：使用后需要关闭流。问题之一是您永远无法确定是否已正确关闭所有资源，除非您像这样使代码过于谨慎：

```
public void parse(File in, long size) {
    try {
        FileInputStream fis = new FileInputStream(in);
        // do file content handling here
    } finally {
        fis.close();
    }
    // do parsing here
} 
```

从某种意义上说，这当然是不好的，因为这会导致一直创建新对象，最终可能会消耗大量资源。这样做的好处当然是即使文件处理代码抛出异常，流也会关闭。

            回答 #3

赞同：2

时间：2008-12-14T19:48:44.390

这听起来像是一个典型的嵌套文件又名“zip”文件问题。

处理此问题的常用方法是为每个嵌套的逻辑流实际拥有一个单独的 InputStream 实例。这些将在底层物理流上执行必要的操作，并且缓冲可以在底层流和逻辑流上，取决于哪个最适合。这意味着逻辑流封装了有关在底层流中放置的所有信息。

例如，您可以拥有一种具有如下签名的工厂方法：

```
List<InputStream> getStreams(File inputFile) 
```

你可以对 OutputStreams 做同样的事情。

这有一些细节，但这对你来说可能就足够了吗？

            回答 #4

赞同：1

时间：2008-12-14T21:38:00.473

通常，打开文件的代码应该关闭文件—— parse() 函数不应该关闭输入流，因为它认为程序的其余部分不想继续是极其傲慢的读取包含在大文件中的其他文件。

您应该决定 parse() 的接口是否应该只是流和长度（函数能够假设文件已正确定位）或接口是否应该包含偏移量（因此函数首先定位然后读取）。两种设计都是可行的。我倾向于让 parse() 进行定位，但这不是一个明确的决定。

            回答 #5

赞同：0

时间：2008-12-14T19:48:55.297

您可以在 RandomAccessFile 上使用包装类 - 试试[这个](http://www-mipl.jpl.nasa.gov/vicar/vicar290/html/javadoc/jpl/mipl/io/streams/RandomAccessFileInputStream.html) 

您也可以尝试将其包装在 BufferedInputStream 中，看看性能是否有所提高。

        iphone - 新 iPhone 应用程序 - 如何选择要使用的 Xcode 模板？

ID：366899

赞同：19

时间：2008-12-14T19:43:21.970

标签：iphone, xcode, project, xcode-template

一般来说，我想了解在制作新的 iPhone 应用程序时使用哪些模板。谁能提供一些指导方针、提示和经验法则？

另外，我应该为此苦恼多少？如果我从错误的开始，我可以手动添加缺少的部分，这很难吗？

以下是我看到的选择供参考：

*   基于导航的应用程序    
*   OpenGL ES 应用程序    
*   标签栏应用    
*   实用程序    
*   基于视图的应用程序    
*   基于窗口的应用程序

            回答 #1

赞同：20

时间：2009-08-21T18:44:30.887

在来自 Apple 的[iPhone Development Quick Start](http://developer.apple.com/iPhone/library/documentation/Xcode/Conceptual/iphone_development/100-iPhone_Development_Quick_Start/iphone_development_quick_start.html)中，您对每个都有一个简短的描述：

*   **基于导航的应用程序。**使用多个屏幕分层呈现数据的应用程序。联系人应用程序是基于导航的应用程序的一个示例。

*   **OpenGL ES 应用程序。**使用基于 OpenGL ES 的视图来呈现图像或动画的应用程序。

*   **标签栏应用程序。**一个提供无线电界面的应用程序，允许用户从多个屏幕中进行选择。时钟应用程序是标签栏应用程序的一个示例。

*   **实用程序应用程序。**实现主视图并允许用户访问翻转视图以执行简单自定义的应用程序。Stocks 应用程序是实用程序应用程序的一个示例。

*   **基于视图的应用程序。**使用单个视图来实现其用户界面的应用程序。

*   **基于窗口的应用程序。**此模板可作为任何应用程序的起点，包含应用程序委托和窗口。当您想要实现自己的视图层次结构时，请使用此模板。

            回答 #2

赞同：13

时间：2008-12-14T20:07:10.267

从您的原型和可能的线框开始，然后正确的模板应该会跳出来。

如果这对您不起作用，那么：

1.  如果您的应用看起来像“联系人”，请使用基于导航的应用程序。

2.  如果您正在编写游戏（或类似游戏），那么 OpenGL。

3.  如果您正在编写类似“日历”的内容，请使用标签栏应用程序。

希望这可以帮助。

            回答 #3

赞同：6

时间：2008-12-15T12:45:43.917

如果您不知道要使用什么模板，您的想法似乎需要一些改进。通常，应用程序创意特别适用于其中一个模板。

不，你不应该为此苦恼。如果您从错误的模板开始，您可以毫不费力地添加缺失的部分。你甚至可以用你想要的模板创建一个全新的项目，看看他们是怎么做的，然后把它复制到你的程序中。

            回答 #4

赞同：2

时间：2009-01-14T19:58:56.483

另请注意 - 没有那么多模板。为每个项目创建一个新项目，立即构建并运行，你就会知道你需要什么。

        c# - 如何：在不通过 GetSection 调用加载的情况下使用 ConfigurationSection

ID：366902

赞同：1

时间：2008-12-14T19:48:20.943

标签：c#, configurationsection

我想加载一个特定的 ConfigurationSection，但 CLR 加载程序集的方式给我带来了一些麻烦：

我的 CustomConfigurationSection 定义在一个特定的程序集上，程序集加载的整个过程无法找到该程序集，因为我使用的是一个外部工具，它基本上加载了我的程序集，通过反射发现了一些关于它的信息，然后尝试“安装”它。非常类似于尝试安装 Windows 服务时的 installutil。

我要疯了，因为 ConfigurationManager 试图在原始进程的位置下为我的 ConfigurationSection 找到所需的程序集。我肯定知道这一点，因为我正在使用 SysInternals Process Monitor。有人可以提供一些解决方法或方向吗？

谢谢！

            回答 #1

赞同：1

时间：2008-12-17T20:02:28.357

如果您知道程序集的路径，那么您应该尝试 ConfigurationManager.OpenExeConfiguration(exePath)。

            回答 #2

赞同：0

时间：2008-12-14T20:05:30.193

如果需要您的程序集来反序列化您的自定义配置部分，但 CLR 找不到该程序集，那么我认为您不走运（或者我误解了问题？）。  

有什么方法可以让 CLR 找到您的程序集（可能提供提示路径）？如果没有，也许您最好为这些数据使用单独的 XML 文件，而不是使用 app.config/web.config。

            回答 #3

赞同：0

时间：2009-01-01T00:45:41.813

为什么在加载程序集（定义配置部分）之前尝试访问配置部分？您是否使用配置部分来定义您的程序集在哪里？如果是这样，那么您正在玩循环引用。

定义自定义配置部分的代码可以非常独立。它可以是它自己的程序集。我建议将此代码分离到它自己的程序集中并将其安装在 GAC 或运行时路径中。我不知道为什么您需要一个外部工具来“加载”读取自定义配置部分所需的代码。

            回答 #4

赞同：0

时间：2009-07-16T10:33:58.543

我面临着类似的问题。几个 DLL 被动态加载到主应用程序中。其中一些 dll 需要一个配置文件，我使用默认的 ConfigurationManager 来处理它。我可以成功检索正确的文件（基于后缀为“.config”的 dll 名称）并使用 AppSettings 和 ConnectionStrings 中的设置。

现在我正在尝试加载自定义配置部分。运行时抱怨在 dll 中找不到节类型。我已经在配置文件（在 configSections 条目中）指定了正确的 dll，并且我知道 dll 已加载，因为该 dll 实际上是插件本身。但是还是；看起来运行时只使用 GAC/bin 目录中的类型来查找配置部分。

简而言之：我尝试加载一个自定义配置部分，该部分在与尝试加载它的代码相同的 dll 中指定，但它不起作用。

        asp.net - 测试 ASP.Net 数据驱动应用程序的最佳方法

ID：366912

赞同：2

时间：2008-12-14T19:57:14.950

标签：asp.net, testing

我正在考虑设置单元测试和集成测试，但我遇到了 web.config 中的连接字符串无法用于测试的问题。我们想出的解决方案是使用另一个连接字符串进行测试，但我想知道是否有更好的方法。

问题的另一半是设置和拆除测试数据库。现在我们只有一个巨大的测试，它在运行前设置数据库，然后再将其拆除。这样我们就可以控制测试运行的顺序，以确保结果正确。

只是想看看是否有更好的方法/工具可用于测试 ASP.Net 应用程序。

            回答 #1

赞同：1

时间：2008-12-14T21:50:03.413

实际上，如上所述，在没有数据库交互的情况下模拟和使用存根来测试系统交互是很棒的，但是集成测试可能只是一种有效的方法。

您提到的关于编写数据库表和数据的脚本，然后在所有集成测试之前运行设置脚本是一种相当明智的方法。

不知道您是多少 ORM 的粉丝，但是使用 NHibernate 您可以从映射中重建您的表。重建数据库后，我通常只有一个脚本，它物理地创建对象并通过 NHibernate 持久化它们。我知道这不是最好的方法，但我通常发现我需要的启动测试数据量并没有那么大，而且通过 NHibernate 插入本身就是一个测试:-)。

我从未使用过“Mike Scott”提到的[Fitnesse](http://fitnesse.org/)，但我听说过好东西，而且它看起来确实很有趣。[臭名昭著的比利·麦卡弗蒂 ( Billy McCafferty](http://www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx) ) 文章也推荐了它，该
文章简要介绍了一些很棒的通用开发最佳实践，例如单元测试、ddd、按合同设计等。

            回答 #2

赞同：0

时间：2008-12-14T20:47:51.183

推荐的方法是构建您的系统，您可以在没有数据库的情况下测试您的代码。从代码的角度来看，这意味着使用关注点分离。您希望将所有核心业务逻辑与您的页面分开。您可以使用 MVC 或 MPV 模式来做到这一点，如果您做得好，您会发现很多。

现在有 ASP.Net MVC；然而，早在这个框架存在之前，MVC 模式就已经在 ASP.Net 中使用了，所以如果您正在考虑增强现有的 Web 表单应用程序，请确保您最终不会看到关于 ASP.Net MVC 的最新消息ASP.Net 中的编程模型。

现在假设您有处理与页面隔离的按钮单击的核心逻辑，因此您有一个类，我们将其称为 WidgetController。小部件控制器可能有一个 HandleClick() 方法来执行您的业务逻辑。

让我们进一步假设您的业务逻辑需要数据访问。您可以再次使用关注点分离。您的业​​务逻辑不应该关心如何访问数据库，它所需要的只是让另一个类获取数据的数据。分离数据的一种流行方法是使用 Depedancy Injection 或 Inversion of Control 模型（DI，IoC）。本质上，您所做的是为您的数据访问定义一个接口，并且您的控制器将针对该接口进行编程。然后，您在运行时通过某种方法（属性、构造函数等...）向您的控制器提供实际的类

它的作用是允许您在运行时提供 MOCK 实现，将您的数据库分开。模拟将实现您的接口，您可以新建测试需要将它们存储在内存中的对象。

            回答 #3

赞同：0

时间：2008-12-14T21:04:09.467

在您的单元测试中，隔离数据访问代码并将其抽象化（通常使用接口，例如[存储库模式](http://martinfowler.com/eaaCatalog/repository.html)），这样您的单元测试中就没有任何数据库代码。相反，使用模拟框架（例如[Moq](http://code.google.com/p/moq/)）模拟您的数据访问抽象。这样，您的测试将运行*得很快*，这是您确保经常运行所有测试所需要的。

当您需要测试整个系统（包括数据库）时，您就是在进行*集成测试*。为此，请查看[Fitnesse](http://fitnesse.org/)。有一[本很好的书](https://rads.stackoverflow.com/amzn/click/com/0321269349)。

        ruby-on-rails - 基本 Rails 问题：手动向数据库表中插入一行

ID：366913

赞同：3

时间：2008-12-14T19:58:41.937

标签：ruby-on-rails, ruby, activerecord

我正在学习 Rails，到目前为止进展顺利。目前我最大的问题是：如何手动将一行插入到我的数据库中？我已经准备好创建 DataTypeOne 行的脚手架，但是我希望在提交 DataTypeOne 的表单时为 DataTypeTwo 创建一行（并让它引用 DataTypeOne 的 id ......但我想我可以这样做我自己出去）。

提前致谢。

            回答 #1

赞同：5

时间：2008-12-14T20:05:53.390

您通过创建和保存新的 ActiveRecord 对象（您的模型）在数据库中创建行。

因此，在您的控制器代码中，您可以通过执行创建新的 DataTypeTwo 行

```
new_record = DataTypeTwo.new
new_record.save! 
```

            回答 #2

赞同：4

时间：2008-12-14T20:27:59.850

正如 frankodwyer 所说，您确实希望使用 Rails 关联来说明一个模型与另一个模型相关的事实。如果存在一对一的关系，那么您将使用

**属于** 

和

**has_one**

并且根据哪个模型具有外键，您可以使用一个或另一个。在您的示例中，听起来 DataTypeTwo 具有外键，返回 DataTypeOne。所以你会有这样的事情：

```
class DataTypeTwo < ActiveRecord::Base
  belongs_to :data_type_one
end

class DataTypeOne < ActiveRecord::Base
  has_one :data_type_two
end 
```

您可以像这样使用外键创建记录

```
one = DataTypeOne.create(...)
two = DataTypeTwo.create(...)
two.data_type_one = one
two.save 
```

有一些捷径，但这是它的详细要点。假设您所有的模型名称和外键都可以通过反射获得，那么您就可以了，否则您必须显式命名键。

所有这些都在 ActiveRecord 文档中详细介绍：

[http://api.rubyonrails.org/classes/ActiveRecord/Base.html](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)

            回答 #3

赞同：1

时间：2008-12-14T20:11:33.223

这是一件很常见的事情，您应该能够通过您的模型来完成它，而不必考虑手动对数据库执行任何操作。

例如，如果您希望 DataTypeTwo 引用 DataTypeOne，那是因为 DataTypeTwo '属于'DataTypeOne 吗？还是 DataTypeOne “有很多” DataTypeTwo 的东西？Rails 有约定来表达所有这些类型的关系和其他关系。当您调用“保存！”时，将对象和相关项目保存到数据库应该是自动的。相关对象上的方法。

您应该再看一些 Rails 示例和教程来了解这一点。除非您正在做一些非常不寻常的事情，否则您只需要注释您的模型并遵循约定，以便 rails 知道什么属于什么。

            回答 #4

赞同：1

时间：2008-12-14T20:15:10.483

您还可以使用以下快捷方式：

```
DataTypeTwo.create 
```

create 方法将创建一个新的 DataTypeTwo 对象并将记录保存到数据库中。

            回答 #5

赞同：1

时间：2008-12-15T07:08:23.240

除了像 Cody Caughlan 描述的那样设置适当的 ActiveRecord 关联之外，听起来您应该使用 ActiveRecord 回调来保证当您创建 DataTypeOne 时，会创建一个 DataTypeTwo 并将其与 DataTypeOne 关联。根据您的需要，我猜想`before_create`or`after_create`可以解决问题。

有关更多详细信息，请参阅[ActiveRecord::Callbacks](http://www.railsbrain.com/api/rails-2.2.2/doc/index.html?a=C00000640&name=Callbacks)的 Rails 文档。

            回答 #6

赞同：1

时间：2008-12-16T22:38:13.660

如果您需要更灵活，活动记录还为大多数 SQL 操作提供了一个 sql 接口：[数据库语句](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/DatabaseStatements.html)

            回答 #7

赞同：1

时间：2008-12-20T16:18:41.093

您不需要使用脚手架来在数据库中创建条目。你需要做的就是

```
./script/console (from your project folder) 
```

这将为您的项目提供一个命令行驱动的完整 Rails 环境。你可以在这里尝试任何东西。在您的上下文中，您可以这样做

```
record = DataTypeTwo.new(:field1 => value1, :field2 => value2)
record.save 
```

控制台也是在将其放入代码之前尝试的最佳方式

        sql - 每个标准的限制

ID：366915

赞同：3

时间：2008-12-14T20:00:08.347

标签：sql, mysql, optimization, greatest-n-per-group

我有一个文章表和一个类别表。我想为每个类别获取 7 篇文章。目前我有这个，但在大桌子上速度很慢，所以它不是一个真正的解决方案：

```
SELECT id, 
       title, 
       categories_id, 
       body, 
       DATE_FORMAT(pubdate, "%d/%m/%y %H:%i") as pubdate   
FROM articles AS t 
WHERE ( 
    SELECT COUNT(*) 
    FROM articles 
    WHERE t.categories_id = categories_id 
      AND id< t.id AND publish = 1 
      AND expires > '2008-12-14 18:38:02' 
      AND pubdate <= '2008-12-14 18:38:02' 
    ) < 7 
ORDER BY categories_id DESC 
```

使用解释，它向我显示它正在执行连接类型 ALL 和 REF。选择类型是 PRIMARY 和 DEPENDENT SUBQUERY 。

有更好的解决方案吗？

            回答 #1

赞同：5

时间：2008-12-14T22:52:05.207

这是我解决这个问题的方法：

```
SELECT a1.id, 
       a1.title, 
       a1.categories_id, 
       a1.body, 
       DATE_FORMAT(a1.pubdate, "%d/%m/%y %H:%i") as pubdate  
FROM articles AS a1
  LEFT OUTER JOIN articles AS a2
  ON (a1.categories_id = a2.categories_id AND 
     (a1.pubdate < a2.pubdate OR (a1.pubdate = a2.pubdate AND a1.id < a2.id)))
GROUP BY a1.id
HAVING COUNT(*) < 7; 
```

相关子查询通常表现不佳，因此该技术使用连接代替。

对于给定的文章，搜索与当前正在考虑的文章 (a1) 的类别相匹配的文章 (a2)，并且具有较新的日期（或`id`在相同的情况下更高的日期）。如果符合该标准的文章少于七篇，则当前一篇必须是其类别中最新的。

如果您可以依赖与`id`具有相同排序顺序的唯一列`pubdate`，那么您可以简化连接，因为在唯一列上不会有联系：

```
 ON (a1.categories_id = a2.categories_id AND a1.id < a2.id) 
```

            回答 #2

赞同：2

时间：2008-12-14T20:30:51.437

1.  桌子有多大，慢有多慢？

2.  表上有哪些索引？

3.  EXPLAIN 的全部信息是什么？

此外，这两个日期时间值是显式的，因此看起来这要么是由由其他信息组成的东西生成的代码生成的。是否还有另一种 SQL 查询，它在列表的循环中执行此操作？

目前尚不清楚选择了哪 7 篇文章 - 最新的？到哪一天？

            回答 #3

赞同：1

时间：2008-12-14T21:32:18.083

所以看起来你是在要求那些少于 7 篇文章的类别；所以这就是查询应该开始的地方——  

```
SELECT categories_id,  COUNT(1)  
FROM articles  
WHERE publish = 1 
  AND expires > '2008-12-14 18:38:02' 
  AND pubdate <= '2008-12-14 18:38:02'
GROUP BY categories_id
HAVING COUNT(1) < 7 
```

然后使它成为一个子查询：  

```
SELECT 
    c.id, c.title, c.id, a.body,  
    DATEFORMAT(a.pubdate, "%d/%m/%y %H:%i") as pubdate  
FROM categories c  
JOIN articles a ON c.id = a.categories_id  
JOIN 
(  
    SELECT DISTINCT categories_id  
    FROM articles  
    WHERE publish = 1  
        AND expires > '2008-12-14 18:38:02'  
        AND pubdate <= '2008-12-14 18:38:02'  
    GROUP BY categories_id  
    HAVING COUNT(1) <= 7  
) AS j ON c.id = j.categories_id  
ORDER BY whatever 
```

下一步是将返回的文章数量限制为 7 - 如果这看起来合适，我可以处理下一个。（按原样尝试，看看 EXPLAIN 的样子。）

编辑：将“< 7”更改为 <= 7”

            回答 #4

赞同：0

时间：2008-12-15T02:33:24.543

尽管 Bill 的查询平均而言可能会更好一些，但单次运行需要 230 秒。我没有进行完整的测试（几次运行），但它仍然太慢，所以我想更好的选择是每个类别进行 1 次查询以获取最新的 7 项 - 看起来它会比所有其他选项更快。

            回答 #5

赞同：0

时间：2008-12-14T20:21:49.457

您有多种选择 - 有些可能会导致性能问题，但这取决于许多因素。

您可以将其拆分为多个查询。一个查询可以读出所有类别：

```
SELECT categories_id FROM Categories 
```

然后对于每个类别，读出前七篇文章：

```
SELECT 
  id, 
  title, 
  ...etc.
FROM articles
where categories_id = 1 
```

...等等每个类别。

这样做的好处是更容易理解，但缺点是将一个查询变成 1 +（1* 猫的数量）。再说一次，你可以限制类别的数量，这样你就有了一些控制元素。有时你会发现 5 个简单的查询比 1 个复杂的查询要好得多！

这种假设您正在从您可以控制的某些代码中调用 SQL - 是这样吗？

            回答 #6

赞同：0

时间：2008-12-14T20:36:40.613

在测试中我发现限制 7 在 MySQL 的子查询中不起作用，请参阅 Bill 的建议，我验证它运行良好。

```
SELECT id, 
       title, 
       categories_id, 
       body, 
       DATE_FORMAT(pubdate, "%d/%m/%y %H:%i") as pubdate   
FROM articles A INNER JOIN articles B ON B.categories_ID = A.Categories_ID
WHERE A.ID IN ( 
    SELECT ID
    FROM Articles  
    WHERE categories_id = A.categories_id 
      AND publish = 1 
      AND expires > '2008-12-14 18:38:02' 
      AND pubdate <= '2008-12-14 18:38:02' 
    LIMIT 7
    ORDER BY Categories_ID DESC) 
ORDER BY B.Categories_ID DESC 
```

        c++ - 需要有关 Windows 到 OS X 端口估计和开发成本的建议。在 OS X 上

ID：366923

赞同：4

时间：2008-12-14T20:09:53.617

标签：c++, macos, qt

我是一名 10 年以上的 C++ linux/windows 开发人员，有人要求我估算将 windows 应用程序移植到 OS X 的工作量。

我之前没有在 OS X 上开发过，所以我不知道会发生什么。

它是一个 C++/Qt 应用程序，所以我想问一下：编辑器、IDE、编译器、make 工具等事实上的工具是什么？哪些工具是商业的并且需要购买？

我需要多长时间才能适应环境并提高工作效率？

提前致谢，

保罗

            回答 #1

赞同：7

时间：2008-12-14T20:18:00.197

你很幸运，你的应用程序在 Qt 中，TrollTech 有很多关于如何做到这一点的文档；在 OS X 上开发与在 Linux 上开发非常相似，请务必查看 MacPorts 项目 ( [http://www.macports.org](http://www.macports.org) )，它类似于 Mac 的 apt-get/yum。您的工具链是通常的嫌疑人 - gcc/make/autoconf 等...

            回答 #2

赞同：2

时间：2008-12-14T21:03:24.460

至于 IDE/编辑器，Apple 的 XCode 随操作系统一起提供（[http://developer.apple.com/Tools/xcode/](http://developer.apple.com/Tools/xcode/)）。

但是，与我交谈过的所有人都喜欢尽可能使用 Textmate 编辑器（共享软件，48.75 欧元，[http](http://macromates.com/) ://macromates.com/ ）。

获得生产力需要多长时间很大程度上取决于您之前使用 Mac 的经验。只是很多小的用户界面差异让新手很难过，就像从 Windows 迁移到 Gnome 或从 Gnome 迁移到 KDE。

默认的 shell 是 bash，所以应该很熟悉。大多数命令行工具与其他 BSD 系统上的相同，并且与通常的 GNU/Linux 工具非常相似。

            回答 #3

赞同：2

时间：2008-12-14T23:09:23.893

正如 jakber 已经[发布](https://stackoverflow.com/questions/366923/need-advice-on-windows-to-os-x-port-estimation-and-cost-of-dev-on-os-x#366983)的那样，XCode 是 MacOSX 的标准 IDE，并且是免费的（随附安装 DVD 或可以从 Apple 下载。

XCode IDE 与 Visual Studio 完全不同，在我看来，它对 Codewarrior 来说更熟悉。我不知道是否有任何工具可以将 VS 项目转换为 XCode，但是有一些工具，如[CMake](http://www.cmake.org/)，您可以在其中描述您的项目并使其生成 Visual Studio 解决方案和 XCode 项目（以及更多）。

很难估计一个特定的人在一个环境中需要多少时间来提高工作效率，如果你不定义你习惯的工作方式，那就更难估计了。例如，如果您使用 KDevelop，那么它在 MacOSX 下直接可用。此外，有些人比其他人更依赖 IDE 提供的工具（例如源导航）。

最后，Microsoft 编译器和 g++（在 linux 和 MacOSX 中都使用）中的编译器错误是不同的，您必须习惯它。

后期：

作为对您评论的回答，MacOSX 有不止一个编译器。操作系统附带的标准是 gcc (4.0.1)，但您可以购买[Intel 编译器](http://www.intel.com/cd/software/products/asmo-na/eng/227389.htm)或其他前端，如[comeau](http://www.comeaucomputing.com/)到 gcc。

            回答 #4

赞同：1

时间：2008-12-15T07:04:48.800

如果你所有的代码都是 Qt，让它在 OSX 或 linux 上编译和运行并不是一件大事，但如果你使用其他 Windows 特定的东西，可能需要一些时间。mutch 的多少取决于你编程了多少，项目有多大，你对 g++ 的经验等等。

Trolltech 发布了一个可以下载的 IDE Qt Creator 的测试版，我上周在 linux 和 OSX 上下载并测试了它，它可以工作，但我刚刚测试过。

如果是开源项目，则无需购买任何东西，如果不是，则需要购买 Qt。

请记住估计您需要多长时间，然后将其计时 3，您可能已接近您需要的时间。

        linq-to-sql - LINQ to SQL 自动生成的可扩展性方法

ID：366926

赞同：0

时间：2008-12-14T20:12:15.030

标签：linq-to-sql, extension-methods

当我使用 LINQ to SQL 生成实体类时，我得到了我想要的，但我也得到了一堆其他的可扩展性方法定义。

例如 myField (TEXT) 我得到：

```
 partial void OnMyFieldChanging(string value);
   partial void OnMyFieldChanged(); 
```

上述可扩展性方法的常见用途是什么？

            回答 #1

赞同：2

时间：2008-12-14T20:53:30.360

我见过的大多数覆盖这些方法的例子都是用于验证。

```
partial void OnMyFieldChanging(string value)
{
  if(value == valid)
     continue;
  else
    throw new Exception();
} 
```

您可以直接为每个属性覆盖这些方法，也可以为整个对象覆盖 OnValidate()

        visual-c++ - 在 Cygwin shell 中调用 cl.exe（MSVC 编译器）

ID：366928

赞同：28

时间：2008-12-14T20:12:52.237

标签：visual-c++, cygwin

我大量使用 Cygwin（带有[PuTTY](http://en.wikipedia.org/wiki/PuTTY) shell）。但是，`cl.exe`在 Cygwin Bash shell 中调用（即 Visual C++ 编译器工具链）非常棘手。在 Bash shell 中运行`vcvars*.bat`显然不起作用。我尝试将 VC++ 的环境变量迁移到 Cygwin，但这并不容易。

如何在 Cygwin 的 Bash shell 中运行 VC++ 编译器？

            回答 #1

赞同：24

时间：2008-12-17T12:35:51.893

我通常通过添加来解决这个问题

```
call "%VS80COMNTOOLS%vsvars32.bat" >NUL: 
```

到 c:/cygwin/cygwin.bat。请注意，VS80COMNTOOLS 变量非常有用，因为它为您提供了一种万无一失的 (hm) 方法来定位 vsvars32.bat。

另一种方法是这样，它允许您在不同的 Studio 版本之间轻松切换：

```
function run_with_bat()
{
    batfile=$1; shift
    tmpfile="$TMP/tmp$$.bat"
    echo "@echo off" > $tmpfile
    echo "call \"%$batfile%vsvars32.bat\" >NUL:" >> $tmpfile
    echo "bash -c \"%*\"" >> $tmpfile
    cmd /c `cygpath -m "$tmpfile"` "$@"
    status=$?
    rm -f $tmpfile
    return $status
}

function run_vs9()
{
    run_with_bat VS90COMNTOOLS "$@"
}

function run_vs8()
{
    run_with_bat VS80COMNTOOLS "$@"
} 
```

您现在可以执行以下操作：

```
$ run_vs8 cl
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 14.00.50727.762 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved. 

usage: cl [ option... ] filename... [ /link linkoption... ]
$ run_vs9 cl
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.21022.08 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved.

usage: cl [ option... ] filename... [ /link linkoption... ] 
```

注意编译器版本。

            回答 #2

赞同：15

时间：2008-12-14T20:18:55.047

我了解您的问题是将 vcvars32.bat 转换为 shell 脚本。

解决该问题的一种方法是基于当一个进程启动另一个进程时继承环境变量的想法。所以你可以简单地在cmd下运行vcvars32，然后运行bash。这在我的机器上运行良好：

```
sh-3.2$ cl
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.21022.08 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved.

usage: cl [ option... ] filename... [ /link linkoption... ] 
```

或者，在cmd下调用vcvars32前后运行set，然后创建一个shell脚本来设置环境变量。

            回答 #3

赞同：12

时间：2010-07-17T16:25:58.237

根据其他答案中的建议，我对带有和不带有 MSVC 变量的 bash“设置”结果进行了比较，并提出了以下脚本来重现它们以用于安装 Microsoft Visual C++ 2010 Express。我已经对其进行了一些重构，将所有与安装相关的部分放在了顶部，因此希望这对其他人有用。

```
# These lines will be installation-dependent.
export VSINSTALLDIR='C:\Program Files\Microsoft Visual Studio 10.0\'
export WindowsSdkDir='C:\Program Files\Microsoft SDKs\Windows\v7.0A\'
export FrameworkDir='C:\WINDOWS\Microsoft.NET\Framework\'
export FrameworkVersion=v4.0.30319
export Framework35Version=v3.5

# The following should be largely installation-independent.
export VCINSTALLDIR="$VSINSTALLDIR"'VC\'
export DevEnvDir="$VSINSTALLDIR"'Common7\IDE\'

export FrameworkDIR32="$FrameworkDir"
export FrameworkVersion32="$FrameworkVersion"

export INCLUDE="${VCINSTALLDIR}INCLUDE;${WindowsSdkDir}include;"
export LIB="${VCINSTALLDIR}LIB;${WindowsSdkDir}lib;"
export LIBPATH="${FrameworkDir}${FrameworkVersion};"
export LIBPATH="${LIBPATH}${FrameworkDir}${Framework35Version};"
export LIBPATH="${LIBPATH}${VCINSTALLDIR}LIB;"

c_VSINSTALLDIR=`cygpath -ua "$VSINSTALLDIR\\\\"`
c_WindowsSdkDir=`cygpath -ua "$WindowsSdkDir\\\\"`
c_FrameworkDir=`cygpath -ua "$FrameworkDir\\\\"`

export PATH="${c_WindowsSdkDir}bin:$PATH"
export PATH="${c_WindowsSdkDir}bin/NETFX 4.0 Tools:$PATH"
export PATH="${c_VSINSTALLDIR}VC/VCPackages:$PATH"
export PATH="${c_FrameworkDir}${Framework35Version}:$PATH"
export PATH="${c_FrameworkDir}${FrameworkVersion}:$PATH"
export PATH="${c_VSINSTALLDIR}Common7/Tools:$PATH"
export PATH="${c_VSINSTALLDIR}VC/BIN:$PATH"
export PATH="${c_VSINSTALLDIR}Common7/IDE/:$PATH" 
```

            回答 #4

赞同：6

时间：2013-03-11T10:00:50.813

我实际上使用了 JesperE 答案[https://stackoverflow.com/a/374411/380247](https://stackoverflow.com/a/374411/380247)（允许您在 VS 版本之间切换），但找到了一种不创建临时 bat 文件的方法。所以结果要简单得多。

```
function run_in_vs_env
{
    eval vssetup="\$$1\\vsvars32.bat"
    cmd /Q /C call "$vssetup" "&&" "${@:2}"
}

function run_vs11
{
    run_in_vs_env VS110COMNTOOLS "$@"
}

function run_vs10
{
    run_in_vs_env VS100COMNTOOLS "$@"
} 
```

我建议将这些行添加到您的 .bash_functions 或类似的东西中，并在那里导出这些函数。这将允许您在 bash 脚本中使用函数。

```
export -f run_in_vs_env
export -f run_vs11
export -f run_vs10 
```

然后你应该能够做到：

```
run_vs11 cl 
```

            回答 #5

赞同：2

时间：2008-12-17T12:04:55.323

我已经用我的`vsvars32.bat`文件转换了我的文件`visual_studio.env`文件。当我需要使用命令行 Visual Studio 的环境时，我只是做一个这个文件的来源。

在shell环境中，我`sh`无法注册 Windows路径（`\`并`;`与`sh``cygpath -au``cygpath -aup commands``.env``cygpath -aw``cygpath -aup commands`

我的`visual_studio.env`文件如下所示：

```
VS80COMNTOOLS=$(cygpath -aw '/cygdrive/c/Programmi/Microsoft Visual Studio 8/Common7/Tools/'); export VS80COMNTOOLS
VSINSTALLDIR=$(cygpath -aw '/cygdrive/c/Programmi/Microsoft Visual Studio 8'); export VSINSTALLDIR
VCINSTALLDIR=$(cygpath -aw '/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC'); export VCINSTALLDIR
FrameworkDir=$(cygpath -aw '/cygdrive/c/WINDOWS/Microsoft.NET/Framework'); export FrameworkDir
FrameworkVersion='v2.0.50727'; export FrameworkVersion
FrameworkSDKDir=$(cygpath -aw '/cygdrive/c/Programmi/Microsoft Visual Studio 8/SDK/v2.0'); export FrameworkSDKDir

echo Setting environment for using Microsoft Visual Studio 2005 x86 tools.

DevEnvDir=$(cygpath -aw '/cygdrive/c/Programmi/Microsoft Visual Studio 8/Common7/IDE'); export DevEnvDir

PATH='/cygdrive/c/Programmi/Microsoft Visual Studio 8/Common7/IDE:/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/BIN:/cygdrive/c/Programmi/Microsoft Visual Studio 8/Common7/Tools:/cygdrive/c/Programmi/Microsoft Visual Studio 8/Common7/Tools/bin:/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/PlatformSDK/bin:/cygdrive/c/Programmi/Microsoft Visual Studio 8/SDK/v2.0/bin:/cygdrive/c/WINDOWS/Microsoft.NET/Framework/v2.0.50727:/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/VCPackages':$PATH
INCLUDE=$(cygpath -awp '/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/ATLMFC/INCLUDE:/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/INCLUDE:/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/PlatformSDK/include:/cygdrive/c/Programmi/Microsoft Visual Studio 8/SDK/v2.0/include'); export INCLUDE
LIB=$(cygpath -awp '/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/ATLMFC/LIB:/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/LIB:/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/PlatformSDK/lib:/cygdrive/c/Programmi/Microsoft Visual Studio 8/SDK/v2.0/lib'); export LIB
LIBPATH=$(cygpath -awp '/cygdrive/c/WINDOWS/Microsoft.NET/Framework/v2.0.50727:/cygdrive/c/Programmi/Microsoft Visual Studio 8/VC/ATLMFC/LIB'); export LIBPATH 
```

我希望这可以帮助你。

            回答 #6

赞同：2

时间：2008-12-14T20:44:06.497

另一种选择是打开 vcvars32.bat（或 vsvars32.bat，它在最新版本的 Visual Studio 中执行实际工作），查看它的作用，然后在适当的 shell 脚本中复制它。

它并不是特别复杂——它所做的只是设置了一堆环境变量。

            回答 #7

赞同：1

时间：2018-11-10T07:27:30.237

我发现使用它是一个更好的策略，`msbuild`同时我也可以使用`g++`我的 cygwin 环境。这是一种更加综合的方法，并且与您现有的`visual studio`开发和谐地融合在一起。使用最低级别`cl`并设置环境变量是自找麻烦和逆风。`msbuild`可以更好地为我们设置东西。此外，我可以逐步调试到具有完整`*.vcxproj`项目的 IDE。

```
ls -l ~/bin/msbuild
lrwxrwxrwx 1 johnny Domain Users 102 Sep  4 04:25 /home/johnny/bin/msbuild -> /cygdrive/c/Program Files (x86)/Microsoft Visual Studio/2017/Professional/MSBuild/15.0/Bin/MSBuild.exe 
```

然后在你的 ~/.bashrc 中，有这个功能：

```
builddebug (){
    [ $# -eq 0 ] && return 1;
    msbuild /m /p:Configuration=Debug /p:Platform=Win32 "$1"
} 
```

开发体验的感觉是[这样](https://asciinema.org/a/OHzjuG4CYdqJRpTvqvgPLJFy8)的。至少，我能够以更好的集成方式使用`g++`编译器和编译器。`Visual Studio 2017`让我们`msbuild`做它的事。不是`cl`。

            回答 #8

赞同：0

时间：2009-06-17T06:16:51.417

我无法在[Diomidis 的回复](https://stackoverflow.com/questions/366928/invoking-cl-exe-msvc-compiler-in-cygwin-shell/366934#366934)中添加评论:(，所以不得不发布一个答案。我同意他的回答，但是“打开命令提示符”，运行 Visual Studio/`vcvars32.bat`然后运行 ​​Bash 会很乏味。如果您不必为弄乱环境而烦恼，最好的选择是对其进行修改`Cygwin.bat`和修改，使其看起来像这样：

```
@echo off
D:
chdir D:\cygwin\bin
"%VS71COMNTOOLS%\vsvars32.bat" && bash --login -i 
```

将环境变量 VS71COMNTOOLS 替换为您机器上合适的内容。

无需打开命令提示符并手动运行 Bash。我非常喜欢这个解决方案:)。我无法将功劳归于这个黑客的真正作者，因为我找不到返回他文章的链接，对此感到抱歉！

            回答 #9

赞同：0

时间：2009-07-08T09:59:19.613

对我来说， .bash_profile 中的以下内容有效：

`"`cygpath -ua "$VS80COMNTOOLS/vsvars32.bat"`" > NUL`

            回答 #10

赞同：0

时间：2012-01-10T01:10:06.563

我发现在 cygwin 环境中使用 msvc 编译东西非常有用的一个实用程序是我在[Coin 3D](http://www.coin3d.org/lib/coin/)库的源存储库中找到的一个包装器，称为“wrapmsvc”，它的二进制文件可以在[这里](http://hg.sim.no/Coin-2/default/file/b461d7cac253/cfg)找到。

该程序包装 cl.exe 并将任何指定的 GCC args 转换为适当的 cl.exe arg。它还使用 cygwin API 将文件路径从 cygwin 形式 (/cygdrive/c/temp/test.c) 正确转换为它的实际文件路径 (C:\temp\test.c)。

上次找了好久才找到源，不过它叫“wrapmsvc.cpp”，所以如果你需要编译它，找那个文件。如果您碰巧编译了它，并且收到了一些关于使用 cygwin_conv_to_posix_path 或 cygwin_conv_to_win32_path 的折旧警告/错误，请进行以下更改：

换行：

```
(void)cygwin_conv_to_posix_path(s.c_str(), buf); 
```

至

```
(void)cygwin_conv_path(CCP_WIN_A_TO_POSIX, (const void *)s.c_str(), (void *)buf, (size_t)MAX_PATH); 
```

并改变：

```
(void)cygwin_conv_to_win32_path(s.c_str(), buf); 
```

至

```
(void)cygwin_conv_path(CCP_POSIX_TO_WIN_A, (const void *)s.c_str(), (void *)buf, (size_t)MAX_PATH); 
```

            回答 #11

赞同：0

时间：2019-10-23T09:18:52.170

我的 Igor 解决方案版本更简洁：

```
cl() {
  tmpfile="/tmp/tmp$$.bat"
  echo "@echo off" > $tmpfile
  echo "call \"C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat\" >NUL:" >> $tmpfile
  echo "bash -c \"cl %*\"" >> $tmpfile
  cmd /c `cygpath -m "$tmpfile"` "$@"
  status=$?
  rm -f $tmpfile
  return $status
} 
```

可惜vcvars64.bat需要反复调用。

            回答 #12

赞同：0

时间：2019-09-05T00:23:57.127

其他答案都不适合我，但这确实：

1.  运行“MS 构建命令提示符”

[![在此处输入图像描述](https://i.stack.imgur.com/1IOpk.png)](https://i.stack.imgur.com/1IOpk.png)

2.  转储环境变量：`set > c:\temp\cl.env`

3.  打开 cygwin 命令提示符并创建一个`source`脚本：

```
awk < /cygdrive/c/temp/cl.env -F= '{ if($1 !~ ")") print "export " $1 "=\x27" $2 "\x27" }' > cl.source 
```

4.  修改 cl.source 以将 TEMP 和 TMP 更改为 C:\Temp 例如`TEMP='C:\Temp'`

5.  现在，无论何时需要 cl 环境，从 cygwin 提示符运行：
    `source cl.source` 

6.  *（可选）您的.bashrc*文件中的源 cl.source 以在您登录时自动运行

        objective-c - 是否需要在 NSView 子类中重写 bind:toObject:withKeyPath:options: 来实现绑定？

ID：366938

赞同：6

时间：2008-12-14T20:21:28.070

标签：objective-c, cocoa, cocoa-bindings

我有一个 NSView 子类，它具有我想要可绑定的属性。我在子类中实现了以下内容：
我的视图.h：

```
@property (readwrite, retain) NSArray *representedObjects; 
```

我的视图.m：

```
@synthesize representedObjects;

+(void)initialize
{
    [self exposeBinding: @"representedObjects"];
}

-(void)bind:(NSString *)binding toObject:(id)observableController withKeyPath:(NSString *)keyPath options:(NSDictionary *)options
{
    if ([binding isEqualToString:@"representedObjects"]) {
        [observableController addObserver: self forKeyPath:@"arrangedObjects" options:NSKeyValueChangeNewKey context:nil];
    } else {
        [super bind: binding toObject:observableController withKeyPath:keyPath options: options];
    }
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    if ([keyPath isEqualToString:@"arrangedObjects"]) {
        [self setRepresentedObjects: [object arrangedObjects]];
    }
} 
```

然后，我在以下位置创建与 arrayController 的绑定`-[AppController awakeFromNib]`：

```
[myView bind:@"representedObjects" toObject:arrayController withKeyPath:@"arrangedObjects" options: nil]; 
```

这是实现绑定的正确方法吗？它涉及很多样板代码，这让我觉得我做错了什么。
我认为 NSObject 会自动实现我手动完成的操作，`-bind:toObject:withKeyPath:options:`但事实并非如此。如果我注释掉我`-bind:toObject:withKeyPath:options:`的 setRepresentedObjects 方法，则永远不会被调用。
附加信息：我进行了更多调查并得出结论，我的原始方法是正确的，您确实必须 override `-bind:toObject:withKeyPath:options:`。这是 Cocoa Bindings Programming Topics 中的一段话[：Bindings 是如何工作的？](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaBindings/Concepts/HowDoBindingsWork.html#//apple_ref/doc/uid/20002373)：

在其 bind:toObject:withKeyPath:options: 方法中，对象必须至少执行以下操作：

*   确定正在设置的绑定

*   使用什么键路径和什么选项记录它绑定到的对象

*   注册为绑定对象的 keypath 的观察者，以便接收更改通知

清单 2 中的代码示例显示了操纵杆的 bind:toObject:withKeyPath:options: 方法的部分实现，该方法仅处理角度绑定。

清单 2 Joystick 类的 bind:toObject:withKeyPath:options 方法的部分实现：

> ```
> static void *AngleBindingContext = (void *)@"JoystickAngle";
>  
> - (void)bind:(NSString *)binding
>  toObject:(id)observableObject
>  withKeyPath:(NSString *)keyPath
>  options:(NSDictionary *)options
> {
>  // Observe the observableObject for changes -- note, pass binding identifier
>  // as the context, so you get that back in observeValueForKeyPath:...
>  // This way you can easily determine what needs to be updated.
>  
> if ([binding isEqualToString:@"angle"])
>  {
>     [observableObject addObserver:self
>                    forKeyPath:keyPath
>                   options:0
>                   context:AngleBindingContext];
>  
>     // Register what object and what keypath are
>     // associated with this binding
>     observedObjectForAngle = [observableObject retain];
>     observedKeyPathForAngle = [keyPath copy];
>  
>     // Record the value transformer, if there is one
>     angleValueTransformer = nil;
>     NSString *vtName = [options objectForKey:@"NSValueTransformerName"];
>     if (vtName != nil)
>     {
>         angleValueTransformer = [NSValueTransformer
>             valueTransformerForName:vtName];
>     }
>  }
>  // Implementation continues... 
> ```

这清楚地表明 Joystick 类（它是一个 NSView 子类）需要覆盖`-bind:toObject:withKeyPath:options:`.
我觉得这很令人惊讶。我对这个结论持怀疑态度，因为我没有发现其他代码示例可以做到这一点。然而，正如苹果官方文档所说我应该超越`-bind:toObject:withKeyPath:options:`我的结论，这是正确的方法。
如果有人能证明我错了，我会很高兴的！

            回答 #1

赞同：1

时间：2008-12-14T21:06:26.183

不，你不应该需要那个胶水代码。

您所说的“似乎并非如此”是什么意思？如果你省略它会发生什么？

            回答 #2

赞同：1

时间：2011-09-12T21:27:30.250

不，没有必要覆盖`bind:`.

正如 Peter Hosey 在对较早答案的评论中所写，您可以调用`exposeBinding:`和实现符合 KVC 和 KVO 的访问器和设置器。

**我的视图.h：**

```
@interface MyView : NSView {
    NSArray *_representedObjects;
}

// IBOutlet is not required for bindings, but by adding it you can ALSO use
// an outlet
@property (readonly, retain) IBOutlet NSArray *representedObjects;

@end 
```

**我的视图.m：**

```
+ (void)initialize {
    [self exposeBinding:@"representedObjects"];
}

// Use a custom setter, because presumably, the view needs to re-draw
- (void)setRepresentedObjects:(NSArray *)representedObjects {
    [self willChangeValueForKey:@"representedObjects"];
    // Based on automatic garbage collection
    _representedObjects = representedObjects;
    [self didChangeValueForKey:@"representedObjects"];

    [self setNeedsDisplayInRect:[self visibleRect]];
} 
```

然后您可以以编程方式设置绑定：

```
[myView bind:@"representedObjects" toObject:arrayController withKeyPath:@"arrangedObjects" options: nil]; 
```

但是，要在 Interface Builder 中设置绑定，您必须创建一个自定义调色板。

            回答 #3

赞同：0

时间：2009-01-08T03:38:20.170

如果您想在该视图中实现绑定，您肯定需要`-bind:toObject:withKeyPath:options:`在自定义视图中实现。您在 myView.m 中的实现非常准确。

        c++ - 从 std::cout 或 std::ofstream(file) 获取 std::ostream

ID：366955

赞同：54

时间：2008-12-14T20:41:19.073

标签：c++, exception-handling, iostream

如何根据特定的程序条件将 a 绑定`std::ostream`到其中一个`std::cout`或一个对象？`std::ofstream`尽管由于许多原因这无效，但我想实现在语义上等同于以下内容的东西：

```
std::ostream out = condition ? &std::cout : std::ofstream(filename); 
```

我见过一些不是异常安全的示例，例如来自[http://www2.roguewave.com/support/docs/sourcepro/edition9/html/stdlibug/34-2.html](http://www2.roguewave.com/support/docs/sourcepro/edition9/html/stdlibug/34-2.html)的示例：

```
int main(int argc, char *argv[])
{
  std::ostream* fp;                                           //1
  if (argc > 1)
     fp = new std::ofstream(argv[1]);                         //2
  else
     fp = &std::cout                                          //3

  *fp << "Hello world!" << std::endl;                         //4
  if (fp!=&std::cout) 
     delete fp;
} 
```

有谁知道更好的，异常安全的解决方案？

            回答 #1

赞同：71

时间：2008-12-14T20:49:05.393

```
std::streambuf * buf;
std::ofstream of;

if(!condition) {
    of.open("file.txt");
    buf = of.rdbuf();
} else {
    buf = std::cout.rdbuf();
}

std::ostream out(buf); 
```

这将 cout 或输出文件流的底层 streambuf 关联到 out。之后，您可以写入“out”，它将最终到达正确的目的地。如果您只想将所有内容`std::cout`都放入一个文件中，您也可以这样做

```
std::ofstream file("file.txt");
std::streambuf * old = std::cout.rdbuf(file.rdbuf());
// do here output to std::cout
std::cout.rdbuf(old); // restore 
```

第二种方法的缺点是它不是异常安全的。您可能想编写一个使用 RAII 执行此操作的类：

```
struct opiped {
    opiped(std::streambuf * buf, std::ostream & os)
    :os(os), old_buf(os.rdbuf(buf)) { }
    ~opiped() { os.rdbuf(old_buf); }

    std::ostream& os;
    std::streambuf * old_buf;
};

int main() {
    // or: std::filebuf of; 
    //     of.open("file.txt", std::ios_base::out);
    std::ofstream of("file.txt");
    {
        // or: opiped raii(&of, std::cout);
        opiped raii(of.rdbuf(), std::cout);
        std::cout << "going into file" << std::endl;
    }
    std::cout << "going on screen" << std::endl;
} 
```

现在，无论发生什么，std::cout 都处于干净状态。

            回答 #2

赞同：26

时间：2008-12-14T20:48:12.790

这是异常安全的：

```
void process(std::ostream &os);

int main(int argc, char *argv[]) {
    std::ostream* fp = &cout;
    std::ofstream fout;
    if (argc > 1) {
        fout.open(argv[1]);
        fp = &fout;
    }
    process(*fp);
} 
```

编辑：Herb Sutter 在文章[Switching Streams (Guru of the Week)](http://www.gotw.ca/gotw/048.htm)中解决了这个问题。

            回答 #3

赞同：8

时间：2011-04-02T05:16:51.910

```
std::ofstream of;
std::ostream& out = condition ? std::cout : of.open(filename); 
```

            回答 #4

赞同：1

时间：2020-06-20T21:15:11.017

[从这篇文章](https://stackoverflow.com/questions/2159452/c-assign-cin-to-an-ifstream-variable)中引用。
您可以应用类似的方法。

```
struct noop {
    void operator()(...) const {}
}; 
```

```
std::shared_ptr<std::ostream> of;
if (condition) {
    of.reset(new std::ofstream(filename, std::ofstream::out));
} else {
    of.reset(&std::cout, noop());
} 
```

            回答 #5

赞同：-1

时间：2017-11-29T16:42:36.097

作为 C++ 的新手，我不知道这是否是异常安全的，但我通常是这样做的：

```
std::ostream& output = (condition)?*(new std::ofstream(filename)):std::cout; 
```

            回答 #6

赞同：-4

时间：2019-05-24T20:55:25.450

以下简单代码对我有用：

```
int main(int argc, char const *argv[]){   

    std::ofstream outF;
    if (argc > 1)
    {
        outF = std::ofstream(argv[1], std::ofstream::out); 
    }

    std::ostream& os = (argc > 1)? outF : std::cout;
} 
```

        ruby-on-rails - 在 Rails 中是否有用于选择时区的图形小部件？

ID：366962

赞同：2

时间：2008-12-14T20:45:43.823

标签：ruby-on-rails, timezone

我知道时区有一个下拉选择器，但我希望有一张地图，用户可以在其中单击一个区域并为其设置一个隐藏字段以显示时区。

            回答 #1

赞同：1

时间：2008-12-16T22:21:22.820

我不知道它是否已经完成，但这是一个好主意。你可以根据谷歌地图做一个 - 困难在于时区线并不都是直的，所以算法会有点棘手。

但是，通过单击谷歌地图获取 (lat,lng) 对（纬度和经度）很容易 - 所以您只需要一个将 (lat,lng) 转换为时区的函数 - 可能是这样的已经完成并且可能更容易找到。

希望这个对你有帮助。如果你这样做了，你可能会考虑将它贡献回 Rails，这将是一件很棒的事情。

编辑：

经过一番搜索，我在这里找到了一个将 lat,long 转换为时区信息的 web 服务：

[http://www.earthtools.org/webservices.htm#timezone](http://www.earthtools.org/webservices.htm#timezone)

所以，你可以建立一个谷歌地图，允许点击设置/拖动一个标记，然后使用网络服务来获取时区偏移量。不是您正在寻找的现成解决方案，但它可能是一个解决方案。

        ruby-on-rails - 有没有办法根据地理编码位置获取时区的 UTC 偏移量？

ID：366966

赞同：4

时间：2008-12-14T20:47:58.297

标签：ruby-on-rails, ruby, timezone

当我有用户的地址或邮政编码并使用它来查找他们的时区时，这将很有用，因此他们不必在单独的字段中输入它。

            回答 #1

赞同：3

时间：2008-12-15T00:33:56.920

我建议不要尝试从用户的邮政编码中推断出时区。

给用户的问题：

“您的邮政编码是多少”不太可能经常更改。

它会改变，但可能不如“你在哪个时区”这个问题那么频繁。

例如，如果用户到某个地方旅行，他们的邮政编码没有改变，但他们的时区改变了。

如果您尝试询问“您在哪个邮政编码？”，用户可能不知道，特别是如果他或她正在旅行。

相反，我会尝试直接弄清楚时区是什么。

大多数平台都会给你一种方法来做到这一点。

例如，如果您正在为 .NET 编写桌面软件，您可以通过

1.  使用 TimeZoneInfo 类获取当前时区，或
2.  以 UTC 时间从服务器发送所有时间到客户端，然后使用 DateTime.ToLocal Time 将 UTC 时间转换为本地时间。

或者，如果您正在编写 Web 软件，那么您可以使用 Java Script 从用户的 Web 浏览器获取时区并将其提交给服务器。

看看以下日期函数：

[http://www.w3schools.com/jsref/jsref_obj_date.asp](http://www.w3schools.com/jsref/jsref_obj_date.asp)

您可以使用各种日期函数推断时区。

有一种方法“getTimezoneOffset”，但它没有给出 +/-。因此，例如，对于 +1 和 -1 GMT，它将给出“1”，这可能是一个问题。

但是，您可以做的是从服务器发送一个已知日期，使用转换方法将其转换为本地时间，然后将结果发送回服务器。

当您向下发送已知日期时，您可能应该将其作为毫秒偏移量发送。这样您就可以避免任何文化问题（不同地方的日期格式不同）。

有 Win32 函数可以为您提供时区，我相信可能有 Unix、Mac 和 Java APIS 可以做同样的事情。

            回答 #2

赞同：1

时间：2008-12-14T21:17:05.337

我记得曾经有一个数据集为时区信息提供邮政编码。该数据集可能来自以下之一：USPS、人口普查或 NOAA（用于天气预报）。

抱歉，我无法提供更多信息。

            回答 #3

赞同：1

时间：2008-12-14T23:49:26.947

最近在 AD Olson 运行的时区邮件列表中讨论了这一点，他创建了时区名称和规则的 Olson 数据库。没有一个单一的、简单的来源（这并不奇怪，真的；有很多国家，还有很多不同的规则）。

我遇到并添加书签的一些信息的位置之一是[www.geonames.org](http://www.geonames.org/)。尤其是在 2008 年 9 月。您可以通过匿名 FTP 从[Elsie](ftp://elsie.nci.nih.gov/pub/tzarchive.gz)下载邮件列表存档（大约 17 MB，可以追溯到 90 年代初，如果不是更早的话）。这些电子邮件提到 ESRI 作为信息来源。

            回答 #4

赞同：0

时间：2008-12-17T00:48:02.010

是的 - 您可以使用 geonames.org 等地理编码器从邮政编码中获取纬度、经度（地理编码器还可能包含时区或为此提供单独的网络服务）。

如果您的地理编码器不这样做，那么给定纬度和经度，您可以从此网络服务获取时区：

[http://www.earthtools.org/webservices.htm#timezone](http://www.earthtools.org/webservices.htm#timezone)

            回答 #5

赞同：0

时间：2009-06-19T15:43:31.897

您可以使用 GeoIP 从他们的 IP 地址获取经纬度，从而获得他们的纬度/经度以转换为他们的时区。

[http://www.hostip.info/](http://www.hostip.info/)

您可以调用他们的网络服务，也可以自己下载数据库。

但是，有一些警告。

1.  如果用户有代理服务器，您将获得他们的代理 IP。
2.  有些 IP 不翻译

        asp-classic - ASP 换行符 - \n?

ID：366968

赞同：15

时间：2008-12-14T20:48:22.273

标签：asp-classic, vbscript, line-breaks

我一直在寻找一种在查看源代码时在代码中插入换行符的方法。我不是在寻找`<br />`

类似于 PHP 的东西`\n`

关于如何在 ASP 中执行此操作的任何想法？我将把它放在一个字符串中。

            回答 #1

赞同：26

时间：2008-12-14T20:57:42.567

没有办法在字符串中做到这一点。您必须像这样附加 vbCrLf：

```
Response.Write "hello" & vbCrLf & "world" 
```

如果你想将它包含在字符串中，你可以像这样进行替换：

```
output = "hello\nworld"
output = Replace(output, "\n", vbCrLf)
Response.Write output 
```

            回答 #2

赞同：2

时间：2008-12-14T21:42:48.420

除了**`\n`**方法之外，我还嵌入了 HTML 标签**`<BR>`**并使用了：

```
Response.Write "First Line Of Text<br>Second Line Of Text<br>Third line Of Text" 
```

            回答 #3

赞同：1

时间：2015-07-15T10:37:55.700

对我来说， using`"\n"`不起作用，导致在`\n`网页上显示为文本，而不是源代码视图中的换行符，但是 using`chr(10)`确实有效。使用`CrLf`对我来说不是一个选项，因为它会生成一个 Windows 行尾 (\r\n)，我需要 Linux 行尾，它只是换行符 (\n)。

            回答 #4

赞同：0

时间：2017-03-02T19:20:09.870

最简单的方法就是打印带有响应功能的 html 换行符

像这样：`Response.Write "<BR>"`您也可以使用此方法发送任何其他 HTML 命令，只需注意引号

            回答 #5

赞同：0

时间：2018-08-31T06:15:18.590

最好的方法是使用`<br/>`如下标签：

```
<%@ Language="VBScript" %>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title></title>

 </head>
<body>
      <%
       dim i
       for i=0 to 10
       response.write(i & "<br/>")
       next 
       %>
</body> 
```

forms - 简单的 ASP 表单验证 - 交换？

ID：366972

赞同：1

时间：2008-12-14T20:52:26.853

标签：forms, validation, asp-classic, ado

我正在尝试使用条件对 null 或“”（空）进行一些非常简单的表单验证检查，但是当我提交带有 ALL BLANK FIELDS 的表单时，它会执行我的代码的后一部分。

当我填写所有字段时，它会完成另一部分。因此，当它们为空时，告诉用户，这是条件的第一部分，我在下面粘贴了我的代码。关于我能做什么的任何建议？是我的“OR”还是“AND”

```
if(((f_name <> null) or (f_name <> "")) or ((l_name <> null) or (l_name <> "")) or ((username <> null) or (username <> "")) or ((password <> null) or (password <> ""))) then
    'response.redirect("account_created.asp")
    response.write("You have not filled in all fields.")
else
    Set objConn = ConnectDB()
    query       = "INSERT INTO [user] (username,[password],f_name,l_name) VALUES ('"& username &"','"& password &"','"& f_name &"','"& l_name &"')"
    Set objs    = objConn.Execute(query)
    response.write(query)
    'Response.Redirect ("thankyou.asp")

end if 
```

            回答 #1

赞同：0

时间：2008-12-14T21:54:20.597

一般来说，检查空字符串（例如 f_name <> ""）就足够了。然而，我通常用修剪和镜头来做到这一点。len(trim(f_name)) > 0。它处理所有空格。你应该重新考虑你的括号，因为它们不是必需的。如果 len(trim(f_name)) > 0 或 ... 那么

            回答 #2

赞同：-1

时间：2008-12-14T20:57:21.820

1.  你不需要所有的括号
2.  如果 fname 等是文本框，则需要 fname.Text

        python - Perl、Python、AWK 和 sed 有什么区别？

ID：366980

赞同：272

时间：2008-12-14T21:00:04.543

标签：python, perl, sed, awk, language-comparisons

它们之间的主要区别是什么？在哪些典型场景中使用每种语言更好？

            回答 #1

赞同：586

时间：2008-12-14T21:33:29.233

按出现顺序，语言是`sed`, `awk`, `perl`, `python`.

该`sed`程序是一个流编辑器，旨在将脚本中的操作应用于输入文件的每一行（或更一般地，应用于指定的行范围）。它的语言基于`ed`Unix 编辑器，虽然它有条件等，但很难用于复杂的任务。你可以用它创造小奇迹——但要付出你头上的头发的代价。但是，在尝试其职权范围内的任务时，它可能是最快的程序。（它具有讨论的程序中最不强大的正则表达式 - 足以满足许多目的，但肯定不是 PCRE - Perl-Compatible Regular Expressions）

该`awk`程序（名称来自其作者的首字母 - Aho、Weinberger 和 Kernighan）最初是用于格式化报告的工具。它可以用作增强剂`sed`；在其最新版本中，它在计算上是完整的。它使用了一个有趣的想法——该程序基于“模式匹配”和“模式匹配时采取的操作”。这些模式相当强大（扩展正则表达式）。动作的语言与 C 类似。其主要特点之一`awk`是它自动将输入拆分为记录，并将每条记录拆分为字段。

Perl 部分是作为 awk-killer 和 sed-killer 编写的。它提供的两个程序是`a2p`和`s2p`用于将`awk`脚本和`sed`脚本转换为 Perl。Perl 是最早的下一代脚本语言之一（Tcl/Tk 可能占据主导地位）。它具有强大的集成正则表达式处理和更强大的语言。它提供对几乎所有系统调用的访问，并具有 CPAN 模块的可扩展性。（两者都`awk`不可`sed`扩展。）Perl 的座右铭之一是“TMTOWTDI - 有不止一种方法可以做到”（发音为“tim-toady”）。Perl 有“对象”，但它更像是一个附加组件，而不是语言的基本部分。

Python 是最后编写的，可能部分是对 Perl 的反应。它有一些有趣的句法思想（缩进表示级别 - 没有大括号或等价物）。它比 Perl 更基本面向对象；它和 Perl 一样可扩展。

好的 - 什么时候使用每个？

*   Sed - 当您需要对文件进行简单的文本转换时。
*   awk - 当您只需要简单的格式化和汇总或数据转换时。
*   Perl - 几乎适用于任何任务，尤其是当任务需要复杂的正则表达式时。
*   Python - 用于您可以使用 Perl 的相同任务。

我不知道 Perl 可以做 Python 做不到的任何事情，反之亦然。两者之间的选择将取决于其他因素。我在 Python 出现之前就学习了 Perl，所以我倾向于使用它。Python 具有较少的附加语法，并且通常更易于学习。Perl 6，当它可用时，将是一个引人入胜的发展。

（请注意，Perl 和 Python 的“概述”尤其是非常不完整；整本书都可以写在这个主题上。）

            回答 #2

赞同：99

时间：2010-05-25T14:51:59.757

在掌握了几十种语言之后，你会厌倦像 S. Lott 这样的人（参见他对这个问题的有争议的回答，在回答六年后，反对票的数量几乎是赞成票（+45/-22）的一半）。

Sed 是极其简单的命令行管道的最佳工具。在 sed 大师手中，它适用于任意复杂的一次性，但它不应该用于生产代码，除非在非常简单的替换管道中。像's/this/that/.'这样的东西

当只有一个输入源和一个输出（或多个输出顺序写入）时，Gawk（GNU awk）是迄今为止复杂数据重新格式化的最佳选择。由于现实世界的大量工作都符合这个描述，而且一个好的程序员可以在两个小时内学会 gawk，它是最好的选择。在这个星球上，越简单越快越好！

当您有非常复杂的输入/输出场景时，Perl 或 Python 比任何版本的 awk 或 sed 都要好得多。从维护和可读性的角度来看，问题越复杂，使用 python 的效果就越好。但是请注意，优秀的程序员可以用任何语言编写可读的代码，而糟糕的程序员可以用任何有用的语言编写无法维护的废话，因此如果该程序员是熟练和聪明。

            回答 #3

赞同：22

时间：2008-12-14T21:18:47.097

我不会将 sed 称为成熟的编程语言，它是一种流编辑器，具有旨在以编程方式编辑文本文件的语言结构。

awk 更像是一种通用语言，但它仍然最适合文本处理。

Perl 和 Python 是成熟的通用编程语言。Perl 起源于文本处理，并且有许多类似 awk 的结构（甚至网上流传着一个 awk-to-perl 脚本）。Perl 和 Python 之间有很多不同之处，最好的办法可能是在 Wikipedia 之类的网站上阅读这两种语言的摘要，以便更好地了解它们是什么。

            回答 #4

赞同：18

时间：2008-12-14T22:30:51.960

首先，列表“Perl、Python awk 和 sed”中有两个不相关的东西。

事物 1 - 简单的文本操作工具。

*   赛德。它有一个固定的、相对简单的工作范围，由读取和检查文件的每一行的想法定义。sed 的设计并不是特别可读。它被设计为在非常小的 unix 服务器上非常小且非常高效。

*   哦。它的工作范围稍微不那么固定，也不那么简单。但是，awk 程序的主循环是通过隐式读取源文件的行来定义的。

这些不是“完整”的编程语言。虽然您可以通过一些工作在 awk 中编写相当复杂的程序，但它很快就会变得复杂且难以阅读。

事物 2 - 通用编程语言。它们具有丰富多样的语句类型、大量内置数据结构，并且没有内置的假设或捷径可言。

*   珀尔。

*   Python。

何时使用它们。

*   赛德。绝不。在内存超过 32K 的现代计算机时代，它确实没有任何价值。Perl 或 Python 更清楚地执行相同的操作。

*   哦。绝不。与 sed 一样，它反映了更早的计算时代。与其保持这种语言（除了成功系统所需的所有其他语言），不如用一种愉快的语言简单地做所有事情更愉快。

*   珀尔。任何类型的任何编程问题。如果你喜欢自由思考的语法，有很多很多方法可以做同样的事情，perl 很有趣。

*   Python。任何类型的任何编程问题。如果您喜欢相当有限的语法，选择更少，微妙之处更少，并且（也许）更清晰。Python 的面向对象特性使其更适合处理大型、复杂的问题。

背景——我并不是因为无知而抨击 sed 和 awk。我在 20 多年前学习了 awk。用它做了很多事情；曾经把它作为一项核心的unix技能来教授。大约 15 年前我学习了 Perl。用它做了很多复杂的事情。我把两者都抛在了后面，因为我可以在 Python 中做同样的事情——而且它更简单、更清晰。

sed 和 awk 有两个严重的问题，这两个问题都不是他们的年龄。

1.  他们实施的不完整性。sed 和 awk 所做的一切都可以在 Python 或 Perl 中完成，通常更简单，有时也更快。由于它的多处理，shell 管道具有一些性能优势。Python 提供了一个`subprocess`模块来让我恢复这些优势。

2.  需要学习另一种语言。通过在 Python（或 Perl）中做事，您的实现依赖于更少的语言，从而提高了清晰度。

            回答 #5

赞同：16

时间：2010-04-13T13:27:33.623

何时使用它们：awk - 从不 - S. Lott。

我认为 S. Lott 的这条建议略微偏离了目标。事实上，在 Linux 和其他 UNIX 环境中，awk 是与 bash、sh 和 ksh 一起用于快速文本处理的有用工具。脚本本身的想法是通过将这个工具、那个工具粘合在一起来解决你的问题。因此，在管理脚本中，有 ls、grep、|、awk、time、ps 等是很常见的。每个都是脚本编写者像砖块一样组合起来完成构建的工具（以解决手头的问题） .

[例如，我是管理彩弹装备用品](http://www.paintball-gear-supplies.com/)的团队的成员互联网。该电子商务网站基于 LAMP 堆栈。为了自动处理来自不同供应商的数据馈送并将其规范化到后端数据库中，我们使用并维护多种脚本组合，包括 bash、perl、php 甚至期望。每个都有基于可用模块和 API 的优势。在 bash 脚本中，我们使用 awk 进行快速模式匹配并根据需要对模式执行适当的操作，而无需切换到 PERL。我还想指出的一件事是线程中没有强调的，这些脚本中有相当一部分是购买的，或者是从开源获得的。如果脚本以 Perl 的形式出现，我们将其维护为 Perl；如果脚本以 Php 的形式出现，我们将其维护为 Php；如果它以 bash 的形式出现，我们将其维护为 bash；

        asp.net - ASP.net 和 SQL Server 2005：ASPNET 帐户设置

ID：366995

赞同：0

时间：2008-12-14T21:13:53.313

标签：asp.net

我对 SQL Server 2005 中的 ASP.NET 帐户有点困惑。在我的网站连接字符串中，我使用`sa`帐户连接到 SQL Server 数据库。当我使用 Firefox 登录我的网站时，出现错误

用户登录失败：'AccountName'

我在 ms 支持网站上找到了答案。它提到了 3 种纠正此方法的方法，其中之一是在 SQL Server for ASPNET 中授予正确的权限。

我为服务器角色选择了公共，授予连接数据库的权限并启用登录，我还在用户映射中选择了数据库。我的数据库存储过程仍然出现权限错误。

我错过了什么？

编辑：我`ASPNET`在我的数据库中设置为数据库所有者，一切正常。如果我只是设置读写，它不起作用。将帐户设置`ASPNET`为数据库所有者不是安全风险吗？

            回答 #1

赞同：2

时间：2008-12-14T21:21:50.117

**首先，永远**不要以 SA 身份从 Web 应用程序连接，这是一个巨大的安全风险。

听起来您的连接字符串搞砸了，它使用的是 NT 身份验证，而不是指定的用户/密码组合。

除非您直接访问表，否则您不需要将应用程序池帐户设置为 dbo；而是将其添加到该数据库的公共组中；这样你就可以适当地限制它。

        language-agnostic - 关于编程语言设计的好资源？

ID：366998

赞同：9

时间：2008-12-14T21:16:01.593

标签：language-agnostic

*Javascript: The Good Parts*是一本很棒的书。我经常发现自己从语言设计者的角度阅读以下段落：

`undefined`并且`NaN`不是常数。它们是全局变量，您可以更改它们的值。这应该是不可能的，但它确实是。不要这样做。

要点：

1.  不要更改`undefined`我的 Javascript 代码中的值。
2.  在设计语言时，使其等同于`undefined`不可变。

另一个更微妙的例子是“`for in`不应该枚举原型属性”。

我想要一本书，在特定语言的上下文之外讨论语言设计的这些问题。

**如果您尝试设计“完美”的 OO 语言，您会阅读哪些书籍作为指导？**

            回答 #1

赞同：8

时间：2008-12-14T21:43:03.553

网站 'lambda the Ultimate' 非常关注编程语言，他们偶尔也会有一些很好的资源，尽管他们往往对学术类的东西更感兴趣。例如，函数式编程在那里很重要。

[http://lambda-the-ultimate.org/node/3](http://lambda-the-ultimate.org/node/3)

[http://lambda-the-ultimate.org/papers](http://lambda-the-ultimate.org/papers)

[http://lambda-the-ultimate.org/node/492](http://lambda-the-ultimate.org/node/492)

            回答 #2

赞同：6

时间：2008-12-14T21:23:11.703

您可以从与 Java、Ruby、Objective C 等相同的地方获取一个页面，并查看[Smalltalk 背后的设计原则](http://users.ipa.net/~dwighth/smalltalk/byte_aug81/design_principles_behind_smalltalk.html)。其中大部分是关于对象之间通信的基础材料，而不是专门关于 Smalltalk 的任何内容。

就语言设计方面的真正深思熟虑的书籍而言，我认为[C++ 的设计和演变](http://www.research.att.com/~bs/dne.html)绝对值得一提。我犹豫了，因为您说您想要“完美”的 OO 语言，而 C++ 远非完美。不过，您可能仍然可以从中学到很多东西。

但是，您提出的观点似乎更多地与[最小惊讶原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)或最小惊讶[规则有关，而](http://www.faqs.org/docs/artu/ch11s01.html)不是与语言内部结构的设计有关。

            回答 #3

赞同：4

时间：2008-12-14T21:33:37.253

[C++ 的设计和演变](http://www.research.att.com/~bs/dne.html)是好的。

[面向对象的软件构建](http://archive.eiffel.com/doc/oosc/)也是如此。

它们是特定于语言的（C++、Eiffel），但有很多与语言无关的课程。

            回答 #4

赞同：1

时间：2008-12-15T04:26:36.920

你可以查看设计文件  `Perl6`

[`Perl6`概要](http://dev.perl.org/perl6/doc/synopsis.html)

如果你阅读[概要 6](http://dev.perl.org/perl6/doc/design/syn/S06.html)，你会发现加法运算符被命名为：

*   `infix:<+>`
*   `infix:«+»`
*   `infix:<<+>>`
*   `infix:{'+'}`
*   `infix:{"+"}`

这意味着您可以创建自己的运算符：

```
sub postfix:<!> ($n) { [*] 1..$n } 
```

            回答 #5

赞同：0

时间：2017-06-25T06:25:54.853

有很多很好的书籍解释了广泛使用的语言中应用的设计原则，但如果你真的想“理解”这些设计原则，你应该深入挖掘。我肯定会推荐franklyn turbak[的“编程语言中的设计概念” 。](https://mitpress.mit.edu/books/design-concepts-programming-languages)本书试图基于它的数学基础系统地探索编程语言的概念。   

`````