# StackOverflow 问答 000872000-000872999

# iphone - iPhone - AVAudioPlayer、kAudioSessionCategory_AmbientSound 和 iPod 音乐

> ID：872001
> 
> 赞同：1
> 
> 时间：2009-05-16T08:47:15.027
> 
> 标签：iphone, audio, ipod

我在我的应用程序委托中使用以下音频会话：

```
  AudioSessionInitialize(NULL, NULL, NULL, self);
  UInt32 sessionCategory = kAudioSessionCategory_AmbientSound;
  AudioSessionSetProperty(kAudioSessionProperty_AudioCategory, sizeof(sessionCategory), &sessionCategory);

  AudioSessionSetActive(true);

```

我希望用户能够在播放 iPod 音乐的同时使用我的应用程序，这很棒而且工作正常……我的应用程序退出并允许播放 iPod 音乐。

我遇到的问题是......在用户退出我的应用程序，进入 iPod 应用程序并暂停后，当他们回到我的应用程序时，我的声音都不起作用。就好像它仍然认为 iPod 会话处于活动状态，即使它没有播放任何音乐！

我基本上只想在 iPod 音乐暂停后重新激活我的音频会话。就目前而言，在我通过 iPod 应用程序播放音乐之后，除非我重新编译，否则我完全无法恢复我的应用程序的声音*。*：（ 有人有想法么？

编辑：我忘了提到我正在使用 AVAudioPlayer 类的基本实现来播放我的应用程序的音频。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-04T05:03:10.213

好吧，只是想我会让每个人都张贴，以防它帮助别人......我所做的可能有点骇人听闻，但似乎可以解决问题！

```
    UInt32 正在播放；
    UInt32 propertySize = sizeof(isPlaying);
    OSStatus 状态；

    // 检查他们的 iPod 音乐是否正在播放
    状态 = AudioSessionGetProperty(kAudioSessionProperty_OtherAudioIsPlaying, &propertySize, &isPlaying);

    // 相应地设置会话类别
    如果（！正在播放）{
      NSLog(@"...SoloAmbientSound");
      UInt32 sessionCategory = kAudioSessionCategory_SoloAmbientSound;
      AudioSessionSetProperty(kAudioSessionProperty_AudioCategory, sizeof(sessionCategory), &sessionCategory);
    }别的{
      NSLog(@"...AmbientSound");
      UInt32 sessionCategory = kAudioSessionCategory_AmbientSound;
      AudioSessionSetProperty(kAudioSessionProperty_AudioCategory, sizeof(sessionCategory), &sessionCategory);
    }

```

# c# - 读取没有标准 .dbf 扩展名的 dbase 文件

> ID：872002
> 
> 赞同：1
> 
> 时间：2009-05-16T08:47:18.710
> 
> 标签：c#, oledb, dbase

我正在尝试读取一个只是 dbase 文件但没有标准扩展名的文件，该文件类似于：

测试数据

我正在使用这段代码来尝试读取文件：

```
string ConnectionString = @"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=C:\Temp;Extended Properties=dBase III";
            OleDbConnection dBaseConnection = new OleDbConnection(ConnectionString);
            dBaseConnection.Open();

            OleDbDataAdapter oDataAdapter = new OleDbDataAdapter("SELECT * FROM Test", ConnectionString);
            DataSet oDataSet = new DataSet();
            oDataAdapter.Fill(oDataSet);//I get the error right here...
            DataTable oDataTable = oDataSet.Tables[0];
            foreach (DataRow dr in oDataTable.Rows)
            {
                Console.WriteLine(dr["Name"]);
            } 
```

当然，这会崩溃，因为它找不到名为 test 的 dbase 文件，但如果我将文件重命名为 Test.dbf，它就可以正常工作。我不能一直重命名文件，因为第三方应用程序使用它作为文件格式。

有谁知道在 C# 中没有标准扩展名的情况下读取 dbase 文件的方法。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T10:03:42.520

让我对您的代码感到困惑的是您创建 ConnectionString 的方式。我会这样做：

```
string databaseFile = "test.dat";
string ConnectionString = @"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=C:\Temp\" + databaseFile +";Extended Properties=dBase III"; 
```

在路径的数据源部分设置文件名时，无论文件类型/扩展名是什么，我都没有遇到过问题。

至于您的 SELECT 语句，“SELECT * FROM Test”是从数据库中名为“Test”的表中选择所有数据，而不是从名为“Test”的文件中选择所有数据。

我没有使用过 dBase 文件，但我的猜测是你的数据源足以让 C# 使用默认的 dBase 扩展来确定你想要什么文件，并且当你填充数据适配器时它会崩溃' t 使用默认扩展名。尝试添加特定的文件名，看看它是否有效。

# mobile - 中国移动软件开发？

> ID：872003
> 
> 赞同：2
> 
> 时间：2009-05-16T08:47:37.930
> 
> 标签：mobile, localization, firmware, cjk

根据我的假设（），那里有数亿部中国手机（或品牌手机的克隆）。这些手机的固件和操作系统似乎是相同的。这些电话仅在设计上有所不同，并且可能是硬件。

我想知道这些手机是否有任何开发工具包或软件开发支持。这些手机中的操作系统和/或固件是什么？这些是开源的还是在线可用的？这些手机支持java吗？从哪里可以在线获取有关这些手机及其软件的更多信息？

提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T08:57:34.207

我看到很多使用Win Mobile OS的中国手机

# c# - Uninstall_Init / Uninstall_Exit 如何在 C# 中访问它们

> ID：872004
> 
> 赞同：3
> 
> 时间：2009-05-16T08:50:45.253
> 
> 标签：c#, .net, windows-mobile, compact-framework

要让您的 Windows Mobile 获得认证，其中一项要求是您实现这些功能以获得认证。我个人很想使用这些功能来清理应用程序数据文件夹。

我一直在互联网上搜索，我只能找到一个基于 c++/vb( [link](http://www.codeproject.com/KB/mobile/setupdll.aspx?fid=76996&df=90&mpp=25&noise=3&sort=Position&view=Quick) ) 的示例，并且是从 2004 年开始的。在纯托管代码中是否有任何解决方案可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T13:58:20.957

在纯托管代码中没有办法做到这一点。CAB 安装程序应用程序 (wceload.exe) 调用 DLL 中的入口点，并且由于 CF 中没有 CLR 托管，因此托管 DLL 不可能发生这种情况。

# apache-flex - flex 或 amfphp 中的 VO 是什么？

> ID：872005
> 
> 赞同：1
> 
> 时间：2009-05-16T08:51:27.763
> 
> 标签：apache-flex, amfphp

就是这样。我正在获取 XML 数据，我需要等到它被解析，然后在从我的库中完成解析后调度事件。

首先，在这种情况下，有什么办法可以避免图书馆发生事件？

我看到的另一种选择是使用 VO。那么这是什么以及如何使它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T17:12:43.210

如果您可以使用 AMFPHP，我强烈推荐它。您可以在服务器和 actionscript 中定义值对象 (VO)。这将允许您从客户端到服务器来回传递强类型对象。根本不需要解析、使用 e4x 或以那种方式受苦。

VO 也称为 DTO（数据传输对象），其展位是面向对象的设计模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T17:04:37.863

如果您从 flex 获取作为 XML 数据的结果，我猜您正在使用获取 xml 的 HTTPService，因此您可以访问 ResultEvent 的结果属性中的数据。

例如

```
private function resultHandler(e:ResultEvent):void{} 
```

你会得到你的数据：

```
private function resultHandler(e:ResultEvent):void{
   var tempCollection:ArrayCollection = new ArrayCollection();
   tempCollection = e.result.someDataObject as ArrayCollection;
} 
```

这就是您将从 xml 获得的数据设置为 VO 的地方

```
private function resultHandler(e:ResultEvent):void{
  var tempCollection:ArrayCollection = new ArrayCollection();
  tempCollection = e.result.someDataNode as ArrayCollection;
for each(var item:Object in tempCollection){
  var myVO:VO = new Image();
  myVO.firstProperty = item.firstProperty;
  myVO.secondProperty = item.secondProperty;
  myVOCollection.addItem(myVO);
 }
} 
```

这个想法很简单...... VO 只是一个自定义对象：您创建的一个类扩展了 Object 并用于存储来自外部数据源的值（例如您的 xml 结果）。由于您使用的是比使用动态类更快的自定义类，并且在阅读代码和调试时有很大帮助（您可以进行数据类型检查等等）。

它们可以是任何东西：商店中的产品、画廊中的照片等。

在示例中，我假设 someDataNode 是您 xml 中的一个节点，myVOCollection 是您的数据的 ArrayCollection 等等。

因此，在这种情况下，您的 VO 类似于：

```
package{
class VO{

private var _firstProperty:String;
private var _secondProperty:String;

public function VO(firstProp:String=null,secondProp:String=null){
_firstProperty = firstProp;
_secondProperty = secondProperty;
}

public function get firstProperty():String{
return _firstProperty;
}

public function set firstProperty(value:String):void{
_firstProperty = value;
}

public function get secondProperty():String{
return _secondProperty;
}

public function set secondProperty(value:String):void{
_secondProperty = value;
}

}
} 
```

您的 Model 类可能会管理数据的加载和解析，一旦完成，它将分派一个事件，让应用程序知道所请求的数据可用。

简而言之，flex 中的 valueobject 将是一个代表数据项的 actionscipt 类。使用一个意味着将一个通用对象（来自外部源）映射到它的动作脚本表示。

没有什么花哨。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T04:57:08.857

当与外部对象结合使用时，VO 将允许数据从一个对象（以一种语言）传输到等效对象（以另一种语言）。

因此，您不必解析 XML、e4x 等，而是让您的 flex 通过网关（即 ZendAMF、amfPHP、sabreAMF 等）直接与您的 PHP 对话。

此站点上有更多信息解释了如何执行此操作（设置 RemoteObject）。当然乔治上面说的很好，如果你打算做远程对象，你需要注册课程。

[http://www.brentknigge.com/?q=node/496](http://www.brentknigge.com/?q=node/496)

干杯

# mysql - 用于备份和恢复 MySQL 数据库的 SQL 命令

> ID：872009
> 
> 赞同：1
> 
> 时间：2009-05-16T08:56:35.880
> 
> 标签：mysql, backup

需要在我的 Web 应用程序中单击按钮来提供此功能。可以使用 mysqldump 来完成，但为此我必须启动一个外部进程？（命令提示符）

是否有一个简单的 SQL 查询可以让我们备份和恢复数据库？（特别是对于 MySQL）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T09:08:55.770

如果您使用 MySQL 6，那很好——请参阅[http://dev.mysql.com/doc/refman/6.0/en/backup-database-restore.html](http://dev.mysql.com/doc/refman/6.0/en/backup-database-restore.html)。如果您使用的是 MySQL 5，事情就不那么乐观了——使用 mysqldump / 外部进程方法可能会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T09:10:54.270

mysqldump 可能是你最好的选择。[您可以使用SELECT ... INTO OUTFILE](http://dev.mysql.com/doc/refman/5.1/en/select.html#id3854478)保存表行并使用[LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)重新加载它，但您必须逐表执行此操作，并将表模式写入另一个文件以进行完整备份。

生成一个运行 mysqldump 的进程有什么不好？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T09:10:29.497

您可以调用外部命令行可执行文件[，这](http://www.webcheatsheet.com/SQL/mysql_backup_restore.php)是一个很好的介绍。

或者您运行几个查询（如 PHPMyAdmin 所做的）并将结果存储在您自己的某个地方。

但是没有简单的“一个命令”查询。

# jquery - 锚链接单击事件未触发 JQuery .load 事件

> ID：872021
> 
> 赞同：0
> 
> 时间：2009-05-16T09:08:03.387
> 
> 标签：jquery

我有一个带有搜索表单字段的网页，单击提交按钮后，我进行了 Ajax 调用并使用 Ajax.BeginForm 用结果填充 div

结果有分页链接来处理分页。

问题是在 Ajax 调用之后，我有这个 Jquery 代码，当单击其中一个分页链接时应该触发。但他们不开火。

这是因为 div 是使用 Ajax 调用填充的吗？

我使用单击提交按钮测试了该代码，并且可以正常触发。只是分页链接不会触发。

```
$('.pagerlinks a').click(function () {
    $('#resultsdiv').load('Search/Advanced', { Keywords=keywords, etc });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T09:22:14.820

我会在 jquery 中使用实时绑定功能，以便能够在创建的任何时候绑定到所有指定的元素：

[http://docs.jquery.com/Events/live](http://docs.jquery.com/Events/live)

您的代码还会在 DOM 就绪事件上触发吗？如：

```
$(function () {
 $('.pagerlinks a').click(function() {
       $('#resultsdiv').load('Search/Advanced', {Keywords=keywords, etc }); 
});

}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T09:33:38.427

另一种方法是在回调函数中重新绑定，称为`$.load`的第二个参数：

```
function initPagerlinks()
{
     $('.pagerlinks a').click(function() {
           $('#resultsdiv').load('Search/Advanced', {Keywords=keywords, etc }, initPagerlinks); 
     });
}

$(document).ready(function() {
    initPagerlinks();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T10:07:29.157

有两种解决方案： 1\. 添加加载函数回调，在加载的内容上设置事件。2\. 使用现场活动：

`$("p").live("click", function(){ $(this).after("Another paragraph!"); });` [http://docs.jquery.com/Events/live](http://docs.jquery.com/Events/live)

# c# - 如何将（大）XML 写入 C# 中的文件？

> ID：872023
> 
> 赞同：13
> 
> 时间：2009-05-16T09:08:46.817
> 
> 标签：c#, xml

伙计们，

请问，在 C# .NET 3.5 中编写非常大的 XML 文档（最多 500 MB）的好方法是什么？我进行了一些搜索，似乎找不到任何可以解决这个特定问题的东西。

我以前的线程（[在 C# 代码中解析（大）XML 的最佳方法是什么？](https://stackoverflow.com/questions/676274/what-is-the-best-way-to-parse-big-xml-in-c-code)）涵盖了阅读类似大小的 Xml 文档......解决了这个问题后，我需要考虑如何编写更新的功能（[http://www. opengeospatial.org/standards/sfa](http://www.opengeospatial.org/standards/sfa)）到“update.xml”文档。

**我的想法：**考虑到要生成的文档的最大大小，显然一个大的 DOM 已经出来了。我正在使用 XSD.EXE 从架构中生成绑定类......它与 XmlSerializer 类很好地配合使用，但我认为它在“幕后”构建了一个 DOM。它是否正确？。我无法一次将所有功能（最多 50,000 个）保存在内存中。我需要从数据库中读取一个特征，对其进行序列化，然后将其写入文件。所以我想我应该使用 XmlSerializer 为文件的每个单独功能编写一个“doclet”。我不知道（还）这是否可能/可行。

**你怎么看？**

**背景：**我正在将旧的 VB6 MapInfo“客户端插件”移植到 C#。有一个现有的 J2EE “更新服务”（实际上只是一个 web 应用程序），这个程序（以及其他）必须使用它。我无法更改服务器；除非绝对必要；特别是其中涉及更改其他客户。服务器接受一个 XML 文档，其架构不指定任何命名空间......即：只有默认命名空间，一切都在其中。

**我的经验：**我几乎是 C# 和 .NET 新手。我已经用各种语言编程了大约 10 年，包括 Java、VB、C 和一些 C++。

祝大家欢呼。基思。

PS：现在是晚餐时间，所以我要离开大约半小时。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-16T09:13:38.490

对于编写大型 xml，`XmlWriter`（直接）是您的朋友 - 但它更难使用。另一种选择是使用 DOM/object-model 方法并将它们组合起来，*如果*您控制`XmlWriterSettings`并禁用 xml 标记并摆脱命名空间声明，这可能是可行的......

```
using System;
using System.Collections.Generic;
using System.Xml;
using System.Xml.Serialization;    
public class Foo {
    [XmlAttribute]
    public int Id { get; set; }
    public string Bar { get; set; }
}
static class Program {
    [STAThread]
    static void Main() {
        using (XmlWriter xw = XmlWriter.Create("out.xml")) {
            xw.WriteStartElement("xml");
            XmlSerializer ser = new XmlSerializer(typeof(Foo));
            XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
            ns.Add("","");
            foreach (Foo foo in FooGenerator()) {
                ser.Serialize(xw, foo, ns);
            }
            xw.WriteEndElement();
        }
    }    
    // streaming approach; only have the smallest amount of program
    // data in memory at once - in this case, only a single `Foo` is
    // ever in use at a time
    static IEnumerable<Foo> FooGenerator() {
        for (int i = 0; i < 40; i++) {
            yield return new Foo { Id = i, Bar = "Foo " + i };
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-16T09:12:06.403

使用[XmlWriter](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)：

> [...] 一种编写器，它提供了一种快速、非缓存、只进的方式来生成包含 XML 数据的流或文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T09:24:17.717

您是否考虑过在将其写入磁盘之前对其进行压缩？使用 XML，您可以达到 10 倍以上的压缩率，甚至更多。与读取整个 500Mb 版本相比，压缩文件和编写压缩版本可能需要更少的时间。

# javascript - 我看不懂这个简单的 JS 代码

> ID：872031
> 
> 赞同：0
> 
> 时间：2009-05-16T09:12:21.160
> 
> 标签：javascript

我无法理解这段代码。如果这是一个正则表达式，它可以以更简单的方式完成吗？还是这已经广泛兼容？（使用 IE6 和更新的浏览器）

```
var u = navigator.userAgent;

// Webkit - Safari
   if(/webkit/i.test(u)){
// Gecko - Firefox, Opera
   }else if((/mozilla/i.test(u)&&!/(compati)/.test(u)) || (/opera/i.test(u))){
   } 
```

这只是：

```
String.indexOf("webkit") 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T09:28:13.370

首先，它在字符串中查找“webkit”（忽略大小写），`u`试图确定浏览器是 Safari。

如果没有找到，它会查找“mozilla”（没有“compati”）或“opera”，以尝试确定浏览器是 Firefox 还是 Opera。同样，搜索忽略大小写 ( `/i`)。

**编辑**

代码是一个正则表达式，这些`/.../i.test()`是内置在 JavaScript 中的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T09:17:43.550

javascript中的test()是一个正则表达式测试函数。你可以在这里阅读更多关于它[的信息。](http://www.devguru.com/Technologies/Ecmascript/Quickref/regexp_test.html)

> 此方法测试字符串中的正则表达式是否匹配，如果成功则返回 true，否则返回 false。测试方法可以与字符串文字或字符串变量一起使用。

代码：

```
rexp = /er/
if(rexp.test("the fisherman"))
   document.write("It's true, I tell you.") 
```

输出：

```
It's true, I tell you. 
```

此外[，这里](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Objects/RegExp/Test)还有另一个很棒的页面，其中详细介绍了此功能。

> 执行正则表达式和指定字符串之间的匹配搜索。返回真或假。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T14:04:35.607

这很相似，但会返回任何浏览器的客户端名称和版本。

```
window.navigator.sayswho= (function(){
    var N= navigator.appName, ua= navigator.userAgent, tem;
    var M= ua.match(/(opera|chrome|safari|firefox|msie)\/? *(\.?\d+(\.\d+)*)/i);
    if(M && (tem= ua.match(/version\/([\.\d]+)/i))!= null) M[2]= tem[1];
    M= M? [M[1], M[2]]: [N, navigator.appVersion, '-?'];
    return M;
})(); 
```

警报（navigator.sayswho）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T09:24:26.280

您的代码似乎是某种浏览器嗅探。的值`u`很可能是[用户代理标识符](https://developer.mozilla.org/En/DOM/Window.navigator.userAgent)。它使用正则表达式进行测试（使用[RegExp 文字语法`/`*`expr`*`/`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp#Syntax)构建）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T09:21:09.860

正则表达式的方法测试测试字符串中正则表达式的匹配，如果成功则返回true，否则返回false。

此代码测试 u 变量中的字符串中的正则表达式“webkit”、“mozilla”等是否匹配。

# visual-studio - 应用程序运行时图像未在 Silverlight 中显示

> ID：872048
> 
> 赞同：6
> 
> 时间：2009-05-16T09:24:47.513
> 
> 标签：visual-studio, silverlight, image

我正在尝试在 Silverlight 应用程序中显示图像，但在应用程序运行时图像不显示。在 Visual Studio 中创建项目时，我选择了“在构建时自动生成测试页面以托管 Silverlight”选项。

完整代码为例：

```
<UserControl x:Class="SilverlightApplication3.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">
    <StackPanel>        
        <Image Source="http://www.beachtownpress.com/db5/00415/beachtownpress.com/_uimages/beach7.jpg" />
    </StackPanel>
</UserControl> 
```

该应用程序在 Visual Studio 中完美显示，但是当我运行该应用程序时，图像不显示。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T19:16:27.357

嗯……

看看这个文档：

[http://msdn.microsoft.com/en-us/library/system.windows.controls.image.source(VS.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.image.source(VS.95).aspx)

我认为主要问题是您正在进行跨域调用，只是建议：下载 fiddler，在那里您将检查您请求数据的服务器是否允许跨域调用（试一试，从 flckr 加载图像看看会发生什么）。

一种解决方案可能是在服务器端使用隧道（您域上的自定义 http 处理程序，它从远程服务器获取图像并将其重定向到您的 SL 请求）。

HTH布劳里奥

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T23:24:20.880

你的例子绝对有效。我刚试过。

可能问题出在网络上？

您可以通过[Fiddler](http://www.fiddler2.com/fiddler2/version.asp)调试网络通信。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-07T09:29:11.140

虽然 Image 控件允许跨域 URL 访问，但不允许跨方案访问。使用自动生成的测试页面运行时，它将从您的本地驱动器运行（我猜这将在 FILE 协议下间接运行），因此不允许跨方案到 HTTP 协议。您应该做的是让包含 Silverlight 控件的页面在 下运行`http://localhost`，这应该可以解决问题。

参考：[Silverlight 中的 URL 访问限制](http://msdn.microsoft.com/en-us/library/cc189008%28VS.95%29.aspx)

或者，在您的 Silverlight 项目（不是 Web 项目）属性中，在“调试”窗格中，选择将其作为 OOB 应用程序运行以进行测试

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-02T15:04:43.247

这是一个真正的表演停止者！！！！如果您在网络服务的网络服务器上安装一些愚蠢的文件，至少网络服务调用仍然是可能的。也许这会有所帮助：在网络服务器上安装 clientaccesspolicy.xml 以获取图像。 [http://msdn.microsoft.com/en-us/library/cc645032%28VS.95%29.aspx](http://msdn.microsoft.com/en-us/library/cc645032%28VS.95%29.aspx)

# c# - Python 与 C# Twitter API 库

> ID：872054
> 
> 赞同：12
> 
> 时间：2009-05-16T09:27:26.273
> 
> 标签：c#, python, api, twitter

我有 .NET（5 年）和 Python（1 年）的经验，我想创建一个以 Twitter 为骨干的简单 Web 项目。我有使用 AppEngine 的经验，并且一直想尝试 Azure。我将广泛使用一次发送和解析来自大量用户的推文，并且由于我为此设置了一个较短的截止日期，因此我想采用最短的路径。那么有没有人有这两种经验，或者有什么建议？

快速浏览一下 twitter API 库 ( [http://apiwiki.twitter.com/Libraries](http://apiwiki.twitter.com/Libraries) ) 给了我这个 python：

*   德威特·克林顿的 python-twitter。这个库为 Twitter API 提供了一个纯 Python 接口。
*   python-twyt 由 Andrew Price 编写。BSD 许可的 Twitter API 接口库和命令行客户端。
*   达斯汀·萨林斯 (Dustin Sallings) 的 twitty-twister。Twitter 的 Twisted 界面。

这对于 C#：

*   Yedda 的 Yedda Twitter 库。每个 Twitter API 方法在这个包装库中都有一个等效的 .NET 方法。
*   Eric Willis/RareEdge Design Group 的 TwitterooCore API。可用于任何 .NET 项目的二进制 .NET 库。
*   Twitterizer 最初由 DigitallyBorn 开发，但现在开源。为 .NET 2.0 编写。
*   丹尼尔·克里纳的推文#。“100% 覆盖 REST 和搜索 API”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T09:35:35.053

最好的建议是使用您最熟悉的任何语言。

我自己和一位同事最近使用 C# 服务重新编写了我们的 Twitter Web 应用程序的整个后端，我们的决定归结为哪个库最适合该目的。许多库具有不同的“功能”，有些库比其他库更完整：我们决定选择哪些库纯粹是基于对它们的尝试，并查看哪些是最佳优化的，并使我们的工作变得最简单。

我会推荐一个 C# 库，但竞争环境变化如此之快，我们已经更改了几次实现，因为 Twitter 已经弃用了其 API 的各个方面，有些更新得比其他方面更快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T11:17:24.463

我会为这个 twitter 库投票；[http://code.google.com/p/python-twitter/](http://code.google.com/p/python-twitter/)

我已经在 10 多个我能想到的项目中使用了它，而且效果非常好。实际上，我也在许多项目中使用了开发版本，发现它很稳定并且有更多的功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-29T15:07:59.287

[LINQ to Twitter](http://linqtotwitter.codeplex.com/) is available too, covers the entire Twitter API, and works with VB, C#, and Delphi Prism.

Joe

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T15:10:35.573

您可以同时使用 .NET 和 Python ... IronPython。IronPython 将与 Yedda 一起使用。[1](http://www.ironpython.info/index.php/Tweet)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T15:16:07.120

我将[这个 python 库](http://mike.verdone.ca/twitter/)用于我的一个项目。

它非常易于使用，但功能非常强大。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-08T20:15:04.343

python-twyt 由 Andrew Price 编写。BSD 许可的 Twitter API 接口库和命令行客户端。

是我选择的python库。这很简单。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-17T16:21:37.890

我对 Twitter API 有一点经验（我是 Digitallyborn，Twitterizer 的作者）。

我会说选择对你来说最容易的东西。每种语言都有很多很棒的库。

# python - Django 模板的可视化编辑器？

> ID：872065
> 
> 赞同：20
> 
> 时间：2009-05-16T09:34:04.090
> 
> 标签：python, django, django-templates

是否有用于可视化构建 Django 模板的工具？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T01:51:48.573

我没有亲自尝试过，但一位同事使用免费的[ActiveState Komodo Edit](http://www.activestate.com/komodo_edit/features/)来编辑 Django 模板，我链接的页面声称支持 Django 模板编辑。

还有[netbeans-django](http://code.google.com/p/netbeans-django/)正在为 Netbeans 构建一个 Django 插件，但不知道它有多完整或工作得如何。

我读过 TextMate 有一个“Django 包”，如果你在 Mac 上可以编辑代码和模板。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-28T05:59:17.960

还有[PyCharm](http://www.jetbrains.com/pycharm/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T09:19:03.090

没有像 Dreamweaver 这样的所见即所得工具。但是高亮是可能的。我正在使用 Kate 来编辑我的模板。

例如，当您在 Django 模板中发表评论时，它会插入`{% comment %}`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T02:04:43.087

有点含糊的回答，但如果能够在模板上使用 Dreamweaver 之类的工具对您很重要，那么您可能会发现自己比 Django 模板更喜欢 Genshi，而且切换模板引擎很容易。

Genshi 是一种 XML 模板语言，是 Zope TAL 家族的继承者之一。您的模板文件*是*一个有效的 XML 文件，因此您可以在任何支持 XML 的工具中打开它。就个人而言，一旦我习惯了使用 XML 模板，我就无法回头，但是它们的处理速度较慢（xml 解析器必须在幕后运行），并且它们需要在您的输出中使用有效的 XHTML，这可能是一个好的或一个好的坏事。（例如，无效的用户提交的 html 内容需要使用 Beautiful Soup 或 ElementTree 之类的东西强制清理）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-15T08:27:59.053

我真的很喜欢带有 Pydev 和 Aptana Studio 3 Eclipse 插件的 Eclipse。更多信息在这里： http: [//pydev.blogspot.com/2010/08/django-templates-editor.html](http://pydev.blogspot.com/2010/08/django-templates-editor.html)

（我做的第一件事就是改变主题。我很喜欢 Mac Classic 主题的 Django 模板突出显示。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-03T05:40:42.750

不要忘记[Emacs](https://code.djangoproject.com/wiki/Emacs)用户有 django 模板帮助。Emacs 链接将带您到 Emacs 中更多有用的文档。

# xml - 从 XSLT 中的路径创建嵌套树结构

> ID：872067
> 
> 赞同：9
> 
> 时间：2009-05-16T09:35:53.523
> 
> 标签：xml, xslt

我有一个动态 XML 文档，它表示类别的树结构，但使用路径分隔的属性**以任意顺序**执行此操作- 如下所示：

```
 <data>    
      <record ID="24" Name="category 1\sub category 1"/>   
      <record ID="26" Name="category 1"/>     
      <record ID="25" Name="category 1\sub category 1\sub category 2"/>    
      <record ID="27" Name="category 1\sub category 1\sub category 3"/>    
      ...
   </data> 
```

我需要想出一个“规范化” XML 的解决方案，以便将其转换为如下内容：

```
 <data>    
      <record ID="26" Name="category 1">    
         <record ID="24" Name="sub category 1">    
            <record ID="25" Name="sub category 2"/>
            <record ID="27" Name="sub category 3"/>    
         </record>
      </record>   
      ...
   </data> 
```

基本上我想知道这是否是 XSLT 可能能够解决的问题，以及如何解决，而不是必须以编程方式完成。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-16T10:08:30.713

好没问题：

```
<xsl:stylesheet 
  version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>

  <xsl:output indent="yes" />

  <xsl:template match="/data">
    <!-- copy the document element -->
    <xsl:copy>
      <!-- That's where we start: all "record" nodes that have no "\". -->
      <xsl:apply-templates mode="recurse" select="/data/record[
        not(contains(@Name, '\'))
      ]" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="record" mode="recurse">
    <xsl:param name="starting-path" select="''" />

    <!-- The record node and its ID attribute can be copied. --> 
    <xsl:copy>
      <xsl:copy-of select="@ID" />

      <!-- Create the new "name" attribute. -->
      <xsl:attribute name="Name">
        <xsl:value-of select="substring-after(@Name, $starting-path)" />
      </xsl:attribute>

      <!-- Append a backslash to the current path. -->
      <xsl:variable name="current-path" select="concat(@Name, '\')" />

      <!-- Select all "record" nodes that are one level deeper... -->
      <xsl:variable name="children" select="/data/record[
        starts-with(@Name, $current-path)
        and
        not(contains(substring-after(@Name, $current-path), '\'))
      ]" />

      <!-- ...and apply this template to them. -->
      <xsl:apply-templates mode="recurse" select="$children">
        <xsl:with-param name="starting-path" select="$current-path" />
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

我的系统上的输出：

```
<data>
  <record ID="26" Name="category 1">
    <record ID="24" Name="sub category 1">
      <record ID="25" Name="sub category 2"></record>
      <record ID="27" Name="sub category 3"></record>
    </record>
  </record>
</data> 
```

请注意，整个解决方案是基于所有路径都是规范的并且不包含尾部反斜杠的假设。

另请注意，任何不匹配/孤立的“记录”元素都不会出现在输出中（当然，除非它们位于根级别）。

还有一件事：模板模式（“递归”）不是绝对必要的。我包含它是因为模板正在做一些相当特别的事情，并且您的解决方案中可能有另一个模板与“记录”节点匹配。在这种情况下，这个解决方案可以在不破坏其他任何东西的情况下被放入。对于独立解决方案，可以随时删除模板模式。

哦，最后一件事：如果您希望结果文档按名称排序，请包含一个带有（两次出现）的[`<xsl:sort>`元素，如下所示：](http://www.w3schools.com/xsl/el_sort.asp)`<xsl:apply-templates>`

```
<xsl:apply-templates select="...">
  <xsl:sort select="@Name" data-type="text" order="ascending" />
</xsl:apply-templates> 
```

# algorithm - 将 Btrees 保存到磁盘文件并读取它

> ID：872070
> 
> 赞同：6
> 
> 时间：2009-05-16T09:37:53.253
> 
> 标签：algorithm, indexing, b-tree

我想在磁盘文件中保存一个 Btree（不确定是二进制的）。然后将其读入内存。一些级别顺序遍历可能是二叉 Btree 的好方法。但如果它不是二进制的。我在内存中建立了从叶子节点到根节点的 Btree。我相信我必须在磁盘文件中定义一些结构并输出树节点。使用一些额外的标签来识别文件中的节点？如何遍历可能是这里的关键问题。我想不出保存节点和指针的好方法。然后阅读它。在内存中重新构造树。有什么好主意吗？多谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T13:07:47.850

B-Trees的常用技术是确保一个节点的大小等于磁盘的块大小，然后mmap磁盘文件。您没有指定您正在使用哪种编程语言，因此它可能像 C 中的强制转换一样简单，或者更复杂一些，例如创建享元对象来包装 java.nio.IntBuffer。无论哪种方式，B-tree 的大部分优点是您不必一次全部加载，而是可以相当有效地跳过它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T09:44:06.263

如果您真的想做类似的事情，您可以在每个节点上分配一个 id 并以该格式保存节点：

[node-id 值 left-node-id right-node-id]

然后用广度优先搜索访问树。

当您要重建树时，创建一个映射 id->node 然后**向后**读取文件：因此，当您读取记录时，创建节点，将其注册到映射并分配左右节点，从中获取节点地图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T10:01:21.653

对于每个节点，定义一些数据结构，它将为您保留节点所具有的相同信息，并向该结构添加附加字段，该字段将为您标记下一个儿子在文件中的偏移量。并将该结构的顶部字段设置为实际大小，因为您不知道您现在正在寻找哪种树。现在通过跳过文件，您将能够重建您的树。我确信我的解决方案不是最终的，但我希望它可以成为你的好榜样。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2009-05-16T12:41:09.380

您可能想查看[Protocol Buffers](http://code.google.com/apis/protocolbuffers/docs/overview.html)。它们是紧凑的、二进制的、可扩展的、易于读写的，并且可用于 C++、Java 和 Python（以及其他语言的第三方实现）。

您可以为 BTree 节点定义一个协议缓冲区消息，为子节点定义文件偏移量，然后以显而易见的方式将其序列化到磁盘。

# asp.net-mvc - 我可以从哪里获得实体框架？

> ID：872071
> 
> 赞同：3
> 
> 时间：2009-05-16T09:38:00.133
> 
> 标签：asp.net-mvc, visual-studio-2008, entity-framework

很抱歉，这可能是一个非常愚蠢的问题。请原谅我，因为我来自 Java 背景，并且我正在努力学习 .Net 技术。

我正在尝试从他们的[网站](http://www.asp.net/learn/mvc/tutorial-26-cs.aspx)上按照 ASP.Net MVC 网站的教程进行操作，然后到达需要制作新模型的部分。当我右键单击时，他们说我必须选择 ADO.Net 数据实体模型。问题是此选项不可用。我不确定我是否安装了 ADO.Net 或者它是否是标准的。我有 VS 2008 专业版，我在 Vista 虚拟机上运行（Sun VirtualBox，不想破坏我当前的环境）。

编辑：

谦虚的道歉。我走得太快了。我现在看到 SP1 是本教程的先决条件。谢谢大家

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T09:44:01.913

对于实体框架（又名 ADO.NET 实体模型），您需要安装[VS2008 SP1](http://www.microsoft.com/downloads/details.aspx?FamilyId=FBEE1648-7106-44A7-9649-6D9F6D58056E)（其中还包括所需的[.NET 3.5 SP1](http://www.microsoft.com/downloads/details.aspx?FamilyID=AB99342F-5D1A-413D-8319-81DA479AB0D7)）。

您还需要确保为项目选择了框架 3.5，但对于 MVC，我想这应该已经是这种情况了......

您的模板也可能无法正常工作......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T09:49:48.433

作为替代方案，如果您来自 java 背景，请[改用 SharpArchitecture](http://www.sharparchitecture.net/)教程。它使用 NHibernate 进行数据访问，因此假设您知道 Hibernate，您应该立即开始使用。

EF 是一项非常新的技术，在 .net 世界中并没有受到高度重视（还没有？）。

编辑：事实上，如果你想衡量当前的情绪，使用 EF 会招致[Wererhino](http://ayende.com/Blog/archive/2009/05/13/post-4000.aspx)的愤怒。

# winapi - VirtualAlloc 和 HeapAlloc 有什么区别？

> ID：872072
> 
> 赞同：91
> 
> 时间：2009-05-16T09:38:41.190
> 
> 标签：winapi, memory, heap-memory, new-operator

在 Windows 环境中分配内存的方法有很多，例如`VirtualAlloc`, `HeapAlloc`, `malloc`, `new`。

那么，它们之间有什么区别呢？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-05-16T09:57:16.967

每个 API 都有不同的用途。每一个还要求您在使用完内存后使用正确的释放/释放功能。

### 虚拟分配

一个低级的 Windows API，它提供了很多选项，但主要对处于相当特定情况的人有用。只能在（编辑：不是 4KB）更大的块中分配内存。在某些情况下您需要它，但是当您处于其中一种情况时您会知道。最常见的一种情况是您必须直接与另一个进程共享内存。不要将其用于通用内存分配。用于`VirtualFree`解除分配。

### 堆分配

分配您要求的任何大小的内存，而不是比`VirtualAlloc`. `HeapAlloc`知道何时需要调用`VirtualAlloc`并自动为您调用。类似`malloc`，但仅适用于 Windows，并提供了更多选项。适合分配一般的内存块。某些 Windows API 可能要求您使用它来分配您传递给它们的内存，或使用它的同伴`HeapFree`来释放它们返回给您的内存。

### malloc

C分配内存的方式。如果您使用 C 而不是 C++ 编写，并且您希望您的代码也可以在例如 Unix 计算机上工作，或者有人特别说您需要使用它，则更喜欢这个。不初始化内存。适合分配一般的内存块，比如`HeapAlloc`. 一个简单的 API。用于`free`解除分配。Visual C++ 的`malloc`调用`HeapAlloc`.

### 新的

C++ 分配内存的方式。如果您使用 C++ 编写，则更喜欢这个。它也将一个或多个对象放入分配的内存中。用于`delete`解除分配（或`delete[]`用于数组）。Visual Studio 的`new`调用`HeapAlloc`，然后可能会初始化对象，具体取决于您如何调用它。

在最近的 C++ 标准（C++11 及更高版本）中，如果您必须手动使用`delete`，那么您做错了，应该使用类似的智能*指针*`unique_ptr`。从 C++14 开始，同样可以说`new`（替换为 等函数`make_unique()`）。

* * *

还有一些其他类似的功能`SysAllocString`，可能会告诉您必须在特定情况下使用。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2017-05-18T18:54:26.190

如果您打算使用需要内存管理的语言（如 C 或 C++），那么了解内存分配 API（在 Windows 中）之间的区别非常重要。恕我直言，最好的说明方法是使用图表：

[![在此处输入图像描述](https://i.stack.imgur.com/mMHbW.png)](https://i.stack.imgur.com/mMHbW.png)

*请注意，这是一个非常简化的特定于 Windows 的视图。*

理解这个图的方法是，内存分配方法在图上越高，它使用的实现就*越高。*但是，让我们从底部开始。

## 内核模式内存管理器

它为操作系统提供所有内存预留和分配，以及对*内存映射文件*、*共享内存*、*写时复制*操作等的支持。它不能从用户模式代码直接访问，所以我会跳过在这里。

## [虚拟分配](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366887(v=vs.85).aspx)/[虚拟自由](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366892(v=vs.85).aspx)

这些是[用户模式下可用的](https://blog.codinghorror.com/understanding-user-and-kernel-mode/)*最低级别*的API 。该函数基本上调用[ZwAllocateVirtualMemory](https://msdn.microsoft.com/en-us/library/windows/hardware/ff566416(v=vs.85).aspx)，然后执行快速*[系统调用](http://www.felixcloutier.com/x86/SYSCALL.html)*以将进一步处理委托给内核内存管理器。它也是在用户模式下从所有可用内存中保留/分配新内存块的最快方法。`VirtualAlloc``ring0`

但它有两个主要条件：

*   它只分配在系统粒度边界上对齐的内存块。

*   它只分配大小是系统粒度的倍数的内存块。

那么这个*系统粒度*是多少呢？您可以通过调用[GetSystemInfo](https://msdn.microsoft.com/en-us/library/windows/desktop/ms724381(v=vs.85).aspx)来获取它。它作为[`dwAllocationGranularity`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms724958(v=vs.85).aspx)参数返回。它的值是特定于实现（也可能是硬件）的，但在许多 64 位 Windows 系统上，它设置为`0x10000`字节或`64K`.

所以这一切意味着，如果你尝试分配，说只是一个 8 字节的内存块`VirtualAlloc`：

```
void* pAddress = VirtualAlloc(NULL, 8, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE); 
```

如果成功，`pAddress`将在`0x10000`字节边界上对齐。即使您只请求了 8 个字节，您将获得的实际内存块将是整个内存块`page`（或类似`4K`字节的东西。在参数中返回确切的页面大小[`dwPageSize`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms724958(v=vs.85).aspx)。）但是，最重要的是，整个内存块跨越`0x10000`字节（或`64K`在大多数情况下）`pAddress` **将不可**用于任何进一步的分配。所以从某种意义上说，通过分配 8 个字节，你也可以要求 65536。

因此，这里故事的寓意并不是要替代`VirtualAlloc`应用程序中的通用内存分配。它必须用于非常特殊的情况，就像下面的*堆*一样。（通常用于保留/分配大块内存。）

*使用`VirtualAlloc`不当会导致严重的内存碎片。*

## [HeapCreate](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366599(v=vs.85).aspx) / [HeapAlloc](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366597(v=vs.85).aspx) / [HeapFree](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366701(v=vs.85).aspx) / [HeapDestroy](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366700(v=vs.85).aspx)

简而言之，*堆*函数基本上是`VirtualAlloc`函数的包装器。这里的其他答案提供了一个很好的概念。我将补充一点，在一个非常简单的视图中，*堆*的工作方式是这样的：

*   `HeapCreate``VirtualAlloc`通过内部调用（或`ZwAllocateVirtualMemory`具体而言）保留一大块虚拟内存。它还建立了一个内部数据结构，可以在虚拟内存的保留块中跟踪更小尺寸的分配。

*   对任何新内存的调用`HeapAlloc`并且实际上并不分配/释放任何新内存（当然，除非请求超过*了*`HeapFree`已经在用户请求。`HeapCreate`*`commit`*

**   `HeapDestroy`反过来调用`VirtualFree`实际上释放了虚拟内存。* 

 *因此，所有这些都使*堆*函数成为应用程序中通用内存分配的完美候选者。它非常适合任意大小的内存分配。*但是为了堆*函数的便利性而付出的一个小代价是，它们`VirtualAlloc`在保留更大的内存块时会引入轻微的开销。

*堆*的另一个好处是您实际上并不需要创建一个。它通常是在您的流程开始时为您创建的。因此可以通过调用[GetProcessHeap](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366569(v=vs.85).aspx)函数来访问它。

## [malloc](https://en.wikipedia.org/wiki/C_dynamic_memory_allocation) /免费

是*堆*函数的特定于语言的包装器。与`HeapAlloc`,`HeapFree`等不同，这些函数不仅适用于您的代码为 Windows 编译，而且适用于其他操作系统（如 Linux 等）

如果您在 C 中编程，这是分配/释放内存的推荐方法。（除非您正在编写特定的内核模式设备驱动程序。）

## [新建](http://www.cplusplus.com/reference/new/)/删除

作为*高级*（嗯，for `C++`）内存管理运算符来。它们是特定于`C++`语言的，就像`malloc`for一样`C`，也是`heap`函数的包装器。他们也有一大堆自己的代码来处理`C++`构造函数的特定初始化、析构函数中的释放、引发异常等。

如果您在`C++`.

* * *

*最后，我想就其他回复中关于使用`VirtualAlloc`在进程之间共享内存的内容发表评论。`VirtualAlloc`本身不允许与其他进程共享其保留/分配的内存。为此，需要使用[`CreateFileMapping`](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366537(v=vs.85).aspx)可以创建可与其他进程共享的命名虚拟内存块的 API。它还可以将磁盘上的文件映射到虚拟内存中以进行读/写访问。但这是另一个话题。*

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-05-16T09:53:33.293

`VirtualAlloc`是 OS 虚拟内存 (VM) 系统的专门分配。VM 系统中的分配必须以分配粒度进行，该分配粒度（分配粒度）取决于体系结构。VM系统中的分配是内存分配的最基本形式之一。VM 分配可以采用多种形式，内存不一定是专用的或物理支持在 RAM 中（尽管可以）。VM 分配通常是一种*特殊用途*的分配类型，因为分配必须

*   非常大，
*   需要分享，
*   必须与特定值（性能原因）保持一致，或者
*   调用者不需要一次使用所有这些内存......
*   ETC...

`HeapAlloc`本质上是`malloc`两者`new`最终调用的内容。它被设计为在通用分配的许多不同类型的场景下非常快速且可用。它是经典意义上的“堆”。堆实际上是由 a 设置的`VirtualAlloc`，它*最初*用于从操作系统保留分配空间。通过 初始化空间后`VirtualAlloc`，配置各种表、列表等数据结构来维护和控制 HEAP 的运行。其中一些操作采用动态调整堆大小（增长和缩小）、使堆适应特定用途（某种大小的频繁分配）等形式。

`new`并且`malloc`有些相同，`malloc`本质上是对`HeapAlloc( heap-id-default )`;的确切调用 `new`但是，可以 [另外] 为 C++*对象*配置分配的内存。对于给定的对象，C++ 将为每个调用者在堆上存储 vtable。这些 vtable 是用于执行的重定向，并构成了 C++ 的 OO 特性（如继承、函数重载等）的一部分......

其他一些常见的分配方法，例如`_alloca()`和`_malloca()`是基于*堆栈*的；FileMappings 真正分配`VirtualAlloc`并设置了特定的位标志，这些标志将这些映射指定为 type `FILE`。

大多数时候，您应该以与该内存的使用一致的方式分配内存；）。 `new`在 C++ 中，`malloc`对于 C，`VirtualAlloc`对于海量或 IPC 案例。

*** 注意，由 完成的大内存分配`HeapAlloc`实际上是`VirtualAlloc`在一定大小（几百 k 或 16 MB 或我忘记的东西，但相当大 :) ）之后运送的。

*** 编辑我简要地评论了 IPC 和`VirtualAlloc`，还有一些非常简洁的相关`VirtualAlloc`内容，对此问题的回复者都没有讨论过。

`VirtualAlloc`**Ex**是一个进程可以用来在*不同*进程的地址空间中分配内存的方法。最典型的是，这用于通过**CreateRemoteThread**~~组合~~使用以在另一个进程的上下文中远程执行（类似于，线程只是在另一个进程中运行）。**`CreateThread`**

 *** * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-16T09:44:13.893

概述：

*   VirtualAlloc、HeapAlloc 等是直接从操作系统分配各种类型内存的 Windows API。VirtualAlloc 管理 Windows 虚拟内存系统中的页面，而 HeapAlloc 从特定的 OS 堆分配。坦率地说，您不太可能需要使用它们中的任何一个。

*   malloc 是一个标准 C（和 C++）库函数，可为您的进程分配内存。malloc 的实现通常会使用其中一个 OS API 在您的应用程序启动时创建一个内存池，然后在您发出 malloc 请求时从中分配

*   new 是一个标准 C++ 运算符，它分配内存，然后在该内存上适当地调用构造函数。它可以根据 malloc 或 OS API 来实现，在这种情况下，它通常也会在应用程序启动时创建一个内存池。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-01-18T00:12:34.060

`VirtualAlloc`===> `sbrk()`UNIX下

`HeapAlloc`====> `malloc()`UNIX下

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-17T14:14:15.437

`VirtualAlloc`=> 直接分配到虚拟内存，你保留/提交块。这对于大型分配非常有用，例如大型数组。

`HeapAlloc`/ `new`=> 在默认堆（或您可能创建的任何其他堆）上分配内存。这为每个对象分配，非常适合较小的对象。默认堆是可序列化的，因此它具有保证线程分配（这可能会在高性能场景中导致一些问题，这就是您可以创建自己的堆的原因）。

`malloc`=> 使用 C 运行时堆，类似于`HeapAlloc`但在兼容性场景中很常见。

简而言之，堆只是由堆管理器管理的一块虚拟内存（而不是原始虚拟内存）

内存世界的最后一个模型是内存映射文件，这种场景非常适合大块数据（如大文件）。这在您打开 EXE 时在内部使用（它不会将 EXE 加载到内存中，只是创建一个内存映射文件）。

# windows - 在所有接口上接受来自本地客户端的套接字；拒绝远程客户端

> ID：872074
> 
> 赞同：3
> 
> 时间：2009-05-16T09:40:12.687
> 
> 标签：windows, linux, sockets

我需要编写一个小型套接字服务器代理应用程序，它接受来自所有接口上本地应用程序的连接（套接字应该绑定到 0.0.0.0）。

我不知道实现这一点的方法（我有阻止绑定到 127.0.0.1 的附加要求）。

对此的第一次尝试执行以下操作：

bind(0.0.0.0) ... s = accept() ... // 如果 (s.src_addr 不在 local_interfaces 中) 则拒绝远程连接 close() ... // 使用本地连接正常进行

此实现对远程应用程序有副作用 - 他们看到接受/关闭组合。系统需要表现得使远程应用程序感知到“什么都没有”：-->SYN <--RST/ACK

为了实现这种行为，我使用了 SO_CONDITIONAL_ACCEPT 和 WSAAccept 回调 (LPCONDITIONPROC lpfnCondition) 的 winsock API 组合，以接受/拒绝基于其原始接口的连接（即它是否是本地地址之一）。

这导致了所需的功能行为：本地应用程序工作；远程应用程序收到所需的 WSAECONNREFUSED 错误。

这需要付出一定的代价：SO_CONDITIONAL_ACCEPT 有一定的副作用（参见 MSDN），但更重要的是，我们需要一个 LINUX 实现，并且以后可能必须将其移植到其他 UNIX。

我的首要任务是 LINUX 解决方案。请注意，如果需要的话，我愿意超越套接字 API。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T10:06:56.567

一种简单的解决方案是使用外部防火墙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T20:18:20.903

这样做的标准方法是无论如何都接受连接，然后如果它们来自您不喜欢的地址，请立即关闭它们而不进行任何通信。

如果这确实是您迫切需要做的事情，那么它不是 BSD 套接字做事方式的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T00:09:02.023

Netfilters / iptables 已经提到过，所以我不再赘述——它可能是处理这个问题的最简单方法，但话又说回来，它不是“你的程序”的一部分，而是内核的一个特性。

但是有一个称为 tcpwrappers 的工具，许多系统守护进程也使用它——你知道 /etc 文件夹中的那些 hosts.allow 和 hosts.deny 文件——它们是 tcpwrappers 的一部分，可以归档你描述的确切场景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T19:34:56.873

也许您可能需要安装适当的数据包过滤器，或者您的应用程序可以自己安装这些过滤器。有关 iptables 命令的详细信息，请参见[http://www.netfilter.org/](http://www.netfilter.org/)（还有一个 libnfnetlink，它提供了用于过滤器管理的 API，但这显然不适合通用应用程序使用）。

您是否考虑过使用 AF_UNIX 套接字？

# php - 第一次建立贝宝电子商务网站 - 如何做对？

> ID：872076
> 
> 赞同：3
> 
> 时间：2009-05-16T09:41:03.557
> 
> 标签：php, zend-framework, e-commerce, paypal

这可能很奇怪，但我现在正在一个基于会员的网站上工作，用户在该网站上注册并选择会员模式，该模式将按月、按季或按年付款。它将基于贝宝。然而，尽管我已经工作了 5 年，但我之前从未从事过任何电子商务项目：\ 相反，我几乎从事过其他所有工作，例如集成 wikipedia、构建电子邮件客户端、pdf 解析等，我有点困惑如何开始。我以前没有做过任何网上购物——我知道使用第三方支付背后的理论，但我不知道应该如何构建我的系统。

就像我们有 3 个用户，免费用户、高级用户和黄金用户。免费用户的访问权限最少，黄金用户的访问权限最大，而高级用户的访问权限介于两者之间，因此他们需要相应地收费。我在想这样的网站是如何运作的，我的意思是说一个用户注册了一个黄金账户并支付了 3 个月的费用。三个月结束时会发生什么是会员网站，这样他们会在每个时间段后自动向个人收费，或者在接近会员资格结束时提示个人付款？在这种情况下，关于交易和所有内容，我需要存储哪些信息。

另外，我如何在不必使用实时信用卡的情况下测试这个系统：\ - 抱歉，如果我在这里听起来像个菜鸟，但以前从未有机会从事这样的项目。学习永远不会太晚。

* * *

我已经决定，会员资格在这方面会有点简单 - 用户在注册后将获得一个免费帐户，并允许在设定的期限内升级他们的帐户，到期后他们将被重置回他们的基本帐户，除非他们选择付费订阅。现在的问题是 - 我完全不知道如何让它工作，我不会使用定期计费。

无论我使用 paypal、2checkout 还是 google checkout 或者底层的方法对所有人都一样，这有什么区别吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T09:45:54.357

Paypal 有一个用于开发和测试目的的沙盒环境。在这里注册 - [h​​ttps://developer.paypal.com](https://developer.paypal.com)。它的工作原理与实时 PayPal 完全一样，并且非常易于使用。

您将使用哪种类型的 PayPal 帐户？如果是标准版，那么您将无法使用任何高级 API，并且只会提供一个带有隐藏元素（如“金额”或“电子邮件”）的表单。您在网站上放置的此表格，客户将被重定向到 PayPal 进行付款。如果您想从 PayPal 收到包含交易详情的通知，您必须启用 IPN 帖子。这可以在 PayPal 帐户设置中完成。IPN 帖子将在您指定的 URL 处执行您的脚本。

如果您需要任何示例，请告诉我。

我不确定如何自动向客户收费。请检查 API - [https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/library_documentation](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/library_documentation)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T09:48:39.903

查看您的标签，您提到了 PHP。OSCommerce 将是您开始的好地方，因为您可以看到一个管理站点，面向前端的客户站点。然后你有代码、文档、支付网关集成等......

从这里您可以将其用作更自定义和更小的系统的模板，或者使用 OSCommerce 并为其创建额外的模块。

安德鲁

[http://www.oscommerce.com/](http://www.oscommerce.com/)

# c++ - 模板和语法

> ID：872087
> 
> 赞同：2
> 
> 时间：2009-05-16T09:50:18.277
> 
> 标签：c++, templates

研究一种算法来查看 STL 字符串（或其他字符串，使其通用）的 STL 容器

基本上，它会遍历 std::list 之类的东西，并返回共同的最长开头的长度。它用于处理文件列表，如下所示：

```
C:\Windows\System32\Stuff.exe
C:\Windows\Things\InHere.txt
C:\Windows\Foo\Bar.txt

```

这应该返回 11，因为 " `C:\Windows\`" 是共同的。

以前从未编写过模板化函数，我的编译器在抱怨。这是我的代码：
标题：

```
// longestBegin.h -- Longest beginning subsequence solver
template <typename SequenceSequenceT, typename SequenceT, typename T >
size_t longestBegin(InputIterator firstCandidates, InputIterator lastCandidates); 
```

* * *

执行：

```
// longestBegin.cpp -- Longest beginning subsequence solver
#include <stdafx.h>

template <typename SequenceSequenceT, typename SequenceT, typename T >
size_t longestBegin(InputIterator firstCandidates, InputIterator lastCandidates)
{
    SequenceT firstString = *firstCandidates;
    size_t longestValue = firstString.length();
    firstCandidates++;
    for(size_t idx = 0; idx < longestValue; idx++)
    {
        T curChar = firstString[idx];
        for(InputIterator curCandidate = firstCandidates;curCandidate != lastCandidates; curCandidate++)
        {
            if ((*curCandidate)[idx] != curChar)
                return idx - 1;
        }
    }
    return longestValue;
} 
```

我有一种有趣的感觉，我在这里遗漏了一些基本的东西......

编译器会出现以下错误：

```
error C2998: 'size_t longestBegin' : cannot be a template definition 
```

有任何想法吗？谢谢！

比利3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T10:07:28.127

行中的参数名称`template`需要包含任何类型的函数参数或返回类型。这意味着您需要`InputIterator`在模板参数列表中提及。尝试将您的函数声明更改为：

```
 template <typename InputIterator>
size_t longestBegin(InputIterator firstCandidates, InputIterator lastCandidates) 
```

您的下一个问题是：编译器如何知道`SequenceT`是什么？答案是它是取消引用的结果`InputIterator`。不是指针的迭代器有一个嵌套的`typedef`called `reference`，这正是您需要的。将此添加到函数的开头，以便编译器知道是什么`SequenceT`：

```
 template <typename InputIterator>
size_t longestBegin(InputIterator firstCandidates, InputIterator lastCandidates)
{
    typedef typename InputIterator::reference SequenceT;
[etc.] 
```

您可以保留`SequenceT`作为模板参数，但是编译器无法通过查看参数来猜测它是什么，并且您必须通过键入 eg 来调用您的函数`longestBegin<string>(arguments)`，这在此处不是必需的。

此外，您会注意到，如果是指针，这将不起作用`InputIterator`——指针没有嵌套的 typedef。`std::iterator_traits`因此，您可以使用从标准标头中调用的特殊结构`<iterator>`，它可以为您解决这些问题：

```
 //(At the top of your file)
#include <iterator>

template <typename InputIterator>
size_t longestBegin(InputIterator firstCandidates, InputIterator lastCandidates)
{
    typedef typename std::iterator_traits<InputIterator>::reference SequenceT;
[etc.] 
```

最后，除非第一个字符串总是最长的，否则您最终可能会在第二个 for 循环内访问超出其数组末尾的字符串。您可以在访问之前检查字符串的长度：

```
 //(At the top of your file)
#include <iterator>

template <typename InputIterator>
size_t longestBegin(InputIterator firstCandidates, InputIterator lastCandidates)
{
    typedef typename std::iterator_traits<InputIterator>::reference SequenceT;
    SequenceT firstString = *firstCandidates;
    size_t longestValue = firstString.length();
    firstCandidates++;
    for(size_t idx = 0; idx < longestValue; idx++)
    {
        T curChar = firstString[idx];
        for(InputIterator curCandidate = firstCandidates;curCandidate != lastCandidates; curCandidate++)
        {
                if (curCandidate->size() >= idx || (*curCandidate)[idx] != curChar)
                        return idx - 1;
        }
    }
    return longestValue;
} 
```

另请注意，`(size_t)(-1)`如果没有公共前缀，则该函数将返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T09:54:26.987

我相信你不能转发声明模板。尝试将实现移动到头文件中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T09:54:53.697

看起来您首先需要将实现放入头文件中，因为它是一个模板函数，并且仅在编译时“实现”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T10:06:51.373

InputIterator 不是我认为的类型。可以申报吗

```
InputIterator x; 
```

在您的代码中还是出现错误？

# python - No reverse error in Google App Engine Django patch?

> ID：872100
> 
> 赞同：2
> 
> 时间：2009-05-16T10:02:28.873
> 
> 标签：python, django, google-app-engine, django-urls

I am using [Google App Engine](http://en.wikipedia.org/wiki/Google_App_Engine) patch Django.

When I try to go to the admin site,

> [http://127.0.0.1:8080/admin/](http://127.0.0.1:8080/admin/)

, I keep getting this error:

> TemplateSyntaxError at /admin/ Caught an exception while rendering: Reverse for 'settings.django.contrib.auth.views.logout' with arguments '()' and keyword arguments '{}' not found.

It's a fresh installation and I have not changed much. But I am not able to solve this problem.

This is the urls.py file that comes with the patch inside the registration app:

```
urlpatterns = patterns('',
    # Activation keys get matched by \w+ instead of the more specific
    # [a-fA-F0-9]{40} because a bad activation key should still get to
    # that way it can return a sensible "invalid key" message instead
    # confusing 404.
    url(r'^activate/(?P<activation_key>\w+)/$',
        activate,
        name='registration_activate'),
    url(r'^login/$',
        auth_views.login,
        {'template_name': 'registration/login.html'},
        name='auth_login'),
    url(r'^logout/$',
        auth_views.logout,
        name='auth_logout'),
    url(r'^password/change/$',
        auth_views.password_change,
        name='auth_password_change'),
    url(r'^password/change/done/$',
        auth_views.password_change_done,
        name='auth_password_change_done'),
    url(r'^password/reset/$',
        auth_views.password_reset,
        name='auth_password_reset'),
    url(r'^password/reset/confirm/(?P<uidb36>.+)/(?P<token>.+)/$',
        auth_views.password_reset_confirm,
        name='auth_password_reset_confirm'),
    url(r'^password/reset/complete/$',
        auth_views.password_reset_complete,
        name='auth_password_reset_complete'),
    url(r'^password/reset/done/$',
        auth_views.password_reset_done,
        name='auth_password_reset_done'),
    url(r'^register/$',
        register,
        name='registration_register'),
    url(r'^register/complete/$',
        direct_to_template,
        {'template': 'registration/registration_complete.html'},
        name='registration_complete'),
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T20:01:37.133

I could not find a proper answer to my question. Anyways I solved the problem temporarily by reinstalling the Django framework and the app engine SDK.

# java - 找不到符号类 IOException

> ID：872101
> 
> 赞同：11
> 
> 时间：2009-05-16T10:03:18.153
> 
> 标签：java, exception

```
public void populateNotesFromFile()
{
    try{
        BufferedReader reader = new BufferedReader(new FileReader(DEFAULT_NOTES_SAVED));
        String fileNotes = reader.readLine();

        while(fileNotes != null){
            notes.add(fileNotes);
            fileNotes = reader.readLine();
        }
        reader.close();
    }
    catch (IOException e){
        System.err.println("The desired file " + DEFAULT_NOTES_SAVED + " has problems being read from");
    }
    catch (FileNotFoundException e){
        System.err.println("Unable to open " + DEFAULT_NOTES_SAVED);
    }

    //make sure we have one note
    if (notes.size() == 0){
        notes.add("There are no notes stored in your note book");
    }       
} 
```

每当我编译上述内容时，我都会收到一条消息，说找不到符号类 IOException e

有人可以告诉我如何解决吗：d

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-16T10:08:44.257

IOException 是 java.io 包中的一个类，因此为了使用它，您应该`import`在代码中添加一个声明。`import java.io.*;`（在 java 文件的最顶部，在包名和你的类声明之间）

FileNotFoundException*是一个*IOException。它是 IOException 的一个特化。一旦你捕获了 IOException，程序的流程将永远无法检查更具体的 IOException。只需交换这两个，首先测试更具体的情况（FileNotFound），*然后*处理（捕获）任何其他可能的 IOExceptions。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T10:05:03.873

你需要

```
import java.io; 
```

在文件的顶部。

此外，FileNotFoundException 必须高于 IOException，因为它是 IOException 的子类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T10:17:59.333

您可能缺少`import`对`IOException` `class`. 我在`java.io`包裹里。

我可以建议您对方法进行一些更改吗？始终在 finally 块中关闭流：

```
public void populateNotesFromFile() {
    BufferedReader reader = null;
    try {
        reader = new BufferedReader(new FileReader(DEFAULT_NOTES_SAVED));
        String fileNotes = reader.readLine();
        while (fileNotes != null) {
            notes.add(fileNotes);
            fileNotes = reader.readLine();
        }
    } catch (FileNotFoundException e) {
        System.err.println("Unable to open " + DEFAULT_NOTES_SAVED);
    } catch (IOException e) {
        System.err.println("The desired file " + DEFAULT_NOTES_SAVED
                + " has problems being read from");
    } finally {
        try {
            reader.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    // make sure we have one note
    if (notes.size() == 0) {
        notes.add("There are no notes stored in your note book");
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T10:05:39.707

您需要在文件顶部导入 java.io.* 包，或者将异常完全限定为 java.io.IOException

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T10:11:43.687

切换 FileNotFoundException 和 IOException 的顺序

# python - 这个 Python 代码有什么问题？

> ID：872119
> 
> 赞同：-1
> 
> 时间：2009-05-16T10:09:06.343
> 
> 标签：python

我很新，所以只是学习，所以请放轻松！

```
start = int(input('How much did you start with?:' ))
if start < 0:
    print("That's impossible!  Try again.")
    print(start = int(input('How much did you start with:' )))
if start >= 0:
    print(inorout = raw_input('Cool!  Now have you put money in or taken it out?: '))
    if inorout == in:
        print(in = int(raw_input('Well done!  How much did you put in?:')))
        print(int(start + in)) 
```

这总是导致语法错误？我确定我做错了什么！

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T10:14:00.450

*   您不能在 Python 中的表达式中分配变量，例如在 C 中： print (start=int(input('blah'))) 不正确。首先在单独的语句中进行赋值。
*   第一行不能缩进，但这可能只是复制和粘贴错误。
*   该词`in`是保留字，因此您不能将其用于变量名

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T10:19:05.620

在语句中分配是你的问题。将分配移出打印语句

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T13:49:35.923

*   考虑使用包装循环的函数提示输入。
*   不要将[input](http://docs.python.org/library/functions.html#input)用于一般用户输入，请改用[raw_input](http://docs.python.org/library/functions.html#raw_input)
*   将您的脚本执行包装在一个主函数中，这样它就不会在导入时执行

* * *

```
def ask_positive_integer(prompt, warning="Enter a positive integer, please!"):
    while True:
        response = raw_input(prompt)
        try:
            response = int(response)
            if response < 0:
                print(warning)
            else:
                return response
        except ValueError:
            print(warning)

def ask_in_or_out(prompt, warning="In or out, please!"):
    '''
    returns True if 'in' False if 'out'
    '''
    while True:
        response = raw_input(prompt)
        if response.lower() in ('i', 'in'): return True
        if response.lower() in ('o', 'ou', 'out'): return False
        print warning

def main():
    start = ask_positive_integer('How much did you start with?: ')
    in_ = ask_in_or_out('Cool!  Now have you put money in or taken it out?: ')
    if in_:
        in_amount = ask_positive_integer('Well done!  How much did you put in?: ')
        print(start + in_amount)
    else:
        out_amount = ask_positive_integer('Well done!  How much did you take out?: ')
        print(start - out_amount)

if __name__ == '__main__':
    main() 
```

# parsing - 寻求用于创建上下文无关解析器语法的交互式实用程序

> ID：872124
> 
> 赞同：4
> 
> 时间：2009-05-16T10:12:04.793
> 
> 标签：parsing, lexer, bnf, context-free-grammar

我想要一个实用程序，我可以提供一段文本（在文本框中）并尝试解析器语法（通过编辑类似的 BNF）和令牌结构，同时我可以看到解析树的外观（如果它是无法使用我当前的语法解析文本，我会看到它在哪里停止）。

关键词是交互性。例如，我可以使用 flex 和 bison 来做到这一点，但我必须不断地重新创建我的词法分析器和解析器。

外面有这样的东西吗？我还没有找到。理想情况下，它应该在 Linux 中工作并且是免费的，如果这不是一个选项，它仍然很有趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T10:32:52.340

**您可以使用 GTKSourceView 与 pyBison 和朋友一起敲打它**

我没有看到任何东西，但如果你愿意，你可以编写一个程序来做到这一点。我会将 Bison 的源代码移植到 DSO，这样您就可以加载它并通过它运行 BNF 并拉出自动机表。然后将评估附加到 GTK-source-view 文本框

- 或者 -

创建一个前端（GTKSourceView 似乎又不错了）并将其附加到一些系统调用以写出您的 flex.c 和 bison.c 并形成一些共享对象 output.so，然后将其加载和卸载到应用程序中，然后您可以运行一些来源通过。

我在开发语法时倾向于使用**pyBison**和其他高级语言工具来提高开发速度。然后将 C/Flex/Bison 与 .l 和 .y 文件一起使用。GTK 应该很容易在 Python 中使用，无需 DSO 和 dlopen() fandango 即可实现上述目标。

非常类似于 Read-Eval-Print 循环，其中 BNF 和测试语法与一些后端 D/NFA 生成器处于循环中

**一段时间以后**

我发现这回答了另一个问题：

[http://jscc.jmksf.com/jscc_on_web.png](http://jscc.jmksf.com/jscc_on_web.png)

它是一个类似 JavaScript Yacc/Bison 的工具，用于在 JavaScript 中生成解析器。您可以轻松地使用它来调试您的 C 语法，因为它们都是 BNF！我一定会使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-15T04:17:04.050

ANTLRWORKS ( [http://www.antlr.org/works/index.html](http://www.antlr.org/works/index.html) ) 是迄今为止我见过的最好的交互式语法开发环境。它让您可视化和调试用 ANTLR 编写的 LL(*) 语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-13T12:34:25.367

看看[VisualBNF](http://www.intralogic.eu/VisualBNF)

# c# - 如何在从右到左（如希伯来语或阿拉伯语）中使用 Datagrid？

> ID：872137
> 
> 赞同：3
> 
> 时间：2009-05-16T10:24:43.937
> 
> 标签：c#, windows-mobile

如何在从右到左（如希伯来语或阿拉伯语）中使用 Datagrid？

(WS2008,WinMobile2005,FW3.5)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T14:04:18.637

数据网格根本不支持 RTL。如果您需要 RTL，则必须自定义绘制单元格。您可以使用[来自 CF 团队的自定义绘图示例](http://blogs.msdn.com/netcfteam/archive/2006/04/25/583542.aspx)作为基础。

# open-source - 有没有开源的塔防游戏？

> ID：872142
> 
> 赞同：3
> 
> 时间：2009-05-16T10:26:02.387
> 
> 标签：open-source

我正在寻找一款开源的塔防游戏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T10:29:21.617

[open-tower-defense](http://code.google.com/p/open-tower-defense/) ,*使用 XNA 库的 C# 开源塔防游戏*

# c++ - 如何强制不同dll中静态对象的破坏顺序？

> ID：872143
> 
> 赞同：5
> 
> 时间：2009-05-16T10:28:34.690
> 
> 标签：c++, dll, static, destructor

我在 2 个**不同的 dll中有 2 个****静态**对象：

 **一个对象*Resources*（这是一个单例）和一个对象*User*。析构函数中的对象用户必须访问对象资源。

如何在对象用户之前强制对象资源不被破坏？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T23:45:57.830

如果您能够将这 2 个全局变量放在同一个 DLL 中，那就不是同一个故事了。正如 Jem 在自己的回复中所说，系统不保证 DLL 分离顺序。因此，当有 2 个单独的 Dll 时，您可能会遇到很大的问题。我不是 Windows 系统专家，但是通过 google 看了一下，我发现 msdn 博主告诉他们有同样的问题，但没有好的解决方案。

我可以将它们放在同一个 DLL 中，根据我的说法，解决方案更容易，在这种情况下，您不需要解决“不保证 DLL 分离顺序”问题（据我了解无法解决）。
但是你仍然需要解决一个新问题：c++ 语言不保证全局变量的销毁顺序。但是可以解决这个问题：

您需要使用某种参考计算。boost::shared_ptr 可以解决问题。

将其声明为全局并以这种方式定义它：

```
boost::shared_ptr my_resource_ptr ( new Resource() ); // new operator is important here! 
```

然后你需要修改你的 User 实现来**存储** 它自己的 shared_ptr：

```
class User
{
    ...
    boost::share_ptr a_resource_ptr;
    ...
}; 
```

只要您的所有 User 实例没有被销毁，它们就会“保留” Resource 实例，从而防止它被过早删除，即使全局 shared_ptr 可能已被销毁。
最后一个被销毁的 User 实例将（间接地）删除 Resource 实例。

无论您使用什么引用计数，ComPtr，您自己的，它都应该可以解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T10:46:56.067

全局对象在其相应的 DLL 被卸载时被销毁。因此，由于您的“用户”dll 可能依赖于您的“资源”dll，因此您遇到了麻烦：“资源”总是在“用户”之前被销毁。

如果存在的话，我也对这个问题的一个很好的答案感兴趣。到目前为止，我正在使用一个必须由应用程序在退出之前调用的清理函数，并且我只在析构函数中保留无害的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T15:29:45.200

我认为您不能更改不同模块中全局变量的破坏顺序。有没有机会添加一些引用计数？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T02:18:12.443

如果您真的想获得 2 个单独的 Dll，我可能会给您一些提示：您可以考虑使用`FreeLibrary()`Windows API。正如[msdn](http://msdn.microsoft.com/en-us/library/ms683152(VS.85).aspx) `FreeLibrary()`所述，递减 Dll 的引用计数器，当计数器达到 0 时该计数器被卸载。

缺点： using意味着您正在使用( [msdn link](http://msdn.microsoft.com/en-us/library/ms684175(VS.85).aspx)`FreeLibrary()` )加载它，并且从该库调用函数意味着您正在使用该函数，这可能会导致非常丑陋的代码。而且它也可能意味着您的代码也发生了一些变化 - 因为将全局变量指向 Dll 的函数以存储每个函数的地址......`LoadLibrary()``GetProcAddress()`

如果你想实现它：

1.  `main()`您必须从您的流程功能中 加载和释放库，
2.  并且还从实现 User 类的 Dll 中加载和释放库。在这个 Dll的函数中实现它，`DllMain()`原因是`DLL_PROCESS_DETACH`（参见[mdsn 的 DllMain 链接](http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx)。

因此，只有在“用户”库完成后，它才会卸载“资源”库。

如果您愿意，请尝试一下，并告诉我它是否有效，因为我从未实施过它。

Ps：我已经对您的问题发布了第二个答案，以便在两个答案之间进行有意义的分离，因为我（尝试）详细说明了这两个答案。我不想让你把它们混在一起弄糊涂……

# c# - 从 C#/WPF 访问 MySQL 的方法

> ID：872148
> 
> 赞同：0
> 
> 时间：2009-05-16T10:32:26.337
> 
> 标签：c#, mysql, wpf, linq

我是 WPF 和 C# 的新手，我想知道访问 MySQL 的最佳方式。

谷歌搜索了一下，我看到有一个用于 MySQL 的 Linq 提供程序。这是最好的方法吗？ [http://code2code.net/DB_Linq/](http://code2code.net/DB_Linq/)

我以前从未使用过 Linq，所以我今天就开始，除非有人知道更好的方法。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T17:04:34.210

您应该使用官方的[MySQL ADO.NET 提供程序](http://dev.mysql.com/downloads/connector/net/6.0.html)。6.0 版引入了对实体框架的基本支持

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T11:36:07.290

这取决于！如果我正在指导一个刚刚起步的人，我不会让他们开始使用 LINQ。您说您刚开始使用 C#，但也许您对其他环境有一定的了解，尤其是数据库，也许您熟悉 ORM。如果这是真的，那么一定要先进入 LINQ。如果没有，那么我建议在您的第一个项目中使用 ADO.NET 进行数据库访问——它更容易开始，并且对于其他替代方案具有一定的基础。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T10:47:42.697

为什么不使用[NHibernate](http://en.wikipedia.org/wiki/NHibernate)？

/被打破的记录。

# wcf - 如何在 WCF 中修复“找不到与架构 http 匹配的基地址”...

> ID：872151
> 
> 赞同：34
> 
> 时间：2009-05-16T10:34:25.410
> 
> 标签：wcf, iis, basichttpbinding

我正在尝试将 WCF 服务部署到我的服务器，托管在 IIS 中。自然它可以在我的机器上运行:)

但是当我部署它时，我收到以下错误：

> 这个集合已经包含一个带有 http 方案的地址。此集合中的每个方案最多可以有一个地址。

对此进行谷歌搜索，我发现我必须将 serviceHostingEnvironment 元素放入 web.config 文件中：

```
<serviceHostingEnvironment>
  <baseAddressPrefixFilters>
    <add prefix="http://mywebsiteurl"/>
  </baseAddressPrefixFilters>
</serviceHostingEnvironment> 
```

但是一旦我这样做了，我会得到以下信息：

> 找不到与绑定 BasicHttpBinding 的终结点的方案 http 匹配的基地址。注册的基地址方案是 [https]。

似乎它不知道基地址是什么，但我该如何指定呢？这是我的 web.config 文件的相关部分：

```
<system.serviceModel>
  <serviceHostingEnvironment>
    <baseAddressPrefixFilters>
      <add prefix="http://mywebsiteurl"/>
    </baseAddressPrefixFilters>
  </serviceHostingEnvironment>

  <behaviors>
    <serviceBehaviors>
      <behavior name="WcfPortalBehavior">
        <serviceMetadata httpGetEnabled="true"/>
        <serviceDebug includeExceptionDetailInFaults="true"/>
      </behavior>
    </serviceBehaviors>
  </behaviors>
  <bindings>
    <basicHttpBinding>
      <binding name="BasicHttpBinding_IWcfPortal"
               maxBufferSize="2147483647" maxReceivedMessageSize="2147483647"
               receiveTimeout="00:10:00" sendTimeout="00:10:00"
               openTimeout="00:10:00" closeTimeout="00:10:00">
        <readerQuotas maxBytesPerRead="2147483647" maxArrayLength="2147483647"
               maxStringContentLength="2147483647"/>
      </binding>
    </basicHttpBinding>
  </bindings>

  <services>
    <service behaviorConfiguration="WcfPortalBehavior" name="Csla.Server.Hosts.Silverlight.WcfPortal">
      <endpoint address="" binding="basicHttpBinding" contract="Csla.Server.Hosts.Silverlight.IWcfPortal"
      bindingConfiguration="BasicHttpBinding_IWcfPortal">
      </endpoint>
      <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
    </service>
  </services>
</system.serviceModel> 
```

任何人都可以阐明发生了什么以及如何解决它？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2011-03-30T10:36:22.777

尝试将安全模式从“传输”更改为“无”。

```
 <!-- Transport security mode requires IIS to have a
           certificate configured for SSL. See readme for
           more information on how to set this up. -->
      <security mode="None"> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-21T20:14:30.637

我必须对站点/应用程序的 IIS 配置做两件事。我的问题与让 net.tcp 在 IIS 网站应用程序中工作有关：

第一的：

1.  右键单击 IIS 应用程序名称。
2.  管理网站
3.  高级设置
4.  将启用的协议设置为“http,net.tcp”

第二：

1.  在 Manager 右侧的 Actions 菜单下，单击 Bindings...
2.  点击添加
3.  将类型更改为“net.tcp”
4.  将绑定信息设置为 {open port number}:*
5.  好的

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-12T17:01:34.733

如果您想在 web.config 中使用 baseAddressPrefixFilters，您还必须设置 IIS (6)。这帮助了我：

1/ 在 IIS 中找到您的站点。2/ 属性/网站（选项卡）/IP 地址 -> 高级按钮 3/ 在您将在 web.config 中使用的同一端口上添加新主机头。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-16T17:26:05.390

您的 IIS 是否有可能被配置为在连接到您的站点/应用程序时需要 SSL？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-07T13:43:13.443

只有列表中的第一个基地址将被接管（来自 IIS）。在 .NET4 之前，每个方案不能有多个基地址。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-22T05:41:17.777

解决方案是在 Web.Config 文件中定义自定义绑定并将安全模式设置为“传输”。然后，您只需要使用端点定义中的 bindingConfiguration 属性来指向您的自定义绑定。

请参阅此处：[Scott 的博客：HTTPS 所需的 WCF 绑定](http://weblogs.asp.net/srkirkland/archive/2008/02/20/wcf-bindings-needed-for-https.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T09:36:20.893

如果托管在 IIS 中，则无需指定基地址，它将是虚拟目录的地址。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-19T02:50:54.213

应该有一种方法可以通过外部配置部分和一个额外的部署步骤轻松解决这个问题，该步骤将特定于部署的外部 .config 文件放入已知位置。我们通常使用此解决方案来处理我们不同部署环境（暂存、QA、生产等）的不同服务器配置，如果没有发生特殊副本，我们的“开发箱”是默认设置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-19T03:48:39.620

确认我的修复：

在您的 web.config 文件中，您应该将其配置为如下所示：

```
<system.serviceModel >
    <serviceHostingEnvironment configSource=".\Configurations\ServiceHosting.config" />
    ... 
```

然后，构建一个如下所示的文件夹结构：

```
/web.config
/Configurations/ServiceHosting.config
/Configurations/Deploy/ServiceHosting.config 
```

基本的 serviceHosting.config 应该如下所示：

```
<?xml version="1.0"?>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true">
    <baseAddressPrefixFilters>
    </baseAddressPrefixFilters>
</serviceHostingEnvironment> 
```

而 /Deploy 中的那个看起来像这样：

```
<serviceHostingEnvironment aspNetCompatibilityEnabled="true">
    <baseAddressPrefixFilters>
        <add prefix="http://myappname.web707.discountasp.net"/>
    </baseAddressPrefixFilters>
</serviceHostingEnvironment> 
```

除此之外，您还需要添加手动或自动部署步骤，以将文件从 /Deploy 复制到 /Configurations 中的文件之上。这对于服务地址和连接字符串非常有效，并且可以节省其他解决方法的工作量。

如果您不喜欢这种方法（它可以很好地扩展到农场，但在单台机器上较弱），您可以考虑在主机机器上的服务部署上添加一个 web.config 文件，并将 serviceHostingEnvironment 节点放在那里。它应该为您级联。

# java - 如何构建一个java web应用程序

> ID：872153
> 
> 赞同：5
> 
> 时间：2009-05-16T10:35:35.250
> 
> 标签：java, orm, user-interface, frameworks

很快我将不得不为一家公司启动一个 Web 项目，我现在需要选择一种技术来构建应用程序。我正在考虑使用 Java，因此我想找到一个可以帮助我构建应用程序的框架（我习惯于 PHP 框架，例如 CakePHP 和 CodeIgniter）。

我不明白的是，它似乎存在很多没有相同目标的框架和技术。动作框架，组件框架......我可以用一个我不能用另一个做什么？似乎应该通过混合许多不同的技术来开发一个 java web 应用程序，因此我有点迷茫......我看过不同的 java 框架，例如 JSF、Stripes、Struts2、Tapestry、Wicket 和春天。关于后者，我不知道这个框架的不同部分是什么，它可以为我做什么，它不能做什么。我可以从春天得到什么，我不需要什么......

因此：我需要什么来构建一个 java web 应用程序？

我已经将 JSF 用于基本的 CRUD 应用程序，但我正在尝试找到更适合我需要的东西。我们必须构建的应用程序既是一个社区平台，也是一个商家网站，需要保护敏感数据:)

关于 ORM，我想我会选择 Hibernate ...我也听说过 Maven 或 Ant，它们能以什么方式帮助我？

任何建议/指南将不胜感激:-) 在此先感谢。

编辑：我的需求是：一个ja​​va框架：

*   有据可查/易于获得帮助/尽可能简单...
*   java越多越好
*   Ajax 友好/构建漂亮 UI 的设施......
*   国际化
*   仍然是学生，技能的适销性可能很重要......

要构建的应用程序既是

*   社区站点：web 2.0，CRUD
*   电子商务网站

完整的规格还没有完成。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T16:30:43.680

这是一个非常难以回答的问题，最近遇到了你的情况，我将尝试提供一些见解。基本上，对于 Java，框架有很多选择，没有人能真正告诉你哪一个最适合你，我们能做的就是给你一些技术的细分。

以下是我在寻找您想要的相同答案时遇到的问题。

Java 有许多技术试图提供全栈解决方案。这些技术可以分解为其他技术，但当您将它们一起使用时效果很好。

基本上，Web 应用程序有 3 层，即表示层、业务层和数据层。表示层是前端，是用户所看到的。您通常可以混合和匹配这三层的技术。例如，您可以使用带有 IOC 和 Hibernate 的 Spring 框架的条带前端作为您的 ORM。

您可以将许多出色的技术用于表示层，其中包括 Spring-MVC、STRUTS、Stripes、Wicket、JSF/SEAM 和 Tapestry。其中大多数使用 JSTL 为视图使用 JSP，但 wicket 除外，它实际上通过使用 Java“组件”(POJOS) 将 html 与逻辑完全分开。这两种方法都有优点和缺点。wicket 方法的好处是您有静态类型检查和 html 的完全分离，因此您可以将其交给您的设计师。

对于业务层，人们通常使用某种控制反转框架 (IOC) 进行依赖注入 (DI)。IOC 的流行框架是 Spring 和 Seam，它们具有相关的技术，如 Spring-security，并且通常由其他技术支持。Google Guice 似乎在直接 DI 框架中很受欢迎。

最后，对于数据层，大多数人倾向于使用 Hibernate 或 JPA。还有其他人，但我对他们没有经验，无法提供更多信息。

Tapestry 是另一个框架，它试图根据我的理解成为一个完整的堆栈，并采用类似 wicket（或者我猜 Wicket 采用类似 Tapestry）的方法。Grails 是另一个使用 Groovy 并建立在 Spring 和 Hibernate 之上的全栈框架。如果你喜欢 Rails，Grails 是相当不错的。

这些技术中的大多数都有大量可用信息和非常活跃的邮件列表/IRC 聊天室。您需要做的是查看它们，然后决定哪种方法适合您。这里没有人能告诉你你会喜欢什么。

如果您想要推荐，我想有一天使用 Wicket/Guice/Hibernate 堆栈。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T11:05:10.967

我最喜欢的绝对是春天。新的 Spring MVC 2.5 设置简单快捷，大量注释可帮助您以声明方式连接控制器，从而节省大量输入。它还与 Spring 容器集成，这绝对是我最喜欢的轻量级 J2EE 替代容器。我通常将 SpringMVC 与简单的 JSP 结合起来，但还有很多其他的视图技术可供选择。对于持久性，我通常使用 Hibernate。可能值得看看[Spring ROO](http://forum.springsource.org/showthread.php?t=71985)，它有点像没有 Groovy 的 Grails。Spring Security 提供了一种很好且简单的声明式安全性方法，并集成到一大堆身份​​验证技术中。

Maven 和 ant 都是构建工具，而 maven 还为您处理依赖项。您“只是”设置描述您想要的库和版本要求的描述符，maven 将为您下载所有库及其依赖项。但是，它会迫使您遵循特定的项目布局。对于蚂蚁来说，常春藤有依赖关系。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T10:48:12.757

我建议你看看[Grails](http://www.grails.org/)。Grails 是一个“按惯例编码”的 Web 应用程序框架，构建在一堆经过验证的 Java 框架（Spring、Hibernate 等）之上并使用[Groovy](http://groovy.codehaus.org)语言。

Grails 的美妙之处在于您几乎不需要 Spring、Hibernate 等知识即可上手。但之后，如果有必要，您仍然可以使用这些框架的全部功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T11:29:53.560

绝对使用 Spring 作为后端；他们的免费支持论坛上有一个很棒的社区（您也可以付费获得更正式的支持）。

关于您使用 Hibernate 的决定，您可能希望针对 JPA 进行编码，以便将您的应用程序与 Hibernate（这是几个 JPA 实现之一）分离。

如果你想要一个 Ajax 前端，那么值得看看[ZK](http://www.zkoss.org/)框架；它非常易于使用，无需学习 JavaScript，并且无需使用像 DWR 这样的管道库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T12:27:18.930

其他人使用 Spring 的建议是一个绝妙的主意。你会发现你实际上会一起使用许多不同的框架，因为每个框架解决的问题略有不同。

我建议您在开始之前在每个框架或技术上投入一些时间，但您最终会希望让它们一起工作。例如，您可能需要一个 Struts + Spring + Hibernate 设置。配置它们可能会让人头疼。

因此，我建议您使用[AppFuse](http://www.appfuse.org)，它有助于生成具有基本功能的基本应用程序。它可以节省大量时间。您当然需要了解为您配置的不同框架，因此它不是一个神奇的解决方案。

# asp.net-mvc - 我应该在 ASP.Net MVC、NHibernate、LINQ、EF 中使用什么？

> ID：872154
> 
> 赞同：3
> 
> 时间：2009-05-16T10:36:55.810
> 
> 标签：asp.net-mvc, data-access

嗨，我早些时候发布了一个问题，我得到了一些回复，我应该看看一些不同的技术。以上哪一项（或其他随意提及）是最受欢迎或最受支持的。

正如我之前的问题中所述，我正在学习 ASP.Net MVC。我来自 Java struts 背景，但我准备尝试了解大多数人与 ASP.Net MVC 一起使用的内容？

编辑：我做了一个快速的谷歌趋势来尝试挑选最受欢迎的（假设搜索最多=最受欢迎=最受支持，是的，我知道，一个充满短跌的概念）然后 LINQ 是最好的方法：

[谷歌趋势](http://www.google.com/trends?q=Nhibernate%2C+Linq%2C+entity+framework)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T10:42:52.927

LINQ to SQL 是其中最简单的。我建议您从 LINQ to SQL 开始。

NHibernate 可能看起来更接近 Java 的 Hibernate，但我强烈建议将 LiNQ 到 SQL 作为起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T10:43:07.603

[NHibernate](http://en.wikipedia.org/wiki/NHibernate)是迄今为止 .NET 世界中最好的 ORM。

# ruby-on-rails - Ruby on Rails的安装问题

> ID：872155
> 
> 赞同：2
> 
> 时间：2009-05-16T10:37:37.977
> 
> 标签：ruby-on-rails, windows, ruby, rubygems

我是 Ruby on Rails 的初学者，使用 Windows 进行开发。

我执行以下步骤：
1\. 下载 Ruby v.1.9.1
[ftp://ftp.ruby-lang.org/pub/ruby/binaries/mswin32/ruby-1.9.1-p0-i386-mswin32.zip](ftp://ftp.ruby-lang.org/pub/ruby/binaries/mswin32/ruby-1.9.1-p0-i386-mswin32.zip) 解压并将其放入 C:\ruby
2\. 下载最新的 Aptana 并安装它
3\. 在 Aptana 中安装 RadRail 插件。
4.将ruby路径设置为C:\ruby

之后，它会警告我没有安装 RubyGems。我知道 Ruby v.1.9.1 已经包含 RubyGems。

我现在应该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T00:46:51.273

好吧，第一步是获得正确版本的 Ruby for Rails。Ruby 1.9.1 在 Rails 中引起了奇怪的问题。卸载它并获得 1.8.7。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T10:04:23.747

如果您是使用 Windows 的初学者，我建议您采用最简单的方法并安装其他人制作的 Ruby 和 Rails 发行版，例如

*   [BitNami Ruby 堆栈](http://bitnami.org/stack/rubystack "BitNami Ruby 堆栈")
*   [一键式 Ruby 安装程序](http://rubyforge.org/projects/rubyinstaller/ "一键式 Ruby 安装程序")

[Netbeans](http://www.netbeans.org/features/ruby/index.html "NetBeans（Ruby 版）")的 Ruby 版本包含它自己的 Ruby 运行时 (JRuby)，因此非常适合快速入门。

官方的 Ruby 下载适用于喜欢安装依赖项和编译自己的版本的人。在大多数操作系统上，您可以只使用供应商提供的 Ruby 版本。Microsoft 不提供 Ruby 构建，在 Windows 上编译也更加困难，您必须安装编译器，下载 Zlib 和 OpenSSL 的副本等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-19T16:09:48.490

前言：这个答案显然来不及帮助比利，但对于在 Windows 上开始使用 RoR 的人来说，这是一个常见的问题领域，也是我反复遇到的问题。所以...

**第一个问题是 Step 1**。下载并解压 Ruby 包并不足以获得一个工作的 Ruby 环境，因为 Ruby 依赖于 Windows 中不存在的操作系统的库支持。因此，您需要下载并安装（基本上，只需将它们复制到 \ruby\bin 文件夹中）几个提供此支持的 DLL 文件。这是一篇非常清晰的博客文章，涵盖了[在 Windows 上安装 ruby​​ 1.9](http://blog.orangecabin.com/2009/05/install-ruby-1-9-on-windows-using-zip-binary/)。

然后，您需要将“c:\ruby\bin”添加到您的 Windows PATH（如果您安装到不同的文件夹，显然要修改它）。

现在您可以运行`ruby -v`并`gem -v`检查 Ruby 是否正常工作。如果您收到错误消息，那么您就知道缺少某些东西或 PATH 错误。

**一个更简单的选择**是一键式 ruby​​ 安装程序。不幸的是，ruby-lang.org 链接到的旧版本仅适用于 Ruby 1.8.6，并且不再更新。有一个新的[RubyInstaller](http://rubyinstaller.org/)项目团队拥有 Ruby 1.9.1 的“技术预览”一键安装程序。显然它仍在开发中，但对我来说效果很好。

安装 Ruby 并开始工作**后，您需要安装 Rails**。

在开始运行之前`gem update --system`将 Rubygems 更新到最新版本。以防万一。

Rails（默认）使用 SQLite 数据库进行开发。[您可以从sqlite.org 下载页面](http://www.sqlite.org/download.html)下载预编译的 SQLite 库，并且应该将压缩的 sqlite3.dll 和 sqlite3.def 文件解压缩到 \Ruby\bin（或 Windows PATH 上的任何其他位置）。然后，您应该运行`gem install sqlite3-ruby`以安装 Ruby SQLite 驱动程序。

现在您可以运行`gem install rails`以实际安装rails。预计这需要一两分钟。

最后，请注意 Ruby 和 Rails 环境在不断变化。不幸的是，兼容性问题是 Windows 用户经常遇到的问题（例如几个月前，无法获得可以在 Windows 中编译的 sqlite3-ruby gem 的 Ruby 1.9 兼容版本）。当时准确的安装指南很可能会在几个月内过时。所以在假设这里写的一切都是真的之前，请检查这篇文章的日期！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T10:53:47.283

在 Ruby on Rails[下载页面](http://rubyonrails.org/download)中，他们说您也应该[下载 RubyGems](http://rubyforge.org/frs/?group_id=126)，所以也许您可以尝试一下。

我不知道 Ruby 的 Windows 版本是否带有 RubyGems，但如果你尝试一下，你不会失去任何东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-06T02:45:58.623

此处介绍了在 MS Windows 上安装 Rails 的步骤。[在 Windows 上安装 Rails](http://www.raasukutty.com/blog/computers/installing-rails-local-gem-install.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-16T06:33:38.687

根据我的阅读，Aptana 还不支持 1.9.1。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-29T10:57:59.843

您只需在 Aptana 中运行应用程序。在底部命令提示符中，键入：

```
gem update 
```

# c# - 如何在我的 Windows Mobile 应用程序中显示模式对话框？

> ID：872166
> 
> 赞同：2
> 
> 时间：2009-05-16T10:45:08.520
> 
> 标签：c#, windows-mobile, smartphone

我想知道如何在 Windows 移动应用程序中的一个表单中显示模式对话框。我在表单中获取用户输入，如果验证失败，我想向用户显示一个对话框，告诉他们（只有一个 OK 按钮）。

到目前为止，我在框架中找到的唯一与对话框相关的东西是 DialogResult 类。

我正在使用 Windows Mobile 6 Standard SDK 为 Windows 智能手机进行开发。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T11:02:26.590

.NET Compact Framework 支持[MessageBox.Show](http://msdn.microsoft.com/en-us/library/system.windows.forms.messagebox.show.aspx)，它会弹出一个模式消息。如果您需要做的只是显示一些文本并等待 OK，那可以正常工作。

# python - 按属性对对象列表进行排序

> ID：872181
> 
> 赞同：0
> 
> 时间：2009-05-16T10:53:44.100
> 
> 标签：python

我正在尝试对 python 中的对象列表进行排序，但是此代码不起作用：

```
import datetime

class Day:
    def __init__(self, date, text):
        self.date = date
        self.text = text

    def __cmp__(self, other):
        return cmp(self.date, other.date)

mylist = [Day(datetime.date(2009, 01, 02), "Jan 2"), Day(datetime.date(2009, 01, 01), "Jan 1")]
print mylist
print mylist.sort() 
```

这个的输出是：

```
[<__main__.Day instance at 0x519e0>, <__main__.Day instance at 0x51a08>]
None 
```

有人可以告诉我一个解决这个问题的好方法吗？为什么`sort()`函数返回`None`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T11:00:58.920

mylist.sort() 什么都不返回，它对列表进行适当的排序。将其更改为

```
mylist.sort()
print mylist 
```

看到正确的结果。

请参阅[http://docs.python.org/library/stdtypes.html#mutable-sequence-types](http://docs.python.org/library/stdtypes.html#mutable-sequence-types)注 7。

> sort() 和 reverse() 方法在对大列表进行排序或反转时修改列表以节省空间。提醒您，它们是按副作用操作的，它们不会返回已排序或反转的列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T11:13:45.893

参见[`sorted`](http://docs.python.org/library/functions.html#sorted)返回任何可迭代的排序副本的函数。

# xml - 处理文本中“特定”字符的问题（在 Java 中，使用 XML 解析器）

> ID：872183
> 
> 赞同：0
> 
> 时间：2009-05-16T10:54:38.483
> 
> 标签：xml, encoding

使用 Java 中的 DOM API 处理文本中的“特定”字符时遇到问题。这些文件采用 XML 格式。我在上一篇文章中被告知 XML 中的 & 符号是什么情况（以及其他几个字符，例如 < 和 >）。这是帖子： [XML 文件中的特殊字符 - 使用 DOM API 处理](https://stackoverflow.com/questions/871963/special-characters-in-xml-files-processing-with-the-dom-api)

但是，我可以如何处理数据中的其他特殊字符，例如德语和法语中的特定字母？例如，我在 XML 文档的文本元素中有单词“façade”。但是，字母“ç”的位置看起来已损坏：当我在 linux 中使用 vim 编辑器打开文件时，它看起来像：“fa^Zade”，当我使用另一个编辑器将其作为 .txt 或 .xml 文件打开时， “ç”的位置看起来像一个小的空矩形（或空白空间）。德语变音符号和其他语言的其他“特殊”符号也是如此。当我尝试使用 XML 解析器处理文件时，它们会出现问题（我遇到解析错误）。我想这是一些编码问题。在 XML 文件的标题中，我使用的是 encoding="UTF-8"。我试图改变它（即“Unicode”

我怎样才能使这些特殊字符被识别？我应该使用一些特殊的编码吗？如果它们只是两个或三个字符，我肯定知道，我可以在使用 Java 中的 DOM API 进行处理之前替换它们，就像我使用与符号 (&) 符号所做的那样（我已将 & 转换为`&amp;`），但是，它们很多，并且可能是任何“特殊”符号。问题是否来自数据的保存方式？例如，在保存过程中应该使用特殊编码 (?)，以便现在可以识别字符 (?)。（我自己没有保存数据）。
谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T11:12:55.117

> 如果它们只是两个或三个字符，我肯定知道，我可以在使用 Java 中的 DOM API 处理之前替换它们，就像我使用 & 符号所做的那样（我已将 & 转换为 &），但是，它们很多，并且可能是任何“特殊”符号。

您不需要预测所有可能的输入。相反，只需将每个此类实体转换为 NCR 或数字字符引用。例如`&#x20AC;`，欧元符号 € 的 NCR；这意味着这`20AC`是欧元符号的十六进制 Unicode 参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T12:23:43.993

这似乎不是 XML 的问题，而是编码问题。XML 可以处理 UTF-8 和 Latin-1。但是您需要知道输入编码或不使用阅读器，而是使用带有 XML 声明的输入流，使用正确的编码属性。

你确定，来源没有腐败？它是哪种编码？第一行声明的 XML 编码属性对吗？^Z 看起来不像 UTF-8 编码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T13:56:49.277

encoding="UTF-8" 似乎是正确的方法，那么您不必区别对待这些字符中的任何一个。您说'在 XML 文件的标题中我使用的是 encoding="UTF-8"'，但是您是否也将字符数据写为 UTF-8？

在vim中你可以使用“ga”来显示光标下字符的代码，这应该有助于调试。

# c - C 的自动完成文本编辑器

> ID：872186
> 
> 赞同：3
> 
> 时间：2009-05-16T10:58:20.580
> 
> 标签：c

第一次在这里发帖，是 C 和一般编程的新手。我确实有一点 HTML 和 CSS 经验，但我正在通过 C for Dummies 进行工作。

我正在尝试找到一个自动完成 C 代码的文本编辑器。目前使用 SubEthaEdit，这是我尝试过的第三个文本编辑器。我怎样才能让它自动完成？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T11:13:20.107

通常，“文本编辑器”本身不支持自动完成功能。尝试使用 IDE（集成开发环境）来实现自动完成功能。有很多可供选择。

你在使用 Windows 吗？我对[Dev-C++](http://www.bloodshed.net/devcpp.html)有非常满意的体验。尽管有这个名字，但它对待 C 的每一点都和对待 C++ 一样。

如果您使用的是 Mac，请查看[msiemeri 的答案](https://stackoverflow.com/questions/872186/auto-complete-text-editor-for-c/872214#872214)。Xcode 是免费的，但您需要在 Apple 注册一个免费帐户。这是我在 Mac 上使用的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T11:10:10.957

请参阅[c-ide-for-linux](https://stackoverflow.com/questions/24109/c-ide-for-linux)和许多其他类似的 SO 问题。

提到的许多 IDE 不仅限于Eclipse `Linux`，在[Eclipse](http://www.eclipse.org/)上运行良好， [Code::Blocks](http://www.codeblocks.org/features)`Windows`也是如此。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T11:14:34.487

由于我假设您使用的是 Mac（使用 SubEthaEdit），因此您可能想尝试[Xcode](http://developer.apple.com/tools/xcode/index.html)，即 OSX 上的“官方”IDE。

不过，它不仅仅是一个文本编辑器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T13:02:00.407

我在 Linux 上为 C 使用 SciTE。

有几个原因——

*   我习惯用 SciTE 在 Windows 和 Linux 上编辑 Python、XML、JavaScript 和文本配置文件。
*   它非常可配置且相当快
*   我倾向于使用单元测试而不是调试，所以不太关心调试器集成。

与大多数优秀的文本编辑器一样，它具有自动完成功能，您可以插入自己的命令。我用于 C 的设置（自动完成、我使用的标准 API、项目特定的 ctags、上下文相关帮助、构建/测试/运行命令）在此处详细[说明](http://www.tincancamera.com/blog/2009/01/scite-and-ctags.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T13:07:49.037

[Visual Assist](http://www.wholetomato.com/)是 Visual Studio 的出色插件，具有非常好的自动完成功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T20:57:41.747

如果你有时间，我建议你学习一个严肃的文本编辑器，比如 Emacs 或 Vim。两者都很棒（我个人使用 Vim）并且具有默认和可自定义行为的选项卡完成（在线有大量具有额外功能的插件）。默认情况下，vim 中的 Ctrl-P 搜索文件和任何链接的文件。例如，如果您包含 stdio.h，则选项卡完成引擎将包含 printf 等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-16T13:32:27.963

将 gedit 与插件一起使用，它在 Linux 中运行良好。

要安装其他插件，请在终端中输入以下命令：

```
apt-get install gedit-plugins 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T11:21:16.750

Vim 支持代码完成，无需大惊小怪。

但也要考虑一下，“自动完成”是一个非常广泛的术语。你到底需要什么？
智能感知[-Visual Studio](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio)。[全能](http://www.vim.org)
-Vim 。 . .

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-16T11:36:32.890

如果您考虑尝试/学习 Vim/Gvim，请查看[c.vim](http://vim.sourceforge.net/scripts/script.php?script_id=213)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-16T11:46:59.043

我们使用 Dev-C++（你可以将它用于 c）Code::Blocks 也很好，但这些不仅仅是文本编辑器，它们是 IDE :)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-16T13:24:34.283

既然您提到了 SubEthaEdit，那么您肯定使用的是 MacOS X。

好吧，[Eclipse](http://www.eclipse.org/downloads/)对所有平台都是一个不错的选择。我建议你试试看。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-01-24T19:30:22.837

作为 IDE，我推荐 Microsoft Visual Studio，Express 版本是免费的。

# sql - id 的意外表扫描！= id

> ID：872195
> 
> 赞同：11
> 
> 时间：2009-05-16T11:03:48.193
> 
> 标签：sql, sql-server, sql-server-2005, indexing

一个应用程序导致我们的 Sql Server 2005 数据库负载过重。**我们无法控制**每分钟运行数百次此查询的应用程序：

```
select id,col1,col2,col3 from table where id != id 
```

注意**id != id**，这意味着一行不等于它自己。不出所料，结果总是找不到行。但是，Sql Server 每次运行此查询时都会进行聚集索引扫描扫描！

id 列定义为：

```
varchar(15) not null primary key 
```

查询计划显示大量“估计行数”。有谁知道为什么 Sql Server 需要表扫描来找出显而易见的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T13:16:29.390

我会伪造这个查询......用视图抽象出来，并欺骗查询。

将现有表 'table' 重命名为 'table_org' 或其他名称，并创建如下视图：

```
CREATE VIEW table
AS
SELECT * FROM table_org
WHERE id='BOGUSKEY' 
```

现在，您应该通过主键上的表进行 1 次扫描，它应该（像原始查询一样）什么也找不到。该应用程序不知道更明智...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T12:56:13.043

你最大的问题不是表扫描。你最大的两个问题是：

*   您有一个绝对无用的查询，每分钟对您的数据库运行 100 次。顺便说一句，我的猜测是，该查询实际上是按照 Marc Gravell 的建议从表中获取列名。

更重要的是：

*   您无法控制谁或什么正在访问您的数据库。

尤其是第二个问题很可能会让你头疼不已。假设您是组织中数据团队的一员（因为您是试图解决此问题的人），您确实应该寻求进行必要的组织更改以完成您的工作。

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T11:21:25.890

每个值与其余的 n-1 个值进行比较。这就是为什么它会为“估计的行数”返回一个巨大的数字。对于上述问题，最好使用 not in。

这里的文章可以很好地解决您的问题。我希望它对你有帮助。[http://www.sqlservercentral.com/articles/Performance+Tuning/2924/](http://www.sqlservercentral.com/articles/Performance+Tuning/2924/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-16T13:49:39.590

我见过这种类型的查询。

开发人员很可能正在根据用户输入、当前设置或其他一些因素构建“WHERE”子句。在许多情况下，可能是默认实例，他们需要一个 WHERE 子句，它只是一个占位符。那是他们使用'id！= id'，'1 <> 1'等标准的时候。

“每分钟数百次”也让我相信这是一些被误导的默认占位符。

有时他们会使用相反的条件，如果默认情况需要所有行，则总是评估为真。

这是一个很长的镜头，但我的建议是看看您是否可以修改应用程序设置并查看此查询是否消失。您最终可能会得到一个小的结果集，但运行频率较低且由 SQL Server 处理得更好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-16T14:16:34.067

您可能想让 SQL Server 支持团队了解此查询（当列被定义为主键时，id <> id）和它导致的全表扫描，并查看他们是否可能想要添加优化在查询引擎中确保这不会导致全表扫描。

要么，要么与您无法控制的应用程序的支持团队交谈。

编辑：尝试在[http://social.msdn.microsoft.com/forums/en-US/sqldatabaseengine/threads/](http://social.msdn.microsoft.com/forums/en-US/sqldatabaseengine/threads/)上的 TechNet 论坛报告该行为。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-17T02:36:07.003

id 列上是否有非聚集索引？如果没有，最有效的方法总是 CIX 扫描。尝试在 ID 列上添加 NCIX - 它可能仍会执行扫描，但至少会扫描非常小的索引。如果您使用的是 SQL Server 2008，则可以创建过滤索引 (WHERE id <> id)，SQL Server 将使用（空）过滤索引来满足查询。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-17T11:24:24.753

在阅读了此处的答案和您的编辑后，让我总结一下您的选择：

1.  更改 MS SQL Server 来处理这种情况（基本上，与 Microsoft 支持人员交谈）
2.  更改应用程序以避免这种情况，或者以不同的方式进行（基本上，与提出应用程序的公司的支持人员交谈）
3.  更改为处理这种情况的 SQL Server 以外的其他东西（如果应用程序允许）
4.  更改为另一个应用程序

这些都不是好的解决方案，但不幸的是，它们是您唯一拥有的解决方案。你必须选择一个，然后去。

我会首先尝试解决方案 2，它是/应该花费最短时间执行的解决方案。

另一方面，如果该公司不愿意更改应用程序，那么我会选择解决方案 4。这是一个主要的性能错误，如果该公司不愿意或无法解决该问题，您必须问自己，还有什么潜伏在下一个角落？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-17T19:27:04.227

我几乎羞于提交这个答案，但本着“如果没有任何理智的作品，尝试疯狂”的精神......

```
    在 id = id? 的表上创建一个约束？

```

where 子句只能返回违反约束的行，其中没有定义。这种额外的（尽管是多余的）信息可能会在您的情况下对优化器有所帮助。它可能同样可以达到什么都没有的平方根，但在你的情况下，我会试一试以防万一......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-16T11:13:02.527

我不知道为什么 id != id 在这种情况下需要这么长时间（尽管“明显”是主观的 - 它不一定是我想到的优化......这似乎是一个不寻常的查询；笛卡尔连接很痛苦， 尽管）。但一般来说，尝试“where 1 = 0” - 或者如果你只想要模式，也许有点冒险[SET FMTONLY ON](http://msdn.microsoft.com/en-us/library/ms173839.aspx)。

编辑：刚刚看到“我们无法控制每分钟运行数百次此查询的应用程序”......嗯......这很棘手。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-17T11:13:00.367

由于对 SQL Server 不太熟悉，我认为下面的解决方案也适用于 SQL Server。

在 Oracle 中，我认为您可以通过使用物化视图和查询重写来超越简单的 SQL。物化视图将不包含任何行，并且查询重写识别 SQL 并将查询重新路由到空视图。物化视图永远不需要更新，因为它总是空的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-17T19:49:50.173

在我看来，你有一个伪装成技术问题的政治问题。您可以在技术问题上投入大量时间和精力，但只要您不断重复“我们不控制应用程序”，您就会使自己无法寻求政治选择。

您无法控制应用程序，但您可以安排施加一些影响。让所有利益相关者了解此应用程序的行为如何影响使用该数据库的其他所有人（使用图表，因为您希望将此消息快速传达给管理层）。并且要明确这是应用程序作者或 Microsoft 需要解决的问题。这可能会给应用程序的作者带来压力，或者它可能会产生“好的，很好。让我们为该应用程序购买另一个数据库”来自管理层的响应。

（对于 Microsoft 是否已在 SQL Server 2008 中“修复”此问题，您需要得到答案。）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-17T19:59:31.200

我怀疑 SqlServer 不“知道” != （应该是 "<>" ？）是反反身的（即 A != A 总是假的）......它只是看到它不是恒定的（它取决于结果行中的值），因此将其放入结果过滤器中。所以“where id <> id”可能与“where 1 <> 1”非常不同。

现在，他们当然可以让它检测到这种情况；但我想这只是没有进入他们的优先级列表，因为这样做介于“奇怪”和“愚蠢”之间。

是的，这样做的应用程序很糟糕，我想你已经知道了；）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-18T19:59:43.803

没有办法让它不扫描，你要求除了 1 行之外的所有内容，即扫描。您能希望的最好结果是让应用程序停止发送这些查询。

# erlang - Erlang : RPC 到一个节点，该节点上有输出

> ID：872198
> 
> 赞同：8
> 
> 时间：2009-05-16T11:05:29.923
> 
> 标签：erlang

有没有办法对节点进行 rpc 调用，但在该节点上显示输出，而不仅仅是在调用节点上（事实上，如果调用节点没有显示输出，我不会太在意）。

虽然我知道我可以使用

```
rpc:call( Node, erlang, display, [ someTerm ] ). 
```

这将在节点上显示“someTerm”，我真正想要的是在远程节点终端上显示执行方法的结果，以便尝试在节点上运行 ls ：

```
rpc:call( Node, c, ls, [] ). 
```

它实际上会将文件夹内容的结果写入Node的终端。

我的想法是我可以从单个节点驱动演示，但让我正在驱动的节点显示对它们的操作历史。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T20:34:17.527

尝试 ;-）

```
rpc:call( Node, c, ls, [] ). 
```

或者当你想显示它时`Node`

```
spawn(Node, fun()->group_leader(whereis(user),self()), c:ls() end). 
```

或更有趣的例子，它将本地进程的输出重定向到另一个终端`Node`

```
group_leader(rpc:call(Node, erlang, whereis, [user]), self()),
c:ls(),
group_leader(whereis(user), self()). 
```

# c# - c# GDI+ 中的外部异常

> ID：872200
> 
> 赞同：3
> 
> 时间：2009-05-16T11:08:06.093
> 
> 标签：c#, image, exception, gdi+, bitmap

我想运行这段代码

```
 Bitmap grayImage = (Bitmap)img.Clone();

        for (int x = 0; x < arr.GetLength(0); x++)
        {
            for (int y = 0; y < arr.GetLength(1); y++)
            {
                int col = arr[x, y];
                Color grau = Color.FromArgb(col, col, col);
                grayImage.SetPixel(x, y, grau);
            }
        } 
```

如果我运行代码，我会在这一行出现异常： grayImage.SetPixel(x, y, grau);

以下是异常详细信息：

System.Runtime.InteropServices.ExternalException wurde nicht behandelt。Message="GDI+ 中出现一般错误。" Source="System.Drawing" ErrorCode=-2147467259 StackTrace: 在 System.Drawing.Bitmap.SetPixel(Int32 x, Int32 y, Color color) 在 Metalldetektor.Bild.ArrToPic(Int32[,] arr, Image img) 在 D: \Documents\Visual Studio 2008\Projects\WindowsFormsApplication1\WindowsFormsApplication1\Bild.cs：D:\Documents\Visual Studio 2008\Projects\WindowsFormsApplication1\WindowsFormsApplication1\Form1 中 Metalldetektor.Form1.button2_Click(Object sender, EventArgs e) 的第 44 行。 cs：System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button,

我不知道该怎么做所以请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T11:30:34.260

过去我也遇到过类似的问题，我的克隆位图有一些伪影。在研究了这个问题一段时间后，我偶然发现了[这个有帮助的线程](http://www.gamedev.net/community/forums/topic.asp?topic_id=501121)。

尝试更换您的 Clone()

```
Bitmap grayImage = (Bitmap)img.Clone(); 
```

有了这个：

```
Bitmap grayImage = new Bitmap(img); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T11:17:36.757

我不知道这个错误，但这可能是 LockBits 的情况......我会看看我是否可以举个例子。

这是一个将数据数组写入 ARGB 位图的简化示例：

```
 // fake data
    int[,] data = new int[100, 150];
    int width = data.GetLength(0), height= data.GetLength(1);
    for (int x = 0; x < width; x++)
        for (int y = 0; y < height; y++)
            data[x, y] = x + y;

    // process it into a Bitmap
    Bitmap bmp = new Bitmap(width, height, PixelFormat.Format32bppArgb);
    BitmapData bd = bmp.LockBits(new Rectangle(0, 0, width, height),
       ImageLockMode.WriteOnly, PixelFormat.Format32bppArgb);
    unsafe {
        byte* root = (byte*)bd.Scan0;
        for (int y = 0; y < height; y++) {
            byte* pixel = root;
            for (int x = 0; x < width; x++) {
                byte col = (byte)data[x, y];
                pixel[0] = col;
                pixel[1] = col;
                pixel[2] = col;
                pixel[3] = 255;
                pixel += 4;
            }
            root += bd.Stride;
        }
    }
    bmp.UnlockBits(bd);
    bmp.Save("foo.bmp"); // or show on screen, etc 
```

这种方法应该*比*.`SetPixel`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T11:27:59.993

很久以前，在我队友的一个系统上处理图像（通过从 SQL 服务器读取二进制数据创建图像）时出现了一些错误。相同的代码在其他机器上运行良好。原来，他安装了一些图形驱动程序的更新，这导致了问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T11:29:50.113

如果您只是覆盖所有内容（或左上角的矩形），为什么还要克隆另一个图像？

# ajax - HTTP 请求返回状态码 0 是什么意思？

> ID：872206
> 
> 赞同：159
> 
> 时间：2009-05-16T11:11:45.320
> 
> 标签：ajax, http, xmlhttprequest, httpresponse, fetch-api

当 JavaScript 网络调用（例如 fetch 或 XMLHttpRequest）或任何其他类型的 HTTP 网络请求失败并返回 HTTP 状态代码 0 时，这意味着什么？

这似乎不是一个有效的 HTTP 状态代码，因为其他代码在 HTTP 规范中是三位数。

我尝试完全拔掉网络作为测试。这可能是不相关的，但这导致了状态代码 17003 (IIRC)，粗略的搜索表明这意味着“DNS 服务器查找失败”。

相同的代码在某些位置和系统上运行良好，但在某些环境中它会失败，状态代码为 0，并且没有提供 responseText。

这是对 Internet URL 的典型 HTTP POST。它不涉及 file:// ，我理解它可能会在 Firefox 中返回 0 表示成功。

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2013-01-24T17:56:30.733

**这里的很多答案都是错误的。** 人们似乎在他们的特定情况下找出了导致 status==0 的原因，然后将其概括为答案。

**实际上，对于失败的 XmlHttpRequest，status==0 应该被视为未定义的错误。**

实际的 W3C 规范定义了此处返回零的条件： [https ://fetch.spec.whatwg.org/#concept-network-error](https://fetch.spec.whatwg.org/#concept-network-error)

正如您从规范（fetch 或 XmlHttpRequest）中看到的那样，此代码可能是甚至在联系服务器之前发生的错误的结果。

产生此状态代码的一些常见情况反映在其他答案中，但可能是这些问题中的任何一个或都不是：

1.  非法跨域请求（参见[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)）
2.  防火墙阻止或过滤
3.  请求本身在代码中被取消
4.  已安装的浏览器扩展程序搞砸了

对于浏览器来说，为更多这些 status==0 场景提供详细的错误报告会很有帮助。事实上，有时 status==0 会伴随一个有用的控制台消息，但在其他情况下没有其他信息。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2009-05-25T08:32:26.910

我相信错误代码表明响应为空（因为甚至没有返回标头）。这意味着连接被接受，然后正常关闭（TCP FIN）。有很多事情可能会导致这种情况，但根据您的描述，某种形式的防火墙似乎是最有可能的罪魁祸首。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2010-10-18T16:52:03.303

对于它的价值，取决于浏览器，基于 jQuery 的 AJAX 调用将使用 HTTP 状态代码 0 调用您的成功回调。我们发现状态代码“0”通常意味着用户之前导航到不同的页面AJAX 调用完成。

与您使用的技术堆栈不同，但希望对某人有用。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-25T07:33:17.607

`wininet.dll`返回下面列出的标准和非标准状态代码。

```
401 - Unauthorized file
403 - Forbidden file
404 - File Not Found
500 - some inclusion or functions may missed
200 - Completed

12002 - Server timeout
12029,12030, 12031 - dropped connections (either web server or DB server)
12152 - Connection closed by server.
13030 - StatusText properties are unavailable, and a query attempt throws an exception 
```

对于状态代码“零”，您是尝试在网络服务器上运行的本地网页上发出请求还是在没有网络服务器的情况下发出请求？

如果您不在网络服务器上运行脚本， *[XMLHttpRequest status = 0 和 XMLHttpRequest statusText = unknown可以帮助您。](http://www.pearweb.com/javascript/XMLHttpRequest.html)*

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-09-13T17:45:08.357

HTTP 响应代码 0 表示 AJAX 请求已取消。

这可能发生在超时、XHR 中止或防火墙踩踏请求。超时很常见，它意味着请求在指定时间内未能执行。XHR 中止操作非常简单……您实际上可以在 XMLHttpRequest 对象上调用 .abort() 来取消 AJAX 调用。（*如果您不希望 AJAX 调用返回并尝试引用已销毁的对象，这对于单页应用程序来说是一种很好的做法。*）正如标记的答案中提到的，防火墙也能够取消请求并触发此0 回应。

XHR Abort：[使用 jQuery 中止 Ajax 请求](https://stackoverflow.com/questions/446594/abort-ajax-requests-using-jquery)

```
var xhr = $.ajax({
    type: "POST",
    url: "some.php",
    data: "name=John&location=Boston",
    success: function(msg){
       alert( "Data Saved: " + msg );
    }
});

//kill the request
xhr.abort() 
```

值得注意的是，在 XHR 对象上运行 .abort() 方法也会触发错误回调。如果您正在执行任何类型的错误处理来解析这些对象，您会很快注意到中止 XHR 和超时 XHR 是相同的，但是使用 jQuery 时，传递给错误回调的 textStatus 将在中止时“中止”并且发生超时的“超时”。如果您使用的是 Zepto（与 jQuery 非常相似），则错误类型在中止时将是“错误”，而在发生超时时将是“超时”。

```
jQuery: error(jqXHR, textStatus, errorThrown);
Zepto:  error(xhr, errorType, error); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-26T21:29:27.233

**解决方法：我们最终做了什么**

我们认为这与防火墙问题有关，因此我们想出了一个解决方法来解决问题。如果有人有同样的问题，这就是我们所做的：

1.  我们仍然像以前一样使用 HTA 将数据写入本地硬盘上的文本文件。

2.  当用户单击“将数据发送回服务器”时，HTA 读取数据并写出一个 HTML 页面，该页面包含该数据作为 XML 数据岛（实际上使用 SCRIPT LANGUAGE=XML 脚本块）。

3.  HTA 在浏览器中启动指向 HTML 页面的链接。

4.  HTML 页面现在包含将数据发布到服务器的 javascript（使用 Microsoft.XMLHTTP）。

希望这可以帮助任何有类似要求的人。在这种情况下，它是在贸易展览会上在笔记本电脑上使用的 Flash 游戏。我们从未接触过笔记本电脑，只能通过电子邮件将其发送给客户，因为这次贸易展正在另一个国家举行。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-08-03T18:05:09.030

正如[this answer on this page](https://stackoverflow.com/a/14507670/26510)所详述，状态代码0表示请求由于某种原因失败，并且javascript库将失败解释为状态代码0。

### 要对此进行测试，您可以执行以下任一操作：

1）使用这个chrome扩展，[请求](https://chrome.google.com/webstore/detail/requestly/mdnleldcmiljblolnjhpnblkcekpdkpa)将你的url从你的url`https`版本重定向到`http`版本，因为这会导致混合内容安全错误，并最终生成状态码0。这种方法的优点是你不根本不必更改您的应用程序，您可以使用此扩展程序简单地“重写”您的 url。

2）更改您的应用程序的代码，以选择性地使您的端点重定向到`http`您的 url 版本而不是`https`版本（反之亦然）。如果这样做，请求将失败，状态码为 0。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-08-05T11:05:04.240

在我的情况下，当我忘记将 WWW 放在我的域前面时，状态变为 0。因为我所有的 ajax 请求都是硬编码的 http:/WWW.mydomain.com 并且加载的网页只是[http://mydomain.com](http://mydomain.com)它成为一个安全问题，因为它是一个不同的域。我最终在我的 .htaccess 文件中进行了重定向，以始终将 www 放在前面。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-10-18T15:27:22.890

我发现 status == 0 的一个新的且未记录的原因。这就是我所拥有的：

```
XMLHttpRequest.status === 0
XMLHttpRequest.readyState === 0
XMLHttpRequest.responseText === ''
XMLHttpRequest.state() === 'rejected' 
```

它不是跨域、网络或由于取消请求（通过代码或用户导航）。开发者控制台或网络日志中没有任何内容。

我可以在 state() 上找到很少的文档（Mozilla 没有列出它，W3C 有）并且没有一个提到“拒绝”。

原来这是我的**广告拦截**器（Firefox 上的 uBlock Origin）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-27T17:48:39.003

**在我的情况下，这是因为 AJAX 调用由于同源策略**而被浏览器阻止。这是最意想不到的事情，因为我所有的 HTML 和脚本都是从`127.0.0.1`. 他们怎么能被认为具有不同的起源？

无论如何，根本原因是一个看似无辜的`<base>`标签：

```
<base href='<%=request.getScheme()%>://<%=request.getServerName() + ":" + request.getServerPort() + request.getContextPath()%>/'/> 
```

我删除了`<base>`我不需要的标签，现在它工作正常！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-03-30T11:07:31.030

除了[Lee 的回答之外，您还可以通过切换到](https://stackoverflow.com/a/14507670/1192811)[同步](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/open)请求来找到有关真正原因的更多信息，因为您还会遇到异常：

```
function request(url) {
    var request = new XMLHttpRequest();
    try {
        request.open('GET', url, false);
        request.send(null);
    } catch (e) {
        console.log(url + ': ' + e);
    }
} 
```

例如 ：

> NetworkError：发生网络错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-07T20:36:45.370

万一其他人遇到这个问题，这会给我带来问题，因为 AJAX 请求和发送的普通表单请求。我用以下行解决了它：

```
<form onsubmit="submitfunc(); return false;"> 
```

那里的关键是 return false，这会导致表单不发送。您也可以只从 submitfunc() 内部返回 false，但我发现明确编写它会更清晰。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-10T16:40:01.690

需要注意的是，超过`client_max_body_size`nginx 指令的 ajax 文件上传会返回此错误代码。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-08-15T21:37:19.523

如果您在本地 PC 上进行测试，它将无法正常工作。要测试 Ajax 示例，您需要将 HTML 文件放在 Web 服务器上。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-09-16T17:47:05.540

就我而言，错误发生在使用 HTTP 协议请求的页面中，其中的 Javascript 试图发出 HTTPS 请求。反之亦然。

页面加载后，按 F12（或 Ctrl + U）并查看页面的 HTML 代码。如果您在代码中看到类似的内容：

```
<!-- javascript request inside the page -->
<script>
var ajaxurl = "https://example.com/wp-admin/admin-ajax.php";
(...)
</script> 
```

您的页面是这样请求的：

> [http://example.com/example-page/2019/09/13/my-post/#elf_l1_Lw](http://example.com/example-page/2019/09/13/my-post/#elf_l1_Lw)

你肯定会面临这个错误。

要修复它，请将 Javascript 请求的协议设置为等于页面请求的协议。

**之前在Brad Parks**的回答中提到了这种涉及页面和 js 请求的不同协议的情况，但我想这里介绍的诊断技术对于大多数用户来说更容易。

# matlab - 如何在 MATLAB 中的进程之间共享内存？

> ID：872209
> 
> 赞同：6
> 
> 时间：2009-05-16T11:13:08.733
> 
> 标签：matlab, memory, process, parallel-processing

有没有办法在同一台计算机上的 MATLAB 进程之间共享内存？

我在多核计算机上运行多个 MATLAB 进程（运行 Windows，如果重要的话）。它们都使用相同的巨大输入数据。在内存中只有一个副本会很好。

编辑：不幸的是，每个进程都需要访问整个巨大的输入数据，因此没有办法分割数据并解决问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T15:33:01.937

如果进程只**读取**数据但**不修改**它，那么我相信您可以将输入数据放入一个大文件中，并让每个进程打开并从该文件中读取。每个进程都有自己的文件位置指示器，它可以移动到文件中的任何位置来读取它需要的数据。我测试了两个 MATLAB 进程同时从一个文件中读取一百万次左右，一切似乎都运行良好。我只使用了基本的文件 I/O 命令（如下所列）。假设您拥有 MATLAB R2008a 或更高版本，您似乎也可以使用[MEMMAPFILE](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/memmapfile.html)来执行此操作，正如[Fooz 先生在他的回答（以及评论中的 SCFrench ）中提到的那样。](https://stackoverflow.com/questions/872209/sharing-memory-between-processes-matlab/872293#872293)

以下是您可能会为此使用的一些文件 I/O 命令：

*   [FOPEN](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fopen.html)：每个进程都会调用 FOPEN 并返回一个文件标识符，它将在所有后续调用中使用。您可以以*二进制*或*文本*模式打开文件：

    ```
    fid = fopen('data.dat','r');   % Binary mode
    fid = fopen('data.txt','rt');  % Text mode 
    ```

*   [FREAD](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fread.html)：在二进制模式下，FREAD 将从文件中读取数据：

    ```
    A = fread(fid,20,'double');  % Reads 20 double-precision values 
    ```

*   [FSCANF](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fscanf.html)：在文本模式下，FSCANF 将从文件中读取和格式化数据：

    ```
    A = fscanf(fid,'%d',4);  % Reads 4 integer values 
    ```

*   [FGETL](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fgetl.html) / [FGETS](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fgets.html)：在文本模式下，这些将从文件中读取整行。

*   [FTELL](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/ftell.html)：这将告诉您文件开头的当前文件位置指示符（以字节为单位）：

    ```
    ftell(fid)
    ans =
         8    % The position indicator is 8 bytes from the file beginning 
    ```

*   [FSEEK](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fseek.html)：这会将文件位置指示器设置到文件中的所需位置：

    ```
    fseek(fid,0,-1);  % Moves the position indicator to the file beginning 
    ```

*   [FCLOSE](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fclose.html)：每个进程都必须关闭对文件的访问（很容易忘记这样做）：

    ```
    fclose(fid); 
    ```

该解决方案可能要求输入文件具有易于遍历的结构良好的格式（即只有一个大矩阵）。如果它有很多可变长度字段，那么从文件中的正确位置读取数据可能会变得非常棘手。

* * *

如果流程还必须**修改**数据，这可能会变得更加困难。通常，您不希望文件/内存位置同时被多个进程写入，或者被一个进程写入而另一个进程正在从同一位置读取，因为可能会导致不需要的行为。在这种情况下，您必须限制对文件的访问，以便一次只有一个进程在对其进行操作。其他进程必须等到第一个进程完成。在这种情况下，每个进程必须运行的示例代码版本是：

```
processDone = false;
while ~processDone,
  if file_is_free(),  % A function to check that other processes are not
                      %   accessing the file
    fid = fopen(fileName,'r+');  % Open the file
    perform_process(fid);        % The computation this process has to do
    fclose(fid);                 % Close the file
    processDone = true;
  end
end 
```

像这样的同步机制（“[锁](http://en.wikipedia.org/wiki/Lock_(computer_science))”）有时会产生很高的开销，从而降低代码的整体并行效率。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-27T19:24:21.570

您可能想查看我的 Matlab 文件交换提交“sharedmatrix”#28572。它允许 Matlab 矩阵存在于共享内存中，前提是您使用的是某种 Unix 风格。然后可以将共享矩阵附加到 parfor 或 spmd 的主体中，即

```
shmkey=12345;
sharedmatrix('clone',shmkey,X);
clear X;
spmd(8)
    X=sharedmatrix('attach',shmkey);
    % do something with X
    sharedmatrix('detach',shmkey,X);
end
sharedmatrix('free',shmkey); 
```

由于 X 存在于 spmd（或 parfor）主体的共享内存中，因此它没有加载时间和通信时间。从 Matlab 的角度来看，它是 spmd（或 parfor）主体中新创建的变量。

干杯，

乔什

[http://www.mathworks.com/matlabcentral/fileexchange/28572-sharedmatrix](http://www.mathworks.com/matlabcentral/fileexchange/28572-sharedmatrix)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T12:04:00.967

**编辑：**将数据放入原始文件并使用[memmapfile](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/memmapfile.html)（感谢 SCFrench）。

============================================

不，没有真正的方法可以做到这一点。

我的前两个解决方案是：在数据中购买更多 RAM 或页面。

您可以做的最接近的事情是使用 mex 函数来分配共享内存，然后允许连续调用 mex 函数以提取较小的内存片。您不想将共享内存包装为 Matlab 数组（因为 Matlab 的内存模型不能很好地处理它）。

我打算建议调查 memmap，但显然这是[有问题](http://www.mathworks.com/matlabcentral/newsreader/view_thread/250214)的。

有时您可以先运行一个 Matlab 程序来预处理或将数据拆分成更小的块。然后每个 Matlab 进程都可以在其自己的较小块上运行。

这是一个关于在 Matlab 中处理大型数据集的[教程。](http://www.mathworks.com/matlabcentral/fileexchange/9060)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T13:41:36.173

可能不会，至少不会像对待常规 MATLAB 变量那样对待数据。

如果在 Windows 机器上，您可以创建一个 COM/ActiveX 包装器来访问您的共享数据。MATLAB 允许通过该[`actxserver`](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/actxserver.html)函数使用 COM 对象。但是，您是否真的可以通过不同的流程“直接”访问数据，这是值得怀疑的。在 MATLAB 和 COM 之间有某种编组层，并且数据被转换，至少根据 Mathworks 文档在[MATLAB 和 COM 之间交换数据](http://www.mathworks.com/access/helpdesk/help/techdoc/matlab_external/bq4epvg-1.html)。如果我**必须**在 Windows 机器上通过快速访问在进程之间共享结构化数据，我可能会用 C++ 编写一些东西来通过[Boost::interprocess使用共享内存](http://www.boost.org/doc/libs/1_38_0/doc/html/interprocess/managed_memory_segments.html#interprocess.managed_memory_segments.making_ipc_easy)并将对它的访问包装在进程内 COM 服务器 (DLL) 中。我以前做过，一次。尽管 Boost::interprocess 让它变得容易得多，但它是一种痛苦。

Java 方法（因为 MATLAB 在 Java 之上运行）会更有希望，但据我所知，没有任何像样的 Java 库可以提供对共享内存的访问。最接近的可能是通过[java.nio.MappedByteBuffer](http://java.sun.com/j2se/1.4.2/docs/api/java/nio/MappedByteBuffer.html)使用内存映射文件，但这确实是低级的。不过，如果您的数据是相对“方形”的形式（例如，大的 2-D 或 3-D 或 4-D 大小均匀的数据矩阵），这可能工作正常。

您可以尝试使用 HDF5 文件，MATLAB 具有内置的[HDF5 支持](http://www.mathworks.com/access/helpdesk/help/techdoc/matlab_prog/f5-142317.html)，而且它“相对”快。但根据我的经验，HDF5 似乎不能很好地处理并发。（至少当一个进程正在写入而其他进程是读取器时不会。如果有多个读取器而没有写入器，它就可以正常工作。）

# visual-studio - Visual Studio 调试器输出 - 输出相同但格式不同（例如一个项目中的十进制输出，另一个项目中的十六进制输出）

> ID：872210
> 
> 赞同：2
> 
> 时间：2009-05-16T11:13:11.010
> 
> 标签：visual-studio, pointers, directx, debugging

我正在通过将一些 DirectX 代码重新实现到不同的项目中来学习一些 DirectX 编程，但是我确实发现调试器在两个项目（示例和我的项目）之间输出数据的方式似乎不同。

如果我这样做，在我的项目中：

```
D3DSURFACE_DESC desc;
pTarget->GetLevelDesc(0,&desc);
int width = desc.Width;
int height = desc.Height; 
```

并且让调试器输出宽度和高度，我得到十进制的结果，但是在directx示例中，结果是十六进制的（两者实际上都是准确的，当我将十六进制转换为十进制时，它似乎是合适的）。

另一个（稍微）次要的问题是调试器向我提供有关各种 DirectX 相关指针的信息的方式。例如，在我的项目中，当我停止执行并将鼠标移到指针上时，在 DirectX 示例中我得到了一些汉字、空指针和所有这些（纹理仍然有效并且 100% 工作），但是我没有得到那，实际上它没有提供关于指针的任何信息，除了它是 DirectX 基本类型（我的项目没有这样做）。

所以我只是想知道，为什么会这样，是否有任何调试选项可以让它们工作相同？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T19:00:03.527

在 Debug 工具栏上（右键单击工具栏并确保选中 Debug），您可以切换 Hex 按钮。这控制调试器是显示十六进制还是十进制值。您可能只是在不同的地方设置了不同的设置。

您还可以在检查时出现的小检查工具提示中右键单击变量值并打开/关闭十六进制。

# jquery - JQuery如何从href标签中提取值？

> ID：872217
> 
> 赞同：43
> 
> 时间：2009-05-16T11:16:38.117
> 
> 标签：jquery

我是 JQuery 的新手。

如果我有以下标签。从 href 中提取“page”值的最佳 JQuery 方法是什么？

```
<a href="Search/Advanced?page=2">2</a> 
```

马尔科姆

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-05-17T18:55:07.583

我首先想到的是一个单行正则表达式：

```
var pageNum = $("#specificLink").attr("href").match(/page=([0-9]+)/)[1]; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-16T11:29:10.537

我在这里看到两个选项

```
var link = $('a').attr('href');
var equalPosition = link.indexOf('='); //Get the position of '='
var number = link.substring(equalPosition + 1); //Split the string and get the number. 
```

我不知道您是否要将它用于分页并在`<a>`-tag 中保留文本，但如果您应该这样做，您也可以这样做

```
var number = $('a').text(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-16T11:22:07.777

首先，您需要使用以下内容提取路径：

```
$("a#myLink").attr("href"); 
```

然后看看这个插件： http: [//plugins.jquery.com/project/query-object](http://plugins.jquery.com/project/query-object)

它将帮助您处理您想做的各种查询字符串的事情。

/彼得 F

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-16T18:18:14.500

这是一种通过将查询字符串转换为 JSON 来工作的方法......

```
var link = $('a').attr('href');

if (link.indexOf("?") != -1) {
    var query = link.split("?")[1];

    eval("query = {" + query.replace(/&/ig, "\",").replace(/=/ig, ":\"") + "\"};");

    if (query.page)
        alert(unescape(query.page));
    else
        alert('No page parameter');

} else {
    alert('No querystring');
} 
```

不过，我会像其他人建议的那样去图书馆……=）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T11:24:52.327

使用James Padoley 的这个 jQuery[扩展](http://james.padolsey.com/javascript/regex-selector-for-jquery/)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-23T14:45:52.477

```
if ($('a').on('Clicked').text().search('1') == -1)
{
    //Page == 1
}
else
{
    //Page != 1
} 
```

# javascript - JavaScript 导出 div 元素内的代码？

> ID：872226
> 
> 赞同：0
> 
> 时间：2009-05-16T11:24:17.350
> 
> 标签：javascript, svg

我有一个包含`div`元素的 Web 文档。

该`div`元素包含一个`svg`子元素（它本身包含 SVG 原语：`text`、`path`等）。

最终，我想将该`svg`元素导出到一个适当的、自包含的 SVG 文档中。（然后我可以运行该 SVG 文档`imagemagick`并制作出版质量的数字。）

是否有 JavaScript 会将`div`带有必要`<?xml>`标头的元素内容“转储”到文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T13:01:16.260

您可能想查看[jQuery SVG](http://keith-wood.name/svgRef.html)插件，特别是 SVG Defs 部分中的 toSVG() 方法。您将无法通过 Javascript/jQuery 保存文档，但您应该能够打开一个包含文档内容的新窗口，并使用浏览器的保存功能将文本文档保存到文件中。

# java - 我可以持久化的内存中 Java 数据库（作为一个巨大的内存块）

> ID：872229
> 
> 赞同：2
> 
> 时间：2009-05-16T11:25:49.903
> 
> 标签：java, database, memory-management, hsqldb, in-memory-database

我正在寻找一个用于 Java 的内存中关系 (SQL) 数据库（类似于 HSQLDB），我可以对其整个状态进行序列化。

```
wholeDatabase.serialize(outputStream);
newCopyOftheDatabase.loadFrom(inputStream); 
```

或者数据库只使用我在初始化时给它的 byte[] ：

```
byte[] memory = new byte[10 *1024*1024];
new InMemoryDatabase(memory); 
```

数据库不会太大，只有几十 MB，但我无法写入文件，所以我需要在关闭 VM 之前将所有内容从机器上传输出去（并定期进行备份）。

我可以使用普通的（并且易于序列化的）Java 数据结构，如数组或映射而不是 DB，但我希望能够使用 SQL。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T12:14:57.883

HSQLDB 有一个内存选项：

```
Connection c = DriverManager.getConnection("jdbc:hsqldb:mem:aname", "sa", ""); 
```

您只需要转储和恢复内容。要转储结构，您可以使用`SCRIPT`SQL 命令。比您可以通过选择转储每个表。管理器和/或服务器内部可能使用更好的 API，但我认为您需要查看（开放）源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T13:02:03.153

看起来 JavaDB 很快就会支持这个：

[http://blogs.oracle.com/kah/entry/derby_10_5_preview_in](http://blogs.oracle.com/kah/entry/derby_10_5_preview_in)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T11:51:34.477

你有没有想过给 HSQLDB 打补丁？

[http://hsqldb.svn.sourceforge.net](http://hsqldb.svn.sourceforge.net)

# c - system() 在 linux 中究竟是如何工作的？

> ID：872230
> 
> 赞同：8
> 
> 时间：2009-05-16T11:26:07.737
> 
> 标签：c, linux

我一直在阅读它的手册页，但还没有成功地弄清楚它是如何工作的。在调用 system() 时，是否分叉了一个新的子进程并且其中包含 shell 二进制 exec()？不过，这可能是一个愚蠢的猜测。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-16T11:40:53.613

是的，system() 本质上是传递命令字符串的 fork() 和 exec() "sh -c"。可以在[此处](http://www.eglibc.org/cgi-bin/viewcvs.cgi/branches/eglibc-2_9/libc/sysdeps/posix/system.c?rev=7350&view=markup)找到示例实现（来自 eglibc，最近从 glibc 分叉） 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T11:36:20.050

是的，system("foo bar") 等价于 execv("/bin/sh", ["sh", "-c", "foo bar"])。

# c# - 如何在递归函数中强制事件处理？

> ID：872231
> 
> 赞同：3
> 
> 时间：2009-05-16T11:27:37.310
> 
> 标签：c#, event-handling

我正在用 C# 编写一个缓慢绘制谢尔宾斯基三角形的屏幕保护程序。我`Thread.Sleep`在递归函数内部使用来减慢绘图速度。但是我需要一种方法来允许用户通过移动鼠标、按键等来退出。由于我的绘图函数是从`Paint`表单的事件处理程序内部调用的，鼠标和键盘事件仅在绘制整个三角形后才处理，这可能需要相当长的时间。如何在递归函数运行时强制表单处理事件？（以及如何避免由调用绘图函数的绘图事件引起的无限循环，该绘图函数强制事件处理调用绘图事件等？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T11:33:21.680

那么你*可以*使用[`Application.DoEvents`](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.doevents.aspx)- 但我不确定我会建议它。您很容易遇到重入问题，尤其是在`Paint`事件中。

如果您正在处理事件，听起来所有真正的工作都需要在 UI 线程上完成`Paint`- 对吗？

另一种方法是创建一个`Bitmap`并在其上绘制，而不是使用`Paint`事件处理程序。您可以在后台线程上执行此操作，定期创建新图像，将到目前为止绘制的图像复制到其上，绘制下一层（或其他），然后编组到 UI 线程以在 UI 中使用图像。这将使主 UI 线程保持空闲以进行事件处理。您根本不需要处理该`Paint`事件 - 只需使用一个[`PictureBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.aspx)用于显示“到目前为止的图像”。完成后不要忘记处理旧位图，以避免内存问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T11:32:56.970

您可以使用一个后缓冲位图，您可以随时计算/绘制它，并在`Paint`事件中显示它。计算可以在单独的线程中完成。

# c - C 风格语法的客观优势

> ID：872233
> 
> 赞同：8
> 
> 时间：2009-05-16T11:29:07.633
> 
> 标签：c, syntax

有大量的编程语言受到 C 风格语法（花括号、semcola 等）的严重影响，可能比任何其他语法风格都多。直到今天，许多现代、成功甚至新发明的语言都使用这种语法——想想 Java、C++、C#、PHP、JavaScript、C、Perl 等。

是否有任何客观原因可以解释这种语法的广泛传播和成功？与其他语言的语法相比是否有某些优势？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-16T17:22:39.860

恕我直言，使 C 样式语法流行的唯一原因是大多数人都知道它。因此，将 C 风格用于新语言可以应用旧习惯（如命名约定）。这是一件好事！尽管我认为，语法是学习一门新语言最不关心的问题。但是一个好的语法可以帮助避免错误。

微软做了很多努力使 VB.NET 和 C# 一样重要（记住 MSDN 中的所有“ **null**（ Visual Basic 中的**Nothing**）”，这让我很恼火），但 C# 仍然是 .NET 平台的主要语言. 似乎 VB.NET 对其前辈的坏名声有问题。而且，使用 C 风格似乎更专业。

毕竟，C 的设计目标之一是使编译器易于实现。使用预处理器比为常量定义新的语言结构更容易。或者 a[5] 的语义。这不适用于很难实现的 C++，部分原因是它试图与 C 保持兼容。

例子：

*   区分大小写，尽管不区分大小写对人类来说更自然（而不是对计算机）。这并不意味着您应该以不同于声明的方式拼写标识符（当心！），但可能会导致混淆。实际示例 (Java)：getWhiteSpace() 还是 getWhitespace()？

**编辑：**另一个很好的例子：[C# 或 .NET 中最糟糕的问题是什么？](https://stackoverflow.com/questions/241134/what-is-the-worst-c-net-gotcha#241194). 但是，当然，一旦您习惯了它并在 IDE 的帮助下，这不再是什么大问题，有时甚至更自然，因为它更类似于计算机的实际工作方式。

*   运算符优先级

*   `=`用于分配和`==`比较。`if (a = b)`任何人？类似地，`&&`and `&`, `||`and `|`, ( `!`and `~`) 在语法上太接近了，尽管它们的意思不同。就个人而言，我更喜欢`and`and `or`，因为符号应该只支持语法而不是主要部分。

*   `++`和`--`运营商；使一些语句稍微短一些，但给表达式 ( `a = b+++b++`) 带来了副作用。最初，编译器可以比`i = i + 1`.

*   `for(init;condition;step)`环形; 尽管最佳实践是仅使用它来增加变量，但对此不存在显式语法。相反，这个 for 构造是多余的，因为它（几乎）与

    ```
    init;
    while (condition) {
      statement;
      step;
    } 
    ```

*   `switch`陈述; 有没有忘记休息？为什么不像大多数其他语言那样允许范围作为大小写标签？

*   `if(condition)`陈述。使用括号并不是一个好的选择，因为它可以在条件表达式本身中使用：

    ```
    if (!(var & 0x02)) 
    ```

*   预处理器

*   大括号。这是有争议的。我不同意这样的论点，即这些“不使用大量屏幕空间”、更简洁或写起来更快。首先，语言应该被设计成易于阅读，而不是易于书写。其次，根据您的风格，大括号使用的屏幕空间与关键字完全相同：您将它们写在一行中。这不是浪费了很多空间吗？

    此外，人们批评 LISP 的括号杂乱无章。你从来没有发生过你必须数数你的牙套才能找出你漏掉的地方吗？我有时会在右大括号后添加注释以指示应该在此处结束的内容。BASIC 语法已经包含了这个。甚至不需要一个相当于一个开口大括号。我部分同意大括号是好的：它们几乎看不见，缩进是主要的视觉特征。这样看来，python 是下一步。

*   分号作为语句终止符或分隔符。为什么单个分号是有效语句？

    ```
    if (condition);
      DoSomething(); 
    ```

*   无法区分的关键字序列

    ```
    public static string main() 
    ```

    是方法声明吗？还是变量声明？还是函数原型？或者是其他东西？一些标点符号（以及每种声明类型的关键字）在这里可能会有所帮助，例如，明确区分返回类型。这就是使 C++ 难以解析的原因。

*   正交性。`{} while (condition)`确实适合语句后跟块的其他语言结构。我认为VB的

    ```
    do [while/until condition]
      Statements
    loop [while/until condition] 
    ```

    一个不错的解决方案，因为您有 4 种可能的不同语义组合：直到/while 在 do/loop 关键字之后。

*   变量类型修饰符的奇怪顺序。

    ```
    int * const & i []; 
    ```

*   类型和变量名只是一个接一个出现，没有标记它是一个局部变量声明。Scala 使用**val**和**var**表示声明最终/可变变量，类型用冒号分隔。在大多数其他方面，Scala 使用 Java 语法。

*   赋值运算符返回一个值；语句（有效果）和表达式（只返回一个值）之间没有区别

**编辑：**这里还有更多示例：[https ://stackoverflow.com/questions/163026/what-is-your-least-favorite-syntax-gotcha](https://stackoverflow.com/questions/163026/what-is-your-least-favorite-syntax-gotcha)

您肯定不会在其中的许多点上达成一致，而且并非所有这些点都一定是否定的（例如，分号），或者我知道一种对所有情况都更好的解决方案。即使我愿意，生成的语言也不会是完美的语言。编程语言将永远发展，新发明的语言有望向其前辈学习。那么，为什么不保留已知的语法，而不是每十年设计一个新语法呢？

然而，当一个语言设计者有可能避免只是打字错误的编程错误时，为什么不改变它呢？例如，这是在 C# 的 switch 语句中完成的，这使得 break（或 goto）是强制性的。一旦最坏的缺点被消除，大多数程序员了解语法的其余部分所带来的好处远远超过从头开始重新设计语言的好处。但我仍然感到惊讶，为什么这么多程序员仍然如此急切地捍卫 C 语法，尽管这些人已经习惯了计算机科学的进步需要定期修订几乎所有内容。

总而言之，我认为 C 语法占主导地位的唯一原因是因为几乎所有专业程序员都知道它，这些只是习惯了它。实际语法不太重要，尽管其他语言可能有优势。这与电气工程师按原样使用电荷约定的原因相同。

![https://imgs.xkcd.com/comics/urgent_mission.png](https://imgs.xkcd.com/comics/urgent_mission.png)

（也许还会有一部关于程序员拜访丹尼斯·里奇的漫画：“请不要让**switch语句中的****break**成为可选的！”）

 *** * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T12:20:30.337

正如我所看到的，实际上只有三个主要的语法元素从 C 语言传播到世界其他地方：用花括号表示的块、表示行尾的分号以及一般的“简洁”风格。

将块包装在单个字符中很有意义；首先，输入速度很快，不占用大量屏幕空间（与 BEGIN-END 关键字对不同）。其次，语法相当灵活，因此您可以在特殊情况下根据需要/想要格式化您的块（在 Python 之类的东西中您不能真正做到这一点。）最后，您的代码可能会被某些东西弄脏就像一个电子邮件客户端，并且仍然可以被人类和编译器读取（这是我在使用 python 样式的 indents-for-blocks 时遇到的唯一真正的问题）。

但是，为什么要使用花括号？我不知道在 C（或者更可能是 BCPL）中使用它们的历史先例是什么，但我可以大胆猜测一下。“标准”美式键盘上的配对符号并不多：{} [] () 和 <> 就是这样。如果我们想让编译器的工作更轻松，我们需要 BEGIN 和 END 的唯一符号，所以使用类似 | 或 # 表示块结束。在我们的对中，{} 确实是唯一一个不意味着什么的 - () 和 [] 都有很多数学包袱（它们或多或少直接用函数和数组翻译）并且 < 和 > 都意味着各种事情。我也会为块选择 {}。

使用新语言，如果您不使用关键字或缩进，为什么要更改它？大批程序员习惯于使用它们来表示块，为什么要使所有肌肉记忆无效？

同样的论点也适用于使用分号。使用某些东西来表示行尾会使编译器的工作变得更加轻松。只使用一个字符可以让程序员的工作轻松很多。扫描键盘上的单个字符，从数学上讲，分号是少数几个没有多大意义的字符之一。从英语语法的角度来看，句号（或者逗号）最有意义，但它们已经被用作小数点。而且，如果你眯起眼睛，用分号作为行终止符的含义与英语中的含义相当相似。再说一次，如果你要开始一种新的语言，为什么要改变它？

至于基本的简洁性，我认为这是你唯一可以说的，客观地说，是一个好主意。我可以输入的字符越少，以将想法传达给计算机，同时仍然足够接近英语以阅读，越好。

（您可能会争辩说，大多数 C 类型语言也借用了大部分关键字词汇表，但实际上，大多数 C 的关键字来自 ALGOL、FORTRAN 和 BCPL 等较旧的语言，而且真的 - 它们都是（大部分）常识。再说一次，一旦你对编程社区进行了培训，什么是“while 循环”，为什么要更改名称？）

我认为今天任何不使用像 C 那样的语法的语言都是因为一些基本的范式转变（比如 Python 的缩进方法）。如果您正在制作一种基本以相同方式工作的语言，为什么要更改任何内容？你的目标受众已经可以用他们的小指敲击花括号键了，为什么要让这个特殊的技能一文不值呢？

或者，把最后一句话更进一步，如果你想向编程社区推销你的新的、改变游戏规则的语言（Java、C# 等），你会遇到更少的障碍，如果您的客户都已经知道语法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T11:32:12.777

我认为这只是风格问题，而不是优势问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T11:36:25.417

块结构语言必须以某种方式指定块。Pascal 语言家族的相对不受欢迎似乎表明关键字不是这样做的好方法。另一方面，Python 的流行可能意味着未来更多的语言将单独使用缩进来表示结构——但我希望不会。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T11:57:16.070

确实，当 c 简洁且易于理解时，为什么要发明一种全新的语法。大多数编程都熟悉 c 并且语言本身是用 c 实现的，这也有帮助。这是为什么要尝试改进已经很好用的东西的一个例子。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T13:30:51.633

人们已经习惯了。当它被发明时，*每种*语言都丑陋得要命。那时，C 因吸得少而广受欢迎。（也许是因为比 LISP 更脚踏实地）。

今天，其他语言重用该语法，因为它为程序员所熟悉。

我认为没有比这更多的了。我更喜欢大括号而不是开始/结束（尽管大括号在许多非英语键盘上很痛苦），但是仍然有很多 C 语法的怪癖可以做得更好。C++ 发现返回类型可能更适合*在*参数之后（C++0x 允许这种语法，因为它与 decltype 等其他新特性配合得更好）。

大多数函数式语言已经意识到参数周围的括号通常是不必要的。就此而言，通常也不需要显式键入。但是大多数语言都从 C 继承了这一点，因为“这就是语法”。首先键入，然后键入变量/函数名称。

让我们甚至不要进入可憎的函数指针。*当然，我们可以为它们的*类型找到更优雅的语法。或者尝试 typedef'ing 数组类型。

然后是运营商的古怪选择。为什么不直接使用“and”而不是&&？

C 的语法不好。它完成了这项工作，我们已经习惯了它，它可能会继续存在。但这不是“好”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-16T11:51:52.930

C 风格的语法非常紧凑。根据情况，这是一个缺点或优点。无论如何，这对高级 C 编码人员来说是一个生产力提升。

许多新语言正式宣称继承了 C，例如 C++、C#、Objective-C。

而且，我猜很多语言创造者都有很大的C背景。不管有意与否，他们可能会用他们的新语言复制他们最了解和他们认为最有效的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T11:54:43.737

Afaik C 的流行与 Unix 的流行直接相关，而不是与它的语法有关。这一点有多个方面；它的低级语言（*）和适用于内核开发的精简*强制*库，编译器的可用性，跨系统兼容性的相对早期尝试。

如果我不得不说出第二个原因，那就是相对松散的构建模型（编译单元只在链接器处相遇，只有链接器第一次看到（主要是消化的程序）完成），这对于低内存系统来说非常有用。

人们常说代码密度，但那是后来的修正主义。至于后来采用这种语法的语言，更多的是希望它能让升级路径变得更容易，而不是语法的优越性。这在与 C 相距甚远的 C# 中清晰可见，除了块语法和名称。

(*) 我更多地暗示了许多编译器助手的缺失。如果将 libgcc 的内容降低到 K&R 级别，则或多或少地 IOW 的内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-16T12:53:52.923

> 是否有任何客观原因可以解释这种语法的广泛传播和成功？

不是很客观，但 C 具有三个主要的历史优势：

*   它当时比其他语言更简洁（使用 {} 而不是 Algol 的开始/结束）
*   它没有明显的缺点（例如，Fortran 有歧义，不支持一行中的多个语句）
*   在它流行之后，几乎所有其他语言设计者都知道 C，并且可能使用 C 来构建他们语言的工具集

> 与其他语言的语法相比是否有某些优势？

好吧，具有显式的块和语句分隔符允许多语句表达式；例如，您不能在 Python 中执行多语句 lambda 表达式（不是说您在 C 中拥有 lambda，尽管您在最新的 C++ 中这样做）。只需要为块输入一个字符是一个小优势，但不是一个很大的优势（设置一个编辑器来匹配“开始”到“结束”可能比匹配 C 更容易（“{”或“？？ <") 到 ("}" OR "??>")，如果打字速度是您编程中的限制因素，那么您可能没有自动完成您应该做的任务）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-16T14:06:10.690

至于为什么花括号流行起来......两个原因：

1.  风洞效应。对于任何给定的问题，只有这么多**好的**解决方案，对问题的分析越多，这些问题的解决方案就可能变得越相似。因此，2009 年雪佛兰更像 2008 年福特，而不是 57' 雪佛兰和 '57 福特……新雪佛兰和新福特设计在同一个风洞中。花括号和分号具有简单的工程意义，使得 C 比“块”风格的可比语言更容易解析（对于计算机和人类）......因此 C# 非常类似于 Java，我有时会暂时忘记哪种语言我正在使用。

2.  （如前所述）对于程序员来说，学习一种“看起来和感觉都像”以前模型的新语言要容易得多。不要重新发明轮子，它不会在你身上翻滚;-)

干杯。基思。

PS：我预测，在 50 年内，我们将使用“自然语言”编译器......并深情地回忆起花括号语言的美好时光，当时男人在男人面前，羊在害怕的地方。

# mysql - Mysql 在一个存储过程中有太多的while循环

> ID：872239
> 
> 赞同：0
> 
> 时间：2009-05-16T11:30:47.990
> 
> 标签：mysql, stored-procedures, while-loop, solution

当我在参数中获取逗号分隔值时，我有一个存储过程。我有三个具有逗号分隔值的参数。我需要把它们放在表格的列中，所以我使用 while 循环。但是当太多（比如十万个用户）用户连接到我的网站时，我很害怕，那么我的程序就会出现性能问题。
有人对这个问题有更好的解决方案吗？

提前致谢。
问候，
MySQL DBA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T07:55:22.090

SQL 被解释，即使它被称为“编译”。这意味着，如果您简单地分解数据库外部的字符串并执行多个插入而不是 1 次调用 SQL proc，后者使用解释的 SQL 循环输入，您的代码可能会运行得更快。

# jquery - ajax jquery 混淆

> ID：872250
> 
> 赞同：0
> 
> 时间：2009-05-16T11:36:55.260
> 
> 标签：jquery, ajax, dom

这可能是直截了当的，但我是新手，我需要帮助！如果我发出一个 Ajax 请求，当成功用其他数据替换 DOM 的一部分时，我如何使新数据可供 jQuery 访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T11:40:18.623

数据将在您传递给回调函数的参数中可用

```
$.ajax( {
type:'Get',
url:'http://mysite.com/mywebservice',
sucess:function(data) {
 alert(data);
}

}) 
```

您也可以使用 Ajax 速记来表达`get`

```
$.get('http://mysite.com/mywebservice', function (data) {
 alert(data);
}); 
```

如果您的意思是在将数据注入 DOM 后如何访问数据，那么它将自动访问，因为它成为 DOM 的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T11:40:40.510

在您提供给 ajax 请求的回调函数中，您将可以访问数据。从那里您可以用它替换部分 DOM 和/或将其存储在其他地方（全局变量等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T11:43:00.970

替换区域中的元素当然没有绑定事件处理程序，除非您使用 jquery 1.3 的新 live() 事件。

# python - 如何将python日期格式转换为mysql的10位日期格式？

> ID：872255
> 
> 赞同：0
> 
> 时间：2009-05-16T11:41:22.863
> 
> 标签：python

如何将python日期格式转换为mysql的10位日期格式

示例：python 中的日期 -> 11-05-09

类似于 1239992972（10 位）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T11:46:14.113

您可以使用时间模块的 strptime - 您传入一个字符串时间（例如 11-05-09）和一个格式，它将返回一个 struct_time，您可以从中获取数值（通过在返回的 struct_time 上调用 time.mktime ）。有关更多详细信息，请参阅[文档`time.strptime`](http://docs.python.org/library/time.html#time.strptime)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T11:46:41.307

如果它是一个日期时间 obj，你可以这样做：

```
import time
time.mktime(datetime_obj.timetuple()) 
```

如果不：

```
time.mktime(time.strptime("11-05-09", "%d-%m-%y")) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T11:50:15.853

使用 time.strptime() 将日期转换为时间元组，然后使用 time.mktime()（或 calendar.timegm()）将其转换为浮点时间。之后您可能需要将其截断为整数。

```
tm = time.strptime('11-05-09', '%d-%m-%y')
time = time.mktime(tm)
time_int = int(time) 
```

[http://docs.python.org/library/time.html](http://docs.python.org/library/time.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-09T19:15:39.453

您可以使用[easy_date](https://github.com/ralphavalon/easy_date)来简化：

```
import date_converter
timestamp = date_converter.string_to_timestamp('11-05-09','%d-%m-%y') 
```

# sql - PL/SQL“SQL 命令未正确结束”错误

> ID：872266
> 
> 赞同：2
> 
> 时间：2009-05-16T11:47:33.940
> 
> 标签：sql, plsql, scripting

我目前正在 PL/SQL Developer 中开发一些 SQL 脚本，我得到了：

> SQL 命令未正确结束

我不确定如何解决的错误。

我正在使用的代码看起来像这样

```
CREATE TABLE temp_table as
    SELECT * FROM table_x

INSERT INTO temp_table
    SELECT * FROM table_y 
```

如果我将两个部分（`create table`和`insert`）作为单独的部分执行，一切运行正常，即选择每个代码块并执行。但是，如果我尝试执行所有内容，选择所有代码并执行，我会收到一条错误消息：

> SQL 命令未正确结束

当我处理非常小的表时，我不介意处理这个问题，但是当我有大量操作时，我需要按顺序执行，并且当每个操作需要很长时间才能运行时，我想执行代码和走开。

添加分号会引发一个新错误，这是一个错误：

> 无效字符

这是引发无效字符错误的代码。

```
CREATE TABLE temp_table as 
    SELECT * FROM table_x where x > 1; 

INSERT INTO temp_table 
    ( 
    SELECT * FROM table_y where x > 1; 
    ) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T11:49:57.727

在每条语句的末尾放置一个分号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T07:13:24.750

尝试这个：

```
CREATE TABLE temp_table as
SELECT * FROM table_x;

INSERT INTO temp_table
SELECT * FROM table_y; 
```

我认为括号把你弄乱了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T12:53:33.840

括号可用于指定要插入数据的列，如下所示：

插入到 temp_table (col1,col2,...coln) 选择 ...

你得到一个错误，因为解析器在括号之间找到了一个选择表达式，而不是列列表

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T05:54:10.383

如果您在 PL/SQL Developer 中一步一步运行脚本，您可能需要将其转换为“SQL*Plus”脚本 - 即需要分号来分隔语句，然后需要 /（正斜杠）运行语句，例如：

```
CREATE TABLE temp_table as 
    SELECT * FROM table_x where x > 1;
/

INSERT INTO temp_table 
    SELECT * FROM table_y where x > 1;
/ 
```

# javascript - jQuery复选框操作

> ID：872268
> 
> 赞同：2
> 
> 时间：2009-05-16T11:48:14.717
> 
> 标签：javascript, jquery

使用 jQuery，我该如何：

1.  `on`是否已选中页面上的所有复选框`off`？

2.  循环浏览页面上所有被选中的复选框。即这样的东西

    ```
    $(sel-cboxes).each(myFunction); 
    ```

所以`myFunction`会在每个选中的复选框上调用。

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T11:55:17.963

1：选中所有复选框

```
$("input:checkbox").attr('checked', true); 
```

取消选中所有

```
$("input:checkbox").attr('checked', false); 
```

2：

```
$("input:checkbox:checked").each(myFunction); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T11:53:21.570

> 1-是否打开或关闭页面上的所有复选框？
> 编辑：（更正）

```
$(':checkbox').attr('checked',true); 
```

> 2-循环浏览页面上被选中的所有复选框。即这样的东西

```
$(':checkbox :checked').each(function() {

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T11:54:39.257

这个[jQuery 选择器](http://docs.jquery.com/Selectors)将找到所有已选中的复选框。并且`this`在每个功能内部都将分配给这个单独的复选框。

```
$(":checkbox:checked").each(function(){
  doSomething(this);
}) 
```

如果要打开所有复选框，请`on`使用以下命令：

```
$(":checkbox").attr("checked","checked") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T11:53:28.170

`$("input:checked")`

[http://docs.jquery.com/Selectors/checked](http://docs.jquery.com/Selectors/checked)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T11:58:41.590

1：将所有设置为同一类，然后

```
$(.classname).attr('checked', true); 
```

# java - 如何在 java.util.Properties 中引用另一个属性？

> ID：872272
> 
> 赞同：61
> 
> 时间：2009-05-16T11:50:30.703
> 
> 标签：java, properties

Java属性文件可以引用其他属性文件吗？

```
## define a default directory for Input files  
dir.default=/home/data/in/

dir.proj1=${dir.default}p1
dir.proj2=${dir.default}p2
dir.proj3=${dir.default}p3 
```

这可能吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-11-07T00:05:20.633

Chris Mair 的[XProperties](https://github.com/MideO/CucumberJVM/blob/master/src/tests/cukes/stepdefinitions/config/XProperties.java)类可能是一个很好的起点。

> 您可以在属性值的任何位置替换一个常量，甚至可以在一个值中包含多个常量，如下例所示：

```
CONST_1 = shoes and ships
CONST_2 = sealing wax
SomeValue = {CONST_1} and {CONST_2} 
```

> 在此示例中，“SomeValue”属性的计算结果为“鞋子、船舶和密封蜡”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-11-06T23:54:53.497

[Eproperties 是一个开源项目](http://code.google.com/p/eproperties/) ，它提供变量替换以及其他一些功能——尽管替换可能是最有用的。它是 java.util.Properties 的子类，可以被任何其他可以将配置信息作为属性的类使用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-16T12:19:14.660

标准属性文件只是键值对。在文本格式中，`Properties`只是将 key 与 value 分开并做一些简单的事情，例如允许转义字符。您可能能够在详细的 XML 语法中定义实体。

如果您想要自己的替换语法，那么您可以像处理任何其他字符串一样操作返回值。或者，您可以编写自己的版本`Properties`或在生成文件时进行替换。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-16T12:14:23.627

java.util.Properties 类不会为您执行此操作。继承属性，重写 load() 方法并自己进行替换不会太难。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-02-18T00:09:42.570

Commons Config 库也可以做到这一点。[http://commons.apache.org/configuration/userguide/overview.html#Using_Configuration](http://commons.apache.org/configuration/userguide/overview.html#Using_Configuration)

然而，正如已经指出的，看看 EProperties 库；[http://code.google.com/p/eproperties/](http://code.google.com/p/eproperties/)

它支持许多简洁的特性（如替换、嵌套、列表），包括包含、扩展 Java 属性，并且比 Commons Config 更轻量级（它还允许您使用 include 语法包含属性）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-12-31T17:21:59.487

由于 eproperties 有点不维护，并且 commons 配置依赖于日志记录（具有讽刺意味的是，这意味着您不能使用它来配置日志记录）我使用这个只需要`commons-lang(3)`加载插值属性的代码片段：

```
@SuppressWarnings("serial")
public static Map<String,String> loadPropertiesMap(InputStream s) throws IOException {
    final Map<String, String> ordered = new LinkedHashMap<String, String>();
    //Hack to use properties class to parse but our map for preserved order
    Properties bp = new Properties() {
        @Override
        public synchronized Object put(Object key, Object value) {
            ordered.put((String)key, (String)value);
            return super.put(key, value);
        }
    };
    bp.load(s);
    final Map<String,String> resolved = new LinkedHashMap<String, String>(ordered.size());
    StrSubstitutor sub = new StrSubstitutor(new StrLookup<String>() {
        @Override
        public String lookup(String key) {
            String value = resolved.get(key);
            if (value == null)
                return System.getProperty(key);
            return value;
        }
    });
    for (String k : ordered.keySet()) {
        String value = sub.replace(ordered.get(k));
        resolved.put(k, value);
    }
    return resolved;
} 
```

**输入**：

```
blah=${user.dir}
one=1
two=2
five=5
fifteen=${one}${five}
twoonefive=${two}${fifteen}
six=6 
```

**输出**：

```
blah=/current/working/dir
one=1
two=2
five=5
fifteen=15
twoonefive=215
six=6 
```

显然，如果需要，您可以将`Map<String,String>`背面转换为对象。`Properties`我根据先前声明的属性和系统属性进行解析，但您显然可以在`StrSubstitutor.lookup`.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-12-15T09:14:42.907

配置文件由格式为`key=value`或的语句组成`key:value`。它们是键值可以引用另一个键值的可能方式。**开始“${”**和结束**“}”**之间的字符串被解释为键。替换变量的值可以定义为系统属性或配置文件本身。

因为**`Properties`**继承自**`Hashtable`**，所以`put`and`putAll`方法可以应用于`Properties object`.

```
Map<String, String> map = new LinkedHashMap<String, String>();
map.put("key", "vlaue");
Properties props = new Properties();
props.putAll( map ); 
```

详细阐述**@Adam Gent**的帖子。[`commons-text-1.1.jar`](https://mvnrepository.com/artifact/org.apache.commons/commons-text/1.1)

```
import org.apache.commons.text.StrLookup;
import org.apache.commons.text.StrSubstitutor;

public class Properties_With_ReferedKeys {
    public static void main(String[] args) {

        ClassLoader classLoader = Properties_With_ReferedKeys.class.getClassLoader();

        String propertiesFilename = "keys_ReferedKeys.properties";
        Properties props = getMappedProperties(classLoader, propertiesFilename);

        System.out.println( props.getProperty("jdk") );

    }

    public static Properties getMappedProperties( ClassLoader classLoader, String configFilename ) {
        Properties fileProperties = new Properties();

        try {
            InputStream resourceAsStream = classLoader.getResourceAsStream( configFilename );

            Map<String, String> loadPropertiesMap = loadPropertiesMap( resourceAsStream );
            Set<String> keySet = loadPropertiesMap.keySet();
            System.out.println("Provided 'Key':'Value' pairs are...");
            for (String key : keySet) {
                System.out.println( key + " : " + loadPropertiesMap.get(key) );
            }

            fileProperties.putAll( loadPropertiesMap );
        } catch ( IOException e ) {
            e.printStackTrace();
        }

        return fileProperties;
    }
    public static Map<String,String> loadPropertiesMap( InputStream inputStream ) throws IOException {
        final Map<String, String> unResolvedProps = new LinkedHashMap<String, String>();

        /*Reads a property list (key and element pairs) from the input byte stream. 
         * The input stream is in a simple line-oriented format.
         */
        @SuppressWarnings("serial")
        Properties props = new Properties() {
            @Override
            public synchronized Object put(Object key, Object value) {
                unResolvedProps.put( (String)key, (String)value );
                return super.put( key, value );
            }
        };
        props.load( inputStream );

        final Map<String,String> resolvedProps = new LinkedHashMap<String, String>( unResolvedProps.size() );

        // Substitutes variables within a string by values.
        StrSubstitutor sub = new StrSubstitutor( new StrLookup<String>() {
            @Override
            public String lookup( String key ) {

                /*The value of the key is first searched in the configuration file,
                 * and if not found there, it is then searched in the system properties.*/
                String value = resolvedProps.get( key );

                if (value == null)
                    return System.getProperty( key );

                return value;
            }
        } );

        for ( String key : unResolvedProps.keySet() ) {

            /*Replaces all the occurrences of variables with their matching values from the resolver using the given 
             * source string as a template. By using the default ${} the corresponding value replaces the ${variableName} sequence.*/
            String value = sub.replace( unResolvedProps.get( key ) );
            resolvedProps.put( key, value );
        }
        return resolvedProps;
    }
} 
```

> 配置文件 « 如果您希望参考被忽略并且不会被替换，那么您可以使用以下格式。
> 
> ```
>  $${${name}} must be used for output ${ Yash }.  EX: jdk = ${jre-1.8} 
> ```

文件：`keys_ReferedKeys.properties`

```
# MySQL Key for each developer for their local machine
dbIP       = 127.0.0.1
dbName     = myApplicationDB
dbUser     = scott
dbPassword = tiger

# MySQL Properties 
# To replace fixed-keys with corresponding build environment values. like « predev,testing,preprd.
config.db.driverClassName : com.mysql.jdbc.Driver
config.db.url             : jdbc:mysql://${dbIP}:3306/${dbName}
config.db.username        : ${dbUser}
config.db.password        : ${dbPassword}

# SystemProperties
userDir      = ${user.dir}
os.name      = ${os.name}
java.version = ${java.version}
java.specification.version = ${java.specification.version}

# If you want reference to be ignored and won't be replaced.
# $${${name}} must be used for output ${ Yash }.  EX: jdk = ${jre-1.8}
jdk = $${jre-${java.specification.version}} 
```

* * *

Java 属性（键=值）格式示例[log4j.properties](https://stackoverflow.com/a/47789493/5081877)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-01-15T12:33:17.837

在这种特殊情况下（以及[其他](https://stackoverflow.com/questions/8869482/using-properties-within-the-properties-file/8869540#8869540)情况下），您最好通过定义不同的属性来解决重复问题：

1.  改变：`dir.proj1=dir.default /p1`变成`dir.proj1_extension=/p1`
2.  prepend：`dir.default`在`dir.proj1_extension`应用程序代码中获取 proj1 的完整位置。

对其他项目做同样的事情。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-01-19T09:12:46.230

一个“纯”Java 实现：

```
 static final Pattern PATTERN = Pattern.compile("\\$\\{([^}]+)}");

    private static void macro(final Properties properties)
    {
        properties.replaceAll((k, v) -> PATTERN.matcher((String) v).replaceAll(mr -> properties.getProperty(mr.group(1), mr.group(0)).replace("$", "\\$")));
    } 
```

可以将其合并到一个简单的属性子类中，如下所示：

```
 import java.io.IOException;
import java.io.InputStream;
import java.io.Reader;
import java.util.Properties;
import java.util.regex.Pattern;

public class MacroProperties extends Properties
{
    static final Pattern PATTERN = Pattern.compile("\\$\\{([^}]+)}", 0);

    @Override
    public synchronized void load(final Reader reader) throws IOException
    {
        super.load(reader);
        macro(this);
    }

    @Override
    public synchronized void load(final InputStream inStream) throws IOException
    {
        super.load(inStream);
        macro(this);
    }

    private static void macro(final Properties properties)
    {
        properties.replaceAll((k, v) -> PATTERN.matcher((String) v).replaceAll(mr -> properties.getProperty(mr.group(1), mr.group(0)).replace("$", "\\$")));
    }
} 
```

* * *

它是如何工作的？

`PATTERN`是一个匹配简单`${foo}`模式的正则表达式，并将大括号之间的文本捕获为一个组。

`Properties.replaceAll`应用一个函数来用函数的结果替换每个值。

`Matcher.replaceAll`应用一个函数来替换`PATTERN`.

我们对该函数的实现在属性中查找匹配组 1 或默认匹配（即实际上不进行替换）。

`Matcher.replaceAll`还解释了寻找组引用的替换字符串，因此我们还需要使用`String.replace`反斜杠转义`$`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-07-04T10:26:37.440

我真的不喜欢给定的解决方案。EProperties 未维护，并且在 Maven Central 中不可用。Commons Config 太大了。commons-lang 中的 StrSubstitutor 已弃用。

我的解决方案只依赖于普通文本：

```
public static Properties interpolateProperties(Properties rawProperties) {
    Properties newProperties = new Properties();
    interpolateProperties(rawProperties, newProperties);
    return newProperties;
}

public static void interpolateProperties(Properties rawProperties, Properties dstProperties) {
    StringSubstitutor sub = new StringSubstitutor((Map)rawProperties);
    for (Map.Entry<Object, Object> e : rawProperties.entrySet()) {
        dstProperties.put(e.getKey(), sub.replace(e.getValue()));
    }
} 
```

IE：

```
Properties props = new Properties();
props.put("another_name", "lqbweb");
props.put("car", "this is a car from ${name}");
props.put("name", "${another_name}");
System.out.println(interpolateProperties(props)); 
```

打印出来：

> {car=this is a car from ruben, name=ruben, another_name=ruben}

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-08-11T15:37:02.640

下面是 Java 中的代码片段，用于读取引用其他属性的属性。具体来说，这些是可重用的查询，但也可以是其他东西。

```
LinkedHashMap<String, String> sqlsRaw = loadPropertiesFromFile();
LinkedHashMap<String, String> sqls = new LinkedHashMap<>();
StrSubstitutor substitutor = new StrSubstitutor(sqls);

for (Map.Entry<String, String> entry : sqlsRaw.entrySet()) {
    String sql = entry.getValue();
    try {
        sql = substitutor.replace(sql);
    } catch (Exception e) {
        throw new RuntimeException("Found an sql with a non replaced reference to another. Please validate that the required key was defined before this sql: " + entry.getValue(), e);
    }
    sqls.put(entry.getKey(), sql);
} 
```

示例属性：

```
key1=value1
key21=value2 ${key1} 
```

运行此之后，`key21`将具有值`value2 value1`。

* 使用 apache 的`StrSubstitutor`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-05-15T23:15:07.123

我喜欢上述解决方案的想法，但我真的想要一些东西来代替 Properties。下面的课程建立在上面的那些想法之上。它仍然使用 Apache Commons-text StringSubstitutor，并在 Properties 类、Java 系统定义或系统的 Env 中查找键。这个类扩展了 Properties 并覆盖了 getProperty(...) 方法，所以它是一个替代品。您可以使用“lookup()”方法获取原始键的值，但它会从这 3 个位置之一返回一个值。如果要确定属性中是否存在键，请使用 Map 的底层 get()。

Apache commons 依赖：

```
 <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-text</artifactId>
            <version>1.3</version>
        </dependency> 
```

类源。

```
import java.util.Properties;
import org.apache.commons.text.StringSubstitutor;
import org.apache.commons.text.lookup.StringLookup;

/**
 * This extends Properties to provide macros substitution and includes getting properties from
 *     the Java System properties or the System's Environment.  This could be used to consolidate
 *     getting a system variable regardless if it is defined in the Java system or in the System's
 *     environment, without any other actual properties.
 *
 * The macro substitution is recursive so that given the following properties:
    <code>
      myProg=Program1
      outDir=./target
      inputs'./data/${defman }Templates
      outputs=${outDir}/${myProg}
      log=${outDir}/${myProg}/build_report.txt
      homeLog=${HOMEDRIVE}/${log}
    </code>
 * And assuming the environment variable HOMEDRIVE=C:
 * the getProperties("homeLog") would result in:  C:/./target/Program1/build_report.txt
 * 
 * Although based on the article below, this version substitutes during the getProperty() functions
 * instead of the loading functions explained in the article.
 * 
 * Based on this article: 
 *     https://stackoverflow.com/questions/872272/how-to-reference-another-property-in-java-util-properties
 *
 * @author Tim Gallagher
 * @license - You are free to use, alter etc. for any reason
 */
public class MacroProperties extends Properties implements StringLookup {

  // Substitutes variables within a string by values.
  public final StringSubstitutor macroSubstiitutor;

  public MacroProperties() {
    this.macroSubstiitutor = new StringSubstitutor(this);
  }

  public MacroProperties(Properties prprts) {
    super(prprts);
    this.macroSubstiitutor = new StringSubstitutor(this);
  }

  /**
   * The value of the key is first searched in the properties, and if not found there, it is then
   * searched in the system properties, and if still not found, then it is search in the 
   * system Env.
   *
   * @param key non-null string.
   * @return may be null.
   */
  @Override
  public String lookup(String key) {
    // get the Property first - this must look up in the parent class
    // or we'll get into an endless loop
    String value = super.getProperty(key);
    if (value == null) {      
      // if not found, get the Java system property which may have been defined on the 
      // Java command line with '-D...'
      value = System.getProperty(key);

      if (value == null) {
        // if not found, get the System's environment variable.
        value = System.getenv(key);
      }
    }

    return value;
  }

  @Override
  public String getProperty(String key, String defaultValue) {
    /*
       * Replaces all the occurrences of variables with their matching values from the resolver 
       * using the given source string as a template. By using the default ${} the corresponding
       * value replaces the ${variableName} sequence.
     */
    String value = lookup(key);
    if (value != null) {
      value = macroSubstiitutor.replace(value);
    } else {
      value = defaultValue;
    }
    return value;
  }

  @Override
  public String getProperty(String key) {
    return getProperty(key, null);
  }
} 
```

# database - 如何使用 c# 防止 Access 数据库中的重复条目？

> ID：872289
> 
> 赞同：-1
> 
> 时间：2009-05-16T12:01:31.147
> 
> 标签：database, ms-access

我有一个 MS Access 表，其中包含一列和多行。保存到此表的文本框的值。我想防止提交重复的条目。例如，如果我在文本框中键入“ankush”并且该条目已经存在于表中，那么我想显示一个 msgbox 说明它已经存在于表中。使用 c#

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T12:07:37.683

如果该字段不是您的主键字段，您可以在包含“ankush”的字段上设置索引并使该索引唯一

```
[Index=Yes(no duplicates)] 
```

那么 Jet DB 引擎将不允许插入并显示默认消息。

我正在使用旧版本的 Access，因此您的里程可能会有所不同，但要显示自定义错误消息，您必须首先查询表中的值，如下所示：

```
SELECT COUNT(MyField)as violated FROM MyTable WHERE MyField = 'input value here' 
```

如果违反> 0，则在您的代码中分支以显示您的消息框。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T12:03:55.837

您可以在列上创建唯一键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T09:47:04.257

只是为了补充@Gary.Ray 的建议：如果您的表有多个候选键（“如果该字段不是您的主键......”）那么 ACE/Jet 引擎返回的失败消息无济于事并不会告诉您哪个密钥被违反：

> 您对表请求的更改不成功，因为它们会在索引、主键或关系中创建重复值。更改包含重复数据的一个或多个字段中的数据，删除索引，或重新定义索引以允许重复条目，然后重试。

令人高兴的是，实现键的方法不止一种，使用`CHECK`约束的优点是在失败消息中返回约束的名称。例如，此`CHECK`约束将防止列“MyField”的重复：

```
ALTER TABLE MyTable ADD
   CONSTRAINT MyTable__MyField__no_dups_allowed 
      CHECK (NOT EXISTS (
                         SELECT T1.MyField 
                           FROM MyTable AS T1
                          GROUP
                             BY T1.MyField 
                         HAVING COUNT(*) > 1
                        )); 
```

对于未通过“MyField”但会满足表中其他键的数据，失败消息将是：

> `MyTable__MyField__no_dups_allowed`为“ ”设置的验证规则“ ”禁止一个或多个值`MyTable`。输入此字段的表达式可以接受的值。

然后，您可以在 C# 前端捕获错误并解析已知约束名称的错误消息，以提供更有意义的消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T03:19:00.910

问题的焦点完全改变了，答案已经过时了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-17T13:37:33.820

```
If [field name] = Me. field name in the form.Column(0) And Not Me.NewRecord Then
Me.field name in the form.Undo
Me.Undo
Exit Sub
End If

If [field name] = Me. field name in the form.Column(0) And Me.NewRecord Then
Me.field name in the form.Undo
Me.Undo
MsgBox " already there", vbInformation, "repeated"
Exit Sub
End If 
```

# python - 查找大列表是否包含特定字符串的最有效方法（Python）

> ID：872290
> 
> 赞同：11
> 
> 时间：2009-05-16T12:01:37.463
> 
> 标签：python, string

我有一个包含大约所有英语单词的文件（~60k 单词，~500k 个字符）。我想测试我收到的某个词作为输入是否是“英语”（即，如果这个确切的词在列表中）。

在 Python 中执行此操作的最有效方法是什么？

简单的解决方案是将文件加载到列表中并检查单词是否在该列表中。列表可以排序，我相信这会将复杂度降低到 O(logn)。但是，我不确定 Python 如何实现通过列表进行搜索，以及如果内存中有这么大的列表是否会降低性能。我可以“滥用”我可以限制单词长度的事实吗？（例如说最长的是 15 个字符）。

请注意，我在具有大量内存的机器上运行应用程序，因此我更关心内存消耗而不是速度和 CPU 利用率。

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-16T12:05:17.703

python [Set](http://docs.python.org/library/stdtypes.html#set-types-set-frozenset)是您应该尝试的。

> 集合对象是不同的可散列对象的无序集合。常见用途包括**成员资格测试**、从序列中删除重复项以及计算数学运算，例如交集、并集、差分和对称差分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T12:05:58.263

[Trie](http://en.wikipedia.org/wiki/Trie)结构将适合您的目的。毫无疑问，在那里可以找到 Python 实现......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T12:12:37.203

示例 Python 代码：

```
L = ['foo', 'bar', 'baz'] # Your list
s = set(L)  # Converted to Set

print 'foo'  in s # True
print 'blah' in s # False 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T12:04:42.573

你基本上是在测试一个成员是否在一个集合中，对吧？

如果是这样，并且因为您说您有很多内存，为什么不将所有单词作为键加载到 memcache 中，然后对于每个单词，只需检查它是否存在于 memcache 中。

或者使用 bash 使用的数据结构来自动完成命令名称 - 这在内存中快速且高效（不记得名称）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T12:06:27.217

500k 个字符不是一个大列表。如果您的列表中的项目是唯一的并且您需要重复使用此搜索[`set`](http://docs.python.org/library/stdtypes.html#set-types-set-frozenset)，这将`O(1)`在最好的情况下降低复杂性。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T12:34:01.160

两件事情：

Python 'mutable set' 类型有一个 'add' 方法（ s.add(item) ），因此您可以直接从大文件中读取（一行）直接进入一个集合，而无需使用列表作为中间数据结构.

Python 允许您“腌制”数据结构，因此您可以将大集合保存到文件中并节省重新启动集合的时间。

其次，为了自娱自乐，我一直在寻找所有单音节英语单词的列表，但我发现提到的那些似乎是专有的。如果不打扰，请问你的英文单词表是否可以被别人获取？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-16T13:59:46.710

其他人使用 set() 为您提供了内存中的方式，这通常是最快的方式，并且不应该为 60k 字的数据集（最多几个 MiB）占用您的内存。您应该能够使用以下方法构建您的集合：

```
f=open('words.txt')
s = set(word.strip() for word in f) 
```

但是，将集合加载到内存中确实需要一些时间。如果您要检查很多单词，这没问题 - 查找时间足以弥补它。但是，如果您每次执行命令时只检查一个单词（例如，这是一个类似 "checkenglish [word]" 的命令行应用程序），则启动时间将比您仅搜索文件行所花费的时间长按行。

如果这是您的情况，或者您有更大的数据集，则使用磁盘格式可能会更好。最简单的方法是使用[dbm](http://docs.python.org/library/dbm.html)模块。从单词列表创建这样一个数据库：

```
import dbm
f=open('wordlist.txt')
db = dbm.open('words.db','c')
for word in f:
    db[word] = '1'
f.close()
db.close() 
```

然后您的程序可以通过以下方式检查成员资格：

```
db = dbm.open('words.db','r')
if db.has_key(word):
    print "%s is english" % word
else:
    print "%s is not english" % word 
```

这将比设置查找慢，因为会有磁盘访问，但会比搜索快，内存使用量低并且没有显着的初始化时间。

还有其他选择，例如使用 SQL 数据库（例如 sqlite）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-16T12:06:07.343

如果内存消耗不是问题并且单词不会改变，那么最快的方法是将所有内容放在哈希中并以这种方式搜索。在 Python 中，这是[**`Set`**](http://www.python.org/doc/2.5.2/tut/node7.html#SECTION007400000000000000000). 您将进行恒定时间查找。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-16T13:01:05.183

仅当您对数据重复运行这种查询时，将列表转换为集合才会有帮助，对列表进行排序和进行二分搜索也是如此。如果您只想将数据从列表中提取一次，那么最好的选择是简单的旧线性搜索：

```
if 'foo' in some_list:
    do_something() 
```

否则，您最好的选择是使用前面提到的集合或二分搜索。您应该选择哪一个在很大程度上取决于数据有多大以及您可以腾出多少内存。有人告诉我，真正大的列表往往会从散列中受益更多，尽管占用的内存量可能非常昂贵。

最后，第三种选择是您可以将数据导入 sqlite 数据库并直接从中读取。Sqlite 非常快，它可以省去从文件中加载*整个*列表的麻烦。Python 有一个非常好的内置[sqlite 库](http://docs.python.org/library/sqlite3.html)。

# javascript - 如何获取页面上所有选中复选框的计数

> ID：872296
> 
> 赞同：35
> 
> 时间：2009-05-16T12:05:07.313
> 
> 标签：javascript, jquery

我想计算用户选择了多少复选框。例如，从一组 10 个复选框中，如果他选择了 5 个，那么我希望能够数出它。使用该行：

```
$(":checkbox:checked") 
```

我可以选择所有选中的复选框，有没有办法获取该语句返回的所有元素的计数？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-05-16T12:08:25.293

使用[size()](http://docs.jquery.com/Core/size)方法或[长度](http://docs.jquery.com/Core/length)属性。长度属性是首选，因为它更快。

例子：

```
var count = $("[type='checkbox']:checked").length; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-16T11:06:17.957

使用 jQuery：

```
var cbs = $("input:checkbox"); //find all checkboxes
var nbCbs = cbs.length; //the number of checkboxes

var checked = $("input[@type=checkbox]:checked"); //find all checked checkboxes + radio buttons
var nbChecked = checked.length; 
```

使用 JavaScript：

```
var inputs = document.getElementsByTagName("input"); //or document.forms[0].elements;
var cbs = []; //will contain all checkboxes
var checked = []; //will contain all checked checkboxes
for (var i = 0; i < inputs.length; i++) {
  if (inputs[i].type == "checkbox") {
    cbs.push(inputs[i]);
    if (inputs[i].checked) {
      checked.push(inputs[i]);
    }
  }
}
var nbCbs = cbs.length; //number of checkboxes
var nbChecked = checked.length; //number of checked checkboxes 
```

来源：[如何找到复选框？在coderanch](http://www.coderanch.com/t/120677/HTML-CSS-JavaScript/find-Checkboxes)

# visual-studio - 为什么 Visual Studio 生成的 GUID 中的第 14 个字符有时是小写的

> ID：872298
> 
> 赞同：4
> 
> 时间：2009-05-16T12:05:36.487
> 
> 标签：visual-studio, guid

有时，当我使用 Visual Studio 生成 GUID 时，第 14 个十六进制字符是小写的，而其余的十六进制数字是大写的。

在比较两个 GUID 的字符串表示时会引起一些问题。现在我总是比较二进制等价物是安全的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-16T12:09:48.753

是的，这是一个[**已知的错误**](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=361975)。但是您不应该进行字符串比较；改为使用 [**`Guid.Equals`**](http://msdn.microsoft.com/en-us/library/system.guid.equals(VS.71).aspx)。

# javascript - Javascript交换数组元素

> ID：872310
> 
> 赞同：290
> 
> 时间：2009-05-16T12:10:28.470
> 
> 标签：javascript, arrays

有没有更简单的方法来交换数组中的两个元素？

```
var a = list[x], b = list[y];
list[y] = a;
list[x] = b; 
```

* * *

## 回答 #1

> 赞同：585
> 
> 时间：2009-05-16T12:14:16.560

您只需要一个临时变量。

```
var b = list[y];
list[y] = list[x];
list[x] = b; 
```

* * *

**10 年后，随着我们大量采用 ES6，**编辑劫持最佳答案：****

 **给定数组`arr = [1,2,3,4]`，您现在可以在一行中交换值，如下所示：

```
[arr[0], arr[1]] = [arr[1], arr[0]]; 
```

这将产生数组`[2,1,3,4]`。这是[解构赋值](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)。

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2009-05-16T13:41:39.970

如果您想要一个使用本机 javascript 的单个表达式，请记住拼接操作的返回值包含已删除的元素。

```
var A = [1, 2, 3, 4, 5, 6, 7, 8, 9], x= 0, y= 1;
A[x] = A.splice(y, 1, A[x])[0];
alert(A); // alerts "2,1,3,4,5,6,7,8,9" 
```

*编辑：*

在表达式的`[0]`末尾是必需的，因为它`Array.splice()`返回一个数组，在这种情况下，我们需要返回数组中的单个元素。

* * *

## 回答 #3

> 赞同：82
> 
> 时间：2009-05-16T13:25:49.990

这似乎没问题....

```
var b = list[y];
list[y] = list[x];
list[x] = b; 
```

但是使用

```
var b = list[y]; 
```

意味着 a **b**变量将存在于范围的其余部分。这可能会导致内存泄漏。不太可能，但还是最好避免。

将其放入 Array.prototype.swap 可能是个好主意

```
Array.prototype.swap = function (x,y) {
  var b = this[x];
  this[x] = this[y];
  this[y] = b;
  return this;
} 
```

可以这样称呼：

```
list.swap( x, y ) 
```

这是一种**避免内存泄漏**和[**DRY**](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)的干净方法。

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2013-02-14T18:30:12.207

根据[Metafilter 上一些随机的人的说法](http://ask.metafilter.com/170451/How-do-I-swap-two-variables-with-a-function-in-Javascript#2452701)，“最新版本的 Javascript 允许您更整洁地进行交换（除其他外）：”

```
[ list[x], list[y] ] = [ list[y], list[x] ]; 
```

我的快速测试表明，这个[Pythonic 代码](https://stackoverflow.com/questions/4554130/fastest-way-to-swap-elements-in-python-list)在“Google Apps Script”（“.gs”）中当前使用的 JavaScript 版本中运行良好。唉，进一步的测试表明此代码给出了“未捕获的 ReferenceError：分配中的左侧无效”。在 Google Chrome 版本 24.0.1312.57 m 使用的任何版本的 JavaScript（“.js”）中。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2009-05-16T12:14:38.493

好吧，您不需要缓冲*两个*值 - 只有一个：

```
var tmp = list[x];
list[x] = list[y];
list[y] = tmp; 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2014-02-26T21:17:17.370

您可以通过以下方式交换数组中的元素：

```
list[x] = [list[y],list[y]=list[x]][0] 
```

请参见以下示例：

```
list = [1,2,3,4,5]
list[1] = [list[3],list[3]=list[1]][0]
//list is now [1,4,3,2,5] 
```

注意：它对常规变量的工作方式相同

```
var a=1,b=5;
a = [b,b=a][0] 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2017-03-10T01:41:34.740

提问的时候这个是不存在的，但是 ES2015 引入了数组解构，可以这样写：

```
let a = 1, b = 2;
// a: 1, b: 2
[a, b] = [b, a];
// a: 2, b: 1 
```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2009-05-16T12:31:34.270

使用数值，您可以使用按位异或来避免临时变量

```
list[x] = list[x] ^ list[y];
list[y] = list[y] ^ list[x];
list[x] = list[x] ^ list[y]; 
```

或算术和（请注意，这仅在 x + y 小于数据类型的最大值时才有效）

```
list[x] = list[x] + list[y];
list[y] = list[x] - list[y];
list[x] = list[x] - list[y]; 
```

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2012-12-09T07:51:34.923

交换数组的两个连续元素

```
array.splice(IndexToSwap,2,array[IndexToSwap+1],array[IndexToSwap]); 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2018-09-07T14:53:31.110

考虑这样一个不需要定义第三个变量的解决方案：

```
function swap(arr, from, to) {
  arr.splice(from, 1, arr.splice(to, 1, arr[from])[0]);
}

var letters = ["a", "b", "c", "d", "e", "f"];

swap(letters, 1, 4);

console.log(letters); // ["a", "e", "c", "d", "b", "f"]
```

注意：您可能需要添加额外的检查，例如数组长度。这个解决方案是**可变**的，所以`swap`函数不需要返回一个新数组，它只是对传入的数组进行突变。

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2018-01-04T08:51:18.963

[Destructuring_assignment](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Swapping_variables)怎么样

```
var arr = [1, 2, 3, 4]
[arr[index1], arr[index2]] = [arr[index2], arr[index1]] 
```

这也可以扩展到

```
[src order elements] => [dest order elements] 
```

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2017-04-24T01:12:02.633

### 对于两个或更多元素（固定数量）

```
[list[y], list[x]] = [list[x], list[y]]; 
```

不需要临时变量！

我正在考虑简单地调用`list.reverse()`.
但后来我意识到它只会在`list.length = x + y + 1`.

### 对于可变数量的元素

为此，我研究了各种现代 Javascript 结构，包括[Map](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Map)和[map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map)，但遗憾的是，没有一个代码比这种老式的、基于循环的结构更紧凑或更快：

```
function multiswap(arr,i0,i1) {/* argument immutable if string */
    if (arr.split) return multiswap(arr.split(""), i0, i1).join("");
    var diff = [];
    for (let i in i0) diff[i0[i]] = arr[i1[i]];
    return Object.assign(arr,diff);
}

Example:
    var alphabet = "abcdefghijklmnopqrstuvwxyz";
    var [x,y,z] = [14,6,15];
    var output = document.getElementsByTagName("code");
    output[0].innerHTML = alphabet;
    output[1].innerHTML = multiswap(alphabet, [0,25], [25,0]);
    output[2].innerHTML = multiswap(alphabet, [0,25,z,1,y,x], [25,0,x,y,z,3]);
```

```
<table>
    <tr><td>Input:</td>                        <td><code></code></td></tr>
    <tr><td>Swap two elements:</td>            <td><code></code></td></tr>
    <tr><td>Swap multiple elements:&nbsp;</td> <td><code></code></td></tr>
</table>
```

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2011-03-08T14:14:04.300

摘自[http://www.greywyvern.com/?post=265](http://www.greywyvern.com/?post=265)

```
var a = 5, b = 9;    
b = (a += b -= a) - b;    
alert([a, b]); // alerts "9, 5" 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2013-12-16T00:47:09.183

您可以使用如下简单的标识函数交换任意数量的对象或文字，甚至是不同类型的对象或文字：

```
var swap = function (x){return x};
b = swap(a, a=b);
c = swap(a, a=b, b=c); 
```

对于您的问题：

```
var swap = function (x){return x};
list[y]  = swap(list[x], list[x]=list[y]); 
```

这在 JavaScript 中有效，因为它接受额外的参数，即使它们没有被声明或使用。赋值`a=b`等发生在`a`传递给函数之后。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2014-02-18T10:18:51.400

有一种有趣的交换方式：

```
var a = 1;
var b = 2;
[a,b] = [b,a]; 
```

（ES6方式）

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-09-09T15:31:44.643

这是一个不会发生变异的单行代码`list`：

`let newList = Object.assign([], list, {[x]: list[y], [y]: list[x]})`

（使用问题发布时 2009 年不可用的语言功能！）

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2011-06-17T23:33:37.420

```
var a = [1,2,3,4,5], b=a.length;

for (var i=0; i<b; i++) {
    a.unshift(a.splice(1+i,1).shift());
}
a.shift();
//a = [5,4,3,2,1]; 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2013-03-16T04:30:03.667

这是一个紧凑版本，将 i1 处的值与 arr 中的 i2 交换

```
arr.slice(0,i1).concat(arr[i2],arr.slice(i1+1,i2),arr[i1],arr.slice(i2+1)) 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2019-08-07T10:24:45.590

```
var arr = [1, 2];
arr.splice(0, 2, arr[1], arr[0]);
console.log(arr); //[2, 1]
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2020-09-04T22:12:17.587

# 流动

不就地解决方案

```
let swap= (arr,i,j)=> arr.map((e,k)=> k-i ? (k-j ? e : arr[i]) : arr[j]); 
```

```
let swap= (arr,i,j)=> arr.map((e,k)=> k-i ? (k-j ? e : arr[i]) : arr[j]);

// test index: 3<->5 (= 'f'<->'d')
let a= ["a","b","c","d","e","f","g"];
let b= swap(a,3,5);

console.log(a,"\n", b);
console.log('Example Flow:', swap(a,3,5).reverse().join('-') );
```

并就地解决方案

```
let swap= (arr,i,j)=> {let t=arr[i]; arr[i]=arr[j]; arr[j]=t; return arr}

// test index: 3<->5 (= 'f'<->'d')
let a= ["a","b","c","d","e","f","g"];

console.log( swap(a,3,5) )
console.log('Example Flow:', swap(a,3,5).reverse().join('-') );
```

在这个解决方案中，我们使用[“流模式”](https://en.wikipedia.org/wiki/Method_chaining)，这意味着`swap`函数返回数组作为结果 - 这允许使用点轻松继续处理`.`（如`reverse`和`join`片段中）

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-11-25T14:20:22.163

这是一个首先检查索引是否存在于数组中的变体：

```
Array.prototype.swapItems = function(a, b){
    if(  !(a in this) || !(b in this) )
        return this;
    this[a] = this.splice(b, 1, this[a])[0];
    return this;
} 
```

它目前只会`this`在索引不存在时返回，但您可以轻松修改失败时的行为

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2018-06-21T05:04:02.360

如果您不想在 ES5 中使用 temp 变量，这是交换数组元素的一种方法。

```
var swapArrayElements = function (a, x, y) {
  if (a.length === 1) return a;
  a.splice(y, 1, a.splice(x, 1, a[y])[0]);
  return a;
};

swapArrayElements([1, 2, 3, 4, 5], 1, 3); //=> [ 1, 4, 3, 2, 5 ] 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2020-04-08T09:50:12.000

克隆数组而不是改变现有数组的打字稿解决方案

```
export function swapItemsInArray<T>(items: T[], indexA: number, indexB: number): T[] {
  const itemA = items[indexA];

  const clone = [...items];

  clone[indexA] = clone[indexB];
  clone[indexB] = itemA;

  return clone;
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-03-11T00:04:14.390

```
Array.prototype.swap = function(a, b) {
  var temp = this[a];
  this[a] = this[b];
  this[b] = temp;
}; 
```

用法：

```
var myArray = [0,1,2,3,4...];
myArray.swap(4,1); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-05-22T14:45:12.750

为简洁起见，这里是丑陋的单线版本，它只比上面所有的 concat 和 slicing 稍微丑一点。接受的答案确实是要走的路，而且更具可读性。

鉴于：

```
var foo = [ 0, 1, 2, 3, 4, 5, 6 ]; 
```

如果要交换两个索引（a 和 b）的值；那么这将做到这一点：

```
foo.splice( a, 1, foo.splice(b,1,foo[a])[0] ); 
```

例如，如果你想交换 3 和 5，你可以这样做：

```
foo.splice( 3, 1, foo.splice(5,1,foo[3])[0] ); 
```

或者

```
foo.splice( 5, 1, foo.splice(3,1,foo[5])[0] ); 
```

两者产生相同的结果：

```
console.log( foo );
// => [ 0, 1, 2, 5, 4, 3, 6 ] 
```

#splicehatersarepunks :)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-07-08T15:09:33.450

在没有临时变量或 ES6 交换方法的情况下交换数组中的第一个和最后一个元素 [a, b] = [b, a]

`[a.pop(), ...a.slice(1), a.shift()]`

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-07-18T09:17:01.970

```
function moveElement(array, sourceIndex, destinationIndex) {
    return array.map(a => a.id === sourceIndex ? array.find(a => a.id === destinationIndex): a.id === destinationIndex ? array.find(a => a.id === sourceIndex) : a )
}
let arr = [
{id: "1",title: "abc1"},
{id: "2",title: "abc2"},
{id: "3",title: "abc3"},
{id: "4",title: "abc4"}];

moveElement(arr, "2","4"); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-10-13T06:20:47.490

就地交换

```
// array methods
function swapInArray(arr, i1, i2){
    let t = arr[i1];
    arr[i1] = arr[i2];
    arr[i2] = t;
}

function moveBefore(arr, el){
    let ind = arr.indexOf(el);
    if(ind !== -1 && ind !== 0){
        swapInArray(arr, ind, ind - 1);
    }
}

function moveAfter(arr, el){
    let ind = arr.indexOf(el);
    if(ind !== -1 && ind !== arr.length - 1){
        swapInArray(arr, ind + 1, ind);
    }
}

// dom methods
function swapInDom(parentNode, i1, i2){
    parentNode.insertBefore(parentNode.children[i1], parentNode.children[i2]);
}

function getDomIndex(el){
    for (let ii = 0; ii < el.parentNode.children.length; ii++){
        if(el.parentNode.children[ii] === el){
            return ii;
        }
    }
}

function moveForward(el){
    let ind = getDomIndex(el);
    if(ind !== -1 && ind !== 0){
        swapInDom(el.parentNode, ind, ind - 1);
    }
}

function moveBackward(el){
    let ind = getDomIndex(el);
    if(ind !== -1 && ind !== el.parentNode.children.length - 1){
        swapInDom(el.parentNode, ind + 1, ind);
    }
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2022-02-09T19:42:54.017

如果由于某种原因不允许使用就地交换，这里有一个使用 map 的解决方案：

```
function swapElements(array, source, dest) {
  return source === dest
? array : array.map((item, index) => index === source
  ? array[dest] : index === dest 
  ? array[source] : item);
}

const arr = ['a', 'b', 'c'];
const s1 = swapElements(arr, 0, 1);
console.log(s1[0] === 'b');
console.log(s1[1] === 'a');

const s2 = swapElements(arr, 2, 0);
console.log(s2[0] === 'c');
console.log(s2[2] === 'a');
```

这是用于快速复制粘贴的打字稿代码：

```
function swapElements(array: Array<any>, source: number, dest: number) {
  return source === dest
    ? array : array.map((item, index) => index === source
      ? array[dest] : index === dest 
      ? array[source] : item);
} 
```

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2017-04-03T08:54:02.617

只是为了好玩，另一种不使用任何额外变量的方法是：

```
var arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];

// swap index 0 and 2
arr[arr.length] = arr[0];   // copy idx1 to the end of the array
arr[0] = arr[2];            // copy idx2 to idx1
arr[2] = arr[arr.length-1]; // copy idx1 to idx2
arr.length--;               // remove idx1 (was added to the end of the array)

console.log( arr ); // -> [3, 2, 1, 4, 5, 6, 7, 8, 9]
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2018-06-21T05:45:06.873

**试试这个功能...**

```
$(document).ready(function () {
        var pair = [];
        var destinationarray = ['AAA','BBB','CCC'];

        var cityItems = getCityList(destinationarray);
        for (var i = 0; i < cityItems.length; i++) {
            pair = [];
            var ending_point = "";
            for (var j = 0; j < cityItems[i].length; j++) {
                pair.push(cityItems[i][j]);
            }
            alert(pair);
            console.log(pair)
        }

    });
    function getCityList(inputArray) {
        var Util = function () {
        };

        Util.getPermuts = function (array, start, output) {
            if (start >= array.length) {
                var arr = array.slice(0);
                output.push(arr);
            } else {
                var i;

                for (i = start; i < array.length; ++i) {
                    Util.swap(array, start, i);
                    Util.getPermuts(array, start + 1, output);
                    Util.swap(array, start, i);
                }
            }
        }

        Util.getAllPossiblePermuts = function (array, output) {
            Util.getPermuts(array, 0, output);
        }

        Util.swap = function (array, from, to) {
            var tmp = array[from];
            array[from] = array[to];
            array[to] = tmp;
        }
        var output = [];
        Util.getAllPossiblePermuts(inputArray, output);
        return output;
    }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2019-05-21T14:16:45.780

使用**ES6**可以这样做......

想象一下你有这**两个数组**......

```
const a = ["a", "b", "c", "d", "e"];
const b = [5, 4, 3, 2, 1]; 
```

并且您想交换第一个值：

```
const [a0] = a;
a[0] = b[0];
b[0] = a0; 
```

和价值：

```
a; //[5, "b", "c", "d", "e"]
b; //["a", 4, 3, 2, 1] 
```

* * *

## 回答 #33

> 赞同：-3
> 
> 时间：2016-07-16T03:12:04.683

如果只需要交换第一个和最后一个元素：

```
array.unshift( array.pop() ); 
```

# java - 在同一个类中拥有静态和非静态方法是错误的吗？

> ID：872313
> 
> 赞同：15
> 
> 时间：2009-05-16T12:12:29.747
> 
> 标签：java, design-patterns, static

在同一个类中拥有静态和非静态方法是错误的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-16T12:17:20.233

不是真的在常规的java编程中。

但是，如果您广泛使用依赖注入，您可能根本没有或几乎没有静态方法。在这种情况下，只有少数实用程序类具有静态方法，而没有其他静态方法是相当普遍的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-16T12:20:14.393

不，这没有错。例如，一个常见的用途是在类定义中包含静态工厂方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-16T13:17:49.433

我认为创建静态 utils 类很好，尤其是当您（还）不确定设计应该是什么时，因为您仍在学习问题域。

静态是“尚未正确设计”的标记。通常静态解决方案是完全足够的。但有时，随着项目的进展，你发现你确实必须重写那个“整个部分”，但你（在那个后期）对问题域有更完整的理解，因此能够实际设计一个这些问题的“适当解决方案”。

我认为我们程序员对“返工”的评价是不公平的。您需要完成工作才能充分理解工作以正确完成工作。我看不出有什么办法超过这个第 22 条；

我可以从核心 API 中引用许多静态示例。java.lang.Math、java.util.Arrays、java.util.Collections。但请注意，这些类是“utils 类”，它们的存在只是为了提供一堆静态方法。恕我直言，“有状态对象”中静态方法的存在只是乞求重构。

我敢打赌，今天的 API 设计人员希望能够拆分 Integer （和其他包装类）......但他们很好，并且真正坚持他们所拥有的。这本身就是一个警告......静态意味着最终，并且有一个很好的理由（与 C++ 不同）java 方法可以在*默认情况下*被覆盖。静态本质上比非静态更具“约束力”......你不能使实现适应不同的情况，上下文等等等。

干杯。基思。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T19:39:18.097

我认为在同一个类中具有相同名称的静态和非静态方法是一个坏主意。这可能非常令人困惑。我建议在这种情况下尝试使名称不同。

同样，不要让方法同名但大小写不同，或者方法与同一个类中的类同名。两者都是合法的，甚至出现在 JDK 中，但让 IHMO 感到困惑。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-16T12:14:49.647

我想不是特别是在处理单身人士时。

# xml - Web 应用程序中的 XML 签名

> ID：872316
> 
> 赞同：1
> 
> 时间：2009-05-16T12:14:07.370
> 
> 标签：xml, web-applications, certificate, signature, xml-signature

我们正在为一家小型银行（最多 20000 个客户/用户）开发一个电子银行 Web 应用程序。我们必须使用 X509 证书（由 CA 在 USB 令牌上颁发）实现数字签名，以签署付款信息。我们尝试使用 CAPICOM，但它似乎不适用于 Windows Vista（尚未在 Win 7 上尝试过）。另一个问题是核心银行系统只能处理 Xml 数字签名，因此我们必须签署 XML 文档（不仅仅是像 CAPICOM 和 Win32 Crypto API 那样的批量格式化文本数据）。

所以我的问题是：

*   你们中有人有类似的问题吗？他们是如何解决的？

*   **是否有支持 Web 应用程序中 XML 数字签名的插件、库、组件或外部工具（用于 Internet Explorer 和/或 Fire Fox）？**

*   您能否推荐其中一些产品并写一些关于您使用它们的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T13:59:27.053

我曾经在一家 IT 咨询公司工作，那时我们在 Ubisecure (www.ubisecure.com) 的 Web 应用程序中使用 Ubi Sign ActiveX 进行 XML 签名。现在我在他们的网站上找不到关于这个产品的任何信息，所以试着给他们发电子邮件。你也可以试试我在互联网上找到的这个 ActiveX 组件。名称是 Lizard Labs (www.lizardl.com) 的 XSign ActiveX XML 签名组件。没有尝试过它，但作者说它工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-19T08:08:03.287

查看[`System.Security.Cryptography.Xml`命名空间](http://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.aspx)中的类型，尤其是[`SignedXml`类](http://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.signedxml.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-10T23:55:29.117

XML Signature Applet 是一个软件组件，可以在 Web 应用程序中创建 XML 数字签名。XML Signature Apple 是一个简单的 Java 小程序，用于使用存储在系统证书存储中的 X.509 数字证书对 XML 文档进行数字签名。此小程序以 XML 格式接收数据并生成 XMLDsig 格式的封装签名表示。

在这里找到它：

[http://www.digisecsolutions.com/](http://www.digisecsolutions.com/)

# c# - 如果在 C# 中不为空，则方法调用

> ID：872323
> 
> 赞同：125
> 
> 时间：2009-05-16T12:15:04.997
> 
> 标签：c#, null

是否有可能以某种方式缩短此声明？

```
if (obj != null)
    obj.SomeMethod(); 
```

因为我碰巧写了很多，它变得很烦人。我唯一能想到的就是实现**Null Object**模式，但这不是我每次都能做到的，当然也不是缩短语法的解决方案。

与事件类似的问题，其中

```
public event Func<string> MyEvent; 
```

然后调用

```
if (MyEvent != null)
    MyEvent.Invoke(); 
```

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2009-05-16T12:17:59.453

从 C# 6 开始，您可以使用：

```
MyEvent?.Invoke(); 
```

或者：

```
obj?.SomeMethod(); 
```

是`?.`空传播运算符，`.Invoke()`当操作数为 时会导致 短路`null`。操作数只被访问一次，因此不存在“检查和调用之间的值变化”问题的风险。

===

在 C# 6 之前，没有：没有 null 安全魔法，只有一个例外；扩展方法 - 例如：

```
public static void SafeInvoke(this Action action) {
    if(action != null) action();
} 
```

现在这是有效的：

```
Action act = null;
act.SafeInvoke(); // does nothing
act = delegate {Console.WriteLine("hi");}
act.SafeInvoke(); // writes "hi" 
```

在事件的情况下，这还具有消除竞争条件的优点，即您不需要临时变量。所以通常你需要：

```
var handler = SomeEvent;
if(handler != null) handler(this, EventArgs.Empty); 
```

但有：

```
public static void SafeInvoke(this EventHandler handler, object sender) {
    if(handler != null) handler(sender, EventArgs.Empty);
} 
```

我们可以简单地使用：

```
SomeEvent.SafeInvoke(this); // no race condition, no null risk 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-09-25T20:27:34.860

您正在寻找的是[Null-Conditional](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/member-access-operators#null-conditional-operators--and-)（不是“合并”）运算符：**`?.`**。它从 C# 6 开始可用。

你的例子是`obj?.SomeMethod();`. 如果 obj 为 null，则不会发生任何事情。当方法有参数时，例如`obj?.SomeMethod(new Foo(), GetBar());`，如果为空，则不评估参数`obj`，如果评估参数会产生副作用，这很重要。

并且可以链接：`myObject?.Items?[0]?.DoSomething()`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-03-03T21:00:20.863

快速扩展方法：

```
 public static void IfNotNull<T>(this T obj, Action<T> action, Action actionIfNull = null) where T : class {
        if(obj != null) {
            action(obj);
        } else if ( actionIfNull != null ) {
            actionIfNull();
        }
    } 
```

例子：

```
 string str = null;
  str.IfNotNull(s => Console.Write(s.Length));
  str.IfNotNull(s => Console.Write(s.Length), () => Console.Write("null")); 
```

或者：

```
 public static TR IfNotNull<T, TR>(this T obj, Func<T, TR> func, Func<TR> ifNull = null) where T : class {
        return obj != null ? func(obj) : (ifNull != null ? ifNull() : default(TR));
    } 
```

例子：

```
 string str = null;
    Console.Write(str.IfNotNull(s => s.Length.ToString());
    Console.Write(str.IfNotNull(s => s.Length.ToString(), () =>  "null")); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-16T12:40:01.800

事件可以用一个永远不会被删除的空默认委托来初始化：

```
public event EventHandler MyEvent = delegate { }; 
```

无需进行空值检查。

[**更新**，感谢贝文指出这一点]

但请注意可能的性能影响。我做的一个快速的微型基准测试表明，在使用“默认委托”模式时，处理没有订阅者的事件会慢 2-3 倍。（在我的双核 2.5GHz 笔记本电脑上，这意味着 279 毫秒：785 毫秒用于引发 5000 万个未订阅事件。）。对于应用程序热点，这可能是一个需要考虑的问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-03-21T02:06:33.123

是的，在 C# 6.0 中——https: [//msdn.microsoft.com/en-us/magazine/dn802602.aspx](https://msdn.microsoft.com/en-us/magazine/dn802602.aspx)。

```
object?.SomeMethod() 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T14:36:55.093

[Ian Griffiths 的这篇](http://www.interact-sw.co.uk/iangblog/2008/04/13/member-lifting)文章为这个问题提供了两种不同的解决方案，他认为这些都是不应该使用的巧妙技巧。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-17T06:56:30.077

像一种建议的 Crating 扩展方法并不能真正解决竞争条件的问题，而是隐藏它们。

```
public static void SafeInvoke(this EventHandler handler, object sender)
{
    if (handler != null) handler(sender, EventArgs.Empty);
} 
```

如前所述，此代码与带有临时变量的解决方案优雅等效，但是...

两者的问题在于**，事件的订阅者可能会在取消订阅事件之后被调用**。这是可能的，因为取消订阅可能发生在委托实例复制到临时变量（或在上述方法中作为参数传递）之后，但在调用委托之前。

一般来说，在这种情况下客户端代码的行为是不可预测的：组件状态已经不允许处理事件通知。以处理它的方式编写客户端代码是可能的，但这会给客户端带来不必要的责任。

确保线程安全的唯一已知方法是对事件的发送者使用 lock 语句。这确保所有订阅\取消订阅\调用都被序列化。

为了更准确，应该将锁定应用于添加\删除事件访问器方法中使用的相同同步对象，默认为“this”。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-18T05:52:43.317

我同意肯尼埃利亚松的回答。使用扩展方法。这是扩展方法和您所需的 IfNotNull 方法的简要概述。

[扩展方法（IfNotNull 方法）](http://codereferences.blogspot.in/2012/05/extension-methods-ifnotnull-methods-c.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-16T12:18:30.840

也许不是更好，但在我看来更具可读性的是创建一个扩展方法

```
public static bool IsNull(this object obj) {
 return obj == null;
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-09-21T17:10:42.837

我已经制作了我使用的这个通用扩展。

```
public static class ObjectExtensions {
    public static void With<T>(this T value, Action<T> todo) {
        if (value != null) todo(value);
    }
} 
```

然后我像下面这样使用它。

```
string myString = null;
myString.With((value) => Console.WriteLine(value)); // writes nothing
myString = "my value";
myString.With((value) => Console.WriteLine(value)); // Writes `my value` 
```

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2009-05-16T21:41:35.667

在 C# 中有一个鲜为人知的 null 运算符，??。可能会有所帮助：

[http://weblogs.asp.net/scottgu/archive/2007/09/20/the-new-c-null-coalescing-operator-and-using-it-with-linq.aspx](http://weblogs.asp.net/scottgu/archive/2007/09/20/the-new-c-null-coalescing-operator-and-using-it-with-linq.aspx)

# asp.net - IE 的动态 Superfish 菜单问题

> ID：872324
> 
> 赞同：0
> 
> 时间：2009-05-16T12:15:45.510
> 
> 标签：asp.net, jquery, superfish

我的菜单几乎完成了，但是我有一个问题，我需要根据用户删除其中的某些部分。在 Firefox 中没问题，但在 IE 上，当我将 li 设置为不显示时，它会留下一个空白空间。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T12:26:11.430

试过了

```
visibility: hidden 
```

?

此外，如果这是一个安全问题，请记住隐藏链接不应该是唯一的安全手段，应用程序应该有自己的安全性，以防有人或谷歌获取链接（根据我的经验，谷歌总是这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:01:27.330

做到了，而不是使用 style display none 我而是使用 jquery remove 功能。

# javascript - iframe 位置为空

> ID：872333
> 
> 赞同：-4
> 
> 时间：2009-05-16T12:20:20.897
> 
> 标签：javascript, iframe, location

有时我使用：

```
window.frames[framename].location.href 
```

..只发现萤火虫报告`window.frames[framename].location`为空，为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T13:13:32.500

框架是否在另一个域中？您可能会发现自己受到限制，因为您无法访问其他域的内容（例如 XSS）

# c# - 具有空主体和类继承语法的构造函数有什么作用？

> ID：872335
> 
> 赞同：3
> 
> 时间：2009-05-16T12:21:53.843
> 
> 标签：c#, constructor, constructor-chaining

```
public class PhotoList : ObservableCollection<ImageFile>
{

    public PhotoList() { }

    **//this is the line that I  dont recognise!!!!!!!!!!**
    public PhotoList(string path) : this(new DirectoryInfo(path)) { }

    public PhotoList(DirectoryInfo directory)
    {
        _directory = directory;
        Update();
    }

    public string Path
    {
        set
        {
            _directory = new DirectoryInfo(value);
            Update();
        }
        get { return _directory.FullName; }
    }

    public DirectoryInfo Directory
    {
        set
        {
            _directory = value;
            Update();
        }
        get { return _directory; }
    }
    private void Update()
    {
        foreach (FileInfo f in _directory.GetFiles("*.jpg"))
        {
            Add(new ImageFile(f.FullName));
        }
    }

    DirectoryInfo _directory;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-16T12:23:58.143

这称为*构造函数链接*——构造函数可以使用这种语法调用同一类型中的其他构造函数（**`this`**用于兄弟构造函数和**`base`**基构造函数）。

这是一个简单的例子，展示了它是如何工作的：

```
using System;

class Program
{
    static void Main()
    {
        Foo foo = new Foo();
    }
}

class Foo
{
    public Foo() : this("hello")
    {
        Console.WriteLine("world");
    }

    public Foo(String s)
    {
        Console.WriteLine(s);
    }
} 
```

**输出：**

> `hello`
> `world`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T12:28:00.973

它调用类中的另一个构造函数，该构造函数将 DirectoryInfo 作为参数。

让我们看看如何使用这个类的调用者

```
//The empty ctor()
PhotoList list = new PhotoList();

//The ctor that takes a DirectoryInfo
PhotoList list2 = new PhotoList(new DirectoryInfo("directory")); 

//Would do the same as the code above since this constructor calls another constructor via the this() keyword
PhotoList list3 = new PhotoList("directory"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T12:24:39.560

它使接受字符串参数的构造函数调用接受 DirectoryInfo 参数的构造函数，将一个新的 DirectoryInfo 对象（该对象反过来使用字符串作为参数）传递给它。

我经常使用这种方法为复杂的类提供更简单的构造函数，让类本身用默认值初始化属性，而不必重复初始化代码。

# html - XHTML 2.0 与 HTML 5

> ID：872336
> 
> 赞同：0
> 
> 时间：2009-05-16T12:22:36.010
> 
> 标签：html, xhtml, xhtml2

### 复制：

> *   [为什么 (X)HTML 5 和 XHTML 2 是不同的标准？](https://stackoverflow.com/questions/472274/why-are-xhtml-5-and-xhtml-2-separate-standards)
> *   [HTML 5 与 XHTML 1.0 过渡？](https://stackoverflow.com/questions/256953/html-5-versus-xhtml-1-0-transitional)
> *   [HTML 与 XHTML 仍然重要吗？](https://stackoverflow.com/questions/413114/html-vs-xhtml-does-it-still-matter)

* * *

似乎有一个统一的意见，即 HTML 5 的发展和 HTML 5 浏览器供应商的支持，使得采用 XHTML 1.0 并希望 XHTML 2.0 成为一个糟糕的选择。

出于这个原因，我决定在我最近的项目中使用严格的 HTML 4.01 文档类型，这要求我回顾 HTML 约定，例如在自结束标记的末尾不使用大于字符

问题是我在做正确的事吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T13:52:21.223

XHTML 2 将悄无声息地消亡，未被使用且不为人所知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T12:26:06.517

我会坚持使用 XHTML，HTML 5 支持大多数 XHTML 语法（`<br />`等）

# php - 把所有的都包裹起来 , 获取 alt 属性并将其添加到 里面

> ID：872340
> 
> 赞同：0
> 
> 时间：2009-05-16T12:24:54.693
> 
> 标签：php, regex, replace

试图用一些 php 服务器端的魔法替换[这个 jquery 代码：](http://jsbin.com/efidu)

```
$(document).ready(function() {
    $('#text img').each(function(){ 
        source = $(this).attr('src');
        $(this).wrap($('<div class="caption '+ $(this).attr('class') + '"></div>')).removeAttr('class').removeAttr('height').removeAttr('width');
        $(this).after('<p>' + $(this).attr('alt') + '</p>');
        $(this).attr('src', '/system/tools/phpthumb/phpThumb.php?src=' + source + '&wl=200&hp=200&q=85&f=jpg');
    });
}); 
```

它所做的就是采取这个：

```
<img class="right" src="blah.jpg" alt="My caption" width="100" height="200" /> 
```

并将其替换为：

```
<div class="caption right">
    <img src="/system/tools/phpthumb/phpThumb.php?src=blah.jpg&wl=200&hp=200&q=85&f=jpg" alt="My caption" />
    <p>My caption</p>
</div> 
```

图像散布在`<p>`'s 之间的纺织品格式的 html 块中。像这样的东西：

```
<p>My paragraph text</p>
<img src="image.jpg" />
<p>Another paragraph text <img src="another_image.jpg" /> with more text</p>
<p>And so on</p> 
```

它使用户能够将图像向左、向右或居中浮动，并使用 phpthumb 自动创建缩略图。我假设我需要使用正则表达式。我是 php 新手，只知道前端编码。你会怎么攻击这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T19:53:13.100

我建议您使用解析器，例如[DOMDocument](http://docs.php.net/manual/en/class.domdocument.php)。除了[DOMXPath](http://docs.php.net/manual/en/class.domxpath.php)之外，您几乎可以一一翻译 jQuery 代码：

```
$documentSource = '<div id="text"><img class="right" src="blah.jpg" alt="My caption" width="100" height="200" /></div>';
$doc = new DOMDocument();
$doc->loadHTML($documentSource);
$xpath = new DOMXPath($doc);
foreach ($xpath->query('//html/body/*[@id="text"]/img') as $node) {
    // source = $(this).attr('src');
    $source = $node->getAttribute('src');

    // $(this).after('<p>' + $(this).attr('alt') + '</p>');
    $pElem = $doc->createElement('p', $node->getAttribute('alt'));

    // $('<div class="caption '+ $(this).attr('class') + '"></div>')
    $divElem = $doc->createElement('div');
    $divElem->setAttribute('class', 'caption '.$node->getAttribute('class'));

    // $(this).wrap( … );
    $divElem->appendChild($node->cloneNode(true));
    $divElem->appendChild($pElem);
    $node->parentNode->replaceChild($divElem, $node);

    // $(this).removeAttr('class').removeAttr('height').removeAttr('width');
    $node->removeAttribute('class');
    $node->removeAttribute('height');
    $node->removeAttribute('width');

    // $(this).attr('src', '/system/tools/phpthumb/phpThumb.php?src=' + source + '&wl=200&hp=200&q=85&f=jpg');
    $node->setAttribute('src', '/system/tools/phpthumb/phpThumb.php?src=' . $source . '&wl=200&hp=200&q=85&f=jpg');
}
echo $doc->saveXML(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T12:31:03.883

一些完全未经测试的代码：

```
preg_match('|<img class="([a-z\ ]+)" src="([a-z\ ]+)" alt="([a-z\ ]+)" />|i', 'PUT THE EXISTING HTML HERE', $matches);

echo <<<EOT
<span class="{$matches[0]}">
  <img src="{$matches[1]}" />
<p>{$matches[2]}</p>
</span>
EOT; #this should be at the start of line 
```

不过感兴趣的是，为什么一开始就不能输出正确的 html？加载正则表达式引擎并非没有开销！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T19:54:54.923

我认为您可能对使用其 DOM 扩展在 PHP 内部模拟 jQuerys 功能的 PHP 库感兴趣。

该项目称为[PHPQuery - http://code.google.com/p/phpquery/](http://code.google.com/p/phpquery/)

它可以通过 PEAR 轻松安装，用法类似于 jQuery 语法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-14T10:26:35.063

最终使用了这个：

```
<?php
$string = '{body}';
$documentSource = mb_substr($string,3,-4);

$doc = new DOMDocument();
$doc->loadHTML($documentSource);
$xpath = new DOMXPath($doc);
foreach ($xpath->query('//html/body/img') as $node) {
    $node->removeAttribute('height');
    $node->removeAttribute('width');
    $source = $node->getAttribute('src');

    $node->setAttribute('src', '/system/tools/phpthumb/phpThumb.php?src=' . $source . '&wl=200&hp=200&q=85&f=jpg');

    $pElem = $doc->createElement('p', $node->getAttribute('alt'));

    $divElem = $doc->createElement('div');
    $divElem->setAttribute('class', 'caption '.$node->getAttribute('class'));
    $node->removeAttribute('class');

    $divElem->appendChild($node->cloneNode(true));
    $divElem->appendChild($pElem);
    $node->parentNode->replaceChild($divElem, $node);

}
?> 
```

# c++ - 获取模板迭代器引用的引用

> ID：872354
> 
> 赞同：0
> 
> 时间：2009-05-16T12:35:23.920
> 
> 标签：c++, iterator

我需要获取对引用迭代器的引用。但是，我的编译器对这段代码感到窒息：

```
template <typename InputIterator> size_t iLongestBegin(InputIterator first, InputIterator last)
{
    typedef typename std::iterator_traits<InputIterator>::reference SequenceT;
        //Problem is next line
    typedef typename std::iterator_traits<typename SequenceT::iterator>::reference T;
    for(size_t idx; idx < first->length(); idx++)
    {
        T curChar = (*first)[idx];
        for (InputIterator cur = first; cur != last; cur++)
        {
            if (cur->length() < idx)
                return idx;
            if (_tolower(cur->at(idx)) != _tolower(curChar))
                return idx;
        }
    }
    return first->length();
} 
```

关于如何解决它的任何想法？错误是

```
error C2825: 'SequenceT': must be a class or namespace when followed by '::' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T14:02:08.250

实际上，刚刚解决了它:)

问题是 SequenceT 是一个引用，而不是一个类型。由于您通常无法获取引用类型的地址，因此编译器不会为其生成迭代器。我需要使用 value_type 而不是参考：

```
template <typename InputIterator> size_t iLongestBegin(InputIterator first, InputIterator last)
{
    typedef typename std::iterator_traits<InputIterator>::reference SequenceT;
    typedef typename std::iterator_traits<std::iterator_traits<InputIterator>::value_type::iterator>::reference T;
    for(size_t idx; idx < first->length(); idx++)
    {
        typename T curChar = (*first)[idx];
        for (InputIterator cur = first; cur != last; cur++)
        {
            if (cur->length() < idx)
                return idx;
            if (_tolower(cur->at(idx)) != _tolower(curChar))
                return idx;
        }
    }
    return first->length();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T12:41:50.580

您是否错过`SequenceT`了在模板参数列表中指定 - 它在哪里定义？或者，也许您必须指出它是一个带有`typename SequenceT`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T12:45:54.253

你需要写`typename SequenceT::iterator`而不是仅仅`SequenceT::iterator`. 这是因为`SequenceT`它是从模板参数派生的类型（标准术语中的“依赖类型”），并且`iterator`是 中的嵌套类型`SequenceT`，而不是函数或变量。当这两件事都为真时，编译器无法理解您的意思，需要被告知这`SequenceT::iterator`是一个带有`typename`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T13:48:37.190

以下使用 g++ 4.4.0 编译：

```
#include <iterator>
using namespace std;

template <typename InputIterator> size_t iLongestBegin(InputIterator first, InputIterator last) {
   typedef typename std::iterator_traits<InputIterator>::reference SequenceT;
   typedef typename std::iterator_traits<typename SequenceT::iterator>::reference T;
   for(size_t idx; idx < first->length(); idx++)
   {
      T curChar = (*first)[idx];
      for (InputIterator cur = first; cur != last; cur++)
      {
         if (cur->length() < idx)
             return idx;
         if (_tolower(cur->at(idx)) != _tolower(curChar))
             return idx;
      }
   }
    return first->length();
} 
```

# .net - 在哪里可以找到 .Net ORM 与数字或图表的比较？

> ID：872363
> 
> 赞同：3
> 
> 时间：2009-05-16T12:43:14.070
> 
> 标签：.net, database, ado.net

在哪里可以找到 .Net ORM 与数字或图表的比较？

我正在建立一个新网站，将致力于在线排列图像和处理图像，因此它将包含大量图像，并且肯定许多图像会使网站页面加载速度变慢。

所以数据访问层的速度对我来说非常重要，我正在寻找一个 ORM，因为我想减少开发时间。

如果您知道任何网站或博客文章包含一个很好的比较，请告诉我们。

**更新**：

我知道SO上有很多关于ORM的问题，但是都推荐一个，或者说一个比另一个好，我不希望你推荐一个，我只是想看一个比较，以后每个人都可以根据他的需要决定

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-25T17:38:15.667

检查 ormbattle.net。不是很完整，但可以给出一些想法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T12:47:37.680

请参阅这些先前提出的 SO 问题：

*   [您会推荐哪种适用于 .net 的 ORM？](https://stackoverflow.com/questions/132676/which-orm-for-net-would-you-recommend)
*   [最容易学习和使用的 .NET ORM 框架？](https://stackoverflow.com/questions/557948/easiest-to-learn-and-use-net-orm-framework)
*   [.NET 的最佳性能 ORM](https://stackoverflow.com/questions/146087/best-performing-orm-for-net)
*   [与 .NET 2.0/3.5 一起使用的最佳免费 ORM 工具](https://stackoverflow.com/questions/206197/best-free-orm-tools-to-use-with-net-2-0-3-5/206284)
*   [.NET 世界中的 ORM 和 SOA](https://stackoverflow.com/questions/412660/orm-and-soa-in-the-net-world)
*   [关于学习哪个 .NET ORM 的一些建议](https://stackoverflow.com/questions/550929/some-suggestions-on-which-net-orm-to-look-at-learning)

# windows - Win32：获取其他应用程序关闭/退出的消息通知

> ID：872364
> 
> 赞同：4
> 
> 时间：2009-05-16T12:44:33.617
> 
> 标签：windows, winapi, visual-c++

我的应用程序需要监视系统上所有其他正在运行的应用程序。有什么方法可以在每个应用程序 exe 退出时得到通知？

我能找到的方法：

1）使用PSAPI函数获取频繁运行的exe列表。在每次轮询时，与前一个列表进行比较以找出哪个应用程序/进程已退出。缺点：需要不断的轮询，会占用CPU时间。

2) 为 WM_CLOSE 消息设置一个全局挂钩：使用这个我可以在任何应用程序通过标题栏上的关闭按钮关闭时收到通知

缺点：（-）并非所有应用程序都生成 WM_CLOSE 消息（例如：Total Video Player Exe）（-）如果应用程序通过“退出”菜单或按钮（例如文件->退出）关闭，我不能捕获该消息

我错过了其他更好的方法吗？请指教。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-16T13:19:14.953

1.  使用 PSAPI 获取 PID 列表。
2.  [然后使用OpenProcess()](http://msdn.microsoft.com/en-us/library/ms684320.aspx)获取每个进程的句柄。
3.  当进程之一退出时，使用[WaitForMultipleObjects()](http://msdn.microsoft.com/en-us/library/ms687025(VS.85).aspx)发出信号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T18:13:25.447

您可以尝试使用[RegisterShellHookWindow](http://msdn.microsoft.com/en-us/library/ms644989.aspx) () API 并过滤 HSHELL_WINDOWCREATED 和 HSHELL_WINDOWDESTROYED 消息。

当然，这只会让您收到有关具有窗口的应用程序的通知。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-19T20:01:51.703

我最近遇到了这个问题，并找到了解决方案，所以想与大家分享。这一切都纠正了我们应该获得进程句柄的方式。我建议使用 RegisterWaitForSingle 对象函数，而不是 WaitForSingleOBject。使用此函数，您将提供一个回调函数，并且每当进程退出时，都会调用您的回调函数。这比在线程中调用 WaitForSingleObject 要好。在您的代码中单独调用 WaitForSingleObject 将导致您的代码等待进程退出。这是一个如何调用它的示例：

```
RegisterWaitForSingleObject(&waitHandle, processHandle, ProcessTerminatedCallback, param, INFINITE, WT_EXECUTEONLYONCE); 
```

其中： [out]waitHandle - 为您创建的新句柄。请注意，您不能使用此句柄来调用 CloseHandle，但如果您愿意，可以等待它。

[in] processHandle - 处理你应该自己获得的进程

[in] ProcessTerminatedCallback - 进程退出时将调用的回调函数

[in] param - 将传递给回调的 LPVOID 参数

[in] INFINITE - 无限等待或指定时间，查找 MSDN 了解更多信息

[in] WM_EXECUTEONLYONCE - 只会调用一次回调函数。查找 MSDN 以获取更多信息

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-18T17:11:48.837

*> 我错过了其他更好的方法吗？*

是的，很多。参见[Win32 组](http://groups.google.com/group/comp.os.ms-windows.programmer.win32/topics?lnk=srg)（系统通知，无任何钩子）

# javascript - 将python代码移植到javascript

> ID：872366
> 
> 赞同：0
> 
> 时间：2009-05-16T12:45:33.240
> 
> 标签：javascript, python, porting

```
indices[i:] = indices[i+1:] + indices[i:i+1] 
```

希望有人帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T02:02:09.033

我对 Python 还很陌生，但如果我正确理解了代码，它会将给定偏移量的列表重构为偏移量 + 1 之后的每个项目和偏移量处的项目。

运行它似乎证实了这一点：

```
>>> indices = ['one','two','three','four','five','six']
>>> i = 2
>>> indices[i:] = indices[i+1:] + indices[i:i+1]
>>> indices
['one', 'two', 'four', 'five', 'six', 'three'] 
```

在 Javascript 中可以写成：

```
indices = indices.concat( indices.splice( i, 1 ) ); 
```

同样的整个序列会去：

```
>>> var indices = ['one','two','three','four','five','six'];
>>> var i = 2;
>>> indices = indices.concat( indices.splice( i, 1 ) );
>>> indices
["one", "two", "four", "five", "six", "three"] 
```

这是有效的，因为[splice](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/splice)对数组具有破坏性，但会返回删除的元素，然后可以将其交给[concat](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/concat)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T12:49:51.840

你会想看看[Array.slice()](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/slice)

```
var temp=indices.slice(i+1).concat(indices.slice(i, i+1));
var arr=[];
for (var j=0; j<temp.length; j++){
   arr[j+i]=temp[i];
} 
```

# java - 将地图中的参数添加到 URL 标记

> ID：872375
> 
> 赞同：4
> 
> 时间：2009-05-16T12:53:10.350
> 
> 标签：java, url, struts2, tags, param

我想将参数的变量列表添加到 Struts2 URL 标记。我在会话中的一个对象中有一个参数映射（名称值对）。我正在努力寻找解决此问题的好方法。这是相关的JSP代码：

```
 <s:iterator value="%{#session['com.strutsschool.interceptors.breadcrumbs']}" status="status">
    <s:if test="#status.index > 0">
        &#187;
    </s:if>
    <s:url id="uri" action="%{action}" namespace="%{nameSpace}">
            <s:param name="parameters" value="%{parameters}"/>
    </s:url>
    <nobr><s:a href="%{uri}"><s:property value="displayName"/></s:a></nobr>
</s:iterator> 
```

参数变量是一个包含参数的 Map。这当然行不通，但我目前看不到解决此问题的方法。我现在在想，我可能需要一个自定义的 freemarker 模板。任何人都可以提出更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T14:39:20.413

也许你可以像这样使用 JSTL 标签

```
 <c:url var="uri" value="${namespace}/${action}.action">                
                    <c:forEach items="${parameters}" var="p">
                        <c:param name="${p.key}" value="${p.value}"/>
                    </c:forEach>
</c:url>
<a href="${uri}">Your Link</a> 
```

我知道将 EL 与 OGNL 等混合使用会有些犹豫，但这很有效……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-09T16:56:59.903

您可以使用遍历地图

```
<s:url var="url" action="%{link}" >
  <s:iterator value="parameters.keySet()" var="key">
    <s:param name="%{key}" value="%{parameters.get(#key)}"/>
  </s:iterator>
</s:url> 
```

但迭代器将使用参数，因为它是参数的父组件。

查看[在 Struts2 中将任意参数添加到 URL 以](http://www.objectify.be/wordpress/?p=64)了解如何使用自定义标记执行此操作，这会导致类似的结果

```
<s:url var="url" action="%{link}" >
  <s:iterator value="parameters.keySet()" var="key">
    <ob:iterable-param name="%{key}" value="%{parameters.get(#key)}"/>
  </s:iterator>
</s:url> 
```

iterable-param 是一个自定义组件，它在父级是迭代器的情况下返回参数的祖父级。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-15T09:51:25.790

Parameter 标签仅将参数填充到其直接前身。在参数标记周围包装迭代器标记无效。:) 要解决这个问题，您可以轻松编写一个替代参数标签，它可以使用映射直接标签可能看起来像这样。

```
package my.taglibs;

import java.io.Writer;
import java.util.Map;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.struts2.components.Component;
import org.apache.struts2.views.jsp.ComponentTagSupport;
import com.opensymphony.xwork2.util.ValueStack;

public class ParamTag extends ComponentTagSupport {

    private String map;
    private static final long serialVersionUID = 2522878390854066408L;
    Log log = LogFactory.getLog(ParamTag.class);

    @Override
    public Component getBean(ValueStack stack, HttpServletRequest req, HttpServletResponse res) {
        return new Param(stack);
    }

    @Override
    protected void populateParams() {
        super.populateParams();

        Param param = (Param) component;
        param.setMap(map);
    }

    public void setMap(String map) {
        this.map = map;
    }

    public class Param extends Component {

        private String map; 

        public Param(ValueStack stack) {
            super(stack);
        }

        @Override
        public boolean end(Writer writer, String body) {
            Component component = findAncestor(Component.class);
            if (this.map == null) {       
                log.warn("Attribute map is mandatory.");
                return super.end(writer, "");
            }
            Object o = findValue(this.map); //find map in vs
            if(o == null) {
                log.warn("map not found in ValueStack");
                return super.end(writer, "");
            }
            if(!(o instanceof Map)) {
                log.warn("Error in JSP. Attribute map must evaluate to java.util.Map. Found type: " + o.getClass().getName());
                return super.end(writer, "");
            }

            component.addAllParameters((Map) o);
            return super.end(writer, "");
        }

        public void setMap(String map) {
            this.map = map;
        }
    }
} 
```

你需要一个相应的 tld-entry

```
<tag>
    <description><![CDATA[Parametrize other tags]]></description>
    <name>param</name>
    <tag-class>my.taglibs.ParamTag</tag-class>
    <body-content>JSP</body-content>
    <attribute>
        <name>map</name>
        <required>true</required>
        <rtexprvalue>true</rtexprvalue>
    </attribute>
    <dynamic-attributes>false</dynamic-attributes>
</tag> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-30T13:33:52.093

参考评论 3，请说明您将如何在您的 jsp 中使用此自定义标记来实现所需的行为。

另外，要使用评论 1 中提到的解决方案，我们需要在 tld 文件中执行什么条目？

请让我知道这一点。

# python - numpy 线性代数基本帮助

> ID：872376
> 
> 赞同：2
> 
> 时间：2009-05-16T12:53:23.127
> 
> 标签：python, numpy, scipy, linear-algebra, svd

这是我需要做的-

我有这个等式-

轴 = y

其中 A 是一个有理 m*n 矩阵 (m<=n)，x 和 y 是正确大小的向量。我知道A和y，我不知道x等于什么。我也知道在 Ax 正好等于 y 的地方没有 x。我想找到向量 x' 使得 Ax' 尽可能接近 y。这意味着 (Ax' - y) 尽可能接近 (0,0,0,...0)。

我知道我需要使用 lstsq 函数： [http ://www.scipy.org/doc/numpy_api_docs/numpy.linalg.linalg.html#lstsq](http://www.scipy.org/doc/numpy_api_docs/numpy.linalg.linalg.html#lstsq)

或 svd 函数： [http ://www.scipy.org/doc/numpy_api_docs/numpy.linalg.linalg.html#svd](http://www.scipy.org/doc/numpy_api_docs/numpy.linalg.linalg.html#svd)

我根本看不懂文档。有人可以告诉我如何使用这些功能来解决我的问题。

非常感谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T13:33:44.700

更新的[文档](http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.lstsq.html#numpy.linalg.lstsq)可能会更有帮助......看起来像你想要的

```
numpy.linalg.lstsq(A, y) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T13:34:35.790

SVD 适用于 m < n 的情况，因为您实际上没有足够的自由度。

lstsq 的文档看起来不是很有帮助。我相信这是最小二乘拟合，对于 m > n 的情况。

如果 m < n，您将需要[SVD](http://web.mit.edu/be.400/www/SVD/Singular_Value_Decomposition.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T13:37:08.153

矩阵 A 的 SVD 为您提供正交矩阵 U 和 V 以及对角矩阵 Σ，使得

**A** = **U** **Σ** **V** ^T

其中 **U** **U** ^T = **I** ; **V** **V** ^T =**我**

因此，如果

**x** **A** = **y**

然后

**x** **U** **Σ** **V** ^T = **y**

**x** **U** **Σ** **V** ^T **V** = **y** **V**

**x** **U** **Σ** = **y** **V**

**U** ^T **x** **Σ** = **y** **V**

**x** **Σ** = **U** **y** **V**

**x** = **Σ** ^(-1) **U** ^T **y** **V**

**x** = **V** ^T **Σ** ^(-1) **U** ^T **y**

**所以给定A 的**SVD你可以得到**x**。

* * *

尽管对于一般矩阵**AB** != **BA**，对于向量**x**来说**x U** == **U** ^T **x**是正确的。

例如，考虑**x** = ( x, y ), **U** = ( a, b ; c, d )：

**x** **U** = ( x, y ) ( a, b ; c, d )

= ( xa+yc, xb+yd )

= ( ax+cy, bx+dy )

= (a, c; b, d) (x; y)

= **U** ^T **x**

当您查看 x U 中的值是**x和** **U**的列的点积，以及**U** ^T **x**中的值 是**x**和 U T 的行**的****点****积**以及行的关系^时，这是相当明显的和换位的列

 ******# ruby - 如何通过 ssh 从 shell 命令显示进度条

> ID：872380
> 
> 赞同：3
> 
> 时间：2009-05-16T12:56:09.640
> 
> 标签：ruby, command-line, ssh

我有一个脚本，它应该在我的本地机器上模仿 ffmpeg，通过将命令发送到远程机器，在那里运行它然后返回结果。（参见[前面的*堆栈**溢出***问题。](https://stackoverflow.com/questions/871296/how-do-i-use-ffmpeg-on-a-remote-machine-via-ssh)）

```
#!/usr/bin/env ruby

require 'rubygems'
require 'net/ssh'
require 'net/sftp'
require 'highline/import'

file = ARGV[ ARGV.index( '-i' ) + 1] if ARGV.include?( '-i' )  
puts 'No input file specified' unless file;

host = "10.0.0.10"
user = "user"
prod = "new-#{file}"               # product filename (call it <file>-new)
rpath = "/home/#{user}/.rffmpeg"   # remote computer operating directory
rfile = "#{rpath}/#{file}"         # remote filename
rprod = "#{rpath}/#{prod}"         # remote product
cmd = "ffmpeg -i #{rfile} #{rprod}"# remote command, constructed

pass = ask("Password: ") { |q| q.echo = false }  # password from stdin

Net::SSH.start(host, user ) do |ssh|
        ssh.sftp.connect do |sftp|

                # upload local 'file' to remote 'rfile'
                sftp.upload!(file, rfile)

                # run remote command 'cmd' to produce 'rprod'
                ssh.exec!(cmd)

                # download remote 'rprod' to local 'prod'
                sftp.download!(rprod, prod)
        end
end 
```

* * *

**现在我的问题是**

```
ssh.exec!(cmd) 
```

我想将 cmd 的输出**实时**显示给本地用户。但是做起来

```
puts ssh.exec!(cmd) 
```

我只有在命令完成运行后才能得到结果输出。我将如何更改代码才能使其正常工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-20T17:36:42.527

在问题的显示方面，您可以使用 "\r" 字符串 char 在 Ruby 中生成更新进度条。这会将您备份到当前行的开头，允许您重新编写它。例如：

```
1.upto(100) { |i| sleep 0.05; print "\rPercent Complete #{i}%"} 
```

或者，如果您只想在屏幕上显示进度条，您可以简单地执行类似以下操作：

```
1.upto(50) { sleep 0.05; print "|"} 
```

此外，关于标准输出，除了根据前面的示例 (STDOUT.flush) 刷新输出之外，您还可以要求 Ruby 自动将写入同步到 IO 缓冲区（在本例中为 STDOUT）与相关的设备写入（基本上关闭内部缓冲）：

```
STDOUT.sync = true 
```

另外，我发现*有时*刷新对我不起作用，我改用“IO.fsync”。对我来说，这主要与文件系统工作有关，但值得了解。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T16:31:24.647

来自`ri Net::SSH::start`：

```
 -------------------------------------------------------- Net::SSH::start
      Net::SSH::start(host, user, options={}, &block) {|connection| ...}
 ------------------------------------------------------------------------
      The standard means of starting a new SSH connection. When used with
      a block, the connection will be closed when the block terminates,
      otherwise the connection will just be returned. The yielded (or
      returned) value will be an instance of
      Net::SSH::Connection::Session (q.v.). (See also
      Net::SSH::Connection::Channel and Net::SSH::Service::Forward.)

        Net::SSH.start("host", "user") do |ssh|
          ssh.exec! "cp /some/file /another/location"
          hostname = ssh.exec!("hostname")

          ssh.open_channel do |ch|
            ch.exec "sudo -p 'sudo password: ' ls" do |ch, success|
              abort "could not execute sudo ls" unless success

              ch.on_data do |ch, data|
                print data
                if data =~ /sudo password: /
                  ch.send_data("password\n")
                end
              end
            end
          end

          ssh.loop
        end 
```

所以看起来你可以通过使用获得更多的交互性`#open_channel`

这是一些示例代码：

```
user@server% cat echo.rb
#! /usr/local/bin/ruby
def putsf s
  puts s
  STDOUT.flush
end
putsf "hello"
5.times do
        putsf gets.chomp
end
putsf "goodbye" 
```

在您的本地机器上：

```
user@local% cat client.rb
#! /usr/local/bin/ruby
require 'rubygems'
require 'net/ssh'
words = %w{ earn more sessions by sleaving }
index = 0;
Net::SSH.start('server', 'user') do |ssh|
  ssh.open_channel do |ch|
    ch.exec './echo.rb' do |ch, success|
      abort "could not execute ./echo.rb" unless success

      ch.on_data do |ch, data|
        p [:data, data]
        index %= words.size
        ch.send_data( words[index] + "\n" )
        index += 1
      end
    end
  end
end
user@local% ./client.rb
[:data, "hello\n"]
[:data, "earn\n"]
[:data, "more\n"]
[:data, "sessions\n"]
[:data, "by\n"]
[:data, "sleaving\n"]
[:data, "goodbye\n"] 
```

因此，您可以通过这种方式与正在运行的进程进行交互。

正在运行的进程在请求输入之前刷新其输出很重要 - 否则，程序可能会挂起，因为通道可能没有收到未刷新的输出。

# windows - 如何在没有 WMI 的情况下获得唯一的机器签名？

> ID：872385
> 
> 赞同：3
> 
> 时间：2009-05-16T12:57:58.840
> 
> 标签：windows, uniqueidentifier, system-information

我知道已经问过一个关于为机器生成唯一 ID 的问题，但我的问题略有不同[。](https://stackoverflow.com/questions/99880/generating-a-unique-machine-id)

我想知道是否有任何其他方法（API 调用？）来获取硬件信息而不使用 WMI。我从[MSDN](http://msdn.microsoft.com/en-us/library/aa394582(VS.85).aspx)了解到 WMI 是在 Win2000 中引入的，所以它似乎在 Win98 中不可用。我有一个即使在 Win98 上也必须运行的应用程序（我知道这很糟糕，但你能做什么？）并且仍然掌握硬件信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T13:22:07.427

我已经为许可项目做了几次。对于硬盘驱动器序列号，请使用：

```
private static extern long GetVolumeInformation(string PathName, StringBuilder VolumeNameBuffer, UInt32 VolumeNameSize, ref UInt32 VolumeSerialNumber, ref UInt32 MaximumComponentLength, ref UInt32 FileSystemFlags, StringBuilder FileSystemNameBuffer, UInt32 FileSystemNameSize); 
```

使用`VolumeSerialNumber`函数返回的那个。

此外，您可能已经考虑过使用 Windows 产品 ID（位于`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\DigitalProductId`）。请注意，大量 Windows XP 用户拥有盗版副本并共享相同的产品密钥。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T13:10:52.587

您可以组合不同的硬件信息以创建唯一密钥。

例如，CPU ID、MAC 地址等。您检索它们、组合它们、加密它们，您就有了这台机器硬件设置的唯一表示。

尝试用谷歌搜索这个主题：如何阅读硬件信息。

据我所知，CodeProject 中有一篇非常有用的帖子：[How To Get Hardware Information (CPU ID, MainBoard Info, Hard Disk Serial, System Information, ...)](http://www.codeproject.com/KB/system/GetHardwareInformation.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T13:21:51.233

查看 WinAPI 的 kernel32 和 user32 库。它有各种各样的好东西，比如[`EnumDisplayDevices`](http://www.pinvoke.net/default.aspx/user32/EnumDisplayDevices.html), [`GetLogicalDrives`](http://www.pinvoke.net/default.aspx/kernel32/GetLogicalDrives.html), [`GlobalMemoryStatus`](http://www.pinvoke.net/default.aspx/kernel32/GlobalMemoryStatus.html), [`GetVolumeInformation`](http://www.pinvoke.net/default.aspx/kernel32.GetVolumeInformation), 等等。我喜欢使用[PInvoke](http://pinvoke.net)来浏览 API，因为它为我提供了 C# 包装器代码 - 但 MSDN 在 Windows SDK 中也将拥有这一切。

@novatrust 关于硬盘序列的答案是一个很好的答案 - 但可以与更多相结合。我已经在`GetVolumeInformation`上面提供了 pinvoke 的 API 链接，但是一个简单的 Google 也应该可以工作。

# php - 如何确定访问者的ip？

> ID：872386
> 
> 赞同：2
> 
> 时间：2009-05-16T12:58:14.567
> 
> 标签：php, security, ip, spam-prevention, spam

我有一个博客聚合网站

故事按访问次数排序

我想我正面临垃圾访问

因为有些博客的故事会在同一秒内通过传出的 IP 地址获得大量访问

我的网站不允许来自同一个 IP 的访问；然而，我的访问者不知何故改变了他们的 ips。

他们有什么解决方案来检测这种垃圾邮件访问吗？我想知道 Google adSense 是如何解决这样的问题的？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T13:05:12.257

简短的回答是，如果一次未经证实的访问是改变故事顺序所需的唯一事情，就不可能阻止坚定的攻击者。您可能需要考虑实施注册用户投票系统。

但是，您可以收集几条信息并将它们全部组合起来：

1) 用户代理
2) IP 地址
3) X-Forwarded-For 标头（如果可用）

很多时候，攻击者会很懒惰，不会循环访问不同的用户代理。如果您将系统设置为以特定时间间隔（而不是实时）处理访问信息，您可能会过滤掉使用相同用户代理同时发生的大量访问。

您可以随时从 antiproxy.com 等网站下载代理数据库，但事实是，当今大多数精心策划的攻击都来自尚未记录的僵尸网络节点。您的网站完全有可能成为与普通访问者无法区分的异构流量攻击的目标。

至少，我建议更改您的实现，以便用户可以对故事进行投票并需要验证码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T13:05:59.447

使用 PHP，您可以对照 IP 地址检查 $_SERVER ["HTTP_X_FORWARDED_FOR"] 变量，以更加确定客户端就是他所说的那个人。这将有助于通过一些代理识别人员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T13:20:42.750

我有时会使用这个功能。但正如其他人所说，很难 100% 地获得正确的 IP。

我不记得我从哪里得到这个功能，但它似乎在互联网上相当普遍。

```
function getRealIpAddr()
{
    if (!empty($_SERVER['HTTP_CLIENT_IP']))   
    {
      $ip=$_SERVER['HTTP_CLIENT_IP'];
    }
    elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR']))
    {
      $ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
    }
    else
    {
      $ip=$_SERVER['REMOTE_ADDR'];
    }
    return $ip;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T13:07:31.737

您无法可靠地检测 IP。

它可能来自代理，也可能被欺骗。

# flash - papervision3d 如何转换纹理？

> ID：872387
> 
> 赞同：1
> 
> 时间：2009-05-16T12:58:30.120
> 
> 标签：flash, actionscript-3, 3d, papervision3d

最终，[papervision3d](http://www.papervision3d.org/)（流行的 Flash 3D 渲染包）如何将转换后的纹理绘制到屏幕上？

它是在内部使用 Flash 的任何渲染设备 - 即通过将纹理绘制到 DisplayObjects 并转换它们，还是使用 3D MovieClips？或者也许是过滤器？或者它最终只是从纹理中读取像素并将它们绘制到输出中，就像您在任何软件平台中所做的那样？

我问是因为直截了当的答案是后一个，但经过一些测试后，这种方法似乎`getPixel`并不`setPixel`够快，所以似乎一定有更神秘的事情发生。

感谢您提供任何信息！

**编辑 - 我对答案的总结**：Papervision 本身不做透视变换。它只会对每个纹理三角形进行缩放和倾斜变换，如果使用足够多的三角形，就会出现透视错觉。仿射变换使用 Flash 的渲染设备，因此避免了昂贵的像素操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T16:17:49.813

这一切都是使用绘图 API 呈现的。(lineTo) 使用绘图 API，您可以设置 bitmapFill ratehr 而不是颜色，这允许您绘制纹理。在内部，它们将您作为纹理传入的每个资产转换为渲染时使用的 BitmapData 对象。然后，对于您的 3D 对象所具有的任何细分（三角形），它们预先对其进行转换以获得正确的视角。

这种方法仍然是处理器密集型的，但比设置每个像素更快。它的工作原理与其他 3D 渲染软件非常相似，使用专门为 ActionScript 构建的 smae 技术和理论。

# html - HTML img 标签：title 属性与 alt 属性？

> ID：872389
> 
> 赞同：121
> 
> 时间：2009-05-16T13:00:06.747
> 
> 标签：html, accessibility, alt

我在浏览[亚马逊](https://www.amazon.com)时注意到，在搜​​索“ [1TB](http://www.amazon.com/s/ref=nb_ss_gw?url=search-alias%3Daps&field-keywords=1TB) ”时，如果您将鼠标光标悬停在星级评分图像上，您只能在使用 IE 时看到分数。如果您使用其他浏览器，则不会显示分数。

3.8 分和 4.2 分都显示为 4 星。当然，3.8 星对 4.2 星（76% 对 84% 的分数）可能会有所作为！

这是因为显示`alt`文本的标准方式是仅当用户关闭图形或“读出”浏览器时（例如，视觉障碍用户的浏览器）。然而，IE 在悬停时显示它。

所以我认为如果亚马逊要不管用户的浏览器来展示它，那么`title`应该除了`alt`. 你会同意吗？

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2009-05-16T13:08:27.443

它们用于不同的事情。使用`alt`属性**而不是**图像。如果图像无法显示，并且在屏幕阅读器中。

该`title`属性与图像**一起**显示，通常作为悬停工具提示。

不应该使用一个来“代替”另一个。每个都应该被*正确*使用，去做他们被设计做的事情。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-05-16T13:06:16.840

我两个都去。标题将在所有浏览器中显示一个不错的工具提示，而在没有图像的浏览器中浏览时，alt 将给出描述。

也就是说，我很想看看有多少“冲浪者”去“商店”浏览商品实际上已关闭图像或使用不支持图像的浏览器。我认为 90% 的人口使用 28k 调制解调器连接到 InterWeb 的日子已经过去了。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-16T21:46:43.577

**如前所述，**alt**和**title用于不同的事物。**虽然**title**属性将提供工具提示，但**alt**也是一个重要属性，因为它指定了在图像无法显示时要显示的文本。（在某些浏览器中，例如 firefox，您还会在图像加载时看到此文*本*）**

 **我认为应该说明的另一点是**alt**属性*需要*作为 XHTML 文档进行验证，而**title**属性实际上只是一个“额外选项”。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-16T13:09:26.410

那是因为它们服务于不同的目的，并且它们都应该被使用，而不仅仅是一个在另一个之上。

“alt”是你们已经说过的，所以如果图像无法显示（无论出于何种原因），你可以看到它的全部内容，它还可以让视障人士理解图像的内容。

“title”属性是显示带有图像标题的工具提示的正确属性。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-16T13:07:55.337

在我看来，替代文字是否应该始终描述图片中可见的内容，以防图像未显示。

> alt = text [CS] 对于无法显示图像、表单或小程序的用户代理，此属性指定替代文本。替代文本的语言由 lang 属性指定。

[w3.org](http://www.w3.org/TR/REC-html40/struct/objects.html#h-13.8)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-16T21:37:31.307

我相信 alt 是严格遵守 XHTML 所必需的。

正如其他人所指出的，title 用于工具提示（很高兴拥有），alt 用于可访问性。两者都使用没有错，但 alt 应该始终存在。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-02-28T09:32:57.520

**[ALT 属性](https://www.w3.org/QA/Tips/altAttribute)**

该`alt`属性在一组标记中定义（即 ，`img`以及`area`可选的`input`和`applet`），以允许您为对象提供等效的文本。

在以下常见情况下，文本等效项为您的网站及其访问者带来以下好处：

*   如今，Web 浏览器可以在各种平台上使用，而且容量也各不相同；有些根本无法显示图像或仅显示有限的一组图像；有些可以配置为不加载图像。如果您的代码在其图像中设置了 alt 属性，则大多数浏览器将显示您提供的描述而不是图像
*   您的一些访问者看不到图像，他们可能是盲人、色盲、弱视者；alt 属性对于那些可以依靠它来很好地了解您页面上的内容的人有很大帮助
*   搜索引擎机器人属于上述两个类别：如果您希望您的网站得到应有的索引，请使用 alt 属性以确保它们不会错过您页面的重要部分。

**[标题属性](https://www.w3.org/TR/WCAG20-TECHS/H65.html)**

该技术的目的是通过在`title`属性中提供帮助信息，为用户在表单中输入数据时提供上下文相关帮助。帮助可能包括格式信息或输入示例。

*示例 1：限制搜索范围的*
下拉菜单 搜索表单使用下拉菜单来限制搜索范围。下拉菜单紧邻用于输入搜索词的文本字段。搜索字段和下拉菜单之间的关系对于可以看到视觉设计的用户来说是很清楚的，它没有空间放置可见的标签。该`title`属性用于标识`select`菜单。该`title`属性可以由屏幕阅读器朗读，也可以作为工具提示显示给使用屏幕放大镜的人。

```
<label for="searchTerm">Search for:</label>
<input id="searchTerm" type="text" size="30" value="" name="searchTerm">
<select title="Search in" id="scope">
    ...
</select> 
```

*示例 2：电话号码的输入字段*
网页包含用于在美国输入电话号码的控件，其中包括区号、交换和最后四位数字的三个字段。

```
<fieldset>
    <legend>Phone number</legend>
    <input id="areaCode" name="areaCode" title="Area Code" type="text" size="3" value="" >
    <input id="exchange" name="exchange" title="First three digits of phone number" type="text" size="3" value="" >
    <input id="lastDigits" name="lastDigits" title="Last four digits of phone number" type="text" size="4" value="" >
</fieldset> 
```

*示例 3：搜索功能* 网页包含一个文本字段，用户可以在其中输入搜索词和一个标记为“搜索”的按钮，用于执行搜索。该`title`属性用于标识表单控件，并且按钮位于文本字段之后，以便用户清楚地知道文本字段是应输入搜索词的位置。

```
<input type="text" title="Type search term here"/> <input type="submit" value="Search"/> 
```

*示例 4：表单控件*
的数据表 表单控件的数据表需要将每个控件与该单元格的列标题和行标题相关联。如果没有标题（或屏幕外标签），非视觉用户很难在表单中使用其辅助技术暂停和询问相应的行/列标题值。

例如，调查表在第一行有四个列标题：问题、同意、未决定、不同意。接下来的每一行在每个单元格中都包含一个问题和一个单选按钮，对应于三列中的答案选择。每个单选按钮的标题属性是答案选项（列标题）和问题文本（行标题）的串联，其中连字符或冒号作为分隔符。

**[图像元素](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img)**

[MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img)中提到的允许属性。

*   `alt`
*   `crossorigin`
*   `decoding`
*   `height`
*   `importance`（实验API）
*   `intrinsicsize`（实验API）
*   `ismap`
*   `referrerpolicy`（实验API）
*   `src`
*   `srcset`
*   `width`
*   `usemap`

如您所见，元素`title`内不允许使用属性。`img`我会使用`alt`属性，如果需要，我会使用 CSS（例如：伪类`:hover`）而不是`title`属性。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-08-15T09:33:25.283

您不应该对 img 元素使用 title 属性。这背后的原因很简单：

> 据推测，字幕信息是默认情况下应该对所有用户都可用的重要信息。如果是这样，则将此内容显示为图像旁边的文本。

**来源：** [http ://blog.paciellogroup.com/2010/11/using-the-html-title-attribute/](http://blog.paciellogroup.com/2010/11/using-the-html-title-attribute/)

**HTML 5.1**包含有关使用 title 属性的一般建议：

> 目前不鼓励依赖 title 属性，因为许多用户代理没有按照本规范的要求以可访问的方式公开该属性（例如，需要鼠标等指针设备来显示工具提示，这不包括仅使用键盘的用户和仅触摸的用户，例如拥有现代手机或平板电脑的任何人）。

**来源：** [http ://www.w3.org/html/wg/drafts/html/master/dom.html#the-title-attribute](http://www.w3.org/html/wg/drafts/html/master/dom.html#the-title-attribute)

谈到可访问性和不同的屏幕阅读器：

*   Jaws 10-11：默认关闭
*   Window-Eyes 7.02：默认开启
*   NVDA：不支持（无支持选项）
*   VoiceOver：不支持（无支持选项）

因此，正如[Denis Boudreau](http://twitter.com/dboudreau)充分指出的那样：**显然不是推荐的做法**。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-10-01T21:21:12.100

ALT 属性适用于将使用屏幕阅读器的视障用户。如果任何图像标记中缺少 ALT，则将读取图像的整个 url。如果图像是网站设计的一部分，它们应该仍然有 ALT，但它们可以留空，这样就不必为网站的每个部分读取 url。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-02-27T06:06:40.233

我总是会同时使用 the`alt`和`title`属性。它们各自用于不同的目的：`alt`用于丢失图像的图像替换、缓慢的图像下载或辅助技术，而`title`用于翻转交互和附加图像描述。

此外，在 HTML5 中，您应该开始使用包含完整**WPA-ARIA**`picture`属性的新 HTML5元素，以获得更好的可访问性，以及对辅助技术、屏幕阅读器等的支持。因为这个元素在许多旧浏览器中不受支持......但是会优雅地降级......我现在推荐以下 HTML 设计模式用于 HTML 中的图像：`figure`

 **```
<figure aria-labelledby="picturecaption2">
    <picture id="picture2">
        <source srcset="image.webp" type="image/webp" media="(min-width: 800px)" />
        <source srcset="image.gif" type="image/gif" />
        <img id="image2" style="height:auto;max-width: 100%;" src="image.jpg" width="255" height="200" alt="image:The World Wide Web" title="The World Wide Web" loading="lazy" no-referrer="no-referrer" onerror="this.onerror=null;" />
    </picture>
    <figcaption id="picturecaption2"><small>"My Cool Picture" [<a href="http://creativecommons.org/licenses/" target="_blank">A License</a>] , via <a href="https://commons.wikimedia.org/wiki/" target="_blank">Wikimedia Commons</a></small></figcaption>
</figure> 
```

上面的代码还有很多额外的“好东西” `alt`，`title`包括 ARIA 属性、对 WebP 的支持、支持更高分辨率图像的媒体查询以及支持旧图像格式的不错的后备模式。它显示了一个完全装饰的图像示例，该示例使用新技术，同时仍支持具有渐进式设计模式的旧技术。

20 多年来，许多开发人员一直在使用这种模式来处理 IE 和其他问题。所以这不是新知识。它刚刚被没有费心从过去学习的新开发人员重新发现。

记住...永远支持老浏览器！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-16T13:02:50.843

不，我认为`alt`更好，因为该属性的目的是在无法查看图像的情况下提供“替代”文本（无论是图像丢失还是浏览器本身无法显示它）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-07-31T01:18:37.033

ASP.NET MVC 的 MVCFutures 决定两者都做。事实上，如果您提供“alt”，它会自动为您创建一个具有相同值的“标题”。

我手头没有源代码，但是通过谷歌快速搜索找到了一个测试用例！

```
 [TestMethod]
    public void ImageWithAltValueInObjectDictionaryRendersImageWithAltAndTitleTag() {
        HtmlHelper html = TestHelper.GetHtmlHelper(new ViewDataDictionary());
        string imageResult = html.Image("/system/web/mvc.jpg", new { alt = "this is an alt value" });
        Assert.AreEqual("<img alt=\"this is an alt value\" src=\"/system/web/mvc.jpg\" title=\"this is an alt value\" />", imageResult);
    } 
```

# matplotlib - Matplotlib：图例未正确显示

> ID：872397
> 
> 赞同：5
> 
> 时间：2009-05-16T13:02:59.047
> 
> 标签：matplotlib

我有想要可视化的不同类的数据点。这是我得到的图像：http: [//imgur.com/1x97h](https://imgur.com/1x97h)

有 10 个类别的 3000 个数据点，每个类别 300 个。它们连接在一个数组`d`中，我在其块上迭代。标签在 中给出`labels`。

```
pylab.clf()
colors = (i + j for j in 'o<.' for i in 'bgrcmyk')
for l, c  in zip(labels, colors):
  start, stop = i * 300, (i + 1) * 300
  pylab.plot(d[0, start:stop], d[1, start:stop], c, label=l)

pylab.legend(loc='lower left')
pylab.show() 
```

有谁知道为什么我的传奇被搞砸了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T14:34:13.570

拥有一个独立的示例会有所帮助，可能带有虚构的数据，因此人们可以立即运行它。这是一个独立的示例，根据您发布的内容进行了修改，对我来说效果很好，`ipython -pylab`最近对 Matplotlib 进行了 svn 修订；我认为最近修复了一些与传说相关的错误。

```
colors = (i + j for j in 'o<.' for i in 'bgrcmyk')
labels = 'one two three four five six seven eight nine ten'.split()
x = linspace(0, 2*pi, 3000)
d = (2+random((2,3000))) * c_[sin(x), cos(x)].T
for i, l, c  in zip(range(10), labels, colors):
    start, stop = i * 300, (i + 1) * 300
    plot(d[0, start:stop], d[1, start:stop], c, label=l)
legend(loc='lower left')
show() 
```

这就是我得到的：

[示例图 http://www.iki.fi/jks/tmp/legend.png](http://www.iki.fi/jks/tmp/legend.png)

假设该错误与自动图例功能有关，您可以通过明确说明您在图例中想要的内容来解决它：

```
colors = (i + j for j in 'o<.' for i in 'bgrcmyk')
labels = 'one two three four five six seven eight nine ten'.split()
x = linspace(0, 2*pi, 3000)
d = (2+random((2,3000))) * c_[sin(x), cos(x)].T
lg = []
for i, l, c  in zip(range(10), labels, colors):
    start, stop = i * 300, (i + 1) * 300
    handle = plot(d[0, start:stop], d[1, start:stop], c, label=l)
    lg.append(handle)
legend(lg, labels, loc='lower left')
show() 
```

# sql-server - 从 SQL 数据库突然延迟问题中查询实时数据

> ID：872400
> 
> 赞同：1
> 
> 时间：2009-05-16T13:05:32.800
> 
> 标签：sql-server, database, real-time

我们正在测试一个应用程序，该应用程序应该在 1 秒内为多个用户显示实时数据。服务器应用程序每秒将 128 行的新数据插入 SQL 数据库，然后所有用户必须查询它以及另一个旧的参考 128 行。

我们测试了查询时间，没有超过 30 毫秒；调用查询的接口函数处理数据的时间也不超过 50 毫秒，所有

我们开发了一个测试应用程序，它为每个用户创建一个线程和一个 SQL 连接。用户每 1 秒发出 7 个查询。一切都很好，没有用户花费超过 300 毫秒的 7 个数据系列（查询）。但是，10 分钟后，延迟超过 1 秒，并且还在不断增加。我们不知道问题是否来自 SQL server 2008 同时处理多个请求，以及如何克服这样的问题。

如果可能有帮助，这是我们的测试客户端。请注意，客户端和服务器是在同一台具有 8 GB RAM 的 8 CPU 机器上制作的。现在我们质疑数据库是否可能不是我们的最佳解决方案。

```
 class Program
{
    static void Main(string[] args)
    {   
        Console.WriteLine("Enter  Number of threads");
        int threads = int.Parse(Console.ReadLine());
        ArrayList l = new ArrayList();
        for (int i = 0; i < threads; i++)
        {
            User u = new User();
            Thread th = new Thread(u.Start);
            th.IsBackground = true;
            th.Start();
            l.Add(u);
            l.Add(th);
        }
        Thread.CurrentThread.Join();
        GC.KeepAlive(l);
    }
}
class User
{
    BusinessServer client ; // the data base interface dll
    public static int usernumber =0 ;

    static TextWriter log;
    public User()
    {
        client = new BusinessServer(); // creates an SQL connection in the constructor
        Interlocked.Increment(ref usernumber);
    }

    public static void SetLog(int processnumber)
    {
        log = TextWriter.Synchronized(new StreamWriter(processnumber + ".txt"));
    }
    public void Start()
    {
        Dictionary<short, symbolStruct> companiesdic = client.getSymbolData();
        short [] symbolids=companiesdic.Keys.ToArray();
        Stopwatch sw = new Stopwatch();
        while (true)
        {

            int current;
            sw.Start();
            current = client.getMaxCurrentBarTime();
            for (int j = 0; j < 7; j++)
            {   
                client.getValueAverage(dataType.mv, symbolids,
                    action.Add, actionType.Buy,
                    calculationType.type1,
                    weightType.freeFloatingShares, null, 10, current, functionBehaviour.difference); // this is the function that has the queries

            }
            sw.Stop();
            Console.WriteLine(DateTime.Now.ToString("hh:mm:ss") + "\t" + sw.ElapsedMilliseconds);
            if (sw.ElapsedMilliseconds > 1000)
            {
                Console.WriteLine("warning");
            }
            sw.Reset();

            long diff = 0;//(1000 - sw.ElapsedMilliseconds);
            long sleep = diff > 0 ? diff : 1000;
            Thread.Sleep((int)sleep);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T16:46:27.997

Warning: this answer is based on knowledge of MSSQL 2000 - not sure if it is still correct.

If you do a lot of inserts, the indexes will eventually get out of date and the server will automatically switch to table scans until the indexes are rebuilt. Some of this is done automatically, but you may want to force reindexing periodically if this kind of performance is critical.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T14:31:22.063

I would suspect the query itself. While it may not take much time on an empty database, as the amount of data grows it may require more and more time depending on how the look up is done. Have you examined the query plan to make sure that it is doing index lookups instead of table scans to find the data? If not, perhaps introducing some indexes would help.

# c# - 温莎城堡解析和泛型

> ID：872413
> 
> 赞同：6
> 
> 时间：2009-05-16T13:15:00.923
> 
> 标签：c#, .net, inversion-of-control, castle-windsor

我有以下内容：

```
public interface ISubject { ... }

public class Subject<T> : ISubject { ... }

public class MyCode<T> {
    ...
    pulic void MyMethod()
    {
        var item = container.Resolve<ISubject>(); //????? how do I pass in T
    }
    ... 
 } 
```

在这种情况下，我该如何解决。

干杯安东尼

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-16T13:48:19.593

vdhant - 这不是容器的使用方式。

你想用`ISubject`，对吧？然后，如果你通过了 T，你就打破了你的抽象，因为你的调用者必须知道`ISubject`, 实际上是一个 Subject，而且更重要的是，它是 a`Subject<T>`并且它需要一个具体的 T。

没有容器会允许这样做，但这是一个设计问题，而不是工具问题。

修复您的设计的一件事是使其明确 - 更改`ISubject`为`ISubject<T>`

然后你可以注册 open generic type`ISubject<>`并将其绑定到 open generic type `Subject<>`。

```
container.Register(Component.For(typeof(ISubject<>))
                            .ImplementedBy(typeof(Subject<>))); 
```

然后你就可以做

```
var fooSubject = container.Resolve<ISubject<Foo>>(); 
```

You didn't provide any context so I may be off the track with the answer, but one thing is for sure - you have a design problem.

# c++ - 使用 -pthreads 为 Openwrt Linux 编译 C++ - 获取分段错误

> ID：872414
> 
> 赞同：2
> 
> 时间：2009-05-16T13:15:02.483
> 
> 标签：c++, linux, embedded, pthreads, segmentation-fault

我对 C++ 编程很陌生，我正在使用 pthreads。我正在为 OpenWRT 交叉编译我的代码，但由于某种原因，当我在我的板上运行程序时出现分段错误，但它在我的 PC 上运行良好。我怀疑错误发生在编译的链接阶段，因为我尝试了一个小的 C 程序并且效果很好。此外，如果我将文件名更改为 .cpp 并使用 g++ 编译它也可以工作。

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>

void *run(void *dummyPtr) {
    printf("I am a thread...\n");
    return NULL;
}

int main(int argc, char **argv) {
    printf("Main start...\n");
    pthread_t connector;
    pthread_create(&connector, NULL, run, NULL);
    printf("Main end...\n");
    return 0;
} 
```

eclipse编译器的输出：

```
**** Build of configuration Release for project ThreadTest ****

make all 
Building file: ../src/ThreadTest.cpp
Invoking: GCC C++ Compiler
mipsel-linux-g++ -O3 -Wall -c -fmessage-length=0 -MMD -MP -MF"src/ThreadTest.d" -MT"src/ThreadTest.d" -o"src/ThreadTest.o" "../src/ThreadTest.cpp" -lpthread
mipsel-linux-g++: -lpthread: linker input file unused because linking not done
Finished building: ../src/ThreadTest.cpp

Building target: ThreadTest
Invoking: GCC C++ Linker
mipsel-linux-g++  -o"ThreadTest"  ./src/ThreadTest.o    -lpthread -static
Finished building target: ThreadTest 
```

编辑：删除旧代码并放入一个新的更简单的示例。如果我将其编译为 C 程序，则此代码会运行，但如果我将其编译为 C++ 程序则不会。我在板上运行 2.6.26.3 内核。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T07:10:00.607

这很可能是由于内存不足造成的。您应该尝试启用某种形式的页面文件并释放任何其他内存。

另外，为什么是-static？如果您使用动态`-lpthread`，链接共享库不是更可取吗？

此外，这可能是由于您的 C++ lib 不匹配，请确保您`uclibc++`的版本正确，如果您还没有安装 ldd，您可能还想安装。取决于你的固件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T13:28:45.273

的正确声明`main()`是

```
int main(int argc, char **argv) 
```

**编辑以更正此答案：**

这是因为 .c 的 compile -c 行包含 -lpthread: 未使用的链接器输入文件

我找到了关于在 openwrt 上编译 c++ 程序的答案：

[http://manoftoday.wordpress.com/2007/10/11/writing-and-compiling-a-simple-program-for-openwrt/](http://manoftoday.wordpress.com/2007/10/11/writing-and-compiling-a-simple-program-for-openwrt/)

我认为您还需要阅读此内容以使 gdb 正常工作：

[http://forum.openwrt.org/viewtopic.php?pid=29712](http://forum.openwrt.org/viewtopic.php?pid=29712)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T08:29:06.937

使用 -lpthread 对 pthread 进行简单链接是不够的。您需要 gcc -pthread（作为它自己的选项）或 gcc -D_REENTRANT -lpthread（定义一个名为 _REENTRANT 的符号）。我不知道这是否会影响任何事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-30T04:49:25.470

我不知道您是否找到了答案，或者这是否是问题所在，但您显示的代码中存在竞争条件。main 可能会返回，并且您的程序将尝试在您的“运行”线程完成运行之前退出。你永远不能假设它会以任何特定的顺序或任何特定的时间运行。您应该添加对 pthread_join(connector, NULL); 的调用 在从主要返回之前。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-11T14:38:37.917

在从 main 返回并退出程序之前，您应该做一个

```
pthread_join(connector, NULL); 
```

这避免了在线程终止之前退出您的应用程序。

# database - 在哪里可以找到适用于 mysql 的免费开源 dbexpress 驱动程序

> ID：872419
> 
> 赞同：1
> 
> 时间：2009-05-16T13:17:29.357
> 
> 标签：database, delphi, driver, dbexpress

我需要一个用于 mysql 的 dbx 驱动程序。它应该是免费的。开源受到赞赏。（德尔福 7+ 和 mysql 5+）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T16:10:15.930

看看[这个](http://www.justsoftwaresolutions.co.uk/delphi/dbexpress_and_mysql_5.html)_

MySQL V5.0 的 DbExpress 驱动程序

在 Delphi 2007 之前，Borland 为 MySQL 提供的 dbExpress 驱动程序只能工作到 MySQL V4.0 版本，尽管 V5.0 版本变得越来越流行，而 V5.1 现在处于测试阶段。Just Software Solutions dbxOpenMySQL5 驱动程序为绝大多数情况提供了一个直接替代，允许轻松过渡到更新版本的 MySQL。具有 LGPL 许可证

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T13:50:02.290

我在[这里](https://sourceforge.net/projects/open-dbexpress/)找到了这个 （事实上它不是真正的 MySQL，而是通过 ODBC 的 MySQL，我从不测试它们）

我也发现[了这个](https://sourceforge.net/projects/mysql-dbx/)，但似乎没有维护......

但即使 dbExpress 可以开源和免费，MySQL 也只有在...

# php - unsigned int 以登录 php

> ID：872424
> 
> 赞同：7
> 
> 时间：2009-05-16T13:19:34.030
> 
> 标签：php, math, absolute-value

看来，在 32 位操作系统中`ip2long`返回有符号整数，而在 64 位操作系统中返回无符号整数。

我的应用程序在 10 台服务器上运行，有些是 32 位的，有些是 64 位的，所以我需要它们都以相同的方式工作。

在 PHP 文档中，有一个技巧可以使结果始终未签名，但是由于我的数据库已经充满了数据，所以我想对其进行签名。

那么如何在 PHP 中将 unsigned int 更改为已签名的 int 呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-16T14:01:30.123

PHP 不支持无符号整数作为一种类型，但您可以简单地将[ip2long](http://php.net/ip2long)的结果转换为无符号 int*字符串*，方法是让[sprintf](http://php.net/sprintf)将值解释为 unsigned with `%u`：

```
 $ip="128.1.2.3";
 $signed=ip2long($ip);             // -2147417597 in this example
 $unsigned=sprintf("%u", $signed); //  2147549699 in this example 
```

编辑，因为您真的希望即使在 64 位系统上也能对其进行签名 - 这是您将 64 位 +ve 值转换为 32 位签名等效项的方法：

```
$ip = ip2long($ip);
if (PHP_INT_SIZE == 8)
{
    if ($ip>0x7FFFFFFF)
    {
        $ip-=0x100000000;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-05T20:33:01.133

Fwiw, if you're using MySQL it's usually a lot easier and cleaner if you just pass in the IPs as strings to the database, and let MySQL do the conversion using INET_ATON() (when INSERTing/UPDAT(E)'ing) and INET_NTOA() (when SELECTing). MySQL does not have any of the problems described here.

Examples:

```
SELECT INET_NTOA(ip_column) FROM t;

INSERT INTO t (ip_column) VALUES (INET_ATON('10.0.0.1')); 
```

The queries are also much more readable.

Note that you can **not** mix INET_NTOA()/INET_ATON() in MySQL with ip2long()/long2ip() in PHP, since MySQL uses an INT UNSIGNED datatype, while PHP uses a **signed** integer. Mixing signed and unsigned integers will seriously mess up your data!

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T22:00:43.140

interpreting an integer value as signed int on 32 and 64 bit systems:

```
function signedint32($value) {
    $i = (int)$value;
    if (PHP_INT_SIZE > 4)   // e.g. php 64bit
        if($i & 0x80000000) // is negative
            return $i - 0x100000000;
    return $i;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T14:14:47.330

- 被误解的问题，请参阅上面 Paul Dixon 的回答。

* * *

PHP5 在技术上不支持 64 位无符号整数。它将使用本机类型。要从 64 位有符号 int 转换为 32 位有符号 int 而不会丢失高位，您可以屏蔽然后键入 cast 输出：

```
$ip_int = ip2long($ip);
if (PHP_INT_SIZE == 8) // 64bit native
{
  $temp_int = (int)(0x7FFFFFFF & $ip_int);
  $temp_int |= (int)(0x80000000 & ($ip_int >> 32));
  $ip_int = $temp_int;
} 
```

在 64 位系统上，打印此值 ($ip_int) 将显示一个“无符号”整数，因为我们已经删除了高位。但是，这应该允许您获取输出并按照您的意愿存储它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-05T21:26:00.270

```
public function unsigned2signed($num) {     // converts unsigned integer to signed
    $res = pack('i',$num);                  // change to 'l' to handle longs
    $res = unpack('i',$res)[1];
    return $res;
} 
```

# internet-explorer - 在 IE 中缩放图像

> ID：872432
> 
> 赞同：3
> 
> 时间：2009-05-16T13:25:38.883
> 
> 标签：internet-explorer, image, filter

我的页面包含如下示例中的图像。图像的宽度取决于浏览器的宽度和高度正在自动更改（类似于 ）。

在除 IE 之外的所有浏览器中调整大小后，此图像看起来不错（我在 IE7 和 IE6 中测试过）。在 IE 中图像看起来很难看。有些零件比应有的厚，有些零件更薄。

[替代文字 http://img39.imageshack.us/img39/7202/88017917.png](http://img39.imageshack.us/img39/7202/88017917.png)

我几乎可以肯定这是由于 IE 不使用平滑。但我想知道如何解决这个不愉快的问题？

* * *

我没有ie7，但这段代码在那里应该可以正常工作。但是如何为ie6修复它？

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <style type="text/css">
    img { -ms-interpolation-mode:bicubic; }
  </style>
</head>
<body>
  <div style="width: 50%;">
    <img src="pp.jpg" width="100%">
  </div>
</body>
</html> 
```

[来自 flickr 开发人员：](http://code.flickr.com/blog/2008/11/12/on-ui-quality-the-little-things-client-side-image-resizing/)

> IE 6 是一个风险更高的提议，但在应用 AlphaImageLoader CSS 过滤器时可以显示改进的图像大小调整，该过滤器通常用于正确显示具有 alpha 透明度的 PNG。例如 filter:progid:DXImageTransform.Microsoft.AlphaImageLoader (src='/path/to/image.jpg', sizingMethod='scale');。虽然此处没有应用透明度，但应用的调整大小方法可提供更高质量的结果。

我还不能让它工作，实际上我从来没有使用过过滤器。也许任何人都可以给我工作代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T13:28:32.870

Joel Spolsky 最近在这个博客上发布了一个解决方案：http: [//www.joelonsoftware.com/items/2008/12/22.html](http://www.joelonsoftware.com/items/2008/12/22.html)

将以下内容添加到 CSS 中：

```
img { -ms-interpolation-mode:bicubic; } 
```

最好的解决方案是使用不需要被浏览器缩放的图像，但 CSS Joel 建议有很大的改进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T15:46:34.600

[Unstoppable Robot Ninja](http://unstoppablerobotninja.com/entry/fluid-images/)有一篇文章，其中包含更多信息和一些代码，可以使其在 IE6 和 IE7 上运行。

问题不是特定于 IE，而是特定于平台。Firefox、Safari 等都使用自己的渲染引擎，其缩放比原生 Windows 缩放更平滑。

我建议在[Conditional Comments](http://www.quirksmode.org/css/condcom.html)中添加 CSS 声明或 JavaScript 代码，这样非 IE 浏览器就不必下载额外的代码或发出另一个请求。这也让你的 CSS 保持干净和有效。

# jquery - 使用 ASP.NET MVC 和 JQuery 如何在加载时为列表中的每个项目运行 JS 函数？

> ID：872434
> 
> 赞同：0
> 
> 时间：2009-05-16T13:26:38.460
> 
> 标签：jquery, asp.net-mvc

想象一个旨在显示*Foo*类型的项目列表的视图：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<IEnumerable<Foo>>" %> 
```

*现在页面显示Foo*类型的项目列表：

```
<table>
        <tr>
            <th>
                Name
            </th>
        </tr>

    <% foreach (var item in Model) { %>
        <tr>
            <td>
                <%= Html.Encode(item.Name) %>
            </td>
        </tr>
    <% } %>
</table> 
```

除了在页面上显示项目列表之外，我还需要为每个项目执行一个 Javascript 函数*Bar*。这是我的第一次尝试：

```
<% foreach (var item in Model) { %>
<script type="text/javascript">

    $(document).ready(function() {
        var name = "<%=item.Name %>";
        Bar(name)
    });

</script>
<% } %> 
```

针对以“ *var name...* ”开头的行出现错误“*无法解析符号项*”。

 *这是实现这一目标的正确方法吗？使用的正确语法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T13:28:55.770

尝试这样的事情：

```
<script type="text/javascript">
    $(document).ready(function() {
        $("table tr td").each(function() {
            Bar(this.text());
        });
    });
</script> 
```

此脚本需要是静态的，并且不是由您的视图生成的。将其放在页面顶部或将其放入外部文件并链接到该文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T14:13:13.950

我不确定您的错误来自哪里（可能是因为您使用双引号，而不是代码块的单引号），但您还为每个名称注入了一个单独的脚本元素。@Andrew 的方法效果很好，但您也可以执行以下操作。它构建一个包含名称的 javascript 数组（作为字符串），然后注入一个脚本块，该脚本块迭代数组元素并在每个元素上调用 Bar 函数。如果您需要与 DOM 元素本身交互，我会使用@Andrew 的方法，如果您只需要与数据交互，则可能使用这种机制。

```
<% string names = "[";
   foreach (var item in Model)
   {
      names = names + item.Name + ",";
   }
   names = names.TrimEnd(',') + "]";
%>

<script type="text/javascript">
   $(function() {
       $.each( <%= names %>, function(i,val) {
          Bar(val);
       });
   });
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T18:13:13.030

```
<script type="text/javascript">

    $(document).ready(function() {
        <% foreach (var item in Model) { %>
            Bar('<%=item.Name %>');
        <% } %>
    });

</script> 
```

我正在使用它，效果很好，只是视觉工作室有点困惑。

# c# - C# 的常见操作的成本？

> ID：872442
> 
> 赞同：7
> 
> 时间：2009-05-16T13:30:36.953
> 
> 标签：c#, performance, optimization, operators

在[Code Complete 2](https://rads.stackoverflow.com/amzn/click/com/0735619670)（第 601 和 602 页）中有一个“通用操作成本”表。

基线操作整数赋值被赋予值 1，然后为 Java 和 C++ 列出常见操作的相对时间。例如：

```
 C++        Java
Integer assignment                1             1
Integer division                  5             1.5
Floating point square root       15             4 
```

问题是有人得到了 C# 的这些数据吗？我知道这些不会帮助我专门解决任何问题，我只是好奇。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-16T14:19:20.720

我实现了书中的一些测试。我电脑上的一些原始数据：

测试运行#1：

TestIntegerAssignment 00：00：00.6680000
TestCallRoutineWithNoParameters 00：00：00.9780000
TestCallRoutineWithOneParameter 00：00：00.6580000
TestCallRoutineWithTwoParameters 00：00：00.9650000
TestIntegerAddition 00：00：00.6410000
TestIntegerSubtraction 00：00：00.9630000
TestIntegerMultiplication 00：00：00.6490000
TestIntegerDivision 00：00：00.9720000
TestFloatingPointDivision 00 :00:00.6500000
TestFloatingPointSquareRoot 00:00:00.9790000
TestFloatingPointSine 00:00:00.6410000
TestFloatingPointLogarithm 00:00:41.1410000
TestFloatingPointExp 00:00:34.6310000

测试运行#2：

TestIntegerAssignment 00：00：00.6750000
TestCallRoutineWithNoParameters 00：00：00.9720000
TestCallRoutineWithOneParameter 00：00：00.6490000
TestCallRoutineWithTwoParameters 00：00：00.9750000
TestIntegerAddition 00：00：00.6730000
TestIntegerSubtraction 00：00：01.0300000
TestIntegerMultiplication 00：00：00.7000000
TestIntegerDivision 00：00：01.1120000
TestFloatingPointDivision 00 :00:00.6630000
TestFloatingPointSquareRoot 00:00:00.9860000
TestFloatingPointSine 00:00:00.6530000
TestFloatingPointLogarithm 00:00:39.1150000
TestFloatingPointExp 00:00:33.8730000

试运行#3：

TestIntegerAssignment 00：00：00.6590000
TestCallRoutineWithNoParameters 00：00：00.9700000
TestCallRoutineWithOneParameter 00：00：00.6680000
TestCallRoutineWithTwoParameters 00：00：00.9900000
TestIntegerAddition 00：00：00.6720000
TestIntegerSubtraction 00：00：00.9770000
TestIntegerMultiplication 00：00：00.6580000
TestIntegerDivision 00：00：00.9930000
TestFloatingPointDivision 00 :00:00.6740000
TestFloatingPointSquareRoot 00:00:01.0120000
TestFloatingPointSine 00:00:00.6700000
TestFloatingPointLogarithm 00:00:39.1020000
TestFloatingPointExp 00:00:35.3560000

（每个基准测试 10 亿次测试，使用 Optimize 编译，AMD Athlon X2 3.0ghz，使用 Jon Skeet 的微基准测试框架，可在[http://www.yoda.arachsys.com/csharp/benchmark.html](http://www.yoda.arachsys.com/csharp/benchmark.html)获得）

来源：

```
class TestBenchmark  
{  
[Benchmark]  
public static void TestIntegerAssignment()
{
int i = 1;
int j = 2;

    for (int x = 0; x < 1000000000; x++)
    {
        i = j;
    }
}

[Benchmark]
public static void TestCallRoutineWithNoParameters()
{
    for (int x = 0; x < 1000000000; x++)
    {
        TestStaticRoutine();
    }
}

[Benchmark]
public static void TestCallRoutineWithOneParameter()
{
    for (int x = 0; x < 1000000000; x++)
    {
        TestStaticRoutine2(5);
    }
}

[Benchmark]
public static void TestCallRoutineWithTwoParameters()
{
    for (int x = 0; x < 1000000000; x++)
    {
        TestStaticRoutine3(5,7);
    }
}

[Benchmark]
public static void TestIntegerAddition()
{
    int i = 1;
    int j = 2;
    int k = 3;

    for (int x = 0; x < 1000000000; x++)
    {
        i = j + k;
    }
}

[Benchmark]
public static void TestIntegerSubtraction()
{
    int i = 1;
    int j = 6;
    int k = 3;

    for (int x = 0; x < 1000000000; x++)
    {
        i = j - k;
    }
}

[Benchmark]
public static void TestIntegerMultiplication()
{
    int i = 1;
    int j = 2;
    int k = 3;

    for (int x = 0; x < 1000000000; x++)
    {
        i = j * k;
    }
}

[Benchmark]
public static void TestIntegerDivision()
{
    int i = 1;
    int j = 6;
    int k = 3;

    for (int x = 0; x < 1000000000; x++)
    {
        i = j/k;
    }
}

[Benchmark]
public static void TestFloatingPointDivision()
{
    float i = 1;
    float j = 6;
    float k = 3;

    for (int x = 0; x < 1000000000; x++)
    {
        i = j / k;
    }
}

[Benchmark]
public static void TestFloatingPointSquareRoot()
{
    double x = 1;
    float y = 6;

    for (int x2 = 0; x2 < 1000000000; x2++)
    {
        x = Math.Sqrt(6);
    }
}

[Benchmark]
public static void TestFloatingPointSine()
{
    double x = 1;
    float y = 6;

    for (int x2 = 0; x2 < 1000000000; x2++)
    {
        x = Math.Sin(y);
    }
}

[Benchmark]
public static void TestFloatingPointLogarithm()
{
    double x = 1;
    float y = 6;

    for (int x2 = 0; x2 < 1000000000; x2++)
    {
        x = Math.Log(y);
    }
}

[Benchmark]
public static void TestFloatingPointExp()
{
    double x = 1;
    float y = 6;

    for (int x2 = 0; x2 < 1000000000; x2++)
    {
        x = Math.Exp(6);
    }
}

private static void TestStaticRoutine() {

}

private static void TestStaticRoutine2(int i)
{

}

private static void TestStaticRoutine3(int i, int j)
{

}

private static class TestStaticClass
{

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T09:40:56.290

直接从源头，**[知道什么东西成本](http://msdn.microsoft.com/en-us/library/ms973852.aspx)**。

[IIRC Rico Mariani 有你在他的博客上](http://blogs.msdn.com/ricom/default.aspx)要求的相关措施，但我再也找不到它了（我知道它在两个“开发”书签之一中......）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T16:12:17.813

这是一个合理的问题，但我见过的几乎所有性能问题，尤其是在 Java 和 C# 中，都归结为：

*   太多的抽象层，以及
*   依赖基于事件的通知式编码。

与基本操作几乎没有关系。

抽象的问题是在工作量变得繁重之前都可以。每一层通常都会造成很小的性能损失，并且这些损失会以复合方式累积。那时，您开始需要解决方法。（我认为 StringBuilder 是这种解决方法的一个例子。）

基于事件的通知式编码（与通过周期性过程保持一致的更简单的数据结构相反）的问题在于，看似简单的操作（例如将属性设置为值）可能会导致操作的连锁反应在整个数据结构中所做的远远超出人们的预期。

# javascript - JavaScript 构建选项/工具

> ID：872460
> 
> 赞同：1
> 
> 时间：2009-05-16T13:44:31.770
> 
> 标签：javascript, redirect, build, compression, http-status-code-301

这些天来，我发现自己将越来越多的工作转移到客户端，因此我的 JS 文件越来越大。我已经到了大多数 HTML 页面在标题中有六个或更多 JS 导入的地步，我意识到这会损害加载时间。

我最近发现了这个[脚本](http://www.hunlock.com/blogs/Supercharged_Javascript)，它可以让你通过一个 HTTP 请求下载多个 JS 文件。它是用 PHP 编写的，作为 Django 的粉丝，我打算用 Python 重写它。我打算使用 HTTP 重定向到预先缩小和连接的文件，并且想知道 301 的成本是多少。请让我知道这是否是一个愚蠢的想法。

另一方面，我不太担心将脚本逻辑引入静态文件的服务，我想知道是否有一个可行的构建替代方案，比如连接和缩小 JS 文件并替换 HTML 中的多个 JS 下载的 ant 任务一个大的标题，就像脚本一样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T13:51:36.560

对于 PHP，我当然喜欢动态地执行它，因为如果您引入构建步骤，您将失去使用 PHP 的主要好处之一。事实上，冒着自我推销的风险，我已经用[PHP 编写了 Supercharging Javascript 来](http://www.cforcoding.com/2009/05/supercharging-javascript.html)解决这个问题。

当然，其他技术可能会有所不同。

同样是 PHP，但它不仅仅是供您使用的代码块（尽管您可以直接跳到[第 6 部分](http://www.cforcoding.com/2009/05/supercharging-javascript-part-6.html)，如果您只想要一些完整的工作代码）并且在识别问题和处理问题方面可能对您有价值正确的方式以及为什么要这样做。

我喜欢捆绑 Javascript 文件（可能整个应用程序只有一个），然后每个页面通过标准方式简单地激活它需要的行为，但所有代码体都在更大的缓存和缩小的 JS 文件中。它以这种方式运行得最快，是一个很好的方法。

如果您确实希望它作为构建过程的一部分，如果您有构建过程，这是一个合理的解决方案，那么我建议您缩小代码。有很多工具可以做到这一点。看看[YUI 压缩机](http://developer.yahoo.com/yui/compressor/)。

如果您对 JS 文件进行静态组合，则上面提到的其他内容（例如 gzipping 和相关问题）仍然是相关的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-08T11:42:07.267

YUI 压缩机是一个不错的选择。如果您想了解如何设置基于 Ant 的构建过程，请查看本教程：[http ://www.javascriptr.com/2009/07/21/setting-up-a-javascript-build-process /](http://www.javascriptr.com/2009/07/21/setting-up-a-javascript-build-process/)

作为基于 Ruby 的替代方案，我会推荐[Sprockets](http://www.getsprockets.com/)

# iphone - iPhone旋转时重置自定义UITableViewCell高度

> ID：872461
> 
> 赞同：5
> 
> 时间：2009-05-16T13:44:56.030
> 
> 标签：iphone, uitableview

我正在重载委托方法`-tableView:heightForRowAtIndexPath:`并`-sizeWithFont:constrainedToSize:`用于根据单元格中的文本以编程方式设置单元格的高度：

```
- (CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
  switch (indexPath.section) {
    case(kAboutViewOverviewSection): {
      switch (indexPath.row) {
        case(kAboutViewOverviewSectionRow): {
          NSString *text = NSLocalizedString(@"kAboutViewOverviewSectionFieldText", @"");
          CGSize s = [text sizeWithFont:[UIFont systemFontOfSize:14] constrainedToSize:CGSizeMake(280, 500)];
          return s.height + 13;
        }
        default: {
          break;
        }
      }
      break;
    }
    default: {
      break;
    }
  }
  return 44.0;
} 
```

这在第一次绘制表格时有效。但是，当我将设备的方向从纵向更改为横向时，单元格高度不会改变。

`-shouldAutorotateToInterfaceOrientation:`我尝试在我的表视图控制器中覆盖该方法：

```
- (BOOL) shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
  [self.tableView reloadData];
  return YES;
} 
```

这应该重新加载表格数据并（可能）重绘表格单元格视图。但这没有任何效果。

当设备旋转时，有没有办法强制单元格以新的高度重绘？

**编辑**：我尝试了以下方法，但没有效果：

```
- (void) didRotateFromInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
  [self.tableView reloadData];
} 
```

以下是应用程序在纵向时的样子：

![肖像](https://farm4.static.flickr.com/3541/3536323854_3f835c12b8.jpg)

以下是应用程序在横向时的样子：

![景观](https://farm4.static.flickr.com/3614/3535508503_bf8f2608fa.jpg)

内容的顶部和底部边缘之间存在间隙。

**编辑 2**：

通过表格框架的宽度调整尺寸参数有助于解决此显示问题：

```
CGSize s = [text sizeWithFont:[UIFont systemFontOfSize:14] constrainedToSize:CGSizeMake([tableView frame].size.width,500)]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T14:05:21.520

这不是最佳的，但最简单的解决方案是`-reloadData`在桌子上打电话。

如果仅针对 3.0 ，更好的解决方案是调用`-beginUpdates`, `-deleteRowsAtIndexPaths:withRowAnimation:`,`-insertRowsAtIndexPaths:withRowAnimation:`和`-endUpdates`or 。`-reloadSections:withRowAnimation:`这将添加动画。

编辑：你还需要一个适当的`tableView:heightForRowAtIndexPath:`

```
- (CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    CGSize textSize = [[self textForRowAtIndexPath:indexPath] sizeWithFont:[UIFont systemFontOfSize:14] constrainedToSize:CGSizeMake([tableView frame].size.width - 20, 500)];
    return textSize.height + 13.0f;
} 
```

（其中`textForRowAtIndexPath:`是返回单元格文本的方法）

# vb.net - 在 Matlab、VB6 和 VB.NET 程序之间发送消息的最简单方法

> ID：872469
> 
> 赞同：0
> 
> 时间：2009-05-16T13:50:35.797
> 
> 标签：vb.net, vb6, matlab, messages, interprocess

我们正在将一套数据采集和分析例程从 VB6 程序升级为 VB.NET、VB6 和 Matlab 程序的混合。我们希望保持系统模块化（单独的 EXE），以便我们可以轻松创建专门的独立分析程序，而无需不断升级一个大型应用程序。当所有程序都是用 VB6 编写时，我们使用 MBInterProcess 在 EXE 之间发送消息，这对我们来说非常有效（例如，让数据采集 EXE 将最新的文件名发送到独立的数据显示程序）。不幸的是，这个 ActiveX 不能在 Matlab 或 VB.NET 中用于接收消息。我们想知道我们可以采用的最简单的字符串消息传递系统（管道、注册消息等）是什么。现在我们只是轮询看看新文件是否写入特定文件夹，这不是最好的解决方案。我们理想的解决方案不需要花费大量时间来学习 Windows 的细微差别（我们是生物学家，而不是全职程序员），并且可以在 WinXP 和 64 位版本的 Windows 中工作。

作为对查询的回应，我们将整个 Matlab 会话包装在一个具有 MBInterProcess ActiveX 控件的 VB6 程序中。这可行，但对我们来说不是一个很好的解决方案，因为它可能会将我们永远锁定在 WinXP 中（并且肯定会阻止我们使用 64 位版本的 Matlab）。最新版本的 Matlab (2009a) 可以直接访问 .NET 函数，因此我们假设一种解决方案可能是使用 .NET 库来实现跨程序的管道（或类似的东西）。我们想重新创建 MBInterProcess ActiveX 的优雅简单的语法，并拥有一段代码来侦听具有该程序的顶级 Windows 名称的消息，然后调用特定的 Matlab m 文件或 VB.NET 函数，字符串数据（例如，文件名）作为参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T15:24:10.097

您能否在 VB6 中创建一个 ActiveX EXE 来简单地在各方之间转发消息？当有人调用它时，它会使用传递给调用的参数引发一个事件。您的 VB6 和 VB.NET 代码可以建立对 ActiveX exe 的引用来调用它并接收它的事件。我不熟悉 Matlab，所以我不知道它是否可以在那里访问。

编辑：您已经写到 Matlab 2009a 可以直接访问 .NET。如果它可以接收 .NET 事件，您还可以在 VB6 ActiveX EXE 上使用 .NET 包装器。

这是我快速敲出的一些示例代码。

项目名称为 VB6MatlabMessenger 的 VB6 ActiveX EXE 项目。每条消息都有一个文本字符串 Destination（以某种方式标识预期的收件人）和一个带有消息的字符串。

```
'MultiUse class VB6Messenger
Option Explicit

Public Event MessageReceived(ByVal Destination As String, ByVal Message As String)

Public Sub SendMessage(ByVal Destination As String, ByVal Message As String)
  Call Manager.RaiseEvents(Destination, Message)
End Sub

Private Sub Class_Initialize()
  Call Manager.AddMessenger(Me)
End Sub

Friend Sub RaiseTheEvent(ByVal Destination As String, ByVal Message As String)
  RaiseEvent MessageReceived(Destination, Message)
End Sub

'BAS module called Manager
Option Explicit

Private colMessengers As New Collection

Sub AddMessenger(obj As VB6Messenger)
  colMessengers.Add obj
End Sub

Sub RaiseEvents(ByVal Destination As String, ByVal Message As String)
  Dim obj As VB6Messenger
  For Each obj In colMessengers
    Call obj.RaiseTheEvent(Destination, Message)
  Next obj
End Sub 
```

和一个测试VB6正常的exe，参考了VB6MatlabMessenger。这是整个frm文件。将其构建为 exe，运行几个副本。填写目标和消息文本字段并单击按钮 - 您将看到**所有**exes 中都收到了消息（在列表框中报告）。

```
VERSION 5.00
Begin VB.Form Form1 
   Caption         =   "Form1"
   ClientHeight    =   3090
   ClientLeft      =   60
   ClientTop       =   450
   ClientWidth     =   4680
   LinkTopic       =   "Form1"
   ScaleHeight     =   3090
   ScaleWidth      =   4680
   StartUpPosition =   3  'Windows Default
   Begin VB.ListBox lstEvents 
      Height          =   1620
      Left            =   120
      TabIndex        =   3
      Top             =   1320
      Width           =   4455
   End
   Begin VB.TextBox txtMessage 
      Height          =   375
      Left            =   120
      TabIndex        =   2
      Text            =   "Message"
      Top             =   840
      Width           =   2295
   End
   Begin VB.TextBox txtDestination 
      Height          =   375
      Left            =   120
      TabIndex        =   1
      Text            =   "Destination"
      Top             =   240
      Width           =   2295
   End
   Begin VB.CommandButton cmdSendMessage 
      Caption         =   "Send Message"
      Height          =   495
      Left            =   2640
      TabIndex        =   0
      Top             =   360
      Width           =   1575
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private WithEvents objMessenger As VB6MatlabMessenger.VB6Messenger

Private Sub cmdSendMessage_Click()
  objMessenger.SendMessage txtDestination, txtMessage.Text
End Sub

Private Sub Form_Load()
  Set objMessenger = New VB6MatlabMessenger.VB6Messenger
End Sub

Private Sub objMessenger_MessageReceived(ByVal Destination As String, ByVal Message As String)
  lstEvents.AddItem Now() & " RECEIVED - " & Destination & ", " & Message
End Sub 
```

我开始编写一个 VB.NET 类库，它包装了 VB6 以使其可供 .NET 访问。我没有测试过这个。它引用了 VB6MatLabMessenger。

```
Public Class VBNETMatlabMessenger
  Private WithEvents objVB6Messenger As VB6MatlabMessenger.VB6Messenger

  Public Event MessageReceived(ByVal Destination As String, ByVal Message As String)

  Public Sub SendMessage(ByVal Destination As String, ByVal Message As String)
    objVB6Messenger.SendMessage(Destination, Message)
  End Sub

  Public Sub New()
    objVB6Messenger = New VB6MatlabMessenger.VB6Messenger
  End Sub

  Private Sub objVB6Messenger_MessageReceived(ByVal Destination As String, ByVal Message As String) Handles objVB6Messenger.MessageReceived
    RaiseEvent MessageReceived(Destination, Message)
  End Sub
End Class 
```

这可能会让你开始。请注意，VB6 messenger 对象将永远存在，因为 messenger 在内部保留对它们的引用，因此 COM 永远不会整理它们。如果这成为一个问题（如果在没有重新启动 PC 的情况下发送了**许多**消息），您可以向 VB6 messenger 添加一个方法，指示它从其集合中删除 messenger 对象，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T15:03:40.740

我使用 Matlab dos 命令在命令行上执行 Java 程序，它会等待命令行完成，然后再将控制权返回给 Matlab。这对我来说很好，在我的 Matlab 程序重新获得控制后，我从 Java 中读取了输出文件。

我使用了已编译的 Matlab 程序（即 exe 程序），这些程序工作正常，但它们在执行时会喷洒文件 - 我相信可以将命令行参数传递给已编译的可执行文件。假设 VB.NET 类似于 C# .NET，您可以使用类似 Process 对象的代码从代码中执行您的 exe。

或者，有一些方法可以编译为可通过 .NET 访问的 .dll，请参见此处：

[http://www.codeproject.com/KB/dotnet/matlabeng.aspx](http://www.codeproject.com/KB/dotnet/matlabeng.aspx)

解释一下。这个我没试过。。。

# math - 回程路线的可能组合数量

> ID：872471
> 
> 赞同：0
> 
> 时间：2009-05-16T13:51:45.357
> 
> 标签：math, combinations

我的数学很糟糕，真的很糟糕。太糟糕了，我什至都在努力表达这个问题，但是就这样吧。

这种情况是火车旅行，您有四个阵列可供使用。

离开_车站到达_车站

离开_日期返回_日期

因此，假设您只对单程路线感兴趣，您需要弄清楚有多少路线组合。那将是（我认为）

```
possible_routes = (leaving_stations x arriving_stations) x leaving_dates 
```

但是，如果我想回程，我该如何计算有多少种组合呢？

更新：：

或者这行得通吗？

可能的路线=（（离开站×到达站）×离开日期）×（离开日期×返回日期）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T04:41:06.143

好吧，答案是您的数组名称并不完全清楚。

假设我们有 4 个数组：

*   离开日期
*   返回日期
*   离开车站
*   到达站

然后我们可以在这里做一点解释。让我们使用符号 |x| 表示数组 [x] 的基数（元素数），因此 |Leaving Dates| 是您可以保留的日期总数。

然后|离开日期| * |离开车站| * |到达站| 会翻译为，选择一个日期离开，然后选择一个车站离开，然后选择一个车站到达，并以所有可能的方式做到这一点。所以这似乎是你要求的单程旅行。

现在，实际上，我将假设这是一个现实世界的问题，所以假设我们选择在 6 月 20 日从南安普顿出发前往约克郡，在回程中，我们现在可以选择的应该是返回日期（意思是我假设你想回家）。

因此，我们可以计划往返旅行的方式总数将是首先如上所述计划单程旅行，然后选择返回日期，即|离开日期| * |离开车站| * |到达站| * |返回日期|。前 3 个学期如上所述选择单程旅行，最后一个学期从所有可能的日期中选择一个返回日期。当然，如果我们可以选择返回另一个车站而不是我们离开的那个车站，那么等式将是 (|Leaving Dates| * |Leaving Stations| * |Arriving Stations|) * (|Return Date| * |离开车站|），或者如果我们甚至可以从与我们第一次到达的到达车站不同的到达车站出发，它将变成（|离开日期| * |离开车站| * |到达车站|）*（|返回日期| * |到达站| * |离开站|)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T13:56:40.697

我不确定我是否理解正确，但这似乎是一个典型的[图形路由](http://en.wikipedia.org/wiki/List_of_algorithms#Routing)理论问题。您可以查看[最小路径](http://en.wikipedia.org/wiki/Shortest_path)或[A*](http://en.wikipedia.org/wiki/A*_search_algorithm)算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T14:40:54.273

首先，AA 路线是错误的，所以：

```
possible_routes = 
(
  leaving_stations x arriving_stations - 
  (leaving_stations [intersection] arrivig_stations) 
) x leaving_dates 
```

交集运算是属于两个数组的元素

其次，当你想要 2 路路线时，组合是：

```
possible_2way_routes = 
(
    leaving_stations x arriving_stations - 
    (leaving_stations [intersection] arrivig_stations) 
) x 
leaving_dates x 
(return_dates that later than leaving dates+route time) 
```

'leaving_dates x (return_dates that later than leave dates+route time)' 是奇怪的事情，所以它可能更容易计算高估计 - 数字，在任何情况下都不少于 possible_2way_routes。最高计数将是所有返回日期晚于离开日期时，因此：

```
possible_2way_routes <= 
(
    leaving_stations x arriving_stations - 
    (leaving_stations [intersection] arrivig_stations) 
) x leaving_dates x return_dates 
```

哦，我记得如何计算'return_dates that later than leave dates+route time'。它的：

```
for each element of leaving_dates {
sum=sum+return_dates that later than ith leaving date+route time} 
```

仍然存在“路线时间”的问题，但......

# iphone - 使用放置在 tabbarcontroller 中的 navigationcontroller 从 tableview 更改为另一个视图

> ID：872473
> 
> 赞同：1
> 
> 时间：2009-05-16T13:55:39.793
> 
> 标签：iphone, objective-c, navigation, tabbar

我最近发现了一个关于如何在 tabbarcontroller（“笔尖方式”）中放置导航控制器的好教程。

[http://twilloapp.blogspot.com/2009/05/how-to-embed-navigation-controller.html](http://twilloapp.blogspot.com/2009/05/how-to-embed-navigation-controller.html)

我继续第二步，在 navcontroller 中添加了一个 tableviewcontroller。

我不明白的是如何从我的 tableviewcontroller 中使用导航栏控制器，例如 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath;

我想要做的是当用户选择一行时，另一个视图应该使用后退按钮和导航控制器提供的所有内容滑入。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T14:34:26.253

您是否开始使用 Apple 的[SimpleDrillDown](http://developer.apple.com/iphone/library/samplecode/SimpleDrillDown/index.html)示例？有问题的具体代码是这个例程：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    /*
     Create the detail view controller and set its inspected item to the currently-selected item
     */
    DetailViewController *detailViewController = [[DetailViewController alloc] initWithStyle:UITableViewStyleGrouped];

    detailViewController.detailItem = [dataController objectInListAtIndex:indexPath.row];

    // Push the detail view controller
    [[self navigationController] pushViewController:detailViewController animated:YES];
    [detailViewController release];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T16:50:05.647

以下是我正在寻找的内容：

```
[[self navigationController] pushViewController:detailViewController animated:YES];
[detailViewController release]; 
```

因为我已经为我的视图指定了`RootView`控制器，所以回答 navigationController。`NavigationControllers``self`

# web-services - 替代使用为 Web 方法实现 IDictionary 的内置对象

> ID：872478
> 
> 赞同：2
> 
> 时间：2009-05-16T13:58:08.820
> 
> 标签：web-services, asmx

我有一个使用在 ASP.NET 中创建的 Web 服务的 Web 应用程序。在这个网络服务中，我想传递一个键值类型的集合对象（即像 Hashtable 或 Dictionay 之类的东西）。

但是我们不能使用从 IDictionary 实现的对象。

我不想在我的 Web 服务中创建序列化类。

谁能建议我最好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T16:55:33.060

dev.e.loper 几乎是对的。您可以使用`List<Pair>`.

或者，您可以使用`List<KeyValuePair<TKey,TValue>>`.

MSDN 文档：

*   [键值对](http://msdn.microsoft.com/en-us/library/5tbh8a42.aspx)
*   [一对](http://msdn.microsoft.com/en-us/library/system.web.ui.pair.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T16:58:13.663

我对你的问题并不完全清楚，但也许你需要这样的东西？

```
using System.Collections.Generic;
using System.Xml;
using System.Xml.Schema;
using System.Xml.Serialization;

[XmlRoot("dictionary")]
public class SerializableDictionary<TKey, TValue> : Dictionary<TKey, TValue>, IXmlSerializable
{
    public XmlSchema GetSchema()
    {
        return null;
    }

    public void ReadXml(XmlReader reader)
    {
        var keySerializer = new XmlSerializer(typeof(TKey));
        var valueSerializer = new XmlSerializer(typeof(TValue));

        bool wasEmpty = reader.IsEmptyElement;
        reader.Read();

        if (wasEmpty)
        {
            return;
        }

        while (reader.NodeType != XmlNodeType.EndElement)
        {
            reader.ReadStartElement("item");

            reader.ReadStartElement("key");
            var key = (TKey)keySerializer.Deserialize(reader);
            reader.ReadEndElement();

            reader.ReadStartElement("value");
            var value = (TValue)valueSerializer.Deserialize(reader);
            reader.ReadEndElement();

            this.Add(key, value);
            reader.ReadEndElement();
            reader.MoveToContent();
        }

        reader.ReadEndElement();
    }

    public void WriteXml(XmlWriter writer)
    {
        var keySerializer = new XmlSerializer(typeof(TKey));
        var valueSerializer = new XmlSerializer(typeof(TValue));

        foreach (var key in this.Keys)
        {
            writer.WriteStartElement("item");
            writer.WriteStartElement("key");
            keySerializer.Serialize(writer, key);
            writer.WriteEndElement();
            writer.WriteStartElement("value");
            TValue value = this[key];
            valueSerializer.Serialize(writer, value);
            writer.WriteEndElement();
            writer.WriteEndElement();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-18T10:41:46.800

您可以从可序列化的 KeyedCollection 继承。

[http://msdn.microsoft.com/en-us/library/ms132438.aspx](http://msdn.microsoft.com/en-us/library/ms132438.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-23T23:44:10.383

我通过使用 DictionaryEntry 解决了这个问题

唯一的区别是 Key 也是 Object。

我基本上有一个`Dictionary ToDictionary(DictionaryEntry[] entries)`和一个`DictionaryEntry[] FromDictionary(Dictionary entries)`静态方法，它们的重量很轻，最终让我到达同一个地方，而不必创建自己的集合类。

额外的好处是，由此产生的 XML 更接近于 WCF Web 服务默认使用的 XML！这意味着您现在可以在您的客户端代码中进行此更改，并且如果您决定采用这种方式，则可以为 WCF 做好准备。

默认情况下，JSON 上的结果`[{"Key": key1, "Value": value1}, {"Key": key2, "Value": value2}]`与 WCF 上的结果完全相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T14:01:02.043

您可以尝试使用 2 个数组，1 个用于键，一个用于值，其中数组的索引匹配。不是最理想的解决方案，而是一个有效的解决方案。您可以使用 IDictionary 并传递该对象的键和值的 web 服务的内部结构。

# c++ - C++0x 中的新 unicode 字符

> ID：872491
> 
> 赞同：25
> 
> 时间：2009-05-16T14:06:08.990
> 
> 标签：c++, unicode, c++11, char16-t, char32-t

我正在构建一个 API，它允许我获取各种编码的字符串，包括 utf8、utf16、utf32 和 wchar_t（根据操作系统可能是 utf32 或 utf16）。

1.  新的 C++ 标准引入了新类型`char16_t`，并且`char32_t`没有这种大小的歧义，应该在将来使用，所以我也想支持它们，但问题是，**它们是否会干扰**正常`uint16_t`的 , `uint32_t`,`wchar_t`类型不允许重载，因为它们可能指的是同一类型？

    ```
    class some_class {
    public:
        void set(std::string); // utf8 string
        void set(std::wstring); // wchar string utf16 or utf32 according
                                 // to sizeof(wchar_t)
        void set(std::basic_string<uint16_t>)
                             // wchar independent utf16 string
        void set(std::basic_string<uint32_t>);
                             // wchar independent utf32 string

    #ifdef HAVE_NEW_UNICODE_CHARRECTERS
        void set(std::basic_string<char16_t>)
                             // new standard utf16 string
        void set(std::basic_string<char32_t>);
                             // new standard utf32 string
    #endif
    }; 
    ```

    所以我可以写：

    ```
    foo.set(U"Some utf32 String");
    foo.set(u"Some utf16 string"); 
    ```

2.  `std::basic_string<char16_t>`今天的typedef 是什么`std::basic_string<char32_t>`：

    ```
    typedef basic_string<wchar_t> wstring. 
    ```

    我找不到任何参考。

    编辑：根据 gcc-4.4 的标题，介绍了这些新类型：

    ```
    typedef basic_string<char16_t> u16string;
    typedef basic_string<char32_t> u32string; 
    ```

    我只是想确保这是实际的标准要求，而不是 gcc-ism。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-16T14:30:20.960

1)`char16_t`并且`char32_t`将是不同的新类型，因此可以对它们进行重载。

引自[ISO/IEC JTC1 SC22 WG21 N2018](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2018.html)：

> 定义`char16_t`为一个不同的新类型的 typedef，其名称 `_Char16_t`与`uint_least16_t`. 同样，定义`char32_t`为一个不同的新类型的 typedef，其名称`_Char32_t`与 `uint_least32_t`.

进一步解释（来自 devx.com 文章“[为 Unicode 革命做好准备](http://www.devx.com/cplus/10MinuteSolution/34328/1954)”）：

> 您可能想知道 当 typedef和 已经可用时，为什么首先需要`_Char16_t`and`_Char32_t`类型和关键字。新类型解决的主要问题是重载。现在可以重载接受和 参数的函数，并创建 不同于 .`uint_least16_t``uint_least32_t``_Char16_t``_Char32_t``std::basic_string<_Char16_t>``std::basic_string <wchar_t>`

2)`u16string`并且`u32string`确实是 C++0x 的一部分，而不仅仅是 GCC 主义，正如[各种标准草案文件](http://www.google.com/search?q=u16string+site%3Aopen-std.org)中提到的那样。它们将包含在新`<string>`标题中。引用同一篇文章：

> 标准库还将为以下标准类提供 `_Char16_t`和`_Char32_t`typedefs 类似的 typedefs`wstring`等 `wcout`：
> 
> `filebuf, streambuf, streampos, streamoff, ios, istream, ostream, fstream, ifstream, ofstream, stringstream, istringstream, ostringstream,` **`string`**

# mysql - 使用 Java 环境从 CMD 行恢复 MYSQL

> ID：872494
> 
> 赞同：1
> 
> 时间：2009-05-16T14:09:35.847
> 
> 标签：mysql, restore, cmd

我正在将 Java 和 Mysql 用于程序，我正在使用脚本文件来恢复数据库。

在Java下我正在执行一个命令：在bin下：mysql -u root -proot test< c:\test.mysql

它没有运行，如果我在 cmd 行下运行它，它将正确执行并恢复数据库。

有谁知道..为什么会发生..有什么问题，如果我在Java环境下运行它为什么不运行。

确切语法：我正在使用进程 P= runtime.getRunTime().exec(FilePath)

其中 FilePath 变量具有值：mysql -u root -proot test< c:\test.mysql

我正在使用 Windows 环境。而如果我在 CmdLine 中运行 FilePath，它将给出完美的结果。

非常感谢或帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-23T09:26:08.280

我有同样的问题！

实际上，我唯一可以做的事情（在 Windows 上，还没有测试过其他平台）是使用批处理文件：

这是代码：

```
public class MysqlDatabase {

private int BUFFER = 10485760;
private String host, port, user, password, db;

public MysqlDatabase(String host, String port, String user, String password, String db) {
    this.host = host;
    this.port = port;
    this.user = user;
    this.password = password;
    this.db = db;
}

public boolean restoreDatabase(String filepath) throws Exception {
    String comando = "mysql " + db + " --host=" + host + " --port=" + port
            + " --user=" + user + " --password=" + password
            + " < " + filepath;
    File f = new File("restore.bat");
    FileOutputStream fos = new FileOutputStream(f);
    fos.write(comando.getBytes());
    fos.close();
    Process run = Runtime.getRuntime().exec("cmd /C start restore.bat ");
    return true;

}

public String getFull() throws Exception {

    Process run = Runtime.getRuntime().exec(
            "mysqldump --host=" + host + " --port=" + port
            + " --user=" + user + " --password=" + password
            + " --opt "
            + "" + db);
    InputStream in = run.getInputStream();
    BufferedReader br = new BufferedReader(new InputStreamReader(in));

    StringBuilder temp = new StringBuilder();

    int count;
    char[] cbuf = new char[BUFFER];

    while ((count = br.read(cbuf, 0, BUFFER)) != -1) {
        temp.append(cbuf, 0, count);
    }

    br.close();
    in.close();

    return temp.toString();
}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T14:35:18.013

我认为我们需要更多信息。只要路径设置相同，如果它将从命令行运行，它应该从 Runtime.exec() 运行相同。你看到什么错误？

尝试在脚本中设置推荐，以便您可以将路径和命令输出回显到文件中以供稍后查看。在 UNIX 中看起来像

```
 LOGFILE=my.log
 echo $PATH > $LOGFILE
 env >> $LOGFILE
 mysql -u root -proot test< c:\test.mysql >> $LOGFILE 2>&1 
```

看起来您使用的是 Windows，所以我不知道如何以这种方式设置命令文件；重要的是确保您将 mysql 推荐的错误输出发送到文件。

# asp.net-mvc - IoC 是否会导致 ASP.NET MVC Controller 构造函数的参数过多？

> ID：872495
> 
> 赞同：3
> 
> 时间：2009-05-16T14:10:09.883
> 
> 标签：asp.net-mvc, inversion-of-control, controller, castle-windsor

我决定将**ASP.NET MVC**用于网站项目，并希望遵循一些正在编写的最佳实践。

因此，我将域/模型分离到一个单独的项目中，创建了 IRepositories 和具体存储库，现在我将注意力转向了**Castle Windsor**作为**IoC**。

我现在面临的问题是，对于特定的 Controller，在构造函数上我现在必须传入多个 IRepository 参数。

**我的问题是：**

1.  我是否可能创建了太多存储库 - 通常，我将 1 个存储库映射到 1 个实体类到 1 个数据库表。我的存储库是否应该有效地包含一个以上的实体/数据库表？
2.  我是否错过了 IoC 和依赖注入的要点，我是否应该不关心参数如何传递给 Controller 构造函数？

给出某种背景。该网站的一部分将显示一个可按*属性类型*（城堡、房屋、酒吧等）、*位置*（邮政编码、城市）、*开放时间*等搜索的属性的谷歌地图。因此，这些可搜索的组件都是独立的实体属性类型、地址。城市、地址.邮政编码.经纬度+经度、开放时间.日期时间。因此，还有 3 个单独的存储库必须传递到 SearchController 构造函数中。

这是一个简单的示例，但我可以设想未来将有更多的存储库参数传递给其他控制器。

希望这一切都有意义。

感谢您的任何答案或建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T14:22:50.883

我不会关心你传递给构造函数的参数有多少，IoC 将处理其中的所有逻辑。

如果您的控制器最终参数过多，我会考虑分解控制器的功能，或者将逻辑移动到服务类中。

至于存储库，我通常使用一个通用存储库，它在其实现中采用单个实体。然后我有一个服务类，将这些信息聚合到逻辑单元中。在这种情况下，您的控制器只需要访问服务。例如：

```
interface IRepository<T>
{
    IQueryable<T> GetAll();
    T GetOne(int id);
    void Save(T item);
    void Delete(T item);
}

class OrderService
{
    public OrderService(IReopository<Order> orderRepository, IRepository<OrderDetail> orderDetailRepository, IRepository<Payment> paymentRepository, etc) { }

    public Order CreateOrder(List<OrderDetails> details)
    {}
    // .. other aggregate methods
} 
```

# java - 在Java中以一定的速率读取文件

> ID：872496
> 
> 赞同：7
> 
> 时间：2009-05-16T14:10:49.977
> 
> 标签：java, file-io, inputstream

是否有关于如何以一定速度读取长文件的文章/算法？

假设我不想在发出读取时通过 10 KB/秒。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-16T15:59:43.990

一个简单的解决方案，通过创建一个 ThrottledInputStream。

这应该像这样使用：

```
 final InputStream slowIS = new ThrottledInputStream(new BufferedInputStream(new FileInputStream("c:\\file.txt"),8000),300); 
```

300 是每秒千字节数。8000 是 BufferedInputStream 的块大小。

这当然应该通过实现 read(byte b[], int off, int len) 来概括，这将为您节省大量 System.currentTimeMillis() 调用。System.currentTimeMillis() 为每个字节读取调用一次，这可能会导致一些开销。还应该可以存储无需调用 System.currentTimeMillis() 即可轻松读取的字节数。

确保在两者之间放置一个 BufferedInputStream，否则 FileInputStream 将以单个字节而不是块进行轮询。这会将[CPU](http://en.wikipedia.org/wiki/Central_processing_unit)负载从 10% 减少到几乎为 0。您将面临超出数据速率的风险，即块大小中的字节数。

```
import java.io.InputStream;
import java.io.IOException;

public class ThrottledInputStream extends InputStream {
    private final InputStream rawStream;
    private long totalBytesRead;
    private long startTimeMillis;

    private static final int BYTES_PER_KILOBYTE = 1024;
    private static final int MILLIS_PER_SECOND = 1000;
    private final int ratePerMillis;

    public ThrottledInputStream(InputStream rawStream, int kBytesPersecond) {
        this.rawStream = rawStream;
        ratePerMillis = kBytesPersecond * BYTES_PER_KILOBYTE / MILLIS_PER_SECOND;
    }

    @Override
    public int read() throws IOException {
        if (startTimeMillis == 0) {
            startTimeMillis = System.currentTimeMillis();
        }
        long now = System.currentTimeMillis();
        long interval = now - startTimeMillis;
        //see if we are too fast..
        if (interval * ratePerMillis < totalBytesRead + 1) { //+1 because we are reading 1 byte
            try {
                final long sleepTime = ratePerMillis / (totalBytesRead + 1) - interval; // will most likely only be relevant on the first few passes
                Thread.sleep(Math.max(1, sleepTime));
            } catch (InterruptedException e) {//never realized what that is good for :)
            }
        }
        totalBytesRead += 1;
        return rawStream.read();
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T14:17:02.007

粗略的解决方案是一次读取一个块，然后休眠，例如 10k，然后再休眠一秒钟。但我要问的第一个问题是：为什么？有几个可能的答案：

1.  您不想比完成工作的速度更快；或者
2.  您不想在系统上造成太大的负载。

我的建议是不要在读取级别控制它。这有点混乱和不准确。而是在工作结束时控制它。Java 有很多很棒的并发工具来处理这个问题。有几种替代方法可以做到这一点。

我倾向于使用[生产者消费者](http://en.wikipedia.org/wiki/Producer-consumer_problem)模式来解决这类问题。它为您提供了很好的选择，可以通过报告线程等来监控进度，它可以是一个非常干净的解决方案。

像[ArrayBlockingQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ArrayBlockingQueue.html)这样的东西可用于 (1) 和 (2) 所需的那种节流。由于容量有限，当队列已满时，阅读器最终会阻塞，因此不会很快填满。可以控制工人（消费者）只工作如此之快，以限制速率覆盖（2）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T14:47:26.830

*   而!EOF
    *   将 System.currentTimeMillis() + 1000 (1 sec) 存储在 long 变量中
    *   读取 10K 缓冲区
    *   检查存储的时间是否已过
        *   如果不是，则 Thread.sleep() 用于存储时间 - 当前时间

按照建议创建采用另一个 InputStream 的 ThrottledInputStream 将是一个不错的解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T14:29:15.470

如果您使用过 Java I/O，那么您应该熟悉装饰流。我建议使用`InputStream`另一个子类`InputStream`并限制流速。（您可以进行子类`FileInputStream`化，但这种方法极易出错且不灵活。）

您的具体实施将取决于您的具体要求。通常，您需要注意最后一次读取返回的时间 ( `System.nanoTime`)。在当前读取中，在底层读取之后，`wait`直到足够的时间用于传输的数据量。更复杂的实现可能会缓冲并（几乎）立即返回（几乎）只有速率指示的数据（请注意，如果缓冲区长度为零，则只应返回读取长度为 0）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-08-23T10:10:37.923

您可以使用 RateLimiter。并在 InputStream 中自己实现读取。这方面的一个例子可以在下面看到

```
public class InputStreamFlow extends InputStream {
    private final InputStream inputStream;
    private final RateLimiter maxBytesPerSecond;

    public InputStreamFlow(InputStream inputStream, RateLimiter limiter) {
        this.inputStream = inputStream;
        this.maxBytesPerSecond = limiter;
    }

    @Override
    public int read() throws IOException {
        maxBytesPerSecond.acquire(1);
        return (inputStream.read());
    }

    @Override
    public int read(byte[] b) throws IOException {
        maxBytesPerSecond.acquire(b.length);
        return (inputStream.read(b));
    }

    @Override
    public int read(byte[] b, int off, int len) throws IOException {
        maxBytesPerSecond.acquire(len);
        return (inputStream.read(b,off, len));
    }
} 
```

如果您想将流量限制为 1 MB/s，您可以像这样获得输入流：

```
final RateLimiter limiter = RateLimiter.create(RateLimiter.ONE_MB); 
final InputStreamFlow inputStreamFlow = new InputStreamFlow(originalInputStream, limiter); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T14:17:53.783

这在一定程度上取决于您的意思是“不超过某个比率”还是“接近某个比率”。

如果您的意思是“不超过”，您可以通过一个简单的循环来保证：

```
 while not EOF do
    read a buffer
    Thread.wait(time)
    write the buffer
 od 
```

等待的时间是缓冲区大小的一个简单函数；如果缓冲区大小为 10K 字节，则您希望在读取之间等待一秒钟。

如果你想比这更近，你可能需要使用计时器。

*   创建一个 Runnable 来读取
*   创建一个带有[TimerTask的](http://java.sun.com/j2se/1.4.2/docs/api/java/util/TimerTask.html)[Timer](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Timer.html)来读取
*   每秒调度 TimerTask *n*次。

如果您担心将数据传递给其他东西的速度，而不是控制读取，将数据放入队列或循环缓冲区等数据结构中，并控制另一端；定期发送数据。但是，您需要注意这一点，具体取决于数据集大小等，因为如果读取器比写入器快得多，您可能会遇到内存限制。

# windows - 如何让 emacs Zip-Archive 模式在 Windows 上工作

> ID：872507
> 
> 赞同：6
> 
> 时间：2009-05-16T14:15:43.477
> 
> 标签：windows, emacs, zip

Zip-Archive 模式适用于带有 zip/unzip 的系统。你如何让它在 Wnidows 上工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T14:28:48.983

EMACS 使用外部程序进行压缩/解压缩。它所需要的只是知道要使用的正确程序。

* * *

一些扩展的讨论：

正如我所说，我没有 Windows 框，但 LISP 代码在 arc-mode.el 中，大约在第 230 行：

```
(defcustom archive-zip-extract
  (if (and (not (executable-find "unzip"))
           (executable-find "pkunzip"))
      '("pkunzip" "-e" "-o-")
    '("unzip" "-qq" "-c"))
  "*Program and its options to run in order to extract a zip file member.
Extraction should happen to standard output.  Archive and member name will
be added."
  :type '(list (string :tag "Program")
        (repeat :tag "Options"
            :inline t
            (string :format "%v")))
  :group 'archive-zip) 
```

观察函数`executable-find`。它在您的 EMACS 中搜索`exec-path`，其中包括一些不在您的正常 PATH 变量中的 EMACS 可执行目录。就我而言，它是：

```
("/usr/bin" 
 "/bin" 
 "/usr/sbin" 
 "/sbin" 
 "/Applications/Emacs.app/Contents/MacOS/libexec" 
 "/Applications/Emacs.app/Contents/MacOS/bin" 
 "~/bin" 
 "/usr/local/bin" 
 "/usr/X11R6/bin") 
```

其中包括 EMACS 包内的两个目录。您的 Windows 安装将在 EMACS 设置的内部某处包含等效目录。如果它们不在您的常规路径中，则可以在此处查找可执行文件。

[您可以从该站点](http://www.interpages.co.uk/pkzipage/)下载 pkunzip并安装它，并将安装路径添加到`(add-to-list 'exec-path "c:/path/to/pkunzip")`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T00:27:17.687

emacs 如何处理压缩文件可能有点令人困惑，但这里尝试总结一下情况。有两个主要的压缩包：（`arc-mode`例如`zip-archive`模式）和`jka-compr`模式（`auto-compression-mode`）。

1.  `arc-mode`：将显示多文件存档（arc、lzh、zip、zoo）**的目录**（即存档中包含的文件名的简单列表），而无需在您的系统上存在相关的第三方工具。如果您确实想使用 arc-mode 对存档中包含的实际文件进行任何**查看/编辑**，您肯定需要将第三方工具安装在您的系统上并安装在适当的位置。例如，对于 zip 文件，它默认为 zip/unzip `exec-path`（这是操作系统 PATH 环境）。这可以使用`archive-zip-extract`和进行自定义`archive-zip-expunge`。
2.  `jka-compr`( `auto-compression-mode`)：将自动压缩/解压缩单个文件存档（gz、Z、bz2、tbz 等），并且需要您的系统上存在相关的第三方工具。

因此，要让`zip-archive`模式在 Windows 上完全运行，您只需要找到 Windows 版本的命令行 zip/unzip 并将它们放入 PATH 中的目录中（例如，请参阅[http://gnuwin32.sourceforge.net上的解压缩包/](http://gnuwin32.sourceforge.net/)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-28T05:20:52.637

你可以使用 [chololatey]: [https://chocolatey.org/，windows](https://chocolatey.org/)的包管理，安装解压。

```
choco install unzip 
```

# windows - 我可以在 Emacs 的 shell 模式下使用 PowerShell 吗？

> ID：872510
> 
> 赞同：13
> 
> 时间：2009-05-16T14:16:43.487
> 
> 标签：windows, emacs, powershell

我可以在 emacs 的 shell 模式下使用 powershell 作为 shell 吗？
如何？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T14:55:39.697

请参阅 Jeffrey Snover 的博客文章[PowerShell 在 Emacs 中运行](http://blogs.msdn.com/powershell/archive/2008/04/15/powershell-running-inside-of-emacs.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-01-05T19:14:48.950

基于博文[在 Emacs 中将 PowerShell 作为 shell 运行](http://blogs.msdn.com/dotnetinterop/archive/2008/04/10/run-powershell-as-a-shell-within-emacs.aspx)（2008 年 4 月），以及关于 PowerShell 的 Emacs Wiki 文章中称为[PowerShell as a lower shell](https://www.emacswiki.org/emacs/PowerShell#toc3)的部分（2010 年 5 月更新）：

*   保存[`powershell.el`](https://www.emacswiki.org/emacs/download/Powershell.el)在`.\share\emacs\site-lisp`Emacs 安装目录或[`load-path`](https://www.emacswiki.org/emacs/LoadPath). (`powershell.el`太长，无法包含在此答案中。如博客文章中所述，当标准输入和输出被重定向时，无法强制 PowerShell 以交互模式运行，因此需要相当多的胶水代码才能使用它作为劣质外壳。）

*   将以下内容添加到您的[`.emacs`文件中](https://stackoverflow.com/questions/189490/where-can-i-find-my-emacs-file-for-emacs-running-on-windows)：

    `(autoload 'powershell "powershell" "Run powershell as a shell within emacs." t)`

完成后，使用`M-x powershell`打开并交互使用 PS shell 缓冲区。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-06-26T14:24:04.193

我没有设计一个完整的包装，而是想出了一个可以很好地满足我的需求的五衬里。您可能想快速适应它。

```
(defun powershell (&optional buffer)
  "Launches a powershell in buffer *powershell* and switches to it."
  (interactive)
  (let ((buffer (or buffer "*powershell*"))
    (powershell-prog "c:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe"))
    (make-comint-in-buffer "shell" "*powershell*" powershell-prog)
    (switch-to-buffer buffer))) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T14:24:48.010

找出答案的最快方法是运行 shell-mode，然后从命令行运行 powershell。

# apache-flex - Eclipse / Tour de Flex 插件 / 访问 Tour de Flex 视图时出现问题

> ID：872514
> 
> 赞同：0
> 
> 时间：2009-05-16T14:18:13.110
> 
> 标签：apache-flex, eclipse, adobe

Eclipse 世界对我来说是全新的。我刚刚在我的 Eclipse / Flex 环境中安装了 Tour de Flex 插件

（Eclipse 平台版本：3.3.3.r33）。

一切顺利。现在，如果我尝试查看 Tour de Flex，我会这样做：
- 菜单 Windows => 其他视图
- 打开一个弹出框，我选择“Tour de Flex”，

然后它问我：“请在您的系统上找到 Tour de Flex 应用程序”。

我应该去哪里看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T15:43:19.927

页面没有说明的是AIR版本是Eclipse插件的先决条件。

1.  必要时下载 Adob​​e AIR
2.  从主页安装 Tour de Flex 应用程序。
3.  找到“Tour de Flex”exe。（例如 - C:\Program Files\TourDeFlex\TourDeFlex.exe）

那应该让它工作。

# gridview - DXperience gridview 和内部控件

> ID：872519
> 
> 赞同：0
> 
> 时间：2009-05-16T14:23:38.743
> 
> 标签：gridview, dxperience

我正在尝试 DXperience gridview，想知道是否可以将 aspx 控件附加到其中一列。

我创建了一个简单的控件，其中包含一个按钮和一些 javascript/ajax 方法，并且想将它添加到一个列中，但这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T14:58:47.803

dxprerience 网格视图支持模板列，就像标准 ASP.NET 网格视图一样。使用模板可以嵌入您的自定义控件。

有关示例，请参阅**[ASPxGridview 文档](http://www.devexpress.com/Help/?document=ASPxGridView/DevExpressWebASPxGridViewGridViewTemplates_DataRowtopic.htm&levelup=true)**。

# c# - WPF：是否可以将以下代码从程序 (C#) 转换为声明性 (XAML)？

> ID：872526
> 
> 赞同：1
> 
> 时间：2009-05-16T14:27:15.897
> 
> 标签：c#, wpf, xaml, data-binding

`Window`我在（*删除了不必要的部分*）中有以下内容：

XAML：

```
<Style x:Key="itemstyle" TargetType="{x:Type ContentPresenter}">
        <EventSetter Event="MouseLeftButtonDown" Handler="HandleItemClick"/>
</Style>

<ItemsControl ItemsSource="{Binding ArtistList}" Margin="10" Name="artist_list" ItemContainerStyle="{StaticResource itemstyle}" >
    <ItemsControl.ItemTemplate>
        <DataTemplate>
                <TextBlock Text="{Binding ID}" Foreground="White"/>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl>

<Controls:RSSViewer x:Name="rssControl" /> 
```

C#（*后面的代码*）：

```
private void HandleItemClick(object sender, MouseButtonEventArgs e)
{
    var selectedArtist = ((ContentPresenter) sender).Content as Artist;
    rssControl.SourceUrl = "http://agnt666laptop:28666/rss.aspx?artistid=" + selectedArtist.ID;
} 
```

* * *

现在我想做的是将上述 xaml 和 C# 的混合转换为纯粹的 xaml，以利用 WPF 的 DataBinding 模型。

我认为它需要像事件触发器和数据绑定与 itemscontrol 元素的选定项目或类似的东西的组合，但我不确定如何去做。

**谁能指导我如何转换上述解决方案以删除程序代码？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T14:54:45.567

如果您使用的是 .NET 3.5SP1，您可能可以使用新的 StringFormat 绑定标记扩展来执行此操作。有关与 StringFormat 绑定的示例，请参见[此处](http://blogs.msdn.com/llobo/archive/2008/05/19/wpf-3-5-sp1-feature-stringformat.aspx)。

如果 .NET 3.5SP1 不是一个选项，那么您可能必须创建自己的 ValueConverter。将该属性的值绑定`SourceUrl`到所选艺术家的 ID，然后在您的转换器中返回您在上面的 C# 示例中使用的相同字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T15:45:05.210

```
<ItemsControl ItemsSource="{Binding ArtistList}" Margin="10" Name="artist_list" ItemContainerStyle="{StaticResource itemstyle}" >
        <ItemsControl.ItemTemplate>
                <DataTemplate>
                                <TextBlock Text="{Binding ID}" Foreground="White"/>
                </DataTemplate>
        </ItemsControl.ItemTemplate>
</ItemsControl>

<Controls:RSSViewer x:Name="rssControl" SourceUrl="{Binding SelectedItem.ID, ElementName=artist_list, StringFormat= 'http://agnt666laptop:28666/rss.aspx?artistid={0}' }" /> 
```

# asp.net - 线程、应用程序域和工作进程之间的关系

> ID：872527
> 
> 赞同：5
> 
> 时间：2009-05-16T14:27:32.417
> 
> 标签：asp.net, multithreading, iis, iis-7

在 IIS7 和 ASP.NET 中，以下之间的确切关系是什么：

*   IIS 工作进程
*   线程
*   应用程序域
*   应用程序，以及
*   传入的请求。

我希望得到类似于以下格式的答案：

“每个 IIS 工作进程托管许多应用程序域，每个应用程序域都会生成一个线程以响应每个请求......”等等，以及提到的任何细微差别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T14:38:45.307

每个工作进程托管多个 AppDomain（每个 ASP.NET 应用程序至少一个，即网站或虚拟目录）。传入的请求在到来时会从线程池中分配一个线程。

> OP：**问。**所以每个 appdomain 都拥有并管理自己的线程池？

每个托管线程总是一次分配给一个 AppDomain。工作进程维护一个共享线程池，并在请求期间将其分配给特定的 AppDomain。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T14:44:08.273

Fritz Onion 的书 Essential ASP.NET 有一[章是关于 HTTP Pipeline](http://books.google.com/books?id=EeqGCtdsjOUC&pg=PA98&lpg=PA98&dq=fritz+onion+appdomain+iis&source=bl&ots=281erIRxg-&sig=QP7_tHWWwteo5VwWq0AusHxDUFY&hl=en&ei=iNAOStnmHs6fmAfD6MX0Bw&sa=X&oi=book_result&ct=result&resnum=1#PPA98,M1)的，他在其中讨论了 http 请求期间上述所有内容的关系。

# javascript - window.onbeforeunload 消息本地化

> ID：872531
> 
> 赞同：1
> 
> 时间：2009-05-16T14:29:10.727
> 
> 标签：javascript

我正在使用页面卸载触发器来警告用户在离开页面/关闭选项卡/等时未保存的更改......这很好用。

```
//Exit event
if (!changes_saved) {
    window.onbeforeunload = confirmExit;    
}
function confirmExit()
{
  return "Your changes will be lost if you leave this page!";
} 
```

我的问题是浏览器（Firefox 和 IE）在开始时使用“您确定要离开此页面”和“按确定继续，或取消留在当前页面”来封装自定义消息。在末尾。

我的问题：有什么办法可以避免这种情况并完全自定义对话框中的消息？对此的需求不是抽象的，我正在开发一个多语言界面和本地化消息与强制的混合看起来很傻。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T14:38:30.673

这个问题以前有人[问过](https://stackoverflow.com/questions/276660/how-can-i-override-the-onbeforeunload-dialog-and-replace-it-with-my-own)。

显然，由于浏览器的安全性，修改此标准对话框是不可能的。如果可能的话，它会允许恶意网站欺骗您留在页面上。

但是，消息的语言基于用户机器的语言设置，就像任何其他标准对话框一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T14:38:17.633

恐怕这是不可能的。曾经遇到过同样的问题，用谷歌搜索它并在 msdn 上找到了一个链接，说它无法完成（对于 IE，至少我当时担心）。

不过我再也找不到这个链接了。

# winforms - Winforms Designer 如何实例化我的表单？

> ID：872536
> 
> 赞同：4
> 
> 时间：2009-05-16T14:31:39.240
> 
> 标签：winforms, visual-studio-2008, designer, windows-forms-designer

我正在开发自己的 WinForms 设计器。它必须能够加载现有的自定义表单类型。我遇到的问题之一是没有默认 ctor 的表单：我的代码当前实例化了表单，然后才能将其加载到设计器中，这需要默认 ctor。

OTOH，VS2008 能够加载这样的表格。我相信它实际上并没有实例化我的表单（如[本问题](https://stackoverflow.com/questions/786632)所述）：即使是默认的ctors也不会被执行。它并没有真正执行 InitializeComponent()。我刚刚在该函数中添加了一个消息框，但它没有显示。

看起来它动态地模仿了自定义表单类型，并且只执行了 InitializeComponent 中它认为相关的部分代码。

有谁知道我在哪里可以找到有关 VS 设计器如何工作的更多信息。

TIA。

注意：我发现这个[相关问题](https://stackoverflow.com/questions/472694)没有令人满意的答案

编辑：附加信息：史蒂夫将我指向 CodeDom，这非常有趣。不过，我的问题是我需要加载到我的设计器中的类型已经编译，而不是作为源代码提供。我找不到任何方法将 CodeDom 反序列化应用于已编译的代码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-16T14:45:47.863

[在这里](http://blogs.msdn.com/rprabhu/archive/2004/12/12/280823.aspx)找到这个：

> 当您在 VS 中打开一个新的 Windows 应用程序项目时，您会在设计视图中看到一个名为 Form1 的空窗体。现在，您还没有构建项目，那么设计人员如何能够创建 Form1 的实例并显示它呢？好吧，设计器根本没有真正实例化 Form1。它正在创建Form1 基类的一个实例，即System.Windows.Forms.Form。有了面向对象编程的基本知识，您会发现这在直觉上是有道理的。在设计 Form1 时，您从基类 Form 开始，并对其进行自定义。这正是设计师帮助你做的事情。
> 
> 现在假设您向窗体添加了一堆控件并关闭了设计器。当您重新打开设计器时，控件仍然存在。但是基类Form上并没有这些控件，所以如果设计者没有运行Form1的构造函数，它是如何显示控件的呢？设计器通过反序列化 InitializeComponent 中的代码来做到这一点。设计器支持的每种语言都有一个 CodeDomProvider，它负责提供一个解析器，该解析器解析 InitializeComponent 中的代码并创建它的 CodeDom 表示。然后，设计人员调用一组 CodeDomSerializer 将其反序列化为可以添加到设计时表单的实际控件（或更广泛地说，组件）。现在，我已经掩盖了该描述中的很多细节，但这里的重点是 Form1 的构造函数和 InitializeComponent 从未真正被调用过。相反，设计者解析 InitializeComponent 中的语句以确定要实例化哪些控件并将其添加到表单中。

* * *

以上是 Visual Studio 中的 Windows 窗体设计器如何加载窗体。如果您正在寻找的是一种创建没有默认构造函数**并且**仍然可以访问包含的组件/控件的表单实例的方法，那么我不知道有解决方案。我知道的唯一允许您绕过缺少默认构造函数的方法是[FormatterServices.GetUninitializedObject](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatterservices.getuninitializedobject(VS.71).aspx)，但要注意...

> 因为对象的新实例被初始化为零并且没有运行构造函数，所以该对象可能不代表该对象认为有效的状态。

我也有一个需要实例化编译表单的应用程序，但一直使用[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)并要求其他开发人员至少包含一个私有默认构造函数，如果他们希望他们的表单可以在我的应用程序中访问。由于我们拥有整个代码库并且每个人都知道需求，所以这不是问题并且对我们来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T14:49:11.477

作为史蒂夫回答的补充，如果您将新的 Windows 窗体添加到项目中，但使其抽象化，您仍然可以在设计器中打开它。但是，如果您添加另一个表单，并使其派生自第一个（抽象）表单，则在尝试在设计器中打开该表单时会出现错误。

# database - Delphi - 数据库服务器

> ID：872538
> 
> 赞同：1
> 
> 时间：2009-05-16T14:33:38.283
> 
> 标签：database, delphi

人们会推荐哪些数据库服务器用于中到大型（因客户而异）应用程序。

我知道 MS SQL，但由于该应用程序将使用 delphi 开发，因此 .net 框架的部署也有点烦人。Interbase 的可行性也是如此。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T17:26:18.493

由于我已经在 Firebird 开发了几年，如果我处于你的情况，我不会再看下去了。您可以在 Delphi 中开发自己的扩展库（udf 库）这一事实使其非常有吸引力。一些新的 SQL 结构，如 List 聚合器和 Common Table Expressions 是锦上添花。部署非常轻量（小于 5 MB），并且支持非常出色，包括 IBExpert 等令人难以置信的工具。我在几年前工作的一家大公司中使用 MS SQL Server，我会选择 Firebird 而不是 MS SQL Server。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T15:47:35.423

对 SQL Server 的数据访问与 .NET 框架无关。Delphi 可以很好地连接到 SQL Server。

在使用 delphi 的数据库引擎方面，您可以考虑的另一个是[Sybase Advantage](http://www.sybase.com/products/databasemanagement/advantagedatabaseserver)数据库服务器

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T20:18:55.320

Interbase 与它们一样可靠。事实上，我想找一份 Interbase DBA 的工作，因为我可以使用 sleep。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T14:42:49.883

我绝对会推荐查看Embarcadero 的[Interbase](http://www.codegear.com/products/interbase)或开源兄弟[Firebird](http://www.firebirdsql.org/)。Delphi 通过本机、高性能的数据库访问组件等很好地支持了这两者。

Interbase 是一个完全坚如磐石的数据库——我将它与 SQL Server 或 Oracle 相提并论。它完全能够同时处理至少 50-100 个用户的中高流量，完全没有问题。

另外两个有价值的竞争对手是[Elevate DB](http://www.elevatesoft.com/prodinfo?action=list)和[Nexus DB](http://www.nexusdb.com/support/index.php)。两者都是从基于文件的 Delphi 数据库系统发展而来的，并且都已经存在了相当长的一段时间（以一种或另一种形式）并且都经过充分证明、广泛使用和测试。

马克

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T15:09:19.337

这对我来说似乎是从前到后的。我会先选择数据库服务器，然后选择最适合所选数据库的开发环境。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T17:43:20.043

SQL 服务器。对于 2005，您可以制作自己的 SQL Server 部署应用程序，自动安装 Windows Installer 3.1、.NET Framework 2.0、SQL Server 2005，然后通过生成的 SQL 脚本安装数据库（如果您需要帮助，请随时与我联系，我很乐意帮助你）。如果您仍然坚持不安装 22MB 的 .Net 框架，我会说使用 SQL Server 2000，因为您仍然可以根据需要将其升级到 2005+。

另外，我已经使用 Advantage Database Server 几年了，没关系，几乎没有要复制的 DLL，即使您想切换到远程版本，您也可以开始使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-16T15:53:12.133

我在 Delphi 中使用不同版本的 SQL Server 开发了大约 6 年，这个数据库服务器表现得非常非常好。所有这些都是关键应用程序。

因此，我建议您继续使用它。如果您不想将 .NET 与 SQL Server 一起使用并保留 SQL Server，我建议您使用 2005 年之前的旧版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T16:06:46.343

MS SQL 的服务器和客户端安装都需要目标机器上的 .NET 框架。就是这样。如果我们可以在目标机器上使用没有 .net 的 ms sql，那么 ms sql 就可以了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-23T11:00:15.487

这并不是一个真正的答案，但在做出决定之前您可能需要考虑一些事情。

中到大规模是什么意思？您是指并发用户数还是存储的数据量？

您是否会在部署数据库时同时支持数据库，或者客户是否有自己的 DBA 并希望将其纳入其基础架构团队的职权范围？

您是否需要内置一些数据库可能开箱即用的复杂功能，例如审计或细粒度安全性？您是否需要能够以某种受控方式在数据库上运行夜间批处理？

您是否需要能够拥有强大的大容量事务支持，还是仅仅用作报告数据的接收器？即它是更多的OLTP 还是OLAP？

你受成本限制吗？即它是否需要免费/开源，或者您可以选择付费供应商产品吗？

Firebird 和 Interbase 都很棒，但根据我的经验，它们通常不会被“企业”环境所接受，除非它们“不干涉”并嵌入到应用程序中。MS SQL Server 是大多数系统的“安全选择”。它需要付出一定的代价，但如您所知，它确实带有完整的工具集和非常好的支持。

如果您确实选择了 Firebird 或 Interbase 路线，那么请查看 Jason Wharton 的 IBObjects 库，它在使用这些数据库时提供了 BDE 的高性能替代品。[http://www.ibobjects.com/](http://www.ibobjects.com/)

# floating-point - 在 16、32 和 64 位 IEEE-754 系统中可以表示什么范围的数字？

> ID：872544
> 
> 赞同：81
> 
> 时间：2009-05-16T14:37:41.893
> 
> 标签：floating-point, precision, numerical, ieee-754

我对浮点数的表示方式略知一二，但恐怕还不够。

一般的问题是：

> 对于给定的精度（出于我的目的，以 10 为基数的精确小数位数），对于 16、32 和 64 位 IEEE-754 系统可以表示什么范围的数字？

具体来说，我只对精确到 +/-0.5（个位）或 +/-0.0005（千分位）的 16 位和 32 位数字的范围感兴趣。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-05-16T16:30:44.070

对于给定的[IEEE-754](http://en.wikipedia.org/wiki/IEEE_754)浮点数**X**，如果

```
2^E <= abs(X) < 2^(E+1) 
```

那么从**X**到下一个最大的可表示浮点数（[epsilon](https://en.wikipedia.org/wiki/Machine_epsilon)）的距离是：

```
epsilon = 2^(E-52)    % For a 64-bit float (double precision)
epsilon = 2^(E-23)    % For a 32-bit float (single precision)
epsilon = 2^(E-10)    % For a 16-bit float (half precision) 
```

上述等式允许我们计算以下内容：

*   *对于[半精度](http://en.wikipedia.org/wiki/Half_precision)...*

    如果您希望精度为 +/-0.5（或 2^-1），则该数字的最大大小为 2^10。任何大于此的浮点数之间的距离大于 0.5。

    如果您希望精度为 +/-0.0005（约 2^-11），则该数字的最大大小为 1。任何大于此的数字且浮点数之间的距离大于 0.0005。

*   *对于[单精度](http://en.wikipedia.org/wiki/Single_precision)...*

    如果您希望精度为 +/-0.5（或 2^-1），则该数字的最大大小为 2^23。任何大于此的浮点数之间的距离大于 0.5。

    如果您希望精度为 +/-0.0005（约 2^-11），则该数字的最大大小为 2^13。任何大于此值且浮点数之间的距离大于 0.0005。

*   *对于[双精度](http://en.wikipedia.org/wiki/Double_precision)...*

    如果您希望精度为 +/-0.5（或 2^-1），则该数字的最大大小为 2^52。任何大于此的浮点数之间的距离大于 0.5。

    如果您希望精度为 +/-0.0005（约 2^-11），则该数字的最大大小为 2^42。任何大于此值且浮点数之间的距离大于 0.0005。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-16T21:30:50.403

对于浮点整数（我将根据 IEEE 双精度给出我的答案），1 到 2^53 之间的每个整数都是可以精确表示的。超过 2^53 时，可精确表示的整数之间的间距为 2 的递增幂。例如：

*   2^53 + 2 和 2^54 之间的每个第二个整数都可以精确表示。
*   可以精确表示 2^54 + 4 和 2^55 之间的每第四个整数。
*   可以精确表示 2^55 + 8 和 2^56 之间的每第 8 个整数。
*   可以精确表示 2^56 + 16 和 2^57 之间的每 16 个整数。
*   可以精确表示 2^57 + 32 和 2^58 之间的每个第 32 个整数。
*   可以精确表示 2^58 + 64 和 2^59 之间的每 64 个整数。
*   可以精确表示 2^59 + 128 和 2^60 之间的每 128 个整数。
*   可以精确表示 2^60 + 256 和 2^61 之间的每 256 个整数。
*   可以精确表示 2^61 + 512 和 2^62 之间的每 512 个整数。. . .

不能精确表示的整数会四舍五入到最接近的可表示整数，因此最坏情况的舍入是可表示整数之间间距的 ​​1/2。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-16T16:15:05.293

精确引用来自 Peter R 的 MSDN 参考链接可能是一个很好的经验法则，但当然现实更复杂。

“浮点”中的“点”是*二进制*点而不是小数点这一事实有悖于我们的直觉。经典的例子是 0.1，它只需要十进制的一位精度，但根本不能精确地用二进制表示。

如果您有一个周末要打发，请查看[每个计算机科学家应该了解的关于浮点运算的知识](http://docs.sun.com/source/806-3568/ncg_goldberg.html)。您可能会对[Precision](http://docs.sun.com/source/806-3568/ncg_goldberg.html#810)和[Binary to Decimal Conversion](http://docs.sun.com/source/806-3568/ncg_goldberg.html#1251)部分特别感兴趣。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-16T16:14:09.993

首先，IEEE-754-2008 和 -1985 都没有 16 位浮点数；但它是一个 5 位指数和 10 位小数的建议加法。IEE-754 使用专用的符号位，所以正负范围是一样的。此外，分数前面有一个隐含的 1，所以你会得到一个额外的位。

如果你想要精确到个位，就像你可以表示每个整数一样，答案很简单：指数将小数点移动到分数的右端。所以，一个 10 位的分数可以得到 ±2 ^(11)。

如果你想要小数点后的一位，你放弃它之前的一位，所以你有 ±2 ^(10)。

单精度有一个 23 位小数，所以你有 ±2 ^(24 个)整数。

小数点后需要多少位精度完全取决于您正在执行的计算，以及您正在执行多少位。

*   2 ^(10) = 1,024
*   2 ^(11) = 2,048
*   2 ^(23) = 8,388,608
*   2 ^(24) = 16,777,216
*   2 ^(53) = 9,007,199,254,740,992（双精度）
*   2 ^(113) = 10,384,593,717,069,655,257,060,992,658,440,192（四精度）

## 也可以看看

*   [双精度](https://en.wikipedia.org/wiki/Double_precision "维基百科上的双精度")
*   [半精度](https://en.wikipedia.org/wiki/Half_precision "维基百科上的半精度")

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T16:48:17.227

参见[IEEE 754-1985](http://en.wikipedia.org/wiki/IEEE_754%2D1985)：

![v = (-1)^sign * s^(exponent-exponent_bias) * (1 + 分数)](https://upload.wikimedia.org/math/7/7/5/775c2ad6fc57863c981972a84dc42f52.png)

注意（1 + 分数）。正如[@bendin](https://stackoverflow.com/questions/872544/precision-of-floating-point/872723#872723)指出的那样，使用二进制浮点，您不能表示简单的十进制值，例如 0.1。这意味着您可以通过多次执行简单的加法或调用截断之类的方法来引入舍入误差。如果您对任何类型的精度感兴趣，实现它的唯一方法是使用定点小数，它基本上是一个缩放整数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T15:36:33.467

如果我正确理解您的问题，这取决于您的语言。
对于 C#，请查看[MSDN 参考](http://msdn.microsoft.com/en-us/library/678hzkk9(VS.80).aspx)。Float 具有 7 位精度和双 15-16 位精度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-16T17:41:07.070

我花了很长时间才弄清楚，在 Java 中使用双精度时，我并没有在计算中失去显着的精度。浮点实际上具有以相当合理的精度表示数字的非常好的能力。我失去的精度是在将用户输入的**十进制数字转换为本机支持的****二进制**浮点表示时立即丢失的。我最近开始将我所有的数字转换为 BigDecimal。BigDecimal 在代码中处理的工作比浮点数或双精度数要多得多，因为它不是原始类型之一。但另一方面，我将能够准确地表示用户输入的数字。

# vb.net - 在 VB.NET 2005 中生成 PDF

> ID：872556
> 
> 赞同：1
> 
> 时间：2009-05-16T14:40:57.220
> 
> 标签：vb.net, pdf-generation

我在生成 PDF 文档时遇到问题，我想在 PDF 文档中显示的文本超出了 PDF 纸张范围。如何调整文本以适应页面范围？

这是我的代码示例，其中显示了一些问题和答案：

```
 Dim PDF As PDFCreatorPilotLib.PDFDocument3
    ' create pdf library object
    PDF = New PDFCreatorPilotLib.PDFDocument3
    ' initialize PDF Engine
    PDF.StartEngine("demo@demo", "demo")
    ' set filename

    PDF.FileName = "TestVB.PDF"
    PDF.AutoLaunch = True ' auto-open generated pdf document

    ' start document generation
    PDF.BeginDoc()

    PDF.PDFPAGE_SetActiveFont("Verdana", True, False, False, False, 9, 0)
    PDF.PDFPAGE_TextOut(80, 270, 0, Label5.Text)
    PDF.PDFPAGE_TextOut(100, 270, 0, Questions1TextBox.Text)
    PDF.PDFPAGE_TextOut(80, 300, 0, Label3.Text)
    PDF.PDFPAGE_TextOut(100, 300, 0, Answers1TextBox.Text)

    PDF.PDFPAGE_TextOut(80, 330, 0, Label6.Text)
    PDF.PDFPAGE_TextOut(100, 330, 0, TextBox14.Text)
    PDF.PDFPAGE_TextOut(80, 360, 0, Label4.Text)
    PDF.PDFPAGE_TextOut(100, 360, 0, TextBox1.Text)

    PDF.PDFPAGE_TextOut(80, 390, 0, Label7.Text)
    PDF.PDFPAGE_TextOut(100, 390, 0, TextBox12.Text)
    PDF.PDFPAGE_TextOut(80, 420, 0, Label4.Text)
    PDF.PDFPAGE_TextOut(100, 420, 0, TextBox1.Text)

    ' finalize document generation
    PDF.EndDoc()
End Sub 
```

# flash - 自定义 AS3 类添加到 Array 后为空

> ID：872558
> 
> 赞同：1
> 
> 时间：2009-05-16T14:44:04.547
> 
> 标签：flash, actionscript-3, null, object-reference

我是一名 C# 开发人员，正在尝试学习一些 AS3，所以这将是一个非常新手的问题。

我对范围和 GC 感到困惑，因为我有一个自定义的 MovieClip 扩展类 (Slide)，我在循环中创建实例并将 push() 放入一个数组中，但是之后当我拉取它们时这些项目为空出集合。

```
var ldr:URLLoader = new URLLoader();
ldr.load(new URLRequest("presentation.xml"));
ldr.addEventListener(
    Event.COMPLETE,
     function(e:Event):void {
         config = new XML(e.target.data);
         for (var i:Number = 0; i < config.slides.slide.length(); i++)
         {
             var node = config.slides.slide[i];
             var slide:Slide = new Slide();                      
             slides.push(slide);

             addChild(slide); // Works fine
         }
     }
);

slides.forEach(function(e:*, index:int, array:Array):void
    {
        addChild(e); // Causes "Parameter child must be non-null" exception
    }
); 
```

我希望以后能够引用幻灯片，以便根据需要切换它们 - 如何保持对新对象的引用？

**更新：**这似乎有两个问题。在调用 URLLoader 的完整事件之前进行了 forEach 调用，而且 forEach 似乎也没有按预期工作。这是最终的工作代码：

```
var ldr:URLLoader = new URLLoader();
ldr.load(new URLRequest("presentation.xml"));
ldr.addEventListener(
    Event.COMPLETE,
    function(e:Event):void {
        config = new XML(e.target.data);
        for (var i:Number = 0; i < config.slides.slide.length(); i++)
        {
            var node = config.slides.slide[i];
            var slide:Slide = new Slide();                      
            slides.push(slide);
        }
        for each (var sl in slides)
        {
            addChild(sl);
        }
    }
); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T15:45:44.710

您的 slides.forEach 调用在事件被触发之前执行，因此 slides 数组没有值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T18:28:02.370

试试这个。让我们看看它是否会跟踪您的幻灯片。

```
var ldr:URLLoader = new URLLoader();
ldr.addEventListener(Event.COMPLETE, processXML);
ldr.load(new URLRequest("presentation.xml"));

function processXML(e:Event):void {
    config = new XML(e.target.data);
    var slide:Slide;
    for (var i:Number = 0; i < config.slides.slide.length(); i++)
    {
        var node = config.slides.slide[i];
        slide = new Slide();                                          
        slides.push(slide);

        addChild(slide); // Works fine
    }

    for each(var slide:Slide in slides){
        trace(slide);
    }
 } 
```

我在这里编码，所以我不能保证它会工作。另外，我没有剩下的代码，所以你必须自己测试它。

# iphone - 512x512 纹理在 iPhone 上造成巨大的 GPU 压力，尽管平铺

> ID：872560
> 
> 赞同：2
> 
> 时间：2009-05-16T14:45:08.537
> 
> 标签：iphone, performance, opengl-es, textures

我正在 iPhone 上测试我的简单 OpenGL ES 实现（2D 游戏），我注意到在使用分析器时**渲染利用率很高。**这些是事实：

*   我**仅以 60fps 显示一个预加载的大纹理**（**512x512 像素**），渲染利用率约为 40%。
*   我的纹理是使用 混合的`GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA`，**这是我使用的唯一 GL 函数**。
*   我试图使纹理**更小并平铺**，这**没有任何区别**。
*   我正在使用 1024x1024 像素的 PNG 纹理图集

我觉得很奇怪，这个**纹理会导致如此密集的 GPU 使用。**

**这是可以预料的吗？**我究竟做错了什么？

**编辑：**我的代码：

```
// OpenGL setup is identical to OpenGL ES template
// initState is called to setup
// timer is initialized, drawView is called by the timer

- (void) initState
{
    //usual init declarations have been omitted here        
    glEnable(GL_BLEND); 
    glBlendFunc(GL_ONE,GL_ONE_MINUS_SRC_ALPHA);     
    glEnableClientState (GL_VERTEX_ARRAY);
    glVertexPointer     (2,GL_FLOAT,sizeof(Vertex),&allVertices[0].x);          
    glEnableClientState (GL_TEXTURE_COORD_ARRAY);
    glTexCoordPointer   (2,GL_FLOAT,sizeof(Vertex),&allVertices[0].tx);     
    glEnableClientState (GL_COLOR_ARRAY);
    glColorPointer      (4,GL_UNSIGNED_BYTE,sizeof(Vertex),&allVertices[0].r);    
}    
- (void) drawView
{       
    [EAGLContext setCurrentContext:context];
    glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);

    glMatrixMode(GL_PROJECTION); 
    glLoadIdentity();

    GLfloat width  = backingWidth /2.f; 
    GLfloat height = backingHeight/2.f; 

    glOrthof(-width, width, -height, height, -1.f, 1.f);
    glMatrixMode(GL_MODELVIEW);
    glClearColor(0.f, 0.f, 0.f, 1.f);
    glClear(GL_COLOR_BUFFER_BIT);       
    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

    glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);       
    [context presentRenderbuffer:GL_RENDERBUFFER_OES];      
    [self checkGLError];        
} 
```

**编辑：**我做了一些改进，但没有一个能够降低渲染利用率。我将纹理划分为 32x32 的部分，将坐标和纹理坐标的类型从 GLfloat 更改为 GLshort，并为退化三角形添加了额外的顶点。

更新内容是：

**initState：（** 顶点和纹理指针现在是 GL_SHORT）

```
glMatrixMode(GL_TEXTURE);
glScalef(1.f / 1024.f, 1.f / 1024.f, 1.f / 1024.f);
glMatrixMode(GL_MODELVIEW);
glScalef(1.f / 16.f, 1.f/ 16.f, 1.f/ 16.f); 
```

**绘制视图：**

```
glDrawArrays(GL_TRIANGLE_STRIP, 0, 1536); //(16*16 parts * 6 vertices) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-28T21:43:41.873

我正在编写一个应用程序，它使用 GL_SRC_ALPHA、GL_ONE_MINUS_SRC_ALPHA 在 2D 环境中彼此叠加显示五个 512x512 纹理，我可以获得大约 14fps。你真的需要60fps吗？对于一场比赛，我认为24-30就可以了。此外，尽可能使用 PVR 纹理压缩。SDK 中包含一个示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-02T11:46:26.263

1.  我希望您在不需要时不要忘记禁用`GL_BLEND`它。
2.  您可以尝试优化内存带宽 - 使用 16 bpp 格式或 PVRTC。恕我直言，您的纹理大小纹理缓存根本没有帮助。
3.  不要忘记您的帧缓冲区正在被 iPhone UI 用作纹理。如果它被创建为 32 位 RGBA，它将再进行一次 alpha 混合。为了获得最佳性能，16 位 565 帧缓冲区是最好的（但图形质量会受到影响）。

我不知道所有细节，例如缓存大小，但是，我想，纹理像素在上传到视频内存时已经混合，三角形被 PVR 平铺引擎分割。因此，您自己的拆分似乎是多余的。

最后。这只是一个移动低功耗 GPU，不是为大屏幕和高填充率而设计的。Alpha 混合成本很高，可能是 PowerVR 芯片的 3-4 倍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T15:02:17.170

[阅读这篇文章。](https://stackoverflow.com/questions/450042/why-is-this-opengl-es-code-slow-on-iphone/450088)

512x512 对于 iPhone 来说可能有点过于乐观了。

编辑：

我假设你已经阅读了这篇文章，但如果没有，[请查看 Apples guide to best OpenGL ES performance on iPhone。](http://developer.apple.com/iphone/library/technotes/tn2008/tn2230.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-28T21:39:08.577

究竟是什么问题？
您将获得 60fps 的速度，如丝般顺滑。

谁在乎渲染利用率是否为 40%？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-28T21:53:33.477

问题可能是因为 iPhone 的纹理缓存大小。它可能只是归结为每个单独的三角形、四边形或三边形上有多少纹理，具体取决于您设置状态的方式。

试试这个：细分你的四边形并重复你的测试。因此，如果您是 1 个四边形，则使其成为 4 个。然后是 16 个。依此类推，看看是否有帮助。关键是减少每个图元引用的实际像素数。

*当纹理缓存被炸毁时，硬件会将纹理查找从主内存转换到为每个像素*的纹理缓冲区留出的任何 vram 中。这会很快杀死性能。

或者 - 我完全错了，因为我真的不了解 iPhone 硬件，而且我也知道 PVR 芯片与我习惯的（PS2、PSP）相比是一种奇怪的野兽。仍然是一个简单的测试，我很好奇它是否有帮助。

# algorithm - 随机选择具有频率的项目的有效算法

> ID：872563
> 
> 赞同：10
> 
> 时间：2009-05-16T14:48:41.430
> 
> 标签：algorithm, random, big-o

给定一个`n`词频对数组：

```
[ (w 0 , f 0 ), (w 1 , f 1 ), ..., (w n-1 , f n-1 ) ]
```

其中是一个词，是一个整数频率，频率之和，`w[i]``f[i]``∑f[i] = m`

我想使用伪随机数生成器 (pRNG) 来选择`p`单词，以便选择任何单词的概率与其频率成正比：`w[j[0]], w[j[1]], ..., w[j[p-1]]`

```
P(w i = w j [k] ) = P(i = j k ) = f i / m
```

（注意，这是带替换的选择，所以每次都可以选择同一个词）*。*

到目前为止，我已经提出了三种算法：

1.  创建一个大小为 的数组`m`，并将其填充为第一个条目是，下一个条目是，依此类推，所以最后一个条目是。`f[0]``w[0]``f[1]``w[1]``f[p-1]``w[p-1]`

    ```
    [ w 0 , ..., w 0 , w 1 ,..., w 1 , ..., w p-1 , ..., w p-1 ]
    ```

    然后使用 pRNG 选择`p`range 中的索引`0...m-1`，并报告存储在这些索引处的单词。
    这需要`O(n + m + p)`工作，这不是很好，因为`m`它可能比 n 大得多。
2.  遍历输入数组一次，计算

    ```
    m i = ∑ h≤i f h = m i-1 + f i
    ```

    在计算 之后，使用 pRNG为每个in生成一个范围内的数字， 并选择for （可能替换 的当前值） if 。 这需要工作。`m[i]``x[k]``0...m[i]-1``k``0...p-1``w[i]``w[j[k]]``w[j[k]]``x[k] < f[i]`
    `O(n + np)`
3.  按照算法 2 进行计算，并在 n 个词频部分和三元组上生成以下数组：`m[i]`

    ```
    [ (w 0 , f 0 , m 0 ), (w 1 , f 1 , m 1 ), ..., (w n-1 , f n-1 , m n-1 ) ]
    ```

    然后，对于每个 k in ，使用 pRNG在范围内`0...p-1`生成一个数字，然后对三元组数组进行二进制搜索以找到st ，然后选择for 。 这需要工作。`x[k]``0...m-1``i``m[i]-f[i] ≤ x[k] < m[i]``w[i]``w[j[k]]`
    `O(n + p log n)`

**我的问题是**：有没有更有效的算法可以用于此，或者这些算法是否尽可能好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T15:06:17.987

这听起来像轮盘赌选择，主要用于遗传/进化算法中的选择过程。

看看[遗传算法中的轮盘赌选择](https://stackoverflow.com/questions/177271/roulette-selection-in-genetic-algorithms)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T15:54:48.103

您可以创建目标数组，然后遍历确定应该选择它的概率的单词，并根据随机数替换数组中的单词。

对于第一个单词，概率为 f [0] /m [0]（其中 m [n] =f [0] +..+f [n]），即 100%，因此目标数组中的所有位置都将填充 w [0]。

对于以下单词，概率下降，并且当您到达最后一个单词时，目标数组将填充随机挑选的符合频率的单词。

C# 中的示例代码：

```
public class WordFrequency {

    public string Word { get; private set; }
    public int Frequency { get; private set; }

    public WordFrequency(string word, int frequency) {
        Word = word;
        Frequency = frequency;
    }

}

WordFrequency[] words = new WordFrequency[] {
    new WordFrequency("Hero", 80),
    new WordFrequency("Monkey", 4),
    new WordFrequency("Shoe", 13),
    new WordFrequency("Highway", 3),
};

int p = 7;
string[] result = new string[p];
int sum = 0;
Random rnd = new Random();
foreach (WordFrequency wf in words) {
    sum += wf.Frequency;
    for (int i = 0; i < p; i++) {
        if (rnd.Next(sum) < wf.Frequency) {
            result[i] = wf.Word;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T22:10:18.920

好的，我找到了另一种算法：[别名方法（](http://prxq.wordpress.com/2006/04/17/the-alias-method/)[在这个答案中](https://stackoverflow.com/questions/352670/weighted-random-selection-with-and-without-replacement/353576#353576)也提到过）。基本上，它创建了概率空间的分区，使得：

*   有`n`分区，宽度都一样`r`st `nr = m`。
*   每个分区包含一定比例的两个单词（与分区一起存储）。
*   对于每个单词，`w[i]``f[i] = ∑[partitions t s.t w[i] ∈ t] r × ratio(t,w[i])`

由于所有分区的大小相同，因此可以在恒定工作中选择哪个分区（从`0...n-1`随机选择一个索引），然后可以使用分区的比率来选择在恒定工作中使用哪个单词（比较一个 pRNGed 数与两个词之间的比率）。所以这意味着`p`选择可以在`O(p)`工作中完成，给定这样的分区。

存在这种划分的原因是存在一个词st ，当且仅当存在一个词st时，因为 r 是频率的平均值。 `w[i]``f[i] < r``w[i']``f[i'] > r`

给定这样的一对，我们可以分别用频率的伪词（用概率和概率表示）和调整频率的新词来替换它们。所有单词的平均频率仍然是 r，并且上一段的规则仍然适用。由于伪词的频率为r，并且由频率≠r的两个词组成，我们知道如果我们迭代这个过程，我们永远不会从一个伪词中产生一个伪词，并且这样的迭代必须以a结束n 个伪词的序列，它们是所需的分区。`w[i]``w[i']``w'[i]``f'[i] = r``w[i]``f[i]/r``w[i']``1 - f[i]/r``w'[i']``f'[i'] = f[i'] - (r - f[i])`

为了及时构建这个分区`O(n)`，

*   遍历单词列表一次，构建两个列表：
    *   频率≤r的词之一
    *   频率 > r 的词之一
*   然后从第一个列表中拉出一个词
    *   如果它的频率 = r，则使其成为一个元素分区
    *   否则，从另一个列表中拉出一个单词，并用它来填充一个两个单词的分区。然后根据调整后的频率将第二个单词放回第一个或第二个列表中。

如果分区的数量，这实际上仍然有效`q > n`（你只需要以不同的方式证明它）。如果您想确保 r 是整数，并且您不能轻易找到st的因子`q`，则可以将所有频率填充, so的因子，它会在 时更新和设置。`m``q > n``n``f'[i] = nf[i]``m' = mn``r' = m``q = n`

无论如何，这个算法只需要`O(n + p)`工作，我认为这是最佳的。

在红宝石中：

```
def weighted_sample_with_replacement(input, p)
  n = input.size
  m = input.inject(0) { |sum,(word,freq)| sum + freq }

  # find the words with frequency lesser and greater than average
  lessers, greaters = input.map do |word,freq| 
                        # pad the frequency so we can keep it integral
                        # when subdivided
                        [ word, freq*n ] 
                      end.partition do |word,adj_freq| 
                        adj_freq <= m 
                      end

  partitions = Array.new(n) do
    word, adj_freq = lessers.shift

    other_word = if adj_freq < m
                   # use part of another word's frequency to pad
                   # out the partition
                   other_word, other_adj_freq = greaters.shift
                   other_adj_freq -= (m - adj_freq)
                   (other_adj_freq <= m ? lessers : greaters) << [ other_word, other_adj_freq ]
                   other_word
                 end

    [ word, other_word , adj_freq ]
  end

  (0...p).map do 
    # pick a partition at random
    word, other_word, adj_freq = partitions[ rand(n) ]
    # select the first word in the partition with appropriate
    # probability
    if rand(m) < adj_freq
      word
    else
      other_word
    end
  end
end 
```

# git - 从 Git 历史记录中删除敏感文件及其提交

> ID：872565
> 
> 赞同：453
> 
> 时间：2009-05-16T14:49:17.590
> 
> 标签：git, git-commit, git-filter-branch, git-rewrite-history

我想在 GitHub 上放置一个 Git 项目，但它包含某些带有敏感数据的文件（用户名和密码，例如 capistrano 的 /config/deploy.rb）。

我知道我可以将这些文件名添加到**.gitignore**，但这不会删除它们在 Git 中的历史记录。

我也不想通过删除 /.git 目录重新开始。

有没有办法删除Git 历史记录中特定文件的**所有痕迹？**

* * *

## 回答 #1

> 赞同：547
> 
> 时间：2009-05-16T16:04:11.857

出于所有实际目的，您*首先*应该担心的是**更改密码！**从您的问题中不清楚您的 git 存储库是完全本地的还是您在其他地方是否有远程存储库；如果它是远程的并且不受其他人的保护，那么您就有问题了。如果有人在您修复此问题之前克隆了该存储库，他们将在他们的本地计算机上拥有您的密码副本，并且您无法强制他们更新到您的“修复”版本，因为它已从历史记录中消失。您可以做的唯一安全的事情是在您使用过的任何地方将密码更改为其他密码。

* * *

有了这个，这里是如何解决它。[GitHub 作为 FAQ 准确地回答了这个问题](https://help.github.com/articles/remove-sensitive-data "删除敏感数据 - GitHub 帮助")：

**Windows 用户注意事项**：在此命令中使用双引号 (") 而不是单引号

```
git filter-branch --index-filter \
'git update-index --remove PATH-TO-YOUR-FILE-WITH-SENSITIVE-DATA' <introduction-revision-sha1>..HEAD
git push --force --verbose --dry-run
git push --force 
```

**2019 年更新：**

这是常见问题解答中的当前代码：

```
 git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch PATH-TO-YOUR-FILE-WITH-SENSITIVE-DATA" \
  --prune-empty --tag-name-filter cat -- --all
  git push --force --verbose --dry-run
  git push --force 
```

请记住，一旦您将此代码推送到 GitHub 等远程存储库，并且其他人已经克隆了该远程存储库，您现在就处于重写历史的情况。当其他人在此之后尝试下拉您的最新更改时，他们会收到一条消息，指出无法应用更改，因为它不是快进。

[要解决这个问题，他们必须删除现有的存储库并重新克隆它，或者按照git-rebase 手册页](http://git-scm.com/docs/git-rebase)中“从上游 REBASE 恢复”下的说明进行操作。

**提示**：执行`git rebase --interactive`

* * *

将来，如果您不小心提交了一些包含敏感信息的更改，但您在推送到远程存储库**之前**注意到了，则有一些更简单的修复。如果您上次提交是添加敏感信息的提交，您可以简单地删除敏感信息，然后运行：

```
git commit -a --amend 
```

这将使用您所做的任何新更改来修改先前的提交，包括使用`git rm`. 如果更改在历史上更早但仍未推送到远程存储库，则可以执行交互式 rebase：

```
git rebase -i origin/master 
```

这将打开一个编辑器，其中包含自您与远程存储库的最后一个共同祖先以来所做的提交。在代表带有敏感信息的提交的任何行上将“pick”更改为“edit”，然后保存并退出。Git 将遍历更改，并将您留在一个可以执行以下操作的位置：

```
$EDITOR file-to-fix
git commit -a --amend
git rebase --continue 
```

对于包含敏感信息的每个更改。最终，您将回到您的分支，并且可以安全地推送新的更改。

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2013-02-01T22:46:34.780

更改密码是个好主意，但是对于从存储库历史记录中删除密码的过程，我推荐[BFG Repo-Cleaner](http://rtyley.github.io/bfg-repo-cleaner/)，这是一种更快、更简单的替代方案，用于`git-filter-branch`明确设计用于从 Git 存储库中删除私有数据。

创建一个`private.txt`列出要删除的密码等的文件（每行一个条目），然后运行以下命令：

```
$ java -jar bfg.jar  --replace-text private.txt  my-repo.git 
```

将扫描您的存储库历史中阈值大小（默认为 1MB）的所有文件，并且任何匹配的字符串（不在您*最近*的提交中）将被替换为字符串“***REMOVED***”。然后，您可以使用`git gc`清除死数据：

```
$ git gc --prune=now --aggressive 
```

BFG 通常比运行快 10-50 倍，`git-filter-branch`并且围绕以下两个常见用例简化和定制选项：

*   删除**疯狂的大文件**
*   删除**密码、凭证**和其他**私人数据**

*全面披露：我是 BFG Repo-Cleaner 的作者。*

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2015-09-29T09:17:03.950

**如果你推送到 GitHub，强制推送是不够的，删除仓库或者联系支持**

即使你在之后强制推一秒钟，也不够，如下所述。

唯一有效的行动方案是：

*   是什么泄露了像密码一样的可更改凭证？

    *   是的：立即修改您的密码，并考虑使用更多的 OAuth 和 API 密钥！

    *   没有（裸照）：

        *   您是否关心存储库中的所有问题是否都被核爆？

            *   否：删除存储库

            *   是的：

                *   联系支持
                *   如果泄漏对您非常重要，以至于您愿意让存储库停机以降低泄漏的可能性，请在等待 GitHub 支持回复您时[将其设为私有](https://help.github.com/en/articles/setting-repository-visibility#making-a-repository-private)

一秒钟后强制推动是不够的，因为：

*   GitHub 长期保持悬空提交。

    但是，如果您联系 GitHub 工作人员，他们确实有权删除此类悬空提交。

    当我[将所有 GitHub 提交电子邮件上传到](https://github.com/cirosantilli/all-github-commit-emails)他们要求我删除它的存储库时，我亲身体验了这一点，所以我做到了，他们做了一个`gc`. [但是，必须删除](https://github.com/cirosantilli/all-github-commit-emails/tree/f37574b1146cb20d1fadd73830b7bf22da285151#update-2018-02-21)包含数据的拉取请求：因此，在初始删除后的一年内，该 repo 数据仍可访问。

    悬空提交可以通过以下方式查看：

    *   提交网页界面：[https](https://github.com/cirosantilli/test-dangling/commit/53df36c09f092bbb59f2faa34eba15cd89ef8e83) ://github.com/cirosantilli/test-dangling/commit/53df36c09f092bbb59f2faa34eba15cd89ef8e83 （[Wayback machine](https://web.archive.org/web/20150929085014/https://github.com/cirosantilli/test-dangling/commit/53df36c09f092bbb59f2faa34eba15cd89ef8e83)）
    *   API：[https](https://api.github.com/repos/cirosantilli/test-dangling/commits/53df36c09f092bbb59f2faa34eba15cd89ef8e83) ://api.github.com/repos/cirosantilli/test-dangling/commits/53df36c09f092bbb59f2faa34eba15cd89ef8e83 （[回程机](https://web.archive.org/web/20150929084951/https://api.github.com/repos/cirosantilli/test-dangling/commits/53df36c09f092bbb59f2faa34eba15cd89ef8e83)）

    然后在该提交处获取源的一种便捷方法是使用下载 zip 方法，该方法可以接受任何参考，例如：[https ://github.com/cirosantilli/myrepo/archive/SHA.zip](https://github.com/cirosantilli/myrepo/archive/SHA.zip)

*   可以通过以下方式获取丢失的 SHA：

    *   使用 列出 API 事件`type": "PushEvent"`。例如我的：[https](https://api.github.com/users/cirosantilli/events/public) ://api.github.com/users/cirosantilli/events/public （[Wayback 机器](https://web.archive.org/web/20150929085719/https://api.github.com/users/cirosantilli/events/public)）
    *   有时更方便的是，通过查看试图删除内容的拉取请求的 SHA
*   有像[http://ghtorrent.org/](http://ghtorrent.org/)和[https://www.githubarchive.org/](https://www.githubarchive.org/)这样的抓取工具会定期汇集 GitHub 数据并将其存储在其他地方。

    我找不到他们是否抓取了实际的提交差异，这不太可能，因为会有太多数据，但在技术上是可行的，并且 NSA 和朋友可能有过滤器来仅存档与人或感兴趣的提交相关的内容。

但是，如果您删除存储库而不是仅强制推送，则提交确实会立即从 API 中消失并给出 404，例如[https://api.github.com/repos/cirosantilli/test-dangling-delete/commits/8c08448b5fbf0f891696819f3b2b2d653f7a3824](https://api.github.com/repos/cirosantilli/test-dangling-delete/commits/8c08448b5fbf0f891696819f3b2b2d653f7a3824)这行得通即使您重新创建另一个具有相同名称的存储库。

为了测试这一点，我创建了一个 repo：[https](https://github.com/cirosantilli/test-dangling) ://github.com/cirosantilli/test-dangling并做了：

```
git init
git remote add origin git@github.com:cirosantilli/test-dangling.git

touch a
git add .
git commit -m 0
git push

touch b
git add .
git commit -m 1
git push

touch c
git rm b
git add .
git commit --amend --no-edit
git push -f 
```

另请参阅：[如何从 GitHub 中删除悬空提交？](https://stackoverflow.com/questions/4367977/how-to-remove-a-dangling-commit-from-github/32840385#32840385)

**`git filter-repo`现在官方推荐过`git filter-branch`**

`git filter-branch`Git 2.5 本身的手册页中提到了这一点。

使用 git filter repo，您​​可以使用以下命令删除某些文件：[从 git/GitHub 的历史记录中删除文件夹及其内容](https://stackoverflow.com/questions/10067848/remove-folder-and-its-contents-from-git-githubs-history/61544937#61544937)

```
pip install git-filter-repo
git filter-repo --path path/to/remove1 --path path/to/remove2 --invert-paths 
```

这会自动删除空提交。

或者您可以将某些字符串替换为：[如何替换整个 Git 历史中的字符串？](https://stackoverflow.com/questions/46950829/how-to-replace-a-string-in-a-whole-git-history/64153992#64153992)

```
git filter-repo --replace-text <(echo 'my_password==>xxxxxxxx') 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-11-22T01:05:51.463

我推荐大卫安德希尔的 [这个剧本，对我来说就像一个魅力。](http://dound.com/2009/04/git-forever-remove-files-or-folders-from-history/)

它在 natacado 的 filter-branch 之外添加了这些命令，以清理它留下的混乱：

```
rm -rf .git/refs/original/
git reflog expire --all
git gc --aggressive --prune 
```

完整脚本（全部归功于 David Underhill）

```
#!/bin/bash
set -o errexit

# Author: David Underhill
# Script to permanently delete files/folders from your git repository.  To use 
# it, cd to your repository's root and then run the script with a list of paths
# you want to delete, e.g., git-delete-history path1 path2

if [ $# -eq 0 ]; then
    exit 0
fi

# make sure we're at the root of git repo
if [ ! -d .git ]; then
    echo "Error: must run this script from the root of a git repository"
    exit 1
fi

# remove all paths passed as arguments from the history of the repo
files=$@
git filter-branch --index-filter \
"git rm -rf --cached --ignore-unmatch $files" HEAD

# remove the temporary history git-filter-branch
# otherwise leaves behind for a long time
rm -rf .git/refs/original/ && \
git reflog expire --all && \
git gc --aggressive --prune 
```

如果更改为以下命令，最后两个命令可能会更好地工作：

```
git reflog expire --expire=now --all && \
git gc --aggressive --prune=now 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2017-01-23T07:41:12.960

您可以使用`git forget-blob`.

用法很简单`git forget-blob file-to-forget`。你可以在这里获得更多信息

[https://ownyourbits.com/2017/01/18/completely-remove-a-file-from-a-git-repository-with-git-forget-blob/](https://ownyourbits.com/2017/01/18/completely-remove-a-file-from-a-git-repository-with-git-forget-blob/)

它将从您的历史记录、reflog、标签等中的所有提交中消失

我时不时地遇到同样的问题，每次我必须回到这篇文章和其他文章时，这就是我自动化这个过程的原因。

感谢 Stack Overflow 的贡献者，让我把这些放在一起

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2016-12-02T19:19:31.663

这是我在 Windows 中的解决方案

> git filter-branch --tree-filter "rm -f 'filedir/filename'" HEAD
> 
> git push --force

确保路径正确，否则将无法正常工作

我希望它有帮助

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-09-17T14:33:51.530

使用**过滤器分支**：

```
git filter-branch --force --index-filter 'git rm --cached --ignore-unmatch *file_path_relative_to_git_repo*' --prune-empty --tag-name-filter cat -- --all

git push origin *branch_name* -f 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-01-25T23:38:51.210

需要明确的是：接受的答案是正确的。先试试看。但是，对于某些用例，它可能会变得不必要地复杂，特别是如果您遇到令人讨厌的错误，例如“fatal: bad revision --prune-empty”，或者真的不关心您的 repo 的历史。

另一种选择是：

1.  cd 到项目的基础分支
2.  删除敏感代码/文件
3.  rm -rf .git/ # 从你的代码中删除所有 git 信息
4.  转到 github 并删除您的存储库
5.  按照本指南将您的代码像往常一样推送到新的存储库 - [https://help.github.com/articles/adding-an-existing-project-to-github-using-the-command-line/](https://help.github.com/articles/adding-an-existing-project-to-github-using-the-command-line/)

这当然会从您的 github 存储库和本地 git 存储库中删除所有提交历史记录分支和问题。如果这是不可接受的，您将不得不使用另一种方法。

将此称为核选项。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-02-01T09:46:59.000

在我的 android 项目中，我在**app/src/main/res/values/文件夹****中将 admob_keys.xml**作为单独的 xml 文件。为了删除这个敏感文件，我使用了下面的脚本并且工作得很好。

 **```
git filter-branch --force --index-filter \
'git rm --cached --ignore-unmatch  app/src/main/res/values/admob_keys.xml' \
--prune-empty --tag-name-filter cat -- --all 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-03-21T18:23:36.280

迄今为止，我不得不这样做几次。请注意，这一次仅适用于 1 个文件。

1.  获取修改文件的所有提交的列表。底部的那个将是第一个提交：

    `git log --pretty=oneline --branches -- pathToFile`

2.  要从历史记录中删除文件，请使用第一个提交 sha1 和上一个命令中的文件路径，并将它们填充到此命令中：

    `git filter-branch --index-filter 'git rm --cached --ignore-unmatch <path-to-file>' -- <sha1-where-the-file-was-first-added>..`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-04-27T08:33:13.573

所以，它看起来像这样：

```
git rm --cached /config/deploy.rb
echo /config/deploy.rb >> .gitignore 
```

> 从 git 中删除跟踪文件的缓存并将该文件添加到`.gitignore`列表中

# python - 一些Python代码的帮助

> ID：872566
> 
> 赞同：-3
> 
> 时间：2009-05-16T14:49:34.860
> 
> 标签：python, ctypes

谁能告诉我为什么 num_chars 和 num_rows 必须相同？

```
from ctypes import *

num_chars = 8
num_rows = 8
num_cols = 6

buffer = create_string_buffer (num_chars*num_rows*num_cols+num_chars)

for char in range(num_chars):
        for row in range(num_rows):
                for col in range(num_cols):
                        if char == num_chars-1 and col == num_cols-1:
                                buffer[row*num_rows*num_cols+char*num_cols+col+row] = '|'
                                buffer[row*num_rows*num_cols+char*num_cols+col+row+1] = '\n'
                        elif col == num_cols-1:
                                buffer[row*num_rows*num_cols+char*num_cols+col+row] = '|'
                        else:
                                buffer[row*num_rows*num_cols+char*num_cols+col+row] = ('.', '*')[char>row]

print buffer.value 
```

输出

```
.....|*****|*****|*****|*****|*****|*****|*****|
.....|.....|*****|*****|*****|*****|*****|*****|
.....|.....|.....|*****|*****|*****|*****|*****|
.....|.....|.....|.....|*****|*****|*****|*****|
.....|.....|.....|.....|.....|*****|*****|*****|
.....|.....|.....|.....|.....|.....|*****|*****|
.....|.....|.....|.....|.....|.....|.....|*****|
.....|.....|.....|.....|.....|.....|.....|.....| 
```

现在将 num_chars 更改为 15。

```
.....|*****|*****|*****|*****|*****|*****|*****|*****|*****|*****|*****|*****|*****|*****|
*****|*****|*****|*****|*****|*****|*****|*****|
*****|*****|*****|*****|*****|*****|*****|*****|
*****|*****|*****|*****|*****|*****|*****|*****|
*****|*****|*****|*****|*****|*****|*****|*****|
*****|*****|*****|*****|*****|*****|*****|*****|
*****|*****|*****|*****|*****|*****|*****|*****|
.....|*****|*****|*****|*****|*****|*****|*****| 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T15:26:44.380

你说你正在使用 ctypes 因为你想要可变的 char 缓冲区。但是你可以从列表理解中得到你想要的输出

```
num_chars = 5
num_rows = 8
empty = ['.' * num_chars]
full = ['*' * num_chars]
print '\n'.join(
    '|'.join(empty * (i + 1) + (num_rows - i - 1) * full)
    for i in xrange(num_rows)
)

.....|*****|*****|*****|*****|*****|*****|*****
.....|.....|*****|*****|*****|*****|*****|*****
.....|.....|.....|*****|*****|*****|*****|*****
.....|.....|.....|.....|*****|*****|*****|*****
.....|.....|.....|.....|.....|*****|*****|*****
.....|.....|.....|.....|.....|.....|*****|*****
.....|.....|.....|.....|.....|.....|.....|*****
.....|.....|.....|.....|.....|.....|.....|..... 
```

**编辑**

我将向您展示如何使用列表推导来绘制您想要绘制的任何字符位图。这个想法很简单。在要打印字符的位置构建一个布尔数组，True 否则为 False。只需使用“或”技巧来打印正确的字符。这个例子将建立一个像棋盘一样的棋盘。您可以使用相同的概念来绘制您想要的任何形状。

```
rows = 5
cols = 6
char = '#'
empty = '.'
bitmap = [[ (i + j)%2 == 0 for i in xrange(cols)] for j in xrange(rows)]
print '\n'.join(
    '|'.join(bitmap[j][i] * char or empty for i in xrange(cols))
    for j in xrange(rows)
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T16:20:43.050

我们去吧。我有第*num_rows 行而不是第*num_chars 行，我必须需要一个 Dr Pepper。顺便说一句，这不是家庭作业。这是一个LCD项目。

```
num_chars = 10
num_rows = 8
num_cols = 6

buffer = create_string_buffer (num_chars*num_rows*num_cols+num_chars)

for char in range(num_chars):
        for row in range(num_rows):
                for col in range(num_cols):
                        if char == num_chars-1 and col == num_cols-1:
                                buffer[row*num_chars*num_cols+char*num_cols+col+row] = '|'
                                buffer[row*num_chars*num_cols+char*num_cols+col+row+1] = '\n'
                        elif col == num_cols-1:
                                buffer[row*num_chars*num_cols+char*num_cols+col+row] = '|'
                        else:
                                buffer[row*num_chars*num_cols+char*num_cols+col+row] = ('.', '*')[char>row]

print repr(buffer.raw)
print buffer.value 
```

# java - 如何在 Java 中使用开放式字体？

> ID：872569
> 
> 赞同：10
> 
> 时间：2009-05-16T14:50:10.037
> 
> 标签：java, fonts, opentype

有没有办法像阅读 TrueType 字体一样在 Java 中阅读 Open Type 字体？

这对 TTF 非常有效，但我还没有弄清楚如何对 Open Type 字体做同样的事情。

```
Font f = Font.createFont( Font.TRUETYPE_FONT,
new FileInputStream("f.ttf") ); 
```

请注意，我无法转发已安装的字体。我在我的程序中提供了字体，但不想在系统范围内安装它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-13T15:39:49.770

[Java OpenType 字体支持取决于您的操作系统和 JDK 版本。](http://mindprod.com/jgloss/opentype.html#JAVASUPPORT)

在 Java 6 之前，您只能使用 TrueType 风格的 OpenType 字体。使用 Java 6，您可以使用所有 OpenType 字体，但您不会受益于连字等高级排版功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T15:04:10.630

我认为 java 中没有 Open Type Font 支持（至少不是免费的），iText 声称有这种支持，几个月前尝试过但没有用，对我有用的是一个名为 FontForge 的程序，我用于从我随后使用的 otf 创建一个 ttf。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-08-07T08:59:14.430

`.otf`Java 1.6 不支持Open Type ( ) 字体文件。从 Java 1.7 开始，添加了支持：

```
Font font = Font.createFont(Font.TRUETYPE_FONT, new File("MyFont.otf"));
font  = font.deriveFont(Font.BOLD, 40);

label.setFont(font); 
```

更多细节：

*   [http://bugs.java.com/view_bug.do?bug_id=6992611](http://bugs.java.com/view_bug.do?bug_id=6992611)
*   [http://docs.oracle.com/javase/7/docs/webnotes/adoptionGuide/#swing](http://docs.oracle.com/javase/7/docs/webnotes/adoptionGuide/#swing)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T08:01:10.283

我使用字体转换器将**OTF**转换为**TTF**文件。有一些在线服务（例如[www.freefontconverter.com](http://www.freefontconverter.com)）可以完成这项工作。对我来说，这是一个快速而简单的解决方法。

# php - 在 PHP 中保护文件上传的好方法

> ID：872570
> 
> 赞同：2
> 
> 时间：2009-05-16T14:50:34.203
> 
> 标签：php, security, file, upload, file-upload

编写一个小应用程序，（*除其他外*）允许用户上传文件（*如图像、.doc 或文本文件*）作为他们发布/提交的一部分。

我们当前的原型只是将文件转储到**/{app_root}/files/**中，但是当然，任何人都可以访问它，即使他们没有登录或使用系统。目标是仅在用户登录并且确实有权访问文件所属的帖子时才授予对文件的访问权限（*查看访问权限）。*

所以，简而言之，我正在寻找一种好方法来做到这一点。

我正在考虑在**/web/** ( *http* ) 文件夹之外创建一个文件夹，然后让 PHP 使用**header()** commans 以某种方式呈现它，或者，也许只是将文件转储到数据库中？然而，我从来没有做过任何一个。

虽然我怀疑我最终能弄明白，但这里有太多聪明人，我想有人会知道某种现有的类或函数库已经这样做了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T14:57:01.223

您必须执行以下操作：

1.  将所有文件移出 webroot。您*可以*使用 .htaccess 禁用对文件夹的访问，但这不值得麻烦和潜在的安全风险。把它移出去就行了。
2.  保留上传文件的表格，将用户的原始文件名存储在那里。将文件重命名为`$id.$ext`等等。简而言之，您不想在系统中使用用户的文件名。
3.  有一个脚本，`download.php`或者其他什么，获取文件的 ID，验证谁登录，如果一切都检查，获取文件，将其读出到浏览器，并发送适当的下载标题。

这些标头将类似于：

```
header('Content-type: application/octet-stream');
header('Content-disposition: attachment; filename=usersuppliedname.txt');
header("Content-Length: " . filesize('../safefiles/1.txt'));
header("Content-Transfer-Encoding:  binary");
readfile('../safefiles/1.txt');
exit; 
```

如果你想允许恢复文件等，你可以[变得更花哨，但上面应该这样做。](https://stackoverflow.com/questions/386845/http-headers-for-file-downloads)

# erlang - 检测数据/节点分区错误

> ID：872571
> 
> 赞同：2
> 
> 时间：2009-05-16T14:50:34.560
> 
> 标签：erlang, mnesia, yaws

上次我看到数据/分区节点错误是因为我启动了 erlang shell，它通过 cookie 等连接到同一 CPU 上的节点。启动后，shell 立即在屏幕上转储了分区错误。这真是太麻烦了......

1.  如何捕获此异常？
2.  如何以编程方式修复异常？（在另一个问题中问）
3.  如何防止此异常？

[**更新**] 我有两个盒子正在运行我的 Yaws 应用程序。数据库通过 Mnesia 的 extra_db_node 功能进行复制。在服务器运行后的某个时间，我登录其中一个框并使用不同的 sname 和相同的 cookie 启动“erl”，以便 3 个节点可以通信。在shell稳定并显示shell提示符后不久……屏幕上显示一个复杂的元组，表明存在网络分区错误。此消息似乎是控制台转储，而不是可能被我的 yaws 应用程序捕获的异常......但我希望我的 yaws 应用程序能够检测到错误并采取纠正措施。

# jquery - AJAX 请求中的 Dom 问题

> ID：872577
> 
> 赞同：0
> 
> 时间：2009-05-16T14:54:23.117
> 
> 标签：jquery

我已经被这个问题困扰了将近 2 天，请考虑以下代码：

'.country-select' 在表单（输入）中出现两次，

```
$('.branch-row').hide();
$('.country-select').change(function(){
    console.log($(this));
    country_select = $(this);
    $.get('get_country_branches.php',
        'country=' + $("'#" + country_select.attr('id') + " option:selected'").val() + '&field=' + $(':input:eq('+($(":input").index(country_select) + 1) +')').attr('name'),
        function(html){
            $(':input:eq('+($(":input").index(country_select) + 1) +')').html(html);
            //debug 1
            console.log(country_select);
            country_select.parent().parent().next().show();
        },
        'html'
    );

}).change();
//debug 2
console.log(country_select); 
```

调试 1 的输出都是同一个对象：

[select#pays-dem.country-select] [select#pays-dem.country-select]

但是调试 2 的输出是正确的：

[select#pays-enlev.country-select] [select#pays-dem.country-select]

似乎问题出在 $.get() AJAX 函数和 country_select 对象中。任何想法 wtf 正在发生吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T15:13:06.287

通过不将 var 放在 country_select 变量的前面，它被绑定在全局空间而不是函数的本地。另外，我认为您不需要重新查询即可获取选择的选定值。使用`val()`应该足够了。我会尝试简化选择我认为是选择之后的下一个输入的选择。尝试这样的事情：

```
$('.country-select').change(function(){
    console.log($(this));
    var country_select = $(this);
    $.get('get_country_branches.php',
        'country=' + country_select.val() + '&field=' + country_select.next('input:first').attr('name'),
        function(html){
            country_select.next('input:first').html(html);
            //debug 1
            console.log(country_select);
            country_select.parent().parent().next().show();
        },
        'html'
    );

}).change(); 
```

顺便说一句，这将破坏函数之后的 console.log，因为变量不再在全局范围内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T14:58:56.587

您需要在 country_select 之前放置一个 var 以使其成为局部变量。目前它正在全球范围内定义。

一旦这样做，您将无法执行第二个 console.log，因为此时该变量将超出范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T15:15:16.077

只是想在我上面的答案中添加一些细节。

每当您在 JavaScript 中使用变量而不在函数范围内声明它（使用 var 关键字）时，它就会被添加到全局窗口范围内。

所以以下将成立

```
function myFunction(){
i=99;
if(i==99 && window.i == i){
alert("It went into global scope");
}
} 

myFunction();
if(i==99 && window.i == i){
alert("Same here");
} 
```

# php - 美化从 m（米）到英尺（'）和英寸（''）的转换

> ID：872580
> 
> 赞同：1
> 
> 时间：2009-05-16T14:56:45.310
> 
> 标签：php, unit-conversion

我正在创建用于定义个人[BMI](http://en.wikipedia.org/wiki/Body_mass_index)的表。该图表（到目前为止）不接受输入（因为我首先想让它独立工作），但它确实（在平行轴上）显示了米和英尺/英寸的高度。

为了做到这一点，我定义了米的起点和范围，然后将定义的米变量转换为英尺/英寸，为此我想出了（请不要*笑*......）以下内容：

```
<?php
        $m; // height in m

        $hInInches = ($m*3.2808399)*12;

        $hInImp = explode(".",$hInInches);

        $hInFt = $hInImp[0];

        $hInInches = substr(12*$hInImp[1],0,2);
?> 
```

我想知道是否有人有任何更漂亮、更经济、更准确的方法可以做到这一点，因为这是在 for () 循环内运行以生成`x`行数（在 elswhere 定义），我想（如果可能）以减少负载...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T15:36:10.443

这是一种方法，采用伪代码：

```
inches_per_meter = 39.3700787
inches_total = round(meters * inches_per_meter)  /* round to integer */
feet = inches_total / 12  /* assumes division truncates result; if not use floor() */
inches = inches_total % 12 /* modulus */ 
```

你也可以拉出`12`一个常数......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T16:21:52.173

对我来说，您应该避免使用 derobert 已经说过的字符串操作函数。在 php 中，代码应类似于以下代码：

```
<?php
   $m=2; // height in m
    $hInFeet= $m*3.2808399;
$hFeet=(int)$hInFeet; // truncate the float to an integer
    $hInches=round(($hInFeet-$hFeet)*12); 
?> 
```

只需两个乘法和一个减法（加上一个函数调用）就非常经济，而且代码也非常可读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T15:20:53.677

我不确定你是否认为[这个](http://cvs.moodle.org/moodle/lib/htmlpurifier/HTMLPurifier/UnitConverter.php?view=co)更漂亮；但是，我认为[ajax/javascript](http://www.google.com/search?hl=en&safe=off&ei=DNkOSsPEEobKtgfnyYT1Bw&sa=X&oi=spell&resnum=0&ct=result&cd=1&q=unit+conversion+javascript&spell=1)解决方案可能是个好主意。当用户输入值时，结果会更新。

```
with regards to your code
* define M_TO_FEET, FEET_TO_INCH constants.
* define 2 equations feet_to_metres(value_to_convert) and metres_to_feet(value_to_convert)
* write the conversion code in each and let it return the result

and then you can create a simple if statement:
* If user inputs metres, then metres_to_feet(value_entered_by_user) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-05T08:06:10.633

```
 <?php echo metersToFeetInches(3); //call function    ?>

     <?php
        function metersToFeetInches($meters, $echo = true)
        {
            $m = $meters;
            $valInFeet = $m*3.2808399;
            $valFeet = (int)$valInFeet;
            $valInches = round(($valInFeet-$valFeet)*12);
            $data = $valFeet."&prime;".$valInches."&Prime;";
            if($echo == true)
            {
                return $data;
            } else {
                return $data;
            }
        }
        ?> 
```

输出：9′10″</p>

# php - 使用 simplexml_load_file 我想区分超时和 404 错误

> ID：872588
> 
> 赞同：0
> 
> 时间：2009-05-16T15:01:17.780
> 
> 标签：php, http, simplexml

我目前正在使用：

```
$page = simplexml_load_file('http://www.example.com/page.html'); 
```

在我的代码中，如果页面超时，我想重试，但如果找不到页面（404），我想将它添加到未找到页面的列表中。

如果我能区分这两种类型的错误，我可以做剩下的事情。

出于好奇，您可以使用以下代码获取状态代码：

```
if ($page == FALSE) 
{
  list($version,$status_code,$msg) = explode(' ',$http_response_header[0], 3);
  echo 'Status Code: '.$status_code."\n";

   ... 
```

但是因为我想做卷曲做得更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T15:11:27.193

我认为您必须为此使用 curl 。Curl 可以告诉您请求是否超时或返回 404。如果这些都没有发生，您可以将请求的结果提供给 simplexml_load_string。

[http://nl2.php.net/curl](http://nl2.php.net/curl)

# c# - 如何在 winmobile 应用程序的默认浏览器中启动 URL？

> ID：872589
> 
> 赞同：0
> 
> 时间：2009-05-16T15:01:40.743
> 
> 标签：c#, windows-mobile

在普通的 C# 桌面应用程序中，您可以通过以下方式启动 URL：

```
System.Diagnostics.Process.Start("http://www.stackoverflow.com") 
```

但是 Windows Mobile 上的 System.Diagnostics.Process 似乎没有字符串过载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T15:22:34.237

这在 WindowsMo​​bile 中对我有用：

```
try
{
    System.Diagnostics.Process myProcess = new System.Diagnostics.Process();
    myProcess.StartInfo.UseShellExecute = true;
    myProcess.StartInfo.FileName = url;
    myProcess.Start();
}
catch (Exception e) {} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T15:09:25.780

看起来这个博客有你的解决方案

[http://www.businessanyplace.net/?p=code#startapp](http://www.businessanyplace.net/?p=code#startapp)

它使用[CreateProcess](http://msdn.microsoft.com/en-us/library/ms682425.aspx)调用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T15:15:48.137

根据[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)、[http://msdn.microsoft.com/en-us/library/d8fz649y.aspx](http://msdn.microsoft.com/en-us/library/d8fz649y.aspx)和[http ://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.filename.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.filename.aspx)你应该能够做到：

```
ProcessStartInfo psi = new ProcessStartInfo();
psi.FileName = "http://www.stackoverflow.com";
Process.Start(psi); 
```

但是，我还没有在 CF 上测试过这个。

# php - 编译一个 C 程序并运行它而不是 PHP 页面是否值得？

> ID：872599
> 
> 赞同：3
> 
> 时间：2009-05-16T15:08:42.177
> 
> 标签：php, c

似乎大多数时候，获得的速度并不值得——是这样吗？否则很多人会为他们最受欢迎的页面这样做。使用 C 程序是否有真正的好处。我可以想到一个不重要的情况：当服务器上的网络瓶颈比 CPU 瓶颈大得多时，程序运行的速度就变得不那么重要了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T15:17:02.563

C是一门优秀的语言。但它是为系统级编程而设计的，而不是制作网页。另一方面，PHP 是为制作网页而设计的。为正确的工作使用正确的工具。在这种情况下，PHP。

你也是从一个错误的前提开始的。也就是说，PHP 的速度不足以交付页面内容。有许多网站根本不同意这种说法。也许有一些极端情况表明 C 是这项工作的唯一选择，但我发现你不太可能遇到这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T15:36:10.910

当您将 C 用作锤子时，一切看起来都像拇指。

正如 Jared 上面所说，使用正确的工具。你可以用 C 语言来做这一切，很多人都有。但是 PHP 与 C 的 web 开发速度也是你可能会关注的。在 PHP 中很简单的事情（例如动态数组）在 C 中并不简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T15:14:04.100

大多数网站使用内存中的缓存来实现高速响应。在这种情况下，负载不再是在页面的创建中，所以我不会去 c 程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T15:16:16.777

我会说，即使在您说明的情况下，重新设计您的服务器端工作以作为 C 程序运行也是不值得的。不管流量多少。

升级服务器或实现有效缓存的成本总是低于重写服务器端代码以在 C 中运行所需的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T15:24:19.160

这真的取决于代码。例如，我宁愿编译处理我的网络图算法的 C 代码；但是，我永远不会转换显示最少 CSS 的简单静态页面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T15:38:31.013

如果你甚至需要问这个问题，答案是否定的。

基于 Web 的应用程序依次受到网络、数据库、I/O 和 CPU 的限制，并且通过用 C 编写代码所获得的速度提升肯定会被抵消，但由于语言的性质，开发时间会增加，并且仍然受到这些其他因素的影响更大。

如果你的代码需要运行得非常快，做一些计算上相当困难或涉及的事情，也许 C 可能是正确的答案，但大多数网站不是这样的。

一旦确定当前的实现太慢，将非常具体的处理或繁重的代码重写为 C 模块可能是值得的，但这些优化最好在正确了解应用程序真正瓶颈的情况下完成。

如果您有一个像样的库或平台，例如 .NET MVC，则使用 C# 进行一般 Web 开发是一个可行的想法。C，没有那么多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-16T16:15:32.797

有一种情况（在我能想到的所有其他情况下，答案是不值得 - 好的推理在其他答案中）。

所以情况是

*   程序需要做大量的数据处理或计算
*   有大量优化的 C 代码可用

我想说一个复杂的光线追踪系统是这种情况的候选者，但在这种复杂性下什么都没有。

*即使在这种情况下，我也会在 PHP 中实现页面并运行后台作业来完成繁重的工作。*

# ruby - 在 Ruby 中，Java 限制在同事情况下访问源代码的技术是什么？

> ID：872609
> 
> 赞同：0
> 
> 时间：2009-05-16T15:15:36.157
> 
> 标签：ruby

在 Java 中，当您编译定义类的 .java 文件时，它会创建一个 .class 文件。如果您将这些类文件提供给您的同事，那么他们就无法修改您的源代码。您还可以将所有这些类文件捆绑到一个 jar 文件中，以便更整齐地打包并将其作为单个库分发。

当您想与您的同事共享您的功能但您不希望他们能够修改源代码时，Ruby 是否有任何类似的功能（除非他们要求您提供实际的 .rb 源文件并告诉您他们想要更改）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T15:22:06.640

我相信您正在寻找的功能称为“信任”（和源代码控制存储库）。Ruby 的编译方式与 Java 不同，所以不，你不能这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T15:39:42.213

我不得不说你的处境很艰难，不想与同事共享代码。但是，鉴于这是一个无懈可击的约束，也许您可​​以改变问题的性质。

如果您的同事需要访问您的库提供的某些服务，也许您可​​以通过提供 web/rest 服务而不是 .rb 文件来公开它。

通过这种方式，您可以将代码隐藏在 Web 服务器后面，并且如果存在允许进行这些服务调用的低延迟的网络架构，您可以有效地实现相同的目标。

不过信任要容易得多。

编辑：刚刚在 HN 上看到了这个：http: [//blog.astrails.com/2009/5/12/ruby-http-require](http://blog.astrails.com/2009/5/12/ruby-http-require)，允许 ruby​​ 文件通过 http 而不是文件系统包含另一个文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T15:20:54.567

红宝石是

> 一种动态的、解释的、开源的编程语言，专注于简单性和生产力。

因此，像所有解释语言一样，您需要将源代码提供给任何想要执行您的程序/脚本的人。

顺便说一句，在 google 上搜索“compiled ruby​​”返回了一些安静的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T15:21:17.187

我不认为有一个。Ruby 纯粹是一种解释型语言，这意味着 Ruby 会直接解释您的源代码以便运行它。Java 已编译，因此有一个中间字节码（`.class`）。如果你真的愿意，你可以混淆你的红宝石，但这可能比它的价值更麻烦。

但是，为了确保您意识到，可以使用各种免费实用程序将 95% 以上的 Java 反编译回源代码，因此实际上，Java 的编译并不比分发 Ruby 源代码好多少。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T15:21:51.990

这不是特定于语言的问题，并且可以通过源代码控制软件更有效地进行管理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T00:43:07.570

有一个名为[ruby​​2c](http://github.com/seattlerb/ruby_to_c/tree/master)的库，它将Ruby 的一个子集编译为 C 代码（如果需要，您可以将其编译为本机代码）。

它实际上最初是作为 Ruby 代码混淆器编写的（但后来被用于许多其他东西，包括[Ruby Arduino 开发](http://rad.rubyforge.org/)）。

# c# - 在 Workflow Foundation 中处理多个状态的相同事件

> ID：872621
> 
> 赞同：1
> 
> 时间：2009-05-16T15:22:05.860
> 
> 标签：c#, .net, visual-studio-2008, workflow-foundation

我正在使用 StateMachine 工作流。在某些情况下，可以在工作流中的多个状态下触发相同的事件。

我想知道我是否可以在多个州处理相同的事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T16:11:35.850

您可以在状态机工作流的多个状态中侦听同一事件，但在您触发事件时只会触发活动状态。

# php - 在其他模型中访问 CodeIgniter 模型

> ID：872623
> 
> 赞同：39
> 
> 时间：2009-05-16T15:22:13.283
> 
> 标签：php, codeigniter

过去，在 CodeIgniter 模型中，您无法访问另一个模型。

```
$this->load->model('bar');
$this->bar->something(); 
```

这仍然有效，还是他们改变了它？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2010-03-16T18:56:29.283

对于一个简单的问题，这些是一些非常长的答案。

**简短的回答：**现在完全支持。如果您愿意，请交叉加载！

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-09-21T03:28:47.663

我强烈不同意“模型”应该只用简单的 CRUD 操作封装数据库表的概念。如维基百科文章中所述：

[http://en.wikipedia.org/wiki/Model-view-controller#As_a_design_pattern](http://en.wikipedia.org/wiki/Model-view-controller#As_a_design_pattern)

...该应用程序层的目的不仅仅是充当单个数据库表抽象。想想“控制器”这个词的含义——它应该更像是一个导演，而不是整个应用程序本身。“模型”*是*业务逻辑的地方。事实上，大多数大型应用程序的大部分业务逻辑都保存在数据库本身中（以触发器、存储过程、外键等形式）。

我认为对“模型”的误解部分是由于对“MVC”的相同（过度）炒作造成的，而没有对概念本身有太多理解。有点像“AJAX”是多么空洞，或者更简单，“Web 2.0”。不管是好是坏，很多脚本小子都跳上了 MVC 的马车，而且由于简单的操作方法和示例场景除了告诉您将数据库代码放入“模型”之外并没有做更多的事情，因此滥用该层作为只有一个数据库抽象已经变得司空见惯。现在你在互联网上阅读帖子称其为“不纯”、“肮脏”、“hackish”，以便将任何业务逻辑放入模型中。那是错误的。误传。

一个简单的例子是考虑外键：即使你只希望你的“模型”是一个*数据库*模型，如果你想成为“纯”、“正确”或者你有什么，你真的应该在其中强制执行引用完整性. 由于 MySQL 多年来缺乏真正的外键支持，Web 应用程序在没有任何人担心引用完整性的情况下成长起来。我猜这符合剧本小子的生活方式。无论如何，即使是模型的这种简化视图也能够保持外键有效性，模型必须与其他模型一起工作（或者，特别是如果像 CodeIgniter 这样的框架不允许您这样做，您必须向其他模型编写查询表，有时会在其他地方重复查询 - 这是不好的风格）。

因此，我认为这是 CodeIgniter 的一个缺点。我知道这可能不是一个容易解决的问题，但这肯定是一个令人失望的疏忽。

所以我所做的是将上面的示例代码抽象为一个帮助程序，这样我现在就有了一个与正常的 $this->load->model() 功能几乎相同的函数。在这里（将其放入自动加载的助手中，您可以在任何模型中使用它）：

```
 /**
    *
    * Allow models to use other models
    *
    * This is a substitute for the inability to load models
    * inside of other models in CodeIgniter.  Call it like
    * this:
    *
    * $salaries = model_load_model('salary');
    * ...
    * $salary = $salaries->get_salary($employee_id);
    *
    * @param string $model_name The name of the model that is to be loaded
    *
    * @return object The requested model object
    *
    */
   function model_load_model($model_name)
   {
      $CI =& get_instance();
      $CI->load->model($model_name);
      return $CI->$model_name;
   } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-16T23:17:40.613

这是可能的，但并不理想，并且被认为是“快速修复”而不是理想或纯粹的实现。

```
class Location extends Model{
      public function get($ID){
                // Get main CI object handle and load model
                $CI =& get_instance();
                $CI->load->model('LocationType');
                // Call new model functions using handle to main CI object
                $CI->LocationType->setID($result->LocationTypeID);
                $CI->LocationType->setTitle($result->TypeTitle);
                $this->_locationType = $CI->LocationType;
                //Other Stuff
    }
} 
```

任何时候你像这样使用主要的 CI 对象都可能是个坏主意。尝试重新考虑您的布局，并将数据传递到控制器或从控制器传递到模型。

[http://codeigniter.com/forums/viewthread/69833/](http://codeigniter.com/forums/viewthread/69833/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-11-11T14:41:21.223

您可以像 Phil Sturgeon 所说的那样从模型中加载模型，但是如果您在模型构造函数中加载模型，则必须小心依赖关系：如果模型 A 使用模型 B 而模型 B 使用模型 A，当您尝试加载一个或否则，您将进入无限循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-16T14:30:22.780

在 Code Igniter 中的这种情况下，我更喜欢以下两种可能性之一：

1）具有模型的属性和设置器，如下所示：

```
class X extends Model {
  var $Y_model;
  public function setY($Y) {
    $this->Y_model = $Y;
  }

  public function doItRightNow($a,$b) {
    $list = $this->Y_model->getSomeList($a,$b);
    // ...
  }
  // ...
} 
```

然后在其他方法之前使用这个setter来给出其他模型的实例，以便方法可以使用它。

```
$this->load->model('X');
$this->load->model('Y');
$this->X->setY($this->Y);
$this->X->doItRightNow($something,$somethingElse); 
```

2）在方法中有一个参数，我将从控制器中提供另一个模型实例。

```
class X extends Model {
  public function doItRightNow($a,$b,$Y_model) {
    $list = $Y_model->getSomeList($a,$b);
    // ...
  }
  // ...
} 
```

并像这样使用它：

```
 $this->load->model('X');
  $this->load->model('Y');
  $this->X->doItRightNow($something,$somethingElse,$this->Y); 
```

我认为这些是更干净的可能性。
使用哪种方式取决于需要访问其他模型的方法数量。如果有一个或两个，最好将其作为方法参数提供。如果更多 - 我认为最好有一个类属性和设置器。
并且以优雅的方式，您可以根据某些条件给出一个模型或另一个模型 - 如果它们都部分实现相同的接口并返回相同类型的数据（它很少有用，但有时可能）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T17:26:22.707

我认为访问模型然后在需要时将库包含在模型中的编写库通常会更好。

例如，如果您需要检查某人是否被授权通过某个 CRUD 操作，您可能希望包含您正在使用的任何身份验证库（在大多数情况下它可能是自动包含的）。你不一定想直接访问模型——它看起来很脏而且不合适。

我认为首选方法是在控制器中执行您需要执行的操作，并将结果从一个模型的方法（如果需要）传递给您的另一个模型的方法。

无论如何，我不明白为什么不能将一个模型本身包含到另一个模型中。不过，我认为您无法使用所显示的语法来做到这一点。您将不得不以其他复杂的方式进行操作。无论如何，IMO，将模型直接包含到另一个模型中是不好的做法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-14T10:05:23.257

在 CI 2.0 中，您可以直接从另一个模型调用一个模型。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-07-29T10:49:13.770

最好创建一个辅助函数，而不是从另一个模型中调用该函数，以便一次可以在 2 个模型中使用它并且可以重用代码。

# jquery - 后台不会使用 jquery 转到前台

> ID：872625
> 
> 赞同：0
> 
> 时间：2009-05-16T15:22:48.633
> 
> 标签：jquery, background

我的问题是：是否可以将背景图像置于前景？

我从一个示例中创建了一个掩码，其中 div 的 z-index 为 9000，包含表单 z-index 的 div 为 9999

到目前为止，这是可行的，但是如果我使用带有背景图像的类，它将不会显示。

我在没有掩码的情况下测试了测试页面上的所有内容，并且可以正常工作。然后我将这些东西移动到带有蒙版的页面，然后背景图像不再显示。

普通图像似乎没有这个问题。

这是[我的测试页](http://www.woonbel.nl/testpagina.php)

```
// het tbnote opties menu
    $("#tbnoteopties").click(function() {
            $(this).toggleClass("uit").toggleClass("aan");
            $(this).next().toggleClass("expanded").toggleClass("collapsed").slideToggle("normal");
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T04:18:47.587

`z-index`确定元素的堆栈级别。每个元素都会根据其在文档中的上下文自动分配一个 z-index。

`z-index`仅适用于已明确分配`position`值为`absolute`、`fixed`或的元素`relative`。

您不能设置`z-index`背景图像的 。`z-index`设置 html 元素的堆叠顺序。

如果您尝试定位使用`background`or `background-image`css 属性设置的背景图像，您最终将定位元素而不是元素中的背景图像。

# haskell - 表达式中的语法 - Haskell

> ID：872631
> 
> 赞同：0
> 
> 时间：2009-05-16T15:25:29.330
> 
> 标签：haskell, if-statement

我是 Haskell 的新手！！我写了这段代码：

```
import Data.List
inputIndex :: [String] -> [String] -> Bool
inputIndex listx input = and [x `elem` listx |x <- input]
inputIndex = if inputIndex == true
                then putStrLn ("ok") 
```

没有`if`语句它可以正常工作，但是当我输入`if`语句时，会显示以下错误：

> 表达式中的语法错误（意外的“}”，可能是由于布局错误）

我在这里做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T15:45:46.003

这里有几件事是错误的：

*   您将*需要*一个 else 子句。
*   `True`必须大写。
*   `inputIndex`必须始终采用两个参数（现在它没有，在最后一种情况下）。

我猜你想要这样的东西......

```
inputIndex :: [String] -> [String] -> IO ()
inputIndex listx input = if inputIndex' listx input
                             then putStrLn ("ok")
                             else putStrLn ("not ok")
  where
    inputIndex' :: [String] -> [String] -> Bool
    inputIndex' listx input = and [x `elem` listx |x <- input] 
```

（在这里，我通过附加一个撇号/撇号定义了一个名称几乎相同的新函数。通过在`where`子句中定义它，它只对外部`inputIndex`函数可见。如果你愿意，你可以将其称为辅助函数。我也可以选择一个完全不同的名字，但我没有创意。）

您还可以将其浓缩为以下内容（这也更笼统）：

```
allPresent :: (Eq t) => [t] -> [t] -> IO ()
allPresent xs ys = putStrLn (if and [y `elem` xs | y <- ys] then "ok" else "not ok") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T15:50:29.503

1.  是“真”，不是“真”。
2.  您的第二个 inputIndex 实现与第一个不兼容。函数的所有模式案例必须具有相同的签名（[String] -> [String] -> Bool）
3.  您在此处显示的错误不是由此代码生成的，因为此处没有“}”。
4.  putStrLn has signature `String -> IO()` while your `inputIndex` looks like it's supposed to be pure - just return the value and print it somewhere else.

# perl - 如何在 Perl 的另一个文件中找到一个文件中的字符串？

> ID：872632
> 
> 赞同：0
> 
> 时间：2009-05-16T15:25:51.387
> 
> 标签：perl

下面的脚本采用文本文件中的函数名称并扫描包含多个 c,h 文件的文件夹。它一个接一个地打开这些文件并读取每一行。如果在文件的任何部分找到匹配项，它会打印行号和包含匹配项的行。

一切正常，只是比较工作不正常。我将非常感谢解决我问题的人。

```
 #program starts:

  use FileHandle;
  print "ENTER THE PATH OF THE FILE THAT CONTAINS THE FUNCTIONS THAT YOU WANT TO     
  SEARCH: ";#getting the input file
  our $input_path = <STDIN>;
  $input_path =~ s/\s+$//;
  open(FILE_R1,'<',"$input_path") ||  die "File open failed!"; 
  print "ENTER THE PATH OF THE FUNCTION MODEL: ";#getting the folder path that 
                                                 #contains multiple .c,.h files
  our $model_path = <STDIN>;
  $model_path =~ s/\s+$//;
  our $last_dir = uc(substr ( $model_path,rindex( $model_path, "\\" ) +1 ));
  our $output = $last_dir."_FUNC_file_names";

  while(our $func_name_input = <FILE_R1> )#$func_name_input is the function name 
                                          #that is taken as the input
  {
     $func_name_input=reverse($func_name_input);
     $func_name_input=substr($func_name_input,rindex($func_name_input,"\("+1);
     $func_name_input=reverse($func_name_input);
     $func_name_input=substr($func_name_input,index($func_name_input," ")+1);

     #above 4 lines are func_name_input is choped and only part of the function 
     #name is taken. 

     opendir FUNC_MODEL,$model_path;
     while (our $file = readdir(FUNC_MODEL))
     {
        next if($file !~ m/\.(c|h)/i);
        find_func($file);       
     }
     close(FUNC_MODEL);
  }

  sub find_func()
  {
     my $fh1 = FileHandle->new("$model_path//$file") or die "ERROR: $!";

     while (!$fh1->eof())
     {
         my $func_name = $fh1->getline(); #getting the line

         **if($func_name =~$func_name_input)**#problem here it does not take the  
                                              #match
         {
             next if($func_name=~m/^\s+/);
             print "$.,$func_name\n";
         }
      }
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T15:53:40.900

```
$func_name_input=substr($func_name_input,rindex($func_name_input,"\("+1); 
```

你缺少一个结束括号。应该：

```
$func_name_input=substr($func_name_input,rindex($func_name_input,"\(")+1); 
```

也可能有比这四个语句更简单的方法。但是现在把我的头全部包起来还为时过早。你想在“function foo() {”中匹配“foo”吗？如果是这样，您可以使用像 /\s+([^) ]+)/ 这样的正则表达式。

* * *

当您说 时`$func_name =~$func_name_input`，您将 $func_name_input 中的所有字符都视为特殊的正则表达式字符。如果这不是您的意思，您可以使用 quotemeta (perldoc -f quotemeta):`$func_name =~quotemeta($func_name_input)`或`$func_name =~ qr/\Q$func_name_input\E/`.

* * *

[使用限制](http://www.perlmonks.org/?node_id=686571)（和语法高亮编辑器）将更容易调试。另请注意，如果您没有在其他文件中使用这些变量，“我们的”不会做任何“我的”不会对文件范围的变量做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T01:43:54.867

find + xargs + grep 完成了你想要的 90%。

```
find . -name '*.[c|h]' | xargs grep -n your_pattern 
```

[ack](http://search.cpan.org/dist/ack)更容易。

```
ack --type=cc your_pattern 
```

只需从文件中获取模式列表并将它们“或”在一起。

```
ack --type=cc 'foo|bar|baz' 
```

这样做的好处是只搜索文件一次，而不是像您正在搜索的每个模式一样搜索一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T02:20:45.930

我仍然认为你应该只使用 ack，但你的代码需要一些认真的爱。

这是您的程序的改进版本。它现在需要在命令行上搜索目录和模式，而不必请求（和用户写入）文件。它使用 File::Find 搜索目录下的所有文件，而不仅仅是目录中的文件。它通过将所有模式连接成正则表达式来一次性完成此操作。它使用正则表达式而不是 index() 和 substr() 和 reverse() 哦上帝。它只是使用内置文件句柄而不是 FileHandle 模块并检查 eof()。一切都被声明为词法（我的）而不是全局（我们的）。严格和警告是为了更容易调试。

```
#!/usr/bin/perl

use strict;
use warnings;
use File::Find;

die "Usage: search_directory function ...\n" unless @ARGV >= 2;

my $Search_Dir = shift;
my $Pattern = build_pattern(@ARGV);

find(
    {
        wanted => sub {
            return unless $File::Find::name =~ m/\.(c|h)$/i;
            find_func($File::Find::name, $pattern);
        },
        no_chdir => 1,
    },
    $Search_Dir
);

# Join all the function names into one pattern
sub build_pattern {
    my @patterns;
    for my $name (@_) {
        # Turn foo() into foo.  This replaces all that reverse() and rindex()
        # and substr() stuff.
        $name =~ s{\(.*}{};

        # Use \Q to protect against regex metacharacters in the input
        push @patterns, qr{\Q$name\E};
    }

    # Join them up into one pattern.
    return join "|", @patterns;
}

sub find_func {
    my( $file, $pattern ) = @_;

    open(my $fh, "<", $file) or die "Can't open $file: $!";

    while (my $line = <$fh>) {
        # XXX not all functions are unindented, but your choice
        next if $line =~ m/^\s+/;

        print "$file:$.: $line" if $line =~ $pattern;
    }
} 
```

# database - ADO.NET：需要帮助来了解“数据集”的基础知识

> ID：872638
> 
> 赞同：3
> 
> 时间：2009-05-16T15:31:11.967
> 
> 标签：database, ado.net

作为上下文，我是 ADO.NET 的新手，并且一直在使用 David Sceppa 的“Programming ADO.NET 2.0”来帮助建立我的知识。

我一直在尝试理解*Dataset*对象，但认为我可能完全误解了这一点并正在寻求指导。

例如，我构建了一个非常简单的带有组合框的表单，目的是用数据库（“MyDatabase”）中的人名填充组合框。以下代码对我来说很好：

```
 Private Sub frmEmployee_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Dim strConn, strSQL As String
    strConn = "Data Source=.\SQLExpress;Initial Catalog=MyDatabase;Integrated Security=True;"
    strSQL = "SELECT LastName, FirstName FROM EmployeeTable"

    Dim da As New SqlDataAdapter(strSQL, strConn)
    Dim ds As New DataSet()
    da.Fill(ds, "AllEmployeesList")

    For i As Integer = 0 To ds.Tables("AllEmployeesList").Rows.Count - 1
        Dim row As DataRow = ds.Tables("AllEmployeesList").Rows(i)
        cbAllEmployeesList.Items.Add(row("LastName") & ", " & row("FirstName"))
    Next

End Sub 
```

现在假设我的表单上有一个按钮（'GetAge'），该按钮旨在从数据集“AllEmployeesList”中检索在组合框中选择的员工的年龄，并显示在同一表单上的文本框中。

我真的不明白的是如何与我为获取年龄而创建的原始数据集进行交互？在我看来，数据集仅在 Load 事件期间位于内存中？如果我的数据集在 Load 事件之后仍然存在，那么我在哪里可以找到它？

我的理解是，*数据集*对象是数据的离线缓存，没有与底层数据库的链接。这很有用，因为它允许您在不保持连接打开的情况下操作数据，稍后您可以提交数据集中的任何*更改*到原始数据库。因此，一旦我在 Load 事件中构建了我的数据集，我该如何进一步与之交互？

*我怀疑我对什么是Dataset*对象的理解存在很大错误。任何人都可以让我直截了当吗？

感谢任何可以提供帮助的人

亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T16:05:59.107

一个数据集可以包含多个数据表，因此如果您填充已经填充了“AllEmployeesList”数据表的同一数据集，您可以在另一个表名称下用年龄填充另一个数据表。将数据集想象成内存数据库。

您可以将数据集存储在 datagrid 视图的数据源中，或者将其设置为表单级别的变量，以便您可以随时与它进行交互而无需强制转换。

要注意的数据集的另一部分是您可以制作设计时数据集，这样事情就更加类型安全和明确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T16:10:30.843

您似乎对 DataSet 的概念和原因掌握得很好。您的问题实际上更多是关于管理状态，而不是数据集的来龙去脉。

您从未说明您使用的是 WebForms、WinForms 还是其他东西。如果您使用的是 WinForms，请将 DataSet 提升为表单的成员变量。只要表单打开，它就会留在内存中。

如果您使用的是 WebForms，那么这将变得更加复杂。[这](http://msdn.microsoft.com/en-us/library/75x4ha6s(VS.71).aspx)是一个很好的概述，可以帮助您入门。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-08T17:08:49.913

当一个 Function 或 Sub 完成执行时，您使用 Dim 语句声明的所有变量都将消失。如果您希望一个变量只要您的表单存在就存在，那么在您的子/函数之外声明一个变量：

```
Public Class frmEmployee
    Private dsEmployeeList As DataSet

    Private Sub frmEmployee_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    ...
    dsEmployeeList = New DataSet()
    da.Fill(dsEmployeeList, "AllEmployeesList")
    ...
    End Sub

    Private Sub GetAge_Click(sender As Object, e As EventArgs) Handles GetAge.Click
        Dim iRowIndex As Integer

        iRowIndex = cbAllEmployeesList.SelectedIndex 'In this case the rownumber is the same as the index of the selected item in the combobox

        'Check to see if an item from the combobox has been selected
        If iRowIndex >= 0 Then
            txtEmployeeAge.Text = dsEmployeeList.Tables("AllEmployeesList").Rows(iRowIndex).Item("Age").ToString()
        End If
    End Sub 
```

此代码可能有效，但不是推荐的解决方案。就像之前的发帖人说的：只在需要的时候获取你想要的数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T17:38:39.137

除非您的应用程序需要在断开连接模式下运行，否则在客户端缓存数据库数据并不是绝对必要的，也不是一个好主意。在这种情况下，您正在提取所有员工的年龄数据，而不知道您是否需要他们中的任何一个。

我只需提取名字和姓氏数据（可能使用 SqlCommand.ExecuteReader）来填充列表框，然后在用户单击按钮时单独调用数据库以获取年龄。[我在您的另一个问题](https://stackoverflow.com/questions/879381/ado-net-dataset-or-datatable-and-how-to-retrieve-data/883580#883580)上发布了一个使用 SqlCommand.ExecuteScalar 的类似示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T15:51:16.803

您应该将 DataGrid 绑定到 DataSet。需要时，您可以从 DataGrid.DataSource 检索 DataSet 并将其转换为 DataSet。

编辑：添加示例代码

```
 DataSet ds = new DataSet();
    // Code to populate DataSet from your DB
    ...
    ... 
```

将 ds 分配给数据网格的数据源

```
this.dataGridView1.DataSource = ds; 
```

要检索数据集，请使用以下代码

```
DataSet retrievedFromGrid = (DataSet)this.dataGridView1.DataSource; 
```

但是，如果您需要对该 DataSet 执行多次操作并且内存不是问题，我建议您将其存储在类变量中以避免一次又一次地从 DataGrid 中强制转换为 DataSet 对象的开销。

# php - PHP FTP目录列表错误

> ID：872651
> 
> 赞同：2
> 
> 时间：2009-05-16T15:39:10.030
> 
> 标签：php, ftp

```
array(1) {
  [0]=>
  string(8) "outgoing"
}
bool(false)
array(1) {
  [0]=>
  string(8) "outgoing"
}
bool(false) 
```

目前正在制作

```
$connect    = ftp_connect('example.com');
$result     = ftp_login($connect, 'username', 'password');

echo '<pre>';
var_dump(ftp_nlist($connect, ''));
var_dump(ftp_nlist($connect, '/outgoing/'));
var_dump(ftp_nlist($connect, '/2689312/'));
var_dump(ftp_nlist($connect, '/2689312/outgoing/')); 
```

但是为什么不让我列出低于顶级目录的列表呢？这真的难倒我。我什至无法进入子文件夹，更不用说我需要打开的完整文件夹方案了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T15:42:05.310

大多数 FTP 服务不会让正在连接的 FTP 客户端比主目录更深入。所以检查正在连接的用户的主目录。

也可能是您调用了错误的目录。

如果`/2689312/`在您的起始目录下方。尝试做`../2689312/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T06:31:24.320

您必须先使用`ftp_chdir`更改目录。

我花了很长时间才弄清楚这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T15:53:22.820

要获取 CWD 的列表，而不是：

`var_dump(ftp_nlist($connect, ''));`

你需要做：

`var_dump(ftp_nlist($connect, '.'));`

我相信如果你想从那里更深入，目录必须是：

`./subdirectory`

# c++ - 行中的最后一个单词未读

> ID：872656
> 
> 赞同：0
> 
> 时间：2009-05-16T15:44:13.980
> 
> 标签：c++, delimiter, line-endings, csv

我目前正在开发一个程序，该程序从文件中读取每一行并使用特定分隔符从该行中提取单词。

所以基本上我的代码看起来像这样

```
#include <iostream>
#include <fstream>
#include <string>

using namespace std;

int main(int argv, char **argc)
{
  ifstream fin(argc[1]);
  char delimiter[] = "|,.\n ";
  string sentence;

  while (getline(fin,sentence)) {
     int pos;
     pos = sentence.find_first_of(delimiter);
     while (pos != string::npos) {
        if (pos > 0) {
           cout << sentence.substr(0,pos) << endl;
        }
          sentence =sentence.substr(pos+1);
          pos = sentence.find_first_of(delimiter);
      }
  }
} 
```

但是我的代码没有读取该行的最后一个单词。例如，我的文件如下所示。你好世界

程序的输出只有单词 "hello" 而不是 "world" 。我使用 '\n' 作为分隔符，但为什么它不起作用？

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T15:57:34.917

getline 不会在字符串中保存换行符。例如，如果您的文件包含“Hello World\n”行，getline 将读取此字符串“Hello World\0”，因此您的代码会丢失“World”。

忽略未定义的那句话，您可以更改代码以使其像这样工作：

```
#include<iostream>
#include<fstream>
using namespace std;

int main(int argv, char *argc)
{
  ifstream fin(argc[1]);
  char delimiter[]="|,.\n ";
  while (getline(fin,sentence)) {
     sentence += "\n";
     int pos;   
     pos = find_first_of(sentence,delimiter);
     while (pos != string:: npos) {
        if (pos > 0) {
           cout << sentence.substr(0,pos) << "\n";
        }
          sentence =sentence.substr(pos+1);
          pos = find_first_of(sentence,delimiter);
      }
  }
} 
```

请注意，我借用了 Bill the Lizards 更优雅的附加最后一个分隔符的解决方案。我以前的版本有一个循环退出条件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T15:58:15.943

解释[这个参考文件](http://www.cplusplus.com/reference/iostream/istream/getline/)：

提取字符直到找到分隔字符 ( `\n`)、丢弃并返回剩余字符。

您的字符串不以 结尾`\n`，它是`^`hello world`$`，因此找不到分隔符或新 pos。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T16:30:03.603

正如其他人所提到的， getline 最后不会返回换行符。修复代码的最简单方法是在 getline 调用之后将一个附加到句子的末尾。

```
#include <iostream>
#include <fstream>
#include <string>

using namespace std;

int main(int argv, char **argc)
{
  ifstream fin(argc[1]);
  char delimiter[] = "|,.\n ";
  string sentence;

  while (getline(fin,sentence)) {
     sentence += "\n";
     int pos;
     pos = sentence.find_first_of(delimiter);
     while (pos != string::npos) {
        if (pos > 0) {
           cout << sentence.substr(0,pos) << endl;
        }
          sentence =sentence.substr(pos+1);
          pos = sentence.find_first_of(delimiter);
      }
  }
} 
```

# jvm - 如何使用多个 Java 代理启动我的 Java 程序？

> ID：872657
> 
> 赞同：90
> 
> 时间：2009-05-16T15:44:27.613
> 
> 标签：jvm, javaagents

我知道如何使用 java 代理启动 java 程序：

```
java -javaagent:myAgent.jar MyJavaProgram 
```

但是如果我想添加 2 个或更多 Java 代理来检测我的程序怎么办？我不想为必须在 JVM 中加载的每个代理重新调用 java -javaagent:...。

我试过这样的事情：

```
java -javaagent:agentA.jar, agentB.jar MyJavaProgram 
```

或类似的东西：

```
java -javaagent:agentA.jar agentB.jar MyJavaProgram 
```

但是没有成功。

有解决我问题的答案吗？

谢谢你。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-05-16T15:50:38.833

两个`javaagent`参数呢？

```
java -javaagent:agentA.jar -javaagent:agentB.jar MyJavaProgram 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-05-16T15:50:32.997

看来您可以通过使用多个参数来做到这一点。从[文档](http://java.sun.com/javase/6/docs/api/java/lang/instrument/package-summary.html)中：

> 在具有命令行界面的实现中，通过将此选项添加到命令行来启动代理：
> 
> ```
> -javaagent:jarpath[=options] 
> ```
> 
> *jarpath*是代理 JAR 文件的路径。*options*是代理选项。**此开关可以在同一命令行上多次使用，从而创建多个代理**。多个代理可以使用相同的 jarpath。代理 JAR 文件必须符合 JAR 文件规范。

（我的重点）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-19T11:17:26.500

除了上面的答案，如果您使用 ant 并且想要包含`<jvmargs />`多个 jar`-javaagent`来启动服务器，这就是我的做法，

**构建.xml**

```
<target name="blah">
...
    <jvmarg value="-javaagent:${jar1.path}" />
    <jvmarg value="-javaagent:${jar2.path}" />
...
</target> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-27T05:25:04.807

有一个旨在支持多个 Java 代理的新项目。目前它仅限于特定的。

> 邦德特工是一个超级特工，它对其他几个特工进行包装和派遣。这样，您只需在 JVM 中安装一个代理，其中包含一组配置数据（其中包含多个单独的部分）。

有关详细信息，请参阅[https://github.com/fabric8io/agent-bond/blob/master/README.md](https://github.com/fabric8io/agent-bond/blob/master/README.md)

# ruby - 你如何影响 Ruby 代码的加载顺序？

> ID：872663
> 
> 赞同：1
> 
> 时间：2009-05-16T15:46:46.407
> 
> 标签：ruby, monkeypatching

假设您的同事猴子修补了 Fixnum 类并重新定义了 + 方法以减去而不是添加：

```
class Fixnum
  def +(x)
    self - x
  end
end

>> 5 + 3
=> 2 
```

您的问题是您想访问 + 方法的原始功能。所以你把这段代码放在他之前的同一个源文件中。*在他对其进行猴子补丁之前*，它会将+ 方法别名为“original_plus” 。

```
class Fixnum
  alias_method :original_plus, :+
end

class Fixnum
  def +(x)
    self - x
  end
end 
```

现在您可以通过 original_plus 访问 + 方法的原始功能

```
>> 5 + 3
=> 2
>> 5.original_plus(3)
=> 8 
```

但我需要知道的是：

**除了将其粘贴到他修改的同一源文件中之外，还有其他方法可以在加载他的猴子补丁之前加载此别名吗？**

我的问题有两个原因：

1.  我可能不想让他知道我已经这样做了
2.  如果源文件被更改，使得别名最终低于猴子补丁，则别名将不再产生所需的结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T17:05:00.480

当然。在你需要他的源文件*之前*，只需在你的代码中粘贴 anti-monkeypatch 。

```
 % cat monkeypatch.rb
 class Fixnum
   def +(x)
     self - x
   end
 end
 % cat mycode.rb
 class Fixnum
   alias_method :original_plus, :+
 end
 require 'monkeypatch'
 puts 5 + 3 #=> 2
 puts 5.original_plus(3) #=> 8 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T17:16:24.633

Monkeypatching 可以很好地扩展现有类并添加新功能。Monkeypatching 改变现有功能的行为简直太疯狂了！

说真的，你应该和你的同事谈谈。

如果像在您的示例中那样，他确实重新定义了现有方法只是为了改变其行为，您应该与他交谈并建议他使用`alias_method_chain`以保存现有行为。

# .net - 多次重复 mstest 测试运行

> ID：872669
> 
> 赞同：9
> 
> 时间：2009-05-16T15:50:21.873
> 
> 标签：.net, mstest

我的一些 mstest 单元测试有助于检测多线程竞争条件，因此它们在连续运行多次时最有用，但我只想对特定的测试运行执行此操作 - 并非一直如此。

有没有办法配置 mstest（最好在测试列表编辑器中）多次运行测试？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-03T14:08:08.320

我需要做类似的事情，所以我想出了一个解决方案。

这并不简单，但是一旦设置好所有内容，您就可以跨项目重用它。我还在 GitHub ( [https://github.com/johnkoerner/MSTestLooper](https://github.com/johnkoerner/MSTestLooper) ) 上下载了此代码，但如果它在某个时候消失，我就是这样做的。

首先，我们创建一个属性，将其应用于我们的类，告诉它多次运行所有测试。在单独的程序集中执行所有这些操作，因为 DLL 需要位于特殊位置。

```
[Serializable]
public class TestLooperAttribute :  TestClassExtensionAttribute
{
    private static readonly Uri thisGuy = new Uri("urn:TestLooperAttribute");

    private string _PropertyName;
    public string PropertyName
    {
        get
        { return _PropertyName; }
        set
        {
            _PropertyName = value;
        }
    }
    public override Uri ExtensionId
    {

        get {
            return thisGuy; }
    }

        public override TestExtensionExecution GetExecution()
    {

        return new TestLooperExecution(PropertyName);
    }
} 
```

接下来我们要创建一个自定义的测试类执行类：

```
class TestLooperExecution : TestExtensionExecution
{
    private string PropertyName;

    public TestLooperExecution(string PropertyName)
    {
        this.PropertyName = PropertyName;
    }

    public override ITestMethodInvoker CreateTestMethodInvoker(TestMethodInvokerContext InvokerContext)
    {
        return new TestLooperInvoker(InvokerContext, PropertyName);
    }

    public override void Dispose()
    {
        //TODO: Free, release or reset native resources
    }

    public override void Initialize(TestExecution Execution)
    {
        //TODO: Wire up event handlers for test events if needed

    }
} 
```

最后，我们添加一个自定义调用程序，这是我们执行循环的地方：

```
class TestLooperInvoker : ITestMethodInvoker
{
    private TestMethodInvokerContext m_invokerContext;
    private string PropertyName;

    public TestLooperInvoker(TestMethodInvokerContext InvokerContext, string PropertyName)
    {
        m_invokerContext = InvokerContext;
        this.PropertyName = PropertyName;
    }

    public TestMethodInvokerResult Invoke(params object[] args)
    {

        // Our helper results class to aggregate our test results
        HelperTestResults results = new HelperTestResults();

        IEnumerable<object> objects = m_invokerContext.TestContext.Properties[PropertyName] as IEnumerable<object>;

        foreach (var d in objects)
            results.AddTestResult(m_invokerContext.InnerInvoker.Invoke(d), new object[1] { d.GetType().ToString()});

        var output = results.GetAllResults();
        m_invokerContext.TestContext.WriteLine(output.ExtensionResult.ToString());

        return output;
    }
} 
```

HelperTestResults 类只是为输出构建字符串，您可以按照自己的方式处理它，我不想包含该代码，因为它只会使这篇文章更长。

把它编译成一个DLL，然后你需要把它复制到

```
C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\PublicAssemblies 
```

您还必须为该类创建一个注册表项：

```
Windows Registry Editor Version 5.00 
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\VisualStudio\11.0\EnterpriseTools\QualityTools\TestTypes\{13cdc9d9-ddb5-4fa4-a97d-d965ccfc6d4b}\TestTypeExtensions\TestLooperAttribute]
"AttributeProvider"="TestLooper.TestLooperAttribute, TestLooper" 
```

现在你已经完成了所有这些，你终于可以使用这个类了：

```
using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using TestLooper;
using System.Collections.Generic;
namespace UnitTestSamples
{
    [TestLooper(PropertyName="strings")]
    public class UnitTest1
    {
        public static List<String> strings = new List<String>();
        private TestContext testContextInstance;

        public TestContext TestContext
        {
            get
            {
                return testContextInstance;
            }
            set
            {
                testContextInstance = value;
            }
        }
        [ClassInitialize()]
        public static void Init(TestContext x)
        {
            strings.Add("A");
            strings.Add("B");
            strings.Add("C");
            strings.Add("D");

        }

        [TestInitialize()]
        public void TestInit()
        {
            if (!TestContext.Properties.Contains("strings"))
            testContextInstance.Properties.Add("strings", strings);
        }

        [TestMethod]
        [DataSource("Microsoft.VisualStudio.TestTools.DataSource.CSV", "DataDriven1.csv", "DataDriven1#csv", DataAccessMethod.Sequential)]
        [DeploymentItem("DataDriven1.csv")]
        public void TestMethodStrings(string s)

        {
            int value1 = Convert.ToInt32(TestContext.DataRow["Col1"]); ;
            TestContext.WriteLine(String.Format("{0}:{1}", s, value1));
        }
    }
} 
```

请注意，我们的测试方法接受一个来自测试循环器的参数。我还使用数据驱动测试来展示这一点，以表明您可以将两者结合在一起以在您的数据集中生成大的排列。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-01-12T17:06:54.327

```
[TestMethod()]
public void RepetableTest(){
   for(int i = 0; i < repeatNumber; i++){

     //test code goes here

   }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-04T00:08:16.880

考虑创建一个测试来分离几个线程。测试列表不允许您为同一测试拥有多个条目。但是，您可以将多线程测试分配给它自己的列表，并仅在您想要运行该特定测试时调用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-20T14:43:34.153

我想答案是否定的。

# c++ - 基于策略的设计和最佳实践 - C++

> ID：872675
> 
> 赞同：36
> 
> 时间：2009-05-16T15:52:44.117
> 
> 标签：c++, design-patterns, policy-injection, policy-based-design

```
struct InkPen
{
  void Write()
  {
    this->WriteImplementation();
  }

  void WriteImplementation()
  {
    std::cout << "Writing using a inkpen" << std::endl;
  }

};

struct BoldPen
{
  void Write()
  {
    std::cout << "Writing using a boldpen" << std::endl;
  }
};

template<class PenType>
class Writer : public PenType
{
public:
  void StartWriting()
  {
    PenType::Write();
  }
};

int main()
{
  Writer<InkPen> writer;
  writer.StartWriting();
  Writer<BoldPen> writer1;
  writer1.StartWriting();
  return 0;
} 
```

我将上述代码作为基于学习*策略的设计*的一部分编写。我对上面的代码有几个问题

1 - 这个实现看起来正确吗？我的意思是：它真的看起来像基于策略的设计吗？

2 - 我现在可以将任何类型的笔挂到作家身上。但是当我得到一支没有默认构造函数（只有参数化构造函数）的笔时，我该怎么办？我将如何处理这种情况？

```
template<class PenType>
class Writer : public PenType
{
public:
  void StartWriting()
  {
    PenType::Write();
  }
}; 
```

3 - 当使用上述代码时

```
Writer<InkPen> writer; 
```

我猜编译器会将*PenType*替换为*InkPen*。如果是，为什么我不能只从*StartWriting()调用**Write(* )而不是为基类名称添加前缀（*PenType::Write()*）？

 **4 - 我认为基于策略的设计迫使您从语义上无效的类中派生。在上面的代码中，writer 是从 pen 派生的，只是因为 writer 使用的是 pen。但是说作家是一支笔在语义上是无效的。有没有其他更好的方法来解决这个问题，或者我在这里遗漏了什么？

有什么想法吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-16T16:41:39.770

以下是我将如何实现该类：

```
template<class PenType>
class Writer
{
public:
  Writer(const PenType& pen = PenType()) : pen(pen) {}

  void StartWriting()
  {
    pen.Write();
  }

private:
  PenType pen;
}; 
```

这允许用户将特定的 Pen 对象传递给构造函数，如果它没有默认构造函数，或者您不希望使用它，其次，它仍然允许您省略 PenType 对象，如果您'很高兴让它使用默认构造函数创建一个。C++ 标准库在许多类中做同样的事情（例如，考虑容器类的分配器）。

我删除了继承。它似乎并没有真正添加任何东西（并且可能会导致问题。您可能不希望 Writer 类的用户直接调用 PenType::Write 函数。您可以改用私有继承，但通常，组合是一个更简单和更传统的设计。

一般来说，基于策略的设计不需要继承。将其添加为成员也同样有效。如果您确实要继承，请将其设为私有，这样您就不会遇到您在#4 中提到的问题。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-16T16:22:39.067

这看起来像是基于策略的智能指针实现的一个很好的例子：[链接](http://axter.com/smartptr/classsmart__ptr.htm)。[Andrei Alexandrescu](http://en.wikipedia.org/wiki/Andrei_Alexandrescu)在他的一本书中描述了基于策略的智能指针实现。至于你现在的问题。我在这方面有一些经验，但不足以认为我的话是理所当然的：

广告 1 和 4。我猜基于策略的设计更多是关于模板而不是继承。您编写一个模板类，模板参数是策略类，如下所示：

```
template<class FooPolicy, class BarPolicy>
class Baz {
    // implementation goes here
}; 
```

然后你在你的类中使用策略类的方法：

```
void Baz::someMethod(int someArg) {
    FooPolicy::methodInit();
    // some stuff
    BarPolicy::methodDone();
} 
```

我在此示例中使用静态方法，因为策略通常不需要任何状态。如果是这样，您可以通过组合而不是继承来合并策略的状态：

```
template<class FooPolicy, class BarPolicy>
class Baz {
  private:
    FooPolicy::State fooState; // might require 'typename' keyword, I didn't
                               // actually tried this in any compiler
    // rest of the Baz class
}; 
```

广告 2\. 您可以编写模板专业化 - 对于主类及其策略的特定组合，您可以编写任何方法或构造函数的特殊版本，AFAIK：

```
template <>
Baz<SomeConcreteFooPolicy, SomeConcreteBazPolicy>::Baz(someArgument)
   : fooState(someArgument)
{
    // stuff here
} 
```

希望对你有点帮助

麦克风

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-06-17T19:13:26.700

我知道这个帖子很旧，但在最初的帖子中有一个重大缺陷，这个帖子是谷歌的最佳结果之一......所以：

不要将`public`继承用于基于策略的设计！这会说“is-a”而不是“has-a”/“uses-a”。因此，您应该使用`private`继承！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-06-29T02:32:29.890

> 1 - 这个实现看起来正确吗？我的意思是它真的看起来像一个基于策略的设计吗？

策略类从组合行为以产生丰富多样的组合中获得有用性。当你有一个这样的模板参数时，它就不是一个策略类。

> 2 - 我现在可以将任何类型的笔挂到作家身上。但是当我得到一支没有默认构造函数（只有参数化构造函数）的笔时，我该怎么办？我将如何处理这种情况？

同样，这是策略类的一个奇怪示例。但是，要直接回答您的问题，您可以提供一个接受 PenType 的构造函数。您可能还应该避免从 PenType 继承并将其存储为成员（无需将您的策略​​类与其策略紧密耦合）。

> 我猜编译器会将 PenType 替换为 InkPen。如果是，为什么我不能只从 StartWriting() 调用 Write() 而不是在基类名称前添加前缀 (PenType::Write())？

从类模板继承时，必须指定 this->member 或 BaseClass::member。

> 4 - 我认为基于策略的设计迫使您从语义上无效的类中派生。在上面的代码中，writer 是从 pen 派生的，只是因为 writer 使用的是 pen。但是说作家是一支笔在语义上是无效的。有没有其他更好的方法来解决这个问题，或者我在这里遗漏了什么？

如上所述，将 PenType 存储为成员。总是喜欢组合而不是继承，因为它避免了继承的紧密耦合关系。

# .net - .net 3.5 客户端配置文件。完全没用？我错过了什么吗？

> ID：872676
> 
> 赞同：9
> 
> 时间：2009-05-16T15:53:03.180
> 
> 标签：.net, .net-3.5, client

我目前正在为未来的项目评估 .net 客户端配置文件，我发现有些东西我认为它毫无用处，除非我当然遗漏了一些东西。

我已经在干净的 xp vm 上安装了客户端配置文件。当我开发了一个小型测试 winform 应用程序（针对 .net 3.5 客户端配置文件进行编译）并将其复制到虚拟机时，我无法运行它。错误消息是我需要 .net 3.5 sp1 或更高版本。我猜问题出在 sp1，是否有客户端配置文件 sp1？我找不到。

然后我打开windows update来获取SP1。这是对 sp1 的 70MB 更新，完全忽略了“小型”.net 客户端框架的意义。在此之后，该应用程序确实起作用了。

另一件事，客户端配置文件是一个在线安装程序。离线安装程序是255MB？这么少的功能和大约与完整的 .net 框架相同的大小？

另一件事，如果您安装了任何以前版本的 .net（并非完全没有听说过，vista 和 2003 甚至包括它），客户端配置文件根本不会安装。将 2.0 升级到 3.5 sp1 比客户端配置文件 (28mb) 大很多，所以如果可以的话，它会很有用。

那么，我有错吗？如果我不是，有没有人真的发现客户资料有用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T16:06:29.870

我的经历和你的差不多。最重要的是，我发现在使用 Visual Studio 创建 ClickOnce 应用程序时，客户端配置文件根本无法作为安装过程的一部分进行安装，因此您最终不得不安装整个框架。

即便如此，它似乎仍然无法在所有机器上正确运行，所以我放弃了它，只是将最新的完整框架与我的程序一起打包以保证成功，确保项目设置不使用仅客户端选项。

我个人希望看到一些关于正确使用仅限客户端的框架的文档，以及为什么它在当前版本中似乎被严重破坏的一些理由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-23T02:42:30.400

如果您正在分发需要尽可能低影响的可下载的大众市场客户端应用程序，那么使用客户端配置文件有一些优势。下面是对各种版本的 .NET 框架对各种版本的 windows（不幸的是不包括 Vista）的安装时间影响的回顾：

[http://coditate.blogspot.com/2008/12/impact-of-net-framework-on-software.html](http://coditate.blogspot.com/2008/12/impact-of-net-framework-on-software.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T12:57:46.817

您需要在可执行文件旁边添加一个特殊的 .config 文件，表明该应用程序支持客户端配置文件。当您单击“客户端框架子集”按钮时，Visual Studio 会自动创建此文件。有关更多信息，请参阅客户端配置文件 msdn 文档[http://msdn.microsoft.com/en-us/library/cc656912.aspx](http://msdn.microsoft.com/en-us/library/cc656912.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T08:14:24.770

我使用 Click Once 部署了面向 .Net 3.5 Client Profile SP1 的应用程序，并且在设置过程中会自动提示缺少该框架的用户下载并安装客户端配置文件。（即它有效）。

也许检查先决条件（尽管我认为它们可能只适用于单击一次）：

![在此处输入图像描述](https://i.stack.imgur.com/YwmQL.png)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-09-12T07:45:00.643

您必须先在WIN XP中安装.NET FRAMEWORK(1.1, 2.0/sp1, 3.0/sp1, 3.5)版本，才能完整安装.NET FRAMEWORK 3.5 SP1 Client Profile，否则，只需.NET FRAMEWORK Client Profile即可被安装。

引用自： [https ://msdn.microsoft.com/en-us/library/cc843122%28v=vs.90%29.aspx](https://msdn.microsoft.com/en-us/library/cc843122%28v=vs.90%29.aspx)

# c++ - WH_MOUSE 和 WH_MOUSE_LL 钩子有什么区别？

> ID：872677
> 
> 赞同：7
> 
> 时间：2009-05-16T15:53:07.343
> 
> 标签：c++, winapi, hook

我发现`WH_MOUSE`并不总是这样。问题可能是我正在使用`WH_MOUSE`而不是`WH_MOUSE_LL`？

编码：

```
class MouseHook
{
public:
  static signal<void(UINT, const MOUSEHOOKSTRUCT&)> clickEvent;

  static bool install() 
  {
    if (isInstalled()) return true;
    hook = ::SetWindowsHookEx(WH_MOUSE, (HOOKPROC)&mouseProc,  
                                ::GetModuleHandle(NULL), NULL);
    return(hook != NULL);
  }

  static bool uninstall() 
  {
    if (hook == NULL) return TRUE;
    bool fOk = ::UnhookWindowsHookEx(hook);
    hook = NULL;
    return fOk != FALSE;
  }

  static bool isInstalled() { return hook != NULL; }

private:
   static LRESULT CALLBACK mouseProc(int nCode, WPARAM wParam, LPARAM lParam)
   {            
      if (nCode == HC_ACTION && 
        (wParam == WM_LBUTTONDOWN || wParam == WM_NCLBUTTONDOWN ||
         wParam == WM_RBUTTONDOWN || wParam == WM_NCRBUTTONDOWN ||
         wParam == WM_MBUTTONDOWN || wParam == WM_NCMBUTTONDOWN ))
      {
        MOUSEHOOKSTRUCT* mhs = (MOUSEHOOKSTRUCT*) lParam;
        clickEvent(wParam, *mhs);
      }         

      return ::CallNextHookEx(hook, nCode, wParam, lParam);
    }

   static HHOOK hook;
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-16T16:13:06.470

不同之处在于回调被调用时的行为。如果您使用的是低级版本，则不会因为调用钩子函数的方式而受到 lpfn 带来的限制。请阅读以下内容以获取更多信息。引用 MSDN 的 SetWindowsHookEx 文档：

> lpfn [in] 指向钩子程序的指针。如果 dwThreadId 参数为零或指定由不同进程创建的线程的标识符，则 lpfn 参数必须指向 DLL 中的挂钩过程。否则，lpfn 可以指向与当前进程关联的代码中的挂钩过程。

并来自 LowLevelKeyboardProc：

> WH_KEYBOARD_LL 钩子没有注入到另一个进程中。相反，上下文切换回安装钩子的进程，并在其原始上下文中调用它。然后上下文切换回生成事件的应用程序。

# python - Python 在同一文件上交错打开/关闭/读取行/写入时生成 IO 错误

> ID：872680
> 
> 赞同：1
> 
> 时间：2009-05-16T15:53:13.007
> 
> 标签：python, python-3.x

我正在学习 Python——这给了我一个 IO 错误——

```
f = open('money.txt')
while True:
    currentmoney = float(f.readline())
    print(currentmoney, end='')
    if currentmoney >= 0:
        howmuch = (float(input('How much did you put in or take out?:')))

        now = currentmoney + howmuch
        print(now)
        str(now)
        f.close()
    f = open('money.txt', 'w')
    f.write(str(now))
    f.close() 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T16:02:47.023

`while True`除非你用 . 打破它，否则它将永远循环`break`。

I/O 错误可能是因为当您运行循环时，您所做的最后一件事是`f.close()`，这会关闭文件。当继续执行循环时，`currentmoney = float(f.readline())`:`f`将是一个关闭的文件句柄，您无法从中读取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T15:58:57.440

好吧，有几件事...

你`open(money.txt)`在while循环之外，但你在第一次迭代后关闭它......（从技术上讲，你关闭，重新打开并再次关闭）

当循环第二次出现时，`f`将关闭并且 f.readLine() 很可能会失败

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T15:58:19.827

仅当满足 IF 条件时才关闭文件，否则在 IF 块后尝试重新打开它。根据您想要实现的结果，您将需要删除 f.close 调用，或者添加一个 ELSE 分支并删除第二个 f.open 调用。无论如何，让我警告您，您的 IF 块中的 str(now) 已被弃用，因为您没有在任何地方保存该调用的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T16:12:39.963

如果 money.txt 不存在，您将在第一行收到 IO 错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T16:40:00.553

我可以背一个问题吗？以下让我困惑了一段时间。我总是从这些“open()”语句中得到一个 IOError，所以我已经停止检查错误。（不喜欢那样做！）我的代码有什么问题？注释中显示的“if IOError:”测试最初位于带有“open()”的语句之后。

```
if __name__ == '__main__':
#get name of input file and open() infobj
    infname = sys.argv[1]
    print 'infname is:  %s' % (sys.argv[1])
    infobj = open( infname, 'rU' )
    print 'infobj is:  %s' % infobj
# 'if IOError:' always evals to True!?!
#   if IOError:
#       print 'IOError opening file tmp with mode rU.'
#       sys.exit( 1)

#get name of output file and open() outfobj
    outfname = sys.argv[2]
    print 'outfname is: %s' % (sys.argv[2])
    outfobj = open( outfname, 'w' )
    print 'outfobj is: %s' % outfobj
#   if IOError:
#       print 'IOError opening file otmp with mode w.'
#       sys.exit( 2) 
```

# php - mod_php 与 mod_python

> ID：872695
> 
> 赞同：4
> 
> 时间：2009-05-16T16:01:54.437
> 
> 标签：php, python, mod-python

**为什么 mod_python 是 oop 而 mod_php 不是？**

*示例：我们去 www.example.com/dir1/dir2*

如果你使用 mod_python apache 打开 www/dir1.py 并调用 dir2 方法但是如果你使用 php 模块 apache 打开 www/dir1/dir2/index.php

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T03:02:35.410

让我们谈谈 mod_python 与 mod_php。

由于 Python 语言不是专门为网页服务而设计的，所以 mod_python 必须做一些额外的工作。

由于 PHP 语言是专门为网页服务而设计的，所以 mod_php 只需启动一个命名的 PHP 模块。

对于 mod_python（不同于 mod_fastcgi 或 mod_wsgi），mod_python 的设计者决定调用 Python 的最佳方式是调用模块中定义的对象的方法。希望该对象的该方法将标题和网页内容写入标准输出。

对于 mod_wsgi，设计者决定调用 Python 的最佳方式是调用模块中的函数（或可调用对象）。希望该函数将使用提供的对象来创建标题并返回带有网页内容的列表字符串。

在 mod_php 的情况下，它们只是调用模块，因为 PHP 模块是为网页服务而设计的。程序运行，运行的结果是一页内容；通常是 HTML。

mod_php 以一种方式工作，mod_python 以另一种方式工作而 mod_wsgi 以第三种方式工作的原因是因为它们不同。由不同的人编写，对产生网页的方式有不同的定义。

php 页面可以是面向对象的。mod_wsgi 函数可能是一个可调用对象，也可能是一个简单函数。这些是设计选择。

类的 mod_python 要求是 mod_python 的设计者做出的设计选择。

“为什么”的理由永远没有用。“为什么”的原因是因为有人决定这样设计它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T17:05:39.900

因为 mod_python 将 URL 抽象为“类 RPC”机制。您可以在 PHP 中实现相同的功能。我总是手工完成，但我很确定有为此预先打包的 pear 模块。

请注意， mod_python 行为并不是强制“最好的”。这一切都取决于您想为您的应用程序提供的设计类型，以及它对客户的行为方式。据我所知，mod_python 方法假定每个 URL 都有一个函数，例如将模块结构映射到 URL 树。从技术上讲，这不是一个特别好的方法，因为您使用的技术 (mod_python) 与应用程序的 URL 布局之间存在紧密的关联。

*至于为什么*，没有理由。有些人喜欢一种食物，有些人喜欢另一种食物。在某些情况下，设计是品味和艺术选择的问题，而不仅仅是技术限制。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T17:54:27.380

我认为您对 HTTP 的工作方式有一些误解。http 标准中没有任何内容要求您将某个文件作为资源。这就是 mod_php 的工作方式，对于给定的路径，该路径被转换为服务器磁盘上的 php 文件，然后由编译器解释。

另一方面， mod_python 模块更加通用，它允许您将任何资源映射到对某个 python 对象的调用*。*碰巧有些配置是开箱即用的，以使其更容易开始。在大多数情况下，url 的调度是由你的框架管理的，它的工作方式取决于框架的实现者。

由于*mod_python模块的通用性，您还可以访问**mod_php*模块中不可用的一些 apache 功能，例如，您可以编写自己的身份验证处理程序，这不仅适用于您的 python webapp，还适用于您的 apache 中的其他应用程序也是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T04:11:45.153

在 PHP 中，您可以对网页进行自上而下的脚本、过程编程和函数调用、OOP 编程。这是最初创建 PHP 以及它如何发展的主要原因。mod_php 只是 web 服务器使用 PHP 作为预处理器的模块。所以它只是将 HTTP 信息和 PHP 脚本传递给 PHP 解释器。网页创建的PHP方式是做你想做的；编写一个从上到下的脚本，在不同的文件中定义函数并包含这些函数并调用函数，或者用 OOP 编写您的应用程序，您现在还可以使用许多功能齐全的框架来确保您的应用程序设计和结构符合当今的最佳实践和设计模式。

我是 Python 新手，不熟悉使用 Python 进行 Web 编程。但据我所知，创建 python 并不是为了让 Web 编程更容易。它旨在成为一种通用编程语言，因此尽管可以在 python 中编写简单的从上到下的脚本并将它们作为网页响应运行（我不确定这样的事情是否可能），但它是不是 Python 的方式，所以我认为 mod_python 的开发人员希望 Python 中的 Web 编程采用 Python 的方式。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-16T16:09:08.290

也许我误解了你的问题，但是 Python 和 PHP 都支持过程和面向对象的编程。（尽管有人可能会争辩说 Python 对 OO 的支持是两者中更强的。）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-16T16:11:11.467

查看[PHP 5 中的类和对象](http://www.php.net/zend-engine-2.php)

# .net - LINQ 性能 - 延迟与立即执行

> ID：872697
> 
> 赞同：3
> 
> 时间：2009-05-16T16:02:12.500
> 
> 标签：.net, linq, performance

我已经看到，有时 LINQ to Objects 查询的性能如果通过使用强制立即执行可以显着提高`.ToArray()`，但不能完全理解为什么。例如，在下面的示例中，函数的执行速度`Deferred()`比函数慢得多，`Immediate()`并且随着`limit``Immediate()`

```
public void Deferred()
{
    var all = Range(limit);
    var even = from e in EvenRange(limit) where all.Contains(e) select e;
    var odd = from o in OddRange(limit) where !even.Contains(o) select o;

    var query = from q in odd select q;

    foreach(var i in query) { var j = i+1; }
}

public void Immediate()
{
    var all = Range(limit);
    var even = (from e in EvenRange(limit) where all.Contains(e) select e)
        .ToArray();
    var odd = (from o in OddRange(limit) where !even.Contains(o) select o)
        .ToArray();

    var query = (from q in odd select q).ToArray();

    foreach(var i in query) { var j = i+1; }
}

public static IEnumerable<int> OddRange(int stop)
{
    for (int i = 1; i < stop; i+=2) yield return i;
}

public static IEnumerable<int> EvenRange(int stop)
{
    for (int i = 2; i < stop; i+=2) yield return i;
}

public static IEnumerable<int> Range(int stop)
{
    for (int i = 0; i < stop; ++i) yield return i;
} 
```

是什么导致了这种放缓？它只是编译器生成的额外代码，并且每次我访问可枚举时都必须运行，还是`Deferred()`还进入了一些额外的循环，从而改变了查询的“Big O”复杂性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T16:06:19.637

据我所知 IEnumerable 不会缓存结果，因此您的涉及 even.Contains 的子句（必须检查 even 的所有元素）会强制重新枚举 even，从而显示您注意到的性能行为。在枚举奇数时，即使在数组或列表中转换也应该显示出良好的性能。其他 .NET 语言（例如 F#）包括缓存枚举结果的方法（如果您有兴趣，可以查看 F# 的 Seq.cache 方法）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T17:40:51.970

正如 emaster70 所解释的，该`Deferred`版本会`even`为每次调用`even.Contains`. 这使得它对于更高的值会非常迅速地退化`limit`。

`Immediate`版本更好，如果你也立即`all`收集，像这样：

```
var all = Range(limit).ToArray(); 
```

它快了大约三倍。

但是，`Contains`数组的方法是 O(n) 操作，因此也不能很好地扩展。如果条件相等，则应使用连接而不是使用`Contains`.

如果您需要进行查找，则应使用 a`HashSet`而不是数组，因为该`Contains`方法是 O(1) 操作。

对于`limit`10000 的 a，这比`Immediate`版本快 100 倍：

```
public void Joined() {
    var all = Range(limit);
    var even = from e in EvenRange(limit) join a in all on e equals a select e;
    var evenSet = new HashSet<int>(even);
    var odd = from o in OddRange(limit) where !evenSet.Contains(o) select o;

    var query = from q in odd select q;

    foreach (var i in query) { var j = i + 1; }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T16:10:33.603

除了 emaster70 所说的，当从数组中读取值时，整个缓存行被提取到系统缓存中，这意味着当查看数组时，它比从主内存中读取要快得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T16:23:52.527

在这段代码中

```
var all = Range(limit);    
var even = from e in EvenRange(limit) where all.Contains(e) select e;    
var odd = from o in OddRange(limit) where !even.Contains(o) select o; 
```

由于从迭代器块或 LINQ 查询构造的 IEnumerables 是惰性的，因此计算“奇数”的每个元素需要重新计算整个“偶数”序列。结果，这段代码的大 O 很糟糕。使用非常小的“限制”并将 Console.WriteLine() 放入 Range() 的循环中并观察行为可能是有益的。

# ruby - Ruby 中未初始化的常量 MyClass (NameError)

> ID：872701
> 
> 赞同：8
> 
> 时间：2009-05-16T16:04:14.040
> 
> 标签：ruby

我有一个模块 Shish（它就像一个抽象类）和一个访问者类 Only_Onions。

我想在模块 Shish 中实例化 Only_Onions，以便所有扩展 Shish 的类都可以使用该对象来确定它们是否只有 __onions。

```
module Shish
    only_onions_class = Only_Onions.new
end

class Only_Onions
    def for_skewer
        return true
    end
end

class Skewer
    include Shish

    def only_onions
        return only_onions_class.for_skewer
    end

    def veg?
        return true
    end
end 
```

但是我收到一个错误“未初始化的常量 Shish::Only_Onions (NameError)。这是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T16:45:54.580

申报顺序具有效力。Shish 不知道代码中的 Only_Onions。如果将其更改为此，则在定义模块 Shish 时已经声明了 Only_Onions：

```
class Only_Onions
    def for_skewer
        return true
    end
end

module Shish
    only_onions_class = Only_Onions.new
end

class Skewer
    include Shish

    def only_onions
        return only_onions_class.for_skewer
    end

    def veg?
        return true
    end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T16:26:30.807

尝试

```
::Only_Onions 
```

# asp.net - 使用 Enter 键提交表单并搜索光标

> ID：872702
> 
> 赞同：0
> 
> 时间：2009-05-16T16:05:33.447
> 
> 标签：asp.net, jquery

我的页面中有一个文本框，用户将输入要提交的内容。但是，我不想有提交按钮，而是想听 Enter 按键以提交。

问题是，这一页中会有几个文本框，我只想提交刚刚输入的文本框。

我知道如何找出使用 jquery 按下了哪个键，但我认为在我的场景中，我需要查看光标是否在特定的文本框中。这是正确的吗？如果是这样，这是如何使用 jquery 实现的？一般来说，我的方法可以吗？还是我绝对应该有一个提交按钮？

肯...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T16:16:55.367

请注意，这被认为是不好的做法；您不仅要将提交限制为仅启用 JS 的人，人们还希望他们的表单有一个提交按钮。这就是网络的运作方式。这样做的*正确*方法是为每个文本框设置一个表单。

话虽如此，如果您有一组文本字段：

```
<input type='text' name='x1' class='onenter'>
<input type='text' name='x2' class='onenter'>
<input type='text' name='x3' class='onenter'> 
```

你可以用 jQuery 做到这一点：

```
$(function() {
    $('input.onenter').keyup(function(e) {
        if(e.keyCode == 13) {
            // enter was pressed, do whatever
            // $(this) is the current textbox
        }
    });
}); 
```

“whatever”可以是异步请求或实际表单提交，具体取决于您的需要。

# sql-server - 简化 SQL Server 的登录名/所有者/架构/角色/主体等

> ID：872718
> 
> 赞同：0
> 
> 时间：2009-05-16T16:12:37.547
> 
> 标签：sql-server, database, schema, owner

我经常使用 ASP.NET 和 SQL Server 2005 开发小型 Internet 应用程序。我的数据库始终只能由一个应用程序通过 ASP.NET Web 服务或类似的东西访问。

当我开发应用程序并在我的开发计算机 (SQLExpress 2008) 和托管服务器 (SQL Server 2005) 之间来回移动数据库时，我最终总是会得到一堆似乎可以裁剪的所有者/角色/模式/登录等启动并控制数据库的各个部分。

我只知道 SQL Server 是危险的，我只想设计数据库，但我总是不得不更改数据库并最终得到各种权限错误（例如，在传输数据库后尝试打开图表时）。

有没有办法简单地告诉 SQL Server Management Studio “嘿，我是唯一会使用这个愚蠢的数据库的人，所以让我来做吧？”

就像一些命令将所有这些部分设置为“dbo”或类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T16:42:35.540

我假设您使用的是 Windows。确保您使用 Windows 身份验证连接到 SQL，并为您的帐户提供系统管理员权限。现在，您创建的所有内容（创建表表名、创建视图视图名）都将自动将 dbo 作为所有者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T01:29:37.010

不幸的是，您的问题有几个简单的答案，但您可能不会喜欢它们，因为它们需要您投资于 SQL Server 技能。

您应该查看的第一个工具是 Visual Studio 2008 Database Developer Edition。此版本具有您正在寻找的管理工具来管理架构、用户……我认为这现在包含在 Visual Studio 2008 开发版中

第二种方法是接受 SQL Server 管理，并且对编写 DDL 脚本感到满意。目标是达到这样的程度：您可以以可预测的方式将更改部署到 SQL Server，从开发环境到测试并最终部署到生产环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T01:13:06.563

问题的症结在于您来回移动数据库本身。数据库通过登录到用户映射以及其他设置（如加密密钥、msdb 过程的使用和维护计划等）与它们的主机 SQL 实例紧密耦合。您可以通过仔细使用专用 SQL 身份验证来最大限度地减少一些影响，但这并不能完全消除问题。真正的解决方案是您应该有一个部署脚本并通过执行您之前在开发数据库上测试过的 T-SQL 脚本将更改应用到您的生产数据库，而不是通过“来回”移动数据库.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:42:40.023

我创建了所有对象，专门指定我希望将它们创建为 dbo。

所以要创建一个过程我做

创建过程 dbo.myprocname

# c - 编译 Neko VM OS X 时出错

> ID：872726
> 
> 赞同：2
> 
> 时间：2009-05-16T16:16:16.850
> 
> 标签：c, macos, gcc, compiler-construction, neko

我正在尝试使用 GCC 4.01 在 Mac OS X (10.5.7) 上编译[Neko VM](http://nekovm.org/)，但我完全卡住了，因为它在编译时停止说：

```
vm/threads.c:202: error: conflicting types for 'neko_thread_register'
vm/neko_vm.h:37: error: previous declaration of 'neko_thread_register' was here 
```

我试过用谷歌搜索，有人说这是因为缺少“原型”，有人说这是因为标题包含被多次完成，我真的找不到任何这些。

[threads.c:202](http://github.com/slaskis/neko/blob/2c6eabb567fd6297de5281a4347a98e30ff41e94/vm/threads.c#L202)中受影响的行如下所示：

```
EXTERN bool neko_thread_register( bool t ) { 
```

[neko_vm.h:37](http://github.com/slaskis/neko/blob/2c6eabb567fd6297de5281a4347a98e30ff41e94/vm/neko_vm.h#L37)中受影响的行如下所示：

```
EXTERN bool neko_thread_register( bool t ); 
```

除了其中一个是另一个的实现之外，我看不出它们有任何区别。

我正在使用的编译器命令是：

```
cc -Wall -O3 -v -fPIC -fomit-frame-pointer -I vm -D_GNU_SOURCE -arch i386 -L/usr/local/lib -L/opt/local/lib -I/opt/local/include  -o vm/threads.o -c vm/threads.c 
```

我会很感激一些关于我可以在这里做什么的想法，我真的不知道从这里去哪里。

可以在[此处](http://github.com/slaskis/neko/tree/2c6eabb567fd6297de5281a4347a98e30ff41e94/vm)找到我正在尝试编译的 Neko 代码的镜像。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T16:50:29.750

首先，确保将其编译为 C，而不是 C++。

其次，没有看到代码，几乎不可能说出问题所在。但是阅读错误消息通常会有所帮助（甚至在您搜索它们之前）：

显然`neko_thread_register`被声明了两次，一次在threads.c:202中，一次在neko_vm.h:37中，并且这两个声明具有不同的（冲突的）类型。所以看看这两个声明。如果您看不到它们的问题，请向我们展示一些代码。

至少，看到这两行代码是必要的。最有可能的类型是 typedef 或宏或类似的东西，然后我们还需要查看它们的定义位置。

没有看到代码，我们所能做的就是重复编译器错误。"`neko_thread_register`在指定的行中有两个相互冲突的定义。"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T23:43:12.767

您是否尝试过单独编译该文件并输出预处理版本？可能是在头文件和实现文件之间的某个地方修改了作用域或链接宏——“bool”类型也可能是这样，它通常是由系统头文件定义的宏。

根据此处的 GCC 4.2 文档，您应该需要在上面的编译行中添加 -E 标志，并且您应该更改`-o vm/threads.o`为`-o vm/threads.i`创建具有正确扩展名的文件（.i 本质上表示“预处理文件”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T17:57:09.573

您是否取消注释此行：

```
# For OSX
#
# MACOSX = 1   <-- this one 
```

在生成文件中？

# sql-server - SQL Server 锁升级问题

> ID：872731
> 
> 赞同：7
> 
> 时间：2009-05-16T16:17:40.717
> 
> 标签：sql-server, locking, escalation

我正在阅读关于 SQL Server 锁升级的[MSDN 页面上的 SQL Server 锁升级](http://msdn.microsoft.com/en-us/library/aa213033(SQL.80).aspx)

我的问题是，似乎存在锁升级的主要原因是为了减少维护更多锁的开销（例如，当为一个表获取更多行锁时，然后将行级锁升级到表级）。我的问题是，维护更多的锁会提高并发性，这是一个好处，为什么是开销？在我的拙见中，锁应该足够小，以通过提高并发性来提高数据库性能。谁能用简单的方式解释为什么需要锁升级以及所谓的锁开销是什么？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-16T16:55:58.737

> 谁能用简单的方式解释为什么需要锁升级以及所谓的锁开销是什么？

当您更新表并锁定一行时，您需要以某种方式记录这个事实：这是一行，它已被更新并锁定。

当你更新百万行时，你需要做这百万次，因此有一些空间来保存百万锁。

SQL Server 在内存中保存一个锁列表，而 Oracle 在表空间中保存。

这可能是因为 Oracle 比较老（比我老），而 SQL Server 比 Oracle 还年轻。

从设计师的角度来看，将临时资源（如锁）保存在永久存储中并不是那么明显的解决方案。只需提一件事：您可能需要磁盘写入才能执行`SELECT FOR UPDATE`.

Oracle 的核心功能是在 80 年代初开发的，当时根本无法选择将内容保存在内存中。他们只*需要*以某种方式使用磁盘空间。

如果要使用磁盘空间，则必须在磁盘的某处放置一个锁。

如果不在行本身内，在哪里保持一行的锁？

SQL Server 锁系统的开发人员在发明名为 Sybase 的 RDBMS 设计时，决定将临时的东西（即锁）存储在临时存储器（即 RAM）中。

但是 Oracle 的设计总是平衡的：如果你的数据库中有 1,000,000 行，那么你就有 1,000,000 个锁的存储空间，如果你有 10 亿行，你可能会存储 10 亿个锁，等等。

SQL Server 的设计在这个意义上是有缺陷的，因为你的 RAM 和 HDD 空间可能不平衡。您可能很容易拥有 16M 的 RAM 和几 TB 的磁盘空间。而你的记忆就是无法拥有所有的锁。

这就是为什么当锁计数达到某个限制时，SQL Server 决定升级锁：它不是为数据页中的 10 个单独的行（需要 10 条记录）保持锁，而是锁定整个数据页（这需要1 条记录）。

另一方面，Oracle 在更新行时，只是将锁直接写入数据页。

这就是为什么 Oracle 的锁是行级的。

Oracle 不会以一般意义上的“管理”锁：例如，您无法在 Oracle 中获取锁定页面的列表。

当事务需要更新一行时，它只是去该行并查看它是否被锁定。

如果是，它会查看哪个事务持有锁（此信息包含在数据页的锁描述符中）并将自身添加到该事务的通知队列中：当锁定事务终止时，原始事务会收到通知并锁定数据。

从并发的角度来看，锁升级完全是穷人的解决方案：它不会增加并发。比如说，你可以锁定你甚至没有碰过的行。

从性能的角度来看，在内存中做事当然比在磁盘上做事要快。

但是由于 Oracle 缓存了数据块，并且上述实际操作无论如何都是在内存中执行的，因此性能是相同或接近的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T16:47:21.317

如果 SQL Server 优化器估计/决定查询将“访问”某个范围内的所有行，那么在该范围内持有单个锁而不是必须协商许多锁（必须针对锁进行测试类型）。这是除了消耗更少的锁资源（系统范围的资源）之外的。

如果您有一个设计良好的模式和适合您的查询工作负载的索引，这些索引会定期维护，那么您不必担心正在发生的升级。在许多情况下，可以通过适当的覆盖索引来消除阻塞表锁。

更新：查询的覆盖索引意味着不需要执行对集群的查找，这减少了阻塞插入表的机会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T16:23:10.547

锁开销意味着管理一个表锁比管理大量行锁更明智。因为每个锁都占用一些内存，所以很多行锁比一个表锁消耗更多的内存。所以锁升级从行->页->表锁开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T16:54:57.663

“高效”的定义很复杂。有时，如果许多进程可以在没有冲突的情况下进行并发优化，那么优化并发性会更有效。有时，通过临时并发攻击来更快地完成单个进程会更有效。升级的锁将阻止其他进程，因此该进程可以完成其工作并让路。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T18:14:18.643

有关如何维护锁的具体信息，您可以查看 Microsoft SQL Server 2005: The Storage Engine 的第 8 章（我不隶属于此，这只是我遇到的第一个内部信息）。如果您有一个 books24x7 帐户，它就在那里。它显示在大于 16gb 内存的机器上，锁哈希表中有 2^25 (33554432) 个插槽，上限为 2^31 个插槽。

对于给定的应用程序，您可能会发现仅使用细粒度锁的总吞吐量会更高。正如您可能猜到的那样，这完全取决于锁管理的开销与潜在的过度锁定相比如何。

# python - 有人知道如何使用 Ruby 或 Python 在屏幕上显示内容（覆盖任何窗口）吗？

> ID：872737
> 
> 赞同：1
> 
> 时间：2009-05-16T16:19:40.790
> 
> 标签：python, ruby, user-interface

使用 Ruby 或 Python，有人知道如何在屏幕上绘图，覆盖任何其他窗口吗？有点像，按一个键，程序会在屏幕上显示当前的天气或股票行情（以整个屏幕为画布），然后再按一次键，一切都恢复如初？（如 Mac OS X 的仪表板）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T16:28:43.063

您可以使用系统仪表板（桌面小部件或其他任何名称）API。为此，您需要为 Python 或 Ruby 绑定它。或者，您可以使用一些通用的 gui 工具包或应用程序框架，只需创建一个具有透明背景的无框窗口。然后，您需要确保所选工具包支持您所需平台上的“始终在顶部”选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T04:34:05.553

如果您在 Windows 上，您可以使用 win32api 直接绘制到桌面 dc（设备上下文），例如只是为了好玩试试这个 :)

```
>>> import win32ui
>>> import win32gui
>>> hdc = win32ui.CreateDCFromHandle( win32gui.GetDC( 0 ) )
>>> hdc.DrawText("Wow it works", (100, 100, 200, 200))
>>> hdc.LineTo(500,500) 
```

但这不会很有用，因为不可擦除

最好的办法是使用透明窗口或带有切口区域的窗口（至少在可能的窗口上），或者即使您无法在某些系统上绘制透明，您也可以抓取当前屏幕并将其显示为您窗口的背景会产生透明的效果

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T04:49:44.920

我会推荐 PyGame。

# xml - xmlns:SOAP 元素的soap 属性

> ID：872740
> 
> 赞同：7
> 
> 时间：2009-05-16T16:20:24.843
> 
> 标签：xml, web-services, soap

我刚开始学习网络服务。我不明白 xmlns:soap 属性的 SOAP 元素的使用。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-16T16:33:24.237

那些“xmlns:”属性并不特定于 SOAP。它们定义了稍后将用于引用 XML 名称空间的前缀。例子：

```
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts" 
    DTS:ExecutableType="SSIS.Package.2"> 
```

这将 DTS 定义为前缀，表示命名空间“www.microsoft.com/SqlServer/Dts”。然后它引用该命名空间中的 ExecutableType 属性。

XML 命名空间的作用与 C# 或 C++ 中的命名空间相同。它们提供了一个空间来定义名称，以便一个名称空间中的名称不会与另一个名称空间中的名称冲突。您可以定义自己的“ExecutableType”属性，它的含义可能与 Microsoft 定义的完全不同。两者都可以在同一个文档中使用，没有歧义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T12:27:16.417

根据您的问题级别（请不要冒犯），听起来您对 XML 以及基于 XML 的 Web 服务很陌生。John Saunders 正确地描述了 XML 名称空间及其用途。如果您希望更好地理解 XML 和基于 XML 的 Web 服务，我建议您从 W3 Schools 的 XML 教程（特别是关于 XML 名称空间的部分）开始。

教程位于：[http ://www.w3schools.com/xml/default.asp](http://www.w3schools.com/xml/default.asp)

关于 XML 命名空间的部分位于：[http ://www.w3schools.com/xml/xml_namespaces.asp](http://www.w3schools.com/xml/xml_namespaces.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T16:36:14.837

[**W3C SOAP 规范**](http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383497)中的这句话在这里也应该有所帮助：

> SOAP 应用程序应该在它生成的消息中包含由 SOAP 定义的所有元素和属性上的正确 SOAP 名称空间。SOAP 应用程序必须能够处理它接收到的消息中的 SOAP 名称空间。它必须丢弃具有不正确名称空间的消息（参见第 4.4 节），并且它可以处理没有 SOAP 名称空间的 SOAP 消息，就好像它们具有正确的 SOAP 名称空间一样。
> 
> SOAP 定义了两个名称空间（有关 XML 名称空间的更多信息，请参阅 [8]）：
> 
> • SOAP 信封具有名称空间标识符“ [http://schemas.xmlsoap.org/soap/envelope/](http://schemas.xmlsoap.org/soap/envelope/) ”
> 
> • SOAP 序列化具有命名空间标识符“ [http://schemas.xmlsoap.org/soap/encoding/](http://schemas.xmlsoap.org/soap/encoding/) ”
> 
> SOAP 消息不能包含文档类型声明。SOAP 消息不得包含处理指令。[7]

# .net - 使用 Powershell 从 IE 保存网页

> ID：872750
> 
> 赞同：4
> 
> 时间：2009-05-16T16:24:23.243
> 
> 标签：.net, internet-explorer, powershell, automation

我使用来自 Powershell 的 Internet Explorer 的自动化界面以支持的格式打开网页。我想以 IE 支持的一种格式将此页面保存回磁盘。打开页面很简单：

```
$ie = New-Object -ComObject "InternetExplorer.Application"
$ie.Navigate("C:\MyFile.mht") 
```

如何以另一种格式保存它？

我需要一个不提示用户的解决方案，因为我的想法是在通过多个文件运行的脚本中自动执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T05:02:31.177

[您想使用适当的 args 调用 ExecWB](http://msdn.microsoft.com/en-us/library/aa752117(VS.85).aspx)：

```
$ie.ExecWB(4,0,$null,[ref]$null) 
```

4个参数的解释：

```
4 = OLECMDID_SAVEAS
0 = OLECMDEXECOPT_DODEFAULT (This can also be 2 = OLECMDEXECOPT_DONTPROMPTUSER to not prompt and just save)
$null = NULL (I think this can be a path to save to: separate folders with 2 slashes (\\))
[ref]$null = ref NULL :) 
```

# asp.net-mvc - 在 ASP.NET MVC 中处理回发的选项

> ID：872753
> 
> 赞同：1
> 
> 时间：2009-05-16T16:24:46.240
> 
> 标签：asp.net-mvc

目前我在[ASP.NET MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)中处理回发的方式是使用以下方法获取输入变量：

```
string username = "";

if (null != Request["username"])
     username = Request["username"].ToString(); 
```

然后我会在变量上运行一个正则表达式以确保它是有效的。

有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T16:32:10.167

[ASP.NET MVC通过](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)[ModelBinders](http://weblogs.asp.net/melvynharbour/archive/2008/08/29/how-to-use-the-asp-net-mvc-modelbinder.aspx)自动执行 Request-To-Object 映射。一篇较旧的[文章在这里](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx)，在“表单发布和模型活页夹改进”下，这里有[一个视频](http://www.microsoft.com/belux/msdn/nl/chopsticks/default.aspx?id=798)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T16:35:45.447

您可以通过以下方式处理 Action 中的表单输入：

```
public ActionResult Create(string username)
{
  // use
} 
```

但你需要设置你的路线：

```
routes.MapRoute(
                "Default",                                              // Route name
                "Create/{username}",                           // URL with parameters
                new { controller = "YourController", action = "Create", username = "" }  // Parameter defaults
            ); 
```

或者你可以使用[ModelBinders](http://msdn.microsoft.com/en-us/library/dd410405.aspx)

# zsh - 无法将 pwd 与 Zsh 中的文件名结合使用

> ID：872765
> 
> 赞同：2
> 
> 时间：2009-05-16T16:31:51.963
> 
> 标签：zsh, filenames

**问题：**将 PATH 与文件名结合起来，这样我就可以轻松地获取许多文件。

我有两个文件 A 和 B。`ls`清楚地给出了它们的名称。

我跑

```
pwd `ls` 
```

我收到错误消息

```
too many arguments 
```

我没有找到 pwd 的选项，它可以让我有多个论点。

如何将 pwd 的输出与文件名结合起来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T16:39:34.953

```
echo $PWD/* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-21T20:25:16.363

除了 sigjuice 的答案，如果如您所说，您需要它来获取许多文件，只需使用

```
source ./* 
```

它可能会消耗更少的 CPU 周期，因为 shell 不必为每个文件创建绝对路径名。

# sql-server - 从 Oracle 查询 SQL Server - 强制元数据刷新

> ID：872770
> 
> 赞同：0
> 
> 时间：2009-05-16T16:35:17.913
> 
> 标签：sql-server, oracle, dblink

我是一名 SQL Server 开发人员，在 Oracle 中有一个任务。DBA 在 Oracle 中设置了指向 SQL Server 数据库的 DBLink。我正在编写一个关于 SQL Server 数据的视图，然后在 Oracle 端编写一个视图以将其与其他 Oracle 数据连接起来。

问题：如果我在 SQL Server 上更改视图的定义，甚至“Select * From myview@dblink”也会出现“列无效”的错误。关闭 TOAD 并重新打开似乎可以解决问题，但真正的问题是如何强制 Oracle 在不重置连接的情况下重新读取元数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T01:38:25.720

这听起来像是 TOAD 的问题，而不是 oracle 的问题。如果您在 SQL*Plus 中执行此操作会发生什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-02T05:20:04.183

我不知道我是否理解你，但如果你有一个`dblink`指向你的 Oracle DB 中的 SQL Server DB 并且你需要 SQL Server 中的数据，只需执行以下操作：

```
SELECT *
FROM TABLE@dblink

SELECT "COL", "COL2", "COL3
from TABLE@dblink

SELECT T."COL", H."COL"
FROM TABLE1@dblink T, TABLE2@dblink H
WHERE T."ID" = H."ID" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T18:37:45.513

也许你可以做？：

```
alter view <<view_name>> compile; 
```

我没有对此进行测试，因为我没有从 Oracle 到 MSSQL 的数据库链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T14:53:55.530

这似乎是 Oracle 10g 客户端的问题。当前的解决方案是断开并重新连接。鉴于我无法找到其他人遇到此问题，我将假设这是我的客户端配置的问题。

# winapi - 如何限制进程的资源使用？

> ID：872773
> 
> 赞同：4
> 
> 时间：2009-05-16T16:37:56.457
> 
> 标签：winapi, memory, time, resources

简而言之，我想找到与 Windows 等效的 unix setrusage() 函数方式。

我可以限制特定进程的资源使用吗？例如，10 秒 cpu 时间和 50mb 内存大小。如果进程运行超过 10 秒或消耗超过 50mb 内存，则该进程将被 windows 终止。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T16:43:57.970

尝试工作对象！它们甚至适用于进程组和衍生进程。我认为您可以使用它们来完成所有这些限制

这是更多信息 [http://msdn.microsoft.com/en-us/library/ms684161.aspx](http://msdn.microsoft.com/en-us/library/ms684161.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T16:48:11.503

查看[SetInformationJobObject](http://msdn.microsoft.com/en-us/library/ms686216.aspx)的文档。

# haskell - Haskell 中的 elemIndices

> ID：872782
> 
> 赞同：1
> 
> 时间：2009-05-16T16:44:42.587
> 
> 标签：haskell

我编写了获取元素索引的代码

```
elemIndex :: [String] -> [String] -> [Int]
elemIndex [] [] = []
elemIndex x y = elemIndex True [(elem a y) | a <- x ] 
```

有没有其他方法/类似的方法来执行上述逻辑？

而且我也看到了一些使用

```
index [] _ = [] 
```

返回空列表

你能解释一下下划线的用法吗？

//edit 1 它应该返回列表中值的索引。

例如：elemIndex ["asde","zxc","qwe"] ["qwe","zxc"]

返回 [1,2] 作为答案

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T17:33:47.040

`elemIndex`接受两个参数（两个列表）。现在，您使用 bool 类型的附加参数（即`True`）递归调用它。这是行不通的。正如我在一小时前[向您展示](https://stackoverflow.com/questions/872631/syntax-in-expression-haskell)的那样，您可能想要做的是创建一个辅助函数。

`_`用作正式参数时，匹配任何输入。它没有名称，因此，您不能使用匹配的名称。

除此之外，您可能不想使用布尔值，而是使用整数（以跟踪计数器）。该`elem`函数只告诉你某个值*是否是列表的一部分，而不是它**在哪里*。所以，它对你用处不大。由于这似乎是家庭作业，我不会为您的问题提供解决方案，但也许您应该将代码分成两部分：

```
indices :: (Eq t) => [t] -> [t] -> [Integer]
getIndex :: (Eq t) => [t] -> t -> Integer 
```

（`getIndex`可以使用辅助函数`getIndex' :: (Eq t) => [t] -> t -> Integer -> Integer`。）

* * *

**编辑**：一种可能的解决方案（使用 hack，使用`Maybe`monad 更好）：

```
indices :: (Eq t) => [t] -> [t] -> [Integer]
indices xs ys = filter (>= 0) $ map (getIndex xs) ys

getIndex :: (Eq t) => [t] -> t -> Integer
getIndex xs y = getIndex' xs y 0
  where
    getIndex' :: (Eq t) => [t] -> t -> Integer -> Integer
    getIndex' [] _ _                 = -1
    getIndex' (x:xs) y i | x == y    = i
                         | otherwise = getIndex' xs y (i + 1) 
```

带有`Maybe`单子的版本：

```
import Data.Maybe

indices :: (Eq t) => [t] -> [t] -> [Integer]
indices xs ys = mapMaybe (getIndex xs) ys

getIndex :: (Eq t) => [t] -> t -> Maybe Integer
getIndex xs y = getIndex' xs y 0
  where
    getIndex' :: (Eq t) => [t] -> t -> Integer -> Maybe Integer
    getIndex' [] _ _                 = Nothing
    getIndex' (x:xs) y i | x == y    = Just i
                         | otherwise = getIndex' xs y (i + 1) 
```

还有一个版本将所有繁重的工作留给标准库：

```
import Data.List
import Data.Maybe

indices :: (Eq t) => [t] -> [t] -> [Int]
indices xs ys = mapMaybe (`elemIndex` xs) ys 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T16:55:25.667

```
index [] _ = [] 
```

是相同的

```
index [] x = [] 
```

除非你不能使用`_`等号右边的。

我不明白你想做`elemIndex`什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T17:38:19.383

我会这样实现你的功能：

```
elemIndices acc n []  _ = acc
elemIndices acc n  _ [] = acc
elemIndices acc n (x:x') (y:y') = if x == y then 
                                      elemIndices (n:acc) (n+1) x' y'
                                  else
                                      elemIndices acc (n+1) x' (y:y')

elemIndex x y = reverse $ elemIndices [] 1 x y 
```

当源列表中的元素与您查找的元素的顺序相同时，这会更有效（不使用`elem`- 尾递归）。前任：

```
elemIndex [3..7] [4, 6] -- Yields [2, 4] 
```

# visual-studio-2008 - SQL Server Express 2005 有哪些免费的管理工具可用？

> ID：872790
> 
> 赞同：1
> 
> 时间：2009-05-16T16:49:23.793
> 
> 标签：visual-studio-2008, sql-server-express

我正在 Visual Studio 2008（新）中进行开发，拥有一个 Enterprise Manager / SQL Server Development Studio 之类的工具来管理数据库会很方便。我想知道其他无法访问 SSDS 的开发人员正在使用什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T16:52:21.400

[Microsoft SQL Server Management Studio Express](http://www.microsoft.com/downloads/details.aspx?familyid=08E52AC2-1D62-45F6-9A4A-4B76A8564A2B&displaylang=en)

文档在[这里](http://msdn.microsoft.com/en-us/library/ms365247.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T16:52:42.397

有一个 Management Studio Express 可用： [http ://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en)

完成完整版所做的大多数事情。但我相信，您可以使用完整的工具包获得更便宜的 SQL Server for Development 版本。我买了一个 2000 的，花了我 30 英镑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T16:52:50.337

[SQL Management Studio Express](http://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796 "SQL Management Studio Express")

# com - 谁拥有返回的 BSTR？

> ID：872794
> 
> 赞同：7
> 
> 时间：2009-05-16T16:51:40.713
> 
> 标签：com, bstr

假设来自 COM 接口的方法返回 BSTR 值。我认为我必须释放它是对的吗？

代码示例位于[http://msdn.microsoft.com/en-us/library/aa365382(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365382(VS.85).aspx)不这样做。

谁错了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-16T16:54:45.527

MSDN 示例是错误的。调用者释放和输入/输出 bstrs。如果它是输入/输出，则必须传入 null 或有效的 bstr。如果它只是出来的，它不必被初始化。

从 msdn 的[com 分配规则](http://msdn.microsoft.com/en-us/library/aa378697(VS.85).aspx)中不是很清楚，但是客户端存根在 out 值上分配内存，所以从调用者的角度来看，服务器这样做了。除了调用者，还有谁可以释放它？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-16T17:02:36.677

托尼是正确的，但我想扩展他的答案。这种情况不仅限于 BSTR。调用者负责释放通过 out 或 in/out 参数返回的任何内存。

# php - Wordpress 中的东方阿拉伯数字

> ID：872795
> 
> 赞同：1
> 
> 时间：2009-05-16T16:52:09.650
> 
> 标签：php, wordpress, blogs, arabic

**任何想法如何配置 Wordpress 以获取东方阿拉伯数字的日期和页码？**

这些是 UTF-8 中的 0660 到 0669。我说的是让那些数字**٠١٢٣٤٥٦٧٨٩**替换那些**0123456789**。我正在使用 Wordpress 2.7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-03T21:20:49.363

建议你不要换...

保持正常数字 0x40 到 0x49 允许搜索引擎搜索数字。喜欢其他数字系统的阿拉伯人会在他们的操作系统中设置它，他们会将 0123456789 视为 ٠١٢٣٤٥٦٧٨٩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T23:35:09.460

如果其他人正在搜索，您可以使用

```
<?php echo date_i18n(get_option('date_format')); ?> 
```

[http://codex.wordpress.org/Function_Reference/date_i18n](http://codex.wordpress.org/Function_Reference/date_i18n)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T17:33:50.113

،السلام عليكم

使用任何默认的 wordpress 工具都无法做到这一点。“[样式化页面链接](http://codex.wordpress.org/Styling_Page-Links "样式化页面链接")”文档仅提供有限的页码自定义。

所以你有几个选择。

1.  编辑wp-includes/post-template.php 中的*wp_link_pages()*
    但这非常hackish，并且在升级时会引起问题。
2.  编写一个完全绕过*wp_link_pages()*的小插件，可能通过编辑[现有的（WP 页码）](http://wordpress.org/extend/plugins/wp-page-numbers/ "WP页码")插件。
    这具有可维护和可移植的好处（您可以分发插件）。

在这两种情况下，您都必须进行一些映射：{ {0،٠}, {1,١}, {2, ٢} ....}，并在页码计算后进行字符串替换。

*另外，*我查看了[阿拉伯语 WP 翻译](http://arabic.wordpress.net/ "WP 阿拉伯语")，但它使用传统数字，这看起来很愚蠢。

حظ سعيد يابشا

# c# - Asp.net mvc - 从自定义操作过滤器访问视图模型

> ID：872796
> 
> 赞同：43
> 
> 时间：2009-05-16T16:52:11.057
> 
> 标签：c#, asp.net-mvc, custom-action-filter

我正在尝试访问传递给操作过滤器 OnActionExecuted 中的视图的模型数据。有谁知道这是否可能？

我正在尝试做这样的事情：

```
public override void OnActionExecuted(ActionExecutedContext filterContext)
{
    //get model data
    //...

    sitemap.SetCurrentNode(model.Name);
} 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-05-16T16:56:01.420

该模型位于：

```
filterContext.Controller.ViewData.Model 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-08-11T18:32:35.127

我不知道为什么，但`filterContext.Controller.ViewData.Model`即使模型绑定之前执行，它也始终为空`OnActionExecuted`。我之前找到了使用`OnModelUpdated`事件设置该属性的解决方案。

我有模型活页夹：

```
public class CustomModelBinder: DefaultModelBinder
{
    protected override void OnModelUpdated(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        controllerContext.Controller.ViewData.Model = bindingContext.Model;
        base.OnModelUpdated(controllerContext, bindingContext);
    }
} 
```

之后，您需要`Application_Start()`在 Global.asax 部分中将默认绑定器设置为新模型绑定器：

```
ModelBinders.Binders.DefaultBinder = new CustomModelBinder(); 
```

最后你可以访问你`Model`的`ActionFilterAttribute`：

```
public class TraceLog : ActionFilterAttribute
{
    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        //filterContext.Controller.ViewData.Model now isn't null
        base.OnActionExecuted(filterContext);
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-02-05T10:59:43.993

在方法的最后一行`base.OnActionExecuted()`调用为我解决了“模型为空”的问题。

（这是对@Steven Lyons 答案的评论，但我将其作为答案发布，因为我无法发表评论。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-01-12T00:08:39.053

在 .Net Core 中，您在上下文中有一个 ActionArguments IDictionary，其中包含方法中的所有参数

所以如果你有以下控制器方法

```
 [HttpPost]
    public void Post([FromBody]BaseRequest request)
    {
    } 
```

您可以像这样访问该字段

```
 public override void OnActionExecuting(ActionExecutingContext context)
    {
      var request = context.ActionArguments["request"] as BaseRequest;`
      //do whatever, 
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-17T13:53:39.833

如果您得到 null - 作为@Gustavo Clemente 的答案的替代方案，您可以尝试`OnActionExecuted`通过以下方式覆盖您的 viewModel 并将其传递给视图：

**行动：**

```
[Breadcrumb("Index")]
public ActionResult UnitIndex()
{
    View(new Answers());
} 
```

**属性：**

```
public class BreadcrumbAttribute : ActionFilterAttribute
{
    public string Page { get; set; }

    public BreadcrumbAttribute(string page)
    {
        Page = page;
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        var model = (IBreadcrumbs)filterContext.Controller.ViewData.Model;
        model.Breadcrumbs = BreadcrumbHelper.GetBreadCrumbs(string.Format("{0}", filterContext.RouteData.DataTokens["area"]), Page);
    }
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/OEC9Z.png)](https://i.stack.imgur.com/OEC9Z.png)

# c# - 跨线程操作错误

> ID：872800
> 
> 赞同：0
> 
> 时间：2009-05-16T16:52:58.120
> 
> 标签：c#, multithreading

```
 if (listBox1.InvokeRequired)
       {
           listBox = new StringBuilder(this.listBox1.Text);
       } 
```

这是 c# 中的代码，执行时会为我的表单中的列表框 listBox1 产生无效的跨线程操作错误。你们能告诉我为什么吗？我也在使用 invokeRequired 方法，也没有更改列表框的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T17:01:23.280

InvokeRequired 仅告诉您 Invoke 是有效访问元素所必需的。它不会使访问合法。您必须使用 invoke 方法将更新推送到适当的线程

```
Action update = () => listbox = new StringBuilder(this.listBox1.Text);
if (listBox1.InvokeRequired) {
  listBox1.Invoke(update);
} else {
  update();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T16:56:54.197

InvokeRequired 只是检查是否需要 Invoke。您发现它是必需的，但没有调用 Invoke！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T17:02:51.590

当 InvokeRequired 为 false 时，您的代码应该运行

```
delegate void SetListBoxDelegate(); 

void SetListBox()
{
    if(!InvokeRequired)
    {
        listBox = new StringBuilder(this.listBox1.Text);
    } 
    else 
        Invoke(new SetListBoxDelegate(SetListBox)); 
} 
```

编辑：查看[使 Windows 窗体线程安全](http://www.codeproject.com/KB/cs/threadsafeforms.aspx)

# iphone - 做了一些动画和变换后，如何将图层变换重置为原始状态？

> ID：872803
> 
> 赞同：9
> 
> 时间：2009-05-16T16:54:51.003
> 
> 标签：iphone, cocoa-touch, uikit

我有一个随机旋转几次然后消失的图像。再次出现后，我希望它处于原始状态。不旋转。我会跟踪我随机应用了多少次旋转，然后计算我必须重新执行多少弧度。但我从大文档中稍微记得有一些身份转换的事情。这就是我要找的吗？只是想在我花了一整天的时间找到它然后知道这不是正确的事情之前问一下；）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-16T17:26:30.553

在代码中，它看起来像：

```
yourView.transform = CGAffineTransformIdentity; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T16:58:06.533

是的，您想将变换矩阵设置为恒等变换；这将具有“重置”转换的效果。

# wpf - 帮助一些非常基本的 WPF 数据绑定

> ID：872811
> 
> 赞同：2
> 
> 时间：2009-05-16T16:57:27.953
> 
> 标签：wpf, data-binding, xaml

我是 WPF 新手并尝试了一个简单的数据绑定示例，但它不起作用。我的窗口有一个 TextBlock，我将它绑定到窗口对象的一个​​属性。我在代码中声明了该属性。

运行它时，我看到 TextBlock 中出现了正确的值。还有一个按钮，单击该按钮会更新属性，但我看不到这会影响 TextBlock。

据我所知，我正确地实现了 INotifyPropertyChanged。我还看到，在调试时，*有些东西*订阅了 PropertyChanged 事件，但它似乎没有做任何事情。

我有两个问题：

1）为什么这没有按预期工作？

2）是否有任何简单的方法可以在运行时调试导致这种情况的原因，而无需借助第三方工具？根据我粗略的了解，在我看来，WPF 中的调试支持非常缺乏。

XAML 是（不包括“标准”XAML 窗口元素）：

```
<TextBlock Height="28" Name="label1" VerticalAlignment="Top"
       Text="{Binding Path=TheName}"
       Grid.Row="0"
       ></TextBlock>
<Button Height="23" Name="button1" VerticalAlignment="Stretch" Grid.Row="1"
Click="button1_Click">
    Button
</Button> 
```

窗口类中的代码是：

```
 public partial class Window1 : Window
    {
        protected MyDataSource TheSource { get; set; }

        public Window1()
        {
            InitializeComponent();
            TheSource = new MyDataSource();
            TheSource.TheName = "Original";  // This works
            this.label1.DataContext = this.TheSource;
        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {
            TheSource.TheName = "Changed";  // This doesn't work
        }
    }
    public class MyDataSource : INotifyPropertyChanged
    {
        string thename;
        public string TheName 
        {
            get { return thename; }
            set { thename = value; OnPropertyChanged(thename); }
        }
        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged(string name)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null)
            {
                handler(this, new PropertyChangedEventArgs(name));
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T22:17:02.880

问题出在您的“TheName”属性设置器中。OnPropertyChanged 方法调用传递的是“名称”的*值*，而不是“名称”的“名称”。（对不起，如果这没有意义 - 示例中使用的变量名与我们合谋！）

正确的代码是：

```
string thename;
public string TheName 
{
  get { return thename; }
  set { thename = value; OnPropertyChanged("TheName"); }
} 
```

[这是来自](http://msdn.microsoft.com/en-us/library/ms229614.aspx)[MSDN](http://msdn.microsoft.com/en-us/library/ms229614.aspx)的示例。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T05:26:38.527

来自[Bea Stollnitz](http://bea.stollnitz.com/blog/?p=52)的博客，这里有一些调试 WPF 绑定的方法。

*   检查输出窗口，因为 WPF 在那里记录了很多错误

*   您可以将 Trace 源添加到您的 app.config。[Mike Hillberg 博客](http://blogs.msdn.com/mikehillberg/archive/2006/09/14/WpfTraceSources.aspx)上的详细信息

*   将跟踪级别添加到绑定（这是我最喜欢的）。添加命名空间`xmlns:diagnostics="clr-namespace:System.Diagnostics;assembly=WindowsBase"`
    并在您的绑定中添加跟踪级别
    `<TextBlock Text="{Binding Path=TheName, diagnostics:PresentationTraceSources.TraceLevel=High}" />`

*   将转换器添加到您的绑定中，然后在转换器中放置一个断点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T03:36:11.003

好的，谢谢，我在阅读有关 PropertyChangedEventArgs 参数时没有给予足够的关注。依赖字符串作为属性名称似乎是脆弱的设计，但显然其他人也这么认为（来自您链接到的 MSDN 页面上用户评论底部的链接）。

但是，我的第二个问题仍未得到解答：我怎样才能调试它并找出我做错了什么？

例如，WPF 不会以某种形式记录其操作吗？它应该注意到我在这个对象上没有一个名为“Changed”的属性，为什么它不引发异常或至少向调试控制台写入一些东西？

# css - 如何在 IE 6 中使用 jQuery UI 选项卡

> ID：872816
> 
> 赞同：0
> 
> 时间：2009-05-16T17:02:10.033
> 
> 标签：css, jquery-ui, tabs

我对 CSS 不是很好，但经过大量试验和错误，我制作了这个带有 jQ​​uery UI 选项卡的页面，看起来有点不错：http: [//jsbin.com/uquvi](http://jsbin.com/uquvi)

但是，当我在 IE 6 中打开此页面时，令我失望的是，选项卡似乎没有弯角。

现在在工作中，他们的标签实现非常糟糕，因为他们正在创建带有标签的标签，而且看起来很乱。此外，他们目前正在通过两个 gif 图像来实现弯曲的标签角。我在许多博客中看到了 jQuery UI 选项卡，所以决定使用它，但现在我遇到了问题。

有人可以看看该页面并告诉我如何为 IE 6 更正此问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T17:17:42.587

您正在使用

```
 -moz-border-radius-topleft: 4px;
 -webkit-border-top-left-radius: 4px; 
```

这两个属性都是为 Firefox 和 webkit（Safari 和 Chrome）定制的

如果您想在 IE 中使用圆角，则必须使用背景图像进行处理。

在这篇[Matt Berseth 博客文章中](http://mattberseth.com/blog/2007/11/jquery_tabcontainer_theme_with.html)，您将找到如何执行此操作的示例，但基本上您必须为选项卡分配一个带圆角的背景图像。

[在此链接中执行此操作的另一种方法](http://www.filamentgroup.com/lab/achieving_rounded_corners_in_internet_explorer_for_jquery_ui_with_dd_roundi/)

顺便说一句，您引用的网页的 html 非常混乱，有两个`html, body and head`标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-28T06:38:28.887

如果导航器不支持使用 CSS 进行舍入（如 ie6），则可以使用[corner plugin](http://jquery.malsup.com/corner/)，它尽可能使用 CSS，使用 javascript 进行舍入。

# php - 带有 PHP_OS 常量的系统名称是什么

> ID：872825
> 
> 赞同：9
> 
> 时间：2009-05-16T17:06:15.950
> 
> 标签：php, configuration, phpinfo

我使用 PHP_OS 常量，我想知道它可以在不同的操作系统上返回什么。

我找到了这个 ：

*   在 Linux -> Linux 上
*   在 FreeDSB -> FreeBSD
*   在 Windows NT -> WINNT 上
*   在 Mac OS X -> 达尔文

谁能告诉我他们的配置得到了什么？在 Solaris、Windows XP...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-09T18:31:31.793

仅作记录......我在 Windows XP 上运行，这是返回的内容：

`PHP_OS`：`WINNT`

`php_uname('s')`：`Windows NT`

**更新：**在 Windows 7 上也是如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T17:23:12.807

尝试[使用 php_uname](http://php.net/manual/en/function.php-uname.php)检索操作系统信息

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-16T17:56:13.350

***编辑：****这个答案是指这个问题的旧版本，可能不再相关。*

变体如此之多，以至于对于大多数正常的应用程序来说相对无用；“系统”信息来源于许多关于环境的信息，通常是在编译时。

如果您要检查 PHP 配置的特定功能，最好查询细节；检查配置标志或扩展功能的存在等。

**注意：**您提到`HTTP_USER_AGENT`. 用户代理与系统不同；用户代理是在客户端上运行的软件，它向服务器发出请求——通常是 Web 浏览器。用户代理嗅探通常是处理跨浏览器兼容性问题的宝贵工具。

# iphone - 使 UITextField “出现”的最佳方法

> ID：872827
> 
> 赞同：2
> 
> 时间：2009-05-16T17:09:14.073
> 
> 标签：iphone, cocoa-touch, interface-builder, uitextfield

我希望`UITextField`在按下按钮时出现。不幸的是，我无法在 Interface Builder 中隐藏它，然后将 hidden 属性设置为`NO`稍后，因为如果您尝试隐藏`UITextField`.

我将尝试在代码中执行此操作，但想知道我是否会通过尝试执行此类操作而遗漏某些内容或导致严重的 UI 错误？或者也许它只是一个错误？！？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T22:57:09.900

如果您无法在 IB 中将其设置为隐藏，则可以通过`field.hidden = YES;`viewController 的`viewDidLoad`方法以编程方式进行。然后只需将其设置回`NO`按钮的目标操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T17:16:18.877

很奇怪，但您可以通过编程方式添加它，并用一些不透明动画显示它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T18:39:06.073

或者，只需将其设置`alpha`为 0.0。您甚至可以非常轻松地为更改设置动画，它看起来会非常好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T17:21:27.350

我只是尝试`UITextField`在 IB 中添加一个并选中该`hidden`框，并没有崩溃。当然，我正在运行 3.0 beta SDK，所以它可能是一个在那里修复的错误。不过，无论哪种方式，您都应该能够将其标记为隐藏，然后在代码集中`hidden = NO`。如果没有更多信息，我不确定为什么它对您不起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T22:33:49.907

是的，看起来像一个错误，但一个可能的简单解决方法是简单地将其设为空，即在 中不给它任何字符串值，并在您希望它“出现”时`IB`设置该字符串值（当然是通过）。`NSLocalizedString()`

# c# - 从 ASP .NET Web 应用程序中作为新进程运行时，mysqldump 不起作用

> ID：872828
> 
> 赞同：1
> 
> 时间：2009-05-16T17:14:50.067
> 
> 标签：c#, mysqldump

当从“运行”窗口运行时，它可以正常工作。

```
cmd.exe /K mysqldump --add-drop-database --add-drop-table --user=root --password=thepassword --databases theDatabase > C:\Backup\theBackup.sql 
```

但是，当我尝试通过调用外部进程从我的 Web 应用程序执行时，相同的命令会失败。

这是代码：

```
ProcessStartInfo processInfo = new ProcessStartInfo("cmd.exe", @"/K mysqldump --add-drop-database --add-drop-table --user=root --password=thepassword --databases theDatabase > C:\Backup\theBackup" + ".sql");

Process p = Process.Start(processInfo); 
```

这就是我得到的...

[替代文字 http://img40.imageshack.us/img40/8121/mysqldumperror.gif](http://img40.imageshack.us/img40/8121/mysqldumperror.gif)

有趣的是，文件 - theBackup.sql - 被创建，但是是空的。

这不是环境 PATH 变量问题；将包含 mysqldump 的 MySql bin 目录路径添加到环境 PATH 变量中。要检查这一点，如果我打开命令提示符，导航到上面屏幕截图中提到的路径并手动键入 mysqldump 命令，它会识别命令...如下所示...

[替代文字 http://img40.imageshack.us/img40/6879/mysqldumppathproper.gif](http://img40.imageshack.us/img40/6879/mysqldumppathproper.gif)

问题是 mysqldump 特定的，因为以下代码有效

```
ProcessStartInfo processInfo = new ProcessStartInfo("cmd.exe", "/K ping stackoverflow.com"); 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T17:25:44.500

我的猜测是 $PATH 变量未定义为在运行 ASP.NET 的环境中包含 MySQL 的路径（对于该用户，或者 ASP.NET 清除环境）。

有两件事要尝试：

1.  （可能有效）确保将 mysql 目录添加到*全局*路径——而不仅仅是用户特定的 PATH 变量。（注意：这至少需要回收 IIS，可能需要重新启动才能生效）
2.  使用 mysqldump 的完全限定路径（您需要做一些事情来引用或转义路径中的任何空格）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-07T21:47:09.970

mysqldump 的一个例子

```
Private sw As IO.StreamWriter

Public Sub ExecuteBackup()
    Try

        Dim mysqlDump As New Process
        mysqlDump.StartInfo.FileName = "PahtToMysqlDump\mysqldump.exe"
        mysqlDump.StartInfo.Arguments = "--user=myuser --password=mypassword --routines --all-databases"
        mysqlDump.StartInfo.RedirectStandardOutput = True
        mysqlDump.StartInfo.CreateNoWindow = True
        mysqlDump.StartInfo.UseShellExecute = False

        Console.WriteLine("Arguments:")
        Console.WriteLine("mysqldump.exe " & mysqlDump.StartInfo.Arguments)

        sw = New IO.StreamWriter("backup.sql")

        AddHandler mysqlDump.OutputDataReceived, AddressOf mysqlDumpNewData

        mysqlDump.Start()
        mysqlDump.BeginOutputReadLine()
        mysqlDump.WaitForExit()

        sw.Close()

        Console.WriteLine("Backup completed")

    Catch ex As Exception   
        Console.WriteLine("BackupEngine.ExecuteBackup.", ex)        
    End Try
End Sub

Private Sub mysqlDumpNewData(sender As Object, e As DataReceivedEventArgs)

    Dim line = e.Data
    If line IsNot Nothing Then
        sw.WriteLine(line)
        If line.StartsWith("USE") Then
            Dim ln = line.Split("`")(1)
            Console.WriteLine("Database : " & ln.ToUpper)
        End If
        If line.StartsWith("CREATE TABLE") Then
            Dim ln = line.Split("`")(1)
            Console.WriteLine(" Table : " & ln.ToUpper)
        End If
    End If

End Sub 
```

# ruby-on-rails - 如何将 ActiveResource 与自定义 URL 方案一起使用？

> ID：872831
> 
> 赞同：1
> 
> 时间：2009-05-16T17:16:34.367
> 
> 标签：ruby-on-rails, ruby, activerecord, rest, activeresource

我正在尝试为`ActiveResource`内部应用程序中的三个对象创建对象。

有`Tag`s、`Tagging`s 和`Taggable`s：

```
http://tagservice/tags/:tag
http://tagservice/taggings/:id
http://tagservice/taggables/:type/:key 
```

`Tag`'s`:tag`是 URL 编码的文字标记文本。 `Tagging`'s`:id`是一个自动递增的整数。 `Taggable`'s`:type`是一个字符串。没有有限的可标记类型集——该服务可以支持标记任何东西。 `Taggable`'s`:key`是该`Taggable`类型的服务分配的 ID 字段。它可以是业务价值，例如员工的用户名，或者只是一个自动递增的整数。

如果这些是`ActiveRecord`对象，我会将它们编码为：

```
class Tag < ActiveRecord::Base
  has_many :taggings
  has_many :taggables, :through => :taggings
  def self.find_by_id(id)
    find_by_name(id)
  end
  def to_param
    CGI::escape(self.name)
  end
end

class Tagging < ActiveRecord::Base
  belongs_to :tag
  belongs_to :taggable
end

class Taggable < ActiveRecord::Base
  has_many :taggings
  has_mnay :tags, :through => :taggings
  def self.find_by_id(id)
    find_by_type_and_key(*id.split('/'))
  end
  def to_param
    "#{self.type}/#{self.key}"
  end
end 
```

有谁知道这些课程想要什么`ActiveResource`？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-31T10:28:10.823

你在使用 Rails 3.0 吗？如果是这样的话，那么你现在几乎可以在 ActiveResource 中做同样的事情了。

如果没有，请考虑尝试超活跃资源：http: [//github.com/taryneast/hyperactiveresource](http://github.com/taryneast/hyperactiveresource)

我扩展它以使 ActiveResource 的工作方式与 Active Record 几乎相同。它支持关联，就像 AR 一样 - 虽然它不支持“通过” - 你可能必须手动编码，例如对于 has_many :foos, :through => :bars 你会做的 Baz：

```
# ugly, but does the job
def foos
  return [] unless bars.present?
  foo_set = []
  self.bars.each {|b| foo_set += b.foos }
  foo_set
end 
```

# flash - 从类访问 ActionScript3 嵌套影片剪辑

> ID：872832
> 
> 赞同：1
> 
> 时间：2009-05-16T17:16:58.530
> 
> 标签：flash, actionscript-3

我正在尝试在 Flash CS3 中编写一个非常简单/最小的自定义视频播放器

我的库、Player 和 PlayButton 中有一个带有 2 个 MovieClip 的 .fla 文件。PlayButton 影片剪辑位于 Player 影片剪辑内的第一帧。Player 被导出到 actionscript 并链接到动态创建视频对象的 Player.as 类。

我的文档类是 MPlayer.as，它在舞台上添加了一个 Player 实例。这很好用，视频会自动播放。但是，我的库项目 Player 中的 PlayButton 影片剪辑没有显示……我不知道如何访问它或让它显示。它与视频不在同一个位置，所以它不应该在它下面...我尝试了 Player.as 中的 addChild(playbutton_instance_name) 但我得到了错误。Player 影片剪辑是为动作脚本导出的，但 PlayButton 影片剪辑不是因为它在 Player 中。

我设置正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T19:36:10.460

听起来差不多。如果它在您的 Player MovieClip 中，它将在其中导出。你确定它在播放器剪辑中吗？您可以像访问 Player.as 类的变量一样访问它，即如果 PlayButton 的实例名称为“playBtn”，您可以（在构造函数中）尝试

```
public function Play()
{
    trace(this.playBtn);
} 
```

如果剪辑在类中正确，它应该跟踪类似 [PlayButton] 的内容。如果您愿意，请将您的代码发布在您的问题中，或者如果您愿意，我可以查看您的文件。

# jquery - jquery 切换隐藏显示问题

> ID：872833
> 
> 赞同：0
> 
> 时间：2009-05-16T17:17:13.523
> 
> 标签：jquery, toggle

缩短此时间的最有效方法是什么？

```
$('.img').click(function(e) {
    if ($(this).attr('id') == 'myid') {
        $('#a').hide();
        $('#b').show();
    } else {
        $('#a').show();
        $('#b').hide();
    }
}); 
```

如果添加了另一个选项，您的答案是否会发生任何变化`else if`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T20:16:10.207

```
$('#myid').click(function() {
        $('#a,#b').toggle();
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T17:28:05.697

我将假设您尝试将所有元素与名为“img”的类匹配。

```
$(".img[id='myid']").click(function() {
        $('#a,#b').toggle();
}); 
```

允许多个 ID

```
$(".img[id='myid'], .img[id='myid2']").click(function() {
        $('#a,#b').toggle();
}); 
```

您还可以检查 id 上的不等于

```
$(".img[id!='someid']").click(function() {
        $('#a,#b').toggle();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T17:22:29.360

为什么要检查 click 事件中的元素 id？如果您只希望此特定元素处理此事件，则选择它并将事件处理程序绑定到它。

假设在任何时候都有 #a 或 #b 显示：

```
$('#myid').click(function(){
    $('#a').toggle();
    $('#b').toggle();
}) 
```

# iphone - 如何识别对 UIScrollView 内的 UIImageView 子类的点击？

> ID：872836
> 
> 赞同：0
> 
> 时间：2009-05-16T17:18:18.153
> 
> 标签：iphone, cocoa-touch, uikit

我在我的 UIScrollView 子类中使用此代码进行了尝试：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    NSLog(@"he/she touched me");
} 
```

我还确保在我的视图的初始化中，它被调用：

```
self.userInteractionEnabled = YES; 
```

但是当滚动视图不移动并且我点击我的子视图几次时，什么也没有发生。没有日志消息。我知道如果用户想要滚动 UIScrollView 实际上会等待片刻，但在某些时候它应该放弃等待并将事件触发到子视图，对吧？

有什么重要的事情我可能会错过吗？

编辑：**如果您有同样的问题，请阅读下面的答案！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T17:24:24.910

我认为其他人可能对这个问题感兴趣，而不是删除我的问题。所以，解决方案很简单：我只是忘了设置

```
anSuperview.userInteractionEnabled = YES; 
```

因此，如果必须接收触摸事件的视图嵌套在任何其他视图中，则它的所有子视图都必须设置为 userInteractionEnabled = YES;

# asp.net-mvc - 将视图呈现为字符串然后重定向

> ID：872837
> 
> 赞同：1
> 
> 时间：2009-05-16T17:20:00.020
> 
> 标签：asp.net-mvc

在我的 ASP.NET MVC 应用程序中，我希望我的控制器操作将视图呈现为字符串，使用该字符串作为正文发送电子邮件，然后进行重定向。

我在 SO 和其他地方找到了几篇关于如何将视图呈现为字符串的文章。那部分很容易。

但是当我尝试执行重定向时，我得到一个 HttpException: Cannot redirect after HTTP headers have been sent。我尝试将 Response.Buffer 和 Response.BufferOutput 设置为 true，我尝试过 Response.Clear，但似乎没有任何效果。

是否可以将视图呈现为字符串，然后进行重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-19T00:09:35.613

我相信您不必结束响应即可将视图呈现为字符串。

看看[这里](http://forums.asp.net/t/1193898.aspx)和[这里](http://mikehadlow.blogspot.com/2008/06/mvc-framework-capturing-output-of-view_05.html)（这个有你需要的确切样本）。

最后一个链接应该是：

```
http://mikehadlow.blogspot.com/2008/06/mvc-framework-capturing-output-of-view_05.html 
```

似乎 StackOverflow 在导致链接的链接中编码了下划线。只需确保最后有 _05.html 即可。
此外，如果我转到浏览器中的地址栏（单击链接后），将光标放在那里并按 Enter 即可。
真奇怪。

# autocomplete - 根据受欢迎程度自动完成

> ID：872841
> 
> 赞同：2
> 
> 时间：2009-05-16T17:22:29.517
> 
> 标签：autocomplete

对于一般的自动完成建议（按字典顺序排序的键），可以使用尝试或 TST。但是，我想做自动完成以根据结果的受欢迎程度返回结果。因此，搜索“clinton”将按顺序显示“bill clinton”、“hillary clinton”和“chelsea clinton”。我相信这可以在 Lucene 中使用 ngram 方法来完成。还有其他方法吗？

同样，在stackoverflow上返回标签自动完成结果列表的后端是什么？它是基于lucene的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T17:49:10.107

取决于

1.  您的搜索空间有多大
2.  如果你想要纠错
3.  搜索空间的恒定性
4.  需要按用户定制
5.  多语言？

对于内存中的情况，您可以使用在叶子中存储命中计数的 Trie。

这里要处理的另一个重要问题是您将如何预测不完整的多个单词。例如 Abraham => Lincoln 或 Thomas（用户之父）。N-Grams 来自哪个语料库会更好，谷歌还是 VI 类历史书？

这取决于上下文。命中数可能是当前应用程序中的命中数，也可能是全局命中数。例如，当一个新词开始流行时，您会遇到冷启动问题，但它还没有收到大量点击以冒泡到列表的顶部

开始讨论的想法......谢谢

# python - pycurl：RETURNTRANSFER 选项不存在

> ID：872844
> 
> 赞同：8
> 
> 时间：2009-05-16T17:23:13.307
> 
> 标签：python, curl, libcurl, pycurl, attributeerror

我正在使用 pycurl 访问 JSON Web API，但是当我尝试使用以下内容时：

```
ocurl.setopt(pycurl.URL, gaurl)       # host + endpoint
ocurl.setopt(pycurl.RETURNTRANSFER, 1)
ocurl.setopt(pycurl.HTTPHEADER, gaheader) # Send extra headers
ocurl.setopt(pycurl.CUSTOMREQUEST, "POST") # HTTP POST req
ocurl.setopt(pycurl.CONNECTTIMEOUT, 2) 
```

并执行脚本，它失败了。

```
File "getdata.py", line 46, in apicall
ocurl.setopt(pycurl.RETURNTRANSFER, 1)
AttributeError: 'module' object has no attribute 'RETURNTRANSFER' 
```

我不知道发生了什么，以及为什么 RETURNTRANSFER 似乎不存在，而所有其他选项都存在。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T17:39:01.940

该手册显示用法[如下](http://pycurl.sourceforge.net/doc/curlobject.html)：

```
>>> import pycurl
>>> import StringIO
>>> b = StringIO.StringIO()
>>> conn = pycurl.Curl()
>>> conn.setopt(pycurl.URL, 'http://www.example.org')
>>> conn.setopt(pycurl.WRITEFUNCTION, b.write)
>>> conn.perform()
>>> print b.getvalue()
<HTML>
<HEAD>
  <TITLE>Example Web Page</TITLE>
</HEAD>
<body>
<p>You have reached this web page by typing &quot;example.com&quot;,
&quot;example.net&quot;,
  or &quot;example.org&quot; into your web browser.</p>
<p>These domain names are reserved for use in documentation and are not availabl
e
  for registration. See <a href="http://www.rfc-editor.org/rfc/rfc2606.txt">RFC

  2606</a>, Section 3.</p>
</BODY>
</HTML> 
```

似乎有点迂回，但我不是 PycURL 的忠实粉丝......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T20:18:55.613

CURLOPT_RETURNTRANSFER 不是 libcurl 选项，但它在 PHP/CURL 绑定中提供

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T17:32:18.977

您是否尝试过执行`print dir(pycurl)`并查看该选项是否存在于属性列表中？

# c++ - 这会导致未定义的行为吗？

> ID：872846
> 
> 赞同：2
> 
> 时间：2009-05-16T17:24:48.013
> 
> 标签：c++, undefined

我在重现和查找错误原因时遇到了很大的问题。发生似乎完全是随机的，所以我怀疑某处有一个未初始化的变量。但后来我发现了这段代码：

```
CMyClass obj; // A
obj.DoStuff();

if ( somebool )
{
    CMyClass obj; // B
    obj.DoStuff();
}

obj.DoOtherStuff(); 
```

似乎 DoOtherStuff() 要么在“B”上完成，要么 B.DoStuff() 有时实际上在 A 上工作 - 即我 DoStuff() 实际上是在第一个 obj 上调用的。

这会发生吗？我认为我没有收到编译器警告（我现在已经修复了代码，希望它可能会有所帮助）。这段实际代码似乎*很*可能是我要查找的错误所在，但当然可能还有其他我尚未发现的原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T17:37:02.057

编写的代码应该可以工作。第一次调用`DoStuff()`和最后一次调用`DoOtherStuff()`只能发送到`A`。

`DoStuff()`块内的调用`if(somebool) { }`只能发送到`B`.

从[标准](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1905.pdf)：

> **3.3.2 局部范围**
> 
> 1.  在块 (6.3) 中声明的名称是该块的本地名称。它的潜在范围从其声明点 (3.3.1) 开始，并在其声明区域的末尾结束。

和：

> **3.3.7 名称隐藏**
> 
> 1.  可以通过在嵌套声明区域或派生类 (10.2) 中显式声明相同名称来隐藏名称。

话虽如此，也许这不是该代码作者的*意图。*如果变量具有相同的名称，则可能意图是只有该变量的一个实例，而`B`在循环内创建的实例是错误的。您是否通过逻辑来查看第二个实例是否有意义？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T17:38:35.203

除非`obj.DoStuff()`对某个全局对象进行更改，否则正如 Valentin 指出的那样，它应该全部包含在 if 语句的范围内

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T17:38:38.823

与全局变量同名的局部变量隐藏了该块内的全局变量。但是，全局范围运算符 (::) 可用于告诉编译器您的意思是全局版本

```
CMyClass obj; // A
obj.DoStuff();
if ( somebool )
{ 
 CMyClass obj; // B  
 obj.DoStuff();  //does on B
 ::obj.DoStuff(); //does on A
}
obj.DoOtherStuff(); //this will call A because B is destroyed 
```

所以局部变量 B 在超出范围时被销毁。使用与全局变量同名的局部变量通常会带来麻烦，因此请尽可能避免使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T18:31:59.007

如果您使用 GCC，您可以（并且 - 在我看来 - 应该）使用 -Wshadow，它会在示例中的情况下发出警告，这通常会导致非常微妙的错误。

但是，就像许多其他人已经说过的那样，您粘贴的代码是正确的，符合您的预期，并且不是未定义的行为。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T17:35:25.570

不，这不可能发生。

编译器保证 B 对象在退出 if 作用域时被正确销毁，并且在它还活着的时候它作用于自己的地址空间。

错误在其他地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T18:52:38.020

您的代码可能在语法上是正确的，但这些方法的作用是什么？例如，堆栈溢出可能会导致您正在观察的怪异行为。

# iphone - 在 Cocos2d 中移动 50 个精灵

> ID：872856
> 
> 赞同：2
> 
> 时间：2009-05-16T17:28:08.037
> 
> 标签：iphone

我有大约 50 个小精灵想要在图层周围移动。我一直在寻找几个不同的选择。这样做最有效的方法是什么？（他们将不断移动）。

我看过 PathAction ( [http://code.google.com/p/cocos2d-iphone/issues/detail?id=63](http://code.google.com/p/cocos2d-iphone/issues/detail?id=63) ) 我还考虑过直接 [sprite schedule: @selector (step: ) 间隔：0.1];

您认为最有效的方法是什么？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-21T01:10:50.390

我就是这样做的——我的精灵从右侧进入屏幕，然后向左移动消失。我有 3 种不同的纹理，精灵使用的纹理是在生成精灵时随机分配的，所以无论我制作多少精灵，都只应用了 3 张图像。

```
id actionMove = [CCMoveTo actionWithDuration:actualDuration position:ccp(-target.contentSize.width/2, actualY)];
id actionMoveDone = [CCCallFuncN actionWithTarget:self selector:@selector(spriteMoveFinished:)];
[target runAction:[CCSequence actions:actionMove, actionMoveDone, nil]]; 
```

# linux - 无法将输出重定向到 /var/lib/varlibfile，但我可以将 varlibfile 复制到 /var/lib

> ID：872860
> 
> 赞同：2
> 
> 时间：2009-05-16T17:32:09.383
> 
> 标签：linux, bash

我有一个以 root 身份运行的脚本，它应该将它的缓存文件（仅由脚本修改）存储在 /var/lib/varlibfile 中。但是脚本似乎没有创建文件，我的调查导致我这样做：

```
$ sudo echo "something" >/var/lib/varlibfile
bash: /var/lib/varlibfile: Permission denied
$ sudo echo "something" >varlibfile
$ sudo cp varlibfile /var/lib/ 
```

换句话说，我可以在 /var/lib 中创建一个名为 varlibfile 的文件，但我不允许使用重定向来创建它。只有文件副本有效。这对我来说似乎很奇怪，我想直接使用重定向到预期的文件，而不是在其他地方创建它然后复制它。

一些额外的信息：

```
$ ls -ld /var
drwxr-xr-x 14 root root 4096 2009-03-02 14:47 /var
$ ls -ld /var/lib
drwxr-xr-x 51 root root 4096 2009-05-16 19:25 /var/lib
$ ls -la /var/lib/ | head
total 204
drwxr-xr-x  51 root          root          4096 2009-05-16 19:25 .
drwxr-xr-x  14 root          root          4096 2009-03-02 14:47 ..
drwxr-xr-x   2 root          root          4096 2009-03-02 14:22 acpi-support
drwxr-xr-x   2 root          root          4096 2009-03-02 14:39 alsa
drwxr-xr-x   2 root          root          4096 2009-05-14 14:42 apparmor
drwxr-xr-x   6 root          root          4096 2009-05-14 14:42 apt
drwxr-xr-x   2 root          root          4096 2008-04-04 11:56 aptitude
drwxr-xr-x   2 root          root          4096 2008-07-02 12:58 aspell
drwxr-xr-x   2 avahi-autoipd avahi-autoipd 4096 2009-03-05 16:42 avahi-autoipd 
```

谁能解释为什么会这样？以及如何解决这个问题，理想情况下我想直接编写 /var/lib/varfile 而无需在其他位置创建任何先前的内容。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-16T17:57:24.673

什么

```
$ sudo echo something >/var/lib/varlibfile 
```

确实，是将“ `sudo echo something`”的输出通过管道传输到文件。所以文件写入操作是以当前用户的身份完成的，没有权限写入`/var/lib`。

尝试类似的东西

```
$ sudo sh -c "echo something >/var/lib/varlibfile" 
```

或者

```
$ echo something | sudo tee /var/lib/varlibfile 
```

# .net - 动态生成 RDLC - 是什么阻止我使用 StringBuilder 构建 XML

> ID：872867
> 
> 赞同：1
> 
> 时间：2009-05-16T17:36:01.310
> 
> 标签：.net, reporting, xmldocument, stringbuilder

我正在构建本地报告。由于 Hidden 属性的一些限制，我需要动态生成报告。

[我在这里](http://msdn.microsoft.com/en-us/library/aa237432(SQL.80).aspx)找到了一些文档。

ReportViewer 控件需要一个流。

我不太喜欢文档中使用的方法。并且构建一个 XmlDocument 不是很可读的imo。

有什么东西阻止我这样做

> 类程序 { 静态无效 Main(string[] args) { GenerateReport(); }

```
 static void GenerateReport(){        
        StringBuilder reportXml = new StringBuilder();

        reportXml.Append("<Report>");
        reportXml.Append("<PageHeight>8.5in</PageHeight>");            
        reportXml.Append("</Report>");          

        XmlDocument xmlDocument = new XmlDocument();

        xmlDocument.LoadXml(reportXml.ToString());

        xmlDocument.Save(@"C:\test.xml");
        xmlDocument.Save(Console.Out);

        Console.ReadLine();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T18:28:32.713

很简单：如果您使用该方法，处理器中的特殊操作会检测到用于生成该字符串的错误类 ws，此时会调用正确性策略。

说真的，没有什么能阻止你这样做。事实上，在幕后你可以打赌，在更复杂的 XML 生成器中有一些代码可以做类似的事情。当您深入了解它时，XML 只是一个字符串，只要它的格式正确，无论您如何构建它，该字符串都将是相同的。

其他类的优势在于，当您想要构建更复杂的 XML 时，它们更简单、更灵活。

* * *

有几乎无限多的类可以生成 XML 或 XHTML。寻找具有“流畅界面”的产品。在类似 C++ 的语言中，它可能看起来像：

```
 XMLOutStream foo("filename.xml);
  foo.group("Top","attr=val")
     .group("Next")
     .line("Another", "attr=val") ; 
```

生成

```
 <Top>
   <Next attr="val">
      <Another attr="val" />
   </Next>
 </Top> 
```

[我在这个问题](https://stackoverflow.com/questions/782316/c-html-generation-classes)中寻找与 HTML 类似的东西。

# asp.net - 如何在开发机器上测试子域？abc.localhost

> ID：872868
> 
> 赞同：18
> 
> 时间：2009-05-16T17:36:43.023
> 
> 标签：asp.net, windows, iis

我正在尝试开发一个具有多个子域的 asp.net 站点。我是一般网站的新手，尤其是 asp.net。但是，通配符子域似乎是通过 dns 条目和 Web 服务器配置的组合正确设置的——这在我的开发机器上不会发生。因此，我在我的 Windows**主机文件**中手动插入条目：

```
127.0.0.1  localhost
127.0.0.1  abc.localhost
127.0.0.1  xyz.localhost 
```

但是，当我尝试询问**Request.Url**属性时，看不到子域。例如，如果我`http://abc.localhost:1660/`在浏览器中点击，我会`http://localhost:1660/`从`Request.Uri.ToString()`; `abc`刚刚没了？！

我不知道为什么主机文件会这样工作，但是我可以使用其他方法将子域导入本地 Web 应用程序吗？谢谢你们。

请注意，我只使用内置的 asp.net 开发服务器，而不是完整的 iis 服务器。（本周末我无法访问完整的 IIS，但我仍然想知道这是否有帮助。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-16T17:55:00.950

不知道标头，但我使用的一个鲜为人知的技巧是所有 127.* 地址都是 localhost 地址，而不仅仅是 127.0.0.1。实际上，您可以运行一台服务器在 127.0.0.1 端口 80 上进行监听，而另一个 Web 服务器实例在 127.0.0.2 端口 80 上进行监听。因此，您可以将 127.0.0.1 命名为 localhost，127.0.0.2 可以是 abc.localhost（或 abc.mydomain .com 以便您可以针对本地网络服务器测试真实的实时 URL）等。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-10-09T09:05:12.643

我正在使用 Windows 7、IIS 7.5、VS 2008、SQL Server 2005

我能够在 localhost 上成功模拟子域购买将以下行放入 etc/hosts

```
127.0.0.2   myapp.localhost.com 
```

并且，在 IIS 中，我设置了一个新网站，并对绑定部分进行了以下修改：

```
Hostname = myapp.localhost.com 
IP address = 127.0.0.2 
```

我还创建了一个新的应用程序池，但这不是必需的。您可能必须更改用于处理请求的身份验证用户。我的默认 IIS 用户有 SQL 连接权限错误。

```
IIS>Application Pools>>Right Click on your pool>Advanced Settings>Identity = LocalSystem 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-08-18T00:04:05.460

*您可以使用“ Request.Headers["HOST"]* ”获取具有完整子域的请求域。这是一个返回当前请求的子域的简单方法。此方法还假设您在域之后有一个“.COM”、“.NET”等，就像真正的 web 一样。因此，您需要更改 HOSTS 文件以包含“localhost.com”、“abc.localhost.com”等。

```
public string subdomain()
{
    string host = Request.Headers["HOST"];
    if (!string.IsNullOrEmpty(host))
    {
        var parts = host.Split('.');
        if (parts.Length > 2)
        {
            return parts[0];
        }
    }
    return string.Empty;
} 
```

我正在搜索这件事，这是一篇真正帮助我解决这个问题的文章： [https ://web.archive.org/web/20090813174916/http://blogs.securancy.com/post/ASPNET-MVC -子域路由.aspx](https://web.archive.org/web/20090813174916/http://blogs.securancy.com/post/ASPNET-MVC-Subdomain-Routing.aspx)

# java - Swing 组件支持哪些 HTML 标签？

> ID：872871
> 
> 赞同：17
> 
> 时间：2009-05-16T17:38:05.330
> 
> 标签：java, html, swing

许多 Swing 组件支持嵌入式 HTML，但我找不到任何关于该主题的官方文档。（Sun 页面上关于 HTML 的所有内容似乎都针对 JEditorPane）

那么：Swing 组件支持哪些 HTML 标签？

**编辑：**虽然我说我缺少“官方文档”，但我也想要任何“非官方”文档。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T09:16:33.830

正如 Software Monkey 所说，Swing 支持 HTML 3.2 (Wilbur)。您可以在以下网址找到这个过时 (1996) 版本的 HTML 的官方文档：http: [//www.w3.org/TR/REC-html32.html](http://www.w3.org/TR/REC-html32.html)

有关该主题的 Java 7 文档：http: [//docs.oracle.com/javase/7/docs/api/javax/swing/text/html/package-summary.html](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/package-summary.html)

尽管值得注意的是，它没有明确提到此信息对其他 Swing 组件有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T17:51:30.553

我相信它是 HTML 3.x 的一个狭窄子集，虽然在我的脑海中，我不记得我在哪里读到的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T17:41:06.163

我不确切知道支持哪些标签，但我建议您将自己限制为粗体/斜体（或者更好的 strong/em 假设它支持它们）和 img 标签。其他任何事情都可能引起头痛，并且可能意味着您在该组件中填充了太多东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-12-16T15:20:43.167

正如@Mr.Napik 在他的回答中指出的那样，Swing HTML 支持基于 HTML 3.2，但它确实支持一些额外的标签（特别是`<span>`）。特定支持的标签记录在[`HTML.Tag`文档](https://docs.oracle.com/en/java/javase/11/docs/api/java.desktop/javax/swing/text/html/HTML.Tag.html)中。

[`CSS`文档](https://docs.oracle.com/en/java/javase/11/docs/api/java.desktop/javax/swing/text/html/CSS.html)中也详细介绍了 CSS 支持。

# visual-studio - 如何使用 qmake 创建 vcproj 以使其过滤器反映目录结构？

> ID：872875
> 
> 赞同：5
> 
> 时间：2009-05-16T17:38:56.140
> 
> 标签：visual-studio, qt, qt4, qmake

我使用 qmake (Qt 4.5.1) 创建我的 vcproj 文件。我想为输出 vcproj 创建自定义过滤器，这样不是每个 *.h 文件都在“头文件”过滤器中，*.cpp 在“源文件”等中。

例如，包含文件的项目

```
foo\foo.h
foo\foo.cpp
bar\bar.h
bar\bar.cpp 
```

应该有一个 vcproj 文件

```
foo
   foo.h
   foo.cpp
bar
   bar.h
   bar.cpp 
```

代替

```
Header Files
   bar.h
   bar.cpp
Source Files
   bar.cpp
   foo.cpp 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T17:57:47.870

如果使用 qmake 运行**`CONFIG -= flat`**，您将获得以下项目结构：

```
Header Files
    foo
        foo.h
    bar
        bar.h
Source Files
    foo
        foo.cpp
    bar
        bar.cpp 
```

这一直困扰着我，这就是我在 Mac 上为 Xcode 项目编写修复程序的原因。最终我可能会为 VS 编写一个（这更容易，因为项目文件是 XML 文档）。

如果您使用 Visual Studio 在 Windows 上严格编写软件，我建议使用[Visual Studio 集成插件](http://www.qtsoftware.com/downloads/visual-studio-add-in)，因为它会自动生成编译 Qt 文件所需的 UIC 和 MOC 步骤。

# security - 如何让用户难以将 mp3 文件从我的站点保存到他们的硬盘？

> ID：872877
> 
> 赞同：1
> 
> 时间：2009-05-16T17:39:13.033
> 
> 标签：security, http, streaming, mp3

我希望用户能够上传 mp3，也能够通过嵌入页面的播放器播放它们。我知道通过直接从计算机输出录制音频来阻止专用用户复制音频是不可能的，但我想让用户很难或不可能只复制 URL 并粘贴它，这样他们就可以直接访问数据。

目前，我正在做的是：

*   将 mp3 文件保存到我的 Web 服务器无法访问的目录中。
*   使用标头将 mime 类型更改为 text/html 而不是 audio/mpeg（我的 swf 播放器不在乎它只是读取数据）

问题是提供数据的控制器的 URL 是可访问的。因此，如果用户查看页面源并在地址栏中复制粘贴 url，Web 服务器会很乐意将 mp3 数据发送给他们。

有人对如何使这更难做有任何建议吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T17:54:10.593

使用 PHP 脚本来屏蔽该位置，以便

```
http://www.site.com/files/foo.mp3 
```

变成

```
http://www.site.com/files.php?fn=foo.mp3 
```

Flash 可能是从那里开始的下一步。也许它使用了某种形式的一次性 id 来授权使用共享状态的下载。您的 session_id 将在这里提供帮助。

请记住：Flash 可能会在某个临时文件夹中保留缓存……我知道我曾经在某些播放器上找到 /tmp/aiden-sdjks/foo.mp3。闪存中可能有更好的流媒体解决方案，它在后端采用另一种文件格式？

至少这可以阻止人们查看源代码并找到 URL。除非他们努力对播放器进行逆向工程并编写自己的播放器以吐出下载。

**然而，通过默默无闻的安全**是一条危险的道路。有人，只要有足够的努力，总会成功。看看 BBCIplayer 如何进行 DRM 化，可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T17:55:15.287

使用 Flash 直接连接到服务器上的文件称为渐进式流式传输。这使得 Flash 播放器在播放时从服务器加载整个文件。还有另一种解决方案：流式传输，在播放期间的任何时间都只将一小部分数据加载到用户机器中。

Flash 最可靠的选择是为您的内容使用流媒体服务器。Flash Media Server 是一种选择，但您可以购买或查找托管版本（如 Akamai）的产品。如果你是一个较小的单位，有媒体服务器的开源版本，比如 Red5 ( [http://osflash.org/red5](http://osflash.org/red5) )

不确定 windows 媒体播放器或 quicktime 播放器，但我相信那里也有类似的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T17:45:56.013

取决于你想做多难。您可以使用 javascript 重写 url，基本的 ROT-13，希望人们不会费心去解码它。

不过，我还没有尝试将 javascript 函数放入 html 对象 src 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T22:29:00.997

您应该将文件存储在受保护的目录中。我的托管服务 (Nearly Free Speech) 会自动为您设置，您可以在 CGI 脚本（例如 PHP）中检索文件，然后写入临时文件或直接使用二进制文件。例如，我在此目录中存储了对我的个人网站的简单访问列表，该目录超出了 web 根目录的范围。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-16T17:47:23.013

我不知道 Flash 播放器解决方案是否可以做到，但它可能值得研究。

# visual-studio - 有没有人有 VS 2005 的 Control Visualizer

> ID：872878
> 
> 赞同：1
> 
> 时间：2009-05-16T17:40:51.687
> 
> 标签：visual-studio, visual-studio-2005, debuggervisualizer

我正在寻找由 Brett Johnson 开发的 Control Visualizer 的源代码和下载，但我找不到与下载 Visualizer 相关的任何链接，也找不到任何相同的源代码。

我正在使用 VS 2005，是否有任何链接或与此控件可视化器相关的任何其他材料，这将对我们有很大帮助

寻找有利的答复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T16:23:31.660

我相信[这](http://blog.bretts.net/?p=9)是您所指的可视化工具，但是页面上的所有链接似乎都已损坏。

我做了进一步的挖掘，并设法通过互联网档案中的回程机器找到了一个工作链接。您可以从此页面下载代码：

[http://web.archive.org/web/20060426073908/http://blog.bretts.net/?p=9](http://web.archive.org/web/20060426073908/http://blog.bretts.net/?p=9)

# vb.net - 如何使用 LINQ 从 SQL Server 获取唯一的名称首字母和以该字母开头的名称计数？

> ID：872885
> 
> 赞同：0
> 
> 时间：2009-05-16T17:43:53.397
> 
> 标签：vb.net, linq, grouping

几天前我在玩 ASP.NET MVC 1.0。我从一个名为“Contacts”的单表数据库开始，其结构非常简单，例如 Title、FullName、SurName、Email、Phone、Address 等。

我使用 LINQ 作为我的模型。

在我的主视图中，我想显示一个字母列表，这些字母具有以该字母开头的全名加上全名的计数。类似如下所示：

A - (2)
D - (4)
J - (1)
以此类推。关于显示的一件特别的事情是我不想显示那些没有以它们开头的名字的字母。

我尝试了几个查询，但没有成功。感谢您对解决此查询的任何帮助。请提供 VB.NET 语言的代码。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T17:53:21.143

```
 var query = from c in contacts
                group c by c.FullName[0] into cg
                select new { FirstChar = cg.Key, Count = cg.Count() }; 
```

应该管用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T17:53:37.833

[MSDN](http://msdn.microsoft.com/en-us/vcsharp/aa336754.aspx#simple2)上有一个非常相似的例子：

```
public void Linq41() {
            string[] words = { "blueberry", "chimpanzee", "abacus", "banana", "apple", "cheese" };

            var wordGroups =
                from w in words
                group w by w[0] into g
                select new { FirstLetter = g.Key, Words = g };

            foreach (var g in wordGroups) {
                Console.WriteLine("Words that start with the letter '{0}':", g.FirstLetter);
                foreach (var w in g.Words) {
                    Console.WriteLine(w);
                }
            }
        } 
```

您必须在 select 语句中将 Words = g 更改为 Count = g.Count，因此您只需查询组中项目的总和。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T17:59:47.743

在 VB.NET 中：

```
Dim FirstLetterCounts = From c In contacts _
                        Group c By Key = c(0) Into NameGroup _
                        Select FirstLetter = Key, Count = NameGroup.Count()

For Each g In FirstLetterCounts
    Console.WriteLine("First Letter = {0}, Count = {1}", g.Key, g.Count)
Next 
```

# mfc - 如何使用 CImageList

> ID：872886
> 
> 赞同：1
> 
> 时间：2009-05-16T17:43:55.377
> 
> 标签：mfc

我希望我的树视图控件显示一个带有文件夹图标的项目。所以，我写了这段代码：

```
HBITMAP hFolderBitmap = (HBITMAP)::LoadImage(AfxGetInstanceHandle(),_T("info.bmp"),IMAGE_BITMAP,20,20,LR_LOADFROMFILE|LR_CREATEDIBSECTION);

if(hFolderBitmap)
{
    cil.Create(20,20,ILC_COLOR32,0,5);

    bmp.FromHandle(hFolderBitmap);
    cil.Add(&bmp,RGB(255,0,255));
}

GetTreeCtrl().SetImageList(&cil,TVSIL_NORMAL);
hrootFolder = GetTreeCtrl().InsertItem(_T("Subscriptions"),0,0,TVI_ROOT); 
```

但是，这不会在我的订阅标签旁边添加文件夹图标。它工作正常，但不显示任何图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T17:48:35.990

我用这个：

```
UINT uiBmpId = theApp.m_bHiColorIcons ? 
    IDB_MACROBROWSE_IMGLIST_HQ : IDB_MACROBROWSE_IMGLIST;

CBitmap bmp;
if( !bmp.LoadBitmap( uiBmpId ) )
{
    ASSERT( FALSE );
    return;
}

BITMAP bmpObj;
bmp.GetBitmap (&bmpObj);

UINT nFlags = ILC_MASK;
nFlags |= (theApp.m_bHiColorIcons) ? ILC_COLOR24 : ILC_COLOR4;

m_imageList.Create( 16, bmpObj.bmHeight, nFlags, 0, 0 );
m_imageList.Add( &bmp, RGB (255, 0, 255) );

GetTreeCtrl().SetImageList (&m_imageList, TVSIL_NORMAL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T18:41:41.150

而不是使用：

bmp.FromHandle(hFolderBitmap);

我不得不使用：

bmp.Attach(hFolderBitmap);

# forms - 在表单字段标签中使用正确的语言

> ID：872891
> 
> 赞同：3
> 
> 时间：2009-05-16T17:46:39.753
> 
> 标签：forms, naming-conventions, field, linguistics

我希望使用以下句子作为对表单字段的评论。我已经为该字段提出了一个简短的标签。本文旨在更详细地解释该领域：

**你来自哪个国家[哪里]。**

问题是：那里需要这个“哪里”，可以在那里使用（可选）还是不能在那里使用（错误）。

由于英语不是我的母语，所以有时会出现这些事情。请不要对我太苛刻。

编辑：我对答案和问题的复杂性有些不知所措。是的，我有一个输入字段，我想给它写一个标签。我们都知道诸如“我来自澳大利亚”之类的基本短语——“你来自哪里？”。不能像“你来自的国家”这样的形式转吗？

如果以下是正确的：“我居住的国家**”**？或者，如果不是独立从句而是从句，我可能只把介词放在末尾（术语可能不正确，忘记了）：我已经回到我居住的**国家**。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T18:35:28.047

> 我基本上有两组输入字段，一组用于当前用户位置，另一组用于他原来的位置。所以我贴了两个标签：“你居住的国家”和“你来自的国家”。

我会去：

```
Country of residence: _____________
Country of birth:     _____________ 
```

将“国家”放在首位，可以清楚地知道该字段应该输入什么样的信息，并且在表格中常用“居住地”和“出生地”这两个词。

我更喜欢“出生”而不是“起源”，因为“起源”可能会被误解。如果某人出生在中国，移居智利，然后在填写此表格之前移居加拿大，他们可能会想回答“智利”作为原籍国，因为那是他们最近居住的国家。使用“出生国家”使其非常明确。

**注意：** 用于标记表单域的语言通常不是由完整的句子组成。一个完整的句子可能看起来像：

```
In which country do you currently live? ______________
In which country were you born?         ______________ 
```

但这会使您的表格不必要地混乱。当有人填写表格时，他们试图回忆不同的、个别的信息，他们（很可能）打算尽快完成这项无聊的任务。处于这种心态的用户不想阅读整篇文章只是为了弄清楚他们应该在给定领域输入什么。出于这个原因，表单标签应该简洁明了，并且应该避免以任何方式模糊。

**编辑以回应新评论：**

> 我在文本框之前有短标签和旁边的详细评论。写短版没问题，长版让我困惑

如果是您要决定的长版本（评论），我会选择上面描述的完整句子选项。它们会制作糟糕的短格式标签，但它们可以很好地用作评论或翻转工具提示。

另一种指令风格的格式是：

```
Enter the name of the country in which you currently live
Enter the name of the country in which you were born 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T17:51:32.723

**你来自的城市。**

“从”是介词。用介词结束句子是语法错误。

但是，在输入表单的上下文中使用“[City or Country] of Origin”会更合适。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T17:54:26.490

正式地它会是“你来自的城市”、“你来的城市”（除了“来自”肯定是古老的）、“你的家乡”，或者可能是“你的起源城市”或“原始城市” .

通俗地说，我会说“你来自的城市”而不是“你来自的城市”。如果我写它，例如在一个表单上标记输入文本字段，那么“你来自的城市”可能会更好，因为它不那么模棱两可。

请注意，它们都不是完全符合语法的，因为它们不是完整的句子：它们缺少主语和动词。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-16T18:04:03.567

如果这是应用程序中的表单字段（使其模糊地与编程相关:-)），“原产国”在我看来更自然。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T17:48:54.820

哪里需要书面英语（英国），但通常会在口语（口语）英语中被删除。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T17:49:21.433

我相信你拥有它的方式是正确的——“哪里”是可选的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T17:51:33.533

嗯。不是“你来自的城市”吗？如“您来自的城市”。另一种方式实际上是一种影射。[这可能是我作为一名曼彻斯特人对英语的微弱掌握。]

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-16T17:55:59.937

完整的表格是`The city from which you come`. 因为它是一个以代词为宾语的关系从句，所以可以省略。（“联系条款”）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-18T06:27:14.987

在美国英语*口语*中，有或没有都可以`where`——**但**我不会在网站上使用任何一种。**原因**如下：

我是以美国英语为母语的人。我只会说`I come from America`如果我在另一个国家旅行，或者我已经搬到另一个国家并且已经在那里了。我在美国的时候永远不会这么说。

所以这句话`I come from America`暗示你和我在美国以外的地方。

因此，如果您在您的网站上说`The country [where] you come from`，，则意味着您的访问者已离开他们的祖国，或者您的访问者已经离开了他们原来的国家。

我知道这很微妙，但如果你在网上问它，听起来会有点奇怪和“关闭”。

* * *

相反，确切地问你想知道什么。如果您想知道他们*现在*住在哪里，请说出以下内容之一：

1.  `Your country of residence`
2.  `The country where you live`
3.  `The country you live in`（是的，在实际实用的美国英语中，`in`可以放在最后。）

如果您想了解人们认为自己是本地人的国家，请说`The country you consider yourself a native of`。不过，这个词`native`对不同的人有不同的含义。同样，您可以说`Your home country`, 但同样，`home`对不同的人意味着不同的东西。

或者，如果您的访客确实来自不同的国家并且现在在一个新的国家，比如说`The country you came from`。（注意我说的是**CAME**而不是 COME。）你也可以说`Your country of origin`，但这听起来很机械化和官僚主义。

我知道您可能已经部署了表单，但我希望这会让您更加清楚。

# arrays - 对数组执行手动排序

> ID：872902
> 
> 赞同：0
> 
> 时间：2009-05-16T17:51:45.420
> 
> 标签：arrays, sorting

我正在使用 OpusScript，它与 Javascript 非常相似。

我需要通过其中对象的两个属性对数组进行排序。

数组的对象类型是“ScoreEntity”，具有分数和时间属性。我需要数组的 0 索引处的最高分数，反之亦然，更快的时间覆盖匹配分数。

多年来我一直在尝试这样做，但我无法理解它，我有周六综合症！

**回答：**

我最后使用了 BubbleSort，欢迎任何关于改进的评论。

```
function SortScoreArray(array)
{

    var unsorted = true
    while (unsorted)
    {

        // Tracks whether any changes were made, changed to false on any swap
        var complete = true
        for (var i = 0; i < array.length - 1; i++)
        {           

            // Holds the value for determining whether to swap the current positions
            var swap = false

            var currentItem = array[i]
            var nextItem = array[i + 1]

            if (currentItem.Score == nextItem.Score)
            {

                // The scores are the same, so sort by the time
                if (currentItem.Time > nextItem.Time)
                {
                    swap = true
                }

            }
            else if (currentItem.Score < nextItem.Score)
            {
                swap = true
            }

            if (swap)
            {
                array[i] = nextItem
                array[i + 1] = currentItem
                complete = false
            }

        }

        if (complete)
        {
            unsorted = false
        }

    }

    return array

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T18:04:09.680

你选择[算法](http://en.wikipedia.org/wiki/Sorting_algorithm)了吗？（快速排序很好）

您必须定义一个比较函数来确定哪个`ScoreEntity`更少（通过比较分数和时间），然后只实现算法。

（我不知道 OpusScript - 也许你可以使用你告诉比较谓词的内置排序）

# php - PHP：从嵌套集中对数据进行排序

> ID：872904
> 
> 赞同：1
> 
> 时间：2009-05-16T17:52:05.357
> 
> 标签：php, mysql, sorting, nested-sets

我们目前正在构建一个网站，其中包含一个包含各种能力的分类 MySQL 表，我们注意到嵌套集模型将为此进行优化。虽然，我们遇到了一个非常严重的问题——嵌套集合模型不允许任何排序，我们确实需要这种可能性。我希望输出数据是**array(id, name, depth)**，因为这个函数支持（虽然没有任何排序）：

```
function tree()
{
    $query = 'SELECT node.id, node.name, (COUNT(parent.name) - 1) AS depth FROM test_competence AS node, test_competence AS parent WHERE node.lft BETWEEN parent.lft AND parent.rgt GROUP BY node.name ORDER BY node.lft';
    $result = mysql_query($query) or die(mysql_error());

    while($data = mysql_fetch_assoc($result))
    {
        $returnarray[] = $data;
    }

    return $returnarray;
} 
```

我从一个函数开始，但不知道如何继续：

```
function tree_sorted()
{
    //Get data
    $query = 'SELECT node.id, node.name, node.parent, (COUNT(parent.name) - 1) AS depth FROM test_competence AS node, test_competence AS parent WHERE node.lft BETWEEN parent.lft AND parent.rgt GROUP BY node.name ORDER BY node.lft';
    $result = mysql_query($query) or die(mysql_error());

    //Fetch gotten data
    while($data = mysql_fetch_assoc($result))
    {
        $fetched[$data['depth']][$data['id']] = array($data['name'], $data['parent']);
    }

    //Sort fetched data
    foreach($fetched as $i => $row)
    {
        asort($row);
        $sorted[$i] = $row;
    }

    //Merge sorted data (???)
    foreach($sorted as $i => $arr)
    {
        foreach($arr as $x => $row)
        {
            $returnarray[] = array('id' => key($row), 'name' => $row[0], 'depth' => $x);
        }
    } 
```

任何帮助将不胜感激。我已经用谷歌搜索了从嵌套集中对数据进行排序的不同方法，但没有任何好的结果。

先感谢您。

**编辑**：现在我用 uasort() 函数尝试了一些感觉是正确的方法，但问题仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:09:39.440

如果您需要对树中的一组节点进行排序，并在树中维护无限数量的级别，我是否建议使用预排序树遍历？

有关示例实现，请参见[http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/ 。](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

关键是您为每个节点维护一个左右值。您还可以为每个节点维护一个深度列，它告诉它在树的哪个级别。您可以使用这些左右值按节点在树中的顺序对节点进行排序，并使用深度值仅选择给定的树的层数。

这种方法唯一值得注意的缺点是在更改节点结构时必须主动维护这些左右值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T18:06:39.020

根据我的经验，使用嵌套集模型并不是真正必要的，除非您预计会有一些非常大的流量。我不确定你到底需要层次结构来做什么，但我建议检查一个简单的父子表是否足够，它前面有一个缓存，它更容易维护和使用

同样，这当然取决于您的应用程序以及您对性能问题的担忧程度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T00:13:25.477

在黑暗中尝试一下，因为嵌套的集合树数据根据定义已经排序，听起来您需要将数据转换为另一种格式（通常是平面格式）才能对其进行排序。实现这一点的最简单方法是简单地处理数据，随时创建一个平面数据集。

您在 SQL 中已经有了一些选项。如果我有正确的术语，按左 ID 排序可以让您按顺序遍历。这通常是人们在列出一个集合树时想要的，因为它在扁平化为一个列表时是有意义的。我将尝试使用`ORDER BY`SQL 中的子句；例如，按深度参数排序将为您提供级别顺序遍历。尝试将其与`node.name`.

# java - 小程序类加载器在小程序的 jar 中找不到类

> ID：872905
> 
> 赞同：4
> 
> 时间：2009-05-16T17:52:58.570
> 
> 标签：java, applet, classloader

*我开始问这个问题，然后在提交之前想出了答案。无论如何，我决定发布这个问题，以便遇到同样问题的其他人能够从我的错误中吸取教训。*

* * *

我遇到了一个小程序（实际上是一个[JApplet](http://java.sun.com/javase/6/docs/api/javax/swing/JApplet.html)）无法实例化与小程序相同的 jar 中包含的另一个类的问题。我在 Java 控制台上看到的异常是：

```
线程“线程 applet-com.company.program.cm.hmi.MediatorApplet-1”中的异常 java.lang.NoClassDefFoundError: com/company/program/cm/cs/JDataStore
    在 com.company.program.cm.hmi.MediatorApplet.getMediator(MediatorApplet.java:63)
    在 com.company.program.cm.hmi.MediatorApplet.init（MediatorApplet.java:49）
    在 sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run（未知来源）
    在 java.lang.Thread.run（未知来源）
引起：java.lang.ClassNotFoundException：com.company.program.cm.cs.JDataStore
    在 sun.plugin2.applet.Applet2ClassLoader.findClass（未知来源）
    在 java.lang.ClassLoader.loadClass（未知来源）
    在 java.lang.ClassLoader.loadClass（未知来源）
    在 java.lang.ClassLoader.loadClassInternal（未知来源）
    ... 4 更多
引起：java.io.IOException：打开HTTP连接失败：http://localhost:8080/TransportHMI/pages/com/company/program/cm/cs/JDataStore.class
    在 sun.plugin2.applet.Applet2ClassLoader.getBytes（未知来源）
    在 sun.plugin2.applet.Applet2ClassLoader.access$000（未知来源）
    在 sun.plugin2.applet.Applet2ClassLoader$1.run（未知来源）
    在 java.security.AccessController.doPrivileged（本机方法）
    ... 8 更多

```

我知道`JDataStore`该类包含在 jar 中。如果我使用列出的内容，`jar tvf CM_Library.jar`我可以看到它在正确的包下。但是，上面的链接异常让我相信类加载器没有在存档中搜索`JDataStore`，而是在 Web 服务器上寻找 JDataStore.class 文件。为什么是这样？类加载器知道从 jar 加载 MediatorApplet 类，为什么它不检查 JDataStore 呢？如果我没有在小程序标签上正确指定参数，我也会在此处包括：

```
<applet id="mediator-applet"
        width="0"
        height="0"
        codebase="./"
        archive="CM_Library.jar"
        code="com.company.program.cm.hmi.MediatorApplet">
</applet> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T17:54:26.630

[通过查看针对相关问题](https://stackoverflow.com/questions/698890/applet-fails-to-load-class-from-jar/699031#699031)发布[的建议](https://stackoverflow.com/questions/698890/applet-fails-to-load-class-from-jar/699031#699031)找到了答案。埃迪的回答并没有解决那个特定的问题，但它确实为我提供了解决方案。

我的问题不是特别明显的是 JDataStore 类继承自另一个包含在不同 jar 中的类。几个月来我还没有处理 JDataStore 的实现细节，所以我完全忘记了它的父类 org.json.simple.JSONObject 不在 CM_Library.jar 中，而是在 json_simple-1.0 .2.jar。修复相当简单，只需将丢失的 jar 复制到代码库目录并将丢失的 jar 添加到 applet 标记`archive`属性中以逗号分隔的存档列表中：

```
<applet id="mediator-applet"
        width="0"
        height="0"
        codebase="./"
        archive="CM_Library.jar, json_simple-1.0.2.jar"
        code="com.company.program.cm.hmi.MediatorApplet">
</applet> 
```

这修复了错误。异常消息不是特别有用。当实际问题是它无法为所请求的类加载超类时，它会让您相信它根本找不到该类。

# windows - Delphi：如何使用驱动器号以编程方式弹出 CD

> ID：872907
> 
> 赞同：2
> 
> 时间：2009-05-16T17:53:37.243
> 
> 标签：windows, delphi

我试过这段代码：

```
uses MMSystem;

mciSendString('Set cdaudio door open wait', nil, 0, handle);

mciSendString('Set cdaudio door closed wait', nil, 0, handle); 
```

但没有效果。我听说这不适用于所有系统。

我正在尝试在 Windows XP 上弹出一个驱动器，并希望通过驱动器号指定驱动器（对于具有多个驱动器的系统是必需的）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-16T20:12:10.107

这是使用*DeviceIOControl()* API 函数的代码，适用于 Windows XP（使用 Delphi 5 编译和测试）：

```
function DeviceIOControlHelper(ADeviceHandle: THandle;
  ADeviceIOControlCode: DWORD): boolean;
var
  BytesReturned: Cardinal;
begin
  Result := DeviceIOControl(ADeviceHandle, ADeviceIOControlCode,
    nil, 0, nil, 0, BytesReturned, nil);
end;

function SetDriveDoorOpen(ADriveLetter: char; AValue: boolean): boolean;
const
  FILE_DEVICE_FILE_SYSTEM = 9;
  FILE_ANY_ACCESS = 0;
  FILE_READ_ACCESS = 1;
  METHOD_BUFFERED = 0;
  IOCTL_STORAGE_BASE = $2D;

(*
#define CTL_CODE( DeviceType, Function, Method, Access ) (                 \
    ((DeviceType) << 16) | ((Access) << 14) | ((Function) << 2) | (Method) \
*)

//  FSCTL_LOCK_VOLUME = CTL_CODE(FILE_DEVICE_FILE_SYSTEM, 6,
//                               METHOD_BUFFERED, FILE_ANY_ACCESS);
  FSCTL_LOCK_VOLUME = (FILE_DEVICE_FILE_SYSTEM shl 16)
                      or (FILE_ANY_ACCESS shl 14)
                      or (6 shl 2) or METHOD_BUFFERED;
//  FSCTL_DISMOUNT_VOLUME = CTL_CODE(FILE_DEVICE_FILE_SYSTEM, 8,
//                                   METHOD_BUFFERED, FILE_ANY_ACCESS);
  FSCTL_DISMOUNT_VOLUME = (FILE_DEVICE_FILE_SYSTEM shl 16)
                          or (FILE_ANY_ACCESS shl 14)
                          or (8 shl 2) or METHOD_BUFFERED;
//  IOCTL_STORAGE_EJECT_MEDIA = CTL_CODE(IOCTL_STORAGE_BASE, 0x0202,
//                                       METHOD_BUFFERED, FILE_READ_ACCESS);
  IOCTL_STORAGE_EJECT_MEDIA = (IOCTL_STORAGE_BASE shl 16)
                              or (FILE_READ_ACCESS shl 14)
                              or ($0202 shl 2) or METHOD_BUFFERED;
//  IOCTL_STORAGE_LOAD_MEDIA = CTL_CODE(IOCTL_STORAGE_BASE, 0x0203,
//                                      METHOD_BUFFERED, FILE_READ_ACCESS);
  IOCTL_STORAGE_LOAD_MEDIA = (IOCTL_STORAGE_BASE shl 16)
                              or (FILE_READ_ACCESS shl 14)
                              or ($0203 shl 2) or METHOD_BUFFERED;
var
  DriveCmdStr: string;
  DriveHandle: THandle;
begin
  Result := FALSE;
  DriveCmdStr := Format('\\.\%s:', [ADriveLetter]);
  DriveHandle := CreateFile(PChar(DriveCmdStr), GENERIC_READ, FILE_SHARE_WRITE,
    nil, OPEN_EXISTING, 0, 0);
  if DriveHandle <> INVALID_HANDLE_VALUE then begin
    if AValue then begin
      Result := DeviceIOControlHelper(DriveHandle, FSCTL_LOCK_VOLUME)
        and DeviceIOControlHelper(DriveHandle, FSCTL_DISMOUNT_VOLUME)
        and DeviceIOControlHelper(DriveHandle, IOCTL_STORAGE_EJECT_MEDIA);
    end else
      Result := DeviceIOControlHelper(DriveHandle, IOCTL_STORAGE_LOAD_MEDIA);
    CloseHandle(DriveHandle);
  end;
end; 
```

省略了错误处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T18:00:30.970

```
 uses ComObj;

function EjectDrive(const ADriveLetter: string): Boolean;
var
  WMP: Variant;
  CDROMs: Variant;
  Drive: Variant;
begin
  WMP := CreateOleObject('WMPlayer.OCX.7');
  CDROMs := WMP.CDROMCollection;
  Drive := CDROMs.GetByDriveSpecifier(ADriveLetter + ':');
  Drive.Eject;
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  EjectDrive('Q');
end; 
```

编辑：如您所见，我没有编写任何错误处理代码。如果指定了无效驱动器，此代码将引发异常。

# sql - 如何在同一查询中从不同表中检索相似的行？

> ID：872922
> 
> 赞同：2
> 
> 时间：2009-05-16T17:58:58.510
> 
> 标签：sql, mysql

假设我有两个或多个填充了用户的表，我想在同一个查询中从这些表中检索所有用户。

表共享一些列，那些具有相同名称的列是我要检索的列。

就像是：

```
SELECT name, age FROM users1;
SELECT name, age FROM users2;
etc. 
```

注意：这只是一个例子，并不是真正的问题。我无法将这些表合二为一。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T17:59:50.877

您可以使用[UNION](http://dev.mysql.com/doc/refman/5.0/en/union.html)：

> UNION 用于将多个 SELECT 语句的结果组合成一个结果集。
> 
> 第一个 SELECT 语句中的列名用作返回结果的列名。在每个 SELECT 语句的相应位置列出的选定列应具有相同的数据类型。

一个例子：

```
mysql> SELECT 1 as ColumnA,'a' as ColumnB
    -> UNION
    -> SELECT 2, 'b'
    -> UNION
    -> SELECT 3, 'c';
+---------+---------+
| ColumnA | ColumnB |
+---------+---------+
|       1 | a       |
|       2 | b       |
|       3 | c       |
+---------+---------+
3 rows in set (0.05 sec) 
```

另请注意：

> UNION 的默认行为是从结果中删除重复的行。可选的 DISTINCT 关键字除了默认值之外没有任何作用，因为它还指定重复行删除。使用可选的 ALL 关键字，不会发生重复行删除，结果包括所有 SELECT 语句中的所有匹配行。

一个例子：

```
mysql> SELECT 1 as x
    -> UNION
    -> SELECT 1;
+---+
| x |
+---+
| 1 |
+---+
1 row in set (0.00 sec)

mysql> SELECT 1 as x
    -> UNION ALL
    -> SELECT 1;
+---+
| x |
+---+
| 1 |
| 1 |
+---+
2 rows in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T18:18:56.823

您可以使用`union`or `union all`，具体取决于您想要的行为：

```
select name, age from users1
union
select name, age from users2
union
select name, age from users3 
```

或者：

```
select name, age from users1
union all
select name, age from users2
union all
select name, age from users3 
```

不同之处在于`union`删除重复项，而`union all`没有。

如果您知道没有重复项，则应该使用`union all`这样数据库就不必进行额外的尝试查找重复项的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T18:01:09.690

尝试

```
SELECT name, age FROM users1
UNION
SELECT name, age FROM users2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T18:23:02.927

另请注意，“联合所有”将比“联合”快得多。

# java - 在 Java 类路径中包含 XML 配置的好习惯？

> ID：872927
> 
> 赞同：38
> 
> 时间：2009-05-16T18:01:16.240
> 
> 标签：java, spring

我的应用程序由一些 Spring XML 配置文件配置。

在 Java 中将 XML 文件包含在类路径中并使用类路径在我的应用程序中引用它们是一种好的做法吗？

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2009-05-16T18:21:28.907

我通常先查看系统属性，然后查看类路径。所以：

```
java -DconfigFile=/filelocation/file.xml 
```

可以读作：

```
String propfile = System.getProperty(configFile);
if (propfile != null) {
 // read in file
  new File(propfile);
 ...
} else {
  // read in file from classpath
  getClass.getResource("/configfile.xml")
} 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-05-16T18:07:01.377

很高兴能够以两种方式配置它 - 直接作为文件，或者通过类路径上的资源（可能在 jar 文件中也可能不在 jar 文件中）。这给了你很大的灵活性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T18:16:39.683

我同意之前的海报 (+1) - 有一个选项，以防有一天你需要它。但是，有一个问题。如果这种强大的工具落入坏人之手，你可能会让自己非常头疼。spring上下文文件和java类没有太大区别，就是一个代码。所以，看看谁是你的用户。如果你没有做好准备，一个过分热情的 QA 大师可能会让你的生活变得悲惨。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T06:25:45.097

我倾向于将 XML 配置文件放入类路径中，并使用 a[`PropertyPlaceholderConfigurer`](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/PropertyPlaceholderConfigurer.html)等（取决于实际要求）将与适应（例如，不同环境）相关的配置公开到外部属性文件中。

创建配置文件的一种好方法是为每个环境提供具有一组设置的属性文件，并让管理员通过提供系统属性来选择所需的文件，然后将其值转换为属性文件查找。有关详细信息，请参阅 API 文档[`PropertyPlaceholderConfigurer`](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/PropertyPlaceholderConfigurer.html)。

# xss - 防止 XSS 攻击

> ID：872929
> 
> 赞同：6
> 
> 时间：2009-05-16T18:01:52.603
> 
> 标签：xss

我正在创建一个网页，用户可以在其中交互并在远程计算机上执行基本的文件系统操作（创建文件/目录、删除文件/目录、导航文件系统）。该网页是基本的 HTML（UTF-8 编码）和 Javascript。我需要让这个网页 XSS 证明。

使用Javascript（输出百分比编码的十六进制值）转义用户输入中的所有非字母数字字符（以防止基于DOM的XSS）和文件名信息（以防止存储的XSS）就足够了吗？

我基本上只将字母数字输入列入白名单。此外，由于我使用的是百分比编码的十六进制值，我假设不应该存在 UTF 编码漏洞。

谁能想到这个机制中的任何安全漏洞？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T18:23:41.040

使用 javascript（我认为你在说什么）进行转义似乎不太安全。它在用户机器上运行，他们可以通过一些努力绕过转义机制。

您尝试做的事情听起来不错，但您需要在服务器端进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T20:11:10.953

几点注意事项：

*   正如@Alo 所说，这应该在服务器端完成，以防止攻击者完全绕过您的 javascript 并将恶意输入直接发送到服务器。但是，正如您所指出的，这应该（在某些情况下）也在客户端完成，以防止基于 DOM 的 XSS。
*   您提到该页面是 UTF-8，您需要使用元标记、HTTP 标头等强制执行此操作。否则，您很容易受到 UTF-7 攻击。
*   空格 - 是不是字母数字？（有些包括...）在某些情况下，仅使用空格和字母，就可以进行全面的 XSS 攻击。

[在我对HTML 编码是否可以防止各种 XSS 攻击的](https://stackoverflow.com/questions/53728/will-html-encoding-prevent-all-kinds-of-xss-attacks/70222#70222)回答中查看更多信息？ 你会在那里找到你需要知道的一切。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T20:20:23.100

补充其他观点的说明：

确保正确使用 GET 和 POST，因为这是许多网站上最简单的安全漏洞。

如果用户输入将触发对数据库的任何更改，请确保使用 POST。

如果您正在检索要显示的信息，则只有用户 GET。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T18:06:12.720

这*听起来很*安全，而且可能是，但有一个问题。只有正确*实施*它才有效。太容易出错了。如果你想这样做，那没关系，但我建议使用一些已经测试过的库来做到这一点，而不是自己动手。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T18:21:27.033

编码是一件好事。最大的潜在风险是您如何处理数据以及是否/何时解码/显示数据。如果您解码用户输入并显示它，解码数据，那么您可能会遇到问题。

如果您没有迫切需要支持在潜在 XSS 漏洞方面风险更大的字符（例如 '<'、'>'、';' 等），那么我认为将这些字符列入黑名单也是合理的。这样，如果您解码和显示数据，您就不会潜在地表达 XSS 问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T18:34:20.123

防御 XSS 的基本方法是尽可能使用正则表达式来验证输入并对*所有*输出进行编码。编码输出可能很棘手，因此最好使用库。您的应用程序的至少一个重要输入是文件名，因此您需要一个正则表达式来匹配目标操作系统的任何有效文件名。仅接受字母数字输入将使您的应用无法处理常见操作系统上的许多文件名。我不明白为什么使用 %hex 值会有任何好处。没有理由不能以这种方式对恶意脚本进行编码。同一个脚本可以有许多有效的 utf-8 表示。您需要阅读更多关于反 XSS 编码实践的背景知识。谷歌 OWASP 供参考。

# php - PHP 5.2 类虚拟静态方法

> ID：872931
> 
> 赞同：4
> 
> 时间：2009-05-16T18:02:47.703
> 
> 标签：php, static, virtual

这是我的情况：我有一个看起来像这样的 PHP 基类：

```
class Table {
  static $table_name = "table";
  public function selectAllSQL(){
    return "SELECT * FROM " . self::$table_name;
  }
} 
```

还有一个像这样的子类：

```
class MyTable extends Table {
  static $table_name = "my_table";
} 
```

不幸的是，当我这样做时：

```
MyTable::selectAllSQL() 
```

我得到：

```
"SELECT * FROM table" 
```

而不是我想要的结果，

```
"SELECT * FROM my_table" 
```

看起来这可以在 php 5.3 中使用[后期静态绑定](http://webreflection.blogspot.com/2009/02/php-static-for-self-what-else-for.html)来完成，但是有什么方法可以在 PHP 5.2.x 中完成这种行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T18:07:33.993

并不真地。这就是 LSB 被添加到 5.3 的原因。在这个地方，实例化是要走的路，还有一个单例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-13T11:37:15.700

叶晚静态绑定是要走的路。也许您现在使用的是 PHP 5.3。以下是它的外观：

改变

```
class Table {
  static $table_name = "table";
  public function selectAllSQL(){
    return "SELECT * FROM " . self::$table_name;
  }
} 
```

至

```
class Table {
  static $table_name = "table";
  public function selectAllSQL(){
    return "SELECT * FROM " . static::$table_name;
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T14:38:36.923

实例化原因类别是一种选择！

```
<?php
abstract class Table {
    protected $table_name;
    public function selectAllSQL() {
        return 'SELECT * FROM ' . $this->table_name;
    }
}

class MyTable extends Table {
    protected $table_name = 'my_table';
}

$my_table = new MyTable();
echo $my_table->selectAllSQL(); // Will output "SELECT * FROM my_table" 
```

如果你必须保持静态而不是重新实现是 PHP < 5.3 的唯一方法：

```
<?php
abstract class Table {
    protected static $table_name = 'table';
    public static function selectAllSQL() {
        return self::selectAllSQLTable(self::$table_name);
    }
    public static function selectAllSQLTable($table) {
        return 'SELECT * FROM ' . $table;
    }
}

class MyTable extends Table {
    protected static $table_name = 'my_table';
    public static function selectAllSQL() {
        return self::selectAllSQLTable(self::$table_name);
    }
}

class MyOtherTable extends Table {
    protected static $table_name = 'my_other_table';
    public static function selectAllSQL() {
        return self::selectAllSQLTable(self::$table_name);
    }
}

echo MyTable::selectAllSQL(); // Will output "SELECT * FROM my_table"
echo MyOtherTable::selectAllSQL(); // Will output "SELECT * FROM my_other_table" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T18:04:53.813

实例化类是一种选择吗？

# dns - 通过修改我的 DNS 记录，如何让“test.mydomain.com”解析为 XXX.XXX.XXX.XXX:8080？

> ID：872940
> 
> 赞同：5
> 
> 时间：2009-05-16T18:07:32.450
> 
> 标签：dns

首先，这是一个编程问题，因为我正在尝试设置一个与生产服务器一起运行的测试/QA 服务器。

其次，是的，我应该在 Serverfault 上发布此内容，但我尝试使用三个不同的 OpenID 提供程序登录，每次我收到错误消息说此提供程序在 Beta 中不受支持（即使图标就在那里）。要发布问题，您必须登录。

呼，好吧。

目前，我有一条**A**记录，其中*@host*指向我的服务器 IP，比如说*111.11.11.11*。然后我有一个**CNAME**记录，其中*www*主机指向我**的 A**记录中的*@ 。*

 **问题是我在*111.11.11.11:8080*上运行了不同的 Web 服务器。我想创建另一个**CNAME**，以便*测试*主机指向类似*@:8080*

总结一下：

*www.mydomain.com*应解析为*111.11.11.11*

*test.mydomain.com*应解析为*111.11.11.11:8080*

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T18:12:24.013

DNS A（地址）记录没有端口号。所以，不，**那**是不可能的。

可以为同一台机器设置另一个 IP（例如 111.11.11.12）并让 test.mydomain.com 解析它。然后你的第一台服务器应该只监听第一个 IP，第二个只监听第二个。

PS 有允许指定端口的 DNS SRV 记录，但是浏览器不使用它们，唉。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T18:13:58.143

DNS 仅解析为 IP 地址。但是，如果您将 DNS 解析为 Apache 所在的 IP，那么您可以使用 mod_proxy 将请求代理到端口 8080 上的应用程序服务器。请参阅此链接。

[http://www.jboss.org/community/wiki/UsingModproxyWithJBoss](http://www.jboss.org/community/wiki/UsingModproxyWithJBoss)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T18:09:33.583

不，DNS A 记录仅将主机名解析为 IP 地址，它不知道任何有关端口号的信息。

但是您始终可以根据主机标头配置您的网络服务器以提供不同的页面（因此，使使用端口 8080 变得不重要）。我可以给你详细信息，但我需要知道你正在使用的网络服务器。

**编辑：**如果您使用的是 tomcat，您应该添加另一个 Host 指令，详细信息可以在这里找到：http: [//tomcat.apache.org/tomcat-4.1-doc/config/host.html](http://tomcat.apache.org/tomcat-4.1-doc/config/host.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T18:09:59.700

不。

您不能在 dns 配置中定义端口。这不是它的目的。这只是关于 ip -> 主机和反向。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T18:10:41.070

不，这是不可能的。*DNS控制域*指向哪个IP ，与端口无关。您可能可以设置防火墙规则来实现您想要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T18:41:43.833

您可以使用 Dyndns.org [webhop](https://www.dyndns.com/services/webredirect/)服务来解决这种情况。最多可免费使用 5 台主机。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-30T16:10:55.460

正如鲍里斯所说，这是不可能的。

但是您可以使用某些服务，例如 SIP。

这涉及在您的 dns 上使用 SRV 记录。但恐怕普通的网络浏览器会忽略这一点。

更多信息：[http ://en.wikipedia.org/wiki/SRV_record](http://en.wikipedia.org/wiki/SRV_record)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-14T01:08:18.100

不可能。

但是您可以将另一个 IP 添加到您的服务器。这样您就可以将您的服务器绑定到同一台机器上的不同 IP 地址。DNS当然会指向不同的IP。

这是一个很好的解决方案，特别是如果您使用的是 ipv6。提供商通常会分配一大堆 ipv6 地址，例如 /64，因此您可以在每个地址上绑定不同的服务器。:)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-10-10T22:46:19.643

可以使用 Apache 虚拟主机。我不知道确切的语法，但我知道 rails 是这样工作的。它是这样的：

```
 <virtualhost *:8080>
 servername subdomain.domain.com
 serveralias subdomain.domain.com
 DocumentRoot /path/to/public
 </virtualhost> 
```

重启阿帕奇。

# c - 为什么全局变量不好，在单线程、非操作系统、嵌入式应用程序中

> ID：872943
> 
> 赞同：34
> 
> 时间：2009-05-16T18:09:05.520
> 
> 标签：c, embedded, global-variables

我看到的大多数使用全局变量的反对意见都是有道理的，因为它们涉及多线程、线程安全等问题。

但是在一个小的、单线程的、非操作系统的情况下，你有什么反对意见？就我而言，如果重要的话，我正在用“C”编写我的嵌入式系统。我也是该产品的唯一开发人员。

为什么消除全局变量会使我的代码更好？

（在阅读了几个回复后，我意识到我也应该指出这个系统没有动态内存分配（例如 malloc）。所有内存都是在编译时静态分配的。）

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-16T18:15:00.013

它不会。

全局变量的两个基本问题只是使命名空间混乱，以及“没有人”可以“控制”它们这一事实（因此可能与多个线程发生冲突和冲突）。

就像几乎所有其他计算机编程习语一样，“全局变量很糟糕”是一个指导方针，而不是一个硬性规定。在制定这些“规则”时，最好不要简单地死记硬背地采用规则，以了解规则创建背后的环境和动机。不要盲目地接受它们。

在您的情况下，您似乎了解系统的性质和围绕规则的论点，并决定它不适用于这种情况。你是对的，它没有。

所以，不要担心。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-16T18:24:16.670

全局变量不一定是坏的，就像宏不一定是坏的一样，浓缩铀也不一定是坏的。只要您对给定设计选择的利弊做出有意识的决定，就应该没问题。

一些*反对*全局变量的论点是：

1.  它们违反了良好的面向对象设计
2.  它们使您的代码难以进行单元测试，因为您无法在不设置代码期望看到的所有全局变量的情况下测试单个代码块
3.  它们增加了代码中的耦合：一个代码块中的操作可能会通过共享全局变量以不可预知的方式影响另一块代码中的内容

全局变量*的*一些论据：

1.  它们使在许多功能之间共享单个资源变得容易
2.  它们可以使代码更易于阅读

如果在您的设计中，全局变量是有意义的，并且可用于使您的代码更易于阅读或更易于维护，而不会让您自己陷入随机错误和测试难题，那么请务必使用它们。

我为嵌入式微控制器编写了很多 C 代码，并且一直使用全局变量。在这样一个僵化的系统中，全局变量是有意义的。我知道潜在的缺点，但我已经分析了优缺点，并编写了我的代码以防范主要的陷阱。

底线：没有硬性规定。只需根据您拥有的最佳信息，为您的特定项目或平台做出最佳决策。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-16T18:23:27.263

这是一篇很好的文章，说明了[为什么全局变量不好](http://c2.com/cgi/wiki?GlobalVariablesAreBad)

**为什么在不必要的时候应该避免使用全局变量？**

> 非局部性——当单个元素的范围有限时，源代码最容易理解。全局变量可以被程序的任何部分读取或修改，因此很难记住或推理每种可能的用途。没有访问控制或约束检查——程序的任何部分都可以获取或设置全局变量，并且任何关于其使用的规则都可以很容易地被破坏或遗忘。
> 
> 隐式耦合——具有许多全局变量的程序通常在其中一些变量之间存在紧密耦合，以及变量和函数之间的耦合。将耦合的项目分组为有凝聚力的单元通常会导致更好的程序。
> 
> 内存分配问题——某些环境的内存分配方案使得全局变量的分配变得棘手。在“构造函数”具有分配以外的副作用的语言中尤其如此（因为在这种情况下，您可以表达两个全局变量相互依赖的不安全情况）。此外，当动态链接模块时，可能不清楚不同的库是否有自己的全局实例或全局是否共享。
> 
> 测试和限制 - 使用全局变量的源代码更难测试，因为无法在运行之间轻松设置“干净”环境。更一般地，使用任何类型的未明确提供给该源的全球服务的源由于同样的原因而难以测试。

添加全局变量非常容易。很容易养成声明它们的习惯。它比思考一个好的设计要快得多。

全局变量并不像你想象的那么糟糕，只是在不必要的时候应该避免使用它们。全局变量可以很好地用于将在整个程序中使用的变量，确保您始终牢记您必须跟踪该变量发生变化的位置；但是对于那些往往只在程序的有限部分中使用的变量来说，避免让它成为全局变量是一个很好的理由。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-16T18:13:14.683

因为它最大限度地减少了耦合。您的系统现在可能很小，但如果您继续工作，结果可能不是。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-18T09:34:35.953

在用 C 编写的小型嵌入式应用程序中，全局变量是必需的。例如，您需要使用全局变量来在中断服务程序和另一个模块之间传递信息。这些是一些技巧，可以帮助您在嵌入式应用程序中有效地使用全局变量：

*   区分静态变量和全局变量。静态变量可以在同一个 C 文件中的所有函数中使用。它们相当于 C++ 类中的私有成员。在 C 语言中，您必须自己完成编译器的工作。使用 static 关键字来避免在模块外部意外使用变量并明确其范围。您可能希望在变量前面加上模块名称。

*   遵循全局变量的命名约定（许多 C 文件使用）。清楚地表明它们是全球性的。

*   如果您需要大量全局变量，请考虑将它们捆绑在一个结构中。

*   必要时使用 volatile 关键字。如果全局变量被 ISR 修改，则需要这样做。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-07-19T20:05:00.850

使用全局变量的代码更难维护。因为维护者必须先找到系统中变量的每一次使用，然后才能准确地知道变量的作用。由于这会减慢维护速度，因此应尽可能避免。就是这样`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-16T18:27:08.410

这是范围的问题。我们有喜欢制作全局变量来执行本地概念的开发人员。它使这些变量的使用更难跟踪，因此在使用它们时更容易出错。

你也可以把你的钱包放在你的前廊上，但是你对谁在访问它的控制要少得多。

话虽如此，全局变量有一些有效的用途，但就像任何其他值得遵循的规则一样。这是例外而不是正常情况。他们非常现有的指出，他们有一个用途。

如果您决定使用全局变量，请尝试对它们进行良好的注释并给它们起好名字。当人们制作像“bool bIsFound”这样的全局变量时，我真的很困扰。

我们强调在代码审查中评估每个新的全局变量，看看是否有更好的方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-16T18:23:18.560

简短的回答是，全局变量在历史上一直是微妙错误的来源。但是后来（戴上我的函数式程序员的帽子）*所有*变量都成为了细微错误的来源。

基本上，全局变量意味着您无法使用变量的值查看一段代码，并且在不知道过去设置该变量值的所有其他代码段的情况下知道它将做什么。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-16T19:22:01.913

在您的情况下，全局变量*可能还*不错。另一方面，你需要它们吗？使用它们你能得到什么？

即使在您的情况下，全局变量也使弄清楚应用程序的状态变得更加困难。这可能会阻碍调试，并可能导致细微的错误。

全局变量也使测试更加困难。它们添加了对您可能希望在测试期间避免的外部代码的依赖。

但最后，在用 C 编程时，全局变量是很难避免的。在更高级的语言中，全局变量在大多数情况下是毫无意义的。使用它们不会使您的代码更清晰。

在 C 语言中，有很多情况下全局变量只是最好、最简单和最干净的解决方案。

因此，在您的情况下，请根据具体情况进行处理。您可能最终会拥有一些全局变量，但不要将变量设为全局变量，除非您确定它实际上是最好的解决方案，不仅是现在，而且在一年后您必须调试代码或制作应用程序时多线程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-16T18:13:23.683

对于全局变量，通常很难知道它们在何处或何时更新，以及哪些代码更新了该变量。无法控制谁可以更新它或以何种方式更新变量。

如果你的应用程序很小，跟踪起来并不难——但是你的应用程序变得越大，你拥有的全局变量越多，应用程序代码就越像意大利面条。

简而言之 - 它成为维护和调试的噩梦。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-16T18:13:45.057

问题是跟踪你的最后一个代码的哪一点修改了全局的状态。通常，您希望将变量保持在尽可能小的范围内，以便您可以更轻松地推理它们。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-16T18:14:23.947

想到的一个原因是未来的证明。您现在可能是您产品的唯一开发人员，但可以想象其他人会在以后维护它。当然，在您的特定情况下，这可能不是真的。

虽然您的产品现在可能又小又整齐——使用全局变量不会使整体设计复杂化或损害可读性——谁说产品不会变得更大或不会被合并到另一个产品中？上帝禁止另一个维护者/开发者来解决你对全局变量的使用。

当然，您现在可以决定使用全局变量，当项目看起来变得更加复杂时，您可以返回并重写其中的一部分，但是为什么要强迫自己做这些额外的工作呢？你更有可能（如果你还记得全局变量的话）认为做这项工作太费力了，然后放手设计：此时你有麻烦了！

*所以*，省去自己的头痛，着眼于未来的设计。现在所需的工作可能会使将来的生活更轻松。

如果这不能说服你，想象一下作为这个项目的开发人员，他们的代码在最高法院面前被发现有错误和错误的编程实践：有缺陷的[呼吸测试代码反映了源代码审查的重要性](http://arstechnica.com/tech-policy/news/2009/05/buggy-breathalyzer-code-reflects-importance-of-source-review.ars)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-16T18:18:55.433

将大多数变量保持在本地并缩小其范围有助于促进更好的编程实践。它还降低了错误地更改变量和必须通过函数来​​寻找意外或不明显后果的风险。我相信它还使代码更易于阅读和维护，因为与特定代码部分相关的大多数变量都是在附近定义和初始化的。否则，我似乎一直在回顾定义所有 gobals 的代码部分。我确实使用了一些全局变量，但主要用于将配置信息传递给子模块。

# jquery - outerHeight() 和内部图片

> ID：872961
> 
> 赞同：0
> 
> 时间：2009-05-16T18:16:11.417
> 
> 标签：jquery, html, css

我在第一次加载带有 outerHeight 的页面时遇到问题。

outerHeight() 返回的值是 27 的倍数。

jQuery

```
$('.entries').each(function(r) {    
$(this).attr("value", $(this).outerHeight()+15);
}) 
```

HTML：

```
<div class="entries">
    <div class="container_entrie">
    <span class="meta"><span class="title">Daily Inspiration #128</span> 
   <span class="date">- april 10th 2009 </span></span>      
    <img src="images/content/four.png" />
    </div>
</div> 
```

CSS：

```
.entries {  
position:absolute;  
overflow:hidden;
cursor:pointer;
width:200px;
-moz-border-radius: 3px;
-webkit-border-radius: 3px;
padding:6px;
background-color:#171717;   
}

.meta{ 
position:absolute; 
bottom:0; float:left; width:190px; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right:5px;  font-size:11px; font-weight:bold; line-height:14px;
background-color:#000; 
/* for IE */
filter:alpha(opacity=70);
/* CSS3 standard */
opacity:0.7;
border-top:1px solid #000;
}           
.meta span.title{color:#FFF; }
.meta span.date{color:#999999; font-weight:normal;}
.container_entrie{position:relative; width:200px; float:left; overflow:hidden; } 
```

并且所有内容都已加载，刷新后一切都很好。

所以我想知道 container_entrie 中的图像是否不是问题？

感谢您的帮助 =)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T08:31:49.723

你的javascript是从哪里调用的？除非您在图像上设置高度，否则如果将其放入`$(...)`（$(document).ready 的简写）就会出现问题。尝试将其放入`$(window).load(...`) 中，看看是否有帮助。加载**所有**内容后触发，Ready 是一个伪事件，当 dom 准备好被弄乱时触发。

# crystal-reports - Crystal Report - 服务器安装后避免登录

> ID：872970
> 
> 赞同：0
> 
> 时间：2009-05-16T18:19:27.447
> 
> 标签：crystal-reports

如何修复 Crystal Report 以直接从数据源更新。
我正在使用数据集到 rpt；在运行时将报告安装到另一台 PC 后，加载报告时会显示用户名和密码。
实际上，我通过打开报告并从数据集中进行验证，在 PC 中手动解决。

有任何想法吗 ？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-09T02:23:43.090

确保您的 .Net 对象和数据集具有有效的 xsd。

# python - 初始化（复杂）静态数据成员的 Pythonic 方式

> ID：872973
> 
> 赞同：19
> 
> 时间：2009-05-16T18:20:29.580
> 
> 标签：python, class

我有一个带有复杂数据成员的类，我想保持“静态”。我想使用一个函数初始化它一次。Pythonic 是这样的：

```
def generate_data():
    ... do some analysis and return complex object e.g. list ...

class Coo:
    data_member = generate_data()
    ... rest of class code ... 
```

该函数`generate_data`需要很长时间才能完成并返回在正在运行的程序范围内保持不变的数据。我不希望它在每次实例化类 Coo 时运行。

另外，为了验证，只要我不给`data_member`in分配任何东西`__init__`，它就会保持“静态”吗？如果 Coo 中的一个方法为`data_member`（假设它是一个列表）附加了一些值怎么办——这个添加是否可用于其余实例？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-16T18:27:32.247

你在所有方面都是对的。 `data_member`将被创建一次，并且可用于`coo`. 如果任何实例对其进行了修改，则该修改将对所有其他实例可见。

这是一个演示所有这些的示例，其输出显示在末尾：

```
def generate_data():
    print "Generating"
    return [1,2,3]

class coo:
    data_member = generate_data()
    def modify(self):
        self.data_member.append(4)

    def display(self):
        print self.data_member

x = coo()
y = coo()
y.modify()
x.display()

# Output:
# Generating
# [1, 2, 3, 4] 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-16T19:15:53.190

正如其他人回答的那样，您是对的-我将再添加一件需要注意的事情：例如，如果实例修改了对象`coo.data_member`本身

```
self.data_member.append('foo') 
```

然后其余实例可以看到修改。但是，如果你这样做

```
self.data_member = new_object 
```

然后创建一个新的*实例*成员，它覆盖类成员，并且只对该实例可见，其他实例不可见。差异并不总是很容易发现，例如`self.data_member += 'foo'`与`self.data_member = self.data_member + 'foo'`.

为避免这种情况，您可能应该始终将对象称为`coo.data_member`（而不是 through `self`）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-16T18:29:16.843

该语句`data_member = generate_data()`将只执行一次，当`class coo: ...`被执行时。在大多数情况下，类语句发生在模块级别，并在导入模块时执行。所以`data_member = generate_data()`当你第一次导入带有类的模块时只会执行一次`coo`。

类的所有实例都`coo`将共享`data_member`并可以通过写入来访问它`coo.data_member`。任何实例`coo.data_member`都将立即看到对 的任何更改。`coo`实例可以有自己的`data_member`属性。此属性可以通过键入来设置，`self.data_member = ...`并且仅对该实例可见。`data_member`仍然可以通过键入来访问“静态” `coo.data_member`。

# aop - 在 AspectJ 中对给定类型的任何参数提出建议

> ID：872977
> 
> 赞同：1
> 
> 时间：2009-05-16T18:22:56.860
> 
> 标签：aop, aspectj

有没有办法对任何具有给定类型参数的方法提出建议。我打算将它用于需要输入过滤的类。

举个例子：

```
@Filtered
class Unsafe {
    public void doStuff (String input) { ... }

    public void doMoreStuff (String input, int value, String name) { ... }
} 
```

我想编写适用于此类方法的任何字符串参数的建议，以便我可以用安全的转义版本替换它们的内容（以防止例如 SQL 注入）。

能不能写出这样的切入点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T18:27:11.203

由于您可以在不同的地方拥有多个字符串，我不知道您如何做到这一点，但是，两个类都应该调用将写入数据库的相同方法。此时，您可以使用环绕来更改字符串以使其安全并改为传递该字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T11:17:15.640

在我看来，您仍然需要知道是否存在所有采用 SQL 搅拌的方法的模式。

然后你可以在你的建议中检查方法的参数：

```
Object around() : PATTERN_FOR_METHODS_THAT_TAKES_IN_SQL_STRING {
    Signature sig = thisJoinPointStaticPart.getSignature();
    Object[] args = thisJoinPoint.getArgs();
    //Check the type of each object in the args, and re-format String type object

    return proceed();// Continue with the current joint-point method
} 
```

将**PATTERN_FOR_METHODS_THAT_TAKES_IN_SQL_STRING**替换为实际模式

# xml - 如何在 REST 中传递复杂的查询？

> ID：872984
> 
> 赞同：6
> 
> 时间：2009-05-16T18:25:47.353
> 
> 标签：xml, web-services, json, crud, rest

如果我理解正确，在休息风格中，每个查询（即每个资源上不修改资源状态的每个操作）都应该使用 get 方法在查询字符串中编码，根本没有正文。

我对吗？

好吧，我有几个应用程序通过由 Visual Basic 6 组件处理的 XML 消息与数据库通信。

查询的消息是这样的

```
<xml>
  <service>account</service>
  <resource>invoice</resource>
  <action>query</action>
  <parameters>
    <page>1</page>
    <page_len>10</page_len>
    <order>date</order>
    <fields>*</fields>
    <conditions>
      <date>2009-01-01..2009-01-31</date>
      <customer_id>24</customer_id>
    </conditions>
  </parameters>
</xml> 
```

现在我们正在重新设计我们的 XML 消息，我们希望以这样一种方式来实现，以便它们可以轻松地映射到 RESTful 接口。

在前面的示例中，我们需要“条件”标签以防止参数和条件之间发生冲突（即，如果我有一个名为“订单”、“页面”或类似名称的字段会发生什么......

我们虽然关于发送带有前缀的参数，比如

```
http://account/invoice/?_page=1&_page_len=10&_order=date&_fields=*&date=2009-01-01..2009-01-31&customer_id=24 
```

和 XML 会是这样的

```
[...]
    <_order>date</_order>
    <_fields>*</_fields>
    <date>2009-01-01..2009-01-31</date>
    <customer_id>24</customer_id>
[...] 
```

我们正在尝试为 crud 操作定义一些非常简单的 XML 格式，并且生成的 XML 可以很容易地映射到 rest 或 JSON。

您将如何在 REST 应用程序中映射这种查询？是否定义了一些标准？还是一些带有杂乱无章/ XML / JSON示例的页面？返回错误或嵌套数据集怎么样？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T18:57:07.697

恕我直言，为了使您的系统真正 RESTful，您必须重新考虑您将发送的所有消息/查询。

这部分：

```
<conditions>
  <date>2009-01-01..2009-01-31</date>
  <customer_id>24</customer_id>
</conditions> 
```

是棘手的部分。你还有什么其他条件？有很多吗？这个特殊的例子让我觉得您可以将发票视为客户的子资源。当我休息时，我总是尝试识别路径中的资源，如果查询仍然需要任何参数，我会将它们移动到查询字符串。所以我会写这样的东西：

```
GET /customers/24/invoices?start_date=2009-01-01&end_date=2009-01-31 
```

想想你的资源之间的关系。假设我们有资源类型 Foo 相关的资源类型 Bar 通过一对多关系。在这种情况下，您可以像这样询问这种关系：`GET /foo/123/bar`并添加查询字符串参数来过滤它。当您想要以涉及与其他资源的关系的方式过滤它时，问题就开始了。恕我直言，这意味着您的资源设计并不是真正的 RESTful。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T18:36:19.010

您需要对 xml 进行 url 编码才能传递它，但是，如果您将 xml 转换为 json，那么您可以传递该字符串，然后传递 json->xml 或 json->object 来处理它。这将使您能够传递更复杂的对象。

它并不完美，但有效。:)

# webserver - 开发 Web 服务器的技巧

> ID：872993
> 
> 赞同：10
> 
> 时间：2009-05-16T18:29:16.690
> 
> 标签：webserver, projects

在这里做了一些搜索之后，我发现几乎没有关于开发 Web 服务器的问题。

我这样做主要有两个原因。作为一个附带项目并了解有关开发服务器程序的更多信息。这不会变成一个可用的应用程序，更多的是一个学习工具

所以问题很简单。

*   你开发过网络服务器吗？（不管是什么语言）
*   你能提供什么陷阱和其他好的提示

欢迎链接到有用的网站，但不要链接到开源的工作项目，因为这是关于学习的过程。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-16T18:36:00.713

Web 服务器最初是一段极其简单的代码：

*   在端口 80 上打开 TCP/IP 套接字
*   虽然没有终止
    *   等待该套接字上的连接
    *   当有人向您发送 HTTP 标头时
        *   找到文件的路径
        *   将文件复制到套接字

所以代码的大纲很简单。

现在，您需要处理一些复杂性：

*   在最简单的代码版本中，当您与一个浏览器交谈时，所有其他浏览器都无法连接。您需要想出一些方法来处理多个连接。
*   能够发送比静态文件更多的东西通常很方便（尽管第一个 HTTP 服务器就是这样做的），因此您需要能够运行其他程序。

处理多个连接的可能性也相对容易，有多种可能的选择。

*   最简单的版本（同样，这是它最初的方式）是让监听端口 80 的代码为该连接设置一个特定的套接字，然后派生一个自身的副本来处理该连接。该进程一直运行到套接字关闭，然后终止。然而，这相对昂贵：一个分叉通常需要几十毫秒，所以这限制了你可以运行的速度。
*   第二种选择是创建一个轻量级进程——a/k/aa*线程*——来处理请求。

运行程序实际上也相当容易。通常，您定义一个 CGI 目录的特殊路径；具有通过该目录的路径的 URL 然后将路径名称解释为程序的路径。然后，服务器将使用 fork/exec 创建一个子进程，并将 STDOUT 连接到套接字。然后程序运行，将输出发送到 STDOUT，然后发送到客户端浏览器。

这是基本模式；Web 服务器所做的所有其他事情都只是为这个基本模式添加了装饰和附加功能。

以下是示例代码的其他一些来源：

*   [http://www.codeproject.com/KB/IP/Generic_TCP_IP_server.aspx](http://www.codeproject.com/KB/IP/Generic_TCP_IP_server.aspx)
*   [http://cs.baylor.edu/~donahoo/practical/CSockets/textcode.html](http://cs.baylor.edu/~donahoo/practical/CSockets/textcode.html)
*   [http://www.paulgriffiths.net/program/c/echoserv.php](http://www.paulgriffiths.net/program/c/echoserv.php)
*   [http://www.linuxhowtos.org/C_C++/socket.htm](http://www.linuxhowtos.org/C_C++/socket.htm)

* * *

它几乎没有你真正想要的，但*简单*来说很难从[http://www.commandlinefu.com击败](http://www.commandlinefu.com)[这个](http://www.commandlinefu.com/commands/view/71/serve-current-directory-tree-at-httphostname8000)：

> $ python -m SimpleHTTPServer

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-16T18:34:23.307

首先，请不要让它成为一个可用的项目 - 为 Web 服务器获得正确的安全性真的很难。

好的，请记住以下几点：

1.  接受连接的线程需要尽快移交给后台线程。
2.  您不能为每个连接都有一个线程 - 大量的您将用完您的线程限制。
3.  使用某种工作线程池来处理您的请求。
4.  确保在收到 HTTP GET 请求时清理 URL。所以我不能做类似 [http://localhost/../../Users/blah/](http://localhost/../../Users/blah/)的事情 来获得更高级别的访问权限。
5.  确保始终设置相关的内容和 mime 类型。

祝你好运——这是一份非常棒的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T18:33:54.523

网络等是相当标准的公平，所以不要太担心。（有几个“即时”，大多数任何语言的示例网络服务器。）

相反，专注于实际实现 HTTP 规范。你会惊讶于 a) 你不知道什么和 b) 有多少东西应该是符合 HTTP 的，实际上不是，但假装得很好。

然后你会惊叹于网络的工作原理。

使用完 HTTP 后，请享受尝试实现 IMAP 的乐趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T18:34:05.257

几年前我用 Python 写了一个轻量级的网络服务器，也是一个学习项目。

我能给出的最简单的建议，尤其是作为一个学习项目，是构建一个可以工作的核心，然后在此之上进行迭代设计。不要马上就瞄准月亮，从很小的地方开始，然后添加特征，完善并继续。我建议使用鼓励实验的工具，例如 Python，您可以在其中同时输入和测试代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T21:44:17.140

我 TAed 的课程有一个代理作业，所以我想我可以在这里有所启发。

所以，你最终会做很多标题更改，只是为了让你的生活更轻松。也就是说，HTTP/1.0 比 HTTP/1.1 更容易处理。您不想处理管理超时和保持活动以及类似的事情。每个事务一个连接是最简单的。

你会做很多很多的解析。在 C 中解析很难。我建议你编写一个类似的函数

```
int readline(char *buff, int maxLen) {
    while((c = readNextCharFromSocket(&s)) && c != '\n' && i < maxLen)
      buff[i++] = c;
    return i;
} 
```

并一次处理一行，仅仅是因为一次一行使用现有的 C 字符串函数是最简单的。此外，请记住行是 \r\n 分隔的，并且标题以 \r\n\r\n 终止。

主要的难点是解析，只要您可以读取文件，其他一切都会按预期工作。

对于调试，您可能希望打印出传递的标头，以便在出现问题时对其进行健全性测试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-08T20:55:33.960

[local-web-server](https://github.com/75lb/local-web-server)是一个用 node.js 编写的简单开发 Web 服务器的示例。它比它更可靠并且具有更多功能`python -m SimpleHTTPServer`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-16T18:31:35.590

我正在考虑启动同一个项目作为更好地学习 Python 的一种方式。有一个[BaseHTTPServer 类](http://docs.python.org/library/basehttpserver.html)是一个很好的起点。

这里有一些教程式的文章：[1](http://python.about.com/od/networkingwithpython/ss/PythonWebServer.htm) & [2](http://fragments.turtlemeat.com/pythonwebserver.php)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-03T03:26:31.980

我已经开发了一个使用 C 语言运行（Html 和 PHP）的 Web 服务器，它并不复杂你应该知道如何使用 TCP/IP 套接字、线程来处理多个请求、进程分叉（你需要创建一个孩子用于执行 php 命令行（我使用了 execvp））

我认为最困难的部分是在 C 语言中处理字符串并在命令行中发送 POST/GET 请求。

祝你好运

# c++ - 立即退出 C++ 中的“while”循环

> ID：872996
> 
> 赞同：15
> 
> 时间：2009-05-16T18:30:31.257
> 
> 标签：c++, while-loop, break

如何`while`立即退出循环而不走到块的末尾？

例如，

```
while (choice != 99)
{
    cin >> choice;
    if (choice == 99)
        //Exit here and don't get additional input
    cin>>gNum;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-05-16T18:32:09.037

使用休息？

```
while(choice!=99)
{
  cin>>choice;
  if (choice==99)
    break;
  cin>>gNum;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-16T18:44:07.010

```
cin >> choice;
while(choice!=99) {
    cin>>gNum;
    cin >> choice
} 
```

在这种情况下，你不需要休息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-16T18:32:25.247

使用*break*，例如：

```
while(choice!=99)
{
  cin>>choice;
  if (choice==99)
    break; //exit here and don't get additional input
  cin>>gNum;
} 
```

这也适用于*for*循环，并且是结束 switch 子句的关键字。更多信息[在这里](http://www.cppreference.com/wiki/keywords/break)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-16T18:32:21.830

`break;`.

```
while(choice!=99)
{
   cin>>choice;
   if (choice==99)
       break;
   cin>>gNum;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-16T18:43:21.913

是的，休息会起作用。但是，您可能会发现许多程序员在可能的情况下不喜欢使用它，而是使用条件 if 语句来执行循环中的其他任何事情（因此，不执行它并干净地退出循环）

这样的事情将实现您正在寻找的东西，而无需使用休息时间。

```
while(choice!=99) {
    cin >> choice;
    if (choice != 99) {
        cin>>gNum;
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T18:31:36.433

嗯，`break`？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T18:36:12.350

```
while(choice!=99)
{
  cin>>choice;
  if (choice==99)
    exit(0);
  cin>>gNum;
} 
```

相信我，这将退出循环。如果这不起作用，什么都不会。请注意，这可能不是您想要的...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-16T19:13:21.043

是的，我很确定你刚刚放了

```
 break; 
```

就在你想要它退出的地方

像

```
 if (variable == 1)
    {
    //do something
    }
    else
    {
    //exit
    break;
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-16T18:32:51.190

尝试

```
break; 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2011-10-08T15:34:00.917

您永远不应该使用 break 语句来退出循环。你当然可以这样做，但这并不意味着你应该这样做。这只是不好的编程习惯。更优雅的退出方式如下：

```
while(choice!=99)
{
    cin>>choice;
    if (choice==99)
        //exit here and don't get additional input
    else
       cin>>gNum;
} 
```

如果选择是 99，则没有其他事情可做并且循环终止。**************************