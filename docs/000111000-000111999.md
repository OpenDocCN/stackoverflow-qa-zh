# StackOverflow 问答 000111000-000111999

# apache-flex - 弹性网络服务客户端

> ID：111007
> 
> 赞同：3
> 
> 时间：2008-09-21T13:19:50.373
> 
> 标签：apache-flex, web-services

有没有人有任何有用的链接可用于使用 flex 使用 Web 服务？解决方案越简单越好

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T16:32:20.630

尝试[http://livedocs.adobe.com/flex/3/langref/mx/rpc/soap/mxml/WebService.html](http://livedocs.adobe.com/flex/3/langref/mx/rpc/soap/mxml/WebService.html)获取 SOAP 服务。您只需指定 WSDL 位置和事件处理程序并调用服务。

Flex Builder 3 还包含用于为 Web 服务创建代理的代码生成功能。 [http://livedocs.adobe.com/flex/3/html/help.html?content=data_4.html](http://livedocs.adobe.com/flex/3/html/help.html?content=data_4.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T14:06:14.240

我发现[本教程](http://dimuthuc.blogspot.com/2008/01/php-webservice-consume-from-flex.html)非常有帮助——它给出了使用基本 Web 服务的清晰示例，并且两边都有代码（服务器和 flex）。

从 flex 访问远程服务器上的远程 Web 服务时要记住的一件事是需要[crossdomain.xml](http://www.adobe.com/devnet/flashplayer/articles/fplayer9_security.html) - 需要明确告知 flex 中的安全模型允许从远程域访问服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-28T05:51:40.897

我推荐使用 AMF 来使用您自己的服务（Java[远程对象](http://livedocs.adobe.com/flex/2/langref/mx/rpc/remoting/mxml/RemoteObject.html)是标准的，但还有其他的，例如[pyAMF](http://pyamf.org/)、[RubyAMF](http://rubyamf.org/)）。

这对我使用 REST Web 服务很有效：

[http://code.google.com/p/as3httpclient/wiki/Links](http://code.google.com/p/as3httpclient/wiki/Links)

[例子](http://www.abdulqabiz.com/blog/archives/flash_and_actionscript/http_authentica.php)

BlazeDS 支持在没有 Crossdomain.xml 的情况下访问外部域：http: [//www.adobe.com/cfusion/communityengine/index.cfm? event=showdetails&postId=10284&productId=2](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&postId=10284&productId=2)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T15:17:53.210

Flex Builder 3 带有代码生成工具，可让您构建与 eb 服务 wsdl 公开的服务器端传输对象相对应的操作脚本对象。使用 Web 服务时，它可以让您的生活更轻松。这是[Zee Yang 的一个很好的概述](http://www.flexlive.net/?p=79)。

[Brian Riley 和 Clint Modien 编写了一个名为VOFactory](http://code.google.com/p/vofactory/)的开源工具，它允许您将 wsdl 对象动态转换为 actionscript 对象。

# c++ - 如何在 Visual Studio 2005 中获得完整的调用堆栈？

> ID：111023
> 
> 赞同：4
> 
> 时间：2008-09-21T13:32:12.310
> 
> 标签：c++, visual-studio, debugging, callstack, visual-c++-2005

如何获得使用 Visual Studio 2005 开发的 c++ 应用程序的完整调用堆栈？我想要一个完整的调用堆栈，包括系统库中的代码。

我是否必须更改 Visual Studio 中的某些设置，还是必须安装其他软件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-21T13:56:27.790

1.  获取所有项目依赖项的调试信息。这在项目属性的“配置属性 -> C/C++ -> 常规”部分下指定。

2.  在菜单上，转到“工具 -> 选项”，然后选择“调试 -> 符号”。

3.  添加指向 Microsoft 的免费符号服务器“symsrv *symsrv.dll* c:\symbols* [http://msdl.microsoft.com/downloads/symbols](http://msdl.microsoft.com/downloads/symbols) ”的新符号位置（文件夹图标）

4.  在本地的某个地方填写“缓存符号”字段，这样您就不会一直上网。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-21T22:54:37.840

同意 Clay，但对于 Symbols Server，您应该从“Debugging Tools For Windows”获取最新的 symsrv.DLL，这是一个免费的 Microsoft 下载。

（由于您明确询问需要下载什么，我想您还没有）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T19:41:29.053

或者，可选（假设未安装 Visual Studio），获取[Windows 调试工具](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx)的副本，安装并从调试器 (windbg.exe) 中运行您的应用程序，或者将其附加到已运行的应用程序：

> *windbg[.exe] -pn program.exe*
> 或
> *windbg[.exe] -p process_id*

在要观察堆栈跟踪的点处中断调试器 (Ctrl+Break)。切换到感兴趣的线程（很可能是执行的主线程）：

> ~0s

修复系统模块的符号（如果可用，也可能用于应用程序）：

> * 修复应用程序的符号
> *.sympath path_to_app_symbols*
> * 配置调试器将下载和存储系统符号
> *的位置 .symfix+ path_where_system_symbols_will_be_stored*
> * 强制调试器重新加载符号
> *.reload*

发出调用堆栈命令：

> *KB*

# c# - C#中的大数组算术

> ID：111026
> 
> 赞同：10
> 
> 时间：2008-09-21T13:33:32.947
> 
> 标签：c#, arrays

在对数组中的元素执行大量算术运算时，在 C# 中存储二维数组以优化性能的最佳方法是什么？

我们有大型（大约 1.5G）数组，例如，我们希望将它们逐个元素地相乘。性能至关重要。执行此操作的上下文在 c# 中。有什么聪明的方法来存储数组并迭代它们吗？我们可以用非托管 C++ 编写这些部分吗？这真的会提高性能吗？数组需要可供 c# 程序的其余部分访问。

目前（在 c 中）该数组存储为单个长向量。我们对数组中的每个元素执行计算并覆盖旧值。对于向量中的每个元素，计算通常是唯一的。

时序实验表明，在 C# 中将数据作为数组存储和迭代比将其存储为 2D 数组要慢。我想知道是否有更好的数据处理方式。执行的具体算术与问题无关。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-21T13:55:06.950

安娜，

这是一个很棒的页面，讨论了传统科学编程语言（fortran、C++）和 c# 之间的性能差异。

[http://msdn.microsoft.com/en-us/magazine/cc163995.aspx](http://msdn.microsoft.com/en-us/magazine/cc163995.aspx)

根据文章 C#，当使用矩形数组 (2d) 时，性能非常好。这是一个图表，显示了锯齿状数组（数组的数组）和矩形数组（多维）数组之间的性能差异。

[替代文字 http://i.msdn.microsoft.com/cc163995.fig08.gif](http://i.msdn.microsoft.com/cc163995.fig08.gif)

我建议自己进行试验，并使用 VS 2008 中的性能分析进行比较。

如果使用 C#“足够快”，那么您的应用程序将更容易维护。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-21T13:46:42.727

为获得最佳数组性能，请确保您使用的是较低索引为 0 的一维数组。

要尽可能快地访问数组的元素，可以使用不安全的指针，如下所示：

```
int[] array = Enumerable.Range(0, 1000).ToArray();

int count = 0;
unsafe {
    fixed (int* pArray = array) {
        for (int i = 0; i < array.Length; i++) {
            count += *(pArray + i);
        }
    }
} 
```

**EDIT** Drat! Didn't notice you said 2D array. This trick won't work with a multi-dimensional array so I'm not sure how much help it will be. Although you could turn any array into a single-dimension array by doing some arithmetic on the array index. Just depends on if you care about the performance hit in indexing the array or in iterating over the array.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-21T14:03:12.157

如果您下载 F#，并引用其中一个运行时库（我认为是 FSharp.PowerPack），并使用 Microsoft.FSharp.Maths.Matrix。它会根据您使用的是密集矩阵还是稀疏矩阵进行自我优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T14:37:18.940

Do you iterate the matrix by row or by colum or both? Do you always access nearby elements or do you do random accesses on the matrix.

If there is some locality in your accesses but you're not accessing it sequential (typical in matrix multiplication for example) then you can get a *huge* performance difference by storing your matrix in a more cache-friendly way.

A pretty easy way to do that is to write a little access function to turn your row/colum indices into an index and work on a one dimensional matrix, the cache-friendy way.

The function should group nearby coordinates into nearby indices. The morton-order can be used if you work on power of two sizes. For non-power sizes you can often bring just the lowest 4 bits into morton order and use normal index-arithmetic for the upper bits. You'll still get a significant speed-up, even if the coordinate to index conversion looks seems to be a costly operation.

[http://en.wikipedia.org/wiki/Z-order_(curve)](http://en.wikipedia.org/wiki/Z-order_(curve)) <-- sorry, can't link that SO does not like URL's with a dash in it. You have to cut'n'paste.

A speed up of factor 10 and more are realistic btw. It depends on the algorithm you ron over your matrices though.

# version-control - 集中式和分布式版本控制系统的比较

> ID：111031
> 
> 赞同：78
> 
> 时间：2008-09-21T13:36:45.700
> 
> 标签：version-control, comparison, dvcs

使用**集中式与分布式**版本控制系统 (DVCS)的**优缺点**是什么？您在 DVCS 中遇到过任何问题吗？您是如何防范这些问题的？*保持讨论工具不可知论和燃烧到最低限度。*

 ***对于那些想知道有哪些 DVCS 工具可用的人，这里是最知名的免费/开源 DVCS 列表：

*   [Linux 内核和 Ruby on Rails使用的](http://git.or.cz/gitwiki/GitProjects)[Git](http://git.or.cz/)（用 C 语言编写）。
*   [Mercurial](https://www.mercurial-scm.org)，（用 Python 编写）由[Mozilla 和 OpenJDK](https://www.mercurial-scm.org/wiki/ProjectsUsingMercurial)使用。
*   [Bazaar](http://bazaar-vcs.org/)，（用 Python 编写）供[Ubuntu 开发人员](https://wiki.ubuntu.com/UbuntuDevelopment)使用。
*   [Darcs](http://darcs.net/)，（用 Haskell 编写）。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-09-21T13:55:21.117

从[我](https://stackoverflow.com/questions/77485/what-are-the-relative-strengths-and-weaknesses-of-git-mercurial-and-bazaar#77834)对另一个[问题](https://stackoverflow.com/questions/77485/what-are-the-relative-strengths-and-weaknesses-of-git-mercurial-and-bazaar)的回答：

> 分布式版本控制系统 (DVCS) 解决了与集中式 VCS 不同的问题。比较它们就像比较锤子和螺丝刀。
> 
> [集中式 VCS](http://en.wikipedia.org/wiki/Revision_control)系统的设计意图是存在一个受祝福的真正来源，因此是好的。所有开发人员都从该源工作（签出），然后添加（提交）他们的更改，然后这些更改变得类似 Blessed。CVS、Subversion、ClearCase、Perforce、VisualSourceSafe 和所有其他 CVCS 之间唯一真正的区别在于每个产品提供的工作流程、性能和集成。
> 
> [分布式 VCS](http://en.wikipedia.org/wiki/Distributed_revision_control)系统的设计意图是一个存储库与其他存储库一样好，并且从一个存储库合并到另一个存储库只是另一种通信形式。关于应该信任哪个存储库的任何语义值都是由进程从外部强加的，而不是由软件本身强加的。
> 
> 使用一种类型或另一种类型的真正选择是组织性的——如果您的项目或组织想要集中控制，那么 DVCS 是不可能的。如果您的开发人员需要在全国/世界各地工作，而没有与中央存储库的安全宽带连接，那么 DVCS 可能是您的救星。如果你两者都需要，那你就完蛋了。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-09-21T14:32:35.100

> 对于那些认为分布式系统不允许权威副本的人，请注意分布式系统有很多地方都有权威副本，最好的例子可能是 Linus 的内核树。当然很多人都有自己的树，但几乎所有人都流向了莱纳斯的树。
> 
> 也就是说，我曾经认为分布式 SCM 只对许多开发人员做不同的事情有用，但最近决定集中存储库可以做的任何事情，分布式存储库可以做得更好。
> 
> 例如，假设您是一名独立开发人员，致力于您自己的个人项目。集中式存储库可能是一个明显的选择，但请考虑这种情况。您远离网络访问（在飞机上、在公园等）并且想要处理您的项目。你有你的本地副本，所以你可以很好地工作，但你真的想提交，因为你已经完成了一个功能并想继续另一个功能，或者你发现了一个要修复的错误或其他什么。关键是，使用集中式存储库，您最终要么将所有更改混合在一起并将它们提交到非逻辑更改集中，要么稍后手动将它们拆分出来。
> 
> 使用分布式存储库，您可以照常营业，提交，继续前进，当您再次拥有网络访问权限时，您将推送到“一个真正的存储库”并且没有任何改变。
> 
> 更不用说分布式存储库的另一个好处：始终可用的完整历史记录。离网时需要查看修订日志吗？您需要对源代码进行注释以查看错误是如何引入的？分布式回购一切皆有可能。
> 
> 请不要相信分布式与集中式是关于所有权或权威副本或类似的东西。现实是分布式的，是 SCM 演进的下一步。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-01-07T10:45:38.577

不是真正的比较，但这里是大型项目正在使用的：

## 集中式 VCS

*   **[颠覆](http://subversion.tigris.org/testimonials.html#open-source-projects-using-svn)**

    Apache, GCC, Ruby, MPlayer, Zope, Plone, Xiph, FreeBSD, WebKit, ...

*   **CVS**

    CVS

## 分布式 VCS

*   **[混帐](http://git-scm.com/)**

    Linux 内核、KDE、Perl、Ruby on Rails、Android、Wine、Fedora、X.org、Mediawiki、Django、VLC、Mono、Gnome、Samba、CUPS、GnuPG、Emacs ELPA...

*   **[汞（汞）](https://www.mercurial-scm.org/wiki/ProjectsUsingMercurial)**

    Mozilla 和 Mozdev、OpenJDK (Java)、OpenSolaris、ALSA、NTFS-3G、Dovecot、MoinMoin、mutt、PETSc、Octave、FEniCS、Aptitude、Python、XEmacs、Xen、Vim、Xine...

*   **[bzr](http://bazaar-vcs.org/WhoUsesBzr)**

    Emacs、Apt、Mailman、MySQL、Squid……也在 Ubuntu 中得到推广。

*   **[达克斯](http://wiki.darcs.net/DarcsWiki/ProjectsUsingDarcs)**

    ghc, ion, xmonad, ... 在 Haskell 社区中很流行。

*   **[化石](http://www.fossil-scm.org)**

    SQLite

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-09-21T16:24:07.373

[W. Craig Trader](https://stackoverflow.com/questions/111031/comparison-between-centralized-and-distributed-version-control-systems#111076)谈到了 DVCS 和 CVCS：

> 如果你两者都需要，那你就完蛋了。

我不会说你在使用两者时都会被*淘汰*。实际上，使用 DVCS 工具的开发人员通常会尝试将他们的更改（或发送拉取请求）合并到一个中心位置（通常是发布存储库中的发布分支）。对于使用 DVCS 但最终坚持使用集中式工作流程的开发人员来说，有些讽刺意味，您可能会开始怀疑分布式方法是否真的比集中式更好。

与 CVCS 相比，DVCS 有一些优势：

*   唯一可识别的提交的概念使得在对等点之间发送补丁变得轻松。即，您将补丁作为提交，并与其他需要它的开发人员共享。稍后当每个人都想合并在一起时，该特定提交会被识别并可以在分支之间进行比较，从而减少合并冲突的机会。无论您使用哪种版本控制工具，开发人员都倾向于通过 U 盘或电子邮件相互发送补丁。不幸的是，在 CVCS 案例中，版本控制会将提交注册为单独的，无法识别更改是相同的，从而导致合并冲突的可能性更高。

*   您可以拥有不需要向其他人展示的本地实验分支（克隆的存储库也可以被视为一个分支）。这意味着，如果您没有向上游推送任何内容，那么重大更改不需要影响开发人员。在 CVCS 中，当您仍然有重大更改时，您可能必须离线工作，直到您修复它并提交更改。这种方法有效地破坏了使用版本控制作为安全网的目的，但它在 CVCS 中是一个必要的弊端。

*   在当今世界，公司通常与离岸开发人员合作（或者甚至更好，他们希望在家工作）。拥有 DVCS 有助于此类项目，因为它消除了对可靠网络连接的需求，因为每个人都有自己的存储库。

…以及通常有解决方法的一些缺点：

*   *谁有最新版本？*在 CVCS 中，主干通常具有最新版本，但在 DVCS 中可能并不明显。解决方法是使用行为规则，项目中的开发人员必须达成一项协议，在该协议中合并他们的工作。

*   悲观锁，即在签出时锁定文件，通常是不可能的，因为 DVCS 中的存储库之间可能发生并发。版本控制中存在文件锁定的原因是开发人员希望避免合并冲突。但是，锁定的缺点是会减慢开发速度，因为两个开发人员不能像使用长事务模型那样同时处理同一段代码，并且它不能完全证明对合并冲突的保证。无论版本控制如何，唯一明智的方法是对抗大型合并冲突是拥有良好的代码架构（如低耦合高内聚）并划分您的工作任务，以便它们对代码的影响较小（说起来容易做起来难） .

*   在专有项目中，如果整个存储库都公开可用，那将是灾难性的。如果心怀不满或恶意的程序员掌握了克隆的存储库，则更是如此。源代码泄露是专有业务的一大痛点。DVCS 使这变得简单，因为您只需要克隆存储库，而一些 CM 系统（例如 ClearCase）试图限制该访问。但是，在我看来，如果您的公司文化中有足够多的功能失调，那么世界上没有任何版本控制可以帮助您防止源代码泄漏。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-21T14:12:09.563

在寻找合适的 SCM 时，我发现以下链接很有帮助：

1.  [更好的 SCM 倡议：比较](http://better-scm.berlios.de/comparison/comparison.html)。大约 26 个版本控制系统的比较。
2.  [版本控制软件比较](http://en.wikipedia.org/wiki/Comparison_of_revision_control_software)。维基百科文章比较了 38 个版本控制系统，涵盖了技术差异、功能、用户界面等主题。
3.  [分布式版本控制系统](http://www.ada-france.org/debian/distributed-version-control-systems.html)。另一个比较，但主要集中在分布式系统上。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-21T20:59:25.357

在某种程度上，这两种方案是等价的：

*   如果您总是在每次本地提交后将更改推送到某个指定的上游存储库，分布式 VCS 可以轻松模拟集中式 VCS。
*   集中式 VCS 通常无法自然地模拟分布式 VCS，但如果在其上使用[quilt](http://savannah.nongnu.org/projects/quilt)之类的东西，您可以获得非常相似的东西。Quilt，如果你不熟悉的话，它是一个在一些上游项目之上管理大量补丁的工具。这里的想法是 DVCS 提交命令是通过创建一个新补丁来实现的，而推送命令是通过将每个未完成的补丁提交到集中式 VCS 然后丢弃补丁文件来实现的。这听起来有点尴尬，但在实践中它实际上工作得相当好。

话虽如此，有几件事是 DVCS 传统上做得很好，而大多数集中式 VCS 做了一些散列。其中最重要的可能是分支：DVCS 将使存储库的分支或合并不再需要的分支变得非常容易，并且在您这样做时会跟踪历史记录。没有什么特别的原因会导致集中式方案在这方面遇到麻烦，但从历史上看，似乎还没有人完全正确地做到这一点。这对您来说是否真的是一个问题取决于您将如何组织开发，但对于许多人来说，这是一个重要的考虑因素。

DVCS 的另一个假定优势是它们可以离线工作。我从来没有真正用过它。我主要在办公室（所以存储库在本地网络上）或在家（所以有 ADSL）进行开发。如果您在旅行时在笔记本电脑上进行大量开发，那么这可能更适合您考虑。

实际上并没有很多专门针对 DVCS 的陷阱。人们更倾向于保持安静，因为你可以在没有推动的情况下做出承诺，而且很容易私下里打磨事情，但除此之外，我们并没有遇到太多问题。这可能是因为我们有大量的开源开发人员，他们通常熟悉补丁交易开发模型，但新来的闭源开发人员似乎也能相当快地掌握这些东西。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-13T09:38:10.823

我已经使用 subversion 很多年了，我对它真的很满意。

然后 GIT 嗡嗡声开始了，我只需要测试它。对我来说，主要卖点是分支。好家伙。现在我不再需要清理我的存储库，返回几个版本或者我在使用 subversion 时所做的任何愚蠢的事情。dvcs 中的一切都很便宜。虽然我只尝试过化石和 git，但我使用过 perforce、cvs 和 subversion，看起来 dvcs 都有非常便宜的分支和标记。不再需要将所有代码复制到一侧，因此合并变得轻而易举。

任何 dvcs 都可以使用中央服务器进行设置，但你得到的是除其他外

你可以签入任何你喜欢的小改动，正如 Linus 所说，如果你需要用一个以上的句子来描述你刚刚做了什么，那么你做的太多了。您可以按照自己的方式在本地处理代码、分支、合并、克隆和测试，而不会导致任何人下载大量数据。而且您只需要将最终的更改推送到中央服务器。

您可以在没有网络的情况下工作。

所以简而言之，使用版本控制总是一件好事。使用 dvcs 更便宜（以 KB 和带宽计），而且我认为使用起来更有趣。

结帐 Git：[http](http://git-scm.com/)
://git-scm.com/ 结帐 Fossil：[http](http://www.fossil-scm.org)
://www.fossil-scm.org 结帐 Mercurial：[https ://www.mercurial-scm.org](https://www.mercurial-scm.org)

现在，我只能推荐 dvcs 系统，您可以轻松使用中央服务器

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-21T10:04:54.510

分布式 VCS 在很多方面都很有吸引力，但对我的公司来说很重要的一个缺点是管理不可合并文件（通常是二进制文件，例如 Excel 文档）的问题。Subversion 通过支持“svn:needs-lock”属性来处理这个问题，这意味着你必须在编辑之前为不可合并的文件获得一个锁。它运作良好。但是该工作流程需要一个集中的存储库模型，这与 DVCS 概念相反。

因此，如果您想使用 DVCS，它并不适合管理不可合并的文件。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-21T13:41:31.367

主要问题（除了明显的带宽问题）是**所有权**。

那是为了确保不同的（地理）站点没有在同一个元素上工作。

理想情况下，该工具能够将所有权分配给文件、分支甚至存储库。

要回答这个答案的评论，您真的希望该工具告诉您谁拥有什么，*然后*与远程站点进行通信（通过电话、IM 或邮件）。
如果您没有所有权机制...您将“交流”，但通常为时已晚；）（即：在对同一分支中的一组相同文件进行并发开发之后。提交可能会变得混乱）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-21T13:44:38.007

对我来说，这是另一个关于个人品味的讨论，很难做到真正客观。我个人更喜欢[Mercurial](https://www.mercurial-scm.org)而不是其他 DVCS。[我喜欢用与Mercurial](https://www.mercurial-scm.org)相同的语言和较小的网络开销来编写挂钩 - 只是为了说出我自己的一些原因。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-02-06T18:10:37.437

如今，每个人都在谈论 DVCS 的优越性，但 Craig 的评论很重要。在 DVCS 中，每个人都有分支的全部历史。如果您正在处理大量二进制文件（例如，图像文件或 FLA），则这需要大量空间并且您无法进行差异。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-21T13:52:25.243

我感觉 Mercurial（和其他 DVCS）比集中式的更复杂。例如，在 Mercurial 中合并分支会保留分支的完整历史记录，而在 SVN 中，您必须转到分支目录才能查看历史记录。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-20T04:09:20.417

即使在单独的开发人员场景中，分布式 SCM 的另一个优点是，如果您像我们中的许多人一样，拥有不止一台工作的机器。

假设您有一组通用脚本。如果您使用的每台机器都有一个克隆，您可以按需更新和更改您的脚本。它为您提供：

1.  节省时间，尤其是使用 ssh 密钥
2.  一种区分不同系统之间差异的方法（例如 Red Hat 与 Debian、BSD 与 Linux 等）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-21T14:01:35.047

W. Craig Trader 的回答总结了大部分内容，但是，我发现个人工作风格也有很大的不同。在我目前工作的地方，我们使用 subversion 作为我们的 One True Source，然而，许多开发人员在他们的个人机器上使用 git-svn 来弥补我们遇到的工作流问题（管理失败，但这是另一回事）。任何状况之下。它实际上是在平衡哪些功能集使您最有效率与组织需要的东西（例如集中式身份验证）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-21T16:34:39.487

集中式系统不一定会阻止您使用单独的分支进行开发。不需要代码库的单个真实副本，而是不同的开发人员或团队可以有不同的分支，可以存在遗留分支等。

它通常意味着存储库是集中管理的——但这对于拥有称职 IT 部门的公司来说通常是一个优势，因为这意味着只有一个地方可以备份，只有一个地方可以管理存储。

# java - Java的补充开发工具

> ID：111045
> 
> 赞同：5
> 
> 时间：2008-09-21T13:46:36.613
> 
> 标签：java, supplementary

您最喜欢的 Java 开发补充工具是什么？

我的是：

1) Total Commander（由于能够在 JAR 中搜索）。

2）JAD + Jadclipse（理解和调试库）

当然，还有谷歌。（没有它真的活不下去）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-22T19:55:47.917

[PMD](http://pmd.sourceforge.net/)

PMD 扫描 Java 源代码并查找潜在问题，例如：

```
* Possible bugs - empty try/catch/finally/switch statements
* Dead code - unused local variables, parameters and private methods
* Suboptimal code - wasteful String/StringBuffer usage
* Overcomplicated expressions - unnecessary if statements, for loops that could be while loops
* Duplicate code - copied/pasted code means copied/pasted bugs 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T14:41:23.067

[Jython](http://www.jython.org/) for interactive testing and exploration of all sorts of things.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-21T17:16:59.323

*   Eclipse Classic（带有 WebTools、Subclipse 和 Eclipse Checkstyle 插件）
*   马文
*   甲骨文 SQL 开发人员

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-22T15:17:27.183

*   蚀
*   文本伴侣
*   蚂蚁
*   马文
*   JUnit 和朋友们
*   Checkstyle（Eclipse 和 Maven 的插件）
*   贾德
*   DBVisualizer

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-21T16:44:26.747

1.  用于组织和构建项目的[Maven](http://maven.apache.org)
2.  [哈德森](http://hudson-ci.org)自动执行此操作 ;-)
3.  [Emma](http://emma.sourceforge.net)（和 Eclipse 的[EclEmma](http://www.eclemma.org)插件）深入了解您的代码覆盖率

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-22T00:13:06.530

1.  超编辑
2.  特工搜查
3.  DJ Java 反编译器

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-21T14:17:36.273

*   日食与：
    *   子剪辑
    *   JBoss 工具
    *   蚂蚁
    *   朱尼特
*   Ultraedit（用于列编辑）
*   贾德
*   浏览器
*   SQLYog（用于 MySQL）、TOAD（用于 Oracle）、Management Studio（用于 SQL Server）

由于无数的插件（也支持其他语言和环境），Eclipse 已经提供了很多东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T00:22:07.350

1.  Groovy：我的伪 Java 暂存器
2.  Eclipse 或 Netbeans：无论我对 IDE 的感觉如何
3.  Subversion：总是需要一个好的版本控制

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-21T18:30:17.227

*   蚂蚁/Maven
*   文本伴侣
*   谷歌当然;-)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-21T13:48:35.563

[JavaRebel](http://www.zeroturnaround.com/javarebel/features/)通过自动将代码更改热部署到正在运行的程序来加速开发。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-21T13:55:09.667

我几乎把大部分时间都花在了[Eclipse](http://www.eclipse.org)和命令行上。

使用 Eclipse，我通常会修改键盘绑定，因此我可以轻松掌握 Open Type/Resource、Quick Outline、Show Refactor Menu 等功能。我还安装[了 Q for Eclipse](http://code.google.com/p/q4e/)以启用良好的 Maven 集成，从而允许我在编码时访问我的依赖项的源代码。

在命令行中，使用最多的是[Maven](http://maven.apache.org)、[Ant](http://ant.apache.org)和[Subversion等工具。](http://subversion.tigris.org)我有一些命令可以在 JDK 之间切换，以测试项目在所有预期目标上的编译和运行。

我曾经保留一份 JAD 的副本，但是感谢 Maven 和 Q for Eclipse，我几乎不再使用它了。反编译的代码几乎不像原始代码那样有用。

我差点忘了，JConsole 有助于监控您的应用程序，我也使用[YourKit](http://www.yourkit.com)进行更高级的分析。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-21T13:48:45.687

[FindBugs](http://findbugs.sourceforge.net/)、[Proguard](http://proguard.sourceforge.net/)、[JProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)、[Cobertura](http://cobertura.sourceforge.net)。

# .net - 开发 MS Word 插件

> ID：111050
> 
> 赞同：6
> 
> 时间：2008-09-21T13:47:18.530
> 
> 标签：.net, ms-word, ms-office, add-in

任何人都知道在 .net 中开发 Word 插件的好工具吗？希望能同时支持 Office 2003 和 2007 的东西。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-21T14:10:22.453

Office 的开发工具有很多选项。最明显的当然是 Office 本身。它对宏和 VBA 有丰富的支持。您还可以使用 SharePoint 来扩展文档共享和管理功能。但是，如果您的加载项比在 Office 内部处理的更复杂，我建议您使用[Visual Studio 2008](http://msdn.microsoft.com/en-us/vs2008/default.aspx "Visual Studio 2008 开发人员中心")或 Visual Studio 2005 的[Office](http://msdn.microsoft.com/en-us/office/aa905543.aspx "VSTO 2005 附加组件")加载项工具。

要记住的一件事是，Office 主要是 COM 对象的集合。因此，虽然像 Visual Studio 这样的工具凭借其对 .NET Framework 和 Office 类的深入支持使得开发 Office 应用程序的解决方案变得非常简单，并且需要一些时间、精力和对痛苦的高度容忍，但您可以开发一个 Office 插件 -在记事本中。

[Microsoft在这里](http://msdn.microsoft.com/en-us/office/default.aspx "Office 开发者中心")为 Office 开发人员提供了一个非常好的资源站点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-21T15:37:27.970

可以使用多种工具来开发 Office 扩展，并且有很多关于该主题的书籍。一些比较流行的方法是：

*   [VBA](http://msdn.microsoft.com/en-us/isv/bb190538.aspx)自带office，可以两种模式使用。首先，可以在文档或模板中编写宏。这样做的优点是代码遵循文档，缺点是您不能轻松地将更新传播到现有文档。它还可以用于通过将带有宏的文档放在正确的文件夹中并将其注册到 Office 来开发扩展。
*   [Visual Studio Tools for Office](http://msdn.microsoft.com/en-us/office/aa905533.aspx)允许您使用 .Net 执行类似 VBA 的项目。这些程序集可以与文档捆绑在一起或作为扩展安装。请注意，执行非捆绑扩展不需要 VSTO - 如果您安装了Office 的[主要互操作程序集](http://msdn.microsoft.com/en-us/library/15s06t57(VS.80).aspx)，则可以使用任何 .Net 开发工具执行此操作。这些是用原生 .Net 封装 COM API 的垫片。
*   任何支持[COM（组件对象模型）](http://en.wikipedia.org/wiki/Component_Object_Model)的语言都可以用于开发办公扩展。此类语言的示例是 C++、Delphi 和 Python。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-25T08:51:16.673

[Daniel Moth](http://www.danielmoth.com/Blog/2007/10/five-vsto-v30-in-vs2008-videos.html) have made some very good VSTO primer webcasts, take a look at those.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T14:08:33.487

任何版本的 Visual Studio 都可以完成这项工作。记住要考虑部署，如果您想要求用户安装这个或那个版本的 .net 框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-21T13:50:36.230

Visual Studio 2008。VB.NET。

# asp.net - 如何将旧 ASP 应用程序转换为 ASP.NET？

> ID：111071
> 
> 赞同：17
> 
> 时间：2008-09-21T13:53:30.933
> 
> 标签：asp.net, asp-classic, code-conversion

我们有一个大型 ASP（经典 ASP）应用程序，我们希望将其转换为 .NET 以便进一步发布。继续使用 ASP 是没有意义的，因为它已经过时了，而且我们不想从头开始重写它（Joel Spolsky 告诉你[原因](http://www.joelonsoftware.com/articles/fog0000000069.html)）。

有没有办法自动将它从 ASP 转换为 ASP.NET？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-21T14:17:10.317

即使有工具可以在经典 ASP 和 ASP.NET 之间进行转换，它们也不会产生很好的结果：这两种环境根本不同。快速谷歌搜索了一些结果，主要是“我们将让我们在印度的人这样做”的种类。

我的建议是暂时不要触碰您现有的 ASP 代码。在可预见的将来，运行时环境将得到微软的支持，因此无需紧急迁移。相反，开始在 ASP.NET 中开发新功能：这样，您将不会被遗留概念所阻碍，并且可以以任何您看到的方式使用框架（包括 ASP.NET MVC 之类的东西）提供的新酷合身。

当然，您的新代码将需要与现有的 ASP 环境一起使用。[在 ASP 和 ASP.NET 之间共享会话状态](http://msdn.microsoft.com/en-us/library/aa479313.aspx)很可能是您的首要要求之一，但您很快就会发现更多类似的问题。

此类问题的“正确”解决方案将完全取决于您当前的代码和要求：有时，您可以将 .NET 代码包装在 COM 对象中以供 ASP 代码使用，有时部分移植/迁移可能是解决方案.

但是，平均而言，“两个世界”的方法应该是完全可行的，并且允许您开发令人兴奋的新功能而不必担心您的遗留代码。

* * *

**2009 年 12 月对原始答案**的补充：刚刚遇到[ASP Classic Compiler](http://aspclassiccompiler.codeplex.com/)，这是一个积极维护的 VBscript 编译器，可将经典 ASP 页面转换为在 ASP.NET 上本机运行的代码。它有几个很酷的特性，比如能够将它用作 ASP.NET MVC 自定义 ViewEngine，所以尽管它处于 beta 状态，但它看起来绝对值得关注......

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-12-23T14:07:22.420

嗯，我曾经在一家所有 Web 应用都是经典 ASP 的公司工作。当决定迁移到 .NET 时，我们必须找到一种方法将 168(!) Web 应用程序转换为这个新框架。我尝试了当时所有可用的工具来做到这一点，但都失败了。

最好的方法是构建一个新的 Web 服务器并从头开始，这样您就可以确保升级会很快发生，并且由于新旧集成而不会出现任何问题。您将能够选择要保留的功能和视觉外观以及要更改的功能和视觉外观。不要将您的时间浪费在将旧的 ASP 文件/站点升级到 NET 平台的自动工具上。到目前为止，没有一个工作正常。

最重要的是，如果您在后端有数据库，您将遇到从 Web 应用程序连接到它的问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-21T14:15:42.143

微软在 MSDN 上有一篇关于将[ASP 页面迁移到 ASP.NET](http://msdn.microsoft.com/en-us/library/dddsc60w(VS.71).aspx)的文章。他们基本上告诉您在您的计算机/服务器上安装 .net 并一次转换一页。ASP 和 ASP.NET 可以共存，因此可以随时将每个页面重命名为“aspx”。但是，您应该注意，会话状态和应用程序状态不会在 ASP 和 ASP.NET 页面之间共享（有关该问题的解决方法，请参阅[@mdb 的答案](https://stackoverflow.com/questions/111071/tools-for-converting-from-asp-to-aspnet#111108)。）

还有[The ASP to ASP.NET Migration Assistant](http://msdn.microsoft.com/en-us/asp.net/aa336626.aspx)，但我不确定项目/程序是否仍然处于活动状态。您可以通过从该页面下载来尝试：

[http://www.asp.net/downloads/archived/migration-assistants/asp-to-aspnet/](http://www.asp.net/downloads/archived/migration-assistants/asp-to-aspnet/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-20T03:28:07.017

gmStudio 是一个全面的 VB6/ASP/COM 到 .NET 的升级工具。它可以读取、分析、解释、重写和重组（如 C# 或 VB.NET）单个页面+包含或整个站点。

自 2007 年以来，该技术一直在积极开发中，我们使用它来帮助我们重写从几百页到几千页不等的网站。

该工具[在 MSDN 上得到认可。](http://msdn.microsoft.com/en-us/vstudio/dn569303 "这里")

一个（旧的）演示视频[在 ScreenCast 上。](http://www.screencast.com/t/ODliZjcxM)（我真的需要更新这个！在那之前，如果你想要一个现场演示来看看最新的，请告诉我。）

还有很多要说的，[如果您有兴趣，请与我们联系。](https://www.greatmigrations.com/en/resources/gmstudio-demo.aspx)

免责声明：我为大迁徙工作。

# windows - Windows上的关闭脚本以删除注册表项？

> ID：111097
> 
> 赞同：3
> 
> 时间：2008-09-21T14:07:24.253
> 
> 标签：windows, batch-file, scripting, registry

**编辑：**以前更明确地命名为：-“**阻止 Kontiki 的 KHOST.EXE 在 Windows XP 启动时自动加载的最佳解决方案？** ”

本质上，每当运行**[40D](http://www.channel4.com/4od/index.html)**应用程序时，它都会将**khost.exe**设置为随 Windows 自动启动。这很烦人，因为它使我的启动时间增加了几分钟，而且我什至不使用 4OD 的 P2P 方面。

设置的注册表项是：

```
Command: C:\Program Files\Kontiki\KHost.exe -all
Description: kdx
Location: HKU\S-1-5-21-1757981266-1960408961-839522115-1003\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
Name: kdx
Setting ID:
User: LAPTOP\Me

Command: "C:\Program Files\Kontiki\KHost.exe" -all
Description: 4oD
Location: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
Name: 4oD
Setting ID:
User: All Users 
```

我假设某种**启动**或**关闭** **脚本**来删除这些注册表项将是最好的解决方案，但我不喜欢**.vbs**或**.bat**脚本或我将它们放在自动运行的地方在适当的时候。

我知道有一个**[TV On-Demand Monitor 应用程序](http://odmonitor.blogspot.com/)**，但我真的不需要运行另一个进程，我只需要删除上面描述的注册表项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T16:48:32.790

**我最终做了什么：**

**1)通过****右键单击**>**退出**从任务托盘停止**40D** ，这终止了**Khost.exe**进程。

 ********2)**打开**开始**>**所有程序**>**管理工具**>**服务**并停止**KService**，然后将**启动类型**设置为“**手动**”。

**3)**创建了一个***ShutdownScript.vbs***，内容如下：

```
Set SH = CreateObject("WScript.Shell")

RemoveRegKey "HKU\S-1-5-21-1757981266-1960408961-839522115-1003\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\kdx"
RemoveRegKey "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\kdx"
RemoveRegKey "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\4oD"

Shutdown

Set Shell = Nothing
Set SH = Nothing
WScript.Quit

Sub RemoveRegKey(sKey)
    On Error Resume Next
    SH.RegDelete sKey
End Sub

Sub Shutdown()
    SH.Run "shutdown -s -t 1", 0, TRUE
End Sub 
```

**4）在我的****开始菜单**中放置脚本的**快捷方式**，现在使用它来关闭PC。

 **现在**40D**将在我需要时工作，我所要做的就是退出它并使用脚本关闭它，以阻止它在每次启动 PC 时自动启动。

**感谢您对此的所有帮助！:)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T14:36:35.417

为什么不直接将可执行文件复制到其他名称，然后在其位置放置一个无操作的 exe。然后将您的快捷方式更改为复制并重命名的 EXE。如果程序对其名称敏感，则将快捷方式指向 VBS 文件以临时重命名 EXE 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T14:37:49.003

对于 vb 脚本，您将使用如下内容：

```
Dim WSHShell
Set WSHShell = WScript.CreateObject("WScript.Shell")
'repeat the line below for each key to delete 
WSHShell.RegDelete "[Location of Key]" 
```

只需将代码放入文本文件中，然后将其重命名为shutdown，vbs。

至于何时运行它，如果您在公司环境中，您可以使用组策略并将其设置为机器关闭脚本。或者，请参阅此页面[以](http://www.msfn.org/board/lofiversion/index.php/t40945.html)手动添加

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T14:43:22.063

另一种方法：

创建一个运行程序的 VBS 文件，然后删除注册表项。

```
Set objShell = CreateObject("WScript.Shell") 

objShell.Exec("C:\Program Files\Kontiki\KHost.exe")

strRoot = "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\4oD" 
strDelete = objShell.RegDelete(strRoot) 
... 
```

并指出你的捷径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T15:16:23.247

我是否建议您尝试一下 AutoIt ( [http://www.autoitscript.com/autoit3/](http://www.autoitscript.com/autoit3/) )，这是一种免费软件脚本语言，旨在自动化 Windows GUI 和一般脚本。

如果您选择使用它，您需要的 AutoIt 代码将是 2 行代码：

```
RegDelete("YourKey", "YourValue");
ShutDown(1); 
```

您可以将其编译成可以在任何计算机上运行的独立 exe（无需运行时库）

# javascript - JavaScript 闭包是如何工作的？

> ID：111102
> 
> 赞同：7625
> 
> 时间：2008-09-21T14:12:07.003
> 
> 标签：javascript, function, variables, scope, closures

你会如何向了解它们所包含的概念（例如函数、变量等）但不了解闭包本身的人解释 JavaScript 闭包？

我在 Wikipedia 上看到[了 Scheme 示例](http://en.wikipedia.org/wiki/Scheme_%28programming_language%29)，但不幸的是它没有帮助。

* * *

## 回答 #1

> 赞同：8026
> 
> 时间：2008-09-21T14:18:18.347

闭包是一对：

1.  一个函数和
2.  对该函数的外部范围（词法环境）的引用

词法环境是每个执行上下文（堆栈帧）的一部分，是标识符（即局部变量名称）和值之间的映射。

JavaScript 中的每个函数都维护对其外部词法环境的引用。此引用用于配置调用函数时创建的执行上下文。此引用使函数内部的代码能够“看到”函数外部声明的变量，而不管函数何时何地被调用。

如果一个函数被一个函数调用，而该函数又被另一个函数调用，那么就会创建一个对外部词法环境的引用链。该链称为作用域链。

在下面的代码中，使用调用`inner`时创建的执行上下文的词法环境形成一个闭包，*关闭*变量：`foo`*`secret`*

 *```
function foo() {
  const secret = Math.trunc(Math.random() * 100)
  return function inner() {
    console.log(`The secret number is ${secret}.`)
  }
}
const f = foo() // `secret` is not directly accessible from outside `foo`
f() // The only way to retrieve `secret`, is to invoke `f`
```

换句话说：在 JavaScript 中，函数携带对私有“状态盒”的引用，只有它们（以及在同一词法环境中声明的任何其他函数）可以访问该私有“状态盒”。这个状态框对函数的调用者是不可见的，为数据隐藏和封装提供了一种极好的机制。

请记住：JavaScript 中的函数可以像变量（一等函数）一样传递，这意味着这些功能和状态配对可以在您的程序中传递：类似于您在 C++ 中传递类实例的方式。

如果 JavaScript 没有闭包，则必须在函数之间*显式*传递更多状态，从而使参数列表更长，代码更嘈杂。

因此，如果您希望函数始终可以访问私有状态，则可以使用闭包。

...而且我们经常*希望*将状态与函数相关联。例如，在 Java 或 C++ 中，当您将私有实例变量和方法添加到类时，您将状态与功能相关联。

在 C 和大多数其他通用语言中，函数返回后，所有局部变量都不再可访问，因为堆栈帧已被破坏。在 JavaScript 中，如果你在另一个函数中声明一个函数，那么外部函数的局部变量在从它返回后仍然可以访问。这样，在上面的代码中，`secret`函数对象*在*从.`inner`*`foo`*

 *## 闭包的使用

当您需要与函数关联的私有状态时，闭包很有用。这是一个非常常见的场景 - 请记住：JavaScript 直到 2015 年才具有类语法，并且它仍然没有私有字段语法。闭包满足了这一需求。

### 私有实例变量

在以下代码中，该函数`toString`关闭了汽车的详细信息。

```
function Car(manufacturer, model, year, color) {
  return {
    toString() {
      return `${manufacturer} ${model} (${year}, ${color})`
    }
  }
}

const car = new Car('Aston Martin', 'V8 Vantage', '2012', 'Quantum Silver')
console.log(car.toString())
```

### 函数式编程

在下面的代码中，函数`inner`关闭了`fn`和`args`。

```
function curry(fn) {
  const args = []
  return function inner(arg) {
    if(args.length === fn.length) return fn(...args)
    args.push(arg)
    return inner
  }
}

function add(a, b) {
  return a + b
}

const curriedAdd = curry(add)
console.log(curriedAdd(2)(3)()) // 5
```

### 面向事件的编程

在下面的代码中，函数`onClick`关闭了 variable `BACKGROUND_COLOR`。

```
const $ = document.querySelector.bind(document)
const BACKGROUND_COLOR = 'rgba(200, 200, 242, 1)'

function onClick() {
  $('body').style.background = BACKGROUND_COLOR
}

$('button').addEventListener('click', onClick)
```

```
<button>Set background color</button>
```

### 模块化

在以下示例中，所有实现细节都隐藏在立即执行的函数表达式中。关闭他们完成工作所需的私有状态和功能的`tick`功能。`toString`闭包使我们能够模块化和封装我们的代码。

```
let namespace = {};

(function foo(n) {
  let numbers = []

  function format(n) {
    return Math.trunc(n)
  }

  function tick() {
    numbers.push(Math.random() * 100)
  }

  function toString() {
    return numbers.map(format)
  }

  n.counter = {
    tick,
    toString
  }
}(namespace))

const counter = namespace.counter
counter.tick()
counter.tick()
console.log(counter.toString())
```

## 例子

### 示例 1

这个例子表明局部变量没有被复制到闭包中：闭包维护了对原始变量*本身*的引用。就好像堆栈帧在外部函数退出后仍然存在于内存中一样。

```
function foo() {
  let x = 42
  let inner = () => console.log(x)
  x = x + 1
  return inner
}

foo()() // logs 43
```

### 示例 2

在下面的代码中，三个方法`log`、`increment`和`update`都关闭在同一个词法环境中。

每次`createObject`调用时，都会创建一个新的执行上下文（堆栈框架），并创建一个全新的变量`x`，以及一组新的函数（`log`等），这些函数会关闭这个新变量。

```
function createObject() {
  let x = 42;
  return {
    log() { console.log(x) },
    increment() { x++ },
    update(value) { x = value }
  }
}

const o = createObject()
o.increment()
o.log() // 43
o.update(5)
o.log() // 5
const p = createObject()
p.log() // 42
```

### 示例 3

如果您使用的是 using 声明的变量`var`，请注意您了解要关闭的变量。使用声明的变量`var`被提升。由于引入了`let`和，这在现代 JavaScript 中的问题要少得多`const`。

在下面的代码中，每次循环时，`inner`都会创建一个新函数，该函数会结束`i`. 但是因为`var i`被提升到循环之外，所有这些内部函数都关闭了同一个变量，这意味着`i`(3) 的最终值被打印了 3 次。

```
function foo() {
  var result = []
  for (var i = 0; i < 3; i++) {
    result.push(function inner() { console.log(i) } )
  }

  return result
}

const result = foo()
// The following will print `3`, three times...
for (var i = 0; i < 3; i++) {
  result[i]() 
}
```

## 最后几点：

*   每当在 JavaScript 中声明一个函数时，就会创建闭包。
*   从另一个函数内部返回 a`function`是闭包的典型示例，因为外部函数内部的状态对于返回的内部函数是隐式可用的，即使在外部函数完成执行之后也是如此。
*   每当您`eval()`在函数内部使用时，都会使用闭包。文本`eval`可以引用函数的局部变量，在非严格模式下，甚至可以使用`eval('var foo = …')`.
*   当您`new Function(…)`在函数内部使用（[函数构造函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function)）时，它不会关闭其词法环境：而是关闭全局上下文。新函数不能引用外部函数的局部变量。
*   JavaScript 中的闭包就像在函数声明时保留对作用域的引用（**不是**副本），而后者又保留对其外部作用域的引用，依此类推，一直到顶部的全局对象范围链。
*   声明函数时会创建闭包；此闭包用于在调用函数时配置执行上下文。
*   每次调用函数时都会创建一组新的局部变量。

## 链接

*   Douglas Crockford 使用闭包模拟对象的[私有属性和私有方法](http://www.crockford.com/javascript/private.html)。
*   如果您不小心，闭包如何[导致 IE 中的内存泄漏的一个很好的解释。](https://www.codeproject.com/Articles/12231/Memory-Leakage-in-Internet-Explorer-revisited)
*   [关于JavaScript 闭包](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)的MDN 文档。

* * *

## 回答 #2

> 赞同：4095
> 
> 时间：2008-09-21T15:16:36.303

JavaScript 中的每个函数都维护到其外部词法环境的链接。词法环境是范围内所有名称（例如变量、参数）及其值的映射。

因此，每当您看到`function`关键字时，该函数内的代码都可以访问函数外声明的变量。

```
function foo(x) {
  var tmp = 3;

  function bar(y) {
    console.log(x + y + (++tmp)); // will log 16
  }

  bar(10);
}

foo(2);
```

这将记录`16`，因为函数`bar`关闭了参数`x`和变量`tmp`，这两者都存在于外部函数的词法环境中`foo`。

Function`bar`连同它与 function 的词法环境的联系`foo`是一个闭包。

函数不必为了创建闭包而*返回。*仅仅凭借它的声明，每个函数都会关闭其封闭的词法环境，形成一个闭包。

```
function foo(x) {
  var tmp = 3;

  return function (y) {
    console.log(x + y + (++tmp)); // will also log 16
  }
}

var bar = foo(2);
bar(10); // 16
bar(10); // 17
```

上面的函数也会记录 16，因为里面的代码`bar`仍然可以引用参数`x`和变量`tmp`，即使它们不再直接在范围内。

但是，由于`tmp`仍然在 inside`bar`的闭包中徘徊，它可以被递增。每次调用时都会递增`bar`。

最简单的闭包示例如下：

```
var a = 10;

function test() {
  console.log(a); // will output 10
  console.log(b); // will output 6
}
var b = 6;
test();
```

当调用 JavaScript 函数时，`ec`会创建一个新的执行上下文。连同函数参数和目标对象，此执行上下文还接收到调用执行上下文的词法环境的链接，这意味着在外部词法环境中声明的变量（在上面的示例中，`a`和`b`）都可以从`ec`.

每个函数都会创建一个闭包，因为每个函数都有一个指向其外部词法环境的链接。

请注意，变量*本身*在闭包中是可见的，*而不是*副本。

* * *

## 回答 #3

> 赞同：2547
> 
> 时间：2011-06-24T18:49:16.953

前言：这个答案是在问题是：

> 就像老阿尔伯特说的：“如果你不能向一个 6 岁的孩子解释它，你自己真的不明白。”好吧，我试图向一个 27 岁的朋友解释 JS 闭包，但完全失败了。
> 
> 任何人都可以认为我 6 岁并且对那个主题非常感兴趣吗？

我很确定我是仅有的几个试图从字面上理解最初问题的人之一。从那以后，这个问题已经发生了好几次变异，所以我的回答现在可能看起来非常愚蠢和不合适。希望这个故事的总体思路对某些人来说仍然很有趣。

* * *

在解释困难的概念时，我非常喜欢类比和隐喻，所以让我试着讲一个故事。

**曾几何时：**

有一个公主...

```
function princess() { 
```

她生活在一个充满冒险的奇妙世界。她遇到了她的白马王子，骑着独角兽环游世界，与龙搏斗，遇到会说话的动物，以及许多其他奇幻事物。

```
 var adventures = [];

    function princeCharming() { /* ... */ }

    var unicorn = { /* ... */ },
        dragons = [ /* ... */ ],
        squirrel = "Hello!";

    /* ... */ 
```

但她总是不得不回到她枯燥的家务和成年人的世界。

```
 return { 
```

她经常告诉他们她作为公主的最新惊人冒险。

```
 story: function() {
            return adventures[adventures.length - 1];
        }
    };
} 
```

但他们看到的只是一个小女孩……

```
var littleGirl = princess(); 
```

...讲述关于魔法和幻想的故事。

```
littleGirl.story(); 
```

即使大人们知道真正的公主，他们也永远不会相信独角兽或龙，因为他们永远看不到它们。大人们说，他们只存在于小女孩的想象中。

但我们知道真相；那个带着公主的小女孩……

……真是个公主，里面有一个小女孩。

* * *

## 回答 #4

> 赞同：792
> 
> 时间：2011-09-02T15:23:39.403

认真对待这个问题，我们应该找出一个典型的 6 岁儿童的认知能力，尽管不可否认，对 JavaScript 感兴趣的人并不那么典型。

关于 [儿童发展：5 至 7 年](http://www.howkidsdevelop.com/5-7years.html)，它说：

> 您的孩子将能够遵循两步指示。例如，如果您对您的孩子说：“去厨房给我拿一个垃圾袋”，他们将能够记住那个方向。

我们可以用这个例子来解释闭包，如下：

> 厨房是一个有一个局部变量的闭包，叫做`trashBags`。厨房里有一个函数叫做`getTrashBag`拿一个垃圾袋然后把它还回去。

我们可以像这样在 JavaScript 中编写代码：

```
function makeKitchen() {
  var trashBags = ['A', 'B', 'C']; // only 3 at first

  return {
    getTrashBag: function() {
      return trashBags.pop();
    }
  };
}

var kitchen = makeKitchen();

console.log(kitchen.getTrashBag()); // returns trash bag C
console.log(kitchen.getTrashBag()); // returns trash bag B
console.log(kitchen.getTrashBag()); // returns trash bag A
```

进一步解释为什么闭包很有趣：

*   每次`makeKitchen()`调用时，都会创建一个新的闭包，并带有自己的独立`trashBags`.
*   该`trashBags`变量是每个厨房内部的本地变量，无法在外部访问，但该`getTrashBag`属性的内部函数确实可以访问它。
*   每个函数调用都会创建一个闭包，但没有必要保留闭包，除非可以从闭包外部调用可以访问闭包内部的内部函数。`getTrashBag`在这里用函数返回对象。

* * *

## 回答 #5

> 赞同：610
> 
> 时间：2013-02-26T19:40:50.790

# 稻草人

我需要知道一个按钮被点击了多少次，并在每三次点击时做一些事情......

## 相当明显的解决方案

```
// Declare counter outside event handler's scope
var counter = 0;
var element = document.getElementById('button');

element.addEventListener("click", function() {
  // Increment outside counter
  counter++;

  if (counter === 3) {
    // Do something every third time
    console.log("Third time's the charm!");

    // Reset counter
    counter = 0;
  }
});
```

```
<button id="button">Click Me!</button>
```

现在这将起作用，但它确实通过添加一个变量来侵入外部范围，该变量的唯一目的是跟踪计数。在某些情况下，这会更可取，因为您的外部应用程序可能需要访问此信息。但在这种情况下，我们只更改每三次点击的行为，因此最好**将此功能包含在事件处理程序**中。

## 考虑这个选项

```
var element = document.getElementById('button');

element.addEventListener("click", (function() {
  // init the count to 0
  var count = 0;

  return function(e) { // <- This function becomes the click handler
    count++; //    and will retain access to the above `count`

    if (count === 3) {
      // Do something every third time
      console.log("Third time's the charm!");

      //Reset counter
      count = 0;
    }
  };
})());
```

```
<button id="button">Click Me!</button>
```

注意这里的几件事。

在上面的例子中，我使用了 JavaScript 的闭包行为。**此行为允许任何函数无限期地访问创建它的范围。**为了实际应用这一点，我立即调用一个返回另一个函数的函数，并且因为我返回的函数可以访问内部计数变量（由于上面解释的闭包行为），这导致了一个私有范围供结果使用功能...不是那么简单吗？让我们稀释一下...

**一个简单的单行闭包**

```
//          _______________________Immediately invoked______________________
//         |                                                                |
//         |        Scope retained for use      ___Returned as the____      |
//         |       only by returned function   |    value of func     |     |
//         |             |            |        |                      |     |
//         v             v            v        v                      v     v
var func = (function() { var a = 'val'; return function() { alert(a); }; })(); 
```

返回函数之外的所有变量都对返回函数可用，但它们不能直接对返回函数对象可用...

```
func();  // Alerts "val"
func.a;  // Undefined 
```

得到它？因此，在我们的主要示例中，count 变量包含在闭包中，并且始终可供事件处理程序使用，因此它从单击到单击保持其状态。

此外，这个私有变量状态是**完全**可访问的，用于读取和分配给它的私有作用域变量。

你去吧；你现在完全封装了这种行为。

**[完整的博客文章](http://jondavidjohn.com/javascript-closure-explained-using-events/)**（包括 jQuery 注意事项）

* * *

## 回答 #6

> 赞同：528
> 
> 时间：2008-09-21T14:24:46.583

闭包很难解释，因为它们被用来使某些行为起作用，而每个人都直觉地希望这些行为起作用。我发现解释它们的最佳方式（以及*我*了解它们所做的方式）是想象没有它们的情况：

```
const makePlus = function(x) {
    return function(y) { return x + y; };
}

const plus5 = makePlus(5);
console.log(plus5(3));
```

如果 JavaScript*不*知道闭包会发生什么？只需将最后一行中的调用替换为其方法体（这基本上是函数调用所做的），您将得到：

```
console.log(x + 3); 
```

现在， 的定义在`x`哪里？我们没有在当前范围内定义它。唯一的解决方案是让它`plus5` *携带*它的范围（或者更确切地说，它的父范围）。这种方式`x`是明确定义的，并且绑定到值 5。

* * *

## 回答 #7

> 赞同：406
> 
> 时间：2008-09-21T14:20:29.183

**TLDR**

闭包是函数与其外部词法（即编写的）环境之间的链接，这样在该环境中定义的标识符（变量、参数、函数声明等）在函数内部都是可见的，无论何时或从函数被调用的地方。

**细节**

在 ECMAScript 规范的术语中，闭包可以说是通过[`[[Environment]]`](https://www.ecma-international.org/ecma-262/10.0/index.html#sec-functioninitialize)每个函数对象的引用来实现的，它指向定义函数的[词法环境。](https://www.ecma-international.org/ecma-262/10.0/index.html#sec-lexical-environments)

当通过内部[`[[Call]]`](https://www.ecma-international.org/ecma-262/10.0/index.html#sec-ecmascript-function-objects-call-thisargument-argumentslist)方法调用函数[`[[Environment]]`](https://www.ecma-international.org/ecma-262/10.0/index.html#sec-functioninitialize)时，函数对象上的引用被复制到新创建的[执行上下文](https://www.ecma-international.org/ecma-262/10.0/index.html#sec-execution-contexts)（堆栈帧）的[环境记录的](https://www.ecma-international.org/ecma-262/10.0/index.html#sec-environment-records)*外部环境引用中。*

在下面的例子中，函数`f`关闭了全局执行上下文的词法环境：

```
function f() {} 
```

在下面的示例中，函数`h`关闭了 function 的词法环境`g`，而后者又关闭了全局执行上下文的词法环境。

```
function g() {
    function h() {}
} 
```

如果内部函数由外部函数返回，则外部词法环境将在外部函数返回后持续存在。这是因为如果最终调用内部函数，则外部词法环境需要可用。

在下面的例子中，function`j`关闭了 function 的词法环境`i`，这意味着在 function完成执行很久之后，该变量`x`在 function 内部是可见的：`j``i`

```
function i() {
    var x = 'mochacchino'
    return function j() {
        console.log('Printing the value of x, from within function j: ', x)
    }
} 

const k = i()
setTimeout(k, 500) // invoke k (which is j) after 500ms
```

在闭包中，外部词法环境中的变量*本身*是可用的，*而不是*副本。

```
function l() {
  var y = 'vanilla';

  return {
    setY: function(value) {
      y = value;
    },
    logY: function(value) {
      console.log('The value of y is: ', y);
    }
  }
}

const o = l()
o.logY() // The value of y is: vanilla
o.setY('chocolate')
o.logY() // The value of y is: chocolate
```

通过外部环境引用在执行上下文之间链接的词汇环境链形成了一个*范围链*，并定义了对任何给定函数可见的标识符。

**请注意，为了提高清晰度和准确性，此答案已与原始答案进行了重大更改。**

* * *

## 回答 #8

> 赞同：395
> 
> 时间：2013-06-06T10:22:55.060

好的，6 岁的闭包爱好者。你想听听最简单的闭包例子吗？

让我们想象下一种情况：司机坐在车里。那辆车在飞机里面。飞机在机场。即使飞机离开机场，司机在车外但在飞机内访问东西的能力是封闭的。就是这样。当您 27 岁时，请查看[更详细的说明](https://stackoverflow.com/a/111200/1393791)或以下示例。

这是我如何将我的飞机故事转换为代码的方法。

```
var plane = function(defaultAirport) {

  var lastAirportLeft = defaultAirport;

  var car = {
    driver: {
      startAccessPlaneInfo: function() {
        setInterval(function() {
          console.log("Last airport was " + lastAirportLeft);
        }, 2000);
      }
    }
  };
  car.driver.startAccessPlaneInfo();

  return {
    leaveTheAirport: function(airPortName) {
      lastAirportLeft = airPortName;
    }
  }
}("Boryspil International Airport");

plane.leaveTheAirport("John F. Kennedy");
```

* * *

## 回答 #9

> 赞同：375
> 
> 时间：2010-04-08T13:54:40.057

这是为了消除其他一些答案中出现的关于闭包的几个（可能的）误解。

*   **闭包不仅在您返回内部函数时创建。**事实上，封闭函数*根本不需要返回*就可以创建它的闭包。相反，您可以将内部函数分配给外部范围内的变量，或者将其作为参数传递给另一个可以立即或稍后调用的函数。因此，封闭函数的闭包可能会在*调用封闭函数时立即*创建，因为无论何时调用内部函数，在封闭函数返回之前或之后，任何内部函数都可以访问该闭包。
*   **闭包不引用其范围内变量的*旧值的副本。***变量本身是闭包的一部分，因此访问其中一个变量时看到的值是访问时的最新值。这就是为什么在循环内部创建内部函数可能很棘手的原因，因为每个函数都可以访问相同的外部变量，而不是在创建或调用函数时获取变量的副本。
*   **闭包中的“变量”包括在函数**中声明的任何命名函数。它们还包括函数的参数。闭包还可以访问其包含的闭包变量，一直到全局范围。
*   **闭包使用内存，但它们不会导致内存泄漏**，因为 JavaScript 本身会清理自己未引用的循环结构。当 Internet Explorer 未能断开引用闭包的 DOM 属性值时，会创建涉及闭包的内存泄漏，从而保持对可能循环结构的引用。

* * *

## 回答 #10

> 赞同：244
> 
> 时间：2011-02-07T20:57:36.613

不久前我写了一篇博客文章来解释闭包。这就是我所说的关于你**为什么**想要一个闭包的内容。

> 闭包是一种让函数具有**持久的私有变量**的方法- 即只有一个函数知道的变量，它可以在其中跟踪以前运行时的信息。

从这个意义上说，它们让函数的行为有点像具有私有属性的对象。

全文：

[那么这些关闭的东西是什么？](http://sleeplessgeek.blogspot.com/2009/12/so-what-are-these-closure-thingys.html)

* * *

## 回答 #11

> 赞同：220
> 
> 时间：2013-06-25T22:22:24.077

## **闭包很简单：**

下面的简单示例涵盖了 JavaScript 闭包的所有要点。^*  

这是一家生产可以加法和乘法的计算器的工厂：

```
function make_calculator() {
  var n = 0; // this calculator stores a single number n
  return {
    add: function(a) {
      n += a;
      return n;
    },
    multiply: function(a) {
      n *= a;
      return n;
    }
  };
}

first_calculator = make_calculator();
second_calculator = make_calculator();

first_calculator.add(3); // returns 3
second_calculator.add(400); // returns 400

first_calculator.multiply(11); // returns 33
second_calculator.multiply(10); // returns 4000 
```

**关键点：**每次调用`make_calculator`都会创建一个新的局部变量，该变量在返回后很长一段时间内`n`仍可供该计算器`add`和`multiply`函数使用。`make_calculator`

*如果您熟悉堆栈帧，这些计算器看起来很奇怪：它们如何在返回`n`后继续访问`make_calculator`？答案是想象 JavaScript 不使用“堆栈帧”，而是使用“堆帧”，它可以在使它们返回的函数调用之后持续存在。*

像`add`and`multiply`这样的内部函数访问在外部函数^(**)中声明的变量，称为*闭包*。

**这就是闭包的全部内容。**

* * *

^(^*例如，它涵盖了[另一个答案](https://stackoverflow.com/a/111111/706054)中给出的“Closures for Dummies”文章中的所有要点，除了示例 6，它只是表明可以在声明变量之前使用变量，这是一个很好知道的事实，但与闭包完全无关。它还涵盖了[已接受答案中的](https://stackoverflow.com/a/111200/706054)所有点，除了点 (1) 函数将其参数复制到局部变量（命名函数参数）中，以及 (2) 复制数字会创建一个新数字，但复制对象引用为您提供对同一对象的另一个引用。这些也很高兴知道，但又与闭包完全无关。它也与[此答案](https://stackoverflow.com/a/111114/706054)中的示例非常相似，但更短且不那么抽象。它不包括要点[这个答案](https://stackoverflow.com/a/17200991/706054)或[这个评论](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work/17308587?noredirect=1#comment26377355_111111)，即 JavaScript 很难插入*当前*将循环变量的值添加到内部函数中：“插入”步骤只能使用包含内部函数并在每次循环迭代时调用的辅助函数来完成。（严格来说，内部函数访问辅助函数的变量副本，而不是插入任何东西。）同样，在创建闭包时非常有用，但不是闭包是什么或它如何工作的一部分。由于闭包在 ML 等函数式语言中的工作方式不同，因此存在额外的混淆，其中变量绑定到值而不是存储空间，提供了以某种方式（即“插入”方式）理解闭包的人源源不断的流对于 JavaScript 来说完全不正确，其中变量总是绑定到存储空间，而不是值。)

^(^(**)任何外部函数，如果有几个嵌套，甚至在全局上下文中，正如[这个答案](https://stackoverflow.com/a/5099447/706054)清楚地指出的那样。)

* * *

## 回答 #12

> 赞同：214
> 
> 时间：2014-02-17T21:14:08.433

最初的问题有一个引用：

> 如果你不能向一个六岁的孩子解释它，你自己就真的不明白。

这就是我试图向一个真正的六岁孩子解释的方式：

你知道成年人如何拥有一所房子，他们称之为家吗？当妈妈有孩子时，孩子并没有真正拥有任何东西，对吗？但是它的父母有房子，所以每当有人问孩子“你的家在哪里？”时，他/她可以回答“那房子！”，并指向父母的房子。“封闭”是孩子总是（即使在国外）能够说它有一个家的能力，即使它真的是父母的房子。

* * *

## 回答 #13

> 赞同：207
> 
> 时间：2010-04-20T08:16:46.820

## [你能向 5 岁的孩子解释关闭吗？*](https://stackoverflow.com/questions/1700514/how-do-you-explain-closure-to-a-5-year-old/1700627#1700627)

我还是觉得[谷歌的解释](http://code.google.com/apis/ajax/playground/?exp=maps#closure_simple)很好用，简洁明了：

```
/*
*    When a function is defined in another function and it
*    has access to the outer function's context even after
*    the outer function returns.
*
* An important concept to learn in JavaScript.
*/

function outerFunction(someNum) {
    var someString = 'Hey!';
    var content = document.getElementById('content');
    function innerFunction() {
        content.innerHTML = someNum + ': ' + someString;
        content = null; // Internet Explorer memory leak for DOM reference
    }
    innerFunction();
}

outerFunction(1);​ 
```

![证明即使内部函数没有返回，这个例子也会创建一个闭包](https://i.stack.imgur.com/N0mn0.png)

[*AC#问题]

* * *

## 回答 #14

> 赞同：182
> 
> 时间：2013-06-19T20:45:55.230

我倾向于通过 GOOD/BAD 比较学得更好。我喜欢看到有人可能会遇到的工作代码，然后是非工作代码。我整理了[一个 jsFiddle](http://jsfiddle.net/KMQZK/)进行比较，并尝试将差异归结为我能想出的最简单的解释。

## 正确完成的闭包：

```
console.log('CLOSURES DONE RIGHT');

var arr = [];

function createClosure(n) {
    return function () {
        return 'n = ' + n;
    }
}

for (var index = 0; index < 10; index++) {
    arr[index] = createClosure(index);
}

for (var index in arr) {
    console.log(arr[index]());
} 
```

*   上面的代码`createClosure(n)`在循环的每次迭代中被调用。请注意，我命名该变量`n`是为了强调它是在新函数范围内创建的**新**变量，`index`并且与绑定到外部范围的变量不同。

*   这会创建一个新范围并`n`绑定到该范围；这意味着我们有 10 个单独的范围，每个迭代一个。

*   `createClosure(n)`返回一个函数，该函数返回该范围内的 n。

*   在每个范围内`n`都绑定到它在`createClosure(n)`调用时所具有的任何值，因此返回的嵌套函数将始终返回`n`它在`createClosure(n)`调用时所具有的值。

## 错误的闭包：

```
console.log('CLOSURES DONE WRONG');

function createClosureArray() {
    var badArr = [];

    for (var index = 0; index < 10; index++) {
        badArr[index] = function () {
            return 'n = ' + index;
        };
    }
    return badArr;
}

var badArr = createClosureArray();

for (var index in badArr) {
    console.log(badArr[index]());
} 
```

*   在上面的代码中，循环在`createClosureArray()`函数内移动，现在函数只返回完成的数组，乍一看似乎更直观。

*   可能不明显的是，since`createClosureArray()`仅调用一次，仅为此函数创建一个作用域，而不是为循环的每次迭代创建一个作用域。

*   在这个函数中定义了一个名为的变量`index`。循环运行并将函数添加到返回的数组中`index`。请注意，这是在只被调用一次`index`的函数中定义的。`createClosureArray`

*   因为`createClosureArray()`函数内只有一个作用域，`index`所以只绑定到该作用域内的一个值。换句话说，每次循环更改 的值时`index`，它都会更改在该范围内引用它的所有内容。

*   添加到数组中的所有函数都`index`从定义它的父作用域返回 SAME 变量，而不是像第一个示例那样来自 10 个不同作用域的 10 个不同变量。最终结果是所有 10 个函数都从同一作用域返回相同的变量。

*   循环完成并`index`完成修改后，最终值为 10，因此添加到数组中的每个函数都返回单个`index`变量的值，该变量现在设置为 10。

## 结果

> 正确完成的闭包
> n = 0
> n = 1
> n = 2
> n = 3
> n = 4
> n = 5
> n = 6
> n = 7
> n = 8
> n = 9
> 
> 错误的闭包
> n = 10
> n = 10
> n = 10
> n = 10
> n = 10
> n = 10
> n = 10
> n = 10
> n = 10
> n = 10

* * *

## 回答 #15

> 赞同：168
> 
> 时间：2011-07-30T14:27:34.573

[关于闭包的维基百科](http://en.wikipedia.org/wiki/Closure_(computer_science))：

> 在计算机科学中，闭包是一个函数以及该函数的非本地名称（自由变量）的引用环境。

从技术上讲，在[JavaScript](http://en.wikipedia.org/wiki/JavaScript)中，**每个函数都是一个闭包**。它始终可以访问在周围范围内定义的变量。

由于**JavaScript 中的作用域定义构造是一个函数**，而不是许多其他语言中的代码块，所以**我们通常所说的 JavaScript中的*闭包***是一个**函数，该函数使用已执行的周围函数中定义的非局部变量**。

闭包通常用于创建带有一些隐藏私有数据的函数（但并非总是如此）。

```
var db = (function() {
    // Create a hidden object, which will hold the data
    // it's inaccessible from the outside.
    var data = {};

    // Make a function, which will provide some access to the data.
    return function(key, val) {
        if (val === undefined) { return data[key] } // Get
        else { return data[key] = val } // Set
    }
    // We are calling the anonymous surrounding function,
    // returning the above inner function, which is a closure.
})();

db('x')    // -> undefined
db('x', 1) // Set x to 1
db('x')    // -> 1
// It's impossible to access the data object itself.
// We are able to get or set individual it. 
```

EMS

上面的示例使用了一个匿名函数，该函数执行了一次。但它不一定是。它可以被命名（例如`mkdb`）并在以后执行，每次调用它时都会生成一个数据库函数。每个生成的函数都有自己的隐藏数据库对象。闭包的另一个使用示例是当我们不返回一个函数，而是一个包含多个用于不同目的的函数的对象时，每个函数都可以访问相同的数据。

* * *

## 回答 #16

> 赞同：138
> 
> 时间：2011-07-26T04:37:32.910

我整理了一个交互式 JavaScript 教程来解释闭包的工作原理。 [什么是闭包？](http://nathansjslessons.appspot.com)

这是其中一个例子：

```
var create = function (x) {
    var f = function () {
        return x; // We can refer to x here!
    };
    return f;
};
// 'create' takes one argument, creates a function

var g = create(42);
// g is a function that takes no arguments now

var y = g();
// y is 42 here 
```

* * *

## 回答 #17

> 赞同：134
> 
> 时间：2015-05-11T16:35:17.483

> 孩子们将永远记得他们与父母分享的秘密，即使在他们的父母离开之后。这就是函数的闭包。

JavaScript 函数的秘密是私有变量

```
var parent = function() {
 var name = "Mary"; // secret
} 
```

每次调用它时，都会创建局部变量“name”并命名为“Mary”。并且每次函数退出时，变量都会丢失并且名称会被遗忘。

正如您可能猜到的，因为每次调用函数时都会重新创建变量，并且没有其他人会知道它们，所以必须有一个秘密的地方来存储它们。它可以称为**密室**或**堆栈**或**本地范围**，但这并不重要。我们知道他们在那里，某处，隐藏在记忆中。

但是，在 JavaScript 中有一个非常特殊的东西，即在其他函数内部创建的函数也可以知道其父级的局部变量并在它们存在时保留它们。

```
var parent = function() {
  var name = "Mary";
  var child = function(childName) {
    // I can also see that "name" is "Mary"
  }
} 
```

因此，只要我们在父函数中，它就可以创建一个或多个子函数，这些子函数确实共享来自秘密位置的秘密变量。

但可悲的是，如果 child 也是其 parent 函数的私有变量，那么当 parent 结束时它也会死去，秘密也会随之而死。

所以要活下去，孩子必须在为时已晚之前离开

```
var parent = function() {
  var name = "Mary";
  var child = function(childName) {
    return "My name is " + childName  +", child of " + name; 
  }
  return child; // child leaves the parent ->
}
var child = parent(); // < - and here it is outside 
```

而现在，即使玛丽“不再跑步”，她的记忆并没有丢失，她的孩子将永远记得她的名字和他们在一起时分享的其他秘密。

所以，如果你叫孩子“爱丽丝”，她会回应

```
child("Alice") => "My name is Alice, child of Mary" 
```

这就是所有要告诉的。

* * *

## 回答 #18

> 赞同：108
> 
> 时间：2015-02-13T19:39:26.907

**我不明白为什么这里的答案如此复杂。**

这是一个闭包：

```
var a = 42;

function b() { return a; } 
```

是的。您可能一天会使用很多次。

> 没有理由相信闭包是解决特定问题的复杂设计技巧。不，闭包只是**从函数声明（未运行）的角度来看，**使用来自更高范围的变量。
> 
> 现在它*允许*您做的事情可以更加壮观，请参阅其他答案。

* * *

## 回答 #19

> 赞同：96
> 
> 时间：2010-04-20T08:10:17.230

dlaliberte 的第一点示例：

> 闭包不仅在您返回内部函数时创建。实际上，封闭函数根本不需要返回。您可以改为将内部函数分配给外部作用域中的变量，或者将其作为参数传递给另一个可以立即使用的函数。因此，封闭函数的闭包可能在调用封闭函数时已经存在，因为任何内部函数只要调用它就可以访问它。

```
var i;
function foo(x) {
    var tmp = 3;
    i = function (y) {
        console.log(x + y + (++tmp));
    }
}
foo(2);
i(3); 
```

* * *

## 回答 #20

> 赞同：94
> 
> 时间：2008-09-21T21:39:58.097

闭包是内部函数可以访问其外部函数中的变量的地方。这可能是你能得到的关于闭包的最简单的单行解释。

* * *

## 回答 #21

> 赞同：88
> 
> 时间：2012-05-03T18:16:54.320

我知道已经有很多解决方案，但我想这个小而简单的脚本对于演示这个概念很有用：

```
// makeSequencer will return a "sequencer" function
var makeSequencer = function() {
    var _count = 0; // not accessible outside this function
    var sequencer = function () {
        return _count++;
    }
    return sequencer;
}

var fnext = makeSequencer();
var v0 = fnext();     // v0 = 0;
var v1 = fnext();     // v1 = 1;
var vz = fnext._count // vz = undefined 
```

* * *

## 回答 #22

> 赞同：85
> 
> 时间：2011-07-20T03:51:27.377

你正在睡觉，你邀请丹。你告诉丹带一个 Xbox 控制器。

丹邀请保罗。丹让保罗带一个控制器。有多少控制器被带到聚会上？

```
function sleepOver(howManyControllersToBring) {

    var numberOfDansControllers = howManyControllersToBring;

    return function danInvitedPaul(numberOfPaulsControllers) {
        var totalControllers = numberOfDansControllers + numberOfPaulsControllers;
        return totalControllers;
    }
}

var howManyControllersToBring = 1;

var inviteDan = sleepOver(howManyControllersToBring);

// The only reason Paul was invited is because Dan was invited. 
// So we set Paul's invitation = Dan's invitation.

var danInvitedPaul = inviteDan(howManyControllersToBring);

alert("There were " + danInvitedPaul + " controllers brought to the party."); 
```

* * *

## 回答 #23

> 赞同：85
> 
> 时间：2015-08-15T13:38:59.897

*[Closures](http://javascript.info/tutorial/closures)*的作者已经很好地解释了闭包，解释了我们需要它们的原因，还解释了理解闭包所必需的 LexicalEnvironment。
这是摘要：

如果访问了一个变量，但它不是本地变量怎么办？像这儿：

[![在此处输入图像描述](https://i.stack.imgur.com/SLlVB.png)](https://i.stack.imgur.com/SLlVB.png)

在这种情况下，解释器在外部找到变量[`LexicalEnvironment`](http://javascript.info/tutorial/initialization)在这种情况下，解释器在外部对象

该过程包括两个步骤：

1.  首先，当一个函数 f 被创建时，它并不是在一个空白的空间中创建的。有一个当前的 LexicalEnvironment 对象。在上述情况下，它是窗口（a 在函数创建时未定义）。

[![在此处输入图像描述](https://i.stack.imgur.com/0KBin.png)](https://i.stack.imgur.com/0KBin.png)

当一个函数被创建时，它会获得一个隐藏属性，名为 [[Scope]]，它引用当前的 LexicalEnvironment。

[![在此处输入图像描述](https://i.stack.imgur.com/U3yt7.png)](https://i.stack.imgur.com/U3yt7.png)

如果读取了变量，但在任何地方都找不到，则会产生错误。

**嵌套函数**

函数可以相互嵌套，形成一个 LexicalEnvironments 链，也可以称为作用域链。

[![在此处输入图像描述](https://i.stack.imgur.com/2hUwr.png)](https://i.stack.imgur.com/2hUwr.png)

因此，函数 g 可以访问 g、a 和 f。

**闭包**

在外部函数完成后，嵌套函数可能会继续存在：

[![在此处输入图像描述](https://i.stack.imgur.com/S1mlB.png)](https://i.stack.imgur.com/S1mlB.png)

标记词汇环境：

[![在此处输入图像描述](https://i.stack.imgur.com/BzUNi.png)](https://i.stack.imgur.com/BzUNi.png)

正如我们所见，`this.say`是用户对象中的一个属性，所以它在用户完成后继续存在。

如果你还记得，当它被创建时，它（就像每个函数一样）获得对当前 LexicalEnvironment`this.say`的内部引用。`this.say.[[Scope]]`因此，当前 User 执行的 LexicalEnvironment 保留在内存中。User 的所有变量也是它的属性，所以它们也被小心保存，而不是像往常一样垃圾。

**关键是要确保如果内部函数将来想要访问外部变量，它能够这样做。**

总结一下：

1.  内部函数保持对外部 LexicalEnvironment 的引用。
2.  即使外部函数完成，内部函数也可以随时从中访问变量。
3.  浏览器将 LexicalEnvironment 及其所有属性（变量）保存在内存中，直到有一个内部函数引用它。

这称为闭包。

* * *

## 回答 #24

> 赞同：78
> 
> 时间：2011-02-24T01:37:53.960

JavaScript 函数可以访问它们的：

1.  论据
2.  局部变量（即它们的局部变量和局部函数）
3.  环境，其中包括：
    *   全局变量，包括 DOM
    *   外部函数中的任何东西

如果一个函数访问它的环境，那么这个函数就是一个闭包。

请注意，外部函数不是必需的，尽管它们确实提供了我不在这里讨论的好处。通过访问其环境中的数据，闭包使该数据保持活动状态。在外部/内部函数的子情况下，外部函数可以创建本地数据并最终退出，但是，如果任何内部函数在外部函数退出后仍然存在，那么内部函数会保留外部函数的本地数据活。

使用全局环境的闭包示例：

想象一下 Stack Overflow Vote-Up 和 Vote-Down 按钮事件被实现为闭包，voteUp_click 和 voteDown_click，它们可以访问全局定义的外部变量 isVotedUp 和 isVotedDown。（为简单起见，我指的是 StackOverflow 的问题投票按钮，而不是回答投票按钮的数组。）

当用户点击 VoteUp 按钮时，voteUp_click 函数会检查 isVotedDown == true 以确定是投赞成票还是仅仅取消投反对票。函数 voteUp_click 是一个闭包，因为它正在访问它的环境。

```
var isVotedUp = false;
var isVotedDown = false;

function voteUp_click() {
  if (isVotedUp)
    return;
  else if (isVotedDown)
    SetDownVote(false);
  else
    SetUpVote(true);
}

function voteDown_click() {
  if (isVotedDown)
    return;
  else if (isVotedUp)
    SetUpVote(false);
  else
    SetDownVote(true);
}

function SetUpVote(status) {
  isVotedUp = status;
  // Do some CSS stuff to Vote-Up button
}

function SetDownVote(status) {
  isVotedDown = status;
  // Do some CSS stuff to Vote-Down button
} 
```

所有这四个函数都是闭包，因为它们都访问它们的环境。

* * *

## 回答 #25

> 赞同：60
> 
> 时间：2014-10-28T23:53:18.010

作为一个 6 岁孩子的父亲，目前正在教年幼的孩子（而且是一个相对新手，没有受过正规教育，因此需要进行更正），我认为这节课最好通过动手游戏进行。如果 6 岁的孩子已经准备好理解什么是关闭，那么他们已经足够大，可以自己动手了。我建议将代码粘贴到 jsfiddle.net 中，稍微解释一下，然后让他们独自创作一首独特的歌曲。下面的解释性文字可能更适合 10 岁的孩子。

```
function sing(person) {

    var firstPart = "There was " + person + " who swallowed ";

    var fly = function() {
        var creature = "a fly";
        var result = "Perhaps she'll die";
        alert(firstPart + creature + "\n" + result);
    };

    var spider = function() {
        var creature = "a spider";
        var result = "that wiggled and jiggled and tickled inside her";
        alert(firstPart + creature + "\n" + result);
    };

    var bird = function() {
        var creature = "a bird";
        var result = "How absurd!";
        alert(firstPart + creature + "\n" + result);
    };

    var cat = function() {
        var creature = "a cat";
        var result = "Imagine That!";
        alert(firstPart + creature + "\n" + result);
    };

    fly();
    spider();
    bird();
    cat();
}

var person="an old lady";

sing(person); 
```

**指示**

数据：数据是事实的集合。它可以是数字、文字、测量、观察，甚至只是对事物的描述。你不能触摸它、闻它或尝它。你可以写下来，说出来，听得到。您可以使用它来*创建*使用计算机的触觉气味和味道。它可以通过计算机使用代码变得有用。

代码：上面所有的文字都称为*代码*。它是用 JavaScript 编写的。

JAVASCRIPT：JavaScript 是一种语言。就像英语或法语或中文一样是语言。计算机和其他电子处理器可以理解许多语言。为了让计算机理解 JavaScript，它需要一个解释器。想象一下，如果一位只会说俄语的老师来学校教你的课。当老师说“все садятся”时，全班都听不懂。但幸运的是，你班上有一个俄罗斯学生告诉大家这意味着“每个人都坐下”——所以你们都这样做了。课堂就像一台电脑，俄罗斯学生是翻译。对于 JavaScript，最常见的解释器称为浏览器。

浏览器：当您在计算机、平板电脑或手机上连接到 Internet 以访问网站时，您使用的是浏览器。您可能知道的示例包括 Internet Explorer、Chrome、Firefox 和 Safari。浏览器可以理解 JavaScript 并告诉计算机它需要做什么。JavaScript 指令称为函数。

FUNCTION：JavaScript 中的函数就像一个工厂。它可能是一个只有一台机器的小工厂。或者它可能包含许多其他小工厂，每个工厂都有许多机器做不同的工作。在现实生活中的服装工厂中，您可能会有大量的布料和线轴进入，T 恤和牛仔裤会出来。我们的 JavaScript 工厂只处理数据，它不能缝制、钻孔或熔化金属。在我们的 JavaScript 工厂中，数据输入和数据输出。

所有这些数据的东西听起来有点无聊，但真的很酷；我们可能有一个函数可以告诉机器人晚餐要做什么。假设我邀请你和你的朋友来我家。你最喜欢鸡腿，我喜欢香肠，你的朋友总是想要你想要的，而我的朋友不吃肉。

我没有时间去购物，所以函数需要知道我们冰箱里有什么来做决定。每种食材都有不同的烹饪时间，我们希望机器人同时加热所有食材。我们需要为函数提供我们喜欢什么的数据，函数可以与冰箱“对话”，函数可以控制机器人。

函数通常具有名称、括号和大括号。像这样：

```
function cookMeal() {  /*  STUFF INSIDE THE FUNCTION  */  } 
```

*请注意`/*...*/`并`//`停止浏览器读取的代码。*

NAME：你可以调用任何你想要的词的函数。“cookMeal”这个例子是典型的将两个单词连接在一起并在开头给第二个单词一个大写字母的例子——但这不是必需的。它不能有空格，也不能是一个数字。

PARENTHESES：“Parentheses”或者`()`是 JavaScript 函数工厂门上的信箱或街道上的邮箱，用于向工厂发送信息包。有时，邮箱可能会被标记*为* `cookMeal(you, me, yourFriend, myFriend, fridge, dinnerTime)`，在这种情况下，您知道必须提供哪些数据。

大括号：看起来像这样`{}`的“大括号”是我们工厂的有色窗户。工厂里面可以看到外面，外面看不到里面。

**上面的长代码示例**

我们的代码以*function*开头，所以我们知道它是一个！然后是函数的名称*——*这是我自己对函数的描述。然后括号*()*。括号总是用于函数。有的时候是空的，有的时候里面有东西。这个里面有一个词：`(person)`。在这之后有一个像这样的支架`{`。这标志着函数*sing()*的开始。它有一个伙伴，像这样标记*sing()的结束*`}`

```
function sing(person) {  /* STUFF INSIDE THE FUNCTION */  } 
```

所以这个函数可能与唱歌有关，并且可能需要一些关于一个人的数据。它内部有指令来处理这些数据。

现在，在函数*sing()*之后，靠近代码末尾的是行

```
var person="an old lady"; 
```

VARIABLE：字母*var*代表“变量”。变量就像一个信封。这个信封的外面标有“人”。在里面它包含一张纸条，上面写着我们的函数需要的信息，一些字母和空格像一根绳子一样连接在一起（它被称为字符串），组成一个短语“一位老妇人”。我们的信封可以包含其他类型的东西，例如数字（称为整数）、指令（称为函数）、列表（称为*数组*）。因为这个变量写在所有大括号的外面`{}`，而且当你在大括号里面时，你可以通过有色窗口看到外面，这个变量可以从代码中的任何地方看到。我们称之为“全局变量”。

GLOBAL VARIABLE：*person*是一个全局变量，这意味着如果您将其值从“an old lady”更改为“a young man”，则此*人*将继续保持年轻状态，直到您决定再次更改它并且其中的任何其他函数代码可以看出是个年轻人。按下`F12`按钮或查看选项设置以打开浏览器的开发者控制台并输入“person”以查看该值是什么。键入`person="a young man"`以更改它，然后再次键入“人”以查看它已更改。

在这之后我们有这条线

```
sing(person); 
```

这一行正在调用函数，就好像它在调用一只狗一样

> “来*唱歌*，来接*人*！”

当浏览器加载了 JavaScript 代码并到达这一行时，它将启动该函数。我把这一行放在最后，以确保浏览器拥有运行它所需的所有信息。

功能定义动作 - 主要功能是关于唱歌。它包含一个名为*firstPart*的变量，该变量适用于歌曲中每节经文的关于人的歌唱：“There was” + person + “who didn't”。如果您在控制台中键入*firstPart*，您将不会得到答案，因为该变量被锁定在一个函数中 - 浏览器无法在大括号的着色窗口内看到。

*闭包：闭包是大sing()*函数内部的较小函数。大工厂里面的小工厂。它们每个都有自己的大括号，这意味着它们内部的变量不能从外部看到。这就是为什么变量的名称（*生物*和*结果*）可以在闭包中重复但具有不同的值。如果您在控制台窗口中键入这些变量名称，您将不会得到它的值，因为它被两层有色窗口隐藏。

闭包都知道*sing()*函数中名为*firstPart*的变量是什么，因为它们可以从有色窗口向外看。

关闭后排行

```
fly();
spider();
bird();
cat(); 
```

sing() 函数将按照给定的顺序调用这些函数中的每一个。然后 sing() 函数的工作就完成了。

* * *

## 回答 #26

> 赞同：58
> 
> 时间：2013-03-04T18:27:41.977

好的，与一个 6 岁的孩子交谈，我可能会使用以下联想。

> 想象一下——你在整个房子里和你的小兄弟姐妹一起玩，你带着你的玩具四处走动，把一些玩具带到你哥哥的房间里。过了一会儿，你哥哥从学校回来，去了他的房间，他锁在里面，所以现在你不能再直接接触放在那里的玩具了。但是你可以敲门向你的兄弟要那些玩具。这称为玩具的*闭合*；你哥给你补了，现在已经进入外*域*了。

比较一下门被风锁住，里面没人（一般功能执行），然后发生局部火灾并烧毁房间（垃圾收集器：D），然后建造了一个新房间，现在你可以离开的情况那里有另一个玩具（新功能实例），但永远不会得到与第一个房间实例中相同的玩具。

对于一个先进的孩子，我会放一些类似下面的东西。它并不完美，但它让你感觉到它是什么：

```
function playingInBrothersRoom (withToys) {
  // We closure toys which we played in the brother's room. When he come back and lock the door
  // your brother is supposed to be into the outer [[scope]] object now. Thanks god you could communicate with him.
  var closureToys = withToys || [],
      returnToy, countIt, toy; // Just another closure helpers, for brother's inner use.

  var brotherGivesToyBack = function (toy) {
    // New request. There is not yet closureToys on brother's hand yet. Give him a time.
    returnToy = null;
    if (toy && closureToys.length > 0) { // If we ask for a specific toy, the brother is going to search for it.

      for ( countIt = closureToys.length; countIt; countIt--) {
        if (closureToys[countIt - 1] == toy) {
          returnToy = 'Take your ' + closureToys.splice(countIt - 1, 1) + ', little boy!';
          break;
        }
      }
      returnToy = returnToy || 'Hey, I could not find any ' + toy + ' here. Look for it in another room.';
    }
    else if (closureToys.length > 0) { // Otherwise, just give back everything he has in the room.
      returnToy = 'Behold! ' + closureToys.join(', ') + '.';
      closureToys = [];
    }
    else {
      returnToy = 'Hey, lil shrimp, I gave you everything!';
    }
    console.log(returnToy);
  }
  return brotherGivesToyBack;
}
// You are playing in the house, including the brother's room.
var toys = ['teddybear', 'car', 'jumpingrope'],
    askBrotherForClosuredToy = playingInBrothersRoom(toys);

// The door is locked, and the brother came from the school. You could not cheat and take it out directly.
console.log(askBrotherForClosuredToy.closureToys); // Undefined

// But you could ask your brother politely, to give it back.
askBrotherForClosuredToy('teddybear'); // Hooray, here it is, teddybear
askBrotherForClosuredToy('ball'); // The brother would not be able to find it.
askBrotherForClosuredToy(); // The brother gives you all the rest
askBrotherForClosuredToy(); // Nothing left in there 
```

如您所见，无论房间是否上锁，仍然可以通过兄弟访问留在房间中的玩具。这是[一个 jsbin](http://jsbin.com/ubakor/9/edit)来玩它。

* * *

## 回答 #27

> 赞同：52
> 
> 时间：2012-10-25T18:12:40.640

JavaScript 中的函数不仅仅是对一组指令的引用（如在 C 语言中），它还包括一个隐藏的数据结构，该结构由对其使用的所有非局部变量（捕获的变量）的引用组成。这样的两部分函数称为闭包。JavaScript 中的每个函数都可以被认为是一个闭包。

闭包是有状态的函数。它有点类似于“this”，因为“this”也为函数提供状态，但函数和“this”是独立的对象（“t​​his”只是一个花哨的参数，也是将它永久绑定到功能是创建一个闭包）。虽然“this”和函数总是分开存在，但函数不能与其闭包分开，并且该语言没有提供访问捕获变量的方法。

因为一个词法嵌套函数引用的所有这些外部变量实际上都是其词法封闭函数链中的局部变量（全局变量可以假设为某个根函数的局部变量），并且函数的每一次执行都会创建一个新的实例它的局部变量，因此函数的每次执行都返回（或以其他方式将其传出，例如将其注册为回调）嵌套函数创建一个新闭包（具有其自己的可能唯一的一组引用的非局部变量，代表其执行语境）。

此外，必须了解 JavaScript 中的局部变量不是在堆栈帧上创建的，而是在堆上创建的，并且只有在没有人引用它们时才被销毁。当函数返回时，对其局部变量的引用会递减，但如果在当前执行期间它们成为闭包的一部分并且仍被其词法嵌套函数引用，则它们仍然可以是非空的（仅当对这些嵌套函数被返回或以其他方式转移到某些外部代码）。

一个例子：

```
function foo (initValue) {
   //This variable is not destroyed when the foo function exits.
   //It is 'captured' by the two nested functions returned below.
   var value = initValue;

   //Note that the two returned functions are created right now.
   //If the foo function is called again, it will return
   //new functions referencing a different 'value' variable.
   return {
       getValue: function () { return value; },
       setValue: function (newValue) { value = newValue; }
   }
}

function bar () {
    //foo sets its local variable 'value' to 5 and returns an object with
    //two functions still referencing that local variable
    var obj = foo(5);

    //Extracting functions just to show that no 'this' is involved here
    var getValue = obj.getValue;
    var setValue = obj.setValue;

    alert(getValue()); //Displays 5
    setValue(10);
    alert(getValue()); //Displays 10

    //At this point getValue and setValue functions are destroyed
    //(in reality they are destroyed at the next iteration of the garbage collector).
    //The local variable 'value' in the foo is no longer referenced by
    //anything and is destroyed too.
}

bar(); 
```

* * *

## 回答 #28

> 赞同：51
> 
> 时间：2013-05-16T20:52:06.083

一个六岁孩子的答案（假设他知道什么是函数，什么是变量，以及什么是数据）：

函数可以返回数据。您可以从函数返回的一种数据是另一种函数。当该新函数返回时，创建它的函数中使用的所有变量和参数都不会消失。相反，该父函数“关闭”。换句话说，除了它返回的函数之外，没有任何东西可以看到它的内部并看到它使用的变量。这个新函数有一种特殊的能力，可以回顾创建它的函数内部并查看其中的数据。

```
function the_closure() {
  var x = 4;
  return function () {
    return x; // Here, we look back inside the_closure for the value of x
  }
}

var myFn = the_closure();
myFn(); //=> 4 
```

另一种非常简单的解释方式是范围：

每当您在较大范围内创建较小范围时，较小范围将始终能够看到较大范围内的内容。

* * *

## 回答 #29

> 赞同：51
> 
> 时间：2015-03-02T18:08:17.453

也许除了最早熟的 6 岁孩子之外，其他人都略胜一筹，但有几个例子帮助我理解了 JavaScript 中的闭包概念。

闭包是一个可以访问另一个函数范围（它的变量和函数）的函数。创建闭包的最简单方法是在函数中使用函数；原因是在 JavaScript 中，函数始终可以访问其包含函数的范围。

```
function outerFunction() {
    var outerVar = "monkey";

    function innerFunction() {
        alert(outerVar);
    }

    innerFunction();
}

outerFunction();
```

警报：猴子

在上面的例子中，outerFunction 被调用，然后调用 innerFunction。请注意 outerVar 如何可用于 innerFunction，这可以通过它正确地提醒 outerVar 的值来证明。

现在考虑以下几点：

```
function outerFunction() {
    var outerVar = "monkey";

    function innerFunction() {
        return outerVar;
    }

    return innerFunction;
}

var referenceToInnerFunction = outerFunction();
alert(referenceToInnerFunction());
```

警报：猴子

referenceToInnerFunction 设置为outerFunction()，它简单地返回对innerFunction 的引用。当调用referenceToInnerFunction 时，它返回outerVar。同样，如上所述，这表明 innerFunction 可以访问 outerVar，它是 outerFunction 的变量。此外，有趣的是，即使在 outerFunction 完成执行后，它仍保留此访问权限。

这就是事情变得非常有趣的地方。如果我们要摆脱outerFunction，比如将其设置为null，您可能会认为referenceToInnerFunction 会失去对outerVar 值的访问权。但这种情况并非如此。

```
function outerFunction() {
    var outerVar = "monkey";

    function innerFunction() {
        return outerVar;
    }

    return innerFunction;
}

var referenceToInnerFunction = outerFunction();
alert(referenceToInnerFunction());

outerFunction = null;
alert(referenceToInnerFunction());
```

警报：猴子 警报：猴子

但这是怎么回事？既然 outerFunction 已设置为 null，referenceToInnerFunction 怎么还能知道 outerVar 的值？

referenceToInnerFunction 仍然可以访问outerVar 的值的原因是，当通过将innerFunction 放在outerFunction 内部首次创建闭包时，innerFunction 将对outerFunction 范围（其变量和函数）的引用添加到其范围链中。这意味着innerFunction 有一个指向所有outerFunction 变量的指针或引用，包括outerVar。因此，即使 outerFunction 已完成执行，或者即使它被删除或设置为 null，其范围内的变量（如 outerVar）仍会留在内存中，因为已返回到的 innerFunction 部分对它们的未完成引用参考内部函数。要真正从内存中释放outerVar 和outerFunction 的其余变量，您必须摆脱对它们的出色引用，

//////////

关于闭包的另外两件事需要注意。首先，闭包总是可以访问其包含函数的最后一个值。

```
function outerFunction() {
    var outerVar = "monkey";

    function innerFunction() {
        alert(outerVar);
    }

    outerVar = "gorilla";

    innerFunction();
}

outerFunction();
```

警报：大猩猩

其次，当一个闭包被创建时，它会保留对其所有封闭函数的变量和函数的引用；它不能挑剔。因此，闭包应该谨慎使用，或者至少要小心使用，因为它们可能会占用大量内存；许多变量可以在包含函数完成执行后很长时间保留在内存中。

* * *

## 回答 #30

> 赞同：48
> 
> 时间：2013-03-09T03:24:35.943

我只是将它们指向[Mozilla Closures 页面](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)。这是我发现的关于闭包基础知识和实际用法的最好、最**简洁和简单的解释。**强烈推荐给任何学习 JavaScript 的人。

是的，我什至会向 6 岁的孩子推荐它——如果 6 岁的孩子正在学习闭包，那么他们已经准备好理解文章中提供的*简明扼要的解释*是合乎逻辑的。

* * *

## 回答 #31

> 赞同：42
> 
> 时间：2015-04-17T07:41:15.323

我相信更简短的解释，所以请看下图。

![在此处输入图像描述](https://i.stack.imgur.com/qbv6M.jpg)

`function f1()`..> 浅红色盒子

`function f2()`..> 红色小盒子

这里我们有两个函数，`f1()`和`f2()`。f2() 在 f1() 的内部。f1() 有一个变量，`var x = 10`。

调用函数`f1()`时，`f2()`可以访问 的值`var x = 10`。

这是代码：

```
function f1() {
    var x=10;

    function f2() {
        console.log(x)
    }

    return f2

}
f1() 
```

`f1()`在这里调用：

![在此处输入图像描述](https://i.stack.imgur.com/zg4UT.jpg)

* * *

## 回答 #32

> 赞同：36
> 
> 时间：2014-11-11T08:03:31.847

在 JavaScript 中，闭包非常棒且独特，其中变量或参数可用于内部函数，并且即使在外部函数返回后它们仍然存在。JS 中的大多数设计模式都使用了闭包

```
function getFullName(a, b) {
  return a + b;
}

function makeFullName(fn) {

  return function(firstName) {

    return function(secondName) {

      return fn(firstName, secondName);

    }
  }
}

makeFullName(getFullName)("Stack")("overflow"); // Stackoverflow 
```

* * *

## 回答 #33

> 赞同：36
> 
> 时间：2017-04-26T12:50:21.163

> A closure is a function having access to the parent scope, even after the parent function has closed.

So basically a closure is a function of another function. We can say like a child function.

> A closure is an inner function that has access to the outer (enclosing) function’s variables—scope chain. The closure has three scope chains: it has access to its own scope (variables defined between its curly brackets), it has access to the outer function’s variables, and it has access to the global variables.
> 
> The inner function has access not only to the outer function’s variables but also to the outer function’s parameters. Note that the inner function cannot call the outer function’s arguments object, however, even though it can call the outer function’s parameters directly.
> 
> You create a closure by adding a function inside another function.

Also, it's very useful method which is used in many famous frameworks including `Angular`, `Node.js` and `jQuery`:

> Closures are used extensively in Node.js; they are workhorses in Node.js’ asynchronous, non-blocking architecture. Closures are also frequently used in jQuery and just about every piece of JavaScript code you read.

But how the closures look like in a real-life coding? Look at this simple sample code:

```
function showName(firstName, lastName) {
      var nameIntro = "Your name is ";
      // this inner function has access to the outer function's variables, including the parameter
      function makeFullName() {
          return nameIntro + firstName + " " + lastName;
      }
      return makeFullName();
  }

  console.log(showName("Michael", "Jackson")); // Your name is Michael Jackson 
```

Also, this is classic closure way in jQuery which every javascript and jQuery developers used it a lot:

```
$(function() {
    var selections = [];
    $(".niners").click(function() { // this closure has access to the selections variable
        selections.push(this.prop("name")); // update the selections variable in the outer function's scope
    });
}); 
```

But why we use closures? when we use it in an actual programming? what are the practical use of closures? the below is a good explanation and example by MDN:

**Practical closures**

> Closures are useful because they let you associate some data (the lexical environment) with a function that operates on that data. This has obvious parallels to object oriented programming, where objects allow us to associate some data (the object's properties) with one or more methods.
> 
> Consequently, you can use a closure anywhere that you might normally use an object with only a single method.
> 
> Situations where you might want to do this are particularly common on the web. Much of the code we write in front-end JavaScript is event-based — we define some behavior, then attach it to an event that is triggered by the user (such as a click or a keypress). Our code is generally attached as a callback: a single function which is executed in response to the event.
> 
> For instance, suppose we wish to add some buttons to a page that adjust the text size. One way of doing this is to specify the font-size of the body element in pixels, then set the size of the other elements on the page (such as headers) using the relative em unit:

Read the code below and run the code to see how closure help us here to easily make separate functions for each sections:

```
//javascript
function makeSizer(size) {
  return function() {
    document.body.style.fontSize = size + 'px';
  };
}

var size12 = makeSizer(12);
var size14 = makeSizer(14);
var size16 = makeSizer(16);

document.getElementById('size-12').onclick = size12;
document.getElementById('size-14').onclick = size14;
document.getElementById('size-16').onclick = size16;
```

```
/*css*/
body {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 12px;
}

h1 {
  font-size: 1.5em;
}

h2 {
  font-size: 1.2em;
}
```

```
<!--html><!-->
<p>Some paragraph text</p>
<h1>some heading 1 text</h1>
<h2>some heading 2 text</h2>

<a href="#" id="size-12">12</a>
<a href="#" id="size-14">14</a>
<a href="#" id="size-16">16</a>
```

For further study about closures, I recommend you to visit this page by MDN: [https://developer.mozilla.org/en/docs/Web/JavaScript/Closures](https://developer.mozilla.org/en/docs/Web/JavaScript/Closures)

* * *

## 回答 #34

> 赞同：30
> 
> 时间：2013-05-09T14:18:02.427

对于一个六岁的孩子？

您和您的家人住在神秘的安维尔镇。你有一个住在隔壁的朋友，所以你打电话给他们，让他们出来玩。您拨打：

> 000001 (jamiesHouse)

一个月后，您和您的家人从 Ann Ville 搬到下一个城镇，但您和您的朋友仍然保持联系，所以现在您必须先拨打您朋友所在城镇的区号，然后再拨打他们的 '正确的号码：

> 001 000001 (annVille.jamiesHouse)

一年后，你的父母搬到了一个全新的国家，但你和你的朋友仍然保持联系，所以在烦扰你的父母让你拨打国际费率电话后，你现在拨打：

> 01 001 000001 (myOldCountry.annVille.jamiesHouse)

奇怪的是，搬到你的新国家后，你和你的家人碰巧搬到了一个叫安维尔的新城镇……你碰巧和一个叫杰米的新朋友交上了朋友……你给了他们一个称呼...

> 000001 (jamiesHouse)

幽灵般的...

事实上，这太可怕了，以至于你把这件事告诉了你家乡的杰米……你笑得很开心。所以有一天，你和你的家人去故乡度假。你参观你的老镇（安维尔），去拜访杰米......

*   “真的吗？另一个杰米？在安维尔？在你的新国家！！？”
*   “是啊……就叫他们吧……”

> 02 001 000001 (myNewCountry.annVille.jamiesHouse)

意见？

*更重要的是，我有很多关于现代六岁孩子的耐心的问题......*

* * *

## 回答 #35

> 赞同：28
> 
> 时间：2014-10-28T06:22:08.793

这是一个简单的实时场景。通读一遍，你就会明白我们在这里是如何使用闭包的（看看座位号是如何变化的）。

前面解释的所有其他示例也很好地理解了这个概念。

```
function movieBooking(movieName) {
    var bookedSeatCount = 0;
    return function(name) {
        ++bookedSeatCount ;
        alert( name + " - " + movieName + ", Seat - " + bookedSeatCount )
    };
};

var MI1 = movieBooking("Mission Impossible 1 ");
var MI2 = movieBooking("Mission Impossible 2 ");

MI1("Mayur");
// alert
// Mayur - Mission Impossible 1, Seat - 1

MI1("Raju");
// alert
// Raju - Mission Impossible 1, Seat - 2

MI2("Priyanka");
// alert
// Raja - Mission Impossible 2, Seat - 1 
```

* * *

## 回答 #36

> 赞同：26
> 
> 时间：2016-04-05T11:15:54.620

* * *

## 回答 #37

> 赞同：24
> 
> 时间：2015-04-15T00:13:53.193

这是我能给出的最禅宗的答案：

你希望这段代码做什么？在运行之前在评论中告诉我。我很好奇！

```
function foo() {
  var i = 1;
  return function() {
    console.log(i++);
  }
}

var bar = foo();
bar();
bar();
bar();

var baz = foo();
baz();
baz();
baz(); 
```

现在在浏览器中打开控制台（希望是`Ctrl`++或`Shift`）并粘贴代码并点击.`I``F12``Enter`

如果这段代码打印出你所期望的（JavaScript 新手 - 忽略末尾的“未定义”），那么你已经有了*无言的理解*。 *在 words*中，变量`i`是内部函数*实例*闭包的一部分。

我之所以这样说是因为，一旦我理解这段代码将`foo()`' 的内部函数的实例放入其中`bar`，`baz`然后通过这些变量调用它们，就没有什么让我感到惊讶了。

但是，如果我错了并且控制台输出让您感到惊讶，请告诉我！

* * *

## 回答 #38

> 赞同：23
> 
> 时间：2015-04-08T21:27:52.630

（我没有考虑到 6 岁的事情。）

在像 JavaScript 这样的语言中，您可以将函数作为参数传递给其他函数（函数是*一等公民*的语言），您经常会发现自己在执行以下操作：

```
var name = 'Rafael';

var sayName = function() {
  console.log(name);
}; 
```

您会看到，`sayName`没有`name`变量的定义，但它确实使用了在（在父范围内）`name`之外定义的值。`sayName`

假设您将`sayName`作为参数传递给另一个函数，该函数将`sayName`作为回调调用：

```
functionThatTakesACallback(sayName); 
```

注意：

1.  `sayName`将从内部调用`functionThatTakesACallback`（假设，因为我没有`functionThatTakesACallback`在这个例子中实现）。
2.  当`sayName`被调用时，它将记录`name`变量的值。
3.  `functionThatTakesACallback`没有定义`name`变量（好吧，它可以，但没关系，所以假设它没有）。

因此，我们`sayName`在内部被调用`functionThatTakesACallback`并引用了`name`内部未定义的变量`functionThatTakesACallback`。

那会发生什么？一个`ReferenceError: name is not defined`？

不！的值`name`被捕获在一个**闭包**中。您可以将此闭包视为**与函数关联的上下文**，它保存定义该函数时可用的值。

所以：即使`name`不在函数`sayName`将被调用的范围内（在内部`functionThatTakesACallback`），`sayName`也可以访问`name`在与关联的闭包中捕获的值`sayName`。

--

来自*Eloquent JavaScript*一书：

> 一个好的心智模型是将函数值视为在其主体中包含代码和在其中创建它们的环境。调用时，函数体会看到其原始环境，而不是进行调用的环境。

* * *

## 回答 #39

> 赞同：22
> 
> 时间：2013-06-22T19:08:34.070

## 给定以下功能

```
function person(name, age){

    var name = name;
    var age = age;

    function introduce(){
        alert("My name is "+name+", and I'm "+age);
    }

    return introduce;
}

var a = person("Jack",12);
var b = person("Matt",14); 
```

每次`person`调用该函数时，都会创建一个新的闭包。虽然变量`a`和`b`具有相同的`introduce`功能，但它链接到不同的闭包。即使函数`person`完成执行，该闭包仍然存在。

![在此处输入图像描述](https://i.stack.imgur.com/LDEhE.png)

```
a(); //My name is Jack, and I'm 12
b(); //My name is Matt, and I'm 14 
```

抽象闭包可以表示为：

```
closure a = {
    name: "Jack",
    age: 12,
    call: function introduce(){
        alert("My name is "+name+", and I'm "+age);
    }
}

closure b = {
    name: "Matt",
    age: 14,
    call: function introduce(){
        alert("My name is "+name+", and I'm "+age);
    }
} 
```

* * *

假设你知道 a`class`在另一种语言中是如何工作的，我会做一个类比。

想像

*   JavaScript`function`作为`constructor`
*   `local variables`作为`instance properties`
*   这些`properties`是私人的
*   `inner functions`作为`instance methods`

每次`function`调用a

*   `object`将创建一个包含所有局部变量的新变量。
*   该对象的方法可以访问`"properties"`该实例对象。

* * *

## 回答 #40

> 赞同：22
> 
> 时间：2014-01-25T16:43:14.500

我对关闭的思考越多，我就越认为它是一个两步过程：**init - action**

```
init: pass first what's needed...
action: in order to achieve something for later execution. 
```

对于一个 6 岁的孩子，我会强调关闭的*实际方面*：

```
Daddy: Listen. Could you bring mum some milk (2).
Tom: No problem.
Daddy: Take a look at the map that Daddy has just made: mum is there and daddy is here.
Daddy: But get ready first. And bring the map with you (1), it may come in handy
Daddy: Then off you go (3). Ok?
Tom: A piece of cake! 
```

**示例**：*给妈妈带些牛奶（=行动）。首先准备好并带上地图（=init）。*

```
function getReady(map) {
    var cleverBoy = 'I examine the ' + map;
    return function(what, who) {
        return 'I bring ' + what + ' to ' + who + 'because + ' cleverBoy; //I can access the map
    }
}
var offYouGo = getReady('daddy-map');
offYouGo('milk', 'mum'); 
```

因为如果您随身携带一条非常重要的信息（地图），那么您就有足够的知识来执行其他类似的操作：

```
offYouGo('potatoes', 'great mum'); 
```

对于开发人员，我会在闭包和[OOP](http://en.wikipedia.org/wiki/Object-oriented_programming)之间进行比较。**init 阶段**类似于在传统的 OO 语言中将参数传递给构造函数；**行动阶段**最终是你调用来实现你想要的方法。并且该方法可以使用称为*闭包*的机制访问这些初始化参数。

请参阅我的另一个答案，说明 OO 和闭包之间的并行性：

*[如何在 JavaScript 中“正确”创建自定义对象？](https://stackoverflow.com/questions/1595611/how-to-properly-create-a-custom-object-in-javascript/21352366#21352366)*

* * *

## 回答 #41

> 赞同：21
> 
> 时间：2014-03-20T12:32:51.480

尽管 Internet 上存在许多关于 JavaScript 闭包的优美定义，但我还是尝试用我最喜欢的闭包定义来解释我 6 岁的朋友，这有助于我更好地理解闭包。

**什么是闭包？**

闭包是一个内部函数，它可以访问外部（封闭）函数的变量——作用域链。闭包具有三个作用域链：它可以访问自己的作用域（在其大括号之间定义的变量），它可以访问外部函数的变量，它可以访问全局变量。

闭包是函数的局部变量 - 在函数返回后保持活动状态。

闭包是引用独立（自由）变量的函数。换句话说，闭包中定义的函数“记住”了创建它的环境。

闭包是范围概念的扩展。使用闭包，函数可以访问在创建函数的范围内可用的变量。

闭包是一个堆栈帧，在函数返回时不会被释放。（好像一个“堆栈帧”被 malloc'ed 而不是在堆栈上！）

Java 等语言提供了将方法声明为私有的能力，这意味着它们只能被同一类中的其他方法调用。JavaScript 不提供执行此操作的本机方式，但可以使用闭包模拟私有方法。

“闭包”是一个表达式（通常是一个函数），它可以具有自由变量以及绑定这些变量的环境（即“关闭”表达式）。

闭包是一种抽象机制，允许您非常干净地分离关注点。

**闭包的用途：**

闭包在隐藏功能实现的同时仍然显示接口很有用。

您可以使用闭包在 JavaScript 中模拟封装概念。

[闭包在jQuery](http://en.wikipedia.org/wiki/JQuery)和[Node.js](http://en.wikipedia.org/wiki/Node.js)中被广泛使用。

虽然对象字面量很容易创建并且便于存储数据，但闭包通常是在大型 Web 应用程序中创建静态单例命名空间的更好选择。

**闭包示例：**

假设我 6 岁的朋友最近在他的小学学习加法，我觉得这个将两个数字相加的例子对于 6 岁的孩子来说是最简单和最适合学习闭包的。

**示例1：这里通过返回一个函数来实现闭包。**

```
function makeAdder(x) {
    return function(y) {
        return x + y;
    };
}

var add5 = makeAdder(5);
var add10 = makeAdder(10);

console.log(add5(2));  // 7
console.log(add10(2)); // 12 
```

**示例 2：这里通过返回一个对象字面量来实现闭包。**

```
function makeAdder(x) {
    return {
        add: function(y){
            return x + y;
        }
    }
}

var add5 = makeAdder(5);
console.log(add5.add(2));//7

var add10 = makeAdder(10);
console.log(add10.add(2));//12 
```

**示例 3：jQuery 中的闭包**

```
$(function(){
    var name="Closure is easy";
    $('div').click(function(){
        $('p').text(name);
    });
}); 
```

**有用的链接：**

*   *[闭包](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Closures)*（Mozilla 开发者网络）
*   *[轻松理解 JavaScript 闭包](http://javascriptissexy.com/understand-javascript-closures-with-ease/)*

感谢上面的链接，这有助于我更好地理解和解释闭包。

* * *

## 回答 #42

> 赞同：21
> 
> 时间：2015-04-29T13:36:13.533

闭包是***函数中的一个函数***，它可以访问其“父”函数的变量和参数。

例子：

```
function showPostCard(Sender, Receiver) {

    var PostCardMessage = " Happy Spring!!! Love, ";

    function PreparePostCard() {
        return "Dear " + Receiver + PostCardMessage + Sender;
    }

    return PreparePostCard();
}
showPostCard("Granny", "Olivia"); 
```

* * *

## 回答 #43

> 赞同：21
> 
> 时间：2015-09-02T08:31:18.313

了解**图示说明**：*[JavaScript 闭包如何在幕后工作](http://dmitryfrank.com/articles/js_closures)*。

本文解释了如何`LexicalEnvironment`以直观的方式分配和使用范围对象（或多个对象）。就像，对于这个简单的脚本：

```
"use strict";

var foo = 1;
var bar = 2;

function myFunc() {
  //-- Define local-to-function variables
  var a = 1;
  var b = 2;
  var foo = 3;
}

//-- And then, call it:
myFunc(); 
```

在执行顶层代码时，我们有以下作用域对象排列：

[![在此处输入图像描述](https://i.stack.imgur.com/bwjyg.png)](https://i.stack.imgur.com/bwjyg.png)

当`myFunc()`被调用时，我们有以下作用域链：

[![在此处输入图像描述](https://i.stack.imgur.com/zRu5Z.png)](https://i.stack.imgur.com/zRu5Z.png)

了解范围对象是如何创建、使用和删除的，是了解全局以及了解闭包如何在幕后工作的关键。

有关所有详细信息，请参阅上述文章。

* * *

## 回答 #44

> 赞同：21
> 
> 时间：2015-12-30T14:25:47.220

要理解闭包，您必须深入了解程序并像运行时一样执行。让我们看一下这段简单的代码：

[![在此处输入图像描述](https://i.stack.imgur.com/kWR82.png)](https://i.stack.imgur.com/kWR82.png)

JavaScript 分两个阶段运行代码：

*   编译阶段 // JavaScript 不是纯解释型语言
*   执行阶段

当 JavaScript 经历编译阶段时，它会提取变量和函数的声明。这称为吊装。在这个阶段遇到的函数被保存为内存中的文本 blob，也称为 lambda。编译后，JavaScript 进入执行阶段，它分配所有值并运行函数。为了运行函数，它通过从堆中分配内存并重复函数的编译和执行阶段来准备执行上下文。这个内存区域被称为函数的作用域。执行开始时有一个全局范围。作用域是理解闭包的关键。

在此示例中，首先`a`定义变量，然后`f`在编译阶段定义变量。所有未声明的变量都保存在全局范围内。在执行阶段`f`使用参数调用。`f`的范围已分配，并为其重复编译和执行阶段。

参数也保存在`f`. 每当创建本地执行上下文或范围时，它都包含指向其父范围的引用指针。所有变量访问都遵循这个词法范围链来查找它的值。如果在本地范围内找不到变量，它会跟随链并在其父范围内找到它。这也是为什么局部变量会覆盖父作用域中的变量的原因。父作用域称为本地作用域或函数的“闭包”。

在这里，当`g`'s 的作用域被设置时，它得到了一个指向其父作用域的词法指针`f`。的范围`f`是 的闭包`g`。在 JavaScript 中，如果有一些对函数、对象或范围的引用，如果你能以某种方式访问​​它们，它就不会被垃圾收集。所以当 myG 运行时，它有一个指向`f`它的闭包范围的指针。这块内存区域甚至不会被垃圾回收`f`这块内存区域即使已经返回就运行时而言，这是一个闭包。

## 那么什么是闭包？

*   它是函数与其作用域链之间隐含的、永久的链接……
*   函数定义的 (lambda) 隐藏`[[scope]]`引用。
*   持有作用域链（防止垃圾收集）。
*   每当函数运行时，它都会被用作“外部环境参考”并被复制。

## 隐式关闭

```
var data = "My Data!";
setTimeout(function() {
  console.log(data); // Prints "My Data!"
}, 3000); 
```

## 显式闭包

```
function makeAdder(n) {
  var inc = n;
  var sum = 0;
  return function add() {
    sum = sum + inc;
    return sum;
  };
}

var adder3 = makeAdder(3); 
```

*[Arindam Paul - JavaScript VM internals, EventLoop, Async and ScopeChains](https://www.youtube.com/watch?v=QyUFheng6J0)*是关于闭包的一个非常有趣的演讲。

* * *

## 回答 #45

> 赞同：21
> 
> 时间：2016-07-31T16:51:57.623

Version picture for this answer: **[Resolved]**

Just forget about scope every thing and remember: When a variable needed somewhere, javascript will not destroy it. The variable always point to newest value.

**Example 1:**

[![enter image description here](https://i.stack.imgur.com/ckxN9.png)](https://i.stack.imgur.com/ckxN9.png)

**Example 2:**

[![enter image description here](https://i.stack.imgur.com/dAmCA.png)](https://i.stack.imgur.com/dAmCA.png)

**Example 3:** [![enter image description here](https://i.stack.imgur.com/HRXgp.png)](https://i.stack.imgur.com/HRXgp.png)

* * *

## 回答 #46

> 赞同：21
> 
> 时间：2017-04-22T03:19:00.527

This answer is a summary of this youtube video [Javascript Closures](https://www.youtube.com/watch?v=FYrtnS3X_Lw). So full credits to that video.

*Closures are nothing but Stateful functions which maintain states of their private variables.*

Normally when you make a call to a function as shown in the below figure. The variables are created on a stack ( running RAM memory) used and then disallocated.

[![enter image description here](https://i.stack.imgur.com/QVZg5.png)](https://i.stack.imgur.com/QVZg5.png)

But now there are situations where we want to maintain this state of the function thats where Javascript closures comes to use. A closure is a function inside function with a return call as shown in the below code.

[![enter image description here](https://i.stack.imgur.com/u8UIi.png)](https://i.stack.imgur.com/u8UIi.png)

So the closure code for the counter function above looks something as shown below.Its a function inside function with a return statement.

```
function Counter() {
           var counter = 0;

           var Increment = function () {
               counter++;
               alert(counter);
           }
           return {
               Increment
           }
       } 
```

So now if you make a call the counter will increment in other words the function call maintains states.

```
var x = Counter(); // get the reference of the closure
x.Increment(); // Displays 1
x.Increment(); // Display 2 ( Maintains the private variables) 
```

But now the biggest question whats the use of such stateful function. Stateful functions are building blocks to implement OOP concept like abstraction ,encapsulation and creating self contained modules.

So whatever you want encapsulated you can put it as private and things to be exposed to public should be put in return statement. Also these components are self contained isolated objects so they do not pollute global variables.

A object which follows OOP principles is self contained , follows abstraction , follows encapsulation and so. With out closures in Javascript this is difficult to implement.

[![enter image description here](https://i.stack.imgur.com/tJ5Mm.png)](https://i.stack.imgur.com/tJ5Mm.png)

* * *

## 回答 #47

> 赞同：20
> 
> 时间：2012-08-25T13:36:01.947

来自个人[博客文章](http://tshikatshikaaa.blogspot.nl/2012/08/purpose-of-javascript-closure.html)：

默认情况下，JavaScript 知道两种类型的范围：全局和本地。

```
var a = 1;

function b(x) {
    var c = 2;
    return x * c;
} 
```

在上面的代码中，变量 a 和函数 b 可从代码中的任何位置（即全局）获得。变量`c`仅在`b`函数范围内可用（即本地）。大多数软件开发人员不会对缺乏范围灵活性感到满意，尤其是在大型程序中。

JavaScript 闭包通过将函数与上下文绑定来帮助解决该问题：

```
function a(x) {
    return function b(y) {
        return x + y;
    }
} 
```

在这里，函数`a`返回一个名为 的函数`b`。由于`b`在 中定义`a`，它会自动访问在 中定义的任何内容`a`，即`x`在此示例中。这就是为什么可以在不声明的情况下`b`返回`x`+ 。`y``x`

```
var c = a(3); 
```

变量`c`被赋值为使用参数 3 调用 a 的结果。也就是说，函数的实例`b`where `x`= 3。换句话说，`c`现在是一个等效于：

```
var c = function b(y) {
    return 3 + y;
} 
```

函数在其上下文中`b`记住`x`= 3。所以：

```
var d = c(4); 
```

会将值 3 + 4 分配给`d`，即 7。

**备注**：如果有人在创建函数实例后修改了`x`(say = 22) 的值，这也会反映在其中。因此，稍后调用(4) 将返回 22 + 4，即 26。`x``b``b``c`

闭包也可以用来限制全局声明的变量和方法的范围：

```
(function () {
    var f = "Some message";
    alert(f);
})(); 
```

上面是一个闭包，其中函数没有名称，没有参数并且被立即调用。突出显示的代码声明了一个全局变量`f`，将范围限制为`f`闭包。

现在，有一个常见的 JavaScript 警告，闭包可以提供帮助：

```
var a = new Array();

for (var i=0; i<2; i++) {
    a[i]= function(x) { return x + i ; }
} 
```

从上面，大多数人会假设数组`a`将按如下方式初始化：

```
a[0] = function (x) { return x + 0 ; }
a[1] = function (x) { return x + 1 ; }
a[2] = function (x) { return x + 2 ; } 
```

实际上，这就是 a 的初始化方式，因为`i`上下文中的最后一个值为 2：

```
a[0] = function (x) { return x + 2 ; }
a[1] = function (x) { return x + 2 ; }
a[2] = function (x) { return x + 2 ; } 
```

解决方案是：

```
var a = new Array();

for (var i=0; i<2; i++) {
    a[i]= function(tmp) {
        return function (x) { return x + tmp ; }
    } (i);
} 
```

参数/变量保存创建函数实例时`tmp`更改值的本地副本。`i`

* * *

## 回答 #48

> 赞同：20
> 
> 时间：2013-05-04T16:06:00.560

函数在定义它的对象/函数的范围内执行。所述函数可以访问在其执行时已定义的对象/函数中定义的变量。

就从字面上理解....正如代码所写的那样：P

* * *

## 回答 #49

> 赞同：18
> 
> 时间：2015-07-24T10:35:45.067

以下示例是 JavaScript 闭包的简单说明。这是闭包函数，它返回一个函数，可以访问它的局部变量 x，

```
function outer(x){
     return function inner(y){
         return x+y;
     }
} 
```

像这样调用函数：

```
var add10 = outer(10);
add10(20); // The result will be 30
add10(40); // The result will be 50

var add20 = outer(20);
add20(20); // The result will be 40
add20(40); // The result will be 60 
```

* * *

## 回答 #50

> 赞同：17
> 
> 时间：2013-04-25T01:41:12.293

我发现非常清楚的第 8 章第 6 节“闭包”，来自 David Flanagan 的*JavaScript：权威指南*，第 6 版，O'Reilly，2011 年。我会尝试解释一下。

1.  调用函数时，会创建一个新对象来保存该调用的局部变量。

2.  一个函数的作用域取决于它的声明位置，而不是它的执行位置。

现在，假设在外部函数中声明了一个内部函数，并引用了该外部函数的变量。进一步假设外部函数返回内部函数，作为一个函数。现在有一个对内部函数范围内的任何值的外部引用（根据我们的假设，它包括来自外部函数的值）。

JavaScript 将保留这些值，因为它们由于从已完成的外部函数中传递出来而保留在当前执行的范围内。所有函数都是闭包，但感兴趣的闭包是内部函数，在我们假设的场景中，当它们（内部函数）返回时，它们会将外部函数值保留在它们的“外壳”中（我希望我在这里正确使用了语言）从外部功能。我知道这不符合六岁的要求，但希望它仍然有用。

* * *

## 回答 #51

> 赞同：17
> 
> 时间：2015-02-10T21:28:59.150

也许你应该考虑一个面向对象的结构而不是内部函数。例如：

```
 var calculate = {
        number: 0,
        init: function (num) {
            this.number = num;
        },
        add: function (val) {
            this.number += val;
        },
        rem: function (val) {
            this.number -= val;
        }
    }; 
```

并从 calculate.number 变量中读取结果，无论如何谁都需要“返回”。

```
//Addition
First think about scope which defines what variable you have to access to (In Javascript);

//there are two kinds of scope
Global Scope which include variable declared outside function or curly brace

let globalVariable = "foo"; 
```

要记住的一件事是，一旦您声明了一个全局变量，您就可以在代码中的任何地方使用它，甚至在函数中；

本地范围，其中包括仅在代码的特定部分中可用的变量：

函数作用域是当您在函数中声明变量时，您只能在函数内访问该变量

```
function User(){
    let name = "foo";
    alert(name);
}
alert(name);//error

//Block scope is when you declare a variable within a block then you can  access that variable only within a block 
{
    let user = "foo";
    alert(user);
}
alert(user);
//Uncaught ReferenceError: user is not defined at.....

//A Closure

function User(fname){
    return function(lname){
        return fname + " " lname;
    }
}
let names = User("foo");
alert(names("bar"));

//When you create a function within a function you've created a closure, in our example above since the outer function is returned the inner function got access to outer function's scope 
```

* * *

## 回答 #52

> 赞同：17
> 
> 时间：2015-05-29T00:09:15.303

闭包是许多 JavaScript 开发人员一直使用的东西，但我们认为它是理所当然的。它的工作原理并不复杂。了解如何有目的地使用它*是*复杂的。

在最简单的定义中（正如其他答案所指出的），闭包基本上是在另一个函数中定义的函数。并且该内部函数可以访问在外部函数范围内定义的变量。您将看到使用闭包的最常见做法是在全局范围内定义变量和函数，并在该函数的函数范围内访问这些变量。

```
var x = 1;
function myFN() {
  alert(x); //1, as opposed to undefined.
}
// Or
function a() {
   var x = 1;
   function b() {
       alert(x); //1, as opposed to undefined.
   }
   b();
} 
```

所以呢？

闭包对 JavaScript 用户来说并不特别，除非您考虑没有它们的生活会是什么样子。在其他语言中，函数中使用的变量会在函数返回时被清除。在上面，x 将是一个“空指针”，您需要建立一个 getter 和 setter 并开始传递引用。听起来不像 JavaScript 对吧？感谢强大的关闭。

我为什么要在乎？

您不必真正了解闭包即可使用它们。但正如其他人也指出的那样，可以**利用**它们来创建虚假的私有变量。在您需要私有变量之前，请像往常一样使用它们。

* * *

## 回答 #53

> 赞同：15
> 
> 时间：2013-03-11T13:37:44.280

如果您想向一个六岁的孩子解释它，那么您必须找到一些非常简单且没有代码的东西。

只要告诉孩子他是“开放的”，这表示他能够与其他一些人，他的朋友建立关系。在某个时间点，他已经确定了朋友（我们可以知道他的朋友的名字），那就是闭包。如果你给他和他的朋友拍照，那么他相对于他的友谊能力是“封闭的”。但总的来说，他是“开放的”。在他的一生中，他将拥有许多不同的朋友。其中一组是闭包。

* * *

## 回答 #54

> 赞同：15
> 
> 时间：2013-06-05T16:39:49.733

我敢肯定，[爱因斯坦](https://en.wikipedia.org/wiki/Albert_Einstein)并没有直接期望我们选择任何深奥的头脑风暴的东西，并用徒劳的尝试让那些“疯狂”的六岁孩子（更糟糕的是他们无聊） ）他们幼稚的想法：）如果我六岁，我不希望有这样的父母，或者不会与这样无聊的慈善家建立友谊，对不起：）

无论如何，对于婴儿来说，**关闭**只是一个**拥抱**，我想，无论你试图解释什么:) 当你拥抱你的朋友时，你们俩都会分享你们此刻拥有的任何东西。这是一种通过仪式，一旦你拥抱了某人，你就表现出她的信任和愿意让她和你一起做很多你不允许并且会向别人隐瞒的事情。这是友谊的表现:)。

真不知道怎么跟5-6岁的宝宝解释。我不认为他们会喜欢任何 JavaScript 代码片段，例如：

```
function Baby(){
    this.iTrustYou = true;
}

Baby.prototype.hug = function (baby) {
    var smiles = 0;

    if (baby.iTrustYou) {
        return function() {
            smiles++;
            alert(smiles);
        };
    }
};

var
   arman = new Baby("Arman"),
   morgan = new Baby("Morgana");

var hug = arman.hug(morgan);
hug();
hug(); 
```

仅限儿童：

**关闭**是**拥抱**

**虫子****飞**_

 ****亲吻**是**亲吻！**:)

* * *

## 回答 #55

> 赞同：14
> 
> 时间：2012-07-25T21:26:28.563

调用函数后，它会超出范围。如果该函数包含类似回调函数的内容，则该回调函数仍在范围内。如果回调函数在父函数的直接环境中引用了某个局部变量，那么您自然会认为该变量无法被回调函数访问并返回 undefined。

闭包确保回调函数引用的任何属性都可供该函数使用，即使其父函数可能已超出范围。

* * *

## 回答 #56

> 赞同：14
> 
> 时间：2012-12-01T10:53:45.970

闭包是一种方法，通过它内部函数可以在其父函数已经终止后引用其外部封闭函数中存在的变量。

```
// A function that generates a new function for adding numbers.
function addGenerator( num ) {
    // Return a simple function for adding two numbers
    // with the first number borrowed from the generator
    return function( toAdd ) {
        return num + toAdd
    };
}

// addFive now contains a function that takes one argument,
// adds five to it, and returns the resulting number.
var addFive = addGenerator( 5 );
// We can see here that the result of the addFive function is 9,
// when passed an argument of 4.
alert( addFive( 4 ) == 9 ); 
```

* * *

## 回答 #57

> 赞同：13
> 
> 时间：2014-03-19T14:01:36.560

如果你理解得很好，你可以简单地解释它。最简单的方法是从上下文中抽象出来。抛开代码，甚至抛开编程。一个比喻的例子会做得更好。

让我们想象一个功能是一个房间，它的墙壁是玻璃的，但它们是特殊的玻璃，就像审讯室里的那些。从外面看是不透明的，从里面看是透明的。它可以是其他房间内的房间，唯一的联系方式是电话。

如果你从外面打电话，你不知道里面有什么，但你知道如果你给他们一些信息，里面的人会做一个任务。他们可以看到外面，所以他们可以向你索要外面的东西并改变那些东西，但你不能从外面改变里面的东西，你甚至看不到（知道）里面是什么。您正在呼叫的那个房间里的人看到外面是什么，但看不到那个房间里的房间里是什么，所以他们与他们互动的方式就像您在外面做的那样。最内室的人可以看到很多东西，但最外室的人却连最内室的存在都不知道。

对于内室的每次呼叫，该房间中的人都会记录有关该特定呼叫的信息，并且他们做得非常好，以至于他们永远不会将一个呼叫内容与其他呼叫内容混淆。

房间是函数，可见性是范围，做任务的人是语句，东西是对象，电话是函数调用，电话信息是参数，通话记录是范围实例，最外面的房间是全局对象。

* * *

## 回答 #58

> 赞同：13
> 
> 时间：2014-07-24T22:20:53.247

想象一下，在你的镇上有一个非常大的公园，在那里你看到一个叫做 Mr. Coder 的魔术师使用他的名为 JavaScript 的魔杖在公园的不同角落开始棒球比赛。

当然，每场棒球比赛都有完全相同的规则，每场比赛都有自己的计分板。

自然，一场棒球比赛的比分与其他比赛完全不同。

关闭是 Mr.Coder 将他所有神奇棒球比赛的得分分开的特殊方式。

* * *

## 回答 #59

> 赞同：13
> 
> 时间：2015-10-22T10:54:42.097

**Pinocchio：1883 年的闭包（比 JavaScript 早了一个多世纪）**

我认为最好向 6 岁的孩子解释一次愉快的冒险......匹诺曹[历险记的](https://en.wikipedia.org/wiki/The_Adventures_of_Pinocchio)部分，其中匹诺曹被一条超大的角鲨吞食......

```
var tellStoryOfPinocchio = function(original) {

  // Prepare for exciting things to happen
  var pinocchioFindsMisterGeppetto;
  var happyEnding;

  // The story starts where Pinocchio searches for his 'father'
  var pinocchio = {
    name: 'Pinocchio',
    location: 'in the sea',
    noseLength: 2
  };

  // Is it a dog... is it a fish...
  // The dogfish appears, however there is no such concept as the belly
  // of the monster, there is just a monster...
  var terribleDogfish = {
    swallowWhole: function(snack) {
      // The swallowing of Pinocchio introduces a new environment (for the
      // things happening inside it)...
      // The BELLY closure... with all of its guts and attributes
      var mysteriousLightLocation = 'at Gepetto\'s ship';

      // Yes: in my version of the story the monsters mouth is directly
      // connected to its belly... This might explain the low ratings
      // I had for biology...
      var mouthLocation = 'in the monsters mouth and then outside';

      var puppet = snack;

      puppet.location = 'inside the belly';
      alert(snack.name + ' is swallowed by the terrible dogfish...');

      // Being inside the belly, Pinocchio can now experience new adventures inside it
      pinocchioFindsMisterGeppetto = function() {
        // The event of Pinocchio finding Mister Geppetto happens inside the
        // belly and so it makes sence that it refers to the things inside
        // the belly (closure) like the mysterious light and of course the
        // hero Pinocchio himself!
        alert(puppet.name + ' sees a mysterious light (also in the belly of the dogfish) in the distance and swims to it to find Mister Geppetto! He survived on ship supplies for two years after being swallowed himself. ');
        puppet.location = mysteriousLightLocation;

        alert(puppet.name + ' tells Mister Geppetto he missed him every single day! ');
        puppet.noseLength++;
      }

      happyEnding = function() {
        // The escape of Pinocchio and Mister Geppetto happens inside the belly:
        // it refers to Pinocchio and the mouth of the beast.
        alert('After finding Mister Gepetto, ' + puppet.name + ' and Mister Gepetto travel to the mouth of the monster.');
        alert('The monster sleeps with its mouth open above the surface of the water. They escape through its mouth. ');
        puppet.location = mouthLocation;
        if (original) {
          alert(puppet.name + ' is eventually hanged for his innumerable faults. ');
        } else {
          alert(puppet.name + ' is eventually turned into a real boy and they all lived happily ever after...');
        }
      }
    }
  }

  alert('Once upon a time...');
  alert('Fast forward to the moment that Pinocchio is searching for his \'father\'...');
  alert('Pinocchio is ' + pinocchio.location + '.');
  terribleDogfish.swallowWhole(pinocchio);
  alert('Pinocchio is ' + pinocchio.location + '.');
  pinocchioFindsMisterGeppetto();
  alert('Pinocchio is ' + pinocchio.location + '.');
  happyEnding();
  alert('Pinocchio is ' + pinocchio.location + '.');

  if (pinocchio.noseLength > 2)
    console.log('Hmmm... apparently a little white lie was told. ');
}

tellStoryOfPinocchio(false); 
```

* * *

## 回答 #60

> 赞同：13
> 
> 时间：2015-11-05T12:15:17.117

> 闭包是一个可以访问父作用域的函数，即使在父函数关闭之后也是如此。

```
var add = (function() {
  var counter = 0;
  return function() {
    return counter += 1;
  }
})();

add();
add();
add();
// The counter is now 3 
```

示例解释：

*   该变量`add`被分配了自调用函数的返回值。
*   自调用函数只运行一次。它将计数器设置为零 (0)，并返回一个函数表达式。
*   这样 add 就变成了一个函数。“精彩”的部分是它可以访问父范围内的计数器。
*   这称为 JavaScript 闭包。它使函数可以具有“私有”变量。
*   计数器受匿名函数的作用域保护，只能使用 add 函数更改。

[来源](http://www.w3schools.com/js/js_function_closures.asp)

* * *

## 回答 #61

> 赞同：12
> 
> 时间：2016-09-20T08:22:24.217

**Closures** are a somewhat advanced, and often misunderstood feature of the JavaScript language. Simply put, closures are objects that contain a function and a reference to the environment in which the function was created. However, in order to fully understand closures, there are two other features of the JavaScript language that must first be understood―first-class functions and inner functions.

**First-Class Functions**

In programming languages, functions are considered to be first-class citizens if they can be manipulated like any other data type. For example, first-class functions can be constructed at runtime and assigned to variables. They can also be passed to, and returned by other functions. In addition to meeting the previously mentioned criteria, JavaScript functions also have their own properties and methods. The following example shows some of the capabilities of first-class functions. In the example, two functions are created and assigned to the variables “foo” and “bar”. The function stored in “foo” displays a dialog box, while “bar” simply returns whatever argument is passed to it. The last line of the example does several things. First, the function stored in “bar” is called with “foo” as its argument. “bar” then returns the “foo” function reference. Finally, the returned “foo” reference is called, causing “Hello World!” to be displayed.

```
var foo = function() {
  alert("Hello World!");
};

var bar = function(arg) {
  return arg;
};

bar(foo)(); 
```

**Inner Functions**

Inner functions, also referred to as nested functions, are functions that are defined inside of another function (referred to as the outer function). Each time the outer function is called, an instance of the inner function is created. The following example shows how inner functions are used. In this case, add() is the outer function. Inside of add(), the doAdd() inner function is defined and called.

```
function add(value1, value2) {
  function doAdd(operand1, operand2) {
    return operand1 + operand2;
  }

  return doAdd(value1, value2);
}

var foo = add(1, 2);
// foo equals 3 
```

One important characteristic of inner functions is that they have implicit access to the outer function’s scope. This means that the inner function can use the variables, arguments, etc. of the outer function. In the previous example, the “<em>value1” and “<em>value2” arguments of add() were passed to *doAdd()* as the “<em>operand1” and “operand2” arguments. However, this is unnecessary because *doAdd()* has direct access to “<em>value1” and “<em>value2”. The previous example has been rewritten below to show how *doAdd()* can use “<em>value1” and “<em>value2”.

```
function add(value1, value2) {
  function doAdd() {
    return value1 + value2;
  }

  return doAdd();
}

var foo = add(1, 2);
// foo equals 3 
```

> **Creating Closures**
> 
> A closure is created when an inner function is made accessible from outside of the function that created it. This typically occurs when an outer function returns an inner function. When this happens, the inner function maintains a reference to the environment in which it was created. This means that it remembers all of the variables (and their values) that were in scope at the time. The following example shows how a closure is created and used.

```
function add(value1) {
  return function doAdd(value2) {
    return value1 + value2;
  };
}

var increment = add(1);
var foo = increment(2);
// foo equals 3 
```

There are a number of things to note about this example.

The add() function returns its inner function doAdd(). By returning a reference to an inner function, a closure is created. “value1” is a local variable of add(), and a non-local variable of doAdd(). Non-local variables refer to variables that are neither in the local nor the global scope. “value2” is a local variable of doAdd(). When add(1) is called, a closure is created and stored in “increment”. In the closure’s referencing environment, “value1” is bound to the value one. Variables that are bound are also said to be closed over. This is where the name closure comes from. When increment(2) is called, the closure is entered. This means that doAdd() is called, with the “value1” variable holding the value one. The closure can essentially be thought of as creating the following function.

```
function increment(value2) {
  return 1 + value2;
} 
```

> **When to Use Closures**
> 
> Closures can be used to accomplish many things. They are very useful for things like configuring callback functions with parameters. This section covers two scenarios where closures can make your life as a developer much simpler.

**Working With Timers**

Closures are useful when used in conjunction with the *setTimeout()* and *setInterval()* functions. To be more specific, closures allow you to pass arguments to the callback functions of *setTimeout()* and *setInterval()*. For example, the following code prints the string “some message” once per second by calling *showMessage()*.

```
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Closures</title>
  <meta charset="UTF-8" />
  <script>
    window.addEventListener("load", function() {
      window.setInterval(showMessage, 1000, "some message<br />");
    });

    function showMessage(message) {
      document.getElementById("message").innerHTML += message;
    }
  </script>
</head>
<body>
  <span id="message"></span>
</body>
</html> 
```

Unfortunately, Internet Explorer does not support passing callback arguments via setInterval(). Instead of displaying “some message”, Internet Explorer displays “undefined” (since no value is actually passed to showMessage()). To work around this issue, a closure can be created which binds the “message” argument to the desired value. The closure can then be used as the callback function for setInterval(). To illustrate this concept, the JavaScript code from the previous example has been rewritten below to use a closure.

```
window.addEventListener("load", function() {
  var showMessage = getClosure("some message<br />");

  window.setInterval(showMessage, 1000);
});

function getClosure(message) {
  function showMessage() {
    document.getElementById("message").innerHTML += message;
  }

  return showMessage;
} 
```

**Emulating Private Data**

Many object-oriented languages support the concept of private member data. However, JavaScript is not a pure object-oriented language and does not support private data. But, it is possible to emulate private data using closures. Recall that a closure contains a reference to the environment in which it was originally created―which is now out of scope. Since the variables in the referencing environment are only accessible from the closure function, they are essentially private data.

The following example shows a constructor for a simple Person class. When each Person is created, it is given a name via the “<em>name” argument. Internally, the Person stores its name in the “<em>_name” variable. Following good object-oriented programming practices, the method *getName()* is also provided for retrieving the name.

```
function Person(name) {
  this._name = name;

  this.getName = function() {
    return this._name;
  };
} 
```

There is still one major problem with the Person class. Because JavaScript does not support private data, there is nothing stopping somebody else from coming along and changing the name. For example, the following code creates a Person named Colin, and then changes its name to Tom.

```
var person = new Person("Colin");

person._name = "Tom";
// person.getName() now returns "Tom" 
```

Personally, I wouldn’t like it if just anyone could come along and legally change my name. In order to stop this from happening, a closure can be used to make the “_name” variable private. The Person constructor has been rewritten below using a closure. Note that “_name” is now a local variable of the Person constructor instead of an object property. A closure is formed because the outer function, *Person()* exposes an inner function by creating the public *getName()* method.

```
function Person(name) {
  var _name = name;

  this.getName = function() {
    return _name;
  };
} 
```

Now, when getName() is called, it is guaranteed to return the value that was originally passed to the constructor. It is still possible for someone to add a new “_name” property to the object, but the internal workings of the object will not be affected as long as they refer to the variable bound by the closure. The following code shows that the “_name” variable is, indeed, private.

```
var person = new Person("Colin");

person._name = "Tom";
// person._name is "Tom" but person.getName() returns "Colin" 
```

> **When Not to Use Closures**
> 
> It is important to understand how closures work and when to use them. It is equally important to understand when they are not the right tool for the job at hand. Overusing closures can cause scripts to execute slowly and consume unnecessary memory. And because closures are so simple to create, it is possible to misuse them without even knowing it. This section covers several scenarios where closures should be used with caution.

**In Loops**

Creating closures within loops can have misleading results. An example of this is shown below. In this example, three buttons are created. When “button1” is clicked, an alert should be displayed that says “Clicked button 1”. Similar messages should be shown for “button2” and “button3”. However, when this code is run, all of the buttons show “Clicked button 4”. This is because, by the time one of the buttons is clicked, the loop has finished executing, and the loop variable has reached its final value of four.

```
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Closures</title>
  <meta charset="UTF-8" />
  <script>
    window.addEventListener("load", function() {
      for (var i = 1; i < 4; i++) {
        var button = document.getElementById("button" + i);

        button.addEventListener("click", function() {
          alert("Clicked button " + i);
        });
      }
    });
  </script>
</head>
<body>
  <input type="button" id="button1" value="One" />
  <input type="button" id="button2" value="Two" />
  <input type="button" id="button3" value="Three" />
</body>
</html> 
```

To solve this problem, the closure must be decoupled from the actual loop variable. This can be done by calling a new function, which in turn creates a new referencing environment. The following example shows how this is done. The loop variable is passed to the getHandler() function. getHandler() then returns a closure that is independent of the original “for” loop.

```
function getHandler(i) {
  return function handler() {
    alert("Clicked button " + i);
  };
}
window.addEventListener("load", function() {
  for (var i = 1; i < 4; i++) {
    var button = document.getElementById("button" + i);
    button.addEventListener("click", getHandler(i));
  }
}); 
```

> **Unnecessary Use in Constructors**
> 
> Constructor functions are another common source of closure misuse. We’ve seen how closures can be used to emulate private data. However, it is overkill to implement methods as closures if they don’t actually access the private data. The following example revisits the Person class, but this time adds a sayHello() method which doesn’t use the private data.

```
function Person(name) {
  var _name = name;

  this.getName = function() {
    return _name;
  };

  this.sayHello = function() {
    alert("Hello!");
  };
} 
```

> Each time a Person is instantiated, time is spent creating the sayHello() method. If many Person objects are created, this becomes a waste of time. A better approach would be to add sayHello() to the Person prototype. By adding to the prototype, all Person objects can share the same method. This saves time in the constructor by not having to create a closure for each instance. The previous example is rewritten below with the extraneous closure moved into the prototype.

```
function Person(name) {
  var _name = name;

  this.getName = function() {
    return _name;
  };
}

Person.prototype.sayHello = function() {
  alert("Hello!");
}; 
```

**Things to Remember**

*   Closures contain a function and a reference to the environment in which the function was created.
*   A closure is formed when an outer function exposes an inner function. Closures can be used to easily pass parameters to callback functions.
*   Private data can be emulated by using closures. This is common in object-oriented programming and namespace design.
*   Closures should be not overused in constructors. Adding to the prototype is a better idea.

[Link](https://www.sitepoint.com/javascript-closures-demystified/)

* * *

## 回答 #62

> 赞同：11
> 
> 时间：2014-04-03T09:11:41.320

当内部函数以某种方式可用于外部函数之外的任何范围时，就会创建一个闭包。

**例子：**

```
var outer = function(params){ //Outer function defines a variable called params
    var inner = function(){ // Inner function has access to the params variable of the outer function
        return params;
    }
    return inner; //Return inner function exposing it to outer scope
},
myFunc = outer("myParams");
myFunc(); //Returns "myParams" 
```

* * *

## 回答 #63

> 赞同：11
> 
> 时间：2014-06-09T15:26:38.920

闭包是满足三个条件的代码块：

*   它可以作为一个值传递，并且

*   由任何具有该价值的人按需执行，此时

*   它可以从创建它的上下文中引用变量（也就是说，它在变量访问方面是封闭的，在“封闭”这个词的数学意义上）。

（“关闭”这个词实际上有一个不精确的含义，有些人不认为标准＃1是定义的一部分。我认为是。）

闭包是函数式语言的支柱，但它们也出现在许多其他语言中（例如，Java 的匿名内部类）。你可以用它们做一些很酷的事情：它们允许延迟执行和一些优雅的风格技巧。

作者：保罗·坎特雷尔，@ [http://innig.net/software/ruby/closures-in-ruby](http://innig.net/software/ruby/closures-in-ruby)

* * *

## 回答 #64

> 赞同：11
> 
> 时间：2015-11-04T15:31:34.557

# 闭包很简单

你可能不应该告诉一个六岁的孩子关于闭包的事情，但如果你这样做了，你可能会说闭包提供了访问在其他函数范围中声明的变量的能力。

[![在此处输入图像描述](https://i.stack.imgur.com/OX92v.png)](https://i.stack.imgur.com/OX92v.png)

```
function getA() {
  var a = [];

  // this action happens later,
  // after the function returned
  // the `a` value
  setTimeout(function() {
    a.splice(0, 0, 1, 2, 3, 4, 5);
  });

  return a;
}

var a = getA();
out('What is `a` length?');
out('`a` length is ' + a.length);

setTimeout(function() {
  out('No wait...');
  out('`a` length is ' + a.length);
  out('OK :|')
});
```

```
<pre id="output"></pre>

<script>
  function out(k) {
    document.getElementById('output').innerHTML += '> ' + k + '\n';
  }
</script>
```

* * *

## 回答 #65

> 赞同：10
> 
> 时间：2013-06-22T23:30:53.883

考虑到这个问题只是简单地向一个**6 岁的孩子**解释，我的回答是：

**“当你在 JavaScript 中声明一个函数时，它可以永远访问该函数声明之前行中可用的所有变量和函数。函数以及它可以访问的所有外部变量和函数就是我们所说的闭包。 "**

* * *

## 回答 #66

> 赞同：10
> 
> 时间：2016-02-07T05:40:34.057

## 不包含自由变量的函数称为纯函数。

## 包含一个或多个自由变量的函数称为闭包。

```
var pure = function pure(x){
  return x 
  // only own environment is used
}

var foo = "bar"

var closure = function closure(){
  return foo
  // foo is free variable from the outer environment
} 
```

^(来源：[https ://leanpub.com/javascriptallongesix/read#leanpub-auto-if-functions-without-free-variables-are-pure-are-closures-impure](https://leanpub.com/javascriptallongesix/read#leanpub-auto-if-functions-without-free-variables-are-pure-are-closures-impure))

* * *

## 回答 #67

> 赞同：9
> 
> 时间：2015-07-13T03:20:33.037

我喜欢 Kyle Simpson 对闭包的定义：

> 闭包是指函数能够记住和访问其词法范围，即使该函数在其词法范围之外执行。

词法作用域是指内部作用域可以访问其外部作用域。

这是他在他的丛书“你不知道 JS：作用域和闭包”中提供的一个修改示例。

```
function foo() {
  var a = 2;

  function bar() {
    console.log( a );
  }
  return bar;
}

function test() {
  var bz = foo();
  bz();
}

// prints 2\. Here function bar referred by var bz is outside 
// its lexical scope but it can still access it
test(); 
```

* * *

## 回答 #68

> 赞同：9
> 
> 时间：2016-03-15T17:05:00.410

我认为 MDN 解释得最好：

> 闭包是引用独立（自由）变量的函数。换句话说，闭包中定义的函数“记住”了它被创建的环境。

闭包总是有一个外部函数和一个内部函数。内部函数是所有工作发生的地方，而外部函数只是保留创建内部函数的范围的环境。通过这种方式，闭包的内部功能“记住”了创建它的环境/范围。最经典的例子是一个计数器函数：

```
var closure = function() {
  var count = 0;
  return function() {
    count++;
    console.log(count);
  };
};

var counter = closure();

counter() // returns 1
counter() // returns 2
counter() // returns 3 
```

在上面的代码中，`count`是由外层函数（环境函数）保存的，这样每次调用`counter()`，内层函数（工作函数）就可以递增。

* * *

## 回答 #69

> 赞同：8
> 
> 时间：2014-05-17T12:30:30.010

闭包是指函数以在函数被调用时不可变的命名空间中定义的方式**关闭。**

在 JavaScript 中，当您：

*   在另一个函数中定义一个函数
*   外部函数返回后调用内部函数

```
// 'name' is resolved in the namespace created for one invocation of bindMessage
// the processor cannot enter this namespace by the time displayMessage is called
function bindMessage(name, div) {

    function displayMessage() {
        alert('This is ' + name);
    }

    $(div).click(displayMessage);
} 
```

* * *

## 回答 #70

> 赞同：8
> 
> 时间：2015-11-06T15:43:14.337

对于一个六岁的...

你知道什么是物体吗？

对象是具有属性和做事的东西。

关于闭包的最重要的事情之一是它们允许您在 JavaScript 中创建对象。JavaScript 中的对象只是函数和闭包，它们让 JavaScript 在对象创建后存储其属性值。

对象非常有用，可以让一切保持井井有条。不同的对象可以做不同的工作，而一起工作的对象可以做复杂的事情。

幸运的是 JavaScript 有用于创建对象的闭包，否则一切都会变成一场混乱的噩梦。

* * *

## 回答 #71

> 赞同：8
> 
> 时间：2016-01-16T20:49:58.767

这就是初学者如何将一个人的头包裹在闭包上，就像一个函数被包裹在一个也​​称为**闭包**的函数体中一样。

《Speaking JavaScript》一书中的定义“闭包是一个函数加上与创建函数的范围的连接” *——Axel Rauschmayer 博士*

那会是什么样子呢？这是一个例子

```
function newCounter() {
  var counter = 0;
   return function increment() {
    counter += 1;
   }
}

var counter1 = newCounter();
var counter2 = newCounter();

counter1(); // Number of events: 1
counter1(); // Number of events: 2
counter2(); // Number of events: 1
counter1(); // Number of events: 3 
```

*newCounter*在*increment*上关闭，*counter*可以被 increment 引用和*访问*。

*counter1*和*counter2*将跟踪它们自己的值。

简单但希望清楚地了解所有这些优秀和高级答案的闭包是什么。

* * *

## 回答 #72

> 赞同：8
> 
> 时间：2016-08-18T08:00:49.163

Closure are not difficult to understand. It depends only from the point of view.

I personally like to use them in cases of daily life.

```
function createCar()
{
    var rawMaterial = [/* lots of object */];
    function transformation(rawMaterials)
    {
       /* lots of changement here */
       return transformedMaterial;
    }
    var transformedMaterial = transformation(rawMaterial);
    function assemblage(transformedMaterial)
    {
        /*Assemblage of parts*/
        return car;
    }
    return assemblage(transformedMaterial);
} 
```

We only need to go through certain steps in particular cases. As for the transformation of materials is only useful when you have the parts.

* * *

## 回答 #73

> 赞同：7
> 
> 时间：2015-11-24T21:21:59.840

从前有一个穴居人

```
function caveman { 
```

他有一块非常特别的岩石，

```
var rock = "diamond"; 
```

你自己拿不到岩石，因为它在穴居人的私人洞穴里。只有穴居人知道如何找到并得到岩石。

```
return {
    getRock: function() {
        return rock;
    }
};
} 
```

幸运的是，他是一个友好的穴居人，如果你愿意等他回来，他会很乐意为你得到它。

```
var friend = caveman();
var rock = friend.getRock(); 
```

相当聪明的穴居人。

* * *

## 回答 #74

> 赞同：7
> 
> 时间：2017-01-20T22:14:02.870

My perspective of Closures:

***Closures can be compared to a book, with a bookmark, on a bookshelf.***

Suppose you have read a book, and you like some page in the book. You put in a bookmark at that page to track it.

Now once you finish reading the book, you do not need the book anymore, except, you want to have access to that page. You could have just cut out the page, but then you would loose the context on the story. So you put the book back in your bookshelf with the bookmark.

This is similar to a closure. The book is the outer function, and the page is your inner function, which gets returned, from the outer function. The bookmark is the reference to your page, and the context of the story is the lexical scope, which you need to retain. The bookshelf is the function stack, which cannot be cleaned up of the old books, till you hold onto the page.

***Code Example:***

```
function book() {
   var pages = [....]; //array of pages in your book
   var bookMarkedPage = 20; //bookmarked page number
   function getPage(){
       return pages[bookMarkedPage];
   }
   return getPage;
}

var myBook = book(),
    myPage = myBook.getPage(); 
```

When you run the `book()` function, you are allocating memory in the stack for the function to run in. But since it returns a function, the memory cannot be released, as the inner function has access to the variables from the context outside it, in this case 'pages' and 'bookMarkedPage'.

So effectively calling `book()` returns a reference to a closure, i.e not only a function, but a reference to the book and it's context, i.e. a reference to the function *getPage*, state of *pages* and *bookMarkedPage* variables.

***Some points to consider:***

**Point 1:** The bookshelf, just like the function stack has limited space, so use it wisely.

**Point 2:** Think about the fact, whether you need to hold onto the entire book when you just want to track a single page. You can release part of the memory, by not storing all the pages in the book when the closure is returned.

*This is my perspective of Closures. Hope it helps, and if anyone thinks that this is not correct, please do let me know, as I am very interested to understand even more about scopes and closures!*

* * *

## 回答 #75

> 赞同：7
> 
> 时间：2017-04-10T10:59:57.233

Let's start from here, As defined on MDN: [**Closures**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures) are functions that refer to independent (free) variables (variables that are used locally, but defined in an enclosing scope). In other words, these functions 'remember' the environment in which they were created.

**Lexical scoping**
Consider the following:

```
function init() {
  var name = 'Mozilla'; // name is a local variable created by init
  function displayName() { // displayName() is the inner function, a closure
    alert(name); // use variable declared in the parent function    
  }
  displayName();    
}
init(); 
```

init() creates a local variable called name and a function called displayName(). The displayName() function is an inner function that is defined inside init() and is only available within the body of the init() function. The displayName() function has no local variables of its own. However, because inner functions have access to the variables of outer functions, displayName() can access the variable name declared in the parent function, init().

```
function init() {
    var name = "Mozilla"; // name is a local variable created by init
    function displayName() { // displayName() is the inner function, a closure
        alert (name); // displayName() uses variable declared in the parent function    
    }
    displayName();    
}
init(); 
```

Run the code and notice that the alert() statement within the displayName() function successfully displays the value of the name variable, which is declared in its parent function. This is an example of lexical scoping, which describes how a parser resolves variable names when functions are nested. The word "lexical" refers to the fact that lexical scoping uses the location where a variable is declared within the source code to determine where that variable is available. Nested functions have access to variables declared in their outer scope.

**Closure**
Now consider the following example:

```
function makeFunc() {
  var name = 'Mozilla';
  function displayName() {
    alert(name);
  }
  return displayName;
}

var myFunc = makeFunc();
myFunc(); 
```

Running this code has exactly the same effect as the previous example of the init() function above: this time, the string "Mozilla" will be displayed in a JavaScript alert box. What's different — and interesting — is that the displayName() inner function is returned from the outer function before being executed.

At first glance, it may seem unintuitive that this code still works. In some programming languages, the local variables within a function exist only for the duration of that function's execution. Once makeFunc() has finished executing, you might expect that the name variable would no longer be accessible. However, because the code still works as expected, this is obviously not the case in JavaScript.

The reason is that functions in JavaScript form closures. A closure is the combination of a function and the lexical environment within which that function was declared. This environment consists of any local variables that were in-scope at the time that the closure was created. In this case, myFunc is a reference to the instance of the function displayName created when makeFunc is run. The instance of displayName maintains a reference to its lexical environment, within which the variable name exists. For this reason, when myFunc is invoked, the variable name remains available for use and "Mozilla" is passed to alert.

Here's a slightly more interesting example — a makeAdder function:

```
function makeAdder(x) {
  return function(y) {
    return x + y;
  };
}

var add5 = makeAdder(5);
var add10 = makeAdder(10);

console.log(add5(2));  // 7
console.log(add10(2)); // 12 
```

In this example, we have defined a function makeAdder(x), which takes a single argument, x, and returns a new function. The function it returns takes a single argument, y, and returns the sum of x and y.

In essence, makeAdder is a function factory — it creates functions which can add a specific value to their argument. In the above example we use our function factory to create two new functions — one that adds 5 to its argument, and one that adds 10.

add5 and add10 are both closures. They share the same function body definition, but store different lexical environments. In add5's lexical environment, x is 5, while in the lexical environment for add10, x is 10.

**Practical closures**

Closures are useful because they let you associate some data (the lexical environment) with a function that operates on that data. This has obvious parallels to object oriented programming, where objects allow us to associate some data (the object's properties) with one or more methods.

Consequently, you can use a closure anywhere that you might normally use an object with only a single method.

Situations where you might want to do this are particularly common on the web. Much of the code we write in front-end JavaScript is event-based — we define some behavior, then attach it to an event that is triggered by the user (such as a click or a keypress). Our code is generally attached as a callback: a single function which is executed in response to the event.

For instance, suppose we wish to add some buttons to a page that adjust the text size. One way of doing this is to specify the font-size of the body element in pixels, then set the size of the other elements on the page (such as headers) using the relative em unit:

```
body {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 12px;
}

h1 {
  font-size: 1.5em;
}

h2 {
  font-size: 1.2em;
} 
```

Our interactive text size buttons can change the font-size property of the body element, and the adjustments will be picked up by other elements on the page thanks to the relative units. Here's the JavaScript:

```
function makeSizer(size) {
  return function() {
    document.body.style.fontSize = size + 'px';
  };
}

var size12 = makeSizer(12);
var size14 = makeSizer(14);
var size16 = makeSizer(16); 
```

size12, size14, and size16 are now functions which will resize the body text to 12, 14, and 16 pixels, respectively. We can attach them to buttons (in this case links) as follows:

```
document.getElementById('size-12').onclick = size12;
document.getElementById('size-14').onclick = size14;
document.getElementById('size-16').onclick = size16;

<a href="#" id="size-12">12</a>
<a href="#" id="size-14">14</a>
<a href="#" id="size-16">16</a>

function makeSizer(size) {
  return function() {
    document.body.style.fontSize = size + 'px';
  };
}

var size12 = makeSizer(12);
var size14 = makeSizer(14);
var size16 = makeSizer(16);

document.getElementById('size-12').onclick = size12;
document.getElementById('size-14').onclick = size14;
document.getElementById('size-16').onclick = size16; 
```

for reading more about closures, visit the [link on MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)

* * *

## 回答 #76

> 赞同：6
> 
> 时间：2013-08-16T16:00:48.827

闭包基本上创建了两件事： - 函数 - 只有该函数可以访问的私有范围

这就像在函数周围涂上一层涂层。

所以对于一个 6 岁的孩子，可以通过类比来解释。假设我制造了一个机器人。那个机器人可以做很多事情。其中，我对其进行了编程，以计算他在天空中看到的鸟的数量。每次他看到 25 只鸟，他都应该告诉我他从一开始就看到了多少只鸟。

除非他告诉我，否则我不知道他见过多少只鸟。只有他自己知道。那是私有范围。这基本上就是机器人的记忆。假设我给了他 4 GB。

告诉我他看到了多少只鸟是返回的函数。我也创造了那个。

这个类比有点糟糕，但我想有人可以改进它。

* * *

## 回答 #77

> 赞同：6
> 
> 时间：2013-10-21T13:47:59.977

*闭包*一词只是指能够访问在*函数*（六岁：盒子）内*关闭*（六岁：私有）的*对象*（六岁：事物）。即使*函数*（六岁：盒子）超出*范围*（六岁：发送很远）。

 **** * *

## 回答 #78

> 赞同：6
> 
> 时间：2014-03-28T19:45:45.703

我以前读过所有这些，它们都非常有用。有些人非常接近获得简单的解释，然后变得复杂或保持抽象，违背了目的并且未能展示非常简单的现实世界用途。

尽管通过所有的示例和解释，你可以通过注释和代码很好地了解什么是闭包，什么不是闭包，但我仍然对一个非常简单的说明不满意，它帮助我在不变得如此复杂的情况下获得闭包的有用性。我的妻子想学习编码，我认为我需要能够在这里不仅展示什么，而且展示为什么，以及如何。

我不确定一个 6 岁的孩子是否会明白这一点，但我认为它可能更接近于以现实世界的方式展示一个简单的案例，这可能真的很有用，而且很容易理解。

最好的（或最接近最简单的）之一是复述 Morris 的 Closures for Dummies 示例。

将“SayHi2Bob”概念进一步展示了您可以从阅读所有答案中收集到的两个基本信息：

1.  闭包可以访问包含函数的变量。
2.  闭包在它们自己的内存空间中持续存在（因此对于各种 oop-y 实例化的东西都很有用）

向自己证明和证明这一点，我做了一个小小提琴：

[http://jsfiddle.net/9ZMyr/2/](http://jsfiddle.net/9ZMyr/2/)

```
function sayHello(name) {
  var text = 'Hello ' + name; // Local variable
  console.log(text);
  var sayAlert = function () {
      alert(text);
  }
  return sayAlert;
}

sayHello(); 
/* This will write 'Hello undefined' to the console (in Chrome anyway), 
but will not alert though since it returns a function handle to nothing). 
Since no handle or reference is created, I imagine a good js engine would 
destroy/dispose of the internal sayAlert function once it completes. */

// Create a handle/reference/instance of sayHello() using the name 'Bob'
sayHelloBob = sayHello('Bob');
sayHelloBob();

// Create another handle or reference to sayHello with a different name
sayHelloGerry = sayHello('Gerry');
sayHelloGerry();

/* Now calling them again demonstrates that each handle or reference contains its own 
unique local variable memory space. They remain in memory 'forever' 
(or until your computer/browser explode) */
sayHelloBob();
sayHelloGerry(); 
```

这展示了您应该了解的关于闭包的两个基本概念。

用简单的术语来解释为什么这是有用的，我有一个基本函数，我可以对其进行引用或处理，其中包含在该内存引用中持久存在的唯一数据。每次我想说出某人的名字时，我都不必重写函数。我已经封装了该例程并使其可重用。

对我来说，这至少导致了构造函数、oop 实践、单例与具有自己数据的实例化实例等的基本概念，等等。

如果您从新手开始，那么您可以继续进行更复杂的基于对象属性/成员的调用，并希望这些概念能够继续。

* * *

## 回答 #79

> 赞同：6
> 
> 时间：2014-06-01T20:39:14.533

我认为退后一步，研究一个更一般的“闭包”概念——所谓的“连接运算符”是很有价值的。

在数学中，“连接”运算符是偏序集上的一个函数，它返回大于或等于其参数的最小对象。在符号中，连接 [a,b] = d 使得 d >= a 和 d >= b，但不存在使 d > e >= a 或 d > e >= b 的 e。

因此，连接为您提供了比零件“更大”的最小的东西。

现在，请注意 JavaScript 范围是一个部分有序的结构。所以有一个合理的连接概念。特别是，范围的连接是比原始范围大的最小范围。该范围称为**闭包**。

因此，变量 a、b、c 的闭包是将 a、b 和 c 带入作用域的最小作用域（在程序的作用域格中！）。

* * *

## 回答 #80

> 赞同：6
> 
> 时间：2015-04-29T00:14:13.827

我能想到的解释**JavaScript 闭包**的最简单用例是模块模式。在模块模式中，您定义了一个函数，然后立即在所谓的立即调用函数表达式 (IIFE) 中调用它。**您在该函数中编写的所有内容都具有私有范围，因为它是在闭包中定义的**，因此允许您在 JavaScript 中“模拟”隐私。像这样：

```
 var Closure = (function () {
    // This is a closure
    // Any methods, variables and properties you define here are "private"
    // and can't be accessed from outside the function.

    //This is a private variable
    var foo = "";

    //This is a private method
    var method = function(){

    }
})(); 
```

另一方面，如果您想让一个或多个变量或方法在闭包外可见，您可以在对象字面量中返回它们。像这样：

```
var Closure = (function () {
  // This is a closure
  // Any methods, variables and properties you define here are "private"
  // and can't be accessed from outside the function.

  //This is a private variable
  var foo = "";

  //This is a private method
  var method = function(){

  }

  //The method will be accessible from outside the closure
  return {
    method: method
  }

})();

Closure.method(); 
```

希望能帮助到你。问候，

* * *

## 回答 #81

> 赞同：6
> 
> 时间：2015-10-12T02:15:59.167

最好的方法是逐步解释这些概念：

**变量**

```
console.log(x);
// undefined 
```

这`undefined`就是 JavaScript 表达“我不知道是什么`x`意思”的方式。

> 变量就像标签。

你可以说，标签`x`指向值`42`：

```
var x = 42;
console.log(x);
// 42 
```

现在 JavaScript 知道什么`x`意思了。

> 您也可以重新分配变量。

使标记`x`指向不同的值：

```
x = 43;
console.log(x);
// 43 
```

现在`x`意味着别的东西。

**范围**

> 当您创建一个函数时，该函数有自己的变量“框”。

```
function A() {
  var x = 42;
}

console.log(x);

// undefined 
```

从盒子外面，你看不到盒子里面的东西。

但是从盒子里面，你可以看到盒子外面的东西：

```
var x = 42;

function A() {
  console.log(x);
}

// 42 
```

> 在函数内部`A`，您可以“范围访问” `x`.

现在，如果您有两个并排的盒子：

```
function A() {
  var x = 42;
}

function B() {
  console.log(x);
}

// undefined 
```

> 在函数内部`B`，您无法访问函数内部的变量`A`。

但是如果你把定义函数放在函数`B`里面`A`：

```
function A() {

  var x = 42;

  function B() {
    console.log(x);
  }

}

// 42 
```

您现在拥有“范围访问权限”。

**职能**

在 JavaScript 中，您通过调用一个函数来运行它：

```
function A() {
  console.log(42);
} 
```

像这样：

```
A();

// 42 
```

**作为值的函数**

在 JavaScript 中，您可以将标签指向函数，就像指向数字一样：

```
var a = function() {
  console.log(42);
}; 
```

> 变量`a`现在意味着一个函数，你可以运行它。

```
a();
// 42 
```

你也可以传递这个变量：

```
setTimeout(a, 1000); 
```

在一秒钟（1000 毫秒）内，函数`a`指向的函数被调用：

```
// 42 
```

**关闭范围**

现在，当您定义函数时，这些函数可以访问它们的外部作用域。

当您将函数作为值传递时，如果该访问权限丢失，将会很麻烦。

> 在 JavaScript 中，函数保持对外部范围变量的访问。即使它们被传递到其他地方运行。

```
var a = function() {

  var text = 'Hello!'

  var b = function() {
    console.log(text);
    // inside function `b`, you have access to `text`
  };

  // but you want to run `b` later, rather than right away
  setTimeout(b, 1000);

} 
```

现在会发生什么？

```
// 'Hello!' 
```

或者考虑一下：

```
var c;

var a = function() {

  var text = 'Hello!'

  var b = function() {
    console.log(text);
    // inside function `b`, you have access to `text`
  };

  c = b;

}

// now we are out side of function `a`
// call `a` so the code inside `a` runs
a(); 

// now `c` has a value that is a function
// because what happened when `a` ran

// when you run `c`
c();

// 'Hello!' 
```

> 您仍然可以访问闭包范围内的变量。

即使`a`已经跑完了，现在你跑到`c`外面去了`a`.

这里刚刚发生的事情在 JavaScript中称为“***闭包”。***

* * *

## 回答 #82

> 赞同：6
> 
> 时间：2015-11-27T16:11:49.437

JavaScript 中的闭包与作用域的概念相关联。

在 es6 之前，没有块级作用域，JS 中只有函数级作用域。

这意味着每当需要块级范围时，我们都需要将其包装在一个函数中。

查看这个简单有趣的例子，闭包如何在 ES5 中解决这个问题

```
// let say we can only use a traditional for loop, not the forEach

for (var i = 0; i < 10; i++) {

    setTimeout(function() {
        console.log('without closure the visited index - '+ i)
    })
}

// this will print 10 times 'visited index - 10', which is not correct

/**
Expected output is 

visited index - 0
visited index - 1
.
.
.
visited index - 9

**/

// we can solve it by using closure concept 
   //by using an IIFE (Immediately Invoked Function Expression)

// --- updated code ---

for (var i = 0; i < 10; i++) {
    (function (i) {
      setTimeout(function() {
        console.log('with closure the visited index - '+ i)
      })
    })(i);
}
```

注意：这可以通过使用 es6`let`而不是es6 轻松解决`var`，因为 let 创建了词法范围。

* * *

## 简单来说，JS 中的闭包就是访问函数作用域。

* * *

## 回答 #83

> 赞同：4
> 
> 时间：2014-03-12T22:23:38.030

# 最简单、最短、最容易理解的答案：

闭包是一段代码，其中每一行都可以引用具有相同变量名的同一组变量。

如果“this”的含义与其他地方的含义不同，那么您就知道这是两个不同的闭包。

* * *

## 回答 #84

> 赞同：4
> 
> 时间：2015-04-29T00:21:32.983

*另外……* 也许我们应该让你 27 岁的朋友*放松一点，*因为“关闭”的整个概念真的**是（！）** ……*巫毒！*

我的意思是：*（a）*直觉上，你不期望它......并且...... *（b）*当有人花时间向你解释它时，你当然不期望它*起作用！*

直觉告诉你“这一定是胡说八道……*肯定会*导致某种语法错误或什么的！” *实际上，您究竟如何（！）* “从任何地方的'中间'拉出一个函数”，这样您[仍然！]实际上可以读/写访问“无论在哪里-它——*在——在*？！”

当你最终意识到这样的事情是*可能的，*那么......当然......任何人的*事后*反应都会是：“哇-aaa（！）......kew-el-lll......（！！ ！）”

但首先将有一个“违反直觉的巨大障碍”需要克服。直觉给了你很多完全合理的期望，即这样的事情“*当然，*绝对是荒谬的，因此是完全不可能的”。

就像我说的：“这是伏都教。”

* * *

## 回答 #85

> 赞同：4
> 
> 时间：2017-03-22T09:18:18.370

A closure is simply when a function have access to its outside scope even after the scope's function has finished executing. Example:

```
function multiplier(n) {
    function multiply(x) {
          return n*x;
    }
    return mutliply;
}

var 10xmultiplier = multiplier(10);
var x = 10xmultiplier(5); // x= 50 
```

we can see that even after multiplier has finished executing, the inner function multiply gets still access to the value of x which is 10 in this example.

A very common use of closures is currying (the same example above) where we spice our function progressively with parameters instead of supplying all of the arguments at once.

We can achieve this because Javascript (in addition to the prototypal OOP) allows as to program in a functional fashion where higher order functions can take other functions as arguments (fisrt class functions). [functional programming in wikipedia](https://www.google.ae/url?sa=t&source=web&rct=j&url=https://en.m.wikipedia.org/wiki/Functional_programming&ved=0ahUKEwjaqeyM5enSAhUF7BQKHYyCBCUQFggZMAA&usg=AFQjCNHcEMds9EmEfJfjtHIvLZhAivGFFQ&sig2=rXB-1kc0AEVYLNy4fhGSmw)

I highly recommend you to read this book by Kyle Simpson: [2](https://github.com/getify/You-Dont-Know-JS) one part of the book series is dedicated to closures and it is called scope and closures. [you don't know js: free reading on github](https://github.com/getify/You-Dont-Know-JS)

* * *

## 回答 #86

> 赞同：2
> 
> 时间：2015-11-04T20:36:26.120

闭包是一个可以从定义它的环境中访问信息的函数。

对于某些人来说，信息是创建时环境中的*价值*。对于其他人来说，信息是创建时环境中的变量。

如果闭包引用的词法环境属于已经退出的函数，那么（在闭包引用环境中的变量的情况下）这些词法变量将继续存在以供闭包引用。

闭包可以被认为是全局变量的一种特殊情况——为函数创建了一个私有副本。

或者它可以被认为是一种方法，其中环境是对象的特定实例，其属性是环境中的变量。

前者（闭包作为环境）与后者类似，前者环境副本是传递给每个函数的上下文变量，后者中实例变量形成上下文变量。

因此，闭包是一种调用函数的方式，而无需将上下文显式指定为参数或方法调用中的对象。

```
var closure = createclosure(varForClosure);
closure(param1);  // closure has access to whatever createclosure gave it access to,
                  // including the parameter storing varForClosure. 
```

对比

```
var contextvar = varForClosure; // use a struct for storing more than one..
contextclosure(contextvar, param1); 
```

对比

```
var contextobj = new contextclass(varForClosure);
contextobj->objclosure(param1); 
```

对于可维护的代码，我推荐面向对象的方式。然而，对于一组快速简单的任务（例如创建回调），闭包可以变得更自然和更清晰，尤其是在 lamda 或匿名函数的上下文中。

# c++ - 如何将 TDD 方法与 VisualStudio 集成？

> ID：111122
> 
> 赞同：11
> 
> 时间：2008-09-21T14:27:53.177
> 
> 标签：c++, visual-studio, unit-testing, tdd

我有兴趣了解在 Visual Studio 2005（专业版）中使用 TDD 和 C++ 单元测试的经验

首先是一些背景。我们有一个相当大的项目，其中大部分是在 Linux 上使用 CppUnit 进行单元测试开发的。该项目分为几个库，每个库都有自己的一组测试。我有一个简单的脚本来编译库，编译测试套件，然后运行测试。因此，在对代码进行更改后，我只需从命令行运行“test”并运行测试。

现在，大多数开发人员都在 Windows 上使用 Visual Studio 2005 来开发这个产品。当然，他们仍然可以使用 nmake 从命令行运行测试，但涉及额外的步骤，我希望有一个更集成的解决方案。

所以我的问题有两个部分。

首先，在大型代码库上布置测试代码的最佳方式是什么？在一个解决方案中创建多个测试项目，每个库一个是正常的吗？

其次，是否有任何工具可以将 CppUnit 测试集成到 Visual Studio 中？正确设置依赖项后，测试项目应该运行测试，但目前结果仍显示在命令窗口中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T02:05:24.607

我公司的一个项目就是这样做的。我们使用一个名为 CXXTest ( [http://cxxtest.sourceforge.net/guide.html](http://cxxtest.sourceforge.net/guide.html) ) 的单元测试框架。我们非常喜欢这个 C++ 框架，因为它只需要您编写一个包含单元测试的头文件。.CPP 文件由脚本创建（提供 Python 和 Perl 脚本）。

我们通过提供构建单元测试（如果需要构建）然后执行它们的后期构建步骤与 Visual Studio 集成。输出（显示通过和失败的内容）显示在输出窗口中——您永远不需要离开 IDE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T00:10:15.000

这是我所做的：

*   在您的主解决方案中创建一个测试可执行项目，该项目仅使用来自单元、单元测试和测试框架的源代码。
*   使测试运行程序在成功运行测试时生成一个文本文件，以便 Visual Studio 可以跟踪依赖关系。
*   添加一个项目以启动您的测试运行程序并生成测试文件。这意味着您现在每个测试有两个项目。
*   使测试运行器成为包含该单元的库的依赖项。

就个人而言，我认为测试框架（Google Test、Boost test、CppUnit 等）并不重要。大多数在功能上几乎相同。

我对生成的项目数量并不完全满意，但我认为这是一个 Visual Studio GUI 问题，因为这样包含这些项目实际上非常有用，用于调试等目的。

我尝试使用构建后步骤来运行测试，但不幸的是，这意味着在第一次失败过去后构建没有中断。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-21T18:19:07.677

我使用 Boost Test 框架。我倾向于将我的代码拆分为 .lib 文件，并且每个文件都有一个单独的控制台模式 EXE 测试项目。构建测试项目时，它利用“构建后阶段”启动自身，从而运行测试。您可以使每个测试项目成为主应用程序的依赖项，以便每次构建时，首先运行所有测试，但这可能很耗时。相反，我倾向于根据需要手动运行测试项目，但我的自动化夜间构建系统将理所当然地运行所有测试项目（我编写脚本，如果任何测试失败，构建失败，我会收到电子邮件通知）。

更多细节[在这里。](http://www.codeproject.com/KB/architecture/Designing_Robust_Objects.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T03:14:39.243

*   我发现以下文件夹层次结构很有用。创建代码和测试作为 ProjectFolder 的子文件夹。创建 2 个解决方案 code\Project.sln 和 tests\Tests.sln。现在对于每个创建的类库或可执行文件，例如Customers.dll，都有一个相应的测试dll。所以code\Customers\Customers.csproj会有tests\Customers\TestCustomers.csproj，它引用了前者。
*   将 CPPUnit 集成到 Visual Studio 中需要在项目属性中选择正确的应用程序。“调试”设置。我认为[此页面具有](http://www.comp.nus.edu.sg/~cs3215/tools/cplusplus/cppunitAll.html)在 IDE 中执行单键测试执行 + 报告所需的功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T14:53:48.307

My team is currently using an system where we have an automated nightly build (that can also be run from the project build dashboard by anyone) that includes a VS2k5 "test" solution. The test solution holds all the unit test projects; one unit test project for every "unit" of code in the main project.

When the automated build runs, it builds the main solution, then the test solution, and finally runs all the executables produced by the test solution (a Perl script glues this together). The results of the compile as well as the test execution (EXIT _ SUCCESS, EXIT _ FAILURE) are used to update the project build dashboard.

That EXIT _ FAILURE trick can also be applied to a custom build step of the main project: if the unit test custom build step returns EXIT _ FAILURE, then the build itself fails.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T02:29:47.620

您还可以使用托管 C++ 在 Visual Studio 中使用内置的单元测试框架编写单元测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T22:12:07.980

看看[CUnitWin32](http://code.google.com/p/cunitwin32/)。还包括一个例子。

# mysql - 查询 MySQL information_schema 数据库是查找相关表的好方法吗？

> ID：111129
> 
> 赞同：8
> 
> 时间：2008-09-21T14:33:59.650
> 
> 标签：mysql

我有一个表，它被许多其他表上的外键引用。在我的程序中，如果我想删除这些行之一，我需要首先搜索依赖项并将它们呈现给用户 - “这个对象依赖于表 y 中的 x，表 q 中的 z 等”。我还预计具有该表的外键的表的数量会随着时间的推移而显着增加。

information_schema 数据库是搜索所有依赖项的好方法吗？我尝试查询它以检索具有我的表的外键的所有表的列表，然后迭代结果并从每个表中选择外键值与用户尝试删除的值匹配的所有条目。我的查询如下：

```
SELECT * FROM `KEY_COLUMN_USAGE` kcu
LEFT JOIN TABLE_CONSTRAINTS tc
ON tc.CONSTRAINT_NAME = kcu.CONSTRAINT_NAME
WHERE tc.CONSTRAINT_TYPE='FOREIGN KEY'
AND (kcu.REFERENCED_TABLE_SCHEMA='db')
AND (kcu.REFERENCED_TABLE_NAME = 'testtable') 
```

这非常适合确定我需要搜索的表，但是它*非常*慢。在我的开发机器上执行查询最多需要大约 1 到 2 秒，当我在生产服务器上运行它时会减少很多，但仍然会很慢。

我需要知道以这种方式使用 information_schema 是否是个坏主意。如果没有，我如何从查询中提取更好的性能。我正在使用的查询是可靠的还是有更好的方法呢？如果是这样，从可维护性的角度来看，我应该如何最好地解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T15:01:25.840

Dvorak 是对的，INFORMATION_SCHEMA 就是为此而设计的。

关于您的性能问题，有几种方法可以提高性能

*   简单的方法，但不会有太大的改进：将信息存储在静态变量中。至少查询每页只发生一次

*   使用持久缓存：替代的 PHP 缓存可以帮助您（参见[http://fr3.php.net/manual/en/book.apc.php](http://fr3.php.net/manual/en/book.apc.php)）。您将从信息模式中获得的信息非常适合存储在持久缓存中。

*   使用 ORM 库，例如教义 ( [http://www.doctrine-project.org/](http://www.doctrine-project.org/) ) 查看文件 lib/Doctrine/Import/Mysql.php 会发现它完全符合您的需要，等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T14:40:32.147

我认为这正是 INFORMATION_SCHEMA 的用途。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-22T23:30:23.393

我也在调查这个。我想将 KEY_COLUMN_USAGE 用于一些 CRUD。而且我注意到这些表上没有任何可用的键或索引。这可能是性能不佳的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-21T15:21:26.730

在静态或管理系统上使用 INFORMATION_SCHEMA 是可以的，但不建议将其用于事务性应用程序功能，因为 INFORMATION_SCHEMA 可能是作为本地系统数据字典顶部的视图实现的。

这对于为 CRUD 库执行通用“D”操作将是一种相当低效的方法。此外，在许多系统上（想到 Oracle），系统数据字典实际上是作为较低级别数据结构上的视图实现的。这意味着本机系统数据字典也可能不适合此。系统数据字典也可能因版本而异。

在相对较少的情况下，直接“删除”记录及其所有子项是正确的方法。将其作为通用功能执行可能会给您带来一点实际好处。此外，如果数据库中不存在外键，您将得到孤儿，因为这种方法取决于 FK 的存在以知道要删除哪些孩子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-25T11:50:04.653

让我的应用程序慢下来，但我需要外键约束数据才能将所有内容正确连接在一起。

查询信息模式时延迟很大，并且使一个曾经立即加载的页面在 3-4 秒内加载。

好吧，至少在 MySQL 5 中可以使用外键约束，这使得应用程序开发更加健壮，但显然是有代价的。

根据我的谷歌搜索，自 2006 年以来，人们一直在抱怨这个问题，但问题仍然存在——一定不是一个容易解决的问题 ;--(

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-20T07:59:42.200

万一这在谷歌上被发现，还值得注意的是 information_schema 有时会与`show create table`.

在这个[DBA Stack Exchange 线程](https://dba.stackexchange.com/questions/2817/why-does-mysql-not-have-hash-indices-on-myisam-or-innodb/2818#2818)中有一个很好的例子。执行此命令后：

```
create table rolando (num int not null, primary key (num) using hash); 
```

检查结果：

```
mysql> show create table rolando\G
  (...)
  PRIMARY KEY (`num`) USING HASH

mysql> show indexes from rolando;
(...) | Index_type | (...)
(...) | BTREE      | (...) 
```

# multithreading - What is the coolest thing you have done with threads?

> ID：111133
> 
> 赞同：2
> 
> 时间：2008-09-21T14:36:29.347
> 
> 标签：multithreading

Just wondering

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-21T14:38:31.917

I made them work as I wanted once ! That was cool!

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-21T15:00:34.970

I don't know if this counts, but for me a working multithreaded software is fascinating in itself, not so much the purpose they achieve. You have like 10, 20, 100 workers working in your program with the same infrastructure (Singletons, files etc.). Having everything work in harmony with mutexes, semaphores, context switches etc. is wonderful to observe, like being a manager and your team is working perfectly together. You read the application log, see the threads cooperate for a common goal, and it's just great. Can anybody relate to this feeling?

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-21T14:47:35.657

I'd love to say that I've cleverly parallelized an algorithm using lock-free data structures in order to get n-fold performance increase on an n-core processor. But I've never had a practical need, especially since most of my professional code has been for single-core systems.

Almost every time I've used more than one thread, in any language, it has been one of two reasons:

*   the system (or a third party) offers a blocking API and I need an asynchronous one (or at least to let several ops run at once).
*   to take advantage of pre-emptive priority-based scheduling to keep everything nice and responsive without having to chop all my slow operations into tiny pieces by hand.

Necessary, but not what you'd call glamorous.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-21T15:06:17.950

I'm so useless with threads, I have to get my girlfriend to sew my buttons back on.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-21T15:22:57.083

我们曾经编写过一个多线程应用程序，它基本上逐行读取文件，并在内部数据库中查找是否有匹配项，添加一些数据并移至下一行。但复杂性在于可能同时处理多个文件，并且可以搜索每个文件的多个记录。有一个管理器类知道有多少线程可用，并负责为每个文件分配可用的工作线程（如果只有一个文件要处理，它将接收所有 40 个线程，如果有 5 个文件，取决于优先级，每个人都会收到这 40 个的一小部分）。我们一开始使用异步委托，但注意到很难捕获异步线程中可能发生的任何异常，因此我们使用了 .net 中的传统线程启动。

这样做的关键是在管理器类中有一个 ManualResetEvents 集合，该集合由 ManualResentEvents 组成，这些 ManualResentEvents 是工人类（线程）中的公共属性。当工作线程完成时，它会发出 ManualResetEvent 信号，该事件将由 Manager 类上的 .WaitAny() 拾取。然后，管理器会知道其中一个线程已完成，并会启动一个新线程。实际上它比这复杂一点，但这是它所做的核心。

困难的部分是对此进行单元测试，以确保在任何给定时间运行正确数量的线程。我们进行了一些测试，就好像队列中只有一个文件（获取所有 40 个线程），然后引入了另一个文件，并且线程的分配必须循环到两个文件的每个文件 20 个。我们有“模拟对象”，它本质上有一个线程睡眠参数，我们将传递一个值（以毫秒为单位）来控制每个线程需要多长时间来处理，这样我们就可以很好地了解何时进行断言或询问文件处理器查看当前正在处理的线程数、记录数。还有一些测试会运行两个文件，每个文件有 20 个线程，

我确信这不是对我们实际所做的最清楚的解释，我真的需要写一篇关于它的博客文章。如果有人需要更多信息，请与我联系，我会尽力回答。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-21T15:39:56.670

我最近受雇帮助处理在 Microsoft Windows 系统上运行的一个相当大且复杂的多线程应用程序，该应用程序具有读/写锁定对象。这使得搜索死锁变得困难，所以我编写了一个死锁检测对象，在它自己的线程中执行，每当锁定对象尝试锁定、成功或锁定失败和解锁时，都会从锁定对象发送信息消息（使用 PostThreadMessage）。

通过在真值表中查找不同的线程和共享锁及其状态，就可以毫无疑问地查明死锁的原因和位置。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-21T15:50:01.607

我发现我可以创建一个只有一个写入器和一个读取器的 FIFO，而无需使用任何同步工具。

（所以一个具有 2*n FIFO 的主从 .. 没有任何互斥锁/信号机！！）

如果你有一个长链表，你不需要同步一端插入和另一端移除。

诀窍是在列表中始终保留一个元素（-；代码非常小

当一个硬件人员告诉我时，我的自尊心被“削弱”了..这很明显（-：

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-21T14:37:54.463

One of the most interesting things I have done with threads was write a multi-threaded application to solve a maze.

While it's nothing ground breaking, it was definitely interesting.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-21T16:38:45.373

用于网络爬虫的分布式链接检查系统。由于网络爬行是一个非常容易线程化的解决方案，我不知道这是否重要......

我在大学时确实编写了一个破解 DES 的算法，该算法在大学的一台定制的 256 CPU 机器上运行。这非常简洁，但实际上只是一个分而治之的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-21T15:45:27.327

我创建了一个 Windows 服务来查阅一堆 RSS 提要并将检索到的信息存储在数据库中。由于应用程序可以包含大量 RSS 提要，因此线程池每隔 n 次 RSS 包查询一次。

就像[Thorsten79](https://stackoverflow.com/users/19734/thorsten79)评论的那样，最令人兴奋的部分是看着你的线程作为一个团队合作并一起工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-30T10:18:46.853

This isn't an *application* of multi-threading, but a small snippet that shows off C# 3.0 features including lambdas and object initializers. Not what you had in mind, I'm sure—but the "cooleset thing [I've] done with threads" nonetheless.

```
new Thread(() => 
{
    // do stuff in a new thread's context
})
{
    Name = "Thread " + GetHashCode().ToString(),
    Priority = this.threadPriority
}
.Start(); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-22T22:48:02.623

我实现了快速排序，其中分区的左侧和右侧同时排序。它几乎是仅使用 1 个线程的相同代码的两倍。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-21T14:41:02.550

Ian P, Mind to elaborate? AFAIK you don't need to use threading to solve a maze, unless, of course the maze is so complicated that the wait time becomes so unbearable that you have to add in status bar so that the users would not get bored and thought that your program hangs.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-21T14:48:15.840

Oh -- they were not complicated mazes.

The mazes were defined in an array, similar to this:

```
String[] MazeArray = new String[5];

MazeArray[0] = "---X---X-------XF";
MazeArray[0] = "-X-X-X---XXXXXXX-";
MazeArray[0] = "-X-X-X-X-X---X---";
MazeArray[0] = "-X-X-X-XXX-X-X-X-";
MazeArray[0] = "SX---X-----X---X-"; 
```

I'd spawn a new worker thread when there is a fork in the path, and have that thread investigate that path. Then, through some basic logic, I could determine the shortest path, longest path, etc.

The example listed is obviously over simplified, but it should illustrate the point. It's a fun exercise, you should try it if you have a few minutes to spare.

Ian

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-21T15:04:47.627

Well this is really vanilla, but it's a nice stepping stone toward more creative threading:

In upload-new-data-and-process-it-for-me type requests, the request thread accepts the data and throws it in a queue, and the user goes on their merry way. One or more background threads continually dequeues items and processes them in some way.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-21T17:35:43.800

我用 Java 编写了一个使用线程池的图像过滤框架。

即使在单处理器单核机器上，过滤器在多个并行线程中运行的速度之快让我感到惊讶。当我找到一些空闲时间时，我想真正弄清楚为什么会这样；我所做的只是访问内存和数学计算。

线程摇滚（只要它们不锁定。）

也对 Java 线程池表示敬意。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-21T15:19:54.487

我用 C++ 编写了一个小的 fcgi servlet 模型，它立即为每个新请求分配一个新线程。

如果你不认为这很酷，你应该看看当我通过它抽 3K req/s 时发生了什么。我不小心忘记了清理它们，即使它们都自行终止并停止实际使用内存，它们仍然消耗*寻址*，我让应用程序快速重新分配比我拥有的更多内存并停止创建线程。

（当时我在 32 位上，它在创建 2^32 个线程后就停止了。天知道它会用 64 位做什么）

此外，我为著名的 command 创建了一个多线程（好吧，forking）广度优先 fork-on-directory 替换`rm -rf` 。主要是我对 rm -rf 似乎在等待 IO 响应 yay/nay 响应感到沮丧，这使得它在某些目录结构（例如 squid 缓存）上变慢了。这段代码唯一真正需要注意的是它只具有娱乐价值，如果曾经在整个文件系统上使用，它将是两种场景之间的竞赛：

1.  磁盘被擦除使其无法使用，并且可能会删除允许您告诉它死亡的命令。
2.  系统“Fork Bombing”由于巨大的分叉率，使其操作密集度如此之高，甚至不再*响应*命令。

在“分叉轰炸”的情况下，大量的生成率可能会导致递归 rm 自行停止（或者如果有的话，会达到 Ulimit ）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-21T15:28:40.923

具有异步输入/输出的简单客户端服务器。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-22T01:45:27.027

我为 HDOS 编写了一个多线程库。HDOS 是在 HeathKit 系统上运行的 8 位操作系统。我截获了系统时钟滴答（如果我没记错的话，每 55 毫秒）并有一个调度程序，它会以循环方式决定接下来要运行哪个线程。当然，由于操作系统本身不是多线程的，因此在任何给定时间都只允许一个线程在操作系统中。

我从来没有用它做任何有用的事情。这只是一个有趣的项目，我决定解决这个问题，看看我能不能做到。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-23T04:27:16.270

我编写了一个无锁缓存，它比最常见的基于锁的缓存库快 10 倍。弄清楚如何执行复杂的 CASing 逻辑并想出一个不会遭受锁定开销的 LRU 替代方案真的很有趣。

我还编写了一个分布式主从框架，后来我将其原型化以支持 fork-join 和 map-reduce。我需要在某个时候重做那些，因为它们不是生产质量，但这是一个非常有趣的转移。

我真的很想写一个 SkipList 数据结构，只是为了学习如何。已经有一个核心实现，但它是一个很酷很简单的想法，我很想深入研究它。这将纯粹是丢弃代码，但具有教育意义。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-21T15:58:16.017

我想为 dos 实现多线程是我用线程做的最酷的事情..

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-21T16:02:39.640

我创建了一个带有无锁任务间通信的线程库，以简化多线程编程。仅限 Delphi：[OmniThreadLibrary](http://otl.17slon.com)。

（为了给予应有的荣誉——我没有写无锁结构，GJ 写了。）

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-05-16T22:54:54.600

我在 C# 中为多线程编写了一个演员/消息传递的实现，自从我写了多线程就变得如此简单！编写它本身非常有趣，消息队列的无锁数据结构。每个actor没有一个线程，而是一个线程池，它循环通过actor并运行它们中的每一个。由于多线程现在非常容易，我可以使用这个系统，所以我写了几个很酷的东西：
一个简单的套接字服务器/客户端演示应用程序 一个
多线程网络爬虫（我将回到那个）
游戏
和其他一些东西，但它们都是小而无聊的

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-03-16T18:03:45.357

请参阅此[并行 N 拼图求解器](https://stackoverflow.com/a/1866161/120163)。它通过迭代加深搜索fork grain来解决Npuzzle问题，实现搜索。这是在我设计的一种并行编程语言中完成的，这使得分叉谷物变得*容易；*程序中几乎所有的魔法都隐藏在“fork parallel”运算符**（|| ...）** 中，您必须在代码中查找它。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2011-01-04T21:15:15.383

对不支持来自不同应用程序或线程的同时调用的（第三方应用程序）的多线程调用？尽管可以执行多个实例（这就是我最终实现它的方式），但某些应用程序操作无法在不同的应用程序实例上同时执行。

# .net - .Net 3.5 应用程序可以在安装了 .Net 2.0 运行时的机器上运行吗？

> ID：111135
> 
> 赞同：3
> 
> 时间：2008-09-21T14:37:10.203
> 
> 标签：.net

我在 VS 2008 中编写我的应用程序，因此使用了所有奇特的东西，例如 LINQ、对象初始化器等。现在我的应用程序可以在只有 .Net 2.0 运行时但没有 .Net 3.5 运行时的机器上运行吗？.Net 3.5 运行时下载量很大，你们可能都知道。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-21T14:42:31.517

例如，您可以使用*var*关键字、自动获取器和自动设置器、对象初始化器。即编译为 2.0 代码的语法糖。

您不能使用的是 .Net framework 3.0 和 3.5 库中的功能。例如 LINQ。

通过将 Visual Studio 中的目标平台设置为 .Net Framework 2.0，您可以自己尝试可以使用和不可以使用的内容。当你使用 Framework 3.0 和 3.5 中的东西时，编译器会报错。

您可以通过一个小技巧使用扩展方法：为您的项目创建此类

```
namespace System.Runtime.CompilerServices
{
    public class ExtensionAttribute : Attribute { }
} 
```

Extension Methods其实也是编译成2.0的代码，但是编译器需要定义这个类。[在这里](http://www.danielmoth.com/Blog/2007/05/using-extension-methods-in-fx-20.html)阅读

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-21T14:40:25.487

如果您不使用 .NET 3.5 库，则可以在 .NET 2.0 上运行它。请参阅[Visual Studio 多目标支持](http://weblogs.asp.net/scottgu/archive/2007/06/20/vs-2008-multi-targeting-support.aspx)您可以使用[LinqBridge](http://www.albahari.com/nutshell/linqbridge.html)在 .NET 2.0 上使用 Linq 查询

有关详细信息，请参阅Daniel Moth 在 Channel9 上的MSVS 多目标[截屏视频。](http://channel9.msdn.com/posts/DanielMoth/Multitargeting-in-Visual-Studio-2008/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T14:48:51.190

在为 Framework 3.0 和 3.5 部署应用程序时，我建议查看[Smallest DotNet](http://www.hanselman.com/smallestdotnet/ "最小的点网")以找到更小的框架版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T14:41:08.277

在大多数情况下可能不会，虽然 .Net 3.5 仍然与 .Net 2.0 CLR 一起执行，但您很可能会使用许多*新*的库和功能，例如定义您无法使用的扩展方法的代码未安装 .Net 3.5 的客户端。

您可以使用 VS2008 来定位 .Net 2.0。我认为它是解决方案元素上的一个属性。

[http://en.wikipedia.org/wiki/Microsoft_.NET#Microsoft_.NET](http://en.wikipedia.org/wiki/Microsoft_.NET#Microsoft_.NET)有很多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-21T14:42:02.953

如果你想使用它的功能，你需要安装它.Net 3.5。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T17:17:06.637

如果成本不是一个因素，您可以考虑运行时虚拟化软件，例如 VMWare ThinApp 或 Xenocode Postbuild，它们都允许运行 .NET 应用程序而无需安装 .NET 运行时。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-26T09:19:03.610

[Jean-Baptiste Evain 的这篇文章](http://evain.net/blog/articles/2008/09/14/c-3-and-linq-on-net-2)解释了如何使用 C# 3.0 和 LINQ 以及只安装 .NET 2.0 运行时的目标计算机。

这个想法是使用 System.Core [Mono](http://www.mono-project.com/)实现，它在 MIT/X11 许可下获得许可。

*注意：此答案首先提供给一个[重复的问题](https://stackoverflow.com/questions/138393/can-you-run-a-version-3-net-binary-on-a-version-2-clr-install#138426)。*

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-09-21T14:39:12.540

不，他们不能。

# .net - How does nunit work?

> ID：111140
> 
> 赞同：2
> 
> 时间：2008-09-21T14:38:23.960
> 
> 标签：.net, nunit

Can someone explain me how it works, starting from when you select to run a test

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-21T15:50:08.313

当您选择运行测试时，

*   它将创建该测试方法的父类的实例。
*   然后它继续运行标有 TestFixtureSetup 属性的方法（如果存在）（一次用于测试类）。
*   接下来是标有 Setup 属性的方法，如果存在则调用（在该类中的每个测试之前调用一次）
*   接下来执行您选择的方法（带有 Test 属性）。检查所有断言。如果所有断言都有效，则测试标记为通过（GUI 中为绿色），否则为失败（红色）。如果弹出任何未使用 ExpectedException 属性指定的异常，则测试失败。
*   如果存在，则调用标有 Teardown 属性的方法。（清理代码..在类中的每个测试后调用一次）
*   最后执行标记有 TestFixtureTeardown 属性的方法。（在测试类中的所有测试之后）

简而言之就是这样。xUnit 的强大之处在于它的简单性。那是你要找的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T15:14:17.637

我在工作中使用它，但我不是专家。这是 NUnit 文档的链接：[http ://www.nunit.org/index.php?p=getStarted&r=2.4.8](http://www.nunit.org/index.php?p=getStarted&r=2.4.8)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T15:38:52.333

1）有一个你想在.NET项目中测试的类（例如MyClass是类名，MyProject是项目名）

2) 将另一个名为 MyProject.Tests 的项目添加到您的解决方案中

3）添加从 MyProject 到 MyProject.Tests 的引用，以便您可以从测试代码中访问要测试的类

3）在这个新项目中添加一个名为MyClass的新类文件（与MyProject中的类相同）

4）在该类中，添加您的测试代码，如本页所述 - [http://www.nunit.org/index.php?p=quickStart&r=2.4.8](http://www.nunit.org/index.php?p=quickStart&r=2.4.8)

5) 编写测试后，构建解决方案。在 MyProject.Tests 项目文件夹中将出现一个新文件夹——“MyProject.Tests\bin\Debug”。这是假设您在调试模式下构建的。如果您在发布模式下构建，它将是 MyProject.Test\bin\Release。要么会工作。在此文件夹中，您会找到一个名为 MyProject.Tests.dll 的 dll 文件

6) 打开 nUnit 测试实用程序，文件 > 打开，然后导航到 #5 中的文件夹以找到 MyProject.Tests.dll。打开它。

7) 来自 dll 的测试应该列在 nUnit 实用程序窗口中，您现在可以选择要运行的测试并运行它们。

注意：命名约定不是必需的，我就是这样做的。如果您有一个名为“MyProject”的项目，并且您希望将您的测试项目称为“ArbitraryName”而不是“MyProject.Test”，那么它仍然可以工作......命名约定只是有助于跟踪到底是什么测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T14:40:38.217

What do you mean how does it work?

You define your test classes with [TestFixture] and your tests with [Test]

It's nothing more than a testing framework, you still have to write the tests and all of that jazz :)

# python - How do I handle the window close event in Tkinter?

> ID：111155
> 
> 赞同：163
> 
> 时间：2008-09-21T14:46:20.230
> 
> 标签：python, events, tkinter, window

How do I handle the window close event (user clicking the 'X' button) in a Python Tkinter program?

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2008-09-21T14:51:11.373

Tkinter supports a mechanism called [*protocol handlers*](http://web.archive.org/web/20201111215134/http://effbot.org/tkinterbook/tkinter-events-and-bindings.htm#protocols). Here, the term *protocol* refers to the interaction between the application and the window manager. The most commonly used protocol is called `WM_DELETE_WINDOW`, and is used to define what happens when the user explicitly closes a window using the window manager.

You can use the `protocol` method to *install a handler* for this protocol (the widget must be a `Tk` or `Toplevel` widget):

Here you have a concrete example:

```
import tkinter as tk
from tkinter import messagebox

root = tk.Tk()

def on_closing():
    if messagebox.askokcancel("Quit", "Do you want to quit?"):
        root.destroy()

root.protocol("WM_DELETE_WINDOW", on_closing)
root.mainloop() 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-02-11T19:46:39.517

Matt 展示了对关闭按钮的一种经典修改。
另一种是让关闭按钮最小化窗口。[*您可以通过将iconify*](https://wiki.tcl-lang.org/page/wm+iconify)方法 作为[*协议*](https://www.tcl.tk/man/tcl8.4/TkCmd/wm.htm#M39)方法的第二个参数
来重现此行为。[](https://wiki.tcl-lang.org/page/wm+iconify) *[](https://www.tcl.tk/man/tcl8.4/TkCmd/wm.htm#M39)*

 **这是一个工作示例，在 Windows 7 和 10 上进行了测试：

```
# Python 3
import tkinter
import tkinter.scrolledtext as scrolledtext

root = tkinter.Tk()
# make the top right close button minimize (iconify) the main window
root.protocol("WM_DELETE_WINDOW", root.iconify)
# make Esc exit the program
root.bind('<Escape>', lambda e: root.destroy())

# create a menu bar with an Exit command
menubar = tkinter.Menu(root)
filemenu = tkinter.Menu(menubar, tearoff=0)
filemenu.add_command(label="Exit", command=root.destroy)
menubar.add_cascade(label="File", menu=filemenu)
root.config(menu=menubar)

# create a Text widget with a Scrollbar attached
txt = scrolledtext.ScrolledText(root, undo=True)
txt['font'] = ('consolas', '12')
txt.pack(expand=True, fill='both')

root.mainloop() 
```

在本例中，我们为用户提供了两个新的退出选项：
经典的文件 → 退出，以及`Esc`按钮。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2018-04-12T17:50:02.133

取决于 Tkinter 活动，特别是在使用 Tkinter.after 时，停止这个活动`destroy()`——即使使用协议（）、按钮等——会干扰这个活动（“执行时”错误），而不是仅仅终止它. 几乎在所有情况下，最好的解决方案是使用标志。这是一个如何使用它的简单而愚蠢的示例（尽管我确信你们中的大多数人都不需要它！:)

```
from Tkinter import *

def close_window():
  global running
  running = False  # turn off while loop
  print( "Window closed")

root = Tk()
root.protocol("WM_DELETE_WINDOW", close_window)
cv = Canvas(root, width=200, height=200)
cv.pack()

running = True;
# This is an endless loop stopped only by setting 'running' to 'False'
while running: 
  for i in range(200): 
    if not running: 
        break
    cv.create_oval(i, i, i+1, i+1)
    root.update() 
```

这很好地终止了图形活动。您只需要`running`在正确的地方进行检查。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-12-06T19:03:43.497

如果您想更改 x 按钮的功能或使其无法关闭，请尝试此操作。

```
yourwindow.protocol("WM_DELETE_WINDOW", whatever) 
```

然后无视“随便”是什么意思

```
def whatever():
    # Replace this with your own event for example:
    print("oi don't press that button") 
```

您也可以这样做，以便在关闭该窗口时可以像这样将其回调

```
yourwindow.withdraw() 
```

这会隐藏窗口但不会关闭它

```
yourwindow.deiconify() 
```

这使窗口再次可见

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-10-20T00:10:36.167

*我要感谢 Apostolos 的回答让我注意到了这一点。这是 2019 年 Python 3 的更详细示例，具有更清晰的描述和示例代码。*

* * *

## 请注意`destroy()`（或根本没有自定义窗口关闭处理程序）会在用户关闭窗口时立即销毁窗口*及其所有正在运行的回调。*

这可能对您不利，具体取决于您当前的 Tkinter 活动，尤其是在使用`tkinter.after`（定期回调）时。您可能正在使用处理一些数据并写入磁盘的回调......在这种情况下，您显然希望数据写入完成而不会被突然杀死。

最好的解决方案是使用标志。因此，当用户请求关闭窗口时，您将其标记为标志，然后对其做出反应。

*（注意：我通常将 GUI 设计为封装良好的类和单独的工作线程，并且我绝对不使用“全局”（我使用类实例变量代替），但这是一个简单的、精简的示例来演示当用户关闭窗口时，Tk 如何突然终止您的定期回调......）*

```
from tkinter import *
import time

# Try setting this to False and look at the printed numbers (1 to 10)
# during the work-loop, if you close the window while the periodic_call
# worker is busy working (printing). It will abruptly end the numbers,
# and kill the periodic callback! That's why you should design most
# applications with a safe closing callback as described in this demo.
safe_closing = True

# ---------

busy_processing = False
close_requested = False

def close_window():
    global close_requested
    close_requested = True
    print("User requested close at:", time.time(), "Was busy processing:", busy_processing)

root = Tk()
if safe_closing:
    root.protocol("WM_DELETE_WINDOW", close_window)
lbl = Label(root)
lbl.pack()

def periodic_call():
    global busy_processing

    if not close_requested:
        busy_processing = True
        for i in range(10):
            print((i+1), "of 10")
            time.sleep(0.2)
            lbl["text"] = str(time.time()) # Will error if force-closed.
            root.update() # Force redrawing since we change label multiple times in a row.
        busy_processing = False
        root.after(500, periodic_call)
    else:
        print("Destroying GUI at:", time.time())
        try: # "destroy()" can throw, so you should wrap it like this.
            root.destroy()
        except:
            # NOTE: In most code, you'll wanna force a close here via
            # "exit" if the window failed to destroy. Just ensure that
            # you have no code after your `mainloop()` call (at the
            # bottom of this file), since the exit call will cause the
            # process to terminate immediately without running any more
            # code. Of course, you should NEVER have code after your
            # `mainloop()` call in well-designed code anyway...
            # exit(0)
            pass

root.after_idle(periodic_call)
root.mainloop() 
```

此代码将向您展示`WM_DELETE_WINDOW`处理程序即使在我们的自定义`periodic_call()`在工作/循环中间忙碌时也会运行！

我们使用了一些相当夸张`.after()`的值：500 毫秒。这只是为了让您很容易看到在定期通话忙时关闭与否之间的区别......如果您在号码更新时关闭，您将看到*在*您的定期通话期间发生的`WM_DELETE_WINDOW`事情“是忙处理：真”。如果您在数字暂停时关闭（意味着此时未处理定期回调），您会看到关闭发生在“不忙”时。

 *在实际使用中，您`.after()`将使用 30-100 毫秒之类的时间来获得响应式 GUI。这只是一个演示，帮助您了解如何保护自己免受 Tk 默认的“关闭时立即中断所有工作”行为的影响。

总结：让`WM_DELETE_WINDOW`处理程序设置一个标志，然后定期检查该标志，并`.destroy()`在安全时手动检查窗口（当您的应用程序完成所有工作时）。

PS：您也可以使用`WM_DELETE_WINDOW`询问用户是否真的要关闭窗口*；*如果他们回答“否”，您就不会设置标志。这很简单。您只需在您的消息框中显示一个消息框`WM_DELETE_WINDOW`并根据用户的回答设置标志。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-09-02T12:19:08.123

最简单的代码是：

```
from tkinter import *
window = Tk() 
```

隐藏窗口：`window.withdraw()`

出现窗口：`window.deiconify()`

从窗口退出：`exit()`

从窗口退出（如果您已制作 .exe 文件）：

```
from tkinter import *
import sys
window = Tk()
sys.exit() 
```

当然，您必须放置一个按钮并在函数中使用上面的代码，以便您可以在按钮的命令部分键入函数的名称

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-01-14T03:38:07.923

您应该使用 destroy() 关闭 tkinter 窗口。

```
 from Tkinter import *
   root = Tk()
   Button(root, text="Quit", command=root.destroy).pack()
   root.mainloop() 
```

解释：

`root.quit()` 上面这行只是绕过了`root.mainloop()`ie ，如果执行了命令，ie`root.mainloop()`仍然会在后台运行。`quit()`

`root.destroy()` 虽然`destroy()`命令消失，`root.mainloop()`即`root.mainloop()`停止。

因此，当您只想退出程序时，您应该使用`root.destroy()`它来停止 mainloop()`。

但是如果你想运行一些无限循环并且你不想破坏你的 Tk 窗口并且想在`root.mainloop()`一行之后执行一些代码，那么你应该使用`root.quit()`. 前任：

```
from Tkinter import *
def quit():
    global root
    root.quit()

root = Tk()
while True:
    Button(root, text="Quit", command=quit).pack()
    root.mainloop()
    #do something 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-06-24T04:59:16.400

尝试简单版本：

```
import tkinter

window = Tk()

closebutton = Button(window, text='X', command=window.destroy)
closebutton.pack()

window.mainloop() 
```

或者，如果您想添加更多命令：

```
import tkinter

window = Tk()

def close():
    window.destroy()
    #More Functions

closebutton = Button(window, text='X', command=close)
closebutton.pack()

window.mainloop() 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-11-18T10:05:46.680

我说更简单的方法是使用`break`命令，比如

```
import tkinter as tk
win=tk.Tk
def exit():
    break
btn= tk.Button(win, text="press to exit", command=exit)
win.mainloop() 
```

或使用`sys.exit()`

```
import tkinter as tk
import sys
win=tk.Tk
def exit():
    sys.exit
btn= tk.Button(win, text="press to exit", command=exit)
win.mainloop() 
```

# sql-server - 是否有工具可以监控 .EXE 正在执行的 SQL 语句？

> ID：111181
> 
> 赞同：5
> 
> 时间：2008-09-21T15:03:18.643
> 
> 标签：sql-server, sql-server-2005, vb6, monitoring

我希望能够连接到第 3 方应用程序以查看正在执行的 SQL 语句。具体来说，它是一个运行在 SQL Server 2005 上的 VB6 应用程序。

例如，当应用程序填写一个网格时，我希望能够准确地看到是什么查询产生了该数据。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-21T15:05:28.407

如果您对数据库具有适当的权限（系统管理员或 ALTER TRACE 权限），则可以使用 SQL Profiler 进行观察。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T15:07:19.507

如果应用程序不写入日志或其他内容，则查看它们的唯一方法是在数据库端。SQL Profiler 是在 MSSQL 2005 上执行任务的合适工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T15:07:41.147

您可以通过使用工具中包含的 SQL Server Profiler 连接到 SQL Server 来查看它的服务器端。 [这是微软对它的使用情况](http://msdn.microsoft.com/en-us/library/ms187929.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T15:44:57.717

正如其他答案所示，在服务器上查看它很可能是最好的方法。但是，如果这不可用，您也可以打开[ODBC 日志记录](http://technet.microsoft.com/en-us/library/ms403323(SQL.90).aspx)，这可能会有所帮助。

# c# - 如何确定何时没有更多数据可在 NetworkStream 中读取？

> ID：111194
> 
> 赞同：3
> 
> 时间：2008-09-21T15:10:21.140
> 
> 标签：c#, networkstream

我有一个 Web 应用程序，它使用 TCP 连接连接到服务器并读取二进制文档，然后将其写入其响应对象。换句话说，它使用自定义协议从后端服务器传输文件，并通过 HTTP 将该文件返回给客户端。

服务器发送一个状态码和一个 mime 类型，我读取成功，然后写入文件的内容并关闭套接字。这似乎工作正常。

客户端（C# Web 应用程序）读取数据：

```
 private NetworkStream stream_;

     public void WriteDocument(HttpResponse response)
     {
        while (stream_.DataAvailable)
        {
           const int bufsize = 4 * 1024;
           byte[] buffer = new byte[bufsize];
           int nbytes = stream_.Read(buffer, 0, bufsize);
           if (nbytes > 0)
           {
              if (nbytes < bufsize)
                 Array.Resize<byte>(ref buffer, nbytes);
              response.BinaryWrite(buffer);
           }
        }
        response.End();
     } 
```

这似乎总是在所有数据到达之前退出读取循环。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-21T15:24:12.290

我会`OutputStream`直接使用通用功能。有了`Stream`，就可以控制了`Flush`。

```
 public void WriteDocument(HttpResponse response) {
        StreamCopy(response.OutputStream, stream_);
        response.End();
    }

    public static void StreamCopy(Stream dest, Stream src) {
        byte[] buffer = new byte[4 * 1024];
        int n = 1;
        while (n > 0) {
            n = src.Read(buffer, 0, buffer.Length);
            dest.Write(buffer, 0, n);
        }
        dest.Flush();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T15:20:07.963

这就是我所做的。通常希望内容长度知道何时结束数据存储循环。如果您的协议没有发送预期作为标头的数据量，那么它应该发送一些标记来表示传输结束。

DataAvailable 属性只是表示现在是否有数据要从套接字读取，它不（也不能）知道是否还有更多数据要发送。要检查套接字是否仍然打开，您可以测试 stream_.Socket.Connected && stream_.Socket.Readable

```
 public static byte[] doFetchBinaryUrl(string url)
    {
        BinaryReader rdr;
        HttpWebResponse res;
        try
        {
            res = fetch(url);
            rdr = new BinaryReader(res.GetResponseStream());
        }
        catch (NullReferenceException nre)
        {
            return new byte[] { };
        }
        int len = int.Parse(res.GetResponseHeader("Content-Length"));
        byte[] rv = new byte[len];
        for (int i = 0; i < len - 1; i++)
        {
            rv[i] = rdr.ReadByte();
        }
        res.Close();
        return rv;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T16:15:18.190

不确定.Net 中的工作方式，但在我工作过的大多数环境中，Read() 连接关闭时返回 0 字节。所以你会做这样的事情：

```
字符缓冲区[4096]；
整数读；

而 ( num_read = src.Read(sizeof(buffer)) > 0 )
{
   dst.Write(buffer, num_read);
}

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T11:21:31.197

你的问题的根源是这一行：

```
while (stream_.DataAvailable) 
```

DataAvailable 仅表示流缓冲区中有数据可供读取和处理。它不能保证已经到达流的“结束”。特别是，如果传输中有任何暂停，或者如果您的发件人比您的阅读器慢，则 DataAvailable 可能是错误的。

# .net - 使用 Silverlight 的本地数据库

> ID：111196
> 
> 赞同：8
> 
> 时间：2008-09-21T15:12:59.260
> 
> 标签：.net, silverlight

对于 Silverlight 应用程序来说，什么是好的本地数据库？数据库的主要用途是为本地数据缓存和同步服务。我不相信 SQL Anywhere 或 SQLite 会起作用，因为它们使用不会在 silverlight 沙箱下运行的非托管代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-26T04:47:32.233

为什么不使用 SL 2 中称为“隔离存储”的新功能？它完全支持本地数据库（如 Google Gear），但当然它不是数据库。您可以使用 XML 文件格式来保存它。

*   优点；用户只需要安装 SL 运行时。
*   缺点；它不完全是一个数据库

### 找到两个参考：

Moth 在他的博客中说[http://www.danielmoth.com/Blog/2008/04/isolatedstorage-in-siverlight-2-beta-1.html Dino 在](http://www.danielmoth.com/Blog/2008/04/isolatedstorage-in-siverlight-2-beta-1.html)[http://www.ddj](http://www.ddj.com/windows/208300036?pgno=2) 做了很好的总结。 [com/windows/208300036?pgno=2](http://www.ddj.com/windows/208300036?pgno=2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T15:19:05.673

@亚伦菲舍尔，

我对这个问题也很感兴趣。我正在寻找 XBAP（浏览器中的 WPF）应用程序的数据库。这是我的问题[“您可以推荐哪些具有独立存储支持的嵌入式数据库？”](https://stackoverflow.com/questions/108399/what-embedded-database-with-isolated-storage-support-can-you-recommend)

SQLite 和 MSSQL CE（又名 SQL Anywhere）不起作用。

VistaDB 是在 .NET 中实现的，可以在约束下工作（它支持独立存储），但我正在寻找替代方案。

另一种选择是 Sybase iAnywhere - 但我不确定如何在最终用户机器上部署它。

我将尝试用于 Silverlight 的 DB4objects。如果可行，我会更新帖子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-01T12:58:36.987

答案是siaqodb。**Siaqodb**是真正的 Silverlight 客户端对象数据库，您只需一行代码即可存储对象并通过 LINQ 检索对象。有关更多信息，请查看[http://siaqodb.com](http://siaqodb.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T17:25:54.417

根据这个[例子](http://www.nerddawg.members.winisp.net/SilverGears/)，看起来可以使用 Google Gears 和 Sqlite。主要的缺点是集成工作量大，并且需要在客户的计算机上再安装一个平台。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T03:42:11.573

我很想看到两件事。1.) 某种持久的本地数据库支持或 2.) 某种实际的数据库服务器支持，没有 Web 服务的麻烦。

就个人而言，我会选择 Access 和 OleDb。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T03:43:13.457

最后一件事……数据库类型的功能是 Flash/Flex 不提供的……这将是 Microsoft 区分 Silverlight 并真正帮助它的好方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T18:38:22.550

如果您的缓存需求足够基本，并且您没有太多的数据来减少 RAM 的使用，那么您甚至不需要一个成熟的数据库。您可以使用诸如字典之类的结构创建各种对象数据库，并将原本会成为表行的对象放入其中。然后，您可以将此数据序列化为本地存储中的文件，并在应用程序下次运行时对其进行反序列化。如果你的数据结构做得很好，你甚至可以使用 Linq 来查询你的对象数据库。

如果您的主要目标是尽量减少必须从服务器提取相同数据的次数，那么这可能是需要考虑的问题。

另一方面，如果您有太多数据或频繁写入数据库（因为它必须每次都将整个结构序列化到磁盘），这不是要走的路。

如果您确实有太多数据但仍想尝试此操作，您可以查看是否有一种合乎逻辑的方法将您的数据划分为多个不太可能同时需要的文件。然后，您可以将未使用的数据推送到磁盘，并在程序下次需要时将其加载回来。当然，如果你把这种方法走得太远，无论如何你最终都会编写自己的数据库系统。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-01T22:31:44.540

现在有一个到 c# 的 sqlite 端口，称为[csharp-sqlite](http://code.google.com/p/csharp-sqlite/) ，一旦他们找到一个可接受的名称，它就会有承诺。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2010-10-14T21:38:33.220

是的，我认为 LINQ 提供程序是最佳解决方案。由于存储空间有限，您实际上并不*需要*表和索引，如果有一种简单的方法可以方便地通过 LINQ 在客户端存储和查询对象，而无需处理低级文件流。

# c# - 如何在 C# 中制作 Enso 风格的应用程序

> ID：111203
> 
> 赞同：0
> 
> 时间：2008-09-21T15:18:33.507
> 
> 标签：c#, winforms, windows-xp

背景应该是透明的，但文本不应该。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-21T15:30:55.537

通过制作“Enso 风格”应用程序，您是指 Enso 启动器吗？

这是它的截图： [alt text http://enscreenshots.softonic.com/s2en/68000/68880/3_ensolauncher03.jpg](http://enscreenshots.softonic.com/s2en/68000/68880/3_ensolauncher03.jpg)

我建议查看开源 C# [Cropper](http://www.codeplex.com/cropper)应用程序。他做了一个类似的带有透明背景的 GUI。你可以打开他的项目，看看他是如何实现的。

[替代文字 http://img352.imageshack.us/img352/726/cropperuijt3.png](http://img352.imageshack.us/img352/726/cropperuijt3.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T15:15:07.983

您可以将背景颜色和透明度键属性设置为相同的颜色，这将使背景透明。其余的控制项将保持不透明，只要它们是不同的颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T00:48:39.553

Enso 也是开源的。

您可以直接查看它们的源代码。

[http://code.google.com/p/enso/](http://code.google.com/p/enso/)

当您发现时，让我们知道他们是如何做到的！

**更新**

看起来他们使用了一种叫做开罗的东西。如果你可以从 C# 链接它，你就完成了。

# python - 什么是“可调用”？

> ID：111234
> 
> 赞同：345
> 
> 时间：2008-09-21T15:34:32.720
> 
> 标签：python, callable

现在很清楚[什么是元类](https://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python)，有一个相关的概念，我一直在使用，但不知道它的真正含义。

我想每个人都犯了一次括号错误，导致“对象不可调用”异常。更何况，使用`__init__`并`__new__`导致想知道这该死的东西`__call__`可以用来做什么。

你能给我一些解释，包括魔术方法的例子吗？

* * *

## 回答 #1

> 赞同：340
> 
> 时间：2008-09-21T15:44:22.697

可调用对象是可以调用的任何东西。

[内置的*可调用*](http://svn.python.org/projects/python/trunk/Objects/object.c)对象（objects.c 中的[PyCallable_Check）](http://svn.python.org/projects/python/trunk/Objects/object.c)检查参数是否为：

*   具有`__call__`方法的类的实例或
*   是具有非空*tp_call* (c struct) 成员的类型，该成员指示可调用性（例如在函数、方法等中）

命名的方法`__call__`是（[根据文档](https://docs.python.org/3/reference/datamodel.html#object.__call__)）

> 当实例作为函数被“调用”时调用

## 例子

```
class Foo:
  def __call__(self):
    print 'called'

foo_instance = Foo()
foo_instance() #this is calling the __call__ method 
```

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2008-09-22T15:04:53.733

从 Python 的来源[object.c](http://svn.python.org/view/python/trunk/Objects/object.c?rev=64962&view=markup)：

```
/* Test whether an object can be called */

int
PyCallable_Check(PyObject *x)
{
    if (x == NULL)
        return 0;
    if (PyInstance_Check(x)) {
        PyObject *call = PyObject_GetAttrString(x, "__call__");
        if (call == NULL) {
            PyErr_Clear();
            return 0;
        }
        /* Could test recursively but don't, for fear of endless
           recursion if some joker sets self.__call__ = self */
        Py_DECREF(call);
        return 1;
    }
    else {
        return x->ob_type->tp_call != NULL;
    }
} 
```

它说：

1.  如果一个对象是某个类的实例，那么它是可调用的，*只要*它具有`__call__`属性。
2.  否则对象`x`是可调用*的* `x->ob_type->tp_call != NULL`

[`tp_call`领域](http://docs.python.org/api/type-structs.html)描述：

> `ternaryfunc tp_call`指向实现调用对象的函数的可选指针。如果对象不可调用，这应该为 NULL。签名与 PyObject_Call() 的签名相同。该字段由子类型继承。

您始终可以使用内置`callable`函数来确定给定对象是否可调用；或者更好的是只是调用它并稍后再捕获`TypeError`。`callable`在 Python 3.0 和 3.1 中被删除，使用`callable = lambda o: hasattr(o, '__call__')`or `isinstance(o, collections.Callable)`。

例如，一个简单的缓存实现：

```
class Cached:
    def __init__(self, function):
        self.function = function
        self.cache = {}

    def __call__(self, *args):
        try: return self.cache[args]
        except KeyError:
            ret = self.cache[args] = self.function(*args)
            return ret 
```

用法：

```
@Cached
def ack(x, y):
    return ack(x-1, ack(x, y-1)) if x*y else (x + y + 1) 
```

标准库、文件、[`site.py`](http://svn.python.org/projects/python/trunk/Lib/site.py)内置函数定义的示例：`exit()``quit()`

```
class Quitter(object):
    def __init__(self, name):
        self.name = name
    def __repr__(self):
        return 'Use %s() or %s to exit' % (self.name, eof)
    def __call__(self, code=None):
        # Shells like IDLE catch the SystemExit, but listen when their
        # stdin wrapper is closed.
        try:
            sys.stdin.close()
        except:
            pass
        raise SystemExit(code)
__builtin__.quit = Quitter('quit')
__builtin__.exit = Quitter('exit') 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2008-09-26T13:22:20.393

可调用对象是一个允许您使用圆括号 ( ) 并最终传递一些参数的对象，就像函数一样。

每次定义函数时，python 都会创建一个可调用对象。例如，您可以通过以下方式定义函数**func**（相同）：

```
class a(object):
    def __call__(self, *args):
        print 'Hello'

func = a()

# or ... 
def func(*args):
    print 'Hello' 
```

您可以使用此方法代替**doit**或**run**之类的方法，我认为 obj() 比 obj.doit() 更清楚

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2013-03-22T23:38:33.647

让我倒过来解释一下：

考虑这个...

```
foo() 
```

...作为语法糖：

```
foo.__call__() 
```

哪里`foo`可以是任何响应的对象`__call__`。当我说任何对象时，我的意思是：内置类型、您自己的类及其实例。

对于内置类型，当您编写时：

```
int('10')
unicode(10) 
```

你本质上是在做：

```
int.__call__('10')
unicode.__call__(10) 
```

这也是您在 Python 中没有的原因`foo = new int`：您只需让类对象在`__call__`. 在我看来，Python 解决这个问题的方式非常优雅。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-21T15:43:15.880

Callable 是具有该`__call__`方法的对象。这意味着您可以伪造可调用函数或做一些简洁的事情，例如[Partial Function Application](http://www.python.org/dev/peps/pep-0309/) ，您可以在其中获取一个函数并添加一些增强它的东西或填充一些参数，返回一些可以依次调用的东西（在函数式编程界称为[Currying](http://en.wikipedia.org/wiki/Currying)）。

某些印刷错误会使解释器尝试调用您不打算调用的内容，例如（例如）字符串。这可能会在解释器尝试执行不可调用的应用程序时产生错误。您可以通过执行类似于下面的脚本的操作在 python 解释器中看到这种情况。

```
[nigel@k9 ~]$ python
Python 2.5 (r25:51908, Nov  6 2007, 15:55:44) 
[GCC 4.1.2 20070925 (Red Hat 4.1.2-27)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 'aaa'()    # <== Here we attempt to call a string.
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'str' object is not callable
>>> 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-09-21T15:49:28.953

`__call__`使任何对象都可以作为函数调用。

此示例将输出 8：

```
class Adder(object):
  def __init__(self, val):
    self.val = val

  def __call__(self, val):
    return self.val + val

func = Adder(5)
print func(3) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-21T15:43:20.840

很简单，“可调用”是可以像方法一样调用的东西。内置函数“callable()”将告诉您某些东西是否可以调用，以及检查**调用**属性。函数是可调用的，类也是可调用的，类实例也是可调用的。[在此处](http://docs.python.org/lib/built-in-funcs.html)和[此处](http://www.peterbe.com/plog/callable-python-objects)查看更多信息。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-21T16:37:09.307

在 Python 中，可调用对象是类型具有`__call__`方法的对象：

```
>>> class Foo:
...  pass
... 
>>> class Bar(object):
...  pass
... 
>>> type(Foo).__call__(Foo)
<__main__.Foo instance at 0x711440>
>>> type(Bar).__call__(Bar)
<__main__.Bar object at 0x712110>
>>> def foo(bar):
...  return bar
... 
>>> type(foo).__call__(foo, 42)
42 
```

就如此容易 ：）

这当然可以重载：

```
>>> class Foo(object):
...  def __call__(self):
...   return 42
... 
>>> f = Foo()
>>> f()
42 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-21T15:43:44.960

这是你可以在后面加上“（args）”并期望它起作用的东西。可调用对象通常是方法或类。方法被调用，类被实例化。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-09-20T10:03:37.330

检查类的函数或方法是否可调用，这意味着我们可以调用该函数。

```
Class A:
    def __init__(self,val):
        self.val = val
    def bar(self):
        print "bar"

obj = A()      
callable(obj.bar)
True
callable(obj.__init___)
False
def foo(): return "s"
callable(foo)
True
callable(foo())
False 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-05-07T21:40:12.383

可调用对象实现了`__call__`特殊方法，因此任何具有这种方法的对象都是可调用的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-07T07:10:48.257

Callable 是带有方法 **调用的“内置函数或方法”的类型或类**

```
>>> type(callable)
<class 'builtin_function_or_method'>
>>> 
```

示例： **print**是一个可调用对象。使用内置函数****调用**** 当您调用**print**函数时，Python 会创建一个**print 类型的对象**并调用其方法****调用****并传递参数（如果有）。

```
>>> type(print)
<class 'builtin_function_or_method'>
>>> print.__call__(10)
10
>>> print(10)
10
>>> 
```

# security - 如何保持计算机（尤其是软件）安全性的最新状态？

> ID：111248
> 
> 赞同：8
> 
> 时间：2008-09-21T15:42:52.777
> 
> 标签：security

我最近购买并阅读了一套关于安全的书籍（[构建安全软件：如何以正确的方式避免安全问题](https://rads.stackoverflow.com/amzn/click/com/020172152X)、[利用软件：如何破解代码](https://rads.stackoverflow.com/amzn/click/com/0201786958)和[软件安全：构建安全](https://rads.stackoverflow.com/amzn/click/com/0321356705)性）。尽管我认为这些书的内容在未来几年内会很有用，但作者确实承认计算机和软件安全领域的变化非常迅速。有哪些方法可以让我了解这些领域的最新动态？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-21T15:52:12.397

我在我的 RSS 阅读器中关注[Schneier 的安全性。](http://www.schneier.com/blog/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T16:08:09.800

在 twit 上收听 security now 播客。之后，根据您使用的操作系统，您应该订阅他们的安全邮件列表或 rss 提要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-21T16:09:56.223

*Register*的**[安全](http://www.theregister.co.uk/security/)**部分。RSS 可用。（我是 El Reg 的忠实粉丝。）

此外，对于编码人员来说，它可能有点轻量级，但**[现在安全！](http://www.grc.com/securitynow.htm)**Steve Gibson 和 Leo Laporte 的播客很不错。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-21T16:11:10.510

如果您负担得起（或说服您的雇主支付），请每年至少参加一次会议。作为最后的手段，总是有 Defcon，它在周末举行，只需 100 美元。它不像黑帽那样专业，但总比没有好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-21T16:21:39.470

[RISKS](http://catless.ncl.ac.uk/Risks/)不是特定于安全的，但其中讨论了一些有趣的安全相关主题。

[BUGTRAQ](http://www.securityfocus.com/archive/1)是一个全面披露的安全邮件列表，值得略读。（每次在大多数 Linux 发行版附带的软件中披露漏洞时，都会有来自所有各种发行版的大量披露。这会对信噪比产生负面影响，除非您使用其中之一分布。）

一些可能有趣的与安全相关的博客（除了已经链接的 Schneier on Security）：[……And You Will Know me by the Trail of Bits](http://blog.trailofbits.com/) , [DoxPara Research (Dan Kaminsky)](http://www.doxpara.com/) , [Matasano Chargen](http://www.matasano.com/log/) , Microsoft's [Security Development Lifecycle](http://blogs.msdn.com/sdl/default.aspx) , ZDNet 的[“零日”](http://blogs.zdnet.com/security/)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-21T18:45:09.250

OWASP ( [http://www.owasp.org](http://www.owasp.org) ) 提供了一个非常好的 RSS 提要，大部分来自许多不同的来源。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T09:23:54.403

哦，别忘了[CCC](http://en.wikipedia.org/wiki/Chaos_Computer_Club)举办的非常有趣的黑客会议。会议的名称有固定的模式。最后一个是 24c3，下一个是 25c3。它们在德国柏林举行，是这个星球上黑客和安全文化最大的汇聚点之一。

您可以在[Chaos Radio](http://chaosradio.ccc.de)找到上次会议的视频和 mp3 记录。

以防万一你不能去旅行，会谈通常通过现场直播。录音在事件发生几周后发布。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-03T19:00:00.990

为了网络安全，我订阅了以下订阅源：有些会定期更新，有些则不会。
[DanchoDanchevOnSecurity](http://feeds.feedburner.com/DanchoDanchevOnSecurityAndNewMedia)
[Internet Storm Center](http://isc.sans.org/rssfeed_full.xml)
[The Register（企业安全）](http://www.theregister.co.uk/security/enterprise/headlines.atom)
[US-CERT Cyber​​ Security Bulletins](http://www.us-cert.gov/channels/bulletins.rdf)
[Zero Day](http://feeds.feedburner.com/zdnet/security)
[ha.ckers.org](http://ha.ckers.org/blog/feed/)
和我的最新添加之一 [Stack Overflow：已标记安全](https://stackoverflow.com/feeds/tag/security)

或者您可以将所有内容添加到您的 iGoogle 希望页面： [我的 iGoogle 安全页面](http://www.google.com/ig/sharetab?source=stb&atr=Web+Security&lt=4&n_25=url%3Dhttp://feeds.feedburner.com/DanchoDanchevOnSecurityAndNewMedia%26sect%3D3%26row%3D0&n_25=url%3Dhttp://www.us-cert.gov/channels/bulletins.rdf%26sect%3D3%26row%3D2&n_25=url%3Dhttp://www.us-cert.gov/current/index.rdf%26sect%3D2%26row%3D1&n_25=url%3Dhttp://feeds.feedburner.com/zdnet/security%26sect%3D2%26row%3D2&n_25=url%3Dhttp://isc.sans.org/newssummary.xml%26sect%3D3%26row%3D1&n_25=url%3Dhttp://ha.ckers.org/blog/feed/%26sect%3D2%26row%3D0&n_25=url%3Dhttps://stackoverflow.com/feeds/tag/security%26sect%3D1%26row%3D0&n_25=url%3Dhttp://sla.ckers.org/forum/rss.php%26sect%3D1%26row%3D1&n_25=url%3Dhttp://www.theregister.co.uk/security/enterprise/headlines.atom%26sect%3D2%26row%3D3)

如果您更以应用程序为中心，我敢肯定会有更多有趣的提要。

无论如何，提要或访问网站是真正完全掌握事情的唯一方法。会议很棒，而且很有趣，但是一个小时后你会通过网络获得相同的信息；通常还有一个额外的好处是有几个观点来帮助你理解主题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T09:05:54.757

**[立即安全！](http://www.twit.tv/sn)**还不错（我每周都听）。
它通常包含对底层技术的很好解释（例如，路由器如何知道将 IP 数据包发送到哪里？），尽管我确实认为它确实有点。

如果您想要更硬核的播客，请尝试**[Paul "dot com" 的安全周刊](http://www.countswebdesign.com/pauldotcom/)**。
它确实是为渗透测试人员准备的，但我不禁想到，如果渗透测试人员知道它，那么我也应该知道。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T09:20:25.143

然后是 ACM 的[SIGSAC](http://www.sigsac.org/)和 ACM 的[信息和系统安全事务](http://tissec.acm.org/)。成为[ACM](http://www.acm.org)的成员通常是由 Practical Programmer 的作者推荐的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-04T17:25:23.723

我喜欢的一个博客（除了 Schneier on Security）是[Light Blue Touchpaper——](http://www.lightbluetouchpaper.org/)剑桥大学计算机安全研究部门的集体博客（由出色的[Ross Anderson](http://www.cl.cam.ac.uk/~rja14/)领导。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-02T03:57:19.323

IEEE 有“[安全和隐私](http://www.computer.org/security)”杂志——它非常好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-03T15:03:26.967

我使用了上面提到的许多其他提及（如提到的 Schneier），但是我发现 Slashdot 老实说给了我关于新攻击向量的最佳“提醒”。它并不总是及时的，而且大多只是一个总体概述，但它擅长发布我从未想过的矢量。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-04T10:33:37.567

考虑参加当地的 OWASP 分会会议。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-04T10:49:32.880

对于软件安全，尤其是 Web 应用程序安全，[OWASP Moderated AppSec News](http://www.owasp.org/index.php/Feed) 是一个很棒的 RSS 提要。良好的信噪比。保持最新就足够了。

# .net - 我在哪里可以找到为温莎城堡提供智能感知的 .xsd 文件？

> ID：111263
> 
> 赞同：10
> 
> 时间：2008-09-21T15:47:46.383
> 
> 标签：.net, visual-studio, inversion-of-control, castle-windsor

我正在寻找一个 .xsd 架构文件以放入我的 Visual Studio 目录中，以便为 Castle Windsor IoC 容器的 xml 配置文件提供智能感知。我查看了下载的 Windsor 代码，并搜索了几种不同的方法。我看到很多人问同样的问题，但没有答案。谁知道有没有这样的文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:43:37.743

我在[这里](http://code.google.com/p/castlewindsorschema/)重新托管了谷歌代码上的项目分发器模式 zip 。zip 包含架构、示例用法和安装它的自述文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T17:15:57.063

也许这就是您正在寻找的：

[http://jimblogdog.blogspot.com/2008/05/castlewindsor-schema-enables-visual.html](http://jimblogdog.blogspot.com/2008/05/castlewindsor-schema-enables-visual.html)

这是下载城堡温莎架构的链接：

[http://www.projectdistributor.net/Releases/Release.aspx?releaseId=427](http://www.projectdistributor.net/Releases/Release.aspx?releaseId=427)

祝你好运！

# linux - VMware server 1.0.7 模块与内核 2.6.26 不兼容 -- 已修补，在哪里提交？

> ID：111281
> 
> 赞同：0
> 
> 时间：2008-09-21T15:56:00.577
> 
> 标签：linux, vmware, kernel, debian

*   安装了 vmware-package 的 VMware server 1.0.7
*   Debian GNU/Linux 测试 (lenny)
*   内核 2.6.26-1-686

尝试从 VMware 服务器 tarball 中的 vmware-package 制作的 vmware-server-kernel-source 软件包构建二进制内​​核模块时，出现了几个编译问题。最近 VMware 更新了他们的内核模块源，以使它们与内核 2.6.25 兼容，但他们再次与 2.6.26 中断。

```
vmmon-only/linux/driver.c:146: error: unknown field 'nopage' specified in initializer
vmmon-only/linux/driver.c:147: warning: initialization from incompatible pointer type
vmmon-only/linux/driver.c:150: error: unknown field 'nopage' specified in initializer
vmmon-only/linux/driver.c:151: warning: initialization from incompatible pointer type 
```

这只是第一个错误，但还有其他编译问题（仅在 vmnet 中）。

论坛上的许多建议是改用 vmware-any-any，但这有其自身的问题（请参阅[我的其他问题](https://stackoverflow.com/questions/109877/unknown-ioctl-2062-2065-2066-from-vmmon-when-starting-a-vm-vmware-server-107-fo)）。

正如您在下面我自己的回答中看到的那样，我已经通过修复不兼容性解决了这个问题，并提出了一个[补丁](http://pastebin.com/f200c4eb0)。现在，我希望 VMware 将它包含在未来的版本中，以省去我和其他人在每次 VMware 或内核升级后手动应用它的麻烦。问题：我在哪里/如何向 VMware 提交此类修复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T16:19:58.960

我已经将内核模块强加于 2.6.26 内核。这是[我的补丁](http://pastebin.com/f200c4eb0)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-21T16:07:25.667

您是否尝试搜索[VMware 支持网站](http://www.vmware.com/support/)？这已[在 VMware 论坛中提出](http://kb.vmware.com/selfservice/search.do?cmd=displayKC&docType=kc&externalId=150-150690xml4)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T03:10:35.533

也许[http://open-vm-tools.sourceforge.net/contribute.php](http://open-vm-tools.sourceforge.net/contribute.php)？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T23:07:34.800

我向 VMware 写了一个支持请求，他们向我保证我的补丁将到达 VMware 服务器团队。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T21:21:01.107

感谢您的巨大努力..

我用它来让 VMWare Server 1.08 在 OpenFiler 上运行。还建议使用 vmware-any-any 补丁，但由于“物理内存不足”错误，我无法启动来宾 VM。

现在我的虚拟机又快乐地运行了:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T16:18:56.207

非常感谢阿列克谢！这为我自己和我的一个同事整理了一些东西。

与布鲁斯的任何补丁有同样的问题。

有一件事，我注意到补丁一开始就缺少@@'s..我做了一个新的pastebin，里面有它们（诅咒它们突出显示的东西！）

在这里： http: [//pastebin.com/f2ea13d45](http://pastebin.com/f2ea13d45)

谢谢，克里斯

# php - php: output[] w/join vs $output .=

> ID：111282
> 
> 赞同：3
> 
> 时间：2008-09-21T15:56:49.640
> 
> 标签：php, string-concatenation

我正在修改一些代码，其中原始作者通过使用数组来构建网页：

```
 $output[]=$stuff_from_database;
 $output[]='more stuff';
 // etc
 echo join('',$output); 
```

任何人都可以想到为什么这会更好（反之亦然）的原因：

```
 $output =$stuff_from_database;
 $output .='more stuff';
 // etc
 echo $output; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-21T16:07:54.323

它可能是由来自字符串不可变语言的人编写的，因此连接很昂贵。如以下测试所示，PHP 不是其中之一。所以第二种方法在性能方面更好，更好。我能想到的使用第一种方法的唯一另一个原因是能够用另一个部分替换数组的某些部分，但这意味着要跟踪未指定的索引。

```
~$ cat join.php
<?php

for ($i=0;$i<50000;$i++) {
$output[] = "HI $i\n";
}

echo join('',$output);
?>

~$ time for i in `seq 100`; do php join.php >> outjoin ; done

real    0m19.145s
user    0m12.045s
sys     0m3.216s

~$ cat dot.php
<?php

for ($i=0;$i<50000;$i++) {
$output.= "HI $i\n";
}

echo $output;
?>

~$ time for i in `seq 100`; do php dot.php >> outdot ; done

real    0m15.530s
user    0m8.985s
sys     0m2.260s 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T18:25:28.720

这有点离题，但是

```
$output =$stuff_from_database;
$output .='more stuff';
// etc
echo $output; 
```

远慢于：

```
echo = $stuff_from_database;
echo 'more stuff'; 
```

事实上，在 PHP 中构建字符串的最快方法是：

```
ob_start();
echo = $stuff_from_database;
echo 'more stuff';
$output = ob_get_contents();
ob_end_clean(); 
```

由于输出缓冲区的工作方式等，它是构建字符串的最快方式。显然，只有在您确实需要优化 sting 构建时才会这样做，因为它很丑陋并且不会导致代码易于阅读。并且大家都知道“过早的优化是万恶之源”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T09:00:35.433

同样，有点离题（不是很远），但是如果您打算在要输出的数组项之间放置一些东西，那么如果只有几行要连接，join(', ', $output) 就可以了它足够容易和快速。这将更容易编写，并且避免必须检查列表的末尾（您不希望尾随'，'）。

对于程序员来说，因为它比 CPU 周期贵 1000 倍，所以如果它不打算每秒运行 10,0000 次以上，我通常会把它扔进一个连接中。

就所花费的时间与节省的 CPU 时间而言，像这样的后编码微优化很少值得。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T16:19:58.727

**<**!-- 已编辑以前的评论 -->****

 **看来我的代码中有错误，所以我没有执行任何操作并忘记检查。

这似乎与之前的测试相反，并且阅读之前关于该主题的博客，以下结论实际上（经过测试）至少对于我可以置换的上述代码的所有变体都是**不正确的。**

1.  **UNTRUE**：字符串插值比字符串连接慢。（！）
2.  **UNTRUE** : SprintF 最快。

实际测试中，Sprintf*最慢* ，插值*最快*

```
PHP 5.2.6-pl7-gentoo (cli) (内置: Sep 21 2008 13:43:03)
版权所有 (c) 1997-2008 PHP 集团
Zend Engine v2.2.0，版权所有 (c) 1998-2008 Zend Technologies
    使用 Xdebug v2.0.3，版权所有 (c) 2002-2007，作者 Derick Rethans

```

这可能取决于我的设置，但它仍然很奇怪。：/

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T14:28:28.720

我认为最快的方法是使用回声。它不那么漂亮，可能还不够快，值得付出可读性的代价。

```
echo $stuff_from_database
   , 'more stuff'
   , 'yet more'
   // etc
   , 'last stuff'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T16:12:55.530

如果加入`implode()`or `join()`，PHP 能够更好地优化它。它遍历列表中的所有字符串，计算长度并分配所需的空间并填充空间。与“。=”相比，它必须不断地`free()`为`malloc()`字符串留出空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T00:03:56.860

已经说过了，但我认为一个明确的答案会有所帮助。

最初的程序员是这样写的，因为他认为这样更快。事实上，在 PHP 4 下，它确实更快，尤其是对于大字符串。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-21T16:00:01.970

底部将重复重新分配 $output 字符串，而我相信顶部只会将每个部分存储在一个数组中，然后在最后将它们全部连接起来。结果，原始示例最终可能会更快。如果这对性能不敏感，那么我可能会追加，而不是加入。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T02:02:03.020

这部分代码对性能不敏感；它用于在低流量网站上格式化和显示用户的购物车信息。此外，数组（或字符串）每次都是从头开始构建的，无需寻址或搜索特定元素。听起来数组的效率更高一些，但我想这两种方式都无关紧要。感谢您提供所有信息！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-24T02:06:24.040

如果您正在生成一个列表（例如购物车），您应该有一些代码可以从从数据库中获取的每个条目生成 HTML。

```
for ($prod in $cart)
{
  $prod->printHTML();
} 
```

或类似的东西。这样，代码就变得干净多了。当然，这假设您有很好的对象代码，而不是像我的公司那样（并且正在替换）一团糟。

# database - 在 VB6 中使用 SQLITE

> ID：111285
> 
> 赞同：12
> 
> 时间：2008-09-21T15:57:56.000
> 
> 标签：database, sqlite, vb6, ado

我目前正在为可再发行应用程序使用 MSAccess mdb 文件。

不久前，我发现了 SQLite，作为我的解决方案的替代方案，但它们提供的二进制文件不提供将它们用作 VB6 中的对象的可能性。（或者至少我无法弄清楚如何）。

有没有人有一个链接，或者可以写一些关于从 VB6 连接到 SQLite DB 的内容，以及它与使用 ADO 的区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T22:49:05.707

我一直在使用 SQLite 开发一个 VB6 应用程序，并且尝试了几种连接方法。

因此，让我总结并给出我认为的最佳答案。

Ben Hoffstein、gobansaor 和 David W. Fenton 提到的方法很好，但它们依赖于 sqlite 的专有接口。

CherryCity 的 OLEDB 提供商很好，因为它使用标准接口，但他们有一个按安装的版税系统，这使得它非常非常昂贵。他们的网站没有预先声明该产品有版税。您只有在实际购买了用于开发的产品并想要分发它时才知道。

[最后，在http://www.ch-werner.de/sqliteodbc/](http://www.ch-werner.de/sqliteodbc/)上还有啤酒和语音中完全免费的 SQLite ODBC 驱动程序。它工作得很好，我还没有遇到任何重大问题。我遇到的唯一小问题是它不允许在一次调用中使用多个语句，因此您只需将其分开即可。此外，该驱动程序允许使用 DSN-less 方法，这使一切变得更加容易。

所以，imo，ODBC 驱动程序确实是最好的解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-22T11:56:05.670

或者试试 Datenhaus的 DHSqlite [http://www.thecommon.net/2.html](http://www.thecommon.net/2.html) ..

“...作为 ADO 的快速替代品开发，封装了超快的 SQLite 引擎...”

“......只需两个 Dll，您就可以完全替代整个 ADO/JET 环境 - 不再有依赖关系......”

..它是免费的（但不是开源的）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-21T16:18:24.797

这是带有代码示例的链接：

[http://www.freevbcode.com/ShowCode.asp?ID=6893](http://www.freevbcode.com/ShowCode.asp?ID=6893)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-23T22:28:35.760

只是关于这个主题/问题的仅供参考......

发布的 FreeVB 代码链接使用仅支持 SQLite 2.x（功能有限）的 AGS_SQLite.dll

提供的 DHSqlite 链接也支持 SQLite 3.x，对于使用 VB6 (Classic) 进行 SQLite 开发的任何人来说都是一个更好的建议……在[http://www.thecommon.net/3 上有此 SQLite 引擎的代码示例。 html](http://www.thecommon.net/3.html)

希望有帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-11-06T05:08:35.990

vbRichClient-Framework（目前为第 5 版）是免费提供的 3 个 Dll 集： vbRichClient5.dll vb_cairo_sqlite.dll DirectCOM.dll vbRichClient5.dll 是用 VB6 编写的 - 并且计划在 LGPL 下进行以后的开源。

它的主要目的是，尽可能多地与 MS-COM 依赖项分离，并牢记目标，以便稍后在随附的（与 VB6 兼容的）编译器启动时更容易实现自托管状态。如果更容易实现平台可移植性（对于编译器和新的基于类的运行时）是目标，那么我们需要开始使用这种已经处于过渡和规划阶段的解耦框架。

So, the lib offers a modern GUI-Framework which works Vector-based, using the cairo-library under the hood (no GDI/GDI+ or DirectX here ... and also nothing of the MS-CommonControls.dll is touched).

The other larger part, which is often needed and used within "typical VB-Applications" is easy DB-Access (usually done over an accompanying Desktop-DB-File in *.mdb-Format). So what the framework also offers, is an easy to use (and nearly ADO-compatible) replacement for the MS-JET-Engine. This is, what makes up the other larger part of the accompanying satellite-binary: vb_cairo_sqlite.dll ... the SQLite-engine.

[http://www.vbrichclient.com/#/en/Downloads.htm](http://www.vbrichclient.com/#/en/Downloads.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-28T20:08:51.963

[本页](http://www.sqlite.org/cvstrac/wiki?p=SqliteWrappers)中间的COM **Wrappers / Visual Basic DLLs**部分列出了一些可用于 VB6 的解决方案。

是的，我仍然坚持使用 VB6 进行开发 :(

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-23T13:39:55.347

似乎可以`sqlite.dll`使用 VB`Declare Sub`或`Declare Function`语法直接访问 SQLite 函数。

此处显示了一个示例： [https ://github.com/RobbiNespu/VB6-Sqlite3](https://github.com/RobbiNespu/VB6-Sqlite3)

关键摘录：

```
Public Declare Sub sqlite3_open Lib "sqlite.dll" (ByVal FileName As String, ByRef handle As Long)
Public Declare Sub sqlite3_close Lib "sqlite.dll" (ByVal DB_Handle As Long)
Public Declare Function sqlite3_last_insert_rowid Lib "sqlite.dll" (ByVal DB_Handle As Long) As Long
Public Declare Function sqlite3_changes Lib "sqlite.dll" (ByVal DB_Handle As Long) As Long
Public Declare Function sqlite_get_table Lib "sqlite.dll" (ByVal DB_Handle As Long, ByVal SQLString As String, ByRef ErrStr As String) As Variant()
Public Declare Function sqlite_libversion Lib "sqlite.dll" () As String
Public Declare Function number_of_rows_from_last_call Lib "sqlite.dll" () As Long
...
query = "SELECT * FROM users"

row = sqlite_get_table(DBz, query, minfo) 
```

（我不知道该示例是否真的准备好用于生产代码）。

# database - TClientDataset 中有多个表？

> ID：111287
> 
> 赞同：1
> 
> 时间：2008-09-21T15:59:07.543
> 
> 标签：database, delphi, sqlite, tclientdataset

是否可以将来自多个表的多个查询的结果放入 TClientDataset 中？

就像

```
SELECT * from t1;
SELECT * from t2;
SELECT * from t3; 
```

我似乎无法找到一种方法来让数据提供者 (SetProvider) 一次从多个表中提取结果。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-21T21:19:38.223

`ClientDatasets`可以包含本身就是其他数据集的字段。因此，如果您想在单个数据集中创建三个表，请创建三个`ClientDatasets`包含您想要的三个结果集，然后您可以将它们放入一个`ClientDataSet`.

本文：

[http://dn.codegear.com/article/29001](http://dn.codegear.com/article/29001)

向您展示如何在运行时和设计时执行此操作。请特别注意标题为：

“使用”在运行时创建`ClientDataSet's`结构`TFields`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-21T16:11:53.987

唯一的方法是加入表格。但是你必须通过加入的外键提供加入的标准。

```
select * from t1, t2, t3 where t1.key = t2.key and t2.key = t3.key; 
```

现在假设您想出了一个允许这种连接的键（如 LineNr）。然后，您可以使用完全外连接来包含所有记录（如果不是所有表都具有相同的行数，这很重要）。但这在某种程度上是一个黑客行为。确保不要将 auto_number 作为键，因为它不会重复使用键，因此往往会在编号中留下漏洞，从而导致许多行仅部分填充了值。

如果要从具有相同字段集的多个表中填充客户端数据集，可以使用 UNION 运算符来执行此操作。这将只使用相同的列并将所有行合并到一个表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T16:05:47.433

没有办法像您引用的那样在同一个 TClientDataSet 中拥有多个表数据。TClientDataSet 为单个数据集保存一个游标。

# ads - 在线营销软件

> ID：111294
> 
> 赞同：-2
> 
> 时间：2008-09-21T16:01:40.983
> 
> 标签：ads, shareware, google-ads-api

有哪些资源可用于在线营销可下载的桌面软件？当然，AdWords 和“有机”搜索引擎结果，但是否有人有幸通过 Tucows 和/或 Download.com 等网站进行销售？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T14:56:44.487

有很多方法可以在线营销您的软件。有的要花钱，有的不花钱。考虑以下：

*   创建博客并定期更新潜在客户感兴趣的项目
*   创建用户可以报告错误、寻求帮助和建议功能的论坛。围绕您的产品建立一个潜在客户可以找到的社区。许多人会根据您所在社区的人对您产品的评价来评判您。
*   有公告时提交新闻稿。有许多免费网站和一些付费网站接受新闻稿。不要忘记公告论坛、新闻组和[邮件列表](http://aspadvice.com/lists/SignUp/list.aspx?l=7&c=16)。
*   创建截屏视频并将其发布到您的网站以及 YouTube 等社区视频网站。
*   购买尽可能针对潜在客户的广告。例如，如果您的目标是 Microsoft 开发人员，请考虑将[Lake Quincy Media](http://lakequincy.com/)和[CodeProject](http://codeproject.com/)作为开始的好地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T17:04:30.537

[乔尔在软件论坛上](http://discuss.joelonsoftware.com/?biz)

# functional-programming - Jan Willem Klop 的“(LL L...)”Y 组合器是如何工作的？

> ID：111295
> 
> 赞同：14
> 
> 时间：2008-09-21T16:01:47.117
> 
> 标签：functional-programming, lisp, computer-science

我了解[Y Combinator 是什么](https://stackoverflow.com/questions/93526/what-is-a-y-combinator)，但我不了解来自[Wikipedia 页面](http://en.wikipedia.org/wiki/Y_combinator)的“新颖”组合器示例：

```
Yk = (LLLLLLLLLLLLLLLLLLLLLLLLLLL)

在哪里：

    L = λabcdefghijklmnopqstuvwxyzr。(r (thisisafixedpointcomb inator))
```

这是如何运作的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-21T16:39:54.497

定点组合`C`器的本质是`C f`减少到`f (C f)`. 只要这样做，您需要什么都没关系`C`。所以而不是

```
(\y f. f (y y f)) (\y f. f (y y f)) 
```

你也可以拿

```
(\y z f. f (y y y f)) (\y z f. f (y y y f)) (\y z f. f (y y y f)) 
```

基本上你需要一些形式

```
C t1 t2 ... tN 
```

`ti = C`一些`i`和_

```
C = \x1 x2 .. xN f. f (xi u1 u2 ... xi ... u(N-1) f) 
```

`tj`其他术语`uj`实际上并未“使用”。你可以看到克洛普`L`有这种形式（尽管他使用了 all `ti`are `L`such that the second`xi`也可以是 any other的事实`xj`）。

# javascript - 提供 JSONP 的最佳内容类型？

> ID：111302
> 
> 赞同：122
> 
> 时间：2008-09-21T16:04:53.007
> 
> 标签：javascript, json, jsonp

我有一个 web 服务，在没有指定回调的情况下调用它会返回一个 JSON 字符串，`application/json`用作内容类型。

当指定回调时，它会将 JSON 字符串包装在回调函数中，因此它不再是真正有效的 JSON。我的问题是，我应该像`application/javascript`在这种情况下那样使用它还是仍然使用它`application/json`？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2008-09-21T16:06:43.453

使用应用程序/javascript。这样，客户端可以依赖内容类型，而无需手动检查响应是否有填充。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2008-09-21T16:10:06.003

如果您返回的是纯 JSON，请`application/json` [按照 rfc4627.txt](http://www.ietf.org/rfc/rfc4627.txt)使用。

如果您返回 JavaScript（这实际上是 JSONP），则`application/javascript` [按照 rfc4329.txt使用](http://www.rfc-editor.org/rfc/rfc4329.txt)

# computer-science - 什么是“P=NP？”，为什么它是一个如此著名的问题？

> ID：111307
> 
> 赞同：258
> 
> 时间：2008-09-21T16:07:07.960
> 
> 标签：computer-science, theory, complexity-theory, np-complete, p-np

P=NP 是否是计算机科学中最著名的问题。这是什么意思？为什么它如此有趣？

哦，为了获得额外的荣誉，请张贴一份声明的真假证明。:)

* * *

## 回答 #1

> 赞同：401
> 
> 时间：2008-09-24T15:20:00.857

P 代表多项式时间。NP 代表非确定性多项式时间。

定义：

*   **多项式时间**意味着算法的复杂度为 O(n^k)，其中 n 是数据的大小（例如要排序的列表中的元素数），k 是常数。

*   **复杂性**是用操作次数来衡量的时间，它是数据项数量的函数。

*   **操作**是对特定任务有意义的基本操作。对于排序，基本操作是比较。对于矩阵乘法，基本运算是两个数的乘法。

现在的问题是，确定性与非确定性是什么意思？有一个抽象的计算模型，一种称为图灵机 (TM) 的假想计算机。这台机器有有限数量的状态和一个无限的磁带，它有离散的单元，可以在其中写入和读取有限的符号集。在任何给定时间，TM 都处于其中一种状态，它正在查看磁带上的特定单元格。根据它从该单元格读取的内容，它可以将一个新符号写入该单元格，将磁带向前或向后移动一个单元格，然后进入不同的状态。这称为状态转换。令人惊奇的是，通过仔细构造状态和转换，您可以设计一个 TM，它相当于任何可以编写的计算机程序。

这里有两种与我们有关的 TM：确定性和非确定性。对于从磁带上读取的每个符号，确定性 TM 只有一个从每个状态的转换。一个非确定性的 TM 可能有几个这样的转变，即它能够同时检查几个可能性。这有点像产生多个线程。不同之处在于，非确定性 TM 可以根据需要生成任意数量的此类“线程”，而在真实计算机上一次只能执行特定数量的线程（等于 CPU 的数量）。实际上，计算机基本上是带有有限磁带的确定性 TM。另一方面，非确定性 TM 无法在物理上实现，除非使用量子计算机。

已经证明，任何可以由非确定性 TM 解决的问题都可以由确定性 TM 解决。但是，尚不清楚需要多长时间。陈述 P=NP 意味着如果一个问题在非确定性 TM 上花费多项式时间，那么人们可以构建一个确定性 TM，它也可以在多项式时间内解决相同的问题。到目前为止，没有人能够证明它可以做到，但也没有人能够证明它不能做到。

NP 完全问题是指一个 NP 问题 X，这样任何 NP 问题 Y 都可以通过多项式归约化为 X。这意味着，如果有人提出了 NP 完全问题的多项式时间解决方案，那么这也将为任何 NP 问题提供多项式时间解决方案。因此，这将证明 P = NP。相反，如果有人要证明 P!=NP，那么我们可以肯定在传统计算机上没有办法在多项式时间内解决 NP 问题。

NP 完全问题的一个例子是寻找一个真值赋值的问题，该赋值将使包含 n 个变量的布尔表达式为真。
目前在实践中，任何在非确定性 TM 上花费多项式时间的问题只能在确定性 TM 或传统计算机上以指数时间完成。
例如，解决真值分配问题的唯一方法是尝试 2^n 种可能性。

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2008-09-24T17:03:31.793

1.  **如果可以在多项式时间内计算答案，则在P**（**P**多项式时间）中存在是或否问题。
2.  *如果可以在多项式时间内验证*是的答案，则在**NP**（**N**个确定性**多项式**时间）中是或否问题。

 *直观地，我们可以看到，如果问题在**P**中，那么它在**NP**中。**给定P**中问题的潜在答案，我们可以通过简单地重新计算答案来验证答案。

不太明显，也更难回答的是，是否**NP**中的所有问题都在**P**中。我们可以在多项式时间内验证答案这一事实是否意味着我们可以在多项式时间内计算该答案？

有大量重要的问题已知是**NP 完全**的（基本上，如果任何这些问题被证明在**P**中，那么*所有* **NP**问题都被证明在**P**中）。如果**P** = **NP**，那么所有这些问题都将被证明具有有效的（多项式时间）解。

大多数科学家认为**P** != **NP**。但是，尚未为**P** = **NP** 或**P** != **NP**建立证据。如果有人为任一猜想提供证明，[他们将赢得 100 万美元](http://en.wikipedia.org/wiki/Millennium_Prize_Problems)。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-09-24T16:26:16.453

给出我能想到的最简单的答案：

假设我们有一个需要一定数量的输入的问题，并且有各种潜在的解决方案，对于给定的输入，这些解决方案可能会也可能不会解决问题。谜题杂志中的逻辑谜题就是一个很好的例子：输入是条件（“乔治不住在蓝色或绿色的房子里”），潜在的解决方案是一个陈述列表（“乔治住在黄色的房子里”）房子，种豌豆，养狗”）。一个著名的例子是旅行推销员问题：给定一个城市列表，以及从任何城市到达任何其他城市的时间，以及时间限制，一个潜在的解决方案是按照推销员访问城市的顺序列出城市列表，以及如果旅行时间的总和小于时间限制，它将起作用。

如果我们可以有效地检查潜在的解决方案以查看它是否有效，那么这样的问题就存在于 NP 中。例如，给定一个销售人员按顺序访问的城市列表，我们可以将每次城市之间的旅行时间相加，并轻松查看是否在时间限制内。如果我们能够有效地找到解决方案（如果存在），那么问题就在 P 中。

（有效地，在这里，有一个精确的数学含义。实际上，这意味着大问题不会不合理地难以解决。在寻找可能的解决方案时，一种低效的方法是列出所有可能的潜在解决方案，或类似的东西，而一种有效的方法需要搜索更有限的集合。）

因此，P=NP 问题可以这样表达：如果您可以有效地验证上述问题的解决方案，您能否有效地找到解决方案（或证明没有解决方案）？显而易见的答案是“你为什么能做到？”，这就是今天的问题所在。没有人能够以一种或另一种方式证明这一点，这让很多数学家和计算机科学家感到困扰。这就是为什么任何能够证明该解决方案的人都会从 Claypool 基金会获得 100 万美元。

我们通常假设 P 不等于 NP，即没有找到解决方案的通用方法。如果结果证明 P=NP，很多事情都会改变。例如，密码学将变得不可能，随之而来的是互联网上的任何隐私或可验证性。毕竟，我们可以有效地获取加密文本和密钥并生成原始文本，因此如果 P=NP 我们可以在事先不知道密钥的情况下有效地找到密钥。密码破解将变得微不足道。另一方面，我们可以有效地解决各类规划问题和资源分配问题。

你可能听说过 NP-complete 的描述。一个 NP 完全问题（当然）是一个 NP 问题，并且具有这个有趣的性质：如果它在 P 中，那么每个 NP 问题都是，所以 P=NP。如果你能找到有效解决旅行推销员问题的方法，或者从谜题杂志中找到逻辑谜题，你就可以有效地解决 NP 中的任何问题。NP 完全问题在某种程度上是最难的 NP 问题。

所以，如果你能为任何 NP 完全问题找到一种有效的通用解技术，或者证明不存在这样的问题，那么名利就是你的了。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-21T16:14:21.843

根据我的拙见做一个简短的总结：

有一些简单的计算问题（比如在图中找到两点之间的最短路径），计算速度非常快（ O(n^k)，其中 n 是输入的大小，k 是常数（在图的情况下，它是顶点或边的数量））。

其他问题，例如找到穿过图中每个顶点的路径或从公钥中获取 RSA 私钥更难 (O(e^n))。

但是 CS 说问题在于我们不能将非确定性图灵机“转换”为确定性图灵机，但是我们可以将非确定性有限自动机（如正则表达式解析器）转换为确定性自动机（好吧，你可以，但是机器的运行时间会很长）。也就是说，我们必须尝试所有可能的路径（通常聪明的 CS 教授可以排除一些路径）。

这很有趣，因为甚至没有人知道解决方案。有人说是真的，有人说是假的，但没有达成共识。另一个有趣的事情是，解决方案会对公钥/私钥加密（如 RSA）有害。您可以像现在生成 RSA 密钥一样轻松破解它们。

这是一个非常鼓舞人心的问题。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-24T15:26:28.127

对于问题的 P=?NP 部分的内容和原因，我没有什么可以补充的，但关于证明。一个证明不仅值得一些额外的功劳，而且还可以解决一个[千年问题](http://www.claymath.org/millennium-problems/p-vs-np-problem)。最近进行了一项有趣的民意调查，就证明的主题而言，[公布的结果 (PDF)绝对值得一读。](http://www.cs.umd.edu/~gasarch/papers/poll.pdf)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-11T07:26:45.187

首先，一些定义：

*   如果您可以在比`n^k`some更短的时间内计算出解决方案，则 P 中存在一个特定问题`k`，其中`n`是输入的大小。例如，可以在`n log n`小于 的情况下进行`n^2`排序，因此排序是多项式时间。

*   如果存在`k`这样一个问题，即存在一个至多存在一个大小的解决方案`n^k`，您最多可以及时验证`n^k`。对图进行 3 着色：给定一个图，3 着色是具有大小的（顶点，颜色）对的列表，`O(n)`您可以及时`O(m)`（或`O(n^2)`）验证所有邻居是否具有不同的颜色。因此，仅当存在简短且易于验证的解决方案时，图才可进行 3 色着色。

NP 的一个等效定义是“在多项式时间内可以由 N 非确定性图灵机解决*的**问题*” 。虽然这会告诉您名称的来源，但它并不能让您直观地感受到 NP 问题是什么样的。

 *请注意，P 是 NP 的子集：如果您可以在多项式时间内找到一个解，那么就有一个可以在多项式时间内验证的解——只需检查给定的解是否等于您可以找到的解。

为什么这个问题`P =? NP`很有趣？要回答这个问题，首先需要了解什么是 NP 完全问题。简单地说，

*   如果 (1) L 在 P 中，并且 (2) 解决 L 的算法可用于解决 NP 中的任何问题 L'，则问题 L 是 NP 完全的；也就是说，给定 L' 的实例，当且仅当 L' 的实例有解时，您才能创建具有解的 L 的实例。形式上讲，NP 中的每个问题 L' 都*可以*归约为 L。

请注意，L 的实例必须是多项式时间可计算的，并且具有多项式大小，大小为 L'；这样，在多项式时间内解决一个 NP 完全问题为我们提供了*所有*NP 问题的多项式时间解决方案。

这是一个例子：假设我们知道图的 3 色是一个 NP 难题。我们想证明决定布尔公式的可满足性也是一个 NP 难题。

对于每个顶点 v，有两个布尔变量 v_h 和 v_l，以及要求（v_h 或 v_l）：每一对只能有值 {01,10,11}，我们可以将其视为颜色 1、2 和 3。

对于每条边 (u, v)，要求 (u_h, u_l) != (v_h, v_l)。那是，

> `not ((u_h and not u_l) and (v_h and not v_l) or ...)` 列举所有相等的配置并规定它们都不属于这种情况。

`AND`' 将所有这些约束加在一起给出了一个具有多项式大小 ( `O(n+m)`) 的布尔公式。您可以检查计算是否也需要多项式时间：您正在为`O(1)`每个顶点和每个边做简单的事情。

如果你能解决我做的布尔公式，那么你也可以解决图形着色：对于每对变量 v_h 和 v_l，让 v 的颜色与这些变量的值匹配。通过公式的构造，邻居不会有相同的颜色。

因此，如果图的 3 色是 NP 完全的，那么布尔公式可满足性也是如此。

我们知道图的 3 着色是 NP 完全的；然而，从历史上看，我们通过首先展示布尔电路可满足性的 NP 完备性，然后将其减少到 3-colorability（而不是相反）来知道这一点。

# sql-server - 如何将旧的 Interbase DB 转换为 SQL Server？

> ID：111318
> 
> 赞同：3
> 
> 时间：2008-09-21T16:10:00.950
> 
> 标签：sql-server, database, interbase

我有一个 Interbase 数据库。如何将其转换为 SQL Server？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T16:25:21.257

您可以使用 SQL Server 2000 中内置的 SQL Server**数据转换服务 (DTS)**或**SQL Server 2005 中的 SQL Server 集成服务 (SSIS)**。

尝试为 Interbase 设置**ODBC DSN**。然后在 DTS/SSIS 中使用 Other（ODBC 数据源）和 DSN。

如果这不起作用，请查看 Interbase 是否有导出到文本文件的实用程序，然后使用 DTS / SSIS 导入文本文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T16:16:32.790

如果您想花一些钱，这将做到：

[http://www.spectralcore.com/fullconvert/tutorials/convert-interbase-firebird-to-mssql-sql-server.php](http://www.spectralcore.com/fullconvert/tutorials/convert-interbase-firebird-to-mssql-sql-server.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T16:34:11.857

Interbase DB Wikipedia 页面说它支持 OBDC 和 ADO.NET，所以我认为 SQL Server 可能可以自己导入这个数据库。我无权尝试安装 Interbase DB，但您可能会发现这些页面很有帮助。

[MSDN 关于导入数据向导](http://msdn.microsoft.com/en-us/library/ms141209.aspx)
[MSDN 关于批量导入命令（如果 Interbase DB 可以转储文本文件）](http://msdn.microsoft.com/en-us/library/aa196743(SQL.80).aspx)
[关于从 ADO.NET 支持源批量导入的文章](http://www.developer.com/db/article.php/3702826)

希望有人对这个数据库有直接的经验并能提供帮助。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T18:50:58.970

如果你只需要转换表格和数据，那是相当简单的。只需使用 InterBase 的 ODBC 驱动程序，连接到它并抽取数据。

但是，如果您还需要业务逻辑，则不能像那样隐藏它。您可以毫无问题地转换常规表和视图。域信息会丢失，但无论如何您在 MSSQL 中都不需要它。表的唯一问题可能是数组字段，您需要将其转换为单独的表，但这也不是太难。

问题在于触发器和存储过程的转换，因为 InterBase 使用自己的自定义 PSQL 语言。它有一些与 MSSQL 不同的概念。例如，您有可以返回结果集的过程，您需要将它们转换为 MSSQL 函数。

无论如何，它不应该太难，因为你的复杂性从低到高，但是没有工具可以自动完成。

# asp.net - 有哪些 ADFS 替代方案可用于为 ASP.NET 应用程序在 Active Directory 中使用用户进行单点登录？

> ID：111330
> 
> 赞同：1
> 
> 时间：2008-09-21T16:14:48.287
> 
> 标签：asp.net, active-directory, single-sign-on

需要安全并能够处理成千上万的用户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T18:06:20.343

看看亚当和阿兹曼。

ADAM 是 Active Directory 应用程序模式。有一个操作指南：http: [//msdn.microsoft.com/en-us/library/ms998331.aspx](http://msdn.microsoft.com/en-us/library/ms998331.aspx)

AzMan 是授权经理。有一个操作指南：http: [//msdn.microsoft.com/en-us/library/ms998336.aspx](http://msdn.microsoft.com/en-us/library/ms998336.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T09:09:02.873

ADFS 的三种替代方案是

*   [简化](http://www.symplified.com/)- 各种产品选项
*   [Ping](https://www.pingidentity.com/) - SaaS 产品
*   Forgerock - 这是一个开放平台

都以某种方式与 AD 集成

# bluetooth - 让 Arduino LilyPad 将 BlueSmirf v2.11 切换到/从命令模式

> ID：111331
> 
> 赞同：2
> 
> 时间：2008-09-21T16:14:59.860
> 
> 标签：bluetooth, arduino

电池供电的 (2 x AA) Arduino LilyPad 应将 BlueSmirf v2.11 蓝牙调制解调器切换到/从命令模式（参见下面的源代码）。BlueSmirf 已设置为 9600 波特。

如果 PC 通过蓝牙连接（参见下面的源代码），Arduino 程序在开始时运行良好（发送多个“ping\n”）。一段时间后，它（LilyPad/BlueSmirf）也开始通过蓝牙连接发送“$$$”和“---\n”，而不是切换到/从命令模式。

有任何想法吗？

问候，坦伯格

```
// Arduino source code:

void setup () {
  Serial.begin(9600);
}

void loop () {
    Serial.print("$$$");
    delay(2000); // TODO: Inquiry, etc.
    Serial.print("---\n");
    delay(100);
    Serial.print("ping\n");
    delay(2000);
}

// C# source code (runs on PC)

using System;
using System.IO.Ports;

class Program {

    static void Main () {
        SerialPort p = new SerialPort(
            "COM20", 9600, Parity.None, 8, StopBits.One);
        using (p) {
            p.Open();
            while (p.IsOpen) {
                Console.Write((char) p.ReadChar());
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-21T20:00:23.097

从[数据表](http://www.sparkfun.com/datasheets/RF/RN_BlueportII-ref-guide.pdf)，第 6 页：

> 注意 1：您可以在未连接时随时通过串行端口在本地进入命令模式。建立连接后，只有在配置计时器未到期时才能进入命令模式。要启用连续配置，请将配置计时器设置为 255。此外，如果设备处于自动主控模式 3，则通过蓝牙连接时将无法进入命令模式。

我的猜测是配置计时器即将到期。

# process - 更改另一个进程区域设置

> ID：111339
> 
> 赞同：2
> 
> 时间：2008-09-21T16:18:35.547
> 
> 标签：process

从我自己的“类似键盘记录器”的进程中，我发现另一个进程 Locale 是错误的（即通过嗅探几个键，我发现前台进程 Locale 应该是某个东西，而它被设置为另一个）。最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T16:24:22.380

我会在该进程中使用[setLocale](http://www.gnu.org/software/libtool/manual/libc/Setting-the-Locale.html)来更改它，并使用某种形式的 IPC 通知该进程，例如：

*   [信号](http://www.gnu.org/software/libtool/manual/libc/Signal-Handling.html)
*   [插座](http://www.gnu.org/software/libc/manual/html_node/Sockets.html)
*   [管道](http://www.gnu.org/software/libtool/manual/libc/Pipes-and-FIFOs.html)

从过程谁知道

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T16:25:16.200

您没有指定操作系统或任何东西，但在 Linux 中这非常困难，除非目标进程愿意提供帮助（即有一些可用的 IPC 机制，您可以要求进程为您执行此操作）

您*可以*做的是附加到进程，就像调试器或 strace 所做的那样，并调用适当的系统调用（如`setlocale()`）

目标进程的结果当然是不确定的，因为它可能不希望在它的脚下改变它的语言环境:)

# sql-server - 将子查询中的多个结果组合成一个逗号分隔值

> ID：111341
> 
> 赞同：85
> 
> 时间：2008-09-21T16:19:50.007
> 
> 标签：sql-server, tsql, join

我有两张桌子：

```
TableA
------
ID,
Name

TableB
------
ID,
SomeColumn,
TableA_ID (FK for TableA) 
```

关系是一排`TableA`-多排`TableB`。

现在，我想看到这样的结果：

```
ID     Name      SomeColumn

1\.     ABC       X, Y, Z (these are three different rows)
2\.     MNO       R, S 
```

这不起作用（子查询中有多个结果）：

```
SELECT ID,
       Name, 
       (SELECT SomeColumn FROM TableB WHERE F_ID=TableA.ID)
FROM TableA 
```

如果我在客户端进行处理，这是一个微不足道的问题。但这意味着我必须在每个页面上运行 X 个查询，其中 X 是`TableA`.

请注意，我不能简单地执行 GROUP BY 或类似的操作，因为它会为`TableA`.

我不确定使用 COALESCE 或类似方法的 UDF 是否可行？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-12-21T14:09:12.347

即使这样也能达到目的

**样本数据**

```
declare @t table(id int, name varchar(20),somecolumn varchar(MAX))
insert into @t
    select 1,'ABC','X' union all
    select 1,'ABC','Y' union all
    select 1,'ABC','Z' union all
    select 2,'MNO','R' union all
    select 2,'MNO','S' 
```

**询问：**

```
SELECT ID,Name,
    STUFF((SELECT ',' + CAST(T2.SomeColumn AS VARCHAR(MAX))
     FROM @T T2 WHERE T1.id = T2.id AND T1.name = T2.name
     FOR XML PATH('')),1,1,'') SOMECOLUMN
FROM @T T1
GROUP BY id,Name 
```

**输出：**

```
ID  Name    SomeColumn
1   ABC     X,Y,Z
2   MNO     R,S 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-09-21T17:02:14.943

### 1\. 创建 UDF：

```
CREATE FUNCTION CombineValues
(
    @FK_ID INT -- The foreign key from TableA which is used 
               -- to fetch corresponding records
)
RETURNS VARCHAR(8000)
AS
BEGIN
DECLARE @SomeColumnList VARCHAR(8000);

SELECT @SomeColumnList =
    COALESCE(@SomeColumnList + ', ', '') + CAST(SomeColumn AS varchar(20)) 
FROM TableB C
WHERE C.FK_ID = @FK_ID;

RETURN 
(
    SELECT @SomeColumnList
)
END 
```

### 2.在子查询中使用：

```
SELECT ID, Name, dbo.CombineValues(FK_ID) FROM TableA 
```

### 3.如果您使用的是存储过程，您可以这样做：

```
CREATE PROCEDURE GetCombinedValues
 @FK_ID int
As
BEGIN
DECLARE @SomeColumnList VARCHAR(800)
SELECT @SomeColumnList =
    COALESCE(@SomeColumnList + ', ', '') + CAST(SomeColumn AS varchar(20)) 
FROM TableB
WHERE FK_ID = @FK_ID 

Select *, @SomeColumnList as SelectedIds
    FROM 
        TableA
    WHERE 
        FK_ID = @FK_ID 
END 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-21T16:30:31.743

在 MySQL 中，有一个[group_concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)函数将返回您所要求的内容。

```
SELECT TableA.ID, TableA.Name, group_concat(TableB.SomeColumn) 
as SomColumnGroup FROM TableA LEFT JOIN TableB ON 
TableB.TableA_ID = TableA.ID 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-21T16:22:19.407

我认为你在 COALESCE 的道路上是正确的。有关构建逗号分隔字符串的示例，请参见此处：

[http://www.sqlteam.com/article/using-coalesce-to-build-comma-delimited-string](http://www.sqlteam.com/article/using-coalesce-to-build-comma-delimited-string)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-21T16:26:41.720

您可能需要提供更多详细信息以获得更准确的响应。

由于您的数据集似乎有点窄，您可能会考虑仅对每个结果使用一行并在客户端执行后处理。

因此，如果您真的想让服务器完成工作，则返回一个结果集，例如

```
ID       Name       SomeColumn
1        ABC        X
1        ABC        Y
1        ABC        Z
2        MNO        R
2        MNO        S 
```

这当然是 ID 上的简单 INNER JOIN

在客户端返回结果集后，维护一个名为 CurrentName 的变量，并在停止将 SomeColumn 收集到您希望它执行的有用操作时将其用作触发器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T16:42:41.637

假设您在表 A 上只有 WHERE 子句，因此创建一个存储过程：

```
SELECT Id, Name From tableA WHERE ...

SELECT tableA.Id AS ParentId, Somecolumn 
FROM tableA INNER JOIN tableB on TableA.Id = TableB.F_Id 
WHERE ... 
```

然后用它填充一个 DataSet ds。然后

```
ds.Relations.Add("foo", ds.Tables[0].Columns("Id"), ds.Tables[1].Columns("ParentId")); 
```

最后，您可以在页面中添加一个中继器，为每一行放置逗号

```
 <asp:DataList ID="Subcategories" DataKeyField="ParentCatId" 
DataSource='<%# Container.DataItem.CreateChildView("foo") %>' RepeatColumns="1"
 RepeatDirection="Horizontal" ItemStyle-HorizontalAlign="left" ItemStyle-VerticalAlign="top" 
runat="server" > 
```

通过这种方式，您将在客户端执行此操作，但只有一个查询，在数据库和前端之间传递最少的数据

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-24T00:06:42.323

我尝试了 priyanka.sarkar 提到的解决方案，但并没有像 OP 要求的那样工作。这是我最终得到的解决方案：

```
SELECT ID, 
        SUBSTRING((
            SELECT ',' + T2.SomeColumn
            FROM  @T T2 
            WHERE WHERE T1.id = T2.id
            FOR XML PATH('')), 2, 1000000)
    FROM @T T1
GROUP BY ID 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-12-21T11:59:37.290

解决方案如下：

```
SELECT GROUP_CONCAT(field_attr_best_weekday_value)as RAVI
FROM content_field_attr_best_weekday LEFT JOIN content_type_attraction
    on content_field_attr_best_weekday.nid = content_type_attraction.nid
GROUP BY content_field_attr_best_weekday.nid 
```

使用这个，你也可以改变 Joins

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-02-14T12:58:45.920

我已经查看了所有答案。我认为在数据库插入中应该是这样的：

```
ID     Name      SomeColumn
1\.     ABC       ,X,Y Z (these are three different rows)
2\.     MNO       ,R,S 
```

逗号应该在前一个结尾，并通过like进行搜索`%,X,%`

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-05-01T16:22:31.850

```
SELECT t.ID, 
       t.NAME, 
       (SELECT t1.SOMECOLUMN 
        FROM   TABLEB t1 
        WHERE  t1.F_ID = T.TABLEA.ID) 
FROM   TABLEA t; 
```

这将适用于使用子查询从不同的表中进行选择。

# c# - 在不读取整个文件的情况下获取图像尺寸

> ID：111345
> 
> 赞同：111
> 
> 时间：2008-09-21T16:21:20.580
> 
> 标签：c#, .net, image, image-manipulation

有没有一种廉价的方法来获取图像的尺寸（jpg、png、...）？最好，我想只使用标准类库来实现这一点（因为托管限制）。我知道读取图像标题并自己解析它应该相对容易，但似乎这样的东西应该已经存在。此外，我已经验证以下代码可以读取整个图像（我不想要）：

```
using System;
using System.Drawing;

namespace Test
{
    class Program
    {
        static void Main(string[] args)
        {
            Image img = new Bitmap("test.png");
            System.Console.WriteLine(img.Width + " x " + img.Height);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-09-22T00:55:05.320

一如既往，最好的选择是找到一个经过良好测试的库。但是，您说这很困难，所以这里有一些不可靠的、基本上未经测试的代码，它们应该适用于相当多的情况：

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.IO;
using System.Linq;

namespace ImageDimensions
{
    public static class ImageHelper
    {
        const string errorMessage = "Could not recognize image format.";

        private static Dictionary<byte[], Func<BinaryReader, Size>> imageFormatDecoders = new Dictionary<byte[], Func<BinaryReader, Size>>()
        {
            { new byte[]{ 0x42, 0x4D }, DecodeBitmap},
            { new byte[]{ 0x47, 0x49, 0x46, 0x38, 0x37, 0x61 }, DecodeGif },
            { new byte[]{ 0x47, 0x49, 0x46, 0x38, 0x39, 0x61 }, DecodeGif },
            { new byte[]{ 0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A }, DecodePng },
            { new byte[]{ 0xff, 0xd8 }, DecodeJfif },
        };

        /// <summary>
        /// Gets the dimensions of an image.
        /// </summary>
        /// <param name="path">The path of the image to get the dimensions of.</param>
        /// <returns>The dimensions of the specified image.</returns>
        /// <exception cref="ArgumentException">The image was of an unrecognized format.</exception>
        public static Size GetDimensions(string path)
        {
            using (BinaryReader binaryReader = new BinaryReader(File.OpenRead(path)))
            {
                try
                {
                    return GetDimensions(binaryReader);
                }
                catch (ArgumentException e)
                {
                    if (e.Message.StartsWith(errorMessage))
                    {
                        throw new ArgumentException(errorMessage, "path", e);
                    }
                    else
                    {
                        throw e;
                    }
                }
            }
        }

        /// <summary>
        /// Gets the dimensions of an image.
        /// </summary>
        /// <param name="path">The path of the image to get the dimensions of.</param>
        /// <returns>The dimensions of the specified image.</returns>
        /// <exception cref="ArgumentException">The image was of an unrecognized format.</exception>    
        public static Size GetDimensions(BinaryReader binaryReader)
        {
            int maxMagicBytesLength = imageFormatDecoders.Keys.OrderByDescending(x => x.Length).First().Length;

            byte[] magicBytes = new byte[maxMagicBytesLength];

            for (int i = 0; i < maxMagicBytesLength; i += 1)
            {
                magicBytes[i] = binaryReader.ReadByte();

                foreach(var kvPair in imageFormatDecoders)
                {
                    if (magicBytes.StartsWith(kvPair.Key))
                    {
                        return kvPair.Value(binaryReader);
                    }
                }
            }

            throw new ArgumentException(errorMessage, "binaryReader");
        }

        private static bool StartsWith(this byte[] thisBytes, byte[] thatBytes)
        {
            for(int i = 0; i < thatBytes.Length; i+= 1)
            {
                if (thisBytes[i] != thatBytes[i])
                {
                    return false;
                }
            }
            return true;
        }

        private static short ReadLittleEndianInt16(this BinaryReader binaryReader)
        {
            byte[] bytes = new byte[sizeof(short)];
            for (int i = 0; i < sizeof(short); i += 1)
            {
                bytes[sizeof(short) - 1 - i] = binaryReader.ReadByte();
            }
            return BitConverter.ToInt16(bytes, 0);
        }

        private static int ReadLittleEndianInt32(this BinaryReader binaryReader)
        {
            byte[] bytes = new byte[sizeof(int)];
            for (int i = 0; i < sizeof(int); i += 1)
            {
                bytes[sizeof(int) - 1 - i] = binaryReader.ReadByte();
            }
            return BitConverter.ToInt32(bytes, 0);
        }

        private static Size DecodeBitmap(BinaryReader binaryReader)
        {
            binaryReader.ReadBytes(16);
            int width = binaryReader.ReadInt32();
            int height = binaryReader.ReadInt32();
            return new Size(width, height);
        }

        private static Size DecodeGif(BinaryReader binaryReader)
        {
            int width = binaryReader.ReadInt16();
            int height = binaryReader.ReadInt16();
            return new Size(width, height);
        }

        private static Size DecodePng(BinaryReader binaryReader)
        {
            binaryReader.ReadBytes(8);
            int width = binaryReader.ReadLittleEndianInt32();
            int height = binaryReader.ReadLittleEndianInt32();
            return new Size(width, height);
        }

        private static Size DecodeJfif(BinaryReader binaryReader)
        {
            while (binaryReader.ReadByte() == 0xff)
            {
                byte marker = binaryReader.ReadByte();
                short chunkLength = binaryReader.ReadLittleEndianInt16();

                if (marker == 0xc0)
                {
                    binaryReader.ReadByte();

                    int height = binaryReader.ReadLittleEndianInt16();
                    int width = binaryReader.ReadLittleEndianInt16();
                    return new Size(width, height);
                }

                binaryReader.ReadBytes(chunkLength - 2);
            }

            throw new ArgumentException(errorMessage);
        }
    }
} 
```

希望代码相当明显。要添加新的文件格式，请将其添加到`imageFormatDecoders`其中，键是“魔术位”数组，该数组出现在给定格式的每个文件的开头，值是从流中提取大小的函数。大多数格式都很简单，唯一真正令人讨厌的是 jpeg。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-03-13T15:31:09.923

```
using (FileStream file = new FileStream(this.ImageFileName, FileMode.Open, FileAccess.Read))
{
    using (Image tif = Image.FromStream(stream: file, 
                                        useEmbeddedColorManagement: false,
                                        validateImageData: false))
    {
        float width = tif.PhysicalDimension.Width;
        float height = tif.PhysicalDimension.Height;
        float hresolution = tif.HorizontalResolution;
        float vresolution = tif.VerticalResolution;
     }
} 
```

该`validateImageData`设置`false`可防止 GDI+ 对图像数据执行昂贵的分析，从而大大减少加载时间。 [这个问题](https://stackoverflow.com/questions/420337/validateimagedata-parameter-and-image-fromstream)更能说明这个问题。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-09-21T16:23:50.197

您是否尝试过使用 WPF Imaging 类？`System.Windows.Media.Imaging.BitmapDecoder`， ETC。？

我相信一些努力是为了确保那些编解码器只读取文件的一个子集以确定标题信息。值得一试。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-21T21:46:03.060

几个月前我正在寻找类似的东西。我想阅读 GIF 图像的类型、版本、高度和宽度，但在网上找不到任何有用的信息。

幸运的是，对于 GIF，所有必需的信息都在前 10 个字节中：

```
Type: Bytes 0-2
Version: Bytes 3-5
Height: Bytes 6-7
Width: Bytes 8-9 
```

PNG 稍微复杂一些（宽度和高度各为 4 字节）：

```
Width: Bytes 16-19
Height: Bytes 20-23 
```

如上所述，尽管[pnglib](http://www.libpng.org/pub/png/spec/1.1/PNG-Contents.html)中的 PNG 规范更为详细，但[wotsit](http://www.wotsit.org/)是一个提供图像和数据格式详细规范的好网站。但是，我认为关于[PNG](https://en.wikipedia.org/wiki/Portable_Network_Graphics)和[GIF](http://en.wikipedia.org/wiki/Graphics_Interchange_Format)格式的 Wikipedia 条目是最好的起点。

这是我检查 GIF 的原始代码，我还为 PNG 拼凑了一些东西：

```
using System;
using System.IO;
using System.Text;

public class ImageSizeTest
{
    public static void Main()
    {
        byte[] bytes = new byte[10];

        string gifFile = @"D:\Personal\Images&Pics\iProduct.gif";
        using (FileStream fs = File.OpenRead(gifFile))
        {
            fs.Read(bytes, 0, 10); // type (3 bytes), version (3 bytes), width (2 bytes), height (2 bytes)
        }
        displayGifInfo(bytes);

        string pngFile = @"D:\Personal\Images&Pics\WaveletsGamma.png";
        using (FileStream fs = File.OpenRead(pngFile))
        {
            fs.Seek(16, SeekOrigin.Begin); // jump to the 16th byte where width and height information is stored
            fs.Read(bytes, 0, 8); // width (4 bytes), height (4 bytes)
        }
        displayPngInfo(bytes);
    }

    public static void displayGifInfo(byte[] bytes)
    {
        string type = Encoding.ASCII.GetString(bytes, 0, 3);
        string version = Encoding.ASCII.GetString(bytes, 3, 3);

        int width = bytes[6] | bytes[7] << 8; // byte 6 and 7 contain the width but in network byte order so byte 7 has to be left-shifted 8 places and bit-masked to byte 6
        int height = bytes[8] | bytes[9] << 8; // same for height

        Console.WriteLine("GIF\nType: {0}\nVersion: {1}\nWidth: {2}\nHeight: {3}\n", type, version, width, height);
    }

    public static void displayPngInfo(byte[] bytes)
    {
        int width = 0, height = 0;

        for (int i = 0; i <= 3; i++)
        {
            width = bytes[i] | width << 8;
            height = bytes[i + 4] | height << 8;            
        }

        Console.WriteLine("PNG\nWidth: {0}\nHeight: {1}\n", width, height);  
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-22T05:36:34.427

根据到目前为止的答案和一些额外的搜索，在 .NET 2 类库中似乎没有它的功能。所以我决定自己写。这是它的一个非常粗略的版本。目前，我只需要它来处理 JPG。所以它完成了阿巴斯发布的答案。

没有错误检查或任何其他验证，但我目前需要它来完成有限的任务，并且最终可以轻松添加。我在一些图像上对其进行了测试，它通常不会从图像中读取超过 6K 的内容。我想这取决于 EXIF 数据的数量。

```
using System;
using System.IO;

namespace Test
{

    class Program
    {

        static bool GetJpegDimension(
            string fileName,
            out int width,
            out int height)
        {

            width = height = 0;
            bool found = false;
            bool eof = false;

            FileStream stream = new FileStream(
                fileName,
                FileMode.Open,
                FileAccess.Read);

            BinaryReader reader = new BinaryReader(stream);

            while (!found || eof)
            {

                // read 0xFF and the type
                reader.ReadByte();
                byte type = reader.ReadByte();

                // get length
                int len = 0;
                switch (type)
                {
                    // start and end of the image
                    case 0xD8: 
                    case 0xD9: 
                        len = 0;
                        break;

                    // restart interval
                    case 0xDD: 
                        len = 2;
                        break;

                    // the next two bytes is the length
                    default: 
                        int lenHi = reader.ReadByte();
                        int lenLo = reader.ReadByte();
                        len = (lenHi << 8 | lenLo) - 2;
                        break;
                }

                // EOF?
                if (type == 0xD9)
                    eof = true;

                // process the data
                if (len > 0)
                {

                    // read the data
                    byte[] data = reader.ReadBytes(len);

                    // this is what we are looking for
                    if (type == 0xC0)
                    {
                        width = data[1] << 8 | data[2];
                        height = data[3] << 8 | data[4];
                        found = true;
                    }

                }

            }

            reader.Close();
            stream.Close();

            return found;

        }

        static void Main(string[] args)
        {
            foreach (string file in Directory.GetFiles(args[0]))
            {
                int w, h;
                GetJpegDimension(file, out w, out h);
                System.Console.WriteLine(file + ": " + w + " x " + h);
            }
        }

    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-03-13T09:31:16.080

更新了 ICR 的答案以支持渐进式 jPegs 和 WebP :)

```
internal static class ImageHelper
{
    const string errorMessage = "Could not recognise image format.";

    private static Dictionary<byte[], Func<BinaryReader, Size>> imageFormatDecoders = new Dictionary<byte[], Func<BinaryReader, Size>>()
    {
        { new byte[] { 0x42, 0x4D }, DecodeBitmap },
        { new byte[] { 0x47, 0x49, 0x46, 0x38, 0x37, 0x61 }, DecodeGif },
        { new byte[] { 0x47, 0x49, 0x46, 0x38, 0x39, 0x61 }, DecodeGif },
        { new byte[] { 0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A }, DecodePng },
        { new byte[] { 0xff, 0xd8 }, DecodeJfif },
        { new byte[] { 0x52, 0x49, 0x46, 0x46 }, DecodeWebP },
    };

    /// <summary>        
    /// Gets the dimensions of an image.        
    /// </summary>        
    /// <param name="path">The path of the image to get the dimensions of.</param>        
    /// <returns>The dimensions of the specified image.</returns>        
    /// <exception cref="ArgumentException">The image was of an unrecognised format.</exception>            
    public static Size GetDimensions(BinaryReader binaryReader)
    {
        int maxMagicBytesLength = imageFormatDecoders.Keys.OrderByDescending(x => x.Length).First().Length;
        byte[] magicBytes = new byte[maxMagicBytesLength];
        for(int i = 0; i < maxMagicBytesLength; i += 1)
        {
            magicBytes[i] = binaryReader.ReadByte();
            foreach(var kvPair in imageFormatDecoders)
            {
                if(StartsWith(magicBytes, kvPair.Key))
                {
                    return kvPair.Value(binaryReader);
                }
            }
        }

        throw new ArgumentException(errorMessage, "binaryReader");
    }

    private static bool StartsWith(byte[] thisBytes, byte[] thatBytes)
    {
        for(int i = 0; i < thatBytes.Length; i += 1)
        {
            if(thisBytes[i] != thatBytes[i])
            {
                return false;
            }
        }

        return true;
    }

    private static short ReadLittleEndianInt16(BinaryReader binaryReader)
    {
        byte[] bytes = new byte[sizeof(short)];

        for(int i = 0; i < sizeof(short); i += 1)
        {
            bytes[sizeof(short) - 1 - i] = binaryReader.ReadByte();
        }
        return BitConverter.ToInt16(bytes, 0);
    }

    private static int ReadLittleEndianInt32(BinaryReader binaryReader)
    {
        byte[] bytes = new byte[sizeof(int)];
        for(int i = 0; i < sizeof(int); i += 1)
        {
            bytes[sizeof(int) - 1 - i] = binaryReader.ReadByte();
        }
        return BitConverter.ToInt32(bytes, 0);
    }

    private static Size DecodeBitmap(BinaryReader binaryReader)
    {
        binaryReader.ReadBytes(16);
        int width = binaryReader.ReadInt32();
        int height = binaryReader.ReadInt32();
        return new Size(width, height);
    }

    private static Size DecodeGif(BinaryReader binaryReader)
    {
        int width = binaryReader.ReadInt16();
        int height = binaryReader.ReadInt16();
        return new Size(width, height);
    }

    private static Size DecodePng(BinaryReader binaryReader)
    {
        binaryReader.ReadBytes(8);
        int width = ReadLittleEndianInt32(binaryReader);
        int height = ReadLittleEndianInt32(binaryReader);
        return new Size(width, height);
    }

    private static Size DecodeJfif(BinaryReader binaryReader)
    {
        while(binaryReader.ReadByte() == 0xff)
        {
            byte marker = binaryReader.ReadByte();
            short chunkLength = ReadLittleEndianInt16(binaryReader);
            if(marker == 0xc0 || marker == 0xc2) // c2: progressive
            {
                binaryReader.ReadByte();
                int height = ReadLittleEndianInt16(binaryReader);
                int width = ReadLittleEndianInt16(binaryReader);
                return new Size(width, height);
            }

            if(chunkLength < 0)
            {
                ushort uchunkLength = (ushort)chunkLength;
                binaryReader.ReadBytes(uchunkLength - 2);
            }
            else
            {
                binaryReader.ReadBytes(chunkLength - 2);
            }
        }

        throw new ArgumentException(errorMessage);
    }

    private static Size DecodeWebP(BinaryReader binaryReader)
    {
        binaryReader.ReadUInt32(); // Size
        binaryReader.ReadBytes(15); // WEBP, VP8 + more
        binaryReader.ReadBytes(3); // SYNC

        var width = binaryReader.ReadUInt16() & 0b00_11111111111111; // 14 bits width
        var height = binaryReader.ReadUInt16() & 0b00_11111111111111; // 14 bits height

        return new Size(width, height);
    }

} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-10-25T16:45:07.793

我为PNG文件做了这个

```
 var buff = new byte[32];
        using (var d =  File.OpenRead(file))
        {            
            d.Read(buff, 0, 32);
        }
        const int wOff = 16;
        const int hOff = 20;            
        var Widht =BitConverter.ToInt32(new[] {buff[wOff + 3], buff[wOff + 2], buff[wOff + 1], buff[wOff + 0],},0);
        var Height =BitConverter.ToInt32(new[] {buff[hOff + 3], buff[hOff + 2], buff[hOff + 1], buff[hOff + 0],},0); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-21T19:06:05.767

是的，您绝对可以这样做，并且代码取决于文件格式。我在一家成像供应商 ( [Atalasoft](http://www.atalasoft.com) ) 工作，我们的产品为每个编解码器提供了一个 GetImageInfo()，它可以最少地找出尺寸和其他一些易于获取的数据。

如果你想自己动手，我建议从[wotsit.org](http://wotsit.org)开始，它包含几乎所有图像格式的详细规范，你会看到如何识别文件以及在哪里可以找到其中的信息。

如果您习惯使用 C，那么免费的 jpeglib 也可以用来获取这些信息。我敢打赌，你可以用 .NET 库来做到这一点，但我不知道怎么做。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-21T16:42:48.967

这将取决于文件格式。通常他们会在文件的早期字节中说明它。而且，通常，一个好的图像读取实现会考虑到这一点。不过，我不能为您指出一个.NET。

# c# - 存在哪些基于 XNA 的 3D 地形和物理库？

> ID：111348
> 
> 赞同：9
> 
> 时间：2008-09-21T16:23:28.343
> 
> 标签：c#, xna, physics

我正计划创建一个游戏，其中包含一个带有物体的景观。景观将使用高度场定义，对象将在地形之上移动并飞越地形。如果你曾经玩过[Marble Madness](http://en.wikipedia.org/wiki/Marble_Madness)和[Virus/Zarch](http://en.wikipedia.org/wiki/Zarch)的老游戏，那就是我想要创造的那种复杂性和风格。

我在 Internet 上看到了各种物理引擎，以及一些关于如何将高度场渲染为地形的教程，但它们要么缺乏文档，要么对于我需要的东西来说似乎过于复杂。

我所需要的只是一种绘制高度场的方法，在其上放置 3D 对象，然后让它们滚下山丘，或在天空中飞来飞去。我不介意编写自己的代码来执行此操作，因此任何相关教程也会很好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-21T16:59:45.900

这是一个更完整的列表，Xbox、Zune 和 Windows...

*   [Farseer](http://www.codeplex.com/FarseerPhysics) - 仅限 2d。
*   [JigLibX](http://www.codeplex.com/JigLibX)
*   [子弹](http://bulletphysics.com/) 
    *   [子弹X](http://www.codeplex.com/xnadevru/Wiki/View.aspx?title=Managed%20Bullet%20Physics%20Library&referringTitle=Home)
    *   [XBAP](http://chriscavanagh.wordpress.com/2007/04/24/xbap-3d-physics-source/)
*   [哎呀！3D 物理框架](http:///)
*   [别府物理](http://www.bepu-games.com/BEPUphysics/)
*   [果冻物理学](http://walaber.com/index.php?action=showitem&id=16)
*   [Physics2D.Net](http://physics2d.googlepages.com/)

仅视窗...

*   [物理X](http://www.ageia.com/)
    *   [MS Robotics Studio 包装器](http://msdn2.microsoft.com/en-us/robotics/default.aspx)
    *   [PhysXdotNet 包装器](http://code.google.com/p/physxdotnet/)
*   [ODE（开放动态引擎）](http://ode.org/)
    *   [XPA（XNA 物理库）](http://www.codeplex.com/xnadevru/Wiki/View.aspx?title=XNA%20Physics%20API%20%28XPA%29&referringTitle=Home)
*   [牛顿游戏动力学](http://www.newtondynamics.com/)
    *   [牛顿物理端口到 XNA](http://www.tamedtornado.com/devblog/?p=58)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T17:04:29.413

如果您正在寻找更多的教程而不是完整的解决方案，您是否查看了[XNA 创建者网站上](http://creators.xna.com)的碰撞系列？

具体来说，[Collision Series 5：Heightmap Collision with Normals](http://creators.xna.com/en-us/sample/collision3dheightmapnormals)听起来正是您正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T16:48:35.693

查看[Newton Game Dynamics](http://www.newtondynamics.com/) ，他们的 XNA[物理引擎](http://www.tamedtornado.com/devblog/?p=58)有一个端口。唯一需要注意的是它只能在 Windows 下运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T12:23:44.740

查看 Matali 物理引擎。Matali Physics 是 XNA 的物理引擎。 [主页](http://www.mataliphysics.com)

# asp.net-mvc - 重定向到不同的控制器

> ID：111363
> 
> 赞同：4
> 
> 时间：2008-09-21T16:33:09.833
> 
> 标签：asp.net-mvc

我在 IAuthorizationFilter 中有一些代码将用户重定向到登录页面，但我无法更改使用的控制器。所以我可能会

```
public void OnAuthorization(AuthorizationContext context)
{
  UserController u = new UserController();
  context.Result = u.Login();
  context.Cancel = true;
 } 
```

但这导致

```
The view 'Login' or its master could not be found. The following locations were searched:
~/Views/Product/Login.aspx
~/Views/Product/Login.ascx
~/Views/Shared/Login.aspx
~/Views/Shared/Login.ascx 
```

我正在从产品控制器运行它。如何让视图引擎使用用户控制器而不是产品控制器？

* * *

编辑：我得到它的工作

```
RedirectResult r = new RedirectResult("../User.aspx/Login");
context.Result = r; 
context.Cancel = true; 
```

但这是一个杂块，我相信有更好的方法。ActionFilterAttribute 中暴露的很少，令人沮丧。如果在 AuthorizationContext 中公开的控制器暴露了 RedirectToAction ，这似乎很有用，这很容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T17:57:24.997

同意 ddc0660，你应该重定向。不要运行 u.Login()，而是将 context.Result 设置为 RedirectResult。

# javascript - 你如何对 JavaScript 代码进行性能测试？

> ID：111368
> 
> 赞同：368
> 
> 时间：2008-09-21T16:35:58.437
> 
> 标签：javascript, performance

CPU 周期、内存使用情况、执行时间等？

补充：除了对代码运行速度的感知之外，是否有量化的方法来测试 JavaScript 的性能？

* * *

## 回答 #1

> 赞同：351
> 
> 时间：2008-09-21T18:55:21.160

Profiler 绝对是获取数字的好方法，但根据我的经验，感知性能对用户/客户来说才是最重要的。例如，我们有一个带有 Ext 手风琴的项目，它扩展以显示一些数据，然后是一些嵌套的 Ext 网格。实际上一切都渲染得很快，没有一个操作需要很长时间，只是一次渲染了很多信息，所以用户感觉很慢。

我们“修复”了这个问题，不是通过切换到更快的组件或优化某些方法，而是通过首先渲染数据，然后使用 setTimeout 渲染网格。因此，信息首先出现，然后网格会在一秒钟后出现。总体而言，这样做需要更多的处理时间，但对用户而言，感知性能得到了改善。

* * *

如今，Chrome 分析器和其他工具已普遍可用且易于使用，如[`console.time()`](https://developers.google.com/web/tools/chrome-devtools/debug/console/console-reference#time)、[`console.profile()`](https://developers.google.com/web/tools/chrome-devtools/debug/console/console-reference#profile)和[`performance.now()`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now). Chrome 还为您提供时间线视图，它可以向您显示导致帧速率下降的原因、用户可能在哪里等待等。

查找所有这些工具的文档非常容易，您不需要 SO 答案。7 年后，我仍然会重复我最初答案的建议，并指出您可以让慢代码在用户不会注意到的地方永远运行，而在他们注意到的地方运行相当快的代码，他们会抱怨相当快的代码不够快。或者您对服务器 API 的请求花费了 220 毫秒。或者其他类似的东西。重点仍然是，如果您拿出分析器并寻找工作要做，您会找到它，但它可能不是您的用户需要的工作。

* * *

## 回答 #2

> 赞同：235
> 
> 时间：2013-07-30T09:41:33.760

I do agree that perceived performance is really all that matters. But sometimes I just want to find out which method of doing something is faster. Sometimes the difference is HUGE and worth knowing.

You could just use javascript timers. But I typically get much more consistent results using the native Chrome (now also in Firefox and Safari) devTool methods `console.time()` & `console.timeEnd()`

### Example of how I use it:

```
var iterations = 1000000;
console.time('Function #1');
for(var i = 0; i < iterations; i++ ){
    functionOne();
};
console.timeEnd('Function #1')

console.time('Function #2');
for(var i = 0; i < iterations; i++ ){
    functionTwo();
};
console.timeEnd('Function #2') 
```

![Results Look like this](https://i.stack.imgur.com/IVo6d.png)

### Update (4/4/2016):

Chrome canary recently added [Line Level Profiling](https://umaar.com/dev-tips/99-line-level-profiling/) the dev tools sources tab which let's you see exactly how long each line took to execute! [![enter image description here](https://i.stack.imgur.com/xYeBC.jpg)](https://i.stack.imgur.com/xYeBC.jpg)

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2010-03-31T06:01:31.060

我们总是可以**通过简单的日期对象来测量任何函数所花费的时间**。

```
var start = +new Date();  // log start timestamp
function1();
var end =  +new Date();  // log end timestamp
var diff = end - start; 
```

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2011-02-11T16:25:43.067

尝试[jsPerf](http://jsperf.com)。它是一个用于基准测试和比较代码片段的在线 javascript 性能工具。我用它所有的时间。

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2014-07-18T22:44:55.870

大多数浏览器现在都在`performance.now()`. 它优于`new Date()`性能测试，因为它独立于系统时钟运行。

**用法**

```
var start = performance.now();

// code being timed...

var duration = performance.now() - start; 
```

**参考**

*   [https://developer.mozilla.org/en-US/docs/Web/API/Performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance.now())
*   [http://www.w3.org/TR/hr-time/#dom-performance-now](http://www.w3.org/TR/hr-time/#dom-performance-now)

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2010-11-15T21:20:32.740

[JSLitmus](http://code.google.com/p/jslitmus/) is a lightweight tool for creating ad-hoc JavaScript benchmark tests

Let examine the performance between `function expression` and `function constructor`:

```
<script src="JSLitmus.js"></script>
<script>

JSLitmus.test("new Function ... ", function() { 
    return new Function("for(var i=0; i<100; i++) {}"); 
});

JSLitmus.test("function() ...", function() { 
       return (function() { for(var i=0; i<100; i++) {}  });
});

</script> 
```

What I did above is create a `function expression` and `function constructor` performing same operation. The result is as follows:

**FireFox Performance Result**

![FireFox Performance Result](https://i.stack.imgur.com/Oi4Wl.png)

**IE Performance Result**

![IE Performance Result](https://i.stack.imgur.com/7XCCD.png)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-09-21T16:50:03.723

有些人建议使用特定的插件和/或浏览器。我不会，因为它们只对那个平台*真正*有用；在 Firefox 上运行的测试不会准确地转换为 IE7。考虑到 99.999999% 的网站有多个浏览器访问它们，**您需要检查所有流行平台的性能。**

我的建议是将其保留在 JS 中。创建一个基准测试页面，其中包含所有 JS 测试并计时执行。您甚至可以让它通过 AJAX 将结果发送给您，以保持它完全自动化。

然后只需冲洗并在不同的平台上重复。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2012-05-19T22:38:24.590

这是一个简单的函数，显示传入函数的执行时间：

```
var perf = function(testName, fn) {
    var startTime = new Date().getTime();
    fn();
    var endTime = new Date().getTime();
    console.log(testName + ": " + (endTime - startTime) + "ms");
} 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2014-11-14T02:05:35.727

我有一个小工具，可以在浏览器中快速运行小型测试用例并立即获得结果：

[JavaScript 速度测试](https://duzun.me/playground/js_speed#c=%20%20%20%20%2F%2F%20A%20%3D%20new%20Array(n)%3B%0A%20%20%20%20for(var%20i%3D0%3B%20i%3Cn%3B%20i%2B%2B)%20%0A%20%20%20%20%20%20%20%20A%5Bi%5D%20%3D%20i*(i%2B1)%2F2%3B&d=console.log(A)&i=var%20A%20%3D%20%5B%5D%3B%0Avar%20n%20%3D%201000%3B&n=1000)

您可以使用代码并找出在测试浏览器中哪种技术更好。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-12-26T12:32:39.580

我认为 JavaScript 性能（时间）测试已经足够了。[我在这里找到了一篇关于 JavaScript 性能测试](http://jquery-howto.blogspot.com/2008/12/how-to-test-javascript-performance.html)的非常方便的文章。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-09-21T16:48:56.003

你可以使用这个： http: [//getfirebug.com/js.html](http://getfirebug.com/js.html)。它有一个用于 JavaScript 的分析器。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2020-12-08T10:55:22.547

[performance.mark (Chrome 87 ^)](https://developers.google.com/web/updates/2020/10/devtools?utm_source=devtools#perf-mark)

```
performance.mark('initSelect - start');
initSelect();
performance.mark('initSelect - end'); 
```

[![在此处输入图像描述](https://i.stack.imgur.com/fYkV2.png)](https://i.stack.imgur.com/fYkV2.png)

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2019-11-10T13:35:37.353

我正在寻找类似的东西，但发现了这个。

[https://jsbench.me/](https://jsbench.me/)

它允许进行横向比较，然后您还可以共享结果。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2014-06-10T19:57:41.030

**快速回答**

在 jQuery 上（更具体地说是在 Sizzle 上），我们使用[它](https://github.com/jquery/sizzle/tree/master/speed)（结帐大师并在您的浏览器上打开 speed/index.html），而后者又使用[benchmark.js](http://benchmarkjs.com/)。这用于对库进行性能测试。

**长答案**

如果读者不知道基准、工作负载和分析器之间的区别，请先阅读[spec.org 的“自述文件 1st”部分的](http://www.spec.org/cpu2006/Docs/readme1st.html#Q2)一些性能测试基础。这是用于系统测试的，但了解这些基础也将有助于 JS 性能测试。一些亮点：

> *什么是基准？*
> 
> 基准是“衡量或评估的标准”（韦氏词典）。计算机基准测试通常是一个计算机程序，它执行一组严格定义的操作 - 工作负载 - 并返回某种形式的结果 - 度量 - 描述测试计算机的执行情况。计算机基准指标通常衡量速度：工作负载完成的速度；或吞吐量：每单位时间完成了多少工作负载单元。在多台计算机上运行相同的计算机基准测试可以进行比较。
> 
> *我应该对自己的应用程序进行基准测试吗？*
> 
> 理想情况下，系统的最佳比较测试将是您自己的应用程序与您自己的工作负载。不幸的是，对于使用您自己的应用程序和您自己的工作负载的不同系统，获得广泛的可靠、可重复和可比较的测量结果通常是不切实际的。问题可能包括生成好的测试用例、保密问题、难以确保可比较的条件、时间、金钱或其他限制。
> 
> *如果不是我自己的应用程序，那又是什么？*
> 
> 您可能希望考虑使用标准化基准作为参考点。理想情况下，标准化的基准测试将是可移植的，并且可能已经在您感兴趣的平台上运行。但是，在考虑结果之前，您需要确保您了解应用程序/计算需求与基准是衡量。基准测试是否与您运行的应用程序类型相似？工作负载是否具有相似的特征？根据您对这些问题的回答，您可以开始了解基准如何接近您的实际情况。
> 
> 注意：标准化的基准可以作为参考点。然而，当您选择供应商或产品时，SPEC 并未声称任何标准化的基准测试都可以取代您自己的实际应用程序的基准测试。

**性能测试 JS**

理想情况下，最好的性能测试是使用您自己的应用程序和您自己的工作负载切换您需要测试的内容：不同的库、机器等。

如果这不可行（通常不可行）。第一个重要步骤：定义您的工作量。它应该反映您的应用程序的工作负载。在[本次演讲](https://www.youtube.com/watch?v=65-RbBwZQdU)中，Vyacheslav Egorov 谈到了您应该避免的糟糕工作负载。

然后，您可以使用 benchmark.js 之类的工具来帮助您收集指标，通常是速度或吞吐量。在 Sizzle 上，我们有兴趣比较修复或更改如何影响库的系统性能。

如果某些事情的表现真的很糟糕，那么下一步就是寻找瓶颈。

**如何找到瓶颈？分析器**

[分析 javascript 执行的最佳方法是什么？](https://stackoverflow.com/questions/855126/what-is-the-best-way-to-profile-javascript-execution)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-21T16:38:50.770

我发现执行时间是最好的衡量标准。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2012-09-04T11:21:57.197

你可以在 firebug 中使用[console.profile](http://getfirebug.com/logging)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-05-20T06:54:27.140

我通常只测试 javascript 性能，脚本运行多长时间。jQuery Lover 为测试[**javascript 代码性能**](http://jquery-howto.blogspot.com/2008/12/how-to-test-javascript-performance.html)提供了一个很好的文章链接，但该文章仅显示如何测试您的 javascript 代码运行多长时间。我还建议阅读名为“在处理大量数据集时[改进 jQuery 代码的5 个技巧”的文章。](http://jquery-howto.blogspot.com/2009/02/5-easy-tips-on-how-to-improve-code.html)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-01-12T20:24:25.617

这是一个用于时间性能的可重用类。示例包含在代码中：

```
/*
     Help track time lapse - tells you the time difference between each "check()" and since the "start()"

 */
var TimeCapture = function () {
    var start = new Date().getTime();
    var last = start;
    var now = start;
    this.start = function () {
        start = new Date().getTime();
    };
    this.check = function (message) {
        now = (new Date().getTime());
        console.log(message, 'START:', now - start, 'LAST:', now - last);
        last = now;
    };
};

//Example:
var time = new TimeCapture();
//begin tracking time
time.start();
//...do stuff
time.check('say something here')//look at your console for output
//..do more stuff
time.check('say something else')//look at your console for output
//..do more stuff
time.check('say something else one more time')//look at your console for output 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-06-12T08:41:10.453

[UX Profiler](https://chrome.google.com/webstore/detail/ux-profiler/pbggladnflcdnacpafmaahjemhnjmpjc)从用户的角度解决了这个问题。它将由某些用户操作（点击）引起的所有浏览器事件、网络活动等进行分组，并考虑到延迟、超时等所有方面。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-06-28T13:32:42.300

您可以使用[https://github.com/anywhichway/benchtest](https://github.com/anywhichway/benchtest)将现有的 Mocha 单元测试与性能测试结合起来。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-21T16:38:36.527

黄金法则是在任何情况下都不要锁定您的用户浏览器。在那之后，我通常会查看执行时间，然后是内存使用情况（除非你正在做一些疯狂的事情，在这种情况下它可能是更高的优先级）。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-05-24T23:17:13.260

性能测试最近成为了一个流行词，但这并不是说性能测试在 QA 中甚至在产品交付之后都不是一个重要的过程。当我开发应用程序时，我使用了许多不同的工具，其中一些像上面提到的[chrome Profiler](https://developers.google.com/web/tools/chrome-devtools/rendering-tools)我通常会查看 SaaS 或一些我可以开始并忘记它的开源工具，直到我收到警告说有些东西已经崩溃了.

有许多很棒的工具可以帮助您密切关注性能，而无需您为了设置一些基本警报而跳槽。这里有一些我认为值得自己检查的。

1.  Sematext.com
2.  数据狗网
3.  Uptime.com
4.  Smartbear.com
5.  Solarwinds.com

为了尝试画出更清晰的画面，[这里](https://dev.to/saigowthamr/how-to-setup-performance-monitoring-in-react-with-sematext-dk8)有一个关于如何为 React 应用程序设置监控的小教程。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2013-10-09T00:33:41.607

这是为特定操作收集性能信息的好方法。

```
start = new Date().getTime(); 
for (var n = 0; n < maxCount; n++) {
/* perform the operation to be measured *//
}
elapsed = new Date().getTime() - start;
assert(true,"Measured time: " + elapsed); 
```

# ssl - SSL 和 Kerberos 身份验证之间的区别？

> ID：111386
> 
> 赞同：55
> 
> 时间：2008-09-21T16:44:32.160
> 
> 标签：ssl, kerberos, traffic, netmon

我试图了解 SSL 和 Kerberos 身份验证之间的实际区别是什么，以及为什么有时我同时拥有 SSL 流量和 Kerberos。或者 Kerberos 是否以任何方式使用 SSL？

任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-09-21T20:06:44.547

SSL 使用公钥加密：

1.  您（或您的浏览器）有一个公钥/私钥对
2.  服务器也有一个公钥/私钥
3.  您生成一个对称会话密钥
4.  您使用服务器的公钥加密并将此加密的会话密钥发送到服务器。
5.  服务器使用其私钥解密加密的会话密钥。
6.  您和服务器开始使用对称会话密钥进行通信（主要是因为对称密钥更快）。

Kerberos 不使用公钥加密。它使用受信任的第 3 方。这是一个草图：

1.  你们（服务器和客户端）都向受信任的第 3 方（通过*秘密*）证明您的身份。
2.  当您想使用服务器时，您检查并查看服务器是否值得信赖。同时，服务器会检查您是否值得信赖。现在，相互确定对方的身份。您可以与服务器通信。2

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-09-21T19:11:52.277

虽然[Kerberos](https://en.wikipedia.org/wiki/Kerberos_(protocol))和[SSL](https://en.wikipedia.org/wiki/Transport_Layer_Security)都是协议，但 Kerberos 是身份验证协议，而 SSL 是加密协议。Kerberos 通常使用[UDP](https://en.wikipedia.org/wiki/User_Datagram_Protocol)， SSL 使用（大部分时间）[TCP](https://en.wikipedia.org/wiki/Transmission_Control_Protocol)。SSL 身份验证*通常*通过检查嵌入在称为[X.509 证书的东西中的服务器和客户端的](https://en.wikipedia.org/wiki/X.509)[RSA](https://en.wikipedia.org/wiki/RSA_(cryptosystem))或[ECDSA](https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm)密钥来完成。您已通过证书和相应的密钥进行身份验证。使用 Kerberos，您可以通过密码或其他方式进行身份验证。例如，在域中使用时，[Windows 使用 Kerberos 。](https://docs.microsoft.com/en-us/windows/win32/secauthn/microsoft-kerberos)

请记住：SSL 的最新版本称为传输层安全性 TLS。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-10-27T07:53:16.390

简而言之，Kerberos 是一种协议，用于通过受信任的第三方为客户端和服务器建立相互身份信任或身份验证，而 SSL 确保仅对服务器进行身份验证，并且只有在其公钥已经建立的情况下通过另一个渠道值得信赖。两者都提供服务器和客户端之间的安全通信。

更正式（但没有进入数学证明），给定客户端*C*、服务器*S和**C*和*S*都信任的第三方*T ：*

 **在 Kerbeos 身份验证之后，确定：

*   *C*认为*S*是它打算联系的人
*   *S*相信*C*就是它声称的那个人
*   *C*认为它与*S有安全连接*
*   *C*认为*S认为它与**C*有安全连接
**   *S*认为它与*C有安全连接**   *S*认为*C认为它与**S*有安全连接*

 **另一方面，SSL 仅确定：

*   *C*认为*S*是它打算联系的人
*   *C认为它与**S*有安全连接
**   *S认为它与**C*有安全连接*

 **显然，Kerberos 建立了更强大、更完整的信任关系。

此外，为了通过 SSL建立*S的身份，* *C需要关于**S*的先验知识，或者一种外部方式来确认这种信任。对于大多数人的日常使用，它以根证书的形式出现，并缓存*S*的证书以供将来交叉引用。

如果没有这些先验知识，SSL 很容易受到中间人攻击，其中第三方可以通过使用 2 个独立的安全通道将它们之间的通信中继到*C*和*S*来假装*S*到*C。*为了破坏 Kerberos 身份验证，窃听者必须伪装成*T*对*S*和*C*。但是请注意，根据 Kerberos 的目标，信任集仍然没有中断，因为根据前提条件“ *C*和*S*信任*T* ”，最终状态仍然是正确的。

 ***最后，正如评论中所指出的，Kerberos 可以并且已经被扩展为使用类似 SSL 的机制来建立*C*和*T*之间的初始安全连接。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-07-26T14:30:24.907

In short:

Kerberos usually does not encrypt transferring data, but SSL and TLS do.

> "there are no standard APIs for accessing these messages. As of Windows Vista, Microsoft does not provide a mechanism for user applications to produce KRB_PRIV or KRB_SAFE messages." - from [http://www.kerberos.org/software/appskerberos.pdf](http://www.kerberos.org/software/appskerberos.pdf)

In opposite, SSL and TLS usually do not transfer and proof Yours Windows domain login name to the server, but Kerberos does.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-21T16:55:56.033

简短的回答：SSL 和 Kerberos 都使用加密，但 SSL 使用在会话期间不变的密钥，而 Kerberos 使用多个密钥来加密客户端和客户端之间的通信。

在 SSL 中，加密由通信的两端直接处理，而在 Kerberos 中，加密密钥由客户端和服务器之间的第三方（某种中介）提供。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-02-03T15:58:04.707

来自[http://web.mit.edu/kerberos/](http://web.mit.edu/kerberos/)：Kerberos 由 MIT 创建，作为这些网络安全问题的解决方案。Kerberos 协议使用强加密，因此客户端可以通过不安全的网络连接向服务器证明其身份（反之亦然）。在客户端和服务器使用 Kerberos 证明他们的身份之后，他们还可以加密所有通信，以确保他们开展业务时的隐私和数据完整性。

同时： SSL 用于通过公钥加密建立服务器<-->服务器认证。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-04-14T09:21:03.183

来自[https://www.eldos.com/security/articles/7240.php?page=all](https://www.eldos.com/security/articles/7240.php?page=all)，

Kerberos 和 TLS 不是可以比较的东西。他们有不同的目标和不同的方法。在我们文章的开头，我们提到了“哪个更好”和“选择什么”等常见问题。前者根本不是问题：如果你以正确的方式使用它，没有什么是更好的，一切都是好的。后一个问题值得认真考虑：选择什么取决于您拥有什么和想要什么。

如果您想在没有人可以读取或篡改的意义上保护您的通信，也许正确的选择是使用 TLS 或其他一些基于它的协议。使用 TLS 保护 HTTP 承载的万维网流量的一个很好的例子是使用 HTTPS。对于安全文件传输，您可以使用 FTPS，并考虑到 SMTP（尽管它代表“简单”邮件传输协议，而不是“安全”）也可能受到 TLS 保护。

另一方面，如果您需要管理用户对服务的访问，您可能需要使用 Kerberos。例如，想象一下，您有多个服务器，如 Web 服务器、FTP、SMTP 和 SQL 服务器，以及可选的其他服务器，所有内容都在一台主机上。一些客户端允许使用 SMTP 和 HTTP，但不允许使用 FTP，其他客户端可能使用 FTP 但无权访问您的数据库。这正是 Kerberos 开始使用时的情况，您只需在 Authentication Server 中描述用户权限和管理策略。

# .net - 如何将二进制数据流式传输到 .NET 中的标准输出？

> ID：111387
> 
> 赞同：4
> 
> 时间：2008-09-21T16:45:17.150
> 
> 标签：.net, interop

我正在尝试将二进制数据流式传输到 .NET 中的标准输出。但是，您只能使用 Console 类编写 char 。我想将它与[重定向](http://en.wikipedia.org/wiki/Redirection_(Unix))一起使用。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-21T16:52:28.070

您可以使用 访问输出流`Console.OpenStandardOutput`。

```
 static void Main(string[] args) {
        MemoryStream data = new MemoryStream(Encoding.UTF8.GetBytes("Some data"));
        using (Stream console = Console.OpenStandardOutput()) {
            data.CopyTo(console);
        }
    } 
```

# .net - 类似谷歌金融的交互式图表控件的建议

> ID：111388
> 
> 赞同：12
> 
> 时间：2008-09-21T16:45:20.990
> 
> 标签：.net, charts, google-finance

我的基于 .NET 的 Web 应用程序需要某种交互式图表控件。我有一些宽 XY 图表，用户应该能够以交互方式滚动和放大 x 轴上的特定窗口。类似于谷歌财务控制的东西会很好，但不需要日期标签或新闻事件注释。另外，如果可能的话，我宁愿避免使用 Flash。有人可以就可能接近的东西提出一些建议吗？

编辑：“真正的”谷歌时间线可视化用于基于日期的数据。我只有数字数据。我尝试将该控件用于非日期数据，但它似乎总是想显示一个日期并要求第一个数据列实际上是一个日期。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-21T16:53:13.793

使用谷歌可视化项目中的“真正的”谷歌金融工具怎么样？

[http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html](http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-08-06T19:30:24.650

这是您正在寻找的那个。与 Google Flash 图表几乎完全匹配。

[http://www.humblesoftware.com/finance/index](http://www.humblesoftware.com/finance/index)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T13:18:23.420

看看[Google vizualisation API](http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html)，我猜这就是 Google 在 Google Finance 上使用的。我查看了其他一些图表 API，但这个是免费且美观的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-03T13:34:44.243

你可以试试[Flotr](http://solutoire.com/flotr/)，一个不错的 JavaScript 库。它具有相当不错的鼠标控件，并且可以免费使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T18:44:39.517

SoftwareFX 网站上的 Zoom Scrollbar 示例看起来像您正在寻找的内容：

[http://demo.softwarefx.com/chartfx/aspnet/ajaxsamples/](http://demo.softwarefx.com/chartfx/aspnet/ajaxsamples/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T07:56:00.300

查看[amCharts](http://www.amcharts.com)。有 XY 图表和股票图表。当然，这些是基于 Flash 的图表，但我认为这些天如果没有 Flash 或 Silverlight，您将无法拥有如此漂亮和互动的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-22T17:44:02.567

jqplot 令人印象深刻并且每天都在进步

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-26T21:27:36.760

为什么不使用这个克隆：

[http://code.google.com/p/time-series-graph/](http://code.google.com/p/time-series-graph/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-04-19T20:21:47.743

我想回复 knb 关于 Google 财经图表的评论，但似乎没有回复按钮。无论如何，根据这个：

[http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html#Data_Policy](http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html#Data_Policy)

没有数据发送到任何服务器，因此 Google 似乎没有获取任何数据。有人对这种情况有任何评论吗？如果担心 Google 拥有您的数据，是否最好在安全方面犯错而不使用它？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-03-12T06:31:26.563

[D3](https://d3js.org/)是一个很好的库，用于绘制非常丰富的 UI 图表。可以使用 D3 绘制像交互式图表一样的谷歌金融。

[在此处](https://observablehq.com/@d3/gallery)查找更多示例

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-21T17:20:37.800

我最近在我的 .NET 工作中使用了两个通用库 - 它们都有许多不同的图表类型，包括您所追求的缩放和滚动：一个是免费的 ( [ZedGraph](http://zedgraph.org/wiki/index.php?title=Main_Page) )，另一个不是 ( [Dundas](http://www.dundas.com/) )。

我很乐意推荐他们两个。Dundas 更好 - 但它并不便宜。Zed 是开源的，因此只需阅读代码就可以提供相当丰富的信息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-07-14T15:49:17.077

[HighCharts](http://www.highcharts.com/stock/demo/)（仅限商业许可证）有一个纯粹的 JS 金融，就像图表看起来不错。不过，它目前处于测试阶段。

# ruby-on-rails - 向现有 Rails 项目添加测试的最佳方式？

> ID：111389
> 
> 赞同：17
> 
> 时间：2008-09-21T16:46:29.037
> 
> 标签：ruby-on-rails, ruby, testing

我有一个 Rails 项目，我忽略了构建测试（真遗憾！）并且代码库已经变得相当大。我的一个朋友说 RSpec 使用起来很痛苦，除非你从一开始就使用它。这是真的？是什么让他这么说？

所以，考虑到可用的测试套件和代码库已经存在的事实，让这个东西可测试的最佳行动方案是什么？真的和从一开始就做的有那么大的不同吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-21T17:43:33.267

这个问题[最近](http://www.ruby-forum.com/topic/164025#new)出现在 RSpec 邮件列表中，我们通常给出的建议是：

*   除非您要更改它，否则不要费心尝试将规范改装到现有的、工作的代码中——这很累人，除非需要更改代码，否则毫无意义。
*   从现在开始为您所做的任何更改编写规范。错误修复是一个特别好的机会。
*   尝试训练自己遵循这样的原则：在接触代码之前，首先编写一个失败的示例 (=spec) 来推动更改。

您可能会发现，没有被代码示例或单元测试驱动的代码设计使得编写测试或规范变得很尴尬。这可能是你朋友所暗示的。你几乎肯定需要学习一些关键的重构技术来分解依赖关系，这样你就可以独立于你的规范来练习每个类。Michael Feathers 的优秀著作《[有效地使用遗留代码》](http://www.amazon.co.uk/Working-Effectively-Legacy-Robert-Martin/dp/0131177052)提供了一些很好的材料来帮助您学习这项微妙的技能。

我还鼓励您使用内置的 spec:rcov rake 任务来生成代码覆盖率统计信息。当你开始测试你的代码库时，看着这些数字上升是非常有益的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T17:14:12.370

也许从模型开始？它们应该是可单独测试的，这应该使它们成为最容易实现的目标。

然后选择一个模型并开始编写测试来说明它的作用。随着您的进行，请考虑其他测试代码的方法——是否存在您不确定的边缘情况？编写测试并查看模型的行为方式。在开发测试时，您可能会看到代码中的区域不像它们可能的那样干净和重复数据删除 (DRY)。现在你有了测试，你可以重构代码，因为你知道你不会影响行为。在测试到位之前，尽量不要开始改进设计——那样就很疯狂。

固定模型后，向上移动。

这是一种方式。替代方案可能从视图或控制器开始，但您可能会发现从端到端事务测试开始更容易，并且随着您的进行逐渐变得越来越小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T05:50:45.937

公认的答案是很好的建议——尽管在某些情况下并不实用。我最近在我的一些应用程序上遇到了这个问题，因为我需要对现有代码进行测试。根本没有其他办法。

我开始做所有的单元测试，然后转向功能。

养成为任何新代码编写失败测试的习惯，或者每当您要更改系统的一部分时。我发现这有助于我在进行过程中获得更多的测试知识。

使用 rcov 来衡量您的进度。

祝你好运！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T08:51:27.797

为现有代码编写测试可能会揭示代码中的错误。这些测试将迫使您查看现有代码，以便您了解需要编写哪些测试才能使其通过，并且您可能会看到一些可能编写得更好或现在无用的代码。

另一个技巧是在遇到错误时编写测试，这样它就不会再次发生，这称为回归测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T17:58:39.860

改装规格并非不可避免地是个坏主意。您可以从工作代码转到具有已知属性的工作代码，这使您可以了解未来的任何更改是否会破坏任何内容。目前，如果您需要进行更改，您如何知道它会影响什么？

人们说很难向现有代码添加测试/规范时的意思是，难以测试的代码通常是高度耦合的，这使得编写低级隔离测试变得困难。

一个想法是从使用 RSpec 故事运行器之类的东西开始全栈测试。然后，您可以从“由外而内”隔离低级别隔离测试中的内容，并逐步解开更难的代码。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-01-06T02:24:00.330

您可以开始编写“表征测试”。[有了这个，你可能会在这里](https://github.com/jedld/pretentious)尝试自命不凡的宝石：

不过，它仍在进行中。

# java - 域对象和简单的 JavaBean 是否应该进行单元测试？

> ID：111390
> 
> 赞同：11
> 
> 时间：2008-09-21T16:46:50.783
> 
> 标签：java, unit-testing

应该对只有简单 getter 和 setter 的简单 JavaBean 进行单元测试吗？

在 getter 和 setter 中有一些逻辑的 Beans 怎么样？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-21T18:33:34.647

您不应该编写以下测试：

*   测试语言或 IDE（即自动生成的 getter 和 setter）
*   没有为您的测试工具增加任何价值，并扼杀您对单元测试的热情

这同样适用于仅具有属性的 .NET 对象（有时称为“信息”对象）。

在理想情况下，您将拥有 100% 的测试覆盖率，但实际上这不会发生。因此，将客户的钱花在最能带来好处的地方，即为具有复杂状态和行为的类编写测试。

如果您的 JavaBean 变得更有趣，您当然可以稍后添加一个测试用例。与单元测试/TDD 相关的常见问题之一是错误地认为一切都必须在第一次完美。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-21T17:02:39.467

如果不值得测试，就不值得写。

这并不总是意味着您应该编写测试。有时这意味着您应该删除代码。你需要这些豆子吗？他们真的做任何重要的事情吗？如果你需要它们，你应该编写测试。如果没有，请删除代码并过上更幸福的生活，因为知道您需要维护的东西更少。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-21T17:33:45.117

我认为这是每个人都会问自己（她自己）的问题之一。

但是考虑一下：访问器的内部逻辑现在非常简单，但它可能会在未来发生变化，而且 - 这更重要 - 如果您对方法进行测试，您可以随意将其更改为您想要的任何内容。因此，您可以通过几个测试用例获得自由和信心。听起来很划算，对吧？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-23T07:18:27.077

另一个经验法则（类似于其他人所说的）是“测试任何可能破坏的东西”。对我来说，这不包括自动生成的 getter 和 setter，但包括包含一些逻辑的手写的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-21T18:00:46.020

如何安全地重构未经测试的代码？如果您没有测试，当您的 bean pojo 发生变化时会发生什么？您是否正在创建[贫血域模型](http://www.martinfowler.com/bliki/AnemicDomainModel.html)？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-21T17:03:56.780

你只需要测试你想要正常工作的东西。

（对不起，我从谁那里偷了那句话）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-21T18:24:58.690

你应该测试一些有意义的东西。Getter 和 setter 通常不包含任何逻辑，只是在 Java 中用于缺少属性。我认为测试它们就像每次评估“ax”时检查Java是否返回一个值一样愚蠢。

如果访问器确实有逻辑，则由您决定阈值。如果你的团队很懒惰。最好测试所有逻辑。如果它更有纪律，最好找到一个不会让你编写太多样板测试的比率。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-21T17:58:39.003

如果它只是一个 getter/setter 而不改变任何值，我会说不需要测试。如果它确实做了一些逻辑，一些简单的单元测试将提供一些安全性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-22T07:04:14.840

就像 Maxim 已经说过的：进行测试不会为您的应用程序添加额外的功能，但会让您更有信心地进行更改。为了确定应该对哪些类/方法进行单元测试，我总是问自己两个问题：

*   这段代码是否与整体功能相关？
*   这段代码可能会在此应用程序的整个生命周期内发生变化吗？

如果两个问题的回答都是肯定的，则需要进行单元测试。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-22T16:32:52.383

在我看来，写单元测试的目的是测试被测单元的业务逻辑。因此，如果没有业务逻辑（例如，当 getter 简单地返回一个值或 setter 设置它时），那么编写测试没有意义。但是，如果有一些逻辑（getter 在返回数据之前以某种方式更改数据），那么是的，您应该进行单元测试。作为一般规则，我认为不应该为不包含任何业务逻辑的 bean 编写测试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-22T16:45:22.383

如果它有一个外部接口并且包含一个人编写的代码（而不是由 IDE 或编译器自动生成），那么它肯定应该被测试。

如果这些条件中的一个或两个不成立，那么它就是一个灰色区域，归结为更多的“腰带和吊带”类型的问题，即你觉得需要多小心。

# c++ - 如果多个不同的接受套接字使用相同的 OpenSSL 上下文，会不会有问题？

> ID：111391
> 
> 赞同：1
> 
> 时间：2008-09-21T16:47:18.207
> 
> 标签：c++, ssl, openssl, boost-asio

如果几个不同的接受套接字使用相同的 OpenSSL 上下文是否可以？

特别是我使用相同的 boost::asio::ssl::context 和 2 个不同的监听套接字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T16:51:31.613

是的，SSL_CTX——我相信它是底层数据结构——只是你的程序使用的全局数据结构。从 ssl(3):

> **SSL_CTX（SSL 上下文）**
> 
> 这是由服务器或客户端在每个程序生命周期中创建一次的全局上下文结构，它主要保存稍后为连接创建的 SSL 结构的默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T16:53:11.970

应该没问题。

例如，典型的 RFC4217 FTPS 服务器将为控制套接字和该会话中的所有数据套接字使用相同的 SSL 上下文。

# windows-vista - Windows Vista 上的 Miktex

> ID：111405
> 
> 赞同：0
> 
> 时间：2008-09-21T16:57:07.763
> 
> 标签：windows-vista, crash, miktex

我在安装在 Windows Vista Business SP1/32 位上的 Miktex 有一些问题。我使用 miktex 2.7、ghostscript 和 texniccenter 1 beta 7.50。当我使用以下配置文件编译文档时： Latex=>DVI, Latex=>PDF 一切正常；当我使用配置文件 Latex=>PS 和 Latex=>PS=>PDF 编译时系统崩溃。该错误会报告到一个窗口中，该窗口显示：“Dvi-to-Postscript 转换器已停止工作”。我能做些什么？我需要 Latex=>PS=>PDF 将我的图像包含到最终的 PDF 中。

在此先感谢，还有另一个 LaTeX 用户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-21T17:35:57.077

如果您需要的只是图像，您仍然可以直接编译为 PDF。你只需要一张PNG或JPG格式的图片，并使用以下代码：

```
%in the document preamble
\usepackage{graphicx}

%in the document, in the place where you want to put your image
\includegraphics{image_filename_without_extension} 
```

当图像是PNG或JPG文件时（还有一些，我不记得哪个ATM了），你可以用pdfLaTeX编译文件，但不能用普通的LaTeX编译（即你可以生成PDF，但不能生成DVI或 PS）。
当然，通常情况下，如果一切正常，最好将图像的一个副本保存在 EPS 中，另一个保存在例如 PNG 中——这样您就可以轻松地编译为 PDF 和 PS。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T10:35:07.097

谢谢您的回复。我已经解决了这个问题：dvi 崩溃了，因为我安装了 Miktex 并启用了用户帐户控制。我已经禁用它，重新安装，现在它可以工作了（UAC 仍然被禁用）。

# javascript - 如何解决在 jQuery 中使用 slideToggle 时出现的闪烁问题？

> ID：111407
> 
> 赞同：12
> 
> 时间：2008-09-21T16:57:53.160
> 
> 标签：javascript, jquery

我有一个简单的无序列表，我想使用 jQuery slideUp 和 slideDown 效果在点击时显示和隐藏。一切似乎都运行良好，但在 IE6 中，列表会向上滑动，闪烁片刻，然后消失。

有谁知道解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-07-21T04:20:40.020

为额外的评论道歉（我不能对 Pavel 的回答投赞成票或评论），但添加 DOCTYPE 为我解决了这个问题，并且 slideUp/Down/Toggle 效果现在在 IE7 中正常工作。

有关DOCTYPES 的更多信息，请参阅[A List Apart ，或者您可以尝试指定相当宽松的 4/Transitional：](http://www.alistapart.com/articles/doctype/)

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd"> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-21T18:41:44.843

让IE6闪烁。当您的基本功能运行良好时，我认为在垂死的浏览器上投入时间是不值得的。如果您出于可访问性原因担心闪烁，只需嗅探 IE6 并将动画替换为通用 show() 和 hide() 代替。对于无关紧要的边缘情况，我建议避免使用复杂的代码。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-21T17:00:16.100

```
$(document).ready(function() {
    // Fix background image caching problem
    if (jQuery.browser.msie) {
        try { 
            document.execCommand("BackgroundImageCache", false, true); 
        } catch(err) {}
    }
}; 
```

[显然](http://osdir.com/ml/lang.javascript.jquery/2006-09/msg01932.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T19:23:13.697

Oli 的修复似乎只适用于闪烁的背景，但这里并非如此。

Ryan McGeary 的建议是可靠的，除非客户/您的老板绝对要求 IE6 不要表现得像胎儿酒精综合症一样。

我在这里找到了解决方案：[Slide effect bugs in IE 6 and 7 since version 1.1.3](http://groups.google.com/group/jquery-dev/browse_thread/thread/85c2d334fae35d85)

在文件顶部添加了一个 doctype 声明（为什么以前不在那里？谁知道！）并且闪烁消失了，再也看不到了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-03-03T19:07:16.193

根据我所听到和尝试的（包括此处的其他建议），仍然存在闪烁会继续明显的情况，尤其是当您无法选择轻松退出怪癖模式时。就我而言，我现在必须保持怪癖模式，其他建议仍然没有为我解决问题。我最终添加了一些解决方法，直到我们终于可以离开怪癖模式：

```
//Start the slideUp effect lasting 500ms
$('#element').slideUp(500);

//Abort the effect just before it finishes and force hide()
//I had to play with the timeout interval until I found one that
// looked exactly right. 400ms worked for me.
setTimeout(function() {
    $('#element').stop(true, true).hide(); 
}, 400); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-25T07:13:24.243

此代码不依赖于浏览器（无浏览器检测），效果很好并重现了方法 .slideUp 的行为

```
$("#element").animate({
     height: 1,          // Avoiding sliding to 0px (flash on IE)
     paddingTop: "hide",
     paddingBottom: "hide"
     })
     // Then hide
     .animate({display:"hide"},{queue:true}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-10-26T07:37:28.360

不知道是否有人会阅读此答案，但对于像我这样无法在页面中添加文档类型（感谢 Sharepoint 2007 默认模板）而不花费几天时间进行完整模板修订的人来说，这是一种解决方法。

在没有 DOCTYPE 的文档上，当元素高度达到 0 时会发生闪烁。所以我发现的解决方法是将元素设置为 1px 的高度，而不是 0。

像这样：

```
$(".slider").click(function (e) {
   $(this).animate({"height" : "1px"});
}); 
```

希望它会有所帮助。

注意：不要忘记，为了滑动元素，您必须事先以某种方式存储其初始高度（节点属性、rel 属性破解等）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-10-08T20:19:51.403

我正在使用在一些背景幻灯片上带有标记副本的轮播。幻灯片过渡是淡入淡出。到目前为止一切都很好。

但是幻灯片加载后，副本的某些部分会淡入。然后在幻灯片过渡之前淡出。此副本是一个无序列表的链接 ( `UL > LI*2 > A`)，在幻灯片背景上淡入。这也适用于*除 IE 之外*的所有浏览器。IE 在 UL 上有一个闪烁的背景。

发生的事情是同时运行两个淡入：幻灯片上的背景图像和 UL。在幻灯片完成加载后，我使用了[sergio 的](https://stackoverflow.com/users/21420/sergiopereira)原型设计**setTimeout函数来运行 UL fadeIn()。**然后，我在 UL fadeOut() 之后调用了另一个 setTimeout 来进行幻灯片转换。

**setTimeout**是您对抗 IE 闪烁时的朋友。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-02-24T14:35:04.097

我们今天遇到了同样的问题。不仅在 IE6 中，在 IE8 中也一样！我已经通过使用超时来**稍微隐藏 div来修复它：**

```
var pane = $('.ColorPane');
var speed = 500;
window.setTimeout(function() { pane.css('display', 'none'); }, speed - 100);
pane.slideUp(speed); 
```

希望它可以帮助你们中的一些人。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-24T20:17:36.130

我在[http://blog.clintonbeattie.com/how-to-solve-the-jquery-flickering-content-problem/上发布了一个快速修复解决方案](http://blog.clintonbeattie.com/how-to-solve-the-jquery-flickering-content-problem/)

简而言之，将溢出：隐藏添加到您正在滑入/滑出的包含元素。希望这可以帮助！

# .net - 如何配置 asp.net 进程在域帐户下运行？

> ID：111410
> 
> 赞同：6
> 
> 时间：2008-09-21T17:00:27.037
> 
> 标签：.net, asp.net, iis-6

我想将 asp.net 进程配置为在具有域凭据的帐户下运行。我的要求是访问网络共享上的一些文件。

这有什么步骤？我可以使用任何内置帐户吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-21T17:06:16.103

从 MSDN 检查这篇文章。

[如何：为 ASP.NET 2.0 应用程序创建服务帐户](http://msdn.microsoft.com/en-us/library/ms998297.aspx)

*本操作指南向您展示如何创建和配置自定义最低权限服务帐户以运行 ASP.NET Web 应用程序。默认情况下，Microsoft Windows Server 2003 和 IIS 6.0 上的 ASP.NET 应用程序使用内置的网络服务帐户运行。在生产环境中，您通常使用自定义服务帐户运行您的应用程序。通过使用自定义服务帐户，您可以独立于其他人审核和授权您的应用程序，并且您的应用程序受到保护，不会对与网络服务帐户关联的特权或权限进行任何更改。要使用自定义服务帐户，您必须通过运行带有 -ga 开关的 Aspnet_regiis.exe 实用程序来配置该帐户，然后将您的应用程序配置为在使用自定义帐户身份的自定义应用程序池中运行。*

# vb.net - Visual Studio 2008 VB.NET Express Edition 中的“信息未找到”页面

> ID：111411
> 
> 赞同：0
> 
> 时间：2008-09-21T17:00:32.967
> 
> 标签：vb.net, visual-studio, documentation

我正在尝试使用 VS 2008 Express 版本，当我在关键字或类名上按 f1 时，我似乎在 90% 以上的时间都得到了“未找到信息”页面。

这是配置问题吗？是因为这是“免费啤酒”特快版吗？自我下载的版本以来，Microsoft 是否移动了他们的在线文档？

我有点惊讶，这是他们旗舰开发产品的演示，它似乎缺少几乎任何类型的集成参考文档。Visual Studio 中的集成帮助如何工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T17:13:59.547

请记住，用于 Visual Studio 的*完整*MSDN 库非常庞大——目前它是 2GB——因此它作为单独的下载提供。

似乎有一个*300MB*的简化版本，尽管我建议您在安装该版本时时不时地看到“信息不可用”消息。

[您可以从MSDN](http://www.microsoft.com/express/download/msdn/Default.aspx)免费获得它们。

就我个人而言，我已经安装了完整版，但如果您不想下载 MSDN，您可以通过执行以下操作打开在线帮助：

> 在您的 Visual Studio 产品中，从应用程序菜单中选择工具 -> 选项。然后在选项对话框中选择环境 -> 帮助 -> 在线。在“加载帮助内容时”下选择“先在线尝试，然后在本地尝试”，然后单击“确定”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-21T17:11:14.983

您是否使用 express 版安装了 MSDN 库？你需要 ：）

如果您只想要一切，您还可以下载 MSDN 文档的完整版本。

文档完全免费。

你有什么版本的 express，然后我可以将你重定向到完整文档的链接，但是对于 express 版本（更小，但有你需要的东西），你需要再次运行安装程序，并添加 MSDN 库在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T17:31:39.877

使用“以管理员身份运行”选项运行 Microsoft Visual Studio 2008 文档。应该关闭visual studio，然后检查所有设置。关闭然后在visual studio中尝试，它现在应该可以工作了

# c++ - 奇怪的调用堆栈，会不会是asio使用openssl的问题？

> ID：111415
> 
> 赞同：1
> 
> 时间：2008-09-21T17:02:35.863
> 
> 标签：c++, boost, ssl, openssl, boost-asio

我有这个奇怪的调用堆栈，我很难理解为什么。

在我看来，asio 调用 open ssl 的 read 然后得到一个负返回值 (-37) 。

Asio 似乎随后尝试在 memcpy 函数中使用它。

导致此调用堆栈的函数被使用了数百次而没有此错误。

它很少发生，大约每周一次。

```
ulRead = (boost::asio::read(spCon->socket(), boost::asio::buffer(_requestHeader, _requestHeader.size()), boost::asio::transfer_at_least(_requestHeader.size()), error_)); 
```

请注意，请求标头的大小始终为 3 个字节。

任何人都可以阐明可能的原因吗？

注意：我使用的是 boost asio 1.36

这是由于巨大的“计数”而在 memcpy 中发生的崩溃调用堆栈崩溃：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T17:27:34.117

快速查看 evp_lib.c 表明它试图从密码上下文中提取一个长度，并且在您的情况下得到一个非常糟糕的值（tm）。然后它使用这个值来复制一个字符串（执行 memcpy）。我的猜测是某些东西正在破坏您的密码，可能是线程安全问题，或者是读取的字节数超过了允许的缓冲区。

[相关来源](http://google.com/codesearch?hl=en&q=show:_xVlO8chB2g:XjlEV0kP4tQ:47QgajN6ofA&sa=N&ct=rd&cs_p=http%3A//www.openssl.org/source/openssl-0.9.7j.tar.gz&cs_f=openssl-0.9.7j/crypto/evp/evp_lib.c)：

```
int EVP_CIPHER_set_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
{
int i=0,j;

if (type != NULL)
    {
    j=EVP_CIPHER_CTX_iv_length(c);
    OPENSSL_assert(j <= sizeof c->iv);
    i=ASN1_TYPE_set_octetstring(type,c->oiv,j);
    }
return(i);
} 
```

# asp.net - Response.Write() 和 Response.Output.Write() 有什么区别？

> ID：111417
> 
> 赞同：7
> 
> 时间：2008-09-21T17:02:59.293
> 
> 标签：asp.net, response.write

`Response.Write()`和有什么区别`Response.Output.Write()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T17:09:15.457

实际上没有区别，尽管`Response.Output.Write()`提供了更多允许您传递不同参数的重载。Scott Hansleman[深入](http://www.hanselman.com/blog/ASPNETResponseWriteAndResponseOutputWriteKnowTheDifference.aspx)探讨了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T17:17:09.337

它们都使用 a 写入输出流`TextWriter`（不是直接写入 Stream），但是 using`HttpContext.Response.Output.Write`提供了更多的重载（Framework 2.0 中的 17 个，包括格式化选项）比`HttpContext.Response.Write`（只有 4 个没有格式化选项）。

该`HttpResponse`类型不允许直接“设置”访问其输出流。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T17:07:27.037

真的没什么。

但。`Response.Write`获取`Response.Output`属性中的流。您可以设置另一个输出流，并且以这种方式而不是写回客户端，可能会写入文件或一些疯狂的东西。所以这就是关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-12T05:20:56.083

`Response.Output.Write()`：用于显示任何类型的数据，如int、日期、字符串等。即显示格式化输出。

`Response.Write()`：仅显示字符串类型的数据，即无法显示格式化的输出（）。

要显示格式化的输出，`Response.Write()`您可以编写：

```
Response.Write(String.Format("    ",___)); 
```

# .net - 如何在 VB.NET 中设置线条的粗细

> ID：111424
> 
> 赞同：5
> 
> 时间：2008-09-21T17:07:23.947
> 
> 标签：.net, vb.net, drawing

在 VB.NET 中，我正在使用类似这样的代码绘制一个椭圆。

```
 aPen = New Pen(Color.Black)
 g.DrawEllipse(aPen, n.boxLeft, n.boxTop, n.getWidth(), n.getHeight) 
```

但我想设置线条的粗细。我该怎么做？它是 Pen 的属性还是 DrawEllipse 方法的参数？

（注意：出于某种原因，帮助是 VisualStudio 让我失望了，所以无论如何我都必须上网。我想我会先在这里尝试。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-21T17:09:49.277

使用笔的`Width`属性。

```
aPen.Width = 10.0F 
```

# theory - 你在现实生活中应用了计算复杂性理论吗？

> ID：111426
> 
> 赞同：25
> 
> 时间：2008-09-21T17:08:28.000
> 
> 标签：theory, complexity-theory

我正在学习计算复杂性课程，到目前为止，我的印象是它对开发人员没有太大帮助。

我可能是错的，但如果你以前走这条路，你能否提供一个例子来说明复杂性理论如何帮助你的工作？非常感谢。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-21T19:41:53.577

O(1)：没有循环的纯代码。只是流过。查找表中的查找也是 O(1)。

O(log(n))：有效优化的算法。示例：二叉树算法和二叉搜索。一般不会疼。如果你手头有这样的算法，你会很幸运。

O(n)：数据的单个循环。伤害非常大的 n。

O(n*log(n))：一种执行某种分而治之策略的算法。对大 n 有害。典型例子：归并排序

O(n*n)：某种嵌套循环。即使 n 很小也会很痛。常见于朴素矩阵计算。如果可以的话，你想避免这种算法。

O(n^x for x>2)：具有多个嵌套循环的邪恶结构。伤害非常小的 n。

O(x^n, n! 甚至更糟)：你不希望在生产代码中使用怪异的（通常是递归的）算法，除非在非常受控的情况下，对于非常小的 n 并且如果真的没有更好的选择。计算时间可能会在 n=n+1 时爆炸式增长。

将你的算法从更高复杂度的类中下移可以使你的算法飞起来。想想傅里叶变换，它的 O(n*n) 算法在 1960 年代的硬件上无法使用，除非在极少数情况下。然后 Cooley 和 Tukey 通过重新使用已经计算的值，巧妙地降低了复杂性。这导致 FFT 广泛应用于信号处理。最后，这也是史蒂夫乔布斯通过 iPod 发财的原因。

简单的例子：天真的 C 程序员编写这种循环：

```
for (int cnt=0; cnt < strlen(s) ; cnt++) {
  /* some code */
} 
```

由于 strlen() 的实现，这是一个 O(n*n) 算法。嵌套循环会导致 big-O 内部的复杂性成倍增加。O(n) 内的 O(n) 给出 O(n*n)。O(n) 内的 O(n^3) 给出 O(n^4)。在示例中，预先计算字符串长度将立即将循环变为 O(n)。[乔尔也写过这个。](http://www.joelonsoftware.com/articles/fog0000000319.html)

然而，复杂性类别并不是一切。你必须留意 n 的大小。如果（现在是线性）指令的数量由于返工而大量增长，将 O(n*log(n)) 算法返工为 O(n) 将无济于事。如果 n 仍然很小，那么优化也不会产生太大的影响。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-21T17:39:37.567

尽管对算法复杂性一无所知，但确实可以在软件开发中走得很远。我发现我一直在使用我对复杂性的了解；但是，在这一点上，它通常是没有意识到的。作为软件开发人员，学习复杂性为您提供的两件事是一种比较做同样事情的非相似算法的方法（排序算法是典型的例子，但大多数人实际上并没有编写自己的排序算法）。它为您提供的更有用的东西是一种快速描述算法的方法。

例如，考虑 SQL。每天都有大量程序员使用 SQL。如果您看到以下查询，如果您研究过复杂性，那么您对查询的理解就会大不相同。

```
SELECT User.*, COUNT(Order.*) OrderCount FROM User Join Order ON User.UserId = Order.UserId 
```

如果您研究过复杂性，那么您会理解是否有人说某个 DBMS 的复杂性是 O(n^2)。如果没有复杂性理论，这个人将不得不解释表扫描等。如果我们在 Order 表中添加索引

```
CREATE INDEX ORDER_USERID ON Order(UserId) 
```

那么上面的查询可能是 O(n log n)，这对于大型 DB 会产生巨大的影响，但对于小型 DB，它根本不算什么。

有人可能会争辩说，理解数据库如何工作不需要复杂性理论，而且它们是正确的，但复杂性理论提供了一种语言来思考和讨论处理数据的算法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-21T17:28:50.697

对于大多数类型的编程工作，理论部分和证明本身可能没有用，但他们正在做的是尝试给你一种能够立即说“这个算法是 O(n^2) 所以我们可以”的直觉不要在这 100 万个数据点上运行它”。即使在对大量数据进行最基本的处理时，您也会遇到这种情况。

在业务数据处理、GIS、图形编程和理解算法方面，快速思考复杂性理论对我来说很重要。与您通常自学的内容相比，这是您可以从 CS 学习中获得的最有用的课程之一。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-21T20:15:09.517

计算机并不聪明，它们会按照你的指示去做。编译器可以为您优化代码，但不能优化算法。人脑的工作方式不同，这就是为什么您需要了解大 O。考虑计算斐波那契数。我们都知道 F(n) = F(n-1) + F(n-2)，从 1,1 开始，您可以在线性时间内轻松计算出以下数字。但是如果你告诉计算机用那个公式（递归地）计算它，它就不是线性的（至少，在命令式语言中）。不知何故，我们的大脑优化了算法，但编译器无法做到这一点。因此，您必须**研究****算法**以使其更好。

然后，您需要进行培训，以发现看起来如此明显的大脑优化，查看代码何时可能无效，了解坏算法和好算法的模式（就计算复杂性而言）等等。基本上，这些课程有几件事：

*   了解执行模式和数据结构以及它们对您的程序需要完成的时间有什么影响；
*   当算法在大型数据集上可能效率低下时，训练您的思维来发现算法中的潜在问题。或者了解分析的结果；
*   学习通过降低计算复杂度来改进算法的众所周知的方法；
*   准备自己通过酷公司的面试:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-21T17:17:46.980

这是极其重要的。如果您不了解如何估计和计算出您的算法需要运行多长时间，那么您最终会编写一些非常慢的代码。在编写算法时，我一直在考虑计算复杂性。编程时应该始终牢记这一点。

在许多情况下尤其如此，因为虽然您的应用程序可以在具有小型测试数据集的台式计算机上正常运行，但重要的是要了解您的应用程序在投入使用后的响应速度，并且有数十万人使用它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-22T15:18:36.930

是的，我经常使用 Big-O 符号，或者更确切地说，我使用它背后的思维过程，而不是符号本身。主要是因为组织中很少有开发人员我经常理解它。我并不是要对那些人不尊重，但根据我的经验，对这些东西的了解是“区分男人和男孩”的事情之一。

我想知道这是否是那些只能得到“是”答案的问题之一？让我印象深刻的是，理解计算复杂性的那群人大致相当于认为它很重要的那群人。因此，任何可能回答“否”的人都可能不理解这个问题，因此会跳到下一个问题而不是停下来回答。只是一个想法 ;-）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-21T17:16:28.247

在某些时间点，您将面临需要考虑的问题。有许多现实世界的问题需要处理大量数据......

例子是：

*   地图应用程序......如谷歌地图 - 您将如何处理全球道路线数据并绘制它们？你需要快速绘制它们！
*   物流应用......想想旅行推销员的类固醇
*   数据挖掘...所有大企业都需要一个，你如何挖掘一个包含 100 个表和 10m+ 行的数据库，并在趋势过时之前得出有用的结果？

参加计算复杂性课程将帮助您分析和选择/创建对此类场景有效的算法。

相信我，像减小系数这样简单的事情，比如从 T(3n) 到 T(2n)，当“n”以天（如果不是几个月）来衡量时，会产生巨大的差异。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T15:29:01.007

这里有很多很好的建议，我敢肯定大多数程序员偶尔会使用他们的复杂性知识。

但是我应该说理解计算复杂性在游戏领域是极其重要的！是的，你听说过，“无用”的东西是游戏编程赖以生存的东西。

我敢打赌，很少有专业人士可能像游戏程序员那样关心 Big-O。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-28T10:55:20.497

我经常使用复杂度计算，主要是因为我在地理空间领域工作，数据集非常大，例如涉及数百万甚至数十亿笛卡尔坐标的过程。一旦你开始遇到多维问题，复杂性可能是一个真正的问题，因为贪心算法在一个维度上是 O(n)，在三个维度上会突然跳到 O(n^3)，而且它不需要太多数据造成严重的瓶颈。[正如我在类似的帖子](https://stackoverflow.com/questions/133008/what-is-big-o-notation-do-you-use-it#143916)中提到的，当您开始处理不同大小的复杂对象组时，您还会看到大 O 表示法变得很麻烦。[复杂性的顺序也可能非常依赖于数据，对于精心设计的ad hoc](http://en.wikipedia.org/wiki/Ad_hoc)算法，典型案例的性能比一般案例要好得多。

在分析器下测试您的算法以查看您的设计是否是您所取得的成果也是值得的。我发现由于所有明显的原因，通过算法调整比提高处理器速度更好地解决了大多数瓶颈。

有关一般算法及其复杂性的更多阅读，我发现[Sedgewicks 的工作内容](http://www.cs.princeton.edu/~rs/)丰富且易于访问。对于空间算法，[O'Rourkes](http://maven.smith.edu/~orourke/)关于计算几何的书非常出色。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-02T00:04:04.710

在您的正常生活中，您应该应用复杂性和并行处理的概念，而不是靠近计算机。这将使您更有效率。缓存一致性。之类的东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-21T17:16:01.757

一个很好的例子是当你的老板告诉你做一些程序时，你可以使用计算复杂性理论来证明你老板要求你做的事情是不可能的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-21T17:28:10.170

是的，有一天当我不得不对一堆学生考试进行排序时，我对排序算法的了解派上了用场。我使用了归并排序（但不是快速排序或堆排序）。编程时，我只使用库提供的任何排序例程。（还没有对大量数据进行排序。）

我确实一直在编程中使用复杂性理论，主要用于决定使用哪些数据结构，但也用于决定是否或何时对事物进行排序，以及许多其他决策。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-21T17:41:40.713

“**是**”和“**不是**”

**是**的）我在开发和实现算法时经常使用[大 O 表示法。](http://en.wikipedia.org/wiki/O_notation)例如，当您应该处理 10^3 个项目并且第一个算法的复杂度为 O(n log(n)) 而第二个算法的复杂度为 O(n^3) 时，您可以简单地说第一个算法几乎是实时的，而第二个算法需要大量的计算。

有时关于[NP 复杂性类](http://en.wikipedia.org/wiki/Complexity_classes_P_and_NP)的知识可能很有用。它可以帮助您意识到，当某些 NP 完全问题可以简化为您正在考虑的问题时，您可以停止考虑发明有效的算法。

**不**）我上面描述的只是复杂性理论的一小部分。因此很难说我使用它，我使用它的次要部分。

我应该承认，有许多软件开发项目没有涉及算法开发或以复杂的方式使用它们。在这种情况下，复杂性理论是无用的。算法的普通用户经常使用“快”和“慢”、“x 秒”等词进行操作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-22T17:23:01.967

@Martin：您能否详细说明其背后的思维过程？

它可能不像坐下来为解决方案制定 Big-O 表示法那么明确，但它会产生对问题的意识 - 并引导您寻找更有效的答案并远离您可能采取的方法中的问题. 例如 O(n*n) 与更快的东西例如搜索存储在列表中的单词与存储在 trie 中的单词（人为示例）

我发现这对我将选择使用的数据结构以及我将如何处理大量记录产生了影响。

# gcc - 哪个 gcc 开关禁用“逗号的左操作数无效”警告？

> ID：111432
> 
> 赞同：0
> 
> 时间：2008-09-21T17:11:11.940
> 
> 标签：gcc, warnings

它是更大代码库的一部分，它在 gcc 上强制执行 -Werror。此警告是在不应更改的第三方代码中生成的（我实际上知道如何修复它），但我可以禁用特定警告。这次 man gcc 让我失望了，所以请让一些 gcc 高手赐教。TIA。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-21T17:16:43.613

它是*-Wno-unused-value*选项，请参阅[文档](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-21T18:41:15.640

如果您使用 -fdiagnostics-show-option，GCC 将告诉您如何禁用警告（如果可能）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T17:18:31.533

您是否尝试过使用[诊断编译指示](http://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html)指令？我相信这些在 gcc 4.2.1+ 中可用。

# php - 如何在 PHP 中获取 Subversion 修订号？

> ID：111436
> 
> 赞同：30
> 
> 时间：2008-09-21T17:13:35.163
> 
> 标签：php, svn, revision

我想让我的 PHP 应用程序标有它使用的修订号，但我不想使用[CruiseControl](http://en.wikipedia.org/wiki/CruiseControl)或更新文件并每次都上传它。我该怎么做？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-09-22T16:44:40.390

SVN 关键字不是一个好的解决方案。正如其他人指出的那样，在文件中添加 $Revision$ 只会影响**特定的文件**，它可能很长一段时间都不会改变。

记住在每次提交之前“编辑”一个文件（通过添加或删除一个空行）是没有意义的。您也可以手动键入修订版本。

一个好方法（我知道）是有一个自动化的部署过程（这总是一件好事）并使用命令 svnversion。这是我所做的：

无论我在哪里需要修订，我都会做一个包括：`<?php include 'version.php'; ?>`. 这个“version.php”文件只有修订号。此外，它不是存储库的一部分（它被设置为被忽略）。这是我创建它的方法：

1）在服务器上安装了SVN的项目上，我也用它来部署。获取服务器的最新版本我有一个脚本，除其他外，它执行以下操作（它在服务器上运行）：

```
cd /var/www/project
svn update
rm version.php
svnversion > version.php 
```

2）在未安装 SVN 的项目上，我的部署脚本更复杂：它在本地创建 version.php 文件，压缩代码，上传并提取它

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-21T17:20:56.177

假设您的 webroot 是 subversion 树的签出副本，您可以解析 /.svn/entries 文件并勾出修订号（此处为第 4 行）...

在 PHP 中：

```
$svn = File('.svn/entries');
$svnrev = $svn[3];
unset($svn); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-07-01T16:53:03.577

这就是我让它工作的方式。如果您的服务器设置为允许[shell_exec](http://php.net/manual/en/function.shell-exec.php)并且您安装了 SVN，则只需运行：

```
$revision = `svnversion`; 
```

或者

```
$revision = shell_exec('svnversion'); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-21T17:22:42.867

从[这个答案](https://stackoverflow.com/questions/163/how-do-i-sync-the-svn-revision-number-with-my-aspnet-web-site#166)：

> 您可以通过在代码中的任何位置添加以下内容来做到这一点

```
$Id:$ 
```

> 例如，杰夫做了：

```
<div id="svnrevision">svn revision: $Id:$</div> 
```

> 并在服务器签入时将 $Id:$ 替换为当前修订号。我也找到[了这个参考](http://www.compuphase.com/svnrev.htm)。
> 
> 还有 $Date:$, $Rev:$, $Revision:$

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-04-28T09:25:20.203

现在有点晚了，但使用 Subversion 提交后挂钩。在存储库的 hooks 文件夹中，创建一个类似这样的 shell 脚本：

```
#!/bin/bash

REPOS="$1"
REV="$2"

cd /web/root
rm -f /web/root/templates/base.html
/usr/bin/svn update
/bin/sed -i s/REVISION/$REV/ /web/root/templates/base.html 
```

这个特定示例假设您的实时站点位于 /web/root 中，并且开发代码保存在其他位置。当您提交开发更改时，脚本会删除先前的实时模板（以避免冲突消息），运行更新并将模板中出现的 REVISION 替换为实际的修订号。

更多关于钩子[的信息](http://svnbook.red-bean.com/nightly/en/svn.reposadmin.create.html#svn.reposadmin.create.hooks)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-21T17:23:37.980

在大多数情况下，服务器上的代码实际上将包含代码的“导出”，而不是结帐，因此不包含 .svn 文件夹。至少这是我最常看到的设置。其他人是否真的将他们的代码检查到 Web 服务器上？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-21T17:25:03.810

最简单的方法是使用 Subversion 的“Keyword Substitution”。SVN 书中有一个指南（*[带有 Subversion 的版本控制](http://svnbook.red-bean.com/)*[）](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.keywords.html)。

您基本上只需在文件中的某处添加文本 $Rev$。然后在您的存储库中启用关键字。结帐时，SVN 会将修订号替换到文件中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-21T17:27:54.880

您可以接近[SVN 关键字](http://svnbook.red-bean.com/en/1.4/svn.advanced.props.special.keywords.html)。在您希望显示修订的位置添加 $Revision$，但这只会显示特定文件更改的最后一个修订，因此您每次都必须对文件进行更改。如果没有某种外部脚本或提交后挂钩，就无法获取全局修订号。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-11-27T14:47:40.157

你也可以这样做：

```
$status = @shell_exec('svnversion '.realpath(__FILE__));
if ( preg_match('/\d+/', $status, $match) ) {
    echo 'Revision: '.$match[0];
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-03-03T18:45:10.723

请参阅我对类似问题*[“Mark” svn export with revision](https://stackoverflow.com/questions/975083/mark-svn-export-with-revision/2373900#2373900)*的回复。

如果您在导出时捕获修订号，您可以使用：

```
svn export /path/to/repository | grep ^Exported > revision.txt 
```

要去除除修订号以外的所有内容，您可以通过以下 sed 命令对其进行管道传输：

```
svn export /path/to/repository | grep ^Exported | sed 's/^[^0-9]\+\([0-9]\+\).*/\1/' > revision.txt 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-09-29T07:41:15.303

```
$svn_rev=file_get_contents('/path.to.repository/db/current'); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-11-27T14:32:01.017

另一种可能的方法是运行一个 cron 来执行“部署过程”中描述的步骤（假设它是一个 *nix/FreeBSD 服务器）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-01-28T20:05:08.550

如果性能是一个问题，那么你可以这样做：

```
exec('svn info /path/to/repository', $output);
$svn_ver = (int) trim(substr($output[4], strpos($output[4], ':'))); 
```

这当然取决于您是否进行了结帐，以及 svn 命令的存在。

# php - 如何使用 php 检测机器是否安装了 oracle（oci8 和/或 pdo_oci）？

> ID：111440
> 
> 赞同：6
> 
> 时间：2008-09-21T17:14:17.143
> 
> 标签：php, oracle

如果机器安装了oracle，如何使用php检测`(oci8 and/or pdo_oci)`？

我正在做一个`PHP`项目，一些开发人员，比如我自己，已经安装了它，但几乎不需要他们安装它。我如何编写一个快速函数以在代码中使用，以便我的用户能够在网站的外观上工作而不会崩溃？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T17:28:06.567

如果未安装 oci 扩展，那么您将在 farside.myopenid.com 的答案中遇到致命错误，您可以使用 function_exists('oci_connect') 或 extension_loaded('oci8') （或任何实际调用的扩展）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T20:29:17.237

这里的人们有一些解决方案，但让我们将它们全部整合到一个解决方案中。

对于一个 oracle 函数的单个实例，测试`function_exists()`就足够了；但是，如果代码被洒在 OCI 调用中，那么将每个代码都包含在`function_exists()`测试中将是一件非常痛苦的事情。

因此，我认为最简单的解决方案是创建一个名为*nodatabase.php*的文件，它可能看起来像这样：

```
<?php
// nodatabase.php
// explicitly override database functions with empty stubs. Only include this file
// when you want to run the code without an actual database backend. Any database-
// related functions used in the codebase must be included below.
function oci_connect($user, $password, $db = '', $charset='UTF-8', $session_mode=null)
{
}

function oci_execute($statement, $mode=0)
{
}
// and so on... 
```

然后，如果在调用数据库代码的位置之前定义了全局（例如 THEME_TESTING），则有条件地包含此文件。这样的包含可能如下所示：

```
// define("THEME_TESTING", true) // uncomment this line to disable database usage
if( defined(THEME_TESTING) )
  include('nodatabase.php'); // override oracle API with stub functions for the artists. 
```

现在，当您将项目交给艺术家时，他们只需要进行一次修改就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T17:23:26.437

我不知道我是否完全理解你的问题，但一个简单的方法是这样做：

```
<?php
  $connection = oci_connect('username', 'password', 'table');
  if (!$connection) {
    // no OCI connection.
  }
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T19:51:25.970

正如 Greg 上面提到的，您可以通过编程方式使用 function_exists() 方法。不要忘记，您还可以使用以下命令查看 PHP 安装的所有环境细节：

```
<?php
phpinfo();
?> 
```

# security - Kerberos 和 T125 协议

> ID：111451
> 
> 赞同：1
> 
> 时间：2008-09-21T17:17:26.433
> 
> 标签：security, authentication, kerberos, http-authentication

为什么 Kerberos 身份验证使用 T125 协议？我相信 Kerberos 身份验证的行为方式如下：

*   客户向 Kerberos 授权请求一张票
*   Kerberos 授权向客户端提供票证
*   客户端尝试向服务器进行身份验证并将此票证发送到服务器。
*   服务器通过 Kerberos 授权验证票证是否正常，并对客户端进行身份验证。

现在，在这个过程中，在哪里使用了 T125，为什么？
客户端是否在尝试访问（例如：对于每个 HTTP GET 页面）时向服务器发送票证，并且服务器随时检查此票证，还是在“对话”开始时只检查一次？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T18:06:28.563

不熟悉 T125，但您的 Kerberos 流有点偏离。
大致：

1.  用户向 KDC 进行身份验证（Kerberos 权限）
2.  KDC 授予用户一个 TGT（票证授予票证）
3.  用户尝试访问服务器
4.  服务器要求服务器票，向用户发送一些信息（以识别服务器）
5.  用户向 KDC 索要服务器票证，发送 TGT 和服务器信息
6.  KDC 向用户颁发服务器票证
7.  用户在每次访问时向用户提交服务器票证。

我知道我没有直接回答您的 T125 问题，但我希望这对您有所帮助。

# .net - .Net 8 位编码

> ID：111460
> 
> 赞同：8
> 
> 时间：2008-09-21T17:21:19.623
> 
> 标签：.net, encoding

我正在研究串行端口，以 8 位数据向某些硬件发送和接收数据。我想将其存储为字符串以方便比较，预设数据以字符串或十六进制格式存储在xml文件中。我发现只有在使用 Encoding.Default （即 ANSI 编码）时，8 位数据才能正确转换且易于可逆。ASCII 编码只适用于 7 位数据，而 UTF8 或 UTF7 也不能很好地工作，因为我使用的是 1-255 中的一些字符。Encoding.Default 会很好，但我在 MSDN 上读到它取决于操作系统代码页设置，这意味着它在配置的不同代码页上可能表现不同。我使用编码广泛使用 GetBytes() 和 GetString，但希望有一种故障安全且可移植的方法，该方法在任何配置下始终有效。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-21T17:56:18.370

Latin-1 aka ISO-8859-1 aka codepage 28591 是此场景的有用代码页，因为它映射 128-255 范围内的值不变。以下是可以互换的：

```
Encoding.GetEncoding(28591)
Encoding.GetEncoding("Latin1")
Encoding.GetEncoding("iso-8859-1") 
```

以下代码说明了这样一个事实，即对于 Latin1，与 Encoding.Default 不同，0-255 范围内的所有字符都被映射为不变：

```
static void Main(string[] args)
{

    Console.WriteLine("Test Default Encoding returned {0}", TestEncoding(Encoding.Default));
    Console.WriteLine("Test Latin1 Encoding returned {0}", TestEncoding(Encoding.GetEncoding("Latin1")));
    Console.ReadLine();
    return;
}

private static bool CompareBytes(char[] chars, byte[] bytes)
{
    bool result = true;
    if (chars.Length != bytes.Length)
    {
        Console.WriteLine("Length mismatch {0} bytes and {1} chars" + bytes.Length, chars.Length);
        return false;
    }
    for (int i = 0; i < chars.Length; i++)
    {
        int charValue = (int)chars[i];
        if (charValue != (int)bytes[i])
        {
            Console.WriteLine("Byte at index {0} value {1:X4} does not match char {2:X4}", i, (int) bytes[i], charValue);
            result = false;
        }
    }
    return result;
}
private static bool TestEncoding(Encoding encoding)
{
    byte[] inputBytes = new byte[256];
    for (int i = 0; i < 256; i++)
    {
        inputBytes[i] = (byte) i;
    }

    char[] outputChars = encoding.GetChars(inputBytes);
    Console.WriteLine("Comparing input bytes and output chars");
    if (!CompareBytes(outputChars, inputBytes)) return false;

    byte[] outputBytes = encoding.GetBytes(outputChars);
    Console.WriteLine("Comparing output bytes and output chars");
    if (!CompareBytes(outputChars, outputBytes)) return false;

    return true;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-21T17:23:53.050

为什么不直接使用字节数组呢？它不会有您在使用文本方法时可能遇到的任何编码问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-21T17:51:49.783

我认为您应该改用字节数组。为了比较，您可以使用如下方法：

```
static bool CompareRange(byte[] a, byte[] b, int index, int count)
{
    bool res = true;
    for(int i = index; i < index + count; i++)
    {
        res &= a[i] == b[i];
    }
    return res;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T17:44:13.157

~~使用适用于 Windows-1255 的希伯来语代码页。它的 8 位。
编码 enc = Encoding.GetEncoding("windows-1255");~~

当您写“1-255”时，我误会了您，以为您在哪里引用代码页 1255 中的字符。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-21T17:37:36.650

您可以使用 base64 编码将字节转换为字符串并返回。这样代码页或奇怪的字符没有问题，而且它比十六进制更节省空间。

```
byte[] toEncode; 
string encoded = System.Convert.ToBase64String(toEncode); 
```

# c# - 自动实现的 getter 和 setter 与公共字段

> ID：111461
> 
> 赞同：80
> 
> 时间：2008-09-21T17:22:23.490
> 
> 标签：c#, oop, properties, field

我看到很多用于执行此操作的 C# 类的示例代码：

```
public class Point {
    public int x { get; set; }
    public int y { get; set; }
} 
```

或者，在旧代码中，同样具有显式私有支持值且没有新的自动实现属性：

```
public class Point {
    private int _x;
    private int _y;

    public int x {
        get { return _x; }
        set { _x = value; }
    }

    public int y {
        get { return _y; }
        set { _y = value; }
    }
} 
```

我的问题是为什么。执行上述操作与仅将这些成员设为公共字段（如下所示）之间是否有任何功能差异？

```
public class Point {
    public int x;
    public int y;
} 
```

需要明确的是，当您需要对基础数据进行一些转换时，我理解 getter 和 setter 的价值。但是在您只是传递值的情况下，这似乎是不必要的冗长。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-09-21T17:29:26.907

我倾向于同意（这似乎是不必要的冗长），尽管这是我们团队尚未解决的问题，因此我们的编码标准仍然坚持所有类的详细属性。

[杰夫阿特伍德](https://blog.codinghorror.com/properties-vs-public-variables/)几年前处理过这个问题。他回顾性指出的最重要的一点是，从字段更改为属性是代码中的[重大更改。](http://blogs.msdn.com/abhinaba/archive/2006/04/11/572694.aspx)任何消耗它的东西都必须重新编译才能使用新的类接口，所以如果你无法控制的任何东西正在消耗你的类，你可能会遇到问题。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-21T17:28:18.903

稍后将其更改为这样也更简单：

```
public int x { get; private set; } 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-21T17:26:08.100

它封装了这些成员的设置和访问。如果从现在开始，代码的开发人员需要在访问或设置成员时更改逻辑，则可以在不更改类合同的情况下完成。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-21T17:42:05.877

这个想法是即使底层数据结构需要改变，类的公共接口也不必改变。

C# 有时可以以不同的方式处理属性和变量。例如，您[不能将属性作为 ref 或 out 参数传递](http://msdn.microsoft.com/en-us/library/w86s7x04.aspx)。因此，如果您出于某种原因需要更改数据结构并且您正在使用公共变量并且现在您需要使用属性，那么您的接口将不得不更改并且现在访问属性 x 的代码可能不再像它是变量时那样编译X：

```
Point pt = new Point();
if(Int32.TryParse(userInput, out pt.x))
{
     Console.WriteLine("x = {0}", pt.x);
     Console.WriteLine("x must be a public variable! Otherwise, this won't compile.");
} 
```

从一开始就使用属性可以避免这种情况，您可以根据需要随意调整底层实现，而不会破坏客户端代码。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-22T14:22:29.987

Setter 和 Getter 使您能够添加额外的抽象层，并且在纯 OOP 中，您应该始终通过对象提供给外部世界的接口来访问对象......

考虑一下这段代码，它将把你保存在 asp.net 中，如果没有 setter 和 getter 提供的抽象级别，这是不可能的：

```
class SomeControl
{

private string _SomeProperty  ;
public string SomeProperty 
{
  if ( _SomeProperty == null ) 
   return (string)Session [ "SomeProperty" ] ;
 else 
   return _SomeProperty ; 
}
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-09-08T01:42:19.117

由于自动实现的 getter 对属性和实际的私有存储变量采用相同的名称。以后怎么改？我认为要说的重点是使用自动实现而不是字段，以便将来如果您需要向 getter 和 setter 添加逻辑，则可以更改它。

例如：

```
public string x { get; set; } 
```

例如，您已经多次使用 x 并且您不想破坏您的代码。

您如何更改自动获取器设置器...例如对于设置器，您只允许设置有效的电话号码格式...您如何更改代码以便只更改类？

我的想法是添加一个新的私有变量并添加相同的 x getter 和 setter。

```
private string _x;

public string x { 
    get {return _x}; 
    set {
        if (Datetime.TryParse(value)) {
            _x = value;
        }
    }; 
} 
```

这就是你说的让它灵活的意思吗？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-21T17:50:42.050

在绑定和序列化方面，还需要考虑更改对公共成员的影响。这两者通常都依赖公共属性来检索和设置值。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-09-08T01:45:53.663

此外，您可以在 getter 和 setter 上设置断点，但不能在字段上设置断点。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-21T17:44:17.307

AFAIK 生成的 CIL 接口不同。如果您将公共成员更改为属性，则您正在更改它的公共接口，并且需要重新构建使用该类的每个文件。如果您只更改 getter 和 setter 的实现，则不需要这样做。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-21T17:55:23.473

也许只是公开领域，你可以引导你到一个更[贫血的领域模型](http://www.martinfowler.com/bliki/AnemicDomainModel.html)。

亲切的问候

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-09-08T02:10:55.137

还值得注意的是，您不能将 Auto Properties 设为 Readonly，也不能内联初始化它们。这两个都是我希望在 .NET 的未来版本中看到的东西，但我相信你在 .NET 4.0 中都做不到。

这些天，我唯一一次使用带有属性的支持字段是当我的类实现 INotifyPropertyChanged 并且我需要在属性更改时触发 OnPropertyChanged 事件。

同样在这些情况下，我在从构造函数传入值时直接设置支持字段（无需尝试触发 OnPropertyChangedEvent（此时无论如何都会为 NULL），在我使用属性本身的其他任何地方。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-21T17:26:41.093

您永远不知道以后是否需要对数据进行一些翻译。如果你隐藏你的成员，你就准备好了。如果您添加翻译，您班级的用户不会注意到，因为界面保持不变。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-21T17:27:14.540

最大的区别是，如果你改变了你的内部结构，你仍然可以保持 getter 和 setter 的原样，改变它们的内部逻辑而不会伤害你的 API 的用户。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-21T17:31:57.197

如果在这种情况下必须更改获取 x 和 y 的方式，则可以稍后添加属性。这是我觉得最令人困惑的地方。如果您使用公共成员变量，您可以稍后轻松地将其更改为属性，如果您需要在内部存储值，则可以使用名为 _x 和 _y 的私有变量。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-23T20:58:57.570

原则上，setter 和 getter 是不好的（它们是一种糟糕的 OO 气味——我不会说它们是一种反模式，因为它们有时确实是必要的）。

不，从技术上讲没有区别，当我现在真的想共享对对象的访问时，我偶尔会将其设为 public final 而不是添加 getter。

setter 和 getter 被“出售”的方式是，您可能需要知道某人正在获取一个值或更改一个值 - 这仅对原语有意义。

属性包对象（如 DAO、DTO 和显示对象）被排除在此规则之外，因为这些不是对象一词的真正“OO 设计”含义中的对象。（您不会想到“向 DTO 或 bean 传递消息”——这些只是设计上的一堆属性/值对）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-11-19T10:35:36.477

> 为什么我们不只是使用公共字段而不是使用属性然后在我们不需要进行验证时调用访问器（get，set）？

1.  属性是提供灵活机制以只读或只写的成员
2.  可以覆盖属性，但不能覆盖字段。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-01-18T03:21:16.830

添加 getter 和 setter 使变量成为在 Wpf/C# 中工作的属性。

如果它只是一个公共成员变量，则无法从 XAML 访问它，因为它不是属性（即使它的公共成员变量）。

如果它有 setter 和 getter，那么它可以从 XAML 访问，因为它现在是一个属性。

# c++ - 为什么将 std::auto_ptr<> 与标准容器一起使用是错误的？

> ID：111478
> 
> 赞同：222
> 
> 时间：2008-09-21T17:27:28.360
> 
> 标签：c++, stl, raii, auto-ptr, c++-faq

为什么使用`std::auto_ptr<>`标准容器是错误的？

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2008-09-21T17:47:35.863

C++ 标准规定 STL 元素必须是“可复制构造的”和“可赋值的”。换句话说，一个元素必须能够被分配或复制，并且这两个元素在逻辑上是独立的。`std::auto_ptr`不满足这个要求。

以这段代码为例：

```
class X
{
};

std::vector<std::auto_ptr<X> > vecX;
vecX.push_back(new X);

std::auto_ptr<X> pX = vecX[0];  // vecX[0] is assigned NULL. 
```

要克服此限制，如果您没有 C++11 ，则应使用[`std::unique_ptr`](http://msdn.microsoft.com/en-us/library/ee410601.aspx)、[`std::shared_ptr`](http://msdn.microsoft.com/en-us/library/bb982026.aspx)或智能指针或 boost 等效项。[这是这些智能指针的 boost 库文档。](http://www.boost.org/doc/libs/1_54_0/libs/smart_ptr/smart_ptr.htm)[`std::weak_ptr`](http://msdn.microsoft.com/en-us/library/bb982126.aspx)

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2008-09-21T17:29:13.987

的**复制语义**与`auto_ptr`容器不兼容。

具体来说，将一个对象复制`auto_ptr`到另一个对象并不会创建两个相等的对象，因为其中一个对象失去了对指针的所有权。

更具体地说，复制 an`auto_ptr`会导致其中一个副本放开指针。其中哪些保留在容器中未定义。因此，如果您存储`auto_ptrs`在容器中，您可能会随机失去对指针的访问权限。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2010-06-25T19:01:08.453

关于这个主题的两篇超级优秀的文章：

*   [智能指针 - 什么，为什么，哪个？](http://ootips.org/yonat/4dev/smart-pointers.html)
*   [本周大师#25](http://www.gotw.ca/gotw/025.htm)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-09-21T17:40:43.680

STL 容器需要能够复制您存储在其中的项目，并且旨在期望原始和副本是等效的。自动指针对象具有完全不同的合同，复制会产生所有权转移。这意味着 auto_ptr 的容器会表现出奇怪的行为，具体取决于使用情况。

在 Effective STL (Scott Meyers) 第 8 条中有详细描述可能出错的地方，在 Effective C++ (Scott Meyers) 第 13 条中也有不太详细的描述。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-09-21T17:44:30.380

STL 容器存储包含项目的副本。复制 auto_ptr 时，会将旧的 ptr 设置为 null。这种行为破坏了许多容器方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-30T14:30:30.003

*C++03 标准 (ISO-IEC 14882-2003)*在第 20.4.5 条第 3 段中说：

> [...] [**注意：[...] auto_ptr 不满足标准库容器元素的 CopyConstructible 和 Assignable 要求，因此使用 auto_ptr 实例化标准库容器会导致未定义的行为。——尾注**]

*C++11 标准 (ISO-IEC 14882-2011)*在附录 D.10.1 第 3 段中说：

> [...] **注意：[...] auto_ptr 的实例满足 MoveConstructible 和 MoveAssignable 的要求，但不满足 CopyConstructible 和 CopyAssignable 的要求。——尾注]**

*C++14 标准（ISO-IEC 14882-2014）*在附录 C.4.2 附件 D 中说：兼容性特性：

> ***更改*：未定义类模板 auto_ptr、unary_function 和 binary_function、函数模板 random_shuffle 和函数模板（及其返回类型）ptr_fun、mem_fun、mem_fun_ref、bind1st 和 bind2nd。
> *理由*：被新功能取代。
> *对原始功能的影响*：使用这些类模板和函数模板的有效 C++ 2014 代码可能无法在本国际标准中编译。**

# sql-server - 在 SQL Server 2005 中创建 UDF 时出错

> ID：111504
> 
> 赞同：0
> 
> 时间：2008-09-21T17:35:52.100
> 
> 标签：sql-server, user-defined-functions, coalesce

我正在尝试创建一个UDF，`SQL Server 2005 Express`如下所示：

```
CREATE FUNCTION [CombineValues] ()
RETURNS VARCHAR(8000)
AS
BEGIN

DECLARE @CuisineList VARCHAR(8000);

RETURN 
    (
    SELECT @CuisineList = COALESCE(@CuisineList + ', ', '') + 
        CAST(Cuisine AS varchar(20))
    FROM Cuisines
    )
END 
```

美食具有以下结构：

```
CuisineID INT PK,
Cuisine VARCHAR(20) 
```

当我尝试创建上述函数时，出现错误：

> 消息 102，级别 15，状态 1，过程组合值，第 10 行 '=' 附近的语法不正确。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-21T22:47:30.527

使用此方法时需要小心。对于此查询，这现在可能不会影响您，但请记住这一点，以便将来应用此方法。

当您的列表中有一个 NULL 值时，就会出现问题。发生这种情况时，您将得到不正确的结果。

例如，如果您的原始表格如下所示...

```
1   Blah
2   NULL
3   Foo
4   Cracker 
```

您的函数将返回 Foo，Cracker。此函数调用将丢失第一个值 Blah。很容易适应这一点，只需稍微改变您的功能，就像这样......

```
CREATE FUNCTION [CombineValues] ()
RETURNS VARCHAR(8000)
AS
BEGIN

DECLARE @CuisineList VARCHAR(8000);
    SELECT @CuisineList = COALESCE(@CuisineList + ', ', '') + 
        CAST(Cuisine AS varchar(20))
    FROM Cuisines
    WHERE Cuisine Is Not NULL

RETURN @CuisineList
END 
```

通过测试 NOT NULL，您将消除这个潜在的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-21T17:39:05.120

尝试将 SELECT 更改为 SET，然后通过 SELECT (ing) 你的 @CuisineList 来结束你的函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T17:43:34.483

Hojou，你的建议没有奏效，但类似的事情发生了：

```
CREATE FUNCTION [CombineValues] ()
RETURNS VARCHAR(8000)
AS
BEGIN

DECLARE @CuisineList VARCHAR(8000);

SELECT @CuisineList = COALESCE(@CuisineList + ', ', '') + CAST(Cuisine AS varchar(20)) FROM Cuisines;

RETURN 
(
SELECT @CuisineList
)
END 
```

我想将此标记为答案，但由于我是提出这个问题的人，我不确定这是否合适？有什么建议么？请感觉评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T18:17:49.083

这个答案来自原始海报 Wild Thing。请不要投票赞成或反对。

```
CREATE FUNCTION [CombineValues] ()
RETURNS VARCHAR(8000)
AS
BEGIN

DECLARE @CuisineList VARCHAR(8000);

SELECT @CuisineList = COALESCE(@CuisineList + ', ', '') + CAST(Cuisine AS varchar(20)) FROM Cuisines;

RETURN 
(
SELECT @CuisineList
)
END 
```

# objective-c - 如何在 Objective-C 中自动添加属性？

> ID：111517
> 
> 赞同：2
> 
> 时间：2008-09-21T17:42:44.097
> 
> 标签：objective-c, properties

在向类添加新属性时，我发现自己在 xcode 中一遍又一遍地输入相同的内容：

1.  `add TYPE *NAME;`（在 .h 界面中）
2.  `add @property (nonatomic, retain) TYPE *NAME;`（以 .h 为单位）
3.  `add @synthesize NAME;`（米）
4.  `add [NAME release];`（在.m 释放）

（我处于非垃圾收集环境中。）

我怎样才能自动做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-21T18:15:20.633

这听起来很对。IIRC，Objective-C 2.0 文档说您可能可以省略第 1 步，否则我不知道任何捷径。

您可能可以在 Xcode 中编写一个用户脚本来执行此操作。请参阅[http://www.mactech.com/articles/mactech/Vol.23/23.01/2301XCode/index.html](http://www.mactech.com/articles/mactech/Vol.23/23.01/2301XCode/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T20:42:35.543

[根据](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_5_section_7.html)64 位运行时中的开发人员文档，您可以省略第 1 步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T20:30:50.180

您可以查看 Andrew Pang 的[RMModelObject](http://realmacforge.com/svn/trunk/RMModelObject/README.txt) - 我没有使用它，但它充当简化模型创建的对象基类。

我没有使用它，但这里是自述文件中突出显示的一些内容：

> *   无需声明实例变量，
> *   无需编写访问器方法，
> *   免费的 NSCopying 协议支持 ( `-copyWithZone:`),
> *   免费的 NSCoding 协议支持 ( `-initWithCoder:`, `-encodeWithCoder:`),
> *   免费`-isEqual:`和-hash`实现，
> *   大多数情况下不需要写`-dealloc`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-22T18:34:13.327

这是我从 [本文](http://garethfleming.com/2009/04/once-i-get-the-bit-between-my-teeth/)修改的另一个解决方案（另请参阅[最初的文章](http://garethfleming.com/2009/04/because-who-wants-to-do-all-that-typing/)）

博客中的版本在变量声明块之外搜索变量，并且也在匹配方法名称。我做了一个粗略的修复，只搜索第一个'}'之前的变量。如果头文件中有多个接口声明，这将中断。

我将输出设置为“替换文档内容”并输入为“整个文档”......

```
#!/usr/bin/python

thisfile = '''%%%{PBXFilePath}%%%'''
code = '''%%%{PBXAllText}%%%'''
selmark = '''%%%{PBXSelection}%%%'''

import re

if thisfile.endswith('.h'):
    variableEnd = code.find('\n', code.find('}'))
    properties = []
    memre = re.compile('\s+(?:IBOutlet)?\s+([^\-+@].*? \*?.*?;)')
    for match in memre.finditer(code[:variableEnd]):
        member = match.group(1)
        retain = member.find('*') != -1 and ', retain' or ''
        property = '@property (nonatomic%s) %s' % (retain,member)
        if code.find(property) == -1:
            properties.append(property)
    if properties:
        print '%s\n\n%s%s%s%s' % (code[:variableEnd],selmark,'\n'.join(properties),selmark,code[variableEnd:])
elif thisfile.endswith('.m'):
    headerfile = thisfile.replace('.m','.h')
    properties = []
    retains = []
    propre = re.compile('@property\s\((.*?)\)\s.*?\s\*?(.*?);')
    header = open(headerfile).read()
    for match in propre.finditer(header):
        if match.group(1).find('retain') != -1:
            retains.append(match.group(2))
        property = '@synthesize %s;' % match.group(2)
        if code.find(property) == -1:
            properties.append(property)
    pindex = code.find('\n', code.find('@implementation'))
    if properties and pindex != -1:
        output = '%s\n\n%s%s%s' % (code[:pindex],selmark,'\n'.join(properties),selmark)
        if retains:
            dindex = code.find('\n', code.find('(void)dealloc'))
            output += code[pindex:dindex]
            retainsstr = '\n\t'.join(['[%s release];' % retain for retain in retains])
            output += '\n\t%s' % retainsstr
            pindex = dindex
        output += code[pindex:]
        print output 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-23T06:04:10.570

有凯文卡拉汉的[配饰](http://www.kevincallahan.org/software/accessorizer.html)。从网页：

> Accessorizer 根据 ivar 类型选择适当的属性说明符 - 并且还可以自动生成显式访问器（1.0）......但是 Accessorizer 做了很多很多......

# javascript - 如何在 Javascript 中创建查询参数？

> ID：111529
> 
> 赞同：162
> 
> 时间：2008-09-21T17:46:39.423
> 
> 标签：javascript, url, urlencode

有什么方法可以创建用于在 JavaScript中执行*GET 请求的**查询参数？*

 *就像在 Python 中你有[`urllib.urlencode()`](http://web.archive.org/web/20080926234926/http://docs.python.org:80/lib/module-urllib.html)，它接受一个字典（或两个元组的列表）并创建一个像`'var1=value1&var2=value2'`.

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2008-09-21T17:53:45.457

干得好：

```
function encodeQueryData(data) {
   const ret = [];
   for (let d in data)
     ret.push(encodeURIComponent(d) + '=' + encodeURIComponent(data[d]));
   return ret.join('&');
} 
```

用法：

```
const data = { 'first name': 'George', 'last name': 'Jetson', 'age': 110 };
const querystring = encodeQueryData(data); 
```

* * *

## 回答 #2

> 赞同：160
> 
> 时间：2018-08-26T16:41:51.540

[URLSearchParams](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams)增加了对浏览器的支持。

```
const data = {
  var1: 'value1',
  var2: 'value2'
};

const searchParams = new URLSearchParams(data);

// searchParams.toString() === 'var1=value1&var2=value2' 
```

Node.js 提供了[查询字符串](https://nodejs.org/api/querystring.html)模块。

```
const querystring = require('querystring');

const data = {
  var1: 'value1',
  var2: 'value2'
};

const searchParams = querystring.stringify(data);

// searchParams === 'var1=value1&var2=value2' 
```

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2012-08-20T15:31:41.550

**功能性的**

```
function encodeData(data) {
    return Object.keys(data).map(function(key) {
        return [key, data[key]].map(encodeURIComponent).join("=");
    }).join("&");
} 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2015-07-23T22:38:46.697

[Zabba](https://stackoverflow.com/users/382818/zabba)在对当前接受的答案的评论中提供了对我来说是最佳解决方案的建议：使用[jQuery.param()](http://api.jquery.com/jQuery.param/)。

如果我`jQuery.param()`在原始问题中使用数据，那么代码很简单：

```
const params = jQuery.param({
    var1: 'value',
    var2: 'value'
}); 
```

变量`params`将是

```
"var1=value&var2=value" 
```

有关更复杂的示例、输入和输出，请参阅[jQuery.param()](http://api.jquery.com/jQuery.param/)文档。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2018-05-20T15:10:43.177

## ES2017 (ES8)

利用[`Object.entries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)，它返回一个对象`[key, value]`对的数组。例如，因为`{a: 1, b: 2}`它会返回`[['a', 1], ['b', 2]]`. 只有 IE 不支持（也不会）。

### 代码：

```
const buildURLQuery = obj =>
      Object.entries(obj)
            .map(pair => pair.map(encodeURIComponent).join('='))
            .join('&'); 
```

### 例子：

```
buildURLQuery({name: 'John', gender: 'male'}); 
```

### 结果：

```
"name=John&gender=male" 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-09-30T17:38:23.300

我们刚刚发布了[arg.js](https://github.com/stretchr/arg.js)，这是一个旨在一劳永逸地解决这个问题的项目。传统上这很困难，但现在你可以做到：

```
var querystring = Arg.url({name: "Mat", state: "CO"}); 
```

和阅读作品：

```
var name = Arg("name"); 
```

或得到全部：

```
var params = Arg.all(); 
```

如果您关心 and 之间的区别`?query=true`，`#hash=true`那么您可以使用`Arg.query()`and`Arg.hash()`方法。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2018-03-16T17:18:36.993

这应该做的工作：

```
const createQueryParams = params => 
      Object.keys(params)
            .map(k => `${k}=${encodeURI(params[k])}`)
            .join('&'); 
```

例子：

```
const params = { name : 'John', postcode: 'W1 2DL'}
const queryParams = createQueryParams(params) 
```

结果：

```
name=John&postcode=W1%202DL 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-21T17:49:10.040

如果您使用的是[原型](http://www.prototypejs.org)，则有[Form.serialize](http://www.prototypejs.org/api/form/serialize)

如果您使用的是[jQuery](http://www.jquery.com/)，则有[Ajax/serialize](http://docs.jquery.com/Ajax/serialize)

不过，我不知道有任何独立的函数可以完成此任务，但是如果您当前没有使用库，那么通过谷歌搜索它会发现一些有希望的选项。但是，如果您不是，那么您真的应该这样做，因为它们是天堂。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-05-30T23:59:00.937

就像重新审视这个将近 10 年的问题一样。在这个现成的编程时代，最好的办法是使用依赖管理器 ( `npm`) 设置您的项目。那里有一个完整的库行业，可以对查询字符串进行编码并处理所有边缘情况。这是比较流行的一种——

[https://www.npmjs.com/package/query-string](https://www.npmjs.com/package/query-string)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-11-08T13:43:55.987

对打字稿的一点修改：

```
 public encodeData(data: any): string {
    return Object.keys(data).map((key) => {
      return [key, data[key]].map(encodeURIComponent).join("=");
    }).join("&");
  } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-08T09:58:33.097

我改进了[shog9](https://stackoverflow.com/a/111545/13278378)处理数组值的功能

```
function encodeQueryData(data) {
    const ret = [];
    for (let d in data) {
        if (typeof data[d] === 'object' || typeof data[d] === 'array') {
            for (let arrD in data[d]) {
                ret.push(`${encodeURIComponent(d)}[]=${encodeURIComponent(data[d][arrD])}`)
            }
        } else if (typeof data[d] === 'null' || typeof data[d] === 'undefined') {
            ret.push(encodeURIComponent(d))
        } else {
            ret.push(`${encodeURIComponent(d)}=${encodeURIComponent(data[d])}`)
        }

    }
    return ret.join('&');
} 
```

## 例子

```
let data = {
  user: 'Mark'
  fruits: ['apple', 'banana']
}

encodeQueryData(data) // user=Mark&fruits[]=apple&fruits[]=banana 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-27T11:11:17.093

通过使用[queryencoder](https://www.npmjs.com/package/queryencoder)，您可以拥有一些不错的选项，例如自定义日期格式化程序、嵌套对象并决定 a`val: true`是否为 just`value`或`value=true`。

```
const { encode } = require('queryencoder');

const object = {
    date: new Date('1999-04-23')
};

// The result is 'date=1999-04-23'
const queryUrl = encode(object, {
    dateParser: date => date.toISOString().slice(0, 10)
}); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-01T14:10:44.537

这是一个例子：

```
let my_url = new URL("https://stackoverflow.com")
my_url.pathname = "/questions"

const parameters = {
    title: "just",
    body: 'test'
}

Object.entries(parameters).forEach(([name, value]) => my_url.searchParams.set(name, value))

console.log(my_url.href) 
```

* * *

## 回答 #14

> 赞同：-12
> 
> 时间：2008-09-21T17:50:17.760

该[线程](http://web.archive.org/web/20120407213044/http://www.phpbuilder.com:80/board/showthread.php?t=10318476)指向一些用于在 php.ini 中转义 URL 的代码。There's `escape()`and `unescape()`which 将完成大部分工作，但你需要添加一些额外的东西。

```
function urlencode(str) {
str = escape(str);
str = str.replace('+', '%2B');
str = str.replace('%20', '+');
str = str.replace('*', '%2A');
str = str.replace('/', '%2F');
str = str.replace('@', '%40');
return str;
}

function urldecode(str) {
str = str.replace('+', ' ');
str = unescape(str);
return str;
} 
```

# svn - TortoiseSVN 错误：“'https://...' 的选项无法连接到服务器 (...)”

> ID：111543
> 
> 赞同：37
> 
> 时间：2008-09-21T17:52:13.497
> 
> 标签：svn, version-control, tortoisesvn

我正在尝试设置一台新计算机以与我在 cvsdude.com 托管的 SVN 存储库同步。

我收到此错误：

![SVN 错误][1] -*删除了已被广告替换的图像小屋图像*

这是我所做的（这些在过去有效）：

1.  下载并安装 TortoiseSVN

2.  创建了一个新文件夹 C:\aspwebsite

3.  右键单击，选择 SVN Checkout...

4.  输入以下信息，点击确定：

    *   存储库 URL：[https://<reponame>-svn.cvsdude.com/aspwebsite](https://<reponame>-svn.cvsdude.com/aspwebsite)
    *   结帐目录：C:\aspwebsite
    *   结帐深度：完全递归
    *   省略外部：未选中
    *   修订：HEAD 修订
5.  得到 TortoiseSVN 错误：

    *   “ [https://<reponame>-svn.cvsdude.com/aspwebsite](https://<reponame>-svn.cvsdude.com/aspwebsite) ”的选项：无法连接到服务器（[https://<reponame>-svn.cvsdude.com](https://<reponame>-svn.cvsdude.com)）

TortoiseSVN 应该询问我的用户名和密码，然后下载大约 90MB，而不是收到错误。

为什么我不能从我的 Subversion 存储库中签出？

* * *

> [肯特弗雷德里克](https://stackoverflow.com/users/15614/kent-fredric)写道：
> 
> 他们的安全证书已过期，或者他们的托管已损坏/中断。
> 
> 联系 CVSDude 并询问他们发生了什么事。
> 
> 这也可能是超时，因为对我来说，他们的网站非常*缓慢* ..

它仅在几秒钟后出错。我不认为这是超时。

> [马特](https://stackoverflow.com/users/2590/matt)写道：
> 
> 尝试访问 [https://[redacted]-svn.cvsdude.com/aspwebsite](https://[redacted]-svn.cvsdude.com/aspwebsite) 看看会发生什么。如果您可以在浏览器中访问它，您应该能够在您的 SVN 客户端中获取文件，我们可以从那里开始工作。如果它失败了，那么这就是你的答案。

我可以在网络浏览器中访问该网站。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-21T20:15:23.823

**检查TortoiseSVN->Settings->Network**中的代理设置。

也许它们的配置与您的网络浏览器不同。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-09-25T15:50:16.810

反应迟钝，但我已经为此苦苦挣扎了一段时间，所以也许我可以通过展示我的解决方案来节省一些时间。

我的问题有点不同，但原因可能是一样的。

在我的情况下，TortoiseSVN 继续尝试通过代理服务器进行连接。我可以通过 chrome、firefox 和 IE 访问 SVN。

原来有一个**配置文件**与 TortoiseSVN 中的 GUI 显示的配置不同。

我的位置在这里： `C:\Documents and Settings\[username]\Application Data\Subversion\`，但您也可以通过 TortoiseSVN gui 打开文件。

![TortoiseSVN](https://www.xs4all.nl/~niff/stuff/tortoiseproxy.png)

在我的文件中，`http-proxy-exceptions was empty`. 在我指定它之后，一切正常。

```
[global]
http-proxy-exceptions = 10.1.1.11
http-proxy-host = 197.132.0.223
http-proxy-port = 8080
http-proxy-username = defaultusername
http-proxy-password = defaultpassword
http-compression = no 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-11-25T07:45:52.017

我意识到这是一个老问题，但同样的问题也发生在我身上，但原因完全不同。

可能是 cvs-dude 更改了证书，因此它不再与您缓存的证书匹配。

你可以去**TortoiseSVN->Settings->Saved Data**并点击 'Authentication data' 旁边的 'Clear' 按钮然后再试一次。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-02-11T17:04:54.053

这让我发疯，我今天解决了它。我在这个旧帖子中发帖是因为我在寻找解决方案时多次到达这里。我希望它可以帮助某人。对我来说，我检查了 svn-settings --> network --> Edit Subversion server file 发现最后有一些未注释的行：

```
http-proxy-host = 
ssl-trust-default-ca = no
http-proxy-username = 
http-proxy-password = 
```

这与我的同事不同。一旦我评论了这些，它又开始工作了。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-11-30T17:54:24.330

听起来您几乎肯定在代理服务器后面。

在我的代理后面这对我不起作用的***地方：***

```
svn checkout http://v8.googlecode.com/svn/trunk/ v8-read-only 
```

这样***做***：

```
svn --config-option servers:global:http-proxy-host=MY_PROXY_HOST --config-option servers:global:http-proxy-port=MY_PROXY_PORT checkout http://v8.googlecode.com/svn/trunk/ v8-read-only 
```

**更新**我忘了引用我的消息来源:-)

[http://svnbook.red-bean.com/en/1.1/ch07.html#svn-ch-7-sect-1.3.1](http://svnbook.red-bean.com/en/1.1/ch07.html#svn-ch-7-sect-1.3.1)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-13T15:28:01.293

我刚刚遇到了类似的问题，但它没有立即出错，所以它可能不是同一个问题。

我在防火墙后面并更改了我的代理设置（TortoiseSVN->Settings->Network）以访问昨天的开源存储库。今天早上我收到错误消息，试图在防火墙后面的本地域中签出一个 repo。我只需要删除 TortoiseSVN->Settings->Network 中的代理设置，让它再次在本地工作。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-04T11:56:24.977

这是您在 TortoiseSVN 中的代理设置的问题。使用不使用代理的网络连接或正确配置代理设置。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-01-04T18:12:47.463

确保将代理条目添加到服务器文件时，将它们添加到 [global] 组下。（在 ubuntu 下，这似乎对我产生了影响。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-26T19:29:02.330

我有一个类似的问题；原来这是区分大小写的问题。因此，请确保使用正确的案例。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-12T08:53:13.993

我有同样的问题，但使用我自己的服务器。也许 APACHE 只允许与同一服务器的有限连接。我正在增加 max_connection 和 KeepAlive 设置。到目前为止，一切都很好。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-21T17:54:03.883

他们的安全证书已过期，或者他们的托管已损坏/中断。

联系 CVSDude 并询问他们发生了什么事。

这也可能是超时，因为对我来说，他们的网站非常*缓慢*..

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-11-16T16:02:01.293

I got the same error today and discovered that the firewall was blocking the svn client

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-09-03T17:09:45.640

尝试将 SVN URL 粘贴到浏览器的地址栏中。您可能会看到由于 URL 的某些问题而无法连接。我今天遇到了这个问题，问题是我输错了端口号，但正如其他人所指出的，这也可能是区分大小写的问题、代理设置或其他连接级别的问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-09-28T22:02:27.357

我没有以任何方式更改网络设置，因此这里介绍的大部分内容都不适用于我。在搞砸了很多关于病毒扫描程序的评论后，我走上了正确的道路：有一些病毒扫描程序，如 McAfee，可以保护系统目录的某些区域并使它们成为只读的。当您第一次连接到服务器时，Tortoise SVN 会尝试将证书写入其中一个文件，但由于保护而失败。短暂关闭保护，开始检出，在证书对话框后，您可以重新打开它。这至少对我有用。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-06-14T10:48:17.853

感谢此页面上的所有评论者。当我第一次安装最新的 TortoiseSVN 时，我收到了这个错误。

我使用的是最新版本，所以决定降级到 1.5.9（我的其他同事都在使用），这让它工作了。然后，一旦建成，我的机器就被移到另一个子网上，问题又开始了。

我去了 TortoiseSVN->Settings->Saved Data 并清除了 Authentication 数据。在此之后它工作正常。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-04-03T12:06:17.080

这可能是因为您试图通过代理服务器访问存储库来检出存储库，而没有在您需要更改 TortoiseSvn 中的设置的地方启用代理服务器。因此，如果您使用代理服务器，请确保在设置->网络中的“启用代理服务器”中打勾，并在相关位置提供您的服务器地址和端口号。现在尝试再次检查。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-09-10T20:31:35.570

当我将我的服务器作为 SVN 配置文件中的代理的例外时，我也遇到了这个错误，如下所示：`http-proxy-exceptions = *.repo.domain.com`

我的解决方案是使用 svn 服务器 IP 而不是名称。由于某种原因，Eclipse Juno - Subclipse 和 TortoiseSVN 没有正确解析该名称。

那么，什么对我有用：（`http-proxy-exceptions = XXX.XX.X.X`服务器IP）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-04-21T09:59:42.340

可以从至少 3 台计算机访问远程 VisualSVN 服务器 2.5.8。但是在我的本地计算机上，无法访问存储库的 url 并`svn ls https://server-ip:443/svn/project/trunk`返回错误

```
OPTIONS of 'https://…' could not connect to server (…) 
```

我的本地计算机曾经可以访问服务器。唯一改变的是由于 Redmine 原因（证书问题）切换到 http 连接而不是 https。

我尝试了上面列出的不同的东西。真正解决我的问题的是`VisualSVN server 2.5.9`使用相同的存储库安装新的。Redmine 还通过 https 识别了新的存储库。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-03-20T18:10:54.707

对我来说[，这就是解决方案](https://stackoverflow.com/a/15531448/442580)。

问题在于 SVN 服务器位于反向代理（磅）后面。并且反向代理必须被告知允许`OPTIONS`。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-01-08T10:21:52.313

这两个答案都没有为我解决问题。即使在我安装了新版本的 Tortoise SVN + Ccleaner 之后。

似乎有一个文件夹`AppData\Roaming\Subversion`包含 Tortoise SVN 的所有配置。您需要将其全部删除并重新启动 Tortoise SVN。

希望这可以帮助某人作为最终解决方案。

# c# - Listview 图标显示模糊（C#）

> ID：111551
> 
> 赞同：4
> 
> 时间：2008-09-21T17:57:45.043
> 
> 标签：c#, listview, imagelist, blurry

我试图在列表视图控件中显示“LargeIcon”视图，但是我指定的图像模糊。这就是我到目前为止所拥有的： [alt text http://img220.imageshack.us/img220/1005/blurryiconsql3.jpg](http://img220.imageshack.us/img220/1005/blurryiconsql3.jpg)

.png 文件是 48x48，这就是我在 ImageList 属性中设置的显示。我注意到一件事（这可能是原因），但我不知道如何改变它。在“图像集合编辑器”中，您可以在其中为 ImageList 控件选择所需的图像，看起来它为每个图像设置了错误的大小。 [替代文字 http://img83.imageshack.us/img83/5218/imagepropertiesmf9.jpg](http://img83.imageshack.us/img83/5218/imagepropertiesmf9.jpg)

如您所见，“PhysicalDimension”和“Size”设置为 16x16，无法进行操作。有没有人有任何想法？非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T18:02:01.430

确保也将 ImageList.ImageSize 设置为 48 x 48。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T18:47:22.350

添加 .PNG 图标格式大小时，编辑器倾向于选择该文件中的第一个条目大小，因此它会选择 16x16 条目并将其拉伸。这就是为什么您在那里的属性中看到 16x16 的原因。正如建议的那样，对 PNG 的支持很差，我经常发现自己也转向另一种格式以避免这种情况。

如果您需要免费的编辑器或功能更齐全的软件（如 Photoshop 或 Fireworks ），您可以在**[Paint.Net](http://www.getpaint.net/)**中打开文件，然后提取所需的确切大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T18:14:10.400

我不确定在这种特定情况下是否存在问题，但 Microsoft 对 PNG 格式的支持通常很差。尝试以 .bmp 格式添加图像，它们应该可以正常显示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-20T16:26:28.810

还要检查 ImageList 上的 ColorDepth 设置。我在 TreeView 控件上遇到了类似的问题，但是在阅读了关于大小的上一篇文章后，我发现了这个设置，玩了一下，发现它极大地影响了 ImageList 中图像的呈现方式。深度越高质量越好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-06T23:21:20.813

在添加图像**之前**，请务必将 ImageList 大小设置为 48x48 像素。

如果 ImageList 设置为 32x32，并且您添加了 48x48 图像，则图标将调整为 32x32。之后，当您将 ImageList 更改为 48x48 时，图像会再次调整大小，从而降低质量并变得模糊。

此外，Paint.NET（或 Photoshop）无法打开 .ico 文件。

Visual Studio/.NET 可以很好地处理 32 位 PNG 图像，但是 VS 中的内置图像编辑器有点缺乏光泽。

# iphone - 许多不必要的框架加载到我的 iPhone 应用程序中 - 我可以阻止这种情况吗？

> ID：111558
> 
> 赞同：1
> 
> 时间：2008-09-21T18:04:32.000
> 
> 标签：iphone, objective-c

似乎有很多不必要的框架加载到我的 iPhone 应用程序中。我没有在 Xcode 中链接它们，我也不需要它们。

当我在 iPhone 上对它们运行“lsof -p”时，我看到了我无法解释的这些（和其他）：

*   核心视频
*   地址簿UI
*   JavaScriptCore
*   移动同步
*   EAP8021X
*   蓝牙管理器
*   曲库
*   核心音频
*   移动音乐播放器
*   地址簿
*   核心电话
*   移动蓝牙
*   日历
*   电话界面
*   WebCore / WebKit
*   媒体播放器
*   视频工具箱

我想知道这是否会导致启动时间缓慢。我的应用程序非常简单。它基本上是一个类似 Twitter 的发布客户端。唯一的多媒体功能是从相机或库中选择图像，它使用简单的 NSURL / NSURLConnection 函数将数据发布到几个 Web 服务。

这是一款已越狱的 2.1 iPhone，其中安装了一些从 Cydia 安装的应用程序。这是正常的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T00:43:18.593

在尝试阻止操作系统加载这些框架的所有麻烦之前，您应该排除导致启动时间缓慢的其他原因。

首先，构建一个“Hello, World”应用程序并将其用作基线。一个没有添加任何内容的项目模板应用程序应该很好用。如果这比您自己的应用程序启动得更快，那么这就是您在自己的代码中所做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T19:26:56.547

这是正常的，但这并不意味着它是理想的。它可能对应用程序启动时间的影响很小，但它对内存使用的影响会稍大一些。

如果您希望对此进行改进，最好的办法是前往[Apple 的错误报告员](http://bugreport.apple.com)并提交有关它的错误。附上您的应用程序的副本（二进制文件，而不是源代码），他们应该能够从那里追踪事情。我相信他们会对这样的报告感兴趣。

# wordpress - 从 Blogger 导入后，YouTube 嵌入在 WordPress 中不起作用

> ID：111568
> 
> 赞同：2
> 
> 时间：2008-09-21T18:09:24.627
> 
> 标签：wordpress, youtube, blogs

我将一系列博客文章从博主导入到 WordPress，YouTube 嵌入标签被剥离。现在我在帖子中只有 YouTube 网址，而不是完整的嵌入标签。我正在尝试恢复嵌入代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-07-15T17:34:13.693

> > ...默认情况下，WordPress 通过删除可能的麻烦标签来过滤导入的 XML...不幸的是，包括诸如`<embed>`和`<iframe>`其他您在帖子中包含内容的情况。WordPress 通过您可以在`/wp-includes`名为`kses.php`. 在`kses.php`中，您需要向下滚动到第 1309 行并注释掉下面的三行，`//Post filtering`使它们看起来像这样：

```
// Post filtering
#add_filter('content_save_pre', 'wp_filter_post_kses');
#add_filter('excerpt_save_pre', 'wp_filter_post_kses');
#add_filter('content_filtered_save_pre', 'wp_filter_post_kses'); 
```

资料来源：http: [//jasongriffey.net/wp/2010/06/21/moving-to-wordpress-3-0/](http://jasongriffey.net/wp/2010/06/21/moving-to-wordpress-3-0/)和[http://wordpress.org/support/topic/youtube-embeds-not-working-after -进口](http://wordpress.org/support/topic/youtube-embeds-not-working-after-import)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T02:09:37.107

我认为您在这里有几个选择：

1.  您可以撤消导入并使用其他方式重新导入，例如从 RSS。其价值取决于您在帖子中付出了多少努力，因为它们现在在 WordPress 中 - 您愿意转储帖子并再试一次吗？
2.  你去论坛，在 trac 中发布一个错误，去 IRC 频道并尝试找到更多信息；您显然[不是唯一](http://wordpress.org/support/topic/204823)遇到此问题的人（当然，除非是您）
3.  如果您具有数据库访问权限，则可以更新帖子表以重新添加适当的代码。
4.  您可以手动重新添加嵌入代码（显然）。

我们在谈论多少个帖子？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T18:29:57.383

这完全取决于您如何导入博客文章。你的方法是什么？

当您在 wordpress（纯文本视图）中查看帖子的原始来源时 - 帖子是什么样的（HTML 的副本会很好）

- 注意 - 编辑您的原始帖子以给出答案，如果其他人也回答，回复实际上不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T01:37:31.467

当我从博主转到 wordpress 时，我的 YouTube 视频就很好地移动了。马丁是对的，可能需要查看帖子源代码才能有所帮助。

不过，在一个附带问题上需要注意一件事。当您使用 wordpress“博客导入器”时，图像链接不会更新。当您查看您的博客时，一切看起来都不错，但实际上这些图像仍将引用博客网站。

wordpress.org 上有一个插件可以帮助解决这个问题，但是为了 100% 完美的移动，可能/将需要一些手动更新。

我想这是我用的那个。

[http://wordpress.org/extend/plugins/blogger-image-import/](http://wordpress.org/extend/plugins/blogger-image-import/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-30T11:27:25.173

这是我在[wordpress 论坛上](http://wordpress.org/support/topic/youtube-embeds-not-working-after-import?replies=4)找到的解决方案。

在`/wp-includes`一个名为`kses.php`. 在`kses.php`中，您需要向下滚动到第 1309 行并注释掉下面的三行，`//Post filtering`使它们看起来像这样：

```
// Post filtering
#add_filter('content_save_pre', 'wp_filter_post_kses');
#add_filter('excerpt_save_pre', 'wp_filter_post_kses');
#add_filter('content_filtered_save_pre', 'wp_filter_post_kses'); 
```

这将阻止过滤器删除您的所有 YouTube 视频、SlideShare 嵌入、Scribd 文档等。

# security - 当机器人攻击时！

> ID：111576
> 
> 赞同：26
> 
> 时间：2008-09-21T18:13:11.713
> 
> 标签：security, captcha, spam-prevention, bots

除了 CAPTCHA 之外，还有哪些流行的垃圾邮件预防方法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-21T18:18:53.620

我曾尝试做“蜜罐”，在其中放置一个字段，然后用 CSS 将其隐藏（对于禁用样式表的任何人，将其标记为“留空”），但我发现很多机器人能够很快通过它。还有一些技术，例如将字段设置为某个值并使用 JS 更改它们、计算加载时间和提交时间之间的时间、检查引用 URL 以及其他一百万种事情。他们都有自己的陷阱，几乎你所能希望的就是尽可能多地过滤他们，同时不要疏远你在这里的目标：用户。

不过，归根结底，如果你真的，真的，不希望机器人通过你的表单发送东西，你会想在上面放一个验证码——我见过的最好的一个可以处理几乎所有东西都是[reCAPTCHA](http://recaptcha.net) - 但由于印度的 CAPTCHA 解决市场和各地垃圾邮件发送者的独创性，这甚至不是一直成功。我会小心使用一些“巧妙”但有点“外面”的东西，因为对于至少有点习惯于你通常的验证码的用户来说，它更像是一个“wtf”。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-21T20:42:51.043

令人震惊，但这里的几乎所有回复都包含某种形式的验证码。OP想要一些不同的东西，我想也许他想要一些真正有效的东西，甚至可能解决真正的问题。
CAPTCHA**不起作用**，即使它起作用了——这是错误的问题——人类仍然可以淹没你的系统，根据定义，CAPTCHA 不会阻止这种情况（因为它的设计只是为了判断你是否是人类——而不是它做得很好...）

那么，还有哪些其他解决*方案*？好吧，这取决于...取决于您的系统和您的需求。例如，如果您要做的只是限制用户可以填写“联系我”表单的次数，那么您可以简单地限制每个用户每小时/每天/任何时间可以提交的请求数。如果您的用户是匿名用户，您可能需要根据 IP 地址进行节流，并且偶尔将某个 IP 列入黑名单（尽管这也可以被规避，并导致其他问题）。
如果您指的是论坛或博客评论（例如这个），那么我使用它的次数越多，我就越喜欢该解决方案。经过身份验证的用户、授权（基于声誉，不太可能通过泛滥累积）、限制（你一天可以做多少）、偶尔的验证码，最后是社区审核以清理少数通过的用户——所有这些都结合在一起提供一个体面的解决方案。（我想知道 Jeff 是否可以提供一些关于垃圾邮件和其他恶意邮件实际通过多少的信息......？）

另一个要考虑的控制（不知道他们是否在这里）是某种形式的 IDS/IPS - 如果您可以检测和识别垃圾邮件，您可以阻止该模式。审核手动填充需要，在这里...

请注意，其中任何一项都不能*阻止*垃圾邮件，但会逐渐*降低概率*，从而降低盈利能力。这改变了经济等式，并让 CAPTCHA 实际上提供了足够值得的价值 - 因为它不再值得垃圾邮件发送者打扰它或绕过它（感谢其他控制）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-21T18:15:30.773

让用户可以计算：

3和8之和是多少？

顺便说一句：刚刚浏览了微软研究院的一个有趣的方法：Asirra。

[http://research.microsoft.com/asirra/](http://research.microsoft.com/asirra/)

它向您展示了几张图片，您必须识别具有给定主题的图片。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-21T21:33:01.530

## 试试[Akismet](http://akismet.com/)

从可用性的角度来看，验证码或任何形式的仅限人类的问题都是可怕的。有时它们是必要的，但我更喜欢使用 Akismet 等过滤器来杀死垃圾邮件。

[Akismet](http://akismet.com/)最初是为阻止 WordPress 博客上的垃圾评论而构建的，但该 API 能够适应其他用途。

**更新**：我们已经开始在我们的 Rails 应用程序[Yarp.com上使用 ruby​​ 库](http://yarp.com)[Rakismet](https://github.com/joshfrench/rakismet/tree/master)。到目前为止，它在阻止垃圾邮件机器人方面一直很有效。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-21T19:59:10.040

一个不给用户带来负担的非常简单的方法是在页面加载后禁用提交按钮一秒钟。我在一个有连续垃圾邮件帖子的公共论坛上使用它，从那以后它就停止了它们。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-01T02:58:34.877

Ned Batchelder 编写了一种将哈希与蜜罐相结合的技术，用于一些非常有效的 bot 预防。没有验证码，只有代码。

它在[Stopping spabots with hashes 和 honeypots](http://nedbatchelder.com/text/stopbots.html)：

> 与其通过让人们识别自己来阻止机器人，我们可以通过让他们难以成功发布帖子或让他们无意中将自己识别为机器人来阻止机器人。这减轻了人们的负担，并使评论表单没有可见的反垃圾邮件措施。
> 
> 这种技术是我防止此站点上的垃圾邮件程序的方法。有用。这里描述的方法根本不看内容。它可以通过诸如 Akismet 之类的基于内容的预防来增强，但我发现它本身就可以很好地工作。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-21T18:55:43.907

[http://chongqed.org/](http://chongqed.org/)维护活跃垃圾邮件来源的黑名单以及在垃圾邮件中宣传的 URL。我发现后者在论坛中过滤帖子非常有效。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-21T18:16:59.350

我观察到的最常见的问题是围绕用户输入来解决简单的谜题，例如以下是一张猫的图片。（显示围绕猫的狗的缩略图图片）。或简单的数学问题。

虽然很有趣，但我相信军备竞赛也会让这些系统不堪重负。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-21T18:19:13.087

您可以使用[Recaptcha](http://recaptcha.net/)至少使验证码有用。然后你可以用简单的口头数学问题或类似的问题提出问题。微软的[Asirra](http://research.microsoft.com/asirra/)可以让你找到猫和狗的照片。当垃圾邮件发送者无法从服务中获得足够好处时，要求有效的电子邮件地址来激活帐户会阻止垃圾邮件发送者，但也可能会阻止普通用户。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-24T01:57:45.043

以今天的技术，以下是不可行的，但我认为它离得太远了。处理论坛垃圾邮件也可能有点矫枉过正，但对于帐户注册或任何您想确定自己是在与人类打交道并且他们会准备好花费几分钟来完成的情况可能很有用过程。

让 2 个试图证明自己是人类的用户通过他们的网络摄像头相互联系，并询问他们所看到的人是否是真人并且是活生生的（即不是录音），例如让他们镜像彼此的动作，或在一张纸上写一些东西。让每个人对不同的用户进行几次这样的操作，然后将一些录音加入到混音中，他们也必须正确识别这些录音。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-24T02:04:35.433

论坛上一种流行的方法是简单地将帖子少于 10 条的成员的线程排入审核队列。当然，如果您没有版主，或者它不是论坛，这无济于事。一种更通用的方法是计算超链接与文本的比率。通常，垃圾邮件包含大量超链接，您可以通过这种方式捕获很多信息。同样是比较连续帖子的内容。只是不允许非常相似的连续帖子。

当然，任何了解您采取的措施的人都将能够绕过它们。老实说，如果您是特定攻击的目标，您将无能为力。相反，您应该专注于防止更一般的、不熟练的攻击。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-06-18T16:12:11.527

对于人工版主来说，如果机器人足够聪明，可以使用注册帐户，那么能够轻松地查找和删除来自某个 IP 的所有帖子，或者来自某个用户的所有帖子，肯定会有所帮助。同样，无需进一步管理即可轻松阻止 IP 地址或帐户一段时间的选项将减轻人工审核员的管理负担。

使用 cookie 使机器人和垃圾邮件发送者相信他们的帖子实际上是可见的（虽然只有他们自己看到）阻止他们（或巨魔）改变技术。让垃圾邮件发送者和巨魔看到其他垃圾邮件和巨魔消息。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-21T18:15:29.180

[像这种Invisible Captcha](http://haacked.com/archive/2006/09/26/Lightweight_Invisible_CAPTCHA_Validator_Control.aspx)系统这样的Javascript 评估技术要求浏览器在接受页面提交之前评估 Javascript。当用户没有通过仅显示传统的 CAPTCHA 测试来启用 Javascript 时，它会很好地回退。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-21T18:22:06.233

蜜罐是一种有效的方法。Phil Haack 提供了一种[很好的蜜罐方法](http://haacked.com/archive/2007/09/11/honeypot-captcha.aspx)，原则上可以用于任何论坛/博客/等。

您还可以编写一个跟踪垃圾邮件链接并分析其页面以查看它是否是真实链接的爬虫。最明显的是具有您内容的精确副本的页面，但您可以选择其他指标。

审核和黑名单，尤其是像这些用于[WordPress](http://www.online-tech-tips.com/wordpress/a-complete-list-of-anti-plagiarism-and-content-theft-fighting-wordpress-plugins/)的插件（或任何您使用的，类似软件可用于大多数平台），将在低容量环境中工作。如果您的环境是低容量环境，请不要低估这给您带来的优势。个人决定什么是合理的内容，什么不是，如果您有时间，您可以在垃圾邮件控制方面获得最大的灵活性。

不要忘记，正如其他人所指出的，验证码不仅限于从图像中识别文本。通过图像传递的视觉联想、数学问题和其他非主观问题也符合条件。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-21T18:41:32.973

动画验证码 - 滚动文本 - 仍然很容易被人类识别，但如果您确保没有任何帧提供完整的识别功能。

多项选择题 - 只需要一个______和一个微笑。这里的想法是用户必须选择/理解。

会话变量 - 检查您放入会话的变量是否是请求的一部分。将挫败仅生成请求的愚蠢机器人，但可能不会挫败像浏览器一样建模的机器人。

数学问题 - 2 + 5 = - 这又是一个容易解决但阻止机器人生成响应的问题。

图像网格 - 您创建图像网格 - 选择 1 或 2 个特定类型，例如 3x3 网格动物图片，您必须挑选网格上的所有鸟类。

希望这能为您的新解决方案提供一些想法。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-21T19:06:24.067

一个朋友有最简单的反垃圾邮件方法，而且很有效。

他有一个自定义文本框，上面写着“请输入数字 4”。

他的博客相当受欢迎，但仍然不够受欢迎，机器人无法弄清楚（还）。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-21T21:14:13.603

请记住让那些不使用传统浏览器的人可以访问您的解决方案。iPhone 人群不容忽视，有视力和认知问题的人也不应被排除在外。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-06-18T16:05:04.533

[Sblam](http://sblam.com/en.html)是一个有趣的项目。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-21T18:18:19.893

不可见的表单字段。为用户创建一个不会出现在屏幕上的表单域。使用 display: none 作为 css 样式，这样它就不会出现。为了便于访问，您甚至可以放置隐藏文本，以便使用屏幕阅读器的人知道不要填写。机器人几乎总是填写所有字段，因此您可以阻止任何填写不可见字段的帖子。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-21T18:19:33.540

根据垃圾邮件发送者 IP 地址黑名单阻止访问。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-21T18:20:28.700

蜜罐技术在页面顶部放置了一个不可见的诱饵形式。用户没有看到它并提交了正确的表单，机器人提交了错误的表单，它什么都不做或禁止他们的 IP。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-23T02:35:26.490

我已经看到了一些与[Asira](http://research.microsoft.com/asirra/)类似的巧妙想法，它们要求您识别哪些图片是猫。我相信这个想法源于不久前的[KittenAuth](http://www.thepcspy.com/kittenauth) ..

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-09-24T01:57:08.587

Use something like the [google image labeler](http://images.google.com/imagelabeler/) with appropriately chosen images such that a computer wouldn't be able to recognise the dominant features of it that a human could.

将向用户显示图像，并且必须键入与其相关联的单词。他们将继续显示图像，直到他们输入的字词与之前用户为同一图像输入的字词一致。有些图像是新的，它们没有被测试，但被包括在内以记录与它们相关的单词。根据您的观众，您还可以选择只有他们会识别的图像。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-11-07T22:56:31.660

[据说莫洛姆](http://mollom.com/)擅长阻止垃圾邮件。个人（免费）和专业版本均可用。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-01-16T16:17:15.787

我知道有些人提到了 ASIRRA，但如果你去所有图片的“收养我”链接，它会在链接页面上显示它是猫还是狗。因此，机器人访问所有的采用链接应该相对容易。因此，该项目只是时间问题。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-06-18T15:55:22.957

只需验证电子邮件地址，让 google/yahoo 等担心它

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2008-09-23T13:36:14.967

您可以获取一些设备 ID 软件 the41 有一些欺诈预防软件，可以检测用于访问您网站的硬件。我相信他们用它来抓捕欺诈者，但可以用来阻止机器人。一旦您确定了机器人正在使用的设备，您就可以阻止该设备。上次检查时，它甚至可以通过电话网络追踪您的路线（不是您的 Geo-IP ！！）因此，如果您愿意，甚至可以阻止邮政编码。

通过如此道具它很昂贵。一个更好的更便宜的解决方案，它是一个少一点的老大哥。

# version-control - Mercurial 有哪些可用的 GUI 客户端？

> ID：111578
> 
> 赞同：32
> 
> 时间：2008-09-21T18:13:46.317
> 
> 标签：version-control, mercurial

另外，我在哪里可以找到它们？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-21T18:14:37.453

[乌龟 HG](https://tortoisehg.bitbucket.io/)。所有的乌龟善良，现在给 Mercurial。

**2020 年 7 月更新：** 上面链接的原始官方网站已废弃。

该项目移至：[https ://foss.heptapod.net/mercurial/tortoisehg/thg](https://foss.heptapod.net/mercurial/tortoisehg/thg)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-21T22:41:26.000

GUI 客户端和其他工具：[https ://www.mercurial-scm.org/wiki/OtherTools](https://www.mercurial-scm.org/wiki/OtherTools)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-01-12T17:40:45.940

用于 OSX 的 IMO 最佳 GUI Hg 客户端是 SoureTree - [http://sourcetreeapp.com](http://sourcetreeapp.com)

我使用的是 MacHg，它没问题（而且免费），但 SourceTree 有更好的支持、持续的开发和更好的工作流程。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-11-08T10:11:17.867

如果您在 OSX 上，那么[MacHg](http://jasonfharris.com/machg)恕我直言非常好。（我写了它并维护它......）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-16T20:38:23.567

如果您使用的是日食：

[http://bitbucket.org/mercurialeclipse/main](http://bitbucket.org/mercurialeclipse/main)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-29T20:11:52.487

如果你是 OS X 用户，[Murky](http://bitbucket.org/snej/murky/wiki/Home "阴暗")相当不错。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-08T07:07:41.870

如果您想使用控制台，您可以查看：[https ://bitbucket.org/lc2817/hgv](https://bitbucket.org/lc2817/hgv)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-08T12:45:58.837

还有一个`hgview` [http://www.hgview.org/](http://www.hgview.org/)，它有一个基于 ncurses 的 CUI `tig`，还有一个用于查看日志的 GUI。您只能查看该程序的日志，但这确实是我想要的用户界面。

# .net - 如何在正则表达式中命名结果组？（。网）

> ID：111587
> 
> 赞同：1
> 
> 时间：2008-09-21T18:16:03.533
> 
> 标签：.net, regex

如何在正则表达式中命名结果组？（。网）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-21T18:18:29.970

```
(?<NameOfGroup>[a-z]*) 
```

使用 ？语法类似于上面的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T18:21:22.710

```
(?<NAME>EXPRESSION) or (?'NAME'EXPRESSION) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T18:20:38.700

```
(?<first>group)(?'second'group). 
```

[http://www.regular-expressions.info/named.html](http://www.regular-expressions.info/named.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-22T01:40:55.877

```
(?<name>.*) 
```

用你想给你的小组打电话的任何东西代替。以下是您希望解析并将结果与​​组匹配的正则表达式。

请参阅我今天早上的帖子，了解如何解析文件列表以获取名称和编号索引

[如何以特定模式获取从 1 到 n 的文件？](https://stackoverflow.com/questions/2307865/how-to-get-files-from-1-to-n-in-a-particular-pattern/2308012#2308012)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-11T21:30:08.873

```
(?<name>subpattern) 
```

其中 <name> 是组的名称，subpattern 是代码 例如

```
(?<words>\w+) 
```

相同的东西，`\w+`但将其命名为“单词”

# .net - 当 finally 不在 .net try..finally 块中执行时的条件

> ID：111597
> 
> 赞同：50
> 
> 时间：2008-09-21T18:18:36.693
> 
> 标签：.net, exception-handling

基本上我听说某些条件会导致 .net 吹过 finally 块。有谁知道这些条件是什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-21T18:23:38.617

两种可能：

*   [堆栈溢出异常](http://msdn.microsoft.com/en-us/library/system.stackoverflowexception.aspx)
*   [执行引擎异常](http://msdn.microsoft.com/en-us/library/system.executionengineexception.aspx)

当存在 a 时，finally 块将不会被执行，`StackOverflowException`因为堆栈上没有空间可以执行更多代码。当存在 时，它也不会被调用`ExecutionEngineException`，这可能来自对 的调用`Environment.FailFast()`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-21T18:21:28.683

除非 CLR 因 ExecutingEngineException 而崩溃并崩溃（我在 .net 1.1 中看到过一些只有适量的 COM Interop :) .. 我认为 finally 应该**始终**执行。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-21T18:28:27.590

您可能会遇到这样的情况：try 块中的代码导致在进入 try 块之前引发 SecurityException（而不是在调用包含方法时引发异常（请参阅[http://msdn.microsoft.com/en-us /library/fk6t46tz(VS.71).aspx](http://msdn.microsoft.com/en-us/library/fk6t46tz(VS.71).aspx) ))，在这种情况下，您甚至永远不会进入 try 块，因此永远不会调用 finally 块中的代码。

其他可能性包括 StackOverflowException 和 ExecutingEngineException。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-11-21T14:05:20.750

`Finally`阻止`background thread`可能无法执行。但是，这取决于甚至在完全执行之前`main foreground thread`终止`background thread`操作的完成执行`background thread`。

```
class Program
{

    static void Main(string[] args)
    {
        Program prgm = new Program();
        Thread backgroundThread = new Thread(prgm.CheckBgThread);
        backgroundThread.IsBackground = true;
        backgroundThread.Start();
        Console.WriteLine("Closing the program....");
    }

    void CheckBgThread()
    {
        try
        {
            Console.WriteLine("Doing some work...");
            Thread.Sleep(500);
        }
        finally
        {
            Console.WriteLine("This should be always executed");
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-20T20:29:52.490

还有 Application.Exit 方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-21T20:03:22.133

finally 块之后的代码和外部范围内的代码都不会在 finally 块首先启动的情况下执行（finally 块中的异常可能导致它过早退出，在这种情况下，执行将从终结器跳到外部范围）。如果 finally 块之前的代码陷入无限循环或永远不会退出的方法，或者如果执行上下文被完全销毁，finally 块将不会执行。

请注意，依赖 finally 块是正确的，这与不应正确依赖的“Finalize”方法（或 C#“析构函数”）不同。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-05T14:05:56.677

由于 async/await，还有另一种方法 finally 可能会被忽略，这是我在其他答案中没有提到的：

```
static class Program
{
    [STAThread]
    static void Main()
    {
        async void ThreadExecutionAsync()
        {
            try
            {
                SynchronizationContext.SetSynchronizationContext(
                    new WindowsFormsSynchronizationContext());

                await Task.Yield(); // Yield to the context

                // The WindowsFormsSynchronizationContext will schedule the continuation
                // on the main thread, so the current thread will die
                // and we will never get here...
                Debugger.Break();
            }
            finally
            {
                // Will never get here either...
                Debugger.Break();
            }
        }

        var thread = new Thread(ThreadExecutionAsync);
        thread.Start();

        Application.Run();
    }
} 
```

# windows - 如何从 Wave Out 中捕获 PCM 数据

> ID：111603
> 
> 赞同：4
> 
> 时间：2008-09-21T18:19:30.543
> 
> 标签：windows, winapi, audio, directshow

如何以编程方式捕获音频？我正在实现一个在网络上实时流式传输桌面的应用程序。视频部分完成。我需要实现音频部分。我需要一种从声卡获取 PCM 数据以馈送到我的编码器的方法（使用 Windows 媒体格式实现）。

我认为答案与 Win32 API 中的 openMixer()、waveInOpen() 函数有关，但我不确定我该怎么做。

如何打开必要的通道以及如何从中读取 PCM 数据？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-26T14:16:54.413

新的 Windows Vista 核心音频 API 明确支持这一点（称为环回录制），因此如果您可以使用仅 Vista 的应用程序，那么这就是要走的路。

有关如何执行此操作的说明，请参阅 MSDN 上的[Loopback Recording文章。](http://msdn.microsoft.com/en-us/library/ms679146(VS.85).aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-21T19:43:16.677

我认为没有直接的方法可以使用操作系统来做到这一点 - 这是声卡上可能（或可能不）存在的功能。一些声卡有一个环回接口——Creative 称之为“你听到什么”。您只需选择它作为输入而不是麦克风，然后使用您已经知道的普通 waveInOpen() 从中记录。

如果声卡没有此功能，那么我认为您除了做一些疯狂的事情（例如制作自己的驱动程序）之外很不走运。或者您可以说服您的用户将电缆从扬声器输出连接到线路输入:)

# coding-style - 您对成员变量使用什么样的前缀？

> ID：111605
> 
> 赞同：32
> 
> 时间：2008-09-21T18:19:58.670
> 
> 标签：coding-style, naming-conventions, member, naming, prefix

毫无疑问，对于理解代码来说，给成员变量一个前缀是很重要的，这样它们就可以很容易地与“正常”变量区分开来。

但是你使用什么样的前缀？

我一直在处理我们使用**m_**作为前缀的项目，在其他项目中我们只使用下划线（我个人不喜欢，因为只使用下划线不够说明）。

在另一个项目中，我们使用了长前缀形式，它也包括变量类型。**例如mul_是****u** **nsigned** long类型的**成员**变量的前缀。

 ****现在让我知道您使用哪种前缀（并请说明原因）。

**编辑：**你们中的大多数人似乎在没有为成员变量添加特殊前缀的情况下编写代码！这取决于语言吗？根据我的经验，**C++ 代码**倾向于使用下划线或**m_**作为成员变量的前缀。其他语言呢？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-09-21T18:25:28.987

> 毫无疑问，对于理解代码来说，给成员变量一个前缀是很重要的，这样它们就可以很容易地与“正常”变量区分开来。

我对这一说法提出异议。如果您的语法高亮显示得当，那一点也没有必要。一个好的 IDE 可以让您以可读的英文编写代码，并可以通过其他方式向您显示符号的类型和范围。当插入点位于其中一个符号上时，Eclipse 通过突出显示声明和符号的使用做得很好。

编辑，谢谢 slim：像 Eclipse 这样的优秀语法高亮工具还可以让您使用粗体或斜体文本，或者完全更改字体。例如，我喜欢静态事物的斜体。

另一个编辑：这样想；变量的类型和范围是次要信息。它应该可用且易于查找，但不要对您大喊大叫。如果您使用前缀 like`m_`或类型 like `LPCSTR`，当您只想阅读主要信息（代码的意图）时，就会变成噪音。

第三次编辑：无论语言如何，这都适用。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-09-21T18:24:33.060

我根本不使用任何前缀。如果我遇到将局部变量或方法参数与类成员混淆的危险，**那么方法或类都太长了，并且从拆分中受益**。

这（可以说）不仅使代码更具可读性和“流利”，而且最重要的是**鼓励结构良好的类和方法**。最后，它因此归结为与前缀或无前缀困境完全不同的问题。

更新：好吧，品味和偏好会改变，不是吗.. 我现在使用下划线作为成员变量的前缀，因为从长远来看，它已被证明有利于识别局部变量和成员变量。尤其是新的团队成员，当两者不容易被识别时，有时会遇到困难。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2008-09-21T18:24:10.517

没有任何。我曾经使用下划线，但是在其他人不喜欢它并且没有错过它的项目中被淘汰了。一个像样的 IDE 或一个像样的内存会告诉你什么是成员变量，什么不是。我们项目的一位开发人员坚持要放“这个”。在每个成员变量前面，当我们处理名义上是“他的”的代码区域时，我们会取笑他。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-09-21T18:21:02.727

仅下划线。

就我而言，我之所以使用它，是因为这就是我工作场所的编码标准文档所说的。但是，我看不出在变量开头添加 m_ 或一些可怕的匈牙利语的意义。极简主义的“仅下划线”使其易于阅读。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-09-21T19:24:17.487

保持一致比什么都重要，所以选择你和你的队友都同意的东西并坚持下去。如果你编码的语言有一个约定，你应该尽量遵守它。没有什么比不一致地遵循前缀规则的代码库更令人困惑的了。

对于 c++，除了 _ 有时会作为编译器关键字的前缀之外，还有另一个原因更喜欢 m_ 而不是 _。m 代表成员变量。这也使您能够在局部变量和其他变量类之间消除歧义，s_ 表示静态变量，g_ 表示全局变量（但当然不要使用全局变量）。

至于 IDE 将始终照顾您的评论，IDE 真的是您查看代码的唯一方式吗？您的差异工具是否具有与您的 IDE 相同的语法高亮质量水平？你的源代码控制修订历史工具呢？您甚至从未将源文件添加到命令行吗？现代 IDE 是出色的效率工具，但无论您在何种上下文中阅读代码，都应该易于阅读。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-09-21T18:32:15.677

我更喜欢使用`this`关键字。这意味着`this.data`或`this->data`代替一些依赖于社区的命名。

因为：

*   现在的 IDE 键入`this.`弹出窗口 intellinsense
*   在不知道定义命名的情况下，这对每个人来说都是显而易见的

顺便说一句，用字母作为变量前缀来表示它们的类型在好的 IDE 中已经过时了，这让我想起了[Joel 的这篇文章](http://www.joelonsoftware.com/articles/Wrong.html)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-21T20:05:45.267

我们使用 m_ ，然后使用稍微修改的 Simonyi 符号，就像 Rob 在之前的回复中所说的那样。因此，前缀似乎很有用，而且 m_ 不太麻烦且易于搜索。

为什么要记谱法？为什么不遵循（对于 .NET）依赖于名称大小写的 Microsoft 表示法建议？

先说后一个问题：正如所指出的，VB.NET 对大小写漠不关心。数据库和（尤其是）DBA 也是如此。当我必须保持直接的 customerID 和 CustomerID（例如，在 C# 中）时，这让我很头疼。因此，大小写是一种表示法，但不是一种非常有效的表示法。

前缀表示法在几个方面具有价值：

1.  在不使用 IDE 的情况下增加人类对代码的理解。就像在代码审查中一样——我仍然发现最初在纸上最容易做到这一点。
2.  曾经编写过 T-SQL 或其他 RDBMS 存储过程吗？在数据库列名上使用前缀符号真的很有帮助，特别是对于我们这些喜欢使用文本编辑器来处理这类东西的人。

简而言之，前缀作为一种符号形式很有用，因为仍然存在智能 IDE 不可用的开发环境。将 IDE（一种软件工具）视为允许我们使用一些快捷方式（如智能输入），但不包含整个开发环境。

IDE 是一个集成开发环境，就像汽车是一个交通网络一样：只是更大系统的一部分。我不想遵循“汽车”惯例，比如呆在有标记的道路上，有时，步行穿过一块空地会更快。依靠 IDE 来跟踪变量类型就像需要汽车的 GPS 来穿过空地一样。以可移植的形式拥有知识（虽然可能很尴尬，但可能会有“m_intCustomerID”），而不是每次小的变化都跑回车上。

也就是说，m_ 约定或“this”约定都是可读的。我们喜欢 m_ 因为它很容易被搜索并且仍然允许变量类型跟随它。同意太多其他框架代码活动使用简单的下划线。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-21T18:42:06.200

使用 C#，我已经从 'm_' 前缀移动到**只是一个下划线**，因为 'm_' 是**C++ 的遗产**。

微软官方指南告诉你不要使用任何前缀，并且在私有成员上**使用骆驼大小写，****在公共成员上使用帕斯卡大小写**。问题是这与来自同一来源的另一条准则相冲突，该准则指出**您应该使所有代码与 .NET 中使用的所有语言兼容**。例如，VB.NET 在大小写之间没有区别。

所以对我来说只是一个下划线。这也使得通过 IntelliSense 访问变得容易，并且只调用公共成员的外部代码不必看到视觉上凌乱的下划线。

更新：我不认为**C# “this.”-prefix**对“Me”有帮助。在 VB 中，仍然会看到“Me.age”与“Me.Age”相同。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-21T18:35:00.320

这取决于我使用的是哪个框架！如果我正在编写 MFC 代码，那么我使用**m_**和匈牙利符号。对于其他东西（往往是 STL/Boost），我会在所有成员变量中添加一个下划线后缀，并且我不会使用匈牙利符号。

**MFC类**

```
class CFoo  
{  
private:  
    int m_nAge;  
    CString m_strAddress;  
public:  
    int GetAge() const { return m_nAge; }  
    void SetAge(int n) { m_nAge = n; }  
    CString GetAddress() const { return m_strAddress;  
    void SetAddress(LPCTSTR lpsz) { m_strAddress = lpsz; }  
}; 
```

**STL 类**

```
class foo  
{  
private:  
    int age_;  
    std::string address_;  
public:  
    int age() const { return age_; }  
    void age(int a) { age_ = a; }  
    std::string address() const { return address_; }  
    void address(const std::string& str) { address_ = str; }  
}; 
```

现在这可能看起来有点奇怪 - 两种不同的风格 - 但它适用于我，并且编写大量不使用与 MFC 本身相同的风格的 MFC 代码看起来很难看。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-21T19:41:44.810

我在成员变量前面加上“m”，在参数（在函数中）加上“p”。所以代码看起来像：

```
class SomeClass {
    private int mCount;
    ...
    private void SomeFunction(string pVarName) {...}
} 
```

我发现这很快就能告诉你任何变量的基本范围——如果没有前缀，那么它就是本地变量。此外，在读取函数时，您无需考虑传入的内容和局部变量。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-21T18:26:38.327

这真的取决于语言。我是一个 C++ 人，用下划线作为前缀有点棘手。在某些情况下（取决于范围），该语言保留以下划线开头的内容用于实现。双下划线或大写字母后的下划线也有特殊处理。所以我说只是避免这种混乱并简单地选择其他前缀。'm' 没问题 IMO。'm_' 有点多，但也不可怕。真的是口味问题。

但要注意那些 _leadingUnderscores。你会惊讶于有多少编译器和库内部被如此命名，如果你不是非常小心的话，肯定会有意外和混淆的空间。拒绝吧。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-21T19:21:46.543

大多数时候，我使用python。Python 要求您使用 self.foo 来访问当前类实例的属性 foo。这样就解决了您所处理的实例的局部变量、参数和属性混淆的问题。
一般来说，我喜欢这种方法，即使我不喜欢被迫这样做。因此，我理想的做法是不这样做，而是在 this 或 self 上使用某种形式的属性访问以获取成员变量。这样，我不必将名称与元数据混淆。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-21T20:22:36.223

我是个怪人，我在成员变量前面加上类名的首字母（骆驼大小写）。

```
TGpHttpRequest = class(TOmniWorker)
strict private
  hrHttpClient  : THttpCli;
  hrPageContents: string;
  hrPassword    : string;
  hrPostData    : string; 
```

大多数 Delphi 人只使用 F。

```
TGpHttpRequest = class(TOmniWorker)
strict private
  FHttpClient  : THttpCli;
  FPageContents: string;
  FPassword    : string;
  FPostData    : string; 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-22T21:25:04.677

如果语言支持**this**或**Me**关键字，则不使用前缀，而是使用所述关键字。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-21T18:57:31.327

另一个技巧是**命名约定**：

所有成员变量都像往常一样命名，没有任何前缀（或“this.”是不是在项目中通常这样做）

但是它们很容易与局部变量区分开来，因为在我的项目中，这些局部变量总是被命名为：

*   **aSomething：代表一个**对象。
*   **some** ManyThings：对象列表。
*   **是**AState 或**有**SomeThing: 用于布尔状态。

任何不以“a”、“some”或“is/has”开头的变量都是成员变量。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-21T19:02:11.270

由于 VB.NET 不区分大小写，因此我在成员变量前面加上下划线并在名称的其余部分加上驼峰式大小写。我将属性名称大写。

```
Dim _valueName As Integer

Public Property ValueName() As Integer 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-21T20:19:46.870

我和不使用前缀的人在一起。

IDE 现在非常好，从语法着色、鼠标悬停工具提示和轻松导航到其定义，一眼就能轻松找到有关变量的信息。

这是您可以从变量的上下文和命名约定（例如局部变量和私有字段的 lowerCamelCase，属性和方法等的 UpperCamelCase 等）以及布尔值的“hasXXXX”和“isXX”等内容中获得的最重要的内容。

多年来我没有使用前缀，但我确实曾经是“this”。前缀怪物，但除非绝对必要，否则我已经取消了（谢谢，Resharper）。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-21T20:58:02.287

一个**_**仅用作视觉指示器。（C＃）

*   有助于使用智能感知对成员进行分组。
*   阅读代码时更容易发现成员变量。
*   更难隐藏具有本地定义的成员变量。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2010-12-11T12:15:38.667

## `_`代替`this.`

我使用`_`too 而不是`this.`因为它**更短**（少**4 个**字符），它是成员变量的一个很好的指标。此外，使用此前缀可以避免命名冲突。例子：

```
public class Person {
  private String _name;

  public Person(String name) {
    _name = name;
  }
} 
```

将其与此进行比较：

```
public class Person {
  private String name;

  public Person(String name) {
    this.name = name;
  }
} 
```

我发现第一个例子更短更清晰。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-21T18:26:16.190

这有点取决于您使用的语言。

在 C# 中，您可以使用“this”前缀引用任何成员，例如“this.val”，这意味着不需要前缀。VB 具有与“我”类似的功能。

在有用于指示成员访问的内置符号的语言中，我看不到使用前缀的意义。在其他语言中，我想使用该语言普遍接受的约定是有意义的。

请注意，使用内置表示法的好处之一是您也可以在访问类的属性和方法时使用它，而不会影响您的命名约定（这在访问非私有成员时尤其重要）。使用任何类型的指标的主要原因是作为一个标志，表明您在类中可能造成副作用，因此在使用其他成员时最好使用它，无论它们是否是字段/属性/方法/等.

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-21T19:06:24.830

我在这里使用驼峰式大小写和下划线。我使用下划线是因为我使用 C#，而且我已经习惯在构造函数中避免使用“this”关键字。我是骆驼案例方法范围的变体，所以下划线提醒我当时正在使用什么范围。否则，只要您不尝试添加代码中已经很明显的不必要信息，我认为这并不重要。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-21T20:18:31.727

我曾经在 C++ 中使用 m_ perfix，但在 C# 中，我更喜欢将驼峰大小写用于字段，将帕斯卡大小写用于其属性。

```
private int fooBar;
public int FooBar
{
  get { return fooBar; }
  set { fooBar = value; }
} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-06-05T00:27:44.703

我喜欢 m_ 但只要在代码库中使用约定，我就很喜欢它。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-21T18:22:37.837

您的 mul_ 示例正朝着 Charles Simonyi 的 Apps Hungarian 表示法前进。

我更喜欢保持简单，这就是为什么我喜欢使用 m_ 作为前缀。

这样做可以更容易地查看您必须去哪里查看原始声明。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-21T18:35:04.470

我倾向于在 C++ 中使用 m_，但不介意在 Java 或 C# 中使用它。这取决于编码标准。对于混合了下划线和 m_ 的遗留代码，我会将代码重构为一个标准（给定合理的代码大小）

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-21T18:43:44.730

我用 @。

:D j/k - 但是否确实取决于语言。如果它有 getter/setter，我通常会在私有成员变量前面放一个 _，并且 getter/setter 将具有相同的名称而没有 _。否则，我通常不使用任何。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-21T19:25:05.707

对于我自己的项目，我使用 _ 作为后缀（正如上面提到的 Martin York，作为前缀是 C/C++ 编译器实现标准的保留），并且我在处理[Symbian 项目](http://www.symbian.com/developer/techlib/v70sdocs/doc_source/DevGuides/EssentialIdioms/NamingConvs.guide.html)时。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-09-21T20:09:42.573

在 Java 中，一种常见的约定是在成员变量前面加上“my”和 UseCamelCaseForTheRestOfTheVariableName。

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2008-09-21T18:24:23.077

如果没有必要，则无，否则单下划线。适用于蟒蛇。

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2008-09-21T18:53:13.677

如果确实需要为成员变量添加前缀，我肯定更喜欢`m_`只使用下划线。我发现下划线本身会降低可读性，并且可能与 C++ 保留字混淆。

但是，我确实怀疑成员变量是否需要任何特殊符号。即使忽略 IDE 的帮助，也不明白为什么会混淆什么是本地变量和什么是成员变量。

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2008-09-21T20:27:09.630

没有前缀。而且，对于纯功能/基于堆栈的无变量名。但是，如果我真的必须使用副作用，如果我想输出任何东西，我可能会使用`p->`其中 p 是传递给我的函数的参数的外部指针。

我认为使用前缀/前缀会很愚蠢。

```
__EXTERN_GLOBAL_hungariannotationvariabletypeVendorName-my_member_prefix-Category-VariableName 
```

仔细考虑 mul 示例，我的成员变量是一个无符号长整数，表示乘法指令的操作码可能是 mulmul。

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2008-09-22T10:50:46.543

Symbian 使用“i”作为成员的前缀，使用“a”作为参数。

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2008-09-22T11:09:19.010

我只使用 _**后缀**（前缀 _ 在 c/c++ 中保留，正如上面许多人所指出的那样）。我喜欢它主要是因为我讨厌像“aCircle”这样的参数名称，除非绝对必要，否则我也不喜欢写出 this.circle。（我只对公共访问成员变量这样做，'因为这些我不使用下划线后缀）。

# operating-system - 如何存储代码和文件以供跨机器使用

> ID：111629
> 
> 赞同：7
> 
> 时间：2008-09-21T18:27:36.110
> 
> 标签：operating-system, versioning

我很想知道人们有什么策略来保持他们的代码和工作在多台机器上的版本化。例如，我有一台运行 XP 的台式机、一台运行 OSX 的 macbook 和运行 XP 的 VMWare 以及一台用于运行产品演示的销售笔记本电脑。我想知道如何始终使这些保持同步。Subversion 是一种可能性，但我发现它对于处理二进制文件不太有用——也许我在这里忽略了一些东西。其他人使用什么，因为他们必须有类似的问题？他们是否将所有文件保存在 USB 驱动器上，而不是保存在本地文件系统上。我并不总是在线，所以远程存储并不是一个真正的选择。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-21T18:38:16.490

正如其他人所说，颠覆是你最好的代码选择。对于二进制文件/非代码，我发现[DropBox](http://www.getdropbox.com)非常方便。它存储修订、取消删除、轻松共享等，基本上是一个自动的、网络友好的 SVN。不必考虑它对我来说是最大的优点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T18:30:35.713

我使用[mercurial](http://www.selenic.com/mercurial)来保持我的工作文件同步。这对于大型二进制文件也不是很好，但它让我可以在不在线的情况下提交，并且可以轻松地分支/合并不同的版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-21T18:44:32.013

啊，旧的 VCS 辩论。

共享/同步源代码的最简单方法是使用某种 VCS（版本控制系统）——这比能够保持同步为您提供了很多好处。那里有很多 VCS，我个人使用 Bazaar-NG 和 Subversion——尽管我建议您试用一些，看看您使用它们的感觉如何。

对于同步一般文件，特别是如果它只是为了你自己，我建议使用“DropBox”（[http://www.getdropbox.com/](http://www.getdropbox.com/)） - 我在过去一周左右一直在使用它，它使同步用一组文件来安装我的多台机器要容易得多。

它还有一些额外的功能，可能对协作也很有用，但我还没有尝试过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T18:29:40.363

Subversion 在我们的办公室里非常适合销售、项目管理、设计和代码文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T18:41:32.910

我将我的点文件（`.zshrc`等）存储在一个 Git 存储库中，该存储库已检出到我的 homedir 中。我也对包含我的课业的 LaTeX 文件做同样的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T18:29:57.523

我把重要的构建放在源代码控制中——它适用于二进制文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-21T18:32:00.733

对于包括源代码在内的大多数文件，我们确实使用 Subversion。这真的很棒。

如果有较大的文件或项目管理相关文档被无权访问源代码控制系统的人使用，我们使用 Microsoft SharePoint。如果您与公司以外的人一起工作，这尤其有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-21T18:33:53.460

我将所有工作都加密保存在 U 盘上。它还有一个可引导的 Linux 分区，因此我可以从任何机器进入一个合理的工作开发环境，例如一台借来的工作笔记本电脑，带有一些我无法移动到我自己的机器上的会议携带的软件。

当你有更多的人在处理相同的代码时，我会将它放在一个中央 Subversion 存储库中并设置脚本（在 Windows 中，你可以使用 U 盘的自动运行功能）以始终在 repo 和 U 盘之间同步内容随身携带。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-21T18:51:45.817

FolderShare ( [http://foldershare.com](http://www.foldershare.com) ) 也很适合同步文件。例如，我用它来保持笔记本电脑和台式机之间的文件等同步。

当然，尤其是对于代码，这并不能排除对源代码控制的需要。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-21T19:21:58.290

我看到的主要观点。使用 SVN 作为二进制文件的中央存储库，如果这些文件具有任何合理的大小，它们将需要一些时间才能通过网络同步。因此，如果您不想花时间等待您的文件通过网络传入，这里是其他镜像解决方案的构建块：

*   [镜像文件夹](http://www.techsoftpl.com/backup/index.php)

在将数据罐与其他几个“本地”副本同步时，找不到更好的工具。

*   [TrueCrypt](http://www.truecrypt.org/)

使用它来加密您的 USB-Tank，以防万一您将它掉到某个地方。

# c++ - 使用 Window API，如何确保控件保持原生外观？

> ID：111630
> 
> 赞同：4
> 
> 时间：2008-09-21T18:27:49.697
> 
> 标签：c++, winapi, user-interface, appearance

我创建的一些控件似乎默认为旧的 Windows 95 主题，如何防止这种情况发生？这是一个不保留操作系统本机外观的按钮示例（我使用 Vista 作为我的开发环境）：

```
HWND button = CreateWindowEx(NULL, L"BUTTON", L"OK", WS_VISIBLE | WS_CHILD | BS_PUSHBUTTON,
                                  170, 340, 80, 25, hwnd, NULL, GetModuleHandle(NULL), NULL); 
```

我将本机 C++ 与 Windows API 一起使用，没有托管代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T00:10:48.627

要将清单添加到应用程序，您需要创建一个 MyApp.manifest 文件并将其添加到应用程序资源文件：

```
//-- This define is normally part of the SDK but define it if this 
//-- is an older version of the SDK.
#ifndef RT_MANIFEST
#define RT_MANIFEST              24
#endif

//-- Add the MyApp XP Manifest file
CREATEPROCESS_MANIFEST_RESOURCE_ID RT_MANIFEST "MyApp.manifest" 
```

对于较新版本的*Visual Studio*，项目设置中有一个*Manifest Tool选项卡，此选项卡上的**Additional Manifest Files*字段也可用于定义清单文件。

这是一个 Win32 应用程序的简单 MyApp.manifest 文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
<assemblyIdentity
    version="1.0.0.1"
    processorArchitecture="X86"
    name="Microsoft.Windows.MyApp"
    type="win32"
/>
<description>MyApp</description>
</assembly> 
```

如果您的应用程序依赖于其他 dll，这些详细信息也可以添加到清单中，Windows 将使用此信息来确保您的应用程序始终使用这些依赖 dll 的正确版本。

例如，这里是通用控件和 8.0 版 C 运行时库的清单依赖项详细信息：

```
<dependentAssembly>
    <assemblyIdentity
        type="win32"
        name="Microsoft.Windows.Common-Controls"
        version="6.0.0.0"
        processorArchitecture="X86"
        publicKeyToken="6595b64144ccf1df"
        language="*"
    />
</dependentAssembly>
<dependentAssembly>
  <assemblyIdentity
        type="win32"
        name="Microsoft.VC80.CRT"
        version="8.0.50608.0"
        processorArchitecture="x86"
        publicKeyToken="1fc8b3b9a1e18e3b" />
</dependentAssembly> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-21T18:39:05.193

我相信它与您的代码无关，但您需要设置一个适当的**清单**文件来获取主题控件。

一些信息在这里：[@msdn.com](http://msdn.microsoft.com/en-us/library/aa374191(VS.85).aspx)和这里：[@blogs.msdn.com](http://blogs.msdn.com/cheller/archive/2006/08/24/718757.aspx)

您可以在这里看到有和没有清单的应用程序之间的区别：[天堂工具.com](http://www.heaventools.com/PE_Explorer_resource_XP_Wizard.htm)

# visual-studio - Visual Studio 解决方案/多项目：如何在多个 C++ 项目之间有效传播项目属性

> ID：111631
> 
> 赞同：40
> 
> 时间：2008-09-21T18:28:21.583
> 
> 标签：visual-studio, projects-and-solutions

我正在使用包含多个项目（大约 30 个）的 Visual Studio 2005 C++ 解决方案。根据我的经验，维护项目的所有属性（即包括路径、库路径、链接库、代码生成选项...）通常会变得很烦人，因为您经常必须单击每个项目才能修改它们。当您有多种配置（Debug、Release、Release 64 bits，...）时，情况会变得更糟。

现实生活中的例子：

*   假设您要使用一个新库，并且您需要将该库的包含路径添加到所有项目中。您将如何避免必须编辑每个项目的属性？
*   假设您想测试新版本的库（比如 2.1beta 版），以便您需要快速更改一组项目的包含路径/库路径/链接库？

笔记：

*   我知道可以一次选择多个项目，然后右键单击并选择“属性”。但是，此方法仅适用于对于不同项目已经完全相同的属性：您不能使用它来将包含路径添加到使用不同包含路径的一组项目中。
*   我也知道可以全局修改环境选项（工具/选项/项目和解决方案/目录），但是由于它不能集成到 SCM 中，所以并不令人满意
*   我也知道可以将“配置”添加到解决方案中。它没有帮助，因为它需要维护另一组项目属性
*   我知道 codegear C++ Builder 2009 通过所谓的“选项集”为这个需求提供了一个可行的答案，它可以被多个项目继承（我同时使用 Visual Studio 和 C++ Builder，我仍然认为 C++ Builder 在某些方面比较摇滚到 Visual Studio）
*   我希望有人会建议使用“autconf”，例如 CMake，但是是否可以将 vcproj 文件导入到这样的工具中？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-21T18:32:40.373

我认为您需要调查属性文件，即[*.vsprops](http://msdn.microsoft.com/en-us/library/a4xbdz1e%28v=VS.90%29.aspx)（旧）或[*.props](https://msdn.microsoft.com/en-us/library/669zx6zc.aspx)（最新）

您**确实**需要手动将属性文件添加到每个项目，但是一旦完成，您将拥有多个项目，但只有一个 .[vs]props 文件。如果更改属性，所有项目都会继承新设置。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-21T18:41:56.747

我经常需要做类似的事情，因为我链接到静态运行时库。我写了一个程序来为我做这件事。它基本上扫描你给它的任何路径的所有子目录，并识别它找到的任何 .vcproj 文件。然后一一打开，修改它们并保存它们。由于我很少使用它，因此路径是硬编码的，但我认为您可以根据需要调整它。

另一种方法是认识到 Visual Studio 项目文件只是 XML 文件，并且可以使用您喜欢的 XML 类进行操作。`XmlDocument`当有**很多**我不想输入的包含目录时，我使用 C#更新了包含目录。:)

我包括两个例子。您需要根据自己的需要修改它们，但这些应该可以帮助您入门。

**这是 C++ 版本：**

```
#include <stdio.h>
#include <tchar.h>
#include <iostream>
#include <fstream>
#include <string>
#include <sstream>
#include <vector>
#include <boost/filesystem/convenience.hpp>
#include <boost/filesystem/operations.hpp>
#include <boost/filesystem/path.hpp>
#include <boost/regex.hpp>
#include <boost/timer.hpp>

using boost::regex;
using boost::filesystem::path;
using namespace std;

vector<path> GetFileList(path dir, bool recursive, regex matchExp);
void FixProjectFile(path file);
string ReadFile( path &file );
void ReplaceRuntimeLibraries( string& contents );
void WriteFile(path file, string contents);

int _tmain(int argc, _TCHAR* argv[])
{
    boost::timer stopwatch;
    boost::filesystem::path::default_name_check(boost::filesystem::native);
    regex projFileRegex("(.*)\\.vcproj");
    path rootPath("D:\\Programming\\Projects\\IPP_Decoder");

    vector<path> targetFiles = GetFileList(rootPath, true, projFileRegex);
    double listTimeTaken = stopwatch.elapsed();

    std::for_each(targetFiles.begin(), targetFiles.end(), FixProjectFile);

    double totalTimeTaken = stopwatch.elapsed();
    return 0;
}

void FixProjectFile(path file) {
    string contents = ReadFile(file);
    ReplaceRuntimeLibraries(contents);
    WriteFile(file, contents);
}

vector<path> GetFileList(path dir, bool recursive, regex matchExp) {
    vector<path> paths;
    try {
        boost::filesystem::directory_iterator di(dir);
        boost::filesystem::directory_iterator end_iter;
        while (di != end_iter) {
            try {
                if (is_directory(*di)) {
                    if (recursive) {
                        vector<path> tempPaths = GetFileList(*di, recursive, matchExp);
                        paths.insert(paths.end(), tempPaths.begin(), tempPaths.end());
                    }
                } else {
                    if (regex_match(di->string(), matchExp)) {
                        paths.push_back(*di);
                    }
                }
            }
            catch (std::exception& e) {
                string str = e.what();
                cout << str << endl;
                int breakpoint = 0;
            }
            ++di;
        }
    }
    catch (std::exception& e) {
        string str = e.what();
        cout << str << endl;
        int breakpoint = 0;
    }
    return paths;
}

string ReadFile( path &file ) {
//  cout << "Reading file: " << file.native_file_string() << "\n";
    ifstream infile (file.native_file_string().c_str(), ios::in | ios::ate);
    assert (infile.is_open());

    streampos sz = infile.tellg();
    infile.seekg(0, ios::beg);

    vector<char> v(sz);
    infile.read(&v[0], sz);

    string str (v.empty() ? string() : string (v.begin(), v.end()).c_str());

    return str;
}

void ReplaceRuntimeLibraries( string& contents ) {
    regex releaseRegex("RuntimeLibrary=\"2\"");
    regex debugRegex("RuntimeLibrary=\"3\"");
    string releaseReplacement("RuntimeLibrary=\"0\"");
    string debugReplacement("RuntimeLibrary=\"1\"");
    contents = boost::regex_replace(contents, releaseRegex, releaseReplacement);
    contents = boost::regex_replace(contents, debugRegex, debugReplacement);
}

void WriteFile(path file, string contents) {
    ofstream out(file.native_file_string().c_str() ,ios::out|ios::binary|ios::trunc); 
    out.write(contents.c_str(), contents.length());
} 
```

* * *

**这是 C# 版本。享受...**

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Xml;
using System.IO;

namespace ProjectUpdater
{
    class Program
    {
        static public String rootPath = "D:\\dev\\src\\co\\UMC6\\";
        static void Main(string[] args)
        {
            String path = "D:/dev/src/co/UMC6/UMC.vcproj";
            FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
            XmlDocument xmldoc = new XmlDocument();
            xmldoc.Load(fs);
            XmlNodeList oldFiles = xmldoc.GetElementsByTagName("Files");
            XmlNode rootNode = oldFiles[0].ParentNode;
            rootNode.RemoveChild(oldFiles[0]);

            XmlNodeList priorNode = xmldoc.GetElementsByTagName("References");
            XmlElement filesNode = xmldoc.CreateElement("Files");
            rootNode.InsertAfter(filesNode, priorNode[0]);

            DirectoryInfo di = new DirectoryInfo(rootPath);
            foreach (DirectoryInfo thisDir in di.GetDirectories())
            {
                AddAllFiles(xmldoc, filesNode, thisDir.FullName);
            }

            List<String> allDirectories = GetAllDirectories(rootPath);
            for (int i = 0; i < allDirectories.Count; ++i)
            {
                allDirectories[i] = allDirectories[i].Replace(rootPath, "$(ProjectDir)");
            }
            String includeDirectories = "\"D:\\dev\\lib\\inc\\ipp\\\"";
            foreach (String dir in allDirectories) 
            {
                includeDirectories += ";\"" + dir + "\"";
            }

            XmlNodeList toolNodes = xmldoc.GetElementsByTagName("Tool");
            foreach (XmlNode node in toolNodes)
            {
                if (node.Attributes["Name"].Value == "VCCLCompilerTool") {
                    try
                    {
                        node.Attributes["AdditionalIncludeDirectories"].Value = includeDirectories;
                    }
                    catch (System.Exception e)
                    {
                        XmlAttribute newAttr = xmldoc.CreateAttribute("AdditionalIncludeDirectories");
                        newAttr.Value = includeDirectories;
                        node.Attributes.InsertBefore(newAttr, node.Attributes["PreprocessorDefinitions"]);
                    }

                }
            }
            String pathOut = "D:/dev/src/co/UMC6/UMC.xml";
            FileStream fsOut = new FileStream(pathOut, FileMode.Create, FileAccess.Write, FileShare.ReadWrite);
            xmldoc.Save(fsOut);

        }
        static void AddAllFiles(XmlDocument doc, XmlElement parent, String path) {
            DirectoryInfo di = new DirectoryInfo(path);
            XmlElement thisElement = doc.CreateElement("Filter");
            thisElement.SetAttribute("Name", di.Name);
            foreach (FileInfo fi in di.GetFiles())
            {
                XmlElement thisFile = doc.CreateElement("File");
                String relPath = fi.FullName.Replace(rootPath, ".\\");
                thisFile.SetAttribute("RelativePath", relPath);
                thisElement.AppendChild(thisFile);
            }
            foreach (DirectoryInfo thisDir in di.GetDirectories())
            {
                AddAllFiles(doc, thisElement, thisDir.FullName);
            }
            parent.AppendChild(thisElement);
        }
        static List<String> GetAllDirectories(String dir)
        {
            DirectoryInfo di = new DirectoryInfo(dir);
            Console.WriteLine(dir);

            List<String> files = new List<String>();
            foreach (DirectoryInfo subDir in di.GetDirectories())
            {
                List<String> newList = GetAllDirectories(subDir.FullName);
                files.Add(subDir.FullName);
                files.AddRange(newList);
            }
            return files;
        }
        static List<String> GetAllFiles(String dir)
        {
            DirectoryInfo di = new DirectoryInfo(dir);
            Console.WriteLine(dir);

            List<String> files = new List<String>();
            foreach (DirectoryInfo subDir in di.GetDirectories())
            {
                List<String> newList = GetAllFiles(subDir.FullName);
                files.AddRange(newList);
            }
            foreach (FileInfo fi in di.GetFiles())
            {
                files.Add(fi.FullName);
            }
            return files;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-28T13:29:21.423

按照建议，您应该查看属性表（又名 .vsprops 文件）。[我在这里](http://xnodet.blogspot.com/2009/08/short-introduction-to-vsprops-files-in.html)
写了一个关于这个特性的简短介绍。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-21T18:35:28.430

是的，我肯定会建议使用[CMake](http://www.cmake.org/)。CMake 是可以生成 Studio 项目文件的最佳工具（我想我实际上已经尝试过所有这些工具）。

我还遇到了将现有 .vcproj 文件转换为 CMakeLists.txt 的问题，我编写了一个[Ruby 脚本](http://www.eskilson.se/vcproj2cmake.rb)来处理大部分转换。该脚本不处理诸如后期构建步骤之类的事情，因此需要进行一些调整，但它会为您省去从 .vcproj 文件中提取所有源文件名的麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-19T17:35:10.647

*.vcxproj 文件是 msbuild 文件。因此，您只需在所有项目文件中获取不需要的属性并将其删除。然后把它放在你的属性表中。然后确保所有项目文件正确导入该属性表。

对于数百个文件来说，这可能非常乏味。我写了一个工具使它具有交互性：

[https://github.com/chris1248/MsbuildRefactor](https://github.com/chris1248/MsbuildRefactor)

# .net - 反序列化会发生什么？

> ID：111643
> 
> 赞同：2
> 
> 时间：2008-09-21T18:30:58.647
> 
> 标签：.net, serialization

我目前正在转换我的 ASP.NET v2 应用程序来序列化/反序列化它的对象，因为我想从 inproc 会话状态转移到 stateserver。这是因为我的主机 webhost4life 有一种讨厌的倾向，即频繁地回收工作进程，从而导致会话超时。反正……这个问题……

我试图不序列化我不需要的东西，即重新初始化每个页面的变量，不需要序列化。这是其中之一：

私有回滚队列作为新队列（DataServer.Rollback）

在反序列化时，RollbackQueue 会是 a）什么都没有还是 b）一个空队列？我的猜测是，当 .NET 反序列化时，它会照常创建父对象，然后一一填写字段。因此，NEW 位将触发。

但这是一个猜测。

谢谢，罗伯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-21T18:32:12.403

什么都不会。CLR 序列化逻辑将通过[FormatterServices.GetSafeUnitializedObject](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatterservices.getsafeuninitializedobject.aspx)创建未初始化的对象，而不运行任何构造逻辑。如果您需要确保该字段具有值，我建议将此类初始化移动到一个`Initialize()`方法中，该方法既可以从您的构造函数调用，也可以从标有[OnDeserialized](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.ondeserializedattribute.aspx)属性的方法调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-21T18:47:16.687

为什么不编写一个简单的测试应用程序来找出答案？这是我写的一个（请原谅 C# 而不是 VB，但我现在打开了 C# Express 版本的 VS2008）。

```
[Serializable]
class TestClass
{
    [NonSerialized]
    public Queue<string> queue = new Queue<string>();
}

class Program
{
    static void Main(string[] args)
    {
        var obj = new TestClass();
        Console.WriteLine("Original is null? {0}", obj.queue == null);
        var stream = new MemoryStream();
        var formatter = new BinaryFormatter();
        formatter.Serialize(stream, obj);
        stream.Position = 0L;
        var copy = (TestClass)formatter.Deserialize(stream);
        Console.WriteLine("Copy is null? {0}", copy.queue == null);
        Console.ReadLine();
    }
} 
```

这个的输出是

```
Original is null? False 
Copy is null? True 
```

现在您肯定知道，反序列化时它将为空。Kent 已经在另一篇文章中解释了*为什么*会这样，以及你可以做些什么，所以我不会重复它。

# sql - SQL 2005-2008 中的锁定行

> ID：111652
> 
> 赞同：8
> 
> 时间：2008-09-21T18:33:57.843
> 
> 标签：sql, sql-server, locking

有没有办法在不启动事务的情况下锁定 SQL 2005-2008 数据库中的一行，这样其他进程在解锁之前无法更新该行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T19:02:42.017

您可以使用[RowLock 或其他提示](http://blog.sqlauthority.com/2007/04/27/sql-server-2005-locking-hints-and-examples/)，但您应该[小心](http://www.sqlteam.com/article/row-locking)..

HOLDLOCK 提示将指示 SQL Server 持有锁，直到您提交事务。ROWLOCK 提示将只锁定这条记录，而不发出页或表锁。

如果您关闭连接或超时，锁定也将被释放。我会非常小心地这样做，因为它会阻止任何命中这一行的 SELECT 语句死在他们的轨道上。SQL Server 有许多可以使用的锁定提示。当您在 HOLDLOCK 或 ROWLOCK 上搜索时，您可以在联机丛书中看到它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T19:02:10.473

您在服务器中执行的一切都发生在事务中，无论是隐式的还是显式的。

您不能简单地锁定没有事务的行（使该行只读）。您可以将数据库设置为只读，但不能只设置一行。

解释你的目的，这可能是一个更好的解决方案。隔离级别和锁定提示以及[行版本控制](http://msdn.microsoft.com/en-us/library/ms187101.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-22T15:03:16.487

您是否需要锁定**一行**，或者[Sql Server 的应用程序锁](http://www.sqlteam.com/article/application-locks-or-mutexes-in-sql-server-2005)是否应该满足您的需求？

应用程序锁只是一个具有名称的锁，您可以“锁定”、“解锁”并检查它是否被锁定。有关详细信息，请参阅上面的链接。（如果您的连接关闭等，它们会解锁，所以倾向于清理自己）

# iphone - Xcode 3.1.1 中的“Cocoa Touch 应用程序”模板

> ID：111653
> 
> 赞同：5
> 
> 时间：2008-09-21T18:34:05.050
> 
> 标签：iphone, xcode, cocoa-touch, xcode-template

刚刚为 iPhone 2.1 安装了最新的 SDK。当我在 Xcode 中转到 File -> New Project 时，在 iPhone OS Application 选择下，我没有看到“Cocoa Touch Application”的模板图标。我错过了什么吗？除了 iPhone SDK，我还需要下载什么吗？如果没有，如何将其添加到“iPhone OS 应用程序”模板中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T22:45:47.630

好的，经过一番挖掘，我发现了几篇似乎表明模板名称已更改的帖子（来自苹果支持网站）。所以问题不在于我们的模板，而在于视频教程——它们尚未更新。这是新旧之间的模板映射，我能说得最好：

Cocoa Touch OpenGL 应用程序 -> OpenGL ES 应用程序

Cocoa Touch Tab Bar -> Tab Bar Application

Cocoa Touch Utility -> Utility Application

Cocoa Touch Application -> Window-based Application / View based application

Cocoa Touch List -> 基于导航的应用程序

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T18:39:53.100

所有的模板（在 iPhone 下）都是基于 Cocoa 的。

它们之间的区别基本上在于您如何设置主视图和默认安装的导航控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T19:29:16.557

您不需要添加任何模板，这是默认情况下发生的。

与普通 Cocoa Touch 应用程序最接近的是基于窗口的应用程序，因为它为您提供了一个窗口和一个委托......

其他的，就像 Martin 说的那样，已经应用了不同的样式……OpenGL、导航控制器、视图等。

# project-management - 日程安排/估算游戏中的“峰值”如何计算？

> ID：111665
> 
> 赞同：2
> 
> 时间：2008-09-21T18:40:18.310
> 
> 标签：project-management, agile, estimation

可能是主观的和/或讨论的......但这里有。

我被要求为工作中的下一件大事估计一个功能。我把它分解..使用故事点来估计。然而，除了各种其他公司计划之外，该功能还需要与第三方图表组件 GoDiagrams 进行交互。（一整套 2008_Limited_Edition 框架/服务：）。我一直在使用燃尽图跟踪自己，我发现我无法维持我的步伐主要是由于“尖峰”..[定义](http://www.think-box.co.uk/blog/2006/01/spike.html)

我估计每周工作 2 点，然后我发现自己在周末工作（很好地尝试......最终既不在这里也不在那里），因为我不知道在哪里挂钩，以便我可以预览用户操作，显示上下文菜单等。最后，我花时间制作尖峰，使我的日程表偏离轨道……并降低其价值……没有给出正确的画面。

钉子需要钉子穿过无知的木板。但是它们是如何被纳入估计方程的呢？在功能看起来错误之前执行所有必需的尖峰..（可能会变成 YAGNI）在两者之间执行它会破坏我的流程。现在它是在预迭代计划期间..但这每周都会将接触线推开。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-21T19:08:38.087

我猜你一直在**低估**

*   您对第 3 方组件的了解
*   您需要多长时间才能为未知区域创建可用/有用的尖峰

**1\. 更好地估计这两件事。**

所以，这一切都与经验有关。无论您使用哪种方法，它们都会帮助您更好地使用您的体验，而不是取代它。

**2\. 在处理这些尖峰时尽量不要迷失方向。**

它们应该是简短的、有时间限制的会议。他们并不是要玩弄营销幻灯片上列出的所有可能的功能。给他们专注，两到三个选项去探索。期望他们提供一个具体的结果。

*更新（Gishu）：总结*

*   尖峰需要是在迭代计划步骤中定义的明确任务。
*   如果峰值超过时间盒周期，请停止处理它。搁置相关的任务。完成当前迭代桶中的其他任务。返回搁置的任务或将更精细/细分的峰值与相关任务一起添加到下一次迭代。下次对第 1 代尖峰标记一个更保守的估计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T14:19:39.753

如果您的时间盒峰值时间用完了，您仍然应该停止并完成其他已提交的工作。然后，您应该在下一次迭代中添加另一个尖峰，以完成您需要完成的必要工作，以便准确估计尖峰产生的任务。

如果有人担心让事情变得太长并且这成为一个问题 - 这就是我喜欢 1 周迭代的原因之一。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T03:02:54.530

@pointernil .. 再加上 Indy-Jones Head-First 方法来处理故事，这更像是没有估计。我根据故事的内容来估计故事。目前我没有考虑找到正确的咒语以使控制库发挥出色所需的时间。这有时比我的应用程序逻辑花费更多的时间。所以重新表述原始问题，**尖峰是否应该是迭代计划中的单独任务，在您开始处理特定故事之前在 JIT 基础上添加？**

我的 Spikes 非常专注……我迫不及待地想回到“真正的”问题。例如“我如何显示这个控件的上下文菜单？” 我可能会因为没有阅读整个 150 多页的手册或代码示例而感到内疚……但是时间很紧。解决问题的第一个解决方案得到了点头，我继续前进。但是，当您无法找到组件使用的难以捉摸的事件或 NIH 通知模式时，峰值可能会很耗时。**我如何对未知的事物进行时间限制？**例如，我的时间盒已经过去，我仍然不知道插入我的自定义上下文菜单。我该如何进行？继续黑客攻击？

也许这出现在“缓冲不确定性”方案中。如果我在 Mike Cohn 的书中找到有用的东西，我会看看。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T03:20:17.907

我同意指针。唯一的问题是您的估计不正确。这没什么大不了的，当然除非你刚刚完成了一个 300 万美元的项目 :-)

如果它发生一次，它的学习经验。如果它再次发生并且结果更好，那么您将获得另一种学习经验。如果你经常低估并且你的百分比越来越差，你需要明智一点。没有任何方法可以让你摆脱困境。

尖峰只需要给予他们需要的时间。根据我的经验，我经常看到的一件事是人们希望能够在几个小时或一天内确定一项技术。这只是在现实生活中不会发生。最简单的问题，即使是由拼写错误引起的错误，也可能让开发人员花费大量时间。诚实地说明自己或您的员工的能力，并将其纳入预算。

# .net - 对多线程应用程序进行单元测试？

> ID：111676
> 
> 赞同：33
> 
> 时间：2008-09-21T18:43:19.833
> 
> 标签：.net, multithreading, unit-testing

有没有人对单元测试多线程应用程序的一致方式有任何建议？我已经完成了一个应用程序，其中我们的模拟“工作线程”有一个 thread.sleep，其时间由公共成员变量指定。我们将使用它，以便我们可以设置特定线程完成其工作所需的时间，然后我们可以进行断言。有更好的方法来做到这一点吗？有什么好的.Net 模拟框架可以处理这个问题吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-26T08:35:16.960

第一步是要意识到，您需要进行单元测试的大部分代码通常与线程正交。这意味着您应该尝试将执行工作的代码与执行线程的代码分开。完成后，您可以使用正常的单元测试实践轻松测试完成工作的代码。但当然，你知道这一点。

然后问题是测试问题的线程方面，但至少现在你有一个点，这个线程与执行工作的代码接口，并且希望你有一个可以模拟的接口。现在您已经有了线程代码调用的代码的模拟，我发现最好的办法是向模拟添加一些事件（这可能意味着您需要手动滚动模拟）。然后这些事件将用于允许测试与被测线程代码同步并阻塞。

例如，假设我们有一个非常简单的东西，一个处理工作项的多线程队列。你会模拟工作项。该接口可能包含线程调用以完成工作的“Process()”方法。你会在那里放两个事件。一个是在调用 Process() 时模拟设置的，另一个是模拟在设置第一个事件后等待的。现在，在您的测试中，您可以启动队列，发布模拟工作项，然后等待工作项的“我正在处理”事件。如果您正在测试的只是该进程被调用，那么您可以设置另一个事件并让线程继续。如果您正在测试更复杂的东西，例如队列如何处理多个调度或其他东西，那么您可能会在释放线程之前做其他事情（例如发布并等待其他工作项）。

我确定您的情况更复杂，但这是我用来测试线程代码的基本方法，并且效果很好。如果您模拟出正确的位并放入同步点，您可以对多线程代码进行惊人的控制。

这里有一些关于这种事情的更多信息，虽然它是在谈论 C++ 代码库：http: [//www.lenholgate.com/blog/2004/05/practical-testing.html](http://www.lenholgate.com/blog/2004/05/practical-testing.html)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-21T19:17:33.587

我的建议是不要依赖单元测试来检测并发问题，原因如下：

*   缺乏可重复性：测试只会偶尔失败一次，并且对查明问题没有真正的帮助。
*   不稳定的失败构建会惹恼团队中的每个人 - 因为最后一次提交总是被错误地怀疑是失败构建的原因。
*   遇到死锁可能会冻结构建，直到遇到执行超时，这会显着减慢构建速度。
*   构建环境很可能是一个单 CPU 环境（认为构建在 VM 中运行），其中可能永远不会发生并发问题 - 无论设置了多少睡眠时间。
*   它以某种方式挫败了拥有简单、隔离的验证代码*单元的想法。*

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-21T19:09:47.477

如果您必须测试后台线程是否执行某些操作，我觉得很方便的一个简单技术是拥有一个 WaitUntilTrue 方法，它看起来像这样：

```
bool WaitUntilTrue(Func<bool> func,
              int timeoutInMillis,
              int timeBetweenChecksMillis)
{
    Stopwatch stopwatch = Stopwatch.StartNew();

    while(stopwatch.ElapsedMilliseconds < timeoutInMillis)
    {
        if (func())
            return true;
        Thread.Sleep(timeBetweenChecksMillis);
    }   
    return false;
} 
```

像这样使用：

```
volatile bool backgroundThreadHasFinished = false;
//run your multithreaded test and make sure the thread sets the above variable.

Assert.IsTrue(WaitUntilTrue(x => backgroundThreadHasFinished, 1000, 10)); 
```

这样，您不必让主测试线程长时间休眠以让后台线程有时间完成。如果后台没有在合理的时间内完成，则测试失败。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-21T18:47:03.660

[TypeMock](http://www.typemock.com/)（商业）有一个单元测试框架，可以自动尝试在多线程应用程序中查找死锁，我认为可以设置为运行具有可预测上下文切换的线程。

我本周在一个节目中看到了一个演示——显然它是在 Alpha（称为 Racer）中

[http://www.typemock.com/Typemock_software_development_tools.html](http://www.typemock.com/Typemock_software_development_tools.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-03-23T13:57:34.560

我遇到了一个名为[Microsoft Chess](http://research.microsoft.com/en-us/projects/chess/)的研究产品。它专为多线程应用程序的非确定性测试而设计。到目前为止的缺点是它已集成到 VS 中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-21T21:34:45.660

在多处理器机器上测试多线程代码很重要。双核机器可能还不够。我已经看到死锁发生在 4 处理器机器上，而双核单处理器不会发生死锁。然后，您需要基于生成许多线程并对目标应用程序发出多个请求的客户端程序创建压力测试。如果客户端机器也是多处理器的，这会有所帮助，这样目标应用程序就会有更多的负载。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-22T17:32:17.197

我不认为单元测试是查找线程错误的有效方法，但它们可以是演示已知线程错误、隔离它并测试你的修复的好方法。我还使用它们来测试我的应用程序中某些协调类的基本功能，例如阻塞队列。

我将[多线程](http://www.cs.umd.edu/projects/PL/multithreadedtc/overview.html)TC库从 Java 移植到 .NET，并将其命名为[TickingTest](https://github.com/donkirkby/donkirkby/tree/master/TickingTest)。它允许您从一个单元测试方法启动多个线程并协调它们。它没有原版的所有功能，但我发现它很有用。它缺少的最大的东西是监视在测试期间启动的线程的能力。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-21T18:48:42.113

不完全是单元测试，但您可以编写一些测试代码，重复调用将在不同线程上执行的代码。尝试通过定期或最终一致性检查在线程之间创建最大交错。当然，这种方法具有不可重现的缺点，因此您需要使用大量日志记录来找出问题所在。这种方法最好与每个线程单独任务的单元测试相结合。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-21T18:51:05.570

像 GUI 单元测试一样，这有点像自动化测试的滑铁卢。根据定义，真正的线程是......不可预测的......它们会以无法预先确定的方式进行干扰。因此，即使不是不可能，编写**真正的测试也很困难。**

但是，您有一些公司...我建议搜索**testdrivendevelopment** yahoo 组的档案。我记得附近有一些帖子。[这是较新的帖子之一。](http://tech.groups.yahoo.com/group/testdrivendevelopment/message/28807) *（如果有人愿意扫射和解释……那就太好了。我太困了……需要这样）*

# automation - 您如何自动化一些常规操作以提高生产力？

> ID：111683
> 
> 赞同：7
> 
> 时间：2008-09-21T18:45:01.483
> 
> 标签：automation

每天早上，登录到您的机器后，您都会做各种日常工作。该列表可以包括诸如打开/检查您的电子邮件客户端、RSS 阅读器、启动 Visual Studio、运行一些业务应用程序、输入一些回复、从源代码控制获取最新版本、编译、连接到不同域等内容。在很大程度上，我们可以使用[AutoIt](http://www.autoitscript.com/autoit3/)、夜​​间作业等脚本解决方案实现自动化。

我很想听听您的极客们的意见，了解您发现反复做的事情的清单，以及您如何通过自动化来解决它。有什么很酷的提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T18:50:31.390

我使用 Linux。我有一堆脚本可以做任何我想做的事情。通常，只要将来可以重用“块”工作，我就会编写脚本。例如，简单的重构、部署等......

随着时间的推移，我开始将这些块组合起来，从而变得更加高效。

关于“启动时加载内容”，在 Linux 下开箱即用（您可以在注销或关闭计算机时“保存当前会话”）。

在 Windows 上，我的建议是使用可以通过命令行自动化的程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T18:51:09.610

一个最喜欢的方法是让电脑在晚上或更好，如果它是一台笔记本电脑，让它进入睡眠状态。在 VMware 或类似的工作中运行 Web 浏览虚拟机，您可以设置 VM 与机器一起启动并在关闭时保存其状态，因此您的网页和电子邮件客户端保持打开状态。如果您正在编写脚本或类似的东西，这也适用于开发，其中 VM 在大型编译时的性能影响不会抵消这些好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T18:52:50.620

**[SlickRun](http://www.bayden.com/SlickRun/)**对此非常方便，只需几个键即可导航到任何常见的内容，并且占用空间非常小。通过输入变量和文件路径识别，我可以快速远程桌面到任何机器，搜索任何东西，提取任何需要的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T19:08:38.460

在 OS X 上，我有一个在一天开始时运行的 Applescript。它会在 IM 上设置离开消息、隐藏或退出会分散我注意力的程序、接收新邮件等等。我还插入了我的 USB 备份磁盘，所以当我回家时，另一个脚本会弹出它并退出一些程序。剧本完成后，我也完成了。

我使用 Quicksilver 使用组合键调用这些脚本。

顺便说一句，如果您没有 Mac，Quicksilver 和 Applescript 可能是切换的第一和第二理由。在它们两者之间，您可以告诉您的计算机在很短的时间内执行几乎任何您想做的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T19:18:41.883

使用 Quicksilver 或 Launchy 等优秀的[应用程序启动器](https://stackoverflow.com/questions/107383/what-is-the-best-windows-program-launcher)来减少执行简单任务所需的时间。它们通常不可编写脚本，但它们确实可以让您更快地完成每一步。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-21T19:23:11.593

编写 shell 脚本（Applescript、Bash、PowerShell 等）是自动化大多数平凡任务的好方法，假设您的应用程序是可编写脚本的，并且可以选择一种新语言。随着您进一步尝试这种做法，您会发现自己对使用的不可编写脚本的应用程序越来越恼火，以至于它开始影响您对应用程序的选择；-)

此外，请考虑使用 cron 作业、Windows 计划任务或类似的 OS X 类似物在一天/周/月/年的特定时间自动运行特定任务。您可以将其用于前面提到的“工作日早晨”脚本中的任何内容，以及每年提醒您妻子的生日和周年纪念日。[这里](http://en.wikipedia.org/wiki/Cron)有一些关于 *NIX 系统的更多信息，或者[这里](http://lifehacker.com/software/feature/hack-attack-using-windows-scheduled-tasks-153089.php)有关于 Windows 机器的更多信息。

快乐的自动化！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-21T19:33:16.733

我很难理解 Applescript，但由于 Apple 可以很好地运行 BASH 脚本，所以我只使用它们。我的 Mac 上有一个开发服务器，所以我有一个脚本，我可以运行它来创建一个新的站点目录、在 apache 中创建一个新的虚拟主机、将一个新域添加到我的 /etc/hosts 文件等.

将 Bash（或者可能是 applescript，虽然我不知道如何）与[Growl](http://growl.info/documentation/growlnotify.php)集成起来特别酷。这样，您可以在屏幕上显示一条漂亮的消息，并带有一个 png 图标。不过，这对于您的脚本在白天所做的事情更有用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-21T19:37:34.367

我在工作中的开发服务器上完成了我的大部分编程工作，所以晚上我只需分离我的屏幕会话并在早上重新附加它，所以只需几秒钟，我就可以准确地离开那天前。

我在 mutt 中定义了一些宏来清理我的收件箱（存档提交邮件等），我有一个脚本，它通过 sshfs 在我的笔记本上的开发服务器上安装一些目录（无需使用公钥进行交互），然后所有我要做的是启动浏览器并喝杯咖啡。:)

# wpf - DropShadowBitmapEffect 不适用于 TextBlock

> ID：111686
> 
> 赞同：0
> 
> 时间：2008-09-21T18:45:42.760
> 
> 标签：wpf, bitmapeffect

有谁知道为什么 DropShadowBitmapEffect 和 EmbossBitmapEffect 不能在 WPF 中的 TextBlock（不是 textBOX）上工作？OuterGlow、Blur 和 Bevel 似乎工作正常。

* * *

透明背景画笔显然不是答案，因为您*可以*使用空背景画笔获得阴影。阴影的默认柔和度为 50%，如果您的字体较小，则柔和度会过多地消散阴影。在 39% 的柔和度附近似乎有一个急剧下降（此时阴影或多或少地消失了）。尝试将其设置为 0，然后慢慢向上移动，直到找到一个仍然显示阴影的数字。

* * *

另一个注意事项：柔软度绝对是一个因素，但请注意，在 Xaml 中，有效值实际上只有 0 到 1，但在 Blend 中，它显示为高达 100 的百分比。因此，如果您在 Xaml 中将值设置为 100，它会完全消散。

* * *

背景笔刷 = 透明解决方案仍可用于浮雕效果

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T18:52:25.723

位图效果通过查看渲染后的像素并对它们运行标准图像处理来工作。它应该只取决于像素的颜色。我想知道他们的算法是否不适用于白色。尝试更改颜色以查看是否有效果 - 如果有效果，您可能想尝试在下方放置一个黑色面板，并在其上设置阴影。

编辑：提问者找到了答案

“感谢您为我指明正确的总体方向。重要的是文本的颜色或 DropShadow，需要的是使 TextBlock 上的背景画笔成为透明画笔 (Alpha = 0) 而不是 null。 "

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T23:53:54.983

**重要的旁注：**你不应该再使用 BitmapEffects 了。使用基于 .net 3.5 SP1 中引入的 ShaderModel 效果的 Effect 属性，它使用硬件渲染并且具有更好的性能。

[更多信息](http://msdn.microsoft.com/en-us/library/system.windows.media.effects.effect.aspx)

# ruby - Ruby - 确保 Syslog 被关闭

> ID：111687
> 
> 赞同：1
> 
> 时间：2008-09-21T18:46:01.637
> 
> 标签：ruby, syslog

使用完 Syslog 后总是关闭它是绝对重要的吗？不这样做会产生巨大的负面影响吗？

如果事实证明我绝对需要，那么有什么好方法呢？我在我的类构造函数中打开 Syslog，但我看不到在 Ruby 中执行类析构函数的方法，目前有类似这样的东西：

```
class Foo
  def initialize
    @@log = Syslog.open("foo")
  end
end 
```

`Syslog.close`我没有立即看到应该打电话的地方，但你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T18:54:33.707

open 方法接受一个块。做这样的事情：

```
class Foo
  def do_something
    Syslog.open do
      # work with the syslog here
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T19:24:25.163

看起来你正在将它作为类变量打开......所以正确的方法是......

```
class Foo
  def initialize
    @@log = Syslog.open("foo")
  end

  def Foo.finalize(id)
    @@log.close if @@log
  end
end 
```

尽管这不一定是可预测或支持的。如果您要按照自己的方式保留代码，这就是这样做的方法。

# emulation - 6502 CPU 仿真

> ID：111700
> 
> 赞同：20
> 
> 时间：2008-09-21T18:50:06.320
> 
> 标签：emulation, machine-language, 6502

这是周末，所以我通过编写一个爱好项目来放松整个星期的编程。

昨天写了一个MOS 6502 CPU仿真器的框架，实现了寄存器、栈、内存和所有的操作码。（链接到下面的源）

我可以在我编写的调试器中手动运行一系列操作，但我想加载一个 NES rom 并将程序计数器指向它的指令，我认为这将是找到有缺陷的操作码的最快方法。

我编写了一个快速的 NES ROM 加载器并将 ROM 库加载到 CPU 内存中。

问题是我不知道操作码是如何编码的。我知道操作码本身遵循每个操作码一个字节的模式，该模式唯一地标识操作码，

```
0 - BRK
1 - ORA (D,X)
2 - COP b 
```

ETC

但是我不确定我应该在哪里找到操作码参数。是直接跟在后面的字节吗？在绝对内存中，我想它可能不是一个字节，而是一个短字节。

有人熟悉这个 CPU 的内存模型吗？

编辑：我意识到这可能是在黑暗中拍摄的，但我希望有一些老派的 Apple 和 Commodore 黑客潜伏在这里。

**编辑：**感谢大家的帮助。在我实施适当的更改以对齐每个操作后，CPU 可以加载和运行马里奥兄弟。它除了循环等待开始之外什么都不做，但这是一个好兆头:)

我上传了源码：

[https://archive.codeplex.com/?p=cpu6502](https://archive.codeplex.com/?p=cpu6502)

如果有人想知道模拟器是如何工作的，那么它很容易理解。至少没有优化，但话又说回来，我正在模拟一个在 2.4ghz 机器上以 2mhz 运行的 CPU :)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-21T18:59:56.733

操作码占用一个字节，操作数在后面的字节中。[例如，查看此处](http://www.atariarchives.org/2bml/chapter_10.php)的字节大小列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-21T19:03:49.940

如果您查看[http://www.atarimax.com/jindroush.atari.org/aopc.html](http://www.atarimax.com/jindroush.atari.org/aopc.html)之类的参考资料，您会看到每个操作码都有一个指定为的编码：

```
HEX LEN TIM 
```

HEX 是您的 1 字节操作码。紧随其后的是 LEN 字节的参数。请查阅参考资料以了解这些论点是什么。TIM 数据对仿真器很重要——它是该指令执行所需的时钟周期数。你需要这个来让你的时间正确。

这些值（LEN、TIM）未在操作码本身中编码。您需要将此数据存储在程序加载器/执行器中。这只是一个大查找表。或者您可以定义一种迷你语言来对数据和阅读器进行编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T18:57:54.510

这本书可能会有所帮助： http: [//www.atariarchives.org/mlb/](http://www.atariarchives.org/mlb/)

此外，尝试检查任何其他 6502 汇编器/模拟器/调试器，以了解汇编如何被编码为机器语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T19:09:37.927

6502 手册在网络上的各个历史站点上。KIM-1 随他们一起发货。也许他们比你需要知道的更多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-20T15:35:03.637

这更好 - 6502指令集矩阵：

[https://www.masswerk.at/6502/6502_instruction_set.html](https://www.masswerk.at/6502/6502_instruction_set.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T23:33:11.210

Apple II rom 包含一个反汇编程序，我想这就是它的名称，它会以一种很好的格式向您显示十六进制操作码和 3 个字符操作码和操作数。

因此，鉴于可用内存很少，他们设法将整个 6502 指令集的 3 个字符操作码的操作数字节数（始终为 0、1 或 2）塞入一个非常小的空间，因为它真的不多。

如果你能挖出一个apple II rom，你可以从那里剪切和粘贴......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-18T15:21:50.620

6502有不同的寻址模式，同一条指令有几个不同的操作码取决于它的寻址模式。查看以下链接，这些链接描述了 6502 从内存或直接从 ROM 中检索数据的不同方式。

[http://obelisk.me.uk/6502/addressing.html#IMM](http://obelisk.me.uk/6502/addressing.html#IMM)

# sql - 零 SQL 死锁设计 - 任何编码模式？

> ID：111707
> 
> 赞同：32
> 
> 时间：2008-09-21T18:51:23.387
> 
> 标签：sql, sql-server, design-patterns, deadlock

我在运行在 MS SQL Server 2005 之上的 .NET 2.0 webapp 上遇到了非常罕见但令人讨厌的 SQL 死锁。过去，我们一直以非常经验的方式处理 SQL 死锁 - 基本上是调整查询直到它工作。

然而，我发现这种方法非常不令人满意：耗时且不可靠。我非常希望遵循确定性查询模式，这些模式将**通过设计**确保不会遇到 SQL 死锁 - 永远。

例如，在 C# 多线程编程中，一个简单的设计规则（如*锁）必须按照其字典顺序*来确保*不会*发生死锁。

是否有任何 SQL 编码模式可以保证是防死锁的？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-21T21:41:25.333

编写防死锁代码真的很难。即使您以相同的顺序访问表，您仍然可能会遇到死锁 [1]。[我在我的博客上](http://samsaffron.com/archive/2008/08/27/Deadlocked+)写了一篇文章，详细阐述了一些有助于避免和解决死锁情况的方法。

如果您想确保两个语句/事务永远不会死锁，您可以通过使用**sp_lock**系统存储过程观察每个语句使用哪些锁来实现它。为此，您必须要么非常快，要么使用带有锁定提示的打开事务。

* * *

笔记：

1.  任何一次需要多个锁的 SELECT 语句都可能因智能设计的事务而死锁，该事务以相反的顺序获取锁。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-22T02:34:06.127

在一般情况下，零死锁基本上是一个代价高昂的问题，因为您必须知道要为每个正在运行的事务（包括 SELECT）读取和修改的所有表/对象。一般哲学称为**有序严格两阶段锁定**（不要与两阶段提交混淆）（[http://en.wikipedia.org/wiki/Two_phase_locking](http://en.wikipedia.org/wiki/Two_phase_locking)；即使 2PL 也不能*保证*没有死锁）

很少有 DBMS 真正实施严格的 2PL，因为这样的事情会导致巨大的性能损失（没有免费的午餐），而您的所有事务都在等待执行甚至是简单的 SELECT 语句。

无论如何，如果这是您真正感兴趣的东西，请查看`SET ISOLATION LEVEL`SQL Server。您可以根据需要进行调整。[http://en.wikipedia.org/wiki/Isolation_level](http://en.wikipedia.org/wiki/Isolation_level)

有关更多信息，请参阅关于 Serializability 的维基百科：[http ://en.wikipedia.org/wiki/Serializability](http://en.wikipedia.org/wiki/Serializability)

也就是说——一个很好的类比就像源代码修订：尽早并经常检查。让您的事务保持小（以 SQL 语句数、修改的行数为单位）和快速（挂钟时间有助于避免与其他人发生冲突）。在一个事务中做很多事情可能会很好而且很整洁——总的来说我同意这个哲学——但是如果你遇到很多死锁，你可以把事务分解成更小的事务，然后在您移动时检查他们在应用程序中的状态。TRAN 1 - OK Y/N？如果是，发送 TRAN 2 - OK Y/N? 等等等等

顺便说一句，在我作为一名 DBA 和开发人员（测量数千个并发用户的多用户 DB 应用程序）的多年中，我从未发现死锁是一个如此严重的问题，以至于我需要特别注意它（或改变隔离）水平无忧无虑等）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-08T05:36:22.813

对于这个问题，在实践中没有神奇的通用解决方案。您可以将并发推送到应用程序，但这可能非常复杂，特别是如果您需要与在单独的内存空间中运行的其他程序进行协调。

减少死锁机会的一般答案：

1.  基本查询优化（适当的索引使用）热点避免设计，尽可能短的时间保持事务......等。

2.  尽可能设置合理的查询超时，以便如果发生死锁，它会在超时期限到期后自行清除。

3.  MSSQL 中的死锁通常是由于其默认的读取并发模型，因此不依赖它非常重要 - 在所有设计中假设 Oracle 风格的 MVCC。使用快照隔离，或者如果可能，使用 READ UNCOMMITED 隔离级别。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-14T19:57:28.740

我相信以下有用的读/写模式是死锁证明给定一些限制：

约束：

1.  一张桌子
2.  索引或 PK 用于读/写，因此引擎不会求助于表锁。
3.  可以使用单个 SQL where 子句读取一批记录。
4.  使用 SQL Server 术语。

写周期：

1.  单个“已提交读”事务中的所有写入。
2.  事务中的第一次更新是针对每个更新组中的特定的、始终存在的记录。
3.  然后可以以任何顺序写入多个记录。（它们受到写入第一条记录的“保护”）。

阅读周期：

1.  默认的读提交事务级别
2.  无交易
3.  将记录作为单个选择语句读取。

好处：

1.  二级写周期在写第一条记录时被阻塞，直到第一个写事务完全完成。
2.  在写入提交之间以原子方式阻止/排队/执行读取。
3.  无需借助“可序列化”即可实现事务级别的一致性。

我也需要这个工作，所以请评论/更正！！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T18:57:20.733

正如您所说，始终以相同的顺序访问表是避免死锁的好方法。此外，尽可能缩短您的交易时间。

另一个很酷的技巧是尽可能将 2 个 sql 语句组合在一起。单个语句始终是事务性的。例如使用“UPDATE ... SELECT”或“INSERT ... SELECT”，使用“@@ERROR”和“@@ROWCOUNT”而不是“SELECT COUNT”或“IF (EXISTS ...)”

最后，确保您的调用代码可以通过以可配置的次数重新发布查询来处理死锁。有时它只是发生，这是正常行为，您的应用程序必须能够处理它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T02:49:50.973

如果您对应用程序有足够的设计控制权，请将更新/插入限制为特定的存储过程，并从应用程序使用的数据库角色中删除更新/插入权限（仅明确允许通过这些存储过程进行更新）。

将您的数据库连接隔离到应用程序中的特定类（每个连接都必须来自此类）并指定“仅查询”连接将隔离级别设置为“脏读”......相当于每个连接上的（nolock） .

这样，您就可以隔离*可能*导致锁定的活动（针对特定的存储过程）并从“锁定循环”中取出“简单读取”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T05:05:06.703

除了一致的锁获取顺序之外 - 另一条路径是显式使用锁定和隔离提示来减少在读取期间无意获取锁（例如共享意图）所浪费的时间/资源。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-03T01:23:25.140

没有人提到的（令人惊讶的）是，在 SQL 服务器方面，许多锁定问题可以通过数据库查询工作负载的正确覆盖索引​​集来消除。为什么？因为它可以大大减少对表的聚集索引（假设它不是堆）的书签查找次数，从而减少争用和锁定。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T03:43:13.280

快速回答是否定的，没有保证技术。

如果它具有任何非平凡的吞吐量，我看不出如何将任何应用程序死锁证明作为设计原则。如果您以相同的顺序预先锁定进程中可能需要的所有资源，即使您最终不需要它们，您也会面临第二个进程等待获取它需要的第一个锁的代价更高的问题，并且您的可用性受到影响。随着系统中资源数量的增长，即使是微不足道的进程也必须以相同的顺序锁定它们以防止死锁。

与大多数性能和可用性问题一样，解决 SQL 死锁问题的最佳方法是查看分析器中的工作负载并了解行为。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T05:55:18.733

不是直接回答您的问题，而是值得深思：

[http://en.wikipedia.org/wiki/Dining_philosophers_problem](http://en.wikipedia.org/wiki/Dining_philosophers_problem)

“餐饮哲学家问题”是一个古老的思想实验，用于检验死锁问题。阅读它可能会帮助您找到针对您的特定情况的解决方案。

# winforms - 您如何“预览”用户操作，例如在 GoDiagrams 中调整大小或编辑？

> ID：111744
> 
> 赞同：2
> 
> 时间：2008-09-21T19:01:21.333
> 
> 标签：winforms, controls

*   GoDiagram 对象模型有一个 GoDocument。
*   GoViews 有对 GoDocument 的引用。
*   如果用户对图表表面进行任何修改，则会引发一个 GoDocument.Changed 事件，其中包含事件参数中的相关信息。

我希望在某些用户操作发生时收到通知，以便我可以与我的控制器协商（如果需要，禁止/取消它），然后从那里发出实际修改**Northwoods GoDiagram**第三方组件的视图更新命令。
Changed 事件是刚刚发生的事情的通知（过去时） - 在事件处理程序中执行上述所有操作会导致 ....（*等待它*）... StackOverflowException。（GoDocument.Changed 处理程序 > 更新 GoDocument > 触发新的 Changed 事件..）

那么问题来了，我如何在 GoDiagrams 中获得 BeforeEditing 或 BeforeResizing 类型的通知模型？有没有去过那里的人活着讲故事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T04:19:48.590

JFYI ...组件供应商的建议是为此子类化并覆盖适当的方法。覆盖 bool CanXXX() 方法，引发可取消的自定义事件。如果订阅者返回 false，则退出 CanXXX（**返回 false 以中止用户操作**）。 **GoDiagrams 中没有内置机制。**

> 例如，您可以定义一个 CustomView.ObjectResizing 可取消事件。在您覆盖 GoToolResizing.CanStart 时，您可以引发该事件。如果 CancelEventArgs.Cancel 属性变为 true，则 CanStart() 返回 false。

来源[http://www.nwoods.com/forum/forum_posts.asp?TID=2745](http://www.nwoods.com/forum/forum_posts.asp?TID=2745)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T21:17:17.283

更改事件的事件参数 (GoChangedEventArgs) 有一个属性 IsBeforeChanging，它指示更改事件是从“RaiseChanging”方法 (true) 还是从 RaiseChanged (false) 引发的。这应该告诉您更改是否已经发生，但我知道没有办法取消它。

我可以建议的最好的方法是检查是否允许更改并执行更改，而不是检查更改是否*不允许*，以及是否未对更改事件中的参数调用“撤消”方法。所以本质上：

```
OnChanged(GoChangedEventArgs e)
{
  if(NotAllowed)
  {
    e.Undo();
  }
} 
```

# web-applications - Debian存储库的Web界面工具？

> ID：111756
> 
> 赞同：1
> 
> 时间：2008-09-21T19:04:27.223
> 
> 标签：web-applications, debian, packaging

Debian 或 Ubuntu 用于在 Web 上公开其自定义存储库的 Web 界面工具是什么？

喜欢[packages.debian.org](http://www.debian.org/distrib/packages)

这种工具是开源的，以便可以重新用于自定义存储库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T16:13:23.740

管理存档的脚本是开源的，它们位于一个名为 dak 的 debian 包中。我认为这不包括网页，但我不确定。我建议发送电子邮件至 ftpmaster@debian.org 或 debian-www@lists.debian.org 并询问。

解析包文件确实非常简单，但是要从中制作一组漂亮的网页还有很多工作要做，所以如果你能掌握 debian 的用途，那将是值得一看的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T19:08:45.450

你真的只需要一些东西来解析包文件，不是吗？[示例包文件](http://ppa.launchpad.net/pidgin-developers/ubuntu/dists/hardy/main/binary-i386/Packages)。我以前从未尝试过这样做，但我无法想象这是一项可怕的任务。

编辑：好吧，从技术上讲，它会爬取 repo 来处理一系列 Packages 文件，但这不会使它变得更加困难。

编辑 2：除非您手动指定包文件。然后它会再次简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:35:05.377

如果您想获得那种类型的信息，可以使用 perl 模块来解析 Packages 文件，例如[DPKG::Parse可以做到这一点。](http://cpan.uwinnipeg.ca/htdocs/DPKG-Parse/DPKG/Parse.pm.html)您可以根据该数据构建一个与您提供的 URL 类似的网页。

debian 中还有一些工具可以创建“自定义存储库”。例如，这样的存储库可能包含您本地构建的包或您想要拥有的特定版本的东西。您可能想要查看执行此操作的工具是 reprepro、apt-ftparchive、mini-dinstall 和 debarchiver。我已经将 reprepro 用于个人包并且可以推荐它，我没有使用其他包。

Debian 使用了一个名为 dak 的工具，但它是为包含数千个软件包的 repo 而设计的，并且由于它被设计为仅供 debian 使用，因此文档记录很差。不建议用于个人包裹。

# security - 我在哪里可以了解共享加密密钥的成熟方法？

> ID：111763
> 
> 赞同：10
> 
> 时间：2008-09-21T19:06:23.350
> 
> 标签：security, language-agnostic, encryption, key-management

假设一个组想要加密一些信息，然后在组成员之间共享加密密钥，这种方式需要组的共识来解密信息。我对各种场景感兴趣，其中共识的广度从一致同意到绝对多数不等。一种有用的技术可以应用于对称密钥、私钥或两者。

我可以尝试使用自己的方法，我相信许多 SO 成员都可以。但就这个问题而言，我*只*对已广泛发表并经受住密码分析专家审查的方法感兴趣。期刊引用很好，但对学术来源的解释也非常有用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-21T19:13:26.670

我一直对这种秘密分享技术很着迷。我在互联网上看到过实现它的代码，但从未见过实际的应用程序。 [Shamir 的秘密分享](http://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing) 维基百科文章链接到一些实际代码，以及原始学术文章。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-21T19:26:11.773

你所描述的听起来很像“秘密分裂”（第 12.1 节。Cyptography 简介。Trappe 和华盛顿。第 2 版）基本思想是你可以想出一个多项式，其中包括你的“秘密”（一个键）作为一个点在线上。您可以通过选择该多项式上的其他点来分配“份额”。两点定义了一条 f(x) = ax + b 形式的直线，三个点定义了一个 f(x) = ax^2 + bx + c 形式的多项式，四个点定义了一个 f(x) 形式的东西= ax^3 + bx^2 + cx + d，以此类推。您可以选择一个多项式，其中包含您的秘密作为一个点，并且该多项式的次数足以让任何 N 个人都可以重建它。

这是被称为“沙米尔阈值方案”的基本思想。

参见关于[Secret Splitting](http://en.wikipedia.org/wiki/Secret_sharing)和[Shamir's Secret Sharing](http://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing) 的维基百科 维基百科页面有一些指向这个想法的实现的链接，包括[Windows](http://sourceforge.net/projects/secretsharp/)和[UNIX](http://point-at-infinity.org/ssss/index.html)的 GPL 代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T20:22:54.007

这很容易通过[纠错码](http://en.wikipedia.org/wiki/Error-correcting_codes)实现。您可以使用命令行工具，例如*par2*（顺便说一句，它并不完全适合此特定目的，因为它会生成大小不同的恢复块）。假设您有 (n+m) 个选民，并且想要获得 n 票的法定人数。您生成 n 个私钥 K₁∘、K₂、... Kn，并生成 m 个额外的相同大小的 ECC 块 Pₓ。这样任何 n 块都足以重构密码 K₁∘K₂∘...∘Kn

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T21:48:02.853

去这里讨论 Shamir 秘密分享的数学基础，并简要讨论它所具有的实际应用类型。向下滚动页面到关于多项式和秘密共享的讲义。这可能是对该地区的基本概述，但对您来说应该很有趣。 [离散数学笔记](http://www.cs.berkeley.edu/~daw/teaching/cs70-s08/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-14T19:52:04.523

Lotus Notes 提供了“Silo 密码”的实用实现，其中对某些资源（数据/信息/文档）的访问被锁定为“共享 ID” - 设置了 ID（我认为基于 RSA 的经过认证的 PKI 系统的一部分）有 2 个或更多（我认为最多 16 个）个人用户密码。验证者/管理员设置了一个方案，其中任何数量的可用密码或所有密码都是必要的，以“打开”id 以供主动使用。此过程通常用于将 Org 或 OU 证书锁定给 5 名中的 2 名或 5 名中的 3 名管理员/公司官员授予访问权限，从而确保可以控制高级证书的使用/访问并避免管理员人员缺席。

# installation - 如何在 Gentoo 2008 中安装屏蔽包？

> ID：111769
> 
> 赞同：3
> 
> 时间：2008-09-21T19:07:23.957
> 
> 标签：installation, gentoo

我搜索了网络和手册，但我只知道什么是屏蔽包，而不是如何安装它。我确实找到了一些命令，但它们似乎在 2008 年不起作用（看起来，这些命令似乎适用于早期版本）。我有这样的事情：

```
localhost ~ # emerge flamerobin
Calculating dependencies 
!!! All ebuilds that could satisfy "dev-db/flamerobin" have been masked.
!!! One of the following masked packages is required to complete your request:
- dev-db/flamerobin-0.8.6 (masked by: ~x86 keyword)
- dev-db/flamerobin-0.8.3 (masked by: ~x86 keyword) 
```

我想安装 0.8.6 版本，但不知道如何安装？我找到了一些说明，但它们告诉我编辑或写入 /etc/portage 下的某些文件。但是，我的系统上没有 /etc/portage：

```
localhost ~ # ls /etc/portage
ls: cannot access /etc/portage: No such file or directory 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-18T19:51:40.650

gentoo中有两种不同的面具。关键字掩码和包掩码。关键字掩码意味着您的架构不支持（或未经测试）该包，或者仍在测试中。包掩码意味着包因其他原因被掩码（对于大多数用户来说，取消掩码并不明智）。解决方案是：

*   添加一行到（`/etc/portage/package.keywords`检查部分）。这是针对关键字问题的。`man portage``package.keywords`
*   为“package.mask”问题添加一行`/etc/portage/package.unmask`（您也可以使用 package.mask 进行相反的处理）。这在同一个 man 文件中，在`package.unmask`. 我建议在这里使用版本化的原子，以避免在几个月后的未来版本中出现真正损坏的版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-09T00:27:30.413

如今，还有一个更“自动化”的解决方案，称为“autounmask”。无需更多文件编辑即可取消屏蔽！

该包的最大好处是，如果需要，它还可以取消屏蔽/处理依赖项的关键字。它在包 app-portage/autounmask 中提供。

*/etc/portage/package.keywords*和
*/etc/portage/package.unmask*

现在也可以是目录（但 autounmask 也可以处理单个文件）。在这些目录中，多个可以放置多个“autounmask”文件，每个“unmask”包的每个目录中都有一个文件。如果你使用单个文件而不是目录，'autounmask' 将放置某种页眉/页脚，这样如果需要，删除“unmasks”就变得很容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-21T19:10:21.297

只需 mkdir /etc/portage 并按照此处所述进行编辑：http://gentoo-wiki.com/TIP_Dealing_with_masked_pa​​ckages# [But_you_want_to_install_the_package_anyway](http://gentoo-wiki.com/TIP_Dealing_with_masked_packages#But_you_want_to_install_the_package_anyway) ...

# c# - Datagridview 虚拟模型组合框

> ID：111785
> 
> 赞同：1
> 
> 时间：2008-09-21T19:15:15.230
> 
> 标签：c#, datagridview, combobox

如何使用 datagridview 虚拟模式将项目动态添加到组合框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-21T19:25:54.487

好吧，我假设您正在处理大量数据，因此正在使用虚拟模式来实现您自己的数据绑定。

如果是这种情况，这里是一个演示该过程的链接：

[http://msdn.microsoft.com/en-us/library/2b177d6d.aspx](http://msdn.microsoft.com/en-us/library/2b177d6d.aspx)

它主要涉及为 CellValueNeeded 事件实现事件处理程序。

# .net - 使用属性初始化时如何格式化多个属性？（。网）

> ID：111792
> 
> 赞同：2
> 
> 时间：2008-09-21T19:20:55.873
> 
> 标签：.net, formatting, coding-style, convention

例如：

```
root.Nodes.Add(new TNode() { Foo1 = bar1, Foo2 = bar2, Foo3 = bar3 }); 
```

或者：

```
root.Nodes.Add(new TNode() { Foo1 = bar1, 
                             Foo2 = bar2, 
                             Foo3 = bar3 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T19:24:10.110

我已经完成了这两种方式.. IMO 这取决于初始化的复杂性。

如果它是简单的 2 或 3 个属性，我通常会在一行上进行初始化，但如果我正在设置一个具有插入数据库的值的对象或具有很多属性的东西，我会像你的第二个示例一样将其分解。

```
Income income = new Income
{
    Initials = something,
    CheckNumber = something,
    CheckDate = something,
    BranchNumber = something
}; 
```

或者

```
return new Report.ReportData { ReportName = something, Formulas = something}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T19:25:08.373

两种符号都很好。我只是建议在您的行保持在 100 个字符以内时使用第一个（1 行）表示法，并在表达式较长时切换到第二个（多行）表示法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T19:33:53.080

对于更长的东西，我这样做：

```
root.Nodes.Add(new TNode() {
    Foo1 = bar1, 
    Foo2 = bar2, 
    Foo3 = bar3
}); 
```

# naming-conventions - 用于在代码隐藏中引用的 UI 控件命名约定的最佳实践？

> ID：111812
> 
> 赞同：7
> 
> 时间：2008-09-21T19:26:01.587
> 
> 标签：naming-conventions, report

命名表单和报告上的 UI 控件（文本框、下拉列表等）以供代码隐藏页面参考的最佳做法是什么？

我在办公室里开发了很多报告和表格。我有几个 Web 应用程序提供大约 80 多个“实时”报告，这些报告是从各种和多个数据源（Access、SQL、Oracle）生成的。这些报告被认为是“实时的”，因为它们接受来自表单的用户设置参数，然后查询数据库以根据当前可用信息生成报告。

因此，该过程从获取用户设置的值开始，将这些值传递给数据库查询，接收数据集，最后将数据集分配给报表。在某些情况下，需要从数据集计算报表上显示的其他字段，然后才能生成报表。这需要参考报表上的输出控件来分配计算值。

虽然我并不真正关心在我的代码中为变量或成员字段使用前缀，但我确实使用它们来标识 UI 控件。例如，txtFirstName 引用报表控件以将数据集中 FirstName 字段中的数据分配给报表上的显示控件。是否有更好的做法来命名/引用表单和报告上的 UI 控件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-21T20:04:28.157

我在工作中使用的主要产品使用 txt_pnl_ 等前缀。这确实有效，尽管有时将仅隐藏/显示控件的内容从 tr 切换到面板时会有些痛苦，因为您必须重命名它。

我在新项目中开始做的是用 ui 前缀命名我的 UI 控件；例如，uiName。由于我强烈反对[反匈牙利符号](http://blogs.msdn.com/rick_schaut/archive/2004/02/14/73108.aspx)，并努力实现[自文档化代码](http://codebetter.com/blogs/eric.wise/archive/2005/12/06/135418.aspx)，所以这个约定很好用。事实上，如果有的话，它是*真正的*匈牙利符号（ui 是前缀表示用户界面控制）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-21T20:28:40.343

我仍然将匈牙利符号用于控件，但不再用于变量。

```
btn Button
cbo ComboBox
chk CheckBox
clb CheckedListBox
grp GroupBox
iml ImageList
lbl Label
lnk Hyperlink
mnu Menu
pbr ProgressBar
pic Picture
pnl Panel
rtb RichTextBox
tmr Timer
tvw TreeView
txt TextBox 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-21T21:04:22.987

对于 GUI 控件，我在变量名称后加上控件名称：

*   名字文本框
*   姓氏文本框
*   提交按钮

这使得例如 _firstName 和 firstNameTextBox.Text 之间的关系显而易见，并且没有人必须记住匈牙利符号等价物是什么。在命名变量时，我总是选择清晰而不是简洁。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-21T19:32:06.377

您在这里的回答将非常主观。不同的品味和编程背景会给你不同的喜好。

从长远来看，也许对您来说最重要的是所有项目之间的一致性，这样无论谁开发了代码，您都可以在阅读时理解它。

我们外包了很多，因此请确保将我们的命名约定传达给我们所有的项目经理。

以下是一些命名约定的链接：

[http://www.irritatedvowel.net/Programming/Standards.aspx](http://www.irritatedvowel.net/Programming/Standards.aspx)

[http://msdn.microsoft.com/en-us/library/xzf533w0(VS.71).aspx](http://msdn.microsoft.com/en-us/library/xzf533w0(VS.71).aspx)

[http://www.visualize.uk.com/resources/asp-net-standards.asp](http://www.visualize.uk.com/resources/asp-net-standards.asp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T19:36:10.157

我跟你一样。当您拥有大量控件时，一切都会变得混乱，因此我在每个名称前加上控件类的大写字母。

例如：

文本框-> tbName

数据网格-> dgName

面板 -> pName

这清楚地说明了如何处理新控件（即如何派生前缀）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T20:04:59.073

我一直觉得前缀的唯一真正原因是你可以在同一个表单/页面上拥有 txtFirstName 和 lblFirstName 之类的东西。因为，绝大多数时候，我真的只使用实际的字段控件本身，我跳过了前缀，只使用关联控件的前缀。例如，lblMonth & Month，跳过 cbo 前缀。

它节省了打字，而且通常很明显您在这种形式中使用了什么样的控件。更复杂的控件将获得完整的前缀处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-14T12:11:02.420

我更喜欢 iOS UI 组件的 2 字符前缀：

`bt_`: `UIButton`
`lb_`: `UILabel`
`tx_`: `UITextField`
`tv_`: `UITextView`
`vw_`: `UIView`
`im_`: `UIImageView`
`sc_`: `UIScrollView`
`tb_`: `UITableView`
`cl_`: `UICollectionView`
`st_`: `UIStackView`
`pk_`: `UIPickerView`
`pr_`: `UIProgressView`
`ai_`: `UIActivityIndicatorView`
`wb_`: `UIWebView / WKWebView`
`mp_`: `MKMapView`
`gr_`: `UIGestureRecognizer`
`sw_`: `UISwitch`
`sl_`: `UISlider`
`sp_`: `UIStepper`
`sg_`: `UISegmentedControl`
`pg_`_ `UIPageControl`
`dp_`_`UIDatePicker`

# c# - 提高 ASP.NET/C# 编译速度的最佳方法是什么？

> ID：111814
> 
> 赞同：7
> 
> 时间：2008-09-21T19:26:25.720
> 
> 标签：c#, .net, asp.net

*更新：请将您的答案集中在硬件解决方案上。*

您使用什么硬件/工具/插件来提高 ASP.NET 编译和首次执行速度？我们正在寻找固态硬盘来加快速度，但现在价格真的很高。

我现在在 RAID 0 中有两个 7200rpm 硬盘驱动器，我对性能不再满意。

所以我的主要问题是，当您进行大量调试时，目前提高 ASP.NET 编译速度和整体开发性能的最佳成本效益方法是什么？

Scott Gu 有一篇关于这方面的不错的博客文章，还有其他建议吗？

[http://weblogs.asp.net/scottgu/archive/2007/11/01/tip-trick-hard-drive-speed-and-visual-studio-performance.aspx](http://weblogs.asp.net/scottgu/archive/2007/11/01/tip-trick-hard-drive-speed-and-visual-studio-performance.aspx)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-21T19:29:49.597

要做的重要事情之一是保持卸载不经常更改的程序集的项目。当发生更改时，重新加载、编译和卸载。它在大型解决方案中产生了巨大的差异。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-21T19:36:24.183

首先确保您使用的是[Web 应用程序项目](http://msdn.microsoft.com/en-us/asp.net/aa336618.aspx)(WAP)。根据我们的经验，与网站项目相比，WAP 的编译速度大约快 10 倍。

然后，考虑将所有逻辑（包括复杂的 UI 组件）迁移到单独的库项目中。C# 编译器比 ASP.NET 编译器更快（至少对于 VS2005）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T09:16:22.803

如果您有很多第 3 方“引用程序集”，确保 CopyLocal=False 在除 Web 应用程序项目之外的所有项目上会产生很大的不同。

我在博客中介绍了通过进行这个简单的更改而获得的性能提升：

[加速您的桌面构建 - 第 1 部分](http://blogs.conchango.com/howardvanrooijen/archive/2009/05/09/speeding-up-your-desktop-build-part-1.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-21T19:28:04.420

您可以预编译站点，这将使首次运行体验更好

[http://msdn.microsoft.com/en-us/library/ms227972.aspx](http://msdn.microsoft.com/en-us/library/ms227972.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-21T19:32:58.357

我从网站切换到 Web 应用程序。编译时间至少减少了十倍。

另外，如果可能的话，我尽量不使用调试器（“不调试就运行”）。这减少了启动 Web 应用程序所需的时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T19:35:48.210

我建议尽可能多地为您的 PC 添加内存。如果您的解决方案非常大，您可能需要探索 64 位，以便您的机器可以处理超过 3GB 的内存。

此外，Visual Studio 2008 SP1 似乎比以前的版本快得多，请确保您正在运行带有 Service Pack 的最新版本。

祝你好运！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T07:41:10.040

如果您只关注硬件，则需要在网络上搜索基准。有几篇文章只是写了关于Visual Studio编译的硬件性能，我只是懒得找到它们并链接它们。

硬件解决方案可能是无穷无尽的，因为如果你有钱，你可以获得一些非常高端的设备。否则它通常会更多的内存、更快的处理器和更快的硬盘驱动器。迁移到 64 位操作系统也有帮助。

如果你想更具体？就在我的脑海中……8GB 或更多的内存，如果你买不起固态硬盘，我会选择 10K 到 15K RPM 的硬盘。关于四核是否有任何区别存在争议，但请查看基准并查看适合您的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T15:10:17.387

如果您只关注硬件、多核处理器、大量内存以及理想的 10K 或 15K 硬盘驱动器。

我个人注意到，更改为 10K RPM 驱动器后，性能有了巨大的提升。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-08T21:24:01.303

提高 ASP.NET 编译时间的最好方法是投入更多的硬件。OCZ Vertex Turbo SSD 驱动器和 Intel i7 960 给了我巨大的动力。[你可以在这里](http://rsurl.net/blog14)看到我的结果。

# c# - 将大型 C# winforms 应用程序升级到 WPF 的最简单方法是什么

> ID：111817
> 
> 赞同：14
> 
> 时间：2008-09-21T19:27:29.990
> 
> 标签：c#, .net, wpf, upgrade

我在一个大型 C# 应用程序（大约 450,000 行代码）上工作，我们经常遇到桌面堆和 GDI 句柄泄漏的问题。WPF 解决了这些问题，但我不知道升级的最佳方式是什么（我预计这需要很长时间）。该应用程序只有几个表单，但它们可以包含许多不同的用户控件集，这些控件是通过编程确定的。

这是一个公司内部应用程序，因此我们的发布周期非常短（通常为 3 周发布周期）。

是否有一些循序渐进的升级路径，还是我们必须全力以赴？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-21T20:16:07.597

您可以从创建 WPF 主机开始。

然后您可以使用 <WindowsFormHost/> 控件来托管您当前的应用程序。然后，我建议在 WPF 中创建一个新控件库。一次一个，您可以创建控件（我建议使它们成为自定义控件，而不是用户控件）。在每个控件的样式中，您可以从使用 <ElementHost/> 控件开始包含“旧”窗体控件。然后，您可以花时间重构每个控件并将其重新创建为完整的 WPF。

我认为创建控件包装器并为应用程序设计 WPF 主机仍需要初步努力。我不确定应用程序的大小和用户控件的复杂性，所以我不确定这对您来说需要多少努力。相对而言，以这种方式让您的应用程序在 WPF 中启动和运行明显更省力且速度更快。

不过，我不会只是这样做而忘记它，因为您可能会遇到控件相互重叠的问题（Windows 窗体不能很好地与 WPF 配合使用，尤其是在使用透明度和其他视觉效果时）

如果您需要更具体的指导，请向我们更新此项目的状态，或提供更多技术信息。谢谢 ：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T19:31:09.267

您是否使用大量用户控件来处理这些片段？WPF 可以托管 winform 控件，因此您可以分段将部分引入主窗体。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-21T19:32:21.367

WPF 允许您将 Windows 窗体用户控件嵌入到 WPF 应用程序中，这可以帮助您以更小的步骤进行转换。

查看 WPF 文档中的[WindowsFormsHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost.aspx)类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T00:19:05.610

我假设您不只是在寻找一个 ElementHost 来放置您庞大的 Winforms 应用程序。无论如何，这不是对 WPF 的真正移植。考虑这个线程上的答案[从 Winforms 迁移到 WPF 的最大障碍是什么？](https://stackoverflow.com/questions/109620/what-are-the-bigger-hurdles-to-overcome-migrating-from-winforms-to-wpf), 这将非常有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T19:47:24.937

有一篇关于将 .NET 2.0 winform 应用程序迁移到 WPF 的非常有趣的白皮书，请参阅[向 .NET 3.5 应用程序发展](http://www.ythos.net/pdfs/EvolvingDotNet35Apps.pdf)

论文摘要： *在本文中，我将概述在将 Microsoft .NET 应用程序从 1.x/2.x 发展到 3.x 时必须面对的一些思考过程、决策和问题。我将看看我们如何帮助我们的客户采用新技术，同时仍然保持业务可以接受的发布时间表。*

# asp.net - 免费的开源 asp.net 文件管理器？

> ID：111851
> 
> 赞同：5
> 
> 时间：2008-09-21T19:37:48.983
> 
> 标签：asp.net, file-manager

有什么好的吗？到目前为止，我已经找到了 IZWebFileManager、OXFileManager 和 AWS File Picker。文件管理器应该能够删除、复制、重命名、下载和上传文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T12:09:40.610

您拥有由我们自己的[Jeff Atwood创建的](https://stackoverflow.com/users/1/jeff-atwood)[WebFileManager](http://www.codeproject.com/KB/aspnet/WebFileManager.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T12:01:17.260

（无耻的插头）

这个问题很老，但它仍然可以帮助某人：

[http://elfinderaspnet.codeplex.com/](http://elfinderaspnet.codeplex.com/)

使用 elFinder 作为前端，使用 IHttpHandler 作为后端，因此它与 WebForms 和 MVC 兼容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-15T19:13:00.503

试试这里这个经理，它可以给你会的方法。 [http://www.ajaxfilebrowser.com/?CrossDomain](http://www.ajaxfilebrowser.com/?CrossDomain)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-02-02T18:12:29.363

我使用[了 HTTPCommander](http://www.element-it.com/asp-net-explorer-browser/online-share/web-file-manager.aspx)。Telerik 在他们的 asp.net 套件中也有一个文件管理器控件。

# sql - 在团队中使用 Oracle 存储过程的工具？

> ID：111852
> 
> 赞同：12
> 
> 时间：2008-09-21T19:37:51.637
> 
> 标签：sql, oracle, version-control, stored-procedures

您在团队中使用哪些工具来开发 Oracle 存储过程：

*   自动“锁定”您正在使用的当前程序，以便团队中的其他人在您完成之前无法对其进行更改。
*   自动将您在存储过程、Oracle 数据库中所做的更改发送到 Subversion、CVS、... 存储库

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T16:49:16.940

我不确定原始发布者是否仍在监视此问题，但无论如何我都会问这个问题。

原始帖子要求能够：

> 自动“锁定”您正在使用的当前程序，以便团队中的其他人在您完成之前无法对其进行更改。

也许这里的问题是开发范式之一，而不是产品无法“锁定”存储过程。每当我听到“我想锁定它，这样其他人就不会更改它”时，我会立即感觉到人们正在共享一个模式，并且每个人都在同一个空间中开发。

如果是这样，为什么不简单地让每个人都有自己的模式和数据模型的副本？我的意思是认真的人，创建另一个模式不会“花费”任何东西。这样，每个开发人员都可以进行更改，直到他们脸色发青，而不会影响其他任何人。

我过去（在小型团队中）使用的另一个技巧是让每个开发人员由于大小而无法拥有自己的数据副本，那就是拥有一个包含所有表和代码的主模式，公共同义词指向这一切。然后，如果开发人员想要处理存储过程，他只需在*他的*模式中创建它。这样一来，Oracle 名称解析首先找到一个而不是主模式中的副本，从而允许他们在不影响其他任何人的情况下测试他们的代码。这确实有它的缺点，但这是一个非常具体的案例，我们可以与它们一起生活。显然，我永远不会在生产中实现这样的东西。

至于第二个要求：

> 自动将您在存储过程、Oracle 数据库中所做的更改发送到 Subversion、CVS、... 存储库

我会惊讶地发现那里有足够聪明的工具来做到这一点（也许是一个机会:)。它必须连接到您的数据库，查询数据字典（USER_SOURCE）并提取相关文本。对于几乎普遍基于文件的源代码控制系统来说，这是一项艰巨的任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T19:44:56.907

Oracle 的新 SQL Developer 内置了版本控制。

这是产品的链接。

[http://www.oracle.com/technology/products/database/sql_developer/files/what_is_sqldev.html](http://www.oracle.com/technology/products/database/sql_developer/files/what_is_sqldev.html)

[http://www.oracle.com/technology/products/database/sql_developer/images/what_version.png http://www.oracle.com/technology/products/database/sql_developer/images/what_version.png](http://www.oracle.com/technology/products/database/sql_developer/images/what_version.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T17:17:15.913

将 PL/SQL 视为普通代码：将其存储在文件中，并使用您的修订控制工具和内部程序管理这些文件。

如果您还没有修订控制工具，请写下您的要求并[选择一个](http://en.wikipedia.org/wiki/Comparison_of_revision_control_software)。很多人似乎使用[Subversion](http://subversion.tigris.org/)，与[TortoiseSVN](http://tortoisesvn.tigris.org/)作为 Windows 上的客户端相关联（我这样做）。

问题是：按照推荐使用您的工具，并相应地调整您的程序。例如，Subversion 默认使用*[复制-修改-合并](http://svnbook.red-bean.com/en/1.5/svn.basic.vsn-models.html#svn.basic.vsn-models.copy-merge)*模型，而不是您似乎喜欢的*[锁定-修改-解锁模型。](http://svnbook.red-bean.com/en/1.5/svn.basic.vsn-models.html#svn.basic.vsn-models.lock-unlock)*

就我而言，我喜欢使用 TortoiseSVN，如上所述。和这个工具一样：

*   我从不锁定任何文件。这对于小型团队来说非常易于管理，并且需要对大型团队进行提前计划，恕我直言，这始终是一件好事。
*   我将更改手动发送回服务器，因为......我认为 Subversion 没有其他方法（另外，内部程序禁止在没有消息的情况下提交，恕我直言，这也是一件好事）。

无论您选择什么，我都建议您阅读这篇关于[数据库版本控制](http://odetocode.com/Blogs/scott/archive/2008/02/03/11746.aspx)的文章（和相关文章） 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T20:33:16.213

一个相对简单（如果有点过时）的解决方案可能是使用“锁定”而不是“合并”模式的版本控制系统...... Subversion 或 CVS 通常使用“合并”模式（尽管我相信可以制作 Subversion “锁定”文件？）

“锁定”模式的版本控制系统当然也有自己的弊端......

我能想到在 Oracle 中做的唯一方法可能是 BEFORE CREATE TRIGGER 的一些方法，也许是引用一个表来查找可以在其中运行包的人。虽然听起来有点讨厌？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-18T16:27:12.353

使用[Source Control for Oracle](http://www.red-gate.com/products/oracle-development/source-control-for-oracle/)，您可以获得很多您正在寻找的东西。

存储过程（以及包、函数、表等）可以使用界面手动锁定，而不是自动锁定，但这确实可以防止其他人进行更改。

然后可以将用于创建对象的新 SQL 签入 SVN 或 TFS（遗憾的是不支持 CVS）。

该工具不是免费的，但有 28 天的免费试用期。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T08:16:54.277

使用[Oracle SQL Developer 1.5](http://www.oracle.com/technology/products/database/sql_developer/index.html)，您可以轻松地创建和管理与 CVS 或 Subversion 的连接。要创建 CVS 连接（例如），请单击*Versioning -> CVS -> Check out Module*。您将运行一个向导来创建连接（主机、用户名等），然后您可以正常检查您的程序/功能。

[Toad](http://www.toadsoft.com/)中还提供了与 CVS 的集成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T19:56:45.810

您可能还想查看 Aqua Data Studio。他们也内置了 SVN，是一个很棒的存储过程编辑器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T13:31:16.277

在搜索了一个工具来处理 Oracle 对象的版本控制但没有运气之后，我们创建了以下（不完美但合适）的解决方案：

1.  我们使用[dbms_metadata](http://www.psoug.org/reference/dbms_metadata.html)包创建 Oracle 服务器的元数据转储。我们为每个对象创建一个文件，因此结果不是一个大文件，而是一堆文件。为了识别已删除的对象，我们在再次创建转储之前删除所有文件。
2.  我们将所有文件从服务器复制到客户端计算机。
3.  使用 Netbeans 我们识别更改，并将更改提交到 CVS 服务器（或检查差异...）。任何 CVS 处理程序软件都可以在这里工作，但我们已经将 Netbeans 用于其他目的。Netbeans 还允许创建一个 ant 任务来调用步骤 1 中提到的 Oracle 进程，复制步骤 2 中提到的文件......

这是第 1 步最重要的查询：

```
SELECT object_type, object_name, 
  dbms_metadata.get_ddl(object_type, object_name) object_ddl FROM user_objects
WHERE OBJECT_TYPE in ('INDEX', 'TRIGGER', 'TABLE', 'VIEW', 'PACKAGE', 
  'FUNCTION', 'PROCEDURE', 'SYNONYM', 'TYPE')  
ORDER BY OBJECT_TYPE, OBJECT_NAME 
```

每个对象一个文件的方法有助于识别更改。如果我向表中添加一个字段`TTTT`（当然不是真实的表名），那么只会`TABLE_TTTT.SQL`修改文件。

第 1 步和第 3 步都是缓慢的过程。（几千个文件需要几分钟）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-22T17:15:47.087

Toad 也可以在不需要 CVS/SVN 的情况下执行此操作。

# gwt - GWT-EXT - 事件发生后将小部件添加到特定 ContentPanel 的最佳方式是什么？

> ID：111854
> 
> 赞同：0
> 
> 时间：2008-09-21T19:38:45.207
> 
> 标签：gwt, gwt-ext

第一篇文章不要伤害我:)

我正在使用`BorderLayout`通常的北、西、中、南面板。在**西部** `ContentPanel`，我有一个`Tree`. 如果发生事件 ( )，我希望在**Center**`OnClick`上显示一个特定的对话框。 **`ContentPanel`**

 **对我来说最好的方法是什么？目前我正在使用一个名为`returnPanel()`返回中心的函数`ContentPanel`。在事件处理程序中，我调用了这个函数`(MainWindow.returnPanel().add(myDialog))`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-21T19:52:57.653

你这样做的方式是直观且有效的，但是当应用程序增长时会开始导致地狱，因为应用程序的不同部分是强耦合的。这个问题的解决方案是[MVC 设计模式](http://en.wikipedia.org/wiki/Model-view-controller)和[观察者设计模式](http://en.wikipedia.org/wiki/Observer_pattern)。

理想情况下，使用 MVC 模式，您不希望任何小部件“知道”任何其他小部件。只有一个类知道所有的小部件，即控制器。每当一个小部件需要向另一个小部件发送消息/信号时，它都会将其告知控制器类，后者以适当的方式将消息中继到适当的小部件。通过这种方式，两个小部件被分离，一个可以在不破坏另一个的情况下进行更改。您可能希望使用枚举来枚举控制器必须响应的所有可能操作。

如果您的小部件必须在事件发生时仅调用控制器，您可以简单地在其上调用一个恰当命名的（静态）方法并完成它。但是，一旦需要通知多个其他类一个事件，您最好使用观察者模式，它允许您向多个其他类发出信号，而无需更改您的类。它只是在 eventHandler 中调用 notifyPObservers() 就可以了。有多少听众，他们是什么类型，无关紧要。这样，您还可以将一个类与其侦听器分离。即使只有控制器监听，使用该模式也是可取的，因为它清楚地将“回调”代码与类中的其他代码分开。

顺便说一句，这与 GWT 甚至 Java 无关。

# objective-c - 迭代时从 NSMutableArray 中删除的最佳方法？

> ID：111866
> 
> 赞同：197
> 
> 时间：2008-09-21T19:43:20.500
> 
> 标签：objective-c, cocoa

在 Cocoa 中，如果我想遍历 NSMutableArray 并删除符合特定条件的多个对象，那么在每次删除对象时不重新启动循环的最佳方法是什么？

谢谢，

编辑：只是为了澄清-我正在寻找最好的方法，例如比手动更新我所在的索引更优雅的方法。例如在 C++ 中我可以做到；

```
iterator it = someList.begin();

while (it != someList.end())
{
    if (shouldRemove(it))   
        it = someList.erase(it);
} 
```

* * *

## 回答 #1

> 赞同：391
> 
> 时间：2008-09-21T23:23:49.080

为了清楚起见，我喜欢创建一个初始循环，在其中收集要删除的项目。然后我删除它们。这是一个使用 Objective-C 2.0 语法的示例：

```
NSMutableArray *discardedItems = [NSMutableArray array];

for (SomeObjectClass *item in originalArrayOfItems) {
    if ([item shouldBeDiscarded])
        [discardedItems addObject:item];
}

[originalArrayOfItems removeObjectsInArray:discardedItems]; 
```

那么就没有问题是否正确更新了索引或其他小的簿记细节。

编辑添加：

在其他答案中已经指出，逆公式应该更快。即，如果您遍历数组并组成一个新的对象数组来保留，而不是要丢弃的对象。这可能是真的（尽管分配新数组并丢弃旧数组的内存和处理成本如何？）但即使它更快，它也可能不像幼稚的实现那样重要，因为 NSArrays不要表现得像“正常”数组。他们谈论谈话，但他们走的是不同的路。[在这里看到一个很好的分析：](http://ridiculousfish.com/blog/posts/array.html)

逆公式可能更快，但我从来不需要关心它是否是，因为上面的公式总是足够快以满足我的需要。

对我来说，带回家的信息是使用你最清楚的任何表述。仅在必要时进行优化。我个人觉得上面的公式最清楚，这就是我使用它的原因。但是，如果逆公式对您来说更清楚，那就去吧。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2009-06-19T20:33:29.977

还有一种变体。因此，您可以获得可读性和良好的性能：

```
NSMutableIndexSet *discardedItems = [NSMutableIndexSet indexSet];
SomeObjectClass *item;
NSUInteger index = 0;

for (item in originalArrayOfItems) {
    if ([item shouldBeDiscarded])
        [discardedItems addIndex:index];
    index++;
}

[originalArrayOfItems removeObjectsAtIndexes:discardedItems]; 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2013-08-27T04:24:18.827

这是一个非常简单的问题。您只需向后迭代：

```
for (NSInteger i = array.count - 1; i >= 0; i--) {
   ElementType* element = array[i];
   if ([element shouldBeRemoved]) {
       [array removeObjectAtIndex:i];
   }
} 
```

这是一种非常常见的模式。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2008-09-24T08:51:49.947

其他一些答案在非常大的数组上性能很差，因为方法`removeObject:`和`removeObjectsInArray:`涉及对接收器进行线性搜索，这是一种浪费，因为您已经知道对象在哪里。此外，任何调用`removeObjectAtIndex:`都必须一次将值从索引复制到数组末尾一个插槽。

更有效的方法如下：

```
NSMutableArray *array = ...
NSMutableArray *itemsToKeep = [NSMutableArray arrayWithCapacity:[array count]];
for (id object in array) {
    if (! shouldRemove(object)) {
        [itemsToKeep addObject:object];
    }
}
[array setArray:itemsToKeep]; 
```

因为我们设置了容量`itemsToKeep`，我们不会在调整大小时浪费任何时间复制值。我们不会就地修改数组，所以我们可以自由地使用快速枚举。`setArray:`用于替换`array`with的内容将`itemsToKeep`是有效的。根据您的代码，您甚至可以将最后一行替换为：

```
[array release];
array = [itemsToKeep retain]; 
```

所以甚至不需要复制值，只需要交换一个指针。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2008-09-24T20:59:56.250

您可以使用 NSpredicate 从可变数组中删除项目。这不需要 for 循环。

例如，如果你有一个 NSMutableArray 名称，你可以创建一个这样的谓词：

```
NSPredicate *caseInsensitiveBNames = 
[NSPredicate predicateWithFormat:@"SELF beginswith[c] 'b'"]; 
```

以下行将为您留下一个仅包含以 b 开头的名称的数组。

```
[namesArray filterUsingPredicate:caseInsensitiveBNames]; 
```

如果您无法创建所需的谓词，请使用此[Apple 开发人员链接](http://developer.apple.com/documentation/Cocoa/Conceptual/Predicates/predicates.html)。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2013-06-03T21:04:53.577

我使用 4 种不同的方法进行了性能测试。每个测试都会遍历 100,000 个元素数组中的所有元素，并每隔 5 项删除一次。结果在有/没有优化的情况下变化不大。这些是在 iPad 4 上完成的：

(1) `removeObjectAtIndex:`-- **271 毫秒**

(2) `removeObjectsAtIndexes:`-- **1010 毫秒**（因为构建索引集大约需要 700 毫秒；否则这与为每个项目调用 removeObjectAtIndex: 基本相同）

(3) `removeObjects:`-- **326 毫秒**

(4) 用通过测试的对象创建一个新数组 -- **17 ms**

因此，创建一个新数组是迄今为止最快的。其他方法都是可比较的，除了使用 removeObjectsAtIndexes: 会更糟，因为要删除更多项目，因为构建索引集需要时间。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-09-21T19:52:07.170

要么对索引使用循环倒计时：

```
for (NSInteger i = array.count - 1; i >= 0; --i) { 
```

或使用您要保留的对象制作副本。

特别是，不要使用`for (id object in array)`循环或`NSEnumerator`.

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2012-08-18T16:41:11.723

对于 iOS 4+ 或 OS X 10.6+，Apple`passingTest`在. 具有此类 API 的解决方案是：`NSMutableArray``– indexesOfObjectsPassingTest:`

```
NSIndexSet *indexesToBeRemoved = [someList indexesOfObjectsPassingTest:
    ^BOOL(id obj, NSUInteger idx, BOOL *stop) {
    return [self shouldRemove:obj];
}];
[someList removeObjectsAtIndexes:indexesToBeRemoved]; 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2013-08-28T02:05:49.933

现在你可以使用反向的基于块的枚举。一个简单的示例代码：

```
NSMutableArray *array = [@[@{@"name": @"a", @"shouldDelete": @(YES)},
                           @{@"name": @"b", @"shouldDelete": @(NO)},
                           @{@"name": @"c", @"shouldDelete": @(YES)},
                           @{@"name": @"d", @"shouldDelete": @(NO)}] mutableCopy];

[array enumerateObjectsWithOptions:NSEnumerationReverse usingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    if([obj[@"shouldDelete"] boolValue])
        [array removeObjectAtIndex:idx];
}]; 
```

结果：

```
(
    {
        name = b;
        shouldDelete = 0;
    },
    {
        name = d;
        shouldDelete = 0;
    }
) 
```

* * *

仅一行代码的另一种选择：

```
[array filterUsingPredicate:[NSPredicate predicateWithFormat:@"shouldDelete == NO"]]; 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-09-21T20:51:06.093

以更具声明性的方式，根据与要删除的项目匹配的条件，您可以使用：

```
[theArray filterUsingPredicate:aPredicate] 
```

@Nathan 应该非常高效

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2013-08-28T01:42:06.800

这是简单而干净的方法。我喜欢在快速枚举调用中复制我的数组：

```
for (LineItem *item in [NSArray arrayWithArray:self.lineItems]) 
{
    if ([item.toBeRemoved boolValue] == YES) 
    {
        [self.lineItems removeObject:item];
    }
} 
```

通过这种方式，您可以枚举要从中删除的数组的副本，两者都包含相同的对象。NSArray 仅保存对象指针，因此这在内存/性能方面非常好。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-09-21T19:50:41.963

将要删除的对象添加到第二个数组中，并在循环之后使用 -removeObjectsInArray:。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-09-21T19:55:11.110

这应该这样做：

```
 NSMutableArray* myArray = ....;

    int i;
    for(i=0; i<[myArray count]; i++) {
        id element = [myArray objectAtIndex:i];
        if(element == ...) {
            [myArray removeObjectAtIndex:i];
            i--;
        }
    } 
```

希望这可以帮助...

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-21T19:51:40.620

为什么不将要删除的对象添加到另一个 NSMutableArray。完成迭代后，您可以移除已收集的对象。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-21T21:12:19.100

如何将要删除的元素与第 n 个元素、第 n-1 个元素等交换？

完成后，将数组大小调整为“以前的大小 - 交换次数”

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-22T05:06:19.507

如果数组中的所有对象都是唯一的，或者您想在找到对象时删除所有出现的对象，则可以快速枚举数组副本并使用 [NSMutableArray removeObject:] 从原始对象中删除该对象。

```
NSMutableArray *myArray;
NSArray *myArrayCopy = [NSArray arrayWithArray:myArray];

for (NSObject *anObject in myArrayCopy) {
    if (shouldRemove(anObject)) {
        [myArray removeObject:anObject];
    }
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2010-06-17T21:31:00.180

上面的 benzado 的 anwser 是你应该为 preformace 做的事情。在我的一个应用程序中，removeObjectsInArray 的运行时间为 1 分钟，仅添加到新数组需要 0.023 秒。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-01-23T13:10:36.610

我定义了一个类别，让我可以使用块进行过滤，如下所示：

```
@implementation NSMutableArray (Filtering)

- (void)filterUsingTest:(BOOL (^)(id obj, NSUInteger idx))predicate {
    NSMutableIndexSet *indexesFailingTest = [[NSMutableIndexSet alloc] init];

    NSUInteger index = 0;
    for (id object in self) {
        if (!predicate(object, index)) {
            [indexesFailingTest addIndex:index];
        }
        ++index;
    }
    [self removeObjectsAtIndexes:indexesFailingTest];

    [indexesFailingTest release];
}

@end 
```

然后可以这样使用：

```
[myMutableArray filterUsingTest:^BOOL(id obj, NSUInteger idx) {
    return [self doIWantToKeepThisObject:obj atIndex:idx];
}]; 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-08-27T09:58:43.713

更好的实现可能是在 NSMutableArray 上使用下面的类别方法。

```
@implementation NSMutableArray(BMCommons)

- (void)removeObjectsWithPredicate:(BOOL (^)(id obj))predicate {
    if (predicate != nil) {
        NSMutableArray *newArray = [[NSMutableArray alloc] initWithCapacity:self.count];
        for (id obj in self) {
            BOOL shouldRemove = predicate(obj);
            if (!shouldRemove) {
                [newArray addObject:obj];
            }
        }
        [self setArray:newArray];
    }
}

@end 
```

可以实现谓词块来对数组中的每个对象进行处理。如果谓词返回 true，则删除对象。

一个日期数组的示例，用于删除过去的所有日期：

```
NSMutableArray *dates = ...;
[dates removeObjectsWithPredicate:^BOOL(id obj) {
    NSDate *date = (NSDate *)obj;
    return [date timeIntervalSinceNow] < 0;
}]; 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-08-10T06:55:40.960

多年来，我最喜欢向后迭代，但很长一段时间以来，我从未遇到过首先删除“最深”（最高计数）对象的情况。在指针移动到下一个索引之前的瞬间，没有任何东西并且它崩溃了。

Benzado 的方式最接近我现在所做的，但我从未意识到每次移除后都会重新洗牌。

在 Xcode 6 下这工作

```
NSMutableArray *itemsToKeep = [NSMutableArray arrayWithCapacity:[array count]];

    for (id object in array)
    {
        if ( [object isNotEqualTo:@"whatever"]) {
           [itemsToKeep addObject:object ];
        }
    }
    array = nil;
    array = [[NSMutableArray alloc]initWithArray:itemsToKeep]; 
```

# shell - 您最新的有用 Perl 单线（或涉及 Perl 的管道）是什么？

> ID：111868
> 
> 赞同：15
> 
> 时间：2008-09-21T19:43:29.250
> 
> 标签：shell, perl, command-line

单线应该：

*   解决一个现实世界的问题
*   不要过于神秘（应该易于理解和重现）
*   值得花时间写它（不应该太聪明）

我正在寻找实用的技巧和窍门（补充示例`perldoc perlrun`）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-21T20:02:46.677

请参阅我的幻灯片以获取[“Perl 命令行选项的现场指南”。](https://web.archive.org/web/20120916013412/http://petdance.com/perl/command-line-options.pdf)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-22T00:13:44.500

鱿鱼日志文件。他们很棒，不是吗？除了默认情况下，它们具有从时代开始的秒数作为时间字段。这是一个从 squid 日志文件中读取并将时间转换为人类可读日期的单行程序：

```
perl -pe's/([\d.]+)/localtime $1/e;' access.log 
```

稍作调整，您就可以让它只显示带有您感兴趣的关键字的行。stackoverflow.com 的以下手表仅访问和打印这些行，并带有人类可读的日期。为了使它更有用，我给它的输出`tail -f`，所以我可以看到实时访问：

```
tail -f access.log | perl -ne's/([\d.]+)/localtime $1/e,print if /stackoverflow\.com/' 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-21T19:43:38.923

*问题*：媒体播放器不会自动加载字幕，因为它们的名称与相应的视频文件不同。

*解决方案*：重命名所有 *.srt（带字幕的文件）以匹配 *.avi（带视频的文件）。

```
perl -e'while(<*.avi>) { s/avi$/srt/; rename <*.srt>, $_ }' 
```

警告：原始视频和字幕文件名的排序顺序应相同。

这里是上述单行代码的更详细版本：

```
my @avi = glob('*.avi');
my @srt = glob('*.srt');

for my $i (0..$#avi)
{
  my $video_filename = $avi[$i];
  $video_filename =~ s/avi$/srt/;   # 'movie1.avi' -> 'movie1.srt'

  my $subtitle_filename = $srt[$i]; # 'film1.srt'
  rename($subtitle_filename, $video_filename); # 'film1.srt' -> 'movie1.srt'
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-22T07:59:22.743

你可能不认为这是 Perl，但我虔诚地使用[ack](http://search.cpan.org/~petdance/ack-1.86/)（它是一个用 Perl 编写的智能 grep 替代品），这让我可以编辑，例如，我所有的访问我们 API 特定部分的 Perl 测试：

```
vim $(ack --perl -l 'api/v1/episode' t) 
```

附带说明一下，如果您使用 vim，您可以[在编辑器的缓冲区中运行所有测试](https://web.archive.org/web/20080920153402/http://use.perl.org/~Ovid/journal/37470)。

对于更明显（如果简单的话）Perl 的东西，我需要知道有多少测试程序用掉了 t/lib/TestPM 目录中的测试装置（为了清楚起见，我已经减少了命令）。

```
ack $(ls t/lib/TestPM/|awk -F'.' '{print $1}'|xargs perl -e 'print join "|" => @ARGV') aggtests/ t -l 
```

请注意“加入”如何将结果转换为正则表达式以供 ack 使用。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-03T04:31:21.737

`find ... -exec rm {} \;`用于删除目录树中某处的一组文件的常见习惯用法并不是特别有效，因为它`rm`为找到的每个文件执行一次命令。我的一个习惯是在计算机还没有那么快（dagnabbit！）的时代出生的，就是`rm`用一个对 perl 的调用来代替许多调用：

```
find . -name '*.whatever' | perl -lne unlink 
```

命令行的`perl`一部分读取由 发出的文件列表`find`，每行一个，修剪换行符，并使用 perl 的内置`unlink()`函数删除文件，`$_`如果没有提供显式参数，则该函数将其作为参数。（`$_`由于该`-n`标志，设置为每一行输入。）（*这些天，大多数`find`命令`-print`默认情况下，所以我可以省略这部分。）

我喜欢这个习语，不仅因为它的效率（现在可能不那么重要了），而且因为它比输入传统`-exec rm {} \;`序列的和弦/尴尬键更少。它还避免了由带有空格、引号等的文件名引起的引用问题，其中我有很多。（更强大的版本可能会使用`find`'`-print0`选项，然后要求`perl`读取以空值分隔的记录而不是行，但我通常非常确信我的文件名不包含嵌入的换行符。）

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-03T18:26:48.130

来自一个地方收集的答案的所有单行：

*   `perl -pe's/([\d.]+)/localtime $1/e;' access.log`

*   `ack $(ls t/lib/TestPM/|awk -F'.' '{print $1}'|xargs perl -e 'print join "|" => @ARGV') aggtests/ t -l`

*   `perl -e'while(<*.avi>) { s/avi$/srt/; rename <*.srt>, $_ }'`

*   `find . -name '*.whatever' | perl -lne unlink`

*   `tail -F /var/log/squid/access.log | perl -ane 'BEGIN{$|++} $F[6] =~ m{\Qrad.live.com/ADSAdClient31.dll} && printf "%02d:%02d:%02d %15s %9d\n", sub{reverse @_[0..2]}->(localtime $F[0]), @F[2,4]'`

*   `export PATH=$(perl -F: -ane'print join q/:/, grep { !$c{$_}++ } @F'<<<$PATH)`

*   `alias e2d="perl -le \"print scalar(localtime($ARGV[0]));\""`

*   `perl -ple '$_=eval'`

*   `perl -00 -ne 'print sort split /^/'`

*   `perl -pe'1while+s/\t/" "x(8-pos()%8)/e'`

*   `tail -f log | perl -ne '$s=time() unless $s; $n=time(); $d=$n-$s; if ($d>=2) { print qq ($. lines in last $d secs, rate ),$./$d,qq(\n); $. =0; $s=$n; }'`

*   `perl -MFile::Spec -e 'print join(qq(\n),File::Spec->path).qq(\n)'`

有关他们的描述，请参阅相应的答案。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-01T22:33:34.990

我用得最多的 Perl one-liner 是 Perl 计算器

```
perl -ple '$_=eval' 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-22T07:41:54.127

$work 最大的带宽消耗之一是下载网络广告，所以我正在寻找等待采摘的低垂果实。我已经摆脱了谷歌广告，现在我的视线中有微软。所以我在日志文件上运行了一个tail，并挑选出感兴趣的行：

```
tail -F /var/log/squid/access.log | \
perl -ane 'BEGIN{$|++} $F[6] =~ m{\Qrad.live.com/ADSAdClient31.dll}
    && printf "%02d:%02d:%02d %15s %9d\n",
        sub{reverse @_[0..2]}->(localtime $F[0]), @F[2,4]' 
```

Perl 管道所做的是首先将 autoflush 设置为 true，以便立即打印出任何被执行的操作。否则，它会将输出分块，并且当输出缓冲区填满时会收到一批行。-a 开关在空白处拆分每个输入行，并将结果保存在数组 @F 中（功能灵感来自 awk 将输入记录拆分为 $1、$2、$3... 变量的能力）。

它检查该行中的第 7 个字段是否包含我们寻找的 URI（使用 \Q 来避免我们逃避无趣的元字符的痛苦）。如果找到匹配项，它会漂亮地打印时间、源 IP 和从远程站点返回的字节数。

时间是通过在第一个字段中获取纪元时间并使用“本地时间”将其分解为其组成部分（小时、分钟、秒、日、月、年）来获得的。它取前三个元素的切片返回，秒、分和小时，并颠倒顺序得到小时、分钟和秒。这作为一个三元素数组返回，以及来自原始 @F 数组的第三个（IP 地址）和第五个（大小）的切片。这五个参数被传递给 sprintf 来格式化结果。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-02T23:04:41.817

@胡椒博士

删除重复的*文字*`$PATH`：

```
$ export PATH=$(perl -F: -ane'print join q/:/, grep { !$c{$_}++ } @F'<<<$PATH) 
```

从环境变量打印独特的干净路径`%PATH%`（它不接触等，如果需要`../`，替换`File::Spec->rel2abs`为`Cwd::realpath`）它不是更便携的单行：

```
#!/usr/bin/perl -w
use File::Spec; 

$, = "\n"; 
print grep { !$count{$_}++ } 
      map  { File::Spec->rel2abs($_) } 
      File::Spec->path; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-22T12:23:22.203

针对[Ovid 的 Vim/ack 组合](https://stackoverflow.com/questions/111868/what-is-your-latest-useful-perl-one-liner-or-a-pipe-involving-perl/113716#113716)：

我也经常搜索一些东西，然后想在 Vim 中打开匹配的文件，所以前段时间我给自己做了一个小快捷方式（我想只在[Z shell](https://en.wikipedia.org/wiki/Z_shell)中工作）：

```
function vimify-eval; {
    if [[ ! -z "$BUFFER" ]]; then
        if [[ $BUFFER = 'ack'* ]]; then
            BUFFER="$BUFFER -l"
        fi
        BUFFER="vim  \$($BUFFER)"
        zle accept-line
    fi
}

zle -N vim-eval-widget vimify-eval

bindkey '^P' vim-eval-widget 
```

它的工作原理是这样的：我使用 ack 搜索一些东西，比如`ack some-pattern`. 我查看结果，如果我喜欢它，我按向上箭头再次获取 ack-line，然后按`Ctrl`+ `P`。然后发生的情况是，仅当命令以“ack”开头时，Z shell 才会附加和“-l”以列出文件名。然后它把“$(...)”放在命令周围，把“vim”放在它前面。然后整个事情被执行。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-22T22:18:26.173

我经常使用它来快速将纪元时间转换为有用的日期戳。

```
perl -l -e 'print scalar(localtime($ARGV[0]))' 
```

在你的 shell 中创建一个别名：

```
alias e2d="perl -le \"print scalar(localtime($ARGV[0]));\"" 
```

然后将一个纪元号通过管道传递给别名。

```
echo 1219174516 | e2d 
```

Unix/Linux 上的许多程序和实用程序使用 epoch 值来表示时间，所以这对我来说是无价的。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-01T20:08:03.827

删除路径变量中的重复项：

```
set path=(`echo $path | perl -e 'foreach(split(/ /,<>)){print $_," " unless $s{$_}++;}'`) 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-03T18:55:28.667

删除 MS-DOS 行尾。

```
perl -p -i -e 's/\r\n$/\n/' htdocs/*.asp 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-09-17T18:52:40.043

无需打开网页即可提取 Stack Overflow 信誉：

```
perl -nle "print '  Stack Overflow        ' . $1 . '  (no change)' if /\s{20,99}([0-9,]{3,6})<\/div>/;" "SO.html"  >> SOscores.txt 
```

这假设用户页面已经下载到文件 SO.html。我为此目的使用 wget。这里的符号是针对 Windows 命令行的；Linux 或 Mac OS X 会略有不同。输出附加到文本文件中。

我在 BAT 脚本中使用它来自动对家族中四个站点的声誉进行抽样：Stack Overflow、Server Fault、Super User 和 Meta Stack Overflow。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-01-27T15:46:49.727

在编写 shell 脚本时，我经常需要查看 PATH 的可读版本。以下单行将每个路径条目打印在其自己的行上。

随着时间的推移，这种单线已经经历了几个阶段：

Unix（版本 1）：

```
perl -e 'print join("\n",split(":",$ENV{"PATH"}))."\n"' 
```

视窗（版本 2）：

```
perl -e "print join(qq(\n),split(';',$ENV{'PATH'})).qq(\n)" 
```

Unix/Windows（使用来自@jf-sebastian 的 q/qq 提示）（版本 3）：

```
perl -MFile::Spec -e 'print join(qq(\n), File::Spec->path).qq(\n)' # Unix
perl -MFile::Spec -e "print join(qq(\n), File::Spec->path).qq(\n)" # Windows 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-23T12:38:36.853

过滤以空格分隔的节流（名称/值对列表），分别对每个节进行排序：

```
perl -00 -ne 'print sort split /^/' 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-04T11:38:12.900

在我的 ~/bin 中占有一席之地的最新单行代码之一：

```
perl -ne '$s=time() unless $s; $n=time(); $d=$n-$s; if ($d>=2) { print "$. lines in last $d secs, rate ",$./$d,"\n"; $. =0; $s=$n; }' 
```

您可以将它用于日志文件的尾部，它会打印输出行的速率。

想知道您的网络服务器每秒获得多少点击？尾 -f 日志 | 这个脚本。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-09-17T18:56:27.290

从 获取人类可读的输出`du`，按大小排序：

```
perl -e '%h=map{/.\s/;7x(ord$&&10)+$`,$_}`du -h`;print@h{sort%h}' 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2011-05-15T08:46:35.193

网络管理员倾向于将“子网地址”错误配置为“主机地址”，尤其是在使用 Cisco ASDM 自动建议时。这个简单的单行扫描配置文件以查找任何此类配置错误。

错误用法：`permit host 10.1.1.0`

正确用法：`permit 10.1.1.0 255.255.255.0`

```
perl -ne "print if /host ([\w\-\.]+){3}\.0 /" *.conf 
```

这是在 Windows 上测试和使用的，请建议是否应该以任何方式对其进行修改以正确使用。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-23T19:49:29.127

将所有制表符展开为空格：`perl -pe'1while+s/\t/" "x(8-pos()%8)/e'`

当然，这可以通过 Vim 中的 :set et, :ret 来完成。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-09-17T23:59:21.540

我有一个标签列表，我用它来识别部分文本。主列表的格式为：

```
text description {tag_label} 
```

重要的`{tag_label}`是不要重复。所以有这个很好的简单脚本：

```
perl -ne '($c) = $_ =~ /({.*?})/; print $c,"\n" ' $1 | sort  | uniq -c | sort -d 
```

我知道我可以在 shell 或 perl 中做很多事情，但这是我想到的第一件事。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2011-06-25T08:16:30.103

我经常不得不将表格数据转换为配置文件。例如，网络布线供应商提供 Excel 格式的修补记录，我们必须使用该信息来创建配置文件。IE，

```
Interface, Connect to, Vlan
Gi1/0/1, Desktop, 1286
Gi1/0/2, IP Phone, 1317 
```

应该变成：

```
interface Gi1/0/1
 description Desktop
 switchport access vlan 1286 
```

等等。相同的任务在各种管理任务中以多种形式重新出现，其中需要在表格数据前面加上其字段名称并转换为平面结构。我已经看到一些 DBA 浪费了很多时间从 excel 表中准备他们的 SQL 语句。可以使用这个简单的单线来实现。只需使用您喜欢的电子表格工具将表格数据保存为 CSV 格式并运行此单行。标题行中的字段名称会添加到各个单元格值的前面，因此您可能必须对其进行编辑以符合您的要求。

```
perl -F, -lane "if ($.==1) {@keys = @F} else{print @keys[$_].$F[$_] foreach(0..$#F)} " 
```

需要注意的是，任何字段名称或值都不应包含任何逗号。也许这可以进一步阐述以在一行中捕获此类异常，如果可能，请改进这一点。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-22T13:31:48.607

这是我在处理集合压缩日志文件时发现的一个方便的方法：

```
 open STATFILE, "zcat $logFile|" or die "Can't open zcat of $logFile" ; 
```

* * *

## 回答 #24

> 赞同：-5
> 
> 时间：2008-09-21T22:19:40.967

有时我发现我想用 Perl 做的任何事情只要足够短，可以在命令行上用 'perl -e' 完成，可以用普通的 Z shell 功能更好、更容易、更快地完成，而无需麻烦的引用。例如上面的例子可以这样完成：

```
srt=(*.srt); for foo in *.avi; mv $srt[1] ${foo:r}.srt && srt=($srt[2,-1]) 
```

# vb.net - source control with VB2005 Express

> ID：111910
> 
> 赞同：3
> 
> 时间：2008-09-21T19:58:01.370
> 
> 标签：vb.net, version-control

Can anyone suggest a good source control system that interfaces with VB2005 Express? As the Express editions of Visual Studio do not allow add-ins does this mean that I will not be able to integrate source control into the IDE? I'm used to the check-in/check-out process of SourceSafe integrated into VB6\. Can anyone recommend TortoiseSVN as an alternative?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T20:00:04.547

TortoiseSVN is a good choice. Although it won't integrate into the IDE (because of the plug-in problem you mentioned), it's really solid in the Explorer right-button menu.

Also consider [Vault](http://www.sourcegear.com/vault/) from SourceGear. If you're used to SourceSafe, Vault will be easier to learn; Vault was specifically designed for ex-SourceSafe users.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T01:17:45.063

Take a look at [Perforce](http://www.perforce.com). It is lightning fast, rock solid, simple to use and configure, and has features to support pretty much any source control scenario.

If you are working on your own (which seems likely, given that you are using VB 2k5 Express), it is free for up to two users. If / when you switch to VS Pro, it has very good integration, and on its own it has several excellent clients and Windows Explorer integration.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T20:00:34.920

I would recommend using Tortoise and do version control through Windows Explorer.

I actually prefer that to Ankh in VS2008.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T20:03:00.763

I use TortoiseSVN and windows explorer for all my development projects and believe it works great. I started with SourceSafe, but when I changed jobs I went to an SVN shop and have now incorporated it into my own development projects. You can also use Source Safe without integration. You use Source Safe to check in/out files in a folder and then manage it outside the IDE. While this isn't as "simple" it may work just fine for certain projects. I use a hosted SVN provider, you may want to check them out: [Hosted-Projects](http://www.hosted-projects.com/).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-21T20:15:20.343

No, Source Control systems can't be integrated with the VS Express IDEs by design.

If you want to continue using your existing VSS, you're best option is to upgrade to Visual Studio Standard. Otherwise, check out TortoiseSVN. Here's a good quick start:

[http://www.polymorphicpodcast.com/shows/subversion/](http://www.polymorphicpodcast.com/shows/subversion/)

# .net - 如何在线程或计时器中访问 HttpServerUtility.MapPath 方法？

> ID：111927
> 
> 赞同：89
> 
> 时间：2008-09-21T20:04:51.120
> 
> 标签：.net, asp.net, timer, httpcontext

我`System.Timers.Timer`在我的 Asp.Net 应用程序中使用了 a ，我需要使用`HttpServerUtility.MapPath`似乎只能通过`HttpContext.Current.Server.MapPath`. 问题在于`HttpContext.Current`事件`null`何时`Timer.Elapsed`触发。

还有另一种方法来获取对 HttpServerUtility 对象的引用吗？我可以将它注入我的类的构造函数中。安全吗？我怎么能确定它不会在当前请求结束时被垃圾收集？

谢谢！

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2008-09-21T21:19:40.347

可以使用`HostingEnvironment.MapPath()`而不是`HttpContext.Current.Server.MapPath()`

不过，我还没有在线程或计时器事件中尝试过。

* * *

我考虑过的一些（不可行的）解决方案；

*   我关心的唯一方法`HttpServerUtility`是`MapPath`. 因此，作为替代方案，我可以使用`AppDomain.CurrentDomain.BaseDirectory`并以此构建我的路径。**但是，如果您的应用程序使用虚拟目录**（我的），这将失败。

*   另一种方法：将我需要的所有路径添加到`Global`类中。解决这些路径`Application_Start`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-27T23:31:21.050

我不知道这是否会解决您的虚拟目录问题，但我将它用于 MapPath：

```
public static string MapPath(string path)
{
    if (HttpContext.Current != null)
        return HttpContext.Current.Server.MapPath(path);

    return HttpRuntime.AppDomainAppPath + path.Replace("~", string.Empty).Replace('/', '\\');
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-07-09T21:52:06.237

HostingEnvironment 不是完美的解决方案，因为它是一个非常难以模拟的类（请参阅[如何对使用 HostingEnvironment.MapPath 的代码进行单元测试](https://stackoverflow.com/questions/8740498/how-to-unit-test-code-that-uses-hostingenvironment-mappath)）。

对于那些需要可测试性的人，更好的方法可能是按照[https://stackoverflow.com/a/1231962/85196](https://stackoverflow.com/a/1231962/85196)的建议创建自己的路径映射器接口，但将其实现为

```
public class ServerPathMapper : IPathMapper { 
 public string MapPath(string relativePath) { 
      return HostingEnvironment.MapPath(relativePath); 
 } 
} 
```

结果很容易模拟，在内部使用 HostingEnvironment，甚至可以同时解决[ase69s 的问题](https://stackoverflow.com/questions/111927/how-to-access-the-httpserverutility-mappath-method-in-a-thread-or-timer#comment12074999_112220)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-21T20:23:50.247

能不能在启动定时器之前不调用 MapPath 函数，只缓存结果？在滴答事件中调用 MapPath 是绝对必要的吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-21T20:48:56.613

当计时器过去时，没有当前的 HTTP 上下文。这是因为计时器事件与特定的 HTTP 请求无关。

你应该做的是使用 HTTP 上下文可用的 HttpServerUtility.MapPath 。您可以在请求管道事件之一（例如 Page_Load）或 Global.asax 事件（例如 Application_Start）中执行此操作。

将 MapPath 结果分配给可从 Timer.Elapsed 事件访问的变量，您可以在其中使用 Path.Combine 获取所需特定文件的位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T20:23:41.167

我认为当时它为 null 的原因（如果您考虑一下的话），是因为计时器已过事件不会作为 HTTP 请求的一部分发生（因此没有上下文）。它是由您的服务器上的某些东西引起的。

# c - 是否有以二进制格式打印的 printf 转换器？

> ID：111928
> 
> 赞同：514
> 
> 时间：2008-09-21T20:04:58.387
> 
> 标签：c, printf

我可以打印`printf`为十六进制或八进制数。是否有格式标签可以打印为二进制或任意基数？

我正在运行 gcc。

```
printf("%d %x %o\n", 10, 10, 10); //prints "10 A 12\n"
print("%b\n", 10); // prints "%b\n" 
```

* * *

## 回答 #1

> 赞同：322
> 
> 时间：2010-07-08T22:07:56.880

哈克但对我有用：

```
#define BYTE_TO_BINARY_PATTERN "%c%c%c%c%c%c%c%c"
#define BYTE_TO_BINARY(byte)  \
  (byte & 0x80 ? '1' : '0'), \
  (byte & 0x40 ? '1' : '0'), \
  (byte & 0x20 ? '1' : '0'), \
  (byte & 0x10 ? '1' : '0'), \
  (byte & 0x08 ? '1' : '0'), \
  (byte & 0x04 ? '1' : '0'), \
  (byte & 0x02 ? '1' : '0'), \
  (byte & 0x01 ? '1' : '0') 
```

```
printf("Leading text "BYTE_TO_BINARY_PATTERN, BYTE_TO_BINARY(byte)); 
```

对于多字节类型

```
printf("m: "BYTE_TO_BINARY_PATTERN" "BYTE_TO_BINARY_PATTERN"\n",
  BYTE_TO_BINARY(m>>8), BYTE_TO_BINARY(m)); 
```

不幸的是，您需要所有额外的报价。这种方法具有宏的效率风险（不要将函数作为参数传递给`BYTE_TO_BINARY`），但在此处的其他一些建议中避免了内存问题和 strcat 的多次调用。

* * *

## 回答 #2

> 赞同：226
> 
> 时间：2010-10-20T01:37:58.443

**打印任何数据类型的二进制**

```
// Assumes little endian
void printBits(size_t const size, void const * const ptr)
{
    unsigned char *b = (unsigned char*) ptr;
    unsigned char byte;
    int i, j;

    for (i = size-1; i >= 0; i--) {
        for (j = 7; j >= 0; j--) {
            byte = (b[i] >> j) & 1;
            printf("%u", byte);
        }
    }
    puts("");
} 
```

测试：

```
int main(int argv, char* argc[])
{
    int i = 23;
    uint ui = UINT_MAX;
    float f = 23.45f;
    printBits(sizeof(i), &i);
    printBits(sizeof(ui), &ui);
    printBits(sizeof(f), &f);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：161
> 
> 时间：2008-09-22T02:59:20.920

这里有一个快速的技巧来演示做你想做的事情的技巧。

```
#include <stdio.h>      /* printf */
#include <string.h>     /* strcat */
#include <stdlib.h>     /* strtol */

const char *byte_to_binary
(
    int x
)
{
    static char b[9];
    b[0] = '\0';

    int z;
    for (z = 128; z > 0; z >>= 1)
    {
        strcat(b, ((x & z) == z) ? "1" : "0");
    }

    return b;
}

int main
(
    void
)
{
    {
        /* binary string to int */

        char *tmp;
        char *b = "0101";

        printf("%d\n", strtol(b, &tmp, 2));
    }

    {
        /* byte to binary string */

        printf("%s\n", byte_to_binary(5));
    }

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：90
> 
> 时间：2008-09-22T02:53:38.873

glibc 通常没有二进制转换说明符。

可以将自定义转换类型添加到 glibc 中的 printf() 系列函数。有关详细信息，请参见[register_printf_function](http://www.gnu.org/software/libc/manual/html_node/Customizing-Printf.html)。您可以添加自定义 %b 转换供您自己使用，前提是它可以简化应用程序代码以使其可用。

这是一个如何在 glibc 中实现自定义 printf 格式的[示例。](http://codingrelic.geekhold.com/2008/12/printf-acular.html)

* * *

## 回答 #5

> 赞同：59
> 
> 时间：2013-11-10T01:05:33.303

您可以使用一张小桌子来提高速度¹。类似的技术在嵌入式世界中很有用，例如，反转一个字节：

```
const char *bit_rep[16] = {
    [ 0] = "0000", [ 1] = "0001", [ 2] = "0010", [ 3] = "0011",
    [ 4] = "0100", [ 5] = "0101", [ 6] = "0110", [ 7] = "0111",
    [ 8] = "1000", [ 9] = "1001", [10] = "1010", [11] = "1011",
    [12] = "1100", [13] = "1101", [14] = "1110", [15] = "1111",
};

void print_byte(uint8_t byte)
{
    printf("%s%s", bit_rep[byte >> 4], bit_rep[byte & 0x0F]);
} 
```

¹我主要指的是优化器不那么激进且速度差异明显的嵌入式应用程序。

* * *

## 回答 #6

> 赞同：40
> 
> 时间：2014-12-23T19:46:01.957

打印最低有效位并将其移出右侧。这样做直到整数变为零打印二进制表示，不带前导零，但以相反的顺序。使用递归，可以很容易地更正顺序。

```
#include <stdio.h>

void print_binary(unsigned int number)
{
    if (number >> 1) {
        print_binary(number >> 1);
    }
    putc((number & 1) ? '1' : '0', stdout);
} 
```

对我来说，这是解决问题的最干净的方法之一。如果您喜欢`0b`前缀和尾随换行符，我建议包装该函数。

[在线演示](https://ideone.com/aXc7hA)

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2014-08-03T19:46:28.863

根据@William Whyte 的回答，这是一个提供`int8`, `16`, `32`&`64`版本的宏，可重用`INT8`宏以避免重复。

```
/* --- PRINTF_BYTE_TO_BINARY macro's --- */
#define PRINTF_BINARY_PATTERN_INT8 "%c%c%c%c%c%c%c%c"
#define PRINTF_BYTE_TO_BINARY_INT8(i)    \
    (((i) & 0x80ll) ? '1' : '0'), \
    (((i) & 0x40ll) ? '1' : '0'), \
    (((i) & 0x20ll) ? '1' : '0'), \
    (((i) & 0x10ll) ? '1' : '0'), \
    (((i) & 0x08ll) ? '1' : '0'), \
    (((i) & 0x04ll) ? '1' : '0'), \
    (((i) & 0x02ll) ? '1' : '0'), \
    (((i) & 0x01ll) ? '1' : '0')

#define PRINTF_BINARY_PATTERN_INT16 \
    PRINTF_BINARY_PATTERN_INT8              PRINTF_BINARY_PATTERN_INT8
#define PRINTF_BYTE_TO_BINARY_INT16(i) \
    PRINTF_BYTE_TO_BINARY_INT8((i) >> 8),   PRINTF_BYTE_TO_BINARY_INT8(i)
#define PRINTF_BINARY_PATTERN_INT32 \
    PRINTF_BINARY_PATTERN_INT16             PRINTF_BINARY_PATTERN_INT16
#define PRINTF_BYTE_TO_BINARY_INT32(i) \
    PRINTF_BYTE_TO_BINARY_INT16((i) >> 16), PRINTF_BYTE_TO_BINARY_INT16(i)
#define PRINTF_BINARY_PATTERN_INT64    \
    PRINTF_BINARY_PATTERN_INT32             PRINTF_BINARY_PATTERN_INT32
#define PRINTF_BYTE_TO_BINARY_INT64(i) \
    PRINTF_BYTE_TO_BINARY_INT32((i) >> 32), PRINTF_BYTE_TO_BINARY_INT32(i)
/* --- end macros --- */

#include <stdio.h>
int main() {
    long long int flag = 1648646756487983144ll;
    printf("My Flag "
           PRINTF_BINARY_PATTERN_INT64 "\n",
           PRINTF_BYTE_TO_BINARY_INT64(flag));
    return 0;
} 
```

这输出：

```
My Flag 0001011011100001001010110111110101111000100100001111000000101000 
```

为了便于阅读，您可能需要添加一个分隔符，例如：

```
My Flag 00010110,11100001,00101011,01111101,01111000,10010000,11110000,00101000 
```

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2011-01-29T21:34:05.763

这是一个不受可重入问题或参数大小/类型限制的函数版本：

```
#define FMT_BUF_SIZE (CHAR_BIT*sizeof(uintmax_t)+1)

char *binary_fmt(uintmax_t x, char buf[static FMT_BUF_SIZE])
{
    char *s = buf + FMT_BUF_SIZE;
    *--s = 0;
    if (!x) *--s = '0';
    for (; x; x /= 2) *--s = '0' + x%2;
    return s;
} 
```

请注意，如果您只需将 2 替换为所需的基数，则此代码对于 2 到 10 之间的任何基数都同样有效。用法是：

```
char tmp[FMT_BUF_SIZE];
printf("%s\n", binary_fmt(x, tmp)); 
```

哪里`x`是任何积分表达式。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2018-12-19T11:36:14.477

快速简便的解决方案：

```
void printbits(my_integer_type x)
{
    for(int i=sizeof(x)<<3; i; i--)
        putchar('0'+((x>>(i-1))&1));
} 
```

适用于任何大小类型以及有符号和无符号整数。需要 '&1' 来处理有符号整数，因为移位可能会进行符号扩展。

有很多方法可以做到这一点。这是一个超级简单的方法，用于从有符号或无符号 32 位类型打印 32 位或 n 位（如果有符号则不放置负数，只打印实际位）并且没有回车。请注意， i 在位移之前递减：

```
#define printbits_n(x,n) for (int i=n;i;i--,putchar('0'|(x>>i)&1))
#define printbits_32(x) printbits_n(x,32) 
```

返回一个带有位的字符串以供以后存储或打印怎么样？您可以分配内存并返回它，用户必须释放它，或者您返回一个静态字符串，但如果再次调用它或被另一个线程调用，它将被破坏。两种方法都显示：

```
char *int_to_bitstring_alloc(int x, int count)
{
    count = count<1 ? sizeof(x)*8 : count;
    char *pstr = malloc(count+1);
    for(int i = 0; i<count; i++)
        pstr[i] = '0' | ((x>>(count-1-i))&1);
    pstr[count]=0;
    return pstr;
}

#define BITSIZEOF(x)    (sizeof(x)*8)

char *int_to_bitstring_static(int x, int count)
{
    static char bitbuf[BITSIZEOF(x)+1];
    count = (count<1 || count>BITSIZEOF(x)) ? BITSIZEOF(x) : count;
    for(int i = 0; i<count; i++)
        bitbuf[i] = '0' | ((x>>(count-1-i))&1);
    bitbuf[count]=0;
    return bitbuf;
} 
```

致电：

```
// memory allocated string returned which needs to be freed
char *pstr = int_to_bitstring_alloc(0x97e50ae6, 17);
printf("bits = 0b%s\n", pstr);
free(pstr);

// no free needed but you need to copy the string to save it somewhere else
char *pstr2 = int_to_bitstring_static(0x97e50ae6, 17);
printf("bits = 0b%s\n", pstr2); 
```

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2009-03-18T06:57:47.860

```
const char* byte_to_binary(int x)
{
    static char b[sizeof(int)*8+1] = {0};
    int y;
    long long z;

    for (z = 1LL<<sizeof(int)*8-1, y = 0; z > 0; z >>= 1, y++) {
        b[y] = (((x & z) == z) ? '1' : '0');
    }
    b[y] = 0;

    return b;
} 
```

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2012-02-15T03:39:20.423

之前发布的答案都不是我想要的，所以我写了一个。`%B`使用起来超级简单`printf`！

```
/*
 * File:   main.c
 * Author: Techplex.Engineer
 *
 * Created on February 14, 2012, 9:16 PM
 */

#include <stdio.h>
#include <stdlib.h>
#include <printf.h>
#include <math.h>
#include <string.h>

static int printf_arginfo_M(const struct printf_info *info, size_t n, int *argtypes)
{
    /* "%M" always takes one argument, a pointer to uint8_t[6]. */
    if (n > 0) {
        argtypes[0] = PA_POINTER;
    }
    return 1;
}

static int printf_output_M(FILE *stream, const struct printf_info *info, const void *const *args)
{
    int value = 0;
    int len;

    value = *(int **) (args[0]);

    // Beginning of my code ------------------------------------------------------------
    char buffer [50] = "";  // Is this bad?
    char buffer2 [50] = "";  // Is this bad?
    int bits = info->width;
    if (bits <= 0)
        bits = 8;  // Default to 8 bits

    int mask = pow(2, bits - 1);
    while (mask > 0) {
        sprintf(buffer, "%s", ((value & mask) > 0 ? "1" : "0"));
        strcat(buffer2, buffer);
        mask >>= 1;
    }
    strcat(buffer2, "\n");
    // End of my code --------------------------------------------------------------
    len = fprintf(stream, "%s", buffer2);
    return len;
}

int main(int argc, char** argv)
{
    register_printf_specifier('B', printf_output_M, printf_arginfo_M);

    printf("%4B\n", 65);

    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2016-01-06T19:57:42.260

> 是否有以二进制格式打印的 printf 转换器？

该`printf()`系列只能直接使用标准说明符打印以 8、10 和 16 为基数的整数。我建议创建一个函数，根据代码的特定需求将数字转换为字符串。

* * *

**在任何底座上打印 [2-36]**

到目前为止，所有其他答案都至少具有这些限制之一。

1.  使用静态内存作为返回缓冲区。这限制了该函数可用作 的参数的次数`printf()`。

2.  分配需要调用代码以释放指针的内存。

3.  要求调用代码显式提供合适的缓冲区。

4.  直接打电话`printf()`。这为 to `fprintf()`、`sprintf()`、`vsprintf()`等提供了一个新功能。

5.  使用缩小的整数范围。

以下**没有上述限制**。它确实需要 C99 或更高版本并使用`"%s"`. 它使用[*复合文字*](https://en.cppreference.com/w/c/language/compound_literal)来提供缓冲区空间。在一个`printf()`.

```
#include <assert.h>
#include <limits.h>
#define TO_BASE_N (sizeof(unsigned)*CHAR_BIT + 1)

//                               v--compound literal--v
#define TO_BASE(x, b) my_to_base((char [TO_BASE_N]){""}, (x), (b))

// Tailor the details of the conversion function as needed
// This one does not display unneeded leading zeros
// Use return value, not `buf`
char *my_to_base(char buf[TO_BASE_N], unsigned i, int base) {
  assert(base >= 2 && base <= 36);
  char *s = &buf[TO_BASE_N - 1];
  *s = '\0';
  do {
    s--;
    *s = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[i % base];
    i /= base;
  } while (i);

  // Could employ memmove here to move the used buffer to the beginning
  // size_t len = &buf[TO_BASE_N] - s;
  // memmove(buf, s, len);

  return s;
}

#include <stdio.h>
int main(void) {
  int ip1 = 0x01020304;
  int ip2 = 0x05060708;
  printf("%s %s\n", TO_BASE(ip1, 16), TO_BASE(ip2, 16));
  printf("%s %s\n", TO_BASE(ip1, 2), TO_BASE(ip2, 2));
  puts(TO_BASE(ip1, 8));
  puts(TO_BASE(ip1, 36));
  return 0;
} 
```

输出

```
1020304 5060708
1000000100000001100000100 101000001100000011100001000
100401404
A2F44 
```

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2009-07-03T08:45:42.830

此代码应能处理您最多 64 位的需求。我创建了两个函数：`pBin`和`pBinFill`. 两者都做同样的事情，但`pBinFill`用最后一个参数提供的填充字符填充前导空格。`pBinFill`test 函数生成一些测试数据，然后使用该函数将其打印出来。

```
#define kDisplayWidth 64

char* pBin(long int x,char *so)
{
  char s[kDisplayWidth+1];
  int i = kDisplayWidth;
  s[i--] = 0x00;  // terminate string
  do {  // fill in array from right to left
    s[i--] = (x & 1) ? '1' : '0';  // determine bit
    x >>= 1;  // shift right 1 bit
  } while (x > 0);
  i++;  // point to last valid character
  sprintf(so, "%s", s+i);  // stick it in the temp string string
  return so;
}

char* pBinFill(long int x, char *so, char fillChar)
{
  // fill in array from right to left
  char s[kDisplayWidth+1];
  int i = kDisplayWidth;
  s[i--] = 0x00;  // terminate string
  do {  // fill in array from right to left
    s[i--] = (x & 1) ? '1' : '0';
    x >>= 1;  // shift right 1 bit
  } while (x > 0);
  while (i >= 0) s[i--] = fillChar;  // fill with fillChar 
  sprintf(so, "%s", s);
  return so;
}

void test()
{
  char so[kDisplayWidth+1];  // working buffer for pBin
  long int val = 1;
  do {
    printf("%ld =\t\t%#lx =\t\t0b%s\n", val, val, pBinFill(val, so, '0'));
    val *= 11;  // generate test data
  } while (val < 100000000);
} 
```

输出：

```
00000001 =  0x000001 =  0b00000000000000000000000000000001
00000011 =  0x00000b =  0b00000000000000000000000000001011
00000121 =  0x000079 =  0b00000000000000000000000001111001
00001331 =  0x000533 =  0b00000000000000000000010100110011
00014641 =  0x003931 =  0b00000000000000000011100100110001
00161051 =  0x02751b =  0b00000000000000100111010100011011
01771561 =  0x1b0829 =  0b00000000000110110000100000101001
19487171 = 0x12959c3 =  0b00000001001010010101100111000011 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2008-09-21T20:09:35.523

C 标准库中没有格式化函数来输出这样的二进制文件。printf 系列支持的所有格式操作都是针对人类可读文本的。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2008-09-21T20:11:16.250

一些运行时支持“%b”，尽管这不是标准。

另请参阅此处进行有趣的讨论：

[http://bytes.com/forum/thread591027.html](http://bytes.com/forum/thread591027.html)

高温高压

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2008-09-22T08:25:57.420

也许有点 OT，但如果您只需要它来进行调试以了解或追溯您正在执行的一些二进制操作，您可以看看 wcalc（一个简单的控制台计算器）。使用 -b 选项，您可以获得二进制输出。

例如

```
$ wcalc -b "(256 | 3) & 0xff"
 = 0b11

```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2015-03-01T17:48:35.147

以下递归函数可能有用：

```
void bin(int n)
{
    /* Step 1 */
    if (n > 1)
        bin(n/2);
    /* Step 2 */
    printf("%d", n % 2);
} 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2012-10-19T12:50:02.630

利用：

```
char buffer [33];
itoa(value, buffer, 2);
printf("\nbinary: %s\n", buffer); 
```

有关更多参考，请参阅*[如何通过 printf 打印二进制数](https://stackoverflow.com/questions/6373093/how-to-print-binary-number-via-printf)*。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2011-07-17T13:19:49.583

我优化了大小和 C++ 的顶级解决方案，并得到了这个解决方案：

```
inline std::string format_binary(unsigned int x)
{
    static char b[33];
    b[32] = '\0';

    for (int z = 0; z < 32; z++) {
        b[31-z] = ((x>>z) & 0x1) ? '1' : '0';
    }

    return b;
} 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2016-09-08T22:55:54.743

## 使用更少的代码和资源打印任何类型的位

这种方法具有以下属性：

*   适用于变量和文字。
*   不需要时不迭代所有位。
*   仅在完成一个字节时才调用 printf（并非对所有位都不必要）。
*   适用于任何类型。
*   适用于小端和大端（使用 GCC #defines 进行检查）。
*   可以与 char 不是字节（八位）的硬件一起使用。（感谢@supercat）
*   使用不是 C 标准但在很大程度上已定义的 typeof()。

```
#include <stdio.h>
#include <stdint.h>
#include <string.h>
#include <limits.h>

#if __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__
#define for_endian(size) for (int i = 0; i < size; ++i)
#elif __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__
#define for_endian(size) for (int i = size - 1; i >= 0; --i)
#else
#error "Endianness not detected"
#endif

#define printb(value)                                   \
({                                                      \
        typeof(value) _v = value;                       \
        __printb((typeof(_v) *) &_v, sizeof(_v));       \
})

#define MSB_MASK 1 << (CHAR_BIT - 1)

void __printb(void *value, size_t size)
{
        unsigned char uc;
        unsigned char bits[CHAR_BIT + 1];

        bits[CHAR_BIT] = '\0';
        for_endian(size) {
                uc = ((unsigned char *) value)[i];
                memset(bits, '0', CHAR_BIT);
                for (int j = 0; uc && j < CHAR_BIT; ++j) {
                        if (uc & MSB_MASK)
                                bits[j] = '1';
                        uc <<= 1;
                }
                printf("%s ", bits);
        }
        printf("\n");
}

int main(void)
{
        uint8_t c1 = 0xff, c2 = 0x44;
        uint8_t c3 = c1 + c2;

        printb(c1);
        printb((char) 0xff);
        printb((short) 0xff);
        printb(0xff);
        printb(c2);
        printb(0x44);
        printb(0x4411ff01);
        printb((uint16_t) c3);
        printb('A');
        printf("\n");

        return 0;
} 
```

## 输出

```
$ ./printb 
11111111 
11111111 
00000000 11111111 
00000000 00000000 00000000 11111111 
01000100 
00000000 00000000 00000000 01000100 
01000100 00010001 11111111 00000001 
00000000 01000011 
00000000 00000000 00000000 01000001 
```

* * *

我使用**了另一种**方法（[**bitprint.h**](https://github.com/c0defellas/bitprint/blob/master/bitprint.h)）用所有字节（作为位字符串）填充表，并根据输入/索引字节打印它们。值得一看。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2018-05-12T20:51:34.280

```
void
print_binary(unsigned int n)
{
    unsigned int mask = 0;
    /* this grotesque hack creates a bit pattern 1000... */
    /* regardless of the size of an unsigned int */
    mask = ~mask ^ (~mask >> 1);

    for(; mask != 0; mask >>= 1) {
        putchar((n & mask) ? '1' : '0');
    }

} 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2014-08-26T09:33:59.837

这是我为 unsigned int 所做的

```
void printb(unsigned int v) {
    unsigned int i, s = 1<<((sizeof(v)<<3)-1); // s = only most significant bit at 1
    for (i = s; i; i>>=1) printf("%d", v & i || 0 );
} 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-09-21T20:45:42.330

没有标准和便携的方式。

一些实现提供了[itoa()](http://en.wikibooks.org/wiki/C_Programming/C_Reference/stdlib.h/itoa)，但它不会出现在大多数情况下，而且它有一个有点糟糕的接口。但是代码在链接后面，应该可以让您很容易地实现自己的格式化程序。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2010-09-30T10:47:50.543

```
void print_ulong_bin(const unsigned long * const var, int bits) {
        int i;

        #if defined(__LP64__) || defined(_LP64)
                if( (bits > 64) || (bits <= 0) )
        #else
                if( (bits > 32) || (bits <= 0) )
        #endif
                return;

        for(i = 0; i < bits; i++) { 
                printf("%lu", (*var >> (bits - 1 - i)) & 0x01);
        }
} 
```

应该工作 - 未经测试。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2013-04-09T17:53:26.273

这是*paniq*解决方案的一个小变体，它使用模板来允许打印 32 位和 64 位整数：

```
template<class T>
inline std::string format_binary(T x)
{
    char b[sizeof(T)*8+1] = {0};

    for (size_t z = 0; z < sizeof(T)*8; z++)
        b[sizeof(T)*8-1-z] = ((x>>z) & 0x1) ? '1' : '0';

    return std::string(b);
} 
```

并且可以像这样使用：

```
unsigned int value32 = 0x1e127ad;
printf( "  0x%x: %s\n", value32, format_binary(value32).c_str() );

unsigned long long value64 = 0x2e0b04ce0;
printf( "0x%llx: %s\n", value64, format_binary(value64).c_str() ); 
```

结果如下：

```
 0x1e127ad: 00000001111000010010011110101101
0x2e0b04ce0: 0000000000000000000000000000001011100000101100000100110011100000 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2011-08-21T09:45:38.053

我喜欢 paniq 的代码，静态缓冲区是个好主意。但是，如果您想在单个 printf() 中使用多种二进制格式，它会失败，因为它总是返回相同的指针并覆盖数组。

这是一个 C 风格的插件，它在拆分缓冲区上旋转指针。

```
char *
format_binary(unsigned int x)
{
    #define MAXLEN 8 // width of output format
    #define MAXCNT 4 // count per printf statement
    static char fmtbuf[(MAXLEN+1)*MAXCNT];
    static int count = 0;
    char *b;
    count = count % MAXCNT + 1;
    b = &fmtbuf[(MAXLEN+1)*count];
    b[MAXLEN] = '\0';
    for (int z = 0; z < MAXLEN; z++) { b[MAXLEN-1-z] = ((x>>z) & 0x1) ? '1' : '0'; }
    return b;
} 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2015-07-27T18:13:18.140

**使用标准*库将*任何整数类型**通用*转换为二进制字符串表示的一条语句：*

 **```
#include <bitset>
MyIntegralType  num = 10;
print("%s\n",
    std::bitset<sizeof(num) * 8>(num).to_string().insert(0, "0b").c_str()
); // prints "0b1010\n" 
```

[要不就：](https://katyscode.wordpress.com/2012/05/12/printing-numbers-in-binary-format-in-c/) `std::cout << std::bitset<sizeof(num) * 8>(num);`

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2017-07-21T12:47:31.890

根据@ideasman42 在他的回答中的建议，这是一个提供`int8`, `16`, `32`&`64`版本的宏，重用`INT8`宏以避免重复。

```
/* --- PRINTF_BYTE_TO_BINARY macro's --- */
#define PRINTF_BINARY_SEPARATOR
#define PRINTF_BINARY_PATTERN_INT8 "%c%c%c%c%c%c%c%c"
#define PRINTF_BYTE_TO_BINARY_INT8(i)    \
    (((i) & 0x80ll) ? '1' : '0'), \
    (((i) & 0x40ll) ? '1' : '0'), \
    (((i) & 0x20ll) ? '1' : '0'), \
    (((i) & 0x10ll) ? '1' : '0'), \
    (((i) & 0x08ll) ? '1' : '0'), \
    (((i) & 0x04ll) ? '1' : '0'), \
    (((i) & 0x02ll) ? '1' : '0'), \
    (((i) & 0x01ll) ? '1' : '0')

#define PRINTF_BINARY_PATTERN_INT16 \
    PRINTF_BINARY_PATTERN_INT8               PRINTF_BINARY_SEPARATOR              PRINTF_BINARY_PATTERN_INT8
#define PRINTF_BYTE_TO_BINARY_INT16(i) \
    PRINTF_BYTE_TO_BINARY_INT8((i) >> 8),   PRINTF_BYTE_TO_BINARY_INT8(i)
#define PRINTF_BINARY_PATTERN_INT32 \
    PRINTF_BINARY_PATTERN_INT16              PRINTF_BINARY_SEPARATOR              PRINTF_BINARY_PATTERN_INT16
#define PRINTF_BYTE_TO_BINARY_INT32(i) \
    PRINTF_BYTE_TO_BINARY_INT16((i) >> 16), PRINTF_BYTE_TO_BINARY_INT16(i)
#define PRINTF_BINARY_PATTERN_INT64    \
    PRINTF_BINARY_PATTERN_INT32              PRINTF_BINARY_SEPARATOR              PRINTF_BINARY_PATTERN_INT32
#define PRINTF_BYTE_TO_BINARY_INT64(i) \
    PRINTF_BYTE_TO_BINARY_INT32((i) >> 32), PRINTF_BYTE_TO_BINARY_INT32(i)
/* --- end macros --- */

#include <stdio.h>
int main() {
    long long int flag = 1648646756487983144ll;
    printf("My Flag "
           PRINTF_BINARY_PATTERN_INT64 "\n",
           PRINTF_BYTE_TO_BINARY_INT64(flag));
    return 0;
} 
```

这输出：

```
My Flag 0001011011100001001010110111110101111000100100001111000000101000 
```

为了便于阅读，您可以将 : 更改`#define PRINTF_BINARY_SEPARATOR`为`#define PRINTF_BINARY_SEPARATOR ","`或`#define PRINTF_BINARY_SEPARATOR " "`

这将输出：

```
My Flag 00010110,11100001,00101011,01111101,01111000,10010000,11110000,00101000 
```

或者

```
My Flag 00010110 11100001 00101011 01111101 01111000 10010000 11110000 00101000 
```

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2016-03-28T20:19:57.983

我的解决方案：

```
long unsigned int i;
for(i = 0u; i < sizeof(integer) * CHAR_BIT; i++) {
    if(integer & LONG_MIN)
        printf("1");
    else
        printf("0");
    integer <<= 1;
}
printf("\n"); 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2012-01-15T10:57:58.887

接下来将向您展示内存布局：

```
#include <limits>
#include <iostream>
#include <string>

using namespace std;

template<class T> string binary_text(T dec, string byte_separator = " ") {
    char* pch = (char*)&dec;
    string res;
    for (int i = 0; i < sizeof(T); i++) {
        for (int j = 1; j < 8; j++) {
            res.append(pch[i] & 1 ? "1" : "0");
            pch[i] /= 2;
        }
        res.append(byte_separator);
    }
    return res;
}

int main() {
    cout << binary_text(5) << endl;
    cout << binary_text(.1) << endl;

    return 0;
} 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2010-10-24T10:07:56.490

```
#include <stdio.h>
#include <conio.h>

void main()
{
    clrscr();
    printf("Welcome\n\n\n");
    unsigned char x='A';
    char ch_array[8];
    for(int i=0; x!=0; i++)
    {
        ch_array[i] = x & 1;
        x = x >>1;
    }
    for(--i; i>=0; i--)
        printf("%d", ch_array[i]);

    getch();
} 
```

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2013-11-12T21:15:31.523

另一种以二进制打印的方法：**首先转换整数**。

要`6`以二进制打印，请更改`6`为`110`，然后打印`"110"`。

绕过`char buf[]`问题。
`printf()`格式说明符、标志和字段，如`"%08lu"`，`"%*lX"`仍然很容易使用。
不仅是二进制（基数 2），此方法可扩展到其他基数，最多 16 个。
仅限于较小的整数值。

```
#include <stdint.h>
#include <stdio.h>
#include <inttypes.h>

unsigned long char_to_bin10(char ch) {
  unsigned char uch = ch;
  unsigned long sum = 0;
  unsigned long power = 1;
  while (uch) {
    if (uch & 1) {
      sum += power;
      }
   power *= 10;
   uch /= 2;
  }
  return sum;
}

uint64_t uint16_to_bin16(uint16_t u) {
  uint64_t sum = 0;
  uint64_t power = 1;
  while (u) {
    if (u & 1) {
      sum += power;
      }
    power *= 16;
    u /= 2;
  }
  return sum;
}

void test(void) {
  printf("%lu\n", char_to_bin10(0xF1));
  // 11110001
  printf("%" PRIX64 "\n", uint16_to_bin16(0xF731));
  // 1111011100110001
} 
```

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2014-10-02T04:37:06.647

C 中的一个小实用程序函数可以在解决位操作问题的同时执行此操作。这使用掩码检查每个设置位的字符串（1<

```
void
printStringAsBinary(char * input)
{
    char * temp = input;
    int i = 7, j =0;;
    int inputLen = strlen(input);

    /* Go over the string, check first bit..bit by bit and print 1 or 0
     **/

    for (j = 0; j < inputLen; j++) {
        printf("\n");
        while (i>=0) {
            if (*temp & (1 << i)) {
               printf("1");
            } else {
                printf("0");
            }
            i--;
        }
        temp = temp+1;
        i = 7;
        printf("\n");
    }
} 
```

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2014-03-19T15:52:27.823

我只想发布我的解决方案。它用于获取一个字节的 0 和 1，但多次调用此函数可用于更大的数据块。我将它用于 128 位或更大的结构。您还可以修改它以使用 size_t 作为输入参数和指向要打印的数据的指针，因此它可以与大小无关。但这对我来说很有效。

```
void print_binary(unsigned char c)
{
 unsigned char i1 = (1 << (sizeof(c)*8-1));
 for(; i1; i1 >>= 1)
      printf("%d",(c&i1)!=0);
}

void get_binary(unsigned char c, unsigned char bin[])
{
 unsigned char i1 = (1 << (sizeof(c)*8-1)), i2=0;
 for(; i1; i1>>=1, i2++)
      bin[i2] = ((c&i1)!=0);
} 
```

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2011-07-01T10:22:15.103

```
/* Convert an int to it's binary representation */

char *int2bin(int num, int pad)
{
 char *str = malloc(sizeof(char) * (pad+1));
  if (str) {
   str[pad]='\0';
   while (--pad>=0) {
    str[pad] = num & 1 ? '1' : '0';
    num >>= 1;
   }
  } else {
   return "";
  }
 return str;
}

/* example usage */

printf("The number 5 in binary is %s", int2bin(5, 4));
/* "The number 5 in binary is 0101" */ 
```

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2018-04-16T10:20:20.127

```
void DisplayBinary(unsigned int n)
{
    int l = sizeof(n) * 8;
    for (int i = l - 1 ; i >= 0; i--) {
        printf("%x", (n & (1 << i)) >> i);
    }
} 
```

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2022-02-04T23:26:04.433

自 2022 年 2 月 3 日起，GNU C 库已更新至[版本 2.35](https://sourceware.org/pipermail/libc-alpha/2022-February/136040.html)。因此，`%b`现在支持以二进制格式输出。

> printf 系列函数现在支持以 %b 格式输出二进制整数，如 ISO C2X 草案中指定的那样，以及 ISO C2X 草案推荐的该格式的 %B 变体。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2017-02-15T11:23:48.130

There is also an idea to convert the number to hexadecimal format and then to decode each hexadecimal cipher to four "bits" (ones and zeros). `sprintf` can do bit operations for us:

```
const char* binary(int n) {
  static const char binnums[16][5] = { "0000","0001","0010","0011",
    "0100","0101","0110","0111","1000","1001","1010","1011","1100","1101","1110","1111" };
  static const char* hexnums = "0123456789abcdef";
  static char inbuffer[16], outbuffer[4*16];
  const char *i;
  sprintf(inbuffer,"%x",n); // hexadecimal n -> inbuffer
  for(i=inbuffer; *i!=0; ++i) { // for each hexadecimal cipher
    int d = strchr(hexnums,*i) - hexnums; // store its decimal value to d
    char* o = outbuffer+(i-inbuffer)*4; // shift four characters in outbuffer
    sprintf(o,"%s",binnums[d]); // place binary value of d there
  }
  return strchr(outbuffer,'1'); // omit leading zeros
}

puts(binary(42)); // outputs 101010 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2018-01-16T05:32:34.063

```
void DisplayBinary(int n)
{
    int arr[8];
    int top =-1;
    while (n)
    {
        if (n & 1)
            arr[++top] = 1;
        else
            arr[++top] = 0;

        n >>= 1;
    }
    for (int i = top ; i > -1;i--)
    {
        printf("%d",arr[i]);
    }
    printf("\n");
} 
```

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2020-06-08T15:38:33.770

我的解决方案返回一个 int，然后可以在 printf 中使用它。它还可以按大端或小端顺序返回位。

```
#include <stdio.h>
#include <stdint.h>

int binary(uint8_t i,int bigEndian)
{
    int j=0,m = bigEndian ? 1 : 10000000;
    while (i)
    {
        j+=m*(i%2);
        if (bigEndian) m*=10; else m/=10;
        i >>= 1;
    }
    return j;
}

int main()
{
    char buf[]="ABCDEF";
    printf("\nbig endian = ");
    for (int i=0; i<5; i++) printf("%08d ",binary(buf[i],1));
    printf("\nwee endian = ");
    for (int i=0; i<5; i++) printf("%08d ",binary(buf[i],0));
    getchar();
    return 0;
} 
```

输出

```
big endian = 01000001 01000010 01000011 01000100 01000101 01000110
wee endian = 10000010 01000010 11000010 00100010 10100010 01100010 
```

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2018-08-07T07:21:46.170

做一个函数并调用它

```
display_binary(int n)
{
    long int arr[32];
    int arr_counter=0;
    while(n>=1)
    {
        arr[arr_counter++]=n%2;
        n/=2;
    }
    for(int i=arr_counter-1;i>=0;i--)
    {
        printf("%d",arr[i]);
    }
} 
```

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2017-07-11T18:12:04.110

也许有人会发现这个解决方案很有用：

```
void print_binary(int number, int num_digits) {
    int digit;
    for(digit = num_digits - 1; digit >= 0; digit--) {
        printf("%c", number & (1 << digit) ? '1' : '0');
    }
} 
```

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2020-06-08T15:40:11.770

这个答案末尾的函数+宏的组合可以帮助你。

像这样使用它：

```
float float_var = 9.4;
SHOW_BITS(float_var); 
```

这将输出：`Variable 'float_var': 01000001 00010110 01100110 01100110`

请注意，它非常通用，几乎可以用于任何类型。例如：

```
struct {int a; float b; double c;} struct_var = {1,1.1,1.2};
SHOW_BITS(struct_var); 
```

这将输出：

```
Variable `struct_var`: 00111111 11110011 00110011 00110011 00110011 00110011 00110011 00110011 00111111 10001100 11001100 11001101 00000000 00000000 00000000 00000001 
```

这是代码：

```
#define SHOW_BITS(a) ({ \
    printf("Variable `%s`: ", #a);\
    show_bits(&a, sizeof(a));\
})

void show_uchar(unsigned char a)
{
    for(int i = 7; i >= 0; i-= 1) 
        printf("%d", ((a >> i) & 1));
}

void show_bits(void* a, size_t s)
{
    unsigned char* p = (unsigned char*) a;
    for(int i = s-1; i >= 0 ; i -= 1) {
        show_uchar(p[i]);
        printf(" ");
    }
    printf("\n");
} 
```

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2021-02-21T01:09:46.257

```
void print_bits (uintmax_t n)
{
    for (size_t i = 8 * sizeof (int); i-- != 0;)
    {
        char c;
        if ((n & (1UL << i)) != 0)
            c = '1';
        else
            c = '0';

        printf ("%c", c);

    }
} 
```

不是一个绝对无处不在的解决方案，但如果你想要快速且易于理解的东西，我很惊讶还没有人提出这个解决方案。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2011-07-21T01:51:11.647

是否有以二进制格式打印的 printf 转换器？

没有标准的 printf 格式说明符来完成“二进制”输出。这是我在需要时设计的替代方案。

我的适用于从 2 到 36 的任何基数。它将数字扇出到递归调用的调用帧中，直到它达到一个小于基数的数字。然后它向后“遍历”，向前填充缓冲区，然后返回。返回值是使用的大小，如果缓冲区不足以容纳字符串，则返回 -1。

```
int conv_rad (int num, int rad, char *s, int n) {
    char *vec = "0123456789" "ABCDEFGHIJKLM" "NOPQRSTUVWXYZ";
    int off;
    if (n == 0) return 0;
    if (num < rad) { *s = vec[num]; return 1; }
    off = conv_rad(num/rad, rad, s, n);
    if ((off == n) || (off == -1)) return -1;
    s[off] = vec[num%rad];
    return off+1;
} 
```

*一个重要的警告：*这个函数是为使用带有长度的“Pascal”风格的字符串而设计的。因此`conv_rad`，正如所写的那样，不会终止缓冲区。对于更一般的 C 用途，它可能需要一个简单的包装器来终止。或者对于打印，只需将分配更改为`putchar()`s。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2014-11-17T10:10:17.407

```
void binario(int num) {
  for(int i=0;i<32;i++){
    (num&(1<i))? printf("1"):
        printf("0");
  }  
  printf("\n");
} 
```

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2010-10-21T16:54:08.817

```
void PrintBinary( int Value, int Places, char* TargetString)
{
    int Mask;

    Mask = 1 << Places;

    while( Places--) {
        Mask >>= 1; /* Preshift, because we did one too many above */
        *TargetString++ = (Value & Mask)?'1':'0';
    }
    *TargetString = 0; /* Null terminator for C string */
} 
```

调用函数“拥有”字符串...：

```
char BinaryString[17];
...
PrintBinary( Value, 16, BinaryString);
printf( "yadda yadda %s yadda...\n", BinaryString); 
```

根据您的 CPU，PrintBinary 中的大多数操作都呈现为一条或极少数机器指令。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2009-05-06T14:54:32.680

即使对于支持 %b 的运行时库，它似乎也仅适用于整数值。

如果您想以二进制形式打印浮点值，我编写了一些代码，您可以在[http://www.exploringbinary.com/converting-floating-point-numbers-to-binary-strings-in-c/](http://www.exploringbinary.com/converting-floating-point-numbers-to-binary-strings-in-c/)找到。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2013-06-29T13:38:29.090

它可能不是很有效，但它很简单。尝试这个：

```
tmp1 = 1;
while(inint/tmp1 > 1) {
    tmp1 <<= 1;
}
do {
    printf("%d", tmp2=inint/tmp1);
    inint -= tmp1*tmp2;
} while((tmp1 >>= 1) > 0);
printf(" "); 
```

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2013-10-19T19:26:35.563

这是一个非常简单的：

```
int print_char_to_binary(char ch)
{
    int i;
    for (i=7; i>=0; i--)
        printf("%hd ", ((ch & (1<<i))>>i));
    printf("\n");
    return 0;
} 
```

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2022-01-31T17:16:56.500

简单，经过测试，适用于任何无符号整数类型。没有头痛。

```
#include <stdint.h>
#include <stdio.h>

// Prints the binary representation of any unsigned integer
// When running, pass 1 to first_call
void printf_binary(unsigned int number, int first_call)
{
        if (first_call)
        {
                printf("The binary representation of %d is [", number);
        }
        if (number >> 1)
        {
                printf_binary(number >> 1, 0);
                putc((number & 1) ? '1' : '0', stdout);
        }
        else 
        {
                putc((number & 1) ? '1' : '0', stdout);
        }
        if (first_call)
        {
                printf("]\n");
        }
} 
```

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2021-03-17T20:32:20.377

主程序

```
// Based on https://stackoverflow.com/a/112956/1438550

#include <stdio.h>
#include <stdint.h>

const char *int_to_binary_str(int x, int N_bits){
    static char b[512];
    char *p = b;
    b[0] = '\0';

    for(int i=(N_bits-1); i>=0; i--){
      *p++ = (x & (1<<i)) ? '1' : '0';
      if(!(i%4)) *p++ = ' ';
    }
    return b;
}

int main() {
  for(int i=31; i>=0; i--){
    printf("0x%08X %s \n", (1<<i), int_to_binary_str((1<<i), 32));
  }
  return 0;
} 
```

预期行为：

```
Run:
gcc -pthread -Wformat=0 -lm -o main main.c; ./main

Output:
0x80000000 1000 0000 0000 0000 0000 0000 0000 0000  
0x40000000 0100 0000 0000 0000 0000 0000 0000 0000  
0x20000000 0010 0000 0000 0000 0000 0000 0000 0000  
0x10000000 0001 0000 0000 0000 0000 0000 0000 0000  
0x08000000 0000 1000 0000 0000 0000 0000 0000 0000  
0x04000000 0000 0100 0000 0000 0000 0000 0000 0000  
0x02000000 0000 0010 0000 0000 0000 0000 0000 0000  
0x01000000 0000 0001 0000 0000 0000 0000 0000 0000  
0x00800000 0000 0000 1000 0000 0000 0000 0000 0000  
0x00400000 0000 0000 0100 0000 0000 0000 0000 0000  
0x00200000 0000 0000 0010 0000 0000 0000 0000 0000  
0x00100000 0000 0000 0001 0000 0000 0000 0000 0000  
0x00080000 0000 0000 0000 1000 0000 0000 0000 0000  
0x00040000 0000 0000 0000 0100 0000 0000 0000 0000  
0x00020000 0000 0000 0000 0010 0000 0000 0000 0000  
0x00010000 0000 0000 0000 0001 0000 0000 0000 0000  
0x00008000 0000 0000 0000 0000 1000 0000 0000 0000  
0x00004000 0000 0000 0000 0000 0100 0000 0000 0000  
0x00002000 0000 0000 0000 0000 0010 0000 0000 0000  
0x00001000 0000 0000 0000 0000 0001 0000 0000 0000  
0x00000800 0000 0000 0000 0000 0000 1000 0000 0000  
0x00000400 0000 0000 0000 0000 0000 0100 0000 0000  
0x00000200 0000 0000 0000 0000 0000 0010 0000 0000  
0x00000100 0000 0000 0000 0000 0000 0001 0000 0000  
0x00000080 0000 0000 0000 0000 0000 0000 1000 0000  
0x00000040 0000 0000 0000 0000 0000 0000 0100 0000  
0x00000020 0000 0000 0000 0000 0000 0000 0010 0000  
0x00000010 0000 0000 0000 0000 0000 0000 0001 0000  
0x00000008 0000 0000 0000 0000 0000 0000 0000 1000  
0x00000004 0000 0000 0000 0000 0000 0000 0000 0100  
0x00000002 0000 0000 0000 0000 0000 0000 0000 0010  
0x00000001 0000 0000 0000 0000 0000 0000 0000 0001 
```

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2020-05-31T17:29:51.517

```
// m specifies how many of the low bits are shown.
// Replace m with sizeof(n) below for all bits and
// remove it from the parameter list if you like.

void print_binary(unsigned long n, unsigned long m) {
    static char show[3] = "01";
    unsigned long mask = 1ULL << (m-1);
    while(mask) {
        putchar(show[!!(n&mask)]); mask >>= 1;
    }
    putchar('\n');
} 
```

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2016-01-09T00:40:50.240

以下函数使用不带前导零的指针算术返回给定无符号整数的二进制表示：

```
const char* toBinaryString(unsigned long num)
{
    static char buffer[CHAR_BIT*sizeof(num)+1];
    char* pBuffer = &buffer[sizeof(buffer)-1];

    do *--pBuffer = '0' + (num & 1);
    while (num >>= 1);
    return pBuffer;
} 
```

请注意，不需要显式设置`NUL`终止符，因为`buffer`它表示一个具有*静态存储持续时间*的对象，该对象已经用全零填充。

通过简单地修改形式参数的类型，这可以很容易地适应`unsigned long long`（或另一个无符号整数） 。`num`

`CHAR_BIT`需要包括`<limits.h>`在内。

这是一个示例用法：

```
int main(void)
{
    printf(">>>%20s<<<\n", toBinaryString(1));
    printf(">>>%-20s<<<\n", toBinaryString(254));
    return 0;
} 
```

其所需的输出为：

```
>>>                   1<<<
>>>11111110            <<< 
```

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2017-09-13T09:10:55.407

使用以下功能：

```
void conbin(int num){  
        if(num != 0)
        {
            conbin(num >> 1);     
            if (num & 1){
            printf("1");
            }
            else{
            printf("0");
            }
        }
    } 
```

* * *

## 回答 #56

> 赞同：0
> 
> 时间：2019-12-26T14:40:14.180

这是我对这个主题的看法。

大多数其他示例的优点：

1.  `putchar()`比`printf()`甚至更有效的用途（尽管没有那么多）`puts()`
2.  分成两部分（预计内联代码），如果需要，可以提高效率。
3.  基于非常快速的 RISC 算术运算（包括不使用除法和乘法）

大多数例子的缺点：

1.  代码不是很简单。
2.  `print_binary_size()`修改输入变量而不复制。

注意：此代码的最佳结果依赖于使用`-O1`或更高版本`gcc`或等价物。

这是代码：

```
 inline void print_binary_sized(unsigned int number, unsigned int digits) {
        static char ZERO = '0';
        int digitsLeft = digits;

        do{
            putchar(ZERO + ((number >> digitsLeft) & 1));
        }while(digitsLeft--);
    }

    void print_binary(unsigned int number) {
        int digitsLeft = sizeof(number) * 8;

        while((~(number >> digitsLeft) & 1) && digitsLeft){
            digitsLeft--;
        }
        print_binary_sized(number, digitsLeft);
    } 
```

# language-agnostic - 为什么我不应该使用“匈牙利符号”？

> ID：111933
> 
> 赞同：122
> 
> 时间：2008-09-21T20:08:53.497
> 
> 标签：language-agnostic, naming-conventions, hungarian-notation

我知道匈牙利语指的是什么 - 提供有关变量、参数或类型的信息作为其名称的前缀。每个人似乎都强烈反对它，尽管在某些情况下这似乎是一个好主意。如果我觉得有用的信息正在被传递，为什么我不应该把它放在可以得到的地方呢？

另请参阅：[人们在现实世界中使用匈牙利命名约定吗？](https://stackoverflow.com/questions/5428/do-people-use-the-hungarian-naming-conventions-in-the-real-world)

* * *

## 回答 #1

> 赞同：276
> 
> 时间：2008-09-21T20:45:20.803

v 使用 adjHungarian 注释 v 使阅读 ncode adj 困难。

* * *

## 回答 #2

> 赞同：174
> 
> 时间：2008-09-21T20:18:55.623

大多数人以错误的方式使用匈牙利符号并得到错误的结果。

阅读 Joel Spolsky 的这篇优秀文章：[让错误的代码看起来是错误](http://www.joelonsoftware.com/articles/Wrong.html)的。

简而言之，在变量名称前加上它们的`type`（字符串）（匈牙利系统）的匈牙利表示法是不好的，因为它没用。

Hungarian Notation 正如其作者所设计的那样，您在变量名称前加上它的前缀`kind`（使用 Joel 的示例：安全字符串或不安全字符串），所谓的 Apps Hungarian 有其用途并且仍然很有价值。

* * *

## 回答 #3

> 赞同：104
> 
> 时间：2008-09-22T12:12:42.883

乔尔错了，这就是原因。

他所说的“应用程序”信息*应该在类型系统中编码*。您不应依赖翻转变量名称来确保不会将不安全数据传递给需要安全数据的函数。您应该将其设为类型错误，这样就*不可能*这样做。任何不安全的数据都应该有一个标记为不安全的类型，这样它就不能被传递给一个安全的函数。从不安全转换为安全应该需要使用某种清理功能进行处理。

乔尔所说的“种类”的很多东西都不是种类。事实上，它们是类型。

然而，大多数语言缺乏的是一种类型系统，它的表达能力足以强制执行这些区别。例如，如果 C 有一种“强 typedef”（其中 typedef 名称具有基本类型的所有操作，但不能转换为它），那么很多这些问题都会消失。例如，如果您可以说，`strong typedef std::string unsafe_string;`要引入一种`unsafe_string`无法转换为 std::string 的新类型（因此可以参与重载决议等），那么我们就不需要愚蠢的前缀。

因此，匈牙利语是针对非类型事物的核心主张是错误的。它被用于类型信息。当然，比传统的 C 类型信息更丰富的类型信息；它是对某种语义细节进行编码以指示对象用途的类型信息。但它仍然是类型信息，正确的解决方案一直是将其编码到类型系统中。将其编码到类型系统中无疑是获得正确验证和执行规则的最佳方式。变量名称根本不切实际。

换句话说，目标不应该是“让错误的代码在开发人员看来是错误的”。它应该是“让错误的代码*在编译器看来是错误的*”。

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2008-09-21T20:11:00.073

我认为它严重混淆了源代码。

在强类型语言中它也不会给你带来太多好处。如果你做了任何形式的类型不匹配错误，编译器会告诉你。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2008-09-21T20:43:18.343

**匈牙利符号仅在没有用户定义类型**的语言中才有意义。在现代函数式或 OO 语言中，您会将有关“种类”值的信息编码到数据类型或类中，而不是变量名中。

几个答案参考[了 Joels 的文章](http://www.joelonsoftware.com/articles/Wrong.html)。但是请注意，他的示例使用的是 VBScript，它不支持用户定义的类（至少在很长一段时间内）。在具有用户定义类型的语言中，您可以通过创建 HtmlEncodedString 类型来解决相同的问题，然后让 Write 方法只接受它。在静态类型语言中，编译器将捕获任何编码错误，在动态类型中，您将获得运行时异常 - 但无论如何您都可以防止编写未编码的字符串。匈牙利符号只是将程序员变成了人类类型检查员，这种工作通常由软件更好地处理。

Joel 区分了“systems Hungarian”和“apps Hungarian”，其中“systems Hungarian”编码了int、float等内置类型，“Apps Hungarian”编码了“kinds”，这是更高级的元信息关于机器类型之外的变量，在 OO 或现代函数式语言中，您可以创建用户定义的类型，因此在这个意义上，类型和“种类”之间没有区别 - 两者都可以由类型系统表示 - 和“应用程序”匈牙利语与“系统”匈牙利语一样多余。

所以回答你的问题：*系统匈牙利语*只会在不安全的弱类型语言中有用，例如将浮点值分配给 int 变量会使系统崩溃。匈牙利符号是在 60 年代专门发明用于[BCPL](http://en.wikipedia.org/wiki/BCPL)的，这是一种相当低级的语言，根本不做任何类型检查。我认为今天普遍使用的任何语言都没有这个问题，但这种符号作为一种[货物崇拜编程](http://en.wikipedia.org/wiki/Cargo_cult_programming)而存在。

*如果您使用的是没有用户定义类型的语言，例如旧版 VBScript 或早期版本的 VB，应用匈牙利语*将是有意义的。也许还有 Perl 和 PHP 的早期版本。同样，在现代语言中使用它是纯粹的货物崇拜。

在任何其他语言中，匈牙利语都是丑陋、多余和脆弱的。它重复从类型系统中已知的信息，[你不应该重复自己](http://www.artima.com/intv/dry.html)。为描述该类型特定实例的意图的变量使用描述性名称。使用类型系统来编码关于变量“种类”或“类”的不变量和元信息 - 即。类型。

Joels 文章的一般观点 - 让错误的代码看起来不正确 - 是一个非常好的原则。然而，对错误更好的保护是——在可能的情况下——让编译器自动检测到错误代码。

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2008-09-22T12:19:30.793

我的所有项目总是使用匈牙利符号。当我处理 100 多个不同的标识符名称时，我发现它真的很有帮助。

例如，当我调用一个需要字符串的函数时，我可以输入 's' 并点击控制空间，我的 IDE 将准确地显示以 's' 为前缀的变量名称。

另一个优点是，当我为未签名的整数添加 u 和为已签名的整数添加 i 时，我会立即看到我以潜在危险的方式混合有符号和无符号的位置。

我不记得有多少次在一个巨大的 75000 行代码库中，由于将局部变量命名为与该类的现有成员变量相同，导致错误（由我和其他人引起）。从那以后，我总是在成员前面加上'm_'

这是一个品味和经验的问题。在你尝试之前不要敲它。

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2008-09-22T12:39:38.607

您忘记了包含此信息的首要原因。与你无关，程序员。这与你离开公司 2 或 3 年后下路的人有关，他必须阅读那些东西。

是的，IDE 会为您快速识别类型。但是，当您阅读一些长批次的“业务规则”代码时，不必在每个变量上暂停以找出它是什么类型，这很好。当我看到诸如 strUserID、intProduct 或 guiProductID 之类的东西时，它使“加速”时间变得更加容易*。*

我同意 MS 在他们的一些命名约定上走得太远了——我将其归类为“太多的好东西”。

命名约定是好事，只要你坚持。我已经浏览了足够多的旧代码，这些代码让我不断地回头查看许多类似名称的变量的定义，以至于我推动了“骆驼外壳”（就像在以前的工作中所说的那样）。现在，我的工作有数千行完全没有注释的带有 VBScript 的经典 ASP 代码，而试图弄清楚事情是一场噩梦。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-09-21T20:28:22.810

在每个变量名的开头添加神秘字符是不必要的，这表明变量名本身的描述性不够。无论如何，大多数语言在声明时都需要变量类型，因此该信息已经可用。

还有一种情况是，在维护期间，变量类型需要更改。示例：如果声明为“uint_16 u16foo”的变量需要变为 64 位无符号，则会发生以下两种情况之一：

1.  您将检查并更改每个变量名称（确保不要使用相同名称处理任何不相关的变量），或者
2.  只改类型不改名字，只会造成混乱。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-09-21T20:12:14.877

Joel Spolsky 写了一篇很好的博客文章。 [http://www.joelonsoftware.com/articles/Wrong.html](http://www.joelonsoftware.com/articles/Wrong.html) 基本上，当一个像样的 IDE 会告诉您想要键入变量时，它归结为不会使您的代码更难阅读，如果您不记得的话。此外，如果您将代码划分得足够多，您就不必记住三页以上声明的变量是什么。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2008-09-22T12:31:13.400

这些天范围不是比类型更重要吗，例如

```
* l for local
* a for argument
* m for member
* g for global
* etc 
```

使用重构旧代码的现代技术，搜索和替换符号因为你改变了它的类型是乏味的，编译器会捕捉到类型变化，但通常不会捕捉到范围的不正确使用，明智的命名约定在这里有所帮助。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2008-09-21T22:54:34.080

没有理由不*正确*使用匈牙利符号。它不受欢迎是因为长期以来一直反对*滥用*匈牙利符号，尤其是在 Windows API 中。

在过去的糟糕日子里，在任何类似 IDE 的 DOS 存在之前（很可能你没有足够的空闲内存来在 Windows 下运行编译器，所以你的开发是在 DOS 中完成的），你没有得到任何帮助将鼠标悬停在变量名称上。（假设您有鼠标。）您必须处理的是事件回调函数，其中所有内容都以 16 位整数 (WORD) 或 32 位整数 (LONG WORD) 的形式传递给您。然后，您必须将这些参数转换为给定事件类型的适当类型。实际上，大部分 API 几乎都是无类型的。

结果，一个具有如下参数名称的 API：

```
LRESULT CALLBACK WindowProc(HWND hwnd,
                            UINT uMsg,
                            WPARAM wParam,
                            LPARAM lParam); 
```

请注意，wParam 和 lParam 的名称虽然很糟糕，但实际上并不比将它们命名为 param1 和 param2 差。

更糟糕的是，Window 3.0/3.1 有两种类型的指针，near 和 far。因此，例如，内存管理函数 LocalLock 的返回值是 PVOID，但 GlobalLock 的返回值是 LPVOID（“L”表示长）。然后，这个糟糕的符号得到扩展，以便长**指针字符串以 lp****为**前缀，以将其与只是被 malloc 的字符串区分开来**。**

 **对这种事情的强烈反对也就不足为奇了。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-09-21T20:27:50.580

匈牙利符号在没有编译时类型检查的语言中很有用，因为它允许开发人员快速提醒自己如何使用特定变量。它对性能或行为没有任何作用。它应该提高代码的可读性，主要是一种品味和编码风格。正是因为这个原因，它受到了许多开发人员的批评——不是每个人的大脑都有相同的接线。

对于编译时类型检查语言，它几乎是无用的——向上滚动几行应该会显示声明并因此显示类型。如果你的全局变量或你的代码块跨越了不止一个屏幕，你就会遇到严重的设计和可重用性问题。因此，批评之一是匈牙利符号允许开发人员进行糟糕的设计并轻松摆脱它。这大概是被讨厌的原因之一吧。

另一方面，在某些情况下，即使是编译时类型检查语言也会受益于匈牙利表示法——win32 API 中的*void*指针或*HANDLE*。这些混淆了实际的数据类型，在那里使用匈牙利表示法可能有好处。然而，如果可以在构建时知道数据的类型，为什么不使用适当的数据类型。

一般来说，没有理由不使用匈牙利符号。这是一个喜欢、策略和编码风格的问题。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2008-09-24T01:31:14.873

作为一名 Python 程序员，Hungarian Notation 很快就崩溃了。在 Python 中，我不在乎某个东西*是否*是字符串——我关心它是否可以*像*字符串一样工作（即，它是否有一个`___str___()`返回字符串的方法）。

例如，假设我们有 foo 作为整数，12

```
foo = 12 
```

匈牙利符号告诉我们应该称它为 iFoo 或其他东西，以表示它是一个整数，以便稍后我们知道它是什么。除了在 Python 中，这不起作用，或者更确切地说，它没有意义。在 Python 中，当我使用它时，我决定了我想要什么类型。我想要一个字符串吗？好吧，如果我这样做：

```
print "The current value of foo is %s" % foo 
```

注意`%s`- 字符串。Foo 不是字符串，但`%`操作员将调用`foo.___str___()`并使用结果（假设它存在）。`foo`仍然是一个整数，但如果我们想要一个字符串，我们就把它当作一个字符串。如果我们想要一个浮点数，那么我们将它视为一个浮点数。在像 Python 这样的动态类型语言中，匈牙利表示法是没有意义的，因为在你使用它之前，它是什么类型并不重要，如果你需要一个特定的类型，那么只要确保在你使用它时将它转换为那个类型（`float(foo)`例如用它。

请注意，像 PHP 这样的动态语言没有这个好处——PHP 试图根据一组几乎没有人记住的晦涩规则在后台做“正确的事情”，这通常会意外地导致灾难性的混乱。在这种情况下，某种命名机制，比如`$files_count`or `$file_name`，会很方便。

在我看来，匈牙利符号就像水蛭。也许在过去它们是有用的，或者至少它们看起来很有用，但现在它只是很多额外的打字而没有太多好处。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-09-21T20:12:14.737

IDE 应该传递这些有用的信息。当 IDE 不那么先进时，匈牙利语可能有某种意义（不是很多，而是某种意义上）。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2011-07-28T01:44:48.573

## 匈牙利语对我来说是希腊语——以一种很好的方式

作为一名工程师，而不是程序员，我立即阅读了 Joel 关于 Apps Hungarian 优点的文章：[“让错误的代码看起来是错误的”](http://www.joelonsoftware.com/articles/Wrong.html)。我喜欢 Apps Hungarian，因为它模仿工程、科学和数学如何使用下标和上标符号（如希腊字母、数学运算符等）**来表示方程式和公式。**以[牛顿万有引力定律](http://en.wikipedia.org/wiki/Newton's_law_of_universal_gravitation)为例：首先是标准数学符号，然后是 Apps Hungarian 伪代码：

![牛顿的地球和火星万有引力定律](https://i.stack.imgur.com/gP30j.jpg)

```
frcGravityEarthMars = G * massEarth * massMars / norm(posEarth - posMars) 
```

在数学符号中，最突出的符号是那些表示存储在变量中的信息*种类*的符号：力、质量、位置矢量等。下标起到了次要作用以澄清：什么的位​​置？这正是 Apps Hungarian 正在做的事情；它首先告诉您存储在变量中的内容*类型*，然后再详细说明——关于最接近的代码可以使用数学符号。

显然，强类型可以解决 Joel 文章中的安全与不安全字符串示例，但您不会为位置和速度向量定义单独的类型；两者都是大小为 3 的双数组，您可能对其中一个执行的任何操作都可能适用于另一个。此外，连接位置和速度（形成状态向量）或取它们的点积是非常有意义的，但可能不添加它们。键入如何允许前两个并禁止第二个，以及这样的系统如何扩展到您可能想要保护的每个可能的操作？除非你愿意在你的打字系统中编码所有的数学和物理。

最重要的是，许多工程都是使用弱类型的高级语言（如 Matlab）或 Fortran 77 或 Ada 等旧语言完成的。

因此，如果您有一种花哨的语言，而 IDE 和 Apps Hungarian 对您没有帮助，那就忘记它——很多人显然都有。但对我来说，比使用弱类型或动态类型语言工作的新手程序员更糟糕，我可以使用 Apps Hungarian 比不使用更快地编写更好的代码。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-09-21T20:13:46.137

我一直认为在正确的地方有一两个前缀不会有什么坏处。我想如果我可以在那里传授一些有用的东西，比如“嘿，这是一个界面，不要指望特定的行为”，就像在 IEnumerable 中一样，我应该这样做。注释可以使事情变得混乱，而不仅仅是一两个字符的符号。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2008-09-21T20:14:13.357

大多数现代 IDE 都非常冗余和无用，它们在使类型明显化方面做得很好。

另外——对我来说——看到 intI、strUserName 等很烦人 :)

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-09-21T20:15:14.197

> 如果我觉得有用的信息正在被传递，为什么我不应该把它放在可以得到的地方呢？

那么谁在乎别人怎么想呢？如果您觉得它有用，请使用该符号。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2008-09-21T20:15:44.307

我的经验，这很糟糕，因为：

1 - 如果您需要更改变量的类型（即如果您需要将 32 位整数扩展为 64 位整数），那么您将破坏所有代码；

2 - 这是无用的信息，因为类型已经在声明中，或者您使用的是动态语言，其中实际类型首先不应该那么重要。

此外，对于接受通用编程的语言（即某些变量的类型在您编写函数时无法确定的函数）或动态类型系统（即在编译时甚至无法确定类型时），您将如何命名您的变量？并且大多数现代语言都支持其中一种，即使是一种受限制的形式。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2008-09-21T20:31:31.773

在[Joel Spolsky 的《让错误的代码看起来错误》](http://www.joelonsoftware.com/articles/Wrong.html)中，他解释说，每个人都认为的匈牙利符号（他称之为 Systems Hungarian）并不是它的真正意图（他称之为 Apps Hungarian）。向下滚动到“**我在匈牙利**”标题以查看此讨论。

基本上，Systems Hungarian 一文不值。它只是告诉你编译器和/或 IDE 会告诉你的同样的事情。

Apps Hungarian 会告诉您变量的含义，并且实际上很有用。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2008-09-21T23:14:12.333

如果控件列表显示在您的 IDE 中按字母顺序排列的下拉列表中，则它是用于命名表单上的控件（btnOK、txtLastName 等）的有用约定。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2008-11-28T23:33:15.147

我倾向于仅将 Hungarian Notation 与 ASP.NET 服务器控件一起**使用**，否则我发现很难弄清楚表单上的控件是什么。

拿这个代码片段：

```
<asp:Label ID="lblFirstName" runat="server" Text="First Name" />
<asp:TextBox ID="txtFirstName" runat="server" />
<asp:RequiredFieldValidator ID="rfvFirstName" runat="server" ... /> 
```

如果有人可以展示一种更好的方法来获得没有匈牙利语的那组控制名称，我会很想转向它。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2011-01-26T18:16:06.833

Joel 的文章很棒，但似乎忽略了一个要点：

匈牙利语使特定的“想法”（种类 + 标识符名称）在整个代码库（甚至是非常大的代码库）中唯一或接近唯一。

这对于代码维护来说是巨大的。这意味着您可以使用良好的 ol' 单行文本搜索（grep、findstr、'在所有文件中查找'）来查找每个提及该“想法”的内容。

当我们拥有知道如何阅读代码的 IDE 时，为什么这很重要？因为他们还不是很擅长。这在小型代码库中很难看到，但在大型代码库中很明显 - 当注释、XML 文件、Perl 脚本以及源代码控制之外的地方（文档、wiki、错误数据库）中可能提到“想法”时。

即使在这里，您也必须要小心一些——例如，在 C/C++ 宏中粘贴标记可以隐藏对标识符的提及。这种情况可以使用编码约定来处理，无论如何它们往往只会影响代码库中的少数标识符。

PS 关于使用类型系统与匈牙利语的区别 - 最好同时使用两者。如果编译器无法为您捕获它，您只需要错误的代码看起来就错了。在很多情况下，让编译器捕获它是不可行的。但在可行的情况下 - 是的，请改为这样做！

但是，在考虑可行性时，请考虑拆分类型的负面影响。例如，在 C# 中，用非内置类型包装“int”会产生巨大的后果。所以在某些情况下它是有意义的，但不是在所有情况下。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2012-11-19T20:03:38.660

## 揭穿匈牙利符号的好处

*   **它提供了一种区分变量的方法。**

如果类型只是将一个值与另一个值区分开来，那么它只能用于将一种类型转换为另一种类型。如果您在类型之间转换的值相同，那么您很可能应该在专用于转换的函数中执行此操作。*（我看到匈牙利的 VB6 遗留物在其所有方法参数上都使用字符串，仅仅是因为他们无法弄清楚如何反序列化 JSON 对象，或者正确理解如何声明或使用可为空的类型。*）如果您有两个仅由匈牙利语前缀，它们不是从一个到另一个的转换，那么你需要详细说明你对它们的意图。

*   **它使代码更具可读性。**

我发现匈牙利符号使人们对变量名变得懒惰。他们有一些可以区分它的东西，他们觉得没有必要详细说明它的目的。这是您通常会在匈牙利注释代码与现代代码中找到的内容：sSQL 与 groupSelectSql（*或者通常根本没有 sSQL，因为它们应该使用早期开发人员放入的 ORM。*），sValue 与 formCollectionValue（*或者通常也没有 sValue，因为它们恰好在 MVC 中并且应该使用它的模型绑定功能*）、sType 与 publishSource 等。

它不可能是可读性的。我从任何给定的匈牙利 VB6 剩余物中看到的 sTemp1、sTemp2.​​..sTempN 比其他所有人的总和还要多。

*   **它可以防止错误。**

这将是由于数字 2，这是错误的。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2008-09-21T20:14:52.687

用大师的话来说：

[http://www.joelonsoftware.com/articles/Wrong.html](http://www.joelonsoftware.com/articles/Wrong.html)

像往常一样有趣的阅读。

提取物：

“有人在某处读过 Simonyi 的论文，他在其中使用了“类型”这个词，并认为他的意思是类型，就像类，就像在类型系统中一样，就像编译器所做的类型检查一样。他没有。他解释得很仔细正是他所说的“类型”这个词的意思，但这并没有帮助。损害已经造成。”

“但 Apps Hungarian 仍然具有巨大的价值，因为它增加了代码的搭配，这使得代码更易于阅读、编写、调试和维护，最重要的是，它使错误的代码看起来不正确。”

在阅读 Joel On Software 之前，请确保您有一些时间。:)

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-09-21T20:20:26.790

几个原因：

*   任何现代 IDE 只需将鼠标悬停在变量上即可为您提供变量类型。
*   大多数类型名称都很长（想想*HttpClientRequestProvider*）可以合理地用作前缀。
*   类型信息没有携带*正确*的信息，它只是解释变量声明，而不是概述变量的**用途**（想想*myInteger*与*pageSize*）。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2008-09-21T20:14:33.343

我不认为每个人都强烈反对它。在没有静态类型的语言中，它非常有用。当它用于提供类型中尚未包含的信息时，我绝对更喜欢它。就像在 C 中一样，**char * szName**表示该变量将引用一个以空字符结尾的字符串——这在 char* 中并不隐含——当然，typedef 也会有所帮助。

Joel 有一篇关于使用匈牙利语来判断变量是否是 HTML 编码的精彩文章：

[http://www.joelonsoftware.com/articles/Wrong.html](http://www.joelonsoftware.com/articles/Wrong.html)

无论如何，当它被用来传达我已经知道的信息时，我倾向于不喜欢匈牙利语。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2008-09-24T00:59:56.697

当然，当 99% 的程序员都同意某件事时，就有问题了。他们同意这里的原因是因为他们中的大多数人从未正确使用过匈牙利符号。

有关详细的论点，请参阅我就该主题发表的博客文章。

[http://codingthriller.blogspot.com/2007/11/rediscovering-hungarian-notation.html](http://codingthriller.blogspot.com/2007/11/rediscovering-hungarian-notation.html)

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2008-09-24T01:17:41.647

我几乎是在匈牙利符号被发明的时候开始编码的，我第一次被迫在一个我讨厌它的项目中使用它。

过了一会儿，我意识到如果做得好，它确实有帮助，这些天我喜欢它。

但就像所有美好的事物一样，它必须被学习和理解，并且正确地做到这一点需要时间。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-09-21T20:33:14.310

匈牙利符号被滥用，特别是被微软滥用，导致前缀比变量名长，并且显示它非常死板，特别是当您更改类型时（臭名昭著的 lparam/wparam，在 Win16 中具有不同的类型/大小，在 Win32 中相同）。

因此，由于这种滥用，以及它被 M$ 使用，它都被认为是无用的。

在我的工作中，我们用 Java 编写代码，但创始人来自 MFC 世界，所以使用类似的代码风格（对齐的大括号，我喜欢这个！，大写的方法名，我习惯了，前缀像 m_ 到类成员（字段), s_ 到静态成员等)。

他们说所有变量都应该有一个显示其类型的前缀（例如，BufferedReader 被命名为 brData）。这表明这是一个坏主意，因为类型可以更改但名称不跟随，或者编码人员在使用这些前缀时不一致（我什至看到 aBuffer、theProxy 等！）。

就个人而言，我选择了一些我认为有用的前缀，最重要的是 b 为布尔变量添加前缀，因为它们是我唯一允许使用类似语法的前缀`if (bVar)`（不使用某些值的自动转换为真或假）。当我用 C 编写代码时，我为使用 malloc 分配的变量使用了前缀，以提醒它以后应该被释放。等等。

所以，基本上，我并没有整体拒绝这个符号，而是采用了似乎适合我需要的符号。
当然，在为某个项目（工作、开源）做贡献时，我只是使用约定俗成的！

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-09-21T21:45:27.163

我认为美学方面的整个事情都**被过度炒作了**。如果这是最重要的事情，我们就不会称自己为**开发人员**，而是平面**设计师**。

我认为，一个重要的部分是你描述你的对象角色是什么，而不是它是什么。你不称自己为 HumanDustman，因为在另一种情况下，你不会最重要的是成为人类。

出于重构目的，它也非常重要：

```
public string stringUniqueKey = "ABC-12345"; 
```

如果您决定使用 GUID 而不是字符串，那么在重构所有引用代码后，您的变量名称会显得很愚蠢。

或者：

```
public int intAge = 20; 
```

将其更改为浮点数，您将遇到同样的问题。等等。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-09-21T20:13:30.397

*   他们是一个巨大的眼睛
*   您的 IDE 应该能够告诉您有关变量类型的所有信息
*   好的名称（HN 会妨碍它）应该向您传达您需要了解的有关变量的所有其他信息。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-09-21T20:25:44.890

另请参阅[您对成员变量使用哪种前缀？](https://stackoverflow.com/questions/111605/what-kind-of-prefix-do-you-use-for-member-variables#111625)

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-09-21T21:34:29.140

匈牙利语不好，因为它从变量名中拿走宝贵的字符以换取什么，一些类型信息？

首先，在强类型语言中，如果你做了任何真正愚蠢的事情，编译器会警告你。

其次，如果您相信良好的模块化代码并且不在任何 1 个函数中做太多工作，那么您的变量很可能就在它们使用的代码之上声明（所以您在那里有类型）。

第三，如果你给每个指针加上 p 前缀，每个类都加上 C 前缀，你真的搞砸了你漂亮的现代 IDE 进行智能感知的能力（你知道这个功能在你输入什么类名时它会猜测你的输入，一旦它得到它是的，你可以按回车键，它会为你完成它？好吧，如果你在每个类前面加上 C，你总是至少有 1 个额外的字母要输入）......

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-12-29T01:55:20.300

我找不到链接，但我记得在某处（我同意）读到避免使用匈牙利符号会导致更好的编程风格。

当你编写程序的语句时，在调用它的方法之前你不应该考虑“这个对象是什么类型”，而应该考虑“我想用它做什么”，“发送什么消息给它”。

有点模糊的概念来解释，但我认为它有效。

例如，如果您将客户名称存储在变量 customerName 中，您不应该关心它是字符串还是其他类。更重要的是思考你想从这个对象中得到什么。你想让它打印（），getFirstName（），getLastName（），convertToString（）等吗？一旦你把它变成一个String类的实例并认为它是理所当然的，你限制了你自己和你的设计，因为你必须建立所有您在代码中其他地方需要的其他逻辑。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-12-29T03:23:37.643

多年来，我在编程中使用匈牙利符号。除了一些视觉混乱和更改数据类型时更改前缀的任务之外，没有人能说服我。直到最近——当我不得不在同一个解决方案中结合现有的 C# 和 VB.NET 程序集时。

结果：我必须将“fltSomeVariable”传递给“sngSomeVariable”方法参数。即使作为一个同时使用 C# 和 VB.NET 编程的人，它也让我措手不及，让我停顿了片刻。（C# 和 VB.NET 有时使用不同的名称来表示相同的数据类型——例如，浮点数和单数。）

现在考虑一下：如果您创建一个可从多种语言调用的 COM 组件会怎样？VB.NET 和 C#“转换”对于 .NET 程序员来说很容易。但是使用 C++ 或 Java 开发的人呢？对于不熟悉 C++ 的 .NET 开发人员来说，“dwSomeVariable”是否意味着什么？

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-12-29T03:32:53.503

如果您不知道变量的类型而没有被告知，那么您可能无论如何都不应该弄乱它

类型也可能不是那么重要。如果您知道这些方法的作用，您可以弄清楚变量正在做什么，然后您就会知道程序在做什么

有时您可能想要它；当类型很重要并且声明不在附近或无法轻松推断类型时。但它永远不应该被视为绝对的

# python - 如何在 tkinter 中找出 Canvas 文本对象的大小？

> ID：111934
> 
> 赞同：10
> 
> 时间：2008-09-21T20:08:56.943
> 
> 标签：python, tkinter, tkinter-canvas

我想在画布中创建一些文本：

```
myText = self.canvas.create_text(5, 5, anchor=NW, text="TEST") 
```

现在我如何找到的宽度和高度`myText`？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-21T20:19:34.297

```
bounds = self.canvas.bbox(myText)  # returns a tuple like (x1, y1, x2, y2)
width = bounds[2] - bounds[0]
height = bounds[3] - bounds[1] 
```

请参阅[TkInter 参考](https://anzeljg.github.io/rin2/book2/2405/docs/tkinter/canvas-methods.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-01T20:29:43.550

如果您只对所考虑的画布的宽度和高度感兴趣，则此方法似乎效果很好，使用框的边界，然后检查差异是否也有效，如果您想这样做的话。

```
width = myText.winfo_width()  
height = myText.winfo_height() 
```

# python - 有没有办法在 python 中做 HTTP PUT

> ID：111945
> 
> 赞同：224
> 
> 时间：2008-09-21T20:11:05.753
> 
> 标签：python, http, put

我需要`PUT`在 python 中使用 HTTP 将一些数据上传到服务器。从我对 urllib2 文档的简要阅读来看，它只做 HTTP `POST`。有什么方法可以`PUT`在 python 中做一个 HTTP 吗？

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2011-11-24T15:54:13.543

过去我使用过各种 python HTTP 库，并且我已将[请求](https://requests.readthedocs.io/)确定为我的最爱。现有的库具有非常有用的接口，但代码可能最终会变得太长，无法进行简单的操作。请求中的基本 PUT 如下所示：

```
payload = {'username': 'bob', 'email': 'bob@bob.com'}
>>> r = requests.put("http://somedomain.org/endpoint", data=payload) 
```

然后，您可以使用以下命令检查响应状态代码：

```
r.status_code 
```

或回复：

```
r.content 
```

Requests 有很多语法糖和快捷方式，可以让你的生活更轻松。

* * *

## 回答 #2

> 赞同：246
> 
> 时间：2008-09-21T20:24:21.773

```
import urllib2
opener = urllib2.build_opener(urllib2.HTTPHandler)
request = urllib2.Request('http://example.org', data='your_put_data')
request.add_header('Content-Type', 'your/contenttype')
request.get_method = lambda: 'PUT'
url = opener.open(request) 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2010-10-12T22:13:42.017

Httplib 似乎是一个更干净的选择。

```
import httplib
connection =  httplib.HTTPConnection('1.2.3.4:1234')
body_content = 'BODY CONTENT GOES HERE'
connection.request('PUT', '/url/path/to/put/to', body_content)
result = connection.getresponse()
# Now result.status and result.reason contains interesting stuff 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-09-25T18:08:52.143

您可以使用 requests 库，与采用 urllib2 方法相比，它简化了很多事情。首先从 pip 安装它：

```
pip install requests 
```

更多关于[安装请求](http://docs.python-requests.org/en/latest/user/install/)。

然后设置 put 请求：

```
import requests
import json
url = 'https://api.github.com/some/endpoint'
payload = {'some': 'data'}

# Create your header as required
headers = {"content-type": "application/json", "Authorization": "<auth-key>" }

r = requests.put(url, data=json.dumps(payload), headers=headers) 
```

请参阅[请求库的快速入门](http://docs.python-requests.org/en/latest/user/quickstart/)。我认为这比 urllib2 简单得多，但确实需要安装和导入这个额外的包。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2018-01-08T03:56:05.807

这在 python3 中做得更好，并记录在[stdlib 文档中](https://docs.python.org/3/library/urllib.request.html)

该类在python3中`urllib.request.Request`获得了一个`method=...`参数。

一些示例用法：

```
req = urllib.request.Request('https://example.com/', data=b'DATA!', method='PUT')
urllib.request.urlopen(req) 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-21T20:18:57.997

你应该看看[httplib 模块](http://docs.python.org/lib/module-httplib.html)。它应该允许您发出任何类型的 HTTP 请求。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-22T12:46:40.197

不久前我也需要解决这个问题，以便我可以充当 RESTful API 的客户端。我选择了 httplib2，因为除了 GET 和 POST 之外，它还允许我发送 PUT 和 DELETE。Httplib2 不是标准库的一部分，但您可以从奶酪店轻松获得它。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-22T17:05:30.620

我还推荐Joe Gregario 的[httplib2](http://code.google.com/p/httplib2/)。我经常在标准库中使用它而不是 httplib。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-21T20:12:49.260

你看过[put.py](http://inamidst.com/proj/put/put.py)吗？我过去用过它。你也可以用 urllib 破解你自己的请求。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-21T20:17:08.077

您当然可以使用现有的标准库在任何级别上推出自己的标准库，从套接字到调整 urllib。

[http://pycurl.sourceforge.net/](http://pycurl.sourceforge.net/)

“PyCurl 是 libcurl 的 Python 接口。”

“libcurl 是一个免费且易于使用的客户端 URL 传输库，......支持...... HTTP PUT”

“PycURL 的主要缺点是它在 libcurl 之上是一个相对薄的层，没有任何漂亮的 Pythonic 类层次结构。这意味着它的学习曲线有些陡峭，除非你已经熟悉 libcurl 的 C API。”

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-06-27T13:19:55.787

如果你想留在标准库中，你可以子类化`urllib2.Request`：

```
import urllib2

class RequestWithMethod(urllib2.Request):
    def __init__(self, *args, **kwargs):
        self._method = kwargs.pop('method', None)
        urllib2.Request.__init__(self, *args, **kwargs)

    def get_method(self):
        return self._method if self._method else super(RequestWithMethod, self).get_method()

def put_request(url, data):
    opener = urllib2.build_opener(urllib2.HTTPHandler)
    request = RequestWithMethod(url, method='PUT', data=data)
    return opener.open(request) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-02-26T08:01:36.060

您可以使用`requests.request`

```
import requests

url = "https://www.example/com/some/url/"
payload="{\"param1\": 1, \"param1\": 2}"
headers = {
  'Authorization': '....',
  'Content-Type': 'application/json'
}

response = requests.request("PUT", url, headers=headers, data=payload)

print(response.text) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-12-19T23:17:58.503

一个更合适的方法`requests`是：

```
import requests

payload = {'username': 'bob', 'email': 'bob@bob.com'}

try:
    response = requests.put(url="http://somedomain.org/endpoint", data=payload)
    response.raise_for_status()
except requests.exceptions.RequestException as e:
    print(e)
    raise 
```

如果 HTTP PUT 请求中有错误，则会引发异常。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-08-02T18:49:39.923

## 使用[`urllib3`](https://urllib3.readthedocs.io/en/latest/user-guide.html)

为此，您需要在 URL 中手动编码查询参数。

```
>>> import urllib3
>>> http = urllib3.PoolManager()
>>> from urllib.parse import urlencode
>>> encoded_args = urlencode({"name":"Zion","salary":"1123","age":"23"})
>>> url = 'http://dummy.restapiexample.com/api/v1/update/15410' + encoded_args
>>> r = http.request('PUT', url)
>>> import json
>>> json.loads(r.data.decode('utf-8'))
{'status': 'success', 'data': [], 'message': 'Successfully! Record has been updated.'} 
```

## 使用[`requests`](https://requests.readthedocs.io/en/master/user/quickstart/)

```
>>> import requests
>>> r = requests.put('https://httpbin.org/put', data = {'key':'value'})
>>> r.status_code
200 
```

# python - 使用 Python 的 ftplib 获取目录列表，可移植

> ID：111954
> 
> 赞同：70
> 
> 时间：2008-09-21T20:13:18.477
> 
> 标签：python, ftp, portability

您可以使用 ftplib 在 Python 中获得完整的 FTP 支持。但是，获取目录列表的首选方法是：

```
# File: ftplib-example-1.py

import ftplib

ftp = ftplib.FTP("www.python.org")
ftp.login("anonymous", "ftplib-example-1")

data = []

ftp.dir(data.append)

ftp.quit()

for line in data:
    print "-", line 
```

产生：

```
$ python ftplib-example-1.py
- total 34
- drwxrwxr-x  11 root     4127         512 Sep 14 14:18 .
- drwxrwxr-x  11 root     4127         512 Sep 14 14:18 ..
- drwxrwxr-x   2 root     4127         512 Sep 13 15:18 RCS
- lrwxrwxrwx   1 root     bin           11 Jun 29 14:34 README -> welcome.msg
- drwxr-xr-x   3 root     wheel        512 May 19  1998 bin
- drwxr-sr-x   3 root     1400         512 Jun  9  1997 dev
- drwxrwxr--   2 root     4127         512 Feb  8  1998 dup
- drwxr-xr-x   3 root     wheel        512 May 19  1998 etc
... 
```

我想这个想法是解析结果以获取目录列表。但是，此列表直接取决于 FTP 服务器格式化列表的方式。必须预测 FTP 服务器可能会格式化此列表的所有不同方式，为此编写代码会非常麻烦。

是否有一种可移植的方式来获取一个充满目录列表的数组？

（数组应该只有文件夹名称。）

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2008-09-21T20:15:59.517

尝试使用[`ftp.nlst(dir)`](https://docs.python.org/3/library/ftplib.html#ftplib.FTP.nlst).

但是，请注意，如果文件夹为空，则可能会引发错误：

```
files = []

try:
    files = ftp.nlst()
except ftplib.error_perm as resp:
    if str(resp) == "550 No files found":
        print "No files in this directory"
    else:
        raise

for f in files:
    print f 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2011-12-12T13:10:19.507

解析 FTP 目录列表的可靠/标准化方法是使用 MLSD 命令，目前所有最新/体面的 FTP 服务器都应该支持该命令。

```
import ftplib
f = ftplib.FTP()
f.connect("localhost")
f.login()
ls = []
f.retrlines('MLSD', ls.append)
for entry in ls:
    print entry 
```

上面的代码将打印：

```
modify=20110723201710;perm=el;size=4096;type=dir;unique=807g4e5a5; tests
modify=20111206092323;perm=el;size=4096;type=dir;unique=807g1008e0; .xchat2
modify=20111022125631;perm=el;size=4096;type=dir;unique=807g10001a; .gconfd
modify=20110808185618;perm=el;size=4096;type=dir;unique=807g160f9a; .skychart
... 
```

从 python 3.3 开始，ftplib 将提供一个特定的方法来做到这一点：

*   [http://bugs.python.org/issue11072](http://bugs.python.org/issue11072)
*   [http://hg.python.org/cpython/file/67053b135ed9/Lib/ftplib.py#l535](http://hg.python.org/cpython/file/67053b135ed9/Lib/ftplib.py#l535)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-08-14T22:52:07.497

我在尝试获取文件名、最后修改的戳记、文件大小等时在这里找到了我的方式，并想添加我的代码。只花了几分钟就编写了一个循环来解析`ftp.dir(dir_list.append)`使用 python std lib 的东西，比如`strip()`（清理文本行）并`split()`创建一个数组。

```
ftp = FTP('sick.domain.bro')
ftp.login()
ftp.cwd('path/to/data')

dir_list = []
ftp.dir(dir_list.append)

# main thing is identifing which char marks start of good stuff
# '-rw-r--r--   1 ppsrt    ppsrt      545498 Jul 23 12:07 FILENAME.FOO
#                               ^  (that is line[29])

for line in dir_list:
   print line[29:].strip().split(' ') # got yerself an array there bud!
   # EX ['545498', 'Jul', '23', '12:07', 'FILENAME.FOO'] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-21T20:20:36.417

`LIST`响应的布局没有标准。您必须编写代码来处理最流行的布局。我将从 Linux`ls`和 Windows Server`DIR`格式开始。不过，那里有很多种类。

如果您无法解析更长的列表，请回退到`nlst`方法（返回命令的结果）。`NLST`对于奖励积分，作弊：也许包含已知文件名的行中最长的数字是它的长度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-06T20:50:39.497

我碰巧遇到了似乎不支持 MLSD 的 FTP 服务器（Rackspace Cloud Sites 虚拟服务器）。然而我需要几个文件信息字段，例如大小和时间戳，而不仅仅是文件名，所以我必须使用 DIR 命令。在这个服务器上，DIR 的输出看起来很像 OP 的。如果它对任何人有帮助，这里有一个 Python 小类，它解析一行这样的输出以获取文件名、大小和时间戳。

导入日期时间

```
class FtpDir:
    def parse_dir_line(self, line):
        words = line.split()
        self.filename = words[8]
        self.size = int(words[4])
        t = words[7].split(':')
        ts = words[5] + '-' + words[6] + '-' + datetime.datetime.now().strftime('%Y') + ' ' + t[0] + ':' + t[1]
        self.timestamp = datetime.datetime.strptime(ts, '%b-%d-%Y %H:%M') 
```

我知道不是很便携，但很容易扩展或修改以处理各种不同的 FTP 服务器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-06T08:46:45.843

这是来自 Python 文档

```
>>> from ftplib import FTP_TLS
>>> ftps = FTP_TLS('ftp.python.org')
>>> ftps.login()           # login anonymously before securing control 
channel
>>> ftps.prot_p()          # switch to secure data connection
>>> ftps.retrlines('LIST') # list directory content securely
total 9
drwxr-xr-x   8 root     wheel        1024 Jan  3  1994 .
drwxr-xr-x   8 root     wheel        1024 Jan  3  1994 ..
drwxr-xr-x   2 root     wheel        1024 Jan  3  1994 bin
drwxr-xr-x   2 root     wheel        1024 Jan  3  1994 etc
d-wxrwxr-x   2 ftp      wheel        1024 Sep  5 13:43 incoming
drwxr-xr-x   2 root     wheel        1024 Nov 17  1993 lib
drwxr-xr-x   6 1094     wheel        1024 Sep 13 19:07 pub
drwxr-xr-x   3 root     wheel        1024 Jan  3  1994 usr
-rw-r--r--   1 root     root          312 Aug  1  1994 welcome.msg 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-07T11:03:39.617

这对我的代码有帮助。

当我尝试仅对一种文件进行毡化并通过添加在每一行上进行测试的条件将它们显示在屏幕上时。

像这样

```
elif command == 'ls':
    print("directory of ", ftp.pwd())
    data = []
    ftp.dir(data.append)

    for line in data:
        x = line.split(".")
        formats=["gz", "zip", "rar", "tar", "bz2", "xz"]
        if x[-1] in formats:
            print ("-", line) 
```

# python - python.array 与 numpy.array

> ID：111983
> 
> 赞同：66
> 
> 时间：2008-09-21T20:23:02.027
> 
> 标签：python, numpy

如果您在 Python 中创建一维数组，使用 NumPy 包有什么好处吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-09-21T20:31:39.667

这一切都取决于您打算对阵列做什么。如果您所做的只是创建简单数据类型的数组并进行 I/O，那么[数组](https://docs.python.org/3/library/array.html)模块就可以了。

另一方面，如果您想要进行任何类型的数值计算，则数组模块不会提供任何帮助。[NumPy](https://numpy.scipy.org/)（和[SciPy](https://scipy.org)）为您提供了数组和特殊函数之间的各种操作，这些操作不仅对科学工作有用，而且对高级图像处理或通常需要对大量数据执行高效计算的任何事情都有用。

Numpy 也更加灵活，例如它支持任何类型的 Python 对象的数组，并且如果它们符合[数组接口](https://docs.scipy.org/doc/numpy/reference/arrays.interface.html)，也能够与您自己的对象“本地”交互。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-05-09T09:21:46.723

为任何可能觉得这很有用的人的利益而进行的小型引导（遵循@dF的出色回答。）：

```
import numpy as np
from array import array

# Fixed size numpy array
def np_fixed(n):
    q = np.empty(n)
    for i in range(n):
        q[i] = i
    return q

# Resize with np.resize
def np_class_resize(isize, n):
    q = np.empty(isize)
    for i in range(n):
        if i>=q.shape[0]:
            q = np.resize(q, q.shape[0]*2)        
        q[i] = i
    return q    

# Resize with the numpy.array method
def np_method_resize(isize, n):
    q = np.empty(isize)
    for i in range(n):
        if i>=q.shape[0]:
            q.resize(q.shape[0]*2)
        q[i] = i
    return q

# Array.array append
def arr(n):
    q = array('d')
    for i in range(n):
        q.append(i)
    return q

isize = 1000
n = 10000000 
```

输出给出：

```
%timeit -r 10 a = np_fixed(n)
%timeit -r 10 a = np_class_resize(isize, n)
%timeit -r 10 a = np_method_resize(isize, n)
%timeit -r 10 a = arr(n)

1 loop, best of 10: 868 ms per loop
1 loop, best of 10: 2.03 s per loop
1 loop, best of 10: 2.02 s per loop
1 loop, best of 10: 1.89 s per loop 
```

似乎 array.array 稍微快一些，并且“api”为您节省了一些麻烦，但如果您需要的不仅仅是存储双精度数，那么 numpy.resize 毕竟不是一个糟糕的选择（如果使用正确的话）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-16T20:26:06.890

出于存储目的，numpy array 优于 array.array。这是用于比较 4 字节无符号整数的存储大小的基准代码。其他数据类型也可用于比较。还添加了列表和元组的数据以进行比较。对于小于 10 的数字，可以使用列表和元组。

```
a = [100400, 1004000, 10040, 100400, 100400, 100400, 400, 1006000, 8, 800999]
print("size per element for list, tuple, numpy array, array.array:===============")
for i in range(1, 15):
    aa = a*i#list size multiplier
    n = len(aa)
    list_size = getsizeof(aa)
    d = list_size
    tup_aa = tuple(aa)
    tup_size = getsizeof(tup_aa)
    nparr = np.array(aa, dtype='uint32')
    np_size = getsizeof(nparr)
    arr = array('L', aa)#4 byte unsigned integer
    arr_size = getsizeof(arr)
    print('number of element:%s, list %.2f, tuple %.2f, np.array %.2f, arr.array %.2f' % \
          (len(aa), list_size/n, tup_size/n, np_size/n, arr_size/n)) 
```

这在我的机器中产生了以下输出：

```
size per element for list, tuple, numpy array, array.array:===============
number of element:10, list 14.40, tuple 12.80, np.array 13.60, arr.array 14.40
number of element:20, list 11.20, tuple 10.40, np.array 8.80, arr.array 11.20
number of element:30, list 10.13, tuple 9.60, np.array 7.20, arr.array 10.13
number of element:40, list 9.60, tuple 9.20, np.array 6.40, arr.array 9.60
number of element:50, list 9.28, tuple 8.96, np.array 5.92, arr.array 9.28
number of element:60, list 9.07, tuple 8.80, np.array 5.60, arr.array 9.07
number of element:70, list 8.91, tuple 8.69, np.array 5.37, arr.array 8.91
number of element:80, list 8.80, tuple 8.60, np.array 5.20, arr.array 8.80
number of element:90, list 8.71, tuple 8.53, np.array 5.07, arr.array 8.71
number of element:100, list 8.64, tuple 8.48, np.array 4.96, arr.array 8.64
number of element:110, list 8.58, tuple 8.44, np.array 4.87, arr.array 8.58
number of element:120, list 8.53, tuple 8.40, np.array 4.80, arr.array 8.53
number of element:130, list 8.49, tuple 8.37, np.array 4.74, arr.array 8.49
number of element:140, list 8.46, tuple 8.34, np.array 4.69, arr.array 8.46 
```

# database - 基于 Web 的应用程序的缺点是什么

> ID：111985
> 
> 赞同：4
> 
> 时间：2008-09-21T20:23:42.010
> 
> 标签：database, web-applications, browser

我将为我工作的营地编写一个数据库应用程序。我正在考虑用 Windows GUI 界面用 C# 编写它，但是由于各种原因，由于应用程序似乎越来越受欢迎，所以使用浏览器。我想知道为什么有人不会选择将应用程序编写为 Web 应用程序。前任。后退按钮会给您带来一些麻烦。还有其他人可以想到的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-21T20:40:36.727

有很多缺点：

*   速度和响应能力往往明显变差
*   复杂的 UI 小部件（例如树形控件）更难实现
*   渲染任何类型的图形都非常棘手，3D 图形更难
*   你必须搞乱登录
*   集中式服务器意味着客户端始终需要网络访问
*   安全限制可能会给您带来麻烦
*   浏览器不兼容可能会导致大量额外工作
*   UI 约定在 Web 上的定义不太明确 - 用户可能会发现它更难使用
*   客户端存储受限

问题是.. 是否有足够的内容适用于您的项目以使 web 成为错误的选择？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-14T13:54:56.387

这里没有提到的一件事是生成一个好的 Web 应用程序所需的复杂性和知识水平。问题是除非你做一些非常简单的事情，否则这些应用程序中没有“单一”的知识或技术。例如，如果您要为某个客户端服务器平台编写应用程序。您可以使用 Java 或 C++ 进行开发。对于复杂的 Web 应用程序，您可能必须具备 Java、Java Script、HTML、Flash、CSS、Ajax、SQL、J2EE 等方面的专业知识。此外，基于 Web 的应用程序的组件也更多，Web 应用程序服务器、HTTP服务器、数据库、浏览器......是典型的组件，但可能还有更多......客户端服务器应用程序就是它所说的典型......客户端应用程序和服务器应用程序。我的经验和个人偏好不是基于网络的.. 基于网络的许多事情都很棒。但是，即使我是一家领先公司的 IT 架构师，该公司完全沉浸在 Web 应用程序中作为一切的解决方案......缺点仍然很多......我做的事情是技术会发展，但缺点会随着时间的推移而消失.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T20:29:44.193

本质上，真正的限制只是通过平台，即浏览器。如果您必须考虑当前使用的所有浏览器，由于每个浏览器的标准程度不同，这可能会很痛苦。

如果可以控制要使用的浏览器，即每个人都在您在现场控制的计算机上，并说您在所有这些计算机上都安装了 Firefox，那么您可以在内容交付中充分利用最新的 Javascript 和 CSS 标准。

[编辑] 您还可以查看诸如 adobe 集成运行时或“AIR”之类的选项，允许您使用基于传统浏览器的选项（如 xhtml/css/javascript、flash/flex）对前端进行编码并连接后端在线到您的数据库，同时还提供传统桌面应用程序的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-21T23:08:08.230

我看到的 Web 应用程序最大的区别和缺点是状态管理。由于网络本质上是无状态的，因此您想要维护的每件事都必须随着每个请求和响应从服务器来回发送。有时很难在页面大小和性能方面有效地存储和检索它。此外，浏览器没有真正的标准（至少不是每个人都遵守）这一事实使得一致性真的............很有趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-21T20:25:47.620

您需要对将要运行 Web 应用程序的服务器进行网络访问（如果应用程序将有多个用户 - 通常是这种情况）。

实际上，利大于弊 - 如果您可以提供有关您的应用程序的一些详细信息，我们可以提供更多帮助...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T20:31:08.903

这完全取决于您的项目的要求。在大多数情况下，这些天没有太多的 Web 应用程序不能做。诚然，某些应用程序确实属于桌面浏览器（虽然目前正在快速发展），但还没有完全实现。从[Google Docs](http://docs.google.com/)、[Gmail等应用程序的出现](http://www.gmail.com)

在网络上没有什么是你不能做的。但是，如果您正在创建魔兽世界的竞争对手，那么网络肯定不是最佳解决方案。同样，不幸的是，我们需要更多地了解您为营地构建的应用程序。网络最好的部分是任何拥有浏览器的人都可以使用您的应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-21T20:32:25.640

Web 应用程序将处理委托给远程机器。根据处理量，这可能是一个骗局。考虑一个照片编辑器，它是一个网络应用程序。

Web 应用程序也无法处理大量往返于客户端的数据。您可以在线观看视频......当它被压缩时。我们还需要一段时间才能看到任何基于 Web 的视频编辑软件。

浏览器兼容性也很麻烦。您无法 100% 控制应用程序的外观。

Vaibhav 有一个很好的观点。你的应用是什么？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-21T20:37:53.053

一个主要的问题是迁移的停机时间……用户永远不会期望应用程序停机，但实际上它必须停机才能进行重大升级。使用桌面应用程序执行此操作时，用户（或最终用户系统管理员）可以控制升级发生的时间；使用在线应用程序，他们不是。

对于具有大数据的应用程序，性能可能是一个主要问题，因为您要集中存储大量用户数据，这意味着 IO 性能不会像您给他们一台笔记本电脑那样好。

一般来说，可扩展性会给基于服务器的应用程序带来问题。桌面应用程序的扩展性非常好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-21T20:39:24.687

您可以使用基于 Web 的应用程序做很多事情，但使用胖客户端做某些事情要容易得多：

*   性能：您可以轻松访问客户端 CPU 的全部功能。
*   响应性：交互性快速而简单。
*   图形：您可以轻松使用 DirectX 和 OpenGL 等图形库快速创建令人印象深刻的图形。
*   使用本地文件
*   点对点

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-21T22:25:39.547

决定一个 Web 应用程序是否是一个好的方法取决于你想要实现的目标。然而，这里有一些更普遍的 Web 应用程序的缺点：

*   与桌面应用程序（例如 Outlook）的真正集成是不可能的
*   在您的应用程序和桌面/其他正在运行的应用程序之间拖放

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-21T22:36:08.807

对于 Web 应用程序，当您在服务器上存储用户数据时，存在更多的隐私问题。您必须确保不会丢失/泄露它，并且您的用户必须对将这些数据存储在您的服务器上的想法感到满意。

除此之外，还有许多安全问题，如中间人攻击、[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)或 SQL 注入。

您还需要确保手头有足够的计算能力和带宽。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-22T02:03:07.247

“例如，后退按钮会给你带来一些麻烦。”

您必须具体说明这一点。许多人在他们的 Web 应用程序中犯了根本性的错误，并在他们处理事务的方式中引入了错误。如果您不使用“发布后重定向”（也称为[Post-Redirect-Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)，PRG 设计），那么您创建了一个错误，该错误显示为后退按钮的问题。

一个笼统的说法，即有问题的后退按钮不太可能是真的。一个具体的例子可以澄清你对此的具体问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-22T02:25:49.300

如果您正确设计应用程序，后退按钮真的不是什么大问题。您可以使用 AJAX 来操作当前页面的某些部分，而无需将项目添加到浏览器历史记录中（因为页面本身不会更改）。

设计 Web 应用程序的最大问题与状态以及需要围绕其编程的挑战有关。使用桌面应用程序，状态很容易处理，您可以打开数据库连接，锁定记录并等待用户进行更改并提交。使用 Web 应用程序，您可以锁定记录……但是如果用户关闭浏览器怎么办？在您的应用程序设计中必须克服这些问题。

在设计 Web 应用程序时，请确保每次访问服务器都“独立”并提供完整的答案。在执行任何工作之前始终重新初始化您的变量，并且永远不要假设任何事情。我曾经遇到的挑战之一是将网格数据的“页面”拉回给用户。在一个真正繁忙的系统中，记录的添加/修改是实时发生的，用户在页面之间的导航会有很大的不同，有时甚至会导致在查询前添加新的记录时查看相同的几条记录.

# c# - C# 类分离成一个头文件和一个 .cs 文件

> ID：111995
> 
> 赞同：4
> 
> 时间：2008-09-21T20:26:23.517
> 
> 标签：c#, class

有没有办法将 C# 类分成包含类定义的标头和包含实现的实际 .cs 文件？我想可以通过创建一个界面来做到这一点，但这似乎不对。我只想要一个文件，我可以在其中看到类设计，而不是所有细节。在 C++ 中很容易做到，但我还没有看到用 C# 完成。

提前致谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-21T20:30:08.467

这是错误的做法。C# 不是 C++。**忘记头文件**。

如果您想要类摘要，只需在 Visual Studio 中打开**对象浏览器。**它将为您提供类中所有方法的签名。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-21T20:29:41.700

您可以使用部分类和部分方法。我不确定你为什么要这样做...

[部分类和方法 - MSDN](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-21T20:29:00.343

在同一个文件中，您可以使用 Visual Studio 大纲功能来折叠类，以便您只看到方法和属性的名称。

您还可以使用 Visual Studio 查看类视图，它为您提供类的各种方法和属性的名称。

在 dotnet 中几乎没有理由需要在与其实现不同的地方定义一个类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-21T20:28:25.413

不，没有办法（或真正的理由）想要在 C# 中执行此操作。您可以让 VS.NET 为您总结一个类（在视图菜单中全部折叠），或者如果您真的想按照您所说的那样使用接口。你问背后的原因是什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T21:25:45.543

You can use an `interface` to achieve the same intention.

IFoo.cs:

```
public interface IFoo
{
  int DoFoo();
} 
```

Foo.cs:

```
public class Foo : IFoo
{
  public int DoFoo()
  {
    return 1;
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-21T20:30:17.703

我不认为你可以像在 C++ 中那样做头文件。查看类和方法的 partial 关键字。我昨天才了解它们，所以我还没有真正使用它们，但它们可能会帮助你完成你想做的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T04:16:46.990

如果您对私有方法感兴趣，那么提取接口并不是一个好计划。使用抽象类意味着实质性地改变应用程序的设计（我认为，不必要地增加复杂性）以支持“视图”要求。部分类不会在一个地方向您显示完整的公共和私人签名，因此这也不理想。

因此，如果您没有 IDE，或者不想使用它，我会使用 Reflector 中的默认反汇编操作（免费，而且无论如何都是一个很棒的玩具）：

[http://www.red-gate.com/products/reflector/index.htm](http://www.red-gate.com/products/reflector/index.htm)

例如。System.Web.Caching.Cache

```
public sealed class Cache : IEnumerable
{
    // Fields
    private CacheInternal _cacheInternal;
    public static readonly DateTime NoAbsoluteExpiration;
    public static readonly TimeSpan NoSlidingExpiration;

    // Methods
    static Cache();
    [SecurityPermission(SecurityAction.Demand, Unrestricted=true)]
    public Cache();
    internal Cache(int dummy);
    public object Add(string key, object value, CacheDependency dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, CacheItemPriority priority, CacheItemRemovedCallback onRemoveCallback);
    public object Get(string key);
    internal object Get(string key, CacheGetOptions getOptions);
    public IDictionaryEnumerator GetEnumerator();
    public void Insert(string key, object value);
    public void Insert(string key, object value, CacheDependency dependencies);
    public void Insert(string key, object value, CacheDependency dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration);
    public void Insert(string key, object value, CacheDependency dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, CacheItemPriority priority, CacheItemRemovedCallback onRemoveCallback);
    public object Remove(string key);
    internal void SetCacheInternal(CacheInternal cacheInternal);
    IEnumerator IEnumerable.GetEnumerator();

    // Properties
    public int Count { get; }
    public long EffectivePercentagePhysicalMemoryLimit { get; }
    public long EffectivePrivateBytesLimit { get; }
    public object this[string key] { get; set; }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T08:14:10.617

这只是 C++ 的一个特性，因为古代编译器需要函数签名的前向声明才能正常工作。

如果这是您觉得很方便的东西，并且您想要不止一次，您可以尝试编写一个小实用程序，使用反射从任何组件中提取公共接口，并将其格式化为您使用的任何布局的文本文件通缉。

另一种选择是使用 /// 语法为类创建 XML 文档。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T02:42:44.407

如果你真的真的需要这样做，那么最接近的选项是 Refactor --> Extract interface。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T02:47:31.867

对于所有说“使用 IDE 〜！〜”的人，您没有抓住重点。代码并不总是在 IDE 中读取。也许他想把它打印出来？还是发邮件？这就是不实现语言功能的问题，因为您可以让 IDE 来做：代码并不总是在 IDE 中读取（甚至写入）。

也就是说，您可以使用部分类和方法来做到这一点；但是，我认为您不能在两个文件中都有实例变量。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-21T20:27:20.957

这不是IDE的用途吗？

编辑：否则推断和抽象类是要走的路。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-21T20:28:59.720

尝试类视图。当您单击每个班级时，您将获得列出的成员。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-21T20:29:48.517

当您有一个实例后跟“。”时，IDE 将准确地向您显示该内联。喜欢

myBadlyNamedObject。

（或“ClassName.”），美妙之处在于您在处理对象时触手可及，而不是在您决定打开对象定义以查看它可能是什么时

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-21T20:31:09.307

据我所知，这是不可能的。但是，您可以通过使用部分类来使事情变得更好，将类的不同部分放在不同的文件中。例如，您可以将所有公共方法放在一个文件中，将所有私有方法放在一个文件中，以便更轻松地了解哪些方法可用于其他对象。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-03T17:07:32.763

WinCV 是一个 .net 1.0 框架 sdk 实用程序，它为您提供了一个类似 c++ 的 .net 程序集的标题视图。在 google 上搜索 wincv.exe，了解如何为 .net 2.0 配置它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-07-31T11:19:10.017

你总是可以使用部分类*********************************************