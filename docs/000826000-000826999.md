# StackOverflow 问答 000826000-000826999

# objective-c - 如何在 Cocoa/Objective C 中将 OpenGL 表面保存/导出到 Quicktime？

> ID：826000
> 
> 赞同：0
> 
> 时间：2009-05-05T17:21:42.837
> 
> 标签：objective-c, cocoa, opengl

我已经修改了 xcode 中的石英作曲家幻灯片示例，以使用自定义过渡呈现高速幻灯片。

该示例使用 OpenGL (Cocoa) 来呈现幻灯片。我想将此幻灯片导出为视频。

有没有办法使用 Cocoa/OpenGL 将此场景输出到快速视频中？

或者，我是否应该在 Quartz 作曲家中重新实现 SlideShow 示例并使用它导出到 Quicktime 功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-22T12:21:38.913

检查 /Developer/Examples/Quartz Composer/Applications/QCTV 中的示例代码，以获得完全符合您要求的代码。

我相信在以前版本的 osx 中，示例代码被称为 Quartz Composer TV

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:18:37.733

我不相信 Cocoa 支持直接渲染到 QuickTime 视频，而且我知道 OpenGL 本身不支持这一事实。

根据我的发现，Apple 建议您使用 Quartz Composer 进行渲染。这是一个故障[的链接。](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaDrawingGuide/QuartzOpenGL/QuartzOpenGL.html#//apple_ref/doc/uid/TP40003290-CH211-SW11)

# ruby-on-rails - 在 1.x 和 2.x 之间对 Rails 的更改中，哪些更改实际上影响了您在 Rails 中的工作？

> ID：826002
> 
> 赞同：2
> 
> 时间：2009-05-05T17:21:55.143
> 
> 标签：ruby-on-rails

我正在上一门侧重于 1.1.6 版的 Rails 课程，因此我试图弄清楚 1.x 和 2.x 之间的众多变化中哪一个对于实际使用来说是最需要注意的。目前，我不需要知道所有的细微变化——只要知道大的变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T19:25:22.790

没有什么是没有批判就不能生存的，但是有一堆没有它就不想生存的东西。

奥托姆：

*   内置的 RESTful。
*   命名范围
*   改进的查找器
*   不再有`t.column`迁移（t.[typename] 太干燥了）
*   测试语法的小改进`ActiveSupport::TestCase`
*   更好的缓存方式

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T17:38:16.557

这是[我记得当时最好的总结](http://ryandaigle.com/articles/2007/12/7/rails-2-0-final-released-summary-of-features)。

如果您愿意花一些微不足道的现金，那篇[文章中链接的 pdf 书](http://peepcode.com/products/rails-2-pdf)也很棒。我最终购买了它以获得更好的格式。（虽然不要指望很好的排版）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T17:27:31.510

好吧，他们中的大多数都有，但是从 1.x 到 2.x 代码库最重要的可能是 REST 的重点和功能

另外，我不相信曾经有 1.6 版本。我相信它们只是 1.2.x 版本

# openid - OpenID 委托如何在依赖方上工作？规格最近有变化吗？

> ID：826014
> 
> 赞同：4
> 
> 时间：2009-05-05T17:24:24.873
> 
> 标签：openid, specifications

考虑这种情况。我有自己的网站，用作我的标识符，但我使用第三方 OpenID 提供程序（在我的情况下为 yahoo），如此[处](http://wiki2008.openid.net/Delegation)所述，登录依赖方 (RP) 网站，例如 stackoverflow 和 sourceforge。

这似乎是一个明智的举动：

*   我没有被 OpenID 提供商锁定，因为如果/当 yahoo 不再提供该服务，或者开始收费，或者我不再信任他们，我可以轻松切换提供商
*   我没有在我的服务器上安装和维护 OpenID 提供程序的经济、管理和安全负担

**问题**

RP应该如何工作？我的理解是它应该使用**我** 提供的标识符，并且仅将提供者（雅虎）用于身份验证（而不是用于识别）。那是对的吗？最近有什么变化吗？为了清楚起见，我的意思是我的身份应该是

[http://www.mysite.com/myPreferredUrl](http://www.mysite.com/myPreferredUrl)

并不是

[https://me.yahoo.com/myYahooId](https://me.yahoo.com/myYahooId)（这是我的网站“重定向”身份验证的地方，如上述网站中所述）

*边注*

我问这个问题也是因为现在事情似乎坏了（几个月前还好）。如果我尝试登录 stackoverflow，我会写 mysite.com URL，我会正确地“重定向”到我登录的雅虎网站，它会询问我是否要“继续使用 stackoverflow”，我说是的，它“重定向”并且在 stackoverflow 网站上我看到“这是我们以前从未见过的 OpenID”，它显示了我的雅虎 ID，我实际上被锁定了！

这是一个错误，还是我错过了什么？

PS：如果你想知道我是如何写这个问题的，这是因为在我使用的许多机器中的一台上，浏览器仍然有一个有效的 cookie....

编辑：Andrew Arnott 在下面的回答提出了一种解决我的问题的方法（即切换到不同的提供商）。但我仍然对一些细节感兴趣：从 OpenID 1.1 到 2.0，关于委托有什么变化？为什么在规范中选择让提供者“破坏”委托？你解释得越多，你的答案被接受的机会就越大。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T21:40:26.427

我不认为雅虎支持 OpenID 委托。也就是说，StackOverflow 和其他 RP 可能会对您自己的标识符执行发现并正确设置委托身份验证请求，但 Yahoo 可能会选择（可能与规范相反）为他们自己的标识符发送身份断言，而不是由RP。

规格没有从 OpenID 1.1 更改为 2.0。规范不建议或认可 Yahoo! 的行为，只有 Yahoo 可以对其推理进行权威评论。

StackOverflow 委托仍然有效。雅虎似乎毁了你。我建议您通过更改您将身份验证委托给谁来利用委托给您购买的东西。例如 www.myopenid.com 支持委托。如果您将自己的标识符更改为指向该标识符，您应该能够再次以旧身份回到 StackOverflow。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T19:33:51.260

我相信安德鲁的回答是相当准确的。我唯一能补充的是关于 v2.0 规范是如何以它的方式结束的，允许提供者选择不使用委托。我认为其中一个动机是服务器导向的身份选择，其中用户只需提供“yahoo.com”（或单击 Yahoo 按钮），然后他们选择的 ID 在 id_res 响应中从服务器返回。这也允许服务器做一些事情，比如选择发送哪个 ID（如 Yahoo 所做的）或向每个 RP 发送一个唯一标识符（如 Google 所做的）。

这也意味着所有必要的信息都在`id_res`响应中，这意味着 RP 不需要存储其`checkid`请求的状态来处理响应。事实上，提供者可以`id_res`直接向 RP 发送响应，而 RP 根本不需要用`checkid`请求来启动它。

v1.x 提供者完全不知道委托何时发生。这种设计甚至阻止了提供者选择不支持委托，但也造成了一些 UI 问题；当您实际使用委派的“joesmith.org”ID 时，它会询问您是否想提供“joe.coolprovider.com”ID。

So, there's the tradeoff. Delegation is still possible, so the hope was that users who really want delegation (which, let's face it, is going to be dwarfed by the number of users from these big sites) can choose providers that offer the features they need. (In other words, let the market fight it out.)

# ruby-on-rails - 在 Windows 上为网站使用 rails 或 ASP.NET

> ID：826015
> 
> 赞同：1
> 
> 时间：2009-05-05T17:24:26.027
> 
> 标签：ruby-on-rails, asp.net-mvc

我需要创建一个与某些 Windows 应用程序交互的站点。目前这是通过直接调用完成的，所以我希望这些在网络服务器上运行。这意味着该站点必须在基于 Windows 的系统上运行。

我最近一直在做一些 ruby​​，并且非常热衷于在网站上使用 rails，但同时也看到了很多关于此的令人沮丧的帖子。

我应该将 ASP.NET (MVC) 用于 Windows 系统还是足够稳定来处理这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T17:32:56.850

Windows 上的 Ruby on Rails 并不*理想*，但它确实有效，并且适用于大多数用途。您可能遇到的最大问题是在 Windows 上运行 RoR 的社区非常小，因此您遇到的特定于 RoR+Windows 的问题可能更难获得帮助。

如果利用现有社区对您和/或您的项目非常重要，那么我建议您使用 ASP.NET MVC。那里的社区比 RoR+Windows 更大更容易连接，后者相当小众。尽管很难客观地评价拥有支持社区的额外好处，但这显然是任何平台的最大卖点之一——例如，一般来说，RoR 社区是其持续成功的重要组成部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T17:48:56.670

我会在 Rex 的回答中补充说 RoR+Windows 适合开发，但我不会将其用作生产设置。就我而言，我在 Flash/Flex/Photoshop 中做了很多工作，同时在后端工作，当然在 Linux 上运行那些图形繁重的应用程序并不是很理想，但我部署到的服务器是 Linux，它是唯一真正重要的部分。

# javascript - 当我们使 div 可见时，隐藏 div 内的 TinyMCE 未显示为启用

> ID：826020
> 
> 赞同：5
> 
> 时间：2009-05-05T17:25:02.843
> 
> 标签：javascript, tinymce

我遇到了 tinyMCE（所见即所得编辑器）的问题。我实际上是在 HTML 元素（如 DIV）中添加 textarea，该元素当前具有样式属性“display:none”。

当我将 DIV 显示样式更改为可见时，tinyMCE 编辑器显示为禁用。

重要提示：导致问题的设置是“auto_resize”选项。这是我打开/关闭使 tinyMCE 编辑器进入编辑或只读模式的唯一选项。

这是我的代码：

```
tinyMCE.init({
    mode: "specific_textareas",
                editor_selector: /(RichTextArea)/, 
                theme: "advanced",
                auto_reset_designmode: true,
                auto_resize:true,
                theme_advanced_buttons1: "bold,italic,underline,strikethrough,|,fontselect,fontsizeselect,|,forecolor,backcolor,|,bullist,numlist,|,justifyleft,justifycenter,justifyright,justifyfull",
                theme_advanced_buttons2: "",
                theme_advanced_buttons3: "",
                theme_advanced_buttons4: "",
                theme_advanced_more_colors: 0,
                theme_advanced_toolbar_location: "external",
                theme_advanced_toolbar_align: "left"
}); 
```

...

```
<a href="#" onclick='document.getElementById("myHiddenDiv").style.display = "block"; return false;'>Show WYSIWYG</a><br/>
<div id="myHiddenDiv" style="display:none">
    <!-- Gets replaced with TinyMCE, remember HTML in a textarea should be encoded -->
    <textarea class="RichTextArea" id="elm1" name="elm1" rows="15" cols="80" style="width: 80%">
        &lt;p&gt;This is the first paragraph.&lt;/p&gt;
        &lt;p&gt;This is the second paragraph.&lt;/p&gt;
        &lt;p&gt;This is the third paragraph.&lt;/p&gt;
    </textarea>
</div> 
```

我想知道是否有人知道如何解决该问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T17:56:47.557

取消隐藏包含的 div 后尝试调用 tinyMCE.init(...)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T20:15:54.160

这个问题很老了，但我也有这个问题。我修复了内联样式。

```
<textarea class="tinymce" style="width: 300px; height: 400px"></textarea> 
```

为了更容易，我在 init() 之前构建了这个简单的脚本来为我做 ir

```
$('textarea.tinymce').each(function(){
    $(this).css({
        width: $(this).width(),
        height: $(this).height()
    });
}) 
```

# asp.net - updatepanel 中的文本框出现问题 - 不会导致 OnTextChanged 事件

> ID：826023
> 
> 赞同：12
> 
> 时间：2009-05-05T17:26:16.507
> 
> 标签：asp.net, ajax, updatepanel

我有以下情况：我在 ajax 更新面板中有一个文本框。无论用户在文本框中输入什么内容，我都必须显示一条消息（不同的消息取决于用户输入的数据）。

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Always">
        <ContentTemplate>
            <asp:TextBox ID="txtMyTexbox" runat="server" Width="500px" OnTextChanged="txtMyTexbox_TextChanged" AutoPostBack="true"></asp:TextBox>
            <br />
            <asp:Label ID="lblMessage" runat="server" CssClass="errorMessage" Visible="false">Hello World</asp:Label>
         </ContentTemplate>
            <Triggers>
             <asp:AsyncPostBackTrigger ControlID="txtMyTexbox" />
            </Triggers>
      </asp:UpdatePanel> 
```

在服务器端，我在页面加载时写了以下内容

```
ScriptManager.GetCurrent(this).RegisterAsyncPostBackControl(txtMyTexbox); 
```

和这样的方法

```
protected void txtMyTexbox_TextChanged(object sender, EventArgs e)
    {           
            if (.....)
            {
                lblMessage.Visible = false;
            }
            else
            {
                lblMessage.Visible = true;
            }            
    } 
```

我现在的问题是：当用户在文本框中键入时，它不会导致 OnTextChanged 事件。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-22T12:09:37.243

我不确定您的问题与`UpdatePanel`.

事实上，该事件*在键入时*`TextChanged`不会触发。它只会在文本框失去焦点*后触发。*如果设置为，或者在下一次回发发生时，这会直接发生。请参阅[AutoPostBack 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.autopostback.aspx)和[TextChanged 事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.textchanged.aspx)的文档。**`AutoPostBack``True`**

 **Afaik，您最好的选择可能是在 javascript 中处理 keyup 事件。

这是一个简单的 jQuery 示例：

```
$(document).ready(function() {
    $(':text[id$=YourTextBox]').keyup(function() {
        if ($(this).val() === "your special value") {
            $('span[id$=YourLabel]').css('visibility', 'visible');
        }
        else {
            $('span[id$=YourLabel]').css('visibility', 'hidden');
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T17:42:01.447

将`EventName`txtMyTexbox 的属性设置`AsyncPostBackTrigger`为 TextChanged

```
<Triggers>             
    <asp:AsyncPostBackTrigger ControlID="txtMyTexbox" EventName="TextChanged" />            
</Triggers> 
```

其他建议：

您是否尝试过查看作为 AjaxControlToolKit 一部分的[AutoComplete控件？](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)它的行为方式与您希望解决方案的行为方式相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-26T13:02:48.213

知道即使在添加更新面板/ AsyncPostBackTrigger 之后，TextBox ChangeEvent 也无法正常工作。有时有效，有时无效..由于它是异步调用，我们需要一段时间刷新，或者等待或不可预测，希望微软能拿出一个能胜任的..下面是检查用户名的简单方法不错

------ 在 Page_Load - aspx.cs 下------------

this.TextBox1.Attributes.Add("onKeyUp", "fnUNameSubmit(this);");

--------在 aspx -add 脚本中 -------------------------- -

```
<script language="javascript" type="text/javascript">

function fnUNameSubmit(urInput) {   
var inpt= urInput.value;
if (inpt.length > 21) { 
document.getElementById('<%= TextBox1.ClientID %>').style.backgroundColor = "green";
document.form1.submit();  // This is only trick we use here..
}
else {
document.getElementById('<%= TextBox1.ClientID %>').style.backgroundColor = "red";
}
  }
</script> 
```

--------在 aspx -add 脚本中 -------------------------- - ----------------aspx.cs -------------------------------- if (TextBox1.Text.Length > 21) { CheckUsrName(); 标签2.Text = ""; } else { Label2.Text = "长度小于 21"; //让我们做一些事情..bla..bla } ------------------------- ------------ 检查用户名（）

公共无效 CheckUsrName() {

```
 Call dB values

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T17:30:20.663

您不应该为您的 TextBox 使用 RegisterAsyncPostBackControl。该方法实际上仅用于位于 UpdatePanels 之外的控件。我会尝试删除那行代码，看看会发生什么。

有关更多信息，请参见：http: [//msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerasyncpostbackcontrol.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerasyncpostbackcontrol.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-12T08:52:31.457

在 AsyncPostBackTrigger 中使用的控件必须在更新面板之外（导致触发异步调用），如下所示：

```
<tr>
    <td colspan="4"><asp:Label ID="lblEnter_Successfully"  Text="Enter Record SuccessFully" runat="server" Visible ="false" ForeColor ="Blue" Font-Size ="Larger" Font-Bold ="true"></asp:Label>
    </td>
</tr>                                           
</table>                
</ContentTemplate>

  <Triggers>
     <asp:AsyncPostBackTrigger ControlID = "Button_Save" EventName ="Click"/>
  </Triggers>                       

</asp:UpdatePanel>
            <table>
              <tr>
                <td width = "472px" align ="right">             
                    <asp:Button ID="Button_Save" runat="server" Text="Save"  OnClientClick ="return URLValidation();"/>
                    <asp:Button ID="Button_Clear" runat="server" Text="Clear"/>
                </td>
              </tr>
            </table> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-13T16:20:17.943

解决方法检查文本框 - 导致验证属性并将其设置为 true

# java - 是否有可以像 iPaper 那样内置到网页中的 XPS 查看器？

> ID：826028
> 
> 赞同：-1
> 
> 时间：2009-05-05T17:27:08.673
> 
> 标签：java, xps, xpsdocument, xpsviewer

有谁知道可以内置到网页中的 XPS 查看器，该查看器可以访问托管在我们服务器上的 XPS 文件，就像 iPaper 访问 pdf 一样？（事实证明，将这些 XPS 文件自动转换为 PDF 非常困难。）

非常感谢，杰克

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-05T17:32:08.863

有些应用程序确实使用了我认为是 XPSViewer IE 插件的东西，例如 AutoDesk 的 Design Review。也许，您可以尝试一下/直接与 MS 交谈。他们会非常乐意提供帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-06T06:49:20.710

如果您正在寻找一种简单、自动化的方式将 XPS 转换为 PDF，请查看我们的 NiXPS 转换器 SDK：[http ://nixps.com/library.html](http://nixps.com/library.html)

它不需要在服务器上安装打印机驱动程序，它是一个纯 DLL 解决方案。我们也有一个 .NET api。

# asp.net - Webresource.axd？- 500内部服务器错误

> ID：826031
> 
> 赞同：3
> 
> 时间：2009-05-05T17:27:53.990
> 
> 标签：asp.net, vb.net, visual-studio-2008, webresource.axd, obout

我正在尝试使用 obout 控件库中的文件上传控件，我真的很喜欢它，并且认为它非常流畅，没有任何闪存！..

我下载了整个安装程序，使用示例中的设置进行操作，并使控件完全按照我的意愿运行。

我在 vs2008 中创建了一个全新的 Web 应用程序，包括 web.config、dll 和带有样式代码的文件夹，以及我为提供所需输出而调整的 aspx 页面。

我构建了新项目并运行它，加载了控件，并且工作正常。

* * *

现在我想在我一直在处理的现有项目中使用它，所以我复制了 web.config 值、dll 以及带有样式代码的文件夹和我调整的 aspx 页面。

我将它们放在与另一个项目相同的位置，构建它并运行页面.. 加载所有内容但是当我单击一个按钮时，我得到一个 webresource.axd 错误，实际上是 2，最后都加密了。

在做了一些研究之后，看起来 webresource.axd 可以用来动态加载 javasript 和 css 文件等......所以我现在的猜测是控件使用它作为隐藏的方式来包含它需要的 javascript 文件......并且它在这些方面的失败包括......这让我感到困惑。

我已经从我的项目中删除了所有内容，但它仍然失败，我发现一篇文章说它可能是网站的 iis 配置，所以我检查了一下，我有到 .net 2.0 lib 文件的映射，带有 axd扩展名..所以我怀疑这是问题所在，但是我确实删除并重新创建了iis站点..它仍然无法正常工作...

我在网络配置中也包含了这一行。

```
<add verb="GET" path="WebResource.axd" type="System.Web.Handlers.AssemblyResourceLoader" validate="true"/> 
```

这似乎也没有帮助..

有人知道我可以去哪里吗？...

编辑：我在事件查看器中遇到了这个..

```
Event code: 3005 
Event message: An unhandled exception has occurred. 
Event time: 05/05/2009 2:38:16 PM 
Event time (UTC): 05/05/2009 6:38:16 PM 
Event ID: 8579dbce2f5844169b1740bb95ebffb1 
Event sequence: 8 
Event occurrence: 1 
Event detail code: 0 

Application information: 
    Application domain: /LM/W3SVC/1/Root/SVN_WORKSPACE/WWWROOT/WorkEstimateSystem-12-128860222914549340 
    Trust level: Full 
    Application Virtual Path: /SVN_WORKSPACE/WWWROOT/WorkEstimateSystem 
    Application Path: c:\inetpub\wwwroot\SVN_WORKSPACE\WWWROOT\WorkEstimateSystem\ 
    Machine name: GREGE6500 

Process information: 
    Process ID: 2276 
    Process name: aspnet_wp.exe 
    Account name: GREGE6500\ASPNET 

Exception information: 
    Exception type: HttpException 
    Exception message: Session state is not available in this context. 

Request information: 
    Request URL: http://localhost/SVN_WORKSPACE/WWWROOT/WorkEstimateSystem/WebResource.axd?d=gPWI1Nyst2kh_ORsvV-AHCh4GSmizSjDuHRCpBgAKBsmi1Zr6e44K950Zcfsdc4p2GuNTPmRl4yAADV0USSNLFQQ7sk-iY1WVt4JJWJE_yg1&t=633771228432707325 
    Request path: /SVN_WORKSPACE/WWWROOT/WorkEstimateSystem/WebResource.axd 
    User host address: 127.0.0.1 
    User:  
    Is authenticated: False 
    Authentication Type:  
    Thread account name: GREGE6500\ASPNET 

Thread information: 
    Thread ID: 8 
    Thread account name: GREGE6500\ASPNET 
    Is impersonating: False 
    Stack trace:    at System.Web.HttpApplication.get_Session()
   at GlobalClass.CURRENT_EMPLOYEE_ID()
   at GlobalClass.checkLogin(String pagerequested)
   at GlobalClass.Application_OnPostRequestHandlerExecute(Object sender, EventArgs e)
   at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)

Custom event details: 

For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp. 
```

* * *

global.asax 有一些会话开始和结束功能以及应用程序开始和结束功能.. 有没有办法简单地说如果请求来自 axd 做一些不同的事情或不运行这些自定义功能？

固定的：

在 global.asax 页面内..

```
 Sub Application_OnPostRequestHandlerExecute(ByVal sender As Object, ByVal e As EventArgs)
select case requestedPageName
   case "webResource.axd"
    exit sub 
```

这解决了它！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T19:23:17.257

“Application_OnPostRequestHandlerExecute”方法会在.Net 处理的任何请求中运行。这包括“webresource.axd”。在该方法中，检查当前 URL 是否为“webresource.axd”。如果是，则不要使用会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:12:19.997

我正在使用一个 Farpoint Spread，它只显示一页，上面有很多行。这是我首先尝试的 c# 版本（它不起作用）：

```
Global.asax:
    protected void Application_OnPostRequestHandlerExecute(object sender, EventArgs e  )
    {
        String requestedPageName = VirtualPathUtility.GetFileName(Request.FilePath);
        switch (requestedPageName)
        {
            case "WebResource.axd":
                return;
        }
    } 
```

此链接上的解决方案对我有用，但我不得不提高数字： [http ://www.acumen-corp.com/Blog/tabid/298/EntryId/8/ASP-NET-Error-ThrowIfMaxHttpCollectionKeysExceeded.aspx](http://www.acumen-corp.com/Blog/tabid/298/EntryId/8/ASP-NET-Error-ThrowIfMaxHttpCollectionKeysExceeded.aspx)

```
Web.Config:
   <appSettings>
        <add key="aspnet:MaxHttpCollectionKeys" value="5000" />
   </appSettings> 
```

此相关帖子使用相同的解决方案： ['Operation is not valid due to the current state of the object' error during postback](https://stackoverflow.com/questions/8832470/operation-is-not-valid-due-to-the-current-state-of-the-object-error-during-pos)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-12T16:59:26.813

在我的情况下，在 web 目录中有名为**“ScriptResource.axd”**和**“Telerik.Web.UI.WebResource.axd”**的子文件夹以及一些 web.config 文件。解决方案是删除此子文件夹。

# language-agnostic - 哪个应该先编码，功能检查还是有效性检查？

> ID：826033
> 
> 赞同：4
> 
> 时间：2009-05-05T17:28:11.853
> 
> 标签：language-agnostic, validation

例如，在从头开始编写注册表单时，首先让它与预期输入一起运行，然后返回并捕获/处理意外输入并处理错误是否有意义？

另一种方法是处理输入，检查任何约束并确保它们得到正确处理，然后处理使典型用例正常运行。

一种方式比另一种方式更可取，如果是，为什么？此外，是否有另一种方法来完成这种由两部分组成的任务？

**澄清**一下，有效性，我的意思不仅仅是数据验证，包括业务规则，例如“最多 X 人可以注册此活动”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T17:33:33.727

在我看来，最好的办法是获得一个体面的第一个版本，它可能无法完全处理所有意外情况，但经过深思熟虑和模块化。然后您可以返回并完善逻辑，以便您的测试通过。

在现实世界中，这种方法是有回报的，因为当有一些问题在起作用时，你更有可能变得富有成效和兴趣，而不是仅仅被困在试图找出你头脑中的所有边缘情况并处理它们时开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T17:31:47.150

一种方法是采用 TDD 方法（假设您编写单元测试）。从编写单元测试开始，然后努力让这些单元测试通过。

在我看来，UI 工作应该最后完成，因为您可能在后端功能上有很多工作要做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T18:22:05.030

我强烈赞成首先编写验证器。一旦你有一些看起来正在工作的东西，返回并添加验证器将变得更加困难。通过首先编写验证器（但不一定要处理它们引发的异常），您可以确保完成它们。它还为您提供了一个很好的机会来准确地考虑您的期望 - 这可以帮助您考虑以后需要涵盖的特殊情况。

Tracer 项目符号很好，但该原则不需要应用于项目的每个方面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T17:31:56.087

1.  为验证对象的方法编写测试
2.  编写验证对象的方法
3.  测试直到通过

重复 1-3 直到测试所有方法。

4.  编写表单并将数据提供给经过测试和工作的验证对象方法。

对处理数据后验证的业务对象使用相同的过程。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T17:32:25.277

我总是喜欢先对功能进行编码，然后再添加验证。对我来说似乎很好，因为大多数编码都是在开发环境中完成的，并且在您处理数据时没有人会提交数据。

但无论哪种方式你觉得舒服是最好的。

我的方法的缺点是，如果你杂乱无章，你可能会忘记在某处添加有效性或卫生检查。它确实发生了:-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-05T17:32:46.630

如果不是太多工作，我将从基本的输入验证开始。特别是对于日期或标识符，如订单号。放松验证比收紧验证更容易。基本输入验证可以在后端进一步节省大量调试时间。

另一方面，假设您正在谈论支持多种语言的漂亮的启用 Javascript 的验证。在这种情况下，您最好编写一个简单的第一个版本，并在此基础上开发后端。您可以在输入表单开始接近最终版本时对其进行润色。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-05T17:34:29.390

一旦你的功能正常工作，你真的会回去添加验证码吗？

我们大多数人都愿意，但我们中的许多人在项目结束时都没有时间了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-05T22:10:10.320

我不确定设计一种或另一种方式是否更优越......虽然利克曼先生说启动功能部分然后返回并做边缘案例的乏味工作会更有效率，但我不确定我看怎么样。

如果您允许不允许的值（即您的功能代码没有预料到的值）潜入，那么拥有功能代码是没有用的（甚至是危险的）。

相反，如果没有以某种方式处理通过的值，那么出色的边界检查将毫无用处。

在生产环境中，如果你没有同时涵盖有效性和功能，你真的没有什么可展示的。你做这些事情的顺序真的应该是个人喜好的问题。如果您没有创造力并且只想做一些乏味的事情，请编写代码的有效性检查部分。如果您刚刚找到了一个完美的算法，可以在休息时间完全满足您的需求，请坐下来编写函数部分，稍后再返回边界检查。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-05T17:58:21.967

我喜欢设置几个具有功能价值的字段，然后对该功能进行验证检查，然后对其余功能进行验证，最后填写其余功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-05T17:35:34.957

如果您将代码分解为“模型”和“UI”，那么其中一些更容易理解，但基本上需要一个设计选择：您的模型对象是否会*假设*正确的输入并将责任放在 UI 上，或*测试*正确的输入。

现在，作为一名带吊带的人，我倾向于回答“是”这个问题：*即使*无论如何都应该检查输入，模型也会检查域。但无论如何，一旦你做出决定，你就有了答案：如果域检查是定义的一部分，你应该构建它并与所有其他部分一起测试它。如果您将域检查与功能分开，请分别构建和测试它们。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-05T20:43:34.410

看到太多的数据库人们忽略了验证方法，我投票赞成先做。

# .net - System.BadImageFormatException：如何修复 .NET 版本不匹配？

> ID：826038
> 
> 赞同：9
> 
> 时间：2009-05-05T17:29:18.170
> 
> 标签：.net, visual-studio, visual-studio-2005, visual-studio-2003

我在 VS 2005 中编写了一个 dll，它将由另一个在 VS 2003 中开发的程序加载。当该程序尝试加载我的 dll 时，它会抛出一个`System.BadImageFormatException: The format of the file 'Foo.dll' is invalid`.

我搜索了 SO 和 Google，似乎不同版本的 .NET 是罪魁祸首。我的问题是：我该如何解决这个问题？

（我无法修改在 VS 2003 中开发的程序。）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-05T17:31:47.540

当我运行 64 位版本的 CLR 并尝试加载仅标记为 32 位的程序集时出现此错误。在我的例子中，特定的程序集是作为 ODP.NET 一部分的 Oracle.DataAccess.dll。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-08-03T18:53:03.073

解决方案：如果您使用的是 IIS7，请在网站的特定应用程序池上右键单击/高级设置，然后在启用 32 位应用程序上选择 True。它应该工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T17:54:13.100

使用与您的 VS2003 项目使用的相同的 .Net 版本编译 VS2005 项目。或者，根据您的 VS2003 项目的大小，反射器并重写它。这是这里项目的常见做法，由于某些模糊的原因，没有更多可用的 VSS 版本。

# java - java 库如何移植到网络上？

> ID：826042
> 
> 赞同：0
> 
> 时间：2009-05-05T17:30:57.057
> 
> 标签：java, port

您如何获取用于桌面或小程序的 Java 库并制作它，以便您可以将其功能用于网页？我知道并非所有东西都适用于网络，但是您可以在 apache/tomcat 设置服务器中调用“常规”java 类并且它“工作”吗？您是否必须对其进行一些处理才能使其与网页一起使用？

我对用于 web 的 jgrapht 很感兴趣，但它看起来像所有桌面或小程序，我不知道是否可以将其图形返回到浏览器，但可能是它的库和由浏览器呈现的生成的 .png。

尽管存在关于小程序是生是死的争论，但我目前对使用一个不感兴趣，因为它看起来已经死了，尽管在最新的更新 6u10 中可能会有新的生命。我也不知道我想投资 JavaFX。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:37:21.770

是的，可以在 Web 应用程序中使用 java 类或 jar 文件，但这也取决于您想用它做什么。

例如，如果该库是用于数学的，并且您希望在基于 Web 的应用程序上将结果返回给用户，那么这绝对是可能的。我可以举很多其他的例子，但它们都是一样的。

至于显示图表，我已经在一个使用 Apache Wicket 的 Web 应用程序中成功使用了 JFreeChart（顺便说一句，它很震撼）。

因此，要回答您的问题，您实际上并不需要“移植”该库，您只需要使用它并将其输出显示到网页而不是 Java 桌面 GUI。

当然，它们可能是一些专门为 Java GUI 设计的库，例如 Swing 或 AWT。但在大多数情况下，在 J2EE 环境或 J2SE 环境中使用 Java 库没有区别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:41:27.093

您的建议没有封闭形式的答案：将 Java 库移植到浏览器的环境并使用其功能。

如果您对绘图感兴趣，可以尝试以下几种方法：

[打开 Flash Chart](http://teethgrinder.co.uk/open-flash-chart/tutorial.php) - 一个可生成图表的脚本化 Flash 应用程序

[Bluff](http://bluff.jcoglan.com/) - 一个生成图表的 Javascript 库

[processing.js](http://processingjs.org/) - 将优秀的“处理”库移植到 Javascript

至于在浏览器中访问基于 Java 的功能，有一些方法可以做到这一点。一种是使用像 GWT 这样的工具集，将 java 编译成 HTML/Javascript/Java 应用程序。另一种是使用基于 AJAX 的技术，例如[Direct Web Remoting](http://directwebremoting.org/dwr/server/spring)。这实际上取决于您要完成的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:44:28.943

约翰尼，问题是你必须决定你要做什么。例如，您可以在服务器端代码中使用 JGraphT；该图可以通过多种不同的方式进行可视化，例如 JGaph 或 graphviz。然后，您将以在 Web 上工作的某种形式输出可视化并将其放入您的网页中。在 JGraph 中，这可能意味着生成 SVG 或 PNG 的打印界面。

或者，您可以通过简单的图形遍历将图形结构作为 JSON 发出，并使用 Javascript 在浏览器中即时解释它。

一般很难回答这个问题，因为这在很大程度上取决于您打算如何使用它。

# oracle - 如何使用 dbExpress 作为 SYSDBA 连接到 Oracle 数据库？

> ID：826044
> 
> 赞同：3
> 
> 时间：2009-05-05T17:31:19.163
> 
> 标签：oracle, delphi, dbexpress, ora-01017

我有一个连接到 oracle 数据库的 Delphi 应用程序。

当我尝试以 SYSDBA 身份登录时，出现以下错误：

```
ORA-28009: connection as SYS should be as SYSDBA or SYSOPER 
```

当我尝试使用“SYS AS SYSDBA”用户登录时，出现错误：

```
ORA-01017: invalid username/password; logon denied 
```

**如何使用 dbExpress 连接以 sysdba 身份登录？**

[另请参阅有关 ADO 的相关帖子](https://stackoverflow.com/questions/179365/how-can-i-connect-to-an-oracle-database-as-sys-using-an-ado-connection-string)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-20T21:13:02.080

我没有发现任何特定于特殊 dbexpress 驱动程序的东西。但是尝试添加一个值为**SYSDBA的连接参数****DBA 权限**。

 **```
Connection.Params.Append('DBA Privilege=SYSDBA'); 
```

我没有安装 delphi 来检查参数名称的具体语法。请尝试使用下划线代替空格。

[此页面](http://www.connectionstrings.com/oracle)显示了在某些工具中用于连接到 oracle 数据库的几个连接字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:34:36.440

将用户指定为“Joseph as SYSDBA”而不是 Joseph

我找到了一份清单，但不确定它是否有用。看看吧。

[清单](http://www.dba-oracle.com/t_ora_01017.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-30T07:51:05.510

将 SYS 连接为 SYSDBA；

或者您可以使用 SYSOPER

密码将是您在安装时指定的密码（与 SYSTEM 相同）

参考： [http ://docs.oracle.com/cd/E11882_01/server.112/e10897/users_secure.htm#ADMQS12004](http://docs.oracle.com/cd/E11882_01/server.112/e10897/users_secure.htm#ADMQS12004)

# jquery - JQuery - 如何获取所有数据

> ID：826048
> 
> 赞同：1
> 
> 时间：2009-05-05T17:31:37.990
> 
> 标签：jquery, asp.net-mvc

我的 MVC 应用程序中有一个分页菜单 PartialView，如下所示：

```
 <%  if (Model.TotalPages > 5) 
    {
        int index = Model.PageIndex;
        int minIndex = index - 2;
        int maxIndex = index + 2;
        if (index < 2) 
        { 
            minIndex = 0; 
            maxIndex = 4; 
        }
        if (index > Model.TotalPages - 2) 
        { 
            minIndex = Model.TotalPages - 5; 
            maxIndex = Model.TotalPages; 
        }
        for (int i = minIndex; i <= maxIndex; i++)
        { %>    
            <li>
                <span class="<%= Html.GetClass((i==index), "selected", "notselected") %>">
                    <a href="<%= Url.Action("TypeNav", "Catalog", new { controller = "Catalog", action = "TypeNav", group = Model.ProductGroup, position = 0, index = i, browseSize = 6 } ) %>" class="<%= Html.GetClass((i==index), "selected", "notselected") %>">
                        <%= i + 1%>
                    </a>
                </span>
            </li>
<%      } 
    } 
    else 
    {
        for(int i=0; i<Model.TotalPages; i++) { %>    
            <li>
                <span class="<%= Html.GetClass((i==Model.PageIndex), "selected", "notselected") %>">
                    <a href="<%= Url.Action("TypeNav", "Catalog", new { controller = "Catalog", action = "TypeNav", group = Model.ProductGroup, position = 0, index = i, browseSize = 6 } ) %> ">
                        <%= i+1 %>
                    </a>
                </span>
            </li>
<%      }
    } %> 
```

我想不通的是如何在 Anchor 标签上设置 JQuery 点击事件。锚标签没有 NAME 属性，我对 JQuery 的（非常）有限的经验是它需要 NAME 属性才能使用。

任何指针都非常受欢迎。

TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T17:33:37.097

您应该能够执行以下操作：

```
$("a").click(function(){
     alert("I've been clicked");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T18:14:22.273

您可以指定任何 CSS 选择器来获取您的 a 标签，而不仅仅是名称/ID。例如，如果您希望文档中的所有锚标记都订阅您的事件，例如

```
$("a").click(function() { /* Do magic */ }); 
```

会工作。这确实会弄乱页面上的所有其他锚标记，这也可能不是您想要的效果。

如果你想给你的 a 标签一个常见的行为，有时给他们一个自定义的 CSS 类更容易，这样你就可以通过一个更简单的选择器来连接事件

```
$(".pagerLink").click(function() { /* Do magic */ }); 
```

如果你不喜欢这样的想法，那就是给包含 UL 标签一个 ID，然后使用后代选择器

```
$("#yourPager a").click(function() { /* Do magic */ }); 
```

或者查看您的标记，子选择器也可能是可行的

```
$("span.selected > a, span.notselected > a")
      .click(function() {/* Do magic */ }); 
```

即，查找所有具有选定类或未选定类的跨度标记的直接后代的标记。

值得记住的是，您必须取消 a 标签的默认行为（例如导航到您的链接），您可以通过从事件处理程序返回 false 或使用[jQuery 事件对象](http://docs.jquery.com/Events/jQuery.Event)并调用 preventDefault来做到这一点

# html - 缩略图库高度问题

> ID：826053
> 
> 赞同：0
> 
> 时间：2009-05-05T17:32:05.057
> 
> 标签：html, css, thumbnails

我有这个 youtube 视频的缩略图库，其标题如下。 [http://skitch.com/subzane/bqgqw/demo](http://skitch.com/subzane/bqgqw/demo)

我遇到的问题是，当它们浮动时，它们不会像我喜欢的那样出现，这是因为高度是可变的。几周前我读过一篇博客文章，解决了这个问题，但我在任何地方都找不到。

所以我要的是那个博客文章的链接或者它的内容:)

*   缩略图高度确实不同，我无法将其设置为固定高度。
*   每行的拇指数不同。我无法设置固定数字。
*   没有 JavaScript 修复。只有CSS。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:40:38.157

而不是浮动 div，您可以将缩略图切换到列表（这实际上在语义上更正确..）

例如：

```
<style type="text/css">

ul {
    list-type: none;
}

li {
    display: inline;
}
li img {
    vertical-align: top;
    margin-left: 5px;
    padding-bottom: 5px;
}

</style>

<div style="width: 280">
    <ul>
    <li><img src="th1.gif" /></li>
    <li><img src="th2.gif" /></li>
    <li><img src="th3.gif" /></li>
    <li><img src="th1.gif" /></li>
    <li><img src="th2.gif" /></li>
    <li><img src="th3.gif" /></li>
    <li><img src="th1.gif" /></li>
    <li><img src="th2.gif" /></li>
    <li><img src="th3.gif" /></li>
    <li><img src="th1.gif" /></li>
    <li><img src="th2.gif" /></li>
    </ul>
</div> 
```

如需进一步参考，请访问[http://www.alistapart.com/articles/practicalcss/](http://www.alistapart.com/articles/practicalcss/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T20:23:59.590

好的。经过几个小时的谷歌搜索，我找到了我想要的东西。

[http://blog.mozilla.com/webdev/2009/02/20/cross-browser-inline-block/](http://blog.mozilla.com/webdev/2009/02/20/cross-browser-inline-block/)

这是 display: inline-block 的使用，它解决了我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T18:09:11.410

身高真的会变化多少？如果它不会有太大变化，那么只需将高度设置为最大值？

对于支持 inline-block 的浏览器：

虽然这是一篇[inline-block 跨浏览器](http://foohack.com/2007/11/cross-browser-support-for-inline-block-styling/)文章

```
#thumbsWrapper div{display:inline-block;vertical-align:top;margin:20px;border:solid 1px #f00;width:180px;}

<div id="thumbsWrapper">
  <div style="height:180px;">
    <img src="thumbnail1.gif" />
  </div>
  <div style="height:240px;">
    <img src="thumbnail2.gif" />
  </div>
  <div style="height:210px;">
    <img src="thumbnail3.gif" />
  </div>
  <div style="height:100px;">
    <img src="thumbnail4.gif" />
  </div>
  <div style="height:300px;">
    <img src="thumbnail5.gif" />
  </div>
  <div style="height:100px;">
    <img src="thumbnail6.gif" />
  </div>
</div> 
```

# iphone - 有没有办法为 UIImageView 对象的 z 位置设置某种 z 索引？

> ID：826068
> 
> 赞同：10
> 
> 时间：2009-05-05T17:35:30.027
> 
> 标签：iphone, cocoa-touch, uikit, uiview

我正在构建一个图像网格，我从顶部开始，在整个地方创建 UIImageView 对象。现在我希望它们重叠一点，但我画的最后一个是最上面的。我想以编程方式设置 z 位置，以便我绘制的第一个将是最上面的。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-11-28T22:35:01.597

而不是使用**insertSubiew** 您可以尝试：

```
- (void)bringSubviewToFront:(UIView *)view
- (void)sendSubviewToBack:(UIView *)view 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-05T20:44:36.063

你说你使用了 UIImageView。使用 UIImageView 绘制图像意味着对其进行初始化，然后将其添加到容器视图中。

你不能在你的循环中使用这个代码吗？

```
[containerView insertSubview:image atIndex:[[containerView subviews] count]] 
```

结果将是首先添加的视图位于视图堆栈的顶部（尽管我还无法对此进行测试:)）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-18T10:50:39.390

[https://stackoverflow.com/a/4631895/2482283](https://stackoverflow.com/a/4631895/2482283)

您可以使用视图层的 zPosition 属性（它是一个 CALayer 对象）来更改视图的 z-index。

```
theView.layer.zPosition = 1; 
```

正如 Viktor Nordling 所补充的那样，“大值是最重要的。你可以使用任何你想要的值，包括负值。” 默认值为 0。

您需要导入 QuartzCore 框架才能访问该层。只需在实现文件的顶部添加这行代码即可。

```
#import "QuartzCore/QuartzCore.h" 
```

另一种方式（[https://stackoverflow.com/a/4663526/2482283](https://stackoverflow.com/a/4663526/2482283)），您也可以使用 uiviews 方法：

```
@property(nonatomic,readonly) UIView *superview;
@property(nonatomic,readonly,copy) NSArray *subviews;

- (void)removeFromSuperview;
- (void)insertSubview:(UIView *)view atIndex:(NSInteger)index;
- (void)exchangeSubviewAtIndex:(NSInteger)index1 withSubviewAtIndex:(NSInteger)index2;

- (void)addSubview:(UIView *)view;
- (void)insertSubview:(UIView *)view belowSubview:(UIView *)siblingSubview;
- (void)insertSubview:(UIView *)view aboveSubview:(UIView *)siblingSubview;

- (void)bringSubviewToFront:(UIView *)view;
- (void)sendSubviewToBack:(UIView *)view; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T17:45:11.313

不是直接的。

一种解决方案是给 UIViews 一个 z-index 属性；定义深度级别的整数。然后，您可以遍历包含 UIViews 的 NSArray (myArray)，按深度顺序将它们添加为子视图。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-05-23T08:57:02.200

我有同样的问题。我需要具有最高和最低 z-index 的子视图元素。从我的测试中我发现，UIKit 根据它们的 z 位置排列子视图属性中的元素。如果你 举个`[self.scrollview subviews]` 例子。第一个数组元素是位于最后面的子视图。索引最高的数组元素是最前面的子视图。如果你使用

```
- (void)bringSubviewToFront:(UIView *)view
- (void)sendSubviewToBack:(UIView *)view` 
```

subviews 数组将相应地重新排序。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-02T11:57:29.340

如果您有下面/上面的视图的引用，您需要添加子视图，您可以使用以下

```
[self.view insertSubview:<#(UIView *)#> belowSubview:<#(UIView *)#>];
[self.view insertSubview:<#(UIView *)#> aboveSubview:<#(UIView *)#>]; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-05T17:48:58.713

实际上，据我所知，没有 z-index 位置属性。在视图中绘图使用简单的绘图模型。

您可以将您的逻辑放在绘图循环中（即在最后绘制您想要的东西），或者您可以使用 Cocoa Animation，因为与 UIImageView 不同，CALayers 确实有深度（它们是 3D 空间的 2D 投影）。请参阅[此处](http://developer.apple.com/documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instp/CALayer/zPosition)以获取参考。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-08-14T13:27:56.200

```
imageView.layer.zPosition = 100; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-02-23T07:57:23.830

您可能真的想考虑使用 CALayer 而不是大量的 UIImageView 对象。UIImageView 对象很棒，但对于密集绘图，CALayer 的重量更轻且效率更高（尽管如果您需要让用户与图像交互，视图对象会更好）。这真的取决于你在做什么。CALayers 确实有一个 zPosition 属性。这是 UIKit 在视图堆栈中排列 UIView 的位置时使用的。

# postback - 由于相对路径问题，自定义 404 页面无法回发

> ID：826069
> 
> 赞同：3
> 
> 时间：2009-05-05T17:35:34.817
> 
> 标签：postback, http-status-code-404, relative-path

我的网站目前实现了我们在 IIS 中映射的自定义 404 页面。因此，当用户执行 www.mysite.com/foo/bar/doesnotexist 之类的操作时，它将执行 404.aspx URL。这很好用，但是在检查返回的 HTML 时，表单发布 URL 是相对的：

`<form method="post" action="404.aspx?404%3bhttps%3a%2f%2ftestserver%3a443%2ffoo%2fbar%2fdoesnotexist" onsubmit="javascript:return WebForm_OnSubmit();" id="aspnetForm">`

如果您仔细查看操作 URL 正在发布到 404.aspx，但它是一个相对路径，因此如果我们执行回发 www.mysite.com/foo/bar/doesnotexist/404.aspx，它会尝试执行。如何让我执行的 404 页面正确回发？(www.mysite.com/404.aspx)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:58:30.983

胜利者，

你的问题是重复的，所以我想你可能会在[这里](https://stackoverflow.com/questions/411167/postback-problem-when-using-url-rewrite-and-404-aspx)找到你的答案。

既然你是新来的，希望接近的纳粹分子会让你松懈。基本上，当您写一个问题时，应该在您的问题下方弹出一个类似问题的列表。如果您看到一个看起来可以回答您自己的问题，请在发布之前点击链接并查看它。10 次中有 9 次可能已经回答了您的问题。

祝你好运找到答案，我认为该链接上应该有很多好的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-08T14:54:18.360

如果您使用 axjx 并将一个页面拉入另一个页面并且页面位于不同的目录中，也会发生这种情况，简单的方法是从您的网站的根目录重写页面加载时的表单操作对象。

例如

```
 //Rewirte forms post action. 
        form1.Action = "/{dir}/{currentpage}.aspx?" + Request.QueryString; 
```

# java - 如何通过 BIRT 图表 API 自定义系列填充面积图？

> ID：826071
> 
> 赞同：0
> 
> 时间：2009-05-05T17:36:00.510
> 
> 标签：java, charts, birt

我正在尝试为我正在通过 BIRT 图表 API 构建的面积图中的系列创建渐变填充，但是“集成和扩展 BIRT”一书和 Interwebs 似乎奇怪地对如何让它工作保持沉默。似乎无论我做什么，我总是从默认调色板中获得纯色。我尝试使用 SeriesDefinition.getSeriesPalette().update(Gradient) 甚至创建我自己的调色板并在其中填充渐变并将其设置在 SeriesDefinition 上，但无济于事。我还注意到，如果我不在 Palette 上执行 shift()，即使它是 shift(0)，Javadocs 声称不会执行任何操作，当我尝试生成图表时，我会得到 NullPointerException：

```
Caused by: java.lang.NullPointerException
at org.eclipse.birt.chart.render.Area.renderDataPoints(Area.java:521)
at org.eclipse.birt.chart.render.Line.renderSeries(Line.java:570)
at org.eclipse.birt.chart.render.AxesRenderer.renderPlot(AxesRenderer.java:2181)
at org.eclipse.birt.chart.render.AxesRenderer.render(AxesRenderer.java:314)
at org.eclipse.birt.chart.factory.Generator.render(Generator.java:1368)
... 108 more 
```

这是我尝试过的最新（非工作）代码：

```
Gradient gradient = FillUtil.createDefaultGradient(BirtReportBuilder.COLOR_WHITE);
gradient.setStartColor(ColorDefinitionImpl.WHITE());
gradient.setEndColor(ColorDefinitionImpl.create(76, 116, 131));
gradient.setDirection(90);
SeriesDefinition sdY = SeriesDefinitionImpl.create();
sdY.getQuery().setDefinition("\"Quantity\"");
Palette pal = PaletteImpl.create(gradient);
pal.shift(0);
sdY.setSeriesPalette(pal);
sdY.getSeries().add(as1);
yAxisPrimary.getSeriesDefinitions().add(sdY); 
```

那么，让 BIRT 图表 API 使用我的渐变作为区域填充的魔法咒语是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T15:38:35.647

这段代码对我有用，我得到了一个丑陋的彩色系列......

```
sdY.getSeriesPalette().update(GradientImpl.create(ColorDefinitionImpl.create(255,255,255), ColorDefinitionImpl.create(200,0,0,150), 90, false)); 
```

希望对你有帮助;p

# windows-services - 如何知道哪个本地应用程序连接到我的套接字（Windows）

> ID：826076
> 
> 赞同：2
> 
> 时间：2009-05-05T17:37:03.547
> 
> 标签：windows-services, sockets, tcp, winsock

我有一个绑定到某个 TCP 端口的 Windows 服务，该端口用于我的应用程序之间的 IPC。

是否有编程（WinAPI/WinSocket 等）方法来知道哪个应用程序连接到我的端口？

即在我的 Windows 服务中，我想获得连接到我的端口的进程的 PID。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T19:20:18.073

如果您正在寻找与`netstat`. 您可能需要以下 API： [`GetExtendedTcpTable`](http://msdn.microsoft.com/en-us/library/aa365928(VS.85).aspx)

`TCP_TABLE_OWNER_PID_ALL`用参数寻找结果。

生成的`MIB_TCPTABLE_OWNER_PID`结构具有许多[`MIB_TCPROW_OWNER_PID`](http://msdn.microsoft.com/en-us/library/aa366913(VS.85).aspx)结构，`dwOwningPid`这些结构具有您要查找的进程 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T17:51:24.077

如果您的意思是什么进程正在使用（侦听或连接使用）您的端口，请使用以下命令：

`netstat -a -b -o -n`

`-a`将向您显示所有连接（即使它们处于 LISTENING 状态）

`-b`将向您显示使用该端口的应用程序可执行文件

`-o`将显示应用程序的 PID

`-n`不会做 dns 翻译（你可能不需要这些来了解应用程序），没有必要

# c# - C# 中的 OR 运算符

> ID：826081
> 
> 赞同：4
> 
> 时间：2009-05-05T17:39:28.083
> 
> 标签：c#, operators, logical-operators, operator-precedence

我能达到

```
if (a == "b" || "c") 
```

代替

```
if (a == "b" || a== "c") 
```

?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-05T17:47:00.047

好吧，你能得到的最接近的是：

```
switch (a) {
   case "b":
   case "c":
      // variable a is either "b" or "c"
      break;
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-05T17:40:56.207

不，你可以这样做：

```
if (new[] { "b", "c" }.Contains(a)) 
```

如果您有可用的[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)扩展，但这几乎不是一个改进。

* * *

为了回应关于性能的评论，这里有一些基本的计时代码。请注意，必须以批判的眼光查看代码，我可能在这里做了一些歪曲时间的事情。

结果先：

```
||, not found: 26 ms
||, found: 8 ms
array.Contains, not found: 1407 ms
array.Contains, found: 1388 ms
array.Contains, inline array, not found: 1456 ms
array.Contains, inline array, found: 1427 ms
switch-statement, not interned, not found: 26 ms
switch-statement, not interned, found: 14 ms
switch-statement, interned, not found: 25 ms
switch-statement, interned, found: 8 ms 
```

所有代码都执行了两次，并且只通过了 nr。报告了 2，以从等式中消除 JITting 开销。两次通过都执行了每种类型的检查一百万次，并在要查找的元素是要找到它的元素之一的地方执行它（即 if 语句将执行其块），并在元素不是的地方执行一次（该块不会执行）。报告每个时间。我测试了一个预先构建的数组和一个每次构建的数组，这部分我不确定编译器推导和优化了多少，这里可能存在缺陷。

在任何情况下，使用 switch 语句，无论是否首先插入字符串，都会给出与简单的 or 语句大致相同的结果，这是可以预料的，而数组查找的成本要高得多，这对我来说也是意料之中的。

请修改代码，如果有问题，请更正（或评论）它。

这是源代码，相当长：

```
using System;
using System.Linq;
using System.Diagnostics;
namespace StackOverflow826081
{
    class Program
    {
        private const Int32 ITERATIONS = 1000000;
        static void Main()
        {
            String a;
            String[] ops = CreateArray();
            Int32 count;
            Stopwatch sw = new Stopwatch();
            Int32 pass = 0;
            Action<String, Int32> report = delegate(String title, Int32 i)
            {
                if (pass == 2)
                    Console.Out.WriteLine(title + ": " + sw.ElapsedMilliseconds + " ms");
            };

            for (pass = 1; pass <= 2; pass++)
            {
                #region || operator

                a = "a";
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    if (a == "b" || a == "c")
                    {
                        count++;
                    }
                }
                sw.Stop();
                report("||, not found", count);
                sw.Reset();

                a = "b";
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    if (a == "b" || a == "c")
                    {
                        count++;
                    }
                }
                sw.Stop();
                report("||, found", count);
                sw.Reset();

                #endregion

                #region array.Contains

                a = "a";
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    if (ops.Contains(a))
                    {
                        count++;
                    }
                }
                sw.Stop();
                report("array.Contains, not found", count);
                sw.Reset();

                a = "b";
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    if (ops.Contains(a))
                    {
                        count++;
                    }
                }
                sw.Stop();
                report("array.Contains, found", count);
                sw.Reset();

                #endregion           

                #region array.Contains

                a = "a";
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    if (CreateArray().Contains(a))
                    {
                        count++;
                    }
                }
                sw.Stop();
                report("array.Contains, inline array, not found", count);
                sw.Reset();

                a = "b";
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    if (CreateArray().Contains(a))
                    {
                        count++;
                    }
                }
                sw.Stop();
                report("array.Contains, inline array, found", count);
                sw.Reset();

                #endregion

                #region switch-statement

                a = GetString().Substring(0, 1); // avoid interned string
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    switch (a)
                    {
                        case "b":
                        case "c":
                            count++;
                            break;
                    }
                }
                sw.Stop();
                report("switch-statement, not interned, not found", count);
                sw.Reset();

                a = GetString().Substring(1, 1); // avoid interned string
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    switch (a)
                    {
                        case "b":
                        case "c":
                            count++;
                            break;
                    }
                }
                sw.Stop();
                report("switch-statement, not interned, found", count);
                sw.Reset();

                #endregion                      

                #region switch-statement

                a = "a";
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    switch (a)
                    {
                        case "b":
                        case "c":
                            count++;
                            break;
                    }
                }
                sw.Stop();
                report("switch-statement, interned, not found", count);
                sw.Reset();

                a = "b";
                sw.Start();

                count = 0;
                for (Int32 index = 0; index < ITERATIONS; index++)
                {
                    switch (a)
                    {
                        case "b":
                        case "c":
                            count++;
                            break;
                    }
                }
                sw.Stop();
                report("switch-statement, interned, found", count);
                sw.Reset();

                #endregion
            }
        }

        private static String GetString()
        {
            return "ab";
        }

        private static String[] CreateArray()
        {
            return new String[] { "b", "c" };
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T17:41:28.640

据我所知，这不是一个选择。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T17:55:15.970

您可以使用正则表达式：

```
if(Regex.IsMatch(a, "b|c")) 
```

如果“a”的内容可以长于一个字符，请使用：

```
if(Regex.IsMatch(a, "^(b|c)$")) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T17:51:08.850

不，不是那种语法。但是有很多选择可以编码。

```
if ("bc".Contains(a)) { } // Maybe check a.Length == 1, too.

if ((a[0] & 0x62) == 0x62) { } // Maybe check a.Length == 1, too.

if (new String[] { "b", "c" }.Contains(a)) { } 
```

也许您可以进行一些运算符重载并让您的语法正常工作，但这实际上取决于您想要实现的目标，并且很难从您的简单示例中看出。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-05T18:19:14.803

你可以在某些情况下。即，标记的枚举：

```
[Flags]
enum MyEnum {
    None = 0,
    A = 1,
    B = 2,
    C = 4,
    D = 8
}

//...

MyEnum a = MyEnum.B

if((a & (MyEnum.B | MyEnum.C)) > 0)
    // do something 
```

相当于：

```
if((a & MyEnum.B) > 0 || (a & MyEnum.C) > 0)
    // do something 
```

其原因与位掩码有关。在二进制中，

```
None = 00000
A    = 00001
B    = 00010
C    = 00100
D    = 01000 
```

所以当我们使用 | 运算符，我们进行逐位比较，查找列中的任何 1 并将它们复制到结果中。如果列中没有 1，则复制 0。

```
 B 00010
& C 00100
---------
    00110 
```

然后当我们应用 & 运算符时，我们在复制 1 之前在每列的所有行中查找 1。

```
 (B & C) 00110
& (a = B) 00010
---------------
          00010 
```

> 0，因此返回 true。

奇怪的是，这是最有效的方法，因为它为您节省了一个数字比较 (>) 和一个逻辑运算符 (||)，它可以完成所有花哨的短路和诸如此类的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T17:54:49.060

不，这不是 or 运算符 (||) 在 C# 中的工作方式。

另一种解决方案，虽然它降低了代码的可读性，但它是创建一个函数来检查你想要的值，类似于：

```
public static bool Any(object a, params object[] b)
{
    foreach(object item in b)
    {
        if(a == b)
        {
            return true;
        }
    }
    return false;
} 
```

# python - Python：查找给定用户名/组名的 uid/gid（对于 os.chown）

> ID：826082
> 
> 赞同：71
> 
> 时间：2009-05-05T17:39:54.883
> 
> 标签：python

使用 Python 查找给定用户名或组名的 uid/gid 的好方法是什么？我需要使用 os.chown 设置文件所有权，并且需要整数 id 而不是字母。

[快速说明]：getpwnam 效果很好，但在 Windows 上不可用，所以这里有一些创建存根的代码，允许您在 Windows 和 unix 上运行相同的代码。

```
try:
    from pwd import getpwnam
except:
    getpwnam = lambda x: (0,0,0)
    os.chown = lambda x, y, z: True
    os.chmod = lambda x, y: True
    os.fchown = os.chown
    os.fchmod = os.chmod 
```

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-05-05T17:43:19.290

使用[`pwd`](http://docs.python.org/library/pwd.html)和[`grp`](http://docs.python.org/library/grp.html)模块：

```
from pwd import getpwnam  

print getpwnam('someuser')[2]
# or
print getpwnam('someuser').pw_uid
print grp.getgrnam('somegroup')[2] 
```

# ruby-on-rails - 您只能从 ActionMailer smtp_settings 中指定的用户名发送电子邮件吗？

> ID：826095
> 
> 赞同：1
> 
> 时间：2009-05-05T17:42:11.040
> 
> 标签：ruby-on-rails, actionmailer

在我的 ActionMailer 配置文件中，我有这个：

```
ActionMailer::Base.delivery_method = :smtp
ActionMailer::Base.smtp_settings = {
  :address => "mail.foo.com",
  :port => 25,
  :domain => "foo.com",
  :authentication => :email,
  :user_name => "no-reply@foo.com",
  :password => "foo1234567"
} 
```

使用此配置，我只能从`no-reply@foo.com`电子邮件地址发送电子邮件吗？如果是这样，有没有办法从其他地址发送电子邮件？我的 ActionMailer 类中有这个：

```
class Notifications < ActionMailer::Base

  def answered_question(faq)
    subject       'Your question has been answered'
    recipients    faq.email
    from          'Foo <no-reply@foo.com>'
    sent_on       Time.now
    content_type  "text/html"
    body          :faq => faq
  end

  def completed_order(order)
    subject        'Your order has been completed'
    recipients     order.email                                       
    from           'Foo <registrations@foo.com>'
    sent_on        Time.now
    content_type   "text/html"
    body           :order => order
  end
end 
```

在开发中一切正常，但在生产`completed_order`中没有发送电子邮件。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T20:20:59.887

我猜这更像是一个 SMTP 问题，它是 ActionMailer。一些 SMTP 不需要用户名/密码来发送外发邮件，因此您可以根据需要设置发件人地址。

也就是说，由于您在发送邮件时遇到问题，这些邮件的发件人地址与您用来向 SMTP 服务器进行身份验证的地址不同，我猜想 SMTP 框有一个限制，仅允许在以下情况下发送邮件发件人地址与身份验证 UID 匹配。

# c# - C#取消后台工作者的DoWork

> ID：826096
> 
> 赞同：4
> 
> 时间：2009-05-05T17:42:27.047
> 
> 标签：c#, background, worker

C# 2008

我正在使用下面的代码登录到软件电话。但是，登录过程是一个漫长的过程，因为有很多东西需要初始化和检查，我在这里只放了一些，因为它会使代码很长发布。

在下面的代码中，我正在检查 CancellationPending 是否在我的取消按钮单击事件中调用了 CancelAsync，然后再进行每次检查。它是否正确？此外，如果检查失败，我还会调用 CancelAsync 并将 e.Cancel 设置为 true。

我想知道我在这里使用的方法是否是最好的方法。

非常感谢您的任何建议，

```
private void bgwProcessLogin_DoWork(object sender, DoWorkEventArgs e)
    {   
        /*
         * Perform at test to see if the background worker has been
         * cancelled by the user before attemping to continue to login.
         * 
         * Cancel background worker on any failed attemp to login
         */

        // Start with cancel being false as to reset this if cancel has been set to true
        // in the cancel button.
        e.Cancel = false;

        NetworkingTest connection_test = new NetworkingTest();
        if (!this.bgwProcessLogin.CancellationPending)
        { 
            // Check local LAN or Wireless connection               
            if (!connection_test.IsNetworkConnected())
            {
                // Update label
                if (this.lblRegistering.InvokeRequired)
                {
                    this.lblRegistering.Invoke(new UpdateRegisterLabelDelegate(UpdateRegisterLabel), "No network connection");
                }
                else
                {
                    this.lblRegistering.Text = "No network connection";
                }
                // Failed attemp
                this.bgwProcessLogin.CancelAsync();
                e.Cancel = true;
                return;
            }
            // Report current progress
            this.bgwProcessLogin.ReportProgress(0, "Network connected");
        }
        else
        {
            // User cancelled 
            e.Cancel = true;
            return;
        }

        // Test if access to Server is available
        if (!this.bgwProcessLogin.CancellationPending)
        {
            if (!connection_test.IsSIPServerAvailable())
            {
                // Update label
                if (this.lblRegistering.InvokeRequired)
                {
                    this.lblRegistering.Invoke(new UpdateRegisterLabelDelegate(UpdateRegisterLabel), "Server unavailable");
                }
                else
                {
                    this.lblRegistering.Text = "Server unavailable";
                }
                // Failed attemp
                this.bgwProcessLogin.CancelAsync();
                e.Cancel = true;
                return;
            }
            // Report current progress
            this.bgwProcessLogin.ReportProgress(1, "Server available");
        }
        else
        {
            // User cancelled 
            e.Cancel = true;
            return;
        }
        .
        .
        .
}

 private void bgwProcessLogin_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {   
        // Check for any errors
        if (e.Error == null)
        {
            if (e.Cancelled)
            {
                // User cancelled login or login failed                
            }
            else
            {
                // Login completed successfully                
            }
        }
        else
        {
            // Something failed display error
            this.statusDisplay1.CallStatus = e.Error.Message;
        }
    }

 private void bgwProcessLogin_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        this.lblRegistering.Text = e.UserState.ToString();
    }

private void btnCancel_Click(object sender, EventArgs e)
    {
        // Cancel the logging in process
        this.bgwProcessLogin.CancelAsync();
        this.lblRegistering.Text = "Logged out";
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-01-29T08:13:53.590

可能只有一个问题：DoWork 事件处理程序中的一项操作是否会持续很长时间。在这种情况下，您只能在该操作完成后中止您的挂起操作。如果 DoWork 事件中的所有操作都不能持续很长时间（例如，不超过 5 秒），则一切正常，但如果其中一项操作可以持续很长时间（例如，5 分钟），则在这种情况下，用户有等到此操作完成。

如果 DoWork 包含持久的操作，您可以使用 AbortableBackgroundWorker 之类的东西。像这样的东西：

```
public class AbortableBackgroundWorker : BackgroundWorker
{
    private Thread workerThread;

    protected override void OnDoWork(DoWorkEventArgs e)
    {
        workerThread = Thread.CurrentThread;
        try
        {
            base.OnDoWork(e);
        }
        catch (ThreadAbortException)
        {
            e.Cancel = true; //We must set Cancel property to true!
            Thread.ResetAbort(); //Prevents ThreadAbortException propagation
        }
    }

    public void Abort()
    {
        if (workerThread != null)
        {
            workerThread.Abort();
            workerThread = null;
        }
    }
} 
```

在这种情况下，您可以真正中止挂起的操作，但您也有一些限制（有关中止托管线程的更多信息和一些限制，请参阅[Plumbing the Depths of the ThreadAbortException Using Rotor](http://ondotnet.com/pub/a/dotnet/2003/02/18/threadabort.html)）。

PS 我同意 Oliver 的观点，即您应该将 InvokeRequired 包装成更可用的形式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T19:29:33.590

你做对了，我相信。您会发现允许您终止或中止线程的线程成员，但您不想将它们用于此类事情。在您的代码中包含所有“取消”检查可能看起来有点奇怪，但这允许您准确控制何时退出线程。如果你“粗鲁地”中止工作线程，线程无法控制它何时退出，并且可能存在损坏状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-29T07:57:28.303

在您编写的 DoWork() 函数`...`中。根据显示的两个相同结构的任务的数量，您可以将此结构重构为自己的方法，将变化的部分作为参数。

这个 InvokeRequired if-else 分支也将输出字符串加倍。在 stackoverflow 或网络上进行一点搜索应该会向您展示实现这种加倍的模式。

其他一切看起来都很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T15:13:32.403

有一件事我不需要调用 this.bgwProcessLogin.CancelAsync(); 因为你可以设置这个 e.Cancel = true;

# mysql - 慢查询会阻止 apache 得到答案

> ID：826101
> 
> 赞同：0
> 
> 时间：2009-05-05T17:44:04.623
> 
> 标签：mysql

我有一个问题，在完成其他查询之前我无法查询我的 mysql 数据库。当我从 apache 运行一个繁重的 sql-query (30s) 时，或者当我从同一个 apache-request 中运行一系列 sql-query 时，就会发生这种情况。

由于我的查询只是选择（没有更新或修改，也没有事务），我认为应该可以运行 simulatanious 查询。我怎样才能做到这一点？

我正在使用 Zend_Db::factory($config->db->adapter, $dbConfig); 我不确定这是否会限制连接或尝试始终重新使用相同的连接。我手动关闭“一系列呼叫”中每个呼叫之间的连接。

/彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-18T06:36:37.043

您可能在 Apache 中设置了一个连接池，但连接池已用完。我不确定您在 apache 中使用的是哪个模块，但如果它的[mod_dbd](http://httpd.apache.org/docs/2.2/mod/mod_dbd.html)则检查您的`DBDMax`参数。

# nhibernate - Linq to Sql 与 NHibernate 映射选项的比较

> ID：826112
> 
> 赞同：0
> 
> 时间：2009-05-05T17:48:32.287
> 
> 标签：nhibernate, linq-to-sql

我几乎是一个新手，我需要深入研究这个问题来写一些大学文章，所以我需要一些引导。

我在这里和那里读到 NHibernate 在将域模型映射到数据库方面提供了更多的灵活性（与 L2S 相比）。你能写下我应该探索什么的一些提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T18:52:03.540

具体来说，您可能希望查看 LINQ to SQL 映射多对多关系的限制。这是两个产品之间映射的一个很大的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T19:56:07.900

需要考虑的一件事是 L2S 通过在一个非常大的 DBML 文件中创建对象来“为你做这件事”。您可以通过创建部分类来处理您的对象，但是如果您决定尝试对 dbml 文件进行任何更改，那么您将被搞砸，因为 L2S 在重新生成时会覆盖您的更改，或者您必须手动实现任何更改.

因此，您有点卡住了，因为更改 DBML 是一个糟糕的主意，但正因为如此，您在对象的命名属性方面可以做的事情是有限的。一个典型的例子是使用在数据库中存储为整数的枚举。假设您在应用程序中将 UserType 作为枚举，在您的用户表中，您可能只是将其存储为名为 UserType 的 int 列。太好了，除非当您创建 DBML 文件时，您将 UserType 映射为 int 列...但是如果您真的希望属性 UserType 返回一个 UserType 枚举，您将被迫破解 DBML ...或更改您的命名约定您的数据库以匹配您的 ORM 工具......这两者都不是好的选择。

而 nHibernate 只是您的对象和您的数据库之间基于 XML 的映射，它在您希望如何设置方面为您提供了更大的灵活性。

另一件事是这里引用的多对多关系和每个子类的表/每个类的表映射：

[http://nhibernate.info/doc/nh/en/index.html](http://nhibernate.info/doc/nh/en/index.html)

我不相信 L2S 可以处理每个子类的表关系。

希望这可以帮助，

-最大限度

# iphone - 为 iPhone UITabBar 生成图标

> ID：826113
> 
> 赞同：9
> 
> 时间：2009-05-05T17:48:41.103
> 
> 标签：iphone, png, uitabbarcontroller, transparency, icons

我一直忙于为我的 iPhone 应用程序处理图形。我开始为我的 UITabBar 生成图标并遇到了很多问题。你如何创建这些图标？

我创建了这个解决方案：

[http://www.nailrails.com/?p=46](http://www.nailrails.com/?p=46)

这种方法有什么缺点吗？它似乎适用于我创建的几个图标......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-04-14T01:22:34.830

Apple 的指南可在[http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/IconsImages/IconsImages.html#//apple_ref/doc/uid/TP40006556-CH14-SW1找到](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/IconsImages/IconsImages.html#//apple_ref/doc/uid/TP40006556-CH14-SW1)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T18:56:16.260

文档非常简单——当图像被工具栏加载时，alpha 是最重要的，这意味着任何至少不是半透明的东西都会呈现在相同的不透明阴影中。至于我是怎么做的，我主要使用 Adob​​e 工具。Fireworks 是我的首选工具，但 Photoshop 也能胜任。另一个我用过的好结果是 Acorn，坦率地说，它便宜很多，而且对于这种工作来说足够复杂。我不是真正的平面设计师，但对这类东西有一定的熟悉度。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-01T03:58:15.550

我的网站上有一篇文章展示了如何将 OmniGraffle 与我用来在几分钟内创建出色的 iPhone 工具栏图标的模板一起使用：

[http://steveweller.com/articles/toolbar-icons/](http://steveweller.com/articles/toolbar-icons/)

该模板设置了一个网格来工作，该网格对应于每个像素的一个正方形。您在黑色模板背景上绘制白色图标，然后导出为 PDF 格式，以匹配您需要的图标大小（通常为 21 像素高）。然后重新导入 PDF，将其调整为最终图标大小（再次为 21 像素），然后导出为 PNG。模板没有任何神奇之处；它只是提供了一个已经设置好的工作区域，并帮助您每次都正确地获得最终的 PNG 规模是正确的。

您可以在 Acorn 或任何其他支持 PDF 导出和图层的应用程序中使用相同的技术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-24T09:08:54.113

（我使用 Gimp。假设你的图标层已经有 alpha 通道。）

1.  右键单击图层，然后添加图层蒙版。
2.  选择“传输图层的 Alpha 通道”选项完成。
3.  选择整个图层（但不是图层蒙版），并用纯白色清除它。
4.  将图像大小调整为 Apple 建议的大小，并将其导出为 png 文件。

您也可以直接在图层蒙版上绘画。

# objective-c - 确定 NSString 中的路径是指向目录还是 文件？

> ID：826116
> 
> 赞同：26
> 
> 时间：2009-05-05T17:49:04.923
> 
> 标签：objective-c, cocoa, file

我有一个包含路径的 NSString，但它可以是文件，也可以是目录。

是否有与Cocoa中的 Python`os.path.isdir()`和方法等价的东西？`os.path.isfile()`

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-05T17:51:57.210

请参阅[NSFileManager 类参考](https://developer.apple.com/documentation/foundation/nsfilemanager/1410277-fileexistsatpath?language=objc)

```
[[NSFileManager defaultManager] fileExistsAtPath:pathname 
                                isDirectory:&directoryFlag]; 
```

例如：

```
NSString *file = @"/tmp/";
BOOL isDir = NO;
if([[NSFileManager defaultManager]
     fileExistsAtPath:file isDirectory:&isDir] && isDir){
    NSLog(@"Is directory");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-30T12:55:10.913

如果 htw 的解决方案不起作用，请尝试以下操作：

```
NSString *file = @"/tmp/";
BOOL isDir
NSDirectoryEnumerator *dirEnum = [[NSFileManager defaultManager] enumeratorAtPath:file];
while ((file = [dirEnum nextObject])) {
   [[NSFileManager defaultManager] fileExistsAtPath:file isDirectory:&isDir];
   if(isDir){
      NSLog(@"%@ is a directory", file);
   }
} 
```

# c# - 使用反射编辑 .NET 资源？

> ID：826127
> 
> 赞同：0
> 
> 时间：2009-05-05T17:53:09.390
> 
> 标签：c#, reflection, resources

我正在尝试使用反射在另一个 .NET 可执行文件中编辑一些资源。

这可能/我该怎么做？还是我完全走错了路？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:56:30.147

听起来你可能走错了路。CLR 不允许您编辑加载到当前 AppDomain 中的任何程序集的元数据表。你想做什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:58:08.397

> [Reflexil](http://sourceforge.net/projects/reflexil/)是一个程序集编辑器，作为 Reflector 的插件运行。使用 Mono.Cecil，Reflexil 能够操作 IL 代码并将修改后的程序集保存到磁盘。Reflexil 还支持“即时”C# 和 VB.NET 代码注入。

# asp.net - 获取 ASP.net 用户控件的命名空间名称未找到

> ID：826129
> 
> 赞同：4
> 
> 时间：2009-05-05T17:53:51.730
> 
> 标签：asp.net, user-controls

所以当我尝试发布网站时遇到了问题。我在视觉工作室 2008 sp1。

我有一堆用户控件，在几个页面上我以编程方式使用它们。

我在 aspx 页面上有一个参考

```
<%@ Reference Control="~/UserControls/Foo.ascx" %> 
```

然后在我使用的代码上

```
ASP.usercontrols_foo newFoo control = (ASP.usercontrols_foo)Page.LoadControl("~/UserControls/Foo.ascx"); 
```

如果我导航到该页面，它可以正常工作，但是当我发布该网站时，我会收到编译时错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-24T17:16:07.507

啊，我在同一个问题上浪费了开发时间。有人对此有解决方案吗？

顺便说一句：如果您取消选中“允许此预编译站点可更新”，它将构建（右键单击该网站，选择属性页，MSBuild 选项）

但我需要该网站是可更新的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-10T21:24:24.200

我遇到了同样的问题 - 实际上，在我的情况下，我可以让它编译和构建我的网站，但是在进行自动构建时它会爆炸性地爆炸。

尝试按如下方式替换您的代码：

```
ASP.usercontrols_foo newFoo control = (ASP.usercontrols_foo)Page.LoadControl("~/UserControls/Foo.ascx"); 
```

和

```
USERCONTROLS_Foo newFoo control = (USERCONTROLS_Foo)Page.LoadControl("~/UserControls/Foo.ascx"); 
```

（大写将基于您如何大写目录名称/控件名称 - 但在任何一种情况下都应适当突出显示）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-23T12:20:00.277

为用户控件指定命名空间（请参阅[在 asp.net 网站中动态加载用户控件 (ascx)](https://stackoverflow.com/questions/1290592/dynamically-load-a-user-control-ascx-in-a-asp-net-website)）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-16T06:32:05.003

我已经找到了解决方案。如果我将在用户定义的命名空间中声明控件，那么我可以直接使用控件而无需使用 ASP 或将其引用到 aspx 页面中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-24T17:19:09.980

它可能与特定类型不可用有关。您可以更改控件引用，以便类型和强制转换只使用基本 Control 类：

```
Control control = Page.LoadControl("~/UserControls/Foo.ascx"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-24T17:28:14.737

是的，我可以将其转换为 Control。但是后来我无法直接访问用户控件上的方法。

我知道我可以通过反映到控件中来访问这些方法，并且我已经成功地做到了，但这远非理想地访问站点上的所有其他用户控件。

此外，后续错误是它找不到标记上的用户控件

```
<%@ Register src="CategoryRows.ascx" tagname="CategoryRows" tagprefix="abc" %>
<abc:CategoryRows ID="CategoryRows" runat="server" /> 
```

请注意，如果我基本上 XCopy 整个站点（源代码和所有），我可以在本地和服务器上成功运行该站点。但发布失败。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-14T14:58:03.753

转换用户控件可能会产生很多问题。我的方法是创建一个类（比如控件类），在转换后放置你需要的所有属性和方法，并从 System.Web.UI.UserControl 继承这个类。然后在你的用户控制代码中文件而不是 System.Web.UI.UserControl 用户这个控件类。

现在，当您只需要使用此类进行强制转换时。它也将是轻型铸造。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-20T19:38:34.177

请检查：

你有`website.publishproj`文件吗？
如果存在，则删除并重试并发布代码。

# jquery - 网站在 CFM 和 Chrome 上的 HTML 中呈现不同

> ID：826133
> 
> 赞同：1
> 
> 时间：2009-05-05T17:54:43.473
> 
> 标签：jquery, html, coldfusion, google-chrome

好的，所以这很奇怪。我有一个站点，我将其拆分为几个 ColdFusion 文档的页眉/页脚/等。我的网站的页脚使用 jQuery 插件固定在底部。当我转到 index.cfm 页面（在 Chrome 中）查看结果时，页脚位置已关闭。然后我“右键单击...查看源代码”并突出显示所有内容，然后将其复制并粘贴到新的 index2.html 文档中，一切正常。

没错，完全相同的代码，不同的结果。我不明白。这还不是一个实时站点，因此如果您想查看这 2 个文件的运行情况，我可以通过电子邮件为您获取 URL。只需向我发送一个请求 ..nevermind..，我会向您发送 2 个页面的 URL。

所有其他浏览器都可以正常工作，所以 Firebug 是不可能的 :(

这是严重的[心灵装瓶](http://www.youtube.com/watch?v=qWkNPrXkvRA)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T18:01:54.907

空白可能正在发挥作用。

# asp.net - 调试 ASP.NET 应用程序时如何在 Fiddler 中显示本地主机流量？

> ID：826134
> 
> 赞同：80
> 
> 时间：2009-05-05T17:54:47.967
> 
> 标签：asp.net, visual-studio, localhost, fiddler, web-traffic

如何在调试 ASP.NET 应用程序时在 Fiddler 中显示 localhost 流量？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-05-05T17:59:47.410

尝试使用这个：

```
http://ipv4.fiddler/folder 
```

代替

```
http://localhost/folder 
```

这也适用于端口

```
http://ipv4.fiddler:12345/folder 
```

这是提琴手文档的链接

[http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/MonitorLocalTraffic](http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/MonitorLocalTraffic)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-11-13T09:30:28.363

要使 Fiddler 使用 IIS Express 在 localhost 上工作，您应该使用这种形式的 URL

```
http://localhost.fiddler:50262/ 
```

这会放置满足 IIS Express 的正确主机标头值 (localhost)。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-08-27T19:52:05.493

启动提琴手。转到工具-> Fiddler 选项。选择连接选项卡。选中“使用 PAC 脚本”选项。

现在您还可以监控本地流量

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-05T18:20:38.543

对于 ASP.NET 网站项目：

1) 右键单击​​项目并选择属性页
2) 选择启动选项
3) 在服务器部分下，单击“使用自定义服务器”并通过将 localhost 替换为您的计算机名称来编辑基本 URL。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-07-23T08:44:56.673

监控到 localhost 的流量的最简单方法可能是将“localhost”替换为“localhost”。在浏览器的 URL 栏中。例如

```
http://localhost./MyApp/default.aspx 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-06-12T10:23:41.730

**使用提琴手 v4：**

1.  检查您的 IE 代理设置

> IE->工具->Internet选项->连接->局域网设置

[![IE 局域网设置](https://i.stack.imgur.com/hYA0y.png)](https://i.stack.imgur.com/hYA0y.png)

2.  检查您在 Fiddler 中的设置：

> Fiddler -> 选项 -> 连接和 Https

检查 Fiddler 端口，默认为 8888 [![提琴手端口](https://i.stack.imgur.com/o1b77.png)](https://i.stack.imgur.com/o1b77.png)

3.  在提琴手菜单中：

> 文件 -> 捕获流量已选中

以下解决方案对我有用，当使用

*   HttpClient 或
*   来自 ASP.NET 应用程序内部的 WebClient。

**网页配置**

```
<system.net>
    <defaultProxy
                enabled = "true"
                useDefaultCredentials = "true">
      <proxy autoDetect="False" bypassonlocal="False" proxyaddress="http://127.0.0.1:8888" usesystemdefault="False" />
    </defaultProxy> 
```

**代码**：

```
var resourceServerUri = new Uri("http://localhost.fiddler:YourAppServicePort");
var body = c.GetStringAsync(new Uri(resourceServerUri)).Result; 
```

* * *

**通过自定义 Fiddler 规则脚本检查您的请求是否真正到达 fiddler**

> Fiddler->规则->自定义规则

并挂钩到**OnBeforeRequest**事件：

```
static function OnBeforeRequest(oSession: Session) {

if (oSession.hostname.Contains("localhost:YourPortNumber")
{
 System.Windows.Forms.MessageBox.Show(oSession.hostname);  
} 
```

**或者通过设置网络代理明确**

```
WebClient wc = new WebClient();

WebProxy proxy = new WebProxy();
// try one of these URIs
proxy.Address = new Uri("http://127.0.0.1:8888");
proxy.Address = new Uri("http://hostname:8888");
proxy.Address = new Uri("http://localhost.fiddler");
proxy.Address = new Uri("http://ipv4.fiddler");
// https://en.wikipedia.org/wiki/IPv6
proxy.Address = new Uri("http://ipv6.fiddler");

proxy.BypassProxyOnLocal = false; wc.Proxy = proxy;
var b = wc.DownloadString(new Uri(YourResourceServerBaseAddress)); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-11-01T10:29:27.427

在公司 Intranet 中使用 IIS Express 时，检查 Fiddler 选项 -> 连接中的“使用 PAC 脚本”对我有用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-03-14T12:20:46.197

您可以使用 PC 主机名而不是 127.0.0.1 或 localhost

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-05T18:00:32.320

看看这个链接......“解决方法”是 hacky，但它确实有效：

[在 localhost 上使用 Fiddler 的提示](http://weblogs.asp.net/lorenh/archive/2008/01/10/tip-for-using-fiddler-on-localhost.aspx)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-05T18:00:10.777

确保在您的 Fiddler 连接中，localhost 不在“IE 应绕过 Fiddler 以获取以：开头的 URL”框。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-05T18:03:01.240

您应该取消选中该复选框：

绕过本地地址的代理服务器

位于 Internet Explorer 的代理配置中。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-04-22T14:46:24.933

尝试使用[http://127.0.0.1](http://127.0.0.1)。<-- 注意 . 在最后

所以你仍然可以连接到 Casini 并轻松调试（我目前正在调试页面[http://127.0.0.1.:1718/login/Default.aspx](http://127.0.0.1.:1718/login/Default.aspx)）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-12-27T12:03:59.050

一种可能的解决方案是删除 IE 中的代理设置，如下所示。

```
 IE->Tools->Internet Options->Connections->Lan Settings-> 
```

禁用关注

*   自动检测设置
*   使用自动配置脚本

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-05-13T15:32:38.890

如果尝试使用 Fiddler 从 BizTalk 捕获本地计算机上的 HTTPS 流量，请尝试使用 WCF 适配器代理设置。我使用的地址是：`http://localhost:8888/`

# wcf - 带有此示例的 WCF 项目会导致错误 - VS 2008

> ID：826141
> 
> 赞同：0
> 
> 时间：2009-05-05T17:55:47.450
> 
> 标签：wcf

示例来自这里：[链接文本](http://channel9.msdn.com/shows/Endpoint/Endpoint-Screencasts-Creating-Your-First-WCF-Service/)

我构建了示例项目，它构建没有错误。但是点击F5，我得到服务已经被托管的消息，然后它抛出这个错误

应用程序名称：wcfsvchost.exe 应用程序版本：9.0.622.1152 模块名称：mscorwks.dll 模块版本：2.0.50727.3082 偏移量：00080012

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T18:24:05.790

检查已安装的 .NET Framework 版本。WCF 至少需要 .NET Framework 3.0，建议使用 3.5 SP1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T19:05:39.060

检查项目的属性，可以选择目标框架的版本。也许选择了 2.0 版。

# sql - Sql Un-Wizardry：比较另一个列表中的值

> ID：826149
> 
> 赞同：1
> 
> 时间：2009-05-05T17:57:14.733
> 
> 标签：sql, mysql, list, comparison

我有一个比较，我想在 SQL 中提高效率。

输入字段 (fldInputField) 是逗号分隔的“1,3,4,5”列表

数据库有一个字段（fldRoleList），其中包含“1,2,3,4,5,6,7,8”

因此，对于 fldRoleList 中第一次出现 fldInputField，请告诉我们它是哪个值。

有没有办法在 MySQL 或存储过程中实现以下目标？

伪代码

SELECT * FROM aTable t1 WHERE fldInputField in t1.fldRoleList

/伪代码

我猜可能有一些函数最适合这种类型的比较？我在搜索中找不到任何内容，如果有人可以指导我，我将删除该问题...谢谢！

**更新：这不是做事的理想（或好的）方式。它是继承的代码，我们只是尝试快速修复，同时我们查看构建逻辑以通过规范化行来处理这个问题。幸运的是，这不是大量使用的代码。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T18:14:42.427

我同意@Ken White 的[回答](https://stackoverflow.com/questions/826149/sql-wizardry-compare-values-from-one-list-in-another/826170#826170)，即逗号分隔的列表在标准化数据库设计中没有位置。

如果将多行存储在从属表中，解决方案会更简单*并且*性能更好：`fldRoleList`

```
SELECT t1.*, r1.fldRole 
FROM aTable t1 JOIN aTableRoles r1 USING (aTable_id) 
WHERE FIND_IN_SET(r1.fldRole, fldInputField); 
```

（见 MySQL 函数[`FIND_IN_SET()`](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_find-in-set)）

但是，如果多个角色与逗号分隔的输入字符串匹配，则会输出多行。`aTable`如果您需要将结果限制为每个条目一行，第*一个*匹配角色：

```
SELECT t1.*, MIN(r1.fldRole) AS First_fldRole 
FROM aTable t1 JOIN aTableRoles r1 USING (aTable_id) 
WHERE FIND_IN_SET(r1.fldRole, fldInputField);
GROUP BY t1.aTable_id; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T18:04:43.887

你有一个糟糕的架构设计，你知道的。逗号分隔的列表在数据库中没有任何业务。

话虽这么说......你正在寻找LIKE。

```
SELECT * FROM aTable t1 WHERE t.fldRoleList LIKE fldInputField + '%' 
```

如果内容在开头可能并不总是匹配，请在 fldInputField 之前添加另一个百分号。

```
SELECT * FROM aTable t1 WHERE t.fldRoleList LIKE '%' + fldInputField + '%' 
```

# version-control - Emacs：有没有办法从 diff 生成骨架 ChangeLog？

> ID：826155
> 
> 赞同：6
> 
> 时间：2009-05-05T17:59:52.323
> 
> 标签：version-control, emacs, elisp, changelog

在版本控制中使用源代码时，我想部分地自动创建 GNU 样式的 ChangeLog 条目。一次使用`add-changelog-entry-other-window`一个文件，您必须访问该文件才能使用它。

相反，我希望看到一些命令可以输出`diff -u -p`（或与 VC 模式集成以便它可以处理`svn diff`等）并一次创建所有骨架条目。

例如，如果`svn status`显示

```
D file1.c
M file2.c
A file3.c 
```

该命令将创建

```
2009-09-05  My Name <my.email>

      * file1.c: Removed.
      * file2.c: WRITE YOUR CHANGES HERE
      * file3.c: New. 
```

更好的是，如果它可以在一定程度上解析某些语言的更改文件，那么它可以提供：

```
 * file2.c (new_function): New function.
  (deleted_function): Removed.
  (changed_function): WRITE YOUR CHANGES HERE 
```

我[在 Emacs 手册中找到了此功能](http://www.gnu.org/software/emacs/manual/html_node/emacs/Log-Buffer.html)，但我不知道如何在此处应用它。

有什么建议么？谢谢。

编辑：一个答案建议[vc-update-change-log](http://gnu.cict.fr/software/emacs/manual/html_node/emacs/Change-Logs-and-VC.html)。不幸的是，它只支持 CVS，它通过查询已经提交的 VC 日志来创建 ChangeLog 条目。因此，即使它支持 svn 和其他，也不可能在同一个提交中提交更改和 ChangeLog。

EDIT2：显然 add-changelog-entry-other-window （Cx 4 a）不仅适用于访问过的文件，而且适用于涉及该文件的差异大块。（[来源](http://www.emacswiki.org/emacs/ChangeLog)）这几乎是我正在寻找的。这与 elisp 循环一起遍历所有大块应该可以解决它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T05:41:43.570

有一个功能[`vc-update-change-log`](http://gnu.cict.fr/software/emacs/manual/html_node/emacs/Change-Logs-and-VC.html)可以从版本控制日志条目中自动生成更改日志条目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-04T03:49:37.963

`diff-add-change-log-entries-other-window`记录在案的正是您在 EDIT2 中提到的：

```
diff-add-change-log-entries-other-window is an interactive compiled
Lisp function in `diff-mode.el'.

(diff-add-change-log-entries-other-window)

Iterate through the current diff and create ChangeLog entries.
I.e. like `add-change-log-entry-other-window' but applied to all hunks. 
```

不幸的是，它不能很好地用于新文件：它甚至没有在骨架变更日志条目中包含此类文件的文件名。

使用 gcc 的 mklog 脚本可能会更好，您可以从[http://gcc.gnu.org/viewcvs/gcc/trunk/contrib/mklog](http://gcc.gnu.org/viewcvs/gcc/trunk/contrib/mklog)获得该脚本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T18:50:11.063

我不知道有什么功能可以做到这一点，但它应该很容易实现。基本上，你想

*   获取更改的文件
*   对于每个文件，调用`add-change-log`

```
“找到更改日志文件，并为今天添加一个条目并为此文件添加一个项目。
可选参数 WHOAMI（交互式前缀）非零表示提示用户
姓名和电子邮件（存储在“add-log-full-name”和“add-log-mailing-address”中）。

第二个参数 FILE-NAME 是更改日志的文件名。
如果为零，则使用“change-log-default-name”的值。

第三个参数 OTHER-WINDOW 非零表示在其他窗口中访问。

第四个参数 NEW-ENTRY 非零意味着总是在前面创建一个新条目；
永远不要附加到现有条目。选项 `add-log-keep-changes-together'
否则会影响是否创建新条目。

选项 `add-log-always-start-new-record' 非零意味着总是创建一个
新记录，即使最后一次记录是在同一日期和由
同一个人。

更改日志文件可以以版权声明和副本开头
许可通知。第一个空行表示这些结束
通知。

今天的日期是根据 `add-log-time-zone-rule' 如果
非零，否则为当地时间。”
```

所以魔术代码看起来像

```
(apply 'make-magic-change-log-entry changed-files-list) 
```

并`make-magic-change-log-entry`简单地对`add-change-log`函数进行柯里化，以便唯一的参数是`file-name`- 您设置其他参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T18:34:50.313

I've written a function to do something similar to what you were talking about. You can get the code at [http://www.emacswiki.org/emacs/log-edit-fill](http://www.emacswiki.org/emacs/log-edit-fill)

# forms - WebClient.UploadValues 重复键

> ID：826156
> 
> 赞同：0
> 
> 时间：2009-05-05T18:00:03.650
> 
> 标签：forms, post, request, key, webclient

我在我的网站上代理请求时遇到了一些困难。

理论上，这应该有效

webClient.UploadValues(url, "POST", HttpContext.Current.Request.Form);

不幸的是，表单包含一个重复的键“elemKey”

当我使用 HTTP Analyzer 并查看发布数据时，它会显示该键三次，具有三个不同的值。参数值

elemKey value1 elemKey value2 elemKey value3

不幸的是，webclient 的调用只显示了一次密钥，并带有一个逗号分隔的值列表，这是行不通的。

参数值 elemKey value1,value2,value3

我尝试从 HttpContext.Current.Request.Form 变量创建 NameValueCollection 并添加多个 elemKey，但它再次将它们与逗号连接在一起。

有没有办法以我需要的方式创建这个请求？

谢谢-c

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T20:04:01.137

I used UploadString instead of UploadValues and all is now well

string html = webClient.UploadString(url, "POST", HttpContext.Current.Request.Form.ToString());

# java - Java线程等待和通知

> ID：826161
> 
> 赞同：10
> 
> 时间：2009-05-05T18:02:51.863
> 
> 标签：java, multithreading, queue, producer-consumer

我有两个线程。线程 A 正在从队列中提取一些元素，线程 B 正在向队列中添加一些元素。

当队列为空时，我希望线程 A 进入睡眠状态。

当线程 B 向队列中添加一些元素时，它应该确保线程 A 正在工作。如何在 Java 中做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-05T18:04:13.093

使用 a [`BlockingQueue`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)，即：

> A`Queue`还支持在检索元素时等待队列变为非空，并在存储元素时等待队列中可用空间的操作。

说真的，不要试图在这里重新发明轮子。

（如果您*必须*使用等待/通知，请阅读[本教程](http://java.sun.com/docs/books/tutorial/essential/concurrency/guardmeth.html)。但请不要让自己痛苦！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T18:52:52.273

以下是一些细节：

```
import java.concurrent.Executors;
import java.concurrent.ExecutorService;
...
ExecutorService executor = Executors.newFixedThreadPool(someNumberOfThreads);
...
executor.execute(someObjectThatImplementsRunnable);
...
executor.shutdownNow(); 
```

这就是 Java 更新的线程功能的全部内容。Executor 是一个线程池，其中包含 someNumberOfThreads。它由阻塞队列提供。除非有工作要做，否则所有线程都会休眠。当您使用 execute() 方法将 Runnable 对象推送到队列中时，Runnable 对象将位于队列中，直到有可用的线程来处理它。然后，它的 run() 方法被调用。最后，shutdownNow() 方法通知池中的所有线程关闭。

现在比以前简单多了。

（这有很多变体，例如具有最小和最大线程数的池，或者在调用 execute() 的线程将阻塞之前具有最大大小的队列。）

# c# - 基本 SQL 的问题

> ID：826167
> 
> 赞同：0
> 
> 时间：2009-05-05T18:04:14.230
> 
> 标签：c#, sql, sql-server

我是 SQL 的初学者。我遇到了问题。首先，我让你知道我安装了 SQL 2005 Server n，然后制作了一个 ConsoleApp，其余代码如下：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Data.SqlClient;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            SqlConnection myConnection = new SqlConnection("user id=userid;" +
                                       "Password=validpassword;" +
                                       "Trusted_Connection=yes;" +
                                       "Data Source=localhost;" +
                                       "connection timeout=300");

            try
            {
                myConnection.Open();
            }
            catch (Exception e)
            {
                Console.WriteLine(e.ToString());
            }

            SqlCommand myCommand = new SqlCommand("INSERT INTO table (Column1, Column2) " +
                                      "Values ('string', 1)", myConnection);

            myCommand.ExecuteNonQuery();

        }
    }
} 
```

当我运行它时...我**在 System.Data.dll**中使用 myCommand.ExecuteNonQuery();

请指导我哪里出错了。我只想做一些简单的事情。插入一些东西然后阅读它。但即使在插入时我也会出错。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T18:08:38.480

您没有使用数据库。将连接字符串中的 Initial Catalog 查询设置为表“table”所在的数据库。或者，执行 INSERT INTO dbName..table VALUES ...

另外，请查看[ConnectionStrings.com](http://connectionstrings.com/)。学习它，使用它，爱它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T18:09:25.937

您的连接中似乎缺少 Initial Catalog 参数。它应该是“初始目录 = DatabaseName”。此外，如果您使用的是可信连接，则不需要用户 ID 和密码参数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T18:09:38.617

开始我移动您的异常处理以包含 ExecuteNonQuery，然后使用完整的异常编辑您的问题。

```
 static void Main(string[] args)
        {
            SqlConnection myConnection = new SqlConnection("user id=userid;" +
                                       "Password=validpassword;" +
                                       "Trusted_Connection=yes;" +
                                       "Data Source=localhost;" +
                                       "connection timeout=300");

            try
            {
                myConnection.Open();

                SqlCommand myCommand = new SqlCommand("INSERT INTO table (Column1, Column2) " +
                                      "Values ('string', 1)", myConnection);
                myCommand.ExecuteNonQuery();    
            }
            catch (Exception e)
            {
                Console.WriteLine(e.ToString());
            }
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T18:10:58.520

安装 SQL Server 2005 时是否将其置于混合模式？你需要这个来传递用户名和密码。我不确定 .NET 将如何处理连接字符串中的用户名/密码和受信任的连接 = true。你得到一个开放的连接吗？

您的连接字符串中还需要一个数据库名称。

我无法在您的帖子中添加评论，因此我将在此处添加。您需要启动 SQL Server Management Studio 才能访问您的数据库和未来的表。然后寻求帮助并开始在线阅读有关如何创建表格的书籍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T18:07:51.710

与数据库的连接存在问题 - 用户名、密码和/或服务器错误，或者表和列不存在。我会在 catch 语句上放置一个断点并查看异常以了解更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T18:09:46.560

如果您捕获异常，或调试控制台应用程序以便查看异常详细信息，您应该能够通过检查异常消息或内部异常来找出错误的完整详细信息。

正如乍得提到的，这可能是一个简单的命名问题，您在查询中指定的表或列在您指向的数据库中不存在。或者，您尝试解释的数据类型可能存在问题。异常返回的 DB Server 消息会让您了解更多。

# .net - 确定 SSL 证书到期日期 IIS

> ID：826175
> 
> 赞同：7
> 
> 时间：2009-05-05T18:05:57.427
> 
> 标签：.net, iis, iis-7, ssl, iis-6

我需要以编程方式确定 IIS 框上 SSL 证书的到期日期。理想情况下，我想在 C# 中执行此操作，但如果 VB 脚本也是唯一可以接受的方法。

环境 => IIS 版本 6 和 7、.NET 2.0、Windows 2003 和 2008

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-10-19T19:44:06.393

我不熟悉使用 VBS 和/或 WMI 进行此检查的方法，因为这可能是一个安全整体，因为它可能会暴露私钥。但是，有一种方法可以利用正常的 HTTPS 连接来获取有关证书的公共信息。如果您使用 IE 连接到任何安全网站，则可以转到“文件”菜单并查看“属性”，然后单击“证书”按钮。这显示了该站点的公共证书信息对话框。您可以使用 C# 以编程方式获取此信息。

基本上，您要做的就是在端口 443 上打开与服务器的 TCP 连接，然后接收 SSL 数据。在此数据流中是有关证书的公共信息，您可以对其进行验证并从中提取您需要的所有信息，包括到期日期。这是一些示例代码：

```
static void Main(string[] args) {
    foreach (string servername in args) {
        Console.WriteLine("\n\nFetching SSL cert for {0}\n", servername);
        TcpClient client = new TcpClient(servername, 443);
        SslStream sslStream = new SslStream(client.GetStream(), false, callback, null);

        try {
            sslStream.AuthenticateAsClient(servername);
        } catch (AuthenticationException ex) {
            Console.WriteLine("Exception: {0}", ex.Message);
            if (ex.InnerException != null) {
                Console.WriteLine("Inner exception: {0}", ex.InnerException.Message);
            }
            Console.WriteLine("Authentication failed - closing the connection.");
        }

        client.Close();
    }
} 
```

以及处理证书信息的回调代码：

```
static RemoteCertificateValidationCallback callback = delegate(object sender, X509Certificate cert, X509Chain chain, SslPolicyErrors sslError) {
    X509Certificate2 x509 = new X509Certificate2(cert);

    // Print to console information contained in the certificate.
    Console.WriteLine("Subject: {0}", x509.Subject);
    Console.WriteLine("Issuer: {0}", x509.Issuer);
    Console.WriteLine("Version: {0}", x509.Version);
    Console.WriteLine("Valid Date: {0}", x509.NotBefore);
    Console.WriteLine("Expiry Date: {0}", x509.NotAfter);
    Console.WriteLine("Thumbprint: {0}", x509.Thumbprint);
    Console.WriteLine("Serial Number: {0}", x509.SerialNumber);
    Console.WriteLine("Friendly Name: {0}", x509.PublicKey.Oid.FriendlyName);
    Console.WriteLine("Public Key Format: {0}", x509.PublicKey.EncodedKeyValue.Format(true));
    Console.WriteLine("Raw Data Length: {0}", x509.RawData.Length);

    if (sslError != SslPolicyErrors.None) {
        Console.WriteLine("Certificate error: " + sslError);
    }

    return false;
}; 
```

很酷的是，从技术上讲，这种方法应该适用于任何网络服务器......我只在 IIS 6 和 7 上进行了测试。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-12-18T10:29:47.153

Jonas Gorauskas 对解决方案的简化：

```
public class SslCertificateExpirationChecker
{
    public DateTime GetCertificateExpirationDate(string host, int port)
    {
        TcpClient client = new TcpClient(host, port);

        X509Certificate2 x509 = null;
        SslStream sslStream = new SslStream(client.GetStream(), false, 
            delegate(object sender, X509Certificate cert, X509Chain chain, SslPolicyErrors sslError)
            {
                x509 = new X509Certificate2(cert);
                return true;
            });
        sslStream.AuthenticateAsClient(host);
        client.Close();
        return x509.NotAfter;
    }
} 
```

用法：

```
var expirationDate = checker.GetCertificateExpirationDate("www.mydomain.com", 443); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-19T19:52:51.103

您应该也可以使用 Microsoft.Web.Administration 执行此操作，请参阅[这篇文章](http://forums.iis.net/t/1162723.aspx)和这篇[博文](http://martinnormark.com/2010/03/04/multiple-ssl-certificates-on-iis-using-host-headers)。我认为你应该能够扭转它 - 获得正确的商店，然后是正确的证书。

[编辑] 嗯，我现在很困惑。我不确定 IIS 7 以下的任何内容都支持 Microsoft.Web.Administration ..[/edit]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-05T15:52:52.583

C# 中的代码检查证书到期，这是在服务器端完成并在事件日志中通知
[http://awesomeideas.net/page/Cert-Expiry-Check.aspx](http://awesomeideas.net/page/Cert-Expiry-Check.aspx)

这是使用 vbscript
[http://awesomeideas.net/post/How-to-Check-certificate-expiry-for-webserver-(IIS)-certificates-using-script.aspx的版本](http://awesomeideas.net/post/How-to-Check-certificate-expiry-for-webserver-(IIS)-certificates-using-script.aspx)

Jonas 的方法也很好，因为它使用 TCPClient 并且可以从远程机器上使用。

# asp.net - Server.Transfer 和 Getlastwritetime

> ID：826178
> 
> 赞同：0
> 
> 时间：2009-05-05T18:06:22.947
> 
> 标签：asp.net, server.transfer

我正在使用 asp.net 3.0。

我让页面 A 做一个 Server.Transfer 到页面 B。

在页面 A 和页面 B 上，我希望能够使用 System.IO.File.GetLastWriteTime(MapPath(Page.Request.Path.ToString())) 以便在每个页面的顶部显示最后修改日期文件。

这在页面 A 上效果很好，但是当我使用 Server.Transfer 到页面 B 时，Page.Request.Path 仍然指的是页面 A，而不是页面 B。

有没有办法解决这个问题而不从 Server.Transfer 更改为 Response.Redirect （Server.Transfer 对于我在两个页面上的其他代码部分都很重要）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T18:28:17.763

试试这个：

```
System.IO.File.GetLastWriteTime(MapPath(Page.Request.AppRelativeCurrentExecutionFilePath)) 
```

# asp.net - gridview 上的 Databind() 不起作用 VB.net ASP.Net

> ID：826182
> 
> 赞同：1
> 
> 时间：2009-05-05T18:07:27.140
> 
> 标签：asp.net, vb.net, gridview

我有一个经过验证的 10 行名为 dtable 的数据表。我尝试将它绑定到我的 gridview，但我的 asp.net 页面上没有显示任何内容。为什么这些相对简单的几行没有填充我的gridview？

```
 Dim con As SqlConnection = Nothing
    Dim dTable As DataTable
    Dim dataAdapter As SqlDataAdapter
    Dim sqlcmd As String
    .......
    dTable = New DataTable
    dataAdapter = New SqlDataAdapter(sqlcmd, con)
    dataAdapter.Fill(dTable)

    'DATATABLE at this point has 10 rows in it, I verified that at runtime

    gvUnitSystem.DataSource = dTable
    gvUnitSystem.DataBind()

End Sub 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T18:09:36.247

您是否确定 GridView 的 AutoGenerateColumns 设置为 true？

```
gvUnitSystem.AutoGenerateColumns = True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T18:10:06.637

这看起来不错。您是自动填充列还是在设计器中手动添加列？如果是后者，则可能没有任何列字段与表中的字段匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-04T16:28:52.060

您需要设置 con（连接字符串）。

# fonts - 我需要与 Windows 兼容的方形像素字体

> ID：826185
> 
> 赞同：0
> 
> 时间：2009-05-05T18:07:51.837
> 
> 标签：fonts, pixel-fonts, bitmap-fonts

我正在寻找一种方形像素字体，最好是每个字符 8x8 像素。我希望它看起来像这样：

[ibm 风格的字体 http://dwarf.lendemaindeveille.com/images/0/0e/CGA8x8thick.png](http://dwarf.lendemaindeveille.com/images/0/0e/CGA8x8thick.png)

我或多或少需要这里显示的每个字符，尤其是方框图。经过大约一个小时的搜索，我发现的极少数 Windows 字体没有很少（如果有的话）扩展字符。

我目前正在写一个伪roguelike，我一直更喜欢roguelikes中的方形字体。如果必须，我可以使用其他方法，但如果存在这样的字体，我的生活会轻松一百万倍。

同样，它需要与 Windows 兼容。如果我需要将某些 X11 格式转换为与 Windows 兼容的格式，这很好，但我需要一个指向工具的链接才能执行此操作。

或者，也许有人知道可以轻松地将位图转换为字体的程序？因为包含的图像实际上正是我想要的：它看起来与旧的 IBM CGA/EGA 系统完全一样。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T09:22:27.897

[http://dskcenter.free.fr/Download/DskCenter_fonts.zip](http://dskcenter.free.fr/Download/DskCenter_fonts.zip)

PC_CGA 字体看起来像你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T18:18:17.740

较早版本的[Windows 用于附带 .FON](http://www.melbpc.org.au/pcupdate/9303/9303article3.htm)文件（TTF 的前身）。FON 的外观看起来很基本。您可能想找到 COURIER.FON。

此外，您可以[编辑自己的 TTF](http://fontforge.sourceforge.net/)，或制作现有的 TTF 等宽。但是你必须为此找到一个编辑器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T18:25:34.197

要看的东西可能是“Proggy Square”。该字体的版本之一，ANSI/位图版本，具有扩展字符。Proggy Square 及其变体可在网络上的各个地方获得。据我了解，它们可以免费使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T18:31:26.117

[http://www.uwe-sieber.de/dosfon_e.html](http://www.uwe-sieber.de/dosfon_e.html)

转到该页面的底部。我没有全部尝试过，但 OEM Codepage 850 字体似乎是您想要的，其他字体也可以。

# ruby-on-rails - 在 Windows 上找不到 Sqlite 驱动程序

> ID：826189
> 
> 赞同：0
> 
> 时间：2009-05-05T18:09:18.137
> 
> 标签：ruby-on-rails

我面临与以下问题相同的问题。有没有人有任何解决方案？ [Ruby 在 Windows 上找不到 sqlite3 驱动程序](https://stackoverflow.com/questions/515639/ruby-cannot-find-sqlite3-driver-on-windows/520342) 我安装了 Ruby 1.9.1，然后是 rails。然后，我安装了 sqlite3-ruby，但那是坏的。所以，我删除了目录，并为 win 版本 1.2.3 安装了 sqlite3-ruby。但是，得到错误“找不到 sqlite 驱动程序”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-13T12:57:15.083

我一直有同样的问题。

sqlite3-ruby 1.2.3 版似乎与 Ruby 1.9 不兼容。1.2.4 版（也许）是兼容的，但从未发布过 Windows 二进制版本，维护者已宣布他已放弃为 Windows 构建和发布。

根据[这篇文章](http://www.ruby-forum.com/topic/188627)，有人正在努力修复，但还没有。

所以这将是一个无用的答案，因为到目前为止我的研究都没有找到现在可用的修复程序。今天获得 Windows Ruby/Rails 开发设置的选项似乎要么切换到 MySQL 作为开发数据库，​​要么回到 Ruby 1.8.7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T18:47:18.730

您需要为 Windows 安装实际的 sqlite3 .dll。

转到[http://www.sqlite.org/download.html](http://www.sqlite.org/download.html)并下载 sqlitedll-3_6_13.zip 和 sqlite-3_6_13.zip（或任何最新版本）。

解压缩这两个压缩文件。将 sqlite3.exe 复制到 c:\windows 并将 sqlite3.dll 复制到 c:\windows\system32

从命令行运行 gem install sqlite3-ruby --no-ri --no-rdoc --version=1.2.3 --platform=mswin32 以安装 SQLite3 gem（额外的标志阻止它尝试编译一些在 Windows 上通常不可用）

# firefox - javascript 富文本编辑器中出现的奇怪元素

> ID：826191
> 
> 赞同：3
> 
> 时间：2009-05-05T18:09:21.287
> 
> 标签：firefox, richtextbox, wysiwyg, malware, rich-text-editor

网络上基于 javascript 的富文本编辑器中出现了大量奇怪的 HTML 表单元素。我能找到的第一个证据是在一个月前[的 joomla 论坛上。](http://forum.joomla.org/viewtopic.php?f=433&t=391890)从那时起，也有来自[drupal 用户](http://drupal.org/node/442774#comment-1532616)和[wordpress 用户](http://wordpress.org/support/topic/265035)的报告，现在[整个网络都](http://www.google.com/#q=jsproxy+gwproxy)证明了这一点——最后，我们刚刚在我负责的网站上收到了一份报告。它似乎仅限于Firefox。

有什么想法来自哪里，以及如何阻止它？有一些关于卸载 firefox 和运行恶意软件扫描程序的模糊提及，但没有具体说明。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T15:05:25.620

这行代码非常清楚：

```
<input type="hidden" id="gwProxy" /><!--Session data--><input type="hidden" id="jsProxy" /><div id="refHTML">&nbsp;</div> 
```

[gwProxy / jsProxy 代码被嵌入到帖子中](http://drupal.org/node/457960)

[WYSIWYG textareas 中插入了奇怪的 gwProxy 代码](http://support.mozilla.com/tiki-view_forum_thread.php?locale=en-US&comments_parentId=343800&forumId=1)

由于恶意主题或附加组件，iT 似乎使用 FCKeditor 和 JCE 编辑器将代理嵌入到用户代码中。

来自 support.mozilla.com：

您可以在安全模式下启动 Firefox 以检查您的加载项是否导致您的问题（切换到默认主题：工具 > 加载项 > 主题）。请参阅对扩展和主题进行故障排除如果它在安全模式下工作，则禁用所有扩展，然后尝试通过一次启用一个扩展来查找导致它的原因，直到问题再次出现。您可以在安全模式启动窗口中使用“禁用所有加载项”。每次更改后，您必须关闭并重新启动 Firefox（文件 > 退出）。

对不起我的英语！不要犹豫，对这篇文章发表评论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T16:09:35.523

您是否碰巧安装了名为“Browser Highlighter”[1] 的 Firefox 插件？它可能与 Skype 插件一起安装或独立安装（假设它与 eBay 有某种联系）。

我已经看到两个人 [2]、[3] 发布了卸载“浏览器荧光笔”插件就可以解决问题的帖子。它可能不是恶意小部件，只是故障小部件。卸载或禁用它并告诉我们？

如果是这种情况，您可以指示您的用户在他们这边（在他们的浏览器中）删除或禁用该插件。

您还必须将其从发布到您网站的数据中删除。如果您使用的是第三方 CMS（Wordpress、Joomla 等）并且您不是程序员，那么您将不得不让某人注意有问题的文本并将其删除。

[1] [http://www.browserhighlighter.com/](http://www.browserhighlighter.com/)

[2][案例#1](http://support.mozilla.com/tiki-view_forum_thread.php?locale=pt-BR&forumId=1&comments_parentId=343800)

[3][案例#2](http://74.125.95.132/search?q=cache:FhslKrD0LSEJ:moodle.org/mod/forum/discuss.php%3Fd%3D121954%26parent%3D534842+browserhighlighter+gwproxy&cd=2&hl=en&ct=clnk&gl=us&client=firefox-a)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T03:52:14.200

“停止”是什么意思？如果您知道存在特定于 Firefox 版本的问题并且您想阻止它，您可以在有人提交该字段时检查问题，然后再保存，您可以在保存后但在您之前将其从数据中删除加载它，或者您检查该版本的 Firefox 并阻止使用它的用户在您的网站上提交（我不建议这样做）。

我几乎不认为您可以告诉您的用户卸载 Firefox，但是您可以通过这些其他选项来处理问题如何影响您的网站。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-14T15:01:37.990

我相信您可能正在追逐富文本编辑器和 Firefox 插件的原因。这段代码被注入到我的一个*没有*富文本编辑器的页面中，*并且*被注入到 IE、Chrome 和 Firefox 上的页面中。我确实看到了一个指向 Skype 加载项的帖子。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-05T18:14:53.083

从您提供的链接来看，对我来说听起来并不太模糊。这是某种恶意软件，会自动将 javascript 插入您发布的内容中，可能会以某种方式攻击您网站的访问者。将其设置为插入到常见的 CMS 编辑器中可能会让很多人在不知不觉中发布它。

给出了删除它的各种说明，这篇文章似乎可能会起作用：[问题出在浏览器中 - 删除并重新安装](http://drupal.org/node/442774#comment-1532616)

# java - 在运行一段时间后，可以获取 Java 中线程使用的实际堆栈大小吗？

> ID：826206
> 
> 赞同：12
> 
> 时间：2009-05-05T18:12:31.280
> 
> 标签：java, stack-size

这个想法是帮助确定给定 Java 应用程序的最佳堆栈大小。

可以使用此信息完成的一件事是创建一个堆栈大小范围表，线程可以在退出时对其进行修改，并且可以在应用程序退出时定期转储。

**编辑：这是在具有我无法访问探查器访问的真实工作负载的客户机器上运行的上下文中。**

EDIT2：作为对一个答案的回应，在（IIRC）每个线程 256Kb 时，我有一段时间想知道这与实际需要的东西有多接近（我也想知道这个问题是否可能不是很相关，因为堆栈空间*可能*是按需分配）。我们有一个基于消息传递和高度线程化的应用服务器，可在从 ARM 手持设备到八核 Linux 再到中型机和大型机的所有设备上运行 - 了解我们可以在哪里（以及是否）可以交易会很好具有许多消息处理程序的系统上的堆的堆栈空间。

有一些类似的问题很有趣，但它们是本机/操作系统特定的：

*   [如何确定最大堆栈使用量？](https://stackoverflow.com/questions/389219)
*   [如何确定最佳线程堆栈大小？](https://stackoverflow.com/questions/177516/how-to-determine-optimal-thread-stack-size)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T21:28:51.743

堆栈内存将很难获得。

你能做的最好的，也很容易的，是通过[**`MemoryMXBean`**](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/management/MemoryMXBean.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T16:39:56.517

我认为您也可以使用全新的[VisualVM](https://visualvm.dev.java.net/)来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T18:16:21.487

使用 JConsole——您可能已经拥有它：http: [//java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html](http://java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html) [http://openjdk.java.net/tools/svc/jconsole /](http://openjdk.java.net/tools/svc/jconsole/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-02-23T20:30:31.657

您可以像这样使用 Runtime 类来监控 JVM 内存。

```
Runtime rt = Runtime.getRuntime();
System.out.println((rt.freeMemory() / 1024) + "/" + (rt.maxMemory() / 1024) + " kB"); 
```

或者您可以使用 JConsole、JVisualVM e JInfo。[您可以在此处](http://java.sun.com/developer/technicalArticles/J2SE/monitoring/)获得有关这些工具的更多信息：

[http://java.sun.com/developer/technicalArticles/J2SE/monitoring/](http://java.sun.com/developer/technicalArticles/J2SE/monitoring/)

# c# - WPF 文档处理？

> ID：826207
> 
> 赞同：0
> 
> 时间：2009-05-05T18:12:46.207
> 
> 标签：c#, wpf, document

WPF 是否提供了处理文档的框架，类似于 MFC 的 Document/View 的方式？

在我的 WPF 应用程序中，我可以在菜单中创建**File->New/Open/Save**元素并将它们附加到方法，但我想知道 WPF 是否提供了任何东西来以更好的方式管理它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T18:19:49.873

主要发布的指南是使用模型/视图/视图模型模式。

我建议[在 MVVM 上观看第 9 频道的视频](http://channel9.msdn.com/shows/Continuum/MVVM/)。

Patterns and Practices 小组还发布了[WPF 和 Silverlight 的复合应用程序指南](http://msdn.microsoft.com/en-us/library/dd458809.aspx)，其中包括一个可以使用的完整库。但是，对于许多应用程序来说，它的重量相当大。

本指南的最新版本是[Prism 库](http://prismlibrary.github.io/)。

# ruby-on-rails - 如何获取 Ruby 类的名称？

> ID：826210
> 
> 赞同：423
> 
> 时间：2009-05-05T18:13:35.503
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

如何从 ActiveRecord 对象中获取类名？

我有：

```
result = User.find(1) 
```

我试过：

```
result.class
# => User(id: integer, name: string ...)
result.to_s
# => #<User:0x3d07cdc>" 
```

我只需要字符串中的类名（`User`在这种情况下）。有没有办法呢？

我知道这是非常基本的，但我搜索了 Rails 和 Ruby 的文档，但找不到。

* * *

## 回答 #1

> 赞同：785
> 
> 时间：2009-05-05T18:15:23.580

您想在对象的类上调用[.name ：](https://www.ruby-doc.org/core/classes/Module.html#M001699)

```
result.class.name 
```

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2014-07-18T19:21:09.920

这是从 Daniel Rikowski 和 pseidemann 的评论中提取的正确答案。我厌倦了不得不通过评论来找到正确的答案......

如果您使用 Rails (ActiveSupport)：

```
result.class.name.demodulize 
```

如果您使用 POR (plain-ol-Ruby)：

```
result.class.name.split('::').last 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-05-05T20:47:45.850

既`result.class.to_s`和`result.class.name`工作。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-04-12T20:01:45.860

如果您想从类方法中获取类名，`class.name`否则`self.class.name`将无法正常工作。这些只会输出`Class`，因为类的类是`Class`. 相反，您可以使用`name`：

```
module Foo
  class Bar
    def self.say_name
      puts "I'm a #{name}!"
    end
  end
end

Foo::Bar.say_name 
```

输出：

```
I'm a Foo::Bar! 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-06T06:39:13.370

就我而言，当我使用类似的东西时，`result.class.name`我得到了类似的东西`Module1::class_name`。但如果我们只想`class_name`使用

`result.class.table_name.singularize`

# java - Java 执行器：当任务完成时，如何在不阻塞的情况下得到通知？

> ID：826212
> 
> 赞同：176
> 
> 时间：2009-05-05T18:13:56.643
> 
> 标签：java, callback, notify, executor

假设我有一个充满任务的队列，我需要将这些任务提交给执行器服务。我希望他们一次处理一个。我能想到的最简单的方法是：

1.  从队列中获取任务
2.  提交给执行人
3.  在返回的 Future 上调用 .get 并阻塞，直到有结果可用
4.  从队列中获取另一个任务...

但是，我试图完全避免阻塞。如果我有 10,000 个这样的队列，它们需要一次处理一个任务，我将用完堆栈空间，因为它们中的大多数将保留阻塞的线程。

我想要的是提交一个任务并提供一个在任务完成时调用的回调。我将使用该回调通知作为发送下一个任务的标志。（functionaljava 和 jetlang 显然使用了这样的非阻塞算法，但我看不懂他们的代码）

如果不编写自己的执行程序服务，我该如何使用 JDK 的 java.util.concurrent 来做到这一点？

（为我提供这些任务的队列本身可能会阻塞，但这是稍后要解决的问题）

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2009-05-05T18:28:33.783

定义一个回调接口来接收你想在完成通知中传递的任何参数。然后在任务结束时调用它。

您甚至可以为 Runnable 任务编写一个通用包装器，并将它们提交到`ExecutorService`. 或者，请参阅下面的 Java 8 内置机制。

```
class CallbackTask implements Runnable {

  private final Runnable task;

  private final Callback callback;

  CallbackTask(Runnable task, Callback callback) {
    this.task = task;
    this.callback = callback;
  }

  public void run() {
    task.run();
    callback.complete();
  }

} 
```

* * *

有了[`CompletableFuture`](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html)，Java 8 包含了一种更精细的方法来组合管道，其中流程可以异步和有条件地完成。这是一个人为但完整的通知示例。

```
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ThreadLocalRandom;
import java.util.concurrent.TimeUnit;

public class GetTaskNotificationWithoutBlocking {

  public static void main(String... argv) throws Exception {
    ExampleService svc = new ExampleService();
    GetTaskNotificationWithoutBlocking listener = new GetTaskNotificationWithoutBlocking();
    CompletableFuture<String> f = CompletableFuture.supplyAsync(svc::work);
    f.thenAccept(listener::notify);
    System.out.println("Exiting main()");
  }

  void notify(String msg) {
    System.out.println("Received message: " + msg);
  }

}

class ExampleService {

  String work() {
    sleep(7000, TimeUnit.MILLISECONDS); /* Pretend to be busy... */
    char[] str = new char[5];
    ThreadLocalRandom current = ThreadLocalRandom.current();
    for (int idx = 0; idx < str.length; ++idx)
      str[idx] = (char) ('A' + current.nextInt(26));
    String msg = new String(str);
    System.out.println("Generated message: " + msg);
    return msg;
  }

  public static void sleep(long average, TimeUnit unit) {
    String name = Thread.currentThread().getName();
    long timeout = Math.min(exponential(average), Math.multiplyExact(10, average));
    System.out.printf("%s sleeping %d %s...%n", name, timeout, unit);
    try {
      unit.sleep(timeout);
      System.out.println(name + " awoke.");
    } catch (InterruptedException abort) {
      Thread.currentThread().interrupt();
      System.out.println(name + " interrupted.");
    }
  }

  public static long exponential(long avg) {
    return (long) (avg * -Math.log(1 - ThreadLocalRandom.current().nextDouble()));
  }

} 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2014-03-12T20:36:52.133

在 Java 8 中，您可以使用[CompletableFuture](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html)。这是我的代码中的一个示例，我使用它从我的用户服务中获取用户，将它们映射到我的视图对象，然后更新我的视图或显示错误对话框（这是一个 GUI 应用程序）：

```
 CompletableFuture.supplyAsync(
            userService::listUsers
    ).thenApply(
            this::mapUsersToUserViews
    ).thenAccept(
            this::updateView
    ).exceptionally(
            throwable -> { showErrorDialogFor(throwable); return null; }
    ); 
```

它异步执行。我正在使用两种私有方法：`mapUsersToUserViews`和`updateView`.

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2012-11-13T20:31:49.260

使用[Guava 的可听未来 API](https://github.com/google/guava/wiki/ListenableFutureExplained)并添加回调。参照。从网站：

```
ListeningExecutorService service = MoreExecutors.listeningDecorator(Executors.newFixedThreadPool(10));
ListenableFuture<Explosion> explosion = service.submit(new Callable<Explosion>() {
  public Explosion call() {
    return pushBigRedButton();
  }
});
Futures.addCallback(explosion, new FutureCallback<Explosion>() {
  // we want this handler to run immediately after we push the big red button!
  public void onSuccess(Explosion explosion) {
    walkAwayFrom(explosion);
  }
  public void onFailure(Throwable thrown) {
    battleArchNemesis(); // escaped the explosion!
  }
}); 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-02-17T16:12:24.547

您可以扩展`FutureTask`类，并覆盖该`done()`方法，然后将`FutureTask`对象添加到`ExecutorService`，因此该`done()`方法将在`FutureTask`立即完成时调用。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-05-05T19:52:50.960

`ThreadPoolExecutor`还有可以覆盖和使用的钩子方法`beforeExecute`。`afterExecute`这是来自[Javadocs](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html)`ThreadPoolExecutor`的描述。

> ### 挂钩方法
> 
> 此类提供受保护的可重写[`beforeExecute(java.lang.Thread, java.lang.Runnable)`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html#beforeExecute-java.lang.Thread-java.lang.Runnable-)和[`afterExecute(java.lang.Runnable, java.lang.Throwable)`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html#afterExecute-java.lang.Runnable-java.lang.Throwable-)在执行每个任务之前和之后调用的方法。这些可用于操纵执行环境；例如，重新初始化`ThreadLocals`、收集统计信息或添加日志条目。此外，方法[`terminated()`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html#terminated--)可以被覆盖以执行任何需要在`Executor`完全终止后完成的特殊处理。如果钩子或回调方法抛出异常，内部工作线程可能会依次失败并突然终止。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-05T18:21:15.313

使用[**`CountDownLatch`**](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CountDownLatch.html).

它来自`java.util.concurrent`并且正是在继续之前等待多个线程完成执行的方式。

为了实现您所关注的回调效果，这确实需要一些额外的工作。也就是说，您自己在一个单独的线程中处理这个，该线程使用`CountDownLatch`并等待它，然后继续通知您需要通知的任何内容。没有对回调或任何类似效果的本地支持。

* * *

**编辑：**既然我进一步理解了您的问题，我认为您不必要地走得太远了。如果你接受一个常规的[**`SingleThreadExecutor`**](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Executors.html#newSingleThreadScheduledExecutor())，给它所有的任务，它会在本地进行排队。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-05T18:29:00.630

如果您想确保不会同时运行任何任务，请使用[SingleThreadedExecutor](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Executors.html#newSingleThreadExecutor())。任务将按照提交的顺序进行处理。您甚至不需要保留任务，只需将它们提交给执行官即可。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-03-19T17:30:12.717

这是使用 Guava 对 Pache 答案的扩展`ListenableFuture`。

特别是，`Futures.transform()`return `ListenableFuture`so 可用于链接异步调用。`Futures.addCallback()`return `void`，因此不能用于链接，但有利于处理异步完成时的成功/失败。

```
// ListenableFuture1: Open Database
ListenableFuture<Database> database = service.submit(() -> openDatabase());

// ListenableFuture2: Query Database for Cursor rows
ListenableFuture<Cursor> cursor =
    Futures.transform(database, database -> database.query(table, ...));

// ListenableFuture3: Convert Cursor rows to List<Foo>
ListenableFuture<List<Foo>> fooList =
    Futures.transform(cursor, cursor -> cursorToFooList(cursor));

// Final Callback: Handle the success/errors when final future completes
Futures.addCallback(fooList, new FutureCallback<List<Foo>>() {
  public void onSuccess(List<Foo> foos) {
    doSomethingWith(foos);
  }
  public void onFailure(Throwable thrown) {
    log.error(thrown);
  }
}); 
```

**注意：**除了链接异步任务之外，`Futures.transform()`还允许您将每个任务安排在单独的执行程序上（此示例中未显示）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-04-06T15:44:29.340

实现`Callback`机制的简单代码`ExecutorService`

```
import java.util.concurrent.*;
import java.util.*;

public class CallBackDemo{
    public CallBackDemo(){
        System.out.println("creating service");
        ExecutorService service = Executors.newFixedThreadPool(5);

        try{
            for ( int i=0; i<5; i++){
                Callback callback = new Callback(i+1);
                MyCallable myCallable = new MyCallable((long)i+1,callback);
                Future<Long> future = service.submit(myCallable);
                //System.out.println("future status:"+future.get()+":"+future.isDone());
            }
        }catch(Exception err){
            err.printStackTrace();
        }
        service.shutdown();
    }
    public static void main(String args[]){
        CallBackDemo demo = new CallBackDemo();
    }
}
class MyCallable implements Callable<Long>{
    Long id = 0L;
    Callback callback;
    public MyCallable(Long val,Callback obj){
        this.id = val;
        this.callback = obj;
    }
    public Long call(){
        //Add your business logic
        System.out.println("Callable:"+id+":"+Thread.currentThread().getName());
        callback.callbackMethod();
        return id;
    }
}
class Callback {
    private int i;
    public Callback(int i){
        this.i = i;
    }
    public void callbackMethod(){
        System.out.println("Call back:"+i);
        // Add your business logic
    }
} 
```

输出：

```
creating service
Callable:1:pool-1-thread-1
Call back:1
Callable:3:pool-1-thread-3
Callable:2:pool-1-thread-2
Call back:2
Callable:5:pool-1-thread-5
Call back:5
Call back:3
Callable:4:pool-1-thread-4
Call back:4 
```

关键说明：

1.  如果要按 FIFO 顺序依次处理任务，请替换`newFixedThreadPool(5)` 为`newFixedThreadPool(1)`
2.  如果您想在分析上一个任务的结果后处理下`callback`一个任务，只需在下面的行中取消注释

    ```
    //System.out.println("future status:"+future.get()+":"+future.isDone()); 
    ```

3.  您可以替换`newFixedThreadPool()`为其中之一

    ```
    Executors.newCachedThreadPool()
    Executors.newWorkStealingPool()
    ThreadPoolExecutor 
    ```

    取决于您的用例。

4.  如果要异步处理回调方法

    一个。将共享传递`ExecutorService or ThreadPoolExecutor`给 Callable 任务

    湾。将您的`Callable`方法转换为`Callable/Runnable`任务

    C。推送回调任务到 `ExecutorService or ThreadPoolExecutor`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-08-29T12:39:58.513

只是添加到马特的回答，这有帮助，这里有一个更充实的例子来展示回调的使用。

```
private static Primes primes = new Primes();

public static void main(String[] args) throws InterruptedException {
    getPrimeAsync((p) ->
        System.out.println("onPrimeListener; p=" + p));

    System.out.println("Adios mi amigito");
}
public interface OnPrimeListener {
    void onPrime(int prime);
}
public static void getPrimeAsync(OnPrimeListener listener) {
    CompletableFuture.supplyAsync(primes::getNextPrime)
        .thenApply((prime) -> {
            System.out.println("getPrimeAsync(); prime=" + prime);
            if (listener != null) {
                listener.onPrime(prime);
            }
            return prime;
        });
} 
```

输出是：

```
 getPrimeAsync(); prime=241
    onPrimeListener; p=241
    Adios mi amigito 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-01-09T18:00:59.370

您可以使用 Callable 的实现，这样

```
public class MyAsyncCallable<V> implements Callable<V> {

    CallbackInterface ci;

    public MyAsyncCallable(CallbackInterface ci) {
        this.ci = ci;
    }

    public V call() throws Exception {

        System.out.println("Call of MyCallable invoked");
        System.out.println("Result = " + this.ci.doSomething(10, 20));
        return (V) "Good job";
    }
} 
```

CallbackInterface 是非常基本的东西

```
public interface CallbackInterface {
    public int doSomething(int a, int b);
} 
```

现在主类看起来像这样

```
ExecutorService ex = Executors.newFixedThreadPool(2);

MyAsyncCallable<String> mac = new MyAsyncCallable<String>((a, b) -> a + b);
ex.submit(mac); 
```

# c# - 在 C# 中选择要与之聊天的人

> ID：826213
> 
> 赞同：0
> 
> 时间：2009-05-05T18:14:04.333
> 
> 标签：c#, chat

考虑一个有很多人在线的局域网信使的情况。我需要选择一个特定的人来聊天。我必须如何在 C# 中这样做？我想要的是通过点击他的名字来选择一个特定的人。之后我必须发送我输入的任何内容，就像在 IP Lanmessenger 软件的情况下一样（希望你们已经使用它）。有人可以帮我吗。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T18:48:10.240

如果您想跟踪用户，我建议编写一个服务器应用程序来处理所有连接。这是一个简单的例子（注意这不是一个完整的例子）：

```
using System.Collections.Generic;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading;

private TcpListener tcpListener;
private Thread listenerThread;
volatile bool listening;

// Create a client struct/class to handle connection information and names
private List<Client> clients;

// In constructor
clients = new List<Client>();
tcpListener = new TcpListener(IPAddress.Any, 3000);
listening = true;
listenerThread = new Thread(new ThreadStart(ListenForClients));
listenerThread.Start();

// ListenForClients function
private void ListenForClients()
{
    // Start the TCP listener
    this.tcpListener.Start();

    TcpClient tcpClient;
    while (listening)
    {
        try
        {
            // Suspends while loop till a client connects
            tcpClient = this.tcpListener.AcceptTcpClient();

            // Create a thread to handle communication with client
            Thread clientThread = new Thread(new ParameterizedThreadStart(HandleMessage));
            clientThread.Start(tcpClient);
        }
        catch { // Handle errors }
    }
}

// Handling messages (Connect? Disconnect? You can customize!)
private void HandleMessage(object client)
{
    // Retrieve our client and initialize the network stream
    TcpClient tcpClient = (TcpClient)client;
    NetworkStream clientStream = tcpClient.GetStream();

    // Create our data
    byte[] byteMessage = new byte[4096];
    int bytesRead;
    string message;
    string[] data;

    // Set our encoder
    ASCIIEncoding encoder = new ASCIIEncoding();

    while (true)
    {
        // Retrieve the clients message
        bytesRead = 0;
        try { bytesRead = clientStream.Read(byteMessage, 0, 4096); }
        catch { break; }

        // Client had disconnected
        if (bytesRead == 0)
            break;

        // Decode the clients message
        message = encoder.GetString(byteMessage, 0, bytesRead);
        // Handle the message...
    }
} 
```

现在再次注意这不是一个完整的例子，我知道我已经全力以赴，但我希望这能给你一个想法。HandleMessage 函数中的消息部分可以是用户的 IP 地址，如果他们正在连接到聊天服务器/断开连接，以及您要指定的其他参数。这是从我为我父亲的公司编写的应用程序中提取的代码，以便员工可以直接从我编写的自定义 CRM 相互发送消息。如果您还有任何问题，请发表评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T18:33:57.077

如果您正在构建用于聊天的 UI，并且您希望看到所有在线的人，典型的 UI 元素将是一个列表框，然后是在框中的项目的 On_Click 上触发的代码。该代码可以打开另一个 UI 元素来开始聊天。

获取登录用户列表更难。您将需要实现某种观察者/订阅者模式来处理来自您正在实现的聊天协议的通知。

GeekPedia 有一个关于[在 C# 中创建聊天客户端和服务器](http://www.geekpedia.com/tutorial239_Csharp-Chat-Part-1---Building-the-Chat-Client.html)的精彩系列。

# asp.net - ASP.NET 开发 Web 服务器坏了

> ID：826222
> 
> 赞同：0
> 
> 时间：2009-05-05T18:14:56.343
> 
> 标签：asp.net, web-services, .net-2.0, webserver

我有带有 v2.0 框架的 VS 2005。然后我最近安装了 NDoc，它只支持 v1.1，所以它在 v2.0 之上安装了 v1.1。这很好，因为这两个版本可以共存，但它所做的是搞砸了一些设置：

a) ASP.NET 附带的 Web 服务器，即您在调试模式下运行 Web 服务的服务器。

b) SQL Server 的活动 CLR 设置（但这并没有让我很困扰）

c) IIS 设置（但我通过使用 2.0 重新注册 IIS 来解决此问题）

现在最困扰我的是损坏的 ASP.NET Web 服务器不允许我调试我的 Web 服务，甚至不允许在同一解决方案中的另一个项目创建对它的 Web 引用。

因此，我无法在 Visual Studio 中生成代理，也无法在同一解决方案中设置对 Web 服务的 Web 引用（因为它涉及生成代理）。

请注意，我可以调用 wsdl.exe。但我还不想部署我的服务。我只希望同一解决方案中的所有项目都像乖巧的小孩一样引用 ws。

当我尝试在我的解决方案中创建对 WS 项目的 Web 引用时，我不断收到此错误：

## “/”应用程序中的服务器错误。

解析器错误描述：解析服务此请求所需的资源时发生错误。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

解析器错误消息：无法创建类型“DaWS.PhoneDirectory”。

源错误：

第 1 行：<%@ WebService Language="C#" CodeBehind="PhoneDirectory.asmx.cs" 第 2 行：Class="DaWS.PhoneDirectory" %>

源文件：/PhoneDirectory.asmx 行：2

* * *

版本信息：Microsoft .NET Framework 版本：2.0.50727.3082；ASP.NET 版本：2.0.50727.3082

这几天一直困扰着我，我一直在管理 IIS 中的部署。

除了重新安装 Visual Studio 之外，有没有人有更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T18:18:13.543

创建一个新的 Web 服务，并且根本不要更改它。看看它是否有效。

顺便说一句，此页面显示 .NET 2.0 而不是 1.1 的事实表明版本不是问题。

# delphi - 访问 TClientDataSet 的 TDateField 的 OldValue 时，'0.0' 不是有效的时间戳

> ID：826231
> 
> 赞同：2
> 
> 时间：2009-05-05T18:17:16.570
> 
> 标签：delphi, delphi-2009, vcl

当我在 TClientDataSet 中新插入的记录中使用以下代码时：

```
cdsMyDateField.OldValue <> Null 
```

我得到一个 EConvertError：

```
''0.0' is not a valid timestamp'. 
```

查看 Delphi 的 VCL 代码，它尝试将值转换为导致此异常的 TDateTime，因为值 (Null) 是无效的 DateTime，但是当我比较 Variants 时，我认为它会返回一个变体，即 Null在这种情况下，但这并没有发生，而是我得到了这个异常。

我知道我可以在比较值之前检查 DataSet.State = dsInsert 是否，好像 State = dsInsert 每个 OldValue 都是 Null，但我想了解为什么 OldValue 尝试转换值而不是全部返回 Null State = dsInsert 时的字段。

任何人都可以给我一些光吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T10:42:46.010

FWIW，我遇到了同样的问题，这让我很头疼。我的意见：这种行为是不一致的，所以即使仅从这个原因我也将其归类为错误。这也是一个错误，因为在读取属性时引发异常是恕我直言，这很荒谬，并且不符合属性的意图（最不意外的原则。）我希望 OldValue 是未分配的，而不是在读取时引发异常。（此外，某些问题已经存在很长时间这一事实并不意味着它是否是一个错误。）

**（编辑：用更多信息更新我的答案，包括我们的解决方法。也发布到 QC 报告中：http: [//qc.embarcadero.com/wc/qcmain.aspx](http://qc.embarcadero.com/wc/qcmain.aspx?d=73852) ?d=73852 ）**

我们在一个大量使用数据快照/客户端数据集的应用程序中也遇到了同样的问题。然而，实际问题不在于客户端数据集，而在于 SysUtils 中的时间戳验证例程，该例程显然错误地将值为 0.0 的时间戳验证为无效。

因此，解决方法/修复是针对 SysUtils 和验证例程，而不是针对 Tclientdataset 具体而言，在验证例程“ValidateTimeStamp()”中，时间部分正确比较 < 0，但日期部分错误比较 <= 0。

因此，（合法的）0.0 日期时间值有时会转换为 datepart = 0 的时间戳，并且当再次反向验证该值时（例如从此处和 QC 报告中所示的数据集字段读取值时）， （错误地）引发了异常。因此，将时间戳的日期部分的验证更改为使用严格小于的简单修复，修复了 TClientDataset 暴露的问题。

这是我们的解决方法，基于 Delphi 7.1

```
(* SysUtils.pas line 10934 (Delphi 7.1)  *)
(**)(* fix - Timestamp values 0.0 erroneously designated as invalid *)
(* D7.1 *)
(* Walter Prins, originally patched May 2005, submitted 4 June 2009 *)
procedure ValidateTimeStamp(const TimeStamp: TTimeStamp);
begin
  if (TimeStamp.Time < 0) or (TimeStamp.Date < 0) then (* Changed TimeStamp.Date <= 0 to TimeStamp.Date < 0 *)
    ConvertErrorFmt(@SInvalidTimeStamp, [TimeStamp.Date, TimeStamp.Time]);
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T19:46:58.353

Delphi 中的 TDateTime 是双精度数，其中日期存储在整数部分，时间存储在小数部分。因此，在某种程度上，将空日期值转换为 0.0 是正确的。由于您访问的基础字段是 TDateField（或 TDateTime 字段），它可能在内部进行转换。

此外，针对 Null 检查 Variant 不再是 Delphi 中的正确方法。Null 变体仍被分配，但具有 Null 值，而未分配的变体没有值。（想想 SQL 数据库的 NULL 值）。改用 Variants.pas 单元中的 VarIsNull(const V: Variant) 函数；如果变体为空，则返回 true，如果有任何其他值，则返回 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T20:03:59.250

我在激活 Debug DCUs 选项的情况下调试了下面的代码，奇怪的是 SysUtils.ValidateTimeStamp 将 date = 0 的 TimeStamp 评估为无效，因此抛出 EConvertError 异常（而不是返回 Null 或 Unassigned）。

所以最终结果是对 dsInsert 状态下的空字段执行 OldValue 请求是无效的。该变体**永远不会**返回，因此如果您使用 (field.OldValue <> Null) 或 VarIsNull(field.OldValue) 对其进行测试，则它是无关紧要的。之前抛出异常。

cds_something 有两个字段（在设计时创建）：

*   dt_Something
*   num_something

代码：

```
var
  b: TClientDataset;
begin
  b := cds_somethin;
  b.Close;
  b.CreateDataSet;
  b.Insert;
  if b.FieldByName('DT_Sometinhg').OldValue <> Null then
    ShowMessage('Something wrong!!!')
  else
    ShowMessage('Normal');

  b.Cancel; 
```

注意：我把这篇文章的原始编辑搞砸了。现在这是对我发现的正确解释。

另外：使用其他一些字段类型（字符串、BCD、浮点数和备忘录）进行测试，并且 OldValue 未分配 - 所以上面的测试将评估为假。

似乎只有 TDateField 和 TDateTimeField 显示该行为。TTimeField 和 TSQLTimeStamp 评估正常 - 但 TSQLTimeStampField.OldValue 既不等于 Null 也不等于 Unassigned (wtf!!)...

代码片段发生了一些变化：

```
var
  b: TClientDataset;
begin
  b := cds_somethin;
  b.Close;
  b.CreateDataSet;
  b.Insert;
  /*
  if (b.FieldByName('DT_Something').OldValue <> Null) 
     and (b.FieldByName('DT_Something').OldValue <> Unassigned)  then
    ShowMessage('Something wrong!!!')
  else
    ShowMessage('Normal');
  */
  if (b.FieldByName('ts_Something').OldValue <> Null) 
     and (b.FieldByName('ts_Something').OldValue <> Unassigned)  then
    ShowMessage('Something wrong!!!')
  else
    ShowMessage('Normal');

  b.Cancel; 
```

其中 ts_Something 是 TSQLTimeStampField。这些字段是在设计时创建的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-21T18:36:15.333

这是 Midas/TClientDataSet 上与记录缓冲区相关的错误。当您多次执行 AppendData 时，InternalCalc 字段显示为“非空”（记录缓冲区中的空标志错误）。在 Delphi 2010 中，我们可以研究 Midas.dll 源代码（.cpp 文件）。

[http://img514.imageshack.us/img514/2840/wrongnull.jpg](http://img514.imageshack.us/img514/2840/wrongnull.jpg)

我正在研究如何实施解决方案。

阿尔冈萨雷斯。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-06T10:07:42.107

在 Delphi 2009 update 2 和 Delphi 2007 中复制如下：

```
uses DB, DBClient;
procedure TTestForm1.TestButtonClick(Sender: TObject);
const
  SMyDateField = 'MyDateField';
  SMyIntegerField = 'MyIntegerField';
var
  MyClientDataSet: TClientDataSet;
  MyClientDataSetMyDateField: TField;
  MyClientDataSetMyIntegerField: TField;
  OldValue: Variant;
begin
  MyClientDataSet := TClientDataSet.Create(Self);
  MyClientDataSet.FieldDefs.Add(SMyDateField, ftDate);
  MyClientDataSet.FieldDefs.Add(SMyIntegerField, ftInteger);
  MyClientDataSet.CreateDataSet();
  MyClientDataSetMyDateField := MyClientDataSet.FieldByName(SMyDateField);
  MyClientDataSetMyIntegerField := MyClientDataSet.FieldByName(SMyIntegerField);
  MyClientDataSet.Insert();
  OldValue := MyClientDataSetMyIntegerField.OldValue;
  OldValue := MyClientDataSetMyDateField.OldValue;
end; 
```

你总是得到这个错误：

```
exception class EConvertError with message ''0.0' is not a valid timestamp'. 
```

我不确定这是否被视为错误：

*   **插入时从技术上讲没有 OldValue，因此获取它可能会引发异常**
*   MyClientDataSetMyIntegerField.OldValue 返回 0，但 MyClientDataSetMyDateField.OldValue 引发异常

还有一些注意事项：

*   TCustomClientDataSet.GetFieldData 将获取实际的底层数据
*   TDataSet.DataConvert 将底层数据转换为本机数据格式，在需要时执行有效性检查

**编辑**：由于 Fabricio 的评论，我强调 OldValue 在插入后在技术上是无效的。所以从技术上讲，这可能不是一个错误。

他的“新证据”可以通过检查 VCL/RTL 来源来验证：

对于字段类型 ftDate、ftTime、ftDateTime，TDataSet.DataConvert 调用其本地 NativeToDateTime 函数，该函数填充 TimeStamp，然后使用 SysUtils.TimeStampToDateTime 转换它，然后调用 SysUtils.ValidateTimeStamp，当时间部分小于零时引发异常，或者日期部分小于或等于零。

只有字段类型 ftDate 和 ftDateTime（TDateField 和 TDateTimeField）的 Date 部分才能变为零，因此只有那些可以引发异常。对于所有其他数据类型，NativeToDateTime 不会有问题：这些类型都允许使用零字节填充结果。

我刚刚检查了 RTL/VCL 历史记录：由于 Delphi 6 SysUtils.TimeStampToDateTime 调用 SysUtils.ValidateTimeStamp，所以这种行为自 2001 年以来一直是相同的。

这使得很难将其视为错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-21T19:00:04.620

我在 MySQL 中使用 delphi 2007，我的解决方案是：

在我使用的 MySQL 查询中：

```
select CAST(dateField AS CHAR) from table_name 
```

...使用 CAST 我将字段转换为字符串值，我可以测试该值是否为`0000-00-00`...，然后使用字段的实际值。

# functional-programming - 我在哪里可以获得更多关于同音性的信息？

> ID：826240
> 
> 赞同：1
> 
> 时间：2009-05-05T18:19:29.513
> 
> 标签：functional-programming, homoiconicity

我一直在尝试函数式编程，但我仍然不理解这个概念。你们知道任何讨论这个概念的好书、教程或例子吗？或者，如果您可以展示有关其用法的小片段，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T18:25:09.003

学习lisp或scheme。语言就是数据结构就是语言。Lisp 代码和 Lisp 数据结构具有相同的语法规则。

如果您学习 tcl，则可以使用一种程序化语言，**并且**数据结构语法规则与编程语言语法规则相同。

严格来说，这不是函数式编程问题。对于一些数据的语法规则和语言的语法规则相同的语言来说，这更是一个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T20:28:17.177

我相信[John Hughes的](http://www.cs.chalmers.se/~rjmh/)[Why Functional Programming Matters](http://www.math.chalmers.se/~rjmh/Papers/whyfp.pdf)是最好的之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T20:44:45.063

维基百科：[http://en.wikipedia.org/wiki/Homoiconic](http://en.wikipedia.org/wiki/Homoiconic)

C2 维基：[http://c2.com/cgi/wiki?HomoiconicLanguages](http://c2.com/cgi/wiki?HomoiconicLanguages)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-08T01:34:40.023

[REBOL](http://www.rebol.com)是一种谐音语言。REBOL 中的`block!`数据类型是一组方括号，其中包含任何有效的 REBOL 标记，类似于 Lisp 中的 S 表达式。例如：

```
series: [1 2 3 4]
foreach item series [
    print item
] 
```

现在，让我们用不同的方式表达：

```
series: [1 2 3 4]
for-body: [print item] ; This is the body of our foreach
foreach item series for-body 
```

尽管它被声明为数据，`for-body`但当我们将块传递给`foreach`函数时，我们将其视为代码。如果我们问 REBOL 块中第一项的类型是什么`for-body`——`type? first for-body`它会告诉我们`word!`而不是`function!`（或`native!`或`action!`或任何其他 REBOL 函数类型）。原因是，作为数据，`for-body`它只是一个未评估的 REBOL 词块。当我们将它传递给`foreach`then 时，它才会被评估为代码。

有些人称REBOL“像Lisp，但没有括号”，我个人更喜欢它而不是Lisp，但你可能不喜欢。尽管如此，当你想学习同音性时，它仍然是一门很棒的语言，我觉得这个主题很吸引人。

# java - 在 Java 中构造一个列表

> ID：826246
> 
> 赞同：5
> 
> 时间：2009-05-05T18:21:41.880
> 
> 标签：java, collections, list, guava

假设我有一个`java.util.List list`并且我想通过在开头`List`添加一个元素来创建一个新的（即，我想要*cons*和）。例如，如果是`e``list` *`e``list``list`*

 *```
[1,2,3,4] 
```

并且`e`是`5`, 那么`cons(e,list)`将是

```
[5,1,2,3,4] 
```

`list`和的元素`cons(e,list)`可以共享，但`list`不能修改。

什么是最简单和/或最有效的实施方式`cons`？结果不可修改是可以的。允许使用 Google 收藏库。

如果`list`是 a`com.google.common.collect.ImmutableList`怎么办？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T18:35:48.663

```
public static<T> List<T> cons(List<T> list, T t) {
    ArrayList<T> result = new ArrayList<T>(list);
    result.add(0, t);
    return result;
} 
```

针对评论进行编辑：由于问题要求“实现缺点的最简单和/或最有效的方法”，我选择了“最简单”。得知有更有效的方法，我不会感到惊讶。将元素放在列表之前是另一种有效的方法，最初分配正确的大小可能会提高性能。过早的优化是万恶之源。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T18:45:20.513

[Clojure](http://clojure.org)提供了那种 Lisp-y 的东西。虽然大多数人都认为将 Clojure 用于该语言（就像我一样），但 Clojure 库都是真正的 Java 代码，如果您愿意，您可以将 Java 中的数据结构用作一个特殊的库。这样，您将获得执行 cons 等操作的能力，并且获得 Clojure 使用的不变性。Clojure 数据结构也实现了等效的 Java 类型。

只是一个不同方向的想法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-06T10:11:05.630

我相信您真正想要的答案是：

[http://functionaljava.googlecode.com/svn/artifacts/2.20/javadoc/fj/data/List.html](http://functionaljava.googlecode.com/svn/artifacts/2.20/javadoc/fj/data/List.html)

该方法甚至被调用`cons`。

我对这个图书馆没有经验。前几天刚听说。我希望它是好的！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-04-14T02:03:53.447

一个有效的解决方案是创建自己的 List 实现，懒惰地委托。如果不可修改，那也不会太麻烦。如果通过工厂方法创建，那么您甚至可以使用两种不同的底层实现之一，具体取决于参数 List 是否实现 RandomAccess。

对于最简单的情况（尚未检查是否编译，没有完整性检查等）：

```
class ConsList<E> extends AbstractList<E>
{
    private final E first;
    private final List<E> rest;

    ConsList( E first, List<E> rest )
    {
        this.first = first;
        this.rest = rest;
    }

    public int get( int index )
    {
        return (index == 0) ? first : rest.get( index - 1 );
    }

    public int size()
    {
        return rest.size() + 1;
    }
} 
```

我确信其他一些方法可以提高效率，并且通过扩展 AbstractSequentialList 可以更好地服务于顺序情况。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T23:19:44.253

因为您提到了该`cons`函数，所以我假设您正在使用由单元格组成的链表的概念模型来解决这个问题`cons`。具体来说，我假设您正在考虑每个列表都有一个`car`（第一个元素）和一个`cdr`（包含所有后续元素的子列表）。

Java 支持链表作为`java.util.LinkedList`. 这些对于线性遍历很有用，并且可以非常有效地插入元素。这些与我上面提到的链表最相似。

Java 还提供`java.util.ArrayList`. 这种列表适合随机访问，但在插入元素时可能会很慢。事实上，在列表开头插入元素时，它们的速度最慢。因为`ArrayList`s 在幕后实现为数组，所以每个元素都必须在列表中向前复制一个位置，以便为新的第一个元素腾出空间。现在，如果您还碰巧需要一个更大的数组，`ArrayList`则将分配一个新数组，将所有元素复制过来，依此类推。

（谷歌`ImmutableList`被称为“随机访问”，因此它可能更类似于后者。）

如果您打算`cons`经常使用您的方法，我建议将它与链表一起使用。`cons`操作本质上是在列表的开头添加一个元素。这对于诸如数组之类的线性结构几乎没有意义。出于这个原因，我建议不要使用数组列表：它们在概念上不适合这项工作。

*对于非常挑剔的人：因为每次调用都会返回一个新列表，所以无论列表是 a还是 an`cons`都必须进行复制。但是，操作的全部原理是它在链表上进行操作。`LinkedList``ArrayList``cons`*

```
public <E> LinkedList<E> cons(E car, List<E> cdr) {
    LinkedList<E> destination = new LinkedList<E>(cdr);
    destination.addFirst(car);
    return destination;
} 
```

*请注意，上述代码是在阅读上述答案后编写的，因此对于任何意外抄袭，我深表歉意。如果你看到它，请告诉我，我会正确承认。*

假设您对返回 a 感到满意`LinkedList`，您可以在本例中使用`ImmutableList`as 。`cdr`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-15T16:29:46.847

这并不为人所知，但 Sun javac 编译器 API 包含一个不可变的 List 实现，它使用`append()`和之类的方法返回新的不可变列表`prepend()`。要使用它，您需要`tools.jar`在类路径上，以及这个 import 语句：

```
import com.sun.tools.javac.util.List; 
```

**示例代码：**

```
final List<Integer> list = List.of(6, 7);
System.out.println(list);

final List<Integer> newList =
    list.prepend(5)                       // this is a new List
        .prependList(List.of(1, 2, 3, 4)) // and another new List
        .append(8)                        // and another
        .reverse();                       // and yet another
System.out.println(newList);

System.out.println(list == newList);

System.out.println(list.getClass());
System.out.println(newList.getClass()); 
```

**输出：**

> 6,7
> 8,7,6,5,4,3,2,1
> false
> class com.sun.tools.javac.util.List
> class com.sun.tools.javac.util.List

我知道这是一个内部 API，不应该在生产中使用，但它非常有趣（最后是一个感觉正确的 java 集合）。

**注意：**显然，来自`Collection`和`List`接口的所有标准可变方法（如`add()` `addAll()`） throw 。`UnsupportedOperationException`

**参考：**

*   [`com.sun.tools.javac.util.List`](http://www.docjar.com/docs/api/com/sun/tools/javac/util/List.html) （在[DocJar](http://www.docjar.com/)上）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-05T19:10:29.393

我将投入我的 2 美分，然后看看是否有人想出更优雅的东西。在一般情况下：

```
<E> List<E> cons(E e, List<E> list) {
    List<E> res = Lists.newArrayListWithCapacity(list.size() + 1);
    res.add(e);
    res.addAll(list);
    return res;
} 
```

有一个`ImmutableList`（不知道这有多有效）：

```
<E> ImmutableList<E> cons(E e, ImmutableList<E> list) {
    return ImmutableList.<E>builder()
                        .add(e)
                        .addAll(list)
                        .build();
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-05T18:26:36.470

你可以使用[CompositeCollection](http://commons.apache.org/collections/api-release/org/apache/commons/collections/collection/CompositeCollection.html)吗？

```
public Collection cons(Collection c1, Collection c2)
{
    CompositeCollection cons = new CompositeCollection();
    cons.addComposited(c1);
    cons.addComposited(c2);
    return cons;
} 
```

这不会受到参数之一是否不可变并且仍然由原始集合 c1 和 c2 支持的影响。

如果您需要，`List`我可能会执行以下操作：

```
public List cons(Collection c1, Collection c2)
{
    ArrayList cons = new ArrayList(c1.size() + c2.size());
    cons.addAll(c1);
    cons.addAll(c2);
    return cons;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-05T22:20:48.467

LinkedList 肯定是在列表开头插入项目的最有效方式吗？

只需使用 Java 自带的[LinkedList](http://java.sun.com/javase/6/docs/api/java/util/LinkedList.html)类

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-07T19:57:11.167

如果您只有 Iterable，则另一种变体。

```
public static <E> List<E> cons(E e, Iterable<E> iter) {
   List<E> list = new ArrayList<E>();
   list.add(e);
   for(E e2: iter) list.add(e2);
   return list;
}

public static <E> List<E> cons(Iterable<E>... iters) {
   List<E> list = new ArrayList<E>();
   for(Iterable<E> iter: iters) for(E e1: iter1) list.add(e1);
   return list;
} 
```

# wpf - 任何人都有调试WPF焦点的好方法？

> ID：826249
> 
> 赞同：6
> 
> 时间：2009-05-05T18:22:25.000
> 
> 标签：wpf, debugging, focus

我现在将在我的 WPF 应用程序中专注于地狱。焦点在元素之间跳来跳去，似乎消失了，只是在反复按下 Tab 键时才出现在另一个元素上。

有没有我可以绑定标签的属性，或者只是告诉我当时键盘焦点锁定在什么上的东西？有时我可以看到蚂蚁轨迹（虚线）表明某物有焦点，但我不知道它在关闭键盘焦点的周围是什么！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T22:23:06.543

您可能正在寻找的是：

(System.Windows.Input.Keyboard.FocusedElement 作为 FrameworkElement).Name

您必须为其设置一个 DependencyProperty，以便您可以绑定到它。

瓦卡诺

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T20:14:28.660

焦点问题可能很难分析，因为您使用调试器所做的几乎所有事情都会影响焦点。

*   **Visual Studio 附带的spy++**副本将向您展示前往各种控件的事件；这可能会有所帮助。
*   您可以将焦点和失去焦点事件记录到另一个地方（如另一个窗口中的列表控件）。甚至将当前窗口标题设置为当前具有焦点的对象的名称。然后，您可以了解当前关注的内容。

一个更好的问题是为什么焦点会跳来跳去？您是否明确设置焦点？也许关于您的实现的一点提示（即您正在使用哪个容器）可能会帮助我们回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-31T19:43:05.603

我强烈推荐阅读这篇文章。它附带了一些可以帮助调试焦点问题的源代码，我经常最终使用这些代码来帮助解决我自己的焦点问题。

[http://julmar.com/blog/programming/part-1-its-basically-focus/](http://julmar.com/blog/programming/part-1-its-basically-focus/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T08:02:25.760

也许您可以尝试为控件的 TabIndex 属性设置适当的值？这应该使焦点“跳转”到您希望它在按 Tab 时跳转的“路径”上。

# wpf - WPF - 无法转换' '来自类型' ' 键入 'System.Uri'

> ID：826255
> 
> 赞同：1
> 
> 时间：2009-05-05T18:23:06.713
> 
> 标签：wpf, data-binding

我有一个简单的用户控件来在文本块中显示超链接：

LinkTextBlock.xaml：

```
<TextBlock >
    <Hyperlink NavigateUri="{Binding Url, ElementName=root}" >
        <TextBlock Text="{Binding Text, ElementName=root}" />
    </Hyperlink>   
</TextBlock> 
```

LinkTextBlock.xaml.cs：

```
public static readonly DependencyProperty UrlProperty = DependencyProperty.Register("Url", typeof (string), typeof (LinkTextBlock));
public string Url
{
    get { return (string) GetValue(UrlProperty); }
    set { SetValue(UrlProperty, value); }
}
public static readonly DependencyProperty TextProperty = DependencyProperty.Register("Text", typeof (string), typeof (LinkTextBlock));
public string Text
{
    get { return (string) GetValue(TextProperty); }
    set { SetValue(TextProperty, value); }
} 
```

然后，在 ListBox 的 DataTemplate 中，我有：

```
<Controls:LinkTextBlock Text="{Binding Email}" Url="{Binding Email}" /> 
```

当我运行该应用程序时，它似乎运行良好。该控件正确显示了超链接，并且没有明显的问题。但是，当我查看“输出”窗口时，我得到了异常，每个 ListBox 项都有一个：

> System.Windows.Data 错误：22：无法将 '' 从类型 '' 转换为具有默认转换的 'en-US' 文化类型的 'System.Uri'；考虑使用 Binding 的 Converter 属性。NotSupportedException:'System.NotSupportedException: UriTypeConverter 无法从 (null) 转换。在 System.ComponentModel.TypeConverter.GetConvertFromException(Object value) 在 System.ComponentModel.TypeConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfoculture, Object value) 在 System.UriTypeConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfoculture, Object value) 在 MS.Internal .Data.DefaultValueConverter.ConvertHelper(Object o, Type destinationType, DependencyObject targetElement, CultureInfoculture, Boolean isForward)'

为什么会这样？我知道绑定错误是绑定到 NavigateURI 的结果。你对我有什么建议吗？我能做些什么呢？我非常感谢您的意见。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T19:12:07.830

我想到了。问题是在执行从字符串到 Uri 的隐式转换时，因为 NavigateUri 是 Uri 类型。我需要创建一个转换器来将字符串转换为 Uri，将我的属性从 String 更改为 Uri，并且一切正常，无一例外。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-05T18:28:32.490

这不应该

```
<TextBlock >
    <Hyperlink NavigateUri="{Binding Url, ElementName=root}" >
        <TextBlock Text="{Binding Text, ElementName=root}" />
    </Hyperlink>   
</TextBlock> 
```

是这个吗？

```
<TextBlock  Text="{Binding Text, ElementName=root}">
    <Hyperlink NavigateUri="{Binding Url, ElementName=root}" />
</TextBlock> 
```

# java - applicationContext.xml bean的swing编辑器ui？

> ID：826259
> 
> 赞同：3
> 
> 时间：2009-05-05T18:24:55.930
> 
> 标签：java, spring

我在春季论坛上问过这个问题，但没有得到答案，我刚刚发现了 stackoverflow，所以我会在这里尝试。

我正在使用弹簧 2.0.5。在我的应用程序中，我需要让用户添加/修改/删除（通过 UI）在 applicationContext.xml 文件中描述的 bean。要编辑的 bean 都属于同一类（实际上就像一个 db table crud 编辑器，但开发速度更快，代码更容易进化）。

我一直在搜索网络和论坛，找不到任何现有代码。我想我的需求很常见，有人知道我可以利用的一些代码吗？

如果没有，是否至少有一种方法可以从 java bean 中获取 xml（作为字符串）元素？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T19:49:30.563

Eclipse的[Spring IDE 插件](http://springide.org/blog/)具有用于编辑应用程序上下文的工具，并且源代码可用，因此这可能是一个开始的地方。

我不相信有一种方法可以从例如 BeanFactory 对象中获取 XML bean 定义。请记住，给定的 bean 甚至可能没有 XML 定义；例如，它可能是自动接线的。

另一种方法可能是使用诸如[Dom4J](http://www.dom4j.org/)之类的库来解析和操作 applicationContext.xml 文件的 XML。您可以通过执行以下操作轻松获得特定的 bean 定义，例如，

`document.selectSingleNode("//bean/beans[name='beanNameIWantToEdit']")`

然后您可以更改该节点上的属性等。您还可以通过执行获取该节点的完整 XML 文本`node.asXML()`。

# tfs - 是否可以将工作项模板从一个项目复制到另一个项目？

> ID：826263
> 
> 赞同：5
> 
> 时间：2009-05-05T18:25:21.997
> 
> 标签：tfs

有问题的两个项目是从同一个基本模板创建的。从本质上讲，我已经在几个工作项模板中删除了一堆我们不需要的东西，并删除了一些其他的东西。我想将这些模板更改复制到另一个项目，而不是重做我刚刚完成的所有工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T18:41:18.777

如果已经在服务器上创建了另一个项目，则可以使用[Team Foundation Server Power Tools](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)。您想要的工具是流程编辑器。

安装后。启动 Visual Studio 并连接到 Team Explorer。然后转到工具 | 流程编辑器 | 工作项目类型 | 导入 WIT

选择工作项类型模板和您想要安装它的项目。

或者，如果您更喜欢命令行解决方案，请使用 witimport：

**witimport /f 文件 /t TeamFoundationServer /p teamproject [/v] [/e 编码]**

/f 指定要导入的工作项类型 XML 定义文件。

/t 指定 Team Foundation Server 的名称。这也可以是完全指定的 URL，例如[http://server:8080](http://server:8080)。

/p 指定要导入文件的 Team Foundation Server 上的团队项目。

/v 在不导入工作项类型的情况下验证 XML。

/e 指定用于导入工作项类型 XML 的 .NET Framework 2.0 编码的名称。例如，/e utf-7 将使用 Unicode (UTF-7) 编码。在可能的情况下，默认情况下会自动检测编码。如果不可用，编码默认为 UTF-8。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T04:45:19.260

这个工具也确实有帮助： [http ://witsynchronizer.codeplex.com/](http://witsynchronizer.codeplex.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T18:30:46.057

是的，模板位于您的本地计算机上，您应该可以从那里复制它。我在 Documents\Work Item Templates 中。

# php - 简单的 PHP 表单：电子邮件附件（代码高尔夫）

> ID：826265
> 
> 赞同：25
> 
> 时间：2009-05-05T18:25:41.310
> 
> 标签：php, email, email-attachments, code-golf, mail-form

想象一个用户想在他们的网站上放置一个表单，允许网站访问者上传一个文件和一个简单的消息，这些消息将立即通过电子邮件发送（即，文件没有存储在服务器上，或者如果它是仅暂时）作为文件附件，在邮件正文中带有注释。

[在http://a2zsollution.com/php-secure-e-mail/](http://a2zsollution.com/php-secure-e-mail/)上查看更多详细信息

完成此任务的最简单方法是什么？

最简单的方面：

*   尺寸（代码高尔夫）
*   易于实施（理想情况下都在一个文件中，几乎不需要外部资源）
*   不为混淆而混淆（大小的权衡很好）
*   自包含示例（如果在没有表单帖子的情况下调用，它会显示表单）

这几乎与以下内容相反：[如何从 PHP 获取电子邮件及其附件](https://stackoverflow.com/questions/114953/how-to-get-email-and-their-attachments-from-php)。[它几乎可以在Compiling email with multiple attachments in PHP](https://stackoverflow.com/questions/720455/compiling-email-with-multiple-attachments-in-php)中得到回答，但它实际上并没有显示代码。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-11-04T11:41:27.663

只是为了好玩，我想我会把它敲起来。它最终比我想象的更棘手，因为我没有完全理解边界部分是如何工作的，最终我发现开始和结束“--”很重要，然后就走了。

```
<?php
    if(isset($_POST['submit']))
    {
        //The form has been submitted, prep a nice thank you message
        $output = '<h1>Thanks for your file and message!</h1>';
        //Set the form flag to no display (cheap way!)
        $flags = 'style="display:none;"';

        //Deal with the email
        $to = 'me@example.com';
        $subject = 'a file for you';

        $message = strip_tags($_POST['message']);
        $attachment = chunk_split(base64_encode(file_get_contents($_FILES['file']['tmp_name'])));
        $filename = $_FILES['file']['name'];

        $boundary =md5(date('r', time())); 

        $headers = "From: webmaster@example.com\r\nReply-To: webmaster@example.com";
        $headers .= "\r\nMIME-Version: 1.0\r\nContent-Type: multipart/mixed; boundary=\"_1_$boundary\"";

        $message="This is a multi-part message in MIME format.

--_1_$boundary
Content-Type: multipart/alternative; boundary=\"_2_$boundary\"

--_2_$boundary
Content-Type: text/plain; charset=\"iso-8859-1\"
Content-Transfer-Encoding: 7bit

$message

--_2_$boundary--
--_1_$boundary
Content-Type: application/octet-stream; name=\"$filename\" 
Content-Transfer-Encoding: base64 
Content-Disposition: attachment 

$attachment
--_1_$boundary--";

        mail($to, $subject, $message, $headers);
    }
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>MailFile</title>
</head>

<body>

<?php echo $output; ?>

<form enctype="multipart/form-data" action="<?php echo $_SERVER['PHP_SELF'];?>" method="post" <?php echo $flags;?>>
<p><label for="message">Message</label> <textarea name="message" id="message" cols="20" rows="8"></textarea></p>
<p><label for="file">File</label> <input type="file" name="file" id="file"></p>
<p><input type="submit" name="submit" id="submit" value="send"></p>
</form>
</body>
</html> 
```

真的很准系统，显然使用内联 CSS 来隐藏表单有点便宜，你几乎肯定想要给用户更多的反馈！另外，我可能会花更多的时间来确定文件的实际 Content-Type 是什么，而不是作弊和使用 application/octet-stream ，但这部分同样有趣。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-06T00:29:02.280

这个[http://www.webcheatsheet.com/PHP/send_email_text_html_attachment.php#attachment的组合](http://www.webcheatsheet.com/PHP/send_email_text_html_attachment.php#attachment)

使用 php 上传文件示例将起作用。在上传文件示例中，而不是使用 move_uploaded_file 将其从临时文件夹中移动，您只需打开它：

```
$attachment = chunk_split(base64_encode(file_get_contents($tmp_file))); 
```

在哪里`$tmp_file = $_FILES['userfile']['tmp_name'];`

并像示例的其余部分一样将其作为附件发送。

**全部在一个文件中/自包含：**

```
<? if(isset($_POST['submit'])){
//process and email
}else{
//display form
}
?> 
```

我认为这是一个快速练习，可以根据上述两个可用示例获得所需的工作。

PS 它需要在 Apache 将它传递给 PHP 之前上传到某个地方来做它想做的事情。默认情况下，这将是您系统的临时文件夹，除非它在配置文件中进行了更改。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-30T10:37:52.397

本文“[如何创建带有文件附件的基于 PHP 的电子邮件表单](http://www.html-form-guide.com/email-form/php-email-form-attachment.html)”提供了如何实现您的要求的分步说明。

引用：

> 本文向您展示如何创建支持文件附件的基于 PHP 的电子邮件表单。本文还将向您展示如何验证上传文件的类型和大小。

它由以下步骤组成：

*   带有文件上传框的 HTML 表单
*   在 PHP 脚本中获取上传的文件
*   验证上传文件的大小和扩展名
*   复制上传的文件
*   发送电子邮件

完整的示例代码可以在[这里下载](http://www.html-form-guide.com/email-form/php-email-form-attachment.zip)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-11-03T16:28:19.407

为了将文件作为附件添加到电子邮件中，需要**将**其短暂存储在服务器上。但是，将它放在 tmp 位置然后在完成后删除它是微不足道的。

至于电子邮件，[Zend Mail](http://framework.zend.com/manual/en/zend.mail.html)有一个非常易于使用的界面来处理电子邮件附件。我们在安装了整个 Zend 框架的情况下运行，但我很确定您可以只安装 Zend_Mail 库，而不需要任何其他依赖模块。

使用 Zend_Mail，发送带有附件的电子邮件非常简单：

```
$mail = new Zend_Mail();
$mail->setSubject("My Email with Attachment");
$mail->addTo("foo@bar.baz");
$mail->setBodyText("Look at the attachment");
$attachment = $mail->createAttachment(file_get_contents('/path/to/file'));
$mail->send(); 
```

如果您正在寻找一个文件包来完成整个表单/电子邮件/附件的事情，我还没有看到一个。但是各个组件肯定是可用的并且易于组装。整个过程中最棘手的是电子邮件附件，上面的建议非常简单。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-11-04T15:43:51.993

我还没有测试过这部分的电子邮件（我的测试箱不发送电子邮件），但我认为它会起作用。

```
<?php
if ($_POST) {
$s = md5(rand());
mail('email@example.com', 'attachment', "--$s

{$_POST['m']}
--$s
Content-Type: application/octet-stream; name=\"f\"
Content-Transfer-Encoding: base64
Content-Disposition: attachment

".chunk_split(base64_encode(join(file($_FILES['f']['tmp_name']))))."
--$s--", "MIME-Version: 1.0\r\nContent-Type: multipart/mixed; boundary=\"$s\"");
exit;
}
?>
<form method="post" enctype="multipart/form-data" action="<?php echo $_SERVER['PHP_SELF'] ?>">
<textarea name="m"></textarea><br>
<input type="file" name="f"/><br>
<input type="submit">
</form> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-03T00:53:06.800

[梨::Mail_Mime](http://pear.php.net/manual/en/package.mail.mail-mime.example.php) ? 当然，(min) 2 个文件的 PEAR 依赖项（如果您编辑它以删除 pear 依赖项，则只是 mail_mime 本身），但它运行良好。此外，大多数服务器都在一定程度上安装了 PEAR，在最好的情况下，它们安装了 Pear/Mail 和 Pear/Mail_Mime。对于大多数提供相同功能的其他库来说，这是不能说的。

您也可以考虑查看 PHP 的[IMAP 扩展](http://php.net/imap)。它有点复杂，需要更多设置（默认情况下未启用或安装），但必须更有效地编译和发送消息到支持 IMAP 的服务器。

# perl - 是否有支持 TLS 的 Perl IMAP 模块？

> ID：826266
> 
> 赞同：4
> 
> 时间：2009-05-05T18:25:54.647
> 
> 标签：perl, imap, ssl

我正在编写一个 Perl 脚本来连接到需要通过端口 143 进行 TLS 的 IMAP 服务器。该服务器不支持通过 SSL 进行连接。到目前为止，我发现的 Perl IMAP 模块只支持 SSL，不支持 TLS。

是否有任何提供 TLS 支持的 Perl IMAP 模块？到目前为止，我已经看过：

网络::IMAP 网络::IMAP::简单网络::IMAP::客户端

Net::IMAP::Client 支持 SSL 但不支持 TLS。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:44:59.543

您制作了一个非 ssl 套接字，该套接字稍后会进行转换，“如果您想使用 IO::Socket::INET 替代方案，例如 IO::Socket::SSL，这也很有用。”

[http://search.cpan.org/dist/Mail-IMAPClient/lib/Mail/IMAPClient.pod#Socket](http://search.cpan.org/dist/Mail-IMAPClient/lib/Mail/IMAPClient.pod#Socket)

...当您在此处创建方法参考时...

[http://metacpan.org/pod/IO::Socket::SSL#METHODS](http://metacpan.org/pod/IO::Socket::SSL#METHODS)

这里的例子可以很容易地调整

[http://cpansearch.perl.org/src/SULLR/IO-Socket-SSL-1.24/example/ssl_client.pl](http://cpansearch.perl.org/src/SULLR/IO-Socket-SSL-1.24/example/ssl_client.pl)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-29T13:41:48.170

是的，但是 TLS ！= SSL。要使 TLS 工作，您需要创建一个普通套接字，处理 IMAP STARTTLS 命令，然后将其转换为 SSL 套接字。虽然 IO::Socket::SSL 可以像这样“升级”套接字，但 STARTTLS 协商是 IMAP 协议的一部分，因此不是“重新发明轮子”——您正在让 IMAP 客户端模块的每个用户重新发明轮子必须“手动”处理在此过程中出现的协议部分（包括任何其他零碎，例如空闲事件）！

我想有可能打开一个套接字，转储接收到的任何内容，然后将“STARTTLS\r\n”发送到它，然后调用 start_SSL 并希望最好。当然，除非您手动执行此操作，否则那里没有功能检查，为此您必须查看 IMAP RFC。

**Mail::IMAPClient**内置了 TLS 处理，尽管在我只想下载某些部分的情况下处理多部分消息时我遇到了问题——如果你无论如何都要抓取整个消息，这无关紧要。不过，对我来说，搜索仍在继续！

# javascript - 搜索引擎可以索引 JavaScript 生成的网页吗？

> ID：826275
> 
> 赞同：18
> 
> 时间：2009-05-05T18:27:34.567
> 
> 标签：javascript, html, gwt, dynamic, search-engine

Google 等搜索引擎可以索引 JavaScript 生成的网页吗？当您在由 JavaScript（例如使用 GWT）生成的页面中右键单击并选择查看源代码时，您不会看到动态生成的 HTML。我想如果搜索引擎也看不到生成的 HTML，那么索引就没有太多了，对吧？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-06T01:14:22.200

您的怀疑是正确的 - 不能依赖 JS 生成的内容对搜索机器人可见。关闭 JS 的任何人也看不到它——而且，上次我在我正在开发的网站上添加了一些测试（这是一个大型的主流受众网站，每月有数十万独特的访问者） ，大约 10% 的用户没有以任何形式运行 Javascript。这包括搜索机器人、禁用 JS 的 PC 浏览器、许多手机、使用屏幕阅读器的盲人……等等。

这就是为什么通过 JS 生成的内容（没有回退选项）是一个非常糟糕的主意。

回归本源。首先，使用**准系统 (X)HTML**创建您的站点，基于类似 REST 的原则（至少在需要 POST 请求来更改状态的范围内）。简单的语义标记，忘记 CSS 和 Javascript。

第一步是做到这一点，并让您的整个网站（或尽可能多的网站）以这种方式很好地为搜索机器人和类似 Lynx 的用户代理工作。

然后添加一个**视觉层**：CSS/graphics/media 进行视觉润色，但不要显着改变您原来的 (X)HTML 标记；允许原始纯文本网站保持完整和正常运行。保持标记干净！

三是添加**行为层**：Javascript（Ajax）。为使用支持 Ajax 的 JS 的用户/浏览器提供更快、更流畅、更好的体验……但仅限于那些用户。仍然欢迎没有 Javascript 的用户；搜索机器人、视障者、许多手机等也是如此。

这在网页设计界称为**渐进增强**。这样做，您的网站就会以某种合理的形式为所有人服务。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T18:33:06.270

> 如果搜索引擎也看不到生成的 HTML，则没有太多可索引的内容

大概就是这样总结。从技术上讲，没有什么可以阻止搜索引擎为其机器人/蜘蛛实现 javascript 引擎，但通常不会这样做。他们可以，但他们不会。

另一方面，您可以嗅探搜索引擎的用户代理并为其提供可读的内容。但是搜索引擎通常不喜欢这样，如果他们检测到与您发送到普通浏览器的内容不同，它们会非常严厉地惩罚您。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T19:49:01.140

一个好的经验法则：如果你可以在[Lynx](http://en.wikipedia.org/wiki/Lynx_(web_browser))中看到它，它就可以被 Google 索引。

Lynx 是一项出色的测试，因为它还可以让您了解盲人的屏幕阅读器也将如何查看您的页面。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-07-04T04:03:30.560

是的，谷歌（很可能是必应）将索引动态生成的 HTML。在此处查看更多详细信息：[http](http://searchengineland.com/tested-googlebot-crawls-javascript-heres-learned-220157) ://searchengineland.com/tested-googlebot-crawls-javascript-heres-learned-220157 。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T18:41:26.250

谷歌正在努力执行简单的 Javascript 来发现一些内容——但他们肯定不会执行完整的脚本。如果您担心 SEO，那么您需要考虑提供静态版本的页面。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T00:12:00.767

在 GWT 中有几种方法可以处理这个问题，[这](http://groups.google.com/group/Google-Web-Toolkit/browse_thread/thread/8fe6a3d2eaab80bb/)是关于这个主题的一个很好的讨论。似乎最好的选择是在用户代理是机器人时提供静态 SEO 内容，只要 SEO 内容与通过 GWT 路由提供的内容相同。这可能需要做很多工作，但如果您真的想要一个针对搜索引擎优化的完全丰富的 GWT 应用程序，那么它可能是值得的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-05T13:08:41.740

查看[单页接口](http://itsnat.sourceforge.net/php/spim/spi_manifesto_en.php)宣言，了解 SPI（AJAX 密集型）应用程序如何被 Google 和其他爬虫索引。难度取决于所使用的 Web 框架。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-01T20:06:53.830

即使他们执行基本的`JavaScript`MOSTLY WEBSITES Uses `LIBRARIES`AND `FRAMEWORKS`，我认为像 google bot 或任何其他蜘蛛这样的机器人也`Js`不会加载与网页链接的文件，并且不加载它们的 JS 代码会产生错误。

```
/*Correct Me If I am wrong*/ 
```

# c - Smalltalk 风格的消息与 C 风格的函数

> ID：826276
> 
> 赞同：16
> 
> 时间：2009-05-05T18:27:52.177
> 
> 标签：c, objective-c, function, messages

什么时候应该使用消息而不是 C 风格的函数？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-05T18:32:47.003

Objective-c 为您做出了区分。消息*必须*发送到对象，但函数可以随时使用。

**[留言](http://en.wikipedia.org/wiki/Objective-C#Messages)**：

Objective-C 消息只能发送给对象，而消息系统是调用类方法的方式*。*

例子：

```
// a class interface definition
// including a method named aMethod
@interface ANObject
{

}
- (void)aMethod;
@end 
```

```
// a message sent to that object:
ANObject * myObject = [[ANObject alloc] init];
[myObject aMethod]; // <-- message
[myObject release]; 
```

**功能**：

Objective-C 继承了所有 C 语言，因此当情况需要时，支持甚至鼓励 C 风格的函数调用。Objective-C 对象只是作为指针传递，所以你仍然可以将它们作为参数传递给函数。当然，应该遵守关于将指针传递给函数的常见注意事项和规则。

例子：

```
// a regular C-style function
void someFunction(ANObject * argument)
{
    // do something here...
} 
```

```
// and how to call it:
someFunction(someObject); 
```

**什么时候使用每个？**

当您想要访问对象/类的某些属性时，请使用**消息/方法。**很好的例子是访问 NSString 的长度：

```
int stringLength = [myString length]; 
```

设置属性的值：

```
[myObject setHidden:YES]; 
```

或者告诉一个对象执行一些任务：

```
[myAccount withdrawMoneyAndDriveToMexico]; 
```

当您想要执行不属于某个类的任务时，请使用 C 风格的**函数；**应该独立的东西。很好的例子是数学函数，例如：

```
double degrees = ConvertRadiansToDegrees(radians); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T18:33:02.010

基本上，在处理 Objective C 组件的任何时候都使用消息；在您使用 NS* 类型时或多或少。

在任何情况下，您本质上都是在使用 C 函数调用；Objective C 的原始实现是 C 的预处理器。但是使用 Objective C 的全部意义在于获得类似于 Smalltalk 的语法，这就是你在 [] 中的任何地方所拥有的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T18:37:58.223

你问了很多 Java 问题。也许 Java 类比会有所帮助。在 Java 中使用方法的地方，在 Objective-C 中使用消息。在 Java 中使用静态方法的地方，在 Objective-C 中使用类方法。如果您发现自己在 Java 中创建了充满静态方法的实用程序包，那么作为 Objective-C 中的函数可能是有意义的。

而且，当然，如果你也在做奇怪的 Objective-C++ 东西，这可能是有道理的。

# cron - 使用 cron 调度 capistrano 函数

> ID：826278
> 
> 赞同：1
> 
> 时间：2009-05-05T18:28:08.603
> 
> 标签：cron, capistrano

我是一名 php 开发人员，使用具有多级支持的 capistrano 将我的应用程序部署到我的生产服务器。因此，我对 ruby​​ 或 rails 的了解很少。

我已经想出足够的方法在我的 deploy.rb 脚本中添加一个名为“flush”的新函数，该脚本在我的所有生产服务器上调用一个 php 脚本。'flush' 的目的是连接到每个生产服务器并执行一个 php 脚本，该脚本将每个服务器的本地 mysql 表中的所有日志写入我的主数据库。

我确信该功能有效，因为从命令行（cap prod flush）执行它会产生准确的结果。

我想安排一个每小时调用此函数的 cron 作业。首先，我编写了一个执行该函数的 bash 脚本：

```
!#/bin/bash
`/usr/bin/cap prod flush` 
```

但是，当 cron 作业运行脚本时，它会通过电子邮件向我发送以下错误：

任务“产品”不存在

我相信问题是当 cron 运行时，它没有在正确的目录中执行脚本。我尝试在 bash 脚本中更改 $PATH 和 $HOME 变量，但我似乎无法让它工作。

谁能给我帮助？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T18:33:01.230

改成

```
cd /path/where/deploy.rb/exists
cap prod flush 
```

或者

```
cd /your/app/path/    
cap prod flush 
```

# iphone - 在 iPhone 上使用 libxml2 或 NSXMLParser 获得更好的性能？

> ID：826281
> 
> 赞同：19
> 
> 时间：2009-05-05T18:28:30.070
> 
> 标签：iphone, objective-c, xml, cocoa-touch

我很好奇您在 iPhone 上进行高性能 XML 解析的解决方案是什么，因为它的 CPU 能力有限。我已经查看了 Apple 作为演示提供的 XML 性能应用程序，似乎对于他们正在解析的数据馈送（300 首 iTunes 歌曲）.. libxml2 似乎总是成为最前沿的赢家。

凭借您在处理小于 100Kb 的数据方面的经验，您更喜欢什么来获得最佳性能？我目前正在使用 TouchXML + libxml2 并查看是否可以按原样优化解析速度。

感谢您的反馈意见！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-09T02:32:58.813

您可以随时查看我的 NSXMLParser 替代品。它从流中读取 XML 数据，而不是将其全部保存在内存中，并一次将 1KB 的数据传递到 libxml（NSXMLParser 一次性处理所有内容）。

源代码[在 github](http://github.com/AlanQuatermain/aqtoolkit/tree/master)上可用，我关于内存方面的[文章在我的博客上](http://alanquatermain.net/post/93651539/aqxmlparser-big-memory-win)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-05T20:03:19.093

I've generally found for larger chunks of data (like the apple example you reference) libxml2 tends to be faster. For smaller chunks of data, the difference is negligible. One advantage i like about NSXMLParser is that it is an Objective-C based implementation of an XML Parser where libxml2 is C based.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-16T04:46:28.710

libxml2 will always be faster than NSXMLParser for many reasons, however, it is up to you which is more useful to your project.

NSXMLParser, overall, is prettier. The code makes sense, as sax parser's are supposed to be, and it is a real Cocoa class with all the conventions there. If convenience and clean code are your top priorities, then you should stick with NSXMLParser.

While NSXMLParser uses libxml2 on the backend, it is slower due to the foundations of Objective-C and the achilles heel of Objective-C. When parsing XML, you're essentially just doing a bunch of tight loops over and over again while searching for the tags you're interested in.

Herein lies the lesson - when in a tight loop in Objective C that you are unable to utilize Fast Object Enumeration, you are looking at a serious performance hit. Dispatch / Delegate respondsToSelector / and other Objective C base language constructs give you a real disadvantage here.

I'm not going to go into dispatch, but the crux is, whenever you access something like this: "[zomg lolz]" you're handing off a method signature to the objective-c dispatcher to find the target C-function for your Objective-C method signature. This lookup process, when done over and over again, can dramatically reduce your performance.

If you're on an iPhone, go libxml2 and don't look back - but if your target machine has two processors and more ram than god, I'd go NSXMLParser for easier to maintain code.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-11T12:44:58.570

我使用苹果提供的 XML 解析应用程序尝试了我的数据（大约 600 条记录）。发现 libxml2 比 NSXMLParser 快得多。我切换到 libxml2（虽然我发现它比 NSXMLParser 实现起来更复杂，但它很适合我的目的）

使用大约 100 条记录尝试的相同示例在两种实现中没有太大差异。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-15T23:38:46.920

libxml2 总是比 NSXMLParser 快。NSXMLParser 为您提供了一个不错的基于事件的 API，但它建立在 libxml2 之上，并且也不是基于流的（例如，NSXMLParser 将整个数据块一次性交给 libxml2）。

如果您正在优化速度，那么 libxml2 绝对是您的最佳选择。但是，如果您想要一个基于 obj-c 事件的 API 并且不太关心性能，那么 NSXMLParser 是适合这项工作的工具。请注意，NSXMLParser 并不一定很慢，它只是不如 libxml2 快。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-27T21:39:06.247

如果您想`libxml2`与 Objective-C 前端一起使用，请查看这组有用的[包装函数](http://cocoawithlove.com/2008/10/using-libxml2-for-parsing-and-xpath.html)。

您向 XML 文档对象发出 Xpath 查询并取回 Foundation 类对象：`NSArray`、`NSString`和`NSDictionary`.

这些函数有助于将`libxml2`Objective-C 代码的可读性与速度结合起来。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T15:42:23.150

libxml2 比 NSXMLParser 更快，也更灵活。它还与 iPhone OS 2.2.1 发布的 SDK 中的 xmlReader 接口（我最喜欢的接口）有一个非常小的（但值得注意的）内存泄漏。嵌入在[http://inessential.com/2009/02/25/moving_to_libxml2_sax2](http://inessential.com/2009/02/25/moving_to_libxml2_sax2)中的详细信息。libxml2 中的其他接口没有这个问题——我最喜欢的接口就是这样。

从功能上讲，您不会注意到相对少量的 XML 的区别，但是如果您发现自己正在处理大量流入解析器的集合，它会变得很明显。

正如 zPesk 所提到的，对于少量数据，您可能会发现直接使用 Objective-C 的好处比您获得的少量性能更有益。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T15:43:17.830

我用过Objective-Xml。这是 NSXMLParser 的另一个替代品。它给了我大约 15 秒的改进，该文件需要超过 1 分钟的时间来解析。不过还是太慢了。

# python - 如何在python中将2字节长的字符串转换为整数

> ID：826284
> 
> 赞同：5
> 
> 时间：2009-05-05T18:28:44.330
> 
> 标签：python

我有一个我继承并正在尝试扩展的 python 程序。

我已经将一个两字节长的字符串提取到一个名为 pS 的字符串中。

pS 第一个字节是0x01，第二个是0x20，十进制值== 288

我一直在尝试将其值作为整数，我使用了以下形式的行

```
x = int(pS[0:2], 16)  # this was fat fingered a while back and read [0:3] 
```

并得到消息

```
ValueError: invalid literal for int() with base 16: '\x01 ' 
```

另一位 C 程序员和我一直在谷歌上搜索并试图让它整天工作。

建议，请。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-05T18:33:17.283

查看[结构](http://www.python.org/doc/2.5.2/lib/module-struct.html)模块。

```
struct.unpack( "h", pS[0:2] ) 
```

对于带符号的 2 字节值。使用“H”表示无符号。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T18:34:41.147

您可以将字符转换为其字符代码，`ord`然后以适当的方式将它们添加在一起：

```
x = 256*ord(pS[0]) + ord(pS[1]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-15T13:33:59.507

```
struct.unpack( "h", pS[0:2] ) 
```

但它将是数组形式

`struct.unpack( "h", pS[0:2] )[0]`这将直接获得价值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-16T01:48:16.600

这是一个大端的两字节数。如果不想使用`struct`模块，也可以使用`int`. 如果输入是 type `str`，则需要先将其转换为`bytes`实例。`bytes(pS, 'utf-8')`

```
num = int.from_bytes(pS, 'big') 
```

# c# - 如何将 Enumerable.ToList<>() 反序列化为 List<>

> ID：826295
> 
> 赞同：5
> 
> 时间：2009-05-05T18:31:11.093
> 
> 标签：c#, nhibernate, xml-serialization, workflow-foundation

我正在尝试构建一个看起来像这样的对象：

```
 public class MyObject
  {
    private IList<AnotherObject> items;
    public List<AnotherObject> Items
    {
      return items.AsEnumerable().ToList<AnotherObject>();
    }
  } 
```

我使用 NHibernate 作为我的 DAL，并让它直接映射到 items 字段，一切正常。

我也在使用 Windows 工作流，并且复制器活动不适用于通用 IList。（[http://social.msdn.microsoft.com/Forums/en-US/windowsworkflowfoundation/thread/2ca74b60-fd33-4031-be4b-17a79e9afe63](http://social.msdn.microsoft.com/Forums/en-US/windowsworkflowfoundation/thread/2ca74b60-fd33-4031-be4b-17a79e9afe63)）这基本上迫使我使用 List<> 包装器而不是 IList< >。这当然会破坏直接 NHibernate 映射，因为 NHibernate 的 IList 实现不能直接转换为 List。

** 编辑：Windows 工作流要求实际上意味着我将失去对列表的类型安全访问，因为它需要 IList。

现在的目标是序列化/反序列化这个对象。这适用于二进制序列化，但是当我尝试反序列化它们时，底层的 NHibernate 代理对象会因 nhibernate 错误而爆炸。

所以我尝试了xml序列化。序列化工作正常，并在序列化的 xml 文件中为我提供了我很好的具体类定义，它完全去除了休眠代理。但是，当尝试反序列化时，我无法将项目添加到列表中，因为 items.AsEnumerable.ToList 调用不会让项目通过 .Add 方法添加到基础列表中。

有人对此有任何想法吗？我会以错误的方式解决这个问题吗？

** 编辑：NHibernate 具体类是 NHibernate.Collection.Generic.PersistentGenericBag，它确实直接实现了 IList。但是，我失去了泛型列表的所有类型安全优势。这让我回到了必须为每个子对象编写一个包装器的领域，如果可能的话，我真的很想避免这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T18:48:22.317

选项是创建您自己的 CustomList 实现，该实现是围绕实现 IList 的实例的包装器

IE：

```
public CustomList<AnotherObject> Items    
{      
    return new CustomList<AnotherObject>(items); 
} 
```

即，当您添加到您的时`CustomList<T>`，它会添加到支持列表中。

听起来只要您的班级实施`IList`得很好，`IList<T>`您就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T18:38:03.247

是的，不幸的是你不能这样做。调用`ToList()`会创建一个全新的列表实例，因此当您向该实例添加项目时，它们不会反映在原始列表中（正如您已经清楚地发现的那样）。

我不使用 NHibernate，但我很想知道您的容器是否实现`IList`（非通用版本）。从您引用的线程来看，这似乎`System.Collections.IList`是实际需要的（这是由 实现的`List<T>`，这就是它起作用的原因）。你的容器实现了`IList`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T18:52:30.963

你不能就这样投吗？

```
public class MyObject
{
    private IList<AnotherObject> items;
    public List<AnotherObject> Items()
    {
        return (List<AnotherObject>)items;
    }
} 
```

Havent有机会尝试一下，但我认为它应该可以！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T19:01:07.713

我认为 NHibernate PersistentBag （非通用）集合实现`IList`了，因此您可以键入项目`IList`而不是`IList<AnotherObject>`. 您问题中的链接指出问题在于复制器需要一个`List<T>`实现但`IList<T>`不实现的 IList（如图）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-06T16:21:18.497

它可以转换为 IEnumerable<T> 吗？你可以试试这个：

```
public class MyObject
{
    private IList<AnotherObject> items;
    public List<AnotherObject> Items
    {
        return new List<AnotherObject>items.Cast<AnotherObject>());
    }
    // or, to prevent modifying the list
    public IEnumerable<AnotherObject> Items
    {
        return items.Cast<AnotherObject>();
    }
} 
```

# javascript - 好的 Javascript A/B (Split) 测试包/库？

> ID：826298
> 
> 赞同：14
> 
> 时间：2009-05-05T18:31:34.260
> 
> 标签：javascript, ab-testing

我的老板出于某种原因想尝试在 JavaScript 中实现 A/B 测试（或拆分测试）。任何人都知道任何好的 JavaScript 包/库/解决方案来实现 A/B 测试？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T18:55:53.717

这是：[http ://ejohn.org/blog/genetic-ab-testing-with-javascript/](http://ejohn.org/blog/genetic-ab-testing-with-javascript/)

您是否正在尝试测试您的网站的适销性或您的代码的性能或什么？

假设适销性，您可以简单地使用一些 JS，根据随机数将类名附加到您的主体标签（+ 其他任何东西）。然后通过您使用的任何分析引擎记录随机选择和结果（当访问者点击某些东西时，还记录他们呈现的随机布局）。您还可以考虑使用 cookie 来确保回访者获得相同的待遇。

我不知道 JS 的代码质量 a/b 框架，但想法是相似的。定义什么构成更高的质量（执行时间更短的毫秒？），运行代码的变体，看看哪个会出现。JMeter 和 JSUnit 之类的工具可能对这些目的有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-02T20:08:45.543

我发现这个简单的开源 JS 工具非常有用：[https ://github.com/jamesyu/cohorts](https://github.com/jamesyu/cohorts)

它没有你可能想要的所有功能，但它是免费的、灵活的、写得非常好和整洁，你总是可以修改它来支持额外的要求。

支持 Google Analytics（通过事件跟踪）和其他后端。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-22T16:10:59.447

[Maxymiser](http://www.maxymiser.com/)非常漂亮，几乎完全在 JavaScript 中运行（从程序员的角度来看）。虽然很贵。这是我们最终选择的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-09T13:29:36.630

你可以试试这个：[ABalytics.js - 使用 Google Analytics 进行客户端 A/B 测试的 JavaScript 库](http://functionn.blogspot.com/2012/10/abalyticsjs-javascript-library-for.html)

这是一个简洁的小包，它允许您使用 JavaScript 在客户端纯粹执行 A/B 测试，同时将结果存储在 Google Analytics 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-16T04:44:30.567

还有[谷歌网站优化器](http://www.google.com/websiteoptimizer)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-16T15:24:31.370

这个问题已经有四年了，还在搜索中，所以这里有一个新的（2013 年 5 月）Javascript A/B 测试库：

[https://github.com/maccman/abba](https://github.com/maccman/abba)

带有一个小的 Sinatra 服务器应用程序来收集数据并显示结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-14T16:53:53.533

使用几行 JS，您还可以实现 A/B 测试。您只需将组成员身份存储在持久性 cookie 中，并据此做出决定。对于 A/B 测试，测量是最重要的部分。这可以通过 Google Analytics 轻松完成，例如以下博客：[Google Analytics 中的简单 ab 测试](http://freeconnection.blogspot.hu/2013/08/simple-ab-test-in-google-analytics.html "Google Analytics 中的简单 ab 测试")

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2010-05-11T06:04:23.303

如果您使用服务器端语言，我建议您在服务器上进行拆分测试，因为这将允许您保存结果。在 javascript 中，您将不得不使用 jsonp 或其他难看的东西来保存拆分测试的结果。

我[为 asp.net mvc 写了一篇关于此的小文章](http://www.picnet.com.au/blogs/Guido/post/2010/05/11/Split-Testing-(AB-Testing)-in-ASPNet-Mvc.aspx)。它可能会激发您在您使用的任何后端语言中实现类似的东西。

# iphone - OpenGL 到 OpenGL-ES - glBegin();

> ID：826307
> 
> 赞同：2
> 
> 时间：2009-05-05T18:34:12.960
> 
> 标签：iphone, opengl-es

我正在尝试学习为 iPhone 编写 OpenGL 应用程序。如何移植以下代码以使用 OpenGL-ES？我知道我必须将顶点存储在一个数组中，然后调用 glDrawArrays()，但是有没有最佳的方法来做到这一点？我的想法是创建一个非常大的数组，并简单地保留一个计数器来计算填充了多少空间。这有更好的办法吗？使用 NSArray 然后转换回 ac 数组怎么样？

```
glBegin(GL_LINE_STRIP);

z = -50.0f;
for(angle = 0.0f; angle <= (2.0f*3.1415f)*3.0f; angle += 0.1f)
    {
    x = 50.0f*sin(angle);
    y = 50.0f*cos(angle);

    // Specify the point and move the Z value up a little   
    glVertex3f(x, y, z);
    z += 0.5f;
    }

// Done drawing points
glEnd(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T18:40:32.180

听起来像是经典的速度/内存权衡。如果内存非常稀缺，请尝试使用动态的数据结构。如果您对数组的大小有一个合理的界限，并且从该等式中您确切地知道需要多少个顶点，那么只需像您建议的那样使用带有计数器的普通旧静态数组。

看起来你知道数组，并绘制数组，所以我不会深入讨论。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T20:17:31.993

如果您有足够的空间并且知道数组的最大大小，最简单的方法是使用一个静态分配的大数组并跟踪其当前的逻辑大小。

如果内存不足但处理器资源充足，则动态打包数组，然后注册数组并调用 glDrawArrays()。

混合方法是使用可以更新（如有必要）的动态分配数组。您可以通过在动态数组快满时重新分配动态数组或使用某种 NSMutableArray 来手动执行此操作。（NB NSArray 用于静态数组；NSMutableArrays（子类）是动态的。[请参见此处。](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html)）

希望这有帮助:)

# excel - 如何对单元格中文本中的数字求和？

> ID：826309
> 
> 赞同：0
> 
> 时间：2009-05-05T18:35:04.970
> 
> 标签：excel, vba, excel-formula, text-parsing, office-2007

我有一张 Excel 表格
[![替代文字](https://i.stack.imgur.com/eGx0E.jpg)](https://i.stack.imgur.com/eGx0E.jpg)

要求是将“C”列中单元格中的数字相加，并将值放在“B”列中的相应单元格中（在我的示例中为 0.25 + 1 + 0.25 + 1 = 2.5）。

“C”列中的值可能会改变。要求是在“C”列中的单元格更改后立即更新“B”中的值。

我确实要求创建者在两个不同的列中更改为文本和数字，但由于标准模板，这是不可接受的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T19:10:18.410

这可以使用宏来实现，而无需更改单元格中的文本。我不得不承认，实施会有点迟钝，因为你需要做一些事情。

1 - 标记整个单元格内容，并将标记存储到字符串数组中。

已经有问题了。位于单元格内的文本严重不一致。你有 -250 毫秒，- 250 毫秒，- 1 秒，- 1 秒。因此，您将需要检查每个实例。因此，您不能只检查该值是否为数字，您需要检查您的团队成员方便地为您提供的所有排列。

最好的方法是检查正则表达式。因此，#2 应该是：

2 - 检查每个值以查看它是否与许多 4 个正则表达式之一匹配。

3 - 根据它匹配的正则表达式，提取数值。

a) 如果只是一个值（即->250），请检查 ms 或 sec 是否继续该值。如果是 ms，则将数字除以 1000。如果是 sec，则保持原样。将数字添加到总数中。
b) 如果数字前面有破折号 (-)，则删除破折号，然后重复步骤 a)
c) 如果数字后跟字母，则删除字母并重复步骤 a)
d) 如果数字后跟句点，则不执行任何操作。这是一个要点。

# .net - F# 中的 OrderBy ThenBy

> ID：826317
> 
> 赞同：42
> 
> 时间：2009-05-05T18:38:11.217
> 
> 标签：.net, linq, sorting, f#

F# 中是否有任何类似于 LINQ fluent 语法的函数用于按多个表达式进行排序：

```
myList.OrderBy(fun x->x.Something).ThenBy(fun x->x.SomethingElse) 
```

我喜欢这样的东西：

```
myList 
|> Seq.sort_by(fun x->x.Something) 
|> Seq.then_by(fun x->x.SomethingElse) 
```

谢谢

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-05-05T19:14:07.463

使用元组作为排序键：

```
myList |> Seq.sortBy (fun x -> x.Something, x.SomethingElse) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-05-07T22:47:04.953

因为`sortBy`被[定义为 stable](https://msdn.microsoft.com/visualfsharpdocs/conceptual/seq.sortby%5B%27t%2c%27key%5D-function-%5Bfsharp%5D#remarks)，所以您可以使用辅助键以相反的顺序进行多次排序：

```
myList |> Seq.sortBy (fun x -> x.SomethingElse) |> Seq.SortBy (fun x -> x.Something) 
```

主键比较相同的项目将保留辅助键完成的先前排序。**两个**键比较相同的项目将按原始顺序排列。这有一个优点（与元组方法不同），您可以独立控制每个键的排序是否降序。

如果您的排序键是有符号整数并且您希望按降序对辅助键进行排序，您仍然可以使用 tuple 使用否定的方法：

```
myList |> Seq.sortBy (fun x -> x.Something, -x.SomethingElse) 
```

这种方法可以说不太清楚，但可能比两次排序更快。请注意，由于溢出，它无法正确处理最小值。

# java - 转换为同一类时出现 ClassCastException

> ID：826319
> 
> 赞同：61
> 
> 时间：2009-05-05T18:38:14.463
> 
> 标签：java, reflection, classcastexception, websphere-portal

我有 2 个不同的 Java 项目，一个有 2 个类：`dynamicbeans.DynamicBean2`和`dynamic.Validator`.

在另一个项目中，我动态加载这两个类并将它们存储在`Object`

```
class Form {
    Class beanClass;
    Class validatorClass;
    Validator validator;
} 
```

然后我继续使用创建一个`Validator`对象`validatorClass.newInstance()`并将其存储在上面，`validator`然后我创建一个 bean 对象以及使用`beanClass.newInstance()`并将其添加到会话中。

```
portletRequest.setAttribute("DynamicBean2", bean); 
```

在`Form`项目的生命周期中，我调用`validator.validate()`它从会话加载先前创建的 bean 对象（我正在运行 Websphere Portal Server）。当我尝试将此对象转换回 a`DynamicBean2`时，它会因 ClassCastException 而失败。

当我使用将对象拉出会话时

```
faces.getApplication().createValueBinding("#{DynamicBean2}").getValue(faces); 
```

并使用`.getClass()`I get来检查它的类别`dynamicbeans.DynamicBean2`。这是我想将其转换为的类，但是当我尝试得到 ClassCastException 时。

我得到这个有什么理由吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-05-05T18:46:27.470

我没有完全按照您对程序流程的描述，但通常当您收到 ClassCastExceptions 时，您无法解释您已经使用一个类加载器加载了该类，然后尝试将其强制转换为另一个类加载器加载的同一个类。这将不起作用 - 它们由 JVM 内的两个不同的 Class 对象表示，并且转换将失败。

有[一篇关于 WebSphere 中的类加载](http://www.ibm.com/developerworks/websphere/library/techarticles/0112_deboer/deboer.html)的文章。我不能说它如何应用于您的应用程序，但有许多可能的解决方案。我至少能想到：

1.  手动更改上下文类加载器。要求您实际上可以获得对适当类加载器的引用，这在您的情况下可能是不可能的。

    ```
    Thread.currentThread().setContextClassLoader(...); 
    ```

2.  确保类由层次结构中更高的类加载器加载。

3.  序列化和反序列化对象。（呸！）

不过，对于您的特定情况，可能有更合适的方法。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2019-03-12T22:32:55.737

`spring-boot-devtools`在我的 Springboot 项目中添加依赖项后，我遇到了这个问题。我删除了依赖项，问题就消失了。在这一点上，我最好的猜测是`spring-boot-devtools`引入了一个新的类加载器，并且在某些线程没有使用新的类加载器的某些情况下，这会导致不同类加载器之间的类转换问题。

参考：[Spring boot devtools相关的一个dozer map异常](https://stackoverflow.com/questions/33955542/a-dozer-map-exception-related-to-spring-boot-devtools)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-05T18:47:34.970

类对象被加载到不同的类加载器中，因此从每个类中创建的实例被视为“不兼容”。在使用许多不同的类加载器并且正在传递对象的环境中，这是一个常见问题。这些问题在 Java EE 和门户环境中很容易出现。

转换一个类的实例要求链接到被转换对象的类与当前线程上下文类加载器加载的类相同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-25T15:21:08.633

尝试使用 Apache Commons Digester 从 XML 创建对象列表时出现 A2AClassCastException 问题。

```
List<MyTemplate> templates = new ArrayList<MyTemplate>();
Digester digester = new Digester();
digester.addObjectCreate("/path/to/template", MyTemplate.class);
digester.addSetNext("/path/to/template", "add");
// Set more rules...
digester.parse(f); // f is a pre-defined File

for(MyTemplate t : templates) { // ClassCastException: Cannot cast mypackage.MyTemplate to mypackage.MyTemplate
    // Do stuff
} 
```

如上所述，原因是消化器没有使用与程序其余部分相同的 ClassLoader。我在 JBoss 中运行它，结果发现 commons-digester.jar 不在 JBoss 的 lib 目录中，而是在 webapp 的 lib 目录中。将 jar 复制到 mywebapp/WEB-INF/lib 也解决了这个问题。另一个解决方案是 casll digester.setClassLoader(MyTemplate.class.getClassLoader())，但在这种情况下，这感觉是一个非常丑陋的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-08-10T10:00:04.143

在 WildFly 10.1 上也有同样`my.package.MyClass cannot be cast to my.package.MyClass`的情况，据我所知，我的做法与 @Emil Lundberg 在他的回答中描述的相反。

我已将**模块**（包含`my.package.MyClass`）添加`my.war/WEB-INF/jboss-deployment-structure.xml`为依赖项

```
<dependencies>
    ...
    <module name="my.package"/>
</dependencies> 
```

并从中删除相应的**jar**，`my.war/WEB-INF/lib`重新部署 WAR，然后代码按预期工作。

因此，我们确保它可以解决问题。现在，我们需要确保问题不会再次出现，例如，何时组装和部署更新版本的**WAR 。**

为此，在那些**WAR**的源代码中，需要将`<scope>provided</scope>`这些**jar****添加**到.`pom.xml``my.war`**`my.war/WEB-INF/lib`**

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-23T12:40:24.387

在不同机器上使用多个 JBoss 实例时，我遇到了同样的问题。可惜我之前没有偶然发现这篇文章。
在不同的机器上部署了工件，其中两个声明了具有相同名称的类加载器。我更改了一个类加载器名称，一切正常 => 小心复制和粘贴！

为什么抛出的 ClassCastException 没有提到涉及的类加载器？- 我认为这将是非常有用的信息。
有谁知道将来是否会有类似的东西？需要检查 20-30 个 Artifacts 的类加载器并不是那么令人愉快。还是我在异常文本中遗漏了什么？

**编辑**：我编辑了 META-INF/jboss-app.xml 文件并更改了加载程序的名称，这个想法是有一个唯一的名称。在工作中，我们使用工件 id(unique) 和 maven({$version}) 在构建期间插入的版本。
使用动态字段只是可选的，但如果您想部署同一应用程序的不同版本，它会有所帮助。

```
<jboss-app>
   <loader-repository> 
   com.example:archive=unique-archive-name-{$version}
   </loader-repository> 
</jboss-app> 
```

你可以在这里找到一些信息：[https ://community.jboss.org/wiki/ClassLoadingConfiguration](https://community.jboss.org/wiki/ClassLoadingConfiguration)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-17T13:27:13.300

我有同样的问题，我终于在 java.net 上找到了解决方法：

将所有`org.eclipse.persistence jar`文件复制`glassfish4/glassfish/modules`到`WEB-INF/lib`. 然后进入你的`glassfish-web.xml`，并设置`class-delegate`为`false`。

为我工作！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-07T21:23:18.917

我对 JAXB 和 JBoss AS 7.1 也有类似的问题。此处描述了问题和解决方案：[javax.xml.bind.JAXBException: Class *** nor any of its super class is known to this context](https://stackoverflow.com/questions/14057932/javax-xml-bind-jaxbexception-class-nor-any-of-its-super-class-is-known-to-t/41526616#41526616)。给出的异常是 org.foo.bar.ValueSet 不能转换为 org.foo.bar.ValueSet

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-21T08:25:13.003

我在 Wildfly EJB 上遇到了同样的问题，EJB 返回了一个对象列表，并且有一个远程和一个本地接口。我错误地使用了本地界面，直到您尝试将对象投射到列表中为止。

本地/远程接口：

```
public interface DocumentStoreService {

    @javax.ejb.Remote
    interface Remote extends DocumentStoreService {
    }

    @javax.ejb.Local
    interface Local extends DocumentStoreService {
    } 
```

EJB bean：

```
@Stateless
public class DocumentStoreServiceImpl implements DocumentStoreService.Local, DocumentStoreService.Remote { 
```

EJB 周围的正确弹簧包装器：

```
<bean id="documentStoreService" class="org.springframework.ejb.access.LocalStatelessSessionProxyFactoryBean">
    <property name="jndiName" value="java:global/dpc/dpc-ejb/DocumentStoreServiceImpl!santam.apps.dpc.service.DocumentStoreService$Remote"/>
    <property name="businessInterface" value="santam.apps.dpc.service.DocumentStoreService$Remote"/>
    <property name="resourceRef" value="true" />
</bean> 
```

注意 $Remote，您可以将其更改为 $Local，它会发现 Local 接口很好，并且还可以毫无问题地执行方法（来自同一容器上的单独应用程序），但是模型对象没有编组并且是如果您错误地使用本地接口，则来自不同的类加载器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-28T11:22:04.323

另外一个选项：

在 weblogic 中发生在我身上，但我想它也可能发生在其他服务器上 - 如果你（只是）“发布”并且因此你的一些类被重新加载。而是执行“清理”，以便所有类将一起重新加载。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-06-21T15:16:06.760

我从另一个 EJB 查找 EJB 时遇到了同样的问题。我解决了将 @Remote(MyInterface.class) 添加到 EJB 类配置的问题

# macos - Mac PGP WDE 紧急恢复程序

> ID：826323
> 
> 赞同：1
> 
> 时间：2009-05-05T18:39:50.637
> 
> 标签：macos, encryption, pgp

这实际上更像是一个服务器故障/IT 问题，但我不是测试版的一部分。

设备/拓扑：

1.  MacBook Pro（运行 OSX）4GB 内存
    *   用于电子邮件、网页浏览，基本上所有不是 Visual Studio 或 MS 应用程序的东西。
2.  满足各种开发需求的 VMWare Fusion VM（主要是 XP）
    *   主要VS2008开发
    *   自定义第三方软件
    *   安装测试环境
    *   ETC

由于我使用的数据的性质，我需要整个磁盘加密 [WDE]。因为我同时使用虚拟机和 OSX，所以我不能简单地在我的虚拟机中安装 TrueCrypt WDE，因为这会使我的 OSX 数据不受保护。

FileVault 无法工作有几个原因，如果你非常关心它，我会让你去寻找，只要说它对我的目的不起作用就足够了。

TrueCrypt 的 WDE 非常棒，如果它在 EFI intel mac 上工作，那将是我的首选解决方案 :( PGP 有一个适用于 mac 的[解决方案](http://www.pgp.com/products/wholediskencryption/)。

问题很简单：如果我需要在不启动系统的情况下访问磁盘会发生什么？

使用 TrueCrypt，您可以从 BartPE 或其他安装了 TC 的 Windows 系统安装驱动器并复制数据。

有没有办法用人们知道的 PGP for mac 来做到这一点？其他人已经解决了这个问题吗？

我知道您可以在*紧急情况*下解密驱动器，但有时这是不可取的或不可靠的。我正在寻找的是能够构建引导盘（windows 很好，它不必是 mac）以便能够安装未加密的驱动器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T04:24:44.517

您肯定有两个选择： 1\. 在单独的 Mac 上安装 WDE，并使用目标磁盘模式远程挂载原始磁盘。2\. 在可引导的外部驱动器上安装 WDE。然后用它启动，挂载原始磁盘（当然是输入密码）并访问数据。

有多种命令行恢复选项可用。您可能需要查看 PGP 知识库并搜索文章 1018。

（免责声明：我为 PGP 工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:46:18.450

如果需要，您可以在 USB/FireWire 驱动器上安装 OS X 和 PGP WDE。从那里访问磁盘应该没有问题。

# c# - LINQ 到 resx 文件？

> ID：826325
> 
> 赞同：1
> 
> 时间：2009-05-05T18:40:57.530
> 
> 标签：c#, linq, ienumerable, iqueryable, resx

我正在尝试构建一种方法来`.resx`在运行时获取给定文件中给定文本的密钥。

目前，我可以打开并读取文件（Using `ResXResourceReader`），但我必须使用 a`foreach`来查看整个文件。

这可能是一个性能问题，因为我们的一些`.resx`文件相当大（大约 2000 个字符串）并且我们可能经常这样做。

我想使用 LINQ to Objects 来查询这个，因为我认为该`where`方法是相对优化的，但是我一直无法这样做。该类`ResXResourceReader`有两个方法`AsQueryable()`和`GetEnumerator()`，但都不允许 LINQ 针对它们的结果（因此`from n in reader.AsQueryable() where`失败）。

我如何针对 LINQ 提供的东西进行 LINQ `ResXResourceReader`，或者它是否值得花时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T19:08:49.210

以下代码返回一个 IEnumerable 对象，该对象允许您使用 LINQ 查询资源文件的内容：

```
ResXResourceReader reader = new ResXResourceReader(myfile);
IEnumerable<DictionaryEntry> enumerator = reader.OfType<DictionaryEntry>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T18:44:43.230

您是否考虑过只进行一些预处理？

您可以加载 Resx 文件，然后遍历键值对，然后将它们*反转*存储在哈希表中（即哈希表中的键实际上是资源的值，而哈希表中的值是资源的键）。那么 value->key 的翻译会很快。唯一需要考虑的是如何处理重复项（具有相同值的多个资源）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T18:49:43.547

这真的不值得你花时间。LINQ 没有任何方法可以比您更有效地搜索 .resx 文件。根据内存使用情况以及缓存数据是否对您有意义，您最好将整个文件读入 a`Dictionary<TKey,TValue>`并以这种方式进行查找。

当然，您可以创建自己的 tuplet 对象来存储键/值对并将整个文件读入这些列表，然后允许 LINQ to 对象进行查询，但这不会像`Dictionary`并且需要更多的开销。

# php - 我是否正确使用 Yfrog 的 API 来使用 POST 数据发出 HTTP 请求？

> ID：826340
> 
> 赞同：1
> 
> 时间：2009-05-05T18:45:30.637
> 
> 标签：php, xml, api

我正在尝试使用 YFrog 的 API。我认为我正确地使用它来尝试发送内容类型为 XML 的 HTTP POST 请求。但是，作为响应主体，由于某种原因，我总是收到 404 错误。[这](https://i.stack.imgur.com/Sv4th.png)是他们的 API。

这是我上传PHP代码的尝试。

```
 $data = array('media' => 'http://img253.imageshack.us/my.php?image=bfab82a545d414uo.jpg', 'username' => 'asc', 
    'password' => 'asc', 'message' => 'hi');

$url = 'http://example.com/api/uploadAndPost';

$req = new HTTPRequest($url);
$req->addHeaders(array("Content-Type" => "text/xml")); 
$req->setMethod(HTTP_METH_POST); 
$req->addQueryData($data); $req->send();
echo $req->getResponseBody(); 
```

同样对于媒体，它说“二进制图像数据”是否意味着图像位置的 URL 不能传递给它？这是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T11:08:42.560

我认为问题基本上是当您提供上面发布的 URL 时，ImagesHack 不会返回二进制文件。对我来说，它返回一个 HTML 文档。

我认为您应该尝试将二进制文件作为“媒体”参数传递。您尝试获取的照片位于[http://img253.imageshack.us/img253/172/bfab82a545d414uo.jpg](http://img253.imageshack.us/img253/172/bfab82a545d414uo.jpg)，请改用此 URL。

这是我对您最初尝试的响应的响应：

```
HEAD /my.php?image=bfab82a545d414uo.jpg HTTP/1.1
Host: img253.imageshack.us

HTTP/1.1 200 OK
X-Powered-By: PHP/5.2.6
Set-Cookie: nopopunder=1; expires=Thu, 07-May-2009 11:10:21 GMT; path=/; domain=.imageshack.us
X-UA-Compatible: IE=EmulateIE7
Content-type: text/html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T00:37:01.153

您需要使用 addPostFields 和 addPostFile 而不是 addQueryData。如何使用两者的一个例子是[here](http://usphp.com/manual/en/function.httprequest-send.php)

@MC 是正确的，因为您不能将 URL 指针发送到其他地方的文件，您实际上需要上传这些字节。因此，您需要先下载本地副本，然后将该文件的本地副本的路径传递给 addPostFile 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:51:44.110

您需要使用`Content-Type`of `multipart/form-data`。

yfrog 发回一个 XML 文件作为响应，但 API 需要一个带有图像数据的标准 HTTP POST 请求。

[API 文档](https://i.stack.imgur.com/Sv4th.png)状态：

> “发布数据应格式化为多部分/表单数据”

# flash - 具有相同 fontName 属性的 Flash 中嵌入的字体

> ID：826346
> 
> 赞同：1
> 
> 时间：2009-05-05T18:46:38.013
> 
> 标签：flash, actionscript-3, fonts, embedding

我正在使用包含许多字体类的外部 swf 在运行时为我的 flash 站点加载和注册字体。（在库面板 Flash IDE 中导出然后在框架脚本中注册）

在这种特殊情况下，swf 包含同一家族的许多不同权重。例如。罗马字体、斜体字体、轻字体、重字体等...

字体似乎注册得很好，但是当我尝试使用这些字体时，这些字体的一些 fontName 属性是相同的。三个显示为 Roman，两个显示为 light，一个显示为 light sc...所以我去寻找一些愚蠢的编码错误，但令我沮丧的是，我没有找到任何错误。正确的字体对象以正确的顺序加载。

经过相当多的测试后，我检查了我的字体文件夹（vista）。当我打开 Heavy 的文件时，字体查看器中的标题显示 Roman；字体查看器中的标题与我在 Flash 中获得的标题相匹配。这种行为似乎是该字体所独有的。

由于 fontName 是我知道如何将字体分配给 TextField 的唯一方法，我很难理解如何将这种可爱的重字体用于我的动态标题！

这是一种类型 1 字体

任何人都可以提出原因、解决方案或解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T23:51:39.177

谢谢，我认为你的权利。

然而，我确实找到了一种嵌入字体和设置名称的方法。

首先，我使用 CrossFont 将 Type 1 postscript 字体转换为 .otf

使用现在在 cs4 中可用的 [embed()] 功能，我能够使用 fontFamily 属性来设置嵌入字体的 fontName 属性。

在下面的代码中，您可以看到我将名称设置为“BlaaDeeBlaa”，TextFormat 将接受它并显示嵌入的字体。

```
[Embed(source="assets/FontFileName.otf",
                            fontFamily="BlaaDeeBlaa",
                            mimeType="application/x-font")]
var BlaaDeeBlaa:Class;

var CH:Font = new BlaaDeeBlaa();

var testTxt:TextField =  new TextField();
testTxt.defaultTextFormat = new TextFormat("BlaaDeeBlaa",28,0x000000,true);
testTxt.embedFonts = true;
testTxt.text = Font.enumerateFonts(false)[0].fontName;
testTxt.autoSize = "left";
addChild(testTxt); 
```

nb 使用此方法只能嵌入 OpenType(.OTF) 和 Truetype (.TTF)

我[在 gotoandlearn 的 Lee Brimelows 的教程中学习了这项技术](http://www.gotoandlearn.com/play?id=102)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T22:12:21.367

听起来这是字体的问题，而不是您的软件（Flash）的问题。

如果它是免费字体，则字体系列的作者很可能使用一种字体作为基础，并针对不同的面部风格编辑了它的副本。他们可能只是更改了文件名，而忘记更改内部名称。

您也许可以以某种方式自己编辑名称，但我对此不太确定。

# asp.net - 从主控件调用时，子控件的 ChildControl 为 null

> ID：826348
> 
> 赞同：0
> 
> 时间：2009-05-05T18:46:55.220
> 
> 标签：asp.net, controls

我在 asp.net 中构建了一个 webusercontrol，其中包含一个数据绑定下拉列表。当我直接将此控件放入网络表单时，它运行良好。但是如果我尝试在运行时将此控件作为子控件添加到另一个控件

```
Childcontrol childcontrol = new Childcontrol ();
maincontrol.controls.add(childcontrol) 
```

，子控件的下拉列表未激活（为空），因此我通过尝试将数据绑定到下拉列表来运行异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T20:20:39.503

如果这是一个用户控件（您有一个 ascx 文件？）那么您需要使用 LoadControl 以便 ASP.NET 实例化对象。

# c++ - 将套接字重新绑定到不同的接口

> ID：826354
> 
> 赞同：3
> 
> 时间：2009-05-05T18:47:47.357
> 
> 标签：c++, c, linux, sockets

是否有现有的 Linux/POSIX C/C++ 库或示例代码来说明如何将套接字从一个物理接口重新绑定到另一个？

例如，我在与物理连接 A 关联的套接字上进行 ping 传输，并且我想将该套接字重新绑定到物理连接 B，并继续在连接 B 上发送和接收 ping 数据包（在切换期间的短暂延迟之后-超过）。

我只需要这个用于无会话协议。

谢谢

更新：

我正在尝试提供用于 PPP 和以太网设备的故障转移解决方案。

我有一个基本脚本，它可以通过使用 iptables、NAT 和路由表来完成 90% 的功能。

问题是发生故障转移时，ping 会继续在辅助连接上发送，但是它们的源 IP 来自旧连接。

我与几个从事商业路由器工作的人交谈过，他们的建议是将套接字重新绑定到辅助接口。

更新 2：

我很抱歉没有提前说明这一点。此解决方案将在路由器上运行。我无法更改 ping 程序，因为它将在客户端计算机上运行。我以 ping 为例，任何不是基于会话的连接都应该能够被切换。我在几个商业路由器上测试了这个功能，它确实有效。不幸的是，他们的软件是专有的，但是，从各种对话和测试中，我发现他们在故障转移时重新绑定了套接字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T16:07:06.423

在您更新的帖子中，问题是更改路由信息不会更改您的 ping 的源地址，它只会强制它退出第二个接口。 [这个答案](https://stackoverflow.com/questions/172905/using-linux-how-to-specify-which-ethernet-interface-data-is-transmitted-on)包含一些相关信息。

您需要更改 ping 程序。您可以使用每个接口的套接字方法，并以某种方式通知程序何时进行故障转移。或者您将不得不关闭套接字，然后绑定到第二个接口。

您可以通过多种方式获取所需的接口信息，包括使用 SIOCGIFCONF 选项调用 ioctl() 并遍历返回的结构以获取接口地址信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:10:39.017

我不认为这是一个定义明确的操作。物理接口具有不同的 MAC 地址，因此除非您有映射它们的路由层（NAT 等），否则它们将具有不同的 IP 地址。

端口由三元组标识，`<IP addr, Port number, protocol>`因此如果您的 IP 地址更改，端口也会更改。

你真的想在这里做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:31:16.890

我完全不确定您要完成什么，但我有一个猜测......您是否正在尝试进行某种故障转移？如果是这样，那么确实有办法做到这一点，但为什么不在操作系统而不是应用程序中做到这一点呢？

一方面您可以使用[CARP](http://en.wikipedia.org/wiki/Common_Address_Redundancy_Protocol)，另一方面您可以在故障转移模式下使用接口中继/绑定（术语不同）。

# asp.net - 是否有任何好的 ASP.NET Stock Photo 应用程序？

> ID：826364
> 
> 赞同：0
> 
> 时间：2009-05-05T18:48:41.677
> 
> 标签：asp.net, photos

我正在查看我们自己的照片网站上整理我和一些朋友的照片。为了节省我一些时间，我想知道是否有人知道在 ASP.NET 中构建的好的照片应用程序？

我用谷歌搜索并没有想出太多.. 寻找人们能够从该网站购买的能力以及带有水印的图像，因此人们无法窃取它们:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T18:51:31.030

[Phanfare](http://www.phanfare.com/home.aspx)是在 .NET 中构建的，但它们是商业机构。有[一个可用的公共 API](http://help.phanfare.com/index.php/API)，所以你可能会得到一些快乐....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:43:31.030

[Gallery Source Pro](http://www.galleryserverpro.com/)是一款可能值得研究的开源应用程序。我短暂地试用了编译版本，但在 64 位上下机器上使用开源代码应用程序时遇到了重大问题并放弃了。它看起来确实相当灵活，我相信它可以为图像添加水印。

# mysql - 如何在两个不同的表上添加两个 count(*) 结果？

> ID：826365
> 
> 赞同：76
> 
> 时间：2009-05-05T18:48:45.873
> 
> 标签：mysql, count, sum

我有两张桌子：玩具和游戏。

```
+--------------------+------------------+
| Field              | Type             |
+--------------------+------------------+
| toy_id             | int(10) unsigned |
| little_kid_id      | int(10) unsigned |
+--------------------+------------------+

+--------------------+------------------+
| Field              | Type             |
+--------------------+------------------+
| game_id            | int(10) unsigned |
| little_kid1        | int(10) unsigned |
| little_kid2        | int(10) unsigned |
| little_kid3        | int(10) unsigned |
+--------------------+------------------+ 
```

一个小孩可以有多个玩具。一个小孩可以同时参加多个游戏。

我想要一个查询，它会给我一个 little_kid 参与的玩具和游戏的总数。

基本上，我想要这两个查询的总和：

```
从 little_kid_id = 900 的玩具中选择计数（*）；
从游戏中选择 COUNT(*) little_kid1 = 900
                              或 little_kid2 = 900
                              或 little_kid3 = 900；

```

是否有可能在单个 SQL 查询中得到它？显然，我可以以编程方式对它们求和，但这不太理想。

（我意识到这个人为的例子使模式看起来效率低下。假设我们不能改变模式。）

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2009-05-05T18:50:30.517

将它们包装起来并使用子查询：

```
SELECT
(SELECT COUNT(*) FROM Toys WHERE little_kid_id = 900)+
(SELECT COUNT(*) from Games WHERE little_kid1 = 900 
                              OR little_kid2 = 900 
                              OR little_kid3 = 900)
AS SumCount 
```

瞧！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-02-16T10:15:24.470

```
SELECT
((SELECT COUNT(*) FROM Toys WHERE little_kid_id = 900)+
(SELECT COUNT(*) from Games WHERE little_kid1 = 900 
                              OR little_kid2 = 900 
                              OR little_kid3 = 900))
AS Sum FROM DUAL; 
```

[从 DUAL 表中选择](https://docs.oracle.com/cd/B19306_01/server.102/b14200/queries009.htm)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T18:52:05.677

```
SELECT COUNT(1) FROM
(
    SELECT 1 FROM Toys WHERE little_kid_id = 900
    UNION
    SELECT 1 FROM Games WHERE little_kid1 = 900
                        OR little_kid2 = 900
                        OR little_kid3 = 900
) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-05T23:06:53.317

根据此查询可能运行的次数以及数据更改的频率，您可以定期将数据放入聚合表中，如下所示：

```
CREATE TABLE aggregated (
    little_kid_id INT UNSIGNED,
    games_count INT UNSIGNED,
    toys_count INT UNSIGNED,
    PRIMARY KEY (little_kid_id)
); 
```

性能方面，它会很快就很热，并避免任何讨厌的子查询。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-08T09:33:55.290

试试这个...

```
db: mysql

SELECT  SUM(dum.tab) AS total FROM (
SELECT COUNT(b.category_id) AS tab FROM tblcategory AS b WHERE b.category_id=1
UNION  ALL
SELECT COUNT(a.category_id) AS tab FROM tblcategory AS a WHERE a.category_id=2
) AS dum 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-30T10:55:03.910

```
 SELECT  M.*,M.TOYSCOUNT+M.GAMECOUNT  
FROM (
    (SELECT COUNT(*) FROM Toys WHERE little_kid_id) AS TOYSCOUNT,
    (SELECT COUNT(*) from Games WHERE little_kid1 = 900 OR little_kid2 = 900 OR little_kid3 = 900) AS GAMECOUNT
    ) M 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-04T18:35:41.830

```
SELECT COUNT(1) FROM
(
    (SELECT 1 FROM Toys WHERE little_kid_id = 900
    UNION
    SELECT 1 FROM Games WHERE little_kid1 = 900
                        OR little_kid2 = 900
                        OR little_kid3 = 900) as temptable
) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-04-12T04:03:33.327

```
select t1.tx,t2.px,t3.mx,t2.px + t3.mx  
        as total from(
SELECT COUNT (DISTINCT id) as tx
FROM Customer) as t1
cross join(
select COUNT (DISTINCT name) as px
FROM details 
) as t2
cross join(
select count (distinct device_id) as mx
from detailconfig 
) as t3 
```

# asp.net - 无法从 VB 中检索表单值

> ID：826366
> 
> 赞同：1
> 
> 时间：2009-05-05T18:48:57.073
> 
> 标签：asp.net, vb.net, dotnetnuke

我为我的网站创建了一个模块，当单击一个按钮时，它会调用服务器上的一个 VB 子程序。

我需要这个 sub 来检索表单上填写的值，但我需要从中检索值的东西不是 asp 控件，它们很简单`<input>`和`<select>`标签。

如何从后面执行的 VB 代码中检索 .aspx 页面上的输入值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T18:53:42.553

你去：[http ://www.geekpedia.com/KB16_How-do-I-get-the-values-when-submitting-a-form-(either-using-GET-or-POST).html](http://www.geekpedia.com/KB16_How-do-I-get-the-values-when-submitting-a-form-(either-using-GET-or-POST).html)

在你的 sub 中，你必须使用*request*对象。更多信息在这里：http: [//msdn.microsoft.com/en-us/library/aa231199 (VS.60).aspx](http://msdn.microsoft.com/en-us/library/aa231199(VS.60).aspx)

希望这对你有帮助；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T19:02:50.283

你的 HTML

```
<input id="firstName" name="firstName /> 
```

你的 VB.NET

```
Dim firstName as String = Request.Form("firstName") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T18:52:56.843

使用`Request.Form object`POST。或`Request.QueryString`用于 GET。

# c# - Inverse String.Replace - 更快的方法？

> ID：826370
> 
> 赞同：7
> 
> 时间：2009-05-05T18:49:19.957
> 
> 标签：c#, performance, string, stringbuilder

我有一种方法可以替换除我指定的字符之外的每个字符。例如，

```
ReplaceNot("test. stop; or, not", ".;/\\".ToCharArray(), '*'); 
```

会回来

```
“****.*****;***,****”。

```

现在，这不是过早优化的一个例子。我在网络操作期间多次调用此方法。我发现在较长的字符串上，它会导致一些延迟，删除它会有所帮助。任何有助于加快这一进程的帮助将不胜感激。

```
 public static string ReplaceNot(this string original, char[] pattern, char replacement)
    {           
        int index = 0;
        int old = -1;

        StringBuilder sb = new StringBuilder(original.Length);

        while ((index = original.IndexOfAny(pattern, index)) > -1)
        {
            sb.Append(new string(replacement, index - old - 1));
            sb.Append(original[index]);
            old = index++;
        }

        if (original.Length - old > 1)
        {
            sb.Append(new string(replacement, original.Length - (old + 1)));
        }

        return sb.ToString();
    } 
```

最后#。我还为 3K 字符串添加了一个测试用例，以 100K 次而不是 1M 次运行，以查看每个缩放的效果。唯一令人惊讶的是正则表达式比其他表达式“缩放得更好”，但这无济于事，因为它开始时非常慢：

```
用户短*1M长*100K规模
约翰 319 2125 6.66
路加福音 360 2659 7.39
古法 409 2827 6.91
矿山 447 3372 7.54
DirkGently 1094 9134 8.35
迈克尔 1591 12785 8.04
彼得 21106 94386 4.47

```

更新：我为彼得版本的正则表达式创建一个静态变量，并将其设置为 RegexOptions.Compiled 以公平起见：

```
用户短*1M长*100K规模
彼得 8997 74715 8.30

```

Pastebin 链接到我的测试代码，如果有错误请纠正我： [http://pastebin.com/f64f260ee](http://pastebin.com/f64f260ee)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T18:55:23.250

你不能像这样使用 Regex.Replace：

```
Regex regex = new Regex(@"[^.;/\\]");
string s = regex.Replace("test. stop; or, not", "*"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-05T18:55:49.177

好吧，在大约 60KB 的字符串上，这将比您的版本快 40%：

```
public static string ReplaceNot(this string original, char[] pattern, char replacement)
{
    int index = 0;

    StringBuilder sb = new StringBuilder(new string(replacement, original.Length));

    while ((index = original.IndexOfAny(pattern, index)) > -1)
    {
        sb[index] = original[index++];
    }

    return sb.ToString();
} 
```

诀窍是用所有替换字符初始化一个新字符串，因为它们中的大多数都将被替换。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T19:11:07.363

我不知道这是否会更快，但它避免了更新字符串，以便它们可以附加到字符串生成器，这可能会有所帮助：

```
 public static string ReplaceNot(this string original, char[] pattern, char replacement)
    {
        StringBuilder sb = new StringBuilder(original.Length);

        foreach (char ch in original) {
            if (Array.IndexOf( pattern, ch) >= 0) {
                sb.Append( ch);
            }
            else {
                sb.Append( replacement);
            }
        }

        return sb.ToString();
    } 
```

如果其中的字符数`pattern`是任意大小（我猜它通常不会），则可能需要对其进行排序并执行 an`Array.BinarySearch()`而不是`Array.indexOf()`.

对于如此简单的转换，我敢打赌，它也不会比正则表达式更快。

此外，由于您的字符集`pattern`可能通常来自字符串（至少这是我对此类 API 的一般经验），为什么您没有方法签名：

```
public static string ReplaceNot(this string original, string pattern, char replacement) 
```

或者更好的是，在哪里`pattern`可以是 a`char[]`或`string`?

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T23:24:14.663

这是给你的另一个版本。我的测试表明它的性能相当不错。

```
public static string ReplaceNot(
    this string original, char[] pattern, char replacement)
{
    char[] buffer = new char[original.Length];

    for (int i = 0; i < buffer.Length; i++)
    {
        bool replace = true;

        for (int j = 0; j < pattern.Length; j++)
        {
            if (original[i] == pattern[j])
            {
                replace = false;
                break;
            }
        }

        buffer[i] = replace ? replacement : original[i];
    }

    return new string(buffer);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T19:56:23.230

StringBuilder 有一个重载，它接受一个字符和一个计数，因此您不必创建中间字符串来添加到 StringBuilder。通过替换这个，我得到了大约 20% 的改进：

```
sb.Append(new string(replacement, index - old - 1)); 
```

和：

```
sb.Append(replacement, index - old - 1); 
```

还有这个：

```
sb.Append(new string(replacement, original.Length - (old + 1))); 
```

和：

```
sb.Append(replacement, original.Length - (old + 1)); 
```

（我测试了你说的代码快了大约四倍，我发现它慢了大约 15 倍......）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T18:53:32.693

这将是 O(n)。您似乎将所有字母和空格替换为`*`，为什么不测试当前字符是否为字母/空格并替换它？

# asp.net-mvc - 将行添加到 MVCContrib 网格

> ID：826371
> 
> 赞同：2
> 
> 时间：2009-05-05T18:49:37.023
> 
> 标签：asp.net-mvc, grid

我正在开发我的第一个 MVC 网站，并且正在尝试一些可用的网格。我真的很喜欢 MVCContrib 网格，但是我需要实现一个标准的“添加新记录”功能，而且我没有看到一种清晰的方法来将单个记录添加到数据库和网格中，而不必每次都重新加载整个网格。

我知道有一个 jQuery 网格插件，如果没有使用 MVCContrib 的好方法，我会朝那个方向发展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T04:22:04.183

环顾四周后，似乎我最好的解决方案是像 jQuery 或 ExtJS 这样的框架。MVCContrib Grid 还没有，如果有的话。

# windows - 如何在 Emacs 中使用 SVN（psvn 无法创建隧道）

> ID：826373
> 
> 赞同：1
> 
> 时间：2009-05-05T18:49:52.470
> 
> 标签：windows, svn, emacs

我们刚刚在我的办公室安装了 svn。TortoiseSVN 工作（用 putty 做 ssh 的事情——对不起，如果这不完全有意义，我是一个完全的 svn 新手，我一直使用 cvs）。我为 emacs 找到了 psvn，这似乎很标准。当我尝试运行它时，它说它找不到svn。所以我从 tigris.org 下载了客户端——它实际上将我重定向到一个名为 CollabNet 的地方，让我注册用户名和密码只是为了下载 svn 客户端——仍然不知道那是什么。

反正。Looong 简而言之：现在 emacs 告诉我“无法创建隧道：系统找不到指定的文件。” 当我尝试在文件上显示修订日志时。

谁能告诉我如何用emacs设置svn？不必按照上面的步骤，我可以重新开始。我只想要一个可以使用 emacs 的客户端。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T19:12:24.990

找到以下内容并且有效：

> 设置以下环境变量（通过右键单击我的电脑、属性、高级、环境变量、新建）：-
> 
> 变量名：SVN_SSH
> 
> 变量值：C:\\Program Files\\TortoiseSVN\\bin\\TortoisePlink.exe
> 
> （“\\”非常重要，否则将不起作用。同样，您不能使用putty附带的plink.exe，因为它会启动一个非常烦人的命令shell窗口。TortoisePlink.exe是一个窗口不显示任何 UI 的 plink 实现）

资料来源：[http ://www.woodwardweb.com/java/howto_configure.html](http://www.woodwardweb.com/java/howto_configure.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T19:00:24.270

如果 TortoiseSVN 已经适合您，请尝试使用“tortoise-svn.el”

[乌龟-svn.el](http://www.emacswiki.org/emacs/tortoise-svn.el)

[Emacs Wiki - 版本控制类别](http://www.emacswiki.org/emacs/CategoryVersionControl)

# java - 从 Java 调用 MATLAB 时，如何抑制它的命令窗口？

> ID：826384
> 
> 赞同：1
> 
> 时间：2009-05-05T18:52:47.220
> 
> 标签：java, matlab

我正在用 Java 调用 MATLAB，但我想抑制 MATLAB 的命令窗口，让用户觉得我只使用一个 Java 程序。

此外，我还阅读了有关 MATLAB 的独立可执行文件的信息，但它没有用；这对我有帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:39:15.407

查看[Matlab 引擎](http://www.mathworks.com/access/helpdesk/help/techdoc/matlab_external/f29148.html)。引擎在后台运行（没有 GUI 或可见的命令行），您可以从代码中调用它。不幸的是，这些示例是用 C 和 Fortran 编写的，而不是 Java。我曾经让它与 Python 一起工作，但我不记得细节了。

另请参阅：[2 种使用 Java 引擎的方法](http://matlabdb.mathematik.uni-stuttgart.de/download.jsp?MC_ID=9&MP_ID=163)。

ETA: (Windows) 命令行上的“matlab -r "statement"" 将在 Matlab 中执行 "statement"。我的 Python hack 是将我的 Matlab 代码放入 .m 文件中，并将我的数据放入 .m 文件引用的文本文件中，然后将“matlab -r myFile.m”发送到 Windows 命令行。请参阅[matlab Windows 命令](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/matlabwindows.html)。同样，这种方式对于 Matlab 没有可见的 GUI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T03:28:49.270

当您说“从 Java 调用它”时，您是在向 Matlab 进行批量计算，还是想在您的进程中嵌入一个长期存在的 Matlab 会话并从 Java 代码中重复调用 M 代码？你想在什么操作系统上运行？

Matlab 有一些部署工具，可让您将 Matlab 解释器和 Matlab 源代码集合嵌入到宿主语言中，例如 C/C++ 或 Java。这就是“Matlab 编译器”的含义——不是真正的编译器，而是一种将 Matlab 运行时与 .m 源代码打包到一个看起来像 DLL 或应用程序的包中的工具。Matlab“独立应用程序”是以这种方式打包的 Matlab 代码以及调用 M 代码中的应用程序入口点的薄 C 包装器。

[Matlab Java Builder](http://www.mathworks.com/products/javabuilder/)是一个类似的东西，它将这个部署的 Matlab 引擎捆绑在一个 Java 类中。如果您想获得它的许可证，那么将 Matlab 嵌入到您的 Java 应用程序中会变得容易且美观。这可能就是你想要的。

这些部署的 Matlab 应用程序没有命令窗口，因为它们旨在与您的应用程序融为一体。他们生活在同一个过程中。而且，重要的是，它们不需要许可费用来运行已部署的应用程序。脱壳到常规 Matlab 要求所有运行它的用户都拥有 Matlab 和使用的每个工具箱的许可证。

如果脱壳，“matlab -nosplash -nodesktop”命令行将抑制 Unix 上的 GUI。但在 Windows 上，您仍然会得到一个最小的 Matlab 命令窗口。Windows 上的“-automation”开关至少会使其最小化。我不知道在启动时完全抑制它的方法。

但是，一旦 Matlab 运行，您就可以利用 Matlab GUI 本身是用 Java 实现的这一事实，并将其隐藏起来。使用“-r”命令行开关或 startup.m 让您的 Matlab 会话运行此 hidematlab()。请注意，这是使用未记录的 Matlab 内部的 hack，而且 MathWorks 肯定不支持。

```
function hidematlab()
%HIDEMATLAB Hide the main Matlab desktop window (HACK)

dtWin = desktopwindow();
if ~isempty(dtWin)
    dtWin.setVisible(0);
end

function out = desktopwindow()
%DESKTOPWINDOW Find the main Matlab desktop window (HACK)

wins = java.awt.Window.getOwnerlessWindows();
out = [];
for i = 1:numel(wins)
    if isa(wins(i), 'com.mathworks.mde.desk.MLMainFrame')
        out = wins(i);
        return;
    end
end 
```

在 Windows 上进行炮击时要当心陷阱，因为 Matlab 本质上是一个 GUI 应用程序。如果您的 M 代码抛出了冒泡到顶层或段错误的错误，您可能会发现您的 Matlab 会话挂起，等待不存在的用户输入，而不是返回错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-09T00:07:35.533

[matlabcontrol](http://matlabcontrol.googlecode.com)是一个 Java API，它允许您与正在运行的 MATLAB 会话进行交互。它将启动会话，然后您将能够调用 eval 和 feval 以及设置和获取变量。默认情况下，MATLAB 的会话是可见的，但[可以隐藏](http://matlabcontrol.googlecode.com/svn/javadocs/doc/matlabcontrol/MatlabProxyFactoryOptions.Builder.html#setHidden%28boolean%29)。在 Windows 上，它不会完全隐藏，因为 MATLAB 不支持，但它会以最小化的方式启动，并且不会显示初始屏幕。要开始使用 matlabcontrol，请查看[演练](http://code.google.com/p/matlabcontrol/wiki/Walkthrough)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T19:17:00.530

我不知道有什么方法可以完全按照您的要求进行。如果您的脚本手动退出而不是自然终止，则您可以启动脚本以最小化弹出的窗口。

看[从 Java 以最小化状态启动应用程序](https://stackoverflow.com/questions/683427)

启动脚本

```
 matlab -nojvm -nosplash -nodesktop -wait -r script_name 
```

您将需要“-wait”，否则 MATLAB 将立即返回。

看[如何在命令行脚本完成之前阻止 MATLAB 返回？](https://stackoverflow.com/questions/14495)

# java - Spring MVC，使用 setDisallowedFields 时用于“添加”和“更新”的一个控制器？

> ID：826385
> 
> 赞同：3
> 
> 时间：2009-05-05T18:52:48.203
> 
> 标签：java, spring-mvc

所以我有一个简单的表格，我可以通过它“添加”一个新事物，或者“更新”一个现有的事物。

我想要的是拥有一个可以同时处理添加和更新的控制器。一开始这似乎很简单，直到我考虑在我的 InitBinder 中使用 setDisallowedFields 的问题，以便在添加新事物时不允许使用“id”字段。

目前我有两个控制器，除了 InitBinder 方法之外，它们的代码可能相同。

有什么建议或建议吗？（如果你能给我充分的理由，我也愿意维护两个控制器的论点）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-11T01:29:31.480

实际上，您应该在添加和更新时都禁止“id”字段。否则，恶意用户可能会篡改更新请求的“id”请求参数的值，从而将不同的记录更新为表单显示的记录（假设没有 ACL 或其他域级安全性）。

但是，如果您只是禁止“id”字段，控制器会将 ID 视为 null，这将在插入时起作用，但在更新时不起作用（例如，它可能会尝试插入新记录而不是更新，这取决于您使用的持久性机制'正在使用）。因此，您希望控制器在请求之间记住域对象的不可编辑值（不仅是 ID，还包括所有不允许的字段），以便它可以将所有正确的值发送到服务层或其他业务逻辑。这是使用类型级别的 @SessionAttributes 注释完成的，如下所示（为清楚起见，省略了其他注释）：

```
@SessionAttributes("thing") // the name of your domain object in the model
public class ThingController {

    public void setDisallowedFields(WebDataBinder binder) {
        binder.setDisallowedFields("id", "someOtherUneditableField");
    }

    // request handling methods go here as before
} 
```

为了更好的安全性，设置允许的字段而不是不允许的字段。无论哪种方式，您都需要 @SessionAttributes 注释来填充请求中忽略的任何现有字段值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T18:59:36.533

`initBinder`要接受的方法签名`HttpServletRequest`：

```
protected void initBinder(HttpServletRequest request, 
    ServletRequestDataBinder binder) 
```

所以也许你可以`initBinder()`检查请求参数来确定你是否应该有条件地设置`setDisallowedFields`？

（如果这没有帮助，也许我没有正确理解这个问题......）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T07:35:57.527

我使用单个控制器执行此操作的方法是在我的命令对象上有一个布尔值，指示它是否是一个新对象。在 onSubmit 中，我可以检查布尔值以查看是否需要执行添加或更新操作。

# java - ZipInputStream 不报告读取的*实际*（即压缩）字节

> ID：826390
> 
> 赞同：4
> 
> 时间：2009-05-05T18:53:31.367
> 
> 标签：java, inputstream, unzip

喜欢这个网站！我的问题如下：

我正在读取来自 HTTP“PUT”请求的网络的 zip 文件。请求标头告诉我 Content-Length 是（比如说）1Mb。以下代码创建 ZipInputStream，并将 zip 内容保存到当前目录中的文件中：

```
ZipInputStream zis = new ZipInputStream(inputStream);
ZipEntry ze;
long totalBytesRead = 0;
while ((ze = zis.getNextEntry()) != null) {
    BufferedOutputStream outStream = new BufferedOutputStream(new FileOutputStream(ze.getName()));
    byte[] buffer = new byte[4096];
    int i;
    while ((i = zis.read(buffer)) != -1) {
        totalBytesRead+=i;
        outStream.write(buffer,0,i);
    } 
    outStream.close();
}
inputStream.close(); 
```

总而言之，`totalBytesRead`大约等于 1.5Mb（取决于文件的压缩，可能是任何东西！）。我想知道的是，是否有办法找出从原始文件中读取了多少实际字节`inputStream`？两者都`ze.getSize()`为`ze.getCompressedSize()`每个压缩条目返回 -1（即它不知道）。我需要此信息作为进度条，以显示已从网络读取传输的 zip 文件的字节数。

建议？我是否应该将 ZipInputStream 子类化并尝试找出它从包装的 InputStream 中读取的字节数？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:20:58.667

```
import java.io.FilterInputStream;
import java.io.IOException;
import java.io.InputStream;

/**
 * 
 */

/**
 * @author clint
 * 
 */
public class ByteCountingInputStream extends FilterInputStream {

  public int totalRead = 0;

  /**
   * @param in
   */
  protected ByteCountingInputStream(InputStream in) {
    super(in);
    // TODO Auto-generated constructor stub
  }

  /* (non-Javadoc)
   * @see java.io.FilterInputStream#read()
   */
  @Override
  public int read() throws IOException {
    int ret = super.read();
    totalRead++;
    return ret;
  }

  /* (non-Javadoc)
   * @see java.io.FilterInputStream#read(byte[], int, int)
   */
  @Override
  public int read(byte[] b, int off, int len) throws IOException {
    int ret = super.read(b, off, len);
    totalRead += ret;
    return ret;
  }

  /* (non-Javadoc)
   * @see java.io.FilterInputStream#read(byte[])
   */
  @Override
  public int read(byte[] b) throws IOException {
    int ret = super.read(b);
    totalRead += ret;
    return ret;
  }

  /* (non-Javadoc)
   * @see java.io.FilterInputStream#skip(long)
   */
  @Override
  public long skip(long n) throws IOException {
    //What to do?
    return super.skip(n);
  }

  /**
   * @return the totalRead
   */
  protected int getTotalRead() {
    return this.totalRead;
  }

} 
```

这介于两者之间

```
ZipInputStream zis = new ZipInputStream(new ByteCountingInputStream(inputStream)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T19:26:05.360

谢谢你俩！我刚刚完全按照克林特的建议完成了！

```
import java.io.FilterInputStream;
import java.io.IOException;
import java.io.InputStream;

public class CountingInputStream extends FilterInputStream {

    private long totalBytes = 0;

    protected CountingInputStream(InputStream in) {
        super(in);
    }

    public int getTotalBytesRead() {
        return totalBytes;
    }

    @Override
    public int read() throws IOException {
        int byteValue = super.read();
        if (byteValue != -1) totalBytes++;
        return byteValue;
    }

    @Override
    public int read(byte[] b) throws IOException {
        int bytesRead = super.read(b);
        if (bytesRead != -1) totalBytes+=bytesRead;
        return bytesRead;
    }

    @Override
    public int read(byte[] b, int off, int len) throws IOException {
        int bytesRead = super.read(b,off,len);
        if (bytesRead != -1) totalBytes+=bytesRead;
        return bytesRead;
    }
} 
```

现在我想知道我应该给谁打一个小小的“复选标记”……？

再次感谢！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T19:00:21.133

当然，这似乎是合理的。

基本上有两种选择：读取所有字节，将它们存储（在内存或文件中），计算它们，然后解压缩它们；或者在它们进入时对其进行计数。前者似乎效率低下，后者将需要一个子类，该子类`InputStream`能够计算它读取的字节数。我想不出标准库中的一个，但实现可能存在于那里 - 然后再一次编写你自己的很容易。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-03-01T14:48:08.327

这就是我所做的......无需覆盖任何东西。

```
ZipInputStream zis = new ZipInputStream(inputStream);
ZipEntry ze;
int totalBytes = inputStream.available();
int totalBytesRead = 0;
while ((ze = zis.getNextEntry()) != null) {
    totalBytesRead = totalBytes - inputStream.available();
    BufferedOutputStream outStream = new BufferedOutputStream(new FileOutputStream(ze.getName()));
    byte[] buffer = new byte[4096];
    int i;
    while ((i = zis.read(buffer)) != -1) {
        outStream.write(buffer,0,i);
    } 
    outStream.close();
}
inputStream.close(); 
```

# windows-vista - MSMQ Vista x64

> ID：826392
> 
> 赞同：1
> 
> 时间：2009-05-05T18:53:36.733
> 
> 标签：windows-vista, 64-bit, msmq, transactionscope

我在我的系统上运行 Vista Ultimate x64。我有一个在远程服务器上运行良好的应用程序，可以将消息发送到在其上运行的 MSMQ 实例。当我将应用程序带到本地系统并尝试发送消息时，它不会发送，但也不会出错。我什至尝试设置一个本地 MSMQ 实例，同样的情况也发生在那个实例上——没有错误，但也没有消息。队列是事务性的，代码本身是基于事务的。

有什么建议么？我尝试实现日志选项（假设这就像日志记录）并且它没有记录任何内容。

我通过事件查看器挖掘，我看到的唯一错误（实际上是警告）是：

*MSDTC 在尝试与系统 [ComputerName] 建立安全连接时遇到错误 (HR=0x80000171)*

所有标准的东西都经过检查，如防火墙、MSMQ 是否正在运行等，当我将应用程序原封不动地放在远程服务器上时，它 100% 的时间都在工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-30T16:11:20.873

问题不在于 MSMQ 直接。您正在使用需要正确设置和配置 MSDTC 的事务队列。

# c# - 是否可以动态编译和执行 C# 代码片段？

> ID：826398
> 
> 赞同：201
> 
> 时间：2009-05-05T18:55:34.513
> 
> 标签：c#, compilation, dynamic-compilation

我想知道是否可以将 C# 代码片段保存到文本文件（或任何输入流）中，然后动态执行它们？假设提供给我的内容可以在任何 Main() 块中正常编译，是否可以编译和/或执行此代码？出于性能原因，我更愿意编译它。

至少，我可以定义一个他们需要实现的接口，然后他们会提供一个实现该接口的代码“部分”。

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-05-05T19:03:40.173

C#/所有静态 .NET 语言中的最佳解决方案是将[CodeDOM](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)用于此类事情。（请注意，它的另一个主要目的是动态构建代码位，甚至是整个类。）

[这是来自LukeH 的博客](http://blogs.msdn.com/lukeh/archive/2007/07/11/c-3-0-and-codedom.aspx)的一个很好的简短示例，它使用一些 LINQ 也只是为了好玩。

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.CSharp;
using System.CodeDom.Compiler;

class Program
{
    static void Main(string[] args)
    {
        var csc = new CSharpCodeProvider(new Dictionary<string, string>() { { "CompilerVersion", "v3.5" } });
        var parameters = new CompilerParameters(new[] { "mscorlib.dll", "System.Core.dll" }, "foo.exe", true);
        parameters.GenerateExecutable = true;
        CompilerResults results = csc.CompileAssemblyFromSource(parameters,
        @"using System.Linq;
            class Program {
              public static void Main(string[] args) {
                var q = from i in Enumerable.Range(1,100)
                          where i % 2 == 0
                          select i;
              }
            }");
        results.Errors.Cast<CompilerError>().ToList().ForEach(error => Console.WriteLine(error.ErrorText));
    }
} 
```

这里最重要的类是`CSharpCodeProvider`利用编译器动态编译代码的类。如果你想然后运行代码，你只需要使用一点反射来动态加载程序集并执行它。

[这](https://simeonpilgrim.com/blog/2007/12/04/compiling-and-running-code-at-runtime/)是 C# 中的另一个示例（虽然稍微不那么简洁），它还准确地向您展示了如何使用`System.Reflection`命名空间运行运行时编译的代码。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2015-04-02T15:43:51.413

[您可以将一段 C# 代码编译到内存中，并](http://www.tugberkugurlu.com/archive/compiling-c-sharp-code-into-memory-and-executing-it-with-roslyn)使用 Roslyn 生成汇编字节。已经提到过，但值得在这里添加一些 Roslyn 示例。以下是完整的示例：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Reflection;
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.CSharp;
using Microsoft.CodeAnalysis.Emit;

namespace RoslynCompileSample
{
    class Program
    {
        static void Main(string[] args)
        {
            // define source code, then parse it (to the type used for compilation)
            SyntaxTree syntaxTree = CSharpSyntaxTree.ParseText(@"
                using System;

                namespace RoslynCompileSample
                {
                    public class Writer
                    {
                        public void Write(string message)
                        {
                            Console.WriteLine(message);
                        }
                    }
                }");

            // define other necessary objects for compilation
            string assemblyName = Path.GetRandomFileName();
            MetadataReference[] references = new MetadataReference[]
            {
                MetadataReference.CreateFromFile(typeof(object).Assembly.Location),
                MetadataReference.CreateFromFile(typeof(Enumerable).Assembly.Location)
            };

            // analyse and generate IL code from syntax tree
            CSharpCompilation compilation = CSharpCompilation.Create(
                assemblyName,
                syntaxTrees: new[] { syntaxTree },
                references: references,
                options: new CSharpCompilationOptions(OutputKind.DynamicallyLinkedLibrary));

            using (var ms = new MemoryStream())
            {
                // write IL code into memory
                EmitResult result = compilation.Emit(ms);

                if (!result.Success)
                {
                    // handle exceptions
                    IEnumerable<Diagnostic> failures = result.Diagnostics.Where(diagnostic => 
                        diagnostic.IsWarningAsError || 
                        diagnostic.Severity == DiagnosticSeverity.Error);

                    foreach (Diagnostic diagnostic in failures)
                    {
                        Console.Error.WriteLine("{0}: {1}", diagnostic.Id, diagnostic.GetMessage());
                    }
                }
                else
                {
                    // load this 'virtual' DLL so that we can use
                    ms.Seek(0, SeekOrigin.Begin);
                    Assembly assembly = Assembly.Load(ms.ToArray());

                    // create instance of the desired class and call the desired function
                    Type type = assembly.GetType("RoslynCompileSample.Writer");
                    object obj = Activator.CreateInstance(type);
                    type.InvokeMember("Write",
                        BindingFlags.Default | BindingFlags.InvokeMethod,
                        null,
                        obj,
                        new object[] { "Hello World" });
                }
            }

            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-05-05T19:47:45.123

其他人已经就如何在运行时生成代码给出了很好的答案，所以我想我会解决你的第二段。我对此有一些经验，只想分享我从那次经历中学到的教训。

> 至少，我可以定义一个他们需要实现的接口，然后他们会提供一个实现该接口的代码“部分”。

如果您使用 an`interface`作为基本类型，您可能会遇到问题。`interface`如果您在未来添加一个新方法，那么所有现有的客户端提供的实现`interface`now 的类都将变为抽象，这意味着您将无法在运行时编译或实例化客户端提供的类。

在发布旧界面大约 1 年并分发大量需要支持的“遗留”数据之后，当需要添加新方法时，我遇到了这个问题。我最终创建了一个继承自旧接口的新接口，但这种方法使得加载和实例化客户端提供的类变得更加困难，因为我必须检查哪个接口可用。

我当时想到的一种解决方案是使用实际的类作为基类型，如下所示。类本身可以标记为抽象，但所有方法都应该是空的虚拟方法（不是抽象方法）。然后，客户可以覆盖他们想要的方法，我可以向基类添加新方法，而不会使现有的客户提供的代码无效。

```
public abstract class BaseClass
{
    public virtual void Foo1() { }
    public virtual bool Foo2() { return false; }
    ...
} 
```

不管这个问题是否适用，您都应该考虑如何对代码库和客户端提供的代码之间的接口进行版本控制。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-12-09T19:00:14.193

发现这很有用 - 确保编译的程序集引用您当前引用的所有内容，因为您很有可能希望您正在编译的 C# 在发出此代码的代码中使用某些类等：

（字符串`code`是正在编译的动态 C#）

```
 var refs = AppDomain.CurrentDomain.GetAssemblies();
        var refFiles = refs.Where(a => !a.IsDynamic).Select(a => a.Location).ToArray();
        var cSharp = (new Microsoft.CSharp.CSharpCodeProvider()).CreateCompiler();
        var compileParams = new System.CodeDom.Compiler.CompilerParameters(refFiles);
        compileParams.GenerateInMemory = true;
        compileParams.GenerateExecutable = false;

        var compilerResult = cSharp.CompileAssemblyFromSource(compileParams, code);
        var asm = compilerResult.CompiledAssembly; 
```

在我的例子中，我发出了一个类，它的名称存储在一个字符串中`className`，它有一个名为 的公共静态方法`Get()`，返回类型为`StoryDataIds`。下面是调用该方法的样子：

```
 var tempType = asm.GetType(className);
        var ids = (StoryDataIds)tempType.GetMethod("Get").Invoke(null, null); 
```

警告：编译可能会非常缓慢，非常缓慢。在我们相对较快的服务器上，一小段相对简单的 10 行代码在 2-10 秒内以正常优先级编译。您永远不应该将调用`CompileAssemblyFromSource()`与具有正常性能预期的任何事物联系起来，例如 Web 请求。相反，在低优先级线程上主动编译您需要的代码，并有办法处理需要该代码准备好的代码，直到它有机会完成编译。例如，您可以在批处理作业过程中使用它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-06-24T19:06:58.327

我最近需要为单元测试生成流程。这篇文章很有用，因为我创建了一个简单的类来使用作为字符串的代码或我的项目中的代码来做到这一点。要构建此类，您需要`ICSharpCode.Decompiler`和`Microsoft.CodeAnalysis`NuGet 包。这是课程：

```
using ICSharpCode.Decompiler;
using ICSharpCode.Decompiler.CSharp;
using ICSharpCode.Decompiler.TypeSystem;
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.CSharp;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Reflection;

public static class CSharpRunner
{
   public static object Run(string snippet, IEnumerable<Assembly> references, string typeName, string methodName, params object[] args) =>
      Invoke(Compile(Parse(snippet), references), typeName, methodName, args);

   public static object Run(MethodInfo methodInfo, params object[] args)
   {
      var refs = methodInfo.DeclaringType.Assembly.GetReferencedAssemblies().Select(n => Assembly.Load(n));
      return Invoke(Compile(Decompile(methodInfo), refs), methodInfo.DeclaringType.FullName, methodInfo.Name, args);
   }

   private static Assembly Compile(SyntaxTree syntaxTree, IEnumerable<Assembly> references = null)
   {
      if (references is null) references = new[] { typeof(object).Assembly, typeof(Enumerable).Assembly };
      var mrefs = references.Select(a => MetadataReference.CreateFromFile(a.Location));
      var compilation = CSharpCompilation.Create(Path.GetRandomFileName(), new[] { syntaxTree }, mrefs, new CSharpCompilationOptions(OutputKind.DynamicallyLinkedLibrary));

      using (var ms = new MemoryStream())
      {
         var result = compilation.Emit(ms);
         if (result.Success)
         {
            ms.Seek(0, SeekOrigin.Begin);
            return Assembly.Load(ms.ToArray());
         }
         else
         {
            throw new InvalidOperationException(string.Join("\n", result.Diagnostics.Where(diagnostic => diagnostic.IsWarningAsError || diagnostic.Severity == DiagnosticSeverity.Error).Select(d => $"{d.Id}: {d.GetMessage()}")));
         }
      }
   }

   private static SyntaxTree Decompile(MethodInfo methodInfo)
   {
      var decompiler = new CSharpDecompiler(methodInfo.DeclaringType.Assembly.Location, new DecompilerSettings());
      var typeInfo = decompiler.TypeSystem.MainModule.Compilation.FindType(methodInfo.DeclaringType).GetDefinition();
      return Parse(decompiler.DecompileTypeAsString(typeInfo.FullTypeName));
   }

   private static object Invoke(Assembly assembly, string typeName, string methodName, object[] args)
   {
      var type = assembly.GetType(typeName);
      var obj = Activator.CreateInstance(type);
      return type.InvokeMember(methodName, BindingFlags.Default | BindingFlags.InvokeMethod, null, obj, args);
   }

   private static SyntaxTree Parse(string snippet) => CSharpSyntaxTree.ParseText(snippet);
} 
```

要使用它，请调用以下`Run`方法：

```
void Demo1()
{
   const string code = @"
   public class Runner
   {
      public void Run() { System.IO.File.AppendAllText(@""C:\Temp\NUnitTest.txt"", System.DateTime.Now.ToString(""o"") + ""\n""); }
   }";

   CSharpRunner.Run(code, null, "Runner", "Run");
}

void Demo2()
{
   CSharpRunner.Run(typeof(Runner).GetMethod("Run"));
}

public class Runner
{
   public void Run() { System.IO.File.AppendAllText(@"C:\Temp\NUnitTest.txt", System.DateTime.Now.ToString("o") + "\n"); }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-05T18:59:55.970

要编译，您只需启动对 csc 编译器的 shell 调用。试图保持路径和开关笔直，您可能会头疼，但它肯定可以做到。

[C# 角壳示例](http://www.c-sharpcorner.com/UploadFile/DipalChoksi/ShellCommandsInCS12032005042031AM/ShellCommandsInCS.aspx)

**编辑**：或者更好的是，按照诺多林的建议使用 CodeDOM...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-07-28T12:16:39.807

```
using System.CodeDom.Compiler;
using System.Diagnostics;
using Microsoft.CSharp;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Text;
using System.Reflection;

namespace ASL
{
    class Program
    {
        [Obsolete]
        static void Main(string[] args)
        {
            string code = @"
                using System;

             namespace First
             {
                public class Program
                {
                  public static void Main()
                    {
                        " +
                        "Console.WriteLine(\"Hello, world!\");"
                        + @"
                    }
                }
             }";
            Console.WriteLine(code);
            CSharpCodeProvider provider = new CSharpCodeProvider();
            CompilerParameters parameters = new CompilerParameters();
            // Reference to System.Drawing library
            parameters.ReferencedAssemblies.Add("System.Drawing.dll");
            // True - memory generation, false - external file generation
            parameters.GenerateInMemory = true;
            // True - exe file generation, false - dll file generation
            parameters.GenerateExecutable = true;
            CompilerResults results = provider.CompileAssemblyFromSource(parameters, code);
            if (results.Errors.HasErrors)
            {
                StringBuilder sb = new StringBuilder();

                foreach (CompilerError error in results.Errors)
                {
                    sb.AppendLine(String.Format("Error ({0}): {1}", error.ErrorNumber, error.ErrorText));
                }

                throw new InvalidOperationException(sb.ToString());
            }
            Assembly assembly = results.CompiledAssembly;
            Type program = assembly.GetType("First.Program");
            MethodInfo main = program.GetMethod("Main");
            main.Invoke(null, null);
            Console.ReadLine();
        }
    }
} 
```

# svn - 在机器之间共享源代码

> ID：826405
> 
> 赞同：3
> 
> 时间：2009-05-05T18:57:19.597
> 
> 标签：svn, language-agnostic, version-control

在本地机器之间共享源代码的最佳方式是什么？

我正在开发一个带有 svn 存储库的跨平台项目。我在一个平台（可能是 osx）上执行结帐，并进行更改。然后，我必须在其他平台（xp、vista、...）上测试我修改过的代码，然后再签入。在机器之间手动复制文件或从网络驱动器运行所有内容是一件痛苦的事情......我有什么更好的选择？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T19:02:00.177

您也可以在 SVN 中为自己创建一个分支。然后你可以签入你的分支，检查所有测试机器上的分支代码，当你满意时，使用 SVN 的分支合并工具将你保存在分支中的所有更改合并回主干。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T19:02:04.203

您可以尝试在存储库中创建一个分支，仅用于您自己的更改。对分支进行更改，提交更改，然后在其他平台上签出分支并对其进行测试。如果一切正常，将分支与主干合并。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T18:59:57.950

你为什么不继续使用 svn.. 在你切换到另一个平台之前，检查并标记当前版本。结帐并在其他平台上进行测试。如果你失败了，只需恢复它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T19:03:28.817

我想说最好和最容易管理（一旦启动并运行，就是拥有一个自动部署到测试环境的开发分支，然后当你满意时，你可以合并到一个发布分支。需要一段时间来设置，但会从长远来看，可以为您节省很多时间。

它还允许您在处理其他项目时进行测试。

如果您不想遵循这一点，那么一个简单的 shell 脚本就足够了，您在部署时必须运行该脚本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T19:11:49.733

您总是可以尝试使用 Git 或其他一些 DVCS，它允许您在不每次都包括中央服务器的情况下共享内容。

Git 也允许您向/从 SVN 服务器推送/拉取（也称为提交/更新），但同时也为您提供了更多的回旋余地。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T19:02:01.113

研究独立于平台的网络磁盘挂载——比如 sshfs。检查一台计算机上的源，然后通过网络将该位置安装到另一台计算机上。

或者，在同一台计算机上的虚拟机中运行一个操作系统，然后以这种方式共享文件。像 VirtualBox 这样的虚拟机可以让您以类似的方式通过网络挂载访问主机的文件系统。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T19:03:33.637

我认为你在这里犯了一个基本错误。SVN（和其他适当的 VC 系统）的规则是“尽早且经常地签到，就像投票一样”。正如@Koray 所说，签入代码，从其他机器中签出并重建。否则，您将面临其他机器上的潜在更改无法恢复或需要合并不同更改集的风险。

诀窍是为最近测试的版本制作一个标签，以便在遇到问题时可以恢复到那个特定的快照。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T19:11:42.120

我会使用 Ant 之类的工具创建一个构建脚本，通过网络共享将我签出的源代码复制到我的一组不同的测试机器上。然后我将继续在每台机器上进行测试，但只对我签出的源进行更改 - 所有更改都使用构建脚本分发到我的测试机器。

一旦我感到满意，我就会从我正在构建的同一台机器上提交我的更改。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T19:25:24.740

基本问题是在签入之前进行测试。这正是问题所在。签入代码然后进行测试没有任何问题。使用源代码控制的目的是在某些东西不起作用时允许回滚。

我还从您的帖子中假设您独自从事该项目，因此问题更小。如果您在一个团队中工作，那么创建一个单独的 SVN 分支进行开发，然后在测试和开发完成时与主干合并。

Another option, use virtual machines.

# python - 列出理解和条件？

> ID：826407
> 
> 赞同：7
> 
> 时间：2009-05-05T18:57:53.790
> 
> 标签：python, list, list-comprehension

我正在尝试查看是否可以使用列表推导来更好地编写此代码。
可以说我有以下列表：

```
a_list = [
        'HELLO',
        'FOO',
        'FO1BAR',
        'ROOBAR',
        'SHOEBAR'
        ]

regex_list =   [lambda x: re.search(r'FOO', x, re.IGNORECASE),
                lambda x: re.search(r'RO', x, re.IGNORECASE)] 
```

我基本上想将所有没有任何匹配项的元素添加`regex_list`到另一个列表中。

例如 ==>

```
newlist = []
for each in a_list:
    for regex in regex_list:
        if(regex(each) == None):
            newlist.append(each) 
```

如何使用列表推导来做到这一点？甚至可能吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-05T19:02:28.990

当然，我认为应该这样做

```
newlist = [s for s in a_list if not any(r(s) for r in regex_list)] 
```

*编辑*：仔细检查后，我注意到您的示例代码实际上将每个`a_list`不匹配*所有*正则表达式的字符串添加到新列表中 - 而且，它为每个不匹配的正则表达式添加每个字符串一次。我的列表理解符合我的意思，即每个字符串只添加一个与*任何*正则表达式都不匹配的副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:14:04.097

我会将您的代码简化为：

```
a_list = [
          'HELLO',
          'FOO',
          'FO1BAR',
          'ROOBAR',
          'SHOEBAR'
          ]
regex_func = lambda x: not re.search(r'(FOO|RO)', x, re.IGNORECASE) 
```

然后你有两个选择：

1.  筛选

    `newlist = filter(regex_func, a_list)`

2.  列表推导

    `newlist = [x for x in a_list if regex_func(x)]`

# c# - 单声道中的 Sqlite，找不到 SQLiteConnection

> ID：826408
> 
> 赞同：0
> 
> 时间：2009-05-05T18:58:01.933
> 
> 标签：c#, sqlite, mono

我不知道如何纠正这个错误。

```
The type or namespace name `SQLiteConnection' could not be found. Are you missing a using directive or an assembly reference? 
```

我包括了参考 Mono.Data Mono.Data.Sqlite Mono.Data.SqliteClient 和一些不相关的参考。我在用

```
//using System.Data.SQLite; //<-- this line was all i needed in msvs
using Mono.Data.Sqlite;
using Mono.Data.SqliteClient;
using System;
using System.Data;
using Mono.Data.SqliteClient 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T19:23:46.270

您是否包含了来自[http://sqlite.phxsoftware.com/](http://sqlite.phxsoftware.com/)的参考资料（dll） ？
如果没有，请尝试这样做，它应该可以工作。

编辑：以上是如果你想使用 System.Data.SQLite，但你也可以使用内置的 Mono.Data.SqliteClient，如果你使用 Mono，它可能会更好。在这里阅读更多关于它的信息[http://www.mono-project.com/SQLite](http://www.mono-project.com/SQLite)。在他们的代码示例中，他们使用 SqliteConnection，而您似乎使用 SQLiteConnection，请注意不同的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T05:15:12.560

确保在编译时引用 DLL：

gmcs -r:Mono.Data.SqliteClient.dll myapp.cs

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-17T08:04:33.540

我遇到了同样的错误，部分原因是方法名称在 Windows 和 Mono 中的大小写不同：

```
Windows: SQLiteConnection
Mono:    SqliteConnection 
```

我得到了它的帮助，[在](https://stackoverflow.com/questions/40649414/anybody-know-why-mono-sqlite-uses-sqliteconnection-but-windows-uses-sqliteconnec)需要它的文件中使用了这个代码：

```
#if __MonoCS__
    using Mono.Data.Sqlite;
    using SQLiteCommand =     Mono.Data.Sqlite.SqliteCommand;
    using SQLiteConnection =  Mono.Data.Sqlite.SqliteConnection;
    using SQLiteException =   Mono.Data.Sqlite.SqliteException;
    using SQLiteParameter =   Mono.Data.Sqlite.SqliteParameter;
    using SQLiteTransaction = Mono.Data.Sqlite.SqliteTransaction;
#else
    using System.Data.SQLite;
#endif 
```

吉姆

# c# - c# 中的异步方法调用模式如何工作和实现？

> ID：826410
> 
> 赞同：0
> 
> 时间：2009-05-05T18:58:13.400
> 
> 标签：c#, .net, design-patterns

我正在基于[异步方法调用](http://en.wikipedia.org/wiki/Asynchronous_method_invocation)松散地移动大量代码。它通常是如何实现的（最好是在生产中）？

*   它是如何工作的？
*   它是如何使用的？
*   它是如何实施的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T19:10:53.073

模式通常如下：

*   您有一个`BeginXXX`方法，它接收所有输入和`ref`参数以及一个[`AsyncCallback`](http://msdn.microsoft.com/en-us/library/system.asynccallback.aspx)委托（可能为 null）和一个状态对象引用（也可能为 null）并返回一个[`IAsyncResult`](http://msdn.microsoft.com/en-us/library/system.iasyncresult.aspx). 调用此方法以开始调用，它或多或少地立即返回。
*   然后，您有一个`EndXXX`方法，该方法采用操作`IAsyncResult`返回的值以及要完成调用时调用的`BeginXXX`任何`ref`和参数（在回调之后，等待[事件中的事件](http://msdn.microsoft.com/en-us/library/system.iasyncresult.asyncwaithandle.aspx)或通过阻塞）。将返回方法结果（如果不是 void 方法）或抛出异常（如果方法抛出异常）。`out`[`IAsyncResult`](http://msdn.microsoft.com/en-us/library/system.iasyncresult.asyncwaithandle.aspx)`EndXXX`

查看 Stream 类或任何委托，它们为您提供了这些签名的示例。此外，[在 MSDN 上有异步调用的完整描述](http://msdn.microsoft.com/en-us/library/ms228975.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T20:01:24.917

The pattern is usually implemented via .NET's [IOCompletion port](http://msdn.microsoft.com/library/aa365198). This allows a small pool of threads to service many IO operations completing, with the `BeginX` calling the appropriate Win32 API to initiate an asynchronous operation, the implementation of IAsyncResult holding any state (associated with the underlying operation via the [`OVERLAPPED`](http://msdn.microsoft.com/library/ms684342) instance), and `EndX` picking up the result.

The details (and the other approaches) vary widely depending on the resource in question.

# sql - 在批处理结束时检测到不可提交的事务。事务回滚

> ID：826420
> 
> 赞同：4
> 
> 时间：2009-05-05T19:00:51.817
> 
> 标签：sql, sql-server

我们在服务器迁移方面遇到问题。我们有一个应用程序有这么多事务它在一台数据库服务器上运行良好。但是当将相同的数据库传输到另一台服务器时。我们面临以下错误。

> `Server: Msg 3998, Level 16, State 1, Line 1`
> `Uncommittable transaction is detected at the end of the batch. The transaction is rolled back.`

将相同的数据库与所有数据一起复制到另一台服务器。如果我们将连接字符串更改为旧服务器，那么它工作正常。

有人可以就此提出建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:29:24.323

此消息表示事务中的其他参与者之一投票支持回滚。之后，事务必须失败。

所以这个信息是一个结果，而不是一个原因。您是否收到任何早期/其他错误消息？

从 Management Studio 运行查询时会发生什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T20:40:29.973

您似乎遇到的问题是记录在一个数据库中是可以接受的，但在另一个数据库中是可以接受的。建议您查看两个数据库结构之间的差异（是的，我知道它们应该是相同的，但显然它们不是）。怀疑您会发现两者之间存在排序规则差异、数据类型差异或数据长度差异。您可能还有一个表，其中缺少身份定义，因此无法插入，因为它是必填字段并且缺少值。SQl Compare 之类的工具易于使用以找出差异。

# c# - 在 WCF 中为远程客户端报告了奇怪的端口

> ID：826423
> 
> 赞同：1
> 
> 时间：2009-05-05T19:01:30.850
> 
> 标签：c#, javascript, wcf

我有一个配置了 WebHttpBinding 的 IIS 托管 WCF 服务。当您创建一个新的时，它与 VS2008 创建的默认 WCF 服务相同。我所做的唯一更改是允许从 javascript 调用它。

在测试方法 GetData(int value) 中，我返回一个字符串，显示远程客户端 IP 地址、端口和用户代理。一切正常，除了我不期待它返回的端口号。我期待端口 80，但得到类似 49353 的东西。下面是我正在调用的方法。

```
public string GetData(int value)
    {
        OperationContext context = OperationContext.Current;

        MessageProperties messageProperties = context.IncomingMessageProperties;
        RemoteEndpointMessageProperty endpointProperty = messageProperties[RemoteEndpointMessageProperty.Name] as RemoteEndpointMessageProperty;

        return string.Format("Hello {0}! \r\naddress: {1}\r\nport: {2}\r\nuseragent: {3}", 
            value, endpointProperty.Address, endpointProperty.Port, WebOperationContext.Current.IncomingRequest.UserAgent);
    } 
```

就像我说的，我从 javascript 调用这个方法。IIS 是为端口 80 配置的，所以我不确定为什么端口被报告错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T19:07:00.447

我想你可能有点倒退了。端口 80 是您正在监听的地方，但是一旦发生这种情况，它就会将其传递给一个新的临时端口来处理该连接。

此外，客户端也可能使用临时端口打开与端口 80 的连接。因此，客户端的端口可能是典型“固定”端口范围 (0-1024) 之外的某个“随机”端口号。

# c# - Windows 窗体继承

> ID：826425
> 
> 赞同：6
> 
> 时间：2009-05-05T19:01:39.273
> 
> 标签：c#, .net, windows, winforms, inheritance

我想创建一堆具有相同属性的表单，并通过分配构造函数的参数来初始化表单构造函数中的属性。

我尝试创建一个从表单继承的类，然后让我的所有表单都从该类继承，但我认为由于我无法调用 InitializeComponent()，所以我遇到了一些问题。

关于如何执行此操作的一些 C# 代码是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T19:06:40.277

`InitializeComponent`应该通过像这样调用构造函数来调用父级`base()`：

```
public YourFormName() : base()
{
    // ...
} 
```

（你的父表单应该`InitializeComponent`在它的构造函数中有一个调用。你没有把它拿出来，是吗？）

但是，您要走的路并不适合设计师，因为您无法在设计时使用这些参数来实例化您的表单（您必须提供一个无参数的构造函数使其工作）。如果您在代码中使用参数化构造函数，您还会遇到第二次分配父属性或将它们分配为与您可能想要的不同的问题。

坚持只在表单上使用属性，而不是使用带参数的构造函数。对于 Forms，您会很头疼。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T19:07:42.847

这里继承的另一种模式是使用工厂来创建表单。这样您的工厂可以设置所有属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T19:24:28.907

创建一个接口并将其传递给表单的构造函数。

```
interface IFormInterface
{
      //Define Properties here
}

public MyForm(IFormInterface AClass)
{
      //Set Properties here using AClass
} 
```

虽然当我想做这样的事情时，我通常做的不仅仅是设置属性，所以我最终为默认行为创建了一个抽象类。

# c# - 将类别属性添加到 PropertyDescriptor

> ID：826437
> 
> 赞同：1
> 
> 时间：2009-05-05T19:04:51.433
> 
> 标签：c#, typedescriptor, propertydescriptor

我有一组自定义的 PropertyDescriptor，我也想添加类别，以便它们在 PropertyGrid 中以更有条理的方式显示。我希望每种类型的 PropertyDescriptor 进入一个特定的类别。

我尝试使用 TypeDescriptor.AddAttributes() 将属性添加到现有的 PropertyDescriptor，但未添加类别属性。

```
CategoryAttribute intrinsicPropertyCategory = new CategoryAttribute("Intrinsic Properties");
currentDescriptor = new IntrinsicPropertyDescriptor(def);
TypeDescriptor.AddAttributes(currentDescriptor, new Attribute[] { intrinsicPropertyCategory }); 
```

我还尝试在构造函数中为我的一个 PropertyDescriptor 使用 TypeDescriptor.AddAttributes()，如下所示。但它也不起作用。

```
public IntrinsicPropertyDescriptor(IntrinsicPropertyDef propDef): base(propDef.Key, propDef.Attributes)
{
this._type = propDef.Type;
this._key = propDef.Key;
this._readOnly = propDef.ReadOnly;

CategoryAttribute intrinsicPropertyCategory = new CategoryAttribute("Intrinsic Properties");
TypeDescriptor.AddAttributes(this, new Attribute[] { intrinsicPropertyCategory });
} 
```

我宁愿不花时间详细说明我为什么要做我正在做的事情。但在上面的示例中，IntrinsicPropertyDef 是一个定义属性的类，包括名称、显示名称和类型。所以 propDef.Attributes 包括 DisplayNameAttribute。

可以使用两个不同的自定义 PropertyDescriptor IntrinsicPropertyDescriptor 和 InferedIntrinsicPropertyDescriptor 来显示 IntrinsicPropertyDef。每个 IntrinsicPropertyDescriptor 都应该有一个类别属性“Intrinsic Properties”，每个 InferedIntrinsicPropertyDescriptor 都应该有一个类别属性“Inferred Intrinsic Properties”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T19:40:19.210

我*相信*你可以覆盖`Category`：

```
public override string Category { get {return "Foo";}} 
```

对于其他场景；通常使用 custom `PropertyDescriptor`，您可以在构造函数中指定属性。您需要扩展`Attribute[]`参数以包含`CategoryAttribute`. 如果需要做任何处理，可以使用静态方法——未经测试：

```
static Attribute[] AddCategory(Attribute[] attributes, string category) {
    Array.Resize(ref attributes, attributes.Length + 1);
    attributes[attributes.Length - 1] = new CategoryAttribute(category);
    return attributes;
}
public IntrinsicPropertyDescriptor(IntrinsicPropertyDef propDef)
     : base(propDef.Key, AddCategory(propDef.Attributes, "Foo"))
{...} 
```

* * *

另外 - 请注意，`PropertyDescriptor`要使用 a ，系统必须找到它......解析规则是：

*   for `PropertyGrid`，`TypeConverter`提供属性，默认为实例的属性（下）
*   例如：
    *   `ICustomTypeDescriptor`被检查
    *   否则它会检查`TypeDescriptionProvider`实例或类型的注册
    *   否则使用反射
*   对于一个类型：
    *   它检查一个注册`TypeDescriptionProvider`的类型
    *   否则使用反射
*   对于列表：
    *   `IListSource`检查并解析为列表（处理继续）
    *   `ITypedList`被检查
    *   否则，将检查列表类型是否存在非对象索引器 - 即`public SomeType this[int index] {get;}`
        *   如果找到，则使用该类型的属性`SomeType`，如上定义
    *   否则，如果列表不为空，则`list[0]`使用第一个实例 ( ) 的属性，如上定义
    *   否则，元数据不可用

# php - 用 PHP 搜索 MySQL

> ID：826439
> 
> 赞同：1
> 
> 时间：2009-05-05T19:05:40.870
> 
> 标签：php, mysql, search

我正在做一个项目，我希望一个人在文本框中输入任何艺术家/乐队的名称，它将在我的 mysql 数据库中搜索事件信息并在另一个页面上显示结果/内容。下面的代码在我的 index.php 中，它应该从 search.php 中获取信息（也在下面）。我已经看了一遍，我不确定为什么它不起作用，我不知道该怎么做。帮助会很棒！（我真的需要通过这门课！）:)

（索引.php）

```
<form name="search" action="search.php" method="get">
    <div align="center"><input type="text" name="q" />
    <p><input type="submit" name="Submit" value="Search" /></p>
</form> 
```

（搜索.php）

```
<?php

//Get the search variable from URL

$var=@&_GET['q'];
$trimmed=trim($var); //trim whitespace from the stored variable

//rows to return
$limit=10;

//check for an empty string and display a message.
if($trimmed=="")
    {
    echo"<p>Please enter a name.</p>";
    exit;
    }

//check for a search parameter
if(!isset($var))
    {
    echo"<p>We don't seem to have a search parameter!</p>";
    exit;
    }

//connect to database
mysql_connect("localhost","root","password");

//specify database
mysql_select_db("itour") or die("Unable to select database");

//Build SQL Query
$query = "select * from events where artist_name like \"%trimmed%\" order by date";

$numresults=mysql_query($query);
$numrows=mysql_num_rows(numresults);

//If no results, offer a google search as an alternative

if ($numrows==0)
    {
    echo"<h3>Results</h3>";
    echo"<p>Sorry, your search: &quot;" .$trimmed . "&quot; returned zero results</p>";

    //google
    echo"<p><a href=\"http://www.google.com/search?q=".$trimmed . "\" target=\"_blank\" title=\"Look up ".$trimmed ." on Google\">
    Click here</a> to try the search on google</p>";
    }

//next determine if s has been passed to script, if not use 0
if(empty($s)) {
    $s=0;
    }

//get results
$query .=" limit $s,$limit";
$result = mysql_query($query) or die("Couldn't execute query");

//display what was searched for
echo"<p>You searched for: &quot;" .$var . "&quot;</p>";

//begin to show results set
echo "Results";
$count = 1 + $s;

//able to display the results returned
while ($row=mysql_fetch_array($result)) {
$title = $row["artist_name"];

echo"$count.)&nbsp;$title";
$count++;
}

$currPage = (($s/$limit) + 1;

echo"<br  />";

//links to other results
if ($s>=1){
    //bypass PREV link if s is 0
    $prevs=($s-$limit);
    print"&nbsp;<a href=\"$PHP_SELF?s=$prevs&q=$var\">&lt;&lt;
    Prev 10</a>&nbsp;&nbsp;";
}

//calculate number of pages needing links
$pages = intval($numrows/$limit);

//$pages now contains int of pages needed unless there is a remainder from diviison

if($numrows%$limit){
//has remainder so add one page
$pages++;
}

//check to see if last page
if (!((($s+$limit)/$limit)==$pages) && $pages!=1){

//not last page so give NEXT link
$news = $s+$limit;

echo "&nbsp;<a href=\"$PHP_SELF?s=$news&q=$var\">Next 10 &gt;&gt;</a>";
}

$a = $s +($limit);
if($a > $numrows){$a = $numrows;}
$b = $s + 1;
echo "<p>Showing results $b to $a of $numrows</p>";

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:11:37.703

您的 where 子句很愚蠢...尝试将其更改为：

WHERE 艺术家名称，例如 '%$trimmed%'

只是把 trimmed 字面解释为字符串“trimmed”。但是，在双引号字符串中使用变量 $trimmed 将给出实际变量的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T19:36:19.237

```
$query = "select * from events where artist_name like '%$trimmed%' order by date"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T19:45:25.830

为了`$trimmed`在查询中使用变量，首先将其转义。否则，您的脚本将容易受到[SQL 注入](http://en.wikipedia.org/wiki/Sql_injection)攻击，并且攻击者将能够对您的数据库运行几乎任何查询。以 root 身份连接到 MySQL 的事实加剧了这个问题。永远不要在生产环境中这样做。

此外，要扩展字符串中的变量，您应该在变量名之前包含 $ 字符。

```
$trimmed = trim($var);
$escaped = mysql_real_escape_string($trimmed);
$query = "select * from events where artist_name like \"%$escaped%\" order by date"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T13:17:17.650

您的代码仍然到处都是。我认为它不起作用的主要原因是“和”的混合。在队列中使用变量之前，您需要转义变量[。mysql_real_escape_string](http://au1.php.net/manual/en/function.mysql-real-escape-string.php)是您应该使用的最低转义形式。我建议您使用看看[PDO](http://php.net/manual/en/book.pdo.php)。

```
<?php

//Get the search variable from URL

$var = $_GET['q'];
$trimmed = mysql_real_escape_string(trim($var)); //trim whitespace and escape the stored variable

//rows to return
$limit = 10;

//check for an empty string and display a message.
if($trimmed == "") {
    echo"<p>Please enter a name.</p>";
    exit;
}

//check for a search parameter
if(!isset($var)){
    echo"<p>We don't seem to have a search parameter!</p>";
    exit;
}

//connect to database
mysql_connect("localhost","root","password");

//specify database
mysql_select_db("itour") or die("Unable to select database");

//Build SQL Query
$query = "SELECT * FROM events WHERE artist_name LIKE %$trimmed% ORDER BY DATE";

$numresults = mysql_query($query);
$numrows = mysql_num_rows(numresults);

//If no results, offer a google search as an alternative

if ($numrows==0){
    echo"<h3>Results</h3>";
    echo"<p>Sorry, your search: &quot;" .$trimmed . "&quot; returned zero results</p>";

    //google
    echo"<p><a href=\"http://www.google.com/search?q=".$trimmed . "\" target=\"_blank"\ title=\"Look up ".$trimmed ." on Google\">
    Click here</a> to try the search on google</p>";
 }

//next determine if s has been passed to script, if not use 0
if(empty($s)) {
    $s=0;
}

//get results
$query .=" limit $s,$limit";
$result = mysql_query($query) or die("Couldn't execute query");

//display what was searched for
echo"<p>You searched for: &quot;" .$var . "&quot;</p>";

//begin to show results set
echo "Results";
$count = 1 + $s;

//able to display the results returned
while ($row = mysql_fetch_array($result)) {
    $title = $row['artist_name'];

    echo $count.'&nbsp;'.$title;
    $count++;
}

$currPage = (($s/$limit) + 1;

echo "<br>";

//links to other results
if ($s>=1){
    //bypass PREV link if s is 0
    $prevs=($s-$limit);
    echo '&nbsp;<a href="'.$PHP_SELF.'?s='.$prevs.'&q='.$var.'">&lt;&lt';
    echo 'Prev 10</a>&nbsp;&nbsp;';
}

//calculate number of pages needing links
$pages = intval($numrows/$limit);

//$pages now contains int of pages needed unless there is a remainder from diviison

if($numrows%$limit){
    //has remainder so add one page
    $pages++;
}

//check to see if last page
if (!((($s+$limit)/$limit)==$pages) && $pages!=1){

//not last page so give NEXT link
$news=$s+$limit;

echo '&nbsp;<a href="'.$PHP_SELF.'?s='.$news.'&q='.$var.'">Next 10 &gt;&gt;</a>';
}

$a = $s +($limit);
if($a > $numrows){$a = $numrows;}
$b = $s + 1;
echo '<p>Showing results '.$b.' to '.$a.' of '.$numrows.'</p>';

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T19:41:02.830

同样正如乍得提到的，sql 注入会很简单，因为您在使用它执行数据库操作之前没有清理输入。

尝试添加

```
 foreach($_REQUEST as $param => $value)
{
   $_REQUEST[$param]=mysql_real_escape_string($value);
} 
```

这样你就可以转义所有用户输入，这样用户就不能篡改数据库。在此处的文档中阅读有关此方法和 sql 注入的更多信息：http: [//us2.php.net/mysql_real_escape_string](http://us2.php.net/mysql_real_escape_string)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T23:11:45.647

您缺少一个 $ 符号。我认为

```
$var=@&_GET['q']; 
```

应该是

```
$var=@$_GET['q']; 
```

除非你真的想要一个引用，在这种情况下它应该是这样的：（如果你想要一个引用，此时不需要错误抑制，但你应该在尝试访问它之前检查 $var 是否设置）

```
$var=& $_GET['q']; 
```

我很想把它写得更像这样。

```
if (!isset($_GET['q'])) {
    echo"<p>We don't seem to have a search parameter!</p>";
    exit;
}

$trimmed = trim($_GET['q']);

if($trimmed=="") {
    echo"<p>Please enter a name.</p>";
    exit;
} 
```

# asp.net - ASP.NET 中的可折叠面板

> ID：826441
> 
> 赞同：0
> 
> 时间：2009-05-05T19:05:52.913
> 
> 标签：asp.net, ajax, ajaxcontroltoolkit, collapsiblepanelextender

我正在使用 ASP.NET AJAX 控制工具包，但在我的代码中使用可折叠面板时遇到问题。我有以下代码：

```
<table><tr>
<td class="bg">
    <a class="bg" href="javascript:void(0);">
    <asp:CheckBox runat="server" ID="chkSMSGrossRevenue" Text="Gross Revenue (Daily, Monthly, Yearly)" /></a>
    <asp:Panel runat="server" ID="pnlSMSGrossRevenue" Height="0">
        testing
    </asp:Panel>
</td></tr></table>
<cc1:CollapsiblePanelExtender runat="server" ID="cpeSMSGrossRevenue" TargetControlID="pnlSMSGrossRevenue"
    ExpandControlID="chkSMSGrossRevenue" CollapseControlID="chkSMSGrossRevenue">
</cc1:CollapsiblePanelExtender> 
```

我要做的是在我的复选框中有复选标记时展开我的面板，并在没有复选标记时折叠它。问题是，我总是看到工作“测试”，它在我的面板中......所以我假设它永远不会崩溃。当我单击复选框时，它会折叠，但随后会立即重新展开。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T19:17:32.683

由于您在未选中该框的情况下打开页面，请将可折叠面板扩展器的属性设置为开始折叠

```
Collapsed="true" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:19:28.250

我弄清楚了这个问题。它与我页面顶部的标签有关

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-22T18:22:10.537

设置`CollapsedSize="1"`解决了错误

# java - 在 Spring 类中获取 Hibernate 事务

> ID：826442
> 
> 赞同：3
> 
> 时间：2009-05-05T19:06:21.150
> 
> 标签：java, database, hibernate, spring

我正在开发一个使用 Spring 并使用 TransactionInterceptor 透明地获取 Hibernate 事务的程序。这使得说“当从其他类调用此方法时，如果它不在一个事务中，则将其包装在事务中”非常方便。

但是，我有一个类需要尝试写入，并且必须立即找出它是否成功。虽然我无论如何都想要两种方法，但我希望有一种方法可以将它们保持在同一个类中，而无需在程序上显式创建事务。实际上，我想要这样的东西：

```
public void methodOne() {
    //..do some stuff
    try  {
       transactionalMethod();//won't do what I want
    } catch(OptimisticLockingFailure e) {
      //..recover
    }
}

@Transactional
public void transactionalMethod() {
    //...do some stuff to database
} 
```

不幸的是，据我了解，这行不通，因为我只是直接调用 transactionalMethod。有没有办法让 Spring 为我调用本地方法并在需要时将其包装在事务中，或者它是否必须在我连接到这个的另一个类中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T19:16:12.360

定义该类实现的接口`transactionalMethod()`；使用依赖注入将类的值设置为它自己的实现；在您的 bean 工厂中，允许 Spring 在该接口实现周围插入一个 Around 方面。这应该可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T22:10:02.363

如果您希望`transactionalMethod`成为它自己的事务的一部分，而不是简单地加入已经处于活动状态的事务，则必须将传播设置为 REQUIRES_NEW。像这样

```
@Transactional(propagation = Propagation.REQUIRES_NEW)
public void transactionalMethod() {
    //...do some stuff to database
} 
```

您还应该检查您的事务管理器是否支持这种传播。这意味着 transactionalMethos 与调用它的其他事务完全分开，它也将完全分开提交/回滚。

# content-type - Web 交付的 Excel 2003 SpreadsheetML 文件的最佳内容类型和扩展名

> ID：826443
> 
> 赞同：3
> 
> 时间：2009-05-05T19:06:21.447
> 
> 标签：content-type, excel-2003

我正在使用具有报告 URL 调用的 API。该报告有一个“Excel 2003 XML”格式选项。选择后，他们将其交付为：

```
Content-Type: application/vnd.ms-excel
content-disposition: inline; filename="report-name.xls" 
```

最高 3.0 的 OpenOffice.org 尝试将此作为文本导入引入，我担心 Office 2007 可能会给用户扩展不匹配警告。这不应该是我们的问题，但人们喜欢射击信使，所以我正在研究并寻找建议，以向 API 开发人员提供有关文件扩展名的建议。

我可以将文件重命名为 .xlsx 或 .xml 并且 OOo 很乐意将文件打开到 Calc 中，但该文件并不是真正的 .xlsx 文件，.xml 非常通用，我不知道 Office 2007 会怎么想这些选项。

Web 交付的 Excel 2003 (11) SpreadsheetML 文件的最佳内容类型和扩展名是什么，可以避免这些问题和其他问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-30T11:59:38.187

application/vnd.ms-excel 工作正常，只需将文件名参数中的文件扩展名更改为标准 Excel 扩展名 (xls)

# c# - 服务参考和列表/数组类型

> ID：826448
> 
> 赞同：0
> 
> 时间：2009-05-05T19:07:12.037
> 
> 标签：c#, .net, asp.net

我有一个真正需要以任何方式解决的问题（可以选择更改数据类型）

假设：

1.  程序和服务都在 VS2008 中完成
2.  我可以完全控制程序和服务
3.  我有一个程序将信息“列表”传递给服务参考

例子：

程序片段：

```
IList<string> XMLList = null;
XMLList = new List<string>();

// fill my list up here...  mostly just an "array" of xml-based strings

string[] arrayToSend = new string[XMLList.Count];
arrayToSend = XMLList.ToArray<string>();

string results = DataFeedService.ProcessXMLBatch(arrayToSend); 
```

服务片段：

```
[WebMethod]
public string ProcessXMLBatch(string[] XMLBatch)
{
       // process the xml here...
       return "done";
} 
```

问题：它不认为我在服务中创建的 string[] 是同一种字符串数组。它将其转换为 #namespace.#servicename.ArrayOfString 类型

此代码当前无法编译。我一直在寻找其他方法来传递列表或泛型，但我一直遇到障碍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T19:16:01.190

考虑将您的代码更改为使用 a`List<string>`而不是 an `IList<string>`（我知道这是您实际使用的，但请声明您的变量）。该类`List<T>`提供了一个显式函数，它比您在代码中使用`ToArray()`的扩展方法更快。`Enumerable.ToArray<T>`这**也可以**解决您的问题，但我不确定。

此外，您不需要

```
string[] arrayToSend = new string[XMLList.Count]; 
```

只需将其声明为

```
string[] arrayToSend; 
```

您已经在`ToArray()`通话中分配了它；无需事先创建另一个。

**编辑**为什么不实例化和填充`ArrayOfString`在您的服务引用命名空间中创建的类？它会像 a 一样工作`List<string>`（事实上，我相信它继承自它）。使用 this 作为你的类型`XMLList`，然后`XMLList`直接将变量发送给函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:20:48.697

如果您将您的更改`WebMethod`为接受 a`List<string>`而不是`string[]`并传递适当的类型，它应该可以工作。根据我的经验，ASP.NET 服务似乎更喜欢这种方式。

此外，不要忘记确保您的服务引用是最新的，以便正确创建服务包装器类型以供您的代码交互。

### 更新

您是否尝试过实际创建`ArrayOfString`类型并填充它，而不是`string[]`在调用 WebMethod 时使用？

# jquery - 如何使用 jQuery 刷新 ASP.NET MVC UserControl？

> ID：826450
> 
> 赞同：4
> 
> 时间：2009-05-05T19:07:58.930
> 
> 标签：jquery, asp.net-mvc, user-controls

我有一个直接绑定到数据库的 UserControl，也就是说，它不是由任何 Action 呈现的。它独立工作。

但是，有时我必须刷新它以从数据库中获取新信息。我已经在 jQuery 中通过 Ajax 刷新 UserControls，但在所有这些情况下，我都有一个 Action 来提供服务。

但是，这次我没有 Action，因为这个 UC 直接获取它的信息。

有谁知道如何做到这一点？

非常感谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T19:37:58.173

**更新：**

您需要调用返回控件视图的操作。例子：

```
public ActionResult GetFooControl()
{
   return View("~/Views/Shared/Foo.ascx");
} 
```

然后使用 jQuery 的 load 函数刷新控件容器的内部 HTML。

```
$('#mycontrolContainer').load('../MyController/GetFooControl'); 
```

# caching - memcached 中的数据应该有多细？

> ID：826453
> 
> 赞同：2
> 
> 时间：2009-05-05T19:09:03.593
> 
> 标签：caching, performance, memcached

我很好奇.. 什么是“最有效”的缓存生成，比如说，一个 RSS 提要？或 API 响应（如对 的响应`/api/films/info/a12345`）。

例如，我是否应该缓存整个提要，并尝试将其作为伪代码返回：

```
id = GET_PARAMS['id']
cached = memcache.get("feed_%s" % id)
if cached is not None:
    return cached
else:
    feed = generate_feed(id)
    memcache.put("feed_%s" % id, feed)
    return feed 
```

还是缓存查询结果，每次都生成文档？

```
id = sanitise(GET_PARMS['id'])
query = query("SELECT title, body FROM posts WHERE id=%%", id)

cached_query_result = memcache.get(query.hash())
if cached_query_result:
    feed = generate_feed(cached_query_result)
    return feed
else:
    query_result = query.execute()
    memcache.put("feed_%s" % id, query_result)
    feed = generate_feed(query_result) 
```

（或者，我错过了其他方式？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:37:18.393

至于我的经验，您应该使用多级缓存。实现您的*两个*解决方案（前提是它不是唯一使用的代码`"SELECT title, body FROM posts WHERE id=%%"`。如果它只使用第一个）。

在代码的第二个版本中， You `memcache.get(query.hash())`，但是`memcache.put("feed_%s" % id, query_result)`. 这可能无法如您所愿（除非您有一个不寻常的 hash() 版本；)）。

我会避免`query.hash()`。最好使用类似posts-title-body-%id 的东西。当视频以`query.hash()`. 它可以作为僵尸视频挂在那里几个月。

顺便一提：

```
id = GET_PARMS['id']
query = query("SELECT title, body FROM posts WHERE id=%%", id) 
```

您从 GET 中获取一些内容并将其直接放入 sql 查询中？这很糟糕（将导致 SQL 注入攻击）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T19:20:48.807

取决于使用模式，但所有事情都是平等的，我会投票支持第一种方式，因为您只会执行生成提要 1 次的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T19:20:59.010

这实际上取决于您的应用程序的功能......回答这个问题的唯一方法是从您现有的应用程序中获取一些性能数据。然后，您可以找到花费最多时间的代码并努力改进该代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T23:00:16.407

正如其他人在这里所建议的那样，我会分析您的代码并找出操作中最慢或最昂贵的部分。

# asp.net-mvc - 在 ASP MVC 中向 URL 添加参数

> ID：826465
> 
> 赞同：2
> 
> 时间：2009-05-05T19:12:03.040
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我需要在控制器和操作**之前**有一个参数作为我的 ASP MVC URL 的一部分：

[http://www.mydomain.com/](http://www.mydomain.com/) **company1** /首页

或者

[http://www.mydomain.com/](http://www.mydomain.com/) **company1** /Clients/Detail/1

（理想情况下，我希望将其作为这样的子域：http:// **company1** .mydomain.com/Clients/Detail/1 所以任何解决这个问题的答案也值得赞赏）

我将此参数称为帐户。我尝试在路由映射中添加类似这样的内容：“{account}/{controller}/{action}/{id}”，但在尝试类似[http://www.mydomain.com/company1时出现 404 错误/家](http://www.mydomain.com/company1/Home)

这是 Global.asax 中的 RegisterRoutes：

```
 public static void RegisterRoutes(RouteCollection routes)
        {
           routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapRoute("TestRoute", "{account}/{controller}/{action}/{id}");

            routes.MapRoute(
                "Default",                                              // Route name
                "{controller}/{action}/{id}",                           // URL with parameters
                new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
            );
} 
```

在组织我的 Views 文件夹或 Controller 操作时，我需要做些什么特别的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:22:11.207

您的错误听起来好像您没有在路由默认值中给出默认值。

# java - java中的打印方法

> ID：826467
> 
> 赞同：2
> 
> 时间：2009-05-05T19:12:11.900
> 
> 标签：java

我想问你关于打印向量数组的问题，如下：

```
Vector[] routingTable = new Vector[connectivity.length]; 
```

我试过这个方法，但它对我不起作用，`protocol.Route@c17164` 当我在主打印时它给了我，这是代码，所以你能告诉我为什么它不打印正确的值吗？

```
public String printRT(int hop)
{
   String s = "";
   for (int i = 0; i < conf.routingTable[hop].size(); i++) 
  {
     s= " ROUTING TABLE " + conf.routingTable[hop].get(i);
  }
  return s;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T19:20:48.197

看起来您需要`toString()`在`protocol.Route`.

```
class Route {
    public String toString() {
         return "some string that makes sense";
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-05T19:18:49.887

要么覆盖类[`toString()`](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#toString())上的方法`protocol.Route`，要么从对象中获取所需的属性`Route`并将它们附加到方法`String s`内部`printRT`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T19:31:47.127

许多有用的建议，但我认为每个人都忽略了一些非常简单的事情——在每次循环迭代中，您都在覆盖`s`. 我认为您的意思是说以下内容：

```
s += " ROUTING TABLE " + conf.routingTable[hop].get(i); 
```

注意“+=”而不是简单的赋值。或使用`StringBuilder`, 或其他。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T19:36:31.170

当您要求 java 打印一个未定义 toString 方法的对象时，它将回退到 Object 类中的默认 toString 实现。从javadocs：

> Object 类的 toString 方法返回一个字符串，该字符串由对象作为其实例的类的名称、at 符号字符“@”和对象哈希码的无符号十六进制表示形式组成。换句话说，此方法返回一个等于以下值的字符串：
> 
> ```
>  getClass().getName() + '@' + Integer.toHexString(hashCode()) 
> ```

在您的示例中，“protocol.Route”将是类名，“c17164”是 hashcode 方法作为 hexString 返回的任何内容，除非 hashCode 已被覆盖，否则它可能是对象的地址，尽管这取决于实现。

因此，有几种方法可以解决您的问题。

1.  为 Route 类编写你自己的 toString 方法实现，打印出你想要的数据。这可能是解决问题的最“正确”方法。它将事物很好地封装在类中，这意味着只有类中的 toString 方法需要知道要打印的确切成员变量。

2.  如果情况是您无法更改 Route 类，则可以将您自己的 Route 类版本子类化，您可以向其中添加 toString 方法。但是，根据类的设计，这可能很困难。

3.  让当前的 printRT 方法查看每个 Route 对象的内部，并获取要附加到当前字符串的特定信息。

另外，请注意，使用当前代码，您在内循环中编写了以下内容：

```
 s= " ROUTING TABLE " + conf.routingTable[hop].get(i); 
```

这意味着 printRT 只会为循环的最后一次迭代返回一个字符串。因此，for 循环中的大部分时间都花在创建字符串、将它们分配给变量，然后在下一次循环中覆盖它们。

如果您想为每次迭代返回一个字符串表示，您需要将上面的内容更改为如下所示：

```
 s += " ROUTING TABLE " + conf.routingTable[hop].get(i); 
```

现在，每次循环都将新信息附加到 s 中。但是，根据正在执行的字符串连接的数量，StringBuilder 类可能是更好的选择（请参阅[此处](http://java.sun.com/docs/books/tutorial/java/data/buffers.html)的简短摘要和教程）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T19:29:46.820

两种选择。

要么覆盖类`toString()`上的方法`protocol.Route`。

```
public String toString() {
    return someMethodorPropertyThatreturnsString;
} 
```

或从对象中获取所需的属性/方法`Route`并将它们附加到方法`s`内的字符串中`printRT`。

```
public String printRT(int hop)
{
  String s = "";
  for (int i = 0; i < conf.routingTable[hop].size(); i++) 
  {
     s= " ROUTING TABLE " +     conf.routingTable[hop].get(i).someMethodorPropertyThatreturnsString;
  }
  return s;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T19:40:47.370

这里有很多问题。

*   您应该`List`使用[Generics](http://java.sun.com/j2se/1.5.0/docs/guide/language/generics.html)指定要放入的类型。这样，您将让您自己和其他人更清楚您在`List`.

*   正如其他人所提到的， your`List`是一个`protocol.Route`对象列表，而不是`String`s。当您尝试将 a 添加`Route`到 s 时，Java 不知道如何将其转换为 a `String`，因此它使用默认的`Object#toString()`. 覆盖它`Route`来做你想做的事。

*   看起来你可能会在这里做很多附加。使用[`StringBuilder`](http://java.sun.com/javase/6/docs/api/java/lang/StringBuilder.html).

*   在我看来，它`printRT(int)`应该是一种方法`conf`。

*   您可能应该使用不同的实现[`List`](http://java.sun.com/javase/6/docs/api/java/util/List.html)；[`Vector`](http://java.sun.com/javase/6/docs/api/java/util/Vector.html)真的不建议再使用了，所以看看其他选项，比如[`ArrayList`](http://java.sun.com/javase/6/docs/api/java/util/ArrayList.html).

# struts2 - 当值是双倍时，struts 2 不做除法？

> ID：826480
> 
> 赞同：1
> 
> 时间：2009-05-05T19:16:43.263
> 
> 标签：struts2

我在struts2中有一个非常奇怪的场景。

当我执行以下操作时：

```
<s:property value="%{4/2}"/> 
```

我得到2。

但是当我执行以下操作时：

```
<s:property value="%{2/4}"/> 
```

我得到一个大胖子0。

即使评估值为双精度值，属性标记也始终输出整数。我怎样才能改变这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T19:22:28.320

您正在做整数运算，因为您的输入是整数，而不是双精度数：对于整数，二除以四**为零**。试试这个：

```
<s:property value="%{2.0/4.0}"/> 
```

反而。

# vb.net - 如何验证文本框输入？

> ID：826485
> 
> 赞同：1
> 
> 时间：2009-05-05T19:17:29.190
> 
> 标签：vb.net, validation

我正在创建一个程序，我需要验证我的文本框。对于程序，用户需要输入一个短语。但我不确定如何确保用户实际输入了一个短语，该短语不是（例如）skldkfdl，或者没有空格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T19:22:44.700

[Java中的字符串](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html)

您可以先执行 String.Trim() 来消除尾随空格...

然后执行 String.IndexOf(" ") 来检查空格。

如果函数返回 -1，则表示字符串中没有空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T20:36:42.180

假设您正在使用 VB.Net 运行 - 为要验证文本的事件添加事件处理程序，例如单击“提交”按钮时。您可能希望使用 CancelEventHandler，以便取消单击。在事件处理程序中，如果您只是在寻找简单的验证，您可以使用 if 语句来检查一些简单的条件，例如您是否只想检查“if input.equals(password)”。 [在此处查看使用 CancelEventHandler 的示例](http://msdn.microsoft.com/en-us/library/system.componentmodel.canceleventargs.aspx)
如果您正在寻找一些更复杂的验证，您将需要使用正则表达式。 [此页面可能会帮助您入门](http://www.regular-expressions.info/dotnet.html)
检查某些东西是否是“短语”，例如在正确的英语中，将非常困难。您需要确保所有单词都在字典中，然后您需要检查语法是否正确，鉴于英语语法规则，这非常复杂。根据您的问题，您可能希望简化您的方法。例如，也许只是检查没有使用奇怪的字符，有多个空格，并且每个单词都包含一个元音。

# algorithm - 将 n 个元素插入空哈希表的运行时间

> ID：826492
> 
> 赞同：4
> 
> 时间：2009-05-05T19:19:19.247
> 
> 标签：algorithm, hash, runtime, hashtable, hashmap

人们说它需要摊销 O(1) 才能放入哈希表。因此，放置 n 个元素必须是 O(n)。然而，对于大 n 而言，情况并非如此，因为正如一位回答者所说，“满足预期摊销 O(1) 所需的只是扩展表并在发生冲突时使用新的随机散列函数重新散列所有内容。”

那么：将 n 个元素插入哈希表的平均运行时间是多少？我意识到这可能取决于实现，所以请提及您正在谈论的实现类型。

例如，如果有 (log n) 个等距碰撞，并且每次碰撞都需要 O(k) 来解决，其中 k 是哈希表的当前大小，那么您将具有以下递归关系：

```
T(n) = T(n/2) + n/2 + n/2 
```

（也就是说，你花时间插入 n/2 个元素，然后你有一个冲突，需要 n/2 来解决，然后你在没有冲突的情况下进行剩余的 n/2 插入）。这仍然是 O(n)，所以是的。但这合理吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T19:24:52.290

这完全取决于您的重新散列效率有多低。具体来说，如果您可以正确估计第二次哈希表的预期大小，您的运行时间仍接近 O(n)。实际上，在确定预期顺序之前，您必须指定重新哈希大小计算的低效程度。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T21:16:44.253

> 人们说它需要摊销 O(1) 才能放入哈希表。

从理论的角度来看，*预计*摊销 O(1)。

哈希表本质上是一种随机数据结构，就像快速排序是一种随机算法一样。您需要生成具有一定随机性的散列函数，否则存在不是 O(1) 的病态输入。

[您可以使用动态完美散列](http://en.wikipedia.org/wiki/Dynamic_perfect_hashing)实现预期的摊销 O(1) ：

我最初发布的幼稚想法是在每次碰撞时使用新的随机散列函数重新散列。（另见[完美哈希函数](http://en.wikipedia.org/wiki/Perfect_hash_function)）问题在于，这需要 O(n^2) 空间，来自生日悖论。

解决方案是有*两个*哈希表，第二个表用于冲突；通过重建它来解决第二个表上的冲突。该表将有 O(\sqrt{n}) 个元素，因此会增长到 O(n) 个大小。

在实践中，您通常只使用固定的哈希函数，因为您可以假设（或不在乎）您的输入是病态的，就像您经常快速排序而不预先随机化输入一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T22:31:38.050

所有 O(1) 的意思是操作是在恒定时间内执行的，它**不**依赖于数据结构中的元素数量。

简而言之，这意味着无论您的数据结构有多大，您都必须支付相同的成本。

实际上，这意味着当您不必存储大量数据时，简单的数据结构（例如树）*通常更有效。*根据我的经验，我发现树的速度更快，最多可达 1k 个元素（32 位整数），然后哈希表接管。但像往常一样YMMW。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T19:25:36.627

为什么不在您的系统上运行一些测试？也许如果您发布源代码，我们可以返回并在我们的系统上对其进行测试，我们可以将其真正塑造成一个非常有用的讨论。

决定算法实际花费多少时间的不是实现，而是环境。但是，您可以查看是否有任何基准测试样本可用。我发布结果的问题将毫无用处，因为人们不知道我的系统上还运行着什么，现在有多少 RAM 可用等等。你只能有一个广泛的想法。这和大 O 给你的一样好。

# python - 混合文件和循环

> ID：826493
> 
> 赞同：27
> 
> 时间：2009-05-05T19:20:06.233
> 
> 标签：python, python-2.7, file, loops, while-loop

我正在编写一个脚本，该脚本记录来自另一个程序的错误，并在遇到错误时重新启动程序。无论出于何种原因，该程序的开发人员认为没有必要默认将此功能放入他们的程序中。

无论如何，程序获取一个输入文件，解析它，然后创建一个输出文件。输入文件采用特定格式：

```
UI - 26474845
TI - the title (can be any number of lines)
AB - the abstract (can also be any number of lines) 
```

当程序抛出错误时，它会为您提供跟踪错误所需的参考信息 - 即 UI、哪个部分（标题或摘要）以及相对于标题或摘要开头的行号。我想使用一个函数从输入文件中记录有问题的句子，该函数采用参考号和文件，找到句子并记录它。我能想到的最好方法是在文件中前进特定次数（即 n 次，其中 n 是相对于部分开头的行号）。这样做似乎有意义的方式是：

```
i = 1
while i <= lineNumber:
    print original.readline()
    i += 1 
```

我不明白这会如何让我丢失数据，但 Python 认为它会，并说`ValueError: Mixing iteration and read methods would lose data`. 有谁知道如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-05T19:47:25.577

您收到 ValueError 是因为您的代码可能`for line in original:`除了`original.readline()`. 一个简单的解决方案可以解决问题而不会使您的程序变慢或消耗更多内存正在改变

```
for line in original:
    ... 
```

到

```
while True:
    line = original.readline()
    if not line: break
    ... 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-05T19:23:58.580

使用`for`和[枚举](http://docs.python.org/library/functions.html#enumerate).

例子：

```
for line_num, line in enumerate(file):
    if line_num < cut_off:
        print line 
```

**注意**：这假设您已经在清理文件句柄等。

此外，如果您更喜欢功能性更强的风味，则[takewhile功能可能会很有用。](http://docs.python.org/library/itertools.html#itertools.takewhile)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T08:02:56.243

假设您只需要一条线，这可能会有所帮助

```
import itertools

def getline(fobj, line_no):
    "Return a (1-based) line from a file object"
    return itertools.islice(fobj, line_no-1, line_no).next() # 1-based!

>>> print getline(open("/etc/passwd", "r"), 4)
'adm:x:3:4:adm:/var/adm:/bin/false\n' 
```

您可能想要捕获 StopIteration 错误（如果文件的行数较少）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-02-02T08:39:36.427

这是一个没有丑陋`while True`模式且没有其他模块的版本：

```
for line in iter(original.readline, ''):
    if …:   # to the beginning of the title or abstract
        for i in range(lineNumber):
            print original.readline(),
        break 
```

# python - 从 Python 通过 COM 控制 VirtualBox？

> ID：826494
> 
> 赞同：0
> 
> 时间：2009-05-05T19:20:07.077
> 
> 标签：python, com, virtualbox

我正在尝试通过 Python 的 COM 接口控制最新的 Sun VirtualBox。但是，不幸的是，以下代码不起作用：

```
import win32com.client
VBOX_GUID = "{B1A7A4F2-47B9-4A1E-82B2-07CCD5323C3F}"
try :
  oVbox = win32com.client.Dispatch( VBOX_GUID )
  oVbox.FindMachine( "kubuntu" )
except Exception as oEx:
  print str( oEx ) 
```

错误是一般的“（-2147467262，'不支持此类接口'，无，无）”似乎错误的部分是我通过Python处理的COM。任何人都可以看看并提出一些明显的我做错的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T13:15:24.060

问题是返回的对象`FindMachine("kubuntu")`不支持`IDispatch interface`，win32com不支持。

您可以为此使用我的`comtypes`包[http://starship.python.net/crew/theller/comtypes/](http://starship.python.net/crew/theller/comtypes/)，但您需要修补存储库中的版本以使其与 VirtualBox 类型库一起使用。

这是一个演示会话：

```
Python 2.5.4 (r254:67916, Dec 23 2008, 15:10:54) [MSC v.1310 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> from comtypes.client import CreateObject
>>> box = CreateObject("VirtualBox.VirtualBox")
>>> m = box.FindMachine("Fedora")
>>> print m.State
4
>>> print m.CpuCount
1
>>> print m.Name
Fedora
>>> 
```

这是您需要的补丁：

```
Index: automation.py
===================================================================
--- automation.py   (revision 507)
+++ automation.py   (working copy)
@@ -753,6 +753,8 @@
     c_float: VT_R4,
     c_double: VT_R8,

+    c_ulonglong: VT_I8,
+
     VARIANT_BOOL: VT_BOOL,

     BSTR: VT_BSTR, 
```

# reporting-services - SQL Server Reporting Services 数据源不断丢失数据库登录凭据

> ID：826504
> 
> 赞同：8
> 
> 时间：2009-05-05T19:21:15.607
> 
> 标签：reporting-services, datasource, reportingservices-2005

在我的开发环境中，每次我重新启动窗口（我必须至少每天都这样做）时，我所有的共享 SSRS 数据源都会丢失它们的凭据。

目前，我已将它们设置为使用固定凭据登录数据库，但在重新启动时，所有数据源都会弹出以不使用凭据。当然，它只在开发环境中，我可以签出/更新数据源/重新签入，它会正常工作......直到我再次重新启动。

仅供参考，我已经使用这些共享数据源至少 2 年了，没有任何问题，但在过去一个月左右，这是一个反复出现的日常问题。

帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T18:09:58.083

我假设您正在讨论 Visual Studio 中报表服务器项目中的共享数据源，而不是直接在 Reporting Services 上创建的数据源。后者，数据全部存储在设置 SSRS 时指定的 ReportServer 数据库中。

现在，对于 Visual Studio 中使用的 .rds 文件，如果您在文本编辑器中打开该文件，请注意用户名和密码并未存储在该文件中。它实际上存储在 .rptproj.user 文件中。因此，请检查是否有人没有从源代码管理中删除 .user 文件（.user 文件*不*应该在源代码管理中，但在您的情况下......）。

可以通过输入您的凭据、保存所有文件并退出 Visual Studio 来测试此方案。找到并删除 .rptproj.user 文件，然后再次打开您的 Report Server 项目，然后看到凭据消失了！

解决方法是添加“用户 ID=用户；密码=密码”作为连接字符串的一部分。打开 .rds 时，连接字符串不会显示此部分，但凭据选项卡应具有正确的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T21:14:28.247

这可能与您机器上服务的启动顺序有关吗？

只是一个猜测：也许 SP3 中有一个新功能可以检查连接凭据是否有效。如果它们无效，它们将被清除。

如果在 SQL Server 有时间启动之前完成此检查，则会出现问题。这可以解释为什么它们在机器重新启动时被清除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-17T15:07:11.297

我知道您可能已经阅读过这篇文章，但这里有什么可以帮助的吗？ [http://msdn.microsoft.com/en-us/library/ms159846.aspx](http://msdn.microsoft.com/en-us/library/ms159846.aspx)

我会注意 SSRS 的安装方式以及服务运行的帐户以及域登录策略。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-06T12:50:56.533

我最近遇到了同样的问题，但我无法将其连接到重新启动。当我从源代码管理中检查解决方案时似乎发生了这种情况 - 我们使用 Team Foundation Server。在禁用服务帐户无数次后，它以某种方式自我修复并开始表现。我找到了这篇文章，并检查了我的项目文件夹中的 benson 提到的 rptproj.user 文件，它有一个我遇到问题的修改日期，但创建日期接近我记得创建项目的日期，所以今后我会注意这一点。

有没有人在这个问题上提出任何新的想法？

# visual-studio-2008 - Visual Studio 2008 中的“查找和替换”速度很慢

> ID：826506
> 
> 赞同：3
> 
> 时间：2009-05-05T19:22:15.870
> 
> 标签：visual-studio-2008

我有一个只有 1 个项目的解决方案，大约有 30 个类文件。如果我使用“查找和替换”来搜索当前打开的文档，速度很快，但如果我尝试搜索整个解决方案，每个结果之间似乎需要 3-4 秒。即使我可以看到相邻的比赛，仍然有 3-4 秒的延迟。硬盘驱动器不执行任何操作，CPU 处于空闲状态 - 什么可能导致此停顿？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T19:58:28.653

使用“在文件中查找”，因为它明显更快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-13T21:19:41.570

我通过使用[Microsoft Sysinternals 工具 ProcMon.exe](http://technet.microsoft.com/en-us/sysinternals/default.aspx)找到了答案。在 VS 2008 中使用 Ctrl-Shift-H 搜索非常慢；这是在所有文件中查找，包括整个解决方案，查找选项字段“查看这些文件类型”文本框为空。

我通过 ProcMon.exe 发现它为 DevEnv.exe 进程显示它正在搜索资源文件（包含的 DLL、JPG、GIF 等）。=（哎呀。我决定将“查看这些文件类型”更改为仅针对长文本过滤器“ *.vb;* .resx;*.xsd”等进行处理，瞧，它很快。嗯，这似乎有点奇怪的是它会搜索不可搜索的文件（实际上）。=（

设置这些过滤的文件类型后，“devenv.exe”的结果明显更少，速度更快。

以下是重现的全部步骤，因此如果您有其他需要使用此过程的情况，请随时跟进。

1.  下载并运行 ProcMon.exe，暂时禁用捕获（Ctrl-E）
2.  在 ProcMone.exe 中，添加一个新的 Include 过滤器，其中“ProcessName 是 devenv.exe”，这有助于清除机器中的任何无关活动，并隔离 VS 环境。将所有其他排除项留在那里。
3.  准备一个完整的整个解决方案搜索并替换项目中的大量文件和 dll（BIN 中的 DLLs 当然应该从项目中排除）
4.  在 ProcMan.exe 中，启动 Capture (Ctrl-E)。什么都不会显示，因为过滤器已缩小到 VS 活动。
5.  在 VS 中，查找下一个，和/或进行替换
6.  搜索完成后，停止 ProcMone.exe 中的过滤器 (Ctrl-E)
7.  检查结果并查看正在打开和查询的文件类型。

最后，确保“查看这些文件类型”与您要搜索的确切项目匹配。有人对排除 GIF、PNG、JPG 等不需要搜索的文件有任何想法吗？可能是正则表达式！？有人想提供一些反馈，以便我们都能从更好的搜索和替换体验中受益吗？

啊，那好多了，我不必等待5-8秒才能找到下一个命中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T19:28:06.340

检查 VS 搜索的路径。这可能是导致大量时间的顶级目录。如果是这样 - 缩小要搜索的目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T19:29:34.370

来自 MS 的糟糕的程序设计和代码。如果您使用 Resharper 或类似工具，您会发现这可以更快地完成。并不是说我得到了任何推荐，但如果你学会使用 Resharper（一个商业插件），你可以节省很多时间，不仅仅是搜索和替换，还有无数其他艰巨的日常编程任务。

# asp.net - 锚在asp.net中不起作用

> ID：826522
> 
> 赞同：1
> 
> 时间：2009-05-05T19:24:48.093
> 
> 标签：asp.net, anchor

正如标题所示，我遇到了锚点 ASP.NET 的问题。

我设置它们的方式与您在标准 html 中的设置方式相同

前任：

```
<a href="#Intro">Introduction</a>
and then further down the page, 
<a name="Intro" ... 
```

出于某种原因，当我单击链接时，#Intro 没有附加到 url，并且我没有进入锚点。

但是，如果我手动将#Intro 添加到它的 url 中。

此外，如果我将#Intro 更改为没有具有给定名称属性的相应锚点的名称，它会附加到查询中

这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:44:17.190

这似乎更像是浏览器问题，否则您没有包含足够的代码。

您向我们展示的代码看起来不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:42:38.240

你把它弄错了。它应该是 NAME="INTRO" 你想要介绍的地方和 HREF="#INTRO" 当你想回到介绍的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-25T18:48:47.537

请注意，不应有任何回发到服务器。这一切都在客户端完成，由浏览器实现。尝试在另一个浏览器中重新创建它，以取消其某些疯狂浏览器问题的可能性。扫描页面的源代码（在浏览器中，查看源代码）以了解当用户单击介绍链接时是否发生任何事情（当然假设您在链接上没有事件——在这种情况下，请在那里查找问题）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-25T18:22:08.453

`#INTRO`不是`#Intro`.. 有效。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-05T19:40:00.367

尝试在名称标签中删除引号和/或将页面名称添加到锚链接。

# c# - 在 C# 中编辑具有绑定和更新列的 DataGridView

> ID：826529
> 
> 赞同：0
> 
> 时间：2009-05-05T19:26:31.053
> 
> 标签：c#, windows, winforms, data-binding

我有一个 DataGridView，其中 DataSource 是一个 BindingList。大多数列都更新了——通过各种计时器，这些计时器为绑定的列调用 PropertyChanged("...")。一列 - 有问题的一列 - 是 DataGridViewComboBoxColumn - 用户从项目列表中选择一个项目。

问题是 DataGridViewComboBoxColumn 不可用。它一直在闪烁——显然是在发生 PropertyChanged 事件时——无论我尝试选择什么项目，它都保持不变。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T20:15:27.160

首先，添加代码示例，以便我们更好地理解您的意思。

其次，你做的事情听起来很奇怪。为什么要在计时器上手动调用 PropertyChanged()？为什么不在课堂上实现 INotifyPropertyChanged？

或者您可以使用包装器，为您的项目实现 ICustomTypeDescriptor 和 INotifyPropertyChanged。在这种情况下，包装器会自动为您的类添加 INotifyPropertyChanged 实现。在 Internet 上搜索有关您为什么需要 ICustomTypeDescriptor 以及它如何提供帮助的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T17:10:31.390

您可能遇到的一个问题是 DataGridViewComboBox 控件不会提交其值更改，直到用户移动到另一个单元格来验证该单元格。您可以使用 CurrentCellDirtyStateChanged 事件强制在值更改时发生此行为。

# php - 如何在 PHP 中将文本变量更改为 int？

> ID：826531
> 
> 赞同：2
> 
> 时间：2009-05-05T19:27:21.257
> 
> 标签：php, forms

我有一个变量，它是由从表单输入到文本字段的 POST 调用定义的。有没有办法将此变量转换为整数？

从表格：

```
Lenght: <input name="length" value="10" type="text" id="lenght" size="2" /> 
```

从php代码：

```
$length = $_POST['lenght'];
$url = substr($url, 0, $length); 
```

这似乎不起作用，我认为它不起作用的唯一原因是因为 $lenght 被定义为文本而不是整数。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-05T19:30:06.117

两件事情：

1.  它不起作用，因为您拼错了长度 <-> 长度

2.  将字符串转换为整数的正确方法是使用函数 intval。

* * *

```
$length = intval($_POST['length']);
$url = substr($url, 0, $length); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-05T19:29:31.577

它可能不起作用，因为您拼错了两次长度，而不是零次或三次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T19:29:18.397

似乎是您的代码中的拼写错误：长度与长度 - 这可能是您的问题。

要进行显式转换，请使用 intval() 函数

```
$length = intval($_POST['length']); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T21:20:11.017

忽略上面“长度”的拼写错误，有几种方法可以在 PHP 中将字符串显式转换为整数。通常这种转换会自动发生。采取以下代码：

```
$numeric_string = '42';
echo ($numeric_string * 2); 
```

正如预期的那样，这将打印出“84”。请参阅关于[Type-Juggling](http://www.php.net/manual/en/language.types.type-juggling.php)的参考资料。

如果您知道您拥有的字符串是一个数字（也许通过检查[is_numeric()](http://www.php.net/manual/en/function.is-numeric.php)），那么您可以[将变量转换为 Integer](http://www.php.net/manual/en/language.types.integer.php#language.types.integer.casting)

```
$numeric_string = '42';
$converted_integer = (int) $numeric_string;
// or
$converted_integer = (integer) $numeric_string; 
```

或使用[intval()](http://www.php.net/intval)

```
$numeric_string = '42';
$converted_integer = intval($numeric_string); 
```

关于 intval() 需要记住的重要一点是，如果它无法将字符串解析为整数，它将返回 0。这可能（可能）为您提供第二种检查错误的方法（在[is_numeric()](http://www.php.net/manual/en/function.is-numeric.php)之后），或者如果您没有正确确保变量以数字开头，它可能会导致意外结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T20:24:46.827

如果您确定您正在查看的值对于要转换为的类型具有正确的表示，您还可以使用 vanilla 类型转换操作：

```
$int = (int) "1"; // var_dump($int) => int(1)
$float = (float) "1.2345"; // var_dump($float) => float(1.2345) 
```

但请注意您正在转换的变量的不正确表示，即将“随机字符串”转换为数字可能不会产生您期望的结果。如果您正在处理用户输入，则最好将上述建议的解决方案与函数调用一起使用，例如*intval*和*floatval*

# .net-3.5 - 如何使用 LINQ to Entities 更新对象的外键值？

> ID：826537
> 
> 赞同：1
> 
> 时间：2009-05-05T19:28:38.570
> 
> 标签：.net-3.5, linq-to-entities, foreign-keys, crud

假设我有这些表：

```
Fruits
 - FruitID       INT PK
 - FruitName     NVARCHAR(30)
 - FruitStatusID INT FK: Statuses

Statuses
 - StatusID      INT PK
 - StatusName    NVARCHAR(30) 
```

在这些情况下，如何更新水果的名称及其在数据库中的状态？：

1.  更新来自先前 L2E 调用的一块水果
2.  给定一个对应于 FruitID 的整数（也就是说，我手头没有完整的 Fruit 对象开始）

VB或C#都可以，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:54:36.447

[这有效](http://naspinski.net/post/Populating-Entities-Foreign-Key-Relationships-with-EntityKey-(and-no-extra-trip-to-the-db).aspx)，但不是我所希望的：

```
int StatusID = 4; // Some ID
Fruit.FruidIDReference.EntityKey = 
    New EntityKey("MyEntities.Statuses", "StatusID", StatusID) 
```

当然，有一种更简洁的方法可以做到这一点，它不需要硬编码字符串（如果我打错了会引入运行时异常）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:55:30.767

如果将 Fruit 对象传递给另一个方法，您可以：

1.  将对上下文对象的引用与 Fruit 一起传递并调用 SaveChanges()

2.  在下级方法中对 Fruit 对象进行编辑，并在调用方法中调用 SaveChanges()（如果要避免不必要的 DB 调用，可以检查它是否已被修改。）

代码：

```
//Change the name
FruitEntities fe = new FruitEntities();
Fruit f = fe.Friuts.First();
f.FruitName = "NewName";
fe.SaveChanges();

//Get a fruit by ID and change the status
//Statuses will need to be included as an Entity in your model with an association to Fruits
int Id = 2;
int newStatusID = 0;
FruitEntities fe = new FruitEntities();
Fruit f = (from x in fe.Fruits
           where x.FruitID == Id
           select x).First();
Status s = (from y in fe.Statuses
            where y.StatusID = newStatusID
            select y).First();
f.Status = s;
fe.SaveChanges(); 
```

# sql - SQL 是否有标准的 XML 查询编码？

> ID：826543
> 
> 赞同：2
> 
> 时间：2009-05-05T19:29:31.890
> 
> 标签：sql, xml, standards

是否有将 SQL 查询编码为 XML 的标准方法？我的意思是

```
select name from users where name like 'P%' group by name order by name desc 
```

可能编码为（我的 5 分钟模型，可能是线轴）...

```
<?xml version="1.0" encoding="UTF-8"?>
<query>
    <select>
        <table name="users">
            <column name="name"/>
        </table>
    </select>
    <from>
        <table name="users"/>
    </from>
    <where>
        <operator name="like">
            <column name="name"/>
            <value>P%</value>
        </operator>
    </where>
    <aggregation>
        <groupby>
            <column name="name"/>
        </groupby>
    </aggregation>
    <order>
        <order-by>
            <column name="name" order="desc"/>
        </order-by>
    </order>
</query> 
```

...这将使构建、存储、验证结构和内容变得容易（通过生成基于数据库模式的模式）等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T19:36:15.320

我不知道有任何这样的标准。到目前为止，您所拥有的看起来很可行。不过，我质疑你为什么要这样做。我认为这是一个内部平台（一种反模式）。此外，它专门重新发明了 SQL，这是该反模式的一个众所周知的实例。最重要的是，它是用 XML 编程，这被广泛认为是一个坏主意。

SQL 语法非常简单，您可以使用普通的解析器生成器工具在短时间内为其构建解析器（Web 上可能已经存在一些开源工具）。这将是一种更简洁的方式来验证您的 SQL 语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T02:29:33.457

我一直在尝试做同样的事情。

回答评论中关于我为什么要这样做的问题。好吧，我想用一组可用的列和过滤条件定义一个基本查询，我想允许用户选择他们想要显示的列，并在 where 子句中启用和禁用某些表达式。

我尝试了一些 XML 模式的变体，并得到了一些不错的结果。我什至能够应用 XSLT 来根据用户的偏好提取 SQL 文本。

我也去寻找 SQL 解析器。 [http://www.sqlparser.com](http://www.sqlparser.com)有一个，但它的商业和 API 是严重的 Delphi 风格，在我看来不是很容易访问。

正如其他人所说，使用 ANTLR 之类的东西来生成将解析 SQL 的 C# 代码是可行的。[您可以在此处](http://www.antlr.org/grammar/list)找到一些 SQL 语法。那里列出的最新 MS SQL 语法是 MS SQL 2000。我没有时间玩这些东西。

我希望 Oslo SDK 中有一个像样的 M Grammer 能够解析查询，但我还没有找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T19:58:00.387

没有确切的标准。可能你不应该做你打算做的事。但是，如果我打算这样做，我会看以下之一： (1) 将 xml 查询计划中的一些构造混为一谈。默认 sql 2005 安装上的 XSD 位于 C:\Program Files\Microsoft SQL Server\90\Tools\Binn\schemas\sqlserver\2004\07\showplan\showplanxml.xsd

(2)Sql 2008 在 IDE 中带有智能感知，它似乎是在这个 .net 程序集的帮助下实现的 - C:\Program Files\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\Microsoft .SqlServer.SqlParser.dll 如果您添加对此程序集的引用，您可以解析源脚本并提取解析器程序集提供的 xml 定义。例如

```
SqlScript script = Parser.Parse(strSqlScript);
foreach (SqlBatch batch in script.Batches)
{
  foreach (SqlStatement s in batch.Statements)
  {
    Console.Write(s.Xml);
  }
} 
```

您可能会发现它提供的 xml 定义可以根据您的需要重复使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T02:52:39.330

[XQuery](http://www.w3.org/TR/xquery/)是一种 XML 查询语言，它支持一些与 SQL 相同的思想。这些不是相互理解的语言，但是如果您熟悉 SQL，那么您也不应该在使用 XQuery 时遇到太多麻烦。

据我所知，XQuery 只有一种现实的实现，[存在](http://exist.sourceforge.net/)。

我没有使用这两种技术，只是出于一般的探索性兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-26T02:47:06.323

好吧，我自己只是在思考这个问题，试图记住它是如何为 CRM 完成的，它在定义实体时动态构建表。

然后我终于在几分钟前偶然发现了正确的名称“fetchXML”

[http://msdn.microsoft.com/en-us/library/gg328117.aspx](http://msdn.microsoft.com/en-us/library/gg328117.aspx)

这当然是 MS 的专利，但至少你可以确定他们已经涵盖了任何可能的情况。

# ruby-on-rails - Eclipse 中带有 SQL Server 的新 RadRails 项目

> ID：826551
> 
> 赞同：1
> 
> 时间：2009-05-05T19:31:07.690
> 
> 标签：ruby-on-rails, aptana, radrails

我正在尝试进入 Rails 开发并使用 Aptana Studio (RadRails) 作为 Eclipse (WinXP) 的插件。当我使用此处显示的选项创建新项目时

[NewRailsProject http://www.sqeq.com/image/NewRailsProject.jpg](http://www.sqeq.com/image/NewRailsProject.jpg)

事情往南走。我马上得到这个错误：

[替代文字 http://www.sqeq.com/image/NewRailsProject2.jpg](http://www.sqeq.com/image/NewRailsProject2.jpg)

Mongrel 设置为默认服务器，并且由于缺少日志文件而抱怨启动。果然，几乎整个项目骨架都不存在。

使用在 New Project 屏幕中选择的另一个 dbms 进行相同的练习工作得很好，我已经能够通过安装 MS jdbc 驱动程序并获取 ADO.rb 文件将我的项目从 MySQL 切换到 SQL Server复制到我的 Ruby 安装 ala[这篇文章](http://justinram.wordpress.com/category/ruby/ruby-on-rails/)。

在没有上述解决方法的情况下让 RadRails 执行此操作是否有技巧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T04:38:16.250

我不得不说，虽然这不是对您的问题的具体回答，但当我上次查看 radrails 时，我对它并没有留下深刻的印象。它建立在旧版本的 eclipse 上，使用起来非常痛苦。

您可能会在 stackoverflow 中寻找其他一些 ide 选择：[https](https://stackoverflow.com/search?q=ide+rails) ://stackoverflow.com/search?q=ide+rails 。

# php - cronjob 上的 PHP 错误，提示时工作正常

> ID：826552
> 
> 赞同：3
> 
> 时间：2009-05-05T19:31:21.247
> 
> 标签：php, linux, cron

我在 cronjob 上运行以下脚本...

```
cd /etc/parselog/
php run_all.php >/dev/null 
```

并收到以下错误：

```
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './pdo.so' - ./pdo.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './mysql.so' - ./mysql.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './mysql.so' - ./mysql.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './mysqli.so' - ./mysqli.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './odbc.so' - ./odbc.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './pdo.so' - ./pdo.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './pdo_mysql.so' - ./pdo_mysql.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './pdo_odbc.so' - ./pdo_odbc.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Warning:  PHP Startup: Unable to load dynamic library './pdo_sqlite.so' - ./pdo_sqlite.so: cannot open shared object file: No such file or directory in Unknown on line 0
[05-May-2009 20:30:12] PHP Fatal error:  Call to undefined function mysql_connect() in /etc/parselog/stats_downloads.php on line 5 
```

但是，当我从命令行运行相同的脚本并登录时，它可以完美运行而没有错误。

这是我在提示符下的 $PATH 字符串：

```
$PATH = /usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/X11R6/bin:/root/bin 
```

有什么想法或建议吗？我确定在运行 cronjob 时，它没有 lib 路径或包含的内容。我什至尝试添加确切的路径

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T19:35:56.117

提示 1：确保您在 cron 作业中具有完全相同的 $PATH：

```
cd /etc/parselog/
export PATH=/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/X11R6/bin:/root/bin
php run_all.php >/dev/null 
```

提示 2：确保所有其他环境变量也匹配。使用命令转储环境`env`，并将相应的导出添加到您的 cron 作业中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T19:36:57.487

通常，当 cron 期间发生故障但在命令行上运行时，它是权限、工作目录或环境变量。

看起来 php 可执行文件本身没有加载库，问题可能不在您的脚本中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T17:19:07.840

当您在 cron 作业中运行脚本时，它会在有限的 shell 中运行，并且设置的环境变量非常少。从您的错误来看，可能需要将 LD_LIBRARY_PATH 设置为与一堆共享库有关的错误，但这只是一个猜测。看起来在 cron 脚本中没有正确设置 PHP 的正确库路径。

*您可以通过将env*命令添加到脚本并捕获输出来捕获运行 cron 脚本时使用的环境。将此与提示符处的*env输出进行比较并查找变化。*它们很可能来自您的本地或系统*配置文件*或设置库路径的*bashrc*（甚至可能是*.login ）文件中发出的命令。*我会专门寻找与 PHP 相关的路径和变量，因为这似乎是您的问题。

在我的上一个项目中，我不得不多次处理这个问题，基本的解决方案是：

1.  确定执行脚本所需的最低环境
2.  创建一个简短的脚本来设置所需的环境
3.  在启动应用程序的脚本中添加对第 2 项脚本的调用，以便正确设置环境。
4.  彻底测试以确保您没有遗漏任何东西:-)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-03T16:40:48.057

当从用户 crontab 运行 cron 作业时，它将作为该用户执行。但是，它不会获取用户主目录中的任何文件，例如他们的 .profile、.cshrc 或 .bashrc 或任何其他文件。如果您需要 cron 来获取（读取）脚本所需的任何文件，您应该从 cron 正在调用的脚本中执行此操作。设置路径、源文件、设置环境变量等。

# c++ - 使用 Speex 和 DirectSound 的声学回声消除 (AEC)

> ID：826554
> 
> 赞同：8
> 
> 时间：2009-05-05T19:31:52.617
> 
> 标签：c++, audio, echo, directsound, speex

我正在尝试使用 Speex 编解码器库执行回声消除 (AEC)。根据 Speex 文档，我需要执行两个调用：

```
 speex_echo_playback(echo_state, echo_frame); 
```

每次播放音频帧时，以及

```
 speex_echo_capture(echo_state, input_frame, output_frame); 
```

对于捕获的每一帧。

因为我使用的是 DirectSound，所以我想我可以在调用 speex_echo_playback 时使用主 DirectSound 缓冲区作为 echo_frame，例如，

```
 DWORD offset = 0;
  DWORD length = 0;
  LPVOID block1, block2;
  DWORD length1, length2;
  DWORD flags = DSBLOCK_ENTIREBUFFER;

  HRESULT hr = primary_buffer->Lock(
        offset
      , length
      , &block1
      , &length1
      , &block2
      , &length2
      , flags
      );

  // Would like to convert the buffer into a form that
  // speex_echo_capture() can use.
  // Why does length1 == length2 == 0 always? 

  hr = primary_buffer->Unlock( block1, length1, block2, length2 ); 
```

文档确实说这些是只写指针，但无论如何我自己都不能使用缓冲区数据吗？

这基本上就是我创建缓冲区的方式：

```
 CComPtr< IDirectSoundBuffer > primary_buffer;
  DSBUFFERDESC primarydesc = { sizeof( DSBUFFERDESC ),
      DSBCAPS_PRIMARYBUFFER | DSBCAPS_CTRL3D | DSBCAPS_LOCHARDWARE,
      0, 0, NULL, DS3DALG_HRTF_LIGHT };
  HRESULT hr = directsound_->CreateSoundBuffer(
      &primarydesc, &primary_buffer, NULL ); 
```

似乎，使用 DirectSound 缓冲区本身的替代方法是使用 speex_decode() 的输出并进行我自己的软件混合。

让 Speex 和 DirectSound 一起工作的任何指示或建议？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-28T03:27:09.850

我做过一次。但我的方法如下：

我从来没有直接使用过主缓冲区。相反，我只使用了一个二级缓冲区。我有两个线程——播放线程和捕获线程。另外，我使用了另一个 speex 函数 - [speex_echo_cancellation](http://www.speex.org/docs/api/speex-api-reference/group__SpeexEchoState.html#g306c6fd37bb64e4de6a50808e65cbedf)。

因此，在我的播放线程中，我将当前播放帧保存在全局缓冲区中，并在名为 speex_echo_cancellation 函数的捕获线程中保存了当前捕获帧和先前存储的播放帧。

DMO 不适用于我，因为我还必须支持 Windows XP。

您还可以查看 - [speex 邮件列表存档](http://lists.xiph.org/pipermail/speex-dev/)，或者甚至[在此处订阅](http://lists.xiph.org/mailman/listinfo/speex-dev)以获得更多有趣的信息。

祝你好运，

安东尼

# c# - 实例类的静态成员

> ID：826555
> 
> 赞同：8
> 
> 时间：2009-05-05T19:32:45.937
> 
> 标签：c#, static

实例类的静态成员是否只与实例本身一样存在，还是静态成员会在应用程序的整个生命周期中存在？

例如，假设我有一个 Hashtable 作为静态属性。如果我从一个“实例”向其中添加项目，它们是否可以从另一个“实例”获得？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-05T19:35:11.830

他们生活在整个生命周期中`AppDomain`。（对于 Windows 应用程序，这通常是进程的生命周期；但可能不是，这取决于您正在做什么。`AppDomains`在 ASP.NET 中定期回收。）

不要将静态变量视为在实例之间共享 - 将它们视为属于*类型*而不是任何特定实例。*当您有时从不创建任何*实例时，这使您更容易理解事物的工作原理。

例如：

```
class Test
{
    static int x = 0;

    static void Main()
    {
        x = 10;
        Console.WriteLine(x);
    }
} 
```

周围没有“共享”的实例*——*`Test.x`但这没关系，因为它与类型相关联，`Test`而不是与.*`Test`*

 *你可能会说这是一个非常微妙的区别，但我发现这是一个有用的区别。

# c# - WritableBitmap 在单独的线程上不起作用？

> ID：826557
> 
> 赞同：2
> 
> 时间：2009-05-05T19:34:31.830
> 
> 标签：c#, wpf, multithreading

我有一个 WritableBitmap，它在一个单独的线程上更新，特别是为了响应一个事件。

```
myWritableBitmap.Lock();
CopyMemory(myWritableBitmap.BackBuffer, ...);
myWritableBitmap.AddDirtyRect(...);
myWritableBitmap.Unlock();
```

当按原样在单独的线程上运行时，该`Lock()`命令会抛出一个`System.InvalidOperationException`.

如果我像这样运行相同的代码：

```
this.Dispatcher.Invoke(new VoidDelegate(delegate
{
  //Same code as above...
}));
```

没有抛出异常，代码运行完美。Lock() 的目的不是允许多线程访问吗？知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T19:42:01.563

许多 WPF 绘图函数必须在 STAThread 中运行。第二段代码使您的绘图函数在主 UI 线程中运行。

编辑：更多关于 WPF 中的线程在[这里](http://blogs.msdn.com/dwayneneed/archive/2007/04/26/multithreaded-ui-hostvisual.aspx)找到。

# javascript - 面向专家开发人员的介绍性 JavaScript 编程任务

> ID：826564
> 
> 赞同：5
> 
> 时间：2009-05-05T19:36:00.050
> 
> 标签：javascript

作为该语言的高级“介绍”，什么是与 JavaScript 亲密接触的好小项目？我想在 JS 中实际编写应用程序，而不是连接它的一部分来增强 Web 应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T19:50:59.297

通过在页面上使用 RSS 阅读器可以学到很多东西。谷歌展示了可以做什么。整节课集中在javascript、网络访问、安全限制和媒体数据管理上。如果您有能力进行任何类型的后端编程，那么 AJAX 真的很不错。你可以用更少的努力获得很多好的效果。建立起来是一件好事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T19:56:09.860

我会争辩说，如果你真的是一个高级程序员，那么上面的练习不会让你真正了解这门语言，因为它们只是你可能已经做过的事情的变体。Javascript 的强项是它的 LISP 风格的成长能力。写一些人工智能（ish）来创建新功能。大多数人不会以这种方式使用该语言，但是，我认为，它能够即时扩充自己的类是最不寻常和最强大的功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T19:52:02.430

虽然不是一个项目，但请在 YUI 剧院观看 Douglas Crockford 的视频。

最大的基于 Web 的 Javascript 项目将处理 DOM。用 JQuery 做一些漂亮的事情。制作一个表格，其中的行在您悬停时突出显示。当您单击它们时，使它们通过 AJAX 和 JSON 进行自我更新。

如果您真的在寻找神奇而有用的东西，请为 IE8 编写一个带有固定页眉和页脚的可滚动表格。

如果您想远离 WEB，请使用 JDK 1.6 并在其中运行 Javascript 代码。你可以用它做吨。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T20:12:18.590

每当我试图熟悉一门语言时，我都会用它来解决[Project Euler](http://projecteuler.net/)的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T19:37:44.320

我会先实现一个像推箱子这样的简单游戏。

第二个应用程序是基于 AJAX 的多用户聊天应用程序，首先通过轮询获取其他人的响应，然后使用 AJAX 推送。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T19:40:50.600

圣杯 - 所见即所得的编辑器。他们不需要完成它，但只要看看他们的攻击计划就会很有趣。直接进入模式和 OO。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T19:41:03.110

有趣的问题。

真的，你可以做任何类型的应用程序。为了确保您使用的是最新最好的东西，我会尝试使用 DHTML 和 AJAX 制作一个简单的 CRUD 样式应用程序。也许是联系人列表或日历。如果你感觉精力充沛，你也可以用 JavaScript 编写后端。

除非您想对 DOM 和浏览器兼容性非常友好，否则我会通过 Jquery 或 Prototype 等不错的框架之一来学习 Javascript。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-05T21:07:50.123

我建议您创建一个 Google 小工具。您可以免费创建一个，也许可以从中做出一些有用的东西。如果您没有 Google 帐户，请注册一个。然后添加 Google 小工具编辑器以开始编写您的代码。

使用该小工具，您将能够处理 JavaScript、JSON、CSS 等。此外，您将能够将文件存储在 Google 的服务器上，以便您可以在任何计算机上处​​理它。

我创建了一个简单的 RSS 阅读器并编写了 JavaScript 来获取提要（使用 Google 的 API），然后处理该 JavaScript 对象，因为它以 JSON 形式返回。然后我开发了一些 JavaScript 来隐藏/显示 div 标签。

对我来说学习 JavaScript 是一个很好的入门项目。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-06T04:35:37.037

Get JavaScript the Good Parts 由 Douglas Crockford 撰写。还可以查看他的网站：[http ://www.crockford.com](http://www.crockford.com)

关键原因：仅仅因为 JavaScript 看起来像 C/C++/Java/C# 并不意味着它实际上就像它们。情况明显不同。我建议阅读他的书以了解这些差异。

否则，我会查看 JQuery 网站。JavaScript 很酷，但是一个好的框架可以让你避免很多陷阱，让你更快地提高工作效率。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-05T19:38:14.193

尝试制作高级[AJAX](http://www.asp.net/ajax/)应用程序，例如尝试重新创建[google calander](http://www.google.com/calendar)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-05T21:08:02.807

一个 Firefox 插件来监控 StackOverflow 怎么样？它可以使用 RSS 来监控提要，并在您的标签提出新问题时通知您。

它也可以随着你的 js 技能的进步而增长。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-06T04:22:00.813

编写另一个 javascript 框架，但专注于某些东西，即游戏编程。

# c++ - 令人信服的自定义 C++ 分配器示例？

> ID：826569
> 
> 赞同：191
> 
> 时间：2009-05-05T19:36:48.660
> 
> 标签：c++, memory-management, std, memory-alignment, allocator

`std::allocator`放弃定制解决方案有哪些真正好的理由？您是否遇到过任何对正确性、性能、可扩展性等绝对必要的情况？有什么非常聪明的例子吗？

自定义分配器一直是我不太需要的标准库的一个特性。我只是想知道这里是否有人可以提供一些令人信服的例子来证明他们的存在。

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-05-05T19:53:45.840

[正如我在这里](https://stackoverflow.com/questions/657783/how-does-intel-tbbs-scalableallocator-work)提到的，我已经看到英特尔 TBB 的自定义 STL 分配器显着提高了多线程应用程序的性能，只需更改单个

```
std::vector<T> 
```

至

```
std::vector<T,tbb::scalable_allocator<T> > 
```

（这是切换分配器以使用 TBB 的漂亮线程私有堆的一种快速便捷的方法；请参阅[本文档中的第 7 页](http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=A2FFF3D179B57EC23B9656993289BE8F?doi=10.1.1.71.8289&rep=rep1&type=pdf)）

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-05-05T20:01:09.240

One area where custom allocators can be useful is game development, especially on game consoles, as they have only a small amount of memory and no swap. On such systems you want to make sure that you have tight control over each subsystem, so that one uncritical system can't steal the memory from a critical one. Other things like pool allocators can help to reduce memory fragmentation. You can find a long, detailed paper on the topic at:

[EASTL -- Electronic Arts Standard Template Library](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2271.html)

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2012-09-21T11:06:30.657

我正在研究一个 mmap-allocator，它允许向量使用内存映射文件中的内存。目标是让向量使用直接在 mmap 映射的虚拟内存中的存储。我们的问题是在没有复制开销的情况下改进将非常大的文件（>10GB）读取到内存中，因此我需要这个自定义分配器。

到目前为止，我有一个自定义分配器的骨架（它源自 std::allocator），我认为编写自己的分配器是一个很好的起点。随意以任何你想要的方式使用这段代码：

```
#include <memory>
#include <stdio.h>

namespace mmap_allocator_namespace
{
        // See StackOverflow replies to this answer for important commentary about inheriting from std::allocator before replicating this code.
        template <typename T>
        class mmap_allocator: public std::allocator<T>
        {
public:
                typedef size_t size_type;
                typedef T* pointer;
                typedef const T* const_pointer;

                template<typename _Tp1>
                struct rebind
                {
                        typedef mmap_allocator<_Tp1> other;
                };

                pointer allocate(size_type n, const void *hint=0)
                {
                        fprintf(stderr, "Alloc %d bytes.\n", n*sizeof(T));
                        return std::allocator<T>::allocate(n, hint);
                }

                void deallocate(pointer p, size_type n)
                {
                        fprintf(stderr, "Dealloc %d bytes (%p).\n", n*sizeof(T), p);
                        return std::allocator<T>::deallocate(p, n);
                }

                mmap_allocator() throw(): std::allocator<T>() { fprintf(stderr, "Hello allocator!\n"); }
                mmap_allocator(const mmap_allocator &a) throw(): std::allocator<T>(a) { }
                template <class U>                    
                mmap_allocator(const mmap_allocator<U> &a) throw(): std::allocator<T>(a) { }
                ~mmap_allocator() throw() { }
        };
} 
```

要使用它，请按如下方式声明一个 STL 容器：

```
using namespace std;
using namespace mmap_allocator_namespace;

vector<int, mmap_allocator<int> > int_vec(1024, 0, mmap_allocator<int>()); 
```

例如，它可用于在分配内存时记录日志。必要的是重新绑定结构，否则向量容器使用超类分配/释放方法。

更新：内存映射分配器现在可在[https://github.com/johannesthoma/mmap_allocator](https://github.com/johannesthoma/mmap_allocator)获得，并且是 LGPL。随意将它用于您的项目。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-05-05T20:00:21.770

I'm working with a MySQL storage engine that uses c++ for its code. We're using a custom allocator to use the MySQL memory system rather than competing with MySQL for memory. It allows us to make sure we're using memory as the user configured MySQL to use, and not "extra".

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2009-05-05T19:52:33.003

使用自定义分配器来使用内存池而不是堆会很有用。这是许多其他例子中的一个。

对于大多数情况，这肯定是过早的优化。但它在某些情况下（嵌入式设备、游戏等）非常有用。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-10-28T21:42:58.100

在使用 GPU 或其他协处理器时，有时以*特殊方式*在主存储器中分配数据结构是有益的。这种分配内存的*特殊方式可以在自定义分配器中以方便的方式实现。*

在使用加速器时，通过加速器运行时进行自定义分配可能有益的原因如下：

1.  通过自定义分配，加速器运行时或驱动程序被通知内存块
2.  此外，操作系统可以确保分配的内存块是页锁定的（有些人称之为*固定内存*），即操作系统的虚拟内存子系统可能不会在内存中或从内存中移动或移除页面
3.  如果 1\. 和 2\. 保持并且请求页面锁定内存块和加速器之间的数据传输，则运行时可以直接访问主内存中的数据，因为它知道它在哪里，并且可以确定操作系统没有移动/移除它
4.  这节省了一个内存副本，该副本会在以非页面锁定方式分配的内存中发生：数据必须从主内存复制到页面锁定的暂存区，使用加速器可以初始化数据传输（通过 DMA )

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-05-05T19:52:47.560

我没有使用自定义 STL 分配器编写 C++ 代码，但我可以想象一个用 C++ 编写的网络服务器，它使用自定义分配器自动删除响应 HTTP 请求所需的临时数据。生成响应后，自定义分配器可以立即释放所有临时数据。

自定义分配器（我已经使用过）的另一个可能用例是编写单元测试来证明函数的行为不依赖于其输入的某些部分。自定义分配器可以用任何模式填充内存区域。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-05-05T20:23:00.217

我在这里使用自定义分配器；你甚至可以说它是为了*解决*其他自定义动态内存管理。

背景：我们有 malloc、calloc、free 以及 operator new 和 delete 的各种变体的重载，并且链接器很高兴地让 STL 为我们使用这些。这让我们可以做一些事情，比如自动小对象池、泄漏检测、分配填充、空闲填充、用哨兵填充分配、某些分配的缓存行对齐和延迟释放。

问题是，我们在嵌入式环境中运行——没有足够的内存在很长一段时间内实际正确地进行泄漏检测记帐。至少，标准 RAM 中没有——通过自定义分配函数，其他地方还有另一堆可用的 RAM。

解决方案：编写一个使用扩展堆的自定义分配器，并*仅*在内存泄漏跟踪架构的内部使用它......其他一切都默认为进行泄漏跟踪的正常新/删除重载。这避免了跟踪器跟踪本身（并且还提供了一些额外的打包功能，我们知道跟踪器节点的大小）。

出于同样的原因，我们还使用它来保存功能成本分析数据；为每个函数调用和返回以及线程切换编写一个条目可能会很快变得昂贵。自定义分配器再次在更大的调试内存区域中为我们提供更小的分配。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-03-17T02:47:31.480

一种基本情况：在编写必须跨模块（EXE/DLL）边界工作的代码时，必须让您的分配和删除只发生在一个模块中。

我遇到的地方是 Windows 上的插件架构。例如，如果您将 std::string 传递到 DLL 边界，则该字符串的任何重新分配都发生在它起源的堆中，而不是 DLL 中可能不同的堆*。

**它实际上比这更复杂，好像您正在动态链接到 CRT，这可能无论如何都可以工作。但是，如果每个 DLL 都有指向 CRT 的静态链接，那么您将进入一个痛苦的世界，幻象分配错误不断发生。*

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-05-27T12:09:47.073

我正在使用自定义分配器来计算程序一部分中的分配/解除分配的数量并测量需要多长时间。还有其他方法可以实现，但这种方法对我来说非常方便。我可以将自定义分配器仅用于我的容器的一个子集，这一点特别有用。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-01-14T22:54:37.493

必须链接到 Andrei Alexandrescu 在 CppCon 2015 上关于分配器的演讲：

[https://www.youtube.com/watch?v=LIb3L4vKZ7U](https://www.youtube.com/watch?v=LIb3L4vKZ7U)

好消息是，仅仅设计它们会让你想到如何使用它们的想法:-)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2021-07-20T23:10:43.303

自定义分配器是在释放内存之前安全擦除内存的合理方法。

```
template <class T>
class allocator
{
public:
    using value_type    = T;

    allocator() noexcept {}
    template <class U> allocator(allocator<U> const&) noexcept {}

    value_type*  // Use pointer if pointer is not a value_type*
    allocate(std::size_t n)
    {
        return static_cast<value_type*>(::operator new (n*sizeof(value_type)));
    }

    void
    deallocate(value_type* p, std::size_t) noexcept  // Use pointer if pointer is not a value_type*
    {
        OPENSSL_cleanse(p, n);
        ::operator delete(p);
    }
};
template <class T, class U>
bool
operator==(allocator<T> const&, allocator<U> const&) noexcept
{
    return true;
}
template <class T, class U>
bool
operator!=(allocator<T> const& x, allocator<U> const& y) noexcept
{
    return !(x == y);
} 
```

推荐使用 Hinnant 的分配器样板： [https](https://howardhinnant.github.io/allocator_boilerplate.html) ://howardhinnant.github.io/allocator_boilerplate.html ）

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-07-11T16:36:08.663

我曾经使用过这些的一个例子是使用资源非常有限的嵌入式系统。假设您有 2k 的可用内存，并且您的程序必须使用其中的一些内存。您需要在不在堆栈中的某个地方存储 4-5 个序列，此外，您需要非常精确地访问这些东西的存储位置，这是您可能想要编写自己的分配器的情况。默认实现可能会造成内存碎片，如果您没有足够的内存并且无法重新启动程序，这可能是不可接受的。

我正在做的一个项目是在一些低功率芯片上使用 AVR-GCC。我们必须存储 8 个可变长度但已知最大值的序列。内存管理的[标准库实现](http://www.nongnu.org/avr-libc/user-manual/malloc.html)是一个围绕 malloc/free 的薄包装器，它通过在每个分配的内存块前面加上一个指向刚刚超过该分配内存块末尾的指针来跟踪放置项目的位置。当分配一块新的内存时，标准分配器必须遍历每块内存以找到下一个可用的块，该块适合所请求的内存大小。在桌面平台上，这对于这几个项目来说会非常快，但你必须记住，相比之下，其中一些微控制器非常缓慢和原始。此外，内存碎片问题是一个巨大的问题，这意味着我们真的别无选择，只能采取不同的方法。

所以我们所做的就是实现我们自己的[内存池](https://en.wikipedia.org/wiki/Memory_pool)。每个内存块都足够大，可以容纳我们需要的最大序列。这会提前分配固定大小的内存块，并标记当前正在使用的内存块。我们通过保留一个 8 位整数来做到这一点，其中每个位表示是否使用了某个块。我们在这里权衡了内存使用以试图使整个过程更快，在我们的案例中这是合理的，因为我们正在推动这个微控制器芯片接近它的最大处理能力。

还有很多次我可以看到在嵌入式系统的上下文中编写自己的自定义分配器，例如，如果序列的内存不在主 ram 中，而[这些平台](https://en.wikipedia.org/wiki/Modified_Harvard_architecture)上可能经常出现这种情况。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-05-25T14:12:41.570

对于共享内存，不仅容器头，而且它包含的数据都存储在共享内存中，这一点至关重要。

[Boost::Interprocess](http://www.boost.org/doc/libs/1_50_0/doc/html/interprocess/quick_guide.html#interprocess.quick_guide.qg_interprocess_container)的分配器就是一个很好的例子。但是，正如您可以[在此处](http://www.boost.org/doc/libs/1_50_0/doc/html/interprocess/allocators_containers.html#interprocess.allocators_containers.containers_explained.containers)阅读的那样，仅此还不足以使所有 STL 容器共享内存兼容（由于不同进程中的映射偏移量不同，指针可能会“中断”）。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2017-11-05T15:35:51.913

前段时间我发现这个解决方案对我非常有用：[Fast C++11 allocator for STL containers](https://github.com/moya-lang/Allocator)。它略微加快了 VS2017 (~5x) 和 GCC (~7x) 上的 STL 容器。它是一种基于内存池的特殊用途分配器。仅由于您要求的机制，它才能与 STL 容器一起使用。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2015-01-02T18:21:16.177

我个人使用 Loki::Allocator / SmallObject 来优化小对象的内存使用——如果您必须处理中等数量的非常小的对象（1 到 256 字节），它会显示出良好的效率和令人满意的性能。如果我们谈论分配适度数量的许多不同大小的小对象，它可以比标准 C++ 新/删除分配效率高约 30 倍。此外，还有一个名为“QuickHeap”的特定于 VC 的解决方案，它带来了最佳性能（分配和解除分配操作只是读取和写入正在分配/返回到堆的块的地址，在高达 99.(9)% 的情况下） — 取决于设置和初始化），但代价是显着的开销 — 每个范围需要两个指针，每个新内存块需要一个额外的指针。它'

标准 C++ new/delete 实现的问题在于它通常只是 C malloc/free 分配的包装器，它适用于更大的内存块，例如 1024+ 字节。它在性能方面有显着的开销，有时还有用于映射的额外内存。因此，在大多数情况下，自定义分配器的实现方式可以最大化性能和/或最小化分配小（≤1024 字节）对象所需的额外内存量。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2016-01-15T00:48:50.440

在图形模拟中，我看到自定义分配器用于

1.  `std::allocator`不直接支持的对齐约束。
2.  通过对短期（仅此帧）和长期分配使用单独的池来最小化碎片。

# sharepoint - SharePoint 解决方案包部署随机失败

> ID：826583
> 
> 赞同：1
> 
> 时间：2009-05-05T19:40:40.677
> 
> 标签：sharepoint, moss, stsadm, wsp, solution-deployment

在解决方案部署和/或功能激活期间，我偶尔会看到此错误...

复制此文件失败。此操作使用无法联系到的 SharePoint 管理服务 (spadmin)。如果该服务已停止或禁用，请启动它并再次尝试该操作。

以下是用于部署的 PowerShell 脚本：

```
$programfiles_path = $null
$stsadm_path = $null
$url = $null
$solution = $null
$feature = $null
$appPoolName = $null

$url = "http://" + ${env:COMPUTERNAME}
$programfiles_path = ${env:ProgramW6432}

if ($programfiles_path -eq $null)
{
    $programfiles_path = ${env:ProgramFiles}
}

$stsadm_path = $programfiles_path + "\common files\microsoft shared\web server extensions\12\bin\stsadm.exe"

if(!(test-path $stsadm_path))
{
    echo "stsadm.exe was not found: $stsadm_path"
    exit -1
}

ECHO "***********************************"
ECHO "*** Contoso.Common.SolutionPackage ***"
ECHO "***********************************"

$solution = "Contoso.Common.SolutionPackage.wsp"

ECHO "*** add the solution ***"
& $stsadm_path -o addsolution -filename $solution 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*** deploy the solution ***"
& $stsadm_path -o deploysolution -name $solution -immediate -allowgacdeployment -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = "Contoso.Common.Infrastructure"

ECHO "*** activate feature(s) ***"
& $stsadm_path -o activatefeature -name $feature -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = "Contoso.CustomCAS"

ECHO "*** activate feature(s) ***"
& $stsadm_path -o activatefeature -name $feature -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = "Contoso.Common.WebParts"

ECHO "*** activate feature(s) ***"
& $stsadm_path -o activatefeature -name $feature -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = "Contoso.ExcelExtender"

ECHO "*** activate feature(s) ***"
& $stsadm_path -o activatefeature -name $feature -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*********************************"
ECHO "*** Contoso.Something ***"
ECHO "*********************************"

$solution = "Contoso.Something.wsp"

ECHO "*** add the solution ***"
& $stsadm_path -o addsolution -filename $solution 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*** deploy the solution ***"
& $stsadm_path -o deploysolution -name $solution -immediate -allowgacdeployment -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = "Contoso.Something"

ECHO "*** activate feature(s) ***"
& $stsadm_path -o activatefeature -name $feature -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*********************************"
ECHO "*** Contoso.Nothing ***"
ECHO "*********************************"

$solution = "Contoso.Nothing.wsp"

ECHO "*** add the solution ***"
& $stsadm_path -o addsolution -filename $solution 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*** deploy the solution ***"
& $stsadm_path -o deploysolution -name $solution -immediate -allowgacdeployment -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = $null

ECHO "*****************************************"
ECHO "*** Contoso.Everything ***"
ECHO "*****************************************"

$solution = "Contoso.Everything.wsp"

ECHO "*** add the solution ***"
& $stsadm_path -o addsolution -filename $solution 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*** deploy the solution ***"
& $stsadm_path -o deploysolution -name $solution -immediate -allowgacdeployment -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = "Contoso.Everything"

ECHO "*** activate feature(s) ***"
& $stsadm_path -o activatefeature -name $feature -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*****************************"
ECHO "*** Contoso.CashMoneyMillionaires ***"
ECHO "*****************************"

$solution = "Contoso.CashMoneyMillionaires.wsp"

ECHO "*** add the solution ***"
& $stsadm_path -o addsolution -filename $solution 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*** deploy the solution ***"
& $stsadm_path -o deploysolution -name $solution -immediate -allowgacdeployment -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = "Contoso.CashMoneyMillionaires"

ECHO "*** activate feature(s) ***"
& $stsadm_path -o activatefeature -name $feature -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "************************************"
ECHO "*** Contoso.DollaDollaBill ***"
ECHO "************************************"

$solution = "Contoso.DollaDollaBill.wsp"

ECHO "*** add the solution ***"
& $stsadm_path -o addsolution -filename $solution 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "*** deploy the solution ***"
& $stsadm_path -o deploysolution -name $solution -immediate -allowgacdeployment -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

$feature = "Contoso.DollaDollaBill"

ECHO "*** activate feature(s) ***"
& $stsadm_path -o activatefeature -name $feature -url $url -force 
if ($? -eq $false) { exit }

ECHO "*** execute admin jobs ***"
& $stsadm_path -o execadmsvcjobs        
if ($? -eq $false) { exit }

ECHO "************************"
ECHO "*** IIS APPPOOL MGMT ***"
ECHO "************************"

ECHO "*** query wmi for apppool ***"
$appPoolName = "SharedServices1"
$appPool = get-wmiobject -namespace "root\MicrosoftIISv2" -class "IIsApplicationPool" | Where-Object {$_.Name -eq "W3SVC/APPPOOLS/$appPoolName"}
if ($? -eq $false) { exit }

ECHO "*** recycle apppool ***"
$appPool.Recycle()
if ($? -eq $false) { exit } 
```

我有一个等效的批处理文件，它也随机失败。它在不同的服务器上失败。我对原因和解决方案感到非常困惑。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-06T18:11:59.930

我发现做的最好的事情是有一个 Power Shell，它会等待一个挂起的计时器作业完成，然后再继续下一个任务，你可以但暂停一下，但是这需要你检查以确保时间作业完成了。

诀窍是使用 stsadm -o displaysolution -name 轮询服务器。如果 wsp 安装在场上，则命令返回一些 xml，如果有用于部署的计时器作业，则 xml 中有一个“SolutionDeploymentJob”标签。使用简单的循环，您可以等待时间作业完成

```
函数 WaitForJobOn($name){
    [xml]$val = stsadm -o 显示解决方案 -name $name
    而（$val.Solution.SolutionDeploymentJob）{
        $log.Info("等待 $name 上的工作")
        睡觉 5
        [xml]$val = stsadm -o 显示解决方案 -name $name
    }
    $log.Info("作业完成")
}
```

用法： `WaitForJobOn somefeature.wsp`

需要注意的是，如果 wsp 未添加到场中，该功能将失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-29T18:40:22.740

我也遇到了这个问题。我解决它的唯一方法是每次在部署/撤回之前重新启动 Windows SharePoint Services 管理服务。

更新：我重新启动了 WFE 服务器，这个问题已经消失了。我希望我有更多的信息为什么，但经典的微软重启解决方案再次盛行。

这很烦人。

另一个更新：我刚刚发布了一个名为[smartexecjobdefs](http://trentacular.com/2009/09/sharepoint-smartsolutionupgrade-stsadm-command/)的 stsadm 命令来解决这个问题。在这篇[博](http://trentacular.com/2009/09/sharepoint-smartsolutionupgrade-stsadm-command/)文中，我讨论了一个作业定义执行器，它在返回控制权之前监控正在运行的作业的完成情况。这个 stsadm 命令简单地包装了这个类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:20:38.770

您需要在部署解决方案和尝试激活您的功能之间暂停——这有点竞争条件。

**更多：**如果有多个 Web 前端，并且连接速度很慢，或者服务器很忙，或者其他任何导致此类事情花费一些时间的事情 - 那么你就会遇到麻烦。批处理文件无法处理它——Powershell 脚本可以使用对象模型在继续之前检查解决方案是否真正部署。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-30T08:21:36.103

我也遇到过这个问题。每次我尝试部署解决方案时，都会复制一些文件，然后在复制所有文件之前停止并出现此错误。我没有任何证据，但我相信服务器上的防病毒软件锁定了文件并进行了干扰。

在我尝试多次部署该解决方案后它最终起作用了（每次复制的文件都比以前多一些）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-01T07:34:58.793

当在具有多个 Web 前端服务器的 SharePoint 场中使用时，我发现 Windows SharePoint 管理服务 (SPAdmin) 在 sp1 中偶尔会失败。

我建议禁用 spadmim 并使用 psexec 等远程执行工具运行 stsadm -o execadmsvcjobs。

例子：

psexec.exe @serverlist.txt "C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\BIN\stsadm.exe" -o execadmsvcjobs

# c# - 根据三组数字生成可交换哈希？

> ID：826586
> 
> 赞同：0
> 
> 时间：2009-05-05T19:40:59.913
> 
> 标签：c#, hash

我需要基于三组“分数”结构生成一个可交换散列。

每个乐谱都有一个“开始”、一个“结束”和一个“数字”。

开始和结束通常都是巨大的数字（8-9 位），但数字只是从 1 到 4。

我需要它们是可交换的，所以顺序无关紧要。我目前正在使用 XOR，但它似乎给出了不好的结果。

由于我正在处理大型数据集，因此我更喜欢性能友好的解决方案。有什么建议么？谢谢=]

```
 public static int getCustomHash(cnvRegion c1, cnvRegion c2, cnvRegion c3)
    {
        int part1 = (c1.startLocation * c2.startLocation * c3.startLocation);
        int part2 = (c1.endLocation * c2.endLocation * c3.endLocation);
        int part3 = (c1.copyNumber + c2.copyNumber + c3.copyNumber)*23735160;
        return part1 ^ part2 ^ part3;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T19:45:36.827

[Thomas Wang在这里](http://www.concentric.net/~Ttwang/tech/inthash.htm)讨论了哈希函数。

*   请参阅 knuth 的方法以及 64 到 32 位混合函数。

Paul Hsieh 还有[一个关于整数散列的页面，](http://www.azillionmonkeys.com/qed/hash.html)其中描述了他的“SuperFastHash”函数，该函数得到了不同的反馈。

**编辑**

因为你希望你的自定义哈希是可交换的（我假设在 cnvRegion 参数之间）你可能会写这样的东西：

```
public int hash6432shift(long key)
{
   key = (~key) + (key << 18); // key = (key << 18) - key - 1;
   key = key ^ (key >>> 31);
   key = key * 21; // key = (key + (key << 2)) + (key << 4);
   key = key ^ (key >>> 11);
   key = key + (key << 6);
   key = key ^ (key >>> 22);
   return (int) key;
}

public static int getCustomHash(cnvRegion c1, cnvRegion c2, cnvRegion c3)
{
    int part1 = (c1.startLocation ^ c2.startLocation ^ c3.startLocation);
    int part2 = (c1.endLocation ^ c2.endLocation ^ c3.endLocation);
    int part3 = (c1.copyNumber ^ c2.copyNumber ^ c3.copyNumber);

    int hash1 = hash6432shift(((long)part1 << 0x20) | part2);
    return hash6432shift(((long)hash1 << 0x20) | part3);
} 
```

但是，最终找到一个既快速又提供良好抗碰撞性的哈希函数的任务在很大程度上取决于您正在处理的数据。

让我给你举个例子：

假设您要散列的值很大，有 10 位数字，它们代表 UNIX 时间戳（自 1970 年 1 月 1 日以来经过的时间，以秒为单位）。在这种情况下，对在有限时间跨度内发生的大量时间戳进行散列处理——比如一个月以上，只需消除没有变化的部分，只使用变化很大的时间戳部分即可。这与说您正在消除具有低熵的部分相同。

```
v1 = 1241536920   // 5/5/2009 3:22:00 PM
v2 = 1241529720   // 5/5/2009 1:22:00 PM
v3 = 1241270520   // 5/2/2009 1:22:00 PM
v4 = 1242825720   // 5/20/2009 1:22:00 PM 
```

很明显，我们可以安全地消除前 3-4 位数字，只使用剩余的数字作为哈希。此外，如果这些值通常在几分钟内出现，您也可以删除最后 2-3 位数字。

以这种方式，您只剩下 4 位数字，您可以将其用作我们的案例示例中具有非常好的抗碰撞性的哈希值。

我的观点是，***如果你知道你试图散列的值的统计分布，散列函数可以得到高度优化。***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T11:21:06.580

首先，我认为要求不是很明确。如果你散列三个数据集 c1、c2 和 c3。然后，如果您切换， c1.copyNumber 和 c2.copyNumber 并再次散列。这是否应该给出相同的结果？如果你用 c1.endLocation 切换 c1.startLocation。这是否应该导致相同的哈希？

我将假设您希望在这两种情况下都有不同的哈希结果，并且唯一不应该改变哈希结果的排列是数据集 c1、c2、c3 的排列。

如果是这种情况，那么我建议首先将三个数据集独立散列为较小的值。即 h1 = H(c1) h2 = H(c2) h3 = H(c3) 其中 H 可以是任何散列函数（例如，CRC32、Adler32、SHA1 等），具体取决于您希望避免冲突的程度。

下一步是计算 h1、h2、h3 的可交换散列。如果你想避免冲突，除非 h1、h2、h3 被置换，那么以下工作。计算多项式

*   P(x) = (x-h1)(x-h2)(x-h3)

然后用任何好的散列函数散列多项式（rsp。它的系数）。即那将是

*   H(h1+h2+h3 || h1 * h2 + h1 * h3 + h2 * h3 || h1 * h2 * h3)，其中 || 是串联。

如果您想不惜一切代价避免任何不必要的冲突，则应将系数计算为多精度整数，并应使用 SHA1 等抗冲突哈希函数。由于多项式 if 的独特因式分解性质，如果 h1、h2 和 h3 不同，则多项式的系数不同。但是，在您的情况下，不惜一切代价避免碰撞似乎是多余的。

因此，如果 h1、h2、h3 只是 32 位值，则与其象征性地计算多项式 P(x)，不如在任意值 RIe 处对其进行评估，然后计算以下内容可能就足够了：（下面是一些 C 类型的伪代码。我' m 不知道 C# 对 64 位整数使用什么）

```
const long long R = SOME_RANDOM_64_BIT_CONSTANT;
long long hash0 = (R - h1) * (R - h2) * (R - h3);
int hash = (int) (hash0 >> 32); 
```

我在这里使用 64 位乘法，因为它们在现代 CPU 上足够快，而且我使用 hash0 的高 32 位而不是低 32 位，因为低 32 位有些偏差。即，最低有效位更可能是 0 而不是 1。

# oop - Kent Beck 的测试驱动开发示例

> ID：826592
> 
> 赞同：2
> 
> 时间：2009-05-05T19:42:13.293
> 
> 标签：oop, tdd, private

我正在阅读[测试驱动开发：通过示例](https://rads.stackoverflow.com/amzn/click/com/0321146530)，其中一个示例困扰着我。在第 3 章（人人平等）中，作者`equals`在类中创建了一个函数`Dollar`来比较两个`Dollar`对象：

```
public boolean equals(Object object)
{
    Dollar dollar= (Dollar) object;
    return amount == dollar.amount;
} 
```

然后，在下一章（4：隐私）中，他将 amount 设为 Dollar 类的私有成员。

```
private int amount; 
```

并且测试通过了。这不应该导致`equals`方法中的编译器错误，因为虽然对象可以访问它自己的`amount`成员，因为它被限制访问另一个`Dollar`对象的`amount`成员？

```
//shouldn't dollar.amount be no longer accessable?
return amount == dollar.amount 
```

我从根本上误解了`private`吗？

**更新** 我决定回去手动编写代码，当我进入下一部分（第 6 章 - 所有人的平等，Redux）时，他们将数量推入父类并使其受到保护，我遇到了访问问题：

```
public class Money
{
    protected int amount;
}

public class Dollar : Money
{
    public Dollar(int amount)
    {
        this.amount = amount;
    }
    // override object.Equals
    public override bool Equals(object obj)
    {
        Money dollar = (Money)obj;
        //"error CS1540: Cannot access protected member 'Money.amount'
        // via a qualifier of type 'Money'; the qualifier must be of 
        // type 'Dollar' (or derived from it)" on the next line:
        return amount == dollar.amount;
    }
} 
```

这是否意味着`protected`在 C# 中是基于实例的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T19:44:26.143

是的，你从根本上误解了私人。隐私是特定于类的，而不是特定于实例的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T19:44:53.570

从根本上误解了私有，如果它们是同一个类，Dollar 可以访问任何 Dollar 私有方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T19:46:34.407

修饰符 private 是**class-private**，而不是 object-private。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T19:54:08.570

在 Java 中，`private`意味着类私有。在类中，您可以在类的所有实例中访问该字段。

在 Scala 中还有一个对象私有作用域，写成`private[this]`. 此外，在其他方面，Scala 的作用域更加灵活（有关更多信息，请参阅[本文](http://www.ibm.com/developerworks/java/library/j-scala07298.html)）。

但是在 Java 中没有对象私有范围。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T19:50:29.373

在 C++ 系列语言（C++、Java、C#）中，访问控制仅在类级别。因此 `private`允许访问该类的任何实例。

Smalltalk 隐私中的 IIRC 的行为与您期望的一样。

# jquery - 表头操作

> ID：826595
> 
> 赞同：1
> 
> 时间：2009-05-05T19:43:57.440
> 
> 标签：jquery

我将它与tablesorter 插件一起使用，我的目标是在任何未排序的列中都有一个空白类属性，即当我单击一列时，其他列中的类属性将被删除。

我有一张带有一大堆标题的表格，基本上我想要做的是当我点击表格标题时，我希望所有其他表格都删除它们的 css 类，但我点击的应该在两个 CSS 类之间切换。我在标题内容的锚标记中使用 rel 标记，我这样做是因为我们使用的是 XHTML Strict，并且 rel 不能在表标题标记本身中定义。我的代码如下：

```
$(function() {
     $("a[rel='Header']").click(function () {

         $("a[rel='Header']").each(function() {
            if($(this).attr("class")=="sort-up"){$(this).removeClass("sort-up");}
            if($(this).attr("class")=="sort-down"){$(this).removeClass("sort-down");}
        })

         if($(this).attr("class")==""){$(this).addClass("sort-up");}
            $(this).toggleClass("sort-down")
            });      
}); 
```

我假设它应该做的是，一旦单击标题，循环浏览每个标题，如果它包含类属性“排序”，则将其删除；如果它包含类属性“sort-down”，则将其删除。然后，对于当前单击的标题，添加类属性“sort-up”并在“sort-down”属性之间切换。我的问题是，当我单击一个标题时，如果它使用“排序”类，在标题中由向下箭头（/）表示，然后我去单击不同列中的另一个标题，该属性不会不要被删除。但是，它将删除“排序”类 (^)。
这是我在 XHTML 中的标题列表：

```
<thead>
            <tr>
                <th><a rel = "Header" href="#" class="">Title</a></th>
                <th><a rel = "Header" href="#" class="">Instructor</a></th>
                <th class="{sorter: 'usLongDate'}"><a rel = "Header" href="#" class="">Date</a></th>
                <th class="{sorter: false}">Start/End</th>
                <th><a rel = "Header" href="#" class="">Seats Available</a></th>
                <th><a rel = "Header" href="#" class="">Enrolled</a></th>
                <th><a rel = "Header" href="#" class="">Pre-Requisites</a></th>
                <th class="{sorter: false}">Workshop Actions</th>
            </tr>
        </thead> 
```

更新了蜡翼推荐的更改，愚蠢的错误，它有效，我没有注意 hasClass 的语法。谢谢。

```
$(function() {
     $("a[rel='Header']").click(function () {

         $("a[rel='Header']").each(function() {
            if($(this).hasClass("sort-up")){$(this).removeClass("sort-up");}
            if($(this).hasClass("sort-down")){$(this).removeClass("sort-down");}
        })

         if($(this).hasClass("")){$(this).addClass("sort-up");}
             if ($(this).hasClass("sort-up")) { 
                    $(this).removeClass("sort-up").addClass("sort-down"); 
                } else {
                    $(this).removeClass("sort-down").addClass("sort-up");
                }
            if($(this).attr("title") == "Sort column in ascending order"){
                $(this).attr({title : "Sort column in descending order"});}
            else {$(this).attr({title : "Sort column in ascending order"});} 
            });      
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T20:05:18.700

在我看来是这样的：单击一次，由于类为空，因此添加了排序类。然后，由于以下行，还添加了降序类。所以现在你有一个既向上排序又向下排序的单元格。单击另一个标题，两者都没有

```
if($(this).attr("class")=="sort-up") 
```

也不

```
if($(this).attr("class")=="sort-down") 
```

将是真的，所以类不会被删除。另一方面，如果您在锚点上单击两次，第一次将添加两个类，第二次将实际切换（删除）排序类。然后，当您单击另一列时，它会按预期工作。

我建议进行一些更改。而不是使用，

```
if($(this).attr("class")=="sort-up") 
```

您可以使用，

```
if ($(this).hasClass("sort-up")) 
```

如果还有其他类，这仍然是正确的。此外，在这种情况下，您不能使用 toggleClass。而是使用类似的东西，

```
if ($(this).hasClass("sort-up")) { 
    $(this).removeClass("sort-up").addClass("sort-down"); 
} else {
    $(this).removeClass("sort-down").addClass("sort-up");
} 
```

这应该在第一次单击时为锚点提供排序类别，然后在后续单击时在它们之间切换排序和排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T21:06:08.693

尝试：

```
$(function() {
  $("a[rel='Header']").click(function () {
    // store the header and this for later use
    var $thead = $(this).parents().filter("thead").slice(0,1);
    var $this = $(this);

    // if we were sort-up - we become sort-down - otherwise we become sort-up
    if ($this.hasClass('sort-up')) { 
      $this.removeClass('sort-up').addClass('sort-down');
    } else {
      $this.removeClass('sort-down').addClass('sort-up');
    }

    // all headers except the one we clicked on - remove sort classes
    $("a[rel='Header']",$thead).not($this[0]).each(function() {
      $(this).removeClass('sort-up').removeClass('sort-down');
    });

    // set link titles based on current class
    $("a[rel='Header']", $thead).each(function() {
      if ($(this).hasClass('sort-up'))
      {
        $(this).attr('title', 'Sort column in descending order');
      } else {
        $(this).attr('title', 'Sort column in ascending order');
      }
    });
    // end click function
  });
}); 
```

# c# - foreach 循环中的无限 IEnumerable

> ID：826598
> 
> 赞同：5
> 
> 时间：2009-05-05T19:44:20.777
> 
> 标签：c#, linq, yield

回答完[这个问题](https://stackoverflow.com/questions/826304/how-to-print-all-the-fibonacci-numbers-in-a-range)后，我将以下 C# 代码放在一起只是为了好玩：

```
public static IEnumerable<int> FibonacciTo(int max)
{     
    int m1 = 0;
    int m2 = 1;
    int r = 1;

    while (r <= max)
    {
       yield return r;

       r = m1 + m2;
       m1 = m2;
       m2 = r;
    }
}

foreach (int i in FibonacciTo(56).Where(n => n >= 24) )
{
   Console.WriteLine(i);
} 
```

问题是我不喜欢需要将`max`参数传递给函数。现在，如果我不使用其中一个，代码将输出正确的数据，但随着 IEnumerable 继续工作，它似乎会挂起。我怎样才能写这个，以便我可以像这样使用它：

```
foreach (int i in Fibonacci().Where(n => n >= 24 && n <= 56) )
{
   Console.WriteLine(i);
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-05T19:49:02.840

您需要使用 and 的组合来`SkipWhile`代替`TakeWhile`。

```
foreach (int i in Fibonacci().SkipWhile(n => n < 24)
                             .TakeWhile(n => n <= 56))
{
   Console.WriteLine(i);
} 
```

这些能够根据条件结束循环；`Where`流式传输其输入（适当过滤），直到输入用完（在您的情况下，永远不会）。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-05T19:48:03.843

除非您编写自己的 LINQ 提供程序，否则我认为这是不可能的。在您提供的示例中，您使用的是 LINQ to Objects，它需要完全评估 IEnumerable，然后才能对其应用过滤器。

# c# - 在 Silverlight 中保留用户首选项

> ID：826613
> 
> 赞同：8
> 
> 时间：2009-05-05T19:47:17.243
> 
> 标签：c#, asp.net, persistence, silverlight-2.0, preferences

我正在开发 Silverlight 客户端和相关的 ASP.NET Web 服务（不是 WCF），我需要实现一些包含用户首选项的功能，例如“最喜欢的项目”系统以及他们是否喜欢自动换行。为了提供愉快（而不是令人恼火）的用户体验，我想在会话中保留这些设置。一项简短的调查表明，主要有两种可能性。

1.  Silverlight 隔离存储
2.  ASP.NET 可访问的数据库

我意识到选项 2 可能是最好的选择，因为它确保即使用户禁用 Silverlight 的隔离存储，他们的偏好仍然存在，但我想避免此时维护数据库的负担，我喜欢这个想法即使服务器连接不可用，这些首选项也可用于加载和编辑。但是，我愿意接受有理由的论点，为什么现在而不是以后遭受这种打击可能更可取。

我正在寻找的是关于在任何一种情况下实现设置持久性的最佳方法的建议。例如，如果使用隔离存储，我应该使用 XML 格式还是其他文件布局来持久化设置？如果使用数据库方法，我是否必须设计一个设置表，或者 ASP.NET 中是否有内置机制来支持这一点，以及如何将首选项提供给客户端？

所以：

哪个解决方案是用户偏好持久性的更好解决方案？设置如何保留在该解决方案中，客户端如何访问和更新它们？

### 先前的研究

请注意，我已经对此事进行了一些先前的研究，并找到了以下链接，根据您阅读的文章，这些链接似乎支持任一解决方案。

*   [http://www.ddj.com/windows/208300036](http://www.ddj.com/windows/208300036)
*   [http://tinesware.blogspot.com/2008/12/persisting-user-settings-in-silverlight.html](http://tinesware.blogspot.com/2008/12/persisting-user-settings-in-silverlight.html)

### 更新

事实证明，微软已经在隔离存储中提供了设置持久性作为 Silverlight 的内置部分（我不知何故错过了它，直到实现了一个替代方案）。[我在下面的回答](https://stackoverflow.com/questions/826613/persisting-user-preferences-in-silverlight/832332#832332)对此有更多详细信息。

尽管 Microsoft 提供了客户端设置持久性，但我仍将问题保持开放，但这并不一定意味着这是保持用户偏好的最佳方法，我想就此征求更多意见和建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T23:52:51.110

[在研究了更多内容并使用IsolatedStorage](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage(VS.95).aspx)实现了我自己的基于 XML 文件的设置持久性之后，我发现了[IsolatedStorageSettings](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragesettings(VS.95).aspx)类和[IsolatedStorageSettings.ApplicationSettings](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragesettings.applicationsettings(VS.95).aspx)对象，该对象是一个键/值集合，专门用于存储用户特定的应用程序设置。

现在一切似乎都很明显。当然，从长远来看，使用服务器数据库备份和恢复设置的机制将很好地增强这种客户端设置的持久性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T20:08:21.140

我认为通常默认值是存储在服务器上；只有当有特定的令人信服的理由尝试存储在客户端上时，我们才应该这样做。您越依赖存储在您无法控制的介质中，您承担的风险就越大。

话虽如此，并且将自己置于论点的“数据库”方面，但我会问数据库的缺点是什么？您提到使用 XML - 您的数据只是半结构化的吗？如果是这样，为什么不将 XML 存储在 SQL 数据库中呢？按照大多数标准，设置这么简单的东西通常不会被视为“负担”。一个简单的 Web 服务可以充当 Silverlight 客户端和设置数据库之间的中介。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T14:01:25.227

如果用户可以在离线时访问他们的偏好对您来说是一项重要功能，那么看起来隔离存储是您的最佳选择。如果用户即使关闭了隔离存储也能够保存首选项更重要（这真的是个问题吗？我很想在这个问题上打电话给 YAGNI，但我对 Silverlight 平台的经验并不丰富。. .) 那么你需要托管一个数据库。如果两者都很重要，那么您可能正在寻找某种混合解决方案；如果可用，则使用隔离存储，然后回退到数据库。

换句话说，我认为你的应用程序的需求比一些抽象的最佳实践更重要。

# ruby - 使用 Perl 或 Ruby 提取 Excel 单元格注释的最佳方法是什么？

> ID：826617
> 
> 赞同：2
> 
> 时间：2009-05-05T19:47:46.713
> 
> 标签：ruby, perl, excel, parsing

我一直在使用[Spreadhsheet::ParseExcel](http://search.cpan.org/~jmcnamara/Spreadsheet-ParseExcel-0.44/lib/Spreadsheet/ParseExcel.pm)成功解析 Perl 中的 Excel 文档（如[在 Perl 中解析 Excel 文件的最佳方法是什么？](https://stackoverflow.com/questions/429193)），但我不知道如何提取单元格注释。

有任何想法吗？Perl 或 Ruby 中的解决方案将是理想的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-06T03:39:12.540

Python [xlrd](http://www.lexicon.net/sjmachin/xlrd.htm)库将解析单元格注释（如果您打开`xlrd.sheet.OBJ_MSO_DEBUG`，您会看到它们），但它不会从 API 中公开它们。您可以解析转储或对其稍作修改，以便以编程方式获取它们。这是一个开始（测试极少）：

```
diff --git a/xlrd/sheet.py b/xlrd/sheet.py
--- a/xlrd/sheet.py
+++ b/xlrd/sheet.py
@@ -206,6 +206,7 @@
         self._dimncols = 0
         self._cell_values = []
         self._cell_types = []
+        self._cell_notes = []
         self._cell_xf_indexes = []
         self._need_fix_ragged_rows = 0
         self.defcolwidth = None
@@ -252,6 +253,7 @@
         return Cell(
             self._cell_types[rowx][colx],
             self._cell_values[rowx][colx],
+            self._cell_notes[rowx][colx],
             xfx,
             )

@@ -422,12 +424,14 @@
                     if self.formatting_info:
                         self._cell_xf_indexes[nrx].extend(aa('h', [-1]) * nextra)
                 self._cell_values[nrx].extend([''] * nextra)
+                self._cell_notes[nrx].extend([None] * nextra)
         if nc > self.ncols:
             self.ncols = nc
             self._need_fix_ragged_rows = 1
         if nr > self.nrows:
             scta = self._cell_types.append
             scva = self._cell_values.append
+            scna = self._cell_notes.append
             scxa = self._cell_xf_indexes.append
             fmt_info = self.formatting_info
             xce = XL_CELL_EMPTY
@@ -436,6 +440,7 @@
                 for _unused in xrange(self.nrows, nr):
                     scta([xce] * nc)
                     scva([''] * nc)
+                    scna([None] * nc)
                     if fmt_info:
                         scxa([-1] * nc)
             else:
@@ -443,6 +448,7 @@
                 for _unused in xrange(self.nrows, nr):
                     scta(aa('B', [xce]) * nc)
                     scva([''] * nc)
+                    scna([None] * nc)
                     if fmt_info:
                         scxa(aa('h', [-1]) * nc)
             self.nrows = nr
@@ -454,6 +460,7 @@
         aa = array_array
         s_cell_types = self._cell_types
         s_cell_values = self._cell_values
+        s_cell_notes = self._cell_notes
         s_cell_xf_indexes = self._cell_xf_indexes
         s_dont_use_array = self.dont_use_array
         s_fmt_info = self.formatting_info
@@ -465,6 +472,7 @@
             nextra = ncols - rlen
             if nextra > 0:
                 s_cell_values[rowx][rlen:] = [''] * nextra
+                s_cell_notes[rowx][rlen:] = [None] * nextra
                 if s_dont_use_array:
                     trow[rlen:] = [xce] * nextra
                     if s_fmt_info:
@@ -600,6 +608,7 @@
         bk_get_record_parts = bk.get_record_parts
         bv = self.biff_version
         fmt_info = self.formatting_info
+        txos = {}
         eof_found = 0
         while 1:
             # if DEBUG: print "SHEET.READ: about to read from position %d" % bk._position
@@ -877,13 +886,23 @@
                 break
             elif rc == XL_OBJ:
                 # handle SHEET-level objects; note there's a separate Book.handle_obj
-                self.handle_obj(data)
+                obj = self.handle_obj(data)
+                if obj:
+                    obj_id = obj.id
+                else:
+                    obj_id = None
             elif rc == XL_MSO_DRAWING:
                 self.handle_msodrawingetc(rc, data_len, data)
             elif rc == XL_TXO:
-                self.handle_txo(data)
+                txo = self.handle_txo(data)
+                if txo and obj_id:
+                    txos[obj_id] = txo
+                    obj_id = None
             elif rc == XL_NOTE:
-                self.handle_note(data)
+                note = self.handle_note(data)
+                txo = txos.get(note.object_id)
+                if txo:
+                    self._cell_notes[note.rowx][note.colx] = txo.text
             elif rc == XL_FEAT11:
                 self.handle_feat11(data)
             elif rc in bofcodes: ##### EMBEDDED BOF #####
@@ -1387,19 +1406,16 @@

     def handle_obj(self, data):
-        if not OBJ_MSO_DEBUG:
-            return
-        DEBUG = 1
         if self.biff_version < 80:
             return
         o = MSObj()
         data_len = len(data)
         pos = 0
-        if DEBUG:
+        if OBJ_MSO_DEBUG:
             fprintf(self.logfile, "... OBJ record ...\n")
         while pos < data_len:
             ft, cb = unpack('<HH', data[pos:pos+4])
-            if DEBUG:
+            if OBJ_MSO_DEBUG:
                 hex_char_dump(data, pos, cb, base=0, fout=self.logfile)
             if ft == 0x15: # ftCmo ... s/b first
                 assert pos == 0
@@ -1430,16 +1446,14 @@
         else:
             # didn't break out of while loop
             assert pos == data_len
-        if DEBUG:
+        if OBJ_MSO_DEBUG:
             o.dump(self.logfile, header="=== MSOBj ===", footer= " ")
+        return o

     def handle_note(self, data):
-        if not OBJ_MSO_DEBUG:
-            return
-        DEBUG = 1
         if self.biff_version < 80:
             return
-        if DEBUG:
+        if OBJ_MSO_DEBUG:
             fprintf(self.logfile, '... NOTE record ...\n')
             hex_char_dump(data, 0, len(data), base=0, fout=self.logfile)
         o = MSNote()
@@ -1453,13 +1467,11 @@
         o.original_author, endpos = unpack_unicode_update_pos(data, 8, lenlen=2)
         assert endpos == data_len - 1
         o.last_byte = data[-1]
-        if DEBUG:
+        if OBJ_MSO_DEBUG:
             o.dump(self.logfile, header="=== MSNote ===", footer= " ")
+        return o

     def handle_txo(self, data):
-        if not OBJ_MSO_DEBUG:
-            return
-        DEBUG = 1
         if self.biff_version < 80:
             return
         o = MSTxo()
@@ -1477,8 +1489,9 @@
         rc3, data3_len, data3 = self.book.get_record_parts()
         assert rc3 == XL_CONTINUE
         # ignore the formatting runs for the moment
-        if DEBUG:
+        if OBJ_MSO_DEBUG:
             o.dump(self.logfile, header="=== MSTxo ===", footer= " ")
+        return o

     def handle_feat11(self, data):
         if not OBJ_MSO_DEBUG:
@@ -1638,11 +1651,12 @@

 class Cell(BaseObject):

-    __slots__ = ['ctype', 'value', 'xf_index']
+    __slots__ = ['ctype', 'value', 'note', 'xf_index']

-    def __init__(self, ctype, value, xf_index=None):
+    def __init__(self, ctype, value, note=None, xf_index=None):
         self.ctype = ctype
         self.value = value
+        self.note = note
         self.xf_index = xf_index

     def __repr__(self): 
```

然后你可以写这样的东西：

```
import xlrd

xlrd.sheet.OBJ_MSO_DEBUG = True

xls = xlrd.open_workbook('foo.xls')

for sheet in xls.sheets():
    print 'sheet %s (%d x %d)' % (sheet.name, sheet.nrows, sheet.ncols)
    for rownum in xrange(sheet.nrows):
        for cell in sheet.row(rownum):
            print cell, cell.note 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T02:34:15.737

一种选择是使用 Ruby 的 win32ole 库。

以下（有些冗长）示例连接到打开的 Excel 工作表并从单元格 B2 获取注释文本。

```
require 'win32ole'

xl = WIN32OLE.connect('Excel.Application')
ws = xl.ActiveSheet
cell = ws.Range('B2')
comment = cell.Comment
text = comment.Text 
```

可以在此处找到使用 Ruby 的 win32ole 库自动化 Excel 的更多信息和示例：

[http://rubyonwindows.blogspot.com/search/label/excel](http://rubyonwindows.blogspot.com/search/label/excel)

# javascript - JavaScript: changing the value of onclick with or without jQuery

> ID：826628
> 
> 赞同：49
> 
> 时间：2009-05-05T19:51:58.310
> 
> 标签：javascript, jquery, onclick, attributes

I'd like to change the value of the `onclick` attribute on an anchor. I want to set it to a new string that contains JavaScript. (That string is provided to the client-side JavaScript code by the server, and it can contains whatever you can put in the `onclick` attribute in HTML.) Here are a few things I tried:

*   Using jQuery `attr("onclick", js)` doesn't work with both Firefox and IE6/7.
*   Using `setAttribute("onclick", js)` works with Firefox and IE8, but not IE6/7.
*   Using `onclick = function() { return eval(js); }` doesn't work because you are not allowed to use `return` is code passed to `eval()`.

Anyone has a suggestion on to set the onclick attribute to to make this work for Firefox and IE 6/7/8? Also see below the code I used to test this.

```
<html>
    <head>
        <script type="text/javascript"
                src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                var js = "alert('B'); return false;";
                // Set with JQuery: doesn't work
                $("a").attr("onclick", js);
                // Set with setAttribute(): at least works with Firefox
                //document.getElementById("anchor").setAttribute("onclick", js);
            });
        </script>
    </head>
    <body>
        <a href="http://www.google.com/" id="anchor" onclick="alert('A'); return false;">Click</a>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-05-05T20:07:24.340

You shouldn't be using `onClick` any more if you are using jQuery. jQuery provides its own methods of attaching and binding events. See [`.click()`](http://api.jquery.com/click)

```
$(document).ready(function(){
    var js = "alert('B:' + this.id); return false;";
    // create a function from the "js" string
    var newclick = new Function(js);

    // clears onclick then sets click using jQuery
    $("#anchor").attr('onclick', '').click(newclick);
}); 
```

That should cancel the `onClick` function - and keep your "javascript from a string" as well.

The best thing to do would be to remove the `onclick=""` from the `<a>` element in the HTML code and switch to using the [**Unobtrusive**](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript) method of binding an event to click.

You also said:

> Using `onclick = function() { return eval(js); }` doesn't work because you are not allowed to use return in code passed to eval().

No - it won't, but `onclick = eval("(function(){"+js+"})");` will wrap the 'js' variable in a function enclosure. `onclick = new Function(js);` works as well and is a little cleaner to read. (note the capital F) -- see [documentation on `Function()` constructors](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-04T21:18:28.813

BTW, without JQuery this could also be done, but obviously it's pretty ugly as it only considers IE/non-IE:

```
if(isie)
   tmpobject.setAttribute('onclick',(new Function(tmp.nextSibling.getAttributeNode('onclick').value)));
else
   $(tmpobject).attr('onclick',tmp.nextSibling.attributes[0].value); //this even supposes index 
```

Anyway, just so that people have an overall idea of what can be done, as I'm sure many have stumbled upon this annoyance.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T19:56:31.233

One gotcha with Jquery is that the click function do not acknowledge the hand coded onclick from the html.

So, you pretty much have to choose. Set up all your handlers in the init function or all of them in html.

The click event in JQuery is the click function $("myelt").click (function ....).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:12:45.670

just use jQuery bind method !jquery-selector!.bind('event', !fn!);

[See here for more about events in jQuery](http://docs.jquery.com/Events)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-02T13:41:20.600

If you don't want to actually navigate to a new page you can also have your anchor somewhere on the page like this.

```
<a id="the_anchor" href=""> 
```

And then to assign your string of JavaScript to the the onclick of the anchor, put this somewhere else (i.e. the header, later in the body, whatever):

```
<script>
    var js = "alert('I am your string of JavaScript');"; // js is your string of script
    document.getElementById('the_anchor').href = 'javascript:' + js;
</script> 
```

If you have all of this info on the server before sending out the page, then you could also simply place the JavaScript directly in the `href` attribute of the anchor like so:

```
<a href="javascript:alert('I am your script.'); alert('So am I.');">Click me</a> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-04T21:03:09.530

Note that following gnarf's idea you can also do:

```
var js = "alert('B:' + this.id); return false;";<br/>
var newclick = eval("(function(){"+js+"});");<br/>
$("a").get(0).onclick = newclick; 
```

That will set the onclick without triggering the event (had the same problem here and it took me some time to find out).

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-11-02T13:14:00.400

Came up with a quick and dirty fix to this. Just used `<select onchange='this.options[this.selectedIndex].onclick();> <option onclick='alert("hello world")' ></option> </select>`

Hope this helps

# c# - 在 VisualStudio UI 设计器中查看 XAML 文件执行文件隐藏代码？

> ID：826636
> 
> 赞同：2
> 
> 时间：2009-05-05T19:53:48.290
> 
> 标签：c#, wpf

请幽默我，因为我可能疯了。

在 Visual Studio UI 设计器中查看 xaml 是否会执行代码隐藏文件？

过去，每当我尝试查看我的 WPF 应用程序的主 xaml 文件时，它都会引发异常，但因为我一直忙于其他事情，直到今天我才真正研究过它。现在我注意到，在异常的调用堆栈中，它调用了许多代码隐藏的方法，包括像 Window_Loaded (!) 这样的方法。就像它在我设计它时试图运行我的应用程序并且显然失败了。

所以我也想知道为什么会这样。

我也想知道我应该如何调试它，因为它在我背后做这一切。

实际的异常来自这样一个事实，即我的应用程序使用了一个它尝试使用但由于某种原因找不到它的非托管 dll。

[编辑] 我尝试将我的非托管 DLL 移动到 Windows/System32，但我仍然遇到同样的异常。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T20:21:06.837

是的，有些东西（比如构造函数）会在设计时进行评估。如果您的代码在设计器中引发异常，您可以添加以下内容：

```
if (DesignerProperties.GetIsInDesignMode(this))
{
   return;
} 
```

# c# - 如何仅使用原始页面请求在 ASPX 中自动完成？

> ID：826641
> 
> 赞同：0
> 
> 时间：2009-05-05T19:54:37.883
> 
> 标签：c#, asp.net, javascript, jquery, autocomplete

我们正在开发一个 ASPX (.NET 2.0) 页面，其中包含一个选择列表，其中包含太多元素 (200+)。

我们需要某种形式的自动完成功能，以使其成为类似于文本框的东西，但带有自动完成建议。

我们想使用 JQuery。到目前为止，我们的搜索只出现了需要某种后端服务、额外请求（在 AJAX 中）等的自动完成功能。我们更愿意通过页面请求一次提供所有数据。理想情况下，它将作为选择列表条目。

是否有转换选择列表的自动完成框？或者有没有办法将自动完成连接到页面上已经存在的数据（在带有.NET 2.0 的 ASPX 中），这样它就不必访问外部资源？

编辑：回发不是我正在寻找的措辞。我的意思是与原始页面请求一起交付。

编辑 2：页面应该优雅地降级。那里的许多解决方案“注入”内容，因此如果没有 javascript，您将无法获得任何内容。它可能有 200 多种选择，但至少它们会存在。这就是为什么选择列表的转换是我们的理想选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T19:58:17.077

[http://docs.jquery.com/Plugins/Autocomplete/autocomplete#url_or_dataoptions](http://docs.jquery.com/Plugins/Autocomplete/autocomplete#url_or_dataoptions)

jquery autcomplete 插件可以将数据作为一个数组。如果您在 .js 包含文件中构建数组，则应该满足您的要求。

例如，查看[演示页面](http://jquery.bassistance.de/autocomplete/demo/)- 检查“多个城市（本地）”部分，以及那里使用的 localdata.js 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T20:12:51.833

使用Steve Willcock 建议的[jQuery 自动完成插件。](http://docs.jquery.com/Plugins/Autocomplete/autocomplete#url_or_dataoptions)输出一个常规选择框，然后在您的脚本中将其替换为文本框，并使用您构建的数组初始化插件，如果选项元素。因此，您的数据以以下形式出现`select`：

```
<select size="1" id="options" name="options">
  <option>Option #1</option>
  <option>Option #2</option>
  <option>Option #3</option>
  <option>Option #4</option>
  <option>Option #5</option>
  <option>Option #6</option>
  <option>Option #7</option>
</select> 
```

...然后你像这样改变它：

```
$(function(){
  // execute once the DOM is ready...

  // build array of option texts
  var options = [];
  $("#options option").each(function(){
    options.push($(this).text());
  });

  // build an input field, replace the select with it,
  // and wire up autocomplete.
  $("<input id='options' name='options' type='text'>")
    .replaceAll("#options")
    .autocomplete(options, {autoFill: true});  
}); 
```

...没有JS？没问题 - 你仍然有你的`select`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T19:57:27.190

有许多第三方控件（我们使用 ComponentArt 的 WebUI 工具包中的一个）可以为您提供自动完成组合框功能。

您还可以使用 AJAX 技术实现相同的想法，从而避免完全回发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:25:26.357

这里的答案非常有帮助，但是我们在进一步搜索后发现了这个插件，它直接在选择列表上自动工作：

性感组合：[http ://code.google.com/p/sexy-combo/](http://code.google.com/p/sexy-combo/)

演示页面： http: [//phone.witamean.net/sexy-combo/examples/index.html](http://phone.witamean.net/sexy-combo/examples/index.html)

这将需要更少的工作。

我想记录下来以供其他人参考。谢谢大家的帮助。

# asp.net - 如果请求的输入为空，则 Request.Form 的结果

> ID：826651
> 
> 赞同：2
> 
> 时间：2009-05-05T19:56:40.890
> 
> 标签：asp.net, html, vb.net, request.form

当我使用 Request.Form("myInput") 并且输入字段“myInput”为空白时，出现服务器错误。

我该如何处理？

有没有办法检查“myInput”是否没有填写？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T20:10:52.290

如果值是空字符串（如果输入字段为空白，则会发生这种情况），或者该字段甚至不存在，从集合中读取`Request.Form`都不会导致异常。

如果输入字段为空白，则在从集合中读取时会得到一个空字符串，因此要检查它，您只需检查`Length`字符串属性的值是否为零。

如果输入字段不存在，则`Nothing`在从集合中读取时会得到一个空引用（在 VB 中），因此要检查是否将引用与`null`（`is Nothing`在 VB 中使用）进行比较。

要检查这两种情况，您可以使用该`String.IsNullOrEmpty`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T20:15:07.257

你可以尝试类似

```
If IsEmpty(Request.Form("myInput")) Then
    // input is empty, display error
Else
    // input has been filled, continue
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:14:57.473

```
If Request.Form("myInput") IsNot Nothing Then
    Response.Write(Request.Form("myInput").ToString())
End If 
```

将您的代码包装在 If 语句中，以查看您是否从表单返回空值。如果您尝试强制转换 null ToString()，它将引发异常。

# .net - NullReferenceException with ToolTip.CreateHandle

> ID：826652
> 
> 赞同：0
> 
> 时间：2009-05-05T19:56:59.267
> 
> 标签：.net, vb.net, nullreferenceexception, tooltip

We sporadically get errors when we try to update a tool tip, like this

```
ToolTip.SetToolTip(myLabel, customDataStructure) 
```

The error we get is a `NullReferenceException: Object reference not set to an instance of an object`

Does anyone know the cause of this?

Is a simple `Try/Catch` that eats the `NullReferenceException` a feasible option? We don't want our entire application to blow up when we get this.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T20:00:48.320

Try to test whether you're setting that var in any situation, using the debugger for example...

*Is a simple Try/Catch that eats the NullReferenceException a feasible option?*

That wouldn't solve the problem, it would hide it. A bad programming practice.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T20:01:58.863

Ignoring exceptions is rarely if ever a good idea. The exception is thrown because something is wrong in the current implementation. By ignoring the exception the application basically proceeds in an undefined state and you will most likely see other weird effects due to the missing reference.

Since this is sporadic it could be a race condition issue, so you have to look carefully at the code to figure out if there are any situations in which the reference may be used before it is correctly initialized.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T20:08:33.667

我猜您是`ToolTip.SetTooltip`从事件处理程序调用的，并且该处理程序有时会在创建标签之前触发。您可能应该通过检查标签来保护这一点，`null`然后确保在标签`Load`事件上初始化工具提示。

您当然不应该只捕获异常，因为这隐藏了问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-04T02:08:33.027

造成这种情况的最常见原因是当您关闭窗口并发生在不可见控件上设置工具提示的验证时。

我还没有调试到 .Net 代码，但很清楚 ToolTip.CreateHandle 代码中错误所在的位置：

```
private void CreateHandle()
{
    if (this.GetHandleCreated())
    {
        return;
    }
    IntPtr userCookie = UnsafeNativeMethods.ThemingScope.Activate();
    try
    {
        SafeNativeMethods.InitCommonControlsEx(new NativeMethods.INITCOMMONCONTROLSEX
        {
            dwICC = 8
        });
        CreateParams createParams = this.CreateParams;
        if (this.GetHandleCreated())
        {
            return;
        }
        //HERE! I suspect window is null when the form is closed
        this.window.CreateHandle(createParams); 
    }
    finally
    {
        UnsafeNativeMethods.ThemingScope.Deactivate(userCookie);
    }
    if (this.ownerDraw)
    {
        int num = (int)((long)UnsafeNativeMethods.GetWindowLong(new HandleRef(this, this.Handle), -16));
        num &= -8388609;
        UnsafeNativeMethods.SetWindowLong(new HandleRef(this, this.Handle), -16, new HandleRef(null, (IntPtr)num));
    } 
```

解决此问题的条件非常简单，只需在调用 ToolTip 控件的 SetToolTip 方法之前检查表单是否可见或 Benjamin RAIBAUD 提到 Disposing = false 即可：

C＃：

```
if (!this.Disposing) ttpHoverText.SetToolTip(targetControl, brokenText); 
```

VB.Net：

```
If Me.Disposing = False Then ttpHoverText.SetToolTip(targetControl, brokenText) 
```

> IMO这是应该由.Net Framework处理的事情......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-12T13:48:38.340

我刚刚遇到了同样的问题。似乎异常是从 ToolTip.CreateHandle() 方法中引发的，并且它仅发生在被释放的 MDI 子窗口上。在调用 SetToolTip(...) 方法之前，请确保父窗体的 Disposing 属性为 false。无论如何，表单正在被处理，所以你不再关心工具提示了......

# c# - Querying the ASP.NET form object with linq

> ID：826657
> 
> 赞同：2
> 
> 时间：2009-05-05T19:58:22.960
> 
> 标签：c#, asp.net, linq

Is it possible to select all controls that inherit a particular abstract class with linq.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T20:08:08.460

Make use of the [`Enumerable.OfType<T>`](http://msdn.microsoft.com/library/bb360913) extension method:

```
...Form.Controls.OfType<MyControlBase>()... 
```

To perform this recursively see the [other answer](http://#828666): create an iterator that walks the control tree to create a list which you then apply LINQ operators to.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T08:45:33.380

Assuming you have a method which recursively gets all the controls, as follows:

```
public static IEnumerable<Control> GetControls(Control form) {
    foreach (Control childControl in form.Controls) {   // Recurse child controls.
        foreach (Control grandChild in GetControls(childControl)) {
            yield return grandChild;
        }
        yield return childControl;
    }
} 
```

Then you can do:

```
var controls = GetControls(form).OfType<SomeControlBase>(); 
```

# vb.net - 这在.NET中合适吗？

> ID：826660
> 
> 赞同：2
> 
> 时间：2009-05-05T19:58:37.030
> 
> 标签：vb.net

我是 .NET 的初学者。我的首要任务之一是为动态生成的页面动态更改元标记。

所以，我想出了这个，但不太确定在 .NET 中什么被认为是“正确”的方法。

```
<head>
<title><%= title %></title>
<meta name="description" content="<%= MetaDescription %>" />
...
</head> 
```

此功能位于我的母版页代码隐藏中，我在页面初始化中设置了默认标题等（未在下面显示）

```
Protected Title As String = ""

Public Sub ChangeTitle(ByVal title As String)
   Title = title
End Sub 
```

我还在任何产品详细信息页面中调用此函数来设置适当的动态标题。

这在NET中被认为可以吗？这是不好的还是骇人听闻的，或者你会说“如果它有效，那么有效？

* * *

我尝试将 runat="server" 添加到 head 标签中，以使用 Page.title 但一旦添加，此行将`<meta name="description" content="<%= MetaDescription %>" />`被解码为

```
<meta name="description" content="&lt;%= MetaDescription %>" /> 
```

然后我上面的代码无法更改元描述。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T20:02:02.653

如果标头标记为 Runat="Server"，则页面的 Page.Title 属性将自动为您更改标题。

第二个元标记我做同样的事情，因为它有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T20:06:40.910

已经有一个属性：`Page.Title`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T20:30:19.107

添加`runat="server"`到 head 标签以便您可以使用该`Title`属性后，您可以使用类似这样的内容将 meta 标签添加到 head：

```
public static void AddMeta(string name, string content) {
   Page page = (Page)HttpContext.Current.Handler;
   HtmlMeta meta = new HtmlMeta();
   meta.Name = name;
   meta.Content = content;
   page.Header.Controls.Add(meta);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-30T01:11:57.880

你可以使用这个例子：

```
page.title = "your title here"

page.metadescription = "your description here" 
```

# asp.net - Why should underlying membership provider decide whether…?

> ID：826661
> 
> 赞同：2
> 
> 时间：2009-05-05T19:59:04.457
> 
> 标签：asp.net, authentication, asp.net-membership, forms-authentication

A) Why, when using templates with *CreateUserWizard* control, does including *Textbox* with *ID=Email* depend on whether *CreateUserWizard.RequireEmail* property is set to true, but *TextBox* with *ID=Question* is required only if underlying membership provider requires password question? In other words, why wouldn’t it also be up to underlying membership provider to decide whether *Textbox* ( *with ID=email* ) is required?

B) On the other hand, why would be up to membership provider to decide whether password question is required? Shouldn’t this be up to *Membership class* to decide? Afterall, the job of membership provider should just be to provide access to underlying data store, and not to decide what data users must provide?!

thanx

**EDIT:**

A)

> It comes down to the fact that the membership provider has an obvious mapping: RequiresQuestionAndAnswer, which you can set and have this enforced, but you can't specify that the user must supply an email address.

So RequiresUniqueEmail in essence tells that user doesn’t have to specify an email address, but if she does, it must be unique?

B)

*   If I understand membership providers correctly, they are the entities that send SQL queries to data storage?! Thus I assume they have full knowledge of tables and relationships etc this data storage has?

*   But still, what if data storage doesn’t have a column for storing email addresses, but CreateUser() specifies email address as one of its parameters? How does membership provider handle that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T03:59:00.683

有趣的是，电子邮件是预期数据字段的一部分。

让我澄清一下...如果您将 SQL 提供程序的 RequiresUniqueEmail 设置为 true，则不需要电子邮件——严格来说。这只是意味着每个用户都必须使用与任何其他用户不同的电子邮件地址。因此，可以有一个用户没有电子邮件地址。将在数据库中设置一个空值。但是在那之后没有其他用户可以省略电子邮件地址，因为这会导致两个用户的电子邮件为空......所以在功能上它可能与所需的电子邮件地址相同，但在技术上并不相同。

向导控件提供用于收集成员信息的默认 UI，并假定您使用的将使用默认 SQL 提供程序。如果您没有使用默认提供程序，您的提供程序不支持所有字段，或者您的提供程序中有其他独特的约束，那么您应该使用自己的模板自定义向导步骤并处理向导的事件以提供您自己的验证以及适当的附加逻辑。

至于了解会员系统本身...

asp.net 中的 Membership 系统是严格的 OO 设计和便利性之间的折衷。在特定的 MembershipProvider 继承的基础 MembershipProvider 类中有一些假设是自以为是的。事实上，在基本提供商做出的更自由的假设之一中，电子邮件地址将成为会员数据的一部分。

但是，通过做出在大多数环境中都是正确的假设，会员系统能够以简单直观的方式公开与电子邮件地址相关的一些功能（例如通过电子邮件地址而不是用户名获取用户并禁止多个帐户使用相同的电子邮件地址）。如果基类没有做出这样的假设，那么每次您想在特定提供商中处理电子邮件时，您都必须将引用转换为您在应用程序中使用的特定类型。这很麻烦。

从纯粹的面向对象的角度来看，这些假设是不舒服的。但是，如果基类中的方法和属性不使用它们，您可以（并且许多成员资格提供者也这样做）为它们提供空实现。

您会在角色提供程序中看到更多这一点……例如，Windows 令牌角色提供程序有很多抛出 NotImplmentedException 的成员（令牌角色提供程序是 AD 的只读提供程序，因此所有属性集访问器都会抛出异常）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T22:39:35.537

归结为会员提供者有一个明显的映射：[RequiresQuestionAndAnswer](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.requiresquestionandanswer.aspx)，您可以设置并强制执行此操作，但您不能指定用户**必须**提供电子邮件地址。

指定他们必须使用[RequiresUniqueEmail](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.requiresuniqueemail.aspx)提供唯一的电子邮件地址与说“需要电子邮件”不同 - 因此 CreateUserWizard 为您提供了“我不在乎电子邮件地址不是唯一的，只是这样”的选项有一个”。

至于为什么会员资格提供者应该控制是否需要提问：这是因为提供者还控制着诸如 EnablePasswordReset 和 EnablePasswordRetrieval 之类的东西——这些是会员类不知道的东西——事实上，即使会员类有一个“ [ValidateUser](http://msdn.microsoft.com/en-us/library/system.web.security.membership.validateuser.aspx) " 方法，它将使用 web.config 中指定的默认提供程序来执行此操作：

> Membership 类依赖于成员提供者与数据源进行通信。

* * *

针对问题编辑：

一个。这是正确的，正如[斯蒂芬指出的那样](https://stackoverflow.com/questions/826661/why-should-underlying-membership-provider-decide-whether/827954#827954)，您可以让一个用户的电子邮件地址为空，然后所有其他用户都必须有一个值。根据您的验证器，这实际上不一定是有效的电子邮件地址。

b.1。不完全 - 提供程序向您的用户数据存储发送数据和从您的用户数据存储发送数据 - 这可能是 SQL，但也可能是 Active Directory、LDAP、文本文件等，但是是的，您的提供程序充当您的应用程序和您的用户存储。

b.2\. 会员资格有很多部分 - 有关[实施自定义会员资格用户](http://msdn.microsoft.com/en-us/library/ms366730.aspx)的文档将引导您完成创建自定义用户所需的步骤 - 如果您的数据存储未处理电子邮件地址（或者您希望将多封电子邮件存储在配置文件中），那么您的提供者可以忽略在创建或更新时发送给您的任何值，并在获取时使用 null 填充它。

# php - why does drupal append ?1 to my css file links

> ID：826663
> 
> 赞同：2
> 
> 时间：2009-05-05T19:59:51.613
> 
> 标签：php, drupal

My designer noticed that in the source for a drupal site, all the .css files were getting appended a ?1 that he was concerned would break things. Why is it doing this?

```
<link type="text/css" rel="stylesheet" media="all" href="/modules/modules/node/node.css?l" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/modules/system/defaults.css?l" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/modules/system/system.css?l" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/modules/system/system-menus.css?l" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/modules/user/user.css?l" /> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-05T20:01:22.873

I poked around in the source code for drupal and found this:

```
// A dummy query-string is added to filenames, to gain control over
// browser-caching. The string changes on every update or full cache
// flush, forcing browsers to load a new copy of the files, as the
// URL changed.
$query_string = '?'. substr(variable_get('css_js_query_string', '0'), 0, 1); 
```

I guess that answers that. I'm going to assume since the drupal guys are doing this that browsers are cool with query strings in css link tags, even though my designer was paranoid over it.

Hopefully this helps somebody one Google on day =p

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T20:09:14.727

以下博客文章也解释了这种做法：[mod_expires 和 Cache Killers](http://blog.cherouvim.com/mod_expires-and-cache-killers/)

# c# - Forms control that allows zoom, pan AND POI

> ID：826664
> 
> 赞同：5
> 
> 时间：2009-05-05T19:59:59.883
> 
> 标签：c#, winforms, zooming, pan, point-of-interest

For my phD project I need to do microscopy imaging. I cooked up an application using C#/winforms/GDI that allows me to display my images, zoom/pan them and display a ruler.

However, the thing is quite buggy, although usable...

What I need now is some kind of system to store a list of POIs (points of interest) based on user interaction.

These points can be used to center the image on them/direct the imaging hardware to them etc...

I have no clue how to go about this in the most efficient way. There is at least one commercial control that pretty much does what I want but it is very expensive, not open source and intended for use on web forms.:

[Example Zoomcontrol](http://samples.dart.com/PowerWEB_Zoom_POI_CSharp/Webform1.aspx)

Who can help... deadlines are looming... :s

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-06-10T05:55:11.317

您可以在您的 winform 中使用网络浏览器并尝试使用 jquery 进行放大。请参阅网站[http://plugins.jquery.com/project/imageZoom](http://plugins.jquery.com/project/imageZoom)

# ms-access - Ms-Access MDB：将备注字段拆分为多个文本字段。（为防止数据损坏）

> ID：826668
> 
> 赞同：3
> 
> 时间：2009-05-05T20:00:32.783
> 
> 标签：ms-access, database-design, corruption

我使用一个 Access 数据库，用作后端。
我使用了一些备忘录字段。

我了解到备注字段会导致数据库损坏，因为它们存储在单独的数据页中；该记录仅包含指向存储实际数据的数据页的指针。

大多数时候我只需要 100 到 1000 个字符左右，所以我有一个想法……
我的“绝妙”（或不）想法是将备忘录分成 4 或 5 个文本字段（每个可以容纳 255 个字符）。

以前有人做过吗？
有任何已知问题吗？
这种方法是否不太容易出现数据损坏？

谢谢，
贾格

PS
1\. 我以前有过腐败问题。
2\. 我知道最好的办法是迁移到另一个后端，但这是不可能的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-06T01:02:17.813

更好的解决方法是将备忘录数据页与其附加记录分开。这样做的方法是将备注字段放在单独的表中。您可以使用 1:1 表（在边表中有多个备忘录），或者更好的是，作为具有备忘录类型字段的 1:N 表。后一种方法是完全避免备忘录指针问题的唯一方法，但是，与前一种解决方案一样，备忘录表中任何备忘录指针的损坏都会导致您丢失所有它们。

此外，您应该考虑*为什么*您的数据库会损坏备忘录指针。除了上面的建议之外，您可能应该考虑编辑未绑定的备忘录，尽管您似乎没有使用 Jet MDB 的 Access 前端，这可能不是问题。我时不时地看到备忘录损坏，但不是很常见。如果您经常看到它，这表明您的应用程序设计不良或您的操作环境明显不合标准。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T19:18:18.880

听起来您想在将现有的备忘录字段放入数据库之前将其切碎，然后在需要显示时将其粘合在一起。

我认为如果您尝试这样做，您将陷入痛苦的世界。如果这是您唯一的选择，我会更加努力地更改后端:)

我将通过建议做你建议的事情来建立 DWF 的答案。制作一个带有文本字段的 1:N 表（我称之为 UserNotes）（与您似乎遇到问题的备忘录相比）。

然后创建一个以 UserNotes 作为记录源的子表单，并将备注字段替换为 UserNotes 子表单。这让用户可以决定在 255 个字符的文本字段的上下文中的换行符/分段符的位置。（对于转换，您仍然需要将备忘录切碎，但这只是一次操作）

# java - Trouble calling an applet method from page

> ID：826669
> 
> 赞同：1
> 
> 时间：2009-05-05T20:00:46.277
> 
> 标签：java, javascript, gwt, applet

I know it's not optimal, but I have to work with it, a page making calls to the applet.

My problem is, when I do so, I recieve a rather cryptic error message:

*"uncaught exception: Error calling method on NPObject!*

*[plugin exception: java.lang.reflect.InvocationTargetException]."*

Can anyone decode this? Even multiple possibilities would be better than the junk I came up with. The basic call to the applet is from a javascript call:

```
document.getElementById('my_applet').passData("pass some data", someOtherData); 
```

As you can see, the passData method is the exposed method I am trying to use. The applet itself works fine on the page, it's just when I try to call this, it doesn't do anything except throw that error.

If I ask the person working on the applet (it's not my portion) is it possible for them to add constructive error throwing or am I not even at the point of connecting to the applet yet?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T20:24:07.220

[InvocationTargetException](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/reflect/InvocationTargetException.html)表示您的小程序中的底层方法引发了异常。Javascript 到 Java 的“边界”使用反射，因此 Java 代码抛出的异常被包装成这样。（这可以将它们与在您进入 Java 代码之前抛出的异常区分开来。例如，如果您尝试调用不存在的方法。）

您可以通过捕获 InvocationTargetException 然后调用它的`getTargetException()`or`getCause()`方法来获取原始异常（它们都做完全相同的事情）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T11:45:21.320

我建议你看看*someOtherData*是什么。如果*someOtherData*不是正确的类型，则可能会导致此类异常。听起来您正在尝试传递 DOM 对象？

[查看O'Reilly 的 JavaScript 指南](http://docstore.mik.ua/orelly/webprog/jscript/ch22_04.htm)中的此页面以查看可用的类型。

# asp.net - Why need WizardStep objects be represented as …?

> ID：826671
> 
> 赞同：1
> 
> 时间：2009-05-05T20:00:57.337
> 
> 标签：asp.net, authentication, asp.net-membership, forms-authentication

This is probably a stupid question, but still..

A *Wizard* control is made up of a collection of *WizardStep* objects that represent single steps of a wizard. But why are these W*izardStep* object represented as controls ( thus they require *runat=Server* attribute )?Couldn’t they be handled similarly to *ListItem* objects, which don’t require *runat* attribute, but are instead accessed via *Parent_Control.Item* property?

thanx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T20:35:31.420

WizardStep 控件可以是其他控件的容器，这使得它们变得不平凡。而 ListItems 只是由字符串和 ID 组成的简单对象，仅此而已。

# target - Castle DynamicProxy2: Get the Target inside an Interceptor?

> ID：826673
> 
> 赞同：2
> 
> 时间：2009-05-05T20:01:05.060
> 
> 标签：target, castle-dynamicproxy, iinterceptor

I'm using Castle DynamicProxy2 to "tack on" interfaces to retrieve fields from a dictionary. For example, given the following class:

```
public class DataContainer : IDataContainer
{
    private Dictionary<string, object> _Fields = null;

    public Dictionary<string, object> Data
    {
        get { return _Fields ?? (_Fields = new Dictionary<string, object>()); }
    }
} 
```

I want to use the following interface as an interface proxy to extract the "Name" value out of the Fields dictionary:

```
public interface IContrivedExample
{
    string Name { get; }
} 
```

From an interceptor, I want to get the "target" DataContainer, and return the "Name" value:

```
public void Intercept(IInvocation invocation)
{
    object fieldName = omitted; // get field name based on invocation information

    DataContainer container = ???; // this is what I'm trying to figure out
    invocation.ReturnValue = container.Fields[fieldName];
}

// Somewhere in code
var c = new DataContainer();
c.Fields.Add("Name", "Jordan");

var pg = new ProxyGenerator();
IContrivedExample ice = (IContrivedExample) pg.CreateInterfaceProxyWithTarget(..., c, ...);
Debug.Assert(ice.Name == "Jordan"); 
```

Any thoughts on how to get the underlying target

Note: this is a contrived example I'm using to establish some context around the question I have.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T20:12:22.567

我想到了。您必须将代理转换为 IProxyTargetAccessor：

```
public void Intercept(IInvocation invocation)
{
    object fieldName = omitted; // get field name based on invocation information

    var accessor = invocation.Proxy as IProxyTargetAccessor;

    DataContainer container = (DataContainer) accessor.DynProxyGetTarget();
    invocation.ReturnValue = container.Fields[fieldName];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T10:45:57.487

为什么麻烦？

利用

```
var container = invocation.InvocationTarget as DataContainer; 
```

顺便说一句，IIUC，您正在尝试实现[Castle DictionaryAdapter](https://github.com/castleproject/Core/blob/master/docs/dictionaryadapter.md)已经提供的功能。为什么不使用已经存在的东西？

# asp.net-mvc - ASP.NET MVC 文本框 HtmlHelper 的 NullReferenceException 问题

> ID：826684
> 
> 赞同：8
> 
> 时间：2009-05-05T20:04:02.057
> 
> 标签：asp.net-mvc

我的应用程序的强类型视图中有以下代码：

```
<td>
<label for="TriageStartDate">Triage Start:</label>
<%= Html.TextBox("TriageStartDate", crit.TriageStartDate, new { maxlength = 10, size = 12 } )%>
<%= Html.ValidationMessage("TriageStartDate", "*") %>
</td> 
```

变量*crit*在 ViewData 中传递，并使用以下方法转换为视图中的强类型对象：

```
 PatientSearchCriteria crit = (PatientSearchCriteria)ViewData["criteria"]; 
```

属性 TriageStartDate 是在对象上定义的字符串属性，如下所示：

```
public string TriageStartDate { get; set; } 
```

我在业务对象中有一个验证例程，用于检查此属性的无效日期。在我的控制器中调用验证例程，在控制器中，当发现无效日期（例如“4/34/2009”）时，我将 ModelError 添加到 ModelState。这应该会导致视图被重新显示，并且验证摘要和消息也被显示。

但是，代码在 Html.TextBox 行上崩溃并出现未处理的 NullReferenceException。代码*仅*在输入无效日期时崩溃，这可能无关紧要，因为属性无论如何都是字符串，它应该只在文本框中显示无效日期。

有什么想法可能发生在这里吗？我认为这可能是 Html.Encode 的事情，但有效日期显示没有大惊小怪。当我在调试模式下中断该行时，我可以在 TriageStartDate 属性中看到值“4/34/2009”，并且 crit 变量本身不为空，所以我想知道什么对象为空？

顺便说一句，堆栈跟踪的前几行如下所示：

```
[NullReferenceException: Object reference not set to an instance of an object.]
   System.Web.Mvc.HtmlHelper.GetModelStateValue(String key, Type destinationType) +63
   System.Web.Mvc.Html.InputExtensions.InputHelper(HtmlHelper htmlHelper, InputType inputType, String name, Object value, Boolean useViewData, Boolean isChecked, Boolean setId, Boolean isExplicitValue, IDictionary`2 htmlAttributes) +519
   System.Web.Mvc.Html.InputExtensions.TextBox(HtmlHelper htmlHelper, String name, Object value, IDictionary`2 htmlAttributes) +34
   System.Web.Mvc.Html.InputExtensions.TextBox(HtmlHelper htmlHelper, String name, Object value, Object htmlAttributes) +62 
```

这是我的验证代码（可能不太漂亮）。在业务对象中：

```
public override IEnumerable<ValidationError> GetValidationErrors()
{
    // check for valid start date
    if (!String.IsNullOrEmpty(TriageStartDate))
    {
        DateTime critStartDate;
        if (!DateTime.TryParse(TriageStartDate, out critStartDate))
            yield return new ValidationError(String.Format("Invalid triage start date specified: {0}", TriageStartDate), "TriageStartDate");
    }

    // check for valid end date
    if (!String.IsNullOrEmpty(TriageEndDate))
    {
        DateTime critEndDate;
        if (!DateTime.TryParse(TriageEndDate, out critEndDate))
            yield return new ValidationError(String.Format("Invalid triage end date specified: {0}", TriageEndDate), "TriageEndDate");
    }

    // verify that end date follows start date if both are specified
    if (!String.IsNullOrEmpty(TriageStartDate) && !String.IsNullOrEmpty(TriageEndDate))
    {
        DateTime startDate;
        DateTime endDate;

        if (DateTime.TryParse(TriageStartDate, out startDate) && DateTime.TryParse(TriageEndDate, out endDate))
        {
            if (startDate > endDate)
                yield return new ValidationError("Triage start date must be before end date", "_FORM");
        }
    }

    yield break;
} 
```

在控制器中：

```
 // validate search criteria
    if (!criteria.IsValid)
    {
        foreach (ValidationError ve in criteria.GetValidationErrors())
        {
            ModelState.AddModelError(ve.PropertyName, ve.ErrorMessage);
        }
    } 
```

感谢您提供任何线索！

* * *

感谢克雷格的建议，我更新了控制器代码如下，空引用异常消失了。该解决方案有效，但我不确定我是否理解基本原理，因为用户尝试输入的值已经存储在模型对象中，并且我在项目中有其他视图和控制器以相同的方式显示验证错误而没有任何问题。但是，嘿，如果它有效...

```
 // validate search criteria
    if (!criteria.IsValid)
    {
        foreach (ValidationError ve in criteria.GetValidationErrors())
        {
            ModelState.AddModelError(ve.PropertyName, ve.ErrorMessage);
            ModelState.SetModelValue(ve.PropertyName, form.ToValueProvider()[ve.PropertyName]);
        }

    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T21:50:47.463

调用 AddModelError 后，您需要调用[SetModelValue](http://forums.asp.net/p/1377232/2907337.aspx#2907337)。那应该修复空引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T22:01:13.860

当我输入一个几乎相同的问题/问题时，我遇到了这个问题。（即，当用户的值在特定字段上验证失败时，呈现我的视图会导致抛出一个神秘的 NullReferenceException。

我发现的另一种解决方法是在视图中显式生成 Html，而不是让 HtmlHelper 完成工作。

例如 : `<%= Html.TextArea("FieldName", Model.FieldName) %>`会抛出异常，但 `<textarea id="FieldName" name="FieldName"><%= Model.FieldName ></textarea>`可以正常工作。

感谢您发布原始问题，因为现在我必须对 SetModelValue 做更多的研究，看看这两种方法中哪一种是更好的解决方案......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-21T10:57:18.360

我发现一个链接有助于解释这个 [http://forums.asp.net/t/1380609.aspx](http://forums.asp.net/t/1380609.aspx)

# c# - 如果您调用 EventWaitHandle.Set() X 次，如果 X 个线程尚未启动，它会向 X 个线程发出信号吗？

> ID：826688
> 
> 赞同：5
> 
> 时间：2009-05-05T20:05:01.460
> 
> 标签：c#, multithreading

换句话说，我有一个启动并`waitHandle.Set()`多次调用的线程。然后我启动了几个线程，每个线程都在等待`WaitHandle`。是否会在其中 X 是原始线程调用的次数时向其中的 X 发出信号`waitHandle.Set()`？

是否有一种结构可以支持我更紧密地尝试完成的工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-05T20:11:07.470

也许，但可能不是。

一个事件只能设置或取消设置，如果没有什么可以取消设置事件，那么重复调用 Set 不会改变它的状态，除非它是一个自动重置事件并且至少有一个线程在等待它。通过手动重置事件，任何等待（或开始等待）的线程都将被释放，直到某些事件取消设置。

我认为您实际上会想要一个信号量，它确实有一个计数并支持设置*n*次以释放*n 个*线程（即使其中一些线程仅在某些调用 set 后才开始等待）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T20:09:58.983

这取决于`EventResetMode`. 如果设置为`EventResetMode.AutoReset`它只会释放一个线程。如果它是“EventResetMode.ManualReset”，那么它将释放事件中阻塞的所有线程。

```
Semaphore.Release(Int) 
```

其中 Int 是计数将是执行此操作的**一种**方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T20:30:18.263

正如 Richard 所说，Eve​​ntWaitHandles 只有一个标志，无法计算调用 Set 的次数。添加计数变量的简单解决方案会导致竞争条件。

William Kempf has an [article](http://wekempf.spaces.live.com/blog/cns!D18C3EC06EA971CF!672.entry?wa=wsignin1.0&sa=372016599) on why count variables don't work, and a solution using the .Net Monitor class.

# ruby - How to consume JSON formatting with ruby's ActiveResource?

> ID：826691
> 
> 赞同：13
> 
> 时间：2009-05-05T20:06:03.283
> 
> 标签：ruby, json, rest, activeresource

ActiveRecord introduced a change to its default JSON output format. It went from

```
{ "user": { some_junk } } 
```

to

```
{ some_junk } 
```

ActiveResource has apparently followed their lead, expecting to consume JSON as

```
{ some_junk } 
```

I am trying desperately to consume a RESTful web service which emits

```
{ "user": { some_junk } } 
```

Is there a way to tell my ActiveResource::Base class to do so? Here's my code.

```
class User < ActiveResource::Base
    self.site = "http://example.com/"
    self.format = :json
end 
```

**Update**: I'm giving up on ActiveResource as broken for now, unless someone knows the answer; in the meantime, I was able to achieve the GET that I wanted via

```
require 'httparty' # sudo gem install httparty
result = HTTParty.get('http://foo.com/bar.json', headers => { "Foo" => "Bar"})
# result is a hash created from the JSON -- sweet! 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T12:49:13.447

是的，ActiveResource 目前在数据格式方面有点不灵活。

`JsonWithRootFormat`原则上，这个想法是您可以基于该模块为自己编写一个自定义格式模块（例如），[`ActiveResource::Formats::JsonFormat`](http://github.com/rails/rails/blob/4f291fa528e5faad03def69ae7ac98224ab859db/activeresource/lib/active_resource/formats/json_format.rb)然后将其指定为您的模型中的格式：

```
self.format = :json_with_root 
```

但是，`ActiveResource::Base`它不是非常与格式无关——它当前[会检查](http://github.com/rails/rails/blob/4f291fa528e5faad03def69ae7ac98224ab859db/activeresource/lib/active_resource/base.rb#L905)您是否正在使用`XmlFormat`，并且仅在您使用时才通过根节点。

*所以你可以通过制作自己的格式模块和*猴子补丁来获得你想要的东西`ActiveResource::Base`，但这并不理想。不过，我敢肯定，`Base`会欢迎使用与格式无关的补丁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-23T17:58:32.353

[这是@vaskas](http://twitter.com/vaskas)的一篇很好的博客文章，解释了如何编写自己的自定义 ActiveResource Formatter。

使用哈希作为 ActiveResource 集合

[http://vaskas.me/blog/2012/02/07/using-hashes-as-activeresource-collections/](http://vaskas.me/blog/2012/02/07/using-hashes-as-activeresource-collections/)

# vb.net - Linq，VB 的排他集语法

> ID：826695
> 
> 赞同：1
> 
> 时间：2009-05-05T20:07:21.020
> 
> 标签：vb.net, linq, dataset, set

我想根据标准对集合进行减法。伪查询如下所示：

```
select table1.columnn1
      ,table1.column2
  from table1, table2
 where (table1.column1.value1 not in table2.column1
        and
        table1.column2.value2 not in table2.column2) 
```

我可以做到这里：

```
dim list = From tbl1 In table1 Where tt.column1 ... 
```

从那里我不知道该怎么办。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T08:51:13.460

看看`Except`LINQ 中的标准查询运算符。这产生了两个序列的集合差。

[http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx)

根据以下示例，您还可以使用`Contains`运算符来实现您想要的：

```
dim table2Col1 = from t in table2 select t.column1
dim table2Col2 = from t in table2 select t.column2

dim results = _
   from t in table1 _
   where not table2Col1.Contains(t.column1) _
   and  not table2Col2.Contains(t.column2) _
   select new with { .column1=t.column1, .column2=t.column2 } 
```

# c++ - 如何使 NUnit 断言失败显示 C++ 的行号？

> ID：826698
> 
> 赞同：0
> 
> 时间：2009-05-05T20:07:29.753
> 
> 标签：c++, nunit

当我对我的 C++ 代码运行 NUnit 测试并且断言失败时，我没有得到失败发生位置的行号。

样品方法：

```
[Test]
void testMethod()
{
    Assert::Fail("test comment");
} 
```

样本输出：

> [nunit2] 失败：
> 
> [nunit2] 1) namespace.SomeTest.testMethod: 测试注释
> 
> [nunit2] 在命名空间.SomeTest.testMethod()

任何断言失败都会生成类似的输出（也没有行号）。

查看我的输出时，如何获取导致失败的行的行号信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T20:26:40.550

仔细检查您是否正在使用调试信息 (PDB) 构建类。

Assert 框架基本上会在断言失败并且异常捕获 StackTrace 时抛出异常。堆栈跟踪从与可执行文件关联的 PDB 文件中获取它的行号。

# asp.net-mvc - POST 和 MVC 的多个参数

> ID：826704
> 
> 赞同：1
> 
> 时间：2009-05-05T20:08:50.563
> 
> 标签：asp.net-mvc, post, jquery

行。所以我在一个页面上有两个元素，它们不在一个表单中。我需要将这些通过 JQuery.Ajax() 方法发回我的控制器。现在我遇到的问题是，虽然我的参数确实正确发布，但只有当我将它们设置为字符串并且它们在值中包含参数名称时才会这样做。所以：

```
Public ActionResult Method(String Age1, String Age2)
{
    Age1=23; Age2=43
} 
```

我明白了

```
Public ActionResult Method(String Age1, String Age2)
{
  Age1="Age1=23"; Age2="Age2=43"
} 
```

这很烦人。有什么方法可以确保 MVC 正确映射参数并且只接受正确的值？我真的希望它这样做：

```
Public ActionResult Method(Int32 Age1, Int32 Age2)
{
  Age1="Age1=23"; Age2="Age2=43"
} 
```

jQuery 调用：

```
$.ajax{(

//other stuff
data: { Age1: $('.id').val(), Age2: $('.id2').val() };
)}; 
```

哎呀，这是因为在我的实际代码中我使用的是序列化！呃！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T20:31:21.990

老实说，如果您实际上是通过 $.ajax 传递数字 23 和 43，而不是“Age1=23”和“Age2=43”，我真的看不出你在做什么。如果你是， int 肯定不会工作，因为框架不能将这些字符串转换为整数。

将您的 ajax() 调用更改为此可能是值得的，只是为了看看会发生什么。

```
data: { 
    Age1: parseInt($('.id').val()),
    Age2: parseInt($('.id2').val())
} 
```

# css - 使用 Javascript/CSS 设置 IE“光学缩放”功能

> ID：826708
> 
> 赞同：2
> 
> 时间：2009-05-05T20:09:41.263
> 
> 标签：css, internet-explorer, accessibility, font-size

我正在维护的网站的设计非常严格，使用像素来表示字体大小、尺寸、绝对定位等。

现在有一个功能请求添加用户调整字体大小。虽然我知道如果不使用相对尺寸从头开始重新设计站点是不可能的，但我发现该站点与 IE7/IE8 缩放功能 (Ctrl + & Ctrl -) 配合得非常好。

问题是，有没有一种方法可以“建议”IE 以默认缩放级别（例如 125%）打开该站点，而无需用户自己进行缩放？

该站点仅用于 IE 7+。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T20:18:43.003

如果这是您的用户选择，请将其留给他们的浏览器最成熟的浏览器我们可以放大他们的页面渲染（IE 7&8、Opera、FireFox、Chrome 2.0、Safari？）。除了取决于您的用户来自哪个系统（屏幕分辨率）之外，这将决定他们的缩放选择。不幸的是，每个浏览器处理记住您的缩放设置略有不同，例如 chrome 记住每个站点，而 ie 是每个新选项卡/窗口的全局设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T12:48:30.440

如果你真的想做你想做的事，我当然**不**推荐，试试这样的：

```
$(function(){
    var ratio = 1;
    $(document.body).css("zoom", 1.25); // zoom the page on DOMReady

    // bring back a 'normalized' behavior keyevent zooming
    $(document).keydown(function(e){
        if(e.ctrlKey && {187:1, 189:1, 96:1}[e.which]) {
            switch(e.which){
                case 187: // ctrl +
                    ratio += 0.25;
                    break;

                case 189: // ctrl -
                    ratio -= 0.25;
                    break;

                case 96: // ctrl 0
                    ratio = 1;
            }

            $(this.body).css("zoom", ratio);

            e.preventDefault();
        }
    });
}); 
```

# scheme - 我如何从 SICP 调用方案编号函数

> ID：826712
> 
> 赞同：1
> 
> 时间：2009-05-05T20:10:33.570
> 
> 标签：scheme, sicp

在 SICP 中，（ex 2.6）以下功能被描述为“无数字生活”的方式。我正在努力理解这一点。作为起点，如何调用这些函数？我真的可以以某种方式应用它们，输出为 1 吗？（或任何其他数字？）

```
(define zero (lambda (f) (lambda (x) x)))

(define (add-1 n)
  (lambda (f) (lambda (x) (f ((n f) x))))) 
```

我最初的尝试没有成功：

```
Welcome to DrScheme, version 4.1.5 [3m].
Language: Simply Scheme; memory limit: 128 megabytes.
> (add-1 (zero))
. . procedure zero: expects 1 argument, given 0
> (add-1 zero)
#<procedure>
> (add-1 1)
#<procedure>
> ((add-1 1))
. . #<procedure>: expects 1 argument, given 0
> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T20:53:03.157

这些表示数字的函数称为*Church 数字*（如 SICP 所述）。它们的存在意味着您可以定义一个计算系统（例如 lambda 演算），而无需将数字作为一等对象——您可以将函数用作原始对象。这个事实主要是理论上的兴趣；教堂数字不是实际计算的好选择。

您可以通过将它们与其他对象一起应用作为参数来查看您对 Church 数字的定义的正确性。当您将表示 n 的 Church 数字应用于函数 f 时，您会得到另一个函数，该函数将 f 应用于其参数 n 次，例如，对于 n=3，f(f(f(x)))。

```
> (define (double x) (* 2 x))
> (zero double)
#<procedure>
> ((zero double) 1)
1
> ((zero double) 100)
100
> (define one (add-1 zero))
> ((one double) 1)
2
> ((one double) 100)
200
> (define (cons-a x) (cons 'a x))
> ((zero cons-a) '())
()
> (((add-1 one) cons-a) '(1 2 3))
(a a 1 2 3) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T20:52:33.000

这是原始的*lambda 演算*，它不产生数字，它完全用函数替换了数字类型。

所以，你有一个“零”函数，如果你调用`add-1`它，你不会得到 1，你会得到另一个代表 1 的函数。关键是产生的函数符合基本的算术公理，所以它们是等价于自然数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T10:32:43.580

```
(define (as-primitive-num church-num)
    (define (inc a) (+ a 1))
    ((church-num inc) 0))

;testing:
(define one (add-1 zero))
(define two (add-1 one))

(display (as-primitive-num one)) (newline)
(display (as-primitive-num two)) (newline) 
```

和输出：

```
    1
    2

```

# git - 如何管理与 git 子模块的冲突？

> ID：826715
> 
> 赞同：165
> 
> 时间：2009-05-05T20:11:34.097
> 
> 标签：git, branch, git-submodules, conflict

我有一个 git 超级项目，它引用了几个子模块，我试图锁定一个工作流程，让我的项目成员在其中工作。

对于这个问题，假设我的超级项目被调用`supery`并且子模块被调用`subby`。（然后是我正在尝试做的事情的简化......我实际上并没有将分支用于版本，但我认为最容易提出问题。）

我的 master 分支将 git 项目`supery`的标签作为子模块引用。的分支调用并将子模块的引用更改为指向 的标签。`v1.0``subby``supery``one.one``v1.1``subby`

我可以毫不费力地在这些分支中的每一个中工作，但是如果我尝试`one.one`使用来自分支的更改来更新分支，`master`我会收到一些冲突并且我不知道如何解决它们。

基本上在分支中运行一段`git pull . master`时间后`subby`，它看起来像是创建了额外的子模块。

在拉/合并之前，我`git submodule`从`one.one`分支获得了所需的响应：

```
$ git checkout master
$ git submodule
qw3rty...321e subby (v1.0)
$ git checkout one.one
$ git submodule
asdfgh...456d subby (v1.1) 
```

但是在拉取之后，它会在我运行时添加额外的子模块`git submodule`：

```
$ git pull . master
Auto-merged schema
CONFLICT (submodule): Merge conflict in subby - needs qu3rty...321e
Automatic merge failed; fix conflicts and then commit the results.

$ git submodule
qw3rty...321e subby (v1.0)
asdfgh...456d subby (v1.1)
zxcvbn...7890 subby (v1.1~1) 
```

如何删除/忽略不需要的子模块引用并提交我的冲突和更改？或者是否有一个参数可以与我的原始参数一起使用，`git pull`它会忽略我的子模块？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-05-07T15:33:52.750

Well, its not technically managing conflicts with submodules (ie: keep this but not that), but I found a way to continue working...and all I had to do was pay attention to my `git status` output and reset the submodules:

```
git reset HEAD subby
git commit 
```

That would reset the submodule to the pre-pull commit. Which in this case is exactly what I wanted. And in other cases where I need the changes applied to the submodule, I'll handle those with the standard submodule workflows (checkout master, pull down the desired tag, etc).

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2015-09-15T08:59:07.337

I struggled a bit with the answers on this question and didn't have much luck with the answers in [a similar SO post](https://stackoverflow.com/questions/6700093/what-causes-submodule-conficts-in-git-and-how-should-they-be-resolved) either. So this is what worked for me - bearing in mind that in my case, the submodule was maintained by a different team, so the conflict came from different submodule versions in master and my local branch of the project I was working on:

1.  Run `git status` - make a note of the submodule folder with conflicts
2.  Reset the submodule to the version that was last committed in the current branch:

    `git reset HEAD path/to/submodule`

3.  At this point, you have a conflict-free version of your submodule which you can now update to the latest version in the submodule's repository:

    ```
    cd path/to/submodule
    git submodule foreach git pull origin SUBMODULE-BRANCH-NAME
    ```

4.  And now you can `commit` that and get back to work.

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-05-07T17:33:16.037

I have not seen that exact error before. But I have a guess about the trouble you are encountering. It looks like because the `master` and `one.one` branches of `supery` contain different refs for the `subby` submodule, when you merge changes from `master` git does not know which ref - `v1.0` or `v1.1` - should be kept and tracked by the `one.one` branch of `supery`.

If that is the case, then you need to select the ref that you want and commit that change to resolve the conflict. Which is exactly what you are doing with the *reset* command.

This is a tricky aspect of tracking different versions of a submodule in different branches of your project. But the submodule ref is just like any other component of your project. If the two different branches continue to track the same respective submodule refs after successive merges, then git should be able to work out the pattern without raising merge conflicts in future merges. On the other hand you if switch submodule refs frequently you may have to put up with a lot of conflict resolving.

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2017-05-01T13:35:41.617

I had this problem with `git rebase -i origin/master` to a branch. I wanted to take master's version of the submodule ref, so I simply did:

`git reset master path/to/submodule`

and then

`git rebase --continue`

That solved the problem for me.

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2013-01-09T02:01:29.713

First, find the hash you want to your submodule to reference. then run

```
~/supery/subby $ git co hashpointerhere
~/supery/subby $ cd ../
~/supery $ git add subby
~/supery $ git commit -m 'updated subby reference' 
```

that has worked for me to get my submodule to the correct hash reference and continue on with my work without getting any further conflicts.

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-08-29T09:20:13.833

Got help from this discussion. In my case the

```
git reset HEAD subby
git commit 
```

worked for me :)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-01-16T08:25:59.653

Well In my parent directory I see:

```
$ git status
On branch master
Your branch is up-to-date with 'origin/master'.
Unmerged paths:
(use "git reset HEAD <file>..." to unstage)
(use "git add <file>..." to mark resolution) 
```

So I just did this

```
git reset HEAD linux 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-10-11T18:10:40.647

All the above didn't work for me... I had the submodule under "unmerged path" and I was stuck...

Eventually after many many attempts what worked was: deleting manually the merge conflicts file from the sub-module than in main repo:

> ```
> git restore --staged submodule_path 
> ```

(this moved it to "Changes not staged for commit:")

> ```
>  git clean -df 
> ```

then

> git submodule update --init

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-09-16T15:18:20.040

If you want to use the upstream version:

```
rm -rf <submodule dir>
git submodule init
git submodule update 
```

# parsing - 逻辑表达式解析器

> ID：826717
> 
> 赞同：3
> 
> 时间：2009-05-05T20:12:09.837
> 
> 标签：parsing, logic, expression

我正在尝试为以下表达式创建一个逻辑表达式解析器： ((VariableA -> VariableB) AND NOT VariableC) 对于给定的变量值，无论结果是真还是假，解析器都应该能够返回。

基本上，表达式将只包含变量、逻辑运算符（或、和、蕴涵、等价、否定和括号）。

我想问一下实现这种解析器的最佳方法是什么（使用 AST 树或反向波兰表示法）？或者也许已经存在一些可以完成这项工作的开源解析器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T20:27:05.807

你的目标是什么语言？

如果您想创建一个解析器，也许[ANTLR](http://www.antlr.org/)会为您解决问题。它最初是基于 java 的，但它具有多种语言的生成器（例如，我用它来生成 C# 解析器）并且不难上手。它有一个很好的编辑器（ANTLRWorks），可以测试语法，这是一个很好的加分项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T20:23:05.833

如果我是你，我会使用 RPN。这应该可以在解析它时为您省去一些麻烦，并且算法应该像在运算符进入时推送和弹出一堆值一样简单。您也不必用括号来愚弄，这应该会让生活更轻松。唯一真正的缺点是大多数人不熟悉后缀（AKA RPN）表示法。

堆栈可能也比树更容易使用。

只是我的 2 美分 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-27T09:22:19.983

如果您使用 Python，请尝试使用[pyparsing](http://pyparsing.wikispaces.com)编写的[表达式 parser/evaluator](http://pyparsing.wikispaces.com/file/view/simpleBool.py)作为起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:30:52.850

我确信已经有工具可以做到这一点（逻辑评估），但我找不到任何工具。如果您使用诸如[Bison](http://www.gnu.org/software/bison/)（YACC，用于 C）或[ANTLR](http://www.antlr.org/)（生成多种语言，但使用 Java）之类的工具，则不必担心解析。[Coco/R](http://www.ssw.uni-linz.ac.at/coco/)是另一个可以生成许多不同语言的解析器生成器。如果你想自己做，我会使用 RPN 或前缀表示法（我认为它比 RPN 更简单）。这将使解析变得更加简单，但会惹恼您的用户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T20:35:22.747

这听起来像一个家庭作业:-)

首先，您必须递归地定义您的语言。

变量是良构形式 (WFF)

如果 X 是 WFF 则不是 X 是 WFF

如果 X 和 Y 是 WFF，则 (X -> Y) 是 WFF

如果 X 和 Y 是 WFF，那么（X AND Y 是）一个 WFF

定义语法后，使用 LEX 或 Flex 或 Java 的等效语言或您喜欢的语言来编写简单的扫描器。

使用 YACC 或 Bison 或等效物来编写后代递归解析器。

稍后将属性添加到语法中，以便以后代递归方式获得要评估的表达式的评估。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-09T09:40:31.467

你看过[http://ncalc.codeplex.com](http://ncalc.codeplex.com)吗？

它是可扩展的、快速的（例如有自己的缓存），使您能够通过处理 EvaluateFunction/EvaluateParameter 事件在运行时提供自定义函数和变量。它可以解析的示例表达式：

表达式 e = new Expression("Round(Pow(Pi, 2) + Pow([Pi2], 2) + X, 2)");

e.Parameters["Pi2"] = new Expression("Pi * Pi"); e.Parameters["X"] = 10;

e.EvaluateParameter += delegate(string name, ParameterArgs args) { if (name == "Pi") args.Result = 3.14; };

Debug.Assert(117.07 == e.Evaluate()); 它还原生处理 unicode 和许多数据类型。如果您想更改语法，它会附带一个 antler 文件。还有一个 fork 支持 MEF 加载新功能。

# python - 如何获取数据存储查询的第 n 条记录

> ID：826724
> 
> 赞同：1
> 
> 时间：2009-05-05T20:14:11.267
> 
> 标签：python, google-app-engine, google-cloud-datastore, custompaging

假设我在 GAE 中有模型 Foo 和这个查询：

query = Foo.all().order('- **key** ')

我想获得第 n 条记录。实现这一目标的最有效方法是什么？

如果排序属性不是唯一的，解决方案是否会中断，例如下面的：

query = Foo.all().order('-**颜色**')

编辑：n > 1000

编辑 2：我想开发一种友好的分页机制来显示可用的页面（例如第 1 页、第 2 页、... 第 185 页），并且在查询字符串中需要“？page=x”，而不是“？bookmark =XXX”。当 page = x 时，查询将从该页面的第一条记录开始获取记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T22:14:26.003

没有有效的方法来做到这一点 - 在任何 DBMS 中。在每种情况下，您至少必须按顺序读取索引记录，直到找到第 n 个，然后查找相应的数据记录。这或多或少是 fetch(count, offset) 在 GAE 中所做的，另外还有 1000 条记录的限制。

更好的方法是保留一个“书签”，其中包含您为检索到的最后一个实体排序的字段的值和实体的键。然后，当您想从上次中断的地方继续时，可以将字段的值添加为不等式查询的下限，并跳过记录，直到匹配或超过您看到的最后一条。

如果您想为用户提供“友好”的页面偏移量，您可以使用 memcache 来存储起始偏移量和书签 (order_property, key) 元组之间的关联。生成页面时，插入或更新最后一个实体的书签。当你获取一个页面时，如果它存在就使用书签，或者通过使用偏移量进行查询来生成它——如果偏移量足够高，可能会进行多个查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T22:01:27.843

查询类的文档可以在以下位置找到： [http ://code.google.com/appengine/docs/python/datastore/queryclass.html#Query](http://code.google.com/appengine/docs/python/datastore/queryclass.html#Query)

查询类提供 fetch 女巫在您的案例 1 和 n 中需要一个限制和一个偏移量

fetch 的运行时间随着 offset + limit 线性增长

因此，在您的情况下进行优化的唯一方法是确保您最常要访问的记录更接近数组的开头。

你可以使用 query.filter('key = ', n) query.get()

这将返回键为 n 的第一个匹配项

# delphi - Delphi 中的动态菜单/操作

> ID：826733
> 
> 赞同：2
> 
> 时间：2009-05-05T20:15:55.570
> 
> 标签：delphi

我有一个应用程序，其中包含一个地方子菜单，每个地方都有唯一的快捷方式。到目前为止，这个子菜单是静态的，但通常需要在菜单中添加一个新位置并分配一个新的快捷方式。该应用程序有一个单元 Clientdata，其中包含一个 TActionManager，它包含按钮、菜单以及我提到的子菜单所需的操作。

所以我希望这个子菜单在运行时可以改变。所有地点都保存在数据库中。我认为子菜单应该仍然在 actionmanager 中有操作。

除此之外，所有操作都有一个快捷方式编辑器，因此每个用户都可以拥有自己的个人快捷方式。这些快捷方式保存在个人文件目录中的文本文件中。

有3个地方需要改变。

*   系统模块。在这里，我可以添加、编辑和删除将在子菜单中的数据库中的位置。
*   行动经理。它包含子菜单的所有操作。它还拥有快捷方式，并且可以从文本文件加载/保存快捷方式。
*   计划模块。它使用地点的子菜单。它应该从数据库中的位置构建子菜单并为它们分配正确的快捷方式。

我已经开始实施，但我不确定我是否走在正确的轨道上。当在数据模块中编辑地点列表时，ActionManager 中的数据保持同步很重要。我不确定如何在运行时在 ActionManager 中添加、编辑删除操作。我只在设计时这样做了。

欢迎其他意见和可能的改进！

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T21:53:38.597

在运行时添加或删除操作有点倒退。您创建一个新的 TContainedAction，然后将其 ActionList 属性设置为您的列表。要将其从列表中删除，请设置 ActionList := **nil**或 .Free 操作。

一切都是从行动中完成的，而不是列表。您可以使用列表的 Actions 属性从列表中获取操作，或者如果您使用的是支持**for..in**循环的 Delphi 版本，则可以枚举列表。

您可以通过检查 actnlist.pas 中的源来获取更多信息。它不是那么大和复杂。D2009版本只有1162行。

# ruby - Ruby 实例变量何时设置？

> ID：826734
> 
> 赞同：67
> 
> 时间：2009-05-05T20:16:00.420
> 
> 标签：ruby, syntax, instance-variables

```
class Hello
@hello = "hello"
    def display
        puts @hello
    end
end

h = Hello.new
h.display 
```

我创建了上面的类。它不会打印任何东西。我认为实例变量@hello 是在类声明期间设置的。但是当我调用 display 方法时，输出是'nil'。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-05-06T08:00:53.020

初次学习 Ruby 时，ruby 中的实例变量可能会有些混乱，尤其是当您习惯于其他 OO 语言（如 Java）时。

您不能简单地声明一个实例变量。

关于 ruby​​ 中的实例变量，除了带有 @ 符号前缀的符号之外，最重要的事情之一是**它们在第一次被分配给**.

```
class Hello
  def create_some_state
    @hello = "hello"
  end
end

h = Hello.new
p h.instance_variables 

h.create_some_state
p h.instance_variables

# Output
[]
["@hello"] 
```

您可以使用该方法`Object#instance_variables`列出对象的所有实例变量。

您通常在 initialize 方法中“声明”并初始化所有实例变量。另一种明确记录哪些实例变量应该公开可用的方法是使用模块方法`attr_accessor`（读/写）、`attr_writer`（写）和`attr_reader`（读）。这些方法将为列出的实例变量合成不同的访问器方法。

```
class Hello
  attr_accessor :hello
end

h = Hello.new
p h.instance_variables 

h.hello = "hello"
p h.instance_variables

# Output
[]
["@hello"] 
```

`Hello#hello=`实例变量在使用合成方法分配给它之前仍然不会创建。

另一个重要问题，如 kch 所描述的，是在声明类时需要注意不同的活动上下文。当声明一个类时，最外层范围内的*默认接收者（self）*将是代表类本身的对象。因此，您的代码将首先`@hello`在类级别分配时创建一个类实例变量。

内部方法*self*将是调用该方法的对象，因此您尝试使用`@hello`对象中不存在的名称打印实例变量的值（请注意，读取不存在的实例是完全合法的多变的）。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-05T20:22:24.587

您需要添加一个`initialize`方法：

```
class Hello
    def initialize
        @hello = "hello"
    end
    def display
        puts @hello
    end
end

h = Hello.new
h.display 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-05-05T20:38:17.340

代码中的第一个`@hello`称为类实例变量。

它是常量`Hello`指向的类对象的实例变量。（这是类的一个实例`Class`。）

从技术上讲，当您在`class`范围内时，您`self`将设置为当前类的对象，并`@variables`与您当前的`self`. 男孩，我很讨厌解释这些事情。

[通过观看The Pragmatic Programmers 的每个 5 美元的截屏视频集，](http://www.pragprog.com/screencasts/v-dtrubyom/the-ruby-object-model-and-metaprogramming)您可以了解所有这些以及更多信息。

（或者你可以在这里要求澄清，我会尝试更新。）

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-11-11T06:29:11.033

《The ruby​​ Programming Language》一书中有明确的描述，阅读会很有帮助。我把它贴在这里（来自第 7.1.16 章）：

> 在类定义内部但在实例方法定义外部使用的实例变量是**类实例变量**。

```
class Point
    # Initialize our class instance variables in the class definition itself
    @n = 0              # How many points have been created
    @totalX = 0         # The sum of all X coordinates
    @totalY = 0         # The sum of all Y coordinates

    def initialize(x,y) # Initialize method 
      @x,@y = x, y      # Sets initial values for instance variables
    end

    def self.new(x,y)   # Class method to create new Point objects
      # Use the class instance variables in this class method to collect data
      @n += 1           # Keep track of how many Points have been created
      @totalX += x      # Add these coordinates to the totals
      @totalY += y

      super             # Invoke the real definition of new to create a Point
                    # More about super later in the chapter
    end

    # A class method to report the data we collected
    def self.report
        # Here we use the class instance variables in a class method
        puts "Number of points created: #@n"
        puts "Average X coordinate: #{@totalX.to_f/@n}"
        puts "Average Y coordinate: #{@totalY.to_f/@n}"
    end
end 
```

……

> 因为类实例变量只是类对象的实例变量，所以我们可以使用 attr、attr_reader 和 attr_accessor 来为它们创建访问器方法。

```
class << self
  attr_accessor :n, :totalX, :totalY
end 
```

定义了这些访问器后，我们可以将原始数据称为 Point.n、Point.totalX 和 Point.totalY。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-12-25T19:03:43.237

我忘记了 Ruby 中有一个“类实例变量”的概念。无论如何，OP的问题似乎令人费解，并且迄今为止在任何答案中都没有真正解决，除了kch的答案中的提示：这是一个范围问题。（在编辑时添加：实际上，sris 的答案在最后*确实*解决了这一点，但无论如何我都会让这个答案站稳脚跟，因为我认为示例代码可能有助于理解问题。）

在 Ruby 类中，以 开头的变量名`@`可以引用*两个*变量之一：**实例变量**或**类实例变量**，具体取决于它在类中的引用位置。这是一个相当微妙的问题。

一个例子将阐明这一点。这是一个小的 Ruby 测试类（在 irb 中测试的所有代码）：

```
class T

  @@class_variable = "BBQ"
  @class_instance_variable_1 = "WTF"
  @class_instance_variable_2 = "LOL"

  def self.class_method
    puts "@@class_variable           == #{@@class_variable           || 'nil'}"
    puts "@class_instance_variable_1 == #{@class_instance_variable_1 || 'nil'}"
    puts "@class_instance_variable_2 == #{@class_instance_variable_2 || 'nil'}"
    puts "@instance_variable         == #{@instance_variable         || 'nil'}"
  end

  def initialize
    @instance_variable = "omg"
    # The following line does not assign a value to the class instance variable,
    # but actually declares an instance variable withthe same name!
    @class_instance_variable_1 = "wtf"
    puts "@@class_variable           == #{@@class_variable           || 'nil'}"
    # The following two lines do not refer to the class instance variables,
    # but to the instance variables with the same names.
    puts "@class_instance_variable_1 == #{@class_instance_variable_1 || 'nil'}"
    puts "@class_instance_variable_2 == #{@class_instance_variable_2 || 'nil'}"
    puts "@instance_variable         == #{@instance_variable         || 'nil'}"
  end

  def instance_method
    puts "@@class_variable           == #{@@class_variable           || 'nil'}"
    # The following two lines do not refer to the class instance variables,
    # but to the instance variables with the same names.
    puts "@class_instance_variable_1 == #{@class_instance_variable_1 || 'nil'}"
    puts "@class_instance_variable_2 == #{@class_instance_variable_2 || 'nil'}"
    puts "@instance_variable         == #{@instance_variable         || 'nil'}"
  end

end 
```

我根据我的想法命名变量，尽管事实并非总是如此：

```
irb> T.class_method
@@class_variable           == BBQ
@class_instance_variable_1 == WTF    # the value of the class instance variable
@class_instance_variable_2 == LOL    # the value of the class instance variable
@instance_variable         == nil    # does not exist in the class scope
=> nil

irb> t = T.new
@@class_variable           == BBQ
@class_instance_variable_1 == wtf    # the value of the instance variable
@class_instance_variable_2 == nil    # the value of the instance variable
@instance_variable         == omg
=> #<T:0x000000015059f0 @instance_variable="omg", @class_instance_variable_1="wtf">

irb> t.instance_method
@@class_variable           == BBQ
@class_instance_variable_1 == wtf    # the value of the instance variable
@class_instance_variable_2 == nil    # the value of the instance variable
@instance_variable         == omg
=> nil

irb> T.class_method
@@class_variable           == BBQ
@class_instance_variable_1 == WTF    # the value of the class instance variable
@class_instance_variable_2 == LOL    # the value of the class instance variable
@instance_variable         == nil    # does not exist in the class scope
=> nil 
```

`@@class_variable`and`@instance_variable`总是按照你的预期表现：前者是在类级别定义的，无论是在类方法中还是在实例方法中引用，它都会在顶部保存分配给它的值。后者仅在 class 的对象中获取值`T`，因此在 class 方法中，它引用了值为 的未知变量`nil`。

想象中命名的类方法按预期`class_method`输出`@@class_variable`和 两个`@class_instance_variable`s 的值，即在类的顶部初始化。但是，在实例方法`initialize`和中`instance_method`，访问*的是同名的**不同*变量，即**实例变量，而不是类实例变量**。

 ***可以看到，`initialize`方法中的赋值并没有影响到类实例变量`@class_instance_variable_1`，因为后面的调用`class_method`输出了它的旧值，`"WTF"`。相反，方法`initialize` **声明了一个新的实例变量，**它*也*被命名为（误导性地）`@class_instance_variable_1`。分配给它的值 ,`"wtf"`由方法`initialize` 和输出`instance_method`。

`@class_instance_variable_2`示例代码中的变量等价于`@hello`原问题中的变量：它被声明并初始化为类实例变量，但是当实例方法引用该名称的变量时，它实际上看到**的是同名的实例变量**——一个从未声明过的，所以它的值为 nil。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-20T15:56:15.520

我还建议查看以“@@”为前缀的类变量 - 这里有一些示例代码向您展示类和实例变量的不同之处：

```
class Vars
  @@classvar="foo"
  def test
    @instancevar="bar"
  end
  def Vars.show
    puts "classvar: #{@@classvar}"
    puts "instancevar: #{@instancevar}"
  end
  def instance_show
    puts "classvar: #{@@classvar}"
    puts "instancevar: #{@instancevar}"

  end
end

# only shows classvar since we don't have an instance created
Vars::show
# create a class instance
vars = Vars.new
# instancevar still doesn't show b/c it hasn't been initialized
vars.instance_show
# initialize instancevar
vars.test
# now instancevar shows up as we expect
vars.instance_show 
```

# asp.net - SQL表日期字段比较

> ID：826735
> 
> 赞同：0
> 
> 时间：2009-05-05T20:16:34.710
> 
> 标签：asp.net

我的预订表格有两张桌子。一张表有书号（1-10）和状态；起初，所有状态都是“可用”。

第二个表具有保留者的名称和日期字段（签入、签出），并且两个表都与外键连接。所以 table1 到 table2 有一对多的关系；意味着许多学生可以预订一本书。

问题：

当我收到让我们假设 book1 的预订请求时；那么该 book1 的状态应更改为该日期时间的“Oh Hold”（在 table1 上）。当第二个请求针对同一本书1，在同一日期范围内或与日期重叠时，它必须告知一些消息，例如该日期已被保留或类似，以便第二个请求者不能在同一日期为同一本书预订，但他可以要求另一本书。

如何检查已经存在的 sql 表日期到当前输入日期？

非常感谢您的回复。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T20:21:29.877

基本上你会看到这个日期模式：

*   第一个日期不能在保留范围内。
*   最后日期不能在保留范围内
*   如果第一个日期小于保留的第一个日期，则最后一个日期不能大于保留的范围最后一个日期：

像这样的东西会找到当前的保留：

```
SELECT *
FROM reservations 
WHERE book = @bookId
AND (
(@dat_ini BETWEEN begin_date AND end_date)
OR (@dat_end BETWEEN begin_date AND end_date)
OR (@dat_ini < begin_date AND @dat_end > end_date)
) 
```

# java - JAXB 编组和泛型

> ID：826736
> 
> 赞同：10
> 
> 时间：2009-05-05T20:17:31.913
> 
> 标签：java, generics, jaxb

我正在尝试使用 JAXB 的自省来编组和取消编组一些用 JAXB 注释标记的现有域对象。大多数事情都按预期工作，但我在获得一个相当简单的类来序列化时遇到了很多麻烦。此类在许多 bean 上用作 @XmlElement ，看起来像：

```
public class Range<E extends Comparable<E>> implements Serializable {
    protected boolean startInclusive, endInclusive;
    protected E       start, end;

    public Range(){
            startInclusive = endInclusive = true;
    }

    public boolean contains(E value){...}

    public E getEnd() {
            return end;
    }

    public void setEnd(E end) {
            this.end = end;
    }

    public boolean isEndInclusive() {
            return endInclusive;
    }

    public void setEndInclusive(boolean endInclusive) {
            this.endInclusive = endInclusive;
    }

    public E getStart() {
            return start;
    }

    public void setStart(E start) {
            this.start = start;
    }

    public boolean isStartInclusive() {
            return startInclusive;
    }

    public void setStartInclusive(boolean startInclusive) {
            this.startInclusive = startInclusive;
    }
} 
```

我尝试了以下操作，但没有成功，JAXB 仍然对 Comparable 接口感到愤怒。

```
public class DoubleRange extends Range<Double> {} 
```

使用 Range 和 DoubleRange 作为 bean getter 的返回类型会产生如下异常：

```
java.lang.Comparable 是一个接口，JAXB 不能处理接口。
    此问题与以下位置有关：
        在 java.lang.Comparable
        在受保护的 java.lang.Comparable com.controlpath.util.Range.start
        在 example.util.Range
        在 example.util.DoubleRange
        在公共 example.util.DoubleRange example.domain.SomeBean.getRange()
        在 example.domain.SomeBean

```

我意识到在大多数情况下 List<T> 和 Map<T, U> 只能工作，因为 JAXB 规范对这些类型在 bean 上遇到时有特殊规定，但是有什么方法可以将我想要的内容传达给 JAXB 自省引擎而不必用非泛型字段重新实现范围？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-06T00:41:49.067

您可以通过执行以下操作来编写自定义适配器（不使用 JAXB 的 XmlAdapter）：

1）声明一个接受各种元素并具有JAXB注释并根据需要处理它们的类（在我的示例中，我将所有内容都转换为字符串）

```
@YourJAXBAnnotationsGoHere
public class MyAdapter{

  @XmlElement // or @XmlAttribute if you wish
  private String content;

  public MyAdapter(Object input){
    if(input instanceof String){
      content = (String)input;
    }else if(input instanceof YourFavoriteClass){
      content = ((YourFavoriteClass)input).convertSomehowToString();
    }else if(input instanceof .....){
      content = ((.....)input).convertSomehowToString();
    // and so on
    }else{
      content = input.toString();
    }
  }
}

// I would suggest to use a Map<Class<?>,IMyObjToStringConverter> ...
// to avoid nasty if-else-instanceof things 
```

2）在你的待编组类中使用这个类而不是 E

**笔记**

*   当然，这**不适**用于复杂（嵌套）数据结构。
*   您必须考虑如何再次将其解组，这可能会更加棘手。如果太棘手，请等待比我更好的建议；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T00:45:38.167

怎么样

```
public class Range<**E extends Number**> implements Serializable { ... 
```

*   数字是一个**类**

*   我打赌 JAXB 知道Number 的**默认**编组/解组规则

要解组到特定类型，您需要 XmlAdapter，正如我在此处描述的那样：[JAXB 继承，解组到编组类的子类](https://stackoverflow.com/questions/619761/jaxb-inheritance-unmarshal-to-subclass-of-marshaled-class/636597#636597)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:21:30.970

尝试类似[Simple XML Serialization](http://simple.sourceforge.net)的方法，它支持 XML 元素中的泛型类型，并带有许多注解，例如 @Element 和 @ElementList。编程模型非常相似，但比 JAXB 更简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-30T05:38:58.170

实际上，我不太清楚为什么这不起作用。似乎 JAXB 应该能够正确解析特定的子类型：如果（且仅当！）此类型不是根类型（它不是根据您的描述）。我的意思是，它只是一个 Bean；因此，如果将 T 替换为直接类型的 bean 有效，那么泛型版本应该使用子类化来绑定类型（如示例中所做的那样）。

所以也许这可能是实现中的一个错误？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-20T21:49:13.487

我所做的是以下内容：

1.  创建一个空类并将其标记为 JAXB

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public abstract class Marshallable {} 
```

2.  使每个将在泛型类中结束的类作为类型扩展这个 Marshallable 类型

```
(...)
public class A extends Marshallable {
(...) 
```

3.  将您的泛型类限制为仅允许 Marshallable 的子类作为泛型类型

```
public class GenericType<T extends Marshallable> { 
```

4.  使用你原本打算的课程

```
A a = new A();

jaxbMarshaller.marshal(new GenericType(a), outputStream); 
```

现在 Jaxb 将适用于扩展 Marshallable 的所有类型，甚至作为泛型类型的一部分。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-05T21:43:44.983

所以看起来问题是`E`on`start`和`end`is的擦除`Comparable`。如果它不能处理你可以尝试的接口`Object`，但我希望它也会抱怨（现在或以后）。可能您可以将`Range`其抽象化并针对每个特定的`E`. 我应该更多地了解 JAXB。

# c# - 以编程方式设置浏览器 cookie (Firefox)

> ID：826741
> 
> 赞同：5
> 
> 时间：2009-05-05T20:19:21.693
> 
> 标签：c#, internet-explorer, firefox, sqlite, cookies

我从[这个问题](https://stackoverflow.com/questions/302294/cookies-in-firefox)中知道 Firefox 3.0 及更高版本将其 cookie 存储在 SQLite 数据库中。**我的问题是：您可以通过添加 cookie 的方式从其他桌面**程序访问此数据库吗？

我意识到这有安全隐患。但是，我根本不想阅读它们。如果可能的话，我希望能够设置一个 cookie。我什至不想覆盖cookie。如果它不存在，我只想添加它。这是我为了好玩而从事的个人项目。

这个问题主要与语言无关。我更喜欢 C# 中的解决方案，但任何语言的概念证明就足够了。

额外的功劳：在 Internet Explorer 中设置相同的 cookie 也很酷

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T20:43:06.720

对于 FF3，您可以使用[任何 SQLite 包装器](http://www.google.com/search?client=opera&rls=en&q=c%23+sqlite&sourceid=opera&ie=utf-8&oe=utf-8)访问 cookies.sqlite 文件- 但是，请检查 FF 是否正在运行 - 它可能正在对文件进行写锁定（未经测试）。

该数据库包含以下内容：

```
TABLE moz_cookies (
    id INTEGER PRIMARY KEY, 
    name TEXT, 
    value TEXT, 
    host TEXT, 
    path TEXT,
    expiry INTEGER, 
    lastAccessed INTEGER, 
    isSecure INTEGER, 
    isHttpOnly INTEGER
) 
```

不确定主键，它看起来像是创建 cookie 时的 unix 时间戳；expiry 和 lastAccessed 也是 unix 时间戳，其余的不言自明。

尝试一下`INSERT INTO moz_cookies`，看看 FF 是否会立即意识到新的 cookie，或者是否需要重新启动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-14T07:08:04.817

我知道这个问题真的很老，但是我遇到了同样的问题，并且从未真正找到完整的代码示例（尽管此页面上的答案为我指明了正确的方向）。！

```
public static void ClearFirefoxCookies()
{
    int procCount = Process.GetProcessesByName("firefox").Length;
    if (procCount > 0)
        throw new ApplicationException(string.Format("There are {0} instances of Firefox still running", procCount));

    try
    {
        using (SQLiteConnection conn = new SQLiteConnection("Data Source=" + GetFirefoxCookiesFileName()))
        { 
            conn.Open();
            SQLiteCommand command = conn.CreateCommand();
            command.CommandText = "delete from moz_cookies";
            int count = command.ExecuteNonQuery();
        }
    }
    catch (SQLiteException ex)
    {
        if (!(ex.ErrorCode == SQLiteErrorCode.Busy || ex.ErrorCode == SQLiteErrorCode.Locked))
            throw new ApplicationException("The Firefox cookies.sqlite file is locked");
    }
}

private static string GetFirefoxCookiesFileName()
{
    string path = System.IO.Path.Combine(System.Environment.GetFolderPath(System.Environment.SpecialFolder.ApplicationData), @"Mozilla\Firefox\Profiles");
    if (!System.IO.Directory.Exists(path))
        throw new ApplicationException("Firefox profiles folder not found");

    string[] fileNames = System.IO.Directory.GetFiles(path, "cookies.sqlite", System.IO.SearchOption.AllDirectories);
    if (fileNames.Length != 1 || !System.IO.File.Exists(fileNames[0]))
        throw new ApplicationException("Firefox cookies.sqlite file not found");
    return fileNames[0];
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-25T18:10:01.903

使用[http://www.ch-werner.de/javasqlite/overview-summary.html](http://www.ch-werner.de/javasqlite/overview-summary.html)和[http://ini4j.sourceforge.net/](http://ini4j.sourceforge.net/)。适用于当前的 Firefox 11

```
List<Map<String, String>> getCookies() throws Exception
{
    String appdata = System.getenv("APPDATA");
    File fappdata = new File(appdata);
    Path firefox = fappdata.toPath().resolve("Mozilla").resolve("Firefox");
    File profilesini = firefox.resolve("profiles.ini").toFile();
    Ini ini = new Ini(profilesini);

    //TODO:Detect more profiles than just assume default profile configuration
    Ini.Section section = ini.get("Profile0");
    String profiledir = section.get("Path");

    File cookiesfile = firefox.resolve(profiledir).resolve("cookies.sqlite").toFile();

    String cookiesAdress = cookiesfile.getAbsolutePath();

    Class.forName("SQLite.JDBCDriver");
    Connection conn = DriverManager.getConnection("jdbc:sqlite:/"+cookiesAdress);
    Statement sta = conn.createStatement();

    String query = "select * from moz_cookies";

    ResultSet rs = sta.executeQuery(query);
    List<Map<String, String>> result = new ArrayList<>();

    while(rs.next())
    {
        Map<String, String> store = new HashMap<>();
        store.put("id", String.valueOf(rs.getInt("moz_cookies.id")));
        store.put("baseDomain", rs.getString("moz_cookies.baseDomain"));
        store.put("name", rs.getString("moz_cookies.name"));
        store.put("value", rs.getString("moz_cookies.value"));
        store.put("host", rs.getString("moz_cookies.host"));
        store.put("path", rs.getString("moz_cookies.path"));
        store.put("expiry", String.valueOf(rs.getInt("moz_cookies.expiry")));
        store.put("lastAccessed", String.valueOf(rs.getInt("moz_cookies.lastAccessed")));
        store.put("creationTime", String.valueOf(rs.getInt("moz_cookies.creationTime")));
        store.put("isSecure", String.valueOf(rs.getInt("moz_cookies.isSecure")));
        store.put("isHttpOnly", String.valueOf(rs.getInt("moz_cookies.isHttpOnly")));
        result.add(store);
    }
    rs.close();
    sta.close();
    conn.close();

    return result;

} 
```

伙计们，我将此代码用于自制刮刀。不要用 Firefox cookie 做坏事，否则 Mozilla 的人会加密它们，我们也不能用它们做有趣和无害的事情

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T20:26:03.127

您将需要使用 SQLite 连接器并连接到用户的 cookie 数据库文件。这位于他们的默认配置文件文件夹中，称为 cookies.sqlite。查看 Firefox 的[sqlite-manager](http://code.google.com/p/sqlite-manager/)。您可以查看 Firefox 使用的所有表。

编辑：这是一个提供者的链接：[System.Data.SQLite](http://sqlite.phxsoftware.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T21:43:36.310

[http://sqlite.phxsoftware.com/](http://sqlite.phxsoftware.com/)

这非常适合在 .NET 中处理 SQLite

# c# - 当我使用 void 时，内存会看到什么数据类型？

> ID：826742
> 
> 赞同：2
> 
> 时间：2009-05-05T20:20:27.103
> 
> 标签：c#, c++

当我创建一个 int 类型的方法时，编译器会在内存中保留 X 个位数。那么如何看到一个 void 类型呢？void 类型占用多少位/字节？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-05T20:26:23.127

void 类型不占用任何位。您不能声明 void 类型的变量。这：

```
void a; 
```

导致编译错误。
void 只是一个占位符，表示“无”返回 void 的函数不返回任何内容，而将 void 作为参数的函数不接受任何参数。

但是，您可以声明 void* 类型的变量：

```
void* a; 
```

这只是声明了一个可以指向任何东西的指针。与任何指针一样，它采用指针类型的大小，即 sizeof(void*) 在 32 位系统中通常等于 4。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T20:23:36.393

我认为您对编译器如何存储返回值的假设可能过于笼统。返回值的情况取决于语言、类型和硬件。

可能有一个“返回寄存器”可以保存返回值，因此不会占用任何内存。“返回寄存器”也可以根据返回的类型指向内存中分配的一些内容。

我不明白为什么返回 void 的函数会为返回值分配内存。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T20:42:31.870

在 x86 架构上（使用 gcc 3.4.6），int 函数的返回值存储在 eax 寄存器中。浮点数通过 XMM 寄存器或在 ST0 中返回。[编辑：感谢巴斯蒂安伦纳德！]

void 函数根本不将任何内容放入 eax 并返回。

```
#include <stdio.h>

int f1(void)
{
    printf("f1\n");
    return 9.0f;
}
void f2(void)
{
    printf("f2\n");
}

double f3(void)
{
    return 10.0;
}

int main(void)
{
    int x = f1();
    f2();
    double y = f3();
    return 0;
} 
```

使用 gcc -S 构建：

```
main:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $24, %esp
    andl    $-16, %esp
    movl    $0, %eax
    addl    $15, %eax
    addl    $15, %eax
    shrl    $4, %eax
    sall    $4, %eax
    subl    %eax, %esp
    call    f1
    movl    %eax, -4(%ebp)
    call    f2
    call    f3
    fstpl   -16(%ebp)
    movl    $0, %eax
    leave
    ret
    .size   main, .-main
    .section        .note.GNU-stack,"",@progbits
    .ident  "GCC: (GNU) 3.4.6" 
```

定义了 f2：

```
f2:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $8, %esp
    subl    $12, %esp
    pushl   $.LC1
    call    printf
    addl    $16, %esp
    leave
    ret
    .size   f2, .-f2 
```

和 f1 定义：

```
f1:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $8, %esp
    subl    $12, %esp
    pushl   $.LC0
    call    printf
    addl    $16, %esp
    movl    $9, %eax
    leave
    ret 
```

如果其他人从不同版本的 gcc 获得不同的代码，那么看到 XD 会很有趣（也许在其他情况下 int 函数返回堆栈......）

不过，我想在所有实现中，一个 void 函数根本不返回任何内容。它要么单独留下返回寄存器和/或不丢弃任何东西到（或放入）堆栈。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T20:59:37.447

如果函数返回`void`，调用者不期望任何返回值，也不需要分配任何内容。`void`不是要返回的真实类型，它更多地向编译器表明该函数不返回任何内容。

在 PC 上，函数返回简单的值，例如`int`将它们放在特定的寄存器 ( `eax`) 中；编译器只需生成适当的代码来检索此值。（如果函数返回`void`，那么编译器就不会生成这种代码。）
在其他架构上，调用者可能会隐式传递一个指向`int`返回值所在位置的参数。

C 和 C++ 标准没有指定这种低级的东西。它可能由另一个标准指定，也可能只是一个约定。

对于 C#，我想答案在于如何在[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)中获得返回值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T20:24:37.793

C 或 C++ 中本身没有 void 类型（我对 C# 一无所知）。void * 是一个无类型指针。

这可能会有所帮助：[http ://c-faq.com/ansi/voidparith.html](http://c-faq.com/ansi/voidparith.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T20:25:21.803

它只是一个未定义的指针类型，因此大小是您正在创建它的系统上任何其他指针的大小。

# cruisecontrol.net - 如何将 Ndepend 报告退出到 Build Report 中？

> ID：826754
> 
> 赞同：0
> 
> 时间：2009-05-05T20:22:44.290
> 
> 标签：cruisecontrol.net, ndepend

我想将 Ndepend 报告退出到 Build Report 中，但左侧导航中的链接中仍有“NDepend Report”链接。我怎样才能做到这一点？

谢谢！

亚历杭德拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T02:28:36.280

CruiseControl.NET 的在线文档涵盖了有关如何将 NDepend 与 CruiseControl.NET 集成的大部分细节。[http://confluence.public.thoughtworks.org/display/CCNET/Using+CruiseControl.NET+with+NDepend](http://confluence.public.thoughtworks.org/display/CCNET/Using+CruiseControl.NET+with+NDepend)

要更改的文件是dashboard.config。*<buildPlugins>*元素包含左侧菜单中的所有链接。要添加或删除链接，您需要添加相关元素，在本例中如下：

```
<xslReportBuildPlugin 
   description="NDepend Report" 
   actionName="NDependBuildReport" 
   xslFileName="xsl\ndependreport-ccnet.v2.xsl" /> 
```

要从主报告中删除 NDepend 报告，您需要修改*<buildReportBuildPlugin>*元素。找到以下元素并将其删除：

```
<xslFile>xsl\ndependreport-ccnet.v2.xsl</xslFile> 
```

希望这能回答你的问题。

克雷格

# c# - 有没有办法等待多个信号量

> ID：826769
> 
> 赞同：4
> 
> 时间：2009-05-05T20:26:10.833
> 
> 标签：c#, multithreading

我正在尝试编写一个可以同时等待多个资源池的应用程序。每个资源池都由一个`Semaphor`. 我可以`WaitHandle.WaitAll()`在传递整个信号量列表的地方使用吗？此实现是否存在潜在的死锁问题？

我目前的实现：

```
namespace XXX
{
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading;

    public class ResourcePoolManager
    {
        private readonly IDictionary<string, Semaphore> resourcePools = new Dictionary<string, Semaphore>();

        public void AddResourcePool(string resourceName, int maxConcurrentConsumers)
        {
            this.resourcePools.Add(resourceName, new Semaphore(maxConcurrentConsumers, maxConcurrentConsumers));
        }

        public void RequestResource(string resourceName)
        {
            this.resourcePools[resourceName].WaitOne();
        }

        public void RequestMultipleResources(string[] resourceNames)
        {
            Semaphore[] resources = resourceNames.Select(s => this.resourcePools[s]).ToArray();

            WaitHandle.WaitAll(resources);
        }

        public void ReleaseResource(string resourceName)
        {
            this.resourcePools[resourceName].Release(1);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T20:31:17.670

当然，您可以使用它，但它只会在所有信号量同时触发时才会触发。根据应用程序其余部分的结构，可能确实存在饥饿问题。例如，如果您有两个资源 A 和 B，以及三个线程：

1.  不断获取资源A，使用它一秒钟，然后释放它并循环
2.  不断获取资源B，使用它一秒钟，然后释放它并循环
3.  等待 A 和 B 都可用

您可以轻松地永久等待 A 和 B 同时可用。

根据您的应用程序，最好简单地按顺序获取每个信号量，这样可以避免这种饥饿问题，但会引入传统的死锁问题。但是，如果您确定这些锁在大部分时间都可用，它可能是安全的（但也可能是一个定时炸弹，只是等待您的应用程序处于实际负载下......）

给定您的示例代码，另一种选择是在信号量上创建一个全局排序 - 例如，按名称排序 - 并始终确保按该顺序获取它们。如果这样做，您可以简单地通过按升序逐个锁定每个信号量来执行多重锁定。

在这种情况下，释放的顺序并不重要——但如果你释放的顺序不正确，你应该在你刚刚释放的锁“之后”释放所有锁，然后再获取更多锁（这是一个应该给你的经验法则死锁安全。可以通过详细分析进一步放宽这一点）。推荐的方法是在可能的情况下以相反的获取顺序发布，在这种情况下，您可以随时将其用于进一步获取。例如：

1.  获取锁 A
2.  获取锁 B
3.  获取锁 C
4.  释放锁 C
5.  获取锁 D
6.  发布 B（现在在发布 D 之前不要获得任何东西！）
7.  发布 D
8.  获得 E
9.  发布 E
10.  发布 A

只要一切都遵循这些规则，就不可能出现死锁，因为无法形成服务员循环。

这种方法的缺点是它可能会通过在等待另一个线程时持有一个锁来延迟其他线程。这不会永远持续下去；在上面的三个线程示例中，我们可能会遇到这种情况，例如：

1.  开始时，线程 2 持有 B。线程 1 持有 A。
2.  A 上的线程 3 块。
3.  （时间流逝）
4.  线程 1 发布 A。
5.  线程 3 锁定 A，阻塞 B。
6.  A 上的线程 1 块。
7.  （时间流逝）
8.  线程 2 发布 B.
9.  线程 3 锁定 B，工作，然后解锁。
10.  线程 1 锁定 A，取得进展。

如您所见，即使没有真正的工作要做，线程 1 在 A 上也被阻塞了一些停机时间。但是，通过这样做，我们大大提高了线程 3 取得进展的机会。

这是否是一个好的折衷取决于您的应用程序 - 如果您可以明确地说多个线程永远不会进入锁，那甚至可能无关紧要。但是没有一种正确的方法:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T20:41:17.193

你的意图是什么？

1.  您是否需要等到所有信号量都发出信号？如果是这样，请参阅以前的帖子。

2.  您是否需要等到任何 1 个信号量发出信号？如果是这样，请改用 WaitAny()。

注意：WaitAny 接受等待句柄数组，并返回已发出信号的句柄的索引。

如果多个句柄发出信号，WaitAny 返回第一个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:30:33.320

WaitAll 的全部目的是避免只获取您正在等待的某些对象的死锁可能性。当且仅当您尝试获取的所有信号量都可用时，WaitAll 才会成功。除非它们都可用，否则它不会锁定其中任何一个。

# authentication - 多个后端身份验证系统的用户登录

> ID：826774
> 
> 赞同：1
> 
> 时间：2009-05-05T20:26:42.237
> 
> 标签：authentication

我们有一个在医疗办公室使用的应用程序，并且随着 CCHIT 认证成为一项要求，我们正在重新审视我们自己的安全性。传统上我们已经完成了自己的登录/密码/访问级别认证/授权，但只要我们必须重写以符合标准，为什么不变得更加灵活。

虽然我们是一个 Windows 应用程序，但我们的一些客户端通过 UNIX 进行身份验证，另一些使用 Novell，另一些使用 Windows Active Directory，还有一些根本不使用（小型办公室、小型网络）。我想针对我们可以在当前运行的任何环境中使用的单个服务器（或编写单个服务器）进行编写，允许客户端使用他们已经创建的内容，而不是维护两个不同的登录名，因为他们现在与我们的产品有关。

寻找可用于提供身份验证工作的应用程序的建议（如果它尚不存在），但将与正在使用的身份验证工具一起使用（如果存在）。

谢谢。

而且，如果重要的话，我们在 Delphi 中工作，目前不需要 .NET 并且还了解 Java。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T22:18:34.557

公开可用的[Kerberos](http://en.wikipedia.org/wiki/Kerberos_(protocol))实现提供[客户端服务授权](http://en.wikipedia.org/wiki/Kerberos_(protocol)#Client_Service_Authorization)以及[客户端身份验证](http://en.wikipedia.org/wiki/Kerberos_(protocol)#Client_Authentication)。

阅读有关[在 Red Hat Linux 上使用 Kerberos 5 的信息](http://www.redhat.com/docs/manuals/linux/RHL-7.2-Manual/ref-guide/ch-kerberos.html)。Windows Active Directory 也是一个 Kerberos 实现。

# c# - 如何拥有自动递增的版本号（Visual Studio）？

> ID：826777
> 
> 赞同：514
> 
> 时间：2009-05-05T20:28:03.450
> 
> 标签：c#, visual-studio, versioning

我想存储一组在构建时自动递增的整数：

```
int MajorVersion = 0;
int MinorVersion = 1;
int Revision = 92; 
```

当我编译时，它会自动递增`Revision`。当我构建设置项目时，它会增加`MinorVersion`（我可以手动执行此操作）。`MajorVersion`只能手动递增。

然后我可以在菜单帮助/关于中向用户显示版本号：

```
  版本：0.1.92

```

如何做到这一点？

这个问题不仅询问如何拥有自动递增的版本号，还询问如何在代码中使用它，这是一个比其他人更完整的答案。

* * *

## 回答 #1

> 赞同：672
> 
> 时间：2009-05-05T20:46:49.443

如果您将[AssemblyInfo](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.assemblyversionattribute.aspx)类添加到您的项目并修改`AssemblyVersion`属性以以星号结尾，例如：

```
[assembly: AssemblyVersion("2.10.*")] 
```

Visual Studio 将根据[这些规则](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.aspx)为您增加最终数字（感谢 galets，我完全错了！）

要在代码中引用此版本，以便将其显示给用户，请使用`reflection`. 例如，

```
Version version = System.Reflection.Assembly.GetExecutingAssembly().GetName().Version;
DateTime buildDate = new DateTime(2000, 1, 1)
                        .AddDays(version.Build).AddSeconds(version.Revision * 2);
string displayableVersion = $"{version} ({buildDate})"; 
```

## 你应该知道的三个重要问题

### 来自@ashes999：

还值得注意的是，如果同时指定`AssemblyVersion`和`AssemblyFileVersion`，您将不会在 .exe 上看到它。

### 来自@BrainSlugs83：

仅将第 4 个数字设置为`*`可能不好，因为版本不会总是递增。 **第 3 个数字是自 2000 年以来的天数**，**第 4 个数字是自午夜以来的秒数（除以 2）[IT IS NOT RANDOM]**。因此，如果您在一天的晚些时候构建解决方案，而在第二天的早些时候构建解决方案，则较晚的构建将具有较早的版本号。我建议始终使用`X.Y.*`，而不是`X.Y.Z.*`因为您的版本号总是会以这种方式增加。

### 较新版本的 Visual Studio 会出现此错误：

> **（此主题始于 2009 年）**
> 
> 指定的版本字符串包含通配符，与确定性不兼容。从版本字符串中删除通配符，或禁用此编译的确定性。
> 
> 请参阅此 SO 答案，其中解释了如何[消除确定性](https://stackoverflow.com/a/58101474/1555612)（[https://stackoverflow.com/a/58101474/1555612](https://stackoverflow.com/a/58101474/1555612)）

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2009-05-05T22:34:06.313

您可以使用[Visual Studio 中的 T4 模板机制从一个简单的文本文件生成所需的源代码](https://vagifabilov.wordpress.com/2010/04/24/using-t4-templates-to-manage-assembly-version-information/)：

> 我想为一些 .NET 项目配置版本信息生成。自从我调查可用选项以来已经有很长时间了，所以我四处寻找希望找到一些简单的方法来做到这一点。我的发现看起来不太令人鼓舞：人们编写 Visual Studio 加载项和自定义 MsBuild 任务只是为了获得一个整数（好吧，也许是两个）。对于一个小型个人项目来说，这感觉有点过头了。
> 
> 灵感来自 StackOverflow 的一次讨论，其中有人建议 T4 模板可以完成这项工作。他们当然可以。该解决方案需要最少的工作，无需 Visual Studio 或构建过程自定义。这里应该做什么：
> 
> 1.  创建一个扩展名为“.tt”的文件，并在其中放置将生成 AssemblyVersion 和 AssemblyFileVersion 属性的 T4 模板：

```
<#@ template language="C#" #>
// 
// This code was generated by a tool. Any changes made manually will be lost
// the next time this code is regenerated.
// 

using System.Reflection;

[assembly: AssemblyVersion("1.0.1.<#= this.RevisionNumber #>")]
[assembly: AssemblyFileVersion("1.0.1.<#= this.RevisionNumber #>")]
<#+
    int RevisionNumber = (int)(DateTime.UtcNow - new DateTime(2010,1,1)).TotalDays;
#> 
```

> 您将不得不决定版本号生成算法。对我来说，自动生成一个设置为自 2010 年 1 月 1 日以来的天数的修订号就足够了。如您所见，版本生成规则是用纯 C# 编写的，因此您可以根据需要轻松调整它.
> 
> 2.  上面的文件应该放在其中一个项目中。我只用这个单个文件创建了一个新项目，以明确版本管理技术。当我构建这个项目时（实际上我什至不需要构建它：保存文件足以触发 Visual Studio 操作），生成以下 C#：

```
// 
// This code was generated by a tool. Any changes made manually will be lost
// the next time this code is regenerated.
// 

using System.Reflection;

[assembly: AssemblyVersion("1.0.1.113")]
[assembly: AssemblyFileVersion("1.0.1.113")] 
```

> 是的，今天是自 2010 年 1 月 1 日以来的 113 天。明天修订号将更改。
> 
> 3.  下一步是从应共享相同自动生成的版本信息的所有项目中的 AssemblyInfo.cs 文件中删除 AssemblyVersion 和 AssemblyFileVersion 属性。而是为每个项目选择“添加现有项目”，导航到带有 T4 模板文件的文件夹，选择相应的“.cs”文件并将其添加为链接。这样就行了！
> 
> 我喜欢这种方法的地方在于它是轻量级的（没有自定义 MsBuild 任务），并且自动生成的版本信息不会添加到源代码管理中。当然，使用 C# 进行版本生成算法也适用于任何复杂的算法。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2013-02-24T08:35:45.633

这是我对 T4 建议的实现......这将在每次构建项目时增加构建号，而不管选择的配置（即调试|发布）如何，并且每次执行发布构建时都会增加修订号。**您可以通过Application ➤ Assembly Information...**继续更新主要和次要版本号...

 **为了更详细地解释，这将读取现有`AssemblyInfo.cs`文件，并使用正则表达式查找`AssemblyVersion`信息，然后根据来自`TextTransform.exe`.

1.  删除现有`AssemblyInfo.cs`文件。
2.  在其位置创建一个`AssemblyInfo.tt`文件。`AssemblyInfo.cs`保存 T4 文件后，Visual Studio 应创建它并将其与 T4 文件分组。

    ```
    <#@ template debug="true" hostspecific="true" language="C#" #>
    <#@ output extension=".cs" #>
    <#@ import namespace="System.IO" #>
    <#@ import namespace="System.Text.RegularExpressions" #>
    <#
        string output = File.ReadAllText(this.Host.ResolvePath("AssemblyInfo.cs"));
        Regex pattern = new Regex("AssemblyVersion\\(\"(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<revision>\\d+)\\.(?<build>\\d+)\"\\)");
        MatchCollection matches = pattern.Matches(output);
        if( matches.Count == 1 )
        {
            major = Convert.ToInt32(matches[0].Groups["major"].Value);
            minor = Convert.ToInt32(matches[0].Groups["minor"].Value);
            build = Convert.ToInt32(matches[0].Groups["build"].Value) + 1;
            revision = Convert.ToInt32(matches[0].Groups["revision"].Value);
            if( this.Host.ResolveParameterValue("-","-","BuildConfiguration") == "Release" )
                revision++;
        }
    #>

    using System.Reflection;
    using System.Runtime.CompilerServices;
    using System.Runtime.InteropServices;
    using System.Resources;

    // General Information
    [assembly: AssemblyTitle("Insert title here")]
    [assembly: AssemblyDescription("Insert description here")]
    [assembly: AssemblyConfiguration("")]
    [assembly: AssemblyCompany("Insert company here")]
    [assembly: AssemblyProduct("Insert product here")]
    [assembly: AssemblyCopyright("Insert copyright here")]
    [assembly: AssemblyTrademark("Insert trademark here")]
    [assembly: AssemblyCulture("")]

    // Version informationr(
    [assembly: AssemblyVersion("<#= this.major #>.<#= this.minor #>.<#= this.revision #>.<#= this.build #>")]
    [assembly: AssemblyFileVersion("<#= this.major #>.<#= this.minor #>.<#= this.revision #>.<#= this.build #>")]
    [assembly: NeutralResourcesLanguageAttribute( "en-US" )]

    <#+
        int major = 1;
        int minor = 0;
        int revision = 0;
        int build = 0;
    #> 
    ```

3.  将此添加到您的预构建事件中：

    ```
    "%CommonProgramFiles(x86)%\microsoft shared\TextTemplating\$(VisualStudioVersion)\TextTransform.exe" -a !!BuildConfiguration!$(Configuration) "$(ProjectDir)Properties\AssemblyInfo.tt" 
    ```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2010-09-09T15:38:37.767

如果您为构建和修订添加星号，则 Visual Studio 使用自 2000 年 1 月 1 日以来的天数作为内部版本号，并将自午夜以来的秒数除以 2 作为修订版本。

一个更好的救生解决方案是[http://autobuildversion.codeplex.com/](http://autobuildversion.codeplex.com/)

它就像一个魅力，它非常灵活。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-05-05T20:53:07.540

**以下是[MSDN 对 AssemblyInfo.cs 的引用](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.aspx)：**

> *您可以指定所有值，也可以使用星号 ( )*接受默认内部版本号、修订号或两者。*例如，[assembly:AssemblyVersion("2.3.25.1")] 表示 2 为主要版本，3 为次要版本，25 为内部版本号，1 为修订号。**诸如 [assembly:AssemblyVersion("1.2.* ")] 的版本号指定 1 作为主要版本，2 作为次要版本，并接受默认的构建和修订号。诸如 [assembly:AssemblyVersion("1.2.15.*")] 的版本号指定 1 作为主要版本，2 作为次要版本，15 作为内部版本号，并接受默认修订号。默认内部版本号每天递增。默认修订号是随机的

这有效地表示，如果您将 1.1.* 放入程序集信息中，则只有内部版本号会自动递增，并且不会在每次构建之后发生，而是每天发生。修订号将更改每个构建，但随机，而不是以递增的方式。

对于大多数用例来说，这可能就足够了。如果这不是您想要的，那么您将不得不编写一个脚本，该脚本将在预构建步骤中自动增加版本 #

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-05-05T20:39:52.703

使用 AssemblyInfo.cs

在 App_Code: 中创建文件并填写以下内容或使用 Google 获取其他属性/属性可能性。

**装配信息.cs**

```
using System.Reflection;

[assembly: AssemblyDescription("Very useful stuff here.")]
[assembly: AssemblyCompany("companyname")]
[assembly: AssemblyCopyright("Copyright © me 2009")]
[assembly: AssemblyProduct("NeatProduct")]
[assembly: AssemblyVersion("1.1.*")] 
```

AssemblyVersion 是您真正追求的部分。

然后，如果您在网站上工作，在任何 aspx 页面或控件中，您可以在 <Page> 标记中添加以下内容：

```
CompilerOptions="<folderpath>\App_Code\AssemblyInfo.cs" 
```

（当然用适当的变量替换文件夹路径）。

我认为您不需要以任何方式为其他类添加编译器选项；App_Code 中的所有的都应该在编译时收到版本信息。

希望有帮助。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2013-05-01T18:07:59.873

*   版本中的星号（如“2.10.3.*”） - 很简单，但数字太大

*   AutoBuildVersion - 看起来不错，但它不适用于我的 VS2010。

*   @DrewChapin 的脚本有效，但我无法在我的工作室中为调试预构建事件和发布预构建事件设置不同的模式。

所以我稍微改变了脚本......命令：

```
"%CommonProgramFiles(x86)%\microsoft shared\TextTemplating\10.0\TextTransform.exe" -a !!$(ConfigurationName)!1 "$(ProjectDir)Properties\AssemblyInfo.tt" 
```

和脚本（这适用于“调试”和“发布”配置）：

```
<#@ template debug="true" hostspecific="true" language="C#" #>
<#@ output extension=".cs" #>
<#@ assembly name="System.Windows.Forms" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Text.RegularExpressions" #>
<#
    int incRevision = 1;
    int incBuild = 1;

    try { incRevision = Convert.ToInt32(this.Host.ResolveParameterValue("","","Debug"));} catch( Exception ) { incBuild=0; }
    try { incBuild = Convert.ToInt32(this.Host.ResolveParameterValue("","","Release")); } catch( Exception ) { incRevision=0; }
    try {
        string currentDirectory = Path.GetDirectoryName(Host.TemplateFile);
        string assemblyInfo = File.ReadAllText(Path.Combine(currentDirectory,"AssemblyInfo.cs"));
        Regex pattern = new Regex("AssemblyVersion\\(\"\\d+\\.\\d+\\.(?<revision>\\d+)\\.(?<build>\\d+)\"\\)");
        MatchCollection matches = pattern.Matches(assemblyInfo);
        revision = Convert.ToInt32(matches[0].Groups["revision"].Value) + incRevision;
        build = Convert.ToInt32(matches[0].Groups["build"].Value) + incBuild;
    }
    catch( Exception ) { }
#>
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// General Information about an assembly is controlled through the following
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
[assembly: AssemblyTitle("Game engine. Keys: F2 (Debug trace), F4 (Fullscreen), Shift+Arrows (Move view). ")]
[assembly: AssemblyProduct("Game engine")]
[assembly: AssemblyDescription("My engine for game")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyCopyright("Copyright © Name 2013")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// Setting ComVisible to false makes the types in this assembly not visible
// to COM components.  If you need to access a type in this assembly from
// COM, set the ComVisible attribute to true on that type. Only Windows
// assemblies support COM.
[assembly: ComVisible(false)]

// On Windows, the following GUID is for the ID of the typelib if this
// project is exposed to COM. On other platforms, it unique identifies the
// title storage container when deploying this assembly to the device.
[assembly: Guid("00000000-0000-0000-0000-000000000000")]

// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version
//      Build Number
//      Revision
//
[assembly: AssemblyVersion("0.1.<#= this.revision #>.<#= this.build #>")]
[assembly: AssemblyFileVersion("0.1.<#= this.revision #>.<#= this.build #>")]

<#+
    int revision = 0;
    int build = 0;
#> 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-05-05T22:53:38.903

您可以尝试使用 Matt Griffith 的 UpdateVersion。现在已经很老了，但效果很好。要使用它，您只需设置一个指向您的 AssemblyInfo.cs 文件的预构建事件，应用程序将根据命令行参数相应地更新版本号。

由于应用程序是开源的，我还创建了一个版本来使用格式*(Major version).(Minor version).([year][dayofyear]).(increment) 增加*版本号。我已将我的 UpdateVersion 应用程序修改版本的代码放在 GitHub 上：[https ://github.com/munr/UpdateVersion](https://github.com/munr/UpdateVersion)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-12-23T19:12:29.320

您可以使用构建脚本（例如[Build Versioning ）进行更高级的版本控制](http://www.codeproject.com/KB/dotnet/build_versioning.aspx)

# wpf - WPF 通用 DataGrid CellTemplate - 绑定到单元格值？

> ID：826779
> 
> 赞同：4
> 
> 时间：2009-05-05T20:28:12.483
> 
> 标签：wpf, data-binding, datagrid, datatrigger

我在理解 WPF 中数据绑定的基础知识时遇到问题。我有一个通用的 DataGrid（设置了 AutoGenerateColumns），它绑定到一个 DataTable，其列名在每次加载时都不同。当 dataTable 包含布尔类型的列时，我想呈现一个包含表示真假的自定义图像的列。

为此，我在页面上为单元格模板声明了一个 StaticResource，并且我有捕获 AutoGenerateColumn 事件并使用此模板的 c# 代码：

```
<DataTemplate x:Key="CheckmarkColumnTemplate">
    <Image x:Name="CheckmarkImage" Source="..\..\images\check.png" Height="16" Width="16" />
    <DataTemplate.Triggers>
        <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Value}" Value="False">
            <Setter TargetName="CheckmarkImage" Property="Source" Value="..\..\images\nocheck.png" />
        </DataTrigger>
    </DataTemplate.Triggers>
</DataTemplate> 
```

C#代码：

```
private void dgData_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
{
    if (e.PropertyType == typeof(bool))
    {
        DataGridTemplateColumn col = new DataGridTemplateColumn();
        Binding binding = new Binding(e.PropertyName);
        col.CellTemplate = (this.Resources["CheckmarkColumnTemplate"] as DataTemplate);
        col.Header = e.PropertyName;
        e.Column = col;
    }
} 
```

这主要是有效的，除了我的 DataTrigger Binding 属性搞砸了。它从不检测列的值何时为“false”，因此它从不显示 nocheck.png 图像。我不知道如何编写 Binding 属性，以便引用列的数据绑定值（请记住，列名每次都不同，所以我不能在绑定的 Path 部分硬编码列名） .

谁能告诉我 Binding 属性应该是什么样子，以便它只获取列的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T04:57:16.880

我有同样的问题，仍在寻找答案。我当前的解决方案是创建`DataTemplate`事件`AutoGeneratingColumn`处理程序，以便`DataTemplate`知道属性名称。

```
private void OnAutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
{
    e.Column = new DataGridTemplateColumn
    {
        Header = e.PropertyName,
        CellTemplate = CreateSimpleCellTemplate(e.PropertyName)
    }
}

private static DataTemplate CreateSimpleCellTemplate(string propertyName)
{
    DataTemplate template = new DataTemplate();
    template.VisualTree = new FrameworkElementFactory(typeof(Label));
    template.VisualTree.SetBinding(ContentProperty, new Binding(propertyName));
    return template;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:53:17.243

我通过使用不同的方法达到了我想要的结果。我没有使用 DataGridTemplateColumn，而是使用了 DataGridCheckBoxColumn，并根据 WPF Toolkit 的“动手实验室”中使用的示例样式设置了自定义 ElementStyle：

```
<Style x:Key="NoBorderCheckBoxStyle" TargetType="{x:Type CheckBox}">
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="Background" Value="{StaticResource CheckBoxFillNormal}"/>
    <Setter Property="BorderBrush" Value="{StaticResource CheckBoxStroke}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="FocusVisualStyle" Value="{StaticResource EmptyCheckBoxFocusVisual}"/>
    <Setter Property="HorizontalAlignment" Value="Center"/>
    <Setter Property="IsEnabled" Value="false"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type CheckBox}">
                <BulletDecorator SnapsToDevicePixels="true" Background="Transparent">
                    <BulletDecorator.Bullet>
                        <Canvas x:Name="canvas"  Width="16" Height="16" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5">
                            <Image x:Name="checkImage" Source="..\..\images\check.png" Height="16" Width="16"></Image>
                        </Canvas>
                    </BulletDecorator.Bullet>
                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" RecognizesAccessKey="True"/>
                </BulletDecorator>
                <ControlTemplate.Triggers>
                    <Trigger Property="HasContent" Value="True">
                        <Setter Property="FocusVisualStyle" Value="{StaticResource CheckRadioFocusVisual}"/>
                        <Setter Property="Padding" Value="4,0,0,0"/>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                    </Trigger>
                    <Trigger Property="IsChecked" Value="False">
                        <Setter Property="Source" TargetName="checkImage" Value="..\..\images\nocheck.png" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

我在从实际的 DataGrid 列设置中读取“IsEnabled”属性时遇到了问题（它的属性是“IsReadOnly”），但是因为我对 DataGrid 的使用是只读的，所以我在这里将其设置为 false。

# java - Hibernate 可审计的多对多关系

> ID：826781
> 
> 赞同：1
> 
> 时间：2009-05-05T20:28:31.500
> 
> 标签：java, hibernate

考虑以下休眠配置：

```
<class name="Person">
<id name="id" column="personId">
    <generator class="native"/>
</id>
<set name="addresses" table="PersonAddress">
    <key column="personId"/>
    <many-to-many column="addressId"
        class="Address"/>
</set>
</class>

<class name="Address">
<id name="id" column="addressId">
    <generator class="native"/>
</id>
<set name="people" inverse="true" table="PersonAddress">
    <key column="addressId"/>
    <many-to-many column="personId"
        class="Person"/>
</set>
</class> 
```

现在，这两个类（Person 和 Address）有一个 Auditable 接口。在我们的 Hibernate AuditInterceptor 类（实现拦截器）中，如果实体是可审计的实例，我们将执行一些审计功能。简而言之，所有这些代码都很好用......

但是，这个 PersonAddress 表没有得到审计，因为我们在技术上没有 POJO 用于它......所以我们不能检查一些“instanceof”。在休眠配置中有什么方法可以告诉它拦截这个 PersonAddress 表吗？也许我们需要处理来自拦截器的其他操作之一（如 onCollectionUpdate）。我不知道...

我能想到的强制它进行审计的唯一另一种方法是将关系转换为从 Person 到 PersonAddress 的一对多，从 Address 到 PersonAddress 的一对多，并为 PersonAddress 创建另一个类元素，它可以执行许多操作 -返回到 Person 和 Address 的一对一映射。

这似乎有点像额外的工作，我真的想避免额外的工作。

有人可以提出更好的解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T22:36:03.487

您如何将地址添加到一个人，以及将人员添加到一个地址？由于您没有 PersonAddress 的域对象，因此对这些关系的编辑必须发生在 Person 或 Address 之一，不是吗？

如果是这样，那么将审计作为人员或地址审计的一部分进行。

例如，在人中：

```
class Person {
    private List<Address> addedAddresses;
    private Set<Address> addresses;
    .
    .
    .
    public void addAddress(Address toAdd) {
        addedAddresses.add(toAdd);
        addresses.add(toAdd);
    }
} 
```

然后，在审计 Person 时，将记录的条目记录到 addedAddresses 中，如果它不为空。

当然，这很简单（如何处理删除？编辑地址？）但在您的示例中没有更多内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T17:42:42.310

我无法通过多对多映射来解决这个问题，所以我将该映射转换为一对多，并为 PersonAddress 创建了一个具有适当休眠映射的模型 bean。

谢谢！

# css - 如何禁用文本选择突出显示

> ID：826782
> 
> 赞同：5771
> 
> 时间：2009-05-05T20:29:18.237
> 
> 标签：css, cross-browser, highlight, textselection

对于充当按钮（例如，位于 Stack Overflow 页面顶部的*Questions*、*Tags*、*Users*等）或选项卡的锚点，如果用户不小心选择了文本，是否有 CSS 标准方法来禁用突出显示效果?

我意识到这可以通过 JavaScript 来完成，并且通过谷歌搜索产生了仅限 Mozilla 的`-moz-user-select`选项。

是否有一种符合标准的方式来使用 CSS 实现这一点，如果没有，“最佳实践”方法是什么？

* * *

## 回答 #1

> 赞同：8170
> 
> 时间：2010-12-10T09:28:22.777

**2017 年 1 月更新：**

根据[Can I use](http://caniuse.com/#feat=user-select-none)，`user-select`除了 Internet Explorer 9 及其早期版本（但遗憾的*是仍然*需要供应商前缀）之外，所有浏览器目前都支持。

* * *

这些是所有可用的正确 CSS 变体：

```
.noselect {
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome, Edge, Opera and Firefox */
}
```

```
<p>
  Selectable text.
</p>
<p class="noselect">
  Unselectable text.
</p>
```

* * *

请注意，这`user-select`是在标准化过程中（目前在[W3C 工作草案中](https://drafts.csswg.org/css-ui-4/#propdef-user-select)）。它不能保证在任何地方都可以工作，并且浏览器之间的实现可能存在差异。此外，浏览器将来可能会放弃对它的支持。

* * *

更多信息可以在[Mozilla Developer Network 文档](https://developer.mozilla.org/en-US/docs/Web/CSS/user-select)中找到。

此属性的值为`none`、`text`、`toggle`、`element`、`elements`和。`all``inherit`

* * *

## 回答 #2

> 赞同：920
> 
> 时间：2010-12-05T11:45:11.047

在大多数浏览器中，这可以使用 CSS`user-select`属性的专有变体来实现，[最初在 CSS 3 中提出然后放弃](http://www.w3.org/TR/2000/WD-css3-userint-20000216#user-select)，现在在[CSS UI Level 4](https://drafts.csswg.org/css-ui-4/#content-selection)中提出：

```
*.unselectable {
   -moz-user-select: none;
   -khtml-user-select: none;
   -webkit-user-select: none;

   /*
     Introduced in Internet Explorer 10.
     See http://ie.microsoft.com/testdrive/HTML5/msUserSelect/
   */
   -ms-user-select: none;
   user-select: none;
} 
```

对于 Internet Explorer < 10 和[Opera](http://en.wikipedia.org/wiki/Opera_%28web_browser%29) < 15，您将需要使用`unselectable`您希望不可选择的元素的属性。您可以使用 HTML 中的属性进行设置：

```
<div id="foo" unselectable="on" class="unselectable">...</div> 
```

遗憾的是，这个属性不是继承的，这意味着您必须在`<div>`. 如果这是一个问题，您可以改为使用 JavaScript 为元素的后代递归地执行此操作：

```
function makeUnselectable(node) {
    if (node.nodeType == 1) {
        node.setAttribute("unselectable", "on");
    }
    var child = node.firstChild;
    while (child) {
        makeUnselectable(child);
        child = child.nextSibling;
    }
}

makeUnselectable(document.getElementById("foo")); 
```

* * *

**2014 年 4 月 30 日更新**：每当向树中添加新元素时，都需要重新运行此树遍历，但从 @Han 的评论看来，可以通过添加设置在目标上的`mousedown`事件处理程序来避免这种情况`unselectable`事件。有关详细信息，请参阅[http://jsbin.com/yagekiji/1](http://jsbin.com/yagekiji/1)。

* * *

这仍然没有涵盖所有可能性。虽然不可能在不可选择的元素中启动选择，但在某些浏览器（例如 Internet Explorer 和 Firefox）中，仍然不可能阻止在不可选择元素之前和之后开始的选择而不使整个文档不可选择。

* * *

## 回答 #3

> 赞同：223
> 
> 时间：2009-05-05T20:37:10.103

在 CSS 3 的[用户选择](http://www.w3.org/TR/1999/WD-css3-userint-19990916#user-select)属性可用之前，基于[Gecko](http://en.wikipedia.org/wiki/Gecko_%28layout_engine%29)的浏览器支持`-moz-user-select`您已经找到的属性。[基于 WebKit](https://en.wikipedia.org/wiki/WebKit)和 Blink 的浏览器支持该`-webkit-user-select`属性。

这在不使用 Gecko 渲染引擎的浏览器中当然是不支持的。

没有符合“标准”的快速简便的方法来做到这一点；使用 JavaScript 是一种选择。

真正的问题是，为什么您希望用户不能突出显示并可能复制和粘贴某些元素？我从来没有遇到过我不想让用户突出显示我网站的某个部分的情况。我的几个朋友在花费大量时间阅读和编写代码后，会使用高亮功能来记住他们在页面上的位置，或者提供一个标记，以便他们的眼睛知道下一步该往哪里看。

我认为这很有用的唯一地方是，如果用户复制和粘贴网站时，如果您有不应该复制和粘贴的表单按钮。

* * *

## 回答 #4

> 赞同：206
> 
> 时间：2009-11-13T16:05:58.853

Internet Explorer 的 JavaScript 解决方案是：

```
onselectstart="return false;" 
```

* * *

## 回答 #5

> 赞同：152
> 
> 时间：2011-05-24T21:24:53.037

如果您想禁用除`<p>`元素之外的所有内容的文本选择，您可以在 CSS 中执行此操作（注意`-moz-none`允许在子元素中覆盖的选项，在其他浏览器中允许使用`none`）：

```
* {
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: -moz-none;
    -o-user-select: none;
    user-select: none;
}

p {
    -webkit-user-select: text;
    -khtml-user-select: text;
    -moz-user-select: text;
    -o-user-select: text;
    user-select: text;
} 
```

* * *

## 回答 #6

> 赞同：135
> 
> 时间：2015-08-30T18:32:57.460

在先前答案中的解决方案中，选择已停止，但用户仍然认为您可以选择文本，因为光标仍在更改。为了保持静态，你必须设置你的 CSS 光标：

```
.noselect {
    cursor: default;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}
```

```
<p>
  Selectable text.
</p>
<p class="noselect">
  Unselectable text.
</p>
```

这将使您的文本完全平坦，就像在桌面应用程序中一样。

* * *

## 回答 #7

> 赞同：118
> 
> 时间：2009-05-05T20:46:27.227

您可以在 Firefox 和 Safari（Chrome 也可以？）

```
::selection { background: transparent; }
::-moz-selection { background: transparent; } 
```

* * *

## 回答 #8

> 赞同：87
> 
> 时间：2011-09-21T07:09:59.487

[WebKit](http://en.wikipedia.org/wiki/WebKit)的解决方法：

```
/* Disable tap highlighting */
-webkit-tap-highlight-color: rgba(0, 0, 0, 0); 
```

我在 CardFlip 示例中找到了它。

* * *

## 回答 #9

> 赞同：86
> 
> 时间：2011-11-11T19:53:19.923

我喜欢混合 CSS + jQuery 解决方案。

要使内部的所有元素`<div class="draggable"></div>`不可选择，请使用以下 CSS：

```
.draggable {
    -webkit-user-select: none;
     -khtml-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
         -o-user-select: none;
            user-select: none;
}

.draggable input {
    -webkit-user-select: text;
     -khtml-user-select: text;
       -moz-user-select: text;
         -o-user-select: text;
            user-select: text;
 } 
```

然后，如果您使用的是 jQuery，请将其添加到`$(document).ready()`块中：

```
if (($.browser.msie && $.browser.version < 10) || $.browser.opera) $('.draggable').find(':not(input)').attr('unselectable', 'on'); 
```

我认为您仍然希望任何输入元素都是可交互的，因此是`:not()`伪选择器。`'*'`如果你不在乎，你可以改用。

警告：Internet Explorer 9 可能不需要这个额外的 jQuery 片段，因此您可能需要在其中添加版本检查。

* * *

## 回答 #10

> 赞同：79
> 
> 时间：2013-05-01T11:36:36.903

```
.hidden:after {
    content: attr(data-txt);
}
```

```
<p class="hidden" data-txt="Some text you don't want to be selected"></p>
```

不过，这不是最好的方法。

* * *

## 回答 #11

> 赞同：78
> 
> 时间：2017-06-05T14:03:58.940

您可以为此使用**CSS**或**JavaScript**。

*旧版*浏览器也支持 JavaScript 方式，例如旧**版本**的*Internet* Explorer，但如果不是您的情况，请使用 CSS 方式：

 ****HTML/JavaScript：**

```
<html onselectstart='return false;'>
  <body>
    <h1>This is the Heading!</h1>
    <p>And I'm the text, I won't be selected if you select me.</p>
  </body>
</html>
```

**HTML/CSS：**

```
.not-selectable {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
```

```
<body class="not-selectable">
  <h1>This is the Heading!</h1>
  <p>And I'm the text, I won't be selected if you select me.</p>
</body>
```

* * *

## 回答 #12

> 赞同：66
> 
> 时间：2013-12-23T14:05:05.910

另外对于 Internet Explorer，您需要添加**伪类`focus`**(.ClassName:focus) 和`outline-style: none`.

```
.ClassName,
.ClassName:focus {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    outline-style: none; /* Internet Explorer  */
} 
```

* * *

## 回答 #13

> 赞同：62
> 
> 时间：2016-08-28T07:13:16.270

尝试将这些行插入 CSS 并在类属性中调用“disHighlight”：

```
.disHighlight {
    user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
    -webkit-touch-callout: none;
    -o-user-select: none;
    -moz-user-select: none;
} 
```

* * *

## 回答 #14

> 赞同：59
> 
> 时间：2018-03-31T11:32:06.000

**快速破解更新**

如果您`none`对所有 CSS`user-select`属性（包括它的浏览器前缀）使用该值，则仍然会出现问题。

```
.div {
    -webkit-user-select: none; /* Chrome all / Safari all */
    -moz-user-select: none;    /* Firefox all             */
    -ms-user-select: none;     /* Internet Explorer  10+  */
     user-select: none;        /* Likely future           */
} 
```

正如[CSS-Tricks](https://css-tricks.com/almanac/properties/u/user-select/)所说，**问题**是：

[如果您选择文本周围的元素， WebKit](http://en.wikipedia.org/wiki/WebKit)仍然允许复制文本。

您还可以使用下面的方法来`enforce`选择整个元素，这意味着如果您单击一个元素，则包含在该元素中的所有文本都将被选中。为此，您只需将值更改`none`为`all`.

```
.force-select {
    -webkit-user-select: all;  /* Chrome 49+     */
    -moz-user-select: all;     /* Firefox 43+    */
    -ms-user-select: all;      /* No support yet */
    user-select: all;          /* Likely future  */
} 
```

* * *

## 回答 #15

> 赞同：54
> 
> 时间：2019-10-11T10:27:13.250

## 使用[SASS](https://sass-lang.com/)（SCSS 语法）

您可以使用[mixin](https://sass-lang.com/documentation/at-rules/mixin)执行此操作：

```
// Disable selection
@mixin disable-selection {
    -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none;   /* Safari */
    -khtml-user-select: none;    /* Konqueror HTML */
    -moz-user-select: none;      /* Firefox */
    -ms-user-select: none;       /* Internet Explorer/Edge */
    user-select: none;           /* Non-prefixed version, currently supported by Chrome and Opera */
}

// No selectable element
.no-selectable {
    @include disable-selection;
} 
```

在 HTML 标记中：

```
<div class="no-selectable">TRY TO HIGHLIGHT</div> 
```

* * *

**在这个[CodePen中](https://codepen.io/alessandroinfo/pen/eYNNQNv)**尝试一下**。**

 ***如果您使用的是[自动前缀](https://github.com/postcss/autoprefixer)，则可以删除其他前缀。*

浏览器兼容性[在这里](https://caniuse.com/#feat=user-select-none)。

* * *

## 回答 #16

> 赞同：52
> 
> 时间：2014-05-19T05:30:01.507

对于那些在 Android 浏览器中无法通过触摸事件实现相同功能的用户，请使用：

```
html, body {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    -webkit-tap-highlight-color: transparent;
} 
```

* * *

## 回答 #17

> 赞同：49
> 
> 时间：2014-02-27T09:01:50.813

**在职的**

CSS：

```
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
-webkit-touch-callout: none;
-webkit-user-select: none; 
```

这应该有效，但不适用于旧浏览器。存在浏览器兼容性问题。

* * *

## 回答 #18

> 赞同：49
> 
> 时间：2012-04-18T08:34:40.057

如果您使用[Less](https://en.wikipedia.org/wiki/Less_%28stylesheet_language%29)和[Bootstrap](https://en.wikipedia.org/wiki/Bootstrap_%28front-end_framework%29)，您可以编写：

```
.user-select(none); 
```

* * *

## 回答 #19

> 赞同：49
> 
> 时间：2012-10-26T05:44:15.133

```
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-o-user-select: none;
user-select: none;

*.unselectable {
   -moz-user-select: -moz-none;
   -khtml-user-select: none;
   -webkit-user-select: none;
   user-select: none;
} 
```

```
<div id="foo" unselectable="on" class="unselectable">...</div> 
```

```
function makeUnselectable(node) {
    if (node.nodeType == 1) {
        node.unselectable = true;
    }
    var child = node.firstChild;
    while (child) {
        makeUnselectable(child);
        child = child.nextSibling;
    }
}

makeUnselectable(document.getElementById("foo")); 
```

```
-webkit-user-select: none;
-moz-user-select: none; 
```

```
onselectstart="return false;" 
```

```
::selection { 
    background: transparent; 
}

::-moz-selection { 
    background: transparent; 
}

* {
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: -moz-none;
    -o-user-select: none;
    user-select: none;
}

p {
    -webkit-user-select: text;
    -khtml-user-select: text;
    -moz-user-select: text;
    -o-user-select: text;
    user-select: text;
} 
```

```
<div class="draggable"></div> 
```

```
.draggable {
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -o-user-select: none;
    user-select: none;
}

.draggable input {
    -webkit-user-select: text;
    -khtml-user-select: text;
    -moz-user-select: text;
    -o-user-select: text;
    user-select: text;
 } 
```

```
if ($.browser.msie)
    $('.draggable').find(':not(input)').attr('unselectable', 'on'); 
```

* * *

## 回答 #20

> 赞同：40
> 
> 时间：2009-05-05T20:38:05.127

除了 Mozilla-only 属性，不，没有办法仅使用标准 CSS 禁用文本选择（截至目前）。

如果您注意到，Stack Overflow 不会禁用其导航按钮的文本选择，我建议在大多数情况下不要这样做，因为它会修改正常的选择行为并使其与用户的期望相冲突。

* * *

## 回答 #21

> 赞同：37
> 
> 时间：2014-04-09T22:56:24.437

这适用于*某些*浏览器：

```
::selection{ background-color: transparent;}
::moz-selection{ background-color: transparent;}
::webkit-selection{ background-color: transparent;} 
```

只需在选择器前面添加您想要的元素/id，用逗号分隔，不带空格，如下所示：

```
h1::selection,h2::selection,h3::selection,p::selection{ background-color: transparent;}
h1::moz-selection,h2::moz-selection,h3::moz-selection,p::moz-selection{ background-color: transparent;}
h1::webkit-selection,h2::webkit-selection,h3::webkit-selection,p::webkit-selection{ background-color: transparent;} 
```

其他答案更好；这可能应该被视为最后的手段/总括。

* * *

## 回答 #22

> 赞同：37
> 
> 时间：2016-03-28T09:42:03.890

假设有两个`div`这样的s：

```
.second {
  cursor: default;
  user-select: none;
  -webkit-user-select: none;
  /* Chrome/Safari/Opera */
  -moz-user-select: none;
  /* Firefox */
  -ms-user-select: none;
  /* Internet Explorer/Edge */
  -webkit-touch-callout: none;
  /* iOS Safari */
}
```

```
<div class="first">
  This is my first div
</div>

<div class="second">
  This is my second div
</div>
```

将光标设置为默认值，这样它会给用户一种无法选择的感觉。

> 需要使用前缀在所有浏览器中支持它。如果没有前缀，这可能不适用于所有答案。

* * *

## 回答 #23

> 赞同：33
> 
> 时间：2013-04-03T08:31:10.310

如果也不需要颜色选择，这将很有用：

```
::-moz-selection { background:none; color:none; }
::selection { background:none; color:none; } 
```

...所有其他浏览器修复。它适用于[Internet Explorer 9](http://en.wikipedia.org/wiki/Internet_Explorer_9)或更高版本。

* * *

## 回答 #24

> 赞同：32
> 
> 时间：2012-10-30T06:56:19.030

将此添加到要禁用文本选择的第一个 div：

```
onmousedown='return false;' 
onselectstart='return false;' 
```

* * *

## 回答 #25

> 赞同：30
> 
> 时间：2014-11-07T13:22:21.950

**笔记：**

正确答案是正确的，因为它会阻止您选择文本。但是，它不会阻止您复制文本，正如我将在接下来的几个屏幕截图中展示的那样（截至 2014 年 11 月 7 日）。

![在我们选择任何东西之前](https://i.stack.imgur.com/gcKTY.png)

![我们选择后](https://i.stack.imgur.com/xwPld.png)

![号码已被复制](https://i.stack.imgur.com/Ex6UH.png)

如您所见，我们无法选择数字，但我们能够复制它们。

测试：[Ubuntu](http://en.wikipedia.org/wiki/Ubuntu_%28operating_system%29)，[谷歌浏览器](http://en.wikipedia.org/wiki/Google_Chrome)38.0.2125.111。

* * *

## 回答 #26

> 赞同：27
> 
> 时间：2015-05-14T00:13:18.510

为了得到我需要的结果，我发现我必须同时使用**`::selection`**和**`user-select`**

```
input.no-select:focus {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

input.no-select::selection {
    background: transparent;
}

input.no-select::-moz-selection {
    background: transparent;
} 
```

* * *

## 回答 #27

> 赞同：27
> 
> 时间：2018-11-08T09:17:26.867

It is easily done with:

```
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
-o-user-select: none;
user-select: none; 
```

* * *

Alternatively:

Let's say you have a `<h1 id="example">Hello, World!</h1>`. You will have to remove the innerHTML of that `h1`, in this case **Hello, World**. Then you will have to go to CSS and do this:

```
#example::before // You can of course use **::after** as well.
{
    content: 'Hello, World!'; // Both single-quotes and double-quotes can be used here.

    display: block; // To make sure it works fine in every browser.
} 
```

Now it simply thinks it is a block-element, and not text.

* * *

## 回答 #28

> 赞同：23
> 
> 时间：2013-04-09T16:42:23.987

这不是 CSS，但值得一提：

[jQuery UI 禁用选择](http://api.jqueryui.com/disableSelection/)：

```
$("your.selector").disableSelection(); 
```

* * *

## 回答 #29

> 赞同：21
> 
> 时间：2014-03-21T13:53:43.460

Though this pseudo-element was in drafts of CSS Selectors Level 3, it was removed during the Candidate Recommendation phase, as it appeared that its behavior was under-specified, especially with nested elements, and interoperability wasn't achieved.

It's being discussed in *[How ::selection works on nested elements](http://lists.w3.org/Archives/Public/www-style/2008Oct/0268.html)*.

Despite it is being implemented in browsers, you can make an illusion of text not being selected by using the same color and background color on selection as of the tab design (in your case).

### Normal CSS Design

```
p { color: white;  background: black; } 
```

### On selection

```
p::-moz-selection { color: white;  background: black; }
p::selection      { color: white;  background: black; } 
```

Disallowing users to select the text will raise usability issues.

* * *

## 回答 #30

> 赞同：21
> 
> 时间：2014-02-22T22:06:41.517

在没有 JavaScript 的情况下检查我的解决方案：

[jsFiddle](http://jsfiddle.net/y4Lac/)

```
li:hover {
    background-color: silver;
}
#id1:before {
    content: "File";
}
#id2:before {
    content: "Edit";
}
#id3:before {
    content: "View";
}
```

```
<ul>
    <li><a id="id1" href="www.w1.com"></a>
    <li><a id="id2" href="www.w2.com"></a>
    <li><a id="id3" href="www.w3.com"></a>
</ul>
```

应用我的技术的弹出菜单：http: [//jsfiddle.net/y4Lac/2/](http://jsfiddle.net/y4Lac/2/)

* * *

## 回答 #31

> 赞同：19
> 
> 时间：2016-04-01T11:16:39.077

我从[CSS-Tricks](https://css-tricks.com/almanac/properties/u/user-select/)网站上学到了。

```
user-select: none; 
```

这也是：

```
::selection {
    background-color: transparent;
}

::moz-selection {
    background-color: transparent;
}

::webkit-selection {
    background-color: transparent;
} 
```

* * *

## 回答 #32

> 赞同：16
> 
> 时间：2021-05-03T18:20:15.513

目前`user-select`所有浏览器都支持。

* * *

这些是所有可用的正确 CSS 变体：

```
.noselect {
  -webkit-user-select: none;    /* Safari */
  -webkit-touch-callout: none;  /* iOS Safari */
  -khtml-user-select: none;     /* Konqueror HTML */
  -ms-user-select: none;        /* Internet Explorer/Edge */
  -moz-user-select: none;       /* Old versions of Firefox */
   user-select: none;           /* Non-prefixed version*/
}
```

```
<p>
  Selectable
</p>

<p class="noselect">
  Unselectable
</p>
```

* * *

* * *

## 回答 #33

> 赞同：15
> 
> 时间：2018-04-30T03:47:18.847

如果您想禁用整个页面的选择和突出显示，您可以使用 CSS 轻松做到这一点：

```
* {
    -webkit-touch-callout: none; /* iOS Safari */
      -webkit-user-select: none; /* Safari */
       -khtml-user-select: none; /* Konqueror HTML */
         -moz-user-select: none; /* Firefox */
          -ms-user-select: none; /* Internet Explorer/Edge */
              user-select: none; /* Non-prefixed version, currently
                                    supported by Chrome and Opera */
} 
```

* * *

## 回答 #34

> 赞同：11
> 
> 时间：2016-01-20T09:22:16.107

尝试使用这个：

```
::selection {
    background: transparent;
} 
```

如果你想指定在特定元素内不选择，只需将元素类或id放在选择规则之前，例如：

```
.ClassNAME::selection {
    background: transparent;
}
#IdNAME::selection {
    background: transparent;
} 
```

* * *

## 回答 #35

> 赞同：11
> 
> 时间：2021-11-27T11:52:38.580

# 第一种方法：（完全废话）：

```
.no-select::selection, .no-select *::selection {
  background-color: Transparent;
}

.no-select { /* Sometimes I add this too. */
  cursor: default;
} 
```

```
<span>RixTheTyrunt is da best!</span>
<br>
<span class="no-select">RixTheTyrunt is da best!</span> 
```

片段：

```
.no-select::selection, .no-select *::selection {
  background-color: Transparent;
}

.no-select {
  /* Sometimes I add this too. */
  cursor: default;
}
```

```
<span>RixTheTyrunt is da best!</span>
<br>
<span class="no-select">RixTheTyrunt is da best!</span>
```

# 第二种方法（包括废话）

```
.no-select {
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
} 
```

片段：

```
.no-select {
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
}
```

```
<span>RixTheTyrunt is da best!</span>
<br>
<span class="no-select">RixTheTyrunt is da best!</span>
```

> 首先，解决问题。然后，编写代码。
> 
> 约翰·约翰逊

* * *

## 回答 #36

> 赞同：10
> 
> 时间：2016-09-06T09:04:22.467

您可以使用以下`*-user-select`属性...

```
p {
    -webkit-user-select: none;  /* Chrome all and Safari all */
    -moz-user-select: none;     /* Firefox all */
    -ms-user-select: none;      /* Internet Explorer 10 and later */
    user-select: none;          /* Likely future */
} 
```

[详细说明的链接](https://css-tricks.com/almanac/properties/u/user-select/)

* * *

## 回答 #37

> 赞同：10
> 
> 时间：2016-04-15T09:29:51.543

利用：

```
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none; 
```

* * *

## 回答 #38

> 赞同：9
> 
> 时间：2020-09-03T14:14:55.590

你试过这个吗？

```
.disableSelect{
    user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
    -webkit-touch-callout: none;
    -o-user-select: none;
    -moz-user-select: none;

    pointer-events:none;
} 
```

* * *

## 回答 #39

> 赞同：9
> 
> 时间：2016-06-03T13:12:16.593

这种突出显示效果是由于称为*悬停*(onMouseHover) 的操作。

当您将鼠标悬停在任何选项卡上时，其颜色将发生变化。

举个例子，

### HTML 代码

```
<div class="menu">
    <ul class="effect">
        <li>Questions</li>
        <li>JOBS</li>
        <li>Users</li>
    </ul>
</div> 
```

### CSS 代码

```
.effect:hover {
    color: none;
} 
```

如果你想让它突出显示，你可以使用任何颜色。否则你可以使用`none`.

* * *

## 回答 #40

> 赞同：8
> 
> 时间：2020-03-06T10:33:17.977

向您的 CSS 添加一个类，定义您不能选择或突出显示元素。我有一个例子：

```
<style> 
    .no_highlighting{
        user-select: none;
    }

    .anchor_without_decoration:hover{
        text-decoration-style: none;
    }
</style>

<a href="#" class="anchor_without_decoration no_highlighting">Anchor text</a> 
```

* * *

## 回答 #41

> 赞同：7
> 
> 时间：2018-09-22T14:23:07.150

使用 CSS-

```
div {
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -o-user-select: none;

  "unselectable='on' onselectstart="return false;"
  onmousedown="return false;
}
```

```
<div>
  Blabla
  <br/> More Blabla
  <br/> More Blabla...
</div>
```

* * *

## 回答 #42

> 赞同：6
> 
> 时间：2021-07-10T11:16:46.337

我看到了许多详细的答案，但我相信仅编写这行代码就足以完成所需的任务：

```
*{
    -webkit-user-select: none;
 } 
```

* * *

## 回答 #43

> 赞同：4
> 
> 时间：2018-02-01T20:23:34.533

我将各种浏览器 CSS 选择属性与 Internet Explorer < 9 所需的不可选择标签组合在一起。

```
<style>
[unselectable="on"] {
    -webkit-user-select: none; /* Safari */
    -moz-user-select: none; /* Firefox */
    -ms-user-select: none; /* Internet Explorer 10+/Edge */
    user-select: none; /* Standard */
}
</style>
<div unselectable="on">Unselectable Text</div> 
```

* * *

## 回答 #44

> 赞同：4
> 
> 时间：2018-01-31T00:05:39.950

更好的是，您可以禁用文本选择。

如果你喜欢 Sass (SCSS)，并且不想使用[Compass](http://en.wikipedia.org/wiki/Compass_Project)，你可以这样做：

`styles.scss`

```
@mixin user-select($select) {
    -webkit-touch-callout:#{$select};
    @each $pre in -webkit-, -moz-, -ms-, -o-, -khtml- {
        #{$pre + user-select}: #{$select};
    }
    #{user-select}: #{$select};
}

.no-select {
    @include user-select(none);
} 
```

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2017-03-02T17:34:38.827

也许您可以通过以下方式使用此解决方案`:before`：

```
nav li {
    display: inline-block;
    position: relative;
}

nav li a {
    display: inline-block;
    padding: 10px 20px;
}

nav li a:hover {
    color: red;
}

nav li.disabled:before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
}
```

```
<nav>
    <ul>
    <li><a href="#">Link</a></li>
    <li class="disabled"><a href="#">Link</a></li>
    <li><a href="#">Link</a></li>
    </ul>
</nav>
```

JsFiddle - [https://jsfiddle.net/grinmax_/9L1cckxu/](https://jsfiddle.net/grinmax_/9L1cckxu/)

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2018-10-31T06:13:51.243

```
::selection {background: transparent; color: transparent;}

::-moz-selection {background: transparent; color: transparent;} 
```

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2020-01-17T01:01:57.273

这可能有效

```
 ::selection {
        color: none;
        background: none;
    }
    /* For Mozilla Firefox */
    ::-moz-selection {
        color: none;
        background: none;
    } 
```

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2021-12-27T12:44:06.717

```
//prevent right key    
 document.addEventListener('contextmenu', (e) => {
  e.preventDefault();
    return false
  });
//prevent selection
 window.addEventListener('selectstart', (e)=>{ e.preventDefault() }); 
```

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2019-08-27T07:17:04.677

您可能还想防止在触摸元素（如阻止其选择的按钮）时出现上下文菜单。为此，请将此代码添加到整个页面，或者只是那些按钮元素：

```
$("body").on("contextmenu",function(e){
    return false;
}); 
```

* * *

## 回答 #50

> 赞同：-6
> 
> 时间：2019-12-06T12:54:28.367

```
<script type="text/javascript">
    if(typeof document.onselectstart!="undefined"){
        document.onselectstart=new Function ("return false");
    }else{
        document.onmousedown= new Function ("return false");
        document.onmouseup= new Function ("return true");
    }
</script> 
```

# nhibernate - 在 Nhibernate 查询中对链接集合进行排序

> ID：826785
> 
> 赞同：0
> 
> 时间：2009-05-05T20:29:52.947
> 
> 标签：nhibernate

这部分与[此](https://stackoverflow.com/questions/814510/nhibernate-sorting-a-has-many-collection)有关。
我想找到一种直接在 Nhibernate 查询中对链接（HasMany）集合结果进行排序的方法。

```
 ICriteria criteria = Session.CreateCriteria(typeof(PortalPage));
 criteria.CreateAlias("PartialViews", "vc");
 criteria.AddOrder(Order.Asc("vc.ColumnNumber"));
 criteria.Add(Property.ForName("Url").Eq(pageUrl));
 return criteria.UniqueResult<PortalPage>(); 
```

正确地使用 ORDER BY 生成选择，但链接集合中的结果未排序。

我想避免在返回结果后对集合进行排序（比如使用 linq to objects）这可能吗？

更新：正如史蒂夫建议的那样，可以通过硬编码映射中的 order 属性来解决问题，例如：

```
HasMany(x => x.PartialViews).KeyColumnNames.Add("PageId").AsBag().SetAttribute("order-by", "ColumnNumber"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T20:39:24.123

您是否将集合指定为列表类型而不是包或集合？如果您确保使用列表映射类型并为列表映射指定索引列，则应为您处理所有事情。

请参阅此处的[文档](http://www.nhforge.org/doc/nh/en/index.html#collections-onetomany)，此处也有[更多信息](http://sdesmedt.wordpress.com/2006/09/04/nhibernate-part-4-mapping-techniques-for-aggregation-one-to-many-mapping/)，尽管第二个是较旧的帖子，因此请注意可能已更改的内容。

这是一个简单的列表集合映射示例：

```
<list name="Images table="Images">
  <key column="Id"/>
  <index column="Position"/>
  <element type="String" column="FileName"/>
</list> 
```

此示例的流畅映射将如下所示：

```
HasMany(x => x.Images).AsList(x => x.WithColumn("Position")); 
```

# sql-server - SQL Server 中的 LDF 文件是什么？

> ID：826789
> 
> 赞同：69
> 
> 时间：2009-05-05T20:30:45.347
> 
> 标签：sql-server

SQL Server 中的 LDF 文件是什么？它的目的是什么？

我可以安全地删除它吗？或减小它的大小，因为有时它比数据库文件 mdf 大 10 倍。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-06-19T15:09:00.130

LDF 保存事务日志。如果您正确设置备份 - 它会很小。它会增长 - 您有一个非常常见的问题，即将数据库恢复模式设置为 FULL，然后忘记备份事务日志（LDF 文件）。让我解释一下如何解决它。

1.  如果您的企业能够承受在备份之间丢失少量数据，只需将数据库恢复模式设置为 SIMPLE，然后忘记 LDF - 它会很小。这是大多数情况下推荐的解决方案。
2.  如果您必须能够恢复到确切的时间点 - 使用完整恢复模式。在这种情况下，您必须定期备份事务日志。最简单的方法是使用[SqlBackupAndFTP](https://sqlbackupandftp.com/)之类的工具（披露——我是一名开发人员）。此时日志文件将被截断，并且不会超出某些限制。

有些人会建议使用 SHRINKFILE 来修剪你的日志。请注意，这仅作为例外是可以的。如果你经常这样做，它会破坏完整恢复模型的目的：首先你会遇到麻烦保存日志中的每一个更改，然后你只是转储它。改为将恢复模式设置为简单。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-05-05T20:35:03.450

LDF 文件保存数据库事务日志。例如，请参阅[http://www.databasedesign-resource.com/sql-server-transaction-log.html](http://www.databasedesign-resource.com/sql-server-transaction-log.html)以获取完整说明。有办法缩小事务文件；例如，请参阅[http://support.microsoft.com/kb/873235](http://support.microsoft.com/kb/873235)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-05T20:34:34.590

LDF 是事务日志。它会记录对数据库所做的一切以用于回滚。

您不想删除，但可以使用`dbcc shrinkfile`命令将其缩小。您还可以在 SQL Server Management Studio 中右键单击数据库，然后转到任务 > 收缩。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T20:33:38.303

ldf保存了db的日志，当然不会保存任何真实的数据，但是对于数据库的正常运行是非常重要的。

但是，您可以将数据库的日志模型更改为简单，这样该日志就不会增长太快。

例如检查[这个。](http://weblogs.asp.net/jgalloway/archive/2006/12/17/sql-server-recovery-model-selection-or-what-s-this-3gb-ldf-file.aspx)

[在这里](http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/q256/6/50.asp&NoWebContent=1)查看以供参考。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-29T19:56:31.283

LDF 代表“日志数据库文件”，它是事务日志。它会记录对数据库所做的一切以用于回滚，即使您丢失了 .msf 文件，您也可以恢复数据库，因为它包含所有控制信息和事务信息。

# html - Internet Explorer 忽略 CSS 中设置的非常小的高度

> ID：826798
> 
> 赞同：2
> 
> 时间：2009-05-05T20:33:21.923
> 
> 标签：html, css, internet-explorer

我有看起来像这样的CSS...

```
.ColorSeparatorArea
{
    background-color: #3d3d77;
    height: 1px;
} 
```

...然后我将该样式应用于 DIV 元素：

```
<div class="ColorSeparatorArea"></div> 
```

它在非 IE 浏览器中工作正常，但在 IE 中，它将 div 的高度设置为一行文本的高度，它不会让我变得更小。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T20:35:00.000

```
.ColorSeparatorArea
{
    background-color: #3d3d77;
    height: 1px;
    overflow: hidden;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T20:48:36.303

这不是更好，更语义化吗？

```
<hr /> 
```

.

```
hr
{
    border: 1px solid #3d3d77;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T20:42:05.303

如果高度低于默认行高，则需要指定行高。

```
.ColorSeparatorArea
{
    background-color: #3d3d77;
    height: 1px;
    line-height: 1px;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T20:35:22.310

还要设置`font-size`样式：

```
font-size: 1px; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T20:58:50.100

`<div>`我记得IE 中的间距/分隔符也有类似的问题。我发现[这个页面](http://archivist.incutio.com/viewlist/css-discuss/39150)对我有帮助。我使用的解决方案是在 中放置一个空注释`<div>`，即

```
<div class="ColorSeparatorArea"><!-- --></div> 
```

这似乎是一件奇怪的事情，但它确实有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T20:44:37.280

根据 Internet Explorer 的版本，它会使用高度，就好像它是最小高度一样，并且会增大框，但感觉就像增大框一样大。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T22:15:10.307

在该 div 中粘贴一个不间断空格（ ），将字体大小（可能还有行高）设置为 1px，它应该没问题。

# ruby-on-rails - 路由 Rails form_for 的问题

> ID：826809
> 
> 赞同：1
> 
> 时间：2009-05-05T20:36:14.133
> 
> 标签：ruby-on-rails

我有一个表格，用于尝试更新“事物”上的字段，但是，我遇到了很多问题，这可能是愚蠢的。

我的代码如下：

```
<% form_for :thing, :url => { :action => "update" } do |f| %>
    <%= f.collection_select :status_id, Thing.statuses, :first, :last %>
    <%= f.submit 'Submit' %>
<% end %> 
```

这对我来说看起来是正确的（@thing 确实存在 BTW），但是，当我提交时，我得到了

```
Unknown action
No action responded to 145 
```

等等等等等等。 URL 是[http://localhost:3000/things/145](http://localhost:3000/things/145)。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T20:54:40.763

使用 RESTful 路由，在识别到请求`update`时触发操作。`put`您可能只需要将方法指定为 html 选项：

```
form_for :thing, :url => { :action => "update" }, :html => { :method => 'put' } do |f| 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T22:12:04.090

如果您使用的是 RESTful 路由（我假设您是），您可以这样做：

```
<% form_for @thing do |f| %>
  <%= f.collection_select :status_id, Thing.statuses, :first, :last %>
  <%= f.submit 'Submit' %>
<% end %> 
```

这将根据是否`@thing`为 ​​a指向正确的操作`new_record?`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T20:43:12.243

我有点鄙视 ActionView，所以我总是生疏，但请尝试

```
<% form_for :thing, :url => 
     url_for(:action => "update", :id => @thing) do |f| %> 
```

我相信其他人可以想出一些更干燥和更清洁的东西。

# javascript - jquery.ui 可排序问题

> ID：826810
> 
> 赞同：4
> 
> 时间：2009-05-05T20:36:37.407
> 
> 标签：javascript, jquery, jquery-ui

我创建了一个具有拖放功能的嵌套列表。我的问题是我希望每个嵌套都自行排序。例如：

```
-第一级
-第一级
 -第二级
 -第二级
-第一级

```

“一级”不能进入“二级”，反之亦然。我以为我可以使用遏制选项来做到这一点，但那里没有骰子。它适用于将第二层保持在第一层之外，但反之则不行。

这是我的示例 JS 和列表：

```
$("#sort_list").sortable({
  containment: '#sort_list',                                             
  axis: 'y',
  revert: true,
  items: 'li',
  opacity: 0.8
});
$(".sub_list").sortable({ 
  containment: 'parent',
  axis: 'y',
  revert: true,
  items: 'li',
  opacity: 0.8,
});
$("#sort_list").disableSelection();

<ul id="sort_list">
  <li>one</li>
  <li>two
    <ul class="sub_list">
    <li>sub one</li>
    <li>sub two</li>
    </ul>
  </li>
  <li>three</li>
  <li>four</li>
</ul> 
```

有任何想法吗？多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T21:07:53.277

尝试为包含选项提供一个复杂的选择器，例如：

```
$("#sort_list").sortable({
  containment: '#sort_list:not(.sub_list)',                                                                                     
  axis: 'y',
  revert: true,
  items: 'li',
  opacity: 0.8
}); 
```

如果您使用的是 jQuery 1.3+，那**应该可以解决问题：**

（来自[手册](http://docs.jquery.com/Selectors/not)）

> 从 jQuery 1.3 开始，:not() 还支持用逗号分隔的选择器和复杂的选择器，例如：:not(div a) 和 :not(div,a)。

jQuery Sortable 手册说[包含](http://docs.jquery.com/UI/Sortable#option-containment)选项：

> 将拖动限制在指定元素的范围内 - 可以是 DOM 元素、“父”、“文档”、“窗口”或 jQuery 选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T03:18:42.887

好的，看来我发现了问题。我在声明：items:'li'，因此它没有将 UL 检测为容器/可分类项目。非常感谢 karim79 帮助我思考这一切 :)

下面是工作代码（基本上是说“每个人都呆在自己的容器里”）：

```
 $("#sort_list").sortable({
      containment: 'parent',                                                                                     
      axis: 'y',
      revert: true,
      opacity: 0.8
    });
    $(".sub_list").sortable({ 
      containment: 'parent',
      axis: 'y',
      revert: true,
      opacity: 0.8,
    });
    $("#sort_list").disableSelection();

    <ul id="sort_list">
      <li>one</li>
      <li>two
        <ul class="sub_list">
        <li>sub one</li>
        <li>sub two</li>
        </ul>
      </li>
      <li>three</li>
      <li>four</li>
    </ul> 
```

现在我们已经解决了“item: li”的问题，我们甚至可以从顶部列表中删除包含：“父级”，而不必担心列表冲突。

# python - 按公共列组合 2 个 .csv 文件

> ID：826812
> 
> 赞同：8
> 
> 时间：2009-05-05T20:36:44.443
> 
> 标签：python, shell, join, csv, debian

我有两个 .csv 文件，其中文件 1 中的第一行是：

```
MPID,Title,Description,Model,Category ID,Category Description,Subcategory ID,Subcategory Description,Manufacturer ID,Manufacturer Description,URL,Manufacturer (Brand) URL,Image URL,AR Price,Price,Ship Price,Stock,Condition 
```

文件 2 的第一行：

```
Regular Price,Sale Price,Manufacturer Name,Model Number,Retailer Category,Buy URL,Product Name,Availability,Shipping Cost,Condition,MPID,Image URL,UPC,Description 
```

然后每个文件的其余部分都充满了信息。

如您所见，两个文件都有一个名为 MPID 的公共字段（文件 1：col 1，文件 2：col 9，其中第一个 col 是 col 1）。

我想创建一个新文件，通过查看此列来组合这两个文件（如：如果两个文件中都有一个 MPID，那么在新文件中，这个 MPID 将与文件 1 中的行一起出现及其来自文件 2) 的行。如果一个 MPID 只出现在一个文件中，那么它也应该进入这个组合文件。

文件未以任何方式排序。

如何在带有 shell 脚本或 python 的 debian 机器上执行此操作？

谢谢。

编辑：除了分隔字段的文件之外，这两个文件都没有逗号。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-05T20:43:30.010

```
sort -t , -k index1 file1 > sorted1
sort -t , -k index2 file2 > sorted2
join -t , -1 index1 -2 index2 -a 1 -a 2 sorted1 sorted2 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-05T20:46:06.167

这是经典的“关系连接”问题。

你有几种算法。

*   嵌套循环。您从一个文件中读取以选择“主”记录。您阅读了整个其他文件，找到了与主文件匹配的所有“详细”记录。这是一个坏主意。

*   排序合并。您根据公共密钥将每个文件排序为临时副本。然后，您通过从主文件读取然后从详细信息中读取所有匹配的行并写入合并的记录来合并这两个文件。

*   抬头。您将其中一个文件完全读入内存中的字典，由键字段索引。这对于详细文件来说可能很棘手，每个键都有多个子文件。然后您读取另一个文件并在字典中查找匹配的记录。

其中，排序合并通常是最快的。这完全是使用 unix [sort](http://www.manpagez.com/man/1/sort/)命令完成的。

查找实现

```
import csv
import collections

index = collections.defaultdict(list)

file1= open( "someFile", "rb" )
rdr= csv.DictReader( file1 )
for row in rdr:
    index[row['MPID']].append( row )
file1.close()

file2= open( "anotherFile", "rb" )
rdr= csv.DictReader( file2 )
for row in rdr:
    print row, index[row['MPID']]
file2.close() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T20:42:15.023

您需要查看`join`shell 中的命令。您还需要对数据进行排序，并且可能会丢失第一行。如果任何数据包含逗号，则整个过程将失败。或者，您将需要使用 CSV 敏感的过程来处理数据，该过程引入了不同的字段分隔符（可能是 control-A），您可以使用它来明确拆分字段。

另一种方法是使用 Python，将这两个文件读入一对字典（在公共列上键入），然后使用循环覆盖两个字典中较小字典中的所有元素，在另一个字典中查找匹配值. （这是基本的嵌套循环查询处理。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:41:46.177

您似乎正在尝试在 shell 脚本中执行此操作，这通常使用 SQL 服务器完成。是否可以将 SQL 用于该任务？例如，您可以将这两个文件导入 mysql，然后创建一个连接，然后将其导出为 CSV。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T21:00:33.200

你可以看看我的 FOSS 项目[CSVfix](http://code.google.com/p/csvfix/)，它是一个用于处理 CSV 文件的流编辑器。除了其他功能外，它还支持连接，并且不需要使用脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-21T23:10:25.170

对于基于一个或多个公共列合并多个文件（甚至 > 2），python 中最好和最有效的方法之一是使用“brewery”。您甚至可以指定需要考虑合并哪些字段以及需要保存哪些字段。

```
import brewery
from brewery
import ds
import sys

sources = [
    {"file": "grants_2008.csv",
     "fields": ["receiver", "amount", "date"]},
    {"file": "grants_2009.csv",
     "fields": ["id", "receiver", "amount", "contract_number", "date"]},
    {"file": "grants_2010.csv",
     "fields": ["receiver", "subject", "requested_amount", "amount", "date"]}
] 
```

创建所有字段的列表并添加文件名以存储有关数据记录来源的信息。通过源定义并收集字段：

```
for source in sources:
    for field in source["fields"]:
        if field not in all_fields:

out = ds.CSVDataTarget("merged.csv")
out.fields = brewery.FieldList(all_fields)
out.initialize()

for source in sources:

    path = source["file"]

# Initialize data source: skip reading of headers
# use XLSDataSource for XLS files
# We ignore the fields in the header, because we have set-up fields
# previously. We need to skip the header row.

    src = ds.CSVDataSource(path,read_header=False,skip_rows=1)

    src.fields = ds.FieldList(source["fields"])

    src.initialize()

    for record in src.records():

   # Add file reference into ouput - to know where the row comes from
    record["file"] = path

        out.append(record)

# Close the source stream

    src.finalize()

cat merged.csv | brewery pipe pretty_printer 
```

# c# - C# 类命名约定：是 BaseClass 还是 ClassBase 还是 AbstractClass

> ID：826821
> 
> 赞同：126
> 
> 时间：2009-05-05T20:39:42.203
> 
> 标签：c#, naming-conventions, base-class

命名基类的推荐方法是什么？是用“ **Base** ”或“ **Abstract** ”作为类型名称的前缀还是我们只是用“Base”作为后缀？

考虑以下：

类型：`ViewModel`例如*MainViewModel*，*ReportViewModel*

基类：`BaseViewModel`或`ViewModelBase`或`AbstractViewModel`

还要考虑：

类型：`Product`例如*VirtualProduct* , *ExpiringProduct*

基类：`BaseProduct`或`ProductBase`或`AbstractProduct`

你觉得哪个更标准？

```
class Entity : EntityBase
{
} 
```

或者

```
class Entity : BaseEntity
{
} 
```

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-05-05T20:48:50.530

框架中有一些带有 Base 后缀的示例，`System.Configuration.Provider.ProviderBase`例如`System.Web.SessionState.SessionStateStoreProviderBase`.

但绝不是框架中的所有抽象基类都遵循这个约定（例如`System.Data.Common.DbParameter`, `System.Data.Common.DbCommand`）。

就我个人而言，我会避免使用后缀*，除非*我想强调它是一个抽象类这一事实，并且认为否则该类的用户可能希望该名称表示具体实现。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-05-05T20:44:02.927

以上都不是。考虑你的基类提供什么目的；把它命名为。例如，汽车和自行车的基类可以是车辆。

如果您创建基类只是为了拥有一个类的基类，并且没有其他目的或理由，那么您可能做错了什么。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-05T20:57:27.590

如果您在谈论虚拟基类，Microsoft 的标准是 ClassnameBase（如 CollectionBase。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T20:44:12.973

我们使用 BaseEntity，但我认为这是您自己的偏好。我经常看到另一个。

只要在您的上下文中保持一致，无论是您的项目、命名空间还是您的团队（如果可能）。恕我直言，不同的约定比糟糕的约定更糟糕。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-09T14:45:06.663

我认为这是一个选择问题。我会说，如果您要创建很多基类，那么最好始终使用 BaseClassname，因为这样您总是可以通过键入 Base 并获得其余帮助来找出可以开始使用的基类智能感知。如果你有 20 个 Base 类并且你添加 Base 作为后缀，你忘记了基类的名称是什么？您想先从 VS 创建一个类图并找出可用的基类吗？当只有一两个类时，可以将它们命名为 ClassBase。

GetItems 和 ItemsGet 函数之间的决定也是如此。我会说至少为了可读性 - 去 GetItems。遵守约定:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-05T20:45:17.167

就个人而言，我建议完全不要添加词库。您永远不知道何时必须更改代码，并且它不再是基础对象。话虽如此，我们过去也这样做过，我们在前面加上了 Base 这个词。它似乎流动得更好。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-05T20:53:00.520

BaseEntity 看起来很像驼峰式案例 - strName、bseEntity。我会选择 EntityBase，因为它首先定义了主题，这将帮助您更快地识别它的功能。

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2009-05-05T21:33:52.667

当你命名东西时，总是考虑按字母顺序排列。我真的不喜欢查看 SQL 服务器，并且每个存储过程都被命名为 usp[something]。同样，不要过度使用 Get 和 Set 作为函数的前导名称。考虑将它们命名为 ItemsGet 或 OrderPlace，而不是 GetItems 或 PlaceOrder。

所以，一般来说，ClassnameBase / EntityBase 会是一个更好的选择。

# asp.net - Rhino Mocks中的NMocks2参数语法？

> ID：826824
> 
> 赞同：2
> 
> 时间：2009-05-05T20:40:17.040
> 
> 标签：asp.net, unit-testing, rhino-mocks

在 NMocks2 中，您可以使用之前不知道参数的方法模拟结果

```
Stub.On(aMock)
    .Method( ... )
    .WithAnyArguments()
    .Will(Return.Value( ... ); 
```

来自[NMocks2 备忘单](http://www.nmock.org/cheatsheet.html)。我的问题是，当您不关心参数时，Rhino 模拟是否有类似的机制？我想拨打类似于：

```
 object objectIDontWantToRecreate = null; // Won't be null in actuality
    object alwaysReturned = ...;
    Expect.Call(mockObject.Method(objectIDontWantToRecreate)).Return(alwaysReturned); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T20:47:54.963

肯定有：

```
Expect.Call(mockObject.Method(null)).IgnoreArguments().Return(alwaysReturn) 
```

# c# - 使用 Mapserver 的 C# MapScript 的动态地图图层

> ID：826851
> 
> 赞同：0
> 
> 时间：2009-05-05T20:47:39.923
> 
> 标签：c#, maps, mapserver

我正在开发一个网络应用程序，它将在地图中显示项目的位置。我有这个功能将我想要显示的数据添加到地图图层。

```
protected void AgregarPunto(DataTable result)
{
    layerObj thislayer = util.MSMap.getLayerByName("poi");

    foreach (DataRow dr in result.Rows)
    {
        shapeObj shp = new shapeObj(mapscript.MS_SHP_POINTM);
        shp = shapeObj.fromWKT(dr["the_geom"].ToString());

        thislayer.addFeature(shp);
    }
} 
```

这是来自#mapserver IRC 频道的人的建议。但它不起作用！有人可以帮忙弄清楚为什么没有显示这些点吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-23T11:22:55.420

您是否为您的图层创建了 classObj 和 styleObj ？

这是我的代码示例：

```
myLayer.type = OSGeo.MapServer.MS_LAYER_TYPE.MS_LAYER_LINE;
myLayer.status = 1;
myLayer.symbolscaledenom = 1; 

// Create a mapping class
OSGeo.MapServer.classObj myClass = new OSGeo.MapServer.classObj(myLayer);

// Create a style
OSGeo.MapServer.styleObj style = new OSGeo.MapServer.styleObj(myClass);

// unitColor = new Color(12, 34, 56);
int red = Convert.ToInt32(unitColor.R);
int green = Convert.ToInt32(unitColor.G);
int blue = Convert.ToInt32(unitColor.B);

style.color.setRGB(red, green, blue);

style.outlinecolor.setRGB(255, 255, 255);
//style.symbol = _map.symbolset.index("circle");  // Here '_map' is an instance of mapObj, this line is not strictly necessary 

style.size = 10;
style.minsize = 3; // Change this to your needs 
```

# asp.net-mvc - ASP.NET MVC：在数据输入表单中搜索

> ID：826852
> 
> 赞同：4
> 
> 时间：2009-05-05T20:47:40.673
> 
> 标签：asp.net-mvc

并感谢您的阅读。

我正在构建一个数据输入表单。我试图找出一种方法让用户提供标准（例如姓氏），在员工表中搜索符合标准的所有员工，以他们可以选择正确员工的方式显示结果，然后通过将该员工的 ID 返回到数据输入表单，以便他们完成记录并保存。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T21:45:20.987

一种方法是使用 jQuery[自动完成](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)插件。在表单上有一个允许搜索的文本框和一个存储 id 的隐藏字段。通过 AJAX 使用自动完成功能来获取基于搜索条件以 JSON 形式返回的名称/ID 对列表。设置自动完成以强制从列表中进行选择——这将禁止该字段中出现任何不匹配的文本。当用户从列表中选择一个项目时，结果函数将关联的 id 存储在隐藏字段中。使用表单帖子上的隐藏字段来获取员工的 ID。

它可能看起来像：

看法

```
$('#searchBox').autocomplete( '/Employees/Search', {
    dataType: 'json',
    max: 25,
    minChars: 2,
    cacheLength: 1,
    mustMatch: true,
    formatItem: function(data,i,max,value) {
        return value;
    },
    parse: function(data) {
        var array = new Array();
        for (var i=0; i < data.length; i++) {
            var datum = data[i];
            var display = datum.FirstName + ' ' + datum.LastName;
            array[array.length] = { data: datum, value: display, result: display };
        }
    }
});

$('#searchBox').result( function(event, data, formatted) {
    if (data) {
       $('#employeeID').val( data.EmployeeID );
    }
});

$('form').submit( function() {
    if (!$('#employeeID').val()) {
       alert( 'You must select an employee before clicking submit!' );
       return false;
    }
});

<input type='text' id='searchBox' />
<input type='hidden' id='employeeID' name='employeeID' /> 
```

控制器：

```
public ActionResult Search( string q, int limit )
{
    var query = db.Employees.Where( e => e.LastName.StartsWith( q ) )
                            .OrderBy( e => e.LastName )
                            .Select( e => new
                                 {
                                     FirstName = e.FirstName,
                                     LastName = e.LastName,
                                     EmployeeID = e.EmployeeID
                             });
    if (limit > 0)
    {
        query = query.Take(limit);
    }

    return Json( query.ToList() );
}

public ActionResult SomeAction( int employeeID, ... )
{
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T20:53:02.377

我建议使用 Linq。

考虑 Scott Gu 的示例博客......

[http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)

```
public static void GetEmployeeIDByLastName(string lastName)
{

DataContext dc = new DataContext();

var queryResult = from q in dc.Employee
            where q.EmployeeLastName.Equals(lastName)
            select new {
                EmployeeID = q.EmployeeID
                      }

foreach(var empID in queryResult)
        {
             //pass the empID value back to the display
        }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T21:10:19.590

在控制器中这样的东西在数据库中搜索（使用linq）？

```
public ActionResult searchEmployees(string searchString) {
        var employees = (from e in db.Employees
                               where e.Name.Contains(searchString)
                               orderby e.Name
                               select e);
        return view("SearchResult", employees);
} 
```

编辑：只需阅读您的评论，如果我理解正确，您只对 id 感兴趣。您是否在 javascript 中使用它们，这是某种 ajax 调用吗？在这种情况下，您可能希望返回一个数组或一个 csv 字符串并处理 javascript 调用中的 id。

# actionscript - 这些变量如何被初始化？

> ID：826859
> 
> 赞同：0
> 
> 时间：2009-05-05T20:51:40.913
> 
> 标签：actionscript, red5

以下代码是从 red5 中提取的样本的组合。基本上，我正在尝试将实时流订阅者与基于共享对象的聊天框结合起来。我不是闪存开发人员，对这里发生的事情的理解非常有限。

```
// ** AUTO-UI IMPORT STATEMENTS **
import org.red5.utils.Connector;
import org.red5.samples.simplechat.BasicChat;
// ** END AUTO-UI IMPORT STATEMENTS **
import com.neoarchaic.ui.Tooltip;
import org.red5.net.Stream;
//import org.red5.utils.Delegate;
import com.blitzagency.xray.util.XrayLoader;

class org.red5.samples.livestream.subscriber.Main extends MovieClip {
// Constants:
    public static var CLASS_REF = org.red5.samples.livestream.subscriber.Main;
    public static var LINKAGE_ID:String =     "org.red5.samples.livestream.subscriber.Main";
// Public Properties:
// Private Properties:
private var stream:Stream;
private var cam:Camera;
// UI Elements:

// ** AUTO-UI ELEMENTS **
    private var connector:Connector;
    private var publish_video:Video;
    private var chat:BasicChat;
// ** END AUTO-UI ELEMENTS **
    private var uri:String = "rtmpt://localhost/oflaDemo";

// Initialization:
    private function Main() {XrayLoader.loadConnector("xray.swf");}
    private function onLoad():Void { configUI(); }

// Public Methods:
// Semi-Private Methods:
// Private Methods:
    private function configUI():Void 
    {
        // setup the tooltip defaults
    Tooltip.options = {size:10, font:"_sans", corner:0};
    // setup cam
    cam = Camera.get();
    // get notified of connection changes
    connector.addEventListener("connectionChange", this);

    // set the uri
    Connector.red5URI = uri;

    // initialize the connector
    connector.configUI();
    connector.makeConnection();
}

private function connectionChange(evtObj:Object):Void
{       

    if(evtObj.connected) 
    {
        // setup stream
        // XXX: odd hack needed for flashIDE.
        var conn = evtObj.connection; 
        var x = new Stream(conn);
        stream = x;
        stream.play("red5StreamDemo", -1);
        publish_video.attachVideo(stream);
        trace(chat);
        // register the NetConnection that GlobalObject will need
        chat.registerConnection(conn);

        // connect the shared object
        chat.connectSO();
    }
}

} 
```

我认为它`var chat`不会在任何地方被初始化为`trace(chat)`打印“未定义”。然而`var connector`，`var publish_video`似乎从舞台上收集他们的实例。

此示例代码包括这两个并且工作正常，但我不能让我的添加行为相同。

我在舞台上添加了一个 BasicChat 实例（我正在使用 Flash CS4），并且在过去的许多小时中都在使用它的各种属性、图层和分组，但无济于事。

谁能建议我为什么`var chat`不从舞台上收集它的实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T20:58:16.467

您是否设置了 BasicChat 阶段实例的实例名称？它应该设置为“聊天”。要设置它，请单击阶段实例并在“属性”面板中找到实例名称字段（第一个/顶部可见字段）。

# c# - 无法理解 C# 中的用户控件

> ID：826861
> 
> 赞同：3
> 
> 时间：2009-05-05T20:52:12.033
> 
> 标签：c#, user-controls, design-principles

我是用户控件的新手，到目前为止只创建了一个，所以请耐心等待。我今天一直在阅读，用户控件应该是自包含的，不依赖于父容器中的任何信息。我明白了那部分，但我无法理解的是围绕该原则设计我的程序的“正确”方式。

我正在用 C# 制作一个 Web 表单，其中有一个页面，该页面中有一个用户控件。我已经在它的 ascx 文件中创建了 usercontrol 并将它拖到我的 aspx 页面中。用户控件是一对日期框和一个网格视图，用于显示 SQL 存储过程的结果。

我真的很想重用这个控件，但我不知道如何“告诉”用户控件我想为我所在的特定页面运行什么存储过程而不违反“不要依赖父容器”规则。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T20:59:11.423

不依赖父容器不代表不能交流。在父级将设置的用户控件中公开一个属性。但是有一个默认值，所以它不会崩溃。

此外，如果这是一个非常具体的控件，那么依赖父级没有理由不好。这可能并不理想，但您将使用用户控件来提供代码分离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T21:00:22.450

你的控件不需要知道它的数据来自哪里。它不需要知道存储过程或其他任何事情。它只需要知道它需要显示的数据。如果我理解您的控制权，它是一个带有一些日期过滤器的网格。它将接收数据，显示该数据并按日期过滤。没关系，它只需要知道它需要显示的数据，也许还有父级的默认开始和结束日期。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T21:23:50.757

如果您不允许用户控件与其父级通信，您将错过用户控件的真正力量。我认为在这种情况下你可能把封装做得有点过分了。

假设您有一个用户控件，它只是一个表格或各种用户数据的网格视图。不可避免地，用户控件需要知道用户的唯一标识符，以便从任何地方提取其数据，这当然会迫使您创建父页面可以设置的公共属性。

另外，请记住，有时用户控件中的操作需要触发父控件上的操作。事件委托在这里发挥了作用，它们非常有用，在我看来，它使用户控件更加有用。

只需放弃关于用户控件和父母不来回交谈的整个想法，您会发现事情变得容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:57:45.157

所以你在这个用户控件中有一些东西可以将数据绑定到存储过程返回的数据集？

这是处理它的一种方法：与其尝试将存储过程传递给用户控件，不如使用户控件依赖于用户控件的公共属性的数据集。

在运行时，用户控件之外的代码将运行适当的存储过程，并将用户控件上的数据集属性设置为存储过程返回的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-06T04:40:27.370

正如其他人所指出的，您的用户控件需要有一种标准的方式来传达其意图和行为。这并不意味着您必须拥有对容器的引用，因此知道 (MyPage.aspx) 实际包含什么。

在使用用户控件时，我发现必不可少的是事件。了解事件以及如何使用它们。事件是交流行为的好方法。

在您的示例中，我可能会将您的条件（日期文本框）拆分为自己的用户控件。创建一个继承自 EventArgs 的新类，其中包含您的条件（`DateTime`字段）。当用户单击搜索时，`EventHandler<YourEventArgs>`使用您的自定义触发一个事件（类型）`EventArgs`。该页面将处理事件，查询数据库，然后将结果传递给您的第二个用户控件上的公共或内部方法，该方法显示记录。

这里的关键，如果您需要调用不同的存储过程，您的标准控件可以在不同的页面上重用。想想插入与更新场景。很多时候，UI 元素是相同的。您可以创建一个控件并在具有两种不同行为（AddRecord.aspx 和 UpdateRecord.aspx）的两个不同页面上使用它。此外，显示记录的控件很容易重用。

一个巨大的好处是您的页面和控件变得相当小。每个控件/页面实际上只关心其一小部分功能。您的代码将变得不那么令人生畏并且更易于维护。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-06T04:43:41.980

> “告诉”用户控件我想运行什么存储过程

听起来您正在寻找事件/委托
让控件公开一个事件，并让父级添加一个处理程序（也许在构造函数中，如果您想强制它添加一个且只有一个事件）
或者，您可以使用 Command /策略模式 - 让父封装方法，并将封装对象发送到其构造函数中的控件。

# asp-classic - 在经典 ASP/VBScript 应用程序中通过 LDAP 访问员工 ID

> ID：826862
> 
> 赞同：4
> 
> 时间：2009-05-05T20:52:32.300
> 
> 标签：asp-classic, vbscript, ldap

我有一个旧的 ASP/VBScript 应用程序，我正在维护/升级它，它目前使用旧的/折旧的方法来收集配置文件信息 - 如下所示：

```
strNTUser = Request.ServerVariables("AUTH_USER")
strNTUser = replace(strNTUser, "\", "/")
Set strNTUserInfo = GetObject("WinNT://"+strNTUser)
'You get the idea' 
```

当我只需要全名和描述时，这很好。现在我需要访问一些额外的配置文件信息，但我需要使用 LDAP 而不是 WinNT。我一直在谷歌搜索，直到我失明，但对于我的生活，我似乎无法通过 LDAP 连接并获取我需要的信息。

我需要做什么才能根据 AUTH_USER 获取名字、姓氏和员工 ID？

**更新**：我从一开始就认为需要 ADSI 或一些类似的接口，但我显然是一个 ADIdiot 并且从我在 MSDN 或 TechNet 上找到的任何内容中都没有得到任何有用的提示——更不用说帮助了。更明确的帮助会很好......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T22:00:27.227

我敢肯定，这样做可能有一种更有效的方法，但这是我经过多次搜索、尝试和咬牙切齿后最终使用的代码......

```
Dim strNTUser, strUser, strDN, strRootTDSE
Dim objRootDSE, objConnection, objCommand, objRecordSet, objUser, objNTUserInfo

strNTUser = Request.ServerVariables("AUTH_USER")
strUser = Mid(strNTUser,(instr(1,strNTUser,"\")+1),len(strNTUser))

Set objConnection = Server.CreateObject("ADODB.Connection")
Set objCommand = Server.CreateObject("ADODB.Command")
objConnection.Provider = "ADsDSOObject"
objConnection.Open "Active Directory Provider"
Set objCommand.ActiveConnection = objConnection

'objCommand.Properties("Page Size") = 1000'
objCommand.Properties("Searchscope") = 2 'ADS_SCOPE_SUBTREE 

Set objRootDSE = GetObject("LDAP://rootDSE")
strRootTDSE = objRootDSE.Get("defaultNamingContext")
Set objRootDSE = Nothing

objCommand.CommandText = _
    "SELECT distinguishedName FROM 'LDAP://" & strRootTDSE & "' " & _
        "WHERE objectCategory='user' AND sAMAccountName = '" & strUser & "'" 

Set objRecordSet = objCommand.Execute

If Not objRecordSet.BOF Then objRecordSet.MoveFirst
If Not objRecordSet.EOF Then
    strDN = objRecordSet.Fields("distinguishedName").Value
End If

Set objConnection = Nothing
Set objCommand = Nothing
Set objRecordSet = Nothing

Set objUser = GetObject("LDAP://" & strDN)
'I can now use objUser to get the details' 
```

我很乐意接受任何重构的代码，这也是我现在必须将站点降低到“基本身份验证”以使其正常工作的原因。

附带说明一下，我尝试尽可能少地进行硬编码，以便可以将其发送回我从中获得原始代码的开源项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:10:02.570

在这种情况下，您应该使用[ADSI](http://msdn.microsoft.com/en-us/library/aa772170.aspx)连接到目录提供程序 (LDAP)。[这是一个](http://msdn.microsoft.com/en-us/library/aa705944(VS.85).aspx)经典 ASP 的示例。

# delphi - Delphi：检测窗口移动的开始和结束

> ID：826863
> 
> 赞同：9
> 
> 时间：2009-05-05T20:52:32.830
> 
> 标签：delphi, window

我正在为一些简单的动画使用 OnIdle 事件，它工作正常。然而，问题是当用户开始移动或调整窗口大小时，OnIdle 事件会停止触发，直到移动/调整大小操作完成。

我需要检测何时发生这种情况，以便我可以暂停所有动画。但是如何检测窗口的移动？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-06T08:36:49.063

我会选择*mghie*评论：使用动画计时器，并使用消息处理程序激活/停用它。

在您的情况下，您可能需要添加以下消息处理程序：

```
//fired when starting/ending a "move" or "size" window
procedure WMEnterSizeMove(var Message: TMessage) ; message WM_ENTERSIZEMOVE;
procedure WMExitSizeMove(var Message: TMessage) ; message WM_EXITSIZEMOVE;

  procedure TForm.WMEnterSizeMove(var msg: TMessage);
  begin
    AnimationTimer.Enabled := false;
    inherited;
  end;

  procedure TForm.WMExitSizeMove(var msg: TMessage);
  begin
    AnimationTimer.Enabled := true;
    inherited;
  end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T21:05:15.670

我还没有尝试过，但我想说你可能会使用 WM_WINDOWPOSCHANGING 来判断窗口何时被移动。 [http://msdn.microsoft.com/en-us/library/ms632653(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms632653(VS.85).aspx)

德尔福代码将是：

```
TSomeForm = class(TForm)
protected
  ...
  procedure WindowPosChanging(var Msg : TMessage); message WM_WINDOWPOSCHANGING;
  ...
end; 
```

# git - 将 SVN 结帐转换为使用 git (git-svn)

> ID：826865
> 
> 赞同：32
> 
> 时间：2009-05-05T20:52:48.210
> 
> 标签：git, svn, git-svn, git-checkout, svn-checkout

我使用保存在 svn 中的软件进行版本控制。我想使用 git (git-svn) 但是该软件需要大量设置和配置才能使用。有一些工具可以处理所有设置，包括通过 svn 检查所有代码。

git-svn 的所有文档（我已经能够找到）都需要使用 git-svn 重新结帐。

有没有办法转换现有的 svn checkout 以便它可以使用 git-svn？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-05T20:59:14.933

不，一个 git-svn 克隆将整个存储库转换为 git。SVN 签出没有整个存储库，因此无法从中克隆。这是从 SVN 或 CVS 切换到分布式系统（如 git）的主要优势。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-06T02:15:47.403

你可以这样做：

1.  使用 git-svn 将 SVN 树完全克隆到一个临时目录。确保使用与现有结帐完全相同的版本。
2.  将“.git”文件夹从 git-svn checkout 的顶层移动到 SVN checkout 的顶层。
3.  然后你要么需要告诉 Git 忽略“.svn”目录，要么你可以将它们全部删除。
4.  删除 git-svn 结帐。
5.  在那里，现在您可以使用 Git 和 git-svn 操作现有文件。
6.  做一个“git status”，希望它说没有变化。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-08T17:21:42.243

我假设您可能想保留历史记录。但是，如果您（或任何其他偶然发现此页面的人）不需要历史记录，您可以使用此处解释的“导出”功能：[https](https://stackoverflow.com/a/419475/2437521) ://stackoverflow.com/a/419475/2437521 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-31T11:08:22.040

另一种不修改原始 Subversion 工作副本且不需要您复制它的方法是使用补丁：

1.  使用 git-svn 将您的 Subversion 树完全克隆到一个新目录，该目录将成为 Git 存储库。确保使用与现有结帐完全相同的版本。您可以`git reset --hard :/r<revision>`在克隆后使用它来强制它是相同`<revision>`的修订版，Subversion 工作副本更新到的修订版在哪里（参见这里使用`svn info`）。
2.  `cd`到您的 Subversion 工作副本。
3.  用于`svn status`确保所有新文件都标有`A`（或用于`svn add`添加），并且所有已删除的文件都标有`D`（或用于`svn rm`删除它们）。
4.  运行`svn diff >patch.diff`以创建补丁文件。
5.  复制`patch.diff`到之前创建的 Git 存储库的顶部。
6.  `cd`到之前创建的 Git 存储库的顶部。
7.  运行`git apply -p0 patch.diff`以将补丁应用到 Git 存储库的工作树上。

现在您可以使用`git status`, 和`git add`/`git commit`它们浏览更改以将它们保存在本地存储库中。

# c++ - 为什么我的程序在 nVidia NView 下会消耗 100% CPU？

> ID：826870
> 
> 赞同：0
> 
> 时间：2009-05-05T20:53:16.620
> 
> 标签：c++, windows, nvidia

我最近正在开发一个 Windows 程序，该程序在生产环境中滚动浏览大量项目时有时会变得无响应。当然，它在我的桌面上运行良好。生产环境是：

*   基于 Windows XP 的工作站，带 2 个显示器
*   启用 nView 的 nVidia 视频驱动程序

值得注意的是进程终止时生成的 Dr watson 堆栈跟踪：

```
线程 ID 0xef4 的状态转储

eax=00e3fff8 ebx=000000a0 ecx=00e00000 edx=00000000 esi=0003fff8 edi=00e40000
eip=00b920c2 esp=0012bcac ebp=00000000 iopl=0 nv up ei ng nz na pe cy
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00000283

\system32\nview.dll -
功能：nview!NVLoadDatabase
        00b920a8 c80b0600 输入 0x60b,0x0
        00b920ac 83c30f 添加 ebx,0xf
        00b920af 33f6 xor esi,esi
        00b920b1 03f9 添加 edi,ecx
        00b920b3 83e3f8 和 ebx,0xfffffff8
        00b920b6 3bcf cmp ecx,edi
        00b920b8 89742414 mov [esp+0x14],esi
        00b920bc 734c jnb nview!NVLoadDatabase+0xcaf (00b9210a)
        00b920be 8bc1 移动 eax,ecx
        00b920c0 8b10 移动 edx,[eax]
        00b920c2 8b4004 移动 eax,[eax+0x4] ds:0023:00e3fffc=00000000
        00b920c5 89442414 mov [esp+0x14],eax
        00b920c9 8bc2 移动 eax,edx
        00b920cb 2500000001 和 eax,0x1000000
        00b920d0 33ed xor ebp,ebp
        00b920d2 0bc5 或 eax,ebp
        00b920d4 7414 jz nview!NVLoadDatabase+0xc8f (00b920ea)
        00b920d6 8bc2 移动 eax,edx
        00b920d8 c1e008 shl eax,0x8
        00b920db 8be8 移动 ebp,eax
        00b920dd c1f81f sar eax,0x1f

ChildEBP RetAddr Args to Child              
00000000 00000000 00000000 00000000 00000000 nview!NVLoadDatabase+0xc67

```

为什么这个问题只在生产中出现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T20:55:14.413

这很有趣，因为 nView 是 NVidia 提供的第 3 方 DLL。互联网上的`nview!NVLoadDatabase`帖子表明 nview 存在未修补的缺陷。正如这些报告所证实的，资源管理器使用 100% CPU 的事实支持了这一点。见： http: [//forums.nvidia.com/lofiversion/index.php?t36879.html](http://forums.nvidia.com/lofiversion/index.php?t36879.html)

此网站上提供了对此问题的详细调查：http: [//blogs.technet.com/marcelofartura/archive/2007/02/28/real-case-random-apps-running-100-cpu.aspx](http://blogs.technet.com/marcelofartura/archive/2007/02/28/real-case-random-apps-running-100-cpu.aspx)

根据本文，挂起是由于 nview.dll 中的无限循环。尽管在线描述的汇编指令和寄存器值与我们的日志中的不完全匹配，但它们足够接近，我可以得出结论，这是同一个问题。

为了解决这个问题，我禁用了 nView 桌面管理器（右键单击桌面，选择 nView 属性，然后在 nView 桌面管理器组合框中单击禁用）。在这样做之前，我能够始终如一地重现挂起。但是，禁用 nView 后，我无法重现挂起。因此，这似乎是一种可行的解决方法。

不管怎样，我把它贴在这里，以防它对任何人有用。追赶这个让我很伤心。

# .net - ORM 和构造函数

> ID：826872
> 
> 赞同：4
> 
> 时间：2009-05-05T20:54:42.090
> 
> 标签：.net, orm

我正在查看 .NET ORM 实现，我有一个重要的问题 - 是否有任何 .NET ORM 实现不需要数据库中每个字段的公共属性？当我看到这样的例子[时](https://web.archive.org/web/20090831053827/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/04/01/your-first-nhibernate-based-application.aspx)，我的脑海中响起了一个小铃铛。我**坚信**封装，并且被迫打开我的对象的和服只是为了让它们与持久性框架很好地工作，这让我很高兴。那里的所有 ORM 都需要这种可访问性吗？如果没有，*请*指出那些不需要它的例子！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T21:28:58.780

NHibernate 支持类成员的多种访问策略。公共属性是事实上的默认值，但您可以告诉 NHibernate 直接访问您的类的字段。

例如

```
<property name="CustomerName" access="field.camelcase-underscore" /> 
```

将指示 NHibernate 在你的类中使用一个字段，声明如下：

```
protected string _customerName; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:31:24.873

实体框架也支持这一点。您可以为每个属性单独定义访问修饰符，并为 getter 和 setter 定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T12:11:41.400

Mindscape LightSpeed 只绑定到字段 - 只为您希望公开的字段添加属性（这是它工作的*唯一*方式，因为封装的明确原因）。当然，该工具将默认提供属性，但可以将其全部关闭。

[Mindscape LightSpeed O/R 映射器](http://www.mindscape.co.nz/products/lightspeed/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-12T19:13:53.270

Harper - 我对 Linq-To-SQL 的感觉几乎相同，直到我意识到这完全取决于您对 ORM 的看法……将 Linq2SQL 视为“强类型 ADO.NET 提供程序”会有所帮助...

如果您只想“快速查看”几个字段，那么 LINQ 投影将向您返回仅包含您感兴趣的字段的匿名类型。这意味着*实体类*的大小与网络无关，并且您查询的内存性能。

在光谱的另一端，DataContexts（或其他 ORM 中的 UnitOfWork）通常是您尽快使用和处置的东西。因此，它们生成的实体的角色应该被限制为仅仅是“数据持有者”。换句话说，如果您想构造复杂或*长期存在的*对象，请将它们与 LINQ 实体（即不同的类）分开设计，然后使用 L2S 来填充/实例化这些对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T21:05:43.530

您的意思是您希望将私有或受保护成员映射到数据库，而不是让它们全部公开？我用过的一种 ORM 就是[Gentle.NET](http://sourceforge.net/projects/gopf)。它很稳定，但这些天并没有真正得到很多更新。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T21:02:08.033

查看 Scott Gu 的书呆子晚餐教程。LINQ 和 MVC 允许您创建一个业务层，将 DB 对象包装在公共和私有属性中。

[http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-29T19:04:12.647

LINQ to SQL 可以绑定到私有字段，但它不*完全*支持私有无参数构造函数。

# exception - 有人在 MultiView 中使用 RadTextBox 有问题吗？

> ID：826876
> 
> 赞同：0
> 
> 时间：2009-05-05T20:56:35.970
> 
> 标签：exception, textbox, telerik, multiviews

我想在 ASP.NET 2.0 的 MultiView 中使用 Telerik RadTextBox。只需将 RadTextBox 拖到视图中并运行该页面，就会生成一个运行时错误，即“对象引用 nto set to an instance of an object”。Telerik.WebControls.RadInputControl.SaveViewState() 调用似乎正在中断。

有没有人知道如何让它发挥作用？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T21:41:33.413

在我以前的一个项目中，这恰好是 RadInput for ASP.NET 的一个问题。我从 Telerik 网站获得了最新信息，但异常消失了。

顺便说一句，我已经切换到控件的 ASP.NET AJAX 版本，并鼓励您尝试一下。它更高级，并且在页面上有许多文本框时添加了 RadInputManager 以提高性能。

迪克

# python - python中的crontab

> ID：826882
> 
> 赞同：2
> 
> 时间：2009-05-05T20:58:43.033
> 
> 标签：python, crontab

我在 python 中为某种守护程序编写代码，该守护程序必须在某个实例上按 crontab 字符串定义的时间执行特定操作。有我可以使用的模块吗？如果没有，有人可以粘贴/链接一个算法，我可以使用它来检查 crontab 定义的时间实例是否发生在上一次检查完成的时间内。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T21:08:20.530

[时间表](http://docs.python.org/library/sched.html)_

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:16:13.413

[Kronos](http://www.razorvine.net/download/kronos.py)是另一种选择。

这是一个类似的 SO [question](https://stackoverflow.com/questions/373335/suggestions-for-a-cron-like-scheduler-in-python)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T15:33:17.330

您可能想看看[pycron](http://www.kalab.com/freeware/pycron/pycron.htm)。

# django - 如何在 Django 模板中实现面包屑？

> ID：826889
> 
> 赞同：47
> 
> 时间：2009-05-05T20:59:40.520
> 
> 标签：django, django-templates

在 Google 搜索“Django 面包屑”时提供的一些解决方案包括使用模板和 block.super，基本上只是扩展基本块并将当前页面添加到其中。[http://www.martin-geber.com/thought/2007/10/25/breadcrumbs-django-templates/](http://www.martin-geber.com/thought/2007/10/25/breadcrumbs-django-templates/)

[http://www.djangosnippets.org/snippets/1289/](http://www.djangosnippets.org/snippets/1289/) - 提供一个模板标签，但如果你没有正确声明你的 urls.py，我不确定这会起作用。

我想知道最好的方法是什么？如果你之前已经实现了面包屑，你是怎么做到的？

- - 编辑 -

我的问题是：在 Django 中是否有一种普遍接受的做面包屑的方法，但是从我看到的答案中没有，并且有很多不同的解决方案，我不确定将正确答案授予谁，因为我使用了使用 block.super 方法的变体，而以下所有答案都可以。

我想这是一个过于主观的问题。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-06T18:56:55.297

*注意：我在下面提供了完整的片段，因为 djangosnippets 最近很挑剔。*

很酷，实际上有人找到[了我的](http://www.djangosnippets.org/snippets/1289/)代码片段 :-) 我的模板标签的使用相当简单。

要回答您的问题，没有用于处理面包屑的“内置”django 机制，但它确实为我们提供了下一个最好的东西：自定义模板标签。

想象一下，你想要这样的面包屑：

```
Services -> Programming
Services -> Consulting 
```

然后你可能会有几个命名的 url：“services”、“programming”、“consulting”：

```
 (r'^services/$',
     'core.views.services',
     {},
     'services'),

    (r'^services/programming$',
     'core.views.programming',
     {},
     'programming'),

    (r'^services/consulting$',
     'core.views.consulting',
     {},
     'consulting'), 
```

现在在您的 html 模板中（让我们看看咨询页面），您所要做的就是：

```
//consulting.html
{% load breadcrumbs %}

{% block breadcrumbs %}
{% breadcrumb_url 'Services' services %}
{% breadcrumb_url 'Consulting' consulting %}

{% endblock %} 
```

如果您想在面包屑中使用某种自定义文本，并且不想链接它，您可以使用**面包屑**标签。

```
//consulting.html
{% load breadcrumbs %}

{% block breadcrumbs %}
  {% breadcrumb_url 'Services' services %}
  {% breadcrumb_url 'Consulting' consulting %}
  {% breadcrumb 'We are great!' %}  
{% endblock %} 
```

在更多涉及的情况下，您可能希望包含特定对象的 id，这也很容易做到。这是一个更现实的例子：

```
{% load breadcrumbs %}

{% block breadcrumbs %}
{% breadcrumb_url 'Employees' employee_list %}
{% if employee.id %}
    {% breadcrumb_url employee.company.name company_detail employee.company.id %}
    {% breadcrumb_url employee.full_name employee_detail employee.id %}
    {% breadcrumb 'Edit Employee ' %}
{% else %}
    {% breadcrumb 'New Employee' %}
{% endif %}

{% endblock %} 
```

## DaGood 面包屑片段

提供两个模板标签以在您的 HTML 模板中使用：breadcrumb 和 breadcrumb_url。第一个允许创建简单的 url，包括文本部分和 url 部分。或仅未链接的文本（例如，作为面包屑路径中的最后一项）。第二，实际上可以使用带参数的命名 url！此外，它以标题作为第一个参数。

这是一个模板标签文件，应该进入您的 /templatetags 目录。

只需在 create_crumb 方法中更改图像的路径即可！

不要忘记在您的 html 模板顶部添加 {% load breadcrumbs %}！

```
from django import template
from django.template import loader, Node, Variable
from django.utils.encoding import smart_str, smart_unicode
from django.template.defaulttags import url
from django.template import VariableDoesNotExist

register = template.Library()

@register.tag
def breadcrumb(parser, token):
    """
    Renders the breadcrumb.
    Examples:
        {% breadcrumb "Title of breadcrumb" url_var %}
        {% breadcrumb context_var  url_var %}
        {% breadcrumb "Just the title" %}
        {% breadcrumb just_context_var %}

    Parameters:
    -First parameter is the title of the crumb,
    -Second (optional) parameter is the url variable to link to, produced by url tag, i.e.:
        {% url person_detail object.id as person_url %}
        then:
        {% breadcrumb person.name person_url %}

    @author Andriy Drozdyuk
    """
    return BreadcrumbNode(token.split_contents()[1:])

@register.tag
def breadcrumb_url(parser, token):
    """
    Same as breadcrumb
    but instead of url context variable takes in all the
    arguments URL tag takes.
        {% breadcrumb "Title of breadcrumb" person_detail person.id %}
        {% breadcrumb person.name person_detail person.id %}
    """

    bits = token.split_contents()
    if len(bits)==2:
        return breadcrumb(parser, token)

    # Extract our extra title parameter
    title = bits.pop(1)
    token.contents = ' '.join(bits)

    url_node = url(parser, token)

    return UrlBreadcrumbNode(title, url_node)

class BreadcrumbNode(Node):
    def __init__(self, vars):
        """
        First var is title, second var is url context variable
        """
        self.vars = map(Variable,vars)

    def render(self, context):
        title = self.vars[0].var

        if title.find("'")==-1 and title.find('"')==-1:
            try:
                val = self.vars[0]
                title = val.resolve(context)
            except:
                title = ''

        else:
            title=title.strip("'").strip('"')
            title=smart_unicode(title)

        url = None

        if len(self.vars)>1:
            val = self.vars[1]
            try:
                url = val.resolve(context)
            except VariableDoesNotExist:
                print 'URL does not exist', val
                url = None

        return create_crumb(title, url)

class UrlBreadcrumbNode(Node):
    def __init__(self, title, url_node):
        self.title = Variable(title)
        self.url_node = url_node

    def render(self, context):
        title = self.title.var

        if title.find("'")==-1 and title.find('"')==-1:
            try:
                val = self.title
                title = val.resolve(context)
            except:
                title = ''
        else:
            title=title.strip("'").strip('"')
            title=smart_unicode(title)

        url = self.url_node.render(context)
        return create_crumb(title, url)

def create_crumb(title, url=None):
    """
    Helper function
    """
    crumb = """<span class="breadcrumbs-arrow">""" \
            """<img src="/media/images/arrow.gif" alt="Arrow">""" \
            """</span>"""
    if url:
        crumb = "%s<a href='%s'>%s</a>" % (crumb, url, title)
    else:
        crumb = "%s&nbsp;&nbsp;%s" % (crumb, title)

    return crumb 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-01-16T11:14:58.770

Django 管理视图模块具有自动面包屑，其实现方式[如下](https://github.com/django/django/blob/stable/3.2.x/django/contrib/admin/templates/admin/base.html#L63)：

```
{% block breadcrumbs %}
    <div class="breadcrumbs">
        <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
        {% block crumbs %}
            {% if title %} &rsaquo; {{ title }}{% endif %}
        {% endblock %}
    </div>
{% endblock %} 
```

因此，对此有某种内置支持..

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T21:16:25.800

我的视图函数将面包屑作为一个简单的列表发出。

一些信息保存在用户的会话中。然而，它间接地来自 URL。

面包屑不是它们去过的地方的简单线性列表——这就是浏览器历史记录的用途。他们去过的地方的简单列表并不能成为一个好的面包屑路径，因为它没有反映任何意义。

对于我们的大多数视图功能，导航是相当固定的，并且基于模板/视图/URL 设计。在我们的案例中，有很多深入细节，面包屑反映了这种缩小——我们有一个“领域”、一个“列表”、一个“父级”和一个“子级”。它们形成了一个从一般到具体的简单层次结构。

在大多数情况下，一个定义明确的 URL 可以很容易地分解成一个很好的面包屑痕迹。实际上，这是对良好 URL 设计的一项测试—— URL 可以被解释为面包屑并有意义地显示给用户。

对于一些视图函数，我们提供的信息是“多对多”连接的一部分，例如，有两个候选父节点。URL 可能说一件事，但会话的上下文堆栈说另一件事。

出于这个原因，我们的视图函数必须在会话中留下上下文线索，以便我们可以发出面包屑。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-04T13:15:49.047

我遇到了同样的问题，最后我为它制作了简单的 django 模板标签：[https ://github.com/prymitive/bootstrap-breadcrumbs](https://github.com/prymitive/bootstrap-breadcrumbs)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-02-25T16:31:21.227

试试[django-breadcrumbs——](https://github.com/chronossc/django-breadcrumbs/)一个可插入的中间件，它在你的请求对象中添加一个可调用/可迭代的面包屑。

它支持简单视图、通用视图和 Django FlatPages 应用程序。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-05T21:46:09.097

> [http://www.djangosnippets.org/snippets/1289/](http://www.djangosnippets.org/snippets/1289/) - 提供了一个模板标签，但如果你没有正确声明你的 urls.py，我不确定这会起作用。

如果您没有`urls.py`正确申报，任何事情都不会奏效。话虽如此，它看起来不像是从`urls.py`. 事实上，看起来要正确使用该标签，您仍然需要向模板传递一些变量。好吧，这并不完全正确：间接通过标签调用的默认`url`标签。`breadcrumb`但据我所知，它甚至没有真正调用那个标签。所有出现的`url`都是本地创建的变量。

但我不是解析模板标签定义的专家。所以说在代码的其他地方它神奇地复制了 url 标签的功能。用法似乎是您将参数传递给反向查找。同样，无论您的项目是什么，您`urls.py`都应该进行配置，以便可以通过反向查找访问任何视图。对于面包屑尤其如此。想一想：

```
home > accounts > my account 
```

帐户是否应该*拥有*任意的硬编码网址？ *“我*的帐户”可以拥有任意的硬编码网址吗？以某种方式，您将以某种方式编写面包屑，从而使您的结果`urls.py`被反转。这实际上只会发生在以下两个地方之一：在您看来，调用`reverse`. 或在模板中调用模仿`reverse`. 可能有理由更喜欢前者而不是后者（链接片段将您锁定在其中），但避免`urls.py`文件的逻辑配置不是其中之一。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-07-18T09:12:49.013

尝试[django-mptt](http://code.google.com/p/django-mptt/)。

> 用于使用 Django 模型类实现修改的预排序树遍历 (MPTT) 并使用模型实例树的实用程序。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-09-21T08:02:56.140

显然，没有一个最佳答案，但出于实际原因，我发现值得考虑幼稚的方式。**只需覆盖并重写整个面包屑......**（至少在正式`django.contrib.breadcrumb`发布之前）

不要太花哨，最好保持简单。它有助于新人理解。它是高度可定制的（例如*权限检查*、*面包屑图标*、*分隔符*、*活动面包屑*等...）

## 基本模板

```
<!-- File: base.html -->
<html>
<body>
  {% block breadcrumb %}
  <ul class="breadcrumb">
    <li><a href="{% url 'dashboard:index' %}">Dashboard</a></li>
  </ul>
  {% endblock breadcrumb %}
  {% block content %}{% endblock content %}
</body>
</html> 
```

## 实施模板

稍后在每一页上，我们**重写**并**覆盖** 整个面包屑块。

```
<!-- File: page.html -->
{% extends 'base.html' %}
{% block breadcrumb %}
<ul class="breadcrumb">
  <li><a href="{% url 'dashboard:index' %}">Dashboard</a></li>
  <li><a href="{% url 'dashboard:level-1:index' %}">Level 1</a></li>
  <li class="active">Level 2</li>
</ul>
{% endblock breadcrumb %} 
```

## 实用性

现实世界的用例：

*   Django Oscar：[基本模板](https://github.com/django-oscar/django-oscar/blob/1.2.2/src/oscar/templates/oscar/dashboard/layout.html#L101-L105)，[简单面包](https://github.com/django-oscar/django-oscar/blob/1.2.2/src/oscar/templates/oscar/dashboard/shipping/weight_based_delete.html#L8-L21)
*   Django Admin：[基本模板](https://github.com/django/django/blob/1.10.1/django/contrib/admin/templates/admin/base.html#L54-L59)、[简单面包](https://github.com/django/django/blob/1.10.1/django/contrib/admin/templates/admin/change_list.html#L29-L35)、[权限检查面包屑](https://github.com/django/django/blob/1.10.1/django/contrib/admin/templates/admin/change_form.html#L16-L23)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-12-12T16:10:50.533

您还可以通过向视图添加 crumbs 属性来减少使用[django-view-breadcrumbs](https://github.com/tj-django/django-view-breadcrumbs)管理面包屑所需的样板。

`urls.py`

```
 urlpatterns = [
        ...
        path('posts/<slug:slug>', views.PostDetail.as_view(), name='post_detail'),
        ...
    ] 
```

`views.py`

```
 from django.views.generic import DetailView
    from view_breadcrumbs import DetailBreadcrumbMixin

    class PostDetail(DetailBreadcrumbMixin, DetailView):
        model = Post
        template_name = 'app/post/detail.html' 
```

`base.html`

```
 {% load django_bootstrap_breadcrumbs %}

    {% block breadcrumbs %}
        {% render_breadcrumbs %}
    {% endblock %} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-05T23:00:58.777

## 这样的事情可能适用于您的情况：

在您的视图中捕获整个 URL 并从中创建链接。这将需要修改您的 urls.py、需要有面包屑的每个视图以及您的模板。

首先，您将在 urls.py 文件中捕获整个 URL

原始网址.py

```
...
(r'^myapp/$', 'myView'),
(r'^myapp/(?P<pk>.+)/$', 'myOtherView'),
... 
```

新的 urls.py

```
...
(r'^(?P<whole_url>myapp/)$', 'myView'),
(r'^(?P<whole_url>myapp/(?P<pk>.+)/)$', 'myOtherView'),
... 
```

然后在你看来是这样的：

视图.py

```
...
def myView(request, whole_url):
    # dissect the url
    slugs = whole_url.split('/')
    # for each 'directory' in the url create a piece of bread
    breadcrumbs = []
    url = '/'
    for slug in slugs:
        if slug != '':
            url = '%s%s/' % (url, slug)
            breadcrumb = { 'slug':slug, 'url':url }
            breadcrumbs.append(breadcrumb)

    objects = {
        'breadcrumbs': breadcrumbs,
    }
    return render_to_response('myTemplate.html', objects)
... 
```

应该将其拉出到导入到需要它的视图中的函数中

然后在您的模板中打印出面包屑

我的模板.html

```
...
<div class="breadcrumb-nav">
    <ul>
    {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.url }}">{{ breadcrumb.slug }}</a></li>
    {% endfor %}
    </ul>
</div>
... 
```

这样做的一个缺点是，就目前而言，您只能将 url 的“目录”部分显示为链接文本。我想到的一个解决方法*（可能不是一个好的方法）*是在定义面包屑功能的文件中保留一个字典。

无论如何，这是你可以完成面包屑的*一种方式，干杯:)*

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-06T09:44:17.300

你可能想试试[django-headcrumbs](https://github.com/kirelagin/django-headcrumbs)（别担心，它们不会吃掉你的大脑）。

它非常轻量级并且使用起来绝对简单，您所要做的就是用一个解释如何从给定视图返回的装饰器来注释您的视图（因为在模板中定义 crumbs 结构对我来说听起来很疯狂）。

这是文档中的一个示例：

```
from headcrumbs.decorators import crumb
from headcrumbs.util import name_from_pk

@crumb('Staff')  # This is the root crumb -- it doesn’t have a parent
def index(request):
    # In our example you’ll fetch the list of divisions (from a database)
    # and output it.

@crumb(name_from_pk(Division), parent=index)
def division(request, slug):
    # Here you find all employees from the given division
    # and list them. 
```

还有一些实用功能（例如`name_from_pk`，您可以在示例中看到）可以自动为您的面包屑生成漂亮的名称，而无需您编写大量代码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-02-02T12:51:16.597

收集当前 url 的所有可调用路径的通用方法可以通过以下代码片段解决：

```
from django.urls import resolve, Resolver404

path_items = request.path.split("/")
path_items.pop(0)
path_tmp = ""

breadcrumb_config = OrderedDict()
for path_item in path_items:
    path_tmp += "/" + path_item
    try:
        resolve(path_tmp)
        breadcrumb_config[path_item] = {'is_representative': True, 'current_path': path_tmp}
    except Resolver404:
        breadcrumb_config[path_item] = {'is_representative': False, 'current_path': path_tmp} 
```

如果`resolve`函数无法从任何 urlpattern 中获取真实路径，`Resolver404`则会抛出异常。对于这些项目，我们将`is_representative`标志设置为 false。`OrderedDict` `breadcrumb_config`之后保留具有该配置的面包屑项目。

例如，对于 bootstrap 4 面包屑，您可以在模板中执行以下操作：

```
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
      {% for crumb, values in BREADCRUMB_CONFIG.items %}
        <li class="breadcrumb-item {% if forloop.last or not values.is_representative %}active{% endif %}" {% if forloop.last %}aria-current="page"{% endif %}>
            {% if values.is_representative %}
                <a href="{{values.current_path}}">
                    {{crumb}}
                </a>
            {% else %}
                {{crumb}}
            {% endif %}
        </li>
      {% endfor %}
  </ol>
</nav> 
```

只有不会引发 a 的链接`404`是可点击的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-01-11T16:58:25.120

我为此创建了模板过滤器。

将您的自定义过滤器（我将其命名为“makebreadcrumbs”）应用到 request.path，如下所示：

```
{% with request.resolver_match.namespace as name_space %}
    {{ request.path|makebreadcrumbs:name_space|safe }}
{% endwith %} 
```

我们需要将 url 命名空间作为参数传递给我们的过滤器。

还要使用安全过滤器，因为我们的过滤器将返回需要解析为 html 内容的字符串。

自定义过滤器应如下所示：

```
@register.filter
def makebreadcrumbs(value, arg):
    my_crumbs = []
    crumbs = value.split('/')[1:-1]  # slice domain and last empty value
    for index, c in enumerate(crumbs):
        if c == arg and len(crumbs) != 1:  
        # check it is a index of the app. example: /users/user/change_password - /users/ is the index.
            link = '<a href="{}">{}</a>'.format(reverse(c+':index'), c)
        else:
            if index == len(crumbs)-1:
                link = '<span>{}</span>'.format(c)  
                # the current bread crumb should not be a link.
            else:
                link = '<a href="{}">{}</a>'.format(reverse(arg+':' + c), c)
        my_crumbs.append(link)
    return ' &gt; '.join(my_crumbs)  
    # return whole list of crumbs joined by the right arrow special character. 
```

重要的：

我们过滤器中“值”的拆分部分应该等于 urls.py 中的命名空间，因此可以调用 reverse 方法。

希望它有所帮助。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-15T09:58:14.277

我相信没有比这更简单的了（django 3.2）：

```
 def list(request):
        return render(request, 'list.html', {
            'crumbs' : [
                ("Today", "https://www.python.org/"),
                ("Is", "https://www.python.org/"),
                ("Sunday", "https://www.djangoproject.com/"),
            ]
        }) 
```

**面包屑.html**

```
<div class="page-title-right">
   <ol class="breadcrumb m-0">
      {% if crumbs %}
            {% for c in crumbs %}
                <li class="breadcrumb-item {{c.2}}"><a href="{{c.1}}">{{c.0}}</a></li>
            {% endfor %}
      {% endif %}
   </ol>
</div> 
```

CSS：

```
.m-0 {
    margin: 0!important;
}
.breadcrumb {
    display: flex;
    flex-wrap: wrap;
    padding: 0 0;
    margin-bottom: 1rem;
    list-style: none;
    border-radius: .25rem;
}
dl, ol, ul {
    margin-top: 0;
    margin-bottom: 1rem;
}
ol, ul {
    padding-left: 2rem;
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/LN5Z6.png)](https://i.stack.imgur.com/LN5Z6.png)

# blackberry - 在 JDK 中访问 Blackberry 的“Media”目录

> ID：826892
> 
> 赞同：3
> 
> 时间：2009-05-05T21:01:00.873
> 
> 标签：blackberry, java-me, filesystems, rim-4.6, jsr75

尝试使用[JSR 75](http://www.jcp.org/en/jsr/detail?id=75)访问保存在设备上“/home/video/”目录下的媒体。使用黑莓 JDK 4.6.1。单行代码引发“ `FileSystem IO Error`”异常。像往常一样，这在极端情况下无济于事。

```
fconn = (FileConnection)Connector.open("file:///home/user/videos/"+name, Connector.READ); 
```

有没有人尝试过这样做？我可以在我的 jar 中打开文件，但似乎无法访问媒体文件夹。我有`javax.microedition.io.Connector.file.read`权限集并且我的应用程序已签名。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T05:17:58.237

BlackBerry 上有两种文件系统 - SDCard 和 store。您必须使用其中之一，在路径中定义它。SDCard 上存储视频、音乐等的标准目录是“file:///SDCard/BlackBerry”。

```
 String standardPath = "file:///SDCard/BlackBerry";
    String videoDir = System.getProperty("fileconn.dir.videos.name");
    String fileName = "video.txt";
    String path = standardPath+"/"+videoDir+"/"+fileName;
    String content = "";
    FileConnection fconn =  null;
    DataInputStream is = null;
    ByteVector bytes = new ByteVector();
    try {
        fconn = (FileConnection) Connector.open(path, Connector.READ);
        is = fconn.openDataInputStream();

        int c = is.read();
        while(-1 != c)
        {
            bytes.addElement((byte) (c));
            c = is.read();
        }

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    content = new String(bytes.toArray());
    add(new RichTextField(content)); 
```

另请参阅
[SUN 开发网络 - FileConnection API 入门](http://developers.sun.com/mobility/apis/articles/fileconnection/index.html)
[RIM 论坛 - 关于 FileConnection/JSR 75 的一些问题](http://supportforums.blackberry.com/rim/board/message?board.id=java_dev&message.id=26417)
[使用 System.getProperty("fileconn.dir.memorycard") 检查 SDCard 是否可用](http://supportforums.blackberry.com/rim/board/message?message.uid=152357)
[如何在 Blackberry 中保存和删除位图图像风暴？](https://stackoverflow.com/questions/1351273/how-to-save-delete-a-bitmap-image-in-blackberry-storm)

# java - 有没有人让 Recaptcha 在 Google App Engine（Java）上运行？

> ID：826903
> 
> 赞同：3
> 
> 时间：2009-05-05T21:06:09.863
> 
> 标签：java, google-app-engine, recaptcha

我按照 recaptcha 说明创建了一个简单的应用程序，如果我使用本地 Tomcat 服务器在 Eclipse 中运行它，但相同的文件在使用本地 Google 在 Eclipse 中运行时验证用户的响应时会出现错误（验证参数不正确）应用引擎 SDK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T04:06:39.743

您是否使用链接到 reCAPTCHA 网站上的 Java 代码？我快速浏览了一下，我怀疑 SimpleHttpLoader 类使用了一些谷歌 AppEngine 不允许的 Java 类。

所以，这就是我所知道的：在本地运行，我得到和你一样的错误。但是，当我将它部署到 AppEngine 时，它​​就可以工作了！对于我读过的论坛帖子，我怀疑它与本地运行时的远程IP地址（127.0.0.1）有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T13:29:43.650

我在本地使用 Google App Engine 或使用 recaptcha4j-0.0.8.jar 和 Google App Engine SDK 1.6.6 部署时完全没有问题。[我在https://developers.google.com/recaptcha/docs/java](https://developers.google.com/recaptcha/docs/java)遵循了 Java 的 reCaptcha 教程。

在此处查看 recaptcha4j 最新版本：[http ://code.google.com/p/recaptcha4j/downloads/list](http://code.google.com/p/recaptcha4j/downloads/list)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-20T06:28:01.223

这是一个不恰当的答案，但你确定你真的需要用验证码来纠缠你的潜在用户吗？在 sitepoint 上有一篇很棒的文章，题为“[使用 CAPTCHA 之前要检查的 10 件事](http://www.sitepoint.com/captcha-alternatives/)”

# sql-server - 在 Microsoft Reporting Services 中为 Excel 报表添加和命名 TABS

> ID：826904
> 
> 赞同：2
> 
> 时间：2009-05-05T21:06:13.997
> 
> 标签：sql-server, reporting-services

在 Microsoft Reporting Services 中，我希望能够在生成 Excel 报告时为生成的文档命名选项卡。

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-17T14:48:00.440

为了从 Web 前端解决这个问题（使用 ReportViewer Web 控件让我发疯），我意识到 SSRS 将数据作为字节数组返回，然后您可以对其进行处理。因此，在 .NET 中捕获流，您可以编写一个执行以下操作的方法：

```
private byte[] ExportStream(string streamType, out string mimeType, out string extension)
{
    Microsoft.Reporting.WebForms.Warning[] warnings;
    string[] streamids;
    string encoding;
    string deviceInfo = "<DeviceInfo><SimplePageHeaders>True</SimplePageHeaders></DeviceInfo>"

    byte[] bytes = ReportViewerClientReport.ServerReport.Render(streamType,
                          deviceInfo, out mimeType, out encoding, out extension, out streamids, out warnings);

    return bytes;
} 
```

[然后使用来自http://npoi.codeplex.com/](http://npoi.codeplex.com/)的奇妙 NPOI 库之类的东西对这种方法的输出进行后处理，或者作为字节或创建某种内存流，然后你可以让它做任何你想做的事情。

另请注意，SSRS（Sql Server Reporting Services）R2 将具有此功能，但它会在 2010 年 5 月左右推出[。http://www.bidn.com/blogs/bretupdegraff/bidn-blog/234/new-features- of-ssrs-2008-r2-part-1-naming-excel-sheets-when-exporting-reports](http://www.bidn.com/blogs/bretupdegraff/bidn-blog/234/new-features-of-ssrs-2008-r2-part-1-naming-excel-sheets-when-exporting-reports)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:11:19.697

如果您想在导出时在选项卡中拆分报表，请使用带有分页符的多个表格。

您不能从 SSRS 重命名选项卡。如果要重命名选项卡，则需要编写自定义代码。

# .net - VB.Net 构造函数顺序很重要？

> ID：826905
> 
> 赞同：8
> 
> 时间：2009-05-05T21:06:26.913
> 
> 标签：.net, vb.net, interop, constructor, reference

为什么构造函数 ORDER 在 VB.Net 中很重要？我正在构建一个 .Net 类型库，它旨在完全包装底层 COM 库，以便 API 的使用者可以假装使用带有 .Net 集合的漂亮 .Net 库以及诸如此类的东西，而不是 COM 库。

目前我的大多数类只是使用反射和 CodeDOM 构建的 1 对 1 包装器。这些类有一个内部构造函数，它将底层的 COM 类型作为参数。CodeDOM 将 this 构建为该类的第一个构造函数。在 C# 中使用这些类被证明是没有问题的。我所需要的只是对 .Net 库的引用，并且一切正常。

当我尝试从 VB.Net 项目中使用这些类时，就会出现问题。如果第一个构造函数将 COM 类型作为参数，则 VB.Net 项目需要 COM 互操作程序集作为引用。如果第一个构造函数没有参数或只有托管类型，则一切正常。我的类库是用 C# 编写的。

以下作品：

```
public class ObjectID
{
    public ObjectID(int type, int id)
    {
        this.Type = type;
        this.ID = id;
    }

    internal ObjectID(COMLib.ObjectID id) : this(id.Type, id.ID) { }

    public int ID { get; set; }
    public int Type { get; set; }

    internal COMLib.ObjectID ToCOM()
    {
        COMLib.ObjectID id = new COMLib.ObjectID();
        id.ID = this.ID;
        id.Type = this.Type;
        return id;
    }
} 
```

以下需要对 COMLib.Interop 程序集的引用：

```
public class ObjectID
{
    internal ObjectID(COMLib.ObjectID id) : this(id.Type, id.ID) { }

    public ObjectID(int type, int id)
    {
        this.Type = type;
        this.ID = id;
    }

    public int ID { get; set; }
    public int Type { get; set; }

    internal COMLib.ObjectID ToCOM()
    {
        COMLib.ObjectID id = new COMLib.ObjectID();
        id.ID = this.ID;
        id.Type = this.Type;
        return id;
    }
} 
```

现在我可以通过为这些类创建一个虚拟私有构造函数作为第一个构造函数来解决这个问题，但我更好奇是什么原因造成的？为什么构造函数声明的顺序在 VB.Net 中很重要？

**更新**

这听起来太疯狂了，以至于我自己开始怀疑。设法用 3 个项目复制它。

C# 类库：已包装

```
namespace Wrapped
{
    public class Class1
    {
    }
} 
```

C# 类库：包装器

```
namespace Wrapper
{
    public class Class1
    {
        internal Class1(Wrapped.Class1 c) { }
        public Class1() { }
    }
} 
```

VB.Net 控制台应用程序：Referer

```
Module Module1
    Sub Main()
        Dim w As New Wrapper.Class1
    End Sub
End Module 
```

Wrapper 指 Wrapped Referer 指 Wrapper Referer 不指 Wrapped

```
Dim w As New Wrapper.Class1 
```

产生错误

```
Reference required to assembly 'Wrapped, Version=1.0.0.0,
                                         Culture=neutral,
                                         PublicKeyToken=null'
containing the type 'Wrapped.Class1'.
Add one to your project. 
```

交换构造函数的顺序可以解决错误。

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=442224](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=442224)

**玩了几遍后更新**

```
Causes error:          No error:

     Vb-ReferTest          Vb-RefererTest
          |                      |                     Fixes error in Vb-
          V                      V                      RefererTest even
      Cs-Wrapper            Cs-Wrapper   Vb-Wrapper <-  if the Vb-Wrapper
          |                       \         /          and the RefererTest
          V                        V       V             have no direct
   Cs-WrappedLibrary           Cs-WrappedLibrary          relationship 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T21:20:30.517

如果正确（我无法轻易验证），那真是令人着迷。顺序不重要，AFAIK。如果您确定这一点，那么可能会[在连接上记录为错误](http://connect.microsoft.com/VisualStudio)（使用示例代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T22:47:09.700

[确认为错误。](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=442224)太难修复它也不值得，所以我想我们会忍受它。幸运的是，它似乎需要具有不常见的类设置的跨语言项目才能出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T22:01:44.927

不，代码中列出的构造函数的顺序（使用 C# 或 VB.NET）无关紧要。

但是，在这种特定情况下（我没有测试过），您可能发现了一个错误。在跳到“它在我的机器上坏了”的结论之前，您可能希望让其他人在他们的机器上验证问题，这样您就知道它不仅仅是您的机器。我以前也有过这种情况。

# asp.net - javascript中的奇怪行为

> ID：826906
> 
> 赞同：1
> 
> 时间：2009-05-05T21:07:09.393
> 
> 标签：asp.net, javascript

我有一张这样的桌子

```
<table>
  <tr id="trRow1" runat="server" style="display: none">
    <td>First Name:</td>
    <td><asp:Label id="lblFirstName" runat="server"></asp:Label></td>
  </tr>
  <tr>
    <td>Last Name:</td>
    <td><asp:Label id="lblLastName" runat="server"></asp:Label></td>
  </tr>
</table> 
```

如您所见，最初没有显示第一行。当用户单击页面上的某个单选按钮时，会发生异步回发，当时我将 trRow1 的样式设置为“内联”。没有什么花哨; 没什么新鲜的。它工作得很好。

或者至少直到我尝试在 javascript 函数中执行以下操作。

```
function Test() {       
  var obj = trRow1.getElementsByTagName("select");
  alert(obj.length);
} 
```

在我调用 Test() 时，我收到一条错误消息，提示“Microsoft JScript 运行时错误：'trRow1' 未定义”。

我的猜测是，这与我在使用 AJAX 设置显示样式时搞砸了这一事实有关，并且无论出于何种原因，即使我将其显示设置为“内联”，DOM 也找不到 trRow1。

谁能给我一根骨头？我被困住了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T21:11:31.893

对象*trDegree*未定义，根据您的命名约定，看起来*trDegree*是一个表格行元素，我认为您正在尝试执行以下操作：

```
function WTF() {       
  var trDegree = document.getElementById('trDegree'); // Locate the element
  var obj = trDegree.getElementsByTagName("select");
  alert(obj.length);
} 
```

进一步参考：

*   [element.getElementsByTagName](https://developer.mozilla.org/en/DOM/element.getElementsByTagName)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:12:18.443

在您的示例中，我没有看到 trDegree 的任何变量。在调用 getElementsByTagName 之前，您需要加载 trDegree。

例如：

```
function WTF() {
  var trDegree = document.getElementById('trDegree'); 
  var obj = trDegree.getElementsByTagName("select");
  alert(obj.length);
} 
```

或者您可以只从文档级别加载标签。我不确定这是否是您想要的效果。

```
function WTF() {
  var obj = document.getElementsByTagName("select");
  alert(obj.length);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T22:17:24.200

解决方案在第一个答案中。你必须在使用它之前获取元素添加这一行：

```
var trRow1 = document.getElementById('trRow1'); 
```

# javascript - 正则表达式：{0}

> ID：826911
> 
> 赞同：0
> 
> 时间：2009-05-05T21:08:19.063
> 
> 标签：javascript, regex

问这个问题我觉得自己像个白痴，但是正则表达式会匹配文字字符串：{0}

这将在 JavaScript 中与字符串对象的替换函数一起使用。我已经尝试了几件事，但似乎没有任何效果。

谢谢，
弗兰克

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T21:10:01.010

```
"{0}".match(/\{0\}/) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:12:48.880

谢谢bdonlan。

您的帖子告诉我，这不是我的正则表达式，而是我对替换功能的使用。

我在尝试：

```
MyString.replace(/\{0\}/, "test"); 
```

它应该是：

```
 MyString = MyString.replace(/\{0\}/, "test"); 
```

再次谢谢你！

# sql-server - 通过 ODBC 的 Microsoft SQL Server 统计信息

> ID：826913
> 
> 赞同：3
> 
> 时间：2009-05-05T21:08:23.370
> 
> 标签：sql-server, ruby, odbc, unixodbc

我有一个我正在尝试进行基准测试的 SQL Server 实例。从 SQL Studio 应用程序中，我可以键入

```
SET STATISTICS TIME ON 
```

并在此之后查看输出的统计信息。从 C++ 代码，我可以做类似的事情

```
SQLExecDirect(hstmt, "SET STATISTICS TIME ON", SQL_NTS); 
```

然后通过 检索这些统计信息`SQLError`。

通过 vanilla ODBC 访问 SQL Server 时，有没有办法获取这些统计信息。在这种情况下，我使用的是 Ruby 的`DBI:ODBC`连接器，它可以很好地连接和运行查询，但我无法弄清楚这些元数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T17:49:48.917

好吧，它不是通过 odbc 进行的，但是如果您有 Sql Server 工具，那么 Sql Profiler 是否适合您？您可以使用它来为 Sql Server 中语句、事务、存储过程和无数其他事物的执行计时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:08:07.093

你可以尝试使用`dbh.func(:stat)`

# delphi - 单击控件时如何获取鼠标的坐标？

> ID：826914
> 
> 赞同：16
> 
> 时间：2009-05-05T21:09:55.580
> 
> 标签：delphi, mouse, timage

在 TImage 的 OnClick 事件中，我想提取鼠标的 x,y 坐标。我更喜欢它们与图像的关系，但与形式或窗口的关系也一样好。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-05T21:19:38.613

Mouse.CursorPos 包含 TPoint，而 TPoint 又包含 X 和 Y 位置。该值在全局坐标中，因此您可以使用 ScreenToClient 例程将屏幕坐标转换为窗口坐标来转换为您的表单。

根据 Delphi 帮助文件，Windows.GetCursorPos 可能会失败，如果失败，Mouse.CursorPos 会包装它以引发 EOsException。

```
var
  pt : tPoint;
begin
  pt := Mouse.CursorPos; 
  // now have SCREEN position
  Label1.Caption := 'X = '+IntToStr(pt.x)+', Y = '+IntToStr(pt.y);
  pt := ScreenToClient(pt);
  // now have FORM position
  Label2.Caption := 'X = '+IntToStr(pt.x)+', Y = '+IntToStr(pt.y);
end; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-06T13:30:44.130

该`Mouse.CursorPos`属性将告诉您鼠标的*当前*位置。如果计算机运行缓慢，或者您的程序对消息的响应速度很慢，那么它可能与`OnClick`事件第一次发生时鼠标所处的位置不同。要获取*单击鼠标按钮时鼠标*的位置，请使用[`GetMessagePos`](http://msdn.microsoft.com/en-us/library/ms644938.aspx). 它报告*屏幕坐标*；用 转换为客户坐标`TImage.ScreenToClient`。

另一种方法是自己处理`OnMouseDown`and`OnMouseUp`事件；它们的参数包括坐标。请记住，*这两个*事件都需要发生才能发生*点击*。您可能还想检测*拖动*操作，因为您可能不想将拖动视为一次点击。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-05T21:22:12.837

正如其他人所说，您可以使用 Mouse.CursorPos 或 GetCursorPos 函数，但您也可以只处理 OnMouseDown 或 OnMouseUp 事件而不是 OnClick。通过这种方式，您可以将 X 和 Y 值作为事件处理程序的参数，而无需进行任何额外的函数调用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T21:18:50.707

这个怎么样？

```
procedure TForm1.Button1Click(Sender: TObject);
var
MausPos: TPoint;
begin
  GetCursorPos(MausPos);
  label1.Caption := IntToStr(MausPos.x);
  label2.Caption := IntToStr(MausPos.y);
end;

procedure TForm1.Button2Click(Sender: TObject);
begin
  SetCursorPos(600, 600);
end; 
```

曾经在某处在线找到此内容并将其保存在我的代码片段数据库中：)

[然而，这个页面](http://delphi.about.com/od/vclusing/a/mouseadvanced.htm)可能会解决你所有的问题......似乎有从客户端到屏幕坐标和返回等的功能。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-25T23:21:10.793

至火猴 (FMX)：

```
var
  p: TPointF;
begin
  p := Screen.MousePos;
end; 
```

# c# - 将 Visual Studio 2005 sln 迁移到 2008，在 LIB 环境变量中使用 vc98 路径发出警告，如何解决？

> ID：826921
> 
> 赞同：6
> 
> 时间：2009-05-05T21:11:50.507
> 
> 标签：c#, .net, windows, visual-studio-2008

我正在将解决方案从 Visual Studio 2005 迁移到 Visual Studio 2008。当我在 2005 年构建解决方案时，我没有任何问题。但是，在我使用 devenv.exe /Upgrade 然后在解决方案上使用 msbuild 之后，我收到以下警告：

CSC：警告 CS1668：“LIB 环境变量”中指定的搜索路径“\vc98\lib”无效——“系统找不到指定的路径。” CSC : 警告 CS1668: Invalid search path '\vc98\mfc\lib' specified in 'LIB environment variable' -- '系统找不到指定的路径。' CSC : 警告 CS1668: 'LIB 环境变量'中指定的无效搜索路径'c:\program files\microsoft visual studio 9.0\vc\platformsdk\lib' -- '系统找不到指定的路径。

我检查了[http://social.msdn.microsoft.com/Forums/en-US/Vsexpressinstall/thread/3f875480-fee2-4bc3-b829-95e220b22a01](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressinstall/thread/3f875480-fee2-4bc3-b829-95e220b22a01)并没有为我提供任何帮助，因为我的 LIB 和 INCLUDE 环境变量未在用户变量或系统变量中设置。我查看了 Studio 的工具 > 选项 > 项目和解决方案 > VC++ 目录，没有任何引用任何旧的东西：

库文件： $(VCInstallDir)lib $(VCInstallDir)atlmfc\lib $(VCInstallDir)atlmfc\lib\i386 $(WindowsSdkDir)\lib $(FrameworkSDKDir)lib $(VSInstallDir) $(VSInstallDir)lib

包含文件：

$(VCInstallDir)include $(VCInstallDir)atlmfc\include $(WindowsSdkDir)include $(FrameworkSDKDir)include

我使用了诊断输出，以便可以准确地看到 LIB 变量在被调用时包含的内容：

lib = c:\Program Files\Microsoft Visual Studio 9.0\VC\ATLMFC\LIB;c:\Program Files\Microsoft Visual Studio 9.0\VC\LIB;C:\Program Files\Microsoft SDKs\Windows\v6.0A\lib ;\vc98\lib;\vc98\mfc\lib;c:\program files\microsoft visual studio 9.0\vc\platformsdk\lib;c:\program files\microsoft visual studio 9.0\vc\lib;c:\program files \微软视觉工作室 9.0\vc\atlmfc\lib; LIBPATH = c:\Windows\Microsoft.NET\Framework\v3.5;c:\Windows\Microsoft.NET\Framework\v2.0.50727;c:\Program Files\Microsoft Visual Studio 9.0\VC\ATLMFC\LIB;c :\Program Files\Microsoft Visual Studio 9.0\VC\LIB

因此，如果 vc98 不在我的环境变量中，或者我的工作室设置和 vc98 甚至没有安装（也没有安装），那么该路径来自哪里？像这样设置 LIB env var 的过程是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T09:41:34.130

[在MSDN](http://social.msdn.microsoft.com/Forums/en-US/csharpide/thread/01e75a63-7d44-48c7-82c1-30cd25fc4745)上找到：

> 是的，这是某些人会遇到的已知问题。仔细查看您的 LIB 路径。在 ATLMFC、V、SDK -> \vc98\lib 之后。删除此条目（以及后面的条目）。如果 LIB 是一个用户变量，那么您需要重新启动 VS 或者注销并重新打开。如果它是系统变量，则必须重新启动。你的错误应该会消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-04T12:27:59.927

这是解决方案

[http://msdn.microsoft.com/en-us/library/tcbs315h(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/tcbs315h(v=vs.80).aspx)

它指的是环境变量中的 LIB 条目

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T03:29:56.283

似乎您已经在这里涵盖了大部分内容，所以我唯一能想到的就是继承的属性表。

它们在 vcproj XML 中指定（或者您可以在 IDE 中检查属性管理器）：

```
<VisualStudioProject>
    <Configurations>
        <Configuration InheritedPropertySheets="stuff.vsprops">... 
```

如果您确实有一些继承的属性表，请查看文件并查看是否明确设置了任何 vc98 lib 路径？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T09:11:34.603

我想知道这是否可能是由于在使用与 C 运行时库相关的 VS2005 时发生的 /ML 和 /MLd 中的编译器开关 /MT 和 /MTd 发生了变化？

参考这里，看看它是否有帮助：http: [//msdn.microsoft.com/en-us/library/abx4dbyh.aspx](http://msdn.microsoft.com/en-us/library/abx4dbyh.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-24T13:30:02.070

我在 VS.NET2010 中遇到了与 C# 项目非常相似的问题。它似乎只影响那些导入 C++/CLI 项目的项目。这些项目仍设置为使用 v9.0 工具集（C++、C++/CLI）和 .NET 3.5（C++/CLI、C#）进行编译。你有没有运气找到问题的根源？

我通过在受影响项目的属性中将警告 1668 添加到忽略的警告列表中来解决它。这并不理想，但比我的警告列表中的垃圾邮件要好。

# php - 如何在 CakePHP 的视图中显示 ajax 结果而不在 ajax 响应中包含默认模板？

> ID：826922
> 
> 赞同：5
> 
> 时间：2009-05-05T21:12:05.607
> 
> 标签：php, cakephp

我正在 CakePHP 中对 AJAX 进行一些试验，它似乎可以工作，只是返回的视图包含默认模板。我怎样才能摆脱它（或者甚至只是为视图指定不同的空模板）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T21:15:33.913

```
function ajaxFunction() {
    //do stuff
    $this->layout= 'ajax';
} 
```

Ajax 是一个包含的空白布局，可防止添加额外的标记，这正是您想要的。

[http://book.cakephp.org/view/96/Layouts](http://book.cakephp.org/view/96/Layouts)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T15:14:49.603

尝试使用 RequestHandler 组件。这将自动为您处理。然后，您可以在 AppController::beforeFilter() 中执行类似的操作

```
if($this->RequestHandler->isAjax()) {
    Configure::write('debug',0);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T14:29:00.773

您还需要关闭调试输出，否则 cake 会喷出您通常在页面底部看到的所有调试信息：

```
function ajaxFunction() {
    //do stuff
    Configure::write('debug', 0);
    $this->layout= 'ajax';
} 
```

# .net - SerializationException 由于安全限制，无法访问类型 System.Runtime.Remoting.ObjRef

> ID：826929
> 
> 赞同：4
> 
> 时间：2009-05-05T21:13:02.187
> 
> 标签：.net, iis, remoting

我有一个托管在 IIS 下的远程服务器，当我尝试与它交谈时，它会引发以下异常 SerializationException 由于安全限制，无法访问类型 System.Runtime.Remoting.ObjRef。如果我在自己的 exe 中托管服务器，我没有任何问题。
搜索谷歌，大多数人的解决方案是设置 typeFilterLevel="Full"

```
<clientProviders>
    <formatter ref="binary" typeFilterLevel="Full"/>
</clientProviders>    
<serverProviders>
     <formatter ref="binary" typeFilterLevel="Full"/>
</serverProviders> 
```

我正在做的。

我还将信任级别设置为完整，无论如何都应该是默认值。

```
<system.web>
    <authentication mode="None" />
    <customErrors mode="Off" />
    <compilation defaultLanguage="c#" />
    <trust level="Full"/>
</system.web> 
```

我在 Windows 2003 上使用 IIS 6.0。为 .NET 2.0 编译的代码。应用程序池在具有管理权限的帐户下运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T21:42:08.013

问题最终是一个错误的频道定义。serverProviders 标签不在频道内，xml 的缩进使它看起来像它。

# dynamics-crm - 关于动态 CRM 性能

> ID：826930
> 
> 赞同：1
> 
> 时间：2009-05-05T21:13:05.433
> 
> 标签：dynamics-crm, dynamics-crm-4

我的老板让我对市场上可用的 CMS 进行研究，因为我们目前使用的 CMS 相当混乱。

对于我作为 .NET 开发人员来说，选择和实施 Dynamics CRM 将是非常棒的，因为它具有可扩展性以及与 .NET 环境和知名工具的完美集成。

所有营销听起来都很棒，但我想了解有关此系统的常见缺点和问题。

最重要的是它在一个拥有大约 150 个并发且非常活跃的用户的公司中的表现。我听说与竞争对手的系统相比，它真的很慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T18:09:00.420

Dynamics CRM 产品团队发布了一份出色的白皮书，其中包含 500 个并发用户的指导和基准。通过学习这篇论文，你可以学到很多东西。链接在这里：

[Microsoft Dynamics CRM 4.0 为最多 500 个并发用户的部署推荐的硬件](http://www.microsoft.com/downloads/details.aspx?FamilyID=3bf7ecda-7eaf-4f1c-bbfe-cae19bc8bb78&displaylang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:16:10.503

我无法回答用户/活动的数量。我可以向您推荐 SDK 文章“性能最佳实践”。我将与您一起编写插件（用于数据访问消息）、访问 CRM Web 服务的自定义页面以及编写 SSRS 报告。我可以涉及到几点：

1.  禁用插件。这是 CRM 中一个有吸引力的主要集成点。他们将其列为性能问题的事实令人沮丧。我们已经看到了来自插件缓存的 OutOfMemory 异常。我们通过部署到磁盘而不是数据库来解决这个问题。在数据库中，他们重新加载程序集并在每次调用插件时确认签名。我们相信这会占用大对象堆。对于您的正常 CRM 实施而言，可能不是问题。

2.  限制检索到的数据。确实。尽可能避免不需要的查找/选择列表/位，因为这些会导致额外的连接。对于较小的实体而言，这不会是一笔大买卖。但是，如果您需要具有大量属性的实体，它可能是。对于正常的 CRM 定制来说，可能不是问题。在其他情况下，一个好的设计应该避免这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-20T09:49:50.303

我真的无法就它与主要竞争对手的比较提供任何建议。我知道主要是它更便宜且开发非常积极。

我可以说一下性能，但这可能会有所帮助。

我们有大约 400 - 600 个并发用户使用该系统。该系统不是特别密集的网络服务器。我们有两个用于弹性 - 如果它离线将是一场灾难，但这些服务器永远不会被征税。他们有几个虚拟内核和 4 gig 的 ram。

我们的数据库大小为 130GB，托管在具有 48GB RAM 的 24 核数据库服务器上。它是集群的，但由于 SQL 服务器无法处理两个活动节点，因此只有一个服务器处于活动状态。

数据库服务器真的永远不会被最大化。然而，我们需要做出一项非常重要的改变，我认为 MS 建议所有大型 CRM 安装的用户现在就去做。默认情况下，SQL Server 有一个锁定模式，当正在读取一行时，它会阻止人们写入数据库。在我们的系统（显然还有许多其他系统）中，这导致了巨大的问题。

We switched on a different mode (I think its called "snapshot isolation") or something like that. To be fair though even if you did have 200 concurrent users, it won't be any issue until the more central tables like activitypointer and account get pretty large (in the millions)

So - there is no doubt that CRM 2011 can handle that many users as long as you have some suitable hardware and have someone who understands SQL Server

HTH

S

# jsp - 在 JSP 中声明函数？

> ID：826932
> 
> 赞同：70
> 
> 时间：2009-05-05T21:13:34.277
> 
> 标签：jsp, function

我来自 PHP 世界，在 php 页面中间声明一个函数非常简单。我尝试在 JSP 中做同样的事情：

```
public String getQuarter(int i){
String quarter;
switch(i){
    case 1: quarter = "Winter";
    break;

    case 2: quarter = "Spring";
    break;

    case 3: quarter = "Summer I";
    break;

    case 4: quarter = "Summer II";
    break;

    case 5: quarter = "Fall";
    break;

    default: quarter = "ERROR";
}

return quarter;
} 
```

我收到以下错误：

```
An error occurred at line: 20 in the jsp file: /headers.jsp
Illegal modifier for the variable getQuarter; only final is permitted return; 
```

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-05-05T21:16:59.150

您需要将其括在 <%! %> 如下：

```
<%!

public String getQuarter(int i){
String quarter;
switch(i){
        case 1: quarter = "Winter";
        break;

        case 2: quarter = "Spring";
        break;

        case 3: quarter = "Summer I";
        break;

        case 4: quarter = "Summer II";
        break;

        case 5: quarter = "Fall";
        break;

        default: quarter = "ERROR";
}

return quarter;
}

%> 
```

然后，您可以在 scriptlet 或表达式中调用该函数：

```
<%
     out.print(getQuarter(4));
%> 
```

**或者**

```
<%= getQuarter(17) %> 
```

# iphone - 如何在加速时从我的视图控制器外包视图更改操作？

> ID：826933
> 
> 赞同：1
> 
> 时间：2009-05-05T21:13:37.973
> 
> 标签：iphone, cocoa-touch, uikit, accelerometer

我有一个视图控制器类。当加速度计检测到运动并在委托对象中调用加速度计：didAccelerate：方法时，我想在我的视图中做一些事情。

那个委托对象是我脑子里的问题。目前，我的大脑被冻结了，我不知道有什么更好的方法。让我知道你的想法！

解决方案 1）在我的视图控制器类中，我符合 UIAccelerometerDelegate 协议，并实现该 accelerometer:didAccelerate: 方法。在我的 AppDelegate 类的 -applicationDidFinishLaunching: 方法中，我将该视图控制器对象设置为接收加速方法调用的委托。我认为这不是很好。

解决方案 2）我创建一个名为 AccelerationDelegate 的空白新对象，符合该 UIAccelerometerDelegate 协议，实现该 accelerometer:didAccelerate: 方法，并在我的 AppDelegate 类的 -applicationDidFinishLaunching: 方法中将该视图控制器对象设置为接收方法调用的委托在加速时。

但是对于解决方案 2，我的大脑有点卡住了！如何从该对象内的视图控制器访问视图对象？

这里的问题是，我周围有不止一个视图控制器。我使用标签栏控制器在它们之间切换。

有什么建议我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T21:59:51.997

我同意第二种方法更好。您是要访问当前选定的选项卡视图，还是只访问应用程序中的特定视图。

在任何情况下，我要做的就是`UITabViewController`在您的中为您设置属性，`UIApplicationDelegate`以便您可以从委托访问它（您可以通过调用获取应用委托`[[UIApplication sharedApplication] delegate]`）。例如：

```
YourApplicationDelegate *appDelegate = (YourApplicationDelegate *)[[UIApplication sharedApplication] delegate];
FirstUIViewController *firstViewController = appDelegate.firstViewController;
[firstViewController doStuff]; 
```

`firstViewController`您的委托的属性在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T13:53:52.547

如果你的加速特定于一个视图控制器，那么让视图控制器接收必要的信息来改变它自己的子视图是有意义的。但是，最好在视图出现时将视图控制器设置为委托，并在视图消失时将委托设置为 null。（具体来说，`- (void) viewWillAppear:`和`- (void) viewWillDisappear:`）

# c++ - 如何将数组存储在 STL 列表中？

> ID：826935
> 
> 赞同：13
> 
> 时间：2009-05-05T21:14:29.843
> 
> 标签：c++, arrays, stl

使用 C++ 和 STL，有人知道如何将整数数组作为节点存储在 STL 列表或向量中吗？我需要存储未知数量的数字对，并且来自其他语言，我的第一个想法是使用某种类似列表或向量的数据结构......但我遇到了一些麻烦。我 100% 确定我犯了一个明显的初学者 C++ 错误，并且真正了解该语言的人会看一看我正在尝试做的事情并能够让我直截了当。

所以，这就是我尝试过的。像这样声明一个列表是有效的：

```
stl::list<int[2]> my_list; 
```

然后我可以轻松地制作一个二元素数组，如下所示：

```
int foo[2] = {1,2}; 
```

这编译并运行得很好。但是，一旦我尝试添加`foo`到我的列表中，就像这样：

```
my_list.push_back(foo); 
```

我得到了一整套编译器错误，我都没有真正理解（我的 C++-fu 几乎不存在）：

```
/usr/include/c++/4.0.0/ext/new_allocator.h: In member function ‘void __gnu_cxx::new_allocator<_Tp>::construct(_Tp*, const _Tp&) [with _Tp = int [2]]’:
/usr/include/c++/4.0.0/bits/stl_list.h:440:   instantiated from ‘std::_List_node<_Tp>* std::list<_Tp, _Alloc>::_M_create_node(const _Tp&) [with _Tp = int [2], _Alloc = std::allocator<int [2]>]’
/usr/include/c++/4.0.0/bits/stl_list.h:1151:   instantiated from ‘void std::list<_Tp, _Alloc>::_M_insert(std::_List_iterator<_Tp>, const _Tp&) [with _Tp = int [2], _Alloc = std::allocator<int [2]>]’
/usr/include/c++/4.0.0/bits/stl_list.h:773:   instantiated from ‘void std::list<_Tp, _Alloc>::push_back(const _Tp&) [with _Tp = int [2], _Alloc = std::allocator<int [2]>]’
test.cpp:5:   instantiated from here
/usr/include/c++/4.0.0/ext/new_allocator.h:104: error: ISO C++ forbids initialization in array new 
```

那么，有人对我在这里做错了什么有想法吗？任何指针（没有双关语）都是最有帮助的。是否不可能将数组存储在 std::list 中？我应该使用结构吗？我只是错过了一个`*`或`&`某个地方吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-05T21:17:55.983

存储在标准库容器中的东西必须是可分配和可复制的——数组都不是。您最好的选择是创建一个 std::vector 列表。或者，您可以将数组包装在结构中：

```
struct A {
   int array[2];
};

std::list <A> alist; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-05T21:19:29.147

您不能将数组存储在 STL 容器中。对于一般情况，您会使用向量的向量或类似的向量。对于您的具体情况，我会使用 std::pair 的向量，如下所示：`std::vector<std::pair<int, int> >`。 `std::pair`是一个有两个成员的类，`first`并且`second`，无论您将其模板化为何种类型。

编辑：我最初将它作为`std::vector<std::pair<int> >`，但我不确定在两种类型相同的情况下它是否被重载以仅接受 1 个参数...稍微挖掘没有发现任何证据，所以我将其修改为明确声明`first`和`second`都是`int`s。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T21:20:58.377

这是使用[boost::array](http://www.boost.org/doc/libs/1_39_0/doc/html/array.html)而不是“经典”C 样式数组的好情况。这应该有效：

```
std::list<boost::array<int,2> > my_list;
boost::array<int,2> foo={{1,2}};
my_list.push_back(foo); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-05T21:21:42.977

在这种情况下，我建议您使用 std::pair 来存储值。它位于
`<utility>`。

您可以在列表中存储指向数组的指针，但随后您将不得不处理所有内存管理。如果您只需要成对的值，那么使用 pair 会简单得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-27T11:26:02.940

从 C++11 开始，我们可以使用标准来做到这一点`std::array`：

```
#include <array>
#include <list>
#include <iostream>

int main () {
    std::list<std::array<int, 2>> l {{3,4},{5,6}};
    l.push_back({1,2});

    for (const auto &arr : l)
        for (const auto &v : arr)
            std::cout << v << ' ';
} 
```

或者

```
l.push_back({{1,2}}); 
```

等以消除一些铿锵声警告。

输出：

```
3 4 5 6 1 2 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-27T11:29:31.293

使用 C++11 有一个可用的[`::std::array`包装器](http://en.cppreference.com/w/cpp/container/array)，可用于标准容器，如下所示：

```
#include <array>
#include <iostream>
#include <list>
#include <cstdint>

int
main()
{
    using t_Buffer = ::std::array<::std::int32_t, 2>;
    using t_Buffers = ::std::list<t_Buffer>;
    t_Buffers buffers;
    buffers.emplace_back(t_Buffer{1, 2});
    ::std::cout << buffers.front()[0] << " " << buffers.front()[1] << ::std::endl;
    return(0);
} 
```

[在线运行此代码](https://ideone.com/MCpEiW)

# svn - mercurial 和 subversion 之间的互操作

> ID：826938
> 
> 赞同：21
> 
> 时间：2009-05-05T21:15:38.717
> 
> 标签：svn, mercurial, interop, hgsubversion, hgsvn

最近有人问了一个[类似的问题，但不一样。](https://stackoverflow.com/questions/799860/using-mercurial-locally-only-with-subversion-server)

Mercurial 网站有一个[详细的页面](http://www.selenic.com/mercurial/wiki/index.cgi/WorkingWithSubversion)列出了 4 种不同选项的比较，以使 Mercurial 和 Subversion 互操作。

**我想知道是否有人尝试过其中的一种或多种，​​并且可以将任何非常好的或非常糟糕的经历联系起来。**[hgsubversion 下载](http://bitbucket.org/durin42/hgsubversion/overview/)的注释说

> hgsubversion 是 Mercurial 的扩展，它允许将 Mercurial 用作 Subversion 客户端。现在它还*没有*准备好用于生产。仅当您准备好破解它并深入研究 Mercurial 和/或 Subversion 的内部时，才应该使用它。

这几乎是在向我展示“放弃希望，所有进入这里的人”或“入侵者将被逮捕”的标志。所以我只是想知道对于没有太多额外时间的人来说，这个或任何其他替代方案是否值得尝试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T20:46:02.280

我认为 hgsubversions 的作者有点偏执。如果您遵循自述文件 - 意味着使用适当的最新版本的 mercurial 和 subversion -*而不是*安装在您的发行版上或由您的发行版安装 - 那么它实际上工作得很好。同样，包含的文档是最新的；而你在网上找到的可能不是。我已经使用它几个星期了，结果很合理——但并不完美。

当您进入两个系统的角落时，您就会遇到问题：hgsubversion 和其他扩展（我对 hgtasks 有问题）似乎彼此不喜欢；目前尚不清楚如何处理属性等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-01T10:29:02.387

我想选择第二个选项**hgsvn**，如果你想镜像一个大存储库，它会相当慢，但你可以从接近尖端的修订开始（这通常是你想要的）。

我发现它非常健壮，具有超过 5000 次修订的镜像存储库。如果这是您想要的，您可以将变更集推回。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-29T13:48:45.977

我刚刚开始使用选项 4，hgsvn。尽管 Mercurial 页面上说了什么，hgsvn 0.1.7**确实**支持推回 svn 存储库。

我的用例非常简单：我真的只想要拥有本地分支的能力（在这个阶段）。[hgsvn](http://pypi.python.org/pypi/hgsvn/)页面上列出的工作流程正是我所使用的，到目前为止它还没有破坏任何东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T00:07:07.743

是的，您必须使用 Mercurial 的最新“船员版本”，请参阅 Mercurial wiki 上的 CrewRepository 页面。

当 Mercurial 1.3 于 7 月 1 日发布时，hgsubversion 应该开始维护一个稳定的分支。至少 IRC 上是这么说的（irc.freenode.net 上的#hgsubversion）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-06T00:43:16.050

我已经使用 Subversion 好几年了，但我对尝试这种分布式 VCS 想法很感兴趣。（我想使用 git，但它在 Windows 上不太好，因此无法在我的工作中使用它。所以我接下来想尝试 Mercurial。）

我最初想使用 Subversion 服务器进行推送和拉取。所以我尝试了选项 1，hgsubversion。我在带有 hg 1.1.2 的 Ubuntu 9.04 (Jaunty) 上。我按照该网页上给出的指示进行操作。一切似乎都安装得很好。但是当我尝试使用**hg svnclone**命令时，我收到了“未知命令”错误。进一步挖掘表明，现在您只需使用前缀为**svn+**的 SVN URL进行**hg clone**。例如：

 **> `hg clone svn+https://server/svn/repo/`

但后来，我收到一条错误消息：

> `abort: could not import module encoding!`

这似乎是一个[已知的错误](http://bitbucket.org/durin42/hgsubversion/issue/67/problems-with-encoding-against-crew-hg)，但经过一番摆弄后，我无法弄清楚我要做什么来修复它。

摘要：选项 1 目前对我不起作用。其他选项不适合我想要的工作流程。

更新：我用 Mercurial 1.2.1 再次尝试，得到了相同的结果。有人告诉我，开发中的**`mercurial-crew`**分支应该可以工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-29T04:03:46.797

我已经使用 hgsubversion 好几个月了。您可能缺少一些功能，但它已准备好用于生产。

OGRE 和许多其他人决定使用 hgsubversion，因为它速度很快。

# sharepoint - Web 部件对管理员可见

> ID：826944
> 
> 赞同：0
> 
> 时间：2009-05-05T21:17:51.083
> 
> 标签：sharepoint, web-parts, dataview

我已将 DataView Web 部件添加到 SharePoint。进行一些自定义后，当我以管理员身份登录时，Web 部件呈现良好，但使用读者帐户，我对该 Web 部件所做的任何更改都没有。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T21:48:20.230

如果该页面尚未签入，则更改将仅对具有某些权限的人可见。

# javascript - 如何将表的内容或 sql 查询的结果从 asp 页面发送到剪贴板？

> ID：826946
> 
> 赞同：1
> 
> 时间：2009-05-05T21:18:46.900
> 
> 标签：javascript, html, sql, excel, asp-classic

互联网上有很多做这种事情的例子。但是它们都不能在 Firefox 中运行。所以我想我会为 Stack Overflow 用户设置挑战。

基本上，我需要一种非常易于使用的方式让页面用户将查询结果放入剪贴板，以便他们可以将其粘贴到 Excel 中。

它可以从 HTML 表中获取数据（由查询生成）

或将结果直接发送到剪贴板（以 excel 可读的格式）

我有一个包含许多 asp 页面的 Intranet。其中一些会生成相当大的表格，然后将其中一些复制到 excel 中。目前用户必须点击左上角的单元格，然后向下滚动页面并将光标移出表格的末尾。如果他们没有完全正确地执行此操作（在 Firefox 中），excel 将无法正确读取数据。

我希望他们能够单击一个按钮，然后他们转到 excel，单击单元格 a1，然后按 ctrl-v。数据应该正确地显示为列和行（格式无关紧要）

有任何想法吗？

我对 ASP 或 Javascript 方法持开放态度。并且它必须在 IE 和 firefox 中都可以工作 (3)

**编辑**

我从回复中选择了最简单的选项（我可能有很多页面要“做”，所以最简单的就是最好的。

在形式...

```
Send results to excel <input type="checkbox" name="sendtoexcel"> 
```

在后面的代码中......

```
if request.querystring("sendtoexcel") = "on" then

response.contenttype = "application/vnd.ms-excel"
Response.AddHeader "content-disposition","attachment; filename=fname.xls"

end if 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T21:22:11.043

首先，Excel 对复制/粘贴 html 表格对象有很好的支持。你应该看看这是否符合你的需要。

否则，我建议将数据的 CSV 文件从 ASP 直接发送给用户。

我还没有测试过这个，但它应该让你在那里的一部分：

```
<%
Response.AddHeader "Content-Type", "application/octet-stream"
Response.AddHeader "Content-Disposition", "attachment; filename=myTable.csv"

Dim customers, c
customers = GetCustomerFromDb()

For Each c in customers
  Response.Write """" & c("Name") & ""","
  Response.Write """" & c("Email") & ""","
  Response.Write """" & c("Address") & ""","
  Response.Write """" & c("City") & ""","
  Response.Write vbCrLf
Next
%> 
```

您要做的是使用此代码创建一个新页面，然后在您的界面中，您将有一个指向该页面的链接，该链接将下载 CSV。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T21:43:44.360

我将在 Intranet 设置中使用的方法是让 ASP 页面将表格作为 HTML 发送，但将响应内容类型设置为“application/vnd.ms-excel”。

您可能会有三个页面：

1.  一个包含页面，其中包含生成 HTML 表的代码，从
2.  一个视图页面，它使用包含来创建包含在其他标记中的表格输出，例如导航和“发送到 excel 链接”（这是指向下面页面的链接）
3.  将其内容类型设置为“application/vnd.ms-excel”并使用相同的包含来生成表格输出的页面。

现在用户只需单击链接，表格内容就会出现在 Excel 中。

请注意，为了获得最佳操作，您需要添加 Content-Dispostion 标头“filename=sensible.xls; attachment”。

# python - 使用 Python 3 打印时出现语法错误

> ID：826948
> 
> 赞同：273
> 
> 时间：2009-05-05T21:19:19.503
> 
> 标签：python, python-3.x

为什么在 Python 3 中打印字符串时会收到语法错误？

```
>>> print "hello World"
  File "<stdin>", line 1
    print "hello World"
                      ^
SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2009-05-05T21:21:18.877

在 Python 3 中，`print` [变成了一个函数](http://docs.python.org/3.0/whatsnew/3.0.html#print-is-a-function)。这意味着您现在需要包含括号，如下所述：

```
print("Hello World") 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-05T21:21:24.880

看起来您正在使用 Python 3.0，其中[print 已变成可调用函数](http://docs.python.org/3.0/whatsnew/3.0.html#print-is-a-function)而不是语句。

```
print('Hello world!') 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2014-10-27T12:35:26.673

因为在 Python 3 中，`print statement`已被替换为`print() function`, 关键字参数，以替换旧 print 语句的大部分特殊语法。所以你必须把它写成

```
print("Hello World") 
```

但是如果你在一个程序中编写这个并且有人使用 Python 2.x 试图运行它，他们会得到一个错误。为避免这种情况，导入打印功能是一个好习惯：

```
from __future__ import print_function 
```

现在您的代码适用于 2.x 和 3.x。

查看下面的示例也可以熟悉 print() 函数。

```
Old: print "The answer is", 2*2
New: print("The answer is", 2*2)

Old: print x,           # Trailing comma suppresses newline
New: print(x, end=" ")  # Appends a space instead of a newline

Old: print              # Prints a newline
New: print()            # You must call the function!

Old: print >>sys.stderr, "fatal error"
New: print("fatal error", file=sys.stderr)

Old: print (x, y)       # prints repr((x, y))
New: print((x, y))      # Not the same as print(x, y)! 
```

资料来源：[Python 3.0 有什么新功能？](https://docs.python.org/3.0/whatsnew/3.0.html)

# validation - Grails 重复错误消息

> ID：826950
> 
> 赞同：1
> 
> 时间：2009-05-05T21:19:38.037
> 
> 标签：validation, grails, groovy, command-objects

我是 grails 的新手，我有一个问题：

我有这个 GSP 片段：

```
<g:form url="[controller:'main',action:'login']"> 
  <label for="name">Usuario:</label><br/> 
  <input type="text" name="name" /><br/> 
  <label for="pass">Password:</label><br/> 
  <input type="password" name="password"/><br/> 
  <input type="submit" value="Login"/><br/> 
  <g:renderErrors bean="${cmd}"/> 
</g:form> 
```

控制器 (MainController.groovy) 使用命令对象，这是两者的代码：

```
def login = { LoginCommand cmd -> 
  if(cmd.validate()){ 
  redirect(action:'ok') 
  }else{ 
  render(view:'index',model:[cmd:cmd]) 
  } 
  } 

class LoginCommand { 

        String name 
        String password 

        static constraints = { 
                name(blank:false,size:5..10) 
                password(blank:false,size:5..10) 
        } 
} 
```

问题是，当我输入错误的名称或通过（空白或超出范围）**时，它会显示 4 个错误，两个用于密码，两个用于用户名**。它们相同，但重复。

我发现创建一个方法“bool validateCommand(){ name && password }”并将其替换为 command.validate() 不会引发重复，但我想使用 Grails 的约束功能来保持干燥。

知道为什么会这样吗？非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-06T15:37:16.883

当您将命令对象注入控制器动作时，Grails`validate()`会自动执行，因此无需手动调用它。尝试

```
if(!cmd.hasErrors()) 
```

代替

```
if(cmd.validate()) 
```

似乎每次调用都会向`validate()`命令对象添加新的（重复的）错误。恕我直言，这不应该发生，并且可能是 Grails 中的一个错误。您应该考虑[报告](http://jira.codehaus.org/browse/GRAILS)此问题。

# android - 有没有办法通过官方 API 提高 Android 设备上的背光？

> ID：826970
> 
> 赞同：4
> 
> 时间：2009-05-05T21:24:18.213
> 
> 标签：android, mobile, backlight, android-1.5-cupcake

我所读到的似乎表明唯一的方法是使用在 Cupcake (1.5) 中被锁定的非官方 API。这是真的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T08:22:47.070

看起来答案是“直到蛋糕”。

来自[Android 开发者博客：面向未来的应用程序](http://android-developers.blogspot.com/2009/04/future-proofing-your-apps.html)：

> 避免使用的技术，#1：使用内部 API
> 
> 尽管我们一直强烈建议不要这样做，但一些开发人员已选择使用不受支持的 API 或内部 API。**例如，许多开发人员正在使用**1.0 和 1.1 中存在的内部亮度控制和蓝牙切换 API。一个错误——现在在 Android 1.5 中得到修复——允许应用程序在不请求许可的情况下使用这些 API。因此，使用这些 API 的应用程序将在 1.5 上中断。除了这些之外，1.5 中不支持的 API 还有其他更改，因此如果您在应用程序中使用了内部 API，则需要更新您的应用程序以停止这样做。即使它们没有在 Android 1.5 上中断，它们也很有可能会在某些更高版本上中断。(**不过也有一些好消息：因为“手电筒”应用程序如此受欢迎，我们在 WindowManager.LayoutParams 类中添加了“screenBrightness”字段，仅用于该用例。**)

# c# - 注册表观察者 C#

> ID：826971
> 
> 赞同：23
> 
> 时间：2009-05-05T21:24:20.117
> 
> 标签：c#, .net-2.0, event-handling, registry

我是 WMI 的新手，我需要在 C# 服务中实现[RegistryValueChangeEvent 。](http://msdn.microsoft.com/en-us/library/aa393042(VS.85).aspx)

我需要一个事件处理程序，每次更改一组注册表值中的任何一个时都会触发该事件处理程序。我想要类似于[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)类的[Changed](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.changed.aspx)事件的行为，但对于注册表值。

如果我可以使用其他一些技术来完成相同的任务，我也会很感激。我的最低要求是它是比我现在拥有的更好的解决方案：每 20 秒轮询一次，并将注册表值与上一个结果进行比较。

请在您的答案中提供示例代码。如果我能获得一个仅查看一个注册表值的示例，那很好。

我需要.Net 2.0 中的解决方案

谢谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-11T18:55:39.437

使用 WMI 有时会很有趣……我想我理解您的问题，因此请查看下面的代码片段，如果您正在寻找它，请告诉我。

```
// --------------------------------------------------------------------------------------------------------------------- 
// <copyright file="Program.cs" company="">
//   
// </copyright>
// <summary>
//   Defines the WmiChangeEventTester type.
// </summary>
// ---------------------------------------------------------------------------------------------------------------------
namespace WmiExample
{
    using System;
    using System.Management;

    /// <summary>
    /// </summary>
    public class WmiChangeEventTester
    {
        /// <summary>
        /// Initializes a new instance of the <see cref="WmiChangeEventTester"/> class.
        /// </summary>
        public WmiChangeEventTester()
        {
            try
            {
                // Your query goes below; "KeyPath" is the key in the registry that you
                // want to monitor for changes. Make sure you escape the \ character.
                WqlEventQuery query = new WqlEventQuery(
                     "SELECT * FROM RegistryValueChangeEvent WHERE " +
                     "Hive = 'HKEY_LOCAL_MACHINE'" +
                     @"AND KeyPath = 'SOFTWARE\\Microsoft\\.NETFramework' AND ValueName='InstallRoot'");

                ManagementEventWatcher watcher = new ManagementEventWatcher(query);
                Console.WriteLine("Waiting for an event...");

                // Set up the delegate that will handle the change event.
                watcher.EventArrived += new EventArrivedEventHandler(HandleEvent);

                // Start listening for events.
                watcher.Start();

                // Do something while waiting for events. In your application,
                // this would just be continuing business as usual.
                System.Threading.Thread.Sleep(100000000);

                // Stop listening for events.
                watcher.Stop();
            }
            catch (ManagementException managementException)
            {
                Console.WriteLine("An error occurred: " + managementException.Message);
            }
        }

        /// <summary>
        /// </summary>
        /// <param name="sender">
        /// The sender.
        /// </param>
        /// <param name="e">
        /// The e.
        /// </param>
        private void HandleEvent(object sender, EventArrivedEventArgs e)
        {
            Console.WriteLine("Received an event.");
            // RegistryKeyChangeEvent occurs here; do something.
        }

        /// <summary>
        /// </summary>
        public static void Main()
        {
            // Just calls the class above to check for events...
            WmiChangeEventTester receiveEvent = new WmiChangeEventTester();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T18:54:21.247

您是否仅限于 WMI？如果没有，您可以使用[RegNotifyChangeKeyValue](http://www.pinvoke.net/default.aspx/advapi32/RegNotifyChangeKeyValue.html)包装器，例如[RegistryMonitor](http://www.codeproject.com/Articles/4502/RegistryMonitor-a-NET-wrapper-class-for-RegNotifyC)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T00:54:34.527

正如其他人指出的那样，您真的不需要 WMI。我也使用[RegistryMonitor](http://www.codeproject.com/KB/system/registrymonitor.aspx)没有问题。

如果您需要示例，页面本身已经有 RegistryMonitor 的示例代码。您是否在代码项目中向下滚动到这一点：

```
public class MonitorSample
{
    static void Main() 
    {
        RegistryMonitor monitor = new 
          RegistryMonitor(RegistryHive.CurrentUser, "Environment");
        monitor.RegChanged += new EventHandler(OnRegChanged);
        monitor.Start();

        while(true);

        monitor.Stop();
    }

    private void OnRegChanged(object sender, EventArgs e)
    {
        Console.WriteLine("registry key has changed");
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T21:28:17.207

您需要为此使用 WMI。请参阅[http://msdn.microsoft.com/en-us/library/aa393035.aspx](http://msdn.microsoft.com/en-us/library/aa393035.aspx)

# winforms - 检测 Winforms 中的 gdi / 用户处理程序泄漏

> ID：826974
> 
> 赞同：4
> 
> 时间：2009-05-05T21:26:00.127
> 
> 标签：winforms, controls, memory-leaks, profiling

我做了很好的 winforms 2.0 应用程序，它运行良好，客户仍然很高兴，但不幸的是我无法解决一个问题。问题是，在使用应用程序几个小时后，gdi 用户句柄数量不断上升，最终进程无法分配更多对象，应用程序崩溃......

我没有做任何花哨的事情，它是常规应用程序、一些表单、更多模态表单、一些 datagridviews 和很多 tablelayoutpanels，我在其中添加了很多标签和文本框。

我的问题是：

*   是否有任何关于在运行时在表单上添加/删除常规系统控件的“推荐实践”（dgv/tlp）
*   如何检测系统句柄的泄漏 - 最好使用 Visual Studio 和一种免费插件（分析器？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T21:47:53.990

检测图形和窗口句柄泄漏非常困难。至于在运行时找到它们的特定策略，我不能提出任何建议（尽管我很想听听别人的！）。

至于防止它们，这里有几个提醒：

*   虽然`Control`类的终结器会调用`Dispose()`，但这是不确定的。您不能保证任何对象都会被垃圾收集器最终确定。很可能会，但这不是保证。
*   与上述一致，Forms 是一个例外。当 a`Form`以非模态方式显示时（意思是通过`Show()`, NOT `ShowDialog()`），那么当`Form`关闭时它会确定性地调用`Dispose()`. 显示的表单`ShowDialog()`必须`Dispose()`手动调用才能确定性地清理控制句柄。
*   牢记这两件事，您可以做的最重要的事情是确保您始终调用`Dispose()`您明确创建的任何实现`IDisposable`. 这包括`Form`s、`Control`s、对象，甚至像和`Graphics`之类的图形助手类。所有这些类都实现了，一旦你不再需要它们，它们都需要被丢弃。`Pen``Brush``IDisposable`
*   尝试缓存图形实用程序类，假设您正在使用一些。虽然 a`Pen`和 a`Brush`创建起来相当轻巧，但它们确实占用了句柄，并且需要在完成后处理掉。与其一直创建它们，不如创建一个缓存管理器，它允许您传递将在构造函数中为这些对象使用的参数并保留该对象。使用相同参数的重复调用仍应仅使用一个实例。然后，您可以定期或在应用程序中的特定位置刷新缓存（如果您知道它们在哪里）。

遵循这些准则将大大减少（如果不能消除）您的手柄泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T01:11:45.030

我发现使用任务管理器和可见的 GDI 对象列对于查找此类泄漏至关重要。您可以通过在调用之前中断来定位特定区域，记下 GDI 对象，然后在可疑调用之后中断以确定对象是否被正确释放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T15:29:36.040

两个有用的 GDI 泄漏跟踪工具的源代码可以在这里找到：[link text](http://msdn.microsoft.com/en-us/magazine/cc188782.aspx)

我已在许多 Visual Studio C++ 项目中成功使用它。我不确定我是否也使用 .NET。

# php - PHP/SQL 数据库查询良好实践和安全性

> ID：826981
> 
> 赞同：8
> 
> 时间：2009-05-05T21:28:56.830
> 
> 标签：php, mysql, security, sql-injection

所以我是一个经验丰富的 php 开发人员，自 2007 年以来一直在“做这该死的事”；但是，在保护我的应用程序方面，我仍然相对不成熟。在某种程度上，我并不真正了解我知道的一切，我可以而且应该。

我已经拿起了[Securing PHP Web Applications](https://rads.stackoverflow.com/amzn/click/com/0321534344)并且正在阅读我的方式来测试它。我有一些与数据库查询相关的一般 SO 组的问题（主要在 mysql 下）：

创建将数据放入数据库的应用程序时，mysql_real_escape_string 和对输入数据的常规检查（is_numeric 等）是否足够？与sql注入不同的其他类型的攻击呢？

有人可以用比你制作它们并调用它们更多的信息来解释存储过程和准备好的语句。我想知道它们是如何工作的，在幕后进行了哪些验证。

我在 php4 绑定环境中工作，而 php5 暂时不是一个选项。以前有没有其他人担任过这个职位，当所有酷孩子都在使用那个甜蜜的新 mysqli 界面时，你做了什么来保护你的应用程序？

人们发现有哪些普遍的良好实践是有利的，强调创建能够承受升级和可能迁移的基础架构（例如将 php4 迁移到 php5）。

注意：已经四处搜索找不到任何与 php-mysql 安全性类似的东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T23:56:53.260

具有 owasp 链接的 Javier 的答案是一个好的开始。

您还可以做更多的事情：

1.  关于 SQL 注入攻击，您可以编写一个函数，从输入中删除常见的 SQL 语句，如“DROP”或“DELETE * WHERE”，如下所示：

    *$sqlarray = array(" DROP ","or 1=1","union select","SELECT * FROM","select host","create table","FROM users","users WHERE");*

    然后编写将根据该数组检查您的输入的函数。确保 $sqlarray 中的任何内容都不是您的用户的常见输入。（不要忘记在此使用 strtolower，谢谢 lou）。

2.  我不确定 memcache 是否适用于 PHP 4，但您可以通过在 Y 时间段内仅允许某个远程 IP 访问 process.php 页面 X 次来使用 memcache 设置一些垃圾邮件保护。

3.  特权很重要。如果您只需要插入权限（例如，订单处理），那么您应该使用只有插入权限和可能选择权限的用户登录到订单处理页面上的数据库。这意味着即使 SQL 注入通过，他们也只能执行 INSERT / SELECT 查询，而不能删除或重组。

4.  把重要的php处理文件放在/include等目录下。然后禁止所有 IP 访问该 /include 目录。

5.  在用户会话中使用用户的代理 + remoteip + 你的 salt 放置一个加盐的 MD5，并在每次页面加载时验证其 cookie 中是否存在正确的 MD5。

6.  禁止某些标头 ( [http://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST](http://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST) )。禁止 PUT（如果您不需要文件上传）/TRACE/CONNECT/DELETE 标头。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-06T11:31:39.907

我的建议：

1.  放弃 mysqli 以支持[PDO](http://www.php.net/pdo "请参阅 PHP 数据对象手册")（使用 mysql 驱动程序）
2.  使用 PDO 参数化的预处理语句

然后，您可以执行以下操作：

```
$pdo_obj = new PDO( 'mysql:server=localhost; dbname=mydatabase', 
                    $dbusername, $dbpassword );

$sql = 'SELECT column FROM table WHERE condition=:condition';
$params = array( ':condition' => 1 );

$statement = $pdo_obj->prepare( $sql, 
    array( PDO::ATTR_CURSOR => PDO::CURSOR_FWDONLY ) );
$statement->execute( $params );
$result = $statement->fetchAll( PDO::FETCH_ASSOC ); 
```

**优点：**

1.  不再需要手动转义，因为 PDO 为您完成了这一切！
2.  突然切换数据库后端相对容易。

**缺点：**

*   我想不出任何。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T21:42:08.297

我通常不使用 PHP，因此无法针对您的要求提供专门的建议，但我建议您查看 OWASP 页面，尤其是前 10 个漏洞报告：[http ://www.owasp.org /index.php/Top_10_2007](http://www.owasp.org/index.php/Top_10_2007)

在该页面中，对于每个漏洞，您都会获得一个列表，其中列出了您可以采取哪些措施来避免不同平台（.Net、Java、PHP 等）中的问题。

关于准备好的语句，它们的工作原理是让数据库引擎知道在特定查询期间需要多少参数和期望的类型，使用这些信息，引擎可以理解哪些字符是实际参数的一部分，而不是应该被解析为SQL 像一个 '（撇号）作为数据的一部分，而不是一个 ' 作为字符串分隔符。抱歉，我无法提供更多针对 PHP 的信息，但希望这会有所帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-06T12:53:27.310

AFAIK，PHP/mySQL 通常没有参数化查询。

使用`sprintf()`with`mysql_real_escape_string()`应该可以很好地工作。如果您使用适当的格式字符串`sprintf()`（例如整数的“%d”），您应该是非常安全的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-06T08:54:57.710

[`mysql_real_escape_string`](http://php.net/mysql_real_escape_string)我可能错了，但在用户提供的数据上使用还不够吗？

除非它们是数字，在这种情况下，您应该确保它们实际上是数字，而不是使用例如[`ctype_digit`](http://php.net/ctype_digit)或[`is_numeric`](http://php.net/is_numeric)或[`sprintf`](http://php.net/sprintf)（使用`%d`或`%u`强制输入数字）。

此外，为您的 php 脚本设置一个只能选择、插入、更新和删除的 mysql 用户可能是个好主意......

* * *

**来自 php.net 的示例**

> 示例 #3 一个“最佳实践”查询
> 
> 在每个变量周围使用 mysql_real_escape_string() 可以防止 SQL 注入。此示例演示了查询数据库的“最佳实践”方法，与 Magic Quotes 设置无关。
> 
> 查询现在将正确执行，SQL 注入攻击将不起作用。
> 
> ```
>  <?php
>     if (isset($_POST['product_name']) && isset($_POST['product_description']) && isset($_POST['user_id'])) {
>         // Connect
> 
>         $link = mysql_connect('mysql_host', 'mysql_user', 'mysql_password');
> 
>         if(!is_resource($link)) {
> 
>             echo "Failed to connect to the server\n";
>             // ... log the error properly
> 
>         } else {
> 
>             // Reverse magic_quotes_gpc/magic_quotes_sybase effects on those vars if ON.
> 
>             if(get_magic_quotes_gpc()) {
>                 $product_name        = stripslashes($_POST['product_name']);
>                 $product_description = stripslashes($_POST['product_description']);
>             } else {
>                 $product_name        = $_POST['product_name'];
>                 $product_description = $_POST['product_description'];
>             }
> 
>             // Make a safe query
>             $query = sprintf("INSERT INTO products (`name`, `description`, `user_id`) VALUES ('%s', '%s', %d)",
>                         mysql_real_escape_string($product_name, $link),
>                         mysql_real_escape_string($product_description, $link),
>                         $_POST['user_id']);
> 
>             mysql_query($query, $link);
> 
>             if (mysql_affected_rows($link) > 0) {
>                 echo "Product inserted\n";
>             }
>         }
>     } else {
>         echo "Fill the form properly\n";
>     } 
> ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-06T08:47:28.040

对涉及写入数据库的任何活动使用存储过程，并对所有选择使用绑定参数。

# wpf - 使 WPF 组合框填充整个列宽

> ID：826985
> 
> 赞同：12
> 
> 时间：2009-05-05T21:30:54.000
> 
> 标签：wpf, combobox, styles

我在`ComboBox`拉伸以填充`GridViewColumn`. 调整列大小时，它也应该调整大小。

在下面的示例中，我有`StackPanel`一个`ComboBox`内部。这设置为拉伸，实际上会拉伸以填充`StackPanel`宽度。

然后我添加一个`ListView`与一列，包含一个`StackPanel`与一个`ComboBox`。the`StackPanel`和 the`ComboBox`都设置为拉伸，但它们没有。我使用背景颜色来识别 s 的大小，除非我设置宽度或向其添加需要更多宽度`StackPanel`的元素，否则没有红色。`ComboBox`

我也尝试过使用该`HorizontalContentAlignment`属性，但没有成功。

```
<StackPanel Height="59" Margin="45,12,38,0" VerticalAlignment="Top" Background="Green">
    <ComboBox HorizontalAlignment="Stretch" />
</StackPanel>

<ListView x:Name="MyListView" Margin="0,106,0,0">
    <ListView.View>
        <GridView>
            <GridViewColumn Header="Num" Width="70">
                <GridViewColumn.CellTemplate>
                    <DataTemplate>
                        <StackPanel Background="red" Orientation="Horizontal" HorizontalAlignment="Stretch">
                            <ComboBox HorizontalAlignment="Stretch" />
                        </StackPanel>
                    </DataTemplate>
                </GridViewColumn.CellTemplate>
            </GridViewColumn>
        </GridView>
    </ListView.View>
    <ListViewItem></ListViewItem>
</ListView> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-05T21:50:25.140

尝试设置`Style`. `ListViewItem`我还删除了您的 StackPanel。

```
<ListView x:Name="MyListView" Margin="0,106,0,0">
    <ListView.Resources>
        <Style TargetType="ListViewItem">
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        </Style>
    </ListView.Resources>

    <ListView.View>
        <GridView>
            <GridViewColumn Header="Num" Width="170">
                <GridViewColumn.CellTemplate>
                    <DataTemplate>
                        <ComboBox />
                    </DataTemplate>
                </GridViewColumn.CellTemplate>
            </GridViewColumn>
        </GridView>
    </ListView.View>

    <ListViewItem></ListViewItem>
</ListView> 
```

# windows - 如何制作自定义键盘布局？

> ID：826986
> 
> 赞同：5
> 
> 时间：2009-05-05T21:31:24.797
> 
> 标签：windows, keyboard, keyboard-shortcuts

为 Windows 制作键盘布局的最佳方法是什么？

特别是一种将出现在“文本服务和输入语言”列表中的布局，无需购买昂贵的软件。

我知道 Microsoft 键盘布局创建器，但发现它完全受限，因为您无法执行简单的操作，例如重新映射 CapsLock 键或数字键。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T00:44:48.823

要重新映射 CapsLock 或数字键，请使用`remapkey.exe`Windows [2003 Resource Kit Tools](http://www.microsoft.com/downloads/details.aspx?FamilyID=9D467A69-57FF-4AE7-96EE-B18C4790CFFD&displaylang=en)中的内容。

![在此处输入图像描述](https://i.stack.imgur.com/GNMl6.png)

显示在“文本服务和输入语言”中的键盘布局无法重新映射 CapsLock 或执行 Microsoft Keyboard Layout Creator 不支持的任何操作；操作系统只是不支持它。Microsoft 可以对键盘布局执行的任何操作，您都可以使用 Microsoft Keyboard Layout Creator 执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-14T10:35:06.510

你可以自己建造一个！键盘布局基本上是一个带有返回分配表的函数的 .DLL。[驱动套件](http://www.microsoft.com/whdc/Devtools/wdk/default.mspx)包含示例，我的Programmer [Dvorak](http://kaufmann.no/roland/dvorak/)也带有源代码（不是从 DDK 派生的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-05T01:57:20.443

我意识到这个线程已经很老了而且死了，但是提供的答案是不准确的。

[你可以用KbdEdit](https://www.kbdedit.com/)做你想做的事。它不是免费的，但无论如何也不贵，并且有几个版本具有不同的功能。

我还想指出，尽管有最高评价的答案，但实际上，操作系统肯定支持 MSKLC 无法理解、处理或支持的大量复​​杂性和自定义。键盘的许多特性和行为在 Windows 中是可能的，但在 MSKLC 中是不可能的。

在许多情况下，可以使用 MSKLC 创建尽可能多的内容，然后在文本编辑器中修改源文件，然后使用 MSKLC 提供的命令行工具构建 DLL。但我的理解是，在某些时候——具有某些特性——这些工具甚至不能用于生成工作键盘。此时您可以求助于驱动程序开发工具包，但这超出了我的范围。

幸运的是，有 KbdEdit！它非常强大，易于使用，并且可以将大多数键盘上的任何键更改为任何其他键 - 除了“暂停”键，这是 Microsoft 强加的限制，但即使是 AutoHotKey 也可以绕过。

干杯!

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-11T10:43:06.740

你检查过微软键盘布局创建器的新版本吗，我认为你可以用这个新版本做很多事情，比如重新映射键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-08T17:10:30.170

我是[Auto Hotkey](http://www.autohotkey.com/)的粉丝，这是一个免费的、小型的、非模糊的 Windows 工具，用于将宏分配给键。如果您只需要一些特殊字符，例如正确的“引号”（或 em-dashes），那就太好了：

```
#NoEnv;
SendMode Input;

!1::
    {
        Send „
    }
return

!2::
    {
        Send “
    }
return 
```

# visual-studio-2008 - MSTEST / Visual Studio 中使用的 PriorityAttribute 是什么

> ID：826989
> 
> 赞同：13
> 
> 时间：2009-05-05T21:32:37.413
> 
> 标签：visual-studio-2008, mstest

我注意到 Microsoft.VisualStudio.TestTools.UnitTesting.PriorityAttribute 的存在。通过阅读一点，它似乎与测试执行顺序无关。既然如此，这就引出了一个问题：它是用来做什么的？

我很好奇，Visual Studio 本身的任何插件/框架是否有此属性的任何已知用途。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T04:51:36.350

它只是额外的元数据，现在不用于任何特定的东西。唯一影响测试顺序的是使用有序测试

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-18T09:13:51.037

在 Visual Studio 2012 测试资源管理器工具窗口中，当您选择**“特征”视图**时，会同时显示测试优先级和测试类别。然后，具有相同优先级的测试将在一个`Priority [x]`标题下组合在一起，就像测试类别一样。

此外，mstest（Visual Studio 中包含的命令行测试运行程序）允许您仅运行具有最低优先级的测试。从输出`mstest.exe /?`：

```
/minpriority:[priority]       Only tests whose priority is greater than
                              or equal to this value will be executed.
                              Example:
                              /minpriority:0 /maxpriority:2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-28T14:06:30.750

它可用于构建定义（用于构建服务器上的构建）以排除或包含单元测试（至少在 tfs 2010 中）。

# html - 像 Div 一样的 Google Chat

> ID：826992
> 
> 赞同：0
> 
> 时间：2009-05-05T21:33:18.893
> 
> 标签：html, css

任何人都知道如何创建一个部门，就像谷歌邮件中的谷歌聊天中使用的那样？即他们总是在底部。

我希望有一种方法可以仅使用 HTML 和 CSS 创建它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T21:47:26.737

简单的 CSS -`position: fixed; bottom: 0px;`应该适用于所有现代浏览器 - 使用[IE7.js时的 IE6](http://code.google.com/p/ie7-js/ "Dean Edwards 的 IE7.js")

# c# - 将带有附件的列表项从 SharePoint 2003 传输到 SharePoint 2007 中的现有列表

> ID：826999
> 
> 赞同：0
> 
> 时间：2009-05-05T21:35:32.820
> 
> 标签：c#, sharepoint, powershell, sharepoint-2007

我在 SharePoint 2003 网站的列表中有项目，我需要将这些项目添加到 2007 网站的现有列表中。项目有附件。

这如何使用 PowerShell 或 C# 来完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T00:23:18.767

我最终将 C# 程序与 SharePoint Web 服务结合使用来完成此任务。我还使用了 Eric White 博客上的扩展方法（GetXElement、GetXmlNode）在[XMLNodes](http://blogs.msdn.com/ericwhite/archive/2008/12/22/convert-xelement-to-xmlnode-and-convert-xmlnode-to-xelement.aspx)和 XElements 之间进行转换，这使得 SharePoint 中的 XML 更易于使用。

以下是将列表数据（包括附件）从一个 SharePoint 列表（2003 或 2007）传输到另一个所需的大部分代码的模板：

**1) 这是在将新项目添加到目标列表后移动附件的代码。**

```
// Adds attachments from a list item in one SharePoint server to a list item in another SharePoint server.
//   addResults is the return value from a lists.UpdateListItems call.
private void AddAttachments(XElement addResults, XElement listItem)
{
    XElement itemElements = _listsService2003.GetAttachmentCollection(_listNameGuid, GetListItemIDString(listItem)).GetXElement();

    XNamespace s = "http://schemas.microsoft.com/sharepoint/soap/";

    var items = from i in itemElements.Elements(s + "Attachment")
                select new { File = i.Value };

    WebClient Client = new WebClient();
    Client.Credentials = new NetworkCredential("user", "password", "domain");

    // Pull each attachment file from old site list and upload it to the new site list.
    foreach (var item in items)
    {

        byte[] data = Client.DownloadData(item.File);
        string fileName = Path.GetFileName(item.File);
        string id = GetID(addResults);
        _listsService2007.AddAttachment(_newListNameGuid, id, fileName, data);
    }
} 
```

**2) 遍历旧 SharePoint 列表并填充新列表的代码。**

```
 private void TransferListItems()
    {

        XElement listItems = _listsService2003.GetListItems(_listNameGuid, _viewNameGuid, null, null, "", null).GetXElement();

        XNamespace z = "#RowsetSchema";
        foreach (XElement listItem in listItems.Descendants(z + "row"))
        {
            AddNewListItem(listItem);
        }
    }

    private void AddNewListItem(XElement listItem)
    {
        // SharePoint XML for adding new list item.
        XElement newItem = new XElement("Batch",
            new XAttribute("OnError", "Return"),
            new XAttribute("ListVersion", "1"),
            new XElement("Method",
                new XAttribute("ID", "1"),
                new XAttribute("Cmd", "New")));

        // Populate fields from old list to new list mapping different field names as necessary.
        PopulateFields(newItem, listItem);

        XElement addResults = _listsService2007.UpdateListItems(_newListNameGuid, newItem.GetXmlNode()).GetXElement();

        // Address attachements.
        if (HasAttachments(listItem))
        {
            AddAttachments(addResults, listItem);
        }
    }

    private static bool HasAttachments(XElement listItem)
    {
        XAttribute attachments = listItem.Attribute("ows_Attachments");

        if (System.Convert.ToInt32(attachments.Value) != 0)
            return true;

        return false;
    } 
```

**3) 此示例的其他支持代码。**

```
 using System.Collections.Generic;
    using System.Linq;
    using System.Windows.Forms;
    using System.Xml.Linq;
    using System.Net;
    using System.IO;

    // This method uses an map List<FieldMap> created from an XML file to map fields in the
    // 2003 SharePoint list to the new 2007 SharePoint list.
    private object PopulateFields(XElement batchItem, XElement listItem)
    {
        foreach (FieldMap mapItem in FieldMaps)
        {
            if (listItem.Attribute(mapItem.OldField) != null)
            {
                batchItem.Element("Method").Add(new XElement("Field",
                    new XAttribute("Name", mapItem.NewField),
                        listItem.Attribute(mapItem.OldField).Value));
            }
        }

        return listItem;
    }

    private static string GetID(XElement elem)
    {
        XNamespace z = "#RowsetSchema";

        XElement temp = elem.Descendants(z + "row").First();

        return temp.Attribute("ows_ID").Value;
    }

    private static string GetListItemIDString(XElement listItem)
    {
        XAttribute field = listItem.Attribute("ows_ID");

        return field.Value;
    }

    private void SetupServices()
    {
        _listsService2003 = new SPLists2003.Lists();

        _listsService2003.Url = "http://oldsite/_vti_bin/Lists.asmx";
        _listsService2003.Credentials = new System.Net.NetworkCredential("username", "password", "domain");

        _listsService2007 = new SPLists2007.Lists();

        _listsService2007.Url = "http://newsite/_vti_bin/Lists.asmx";
        _listsService2007.Credentials = new System.Net.NetworkCredential("username", "password", "domain");

    }

    private string _listNameGuid = "SomeGuid";      // Unique ID for the old SharePoint List.
    private string _viewNameGuid = "SomeGuid";      // Unique ID for the old SharePoint View that has all the fields needed.
    private string _newListNameGuid = "SomeGuid";   // Unique ID for the new SharePoint List (target).

    private SPLists2003.Lists _listsService2003;    // WebService reference for the old SharePoint site (2003 or 2007 is fine).
    private SPLists2007.Lists _listsService2007;    // WebService reference for the new SharePoint site.

    private List<FieldMap> FieldMaps;   // Used to map the old list to the new list. Populated with a support function on startup.

    class FieldMap
    {
        public string OldField { get; set; }
        public string OldType { get; set; }
        public string NewField { get; set; }
        public string NewType { get; set; }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T02:46:03.760

我可能会尝试使用 Web 服务来实现一些东西 - 我知道 2007 年的附件 url 显示在 ows_Attachements 属性中，一旦你有了它，你就可以进行相当标准的下载/上传。自从我对 2003 年做任何事情以来已经有一段时间了，但我不认为这是一个新领域。

如果您无法从 2003 年获取正确的数据，您始终可以将整个站点迁移到 2007 年，然后使用最新的 API 提取您想要的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T13:20:12.607

您是否尝试过将列表（“包含内容”）保存为模板，将该文件保存到 2007 门户模板，然后使用该“自定义”模板创建一个新列表？如果附件和项目的总和超过 10MB，那将不起作用，而且我不能 100% 确定这将在 2003 > 2007 年起作用。它应该需要 < 10 分钟，所以如果你没有，值得一试已经。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-13T03:04:54.120

我必须为类似的任务创建这个项目： http: [//sourceforge.net/projects/splistcp](http://sourceforge.net/projects/splistcp)，但为了保持修改和创建的时间和用户，我必须在目的地使用本地 API。您的方法的好处似乎是更容易支持 2003 和 2007 作为源。*******************