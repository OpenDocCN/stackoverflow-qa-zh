# StackOverflow 问答 12479000-12479999

# xcode - 如何在视图控制器中添加 UIscrollView ？

> ID：12479002
> 
> 赞同：0
> 
> 时间：2012-09-18T14:25:27.917
> 
> 标签：xcode, uiscrollview, add

我有一个视图控制器 .h 和 .m，但我不知道如何将它添加到 .xib
我选择一个 UIScrollView 并将它放在 .xib 的视图中

但我不能将他的出口依赖于 viewController.h 中声明的 UIScrollView

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:28:56.447

只是试图遵循你正在尝试做的事情。所以你大概已经在你的头文件中定义了你的 UIScrollView ：

```
@property(nonatomic, weak)IBOutlet UIScrollView *scrollView; 
```

现在您需要将其链接到您的 XIB 文件吗？如果您打开 XIB 文件并单击该视图的主窗口以选择它的外部，那么您将在 Xcode 项目的右侧获得可供您使用的属性。在第三个选项卡上，第一个字段包含一个供您选择您定义的 UIScrollView 的 UIViewController 类的位置。选择它。然后，您可以单击并从您的窗口拖动到您的 XIB 中的 UIScrollView 以连接它。

# xslt - 通过 xsl 获取日期：时间

> ID：12479003
> 
> 赞同：0
> 
> 时间：2012-09-18T14:25:36.510
> 
> 标签：xslt, xslt-1.0, xslt-2.0, xsl-fo

目前我正在使用 xsl 在共享点列表中获取 @last_updated_time 的最小值和最大值，类型是字符串（如 9/14/2012 1:26:23 PM）

那么如何显示最早和最晚的时间呢？

PS我尝试删除除数字以外的所有内容，然后转换为int，然后进行比较，但是如何转换，有人可以告诉我一个方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:26:19.543

如果您使用国际格式 (2012-14-09T13:26:23) 而不是美国本地化格式，您会发现在 XSLT（尤其是在 XSLT 2.0 中）中操作日期和时间要容易得多。因此，首先，如果您的数据是美国格式，请编写代码将其转换为 ISO 格式。（这是一个简单的字符串操作练习）。

到达那里后，您可以使用 XSLT 2.0 的 min() 和 max() 函数来查找一组日期或日期/时间值中最早和最晚的时间。或者在 XSLT 1.0 中，您可以对它们进行排序并按排序顺序选择第一个和最后一个。

# java - java notify() 不会为循环中的等待对象释放锁定

> ID：12479013
> 
> 赞同：1
> 
> 时间：2012-09-18T14:25:55.933
> 
> 标签：java, wait, synchronized, notify

问题是：有两个线程，一个是 List 的写入者，另一个是 List 的读取者。如果编写器中的循环有大量迭代，有时阅读器会卡住。在那种情况下，那个读者变成了阻塞（不是等待），这意味着它收到了通知，但作者没有释放监视器？

那么，为什么会这样？最好的办法是什么？（睡得好吗？）

```
import java.util.LinkedList;
import java.util.List;

public class Main {

    private List<Object> m_calls =  new LinkedList<Object>();

    public void startAll(){

        Thread reader = new Thread(new Runnable() {           
            @Override
            public void run() {
                while(true){
                    synchronized(m_calls){
                        while (m_calls.size() == 0) {
                            try {
                                System.out.println("wait");
                                m_calls.wait();
                            } catch (InterruptedException e) {                               
                                return;
                            }
                        }
                        m_calls.remove(0);
                        System.out.println("remove first");
                    }
                }
            }
        });

        Thread writer = new Thread(new Runnable() {           
            @Override
            public void run() {

                for(int i = 0; i < 15; i++){

                    // UN-comment to have more consistent behavior
                    /*try {
                        Thread.sleep(1);
                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }*/
                    synchronized(m_calls){
                        m_calls.add(new Object());
                        m_calls.notifyAll();
                        System.out.println("sent");
                    }
                }
            }
        });

        reader.start();
        writer.start();
    }

    public static void main(String[] args) {     
        new Main().startAll();       
    } 
} 
```

运行上面的代码会给出不同的结果：

---------------------------------- 第一次尝试

等待
发送
发送
发送
发送
发送
发送
发送
发送
发送
发送
发送
发送
发送
移除
先 移除 先
移除 先 移除 先 移除 先 移除 先 移除 先 移除 先 移除 先 移除 先 移除 先 移除 先 移除先 移除 先 移除

---------------------------------- 第二次尝试

等待
发送
发送
发送
发送
发送
发送
移除 先
移除 先
移除 先
移除 先
移除 先
移除 先
等待
发送
发送
移除 先
移除 先
等待
发送
发送
发送
发送
发送
发送
移除
先
移除 先
移除 先
移除 先
移除 先
移除 先
移除 先
等待

------------------------------ 未注释的 sleep() - 符合我们的预期

等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
删除第一个等待
发送
删除第一个
等待
发送
删除第一个
等待
发送
先删除
等待
发送
先删除
等待
发送
删除第一个
等待

编辑1：阅读器线程（其中之一）似乎不再等待，而是被阻塞了，看起来它的监视器收到了通知（在notifyAll（）之后）但是编写器线程没有在其循环中释放锁，这是令人困惑的...

![在此处输入图像描述](../Images/9223924b5efaebd39a23fdfff846b8c2.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:06:04.200

您的特殊情况最好使用[`BlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html). 阻塞队列将阻塞`take`线程（读取器），直到`put`队列中有东西（由写入器）。

这是使用阻塞队列修改后的代码：

```
public class Main {

    private BlockingQueue<Object> m_calls =  new LinkedBlockingQueue<Object>();

    public void startAll(){

        Thread reader = new Thread(new Runnable() {           
            @Override
            public void run() {
                while(!Thread.currentThread().isInterrupted()) {
                    try {
                        Object obj = m_calls.take();
                        System.out.println("obj taken");
                    } catch(InterruptedException ex) {
                        // Let end
                    }
                }
            }
        });

        Thread writer = new Thread(new Runnable() {           
            @Override
            public void run() {
                try {
                    for(int i = 0; i < 15; i++){
                        m_calls.put(new Object());
                        System.out.println("obj put");
                    }
                } catch (InterruptedException ex) {
                    // Let end
                }
            }
        });

        reader.start();
        writer.start();
    }

    public static void main(String[] args) {     
        new Main().startAll();       
    }
} 
```

输出：

```
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken
obj put
obj taken 
```

这将比 a) 使用普通`LinkedList`和 b) 尝试使用您自己的等待/通知更安全。您的等待/通知也很容易受到竞争条件的影响。如果写线程`notify`在读者调用之前调用`wait`，那么读者可以无限期地等待最后一个条目。

我还可以补充一点，这个解决方案对于多个读取器*和*写入器线程是安全的。多个线程可以同时放入和取出所有线程，它们`LinkedBlockingQueue`将为您处理并发。

唯一需要注意的是是否`Object`访问了某些共享资源，但这是与一组对象的并发访问有关的另一个问题。（按照“我可以`obj1`同时`obj2`从两个不同的线程访问吗？”）这完全是另一个问题，所以我不会在这里详细说明解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:39:41.417

没有任何事情会立即发生，这毫无价值，当涉及到线程时，您无法确定独立事件何时发生。（需要同步的原因之一）

```
final long start = System.nanoTime();
new Thread(new Runnable() {
    @Override
    public void run() {
        System.out.printf("Took %,d ns to start this thread%n", System.nanoTime() - start);
    }
}).start(); 
```

印刷

```
Took 2,807,336 ns to start this thread 
```

这听起来可能不是很长，但在 3.2 GHz 下，这几乎是 900 万个时钟周期。在那个时候，计算机可以做很多事情。在您的情况下，一个短暂的线程甚至可以在第二个线程开始之前运行完成。

在第二种情况下，您所看到的是锁定是不公平的（即公平意味着等待时间最长的人首先获得锁定） 原因是正确实现它要慢得多，例如慢 10 倍或更多。出于这个原因，锁往往会被赋予最后拥有它的线程，因为这在大多数情况下效率更高。您可以使用公平锁来获得公平锁，`Lock lock = new ReentrantLock(true);`但除非需要，否则通常不会使用它，因为大多数情况下它的速度较慢而收益甚微。

您可以尝试`-XX:-UseBiasedLocking`使锁定更加公平。

* * *

要使用 ExecutorService 做很多相同的事情，您可以像这样编写代码

```
ExecutorService service = Executors.newSingleThreadExecutor();
// writer
for (int i = 0; i < 15; i++) {
    service.submit(new Runnable() {
        @Override
        public void run() {
            // reader
            System.out.println("remove first");
        }
    });
    System.out.println("sent");
}
service.submit(new Runnable() {
    @Override
    public void run() {
        System.out.println("wait");
    }
});
service.shutdown(); 
```

印刷

```
sent
remove first
sent
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
sent
remove first
remove first
wait 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:30:39.520

在这种情况下进行同步的更好方法是在您的情况下使用 java.util.concurrent.*，也许是 CountDownLatch。

也许在寻找死锁的原因之前先试试这个。

编辑：彼得是对的。它似乎运行正常？

编辑2：好的，在附加信息之后完全不同的故事。我建议您使用超时来强制至少尝试一次阅读，即使在特定时间跨度之后还有更多要写入的内容。 `wait`甚至有一个超时版本... [http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Object.html#wait(long](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Object.html#wait(long) )

但同样：我个人更喜欢使用并发 API。

# mysql - 排除联接表中具有特定值的记录

> ID：12479018
> 
> 赞同：1
> 
> 时间：2012-09-18T14:26:19.007
> 
> 标签：mysql

```
ID      Colour           colour     Size
== Table 1 ==          ====   Table 2   ====
1.**  |  **Blue**     **Blue**    |     Big
2\.    |    Red        **Blue**    |     Average
3\.    |    Yellow     **Blue**    |   **Small**
4\.    |    Orange       Purple    |     Big
5\.    |    Pink         Grey      |     Average
6\.    |    Green        Red       |     Big 
```

你好，

在上表中，在 MySQL 中，我需要返回任何不具有“Small”值的 ID。我遇到了麻烦，好像我告诉它不包括“大小”，因为“小”仍然返回“ID 1”。因为蓝色仍然有一个允许的值（大+平均）。我需要一个完全忽略 Blue 的语句（因此不返回 ID 1），因为它与表 2 中的颜色的链接很小。

抱歉，如果我让这比现在更令人困惑。我是交叉引用两个表的新手。

```
Select Table1.ID
from Table1, Table2
where Table1.colour = Table2.colour
and table2.size != Small 
```

我想我需要一个内部连接查询，还是 Not Exist 语句？

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:33:42.077

不需要内部连接。但是你有语法错误：

```
Select Table1.ID
from Table1, Table2
where Table1.colour = Table2.colour
and NOT EXISTS 
(SELECT T3.size FROM Table2 T3 WHERE 
  T3.size = 'Small' AND T3.colour = Table1.colour); 
```

# android - 用不同的数据膨胀几个相同的布局

> ID：12479024
> 
> 赞同：0
> 
> 时间：2012-09-18T14:26:32.873
> 
> 标签：android, layout-inflater

如何使用不同的文本和图像为多个相同的布局充气？我尝试使用此代码

```
 for (final Tour t : info.tours) {
        final LinearLayout list = (LinearLayout) findViewById(R.id.tours_list);
        Log.d(Const.LOG_TAG, "Add child view to tours_list");
        final LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View child = inflater.inflate(R.layout.tour_item_for_guide_info,
                list, true);
        final ImageView tourImage = (ImageView) findViewById(R.id.tour_image);
        final String tourImgUrl = Const.HOST + t.image;
        imageLoader.DisplayImage(tourImgUrl, tourImage);
        TextView tourText = (TextView) findViewById(R.id.text);
        tourText.setText(t.name);
    } 
```

但是在第一个膨胀布局中设置了文本和图像，替换了以前的文本和图像。我明白会发生什么，因为布局具有相同的 ID。我可以解决吗？我知道 ListView 和适配器，但我想了解是否可以在没有它们的情况下完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:42:44.957

我假设 ImageView 和 TextView - `tourImage`, `tourText`- 是`R.layout.tour_item_for_guide_info`.

如果是这样，那么当您引用它时，您应该使用`child`视图来获取它们。

换句话说，而不是：

```
ImageView tourImage = (ImageView) findViewById(R.id.tour_image);
TextView tourText = (TextView) findViewById(R.id.text); 
```

你应该有：

```
ImageView tourImage = (ImageView)child.findViewById(R.id.tour_image);
TextView tourText = (TextView)child.findViewById(R.id.text); 
```

不确定这是否会明确解决您的问题，但它看起来像一个错误。

# android - 互联网连接显示在 jellybean android 中强制关闭

> ID：12479025
> 
> 赞同：0
> 
> 时间：2012-09-18T14:26:34.327
> 
> 标签：android, android-layout, android-intent

我想检查手机上的互联网连接，以便播放音频。为了检查互联网连接，我编写了代码，它在除**jellybean Nexus 7 平板电脑**之外的所有 android 版本上都能正常工作。它在nexus 7上显示力量关闭。

这是我的检查代码。

```
private void MyCheckinternet() {
        // TODO Auto-generated method stub
        ConnectivityManager connectivityManager = (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
            if(connectivityManager.getNetworkInfo(ConnectivityManager.TYPE_MOBILE).getState() == NetworkInfo.State.CONNECTED || 
                    connectivityManager.getNetworkInfo(ConnectivityManager.TYPE_WIFI).getState() == NetworkInfo.State.CONNECTED) {
                //we are connected to a network
                connected = true;

            }
            else
            {
                connected = false;

    }

    } 
```

这是**logcat 错误：**

```
09-18 16:20:33.098: E/AndroidRuntime(3224): FATAL EXCEPTION: main 
09-18 16:20:33.098: E/AndroidRuntime(3224): java.lang.NullPointerException
09-18 16:20:33.098: E/AndroidRuntime(3224):at
com.android.twitter.Main.MyCheckinternet(Vmix_Main.java:115)
09-18 16:20:33.098:E/AndroidRuntime(3224):  at com.android.twitter.Main.access$0(Main.java:112)
09-18 16:20:33.098: E/AndroidRuntime(3224):     at
com.android.twitter.Main$3.onClick(Main.java:520)
09-18 16:20:33.098: E/AndroidRuntime(3224):     at
android.view.View.performClick(View.java:4084)
09-18 16:20:33.098: E/AndroidRuntime(3224):     at
android.view.View$PerformClick.run(View.java:16966)
09-18 16:20:33.098: E/AndroidRuntime(3224):     at
android.os.Handler.handleCallback(Handler.java:615)
09-18 16:20:33.098: E/AndroidRuntime(3224):     at
android.os.Handler.dispatchMessage(Handler.java:92)
09-18 16:20:33.098: E/AndroidRuntime(3224):     at android.os.Looper.loop(Looper.java:137) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:39:15.273

```
connectivityManager 
```

或者

```
connectivityManager.getNetworkInfo(ConnectivityManager.TYPE_MOBILE) 
```

一片空白

我的赌注是第二个。在测试它的状态之前测试它是否为 null。（如果未激活移动网络，networkInfo 可能为空）

# xml - 我的 XSLT 的嵌套问题

> ID：12479028
> 
> 赞同：0
> 
> 时间：2012-09-18T14:26:43.903
> 
> 标签：xml, xslt, xpath

尝试在 XSLT 2.0 中编写转换代码。

我的源文档是什么样的（格式错误，但这是我正在处理的）：

```
<p>
       <a>
           WANT TO GRAB TEXT NODE HERE
           <br/>
           <br/>
           <i> WORD </i> 
           DEFINITION TEXT NODE HERE
           <br/>
           <br/>
           <i> WORD </i> 
           DEFINITION TEXT NODE HERE
       </a>
</p> 
```

我的目标是将它纳入我们当前的定义列表的 DTD 标准，因此我的输出看起来类似于以下内容：

```
<p> WANT TO GRAB TEXT NODE HERE </p>
<dl>
    <dlentry>
         <dt><i> WORD </i></dt>
         <dd> ANOTHER TEXT NODE HERE <dd>
         <dt><i> WORD </i></dt>
         <dd> ANOTHER TEXT NODE HERE <dd>
    <dlentry>
<dl> 
```

这是我当前转换的代码片段：

```
**<xsl:template match="a[descendant::i and descendant::br]/node()[1]">
   <p>
     <xsl:value-of select="." />
   </p> 
</xsl:template>**

<xsl:template match="p[string-length(.) gt 600]">
    <dl>
        <dlentry>
            <xsl:apply-templates />
        </dlentry>
    </dl>
</xsl:template>

<xsl:template match="i">
    <dt>
        <i>
            <xsl:value-of select="."/>
        </i>
    </dt>
</xsl:template>

<xsl:template match="text()[preceding-sibling::*[1][self::i]]">
    <dd>
        <xsl:value-of select="normalize-space()"/>
    </dd>
</xsl:template> 
```

我的转换的输出如下所示：

```
<dl>
    <dlentry>
         <p> WANT TO GRAB TEXT NODE HERE </p>
         <dt><i> WORD </i></dt>
         <dd> ANOTHER TEXT NODE HERE </dd>
         <dt><i> WORD </i></dt>
         <dd> ANOTHER TEXT NODE HERE </dd>
    </dlentry>
</dl> 
```

我希望它`<p>`高于`<dl>`并处于同一水平。有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T16:18:05.053

这个：

```
 <xsl:template match="p[string-length(.) &gt; 600]">
    <p>
      <xsl:value-of select="a/text()[1]"/>
    </p>
    <dl>
      <dlentry>
        <xsl:apply-templates select="a/node()[position()>1]"/>
      </dlentry>
    </dl>
  </xsl:template>

  <xsl:template match="i">
    <dt>
      <i>
        <xsl:value-of select="."/>
      </i>
    </dt>
  </xsl:template>

  <xsl:template match="text()[preceding-sibling::*[1][self::i]]">
    <dd>
      <xsl:value-of select="normalize-space()"/>
    </dd>
  </xsl:template> 
```

应该可以工作 - 它分别处理`<a>`标签中的初始文本节点，然后将模板应用于其他节点（`position()>1`）

# c# - 如何将此 SQL Order By 语句转换为 LINQ-To-Object？

> ID：12479029
> 
> 赞同：2
> 
> 时间：2012-09-18T14:26:44.800
> 
> 标签：c#, sql, linq, linq-to-sql, sql-order-by

这是 SQL ORDER BY：

```
order by case when [order] is null then 1 else 0 end, [order] 
```

如何在 LINQ-To-Object 语句中编写它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:32:35.823

**方法语法**

```
var query = enumerable.OrderBy(x => x.order == null ? 1 : 0).ThenBy(x => x.order); 
```

**查询语法**

```
var query = from x in enumerable
            orderby (x.order == null ? 1 : 0), x.order
            select x; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:35:17.067

假设 order 是一个可为空的值（不是对象），您应该可以使用它：

```
orderby null == order ? 1 : 0, order 
```

如果它是一个对象，你可以尝试

```
orderby null == order ? 1 : 0, order.PropertyName 
```

# php - Wordpress php：显示页面的子项（编辑现有代码）

> ID：12479034
> 
> 赞同：1
> 
> 时间：2012-09-18T14:27:03.997
> 
> 标签：php, wordpress, customization, custom-taxonomy

我正在帮助一个朋友对 wordpress 主题进行一些更改。目前显示子页面仅适用于一个父页面及其子页面（id 为 31 的那个），但我们希望它适用于所有页面（及其子页面）。我想或多或少地保持代码不变，只需进行必要的更改以应用于所有人。

虽然我很擅长 css 和 html，但 php 并不是我真正的强项，所以如果你能帮助我解决这个问题，我将不胜感激。这是现有的代码：

```
$currentPageId = get_the_ID();

$pages = get_pages('child_of=31');
$i=0;
foreach($pages as $child) {
$childrenPageID[$i] = $child->ID;
$i++;
}

if ( (get_the_ID() == 31) || ( in_array($currentPageId, $childrenPageID)) ) {  

    $taxonomy     = 'portfoliocat';
    $orderby      = 'name'; 
    $show_count   = 0;      // 1 for yes, 0 for no
    $pad_counts   = 0;      // 1 for yes, 0 for no
    $child_of     = 5;
    $show_count   = 1;
    $title_li     = null;

    $args = array(
      'taxonomy'     => $taxonomy,
      'orderby'      => $orderby,
      'show_count'   => $show_count,
      'pad_counts'   => $pad_counts,
      'child_of'     => $child_of,
      'show_count'   => $show_count,
      'title_li' => $title_li 
    );

    ?>

    <div style="overflow:auto; margin-bottom:20px;">
        <ul style="list-style-type:none; margin-left: 0px;">
        <?php
        $cat = get_query_var('cat');

        // count all categories
        $totalCount = count(get_categories($args));
        $currentCount = 0;

        foreach(get_categories($args) as $category) {

            // get current number of stack
        $currentCount = $currentCount + 1;

        global $wpdb;
        $lookForValue = $category->slug;

        $querystr = "SELECT post_id
                     FROM $wpdb->postmeta
                     WHERE meta_key = 'category-include' AND meta_value = '".$lookForValue."';
        ";
        $postid = $wpdb->get_var($wpdb->prepare($querystr));

            // logic to remove last trunk
            if ($totalCount != $currentCount  ) {
            echo '<li class="cat-item"><a class="name" style="font-weight:bold" href="/?page_id='.$postid.'">' . $category->name.'</a>&nbsp;&nbsp;&nbsp;<span style="color: #999;">|</span>&nbsp;</li>';
            }
            else {
            echo '<li class="cat-item"><a class="name" style="font-weight:bold" href="/?page_id='.$postid.'">' . $category->name.'</a></li>';   
            }
        }?>
        </ul>
   </div>

 } 
```

我猜我需要更改 if 子句，但不知道用什么替换它。有什么建议么？

提前致谢！乔安娜

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:37:19.330

```
// If CHILD_OF is not NULL, then this page has a parent
// Therefore, list siblings i.e. subpages of this page's parent

if($post->post_parent){
    wp_list_pages('title_li=&include='.$post->post_parent);
    wp_list_pages('title_li=&child_of='.$post->post_parent);
}else{
    // If CHILD_OF is zero, this is a top level page, so list subpages only.
    wp_list_pages('title_li=&include='.$post->ID);
    wp_list_pages('title_li=&child_of='.$post->ID);
} 
```

# ios - 将 ResKit 集成到现有的 Core Data 应用程序中

> ID：12479036
> 
> 赞同：3
> 
> 时间：2012-09-18T14:27:14.183
> 
> 标签：ios, core-data, restkit

我有一个现有的 Core Data 应用程序，现在我想为我的对象的远程存储添加 REST 支持。我决定集成 RestKit，因为这似乎是（迄今为止）最成熟的 REST 支持框架，但对它的核心数据集成部分还有些不清楚。

由于到目前为止我有一个工作应用程序，我不想将所有核心数据工作完全交给 RestKit，但似乎我不能告诉 RestKit 映射 NSManagedObjects，除非我也让它管理对象存储。我得出这个结论是因为 RKManagedObjectMapping 类在为托管类设置映射时需要 RKManagedObjectStore。RKManagedObjectStore 似乎希望通过其各种初始化程序来控制数据库文件。

这个对吗？

理想情况下，我想像现在一样维护我的本地商店，并通过 RestKit 添加“远程处理”功能。想到的唯一方法是拥有我的核心数据类的远程变体，并使用它们在两个模型之间进行代理。

我忍不住想我错过了什么。任何指针或示例代码将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T23:31:56.313

As I understand it RestKit does not take over the management. They just wrap it and adds convenience methods to make setting up and getting to the managed objects easier. I tried it with my data on the simulator past couple of weeks and have no issues. I have yet to deploy this change to the device but soon. So let's suppose you already have an RKObjectMananger initialized. Let me know if this helps.

# linux - bash 后台进程不起作用，或者我错过了什么？

> ID：12479037
> 
> 赞同：0
> 
> 时间：2012-09-18T14:27:15.760
> 
> 标签：linux, bash, background-process

我编写了一个脚本来在我提供的页面之间拆分我的 pdf 文件，并使用它们压缩它们`gs`，然后将其输出到 pdf 文件。我想在后台运行我的脚本，但我错过了什么吗？我应该`&`在行尾使用，但它仍然打印输出。所以我使用：

```
./gs 12 20 temp > /dev/null & 
```

但它只是进入后台，我应该使用`fg`它来实际运行它。那我错过了什么？`&`应该将进程发送到后台，但它会在后台停止。我希望它在后台运行。

**编辑：**

问题解决了。查找脚本创建的错误文件是我的错误。

它就像一个魅力！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:03:01.253

输出来自您的外壳。当您后台作业时，它会打印作业 ID`[1]`和进程 ID `9324`，以便您可以操作后台作业。它表明该作业实际上正在后台运行。

要将其带回前台，`fg %1`（要引用作业 ID，请使用百分号）或将其杀死，`kill 9324`.

# android - 在 ICS 中打开关闭 GPS

> ID：12479039
> 
> 赞同：-3
> 
> 时间：2012-09-18T14:27:26.540
> 
> 标签：android, gps

> **可能重复：**
> [ICS Android 以编程方式启用 gps？[使用另一种方法关闭]](https://stackoverflow.com/questions/10302894/ics-android-enable-gps-programmatically-closed-using-an-alternative-approach)

我使用下面的代码以编程方式启用和禁用 GPS，并在 2.2 和 2.3 中完美运行。

```
Intent i = new Intent();
i.setClassName("com.android.settings", "com.android.settings.widget.SettingsAppWidgetProvider"); 
i.addCategory(Intent.CATEGORY_ALTERNATIVE);
i.setData(Uri.parse("3"));     
context.sendBroadcast(i); 
```

但是，当尝试使用 ICS (4.0) 时，发现它不起作用。然后我发现这是一个错误，如下面的链接。 [http://code.google.com/p/android/issues/detail?id=7890](http://code.google.com/p/android/issues/detail?id=7890)

我相信我们已经修复了 ICS。

谁能告诉我在 ICS 中是否有解决此问题的替代方法？

我认为操作系统荒谬的“开源”有很多限制。我已经开始后悔选择在 Android 上开发我们的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:30:27.440

我相信这是一项安全功能，您无法以编程方式更改 GPS 状态。

为什么开源意味着它不应该有限制？我很困惑。开源只是意味着您可以访问源代码。

就个人而言，为 Android 开发比使用 Cocoa Touch 为 iOS 开发要痛苦得多。

编辑：

尝试使用它让用户知道他们需要启用 GPS。

（来源： http: [//manishkpr.webheavens.com/android-syste-gps-setting-intent/](http://manishkpr.webheavens.com/android-syste-gps-setting-intent/)）

```
private void checkGPS(){
     locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);
     locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000L,1.0f, this);
     boolean isGPS = locationManager.isProviderEnabled (LocationManager.GPS_PROVIDER);
     if(isGPS){
        showToast("Gps On");
     }else{

        startActivityForResult(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS), 0);
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:32:04.667

这些限制是因为安全问题。您不应该尝试实现这种情况，因为它现在可以工作，但在接下来的几天内可以修复 - 例如自定义 rom。

管理 GPS 的最佳解决方案是打开 Android 的 GPS 首选项并让用户手动启用/禁用 GPS。

# jquery - Google + 按钮未显示！分享这个社交按钮

> ID：12479041
> 
> 赞同：0
> 
> 时间：2012-09-18T14:27:33.550
> 
> 标签：jquery, html, google-plus, social, sharethis

我已经从 sharethis 在我的网站上包含了此代码。

```
<script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "68bb8805-8d8a-4b97-a383-4c33b1aaab26"}); </script> 
```

和

```
<span class='st_plusone_hcount' displayText='Google +1'></span>
<span class='st_fblike_hcount' displayText='Facebook Like'></span>
<span class='st_twitter_hcount' displayText='Tweet'></span>
<span class='st_email_hcount' displayText='Email'></span> 
```

我无法显示 google plus 按钮！请参阅：www(dot)mudhuggers(dot)co.uk

我收到一个 JS 错误：this.queue{messageSet} is undefined

有人有想法吗？

# php - 我可以得到网站的位置吗？

> ID：12479051
> 
> 赞同：0
> 
> 时间：2012-09-18T14:28:05.820
> 
> 标签：php, javascript, geolocation, location

让我通过一个例子来解释：-

假设[http://www.washingtontimes.com/news/2012/sep/18/pentagon-stops-training-partnering-afghan-troops-b/](http://www.washingtontimes.com/news/2012/sep/18/pentagon-stops-training-partnering-afghan-troops-b/)是用户提交的 URL，现在我需要的是php 或 javascript 或任何其他 web 脚本语言中的方法，它可以为我提供与上述 url 对应的位置，例如该网站托管在哪个国家/地区，因为在这种情况下结果应该是“美国”。它是由许多网站完成的，例如[http://www.site24x7.com](http://www.site24x7.com)，但我需要一个代码来做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:47:21.437

您可以这样做，从 url 获取主机名，然后使用 gethostbyname() 获取 IP，然后从 whois 站点获取有关 IP 的一些信息。

```
<?php 
$url  = 'http://www.washingtontimes.com/news/2012/sep/18/pentagon-stops-training-partnering-afghan-troops-b/';

$host = parse_url($url,PHP_URL_HOST);
$ip = gethostbyname($host);
$info = get_ip_info($ip);

$result = array('host'=>$host, 'ip'=>$ip, 'info'=>$info);

print_r($result);
/*
Array
(
    [host] => www.washingtontimes.com
    [ip] => 38.118.71.70
    [info] => Array
        (
            [host] => theconservatives.com
            [country] => United States
            [country_code] => USA
            [continent] => North America
            [region] => Virginia
            [latitude] => 38.9687
            [longitude] => -77.3411
            [organization] => Cogent Communications
            [isp] => Cogent Communications
        )

)
*/
echo $result['info']['country']; //United States

function get_ip_info($ip = NULL){
    if(empty($ip)) $ip = $_SERVER['REMOTE_ADDR'];

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,'http://www.ipaddresslocation.org/ip-address-locator.php');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch, CURLOPT_POST,true);
    curl_setopt($ch, CURLOPT_POSTFIELDS,array('ip'=>$ip));
    $data = curl_exec($ch);
    curl_close($ch);
    preg_match_all('/<i>([a-z\s]+)\:<\/i>\s+<b>(.*)<\/b>/im',$data,$matches,PREG_SET_ORDER);
    if(count($matches)==0)return false;
    $return = array();
    $labels = array(
    'Hostname'          => 'host',
    'IP Country'        => 'country',
    'IP Country Code'   => 'country_code',
    'IP Continent'      => 'continent',
    'IP Region'         => 'region',
    'IP Latitude'       => 'latitude',
    'IP Longitude'      => 'longitude',
    'Organization'      => 'organization',
    'ISP Provider'      => 'isp');
    foreach($matches as $info){
        if(isset($info[2]) && !is_null($labels[$info[1]])){
            $return[$labels[$info[1]]]=$info[2];
        }
    }

    return (count($return))?$return:false;
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:40:58.207

您需要的是内置在 PHP 中的。使用 gethostbyname 方法查找 IP 地址，然后使用免费 API 查找位置（例如 MaxMind） PHP 中还有一个 parse_url 方法可以帮助您从 URL 获取实际域名。当有更安全的方法可用时，不要使用 shell_exec。

# objective-c - 如何使用来自服务器的 XML 响应？

> ID：12479052
> 
> 赞同：1
> 
> 时间：2012-09-18T14:28:06.860
> 
> 标签：objective-c, xml, uitableview

我正在编写一个应用程序，它在私人服务器上进行在线搜索并向用户显示结果。我想使用表格视图来显示结果。

我能做的是：发送数据、接收响应并解析 XML 并将结果保存在数组中。

问题是：我无法访问存储响应数据的数组，超出方法：`- (void)connectionDidFinishLoading:(NSURLConnection *)connection`。

但是我可以在这个方法中访问同一个数组。我是初学者，我很困惑。我创建了一个实例变量并使用方法中的 searchResults 数组进行了初始化`connectionDidFinishLoading`，但是当我尝试从 Method:connectionDidFinishLoading 中访问该数组时，我总是收到错误消息：

`Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 2 beyond bounds for empty array`

我只是不明白为什么这个实例变量只是局部初始化的。

所以问题是：如何从 Method: 访问从服务器获取的数据`connectionDidFinishLoading`？

这是我的代码：

```
-  (void)transmitXMLRequest:(NSData *)data{
    NSURL *webServiceURL = [NSURL URLWithString:@"some_url"];

    NSMutableURLRequest *urlRequest = [NSMutableURLRequest requestWithURL:webServiceURL];
    [urlRequest setHTTPMethod:@"POST"];
    [urlRequest setValue:@"text/xml" forHTTPHeaderField:@"Content-type"];
    [urlRequest setHTTPBody:data];

    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:urlRequest delegate:self];
    responseData = [[NSMutableData alloc] init];
    [connection start];

    if (!connection) {
        NSLog(@"Failed to submit request");
    } else {
        NSLog(@"Request submitted");
    }    
} 
```

以及委托方法：

```
-     (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{    
    // responseData is an instance variable.
    [responseData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    // responseData is an instance variable.   
    [responseData appendData:data];

}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{

    connection = nil;
    responseData = nil;

    NSLog(@"Connection failed! Error - %@ %@",
          [error localizedDescription],
          [[error userInfo] objectForKey:NSURLErrorFailingURLStringErrorKey]);
} 
```

我只能在这种方法中访问数据：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{

    NSLog(@"Succeeded! Received %d bytes of data",[responseData length]);

    responseString = [[NSString alloc] initWithData:responseData encoding:NSASCIIStringEncoding];

    NSLog(@"Received file: \n%@", responseString);

    NSData *_data= [responseString dataUsingEncoding:NSUTF8StringEncoding];
    xmlParser = [[XMLParser alloc]loadXML:_data];    // _data is the response from server

    controller.searchResults = [[NSMutableArray alloc] init];
    controller.searchResults = [xmlParser jobs]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:31:03.597

在我看来，你应该使用 SOAP [http://en.wikipedia.org/wiki/SOAP](http://en.wikipedia.org/wiki/SOAP)

> SOAP，最初定义为简单对象访问协议，是一种协议规范，用于在计算机网络中实现 Web 服务时交换结构化信息。它的消息格式依赖于可扩展标记语言 (XML)，并且通常依赖于其他应用层协议，最显着的是超文本传输​​协议 (HTTP) 和简单邮件传输协议 (SMTP)，用于消息协商和传输。

# python - 如何在python（龙卷风）中的websocket循环之外运行函数

> ID：12479054
> 
> 赞同：31
> 
> 时间：2012-09-18T14:28:09.753
> 
> 标签：python, websocket, tornado

我正在尝试通过 websockets 设置一个公共 Twitter 流的小示例。这是我的 websocket.py，它正在工作。

我想知道的是：如何从类 WSHandler 的“外部”与 websocket 交互（即，不仅在接收来自 websocket.js 的消息时回答）？假设我想在同一个脚本中运行一些其他功能，这些功能会发布“你好！” 每五秒钟将其发送到 websocket（浏览器），而无需来自客户端的任何交互。我怎么能那样做？

所以这是一个基本的初学者问题，我想，关于如何处理下面的类。任何方向的任何指示都将不胜感激！

```
import os.path
import tornado.httpserver
import tornado.websocket
import tornado.ioloop
import tornado.web

# websocket
class FaviconHandler(tornado.web.RequestHandler):
    def get(self):
        self.redirect('/static/favicon.ico')

class WebHandler(tornado.web.RequestHandler):
    def get(self):
        self.render("websockets.html")

class WSHandler(tornado.websocket.WebSocketHandler):
    def open(self):
        print 'new connection'
        self.write_message("Hi, client: connection is made ...")

    def on_message(self, message):
        print 'message received: \"%s\"' % message
        self.write_message("Echo: \"" + message + "\"")
        if (message == "green"):
            self.write_message("green!")

    def on_close(self):
        print 'connection closed'

handlers = [
    (r"/favicon.ico", FaviconHandler),
    (r'/static/(.*)', tornado.web.StaticFileHandler, {'path': 'static'}),
    (r'/', WebHandler),
    (r'/ws', WSHandler),
]

settings = dict(
    template_path=os.path.join(os.path.dirname(__file__), "static"),
)

application = tornado.web.Application(handlers, **settings)

if __name__ == "__main__":
    http_server = tornado.httpserver.HTTPServer(application)
    http_server.listen(8888)
    tornado.ioloop.IOLoop.instance().start() 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-18T14:48:42.040

你可以打电话给

```
IOLoop.add_timeout(deadline, callback) 
```

在指定的截止时间超时调用回调（一次，但您可以重新安排），或使用

`tornado.ioloop.PeriodicCallback`如果您有更周期性的任务。

见：[http ://www.tornadoweb.org/en/stable/ioloop.html#tornado.ioloop.IOLoop.add_timeout](http://www.tornadoweb.org/en/stable/ioloop.html#tornado.ioloop.IOLoop.add_timeout)

**更新：一些例子**

```
import datetime

def test():
    print "scheduled event fired"
...

if __name__ == "__main__":
    http_server = tornado.httpserver.HTTPServer(application)
    http_server.listen(8888)
    main_loop = tornado.ioloop.IOLoop.instance()
    # Schedule event (5 seconds from now)
    main_loop.add_timeout(datetime.timedelta(seconds=5), test)
    # Start main loop
    main_loop.start() 
```

`test()`它会在 5 秒后调用。

**更新 2：**

```
import os.path
import tornado.httpserver
import tornado.websocket
import tornado.ioloop
import tornado.web

# websocket
class FaviconHandler(tornado.web.RequestHandler):
    def get(self):
        self.redirect('/static/favicon.ico')

class WebHandler(tornado.web.RequestHandler):
    def get(self):
        self.render("websockets.html")

class WSHandler(tornado.websocket.WebSocketHandler):
    def open(self):
        print 'new connection'
        self.write_message("Hi, client: connection is made ...")
        tornado.ioloop.IOLoop.instance().add_timeout(datetime.timedelta(seconds=5), self.test)

    def on_message(self, message):
        print 'message received: \"%s\"' % message
        self.write_message("Echo: \"" + message + "\"")
        if (message == "green"):
            self.write_message("green!")

    def on_close(self):
        print 'connection closed'

    def test(self):
        self.write_message("scheduled!")

handlers = [
    (r"/favicon.ico", FaviconHandler),
    (r'/static/(.*)', tornado.web.StaticFileHandler, {'path': 'static'}),
    (r'/', WebHandler),
    (r'/ws', WSHandler),
]

settings = dict(
    template_path=os.path.join(os.path.dirname(__file__), "static"),
)

application = tornado.web.Application(handlers, **settings)

import datetime

if __name__ == "__main__":
    http_server = tornado.httpserver.HTTPServer(application)
    http_server.listen(8888)
    tornado.ioloop.IOLoop.instance().start() 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-18T22:48:27.440

我偶然发现了类似的问题。这是我的解决方案。希望这对那里的人有帮助

```
wss = []
class wsHandler(tornado.websocket.WebSocketHandler):
    def open(self):
        print 'Online'
        if self not in wss:
            wss.append(self)

    def on_close(self):
        print 'Offline'
        if self in wss:
            wss.remove(self)

def wsSend(message):
    for ws in wss:
        ws.write_message(message) 
```

要将消息发送到您的 websocket，只需使用以下命令：

```
wsSend(message) 
```

**ws发送更新**

我偶尔会遇到 wsSend 异常。为了修复它，我将代码修改为以下内容：

> ```
> def wsSend(message):
>     for ws in wss:
>         if not ws.ws_connection.stream.socket:
>             print "Web socket does not exist anymore!!!"
>             wss.remove(ws)
>         else:
>             ws.write_message(message) 
> ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-01T08:58:04.643

一种方法是使用**pub-sub**模块。

这意味着您有您的连接*订阅*它，而不是为每个连接设置超时，您只需设置一个超时以在所述时间段后*发布。*

可能实现最多的之一是**redis**。还有一些专门针对龙卷风的模块：例如[toredis](https://github.com/mrjoes/toredis/blob/master/tests/test_handler.py)或[brükva](https://github.com/evilkost/brukva)。

当然，对于一个简单的页面来说，这可能不是必需的，但是可以很好地扩展，并且一旦设置好它就可以很好地维护/扩展。

# graph - 在VB6.0中绘制心电图

> ID：12479055
> 
> 赞同：1
> 
> 时间：2012-09-18T14:28:12.367
> 
> 标签：graph, vb6

VB6.0是否可以画心电图？由于我对 VB 不太熟悉，因此将不胜感激任何类型的帮助。请帮助我。在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T16:01:36.823

最简单的方法是使用`AutoRedraw`属性设置为 true 且`ScaleMode`设置为的图片框`vbPixels`。

对于每个点，您计算 Y 值（取决于允许的最小值和最大值）。要使其扫描，只需将您绘制的每个点的 X 值递增到 0，当它到达图片框 ( `.ScaleWidth`) 的宽度时。

您可以使用图片框的`.Line`方法将当前 X 点后面的区域消隐，并使用`.PSet`绘制新点的方法。

```
Dim X As Long
Dim LastValue As Long

Private Sub AddPoint(ByVal Value As Long)
  'Clear the line behind (for 5 pixels forward)
  Picture1.Line (X, 0)-(X + 5, Picture1.ScaleHeight), vbBlack, BF

  'Draw the new point and the line from the previous point
  Picture1.Line (X - 1, LastValue)-(X, Value), vbGreen
  Picture1.PSet (X, Value), vbGreen

  'Update the last value so we can draw the line between them
  LastValue = Value

  'Increment the X value for the next point
  X = X + 1
  If X = Picture1.ScaleWidth Then X = 0
End Sub 
```

更好的方法是使用您使用类似方法更新的屏幕外图片，并在需要时更新图片框。

# c# - 带有异常处理的方法参数

> ID：12479057
> 
> 赞同：1
> 
> 时间：2012-09-18T14:28:15.277
> 
> 标签：c#, methods

当谈到 C# 时，我显然是一个新手，以下程序来自 Charles Petzold 的一本书，我并不完全理解。该`GetDouble`方法中的参数是一个名为prompt 的字符串。没有任何地方宣布这一点，我认为这就是让我感到困惑的原因。我看到 Main 方法正在调用`GetDouble`并将三个字符串打印到控制台，但这整件事对我来说看起来很奇怪。这是典型的编程设计，还是不是行业标准，而是为了展示如何完成？这本书并没有给出任何答案。我初出茅庐的编程自我不会将字符串传递给 Main 方法。有人可以帮我理顺吗？

```
using System;

class InputDoubles
{
    static void Main()
    {
        double dbase = GetDouble("Enter the base: ");
        double exp = GetDouble("enter the exponent: ");
        Console.WriteLine("{0} to the power of {1} is {2}", dbase, exp, Math.Pow(dbase, exp));
    }

    static double GetDouble(string prompt)
    {
        double value = Double.NaN;
        do
        {
            Console.Write(prompt);
            try
            {
                value = Double.Parse(Console.ReadLine());
            }
            catch
            {
                Console.WriteLine();
                Console.WriteLine("you enter an invalid number!");
                Console.WriteLine("please try again");
                Console.WriteLine();

            }
        }

        while (Double.IsNaN(value));
        return value;

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:35:26.157

> 没有任何地方宣布这一点，我认为这就是让我感到困惑的原因。

等等，它就在那里声明 - 在方法的标题中：

```
static double GetDouble(string prompt)
//                      ^^^^^^^^^^^^^ This is the declaration of prompt 
```

`prompt`与您看到的其他变量的不同之处在于它不是普通变量：它是方法的*形式参数*。

与使用赋值运算符*显式*初始化和赋值的常规变量不同`=`，形式参数是通过调用方法来*隐式赋值的。*当您调用该方法时，您将一个带有*实际参数*的表达式传递给它，它充当该表达式对形参的赋值。想象一下，`prompt`变量是`"Enter the base: "`在第一次调用之前赋值的，然后`"enter the exponent: "`在第二次调用之前赋值，以了解调用时发生了什么`GetDouble`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:35:04.113

该`GetDouble(string)`方法就是这样做的——它从输入中得到一个双精度值。
提示给用户的文本是一个参数，因为要输入两个不同的值：第一个是基数，第二个是指数。
通过使提示成为参数，该`GetDouble(string)`方法可以处理从提示用户输入到返回值的所有事情。
另一种方法是在`GetDouble(string)`. 这两种选择中的哪一种更可取是个人喜好问题。

哦，正如您现在可能已经想到的那样，这与方法中的异常处理无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:47:21.007

你可以这样改变它。它的作用相同，但我认为更容易理解：

```
static void Main()
{ 
    string messageForDbaseParam="Enter the base: ";
    double dbase = GetDouble(messageForDbaseParam);
    string messageForExpParam ="enter the exponent: ";
    double exp = GetDouble(messageForExpParam);
    Console.WriteLine("{0} to the power of {1} is {2}", dbase, exp, Math.Pow(dbase, exp));
}

static double GetDouble(string prompt)
{
    double value = Double.NaN;
    Boolean incorrectValue=true;
    while(incorrectValue)
    {
        Console.Write(prompt);
        try
        {
            value = Double.Parse(Console.ReadLine());
            incorrectValue=false;
        }
        catch 
        {
            Console.WriteLine("error");
        }
    }        
    return value;

} 
```

# tsql - 使用重复的 SELECTS 改进查询？

> ID：12479059
> 
> 赞同：0
> 
> 时间：2012-09-18T14:28:19.790
> 
> 标签：tsql, sybase

我正在执行一个查询，该查询从 2 个不同列的完全相同的表中选择两次，并与另一个表中的同一组数据执行两次比较。

我目前的方法：

```
DELETE FROM MY_TABLE
WHERE MY_TABLE.BUY_ORDER_ID
IN ( SELECT #tmp_table.order_id FROM #tmp_table )
OR MY_TABLE.SELL_ORDER_ID
IN ( SELECT #tmp_table.order_id FROM #tmp_table ) 
```

有没有办法改进查询？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:45:50.627

我已经在 SQL Server 上尝试过了，它似乎更快。我想你可以在sybase上做类似的事情吗？

```
 DELETE FROM MY_TABLE
    WHERE EXISTS 
    (
    SELECT * FROM #tmp_table 
    WHERE
    #tmp_table.order_id = MY_TABLE.BUY_ORDER_ID 
    OR
    #tmp_table.order_id = MY_TABLE.SELL_ORDER_ID
    ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:47:52.630

可能。需要对您的数据进行测试。

```
DELETE MY_TABLE
FROM MY_TABLE m
JOIN #tmp_table 
  on #tmp_table.order_id = m.BUY_ORDER_ID
  or #tmp_table.order_id = m.SELL_ORDER_ID 
```

如果 #tmp_table.order_id 是 PK 或唯一的，则声明它。

分裂的头发，但也许

```
DELETE MY_TABLE
FROM MY_TABLE m
JOIN #tmp_table 
  on #tmp_table.order_id in ( m.BUY_ORDER_ID, m.SELL_ORDER_ID ) 
```

# django - 用 couchdb 数据库替换默认 sqlite 以进行 django 测试优化

> ID：12479063
> 
> 赞同：0
> 
> 时间：2012-09-18T14:28:23.590
> 
> 标签：django, sqlite, unit-testing, couchdb, django-testing

[Django 允许自动数据库路由](https://docs.djangoproject.com/en/dev/topics/db/multi-db/#topics-db-multi-db-routing)。可以有不同的数据库用于测试和生产。测试的默认值是 sqlite3。对于需要超过 10 分钟的单元测试，从`sqlite3`to迁移将有任何显着的时间改进。`couchdb`跑步？

如果可以进行任何测试数据库优化，还能做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:25:19.047

我建议使用完全不同的设置来开发/测试而不是路由器。

如果数据库是测试运行这么长时间的主要原因，通常是因为在测试中使用了固定装置，这些固定装置在每次测试之前加载 - 使用[https://github.com/dnerdy/factory_boy](https://github.com/dnerdy/factory_boy)或类似的解决方案可能会非常有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T16:26:47.887

除非您的 SQLite 使用非常基本，否则不确定您是否可以成功地将 SQLite 替换为 CouchDB 并保存他的所有功能。知道 sqlite 允许做多少事情，这并不容易。

如果您只使用非常简单的 SQL 查询或对查询结果进行复杂计算，CouchDB 可以加快您的测试。由于 CouchDB 视图存储具有按需更新请求语义的即用型结果，这可以为您节省一些 CPU 时间。

但是，您是否尝试过使用[:memory:](http://www.sqlite.org/inmemorydb.html)存储？或者在 tmpfs 上使用测试数据库？另请注意，使用 CouchDB，您的测试可能会受到网络延迟的影响 - HTTP 请求并不像通过驱动程序调用函数那么便宜（sqlite 只是数据库驱动程序，而不是完整的 RDBMS）。

PS 注意，我不是从 Django ORM 或其他人的立场说的，因为通常它们不能作为原生库提供良好的效果。例如，SQLite 允许自定义`SELECT`查询，但`views`很少使用，而 CouchDB 使用预定义`views`而不是自定义查询（`temporary views`）更好地工作。

# asp.net-mvc-3 - 上传文件最多 4 gig

> ID：12479070
> 
> 赞同：0
> 
> 时间：2012-09-18T14:28:47.733
> 
> 标签：asp.net-mvc-3, file-upload, iis-7.5

如何在 iis7.5 和 mvc3 中上传最多 4 GB 的文件注意：我已经 maxAllowedContentLength

```
<system.webServer>
    <security>
       <requestFiltering>
          <requestLimits maxAllowedContentLength="4294967295" />
        </requestFiltering>
    </security>
</system.webServer>
<httpRuntime maxRequestLength="4194304" /> 
```

但我仍然无法上传大小为 3.71 giga 的文件

有什么我忘记做的吗？？？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:30:55.790

ASP.NET（甚至是 .NET 4 版本）有 2 GB 的限制！

此外，在上传如此大的文件时，您最好考虑使用一些（第三方）工具，使您的上传更加稳定。这也使您的用户更快乐。

我读过 .NET 4.5 应该支持更大的文件。但我仍然会为我的用户提供这样的插件：http: [//neatupload.codeplex.com](http://neatupload.codeplex.com)

# asp.net - 自定义授权属性不会被调用

> ID：12479073
> 
> 赞同：0
> 
> 时间：2012-09-18T14:28:59.363
> 
> 标签：asp.net, asp.net-mvc-4

我最近开始将 ASP.Net MVC **2**项目迁移到 MVC 4。现在似乎一切正常（据我目前所知），除了我的自定义授权属性，这根本没有被调用。

**班级**

```
[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class, AllowMultiple = false, Inherited = false)]
public class Authenticated : AuthorizeAttribute 
```

**示例用法**

```
[Authenticated]
public ActionResult ChangePassword(string password) 
```

有什么变化吗？我错过了什么？

***编辑***

当没有调用 Attribute 方法 self 时，我将如何调试它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:31:42.293

不，自定义操作过滤器没有任何变化。假设您有使用此属性装饰的控制器/操作，`OnAuthorization`则将始终调用该属性。

# jquery - 如何在dreamweaver cs6中安装jquery mobile(phonegap)

> ID：12479074
> 
> 赞同：0
> 
> 时间：2012-09-18T14:29:04.977
> 
> 标签：jquery, cordova, dreamweaver

我下载了 Dreamweaver CS6 的试用版。我在 youtube 和 adobe 上看到了教程，并想跟随他们的步骤。但是我有一个问题，我不能在dreamweaver 的移动启动器选项下拥有jquery mobile(phonegap) 选项。我应该为此安装什么以在我的 dw 版本上启用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T08:10:49.387

不知道你有没有发现怎么做。但在 Dreamweaver CS6 中，您在 mobile starter 下选择 JQuery Mobile(local)。我对此也有些困惑，但我尝试了该选项并成功了。希望能帮助到你..

# c - 如何在递归算法中将结果添加到数组中？

> ID：12479075
> 
> 赞同：0
> 
> 时间：2012-09-18T14:29:10.207
> 
> 标签：c, recursion

我正在使用递归算法来列出数组 p = {1,2,3} 的元素的所有可能排列。以下是我正在使用的简单递归实现：

```
void swap(int x, int y){
    int temp = array[x];
    array[x]=array[y];
    array[y]=temp;    
    return;
}

void printArray(int size){
    int i;

    for (i=0;i<size;i++)
        printf("%d ", array[i]);

    printf("\n");    
    return;
}

void permute(int k,int size){
    int i;

    if (k==0)
        printArray(size);
    else{
        for (i=k-1;i>=0;i--){
            swap(i,k-1);
            permute(k-1,size);
            swap(i,k-1);
        }
    }    
    return;
} 
```

问题是我不想打印它们，而是想将每个排列添加到二维数组中。目前，我正在将排列打印到文件中，然后将其读取到二维数组中，但我认为应该有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:35:19.970

使用动态数组。幸运的是，您提前知道了数组的总大小：

```
size_t const n = 3;             //  array size, e.g. [ 0, 1, 2 ]

size_t const nf = factorial(n); //  number of permutations

int * array = malloc(nf * n * sizeof *array);  // space for a flat array of n*nf
size_t  cur = 0;                               // current row

void add_row(int * src)
{
    for (size_t i = 0; i != n; ++i)
    {
        array[cur * n + i] = src[i];
    }
    ++cur;
} 
```

您必须`add_row`准确地调用`nf`时间。在你的程序结束时，说`free(array);`。

数组的`k`^(第 th)行包含`array[k * n]`最多的元素`array[k * n + n]`，从零开始并采用半开惯例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:43:54.797

将这些声明为全局：

```
int **resultArray;
resultArray = malloc( (n!) * sizeof(int *));    // n! : factorial of n
for(i=0; i<(n!); i++)
    resultArray[i] = malloc(size * sizeof(int));
int index = 0; 
```

这填充二维数组：

```
void addToArray(int size){
    int i;
    for(i=0 ; i<size ; i++)
        resultArray[index][i] = array[i];
    index++;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:39:00.340

由于您可以提前知道有多少排列（`n!`对于长度数组`n`），您可以预先创建此数组，然后将其传递给递归函数。可以给递归函数一个参数，告诉它它正在生成`n'th`排列，以便它在写入包含所有排列的数组时知道正确的索引。所以算法是这样的（前面的伪代码）：

```
void doPermute( array, arrayLen, n, permutations ) {
  if ( n < fact(arrayLen) ) {
    /* At this point, generate permutation of array and write it to
     * permutations[n].
     */

    /* Recurse, generating next permutation. */
    doPermute( array, arrayLen, n + 1, permute );
  }
}

int **permute( array, arrayLen ) {
  /* Allocate an array big enough to hold `arrayLen!` versions of the input
   * array.
   */
  int **permutations = malloc( fact( arrayLen ) * (sizeof(int) * arrayLen) );

  /* Invoke recursion */
  doPermute( array, arrayLen, 0, permutations );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T14:30:52.090

我不确定我是否理解这个问题。只需创建一个数组或列表并直接从您的函数中引用它。就像您从任何其他函数访问数组或列表一样。

或者，您可以将数组或列表作为参数传递，并在每次再次递归调用该函数时传递该参数。

# java - JTextArea：如何将字符串从另一个类附加到 JTextArea

> ID：12479076
> 
> 赞同：1
> 
> 时间：2012-09-18T14:29:12.420
> 
> 标签：java, string, jtextarea

我有一个简单的 GUI，它有一个`JTextArea`. 我创建了一种方法来从用户那里获取消息，另一种方法将文本附加到文本区域，如下所示

```
Message m = new Message();

...

private void messageBtnActionPerformed(java.awt.event.ActionEvent evt) {   
     m.getMessage();
}

public void printOnTextArea(String text){
    jTextArea.append(text);
} 
```

我像这样从我的`Message.java`课堂上调用这个方法

```
SimpleGUI simpleGUI = new SimpleGUI():

...

public void getMessage(){
    String message = JOptionPane.showInputDialog("Please enter message");
    printMessage(message);
}

public void printMessage (String message){
    simpleGUI.printOnTextArea(message);
} 
```

但是，即使输入到 JOptionPane 的消息被`printOnTextArea()`正确传递给了，它也没有出现在 JTextArea 上，有没有人看到我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:35:25.993

几个月前我发现了这个 TextAreaWriter .. 我认为它可能会有所帮助

[http://pastebin.com/THGccgGu](http://pastebin.com/THGccgGu)

它适用于 SWT，但也应与 awt 一起使用

# objective-c - 在 Objective-C 项目中难以实现委托方法

> ID：12479077
> 
> 赞同：1
> 
> 时间：2012-09-18T14:29:23.550
> 
> 标签：objective-c, ios, delegates

我有一个表格视图，我将其用作表单。第一个单元格有一个可编辑的文本字段。单击第二个单元格时，会加载半模式日期选择器。我用这个：[http ://reednj.tumblr.com/post/1346445326/ios-semi-modal-date-picker-for-iphone](http://reednj.tumblr.com/post/1346445326/ios-semi-modal-date-picker-for-iphone)

无论如何，我已经定义了我的 datepicker 并将它的委托设置在 tableviewcontroller 中，如下所示：

```
TDDatePickerController* datePickerView = [[TDDatePickerController alloc] 
                                              initWithNibName:@"TDDatePickerController" 
                                              bundle:nil];
    [datePickerView setDelegate:self];
    [self presentSemiModalViewController:datePickerView]; 
```

现在处理按钮点击的方法被定义为

```
-(void)datePickerSetDate:(TDDatePickerController*)viewController;
-(void)datePickerClearDate:(TDDatePickerController*)viewController;
-(void)datePickerCancel:(TDDatePickerController*)viewController; 
```

因此，当按下取消按钮时，我希望关闭半模态日期选择器，所以我有：

```
-(void)datePickerCancel:(TDDatePickerController*)viewController{
[self dismissSemiModalViewController:viewController];
} 
```

但这会使应用程序因错误而崩溃

```
-[__NSCFType cancelDateEdit:]: unrecognized selector sent to instance 0xe738c00 
```

2012-09-18 10:23:47.254 JRPBaseCamp[7612:f803] ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSCFType cancelDateEdit:]：无法识别的选择器发送到实例 0xe738c00”

于是查了一下TDDatePickerController中的cancelDateEdit方法：

```
-(IBAction)cancelDateEdit:(id)sender {
if([self.delegate respondsToSelector:@selector(datePickerCancel:)]) {
    [self.delegate datePickerCancel:self];
} 
} 
```

我究竟做错了什么？我忽略的东西一定很明显。非常感谢任何帮助，我对 iOS 还很陌生，代表的整个概念真的让我感到困惑。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:45:23.993

发送的无法识别的选择器意味着没有响应 cancelDateEdit: 选择器。您可以使用调试器搜索 0xe738c00 是什么类型的对象，然后在那里寻找合适的选择器。

# c# - Microsoft Solver Foundation 中是否有使用 Nelder-Mead 求解器的示例？

> ID：12479078
> 
> 赞同：1
> 
> 时间：2012-09-18T14:29:24.477
> 
> 标签：c#, optimization, sample, solver, ms-solver-foundation

我一直在检查 Microsoft Solver Foundation 附带的示例，以获取使用 Neler-Mead 求解器的示例。示例网站上说有一个，但是当我打开用 C# 编写的 NLP 示例时，我看到的只是名为 SineX 的紧凑型准牛顿求解器示例。

有人找到有问题的样本，或者有任何其他使用 Nelder-Mead 求解器的样本吗？

MSDN 上的 MSF 示例列表（显示两个 NLP 示例，但我只看到一个） [http://msdn.microsoft.com/en-us/library/ff524501 (v=vs.93).aspx](http://msdn.microsoft.com/en-us/library/ff524501(v=vs.93).aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:53:49.810

Solver Foundation 示例似乎不包含 C# 中的任何显式 Nelder-Mead 示例。但是，您可以通过将紧凑型准牛顿求解器和参数替换为其 Nelder-Mead 对应对象，轻松测试 SineX 样本中的 Nelder-Mead *：*

```
var solver = new NelderMeadSolver();
...
var param = new NelderMeadSolverParams(); 
```

# css - 我们可以在css中有变量传递动态值吗

> ID：12479079
> 
> 赞同：0
> 
> 时间：2012-09-18T14:29:25.773
> 
> 标签：css, variables, less

我正在使用 /color.less，它保存了我的应用程序中的所有颜色，我正在使用 main.less，我在其中包含了这个，它使用 lesscss [less.js] 可以很好地工作。现在我将使用 theme1/color.less 进行不同的颜色主题化，并拥有 n 个主题。我们能否在 main.less 中包含一个变量，其中包含颜色文件的相对路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:54:30.930

使用不同的 css 类并将类设置为动态使用。

# asp.net - VB/ASP.NET 中的复选框列表样式

> ID：12479080
> 
> 赞同：1
> 
> 时间：2012-09-18T14:29:27.883
> 
> 标签：asp.net, vb.net, checkboxlist

我正在尝试在下面的 VB/ASP.NET 中设置复选框列表控件的样式：

```
Dim MultipleSelect As New CheckBoxList
MultipleSelect.RepeatColumns = 1
MultipleSelect.ID = "checkboxlist_" & IssueScoreControl.IssueScoreControl_PK
MultipleSelect.CssClass = "chkListStyle"
bla bla 
```

样式类“chkListStyle”如下：

```
<style>
        .chkListStyle input { float:left; }
        .chkListStyle label { float:left; width:80%; padding-left:3px; }
</style> 
```

我想要复选框旁边的文本。如果有超过 1 个单词，一切都很好。但是由于某种原因，当添加到复选框列表中的项目的文本是单个单词时，该单词会出现在下一行（复选框下方）。我该如何解决这个问题？请让我知道是否有人知道。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:12:01.200

尝试添加 CSS：

```
white-space:nowrap; 
```

以防止文本换行，并查看是否有效。如果不是，请检查 CSS 以确保 CheckBoxList 没有呈现特定的内容来导致此问题。

# regex - CouchDB 根据正则表达式列表从视图中排除

> ID：12479090
> 
> 赞同：0
> 
> 时间：2012-09-18T14:29:54.290
> 
> 标签：regex, view, couchdb

什么是基于正则表达式列表从视图中排除文档的最佳方法。例如，我想排除 doc.issue.name 包含与正则表达式列表匹配的值的任何内容。

例如排除列表：[/foo/, /bar/]

```
{
"_id": "1",
"issue": {
    "name": "foo"
}

{
"_id": "2",
"issue": {
    "name": "bar"
}

{
"_id": "3",
"issue": {
    "name": "fred"
} 
```

所以根据上面的文档，只返回doc.issue.name = "fred" 的文档

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T19:05:55.950

好的，所以在这里回答我自己的问题，以防其他人需要做这种事情！

基于以下文件：

```
{
"_id": "1",
"issue": {
"name": "foo"
}

{
"_id": "2",
 "issue": {
"name": "bar"
}

{
"_id": "3",
"issue": {
"name": "fred"
} 
```

这个地图功能：

```
function(doc) {
 var reg_exps = [/foo/g, /bar/g];
 for (r in reg_exps){
   if (doc.name.match(reg_exps[r])){
     return;
   }
 }
 emit(doc.name, 1);
} 
```

只会返回名为“fred”的文档

# android - 同时开始同一班级的 2 项活动

> ID：12479092
> 
> 赞同：1
> 
> 时间：2012-09-18T14:29:56.443
> 
> 标签：android, android-intent, android-activity

我们可以使用 Android 中同一类的 Intent 启动 2 个活动吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:39:11.297

你可以从一个班级开始尽可能多的活动。但是一旦活动开始，它将接管。简而言之，您可以在课堂上一次开始一项活动，但该活动可以是任何活动。

因此，根据某些条件，您可以说

```
 if(x==1)
       Intent intent = new Intent(getApplicationContext(), Activity1.class);
    else
       Intent intent = new Intent(getApplicationContext(), Activity2.class);
    startActivity(intent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:32:27.490

是的，您可以从同一个班级启动两个不同的活动：

```
Intent one = new Intent(getBaseContext(), FirstOther.class);
Intent two = new Intent(getBaseContext(), SecondOther.class);

if(startFirst) {
    startActivity(one);
} else {
    startActivity(two);
} 
```

但是，请记住，它一次只能是一个。您不能同时让它们都可见。

# c++ - Boost几何点初始化

> ID：12479095
> 
> 赞同：1
> 
> 时间：2012-09-18T14:30:09.090
> 
> 标签：c++, boost, initialization, point, boost-geometry

我正在尝试熟悉`boost::geometry::point`. 在我的类中，我有一个没有参数的默认构造函数，在这种情况下我想用零初始化所有点值。

由于 set/get 函数是模板，因此以下代码部分会在编译时产生错误：

```
 for( std::size_t i = 0; i < pnt.size() ; i++ )
    {
        pnt.set<i>( 0.0 );
    } 
```

要参考文档[http://www.boost.org/doc/libs/1_51_0/libs/geometry/doc/html/geometry/reference/models/model_point.html](http://www.boost.org/doc/libs/1_51_0/libs/geometry/doc/html/geometry/reference/models/model_point.html)

我需要设置一些值，因为：

> 坐标未初始化。如果没有调用带参数的构造函数并且没有使用 set 或 assign 分配点，则坐标值将包含垃圾。

有没有办法在编译时将所有值初始化为零？如果不是，那么在运行时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T16:02:27.067

您可以使用[`assign_zero`](http://www.boost.org/libs/geometry/doc/html/geometry/reference/algorithms/assign/assign_zero.html)or [`assign_values`](http://www.boost.org/libs/geometry/doc/html/geometry/reference/algorithms/assign/assign_values_3_2_coordinate_values.html)（这个仅适用于 2、3 和 4 个组件）：

```
boost::geometry::assign_zero(pnt);
boost::geometry::assign_values(pnt, 0.0, 0.0); 
```

如果您使用的是自定义点类，则需要使用其中一种来注册它[`BOOST_GEOMETRY_REGISTER_POINT...`](http://www.boost.org/libs/geometry/doc/html/geometry/reference/adapted/register.html)，以便能够使用 Boost Geometry 功能。[您可以在此处](http://www.boost.org/libs/geometry/example/c01_custom_point_example.cpp)找到几个示例。

# javascript - 在 JavaScript 中访问被忽略的 HTML 标签

> ID：12479102
> 
> 赞同：0
> 
> 时间：2012-09-18T14:30:27.863
> 
> 标签：javascript, jquery, sharepoint, sharepoint-2010, xhtml-1.0-strict

`<form id='SomeForm'>..</form>`如果我们在**严格的 DOCTYPE**中有一个没有 action 属性的表单标签，渲染器将**忽略该表单标签**，并且 IE 的 F12 开发工具和 FF 的 Firebug 将不会在渲染的 DOM 中显示该表单元素。但原始 HTML（查看源代码）会显示它。

我试图通过 jQuery 访问表单，但`$('#SomeFrom')`返回一个空数组`[]`。

如果我将 DOCTYPE 更改为过渡，它可以工作。但是我的应用程序范围的设置需要严格的 DOCTYPE。有没有办法通过 JavaScript 访问页面的原始（源）HTML？

**笔记：**

我正在使用 SharePoint 2010 CMS。当我编辑页面的 HTML 并保存它时，它会截断操作部分。基本上，它不是在其中创建表单的推荐方式，但我已经创建了很多带有表单的页面。现在我需要一些脚本来使用相同的处理程序来验证、字符串化和 ajaxify 它们。

同样使用[这种](https://stackoverflow.com/a/1186309)方法，我可以将表单字段包装在一个 div 中并进行字符串化并像这样提交它们：

`JSON.stringify($("div#SomeForm input, div#SomeForm textarea, div#SomeForm select").serializeObject())`

但是如果我能够访问表单，代码会更漂亮，同样我也可以使用 jQuery 的验证扩展。

# caching - 清漆微缓存

> ID：12479112
> 
> 赞同：3
> 
> 时间：2012-09-18T14:30:56.180
> 
> 标签：caching, varnish, varnish-vcl

微缓存和 Nginx 确实可以加快应用程序的速度。是否可以在 Varnish 中使用微缓存（或类似的东西）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T20:22:49.347

是的，您可以将 Varnish 设置为微缓存内容。

对于其他读者，微缓存是一个透明的过程，其中缓存保留不被缓存的内容的本地副本，并在指定的时间内提供服务。

例如，您可能有一个经常更新的主页，并且没有在站点的标题中设置缓存。但是，您的应用程序在性能较低的 VM 上运行，并且无法处理许多请求。微缓存可以通过在短时间内静默地从缓存中提供主页（并且不发送标头）来缓解此问题。

在 Varnish 中，这是通过 TTL 设置实现的。这告诉 varnish 在指定的时间内缓存内容。

如果您使用 TTL，您还应该使用 GRACE 设置 - 如果后端没有及时响应，这会告诉 varnish 在指定的时间内继续提供缓存的内容。

TTL 的另一个优点（我相信默认值为 120 秒）是 varnish 仅将未缓存内容的第一个请求发送到后端，将任何其他请求排队等待缓存准备好。

[Varnish Book](https://www.varnish-software.com/static/book/Saving_a_request.html)有一些例子，说明了各种 Grace 和 ttl 设置的可能性。

# algorithm - 线性时间算法的总和是线性时间吗？

> ID：12479114
> 
> 赞同：3
> 
> 时间：2012-09-18T14:31:01.983
> 
> 标签：algorithm, time-complexity

如果问题“愚蠢”，请原谅我。我是算法时间复杂度的新手。

我知道如果我有 n 个数字并且我想对它们求和，则需要“n 步”，这意味着算法是 O(n) 或线性时间。即所采取的步数随着输入的数量n线性增加。

如果我编写一个新算法，一个接一个地进行 5 次求和，我知道它是 O(5n) = O(n) 时间，仍然是线性的（根据[wikipedia](http://en.wikipedia.org/wiki/Big_O_notation#Multiplication_by_a_constant)）。

**问题**

如果我说 10 种不同的 O(n) 时间算法（总和、线性时间排序等）。我在 n 个输入上一个接一个地运行它们。

这是否意味着总体而言这在 O(10n) = O(n) 线性时间内运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T14:32:43.397

是的，对于任何**常数***k*，*O(kn)* = *O(n)*

 ****如果您开始增加您的问题并确定您的 10 个线性操作实际上是 k 个线性操作，例如 k 是用户输入数组的长度，那么从 big-oh 中删除该信息是不正确的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T14:42:09.770

最好从 big-O 的定义中解决它，然后在“证明”它正确后学习经验法则。

如果您有 10 个`O(n)`算法，这意味着有 10 个常数 C [1]到 C [10]，因此对于每个算法 A [i]，对于足够大的 n，执行它所花费的时间小于 C [i] * n。

因此[*] 为足够大的 n 运行所有 10 种算法所需的时间小于：

C [1] * n + C [2] * n + ... + C [10] * n

= (C [1] + C [2] + ... + C [10] ) * n

所以总数也是`O(n)`，常数 C [1] + ... + C [10]。

经验法则：常数个`O(f(n))`函数的总和是`O(f(n))`。

[*] 这一点留给读者证明。提示：有 10 个不同的“足够”值需要考虑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T17:26:10.430

是的，O(10n) = O(n)。此外，O(C*n) = O(n)，其中 C 是常数。在这种情况下，C 为 10。如果 C 等于 n，它可能看起来像 O(n^2)，但事实并非如此。由于 C 是一个常数，它不随 n 变化。

另外，请注意，在复杂性的总和中，最高阶或最复杂的阶被认为是整体复杂性。在这种情况下，它是 O(n) + O(n) ... + O(n) 十次。因此，它是 O(n)。****

# javascript - 选择选项后禁止关闭选择框

> ID：12479117
> 
> 赞同：0
> 
> 时间：2012-09-18T14:31:19.713
> 
> 标签：javascript, jquery, drop-down-menu

我得到一个带有未定义数量的选项的选择框。

**示例**
我的选择框包含 50 个具有不同值的选项。我所做的只是显示选项 1-10 和 25-30。其他人是分开的。通过单击选项 30，附加了分离的选项。

我的问题是选择框在选择后会像往常一样关闭。有没有办法抑制这种行为？

如果单击选项 30 并且分离的选项将显示在选项 30 下方而不关闭选择框，那将是非常棒的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:59:03.313

您可以尝试将选择框设置为多选框。然后选择第30项显示其他项目时。

如果您真的附加到使用常规选择框，那么您可以通过`<option>`在所选使用JavaScript加载和重新下拉列表时，通过“更多选项...”来生成该操作。

如果您提供一些示例代码，我可以举一个例子，也许

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:53:20.350

我不确定选择下拉菜单是否是满足您要求的最佳元素。您可能需要考虑在其溢出属性设置为滚动的 div 中使用复选框列表。这可能对你更好。获得一个下拉菜单来做你所要求的有点复杂。例如看[这个小提琴](http://jsfiddle.net/7asCW/)

示例 html

```
<div id="container">
    <label><input type="checkbox" name="test" value="1" />Option 1</label>
    <label><input type="checkbox" name="test" value="2" />Option 2</label>
    <label><input type="checkbox" name="test" value="3" />Option 3</label>
    <label><input type="checkbox" name="test" value="4" />Option 4</label>
    <label><input type="checkbox" name="test" value="5" />Option 5</label>
    <label><input type="checkbox" name="test" value="6" />Option 6</label>
    <label><input type="checkbox" name="test" value="7" />Option 7</label>
    <label><input type="checkbox" name="test" value="8" />Option 8</label>
    <label><input type="checkbox" name="test" value="9" />Option 9</label>
    <label><input type="checkbox" name="test" value="10" />Option 10</label>
    <label><input type="checkbox" name="test" value="11" />Option 11</label>
    <label><input type="checkbox" name="test" value="12" />Option 12</label>
</div> 
```

CSS

```
label{display:block;}
#container{height:100px;width:200px;overflow:scroll;} 
```

# php - 如何在 Drupal 7 中提交 AJAX 表单之前显示确认框？

> ID：12479118
> 
> 赞同：1
> 
> 时间：2012-09-18T14:31:19.800
> 
> 标签：php, jquery, drupal-7

使用 Drupal 7 表单 API，如何在提交 AJAX 表单之前提示 javascript 确认框？我尝试了不同的可能方法来做到这一点，但没有成功。这是代码：

```
function create_list_form($form, &$form_state) {

  $form['list_name'] = array(
    '#type' => 'textfield',
    '#required' => TRUE,
    '#title' => 'List Name'
    '#attributes' => array()
  );

  $form['list_desc'] = array(
    '#type' => 'textfield',
    '#required' => TRUE,
    '#title' => 'List Desc'
    '#attributes' => array()
  );

    $form['actions']['submit'] = array(
        '#type' => 'submit',
        '#attributes' => array('class' => array('use-ajax-submit')),            
        '#value' => 'Create List'
      );

  return $form;
} 
```

这是Javascript代码：

```
Drupal.behaviors.module = {
  attach: function() {

       jQuery('#edit-submit').click(function(){
          if(!confirm('Are you sure?'))
              return false;
      });

  }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-24T10:23:02.450

我找到了解决方案。我们可以通过重写 beforeSerialize() 函数来做到这一点：

```
 Drupal.behaviors.module = {
  attach: function() {  

     Drupal.ajax['edit-submit'].beforeSerialize = function () {  

          if(confirm('Are you sure?'))
              return true;
          else
              return false;

      }
   }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:23:52.563

Did you try to add an eventlistener on your button?

```
function show_confirmation() {
    if (confirm("Do you want to submit?")){
        // here you can do something before it gets submitted
    } else {
        // return false prevents the form from submitting
        return false;
    }
}
var button = document.getElementById('button_name');
button.addEventListener('click', show_confirmation); 
```

Edit: You can use this one if you want to make your function re-usable:

```
function your_callback_func() {
    // This could be any code for example your AJAX code etc
}

function show_confirmation(your_callback_func) {
    if (confirm("Do you want to submit?")){
        your_callback_func()
    } else {
        // return false prevents the form from submitting
        return false;
    }
}
var button = $('#button_name');
button.click(function() {
    show_confirmation(your_callback_func);
}); 
```

# java - contenteditable，无法编辑空白跨度

> ID：12479122
> 
> 赞同：1
> 
> 时间：2012-09-18T14:31:39.407
> 
> 标签：java, jquery, html

我以这种方式使用 contenteditable 属性。${row.pno}。

由于从数据库中检索数据，很少有值可以为空。我可以用一些值编辑跨度。问题是我无法编辑空白（空文本）范围。我怎样才能做到这一点。

感谢和问候阿迪布

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:38:48.600

`contenteditable`即使元素最初为空，具有该属性的元素也是可编辑的，如`<span contenteditable></span>`. 用户只是无法通过单击它来专注于它。但他可以使用 TAB 键移动到元素，然后键入或粘贴一些内容。

结论取决于上下文。例如，如果`span`元素是表格单元格的唯一内容，您可以`display: block`在其上设置，使其占据整个。假设其他单元格暗示该单元格的非零宽度和高度，可编辑元素也将具有它们并且是可点击的。

# javascript - Razor：从 C# 或其他方式调用 Javascript

> ID：12479123
> 
> 赞同：0
> 
> 时间：2012-09-18T14:31:39.730
> 
> 标签：javascript, razor, viewmodel

在我看来，我有一个 JavaScript 方法，我想调用它从我的模型中传入数据。

这是我的代码

```
@for(var i = 0; i < @Model.SearchCriteria.Locations.Count; i++) {
                        locationLog(@Model.SearchCriteria.Locations[i]);
                } 
```

JavaScript 方法是 locationLog。自然，这是抛出一个错误，说明此方法无法识别。我必须做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:36:02.100

您是否尝试过将您对“locationLog”的调用包装在脚本标签中？

```
@for(var i = 0; i < @Model.SearchCriteria.Locations.Count; i++) {
    <script type="text/javascript">locationLog(@Model.SearchCriteria.Locations[i]);</script>
} 
```

# verilog - Verilog 和 SystemVerilog 什么时候不需要包含指令？

> ID：12479130
> 
> 赞同：1
> 
> 时间：2012-09-18T14:31:58.893
> 
> 标签：verilog, system-verilog

假设我有一个顶级文件传递给我的编译器，它具有：

```
`include "my_defines.sv"
`include "my_component.sv" 
```

在“my_component.sv”文件中，我使用了“my_defines.sv”中的一些定义，如下所示：

```
my_variable = `CONSTANT_FROM_MY_DEFINES; 
```

问题如下：我需要``include "my_defines.sv"`在“my_component.sv”里面吗？也许这个要求是特定于编译器的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-01T01:45:43.867

如果您的“my_defines.sv”有一个“include”保护，那么在所有其他文件中包含“my_defines.sv”是安全且更好的。“my_defines.sv”顶部的“include”守卫将如下所示：

```
`ifndef MY_DEFINES_SV
`define MY_DEFINES_SV
// put your own defines here ...
`endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T09:34:46.660

`include`像这样的指令就像将该文件复制并粘贴到该文件所在的`include`位置。编译器：

1.  读取你给它的文件。
2.  当它遇到一个包含时，它会读取该文件。
3.  完成该文件后，它将继续原始文件。

结果是编译器看到一个大的平面文件。

在您的示例中，您可以使用 in 中的内容`my_defines`，`my_component`因为它出现得更早。

做很多这样的问题是最终你会遇到冲突。也许两个事物相互引用（首先包含），两个事物使用相同的名称（冲突定义），或者多个事物具有相同的包含语句（同一事物的多个定义）。

包解决了这些问题。一旦事情开始变得更加复杂，就去调查它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:39:18.980

它取决于编译源文件的顺序。因为您专门指`define`的是全局宏，所以需要在使用宏之前编译宏定义。在您的情况下，您不需要在“my_component.sv”中包含“my_defines.sv”，因为“my_defines.sv”已经在您的顶级文件中编译。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T21:53:54.653

宏定义仅在文件间保留，但仅保留到翻译单元的末尾。模拟器必须支持两种不同的将源文件分配给翻译单元的方法，并且很难让 `include 文件充满`defines 以在两种方法中正确编译。

最好使用参数或常量变量作为常量。由于参数和常量遵循正常的作用域规则，您可以安全地将它们包含在需要它们的每个文件/作用域中。那么代码如何分解成翻译单元并不重要，它总是可以编译的。我认为在浏览代码时更容易找到定义，因为 `include 可能在同一个文件中，而不是在其他一些不相关的文件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T13:15:37.743

您必须在 my_component.sv 中包含 `include "my_defines.sv ...

最佳做法是将所有包含添加到一个 pkg 中，并将该 pkg 添加到每个文件中。

# c++ - 使用其指针从列表中删除项目

> ID：12479137
> 
> 赞同：5
> 
> 时间：2012-09-18T14:32:12.100
> 
> 标签：c++, list, pointers, iterator

我有一个指向`p`列表中项目的指针（不是迭代器）。然后我可以使用`p`从列表中删除（擦除）该项目吗？就像是：

```
mylist.erase(p); 
```

到目前为止，我只能通过遍历列表直到到达 location 处的项目`p`，然后使用该`erase`方法来做到这一点，这似乎非常低效。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T14:34:31.780

不，您必须使用迭代器。我不明白为什么获取指针比获取迭代器更容易......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T14:52:45.063

A`std::list`不是关联的，因此您无法使用指针作为键来简单地直接删除特定元素。

您发现自己处于这种情况的事实指向了有问题的设计，因为您是正确的，从集合中删除该项目的唯一方法是完全迭代它（即线性复杂性）

以下可能值得考虑：

1.  如果可能，您可以将列表更改为`std::multiset`（假设有重复的项目），这将使直接访问更有效。

2.  如果设计允许，请更改您指向的项目以合并“已删除”标志（或使用模板提供此标志），从而避免从集合中删除该对象但快速将其标记为已删除。缺点是您的所有软件都必须更改以适应此约定。

3.  如果这是唯一的线性搜索并且集合不大（<20 项说。）为了方便起见，只需按照您的建议进行线性搜索，但在代码中留下一个大注释，说明您如何“*完全明白*“这是多么低效。您可能会发现这在任何情况下都不会成为一个有形的问题，如果有的话。

我猜3可能是你最好的选择。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T17:59:27.667

**这不是我建议做的，只是回答这个问题：**

*仅当您准备好进入未定义行为和不可移植性的禁止世界时才阅读：*

有一种不可移植的方法可以从`T*`指向 a 中元素的指针生成迭代器`list<T>`。您需要查看您的标准库`list`头文件。因为`Gnu g++`它包括定义`stl_list.h`在哪里`std::list`。最通常`std::list<T>`由类似于以下的节点组成：

```
template <class T>
struct Node {
   T item;
   Node* prev;
   Node* next;
}; 
```

拥有指向`Node<T>::item`您的指针可以使用`offsetof`计算此节点指针。请注意，此`Node`模板可能是其私有部分，`std::list`因此您必须破解它 - 比如说定义具有不同名称的相同结构模板。`std::list<>::iterator`只是对此的包装`node`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-23T02:05:06.857

这是不可能的。

我有一个类似的问题，因为我正在使用 epoll_wait 并处理事件列表。events 结构仅包含一个 union，其中最明显的使用类型是 void * 以指示找到的相关数据（包括文件描述符）。

std::list 不允许您通过指针删除元素似乎真的很愚蠢，因为显然有一个下一个和上一个指针。

我正在考虑重新使用 Linux 内核 LIST 宏来解决这个问题。太多抽象的问题是你必须放弃与较低级别 api 的互操作性和通信。

# html - 如何计算中心 div 的宽度

> ID：12479138
> 
> 赞同：0
> 
> 时间：2012-09-18T14:32:15.253
> 
> 标签：html, css

我有三个`div`水平堆叠的 s -> 左、中和右。

左右固定宽度为`250px`。我希望中心`div`具有最大可能的宽度。我该怎么做呢？

一旦将`div`其设置为最大可能，我将其`div`内部设置`margin:0 auto;`为居中对齐。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:43:44.397

您定义元素的顺序在这里很重要。在 html 中创建中心 div*之前*，您需要创建左/右 div 。这是因为浏览器需要先绘制布局的左侧/右侧，然后才能知道中心 div 有多少可用空间。

这是一个例子。[http://jsfiddle.net/vtvxb/](http://jsfiddle.net/vtvxb/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T14:46:33.833

您无需进行任何计算即可实现这一目标。你可以通过一些巧妙的 HTML 结构和一点 CSS 来做到这一点！

试试这个 - 在此处查看示例：http: [//jsfiddle.net/zfg6m/1/](http://jsfiddle.net/zfg6m/1/)

**HTML**

```
<div class="container">
    <div class="left-col">
        This is my left column!
    </div>
    <div class="right-col">
        This is my right column!
    </div>
    <div class="center-col">
        This is my center column
    </div>
</div> 
```

**CSS**

```
.left-col {
  background-color: yellow;
  float: left;   
}

.right-col {
  background-color: orange;
  float: right;  
}

.center-col {
  background-color: blue;   
} 
```

这段代码发生了什么？好吧，您正在浮动放置在中心柱上方的两列。由于两个浮动没有被清除，它们会折叠并为您的中心列形成空间以填充该区域的 100% 宽度。这允许您的中心列保持在两列之间，但在宽度上保持动态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T15:12:40.150

[http://dabblet.com/gist/3743636](http://dabblet.com/gist/3743636) '溢出：隐藏'会在这里救你。虽然源顺序必须如下：

```
<div class="left"></div>

<div class="right"></div>

<div class="center"></div> 
```

而且您不需要（不应该）为中心 div 设置边距；'overlflow: hidden' 是为了清除浮动，更多内容在这里： http: [//www.stubbornella.org/content/2009/07/23/overflow-a-secret-benefit/](http://www.stubbornella.org/content/2009/07/23/overflow-a-secret-benefit/)（推荐阅读）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T14:36:47.810

宽度将是`page body width`- `500px`。

# objective-c - iOS 应用程序崩溃问题`[UIWindow warpPoint:]`

> ID：12479139
> 
> 赞同：1
> 
> 时间：2012-09-18T14:32:21.593
> 
> 标签：objective-c, ios

我在我的应用程序中发现了一个奇怪的崩溃问题，我无法从崩溃报告中获得足够的信息。

这是崩溃报告：

```
 -[TileLayer _isChargeEnabled]: unrecognized selector sent to instance 0x14aeadb0
(null)
(
    0   CoreFoundation                      0x376298a7 __exceptionPreprocess + 186
    1   libobjc.A.dylib                     0x3169e259 objc_exception_throw + 32
    2   CoreFoundation                      0x3762ca9b -[NSObject doesNotRecognizeSelector:] + 174
    3   CoreFoundation                      0x3762b915 ___forwarding___ + 300
    4   CoreFoundation                      0x37586650 _CF_forwarding_prep_0 + 48
    5   UIKit                               0x30775e43 -[UIWindow warpPoint:] + 686
    6   UIKit                               0x3075c1ff _UIApplicationHandleEvent + 2438
    7   GraphicsServices                    0x3777922b PurpleEventCallback + 882
    8   CoreFoundation                      0x375fd523 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 38
    9   CoreFoundation                      0x375fd4c5 __CFRunLoopDoSource1 + 140
    10  CoreFoundation                      0x375fc313 __CFRunLoopRun + 1370
    11  CoreFoundation                      0x3757f4a5 CFRunLoopRunSpecific + 300
    12  CoreFoundation                      0x3757f36d CFRunLoopRunInMode + 104
    13  GraphicsServices                    0x37778439 GSEventRunModal + 136
    14  UIKit                               0x3078bcd5 UIApplicationMain + 1080
    15  Movie                               0x00022eb3 _mh_execute_header + 7859
    16  Movie                               0x00022e40 _mh_execute_header + 7744
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:43:01.967

好吧，这意味着您尝试将消息（也称为调用方法）`_isChargeEnabled`传递给 TileLayer 类的对象，但它不存在。

**更新** 我做了一个快速的谷歌搜索，结果`_isChargeEnabled`是苹果的私有 API。你可以检查[这个](https://stackoverflow.com/questions/7075134/uiwebview-load-crash-nscfdictionary-ischargeenabled)和[这个](https://stackoverflow.com/questions/7644930/mptransportbutton-ischargeenabled-message-sent-to-deallocated-instance-0x4b)以获取更多信息。

# jquery - 非 Ajax 表单提交时在 jQuery Mobile 中显示加载消息

> ID：12479140
> 
> 赞同：1
> 
> 时间：2012-09-18T14:32:24.183
> 
> 标签：jquery, jquery-mobile, file-upload, form-submit

我在 jQuery Mobile 中提交了一个带有`data-ajax="false"`表单标签的表单，`enctype="multipart/form-data"`以便我可以利用 iOS 6 中的文件上传功能。您必须禁用默认的 Ajax 表单提交才能实际传递附件。

我想使用这个显示默认的 jQuery Mobile 加载消息：

```
$.mobile.loading('show'); 
```

如[文档中所定义](http://jquerymobile.com/test/docs/api/methods.html)。

我的表单使用以下代码进行验证：

```
$( document ).bind( "pageinit", function( event, data ) {   
    $("#contact-form").validate({
        // Custom validation messages
        messages: { contact_name: "Please enter your full name.", contact_phone: "Please enter a valid phone number.", contact_zip: "Please enter your shipping zip code."},
        errorElement: "p",
        submitHandler: function(form){

            //Get the data from the form fields and format correctly
            var name = $("#contact-form #contact_name").val();
            var email= $("#contact-form #contact_email").val();
            var phone= $("#contact-form #contact_phone").val();
            var zip= $("#contact-form #contact_zip").val();
            var message = $("#contact-form #contact_message").val();

            document.forms["contact-form"].submit();
         }
    });
}); 
```

当用户提交表单（通过触摸/单击提交按钮）时，如何（在 jQuery Mobile 中）显示默认加载微调器`type="submit"`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T23:37:32.513

我想你可能想尝试这样的事情：

```
$( document ).bind( "pageinit", function( event, data ) {   

    $("#your_submit_button").click(function() {

        // When the button is clicked, show loading message
        $.mobile.loading('show');

        // Validate the form 
        $("#contact-form").validate({
            // Custom validation messages
            messages: { contact_name: "Please enter your full name.", contact_phone: "Please enter a valid phone number.", contact_zip: "Please enter your shipping zip code."},
            errorElement: "p",
            submitHandler: function(form){

            //Get the data from the form fields and format correctly
            var name = $("#contact-form #contact_name").val();
            var email= $("#contact-form #contact_email").val();
            var phone= $("#contact-form #contact_phone").val();
            var zip= $("#contact-form #contact_zip").val();
            var message = $("#contact-form #contact_message").val();

            document.forms["contact-form"].submit();

            // Hide the loading message
            $.mobile.loading('hide');

         }
    });
}); 
```

希望这可以帮助

# jquery - 文件上传后表单不提交

> ID：12479143
> 
> 赞同：0
> 
> 时间：2012-09-18T14:32:31.480
> 
> 标签：jquery, asp.net-mvc-3

我有一个视图，用户可以在其中编辑他的个人资料信息。这是输入文本字段，他还可以添加个人资料图像。为此，我使用带有剃须刀的 ASP .net MVC3 执行以下操作，如下所示：

在视图中：

```
@using (Html.BeginForm("SettingsWizard", "Business", FormMethod.Post, new { enctype = "multipart/form-data", id="SettingsForm" }))
        { 

            @Html.Partial("_UsrConfiguration", Model)

            @Html.Partial("_OtherPartialView")

            @Html.Partial("_OtherPartialViewTwo")

            <p class="textAlignRight">
                <input type="submit" class="bb-140" id="button7" value="Save"/>
    </p>
            <div class="clear"></div>
        } 
```

在 _UsrConfiguration 部分视图中处理图像：

```
<div class="floatRight" >
    <a onclick="javascript:opendialogbox('imageLoad2');" style="cursor: pointer">Foto</a>
    <img src="../../Content/themes/base/images/icons/zoom.png" width="16" height="16" id="imgThumbnail2" alt="foto" />
    <input type="file" name="imageLoad2" accept="image/*" id="imageLoad2" onchange="ChangeProfileImage()" hidden="hidden" />
</div> 
```

使用这些脚本：

```
<script type="text/javascript">
function ChangeProfileImage() {
        var ext = document.getElementById('imageLoad2').value.match(/\.(.+)$/)[1];
        switch (ext.toLowerCase()) {
            case 'jpg':
            case 'bmp':
            case 'png':
            case 'gif':
            case 'jpeg':
                {
                    var myform = document.createElement("form");
                    myform.style.display = "none";
                    myform.action = "/ImagePreview/ProfileImageSubmit";
                    myform.enctype = "multipart/form-data";
                    myform.method = "post";
                    var imageLoad;
                    var imageLoadParent;
                    var is_chrome = /chrome/.test(navigator.userAgent.toLowerCase());
                    if (is_chrome && document.getElementById('imageLoad2').value == '')
                        return; //Chrome bug onchange cancel
                    if (document.all || is_chrome) {//IE
                        imageLoad = document.getElementById('imageLoad2');
                        imageLoadParent = document.getElementById('imageLoad2').parentNode;
                        myform.appendChild(imageLoad);
                        document.body.appendChild(myform);
                    }
                    else {//FF
                        imageLoad = document.getElementById('imageLoad2').cloneNode(true);
                        myform.appendChild(imageLoad);
                        document.body.appendChild(myform);
                    }
                    $(myform).ajaxSubmit({ success:
                        function (responseText) {
                            var d = new Date();
                            $("#imgThumbnail2")[0].src = "/ImagePreview/ProfileImageLoad?a=" + d.getMilliseconds();
                            if (document.all || is_chrome)//IE
                                imageLoadParent.appendChild(myform.firstChild);
                            else//FF                     
                                document.body.removeChild(myform);
                        }
                    });
                }
                break;
            default:
                alert('File type error…');
        }

    }
</script> 
```

在控制器端处理图像：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult ProfileImageSubmit(int? id)
{
Session["ContentLength"] = Request.Files[0].ContentLength;
        Session["ContentType"] = Request.Files[0].ContentType;
        byte[] b = new byte[Request.Files[0].ContentLength]; 
        Request.Files[0].InputStream.Read(b, 0, Request.Files[0].ContentLength); 
        //DB saving logic and persist data with…
    repo.Save();

        return Content(Request.Files[0].ContentType + ";" + Request.Files[0].ContentLength);
}

public ActionResult ProfileImageLoad(int? id)
{

    TCustomer usr = new TCustomer();
        usr = repo.load(User.Identity.Name);
byte[] b = usr.ContactPhoto; 
        string type = (string)Session["ContentType"];
    Response.Buffer = true;
        Response.Charset = "";
        Response.Cache.SetCacheability(HttpCacheability.NoCache);
        Response.ContentType = type;
        Response.BinaryWrite(b);
        Response.Flush();
        Response.End();
        Session["ContentLength"] = null;
        Session["ContentType"] = null; 
        return Content("");
} 
```

这工作正常。问题是，如果用户将图像添加到他的个人资料中，那么

```
<input type="submit" class="bb-140" id="button7" value="Save"/> 
```

按钮不做任何事情。但是，如果用户在不添加图像的情况下编辑他的个人资料，则输入按钮会以应有的方式提交。我尝试使用绑定输入的点击功能

```
$(document).on('click','#button7',function(e){
  $("#SettingsForm").submit();
}); 
```

但问题仍然存在......我将不胜感激有关此问题的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:03:02.517

不知道您为什么要以您的方式处理图像上传表格。您的视图中只能有两种形式。我们正在这样做，没有任何问题。只要确保每个表单都包含它需要数据的所有元素。要在两种形式中使用一个元素，请进行隐藏输入以镜像另一个，并使用 jQuery 使值保持最新。

嗯...开始看到问题。按照您的布局方式，我建议的第二种形式将嵌套在原始形式中。我有一个解决方法，我在同一个表单上有几个提交按钮。按钮如下所示：

```
 <input type="submit" value=" Save Changes " name="submitButton" /> 
```

然后在我的行动中，我使用这个签名：

```
 [HttpPost]
    public ActionResult ProcessForm(FormCollection collection) 
```

并找出点击了什么按钮：

```
 string submitCommand = collection["submitButton"]; 
```

然后，我只有一个 switch(submitCommand) 块，我在其中为按钮执行适当的操作。在您的情况下，您必须进行操作签名：

```
 [HttpPost]
    public ActionResult ProcessForm(FormCollection collection, HttpPostedFileBase file) 
```

这样您就可以在单击保存图片按钮时保存文件对象。我不能保证这会奏效，但我相当肯定。

如果没有，那么丑陋的解决方法是将用于上传图片的表单与用于更新配置文件的表单分开。那不会很漂亮...尽管您可以通过将图像表单放在对话框中（在主对话框之外）并使用 jQuery 对话框打开它来完成它。

我希望这是有道理的。

# c - 我在 UDP 套接字上设置了 SO_RCVLOWAT（接收低水位标记）选项，但它不起作用

> ID：12479147
> 
> 赞同：1
> 
> 时间：2012-09-18T14:32:42.733
> 
> 标签：c, sockets

我正在使用 C 网络编程`SO_RCVLOWAT`在 UDP 套接字上设置套接字选项。如返回值所示，我成功了`getsockopt()`。问题：我仍然可以接收任何大于零的数据大小。

示例：我在客户端将套接字选项 SO_RCVLOWAT 的值设置为 1024 字节，服务器向客户端发送了 256 字节。它可以接收 256 字节，但它实际上不应该接收此消息，因为接收低水位标记是 1024 字节。

相关代码：

```
rc = setsockopt(sd, SOL_SOCKET, SO_RCVLOWAT, (char *)&recvlowat, sizeof(recvlowat));
        if(rc < 0){
                VL_MISC_ERR(("Setting SO_RCVLOWAT option error, %s",strerror(errno)));
                return -1;
        } 
```

`sd`: 一个有效的文件描述符

然后我使用`recvfrom`：

```
c = recvfrom(sd, databuf,  datalen, 0, (struct sockaddr_in *)&localSock, &addrlen); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T23:58:01.590

它不应该在 UDP 中产生这种效果。`recvfrom()`一次接收一个数据报，周期。如果您想一次接收多个，请使用`recvmsg()`.

# actionscript-3 - 使用 mxmlc 编译为文件

> ID：12479149
> 
> 赞同：1
> 
> 时间：2012-09-18T14:32:49.607
> 
> 标签：actionscript-3, flash, mxmlc

我尝试用 mxmlc 和 ant 编译我的 as 文件。

这是我的编译代码片段：

```
<target name="compile">
    <exec executable="${flex.home}/${mxmlc}" failonerror="true">
        <arg line="-compiler.include-libraries='./libs'"/>
        <arg line="-compiler.optimize=true"/>
        <arg line="-debug=false"/>
        <arg line="-keep-generated-actionscript=false"/>
        <arg line="-default-frame-rate=60"/>
        <arg line="-default-size 800 600"/>
        <arg line="-source-path='./src'"/>
        <arg line="'./src/main.as'"/>
        <arg line="-o='./bin/main.swf'"/>
        <arg line="-use-network=true"/>
    </exec>
</target> 
```

我的问题是生成的 swf 太大。它包括存在于`./src`项目中但未在项目中使用的文件。此外，它包括`mx.*`和其他软件包。

什么是正确的 mxmlc 配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:09:59.647

Try to use `library-path`, not `include-libraries` directive.

# .net - Entity Framework 5 代码优先 - 数据库中的文档

> ID：12479150
> 
> 赞同：3
> 
> 时间：2012-09-18T14:32:52.120
> 
> 标签：.net, frameworks, entity

我的问题很简单，但我在任何地方都找不到答案。是否有一些注释（属性）或在字段级别编写一些文档的方法，这些文档将反映在数据库中列的描述（在 sql server 中，但在其他 dbs 中有等价物）属性中？

例如，我关心的是在枚举字段中，将数据库中列的描述写入存储在该字段中的整数值的“字符串”映射。

提前谢谢你，古斯塔沃

# event-handling - 我可以在 C++/CX 中使用 lambda 处理事件吗？

> ID：12479152
> 
> 赞同：9
> 
> 时间：2012-09-18T14:32:58.300
> 
> 标签：event-handling, lambda, c++-cx

是否可以在 C++/CX 中使用 lambda 处理事件？例如，将这段代码从 C# 转换为 C++/CX 的最佳方法是什么？

```
this.animation.Completed += (s, e) =>
{
   animation.Begin();
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T20:22:29.427

是的，这是正确的语法。但是，我们建议您使用函数处理程序而不是 lambda，因为 lambda 可以引入循环引用并防止内存被释放。

[http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh755799.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh755799.aspx)

> 一般来说，最好为事件处理程序使用命名函数而不是 lambda，除非您非常注意避免循环引用。命名函数通过弱引用捕获“this”指针，而 lambda 通过强引用捕获它并创建循环引用。有关详细信息，请参阅弱引用和中断循环 (C++/CX)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T14:52:48.493

这就是我最终做的事情。

```
animation->Completed += ref new EventHandler<Object^>([this](Object^, Object^)
{
   animtion->Begin();
}); 
```

# php - 在我的网站上放置 Like 按钮的 2 个问题

> ID：12479153
> 
> 赞同：2
> 
> 时间：2012-09-18T14:33:01.007
> 
> 标签：php, facebook-like

我是一个网站的 PHP 开发人员，最近用更新的代码示例替换了 Sharer.php 代码。Like 按钮可以正常显示，但是当您单击它时，弹出窗口仅显示一两秒钟，然后消失。此外，描述没有显示在弹出窗口中 - 只是 URL。Like 按钮代码包含在 DIV 容器中，用户可以隐藏（使用 JQuery），页面上有 AJAX 可以每分钟自动查询一次表以刷新屏幕上的计数器。

以下是一些代码片段，以防万一，任何帮助表示赞赏：

```
<meta property="og:title" content="FourFreedomsBlog - Romney/Ryan: Channeling the  inner McCain" />
<meta property="og:description" content="The Romney/Ryan campaign is evoking an eerie recollection of the McCain campaign of 2008: trust us - you'll get the details AFTER we're elected." />
<meta property="og:url" content="http://www.fourfreedomsblog.com/Blog.php?Act=ViewBlogPost&amp;BlogID=2090" />
<meta property="og:image" content="http://www.FourFreedomsBlog.com/images/4Fv3.0.gif" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="FourFreedoms Blog" />
<meta property="fb:admins" content="14194340826" />

<div class="ShareThisContainer">

<div class="FoldingMenu">
  <h4><button id="showShareThis" class="ButtonHide" /></button><span name="" id="">Share This!</span></h4>

  <div id="SharePane" class="TogPane ItemHide">

    <table class="ShareThis">
      <tr>
        <td colspan=8>

          <div id="fb-root"></div>

          <script>
            (function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0];

              if (d.getElementById(id)) return;

              js = d.createElement(s); js.id = id;
              js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
              fjs.parentNode.insertBefore(js, fjs);
            }
            (document, 'script', 'facebook-jssdk'));
          </script>

          <div class="fb-like" data-href="http%3A%2F%2Fwww.FourFreedomsBlog.com%2FBlog.php?Act=ViewBlogPost&BlogID=2090" data-send="true" data-width="320" data-show-faces="true"></div>

        </td>
      </tr>
    </table>

  </div><!-- id=SharePane -->

</div><!-- class=FoldingMenu -->
</div><!-- class=ShareThisContainer --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:49:43.990

# php - 使用更新从 CSV 导入 MySQL

> ID：12479155
> 
> 赞同：0
> 
> 时间：2012-09-18T14:33:07.677
> 
> 标签：php, mysql, csv, import

我有这个 php 代码，旨在将 csv 文件中的所有行和列作为记录导入 mysql 表。它成功地从 csv 插入到名为“import_items”的 mysql 表中，*但是*如果我重新导入，它将插入重复的记录。我只需要在哪里安装查询更新，它应该检查**表名中的 IF ITEM EXISTS** -> Update values , **IF NOT EXISTS** ..Insert record！

这是我的代码：

```
<form enctype="multipart/form-data" action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">

File to import:<br />

<input size='30' type='file' name='filename'>

<input type="submit" name="submit" value="Upload"></form>

<?php 
require_once('connect_db.php');

   //Upload File 
    if (isset($_POST['submit'])) { 
    if (is_uploaded_file($_FILES['filename']['tmp_name'])) { 

    //Import uploaded file to Database 
    $row = 1; 
    $handle = fopen($_FILES['filename']['tmp_name'], "r"); 

    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) { 

              //Update Database Values 

        $import="insert into import_items (item_no,qty,actual_price,discount_price,difference_price,date) VALUES('".mysql_real_escape_string($data[0])."', '".mysql_real_escape_string($data[1])."', '".mysql_real_escape_string($data[2])."', '".mysql_real_escape_string($data[3])."', '".mysql_real_escape_string($data[4])."', '".$date = date('Y-m-d')."')"; 

        mysql_query($import) or die(mysql_error()); 

    } 

    fclose($handle); 
     }
} 
    ?> 
```

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:36:42.120

检查`INSERT INTO ... ON DUPLICATE KEY UPDATE ...`语法。哦，确保你的表中有一个主键，这几乎总是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:35:29.767

MySQL 有一个语句将检查现有行，并且仅在它不存在时插入。采用

```
REPLACE INTO import_items... 
```

而不是 INSERT INTO。语法在其他方面是相同的。

该语句将通过表的主键检查重复项。如果键不存在，它将插入一行。如果键存在，它将更新行中的其他字段。这相当于您先执行 SELECT，然后分支执行 UPDATE 或 INSERT。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:44:21.553

您需要共享您的表架构。如果在要强制不重复的列中没有正确的键，则使用`REPLACE INTO`or将不起作用。`INSERT ... ON DUPLICATE KEY UPDATE`另一件容易做的事情（您已经对表进行了重复数据删除），是在要防止重复的列上放置一个唯一键。

# git - 远程机器上没有 git 的 Git 克隆

> ID：12479157
> 
> 赞同：2
> 
> 时间：2012-09-18T14:33:17.530
> 
> 标签：git, version-control, ssh

好的，非常具体的问题：我在远程机器上有一个 git 存储库，并且可以通过 ssh 访问该机器。但是远程机器上没有 git。

当我现在尝试通过 结帐时`git clone user@host:/path/to/repo`，它会因错误而失败`bash: git-upload-pack: command not found`——这并不奇怪，因为没有安装 git。

我的问题是：git-upload-pack 有什么办法吗？我只使用 git 作为标准化文件存储/命名 blob db，所以我不想让服务器设置比必要的复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:46:18.540

git 客户端安装起来并不复杂。没有服务器进程或类似的东西，只有一堆可执行文件。如果您想保持服务器的原始状态，我很确定您也可以安装在自己的用户空间中。

那将是我的第一个选择。

否则你可以尝试一个简单的副本。

如果您需要在存储库中移动（克隆它），您*应该*能够通过将文件夹结构作为一个整体复制到其他地方来做到这一点，有效地进行克隆！在这里不完全确定，因为我现在已经进行了一段时间的强制 git 饮食，但如果没有记错的话，我已经使用过同样的策略几次，没有问题。

也就是说，尝试获取 git 客户端，它会让一切变得更加简单（几乎所有东西，还没有找到一种方法来自动填写税表......叹息）。

希望这可以帮助

# mysql - I18N 翻译系统：关于 ER 图设计的建议？

> ID：12479158
> 
> 赞同：0
> 
> 时间：2012-09-18T14:33:18.827
> 
> 标签：mysql, database-design, internationalization, translation, er-diagrams

我有一个简单的产品数据库。

每个产品都是 N:1 与几个属性相关的，例如材质、性别、形状等。

每个属性都是一个表格（例如，带有方形、圆形和其他行的表格“形状”）

现在我想“翻译”每个属性，例如，我希望“square”记录与“quadrato”（it）、“carré”（fr）等相关联。"languages" 是另一个表 (it,fr,en) 并且可以添加或删除语言，因此具有列 "it_value"、"fr_value" 显然是不可能的和丑陋的。

我在考虑

*   创建一个带有 id、language_id 和 value 的表“TRANSLATIONS”
*   用 id、name 创建一个表“LANGUAGES”
*   创建具有 id 和其他列的表“SHAPES”和“MATERIALS”
*   使用 translation_id 和 material_id 创建一个表（例如）“MATERIAL_TRANSLATIONS”
*   用同样的思路创建一个表“SHAPE_TRANSLATIONS”，如上

您认为其他解决方案会比这更有效或更优雅吗？

（很抱歉也没有发布 ER 图，但我不是一个那么“图形”的人！；））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:43:01.120

形状/材料表有多相似？您不能使用具有“属性类型”（形状/材料）和“属性名称”（正方形、棉花等）字段集的单个表来完成此操作吗？

如果是这样的话，那么我可能会使用类似的东西：

```
items: id, name  
languages: id, name  
items_translations: item_id, language_id, name 
```

items 表中的“名称”将是您系统的默认语言（例如英语），任何翻译都将在 items_translations 表的“名称”字段中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:45:02.040

听起来不错。

您可以使用更抽象的表示，但我认为您的显式映射方法更容易理解，因此更好。

# math - 从一系列点预测起点和终点

> ID：12479159
> 
> 赞同：0
> 
> 时间：2012-09-18T14:33:19.213
> 
> 标签：math, login, geometry

我有一系列点（不是顶点），它们形成一个开放的形状，但它们随机排列在一个数组中，但是为了有效地识别形状，我需要做的是按照形状的顺序排列点。

有什么方法可以让我识别出起点和终点？

**编辑：**这些点在二维平面中，我有边界框。这些点是从图像处理算法中获得的，该算法给我从上到下的点（不是按照形状的顺序），因为图像是逐像素处理的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:38:59.587

给定一组点，有多种方法可以从它们重建形状。如果您只考虑两点之间的距离，那么这基本上可以归结为一个经典的[旅行商问题](http://en.wikipedia.org/wiki/Travelling_salesman_problem)：您正在寻找一个通过所有点的旅行，以最小化所述旅行的长度。您可以添加一个与平面中所有点具有相同距离的 mor atrificial 点。这会将循环游览变成线性游览：在该人工点之后的点将是起点，而在它之前的点将是终点。可能有 TSP 近似算法可以开箱即用地进行非循环游览。

仅考虑距离会忽略绘画设备运动所固有的任何惯性。所以我不认为这是最好的模型。但是对于大多数模型，我仍然会考虑一种方法来确定所有点的顺序，这会自动识别起点和终点。我想不出一种方法来可靠地识别这两者，而无需对它们之间的所有点进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:31:33.667

编辑：似乎你想实现图像分割：

[纸](http://www-i6.informatik.rwth-aachen.de/web/Teaching/Lectures/WS10_11/asr/segmentation.pdf)

向下滚动到第 28 页以获取数学描述。这会给你轮廓。这能让你到达你想去的地方吗？

* * *

你想要做的是实施

[光学字符识别](http://en.wikipedia.org/wiki/Optical_character_recognition)

无需使用外部库。我不建议将它用于生产目的，但认为这将是一个很好的问题。

我的建议是建立一个简单的人工神经网络，图像表面提供输入信号。前馈、反向传播 ANN 的编码非常容易，但要获得您想要的结果却非常棘手。

毕竟，尽管进行了多次尝试，但您正在解决一个尚无完美解决方案的问题。祝您好运，并请让我们了解您的最新进展！

# php - 在 ATK 中将 ref() 与链接表一起使用

> ID：12479163
> 
> 赞同：2
> 
> 时间：2012-09-18T14:33:26.533
> 
> 标签：php, frameworks, atk4

我一直在研究**ATK**的学生注册示例/教程，并且一直坚持通过链接表使用 ref()。

系统的基本 ER 如下：

```
[Student] ||---|< [class_has_student] >|---|| [class]  >|----|| [subject] 
```

主题存储主题名称、主题代码、可以运行的学期以及描述的位置。课程是在给定时期内针对给定主题提供给学生的讲座/教程。学生可以注册一个班级，并且关系存储在 class_has_student 表中。

对于基本示例，我希望显示特定学生的详细信息并显示他们注册的课程（带有学科名称）。我正在使用视图模板来显示学生详细信息（姓名等）和任何课程（带有学科名称) 他们使用 Lister 类注册。主要问题是在尝试列出特定学生注册的科目时使用：

```
$student_detail= $student->ref('ClassHasStudent2')->ref('class_idclass') 
```

它不是检索学生注册的所有科目，而是从数据库中检索所有科目。

请参阅下面的页面、模型和此示例的模板代码，以及修改后的 Table.php 类以使其工作（对不起，长度）。

谢谢你的帮助。

**楷模**

“类”表

```
+-------------------+---------+------+-----+---------+----------------+
| Field             | Type    | Null | Key | Default | Extra          |
+-------------------+---------+------+-----+---------+----------------+
| idclass           | int(11) | NO   | PRI | NULL    | auto_increment |
| subject_idsubject | int(11) | NO   | MUL | NULL    |                |
| date_start        | date    | YES  |     | NULL    |                |
| date_end          | date    | YES  |     | NULL    |                |
| max_students      | int(11) | YES  |     | NULL    |                |
+-------------------+---------+------+-----+---------+----------------+

select * from class;
+---------+-------------------+------------+------------+--------------+
| idclass | subject_idsubject | date_start | date_end   | max_students |
+---------+-------------------+------------+------------+--------------+
|       1 |                 2 | 2012-09-10 | 2012-09-30 |           10 |
|       2 |                 1 | 2012-09-08 | 2012-09-30 |           30 |
|       3 |                 3 | 2012-10-01 | 2012-10-31 |           35 |
|       4 |                 2 | 2012-09-19 | 2012-09-29 |           10 |
+---------+-------------------+------------+------------+--------------+ 
```

类.php

```
<?php

class Model_Class extends Model_Table {
    public $table='class';
    public $entity_code='class';
public $id_field='idclass';

    function init(){
        parent::init();
    $this->hasOne('Subject','subject_idsubject','name', 'subject_name');
    $this->addField('date_start')->type('date')->caption('Start');
    $this->addField('date_end')->type('date')->caption('End');
    $this->addField('max_students')->type('int');

    $this->hasMany('ClassHasStudent','class_idclass', 'idclass');
    }
} 
```

“学生”表

```
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| idstudent  | int(11)     | NO   | PRI | NULL    | auto_increment |
| student_id | varchar(45) | NO   |     | NULL    |                |
| name       | varchar(45) | NO   |     | NULL    |                |
+------------+-------------+------+-----+---------+----------------+

select * from student;
+-----------+------------+--------+
| idstudent | student_id | name   |
+-----------+------------+--------+
|         1 | T123       | Tom    |
|         2 | L222       | Lizley |
|         3 | B123       | Betty  |
|         4 | H33        | Homer  |
|         5 | N42        | Nick   |
+-----------+------------+--------+ 
```

学生.php

```
 <?php
  class Model_Student extends Model_Table {
      public $table='student';
      public $entity_code='student';
      public $id_field='idstudent';
      public $title_field='name';

      function init(){
          parent::init();

          $this->addField('student_id')->caption('Student ID');
          $this->addField('name')->caption('Name');
          $this->hasMany('ClassHasStudent', 'student_idstudent', 'idstudent');
      }
  } 
```

Mysql“class_has_student”表

```
 +---------------------+-------------+------+-----+---------+----------------+
  | Field               | Type        | Null | Key | Default | Extra          |
  +---------------------+-------------+------+-----+---------+----------------+
  | idclass_has_student | int(11)     | NO   | PRI | NULL    | auto_increment |
  | class_idclass       | int(11)     | NO   | MUL | NULL    |                |
  | student_idstudent   | int(11)     | NO   | MUL | NULL    |                |
  | date_enrolled       | varchar(45) | YES  |     | NULL    |                |
  | grade               | double      | YES  |     | NULL    |                |
  +---------------------+-------------+------+-----+---------+----------------+

  select * from class_has_student;
  +---------------------+---------------+-------------------+---------------+-------+
  | idclass_has_student | class_idclass | student_idstudent | date_enrolled | grade |
  +---------------------+---------------+-------------------+---------------+-------+
  |                   1 |             1 |                 1 | 2012-09-04    |     0 |
  |                   2 |             1 |                 2 | 2012-09-11    |     0 |
  |                   3 |             2 |                 1 | 2012-09-14    |     0 |
  +---------------------+---------------+-------------------+---------------+-------+ 
```

classhasstudent.php

```
 <?php
  class Model_ClassHasStudent extends Model_Table {
      public $table='class_has_student';
      public $entity_code='class_has_student';
      public $id_field='idclass_has_student';

      function init(){
          parent::init();

      $this->hasOne('Class','class_idclass','idclass', 'class_name');
          $this->hasOne('Student', 'student_idstudent', 'name', 'student_name');
      $this->addField('date_enrolled')->type('date');
      $this->addField('grade');

      }

  } 
```

mysql“主题”表

```
 +--------------+-------------+------+-----+---------+----------------+
  | Field        | Type        | Null | Key | Default | Extra          |
  +--------------+-------------+------+-----+---------+----------------+
  | idsubject    | int(11)     | NO   | PRI | NULL    | auto_increment |
  | name         | varchar(45) | YES  |     | NULL    |                |
  | subject_code | varchar(45) | YES  |     | NULL    |                |
  | semester     | varchar(45) | YES  |     | NULL    |                |
  | description  | blob        | YES  |     | NULL    |                |
  +--------------+-------------+------+-----+---------+----------------+

  select * from subject;
  +-----------+-----------+--------------+----------+--------------------------+
  | idsubject | name      | subject_code | semester | description              |
  +-----------+-----------+--------------+----------+--------------------------+
  |         1 | Maths     | mat101       | 1        | Mathematics and numbers. |
  |         2 | English   | enh101       | 1        | English and languages.   |
  |         3 | Chemistry | chm101       | 2        | Inorganic chemistry.     |
  +-----------+-----------+--------------+----------+--------------------------+ 
```

主题.php

```
 <?php

  class Model_Subject extends Model_Table {
      public $entity_code='subject';
  public $id_field='idsubject';

      function init(){
          parent::init();

      $this->addField('name');
      $this->addField('subject_code');
      $this->addField('semester');
      $this->addField('description');

      }

  } 
```

**李斯特**

```
 <?php
  // Lister class for displaying classes that a student attends.
  class StudentClasses extends Lister {

      function init(){
          parent::init();
      }

      // Override defaultTemplate function.
      function defaultTemplate(){
          return array('view/class_info');
      }
  } 
```

**模板**

/templates/default/view/student_details.html

```
 <div id="<?$_name?>" class="projectinfo">

      <table class="student">
      <tr><td id="property">Student Name</td><td id="value"> <?$name?> </td></tr>
      <tr><td id="property">Student ID</td> <td id="value"><?$student_id?></td></tr>
      </table>

  </div>

  <h2>Enrolled classes</h2>
  <?ClassList?>
  <?/?> 
```

/templates/default/view/class_info.html

```
 <dl id="<?$_name?>" class="<?$class?>">
<dt><?$subject_name?></dt>
<dd><?$date_start?></dd><dd><?$date_start?></dd>
  </dl> 
```

**页面**

```
<?php

class page_TestClasses extends Page {
    function init() {
        parent::init();

        $this->api->auth->check();
        $this->api->stickyGET('id');

    }

    // Called only once.
    function initMainPage(){

        $view=$this->add('View',null,null,array('view/student_details'));

//      $student = $this->add('Model_Student')->loadAny();

        $student = $this->add('Model_Student')->loadAny();

//      $student_detail= $student->ref('ClassHasStudent')->debug();
//      select `idclass_has_student`,`class_idclass`,(select `idclass` from `class` where `class_has_student`.`class_idclass` = `class`.`idclass` ) `class_idclass_2`,`student_idstudent`,(select `name` from `student` where `class_has_student`.`student_idstudent` = `student`.`idstudent` ) `student_name`,`date_enrolled`,`grade` from `class_has_student` where `class_has_student`.`student_idstudent` = "1"
+---------------------+---------------+-----------------+-------------------+--------------+---------------+-------+
| idclass_has_student | class_idclass | class_idclass_2 | student_idstudent | student_name | date_enrolled | grade |
+---------------------+---------------+-----------------+-------------------+--------------+---------------+-------+
|                   1 |             1 |               1 |                 1 | Tom          | 2012-09-04    |     0 |
|                   3 |             2 |               2 |                 1 | Tom          | 2012-09-14    |     0 |
+---------------------+---------------+-----------------+-------------------+--------------+---------------+-------+

        // USING $this->hasOne('Class','class_idclass','idclass', 'class_name'); in ClassHasStudent
//      select `idclass_has_student`,`class_idclass`,(select `idclass` from `class` where `class_has_student`.`class_idclass` = `class`.`idclass` ) `class_name`,`student_idstudent`,(select `name` from `student` where `class_has_student`.`student_idstudent` = `student`.`idstudent` ) `student_name`,`date_enrolled`,`grade` from `class_has_student` where `class_has_student`.`student_idstudent` = "1";
+---------------------+---------------+------------+-------------------+--------------+---------------+-------+
| idclass_has_student | class_idclass | class_name | student_idstudent | student_name | date_enrolled | grade |
+---------------------+---------------+------------+-------------------+--------------+---------------+-------+
|                   1 |             1 |          1 |                 1 | Tom          | 2012-09-04    |     0 |
|                   3 |             2 |          2 |                 1 | Tom          | 2012-09-14    |     0 |
+---------------------+---------------+------------+-------------------+--------------+---------------+-------+

        $student_detail= $student->ref('ClassHasStudent')->ref('class_idclass')->debug();
//      select `idclass`,`subject_idsubject`,(select `name` from `subject` where `class`.`subject_idsubject` = `subject`.`idsubject` ) `subject_idsubject_2`,`date_start`,`date_end`,`max_students` from `class`
+---------+-------------------+---------------------+------------+------------+--------------+
| idclass | subject_idsubject | subject_idsubject_2 | date_start | date_end   | max_students |
+---------+-------------------+---------------------+------------+------------+--------------+
|       1 |                 2 | English             | 2012-09-10 | 2012-09-30 |           10 |
|       2 |                 1 | Maths               | 2012-09-08 | 2012-09-30 |           30 |
|       3 |                 3 | Chemistry           | 2012-10-01 | 2012-10-31 |           35 |
|       4 |                 2 | English             | 2012-09-19 | 2012-09-29 |           10 |
+---------+-------------------+---------------------+------------+------------+--------------+

        // Add Lister object to view, using LibraryList template spot.
        $ClassList = $view->add('StudentClasses', null, 'ClassList');

        $view->setModel( $student );
        $ClassList->setModel( $student_detail );

    }
} 
```

我也修改`Table::hasOne()`为以下，哪里`hasOne`可以设置dereferenced_field变量。/atk4/lib/Model/Table.php

```
/** Defines one to many association */
function hasOne($model,$our_field=null,$display_field=null,$deref_field_name=null){
    if(!$our_field){
        if(!is_object($model)){
            $tmp=preg_replace('|^(.*/)?(.*)$|','\1Model_\2',$model);
            $tmp=new $tmp; // avoid recursion
        }else $tmp=$model;
        $our_field=($tmp->table).'_id';
    }
    $r=$this->add('Field_Reference',$our_field);
    $r->dereferenced_field=$deref_field_name;
    $r->setModel($model,$display_field);
    return $r;
} 
```

# 更新 1

将上述示例更改为视频中指定的设计会生成以下代码：

学生.php

```
 <?php
  class Model_Student extends Model_Table {
      public $table='student';
      public $entity_code='student';
      public $id_field='idstudent';
      public $title_field='name';

      function init(){
          parent::init();

          $this->addField('student_id')->caption('Student ID');
          $this->addField('name')->caption('Name');
          $this->hasMany('ClassJoinClassHasStudent');
      }
  } 
```

ClassJoinClassHasStudent.php

```
class Model_ClassJoinClassHasStudent extends Model_Class {

    function init(){
        parent::init();

        $chs = $this->join('class_has_student.class_idclass','idclass');
        // Import fields from ClassHasStudent
        $chs->addField('date_enrolled');
        $chs->addField('grade');

        $chs->hasOne('Class'); // use id_class from CHS table.
    }
} 
```

但是，我收到以下与在 ClassJoinClassHasStudent 中设置主字段相关的错误。我试过调用 hasMany('ClassJoinClassHasStudent', 'student_idstudent', 'idstudent')，但错误是一样的，只是它抱怨的是 student_idstudent 而不是 student_id。

```
BaseException

Child element not found

Additional information:

    Raised by object: Object Model_ClassJoinClassHasStudent(studentenrol_testclasses_model_student_ClassJoinClassHasStudent_model_classjoinclasshasstudent)
    element: student_id

Possible Actions:

    Debug this Model

/home/user1/public_html/studentenrol/atk4/lib/BaseException.php:38
Stack trace:
/home/user1/public_html/studentenrol/atk4/lib/BaseException.php :38     BaseException   BaseException->collectBasicData(Null, 1, 0)
/home/user1/public_html/studentenrol/atk4/lib/AbstractObject.php    :292    BaseException   BaseException->__construct("Child element not found")
/   :   studentenrol_testclasses_model_student_ClassJoinClassHasStudent_model_classjoinclasshasstudent  Model_ClassJoinClassHasStudent->exception("Child element not found")
/home/user1/public_html/studentenrol/atk4/lib/Model/Table.php   :87         Loggercall_user_func_array(Array(2), Array(1))
/home/user1/public_html/studentenrol/atk4/lib/AbstractObject.php    :202    studentenrol_testclasses_model_student_ClassJoinClassHasStudent_model_classjoinclasshasstudent  Model_ClassJoinClassHasStudent->exception("Child element not found")
/home/user1/public_html/studentenrol/atk4/lib/Model/Table.php   :259    studentenrol_testclasses_model_student_ClassJoinClassHasStudent_model_classjoinclasshasstudent  Model_ClassJoinClassHasStudent->getElement("student_id")
/home/user1/public_html/studentenrol/atk4/lib/Model/Table.php   :321    studentenrol_testclasses_model_student_ClassJoinClassHasStudent_model_classjoinclasshasstudent  Model_ClassJoinClassHasStudent->addCondition("student_id", "1")
/home/user1/public_html/studentenrol/atk4/lib/SQL/Many.php  :48     studentenrol_testclasses_model_student_ClassJoinClassHasStudent_model_classjoinclasshasstudent  Model_ClassJoinClassHasStudent->setMasterField("student_id", "1")
/home/user1/public_html/studentenrol/atk4/lib/Model/Table.php   :243    studentenrol_testclasses_model_student_ClassJoinClassHasStudent SQL_Many->ref(Null)
/home/user1/public_html/studentenrol/page/testclasses.php   :93     studentenrol_testclasses_model_student  Model_Student->ref("ClassJoinClassHasStudent")
/home/user1/public_html/studentenrol/atk4/lib/ApiFrontend.php   :93     studentenrol_testclasses    page_TestClasses->initMainPage()
/home/user1/public_html/studentenrol/atk4/lib/ApiWeb.php    :332    studentenrol    Frontend->layout_Content()
/home/user1/public_html/studentenrol/atk4/lib/ApiFrontend.php   :33     studentenrol    Frontend->addLayout("Content")
/home/user1/public_html/studentenrol/atk4/lib/ApiWeb.php    :208    studentenrol    Frontend->initLayout()
/home/user1/public_html/studentenrol/index.php  :24     studentenrol    Frontend->main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T01:06:00.010

我重新创建了您的示例并更改了如下代码：

```
$student = $this->add('Model_Student')->loadAny();
$student_detail= $this->add('Model_Class');
$student_detail->join('class_has_student.class_idclass','idclass')->addField('student_idstudent');
$student_detail->addCondition('student_idstudent',$student->id);
$ClassList = $view->add('StudentClasses', null, 'ClassList');

$view->setModel( $student );
$ClassList->setModel( $student_detail->debug() ); 
```

基本上你必须从你愿意展示的模型开始。因为要列出类，所以应该选择 Model_Class。然后将模型与多对多表连接起来，并从另一端 (student_idstudent) 定义字段。接下来，您可以在条件下使用它。

![在此处输入图像描述](../Images/e2efa89cef522da3feddbdb45fce752b.png)

我还必须修补 Model_Table 以允许 hasOne() 的第四个参数定义取消引用的字段，所以请更新到最新的 ATK4。

[https://github.com/atk4/atk4-testsuite/commit/ccaef2c5e5841bb265001f00d832c3583a4cf722](https://github.com/atk4/atk4-testsuite/commit/ccaef2c5e5841bb265001f00d832c3583a4cf722)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T19:30:20.323

我认为这个视频解释了如何处理你的问题：

[http://www.youtube.com/watch?v=yghw7MZABPk&feature=plcp](http://www.youtube.com/watch?v=yghw7MZABPk&feature=plcp)

以最有效的方式。

# wpf - 检测 WPF 上的手写笔橡皮擦按钮

> ID：12479165
> 
> 赞同：1
> 
> 时间：2012-09-18T14:33:38.800
> 
> 标签：wpf, touch, stylus-pen

有什么方法可以检测到在 WPF 元素上按下了手写笔橡皮擦按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T17:08:39.763

答案似乎是检测笔是否倒置。 [http://msdn.microsoft.com/EN-US/library/ms607230(VS.110).aspx](http://msdn.microsoft.com/EN-US/library/ms607230(VS.110).aspx)

（在联想 x61 平板电脑上测试）

在 MainWindow.Xaml

```
<TextBlock Name="textBox"
        Text="Hello World!" HorizontalAlignment="Center" VerticalAlignment="Center"
        StylusDown="TextBlock_StylusDown_1"/> 
```

在 MainWindow.Xaml.cs

```
 private void TextBlock_StylusDown_1(object sender, StylusDownEventArgs e)
    {
        if (e.Inverted)
            textBox.Text = "I've been erased";
        else
            textBox.Text = "Normal stylus";
    } 
```

# c# - C#：使exe不直接运行

> ID：12479168
> 
> 赞同：1
> 
> 时间：2012-09-18T14:33:44.777
> 
> 标签：c#, exe

我需要使主 .exe 无法从中运行（当您尝试直接启动它时，您会收到一条消息：无法直接启动，如果它从辅助 exe 运行（只有它，我认为必须有 crc 验证）然后开始.

希望我说清楚第一个.exe不能直接启动第二个.exe可以启动第一个exe（仅限）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T14:36:28.293

使第一个 exe 成为[DLL](http://msdn.microsoft.com/en-us/library/3707x96z%28v=vs.80%29.aspx)。然后第二个程序可以使用它，但用户将无法直接运行它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-18T14:36:04.703

设置无法直接启动的 EXE 以接受参数，例如来自应该启动它的一些唯一数据的 SHA-256 哈希。如果该参数不存在或不是预期的，则显示错误并退出。

编辑：

```
static class Program
{
   static void Main(params string[] args) //<- first needed change
   {
       if(args.Length == 0 || args[0] != "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855")
       {
          Console.WriteLine("Cannot execute this program directly.")
          return;
       }

       ... //rest of main function
   }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-18T14:38:27.393

最简单的方法是使用命令行参数，或者更好的是，设置一个环境变量并运行它，所以几乎没有办法从“我可以绕过你希望我使用你的应用程序的事实来跟踪需求”运行”。但是，我会说 DLL 将是真正可行的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-18T14:35:13.357

我不确定进程名称 ( `Process.GetCurrentProcess().ProcessName`) 是否会给您第一个或第二个 EXE 名称，但您可以将第一个 EXE 作为 DLL，将第二个作为 EXE。

# php - PHP中会话变量的确切用途是什么？？？它与会话 ID 有何不同？

> ID：12479170
> 
> 赞同：-2
> 
> 时间：2012-09-18T14:33:44.617
> 
> 标签：php, phpmyadmin

```
<?php

session_start();

$_SESSION['name'] = 'Alex';

?> 
```

PHP会话变量是会话ID吗？如果没有，那么当我们已经拥有唯一的会话 ID 时，会话变量的确切用途是什么？有人可以解释一下吗？一个例子会有很大帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:35:40.197

`$_SESSION`PHP 使用 SID从会话存储中重新创建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T14:37:06.583

会话变量只是存储在会话中的变量，而会话 ID 唯一标识特定用户的会话。（所有会话变量都将存储在超全局 $_SESSION 中）。

会话 ID 将作为 cookie 存储在您的浏览器中，并针对每个请求发送到服务器（只要 cookie 域与请求的服务器域匹配），以便服务器知道哪个会话属于您的特定请求。

简而言之：会话允许您通过多个单独的请求访问和保存数据，这对于（大多数）无状态协议（例如 http）通常是不可能的。

更多信息：[http ://www.php.net/manual/en/book.session.php](http://www.php.net/manual/en/book.session.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:46:02.927

Session 变量仅用于存储将持续存在的数据，直到会话被终止或过期。例如，许多人在用户登录网站时使用它，然后您将会话变量与用户的 id 以及他们的一些其他信息一起存储。另一次您可能会使用它，如果您有一个分布在多个页面上的多部分表单。您可以将数据存储在会话中，直到您准备好最终将其存储在数据库中或对其进行其他操作，而无需将数据存储在每个页面上的隐藏输入字段中。

# android - 从源代码为 maguro 构建 Android JB

> ID：12479175
> 
> 赞同：0
> 
> 时间：2012-09-18T14:33:59.207
> 
> 标签：android, linux, git, android-source, repository

我想从源代码为 Galaxy Nexus 构建 Android JB。当我执行`lunch`并选择*maguro*时，我看到以下内容：

```
PLATFORM_VERSION_CODENAME=AOSP
PLATFORM_VERSION=4.0.9.99.999.9999.99999
TARGET_PRODUCT=full_maguro
TARGET_BUILD_VARIANT=userdebug
TARGET_BUILD_TYPE=release
TARGET_BUILD_APPS=
TARGET_ARCH=arm
TARGET_ARCH_VARIANT=armv7-a-neon
HOST_ARCH=x86
HOST_OS=linux
HOST_OS_EXTRA=Linux-3.2.0-30-generic-x86_64-with-Ubuntu-12.04-precise
HOST_BUILD_TYPE=release
BUILD_ID=OPENMASTER
OUT_DIR=out 
```

所以，我认为 PLATFORM_VERSION 是 ICS。

AFAIK 我检查了*master*。[https://android.googlesource.com/platform/manifest](https://android.googlesource.com/platform/manifest)如果我在这里打开*master*，我无法理解它是什么平台版本。如何找到*master*分支中的平台版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T17:35:03.017

`build/core/version_defaults.mk` 在您的源文件中，如果`PLATFORM_SDK_VERSION` 是 16，那么它是 Jellybean。

进一步的检查是通过比较在构建后在 out 目录中创建的 current.txt 到`frameworks/base/api/16.txt`. 这样构建的公共api就和16个一样

编辑：文件 version_defaults.mk 是否也有 PLATFORM_VERSION := 4.1.1？

# jquery - Windows 7 Sidebar Gadget，没有得到 Ajax 调用的结果

> ID：12479176
> 
> 赞同：3
> 
> 时间：2012-09-18T14:34:01.093
> 
> 标签：jquery, ajax, windows-desktop-gadgets

在我的 Windows 小工具代码中，在 SettingsClosing(event) 中使用 jQuery 进行了 ajax (POST) 调用。[我通过Fiddler](http://www.fiddler2.com/fiddler2/)观看 ajax 调用执行。Ajax 调用正在返回所需的结果。但它没有触发成功回调 ajax。我在主视图的 OnPageLoad() 事件中尝试了相同的代码，它在那里工作正常，我的代码是这样的

```
function Login(username, password) {
    var url = "http://example.com/Auth.php";
    var data = { pusername: username, ppassword: password };
    jQuery.support.cors = true;
    $.ajax({
        type: "POST"
            , dataType: "json"
            , url: url, data: data
            , success: function (refresh_token) {
                System.Gadget.Settings.write("success", "true");
                System.Gadget.Settings.write("dd", refresh_token);
                var tok = refresh_token['refreshtoken'];
                var name = refresh_token['name'];
                System.Gadget.Settings.write("name", name);
                System.Gadget.Settings.write("refreshtoken", tok);

            }
                , error: function (XMLHttpRequest, textStatus, errorThrown) {
                    System.Gadget.Settings.write("login_error", errorThrown);
                    System.Gadget.Settings.write("login_STATUS", textStatus);
                }
    });
}

function SettingsClosing(event) 
{
    //use this question to now if setting was closed with OK button
    if (event.closeAction == event.Action.commit)
    {
        var username = $('#txtpUsername').val();
        var password = $('#txtpPassword').val();
        Login(username, password);

    }
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:41:23.570

因为 ajax 调用是异步的，所以在操作完成之前代码似乎没有机会运行。您可以尝试设置`event.cancel`为 true，然后在 ajax 调用完成后手动触发关闭。MSDN 参考： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms723677 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms723677(v=vs.85).aspx)

# iphone - Freelancer Iphone 开发 - Xcode 警告可以接受吗？

> ID：12479177
> 
> 赞同：1
> 
> 时间：2012-09-18T14:34:11.680
> 
> 标签：iphone, ios, xcode, warnings

一位自由职业者正在为我开发一个 Iphone 应用程序。该应用程序运行良好，但当我在 Xcode 中加载源代码时收到 37 个警告。您是否介意快速查看一下并告诉我是否有一些我应该担心的警告。

谢谢你的帮助 ！

```
yyy Group
Semantic Issue Group
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/FMDatabase/FMDatabase.m:313:74: Second argument to 'va_arg' is of promotable type 'char'; this va_arg has undefined behavior because arguments will be promoted to 'int'
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/FMDatabase/FMDatabase.m:326:70: Second argument to 'va_arg' is of promotable type 'short'; this va_arg has undefined behavior because arguments will be promoted to 'int'
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/FMDatabase/FMDatabase.m:329:78: Second argument to 'va_arg' is of promotable type 'unsigned short'; this va_arg has undefined behavior because arguments will be promoted to 'int'
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/FMDatabase/FMDatabase.m:350:66: Second argument to 'va_arg' is of promotable type 'float'; this va_arg has undefined behavior because arguments will be promoted to 'double'
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2598:31: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2599:31: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2600:31: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2601:31: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2602:31: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2605:171: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2606:171: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2607:171: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2608:171: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2609:171: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2791:40: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:2802:45: Direct access to objective-c's isa is deprecated in favor of object_setClass() and object_getClass()
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Twitter/SHKTwitter.m:63:17: Receiver type 'int' is not 'id' or interface pointer, consider casting it to 'id'
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Twitter/SHKTwitter.m:63:16: Instance method '-boolValue' not found (return type defaults to 'id')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/UI/SHKFormControllerLargeTextField.m:97:120: Class method '+sharerTitle' not found (return type defaults to 'id')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/UI/SHKFormControllerLargeTextField.m:240:2: Instance method '-sendDidCancel' not found (return type defaults to 'id')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/UI/SHKFormControllerLargeTextField.m:246:5: Instance method '-sendForm:' not found (return type defaults to 'id')
Format String Issue Group
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/FMDatabase/FMDatabase.m:943:45: Format specifies type 'int' but the argument has type 'long'
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:745:180: Format specifies type 'unsigned long' but the argument has type 'NSUInteger' (aka 'unsigned int')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:746:134: Format specifies type 'unsigned long' but the argument has type 'NSUInteger' (aka 'unsigned int')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:752:98: Format specifies type 'unsigned long' but the argument has type 'NSUInteger' (aka 'unsigned int')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:773:114: Format specifies type 'unsigned long' but the argument has type 'NSUInteger' (aka 'unsigned int')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:786:114: Format specifies type 'unsigned long' but the argument has type 'NSUInteger' (aka 'unsigned int')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/JSONKit/JSONKit.m:795:114: Format specifies type 'unsigned long' but the argument has type 'NSUInteger' (aka 'unsigned int')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Core/Helpers/OAuth/OAMutableURLRequest.m:194:48: Format specifies type 'int' but the argument has type 'time_t' (aka 'long')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Core/SHK.m:523:54: Format specifies type 'int' but the argument has type 'NSTimeInterval' (aka 'double')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Facebook/SHKFacebook.m:87:53: Format specifies type 'int' but the argument has type 'NSTimeInterval' (aka 'double')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Flickr/LFHTTPRequest.m:460:72: Format specifies type 'unsigned long' but the argument has type 'NSUInteger' (aka 'unsigned int')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Flickr/LFHTTPRequest.m:469:72: Format specifies type 'unsigned long' but the argument has type 'NSUInteger' (aka 'unsigned int')
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Google Reader/SHKGoogleReader.m:245:65: Format specifies type 'int' but the argument has type 'NSTimeInterval' (aka 'double')
Cocoa API Issue Group
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Facebook/FBRequest.m:152:29: Using 'stringWithString:' with a literal is redundant
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Facebook/FBRequest.m:161:29: Using 'stringWithString:' with a literal is redundant
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Twitter/SHKTwitter.m:610:21: Using 'stringWithString:' with a literal is redundant
/Users/xxx/Desktop/Iphone App/yyy 3/yyy/Classes/ShareKit/Sharers/Services/Vkontakte/SHKVkontakte.m:409:20: Using 'stringWithString:' with a literal is redundant 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T14:36:27.880

这些警告中的大多数似乎来自项目中使用的第三方库，例如 JSONKit 和 ShareKit。尽管就我个人而言，没有什么太重要的事情突然出现在我身上。可以在不同版本的 Xcode 之间产生警告。

# c# - 创建读取模型（聚合）的最佳方式

> ID：12479178
> 
> 赞同：0
> 
> 时间：2012-09-18T14:34:13.290
> 
> 标签：c#, .net, asp.net-mvc, domain-driven-design

我必须使用 CartLine 和其他一些信息创建一个复杂的“读取模型”（购物车）。目前我有一个基于许多其他对象（Cart、Operation...）的 ViewModel，构建此对象的逻辑在 Respository 和 Controller（不在 Aggregate 中）中调度，我想重构这段代码，使用存储库直接返回“读取模型”（带有格式化文本，价格......）。

我只被允许在 Dapper 中使用存储过程（客户的策略）。我正在寻找一种更好的方法来创建这个读取模型：

1.调用现有存储过程，将存储过程结果映射到DTO上，然后再次将结果映射到我的读取模型上

```
public class Cart
{
    public Cart(CartDb cartDb, IEnumerable<CartDetailDb> cartDetailsDb, 
                                                      OperationDB operationDb)
    {
        //Code
    }
} 
```

-> 有两个层次的对象，我觉得很乱

2.创建将直接映射到我的读取模型的存储过程（以避免 DTO）

-> 我不喜欢这种方法，因为我最终可能会在存储过程中添加一些逻辑

3.使用视图模型

其他建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T17:20:01.850

如果我理解正确，您的该实体的**数据模型**与您的该实体的**域模型**并不完全一致`Read`。您还希望您的存储库层直接返回您的**域模型**版本，`Read`而不需要一些中间 DTO 层。

在我看来，**选项#1**最有意义。因为您的数据模型和域模型之间存在阻抗不匹配，所以在某处需要映射逻辑来在两个模型之间转换数据。这个逻辑最合适的地方是在你的存储层内部，因为这个层的全部目的是在域和它们的持久性之间映射对象。

这并不意味着您需要创建一个 DTO 层来从您的存储过程进行映射，然后您转身并重新映射到域对象。您可以简单地直接对数据访问层返回的结果集执行翻译逻辑，并一步将其转换为域对象。

在数据访问的情况下，对 DTO 的需求很大程度上取决于您用于数据访问的技术。例如，如果您使用的是 ADO.net 库（`SqlCommand`、`SqlConnection`等），则可能不需要 DTO。但是，如果您使用的是 Entity Framework 或 NHibernate 之类的 ORM，那么将这些工具生成的对象严格用作 DTO 并映射到完整的域对象可能是有意义的。当然，由于这些对象是为您生成的，因此几乎消除了拥有 DTO 层的任何维护问题。

这也不意味着您需要将转换逻辑放在存储过程中，以使数据层返回与您的域模型完全匹配的结果集。正如您自己所说，我会**不惜一切代价避免这种情况**，这会将域逻辑放入您的数据库中。

最后，您提到域对象由“格式化文本”组成，例如价格。我要指出，大多数时候文本格式实际上是 UI 层的一部分，而不是您的域模型。这意味着如果您的模型上有一个属性，例如`Price`，它应该表示为`Double`or`Decimal`而不是`String`格式化为货币。换句话说，该值应该是**5.00**而不是**"$5.00"**。

为了处理像这样的格式翻译，用`ViewModel`你提到的类似的包装你的域对象是合适的，以处理从域到 UI 层的翻译。在此类情况下使用严格的分离关注点有助于创建更健壮且更易于维护的系统。

# c# - 隔离存储设置访问引发“System.IO.FileNotFoundException”类型的第一次机会异常

> ID：12479179
> 
> 赞同：0
> 
> 时间：2012-09-18T14:34:14.430
> 
> 标签：c#, windows-phone-7, exception, isolatedstorage, .net

我正在创建一个设置视图和一个“相关”设置类，如下所述：

[如何：为 Windows Phone 创建设置页面](http://msdn.microsoft.com/en-us/library/ff769510%28v=vs.92%29.aspx)

这不是我的第一次尝试，但是当我尝试从 IsolatedStorageSettings 获取 ApplicationSettings 时，我**在 mscorlib.dll 中遇到了“System.IO.FileNotFoundException”类型的第一次机会异常。**这发生在后面的视图代码和相关的视图模型中，在我的应用程序的其他部分（即代码后面或其他视图的视图模型）中它工作正常。为什么？？？

这是代码：

应用设置.cs

```
using System;
using System.Collections.Generic;
using System.IO.IsolatedStorage;
using System.Windows;

namespace MetanoInLombardia
{
    public class AppSettings
    {
        IsolatedStorageSettings settings;

        const string IsAutoUpdateOn_KeyName = "AutoUpdateOn"; 

        const bool IsAutoUpdateOn_Default = true;

        public AppSettings()
        {
            try
            {
                if (!System.ComponentModel.DesignerProperties.IsInDesignTool)
                {
                    settings = IsolatedStorageSettings.ApplicationSettings;
                }
            }
            catch (Exception e)
            {
                MessageBox.Show("Exception while using IsolatedStorageSettings in AppSettings(): " + e.ToString());
            }
        }

        public void AddOrUpdateValue(string Key, Object value)
        {
            if (settings.Contains(Key))
            {
                if (settings[Key] != value)
                {
                    settings[Key] = value;
                    Save();
                }
            }
            else
            {
                settings.Add(Key, value);
                Save();
            }
        }

        public T GetValueOrDefault<T>(string Key, T defaultValue)
        {
            if (!settings.Contains(Key))
            {
                AddOrUpdateValue(Key, defaultValue);
            }
            return (T)settings[Key];
        }

        public void Save()
        {
            settings.Save();
        }

        public bool IsAutoUpdateOn
        {
            get
            {
                return GetValueOrDefault<bool>(IsAutoUpdateOn_KeyName, IsAutoUpdateOn_Default);
            }
            set
            {
                AddOrUpdateValue(IsAutoUpdateOn_KeyName, value);
            }
        }
    }
} 
```

SettingsViewModel.cs [提取]

```
using GalaSoft.MvvmLight;
using MetanoInLombardia.Model;
using System;
using System.Windows;
using System.IO.IsolatedStorage;

namespace MetanoInLombardia.ViewModel
{
    public class SettingsViewModel : ViewModelBase
    {
        private readonly IDataService _dataService;
        private AppSettings settings = null;

        public SettingsViewModel(IDataService dataService)
        {
            _dataService = dataService;

            _dataService.GetApplicationTitle(
                (item, error) =>
                {
                    if (error != null)
                    {
                        return;
                    }
                    ApplicationTitle = item.Title;
                });

            this.settings = new AppSettings();
        }
...
    }
} 
```

我在 AppSettings.cs 中遇到异常，连续

```
settings = IsolatedStorageSettings.ApplicationSettings; 
```

# passwords - 如何通过命令提示符创建带空格的密码

> ID：12479180
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:34:16.593
> 
> 标签：passwords, command, cmd, prompt

我找到了通过命令提示符更改用户密码的语法。我正在使用：网络用户用户名密码

我已成功将密码更改为普通密码。我不知道如何将其更改为通行证。我将如何编写带有空格的密码的语法？例如，请解释我将如何写“我的新密码”。在 cmd...因为这不起作用：net user testuser2 我的新密码。

我确定这是区分大小写的，不是吗？如果它对密码的大小写敏感，为什么它不能将 sapces 识别为密码的一部分？

感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:38:34.920

尝试用引号将密码括起来，例如：

```
net user username "My new password" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:40:21.770

通常，您可以将短语放在双引号中，例如“我的新密码”是您的命令行中有空格。

# c#-4.0 - 动态 COM 对象 1 索引数组 InvalidCastException 错误

> ID：12479185
> 
> 赞同：1
> 
> 时间：2012-09-18T14:34:27.520
> 
> 标签：c#-4.0, dynamic, com

我有一个在 C# .NET 4.0 应用程序中使用的 COM API。

代码如下所示：

```
if (!object.ReferenceEquals((comObject.Value), null))
{
   // Do something
} 
```

where `comObject`is of type`System.__ComObject`和`Value`is of type `dynamic`。

一般来说，这可以正常工作，但是当实际类型`Value`是字节数组时，它会抛出以下`InvalidCastException`异常：

```
 Unable to cast object of type 'System.Byte[*]' to type 'System.Byte[]'.

   at CallSite.Target(Closure , CallSite , Type , Object , Object )
   at System.Dynamic.UpdateDelegates.UpdateAndExecute3[T0,T1,T2,TRet](CallSite site, T0 arg0, T1 arg1, T2 arg2)
   at ReMetricaTypeSpike.Program.Main(String[] args) in c:\my documents\visual studio 2010\Projects\ReMetricaTypeSpike\ReMetricaTypeSpike\Program.cs:line 28
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart() 
```

该线程[http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/24c0bd62-058a-487e-91ab-ed1bb0b0cca4](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/24c0bd62-058a-487e-91ab-ed1bb0b0cca4)似乎表明抛出异常是因为数组是基于 1 的（它是 -我认为 API 是用 VB 编写的）。但是，我从不明确地进行这种转换，这一切都由动态自动代码处理。

这是 C# 动态的已知错误吗？还是有其他事情发生？

# sitefinity - Sitefinity 模块安装失败

> ID：12479186
> 
> 赞同：1
> 
> 时间：2012-09-18T14:34:30.097
> 
> 标签：sitefinity

我按照 SDK 中的推荐示例创建了一个新模块。但是，它不会安装。没有错误消息可以帮助我朝着某个方向前进。

我已经在调试模式下启动了项目，在安装方法上设置了一个断点，但它从来没有命中。

有谁知道为什么会这样？

谢谢， 雅克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T16:17:22.713

如果未安装，则可能未在系统中正确注册。这是什么版本的 Sitefinity？如果其中一个较新，则在 Administration > Modules 下有一个部分，您可以在其中安装该模块。否则，您需要在 Administration > Settings > Advanced > System > Application Modules 中执行此操作，并在那里手动创建一个新条目

无论哪种方式，请确保模块的全名（包括命名空间）作为 Type 是正确的，并且 startupType 设置为“OnApplicationStart”，以便在网站启动时进行初始化。

然后强制您的网站重新启动（最简单的方法是保存 web.config 文件），它应该会启动。

我希望这是有帮助的！

如果你已经完成了所有这些，但它仍然没有触发，你能告诉我模块是否列在 app_data 文件夹下的 systemConfig.Config 文件中吗？

# model-view-controller - Symfony 控制器让我无法理解的东西

> ID：12479187
> 
> 赞同：0
> 
> 时间：2012-09-18T14:34:30.837
> 
> 标签：model-view-controller, symfony

看看那个代码

```
<?php

namespace Sestante\SestanteBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Request;
use Sestante\SestanteBundle\Model\StrutturaManager;

class MainController extends Controller
{
    public function indexAction(Request $request)
    {
        return $this->render('SestanteSestanteBundle:Main:index.html.twig');
    }

    public function showLodgingsAction(Request $request)
    {
        $repo = $this->getDoctrine()->getRepository('SestanteSestanteBundle:Struttura');
        $usr = $this->get('security.context')->getToken()->getUser();
        $usrId = $usr->getId();
        $sm = new StrutturaManager($repo);
        $lodgingList = $sm->retrieveLodgingsFromUser($usrId);
        return $this->render('SestanteSestanteBundle:Main:showLodgings.html.twig',array('lodgingList' => $lodgingList));
    }
} 
```

这是我一直在编写的应用程序的控制器。

来看看`showLodgingsAction`。我已经尝试将所有业务逻辑放入`StrutturaManager`带有存储库的模型（）中（我直接从控制器传递，因为据我所知，它们仅在此处或通过 DI 可用）查询我的数据库，做一些详细说明并返回我将呈现到模板上的列表。

第一个问题：这种“代码分离”是好的，还是存在更好的方法来做我想做的事情？

第二个问题：假设，现在，我想使用`StrutturaManager`into 类型的对象`indexAction`。请记住，我的对象需要一个存储库。那么，我是否要一次又一次地声明我想要使用它们的每个控制器操作的所有对象？我想这一定存在一种更聪明的方法，但目前我不明白是哪一种。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:42:15.437

定义`StrutturaManager`为[服务](http://symfony.com/doc/current/book/service_container.html)并将其注入`EntityManager`其中。这样管理器就可以访问您需要的存储库，而控制器将不知道 Doctrine 或存储库——这是一个很好的做法。

# python - 在 django 中创建可配置的权限系统

> ID：12479206
> 
> 赞同：0
> 
> 时间：2012-09-18T14:35:41.960
> 
> 标签：python, django

我正在使用 django 创建一个基于 Web 的应用程序。此应用程序将被多个客户用作服务。

它有几个表示层次关系的模型/表。根据这种层次关系授予用户访问权限 - 前县 -> 学校 -> 部门 -> 教室。

因此，有权访问部门的用户可以访问其中的所有教室等

我的问题是如何使这个权限系统可以跨客户端配置。该应用程序应该是一个新客户端来定义任意级别 - 前国家 -> 州 -> 城市 -> 学校 -> 班级。

关于什么是好方法的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:23:23.973

What about storing the new levels in a prefix tree? you could use each level as a node of a branch of the tree.

When a new user wants do define a new level, the prefix tree will be updated starting from the level where the user belongs. If your problem is just about giving visibility to the user of the sub-branch of the level where he belongs, this should work.

A similar approach, maybe less intuitive, is to give to each level a number (or alpha-numeric value), so that in the end a user associated to the level "state" in your example, has a level code of 23 (let's say: "ex-country": 2 and "state": 3), so that he can add sub-levels starting with the prefix 23.

# c++ - 在使用 BOOST 图形库生成的图中添加随机边

> ID：12479207
> 
> 赞同：1
> 
> 时间：2012-09-18T14:35:43.607
> 
> 标签：c++, boost, graph, boost-graph

我想在我的图中添加随机边，如下所示：

```
#include <iostream>
#include <utility>                   // for std::pair
#include <algorithm> 
#include <boost/graph/adjacency_list.hpp>
#include "boost/graph/topological_sort.hpp"
#include <boost/graph/graph_traits.hpp>
#include <boost/graph/graphviz.hpp>

int main()
{
    using namespace std;
    using namespace boost;

    typedef adjacency_list< listS, vecS, undirectedS > undigraph;

    int const N = read_int_from_user("Number of vertices: ");   

    undigraph g(N);

    // add some edges,             // #1
    for (int i = 0; i != N; ++i)
    {
        for (int j = 0; j != N; ++j)
        {
            add_edge(i, j, g);
        }
    }
    write_graphviz(cout, g);
} 
```

以下几`#1`行就是这样做的。

但是正如您所看到的，每个顶点存在 8 条边，但我希望最多只有 4 条，并且希望以随机方式连接所有顶点，最重要的是，每个顶点只能有 4 个化合价。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:47:03.183

**编辑：**当我的意思是“无序对”时，我说的是“有序对”！希望现在改写更清楚。

您需要做的是从所有小于 N 的*无序*非负整数对的集合中进行抽样而不进行替换。由于计算机表示有序对比无序对容易得多，因此生成该集合的常用方法是生成第一个元素小于第二个元素的所有有序对：

```
vector<pair<int, int> > pairs;

for (int i = 0; i < N; ++i) {
    for (int j = i + 1; j < N; ++j) {
        pairs.push_back(make_pair(i, j));
    }
} 
```

因此，例如，如果 N = 4，则要考虑的可能边集是：

```
0, 1
0, 2
0, 3
1, 2
1, 3
2, 3 
```

一旦你有了它，一个从这个集合中采样的好方法是使用[水库采样](http://en.wikipedia.org/wiki/Reservoir_sampling)。

# c - 列出某个动态加载库的已使用符号

> ID：12479208
> 
> 赞同：3
> 
> 时间：2012-09-18T14:35:44.877
> 
> 标签：c, linker, dependencies, symbols

我想列出程序从特定库加载的符号。您可以使用 ldd 列出所需的库：

```
 ldd -v myExecutable 
```

这给出了类似于以下输出的内容：

```
 libgcc_s.so.1 (GCC_3.0) => /lib/i386-linux-gnu/libgcc_s.so.1
    libc.so.6 (GLIBC_2.1) => /lib/i386-linux-gnu/libc.so.6
    libc.so.6 (GLIBC_2.11) => /lib/i386-linux-gnu/libc.so.6
    libc.so.6 (GLIBC_2.1.3) => /lib/i386-linux-gnu/libc.so.6
    libc.so.6 (GLIBC_2.0) => /lib/i386-linux-gnu/libc.so.6 
```

现在我想知道从哪个库加载了哪些符号。具体来说，就我而言，我想找到从 GLIBC_2.11 加载的那些并最终摆脱它们。

（我已经在使用[ligcc](http://listaller.tenstral.net/wiki/doku.php/ligcc)来避免链接新符号 - 现在我想看看哪些符号在 2.11 之前不可用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:40:07.510

使用`LD_DEBUG`环境变量。例如：

```
$ LD_USE_LOAD_BIAS=0 LD_DEBUG=all ls |& grep binding
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `_res' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `_IO_file_close' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `stderr' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `error_one_per_line' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `__malloc_initialize_hook' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/ld-linux-x86-64.so.2 [0]: normal symbol `_dl_starting_up' [GLIBC_PRIVATE]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `__morecore' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `__key_encryptsession_pk_LOCAL' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `__progname_full' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `__ctype32_tolower' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `_environ' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/ld-linux-x86-64.so.2 [0]: normal symbol `_rtld_global' [GLIBC_PRIVATE]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `__progname' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `argp_err_exit_status' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `mallwatch' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `__rcmd_errstr' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/libc.so.6 [0]: normal symbol `svcauthdes_stats' [GLIBC_2.2.5]
 22160: binding file /lib64/libc.so.6 [0] to /lib64/ld-linux-x86-64.so.2 [0]: normal symbol `__libc_enable_secure' [GLIBC_PRIVATE]
 [...]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `__libc_start_main' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `strrchr' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `setlocale' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `bindtextdomain' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `textdomain' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `__cxa_atexit' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `isatty' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `getenv' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `__ctype_b_loc' [GLIBC_2.3]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `__errno_location' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `strtoul' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `ioctl' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `getopt_long' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `malloc' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `memcpy' [GLIBC_2.14]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `strlen' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `opendir' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `readdir' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `closedir' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `free' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `_setjmp' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `strcoll' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `__ctype_get_mb_cur_max' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `fwrite_unlocked' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `exit' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `__fpending' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `fileno' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `__freading' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `fflush' [GLIBC_2.2.5]
 22160: binding file ls [0] to /lib64/libc.so.6 [0]: normal symbol `fclose' [GLIBC_2.2.5] 
```

有关更多详细信息，请参阅`man ld.so`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T14:40:15.917

`nm`可能会满足你的追求。刚刚在我的可执行文件上使用了它，它确实提供了库的版本以及符号。例如：

```
U tan@@GLIBC_2.0 
```

so you could do a grep to find only the version you're interested in.

# ruby - 在循环期间将信息输入到文本区域或从下拉列表中的文本值中进行选择？（红宝石/水）

> ID：12479209
> 
> 赞同：1
> 
> 时间：2012-09-18T14:35:46.997
> 
> 标签：ruby, watir

目前我有：

```
def addInfoToStory(idOfStory, *stories)

i = -1
numOfInputs = 9
  while i < numOfInputs
  stories.each.with_index do |story|
  $log.puts "i="+"#{i}"
  $log.puts story[i]
  $log.puts "i2="+"#{i}"
  @browser.div(id: "#{idOfStory}_firstCol").div(class: "tDetEntry", index: i+1).div.double_click
    if @browser.div(id: "#{idOfStory}_firstCol").div(class: "tDetEntry", index: (i+=1)).div(class: "formLib1").text_field(:id, "input").set(story[i])
       sleep 2
       @browser.send_keys(:tab)
    else @browser.div(id: "#{idOfStory}_firstCol").div(class: "tDetEntry", index: (i+=1)).div(class: "formLib1").select_list(:id, "select").set(story[i])
       sleep 2
       @browser.send_keys(:tab)
    end
  end 
 end
end 
```

大部分信息都是可以正常工作的文本区域框，但是当我进入下拉菜单时，该值不会改变。任何想法为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T16:15:47.863

最简单的解决方案是让 if 语句检查是否存在文本字段或选择列表。

```
div_container = @browser.div(id: "#{idOfStory}_firstCol").div(class: "tDetEntry", index: (i+=1)).div(class: "formLib1")
if div_container.text_field(:id, "input").present?
    div_container.text_field(:id, "input").set(story[i])
elsif  div_container.select_list(:id, "select").present?
    div_container.select_list(:id, "select").select(story[i])
end
sleep 2
@browser.send_keys(:tab) 
```

另请注意，对于 select_lists，它必须`.select`代替`.set`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T10:24:54.053

必需的

```
storyFields.each_index {|i|
div_container = @browser.div(id: "#{idOfStory}_firstCol").div(class: "tDetEntry", index:     (i+=1)).div(class: "formLib1")
if div_container.text_field(:id, "input").present?
   div_container.text_field(:id, "input").set(story[i])
elsif  div_container.select_list(:id, "select").present?
       div_container.select_list(:id, "select").select(story[i])
end
} 
```

以前的答案在某种程度上有效，但没有正确循环。

# jsf-2 - JSF 组件 API 网址

> ID：12479212
> 
> 赞同：0
> 
> 时间：2012-09-18T14:35:59.407
> 
> 标签：jsf-2

有没有人知道 Mojara JSF 2 组件 API 的 URL。

我似乎把它弄丢了，似乎无法通过 Oracle 的网站找到它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:48:19.510

没有“组件 API”之类的东西。也许您的意思是 JSF 2 标记库文档？

JSF 2.x 标记库文档可在此处获得：

*   JSF 2.0：[http ://docs.oracle.com/javaee/6/javaserverfaces/2.0/docs/pdldocs/facelets/](http://docs.oracle.com/javaee/6/javaserverfaces/2.0/docs/pdldocs/facelets/)
*   JSF 2.1：[http ://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/)

# javascript - 在 jQuery 中创建一个新的（永久的）CSS 样式

> ID：12479215
> 
> 赞同：10
> 
> 时间：2012-09-18T14:36:10.440
> 
> 标签：javascript, jquery, html, css, dom

我想创建一种新样式，而不仅仅是更改元素的样式属性。这是一些示例代码来演示该问题：

```
//Create 1st element
var element1 = $('<div />').text('element1').addClass('blue');
$('body').append(element1);

//Set some css for all elements with the blue class
$('.blue').css('background-color', 'blue');

//Create 2nd element, it won't have the css applied because it wasn't around when the css was set
var element2 = $('<div />').text('element2').addClass('blue');
$('body').append(element2);​ 
```

在上面的代码中，第二个元素与第一个元素的样式不同。我想要的是能够为所有未来的元素在 className 上设置 css。

[JSFiddle](http://jsfiddle.net/YenN4/1/)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-18T14:39:01.953

您可以创建一个新样式表并将其附加到头部：

```
$("<style type='text/css'> .blue{ background-color:blue;} </style>").appendTo("head"); 
```

见演示：http: [//jsfiddle.net/YenN4/2/](http://jsfiddle.net/YenN4/2/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T14:39:41.750

演示：http: [//jsfiddle.net/T6KEW/](http://jsfiddle.net/T6KEW/)

```
$('<style>').text('.blue { background: blue }').appendTo('head');

$('<div>').text('element1').addClass('blue').appendTo('body');
$('<div>').text('element2').addClass('blue').appendTo('body');​ 
```

# php - PHP5 mysqli vs mysql 配置文件

> ID：12479216
> 
> 赞同：3
> 
> 时间：2012-09-18T14:36:19.870
> 
> 标签：php, mysql, web-applications, web

我知道这听起来确实很愚蠢，但我发现 mysqli 准备好的语句及其面向对象的方法很有吸引力，所以我计划将我过去的一些涂鸦从 mysql 转换为 mysqli。

***在这里...问题***

在mysql中我曾经有一个配置文件，例如包含在每个需要数据库的文件中（即`require('sys/dbconfig.php');`）

我不确定我是否需要在 mysqli 中执行此操作，或者像其他人所说的那样，在需要时打开连接，在不需要时关闭它（即粘贴`$mysqli = new mysqli($host, $user, $pass, $database);`在需要数据库事务的任何地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:52:09.510

我这样做：

配置文件

```
define("DB_HOST", "127.0.0.1");
define("DB_NAME", "demo");
define("DB_USER", "root");
define("DB_PASS", "root"); 
```

数据库.php

```
// include database constants
include_once("config.php");                   

// create db connection
$db = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_NAME); 
```

现在你可以通过

```
$result = $db->query("SELECT x FROM y;"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:40:14.153

`MySqlI`有两种风格：*过程*和*面向对象*。

当您使用*程序*样式时，一切都*与 mysqli_ 中的相同*。您指的是*面向对象的*风格，并且配置不同..实际上更面向对象。这意味着您必须创建一个新的 mysqli 实例并使用它的方法来完成工作。

注意：当使用 mysqli_ 与 mysql 相同的方式时，您将遇到与 SQL 注入相同的问题。您应该将 mysqli 与准备好的查询和参数绑定结合使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:04:34.977

Mysqli 在实例化时打开连接`new mysqli(...)`（PDO 也是如此）。

在 PHP 会话期间，您不需要打开/关闭与数据库的**连接**，因为 PHP 会话的持续时间（对于普通网站/Web 应用程序）少于 1 秒。

在代码中多次强制执行等效的 mysql_connect/mysql_close 仅​​对在整个持续时间内不需要活动连接的长时间运行的脚本有帮助。

每个 mysql 用户允许的单独 mysql 连接数是有限的，具体取决于服务器的配置。

如果您有一些运行时间很长的脚本并且可能会与许多其他脚本相交，您可能会用完每个用户允许的所有连接，从而阻止其他用户。

我建议（作为一种简单的方法）在一个文件中实例化 mysqli，您将在需要数据库访问的任何地方包含该文件，使用您在任何需要它的地方存储 mysqli 对象的变量`global $db`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T15:24:15.700

我倾向于像 Panique 那样在配置文件中创建常量。

`fetch_db`我还使用包含连接代码的静态方法创建了一个 App 类。然后每当我需要一个数据库连接时，我只需调用`App::fetch_db()`.

我可以在今天下午晚些时候回家时发布代码和更多解释。

# sharepoint-2010 - 为什么我的 InfoPath 2010 表单存在样式问题？

> ID：12479217
> 
> 赞同：0
> 
> 时间：2012-09-18T14:36:22.040
> 
> 标签：sharepoint-2010, infopath

该表单可以很好地加载到**SharePoint中，并且在****Chrome**和**Firefox**中看起来很合适，但由于某种原因，我的字体样式没有应用，并且我的输入字段设置在**IE 7**和**8**中没有生效。

非常令人沮丧，尤其是因为没有地方可以检查代码以查看是否有一些应该被清除的杂散标签。

有人遇到过这个吗？

清理它的最佳方法是什么？

![这就是它应该看起来的样子（在 Chrome 和 Firefox 中看起来像这样](../Images/1764a968f0619c0c1414393227b0ba01.png) ![这就是它在 IE 7 和 8 中的样子](../Images/d221bd9532fbbedd61d5d17da42f38b6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T19:35:56.913

问题解决了。这是一个样式表问题。由于某种原因，样式表被加载了两次。这造成了这种奇怪的冲突。

# jquery - 通过选择元素选项加快 jQuery 搜索

> ID：12479219
> 
> 赞同：0
> 
> 时间：2012-09-18T14:36:27.100
> 
> 标签：jquery, html, vbscript

我正在将使用客户端 VBScript 的旧经典 ASP 应用程序升级到使用 jQuery 的更现代的框架。在这种情况下，我的 jQuery 替代品在 IE8 中的运行速度明显比之前的 VBScript 慢。这是我要替换的脚本：

```
Function Find()
  name = Ucase(MyForm.SearchBox.value)
  For x = 0 to MyForm.ComboBox.Length - 1
    If Ucase(Left(MyForm.ComboBox.options(x).text,len(name)))=name Then
      MyForm.ComboBox.options(x).Selected = True
      Exit Function
    End If
  Next
End Function 
```

这是我的替代品：

```
var text = $('#SearchBox').val();
$('#ComboBox option').each(function () {
  if ($(this).text().toUpperCase().indexOf(text.toUpperCase()) == 0) {
    $(this).prop('selected', true);
    return false;
  }
}); 
```

运行 VBScript 完全没有延迟/冻结。用户可以随心所欲地键入并且搜索跟上。在同一台机器上，同样的数据，jQuery解决方案对文本的响应有非常明显的延迟；在搜索发生时，键盘输入似乎被冻结。

该元素是一个包含大约 3,500 个元素`ComboBox`的 HTML 。此方法在搜索框的事件上触发。`select``option``keyup`

**我可以进行哪些优化以使这个 jQuery 运行速度与旧的 VBScript 一样快？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:49:29.483

给你，使用这条线，它应该加快速度：

```
var t = $('#SearchBox').val().toUpperCase();

$('#ComboBox > option[value="' + t + '"]').attr('selected', true); 
```

这是我的 jsFiddle 在测试我的代码以获得这个结果时：

[http://jsfiddle.net/YE3wG/](http://jsfiddle.net/YE3wG/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T16:37:45.130

我最终对排序选项实施了二进制搜索。我猜 jQuery 引擎在 IE8 上的效率不如 VBScript 引擎在这种类型的搜索上。

```
var searchFoo = function(text) {
    var searchFor = text.toUpperCase();
    var options = $('#ComboBox > option');

    var low = 0;
    var mid;
    var high = options.length - 1;
    var target;

    while (low <= high) {
        mid = Math.ceil(low + (high - low) / 2);
        target =
          options.eq(mid).text().toUpperCase().substring(0, searchFor.length);

        if (searchFor < target) {
            high = mid - 1;
        } else if (searchFor > target) {
            low = mid + 1;
        } else {
            // We found an option that matches. We want the *first* option that
            // matches, so search up through the array while they still match.
            while (mid > 0) {
                target =
                  options.eq(mid - 1).text().toUpperCase()
                         .substring(0, searchFor.length);
                if (searchFor == target) {
                    mid--;
                } else {
                    return options.eq(mid);
                }
            }
            return options.eq(mid);
        }
    }

    return null;
} 
```

# javascript - 在子字符串上使用 javascript 拆分

> ID：12479222
> 
> 赞同：-4
> 
> 时间：2012-09-18T14:36:39.657
> 
> 标签：javascript, split

我在 Domino 环境中使用 javascript。

我正在尝试将 HTML 字符串拆分为一个数组以处理其中的特定项目。我要使用的分隔符是结束表行分隔符`</TR>`。我需要一些帮助来弄清楚如何做到这一点。据我所知，大多数示例都在处理单个字符而不是字符组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:40:50.543

从我的 Chrome 控制台：

```
var a = "Hello</tr>There</tr>King";
> undefined
a.split("</tr>");
> ["Hello", "There", "King"] 
```

不区分大小写的版本——警告——丑陋：

```
var a ="Hello</tr>there</TR>King";
> undefined
a.split(/\<\/tr\>/i)
> ["Hello", "there", "King"] 
```

不过，您需要阅读正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:43:16.723

如果有疑问，请查看[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)。

这为您提供了参数`split`并指示其工作方式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:01:17.573

jQuery 也可以提供帮助

```
var $rows = $("#table1 tr"), items=[];
$rows.each(function(i,row) {
  items.push[row.text()];
}); 
```

# php - 什么都不会插入我的数据库

> ID：12479224
> 
> 赞同：2
> 
> 时间：2012-09-18T14:36:41.327
> 
> 标签：php, mysql, html

这是代码：contact_us2.php

```
 <form id="form1" method="post" action="enquires.php">
 <fieldset>
 <legend>Form to database example</legend>
  <label for="text">
      <span>Comments:</span>
    <textarea id="text" name="comments" rows="4" cols="80"></textarea>
      </label>
      <label for="name">
     <span>Name:</span>
      <input id="name" type='text' name='name' size='50'/>
       </label>
      <label for="email">
    <span>Email:</span>
  <input id="email" type='text' name='email' size='50'/>
      </label>

     <label for="submit1" id="submit"><span>&nbsp;</span>
      <input id="submit1" class="submit" type="submit" name="submit" value="Submit"/>
      </label>
     </fieldset>
    </form>

                 enquires.php

                <?php
        session_start();
        error_reporting(E_ALL & ~E_NOTICE);
        require('authenticate.php');
        include_once"../scripts/connect_to_mysql.php";
        $name  = $_post['name'];
        $email = $_post['email'];
        $comments = $_post['comments'];
        echo "$email";
        // Query the body section for the proper page
        mysql_select_db("hardware_cms" )or die (mysql_error());
        $sqlCommand = MYSQL_QUERY("INSERT INTO enquires (id, name, email,      comments)". "VALUES ('NULL', '$name', '$email', '$comments')") or die (mysql_error()); 
        ?> 
```

没有错误。唯一插入到数据库中的是 id。我认为问题出在contact_us2.php。如果这是一个愚蠢的问题，我是 html 和 php 的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:38:38.423

错误在 php 代码中，因为您必须使用 $_POST 而不是 $_post

```
 $name  = $_POST['name'];
 $email = $_POST['email'];
 $comments = $_POST['comments']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:39:11.073

替换`$_post`为`$_POST`，看看会发生什么。

此外，请清理您的 SQL 输入（通过使用 mysql_real_escape_string 或更好 - 通过使用 PDO 准备语句）。

# node.js - Node.js response.write 缓冲区限制限制

> ID：12479227
> 
> 赞同：1
> 
> 时间：2012-09-18T14:36:47.783
> 
> 标签：node.js

我正在使用带有一些附加模块的 nodeJS 来从一组网站中进行网页抓取和媒体项目识别。

节点服务器基本上会返回页面上标识的所有项目及其相关元数据的 JSON 标记。JSON 数据生成正确，因为我可以在服务器日志中看到它，但是当我将其写入客户端时，由于某种原因 JSON 响应被终止。

我使用所有浏览器并使用其他客户端对此进行了测试，这似乎表明 response.write(response, 'utf-8') 可能没有发送整个数据或连接由于某种原因而关闭。

我验证了我的测试用例不涉及分块，因此如果客户端仍在等待下一个数据块，则不会出现连接被客户端主动关闭的问题。即 response.write 在这种情况下返回 true，这意味着所有数据都已写入客户端。

关于什么可能导致连接终止或响应被截断的任何指针？对于较小尺寸的 JSON 响应，客户端会正确接收响应。

```
Code: 
return parseDOM(page, url, function(err, response){
            if(err){
                res.writeHeader(200, {'Content-Type':'application/json'});
                res.end('Error Parsing DOM from ' + url);
                e.message = 'Error Parsing DOM';
                callback(e, req, res, targetUrl);               
                return;
            }
            else {
                if(response){
                    res.writeHeader(200, {'Content-Type':'application/json', 'Content-Length':response.length});
                    console.log(response);
                    res.write(response, 'UTF-8');
                    res.end();
                    callback(null, req, res, targetUrl);
                    return;
                }
            }
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:42:57.500

对不起。我的错。我看到内容长度是错误的。通过问题确定的解决方案： [Node.js 在通过 HTTPS 提供服务时切断文件](https://stackoverflow.com/questions/3905473/node-js-cuts-off-files-when-serving-over-https?rq=1)

# php - 在 Magento 产品上移动自定义选项框

> ID：12479228
> 
> 赞同：0
> 
> 时间：2012-09-18T14:36:56.763
> 
> 标签：php, mysql, database, magento, e-commerce

我需要将我的产品选项移动到我的 Magento 商店中每个产品的产品信息列。要手动执行此操作，我导航到管理产品，选择产品 > 设计 > “显示产品选项”。问题是我有成千上万的产品。

我一直在 Cpanel 中的数据库中搜索，试图找到这个选项存在的位置，以便我可以编写一个查询来为我的整个商店更改它。谁能指出我正确的方向，以便我可以一次为每个产品更改此选项？

谢谢你，我真的很感激任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:25:54.583

我认为导入功能最适合您的需求。创建一个包含**sku**和**options_container**列的 CSV 文件，并插入到后面的列值*container1 中*。使用**导入所有产品**DataFlow 配置文件。应该为您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:00:49.303

您可以从管理面板更改它。转到

*   目录->管理产品

*   选择产品列表。单击操作菜单中的更新属性

*   更改“显示产品选项”的值并保存

# javascript - 自定义选择选项

> ID：12479229
> 
> 赞同：0
> 
> 时间：2012-09-18T14:36:59.480
> 
> 标签：javascript, jquery

我需要使用自定义下拉菜单。我已经搜索了很多自定义组合框实现，但我没有找到符合我要求的组合框，即：我需要组合框侧面的向上/向下箭头。当用户单击其中一个时，值会更改，但不应显示列表。

图形设计与此类似：http: [//jamielottering.github.com/DropKick/](http://jamielottering.github.com/DropKick/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:57:57.917

试试以下

[http://www.htmldrive.net/items/demo/541/jQuery-UI-Spinner-numeric-stepper](http://www.htmldrive.net/items/demo/541/jQuery-UI-Spinner-numeric-stepper)

[http://www.egrappler.com/contents/smartspin/demo/spinner.htm](http://www.egrappler.com/contents/smartspin/demo/spinner.htm)

[http://wiki.jqueryui.com/w/page/12138077/Spinner](http://wiki.jqueryui.com/w/page/12138077/Spinner)

# iphone - 为什么此代码会引发“CoreData：错误：（19）PRIMARY KEY 必须是唯一的”错误？

> ID：12479232
> 
> 赞同：6
> 
> 时间：2012-09-18T14:37:05.740
> 
> 标签：iphone, ios, ipad, core-data

此代码引发“CoreData：错误：（19）PRIMARY KEY 必须是唯一的”错误。该`Day`实体只有一个`when`属性，即一个`NSDate`和一个称为 的一对多关系`tasks`。为什么会出现这个错误？如果`Day`已经存储了具有特定日期的 a，则获取它，否则我将其插入。因此，对于每个 day 对象，都应该有不同的`when`属性。我不确定这是否是主键。如何解决这个问题？先感谢您。

```
 NSMutableSet *occurrences = nil;

   occurrences = ... 
   NSMutableOrderedSet *newSet = [NSMutableOrderedSet orderedSetWithCapacity:[occurrences count]];

   for(NSDate *current in occurrences) {

        NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

        // try to find a corresponding Day entity whose when attribute is equal to the current occurrence
        // if none is available, create it

        Day * day = [[self getDayForDate:current inManagedObjectContext:moc] retain];
        if(!day){
            day = (Day *) [NSEntityDescription insertNewObjectForEntityForName:@"Day" inManagedObjectContext:moc];
        }

        day.when = current;
        [day addTasksObject:aTask];

        [newSet addObject:day];

        [moc insertObject:day];
        [moc processPendingChanges];

        [day release];

        [pool release];            
    } 

- (Day *)getDayForDate:(NSDate *)aDate inManagedObjectContext:(NSManagedObjectContext *)moc
{        
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Day" inManagedObjectContext:moc];
    [request setEntity:entity];
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(when == %@)", aDate];
    [request setPredicate:predicate];
    NSError *error = nil;
    NSArray *array = [moc executeFetchRequest:request error:&error];
    [request release];

    Day *theDay = nil;

    if(array && [array count] == 1){
        theDay = [array objectAtIndex:0];
    }

    return theDay;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-04T22:38:43.653

我最近一直在努力解决`CoreData: error: (19) PRIMARY KEY must be unique`内部 iOS 应用程序的错误，幸运的是经过一两天的研究和代码修改后发现了解决方案，我想在这里分享我的发现，希望它们对其他。

**首先，一点背景**

我们的内部应用程序最初从未使用任何代码来更新其 CoreData 存储 - 相反，当需要在应用程序中显示新数据时，每次应用程序构建迭代时，CoreData SQLite 后备存储文件被简单地替换为新版本已使用基于桌面的标准 SQLite 编辑器进行了编辑——即原始 SQLite 文件已根据需要进行修改和更新。虽然人们认识到这种方法没有考虑到 CoreData 的“黑盒”性质，但实际上在过去几年中，它在我们的简单应用程序中为我们提供了很好的服务，并且该应用程序很高兴地接受了更新后的 SQLite 文件。新的应用程序构建。

然而，最近我们对应用程序进行了重大改造，从通过 Xcode 和应用程序重建来更新应用程序资产和数据的模型转变为通过 Web 服务获取新应用程序数据的模型，而正是在这个新的开发过程中`PRIMARY KEY must be unique`问题出现的工作。

经过几天的努力解决问题，认为新的CoreData实体创建代码（已经检查和重新检查）或其他相关问题一定有问题，通过进一步研究发现我能够使用 Xcode 为我们的应用程序启用 CoreData SQL 调试（按照[这个](https://stackoverflow.com/questions/6428630/xcode4-and-core-data-how-to-enable-sql-debugging)非常有用的 SO 帖子中的说明）。

当我仔细研究 Xcode 中的 SQL 日志时，我可以看到在 CoreData 每次调用`INSERT`SQLite 后备存储中的新记录之前，框架`Z_PRIMARYKEY`使用以下查询查询表，`SELECT Z_MAX FROM Z_PRIMARYKEY WHERE Z_ENT = ?`其中`?`在幕后用相关`Z_ENT`值替换对于相关的 CoreData 实体（您可以`Z_ENT`通过查看表的内容来查看每个 CoreData 实体的值`Z_PRIMARYKEY`）。这就是我终于明白 CoreData 的黑匣子里发生了什么的时候！然后，我在 Mac 上使用 Liya 应用程序仔细查看了我们应用程序的 SQLite 文件，并查看了`Z_PRIMARYKEY`表的内容，果然`Z_MAX`列值都设置为`0`. 当 CoreData 首次为我们的应用程序生成空的 SQLite 后备存储文件时，它们的初始值从未改变过！

我立即意识到出了什么问题，以及为什么 CoreData 报告了主键错误——它实际上与最初怀疑的任何更高级别的 CoreData 实体对象的属性冲突无关，但确实是一个较低级别的错误。直到现在这个错误才真正有意义，它一直存在，只是没有在正确的上下文中被理解。

进一步研究表明，我们的内部团队在过去几年中成功地直接编辑了 SQLite 后备存储，从各种实体表中插入、更新和删除记录，但我们的团队从未进行任何更改到`Z_PRIMARYKEY`桌子上，由于我们的应用程序一直以只读方式使用 CoreData，这从来都不是问题。

但是，现在我们的应用程序正在尝试创建 CoreData 条目并将其保存回 SQLite 后备存储，`INSERT`因此生成的许多查询都失败了，因为 CoreData 无法获得正确的最大主键值来生成任何给定表上的下一个顺序主键，因此`INSERT`查询将失败并出现现在可以理解的有意义的`PRIMARY KEY must be unique`错误！

**解决错误**

我意识到每个开发人员可能会以各种方式为他们的应用程序生成默认/初始 CoreData 内容，但是，如果您曾经在 CoreData 中遇到过这个特定错误并且也很难立即找到明确的答案，我希望以下想法有帮助：

*   我们的应用程序的 CoreData 后备存储是通过直接编辑 SQLite 文件（从实体表中插入、更新和删除记录）手动更新的——这种方法已经工作了很长时间，因为我们一直在以只读方式使用这些数据我们的应用程序。然而，这种方法未能真正认识到 CoreData 的抽象“黑盒”性质以及 SQLite 记录不等同于 CoreData 实体，SQLite 连接不等同于 CoreData 关系等事实。

*   如果您的应用程序使用任何类型的预填充 CoreData 存储，并且如果您以任何方式而不是通过 CoreData 填充 SQLite 后备存储的内容 - 请确保如果您确实在任何 CoreData 实体表中创建新记录，您还确保更新表中的相关记录`Z_PRIMARYKEY`，将列值设置为相关实体表中`Z_MAX`的当前最大值。`Z_PK`

    例如，如果您有一个名为 的 CoreData 实体， 则`Employee`在您的 CoreData SQLite 持久存储支持文件中，这将由一个名为的表表示`ZEMPLOYEE`-除了代表您实体的属性和关系。此实体表还将在表中具有相应的记录，其值为- 因此，当您直接向表中添加新记录时 - 确保在完成添加记录后，您遍历每个实体表并复制最大值值到表的列。您输入的值应该是最大的`Z_PK``Z_ENT``Z_OPT``Z_PRIMARYKEY``Z_NAME``Employee``ZEMPLOYEE``Z_PK``Z_MAX``Z_PRIMARYKEY``Z_MAX``Z_PK`对应表中的值；不要设置`Z_MAX`为等于`Z_PK`+ 1 的值，因为这不是 CoreData 所期望的！

您可以`Z_PK`使用以下 SQL 查询任何实体表的最大值：

```
"SELECT Z_PK FROM ZEMPLOYEE ORDER BY Z_PK DESC LIMIT 1" 
```

这将为您提供表`Z_PK`中任何记录的最大值`ZEMPLOYEE`- 显然您应该替换`ZEMPLOYEE`为应用程序数据模型的相关表名称。

对于我们的应用程序，我能够编写一个简单的命令行脚本直接读取 SQLite 文件，遍历`Z_PRIMARYKEY`表的每条记录并使用正确的`Z_MAX`值更新它。一旦完成，我就可以使用这个更新的文件作为应用程序的持久存储支持文件。现在，当我插入并保存新的 CoreData 实体时，一切都按预期工作。

现在我们的应用程序可以通过 Web 服务直接请求新数据，我们将完全摆脱手动编辑 SQLite 后备存储并专门使用 CoreData 框架来更新数据，但有时或其他应用程序，其中可能需要这种快速简便的数据输入，我希望这个答案可以帮助其他开发人员，并为他们节省我发现这个解决方案所花费的时间和精力。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-19T12:17:46.667

我想如果你已经有了它，你不需要插入一个新`Day`的（当 day 不是 nil 时就是这种情况）。我特别指的是`[moc insertObject:day]`.

如果您使用`insertNewObjectForEntityForName`，该方法会在您保存 moc 时为您插入对象。如果您需要修改它（您已检索到非零日），请修改并保存。此外，我会`processPendingChanges`在循环结束时执行（仅出于性能原因）。

希望有帮助。

# performance - 数据框子集性能

> ID：12479238
> 
> 赞同：6
> 
> 时间：2012-09-18T14:37:30.307
> 
> 标签：performance, r, dataframe, subset

我有几个大数据框（100 万+ 行 x 6-10 列）我需要重复子集。子集部分是我的代码中最慢的部分，我很好奇是否有办法更快地做到这一点。

```
load("https://dl.dropbox.com/u/4131944/Temp/DF_IOSTAT_ALL.rda")
start_in <- strptime("2012-08-20 13:00", "%Y-%m-%d %H:%M")
end_in<- strptime("2012-08-20 17:00", "%Y-%m-%d %H:%M")
system.time(DF_IOSTAT_INT <- DF_IOSTAT_ALL[DF_IOSTAT_ALL$date_stamp >= start_in & DF_IOSTAT_ALL$date_stamp <= end_in,])

> system.time(DF_IOSTAT_INT <- DF_IOSTAT_ALL[DF_IOSTAT_ALL$date_stamp >= start_in & DF_IOSTAT_ALL$date_stamp <= end_in,])
   user  system elapsed 
  16.59    0.00   16.60 

dput(head(DF_IOSTAT_ALL))
structure(list(date_stamp = structure(list(sec = c(14, 24, 34, 
44, 54, 4), min = c(0L, 0L, 0L, 0L, 0L, 1L), hour = c(0L, 0L, 
0L, 0L, 0L, 0L), mday = c(20L, 20L, 20L, 20L, 20L, 20L), mon = c(7L, 
7L, 7L, 7L, 7L, 7L), year = c(112L, 112L, 112L, 112L, 112L, 112L
), wday = c(1L, 1L, 1L, 1L, 1L, 1L), yday = c(232L, 232L, 232L, 
232L, 232L, 232L), isdst = c(1L, 1L, 1L, 1L, 1L, 1L)), .Names = c("sec", 
"min", "hour", "mday", "mon", "year", "wday", "yday", "isdst"
), class = c("POSIXlt", "POSIXt")), cpu = c(0.9, 0.2, 0.2, 0.1, 
0.2, 0.1), rsec_s = c(0, 0, 0, 0, 0, 0), wsec_s = c(0, 3.8, 0, 
0.4, 0.2, 0.2), util_pct = c(0, 0.1, 0, 0, 0, 0), node = c("bda101", 
"bda101", "bda101", "bda101", "bda101", "bda101")), .Names = c("date_stamp", 
"cpu", "rsec_s", "wsec_s", "util_pct", "node"), row.names = c(NA, 
6L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T11:38:20.953

这是我的实验`data.table`。有趣的是，只需转换为即可`data.table`使您的查找速度更快，可能通过更有效地查找逻辑向量来实现。我比较了四件事：原始数据框查找；查找从 POSIXlt 到 POSIXct 的转换（感谢 Matthew Dowle）；数据表查找；除了复制和转换的设置外，还有数据表查找。即使有额外的设置，数据表查找也会获胜。通过多次查找，您将节省更多时间。

```
library(data.table)
library(rbenchmark)
load("DF_IOSTAT_ALL.rda")
DF_IOSTAT_ALL.original <- DF_IOSTAT_ALL

start_in <- strptime("2012-08-20 13:00", "%Y-%m-%d %H:%M")
end_in<- strptime("2012-08-20 17:00", "%Y-%m-%d %H:%M")
#function to test: original
fun <- function() DF_IOSTAT_INT <<- DF_IOSTAT_ALL.original[DF_IOSTAT_ALL.original$date_stamp >= start_in & DF_IOSTAT_ALL.original$date_stamp <= end_in,]
#function to test: changing to POSIXct
DF_IOSTAT_ALL.ct <- within(DF_IOSTAT_ALL.original,date_stamp <- as.POSIXct(date_stamp))
fun.ct <- function() DF_IOSTAT_INT <<- DF_IOSTAT_ALL.ct[with(DF_IOSTAT_ALL.ct,date_stamp >= start_in & date_stamp <= end_in),]
#function to test: with data.table and POSIXct
DF_IOSTAT_ALL.dt <- as.data.table(DF_IOSTAT_ALL.ct);
fun.dt <- function() DF_IOSTAT_INT <<- DF_IOSTAT_ALL.dt[date_stamp >= start_in & date_stamp <= end_in,]
#function to test: with data table and POSIXct, with setup steps
newfun <- function() {
    DF_IOSTAT_ALL <- DF_IOSTAT_ALL.original;
    #data.table doesn't play well with POSIXlt, so convert to POSIXct
    DF_IOSTAT_ALL$date_stamp <- as.POSIXct(DF_IOSTAT_ALL$date_stamp);
    DF_IOSTAT_ALL <- data.table(DF_IOSTAT_ALL);
    DF_IOSTAT_INT <<- DF_IOSTAT_ALL[date_stamp >= start_in & date_stamp <= end_in,];
}
benchmark(fun(), fun.ct(), fun.dt(), newfun(), replications=3,order="relative")

#      test replications elapsed   relative user.self sys.self user.child sys.child
#3 fun.dt()            3    0.18   1.000000      0.11     0.08         NA        NA
#2 fun.ct()            3    0.52   2.888889      0.44     0.08         NA        NA
#4 newfun()            3   35.49 197.166667     34.88     0.58         NA        NA
#1    fun()            3   66.68 370.444444     66.42     0.15         NA        NA 
```

如果您事先知道您的时间间隔是多少，您可以通过使用`findInterval`or拆分`cut`并键入/索引表来使其更快。

```
DF_IOSTAT_ALL <- copy(DF_IOSTAT_ALL.new)
time.breaks <- strptime.d("2012-08-19 19:00:00") + 0:178 * 60 * 60 #by hour
DF_IOSTAT_ALL[,interval := findInterval(date_stamp,time.breaks)]
setkey(DF_IOSTAT_ALL,interval)

start_in <- time.breaks[60]
end_in <- time.breaks[61]
benchmark(a <- DF_IOSTAT_ALL[J(60)],b <- fun2(DF_IOSTAT_ALL))
#                  test replications elapsed relative user.self sys.self user.child sys.child
#1 DF_IOSTAT_ALL[J(60)]          100    0.78 1.000000      0.64     0.14         NA        NA
#2  fun2(DF_IOSTAT_ALL)          100    6.69 8.576923      5.76     0.91         NA        NA
all.equal(a,b[,.SD,.SDcols=c(12,1:11,13)]) #test for equality (rearranging columns to match)
#TRUE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:36:16.293

我会为此使用 xts。唯一潜在的问题是 xts 是一个具有有序索引属性的矩阵，因此您不能像在 data.frame 中那样混合类型。

如果节点列是不变的，则可以将其从 xts 对象中排除：

```
library(xts)
x <- xts(DF_IOSTAT_ALL[,2:5], as.POSIXct(DF_IOSTAT_ALL$date_stamp))
x["2012-08-20 00:00:24/2012-08-20 00:00:54"] 
```

使用 OP 的实际数据进行更新：

```
Data <- DF_IOSTAT_ALL
# change node from character to numeric,
# so it can exist in the xts object too.
Data$node <- as.numeric(gsub("^bda","",Data$node)
# create the xts object
x <- xts(Data[,-1], as.POSIXct(Data$date_stamp))
# subset one day
system.time(x['2012-08-20 13:00/2012-08-20 17:00'])
#    user  system elapsed 
#       0       0       0
# subset 13:00-17:00 for all days
system.time(x['T13:00/T17:00'])
#    user  system elapsed 
#    2.64    0.00    2.66 
```

# c# - 我应该在 Windows 服务中调用基类的方法吗？

> ID：12479241
> 
> 赞同：14
> 
> 时间：2012-09-18T14:37:48.087
> 
> 标签：c#, .net, service, windows-services

从 派生时`ServiceBase`，我也应该调用基类的方法吗？

```
protected override void OnStart(string[] args)
{
    //
    // The stuff I do when the service starts.
    //

    base.OnStart(args); // Do I need to call this?
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-18T14:54:43.970

简短的回答是肯定的，你应该。

在这种特定情况下，OnStart 方法的基本实现没有做任何重要的事情，但这是一个随时可能更改的实现细节。作为一般做法，您应该始终调用基本方法，除非您有充分的理由不这样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T14:58:12.697

如果您使用 ILSpy 或类似工具反编译服务库，您将看到 OnStart、OnStop 等什么都不做（至少在 .NET 4.0/4.5 中）。

但是这种行为可能会在一段时间内改变，因此如果您不调用它，在未来的 .NET 版本中可能会出现不需要或无法预料的行为。
我认为调用这些 base.OnEvent()-Methods 是一个好习惯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:54:22.503

我认为我在编写服务时从未调用过 base.OnStart。

但是，如果您*这样做*，请始终让基类调用您方法的*第一*行，*而不是*最后一行！

# wolfram-mathematica - Matematica If 语句

> ID：12479242
> 
> 赞同：1
> 
> 时间：2012-09-18T14:37:49.843
> 
> 标签：wolfram-mathematica

在 Mathematica 中，我使用以下代码：

```
If[ x [[1]] <= 4 && x [[2]] <= 4, "True","False"]
True 
```

这是我感到困惑的地方：

```
If[ True, count=count + 1, count=count] 
```

我不知道如何从代码之前的行中获取答案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:19:49.573

为什么不只是

```
If[ x [[1]] <= 4 && x [[2]] <= 4, count++] 
```

?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T22:48:01.097

除了贝利撒留的回答之外，您还可以考虑：

```
count += Boole[x[[1]] <= 4 && x[[2]] <= 4] 
```

另外，您说：“我不知道如何从代码之前的行中获取答案。”

你可以使用`%`：

```
If[ x [[1]] <= 4 && x [[2]] <= 4, True, False];

If[%, count=count + 1, count=count] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:27:16.707

Literally you could just fit one piece of code inside the other:

```
If[ 
   If[ x [[1]] <= 4 && x [[2]] <= 4, True, False],
   count=count + 1, count=count
] 
```

Note that the strings `"True"` and `"False"` have been replaced with their logical values `True` and `False`

# tsql - 嵌套的 SELECT 语句以我不理解的方式交互

> ID：12479244
> 
> 赞同：4
> 
> 时间：2012-09-18T14:37:55.663
> 
> 标签：tsql

我以为我理解了如何`SELECT`从另一个`SELECT`语句的结果中做一个，但似乎有某种我不理解的范围模糊。我正在使用 SQL Server 2008R2。

用一个例子来解释是最容易的。

创建具有单个 nvarchar 列的表 - 使用单个文本值和几个数字加载表：

```
CREATE TABLE #temptable( a nvarchar(30) ); 
INSERT INTO #temptable( a )
    VALUES('apple');
INSERT INTO #temptable( a )
    VALUES(1);
INSERT INTO #temptable( a )
    VALUES(2);

select * from #temptable; 
```

这将返回： `apple, 1, 2`

用于`IsNumeric`仅获取可以转换为数字的表格行 - 这将留下文本值`apple`。这工作正常。

```
 select cast(a as int) as NumA
    from #temptable 
    where IsNumeric(a) = 1 ; 
```

这将返回：`1, 2`

但是，如果我使用与内部选择完全相同的查询，并尝试执行数字`WHERE`子句，它会失败说 cannot convert `nvarchar`value 'apple' to data type `int`。它是如何恢复价值“苹果”的？

```
 select 
        x.NumA
    from 
    (
        select cast(a as int) as NumA
        from #temptable 
        where IsNumeric(a) = 1 
    ) x
    where x.NumA > 1
    ; 
```

请注意，如果没有该`WHERE`子句，失败的查询也可以正常工作：

```
 select 
        x.NumA
    from 
    (
        select cast(a as int) as NumA
        from #temptable 
        where IsNumeric(a) = 1 
    ) x
    ; 
```

我觉得这非常令人惊讶。我没有得到什么？TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T13:46:02.053

你得到这个的原因是公平和简单的。执行查询时，会遵循一些步骤。这是一个解析、代数、优化和编译。在这种情况下，algebrize 部分将获取此查询所需的所有对象。优化将使用这些对象来创建将被编译和执行的最佳查询计划......

因此，当您查看该部分时，您会看到它将对#temptable 进行表扫描。#temptable 被定义为您创建表的方式。您将对其进行一些计算是另一回事.....该列仍然具有 nvarchar 数据类型..

要知道这是如何工作的，您必须知道如何阅读查询。首先检索所有对象（从表，内部连接表），然后是谓词（where，on），然后是分组等，然后是选择列（使用强制转换），然后是 orderby。

因此，考虑到这一点，当您有选择的组合时，优化器仍会以这种方式处理它。由于您的选择从属于查询的 from 和 join 部分，这将是出现此错误的原因。

我希望我说清楚一点？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-09T13:28:03.950

优化器可以在查询计划中自由移动表达式，以便生成最具成本效益的数据检索计划（不保证谓词的评估顺序）。我认为使用像下面这样的 case 表达式会在没有 ELSE 子句的情况下产生 NULL 并因此将 APPLE 取出

select a from #temptable where case when isumeric(a) = 1 then a end > 1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:15:33.800

如果您查看估计的执行计划，您会发现它已将内部查询优化为外部查询并组合了`WHERE`子句。

使用 CTE 隔离操作工作（在 SQL Server 2008 R2 中）：

```
declare @temptable as table ( a nvarchar(30) );  
INSERT INTO @temptable( a ) 
    VALUES ('apple'), ('1'), ('2'); 

with Numbers as (    
  select cast(a as int) as NumA 
    from @temptable  
      where IsNumeric(a) = 1  
  )
  select * from Numbers 
```

# windows - 在dos中为dir命令设置递归深度

> ID：12479250
> 
> 赞同：17
> 
> 时间：2012-09-18T14:38:24.927
> 
> 标签：windows, recursion, cmd, directory, directory-structure

我目前正在使用以下命令列出一些目录：

```
dir /b /s /AD > c:\temp\dir_list.txt 
```

这给了我几乎我需要的清单。但是数据太多了，因为有些文件夹有很多子文件夹，我不想在我的列表中看到。

是否可以将命令的递归深度限制为 -let say- 3？

```
c:\dir_1\dir_2\dir_3\dir_foo 
```

因此，如果我在 c:> 中执行上述示例中的命令，我不想看到 dir_foo 目录，而只想看到 dir_n 目录...

也许没有批处理/vb 脚本？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-18T16:15:35.510

我确信可以编写一个列出 n 级目录的复杂命令。但是很难记住语法并且容易出错。每次您想要更改级别数时，它也需要更改。

使用简单的脚本要好得多。

***5 年后编辑*** *- 实际上，自 Vista 以来就有一个简单的班轮可用。[请参阅我的新 ROBOCOPY 解决方案。](https://stackoverflow.com/a/42559986/1012053)*

这是一个执行深度优先列表的批处理解决方案。DIR /S 命令执行广度优先列表，但我更喜欢这种深度优先格式。

```
@echo off
setlocal
set currentLevel=0
set maxLevel=%2
if not defined maxLevel set maxLevel=1

:procFolder
pushd %1 2>nul || exit /b
if %currentLevel% lss %maxLevel% (
  for /d %%F in (*) do (
    echo %%~fF
    set /a currentLevel+=1
    call :procFolder "%%F"
    set /a currentLevel-=1
  )
)
popd 
```

广度优先版本几乎相同，只是它需要一个额外的 FOR 循环。

```
@echo off
setlocal
set currentLevel=0
set maxLevel=%2
if not defined maxLevel set maxLevel=1

:procFolder
pushd %1 2>nul || exit /b
if %currentLevel% lss %maxLevel% (
  for /d %%F in (*) do echo %%~fF
  for /d %%F in (*) do (
    set /a currentLevel+=1
    call :procFolder "%%F"
    set /a currentLevel-=1
  )
)
popd 
```

两个脚本都需要两个参数：

arg1 = 要列出的根目录的路径

arg2 = 要列出的级别数。

因此，要列出当前目录的 3 个级别，您可以使用

```
listDirs.bat . 3 
```

要列出不同目录的 5 个级别，您可以使用

```
listDirs.bat "d:\my folder\" 5 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-03-02T15:52:38.717

经过这么长时间（5 年），我刚刚偶然发现了一个简单的命令行，它一直可用。`ROBOCOPY`自 Vista 以来一直是标准的 Windows 实用程序，可通过 Windows 资源工具包在 XP 中使用。

```
robocopy . . /l /s /njh /njs /ns /lev:4 >c:\temp\dir_list.txt 
```

## 解释

```
 /L :: List only - don't copy, timestamp or delete any files.
    /S :: copy Subdirectories, but not empty ones.
  /NJH :: No Job Header.
  /NJS :: No Job Summary.
   /NS :: No Size - don't log file sizes.
/LEV:n :: only copy the top n LEVels of the source directory tree. 
```

该`/lev:n`选项在计数中包含根目录，并且您需要 3 个子目录级别，这就是我将值加 1 的原因。

## 进一步处理

输出并不完美，因为根文件夹包含在输出中，并且每个路径都包含固定宽度的前导空格。您可以使用 . 方便地消除根路径以及前导空格`FOR /F`。

```
(for /f "skip=2 tokens=*" %A in ('robocopy . . /l /s /njh /njs /ns /lev:4') do @echo %A) >c:\temp\dir_list.txt 
```

`ROBOCOPY`输出包括一个初始空白行，这就是为什么必须`skip`是 2 而不是 1。

每条路径都以`\`. 我喜欢这个功能，因为它很明显我们列出的是文件夹而不是文件。如果你真的想消除尾随`\`，那么你可以添加一个额外的`FOR`。

```
(for /f "skip=2 tokens=*" %A in ('robocopy . . /l /s /njh /njs /ns /lev:4') do @for %B in ("%A.") do @echo %~fB) >c:\temp\dir_list.txt 
```

但是这个命令输入起来有点笨拙。将这种技术合并到以根路径和级别作为参数的实用程序批处理文件中应该很容易。如果将命令放在批处理脚本中，则必须记住将百分比加倍。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-01-15T13:03:26.890

这是一个基于@dbenham 的深度优先列表解决方案的解决方案，
并且还可以设置**最低级别**。

```
@echo off
setlocal
set currentLevel=0
set maxLevel=%2
if not defined maxLevel set maxLevel=1
set minLevel=%3
if not defined minLevel set minLevel=0

:procFolder
pushd %1 2>nul || exit /b
if %currentLevel% lss %maxLevel% (
  for /d %%F in (*) do (
    if %currentLevel% geq %minLevel% echo %%~FF
    set /a currentLevel+=1
    call :procFolder "%%F"
    set /a currentLevel-=1
  )
)
popd 
```

要设置最低级别，只需将其作为第三个参数提供。
例如：要从第 2 级列出到第 5 级，您可以使用

```
listDirs.bat target_path 5 2 
```

或者，您可以通过将此参数留空来从基本级别列出

```
listDirs.bat target_path 5 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-03T10:54:50.430

这是对 dbenham（和 elady）解决方案的一点改进。它根据深度缩进输出。 **它显着增加了可读性**。

```
@echo off
setlocal
set currentLevel=0
set maxLevel=%2
if not defined maxLevel set maxLevel=1
set minLevel=%3
if not defined minLevel set minLevel=0

:procFolder
pushd %1 2>nul || exit /b
set "indent=."
if %currentLevel% lss %maxLevel% (
  for /d %%F in (*) do (
    for /l %%i in (1,1,%currentLevel%) do echo|set /p=%indent%
    if %currentLevel% geq %minLevel% echo %%~fF
    set /a currentLevel+=1
    call :procFolder "%%F"
    set /a currentLevel-=1
  )
)
popd 
```

可以在中设置缩进字符`set "indent ...`

# ruby-on-rails - rails authenticate_or_request_with_http_basic

> ID：12479251
> 
> 赞同：4
> 
> 时间：2012-09-18T14:38:26.897
> 
> 标签：ruby-on-rails, authentication, basic-authentication

在我的 RoR 应用程序中，我需要使用基本身份验证来保护页面，并且我希望每次用户链接到该页面时都会询问凭据。

所以我在操作之前添加了一个过滤器，如下所示：

```
before_filter :request_confirm, :only => [:delete_device] 
```

过滤方法是：

```
def request_confirm

  user = User.find_by_id(session[:user_id])

  authenticate_or_request_with_http_basic do |nick, pass| 
   nick == user.nickname and pass == user.password 
  end

end 
```

没关系，但只是第一次，因为 rails 保存插入的数据，所以接下来会执行过滤器但不会询问凭证。

我不知道凭据保存在哪里。.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T13:06:17.723

这就是方法`authenticate_or_request_with_http_basic`以及 HTTP 身份验证的一般工作方式。`authenticate_or_request_with_http_basic`可以改写为：“首先尝试进行身份验证，如果未通过身份验证，则请求身份验证”。该方法的源码如下：

```
def authenticate_or_request_with_http_basic(realm = "Application", &login_procedure)
  authenticate_with_http_basic(&login_procedure) || request_http_basic_authentication(realm)
end 
```

那么会发生什么。当您第一次点击调用此操作的 URL 时，这`authenticate_or_request_with_http_basic`将返回 HTTP 响应 401 Unauthorized。浏览器知道这是一个身份验证请求，并向您显示一个输入用户名和密码的对话框，然后重新发送相同 URL 的请求，但将您的凭据包含在请求标头中。你的过滤器又被命中了，这一次方法`authenticate_or_request_with_http_basic`看到请求中有认证头，授权你成功。并且浏览器将在每个后续请求中将这些身份验证标头发送到该域（直到您关闭浏览器）。

因此，如果您只需要对其进行多次测试，您可以关闭并重新打开浏览器。我相信仅使用这些方法不可能要求对每个请求进行身份验证和身份验证，因为当应用程序从带有 Auth 标头的浏览器获取请求时，它无法判断这是在身份验证请求之后立即请求，还是这些是之前保留的标头。

但这可以通过使用 cookie 或 session 中存储的值以某种方式完成。

# c# - 带有 jQ uery Mobile 的 MVC 4 - Ajax 似乎正在覆盖我准备好的函数

> ID：12479258
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:38:38.250
> 
> 标签：c#, jquery-mobile, asp.net-mvc-4

好的，所以我有一个页面，其中包含一些元素和一些具有 display:none 的 textarea

根据选择元素的值，相应的文本区域通过设置的 onchange 事件变为可见`$('#comment').show()`

该页面是一个带有一些验证的表单，如果用户按下提交并且验证没有通过，表单将重新显示相同的数据和一些错误消息。

现在我遇到的问题是，尽管所有数据都显示，但评论框不存在。我在我的 javascript 中添加了一些警报以查看发生了什么，我看到在我的 $(document).ready(function () 的末尾，评论文本区域正在工作并且显示正常，但之后 ajax 似乎正在重新显示整个页面和评论区域再次隐藏。

```
 $(document).ready(function () {

      if ($('#Scope').val() == "Yellow" || $('#Scope').val() == "Red") {
          showComments("ScopeComment");
      }

      if ($('#Schedule').val() == ("Yellow") || $('#Schedule').val() == "Red") {
          showComments("ScheduleComment");
      }

      if ($('#Financial').val() == "Yellow" || $('#Financial').val() == "Red") {
          showComments("FinancialComment");
      }

      if ($('#Resource').val() == "Yellow" || $('#Resource').val() == "Red") {
          showComments("ResourceComment");
      }

      if ($('#Risk').val() == "Yellow" || $('#Risk').val() == "Red") {
          showComments("RiskComment");
      }

      alert("hello"); -------> At this point I see the alert and behind it all correct text areas are shows, but right after I press "OK" Ajax re-displays the page and my comments all hide
  });

  function showComments(textID) {
      $('#' + textID).show();
  } 
```

Ajax 是否有它自己的“就绪”函数，它在 jq 移动就绪函数之后调用？或者这里发生了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:51:56.933

我不确定这些场景中的哪一个更适合你的情况，所以我会给你两个。

**A. 您正在进行 ajax 调用并手动返回和更新数据**

在这种情况下，您需要在将数据放置到位后，在 ajax 回调期间对 document.ready 进行相同的调用。document.ready 事件仅在您第一次加载页面时调用，后续更新这些字段的 ajax 请求甚至不会触发。他们有自己的事件，例如`complete`和`success`。

**B. 整个页面正在从服务器返回。**

JQuery Mobile 不会加载一个全新的页面，而是进行 ajax 调用来获取页面的内容并将其插入到 DOM 中。这意味着 document.ready 函数只会在您第一次导航到该网站时被调用。您想要的是绑定到 pageshow 事件。前任。

```
 $('#FormPage').live('pageshow', function () {

      if ($('#Scope').val() == "Yellow" || $('#Scope').val() == "Red") {
          showComments("ScopeComment");
      }

      if ($('#Schedule').val() == ("Yellow") || $('#Schedule').val() == "Red") {
          showComments("ScheduleComment");
      }

      if ($('#Financial').val() == "Yellow" || $('#Financial').val() == "Red") {
          showComments("FinancialComment");
      }

      if ($('#Resource').val() == "Yellow" || $('#Resource').val() == "Red") {
          showComments("ResourceComment");
      }

      if ($('#Risk').val() == "Yellow" || $('#Risk').val() == "Red") {
          showComments("RiskComment");
      }

      alert("hello"); -------> At this point I see the alert and behind it all correct text areas are shows, but right after I press "OK" Ajax re-displays the page and my comments all hide
 }); 
```

# iphone - 使用Objective-C类避免编译错误

> ID：12479260
> 
> 赞同：4
> 
> 时间：2012-09-18T14:38:44.187
> 
> 标签：iphone, objective-c, ios, objective-c-category

我今天做了一件有点恶心的事。

我们所有的视图控制器都继承自两个不同的父视图控制器，比如说 XXXViewController 和 YYYViewController。XXXViewController 又继承自`TrackedUIViewController`，这是 Google Analytics SDK 中提供的一个类，因此您的所有视图控制器都可以从它继承并轻松跟踪它们。

然而，YYYViewController 继承自不同类型的视图控制器。啊，这是一段我真的不想更改的开源代码。

这里有什么问题？我们无法跟踪任何 YYYViewController 子项，因为我们无法访问 TrackedViewController 中提供的方法，因为它们是私有的。

我不想修改 Google Analytics SDK 中提供的源代码。那我做了什么？创建一个公开这些方法的类别，只是为了避免编译错误。

这样做的明显缺点是它可能会破坏 GA 源代码更改，但它很容易检测到。

我想知道这样做我可能会面临哪些其他问题，以及你们是否能想到更好的方法。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:10:37.283

你可以在 YYYViewController 的继承链中往上走，依次看看它继承自哪个类。如果是 UIViewController，只需在源代码中将该特定超类更改为 TrackedUIViewController 即可。

更好理解的示例：假设`YYYViewController`继承自`ZZZViewController`，而后者又继承自`UIViewController`。现在您可以将`ZZZViewController`from的超类更改`UIViewController`为`TrackedUIViewController`- 由于`TrackedUIViewController`继承 from `UIViewController`，不会丢失任何功能，但神奇的是您的整个`YYYViewController`类将变得可跟踪。

希望这可以帮助 ：-）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:58:10.753

您已经提到了使用未记录 API 的最大风险：对 API 的更改超出了您的控制范围，并且可能会破坏您的逻辑，例如，如果方法被删除/重命名，或者它们的行为不再符合您的期望。

从纯技术的角度来看，我看不出还有什么问题，因为在 Objective-C 中所有方法都是公共的。只要它们继续存在，您就可以继续调用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:14:00.100

我会说根本问题是过度的子类化。保持视图控制器层次结构浅。使用组合而不是子类化。如果您必须子类化，请确保类提供的功能可以由其子类打开和关闭。

# ajax - 为什么我的 Codeigniter 扩展库函数没有被调用？

> ID：12479261
> 
> 赞同：0
> 
> 时间：2012-09-18T14:38:46.350
> 
> 标签：ajax, session, codeigniter-2

[根据本论坛帖子（ http://codeigniter.com/forums/viewthread/138823/](http://codeigniter.com/forums/viewthread/138823/) ），我扩展了 CI_Session 类以处理 Ajax 调用的 set_flashdata() 问题，但由于某种原因，我的 sess_update() 函数永远不会被调用。我在我的扩展构造函数中放入了一个 log_message() 调用，它确实被调用了。

为什么当我执行 $this->session->sess_update() 时没有调用我的 sess_update() 函数？

会话库已添加到 autoload.php 配置文件中，我的扩展库位于 /application/libraries 中。

```
class MY_Session extends CI_Session 
{

  public function MY_Session()
  {
    log_message('debug', 'MY_Session construct');
    parent::__construct();
  }

/**
* Update an existing session
*
* @access    public
* @return    void
*/
    function sess_update()
    {
       // skip the session update if this is an AJAX call!
       if ( !IS_AJAX )
       {
           log_message('debug', 'NOT an AJAX request');
           parent::sess_update();
       } else {
           log_message('debug', 'AJAX request');
       }
    } 

} 
```

我还将它添加到我的 constants.php 文件中

```
// Define Ajax Request
define('IS_AJAX', isset($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-12T05:50:12.670

我假设它是版本 3。如果是这样，请将 MY_Session.php 放入

```
libraries/Session/MY_Session.php 
```

User_Guide 对大多数问题都有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:40:55.020

将您的课程添加到`application/core`并查看它是否有效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T07:37:45.610

首先，如果你想扩展任何**模型/控制器/加载器基类**等，你应该使用`'MY_'`to来定位你的类。`application/core`

 **其次，这可以给出一个想法：

my_session.php

```
include_once(BASEPATH.'libraries/Session.php');

class MY_Session extends CI_Session{
      public function __construct(){
          parent::__construct(); 
          ....
      }
    ....
} 
```

在您的控制器中：

```
$this->load->library('MY_Session');
$this->my_session->set_userdata() // or sth 
```**

# c++ - Visual Studio 2008 调试可视化矩阵

> ID：12479264
> 
> 赞同：2
> 
> 时间：2012-09-18T14:38:50.977
> 
> 标签：c++, debugging, visual-studio-2008, matrix

我正在构建一个复杂的数学软件，我必须在调试一些创建的 500x700 矩阵时查看。矩阵也不是按顺序填充的，这意味着它们是“随机”填充的，我需要看到这一点。我已经阅读了内存屏幕，我可以看到内存位置及其值，但是对于如此巨大的矩阵，内存窗口对我来说没有用。

所以我的问题是，除了内存窗口之外，还有其他方法可以在 Visual Studio 08 中调试和观察矩阵吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:54:50.613

我用来可视化复杂数据结构的`Dump()`方法是在您的类中创建一个方法，该方法将数据格式化为字符串并返回一个`std::string`. 如果要检查变量，请在调试器中选择它并调用 QuickWatch`Ctrl-Alt-Q`并键入`myVariable.Dump()`。然后，这将向您显示压缩成一行的字符串。如果您然后单击放大镜图标，它将打开一个可以调整大小的文本可视化器窗口。

如果您需要对格式进行更多控制，则使该`Dump()`方法采用 int 来满足您所需的详细程度。

编辑：

好的，这是一个示例，`stringstream`用于组装字符串：[免责声明：我没有尝试编译这个]

```
class Matrix {
public:
  int m_Data[ROWS][COLS];

  ...
  std::string Dump() const {
    std::ostringstream oss;
    for (int r=0;r<ROWS; r++) {
      for (int c=0;c<COLS; c++) {      
        oss << m_Data[r][c] << " ";
      }
      oss << "\n";
    }
    return oss.str();
  }

  void DumpToFile() {
    std::ofstream os("output.txt");
    os << Dump();
  }
}; 
```

Dump() 方法将输出到可以在 QuickWatch 窗口中显示的字符串。如果文本预览太小，那么您可以调用 DumpToFile() 代替它将矩阵写入可以在单独的文本编辑器中查看的文件。关键是 QuickWatch 将评估函数调用（在有限的程度上），因此您可以使用它来调用这些辅助方法。

# mongodb - 如何向 FOSUserBundle:User 添加索引？

> ID：12479271
> 
> 赞同：0
> 
> 时间：2012-09-18T14:39:02.130
> 
> 标签：mongodb, symfony, doctrine, symfony-2.1, fosuserbundle

我注意到 FOSUserBundle 没有创建任何索引。

我们应该像这样创建一个用户文档：

```
use FOS\UserBundle\Document\User as BaseUser;
use Doctrine\ODM\MongoDB\Mapping\Annotations as MongoDB;

/**
 * @MongoDB\Document
 */
class User extends BaseUser
{
    /**
     * @MongoDB\Id(strategy="auto")
     */
    protected $id;

    /*
    public function __construct()
    {
        parent::__construct();
        // your own logic
    }
    */

} 
```

那么如何添加一个索引来表示“电子邮件”字段？我应该只覆盖继承的属性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T10:25:51.523

实际上 FOSUserBundle 确实创建了。你应该跑

> php app\console 学说：mongodb:schema:update

创建它们。默认情况下，有 usernameCanonical 和 emailCanonical 索引。

如果您需要自定义索引，请使用[此方法](http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/indexes.html)：

```
<?php
/**
 * @MongoDB\Document
 * @MongoDB\Indexes({
 *   @MongoDB\Index(keys={"email"="asc"})
 * })
 */
class User extends BaseUser {
  // ... 
```

并且不要忘记再次运行*doctirne:mongodb:schema:update*任务。

# javascript - javascript将二进制数据发送到Web服务

> ID：12479273
> 
> 赞同：0
> 
> 时间：2012-09-18T14:39:10.320
> 
> 标签：javascript, web-services, html, filereader

在工作中，我们正在尝试使用浏览器端的 html 5/javascript 和 Web 服务中的 C# 将文件从网页上传到 Web 服务。但是对某种编码有一些麻烦。

至于 javascript，我们在 FileReader 的帮助下获取文件的二进制数据。

```
var file = ... // gets the file from an input
var fileReader = new FileReader();
fileReader.onload = dataRecieved;
fileReader.readAsBinaryString(file);

function dataRecieved() {
  // Here we do a normal jquery ajax post with the file data (fileReader.result).
} 
```

我们手动发布数据而不是借助 XmlHttpRequest（或类似的）的帮助是为了更轻松地从网页的不同部分（它包含在一个函数中）整体发布到我们的 Web 服务。但这似乎不是问题。

Web Service 中的代码如下所示

```
[WebMethod]
public string SaveFileValueFieldValue(string value)
{
  System.Text.UnicodeEncoding encoder = new UnicodeEncoding();
  byte[] bytes = encoder.GetBytes(value);
  // Saves file from bytes here...
} 
```

一切正常，数据似乎正常，但是当试图打开一个文件（以图像为例）时，它无法打开。非常基本的文本文件似乎没问题。但是，如果我上传一个像图像一样的“二进制”文件，然后在普通文本编辑器中作为记事本打开原始版本和上传版本，看看有什么不同，似乎只有几个“不可见”字符和一些东西是错误的从开头开始显示几个字节的新行。

所以基本上，该文件似乎在转换中的某个地方只对几个字节进行了错误的编码。

我还尝试在 javascript 中从数据创建一个 int 数组，然后在 Web 服务中再次转换为 byte[]，但问题完全相同。如果我尝试使用除 unicode 之外的任何其他内容（如 UTF-8）进行转换，则数据结果与原始数据完全不同，所以我认为 om 在这里是正确的，但有些地方有点错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:58:23.360

请求本身是文本，因此如果您发送错误的编码类型，二进制数据就会丢失。您可以做的是将二进制编码为 base64 并在另一端对其进行解码。
要将 enc-type 更改为 multi-part/mixed 并设置边界（就像电子邮件或其他东西），您必须自己组装请求。

# java - 循环显示最后一个日期值

> ID：12479280
> 
> 赞同：0
> 
> 时间：2012-09-18T14:39:34.133
> 
> 标签：java, android, date, loops, calendar

我有一个日历应用程序。我想遍历当前月份以获取所有事件。唯一的问题是所有事件的最后一个事件的日期显示。

似乎所有事件的日期值都替换为最后一个事件的日期值。

```
 CalendarEvents events = new CalendarEvents();
   final ArrayList<Event> e = new ArrayList<Event>();

    for(int i = 0; i < _calendar.getActualMaximum(Calendar.DAY_OF_MONTH); i++){
        if(isHoliday(i, month, year, date_value))
        {
            String date = i + "-" + month + "-" + year;

            e.addAll(events.eventDetails(month, day));
            summary_data = new Summary[e.size()];

            for (int j = 0; j < e.size(); j++)
            {

               Event event = e.get(j);
               summary_data[j] = new Summary(date, event.eventdetails);
            } 
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:03:17.900

是的，考虑到程序的逻辑，这是意料之中的。

你循环往复。对于每一天，您将当天的事件添加到事件列表（命名错误的`e`列表）中。对于每一天，您循环遍历此列表中的每个事件（因此包含从月初到当天的所有事件），并创建一个`Summary`实例数组，每个摘要包含当天的日期，以及事件的详细信息（无论是过去的事件还是当天的事件）。

事件列表似乎没有用。我会简单地使用一个摘要列表：

```
final List<Summary> summaries = new ArrayList<Summary>();

// loop through the days
for (int i = 0; i < calendar.getActualMaximum(Calendar.DAY_OF_MONTH); i++) {
    if (isHoliday(i, month, year, date_value)) {
        String date = i + "-" + month + "-" + year;
        // loop through the events of the day
        for (Event event : events.eventDetails(month, day)) {
            // add a summary for the current day and the current event of the day
            summaries.add(new Summary(date, event.eventdetails));
        } 
    }
} 
```

# python - 关于 Josephus_problem

> ID：12479282
> 
> 赞同：4
> 
> 时间：2012-09-18T14:39:37.240
> 
> 标签：python, algorithm, list, josephus

我正在尝试解决[约瑟夫斯问题](http://en.wikipedia.org/wiki/Josephus_problem)，并且我有工作代码。

```
def J(n,x):
    li=range(1,n+1)
    k = -1
    while li:
        print li
        k = (k+x) % len(li)
        li.pop(k)
        k =k- 1
J(10, 3) 
```

现在我想重写它以获得如下结果：

```
1 1 1 1 1 1 1 1 1 1
1 1 0 1 1 1 1 1 1 1
1 1 0 1 1 0 1 1 1 1
1 1 0 1 1 0 1 1 0 1
1 0 0 1 1 0 1 1 0 1
1 0 0 1 1 0 0 1 0 1
0 0 0 1 1 0 0 1 0 1
0 0 0 1 1 0 0 0 0 1
0 0 0 1 0 0 0 0 0 1
0 0 0 1 0 0 0 0 0 0 
```

* * *

我怎样才能做到这一点？

```
def J(n,x):
    li=[1]*10
    k = -1
    while li.count(1)>0:
        print li
        k = (k+x) % len(li)
        li[k]=0
        k =k- 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T14:44:47.500

```
>>> def J(n,x):
    li=range(1,n+1)
    k = -1
    while li:
        for i in xrange(1,n+1):
        if i in li:
            print 1,
        else:
            print 0,
    print
        k = (k+x) % len(li)
        li.pop(k)
        k =k- 1

>>> J(10, 3)
1 1 1 1 1 1 1 1 1 1
1 1 0 1 1 1 1 1 1 1
1 1 0 1 1 0 1 1 1 1
1 1 0 1 1 0 1 1 0 1
1 0 0 1 1 0 1 1 0 1
1 0 0 1 1 0 0 1 0 1
0 0 0 1 1 0 0 1 0 1
0 0 0 1 1 0 0 0 0 1
0 0 0 1 0 0 0 0 0 1
0 0 0 1 0 0 0 0 0 0 
```

更好（单线替换你的`print li`）：

```
>>> def J(n,x):
    li=range(1,n+1)
    k = -1
    while li:
        print [1 if i in li else 0 for i in xrange(1,n+1)]
        k = (k+x) % len(li)
        li.pop(k)
        k =k- 1

>>> J(10, 3)
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 0, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 0, 1, 1, 0, 1, 1, 1, 1]
[1, 1, 0, 1, 1, 0, 1, 1, 0, 1]
[1, 0, 0, 1, 1, 0, 1, 1, 0, 1]
[1, 0, 0, 1, 1, 0, 0, 1, 0, 1]
[0, 0, 0, 1, 1, 0, 0, 1, 0, 1]
[0, 0, 0, 1, 1, 0, 0, 0, 0, 1]
[0, 0, 0, 1, 0, 0, 0, 0, 0, 1]
[0, 0, 0, 1, 0, 0, 0, 0, 0, 0] 
```

您甚至可以使用`print ' '.join(['1' if i in li else '0' for i in xrange(1,n+1)])`来获得您想要的输出:-)

# .net - 当应用程序安装在 Program Files 中时加密 App.config 文件

> ID：12479283
> 
> 赞同：0
> 
> 时间：2012-09-18T14:39:39.047
> 
> 标签：.net, encryption, connection-string, app-config

如果 app.config 中的连接字符串被加密并且应用程序安装在 Program Files 中，我有一个应用程序将无法运行。连接字符串部分被加密为构建后事件，因此它已被加密部署。我知道安装在 Program Files 中的应用程序可以做什么是有限制的，但我不明白为什么这是限制之一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:49:29.633

我怀疑它更多地与与*执行*应用程序的进程相关联的身份所暗示的权限有关，例如对密钥存储的权限或 app.config 文件本身。

根据@JulienLebosquain 的观察，如果您已将加密配置为*构建*后事件，则将使用特定于机器的密钥来执行加密，从而使其在任何*其他*机器上都无法恢复。要在 app.config 文件上完成安装后加密，您必须考虑构建一个安装项目并向您的应用程序添加一个安装程序类，该类定义一个基于主机密钥执行加密的安装后事件。

# c# - 将 Osmdroid 移植到 Monodroid（解决错误和智能感知）

> ID：12479289
> 
> 赞同：0
> 
> 时间：2012-09-18T14:39:50.583
> 
> 标签：c#, xamarin.android, porting, osmdroid

我正在将 jar 库从 Osmdroid 移植到 Mono for Android (C#)。目前一切似乎都正常。我移植了库并将 Binding-Project 包含到我的 Testproject 中，以便测试正确的移植。

我可以访问 osm 库，但在 MonoDevelop 中，所有引用都用红色书写，标有“解决错误”，因此没有 Intelli-Sense。连“使用 Osm.xy”都用红色写了。

但事实上，这些只是视觉问题。我可以构建项目，并且在模拟器上一切都按计划进行。

有人可以告诉我，我可以做些什么来解决这些问题（尤其是 Intelli-Sense）？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:50:43.050

只想补充一点，我的问题已经解决了。对于在将 OsmDroid 移植到 Monodroid 时遇到问题的每个人，同时有一个将 OsmDroid v3.0.8 绑定到 Monodroid 的教程：

[https://github.com/xamarin/monodroid-samples/tree/master/OsmDroidBindingExample](https://github.com/xamarin/monodroid-samples/tree/master/OsmDroidBindingExample)

# mysql - 开源数据库的常见 SQL 查询列表？

> ID：12479290
> 
> 赞同：5
> 
> 时间：2012-09-18T14:39:51.470
> 
> 标签：mysql, postgresql, relational-database, database-schema, ansi-92

我正在尝试查找有关MySQL、PostgreSQL、SQLite 等开源数据库的正确[RDBMS SQL 查询的信息。](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)他们是否有任何预先组装的列表，或者我只需要梳理每个数据库引擎的文档（*在某些情况下猜测正确的实现？* `ALTER TABLE` vs `CREATE INDEX`）

例如，到目前为止，我有这个 MySQL 的（部分）列表：

```
CREATE TABLE `%s` (...);
DROP TABLE IF EXISTS `%s` %s;
ALTER TABLE `%s` RENAME TO `%s`;

ALTER TABLE `%s` ADD COLUMN %s;
ALTER TABLE `%s` DROP COLUMN `%s` %s;
ALTER TABLE `%s` RENAME COLUMN `%s` to `%s`;

ALTER TABLE `%s` ADD CONSTRAINT `%s` FOREIGN KEY (`%s`) REFERENCES `%s` (`%s`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `%s` ADD CONSTRAINT `%s` UNIQUE (`%s`);
ALTER TABLE `%s` DROP CONSTRAINT `%s` %s;

CREATE INDEX `%s` USING BTREE ON `%s` (`%s`);
DROP INDEX IF EXISTS `%s` %s; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T16:01:26.990

我从来没有见过类似的，但你可以为 ANSI SQL 获得 EBNF

[http://savage.net.au/SQL/](http://savage.net.au/SQL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-13T13:47:53.970

我想到的一个肮脏的技巧是使用像 Hibernate 这样的 O/R 引擎对此进行建模。开发带注释的类或 .hbm.xml 文件，只需打开**hbm2ddl** =auto 并针对您的数据库列表运行它。使用**show_sql**属性记录 hibernate 生成的所有 DML/DDL...

我假设像 hibernate 这样的 O/R 框架已经看到了世界并且可以处理已建立的 RDBMS 平台的所有细微差别。但是，我不确定 hibernate 是否尝试生成尽可能通用或尽可能本地方言的 DDL 脚本。

希望这可以帮助 ;）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T22:39:36.957

您可以查看一些 ActiveRecord 实现以获取线索。他们尝试为查询实现一个公共层。大多数框架都为 SQL 引擎提供了某种抽象。Win 可移植性失去了每个数据库供应商的特殊实现细节。

如果您有时间，可以查看每个数据库文档并创建解析器。对于 Postgresql 数据库，您可以在手册中检查命令结构：[http](http://www.postgresql.org/docs/9.0/static/sql-commands.html) ://www.postgresql.org/docs/9.0/static/sql-commands.html 。

一个小例子的 Postgresql 在表上添加模式名称。默认使用公共架构。

```
CREATE TABLE "%s"."%s" (...); 
```

# .htaccess - .htaccess 文件夹重定向

> ID：12479296
> 
> 赞同：0
> 
> 时间：2012-09-18T14:40:08.657
> 
> 标签：.htaccess

我尝试在我的文件夹中进行重定向：

```
Redirect /promotion/ /newpromotion
Redirect /promotion/first/ /new/first/ 
```

现在如果我尝试打开`http://mysite.com/promotion/first`我打开`http://mysite.com/newpromotion/new/first`但我需要`http://mysite.com/new/first`

我该如何解决？

**UPD：** 这很疯狂，但我做到了：

```
 Redirect /promotion/ /newpromotion
   Redirect /promotion/first/ /new/first/
   Redirect /newpromotion/new/first /new/first/ 
```

**解决方案：** 需要反转2个指令：

```
Redirect /promotion/first /new/first
Redirect /promotion /newpromotion 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:56:18.637

尝试

重定向 /promotion/first/ /new/first/ 重定向 /promotion/ /newpromotion

更详细的应该放在第一位。

- - - 编辑 - - -

试试这个：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /

RewriteRule ^/promotion/first/$ /new/first/ [L]
RewriteRule ^/promotion/$ /newpromotion/ [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T17:55:38.403

`Redirect`指令一起连接到路径节点，所以当你有：

```
Redirect /promotion/ /newpromotion 
```

这意味着**任何** *以 开头*的东西`/promotion/`都会被重定向到`/newpromotion/`. 例如：

*   `/promotion/`->`/newpromotion/`
*   `/promotion/foo.html`->`/newpromotion/foo.html`
*   `/promotion/first/`->`/newpromotion/first/`

您只需要反转 2 个指令：

```
Redirect /promotion/first /new/first
Redirect /promotion /newpromotion 
```

# javascript - 如何保存选中复选框的整个记录 集

> ID：12479297
> 
> 赞同：0
> 
> 时间：2012-09-18T14:40:08.240
> 
> 标签：javascript, asp-classic

我有一个表格，用于跟踪每个员工的工作进度。由于一名员工一天可以完成许多任务。因此，为了节省工作时间，我为任务创建了复选框，以便我可以一次选择并保存为多条记录。我的代码如下

```
<td colspan="2">
        <%
          if rsPdtn_sizeColor.eof then 
             call displayNotFoundRecord
          Else
             Do Until  rsPdtn_sizeColor.Eof
        %>             
    <div style="width:120px; float:left"><input type="checkbox" name="pdtn_szcl_id" value="<%=rsPdtn_sizeColor.fields.item("pdtn_szcl_id")%>">&nbsp;<%=rsPdtn_sizeColor.fields.item("pdtn_st_size")%> &nbsp;&nbsp;<%=rsPdtn_sizeColor.fields.item("pdtn_st_color")%></div>
    <div style="width:50px; float:left"><input type="text" name="pdtn_qty" value="<%=rsPdtn_sizeColor.fields.item("pdtn_st_qty_est")%>" size="7"></div>
    </div>
    <div style="clear:both"></div>
        <%                                                                  
             rsPdtn_sizeColor.movenext
             Loop
           End if                   

        rsPdtn_sizeColor.movefirst                              
        %>

</td>
<td><input name="pdtn_note" value="<%=pdtn_note%>" size="39"></td> 
```

但是，使用此代码，只有字段“pdtn_szcl_id”可以仅传递我检查的记录集。我希望“pdtn_qty”也能这样做。所以你能帮我解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:41:06.020

问题是你不应该有像输入一样的表单元素有重复的名字。有几种可能的解决方案，但这可能是最安全的。

在您的代码中，将数据库 ID 添加到复选框和数量文本框的名称中，如下所示：

```
<div style="width:120px; float:left"><input type="checkbox" name="pdtn_szcl_id_<%=rsPdtn_sizeColor.fields.item("pdtn_szcl_id")%>">&nbsp;<%=rsPdtn_sizeColor.fields.item("pdtn_st_size")%> &nbsp;&nbsp;<%=rsPdtn_sizeColor.fields.item("pdtn_st_color")%></div> 
<div style="width:50px; float:left"><input type="text" name="pdtn_qty_<%=rsPdtn_sizeColor.fields.item("pdtn_szcl_id")%>" value="<%=rsPdtn_sizeColor.fields.item("pdtn_st_qty_est")%>" size="7"></div> 
```

然后，当您要检索值时，您需要再次打开记录集并循环检查复选框是否已被选中并获取值，如下所示：

```
<%
'Open your rsPdtn_sizeColor recordset again
Do Until rsPdtn_sizeColor.Eof
    If Request.Form("pdtn_szcl_id_" & rsPdtn_sizeColor.fields.item("pdtn_szcl_id")) = "on" Then
         'This checkbox was checked
         id = rsPdtn_sizeColor.fields.item("pdtn_szcl_id")
         qty = Request.Form("pdtn_qty_" & rsPdtn_sizeColor.fields.item("pdtn_szcl_id"))
         'This gives you the ID and Qty entered for each row
    End If
    rsPdtn_sizeColor.movenext
Loop
%> 
```

注意。我使用了 Request.Form，但如果您使用表单方法 GET，那么您应该更改为 Request.QueryString。

# android - Android root 设备中的应用程序是否受到威胁？

> ID：12479301
> 
> 赞同：4
> 
> 时间：2012-09-18T14:40:15.983
> 
> 标签：android, rooted-device

我正在开发一个处理敏感数据的应用程序。

该应用程序具有合理的安全模型，包括加密、SSL 和数据不会永久存储在设备上。

我正在尝试确定我的应用程序在 root 设备上运行是否“安全”，或者设备已 root 的事实将使应用程序更容易被利用/破解。所以问题是：处理敏感数据的应用程序应该在有根设备上运行吗？

我已经进行了研究，但我还没有看到任何关于 root 设备安全性的讨论。我知道检测有根设备的方法可能会被规避，因此不支持有根设备有什么意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:51:00.677

根设备上的应用程序最大的安全问题是：

1.  用户可以直接访问您的内部数据
2.  其他应用可以访问您应用的私人数据

你能做的最好的事情是：

1.  以难以进行逆向工程的方式加密您的数据。如果有人在寻找您的数据，您应该假设他们也反编译了您的应用程序。因此，请在服务器上进行所有加密/解密，不要让您的算法等常识
2.  如果您应该将数据存储在设备本身上，请将其设置为晦涩难懂。因此，如果您必须保存整数，请不要保存原始值。使用类似`savedValue = ((((realValue*10)+1)/365*23)*50)+1;`This 使黑客很难编辑您保存的值并获得所需的结果，尽管由于他/她会反编译您的 apk，因此这是一项非常基本的保护措施。
3.  在设备上存储尽可能少的高风险数据。需要时，通过安全连接下载、显示和删除，甚至从 RAM 中删除。此外，将机密数据保留在内存中的时间尽可能短，因为可以读取 RAM 中的未加密数据。
4.  确保您的加密技术不容易被暴力破解。由于其他应用程序也可以在有根设备上访问您的数据，因此您的数据有可能被发送到远程服务器进行解密，并且这样的服务器将比您的手机拥有更多的处理能力

这些只是我能想到的一些建议。我绝不是安全专家，您可能想就此事咨询其中一位专家。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:50:09.370

Android root 设备中的应用程序是否受到威胁？是的，他们是。

即使在非 root 手机上，攻击者仍有可能捕获漏洞并进行 root 控制（GingerBreak 就是其中的一个案例）。因此，即使手机没有被用户植根，也没有 100% 的手机不会受到损害。

正如您所提到的，对 root 的检测不能完全可靠，因为它们可以被绕过。但是，如果您检测到手机已植根，则绝对应该阻止它。如果您没有检测到它，这并不意味着手机没有root，您仍然需要有安全机制来抵御root手机的攻击。

您可能需要应对几种类型的攻击：中间人攻击、键盘记录器、屏幕捕获、用户模式 ​​rootkit、内核模式 rootkit，...

The good news is that there are companies that make libraries for you to protect your apps against such type of attacks. They offer you solution to free yourself from headache as they will care abt it for you. **V-Key** is one of those, you can look at their website and consider if you want to buy their **V-Guard** product.

# php - Symfony 2.1：依赖于另一个实体的动态下拉列表

> ID：12479308
> 
> 赞同：2
> 
> 时间：2012-09-18T14:40:35.317
> 
> 标签：php, forms, symfony

我正在使用 Symfony2，这是我的问题：我有 3 个实体，类别、子类别和文章。一个分类可以有很多子分类，每个子分类可以有很多篇文章。因此，Category 和 SubCategory 之间以及 SubCategory 和 Article 之间存在双向 oneToMany 关系。这种设计是一种约束，我无法改变它。

我必须制作一个用于编辑文章的表单，用户必须在其中选择类别，然后选择文章所属的子类别。

但是，当用户更改类别下拉列表的值时，我找不到如何动态更新子类别列表。子类别下拉列表应该只显示链接到当前类别的子类别。

我已经制作了用于编辑文章的表单类型：

```
class ArticleType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('domain', new SubCategoryPickerType())
            ->add('title')
            ->add('description')
            ->add('content')
        ;
    }

    // ... 
```

然后我开始制作基于 2 个下拉列表获取实体的表单：

```
class DomainPickerType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('category')
            ->add('name', 'entity', array(
                    'class' => 'Htbf\CoreBundle\Entity\SubCategory',
                    'property' => 'name'))
        ;
     // ... 
```

问题是，像这样，2 下拉不相互依赖：当第一个被更改时，第二个不会更新，第二个包含子类别的所有可能性，而不是与当前类别关联的那个。

知道该怎么做吗？提前致谢 ！

# mysql - 数据库设计：自动递增键和更新不一致

> ID：12479309
> 
> 赞同：2
> 
> 时间：2012-09-18T14:40:39.363
> 
> 标签：mysql, database-schema

两个表共享一个唯一标识符“id”。这两个表都打算通过使用“id”来连接。将“id”定义为两个表中的自动递增主键可能会导致更新不一致。

是否有一些通用模式可以避免这种情况，或者我是否必须先使用最后插入的 id 来处理更新 table1 和 table2（因此不在 table2 中将 id 声明为 auto inc）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:44:23.773

在任意数量的表中，相同的列名“id”没有问题。

几个持久层框架以同样的方式做这件事。

只需在您的 SQL 中使用别名来相应地区分您的表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:44:28.833

*我是否必须先通过使用最后插入的 id 来处理更新 table1 和 table2（因此不在 table2 中将 id 声明为 auto inc）？*

是的。并将 id 设为外键，因此如果它已存在于 table1 中，则它只能存在于 table2 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T14:44:29.467

是的，你这样做了，记住将操作包装在事务中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T14:44:42.363

首先，如果您在 MySQL 中使用 InnoDB 表引擎，您可以同时使用事务和外键来实现数据一致性。

其次，在第一个表中插入之后，您可以获得最后一个插入 id（取决于您访问数据库的方式）并将其用作外键。

例如 表 1: `Users`:`user_id, username` 表 2: `User_Profiles`:`user_id, name, phone`

在 User_Profiles 中，您不需要定义为自动增量，但首先在表中`user_id`插入一条记录并使用记录。如果您在事务中执行此操作，则在事务连接完成之前不会在事务连接之外看到记录，这样您就可以保证即使在插入用户之后但在插入配置文件之前发生了一些不好的事情 - 不会t 被弄乱的数据。`Users``user_id``User_Profiles``Users`

您还可以将表中的`user_id`列定义为`User_Profiles`表的外键，`Users`因此如果有人从`Users`表中删除一条记录，数据库将自动删除`User_Profiles`. 还有许多其他选项 - 阅读更多相关信息。

# android - 在没有无限循环的情况下将 TextWatcher 类附加到多个 EditText

> ID：12479310
> 
> 赞同：0
> 
> 时间：2012-09-18T14:40:41.643
> 
> 标签：android, textwatcher

我正在尝试根据以下任何输入来计算此人收到的薪水 - 每小时、每天、每周、每月、每年。当输入其中一个时，应自动重新计算其他的。

这是我如何进行的：

首先，我`Double`在活动顶部定义了 5 个类型变量。它们是：每小时、每天、每周、每月、每年。然后我有 5 个 EditText 字段，对应于这些变量。我已经附加了一个自定义子类来实现`TextWatcher`这 5 个 EditTexts。

例如：

```
etHourly = (EditText) findViewById(R.id.etHourly);
etHourly.addTextChangedListener(new EditTextWatcher(etHourly)); 
```

这个自定义类有一个构造函数，它接受并存储传递给它的视图，因为`TextWatcher`该类的默认方法不提供一种方法来找出哪个视图调用了更改。

将传递的视图保存为自定义子类中的局部变量后，我继续`afterTextChanged`在该子类中实现并获取传递的 EditText 的值并将其保存为`Double`活动顶部的相应定义变量。（例如，如果传递的 EditText 是针对周薪的，我将这个 EditText 的值设置为`weekly`变量的双精度值。

最后，就在`afterTextChanged`方法结束之前，我调用了另一个自定义方法`Recalculate()`，它有一堆`if()`'s 来检查是否设置了每小时、每天、每周、每月或每年，如果是，则计算并`setText()`在剩余的 EditText 上使用。问题是这`setText()`将为这些 EditText 中的每一个调用 TextWatchers，从而导致无限循环。

我该如何克服呢？

这里有一些代码可以更好地理解这一点。在创建之前：

```
Double hourly, daily, weekly, monthly, yearly = 0.0;
EditText etHourly, etDaily, etWeekly, etMonthly, etYearly; 
```

在 onCreate() 内部：

```
etHourly = (EditText) findViewById(R.id.etHourly);
etDaily = (EditText) findViewById(R.id.etDaily);
etWeekly = (EditText) findViewById(R.id.etWeekly);
etMonthly = (EditText) findViewById(R.id.etMonthly);
etYearly = (EditText) findViewById(R.id.etYearly);

etHourly.addTextChangedListener(new EditTextWatcher(etHourly));
etDaily.addTextChangedListener(new EditTextWatcher(etDaily));
etWeekly.addTextChangedListener(new EditTextWatcher(etWeekly));
etMonthly.addTextChangedListener(new EditTextWatcher(etMonthly));
etYearly.addTextChangedListener(new EditTextWatcher(etYearly)); 
```

子类`EditTextWatcher`：

```
private class EditTextWatcher implements TextWatcher {

    EditText v;

    public EditTextWatcher(EditText view) {
        this.v = view;
    }

    public void afterTextChanged(Editable s) {

        Reinit();

        // Only if the currently edited text field contains something
        if (v.getText().toString().length() > 0) {
            switch (v.getId()) {
            case R.id.etHourly:
                hourly = getTvAsDouble(etHourly);
                break;
            case R.id.etDaily:
                daily = getTvAsDouble(etDaily);
                break;
            case R.id.etWeekly:
                weekly = getTvAsDouble(etWeekly);
                break;
            case R.id.etMonthly:
                monthly = getTvAsDouble(etMonthly);
                break;
            case R.id.etYearly:
                yearly = getTvAsDouble(etYearly);
                break;
            default:
            }
        }

        Recalculate();
    }

    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
    }

    public void onTextChanged(CharSequence s, int start, int before,
            int count) {
    }

} 
```

重新初始化（）：

```
hourly = daily = weekly = monthly = yearly = 0.0; 
```

重新计算（）：

```
if(hourly!=null && hourly>0.0){
      etDaily.setText(String.valueOf(hourly*8));
}
// I will complete the other if's once this works 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T18:30:04.047

伴侣！！我也被困在这里......我得到了 StackOverflowError ......但我假设可能是因为我已经多次实例化 TextWatcher ......但是你通过识别问题帮助我，这实际上是 setText( ) ，它无限地调用 TextWatcher 的方法....所以我在这里做了 --- 根据你的代码 --->

```
if(hourly!=null && hourly>0.0){
 if(etHourly.isFocused())   //this condition helped suppressing infinite loops
  etDaily.setText(String.valueOf(hourly*8));} 
```

# php - 如果所有子数组都是特定值，则递归删除子数组

> ID：12479318
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:41:03.690
> 
> 标签：php, arrays, multidimensional-array

我需要删除所有具有 0 值的月份，只有当所有月份都匹配 0 时才必须删除它。

这是我的数组，

```
Array
(
    [0] => Array
        (
            [0] => Month/Year
            [1] => BRO002
            [2] => SPI001
            [3] => TYN001
        )

    [1] => Array
        (
            [0] => Jan
            [1] => 0
            [2] => 0
            [3] => 1
        )

    [2] => Array
        (
            [0] => Feb
            [1] => 0
            [2] => 0
            [3] => 0
        )

    [3] => Array
        (
            [0] => Mar
            [1] => 0
            [2] => 0
            [3] => 0
        )

    [4] => Array
        (
            [0] => Apr
            [1] => 0
            [2] => 0
            [3] => 0
        )

    [5] => Array
        (
            [0] => May
            [1] => 0
            [2] => 3
            [3] => 0
        )

    [6] => Array
        (
            [0] => Jun
            [1] => 0
            [2] => 0
            [3] => 0
        )

    [7] => Array
        (
            [0] => Jul
            [1] => 0
            [2] => 0
            [3] => 0
        )

    [8] => Array
        (
            [0] => Aug
            [1] => 0
            [2] => 0
            [3] => 0
        )

    [9] => Array
        (
            [0] => Sep
            [1] => 11
            [2] => 1
            [3] => 2
        )

    [10] => Array
        (
            [0] => Oct
            [1] => 0
            [2] => 0
            [3] => 0
        )

    [11] => Array
        (
            [0] => Nov
            [1] => 0
            [2] => 0
            [3] => 0
        )

    [12] => Array
        (
            [0] => Dec
            [1] => 0
            [2] => 0
            [3] => 0
        )

) 
```

上面的数组将变成以下，

```
Array
(
    [0] => Array
        (
            [0] => Month/Year
            [1] => BRO002
            [2] => SPI001
            [3] => TYN001
        )

    [1] => Array
        (
            [0] => Jan
            [1] => 0
            [2] => 0
            [3] => 1
        )

    [5] => Array
        (
            [0] => May
            [1] => 0
            [2] => 3
            [3] => 0
        )

    [9] => Array
        (
            [0] => Sep
            [1] => 11
            [2] => 1
            [3] => 2
        )

) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:50:24.827

检查每个值：

```
$newArray = array();
foreach($array as $key => $val){
    if(!(!$val[1] && !$val[2] && !$val[3])) {
        $newArray[$key] = $array[$key];
    }
}

print_r($newArray); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:50:45.360

```
$Temp = array();

foreach ($Array as $Key=>$Value) 
  if ($Value[1]!=0 || $Value[2]!=0 || $Value[3]!=0)
    $Temp[$Key] = $Value;

$Array = $Temp; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:59:01.207

```
$array = array(
    array('Jan', 0, 0, 1), 
    array('Feb', 0, 1, 0), 
    array('Mar', 0, 0, 0), 
    array('Apr', 1, 1, 1)
);

foreach($array as $i => $a) {
    $save = false;
    foreach($a as $k => $v) {
        if($k == 0) continue; 
        if($v != 0) $save = true; 
    }
    if(!$save) unset($array[$i]);
}

var_dump(array_values($array)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T14:59:22.610

不需要第二个数据结构：

```
foreach ( $data as $i => $month ) {
  if ( $i == 0 ) { continue; }
  if (
    $month[1] == 0 &&
    $month[2] == 0 &&
    $month[3] == 0 
  ) {
    unset($data[$i]);
  } 
} 
```

# sql - 有效地存储和检索大量汇总数据用于报告

> ID：12479319
> 
> 赞同：0
> 
> 时间：2012-09-18T14:41:17.630
> 
> 标签：sql, database, nosql, reporting

问题如下。我们实时收集一些数据，比如说每秒 100 个条目。我们希望有实时报告。报告应按小时显示数据。我们要做的就是创建一些传入数据的总和并进行一些智能索引，以便我们可以轻松地提供查询，例如“给我 value2 for featureA = x, and featureB = y, for 2012-01-01 09:00 - 10:00"

为了避免过多的 I/O 操作，我们在内存中聚合数据（这意味着我们将它们相加），然后将它们刷新到数据库中。假设它每 10 秒左右发生一次，这对于我们的实时报告来说是可以接受的延迟。

所以基本上，用 SQL 术语来说，我们最终会得到 20 个（或更多）这样的表（好吧，我们可以通过组合 sum 来减少它们，但这并没有太大区别）：

1.  时间、特征A、特征B、特征C、值1、值2、值3
2.  时间、特征A、特征D、值4、值5
3.  时间、特征C、特征E、值6、值7
4.  等等

（我并不是说解决方案必须是 SQL，我只是为了解释手头的问题。） Time 列是时间戳（具有小时精度），Feature 列是系统实体的一些 id，值是整数值（算）。

所以现在问题来了。由于数据的本质，即使我们聚合它们，这些聚合表仍然有（太多）插入。这是因为一些数据是稀疏的，这意味着对于每 100 个条目，我们在某些聚合表中有 50 个条目。我知道我们可以通过升级硬件来继续前进，但我觉得我们可以通过更智能的存储机制做得更好。例如，我们可以使用 SQL 数据库，但我们不需要它的大部分功能（事务、连接等）。

因此，鉴于这种情况，我的问题如下。你们如何处理大流量的实时报告？谷歌以某种方式为网络分析做到了这一点，所以这毕竟是可能的。这里有什么秘密武器吗？我们对任何解决方案持开放态度——无论是 Hadoop & Co、NoSQL、集群还是其他任何解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:29:55.887

除了拆分收集和报告/分析的存储需求外，我们过去经常做的一件事是查看值发生重大变化的频率，以及如何使用数据。

不知道您的数据是什么样的，但报告和分析通常会寻找重要的模式。以容不下，反之亦然，尤其是振荡。现在，虽然收集“无限”数量的数据以防万一您想分析它可能是值得称赞的，但当您遇到实施的有限限制时，必须做出选择。

我在制造环境中做过这种事情。我们有两个层次的分析。一种用于控制粒度尽可能高的地方。然后随着过去数据的进一步增长，我们将其汇总以进行报告。

我遇到过你似乎不止几次的问题，虽然数据丢失令人遗憾，但关于它会花费多少的抱怨声要响亮得多。

所以我不会从简单的技术角度来看这个问题，而是从实际的商业角度来看。从企业认为自己能负担得起多少开始，看看你能为他们付出多少。

# ios - 设备令牌在开发中注册良好，但不是生产

> ID：12479323
> 
> 赞同：5
> 
> 时间：2012-09-18T14:41:31.323
> 
> 标签：ios, cordova, apple-push-notifications, phonegap-plugins, urbanairship.com

我正在为 iOS 和 Android 创建一个 PhoneGap 应用程序。我已经让 Android 工作得很好，但是在 iOS 中从开发切换到生产时遇到了麻烦。没有为具有生产 adHoc 构建的设备注册设备令牌。我已经用尽了我能想到的一切。这是我到目前为止所做的：

1.  删除了我计算机上的所有证书和配置文件以尝试重新开始。
2.  在我的应用程序特定的应用程序 ID（不是通配符应用程序 ID）上启用生产 APNS 并将其导入我的钥匙串。
3.  使用生产 ssl 证书和正确的应用程序 ID 为 adHoc 分发创建了新的生产配置文件。检查以确保在配置文件中设置了 aps-environment。
4.  导入新的配置文件并将应用程序设置为在我的项目和目标的构建设置中使用正确的配置文件。
5.  导出 p12 文件以导入 UA。
6.  在 UA 集上删除并创建了一个新应用程序以供生产使用。上传p12文件并开启Push Debug模式。
7.  确保 AirshipConfig.plist 具有正确的生产密钥并将 APP_STORE_OR_AD_HOC_BUILD 设置为 YES。
8.  将应用程序存档并将其导出以进行临时分发，并通过 iTunes 将其加载到手机上。

当我第一次在设备上运行应用程序时，一切都完全重做。这是我在控制台中得到的：

```
Mon Sep 17 12:48:00 unknown XXXXXXXXX[5039] Warning: Multi-tasking - Device: NO, App: YES

Mon Sep 17 12:48:05 unknown XXXXXXXXX[5039] Warning: Reachability Flag Status: -R -----l- networkStatusForFlags
Mon Sep 17 12:48:06 unknown XXXXXXXXX[5039] Warning: [M] = -[UAPush updateRegistration] [Line 583] Checking registration state
Mon Sep 17 12:48:06 unknown XXXXXXXXX[5039] Warning: [M] = -[UAUser listenForDeviceTokenReg] [Line 969] ListenForDeviceTokenReg
Mon Sep 17 12:48:06 unknown XXXXXXXXX[5039] Warning: [M] = -[UAUser retrieveRequestSucceeded:] [Line 911] User retrieved: 200:{
"user_id" : "XX-XXXXXXXXXXXXXXXXX",
"user_url" : "https://device-api.urbanairship.com/api/user/XX-XXXXXXXXXXXXXXXXX/",
"tags" : [ ],
"device_tokens" : [ ],
"device_pins" : [ ],
"apids" : [ ],
"has_active_subscription" : false,
"subscriptions" : [ ],
"ua_device_ids" : [ "XXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX" ],
"badge" : 0,
"server_time" : "2012-09-17 17:48:02"
}
Mon Sep 17 12:48:06 unknown XXXXXXXXX[5039] Warning: [M] = -[UAUser updateDefaultDeviceToken] [Line 1016] Updating device token
Mon Sep 17 12:48:06 unknown XXXXXXXXX[5039] Warning: [M] = -[UAUser updateDefaultDeviceToken] [Line 1021] Skipping device token update: no token, already up to date, or user is being updated.

Mon Sep 17 12:48:21 unknown XXXXXXXXX[5039] Warning: [M] = +[UAKeychainUtils getDeviceID] [Line 269] Retrieved device id info from keychain.
Mon Sep 17 12:48:21 unknown XXXXXXXXX[5039] Warning: [M] = +[UAKeychainUtils getDeviceID] [Line 273] Device ID result is not nil.
Mon Sep 17 12:48:21 unknown XXXXXXXXX[5039] Warning: [M] = +[UAKeychainUtils getDeviceID] [Line 282] Loaded Device ID: XXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
Mon Sep 17 12:48:21 unknown XXXXXXXXX[5039] Warning: [M] = +[UAKeychainUtils getDeviceID] [Line 283] Loaded Model Name: iPhone1,2
Mon Sep 17 12:48:21 unknown XXXXXXXXX[5039] Warning: [M] = -[UAAnalytics requestDidSucceed:response:responseData:] [Line 467] Analytics data sent successfully. Status: 200 
```

我删除了 ID 号和应用程序名称。

“跳过设备令牌更新：没有令牌，已经是最新的，或者正在更新用户”上方的这条消息。我觉得很奇怪。这是一个新创建的 UA 应用程序，具有新的密钥和一切。我还用我的开发配置文件、密钥和所有内容加载了它，它工作得很好。它只是不在生产运行中注册设备令牌。

任何帮助表示赞赏。我检查了所有设置，据我所知，我的所有配置文件、密钥、权利都设置正确。我在 WiFi 上运行，因为我使用的手机只是一部没有有效运营商服务的测试手机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T05:14:14.230

我想我现在已经两次解决了这个问题，虽然我不是 100% 确定核心问题是什么——我认为你如何测试它存在问题。

尝试让 UA Push Sample 应用程序工作：

*   下载 UA PushSample 应用程序。
*   使用您的应用程序/秘密组合更新 AirshipConfig.plist 文件
*   使用正确的包 ID、配置文件等更新构建。
*   从您的设备中删除您的应用程序（当您尝试构建 PushSample 应用程序时，如果它仍然存在且具有相同的包标识符，它们会发生冲突。
*   编译并运行推送示例应用程序。
*   在日志中查找令牌，并检查 UA 仪表板（对于 # 个令牌，或仅发送广播警报）。

你还有同样的问题吗？就我而言，这两次都消失了，并且能够成功注册令牌。我认为由于某种原因，错误配置的证书/配置文件阻止了正确创建令牌。当我修复它们时 - 为时已晚，因为 UA 库认为它已经注册，因此跳过了那部分。日志中的这一行让我怀疑：

> 在应用程序初始化时禁用应用程序前台检查注册

现在 2 比 2，当我将正确的 certs/bundle/provisioning 配置文件放在干净的 PushSample 应用程序中时，它工作正常

# javascript - Ajax 成功函数在离开范围之前不等待内部脚本完成

> ID：12479325
> 
> 赞同：0
> 
> 时间：2012-09-18T14:41:36.417
> 
> 标签：javascript, jquery, html

我有这段代码：

```
$.ajax({
  type: "POST",
  async: true,
  url: "Notes/ViewAttachments.aspx/CompressFiles",
  data: "{ 'hidBinaryFileIDs': '" + csList + "', 'userID' : '" + userID + "'}",
  contentType: "application/json; charset=utf-8",
  dataType: "json",
  success: function (data) {
    $.Zebra_Dialog(data.d, {
      'type': 'information',
      'title': 'Confirmation',
      'buttons': [{
        caption: 'Ok',
        callback: function () {

        }
      }]
    });
  },
  error: function (xhr, ajaxOptions, thrownError) {
    $.Zebra_Dialog('Error : ' + xhr.status + ' - ' + xhr.statusText + ' : ' + thrownError, {
      'type': 'error',
      'title': 'Confirmation',
      'buttons': [{
        caption: 'Ok',
        callback: function () {}
      }]
    });
  }
}); 
```

当 ajax 返回成功时，它会显示整个对话框 2 秒左右（不足以让用户阅读它包含的消息）然后关闭它。使用 chrome 的调试器，我确定它超出了范围，而无需等待成功函数内的对话框上的确认。有谁知道我将如何停止代码，直到用户单击确定？

这是该ajax调用的完整代码块..

```
 var leZDB = null;
    function zipSelectedAttachments() {

        var ids = getSelectedTaskIDs();
        if (ids.length > 0) {
            leZDB = $.Zebra_Dialog('Do you want to zip the attachment(s)?', {
                'type': 'question',
                'title': 'Confirmation',
                'buttons': ['Yes', 'No'],
                'onClose':function (caption) {
                    if(caption = 'Yes') {
                        LinkAndPass(ids);
                    }
                }
            });
        } else {
            $.Zebra_Dialog('No attachments are selected.', {
                'type': 'error',
                'title': 'Error',
                'buttons': [
                    { caption: 'Ok', callback: function () { } }

                ]
            });
        }
    }

    function LinkAndPass(ids) {
        leZDB.close();
        if (true)
        {
            SendIDSForZipping(ids);
        }
    }

    function SendIDSForZipping(ids) {
        var csList = '';
        var userID = $('#hiduserID').val();

        for (var i = 0; i < ids.length; ++i) {
            csList += ids[i] + ',';
        }
        var $this = $(this);
        $this.die('click');

        $.ajax({
            type: "POST",
            //async: true,
            url: "Notes/ViewAttachments.aspx/CompressFiles",
            data: "{ 'hidBinaryFileIDs': '" + csList + "', 'userID' : '" + userID+ "'}",
            contentType: "application/json; charset=utf-8",
            context:this,
            dataType: "json",
            success: function (data) {
                var hasClickedOK = false;
                var hasDisplayed = false;
                    if (!hasDisplayed) {
                        hasDisplayed = true;
                        $.Zebra_Dialog(data.d, {
                            'type': 'information',
                            'title': 'Confirmation',
                            'buttons': [
                                {
                                    caption: 'Ok',
                                    callback: function () {
                                        hasClickedOK = true;
                                    }
                                }
                            ]
                        });
                    }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                $.Zebra_Dialog('Error : ' + xhr.status + ' - ' + xhr.statusText + ' : ' + thrownError, {
                    'type': 'error',
                    'title': 'Confirmation',
                    'buttons': [
                        {
                            caption: 'Ok',
                            callback: function () {
                            }
                        }
                    ]
                });
            }
        });
    } 
```

getSelectedIDs() 返回一个数字数组。

后面的代码返回一个字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:58:35.453

尝试 asyn:false in`$.ajax({ type: "POST", async: true });`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T19:53:22.630

问题在于从后面的代码调用 Web 方法。一个错误的逻辑导致它刷新页面，立即关闭框。

# django - 如何过滤django中的查询结果集列表

> ID：12479326
> 
> 赞同：0
> 
> 时间：2012-09-18T14:41:38.317
> 
> 标签：django

嗨，我有以下代码工作正常：

```
if getattr(hotel_main, "X", 1):
        hotels1 = hotels.filter(Q(X=True))
        for hotel in hotels1:
            if models.CalendarDay.objects.filter(hotel=hotel, date=date).count() == 0:
                similar_venues.append(hotel) 
```

我一次又一次地重复使用上面的代码来检查不同的条件，比如 Q(Y=True),Q(Y=True),Q(Z=True)

如果我可以根据条件过滤列表，我可以摆脱重复的代码......我想要这样的东西：**similar_venues.filter(Q(X=True))** 请帮忙......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:49:45.980

You can write conditions in a list:

```
conditions = [ Q(Y=True),Q(Y=True),Q(Z=True) ]
if getattr(hotel_main, "X", 1):
    q_date = Q( calendarday__date = date )
    for q in conditions:
        for hotel in hotels.filter( q_date & q).distinct():
            similar_venues.append(hotel) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:47:22.267

如果我理解正确你的问题：

```
filter_on_x = [obj for obj in similar_venues if obj.X]
filter_on_y = [obj for obj in similar_venues if obj.Y] 
```

依此类推，适用于所有 X、Y、Z

# jquery - 使用多个 JQuery 脚本

> ID：12479329
> 
> 赞同：0
> 
> 时间：2012-09-18T14:41:41.147
> 
> 标签：jquery, html, css

我有一个需要在其中运行多个 JQuery 脚本的网页。一种是用于灯箱图像查看器，另一种是为我的图像添加砖石布局。两个脚本单独工作都很好，但是当它们在一起时，灯箱将无法工作。我究竟做错了什么？

我在这里有一个问题的演示：有砌体：[http](http://shareit.me/jquery.fancybox-1.3.4/scrapbook.html) ://shareit.me/jquery.fancybox-1.3.4/scrapbook.html 没有砌体：[http ://shareit.me/jquery.fancybox-1.3.4/剪贴簿2.html](http://shareit.me/jquery.fancybox-1.3.4/scrapbook2.html)

单击太阳镜以查看问题。

这是我拥有两个脚本的来源。注意，我删除了一些 html：

```
<!doctype html>
<html>

<head>
<title> Scrapbook </title>
<link rel="stylesheet" type="text/css" href="styles/scrapbook.css"/>
<link rel="stylesheet" type="text/css" href="styles/navbar.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="imagetoolbar" content="no" />
<title>FancyBox 1.3.4 | Demonstration</title>
<script type="text/javascript"    
src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script>
    !window.jQuery && document.write('<script src="jquery-1.4.3.min.js">  
<\/script>');
</script>
<script type="text/javascript" src="./fancybox/jquery.mousewheel-3.0.4.pack.js">
</script>
<script type="text/javascript" src="./fancybox/jquery.fancybox-1.3.4.pack.js">
</script>
<link rel="stylesheet" type="text/css" href="./fancybox/jquery.fancybox-1.3.4.css" 
media="screen" />
<script type="text/javascript">
    $(document).ready(function() {
        /*
        *   Examples - images
        */

        $("a#example1").fancybox();
</script>
</head>

<body>

<div id="page-title">
    <p> Colin's Scrapbook </p>
</div>
<div id="new-album-button">
    <div id="btn" class="create-album">
        <p><a href="createalbum.html"> + create album </a></p>
    </div>
</div>

<div id="container">
            <div id="brick" class="event">
        <div class="event-top">
            <img src="http://www.destination360.com/north-
america/us/florida/images/s/south-florida-beaches.jpg"/>
        </div>
        <div class="event-bottom">
            <div class="event-bottom-pic">
                <img 
src="http://cbsmiami.files.wordpress.com/2010/11/bill_baggs_beach.jpg"/>
            </div>
            <div class="event-bottom-pic">
                <img src="http://www.best-beaches.com/images/best-
florida-vacations/florida-best-vacations.jpg"/>
            </div>
            <div class="event-bottom-pic">
                <img src="http://www.destin-florida-
mls.com/images/destin12.jpg"/>
            </div>
            <div class="event-bottom-pic">
                <img src="http://www.rachelmarks.com/wp-
content/uploads/2009/10/Beach-Florida.jpg"/>
            </div>
        </div>
        <div class="event-title">
            <p> Florida 2012 </p>
        </div>
    </div>
    <div id="brick" class="moment">
        <a id="example1" href="./example/1_b.jpg"><img alt="example1" 
src="./example/1_b.jpg" /></a>
    </div>  
</div>

<script src="jquery/jquery-1.7.1.min.js"></script>
<script src="jquery/jquery.masonry.min.js"></script>
<script>
  $(function(){

var $container = $('#container');

$container.imagesLoaded( function(){
  $container.masonry({
    itemSelector : '#brick'
  });
});

});
</script>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:10:48.190

你的 JS 有一些错误。

1.  你`$(document).ready(function() {`忘了关闭这个标签。

2.  您包括 2 个 jQuery 实例，它们相互冲突（并且可能相互抵消）。我的建议只是加载 jQuery 1.7。我已经对其进行了测试，它似乎与 Fancybox 配合得很好。

这是正确的、经过测试的和工作的代码（不是，一切都是绝对路径，因为我是在本地测试的）

```
<!doctype html>
<html>
<head>
<title> Scrapbook </title>
<link rel="stylesheet" type="text/css" href="http://shareit.me/jquery.fancybox-1.3.4/styles/scrapbook.css"/>
<link rel="stylesheet" type="text/css" href="http://shareit.me/jquery.fancybox-1.3.4/styles/navbar.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="imagetoolbar" content="no" />
<title>FancyBox 1.3.4 | Demonstration</title>
<script src="http://shareit.me/jquery.fancybox-1.3.4/jquery/jquery-1.7.1.min.js"></script>
<script type="text/javascript">
    !window.jQuery && document.write('<script src="jquery-1.4.3.min.js"><\/script>');
</script>
<script type="text/javascript" src="http://shareit.me/jquery.fancybox-1.3.4/fancybox/jquery.mousewheel-3.0.4.pack.js">
</script>

<script type="text/javascript" src="http://shareit.me/jquery.fancybox-1.3.4/fancybox/jquery.fancybox-1.3.4.pack.js">
</script>
<link rel="stylesheet" type="text/css" href="http://shareit.me/jquery.fancybox-1.3.4/fancybox/jquery.fancybox-1.3.4.css" 
media="screen" />
<script type="text/javascript">
    $(document).ready(function() {
        /*
        *   Examples - images
        */
        $("a#example1").fancybox();

    });
</script>
</head>

<body>

<div id="page-title">
    <p> Colin's Scrapbook </p>
</div>
<div id="new-album-button">
    <div id="btn" class="create-album">
        <p><a href="createalbum.html"> + create album </a></p>
    </div>
</div>

<div id="container">
            <div id="brick" class="event">
        <div class="event-top">
            <img src="http://www.destination360.com/north-
america/us/florida/images/s/south-florida-beaches.jpg"/>
        </div>
        <div class="event-bottom">
            <div class="event-bottom-pic">
                <img 
src="http://cbsmiami.files.wordpress.com/2010/11/bill_baggs_beach.jpg"/>
            </div>
            <div class="event-bottom-pic">
                <img src="http://www.best-beaches.com/images/best-
florida-vacations/florida-best-vacations.jpg"/>
            </div>
            <div class="event-bottom-pic">
                <img src="http://www.destin-florida-
mls.com/images/destin12.jpg"/>
            </div>
            <div class="event-bottom-pic">
                <img src="http://www.rachelmarks.com/wp-
content/uploads/2009/10/Beach-Florida.jpg"/>
            </div>
        </div>
        <div class="event-title">
            <p> Florida 2012 </p>
        </div>
    </div>
    <div id="brick" class="moment">
        <a id="example1" href="http://shareit.me/jquery.fancybox-1.3.4/example/1_b.jpg"><img alt="example1" 
src="http://shareit.me/jquery.fancybox-1.3.4/example/1_b.jpg" /></a>
    </div>  
</div>
<script src="http://shareit.me/jquery.fancybox-1.3.4/jquery/jquery.masonry.min.js"></script>
<script type="text/javascript">
$(function(){
var $container = $('#container');
$container.imagesLoaded( function(){
  $container.masonry({
    itemSelector : '#brick'
  });
});

});
</script>
</body>
</html> 
```

# c# - .NET 或 3rd 方库将数字转换为“第一”、“第二”、“第三”等......”

> ID：12479332
> 
> 赞同：12
> 
> 时间：2012-09-18T14:41:48.490
> 
> 标签：c#, .net

如标题所示，有谁知道 .NET 或第 3 方库中是否有一个地方可以将整数转换为“排序”对应物。

```
1 - first
2 - second
3 - third
etc... 
```

我当然可以自己写一个，但如果可能的话，我宁愿重用已经存在的东西。

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-07-07T17:19:29.750

Humanizer 是一个很棒的库：[Humanizr](https://humanizr.net/)

```
Install-Package Humanizer 
```

使用 Humanizer，您可以：

```
int number = 5;
string ordinal = number.ToOrdinalWords() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:45:16.793

[将数字转换为单词 C#](https://stackoverflow.com/questions/2729752/converting-numbers-in-to-words-c-sharp)

类似于这个问题。你可以得到你需要的`LukeH's answer`：

```
public static string NumberToWords(int number)
{
if (number == 0)
    return "zero";

if (number < 0)
    return "minus " + NumberToWords(Math.Abs(number));

string words = "";

if ((number / 1000000) > 0)
{
    words += NumberToWords(number / 1000000) + " million ";
    number %= 1000000;
}

if ((number / 1000) > 0)
{
    words += NumberToWords(number / 1000) + " thousand ";
    number %= 1000;
}

if ((number / 100) > 0)
{
    words += NumberToWords(number / 100) + " hundred ";
    number %= 100;
}

if (number > 0)
{
    if (words != "")
        words += "and ";

    var unitsMap = new[] { "zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen" };
    var tensMap = new[] { "zero", "ten", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety" };

    if (number < 20)
        words += unitsMap[number];
    else
    {
        words += tensMap[number / 10];
        if ((number % 10) > 0)
            words += "-" + unitsMap[number % 10];
    }
}

return words;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:46:37.780

我不知道有一个预先存在的库来处理这个问题，但这里有一个非常简单的方法： [.NET 将数字转换为字符串表示（1 到 1、2 到 2 等……）](https://stackoverflow.com/questions/794663/net-convert-number-to-string-representation-1-to-one-2-to-two-etc)

# objective-c - 在目标 c 中存储单词列表

> ID：12479335
> 
> 赞同：3
> 
> 时间：2012-09-18T14:42:02.777
> 
> 标签：objective-c, nsarray, storage

我之前制作了一个字谜求解器，如果你给出一组 9 个字母，程序会找到可以由这 9 个字母组成的每一个可能的 3-9 个字母单词。

我用 javascript 制作了这个，其中包含 100,000 多个单词的单词列表以单个数组形式存储，可以找到合适的答案。

要找到 9 个字母集的每个子词，程序只需要在整个数组中搜索一次，这意味着无论您给程序提供什么 9 个字母集，子词列表总是在一秒钟内给出。

我现在正在制作相同的程序，但在 Objective-C 中作为我打算制作的 ios 应用程序的一部分。

在 Objective-c 中的 NSArray 中存储 100,000 多个单词列表会有什么问题吗？内存使用、查找速度等问题。

有没有更好的方法来存储这个单词列表，可以使查找更快或者使用更少的内存。

（我是objective-c的新手）

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:47:55.860

简单的答案是试试看。然后您可以使用 Instruments.app 查看性能。

您可能会发现[用于大型数组的 Alternative Objective-C 对象分配](http://cocoawithlove.com/2010/08/alternative-objective-c-object.html)值得一读。

# mysql - 使用 Homebrew 安装 Sphinx 时缺少 mysqlclient 库

> ID：12479342
> 
> 赞同：0
> 
> 时间：2012-09-18T14:42:28.687
> 
> 标签：mysql, sphinx, macports, homebrew

我正在尝试在我的 Mac 10.8.1 上安装 Sphinx 搜索引擎。

我的 MAMP 环境是使用 MacPorts 设置的。由于 Sphinx 端口只有 0.9.9，我转向 Homebrew 安装最新的稳定版本 2.0.5。

一开始我遇到了一些错误，比如缺少 mysql_config（通过链接到 mysql_config5 解决了这个问题）。但是现在，当我尝试安装 Sphinx 时，它告诉我：

```
library not found for -lmysqlclient 
```

但是在/opt/local/lib/mysql5/mysql/下，我发现了以下文件：

```
libmysqlclient.16.dylib
libmysqlclient.a
libmysqlclient.dylib -> libmysqlclient.16.dylib
libmysqlclient.la
libmysqlclient_r.16.dylib
libmysqlclient_r.a
libmysqlclient_r.dylib -> libmysqlclient_r.16.dylib
libmysqlclient_r.la 
```

我在这里想念什么？

谢谢，

米洛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T18:06:41.253

Homebrew 不会在`/opt/local`树下查找库（大多数编译器也不会，除非明确告知这样做）。确保 MySQL 库已安装或符号链接在`/usr/local`.

# php - PHP IF 停止加载 IE 内容

> ID：12479343
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:42:32.753
> 
> 标签：php

**场景** 我有一个 PHP if 语句来测试用户是否是第一次登录。然后会在灰盒弹出框中显示一个演示。

遗憾的是，当该框在 IE 中加载时，网站的内容却没有。这意味着当我用户关闭该框时，它们将保留背景。

**代码**- 我现在使用 PHP 包含。

*灰盒.php*

```
<?php if ($fli == 0) {echo " <script type='text/javascript'>
window.onload = function() {
 GB_showCenter('Your first login', '../video.php');
};
</script> ";} else echo "";?>

<!-- GB scrip --> 
    <script type="text/javascript">
        var GB_ROOT_DIR = "greybox/";
    </script>

<script type="text/javascript" src="greybox/AJS.js"></script>
<script type="text/javascript" src="greybox/AJS_fx.js"></script>
<script type="text/javascript" src="greybox/gb_scripts.js"></script>
<link href="greybox/gb_styles.css" rel="stylesheet" type="text/css" />

<!-- GB --> 
```

*主站点上的相关脚本*

```
<?php  $fli = $_SESSION["USER"]["fli"]; ?>
<?php include "greybox.php" ?> 
```

![IE/Chrome的比较](../Images/cb3c680b610f5492f9cc1ae4943039d6.png)

我会非常感谢任何帮助！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:49:53.353

Never worked with it but what if you try the full url for a test. How does IE then reacts?

Alternative could be [jQueryIU](http://jqueryui.com/demos/dialog/), you can create a dialog for the first login. Also if I restart my browser do I have to see the video again? If you save the last login in the DB you can use that information to show the video.

Good luck.

# iphone - 检查用户的设备是 ipad 还是 iphone/ipod，两种方式的区别

> ID：12479344
> 
> 赞同：0
> 
> 时间：2012-09-18T14:42:37.130
> 
> 标签：iphone, objective-c, ipad, device

我正在阅读`Apress - Beginning iPad Development for iPhone Developer Mastering the iPad SDK`，在一章中我阅读了有关设备检查和作者写道：

*“虽然你可能想简单地检查用户的设备类型或操作系统版本，但随着 Apple 不断发布新设备和 iOS 版本，这不是要走的路。更好的方法是使用 NSClassFromString 测试专用 iPad 类的可用性. 如果你传递一个 iPad 专用的类名，比如 UISplitViewController 到 NSClassString 并且一个有效的对象是 returnet，你就会知道用户的设备是一个 iPad.."*

我不明白，为什么简单地检查设备类型，例如：

```
 NSString *device = [[UIDevice currentDevice] model];

  if ([device rangeOfString:@"iPad"].location != NSNotFound ) {
        isIPad = true;
  }
  else isIPad = false; 
```

比检查 ipad 课程更糟糕吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T14:59:21.750

Apple 检查自己的示例以及启动新的通用应用程序时的方式如下：

```
-(BOOL) isiPad {
    return UI_USER_INTERFACE_IDIOM()==UIUserInterfaceIdiomPad;
} 
```

使用模型可能不好的原因是因为您只是在使用字符串比较。虽然我怀疑他们会更改它，但您永远不知道他们何时可能决定更改使用`[[UIDevice currentDevice] model]`型号或其他东西返回的字符串。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-05-07T13:08:09.647

可能这个方法对你有帮助

```
-(int)CheckDevice {

return ([UIDevice currentDevice].userInterfaceIdiom == UIUserInterfaceIdiomPad) ? 1 :([[UIScreen mainScreen] bounds].size.height == 568) ? 5 :4;
} 
```

它返回

*   1 用于 iPad
*   4 为 iPhone 4
*   5 为 iPhone 5

# java - 是否可以使用 jni 增强反射性能？

> ID：12479346
> 
> 赞同：2
> 
> 时间：2012-09-18T14:42:38.797
> 
> 标签：java, reflection, java-native-interface

在我的代码中，我做了很多反射查找，所以我试图以某种方式改进它。

这是我的 jni setter 方法的示例：

```
JNIEXPORT jobject JNICALL 
Java_org_orman_mapper_Model_fieldSetFloat(JNIEnv * env, jobject  obj, jobject model, jstring field_name, jstring field_type, jfloat value, jclass clazz)
{
    const char* utf_string_name = (*env)->GetStringUTFChars (env, field_name, 0);
    const char* utf_string_type = (*env)->GetStringUTFChars (env, field_type, 0);

    jfieldID id = (*env)->GetFieldID(env, clazz, utf_string_name, utf_string_type);
    (*env)->SetFloatField(env, model, id, value);
    return model;
} 
```

调用的本质是`SetFloatField`，它是否跳过任何​​ java 安全检查？

我没有注意到性能上的任何提升。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T15:15:43.117

> 是否可以使用 jni 增强反射性能？

可能，有点。但是，虽然您可以消除“不需要的”访问检查，但由于您必须进行 JNI 调用来访问对象的内部结构，您会失去一些检查。相比之下，反射方法及其调用序列的实现可能会以常规 JNI 方法不可用的方式进行优化。

（例如，它们可能被实现为直接访问相关数据结构，而不是使用独立于平台的 JNI API。或者 JIT 编译器可能会将对某些“内在”本机方法的本机方法调用视为特殊情况......并使用更快的调用顺序。请注意，这都是假设的……但在某些 JVM 中，某些核心方法的本机实现*已*被给予特殊处理以使其更快。）

* * *

但我的建议是，如果您将反射代码替换为常规的非反射 Java 代码，无论是手写代码、作为源代码生成并编译的代码，您将获得更好的性能（一个数量级或更多） ，或作为字节码生成的代码。一旦有了字节码，JIT 编译器将能够生成优化的本机代码，这将比使用反射或 JNI 快得多。

因此，与其用 JNI 代码（及其相关问题）替换反射，不如用使用纯字节码的东西替换它。

# ajax - 保留 JQuery ajax 函数的上下文

> ID：12479347
> 
> 赞同：0
> 
> 时间：2012-09-18T14:42:40.063
> 
> 标签：ajax, jquery, xmlhttprequest, closures

我有一个旧代码，它依赖于使用以下 ajax 调用的 JQuery 1.3.2

```
function ChangeContent(url, somepageobject) {
   var xhrobj = $.ajax({
       url: url,
       context: somepageobject,
       callback: doFurtherStuff,
       success: function(data) {
                somepageobject.html($(data));
                this.callback.call(this.context[0], data, "ok"); // >> Code breaks here
           }
  });
  return xhrobj;
 } 
```

上面代码的问题是，当我升级到 JQuery 1.8.1 时 this.callback 为空，最重要的是 ChangeContent 函数正在不同的地方使用并且不在我的控制范围内（它用作外部用户的 API ... ETC）。上面的用法示例如下：

```
xhr_object = ChangeContent("/someurl, $("#resultContainer"));

function doFurtherStuff(responseText, statusText, XMLHttpRequest) 
{
   var identifier = '#' + this.id;
   ...
} 
```

请注意，doFurtherStuff 必须具有正确的“this”对象值，即 ChangeContent 函数中指定的上下文。当我尝试使用不同的延迟 then() ...等。升级后JQuery 1.8.1 中的函数解决了上述`this.callback.call(this.context[0], data);`问题，回调函数中的“this”对象具有不同的值，因为我猜新的 JQuery 库处理方式不同。

有没有办法解决上述错误，同时限制对 ChangeContent 函数的更改，因为我试图避免要求所有用户更改他们调用和处理来自该函数的回调的方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:58:42.813

添加 context 选项时，您是在告诉 jQuery`this`成功回调中应该包含什么。这意味着您无法访问传递给 ajax 请求的选项。要么不提供`context`，要么手动传入回调。

```
function ChangeContent(url, somepageobject) {
   var callback = doFurtherStuff;
   var xhrobj = $.ajax({
       url: url,
       context: somepageobject,
       success: function(data) {
                somepageobject.html($(data));
                callback.call(this[0], data, "ok"); // >> Code breaks here
           }
  });
  return xhrobj;
} 
```

更新：如果您想继续按原样使用您的代码，只需重命名上下文属性。

```
function ChangeContent(url, somepageobject) {
   var xhrobj = $.ajax({
       url: url,
       thecontext: somepageobject,
       callback: doFurtherStuff,
       success: function(data) {
                somepageobject.html($(data));
                this.callback.call(this.thecontext[0], data, "ok"); // >> Code breaks here
           }
  });
  return xhrobj;
} 
```

# ruby-on-rails - Rails: before_filter 排除元素

> ID：12479351
> 
> 赞同：0
> 
> 时间：2012-09-18T14:42:50.837
> 
> 标签：ruby-on-rails, model, before-filter

在我的 rails-app 中，我有 2 个模型，我们称它们为**Element**和**Type**。 `:elements has_and_belongs_to_many :types` 和 `:types has_and_belongs_to_many :elements`

现在在 Element 模型中，我想排除一些类型，比如：

```
class Element < ActiveRecord::Base
 before_filter :exclude_some_types

 def exclude_some_types
   # if certain type satisfies condition, exclude it from the types list
 end 
```

我该如何编码？我的意思是排除部分。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:48:07.453

不`element.types.delete_if{|t| condition(t)}`工作？

# facebook - 触发在 Facebook 时间线上加载内容的事件

> ID：12479358
> 
> 赞同：0
> 
> 时间：2012-09-18T14:43:11.230
> 
> 标签：facebook, dom-events, htmlunit, nutch, facebook-timeline

我正在研究 Apache Nutch 修改项目。我们已经将 Nutch 的原始模块替换为我们使用 HtmlUnit 构建的模块。我需要下载整个 Facebook 用户站点（例如[http://www.facebook.com/profile.php?id=100002517096832](http://www.facebook.com/profile.php?id=100002517096832)），这将使用我们自己的解析器进行解析。不幸的是，Facebook 正在使用名为 BigPipe 的机制（[http://www.facebook.com/note.php?note_id=389414033919](http://www.facebook.com/note.php?note_id=389414033919)）。这就是为什么大多数当前网站都隐藏在`<.!-- -->`标签中的原因。通常当我们向下滚动 Facebook 页面时，每次我们即将到达页面底部时，都会打开新内容。我尝试使用 Javascript 滚动我的`htmlPage`(`HtmlPage`对象来自`HtmlUnit`项目），但最后我意识到滚动不会触发在 Facebook 用户网站上加载新内容。

如何检查页面上的哪些事件触发在当前 Facebook 页面上加载内容？也许我应该从不同的方面解决问题，例如尝试自己提取 BigPipe “事物”？你有没有这样做过？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:58:12.127

在处理你的问题之前......你想在那里建立什么样的项目？

由于 Apache Nutch 是一个*开源网络搜索软件*，我认为您正在尝试构建某种搜索引擎，它会抓取 Facebook 用户配置文件/提要以获取数据并使其可在某些第三方网站上搜索？

好吧，那将违反[Facebook 平台政策](https://developers.facebook.com/policy/)：

> 一、特点和功能
> 
> `12.`未经我们书面许可，您不得在任何搜索引擎或目录中包含从我们处获得的数据。

那么，你有书面许可吗？

# javascript - javascript中函数与函数的关系

> ID：12479359
> 
> 赞同：2
> 
> 时间：2012-09-18T14:43:11.637
> 
> 标签：javascript, prototype

我想了解 javascript 中 Function 和 function 之间的关系。

让我举个例子：

```
Function.prototype.bind // function () { [native code] }

var foo = function () {};
foo.bind; //function () { [native code] } 
```

我的问题是
`Function.prototype.bind`并且`foo.bind`指的是相同的代码？
如果是，有人可以解释我的关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:47:44.587

是的，any 的原型`function() {}`总是指向`Function`原型。一个简单的查找方法是使用深度相等进行检查：

```
var foo = function () {};
foo.bind === Function.prototype.bind // -> true 
```

您实际上可以使用`new`运算符创建一个 Function 实例并传递主体和参数（尽管这确实不推荐）：

```
var f = new Function("return 'hello world'");
f() // -> hello world 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:01:53.527

也许你，就像几周前的我一样，想知道向 this 添加一个函数（在外部函数内部）和通过原型关键字添加它之间的区别。关键区别在于，后者只添加到原型对象一次，而第一个（将新函数分配给 this 并返回 this）在每次创建函数（对象）的新实例时添加。

我发现这篇文章非常好：[在 JavaScript 中使用 'prototype' 与 'this'？](https://stackoverflow.com/questions/310870/use-of-prototype-vs-this-in-javascript)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:49:21.087

是的，检查一下：

```
> (function (){}).bind === Function.prototype.bind
true 
```

为了证明它不仅仅是在做字符串相等：

```
> (function(){} === function(){})
false
> ((""+function(){}) === (""+function(){}))
true 
```

这是因为任何函数的内部`[[Prototype]]`字段（可以在 Google Chrome 中使用 访问`__proto__`）总是`Function.prototype`：

```
> Function.prototype
function Empty() {}
> (function (){}).__proto__
function Empty() {}
> Function.prototype === (function (){}).__proto__
true 
```

如果在对象中查找给定名称的字段但未找到，则遵循原型继承链，直到找到确实具有该字段的对象。在这种情况下，我们的函数没有`bind`属性，所以`bind`取自原型：

```
> (function (){}).__proto__.bind
function bind() { [native code] } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T14:54:21.990

所有 JavaScript[函数 [objects]](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope) (like `foo`) 都是[`Function`构造函数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function)的实例，并且继承自`Function.prototype`. 您可以轻松检查它：

```
> (function foo(){…}) instanceof Function
true
> (function foo(){…}).bind === Function.prototype.bind
true 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T14:59:03.110

> Function.prototype.bind 和 foo.bind 指的是同一个代码？

绝对地！您可能遇到过这样的短语，例如*JavaScript 是一种函数式语言*，或者*在 JS 中，函数是第一类对象*。这意味着属性和方法的逻辑适用于函数，就像它们对任何对象（数组、日期、对象...）所做的一样
。主要`Function`包含定义所有函数具有的所有基本属性和方法的原型。与其将新的函数*对象*分配给每个函数，不如将它们分配给所有函数对象都指向的 1 个对象更有效。

这意味着，就像其他人在这里指出的那样：

```
function foo()
{};
foo.bind === Function.prototype.bind; 
```

但这也意味着您可以同时扩充原型和单个函数对象：

```
Function.prototype.getName = function()
{
    return this.name;
}
foo.getName();//foo 
```

同样，在这里`foo.getName === Function.prototype.getName`，但是一旦我们直接分配给单个函数对象：

```
foo.getName = function(){ return 'bar';}; 
```

理所当然地`foo.getName !== Function.prototype.getName`......只是玩弄函数原型，以及它如何单独影响每个函数的行为。挺好玩的;P

# jquery - 如何使用jquery从没有html标签的输入中获取价值？

> ID：12479363
> 
> 赞同：0
> 
> 时间：2012-09-18T14:43:26.427
> 
> 标签：jquery, html, input

.val() 获取带有 html 标签的文本？也许是 .text()，但如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:54:08.597

```
var el = document.getElementById(elementId); // or just another HTML DOM element
var text = el.innerHTML.replace(/<[^>]+>/g, ""); 
```

可能会做一些接近你想要的事情。

*编辑：*这就是它在 Stack Overflow 上的作用：

```
document.getElementById("portalLink").innerHTML.replace(/<[^>]+>/g, "") 
```

在 Chrome 的控制台中产生

```
"
            Stack Exchange
        " 
```

# android - YouTubePlayerAPI 分发时间表？

> ID：12479365
> 
> 赞同：5
> 
> 时间：2012-09-18T14:43:33.733
> 
> 标签：android, youtube-api

当我最近发现这个[Google IO 视频](http://youtu.be/3WFsx-u-q3Y)时，我真的很兴奋。与当前选项（intent、iframe embed）相比，轻松将 YouTube 功能添加到应用程序非常有吸引力

令我惊讶的是，尽管自公告发布几个月以来，除了该视频之外几乎没有任何内容。会议本身甚至没有涵盖发布时间表。

有谁知道在哪里可以得到一个罐子，测试版或其他，玩？有谁知道这可能会广泛分布的时间表？

我希望来自 YouTube API 博客和 YouTube API 团队的人可以解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T09:45:56.537

API 现在可用。它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T04:05:04.450

在这一点上，我们没有其他要分享的东西——团队仍在努力让这个发布，但我无法提供日期。我们不会公开发布 Player SDK 的 beta 版本。

（另外，我不肯定这是属于 Stack Overflow 的问题——如果是这种情况，请向任何版主道歉。）

# css - 在 css 中包含图像

> ID：12479367
> 
> 赞同：0
> 
> 时间：2012-09-18T14:43:34.677
> 
> 标签：css

今天在查看一个网站的来源时，我遇到了令我惊讶的事情。他们将图像包含在 css 文件中（参见[http://static.a.gs-cdn.net/webincludes/css/production-uri.css?20120521.1](http://static.a.gs-cdn.net/webincludes/css/production-uri.css?20120521.1)）

这让我感到惊讶，在现代浏览器上加载一个嵌入了所有图像的大文件肯定会花费更长的时间（即 chrome 会同时触发大量对其所需内容的请求），并使调试任何 css 问题变得更加困难。这是正确的吗？这种方法有什么好处吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T14:49:41.170

在 CSS 中包含图像并没有什么问题，尽管使用 CSS sprites 可能更有效。

**对 UI 元素（但不是内容**元素）使用 CSS sprite 是有意义的，因为它减少了 HTTP 请求的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:49:26.107

[这是一篇很好的文章](http://css-tricks.com/data-uris/)，详细介绍了这种方法的一些优缺点。

优点：

> 最大的原因：它节省了 HTTP 请求。除了纯文档大小之外，这是关于页面加载速度的#1 因素。更少=更好。

缺点：

> 很难为所有内容维护具有嵌入式数据 URI 的站点。更新图像并替换它更容易。
> 
> 您应该只在大量缓存的文档中使用它，就像您的 CSS 一样。如果可以保存 6 个 HTTP 请求，那么拥有 300k 而不是 50k 的 CSS 文件就可以了，但前提是该 CSS 文件与那些图像一样被缓存。

就个人而言，我从不使用它。它节省了 HTTP 请求，但是用我认为不合适的东西使你的 CSS 膨胀。为了清晰地分离关注点，图像应该就是 - 图像。

另外，您将很难缓存所有资源 - 如果您对 CSS 进行一次更改，那么所有图像数据都会无缘无故地重新下载。

# java - Java RMI 连接被拒绝

> ID：12479369
> 
> 赞同：0
> 
> 时间：2012-09-18T14:43:42.863
> 
> 标签：java, rmi

从策略文件：

```
permission java.net.SocketPermission "localhost:1024-", "listen, resolve";
permission java.net.SocketPermission "localhost:1099", "connect, resolve";
permission java.net.SocketPermission "localhost:1024-", "connect, resolve";
permission java.net.SocketPermission "localhost:1024-", "accept, resolve"; 
```

有这个代码：

```
remoteObjName = "blabla";
final objectInterface engine = new object();
final Remote stub = UnicastRemoteObject.exportObject(engine, 0);
final Registry registry = LocateRegistry.getRegistry();
registry.rebind(remoteObjName, stub);//this line causes the exception. 
```

什么可能导致此异常，在最后一行`registry.rebind(remoteObjName, stub);`：

```
java.rmi.ConnectException: Connection refused to host: 127.0.0.1; nested exception is: 
        java.net.ConnectException: Connection refused: connect
        at sun.rmi.transport.tcp.TCPEndpoint.newSocket(Unknown Source)
        at sun.rmi.transport.tcp.TCPChannel.createConnection(Unknown Source)
        at sun.rmi.transport.tcp.TCPChannel.newConnection(Unknown Source)
        at sun.rmi.server.UnicastRef.newCall(Unknown Source)
        at sun.rmi.registry.RegistryImpl_Stub.rebind(Unknown Source)
        at app.ConnectionHandler$QAProbeRemote.startEngine(ConnectionHandler.java:47)
        at app.Main.<init>(Main.java:71)
        at app.Main$1.run(Main.java:49)
        at java.awt.event.InvocationEvent.dispatch(Unknown Source)
        at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
        at java.awt.EventQueue.access$000(Unknown Source)
        at java.awt.EventQueue$1.run(Unknown Source)
        at java.awt.EventQueue$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
        at java.awt.EventQueue.dispatchEvent(Unknown Source)
        at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
        at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
        at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
        at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
        at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
        at java.awt.EventDispatchThread.run(Unknown Source)
    Caused by: java.net.ConnectException: Connection refused: connect
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.PlainSocketImpl.doConnect(Unknown Source)
        at java.net.PlainSocketImpl.connectToAddress(Unknown Source)
        at java.net.PlainSocketImpl.connect(Unknown Source)
        at java.net.SocksSocketImpl.connect(Unknown Source)
        at java.net.Socket.connect(Unknown Source)
        at java.net.Socket.connect(Unknown Source)
        at java.net.Socket.<init>(Unknown Source)
        at java.net.Socket.<init>(Unknown Source)
        at sun.rmi.transport.proxy.RMIDirectSocketFactory.createSocket(Unknown Source)
        at sun.rmi.transport.proxy.RMIMasterSocketFactory.createSocket(Unknown Source)
        ... 22 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T13:37:40.620

您尚未启动注册表，因此连接失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-12T12:40:06.813

您需要启动在 JRE 文件夹中找到的“rmiregistry”注册表。

例如，假设您的 JRE 文件夹位于：C:\Program Files\Java\jre1.8.0_271\bin

您可以转到该文件夹​​并运行 rmiregistry.exe

rmir​​egistry.exe 将在控制台中运行。将其留在背景中。

如果您更喜欢通过 cmd 执行此操作，请执行以下操作：

打开cmd，写：

cd C:\Program Files\Java\jre1.8.0_271\bin

点击“Enter”，然后写：

启动 rmiregistry

并再次按“Enter”。

# c# - 检测用户是否点击了浏览器控件中的特定链接？

> ID：12479373
> 
> 赞同：0
> 
> 时间：2012-09-18T14:43:50.580
> 
> 标签：c#, .net, webkit

我没有使用内置的浏览器控件（即包装器），但我使用的是 Webkit.Net

当我单击时`button1`，WebkitBrowser 将导航到键入的链接`textBox1`

```
private void Button1_Click(object sender, EventArgs e)
{
    backgroundWorker1.Navigate("https://www.facebook.com/cocacola");
} 
```

我可以检测用户何时单击“赞”按钮吗？例如，当用户点赞该页面时，会出现一个 MessageBox 并表示该页面已被成功点赞！

Anyhelp将不胜感激

# php - 从 PHP 中的 Soap 响应标头获取属性

> ID：12479377
> 
> 赞同：1
> 
> 时间：2012-09-18T14:44:07.820
> 
> 标签：php, soap, service, web, header

我正在使用 PHP 连接到[Web 服务](http://www.webcrm.com/apiTechDocumentation/)。

我需要使用一些登录详细信息连接到 Web 服务，以便生成票证以开始使用可用的方法。

这是一些代码：

```
//Connect To WebCrm API
$client = new SoapClient("http://b2b-email.net/apicrm1/webCRMAPI.asmx?wsdl",    array('trace' => 1));

//Login
$ticket = $client->Authenticate(array('code' => 'rhgkhgk','user' =>'myusername','password' =>'apass')); 
```

在响应肥皂标题中，将生成一张票。这是在 Ticket Header Then GUID 下生成的。（见下文）

```
 <?xml version="1.0" encoding="utf-8"?>
     <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <soap:Header>
         <TicketHeader xmlns="http://www.webcrm.com/">
             <Guid>TICKET->>>>>>>>e446373e-8fg0-4dfc-b876-41f3bc8990dd</Guid>
        </TicketHeader>
      </soap:Header>
       <soap:Body>
        <AuthenticateResponse xmlns="http://www.webcrm.com/">
          <AuthenticateResult>
        <Message />
        <Code>0</Code>
      </AuthenticateResult>
    </AuthenticateResponse>
  </soap:Body>
</soap:Envelope> 
```

我需要此票证 ID 才能使用 Web 服务执行任何其他任务，但如何访问它并在我的代码中使用它？

我试过使用下面：

```
$response = $client->__getLastResponse(); 
```

但是，此输出如下所示：

```
6d5933d3-46ff-4690-893d-2af04806668c->>>>>>>>0<<<<<ZERO ON THE END 
```

零总是在不应该的时候？

非常感谢任何有关为什么以我可以实现从 Soap Header 访问票证的最佳方式发生这种情况的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:58:17.603

根据[手册](http://www.php.net/manual/en/soapclient.soapcall.php)：

```
$soapclient->__soapCall("soapmethod", array(parameters), null, $input_headers, &$output_headers); 
```

然后 $output_headers 应该包含响应消息的标头。

`$client->__getLastResponse()`返回最后一个响应的 XML。您正在浏览器中查看此内容，并且您的浏览器正在尝试将其解释为 HTML。因此，它不会显示任何 XML 标记，而只会显示文本。这就是显示 0 的原因。您可以通过多种方式查看整个 XML：

*   查看PHP页面的源码
*   `echo`将语句包装在`<xmp></xmp>`标签中。
*   在回显之前在 XML 上调用[htmlentities() 。](http://php.net/htmlentities)

# c++ - 如何使用 c++/WinAPI 绘制具有透明背景的文本？

> ID：12479386
> 
> 赞同：12
> 
> 时间：2012-09-18T14:44:29.170
> 
> 标签：c++, winapi, gdi

如何使用 WinAPI 绘制具有透明颜色的文本？通常我使用 SetBkMode(hDC, TRANSPARENT)，但现在我需要使用双缓冲。这样，图像绘制正确，但文本绘制不正确（黑色背景）。

```
case WM_PAINT:
{
    hDC = BeginPaint(hWnd, &paintStruct);
    SetBkMode(hDC, TRANSPARENT);

    HDC cDC = CreateCompatibleDC(hDC);
    HBITMAP hBmp = CreateCompatibleBitmap(hDC, width, height);
    HANDLE hOld = SelectObject(cDC, hBmp);

    HFONT hFont = (HFONT)SelectObject(hDC, font);
    SetTextColor(cDC, color);
    SetBkMode(cDC, TRANSPARENT);

    TextOut(cDC, 0, 0, text, wcslen(text));

    SelectObject(cDC, hFont);

    BitBlt(hDC, 0, 0, width, height, cDC, 0, 0, SRCCOPY);

    SelectObject(cDC, hOld);
    DeleteObject(hBmp);
    DeleteDC(cDC);

    EndPaint(hWnd, &paintStruct);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-18T14:58:13.120

`SetBkMode(dc, TRANSPARENT)`应该仍然可以正常工作。确保在绘制到后台缓冲区时使用正确的 DC 句柄。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T15:47:52.233

创建位图时，未指定颜色。文档没有说明它是如何初始化的，但看起来可能是纯黑色（全为零）。由于您在位图上绘制文本，因此位图的背景保持黑色。然后，您将整个位图复制到 DC，然后所有像素、背景和文本都出现了。

要解决此问题，您必须在绘制文本之前将所需的背景复制到位图中。

# ios - 如果 (n-1)-th 有错误的令牌，则未发送第 n-th Apple 推送通知

> ID：12479396
> 
> 赞同：0
> 
> 时间：2012-09-18T14:45:01.783
> 
> 标签：ios, push-notification, apple-push-notifications

我在使用简单格式时遇到了一些 apn 问题。这是场景：

1) 我与 apn 推送服务有持久连接。

2) 我连续发送 10 条消息，例如第 5 条消息可能有错误的设备令牌

3）从1到4的所有消息都正确发送

4）我从成功发送所有消息的套接字中收到一条消息（包括从第 5 到第 10 的消息）。

5) 6日到10日的消息不会推送给用户。

6）一段时间后连接被apn服务器关闭

我做错了什么还是这是常见的行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:50:13.493

你用什么来发送推送通知？你能分享你的代码吗？我一直在使用[APNS-Sharp](https://github.com/Redth/APNS-Sharp)，它运行得非常好。如果第 5 条消息有错误的令牌，则完全独立于下一条消息！确保您定期运行反馈服务​​并删除无效令牌并且令牌不想接受您的推送通知。也看看[PushSharp](https://github.com/Redth/PushSharp)。

# tortoisehg - 用 Tortoise hg 克隆网站后如何删除网站？

> ID：12479397
> 
> 赞同：0
> 
> 时间：2012-09-18T14:45:02.790
> 
> 标签：tortoisehg

我已经使用 Tortoise hg 克隆了一个网站，但我现在需要删除它，因为它没有被使用。有什么建议么？使用 Tortoise Hg -> Remove files 我收到很多错误说：

“不删除 web\App_Data\TEMP\ClientDependency\1_ab4e3f1d41ae436d8fd9abaaa7f06b1e.cdJ：文件未跟踪”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:47:10.990

只需删除存储库的目录。整个存储库将被删除。

# url - 如何在安全性和便利性之间取得最先进的平衡来生成“私有 URL”？

> ID：12479398
> 
> 赞同：8
> 
> 时间：2012-09-18T14:45:09.503
> 
> 标签：url, security

我在哪里可以找到关于“私人 URL”的写得很好的、深入的技术讨论，比如在 Google Docs 的“知道链接的人”[共享设置](http://support.google.com/drive/bin/answer.py?hl=en&answer=2494886&p=visibility_options)中使用的那些？我正在寻找诸如生成链接的算法和实现、它使用的 ID 空间的大小、安全影响分析以及为方便起见在安全性方面的实用妥协等主题。我想避免阅读有关“默默无闻的安全”的教条。

我发现了一个[松散相关的 Stack Overflow question](https://stackoverflow.com/questions/4833314/are-secret-urls-truly-secure)，但它并没有深入探讨这个话题，而且答案比我想要的更教条，更不实用。

我在 Google Scholar 中搜索[“任何知道链接的人”](http://scholar.google.com/scholar?hl=en&q=%22anyone+with+the+link%22&btnG=&as_sdt=1%2C22&as_sdtp=)、[“秘密 URL”](http://scholar.google.com/scholar?as_ylo=2008&q=%22secret+url%22&hl=en&as_sdt=0,22)和[“私人 URL”](http://scholar.google.com/scholar?start=10&q=private+url&hl=en&as_sdt=0,22)。我发现了一些有趣的论文和专利，但我仍然有兴趣了解更多关于最先进技术的信息。[ [1](http://scholar.googleusercontent.com/scholar?q=cache:OhoYbR3facwJ:scholar.google.com/&hl=en&as_sdt=0,22&as_ylo=2008) ] [ [2](https://lirias.kuleuven.be/bitstream/123456789/272355/1/CW585.pdf) ] [ [3](http://www.google.com/patents/US6360254) ] [ [4](http://www.google.com/patents/US6718328) ] [ [5](http://www.google.com/patents/US6529956) ]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T15:51:06.970

我怀疑对这个问题缺乏回应主要反映了以下事实：1）问题空间非常细微，2）以前解决过问题的人不想谈论他们做了什么。我会努力逆势而上。:)

务实地说，以下变量往往会主导我所见过的对话：

*   如果用户手头有链接并将其转发给朋友，这是功能还是错误？
*   如果内容所有者想要撤消访问权限（即撤消链接），这应该有多容易？发生的频率是多少？
*   链接应该超时吗？如果有，多久之后？
*   我们在这里感到舒适的“线”在哪里？例如，如果它是一个文档的链接，只读就够了吗？它应该具有读写能力吗？考虑到威胁模型，我们的舒适度是否有限制？
*   链接应该可用的次数是否有限制？
*   我们是否关心链接是否漂亮，或者它们是否有一些丑陋的大斑点？
*   链接版本控制、后端服务以及可能导致重大更改的事物存在哪些类型的问题？
*   如果底层内容移动/链接发生变化，已经发送出去的私有链接是否应该中断？更一般地说，什么样的操作应该打破链接，以及应该有什么样的用户体验影响？
*   假设一个高技能的攻击者在你的链接之后，还有哪些其他防御措施可以防止对空间的猜测，以及你有什么仪器故事？然后，您将其与链接本身中的数学叠加，并说服自己您有一个威胁模型，可以猜测单个链接，并且成本模型非常昂贵。

在实现方面，我不知道这样做的论文或现成的实现。我参与过的每一个人（可悲的是，我参与过不止一个......）都是习惯性的。我可以在这里提出一组单一的权衡和评论，但我不确定这是否会有所帮助。每个人都会以不同的方式回答上面的问题。

我很高兴用更多数据对您的特定场景发表更多评论......

# java - 在 Java 中管理对 Web 控制器的访问的最佳方法是什么？

> ID：12479400
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:45:15.707
> 
> 标签：java, spring, security, spring-mvc, spring-security

我有一些问题。在 Java 中管理对 Web 控制器的访问的最佳方法是什么？例如，我有用户和项目。

每个用户可以有多个项目，但我不希望任何人都可以访问我的项目。我该如何管理它？通过在每个控制器中编写一些代码来检查权限？还是有一些框架？感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:00:42.840

[Spring Security](http://static.springsource.org/spring-security/site/index.html)可以帮助您。

# php - Laravel 组管理路由

> ID：12479402
> 
> 赞同：4
> 
> 时间：2012-09-18T14:45:23.660
> 
> 标签：php, laravel

有没有办法干净地将所有以 开头的路线分组`admin/`？我尝试过这样的事情，但它当然没有用：

```
Route::group('admin', function()
{
    Route::get('something', array('uses' => 'mycontroller@index'));
    Route::get('another', array('uses' => 'mycontroller@second'));
    Route::get('foo', array('uses' => 'mycontroller@bar'));
}); 
```

对应这些路线：

```
admin/something
admin/another
admin/foo 
```

我当然可以直接在所有这些路由前面加上前缀`admin/`，但我想知道是否可以按照*我的方式*来做。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-24T21:23:07.877

`Laravel 4`您现在可以使用`prefix`：

```
Route::group(['prefix' => 'admin'], function() {

    Route::get('something', 'mycontroller@index');

    Route::get('another', function() {
        return 'Another routing';
    });

    Route::get('foo', function() {
        return Response::make('BARRRRR', 200);
    });

    Route::get('bazz', function() {
        return View::make('bazztemplate');
    });

}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T00:38:39.903

抱歉不行。路由组并非设计为那样工作。这取自 Laravel 文档。

> 路由组允许您将一组属性附加到一组路由，从而使您的代码保持整洁。

路由组用于将一个或多个过滤器应用于一组路由。您正在寻找的是捆绑包！

# 推出捆绑包！

从外观上看，捆绑包是您所追求的。在您的 bundles 目录中创建一个名为 'admin' 的新捆绑包，并将其注册到您的 application/bundles.php 文件中，如下所示：

```
'admin' => array(
    'handles' => 'admin'
) 
```

句柄键允许您更改捆绑包将响应的 URI。**因此，在这种情况下，对admin**的任何调用都将通过该捆绑包运行。然后在你的新包中创建一个 routes.php 文件，你可以使用**(:bundle)**占位符注册处理程序。

```
// Inside your bundles routes.php file.
Route::get('(:bundle)', function()
{
    return 'This is the admin home page.';
});

Route::get('(:bundle)/users', function()
{
    return 'This responds to yoursite.com/admin/users';
}); 
```

希望能给你一些想法。

# c# - 通过 dotnet 通过 odbc 访问 oracle 存储过程

> ID：12479404
> 
> 赞同：0
> 
> 时间：2012-09-18T14:45:42.727
> 
> 标签：c#, .net, oracle, oracle10g

我把程序写成

```
CREATE OR REPLACE PROCEDURE proc_ss(cName IN PayRoll.Name%VARCHAR2(50)   
)
IS
BEGIN 
 insert into employees(Name) values(cName);
END; 
```

它通过 sql plus 执行时出现了一些编译错误。

我用于访问此过程的 c# 代码是

```
OdbcCommand cmdupd = new OdbcCommand("{call proc_ss(?)}", con);    
            cmdupd.CommandType = CommandType.StoredProcedure;
            cmdupd.Parameters.Add("Name", OdbcType.VarChar, 50).Value = Name;           
            cmdupd.ExecuteNonQuery();
            cmdupd.Dispose(); 
```

在运行上述查询时，我收到错误

```
System.data.odbcexception as:

ERROR [NA000] [Microsoft][ODBC driver for Oracle][Oracle]ORA-20003:
ERROR [42000] [Microsoft][ODBC driver for Oracle]Syntax error or access violation

Stack Trace as:

   at System.Data.Odbc.OdbcConnection.HandleError(OdbcHandle hrHandle, RetCode retcode)
   at System.Data.Odbc.OdbcCommand.ExecuteReaderObject(CommandBehavior behavior, String method, Boolean needReader, Object[] methodArguments, SQL_API odbcApiMethod)
   at System.Data.Odbc.OdbcCommand.ExecuteReaderObject(CommandBehavior behavior, String method, Boolean needReader)
   at System.Data.Odbc.OdbcCommand.ExecuteNonQuery()
   at payroll.BusinessAccessLayer.updating(Int32 id, String Name, String Phone, String Email, String Designation, String LevelID, String Username, String Password) in e:\payrollmanagement-oracle\source\Payroll\App_Code\BusinessAccessLayer.cs:line 103
   at employees.gridEmployees_RowUpdating(Object sender, GridViewUpdateEventArgs e) in e:\payrollmanagement-oracle\source\Payroll\employees.aspx.cs:line 118
   at System.Web.UI.WebControls.GridView.OnRowUpdating(GridViewUpdateEventArgs e)
   at System.Web.UI.WebControls.GridView.HandleUpdate(GridViewRow row, Int32 rowIndex, Boolean causesValidation)
   at System.Web.UI.WebControls.GridView.HandleEvent(EventArgs e, Boolean causesValidation, String validationGroup)
   at System.Web.UI.WebControls.GridView.OnBubbleEvent(Object source, EventArgs e)
   at System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args)
   at System.Web.UI.WebControls.GridViewRow.OnBubbleEvent(Object source, EventArgs e)
   at System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args)
   at System.Web.UI.WebControls.ImageButton.OnCommand(CommandEventArgs e)
   at System.Web.UI.WebControls.ImageButton.RaisePostBackEvent(String eventArgument)
   at System.Web.UI.WebControls.ImageButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)
   at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)
   at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
```

我不知道我被困在哪里......！

等待您的宝贵回复和意见..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:48:25.237

你`command Name`用 proc_ss调整

```
OdbcCommand cmdupd = new OdbcCommand("{ CALL proc_ss(?) }", con); 
```

你也调整你的参数

```
 cmdupd.Parameters.Add("@cName", OdbcType.VarChar, 50).Value = Name; 
```

# ruby-on-rails-3 - 本地化月份名称 simple_form rails

> ID：12479407
> 
> 赞同：2
> 
> 时间：2012-09-18T14:45:54.007
> 
> 标签：ruby-on-rails-3, date, datetime, internationalization, simple-form

我正在使用 simple_form 并且当输入是日期时，我会：

```
<%= f.input :start_date, :label => t('start_date'), :as => :date, :start_year => Date.today.year - 90,
                              :end_year => Date.today.year, :discard_day => true,
                              :order => [:month, :year] %> 
```

但是，月份名称对我的语言环境不正确。如何更改本地化文件以获得正确的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:42:30.987

您确实从[https://github.com/svenfuchs/rails-i18n/tree/master/rails/locale](https://github.com/svenfuchs/rails-i18n/tree/master/rails/locale)获得了标准的 Rails 语言环境？

# c# - 来自字符串的 IValueConverter

> ID：12479409
> 
> 赞同：2
> 
> 时间：2012-09-18T14:46:02.227
> 
> 标签：c#, wpf, binding, datatemplate, ivalueconverter

我有一个`Enum`需要显示在`ComboBox`. 我已经设法使用组合框获取枚举值，`ItemsSource`并且我正在尝试对它们进行本地化。我认为这可以使用值转换器来完成，但由于我的枚举值已经是字符串，编译器会抛出`IValueConverter`无法将字符串作为输入的错误。我不知道有任何其他方法可以将它们转换为其他字符串值。还有其他方法可以做到这一点（不是本地化而是转换）？

我正在使用这个 marku 扩展来获取枚举值

```
[MarkupExtensionReturnType(typeof (IEnumerable))]
public class EnumValuesExtension : MarkupExtension {
    public EnumValuesExtension() {}

    public EnumValuesExtension(Type enumType) {
        this.EnumType = enumType;
    }

    [ConstructorArgument("enumType")]
    public Type EnumType { get; set; }
    public override object ProvideValue(IServiceProvider serviceProvider) {
        if (this.EnumType == null)
            throw new ArgumentException("The enum type is not set");
        return Enum.GetValues(this.EnumType);
    }
} 
```

在 Window.xaml 中

```
<Converters:UserTypesToStringConverter x:Key="userTypeToStringConverter" />
....
<ComboBox ItemsSource="{Helpers:EnumValuesExtension Data:UserTypes}" 
            Margin="2" Grid.Row="0" Grid.Column="1" SelectedIndex="0" TabIndex="1" IsTabStop="False">
    <ComboBox.ItemTemplate>
        <DataTemplate DataType="{x:Type Data:UserTypes}">
            <Label Content="{Binding Converter=userTypeToStringConverter}" />
        </DataTemplate>
    </ComboBox.ItemTemplate>
</ComboBox> 
```

这里是转换器类，它只是一个测试类，还没有本地化。

```
public class UserTypesToStringConverter : IValueConverter {
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture) {
        return (int) ((Data.UserTypes) value) == 0 ? "Fizička osoba" : "Pravna osoba";
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) {
         return default(Data.UserTypes);
     }
} 
```

- 编辑 -

枚举由 ADO.NET Diagram 生成，不能更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:18:45.517

是的，当您将值传递给转换器时，它将成为`string`Enum (EnumConverter) 的默认类型转换器，因为`GetStandardValues`(ie `Enum.GetValues()`) 将字段的可枚举作为字符串返回。

解决此问题的最佳方法是编写自定义类型转换器来装饰您的枚举。幸运的是，您不是第一个需要此功能的人，请参阅下面的代码示例。

```
public class EnumTypeConverter : EnumConverter
{
    public EnumTypeConverter()
        : base(typeof(Enum))
    {
    }

    public EnumTypeConverter(Type type)
        : base(type)
    {
    }

    public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType)
    {
        return sourceType == typeof(string) || TypeDescriptor.GetConverter(typeof(Enum)).CanConvertFrom(context, sourceType);
    }

    public override object ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, object value)
    {
        if (value is string)
            return GetEnumValue(EnumType, (string)value);

        if (value is Enum)
            return GetEnumDescription((Enum)value);

        return base.ConvertFrom(context, culture, value);
    }

    public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)
    {
        if (value is Enum && destinationType == typeof(string))
            return GetEnumDescription((Enum)value);

        if (value is string && destinationType == typeof(string))
            return GetEnumDescription(EnumType, (string)value);

        return base.ConvertTo(context, culture, value, destinationType);
    }

    public static bool GetIsEnumBrowsable(Enum value)
    {
        var fieldInfo = value.GetType().GetField(value.ToString());
        var attributes = (BrowsableAttribute[])fieldInfo.GetCustomAttributes(typeof(BrowsableAttribute), false);

        return !(attributes.Length > 0) || attributes[0].Browsable;
    }

    public static string GetEnumDescription(Enum value)
    {
        var fieldInfo = value.GetType().GetField(value.ToString());
        var attributes = (DescriptionAttribute[])fieldInfo.GetCustomAttributes(typeof(DescriptionAttribute), false);

        return (attributes.Length > 0) ? attributes[0].Description : value.ToString();
    }

    public static string GetEnumDescription(Type value, string name)
    {
        var fieldInfo = value.GetField(name);
        var attributes = (DescriptionAttribute[])fieldInfo.GetCustomAttributes(typeof(DescriptionAttribute), false);
        return (attributes.Length > 0) ? attributes[0].Description : name;
    }

    public static object GetEnumValue(Type value, string description)
    {
        var fields = value.GetFields();
        foreach (var fieldInfo in fields)
        {
            var attributes = (DescriptionAttribute[])fieldInfo.GetCustomAttributes(typeof(DescriptionAttribute), false);

            if (attributes.Length > 0 && attributes[0].Description == description)
                return fieldInfo.GetValue(fieldInfo.Name);

            if (fieldInfo.Name == description)
                return fieldInfo.GetValue(fieldInfo.Name);
        }

        return description;
    }

    public override bool GetPropertiesSupported(ITypeDescriptorContext context)
    {
        return true;
    }

    public override StandardValuesCollection GetStandardValues(ITypeDescriptorContext context)
    {
        return base.GetStandardValues(context);
    }

} 
```

**用法**

```
[TypeConverter(typeof(EnumTypeConverter))]
public enum UserTypes : int
{
    [Browsable(false)]
    Unkown,    
    [Description("Local")]
    LocalUser,
    [Description("Network")]
    NetworkUser,
    [Description("Restricted")]
    RestrictedUser
} 
```

如您所见，上面的枚举我们使用`Description`属性来装饰每个字段，并使用用户朋友描述，并覆盖类型转换器以首先查找此属性。

不是 100%，但要让它与您的代码一起使用，您还需要将您的代码更改`MarkupExtension`为以下内容（注意：我尚未对此进行测试，因此需要您做一些工作）。

```
[MarkupExtensionReturnType(typeof (IEnumerable))]
public class EnumValuesExtension : MarkupExtension {

    public EnumValuesExtension() {}

    public EnumValuesExtension(Type enumType) 
    {
        this.EnumType = enumType;
    }

    [ConstructorArgument("enumType")]
    public Type EnumType { get; set; }

    public override object ProvideValue(IServiceProvider serviceProvider) 
    {
        if (this.EnumType == null)
            throw new ArgumentException("The enum type is not set");

        var converter = TypeDescriptor.GetConverter(this.EnumType);
        if (converter != null && converter.GetStandardValuesSupported(this.EnumType))        
            return converter.GetStandardValues(this.EnumType);

        return Enum.GetValues(this.EnumType);
    }
} 
```

此外，我只对应用程序进行了有限的本地化，但我相信这是最好和最可维护的方法，因为它能够利用现有的 .NET 本地化工具（例如卫星程序集）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:19:54.223

编辑：

您可以简单地在您的视图模型上添加一个返回`MyEnumType[]`并简单地返回的属性`MyEnumType.GetValues()`。然后在数据绑定点，您将有枚举值来引用而不是字符串值。

您指定的帮助程序类乍一看似乎很干净，但实际上并非如此 - 涉及很多杂乱无章的东西，并且您在视图中做出可能最好留给视图模型的决策。根据您对问题的看法，在视图模型中公开枚举值是有意义的。允许的值（即使是全部）可以被视为业务逻辑的一个方面，而不是视图的一个方面。

如果这还不足以解决问题，我的其余答案可能仍然对您有所帮助。

* * *

编辑前：

您可以通过简单地使用字符串资源来解决此问题，除了资源键通常在视图中进行硬编码。

所以我研究了是否有一种方法可以动态绑定字符串资源键，并找到了其他答案：

*   [如何在 MVVM 视图模型中指定资源？](https://stackoverflow.com/questions/1098527/how-can-i-specify-resources-in-an-mvvm-view-model)
*   [将 datacontext 字符串属性绑定到 StaticResource 键](https://stackoverflow.com/questions/695624/binding-a-datacontext-string-property-to-a-staticresource-key)

其中第二个似乎是一个干净而简单的选择。

在寻找的同时，我还发现了这篇博文：

*   [http://blog.functionalfun.net/2009/12/specifying-resource-keys-using-data_31.html](http://blog.functionalfun.net/2009/12/specifying-resource-keys-using-data_31.html)

这是他们示例中的代码。

看法：

```
<DataTemplate>
  <Button Command="{Binding}" Padding="2" Margin="2" Width="100" Height="100">
    <StackPanel>
      <Image HorizontalAlignment="Center"
             Width="60"
             app:ResourceKeyBindings.SourceResourceKeyBinding="{Binding Converter={StaticResource ResourceKeyConverter}, ConverterParameter=Image.{0}}"/>
      <TextBlock Text="{ext:ResourceKeyBinding Path=Name, StringFormat=Caption.{0} }" HorizontalAlignment="Center" FontWeight="Bold" Margin="0,2,0,0"/>
    </StackPanel>
  </Button>
</DataTemplate> 
```

资源：

```
<Application.Resources>
  <BitmapImage x:Key="Image.AngryCommand" UriSource="Angry.png"/>
  <BitmapImage x:Key="Image.CoolCommand" UriSource="Cool.png"/>
  <BitmapImage x:Key="Image.HappyCommand" UriSource="Happy.png"/>

  <sys:String x:Key="Caption.Angry">Angry. Rrrr!</sys:String>
  <sys:String x:Key="Caption.Happy">Happy. Ha ha!</sys:String>
  <sys:String x:Key="Caption.Cool">Chilled out</sys:String>
</Application.Resources> 
```

启用字符串资源键绑定的标记扩展：

```
public class ResourceKeyBindingExtension : MarkupExtension
{
    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        var resourceKeyBinding = new Binding()
        {
            BindsDirectlyToSource = BindsDirectlyToSource,
            Mode = BindingMode.OneWay,
            Path = Path,
            XPath = XPath,
        };

        //Binding throws an InvalidOperationException if we try setting all three
        // of the following properties simultaneously: thus make sure we only set one
        if (ElementName != null)
        {
            resourceKeyBinding.ElementName = ElementName;
        }
        else if (RelativeSource != null)
        {
            resourceKeyBinding.RelativeSource = RelativeSource;
        }
        else if (Source != null)
        {
            resourceKeyBinding.Source = Source;
        }

        var targetElementBinding = new Binding();
        targetElementBinding.RelativeSource = new RelativeSource()
        {
            Mode = RelativeSourceMode.Self
        };

        var multiBinding = new MultiBinding();
        multiBinding.Bindings.Add(targetElementBinding);
        multiBinding.Bindings.Add(resourceKeyBinding);

        // If we set the Converter on resourceKeyBinding then, for some reason,
        // MultiBinding wants it to produce a value matching the Target Type of the MultiBinding
        // When it doesn't, it throws a wobbly and passes DependencyProperty.UnsetValue through
        // to our MultiBinding ValueConverter. To circumvent this, we do the value conversion ourselves.
        // See http://social.msdn.microsoft.com/forums/en-US/wpf/thread/af4a19b4-6617-4a25-9a61-ee47f4b67e3b
        multiBinding.Converter = new ResourceKeyToResourceConverter()
        {
            ResourceKeyConverter = Converter,
            ConverterParameter = ConverterParameter,
            StringFormat = StringFormat,
        };

        return multiBinding.ProvideValue(serviceProvider);
    }

    [DefaultValue("")]
    public PropertyPath Path { get; set; }

    // [snipped rather uninteresting declarations for all the other properties]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:28:47.807

我使用通用资源转换器来执行此操作。您只需要指定要使用的资源管理器，并将前缀作为转换器参数传递：

```
class ResourceConverter : IValueConverter
{
    public ResourceManager ResourceManager { get; set; }

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (ResourceManager == null)
            throw new InvalidOperationException("The resource manager is not set");

        if (value == null)
            return string.Empty;
        string prefix = parameter as string ?? string.Empty;
        string resourceKey = prefix + value;
        if (string.IsNullOrEmpty(resourceKey))
            return string.Empty;

        return ResourceManager.GetString(resourceKey);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

假设你有一个这样的枚举：

```
class MyEnum
{
    Foo,
    Bar,
    Baz
} 
```

以及名为 MyEnum_Foo、MyEnum_Bar 和 MyEnum_Baz 的资源，您可以像这样使用它：

```
<Window.Resources>
    <my:ResourceConverter x:Key="resourceConverter" ResourceManager="{x:Static prop:Resources.ResourceManager}" />
</Window.Resources>

...

<Label Content="{Binding Converter=resourceConverter, ConverterParameter=MyEnum_}" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T17:18:40.760

您可能对以下博客文章中描述的 LocalizedList 类感兴趣：[http ://wpfglue.wordpress.com/2010/01/14/localized-value-formatting-in-wpf/](http://wpfglue.wordpress.com/2010/01/14/localized-value-formatting-in-wpf/)

它可用于定义枚举值的本地化翻译，同时定义它们的顺序。此外，它还为 ComboBoxes 提供了一个 ItemsSource，它允许在设置类型化枚举值的同时选择本地化的字符串项。

它是用 VB.net 编写的，但您应该可以轻松地将其转换为 C#，或者您可以使用包含二进制形式的库。

# php - 获取仅包含特定值的元素的新数组

> ID：12479414
> 
> 赞同：0
> 
> 时间：2012-09-18T14:46:30.307
> 
> 标签：php, arrays, multidimensional-array

我有以下数组：

```
$myArray
: array = 
  0: array = 
    0: string = 2012
    1: string = 1
    2: string = JOHN
  1: array = 
    0: string = 2012
    1: string = 2
    2: string = JOHN
  2: array = 
    0: string = 2012
    1: string = 3
    2: string = MARK 
```

我也有变量 $name。假设这次 $name 等于 JOHN

我必须做些什么才能拥有一个新数组，其中仅包含包含 JOHN 的元素，如下所示：

```
$myArray
: array = 
  0: array = 
    0: string = 2012
    1: string = 1
    2: string = JOHN
  1: array = 
    0: string = 2012
    1: string = 2
    2: string = JOHN 
```

太感谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:00:28.043

最简单的方法是将[array_filter](http://php.net/manual/en/function.array-filter.php)与自定义回调一起使用；在这种情况下使用闭包：

```
// $name is the variable containing 'JOHN'
$array2 = array_filter($array1, function($val) use ($name) {
   return $val[2] === $name;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:50:22.147

```
function search ($arr, $name){
    $result = array();
    foreach ($arr as $v) {
        if ($v[2] == $name)
            $result[] = $v;
    }
    return $result;
} 
```

此函数返回一个仅包含您想要的值的数组。

# php - 从数据库中删除记录时，我需要帮助从文件夹中删除图像

> ID：12479415
> 
> 赞同：3
> 
> 时间：2012-09-18T14:46:31.680
> 
> 标签：php, mysql, sql

我有一个表，将图像名称存储在表中，并将文件存储在服务器上的文件夹中。我想要做的是能够从数据库中删除记录，同时从服务器上的文件夹中删除其名称在表记录中的相应图像。任何帮助将不胜感激以下是代码：

```
if ((isset($_POST['hiddenFieldID'])) && ($_POST['hiddenFieldID'] != "")) {
  $deleteSQL = sprintf("DELETE FROM photodiary WHERE pdiaryID=%s",
                       GetSQLValueString($_POST['hiddenFieldID'], "int"));

  mysql_select_db($database_connMain, $connMain);
  $Result1 = mysql_query($deleteSQL, $connMain) or die(mysql_error());

  $deleteGoTo = "adphotodiary.php?user=" . $row_rsadmin['adID'] . "";
  if (isset($_SERVER['QUERY_STRING'])) {
    $deleteGoTo .= (strpos($deleteGoTo, '?')) ? "&" : "?";
    $deleteGoTo .= $_SERVER['QUERY_STRING'];
  }
  header(sprintf("Location: %s", $deleteGoTo));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:52:14.247

您将不得不执行 SELECT 查询来获取文件名并在服务器上检索其路径。然后您可以发送 DELETE 查询，如果成功，您将删除该文件。

```
if ((isset($_POST['hiddenFieldID'])) && ($_POST['hiddenFieldID'] != "")) {
  $getPathSql = sprintf("SELECT * FROM photodiary WHERE pdiaryID=%s",
                       GetSQLValueString($_POST['hiddenFieldID'], "int"));
  mysql_select_db($database_connMain, $connMain);
  $pathResult = mysql_query($getPathSql , $connMain) or die(mysql_error());
  $path = ...
  $deleteSQL = sprintf("DELETE FROM photodiary WHERE pdiaryID=%s",
                       GetSQLValueString($_POST['hiddenFieldID'], "int"));

  $Result1 = mysql_query($deleteSQL, $connMain) or die(mysql_error());
  if($Result1 && is_file($path)) unlink($path);

  $deleteGoTo = "adphotodiary.php?user=" . $row_rsadmin['adID'] . "";
  if (isset($_SERVER['QUERY_STRING'])) {
    $deleteGoTo .= (strpos($deleteGoTo, '?')) ? "&" : "?";
    $deleteGoTo .= $_SERVER['QUERY_STRING'];
  }
  header(sprintf("Location: %s", $deleteGoTo));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:51:04.913

您可以使用[unlink](http://php.net/manual/en/function.unlink.php)删除带有 php.ini 的文件。如果您将文件的位置传递给它，它将为您删除它，前提是 php 在文件所在的目录中具有正确的权限（有关权限，请参阅[chmod](http://hk2.php.net/manual/en/function.chmod.php)）。

因此，在您从数据库中删除文件后（检查以确保记录已被删除），您将继续在文件位置调用 unlink。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T16:09:06.320

非常感谢所有帮助过的人。抱歉，我之前没有更新，但我解决了这个问题。当然，在大家的帮助和一些进一步的阅读下。我所做的是首先定义目标，然后从浏览器请求中获取要删除的字段的 id，运行查询以根据 id 从数据库中选择字段记录，然后使用 php 中的 unlink 函数取消链接最初定义的目标文件夹中的图像。在此之后，然后继续从表中删除记录。

下面是代码。

```
$target = "../photodiary/";

if ((isset($_POST['hiddenFieldID'])) && ($_POST['hiddenFieldID'] != "")) {

    $imID = $_GET['pdid'];
            $query_pd  = "SELECT photo FROM photodiary WHERE pdiaryID = $imID";     
            $resulttt = mysql_query($query_pd) or die('Error, get image info failed. ' . mysql_error());
            $row = mysql_fetch_assoc($resulttt);

            if(($row['photo']) != "")
            {
                unlink($target . $row['photo']);
            }

  $deleteSQL = sprintf("DELETE FROM photodiary WHERE pdiaryID=%s",
                       GetSQLValueString($_POST['hiddenFieldID'], "int"));

  mysql_select_db($database_connMain, $connMain);
  $Result1 = mysql_query($deleteSQL, $connMain) or die(mysql_error());

  $deleteGoTo = "confirm_del.php?user=" . $row_rsadmin['aID'] . "";
  if (isset($_SERVER['QUERY_STRING'])) {
    $deleteGoTo .= (strpos($deleteGoTo, '?')) ? "&" : "?";
    $deleteGoTo .= $_SERVER['QUERY_STRING'];
  }
  header(sprintf("Location: %s", $deleteGoTo));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T14:51:52.113

你可以使用[unlink($pathtofile)](http://php.net/manual/en/function.unlink.php) php函数

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-18T14:52:54.390

你可以使用取消链接...例如

```
unlink('pathtofile'); 
```

# java - 一些ajax post请求的tomcat 2分钟超时

> ID：12479420
> 
> 赞同：2
> 
> 时间：2012-09-18T14:46:53.173
> 
> 标签：java, ajax, jboss, ajax4jsf, mod-jk

我在处理一些 AJAX POST 请求时遇到间歇性超时。设置：Apache 2.2.17 -> mod_jk 1.2.26 -> JBoss 4.3 CP01（带有 Tomcat 6.0）。应用程序使用 JSF 1.2_11、Seam 2.1、RichFaces 3.3.1 构建。

它通常发生在 IE 浏览器 (7,8,9) 上。浏览器发送一个 ajax 请求（RichFaces 为此生成 JavaScript 代码）。这个 HTTP POST 请求被 mod_jk 转换为 AJP Header 和 body 数据包并发送到 Tomcat。头包说内容长度为1760，但主体包的长度字段为0，没有内容。使用 tcpdump 捕获数据包。0 ajp 正文数据包不会发生在每个有问题的请求中。所有 ajax 请求/响应都很小，最多 30K，没有文件上传，也没有冗长的数据库查询。

在这个阶段，mod_jk 日志显示请求在 2 分钟内处理完毕。在我们的测试环境中，我们也得到了 2、3、4 和 6 分钟。包装请求的应用程序过滤器也显示 2 分钟时间；过滤器很简单——在请求之前和之后获取时间戳并记录差异。

调用应用程序的 JSF 阶段侦听器，每个阶段（请求、视图恢复、验证、调用、渲染）大约需要 100 毫秒 - 通常用于应用程序。因此超时必须发生在请求开始（过滤器之后和第一个 JSF 阶段之前）或结束（渲染 JSF 阶段之后和过滤器结束之前）之间。

有时，mod_jk 说客户端读取超时；谁是客户端 - 浏览器，apache？在 JBoss 中，在 DEBUG 级别没有记录异常。

有人遇到过类似的事情吗？mod_jk reply_timeout 设置不能解决问题。直接连接到 JBoss 会给我们带来大约 30 秒的超时，这是我们以前从未见过的，我们不知道它是否与 2 分钟的超时有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T11:17:31.293

我们在 IE 中遇到了这个问题：http: [//support.microsoft.com/kb/821814](http://support.microsoft.com/kb/821814)。我们的 KeepAliveTimeout 设置为 3 秒，来自服务器的响应有时会到达该边界，导致 Apache 在响应标头已发送后断开连接。

我们的解决方案是双重基础设施：外部客户端没有获得 KeepAlive，因为他们不需要 SSO 登录。Intranet 客户端现在转到不同的 Apache 服务器（因为 KeepAlive 是服务器范围的，而不是特定于虚拟主机的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-20T11:01:38.280

我们遇到了相同/相似的问题。我们注意到它正好是 5 分钟。我们使用的是 Tomcat 6/Apache AJP/Richfaces 3.3.3 Final。

我能够修改 apache 上的 httpd.conf 以获得一些满足感。

超时从 5 更改为 4 分钟，这导致“超时”变为 4 分钟超时而不是 5。所以我怀疑我在正确的轨道上。

接下来，我将 httpd.conf MaxKeepAliveRequests 从默认的 100 修改为 200，它大大减少了“4 分钟暂停”事件的数量。

编辑：

KeepAliveTimeout 从 10 秒增加到 40 秒 MaxKeepAliveRequests 设置为 0（无限制）

这似乎消除了我们的问题。显然，这些设置需要根据您服务器的流量类型/数量进行设置，但这对我们有用。

# squid - Squid，记录请求主机名

> ID：12479428
> 
> 赞同：1
> 
> 时间：2012-09-18T14:47:13.550
> 
> 标签：squid

我有一个可以从多个子域访问的 squid 服务器。我的问题是：**是否可以在访问日志中记录请求的主机名（即：来自 squid 服务器的主机名）**？

因此，例如，如果用户在“blahbla.example.com”或“blah.example.com”上执行代理请求，我希望在我的日志文件中看到这一点。

有人可以帮我吗？谢谢！

*PS：日志指令“<la”仅记录 IP4/6 编号。不是实际的主机名:(*

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2016-02-28T04:47:02.017

似乎完成此操作的唯一方法是使用[squid 日志分析器](http://www.squid-cache.org/Misc/log-analysis.html)，如果您不喜欢使用 Web 界面，它的 docroot 上也有原始日志。

我会推荐[LigthSquid](http://lightsquid.sourceforge.net/)。

# ipad - ipad互动动画故事——有哪些方法？

> ID：12479430
> 
> 赞同：1
> 
> 时间：2012-09-18T14:47:20.303
> 
> 标签：ipad, animation, uikit, core-animation

我最初是一名 java 程序员和 web 开发人员，但我希望进入 Objective C 开发。

我被要求为 iPad 做一个项目，一个为孩子们准备的动画互动故事。动画序列播放的地方，然后停止显示静态背景，上面有交互式对象 - 当点击时，这些交互式对象会动画一点，但会导致主要静态背景视图动画到新位置或只是淡入一个新的图像，上面再次有交互对象，当点击时会动画。

我不确定 Objective CI 的哪些部分需要关注。这是 Core Animation 还是 UIKit？

所有动画都将由动画师提供，我是否需要将每一帧加载到一个数组中以在代码中构建动画？或者说一个 20 秒的动画剪辑会不会太过分？

为新手倾斜道歉！

# java - 写入数据库时 的土耳其字符（postgresql）

> ID：12479436
> 
> 赞同：1
> 
> 时间：2012-09-18T14:47:22.477
> 
> 标签：java, postgresql, utf-8, character-encoding, turkish

我正在 Windows 上使用 Java 和 PostgreSQL。我有一些单词包括土耳其语字符，如 İ、ş、ö、ç 等。

在 Java 中，我将单词分配给字符串并尝试将其写入数据库。当我在 java 上打印它时，它的编码显示正确并且所有字符都正确显示。但是，在将其写入数据库时​​，文本似乎被破坏/打乱了。

我用这个命令创建了我的数据库：

```
CREATE DATABASE dbname ENCODING "UTF-8" 
```

我试图通过将土耳其字符转换为 ISO-8859-1 编码来修复它，例如 (İ -> \u0130 , ş -> \u015F)

```
//\u0130leti\u015Fim = İletişim
title = \u0130leti\u015Fim
String mytitle = new String(title.getBytes("ISO-8859-1"), "UTF-8"); 
```

然后我尝试写入`mytitle`数据库，但没有成功。

谢谢你的建议。

已解决：我意识到它可以将土耳其语字符写入数据库，但问题出在响应上。我在写回复之前添加了这些行。

```
String contentType= "text/html;charset=UTF-8";   
response.setContentType(contentType);
response.setCharacterEncoding("utf-8"); 
```

添加后，它现在可以工作了。我希望，我能解释清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T18:21:20.910

When you call `title.getBytes("ISO-8859-1")`, you're promising the Java runtime that the characters in the string *can* be represented as ISO-8859-1 bytes, which is not actually true for either \u0130 or \u015f. Therefore already the conversion to bytes will do something unspecified with your Turkish characters -- probably they will just be dropped.

Next, attempting to interpret whichever bytes you get out of it as UTF-8 even though they're really ISO-8859-1 is then guaranteed to make a complete mess of *everything* that wasn't ASCII to begin with.

(The repretoire of ISO-8859-1 happens to coincide exactly with the Unicode characters that can be written as \u00XX for some XX).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T00:10:57.647

对于编码问题，您需要检查几件事：

*   您的源文件是否采用您期望的编码。
*   如何`client_encoding`设置
*   数据库编码是什么

在 Java 的情况下，PgJDBC 要求`client_encoding`始终存在`UTF-8`，并且如果您将其设置为其他内容，它将阻塞，因此这不会成为问题。您已经证明您的数据库也是`UTF-8`如此。因此，您的 Java 源代码似乎与 Java 编译器和运行时所期望的编码不同。

默认情况下[`javac`，将在平台默认编码中解释您的源代码](https://stackoverflow.com/a/1726222/398670)。如果你以不同的编码保存你的源代码，就会发生奇怪的事情。保存您的来源：

*   在您的 Windows 平台的默认编码中；
*   作为 Unicode（“UTF-16”或“UCS-2”）；或者
*   作为带有*字节顺序标记 (BOM)*的 UTF-8 。许多程序不会为 UTF-8 添加 BOM。

然后重新编译你的程序。如果这没有帮助，您需要跟进更多细节，从“它不起作用”的*确切*`SELECT`含义开始，输出使用 Java 插入的数据`psql`等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-15T16:08:54.977

您应该像这样创建数据库：

```
CREATE DATABASE <db name> 
        WITH OWNER <owner user name>
    TEMPLATE template0 
    ENCODING 'UTF-8' 
    LC_COLLATE 'tr_TR.UTF-8' 
    LC_CTYPE = 'tr_TR.UTF-8'; 
```

# php - Symfony2：验证不是实体的对象

> ID：12479437
> 
> 赞同：1
> 
> 时间：2012-09-18T14:47:24.363
> 
> 标签：php, validation, symfony, craueformflow

我正在使用 CraueFormFlowBundle 拥有一个多页表单，并且正在尝试对某些字段进行一些验证，但无法弄清楚如何做到这一点。需要验证的对象不是实体，这给我带来了麻烦。

我尝试在我的表单类型类的 getDefaultOption 函数中添加一个 collectionConstraint，但这不起作用，因为我收到“类型数组或 Traversable 和 ArrayAccess 的预期参数”错误。我尝试在我的对象类中使用注释，但似乎没有考虑到它们。如果类不是实体，是否考虑注释？（我将 enable_annotations 设置为 true）

无论如何，这样做的正确方法是什么？基本上，我只想验证“年龄”是一个整数......

```
class PoemDataCollectorFormType extends AbstractType {
    public function buildForm(FormBuilder $builder, array $options) {
        switch ($options['flowStep']) {
            case 6:
            $builder->add('msgCategory', 'hidden', array(
                ));
            $builder->add('msgFIB','text', array(
                'required' => false,
            ));
            $builder->add('age', 'integer', array(
                'required' => false,
                ));
            break;
        }
    }
    public function getDefaultOptions(array $options)
    {
        $options = parent::getDefaultOptions($options);
        $options['flowStep'] = 1;
        $options['data_class'] = 'YOP\YourOwnPoetBundle\PoemBuilder\PoemDataCollector';
        $options['intention'] = 'my_secret_key';

        return $options;
    }
} 
```

编辑：添加代码，使用注释处理验证

作为 Cyprian，我很确定使用注释应该可以工作，但是它没有......这是我尝试的方法：

在我的控制器中：

```
public function collectPoemDataAction() {
    $collector = $this->get('yop.poem.datacollector');
    $flow = $this->get('yop.form.flow.poemDataCollector');
    $flow->bind($collector);
    $form = $flow->createForm($collector);
    if ($flow->isValid($form)) {
        ....
    }
} 
```

在我的 PoemDataCollector 类中，这是我的数据类（服务 yop.poem.datacollector）：

```
class PoemDataCollector
{
     /**
     * @Assert\Type(type="integer", message="Age should be a number")
     */

    private $age;
} 
```

编辑2：

这是服务实现：数据类（PoemDataCollector）似乎链接到流类而不是表单。这就是没有验证的原因吗？

```
 <service id="yop.poem.datacollector" class="YOP\YourOwnPoetBundle\PoemBuilder\PoemDataCollector">
    </service>
    <service id="yop.form.poemDataCollector"
            class="YOP\YourOwnPoetBundle\Form\Type\PoemDataCollectorFormType">
        <tag name="form.type" alias="poemDataCollector" />
    </service>
    <service id="yop.form.flow.poemDataCollector"
            class="YOP\YourOwnPoetBundle\Form\PoemDataCollectorFlow"
            parent="craue.form.flow"
            scope="request">
        <call method="setFormType">
            <argument type="service" id="yop.form.poemDataCollector" />
        </call>
    </service> 
```

如何在遵守 craueFormFlowBundle[指南](https://github.com/craue/CraueFormFlowBundle)的同时进行验证？

该指南规定：

```
Validation groups
To validate the form data class a step-based validation group is passed to the form type. By default, if getName() of the form type returns registerUser, such a group is named flow_registerUser_step1 for the first step. 
```

我应该在哪里声明使用这些验证组的约束..？

我试过：

```
YOP\YourOwnPoetBundle\PoemBuilder\Form\Type\PoemDataCollectorFormType:
    properties:
        name:
          - MinLength: { limit: 5, message: "Your name must have at least {{ limit }} characters.", groups: [flow_poemDataCollector_step1] }
        age:
          - Type:
               type: integer
               message: Please input a number
               groups: [flow_poemDataCollector_step6] 
```

但它没有被考虑在内。

编辑3：

好的，更好的是，名称验证似乎正在使用：

```
/**
 * @Assert\MinLength(limit=5, groups={"flow_poemDataCollector_step1"}, message="Your name must have at least {{ limit }} characters.")
 */
private $name; 
```

虽然消息没有出现...我已将 {{ form_errors(form.name) }} 和 {{ form_errors(form) }} 放入我的模板中...为什么不显示？

但：

```
/**
 * @Assert\Type(type="integer", groups={"flow_poemDataCollector_step6"}, message="Age should be a number")
 */

private $age; 
```

根本不工作...

编辑4：

好吧，我现在设法让我的验证工作了。但我找不到显示错误消息的方法。他们不应该在使用时显示：

```
{{ form_errors(form.name) }} 
```

或者

```
{{ form_errors(form) }} 
```

在我的模板中？就我而言，当验证失败时，我会返回表单中的同一步骤，但不会显示错误消息。此外，$form->getErrors() 返回一个空数组！如何处理错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:23:40.233

我没有对此进行测试，所以我不确定它是否会起作用，但是您可以在 buildForm 方法中执行以下操作。

```
 $builder->addValidator(new \Symfony\Component\Form\CallbackValidator(function(FormInterface $form) {
        $data = $form->getData();
        if (!is_int($data['age'])) {
            $form->addError(new \Symfony\Component\Form\FormError('Age must be an integer'));
        }
    })); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T16:32:22.533

您应该在与表单相关的类中定义约束。此类不必是实体。

一个应该工作的例子：

```
// your data class:
use Symfony\Component\Validator\Constraints as Assert;

class DataClass
{
    /**
     * @Assert\Type(type="integer", message="Age should be an integer")
     */
    public $age;

    (...)
} 
```

**编辑：**

此外，您需要将数据类对象传递给表单。例如。

```
$dataClassObject = new DataClass();
$form = $this->createForm(new SomeType(), $dataClassObject); // here is place where you put your data class object into form
$form->bindRequest($request);

// now validation should work
if ($form->isValid()) { 
    ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T01:32:43.697

所以这就是发生的事情：我没有呈现与正在验证的表单实例相同的表单实例......

我正在渲染我的页面`'form' => $flow->createForm($collector)->createView()`，将其更改为`'form' => $form->createView()`解决了我的问题：现在渲染了错误消息。

# php - mysql_query 返回非空数组

> ID：12479438
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:47:30.603
> 
> 标签：php, mysql, sql, wamp

我正在执行以下查询：

```
 if (isset ($_POST['valider']) ){
            $password=$_POST['password'];
            $login=$_POST['login'];

  $sql ='SELECT * FROM artisant WHERE pseudo="'.$login.'" AND password="'.$password.'"';
  echo $sql;

            $req = mysql_query ($sql) or die ('Erreur SQL !'.$sql.'<br />'.mysql_error());
            $nbr = count($req);
            echo $nbr;
            if(empty($req)){
            echo " <p>Incorrecte user name or password ! </p> ";
            }
            else {
            while ($data = mysql_fetch_array($req)) {
            $_SESSION['num']=$req['num'];
            $_SESSION['prenom']=$req['prenom'];
                        $_SESSION['nom']=$req['nom'];
                        $_SESSION['mail']=$req['mail'];
            $_SESSION['nbr_ventes']=$req['nbr_ventes'];
            $_SESSION['CA']=$req['CA'];
            }

            mysql_close();

            }

} 
```

并且我传递给查询的登录名和密码不正确（它们不存在于数据库中）但是返回的结果是一个非空数组（查询后 req 的大小为 1），因此它进入不应该进入的while循环，除非找到相应的登录名和密码。

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:02:01.267

`$req`是资源，而不是行。

`$nbr = count($req);`没有意义，请改用[mysql_num_rows](http://php.net/manual/en/function.mysql-num-rows.php)：

```
$nbr = mysql_num_rows($req);
if ($nbr == 0) { 
```

# php - PHP - 使用 multi_curl 进行并行处理是个好主意吗？

> ID：12479439
> 
> 赞同：2
> 
> 时间：2012-09-18T14:47:38.637
> 
> 标签：php, multithreading, curl, parallel-processing

我需要在 PHP 中进行并行处理，但是如果没有安装扩展，PHP 不支持它，所以我正在使用它`multi_curl`来实现这一点。

`main.php`- 构建一个 url 数组，它们都`process.php`具有不同的 $_GET 参数。然后使用 multi_curl 执行它们。

`process.php`- 每个线程的处理逻辑。

我只是想知道这是否是一种可行的做事方式。这是迟钝吗？它会导致很多开销吗？有没有更明智的方法来做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T15:32:00.703

[https://github.com/krakjoe/pthreads](https://github.com/krakjoe/pthreads)

PHP的线程...

享受 ...

要在 unix 中安装，您需要 PHP 的线程安全版本。大多数发行版不打包此版本，因此您必须自己构建它。

如何做到这一点的快速描述是：

```
cd /usr/src
wget  http://php.net/get/php-5.3.17.tar.bz2/from/us.php.net/mirror
tar -xf php-5.3.17.tar.bz2
cd php-5.3.17/ext
wget https://github.com/krakjoe/pthreads/tarball/master -O pthreads.tar.gz
tar -xf pthreads.tar.gz
mv krakjoe-pthreads* pthreads
cd ../
./buildconf --force
./configure --enable-maintainer-zts --enable-pthreads --prefix=/usr
make
make install 
```

我会从这个开始，用一个私有位置构建一个独立的副本--prefix，比如--prefix=/home/mydir，或者一些发行版有一个/usr/src/debug，这是一个很好的地方事物。您显然想要添加 --with-mysql 等，但如何做到这一点取决于您的系统（提示，您可以使用 php -i | grep configure > factory.config 来保存您当前的 php 安装配置行和基于您的自定义构建，知道它抱怨的任何库都不可用是 apt-get|yum install away ）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:49:23.983

当然，一般来说，这是一种可行的做事方式，这就是功能存在的原因。

一如既往，魔鬼在细节中。多个并发请求会与其他进程竞争并消耗服务器资源；您将需要调节并发程度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:49:34.860

考虑到 PHP 不以任何合理的方式支持多处理，multi_curl 在您的情况下似乎是一个很好的解决方案！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-06T10:17:31.747

如果您在 web 服务器上运行 PHP（并且 multi_curl 可能不可用），使其并行运行脚本的一种方法（没有库）是打开到 localhost:80 的套接字并手动使 web 服务器运行您想要的脚本。它们将使用服务器多线程并行运行。然后在一个循环中收集所有结果，当所有结果都完成后（或在您选择的超时后），您继续。

这是一段取自脚本的代码，该脚本检索网页上引用的所有图像的大小。

get_img_size.php 脚本检索一张图像的大小和信息。

$sockets[] 是一个数组，它为每个要测试的图像保留一个套接字。

```
 foreach($metaItems['items'] as $uCnt=>$uVal) {
            $metaItem=ContentLoader::splitOneNew($metaItems,$uCnt);
            $AnImage=$metaItem['url'];

            $sockets[$AnImage] = fsockopen($_SERVER['HTTP_HOST'], 80, $errno, $errstr, 30);
            if(!$sockets[$AnImage]) {
                echo "$errstr ($errno)<br />\n";
            } else {
                $pathToRetriever=dirname($_SERVER['PHP_SELF']).'/tools/get_img_size.php?url='.rawurlencode($AnImage);
                // echo('<div>META Retrieving '.$pathToRetriever.' on server '.$_SERVER['HTTP_HOST'].'</div>');
                $out = "GET $pathToRetriever HTTP/1.1\r\n";
                $out .= "Host: ".$_SERVER['HTTP_HOST']."\r\n";
                $out .= "Connection: Close\r\n\r\n";
                // echo($out);
                fwrite($sockets[$AnImage], $out);
                fflush($sockets[$AnImage]);
                // echo("<div>Socket open for $AnImage...</div>");
                // flush();
            }
        }
    }  else $FoundImagePaths2[]=$metaItems; // ALL of them urls belongs to us 
```

在此之后，您可以在“线程”继续工作的同时做自己的事情，然后，在一个循环中，您继续读取所有 $sockets[] 并测试 EOF。在示例中，在代码的后面（每个 $AnImage 都有一个循环）：

```
 if(isset($sockets[$AnImage])) {
                if(feof($sockets[$AnImage])) {
                    if(!isset($sizes[$AnImage])) $sizes[$AnImage]='';
                    $sizes[$AnImage].=fgets($sockets[$AnImage], 4096);

                    // echo("<div>HTML $AnImage DONE.</div>");
                    // echo("<div>[ ".$sizes[$AnImage]." ]</div>");
                    // flush();
                    fclose($sockets[$AnImage]);
                    unset($sockets[$AnImage]);

                    $mysizes=ContentLoader::cleanResponse($sizes[$AnImage]);

                    // echo($sizes[$AnImage]." ");
                    // echo(ContentLoader::cleanResponse($sizes[$AnImage]));

                    if(!is_array($mysizes)) {continue;}

                    if($mysizes[0]>64 && $mysizes[1]>64 && ($mysizes[0]>128 || $mysizes[1]>128))
                        $FoundImagePaths2[]=array('kind'=>'image','url'=>$AnImage,'ext'=>$ext,'width'=>$mysizes[0],'height'=>$mysizes[1],'mime'=>$mysizes['mime']); 
```

它在内存、进程和速度方面效率不高，但如果单个图像需要几秒钟，则包含 20 多个图像的整个页面需要同样的几秒钟来测试它们。毕竟，它在某种程度上是并行的 PHP。

# php - 如何在 PHP 中指定套接字客户端的端口？

> ID：12479452
> 
> 赞同：1
> 
> 时间：2012-09-18T14:48:32.113
> 
> 标签：php, sockets

我想将指定的端口绑定到 PHP 中套接字的 CLIENT 端。我可以这样做吗？这该怎么做？使用 socket_bind()？但我不知道应该为地址设置什么

我已经搜索了有关此问题的解决方案，但找不到示例/解决方案。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:50:58.463

看这里： http: [//php.net/manual/en/function.socket-bind.php](http://php.net/manual/en/function.socket-bind.php)

```
socket_bind ( resource $socket , string $address [, int $port = 0 ] ) 
```

所以像：

```
socket_bind($socket, 'localhost', 5555); 
```

当然，我不知道主机的地址是什么，可能不是localhost。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:56:00.260

如果您自己创建流，则可以这样做[`stream_context_create`](http://php.net/manual/en/function.stream-context-create.php)

您将需要使用[bindto](http://www.php.net/manual/en/context.socket.php)：

> 用于指定 PHP 将用于访问网络的 IP 地址（IPv4 或 IPv6）和/或端口号。语法是 ip:port。将 IP 或端口设置为 0 将让系统选择 IP 和/或端口。

所以：

```
$ctx = stream_context_create(array('socket'=> array('bindto' => "0:1234"))); 
```

然后使用您认为合适的上下文。

# .net - 将 Azure 网站连接到本地 WCF 服务

> ID：12479456
> 
> 赞同：1
> 
> 时间：2012-09-18T14:48:47.510
> 
> 标签：.net, wcf, azure

我希望构建一个混合应用程序，在该应用程序中，我通过 Azure 网站公开托管在本地、防火墙后面的特定 WCF 服务。Azure 网站将简单地调用我的 WCF 服务来获取和放置数据。

我曾认为 Azure Connect to an Azure Service to specific WCF services on-premise 有一种方法，但现在我已经将它安装在我网络上的沙盒机器上，我不确定情况是否如此。如果我可以将 Azure 和我的网络之间的连接锁定到我指定的那些 WCF 服务，我会更喜欢，以获得额外的安全性。

让我的 WCF 服务暴露给我的 Azure 网站的选项有哪些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:38:41.990

Azure 服务总线是你的朋友。您真正想要做的是启用服务总线中继，具体如下所述：

[http://www.windowsazure.com/en-us/develop/net/how-to-guides/service-bus-relay/](http://www.windowsazure.com/en-us/develop/net/how-to-guides/service-bus-relay/)

此外，您环境中的服务必须通过防火墙将自己暴露给服务总线。您可以在此处 (http://msdn.microsoft.com/en-us/library/windowsazure/ee706729.aspx) 找到一些方便的提示，尽管通常向服务总线注册的简单行为往往会为 NAT 和遍历您的基础设施。

服务总线支持多种中继绑定，如下所述：http: [//msdn.microsoft.com/en-us/library/windowsazure/hh410102.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh410102.aspx)。

我的博客上有一个关于 Service Bus 的演示文稿，示例代码有两个项目专门演示了中继。查看[http://www.stratospher.es/blog/post/slides-and-code-from-dallas-july-10-2012-windows-azure-cloud-summit](http://www.stratospher.es/blog/post/slides-and-code-from-dallas-july-10-2012-windows-azure-cloud-summit)并在那里下载示例代码。您想要的两个项目是“RelayDemoServer”和“RelayDemoClient”。示例代码在代码中配置继电器，但如果这更符合您的风格，您也可以通过配置来执行此操作。

简而言之，您基本上必须在服务器端（在您的基础结构中）为您想要的服务创建 WCF 端点，然后在服务总线中创建等效的中继绑定。一旦发生这种情况，您最终将获得内部端点的服务总线托管版本。它看起来像这样：

```
// create the host itself...
System.ServiceModel.ServiceHost host =
    new ServiceHost(typeof(ProblemSolver));

// programmatically add the endpoints

// 1\. the WCF endpoint "internally"
host.AddServiceEndpoint(
    typeof(IProblemSolver),
    new NetTcpBinding(),
    "net.tcp://localhost:9358/solver"
    );

// 2\. the endpoint that is projected back through the service bus (note: NetTcpRelayBinding)
// This one will end up with a DNS name of "sb://[serviceNamespace].servicebus.windows.net/solver"
host.AddServiceEndpoint(
    typeof(IProblemSolver), 
    new NetTcpRelayBinding(),
    ServiceBusEnvironment.CreateServiceUri("sb", Microsoft.WindowsAzure.CloudConfigurationManager.GetSetting("ServiceBusNamespace"), "solver"))
        .Behaviors.Add(new TransportClientEndpointBehavior
            {
                TokenProvider = TokenProvider.CreateSharedSecretTokenProvider("owner", Microsoft.WindowsAzure.CloudConfigurationManager.GetSetting("ServiceBusSecret"))
            });

host.Open(); 
```

然后，在客户端，您只需通过服务总线使用服务。看起来像这样：

```
var cf = new ChannelFactory<RelayDemoServer.IProblemSolverChannel>(
    new NetTcpRelayBinding(),
    new EndpointAddress(
        ServiceBusEnvironment.CreateServiceUri(
            "sb", 
            Microsoft.WindowsAzure.CloudConfigurationManager.GetSetting("ServiceBusNamespace"), 
            "solver"
            )
        )
    );

cf.Endpoint.Behaviors.Add(
    new TransportClientEndpointBehavior 
        { 
            TokenProvider = TokenProvider.CreateSharedSecretTokenProvider(
                "owner", 
                Microsoft.WindowsAzure.CloudConfigurationManager.GetSetting("ServiceBusSecret")
                ) 
        }
    );

using (var ch = cf.CreateChannel())
{
    Console.WriteLine(ch.AddNumbers(4, 5));
} 
```

秘诀是对 CreateServiceUri 的调用，它计算出 SB 托管的 URI。

希望这对您有所帮助，但如果您需要更多信息，请告诉我，

亚当霍夫曼

Windows Azure 博客 - [http://stratospher.es](http://stratospher.es)

推特 - [http://twitter.com/stratospher_es](http://twitter.com/stratospher_es)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:36:39.127

在那个级别，Azure 网站只是一个调用现场 WCF 服务的客户端，需要打开防火墙以允许适当的调用进出。

查看 Azure 服务总线，但它是基于消息的。

*   [服务总线](http://msdn.microsoft.com/en-us/library/windowsazure/ee732537.aspx)
*   [保护和验证服务总线连接](http://msdn.microsoft.com/en-us/library/windowsazure/dd582773.aspx)

# c++ - 如何用 clang 构建 clang？

> ID：12479458
> 
> 赞同：13
> 
> 时间：2012-09-18T14:49:09.603
> 
> 标签：c++, c, clang

我已经成功地使用 MSVC 和 MinGW 构建了 clang(3.2)。但我认为这不是“纯粹的”铿锵声。那么有人可以给我一些关于如何使用clang构建clang（Windows / Linux）的说明或材料吗？我们可以独立使用clang吗（不依赖于GCC或MSVC）。谢谢大家！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-19T16:12:47.333

那么得到一个像3.1这样的旧版本的clang。（您几乎可以安装为您的操作系统预编译的任何版本）

获取更新版本（如 3.2）的源代码。

然后（我喜欢 cmake+ninja（[http://clang.llvm.org/docs/HowToSetupToolingForLLVM.html](http://clang.llvm.org/docs/HowToSetupToolingForLLVM.html)））

如果你将 llvm 源解压到 ~/llvm_source/llvm

```
cd ~/llvm_source
mkdir build
cd build
CXX=clang++ CC=clang cmake -G Ninja ../llvm -DCMAKE_BUILD_TYPE=Release
ninja 
```

如果你想要它来制作

```
CXX=clang++ CC=clang cmake ../llvm -DCMAKE_BUILD_TYPE=Release
make 
```

就是这样。

玩得开心。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-27T06:29:25.010

当前的方法（截至 2017 年 2 月 27 日）似乎如下，

```
cmake -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++  $LLVM_SRC_DIR # -G Ninja 
```

其中 CMAKE_C_COMPILER 和 CMAKE_CXX_COMPILER 是由`-D`. 不知何故，这些变量没有出现在 llvm_src/CMakeLists.txt

# ruby-on-rails - 处理“工作时间”

> ID：12479460
> 
> 赞同：0
> 
> 时间：2012-09-18T14:49:18.603
> 
> 标签：ruby-on-rails, ruby-on-rails-3, date, time

我正在开发一个应用程序，该应用程序将跟踪用户的工作时间，然后根据这些数据生成图形......
考虑到他们今天可以开始任何任务并在明天完成，我无法保存`Date`.. . 到目前为止，我正在保存一个整数字段`hours`和一个整数`minute`......
有没有办法（也许是一些宝石）来帮助我处理这种问题？
还是有其他方法？
谢谢

我的课程`Atendimento`包含所有必要的数据

```
class Atendimento < ActiveRecord::Base
  attr_accessible :horas, :minutos, :empresa, :tipo_atendimento, :observacao, :empresa_id, :tipoatendimento_id

  belongs_to :empresa
  belongs_to :tipo_atendimento, :foreign_key => 'tipoatendimento_id'
  belongs_to :usuario

  validates :horas, :minutos, presence: true
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:01:36.930

我会在您的数据库中添加两个日期时间列来跟踪事件的开始和停止时间戳。然后你可以减去这两个值来得到经过的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:06:35.617

您应该将开始时间和结束时间添加为时间戳，而不是三个字段。您可以通过将这些行添加到迁移文件来做到这一点：

```
add_column :tasks, :started_at, :timestamp
add_column :tasks, :ended_at, :timestamp 
```

然后，您可以在模型中使用这些时间戳进行计算。

```
class Task < ActiveRecord::Base
  attr_accessible :started_at, :ended_at
  validates :started_at, presence: true
  validates :ended_at, presence: true

  # Returns the duration of the task in seconds
  def duration
    ended_at - started_at
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:10:06.600

我将工作时间保存为秒 :)

# c# - 使用 c# 和 opencl 的内存对象分配失败

> ID：12479467
> 
> 赞同：3
> 
> 时间：2012-09-18T14:49:31.490
> 
> 标签：c#, opencl

我正在编写一个图像处理程序，其目的是改变大图像，我正在使用的是 8165 像素 x 4915 像素。我被告知要实现 gpu 处理，所以经过一些研究，我决定使用 OpenCL。我开始实现 OpenCL C# 包装器 OpenCLTemplate。

我的代码采用位图并使用 lockbits 来锁定其内存位置。然后我将每个位的顺序复制到一个数组中，通过 openCL 内核运行该数组，并将数组中的每个位反转。然后我将反转的位运行回图像的内存位置。我把这个过程分成十块，这样我就可以增加一个进度条。

我的代码适用于较小的图像，但是当我尝试使用我的大图像运行它时，我在尝试执行内核时不断收到 MemObjectAllocationFailure。我不知道它为什么这样做，我将不胜感激任何帮助找出原因或如何解决它。

```
 using OpenCLTemplate;

    public static void Invert(Bitmap image, ToolStripProgressBar progressBar)
    {
        string openCLInvert = @"
        __kernel void Filter(__global uchar *  Img0,
                             __global float *  ImgF)

        {
            // Gets information about work-item
            int x = get_global_id(0);
            int y = get_global_id(1);

            // Gets information about work size
            int width = get_global_size(0);
            int height = get_global_size(1);

            int ind = 4 * (x + width * y );

            // Inverts image colors
            ImgF[ind]= 255.0f - (float)Img0[ind];
            ImgF[1 + ind]= 255.0f - (float)Img0[1 + ind];
            ImgF[2 + ind]= 255.0f - (float)Img0[2 + ind];

            // Leave alpha component equal
            ImgF[ind + 3] = (float)Img0[ind + 3];
        }";

        //Lock the image in memory and get image lock data
        var imageData = image.LockBits(new Rectangle(0, 0, image.Width, image.Height), ImageLockMode.ReadWrite, PixelFormat.Format32bppArgb);

        CLCalc.InitCL();

        for (int i = 0; i < 10; i++)
        {
            unsafe
            {
                int adjustedHeight = (((i + 1) * imageData.Height) / 10) - ((i * imageData.Height) / 10);
                int count = 0;

                byte[] Data = new byte[(4 * imageData.Stride * adjustedHeight)];
                var startPointer = (byte*)imageData.Scan0;

                for (int y = ((i * imageData.Height) / 10); y < (((i + 1) * imageData.Height) / 10); y++)
                {
                    for (int x = 0; x < imageData.Width; x++)
                    {
                        byte* Byte = (byte*)(startPointer + (y * imageData.Stride) + (x * 4));

                        Data[count] = *Byte;
                        Data[count + 1] = *(Byte + 1);
                        Data[count + 2] = *(Byte + 2);
                        Data[count + 3] = *(Byte + 3);
                        count += 4;
                    }
                }

                CLCalc.Program.Compile(openCLInvert);
                CLCalc.Program.Kernel kernel = new CLCalc.Program.Kernel("Filter");
                CLCalc.Program.Variable CLData = new CLCalc.Program.Variable(Data);

                float[] imgProcessed = new float[Data.Length];

                CLCalc.Program.Variable CLFiltered = new CLCalc.Program.Variable(imgProcessed);
                CLCalc.Program.Variable[] args = new CLCalc.Program.Variable[] { CLData, CLFiltered };

                kernel.Execute(args, new int[] { imageData.Width, adjustedHeight });
                CLCalc.Program.Sync();

                CLFiltered.ReadFromDeviceTo(imgProcessed);

                count = 0;

                for (int y = ((i * imageData.Height) / 10); y < (((i + 1) * imageData.Height) / 10); y++)
                {
                    for (int x = 0; x < imageData.Width; x++)
                    {
                        byte* Byte = (byte*)(startPointer + (y * imageData.Stride) + (x * 4));

                        *Byte = (byte)imgProcessed[count];
                        *(Byte + 1) = (byte)imgProcessed[count + 1];
                        *(Byte + 2) = (byte)imgProcessed[count + 2];
                        *(Byte + 3) = (byte)imgProcessed[count + 3];
                        count += 4;
                    }
                }
            }
            progressBar.Owner.Invoke((Action)progressBar.PerformStep);
        }

        //Unlock image
        image.UnlockBits(imageData);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T18:18:22.283

您可能已达到 OpenCL 驱动程序/设备的内存分配限制。[检查clGetDeviceInfo](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/clGetDeviceInfo.html)返回的值。单个内存对象的大小有限制。OpenCL 驱动程序可能允许所有分配的内存对象的总大小超过您设备上的内存大小，并在需要时将它们复制到主机内存或从主机内存复制它们。

要处理大图像，您可能必须将它们分成更小的部分，并分别处理它们。

# c# - SQLDependency -- 无效的 SQL

> ID：12479473
> 
> 赞同：3
> 
> 时间：2012-09-18T14:49:41.617
> 
> 标签：c#, sql-server, sql-server-2008, ado.net, sqldependency

从[这里](http://msdn.microsoft.com/en-us/library/ms181122%28SQL.105%29.aspx)我可以看出，我并没有打破这个查询的任何规则，但是 change 事件不断地以无效状态触发。

```
SELECT 
    COUNT_BIG([PK_Column]) AS RecordCount 
FROM 
    [dbo].[My_Table] 
GROUP BY 
    Varchar_50_Column 
```

如果我这样做，一切正常。

```
SELECT 
    [PK_Column]
FROM 
    [dbo].[My_Table] 
```

但是，我不想返回这么多数据，而且 SqlDependency 似乎需要在每次更改事件触发以设置（或重置）订阅后执行一次查询。

知道我的第一个查询中的缺陷是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:12:38.387

查看[**关于查询通知的特殊注意事项**](http://msdn.microsoft.com/en-us/library/aewzkxxh.aspx)如果您使用 group by 子句，您将不得不使用`COUNT_BIG(*)`. 在[**social.msdn 上**](http://social.msdn.microsoft.com/Forums/en-US/sqlservicebroker/thread/29f41a3e-85f6-4296-8c81-5b5907b5b2c2)，我发现另一个用户有类似/相同的问题 - 用这个语句解决它。

# javascript - Issues accessing an object's array values - returns null or 0s

> ID：12479475
> 
> 赞同：0
> 
> 时间：2012-09-18T14:49:43.453
> 
> 标签：javascript, arrays, json, dojo, arcgis

The function below should return an array of objects with this structure:

```
TopicFrequency = {
                name: "Chemistry", //This is dependent on topic
                data: [1,2,3,4,5,6,7,8,9,10,11,12] //This would be real data
            }; 
```

so when I do this:

```
myData = this.getChartData("line"); 
```

it should return two objects:

```
{name : "Chemistry", data : [1,2,3,4,51,12,0,0, 2,1,41, 31]}
{name : "Math", data : [0,0,41,4,51,12,0,0, 2,1,41, 90]} 
```

so when I do `console.log(myData);` it's perfect, returns exactly this.

However when I do `console.log(myData[0].data)` it returns all 0s, not the values. I'm not sure what this issues is known as, and my question is simple what is this problem known as?

Here is the full function. Somethings were hardcoded and other variables (notable server and queryContent) removed. Those parts worked fine, it is only when manipulated/retreiving the returned array's values that I run into problems. Note this is async. so not sure if that is also part of the problem.

```
getChartData: function (chartType) {     
    var TopicsFrequencyArray = new Array(); 
        timePairs = this.newIntervalSet("Month"); 
        topicList = new Array("Chemistry", "Math");//Hard coded for now
        var queryCopy = {
            //sensitive information
        };
        for (i = 0; i < topicList.length; i++) {
            var TopicFrequency = {
                name: null,
                data: this.newFilledArray(12, 0)
            };
            j = 0;
            TopicFrequency.name = topicList[i];

            while (j < timePairs.length) {
                queryCopy.filter = TopicFrequency.name;
                //additional queryCopy parameter changes made here
                var request = esri.request({ url: server, content: queryCopy, handleAs: "json", load: sucess, error: fail });
                j = j + 1;
                function sucess(response, io) {
                    var topicCountData = 0;
                    query = esri.urlToObject(io.url);
                    var dateString = query.query.fromDate.replace("%", " ");
                    dateString = dateString.replace(/-/g, "/");
                    dateString = dateString.split(".");
                    date = new Date(dateString[0]);
                    dojo.forEach(response.features, function (feature) {
                        if (feature.properties.count > 0) {
                            topicCountData = feature.properties.count;
                        }
                        TopicFrequency.data[date.getMonth()] = topicCountData;
                    });
                }
                function fail(error) {
                    j = j + 1;
                    alert("There was an unspecified error with this request");
                    console.log(error);
                }
            }
            TopicsFrequencyArray.push(TopicFrequency);

          }
}, 
```

# c - C how to free malloc'ed memory when program can encounter error and exit at different places?

> ID：12479476
> 
> 赞同：2
> 
> 时间：2012-09-18T14:49:43.193
> 
> 标签：c, memory-management, malloc, free

I'm struggling to come up with a clean way to handle my allocated memory in C. Suppose I have something like this:

```
void function(int arg) {
  char *foo;
  foo = (char *)malloc(sizeof(char) * 100);
  int i = func1(arg, &foo);

  char *bar;
  bar = (char *)malloc(sizeof(char) * 100);
  int j = func2(&bar);

  free(foo);
  free(bar);
} 
```

My problem is that `func1` and `func2` may encounter error and `exit(1)`, so I need to free `foo` and `bar` when that happens.

If `func1` encounters error, I just call `free(foo)` and I'll be good. But if `func2` encounters error, I cannot just call `free(bar)` since I also need to free `foo`. This can get really complicated and I feel that this is not the right way to handle memory.

Am I missing anything here? It will be awesome if someone can point me the right direction. Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:01:16.527

如果一个函数调用`exit`你根本不需要清理你的内存使用，它将被操作系统释放。但是如果您需要释放其他资源（例如锁定文件、清理临时文件...），那么您可以使用该[`atexit`](http://www.gnu.org/software/libc/manual/html_mono/libc.html#Cleanups-on-Exit)功能，或者如果您使用 gnu libc 该[`on_exit`](http://www.gnu.org/software/libc/manual/html_mono/libc.html#Cleanups-on-Exit)功能来完成这项工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T14:57:35.317

如果`func1()`或`func2()`将`exit(1)`在某些情况下调用，您不必担心释放内存，`foo`或者`bar`因为操作系统通常会在进程退出后进行清理。

只要您在正常执行过程中`free`在正确的时间（退出之前），您就可以很好地避免内存泄漏。`function`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:38:15.593

如果你把你的工作分成几个部分，管理你的资源会容易得多。

```
void part1(int arg) {
  char *foo;
  foo = (char *)malloc(sizeof(char) * 100);
  int i = func1(arg, &foo);

  free(foo);
}

void part2(void) {
  char *bar;
  bar = (char *)malloc(sizeof(char) * 100);
  int j = func2(&bar);

  free(bar);
}

void function(int arg) {
    part1(arg);
    part2();
} 
```

现在，如果需要，每个部分都可以`free`在退出之前使用其参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T15:23:17.903

I think so there can be a one simple approach to this problem.

Just maintain an allocCode throughout your program when allocating resources something like one given below. There are few keypoints to remember. First is that, don't you `break` statement in your switch case. Increment the allocCode, for every successful allocation of resource. For every resource added, you should add a case in the switch at the top, with one higher number. So calling the function `freeResourceBeforeExit()` will free all your resources in correct order. Remember that, since there is no break, the switch case will enter at the correct position and free all the resource which are below its entry point.

I will write the psuedo-code.

```
int allocCode = 0;

int freeResourceBeforeExit()
{
    switch(allocCode)
    {
        case 4:
           free(resource3);
        case 3:
           free(resource2);
        case 2:
           free(resource1);
        case 1:
           free(resource0);
    }
    exit(0);
}

int main()
{
   ...
   resource0 = malloc(10);
   allocCode++;
   func1();
   ...
   resource1 = malloc(100);
   allocCode++;
   func2();
   ...
   resource2 = malloc(1000);
   allocCode++;
   ...
   func3();
   ...
   resource3 = malloc(10000);
   allocCode++;
   func4();
   ... 
   so on..
} 
```

Hope this helps !

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T15:53:15.107

原则上，您*可以*`atexit`安装一个知道如何释放缓冲区的处理程序。处理程序将作为调用的结果被`func1`调用`exit`。使用起来不是很愉快——处理程序不带参数，这意味着您需要使用全局变量（或局部静态变量）来存储需要释放的东西。它不能被取消注册，这意味着您需要将这些全局变量设置为 null（或其他一些特殊值）以表明您已经自己释放了资源，但仍会调用处理程序。通常，您会将`atexit`处理程序用作挂起您自己的资源清理框架的“钩子”。

实际上，对于一些`malloc`ed 缓冲区来说，这通常太麻烦了，因为当程序退出时，功能齐全的操作系统无论如何都会释放进程保留的所有内存。

在退出之前释放内存甚至可能代价高昂 - 为了使用 释放每个分配`free`，内存将被触及，这意味着它需要从主内存甚至从交换拖到缓存中。对于可能需要一段时间的大量小分配。当操作系统为您执行此操作时，它只是取消映射进程的内存映射，并开始重新使用该地址空间/内存/交换空间以用于其他事情。清理有好处（例如，它使您的代码更容易重用，并且更容易找到真正的泄漏），但也有成本。

`func1`顺便说一句，调用错误是函数的反社会行为`exit`，因为正如您所发现的那样，它对函数的用户施加了限制。即使他们认为他们的程序可以/应该在失败的情况下继续进行，他们也无法恢复`func1`。`func1`实际上已经宣布该计划太重要了，甚至梦想在没有结果的情况下继续进行。是的，GMP，我的意思是你。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-09-18T14:54:53.063

一种处理方法：

```
void function() {
  int size = 100;
  char bar[size];
  char foo[size];

  // do stuff

  //compiler frees bar and foo for you
} 
```

# xcode - iphone app submission for iOS 6.0

> ID：12479478
> 
> 赞同：1
> 
> 时间：2012-09-18T14:49:48.697
> 
> 标签：xcode, store, submission

I have existing iphone app which is developed using XCode 4.2 and base sdk as iOS 5.0,Compiler is APPLE LLVM compiler 3.0. Now as the iOS 6 is upcoming am I supposed to (or rather ought to) rebuild this app with latest XCode and the base SDK (i.e. XCode 4.5, base sdk as iOS 6.0, Compiler :-Apple LLVM Compiler 4.1) or will I be OK submitting my upgrade with older XCode and base SDK settings? Will I be facing any issue while submitting my app built with older settings?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:53:49.337

如果您的应用程序在 iOS5 上运行良好并且您不需要来自 iOS6 的任何期货，那么就这样吧。iOS6 假设支持使用以前的 iOS 构建的应用程序。因此，这意味着您的应用程序应该可以工作。

# sql - Issue with returning distinct records based on single column (Oracle)

> ID：12479480
> 
> 赞同：0
> 
> 时间：2012-09-18T14:49:53.820
> 
> 标签：sql, oracle

If I have the table "members" (shown below), how would I go about getting the record of the first occurrence of a membership_id (Oracle).

**Expected results**

```
123                 John                      Doe                      A       P
313                 Michael                   Casey                    A       A
113                 Luke                      Skywalker                A       P 
```

**Table - members**

```
membership_id       first_name                last_name                status  type
123                 John                      Doe                      A       P
313                 Michael                   Casey                    A       A
113                 Luke                      Skywalker                A       P
123                 Bob                       Dole                     A       A
313                 Lucas                     Smith                    A       A 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:15:18.510

```
SELECT membership_id,
       first_name,
       last_name,
       status,
       type
  FROM( SELECT membership_id,
               first_name,
               last_name,
               status,
               type,
               rank() over (partition by membership_id
                                order by type desc) rnk
          FROM members )
 WHERE rnk = 1 
```

将适用于您的样本数据集。如果您可以有联系——即具有相同`membership_id`和相同最大值的多行`type`——此查询将返回所有这些行。如果您只想返回有平局的行之一，您需要向 中添加额外的条件以`order by`确保所有平局都被打破，或者您需要使用该`row_number`函数而不是`rank`任意打破平局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T05:31:24.367

```
select *
from members 
where rowid in (
    select min(rowid)
    from members
    group by membership_id
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:06:11.550

```
Select A.*
FROM Members AS A inner join
     (Select membership_id, first(first_name) AS FN, first(last_name) AS LN 
      From Members
      Group by membership_id) AS B
     ON A.membership_id=B.membership_id and A.first_name=B.FN and A.last_name=B.LN 
```

希望有帮助！

# jquery - Call to jQuery AJAX from firefox extension not working

> ID：12479481
> 
> 赞同：2
> 
> 时间：2012-09-18T14:49:54.747
> 
> 标签：jquery, ajax, firefox, firefox-addon, firefox-addon-sdk

Here is my code:

```
$.ajax({
          url: 'xxx',
          success: function(data) 
          {
             if (data.trim() == '0')
             {
                //IF CODE
             } 
            else
            {
              //ELSE CODE
            }
         }
    }); 
```

This code working fine everywhere where I want to use, but not working in case of Firefox extension.

I read the following stackoverflow articles but no avail: [Call to $.ajax from firefox extension not working](https://stackoverflow.com/questions/11608523/call-to-ajax-from-firefox-extension-not-working) and [Ajax In Firefox Plugin](https://stackoverflow.com/questions/2471666/ajax-in-firefox-plugin)

Also try to use [xmlHTTPRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest?redirectlocale=en-US&redirectslug=Using_XMLHttpRequest) but the result is same.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T12:23:23.560

您应该使用插件 sdk 提供的[请求模块](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/addon-kit/request.html)。您只能在附加脚本而不是内容脚本中调用和使用此模块。

如果您需要从内容脚本执行 ajax 请求，请使用内容脚本和插件脚本之间的通信。[您可以在此处](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/guides/content-scripts/index.html)找到文档。

如果你愿意，我有一个[代码示例](https://builder.addons.mozilla.org/package/153165/latest/)（我认为它可能很难阅读），但它可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-04T11:28:01.037

以防万一它可能对未来的其他人有所帮助，我想分享一个简单的 ajax 请求包装器。在大多数情况下，可以将相同的 jQuery Ajax 配置传递给函数。（但这不是一个完整的转换）。

```
function sendAjax(ajaxConfig) {
  var request = Request({
    url: ajaxConfig.url,
    contentType: ajaxConfig.contentType,
    content: ajaxConfig.data,
    headers: ajaxConfig.headers,
    onComplete: function(response){
      var data = response.json;
      if(!data)
        data = response.text;

      //console.log("Ajax complete", response.status, ajaxConfig.url, response.text);    
      if(ajaxConfig.complete){
        ajaxConfig.complete(data);

      }

      if(response.status >= 400){ //got error
        if(ajaxConfig.error){
          //console.log("Ajax error", response.status, ajaxConfig.url, response.text);
          ajaxConfig.error(data);
        }
      }
      else{ //success
        if(ajaxConfig.success){
          //console.log("Ajax success", ajaxConfig.url, response.text);
          ajaxConfig.success(data);
        }
      }

    }

  });

  switch(ajaxConfig.type){
    case "POST":
      request.post();
      break;
    case "PUT":
      request.put();
    case "DELETE":
      request.delete();
    default:
      request.get();
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-26T20:25:48.440

在 manifest.json 中，您应该将 url 添加到权限中：例如：

```
"permissions": [
    "tabs",
    "webRequest",
    "webRequestBlocking",
    "activeTab",
    "*://xxx/*"
], 
```

# css - Min-height and absolute positioning

> ID：12479482
> 
> 赞同：2
> 
> 时间：2012-09-18T14:49:55.763
> 
> 标签：css

I'm developing a mobile website that integrates horizontal swiping. Unfortunately this has created a headache when trying to get the rest of my website layout to work.

[http://jsfiddle.net/N7eWS/4/](http://jsfiddle.net/N7eWS/4/) - try resizing your browser window fairly small and you'll see the #footer (red) halfway down the content inside #wrapper (green). This appears to be todo with setting height:100% on most of the elements and then the absolute positioning applied to the horizontal swiping div (swipeview-masterpage-1).

I want it so that #wrapper expands to the height of the content, the #footer sits underneath #wrapper and is always off the bottom of the screen (you should have to scroll to see it).

Is there anyway I can make this work without touching (or perhaps making minor changes to) the swipeview divs? Any ideas would be appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T09:37:08.873

其中一个问题是`position: absolute`on `#swipeview-masterpage-1`，然后是另一个`absolute`问题。父绝对元素不会扩展到任何绝对定位子元素的高度（[示例](http://jsfiddle.net/YUdHA/1/)）。

您还有一个随机`<span>`元素，它是一个内联元素，无论如何高度都为 0。删除它以使事情更清楚。

现在来看看为什么你的页脚以一种奇怪的方式出现。您`#wrapper`将始终是父高度的 100%，您的页脚将始终存在于 100px（页眉）+ 100%。禁用该`min-height`属性，您将看到包装器折叠，并且页脚位于 100 像素处。这就是`#wrapper`内容与页脚重叠的原因。

# php - display categories and sub categories readmore page

> ID：12479483
> 
> 赞同：0
> 
> 时间：2012-09-18T14:50:02.527
> 
> 标签：php, mysql, show, categories

I'm beginner ( PHP & MySQL ) , I Have Problem With my Code In my website I created unlimited categories and subcategories - Table - >

```
 catid      catname       parentid

    1       |   animals   |     0
    2       |   vegs      |     0
    3       |   dog       |     1
    4       |   cat       |     1
    5       |   carrot    |     2 
```

I display this datatable in php nested 'ul' like (Code)->

```
 <?php 

    mysql_select_db($db_name, $conn); // Change for your database
    $query_Recordset1 = "SELECT * FROM categories";
    $Recordset1 = mysql_query($query_Recordset1, $conn) or die(mysql_error()); // Change for your database

    //get all rows

    while ( $row = mysql_fetch_assoc($Recordset1) )
    {
$menu_array[$row['catid']] = array('catname' => $row['catname'],'parentid' =>         $row['parentid']);

    }
    //recursive function that prints categories as a nested html unordered list

    function generate_menu($parent)

    {

    $has_childs = false;

    //this prevents printing 'ul' if we don't have subcategories for this category

    global $menu_array;

    //use global array variable instead of a local variable to lower stack memory requierment

    foreach($menu_array as $key => $value)

    {

            if ($value['parentid'] == $parent) 

            {       

                    //if this is the first child print '<ul>'                       

                    if ($has_childs === false)

                    {

                            //don't print '<ul>' multiple times                             

                            $has_childs = true;

                             //echo '<ul>';
    echo '<ul id="categories">';

                    }

                     echo '<li><a href="category.php?catname=' . $value['catname'] . '/">' . $value['catname'] . '</a>';
    echo '<input type="hidden" value="' . $value['catname'] . '" />';
                    generate_menu($key);

                    //call function again to generate nested list for subcategories belonging to this category

                    echo '</li>';

            }

    }

    if ($has_childs === true) echo '</ul>';

    }

    //generate menu starting with parent categories (that have a 0 parent)
    ?> 
```

Everything is good Showing No Problem .... My problem if click On main category get me There are no topics in this category yet. .... i need Code To select if User chose main category echo subcategory in main category -- If chose Subcategory just show data in subcategory Or If User chose main category echo ally topic in this main categories Example :: I have Category Photosession And sub category -> photosession april - photosession Septmber - photosession Jan - photosession Feb When i select the Main category photosession I need to show all sub category Or all topic in sub category in main category

*   Notice -> i select topic by catname

    ```
    echo '<li><a href="category.php?catname=' . $value['catname'] . '">' . $value['catname'] . '</a>'; 
    ```

This My Code to select Posts

```
 <?php
    $categories=$_GET['catname'];
    $sql = "SELECT * FROM categories WHERE catname='$categories' ";
    $result = mysql_query($sql);
    if(!$result){
    echo '<h1>The category could not be displayed, please try again later.</h1>' .         mysql_error();
    }else{
    if(mysql_num_rows($result) == 0){
    echo '<h1>This category does not exist.</h1>';
    }else{  
    while($row = mysql_fetch_assoc($result))
    {
    echo '<title>' . $row['catname'] . ' | E3rafly.com</title>';
    }
    ?>

    <?php
    $categories=$_GET['catname'];
    $sql = "SELECT  * FROM posts  WHERE categories='$categories' " or die         (mysql_error()); 
    $result = mysql_query($sql);
    if(!$result){
    echo '<h1>The topics could not be displayed, please try again later.</h1>';
    }else{
    if(mysql_num_rows($result) == 0)
    {
    echo '<h1>There are no topics in this category yet.</h1>';
    }else{  
    ?>

    <?php
    while($row = mysql_fetch_assoc($result)){   
    echo '
    <div class="span3 block">
    <div class="view view-first">
    <div class="tringle"></div>

    <a href="readmore.php?postid=' . $row['postid'] . '"><img src="admin/' . $row['thumbpath'] . '" title="' . $row['title'] . '" /></a>
    <div class="mask">
    <a href="admin/' . $row['imagepath'] . '" rel="prettyPhoto" class="info"></a>

    <a href="readmore.php?postid=' . $row['postid'] . '" class="link"></a>

    </div>
    </div>
     <div class="descr">
    <h4><a href="readmore.php?postid=' . $row['postid'] . '">',substr($row['title'],0,150),' ..</a></h4>
    <p>',substr($row['description'],0,200),'.</p>

     <div class="meta">
     <hr>

    <span class="meta_comment"><i class="icon-comment"></i> <strong>Comments:</strong><ahref="blog_single_i.html">11</a></span>
    <span class="meta_date"><i class="icon-calendar"></i>
    <strong>Date:</strong> <a href="readmore.php?postid=' . $row['postid'] . '">' .         $row['create_on'] . '</a></span>

    <div class="clearfix"></div>
    </div>
    </div>
    </div>

    ';
    }}}}}
    ?> 
```

I think My problem easy but i can't get idea to do it ... I need help Please .. !!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-12T18:51:32.970

这是显示类别和子类别的最佳答案

```
$con=mysqli_connect("localhost","root","","test");
$sql="select * from category where parent=0";
$result=mysqli_query($con,$sql);
echo "<ol>";
while($row=mysqli_fetch_array($result))
{
    echo "<li >".$row['name']."</li>";
    abc($row['id']);
}

function abc($id)
{
    global $con;
    $sql="select * from category where parent=$id";
    $result=mysqli_query($con,$sql);
    echo "<ol>";
    while($row=mysqli_fetch_array($result))
    {
        echo "<li>".$row['name']."</li>";
        abc($row['id']);
    }
    echo "</ol>";
}
echo "</ol>"; 
```

# c++ - x += a 比 x = x + a 快吗？

> ID：12479486
> 
> 赞同：85
> 
> 时间：2012-09-18T14:50:14.547
> 
> 标签：c++, performance, operators

我正在阅读 Stroustrup 的“The C++ Programming Language”，他说有两种方法可以向变量添加内容

```
x = x + a; 
```

和

```
x += a; 
```

他更喜欢`+=`它，因为它很可能得到更好的实施。我认为他的意思是它也工作得更快。
但真的吗？如果它取决于编译器和其他东西，我该如何检查？

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2012-09-18T15:00:35.733

*只要语句真的很简单并且启用了优化*，任何称职的编译器都会为任何内置类型（ , 等）的两种构造生成完全相同的机器`int`语言`float`序列。（值得注意的是，默认模式 GCC 会执行*反优化*，例如将完全不必要的存储插入内存，以确保调试器始终可以找到变量值。）`x = x + a;` *`-O0`*

 **但是，如果语句更复杂，它们可能会有所不同。假设`f`是一个返回指针的函数，那么

```
*f() += a; 
```

只调用`f`一次，而

```
*f() = *f() + a; 
```

调用它两次。如果`f`有副作用，则两者之一将是错误的（可能是后者）。即使`f`没有副作用，编译器也可能无法消除第二次调用，因此第二次调用确实可能更慢。

由于我们在这里讨论的是 C++，所以对于重载的类类型`operator+`和`operator+=`. 如果`x`是这样的类型，那么——在优化之前——`x += a`转换为

```
x.operator+=(a); 
```

而`x = x + a`转换为

```
auto TEMP(x.operator+(a));
x.operator=(TEMP); 
```

现在，如果类被正确编写*并且*编译器的优化器足够好，那么两者最终都会生成相同的机器语言，但这并不像内置类型那样确定。这可能是 Stroustrup 在鼓励使用`+=`.

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-09-18T14:50:58.587

您可以通过查看拆卸进行检查，这将是相同的。

**对于基本类型**，两者都同样快。

这是由调试构建生成的输出（即没有优化）：

```
 a += x;
010813BC  mov         eax,dword ptr [a]  
010813BF  add         eax,dword ptr [x]  
010813C2  mov         dword ptr [a],eax  
    a = a + x;
010813C5  mov         eax,dword ptr [a]  
010813C8  add         eax,dword ptr [x]  
010813CB  mov         dword ptr [a],eax 
```

**对于用户定义的类型**，可以重载`operator +`和`operator +=`，这取决于它们各自的实现。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-19T03:48:05.127

是的！写起来快，读起来快，想出来也快，因为后者在`x`可能有副作用的情况下。因此，对于人类来说，它总体上更快。人力时间通常比计算机时间花费更多，所以这一定是您要问的。对？

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-09-18T18:09:39.853

`x = x + a`和之间的区别在于`x += a`机器必须经过的工作量 - 一些编译器可能（并且通常会）优化它，但通常，如果我们暂时忽略优化，会发生在前一个代码片段中，机器必须查找该值`x`两次，而在后一次中，此查找只需要发生一次。

然而，正如我所提到的，今天大多数编译器都足够智能，可以分析指令并减少所需的机器指令。

PS：堆栈溢出的第一个答案！

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-09-18T14:56:09.823

这实际上取决于 x 和 a 的类型以及 + 的实现。为了

```
 T x, a;
   ....
   x = x + a; 
```

编译器必须创建一个临时 T 来包含 x + a 的值，同时对其进行评估，然后将其分配给 x。（在此操作期间它不能使用 x 或 a 作为工作区）。

对于 x += a，它不需要临时的。

对于平凡的类型，没有区别。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-09-18T18:57:02.117

如果你说`+=`你让编译器的生活变得更轻松。为了让编译器识别它`x = x+a`与 相同`x += a`，编译器必须

*   分析左侧 ( `x`) 以确保它没有副作用并且始终引用相同的 l 值。例如，它可能是`z[i]`，并且它必须确保两者`z`都`i`不会改变。

*   分析右手`x+a`边`z[i] = a + *(z+2*0+i)`（

如果您的意思是添加`a`到`x`，那么当您说出您的意思时，编译器作者会很感激。这样一来，您就不会使用编译器的编写者*希望*他/她解决所有错误的部分，这*实际上*并没有让您的生活变得更轻松，除非您真的无法摆脱困境Fortran 模式。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-09-18T14:56:04.743

由于您已标记此 C++，因此无法从您发布的两个语句中知道。您需要知道“x”是什么（有点像答案“42”）。如果`x`是 POD，那么它不会有太大的不同。但是，如果`x`是一个类，则可能存在`operator +`和`operator +=`方法的重载，这些重载可能具有不同的行为，从而导致执行时间非常不同。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-09-18T18:35:53.313

你问错问题了。

这不太可能推动应用程序或功能的性能。即使是这样，找出问题的方法是**分析**代码并确定它如何影响您。与其在这个级别上担心哪个更快，**更重要**的是从清晰、正确和可读性的角度进行思考。

当您考虑到即使这是一个重要的性能因素，编译器也会随着时间的推移而发展时，尤其如此。有人可能会想出一个新的优化方法，今天的正确答案明天可能会变得错误。这是过早优化的经典案例。

这并不是说性能根本不重要……只是说这是实现性能目标的错误方法。正确的方法是使用分析工具来了解您的代码实际花费的时间，从而将您的工作重点放在哪里。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-09-18T19:52:28.470

举一个具体的例子，想象一个简单的复数类型：

```
struct complex {
    double x, y;
    complex(double _x, double _y) : x(_x), y(_y) { }
    complex& operator +=(const complex& b) {
        x += b.x;
        y += b.y;
        return *this;
    }
    complex operator +(const complex& b) {
        complex result(x+b.x, y+b.y);
        return result;
    }
    /* trivial assignment operator */
} 
```

对于 a = a + b 的情况，它必须创建一个额外的临时变量，然后复制它。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-09-18T19:30:49.123

我认为这应该取决于机器及其架构。如果它的架构允许间接内存寻址，编译器编写者可能只使用此代码（用于优化）：

```
mov $[y],$ACC

iadd $ACC, $[i] ; i += y. WHICH MIGHT ALSO STORE IT INTO "i" 
```

然而，`i = i + y`可能会被翻译成（没有优化）：

```
mov $[i],$ACC

mov $[y],$B 

iadd $ACC,$B

mov $B,[i] 
```

* * *

也就是说，`i`还应考虑其他复杂情况，例如 if 是返回指针的函数等。大多数生产级编译器，包括 GCC，为这两个语句生成相同的代码（如果它们是整数）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-09-18T14:52:22.753

不，两种方式的处理方式相同。**

# javascript - Window.innerwidth doesn't update on browser resize

> ID：12479494
> 
> 赞同：1
> 
> 时间：2012-09-18T14:51:04.013
> 
> 标签：javascript, html, resize, window, width

When i resize the window, the window.innerwidth doesn't update. I dont want to use jQuery.

```
var page = window.innerWidth;
var content = document.getElementById("content");
content.style.width = page - 300 + "px"; 
```

i tried:

```
window.addEvent("resize", function() {
  console.log(window.getCoordinates().width);
}); 
```

with no avail​</p>

Edit: But that still doesn't fix the window.innerwidth not changing on resize

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:57:24.127

它应该是：

```
window.addEventListener("resize", function() {
    console.log(window.innerWidth);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T22:56:35.317

此代码适用于我的浏览器：

```
<script>

    window.onresize = function() {    
        var widthWin = window.document.body.clientWidth;
        console.log(widthWin);         
    }

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:55:37.660

```
window.onresize = function(event) {
  console.log(window.innerWidth);
}; 
```

但只有在调整大小完成后才会调用它。

# jquery - 底部的 Jquery 自动完成附加链接

> ID：12479498
> 
> 赞同：5
> 
> 时间：2012-09-18T14:51:16.593
> 
> 标签：jquery, jquery-ui

我在我的网络项目中使用 jQuery 自动完成插件。我想显示 3 个元素，然后我想将“查看所有结果”链接附加到底部。![jQuery自动完成](../Images/8678a1c62f7bd4eaccb7ca7161b1bf89.png)

我尝试使用以下代码。

```
$( ".grid-search-box" ).autocomplete({
      minLength: 0,
      source: temp,
    focus: function( event, ui ) {
       $( ".grid-search-box" ).val( ui.item.value );
       return false;
     },
     select: function( event, ui ) {
        $( ".grid-search-box" ).val( ui.item.value );
          return false;
             }
    }).data( "autocomplete" )._renderItem = function( ul, item ) 
         {
        return $( "<li></li>" )
           .data( "item.autocomplete", item )
           .append( "<a><span class='" + item.status + "'></span>" + item.value + "</a>" )
        .appendTo( ul );
                        }; 
```

任何人都可以建议我，如何解决它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-18T15:19:05.043

这是演示，

[http://jsfiddle.net/muthkum/vqwBP/105/](http://jsfiddle.net/muthkum/vqwBP/105/)

我希望你能弄清楚如何实施。

**更新：** 我设法更新了您的代码，

```
$( ".grid-search-box" ).autocomplete({
      minLength: 0,
      source: function(request, response) {
        var results = $.ui.autocomplete.filter(temp, request.term);

        response(results.slice(0, 3)); //show 3 items.
    },
    open: function(event, ui) {
        $('.ui-autocomplete').append('<li><a href="javascript:alert(\'redirecting...\')">See All Result</a></li>'); //See all results
         },
    focus: function( event, ui ) {
       $( ".grid-search-box" ).val( ui.item.value );
       return false;
     },
     select: function( event, ui ) {
        $( ".grid-search-box" ).val( ui.item.value );
          return false;
    }
}).data( "autocomplete" )._renderItem = function( ul, item ) {
        return $( "<li></li>" )
           .data( "item.autocomplete", item )
           .append( "<a><span class='" + item.status + "'></span>" + item.value + "</a>" )
        .appendTo( ul );
}; 
```

演示：http: [//jsfiddle.net/muthkum/vqwBP/106/](http://jsfiddle.net/muthkum/vqwBP/106/)

# eclipse - Eclipse intermittent "cannot be resolved to a type" error

> ID：12479499
> 
> 赞同：3
> 
> 时间：2012-09-18T14:51:17.877
> 
> 标签：eclipse

I keep running into a strange intermittent issue with eclipse for the past few days where I will be editing code, save it, and then eclipse starts reporting hundreds (or sometimes thousands) of `MyClassName cannot be resolved to a type` errors. The errors are completely bogus as the classes do exist, and if I do a clean and rebuild on the entire workspace the issue goes away. This is the second workspace in a row that it has suddenly happened to.

Has anyone else ever run into this before? Is there some way to fix this issue without recreating an entirely new workspace (which is extremely frustrating). I'm not entirely sure what keeps happening to seemingly corrupt my workspaces.

[Update]

For clarification this is happening with multiple projects that are all Java (web application) projects using only the standard 'Java Builder.'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:02:17.177

调试 Eclipse 出错是一项痛苦的任务。我养成了重新安装它的常规习惯，可悲但真实。Eclipse 插件框架倾向于导致这些类型的交互。您没有提及 Eclipse 的版本以及它是 EE 还是标准版本。

因此，我建议您尝试全新安装 Eclipse。要尝试的另一件事是更改用于运行 Eclipse 的 JVM。最广泛使用和测试的 JVM 仍然是 Sun/Oracle Java6。

我使用标准版本的 Eclipse 获得了最好的结果，并且只根据需要添加了 EE 的东西，即 Web 开发人员工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T16:49:32.150

如果在安装了病毒扫描程序的 Windows 上发生这种情况，您可能需要尝试从按访问扫描程序中排除您的工作区目录。只要启用了 TrendMicro 病毒扫描程序，我有两个同事经常会遇到非常烦人（且不可重现）的构建错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-05T08:54:44.263

在 git merge 与多个冲突后，Eclipse Neon 发生在我身上，我解决了删除和重新导入我的项目的问题。

# asp.net - 在 ASP.NET 网站中保留引用

> ID：12479504
> 
> 赞同：1
> 
> 时间：2012-09-18T14:51:38.260
> 
> 标签：asp.net, .net, visual-studio-2010, visual-studio

我们有 VS2010、ASP.NET 4.0 网站（不是 Web 项目）。多个开发人员正在研究它。我需要这个站点来引用 AjaxControlToolkit.dll。因此，我将 AjaxControlToolkit.dll 签入到源代码管理中，然后右键单击网站，转到属性页、引用，单击添加，然后添加 AjaxControlToolkit.dll。

由于我的操作，AjaxControlToolkit.dll 被复制到网站的 BIN 文件夹中。所以，在我的机器上一切正常。但是，我在解决方案或项目文件中的任何地方都没有看到从网站引用 AjaxControlToolkit.dll 的记录。

由于我们没有将 BIN 文件夹或任何 .user 或 .suo 文件签入源代码管理，因此当另一个开发人员获取最新版本时，BIN 文件夹中缺少 AjaxControlToolkit.dll 并且他/她会收到错误，直到他/她添加DLL 到 BIN 文件夹。

有什么方法可以将 DLL 引用添加到网站并使该引用保留在不同的机器上？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:55:39.667

在我现在的公司，我们在项目中创建了一个名为“ReferencedAssemblies”的文件夹。所有外部（非 .NET）程序集都位于此文件夹中并从中引用。

这样，您还可以保证每当开发人员执行“获取最新”或部署项目时，都会出现对外部程序集的任何更新。

HTH。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T02:26:17.610

网站没有项目文件，您通常会在这些文件中找到引用，因此除了将程序集放在网站的 bin 或运行站点的机器的 GAC 中之外，您将无法引用程序集。

您将在网站中找到对程序集的唯一引用是 web.config 中的添加程序集标记、页面和用户控件中的注册标记以及 licenses.licx 文件（如果您使用需要许可的控件，例如 Infragistics） .

您的选择是将所有开发机器设置为已经拥有程序集或使用 WebApplicationProject 以便您可以添加包含程序集的文件夹并使用提示路径集或引用路径集添加对项目的引用在您的项目中，以便视觉工作室可以找到程序集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T07:36:53.087

您可以将引用的 DLL 存储在源代码控制的“参考”目录中，然后将其相对路径放在网站 /bin 文件夹中的 [dll 名称].refresh 文件中。还要控制 .refresh 文件的源代码。

每次 Visual Studio 编译您的 ASP.NET 网站时，它都会使用 .refresh 文件在“References”目录中查找 DLL 并将其复制到您的 /bin 文件夹中。

例如，如果您的网站引用 ThirdParty.dll，请像这样设置您的结构：

```
\References
    \ThirdParty.dll
\MySite
    \bin
       \ThirdParty.dll.refresh 
```

然后在 ThirdParty.dll.refresh 中有这一行

```
../../References/ThirdParty.dll 
```

# autohotkey - 使用自动热键在 Notepad++ 中模拟 Sublime Text 2 多选（多光标）

> ID：12479505
> 
> 赞同：2
> 
> 时间：2012-09-18T14:51:40.613
> 
> 标签：autohotkey

在 sublime text 2 中，您可以通过按住 ctrl+alt+箭头键（上/下）来多选（光标）行。在记事本++中，您可以通过按住 ctrl 并单击要编辑的其他行（区域）来完成相同的操作。我想我可以使用自动热键脚本来完成相同的功能。所以我尝试了

```
#IfWinActive, ahk_class Notepad++
^!Down::^Click 
```

但每次我尝试加载我得到的脚本

第 2
行文本错误：^单击
错误：此行不包含可识别的操作

程序将退出

然后我尝试了

```
#IfWinActive, ahk_class Notepad++
^!Down::send ^Click 
```

但这在记事本++中显示为ETXClick

我还需要什么才能让这个脚本仅适用于 Notepad++

**编辑**：似乎 autohotkey 无法在 Notepad++ IT 中模仿这种行为

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-26T13:44:13.863

您可以使用`Alt`+ `Shift`+ 箭头键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T06:11:46.147

改成：

```
#IfWinActive, ahk_class Notepad++
    ^!Down::Send, ^{Click}
#IfWinActive 
```

# jquery - 通过jquery分配的列表框的访问值

> ID：12479515
> 
> 赞同：-3
> 
> 时间：2012-09-18T14:52:12.423
> 
> 标签：jquery, asp.net

我正在通过 jquery 将值分配给列表框。在按钮单击事件上分配值后，我无法获取列表框中的项目。它显示空项目列表。我可以通过隐藏字段获取值，但是有更好的方法吗？

谢谢

**更新**

```
<script language="javascript" type="text/javascript">
$(function() {   
    $("#imgbtnRight,#imgbtnLeft").click(function(event) {
        var id = $(event.target).attr("id");            
        var selectFrom = id == "imgbtnRight" ? "[id*=lbAllStores]" : "[id*=lbIncludedStores]";            
        var moveTo = id == "imgbtnRight" ? "[id*=lbIncludedStores]" : "[id*=lbAllStores]";
        var selectedItems = $(selectFrom + " option:selected").toArray();
        $(moveTo).append(selectedItems);           
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:07:07.957

当页面回传到服务器时，DOM 的内容不会发送回 ASP .net。来自页面的唯一信息包含在`<input>`提交给服务器的表单元素（思考标签）中，例如隐藏字段。解决此问题的唯一其他方法是开始使用 ajax 将数据发送回服务器而不是回发。

# linq - LINQ 除了如何工作？

> ID：12479522
> 
> 赞同：38
> 
> 时间：2012-09-18T14:52:36.983
> 
> 标签：linq, except

> **可能重复：**
> [LINQ 在两个列表中查找差异](https://stackoverflow.com/questions/2404301/linq-find-differences-in-two-lists)

我想找到两个系列之间的区别。所以我`Except`在 LINQ 语句中使用。但`Except`似乎只有当第一个集合比第二个集合长时才有效。例如，即使 2 个集合不同，这也不会返回任何结果。

```
double[] numbers1 = { 2.0, 2.1, 2.2, 2.3, 2.4, 2.5 };
double[] numbers2 = { 2.2 };

IEnumerable<double> onlyInFirstSet = numbers2.Except(numbers1); 
```

任何人都可以确认是否是这种情况？如果是这样，我是否必须在编写查询之前检查集合长度，因为我不知道在编译时哪个集合会更大。

编辑

我想我的问题并不清楚。我不在乎哪个集合包含什么。我只想找到两个集合之间的区别。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-09-18T15:05:45.883

取自[101 个 LINQ 样本](https://docs.microsoft.com/en-us/samples/dotnet/try-samples/101-linq-samples/)：

```
int[] numbersA = { 0, 2, 4, 5, 6, 8, 9 }; 
int[] numbersB = { 1, 3, 5, 7, 8 }; 

IEnumerable<int> aOnlyNumbers = numbersA.Except(numbersB); 

Console.WriteLine("Numbers in first array but not second array:"); 
foreach (var n in aOnlyNumbers) 
{ 
    Console.WriteLine(n); 
} 
```

**结果**

第一个数组但不是第二个数组中的数字：0 2 4 6 9

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-18T15:05:34.823

> 例如，这不会返回任何结果...

这是正确的。

`2.2`存在于第一个集合中，因此没有什么可以返回。

它与数组的长度无关。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-18T15:25:02.520

其他答案告诉您如何从另一组中删除一组数字。阅读您的问题，我认为您想要第一个而不是第二个的内容，反之亦然：

```
var numbers1 = new [] { 2.0, 2.1, 2.2, 2.3, 2.4, 2.5 };
var numbers2 = new [] { 2.2, 2.8 };

var intersect = numbers1.Intersect(numbers2);
var diff = numbers1.Concat(numbers2).Except(intersect); 
```

# javascript - 在客户端存储身份验证数据

> ID：12479523
> 
> 赞同：0
> 
> 时间：2012-09-18T14:52:42.753
> 
> 标签：javascript, authentication, local-storage, client-side

我有一个使用 Backbone JS 呈现其视图的应用程序（以及模型等）。

我的应用程序的某些部分应该只显示给管理员用户，但是 Backbone 模板知道这一点的唯一方法是设置一些 JS 变量/localStorage/Cookie 来指示这一点。

当然，这里首先担心的是安全性。我只是在此处真正存储诸如 User.id、User.isAdmin 等内容。此外，由于仅限于管理员的事情将涉及服务器端的参与，`User.isAdmin = true`因此在客户端进行更改只会为他们提供界面选项，但没有任何权力。

我知道在这种事情上使用 Cookie 可能是不受欢迎的，并且有充分的理由，因为 Cookie 在所有 HTTP 请求中来回发送会产生不必要的开销。

因此我的问题是，我应该如何最好地告诉我的客户端应用程序有关用户身份验证数据的信息。我正在使用 jStorage (http://www.jstorage.info) 进行 localStorage 访问，但它不使用 SessionStorage。后者会比前者更合适吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:05:58.613

一般来说，您需要服务器上的角色和可能的特权。这样，即使恶意用户调整客户端，用户实际上也无法访问或修改受限数据，因为如果他们尝试，他们仍然没有修改服务器上的角色。如果您审核日志访问，您将很快知道用户是否尝试了他们没有权限的事情。

在这样的方案下可能发生的最糟糕的情况是用户可以看到管理屏幕的样子。这仍然可能是违规行为，因为他们可能会看到可以告知他们系统如何工作的按钮。

如果您需要保护它，您可以延迟加载应用程序“管理部分”的模板，直到验证用户角色之后。因此，所有受限部分几乎都作为单独的应用程序（或实际的单独应用程序）加载。这样，即使用户试图欺骗客户端加载管理部分，当请求发送到服务器时，您也不会返回模块，因为服务器不会显示用户具有管理员权限。

# c# - 从函数返回东西到bgWorker c#

> ID：12479527
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:52:46.883
> 
> 标签：c#, multithreading, forms

编辑以便更好地理解...

我有一个 Form1.cs 文件和一个单独的 Class.cs 文件。

在`Form1`我有一个调用 Class.myFunc() 的 bgWorker 中，它执行三个`foreach`循环，每个循环返回一些值，例如`string ClientName`、 或`string ClientOrder`。

我想将这些值从 Class.myFunc 返回到 bgWorker（在里面`Form1`，记住）并将它们插入到 ListView、Textbox 或其他任何东西中。

所以问题是：如何将字符串值从 Class.myFunc 返回到 BgWorker？

我希望有人可以帮助我解决这个问题...

Form1.cs

```
void bgWorker_DoWork(object sender, DoWorkEventArgs e)
{
    ControlsHelper.ControlInvike(listProcess, () => listProcess.Items.Add("Current").Name = "item1");
            myOtherClass cp = new myOtherClass();
            cp.myFunc();
} 
```

类.cs

```
public void myFunc()
{
    foreach (string Client in Clients)
    {
           // Do something
           // Return Client and insert into listview, richtextbox, W/E
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:55:41.570

您可以（ab）使用[`BackgroundWorker.ReportProgress`](http://msdn.microsoft.com/en-us/library/a3zbdb1t.aspx)它并将您的值作为第二个参数传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:23:18.153

扩展 Daniel Hilgarth 的回答：如果 BGW 不存在于上下文中，`Class.cs`您不能将其作为参数传递，以便您可以更新进度。在您的 DoWork 签名中，这`object sender`是您要转换为 BackgroundWorker 以发送到的 BGW `myFunc`。

所以你会有

```
public void myFunc(BackgroundWorker bgw)
{
    foreach (string Client in Clients)
    {
       // Do something
       // Return Client and insert into listview, richtextbox, W/E

       var returningObjects = List<string>();  //I assume this will be a list of strings based on your question.
       returningObjects.Add(ClientName);
       returningObjects.Add(ClientOrder);
       returningObjects.Add(Client3rdThing);

       bgw.ReportProgress(0,returningObjects)
    }
} 
```

甚至比使用泛型更好，`List<string>`您可以创建自己的类，其中包含您需要的所有项目，然后您可以显式调用它们而不是引用列表索引。

```
void bgWorker_DoWork(object sender, DoWorkEventArgs e)
{
    BackgroundWorker bgw = sender as BackgroundWorker;
    ControlsHelper.ControlInvike(listProcess, () => listProcess.Items.Add("Current").Name = "item1");
            myOtherClass cp = new myOtherClass();
            cp.myFunc(bgw);
} 
```

然后在您的 ProgressChanged 事件处理程序中

```
private void bgWorker_ProgressChanged(object sender,
    ProgressChangedEventArgs e)
{
   //Set the  e.UserState to whatever you need. It is of type Object.
    var returnedObjects = e.Userstate as List<string>;
    if(returnedObjects != null)
    {
        //do stuff with each of your returnedObjects[i];
    }

} 
```

为了确保线程安全，我使用[此](https://stackoverflow.com/a/788907/726127)扩展方法进行控件。将这个逻辑包含在扩展方法中真的很棒。每当您需要调用它时，您无需考虑 Invoke 结构，您只需调用它即可。

并确保在使用实例化 BackgroundWorker 时将它们联系在一起

```
bgWorker.ProgressChanged += new ProgressChangedEventHandler(bgWorker_ProgressChanged); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:05:34.447

首先，确保您确实需要多线程。在列表加载完成之前，您可能只需阻止 GUI 更新即可。

如果您确实需要多线程，请确保您的三个循环需要按该顺序运行。如果不是，那么您需要 3 个 bgWorkers 而不是 1 个。

最后，还有很多关于线程安全的好文章。你会发现你不能直接更新列表视图，你必须使用线程安全的委托。

# jsf-2 - 在数据表的单元格中显示一个列表中的所有内容

> ID：12479530
> 
> 赞同：0
> 
> 时间：2012-09-18T14:53:04.813
> 
> 标签：jsf-2, primefaces

实际上我通过列表提供了一个数据表。

我想在一个单元格中显示来自对象的另一个列表并显示所有内容。

我以前从未见过这种情况，有可能这样做吗？

任何人都可以给我一个帮助我的例子吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:09:24.647

您可以使用 ui:repeat 执行此操作，例如：

```
<p:column>
    <ui:repeat value="#{listElement.someList}" var="listElem">
        <h:outputText value="#{listElem} " />
    </ui:repeat>
</p:column> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:12:14.803

你可以用它 `<ui:repeat>` 来实现。

```
 <p:dataTable var="tab" value="#{list.l1}">
 <p:column>
       <ui:repeat value="#{accesslistin backing bean}" var="variable">
                      <h:outputText value="#{variable.watever}"/>
        </ui:repeat>
  </p:column>
 </p:dataTable> 
```

# java - java.lang.ClassNotFoundException：在 NetBeans 7.0.1 中部署时出现 com.sun.faces.config.ConfigureListener 错误

> ID：12479533
> 
> 赞同：6
> 
> 时间：2012-09-18T14:53:11.037
> 
> 标签：java, tomcat

我在 NetBeans 7.0.1 的 struts2 框架中有一个 Web 应用程序。它工作正常。但是突然Tomcat已经开始给出以下错误：

```
SEVERE: Error configuring application listener of class com.sun.faces.config.ConfigureListener
java.lang.ClassNotFoundException: com.sun.faces.config.ConfigureListener
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1676)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1521)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:415)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:397)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:118)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4660)
    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5226)
    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5221)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-29T16:26:20.397

有同样的问题。您可能使用 NetBeans 使用默认的“编译”范围自动添加此依赖项，它破坏了 tomcat：

```
 <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
    </dependency> 
```

使用此处提供的范围[https://stackoverflow.com/a/10156854/1051834](https://stackoverflow.com/a/10156854/1051834) 如果它不能帮助安装新的 tomcat 并再次重新部署您的项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-19T21:32:45.497

```
<dependency>
<groupId>com.sun.faces</groupId>
<artifactId>jsf-impl</artifactId>
<version>2.1.6</version> 
```

对我有用，您可以在发布新版本时更改版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T15:00:57.293

您的应用程序中缺少 jsf-implementation 库（它应该在应用程序的 WEB-INF\lib\ 目录中）。如果你是从 Netbeans 启动应用程序，这个库（jsf-impl.jar？）是在 Netbeans 项目的类路径中配置的，所以没有错误。

# c# - EmguCV 检测图像模糊度

> ID：12479535
> 
> 赞同：0
> 
> 时间：2012-09-18T14:53:17.313
> 
> 标签：c#, computer-vision, emgucv

我正在尝试使用 EmguCV 检测图像的模糊度。现在我正在尝试对灰色图像进行 FFT，但我被卡住了，因为我的程序在调用`CvInvoke.cvCopy`. 见下文：

```
 _capturedFrames.ForEach(x =>
 {
    using(var gray = x.Convert<Gray, float>())
    {
       IntPtr complexImage = CvInvoke.cvCreateImage(gray.Size, IPL_DEPTH.IPL_DEPTH_32F, 2);

       CvInvoke.cvSetZero(complexImage);  // Initialize all elements to Zero
       CvInvoke.cvSetImageCOI(complexImage, 1);
       CvInvoke.cvCopy(gray.Ptr, complexImage, IntPtr.Zero);
       CvInvoke.cvSetImageCOI(complexImage, 0);

       var dft = new Matrix<float>(gray.Rows, gray.Cols, 2);
       CvInvoke.cvDFT(complexImage, dft, CV_DXT.CV_DXT_FORWARD, 0);

       double min;
       double max;
       Point minLoc;
       Point maxLoc;
       dft.MinMax(out min, out max, out minLoc, out maxLoc);

       if (max > overallMax)
       {
          overallMax = max;
          index = _capturedFrames.IndexOf(x);
       }

       CvInvoke.cvReleaseImage(ref complexImage);
    }
 }); 
```

上面代码的目的是遍历内存中的图像集合并找到最清晰图像的索引。让我们假设上面的方法有效……这是检测最清晰图像的可靠方法吗？FFT 是否可靠用于此目的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:46:59.243

你们都想通了。请参阅下面的更正代码。注意 gray.NumberOfChannels 属性。

```
_capturedFrames.ForEach(x =>
 {
    using(var gray = x.Convert<Gray, float>())
    {
       IntPtr complexImage = CvInvoke.cvCreateImage(gray.Size, IPL_DEPTH.IPL_DEPTH_32F, gray.NumberOfChannels);

       CvInvoke.cvSetZero(complexImage);  // Initialize all elements to Zero
       //CvInvoke.cvSetImageCOI(complexImage, 1);
       CvInvoke.cvCopy(gray.Ptr, complexImage, IntPtr.Zero);
       //CvInvoke.cvSetImageCOI(complexImage, 0);

       var dft = new Matrix<float>(gray.Rows, gray.Cols, gray.NumberOfChannels);
       CvInvoke.cvDFT(complexImage, dft, CV_DXT.CV_DXT_FORWARD, 0);

       double min;
       double max;
       Point minLoc;
       Point maxLoc;
       dft.MinMax(out min, out max, out minLoc, out maxLoc);

       if (max > overallMax)
       {
          overallMax = max;
          index = _capturedFrames.IndexOf(x);
       }

       CvInvoke.cvReleaseImage(ref complexImage);
    }
 }); 
```

# c# - PdfPtable 缩小到页面

> ID：12479540
> 
> 赞同：0
> 
> 时间：2012-09-18T14:53:50.303
> 
> 标签：c#, vb.net, itextsharp

我目前正在使用 a `PdfPtable`，到目前为止一切都很好 - 但我有一个烦人的问题：有时一个表格高于一页，`PDFPtable`然后中断并且一些行在下一页上。

不幸的是，我目前正在为一个旧软件建模，它只是将表格缩小到适合一页。有谁知道如何实现这种行为？

简而言之：有没有办法在一页上保留表格？缩小表格而不是拆分表格。

到目前为止非常简单的代码：

```
Dim Mytables as List(Of DataTables)           
Dim doc As Document = Nothing            

doc = New Document(iTextSharp.text.PageSize.A4.Rotate, 1, 1, 1, 1)
Dim pdfw = PdfWriter.GetInstance(doc, New FileStream(PDFPath, FileMode.Create))
pdfw.SetFullCompression()
pdfw.CloseStream = True
mywriter = pdfw

for i=0 to myTables.count-1 

   Dim Table = New PdfPTable(myTables(i).Columns.Count) 

   Here comes a huge chunk of business logic. 
   doc.add(table)
   Doc.NewPage()
next. 
```

我试过`table.keeptogether=true`and `Table.SplitLate = True`，没有效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:33:19.443

您必须为添加到文档中的表格设置属性

```
//The code below creates a 2x2 table
Dim Table = New PdfPTable(2) 
Table.HorizontalAlignment = 0  //0=Left, 1=Center, 2=Right
Table.SpacingBefore = 10
Table.SpacingAfter = 10
Table.DefaultCell.Border = 0
Table.SetWidths(New Integer() { 1, 4 })
Table.AddCell(New Phrase("Content1"))
Table.AddCell(New Phrase("Content 2"))

Here comes a huge chunk of business logic. 
 doc.add(table)
 doc.NewPage() 
```

我希望这可以帮助你。

# android - 从 shell 启动壁纸服务

> ID：12479542
> 
> 赞同：1
> 
> 时间：2012-09-18T14:54:05.803
> 
> 标签：android, shell, service

我尝试了几种变体均无济于事：

```
am startservice android.service.wallpaper.WallpaperService
am startservice android.service.wallpaper
am startservice -n android.service.wallpaper/android.service.wallpaper.WallpaperService
am startservice -n android.service.wallpaper/.WallpaperService 
```

所有人都以如下方式回应：

```
Starting service: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] pkg=android.service.wallpaper.WallpaperService }
Error: Not found; no service started. 
```

我如何正确地告诉 android 启动这个特定的服务？

------------ 结束问题----------------

我为什么要这样做？

在 Nexus Q 上，墙纸管理器服务未运行。我有一个启动器正在运行，我可以从图库中选择一个壁纸，但是当它应用壁纸时，我在 logcat 中看到了这个：

墙纸管理器：“墙纸服务未运行”

我认为这要么是因为它完全被排除在 Q 之外，要么它从未开始。

为了解决这个问题，我想在具有工作壁纸的设备上手动启动服务 - 我的 Nexus 7。我想这样做只是为了确保我使用的是正确的命令，然后尝试手动启动服务在Q上，看看会发生什么。

# c# - 能否轻松更改 C# 编译器以让枚举类型实现通用 IEquatable`1 和 IComparable`1 接口？

> ID：12479548
> 
> 赞同：7
> 
> 时间：2012-09-18T14:54:31.890
> 
> 标签：c#, .net

假设我写了以下方法：

```
public static T Max<T>(T x, T y) where T : struct, IComparable<T>
{
  return (x.CompareTo(y) > 0) ? x : y;
} 
```

这很有效，可以找到两个值类型值中较大的一个。这是一个使用它的例子：

```
void Test(DateTime oneTime, DateTime anotherTime)
{
  var latestTime = Max(oneTime, anotherTime);
  ...
} 
```

但上述方法不适用于枚举。`Max(DayOfWeek.Thursday, DayOfWeek.Friday)`因此，由于约束（编译器：），例如将无法工作`"There is no boxing conversion from 'System.DayOfWeek' to 'System.IComparable<System.DayOfWeek>'."`。

当然也有变通办法。我可以使约束引用非通用接口，但这将涉及在调用中对to进行**装箱。**谁喜欢非通用 .NET 1 接口？`y``System.Object``CompareTo`

`DayOfWeek` **确实**实现了非泛型接口`IComparable`（通过`System.Enum`任何枚举类型的基类），但遗憾`DayOfWeek`的是没有实现`IComparable<DayOfWeek>`.

所以我的问题是：改变这种情况（在未来的 .NET 版本中）是否很难让 C# 声明像这样`enum MyFoo { ... }`给出一个实现`IComparable<MyFoo>`和的类型`IEquatable<MyFoo>`？

（当他们引入 .NET 2 时，即使是非泛型的，他们也能拥有一个`T[]`实现。我的“请求”似乎更容易（也是非泛型的，但用户定义的枚举是“真正的”类型）。）`IList<T>``System.Array``System.Enum`

# c# - 比较字符串列表中的字符串

> ID：12479549
> 
> 赞同：0
> 
> 时间：2012-09-18T14:54:31.640
> 
> 标签：c#

我正在读取一个包含 10002 行的文件，在每一行中都有一个我想与单个字符串进行比较的名称，如果这个字符串相同，我想将字符串文件添加到列表框中，我正在使用FILE.READLINE 然后将每一行添加到列表中，然后我使用 .CONTAINS 方法并且不适用于 == 但这也不起作用...有什么建议吗？

```
//This is my code:

foreach (string h in Directory.EnumerateFiles(NomDirec, "resume*"))
{
  this.listBox1.Items.Add(h);
  //Read Lines here and add them to a list and a listbox 
  var NombreLinea = File.ReadLines(h);
  foreach (var item in NombreLinea)
  {
    NombreAbuscar.Add(item).Remove(item.IndexOf(":"));
    this.listBox3.Items.Add(item);
  }

  //Here I want to add this file only if "NombreCompleto" is present in my resume file.
  foreach (string t in Directory.EnumerateFiles(NomDirec, "ESSD1*"))
  {
    string[] Nombre = File.ReadLines(t).ElementAtOrDefault(6).Split(':');
    string[] ApellidoPat = File.ReadLines(t).ElementAtOrDefault(7).Split(':');
    string[] ApellidoMat = File.ReadLines(t).ElementAtOrDefault(8).Split(':');
    string NombreCompleto = ApellidoPat[1] + ApellidoMat[1] + "," + " " + Nombre[1] + " " + ":";
    foreach (var item in NombreAbuscar)
    {
      if (NombreCompleto == item)
      {
        this.listBox1.Items.Add(t);
        break;
      }
    }
  } 
```

可能是一种只读取行的某个部分并将其添加到我的列表框的方法吗？

# php - 无法向mysql提交表单数据

> ID：12479550
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:54:32.430
> 
> 标签：php, mysql

我无法在 php 文件中获取 vars。Echo 什么都不返回，我无法进行查询。请帮我。我知道很少有愚蠢的错误，但我真的很累搜索它..

我有一个表格：

```
<form align="center" method="POST" action="saveuser.php">
<small>Choose person:</small>
<select name="user" id="user" size="1" onchange="loadUserData()">
    <option>Please select</option>
    <?php
        $con = mysql_connect('localhost', 'root', '');
        if (!$con) {
            die('Connection error: ' . mysql_error());
        }
        echo 'Connection Success';
        mysql_select_db("live", $con);

        $sql_query="SELECT name,id FROM res1";
        if(!mysql_query($sql_query, $con))
        {
            die('INSERT Error: ' . mysql_error());
        }
        $query = mysql_query($sql_query, $con);
        $max_row=0;

        while ($row = mysql_fetch_assoc($query)){
            if ($max_row !=0){
                echo "<option value={$row[id]}>{$row[name]}</option>";
            }
            $max_row=1;
        }

        mysql_close($con);
    ?>
</select></br>
<input id="id" type="hidden"/>
<small>Name: </small><input id="name" type="text" size="40" /> 
<small>Nat: </small><input id="nat" type="text" size="30" />
<small>Licence: </small><input id="licence" type="text" size="10" /></br>
<small>R1: </small><input id="r1" type="text" size="5" />
<small>R2: </small><input id="r2" type="text" size="5" />
<small>R3: </small><input id="r3" type="text" size="5" />
<small>R4: </small><input id="r4" type="text" size="5" />
<small>R5: </small><input id="r5" type="text" size="5" />
<small>R6: </small><input id="r6" type="text" size="5" />
<small>R7: </small><input id="r7" type="text" size="5" /></br>
<small>FO1: </small><input id="f1" type="text" size="5" />
<small>FO2: </small><input id="f2" type="text" size="5" />
<small>FO3: </small><input id="f3" type="text" size="5" /></br>
<button type="submit" name="submit">Save</button> 
```

和 php 文件 saveuser.php：

```
<?php
$con = mysql_connect('localhost', 'root', '');
if (!$con) {
    die('Connection error: ' . mysql_error());
}
//echo 'Connection Success';
mysql_select_db("live", $con);

$id = $_POST["id"];
$name = $_POST["name"];
echo $id;
echo $name;

$sql_query="UPDATE res1 SET name='".$name."' WHERE id='".$id."'";
//,nat,licence,r1,r2,r3,r4,r5,r6,r7,f1,f2,f3 FROM res1 WHERE id='$value'";
$query = mysql_query($sql_query, $con);

mysql_close($con);

//$URL="edit.php";
//header ("Location: $URL"); 
```

?>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T14:57:06.190

那是因为您没有设置字段的名称，`id`不会替换`name`：

```
<small>Name: </small><input name="name" id="name" type="text" size="40" /> 
<small>Nat: </small><input name="nat" id="nat" type="text" size="30" />
// etc ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T14:57:20.460

你没有给你的输入一个`name`属性。

您的`$_POST`数组将只包含那些的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T14:59:20.117

尝试输入提交

```
<input type="submit" value="Submit" /> 
```

然后关闭表格

并为输入命名

# google-drive-api - Google Drive/OAuth - 无法弄清楚如何获得可重复使用的 GoogleCredentials

> ID：12479551
> 
> 赞同：11
> 
> 时间：2012-09-18T14:54:32.190
> 
> 标签：google-drive-api, credentials

我已成功安装并运行[名为 DriveCommandLine 的 Google Drive 快速启动应用程序](https://developers.google.com/drive/quickstart)。我还对其进行了一些调整，以获取我的云端硬盘帐户中的一个文件的文件信息。

我现在想做的是以某种方式保存凭据并重新使用它们，而用户不必每次都访问网页来获取授权码。我已查看[此页面](https://developers.google.com/accounts/docs/OAuth2)，其中包含有关检索和使用 OAuth 2.0 凭据的说明。为了使用示例类 (MyClass)，我修改了 DriveCommandLine 中实例化 Credential 对象的行：

```
Credential credential = MyClass.getCredentials(code, ""); 
```

这会导致引发以下异常：

```
java.lang.NullPointerException
    at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:187)
    at com.google.api.client.json.jackson.JacksonFactory.createJsonParser(JacksonFactory.java:84)
    at com.google.api.client.json.JsonFactory.fromInputStream(JsonFactory.java:247)
    at com.google.api.client.googleapis.auth.oauth2.GoogleClientSecrets.load(GoogleClientSecrets.java:168)
    at googledrive.MyClass.getFlow(MyClass.java:145)
    at googledrive.MyClass.exchangeCode(MyClass.java:166)
    at googledrive.MyClass.getCredentials(MyClass.java:239)
    at googledrive.DriveCommandLine.<init>(DriveCommandLine.java:56)
    at googledrive.DriveCommandLine.main(DriveCommandLine.java:115) 
```

我已经研究了这些 API（Google Drive 和 OAuth）2 天了，但进展甚微。对于上述错误以及一般获取持久凭据的问题，我真的很感激。

整个结构对我来说似乎是不必要的复杂。有人愿意解释为什么我不能通过传入我的 Google 用户名和密码来创建一个简单的 Credential 对象吗？

谢谢，Brian O Carroll，爱尔兰都柏林

*** 更新 ***

好的，我刚刚解决了上述错误，现在我有了一个新错误。

我解决第一个问题的方法是修改 MyClass.getFlow()。我没有从 json 文件创建 GoogleClientServices 对象，而是使用了不同版本的 GoogleAuthorizationCodeFlow.Builder，它允许您直接以字符串形式输入客户端 ID 和客户端密码：

```
flow = new GoogleAuthorizationCodeFlow.Builder(httpTransport, jsonFactory, "<MY CLIENT ID>", "<MY CLIENT SECRET>", SCOPES).setAccessType("offline").setApprovalPrompt("force").build(); 
```

我现在遇到的问题是，当我尝试使用流（GoogleAuthorizationCodeFlow 对象）交换 Credentials 对象的授权代码时出现以下错误：

```
An error occurred: com.google.api.client.auth.oauth2.TokenResponseException: 400 Bad Request
{
  "error" : "invalid_scope"
}
googledrive.MyClass$CodeExchangeException
        at googledrive.MyClass.exchangeCode(MyClass.java:185)
        at googledrive.MyClass.getCredentials(MyClass.java:262)
        at googledrive.DriveCommandLine.<init>(DriveCommandLine.java:56)
        at googledrive.DriveCommandLine.main(DriveCommandLine.java:115) 
```

我应该为此使用其他范围吗？我目前正在使用 MyClass 提供的范围数组：

```
private static final List<String> SCOPES = Arrays.asList(
        "https://www.googleapis.com/auth/drive.file",
        "https://www.googleapis.com/auth/userinfo.email",
        "https://www.googleapis.com/auth/userinfo.profile"); 
```

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-18T15:15:02.550

我感觉到你的痛苦。我已经两个月了，仍然感到惊讶。

我的一些学习...

*   当您请求用户权限时，请指定“offline=true”。这将（“有时”原文如此）返回一个刷新令牌，它与具有受限权限的密码一样好。您可以存储它并随时重复使用它（直到用户撤销它）以获取访问令牌。

*   我的感觉是，Google SDK 与其说是帮助，不如说是阻碍。一个一个，我已经停止使用它们，现在直接调用 REST API。

*   最后一点，您可以（仅）使用 Google 客户端登录协议来访问上一代 API。但是，这已完全弃用，不久将被关闭。OAuth 旨在对本质上复杂的授权进行细粒度控制。因此，尽管我同意这很复杂，但我认为这不是不必要的。我们生活在一个复杂的世界:-)

你和我的经验表明，开发社区仍然需要一个整合的文档和方法来将这些东西放入我们的后视镜中，这样我们就可以专注于手头的任务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-21T08:45:26.930

Oath2Scopes 导入如下：

```
import com.google.api.services.oauth2.Oauth2Scopes; 
```

您需要在类路径中有 jar 文件“google-api-services-oauth2-v2-rev15-1.8.0-beta.jar”才能访问该包。可以在[这里](http://code.google.com/p/google-api-java-client/wiki/APIs#oauth2)下载。

不，我不知道如何在不必访问授权 URL 至少一次并复制代码的情况下获取凭据。我已经修改了[MyClass](https://developers.google.com/academy/apis/drive/drive-apps/auth/credentials)以从数据库中存储和检索凭据（在我的例子中，它是一个包含 userid、accesstoken 和 refreshtoken 的简单表）。这样，我只需获取一次授权代码，一旦获得访问/刷新令牌，我就可以重用它们来制作 GoogleCredential 对象。以下是我制作 GoogleCredential 对象的方法：

```
GoogleCredential credential = new GoogleCredential.Builder().setJsonFactory(jsonFactory)
            .setTransport(httpTransport).setClientSecrets(clientid, clientsecret).build();
    credential.setAccessToken(accessToken);
    credential.setRefreshToken(refreshToken); 
```

只需在上面输入您的 clientid、clientsecret、accessToken 和 refreshToken。

我真的没有太多时间来分离和整理我的整个代码以将其发布在这里，但如果您仍然遇到问题，请告诉我，我会看看我能做些什么。虽然，您实际上是在向盲人问路。我对整个系统的理解非常粗略！

干杯，布赖恩

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T11:56:11.163

好的，我终于解决了上面的第二个问题，我终于得到了一个带有访问令牌和刷新令牌的工作 GoogleCredential 对象。

**我一直试图通过修改MyClass**（管理凭据的那个）中的范围列表来解决范围问题。最后，我需要在我的**DriveCommandLine**修改版本（最初用于获取授权码的版本）中调整范围。我从 Oauth2Scopes 添加了 2 个作用域：

```
GoogleAuthorizationCodeFlow flow = new GoogleAuthorizationCodeFlow.Builder(
    httpTransport, jsonFactory, CLIENT_ID, CLIENT_SECRET,
    Arrays.asList(DriveScopes.DRIVE, Oauth2Scopes.USERINFO_EMAIL, Oauth2Scopes.USERINFO_PROFILE))
    .setAccessType("offline").setApprovalPrompt("force").build(); 
```

添加用户信息的范围允许我稍后在 MyClass 中获取用户 ID。我现在可以使用用户 ID 将凭据存储在数据库中以供重复使用（无需让用户每次都访问 URL）。我还按照 pinoyyid 的建议将访问类型设置为“离线”。

# php - 将两个数组放在一起然后插入数据库

> ID：12479555
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:54:53.050
> 
> 标签：php

我有这两个数组，它们都来自一些复选框选择，它们是：

```
$date=$_REQUEST['date'];
$pdv=$_REQUEST['checkbox']; 
```

第一个数组列出了一些日期，我需要遍历这些日期，并在数据库中插入为该日期选择的 pdv 值，例如：

```
[date] [1] => [pdv] [1]
           => [pdv] [2]
           => [pdv] [3]

[date] [2] => [pdv] [1]
           => [pdv] [2] 
```

然后我将有这个循环，它允许我插入数据库值：

```
 [date] [1] - [pdv] [1] ; [date] [1] - [pdv] [2]; 
```

我想过使用这个foreach，但我不是那么专业的php ..这里是我寻求你帮助的地方..

```
foreach($date as $val) {
foreach ($checkbox as $pdv) {
$values_arr[] = "('" . $val . "','" . $pdv . "')";
}
$values = implode(", ", $values_arr);

$sql="INSERT INTO date (att_id,date) VALUES $values";
mysql_query($sql)or die(mysql_error());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:02:32.470

这里有很多有用的功能，试试其中一些：

[http://php.net/manual/en/ref.array.php](http://php.net/manual/en/ref.array.php)

像这个：

[http://php.net/manual/en/function.array-combine.php](http://php.net/manual/en/function.array-combine.php)

并使用**print_r**查看结果数组：

```
<pre>
    <?php print_r($array) ?>
</pre> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:07:28.953

合并数组的一个好方法是使用

```
array_merge_recursive(); 
```

[http://ar2.php.net/array_merge_recursive](http://ar2.php.net/array_merge_recursive)

# apache - PDF 格式的 Apache 软件文档

> ID：12479559
> 
> 赞同：-1
> 
> 时间：2012-09-18T14:55:05.860
> 
> 标签：apache, pdf, documentation

我正在寻找 PDF 格式的各种 Apache 软件的文档，因此我可以离线阅读它们，例如在我的电子书阅读器上。我正在寻找 Velocity 和 CXF 的用户指南。任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:00:23.793

如果您的电子书阅读器有网络浏览器，您可以在 html 中创建一个本地镜像，并在 PDF 版本不可用时使用它。您可以为此使用 GPL 工具 wget：

> wget -mk -np [http://velocity.apache.org/engine/releases/velocity-1.5/user-guide.html](http://velocity.apache.org/engine/releases/velocity-1.5/user-guide.html)

wget 将以一致的方式保留所有链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T09:49:31.790

我终于使用了在线 PDF 转换器。结果并不完美，但它是可读的......

# svn - SVN 存储库中的骨架目录树

> ID：12479561
> 
> 赞同：2
> 
> 时间：2012-09-18T14:55:23.517
> 
> 标签：svn, cakephp

我需要在 SVN 中的文件夹上设置哪些属性以忽略文件夹树中的所有文件，除了一些命名的异常。我基本上希望将一个空文件夹树存储在存储库中，但出于 SVN 的目的，它们中的任何文件都将被忽略。

我们的 CakePHP 项目有一个 tmp/ 文件夹，其中包含 tmp/cache/ 和 /tmp/logs/ 我希望在签出项目时创建文件夹，但不希望通过 SVN 创建/管理其中的任何文件。

过去，我使用名为“.empty”的空文件作为占位符，以确保创建文件夹，但 SVN 与 CVS 的工作方式不同......

我可以在我们的 Eclipse 设置中看到资源过滤器——但我认为它们是 Eclipse 的东西，而不是 SVN/Subclipse 功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:06:44.510

您可以将一个添加`svn:ignore`到最低级别的目录（在这种情况下为日志和缓存）。我认为没有像`-f`这样的标志，因此您需要添加与单个文件 id 匹配的模式，您需要提交某些低级目录，但仍需要忽略更高级别的文件。

# sql - SQL子查询错误

> ID：12479562
> 
> 赞同：-2
> 
> 时间：2012-09-18T14:55:24.377
> 
> 标签：sql

错误在哪里？

```
SELECT * FROM papiry 
WHERE (aktivni=1 AND pocetovereni>1 ORDER BY pocetovereni DESC LIMIT1) 
AND oddeleni='$oddeleni' ORDER BY nazev ASC; 
```

感谢您的帮助，我不擅长 SQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:58:25.217

你有一个糟糕的 SQL，`ORDER BY`不是要在子句中输入的`WHERE`子句。一个潜在的优秀 SQl 看起来像这样：

```
SELECT * FROM papiry 
WHERE aktivni=1 
AND pocetovereni>1 
AND oddeleni='$oddeleni' 
ORDER BY ORDER BY pocet, overeni DESC, nazev ASC; 
```

但是，您必须决定要按哪些列排序。这是在 SQL 命令的末尾定义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:58:51.533

```
SELECT * 
FROM papiry 
WHERE (aktivni = 1 AND pocetovereni > 1) 
AND oddeleni='$oddeleni' 
ORDER BY 
     CASE WHEN ktivni = 1 AND pocetovereni > 1 THEN pocetovereni END DESC,
     CASE WHEN oddeleni='$oddeleni' THEN nazev END ASC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:01:33.763

Order By 必须出现在 WHERE 子句之后，这至少在 SQL Server 中有效：

```
SELECT * FROM papiry 
WHERE aktivni=1 AND pocetovereni>1 AND oddeleni='$oddeleni' 
ORDER BY pocetovereni DESC, nazev ASC 
```

# python - 给定一个 .torrent 文件，我如何在 python 中生成一个磁力链接？

> ID：12479570
> 
> 赞同：19
> 
> 时间：2012-09-18T14:55:38.803
> 
> 标签：python, bittorrent, magnet-uri

我需要一种将 .torrents 转换为磁力链接的方法。想要一种在python中这样做的方法。是否有任何图书馆已经这样做了？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-18T15:33:51.107

您可以使用从 BitTorrent 提取的[bencode](http://pypi.python.org/pypi/bencode/1.0)模块来执行此操作。

为了给你看一个例子，我从这里下载了一个 Ubuntu 的 torrent ISO：

```
http://releases.ubuntu.com/12.04/ubuntu-12.04.1-desktop-i386.iso.torrent 
```

然后，您可以像这样在 Python 中解析它：

```
>>> import bencode
>>> torrent = open('ubuntu-12.04.1-desktop-i386.iso.torrent', 'r').read()
>>> metadata = bencode.bdecode(torrent) 
```

磁体哈希仅根据 torrent 元数据的“信息”部分计算，然后以 base32 编码，如下所示：

```
>>> hashcontents = bencode.bencode(metadata['info'])
>>> import hashlib
>>> digest = hashlib.sha1(hashcontents).digest()
>>> import base64
>>> b32hash = base64.b32encode(digest)
>>> b32hash
'CT76LXJDDCH5LS2TUHKH6EUJ3NYKX4Y6' 
```

[您可以通过查看此处](http://www.linux23.com/torrent/ubuntu-12-04-1-desktop-i386-iso:14ffe5dd23188fd5cb53a1d47f1289db70abf31e)来验证这是否正确，您将看到磁铁链接是：

```
magnet:?xt=urn:btih:CT76LXJDDCH5LS2TUHKH6EUJ3NYKX4Y6 
```

如果要在磁铁 URI 中填写一些额外的参数：

```
>>> params = {'xt': 'urn:btih:%s' % b32hash,
...           'dn': metadata['info']['name'],
...           'tr': metadata['announce'],
...           'xl': metadata['info']['length']}
>>> import urllib
>>> paramstr = urllib.urlencode(params)
>>> magneturi = 'magnet:?%s' % paramstr
>>> magneturi
'magnet:?dn=ubuntu-12.04.1-desktop-i386.iso&tr=http%3A%2F%2Ftorrent.ubuntu.com%3A6969%2Fannounce&xl=729067520&xt=urn%3Abtih%3ACT76LXJDDCH5LS2TUHKH6EUJ3NYKX4Y6' 
```

# python - Python - 全局计数器

> ID：12479574
> 
> 赞同：4
> 
> 时间：2012-09-18T14:55:52.270
> 
> 标签：python

我递归地生成几个对象，这些对象需要一个连续的、唯一的 id。如何保证（最简单）python 2.7 中的同步。

```
iid = 1

def next_id():
    iid += 1
    return iid

def process():
    # .. do something
    id = next_id() 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-18T15:26:09.630

```
from itertools import count
iid = count()

print next(iid) # 0
print next(iid) # 1
print next(iid) # 2 
```

etc., and

```
new_iid = count(10)
print next(new_iid) # 10
print next(new_iid) # 11
print next(new_iid) # 12 
```

for starting at other values than 0.

`count()` is essentially a generator which infinitely yields values.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-18T14:57:24.280

使用[互斥锁](http://docs.python.org/library/threading.html#lock-objects)：

```
import threading
iid = 1
iid_lock = threading.Lock()

def next_id():
    global iid
    with iid_lock:
        result = iid
        iid += 1
    return result 
```

您可能希望隐藏类中的内部：

```
class IdGenerator(object):
    def __init__(self):
        self.cur_id = 1
        self.lock = threading.Lock()
    def next_id(self):
        with self.lock:
            result = self.cur_id
            self.cur_id += 1
        return result 
```

编辑：根据评论，您似乎没有使用线程。这意味着您根本不需要锁定机制。您最初编写的内容就足够了，尽管您需要`global`关键字来使全局变量可变：

```
iid = 1
def next_id():
    global iid
    res = iid
    iid += 1
    return res 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:24:22.937

你在想这样的事情：

```
 class Counter():
    def __init__(self):
        self.theCount = -1 
    def __call__(self):
        self.theCount += 1
        return self.theCount 

class BorgCounter():
    Borg = {'theCount':-1} 
    def __init__(self):
        self.__dict__ = BorgCounter.Borg 
    def __call__(self):
        self.theCount += 1
        return self.theCount 

myCount = Counter() 
mycount2 = Counter() 
assert(myCount()==0)
assert(mycount2()==0)
assert(mycount2()==1)
assert(myCount()==1)
assert(myCount()==2)

myCount = BorgCounter() 
mycount2 = BorgCounter() 
assert(myCount()==0)
assert(mycount2()==1)
assert(mycount2()==2)
assert(myCount()==3)
assert(myCount()==4) 
```

# twitter - 如何使用 c# 为 Twitter API 1.1 生成 OAuth 签名？

> ID：12479575
> 
> 赞同：3
> 
> 时间：2012-09-18T14:55:57.113
> 
> 标签：twitter, twitter-oauth

我正在开发一个应用程序，其中一部分是获取该应用程序的提及次数。我在 Twitter 上创建了一个应用程序，并为 REST API v1.1 GET statuses/mentions_timeline 生成了一个 OAuth 签名，并访问了提及时间线以获取计数 (https://api.twitter.com/1.1/statuses/mentions_timeline.json ）。我的问题是我们如何动态生成 oauth 签名来访问提及时间线并获取计数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T18:02:22.440

您可以编写自己的 OAuth 提供程序或使用现有库。以下是 Twitter 网站上的第 3 方库列表：

[https://dev.twitter.com/docs/twitter-libraries#dotnet](https://dev.twitter.com/docs/twitter-libraries#dotnet)

DotNetOpenAuth 很好，还有其他的。

如果您想自己编写，请查看 Twitter 的 OAuth 文档：

[https://dev.twitter.com/docs/auth/oauth](https://dev.twitter.com/docs/auth/oauth)

这是另一个很好的 OAuth 参考：

[http://hueniverse.com/oauth/](http://hueniverse.com/oauth/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:27:33.730

OAuth 实现不会随着新的（有争议的）Twitter API 而改变。您可以像使用 Twitter API 1.0 一样继续生成 OAuth 签名。

# http - Cache-Control s-maxage 标头是否覆盖浏览器缓存的 Expires 标头？

> ID：12479581
> 
> 赞同：4
> 
> 时间：2012-09-18T14:56:20.240
> 
> 标签：http, caching, http-headers, cache-control, http-caching

我想设置一个遥远的未来 Expires 标头以减少来自单个浏览器的请求。

我还想设置 Cache-Control: s-maxage=600 以便代理缓存（和 CDN）每 10 分钟重新验证一次原始内容。

尽管存在带有 s-maxage 指令的 Cache-Control 标头（据说取代了它），浏览器是否会尊重 Expires 标头？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-20T12:49:15.970

如果响应包含 Expires 和 Cache-Control max-age 指令，则 max-age 会覆盖 Expires 标头，即使 Expires 标头更具限制性。对于给定的响应，此规则允许源服务器向 HTTP/1.1 缓存提供比 HTTP/1.0 缓存更长的到期时间。

资料来源：[http ://condor.depaul.edu/dmumaugh/readings/handouts/SE435/HTTP/node24.html](http://condor.depaul.edu/dmumaugh/readings/handouts/SE435/HTTP/node24.html)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-07-05T15:59:43.050

如果两者都包含，则两者都将被检查，两者都没有优先级。Max-age 不会取代过期，它是额外的。

# elasticsearch - 仅存储选定的字段而不将 _all 存储在 pyes/elasticsearch

> ID：12479583
> 
> 赞同：1
> 
> 时间：2012-09-18T14:56:31.177
> 
> 标签：elasticsearch, pyes

我正在尝试将 pyes 与 elasticsearch 一起用作全文搜索引擎，我只存储 UUID 和字符串字段的索引，实际数据存储在 MonogDB 中并使用 UUID 检索。不幸的是，我无法创建不存储原始数据的映射，我尝试了“存储”/“源”字段的各种组合并禁用“_all”，但我仍然可以获得索引字段的文本。似乎文档在该主题上具有误导性，因为它只是原始文档的副本。

谁能提供一个只存储一些字段而不是原始文档 JSON 的映射示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:13:21.683

当然，你可以使用这样的东西（有两个字段，'uuid' 和 'body'）：

```
{
  "mytype" : {
    "_source" : {
      "enabled" : false
    },
    "_all" : {
      "enabled" : false
    },
    "properties" : {
      "data" : {
        "store" : "no",
        "type" : "string"
      },
      "uuid" : {
        "store" : "yes",
        "type" : "string",
        "index" : "not_analyzed"
      }
    }
  }
} 
```

# javascript - 如何根据选中的单选按钮创建登录字段属性

> ID：12479586
> 
> 赞同：1
> 
> 时间：2012-09-18T14:56:36.783
> 
> 标签：javascript

我有一个带有 2 个单选按钮“新帐户”和“现有用户”的登录页面。when "new account" is selected the "User" field auto populates with the text "New Account" and the "Password" field remains blank. 我需要将这些字段变灰，以便在选择“新帐户”单选按钮时它们不可编辑，但仍然传递字段中的信息，因为它用于访问数据库。我可以禁用字段以获取所需的不可编辑的灰色字段，但信息不会传递到数据库。

我试图通过创建两个隐藏字段（自动填充数据库访问所需的信息）来代替“用户”和“密码”字段来解决这个问题，这允许我在“新帐户”时禁用可见字段单击单选按钮，它仍然传递永远不会改变的新用户登录信息。这工作正常，直到我尝试以现有用户身份登录，在这种情况下，我的两个隐藏字段不会自动填充用户输入的现有帐户信息。

解决这个问题可能有更简单的方法，但我所有的研究和试验还没有成功。我一直不愿意问这个问题，因为它看起来是如此简单和常用的登录页面方法，但我所有的搜索都没有产生任何有效的东西。我很欣赏任何正确方向的输入或导航。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:02:31.533

我很确定针对您的问题的正确且无痛的解决方案是使用**两个**不同的表单标签（注意不要嵌套它们）并根据所选单选按钮显示/隐藏表单。

为了方便您的用户，如果他已经填写了用户字段并稍后切换到另一个版本，您应该将用户名从一个表单复制到另一个表单。

**编辑**

完整的解决方案：

*HTML*

```
<label><input class="formSwitcher" type="radio" name="formSwitch" data-form="#divForm1"> Form 1</label>
<label><input class="formSwitcher" type="radio" name="formSwitch" data-form="#divForm2"> Form 2</label>

<hr>    

<div class="hiddenForm" id="divForm1">Put form 1 in here</div>
<div class="hiddenForm" id="divForm2">Put form 2 in here</div> 
```

​​​​​​​​​​​​​​<em>JS

```
// if someone clicks on one radio button
$('.formSwitcher')​​​​.change(function(){
    // get the form id we want to show (from the "data-form" attribute)
    var formIdToChange = $(this).data('form');
    // hide all forms first
    $('.hiddenForm').hide();
    // show the specific form
    $(formIdToChange).show();
});

​// initially hide all forms
$('.hiddenForm').hide();
// initially call the change method if one radio is already selected on page load
$('.formSwitcher:checked').change();​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:41:25.447

您是说您需要更改现有的用户字段，因为它们将授予对数据库的访问权限？我认为您想要做的是根据所选内容更改字段的属性。例如，如果您需要在用户单击新用户时设置自动填充字段，则编写类似

```
document.form.AutoPopUser.value="required value" 
```

当这个人点击现有用户时，你可以做

`document.form.AutoPopUser.value=""`

或者即使存在该部分也会使现有用户登录混乱，那么您可以通过将其放入 div 并根据所选选项创建或销毁它来删除整个部分。我觉得我不是很清楚，但我认为你需要的是一组巧妙的 onClick 函数来摆脱你不需要的东西并添加你需要的东西。如果您可以发布一些代码来配合它，那就太棒了。

# hibernate - hbm.xml 文件和hibernate注解可以一起工作吗？

> ID：12479592
> 
> 赞同：1
> 
> 时间：2012-09-18T14:57:13.377
> 
> 标签：hibernate

当我通过注释声明命名查询时，Hibernate Session 无法找到它，但是当我放入 hbm.xml 时它工作正常。

这是一个遗留系统，其中所有休眠实体都是通过 hbm.xml 定义的，我正在慢慢尝试将其迁移到注释。

```
Is it possible to distribute hibernate metadata via both hbm.xml and annotations? 
```

例外是

```
org.hibernate.MappingException: Named query not known: queryName 
```

实体类是

```
@Entity
@NamedQueries({

    @NamedQuery(name="queryName", queryString="from Product pro")
})

public class Product extends HibernateEntity 
```

获取会话

```
 SessionFactory hibernateSessionFactory = (SessionFactory) hibernateSessionFactories.get(targetDB);

        if (hibernateSessionFactory != null) 
        {
            session = hibernateSessionFactory.openSession(new HibernateEntityDifferenceInterceptor());

            session.setFlushMode(FlushMode.COMMIT);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:07:27.060

有了 Spring 支持，这[绝对是可能的](http://forum.springsource.org/showthread.php?78374-Hibernate-using-a-hybrid-annotation-and-XML-config-approach)，所以如果你不使用 Spring，你可以查看它内部的源代码并弄清楚它是如何在那里实现的。

# html - Firefox css 打印问题

> ID：12479599
> 
> 赞同：4
> 
> 时间：2012-09-18T14:57:37.247
> 
> 标签：html, css, firefox, printing

我有一个要打印的 html 页面。此页面具有 css 格式。当我在 Firefox 中打印出来时，打印预览和打印版本的数据在分页符上相互重叠。我目前没有控制我的 CSS 中的分页符。这是 Firefox 中打印预览的屏幕截图。注意重叠！

![在此处输入图像描述](../Images/7d914f0c6baeedda0e278284dbb27310.png)

不知道为什么会发生这种情况或如何解决。有没有人见过这个问题？谢谢您的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T13:16:41.400

终于找到了问题，并想发布它以防其他人遇到同样的事情。在我的CSS中，我有

```
overflow: auto; 
```

我完全忘记了我什至有这个所以把它改成

```
overflow: visible; 
```

解决了打印问题。希望这会对某人有所帮助！

# ruby-on-rails - ActionMailer 因作业延迟而导致 Rails 崩溃

> ID：12479600
> 
> 赞同：0
> 
> 时间：2012-09-18T14:57:40.710
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid, actionmailer, delayed-job

使用rails 3.2.5、ruby 1.9.2-p290、delayed_job 3.0.3 和delayed_job_mongoid 2.0.0，当我运行时：

```
MyMailer.delay.signup_email(user) 
```

我们得到：

> ruby(20929,0x7fff73dff180) malloc: *** 对象 0x7fa25a4f6d80 的错误：未分配被释放的指针 ***在 malloc_error_break 中设置断点以调试 Abort 陷阱：6

这是邮件：

```
class MyMailer < ActionMailer::Base   
  default :from => "support@myapp.com"

  def signup_email(user)
    @user = user
    mail( :to => user.email,
          :subject => "Welcome" )   
  end 
end 
```

有没有其他人看过这个？我尝试过捆绑更新，但这似乎没有帮助。

# java - 如何从 SOAP 响应中获取 xml 元素的值？（安卓）

> ID：12479601
> 
> 赞同：0
> 
> 时间：2012-09-18T14:57:44.127
> 
> 标签：java, android, xml, parsing, soap

这是 SOAP 响应：

```
<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
    <soap12:Body>
        <SearchResponse xmlns="...">
            <SearchResult> 
                <?xml version="1.0" standalone="yes"?> <items blahblahblah1 </items> 
                <?xml version="1.0" standalone="yes"?> <items blahblahblah2 </items> 
            </SearchResult>
        </SearchResponse>
      </soap12:Body>
</soap12:Envelope> 
```

从“SearchResult”中，我想一次获取“项目”的每个完整 xml。我的意思是，我想单独获得一个完整的“items blahblahblah /items”。我怎么做？

这是我想出的使用 DOM 从“SearchResult”中获取所有 xml 的方法，但是如何获取这些项目？

```
DocumentBuilder db = factory.newDocumentBuilder();
InputSource inStream = new InputSource();
inStream.setCharacterStream(new StringReader(soapResponse));
Document doc = db.parse(inStream);

NodeList nl = doc.getElementsByTagName("SearchResult");
xml = nl.item(0).getFirstChild().getNodeValue(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T16:03:39.223

一种方法是编写一个通用函数来解析已知标记的 XML。{

```
public static String parseXMLForTag(String xml, String tag) {
        try {
            // Create XMLPullParserFactory & XMLPullParser
            XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
            XmlPullParser parser = factory.newPullParser();
            parser.setInput(new StringReader(xml));

            // boolean to indicate desired tag has been found
            boolean foundTag = false;
            // variable to fill contents
            StringBuilder tagContents = new StringBuilder();

            // loop over document
            int eventType = parser.getEventType();
            while (eventType != XmlPullParser.END_DOCUMENT) {
                switch (eventType) {
                case XmlPullParser.START_TAG:
                    if (parser.getName().equals(tag)) {
                        // Found tag, start appending to tagContents
                        foundTag = true;
                    } else if (foundTag) {
                        // New start tag inside desired tag
                        tagContents.append("<" + parser.getName() + ">");
                    }
                    break;
                case XmlPullParser.END_TAG:
                    if (parser.getName().equals(tag)) {
                        // Finished gathering text for tag
                        return tagContents.toString();
                    } else if (foundTag) {
                        // end tag inside desired tag
                        tagContents.append("</" + parser.getName() + ">");
                    }
                    break;
                case XmlPullParser.TEXT:
                    if (foundTag) {
                        // text inside desired tag
                        tagContents.append(parser.getText());
                    }
                    break;
                }
                // Get next event type
                eventType = parser.next();
            }
            return null;
        } catch (Exception e) {
            return null;
        }
    }
} 
```

然后，您可以使用此方法提取搜索结果，即

```
String searchResult = parseXMLForTag(response, "SearchResult"); 
```

并使用此结果来解析项目

```
String item = parseXMLForTag(searchResult, "item"); 
```

请注意，此方法未以任何方式进行优化，尽管它应该适合您的目的。

# python - 当 Plone 3.3 内容规则尝试发送电子邮件时，Zope 上的线程卡住了

> ID：12479607
> 
> 赞同：1
> 
> 时间：2012-09-18T14:58:07.390
> 
> 标签：python, plone, zope, smtplib, qmail

我试图找出导致我们的 Zope 实例越来越频繁地锁定的问题的根源。我已经安装了[Products.signalstackLogger](http://pypi.python.org/pypi/Products.signalstackLogger/)以试图深入了解它，当我们在 Plone 中定义的内容规则之一试图发送电子邮件时，它似乎正在发生。

例如：

```
Thread 46447504 (GET /VirtualHostBase/https/xxx.xxx.xxx:443/plone/VirtualHostRoot/news/portal_factory/News Item/news_item.2012-09-18.0763501726/edit):
  File "/home/zope/home/parts/zope2/lib/python/ZServer/PubCore/ZServerPublisher.py", line 31, in __init__
    response=b)
  File "/home/zope/home/parts/zope2/lib/python/ZPublisher/Publish.py", line 401, in publish_module
    environ, debug, request, response)
  File "/home/zope/home/parts/zope2/lib/python/ZPublisher/Publish.py", line 202, in publish_module_standard
    response = publish(request, module_name, after_list, debug=debug)
  File "/home/zope/home/parts/zope2/lib/python/ZPublisher/Publish.py", line 119, in publish
    request, bind=1)
  File "/home/zope/home/parts/zope2/lib/python/ZPublisher/mapply.py", line 88, in mapply
    if debug is not None: return debug(object,args,context)
  File "/home/zope/home/parts/zope2/lib/python/ZPublisher/Publish.py", line 42, in call_object
    result=apply(object,args) # Type s<cr> to step into published object.
  File "/home/zope/home/eggs/Plone-3.3.6-py2.4.egg/Products/CMFPlone/FactoryTool.py", line 375, in __call__
    temp_obj = tempFolder.__getitem__(id)
  File "/home/zope/home/eggs/Plone-3.3.6-py2.4.egg/Products/CMFPlone/FactoryTool.py", line 155, in __getitem__
    self.invokeFactory(id=id, type_name=type_name)
  File "/home/zope/home/eggs/Plone-3.3.6-py2.4.egg/Products/CMFPlone/PloneFolder.py", line 348, in invokeFactory
    new_id = pt.constructContent(*args, **kw)
  File "/home/zope/home/eggs/Products.CMFCore-2.1.3-py2.4.egg/Products/CMFCore/TypesTool.py", line 716, in constructContent
    ob = info.constructInstance(container, id, *args, **kw)
  File "/home/zope/home/eggs/Products.CMFCore-2.1.3-py2.4.egg/Products/CMFCore/TypesTool.py", line 276, in constructInstance
    ob = self._constructInstance(container, id, *args, **kw)
  File "/home/zope/home/eggs/Products.CMFCore-2.1.3-py2.4.egg/Products/CMFCore/TypesTool.py", line 450, in _constructInstance
    newid = m(id, *args, **kw)
  File "<string>", line 7, in addATNewsItem
  File "/home/zope/home/parts/zope2/lib/python/OFS/ObjectManager.py", line 349, in _setObject
    notifyContainerModified(self)
  File "/home/zope/home/parts/zope2/lib/python/zope/app/container/contained.py", line 365, in notifyContainerModified
    notify(ContainerModifiedEvent(object, *descriptions))
  File "/home/zope/home/parts/zope2/lib/python/zope/event/__init__.py", line 23, in notify
    subscriber(event)
  File "/home/zope/home/parts/zope2/lib/python/zope/component/event.py", line 26, in dispatch
    for ignored in zope.component.subscribers(event, None):
  File "/home/zope/home/parts/zope2/lib/python/zope/component/_api.py", line 130, in subscribers
    return sitemanager.subscribers(objects, interface)
  File "/home/zope/home/parts/zope2/lib/python/zope/component/registry.py", line 290, in subscribers
    return self.adapters.subscribers(objects, provided)
  File "/home/zope/home/parts/zope2/lib/python/zope/interface/adapter.py", line 535, in subscribers
    subscription(*objects)
  File "/home/zope/home/eggs/plone.app.contentrules-1.1.7-py2.4.egg/plone/app/contentrules/handlers.py", line 174, in modified
    execute(aq_parent(aq_inner(event.object)), event)
  File "/home/zope/home/eggs/plone.app.contentrules-1.1.7-py2.4.egg/plone/app/contentrules/handlers.py", line 97, in execute
    executor(event, bubbled=True, rule_filter=rule_filter)
  File "/home/zope/home/eggs/plone.contentrules-1.1.0-py2.4.egg/plone/contentrules/engine/executor.py", line 27, in __call__
    executable()
  File "/home/zope/home/eggs/plone.contentrules-1.1.0-py2.4.egg/plone/contentrules/rule/rule.py", line 48, in __call__
    if not executable():
  File "/home/zope/home/eggs/plone.app.contentrules-1.1.7-py2.4.egg/plone/app/contentrules/actions/mail.py", line 103, in __call__
    From=source)
  File "/home/zope/home/eggs/Products.SecureMailHost-1.1.2-py2.4.egg/Products/SecureMailHost/SecureMailHost.py", line 246, in secureSend
    return self._send(mfrom, all_recipients, msg, debug=debug)
  File "/home/zope/home/eggs/Products.SecureMailHost-1.1.2-py2.4.egg/Products/SecureMailHost/SecureMailHost.py", line 276, in _send
    mail.send()
  File "/home/zope/home/eggs/Products.SecureMailHost-1.1.2-py2.4.egg/Products/SecureMailHost/mail.py", line 102, in send
    smtpserver = smtplib.SMTP(self.host, self.port)
  File "/usr/local/lib/python2.4/smtplib.py", line 244, in __init__
    (code, msg) = self.connect(host, port)
  File "/usr/local/lib/python2.4/smtplib.py", line 311, in connect
    (code, msg) = self.getreply()
  File "/usr/local/lib/python2.4/smtplib.py", line 352, in getreply
    line = self.file.readline()
  File "/usr/local/lib/python2.4/socket.py", line 332, in readline
    data = self._sock.recv(self._rbufsize) 
```

这些通知通常可以正常工作（每天发送许多电子邮件），并且已配置超过 12 个月，问题仅在最近 2 个月内出现。导致问题的唯一主要变化是从 Apache 负载均衡器切换到 Haproxy

我们正在使用：

*   Linux
*   本地 qmail 服务器 (localhost:25)
*   Python 2.4.6
*   克隆 3.3.6

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T09:19:36.860

这似乎是我们的 qmail 服务器达到其外部连接限制的结果。我们将其配置为 30，其中一个 IP（可能是垃圾邮件机器人）占用了其中的 20 个。

我们的 Zope 实例通过同一虚拟服务器上的 qmail 发送电子邮件，但这也是我们面向外部的邮件服务器。一旦达到连接限制，似乎来自 smtplib 的连接尝试将等待且没有超时。

现在我已经关闭了违规内容规则。从长远来看，我们可能会[修补 ucspi-tcp](http://js.hu/package/ucspi-tcp/)以通过 IP 限制连接，并切换到使用单独的邮件服务器来处理本地和外部电子邮件。

# c - 使用c从linux中的串行端口获取二进制数据

> ID：12479613
> 
> 赞同：3
> 
> 时间：2012-09-18T14:58:15.497
> 
> 标签：c, linux, binary

我正在使用 Linux 从 Phidg​​et sbc 上的串行端口读取二进制数据，以从 PC 上运行的应用程序获取命令。我在 VB 中编写了一个测试程序，将数据读入字节数组并将其转换为十进制以使用它，但无法弄清楚如何在 c 中执行此操作。我无法通过我在互联网上所做的研究得出任何结论。

从 PC 发送的命令是 0x0F。

为了检查我是否获得了正确的数据，我读取了数据并将其发回。这是我回来的。返回的数据添加了一个回车符。

十六进制显示 0F00 0000 0D

'\' 显示\0F\00\00\00\r

正常显示只是显示一个奇怪的字符。

这告诉我有数据可以使用，但无法提取值 0F 或 15。

如何转换传入的数据以使用它？

我尝试使用 strtol 转换接收到的数据，但它返回 0。我还尝试将端口设置为 raw，但没有任何区别。

```
unsigned char buffer1[1];
int ReadPort1()
{
int result;

result = read(file1, &buffer1,1);

if(result > 0)
{
    WritePort1(buffer1);
    sprintf(tempstr, "Port1 data %s %d", buffer1, result);
    DisplayText(2,tempstr);
}
return result;
} 
```

端口打开/设置

```
void OpenPort1()
{
//file1 = open("/dev/ttyUSB1", O_RDWR | O_NOCTTY | O_NONBLOCK);
     file1 = open("/dev/ttyUSB1", O_RDWR | O_NOCTTY | O_NODELAY);

if(file1 < 0)
    printf("Error opening serial port1.\n");
else
{
    SetPort(file1, 115200, 8, 1, 0, 1);
    port1open = 1;
}
}

void SetPort(int fd, int Baud_Rate, int Data_Bits, int Stop_Bits, int Parity, int raw)
{
    long BAUD;                      // derived baud rate from command line
    long DATABITS;
    long STOPBITS;
    long PARITYON;
    long PARITY;

struct termios newtio;

  switch (Baud_Rate)
  {
    case 115200:
        BAUD = B115200;
        break;
     case 38400:
        BAUD = B38400;
        break;
     case 19200:
        BAUD  = B19200;
        break;
     case 9600:
        BAUD  = B9600;
        break;
  }  //end of switch baud_rate
  switch (Data_Bits)
  {
     case 8:
     default:
        DATABITS = CS8;
        break;
     case 7:
        DATABITS = CS7;
        break;
     case 6:
        DATABITS = CS6;
        break;
     case 5:
        DATABITS = CS5;
        break;
  }  //end of switch data_bits
  switch (Stop_Bits)
  {
     case 1:
     default:
        STOPBITS = 0;
        break;
     case 2:
        STOPBITS = CSTOPB;
        break;
  }  //end of switch stop bits
  switch (Parity)
  {
     case 0:
     default:                       //none
        PARITYON = 0;
        PARITY = 0;
        break;
     case 1:                        //odd
        PARITYON = PARENB;
        PARITY = PARODD;
        break;
     case 2:                        //even
        PARITYON = PARENB;
        PARITY = 0;
        break;
  }  //end of switch parity

  newtio.c_cflag = BAUD | DATABITS | STOPBITS | PARITYON | PARITY | CLOCAL | CREAD;   
  newtio.c_iflag = IGNPAR;

  if(raw == 1)
  {
        newtio.c_oflag &= ~OPOST;
        newtio.c_lflag &= ~(ICANON | ECHO | ECHOE | ISIG); 
  }
  else
  {
        newtio.c_lflag = 0;       //ICANON;
        newtio.c_oflag = 0;
  }

  newtio.c_cc[VMIN]=1;
  newtio.c_cc[VTIME]=0;
  tcflush(fd, TCIFLUSH);
  tcsetattr(fd,TCSANOW,&newtio);
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-18T15:18:57.203

您是否正在寻找数据的十六进制表示？

```
 sprintf(tempstr, "Port1 data %s %x", buffer1, buffer1[0]); 
```

# javascript - 如何更新动态输入控件的背景颜色？

> ID：12479616
> 
> 赞同：0
> 
> 时间：2012-09-18T14:58:20.757
> 
> 标签：javascript, jquery

我使用以下 javascript 成功创建了一些动态输入文本框：

```
var type = "Textbox";
var foo = document.getElementById("fooBar");

for (i = 1; i <= totalQty; i = i + 1) {

    var textbox = document.createElement("input");
    //Assign different attributes to the element.
    textbox.setAttribute("type", type + i);
    //textbox.setAttribute("value", type + i);
    textbox.setAttribute("name", type + i);
    textbox.setAttribute("id", type + i);
    textbox.setAttribute("style", "width:300px");
    textbox.setAttribute("width", "300px");

    //Append the element in page (in span).
    var newline = document.createElement("br");
    foo.appendChild(newline);
    foo.appendChild(textbox);
} 
```

一切正常。但是，一旦用户键入数据并单击提交，我需要返回并将任何有错误的文本框的背景颜色设置为红色。我找到了一些代码来做实际的着色：

```
textbox.style.backgroundColor = "#fa6767"; 
```

...并且我知道错误文本框的确切名称（即“Textbox1”、“Textbox2”、“Textbox3”等），但我不确定如何以编程方式将此背景颜色代码分配给特定的文本框。我不能使用这样的东西，因为所有代码都是动态生成的：

```
errorTextbox = $("#Textbox1"); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:08:15.240

看起来您正在构建一个表单验证脚本。这是一种更简单的方法：

1）在您的样式表中为您的错误类创建一个条目。与单独分配属性相比，添加和删除类所需的步骤更少。

```
.error {
    background-color: #ff0000;
} 
```

2) 例如，为您希望验证的所有文本框提供一个唯一的类名“valMe”。

3）然后在验证步骤中遍历它们：

```
 $('.valMe').each(function() {
           $(this).removeClass('error');
           if($(this).text=='') {
               $(this).addClass('error');
           }
    }) 
```

通过使用“this”，您可以引用当前元素，因此您甚至不需要知道元素的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:41:04.167

如果您已经知道元素的`name`（在这种情况下与 相同`id`），则可以使用 jQuery 通过使用字符串连接形成选择器来选择元素。假设您有一个变量来存储有错误的文本框的`name`/ `id`，那么这是一个相对简单的过程：

```
var errorTextboxName = 'Textbox1';
$('#' + errorTextboxName).css('background-color', 'red'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T14:48:47.870

我最终选择了以下内容：

```
document.getElementById('Textbox1'.style.backgroundColor = "#fa6767"; 
```

我最初认为我无法以这种方式捕获我的“Textbox1”控件，因为当我查看 html 源代码时，由于我动态创建了它，因此没有“Textbox1”。

谢谢。

# mysql - 检查一列是否为空

> ID：12479621
> 
> 赞同：1
> 
> 时间：2012-09-18T14:58:29.990
> 
> 标签：mysql, sql, database, sqlite

我需要检索其中一种数据类型为空的行的列。Extra VARCHAR Extra 没有任何内容

显示那些有空额外列的

```
 Select * FROM Items WHERE Extra ????? 
```

应该是什么条件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:00:16.277

检查它是空字符串还是空字符串。

```
 Select * FROM Items WHERE Extra IS NULL OR Extra = '' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T15:17:53.797

```
select * from items where Isnull(extra,'')='' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T15:09:16.130

如果空表示“”或空字符串，则：

```
select * from items where extra=""; 
```

空字符串的长度为零/0。

如果空意味着 NULL，那么：

```
select * from items where extra is NULL; 
```

NULL 的长度为 NULL。

如果您想阅读更多内容，可以阅读以下内容：

*   [MySQL：NULL 与“”](https://stackoverflow.com/questions/1106258/mysql-null-vs)
*   [MySQL，最好插入 NULL 或空字符串？](https://stackoverflow.com/questions/1267999/mysql-better-to-insert-null-or-empty-string)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T15:00:10.813

```
Select * 
FROM Items 
WHERE Extra IS NULL 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T15:02:11.127

如果你用空的意思是 NULL...

```
Select * FROM Items WHERE Extra IS NULL 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-18T15:01:24.687

选择空`varchar`字段，其中包含空字符串或 NULL：

```
SELECT * FROM `Items` WHERE `Extra` < 1; 
```

# watir - 如何避免复选框弃用的页面对象

> ID：12479624
> 
> 赞同：2
> 
> 时间：2012-09-18T14:58:46.950
> 
> 标签：watir, watir-webdriver, pageobjects, page-object-gem

我从一年开始就使用黄瓜，几周后我就在其中添加了 page-object-gem。当我执行测试时，我收到消息：

> 弃用警告
> 您正在commentPage.rb:23:in `block in delete_comment'中调用一个名为checkbox 的方法。
> 此方法在页面对象中不存在，因此它被传递给驱动程序。
> 此功能将在不久的将来删除。
> 请更改您的代码以调用正确的页面对象方法。

（我对其他情况也有同样的看法，但这个“微不足道”的例子应该更容易解释）

我寻找一种方法来避免这种情况，但这似乎很复杂。

对于测试，我正在检查一个页面，上面有一张桌子。每行显示一行，我需要检查特定行的复选框。

我在 pageObject 中的代码：

```
table(:comment_list, :class => 'comments')
button(:delete, :text => "Delete")

def delete_comment (text)
  self.comment_list_element.each do |row|
    if row.text.include? "#{text}"
      row.checkbox.set
      self.delete
      return true
    end
  end
  false
end 
```

我是否需要对我的桌子进行预处理才能在测试期间使用它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T00:39:11.933

您收到警告是因为您正在调用 Watir 上的方法而不是页面对象（`checkbox`表格行上的方法）。如果您想访问 Checkbox，您可以简单地调用将返回嵌套元素的方法。这会将调用的那部分更改为`row.checkbox_element`. 但是你下一个电话也会遇到同样的问题。首先，`set`CheckBox 上不存在该方法。在页面对象中，方法是`check`和`uncheck`。完整的电话应该是：

`row.checkbox_element.check`

您收到弃用错误的原因是因为我计划将来删除对底层驱动程序的调用转发。这种能力在复杂的情况下确实会引起很多问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:23:08.457

在您的代码中，`row`是 a `PageObject::Elements::TableRow`，它没有`checkbox`定义方法。我没有遇到任何链接页面对象元素的示例。

作为一种解决方法，您可以通过执行以下操作将其转换`PageObject::Elements::TableRow`为常规`Watir::TableRow`：

```
row.element 
```

因此，如果您这样做，您的代码将起作用：

```
row.element.checkbox.set 
```

# matlab - 索引以找到相应的数字

> ID：12479633
> 
> 赞同：0
> 
> 时间：2012-09-18T14:59:06.617
> 
> 标签：matlab, indexing

我在水柱的不同深度进行了时间序列的测量。我已将它们分成单独的单元格（供以后使用），并且需要一些帮助来完成以下操作：例如

```
 time = [733774,733774,733775,733775,733775,733776,733776];
    bthD = [20,10,0,15,10,20,10];
    bthA = (1000:100:1600);
    %Hypsographic
    Hypso = [(10:1:20)',(1000:100:2000)'];
    d = [1,1.3,1,2.5,2.5,1,1.2];
    data = horzcat(time',bthD',d');
    uniqueTimes = unique(time);
    counts = hist(time,uniqueTimes);
    newData = mat2cell(data,counts,length(uniqueTimes)); 
```

因此，在 newData 我有三个单元格，它们对应于不同的测量日期，在每个单元格中我有 newData(:,1) 是时间，newData(:,2) 是深度，newData(:,3) 是测量. 我想找出细胞中每个深度的面积，不同深度的面积在变量“Hypso”中给出。

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:21:54.467

你的问题表述非常好！很容易理解你在这里需要什么。您只需要函数[interp1](http://www.mathworks.com/help/matlab/ref/interp1.html)。使用 的第一列`Hypso`，我假设，作为你的深度，第二列作为面积。您可以使用函数的矢量化`interp1`功能在一次调用中查找所有值：

```
areaAtDepth = interp1(Hypso(:,1),Hypso(:,2),bthD)

areaAtDepth =

  Columns 1 through 6

        2000        1000         NaN        1500        1000        2000

  Column 7

        1000 
```

您会注意到`Nan`输出的第三列中的 。这是因为它的相关深度 ,`0`超出了数据的范围，或者我相信的数据的支持。您需要决定当数据超出范围时要做什么，或者可能永远不应该这样做，因此应该记录一个错误；由你决定！如果您还有其他问题，请告诉我！

# regex - 允许方括号的正则表达式

> ID：12479634
> 
> 赞同：2
> 
> 时间：2012-09-18T14:59:07.243
> 
> 标签：regex, vb.net, .net-4.0

这工作完美..

```
 result2 = Regex.Replace(result2, "[^A-Za-z0-9/.,>#:\s]", "", RegexOptions.Compiled) 
```

但我需要允许方括号（`[`和`]`）。在不改变上面允许和不允许的内容的情况下允许使用括号是否正确？

```
result2 = Regex.Replace(result2, "[^A-Za-z0-9\[\]/.,>#:\s]", "", RegexOptions.Compiled) 
```

我需要第二个意见的原因是，我认为如果这是正确的，那么其他东西会阻止它，这是我无法控制的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T19:01:15.593

我不能说任何人回答或不回答问题或试图提供帮助，如果可以的话，我会将解决方案分配给每个人，因为它让我思考。关键是使用单个 \ 来分隔括号。感谢大家的帮助。

```
 result = Regex.Replace(result, "[^A-Za-z0-9/\[\].,>#\s]", "", RegexOptions.Compiled) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T17:03:24.083

@tripleee 提到的噱头确实适用于.NET。只需确保`]`是第一个字符（或者在这种情况下，在`^`.

```
result2 = Regex.Replace(result2, "[^][A-Za-z0-9/.,>#:\s]", ""); 
```

但要小心将正则表达式移植到其他口味。有些人会将其视为语法错误，而有些人会将其视为两个原子：`[^]`and `[A-Za-z0-9/.,>#:\s]`，其中第一个实际上匹配任何内容，但什么都不匹配——即，任何字符，包括换行符。

在旁注中，您为什么使用该`RegexOptions.Compiled`选项？只有当你*知道*你需要它时，你才应该使用它。提高的性能几乎永远不会显着，并且价格相当高，如[**here**](http://msdn.microsoft.com/en-us/library/8zbs0h2f.aspx)所述。

[http://msdn.microsoft.com/en-us/library/8zbs0h2f.aspx](http://msdn.microsoft.com/en-us/library/8zbs0h2f.aspx)

# lotus-notes - RichText 控件中的异常

> ID：12479636
> 
> 赞同：1
> 
> 时间：2012-09-18T14:59:14.217
> 
> 标签：lotus-notes, xpages

最近我在使用 RichText 字段时开始收到以下异常：

com.ibm.xsp.FacesExceptionEx：找不到名为 acf 的活动内容过滤器

将 AllPermission 授权添加到 java.policy 后，该错误消失。

此异常的原因可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-22T12:22:08.917

不是答案（但您不能将图片放在评论中）

我建议您查看 xsp.properties 文件中的活动内容过滤设置。它可能会引导你找到一些答案。看图片

![在此处输入图像描述](../Images/93fdefbc609e5a291045be70b0cdb7eb.png)

# android - achartengine 更改原点位置

> ID：12479638
> 
> 赞同：1
> 
> 时间：2012-09-18T14:59:18.760
> 
> 标签：android, orientation, achartengine

我正在 Android 上使用 AChartEngine 绘制条形图。

我通过改变的方向使图表水平`XYMultipleSeriesRenderer`：

```
mMSRenderer.setOrientation(Orientation.VERTICAL); 
```

（水平设置为 似乎违反直觉`Orientation.VERTICAL`，但这不是我问题的重点）。

绘图的原点位于左上角，而我希望它位于左下角，以便值从底部到顶部增加。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:05:05.027

AChartEngine 无法做到这一点，因为它是开箱即用的。

但是，您可以尝试将数据以相反的顺序放入数据集中，并添加自定义标签而不是默认标签。

# php - php日期搜索框查询

> ID：12479642
> 
> 赞同：0
> 
> 时间：2012-09-18T14:59:30.310
> 
> 标签：php, jquery, mysql, search, search-box

我在 oscommerce 上有一个订单页面，带有一个搜索框，允许用户通过购买日期过滤结果。

这是用于显示搜索框的 html 标记，它使用 jquery datepicker 来选择日期：

```
<table border="0" align="right">
<tr><?php echo tep_draw_form('search_date_purchased', FILENAME_ORDERS, '', 'get'); ?>

<td class="smallText" align="right"><?php echo TEXT_ORDER_DATE;?>&nbsp;<input type="text" name="search_date_purchased" placeholder="Choose a Date" class="datepick"/></td>
</form>
</tr>
</table> 
```

`tep_draw_form`is的 html 输出，`<form name="search_date_purchased" action="../admin/orders.php" method="get">` 这里是运行搜索框查询的 php 端：

```
if (isset($HTTP_GET_VARS['search_date_purchased']) && !empty($HTTP_GET_VARS['search_date_purchased'])){

    if (strstr($HTTP_GET_VARS['search_date_purchased'],'-')){

        $search_date = explode("-", $HTTP_GET_VARS['search_date_purchased']);   

        $start_date = substr($search_date[0],6,4).'-'.substr($search_date[0],3,2).'-'.substr($search_date[0],0,2).' 17:00:00';

        $end_date = substr($search_date[1],6,4).'-'.substr($search_date[1],3,2).'-'.substr($search_date[1],0,2).' 17:00:00';    

        $search_query = "and (o.date_purchased >='".$start_date."' and o.date_purchased <='".$end_date."') ";

    }else{

    $start_date = substr($HTTP_GET_VARS['search_date_purchased'],6,4).'-'.substr($HTTP_GET_VARS['search_date_purchased'],3,2).'-'.substr($HTTP_GET_VARS['search_date_purchased'],0,2).' 17:00:00';

    $end_date = substr($HTTP_GET_VARS['search_date_purchased'],6,4).'-'.substr($HTTP_GET_VARS['search_date_purchased'],3,2).'-'.substr($HTTP_GET_VARS['search_date_purchased'],0,2).' 17:00:00';    

        $search_query = "and (o.date_purchased >='".$start_date."' and o.date_purchased <='".$end_date."') ";
    }

}else{
    $yesterday = date("Y-m-d",strtotime('-1 day')).' 17:00:00';
    $today = date("Y-m-d").' 17:00:00'; 
    $search_query = "and (o.date_purchased >='".$yesterday."' and o.date_purchased <='".$today."') ";

}

if (isset($HTTP_GET_VARS['cID'])) {

  $cID = tep_db_prepare_input($HTTP_GET_VARS['cID']);
  $orders_query_raw = "select o.orders_id, o.customers_id, o.customers_name, o.customers_id, o.payment_method, o.date_purchased, o.franchise_id, o.last_modified, o.date_allocated, o.currency, o.currency_value, s.orders_status_name, ot.text as order_total from " . TABLE_ORDERS . " o left join " . TABLE_ORDERS_TOTAL . " ot on (o.orders_id = ot.orders_id), " . TABLE_ORDERS_STATUS . " s where o.customers_id = '" . (int)$cID . "' and o.orders_status = s.orders_status_id and s.language_id = '" . (int)$languages_id . "' and ot.class = 'ot_total'  " . $franchise_search . "order by orders_id DESC ";
} elseif (isset($HTTP_GET_VARS['status']) && is_numeric($HTTP_GET_VARS['status']) && ($HTTP_GET_VARS['status'] > 0)) {
  $status = tep_db_prepare_input($HTTP_GET_VARS['status']);
  $orders_query_raw = "select o.orders_id, o.customers_id, o.customers_name, o.payment_method, o.franchise_id,o.date_purchased, o.last_modified, o.currency, o.currency_value, o.date_allocated, s.orders_status_name, ot.text as order_total from " . TABLE_ORDERS . " o left join " . TABLE_ORDERS_TOTAL . " ot on (o.orders_id = ot.orders_id), " . TABLE_ORDERS_STATUS . " s where o.orders_status = s.orders_status_id and s.language_id = '" . (int)$languages_id . "' and s.orders_status_id = '" . (int)$status . "' and ot.class = 'ot_total'  " . $franchise_search . "order by o.orders_id DESC ";
} else {
  $orders_query_raw = "select o.orders_id, o.customers_id, o.customers_name, o.payment_method, o.date_purchased, o.franchise_id, o.last_modified, o.date_allocated, o.currency, o.currency_value, s.orders_status_name, ot.text as order_total from " . TABLE_ORDERS . " o left join " . TABLE_ORDERS_TOTAL . " ot on (o.orders_id = ot.orders_id), " . TABLE_ORDERS_STATUS . " s where o.orders_status = s.orders_status_id and s.language_id = '" . (int)$languages_id . "' and ot.class = 'ot_total'  " . $search_query . " order by o.orders_id DESC";
} 
```

目前它所做的只是显示输入框的值，以及在 URL 中搜索的日期，但它没有运行搜索。关于为什么以及如何解决的任何想法？

# c++ - GSL 插值错误，值必须是 x 值必须单调递增

> ID：12479644
> 
> 赞同：0
> 
> 时间：2012-09-18T14:59:33.427
> 
> 标签：c++, c, gsl

嗨，我的问题是我的数据集是单调递增的，但在数据的最后，它看起来像下面这样，其中一些`x[i-1] = x[i]`如下所示。这会导致 GSL 中出现错误，因为它认为值不是单调递增的。是否有解决方案，修复或解决此问题？

这些值已经是双精度的，这个特定的数据集从 9.86553e-06 开始，到 .999999 结束

唯一的解决方案是抵消 for 循环中的每个值吗？

```
0.999981
0.999981
0.999981
0.999982
0.999982
0.999983
0.999983
0.999983
0.999984
0.999984
0.999985
0.999985
0.999985 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T18:21:33.693

我有一个类似的问题。我通过一个简单的条件运算符（if 语句）删除了重复项，这并不影响最终结果（由 MatLab 检查）。不过，这可能有点特定于问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:29:45.107

如果你真的达到了双精度允许的极限——你的增量小于机器 epsilon——那么你就无法对数据做任何事情。x 数据*不是*单调递增的。相反，您必须返回它们的生成位置并对它们应用某种变换以使尾部的差异更大。或者你可以乘以一个标量因子，然后在 x 值之间进行插值；然后在完成后将因子除以。

编辑： tr(x) = (x-0.5)^3 可能会很好地分隔事物，或者 tr(x) = tan( (x-0.5)*pi )。不过，在后一种情况下必须注意极端值。当然，这些转换可能会破坏您尝试执行的分析，因此标量因子可能是答案 - 显然，必须是您的分析不变的转换。添加一个常数也是可能的。

# iphone - UIView 未在 iPhone 5 模拟器上调整大小

> ID：12479647
> 
> 赞同：0
> 
> 时间：2012-09-18T14:59:50.490
> 
> 标签：iphone, ios, xcode, iphone-5

> **可能重复：**
> [如何为 iPhone 5 屏幕分辨率开发或迁移应用程序？](https://stackoverflow.com/questions/12395200/how-to-develop-or-migrate-apps-for-iphone-5-screen-resolution)

我有`UIViewController`一个 320x480 的视图。我进行了自动调整蒙版设置`UIView`以水平和垂直拉伸它。但是当我在 iPhone 5 模拟器上运行它时，顶部和底部都有黑色空间。

为什么`UIView`不自动从 480 像素调整到 568 像素（垂直）以填充空白空间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:03:32.140

您需要将 Default-568h@2x.png 启动图像添加到您的项目中，分辨率为 1136x640px。

请参阅此处： [如何为 iPhone 5 屏幕分辨率开发或迁移应用程序？](https://stackoverflow.com/questions/12395200/how-to-develop-or-migrate-apps-for-iphone-5-screen-resolution)

# c++ - cv::mat CV_8U 产品错误和缓慢的 CV_32F 产品

> ID：12479663
> 
> 赞同：2
> 
> 时间：2012-09-18T15:00:42.127
> 
> 标签：c++, opencv

我正在尝试在 2772x128 矩阵和 4000x128 矩阵之间制作产品。两者都是 SIFT 描述符的矩阵，使用下面的代码：

```
Mat a = Mat(nframes, descrSize, CV_8U, DATAdescr);
Mat b = Mat(vocabulary_size, descrSize, CV_8U, vocabulary);
Mat ab =a * b.t(); 
```

问题是在计算产品时，它会抛出一个错误说

```
err_msg = 0x00cdd5e0 "..\..\..\src\opencv\modules\core\src\matmul.cpp:711: error: (-215) type == B.type() && (type == CV_32FC1 || type == CV_64FC1 || type == CV_32FC2 || type == CV_64FC2)" 
```

解决方案是将数据类型转换为 CV_32FC1

```
Mat a = Mat(nframes, descrSize, CV_8U, DATAdescr);
Mat b = Mat(vocabulary_size, descrSize, CV_8U, vocabulary);
a.convertTo(a, CV_32FC1);
b.convertTo(b, CV_32FC1);
Mat ab = a * b.t(); 
```

它工作得很好，但它消耗了太多时间，大约 1.2 秒。我想尝试相同的产品，但使用整数，看看我是否可以加快速度。难道我做错了什么？我看不出我不能在 CV_8U 矩阵之间做矩阵乘积的任何原因。

编辑：答案与使用其他库或解决其他方式有关。我正在考虑打开一个新线程来提供解决我的问题的建议，但是有人可以回答我最初的问题吗？我不能乘以 CV_8U 或 CV32S 矩阵吗？真的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T21:36:47.310

在您的[另一条消息](https://stackoverflow.com/questions/12597397/fastest-way-to-calculate-mininum-euclidean-distance-between-two-matrices-contain)中，您说以下代码需要 0.9 秒。

```
MatrixXd A = MatrixXd::Random(1000, 1000);
MatrixXd B = MatrixXd::Random(1000, 500);
MatrixXd X; 
```

我在我的机器上尝试了一个小基准测试，intel core i7 在 linux 上运行。我的完整基准代码如下：

```
#include <Eigen/Dense>
using namespace Eigen;

int
main(int argc, char *argv[])
{
  MatrixXd A = MatrixXd::Random(2772, 128);
  MatrixXd B = MatrixXd::Random(4000, 128);
  MatrixXd X = A*B.transpose();
} 
```

我只是使用来自 linux 的 time 命令，所以运行时间包括可执行文件的启动和停止。

1/ 无优化编译（gcc 编译器）：

```
g++ -I/usr/include/eigen3 matcal.cpp -O0 -o matcal
time ./matcal
real    0m13.177s  -> this is the time you should be looking at
user    0m13.133s
sys     0m0.022s 
```

13秒，太慢了。顺便说一句，如果没有矩阵乘法，它需要 0.048 秒，而在你的 0.9 秒示例中使用更大的矩阵。为什么 ？？

使用 Eigen 进行编译器优化非常重要。2/ 进行一些优化编译：

```
g++ -I/usr/include/eigen3 matcal.cpp -O2 -o matcal
time ./matcal
real    0m0.324s
user        0m0.298s
sys     0m0.024s 
```

现在是 0.324 秒，这样更好！

3/切换所有优化标志（至少我所知道的，我不是这个领域的专家）

```
g++ -I/usr/include/eigen3 matcal.cpp -O3 -march=corei7 -mtune=corei7 -o matcal 
time ./matcal
real    0m0.317s
user    0m0.291s
sys     0m0.024s 
```

0.317，接近，但增加了几毫秒（持续进行一些测试）。所以在我看来，你对 Eigen 的使用确实有问题，要么你不切换编译器优化，要么你的编译器没有自己做。

我不是 Eigen 方面的专家，我只使用过几次，但我认为文档非常好，您可能应该阅读它以充分利用它。

关于与 MatLab 的性能比较，上次我阅读 Eigen 时它不是多线程的，而 MatLab 可能使用多线程库。对于矩阵乘法，您可以将矩阵分成几个块并使用 TBB 并行化每个块的乘法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T09:03:09.653

由 remi 建议，我使用 Eige 实现了相同的矩阵乘法。这里是：

```
const int descrSize = 128;
MatrixXi a(nframes, descrSize);
MatrixXi b(vocabulary_size, descrSize);
MatrixXi ab(nframes, vocabulary_size);

unsigned char* dataPtr = DATAdescr;
for (int i=0; i<nframes; ++i)
{
    for (int j=0; j<descrSize; ++j)
    {
        a(i,j)=(int)*dataPtr++;
    }
}
unsigned char* vocPtr = vocabulary;
for (int i=0; i<vocabulary_size; ++i)
{
    for (int j=0; j<descrSize; ++j)
    {
        b(i,j)=(int)*vocPtr ++;
    }
}

ab = a*b.transpose();
a.cwiseProduct(a);
b.cwiseProduct(b);
MatrixXi aa = a.rowwise().sum();
MatrixXi bb = b.rowwise().sum();

MatrixXi d = (aa.replicate(1,vocabulary_size) + bb.transpose().replicate(nframes,1) - 2*ab).cwiseAbs2(); 
```

关键线是说

```
ab = a*b.transpose(); 
```

DATAdescr 词汇表是无符号字符数组。DATAdescr 为 2782x128，词汇表为 4000x128。我在实现时看到我可以使用 Map，但一开始我没有使用它。分配的初始循环是 0.001 成本，因此这不是瓶颈。整个过程约1.23 s

matlab（0.05s）中的相同实现是：

```
aa=sum(a.*a,2); bb=sum(b.*b,2); ab=a*b'; 
d = sqrt(abs(repmat(aa,[1 size(bb,1)]) + repmat(bb',[size(aa,1) 1]) - 2*ab)); 
```

提前感谢雷米的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:07:18.423

如果您将矩阵相乘，则将元素值相乘并将它们相加 - 如果您只有 0-255 的范围，则乘积很可能会超过 255。因此 CV_8U 矩阵的乘积不是很有用。

如果您知道您的结果将适合一个字节，您可以通过循环元素自己进行乘法运算。

编辑：浮动版本慢得多，我有点惊讶，通常opencv在性能方面非常好 - 具有多核和优化的SSE2指令。你是从源代码构建的吗？你有 TBB（即多线程）和 SSE2 cpu 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T20:56:54.697

尝试使用 EIGEN 作为后端编译 OpenCV。在 CMakeList 中有一个选项。我在您的命令中读到您使用 OpenCV 只是为了加速矩阵乘法，所以您甚至可能想[直接尝试 EIGEN](http://eigen.tuxfamily.org/index.php?title=Main_Page)。

最后一个解决方案，使用 OpenCV 的 GPU 模块。

# r - 错误：（下标）逻辑下标太长

> ID：12479664
> 
> 赞同：1
> 
> 时间：2012-09-18T15:00:45.297
> 
> 标签：r

有人可以告诉我为什么会收到此错误以及如何解决吗？

这是代码

我要做的是删除与 1 相关联的行，如果该列小于 10

```
a0=rep(1,40)
a=rep(0:1,20)
b=c(rep(1,20),rep(0,20))
c0=c(rep(0,12),rep(1,28))
c1=c(rep(1,5),rep(0,35))
c2=c(rep(1,8),rep(0,32))
c3=c(rep(1,23),rep(0,17))
c4=c(rep(1,6),rep(0,34))
x=matrix(cbind(a0,a,b,c0,c1,c2,c3,c4),nrow=40,ncol=8)
nam <- paste("V",2:9,sep="")
colnames(x)<-nam
dat <- cbind(y=rnorm(40,50,7),x)
#===================================
toSum <- colSums(dat)
Col <- Val <- NULL
for(i in 1:length(toSum)){
if(toSum[i]<10){
Col <- c(Col,colnames(dat)[i])
Val <- c(Val,toSum[i])}
}
cs <- colSums(dat) < 10
indx <- dat[,which(cs)]==0
for(i in 1:dim(indx)[2]){
datnw <- dat[indx[,i],]
dat <- datnw}
datnw2 <- dat[, -which(cs)] 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:11:34.770

如果我正确理解你想要达到的目标，你最好这样写：

```
cs <- colSums(dat) < 10
dat[rowSums(dat[,cs]) == 0, !cs] 
```

这意味着：对于总和小于 10 的任何列（以下称为“小列”），删除该列中具有 1 的任何行。因此，您只保留所有这些小列中为零的行。您也删除了小列，因为它们在任何情况下都只包含零。

在您的代码中，`indx`是一个具有 40 行的逻辑数据框，每行输入一个，输入中的每个小列一个列。您使用第一列`idx`删除第一短列中带有 1 的行。这会产生一个*新值*，`dat`它比原始值短几行。在循环的下一次迭代中，您使用第二个逻辑向量来尝试删除更多行。*但这行不通：*在第一次迭代之后，`dat`有不到 40 行，但第二列仍然有所有 40 行。这就是导致错误的原因：您正在使用长度为 40 的逻辑向量为少于 40 个元素的向量下标。

您可以使用以下表达式将您的三列组合`indx`成一个适合为感兴趣的行下标的向量：

```
apply(indx, 1, all) 
```

对于每列中`TRUE`的那些行，这将在其结果中具有一个值。`TRUE`但是，我想我更喜欢上面的代码，因为它写起来要短得多。更喜欢后者的最可能原因是您的数据框可能包含负数，因此行总和为零并不意味着行全为零。在您的示例数据中没有问题。

# ruby-on-rails - heroku open - 未指定应用程序

> ID：12479668
> 
> 赞同：58
> 
> 时间：2012-09-18T15:01:01.160
> 
> 标签：ruby-on-rails, heroku

我刚刚创建了一个简单的 Rails 应用程序，使用

```
rails new myapp 
```

然后使用以下方法创建了heroku堆栈：

```
heroku create --stack cedar 
```

但是当我尝试使用以下命令在 Heroku 上打开应用程序时：

```
heroku open 
```

我得到：

```
 !    No app specified.
 !    Run this command from an app folder or specify which app to use with --app <app name> 
```

还有这个：

```
$ heroku open --app myapp 
```

给了我这个：

```
 !    App not found 
```

我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2014-07-18T02:18:55.737

如果您在 Heroku 上有一个现有的应用程序并且您收到此没有指定应用程序的消息，您可以通过在本地终端上运行它来更正它：

`heroku git:remote -a MyHerokuAppName`

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-09-18T15:31:57.520

Heroku 默认情况下不会使用您的目录名称创建应用程序，所以当您这样做时

```
heroku create --stack cedar
Creating calm-bayou-3229... done, stack is cedar
http://calm-bayou-3229.herokuapp.com/ | git@heroku.com:calm-bayou-3229.git 
```

它正在创建名为“calm-bayou-3229”的应用程序，你可以这样做

```
heroku open --app calm-bayou-3229
Opening http://calm-bayou-3229.herokuapp.com/ 
```

您可以随时列出您的应用程序：

```
heroku apps 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-02-15T17:34:47.350

解决该问题的另一种方法是广泛了解与 heroku 应用程序关联的 .git/config 文件正在做什么，并进行必要的调整。

1.`.git/config`从你的heroku项目的根目录打开。

你的 git 配置文件可能看起来像这样，尤其是当你在你的机器上处理几个 heroku 帐户时。

`git@heroku.{heroku.account}`显示而不是`git@heroku.com`因为`~/.ssh/config`文件中的配置。`heroku-app-8396.git`应该更新对的引用以匹配您的 heroku 项目名称。您拥有的每个 heroku 帐户都应该在`~/.ssh/config`文件中有一个条目。显然，与这个 heroku 项目关联的 heroku 帐户应该显示在您的`.git/config`文件中。

```
[core]
    repositoryformatversion = 0
    filemode = true
    bare = false
    logallrefupdates = true
    ignorecase = true
    precomposeunicode = false
[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = git@heroku.heroku.account:heroku-app-8396.git
[remote "heroku"]
    fetch = +refs/heads/*:refs/remotes/heroku/*
    url = git@heroku.heroku.account:heroku-app-8396.git
[branch "master"]
    remote = origin
    merge = refs/heads/master
[heroku]
  account = heroku.account 
```

2.当我跑步`git pull heroku master`时，一切似乎都运行良好。

3.当我运行`heroku logs`时，我收到一条错误消息：

```
$ heroku ps
!    No app specified.
!    Run this command from an app folder or specify which app to use with --app APP. 
```

为什么？

据我所知，该`heroku`命令似乎不知道如何处理这些`{heroku.account}`引用。如果我们将这些引用更改为`com`（这是您不使用“accounts”heroku 插件时的默认值），`heroku`命令会再次起作用，但现在我们的`git`调用表明存在不同的问题：

```
$ git pull heroku master

 !  Your key with fingerprint d6:1b:4c:48:8c:52:d4:d6:f8:32:aa:1a:e7:0e:a2:a1 is not authorized to access smooth-robot-8396.

fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists. 
```

解决这个问题的一种方法是定义一个遥控器`git`和一个遥控器`heroku`，然后告诉`heroku`使用哪个遥控器。

```
[core]
    repositoryformatversion = 0
    filemode = true
    bare = false
    logallrefupdates = true
    ignorecase = true
    precomposeunicode = false
[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = git@heroku.heroku.account:heroku-app-8396.git
[remote "heroku"]
    fetch = +refs/heads/*:refs/remotes/heroku/*
    url = git@heroku.heroku.account:heroku-app-8396.git
[remote "heroku-app"]
    fetch = +refs/heads/*:refs/remotes/heroku/*
    url = git@heroku.com:heroku-app-8396.git
[branch "master"]
    remote = origin
    merge = refs/heads/master
[heroku]
    remote = heroku-app
    account = heroku.account 
```

当我将内容推送到遥控器时，我喜欢明确指定遥控器，因此`heroku`遥控器就是为此而设计的，即使此配置也支持使用默认值（例如，`git push`）进行推送/拉取。我创建了一个新的远程“heroku-app”并添加`remote = heroku-app`以告诉`heroku`使用不包括 URI 中的 heroku 帐户的远程。

现在我可以随心所欲地运行我的`git`和`heroku`命令了。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-12-15T02:17:08.607

我有同样的问题，我所要做的就是 cd 到项目目录，而不是从项目目录中的模型文件夹运行命令。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-30T14:26:25.037

> 这个疯狂的事情对我有用：

如果您在本地机器上有应用程序的 git repo 副本，然后`cd`到该位置，**就是这样**！

您将能够使用该应用程序。您可以通过以下命令验证这一点：`heroku logs -n 1500`

# c# - C#，运算符 '??' 不能应用于“十进制”和“十进制”类型的操作数

> ID：12479669
> 
> 赞同：11
> 
> 时间：2012-09-18T15:01:01.313
> 
> 标签：c#, asp.net

```
public decimal v1 {
  get {
    return this._v1; 
  }
  set {
    this._v1 = value ?? 0M;  // also I tried, default(decimal)
  }
} 
```

错误信息说：

**操作员 '？？' 不能应用于“十进制”和“十进制”类型的操作数**

为什么它不起作用，我应该如何使它起作用？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-18T15:02:42.390

`decimal`类型不能为 null，因此 null-coalesce 运算符在这里没有意义。刚设置`_v1`为`value`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T15:02:54.137

这些是值类型，`null`您不能使用`Nullable<decimal>`

```
private decimal? _v1;
public decimal? V1
{
    get
    {
        return this._v1;
    }
    set
    {
        this._v1 = value ?? 0M;
    }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T15:03:01.970

是小数吗？或小数

这 ？？与小数一起使用？但不是小数，因为小数永远不能为空。

[http://msdn.microsoft.com/en-us/library/ms173224.aspx](http://msdn.microsoft.com/en-us/library/ms173224.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T15:03:11.767

那就是[空合并运算符](http://msdn.microsoft.com/en-us/library/ms173224.aspx)。由于小数不能为空，它对小数没有用处。

如果需要此功能，可以使用`decimal?`可以设置为 null 的 a：

```
public decimal? v1 
{
    get 
    {
        return this._v1; 
    }
    set 
    {
        this._v1 = value ?? 0M;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-22T14:46:49.873

如果您试图针对类的属性执行此操作，即：

```
public class TestCase {
     public decimal TestProp {get;set;}
} 
```

您可以像这样执行空合并：

```
var testCase = new TestCase();
return testCase?.TestProp ?? 0M 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-06T22:02:16.353

如果您认为**默认十进制值 0**被视为*null、空或未设置*，并且您只想**在它不为零时****使用`value`**，那么您可以执行以下操作：

```
decimal nextBest = 10M;

public decimal v1 {
  get {
    return this._v1; 
  }
  set {
    // Use value by default (only if it's not 0), Otherwise use a different number.
    this._v1 = (value != 0)? value : nextBest;  
  }
} 
```

# windbg - 如何增加当前 WinDbg 中的断点限制？

> ID：12479674
> 
> 赞同：3
> 
> 时间：2012-09-18T15:01:21.317
> 
> 标签：windbg

作为驱动程序开发人员，WinDbg 是我最好的朋友之一。

现在从 Windows 8 开始，我安装了新的 WDK 并想使用它的新 WinDbg。它具有一些不错的功能，例如通过网络进行远程调试。

但是在使用过程中，当我意识到我只能激活 32 个断点时，我感到震惊。显示以下消息：

```
*******************************************************************************
* You have attempted to enable   33 KD breakpoints, which exceeds the         *
* currently supported limit of   32 breakpoints for Windows kernel debugging. *
* Breakpoints exceeding this limit are ignored.                               *
* Please disable/clear breakpoints until you are within the supported limit.  *
******************************************************************************* 
```

在早期版本中并非如此。有没有解决的办法？一个我还没有找到的选项，一个注册表项，或者我可以修补可执行文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T18:06:52.647

有趣的。警告消息来自 dbgeng!AddBreakpoint，在单步执行代码时，看起来 32 的限制是硬编码的：

```
cmp     esi, 20h
jbe     short loc_100A5721
push    offset asc_10038758 ; "***************************************"...
call    ?WarnOut@@YAXPBGZZ
pop     ecx
push    esi
push    offset aYouHaveAttempt ; "* You have attempted to enable %4u KD b"...
call    ?WarnOut@@YAXPBGZZ
push    20h
push    offset aCurrentlySuppo ; "* currently supported limit of %4u brea"...
call    ?WarnOut@@YAXPBGZZ
push    offset aBreakpointsExc ; "* Breakpoints exceeding this limit are "...
call    ?WarnOut@@YAXPBGZZ 
```

我怀疑仅仅修补这个检查是不够的，但我没有进一步确认这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T08:20:26.590

您可以通过以下命令将 int 3（字节 0xCC）放置在任何地址：eb [address] cc

确保在点击 int 3 时恢复原始字节。

# sql - SQL Server 计数很慢

> ID：12479677
> 
> 赞同：43
> 
> 时间：2012-09-18T15:01:32.410
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005, count

统计大量数据的表可能会很慢，有时需要几分钟；它还可能在繁忙的服务器上产生死锁。我想显示真实值，NOLOCK 不是一个选项。

我使用的服务器是 SQL Server 2005 或 2008 Standard 或 Enterprise - 如果重要的话。我可以想象 SQL Server 维护每个表的计数，如果没有 WHERE 子句，我可以很快得到这个数字，对吧？

例如：

```
SELECT COUNT(*) FROM myTable 
```

应该立即返回正确的值。我需要依靠统计数据来更新吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-09-18T15:23:50.487

非常接近的近似值（忽略任何进行中的交易）将是：

```
SELECT SUM(p.rows) FROM sys.partitions AS p
  INNER JOIN sys.tables AS t
  ON p.[object_id] = t.[object_id]
  INNER JOIN sys.schemas AS s
  ON s.[schema_id] = t.[schema_id]
  WHERE t.name = N'myTable'
  AND s.name = N'dbo'
  AND p.index_id IN (0,1); 
```

这将比返回快得多`COUNT(*)`，并且如果您的表变化得足够快，那么它实际上并没有降低准确度 - 如果您的表在您开始 COUNT （并且锁定）和返回时（锁定时）之间发生了变化被释放并且所有等待的写事务现在都被允许写入表），它更有价值吗？我不这么认为。

如果您有要计算的表的某个子集（例如`WHERE some_column IS NULL`，在较小的集合上创建过滤索引）。所以这两个索引之一：

```
CREATE INDEX IAmTheException ON dbo.table(some_column)
  WHERE some_column IS NULL;

CREATE INDEX IAmTheRule ON dbo.table(some_column)
  WHERE some_column IS NOT NULL; 
```

然后你可以使用类似的方式获得计数：

```
SELECT SUM(p.rows) FROM sys.partitions AS p
  INNER JOIN sys.tables AS t
  ON p.[object_id] = t.[object_id]
  INNER JOIN sys.schemas AS s
  ON s.[schema_id] = t.[schema_id]
  INNER JOIN sys.indexes AS i
  ON p.index_id = i.index_id
  WHERE t.name = N'myTable'
  AND s.name = N'dbo'
  AND i.name = N'IAmTheException' -- or N'IAmTheRule'
  AND p.index_id IN (0,1); 
```

如果你想知道相反的情况，你只需从上面的第一个查询中减去。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-18T15:09:40.233

（“大量数据”有多大？-应该先评论一下，但也许下面的 exec 已经帮助你了）

如果我在我的开发机器上在 15 秒内对具有 2 亿行和 COUNT(*) 的静态表运行查询（意味着在很长一段时间内没有其他人对读/写/更新感到恼火，所以争用不是问题）（甲骨文）。考虑到纯数据量，这仍然很快（至少对我来说）

正如您所说，NOLOCK 不是一种选择，您可以考虑

```
exec sp_spaceused 'myTable' 
```

也是。

但这与 NOLOCK 几乎相同（忽略争用 + 删除/更新 afaik）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-05-16T06:11:01.720

我使用 SSMS 已有十多年了，直到去年才发现它可以快速轻松地为您提供这些信息，这要归功于[这个答案](https://stackoverflow.com/a/48326827/2869344)。

1.  从数据库树（对象资源管理器）中选择“表”文件夹
2.  按 F7 或选择***View*** *> **Object Explorer Details***以打开 Object Explorer Details 视图
3.  在此视图中，您可以右键单击列标题以选择要查看的列，包括已使用的表空间、已使用的索引空间和行数： [![在此处输入图像描述](../Images/fdbfd6597cf3e92334f00df4cbd4ad95.png)](https://i.stack.imgur.com/ZS87o.png)

请注意，Azure SQL 数据库对此的支持充其量似乎有点参差不齐——我的猜测是来自 SSMS 的查询超时，因此每次刷新它只返回少数表，但似乎总是返回突出显示的表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-18T15:25:01.430

Count 将执行表扫描或索引扫描。因此，对于大量行，它会很慢。如果你经常做这个操作，最好的办法是把计数记录保存在另一个表中。

但是，如果您不想这样做，则可以创建一个虚拟索引（查询不会使用该索引）并查询它的项目数，例如：

```
select 
    row_count
from sys.dm_db_partition_stats as p
inner join sys.indexes as i 
  on p.index_id = i.index_id
  and p.object_id = i.object_id
where   i.name = 'your index' 
```

我建议创建一个新索引，因为这个索引（如果不使用）在其他操作期间不会被锁定。

正如 Aaron Bertrand 所说，维护查询可能比使用现有查询更昂贵。所以选择权在你。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2017-06-23T13:30:41.637

如果您只需要粗略计算行数，即。要确保正确加载表或确保未删除数据，请执行以下操作：

```
MySQL> connect information_schema;
MySQL> select table_name,table_rows from tables; 
```

# php - 多少字节对于 twitter 来说是足够独特的？

> ID：12479681
> 
> 赞同：0
> 
> 时间：2012-09-18T15:01:41.453
> 
> 标签：php, unique, uniqueidentifier

我不希望我的数据库 id 是连续的，所以我尝试使用以下代码生成 uid：

```
$bin = openssl_random_pseudo_bytes(12);
$hex = bin2hex($bin);
return base_convert($hex, 16, 36); 
```

我的问题是：我需要多少字节才能使 id 足够独特以处理大量记录（如 twitter）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:05:02.987

使用 PHP 的**[`uniqid()`](http://il.php.net/manual/en/function.uniqid.php)**，增加熵因子。这会给你足够的空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T15:15:12.267

您可能会考虑 tinyurl 和其他缩短服务的工作方式。我使用了类似的技术，它保证了唯一性，直到用尽所有组合。所以基本上你选择一个字母，以及你想要多少个字符作为长度。假设我们使用字母数字，大写和小写，所以字母表中有 62 个字符，每个代码 5 个字符。那是 62^5 = 916,132,832 种组合。

您从顺序数据库 ID 开始，然后乘以某个素数（选择一个相当大的数字，例如 2097593）。您所做的就是将其乘以您的数据库 ID，如果超过 62^5，请确保环绕，然后根据您选择的字母将该数字转换为 base-62。

这使得每个代码看起来都相当独特，但是因为我们使用质数，所以在我们已经使用所有代码之前，我们保证不会两次点击相同的数字。而且很短。

如果长度不是问题，您也可以使用带有较小字母的较长键。

这是我问的一个问题：[Tinyurl-style unique code: potential algorithm to prevent collisions](https://stackoverflow.com/questions/1257825/tinyurl-style-unique-code-potential-algorithm-to-prevent-collisions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:16:42.890

使用 MySQL UUID

```
insert into `database`(`unique`,`data`) values(UUID(),'Test'); 
```

如果您不使用 MySQL 搜索 google 的 UUID（数据库名称），它会给您一个选项

来源维基百科

> 换句话说，仅在接下来的 100 年每秒生成 10 亿个 UUID 之后，仅创建一个副本的概率约为 50%

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T15:24:38.587

假设`openssl_random_pseudo_bytes`可能会生成每个可能的值，N 个字节将为您提供`2 ^ (N * 8)`不同的值。对于 12 个字节，这是`7.923 * 10^28`

# c# - HtmlAgilityPack - 找不到文件

> ID：12479682
> 
> 赞同：4
> 
> 时间：2012-09-18T15:01:44.710
> 
> 标签：c#, asp.net, visual-studio-2010, sharepoint, html-agility-pack

我正在 SharePoint Foundation 中开发 C# ASP .NET WebPart。

一切正常，现在我想解析一个 HTML 页面以获取所有 ImagePath 并将图像保存在 HD/Temp 上。

为此，我正在下载当前版本的 HtmlAgilityPack，添加对 Project 的引用，一切正常，IntelliSense 工作正常。

但是当我想运行应该使用 HtmlAgilityPack 的部分时，我的浏览器会显示一个

> FileNotFoundException - 找不到文件或程序集。

在第一次搜索后，我尝试包含 HtmlAgilityPack v1.4.0，因为我读到当前版本在某些情况下并不是很稳定。这工作正常，直到我想使用 HtmlAgilityPack，同样的异常。

我还尝试将 HtmlAgilityPack 直接移动到解决方案目录，没有任何改变。

我尝试通过插入 HtmlAgilityPack`using`并尝试直接调用，例如`HtmlAgilityPack.HtmlDocument`。

**结论 ：**

*   当我编译没有发生错误时，引用设置正确。

*   当我`HtmlAgilityPack.dll`使用 ProcMon 跟踪时，路径显示正确，但有时结果是 ' `File Locked with only Readers`'，但我对 ProcMon 了解不足，无法知道这意味着什么，或者这是否很关键。它与文件权限无关，因为如果我检查 DLL，则所有权限都已给出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T10:30:02.657

我在这种组合中使用了 HTML 敏捷性，它对我来说非常有效。请尝试检查并确认。

*   下载的 DLL 版本应该支持您的解决方案。
*   确保在 GAC 中放置一份副本。

# ios - 使用 Core Text 重新实现 UITextView 和 UITextField

> ID：12479683
> 
> 赞同：1
> 
> 时间：2012-09-18T15:01:52.840
> 
> 标签：ios, uitextfield, uitextview, core-text, uitextinput

是否有对Core Text的开源重新实现`UITextView`和使用？`UITextField`

Apple 的[SimpleTextInput](http://developer.apple.com/library/ios/#samplecode/SimpleTextInput)带有`SimpleCoreTextView`和`EditableCoreTextView`类，它明确表示：

```
 File: SimpleCoreTextView.m
 Abstract: 

 A view that draws text, reasons about layout, and manages a selection over its text range.

 IMPORTANT: Its use of CoreText is naive and inefficient, it deals only with
 left-to-right text layout, and it is by no means a good template for any text
 editor.  It is a toy implementation included only to illustrate how to bind
 the system keyboard to some pre-existing text editor. 
```

换句话说，它不处理例如阿拉伯语，并且效率低下。

对于基于核心文本和`UITextInput`协议族的可编辑文本字段或文本视图的完整实现，我们有哪些替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T05:51:00.593

您可以使用或参考[OmniGroup 的 TextEditor](https://github.com/omnigroup/OmniGroup/tree/master/Workspaces) 来实现可编辑的文本字段或文本视图，基于 Core Text 和`UITextInput`

# database - 数据库中没有更多的假脱机空间

> ID：12479691
> 
> 赞同：12
> 
> 时间：2012-09-18T15:02:19.540
> 
> 标签：database, teradata

我正在使用 Teradata。在那我得到'数据库中没有更多的假脱机空间'。我的数据库利用率为 85%。这个错误和数据库利用率之间有什么关系吗？对此的任何研究都会对我解决这个问题更有帮助。与我分享您的想法以避免这种情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T17:10:17.710

`Spool space`当您的查询效率低下或`statistics`没有在您使用的表上正确收集时，就会出现问题。主索引选择不当（高偏差）的表也可能发生这种情况。假脱机是您用于连接到 Teradata 环境的用户帐户的属性；它实际上并不是数据库本身的属性。

确定的唯一方法是查看`EXPLAIN`查询计划。

如果您的查询效率低下，请重写它。如果需要收集统计信息或需要更改索引，请联系负责您正在使用的表的 DBA。

如果有一个特定的查询给你一个“假脱机”错误，用完整的查询文本更新这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-11T12:10:18.467

当您使用具有大量数据的表时，可能会出现假脱机空间。如果您使用多个表，请检查您是否使用别名而不是引用完整的表。使用别名实际上可以通过连接缩小数据范围。另请查看是否正在使用诸如 orplace 之类的消耗更多数据的函数。在这种情况下尝试使用正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-29T16:12:17.807

我无法通过上述方法解决我的“假脱机”错误。我通过将 rank 函数移动到它自己的小表中解决了这个错误，而没有任何连接或无关列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-24T18:26:40.860

最终，您可能会创建太低的线轴空间。

您需要在 MODIFY PROFILE 或 MODIFY USER 语句中为 SPOOL 指定一个新值，具体取决于定义用户假脱机的位置。语法是：

```
MODIFY [PROFILE profile_name | USER user_name ] AS SPOOL = 100000000 bytes ; 
```

# ruby-on-rails-3 - 向路由添加第二个参数的最佳方法

> ID：12479700
> 
> 赞同：0
> 
> 时间：2012-09-18T15:02:51.160
> 
> 标签：ruby-on-rails-3

我希望我的路线类似于汽车（/：国家/）：car_id，最好的方法是什么？只有“汽车”会列出所有汽车，“汽车/：国家”会列出该国家/地区制造的所有汽车。

现在我有这样的资源：cars,:path => "cars (/:country)" 并且如果 params[:country] 为 nil ，我会检查 cars#index 操作以确定将从数据库中检索到的内容。

我的解决方案感觉错误和丑陋，我想最好和最干净的解决方案是制作一个国家模型，但真的不知道如何组织它，提示？country 必须有 slug，car_id 也必须有（使用friendly_id 作为car_id）。感觉就像我应该有一个带有名字和蛞蝓的汽车桌，这就是我所想出来的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T17:46:29.677

首先，我想说您当前的解决方案并不丑陋，也不是错误的，最坏的情况是行人。但是没有看到所有涉及的模型和关联，我只能给出一个笼统的答案。

首先，一个乡村模型，可能是个好主意，但你如何将它与汽车模型联系起来？

你可以这样做：

```
class Country << ActiveRecord::Base
  has_may :cars
end
class Car << ActiveRecord::Base
  belongs_to :country
end 
```

这将支持语义，您可以在其中选择一个国家，并获取属于某个国家的所有汽车，即

```
@cars = Country.find('USA').cars 
```

或者，您可以执行以下操作：

```
class Car << ActiveRecord::Base
  has_one :country
end

class Country << ActiveRecord::Base
end 
```

这将启用不同的语义：

```
@country = Car.find('Jeep').country 
```

关键是要考虑您希望在您的应用程序中拥有的查询语义，然后定义您的关联以支持对您的应用程序有意义的语义。我发布了非常简单的关联，您最终可能会得到多个更复杂的关联，这取决于您需要如何查询数据库和关联的模型。

更新

您发布：我希望我的路线类似于汽车（/：国家/）：car_id，

这没有任何意义，如果您知道具体的 car_id，则不需要任何过滤或额外搜索。

听起来你想要这些 URL：

```
/cars          # all cars
/cars/:country # all cars in country
/car/:id       # a specific car 
```

假设您已经为汽车定义了全套 RESTful 路线，那么第一条和第三条路线可能就在那里，即

配置/路由.rb

```
resources :cars 
```

您只需要添加到 routes.rb：

```
GET '/cars/:country' => 'cars#index' 
```

然后在 app/controllers/cars_controller.rb 中：

```
def index
  if params[:country]
    @cars = Car.where("country_id = ?", params[:country])
  else
    @cars = Car.all
  end
end 
```

这假设您建立了一个关系，每个汽车记录都有一个 country_id 属性。这可以通过多种方式实现，例如：

```
class Car < ActiveRecord::Base
   belongs_to :country
end 
```

这表示我的汽车表有一个 country_id 属性，我可以执行以下操作：

@car = Car.find(1001)

“这辆车在#{@car.country.name}”

# java - 将两个组件放在一个 JPanel 容器上的基本示例？

> ID：12479701
> 
> 赞同：3
> 
> 时间：2012-09-18T15:02:53.527
> 
> 标签：java, swing, components, containers

这是我将组件（JTextArea 和 JList）添加到面板并将其放在框架上的代码。我可以通过 BorderLayout 划分一半/一半吗？

如果是的话，为什么我的看起来很乱，一个保持向上一个向下？另一种选择是什么？问候，伯纳德

```
import java.awt.*;
import javax.swing.BorderFactory; 
import javax.swing.border.Border;
import javax.swing.JList;
import javax.swing.JScrollPane;
import javax.swing.JPanel; 
import javax.swing.JFrame;
import javax.swing.JTextArea;

public class SimpleBorder {

    public static void main(String[] args) {

        JFrame frame = new JFrame();
        frame.setSize(500,500);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);       

        Border etched = (Border) BorderFactory.createEtchedBorder();

        String[] items = {"A", "B", "C", "D"};
        JList list = new JList(items);

        JTextArea text = new JTextArea(10, 40);

        JScrollPane scrol = new JScrollPane(text);
        JScrollPane scrol2 = new JScrollPane(list);

        JPanel panel= new JPanel();
        panel.add(scrol2,BorderLayout.WEST);
        panel.add(scrol, BorderLayout.EAST);    
        panel.setBorder(etched);

        frame.add(panel);
        frame.setVisible(true);
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T15:19:13.310

的默认布局管理器`JPanel`is `FlowLayout`，因此添加组件而不实际将布局设置为 的实例`BorderLayout`会产生意想不到的结果。

要获得一半/一半布局，您可以使用`GridLayout`：

```
JPanel panel= new JPanel(new GridLayout(1, 2)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T15:10:57.100

您必须使用不同的`LayoutManager`，`BorderLayout`不允许您添加仅使用 50% 可见空间的组件。我个人使用`GridBagLayout`，它允许您指定许多参数（可用空间分布、组件的新行、对齐方式等）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T15:44:10.217

您应该将`LayoutManager`of your设置`JPanel`为`BorderLayout`第一个（仅*ContentPanes*即`frame#getContentPane()`具有默认布局`BorderLayout`）：

```
 JPanel panel= new JPanel(new BorderLayout());
    panel.add(scrol2,BorderLayout.WEST);
    panel.add(scrol, BorderLayout.EAST);    
    panel.setBorder(etched); 
```

# workflow-foundation-4 - 获取兄弟控件

> ID：12479705
> 
> 赞同：0
> 
> 时间：2012-09-18T15:03:02.417
> 
> 标签：workflow-foundation-4

有没有办法找到兄弟控件/或兄弟活动？

在 ASP.NET 中，我找到了用户 md1337[解决方案的解决方案](https://stackoverflow.com/questions/3685530/finding-the-previous-and-next-sibling-controls)，但对于 WF4，我找不到它。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T12:56:34.247

```
 public static IEnumerable<T> FindVisualChildren<T>(System.Windows.DependencyObject depObj) where T : System.Windows.DependencyObject
    {
        if (depObj != null)
        {
            for (int i = 0; i < VisualTreeHelper.GetChildrenCount(depObj); i++)
            {
                System.Windows.DependencyObject child = VisualTreeHelper.GetChild(depObj, i);
                if (child != null && child is T)
                {
                    yield return (T)child;
                }

                foreach (T childOfChild in FindVisualChildren<T>(child))
                {
                    yield return childOfChild;
                }
            }
        }
    } 
```

在 mi Create Activity 方法中，我执行以下操作：

```
 foreach (TextBlock tb in RulesDll.ObjectsClass.FindControls.FindVisualChildren<TextBlock>(target))
        {
            string a = tb.Text;
        } 
```

# objective-c - AFNetworking 证书错误

> ID：12479706
> 
> 赞同：3
> 
> 时间：2012-09-18T15:03:09.597
> 
> 标签：objective-c, ios, certificate, client-server, afnetworking

一般来说，我对客户端/服务器编程和网络非常陌生。我正在尝试使用我的应用程序连接到服务器`AFNetworking`。它抛出一个错误：

```
the certificate for this server is invalid.... 
```

如何让`AFNetworking`框架忽略此错误并继续加载数据？

我基本上使用`AFNetworking`Twitter 上的示例作为跳板，将其集成到我的应用程序中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T16:56:21.330

有问题的服务器是否有自签名 SSL 证书？

如果是这样，那么您可能会在这里找到一些有用的信息：

*   [AFNetworking 问题 #45](https://github.com/AFNetworking/AFNetworking/issues/45)
*   [AFNetworking 问题 #189](https://github.com/AFNetworking/AFNetworking/issues/189)

建议的方法是定义`_AFNETWORKING_ALLOW_INVALID_SSL_CERTIFICATES_`您可以在哪个 CAE 中成功允许 AFNetworking 接受无效的 SSL 证书。我的经验受到了打击或错过，以及处理此问题的各种其他建议方法 - 通常涉及`com.apple.NSURLConnectionLoader`在后台线程中崩溃。

# python - 从字符串中删除数值

> ID：12479712
> 
> 赞同：1
> 
> 时间：2012-09-18T15:03:40.830
> 
> 标签：python, perl, bash, shell

我有一个 2000 行和 1 列的文件

```
1007_s_at1
1007_s_at2
1007_s_at3
1007_s_at4
1007_s_at5
1007_s_at6
1007_s_at7
1007_s_at8
1007_s_at9
1007_s_at10 
```

看起来像上面，我想删除“at”之后的最后一个数值。原则上，最后一个数字应该被截断。

我已经尝试过将它们拆分然后重新加入它，但这只会使问题复杂化，而且我离答案还很远。

您能否建议一些 bash 或 shell 或 python 或 perl 来解决这个问题。

需要如下输出

```
 1007_s_at
    1007_s_at
    1007_s_at
    1007_s_at
    1007_s_at
    1007_s_at
    1007_s_at
    1007_s_at
    1007_s_at
    1007_s_at 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T15:06:07.913

使用**Perl**：

```
perl -p -e "s/\d+$//" input.txt > output.txt 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T15:05:55.310

```
sed -i -e 's/[[:digit:]]*$//' filename 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T15:06:03.133

只需通过`string.digits`to`.rstrip()`删除字符串右侧的数字：

```
import string
with open('inputfile') as infile, open('outputfile') as outfile:
    for line in infile:
        outfile.write(line.rstrip().rstrip(string.digits) + '\n') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T15:09:15.783

如果最后的唯一数字发生变化，您可能会拼接：

```
>>> a = '1007_s_at1'
>>> a[0:9]
'1007_s_at' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-18T15:32:58.570

**Python**

只需从末尾删除所有数字。

```
>>> "1007_s_at10".rstrip('01234567890')
'1007_s_at' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-18T20:52:56.513

还没有人提出 bash 解决方案：

```
shopt -s extglob
while read line; do
    echo "${line%%*([0-9])}"
done < filename 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-18T19:06:18.673

如果您使用的是 Linux 或 Unix，一个简单的单线解决方案将是：

```
perl -i.bak -pe 's/\d+$//g' file.txt 
```

如果是 Windows：

```
perl -i.bak -pe "s/\d+$//g" file.txt 
```

如果您已经知道它在做什么，那么很好，否则，用非常简单的术语来说，`-i`switch with`.bak`将首先创建您的备份`file.txt`并命名它`file.txt.bak`。

然后，该`-p`选项将遍历文件中的条目，并在最后删除数字`file.txt`后打印/保存输出。`s/\d+$//g`

# r - 在 RUnit 或 testthat 中自动生成测试用例

> ID：12479713
> 
> 赞同：6
> 
> 时间：2012-09-18T15:03:45.797
> 
> 标签：r, testing, runit, testthat

如何在 RUnit 中自动生成测试用例？

例如，假设我有一个简单的 sum() 函数：

```
sum <- function(x, y) {
    return (x + y)
    } 
```

我想在一系列不同的测试用例上测试这个功能：

```
test_cases <- c( c(2, 2, 4),
     c(3, 3, 6),
     c(0, 0, 0),
     c(-1, 2, 1)
     ) 
```

每个向量的前两个元素是 x 和 y，第三个是 sum(x,y) 函数的预期输出。

在 python 中，我可以轻松地编写一个函数，为 test_cases 中的每个元素生成一个测试用例，但我不知道如何在 R 中实现它。我查看了 RUnit 和 testthat 文档，但没有类似的东西。这里最好的解决方案是什么？

这就是我用python编写它的方式（使用nosetest启动测试单元）：

```
for triplet in test_cases:
    yield test_triplet(triplet)

def test_triplet(triplet):
    assert(sum(triplet[0], triplet[1]) == triplet[2]) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T20:54:32.653

```
# You simply take advantage of R's vector orientation.
test_cases <- matrix(c(2, 2, 4,
                       3, 3, 6, 
                       0, 0, 0, 
                      -1, 2, 1), ncol = 3, byrow = TRUE)
my_sum <- function(x, y) { x + y}

## testthat
library(testthat)
expect_equal(my_sum(test_cases[ , 1], test_cases[ , 2]), test_cases[ , 3])

## RUnit
library(RUnit)
test_my_sum <- function() {
  checkEquals(my_sum(test_cases[ , 1], test_cases[ , 2]), test_cases[ , 3])
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T15:13:17.477

sapply 可能有用

```
Sum <- function(x, y) {  # Sum is much better than sum,this avoids problems with sum base function
  return (x + y)
}

test_cases <- matrix( c(2, 2, 4,  # I think a matrix structure is better to handle this problem
                        3, 3, 6,
                        0, 0, 0,
                        -1, 2, 1), ncol=3, byrow=TRUE)

# Applying your function and comparing the result with the expected result.
sapply(1:nrow(test_cases), function(i) Sum(test_cases[i,1], test_cases[i,2]))==test_cases[,3]

TRUE TRUE TRUE TRUE  # indicates the result is as expected. 
```

# google-maps - 如何防止 Google Maps API v3 DirectionsService 产生的结果受到当前交通状况的影响？

> ID：12479715
> 
> 赞同：4
> 
> 时间：2012-09-18T15:03:56.587
> 
> 标签：google-maps, google-maps-api-3, driving-directions

我编写了一个网站，它使用 Google Maps API v3 的 DirectionsService 来查找两个用户定义位置之间的行驶距离。

我发现它在一天中的不同时间或一周中的不同日子产生不同的结果。

例如，我曾两次在 Coatbridge 和 Grangemouth 之间进行过一次旅行，第一次告诉我距离是 41.8 公里，第二次告诉我距离是 39.9 公里。

我怀疑它可能会受到当前交通状况的影响。我在 Google 文档中没有找到任何线索。

有没有其他人遇到过这个问题？更重要的是，有人有解决方案吗？

**编辑：**
当前交通状况的影响似乎是 Google Maps DirectionsService 的一个已知“功能”（感谢您的输入@vitors），但是到目前为止，还没有人提出一种“关闭”它的方法功能。

如何防止结果受到当前交通状况的影响？有人可以帮忙吗？

**编辑：** 似乎谷歌终于添加了一个`durationInTraffic`参数（感谢@Ron的信息）。可惜对我来说已经晚了将近2年！希望这对其他人有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-30T11:58:21.400

您可以尝试设置`durationInTraffic`为false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T13:15:13.513

如果您只想向用户提供一个点并且它应该是最短距离，您可以做的是，在调用 Google 的距离服务时指定 optimizeWaypoints（可选）参数。使用此选项后，您将获得的数组中的第一个结果将保持最短距离，并且始终相同：

有关更多信息，您可以点击此链接： [https ://developers.google.com/maps/documentation/javascript/directions](https://developers.google.com/maps/documentation/javascript/directions)

并搜索 optimizeWaypoints

快乐编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T13:01:54.240

您的怀疑是正确的，结果受交通状况的影响。

我认为这篇文章可以解释[http://searchengineland.com/traffic-estimates-return-to-google-maps-116862。](http://searchengineland.com/traffic-estimates-return-to-google-maps-116862)

# selenium - 如何为硒测试httprequest设置cookie

> ID：12479716
> 
> 赞同：0
> 
> 时间：2012-09-18T15:03:57.320
> 
> 标签：selenium, selenium-webdriver

我想使用 cookie 通过 selenium 测试来验证登录页面。我正在使用以下形式的代码：

```
selenium.createCookie("name=Cookie", value);
selenium.open("http://localhost/sample/Login"); 
```

但没有结果。无法登录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T00:07:36.967

您必须调用`selenium.open`与 cookie 位于同一域中的 URL（在本例中为“http://localhost/sample”）。然后您可以`selenium.createCookie`使用适当的参数调用。

# php - 我怎样才能复制一个对象？

> ID：12479717
> 
> 赞同：-1
> 
> 时间：2012-09-18T15:04:02.893
> 
> 标签：php

我真的被 php 中的引用所困扰。在我的程序中，我有类似的东西：

1.  程序

    ```
    class Test
    {
        private $_property;

        function __construct($property)
        {
            $this->_property = $property;
        }

        public function setProperty($property)
        {
            $this->_property = $property;
        }

        public function getProperty()
        {
            return $this->_property;
        }
    }

    function doSmth(Test $var)
    {
        $newVar = new Test('test');

        //I need to do something here...
    }

    $var = new Test('original');

    doSmth($var);

    var_dump($var); 
    ```

2.  问题

我应该怎么做才能将变量的所有内容复制`$newVar`到我的变量中，以便在使用函数之外的函数`$var`后能够看到它。而且我不能在我的程序中使用 getter 和 setter，因为我有很多它们，而且会有很多代码。是否有可能在我的限制下解决这个问题？`var_dump()``doSmth()`

**更新**：我无法在我的函数中返回值，我`doSmth()`也尝试过`__clone`但没有任何效果。有人可以告诉我我该怎么做`__clone()`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:08:23.417

可以使用*[clone](http://php.net/manual/en/language.oop5.cloning.php)*关键字创建对象的副本。它将帮助您创建源对象的完整副本。或者，我认为也可能对您有用，您可以尝试通过引用传递 Test 对象：

```
function doSmth(Test &$var)
{
    // Here you can do something with your var
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T15:07:16.807

`$newVar`只存在于函数的上下文中。

你想要做的是创建一个这样的返回值：

```
function doSmth(Test $var)
{
    $newVar = new Test('test');

    //I need to do something here...

    return $newVar;
} 
```

而是像这样调用函数：

```
$myNewShinyVar=doSmth($var); 
```

这样，您的函数将类的对象`Test`作为返回值返回。

```
var_dump($myNewShinyVar); 
```

编辑：如果你不能返回一个值，你可以通过引用传递：

```
function doSmth(&$var)
{
    $var = new Test('test');
} 
```

这将修改作为参数传递给它的变量本身（而不是传递它的副本）

```
doSmth($var);
var_dump($var); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:13:01.070

如果我多次阅读您的问题，我认为这就是您所追求的：

```
function doSmth(Test $var)
{
  $newvar = clone $var;
  // do some stuff on a copy of $var, leaving $var intact
}

$var = new Test('original');

doSmth($var);

var_dump($var); 
```

# if-statement - 方案（球拍）如果在 cond 内不返回任何内容

> ID：12479719
> 
> 赞同：4
> 
> 时间：2012-09-18T15:04:06.290
> 
> 标签：if-statement, scheme, racket

我一直在 DrRacket 工作，试图创建一个“前缀”功能（#lang 球拍）。它应该将两个列表作为输入，`#t`如果`pf`为 null 或等于`ls`.

我的问题是我的代码似乎根本不返回任何东西，`pf`而不是前缀`ls`并且`ls`不为空。如果我`#f`用其他东西替换 if语句`'()`中`'()`的`'()`'不为空，或者`'()`不等于`'()`）。它似乎与在 cond 语句中使用 if 语句有关。谁能告诉我它在做什么，或者为什么？是否有可能使此代码正常工作，还是我需要以另一种方式重新编写它？

谢谢您的帮助！

```
(define prefix
  (lambda (pf ls)
    (cond
      [(null? pf) #t]
      [(null? ls) #f]
      [(if (equal? (car pf) (car ls)) (prefix (cdr pf) (cdr ls)) #f)])
      )) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T16:17:08.800

有`if`一个`cond`条件通常是做错事的标志。我想你的意思是这样说：

```
(define prefix
  (lambda (pf ls)
    (cond
      [(null? pf) #t]
      [(null? ls) #f]
      [(equal? (car pf) (car ls)) (prefix (cdr pf) (cdr ls))]
      [else #f]))) 
```

# ios - UITextView 没有在 UITableViewCell 中水平滚动

> ID：12479720
> 
> 赞同：0
> 
> 时间：2012-09-18T15:04:10.567
> 
> 标签：ios, scroll, uitextview, xcode4.3

我已经用一个`UITableView`带有静态单元的控制器的简单项目对此进行了测试，将 4 或 5 个添加`UITextView`到单个单元中，将默认的 lorem ipsum 文本留在 中，运行项目。

您将看到滚动垂直而不是水平滚动。

任何想法如何让它向左/向右滚动？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:39:48.853

在处理这些单元格的代码中，只需使用以下内容。

```
[myTextView setShowsHorizontalScrollIndicator:YES]; 
```

或者，您可以在与其滚动视图相关的部分上的 UITextView 的 Attributes Inspector 上设置相同的属性。

# ruby-on-rails - Rails3 ActiveRecord 和自定义 SQL JOINS 与 default_scope

> ID：12479722
> 
> 赞同：2
> 
> 时间：2012-09-18T15:04:19.490
> 
> 标签：ruby-on-rails, wordpress, activerecord, scope

我需要将一个不存在的表映射到 ActiveRecord（在我的例子中：Wordpress 数据库模式），它由如下所述的自定义 SQL 语句组成。我希望能够在其他语句中使用 find()、first()、all()。有没有办法在不覆盖所有查找器方法的情况下完成此操作？（我目前正在重新定义这些方法，以实现类似的结果，但很想知道是否有更多的 ActiveRecord/Rails 方法可以做到这一点）

目前我正在做例如

```
class Category < ActiveRecord::Base
   self.table_name="wp_terms"
   def self.all
     Category.find_by_sql("select distinct(wp_terms.term_id),wp_terms.name,wp_term_taxonomy.description,wp_term_taxonomy.parent,wp_term_taxonomy.count from wp_terms inner join wp_term_relationships ON wp_term_relationships.object_id = wp_terms.term_id INNER JOIN wp_term_taxonomy ON wp_term_taxonomy.term_id = wp_terms.term_id where taxonomy = 'category';")
   end
end 
```

感谢您的任何指点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T04:07:04.520

您可以使用[默认范围](http://apidock.com/rails/ActiveRecord/Scoping/Default/ClassMethods/default_scope)：

```
class Category < ActiveRecord::Base
   self.table_name="wp_terms"

   # Individual scopes for readability - the names could be improved.
   scope :select_scope, select("DISTINCT(wp_terms.term_id), wp_terms.name, wp_term_taxonomy.description, wp_term_taxonomy.parent, wp_term_taxonomy.count")
   scope :join_scope, joins("INNER JOIN wp_term_relationships ON wp_term_relationships.object_id = wp_terms.term_id INNER JOIN wp_term_taxonomy ON wp_term_taxonomy.term_id = wp_terms.term_id")
   scope :where_scope, where("taxonomy = 'category'")

   default_scope select_scope.join_scope.where_scope
end 
```

然后你应该能够调用任何 finder 方法，`Category`而不必自己实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:17:46.197

您是否会考虑创建[Enterprise Rails](http://books.google.ie/books?id=thTju-4duY4C&lpg=PP1&ots=nFmsRSwKu0&dq=enterprise%20rails&pg=PA147&redir_esc=y#v=onepage&q&f=false)中所述的视图支持模型？

# javascript - 表格突出显示并在单击时显示其内容

> ID：12479723
> 
> 赞同：1
> 
> 时间：2012-09-18T15:04:33.187
> 
> 标签：javascript, jquery

我正在尝试在我的表上添加一个额外的功能，用户可以在其中单击任何 Rn。这应该突出显示整个列并显示来自突出显示的列 Rn TD 的一些隐藏内容。除了一些小错误（例如，您可以单击不应该出现这种情况的“玩家名称”列）之外，突出显示效果很好，但是需要更改的内容（例如玩家名称和比赛信息）没有改变..

此外，由于我添加了额外的代码以使表格突出显示工作，因此上一个和下一个按钮不再起作用。可以在这里找到工作的上一个/下一个版本：http: [//jsfiddle.net/yunowork/4UGre/](http://jsfiddle.net/yunowork/4UGre/)

我究竟做错了什么？

演示：http: [//jsfiddle.net/yunowork/4UGre/6/](http://jsfiddle.net/yunowork/4UGre/6/)

 `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:22:14.367

Try it in the last demo:

change:

```
rows.children().click(function() { ... 
```

to:

```
rows.children().not('.emptyrace, .race').on('click', function() { ...
//exclude the td with prev and next link 
```

We have again some bug (like highlight the R1, R2 element text) but this could be a starting point.`

# python - 源引擎中的 Apache2 和 Python

> ID：12479727
> 
> 赞同：1
> 
> 时间：2012-09-18T15:04:38.537
> 
> 标签：python, mysql, apache2, pymysql

我是一名 Eventscripts 开发人员 (www.eventscripts.com)，使用 Python 编写代码。这是反恐精英来源。但这并不重要。

我有一个带有 mysql 的本地 xampp apache2 服务器。我同时启动了 mysql 和 apache 来使用 phpMyAdmin。我正在编写一个小的 Admin-Script/Plugin 脚本，其中用户管理是通过 MySQL 完成的。

总而言之，这似乎不是问题，我想。我正在使用“pymysql”和 Python 2.7。我成功连接到 mysql，这是我的简单 mysql 类：

```
class MySQLError(Exception):
pass

class MySQLClass:        
   def connect(self):
      c = pymysql.connect(host=MYSQL_HOST, port=3306, user=MYSQL_USER, passwd=MYSQL_PASS, db=MYSQL_DB)
      self.cursor = c.cursor()
      if not self.cursor or not c:
         raise MySQLError, 'Failed to connect with MySQL!'
      else:
         es.dbgmsg(0, '[AD] MySQL: Connected!')

   def query(self, query):
      self.cursor.execute(query)

   def results(self):
      return self.cursor 
```

所以这门课基本上是有效的，写得不好——但有效。注意：es.dbgmsg(LEVEL, MESSAGE) - 将消息打印到控制台，就像打印一样。

现在这是基本信息！

**现在我们来解决我的问题！** 情况：我与我的服务器（python、mysql 类）连接，同时我尝试将数据添加到我的数据库中。但是当我点击“好的”时，它什么也不做，网站加载无限时间。但是，如果我关闭我的服务器（断开 python 与 mysql 的连接）它会立即完成并添加该行。

我能做些什么来解决这个问题？

# unity3d - 从场景窗口到游戏窗口的质量损失

> ID：12479730
> 
> 赞同：0
> 
> 时间：2012-09-18T15:04:44.250
> 
> 标签：unity3d

我试图弄清楚为什么我的模型在场景中看起来不错，但相机却把它渲染成卡通和扁平的。

![图片](../Images/5a8d0e02710d68cb99727b4f1e02b3f5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:08:10.007

原来是照明。我已将环境照明设置为白色。它照亮了我的场景，但不是我的游戏。我投入了新的光线，它看起来很棒。

# plone - 包装克隆数据

> ID：12479739
> 
> 赞同：5
> 
> 时间：2012-09-18T15:05:10.873
> 
> 标签：plone, versioning, history, undo

我是 Plone 的新手，正在尝试学习如何设置和维护服务器。我意识到我需要制定一个打包数据的时间表。现在我只是尝试使用 Zope 控制面板中的 pack 功能以及命令行（bin/zeopack）来测试它。

我知道在实践中我应该留下一周的历史，但是如果我打包到 0 天，我不应该看到所有编辑历史都消失吗？我没有看到这种情况发生。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T15:46:37.020

您可能会将“撤消”历史与版本历史混淆。打包数据库可以删除旧的、未使用的数据。这消除了您撤消旧事务的能力。

版本历史不一样。版本历史不被视为未使用的数据，并且不会在包中消除。

如果您不想编辑历史记录，请关闭版本控制。

# iphone - Store Kit 框架是否适用于 i OS 6 Simulator？

> ID：12479741
> 
> 赞同：6
> 
> 时间：2012-09-18T15:05:12.317
> 
> 标签：iphone, ios-simulator, in-app-purchase, ios6, xcode4.5

我在我的应用程序中实现了应用内购买。它在 iPhone 5.1 上运行良好。

我知道 Store Kit 不适用于 iPhone Simulator 5.1。但是在 i OS 6 模拟器上，我可以连接到 App Store，并且我会收到 App Purchase 确认警报。但事务在 iOS 6 模拟器上因错误而失败。

任何人请解释原因。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-21T12:54:57.153

**模拟器**

对于此版本，iOS 模拟器不支持测试应用内购买。请使用设备测试使用此功能的应用。

[iOS 6.0 发行说明](https://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T13:35:13.607

在 Xcode 4.5.2 和 iOS 5 和 iOS 6 上运行良好。我在 iPhone 5 和 4 以及所有 iPad 上都尝试过模拟器。模拟器中只有一点延迟，但交易功能齐全，我看到 iTunesConnect 中的配置非常重要。在我看来，最好在更改代码之前检查 ItunesConnect 配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T06:46:18.117

[文档](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/DevelopingwithStoreKit/DevelopingwithStoreKit.html#//apple_ref/doc/uid/TP40008267-CH103-SW3)说 IAP 可以在 sim 中进行全面测试，托管内容除外：

# git - 为什么 git-bisect 必须从工作树的顶级目录运行？

> ID：12479742
> 
> 赞同：68
> 
> 时间：2012-09-18T15:05:11.983
> 
> 标签：git, git-bisect

如果尝试从存储库根目录以外的任何位置运行任何 git-bisect 命令，则会被告知：

> 您需要从工作树的顶层运行此命令。

这是为什么？我知道没有其他 git 命令有这个要求，而且我看不出 bisect 应该是特殊的明显原因。手册页也没有提到这个限制。

这真的不是什么大不了的事。我主要只是好奇。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-09-22T08:04:42.907

查看项目中的一些提交，我看到了 Marcel M. Cary 的一个 (marcel@oak.homeunix.org)

他在提交中说（它恰好是关于 git-pull 但我认为它是相关的）

> “git pull”失败是因为 POSIX shell 有一个与 getcwd() 不同的当前工作目录的概念。shell 将此路径存储在 PWD 中。因此，"cd ../" 在 shell 脚本中的解释与在 C 程序中的 chdir("../") 不同。shell 通过从 PWD 中剥离最后一个文本路径组件来解释“../”，而 C chdir() 遵循文件系统当前目录中的“..”链接。当 PWD 是符号链接时，这些是不同的目的地。因此，Git 的 C 命令会找到正确的顶级工作树，而 shell 脚本则找不到。
> 
> [https://github.com/git/git/commit/08fc0608657ee91bc85276667804c36a93138c7d](https://github.com/git/git/commit/08fc0608657ee91bc85276667804c36a93138c7d)

所以我想说部分原因是因为 git-bisect 是一个 shell 脚本，它不能被信任自己找到顶层（当涉及符号链接时）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-08-15T02:06:27.617

平分过程需要检查项目的不同版本。如果特定修订不包含当前文件夹，则当前文件夹将被删除。

在这种情况下，您的 shell 最终可能会位于不再位于文件系统上的文件夹中！然后 Git 将无法找到顶层的`.git`文件夹，因此如果没有干预，对分过程将无法继续。

一个示范：

```
$ git rev-parse --show-toplevel
/path/to/project
$ mkdir tmp
$ cd tmp
$ rmdir ../tmp
$ git rev-parse --show-toplevel
fatal: Unable to read current working directory: No such file or directory 
```

当然，同样的问题可能会在执行时发生`git checkout`，并且可以在事后轻松修复，例如`cd ..`（willoller 解释了为什么它在 shell 中有效，但在 git 中无效）。

但是由于二等分是一个*过程*，因此在开始之前避免这种情况是有意义的，特别是如果我们想使用自动化，例如`git bisect run`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-03-03T20:59:10.233

> 因此，Git 的 C 命令会找到正确的顶级工作树，而 shell 脚本则找不到。

好吧，随着 Git 2.21（2019 年 2 月），**[`git bisect`](https://git-scm.com/docs/git-bisect)**它继续从 shell 脚本过渡到 C。

请参阅[Pranit Bauva](https://github.com/git/git/commit/06f5608c14e6972748b84649d5b8ffd335bbd209) ( ) 的提交 06f5608 、提交[450ebb7](https://github.com/git/git/commit/450ebb7359ec379a282670e85536540734c45eed)、[提交 129a6cf](https://github.com/git/git/commit/129a6cf344c4b352433f5a24de02a62783f6c6df)、[提交 4fbdbd5](https://github.com/git/git/commit/4fbdbd5bfff874330115f8d7556cf7c9f7f138c9)、[提交 e3b1e3b](https://github.com/git/git/commit/e3b1e3bdc0aa5fa6a474874a2395ae0584b2aea7)、[提交 0f30233](https://github.com/git/git/commit/0f30233a11f6d89fb387ddf96db64877adb90713)、[提交 5e82c3d](https://github.com/git/git/commit/5e82c3dd22aa804ba0ae571bf903b387b0f766a6) [（`pranitbauva1997`](https://github.com/pranitbauva1997) 2019 年 1 月 2 日[）](https://github.com/pranitbauva1997)。
帮助者：[Ramsay Jones ( `jeffhostetler`)](https://github.com/jeffhostetler)和[Stephan Beyer ( `sbeyer`)](https://github.com/sbeyer)。
^(（由[Junio C Hamano 合并 -- `gitster`--](https://github.com/gitster)在[09a9c1f 提交中](https://github.com/git/git/commit/09a9c1f427c110f1281eea55c48596c8c8701a13)，2019 年 2 月 7 日）)

> ## bisect--helper：`bisect_start`部分在 C 中的 shell 函数

> 在 C 中部分地重新实现`bisect_start`shell 函数并添加 `bisect-start`子命令以`git bisect--helper`从 git-bisect.sh 调用它。
> 
> 这尚未完成，但该迁移的副作用是能够`git bisect`从子文件夹执行。

* * *

Git 2.23 进一步改进了对 C 的转换。
参见[Johannes Schindelin ( ) 的](https://github.com/dscho)[commit 7877ac3](https://github.com/git/git/commit/7877ac3d7b8ae84981c9c2fa86a4f3701ade4510)（2019 年 5 月 21 日[）](https://github.com/dscho)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 5b476dc](https://github.com/git/git/commit/5b476dc2f13324852d0dbf7f2e5c020d1064ac8c))^(中，2019 年 6 月 17 日）)[`dscho`](https://github.com/dscho)
^([`gitster`](https://github.com/gitster))

* * *

使用 Git 2.25（2020 年第一季度），`bisect_reset`受益于修复。

请参阅[Tanushree Tumane ( ) 的](https://github.com/tanushree27)[提交 51a0a4e](https://github.com/git/git/commit/51a0a4ed9597e949930d92be59f42f991bc40a7c)（2019 年 12 月 9 日[）](https://github.com/tanushree27)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 4bfc9cc](https://github.com/git/git/commit/4bfc9ccfb6917805a4e1605bad359270172d145b))^(中，2019 年 12 月 25 日）)[`tanushree27`](https://github.com/tanushree27)
^([`gitster`](https://github.com/gitster))

> ## [`bisect--helper`](https://github.com/git/git/commit/51a0a4ed9597e949930d92be59f42f991bc40a7c): 避免使用后释放
> 
> ^(指导人：Johannes Schindelin)
> ^(指导人：Christian Couder)
> ^(签字人：Tanushree Tumane)
> ^(签字人：Miriam Rubio)

> 在[5e82c3dd22a](https://github.com/git/git/commit/5e82c3dd22aa804ba0ae571bf903b387b0f766a6)（“ `bisect--helper`：`bisect_reset`C中的shell函数”，2019-01-02，Git v2.21.0-rc0 --merge [）](https://github.com/git/git/commit/09a9c1f427c110f1281eea55c48596c8c8701a13)中，将`[`git bisect`](https://git-scm.com/docs/git-bisect) reset`子命令移植到C
> 中，调用`git checkout`失败时，报错（`could not check out original HEAD`）给用户。
> 
> 但是，此错误消息使用的`strbuf`是刚刚发布的。
> 让我们切换一下：首先使用它，然后释放它。

* * *

Git 2.26（2020 年第一季度）继续如此，其中“ `git bisect--helper`”的底层机制被重构为更易于重用的部分。

请参阅[Pranit Bauva](https://github.com/git/git/commit/6c69f2223394c200cce1289ac9200f781ef14da7) () 的提交 6c69f22 、提交[9ec598e](https://github.com/git/git/commit/9ec598e0d55ff263e47d95e7d4decef1eb1b6ac6)、[提交 45b6370](https://github.com/git/git/commit/45b6370812cb9bc50212d50f071c8ae5dd851698)、[提交 cdd4dc2](https://github.com/git/git/commit/cdd4dc2d6a3e420178100efc780a987495a1a3bd)、[提交 e8e3ce6](https://github.com/git/git/commit/e8e3ce67185fd493a07d84a5ce21b469701f8f64)、[提交 ce58b5d](https://github.com/git/git/commit/ce58b5d8b128568e9b4f37703377cbc22eaf00f5)、[提交 7613ec5](https://github.com/git/git/commit/7613ec594a3cb3a5b67bd4f363a557374e744dfb) [（`pranitbauva1997`](https://github.com/pranitbauva1997) 2020 年 2 月 17 日[）](https://github.com/pranitbauva1997)。
请参阅[Miriam Rubio (``)的](https://github.com/)[提交 680e8a0](https://github.com/git/git/commit/680e8a01e57cd383048bf4e7d9668ce715d6d649)、[提交 b8e3b2f](https://github.com/git/git/commit/b8e3b2f33994de25c068021e388dbef72a2cdc4a)、[提交 16538bf](https://github.com/git/git/commit/16538bfd2c429a81a86011f32afa189047afd6e5)（2020 年 2 月 17 日） 。 请参阅[提交 bfacfce](https://github.com/git/git/commit/bfacfce7d94951fe5b4e70bc2431dae5506b474b)，[提交 292731c](https://github.com/git/git/commit/292731c4c24bce5c9e3bdc7a246cfbc565ab93a1)（2020 年 2 月 17 日），作者[Tanushree Tumane (](https://github.com/tanushree27) [)](https://github.com/tanushree27)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在
[`tanushree27`](https://github.com/tanushree27)
^([`gitster`](https://github.com/gitster)[提交 25063e2，2020](https://github.com/git/git/commit/25063e2530e2fbdccf5d372a8ad80309421c9df1)年 3 月 5 日）)

例如：

> ## [`bisect--helper`](https://github.com/git/git/commit/bfacfce7d94951fe5b4e70bc2431dae5506b474b): 引入新`decide_next()`功能
> 
> ^(指导人：Christian Couder)
> ^(签字人：Tanushree Tumane)
> ^(签字人：Miriam Rubio)

> 让我们将代码重构`bisect_next_check()`为一个新的`decide_next()`辅助函数。
> 
> 这删除了一些`goto`语句，使代码更简单、更清晰、更容易理解。

* * *

在 Git 2.28（2020 年第三季度）之前，解析“ [`git bisect start`](https://git-scm.com/docs/git-bisect)”命令行的代码在验证参数时很松懈。

请参阅[Carlo Marcelo Arenas Belón ( ) 的](https://github.com/carenas)[提交 4d9005f](https://github.com/git/git/commit/4d9005ff5d1de0b4e82402320aab4ff27aa23b43)（2020 年 5 月 20 日[）](https://github.com/carenas)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([commit 63e50b8](https://github.com/git/git/commit/63e50b8678cbf9a9fd8c875d1f66f2f1a3d29088))^(中，2020 年 6 月 9 日）)[`carenas`](https://github.com/carenas)
^([`gitster`](https://github.com/gitster))

> ## [`bisect--helper`](https://github.com/git/git/commit/4d9005ff5d1de0b4e82402320aab4ff27aa23b43): 避免语法错误的段错误`start --term-*`
> 
> ^(签字人：Carlo Marcelo Arenas Belón)
> ^(签字人：Christian Couder)

> [06f5608c14](https://github.com/git/git/commit/06f5608c14e6972748b84649d5b8ffd335bbd209) (" `bisect--helper`: `bisect_start`shell function partial in C", 2019-01-02, Git v2.21.0-rc0 -- [merge](https://github.com/git/git/commit/09a9c1f427c110f1281eea55c48596c8c8701a13)`[` ) 为git bisect start添加了一个松散的解析器，`](https://git-scm.com/docs/git-bisect)`这可能导致在自定义 start 的语法错误调用下出现段错误条款。
> 
> 检测命令行中是否有足够的参数用于`--term-{old,good,new,bad}`和中止，如果没有，原始实现将显示相同的语法错误。

* * *

在 Git 2.29（2020 年第四季度）之前，" ^( ^([man](https://git-scm.com/docs/git-bisect)) ^)，当 X 和 Y 不是有效的提交对象名称时，应该将 X 和 Y 作为路径规范，但没有。[`git bisect start X Y`](https://github.com/git/git/blob/03a01824a4ee07cd06b152bbff45066d6cf5542b/Documentation/git-bisect.txt)

请参阅[Christian Couder ( ) 的](https://github.com/chriscool)[commit 73c6de0](https://github.com/git/git/commit/73c6de06aff8d14b5e9f55f393d25f1213f3d43d)（2020 年 9 月 25 日[）](https://github.com/chriscool)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 03a0182](https://github.com/git/git/commit/03a01824a4ee07cd06b152bbff45066d6cf5542b))^(中，2020 年 10 月 4 日）)[`chriscool`](https://github.com/chriscool)
^([`gitster`](https://github.com/gitster))

> ## [`bisect`](https://github.com/git/git/commit/73c6de06aff8d14b5e9f55f393d25f1213f3d43d): 启动时不要使用无效的 oid 作为 rev
> 
> ^(签字人：Christian Couder)
> ^(签字人：Johannes Schindelin)

> 在[06f5608c14](https://github.com/git/git/commit/06f5608c14e6972748b84649d5b8ffd335bbd209) (" `bisect--helper`: `bisect_start`shell function partial in C", 2019-01-02, Git v2.21.0-rc0 -- [merge](https://github.com/git/git/commit/09a9c1f427c110f1281eea55c48596c8c8701a13) ) 中，我们更改了以下 shell 代码：
> 
> ```
> -      rev=$(git rev-parse -q --verify "$arg^{commit}") || {
> -              test $has_double_dash -eq 1 &&
> -              die "$(eval_gettext "'\$arg' does not appear to be a valid revision")"
> -              break
> -      }
> -      revs="$revs $rev" 
> ```
> 
> 进入：
> 
> ```
> +      char *commit_id = xstrfmt("%s^{commit}", arg);
> +      if (get_oid(commit_id, &oid) && has_double_dash)
> +              die(_("'%s' does not appear to be a valid "
> +                    "revision"), arg);
> +
> +      string_list_append(&revs, oid_to_hex(&oid));
> +      free(commit_id); 
> ```
> 
> 如果无效的“ `arg`”当`"has_double_dash"`为假时，旧代码将“中断”出参数循环。
> 
> 但是，在新的 C 代码中，`oid_to_hex(&oid)`无条件地附加到“ `revs`”。这首先是错误的，因为“ `oid`”是`get_oid(commit_id, &oid)`失败的垃圾，其次是因为它没有跳出参数循环。
> 
> 不打破参数循环意味着“ `arg`”不被视为路径限制（这是错误的）。

* * *

在 Git 2.29（2020 年第四季度）中，继续用 C 重写“ [`git bisect`](https://github.com/git/git/blob/f4cc68cbd078d5c0dd707384c802510261c67a28/Documentation/git-bisect.txt)” ^(（[man](https://git-scm.com/docs/git-bisect)）)脚本。

请参阅Pranit [Bauva ( ) 的](https://github.com/pranitbauva1997)[提交 517ecb3](https://github.com/git/git/commit/517ecb3161daa4503f7638489fd44177b3659913)和[提交 09535f0](https://github.com/git/git/commit/09535f056b08445e28c4881064b8435fb434d760)（2020 年 9 月 24 日[）](https://github.com/pranitbauva1997)。 请参阅[Miriam Rubio ( ) 的 commit](https://github.com/mirucam) [c7a7f48](https://github.com/git/git/commit/c7a7f48f4fe8319867ea025e55e930b48455652a) （ 2020 年 9 月 24 日）和[commit 7b4de74](https://github.com/git/git/commit/7b4de74b5de5c1ceb035d33168d482ad213b4137)、[commit 3027676](https://github.com/git/git/commit/30276765c114bbd57ef0d8e6cf5489501599421a)、[commit ef5aef5](https://github.com/git/git/commit/ef5aef5ee0f8ff932f8beb21ff33a4dafee214b5)（2020 年 8 月 28 日[）](https://github.com/mirucam)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 f4cc68c](https://github.com/git/git/commit/f4cc68cbd078d5c0dd707384c802510261c67a28))^(中，2020 年 10 月 4 日）)[`pranitbauva1997`](https://github.com/pranitbauva1997)
[`mirucam`](https://github.com/mirucam)
^([`gitster`](https://github.com/gitster))

> ## [`bisect--helper`](https://github.com/git/git/commit/517ecb3161daa4503f7638489fd44177b3659913): 在 C 中重新实现`bisect_next`和`bisect_auto_next`shell 函数
> 
> ^(指导人：Lars Schneider)
> ^(指导人：Christian Couder)
> ^(指导人：Johannes Schindelin)
> ^(签字人：Pranit Bauva)
> ^(签字人：Tanushree Tumane)
> ^(签字人：Miriam Rubio)

> 在 C 中重新实现`bisect_next()`和`bisect_auto_next()`shell 函数，并将子命令添加到`[`git`](https://github.com/git/git/blob/517ecb3161daa4503f7638489fd44177b3659913/Documentation/git-.txt)<sup>([man](https://git-scm.com/docs/git-))</sup> bisect--helper`以从 git-bisect.sh 调用它们。
> 
> `bisect_auto_next()`函数返回一个枚举`bisect_error`类型，因为整个`[`git bisect`](https://github.com/git/git/blob/517ecb3161daa4503f7638489fd44177b3659913/Documentation/git-bisect.txt)<sup>([man](https://git-scm.com/docs/git-bisect))</sup>` 可以在退出时出现错误代码`bisect_next()`。
> 
> 失败时返回错误`bisect_next()`，修复 shell 脚本版本的错误。
> 
> 使用`--bisect-next`and`--bisect-auto-next`子命令是将 shell 函数移植到 C 以使用现有测试套件的临时措施。随着更多的功能被移植，`--bisect-auto-next`子命令将被淘汰并被其他一些方法调用。

* * *

在 Git 2.30（2021 年第一季度）中，C 中的“ [`git bisect`](https://github.com/git/git/blob/cfdc70b29935d3e7aa30d679e0076441f70a8ffe/Documentation/git-bisect.txt)” ^(（[man](https://git-scm.com/docs/git-bisect)）)重写仍在继续。

请参阅[Pranit Bauva](https://github.com/git/git/commit/b0f6494f70fd72141581ae2d392d9d793be08b81) () 的提交 b0f6494 、提交[5c517fe](https://github.com/git/git/commit/5c517fe345baa6bc7d0ecc31dd60c299dc6648ce)、[提交 9b437b0](https://github.com/git/git/commit/9b437b056d9b4c8c99fb1e9dfa0ad06072e2ab0f)、[提交 27257bc](https://github.com/git/git/commit/27257bc4661ed7ffb715922693c7a2bee136824c)、[提交 04774b4](https://github.com/git/git/commit/04774b4e7090e6b418ab053a6d4412a665cae703)、[提交 e439607](https://github.com/git/git/commit/e4396072e7b377ed4736e3fbd2b127e6e03da58c)、[提交 88ad372](https://github.com/git/git/commit/88ad372fc02c119a4e44ae71c93b6fab9d998512) [（`pranitbauva1997`](https://github.com/pranitbauva1997) 2020 年 10 月 15 日[）](https://github.com/pranitbauva1997)。
^(（由[Junio C Hamano 合并`gitster`——](https://github.com/gitster)在[提交 cfdc70b](https://github.com/git/git/commit/cfdc70b29935d3e7aa30d679e0076441f70a8ffe)中，2020 年 11 月 9 日）)

> ## [`bisect--helper`](https://github.com/git/git/commit/27257bc4661ed7ffb715922693c7a2bee136824c): 在 C 中重新实现`bisect_state`& `bisect_head`shell 函数
> 
> ^(指导人：Lars Schneider)
> ^(指导人：Christian Couder)
> ^(指导人：Johannes Schindelin)
> ^(签字人：Pranit Bauva)
> ^(签字人：Tanushree Tumane)
> ^(签字人：Miriam Rubio)
> ^(审核人：Johannes Schindelin)

> 在 C 中重新实现`bisect_state()`shell 函数，并添加一个子命令`--bisect-state`来`git-bisect--helper`调用它们`git-bisect.sh`。

* * *

使用 Git 2.31（2021 年第一季度）：继续用 C 语言重写“ [`git bisect`](https://github.com/git/git/blob/0871fb9af5aa03a56c42a9257589248624d75eb8/Documentation/git-bisect.txt)” ^(（[man](https://git-scm.com/docs/git-bisect)）)。

请参阅[Pranit Bauva](https://github.com/git/git/commit/97b8294474f8995ad67d57dbae6d524523a9ec2a) () 的提交 97b8294 、提交[e4c7b33](https://github.com/git/git/commit/e4c7b33747dccc6600bc528b51e91c11b474eb04)、[提交 9feea34](https://github.com/git/git/commit/9feea34810b750a6bca30ea82878fa2cbb0b830b)、[提交 b7a6f16](https://github.com/git/git/commit/b7a6f163d6273896e4f846f63dd711be0174522b)、[提交 68efed8](https://github.com/git/git/commit/68efed8c8a43ad95f4e517ea60034179418dd8bc)、[提交 2b1fd94](https://github.com/git/git/commit/2b1fd947f6d81ae772ebb75ef2e668866ab38c55)、[提交 97d5ba6](https://github.com/git/git/commit/97d5ba6a39253a38229dd4518afd0410d13f615a) [（`pranitbauva1997`](https://github.com/pranitbauva1997) 2021 年 2 月 3 日[）](https://github.com/pranitbauva1997)。
^(（由[Junio C Hamano 合并 -- `gitster`--](https://github.com/gitster)在[0871fb9 提交中](https://github.com/git/git/commit/0871fb9af5aa03a56c42a9257589248624d75eb8)，2021 年 2 月 17 日）)

> ## [`bisect--helper`](https://github.com/git/git/commit/68efed8c8a43ad95f4e517ea60034179418dd8bc): 退休`--bisect-write`子命令
> 
> ^(指导人：Lars Schneider)
> ^(指导人：Christian Couder)
> ^(指导人：Johannes Schindelin)
> ^(签字人：Pranit Bauva)
> ^(签字人：Tanushree Tumane)
> ^(签字人：Miriam Rubio)

> `--bisect-write`git-bisect.sh shell 脚本中不再使用该子命令。
> 相反，该函数`bisect_write()`是直接从 C 实现中调用的。

* * *

" [`git bisect`](https://github.com/git/git/blob/35381b13da846cc6ad620f9f9a5abf1d974d6e9b/Documentation/git-bisect.txt)" ^(( [man](https://git-scm.com/docs/git-bisect) ))在 2.30 时间范围内用 C 重新实现了更多，并没有将带注释的标签作为好/坏端点。
此回归已在 Git 2.31.1（2021 年第一季度）中得到纠正。

请参阅[Jeff King ( ) 的](https://github.com/peff)[提交 7730f85](https://github.com/git/git/commit/7730f85594d4595605934e39d1d816ab663d8fa8)（2021 年 3 月 16 日[）](https://github.com/peff)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 35381b1](https://github.com/git/git/commit/35381b13da846cc6ad620f9f9a5abf1d974d6e9b))^(中，2021 年 3 月 19 日）)[`peff`](https://github.com/peff)
^([`gitster`](https://github.com/gitster))

> ## [`bisect`](https://github.com/git/git/commit/7730f85594d4595605934e39d1d816ab663d8fa8): 将注释标签剥离到提交
> 
> ^(签字人：杰夫·金)

> 此补丁修复了一个错误，其中 ' [`git-bisect`](https://github.com/git/git/blob/7730f85594d4595605934e39d1d816ab663d8fa8/Documentation/git-bisect.txt)' ^(( [man](https://git-scm.com/docs/git-bisect) ))不处理接收带注释的标签为 " `git bisect`" 好`<tag>`等。
> 这是[27257bc](https://github.com/git/git/commit/27257bc4661ed7ffb715922693c7a2bee136824c)中的回归(" `bisect--helper`: reimplement `bisect_state`& `bisect_head`shell functions in C", 2020-10-15, Git v2.30.0- rc0 -[合并在](https://github.com/git/git/commit/cfdc70b29935d3e7aa30d679e0076441f70a8ffe)[批次 #4](https://github.com/git/git/commit/e4d83eee9239207622e2b1cc43967da5051c189c)中列出）。
> 
> 原来的shell代码叫做：
> 
> ```
> sha=$(git rev-parse --verify "$rev^{commit}") ||
>         die "$(eval_gettext "Bad rev input: \$rev")" 
> ```
> 
> 这会将输入剥离到提交（如果不可能，则抱怨）。
> 但是 C 代码只是调用`get_oid()`，这将产生标签的 oid。
> 
> 解决方法是剥离提交。
> 这里的错误消息对于 Git 来说有点不习惯（因为它以大写字母开头）。

新的错误信息：

```
Bad rev input (not a commit): xxxx 
```

* * *

警告：当自定义词用于新/旧时， “ [`git bisect skip`](https://github.com/git/git/blob/8ca4771dd0889ce269780b5f2b48166ffaff9570/Documentation/git-bisect.txt#L257-L289)” ^(（[man](https://git-scm.com/docs/git-bisect#_bisect_skip)）在 Git 2.31 中)*不起作用*，已在 Git 2.32（2021 年第二季度）中更正。

请参阅[Ramsay Jones ( ) 的](https://github.com/ramsay-jones)[提交 4cd66e7](https://github.com/git/git/commit/4cd66e7d6b423d3c5b161b55afb07cb1df59e75f)（2021 年 4 月 29 日[）](https://github.com/ramsay-jones)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 8ca4771](https://github.com/git/git/commit/8ca4771dd0889ce269780b5f2b48166ffaff9570))^(中，2021 年 5 月 11 日）)[`ramsay-jones`](https://github.com/ramsay-jones)
^([`gitster`](https://github.com/gitster))

> ## [`bisect--helper`](https://github.com/git/git/commit/4cd66e7d6b423d3c5b161b55afb07cb1df59e75f):`BISECT_TERMS`在 ' `bisect skip`' 命令中使用
> 
> ^(报告人：Trygve Aaberge)
> ^(签字人：Bagas Sanjaya)
> ^(签字人：Ramsay Jones)

> 提交[e4c7b33](https://github.com/git/git/commit/e4c7b33747dccc6600bc528b51e91c11b474eb04) (" `bisect--helper`: reimplement `bisect_skip`shell function in C", 2021-02-03, Git v2.31.0-rc0 -- [merge在](https://github.com/git/git/commit/0871fb9af5aa03a56c42a9257589248624d75eb8)[批处理 #9](https://github.com/git/git/commit/2283e0e9af55689215afa39c03beb2315ce18e83)中列出)，作为 shell 到 C 转换的一部分，忘记阅读 '`.git/BISECT_TERMS`在新的 ' `bisect skip`' 命令执行期间的条款'文件 ( )。
> 因此，“ `bisect skip`”命令将使用默认的“坏”/“好”术语。
> 如果二等分项已设置为非默认值（例如通过“ `bisect start`”命令），则“ `bisect skip`”命令将失败。
> 
> 为了纠正这个问题，我们在 ' ' 的 ' ' 命令实现中插入对该函数的调用，该`get_terms()`函数从该文件中读取非默认项（如果已设置）。`--bisect-skip``bisect--helper`
> 
> 此外，添加一个[测试](https://lore.kernel.org/git/xmqqim45h585.fsf@gitster.g/T/#m207791568054b0f8cf1a3942878ea36293273c7d)以防止潜在的未来回归。

* * *

在 Git 2.33（2021 年第三季度）中，“ [`git bisect`](https://github.com/git/git/blob/ae2d05d0c6b1834cfcfc5e060db6cf8d91160c5b/Documentation/git-bisect.txt)” ^(（[man](https://git-scm.com/docs/git-bisect)）)生成^（^([man](https://git-scm.com/docs/git-show-branch))^）只是为了在签出要测试的下一个版本后漂亮地打印提交的标题；这已用 C 重写。[`git show-branch`](https://github.com/git/git/blob/ae2d05d0c6b1834cfcfc5e060db6cf8d91160c5b/Documentation/git-show-branch.txt)

请参阅[Junio C Hamano ( ) 的提交](https://github.com/gitster)[1fcc40c](https://github.com/git/git/commit/1fcc40cd1dbfbdf6879a7b60a3a0250e46dc5c60) （ 2021 年 7 月 28 日）和[提交 ffcb4e9](https://github.com/git/git/commit/ffcb4e94d309db2889dac1d3dcbd0f4b2a0f6390)（2021 年 7 月 27 日[）](https://github.com/gitster)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 ae2d05d](https://github.com/git/git/commit/ae2d05d0c6b1834cfcfc5e060db6cf8d91160c5b))^(中，2021 年 8 月 24 日）)[`gitster`](https://github.com/gitster)
^([`gitster`](https://github.com/gitster))

> ## [`bisect`](https://github.com/git/git/commit/ffcb4e94d309db2889dac1d3dcbd0f4b2a0f6390): 不要仅仅为了显示当前提交而运行 show-branch

> 在 " " ( man ) 的脚本版本中[`git bisect`](https://github.com/git/git/blob/ffcb4e94d309db2889dac1d3dcbd0f4b2a0f6390/Documentation/git-bisect.txt)，^(我们[使用](https://git-scm.com/docs/git-bisect)") " [`git show-branch`](https://github.com/git/git/blob/ffcb4e94d309db2889dac1d3dcbd0f4b2a0f6390/Documentation/git-show-branch.txt)( ^(man [)](https://git-scm.com/docs/git-show-branch)来)描述 bisect 日志中的单个提交，并在签出要测试的下一个版本后向交互式用户描述。
> 
> `git show-branch`当写入 bisect 日志条目的辅助函数在 C 中的[0f30233](https://github.com/git/git/commit/0f30233a11f6d89fb387ddf96db64877adb90713)（“ `bisect--helper`：`bisect_write`C 中的 shell 函数”，2019 年 1 月 2 日，Git v2.21.0-rc0 -- [merge](https://github.com/git/git/commit/09a9c1f427c110f1281eea55c48596c8c8701a13)）处重写时，以前的“”用法就丢失了
> 
> 但是我们从[0871984](https://github.com/git/git/commit/0871984d304c9201b85897743eae583cd165106d) ( `bisect`: make , 2009-05-09, Git v1.6.4-rc0 -- [merge](https://github.com/git/git/commit/d34f715853526bf55f1fa422d56608c32433c8d1) ) (bisect: make " `git bisect`" use new `--next-all`bisect-helper function, 2009-05-09) 开始就一直保留后者使用在[ef24c7c](https://github.com/git/git/commit/ef24c7ca055f03c673c2b67a3a7c92bcc32f62f0) ( `bisect--helper`: add , 2009-04-19, Git v1.6.4-rc0 -- [merge](https://github.com/git/git/commit/d34f715853526bf55f1fa422d56608c32433c8d1) ) ( `bisect--helper`: add " `--next-exit`" to output bisect results, 2009-04-19) 中引入的忠实 C 重写。
> 
> 使用我们的帮助器::format_commit_message()显示 " `[<full hex>] <subject>`" 非常简单，而生成 show-branch 是一种过度杀伤力。 让我们失去一个外部进程。[`pretty.c`](https://github.com/git/git/blob/ffcb4e94d309db2889dac1d3dcbd0f4b2a0f6390/pretty.c)

# c# - 如何验证 4 次连续按钮点击（WPF 应用程序）

> ID：12479744
> 
> 赞同：1
> 
> 时间：2012-09-18T15:05:18.723
> 
> 标签：c#, wpf, visual-studio-2010, xaml

我无法弄清楚： - 如何捕获 4 次按钮点击并检查它们是否匹配正确的顺序，类似于输入 4 位 ATM 借记卡 PIN 码

我有一个 WPF 应用程序并添加了一个新窗口，该窗口有一个 PIN 键盘、数字 0-9、一个问号按钮（用作帮助按钮）、一个退格按钮（以防您单击了错误的数字）、一个 TextBox顶部显示一个点而不是数字（Wingdings - 字母“l”），以及一个隐藏的 TextBlock，如果没有按正确的顺序输入数字，则会显示不正确的 PIN 消息。目前，我只是硬编码 4 位 PIN（例如 7410），因为我的主要目标是学习如何捕获和验证按钮单击序列。由于我不会使用 Enter 键按钮，因此我想在单击最后一个数字并且顺序正确后立即继续到下一页，否则会显示 PIN 不正确的通知消息。

我猜我需要一个在每次单击按钮时调用的方法，该方法跟踪序列并每次循环返回，直到以正确的顺序单击所有 4 个数字，然后转到下一页。对不起，如果我解释得不好，还在学习，所以如果你需要更多细节，我会尽力提供更多。

先感谢您。

下面是密码键盘的 xaml 代码。

```
<Border BorderThickness="1" BorderBrush="Black">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <Border Background="Black" Height="50" Grid.ColumnSpan="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
            <TextBlock x:Name="PINTextBlock" Foreground="White" FontSize="18" FontFamily="Wingdings" VerticalAlignment="Center" HorizontalAlignment="Center" MaxWidth="4" />
        </Border>

        <TextBlock x:Name="ErrorMessageTextBlock" Foreground="Red" Visibility="Collapsed" Grid.ColumnSpan="3" Grid.Row="1" />

        <StackPanel Orientation="Horizontal" Grid.Row="2">
            <Button x:Name="SevenButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="SevenButton_Click" TabIndex="9">
                <TextBlock Text="7" FontSize="24" FontWeight="Bold" />
            </Button>
            <Button x:Name="EightButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="EightButton_Click" TabIndex="10">
                <TextBlock Text="8" FontSize="24" FontWeight="Bold" />
            </Button>
            <Button x:Name="NineButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="NineButton_Click" TabIndex="11">
                <TextBlock Text="9" FontSize="24" FontWeight="Bold" />
            </Button>
        </StackPanel>

        <StackPanel Orientation="Horizontal" Grid.Row="3">
            <Button x:Name="FourButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="FourButton_Click" TabIndex="6">
                <TextBlock Text="4" FontSize="24" FontWeight="Bold" />
            </Button>
            <Button x:Name="FiveButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="FiveButton_Click" TabIndex="7">
                <TextBlock Text="5" FontSize="24" FontWeight="Bold" />
            </Button>
            <Button x:Name="SixButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="SixButton_Click" TabIndex="8">
                <TextBlock Text="6" FontSize="24" FontWeight="Bold" />
            </Button>
        </StackPanel>

        <StackPanel Orientation="Horizontal" Grid.Row="4">
            <Button x:Name="OneButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="OneButton_Click" TabIndex="3">
                <TextBlock Text="1" FontSize="24" FontWeight="Bold" />
            </Button>
            <Button x:Name="TwoButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="TwoButton_Click" TabIndex="4">
                <TextBlock Text="2" FontSize="24" FontWeight="Bold" />
            </Button>
            <Button x:Name="ThreeButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="ThreeButton_Click" TabIndex="5">
                <TextBlock Text="3" FontSize="24" FontWeight="Bold" />
            </Button>
        </StackPanel>

        <StackPanel Orientation="Horizontal" Grid.Row="5">
            <Button x:Name="QuestionMarkButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="QuestionMarkButton_Click" TabIndex="0">
                <TextBlock Text="?" FontSize="24" FontWeight="Bold" />
            </Button>
            <Button x:Name="ZeroButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="ZeroButton_Click" TabIndex="1">
                <TextBlock Text="0" FontSize="24" FontWeight="Bold" />
            </Button>
            <Button x:Name="BackspaceButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="50" Height="50" Click="BackspaceButton_Click" TabIndex="2">
                <TextBlock Text="Õ" FontFamily="Wingdings" FontSize="24" FontWeight="Bold" />
            </Button>
        </StackPanel>

    </Grid>
</Border> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:16:13.457

您可以使用 Xaml 和转换器进行验证。你所要做的就是；

*   使用与 ErrorTextBlock 的绑定并侦听 PinTextBlock.Text 并通过转换器运行它，该转换器将进行实际验证。

这样，验证逻辑将被很好地分离并且可以重用。还有其他 WPF 内置验证方式，您可以在 Google 上搜索它们。（IDataErrorInfo 和 ValidationRules）。这将是“WPF”方式。

但是学习曲线有点陡峭。如果您只想完成这件事，那么可以，将其添加到 StackPanel：Button.Click="buttonClickHandler"，然后在代码隐藏中，您将收到您在单个位置单击的每个按钮。并在那里进行计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:22:51.657

每次单击按钮时，我都会有一个字符串被附加到（或在 or 的情况下进行修改`Backspace`） ，并且如果该字符串的长度为 4 个字符并且等于 PIN #`Clear`

如果是 4 个字符并且匹配，则转到下一页。如果是 4 个字符且不匹配，则显示错误消息。

我知道这是一个学习应用程序，但如果您将使用 WPF，我强烈建议您学习 MVVM 设计模式。

在那种情况下，我会有类似 a 的东西`List<KeyValuePair<string, ICommand>> Buttons`，它被绑定到一个`ItemsControl`带有3 行和 3 列的 a 的集合，以及一个将 Content 绑定到 the和 Command 到 the的集合，以及一个得到的值应显示错误消息时设置为 true。`ItemsPanelTemplate``UniformGrid``ItemTemplate``Button``Key``Value``bool IsErrorDisplayed`

```
<TextBlock x:Name="ErrorMessageTextBlock" Foreground="Red" 
           Visibility="{Binding IsErrorDisplayed, Converter={StaticResource BooleanToVisibiltyConverter}}" 
           Grid.ColumnSpan="3" Grid.Row="1" />

<ItemsControl ItemsSource="{Binding Buttons}">
    <!-- ItemsPanelTemplate -->
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <UniformGrid Columns="3" Rows="3" />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>

    <!-- ItemTemplate -->
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <Button Width="50" Height="50" Command="{Binding Value}">
                <TextBlock Text="{Binding Key}" FontSize="24" FontWeight="Bold" />
            </Button>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

我也可能会做一些事情来保护 PIN # 所以不会被存储为纯文本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T15:23:31.333

将它们全部关联到同一个事件处理程序。在这种情况下，使用逻辑将 x:Name 与 Integer 相关联并建立 4 位 PIN。这只是让您整合逻辑。

```
 private void one_Click(object sender, RoutedEventArgs e)
        {
            Button btn = (Button)sender;
            Int32 num;
            switch (btn.Name)
            {
                case "one":
                    num = 1;
                    break;
                case "two":
                    num = 2;
                    break;
                default:
                    // problem
            }
            if (PIN > 1000)   // logic
            // now you have you have num and can deal with the logic in one click event;
            PIN = (PIN * 10) + num;
            if (PIN = correctPIN)
            {
            }
            else
            {
            }          
        } 
```

# apache-flex - Flex viewstack addchild 动态添加，无需重新创建每个子项

> ID：12479745
> 
> 赞同：1
> 
> 时间：2012-09-18T15:05:20.250
> 
> 标签：apache-flex, repeater, addchild, viewstack

我有一个视图堆栈，里面有一个中继器来创建每个孩子。像这样的东西：

```
 <mx:ViewStack width="100%" height="100%" >
    <mx:Repeater id="myrepeater" dataProvider="{myDataProvider}">
    <mx:HBox width="100%" height="100%" >
    ---view content goes here---
    </mx:HBox>
    </mx:Repeater>  
    </mx:ViewStack> 
```

当我向数据提供者添加一个项目时，它会创建新的孩子，但它也会重新加载所有其他孩子，这是我不想要的。如何防止 Flex 在添加子组件时重新创建组件？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T12:26:05.043

您不能使用中继器“增量”执行此操作，您应该以编程方式执行此操作，而不是使用属于 Container的方法*addChild()因此它由例如中继器内第一级的 HBox 继承，*

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:50:16.457

如果您可以使用 Flex 4 或更高版本，请使用 a`DataGroup`或 a`List`而不是`Repeater`. 一切都会变得更好。

否则，您可以尝试`recycleChildren=false`在中继器上进行设置。

# ruby-on-rails - 错误消息部分未在 Rails 中呈现

> ID：12479749
> 
> 赞同：1
> 
> 时间：2012-09-18T15:05:27.683
> 
> 标签：ruby-on-rails, forms, validation

`error_messages.html.erb`在构建自定义验证时，我无法显示部分内容。

例如，我有一个进行交易的表格，其开头如下：

```
<%= form_for @transaction do |f| %>
  <%= render 'shared/error_messages', :object => f.object %> 
```

我有一个验证可以防止用户与自己进行交易：

```
validate :self_transaction_not_possible 
```

和

```
 def self_transaction_not_possible
      bel = Belonging.find_by_id(self.belonging.id)
      unless bel.nil?
        if self.user_id == bel.user_id
          errors.add(:base, "You cannot perform a transaction with yourself")
        end
      end
    end 
```

然后我在浏览器中运行了这样一个示例（在我拥有的财产上启动事务），并在 self_transaction_not_possible 中放置了一个调试器。我检查了验证是否发生，实际上，在调试器内部，我看到输入：self.errors.full_messages 给了我错误消息，因此似乎执行了验证......

然后我会期望，因为对象无效，错误消息会出现在我的视图中，但是没有......将调试器放在`error_messages.html.erb`部分中向我显示 object.errors.any 仍然 == {} :-/ ...

然后用户被重定向到保存过程失败时应该看到的页面（验证已正确执行），但他从未看到错误消息......

我错过了一些明显的东西吗？...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T12:31:02.647

好的......它失败的原因是因为我在控制器中执行 REDIRECT_TO 时没有保存事务，从而删除了`@transaction.errors`向量......

将其更改为`render :template => 'transactions/edit'`解决了我的问题..

当然，很难猜出这个问题：-/ ...

# r - 根据规则构建/可视化树

> ID：12479753
> 
> 赞同：2
> 
> 时间：2012-09-18T15:05:43.667
> 
> 标签：r

我有描述树的 if/then 语句。例如：

```
node1: if VAR1 < X node = 2 else node = 3
node2: if VAR2 < Y node = 4 else node = 5
node3: terminal value = Z
... 
```

不等式总是表示为小于“<”。这些规则不一定按照树深度的顺序。

忽略解析语句的工作，在 R 中构建/可视化树的最简单方法是什么？是否有一个对象/函数/包我可以根据规则调用一次以迭代地构建树然后调用 plot()？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T19:08:05.703

[扩展我之前给出的评论，这是派对](http://cran.r-project.org/package=party)包中示例`plot.BinaryTree`的顶部：

```
 set.seed(290875)

   airq <- subset(airquality, !is.na(Ozone))
   airct <- ctree(Ozone ~ ., data = airq)

   ### regression: boxplots in each node
   plot(airct, terminal_panel = node_boxplot, drop_terminal = TRUE) 
```

它会根据上面的`ctree`命令生成下图：

![在此处输入图像描述](../Images/7eaadfd9f8acd1aa7f541c6b58b49081.png)

该软件包有两个相当不错的小插曲，应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:03:29.173

我尝试深入研究 pkg:party 方法的代码，但无法非常有效地遵循依赖关系。我认为查看 rpart 包代码可能更容易。（编辑：进一步的想法是查看 igraph 包。）

```
require(rpart)
fit <- rpart(Kyphosis ~ Age + Number + Start, data=kyphosis)
print(fit)
#------------
n= 81 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 81 17 absent (0.79012346 0.20987654)  
   2) Start>=8.5 62  6 absent (0.90322581 0.09677419)  
     4) Start>=14.5 29  0 absent (1.00000000 0.00000000) *
     5) Start< 14.5 33  6 absent (0.81818182 0.18181818)  
      10) Age< 55 12  0 absent (1.00000000 0.00000000) *
      11) Age>=55 21  6 absent (0.71428571 0.28571429)  
        22) Age>=111 14  2 absent (0.85714286 0.14285714) *
        23) Age< 111 7  3 present (0.42857143 0.57142857) *
   3) Start< 8.5 19  8 present (0.42105263 0.57894737) *
#---code resumes ------
plot(fit) 
```

![在此处输入图像描述](../Images/a15a9bafef4c3dc70662039dd273b4d3.png)

```
rpart:::plot.rpart   # will show the code  ... depends on rpart::rpconvert
rpart::rpconvert 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-14T12:45:44.360

另一种选择是 data.tree 包。例如，您可以这样做：

```
tree <- Node$new("node1")
tree$AddChild("node2", edgeLabel = "VAR1 < X")
tree$AddChild("node3", edgeLabel = "VAR1 >= X")

print(tree, "edgeLabel") 
```

这将显示为：

```
 levelName  edgeLabel
1 node1              
2  ¦--node2   VAR1 < X
3  °--node3  VAR1 >= X 
```

或绘图：

```
SetEdgeStyle(tree, label = function(node) node$edgeLabel)
plot(tree) 
```

[![节点](../Images/28308cfa9b70b79e0674c8780d00c3c2.png)](https://i.stack.imgur.com/mFdfY.png)

每个节点都可以存储任何信息，因此解析也很简单，因为您可以在解析时将树用作路由器。

# c# - 下拉菜单 SelectIndexChange 未按预期工作

> ID：12479755
> 
> 赞同：0
> 
> 时间：2012-09-18T15:05:49.600
> 
> 标签：c#, javascript, drop-down-menu, webforms

```
//master.cs     
protected void ddlLanguage_SelectedIndexChanged(object sender, EventArgs e)
    {
    //alert box
            string message = "Some Content of the Site are only in English. Do you want to continue?";
            System.Text.StringBuilder sb = new System.Text.StringBuilder();
            sb.Append("return confirm('");
            sb.Append(message);
            sb.Append("');");
            Page.ClientScript.RegisterOnSubmitStatement(this.GetType(), "alert", sb.ToString());
       //alert end
            //Sets the cookie that is to be used by Global.asax
            HttpCookie cookie = new HttpCookie("CultureInfo");
            cookie.Value = ddlLanguage.SelectedValue;
            Response.Cookies.Add(cookie);

            //Set the culture and reload the page for immediate effect. 
            //Future effects are handled by Global.asax
            Thread.CurrentThread.CurrentCulture = new CultureInfo(ddlLanguage.SelectedValue);
            Thread.CurrentThread.CurrentUICulture = new CultureInfo(ddlLanguage.SelectedValue);
            Server.Transfer(Request.Path);
    }

//master  Page
<asp:DropDownList ID="ddlLanguage" class="langpnl" runat="server" AutoPostBack="True" 
        OnSelectedIndexChanged="ddlLanguage_SelectedIndexChanged">
        <asp:ListItem Value="en-US">Eng</asp:ListItem>
        <asp:ListItem Value="es-ES">Esp</asp:ListItem>
    </asp:DropDownList> 
```

每当用户从英语更改为西班牙语时，我都想显示一个警告框。这是一种奇怪的行为，此代码无法正常工作，它不会在所选索引更改时向我显示任何警报框，但是如果我将警报框代码粘贴到页面加载事件中，它会起作用。页面加载与此有关吗？其次，是否可以记住答案，即如果用户选择了一个复选框说记住我，我应该记住用户在整个会话期间选择的是还是否。关于第二个问题的任何建议都会有所帮助。但是请帮我找出上述代码没有按预期工作的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:09:34.337

尝试在您的以下代码`dropdownSelected index changed event`显示警报框

```
if (!ClientScript.IsStartupScriptRegistered("JSScript"))
            {
                //give the exception details in a alert box
                string sb = string.Format(@"<script>alert('{0}');</script>'", "Message to be shown");
                ClientScript.RegisterStartupScript(this.GetType(), "JSScript", sb);
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:14:28.763

`onchange="return CheckLanguage(this);"`使用而不是注册 javascript 事件`ClientScript.RegisterStartupScript`。

**HTML**

```
<asp:DropDownList ID="ddlLanguage" onchange="return CheckLanguage(this);" class="langpnl" runat="server" AutoPostBack="True" 
        OnSelectedIndexChanged="ddlLanguage_SelectedIndexChanged">
        <asp:ListItem Value="en-US">Eng</asp:ListItem>
        <asp:ListItem Value="es-ES">Esp</asp:ListItem>
    </asp:DropDownList> 
```

**Javascript**

```
<script Type="text/javascript>

function CheckLanguage(ddl)
{
    return confirm("Are you sure to change language");
}

</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T15:25:38.413

由于这种情况，您的事件处理程序无法按预期工作

```
Server.Transfer(Request.Path); 
```

如果可能，将其删除或尝试工作，一切都会好起来的

**编辑 ：**

要解决由`Server.Transfer`尝试这个引起的问题，看看它是否有意义

在你的 aspx 文件中

```
<asp:HiddenField runat="server" ID="hide" /> 
```

在你后面的代码中

```
protected void Page_Load(object sender, EventArgs e)
{
    if (hide.Value == "true")
    {
        Server.Transfer(Request.Path);
    }
    hide.Value = "";
}   

protected void ddlLanguage_SelectedIndexChanged(object sender, EventArgs e)
{
    ...

    sb.Append("if(confirm('")
     .Append(message)
     .Append("')){")
     .AppendFormat("document.getElementById('{0}').value = 'true'", hide.ClientID)
     .Append("}");

     ...

     Thread.CurrentThread.CurrentCulture = new CultureInfo(ddlLanguage.SelectedValue);
     Thread.CurrentThread.CurrentUICulture = new CultureInfo(ddlLanguage.SelectedValue);                
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T15:31:35.253

在用户有机会确认之前，您正在将用户发送到新页面。`Server.Transfer`请求一个新页面（即使它是相同的 url），所以你的 js 永远不会被写入页面。您需要在回发发生之前运行确认 js。

我认为您也不能阻止`SelectedIndexChanged`回发，因为 dot net 添加了它自己的 js 事件处理程序来完成此操作。我认为这里最不显眼的方法是制作一个新按钮，将语言处理程序代码移动到按钮的单击处理程序，然后在用户确认选择时使用客户端 js 来单击按钮。

```
 <asp:DropDownList ID="ddlLanguage" class="langpnl" runat="server" AutoPostBack="False">
        <asp:ListItem Value="en-US">Eng</asp:ListItem>
        <asp:ListItem Value="es-ES">Esp</asp:ListItem>
    </asp:DropDownList>
    <asp:Button ID="myHiddenButton" runat="server" Style="display: none;" OnClick="myHiddenButton_Click" />

void Page_PreRender(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        string message = "Some Content of the Site are only in English. Do you want to continue?";
        System.Text.StringBuilder sb = new System.Text.StringBuilder();
        sb.Append("if confirm('");
        sb.Append(message);
        sb.Append("') ");
        sb.AppendFormat("document.getElementById('{0}').click();", this.myHiddenButton.ClientID);

        //Page.ClientScript.RegisterOnSubmitStatement(this.GetType(), "alert", sb.ToString());

        // write your js as the client-side onchange handler on the ddl
        this.ddlLanguage.Attributes["onchange"] = sb.ToString();

        //alert end
    }

    this.myHiddenButton.Click += new EventHandler(myHiddenButton_Click);
}

void myHiddenButton_Click(object sender, EventArgs e)
{
    // only ever called if user confirms the js prompt

    //Sets the cookie that is to be used by Global.asax
    HttpCookie cookie = new HttpCookie("CultureInfo");
    cookie.Value = ddlLanguage.SelectedValue;
    Response.Cookies.Add(cookie);

    //Set the culture and reload the page for immediate effect. 
    //Future effects are handled by Global.asax
    Thread.CurrentThread.CurrentCulture = new CultureInfo(ddlLanguage.SelectedValue);
    Thread.CurrentThread.CurrentUICulture = new CultureInfo(ddlLanguage.SelectedValue);
    Server.Transfer(Request.Path);
} 
```

# python - 如何创建 WTForms 字段子类？

> ID：12479756
> 
> 赞同：2
> 
> 时间：2012-09-18T15:05:48.893
> 
> 标签：python, inheritance, wtforms

我正在尝试从 wtforms 的默认字段类创建子类。

```
class MyForm(Form):
    fieldName = MyField('field name') 
```

并且 MyField 是从另一个文件导入的

```
class MyField(TextField):
    def __init__(self):
        super(MyField, self).__init__(**kwargs) 
```

但是当我创建一个源自这里的 MyForm 时出现一些错误：

```
In [5]: f = MyForm()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
path/<ipython-input-5-decc3699f7c4> in <module>()
----> 1 f = RegistrationForm()

path/wtforms/form.pyc in __call__(cls, *args, **kwargs)
    176             fields.sort(key=lambda x: (x[1].creation_counter, x[0]))
    177             cls._unbound_fields = fields
--> 178         return type.__call__(cls, *args, **kwargs)
    179 
    180     def __setattr__(cls, name, value):

path/wtforms/form.pyc in __init__(self, formdata, obj, prefix, **kwargs)
    222             of a matching keyword argument to the field, if one exists.
    223         """
--> 224         super(Form, self).__init__(self._unbound_fields, prefix=prefix)
    225 
    226         for name, field in iteritems(self._fields):

pathwtforms/form.pyc in __init__(self, fields, prefix)
     37 
     38         for name, unbound_field in fields:
---> 39             field = unbound_field.bind(form=self, name=name, prefix=prefix, translations=translations)
     40             self._fields[name] = field
     41 

path/wtforms/fields/core.pyc in bind(self, form, name, prefix, translations, **kwargs)
    299 
    300     def bind(self, form, name, prefix='', translations=None, **kwargs):
--> 301         return self.field_class(_form=form, _prefix=prefix, _name=name, _translations=translations, *self.args, **dict(self.kwargs, **kwargs))
    302 
    303     def __repr__(self):

TypeError: __init__() got an unexpected keyword argument '_form' 
```

我想 _form 字段没有正确实例化。任何想法如何做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:40:22.733

您的`MyField.__init__`方法缺少必要的关键字 args。试试这个：

```
class MyField(TextField):
    def __init__(self, **kwargs):  # You were missing the **kwargs
        super(MyField, self).__init__(**kwargs) 
```

函数调用中的`*`和`**`运算符^((?))执行以下操作：

*   如果在函数签名中使用，它们指定所有剩余的位置 ( `*`) 或关键字 ( `**`) 参数应放置在`tuple`/ `dict`（分别）中，并且数据应绑定到`*`/后面的名称`**`。
*   如果在函数*调用*中使用，它们指定`tuple`or `list`(for `*`) 或`dict`(for `**`) 应该被解包并作为参数/关键字参数列表传递给函数。

# java - 在 Maven 中排除目标

> ID：12479757
> 
> 赞同：2
> 
> 时间：2012-09-18T15:05:50.527
> 
> 标签：java, maven, jetty

我已经使用 Selenium 进行了一些集成测试，所以我在预集成测试阶段定义了一个目标，所以我：

*   启动码头
*   部署应用
*   执行测试
*   停止码头

这在我的本地服务器上运行良好。

但是，现在我正在使用 tomcat 将应用程序部署到开发服务器，并且我希望使用此 tomcat 执行此测试，而不是使用 Jetty，并且我的构建尝试在与 tomcat (8080) 相同的端口上启动 Jetty 失败。我正在执行一个 mvn 包。

maven 中是否有任何参数可以用来跳过这个目标的执行？

这是我在集成测试之前用来启动服务器的代码片段：

```
 <plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>maven-jetty-plugin</artifactId>
            <version>6.1.10</version>
            <configuration>
                <scanIntervalSeconds>10</scanIntervalSeconds>
                <stopKey>foo</stopKey>
                <stopPort>9999</stopPort>
                <contextPath>/</contextPath>
            </configuration>
            <executions>
                <execution>
                    <id>start-jetty</id>
                    <phase>pre-integration-test</phase>
                    <goals>
                        <goal>run</goal>
                    </goals>
                    <configuration>
                        <scanIntervalSeconds>0</scanIntervalSeconds>
                        <daemon>true</daemon>
                    </configuration>
                </execution>
                <execution>
                    <id>stop-jetty</id>
                    <phase>post-integration-test</phase>
                    <goals>
                        <goal>stop</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2018-03-27T10:29:39.007

从 Maven 2.0.10 开始，可以使用命令行禁用一个或多个配置文件，方法是在其标识符前加上字符“！” 或 '-' 如下图所示：

```
mvn groupId:artifactId:goal -P !profile-1,!profile-2 
```

这可用于停用标记为 activeByDefault 的配置文件或将通过其激活配置激活的配置文件。

[这里](http://maven.apache.org/guides/introduction/introduction-to-profiles.html#Deactivating_a_profile)有更多信息

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T15:07:32.597

[您可以使用 Maven配置文件](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)解决您的问题。为 Jetty 容器创建一个配置文件并为 Tomcat 创建一个单独的配置文件

# java - 在不使用注释@HandleChain 的情况下实现 SOAPHandler

> ID：12479761
> 
> 赞同：1
> 
> 时间：2012-09-18T15:05:58.160
> 
> 标签：java, xml, web-services, websphere-7

我在使用 Websphere7 和 RSA 7.5 中的注释来实现 JAX-WS 服务时遇到问题。请查看此链接，解释我遇到的确切问题：

[WAS 7 的异常 java.util.zip.ZipFile.ensureOpenOrZipException](https://stackoverflow.com/questions/12400802/exception-java-util-zip-zipfile-ensureopenorzipexception-with-was-7)

由于我需要 webservices.xml 文件，因此我无法将应用程序模块从 2.5 更改为 2.4，因此我需要找到一些方法来实现 SOAPHandler 而不使用注释。

请让我知道这是否可能。

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:06:16.947

我用这个代码片段找到[了这个页面](http://pic.dhe.ibm.com/infocenter/p8docs/v4r5m1/index.jsp?topic=/com.ibm.p8.doc/developer_help/process_java_api/guide/web_services/ws_usage_headers.htm)（它适用于 FileNet，但我认为示例代码可以在其他地方工作）：

```
ProcessEngineServiceProxy pewsServiceProxy = new ProcessEngineServiceProxy();
pewsServiceProxy._getDescriptor().setEndpoint(url);

// install the handler chain
BindingProvider bp = (BindingProvider) pewsServiceProxy._getDescriptor().getProxy();
Binding pewsBinding = bp.getBinding();
List<Handler> handlerChain = new java.util.ArrayList<Handler>();
PEWSClientHeaderHandler wsSecurity = new PEWSClientHeaderHandler();
handlerChain.add(wsSecurity);
pewsBinding.setHandlerChain(handlerChain); 
```

此外，还有一个适用于 Metro 的答案，但类似的技巧也可能适用于 WebSphere：[https](https://stackoverflow.com/a/7849613/192801) ://stackoverflow.com/a/7849613/192801这个答案还显示了如何以编程方式注册处理程序：[https:// stackoverflow.com/a/1806477/192801](https://stackoverflow.com/a/1806477/192801)

# php - 只允许 PHP 脚本打开像 www.mydomain.com/topsecret/1/001.jpg 这样的 URL

> ID：12479763
> 
> 赞同：4
> 
> 时间：2012-09-18T15:05:58.473
> 
> 标签：php, .htaccess, security

我运行一个网络应用程序，将用户上传的文件存储在一个文件夹结构中，例如：

```
www.mydomain.com/uploads/topsecret/1/001.jpg
www.mydomain.com/uploads/topsecret/1/002.jpg 
```

现在，很容易猜出 003.jpg 和 004.jpg 的 url ...

因此，我只想限制用户访问 www.mydomain.com/app/，而不是其他任何内容。只有我在本地主机上的 .php 页面应该被允许访问最高机密的 pdf，比如

```
show.php:
<? if ($isAdmin) {
    echo "<img src='http://www.mydomain.com/uploads/topsecret/1/001.jpg'/>";
 } ?> 
```

也许有一个通过 .htaccess 或通过文件夹权限的解决方案。我知道我可以通过“headers”和“readfile”来解决这个问题，但是现在这会导致一些重构。

提前谢谢你，马蒂亚斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T18:49:43.367

这可能是您正在寻找的：

将包含此内容的 .htaccess 文件放在您不希望用户能够访问的文件夹的根目录中：

```
order deny,allow
allow from 127.0.0.1
deny from all 
```

这仍将允许从 Web 服务器上的 Web 浏览器访问 url，但尝试从任何其他计算机访问它们将导致 403 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T01:08:24.310

一些澄清：当你做一个

```
echo "<img src='....'>"; 
```

PHP 访问无关紧要（事实上，即使 PHP 无权访问该文件，它也可以工作！）。第一步是要意识到，是浏览器发出了对图像的请求。所以如果浏览器可以访问它，用户就可以通过猜测图像的名称来访问其他图像。如果您使用 PHP 中的 readfile 提供图像，这甚至会起作用。这就是为什么我写道你试图以错误的方式解决问题。

您*可以*做的是混淆图像名称（或您发送到 PHP 脚本的请求变量）。例如：使用盐 + MD5。这样用户就无法猜测名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:09:11.840

在 .htaccess 中使用：

```
<FilesMatch "\.(engine|inc|jpg|po|sh|.*sql|theme|tpl(\.php)?|xtmpl|svn-base)$|^(code-style\.pl|Entries.*|Repository|Root|Tag|Template|all-wcprops|entries|format)$">
  Order allow,deny
</FilesMatch> 
```

这将保护文件不被直接访问，然后例如设置您的默认 index.php 文件来处理 $_GET 请求：

```
 RewriteBase /

  # Rewrite URLs of the form 'x' to the form 'index.php?q=x'.
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_URI} !=/favicon.ico
  RewriteRule ^(.*)$ index.php?q=$1 [L,QSA] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T15:14:55.700

您可以嵌入以 base64 编码的图像，如下所示：

```
<img src="data:image/gif;base64,R0lGODlhUAAPAKIAAAsLav///88PD9WqsYmApmZmZtZfYmdakyH5BAQUAP8ALAAAAABQAA8AAAPb
WLrc/jDKSVe4OOvNu/9gqARDSRBHegyGMahqO4R0bQcjIQ8E4BMCQc930JluyGRmdAAcdiigMLVr
ApTYWy5FKM1IQe+Mp+L4rphz+qIOBAUYeCY4p2tGrJZeH9y79mZsawFoaIRxF3JyiYxuHiMGb5KT
kpFvZj4ZbYeCiXaOiKBwnxh4fnt9e3ktgZyHhrChinONs3cFAShFF2JhvCZlG5uchYNun5eedRxM
AF15XEFRXgZWWdciuM8GCmdSQ84lLQfY5R14wDB5Lyon4ubwS7jx9NcV9/j5+g4JADs=
" alt="British Blog Directory" width="80" height="15" /> 
```

您想要使用的方式`<? if ($isAdmin) ...`- 如果他是管理员，用户仍然可以看到这段代码 -> 他也可以猜测其他文件名......

这是一个链接：[http ://www.sweeting.org/mark/blog/2005/07/12/base64-encoded-images-embedded-in-html](http://www.sweeting.org/mark/blog/2005/07/12/base64-encoded-images-embedded-in-html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-19T01:11:04.100

如果允许，请在脚本中使用 readfile() 向用户显示图像。并正确阻止通过 .htaccess / chmoded 访问实际文件

# intellij-idea - IntelliJ 是否支持 VS Debugger Visualizers 之类的东西？

> ID：12479766
> 
> 赞同：3
> 
> 时间：2012-09-18T15:06:06.190
> 
> 标签：intellij-idea, debuggervisualizer

我想查看某个`Enumeration<T>`实例的内容。在没有类似 List/Array 的类型在其构造函数中接受它的情况下，另一个可行的选择是 Debugger Visualizer，它存在于 VS 中。

我怎样才能在 IntelliJ 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:39:52.043

IntelliJ IDEA为调试器提供了[数据类型渲染器：](http://www.jetbrains.com/idea/webhelp/debugger-data-type-renderers.html)

> IntelliJ IDEA 允许您指定不同对象在调试器中按类显示的方式。您可以指定要显示的表达式，而不是依赖对象的字符串表示。
> 
> 例如，如果一个对象代表一个用户，您可能希望看到由他们的登录名代表的用户；或者，对于缓存条目对象，它的年龄和内容可能是合适的。IntelliJ IDEA 将这些称为类型渲染器。

# jquery - jQuery Mobile 滑块问题

> ID：12479770
> 
> 赞同：0
> 
> 时间：2012-09-18T15:06:14.463
> 
> 标签：jquery, jquery-mobile

我有 4 个滑块，应该加起来 100。如果用户滑动前三个滑块并组合到总共 75 个，第四个滑块应该能够超过这个。我目前的逻辑设置为在滑块达到数量时停止计数，但我无法让滑块停止。

[这是关于 jsfiddle 的示例](http://jsfiddle.net/mysticgohan53/A2YsU/1/)

谁能告诉我为什么滑块不会停止滑动？我确信这可能是我错过的相对容易的事情。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:23:03.207

This works for me:

[http://jsfiddle.net/wroniasty/A2YsU/2/](http://jsfiddle.net/wroniasty/A2YsU/2/)

I believe calling `val()` within `change` handler is causing the problems.

# c# - TransformToVisual 值在枢轴事件后发生变化

> ID：12479771
> 
> 赞同：0
> 
> 时间：2012-09-18T15:06:15.630
> 
> 标签：c#, silverlight, windows-phone-7, pivot

我正在使用 c#、Silverlight、WP7。

我的应用程序中有一个 Pivot，在每个 LoadedPivotItem 事件之后，我想查看 UI 树以查看每个项目在屏幕上的位置。具体来说，我对边距值感兴趣，它是屏幕左侧的 x 偏移量。

这是我的代码：

```
GeneralTransform gt = myUIElement.TransformToVisual(Application.Current.RootVisual);
double x = ((MatrixTransform)gt).Matrix.OffsetX;
Debug.WriteLine("Margin = {0}, UIElement = {1}", x, myUIElement); 
```

当应用程序启动时，将执行此代码，打印输出示例如下：

```
Margin = 12, UIElement = System.Windows.Controls.TextBlock 
```

问题是，一旦我滑动（触发 LoadedPivotItem 事件）并移动到右侧的枢轴，边距变为负数。例子：

```
Margin = -468, UIElement = System.Windows.Controls.TextBlock 
```

奇怪的是，即使我滑回第一个 Pivot，边距上的值也会变为：

```
Margin = 492, UIElement = System.Windows.Controls.TextBlock 
```

如果我继续向一个方向滑动并最终回到第一个 Pivot，则边距上的值变为：

```
Margin = -468, UIElement = System.Windows.Controls.TextBlock 
```

我意识到这些数字都被 480 的屏幕尺寸所抵消，但对我来说似乎不一致，我不想处理通过屏幕尺寸进行的调整。

关于为什么会发生这种情况以及如何解决它的任何建议？
提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:45:36.633

我已经找到了解决这个问题的最简单的方法，那就是用屏幕宽度 %mod x 偏移量来获得实际的边距。这里我假设屏幕宽度是 480。

```
double x = ((MatrixTransform)gt).Matrix.OffsetX
if (x < 0)
{
    // modding a negative number is equal to the negative modding of the positive number
    x = 480 + (x % 480);
}
else
{
    x = x % 480;
} 
```

在左右旋转了很多次之后，我想我已经弄清楚发生了什么。UIElement 会根据您滑动的方式进行正向和负向转换，但是向左滑动和向右滑动不会相互抵消，因为 RootVisual 的 (0,0) 位置相对于 UIElement 会发生变化。

# c# - 具有复杂逻辑的对象到对象转换

> ID：12479773
> 
> 赞同：1
> 
> 时间：2012-09-18T15:06:32.903
> 
> 标签：c#, .net, design-patterns

假设我们有一些复杂类的对象`Foo`和一些分支类型层次结构，例如：

```
class Bar {}
class BarA:Bar{}
class BarB:Bar{}
class BarC:BarA{} 
```

任务是将 Foo 对象转换为 Bar 后代之一。我们有两组规则：

*   `Bar`关于我们应该根据`Foo`字段值选择哪个后代的规则。例如， if`foo.Type == "A"`和`foo.Complex == true`than`foo`应该转换为`BarC`object。
*   关于如何将`foo`字段转换为`BarXXX`字段的规则。例如，如果我们选择`BarA`作为目标类，`foo.Date`则应该转换为`barA.DateA`. 但如果我们选择`BarC`，`foo.Date`应该转换为`barC.DateC`应该`barC.DateA`是`DateTime.MinValue`。

我只是想避免重新发明轮子并使用条件逻辑编写意大利面条代码。我认为 AutoMapper 和 ValueInjecter 在这里无济于事。我正在寻找一些优雅的解决方案。请问有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:26:10.593

There is no need to go for an advanced pattern: a simple list of tuples `{predicate, builder}` is sufficient to satisfy your requirements.

Create a list of type `IList<Tuple<Predicate<Foo>,Func<Foo,Bar>>>`, and add pairs of "checkers" and "makers" to it, as follows:

```
private static readonly IList<Tuple<Predicate<Foo>,Func<Foo,Bar>>> CheckersAndMakers =
    new List<Tuple<Predicate<Foo>,Func<Foo,Bar>>>()
{
    new Tuple<Predicate<Foo>,Func<Foo,Bar>>(
        f => f.Type == "A" && f.Complex  // Checker
    ,   f => new BarC {DateC = foo.Date} // Maker
    )
,   new Tuple<Predicate<Foo>,Func<Foo,Bar>>(
        f => f.Type == "C" && !f.Complex  // Checker
    ,   f => new BarA {DateA = DateTime.MinValue} // Maker
    )
}; 
```

Now you can go through the checkers in a loop, and use its corresponding maker when you have a match:

```
Bar MakeFromFoo(Foo f) {
    foreach (var tuple in CheckersAndMakers) {
        if (tuple.Item1(f)) {
            return tuple.Item2(f);
        }
    }
    throw new ApplicationError("Unrecognized foo");
} 
```

# asp.net - 链接到 ASP.NET 中的网络文件夹

> ID：12479781
> 
> 赞同：4
> 
> 时间：2012-09-18T15:07:01.173
> 
> 标签：asp.net, .net, hyperlink, shared-directory, directory-permissions

我们在允许同一网络上的用户共享指向共享网络文件夹的链接时遇到问题。使用 ASP.NET，生成的代码如下：`<asp:HyperLink ID="HyperLink1" runat="server" NavigateURL="file://///server/network_folder/" />`

不幸的是，它没有达到我们想要的效果。无论是在 IE8、Firefox (15.0.1) 还是 Chrome (21.0.1180.89 m) 上，单击它都不会执行任何操作。

环顾四周，我发现只有在客户端浏览器将其设置为允许服务器权限时才能以这种方式访问​​它（显然，由于安全原因）。

为了省去必须手动为每个客户端浏览器设置权限的麻烦，是否可以在代码隐藏文件（C#）中允许临时权限？

欢迎任何其他建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:39:16.897

假设目标文件夹是一个简单的 Windows 网络共享（而不是 WebDAV 共享，只有 Internet Explorer 能够通过它可以协商的 Windows 凭据访问它。Chrome、FireFox 等不会自动协商 Windows 身份验证协议以提供授权访问目标文件夹上存在的任何 ACL 所需的身份。

至于为什么即使在 IE 中链接也会失败，您确定运行时链接实际上是您所期望的吗？如果无法解析链接，您至少应该收到一条弹出错误消息，指出无法找到文件或链接，这种性质的东西。完全没有回应有点好奇。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:36:19.003

似乎存在安全和实施问题：[指向本地网络共享的 HTML 链接](https://stackoverflow.com/questions/1465010/html-links-to-local-network-shares)

但是，您可以创建一个简单的 asp .net 请求处理程序 (ashx) 文件，该文件可以访问相关文件、设置 mime 类型并在响应流中返回文件。这意味着必须将文件发送到您的 Web 服务器，然后通过 http 再次传输，但这是一种选择。

# iis - URL 重写模块 appendQueryString

> ID：12479782
> 
> 赞同：1
> 
> 时间：2012-09-18T15:07:01.777
> 
> 标签：iis, url-rewriting

我遇到以下问题..

重写将查询字符串连接到有回发的页面的 URL 中。

也就是说，我有一个带有分页的搜索页面，它运行良好。但是当我点击进入第二页时，地址是这样的：

```
http://localhost/aaa/bbb/search-result?q=ccc 
```

为了这

```
http://localhost/aaa/bbb/search-result?param1=aaa&param2=bbb-0&page=% 2fsearch-result 
```

我们是否将 appendQueryString 设置为 false。但没有成功..

你有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T14:29:20.873

解决方案是覆盖此标记 <form id="form1" runat="server"> 标记，如此链接所示。

[http://msdn.microsoft.com/en-us/library/ms972974.aspx](http://msdn.microsoft.com/en-us/library/ms972974.aspx)转到此网址并搜索“处理回发”我认为这可以帮助你

# ios - Window.Print() 在构建到 iOS 时不起作用

> ID：12479786
> 
> 赞同：0
> 
> 时间：2012-09-18T15:07:13.453
> 
> 标签：ios, windows-phone-7, cordova, printing

我对在 PhoneGap 中编程还很陌生，我只从事一个项目，但我已经做了两个月了。我正在为 Windows Phone 编程，然后通过 PhoneGap 的网站进行构建。我遇到的问题是我正在使用 window.print() 打印一些报告。它在我的浏览器和 Windows Phone 上运行良好。但是，当我构建到 iOS 时，根本没有打印功能。它似乎只是跳过那行代码并继续。有没有人经历过这个？有什么帮助吗？我们正试图在明天的贸易展上展示此功能，因此非常需要立即提供帮助。谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-18T15:09:24.943

使用`console.log()` 它适用于所有主要平台

# c# - 自动更新变量

> ID：12479797
> 
> 赞同：0
> 
> 时间：2012-09-18T15:07:58.843
> 
> 标签：c#, reference

我有三个变量，`int`即和。我希望它始终是 和 的总和。如果我更改or的值，那么 的值应该会自动更新。如何做到这一点？`a1``a2``a3``a1``a2``a3``a2``a3``a1`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:12:03.520

@Randolf 是对的，您是否考虑过将它们放入一个类中并自动计算 a1 ，即

```
public class IntHolder()
{
  public int a2 {get; set;}
  public int a3 {get; set;}
  public int a1
  {
   get
   {
     return a2+a3;
    }
  }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T15:08:51.497

您将需要手动更新它。由于`int`是[原始类型](http://geekswithblogs.net/ftom/archive/2008/09/04/c-or-.net-primitive-types-value-types-reference-types-and.aspx)，它直接保存值而不是引用。因此，实现一个方法，每当 a2 或 a3 发生变化时，它将两者相加并将其值分配给 a1。或者只是将 a1 设置为始终计算值的只读属性。但是，对于第一种情况：

```
private int m_a2;
public int A2
{
    get { return m_a2; }
    set
    {
        m_a2 = value;
        CalculateSumAgain();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T15:11:53.147

使 a1 成为如下属性：

```
public int a1
{
   get
   {
      return a2 + a3;
   }
}

public int a2;
public int a3; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T16:01:33.703

而且，如果您希望它在本地运行- a1 的 lambda 几乎可以工作- 您不能以这种方式拥有本地属性，因此必须使用 a1 的方法调用语法，例如`a1()`：

```
void foo()
{
  int a2 = 3;
  int a3 = 4;
  Func<int> a1 = ()=> a2 + a3;
  Console.WriteLine(a1()); // 3+4 = 7
  a2 = 5;
  Console.WriteLine(a1()); // 5+4 = 9
} 
```

# java - Java 好奇的循环性能

> ID：12479798
> 
> 赞同：12
> 
> 时间：2012-09-18T15:08:00.647
> 
> 标签：java, performance, random, for-loop

我在评估我的 java 代码时遇到了一个大问题。为了简化问题，我编写了以下代码，它们产生了相同的奇怪行为。重要的是方法 run() 和给定的双值率。对于我的运行时测试（在 main 方法中），我将速率设置为 0.5 一次，另一次设置为 1.0。值为 1.0 时，将在每次循环迭代中执行 if 语句，而值为 0.5 时，if 语句将执行一半。出于这个原因，我预计第一种情况的运行时间会更长，但事实恰恰相反。谁能解释一下这个现象？？

主要结果：

```
Test mit rate = 0.5
Length: 50000000, IF executions: 25000856
Execution time was 4329 ms.
Length: 50000000, IF executions: 24999141
Execution time was 4307 ms.
Length: 50000000, IF executions: 25001582
Execution time was 4223 ms.
Length: 50000000, IF executions: 25000694
Execution time was 4328 ms.
Length: 50000000, IF executions: 25004766
Execution time was 4346 ms.
=================================
Test mit rate = 1.0
Length: 50000000, IF executions: 50000000
Execution time was 3482 ms.
Length: 50000000, IF executions: 50000000
Execution time was 3572 ms.
Length: 50000000, IF executions: 50000000
Execution time was 3529 ms.
Length: 50000000, IF executions: 50000000
Execution time was 3479 ms.
Length: 50000000, IF executions: 50000000
Execution time was 3473 ms. 
```

编码

```
public ArrayList<Byte> list = new ArrayList<Byte>();
public final int LENGTH = 50000000;

public PerformanceTest(){
    byte[]arr = new byte[LENGTH];
    Random random = new Random();
    random.nextBytes(arr);
    for(byte b : arr)
        list.add(b);
}

public void run(double rate){

    byte b = 0;
    int count = 0;

    for (int i = 0; i < LENGTH; i++) {

        if(getRate(rate)){
            list.set(i, b);
            count++;
        }
    }
    System.out.println("Length: " + LENGTH + ", IF executions: " + count);
}

public boolean getRate(double rate){
    return Math.random() < rate;
}

public static void main(String[] args) throws InterruptedException {
    PerformanceTest test = new PerformanceTest();

    long start, end;
    System.out.println("Test mit rate = 0.5");
    for (int i = 0; i < 5; i++) {
        start=System.currentTimeMillis();
        test.run(0.5);
        end = System.currentTimeMillis();
        System.out.println("Execution time was "+(end-start)+" ms.");

        Thread.sleep(500);
    }       
    System.out.println("=================================");
    System.out.println("Test mit rate = 1.0");      
    for (int i = 0; i < 5; i++) {
        start=System.currentTimeMillis();
        test.run(1.0);
        end = System.currentTimeMillis();
        System.out.println("Execution time was "+(end-start)+" ms.");
        Thread.sleep(500);
    }   
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T15:11:59.510

分支错误预测在第一种情况下会破坏性能。虽然第二种情况做了一些工作，但它有点直截了当，所以处理器可以很容易地预测下一步。请参阅此[维基百科页面](http://en.wikipedia.org/wiki/Branch_predictor)以获取更多信息。

尝试使用 0.7 进行测试。如果我是正确的，那么性能将介于 0.5 和 1.0 之间。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-18T15:40:39.597

为了确认您看到了[我评论中指出](https://stackoverflow.com/questions/12479798/java-curious-loop-performance/12480386#comment16789408_12479798)的分支错误预测的影响，我进行了一些测试。表格显示了速率（输入到您的运行方法）、`if`执行次数和运行时间。

```
0.0   0             1162
0.1   5,000,892     1204.25
0.2   10,002,410    1236.8
0.3   14,998,226    1264
0.4   19,996,983    1278
0.5   24,998,455    1305.5
0.6   29,998,879    1263.25
0.7   34,999,821    1232.25
0.8   39,999,414    1203.5
0.9   44,998,674    1202
1.0   50,000,000    1176.75 
```

你越接近 0.5，你得到的分支错误预测就越多（每次运行大约一个）。越接近 0 或 1，得到的分支预测就越准确（当 rate 为 0 或 1 时不会出现错误预测）。

因为一张图抵得上一千个字：

![在此处输入图像描述](../Images/cd860e3945d07400cb0e1c0c6c25e787.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:34:30.597

非常类似于[为什么处理排序数组比处理未排序数组更快？](https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array)幕后也有同样的原因。

# c# - 在屏幕上保留 NotifyIcon 气球提示

> ID：12479799
> 
> 赞同：1
> 
> 时间：2012-09-18T15:08:01.533
> 
> 标签：c#, notifications, balloon-tip

是否可以设置，除非我关闭它，否则气球尖端不会消失？

这是我的代码：

```
PazIcon.BalloonTipText = "It has happened!";
PazIcon.BalloonTipTitle = "Information";
PazIcon.BalloonTipIcon = ToolTipIcon.Info;
PazIcon.Visible = true;
PazIcon.ShowBalloonTip(30000); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:24:38.697

这不是[通知工具提示](http://msdn.microsoft.com/en-us/library/ms160064.aspx)的意图：

> 最小和最大超时值由操作系统强制执行，通常分别为 10 秒和 30 秒，但是这可能因操作系统而异。将太大或太小的超时值调整为适当的最小值或最大值。此外，如果用户似乎没有在使用计算机（没有发生键盘或鼠标事件），则系统不会将此时间计入超时。

如果您需要在屏幕上保留工具提示，则必须在角落弹出您自己的表单。

# ruby - 编写显示数组输出的测试

> ID：12479800
> 
> 赞同：0
> 
> 时间：2012-09-18T15:08:01.597
> 
> 标签：ruby, rspec

我想要`puts`一个数组的每个元素。如何为此编写测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T17:30:25.920

测试`puts`可能很困难，因为它本质上是不确定的。此外，可以安全地假设您使用的 ruby​​ 解释器具有非常好的测试覆盖率，因此编写自己的解释器的回报将是最小的。我认为您想测试您的数组操作代码，而不是`puts`.

# javascript - jQuery UI Slider 拒绝显示自定义句柄

> ID：12479802
> 
> 赞同：1
> 
> 时间：2012-09-18T15:08:07.603
> 
> 标签：javascript, jquery, html, css

我正在尝试使用本教程创建一个带有自定义句柄的 jQuery Slider：

[http://papermashup.com/jquery-ui-slider/](http://papermashup.com/jquery-ui-slider/)

在他们的演示页面上它可以工作，但是当我做同样的事情时，它不会显示自定义句柄图像。它正确显示其他所有内容。这是我正在使用的页面（您可以看到图像存在于服务器上并且应该显示）：

[http://jovansfreelance.com/stripe_pay/](http://jovansfreelance.com/stripe_pay/)

这是应该显示为滑块句柄的图像：

[http://jovansfreelance.com/stripe_pay/images/slider-button.png](http://jovansfreelance.com/stripe_pay/images/slider-button.png)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T15:13:08.007

您忘记将代码包装在 document.ready() 调用中。您的代码现在的方式是在页面中存在元素之前尝试执行。

尝试：

```
$(document).ready(function(){
    $( ".slider" ).slider({
           animate: true,
               range: "min",
               value: 50,
               min: 10,
               max: 100,
               step: 10,

               //this gets a live reading of the value and prints it on the page
               slide: function( event, ui ) {
                   $( "#slider-result" ).html( ui.value );
               },

               //this updates the hidden form field so we can submit the data using a form
               change: function(event, ui) {
               $('#hidden').attr('value', ui.value);
               }
    });
}); 
```

# javascript - 更新 d3 强制布局中的现有节点

> ID：12479809
> 
> 赞同：11
> 
> 时间：2012-09-18T15:08:26.087
> 
> 标签：javascript, d3.js, transition, force-layout

我使用 d3 创建了一个力布局，效果很好。我的初始数据是从一个 json 文件加载的，并且图表是使用类似于[此 d3.js 示例](http://mbostock.github.com/d3/talk/20111116/force-collapsible.html)的技术绘制的：

![在此处输入图像描述](../Images/8f8b4f15f68e4d3f273cab3f4afe8ecc.png)

现在图表在屏幕上，我需要从通过网络套接字接收的数据中即时添加、更新和删除节点。我有添加和删除方法工作，但我找不到更新现有节点属性的正确方法。

从我进行的阅读中，我收集到正确的技术是更改数据源，然后使用 enter() 方法更新图表。

要更新节点，我正在执行以下操作：

```
function updateNode(id, word, size, trend, parent_id){    
  var updateNode = nodes.filter(function(d, i) { return d.id == id ? this : null; });
  if(updateNode[0]){   
    updateNode.size = Number(size);
    updateNode.trend = trend;
    nodes[updateNode.index] = updateNode;      
    update();
  }
} 
```

然后更新函数更新节点：

```
function update(){
  node = vis.selectAll('.node')
  .data(nodes, function(d) {
    return d.id;
  })

  createNewNodes(node.enter());
  node.exit().remove();
  force.start();
}

function createNewNodes(selection){    
  var slct = selection.append('g')
  .attr('class', 'node')
  .call(force.drag);

  slct.append('circle')
    .transition()
    .duration(500)
    .attr('r', function(d) {
      if(d.size){
        return Math.sqrt(sizeScale(d.size)*40);
      }
   })
} 
```

我对此采取了正确的方法吗？当我尝试此代码时，尝试在圆上设置半径属性时获得的节点是节点数组中的最后一个节点。即包含分层节点数据而不是单个节点对象的那个。

任何指针将不胜感激，我在这上面花了太多时间:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-02-12T10:26:34.950

您需要多个点。我从您的问题中得到的是：“我如何使用可重用模式”

这个问题的简单答案是告诉你阅读 Mike Bostock 的这篇优秀教程：[朝向可重用图表](http://bost.ocks.org/mike/chart/)

如果您想了解更多信息，此文档选择可能会很有趣：

*   [选择文件](https://github.com/mbostock/d3/wiki/Selections)
*   [选择如何工作](http://bost.ocks.org/mike/selection/)
*   [条形图，第 2 部分](http://mbostock.github.io/d3/tutorial/bar-2.html)：可能是了解更新如何工作的最有趣的部分。

现在，这是我将为您的特定问题所做的实施草稿：

```
function ForceGraph(selector,data) {
   // This is the class that will create a graph

   var _data = data  
   // Local variable representing the forceGraph data 

   svg = d3.select(selector)
      .append('svg')
   // Create the initial svg element and the utilities you will need. 
   // These are the actions that won't be necessary on update. 
   // For example creating the axis objects, your variables, or the svg container

   this.data = function(value) {
      if(!arguments.length) {
         // accessor
         return _data;
      }
      _data = value;
      return this;
      // setter, returns the forceGraph object
   }

   this.draw = function() {
      // draw the force graph using data

      // the method here is to use selections in order to do: 
      // selection.enter().attr(...) // insert new data
      // selection.exit().attr(...) // remove data that is not used anymore
      // selection.attr(...) // 

   }
}

var selector = "#graphId";
var data = {nodes: [...],links: [...]};
myGraph = new ForceGraph(selector,data);
// Create the graph object
// Having myGraph in the global scope makes it easier to call it from a json function or anywhere in the code (even other js files). 
myGraph.draw();
// Draw the graph for the first time 

// wait for something or for x seconds  

var newData = {nodes: [...],links: [...]};
// Get a new data object via json, user input or whatever
myGraph.data(newData);
// Set the graph data to be `newData`
myGraph.draw();
// redraw the graph with `newData` 
```

正如您可能看到的，目标不是添加新节点的功能。目标是通过仅更新或删除现有节点并添加新节点来重新绘制整个力有向图。这样，绘图代码只写一次，然后只有数据改变。

为了进一步阅读，当我第一次解决这个问题时，这个问题是我的金矿：[Updating links on a forcedirected graph from dynamic json data](https://stackoverflow.com/questions/11400241/updating-links-on-a-force-directed-graph-from-dynamic-json-data)

# hadoop - Cassandra 在 Hadoop 中的使用

> ID：12479810
> 
> 赞同：3
> 
> 时间：2012-09-18T15:08:34.930
> 
> 标签：hadoop, cassandra

我有一项任务要调查将 cassandra 与 hadoop 一起使用。

Hadoop 的名称节点是单点故障。这意味着如果 namenode 出现故障，整个数据库将无法访问。所有 Cassandra 节点都是相同的，因此不存在单点故障。

如果我将 Cassandra 与 Hadoop 一起使用，我假设所有系统都有单点故障（据我所知，这是 Hadoop 名称节点）。

我的问题：

1-我之前的假设是真的吗？

2-如果是这种情况，使用这种结构（Cassandra with Hadoop）有什么好处吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T16:22:58.343

其半真半假。如果您将 Cassandra 与 Hadoop 一起使用，则所有数据都存储在 Cassandra 而不是 HDFS 中，并且 Hadoop 用于计算。因此，如果您的 namenode 出现故障，您唯一失去的就是运行 map reduce 任务的能力，但您的所有数据都将是安全且可访问的。

# c# - c#.net id重复不实报道

> ID：12479811
> 
> 赞同：0
> 
> 时间：2012-09-18T15:08:36.557
> 
> 标签：c#, webforms, runtime-error

我在视觉工作室中遇到一个错误，似乎完全错误。这里是：

```
The tag contains duplicate 'ID' attributes. 
```

在以下行：

```
Rica.Yoodul.MiniSites.BaseMiniSiteUserControl ucMaster = (Rica.Yoodul.MiniSites.BaseMiniSiteUserControl)Page.LoadControl("~/MiniSites/" + templateName + "/Master.ascx"); 
```

我已经检查了主页面和子页面是否重复了我上次添加的 ID（自上次成功测试以来唯一添加的 ID），并且该 ID 在两个文件中都使用过一次。除了控件（例如 ），此错误是否涉及任何内容？或者有解决方法吗？我已经检查过我正在编辑正确的文件。

从表面上看，这似乎是一个视觉工作室的错误，但我想确定一下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:11:59.047

这并不意味着在不同的控件中使用相同的 ID；这意味着可能在该`.ascx`文件中存在一个控件，其中包含两个`ID`属性。

# android - 使用 SimpleCursorAdapter 和 SQLite 在 ListView 中反转顺序

> ID：12479813
> 
> 赞同：2
> 
> 时间：2012-09-18T15:08:41.730
> 
> 标签：android, sqlite, listview, sql-order-by, simplecursoradapter

我正在使用 SimpleCursorAdapter 用我的 SQLite 数据库中的数据填充 ListView。数据很好，但最新的条目总是插入 ListView 的底部，我想把它放在顶部。

我已经找到了这篇[文章](https://stackoverflow.com/questions/5860732/reverse-the-order-of-listview-display)，但我不知道如何将它导入到我的项目中。目前我的 SQL 查询如下所示：

```
public Cursor fetchAllProjects() {

  Cursor mCursor = mDb.query(SQLITE_TABLE, new String[] {KEY_ROWID,
    KEY_ROUTERIP, KEY_PROJECTNAME, KEY_URL, KEY_CALIMERO}, 
    null, null, null, null, null);

  if (mCursor != null) {
   mCursor.moveToFirst();
  }
  return mCursor;
} 
```

我必须更改什么才能按降序查看 ListView？或者我是否必须在我的 SimpleCursorAdapter 上进行更改？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:35:55.960

要反转顺序，我必须像这样更改我的 SQL 处理程序中的查询！

```
Cursor mCursor = mDb.query(SQLITE_TABLE, new String[] {KEY_ROWID, KEY_ROUTERIP, KEY_PROJECTNAME, KEY_URL, KEY_CALIMERO}, null, null, null,  KEY_PROJECTNAME+" DESC"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T15:11:49.133

运行查询时，倒数第二个参数（此时为空）为`Order By`参数：[https ://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#query%28boolean,%20java.lang .String,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String,%20java.lang .String,%20java.lang.String%29](https://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#query%28boolean,%20java.lang.String,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%29)

您需要选择要排序的列，然后进行更改。为了安全起见，您可能应该以“正常”和“反向”顺序显式排序，以确保它按同一列排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-23T07:37:21.700

如果您不想使用查询，这里有一个替代方案：

```
cursor.moveToLast();
do
{
    // your code
}
while (cursor.moveToPrevious()); 
```

# ios - 触摸滚动视图时的 UIImageView 旋转 - iOS

> ID：12479814
> 
> 赞同：0
> 
> 时间：2012-09-18T15:08:45.057
> 
> 标签：ios, uiscrollview, uiimageview

我见过旋转`UIImageView`触摸的例子。我有一个案例，我应该`UIImageView`在滚动`UIScrollView`. UIImageView 是`UIScrollView`. 对此有何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:40:51.690

将委托设置为滚动视图并调用此方法：

```
– scrollViewWillBeginDragging: 
```

在里面旋转imageview：

```
imgView.transform = CGAffineTransformMakeRotation(1.57079633); //90 degrees 
```

然后在

```
– scrollViewDidEndDecelerating:

imgView.transform = CGAffineTransformMakeRotation(-1.57079633); //90 degrees 
```

# c# - 从 MemoryStream 加载时位图没有透明度

> ID：12479816
> 
> 赞同：1
> 
> 时间：2012-09-18T15:08:48.633
> 
> 标签：c#, bitmap, memorystream

当我写入`Bitmap`文件并从文件中读取时，我得到了正确的透明度。

```
using (Bitmap bmp = new Bitmap(2, 2))
{
    Color col = Color.FromArgb(1, 2, 3, 4);
    bmp.SetPixel(0, 0, col);
    bmp.Save("J.bmp");
}

using (Bitmap bmp = new Bitmap("J.bmp"))
{
    Color col = bmp.GetPixel(0, 0);
    // Value of col.A = 1\. This is right.
} 
```

但是，如果我将 a 写入`Bitmap`a`MemoryStream`并从中读取`MemoryStream`，则透明度已被删除。所有 alpha 值都变为`255`.

```
MemoryStream ms = new MemoryStream();
using (Bitmap bmp = new Bitmap(2, 2))
{
    Color col = Color.FromArgb(1, 2, 3, 4);
    bmp.SetPixel(0, 0, col);
    bmp.Save(ms, ImageFormat.Bmp);
}

using (Bitmap bmp = new Bitmap(ms))
{
    Color col = bmp.GetPixel(0, 0);
    // Value of col.A = 255\. Why? I am expecting 1 here.
} 
```

我希望将其保存`Bitmap`到 a`MemoryStream`并以透明的方式读回。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:19:06.017

问题是这一行：`bmp.Save(ms, ImageFormat.Bmp)`. ImageFormat.Bmp 不支持 alpha 值，您可以将其更改为 ImageFormat.Png 以获得相同的效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T15:19:45.777

AFAIK BMP 格式不支持透明度。检查将您的格式更改为，例如，PNG：

```
bmp.Save(ms, ImageFormat.Png); 
```

但是，您可以索引一个 .bmp，它将在第 256 个位置添加透明颜色。问题是，bmp 的很多图像要求是 24 位和 32 位，而透明索引图像只能转换为 16 位。

# iphone - managedObjectContext 是否在创建/打开托管文档之前初始化

> ID：12479820
> 
> 赞同：0
> 
> 时间：2012-09-18T15:09:02.323
> 
> 标签：iphone, cocoa-touch, core-data, uimanageddocument

我正在使用 UIManagedDocument 访问核心数据，我想知道的是，一旦我实例化了 managedDocument（在创建或打开之前），似乎 managedObjectContext 已经设置/初始化以供将来使用。我问的原因是我想在启动时将 managedObjectContext 传递给控制器​​，然后在创建或打开 managedDocument/数据库以供使用时在那里等待。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T10:29:08.617

答案是肯定的，一旦 UIManagedDocument 被实例化，managedObjectContext 就被设置并准备好传递给任何需要它的控制器。这也是在创建或打开磁盘上的实际核心数据 URL 之前完成的，因此您不必担心等待它传递/分配 managedObjectContext，另一方面您需要创建 URL /openened 如果你想从 Core Data 读取或写入任何数据。

# extjs - 包含 ExtJS4 中的常用函数

> ID：12479821
> 
> 赞同：1
> 
> 时间：2012-09-18T15:09:04.383
> 
> 标签：extjs

我有一些常用功能需要通过我的 ExtJS4 应用程序中的多个文件重用。下面是几个例子：

[https://gist.github.com/e651c32039dfdc60635d](https://gist.github.com/e651c32039dfdc60635d)

或者如果您不想访问链接：

```
/* This adds a method to String objects that allows you to test
*  whether or not a certain character or string exists in a target
*  string. In raw JS you need to check for .indexOf("test") !== -1
*/
String.prototype.contains = function( it ) { return this.indexOf( it ) !== -1; }; 
```

您如何创建类似于模块的东西，这些函数可以进入，然后只是“必需”或导入/加载到每个文件中，而不是如此不干燥并在每个文件中包含我需要使用它的函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T21:08:38.817

您可以使用命名空间来做到这一点。

[这里的文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext-method-namespace)

基本上我认为你想创建一个文件让我们说“Utils.js”并将它包含在某个地方（或者如果你使用版本 4.x，则使用extjs[自动加载动态加载）。](http://www.sencha.com/blog/countdown-to-ext-js-4-dynamic-loading-and-new-class-system)

在那个文件里面：

```
Ext.namespace('MyUtil.Array');

MyUtil.Array.doSomething = function(param){

   // method code here
} 
```

然后在其他一些文件中调用它：

```
MyUtil.Array.doSomething(param); 
```

至少我认为这是你要问的。显然，您可以使用命名空间来保存使用强大的 extjs 类系统创建的类（在我发布的第二个链接中也有说明）。

# apache - 我可以从我的 Web 服务器获取客户端和服务器的 IP 地址吗？

> ID：12479824
> 
> 赞同：0
> 
> 时间：2012-09-18T15:09:11.983
> 
> 标签：apache, ip, referrer

如果我有一个网络服务器通过 iFrame 向另一个网络服务器提供一些内容，我可以获得客户端和另一台服务器的 IP 地址吗？

示例：网络服务器“W”从客户端“C”获取一个网页请求，该网页加载了一个 iFrame，其中包含来自我的网络服务器“M”的内容。我可以得到“P”和“W”的IP地址吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:17:54.343

iFrame 是客户端组件。通过在 Web 服务器提供的 HTML 中嵌入 iFrame，您只需告诉客户端的浏览器向 iFrame`src`属性中的 URL 发出额外的请求（可能还会更多）。在服务器上，如果请求可能来自 iFrame 标记，则只有请求的引用者作为提示（除非您在发送的 HTML 中执行一些检查，但我想这超出了您的问题范围）。

IP 地址将始终来自请求的客户端，而不是来自其他服务器。

# r - 从 R 中的 MODIS 包运行 getModisWS 命令 时出错

> ID：12479830
> 
> 赞同：1
> 
> 时间：2012-09-18T15:09:19.437
> 
> 标签：r

我正在尝试`getModisWS`从 MODIS 包运行命令，但出现错误。

```
b <- getModisWS(40, -110, "MOD13Q1", "250m_16_days_NDVI", "A2000049", "A2000097", "1", "1") 
```

错误：

```
"Error occurred in the HTTP request:  Above-Below km subset size has to be an integer value NA" 
```

这是包文档中的示例，我无法通过修改上述 km 选项来使其工作。我正在运行 Mac OS v. 10.6.8 和 R v. 2.15.1。任何帮助，将不胜感激。

# javascript - 使用 showModalDialog 然后希望能够从结果对话框中选择文本

> ID：12479835
> 
> 赞同：0
> 
> 时间：2012-09-18T15:09:34.803
> 
> 标签：javascript, jquery, showmodaldialog

我`window.showModalDialog('../common/poe_details.jsp','self','dialogHeight:450px;dialogWidth:900px;status=0;scroll=yes');` 在我的应用程序中使用。现在的问题是我无法从结果 showModalDialog 中选择文本。我想从这个 showModalDialog 中选择和复制文本。任何有关此问题或任何替代独奏的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:17:09.760

我不完全清楚您要做什么，但是如果您使用 jQuery 模态对话框而不是“真正的”弹出窗口，您将拥有更多的控制权。示例：http: [//jqueryui.com/demos/dialog/modal-form.html](http://jqueryui.com/demos/dialog/modal-form.html)

这样，弹出窗口和主页面实际上是一页，所以它们都一起运行。

# unix - How to tar multiple files with the find command

> ID：12479836
> 
> 赞同：2
> 
> 时间：2012-09-18T15:09:36.910
> 
> 标签：unix, gzip, tar

I am trying to tar multiple files using the find command. I want to find all the files in the directory that contain a specific string in the file name and then tar those files. The string that I am want to find in the file name is the date.

For instance, I have a file name named ulog.20120914.log

What I'm doing right now is:

```
DAYTWOPREV=`date +%Y%m%d --date='2 days ago'`

function archive {
    cd $1;
    if [ ! -d archive ]; then
        mkdir archive;
    fi

TMPFILE=`mktemp`;
    find . -maxdepth 1 -name "${DAYTWOPREV}*" -type f -print0  > $TMPFILE;

    TARFILE=archive/${DAYTWOPREV}$2.tar;
    if [ ! -e $TARFILE ]; then
        echo tar cfT $TARFILE /dev/null;
        tar cfT $TARFILE /dev/null;
    fi  

cat $TMPFILE | xargs -0r tar rf $TARFILE
    cat $TMPFILE | xargs -0r rm -rf
    rm -f $TMPFILE;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:23:12.560

You can tell GNU `tar` to read the list of files to archive from its standard input:

```
find . -maxdepth 1 -name "${DAYTWOPREV}*" -type f | tar -czf archive.tar.gz -T - 
```

The `-T -` is the magic; `-T` means 'read file list from given file', and the (second) `-` indicates 'the file is standard input'. (I added the `z` option to compress the file using `gzip` and named the tar file accordingly. You might prefer `j` and `bzip2` with the `.bz2` extension. You might find your `tar` supports `xz` compression natively; the option letter is `-J` on Mac OS X and BSD. And BSD supports `--lzma` for LZMA compression.)

Also, with GNU `tar`, you can specify option `--null` (and then with GNU `find` use `-print0`) to handle even file names containing newlines. As written, this runs into issues if the file names contain newlines; otherwise, it works one file per line reliably enough, spaces and all.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T15:27:22.410

Assuming you have GNU tar (i.e. on Linux, not AIX, or HP-UX or ...):

```
find . -maxdepth 1 -type f -print0 | grep -z "${DAYTWOPREV}" | tar -cvf archive.tar --null -T /dev/stdin 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:43:27.353

Incidentally, tar does have an option (**`r` instead of `c`**) that fixes the "multiple invocations of tar" problem with some of these other solutions.

```
find . -maxdepth 1 -name '*20120914*' -exec tar rvf archive.tar {} +

find . -maxdepth 1 -name '*20120914*' -print0 | xargs -0 tar rvf archive.tar 
```

Actually, it looks like you're already using that. What exactly is missing from your existing solution? (Other than - I don't *think* you actually need the tar file to exist, so the /dev/null creation is an unnecessary step. However, I'm not in a position to test right now)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T15:52:48.087

I would just do this:

```
tar -cf $TARFILE ${DAYTWOPREV}* 
```

# websocket - wsgi 的 Websocket，与 werkzeug 兼容

> ID：12479837
> 
> 赞同：0
> 
> 时间：2012-09-18T15:09:39.087
> 
> 标签：websocket, wsgi, werkzeug

需要与 werkzeug 兼容的 websocket wsgi 库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T16:00:28.177

Twisted 提供了一个 WSGIResource 来在 Twisted Web 下运行。Autobahn 提供了一个在 Twisted Web 下运行的 WebSocketResource。因此，您可以将两者结合起来（我已经这样做了）-如果这就是“websocket wsgi库”的意思。

对于后者：[https ://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_site](https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_site)

免责声明：我是 Autobahn 的主要作者，并为 Tavendo 工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-29T15:43:50.987

我最近破解了 Werkzeug 调试器，因此它可以很好地与 gevent-socketio 配合使用：

[https://github.com/aldanor/SocketIO-Flask-Debug](https://github.com/aldanor/SocketIO-Flask-Debug)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:35:12.343

如果您刚刚开始，您也可以`gevent`特别检查一下。`gevent.socketio`

[http://gevent-socketio.readthedocs.org/en/latest/index.html](http://gevent-socketio.readthedocs.org/en/latest/index.html)

看看下面的教程，有点长，但它给了你很好的方法。

[http://blog.pythonisito.com/2012/07/realtime-web-chat-with-socketio-and.html](http://blog.pythonisito.com/2012/07/realtime-web-chat-with-socketio-and.html)

# coldfusion - 在 ColdFusion 中设置和存储 Application 和 THIS 参数的最佳方式是什么？

> ID：12479839
> 
> 赞同：4
> 
> 时间：2012-09-18T15:09:42.200
> 
> 标签：coldfusion, railo, application.cfc

我有我当前在 ApplicationSettings.cfm 和 ThisSettings.cfm 中设置的参数，我将它们包含在 Application.cfc 中。我想将这些设置与源代码分开，因为它们包含特定于环境的信息。我目前 gitignore 这些文件并将示例设置粘贴到上面我包含它们的评论中。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:33:38.863

有两种方法浮现在脑海。

*   我们创建一个 ApplicationSettings.cfm.template 并将其放入源代码管理中，但忽略真正的 AplicationSettings.cfm 文件。任何第一次获取代码的开发人员都将 ApplicationSettings.cfm.template 复制到 ApplicationSettings.cfm 并进行编辑以适应。

*   另一种方法是编写代码以从 .properties 文件中读取并将它们放在代码库之外。这样配置文件就是纯配置。这也意味着在生产中更新代码库不太容易出错，因为配置与代码不在同一个地方（我们有数百个部署，所以这对我们来说非常重要）。我们的代码库从 ../conf/config.properties 读取，因此它与代码库相关，但不在同一个地方。这是从属性文件设置应用程序范围属性的一个非常简单的示例：

    ```
     var e=props.propertyNames()
        for(e=props.propertyNames();e.hasMoreElements(); ){
            var key = e.nextElement();
            application[key]=props.getProperty(key);
        } 
    ```

# android - 将 VPI 添加到具有大量依赖项的项目会导致 3.0 之前的设备出现错误

> ID：12479844
> 
> 赞同：0
> 
> 时间：2012-09-18T15:09:57.223
> 
> 标签：android, intellij-idea, actionbarsherlock, roboguice, viewpagerindicator

我最近从 eclipse 切换到了 intellij，到目前为止，这是一次很棒的体验，我真的很喜欢它。但是，我遇到了一个奇怪的问题，我一直在用头撞墙。我正在尝试在我的应用程序中使用 ViewPagerIndicator、ActionBarSherlock、RoboSherlock 和 RoboGuice 以及其他一些常见框架。在我添加 VPI 之前一切正常。

基本上，当将 ViewPagerIndicator 依赖项添加到我的项目时，它会破坏 3.0 之前的设备的应用程序（在 3.0+ 上运行良好）。

该错误相当令人困惑，因为当 VPI apklib 存在时，似乎与 ABS 兼容主题没有被拾取（请注意，我在清单中使用的是 ABS 兼容主题）。

```
>09-18 10:33:15.986: ERROR/COM.IRIE.TASTEBUD/ObserverMethodListener.java:34(509): main java.lang.reflect.InvocationTargetException
        at java.lang.reflect.Method.invokeNative(Native Method)
        at java.lang.reflect.Method.invoke(Method.java:507)
        at roboguice.event.eventListener.ObserverMethodListener.onEvent(ObserverMethodListener.java:32)
        at roboguice.event.EventManager.fire(EventManager.java:130)
        at com.github.rtyley.android.sherlock.roboguice.activity.RoboSherlockActivity.onCreate(RoboSherlockActivity.java:63)
        at com.irie.tastebud.view.activity.MainActivity.onCreate(MainActivity.java:38)
        at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047) 
```

当我更深入地查看跟踪时，我看到了以下内容（即使我使用的是 sherlock 主题）：

> ```
>  Caused by: java.lang.IllegalStateException: You must use Theme.Sherlock, Theme.Sherlock.Light, Theme.Sherlock.Light.DarkActionBar, or a derivative.
>     at com.actionbarsherlock.internal.ActionBarSherlockCompat.generateLayout(ActionBarSherlockCompat.java:1007)
>     at com.actionbarsherlock.internal.ActionBarSherlockCompat.installDecor(ActionBarSherlockCompat.java:919)
>     at com.actionbarsherlock.internal.ActionBarSherlockCompat.setContentView(ActionBarSherlockCompat.java:853)
>     at com.actionbarsherlock.app.SherlockActivity.setContentView(SherlockActivity.java:218)
>     at roboguice.inject.ContentViewListener.optionallySetContentView(ContentViewListener.java:21)
>     ... 19 more** 
> ```

请参阅完整的异常堆栈跟踪和活动/清单/pom.xml 代码@https [://gist.github.com/3743646](https://gist.github.com/3743646)。

再一次 - 当添加 VPI 项目作为 Maven 依赖项时，这只发生在 3.0 之前的设备上。如果我删除 VPI - 该应用程序在 2.2+ 设备上运行良好。

据我所知，我的 Pom.xml 几乎与 Android Bootstrap 应用程序完全一样，它在 2.2+ 上运行良好。

我的猜测是我有某种依赖配置问题。我对 maven 和 intellij 非常熟悉，所以很难解决问题。

我不确定是否有其他人看到过这种行为，或者我是否犯了新手错误。任何帮助表示赞赏 - 如果我解决了这个问题，我会用答案更新这个问题。

提前感谢大家，如果我在这篇文章中违反了任何 stackoverflow 礼节，我们深表歉意。

编辑：发现潜在的相关问题@ [http://youtrack.jetbrains.com/issue/IDEA-90719](http://youtrack.jetbrains.com/issue/IDEA-90719)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T23:51:55.440

所以我没有使用默认的android构建配置，而是使用了android maven插件并做了一个mvn android:deploy-dependencies和android:run，问题就消失了。

在我只是为 intellij 使用默认的 android 构建配置之前，考虑到我首先使用 android maven 插件来管理我的依赖项，现在回想起来这似乎不是正确的方法。

希望这可以帮助某人。

PS intellij-idea 摇滚！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T08:01:36.787

我为这个问题找到了另一种解决方法，它的工作速度要快得多。在 Android facet config 中，将资源处理从*"Run 'process-resources' Maven task before Make"*更改为*"Compile resources by IDE"*。见附件截图。在此更改之后，所有 android 版本都可以正常**快速运行**

![构面配置](../Images/41a2194108fd6a84c3b5d105dd763147.png)

# php - 取决于阅读器的 TCPDF 嵌入字体消失

> ID：12479847
> 
> 赞同：4
> 
> 时间：2012-09-18T15:10:15.830
> 
> 标签：php, pdf, fonts, pdf-generation, tcpdf

我在使用带有嵌入式字体的 TCPDF PHP 库时遇到了一个非常烦人的问题。

我知道我以正确的方式使用它（如手册所述）并且字体已正确嵌入。

每当我尝试在 Adob​​e 阅读器上阅读我的输出文件时，它都能正常工作。

但是，当我使用 iPad 等非 adobe 阅读器时，有些字体会完全消失。

有关如何解决此问题或如何调试 PDF 文件的任何建议，以便我了解更多信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-11T20:06:20.080

使用 TTF 字体并像这样添加它们：

```
 $neueCE55r = $pdf->addTTFfont('ttf/HelveticaNeueCE55Roman.ttf', 'TrueTypeUnicode', '', 96);
 $pdf->SetFont($neueCE55r, '', 20, '', false); 
```

这些字体应该适用于所有系统。

# php - html安全输入值

> ID：12479848
> 
> 赞同：0
> 
> 时间：2012-09-18T15:10:26.050
> 
> 标签：php, html

我正在尝试通过以下方式将字符串放入隐藏的 html 输入字段中。

```
$str = "HBO's hit series a game of thrones...'";

echo "<input type='hidden' value='$str' />"; 
```

问题是这将返回类似...

```
<input type="hidden" value="HBO" s hit series a game of thrones.../> 
```

我不想使用`urlencode()`，或者`mysql_escape_string`因为它们不是合适的功能，所以对于这样的事情，正确的功能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:17:13.497

一个快速的解决方案是将单引号更改为双引号

```
echo '<input type="hidden" value="$str" />'; 
```

# java - 休眠注释关系

> ID：12479852
> 
> 赞同：0
> 
> 时间：2012-09-18T15:10:47.780
> 
> 标签：java, hibernate

现在我正在做一个小项目，提交非常简单的工作，我正在努力将它保存到数据库中。考虑这种情况：

```
public class Myjob{
   int id;
   int name;
   MyJobConfiguration configuration;
   //etc
}

public class MyJobConfiguration{
     //bunch of configuration fields
} 
```

如您所见，我将这些配置放在单独的类中，这意味着我想添加/更新/删除独立于我的作业对象的配置。

我的目标是首先创建配置，然后在创建作业时为其分配现有配置。

因此，多个作业可以使用相同的配置对象。

我该怎么做？我已经知道如何在数据库中执行此操作，我会将配置的主键连接到 myJob 类中的外键，但在休眠中似乎有所不同。有没有人有例子如何做到这一点？

我发现了这个，因为我认为是它[http://www.mkyong.com/hibernate/hibernate-one-to-one-relationship-example-annotation/](http://www.mkyong.com/hibernate/hibernate-one-to-one-relationship-example-annotation/)但似乎不是

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:27:42.697

You want a one to many relationship, not a one to one as described in the linked article.

You've got a clear idea of how you want the relationship to work, which is nice. Based on what you've said, I would make MyJobConfiguration look like this:

```
public class MyJobConfiguration {
    @OneToMany(mappedBy = "configuration")
    private List<MyJob> jobs;

    //bunch of configuration fields
} 
```

and MyJob look like this:

```
public class Myjob{
    int id;
    int name;

    @ManyToOne
    @JoinColumn(name = "configuration_id", nullable = false)
    MyJobConfiguration configuration;
    //etc
} 
```

I might even be inclined to give MyJob a constructor that takes a MyJobConfiguration instance, and make the MyJob() default constructor package-private scoped so that Hibernate can still use it, but callers can't.

# django - Django 的 ClearableFileInput 小部件在提交时未传递初始（“当前”）值

> ID：12479856
> 
> 赞同：3
> 
> 时间：2012-09-18T15:10:55.057
> 
> 标签：django, django-forms

我的基本目标是创建一个表单（使用`ModelForm`）预填充现有数据库对象中的数据，允许用户修改这些数据，然后将提交的表单保存为*新*对象。（类似于“复制”然后“粘贴修改”设置。）除了文件字段和 ClearableFileInput 小部件外，这工作正常。

[像this](https://stackoverflow.com/questions/4358356/django-forms-filefield-initial-field)、[this](https://stackoverflow.com/questions/3680603/does-django-repopulate-file-fields-on-form-error)和[this](https://stackoverflow.com/questions/4814104/how-to-pass-initial-value-of-filefield-to-formset-in-django)这样的问题的答案清楚地表明文件字段不能也不应该填充初始值。

然而，在[ClearableFileInput](https://docs.djangoproject.com/en/dev/ref/forms/widgets/#clearablefileinput)小部件上的 Django 文档说：

> 文件上传输入：`<input type='file' ...>`如果该字段不是必需的且具有***初始***数据，则带有一个额外的复选框输入以清除该字段的值。

（已经有点混乱了，但我假设 Django 指的是具有初始值的*模型*`<input type='file' ...>`字段，而该字段仍然是空白的？）

因此，如果我使用任何一种方法：

```
>>> obj = Foo.objects.get(pk=1)
>>> obj.fooFile.name
u'files/foo1.txt'
>>> f = FooForm(instance=obj) 
```

或这种方法：

```
f = FooForm(initial={'fooFile':Foo.objects.get(pk=1).fooFile}) 
```

为了实例化我的表单，ClearableFileInput 小部件显示：

[目前清除复选框，更改...输入 http://phagesdb.org/static/formDisplay.png](http://phagesdb.org/static/formDisplay.png)

但是，当用户在不更改此字段的情况下提交表单时，“当前”行中的值似乎完全丢失给 Django。它似乎不在`request.POST`或`form.cleaned_data`中。当我调用`.is_valid()`然后`.save()`在绑定的 ModelForm 上时，新对象中的文件字段最终为空白。

所以：

1.  ClearableFileInput 小部件是否传递“当前”值？如果不是，那么 ClearableFileInput 小部件是否具有误导性和/或用途非常有限？我假设返回的值将是“当前...”中的值，除非我使用“更改...”输入。

2.  如何捕获该值，以便在我调用时出现在我的新对象中`.save()`？（请记住，我不能使用`f = FooForm(request.POST, request.FILES, instance=obj)`，因为我想要一个新对象，而不是修改后的对象。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:07:59.357

在您的表单中放置一个隐藏字段，并使用您作为初始传入的图像的路径预填充它。然后编写一个类似于以下的保存方法。

这将向用户显示，好像文件字段已预先填充，将文件保存到新实例，并允许他们使用清除复选框，或上传他们自己的图像。

```
from django.core.files.base import ContentFile
def save(self, commit=True):
    insance = super(FormClass, self).save(False)
    if not instance.file_field and self.cleaned_data['file_field_path'] and not self.data.get('file_field-clear'):
        path = os.path.join(settings.MEDIA_ROOT, self.cleaned_data['file_field_path'])
        with open(path) as f:
            file_object = ContentFile(f.read())
            instance.file_field.save(self.cleaned_data['file_field_path'], file_object, False)

    if commit:
        insance.save()
    return insance 
```

# javascript - Twitter Bootstrap：关闭下拉菜单时调用 js 函数

> ID：12479858
> 
> 赞同：49
> 
> 时间：2012-09-18T15:10:56.693
> 
> 标签：javascript, twitter-bootstrap, dom-events

当引导下拉菜单关闭或切换时，我可以绑定一个事件吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2015-07-16T01:45:08.727

来自[twitter bootstrap 官方页面](http://getbootstrap.com/javascript/#dropdowns)：

```
$('#myDropdown').on('hide.bs.dropdown', function () {
  // do something…
}); 
```

`hide.bs.dropdown`是[此处描述的 4 个事件之一](http://getbootstrap.com/javascript/#dropdowns-events)。

### 更新（2016 年 4 月 13 日）

这些事件在`Bootstrap 4`. [引导 v4 文档](http://v4-alpha.getbootstrap.com/components/dropdowns/#events)。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-08-29T20:46:24.340

无论您点击什么，这就是 Bootstrap v2.3.2 关闭菜单的方式：

```
$('html').on('click.dropdown.data-api', function () {
    $el.parent().removeClass('open')
}); 
```

如果您使用的是 v2.x，这可用于了解菜单何时关闭。但是，请记住，这会在每次点击时触发。如果您只需要在菜单真正关闭时执行某些操作（可能一直如此），那么您首先需要跟踪菜单何时打开。在这方面，公认的答案可能是更好的解决方案。

然而，在 Boostrap v3.0.0 中，下拉菜单支持四个单独的事件：

> **show.bs.dropdown**：调用 show 实例方法时立即触发此事件。
> 
> **shown.bs.dropdown**当下拉菜单对用户可见时触发此事件（将等待 CSS 转换完成）​​。
> 
> **hide.bs.dropdown**调用 hide 实例方法时立即触发此事件。
> 
> **hidden.bs.dropdown**当下拉菜单完成对用户隐藏时触发此事件（将等待 CSS 转换完成）​​。

来自[Bootstrap 的文档](http://getbootstrap.com/javascript/#dropdowns-usage)。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-09-21T17:17:37.997

最后，我找到的唯一可靠的方法是使用jquery的data api来存储下拉列表的状态，并为按钮和文档添加点击事件。

```
$(document).ready(function() {

    $('#dropdown').data('open', false);

    $('#dropdown-button').click(function() {
        if($('#dropdown').data('open')) {
            $('#dropdown').data('open', false);
            update_something();
        } else
            $('#dropdown').data('open', true);
    });

    $(document).click(function() {
        if($('#dropdown').data('open')) {
            $('#dropdown').data('open', false);
            update_something();
        }
    });

}); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-18T15:51:52.430

没有记录的事件，但您可以使用jQuery事件的`.open`类：`.dropdown``click()`

```
$('#the-dropdown').click(function () {
    if($(this).hasClass('open')) {
        alert('it works');
    }
}); 
```

对于切换，仅使用`click()`事件。

[这](http://jsfiddle.net/simbirsk/cWkXK/1/)是jsfiddle。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-22T15:40:48.190

诺兰，我假设您所说的“这不起作用”是指：当用户单击页面上的其他任何地方并且没有正确关闭按钮/下拉菜单时。您可以通过以下方式监控这些点击（文档上的任何位置）：

```
$(document).click(function() {
    //check which element was clicked on
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-05-14T12:13:22.003

我做了我的，如下所示。

HTML：

```
<ul class="nav navbar-nav navbar-right">
                    <li id="theme_selector" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theme <b class="caret"></b></a>
                        <ul id="theme" class="dropdown-menu" role="menu">
                            <li><a href="#">Amelia</a></li>
                            <li><a href="#">Cerulean</a></li>
                            <li><a href="#">Cyborg</a></li>
                            <li><a href="#">Cosmo</a></li>
                            <li><a href="#">Darkly</a></li>
                            <li><a href="#">Flatly</a></li>
                            <li><a href="#">Lumen</a></li>
                            <li><a href="#">Simplex</a></li>
                            <li><a href="#">Slate</a></li>
                            <li><a href="#">Spacelab</a></li>
                            <li><a href="#">Superhero</a></li>
                            <li><a href="#">United</a></li>
                            <li><a href="#">Yeti</a></li>
                        </ul>
                    </li>
                </ul> 
```

脚本

```
$('#theme li').click(function () {
   switch_style($(this).text());
        }); 
```

效果很好

# android - 使用水平和垂直平移/拖动和捏缩放查看

> ID：12479859
> 
> 赞同：19
> 
> 时间：2012-09-18T15:11:00.403
> 
> 标签：android, android-layout

是否有可能有一个支持水平和垂直平移/拖动的视图。最重要的是，我希望能够捏缩放和双击缩放。这个视图是否存在于 Android 上，或者是否有人知道有一个项目？

为了使它更加困难，需要将另一个视图（Button、TextView、VideoView、...）添加到视图中。当第一个/父视图放大或移动时，子视图（按钮）需要与父视图一起移动。

我尝试了多种解决方案，但没有一个具有我正在寻找的选项。

*   [https://github.com/MikeOrtiz/TouchImageView/tree/master/src/com/example/touch](https://github.com/MikeOrtiz/TouchImageView/tree/master/src/com/example/touch)
*   [http://vivin.net/2011/12/04/implementing-pinch-zoom-and-pandrag-in-an-android-view-on-the-canvas/](http://vivin.net/2011/12/04/implementing-pinch-zoom-and-pandrag-in-an-android-view-on-the-canvas/)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-19T15:15:49.347

我认为有可能实现你想要的，但据我所知，它有内置的解决方案。从你问题的第二部分，我猜你不想要一个可缩放的，`View`而是一个`ViewGroup`可以包含其他视图（例如布局）的所有视图的超类。以下是您可以从构建自己的 ViewGroup 开始的一些代码，其中大部分来自[此](http://android-developers.blogspot.de/2010/06/making-sense-of-multitouch.html)博客文章：

```
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Matrix;
import android.graphics.Rect;
import android.view.*;

public class ZoomableViewGroup extends ViewGroup {

    private static final int INVALID_POINTER_ID = 1;
    private int mActivePointerId = INVALID_POINTER_ID;

    private float mScaleFactor = 1;
    private ScaleGestureDetector mScaleDetector;
    private Matrix mScaleMatrix = new Matrix();
    private Matrix mScaleMatrixInverse = new Matrix();

    private float mPosX;
    private float mPosY;
    private Matrix mTranslateMatrix = new Matrix();
    private Matrix mTranslateMatrixInverse = new Matrix();

    private float mLastTouchX;
    private float mLastTouchY;

    private float mFocusY;

    private float mFocusX;

    private float[] mInvalidateWorkingArray = new float[6];
    private float[] mDispatchTouchEventWorkingArray = new float[2];
    private float[] mOnTouchEventWorkingArray = new float[2];

    public ZoomableViewGroup(Context context) {
        super(context);
        mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
        mTranslateMatrix.setTranslate(0, 0);
        mScaleMatrix.setScale(1, 1);
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                child.layout(l, t, l+child.getMeasuredWidth(), t + child.getMeasuredHeight());
            }
        }
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                measureChild(child, widthMeasureSpec, heightMeasureSpec);
            }
        }
    }

    @Override
    protected void dispatchDraw(Canvas canvas) {
        canvas.save();
        canvas.translate(mPosX, mPosY);
        canvas.scale(mScaleFactor, mScaleFactor, mFocusX, mFocusY);
        super.dispatchDraw(canvas);
        canvas.restore();
    }

    @Override
    public boolean dispatchTouchEvent(MotionEvent ev) {
        mDispatchTouchEventWorkingArray[0] = ev.getX();
        mDispatchTouchEventWorkingArray[1] = ev.getY();
        mDispatchTouchEventWorkingArray = screenPointsToScaledPoints(mDispatchTouchEventWorkingArray);
        ev.setLocation(mDispatchTouchEventWorkingArray[0],
                mDispatchTouchEventWorkingArray[1]);
        return super.dispatchTouchEvent(ev);
    }

    /**
     * Although the docs say that you shouldn't override this, I decided to do
     * so because it offers me an easy way to change the invalidated area to my
     * likening.
     */
    @Override
    public ViewParent invalidateChildInParent(int[] location, Rect dirty) {

        mInvalidateWorkingArray[0] = dirty.left;
        mInvalidateWorkingArray[1] = dirty.top;
        mInvalidateWorkingArray[2] = dirty.right;
        mInvalidateWorkingArray[3] = dirty.bottom;

        mInvalidateWorkingArray = scaledPointsToScreenPoints(mInvalidateWorkingArray);
        dirty.set(Math.round(mInvalidateWorkingArray[0]), Math.round(mInvalidateWorkingArray[1]),
                Math.round(mInvalidateWorkingArray[2]), Math.round(mInvalidateWorkingArray[3]));

        location[0] *= mScaleFactor;
        location[1] *= mScaleFactor;
        return super.invalidateChildInParent(location, dirty);
    }

    private float[] scaledPointsToScreenPoints(float[] a) {
        mScaleMatrix.mapPoints(a);
        mTranslateMatrix.mapPoints(a);
        return a;
    }

    private float[] screenPointsToScaledPoints(float[] a){
        mTranslateMatrixInverse.mapPoints(a);
        mScaleMatrixInverse.mapPoints(a);
        return a;
    }

    @Override
    public boolean onTouchEvent(MotionEvent ev) {
        mOnTouchEventWorkingArray[0] = ev.getX();
        mOnTouchEventWorkingArray[1] = ev.getY();

        mOnTouchEventWorkingArray = scaledPointsToScreenPoints(mOnTouchEventWorkingArray);

        ev.setLocation(mOnTouchEventWorkingArray[0], mOnTouchEventWorkingArray[1]);
        mScaleDetector.onTouchEvent(ev);

        final int action = ev.getAction();
        switch (action & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN: {
                final float x = ev.getX();
                final float y = ev.getY();

                mLastTouchX = x;
                mLastTouchY = y;

                // Save the ID of this pointer
                mActivePointerId = ev.getPointerId(0);
                break;
            }

            case MotionEvent.ACTION_MOVE: {
                // Find the index of the active pointer and fetch its position
                final int pointerIndex = ev.findPointerIndex(mActivePointerId);
                final float x = ev.getX(pointerIndex);
                final float y = ev.getY(pointerIndex);

                final float dx = x - mLastTouchX;
                final float dy = y - mLastTouchY;

                mPosX += dx;
                mPosY += dy;
                mTranslateMatrix.preTranslate(dx, dy);
                mTranslateMatrix.invert(mTranslateMatrixInverse);

                mLastTouchX = x;
                mLastTouchY = y;

                invalidate();
                break;
            }

            case MotionEvent.ACTION_UP: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_CANCEL: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_POINTER_UP: {
                // Extract the index of the pointer that left the touch sensor
                final int pointerIndex = (action & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
                final int pointerId = ev.getPointerId(pointerIndex);
                if (pointerId == mActivePointerId) {
                    // This was our active pointer going up. Choose a new
                    // active pointer and adjust accordingly.
                    final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                    mLastTouchX = ev.getX(newPointerIndex);
                    mLastTouchY = ev.getY(newPointerIndex);
                    mActivePointerId = ev.getPointerId(newPointerIndex);
                }
                break;
            }
        }
        return true;
    }

    private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {

        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();
            if (detector.isInProgress()) {
                mFocusX = detector.getFocusX();
                mFocusY = detector.getFocusY();
            }
            mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 5.0f));
            mScaleMatrix.setScale(mScaleFactor, mScaleFactor,
                    mFocusX, mFocusY);
            mScaleMatrix.invert(mScaleMatrixInverse);
            invalidate();
            requestLayout();

            return true;
        }
    }
} 
```

这个类应该能够做的是拖动内容并允许捏缩放，双击缩放现在是不可能的，但它应该很容易在`onTouchEvent`方法中实现。

如果您对如何在 ViewGroup 中布局子元素有疑问，我发现此[视频](http://www.parleys.com/#st=5&id=2191&sl=38)非常有帮助，或者如果您对单一方法的工作方式有任何疑问，或者有任何其他问题，请随时在评论中提问。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-10-06T01:59:53.893

重新发布@Artjom 答案并修复了小错误，即大括号、导入和扩展 ViewGroup。

```
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Matrix;
import android.graphics.Rect;
import android.view.*;

public class ZoomableViewGroup extends ViewGroup {

    private static final int INVALID_POINTER_ID = 1;
    private int mActivePointerId = INVALID_POINTER_ID;

    private float mScaleFactor = 1;
    private ScaleGestureDetector mScaleDetector;
    private Matrix mScaleMatrix = new Matrix();
    private Matrix mScaleMatrixInverse = new Matrix();

    private float mPosX;
    private float mPosY;
    private Matrix mTranslateMatrix = new Matrix();
    private Matrix mTranslateMatrixInverse = new Matrix();

    private float mLastTouchX;
    private float mLastTouchY;

    private float mFocusY;

    private float mFocusX;

    private float[] mInvalidateWorkingArray = new float[6];
    private float[] mDispatchTouchEventWorkingArray = new float[2];
    private float[] mOnTouchEventWorkingArray = new float[2];

    public ZoomableViewGroup(Context context) {
        super(context);
        mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
        mTranslateMatrix.setTranslate(0, 0);
        mScaleMatrix.setScale(1, 1);
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                child.layout(l, t, l+child.getMeasuredWidth(), t + child.getMeasuredHeight());
            }
        }
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                measureChild(child, widthMeasureSpec, heightMeasureSpec);
            }
        }
    }

    @Override
    protected void dispatchDraw(Canvas canvas) {
        canvas.save();
        canvas.translate(mPosX, mPosY);
        canvas.scale(mScaleFactor, mScaleFactor, mFocusX, mFocusY);
        super.dispatchDraw(canvas);
        canvas.restore();
    }

    @Override
    public boolean dispatchTouchEvent(MotionEvent ev) {
        mDispatchTouchEventWorkingArray[0] = ev.getX();
        mDispatchTouchEventWorkingArray[1] = ev.getY();
        mDispatchTouchEventWorkingArray = screenPointsToScaledPoints(mDispatchTouchEventWorkingArray);
        ev.setLocation(mDispatchTouchEventWorkingArray[0],
                mDispatchTouchEventWorkingArray[1]);
        return super.dispatchTouchEvent(ev);
    }

    /**
     * Although the docs say that you shouldn't override this, I decided to do
     * so because it offers me an easy way to change the invalidated area to my
     * likening.
     */
    @Override
    public ViewParent invalidateChildInParent(int[] location, Rect dirty) {

        mInvalidateWorkingArray[0] = dirty.left;
        mInvalidateWorkingArray[1] = dirty.top;
        mInvalidateWorkingArray[2] = dirty.right;
        mInvalidateWorkingArray[3] = dirty.bottom;

        mInvalidateWorkingArray = scaledPointsToScreenPoints(mInvalidateWorkingArray);
        dirty.set(Math.round(mInvalidateWorkingArray[0]), Math.round(mInvalidateWorkingArray[1]),
                Math.round(mInvalidateWorkingArray[2]), Math.round(mInvalidateWorkingArray[3]));

        location[0] *= mScaleFactor;
        location[1] *= mScaleFactor;
        return super.invalidateChildInParent(location, dirty);
    }

    private float[] scaledPointsToScreenPoints(float[] a) {
        mScaleMatrix.mapPoints(a);
        mTranslateMatrix.mapPoints(a);
        return a;
    }

    private float[] screenPointsToScaledPoints(float[] a){
        mTranslateMatrixInverse.mapPoints(a);
        mScaleMatrixInverse.mapPoints(a);
        return a;
    }

    @Override
    public boolean onTouchEvent(MotionEvent ev) {
        mOnTouchEventWorkingArray[0] = ev.getX();
        mOnTouchEventWorkingArray[1] = ev.getY();

        mOnTouchEventWorkingArray = scaledPointsToScreenPoints(mOnTouchEventWorkingArray);

        ev.setLocation(mOnTouchEventWorkingArray[0], mOnTouchEventWorkingArray[1]);
        mScaleDetector.onTouchEvent(ev);

        final int action = ev.getAction();
        switch (action & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN: {
                final float x = ev.getX();
                final float y = ev.getY();

                mLastTouchX = x;
                mLastTouchY = y;

                // Save the ID of this pointer
                mActivePointerId = ev.getPointerId(0);
                break;
            }

            case MotionEvent.ACTION_MOVE: {
                // Find the index of the active pointer and fetch its position
                final int pointerIndex = ev.findPointerIndex(mActivePointerId);
                final float x = ev.getX(pointerIndex);
                final float y = ev.getY(pointerIndex);

                final float dx = x - mLastTouchX;
                final float dy = y - mLastTouchY;

                mPosX += dx;
                mPosY += dy;
                mTranslateMatrix.preTranslate(dx, dy);
                mTranslateMatrix.invert(mTranslateMatrixInverse);

                mLastTouchX = x;
                mLastTouchY = y;

                invalidate();
                break;
            }

            case MotionEvent.ACTION_UP: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_CANCEL: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_POINTER_UP: {
                // Extract the index of the pointer that left the touch sensor
                final int pointerIndex = (action & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
                final int pointerId = ev.getPointerId(pointerIndex);
                if (pointerId == mActivePointerId) {
                    // This was our active pointer going up. Choose a new
                    // active pointer and adjust accordingly.
                    final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                    mLastTouchX = ev.getX(newPointerIndex);
                    mLastTouchY = ev.getY(newPointerIndex);
                    mActivePointerId = ev.getPointerId(newPointerIndex);
                }
                break;
            }
        }
        return true;
    }

    private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {

        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();
            if (detector.isInProgress()) {
                mFocusX = detector.getFocusX();
                mFocusY = detector.getFocusY();
            }
            mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 5.0f));
            mScaleMatrix.setScale(mScaleFactor, mScaleFactor,
                    mFocusX, mFocusY);
            mScaleMatrix.invert(mScaleMatrixInverse);
            invalidate();
            requestLayout();

            return true;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-10-27T15:09:32.240

根据给定的答案，我使用此代码使平移和缩放功能正常工作。最初的枢轴点有问题。

```
public class ZoomableViewGroup extends ViewGroup {

    // these matrices will be used to move and zoom image
    private Matrix matrix = new Matrix();
    private Matrix matrixInverse = new Matrix();
    private Matrix savedMatrix = new Matrix();
    // we can be in one of these 3 states
    private static final int NONE = 0;
    private static final int DRAG = 1;
    private static final int ZOOM = 2;
    private int mode = NONE;
    // remember some things for zooming
    private PointF start = new PointF();
    private PointF mid = new PointF();
    private float oldDist = 1f;
    private float[] lastEvent = null;

    private boolean initZoomApplied=false;

    private float[] mDispatchTouchEventWorkingArray = new float[2];
    private float[] mOnTouchEventWorkingArray = new float[2];

    @Override
    public boolean dispatchTouchEvent(MotionEvent ev) {
        mDispatchTouchEventWorkingArray[0] = ev.getX();
        mDispatchTouchEventWorkingArray[1] = ev.getY();
        mDispatchTouchEventWorkingArray = screenPointsToScaledPoints(mDispatchTouchEventWorkingArray);
        ev.setLocation(mDispatchTouchEventWorkingArray[0],
                mDispatchTouchEventWorkingArray[1]);
        return super.dispatchTouchEvent(ev);
    }

    private float[] scaledPointsToScreenPoints(float[] a) {
        matrix.mapPoints(a);
        return a;
    }

    private float[] screenPointsToScaledPoints(float[] a){
        matrixInverse.mapPoints(a);
        return a;
    }

    public ZoomableViewGroup(Context context) {
        super(context);
        init(context);
    }

    public ZoomableViewGroup(Context context, AttributeSet attrs) {
        super(context, attrs);      
        init(context);
    }

    public ZoomableViewGroup(Context context, AttributeSet attrs,
            int defStyleAttr) {
        super(context, attrs, defStyleAttr);
        init(context);
    }

    /**
     * Determine the space between the first two fingers
     */
    private float spacing(MotionEvent event) {
        float x = event.getX(0) - event.getX(1);
        float y = event.getY(0) - event.getY(1);
        return (float)Math.sqrt(x * x + y * y);
    }

    /**
     * Calculate the mid point of the first two fingers
     */
    private void midPoint(PointF point, MotionEvent event) {
        float x = event.getX(0) + event.getX(1);
        float y = event.getY(0) + event.getY(1);
        point.set(x / 2, y / 2);
    }

    private void init(Context context){

    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                child.layout(l, t, l+child.getMeasuredWidth(), t + child.getMeasuredHeight());
            }
        }
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        int widthSize = MeasureSpec.getSize(widthMeasureSpec);
        int heightSize = MeasureSpec.getSize(heightMeasureSpec);

        float[] values = new float[9];
        matrix.getValues(values);
        float container_width = values[Matrix.MSCALE_X]*widthSize;
        float container_height = values[Matrix.MSCALE_Y]*heightSize;

        //Log.d("zoomToFit", "m width: "+container_width+" m height: "+container_height);
        //Log.d("zoomToFit", "m x: "+pan_x+" m y: "+pan_y);

        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                measureChild(child, widthMeasureSpec, heightMeasureSpec);

                if(i==0 && !initZoomApplied && child.getWidth()>0){
                    int c_w = child.getWidth();
                    int c_h = child.getHeight();

                    //zoomToFit(c_w, c_h, container_width, container_height);
                }
            }
        }        

    }

    private void zoomToFit(int c_w, int c_h, float container_width, float container_height){
        float proportion_firstChild = (float)c_w/(float)c_h;
        float proportion_container = container_width/container_height;

        //Log.d("zoomToFit", "firstChildW: "+c_w+" firstChildH: "+c_h);
        //Log.d("zoomToFit", "proportion-container: "+proportion_container);
        //Log.d("zoomToFit", "proportion_firstChild: "+proportion_firstChild);

        if(proportion_container<proportion_firstChild){
            float initZoom = container_height/c_h;
            //Log.d("zoomToFit", "adjust height with initZoom: "+initZoom);
            matrix.postScale(initZoom, initZoom);
            matrix.postTranslate(-1*(c_w*initZoom-container_width)/2, 0);
            matrix.invert(matrixInverse);
        }else {
            float initZoom = container_width/c_w;
            //Log.d("zoomToFit", "adjust width with initZoom: "+initZoom);
            matrix.postScale(initZoom, initZoom);
            matrix.postTranslate(0, -1*(c_h*initZoom-container_height)/2);
            matrix.invert(matrixInverse);
        }
        initZoomApplied=true;
        invalidate();
    }

    @Override
    protected void dispatchDraw(Canvas canvas) {
        canvas.save();
        canvas.setMatrix(matrix);
        super.dispatchDraw(canvas);
        canvas.restore();
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        // handle touch events here
        mOnTouchEventWorkingArray[0] = event.getX();
        mOnTouchEventWorkingArray[1] = event.getY();

        mOnTouchEventWorkingArray = scaledPointsToScreenPoints(mOnTouchEventWorkingArray);

        event.setLocation(mOnTouchEventWorkingArray[0], mOnTouchEventWorkingArray[1]);

        switch (event.getAction() & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN:
                savedMatrix.set(matrix);
                start.set(event.getX(), event.getY());
                mode = DRAG;
                lastEvent = null;
                break;
            case MotionEvent.ACTION_POINTER_DOWN:
                oldDist = spacing(event);
                if (oldDist > 10f) {
                    savedMatrix.set(matrix);
                    midPoint(mid, event);
                    mode = ZOOM;
                }
                lastEvent = new float[4];
                lastEvent[0] = event.getX(0);
                lastEvent[1] = event.getX(1);
                lastEvent[2] = event.getY(0);
                lastEvent[3] = event.getY(1);
                //d = rotation(event);
                break;
            case MotionEvent.ACTION_UP:
            case MotionEvent.ACTION_POINTER_UP:
                mode = NONE;
                lastEvent = null;
                break;
            case MotionEvent.ACTION_MOVE:
                if (mode == DRAG) {
                    matrix.set(savedMatrix);
                    float dx = event.getX() - start.x;
                    float dy = event.getY() - start.y;
                    matrix.postTranslate(dx, dy);
                    matrix.invert(matrixInverse);
                } else if (mode == ZOOM) {
                    float newDist = spacing(event);
                    if (newDist > 10f) {
                        matrix.set(savedMatrix);
                        float scale = (newDist / oldDist);
                        matrix.postScale(scale, scale, mid.x, mid.y);
                        matrix.invert(matrixInverse);
                    }
                }
                break;
        }

        invalidate();
        return true;
    }

} 
```

onTouch 函数的功劳请访问：http: [//judepereira.com/blog/multi-touch-in-android-translate-scale-and-rotate/](http://judepereira.com/blog/multi-touch-in-android-translate-scale-and-rotate/) 感谢 Artjom 对触摸事件进行分配的方法。

我添加了一个 zoomToFit 方法，此时对其进行了注释，因为大多数人不需要它。它使孩子适合容器的大小，并将第一个孩子作为比例因子的参考。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-07-05T13:49:40.643

[Thomas](https://stackoverflow.com/questions/12479859/view-with-horizontal-and-vertical-pan-drag-and-pinch-zoom/12497670#answer-33371584)的回答几乎是最好的（我的手机上有一个位置错误）：缩放立即开始（[Alex](https://stackoverflow.com/questions/12479859/view-with-horizontal-and-vertical-pan-drag-and-pinch-zoom/12497670#answer-33371584#answer-19204645)的代码不是这种情况），并且缩放是在正确的枢轴点进行的。

但是，与[Alex](https://stackoverflow.com/questions/12479859/view-with-horizontal-and-vertical-pan-drag-and-pinch-zoom/12497670#answer-33371584#answer-19204645)的代码相反，无法使用“双击-拖动”手势进行缩放（不是众所周知的手势，但仅用一根手指进行缩放非常有用，例如在 Google Chrome 或 Google Maps 中）应用）。因此，这是对[Thomas](https://stackoverflow.com/questions/12479859/view-with-horizontal-and-vertical-pan-drag-and-pinch-zoom/12497670#answer-33371584)代码的修改以使其成为可能（并修复了子视图位置错误）：

```
public class ZoomableView extends ViewGroup {

    // States.
    private static final byte NONE = 0;
    private static final byte DRAG = 1;
    private static final byte ZOOM = 2;

    private byte mode = NONE;

    // Matrices used to move and zoom image.
    private Matrix matrix = new Matrix();
    private Matrix matrixInverse = new Matrix();
    private Matrix savedMatrix = new Matrix();

    // Parameters for zooming.
    private PointF start = new PointF();
    private PointF mid = new PointF();
    private float oldDist = 1f;
    private float[] lastEvent = null;
    private long lastDownTime = 0l;

    private float[] mDispatchTouchEventWorkingArray = new float[2];
    private float[] mOnTouchEventWorkingArray = new float[2];

    @Override
    public boolean dispatchTouchEvent(MotionEvent ev) {
        mDispatchTouchEventWorkingArray[0] = ev.getX();
        mDispatchTouchEventWorkingArray[1] = ev.getY();
        mDispatchTouchEventWorkingArray = screenPointsToScaledPoints(mDispatchTouchEventWorkingArray);
        ev.setLocation(mDispatchTouchEventWorkingArray[0], mDispatchTouchEventWorkingArray[1]);
        return super.dispatchTouchEvent(ev);
    }

    public ZoomableView(Context context) {
        super(context);
        init(context);
    }

    public ZoomableView(Context context, AttributeSet attrs) {
        super(context, attrs);
        init(context);
    }

    public ZoomableView(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
        init(context);
    }

    private void init(Context context) {

    }

    /**
     * Determine the space between the first two fingers
     */
    private float spacing(MotionEvent event) {
        float x = event.getX(0) - event.getX(1);
        float y = event.getY(0) - event.getY(1);
        return (float) Math.sqrt(x * x + y * y);
    }

    /**
     * Calculate the mid point of the first two fingers
     */
    private void midPoint(PointF point, MotionEvent event) {
        float x = event.getX(0) + event.getX(1);
        float y = event.getY(0) + event.getY(1);
        point.set(x / 2, y / 2);
    }

    private float[] scaledPointsToScreenPoints(float[] a) {
        matrix.mapPoints(a);
        return a;
    }

    private float[] screenPointsToScaledPoints(float[] a) {
        matrixInverse.mapPoints(a);
        return a;
    }

    @Override
    protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                child.layout(left, top, left + child.getMeasuredWidth(), top + child.getMeasuredHeight());
            }
        }
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                measureChild(child, widthMeasureSpec, heightMeasureSpec);
            }
        }
    }

    @Override
    protected void dispatchDraw(Canvas canvas) {
        float[] values = new float[9];
        matrix.getValues(values);
        canvas.save();
        canvas.translate(values[Matrix.MTRANS_X], values[Matrix.MTRANS_Y]);
        canvas.scale(values[Matrix.MSCALE_X], values[Matrix.MSCALE_Y]);
        super.dispatchDraw(canvas);
        canvas.restore();
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        // handle touch events here
        mOnTouchEventWorkingArray[0] = event.getX();
        mOnTouchEventWorkingArray[1] = event.getY();

        mOnTouchEventWorkingArray = scaledPointsToScreenPoints(mOnTouchEventWorkingArray);

        event.setLocation(mOnTouchEventWorkingArray[0], mOnTouchEventWorkingArray[1]);

        switch (event.getAction() & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN:
                savedMatrix.set(matrix);
                mode = DRAG;
                lastEvent = null;
                long downTime = event.getDownTime();
                if (downTime - lastDownTime < 300l) {
                    float density = getResources().getDisplayMetrics().density;
                    if (Math.max(Math.abs(start.x - event.getX()), Math.abs(start.y - event.getY())) < 40.f * density) {
                        savedMatrix.set(matrix);
                        mid.set(event.getX(), event.getY());
                        mode = ZOOM;
                        lastEvent = new float[4];
                        lastEvent[0] = lastEvent[1] = event.getX();
                        lastEvent[2] = lastEvent[3] = event.getY();
                    }
                    lastDownTime = 0l;
                } else {
                    lastDownTime = downTime;
                }
                start.set(event.getX(), event.getY());
                break;
            case MotionEvent.ACTION_POINTER_DOWN:
                oldDist = spacing(event);
                if (oldDist > 10f) {
                    savedMatrix.set(matrix);
                    midPoint(mid, event);
                    mode = ZOOM;
                }
                lastEvent = new float[4];
                lastEvent[0] = event.getX(0);
                lastEvent[1] = event.getX(1);
                lastEvent[2] = event.getY(0);
                lastEvent[3] = event.getY(1);
                break;
            case MotionEvent.ACTION_UP:
            case MotionEvent.ACTION_POINTER_UP:
                mode = NONE;
                lastEvent = null;
                break;
            case MotionEvent.ACTION_MOVE:
                final float density = getResources().getDisplayMetrics().density;
                if (mode == DRAG) {
                    matrix.set(savedMatrix);
                    float dx = event.getX() - start.x;
                    float dy = event.getY() - start.y;
                    matrix.postTranslate(dx, dy);
                    matrix.invert(matrixInverse);
                    if (Math.max(Math.abs(start.x - event.getX()), Math.abs(start.y - event.getY())) > 20.f * density) {
                        lastDownTime = 0l;
                    }
                } else if (mode == ZOOM) {
                    if (event.getPointerCount() > 1) {
                        float newDist = spacing(event);
                        if (newDist > 10f * density) {
                            matrix.set(savedMatrix);
                            float scale = (newDist / oldDist);
                            matrix.postScale(scale, scale, mid.x, mid.y);
                            matrix.invert(matrixInverse);
                        }
                    } else {
                        matrix.set(savedMatrix);
                        float scale = event.getY() / start.y;
                        matrix.postScale(scale, scale, mid.x, mid.y);
                        matrix.invert(matrixInverse);
                    }
                }
                break;
        }

        invalidate();
        return true;
    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-18T15:17:10.870

这个自定义视图是 Android 标准 imageView 的子类，并添加了（多点触控）平移和缩放（以及双击缩放）：

[https://github.com/sephiroth74/ImageViewZoom](https://github.com/sephiroth74/ImageViewZoom)

[http://blog.sephiroth.it/2011/04/04/imageview-zoom-and-scroll/](http://blog.sephiroth.it/2011/04/04/imageview-zoom-and-scroll/)

它类似于您已经知道的 MikeOrtiz 的 TouchImageView，但添加了更多功能。

您可以在视图“堆栈”（Android FrameLayout 或类似的东西）中使用它以及您需要的其他 textView。（我的意思是“一堆”视图，比如一堆盘子或一堆卡片。换句话说，一堆视图在 Z 轴上一个接一个地堆叠。）

将所有视图一起移动需要您控制 Android 手势（多点触控）机制并编写所需的代码。对于您的（相当复杂的）需求，没有任何现成的解决方案。看看这篇文章：

[http://android-developers.blogspot.it/2010/06/making-sense-of-multitouch.html](http://android-developers.blogspot.it/2010/06/making-sense-of-multitouch.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-06-14T00:30:40.447

我正在使用此处发布的代码的一些修改版本。此 ZoomLayout 使用 Android 手势识别器进行滚动和缩放。它还在缩放或平移时保留枢轴和边界。

[https://github.com/maxtower/ZoomLayout/blob/master/app/src/main/java/com/maxtower/testzoomlayout/ZoomLayout.java](https://github.com/maxtower/ZoomLayout/blob/master/app/src/main/java/com/maxtower/testzoomlayout/ZoomLayout.java)

要保留平移边界：

```
if (contentSize != null)
    {
        float[] values = new float[9];
        matrix.getValues(values);
        float totX = values[Matrix.MTRANS_X] + distanceX;
        float totY = values[Matrix.MTRANS_Y] + distanceY;
        float sx = values[Matrix.MSCALE_X];

        Rect viewableRect = new Rect();
        ZoomLayout.this.getDrawingRect(viewableRect);
        float offscreenWidth = contentSize.width() - (viewableRect.right - viewableRect.left);
        float offscreenHeight = contentSize.height() - (viewableRect.bottom - viewableRect.top);
        float maxDx = (contentSize.width() - (contentSize.width() / sx)) * sx;
        float maxDy = (contentSize.height() - (contentSize.height() / sx)) * sx;
        if (totX > 0 && distanceX > 0)
        {
            distanceX = 0;
        }
        if (totY > 0 && distanceY > 0)
        {
            distanceY = 0;
        }

        if(totX*-1 > offscreenWidth+maxDx && distanceX < 0)
        {
            distanceX = 0;
        }
        if(totY*-1 > offscreenHeight+maxDy && distanceY < 0)
        {
            distanceY = 0;
        }

    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-11T22:59:18.913

我提出了这个解决方案（你的代码和我的一些想法的混合）：

*   双击缩放和取消缩放
*   双击后缩放和取消缩放（用一根手指）
*   平底锅好
*   捏缩放确定，它会缩放您指向的位置
*   子视图是可触摸的
*   带边框的布局！（不能通过取消缩放或平移来脱离布局）

它不是动画的，而是完全工作的。请享用

用法 ：

```
<com.yourapppath.ZoomableViewGroup
    android:id="@+id/zoomControl"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <FrameLayout
        android:id="@+id/frameLayoutZoom"
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <ImageView
            android:id="@+id/planImageView"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:src="@drawable/yourdrawable"
            android:scaleType="center" />

    </FrameLayout>
</com.yourapppath.ZoomableViewGroup> 
```

这是 zoomableViewGroup Java 文件，只需复制并使用：

```
public class ZoomableViewGroup extends ViewGroup {

    private boolean doubleTap = false;

    private float MIN_ZOOM = 1f;
    private float MAX_ZOOM = 2.5f;
    private float[] topLeftCorner = {0, 0};
    private float scaleFactor;

    // States.
    private static final byte NONE = 0;
    private static final byte DRAG = 1;
    private static final byte ZOOM = 2;

    private byte mode = NONE;

    // Matrices used to move and zoom image.
    private Matrix matrix = new Matrix();
    private Matrix matrixInverse = new Matrix();
    private Matrix savedMatrix = new Matrix();

    // Parameters for zooming.
    private PointF start = new PointF();
    private PointF mid = new PointF();
    private float oldDist = 1f;
    private float[] lastEvent = null;
    private long lastDownTime = 0l;
    private long downTime = 0l;

    private float[] mDispatchTouchEventWorkingArray = new float[2];
    private float[] mOnTouchEventWorkingArray = new float[2];

    @Override
    public boolean dispatchTouchEvent(MotionEvent ev) {
        mDispatchTouchEventWorkingArray[0] = ev.getX();
        mDispatchTouchEventWorkingArray[1] = ev.getY();
        mDispatchTouchEventWorkingArray = screenPointsToScaledPoints(mDispatchTouchEventWorkingArray);
        ev.setLocation(mDispatchTouchEventWorkingArray[0], mDispatchTouchEventWorkingArray[1]);
        return super.dispatchTouchEvent(ev);
    }

    public ZoomableViewGroup(Context context) {
        super(context);
    }

    public ZoomableViewGroup(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public ZoomableViewGroup(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    /**
     * Determine the space between the first two fingers
     */
    private float spacing(MotionEvent event) {
        float x = event.getX(0) - event.getX(1);
        float y = event.getY(0) - event.getY(1);
        return (float) Math.sqrt(x * x + y * y);
    }

    /**
     * Calculate the mid point of the first two fingers
     */
    private void midPoint(PointF point, MotionEvent event) {
        float x = event.getX(0) + event.getX(1);
        float y = event.getY(0) + event.getY(1);
        point.set(x / 2, y / 2);
    }

    private float[] scaledPointsToScreenPoints(float[] a) {
        matrix.mapPoints(a);
        return a;
    }

    private float[] screenPointsToScaledPoints(float[] a) {
        matrixInverse.mapPoints(a);
        return a;
    }

    @Override
    public void onLayout(boolean changed, int left, int top, int right, int bottom) {
        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                child.layout(left, top, left + child.getMeasuredWidth(), top + child.getMeasuredHeight());
            }
        }
    }

    @Override
    public void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
       super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        int childCount = getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                measureChild(child, widthMeasureSpec, heightMeasureSpec);
            }
        }
    }

    @Override
    public void dispatchDraw(Canvas canvas) {
        float[] values = new float[9];
        matrix.getValues(values);
        canvas.save();
        canvas.translate(values[Matrix.MTRANS_X], values[Matrix.MTRANS_Y]);
        canvas.scale(values[Matrix.MSCALE_X], values[Matrix.MSCALE_Y]);
        topLeftCorner[0] = values[Matrix.MTRANS_X];
        topLeftCorner[1] = values[Matrix.MTRANS_Y];
        scaleFactor = values[Matrix.MSCALE_X];
        super.dispatchDraw(canvas);
        canvas.restore();
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        // handle touch events here
        mOnTouchEventWorkingArray[0] = event.getX();
        mOnTouchEventWorkingArray[1] = event.getY();

        mOnTouchEventWorkingArray = scaledPointsToScreenPoints(mOnTouchEventWorkingArray);

        event.setLocation(mOnTouchEventWorkingArray[0], mOnTouchEventWorkingArray[1]);

        switch (event.getAction() & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN:
                savedMatrix.set(matrix);
                mode = DRAG;
                lastEvent = null;
                downTime = SystemClock.elapsedRealtime();
                if (downTime - lastDownTime < 250l) {
                    doubleTap = true;
                    float density = getResources().getDisplayMetrics().density;
                    if (Math.max(Math.abs(start.x - event.getX()), Math.abs(start.y - event.getY())) < 40.f * density) {
                        savedMatrix.set(matrix);                                                         //repetition of savedMatrix.setmatrix
                        mid.set(event.getX(), event.getY());
                        mode = ZOOM;
                        lastEvent = new float[4];
                        lastEvent[0] = lastEvent[1] = event.getX();
                        lastEvent[2] = lastEvent[3] = event.getY();
                    }    
                    lastDownTime = 0l;
                } else {
                    doubleTap = false;
                    lastDownTime = downTime;
                }
                start.set(event.getX(), event.getY());

                break;
            case MotionEvent.ACTION_POINTER_DOWN:
                oldDist = spacing(event);
                if (oldDist > 10f) {
                    savedMatrix.set(matrix);
                    midPoint(mid, event);
                    mode = ZOOM;
                }
                lastEvent = new float[4];
                lastEvent[0] = event.getX(0);
                lastEvent[1] = event.getX(1);
                lastEvent[2] = event.getY(0);
                lastEvent[3] = event.getY(1);
                break;
            case MotionEvent.ACTION_UP:

                if (doubleTap && scaleFactor < 1.8f){
                    matrix.postScale(2.5f/scaleFactor, 2.5f/scaleFactor, mid.x, mid.y);
                } else if(doubleTap && scaleFactor >= 1.8f){
                    matrix.postScale(1.0f/scaleFactor, 1.0f/scaleFactor, mid.x, mid.y);
                }

                Handler handler = new Handler();
                handler.postDelayed(new Runnable() {
                    @Override
                    public void run() {
                        if(topLeftCorner[0] >= 0){
                            matrix.postTranslate(-topLeftCorner[0],0);
                        } else if (topLeftCorner[0] < -getWidth()*(scaleFactor-1)){
                            matrix.postTranslate((-topLeftCorner[0]) - getWidth()*(scaleFactor-1) ,0);
                        }
                        if(topLeftCorner[1] >= 0){
                            matrix.postTranslate(0,-topLeftCorner[1]);
                        } else if (topLeftCorner[1] < -getHeight()*(scaleFactor-1)){
                            matrix.postTranslate(0,(-topLeftCorner[1]) - getHeight()*(scaleFactor-1));
                        }
                        matrix.invert(matrixInverse);
                        invalidate();
                    }
                }, 1);

                break;

            case MotionEvent.ACTION_POINTER_UP:
                mode = NONE;
                lastEvent = null;
                break;
            case MotionEvent.ACTION_MOVE:

                final float density = getResources().getDisplayMetrics().density;
                if (mode == DRAG) {
                    matrix.set(savedMatrix);
                    float dx = event.getX() - start.x;
                    float dy = event.getY() - start.y;
                    matrix.postTranslate(dx, dy);
                    matrix.invert(matrixInverse);
                    if (Math.max(Math.abs(start.x - event.getX()), Math.abs(start.y - event.getY())) > 20.f * density) {
                        lastDownTime = 0l;
                    }
                } else if (mode == ZOOM) {
                    if (event.getPointerCount() > 1) {
                        float newDist = spacing(event);
                        if (newDist > 10f * density) {
                            matrix.set(savedMatrix);
                            float scale = (newDist / oldDist);
                            float[] values = new float[9];
                            matrix.getValues(values);
                            if (scale * values[Matrix.MSCALE_X] >= MAX_ZOOM) {
                                scale = MAX_ZOOM / values[Matrix.MSCALE_X];
                            }
                            if (scale * values[Matrix.MSCALE_X] <= MIN_ZOOM) {
                                scale = MIN_ZOOM / values[Matrix.MSCALE_X];
                            }
                            matrix.postScale(scale, scale, mid.x, mid.y);
                            matrix.invert(matrixInverse);
                        }
                    } else {
                        if ( SystemClock.elapsedRealtime() - downTime > 250l) {
                            doubleTap = false;
                        }
                        matrix.set(savedMatrix);
                        float scale = event.getY() / start.y;
                        float[] values = new float[9];
                        matrix.getValues(values);
                        if (scale * values[Matrix.MSCALE_X] >= MAX_ZOOM) {
                            scale = MAX_ZOOM / values[Matrix.MSCALE_X];
                        }
                        if (scale * values[Matrix.MSCALE_X] <= MIN_ZOOM) {
                            scale = MIN_ZOOM / values[Matrix.MSCALE_X];
                        }
                        matrix.postScale(scale, scale, mid.x, mid.y);
                        matrix.invert(matrixInverse);
                    }
                }
                break;
        }

        invalidate();
        return true;
    }

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-27T16:42:35.083

为了在 Alex 的代码中获得更好的 Zooming 性能，请添加以下更改

```
private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {

    @Override
    public boolean onScale(ScaleGestureDetector detector) {
        mScaleFactor *= detector.getScaleFactor();
        if (detector.isInProgress()) {
            mFocusX = detector.getFocusX();
            mFocusY = detector.getFocusY();
        }

        mFocusX = (mFocusX + mLastTouchX)/2;  // get center of touch
        mFocusY = (mFocusY + mLastTouchY)/2;  // get center of touch

        mScaleFactor = Math.max(1f, Math.min(mScaleFactor, 2.0f));
        mScaleMatrix.setScale(mScaleFactor, mScaleFactor,mFocusX, mFocusY);
        mScaleMatrix.invert(mScaleMatrixInverse);
        invalidate();
        requestLayout();

        return true;
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-18T19:54:51.467

对于那些对缩放/平移 LinearLayout 感兴趣的人，我修改了 Alex 发布的版本以垂直布局并将平移限制为可见视图。我将它用于 PDFRenderer 中的位图。我已经对此进行了测试，但是如果您发现任何错误，请发布，因为我也想知道它们！

注意：我选择不实现双击，因为 QuickScale 有效。

```
public class ZoomableLinearLayout extends ViewGroup {

   private static final int INVALID_POINTER_ID = 1;
   private int mActivePointerId = INVALID_POINTER_ID;

   private float mScaleFactor = 1;
   private ScaleGestureDetector mScaleDetector;
   private Matrix mScaleMatrix = new Matrix();
   private Matrix mScaleMatrixInverse = new Matrix();

   private float mPosX;
   private float mPosY;
   private Matrix mTranslateMatrix = new Matrix();
   private Matrix mTranslateMatrixInverse = new Matrix();

   private float mLastTouchX;
   private float mLastTouchY;

   private float mFocusY;
   private float mFocusX;

   private int mCanvasWidth;
   private int mCanvasHeight;

   private float[] mInvalidateWorkingArray = new float[6];
   private float[] mDispatchTouchEventWorkingArray = new float[2];
   private float[] mOnTouchEventWorkingArray = new float[2];

   private boolean mIsScaling;

   public ZoomableLinearLayout(Context context) {
      super(context);
      mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
      mTranslateMatrix.setTranslate(0, 0);
      mScaleMatrix.setScale(1, 1);
   }

   public ZoomableLinearLayout(Context context, AttributeSet attributeSet) {
      super(context, attributeSet);
      mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
      mTranslateMatrix.setTranslate(0, 0);
      mScaleMatrix.setScale(1, 1);
   }

   @Override
   protected void onLayout(boolean changed, int l, int t, int r, int b) {
      int childCount = getChildCount();
      for (int i = 0; i < childCount; i++) {
         View child = getChildAt(i);
         if (child.getVisibility() != GONE) {
            child.layout(l, t, l+child.getMeasuredWidth(), t += child.getMeasuredHeight());
         }
      }
   }

   @Override
   protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
      super.onMeasure(widthMeasureSpec, heightMeasureSpec);

      int height = 0;
      int width = 0;
      int childCount = getChildCount();
      for (int i = 0; i < childCount; i++) {
         View child = getChildAt(i);
         if (child.getVisibility() != GONE) {
            measureChild(child, widthMeasureSpec, heightMeasureSpec);
            height += child.getMeasuredHeight();
            width = Math.max(width, child.getMeasuredWidth());
         }
      }
      mCanvasWidth = width;
      mCanvasHeight = height;
   }

   @Override
   protected void dispatchDraw(Canvas canvas) {
      canvas.save();
      canvas.translate(mPosX, mPosY);
      canvas.scale(mScaleFactor, mScaleFactor, mFocusX, mFocusY);
      super.dispatchDraw(canvas);
      canvas.restore();
   }

   @Override
   public boolean dispatchTouchEvent(MotionEvent ev) {
      mDispatchTouchEventWorkingArray[0] = ev.getX();
      mDispatchTouchEventWorkingArray[1] = ev.getY();
      mDispatchTouchEventWorkingArray = screenPointsToScaledPoints(mDispatchTouchEventWorkingArray);
      ev.setLocation(mDispatchTouchEventWorkingArray[0],
            mDispatchTouchEventWorkingArray[1]);
      return super.dispatchTouchEvent(ev);
   }

   /**
    * Although the docs say that you shouldn't override this, I decided to do
    * so because it offers me an easy way to change the invalidated area to my
    * likening.
    */
   @Override
   public ViewParent invalidateChildInParent(int[] location, Rect dirty) {

      mInvalidateWorkingArray[0] = dirty.left;
      mInvalidateWorkingArray[1] = dirty.top;
      mInvalidateWorkingArray[2] = dirty.right;
      mInvalidateWorkingArray[3] = dirty.bottom;

      mInvalidateWorkingArray = scaledPointsToScreenPoints(mInvalidateWorkingArray);
      dirty.set(Math.round(mInvalidateWorkingArray[0]), Math.round(mInvalidateWorkingArray[1]),
            Math.round(mInvalidateWorkingArray[2]), Math.round(mInvalidateWorkingArray[3]));

      location[0] *= mScaleFactor;
      location[1] *= mScaleFactor;
      return super.invalidateChildInParent(location, dirty);
   }

   private float[] scaledPointsToScreenPoints(float[] a) {
      mScaleMatrix.mapPoints(a);
      mTranslateMatrix.mapPoints(a);
      return a;
   }

   private float[] screenPointsToScaledPoints(float[] a){
      mTranslateMatrixInverse.mapPoints(a);
      mScaleMatrixInverse.mapPoints(a);
      return a;
   }

   @Override
   public boolean onTouchEvent(MotionEvent ev) {
      mOnTouchEventWorkingArray[0] = ev.getX();
      mOnTouchEventWorkingArray[1] = ev.getY();

      mOnTouchEventWorkingArray = scaledPointsToScreenPoints(mOnTouchEventWorkingArray);

      ev.setLocation(mOnTouchEventWorkingArray[0], mOnTouchEventWorkingArray[1]);
      mScaleDetector.onTouchEvent(ev);

      final int action = ev.getAction();
      switch (action & MotionEvent.ACTION_MASK) {
         case MotionEvent.ACTION_DOWN: {
            final float x = ev.getX();
            final float y = ev.getY();

            mLastTouchX = x;
            mLastTouchY = y;

            // Save the ID of this pointer
            mActivePointerId = ev.getPointerId(0);
            break;
         }

         case MotionEvent.ACTION_MOVE: {
            // Find the index of the active pointer and fetch its position
            final int pointerIndex = ev.findPointerIndex(mActivePointerId);
            final float x = ev.getX(pointerIndex);
            final float y = ev.getY(pointerIndex);

            if (mIsScaling && ev.getPointerCount() == 1) {
               // Don't move during a QuickScale.
               mLastTouchX = x;
               mLastTouchY = y;

               break;
            }

            float dx = x - mLastTouchX;
            float dy = y - mLastTouchY;

            float[] topLeft = {0f, 0f};
            float[] bottomRight = {getWidth(), getHeight()};
            /*
             * Corners of the view in screen coordinates, so dx/dy should not be allowed to
             * push these beyond the canvas bounds.
             */
            float[] scaledTopLeft = screenPointsToScaledPoints(topLeft);
            float[] scaledBottomRight = screenPointsToScaledPoints(bottomRight);

            dx = Math.min(Math.max(dx, scaledBottomRight[0] - mCanvasWidth), scaledTopLeft[0]);
            dy = Math.min(Math.max(dy, scaledBottomRight[1] - mCanvasHeight), scaledTopLeft[1]);

            mPosX += dx;
            mPosY += dy;

            mTranslateMatrix.preTranslate(dx, dy);
            mTranslateMatrix.invert(mTranslateMatrixInverse);

            mLastTouchX = x;
            mLastTouchY = y;

            invalidate();
            break;
         }

         case MotionEvent.ACTION_UP: {
            mActivePointerId = INVALID_POINTER_ID;
            break;
         }

         case MotionEvent.ACTION_CANCEL: {
            mActivePointerId = INVALID_POINTER_ID;
            break;
         }

         case MotionEvent.ACTION_POINTER_UP: {
            // Extract the index of the pointer that left the touch sensor
            final int pointerIndex = (action & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
            final int pointerId = ev.getPointerId(pointerIndex);
            if (pointerId == mActivePointerId) {
               // This was our active pointer going up. Choose a new
               // active pointer and adjust accordingly.
               final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
               mLastTouchX = ev.getX(newPointerIndex);
               mLastTouchY = ev.getY(newPointerIndex);
               mActivePointerId = ev.getPointerId(newPointerIndex);
            }
            break;
         }
      }
      return true;
   }

   private float getMaxScale() {
      return 2f;
   }

   private float getMinScale() {
      return 1f;
   }

   private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {
      @Override
      public boolean onScaleBegin(ScaleGestureDetector detector) {
         mIsScaling = true;

         mFocusX = detector.getFocusX();
         mFocusY = detector.getFocusY();

         float[] foci = {mFocusX, mFocusY};
         float[] scaledFoci = screenPointsToScaledPoints(foci);

         mFocusX = scaledFoci[0];
         mFocusY = scaledFoci[1];

         return true;
      }

      @Override
      public void onScaleEnd(ScaleGestureDetector detector) {
         mIsScaling = false;
      }

      @Override
      public boolean onScale(ScaleGestureDetector detector) {
         mScaleFactor *= detector.getScaleFactor();
         mScaleFactor = Math.max(getMinScale(), Math.min(mScaleFactor, getMaxScale()));
         mScaleMatrix.setScale(mScaleFactor, mScaleFactor, mFocusX, mFocusY);
         mScaleMatrix.invert(mScaleMatrixInverse);
         invalidate();

         return true;
      }
   }

} 
```

# android - 字体字体不起作用

> ID：12479861
> 
> 赞同：4
> 
> 时间：2012-09-18T15:11:05.930
> 
> 标签：android, fonts, typeface

```
TextView tv=(TextView)findViewById(R.id.textView1); 
Typeface face=Typeface.createFromAsset(getAssets(), "font.ttf"); 
tv.setTypeface(face); 
```

我无法看到 textview 字体已更改。我在资产文件夹中有“font.ttf”文件。基本上，我打算在该文本视图（要求）中显示“乌尔都语”字样，因此在资产中添加了乌尔都语字体。然而，它却用英语向我展示了“WORD”。

感谢帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:29:54.727

Android 不支持全系列的 ttf 字体。[这](http://www.dafont.com/ds-digital.font)是我个人在我的应用程序中使用的字体。尝试改用它。如果这个有效，而您的乌尔都语无效，那么您的代码正确，并且 Android 不支持您的字体。如果两者都不起作用，那么您的代码有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-25T06:03:13.250

```
Typeface tf = Typeface.createFromAsset(getAssets(),
            "fonts/burnstown_dam.otf");
    TextView tv = (TextView) findViewById(R.id.CustomFontText);
    tv.setTypeface(tf);

    Typeface tf1 = Typeface.createFromAsset(this.getAssets(), "fonts/Jameel Noori Nastaleeq Kasheeda.ttf");
    TextView textView = (TextView)findViewById(R.id.CustomFontText);
    textView.setTypeface(tf1);
    textView.setText("Your Font Language Here"); 
```

# php - 如何从不完整的类中获取类名？

> ID：12479862
> 
> 赞同：2
> 
> 时间：2012-09-18T15:11:04.873
> 
> 标签：php

我们有一个抛出错误的错误处理程序：__PHP_Incomplete_Class 无法转换为字符串。

错误处理程序当前执行“is_object”测试，对于“不完整”对象来说奇怪的是错误的。我正在尝试调整错误处理程序，但如果不解析重新序列化的版本，我无法获取原始类名。

```
<?php

$o = 'O:14:"BogusTestClass":0:{}';

$c = unserialize($o);

var_dump(
    array(
        'subject' => $c,
        'is_object' => is_object($c), // false !?!?
        'get_class' => get_class($c), // __PHP_Incomplete_Class
        'gettype' => gettype($c),     // 'object'
        'Is instance of?' => $c instanceof __PHP_Incomplete_Class, // true
        'serial' => serialize($c),
    )
);    

// Tried:

var_dump($c->__PHP_Incomplete_Class_Name);
// Error:
//   The script tried to execute a method or access a property of
//   an incomplete object

$refObj = new ReflectionObject($c);
$refProp = $refObj->getProperty('__PHP_Incomplete_Class_Name');
$refProp->setAccessible(true);
var_dump($refProp->getValue($c));
// Error:
//   ReflectionProperty::getValue(): The script tried to execute a
//   method or access a property of an incomplete object.

// This works, but is fragile, since it depends on internal behavior
// of serialize
function getBadClassName($subject)
{
    $serial = serialize($subject);
    $parts  = explode(':', $serial, 4);

    if ('O' === $parts[0] && strlen($parts[2]) -2 == $parts[1]) {
        return substr($parts[2], 1, -1);
    }
    return '-- Error --';
}

var_dump(getBadClassName($c)); 
```

试图从不完整的对象中获取序列化类的名称，以在错误消息中使用。

避免解析字符串，因为我猜当使用重新定义序列化/反序列化的扩展时，字符串解析会崩溃，例如[http://pecl.php.net/package/igbinary](http://pecl.php.net/package/igbinary)或[http://pecl.php.net /package/APC/3.1.7](http://pecl.php.net/package/APC/3.1.7) apc.serializer 挂钩。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T16:28:47.003

基于一个建议看

[强制访问 __PHP_Incomplete_Class 对象属性](https://stackoverflow.com/questions/965611/forcing-access-to-php-incomplete-class-object-properties)

可以通过 foreach 和 ArrayObject 访问该属性

```
<?php

$array = new \ArrayObject($object);
var_dump($array['__PHP_Incomplete_Class_Name']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:14:17.637

你真的不能使用 PHP 不完整的类对象，对我来说它们不算是对象是有道理的，因为你真的不能使用它们。它们存在的唯一原因是它们可以在不需要它们的页面上保持会话。

如果您确实需要它，则必须在对象被反序列化*之前*包含类的定义（如果它在会话中，则在之前`session_start`）。错误消息甚至说明了这一点。

# ios - 表视图加载错误数据并导致应用程序崩溃

> ID：12479865
> 
> 赞同：0
> 
> 时间：2012-09-18T15:11:12.917
> 
> 标签：ios, xcode, xcode4, restkit

我正在开发一个涉及多个表视图的应用程序。该应用程序使用导航控制器，我设置了一个故事板来处理转换。我目前设置了其中两个视图，一个用于“区域”，对象类型为“区域”，另一个用于“类别”，对象类型为“类别”。在每个视图的代码中，我使用 RestKit 将适当的数据加载到一个数组中，然后使用该数据数组来创建表。如果先查看，每个视图都可以单独运行。但是，当我转换到一个视图、关闭它并尝试移动到另一个视图时，我的应用程序崩溃了。显示的异常表明将错误类型的数据加载到表的数组中。例如，如果我先转到类别视图，然后切换到“

*编辑——这是将数据加载到表格单元格中的代码，以及一些说明。*

如果每个表是要加载的第一个表，则每个表都包含正确的数据。只有在切换到另一个表视图时才会发生崩溃。异常已被注释到它们发生的代码中。“categoryName”和“regionName”是它们各自类型的属性。

**地区：**

在顶部，我创建了数组区域：

```
@interface RegionListingsController () {
    NSArray *regions;
} 
```

Restkit onDidLoadObjects 方法：

```
loader.onDidLoadObjects = ^(NSArray *objects) {
    NSLog(@"Objects Loaded");
    regions = nil;
    regions = objects;
    [self.tableView reloadData];
}; 
```

创建表格单元格：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    Region *region = [[Region alloc] init];
    region = nil;
    region = [regions objectAtIndex:indexPath.row];
    NSLog(@"region");
    cell.textLabel.text = region.regionName; // Exception: Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[Category regionName]: unrecognized selector sent to instance 0xce87240'

    return cell;
} 
```

分类：

这大致相同，只是使用类别数组而不是区域数组。数组：@interface CategoryListingsController () { NSArray *categories; }

onDidLoadObjects：

```
loader.onDidLoadObjects = ^(NSArray *objects) {
    NSLog(@"Objects Loaded");
    categories = objects;
    objects = nil;
    [self.tableView reloadData];
}; 
```

表格单元格：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    Category *category = [[Category alloc] init];
    category = nil;
    category = [categories objectAtIndex:indexPath.row];
    NSLog(@"Category Cell");
    cell.textLabel.text = category.categoryName; // Exception: Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[Region categoryName]: unrecognized selector sent to instance 0xce87240'
    NSLog(@"Cell returned");

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:24:15.563

我猜你正在保留这些对象。这里：

```
regions = objects; 
```

和这里：

```
categories = objects; 
```

您可以自己创建一些`@properties (nonatomic, retain)`，`regions`然后`categories`：

```
self.regions = objects; 
```

和，

```
self.categories = objects; 
```

另外，请注意执行此操作的顺序：

```
regions = nil;
regions = objects;

categories = objects;
objects = nil; 
```

如果您采用这种`@properties`方法，则不需要`nil`以前的值。也不需要这样做（带有 的事件`@properties`）：

```
self.categories = objects;
objects = nil; 
```

只需删除第二行。

# android-emulator - Selenium 2：Android 驱动程序安装 - Jetty 未启动且在 localhost wd hub 中未找到

> ID：12479866
> 
> 赞同：2
> 
> 时间：2012-09-18T15:11:29.607
> 
> 标签：android-emulator, selenium-webdriver, ijetty

我的目标是使用 selenium2 在 android 模拟器中运行测试下载 android 驱动程序遵循[http://code.google.com/p/selenium/wiki/AndroidDriver](http://code.google.com/p/selenium/wiki/AndroidDriver)中提到的相同步骤 a) JDK / JRE 安装 b) Android SDK (windows ) 在那里 c) 创建 AVD 并从 SDK 管理器获取 3.2 版本的操作系统目标 d) 启动模拟器并在模拟器中安装 selenium android 服务器（安装 webdriver APK） e) 安装 Selenium 独立服务器 127.0.0.1:4444/ wd/hub/static/resource/hub.html（显示的会话）

f) 完成端口转发 adb -s emulator-5554 forward tcp:8080 tcp:8080 g) 运行此命令 adb -s emulator-5554 shell am start -a android.intent.action.MAIN -n org.openqa.selenium。 android.app/.MainActivity h) 我的 webdriver 开始显示 - Webdriver 准备就绪

但问题是 Jetty 未启动（在 Jetty 启动时未显示在模拟器中）

并且 android 服务器在 localhost:8080/wd/hub 从主机不可用。（也尝试使用 ipaddress .. 不高兴）

当我通过更改为 driver = new AndroidDriver(); 运行测试时

失败：SetUp：OpenQA.Selenium.WebDriverException：意外错误。

未找到错误404

HTTP 错误：404 访问 /hub/session 时出现问题。原因：未找到 Powered by Jetty://

TearDown : System.NullReferenceException : 对象引用未设置为对象的实例。

任何人都可以帮助为什么会发生这种情况？和相同的解决方案

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:49:14.850

确保在 AVD 中将模拟器设置为具有非零大小的 SDCARD。Selenium 似乎需要 SDCARD 来写入临时数据，当您尝试创建驱动程序时，服务器将静默失败，导致最终用户出现的似乎是 404 或类似错误。

# eclipse - saros 会话后导入在 Eclipse 中不起作用

> ID：12479867
> 
> 赞同：0
> 
> 时间：2012-09-18T15:11:30.810
> 
> 标签：eclipse, import

我的源文件夹中有一个包 com.foo。在那个包中有一个类 SomeClass。我在 com.bar 中有一个类 AnotherClass，它声明了一个 SomeClass。

在与另外两个同事开始沙罗会话后，在我们所有的三台机器上 SomeClass 都无法被 AnotherClass 识别。我们当然是在导入 com.foo.SomeClass 并且在我们开始会话之前这个类（自然）被 eclipse 识别了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:11:30.810

当我写这个问题时，一个同事解决了这个问题。Java Build Path 窗口中的 Order and Export 选项卡不知何故选择了我们所有的项目资源，包括外部库。我们简单地取消选择除源文件夹之外的所有资源并构建项目。

您可以通过右键单击包资源管理器中的 src 文件夹并转到“构建路径”>“配置构建路径...”来进入 Java 构建路径窗口。

# c++ - 为什么 == 重载可以访问参数的私有成员

> ID：12479875
> 
> 赞同：13
> 
> 时间：2012-09-18T15:11:54.613
> 
> 标签：c++, operator-overloading, access-specifier

> **可能重复：**
> [为什么类实例可以更改 obj 的私有值？](https://stackoverflow.com/questions/12447782/why-private-value-of-the-obj-can-be-changed-by-class-instance)

考虑以下（部分）代码：

```
class Group {
    private:
      int id;

    public:
      void set_id(int);
      int get_id();
      bool operator==(const Group&);
};

bool Group::operator==(const Group& g) {
    if(g.id == this->id) {  /* id is private? */
            return true;
    }

    return false;
} 
```

代码编译并且结果似乎正确。但是，在`if`运算符重载实现的部分，我们直接访问了它的参数的私有成员 - `const Group& g`，但是这样的访问不是无效的吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-18T15:14:09.563

你`operator==`是你`Group`班的成员。成员函数可以访问`private`该类的任何成员，不仅对于`this`，而且对于它们可以访问的任何实例。

如果您考虑一下，这种行为是必要的，因为否则访问控制将使两个或多个实例（`swap`复制构造函数，运算符）的交互方法变得不可能，除非对象具有任何成员变量的公共访问器，该访问器用于此类一个方法。从设计的角度来看，这通常是不可取的。此外，它会将访问控制的标准提高到很高（“如果我只是将该成员公开，我就可以免除我的痛苦......”）。

总结这段代码是完全有效的（虽然我不明白为什么`if`是必要的，与简单地使用相比`return g.id == this->id;`）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-18T15:13:40.763

访问限定符不是控制实例级别的访问，而是控制类型级别的访问。T 类型实例的任何成员函数都可以访问相同类型 T 的任何其他实例的所有私有成员。

由于它`operator==`是一个成员函数，它可以访问它所属的类实例的所有成员变量。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-18T15:13:01.563

不，因为`operator==`是 的成员`Group`。它就在函数名中。这意味着它可以访问该类的*任何*`private`对象的成员。

 *如果您尝试将其编写为自由函数，则不会编译：

```
bool areEqual(const Group& g1, const Group& g2) {
    return g1.id == g2.id;
} 
```*

# php - 推送时Heroku“没有雪松支持的应用程序”，即使应用程序在雪松堆栈上？

> ID：12479880
> 
> 赞同：1
> 
> 时间：2012-09-18T15:12:00.880
> 
> 标签：php, heroku, cedar

我以前从未使用过 Heroku，但我们的客户希望我们使用它。Heroku 上已经设置了一个应用程序，如果我登录并检查应用程序信息，它会说它在 cedar 堆栈上。

现在我想在上面放一些 PHP 文件。我已经设置了一个遥控器，然后使用了 git init、add、commit，但是当我尝试使用“git push heroku master”时，我得到了错误：

```
Heroku push rejected, no Cedar-supported app detected 
```

我不明白，因为该应用程序已设置为雪松应用程序？我见过很多人有同样的错误信息，但所有的解决方案似乎都说这与 gemfiles （我不知道它们是什么）有关，或者再次运行 git init 。

有没有人对问题可能有任何其他想法？如果这里没有太多信息，我深表歉意，但正如我所说，我以前从未使用过 Heroku，并且只将 git 用于另一个项目（通常我们使用自己的服务器，我可以使用 GUI 将 PHP 文件放入其中）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T19:49:21.437

您需要在根目录中有一个 index.php，以便 Heroku 将应用程序类型检测为 PHP。

# python - 如何学习 PySide？

> ID：12479882
> 
> 赞同：1
> 
> 时间：2012-09-18T15:12:02.263
> 
> 标签：python, pyside

[文档](http://qt-project.org/wiki/PySideDocumentation/)中的教程很少：

*   你的第一个 PySide 应用程序
*   一个简单的可点击按钮教程
*   简单的 PySide 对话框应用程序
*   Signals_and_Slots_in_PySide
*   Using_Qt_Properties_in_PySide
*   PySide_DBus_Integration
*   PySide_国际化
*   PySide_Pitfalls

... 就这样。

学习 PySide 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:19:53.833

*   检查`Qt`文档的教程。
*   检查[本教程](http://zetcode.com/gui/pysidetutorial/)（您通过谷歌搜索找到的第一个`pyside tutorial`
*   检查[这些教程](http://diotavelli.net/PyQtWiki/Tutorials)（`PyQt`谷歌时的第一个链接`pyqt tutorial`
*   练习，练习，练习。你会惊讶于它是多么容易。

当然，[SO](https://stackoverflow.com/questions/4234028/getting-started-with-pyside)充满了相关的问题，可以帮助你。

# google-chrome - 如何关闭附加到 chrome 的复制和粘贴 URL 的 http

> ID：12479885
> 
> 赞同：12
> 
> 时间：2012-09-18T15:12:18.437
> 
> 标签：google-chrome, configuration

在最近的几个版本中，Chrome 已经停止在地址栏中显示 HTTP。此外，当您尝试从浏览器窗口复制 URL 时，应用程序会自动更改它发送到剪贴板的内容，以添加`http://`到我复制的内容的前面。

有没有办法在任何地方关闭它？我希望它显示`http`或准确发送我复制到剪贴板的内容。

# python - 如何将字体文件安装或复制到 Windows 字体文件夹

> ID：12479886
> 
> 赞同：0
> 
> 时间：2012-09-18T15:12:22.253
> 
> 标签：python, fonts, shutil

我正在执行一个简单的操作，将字体文件（ttf 扩展名）从下载的位置复制到字体文件夹，但它不起作用，

```
usrPath = os.environ['USERPROFILE']
src=downloadFont()
print("Downloaded Location:", src)
#dst=usrPath[0]+':\\Windows\\Fonts\\anmollipi.ttf' # this one doesnt
dst="C:\\Users\\Teacher\\Desktop"  # this one works
print("Install location",dst)
copyfont(src,dst) 
```

我希望有人可以调查并帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:22:11.570

I don't know what's in the `USERPROFILE` environment variable since you haven't told us yet, but I doubt very much it should have a ":\" appended to it. That would only make sense for drive letters (e.g. just "C" or "D" without the colon), and `USERPROFILE` is supposed to be a *path*.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T13:18:34.523

确保您对 Fonts 文件夹具有读写访问权限，有时即使您以具有管理员权限的系统上的用户身份登录，您也需要更改文件夹权限才能执行文件写入操作...

# php - PHP 检查是否 如果存在则结束

> ID：12479887
> 
> 赞同：1
> 
> 时间：2012-09-18T15:12:28.253
> 
> 标签：php, list, blogs

我让我的博客通过获取前 300 个字符并切断最后一个完整单词来生成预览。我的问题是，当我在博客顶部附近有一个列表时，它有时会包含在预览中，但是结束列表标签通常不会。那么如何检查`$preview`变量的起始列表标记，如果找到，检查结束标记，如果不存在则添加一个。

我预览的所有代码。

```
$preview = wordwrap($content, 300);
$preview = explode("\n", $preview);
$preview = $preview[0] . "..."; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:16:57.060

尝试这个

```
if ( !strpos($preview, '<ul>') && !strpos($preview, '</ul>') ) {
    $preview .= '</ul>';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:38:10.883

```
if ( strpos($preview, '<ul>') !== false && strpos($preview, '</ul>') === false ) {
    $preview .= '</ul>';
} 
```

# ruby-on-rails-3 - 使用 Devise 登录后如何重定向用户，以及如何向 Devise 注册控制器添加方法

> ID：12479888
> 
> 赞同：0
> 
> 时间：2012-09-18T15:12:29.353
> 
> 标签：ruby-on-rails-3, devise

使用 Rails 3.2.8、Devise 2.1.2 和 Simpleform 2.0.2

我正在尝试使用设计成功登录和注销后重定向用户。

那么我是否需要修改控制器（具体细节）？或者我是否需要实现[重定向助手](https://github.com/plataformatec/devise/wiki/How-To%3a-Redirect-to-a-specific-page-on-successful-sign-in-or-sign-out)，如果需要，我应该把助手放在哪里？

万分感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:45:27.923

您应该能够通过将以下内容添加到您的 application_controller 来做到这一点

```
def after_sign_in_path_for(resource)
  some_path
end

def after_sign_out_path_for(resource)
  root_url
end 
```

我认为资源是一个用户类，因此您可以检查类型并将它们重定向到适当的路径。

# java - 在 Windows 7 平板电脑中执行时我的 GUI 看起来很奇怪

> ID：12479894
> 
> 赞同：2
> 
> 时间：2012-09-18T15:12:47.830
> 
> 标签：java, swing, user-interface, gridbaglayout

最近我用 JAVA/Swing 用简单的 GUI 编写了一对应用程序：

*   一个 JScrollPane
*   在第一个应用程序中，JScrollPane 中有一个 JTextArea，而在第二个应用程序中，有一个 JTable。

它们看起来不错，工作正常。直到我在 Windows 7 平板电脑（HP Slate）上执行。它们看起来都是空的，中间有一个小符号。这张图片显示了第一个应用程序（JTextArea 应用程序）如何查看平板电脑：

![在此处输入图像描述](../Images/b303e459042c8173fa7ebb9dfe0a80c3.png)

这里有什么问题，我该如何解决？

我正在显示代码，但由于使用计算机时看起来不错，我想这不是问题：

```
import java.io.*;
import java.net.*;

import java.util.Date;
import java.text.DateFormat;
import java.text.SimpleDateFormat;

import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;
import java.awt.Dimension;
import java.awt.Toolkit;

import javax.swing.JFrame;
import javax.swing.JTextArea;
import javax.swing.JOptionPane;
import javax.swing.JScrollPane;
import javax.swing.text.DefaultCaret;

class EstacionBase extends JFrame{
    private static final long serialVersionUID = 1L;

private static final String logFile = "log.txt";

private DateFormat df;
private FileWriter logWriter;

private Socket sisnetSocket;
private ServerSocket serverSocket;
private Socket clientSocket;
private BufferedWriter outToPlane;
private BufferedWriter outToDataServer;
private BufferedReader inputFromDataServer;
private JTextArea console;

private boolean terminated;

public EstacionBase() {
    setTitle("Base station");
    createGUI();
    pack();
    setResizable(false);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setLocationRelativeTo(null);
    setVisible(true);

    try{
        df = new SimpleDateFormat ("[hh:mm:ss]");
        logWriter = new FileWriter(System.getProperty("user.dir") + "\\" + logFile, true);
        serverSocket = new ServerSocket(PORT); // A socket I use for listening for connections
    } catch(IOException e){
        JOptionPane.showMessageDialog(this, e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
    }

    //mainLoop(); // doing some stuff

    try{
        logWriter.close();
        serverSocket.close();
    } catch(IOException e){
        JOptionPane.showMessageDialog(this, e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
    }
}

private void createGUI() {
    setLayout(new GridBagLayout());
    GridBagConstraints c = new GridBagConstraints();
    c.gridx = 0;
    c.gridy = 0;
    c.fill = GridBagConstraints.BOTH;

    console = new JTextArea(40, 80);
    JScrollPane scroll = new JScrollPane(console);
    DefaultCaret caret = (DefaultCaret) console.getCaret();
    caret.setUpdatePolicy(DefaultCaret.ALWAYS_UPDATE); // Autoscroll
    console.setText("Welcome to base station");
    console.setEditable(false);
    console.setVisible(true);
    add(scroll, c);
}

private void writeToConsole(String msg) throws IOException{
    Date now = new Date();
    String timeStr = df.format(now);
    console.append("\n");
    console.append(timeStr + " " + msg);
    writeToLogFile(msg, timeStr);
}

private void writeToLogFile(String msg, String timeStr) throws IOException{
    logWriter.write(timeStr + " " + msg + CRLF);
        logWriter.flush();
    }

    public static void main(String[] arg) {
        EstacionBase frame = new EstacionBase();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T14:00:30.973

这是一个`GridBagLayout`问题；我不确定最佳修复，但它适用于默认`JFrame`布局，`BorderLayout.CENTER`. 在功能上，这三种布局具有相似的效果：

*   `BorderLayout.CENTER`: 的默认值`JFrame#add()`。

*   `GridLayout()`：一列，一排，没有间隙。

*   `GridBagLayout()`：默认`GridBagConstraints()`将所有字段设置为默认值。

顺便说一句，Swing GUI 对象应该*只*在[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上构建和操作。

# google-bigquery - 从 JavaScript 代码获取 BigQuery 数据

> ID：12479895
> 
> 赞同：6
> 
> 时间：2012-09-18T15:12:54.253
> 
> 标签：google-bigquery

我是[BigQuery](http://en.wikipedia.org/wiki/BigQuery)的新手（以及实际使用 Google API 的任何东西）。尝试从 JavaScript 代码中读取表格时，鉴于我目前的经验和文档状态以及缺少可以找到的示例代码，我不知道应该如何完成。这是我已经通过 Google 的在线控制台填充的表格，并且可以在该在线控制台中无缝查询。

使用 Google 的 BigQuery 测试版 JavaScript 库，我的代码会收到跟随我的实际代码的错误对象。它无法获取表句柄，根据我的理解，这是实际发出读取表的调用所必需的。为了阅读表格的内容，我很确定我的代码在我使用的 API 调用方面不止一种方式不正确。

### 代码

```
gapi.client.load('bigquery', 'v2', function() {
    gapi.client.setApiKey('My Key for browser apps here...');
    var request = gapi.client.bigquery.tables.get({'id': 'My-dataset-name.My-table-name'});
    request.execute(function(response) {console.log(response, JSON.stringify(response, null))});
}); 
```

### 结果

*{"code":401,"message":"需要登录","data":[{"domain":"global","re​​ason":"required","message":"需要登录","locationType" :"header","location":"授权"}]*

我没有推断出 API 密钥（在我的仪表板中显示的“浏览器应用程序的密钥”）是否足以授权访问以读取数据，以及该`tables.get`指令应使用的语法是什么。鉴于第一次使用它的众多维度，我怀疑我是否会找到如何使用 API 而不会让我的头发着火。最后两点的详细解释是什么，工作示例代码是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T01:22:38.320

适用于 JavaScript的[Google API 客户端库](https://code.google.com/p/google-api-javascript-client/)处理存储和使用 OAuth 2.0 访问和刷新令牌的*客户端*授权流程。正如 Jordan 所提到的，无法使用 API 密钥从客户端访问 BigQuery——因为 JavaScript 应用程序无法隐藏客户端机密，用户必须在某个时候授权访问 API。

我对您的服务器端用例感兴趣。您使用的是 node.js 还是其他一些服务器端 JS 框架？节点工具箱中有一堆[通用的 OAuth 节点模块](http://toolbox.no.de/categories/Authentication)（我对任何特定的“最佳”模块都不是很熟悉）。其中之一可能会简化通过 JS 在服务器端处理令牌的过程。

当您授权访问 Google API 时，系统会为您提供一个用于调用 API 的访问令牌 - Google API OAuth 2.0 访问令牌持续一小时。并且，您可以请求和存储刷新令牌，这将允许您在访问令牌过期时请求新的访问令牌。

[以下是直接从我们有关 BigQuery 授权流程的文档](https://developers.google.com/bigquery/docs/authorization#client-side-javascript)中提取的客户端 JavaScript 授权示例：

```
<html>
  <head>
    <script src="https://apis.google.com/js/client.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>

      function auth() {
        gapi.auth.authorize(config, function() {
            gapi.client.load('bigquery', 'v2');
            $('#client_initiated').html('BigQuery client authorized');
            $('#auth_button').fadeOut();
            $('#dataset_button').fadeIn();
        });
      }

      // User Submitted Variables
      var projectNumber = 'XXXXXXXXXX';
      var clientId = 'XXXXXXXXXX.apps.googleusercontent.com';

      var config = {
        'client_id': clientId,
        'scope': 'https://www.googleapis.com/auth/bigquery'
      };

      function listDatasets() {
        var request = gapi.client.bigquery.datasets.list({
          'projectId':projectNumber
        });
        request.execute(function(response) {
            $('#result_box').html(JSON.stringify(response.result.datasets, null));
        });
      }
    </script>
  </head>

  <body>
    <button id="auth_button" onclick="auth();">Authorize</button>
    <div id="client_initiated"></div>
    <button id="dataset_button" style="display:none;" onclick="listDatasets();">Show datasets</button>
    <div id="result_box"></div>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T01:20:32.963

以下示例是用于查询[BigQuery](http://developers.google.com/bigquery/)并将结果填充到由[Google Chart Tools](https://developers.google.com/chart/interactive/docs/gallery/geochart)生成的地图中的 HTML/JavaScript 代码。您需要使用您的项目 ID 和客户端 ID 进行更新——并在[API 控制台](http://code.google.com/apis/console/)中注册您的应用程序才能使用它。

这使用此处记录的美国出生统计（出生）样本数据集： [https ://developers.google.com/bigquery/docs/dataset-natality](https://developers.google.com/bigquery/docs/dataset-natality)

它使用[适用于 JavaScript 的 Google API 客户端库](https://code.google.com/p/google-api-javascript-client/)来处理对 BigQuery 的授权和 API 请求。

用户首次访问此页面时将被引导通过 OAuth 批准流程（以获得对“配置”中定义的 OAuth 范围的权限）。他们必须是指定项目的授权用户（这样才能实施项目的配额/计费）。如果用户最近未授权，则此 OAuth 授权将导致弹出窗口出现，但如果之前已授予授权，则无需再次授予授权。如果您需要它更透明地发生，您可以查看“[立即模式”。](http://code.google.com/p/google-api-javascript-client/wiki/Authentication#Specifying_Your_Client_ID_and_scopes)

```
<html>
<head>
<script src="https://apis.google.com/js/client.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load('visualization', '1', {packages: ['geochart']});
</script>
<script>
  // UPDATE TO USE YOUR PROJECT ID AND CLIENT ID
  var project_id = '605902584318';
  var client_id = '605902584318.apps.googleusercontent.com';

  var config = {
    'client_id': client_id,
    'scope': 'https://www.googleapis.com/auth/bigquery'
  };

  function runQuery() {
   var request = gapi.client.bigquery.jobs.query({
      'projectId': project_id,
      'timeoutMs': '30000',
      'query': 'SELECT state, AVG(mother_age) AS theav FROM [publicdata:samples.natality] WHERE year=2000 AND ever_born=1 GROUP BY state ORDER BY theav DESC;'
    });
    request.execute(function(response) {     
        console.log(response);
        var stateValues = [["State", "Age"]];
        $.each(response.result.rows, function(i, item) {
          var state = item.f[0].v;
          var age = parseFloat(item.f[1].v);
          var stateValue = [state, age];
          stateValues.push(stateValue);
        });  
        var data = google.visualization.arrayToDataTable(stateValues);
        var geochart = new google.visualization.GeoChart(
            document.getElementById('map'));
        geochart.draw(data, {width: 556, height: 347, resolution: "provinces", region: "US"});
    });
  }

  function auth() {
    gapi.auth.authorize(config, function() {
        gapi.client.load('bigquery', 'v2', runQuery);
        $('#client_initiated').html('BigQuery client initiated');
    });
    $('#auth_button').hide();
  }
</script>
</head>

<body>
<h2>Average Mother Age at First Birth in 2000</h2>
<button id="auth_button" onclick="auth();">Authorize</button>
<button id="query_button" style="display:none;" onclick="runQuery();">Run Query</button>
<div id="map"></div>
</body>
</html> 
```

注意：如果您尝试在不让用户通过 OAuth 授权的情况下将查询计入您的配额/账单，您需要设置一个简单的服务器端代理来代理您对 API 的请求。使用服务帐户在 App Engine 上执行此操作相当简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:29:26.650

简短的回答是密钥不足以授权。您需要一个[OAuth 2.0](http://en.wikipedia.org/wiki/OAuth#OAuth_2.0)令牌。我不是 JavaScript 用户，所以我不知道确切的机制，但希望这会给你一个正确方向的指针。

# android - 检测浏览器文件输入支持

> ID：12479897
> 
> 赞同：5
> 
> 时间：2012-09-18T15:12:59.467
> 
> 标签：android, html, mobile, mobile-safari

我了解 Mobile Safari 不支持`<input type="file" />`. 如果用户无法通过我的 HTML 表单上传文件，我希望能够显示某种“不支持”信息。

我已经查看了[这个问题](https://stackoverflow.com/questions/4127829/detect-browser-support-of-html-file-input-element)，虽然 BK 的答案很好，但它不是决定性的。

根据设备宽度删除表单是否更明智？我的意思是用`@media (max-device-width: 480px) {}`. 这是一个不好的方法吗？市场上是否有支持直接在浏览器中上传文件的移动设备？

我知道[iOS6 会支持媒体上传](http://www.idownloadblog.com/2012/06/13/ios-6-safari-media-uploads/)，但还没有发布。还有其他人吗？安卓呢？视窗手机？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-18T15:41:02.123

我刚试过这个......它的工作原理......

自己试试吧！[http://fiddle.jshell.net/nmGRu/show/](http://fiddle.jshell.net/nmGRu/show/) （如果您发现任何浏览器未能报告我想知道的正确结果...同上任何其他的工作，这将有助于完成这个答案）

Safari（iOS 5 及更低版本）将返回`false`，因为它不支持文件上传（特别是它允许您添加输入，但将其标记为禁用）......但支持它的移动浏览器，如三星 Galaxy Tab (Android)、黑莓PlayBook / BlackBerry 10（我正在 Dev Alpha 上进行测试）将返回`true`，因为他们的浏览器确实支持上传。

**到目前为止**正确的测试结果：****

 ***   Apple iPhone iOS 5 及以下 Safari（检测到**不**支持）
*   Apple iPhone iOS 6 Safari（检测支持 - 允许选择照片/视频）
*   Apple iOS 4/iOS 5，越狱，已安装 Safari Upload Enabler（检测到支持）
*   Apple iPhone w/Chrome（检测到**不**支持）
*   Apple iPhone w/Opera Mini（检测支持 - 允许选择照片）
*   Android 版 Chrome（检测支持）
*   Android 版本的 Firefox（检测支持）
*   Android 版 Opera（检测支持）
*   黑莓 OS7 智能手机（检测支持）
*   BlackBerry PlayBook（检测支持）
*   BlackBerry 10（Dev Alpha 和 Z10）（检测支持）
*   HTC Desire（检测支持）
*   三星 Galaxy Nexus（检测到支持）
*   三星 Galaxy Nexus S（检测到支持）
*   三星 Galaxy Nexus 7 平板电脑（检测到支持）
*   三星 Galaxy Note（检测到支持）
*   三星 Galaxy S2（检测到支持）
*   三星 Galaxy S3（检测到支持）
*   三星 Galaxy Tab（检测到支持）
*   Tizen（检测支持）

**到目前为止的**错误检测测试结果：****

 ***   Windows Phone {Tango}（检测到支持，**但**实际上不支持）

*注意：我正在修改此代码以解决 windows phone 上的检测问题*

这是一个干净的版本，它只返回一个布尔值......并且不会污染页面。

```
function hasFileUploadSupport(){
  var hasSupport = true;
  try{
    var testFileInput = document.createElement('input');
    testFileInput.type = 'file';
    testFileInput.style.display = 'none';
    document.getElementsByTagName('body')[0].appendChild(testFileInput);
    if(testFileInput.disabled){
      hasSupport = false;
    }
  } catch(ex){
     hasSupport = false;
  } finally {
    if(testFileInput){
      testFileInput.parentNode.removeChild(testFileInput);
    }
  }
  return hasSupport;
}

alert(hasFileUploadSupport()); 
```****

# windows-phone-7 - 在同一解决方案中存在的另一个项目中使用 App.xaml.cs 参考？

> ID：12479906
> 
> 赞同：0
> 
> 时间：2012-09-18T15:13:19.133
> 
> 标签：windows-phone-7, xaml, microsoft-metro, windows-phone-7.1

嗨，我在初始项目（默认项目）中的解决方案中有不同的项目，我正在以这种方式访问​​对 App.xaml.cs 的全局引用：-

应用 objref = (App)Application.Current;

但是现在我已将新项目添加到我的解决方案中，并尝试以与前面定义相同的方式访问 app.xaml.cs 但我无法访问 app.xaml.cs ？

1）我能知道原因吗

2）如果我想在两个项目中使用它应该怎么做？

请告诉我

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:10:47.370

您可以访问它，但新项目将不熟悉您项目中的派生 App 类。为了进一步解释，我们需要考虑继承。

Application 类有一个通用定义，它公开了许多预定义的方法。您的 App.xaml.cs 是派生自 Application 类的新类定义。它具有它继承的方法以及您添加的任何方法和属性。要使用这些，任何试图使用额外属性或方法的代码都必须能够访问类定义。您添加的其他项目中的类无权访问此定义。

您需要创建两个项目都可以访问的类或接口定义。有几种组织方式。我会介绍一个。

1.  在解决方案中创建您的主项目。这包含您的 App.xaml.cs。
2.  创建包含其他代码的类库项目。
3.  创建第三个名为 Common 的项目，该项目仅包含一个接口定义。
4.  在接口定义上定义您希望类库和主项目也可以访问的所有方法/属性。
5.  让 App.Xaml.cs 实现此接口。
6.  在类库中访问 var appReference = (IMyInterfaceName)Applcation.Current。您将可以访问接口中定义的方法

# java - 如何使列表页眉和页脚无法点击？

> ID：12479909
> 
> 赞同：0
> 
> 时间：2012-09-18T15:13:24.937
> 
> 标签：java, android

我有一个带有页脚和页眉的列表。我添加了 onLongClick 以从列表中删除项目。当我长按标题时，它会从列表中删除第一项。当我点击最后一个项目或页脚时，应用程序将崩溃——项目超出范围。

> **我可以使页脚和页眉不可点击吗？或者我应该如何计算适配器中的项目？还是有其他方法可以通过它？**
> 
> > 删除项目：

```
list.setOnItemLongClickListener(new OnItemLongClickListener() {
        public boolean onItemLongClick(AdapterView<?> parent, View v,
                int position, long id) {
            // Delete Item from List

            ShoppingItem simpleItem = null;

            if (shoppingListApplication.getAdapter().getCount() > 0) {
                simpleItem = (ShoppingItem) shoppingListApplication
                        .getAdapter().getItem(position);
                removeShoppingItem(simpleItem,
                        shoppingListApplication.getAdapter());

            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:18:42.487

您必须使用[addHeaderView (View v, Object data, boolean isSelectable)](http://developer.android.com/reference/android/widget/ListView.html#addHeaderView%28android.view.View,%20java.lang.Object,%20boolean%29)和[addFooterView (View v, Object data, boolean isSelectable)](http://developer.android.com/reference/android/widget/ListView.html#addFooterView%28android.view.View,%20java.lang.Object,%20boolean%29)使 ListView 的页眉和页脚不可点击。

只需通过`false`代替`isSelectable`页眉和页脚。

伪代码，

```
listview.addHeaderView(header_view, null, false);
listview.addFooterView(footer_view, null, false); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-22T10:32:36.447

`HeaderView`对于和`FooterView`中的单独上下文菜单`ListView`。

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();

    if (((AdapterContextMenuInfo)menuInfo).position == 1) {
        inflater.inflate(R.menu.foo1, menu);    // HEADER MENU
        return;
    }
    else if(((AdapterContextMenuInfo)menuInfo).position == listView.getAdapter().getCount() + 1) {
        inflater.inflate(R.menu.foo2, menu);    // FOOTER MENU
        return;
    }
    inflater.inflate(R.menu.foo3, menu);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T15:20:43.490

如果在 ListView 上添加列表标题，则适配器中第一项的索引为 1。如果未添加标题，则适配器中的第一项索引为 0。

# linux - 由于大量 CLOSE_WAIT，httpd 速度变慢

> ID：12479910
> 
> 赞同：1
> 
> 时间：2012-09-18T15:13:32.470
> 
> 标签：linux, apache

我的网络服务器被大量的 tcp CLOSE_WAIT 阻塞。我重新启动 httpd，服务器再次开始正常运行。但在半天之内，它减速到停止。我做了一个`netstat`，看到了很多`CLOSE_WAITS`。这是预期的行为还是有问题？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:26:36.590

Its meant to be like that Apache should be reusing when it needs, It may not be the cause of slow downs. What are you serving ? And if its dynamic how are you serving it ? (CGI / Apache Module etc )

# javascript - 命名闭包会污染全局/窗口对象吗？

> ID：12479915
> 
> 赞同：7
> 
> 时间：2012-09-18T15:13:48.790
> 
> 标签：javascript, node.js, coding-style, v8

根据[这个节点样式指南](http://nodeguide.com/style.html#named-closures)，给闭包起一个名字是一个很好的做法：

> **正确的**
> 
> ```
> req.on('end', function onEnd() {
>   console.log('winning');
> }); 
> ```
> 
> **错误的**
> 
> ```
> req.on('end', function() {
>   console.log('losing');
> }); 
> ```

然而，我习惯于思考

```
function someName() { someStatements(); } 
```

...语法作为创建全局变量`someName`或`window.someName`用于该函数的东西。这*真的*是一个很好的做法，还是一个非常糟糕的风格指南？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T15:24:39.863

虽然你不会有这个节点的问题：

命名函数表达式在 Internet Explorer 中存在错误，并且会污染窗口对象，如下所述：http: [//kangax.github.com/nfe/](http://kangax.github.com/nfe/) 在“JScript 错误”下

（不那么）有趣的是，它们甚至是在从未执行的条件块中创建的，如下例所示：

```
var f = function g() {
  return 1;
};
if (false) {
  f = function g(){
    return 2;
  };
}
g(); // 2 
```

这在我使用的生产站点上造成了一个问题，jQuery 突然被其他东西取代（[https://dev.plone.org/ticket/12583](https://dev.plone.org/ticket/12583)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T15:27:41.147

In node.js, what you describe **does not pollute the global context**.

Given:

```
function someName() { someStatements(); } 
```

`global.someName` will be defined. The following however:

```
setTimeout(function someName() { someStatements(); }, 500); 
```

Will *not* set `global.someName`.

It seems to be just a matter of aesthetics. I tested this with node.js v0.8.4, but the same behaviour should be present in most modern browsers.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-24T10:25:24.060

命名闭包的名称只能**在**这个闭包内部访问，因此它永远不会污染全局命名空间。通常你会使用命名的闭包来创建一个递归闭包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T15:21:23.367

您不能使用名称访问匿名函数（如果函数有名称）。它可以在函数体内访问。所以它不会污染窗口对象。

```
req.on('end', function onEnd() { 
  console.log(onEnd); //function body
}); 
console.log(onEnd); //ReferenceError: onEnd is not defined 
```

# apache - 一个目录的所有项目的 HTACCESS IP 限制

> ID：12479921
> 
> 赞同：0
> 
> 时间：2012-09-18T15:14:16.077
> 
> 标签：apache, .htaccess

我正在使用 Joomla ，并在管理员目录中使用 htaccess 来限制通过 IP 地址的访问，htaccess 在这里`site.com/administrator/.htaccess`

***问题：***
htaccess 工作并使用 IP 地址限制访问，但只在子目录上工作。
例如`site.com/administrator/index.php`，也可以从不包含的 IP 地址访问并限制仅在子目录上工作`site.co../admi.../includes`不能访问公共 IP 地址（不包含在 htaccess 中）。
如何将其设置为限制此目录的所有项目（具有所有子目录的管理员目录）？

***我的 htaccess ：***

```
AuthName "Access Restrict"
AuthType Basic 
<Limit GET POST>
order deny,allow
deny from all
allow from 46.36.45.1.
</Limit> 
```

***我的根 htaccess***：

```
##
# @version $Id: htaccess.txt 21064 2011-04-03 22:12:19Z dextercowley $
# @package Joomla
# @copyright Copyright (C) 2005 - 2010 Open Source Matters. All rights reserved.
# @license http://www.gnu.org/copyleft/gpl.html GNU/GPL
# Joomla! is Free Software
##

#####################################################
#  READ THIS COMPLETELY IF YOU CHOOSE TO USE THIS FILE
#
# The line just below this section: 'Options +FollowSymLinks' may cause problems
# with some server configurations.  It is required for use of mod_rewrite, but may already
# be set by your server administrator in a way that dissallows changing it in
# your .htaccess file.  If using it causes your server to error out, comment it out (add # to
# beginning of line), reload your site in your browser and test your sef url's.  If they work,
# it has been set by your server administrator and you do not need it set here.
#
#####################################################

##  Can be commented out if causes errors, see notes above.
Options +FollowSymLinks

#
#  mod_rewrite in use

RewriteEngine On

########## Begin - Rewrite rules to block out some common exploits
## If you experience problems on your site block out the operations listed below
## This attempts to block the most common type of exploit `attempts` to Joomla!
#
## Deny access to extension xml files (uncomment out to activate)
#<Files ~ "\.xml$">
#Order allow,deny
#Deny from all
#Satisfy all
#</Files>
## End of deny access to extension xml files
# Block out any script trying to set a mosConfig value through the URL
RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|\%3D) [OR]
# Block out any script trying to base64_encode data within the URL
RewriteCond %{QUERY_STRING} base64_encode[^(]*\([^)]*\) [OR]
# Block out any script that includes a <script> tag in URL
RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
# Block out any script trying to set a PHP GLOBALS variable via URL
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
# Block out any script trying to modify a _REQUEST variable via URL
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
# Return 403 Forbidden header and show the content of the root homepage
RewriteRule .* index.php [F]
#
########## End - Rewrite rules to block out some common exploits

########## Begin - Custom redirects
#
# If you need to redirect some pages, or set a canonical non-www to
# www redirect (or vice versa), place that code here. Ensure those
# redirects use the correct RewriteRule syntax and the [R=301,L] flags.
#
########## End - Custom redirects

#  Uncomment following line if your webserver's URL
#  is not directly related to physical file paths.
#  Update Your Joomla! Directory (just / for root)

# RewriteBase /

########## Begin - Joomla! core SEF Section
#
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
#
# If the requested path and file is not /index.php and the request
# has not already been internally rewritten to the index.php script
RewriteCond %{REQUEST_URI} !^/index\.php
# and the request is for root, or for an extensionless URL, or the
# requested URL ends with one of the listed extensions
RewriteCond %{REQUEST_URI} (/[^.]*|\.(php|html?|feed|pdf|raw))$ [NC]
# and the requested path and file doesn't directly match a physical file
RewriteCond %{REQUEST_FILENAME} !-f
# and the requested path and file doesn't directly match a physical folder
RewriteCond %{REQUEST_FILENAME} !-d
# internally rewrite the request to the index.php script
RewriteRule .* index.php [L]
#
########## End - Joomla! core SEF Section

enter code here 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T08:15:03.557

问题是从 PLESK 控制面板保护目录功能。 `administrator`dir 也受到来自 plesk 的用户/通行证的保护。去掉保护后，问题就解决了。

# c++ - c++ Unicode 字符串与易混淆字符的比较。例如（U 0054）应该是==（U03A4）等

> ID：12479922
> 
> 赞同：1
> 
> 时间：2012-09-18T15:14:16.013
> 
> 标签：c++, unicode

我有 Unicode 字符串，我想与以下要求进行比较。

易混淆的 s [1] 字符应视为相同字符，例如：T (LATIN CAPITAL LETTER TU 0054) 应为 == T (GREEK CAPITAL LETTER TAU U03A4) 等

(* [1] 示例 [http://unicode.org/cldr/utility/confusables.jsp?a=TESTt&r=None](http://unicode.org/cldr/utility/confusables.jsp?a=TESTt&r=None) *)

[http://www.unicode.org/Public/security/revision-03/confusablesSummary.txt](http://www.unicode.org/Public/security/revision-03/confusablesSummary.txt)

我将使用上面的文件来编写代码，但如果已经有任何免费库，我更愿意使用它。

我在想代码会创建一个临时`ustring`的，其中每个易混淆的字符都将被相应的拉丁字符替换。

在实际程序中，我将测试 10x5000x10000 个字符串，每个字符串包含一个单词。

测试程序：

```
 std::locale::global(std::locale(""));

 std::cout.imbue(std::locale());

 Glib::ustring s1,s2;

 s1="TEST";

 s2="TΕST";

 s1.normalize(Glib::NORMALIZE_NFKD    );

 s2.normalize(Glib::NORMALIZE_NFKD   );

 std::cout<<"1->true, 0->false  (s1==s2) =>  "<<(s1==s2)<<"\n"; 
```

测试程序输出：

```
1->true, 0->false  (s1==s2) =>  0 
```

Ubuntu**语言环境**命令输出：

```
Ubuntu 12.04 64 bit>$ locale  
LANG=en_US.UTF-8
LANGUAGE=
LC_CTYPE="en_US.UTF-8"
LC_NUMERIC="en_US.UTF-8"
LC_TIME="en_US.UTF-8"
LC_COLLATE="en_US.UTF-8"
LC_MONETARY="en_US.UTF-8"
LC_MESSAGES="en_US.UTF-8"
LC_PAPER="en_US.UTF-8"
LC_NAME="en_US.UTF-8"
LC_ADDRESS="en_US.UTF-8"
LC_TELEPHONE="en_US.UTF-8"
LC_MEASUREMENT="en_US.UTF-8"
LC_IDENTIFICATION="en_US.UTF-8"
LC_ALL= 
```

**感谢您的时间！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T16:33:34.793

正如 user1675224 所说，您应该使用 ICU 而不是尝试推出自己的算法。

例如，要使用[`uspoof_areConfusable`](http://icu-project.org/apiref/icu4c/uspoof_8h.html#a30478be8a197dd7c3ac19a2a94ad8c6d)：

```
UErrorCode status = 0;
USpoofChecker *sc = uspoof_open(&status);
int result = uspoof_areConfusable(sc, s1.data(), s1.length(), s2.data(), s2.length(), &status);
uspoof_close(sc); 
```

如果您将大量字符串相互比较，您应该使用 将它们转换为它们的骨架`uspoof_getSkeleton`，并将其放入集合或散列集合中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T08:43:13.970

```
 std::string s1,s2;
    s1="TEst";
    s2="TΕst";
    std::cout<<" s1.length()="<<s1.length()<<"\n";
    std::cout<<" s2.length()="<<s2.length()<<"\n";

 UErrorCode status = U_ZERO_ERROR ;
 USpoofChecker *sc = uspoof_open(&status);
 char p[100];
 int result = uspoof_getSkeletonUTF8    (sc,USPOOF_ANY_CASE, s1.data(),s1.length(),p,100,&status);
 std::string skeleton1(p,result);
 std::cout<<" result in bytes="<<result<<" status="<<status<<"\n";
 std::cout<<" skeleton1="<<skeleton1<<"\n";
 std::cout<<"1->true, 0->false  (s1==skeleton1) =>  "<<(s1==skeleton1)<<"\n";
 //
 char p2[100];
 int result2 = uspoof_getSkeletonUTF8   (sc,USPOOF_ANY_CASE , s2.data(),s2.length(),p2,100,&status);
 std::string skeleton2(p2,result2);
 std::cout<<" result2 in bytes="<<result2<<" status="<<status<<"\n";
 std::cout<<" skeleton2="<<skeleton2<<"\n";
 std::cout<<"1->true, 0->false  (s2==skeleton2) =>  "<<(s2==skeleton2)<<"\n";
 std::cout<<"1->true, 0->false  (s1==s2) =>  "<<(s1==s2)<<"\n";
 std::cout<<"1->true, 0->false  (skeleton1==skeleton2) =>  "<<(skeleton1==skeleton2)<<"\n";
 //
 uspoof_close(sc); 
```

输出

```
 s1.length()=4
 s2.length()=5
 result in bytes=4 status=0
 skeleton1=TEst
 1->true, 0->false  (s1==skeleton1) =>  1
 result2 in bytes=4 status=0
 skeleton2=TEst
 1->true, 0->false  (s2==skeleton2) =>  0
 1->true, 0->false  (s1==s2) =>  0
 1->true, 0->false  (skeleton1==skeleton2) =>  1 
```

谢谢你。

# sql-server - 登录名和用户名之间的关系

> ID：12479924
> 
> 赞同：0
> 
> 时间：2012-09-18T15:14:21.473
> 
> 标签：sql-server

只是在谈论 SQL Server 身份验证，登录名是否与用户名相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:17:29.083

不，登录名和用户名不必相同 - 您可以在每个数据库中创建不同的用户名，所有这些都基于相同的服务器级登录。

```
USE master;
GO 

CREATE LOGIN foo WITH PASSWORD = 'bar', CHECK_POLICY = OFF;
GO

USE tempdb;
GO

CREATE USER blat FROM LOGIN [foo];
GO 
```

也就是说，你为什么要这样做？这完全令人困惑。

# dns - 如何将 VPS 链接到域名

> ID：12479929
> 
> 赞同：0
> 
> 时间：2012-09-18T15:14:32.693
> 
> 标签：dns, vps

我对此完全是新手。我最近完成了一门针对 OCJA 考试的 Java 编程课程。我以前从未编程过，除了作为用户之外，我没有太多的网络经验。我得到了一份工作实习，但我的想法太过分了。

我必须将 VPS 连接到我们正在处理的站点的域，但我不知道该怎么做。我想我使用了控制面板，但我在 Mac 上工作，而 cPanel 无法在它上面工作，我似乎也找不到可行的替代方案。如果这有什么不同，它是一个java小程序吗？

有什么建议么？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:22:34.850

Who is hosting your domain ? In that just point the A record to the VPS IP and wait ~24 hours for it to work.

# android - 是否可以重新发送 SMS_RECEIVED 广播？

> ID：12479930
> 
> 赞同：0
> 
> 时间：2012-09-18T15:14:39.077
> 
> 标签：android, sms, broadcast

我想重新发送收到的 SMS_RECEIVED 广播。我在这里找到了示例：[http](http://blog.dev001.net/post/14085892020/android-generate-incoming-sms-from-within-your-app) ://blog.dev001.net/post/14085892020/android-generate-incoming-sms-from-within-your-app并以此类推：

```
boolean received=false;

private BroadcastReceiver broadcastReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        if(intent.getAction().equals("android.provider.Telephony.SMS_RECEIVED")) {
            if(!received) {

                received=true;

                Bundle pudsBundle = intent.getExtras();
                Object[] pdus = (Object[]) pudsBundle.get("pdus");
                SmsMessage messages =SmsMessage.createFromPdu((byte[]) pdus[0]);

                abortBroadcast();

                if(/*my condition here*/) {
                    Intent update = new Intent();
                    update.setClassName( "com.android.mms", "com.android.mms.transaction.SmsReceiverService");
                    update.setAction("android.provider.Telephony.SMS_RECEIVED");
                    update.putExtra( "pdus" , new Object[] { pdus });
                    startService(update);
                }

            }
        }
    }
}; 
```

但是这段代码会导致 com.android.mms 崩溃（我在 LogCat 中看到“I/ActivityManager(71): Process com.android.mms (pid 904) has dead.”）：

```
threadid=8: thread exiting with uncaught exception (group=0x4001d800)
FATAL EXCEPTION: SmsReceiverService
java.lang.ClassCastException: [Ljava.lang.Object;
    at android.provider.Telephony$Sms$Intents.getMessagesFromIntent(Telephony.java:617)
    at com.android.mms.transaction.SmsReceiverService.handleSmsReceived(SmsReceiverService.java:299)
    at com.android.mms.transaction.SmsReceiverService.access$100(SmsReceiverService.java:67)
    at com.android.mms.transaction.SmsReceiverService$ServiceHandler.handleMessage(SmsReceiverService.java:172)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:123)
    at android.os.HandlerThread.run(HandlerThread.java:60) 
```

如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T16:00:46.827

如果您想使用相同的数据（相同的收到的短信），最好重用相同的意图并且不要托盘构建您自己的。只需使用 intent.putExtras(Bundle extras); 你能替换“update.putExtra(“pdus”, new Object[] { pdus });”吗？使用“update.putExtra（pudsBundle）”。试试看，让我知道它是否有效，我没有时间复制。

# ruby-on-rails - 通过删除受保护的参数来增加安全性？

> ID：12479934
> 
> 赞同：0
> 
> 时间：2012-09-18T15:14:55.003
> 
> 标签：ruby-on-rails, security

在 Rails 3 中，我们可以定义可访问的属性：

```
attr_accessible :rating, :review 
```

在这个模型中，有额外`user_id`的保护以防止伪造/黑客攻击。此值在控制器中分配：

```
@review.user_id = current_user.id 
```

如果我使用 Firebug 手动包含`user_id`，它将成为 的一部分`params[:review]`，但当然由于`user_id`未在 中定义`attr_accessible`，它不会被保存到数据库中。这种情况是相当安全的。

**问题 1**

我在**Rails 3 In Action**一书中读到，Yehuda Katz 包含`.delete`了在执行进一步操作之前删除未经授权的参数的方法：`params[:review].delete(:user_id)`. 我是否应该也包含此内容以进一步保护我的应用程序，还是忽略此步骤？

**问题2**

如果我应该包含上面的方法，我想要将`.delete_all_except`它剥离到参数中允许的属性。我怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:24:26.503

如果启用，Rails 3.2 将在向模型发送额外的质量分配参数时出现异常

配置/应用程序.rb

```
config.active_record.whitelist_attributes = true 
```

与其删除你不想要的参数，我建议只接受你想要的参数：

```
@user.update_attributes params[:user].slice(:rating, :review) 
```

这只会返回您允许的用户参数。

注意：在 Rails 4（即将推出）中，这种行为是使用名为[strong-parameters](https://github.com/rails/strong_parameters)的 DSL 实现的。你可以在 Rails 3.2 中安装这个 gem 来实现：

```
@user.update_attributes params.require(:user).permit(:rating, :review) 
```

# objective-c - 延续类中的获取属性属性与主类不匹配

> ID：12479944
> 
> 赞同：2
> 
> 时间：2012-09-18T15:15:36.627
> 
> 标签：objective-c, ios, readonly

在 myClass.h 中，我这样做：

```
typedef enum {
    SignUpLabel,
    SignUpButton,
    LogInFieldsTwitterButton,
    LogInFieldsFacebookButton,
    LogInWithFaceBookTiwtterLabel,
} logInFields;

@property (nonatomic, readonly, assign) logInFields fields;

@end 
```

我想`logInField`对公共只读，但它可以私下读/写。因此，我这样做：

```
@interface myClass ()
@property (readwrite, assign ) logInFields fields;

@end 
```

但是，我收到警告：

```
Property attribute in continuation class does not match the primary class 
```

有人可以告诉我我在这里缺少什么以及如何使编译器静音吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T16:22:30.250

您是否尝试在 .m 中添加“非原子”？

# java - 使用适用于所有设备的 Camera API 制作 Android 相机应用程序

> ID：12479953
> 
> 赞同：6
> 
> 时间：2012-09-18T15:16:13.583
> 
> 标签：java, android, camera

我知道，这个问题被问过很多次，但我认为没有解决方案。我正在开发应用程序，该应用程序应针对所有具有 android 系统和后置摄像头的设备。问题是我只能在两台设备上测试应用程序，并且必须确保它可以在所有设备上运行。**我认为唯一合理的解决方案是找到可以在几乎所有设备上运行的相机 api 代码示例。有没有人可以提供这样的来源......但是来源......真的在maaaaany（ALL）设备上测试过？**我的头发都掉光了……而且……我想我正在失去理智……这完全是因为我发布了应用程序（仅用于我公司的测试），该应用程序仅在两个上进行了测试设备，并且以应该可以工作的方式使用相机 api，但似乎有一些手机，例如 HTC 渴望高清或 HTC Evo 3d（带 3d 相机），应用程序只是崩溃（因为 fu..ing 相机）或冻结（也因为 fu..ing 相机）。**如果有人有真正测试过的相机 api 源（定期拍摄没有用户 gui 交互的照片），请善待，如果可以，请发布源或将我重定向到适当的位置**。

嗯，也许这个问题听起来应该是这样的：“技术上是否可以在所有设备上使用相机 API？”

也许我会描述一下我目前是如何使用 api 的。

1）初始化凸轮：

```
public void initCam()
{       
    LoggingFacility.debug("Attempting to initialize camera",this);
    LoggingFacility.debug("Preview is enabled:"+isPreview,this);
    try {
        if (camera==null) 
        {               
            camera = Camera.open();
            camera.setPreviewDisplay(mHolder);

            if (camera!=null)
            {
                Camera.Parameters parameters = camera.getParameters();              
                List<Size> sizes = parameters.getSupportedPictureSizes();
                if (sizes!=null)
                {
                    Size min = sizes.get(0);
                    for (Size size : sizes)         
                        if (size.width<min.width) min = size;   
                        {
                            parameters.setPictureSize(min.width, min.height);
                        }
                }           

                camera.setParameters(parameters);       
                setDisplayOrientation(90);
            }
        }            
        startPreview(aps);
    } catch (Throwable e){
        if (exceptionsCallback!=null)
            exceptionsCallback.onException(e);          
    } 
} 
```

2) 开始预览：

```
private void startPreview(AfterPreviewStarted after)
{
    try {
        if (!isPreview)
        {
            LoggingFacility.debug("Starting preview",this);
            //camera.stopPreview();             
            camera.startPreview();
            isPreview = true;
            LoggingFacility.debug("Preview is enabled:"+isPreview,this);                
        }
        if (after!=null) after.doAfter();
    }catch(Throwable e)
    {
        if (exceptionsCallback!=null)
            exceptionsCallback.onException(e);  
    }
} 
```

3) 拍照：

```
public void takePicture(final PictureCallback callback)
{
    LoggingFacility.debug("Attempting to take a picture",this);
    if (camera!=null)
    {       
        if (isPreview)
        {
            try
            {
                LoggingFacility.debug("preview is enabled jut before taking picture",this);
                //AudioManager mgr = (AudioManager)ctx.getSystemService(Context.AUDIO_SERVICE);
                //mgr.setStreamMute(AudioManager.STREAM_SYSTEM, true);      
                LoggingFacility.debug("Taking picture... preview will be stopped...",this);
    isPreview = false;                  
    camera.takePicture(null, new PictureCallback(){
        public void onPictureTaken(byte[] arg0, Camera arg1)
        {
            //LoggingFacility.debug("Picture has been taken - 1t callback",CameraPreview.this);
        }               
    }, callback);

                //mgr.setStreamMute(AudioManager.STREAM_SYSTEM, false);          
            } catch (Throwable e){
                if (exceptionsCallback!=null)
                    exceptionsCallback.onException(e);          
            }
        }
    } 
```

4) 完成后或表面处理后释放相机。

```
public void releaseCam()
{
    LoggingFacility.debug("Attempting to release camera",this);
    if (camera!=null)
    {
        isTakingPictures = false;
        camera.stopPreview();
        isPreview = false;
        camera.release();
        camera = null;          
        LoggingFacility.debug("A camera connection has been released...",this);
    }
} 
```

在回调方法的第三个代码片段中，我再次调用 startPreview，因为拍照后预览被禁用，并且某些智能手机需要开始预览才能制作图片。以上所有方法都是扩展**SurfaceView** 并实现**SurfaceHolder.Callback**的类的一部分，并且是活动的一部分。

SurfaceHolder.Callback 实现如下：

```
public void surfaceCreated(SurfaceHolder holder) {  
    initCam();

}

public void surfaceDestroyed(SurfaceHolder holder) {         
    releaseCam(); 
}

public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {

} 
```

类的构造函数

```
CameraPreview(Context context) {
    super(context);
    this.ctx = context;     
    mHolder = getHolder();
    mHolder.addCallback(this);
    mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
} 
```

我也在考虑另一种方法 - 克服拍照，而不是注册 onPreviewFrame 回调，例如在这个回调中检查标志是否已请求图片，如果是 - 将图像转换为位图并在进一步处理中使用它。我正在尝试这种方法，但后来遇到了另一个问题——即使我注册了空回调，gui 的响应也会慢得多。

对于像我一样在使用 android camera api 时遇到问题的每个人，请参考[此链接](https://github.com/commonsguy/cw-advandroid/tree/master/Camera/Picture)。**此示例中的代码似乎适用于大多数智能手机**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:31:04.670

```
final int PICTURE_TAKEN = 1;

Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
intent.putExtra(MediaStore.EXTRA_VIDEO_QUALITY, 1);
intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(new File(filename)));
startActivityForResult(intent, PICTURE_TAKEN); 
```

这对我有用，到目前为止还没有投诉。

# java - 带有 jlist 的 keylistener

> ID：12479956
> 
> 赞同：1
> 
> 时间：2012-09-18T15:16:29.990
> 
> 标签：java, swing, jlist, keylistener

当按下 jList 中键盘上的任意键时，希望我的框架中的 jtextField 出现，这就是我所做的：

```
public class test extends javax.swing.JFrame {

 public test ()  {

 jTextField3.setVisible(false);
         .
         .
         .

private void jList1KeyPressed(java.awt.event.KeyEvent evt) {

    jTextField3.setVisible(true);
    System.out.print("Pressed");
  }
 }
} 
```

按任意键时，它会打印“Pressed”，但没有出现文本字段，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:28:48.930

尝试在您的 s 实例上调用`revalidate()`/ 。`repaint()``JFrame`

# hibernate - 当它在 Hibernate 中设置为 Lazy 时，RequestFactory 急切地获取一个集合

> ID：12479959
> 
> 赞同：1
> 
> 时间：2012-09-18T15:16:42.817
> 
> 标签：hibernate, gwt, lazy-loading, requestfactory

在这段代码中，我使用 GWT RequestFactory 通过用户名和密码获取用户

```
 userContextProvider.get().getUser(userName, password).with(extraData).
    fire(new Receiver<User>() {
        @Override
        public void onSuccess (User user) {
        //Do something  
        @Override
        public void onFailure(ServerFailure error) {
          //Error
        }
    }); 
```

一个用户可以有一个或多个组，所以通常情况下，在我会拥有的额外数据中

```
String [] extraData = {groups}; 
```

在我的 DAO 中，我像这样获取用户

```
 Criteria c = session.createCriteria(User.class);
   c.add(Restrictions.eq("user", username));
   c.add(Restrictions.eq("password", password));            
   utilisateur =  (Utilisateur) c.uniqueResult(); 
```

并且在 User 模型中，组集合设置为惰性

```
@ManyToMany(fetch = FetchType.LAZY, mappedBy = "users")
    public List<Group> getGroups() {
        return this.groups;
    } 
```

但是，在 Hibernate Log 中，我看到两个查询，一个用于用户（没关系），另一个用于 groupe

我的问题是：`with`在 RequestFactory 中覆盖 Hibernate 的延迟加载是否正常？以及如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:51:09.233

想一想正在发生的事情。

您在一个请求中请求用户实体及其组。因此，服务器准备好用户和组以将它们发送回您的 GWT 客户端应用程序。

如果您想在客户端延迟获取，请询问用户，然后在需要时询问其组，作为单独的请求（使用其单独的`RequestContext`实例`Receiver`，和调用`fire()`）

# hibernate - 完整的 Hibernate 插件仅适用于 Hibernate3。无论如何与Hibernate4？

> ID：12479960
> 
> 赞同：0
> 
> 时间：2012-09-18T15:16:45.403
> 
> 标签：hibernate, jakarta-ee, struts2, struts2-s2hibernate

为了学习目的，我一直在为我的 CRUD 演示项目使用***struts2-fullhibernatecore-plugin-2.2.2-GA 。***以下是我得到的错误，并且不同的休眠依赖项试图使其工作。见下文

**错误**

```
java.lang.NoSuchMethodError: org.hibernate.SessionFactory.openSession()Lorg/hibernate/classic/Session;
    com.googlecode.s2hibernate.struts2.plugin.util.HibernateSessionFactory.createAndTestSessionFactory(HibernateSessionFactory.java:284)
    com.googlecode.s2hibernate.struts2.plugin.util.HibernateSessionFactory.rebuildSessionFactory(HibernateSessionFactory.java:227)
    com.googlecode.s2hibernate.struts2.plugin.util.HibernateSessionFactory.getNewSession(HibernateSessionFactory.java:155) 
```

*我从这个线程的答案中了解到* [点击这里](https://stackoverflow.com/questions/8799121/java-lang-nosuchmethoderror-org-hibernate-sessionfactory-opensessionlorg-hibe)

比我开始不同的 maven 依赖来检查使用插件的休眠版本并发现

**不适用于以下版本**

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-core</artifactId>
    <version>4.1.6.Final</version>
</dependency> 
```

**工作到这个版本**

```
 <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>3.6.10.Final</version>
        </dependency> 
```

**问题：**显然不想使用 Hibernate3 那么有没有办法可以将最新的 hibernate4+ 与 struts2-fullhibernatecore-plugin-2.2.2-GA 一起使用？

**问题：** struts2中hibernate使用最广泛的DI是什么。如果上面的插件不起作用，我应该选择***Spring 还是 google juice ？******除了viewpattern***之外，没有看到任何其他可行的管理休眠会话的解决方案，但是说它的反模式并且有很多缺点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T10:36:01.827

使用这个配置

```
<plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>hibernate3-maven-plugin</artifactId>
                <version>2.2</version>
                <configuration>
                    <components>
                        <component>
                            <name>hbm2ddl</name>
                            <implementation>jpaconfiguration</implementation>
                        </component>
                    </components>
                    <componentProperties>
                        <outputfilename>schema.ddl</outputfilename>
                        <create>true</create>
                        <export>false</export>
                        <format>true</format>
                        <drop>true</drop>
                        <jdk5>true</jdk5>
                        <propertyfile>target/test-classes/jdbc.properties</propertyfile>
                        <skip>${skipTests}</skip>
                    </componentProperties>
                </configuration>
                <!--<executions>-->
                <!--<execution>-->
                <!--<phase>process-test-resources</phase>-->
                <!--<goals>-->
                <!--<goal>hbm2ddl</goal>-->
                <!--</goals>-->
                <!--</execution>-->
                <!--</executions>-->
                <dependencies>
                    <dependency>
                        <groupId>org.hibernate</groupId>
                        <artifactId>hibernate-entitymanager</artifactId>
                        <version>${hibernate.maven.plugin.version}</version>
                        <exclusions>
                            <exclusion>
                                <groupId>cglib</groupId>
                                <artifactId>cglib</artifactId>
                            </exclusion>
                            <exclusion>
                                <groupId>commons-logging</groupId>
                                <artifactId>commons-logging</artifactId>
                            </exclusion>
                        </exclusions>
                    </dependency>
                    <dependency>
                        <groupId>org.hibernate</groupId>
                        <artifactId>hibernate-core</artifactId>
                        <version>${hibernate.maven.plugin.version}</version>
                        <exclusions>
                            <exclusion>
                                <groupId>cglib</groupId>
                                <artifactId>cglib</artifactId>
                            </exclusion>
                            <exclusion>
                                <groupId>commons-logging</groupId>
                                <artifactId>commons-logging</artifactId>
                            </exclusion>
                        </exclusions>
                    </dependency>
                    <dependency>
                        <groupId>org.hibernate</groupId>
                        <artifactId>hibernate-validator</artifactId>
                        <version>4.2.0.Final</version>
                    </dependency>
                    <dependency>
                        <groupId>${jdbc.groupId}</groupId>
                        <artifactId>${jdbc.artifactId}</artifactId>
                        <version>${jdbc.version}</version>
                    </dependency>
                </dependencies>
            </plugin> 
```

并添加`<hibernate.maven.plugin.version>3.6.10.Final</hibernate.maven.plugin.version>`到您的 pom 属性中。

# asp.net - 如何在中继器内的超链接控件上设置下载计数器？网

> ID：12479964
> 
> 赞同：1
> 
> 时间：2012-09-18T15:17:11.007
> 
> 标签：asp.net, vb.net, hyperlink, repeater, asprepeater

我在 pdf 列表的转发器控件中有一个超链接。我想在每次点击每个超链接时设置一个下载计数器。FileName 必须是一个参数。我的代码基本上如下所示。还有一些代码调用存储过程并将其绑定到 page_load 上的转发器。

```
<asp:Repeater ID="rptPDF" runat="server">
<ItemTemplate>
<div class="repeaterResources">
<b><%# Eval("Name") %></b><br />
    <b>Description</b> <%# Eval("Description") %><br />
    <asp:HyperLink ID="HyperLink2" runat="server" class="downloadLink" NavigateUrl='<%# "~/PDF/" & Eval("Filename") %>' Target="_blank">Download</asp:HyperLink><br /><br />                
</div>
</ItemTemplate>
</asp:Repeater> 
```

神秘的一点是如何从这里获取按钮点击事件。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:29:56.650

您可以使用 OnCommand 事件并使用以下值设置 CommandArgument 属性

`<%# Eval('myvalue') %>`.

MSDN 有一个减去中继器的示例：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.oncommand.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.oncommand.aspx)

样本：

```
<asp:Repeater ID="repeater" runat="server">
<ItemTemplate>
<asp:LinkButton runat="server" ID="button1" OnCommand="button1_command" CommandArgument='<%# Eval("myvalue") %>' />
</ItemTemplate>
</asp:Repeater> 
```

# css - 将 div 定位在另一个下方

> ID：12479967
> 
> 赞同：1
> 
> 时间：2012-09-18T15:17:20.463
> 
> 标签：css, html, web

我有一个包含宽度为 100% 的图像的 div，我想将所有其他内容（将进入内容 div 的所有内容）放在它下面。这是我当前的代码：

98.214.131.200/index.php

```
<!DOCTYPE html>
<html>
<head>
    <link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<ul id="nav">
    <li><a href="http://tri-peoria.org">Home</a></li>
    <li><a href="/forum">Forum</a></li>
    <li><a href="/join">Join</a></li>
    <li><a href="/members">Members</a></li>
    <li><a href="/events">Events</a></li>
    <li><a href="/training">Training</a></li>
    <li><a href="https://www.facebook.com/groups/tripeoria/">Facebook</a></li>
    <ab><a href="/about">Peoria Triathlon Club</a></ab>
</ul>
<ul id="quote">
<p>"random quote"</p>
</ul>
<div id="bg"><img src="bg.jpg" width="100%" alt=""</img></div>
<div id="content">
<p>content</p>
</div>
</body>
</html> 
```

98.214.131.200/style.css

```
body {
    background-color: #000000;
    color: #C1C1C1;
    font-family: Arial,Verdana,Helvetica,sans-serif;
    margin: 0;
}
#bg {
    position:absolute;
    top:0;
    left:0;
    width:100%;
    }
#content {
    position:relative;
    color: #FFF;
    }
#nav {
    z-index:1;
    position:relative;
    width: 100%;
    float: left;
    margin: 0 0 3em 0;
    padding: 0;
    list-style: none;
    background-color: #f2f2f2;
    border-bottom: 1px solid #ccc; 
    border-top: 1px solid #ccc; }
#nav li {
    float: left; }
#nav li a {
    display: block;
    padding: 8px 15px;
    text-decoration: none;
    font-weight: bold;
    color: #c00;
    border-right: 1px solid #ccc; }
#nav li a:hover {
    color: #c00;
    background-color: #fff; }
#nav ab {
    float: right; }
#nav ab a {
    display: block;
    padding: 8px 15px;
    text-decoration: none;
    font-weight: bold;
    color: #c00;
    border-right: 1px solid #ccc; }
#nav ab a:hover {
    color: #c00;
    background-color: #fff; }
#quote{
    z-index:1;
    position:relative;
}
#quote p {
    color: #000;
    width: 350px;
} 
```

你可以访问 http://98.214.131.200 查看我当前的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:22:02.167

You should embed your #nav and #quote elements into a `div` or `header` tag and position it absolutely. Then you can position you image container relatively, which will push down subsequent content.

HTML:

```
<div id="header">
    <ul id="nav"></ul>
    <ul id="quote></ul>
</div> 
```

CSS:

```
div#header{
    position: absolute;
}
#bg{
    position: relative;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T16:04:21.797

`<p>`从 中取出，`<ul>`并将其（与 一起`#content` `<p>`）放在 中`#bg`。然后重新审视你的定位声明......

绝对定位元素依赖于具有相对定位的父容器。因此，`#bg`应该是`position:relative`while `#quote` `position:absolute`。通过使用`#bg`作为引用和内容的父级 - 您可以保留与您尝试关注的那个元素相关的所有内容。

构建了一个小提琴（使用您的 IP 地址获取图像）。 [http://jsfiddle.net/bqXc6/](http://jsfiddle.net/bqXc6/)

这是要点：

```
#bg { position:relative; width:100%; }
#quote {
    position:absolute;
    color: #000;
    top: 20px;
    width: 350px;
    margin-left:20px;
}
#content { color:#FFF; margin-left:20px; } 
```

请注意：在小提琴中，我使用隐藏在父级上的溢出（只是为了推开高度/宽度）清理了您的“float：left”导航元素的代码，因此它的背景颜色可见。​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:25:31.127

要放置背景图像，请使用以下 css 属性

背景图像：url（'yourimage.jpg'）；

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-18T15:20:24.403

您可以使用 display: block css 属性使其显示在自己的行上。只需将该属性添加到 CSS 样式表中的 #bg 即可。

# python - 使用单个元素解压缩元组，如果元组为 None，则返回 None

> ID：12479968
> 
> 赞同：3
> 
> 时间：2012-09-18T15:17:22.610
> 
> 标签：python, python-2.7

使用 python 2.7，我有以下代码：

```
if result != None:
    (data,) = result
    return data

return None 
```

该`result`变量是从只返回一个值的 sqlite3 查询返回的。如果查询返回结果，我想解包并返回数据，否则我想返回None。上面的代码似乎过于冗长，而且根本不是 Pythonic。有没有更好的办法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T15:18:34.537

你可以使用一个`if` `else`条件：

```
return result[0] if result is not None else None 
```

或将其简化为：

```
return result[0] if result else None 
```

如果您不关心`result`可能是其他一些[false-y 值](http://docs.python.org/reference/expressions.html#boolean-operations)，例如空元组等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T15:22:22.423

Assuming that you'll only get either non-empty tuple or None, the simplest way:

```
return result and result[0] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T15:24:56.030

一种方法可能是：

```
if result is not None:
    return result[0]
return None 
```

还有一种更紧凑的方法可以做到这一点：

```
return (result or [None])[0] 
```

但第一个更清楚。

**请**避免在末尾使用分号（不是 C 代码），阅读 python 文档会对您有所帮助。这是一段美好的时光。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T15:27:16.410

I suppose no answer is complete without `try/except`:

```
try:
   return result[0]
except TypeError,IndexError:
   return None 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T15:41:22.233

除了你留下的和应该被替换`;`的事实之外，我对你的代码没有任何问题。`result != None``result is not None`

这很简单，很容易理解，如果您的请求返回 2 个或更多元素，它不会默默地让您失败：它会引发异常，而不是像迄今为止的所有解决方案一样默默地返回第一个元素。

# shell - crontab 只执行第一行

> ID：12479973
> 
> 赞同：5
> 
> 时间：2012-09-18T15:17:31.800
> 
> 标签：shell, cron, centos, crontab

我正在尝试在 centos/whm 下的 VPS 上设置几个 cron 作业。我已添加到 /var/spool/cron/root 以下行：

```
*/5 * * * * find /some-dir/* \( ! -iname ".ht*" \) -delete
*/10 * * * * find /some-other-dir/* \( ! -iname ".ht*" \) -delete 
```

但只执行了第一行（for /some-dir/）。如果我交换行 - /some-other-dir/ 执行，/some-dir/ - 不是。我试图在每行的末尾加上分号，放置空格、制表符、更改文件编码——什么都没有。

如何让 cron 处理这两个任务？

这是 /var/log/cron 输出：

```
Sep 18 11:05:01 host crond[3302]: (root) CMD (find /some-dir/* \( ! -iname ".ht*" \) -delete)
Sep 18 11:10:01 host crond[3303]: (root) RELOAD (/var/spool/cron/root) 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T18:09:49.553

似乎 cron 需要一个空行和 crontab 的结尾。我不小心留下了这样的台词和中提琴！两个任务都执行了。

# ruby-on-rails-3 - Rails 查询.order 麻烦

> ID：12479974
> 
> 赞同：1
> 
> 时间：2012-09-18T15:17:42.240
> 
> 标签：ruby-on-rails-3

查询从来都不是我的强项。我正在尝试修改我当前的查询以允许按 ASC/DESC 排序。

为此，我有一个模型 Activity，它扩展为 Share、Scan、Review、Redeem（可通过 Activity.type 访问）。

我目前的查询是

```
results=Activity.select("*, count(*) as count").where(created_at: date_from..date_to).group(:user_id).having("count > 0").count("type='#{val}', count(*) #{desc/asc}") 
```

这给了我类似的东西：

```
{2=>1, 3=>1, 1=>305, 111=>99, 110=>98, 109=>97, 108=>96, 107=>95, 106=>94, 105=>93,... 
```

这里的问题是，前 2 个有`(type=#{val}).count`= 0。这意味着它们下面有 Activity 记录，但它们的类型不同。无论如何要修改查询，以便这些 .count=0 实际上尊重排序？

否则，作为一种解决方法，我可以手动将所有这些添加到数组中，然后最后评估它们。

编辑：更新到我当前的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:37:20.923

你试过这个：

```
results=Activity.select("*, count(*) as count")
.where(created_at: date_from..date_to).group(:user_id, :type)
.having("count > 0").order("type ASC, count(*) DESC") 
```

# visual-studio - EF Power Tools Beta 2 Generate Views 给出错误：“在所选文件中找不到从 dbcontext 派生的可构造类型”

> ID：12479975
> 
> 赞同：2
> 
> 时间：2012-09-18T15:17:46.923
> 
> 标签：visual-studio, entity-framework

为包含 1 个类的文件运行生成视图时出现此错误：

```
public class MyDbContext : DbContext {
    public MyDbContext() { ... }

    public MyDbContext(string connectionString) { ... }

    // more constructors

    protected override void OnModelCreating(DbModelBuilder modelBuilder) { ... }
} 
```

我正在使用 EF 4.3.1.0、VS 10 和 Entity Framework Power Tools Beta 2 0.6.0.0。这是我第一次安装这些工具，所以我认为不是[这里](http://blogs.msdn.com/b/adonet/archive/2012/04/09/ef-power-tools-beta-2-available.aspx)提到的问题。

如何解决此问题并为我的 DbContext 生成预编译视图？

# c#-4.0 - 从 Windows 7 服务播放 wav/mp3

> ID：12479982
> 
> 赞同：4
> 
> 时间：2012-09-18T15:18:01.813
> 
> 标签：c#-4.0, windows-7, windows-services, naudio

我需要在 Windows 7/2008 中从服务中播放声音文件（wav 或 mp3 都可以）......我们在 WinXP 中所做的方式不再有效。我已经按照这个问题[Play wave file from a Windows Service (C#)](https://stackoverflow.com/questions/2143439/play-wave-file-from-a-windows-service-c/12431988#12431988) 进行了各种组合，但没有成功。声音通过调试器播放良好，但是一旦我将它作为服务安装它就不会播放，并且事件日志证明正在拨打电话。我还关注了[http://bresleveloper.blogspot.co.il/2012/06/c-service-play-sound-with-naudio.html](http://bresleveloper.blogspot.co.il/2012/06/c-service-play-sound-with-naudio.html)链接，结果相同。

代码片段如下。它是 VS 2010、.Net 4.0、NAudio 1.5.4.0 的 C# 服务。我正在使用 InstallUtil 安装/删除服务。

WRT代码，我每次都注释掉Wav或MP3的东西和一种方法......他们都成功地播放了声音。

```
 static class Program
    {
        [DllImport("kernel32.dll")]
        public static extern Boolean AllocConsole();

        static void Main(string[] args)
        {
            m_eventLog = new EventLog();
            m_eventLog.Source = "EventLoggerSource";

            if(args.Length > 0 && args[0].ToLower() == "/console")
            {
                AllocConsole();
                EventLoggerApp app = new EventLoggerApp();
                app.Start();

                m_eventLog.WriteEntry("INFO (Calling Player)");
                string fileFullPath=@"c:\aaasound\bunny_troubles.wav",fileFullPath2=@"c:\aaasound\dreams.mp3";

                // Wav file
                IWavePlayer wavePlayer=new WaveOutEvent();  // Method 1
                IWavePlayer wavePlayer=new WasapiOut(NAudio.CoreAudioApi.AudioClientShareMode.Shared,false,100); // Method 2   
                AudioFileReader audioFile=new AudioFileReader(fileFullPath);
                audioFile.Volume = (float)1.0;
                wavePlayer.Init(audioFile);

                // MP3 file
                IWavePlayer wavePlayer=new WasapiOut(NAudio.CoreAudioApi.AudioClientShareMode.Shared,true,100); // Method 1- EventSync/not both work
                IWavePlayer wavePlayer=new WasapiOut(NAudio.CoreAudioApi.AudioClientShareMode.Exclusive,false,100); // Method 2- EventSync must be false or throws an exception
                WaveStream mp3Reader = new Mp3FileReader(fileFullPath2);
                WaveChannel32 inputStream=new WaveChannel32(mp3Reader);
                WaveStream wavStream=new WaveChannel32(inputStream);
                wavePlayer.Init(wavStream);

                //this.wavePlayer.PlaybackStopped += new EventHandler(wavePlayer_PlaybackStopped);
                wavePlayer.Play();
                while(wavePlayer.PlaybackState == PlaybackState.Playing)
                {
                    Thread.Sleep(100);
                } 
```

# php - 找不到 mcrypt => 调用未定义的函数 Laravel\mcrypt_create_iv()

> ID：12479983
> 
> 赞同：48
> 
> 时间：2012-09-18T15:18:02.663
> 
> 标签：php, osx-mountain-lion, mcrypt, laravel

尝试设置 Laravel 并不断遇到此错误。我通过 brew 安装了 mcrypt，它位于 /usr/local/Cellar。有什么想法吗？.. 它也没有出现在终端命令 php -m 中，如果这很重要的话。我正在使用 macs 本机 Web 服务器运行 Mountaion Lion。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-01-08T23:14:59.390

Ubuntu 或任何基于 Debian 的 Linux 用户可以使用以下命令安装所需的软件包`apt-get`：

```
sudo apt-get install php5-mcrypt 
```

记得之后重启网络服务器：

```
sudo service apache2 restart 
```

如果仍然不起作用，请尝试将配置文件链接到 Web 服务器的相应配置文件夹。感谢[dave1010](https://stackoverflow.com/users/315435/dave1010)在评论中的提示。

```
sudo ln -s /etc/php5/conf.d/mcrypt.ini /etc/php5/apache2/conf.d/   # for Apache
sudo ln -s /etc/php5/conf.d/mcrypt.ini /etc/php5/cli/conf.d/       # for CLI 
```

再次，重新启动 Web 服务器：

```
sudo service apache2 restart 
```

也许，如果还没有工作，您还需要@RahulPrasad 显示的行，带有`php5enmod mcrypt`.

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-09-18T15:22:11.143

您还需要在`php.ini`文件中启用它，并可能重新启动 Apache。

在`php.ini`您将找到并从中`;mcrypt.so`删除。`;`

或者，如果它不在那里，只需添加`mcrypt.so`某个地方。

自 PHP 7.0.0 起，盐选项已被弃用。现在首选简单地使用默认生成的盐。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2014-07-13T17:54:21.080

尝试`sudo php5enmod mcrypt && sudo service apache2 restart`

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2013-05-22T08:29:38.900

`mcrypt`当您真正需要`php56-mcrypt`php 模块时，您已经安装了。

你在你的问题中说你可以看到`mcrypt`安装在`/usr/local/Cellar`并且你正在使用`OSX`. [因此，使用Homebrew](http://brew.sh)在 OSX 上安装 mcrypt PHP 模块的最简单方法是：

```
// assuming you have php56
brew install php56-mcrypt 
```

如果 homebrew 找不到正确的包，您可能需要[点击 GitHub 上的 PHP 存储库](https://github.com/Homebrew/homebrew-php#installation)：

```
brew tap homebrew/dupes
brew tap homebrew/versions
brew tap homebrew/homebrew-php 
```

现在，当您发出命令时`brew search mcrypt`，您应该会看到如下内容：

```
libtomcrypt   mcrypt   php53-mcrypt   php54-mcrypt   php55-mcrypt   php56-mcrypt 
```

其他几位海报提到需要编辑您的`php.ini`文件。这将是不必要的，因为自制软件会为您激活模块。它将配置文件放在`/usr/local/etc/php/5.6/conf.d/ext-mcrypt.ini`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-29T21:53:36.037

您没有安装 mcrypt PHP 扩展。

对于 Mac，我按照以下说明操作： [mcrypt on Mac 10.7 or 10.8](http://www.coolestguyplanettech.com/how-to-install-mcrypt-for-php-on-mac-osx-lion-10-7-development-server/)。

它们看起来很多，但事实并非如此，它很容易遵循它的工作原理！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-18T15:55:18.147

您可能已经安装了 mycrypt 但没有安装/启用 php_mcrypt 模块。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-28T18:18:28.463

只是给最近升级到 PHP 7 的人的注意事项 - MCRYPT 库已被[弃用](http://php.net/manual/en/migration71.deprecated.php#migration71.deprecated.ext-mcrypt)。如果您升级到 PHP 7 并且现在看到此错误，这就是原因。您应该切换到替代库，[此线程](https://stackoverflow.com/questions/41272257/php-7-mcrypt-deprecated-need-alternative#41272680)中提到了一些替代方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-22T11:20:48.990

转到 php 安装中的 CLI 文件夹，并在其中找到 php.ini 并启用 mcrypt。终端有时会使用另一个 php.ini，它通常位于 CLI 文件夹中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-20T20:19:34.327

`brew update`我用 Homebrew 安装了 php 和 mcrypt，但做了几次后我仍然遇到这个错误。我认为我的设置随着时间的推移变得有点无聊。

事实证明，我的 php 是从*/private/etc/php.ini*配置的，**而不是** Homebrew 推荐的*/usr/local/etc/php/5.4/php.ini 。*Mcrypt 甚至没有包含在*/usr/local/etc/php/5.4/ext-mcrypt.ini*中，考虑到这对我来说没有多大意义`php -i`：

```
Configuration File (php.ini) Path => /usr/local/etc/php/5.4
Loaded Configuration File => /usr/local/etc/php/5.4/php.ini
Scan this dir for additional .ini files => /usr/local/etc/php/5.4/conf.d
Additional .ini files parsed => /usr/local/etc/php/5.4/conf.d/ext-mcrypt.ini 
```

**我的解决方案：**

1.  `/private/etc/php.ini`以超级用户身份编辑
2.  添加`extension="/usr/local/Cellar/php54-mcrypt/5.4.28/mcrypt.so"`并保存
3.  重启Apache`sudo apachectl restart`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-02-05T06:38:03.973

这最终对我有用：

```
brew reinstall --with-homebrew-curl --with-httpd php56
brew reinstall --build-from-source php56-mcrypt 
```

我也必须这样做，`sudo chmod 777 /usr/local/etc/php/5.6/conf.d`因为当第二个`brew reinstall`尝试将其添加`ext-mcrypt.ini`到该目录时出现错误。

# java - HibernateFilter.doFilter ServletException？

> ID：12479984
> 
> 赞同：0
> 
> 时间：2012-09-18T15:18:14.957
> 
> 标签：java, apache, servlets, tomcat6, servletexception

我几乎没有设置服务器的零经验，但目前我的工作是设置一个（不要问为什么）。这是一个 apache-tomcat6 服务器。

我一步一步地遵循了一些说明，当需要测试一切是否正常时，我得到了以下信息：

![错误！](../Images/a7bbae35687bc202fb7dbfe0f3f0f782.png)

我知道这有点像在黑暗中拍摄，但有人知道我能做些什么来解决这个问题吗？

如果有任何进一步的信息可以提供帮助，请告诉我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:20:38.243

你`CertificateAuthInvalidCertException`在你的类路径中缺少类。将其添加到 tomcat / 应用程序

# django - Django鼻子只运行项目测试

> ID：12479985
> 
> 赞同：4
> 
> 时间：2012-09-18T15:18:28.887
> 
> 标签：django, code-coverage, nose, buildout

我在 buildout.cfg中添加了`nose`, `django-nose`,并运行了 buildout。此外，我将and添加到了我的 settings.py 中。在最后一步中，我创建了一个并将其包含在. 到目前为止有效。`nose-exclude``coverage``TEST_RUNNER``NOSE_ARGS``exclude_dirs.txt``NOSE_ARGS`

最后我跑去`bin/django test`运行我的项目的测试。我发现里面`INSTALLED_APP`的每个应用程序都在运行，甚至 django 核心模型的一部分也在运行。如何仅在没有外部软件包的情况下将此限制为我的项目？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T00:14:29.950

在您的 settings.py 文件中，您可以执行以下操作：

```
TEST_RUNNER = 'django_nose.NoseTestSuiteRunner'
NOSE_ARGS = [
'--cover-package=your_app_name',
'--with-coverage', 
] 
```

假设你已经添加了所有的 reqd。应用程序到 settings.py 文件中`INSTALLED_APPS`。这将解决问题！

# sql - 我想从受限用户帐户创建一个表并授予对该帐户的访问权限

> ID：12479986
> 
> 赞同：0
> 
> 时间：2012-09-18T15:18:28.707
> 
> 标签：sql, sql-server, tsql

这甚至可能吗？此用户帐户将有权访问数据库中的一些 SP 和 Fns，其中 1 个 SP 创建一个新表。创建表时，我希望 GRANT SELECT 给该表的特定用户。这可以做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:16:18.823

如果您的存储过程创建了表，为什么不将授权选择语句添加到该过程中呢？

# c# - 拖放复制文件

> ID：12479991
> 
> 赞同：0
> 
> 时间：2012-09-18T15:18:46.367
> 
> 标签：c#, .net, windows, winforms, forms

我可能做了一些有点愚蠢的事情，但看不到它是什么！

```
string pegasusKey = @"HKEY_LOCAL_MACHINE\SOFTWARE\Pegasus\";
        string opera2ServerPath = @"Server VFP\";
        string opera3ServerPath = @"O3 Client VFP\";
        string opera2InstallationPath = null;
        string opera3InstallationPath = null;

        //Gets the opera Installtion paths and reads to the string opera*InstallationPath
        opera2InstallationPath = (string)Registry.GetValue(pegasusKey + opera2ServerPath +    "System", "PathToServerDynamic", null);
        opera3InstallationPath = (string)Registry.GetValue(pegasusKey + opera3ServerPath + "System", "PathToServerDynamic", null);

        string Filesource = null;
        string[] FileList = (string[])e.Data.GetData(DataFormats.FileDrop, false);
        foreach (string File in FileList)
            Filesource = File;
        label.Text = Filesource;

        if (System.IO.Directory.Exists(opera3InstallationPath))
        {
            System.IO.File.Copy(Filesource, opera3InstallationPath);
            MessageBox.Show("File Copied from" + Filesource + "\n to" + opera3InstallationPath);
        }
        else
        {
            MessageBox.Show("Directory Doesn't Exist");
        } 
```

用户将文件拖到窗口上，然后我获取应用程序的安装路径，然后将其用作源文件的目标。当应用程序运行时，它会抛出错误目录未找到。但是，如果目录不存在，是否应该进入 else 语句？一个令人头疼的简单应用程序！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T08:55:18.547

您的文件源必须无效。这是我的建议：

1.  单步执行您的代码，在 if(Directory.Exists(...)) 代码块的第一行放置一个断点。
2.  通过将文件源添加到监视窗口来检查它，检查它是否是您所期望的
3.  打开“即时窗口”类型 File.Exists(Filesource) 并检查结果（应该是真的）。或者.. Directory.Exists(Path.GetDirectory(Filesource))

另外，我几乎可以肯定您的这部分代码中有逻辑错误。（您一遍又一遍地在循环中分配一个变量，您是要附加它吗？这没有意义）。

```
 string Filesource = null;
    string[] FileList = (string[])e.Data.GetData(DataFormats.FileDrop, false);
    foreach (string File in FileList)
        Filesource = File;
    label.Text = Filesource; 
```

# android - 解决android中地理标记的问题

> ID：12479996
> 
> 赞同：0
> 
> 时间：2012-09-18T15:19:03.963
> 
> 标签：android, geotagging

我是Android的新手。如何实现图像的地理标签？我自己尝试过，但没有得到预期的结果。我的代码是这样的：

```
@Override
    protected Dialog onCreateDialog(int id) {
       jpgDialog = null;;
       switch(id){
        case ID_JPGDIALOG:
        Context mContext = this;
        jpgDialog = new Dialog(mContext);
        jpgDialog.setContentView(R.layout.jpgdialog);
        exifText = (TextView) jpgDialog.findViewById(R.id.text);
        geoText = (TextView)jpgDialog.findViewById(R.id.geotext);
        bmImage = (ImageView)jpgDialog.findViewById(R.id.image);
        bmOptions = new BitmapFactory.Options();
        bmOptions.inSampleSize = 2;
        Button okDialogButton = (Button)jpgDialog.findViewById(R.id.okdialogbutton);
        okDialogButton.setOnClickListener(okDialogButtonOnClickListener);
        mapviewButton = (Button)jpgDialog.findViewById(R.id.mapviewbutton);
        mapviewButton.setOnClickListener(mapviewButtonOnClickListener);
        break;
        default:
        break;
        }
       return jpgDialog;
    } 
```

请帮助我如何进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:35:55.530

首先需要获取位置信息：

> [http://developer.android.com/guide/topics/location/obtaining-user-location.html](http://developer.android.com/guide/topics/location/obtaining-user-location.html)

然后，如果您的图像是 JPEG 文件，您可以在 EXIF 数据中嵌入坐标。使用 Android`ExifInterface`注入或提取该信息。

> [http://developer.android.com/reference/android/media/ExifInterface.html](http://developer.android.com/reference/android/media/ExifInterface.html)

例子：

```
ExifInterface exifInterface = new ExifInterface(fileName);
exifInterface.setAttribute(ExifInterface.TAG_GPS_LATITUDE, latitude);
exifInterface.setAttribute(ExifInterface.TAG_GPS_LONGITUDE, longitude);            exifInterface.saveAttributes(); 
```