# StackOverflow 问答 11265000-11265999

# javascript - 如何附加此文本而不是替换它？

> ID：11265001
> 
> 赞同：0
> 
> 时间：2012-06-29T15:51:26.617
> 
> 标签：javascript, bookmarklet

我有一个书签：

```
var b=document.getElementsByClassName('textinput')[0];
b.value=' (Christiansburg)';
var f=document.createEvent("HTMLEvents");
f.initEvent('change',true,true);
b.dispatchEvent(f);
void(0); 
```

这会将 Google 日历活动的标题的内容（如果有）替换为`(Christiansburg)`. 我希望它只是将它附加到已经存在的任何内容中。我已经尝试了几件事，但我不知道如何让它工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T15:54:10.287

更换`=`运营商

```
b.value  = ' (Christiansburg)'; 
```

到`+=`将您的字符串附加到值的运算符：

```
b.value += ' (Christiansburg)'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T15:55:23.297

`b.value += 'yourtextgoesrighthere';`会做的。如果在字符串上使用，“+”号是附加运算符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T15:55:54.557

要将字符串值附加到现有字符串，您可以使用`+=`运算符进行赋值：

```
b.value += ' (Christiansburg)'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T15:59:36.973

您可以使用运算符附加字符串`+`。`"Hello" + " " + "world"`也会如此`"Hello world"`。

所以你可以做`b.value = b.value + ' (Christiansburg)';`

由于附加经常进行，因此有一个速记：`b.value += ' (Christiansburg)'`

# c# - 检索活动名称

> ID：11265007
> 
> 赞同：0
> 
> 时间：2012-06-29T15:51:35.947
> 
> 标签：c#, wpf, visual-studio-2010, workflow-foundation-4

我在一个 WPF 项目中工作，我需要一个要求。这是我的主窗口：

[http://img210.imageshack.us/img210/9752/rule.jpg](http://img210.imageshack.us/img210/9752/rule.jpg)

所以，我希望当我拖放一个自定义活动（聚合函数）时，在计算文本框中显示他的名字......有什么办法吗？？？？

例如：

1) 拖放 MaxActivity

2) 在TextBox Compute中显示：MaxActivity

3) 拖放 SumActivity

4) 显示在TextBox Compute中：MaxActivity + SumActivity

5) 拖放 MaxActivity

6）在TextBox计算中显示：MaxActivity + SumActivity + MaxActivity1

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:57:17.153

1.  我强烈建议你避免这种设计，因为无论如何你最终实现它会给你的代码带来脆弱性而没有任何好处（我已经看到你正在聚合最大值和总和，为什么还要告诉我？）
2.  如果你继续，摆脱那个“计算”文本框。文本框 = 输入文本。您只是重新表述设计表面中已有的内容。允许我更改您生成的文本是没有意义的。使用文本块或标签。
3.  不要，我再说一遍，*不要把它*保存在你的活动中。这是所有 UI 任务，不应将此信息保存在您的 Activity 配置中

如果你有这个

```
public sealed class MyActivity : Activity
{
    public string Compute {get;set;} // NO! 
```

还有这个

```
<!-- NO! -->
<Label>Compute</Label><TextBox Text="{Binding ModelItem.Compute}"/> 
```

你可能做错了。

### 你是怎么做到的？

[您可以通过侦听ModelItem 中的更改](http://msdn.microsoft.com/en-us/library/system.activities.presentation.model.modelitem.propertychanged)并每次构造此字符串来解析您的 ModelItem 并生成此字符串。请注意，调用构造函数时不会设置您的 ModelItem，因此您将不得不监听[ActivityDesigner.ModelItem](http://msdn.microsoft.com/en-us/library/system.activities.presentation.workflowviewelement.modelitem)属性的更改。这个没有事件，所以你必须知道如何[监听 DependencyProperty 中的变化。](https://stackoverflow.com/questions/4764916/listen-to-changes-of-dependency-property)

一旦您监听了 ModelItem 中的更改，无论何时发生更改，您都可以[沿着 ModelItem](http://blogs.msdn.com/b/mwinkle/archive/2009/10/28/deep-dive-into-the-designer-data-model-modelitem-and-modelproperty.aspx)（这*很难*）或只是从 ModelItem 获取 Activity 并检查它。

```
var child = ModelItem.Properties["Child"].Value.GetCurrentValue();
if(child == null)
    computeTextBox.Text = "Please add some computation stuff.";
else
    // hard stuff goes here... 
```

沿着从 Activity 的子节点到其中包含的任何 Activity 的路径走下去可能是危险的，因为您不能假设您的用户已经抛出了一个序列而不是单个 MaxActivity，或者他们没有七个嵌套序列等. 所以你必须有一套相当复杂和脆弱的`if` `else`逻辑来尝试解析下面包含的内容。如果您开始在 ModelItem 之外更改 Activity 树的属性，您将与 UI 不同步。

现在，读完之后，回到第 1 点。我在这个答案中列出并遵循我的建议。彻底放弃这个想法。

# swing - java：如何在画布上画线

> ID：11265008
> 
> 赞同：1
> 
> 时间：2012-06-29T15:51:40.537
> 
> 标签：swing, scala, java-2d

我在画布上画了一些多边形，并想在画的多边形上画一些线。如果我在画线后画线，画的多边形会覆盖线，但如果我先画线，线会完全消失。代码在 Scala 中，但我认为所有相关代码都来自 Java 库。

编辑我已经扩展了代码以响应 Rex Kerr 的评论

```
package rStrat
package rSw
package mapCanv
import swing._
import java.awt.geom._
import java.awt.Polygon

abstract class MapCanv [T <: TypesD](val mArea: GeomBase[T]#MapArea) extends Panel
{
   type VHexT <: VisHex  
   val vHexs: Vec[VisHex] = mArea.mHexs.map(i => newVHexT(i))
   def newVHexT(mHex: GeomBase[T]#MapArea#MapHex): VHexT
   val line: Line2D.Double = new Line2D.Double(0,0, 350, 350)

   override def paintComponent (gr2d: Graphics2D)
   {
      super.paintComponent (gr2d)    
      vHexs.foreach(i => i.paint(gr2d))
      gr2d.draw(line)
   }  

    abstract class VisHex (val mHex: GeomBase[T]#MapArea#MapHex) extends Polygon with PaintTr
   {
      mHex.verts.foreach(i => addPoint(i.x.toInt, i.y.toInt))     
   }

   trait PaintTr
   {
      def paint(gr2d: Graphics2D): Unit
   }  
}

package rStrat //separate file
package rSw
package mapCanv
import swing._
//import java.awt._

abstract class MapCanvStd[T <: TypesStd](mArea: GeomBase[T]#MapArea) extends MapCanv[T](mArea)
{
   type VHexT = VisHexStd   
   override def newVHexT(mHex: GeomBase[T]#MapArea#MapHex) = new VisHexStd(mHex)

   class VisHexStd(mHex: GeomBase[T]#MapArea#MapHex) extends VisHex(mHex)
   {
      override def paint(gr2d: Graphics2D): Unit = 
      {          
         gr2d.setPaint(terrToCol(mHex.hex.terr))
         gr2d.fill(this)
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:37:03.197

我可以立即告诉您，您的示例不是独立的。例如`terrToCol`，`paint`主体中的`VisHexStd`方法没有定义。我认为您了解[Swing/Java2D 绘画](http://java.sun.com/products/jfc/tsc/articles/painting/index.html)的基础知识。

`Graphics2D`句柄是一个有状态/可变的东西。因此，当更改嵌套绘制的顺序产生意外结果时，这是由于在这些绘制命令中对图形状态所做的更改。所有`draw`或`fill`命令从图形句柄（`Paint`是一个超级/更通用的接口`Color`）中获取颜色或绘制状态。

在您的主要`paintComponent`方法中，您不设置颜色/油漆，而是依赖默认值（组件的前景色）。但是您在迭代中重复调用的方法确实会更改绘制属性 ( `paint`) ，因此在 main 方法中只使用您设置的任意最后一次绘制。`VisHex``setPaint``gr2d.draw(line)`

尝试在语句`gr2d.setColor(getForeground)`之前添加。`gr2d.draw(line)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:37:47.347

啊，这是我的愚蠢错误。我不知道 draw 甚至使用了 setcolor 方法。我只是假设它画了黑线，这当然是默认的。我发现的多边形示例都使用了 setcolor 方法，但绘制示例没有。我为我的多边形使用了一种非常浅的颜色，这对于多边形来说很好，但在用作一条线时几乎是不可见的。

# php - 制作预设响应功能的最佳方法是什么

> ID：11265017
> 
> 赞同：0
> 
> 时间：2012-06-29T15:52:27.523
> 
> 标签：php, javascript, sql

在提交有关下拉列表选择的查询的表单中制作预置响应功能的最佳方法是什么。

（下拉列表当前通过 php sql`foreach`循环填充）。

我希望使用存储在值中的下拉列表中选择的项目的 id 向 sql 报告以仅在不同的列中检索同一行数据....该消息还动态填充文本区域，没有 php 从和返回到同一页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:00:18.147

如果我对您的理解正确，为什么不对用于填充选择列表的数据进行 json 编码，然后从该过程中采取额外的步骤/查找。

然后，选择列表的 onchange 可以简单地从对象中获取正确的项目并在文本区域中显示消息，如果您还需要的话，还可以在隐藏字段中设置 id。

这样，您就可以从进程中移除对服务器的额外调用，并且还至少删除了一个额外的 sql 查询。

# javascript - 在 requestAnimationFrame 中使用 clearRect 不显示动画

> ID：11265019
> 
> 赞同：2
> 
> 时间：2012-06-29T15:52:33.837
> 
> 标签：javascript, image, html, animation

我想在 HTML5 画布上做一个简单的 javascript 动画。现在我的画布是分层的，所以当我收到鼠标事件时，背景层不会改变，但带有头像的顶层会移动。如果我使用 requestAnimationFrame 并且不清除屏幕，我会看到我漂亮的小玩家在多个帧中在屏幕上移动，角色的尾巴很长。但是，如果我尝试在每个动画帧之后执行 clearRect，那么我的角色永远不会出现，我不确定是什么原因造成的。

我使用这些链接作为我的代码的基础：http:
//www.html5canvastutorials.com/advanced/html5-canvas-start-and-stop-an-animation/ [http://paulirish.com/2011/requestanimationframe-智能动画/](http://paulirish.com/2011/requestanimationframe-for-smart-animating/) [http://www.nczonline.net/blog/2011/05/03/better-javascript-animations-with-requestanimationframe/](http://www.nczonline.net/blog/2011/05/03/better-javascript-animations-with-requestanimationframe/)

很多示例都是绘制动画形状，而我使用的是图像，不确定这是否重要以及我是否应该只使用画布变换函数而不是 clearRect，但认为这不应该一个区别。另外，为了可读性，我删除了一堆代码，所以括号可能是关闭的，但代码是正常的，我只是为了可读性而这样做，所以你可以看到一个方向的动画。我的代码看起来像：

```
// what is this function for? See here - http://stackoverflow.com/questions/10237471/please-explain-this-requestanimationframe-idiom
window.requestAnimFrame = function(callback){
// add in this parentheses - http://stackoverflow.com/questions/5605588/how-to-use-    requestanimationframe
   return ( window.requestAnimationFrame ||
    window.webkitRequestAnimationFrame ||
    window.mozRequestAnimationFrame ||
    window.oRequestAnimationFrame ||
    window.msRequestAnimationFrame ||
    function(callback){
        window.setTimeout(callback, 1000 / 60);
    }
);
}();

function stopAnimatingPlayer(currentAvatarAnimating, destinationCellX, destinationCellY) {
    gIsAnimating = false;
    //Did this final draw because I wasn't sure if the avatar would end on the exact pixel position, so this should snap him back into place
    drawAvatar(currentAvatarAnimating, destinationCellX, destinationCellY, false,0,0);
}   

function movePlayer(lastTime, playerPixelX, playerPixelY, destinationCellX, destinationCellY) {
if (gIsAnimating) {
    // the canvas is already globally held as gAvatarCanvasElement & gAvatarDrawingContext;

    // update
    var date = new Date();
    var time = date.getTime();
    var timeDiff = time - lastTime;
    var linearSpeed = 100;
    // pixels / second
    var linearDistEachFrame = linearSpeed * timeDiff / 1000;
    var horizontal = false;
    var newX, newY;

    // gets the new coordinate of the player
    if (gTowerCurrentPlayer == 1) {
        //fill in later - just trying to get one horizontal animation working
        } else if (destinationCellY == gPlayer1Cell.y) { // we're moving horizontally
    var currentX = playerPixelX;
            var diffX = destinationCellX - gPlayer1Cell.x;
            horizontal = true;
            if (diffX > 0) { // player is moving right - just get one direction going for now
                if (currentX < getPixelFromRow(destinationCellX)) {
                    newX = currentX + linearDistEachFrame;
                } else {
                    stopAnimatingPlayer(gTowerCurrentPlayer, destinationCellX, destinationCellY); 
                }
            } //fill in rest later - get one direction working

    lastTime = time;

    // clear - this is where the problem is
    gAvatarDrawingContext.clearRect(playerPixelX, playerPixelY, kPieceWidth, kPieceHeight);
    //gAvatarDrawingContext.clearRect(0,0, gAvatarCanvasElement.width, gAvatarCanvasElement.height);

    if (horizontal) {
        drawAvatar(gTowerCurrentPlayer, 0, 0, true, newX, playerPixelY);
        // request new frame
        requestAnimFrame(function(){ 
            movePlayer(lastTime, newX, playerPixelY, destinationCellX, destinationCellY);
        });
    } 
}
}

function animatePlayer(playerPixelX, playerPixelY, destinationCellX, destinationCellY) {
    gIsAnimating = true; // global var here
    var date = new Date();
    var time = date.getTime();
    movePlayer(time, playerPixelX, playerPixelY, destinationCellX, destinationCellY); 
} 
```

如果有人可以提供任何帮助，我将不胜感激，我只是不明白为什么这不起作用。我不需要超级华丽的动画，这就是为什么我没有使用 kineticjs 或任何其他库。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T09:47:55.577

当您清除画布时，它会擦除​​上面的所有内容，因此如果您在绘制后调用它，您会得到一个空白画布，这就是您所描述的。相反，您应该等到下一帧，然后在绘制之前而不是之后清除画布，以便绘制的图像显示一段时间。要解决您的问题，只需将您的清除命令向上移动，以便它在每帧的绘图命令之前立即发生。

# c# - 在表格中显示命令行输出

> ID：11265022
> 
> 赞同：0
> 
> 时间：2012-06-29T15:52:46.697
> 
> 标签：c#, winforms

我在跑

> wmic 产品获取名称、版本

从命令行获取已安装程序和版本的列表。我需要在 ac# windows 窗体应用程序的表格中显示它，但我在使用 dataGridView 时遇到了困难。现在我只是将东西存储在 a`List<string>`但我不知道如何让它在表格中正确显示。有什么建议/帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:57:04.240

首先，有点在黑暗中刺伤看看这个[教程](http://www.dotnetperls.com/datagridview-tutorial)

你真的只需要在你的表单上放一个 datagridview 然后使用这条线

```
 List<string> t  = new list<string>();

 //Add your data

 dataGridView1.DataSource = t; 
```

如果这没有回答您的问题，请尝试详细说明您在使用数据网格时遇到的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:01:45.537

tjernigan，也许这有帮助：您列表中的第一个字符串应该是“名称版本”。请注意，以下每个版本都与该列的标题对齐。

因此，在第一个字符串上，找到 IndexOf "Version" 并使用此位置获取其他字符串的子字符串。

问候， 卡里尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T19:14:04.810

最后只是运行`wmic product get name`并将`wmic product get version` 每个存储在一个单独的列表中，然后执行：

```
for (int i = 0; i < names.Count; i++)
        {
            rows[0] = names.ElementAt(i).Trim();
            rows[1] = versions.ElementAt(i).Trim();
            programsGrid.Rows.Insert(i, rows);
        } 
```

感谢所有的建议。

# java - POM 文件中占位符的值？

> ID：11265023
> 
> 赞同：0
> 
> 时间：2012-06-29T15:52:48.443
> 
> 标签：java, maven, pom.xml

我有一个项目，它有一个 POM 文件，其中有以下条目。

```
<repository>
    <id>central</id>
    <name>${project.artifactId}</name>
    <url>${repo.deploy}</url>   
</repository> 
```

占位符的值在 POM 文件中不可用。这些东西应该在哪里配置？在 settings.xml 文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:04:05.990

它们应该在 pom.xml 文件中可用，project.artifactId 在 pom 文件中你应该找到：

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.expample</groupId>
    <artifactId>example</artifactId>
    <name>hub.js</name>
    <packaging>jar</packaging>
    ....

</project> 
```

在示例中，${project.artifactId} 的值为“example”。

${repo.deploy} 的情况不同，我认为它不属于 pom 结构，所以你应该在 pom 中声明一个属性（它可以作为配置文件的一部分）或者在 setting.xml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T15:56:24.217

是的，请参见此处：[http ://maven.apache.org/guides/introduction/introduction-to-profiles.html](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)

# c# - 在 c#.net 中使用字符串

> ID：11265024
> 
> 赞同：1
> 
> 时间：2012-06-29T15:52:55.520
> 
> 标签：c#, asp.net, .net, string, substring

嗨我如何从以下字符串中检索数字，

```
{"number":100,"data":[test]} 
```

该数字可以是任意长度。

我使用了以下代码。但它给出了错误信息

```
strValue.Substring((strValue.IndexOf(":")+1), (strValue.IndexOf("data"))); 
```

输出就像

100，“数据”：[

谢谢，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T15:54:46.963

看起来您的输入字符串是 JSON。是吗？如果是这样，您应该使用适当的 JSON 解析器库，如[JSON.NET](http://json.codeplex.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T15:55:31.667

你的尝试很接近。我发现了两个（可能是三个问题）。

1.  您的字符串在您要查找的数字后面有一个逗号。由于您的代码正在搜索“数据”的索引，因此您的结束索引将结束一个字符。
2.  [String.Substring(int, int)](http://msdn.microsoft.com/en-us/library/aka44szs.aspx)的第二个参数实际上是一个长度，而不是一个结束索引。
3.  [字符串在 C# 中是不可变的](http://msdn.microsoft.com/en-us/library/s1wwdcbf#Immutability)。因此，字符串上的任何成员函数都不会真正修改其值。相反，它们返回一个新值。我不知道您的代码示例是否完整，因此您可能正在将返回值分配`SubString`给某物，但如果不是，最终结果将`strValue`保持不变。

总体而言，您当前调用的结果`string.Substring`是返回`100,"data":[tes`。（据我所知，它没有存储结果）。

试试下面的代码：

```
string justTheNumber = null;
// Make sure we get the correct ':'
int startIndex = strValue.IndexOf("\"number\":") + 9;
// Search for the ',' that comes after "number":
int endIndex = strValue.IndexOf(',', startIndex);
int length = endIndex - startIndex;
// Note, we could potentially get an ArguementOutOfRangeException here.
// You'll want to handle cases where startPosition < 0 or length < 0.
string justTheNumber  = strValue.Substring(startIndex, length); 
```

注意：此解决方案不处理是否`"number":`是字符串中列表中的最后一个条目，但它应该处理其中的所有其他位置。

如果您的字符串变得更复杂，您可以尝试使用[正则表达式](http://msdn.microsoft.com/en-us/library/ms228595)来执行搜索。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T16:02:51.140

正如 Jon 所指出的，您的输入字符串似乎是需要反序列化的 JSON 字符串。您可以编写自己的反序列化器，或使用现有的库，例如[Json.NET](http://json.codeplex.com/)。这是一个例子：

```
string json = @"[
  {
    ""Name"": ""Product 1"",
    ""ExpiryDate"": ""\/Date(978048000000)\/"",
    ""Price"": 99.95,
    ""Sizes"": null
  },
  {
    ""Name"": ""Product 2"",
    ""ExpiryDate"": ""\/Date(1248998400000)\/"",
    ""Price"": 12.50,
    ""Sizes"": null
  }
]";

List<Product> products = JsonConvert.DeserializeObject<List<Product>>(json); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-29T15:56:14.537

以这种方式解析 JSON spring 是非常糟糕的做法，因为所有内容都是硬编码的。您是否考虑过使用 3rd 方库来解析 JSON 字符串，例如[Newtonsoft JSON](http://james.newtonking.com/projects/json-net.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T15:55:12.643

我猜你需要使用 IndexOf(",") 而不是 IndexOf("data")

# iphone - 设置 UITableView 委托和数据源

> ID：11265039
> 
> 赞同：15
> 
> 时间：2012-06-29T15:53:36.097
> 
> 标签：iphone, objective-c, uitableview, delegates

这是我的问题：我`UITableView`的故事板中有这个小东西：![在此处输入图像描述](../Images/dfb1fad5ec08387641b99a35c2f51748.png)

这是我的代码：

**SmallTableViewController.h**

```
#import <UIKit/UIKit.h>
#import "SmallTable.h"

@interface SmallViewController : UIViewController

@property (weak, nonatomic) IBOutlet UITableView *myTable;

@end 
```

**SmallTableViewController.m**

```
#import "SmallViewController.h"

@interface SmallViewController ()

@end

@implementation SmallViewController
@synthesize myTable = _myTable;

- (void)viewDidLoad
{
    SmallTable *myTableDelegate = [[SmallTable alloc] init];
    [super viewDidLoad];
    [self.myTable setDelegate:myTableDelegate];
    [self.myTable setDataSource:myTableDelegate];

    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

现在如您所见，我想将一个名为 myTableDelegate 的实例设置为 myTable 的 Delegate 和 DataSource。

这是 SmallTable 类的来源。

**小表.h**

```
#import <Foundation/Foundation.h>

@interface SmallTable : NSObject <UITableViewDelegate , UITableViewDataSource>

@end 
```

**小表.m**

```
@implementation SmallTable

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 0;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return 5;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...
    cell.textLabel.text = @"Hello there!";

    return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"Row pressed!!");
}

@end 
```

我实现了应用程序需要的所有`UITableViewDelegate`和方法。`UITableViewDataSource`为什么它只是在视图出现之前崩溃？

谢谢！！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-29T16:28:22.097

里克斯特是对的。但我想你需要`strong`为你的属性使用一个限定符，因为在你的`viewDidLoad`方法结束时，对象无论如何都会被释放。

```
@property (strong,nonatomic) SmallTable *delegate;

// inside viewDidload

[super viewDidLoad];
self.delegate = [[SmallTable alloc] init];    
[self.myTable setDelegate:myTableDelegate];
[self.myTable setDataSource:myTableDelegate]; 
```

但是有什么理由为您的表使用分离的对象（数据源和委托）？为什么不将`SmallViewController`您的表设置为源和委托？

此外，您没有以正确的方式创建单元格。这些行什么都不做：

```
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

// Configure the cell...
cell.textLabel.text = @"Hello there!"; 
```

`dequeueReusableCellWithIdentifier`只需从表“缓存”中检索一个已经创建并且可以重复使用的单元格（这是为了避免内存消耗），但您还没有创建任何单元格。

你在哪儿`alloc-init`呢？改为这样做：

```
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if(!cell) {
    cell = // alloc-init here
}
// Configure the cell...
cell.textLabel.text = @"Hello there!"; 
```

此外，`numberOfSectionsInTableView`要返回 1 而不是 0：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 1;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T16:01:53.243

大概你正在使用ARC？你`myTableDelegate`只在一个局部变量中被引用`viewDidLoad`——一旦该方法结束，它就会被释放。（在委托/数据源模式中，对象不拥有它们的委托，因此表视图对对象的引用很弱。）我不认为仅此一项会导致崩溃，但这可能是您问题的关键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T16:22:55.027

`setDelegate`不会保留代表。

和

`numberOfSectionsInTableView`方法必须返回 1 而不是 0；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-30T09:59:03.837

```
(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 0;
} 
```

段数应至少设置为一个

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-19T13:22:40.337

UITableView 对象的委托必须采用 UITableViewDelegate 协议。协议的可选方法允许委托管理选择、配置部分标题和页脚、帮助删除方法。

![在此处输入图像描述](../Images/e07dd1d91fccf92e71fe460dc43b77df.png) ￼</p>

# python - python中的Docx内容和格式提取

> ID：11265055
> 
> 赞同：1
> 
> 时间：2012-06-29T15:54:27.137
> 
> 标签：python, file-io, xml-parsing, fileparsing

我正在尝试解析 docx 文件夹并根据某个单词是否加粗来获取特定元素。如果这是文档中的文本：

**福：**你好

***嘘：*** 呸呸呸

•废话

•废话

***周：***你好

我想逐行扫描，然后将粗体字之后的所有文本取出，直到下一个粗体字。

截至目前，我正在使用基于换行符解析的 XML 解析器。我在 Zipfile 中找不到任何东西，也找不到任何可以给我这样的元数据的行。

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-20T10:13:41.820

我会使用支持读取 docx 文件而不是解析 XML 文档的更高级别的库。

一个负责这项任务的库是[python-docx](https://github.com/mikemaccana/python-docx)。

如果您使用的是 Jython，[Apache POI HWPF](http://poi.apache.org/hwpf/index.html)是另一种选择。

# python - 如何安装 32 位版本的 numpy

> ID：11265057
> 
> 赞同：0
> 
> 时间：2012-06-29T15:54:43.197
> 
> 标签：python, numpy, matplotlib, osx-snow-leopard, 32bit-64bit

经过一番努力，我终于得到了 matplotlib 及其所有依赖项，可以在 Snow Leopard 10.6.8 上和谐地工作。我现在想稍微调整一下它的配置，以允许我使用 32 位安装的 wxPython 作为它的后端。问题是当我使用 Python 2.7.3（python.org 版本）的 32 位安装时，不会导入 numpy（matplotlib 需要）。谷歌搜索一个小时左右让我相信，通过指定 CFLAGS 和 LDFLAGS 与 setup.py 结合使用，可以将 numpy 构建和安装为 32 位。我不清楚这些标志的作用，毫不奇怪我没有成功使用它们。这是我从下载的 numpy 文件夹中尝试的：

```
$ CLFLAGS=-m32 LDFLAGS=-m32 python setup.py install 
```

我收到一些错误消息，但 numpy 的 64 位兼容版本确实到达了我的 sitepackages 文件夹。但是，当我使用 32 位解释器时，出现错误：

```
ImportError: dynamic module does not define init function (initmultiarray) 
```

我认为我可以构建一个 32 位的 numpy 是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T16:39:29.977

我只是花了几天的时间环顾四周，把头发拉了出来，所以我想我会在这里为我的发现做出贡献……

我有同样的问题，但只是设置标志对我不起作用（但这确实需要）......在我的情况下，我有一个单独的 32 位版本的 python，所以我做了：

CFLAGS="-m32" LDFLAGS="-m32" /util/linux32/bin/python setup.py install --prefix=/util/science/gfortran-4.4.6/linux32/

（不用担心我在前缀中的 gfortran 东西，幸运的是我不得不测试不同的编译器.. ;)）

但后来我会收到一个错误，最后一行会说：“RuntimeError: Broken toolchain: cannot link a simple C program”

但如果我向上滚动，我有：

gcc -pthread _configtest.o -o _configtest

_configtest.o：无法读取符号：文件格式错误

collect2: ld 返回 1 个退出状态

_configtest.o：无法读取符号：文件格式错误

collect2: ld 返回 1 个退出状态

失败。

删除：_configtest.c _configtest.o

如您所见，在 gcc 调用中没有“-m32”标志...

我将其追溯到 distutils install ；对我来说：/util/linux32/lib/python2.7/distutils/ccompiler.py

并且可能有比这更优雅的解决方案，比如直接获取 cflags 值，但我不是 python 女孩所以不知道如何.. ;) 我可能会弄清楚，但我现在关心的是最终安装numpy 在 32 位模式下.. 所以无论如何...这个 python 代码的第 693 行，我改变了

```
runtime_library_dirs=None, debug=0, extra_preargs=None, 
```

至

```
runtime_library_dirs=None, debug=0, extra_preargs=['-m32'], 
```

（在函数 link_executable 中；如果您有不同版本的 python...）

瞧... numpy 在 32 位模式下成功安装在 64 位机器上。我认为这也适用于其他模块，因为它与 distutils 相关，而不是 numpy .. ;)

希望这可以帮助将来的人并节省一些时间！

伊芙-玛丽

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:12:24.333

您可以尝试使用 EPD 的免费版本（如果您在学术界，完整版本是免费的）：

[http://www.enthought.com/products/epd_free.php/](http://www.enthought.com/products/epd_free.php/)

这有一个 32 位版本的 mac，包含所有关键的科学堆栈包，包括 scipy、numpy 和 matplotlib。

# c# - 如何在另一个窗体页面中添加窗体的现有选项卡？

> ID：11265061
> 
> 赞同：0
> 
> 时间：2012-06-29T15:54:47.173
> 
> 标签：c#, .net, winforms

处理 c# 2.0 .NET windows 窗体

我想在另一个窗体页面中显示窗体的现有选项卡，以引用具有我要显示的选项卡的页面。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T08:32:00.687

我不确定我是否正确理解了您的问题，但这是我得到的：您有一个窗口窗体，说 FormA，您有一个选项卡控件，选项卡页可能包含更多控件，例如 TextBoxes 等。现在您想要这个 TabControl 与它的所有子控件都被移动到一个新的表单中，比如 FormB，MOVED 是指 FormA 上的选项卡控件的实例，而不是一个新的实例。这意味着如果用户在 TabPage 中的 TextBox 上输入了一些内容，那么当整个控件移到那里时，即使用户输入的文本也应该出现在 FormB 中。

如果上述情况是正确的，那么正如上面有人指出的那样，这在 .Net 中是不允许的，一个控件托管在一个容器中，它不能同时在两个地方可见。

但是，您可能有兴趣暂时以另一种形式显示（而不是使用）控件，如果我完全从第一种形式中删除控件，那也没关系。假设 FormA 将 FormB 作为模态窗口打开并将其自己的选项卡控件传递给它，用户将使用 FormB 上的控件然后关闭模态窗体 FormB 并且选项卡控件回到其原始位置。

这是很有可能的，只需从 FormA 中的容器中删除 Tab 控件，将其传递给 FormB，FormB 会将其添加到某个容器并显示它，反之亦然。

例如。说一个按钮点击FormA你可以写：

```
 FormB myForm = new FormB();
        this.Controls.Remove(this.tabControl1);
        myForm.AddTabControlToPanel(this.tabControl1);
        myForm.Show(); 
```

那么FormB将有一个功能

```
 public void AddTabControlToPanel(TabControl tc)
    {
        panel1.Controls.Add(tc);
        tc.Left = 10;
        tc.Top = 10;
        tc.Width = 200;
        tc.Height = 200;
    } 
```

# javascript - 创建可在 Safari 中使用的书签链接

> ID：11265064
> 
> 赞同：6
> 
> 时间：2012-06-29T15:54:50.033
> 
> 标签：javascript, jquery, asp.net, asp.net-mvc, asp.net-mvc-3

我曾尝试在我的代码中使用 JavaScript“AddFavorite”函数，但它在 Safari 中不起作用。它适用于 IE，我想我记得 Firefox，但我尝试过的任何东西似乎都不适用于 Safari。我想做的就是在我的网站上有一个链接，人们可以点击它，它会自动在他们的书签文件夹/书签栏中创建一个书签。

这是否需要 Applescript 或类似的东西？还是我不知道的更深层次的编程语言？

```
<a href="javascript:bookmarksite('Name', 'website.com')"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:09:27.120

来自苹果论坛：[forum-link](https://discussions.apple.com/thread/1364657?start=0&tstart=0)

> 至少在 Mac 端，Safari 不允许网站添加书签。我很确定 Windows 版本中也有同样的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-07T01:06:50.413

我一直在走这条路，我发现 Safari 不允许使用 JavaScript 制作书签：

[苹果论坛](https://discussions.apple.com/thread/1364657?tstart=0)

[字节论坛](http://bytes.com/topic/javascript/answers/940440-how-add-bookmark-safari-using-javascript)

他们认为这是不安全的。令人沮丧的是，我明白他们的意思。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:42:36.890

不幸的是，大多数这样的事情往往是特定于浏览器的，而且很挑剔。

我的 JS 大约是 0 级，但我确实在这里的一篇旧文章中找到了这个：

一个专门针对 Chrome 的： [添加到 Google Chrome 的收藏夹链接](https://stackoverflow.com/questions/3230499/add-to-favourites-link-for-google-chrome)

还有一个跨浏览器书签链接： [跨浏览器书签/添加到收藏夹 javascript](https://stackoverflow.com/questions/3024745/cross-browser-bookmark-add-to-favorites-javascript)

希望在前面的评论和这些链接之间，你得到你需要的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-12T14:53:43.787

出于明显的安全原因，Chrome 和 Safari 不允许这样做。

你可以使用这样的脚本：

[http://www.dynamicsitesolutions.com/javascript/add-bookmark-script/](http://www.dynamicsitesolutions.com/javascript/add-bookmark-script/)

它处理许多浏览器并有一个很好的回退：显示带有指令消息的浏览器自定义警报。

Es：在 chrome 中它说：“Ctrl+D 添加为书签”

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-29T16:06:05.860

在 IE 中，类似于以下内容的内容会起作用：( [MSDN](http://msdn.microsoft.com/en-us/library/ie/ms535926%28v=vs.85%29.aspx) )

```
window.external.AddFavorite(location.href, document.title); 
```

但是，这在其他浏览器中不起作用。在 Firefox 中，相信你可以使用

```
window.sidebar.addPanel(document.title, location.href, ''); 
```

创建一个侧边栏面板（不是真正的书签），但据我所知 Chrome 和 Safari 不允许 Javascript 自动创建书签。对于那些，我建议给用户手动操作的说明：

*   将链接拖到他们的书签
*   按`Ctrl + D`添加书签
*   单击`+`工具栏中的或星形图标

# erlang - 如何让 Rebar 在发布目录中运行 Common Test？

> ID：11265065
> 
> 赞同：9
> 
> 时间：2012-06-29T15:54:51.223
> 
> 标签：erlang, rebar, common-test

我有一个带有顶级发布目录的 Rebar 项目，该目录仅包含组件应用程序作为依赖项并包含 reltool 配置。

我的一些应用程序在子目录中有 Common Test 套件`test`，我可以使用`rebar ct`.

现在我想为整个版本创建一个通用测试套件。但是，当我`rebar ct skip_deps=true`在顶级目录中运行时，我会得到：

```
Command 'ct' not understood or not applicable 
```

如何让 Rebar 运行我的测试？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T15:54:51.740

Rebar 有三组模块（参见[rebar.app](https://github.com/basho/rebar/blob/master/ebin/rebar.app)）：

*   `any_dir_modules`，适用于您项目中的任何目录；
*   `app_dir`模块，仅适用于包含匹配文件的目录`src/*.app.src`或`ebin/*.app`（参见[`rebar_app_utils:is_app_dir/1`](https://github.com/basho/rebar/blob/master/src/rebar_app_utils.erl#L48)）；和
*   `rel_dir`模块，仅适用于包含`reltool.config`or的目录`reltool.config.script`（请参阅 参考资料[`rebar_rel_utils:is_rel_dir/1`](https://github.com/basho/rebar/blob/master/src/rebar_rel_utils.erl#L49)）。

`rebar_ct`负责运行 Common Test的模块属于该`app_dir`类别，因此您的顶级发布目录不符合条件。

您可以通过指定它是一个插件来解决这个问题`rebar_ct`，因为插件绕过了模块类别机制。将以下行放入您的`rebar.config`:

```
{plugins, [rebar_ct]}. 
```

你会得到：

```
$ rebar ct skip_deps=true
==> foo (ct)
==> bar (ct)
==> my_rel (ct)
DONE.
Testing src.my_rel: TEST COMPLETE, 0 ok, 0 failed of 0 test cases 
```

# iphone - 手机处于睡眠模式时，iphone应用程序可以处理音频输入吗

> ID：11265074
> 
> 赞同：0
> 
> 时间：2012-06-29T15:55:37.210
> 
> 标签：iphone, ios

我需要构建一个可以接收用户音频输入并处理它的应用程序，即使手机处于睡眠模式也是如此。例如，如果用户说“你好”，那么即使手机处于睡眠模式，应用程序也需要识别并处理它。我已经阅读了解释如何防止手机进入睡眠模式的帖子，如果应用程序在手机处于睡眠模式时无法读取音频输入，那将是我的第二个选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:09:15.037

恐怕这是不可能的，有 5 种不同类型的应用程序可以在后台继续运行，这些是（来自 Apple 文档）：

*   在后台向用户播放有声内容的应用程序，例如音乐播放器应用程序
*   让用户随时了解其位置的应用程序，例如导航应用程序
*   支持互联网协议语音 (VoIP) 的应用程序
*   需要下载和处理新内容的报亭应用
*   从外部配件接收定期更新的应用程序

如果您的应用程序没有执行任何这些操作，则您的应用程序在进入后台时将不会执行代码。此外，在将应用程序发送给 Apple 进行审查之前，您应该声明您的应用程序正在执行这些功能之一。

# c++ - c++：浮点运算稳定性的策略

> ID：11265081
> 
> 赞同：12
> 
> 时间：2012-06-29T15:56:06.803
> 
> 标签：c++, math, floating-accuracy, stability, numerical-stability

任何人都可以推荐任何包含维护各种浮点运算稳定性的策略的 C++ 库/例程/包吗？

示例：假设您想`long double`在单位间隔 (0,1) 中对一百万的向量/数组求和，并且每个数字的数量级大致相同。天真求和`for (int i=0;i<1000000;++i) sum += array[i];` 是不可靠的 - 因为足够大`i`，`sum`将比 大得多的数量级`array[i]`，因此`sum += array[i]`相当于`sum += 0.00`. （注意：此示例的解决方案是二进制求和策略。）

我处理数千/数百万个微小概率的总和和乘积。我正在使用`MPFRC++`具有 2048 位有效位的任意精度库，但同样的问题仍然适用。

我主要关心的是：

1.  精确求和许多数字的策略（例如上面的示例）。
2.  什么时候乘法和除法可能不稳定？（如果我想对大量数字进行归一化，我的归一化常数应该是多少？最小值？最大值？中位数？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T16:04:11.433

二进制求和不能*保证*准确的结果。最可靠（尽管速度较慢）的方法是使用[Kahan summation](http://en.wikipedia.org/wiki/Kahan_summation_algorithm)。[Boost.Accumulators](http://www.boost.org/doc/libs/1_50_0/doc/html/accumulators.html)实现了上述以及更多。

乘法和除法稳定性：除非您使用非规范化浮点数，否则它们不会遇到与求和和减法相同的问题。事实上，乘法的误差*最多*为 0.5 ulp（单位最后一位）。

> ...我的归一化常数应该是多少？

你所说的“正常化”是什么意思？这取决于您使用的[规范。](http://en.wikipedia.org/wiki/Norm_%28mathematics%29)可能的候选者：使用数组中的最大绝对值，或任何其他广义平均值。（您列出的其他选择不起作用，因为即使对于非零数组，它们也可能为零。）

# c# - 如何将控件数组设置为占位符？

> ID：11265086
> 
> 赞同：2
> 
> 时间：2012-06-29T15:56:21.667
> 
> 标签：c#, asp.net, visual-studio-2010

我是asp.net的初学者我正在做一个图像检索项目，最后我现在有图像链接，我创建图像控件，给它链接并添加到占位符，但它给我错误：对象引用未设置到一个对象的实例

代码 ：

```
 System.Web.UI.WebControls.Image [] result = new System.Web.UI.WebControls.Image[links.Count()];

  for (int h = 0; h < result.Length; h++)
    {     
       result[h].ImageUrl = links[h];  /// here's the error 
       PlaceHolder1.Controls.AddAt(h, result[h]);    
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T15:58:25.137

在分配给其中的成员之前，您需要在每个数组索引中实例化 Image。尝试：

```
result[h] = new Image() { ImageUrl = links[h] }; 
```

# python - Virtualenv 没有创建环境

> ID：11265091
> 
> 赞同：16
> 
> 时间：2012-06-29T15:56:43.480
> 
> 标签：python, virtualenv, virtualbox, symlink, shared-directory

我在 Ubuntu 12.04 上安装了 Virtualenv，并使用它在统一桌面下的示例项目上工作。我正在使用 VirtualBox，并且在统一桌面上遇到了一些问题，因此更改为 KDE 桌面。

我现在正在尝试创建一个新项目，但 virtualenv 不允许我在我的项目文件夹中创建一个新环境。在终端中，我导航到项目文件夹，键入 virtualenv venv 并收到以下错误消息：

```
Traceback (most recent call last):
  File "/usr/bin/virtualenv", line 3, in <module>
    virtualenv.main()
  File "/usr/lib/python2.7/dist-packages/virtualenv.py", line 938, in main
    never_download=options.never_download)
  File "/usr/lib/python2.7/dist-packages/virtualenv.py", line 1039, in create_environment
    site_packages=site_packages, clear=clear))
  File "/usr/lib/python2.7/dist-packages/virtualenv.py", line 1215, in install_python
    copyfile(stdinc_dir, inc_dir)
  File "/usr/lib/python2.7/dist-packages/virtualenv.py", line 430, in copyfile
    copyfileordir(src, dest)
  File "/usr/lib/python2.7/dist-packages/virtualenv.py", line 405, in copyfileordir
    shutil.copytree(src, dest, True)
  File "/usr/lib/python2.7/shutil.py", line 206, in copytree
    raise Error, errors
shutil.Error: [('/usr/include/python2.7/numpy', 'venv/include/python2.7/numpy', '[Errno 30] Read-only file system')] 
```

谁能帮我解决这个问题？我试过重新安装 virtualenv 但没有乐趣。谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-06-22T16:53:24.087

Virtualenv 正在使用符号链接（[shutil.copytree](https://docs.python.org/2/library/shutil.html#shutil.copytree)使用它们，请参阅回溯）。禁用在 VirtualBox 共享文件夹中创建符号链接。终端中的简单测试（在来宾机器内）：

```
$ ln -s testfile 
```

要么你会得到一个`failed to create symbolic link './testfile': Read-only file system`或`Protocol error`。

*您可以通过在主机上的*终端中执行来启用共享文件夹中的符号链接（[来自 schisamo 的解决方案](https://www.virtualbox.org/ticket/10085#comment:14)）：

```
$ vboxmanage setextradata VM_NAME "VBoxInternal2/SharedFoldersEnableSymlinksCreate/NAME_OF_YOUR_SHARED_FOLDER" 1 
```

将 VM_NAME 替换为虚拟机的名称，如 VirtualBox Manager 中所示：

![VM_NAME 示例](../Images/e6a9befd2b412a48ada1a254806dfa6e.png)

和 NAME_OF_YOUR_SHARED_FOLDER 以及您可以在虚拟机设置中看到的共享文件夹的名称：

![共享文件夹设置](../Images/78d9cb64a2071f83dffafdb947dae4a0.png)

设置完成后，重启VirtualBox。

您可以检查设置（*在主机上*）

```
$ vboxmanage getextradata VM_NAME enumerate 
```

[修复 Windows（Ahti Kitsik）](https://ahtik.com/fixing-your-virtualbox-shared-folder-symlink-error/)（感谢[Bryan 的回答](https://stackoverflow.com/a/21450513/1168315)）。

* * *

[VirtualBox从 4.0 版（适用于 Linux 和 Solaris）开始](https://www.virtualbox.org/manual/ch04.html#sharedfolders)为共享文件夹实现符号链接，但出于安全原因，[从 4.1.8 版开始禁用。](https://www.virtualbox.org/ticket/10085#comment:12)这可能就是为什么它首先对您有用而后来却没有的原因。

# [文档](https://docs.oracle.com/cd/E97728_01/E97727/html/sharedfolders.html)：

> VirtualBox 共享文件夹还支持符号链接，也称为符号链接，在以下情况下：
> 
> *   主机**操作系统必须支持符号链接**。例如，需要 Mac OS X、Linux 或 Oracle Solaris 主机。
> *   目前只有 Linux 和 Oracle Solaris Guest Additions 支持符号链接。
> *   出于安全原因，默认情况下不允许来宾操作系统创建符号链接。如果您相信来宾操作系统不会滥用该功能，您可以为共享文件夹启用符号链接的创建，如下所示 [见上文]

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-29T16:35:52.557

好的，经过更深入的谷歌搜索发现这是一个 VirtualBox 问题，而不是 Ubuntu 问题。共享文件夹受此活动保护。我不知道它第一次是如何/为什么起作用的，但它是一个已知的错误。我在共享文件夹之外创建了一个项目，没有任何问题。感谢您输入 Dougal。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-01-30T07:43:40.183

Ahti Kitsik 在他的博客上发布了一个解决方法： [https ://ahtik.com/fixing-your-virtualbox-shared-folder-symlink-error/](https://ahtik.com/fixing-your-virtualbox-shared-folder-symlink-error/)

```
VBoxManage setextradata YOURVMNAME VBoxInternal2/SharedFoldersEnableSymlinksCreate/YOURSHAREFOLDERNAME 1 
```

`YOURSHAREFOLDERNAME`是根据 VirtualBox 的共享文件夹的名称。

如果你碰巧在使用 Vagrant，这里是你的 Vagrantfile 的修复：

```
config.vm.provider :virtualbox do |vb|
  vb.customize ["setextradata", :id, "VBoxInternal2/SharedFoldersEnableSymlinksCreate//vagrant","1"]
end 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-08T12:14:01.100

我在使用 Ubuntu 来宾的 virtualenv 和 VirtualBox（通过 Vagrant 管理）时遇到了同样的错误。

想起之前的一个文件权限给我带来问题的事件，我尝试在我的 Vagrantfile 中打开 nfs 共享：

```
config.vm.share_folder("v-root", "/home/vagrant/apps", "/home/gareth/Projects/project-name/", :nfs => true) 
```

这为我解决了这个问题。不过，在 VirtualBox 上获取 nfs 共享的过程有点复杂：

[https://www.virtualbox.org/wiki/Sharing_files_on_OSE](https://www.virtualbox.org/wiki/Sharing_files_on_OSE)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-12T11:11:16.000

我在[github.com](https://github.com/pypa/virtualenv/issues/209#issuecomment-64207886)上看到了这个解决方案：

> 将 virtualenv 升级到最新版本（1.11.6），并将其用作
> 
> ```
> virtualenv --always-copy testenv 
> ```
> 
> 选项不会使用硬链接，而是复制文件

# aptana - Aptana Studio 3 SHIFT+ENTER 选项选择

> ID：11265092
> 
> 赞同：0
> 
> 时间：2012-06-29T15:56:44.917
> 
> 标签：aptana

现在在 Aptana 中，当我们执行 SHIFT+ENTER 时，它会带来两个选择：

*   新方法 - 按 1
*   在当前行之后插入新行 - 按 2

我想将其默认为第二个选项，但我还没有找到任何选项。帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T08:43:52.560

这对我有用

1.  在命令下找到显示您要更改的键绑定的捆绑包
2.  找到绑定的名称
3.  在命令 > #BINDING# > 编辑绑定下
4.  卢布项目将出现在项目资源管理器中
5.  在命令文件夹下找到命令并在 .rb 文件中更新其绑定
6.  重新启动 Aptana

# ruby-on-rails - Rails：下拉菜单

> ID：11265093
> 
> 赞同：0
> 
> 时间：2012-06-29T15:56:49.893
> 
> 标签：ruby-on-rails, drop-down-menu, menu

环境：Rails 3.2.3

我正在编辑这个问题以包含帮助模块的源代码，以及这里的建议：

这是我第一次尝试在 Rails 应用程序中创建下拉菜单。我尝试寻求有关该主题的帮助，但复杂的是术语下拉菜单用于实际的下拉菜单（页面菜单），以及问题中的下拉列表，表单选项，表单选择等是什么，以及论坛，很难找到我正在寻找的信息。

我找到了指向[https://github.com/dkeskar/rails-jquery-dropdown](https://github.com/dkeskar/rails-jquery-dropdown)的指针（源代码在帖子末尾）并按照说明下载了 jquery_dropdown_helper.rb: ) 并将其放在 /lib

在我的 Gemfile 中，我有以下内容：

```
gem 'jquery-rails' 
```

在 _header.html.erb 中，我有以下内容：

```
<% require 'jquery_dropdown_helper' %>
....
<%= hidden_field_tag :sort_criteria %>
<%= dropdown_tags :sort_criteria, 'Select Criteria',
    %w(Category Status Amount-High Amount-Low) %> 
```

但这不起作用。这是我得到的错误代码：

```
undefined method `gsub' for :sort_criteria:Symbol 
```

我查看了跟踪，似乎 jquery_dropdown_helper.rb 中的这一行是问题所在：

```
id = options[:id] || "#{field.gsub(/[[]\s]/, '-')}-selector" 
```

有任何想法吗？

# 下拉菜单问题的解决方案

我正在寻找一种在我的 rails 应用程序中使用下拉菜单的方法，但无法得到这个问题的答案。经过几天的研究，我确实找到了一个解决方案，使用 Twitter gem 'twitter-bootstrap-rails'。

将以下内容添加到您的 Gemfile 中：

```
gem 'twitter-bootstrap-rails' 
```

将以下内容添加到您的 app/assets/javascripts/application.js

确保它按照这个确切的顺序：

```
//= require jquery
//= require jquery_ujs
//= require_tree .
//= require bootstrap 
```

然后，在您想要下拉菜单的地方，添加以下内容：

```
 <ul class="nav nav-pills">
            <li class="dropdown" id="admin_menu">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#admin_menu">
                ADMIN
              </a>
              <ul class="dropdown-menu">
                <% Admin_menu.each do |menu_text,menu_action| %>
                    <li><a href=" <%= menu_action %>"><%= menu_text %></a></li>
                <% end %>
              </ul>
            </li>
          </ul> 
```

请注意，我有以下哈希：

```
Admin_menu = Hash.new
Admin_menu["Events"] = "events#index"
Admin_menu["Categories"] = "categories#index"
Admin_menu["Panels"] = "panels#index" 
```

假设您有以下内容的脚手架：事件、类别和面板，它应该都可以工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:50:35.123

jquery_dropdown_helper.rb 不提供名为 sort_criteria 的方法。我认为这个例子应该是：

```
<% require 'jquery_dropdown_helper' %>
....
<%= hidden_field_tag :sort_criteria %>
<%= dropdown_tags :sort_criteria, 'Select Criteria',
    %w(Category Status Amount-High Amount-Low) %> 
```

:sort_criteria 只是表单元素的名称，可以是符号或字符串（即 :sort_criteria 或 'sort_criteria'）

# api - 如何使用 spotify 应用程序 API 在 Spotify 应用程序中创建播放列表的 URI？

> ID：11265102
> 
> 赞同：0
> 
> 时间：2012-06-29T15:57:24.867
> 
> 标签：api, uri, spotify

我已经阅读了这个问题：[如何创建播放列表并在 spotify 应用程序 API 中获取它的 URI？](https://stackoverflow.com/questions/8802989/how-to-create-a-playlist-and-get-the-uri-of-it-in-a-spotify-apps-api?rq=1)

但我想知道现在是否可以这样做，或者如果你能给我一个解决方案，我真的需要 URI，我可以创建一个公共播放列表或类似的东西吗？我需要它来创建一个类似于 soundrop 的应用程序 :)

十分感谢

萨拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T22:55:11.940

我相信今天是可能的。下面的 CoffeeScript 示例对我有用

```
sp = getSpotifyApi 1
models = sp.require 'sp://import/scripts/api/models'

exports.exports.init = ->
  playlist = new models.Playlist()
  console.log "The temporary playlist is " + playlist.uri 
```

# c# - 通过 MySQL 更新时出现错误输入字符串的格式不正确

> ID：11265103
> 
> 赞同：0
> 
> 时间：2012-06-29T15:57:26.693
> 
> 标签：c#, mysql

`"Input string was not in a correct format"`尝试通过 MySQL .NET 连接器更新表时出现错误。

通过 MySQL 工作台运行更新语句时工作正常，但不能通过代码运行，我希望有人能告诉我原因。

代码是：

```
MySqlCommand command = new MySqlCommand();
command.Connection = conn;
command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where amazonOrderId like '" + amazonOrderId + "%';";
command.ExecuteNonQuery(); 
```

我尝试过作为非查询和 ExecuteReader(); 执行 没有运气。

我确信这是我犯的一个简单的错误，但我似乎一辈子都找不到它，所以任何帮助都将不胜感激。

-- 编辑 -- 我试过以下没有运气：

```
MySqlCommand command = new MySqlCommand();
command.Connection = conn;
command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where amazonOrderId like '@amazonOrderId';";
command.Parameters.AddWithValue("@amazonOrderId", amazonOrderId); 
```

还将 CommandText 更改为：

```
 command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where convert(varchar(50), amazonOrderId) like '" + amazonOrderId + "';"; 
```

和

```
 command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where amazonOrderId = '@amazonOrderId';"; 
```

和

```
command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where amazonOrderId = @amazonOrderId;"; 
```

- 解析度 -

我的解决方案实际上是在另一段代码中找到的。在多次运行调试器后，很明显 MySqlConnection 对象试图被实例化两次 - 使用相同的名称等。我删除了第二个实例化，它已经解决了这个问题。太糟糕了，错误误导了。

我感谢每个人的回复，因为我觉得他们让我的代码变得更好，因此我给 Jon、Steve 和 Chris 打了 +1。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:59:46.163

变量是`amazonOrderId`数字吗？如果是这样，如果不对变量调用 ToString() 就不能 + 一个字符串。

```
amazonOrderId.ToString() + "%" 
```

amazonOrderId 是数据库中的数字吗？如果是这样，您是否尝试过转换（varchar）？

```
MySqlCommand command = new MySqlCommand(); 
command.Connection = conn; 
command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where convert(varchar(50), amazonOrderId) like @OrderID;"; 
command.Parameters.AddWithValue("@orderID", amazonOrderId + "%");  
command.ExecuteNonQuery(); 
```

但我不确定你为什么需要 LIKE 和 %。这是否也会更新：

```
1001 - amazon order id
10010
10011
10012
10013 
etc. 
```

那是你真正想要的吗？

如果不是，则使用 equal 代替，不带单引号。

```
MySqlCommand command = new MySqlCommand(); 
command.Connection = conn; 
command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where amazonOrderId = @OrderId;"; 
command.Parameters.AddWithValue("@orderID", amazonOrderId);  
command.ExecuteNonQuery(); 
```

如果它是您想要的，那么为什么不使用 between 或大于？

```
MySqlCommand command = new MySqlCommand(); 
command.Connection = conn; 
command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where amazonOrderId > @OrderId;"; 
command.Parameters.AddWithValue("@orderID", int.Parse(amazonOrderId.ToString() + "0"));  
command.ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:01:37.627

可能你需要使用参数

```
MySqlCommand command = new MySqlCommand(); 
command.Connection = conn; 
command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where amazonOrderId like @orderID"; 
command.Parameters.AddWithValue("@orderID", amazonOrderId + "%");
command.ExecuteNonQuery(); 
```

这将避免参数值为字符串且包含单引号时的错误，并防止[SqlInjection 攻击](http://en.wikipedia.org/wiki/SQL_injection)。上面的代码假设`amazonOrderID`数据库中的字段是文本数据类型，`amazonOrderID`变量是字符串类型。

但是，错误消息说它无法识别输入字符串。
这导致了**真正的问题**。`amazonOrderID`数据库表中有什么样的列？它是 varchar （或其他文本类型）？还是数字数据类型？

如果它是文本类型，那么如果代码中的 var 也是字符串，则带有`like`和 参数的语法应该可以工作。 如果列是数字数据类型，则没有意义，您应该使用运算符更改查询，并确保var 是数字类型。`amazonOrderID`
`LIKE``=``amazonOrderID`

```
MySqlCommand command = new MySqlCommand(); 
command.Connection = conn; 
command.CommandText = "update fulfilled_shipments_data set addedCustomer=1 where amazonOrderId = @orderID"; 
command.Parameters.AddWithValue("@orderID", amazonOrderId);
command.ExecuteNonQuery(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T15:06:32.900

我的解决方案实际上是在另一段代码中找到的。在多次运行调试器后，很明显 MySqlConnection 对象试图被实例化两次 - 使用相同的名称等。我删除了第二个实例化，它已经解决了这个问题。太糟糕了，错误误导了。

# javascript - 表格行的内部 HTML

> ID：11265108
> 
> 赞同：-4
> 
> 时间：2012-06-29T15:57:59.380
> 
> 标签：javascript, jquery, html, css

我是 JavaScript 和 jQuery 的新手。这是我的问题。

我有一张桌子：我想找出其中`tr`有`td`一个`innerHTML`，或者`Weekly`。在里面我必须找到并突出显示 具有特定颜色的文本。`Daily``monthly``tr``td``innerHTML``hello`

这是我迄今为止尝试过的小提琴链接。 [http://jsfiddle.net/Adeyemi/gXGj6/8/](http://jsfiddle.net/Adeyemi/gXGj6/8/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T23:57:46.727

如果我正确理解你的问题和你的小提琴 - 你想要这样的东西。

![在此处输入图像描述](../Images/914fb2f805c03f18bfbd0f4f71aaaa2e.png)

这是小提琴链接：http: [//jsfiddle.net/gXGj6/12/](http://jsfiddle.net/gXGj6/12/)

```
var myrow = $(".mtt");
$('td', myrow).each(function() {        
    if (this.innerHTML == 'Hello')
    {
        var title = this.parentNode.getElementsByTagName('td')[1].innerHTML;
        var colour = 'none';  
        switch(title) 
        {            
            case "Weekly":
                colour = 'green';
                break;
            case "Hourly":   
                colour = 'red';
                break;
            case "Daily":    
                colour = 'yellow';
                break;  
        }
        this.style.backgroundColor = colour;
    }
}); 
```

# java - Arquillian 和 CDI

> ID：11265109
> 
> 赞同：0
> 
> 时间：2012-06-29T15:58:00.030
> 
> 标签：java, dependency-injection, cdi, jboss-arquillian

我正在阅读写得很好的 Arquillian 参考指南，但是在讨论设置依赖注入的章节中，我找不到您实际指定 bean/绑定的位置。

大多数 Arquillian CDI 代码示例都显示了 Java`@Inject`注释的使用。所以我只是想知道，我在哪里定义这些 bean/DI 映射/绑定，以及如何配置 Arquillian 来使用它们？

**在 Spring DI 中，您指定一个 bean 描述符，例如`spring-config.xml`. 在 Guice 中，您实现 a`Module`并定义它的`configure(Binder)`方法。使用时，这在 Arquillian-land 中是什么样子的`javax.inject.Inject`？**提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:18:39.823

**简短的回答**- 无需在 CDI 中定义 bean 映射，因为 CDI 专门使用注释。您可以在配置文件中添加额外信息，但这通常不是必需的。

**长答案**最好从这个对 CDI的[出色介绍中得到。](http://docs.jboss.org/weld/reference/latest/en-US/html/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T18:01:45.860

我认为你需要使用[“Alternatives”](http://docs.jboss.org/weld/reference/latest/en-US/html_single/#alternatives) CDI 机制

> 替代方案是其实现特定于特定客户端模块或部署场景的 bean。

# python - GTK::Socket 和 Gtk::Plug 在 Gnome 和 FVWM2 下的意外行为

> ID：11265110
> 
> 赞同：1
> 
> 时间：2012-06-29T15:58:02.953
> 
> 标签：python, gtk, pygtk, gnome, vpython

如果在 FVWM2 中运行，以下代码可以正常工作。但是，如果您将桌面更改为 Gnome，则嵌入的窗口将被破坏而不是被嵌入。

**这是为什么？** 我错过了什么？...

代码如下，但基本上它所做的只是分叉。在孩子中，我们创建一个 VPython 窗口并让它永远闲置。在父窗口中，我们创建一个 GTK 窗口，找出子窗口的窗口 ID，并尝试将其嵌入到 GTK::Socket 中。

请注意，VPython 部分可能与此无关。

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import subprocess
import sys
import os
import re
import time
from visual import *

def find_window_id (title):
    """Gets the OpenGL window ID."""
    pattern = re.compile('0x[0-9abcdef]{7}')
    proc = subprocess.Popen(['xwininfo', '-name', title],
            stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    errors = proc.stderr.readlines()
    if errors:
        return None
    for line in proc.stdout.readlines():
        match = pattern.findall(line)
        if len(match):
            return long(match[0], 16)
    return None

class Setting ():
    """VPython/OpenGL class."""

    def __init__ (self, w=256, h=256, title='OpenGL via VPython'):
        """Initiator."""
        self.width = w
        self.height = h
        self.title = title
        self.scene = display.get_selected() 
        self.scene.title = self.title
        self.scene.width = self.width
        self.scene.height = self.height
        self.sphere = sphere()

class GTKDisplay ():

    def __init__ (self, winID):
        """Initiator: Draws the GTK GUI."""
        import gtk
        import pygtk
        self.OpenGLWindowID = winID
        window = gtk.Window()
        window.show()
        socket = gtk.Socket()
        socket.show()
        window.add(socket)
        window.connect("destroy", lambda w: gtk.main_quit())
        socket.add_id(long(self.OpenGLWindowID))
        gtk.main()

def main ():
    """Main entry point."""
    name = 'sphere OpenGL window'
    child_pid = os.fork()
    if 0 == child_pid:
        sut = Setting(title=name)
    else:
        winID = None
        while not winID:
            time.sleep(.1)
            winID = find_window_id(name)
        try:
            gui = GTKDisplay(winID)
        except KeyboardInterrupt, err:
            print '\nAdieu monde cruel!'

if __name__ == "__main__":
    main() 
```

*[PS：是的，这是这个问题](https://stackoverflow.com/q/10934787/232794)的后续。*

# php - 使用 PHP 识别当前页面

> ID：11265112
> 
> 赞同：0
> 
> 时间：2012-06-29T15:58:08.393
> 
> 标签：php, url, conditional

我有一系列 PHP 页面，我想使用条件逻辑对每个页面应用不同的规则。我不确定我的方法是否是最好的方法，所以我想看看社区是否有任何建议，因为这感觉不是最好的方法。下面的代码：

```
<?php

     $nameurl = $_SERVER["REQUEST_URI"];

     if ($nameurl == "/fs/about.php"){
         echo "about page";
     }

     elseif ($nameurl == "/fs/index.php"){
         echo "home page";
     }
?> 
```

理想情况下，我只想使用文件名（index.php 或 about.php）而不是 /fs/。我不确定是否有另一种将 $_SERVER 与 PHP 一起使用的方法，但似乎有一种更有效和可重用的方式来编写它。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:03:25.537

你可以使用

```
// get script name
$script     = explode('/', $_SERVER['PHP_SELF']);
$scriptname = $script[count($script) - 1];

switch ($scriptname) {
    case "index.php":
        // Something you only want to show on this page
    break;

    case "about.php":
        // Something you only want to show on this page
    break;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:03:31.700

为了节省几行代码，您可以用开关替换多个 if：

[http://php.net/manual/en/control-structures.switch.php](http://php.net/manual/en/control-structures.switch.php)

```
$nameurl = $_SERVER["REQUEST_URI"];
switch ($nameurl) {
    case "/fs/about.php":
        echo "about page";
        break;
    case "/fs/index.php":
        echo "home page";
        break;
    default:
        echo "unknown page";
        break;
} 
```

使将来添加新案例变得更加容易，但它本质上是在做同样的事情......

可能有办法让它更优化，但我认为如果你开始做太多事情，你就会失去轻松理解代码中发生的事情的能力，所以除非你评论你在做什么，否则未来的人会诅咒你. :P

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:04:21.633

试试这个

```
$nameurl = basename($_SERVER['REQUEST_URI'], '.php');
echo $nameurl, " page"; 
```

[http://php.net/manual/en/function.basename.php](http://php.net/manual/en/function.basename.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T16:06:58.883

你可以试试：

```
$currentFile = $_SERVER["PHP_SELF"];
$current_filename = explode('/', $currentFile); 
```

或者

```
$current_filename = basename($_SERVER['REQUEST_URI']) .'php'; 
```

# python - 计算 pandas DataFrame 中一组列的平均值的最有效方法

> ID：11265116
> 
> 赞同：1
> 
> 时间：2012-06-29T15:58:11.590
> 
> 标签：python, pandas

我有一个`DataFrame`这样的列：

```
["A_1", "A_2", "A_3", "B_1", "B_2", "B_3"] 
```

我想将各个 A 列和 B 列“折叠”在一个列中并计算它们的平均值。简而言之，在操作结束时，我会得到：

```
["A", "B"] 
```

其中“A”是所有“A”列的按列平均值，“B”是所有“B”列的平均值。

据我了解，`groupby`不适合这项任务，或者我使用不正确：

```
grouped = data.groupby([item for item in data if "A" not in item]) 
```

如果我使用`axis=1`，我在调用 mean() 时得到的只是一个空的 DataFrame，如果不是，我没有得到想要的效果。我想避免构建一个单独的 DataFrame 来通过迭代填充手段（例如，通过分别计算手段然后添加它们`new_df["A"] = mean_a`）。有没有有效的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T02:59:34.797

`mean()`您想利用接受参数的内置函数`axis`来指定逐行均值。由于您知道您想要的不同方式的特定列名称约定，因此您可以使用下面的示例代码非常有效地执行此操作。在这里，我选择只添加两个额外的列，而不是实际销毁现有数据。我也可以将这些新列放入一个新的数据框中；这仅取决于您的需求以及对您来说方便的方式。无论哪种情况，相同的基本思想都适用。

```
In [1]: import pandas

In [2]: dfrm = pandas.DataFrame([[1,2,3,4,5,6],[7,8,9,10,11,12],[13,14,15,16,17,18]], columns = ['A_1', 'A_2', 'A_3', 'B_1', 'B_2', 'B_3'])

In [3]: dfrm
Out[3]: 
   A_1  A_2  A_3  B_1  B_2  B_3
0    1    2    3    4    5    6
1    7    8    9   10   11   12
2   13   14   15   16   17   18

In [4]: dfrm["A_mean"] = dfrm[[elem for elem in dfrm.columns if elem[0]=='A']].mean(axis=1)

In [5]: dfrm
Out[5]: 
   A_1  A_2  A_3  B_1  B_2  B_3  A_mean
0    1    2    3    4    5    6       2
1    7    8    9   10   11   12       8
2   13   14   15   16   17   18      14

In [6]: dfrm["B_mean"] = dfrm[[elem for elem in dfrm.columns if elem[0]=='B']].mean(axis=1)

In [7]: dfrm
Out[7]: 
   A_1  A_2  A_3  B_1  B_2  B_3  A_mean  B_mean
0    1    2    3    4    5    6       2       5
1    7    8    9   10   11   12       8      11
2   13   14   15   16   17   18      14      17 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T16:18:18.323

我不知道效率，但我可能会做这样的事情：

```
~/coding$ cat colgroup.dat
A_1,A_2,A_3,B_1,B_2,B_3
1,2,3,4,5,6
7,8,9,10,11,12
13,14,15,16,17,18
~/coding$ python
Python 2.7.3 (default, Apr 20 2012, 22:44:07) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import pandas
>>> df = pandas.read_csv("colgroup.dat")
>>> df
   A_1  A_2  A_3  B_1  B_2  B_3
0    1    2    3    4    5    6
1    7    8    9   10   11   12
2   13   14   15   16   17   18
>>> grouped = df.groupby(lambda x: x[0], axis=1)
>>> for i, group in grouped:
...     print i, group
... 
A    A_1  A_2  A_3
0    1    2    3
1    7    8    9
2   13   14   15
B    B_1  B_2  B_3
0    4    5    6
1   10   11   12
2   16   17   18
>>> grouped.mean()
key_0   A   B
0       2   5
1       8  11
2      14  17 
```

我想`lambda x: x.split('_')[0]`会更健壮一些。

# database - Django：如何部署生产数据库

> ID：11265117
> 
> 赞同：0
> 
> 时间：2012-06-29T15:58:13.623
> 
> 标签：database, django, deployment, production

我正在观看 DjangoCon 2011 的演讲：http: [//ontwik.com/python/pycon-2011-deploying-django-web-applications-to-the-cloud/](http://ontwik.com/python/pycon-2011-deploying-django-web-applications-to-the-cloud/)和 Cosmin Stejerean（主持人）提到这不是一个好在生产数据库上做同步数据库的想法。那么什么是部署生产数据库的好方法呢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:35:30.357

如果没有上下文，很难知道他对那句话的意思。稍后观看这些视频可能会很有趣，但我现在没有时间进行 3 小时的演讲。（也许如果你给出了陈述发生的时间码，人们会更容易向你解释。）

无论如何，在*某些*时候您必须在生产数据库上运行 syncdb。我想他会在初次运行后和您的网站上线后再次运行syncdb，因为他的声明在那时会更加神秘，但即便如此，如果您要添加新模型，您几乎*必须*这样做. 你不能真正替换你的生产数据库，因为它上面有可能随时改变的*实时*数据（排除做一些事情，比如制作一个副本，在上面运行syncdb，然后从中恢复生产数据库——你将不可避免地失去该方法中的数据）。

所以，再一次，也许结合上下文，它可能更有意义，但从表面上看，这不仅*不是*一个坏主意，而且它确实是唯一可以接受的课程。

# linux - 我们需要 EXPORT_SYMBOL 和头文件声明吗

> ID：11265121
> 
> 赞同：0
> 
> 时间：2012-06-29T15:58:30.563
> 
> 标签：linux, export, symbols

我是linux内核的新手。我已经搜索了一点 EXPORT_SYMBOL 但我仍然有点困惑。我知道它用于将一个模块中定义的变量或函数导出到另一个模块。这是否意味着通过使用它，我们不需要包含任何声明该变量或函数的头文件？还是两者都需要？如果两者都需要，为什么我们需要 EXPORT_SYMBOL？谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:53:35.437

头文件用于编译器。EXPORT_SYMBOL 用于模块加载器。这允许[将模块代码与内核代码适当分离](https://stackoverflow.com/questions/6670589/use-of-export-symbol)。

# android - 在 android 的 Listview 中不执行滚动

> ID：11265125
> 
> 赞同：0
> 
> 时间：2012-06-29T15:58:50.597
> 
> 标签：android

我有一个问题，我通过代码在 LinearLayout 中动态添加 listview 并将 EndlessAdapter 设置到其中，数据显示正确，但我们无法在列表中从上到下滚动。我不知道为什么？请向我建议任何有关相同的解决方案。

**代码：**

```
public void setValuesInCategoryChild(String url, final String filter, final String from, final String to) {
    if (isOnline()) {
        final ProgressDialog dialog = ProgressDialog.show(ResearchList.this, "Research List       ", "Please wait...   ", true);
        final Handler handler = new Handler() {
        public void handleMessage(Message msg) {
            // System.out.println("The id after Save:"+id.get(0).toString());
            // catagory.addAll(keyword_vector1);
            linear_Category_Child.setVisibility(View.GONE);
            linear_Category_Child_Child.setVisibility(View.VISIBLE);
            // tv_Child_Header.setText("Volvo");
            tv_CategoryChildHeader.setText(from);
            setHeaderImage(tv_CategoryChildHeader.getText().toString());
            System.out.println("The size of Cat Display names:" + coll.getDisplayNames().size());
            System.out.println("The size of Cat Images:" + coll.getImages().size());
            System.out.println("The size of Cat price:" + coll.getPrice().size());
            System.out.println("The size of Cat Year:" + coll.getYears().size());
            System.out.println("The size of Cat Rating:" + coll.getRating().size());
            System.out.println("The size of Cat Mpg:" + coll.getMpg().size());
            setHeaderImage(tv_CategoryChildHeader.getText().toString());
            if(coll.getDisplayNames().size()!=0) {
                lvCategory = new ListView(ResearchList.this);
                LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT);
                lvCategory.setLayoutParams(params);

                // Adapter for MPG Search
                demoAdapterCat = new DemoAdapterCat();
                lvCategory.setAdapter(demoAdapterCat);
                layout_ResearchList_BrandList.addView(lvCategory);
                Utility.setListViewHeightBasedOnChildren(lvCategory);
            }else {
                /*lvCategory.invalidate();
                lvCategory.setAdapter(null);*/
                AlertDialog.Builder builder = new Builder(ResearchList.this);
                builder.setTitle("Attention!");
                builder.setMessage("No Data Available for the Particular Search.");
                builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        // TODO Auto-generated method stub
                    }
                });

                builder.create().show();
            }
            /*Utility util = new Utility();
            util.setListViewHeightBasedOnChildren(lvCategory);*/
            dialog.dismiss();
        }
    };
    final Thread checkUpdate = new Thread() {
        public void run() {
            try {
                String sortEncode = URLEncoder.encode("mpg");
                String filterEncode = URLEncoder.encode(filter);
                String clientEncode = URLEncoder.encode("10030812");
                String fromEncode = URLEncoder.encode(from);
                String toEncode = URLEncoder.encode(to);
                String catUrl = "/v1/vehicles/get-make-models.json?sort=" + sortEncode + "&filter=" + filterEncode + "&client-id=" + clientEncode + "&from=" + fromEncode;
                genSig = new GetSignature(catUrl, "acura");
                try {
                    signature = genSig.getUrlFromString();
                } catch (InvalidKeyException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                } catch (NoSuchAlgorithmException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
                // jsonString =
                // getJsonSring("http://api.highgearmedia.com/v1/vehicles/get-models.json?make=acura&client-id=10030812&signature=LWQbdAlJVxlXZ1VO2mfqAA==");
                // String signatureEncode =
                // URLEncoder.encode(signature);
                String urlEncode = URLEncoder.encode(catUrl + "&signature=" + signature);
                jsonString = getJsonSring("http://apibeta.highgearmedia.com" + catUrl + "&signature=" + signature);
                System.out.println("The json category:===>" + jsonString);
            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (URISyntaxException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            JsonParse json = new JsonParse(jsonString);
            json.parseCat();
            LIST_SIZE = coll.getDisplayNames().size();
            for (int i = 0; i <= BATCH_SIZE; i++) {
                // countriesSub.add(COUNTRIES[i]);
                countriesSubCat.add(coll.getDisplayNames().get(i));
                imagesSubCat.add(coll.getImages().get(i));
                YearSubCat1.add(coll.getYears().get(i));
                YearSubCat2.add(coll.getYears().get(i + 1));
                mpgSubCat1.add(coll.getMpg().get(i));
                mpgSubCat2.add(coll.getMpg().get(i + 1));
                priceSubCat1.add(coll.getPrice().get(i));
                priceSubCat2.add(coll.getPrice().get(i + 1));
                ratingSubCat1.add(coll.getRating().get(i));
                ratingSubCat2.add(coll.getRating().get(i + 1));
            }
            setLastOffset(BATCH_SIZE);
            handler.sendEmptyMessage(0);
        }
    };
    checkUpdate.start();
} else {
    AlertDialog.Builder builder = new Builder(ResearchList.this);
    builder.setTitle("Attention!");
    builder.setMessage("Network Connection unavailable.");
    builder.setPositiveButton("OK",
    new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
            // TODO Auto-generated method stub
        }
    });
    builder.create().show();
}
} 
```

**布局：**

```
<LinearLayout
    android:id="@+id/linear_ResearchListCategoryChild_Child"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:visibility="gone" >

    <RelativeLayout
        android:id="@+id/linear_ResearchListCategoryChild_Child_HeaderBlock"
        android:layout_width="fill_parent"
        android:layout_height="40dip"
        android:background="@drawable/catagory_bar"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/tv_ResearchListCategoryChild_Child_Header"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerVertical="true"
            android:text="Work in Progress"
            android:textColor="#ffffff"
            android:textStyle="bold" android:layout_marginLeft="60dip"/>

        <ImageView
            android:id="@+id/img_ResearchListCategory_ChildHeader"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:layout_marginLeft="10dip"
            android:src="@drawable/up_arrow" />

        <ImageView
            android:id="@+id/imageView2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true"
            android:layout_marginRight="10dp"
            android:src="@drawable/list_arrow_up" />

    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/linear_ResearchListCategoryChild_Child_Header"
        android:layout_width="fill_parent"
        android:layout_height="40dip"
        android:background="@drawable/nav_bg"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/textView5"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:layout_marginLeft="5dip"
            android:clickable="true"
            android:text="Highest Rated"
            android:textColor="#ffffff"
            android:textStyle="bold" android:gravity="center"/>

        <TextView
            android:id="@+id/textView6"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBaseline="@+id/textView5"
            android:layout_alignBottom="@+id/textView5"
            android:layout_marginLeft="30dp"
            android:layout_toRightOf="@+id/textView5"
            android:clickable="true"
            android:text="A-Z"
            android:textColor="#ffffff"
            android:textStyle="bold" android:gravity="center"/>

        <TextView
            android:id="@+id/textView7"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBaseline="@+id/textView6"
            android:layout_alignBottom="@+id/textView6"
            android:layout_marginLeft="40dp"
            android:layout_toRightOf="@+id/textView6"
            android:clickable="true"
            android:text="Price"
            android:textColor="#ffffff"
            android:textStyle="bold" android:gravity="center"/>

        <TextView
            android:id="@+id/textView8"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBaseline="@+id/textView7"
            android:layout_alignBottom="@+id/textView7"
            android:layout_alignParentRight="true"
            android:layout_marginRight="14dp"
            android:clickable="true"
            android:text="MPG"
            android:textColor="#ffffff"
            android:textStyle="bold" android:gravity="center"/>
    </RelativeLayout>

                <!--
                <RelativeLayout 
                    android:id="@+id/relative_down_arrow"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:visibility="visible"
                    >

                </RelativeLayout>

                -->

                <LinearLayout
                    android:id="@+id/linearArrowLayout"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:orientation="horizontal"
                    android:visibility="visible">

                    <ImageView
                        android:id="@+id/Highly_rated"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="51dp"
                        android:src="@drawable/selector_arrow"
                        android:visibility="invisible" />

                    <ImageView
                        android:id="@+id/AZ_arrow"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="78dp"
                        android:src="@drawable/selector_arrow"
                        android:visibility="invisible" />

                    <ImageView
                        android:id="@+id/Price_arrow"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="59dp"
                        android:src="@drawable/selector_arrow"
                        android:visibility="invisible" />

                    <ImageView
                        android:id="@+id/MPG"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="55dp"
                        android:src="@drawable/selector_arrow"
                        android:visibility="invisible" />
                </LinearLayout>
                <LinearLayout 
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginLeft="12dip"
                    android:layout_marginRight="12dip" android:background="#ffffff" android:id="@+id/layout_ResearchList_BrandList">
                </LinearLayout>
            </LinearLayout> 
```

**演示适配器猫：**

```
class DemoAdapterCat extends EndlessAdapter {
        ImageLoader image = new ImageLoader(ResearchList.this);
        private RotateAnimation rotate = null;
        ArrayList<String> tempListNamesCat = new ArrayList<String>();
        ArrayList<String> tempListImagesCat = new ArrayList<String>();
        ArrayList<String> tempListYearCat1 = new ArrayList<String>();
        ArrayList<String> tempListYearCat2 = new ArrayList<String>();
        ArrayList<String> tempListmpgCat1 = new ArrayList<String>();
        ArrayList<String> tempListmpgCat2 = new ArrayList<String>();
        ArrayList<String> tempListpriceCat1 = new ArrayList<String>();
        ArrayList<String> tempListpriceCat2 = new ArrayList<String>();
        ArrayList<String> tempListRatingCat1 = new ArrayList<String>();
        ArrayList<String> tempListRatingCat2 = new ArrayList<String>();

        DemoAdapterCat() {
            super(new CategoryListLazyAdapter(ResearchList.this,
                    countriesSubCat, imagesSubCat, YearSubCat1, YearSubCat2,
                    mpgSubCat1, mpgSubCat2, priceSubCat1, priceSubCat2,
                    ratingSubCat1, ratingSubCat2));
            /*Utility util = new Utility();
            util.setListViewHeightBasedOnChildren(lvCategory);*/
            rotate = new RotateAnimation(0f, 360f, Animation.RELATIVE_TO_SELF,
                    0.5f, Animation.RELATIVE_TO_SELF, 0.5f);
            rotate.setDuration(600);
            rotate.setRepeatMode(Animation.RESTART);
            rotate.setRepeatCount(Animation.INFINITE);
        }

        /*
         * @Override public int getCount() { return
         * brandList.getDisplayNames().size(); //return count+=10; }
         */
        @Override
        protected View getPendingView(ViewGroup parent) {
            row = getLayoutInflater().inflate(R.layout.categorylist, null);

            child = row.findViewById(R.id.tv_CategoryItem_Name);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.tv_CategoryItem_MPG1);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.tv_CategoryItem_MPG2);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.tv_CategoryItem_Price1);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.tv_CategoryItem_Price2);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.tv_CategoryItem_Rating1);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.tv_CategoryItem_Rating2);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.tv_CategoryItem_Year1);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.tv_CategoryItem_Year2);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.linear_CategoryList_itemlayer1);
            child.setVisibility(View.GONE);
            child = row.findViewById(R.id.linear_CategoryList_itemlayer2);
            child.setVisibility(View.GONE);
            /*
             * child = row.findViewById(R.id.img_CategoryItem);
             * child.setVisibility(View.GONE); child =
             * row.findViewById(R.id.img_CategoryItem_Arrow);
             * child.setVisibility(View.GONE);
             */

            /*
             * child = row.findViewById(R.id.linear_main_MPG);
             * child.setVisibility(View.GONE);
             */
            child = row.findViewById(R.id.throbber);
            child.setVisibility(View.VISIBLE);
            child.startAnimation(rotate);

            return (row);
        }

        @Override
        protected boolean cacheInBackground() {
            //count += 10;
            SystemClock.sleep(100000);
            tempListNamesCat.clear();
            tempListImagesCat.clear();
            tempListmpgCat1.clear();
            tempListmpgCat2.clear();
            tempListpriceCat1.clear();
            tempListpriceCat2.clear();
            tempListYearCat1.clear();
            tempListYearCat2.clear();
            tempListRatingCat1.clear();
            tempListRatingCat2.clear();
//          countriesSubCat.clear();
//          imagesSubCat.clear();
//          YearSubCat1.clear();
//          YearSubCat2.clear();
//          mpgSubCat1.clear();
//          mpgSubCat2.clear();
//          priceSubCat1.clear();
//          priceSubCat2.clear();
//          ratingSubCat1.clear();
//          ratingSubCat2.clear();

            int lastOffset = getLastOffset();
            if (lastOffset < LIST_SIZE) {
                int limit = lastOffset + BATCH_SIZE;
                for (int i = (lastOffset + 1); (i <= limit && i < LIST_SIZE); i++) {
                    tempListNamesCat.add(coll.getDisplayNames().get(i));
                    tempListImagesCat.add(coll.getImages().get(i));
                    tempListmpgCat1.add(coll.getMpg().get(i));
                    tempListmpgCat2.add(coll.getMpg().get(i + 1));
                    tempListpriceCat1.add(coll.getPrice().get(i));
                    tempListpriceCat2.add(coll.getPrice().get(i + 1));
                    tempListRatingCat1.add(coll.getRating().get(i));
                    tempListRatingCat2.add(coll.getRating().get(i + 1));
                    tempListYearCat1.add(coll.getYears().get(i));
                    tempListYearCat2.add(coll.getYears().get(i + 1));
                }

                setLastOffset(limit);

                if (limit < LIST_SIZE) {
                    // return true;
                    return (getWrappedAdapter().getCount() < coll
                            .getDisplayNames().size());
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }

        @Override
        protected void appendCachedData() {

            @SuppressWarnings("unchecked")
            // Activity activity = this;
            // ArrayAdapter<String> arrAdapterNew =
            // (ArrayAdapter<String>)getWrappedAdapter();
            CategoryListLazyAdapter arrAdapterNewCategory = (CategoryListLazyAdapter) getWrappedAdapter();
            // int listLen = tempList.size();
            // int listLen = tempListNames.size();
            countriesSubCat.addAll(tempListNamesCat);
            imagesSubCat.addAll(tempListImagesCat);
            mpgSubCat1.addAll(tempListmpgCat1);
            mpgSubCat2.addAll(tempListmpgCat2);
            priceSubCat1.addAll(tempListpriceCat1);
            priceSubCat2.addAll(tempListpriceCat2);
            ratingSubCat1.addAll(tempListRatingCat1);
            ratingSubCat2.addAll(tempListRatingCat2);
            YearSubCat1.addAll(tempListYearCat1);
            YearSubCat2.addAll(tempListYearCat2);
            arrAdapterNewCategory.notifyDataSetChanged();
            /*Utility util = new Utility();
            util.setListViewHeightBasedOnChildren(lvCategory);*/
            /*
             * for(int i=0; i<listLen; i++){ //
             * arrAdapterNew.add(tempList.get(i)); }
             */
        }
    } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T10:09:22.447

尝试`ScrollView`在 xml 文件中添加一个。

# java - BufferedImage 产生黑色背景

> ID：11265128
> 
> 赞同：9
> 
> 时间：2012-06-29T15:59:00.470
> 
> 标签：java, image, background, transparency, bufferedimage

好吧，所以我正在制作一个游戏，我正在尝试通过在其上添加文本来修改原始命中标记图像，并且我正在使用以下代码：

```
import javax.swing.ImageIcon;
import javax.swing.Timer;

import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
public class HitMarker {

    public static final Image rangeHitMarker = new ImageIcon(HitMarker.class.getResource("rangeHitMarker.png")).getImage();
    public static final Image magicHitMarker = new ImageIcon(HitMarker.class.getResource("magicHitMarker.png")).getImage();
    public static final Image monsterHitMarker = new ImageIcon(HitMarker.class.getResource("monsterHitMarker.png")).getImage();

    public static final Font font = new Font("Tahoma", Font.PLAIN, 10);

    public static final Color t = new Color(0,0,0,0);

    public Image hitMarker;
    public BufferedImage image;
    public String hit;

    public int attackStyle;

    public boolean rangeAttack;
    public int x;
    public int y;

    public Timer timer;
    public boolean remove;

    public HitMarker(int x, int y, int hit, int attackStyle){
        this.hit = String.format("%d", hit);
        this.remove = false;
        this.x = x;
        this.y = y;
        this.attackStyle = attackStyle;
        this.hitMarker = getImage();
        BufferedImage bi = new BufferedImage(35, 20, BufferedImage.TYPE_INT_RGB);
        Graphics2D g = bi.createGraphics();
        g.drawImage(hitMarker, 0, 0, null);
        g.setFont(font);
        g.setColor(Color.WHITE);
        g.drawString(this.hit, 18, 13);
        g.dispose();
        image = bi;
        timer = new Timer(800,
                new ActionListener(){
            public void actionPerformed(ActionEvent e){
                remove = true;
                timer.stop();
            }
        }
        );
        timer.setInitialDelay(800);
        timer.start();
    }

    public HitMarker(int x, int y, int hit){
        this.hit = String.format("%d", hit);
        this.remove = false;
        this.x = x;
        this.y = y;
        this.hitMarker = monsterHitMarker;
        BufferedImage bi = new BufferedImage(35, 20, BufferedImage.TYPE_INT_RGB);
        Graphics2D g = bi.createGraphics();
        g.drawImage(hitMarker, 0, 0, null);
        g.setFont(font);
        g.setColor(Color.WHITE);
        g.drawString(this.hit, 18, 13);
        g.dispose();
        image = bi;
        timer = new Timer(800,
                new ActionListener(){
            public void actionPerformed(ActionEvent e){
                remove = true;
                timer.stop();
            }
        }
        );
        timer.setInitialDelay(800);
        timer.start();
    }

    public boolean isRangeAttack(){
        return attackStyle == AttackStyleConstants.RANGE || attackStyle == AttackStyleConstants.RANGE_DEFENCE ? true : false;
    }

    public Image getImage(){
        return isRangeAttack() ? rangeHitMarker : magicHitMarker;
    }

} 
```

特别关注任一构造函数：我遇到的错误是，当我创建 BufferedImage 并在缓冲图像上绘制图像时，它会自动创建黑色背景，我不知道为什么。我已经尝试研究这个主题，有人说要更改 AlphaComposite 和 g.clearRect() 方法的一些内容，但这些似乎都不起作用。顺便说一句，我在缓冲图像上绘制的图像是 35x20（这是缓冲图像的尺寸）并且它具有透明背景。如果有人能告诉我如何删除这个黑色背景，将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-29T16:12:35.893

试试`BufferedImage.TYPE_INT_ARGB`。这将使区域透明而不是黑色。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T16:13:44.267

您可能还想尝试存储 Alpha 通道，

```
 BufferedImage bi = new BufferedImage(35, 20, BufferedImage.TYPE_INT_ARGB); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-18T01:45:05.460

如果你需要一个`JPG`白色**背景**，你需要像这样绘制图像：

```
g.drawImage(hitMarker, 0, 0, Color.WHITE, null); 
```

这样，您可以在从`PNG`到时避免黑色背景`JPG`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-26T11:03:33.893

使用 png 而不是 jpeg。Png 非常适合透明度操作。这是简单的 png 导出代码片段；

```
 BufferedImage bImage = new BufferedImage(640, 480, BufferedImage.TYPE_INT_ARGB);
        Graphics2D g2d = (Graphics2D) bImage.getGraphics();
        DrawingContext context = new DrawingContext(g2d);
        plot.draw(context);
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        DrawableWriter wr = DrawableWriterFactory.getInstance().get("image/png");

        wr.write(plot, baos, 640, 480);
        baos.flush();

        baos.close();
        InputStream inputStream = new ByteArrayInputStream(baos.toByteArray());
        BufferedImage bufferedImage =  ImageIO.read(inputStream);

        ImageIO.write(bufferedImage,"png",new File(outputFolder.getPath()+"/result.png")); 
```

# asp.net-mvc - 自定义 MVC 验证属性和引导格式问题

> ID：11265130
> 
> 赞同：3
> 
> 时间：2012-06-29T15:59:05.287
> 
> 标签：asp.net-mvc, jquery-validate, twitter-bootstrap

我正在使用带有 twitter 引导程序的 ASP.net MVC。

我添加了以下内容以使有错误的字段在引导程序中正确设置样式

```
$.validator.setDefaults({
    highlight: function (element) {
        $(element).closest(".control-group").addClass("error");
    },
    unhighlight: function (element) {
        $(element).closest(".control-group").removeClass("error");
    }
}); 
```

这适用于除自定义验证属性之外的所有验证。我创建的自定义验证器检查是否选中了一个复选框，如果没有，它希望在文本字段中输入一些内容。这只是一个示例，但我创建的其他自定义验证属性以与下面描述的相同方式失败。

如果我提交表单，所有错误的样式都会正确设置，但使用我的自定义验证器的字段除外。但是我知道验证器运行是因为出现了错误消息，但消息和字段是黑色而不是红色。

如果我在字段中输入一些文本以满足验证器的要求，错误消息就会消失。然后，如果我删除该文本，则会返回错误消息，并且所有内容都应为红色。

然后，如果我再次提交表单，即使错误仍然存​​在，红色样式也会消失，但仅对于具有自定义验证器的字段，所有其他错误仍为红色。

在表单提交时，我设置的默认值（如上所示）不会针对具有自定义验证器的字段运行，但默认值会针对其他所有内容运行。

然而，通过自定义验证器在字段上的 on blur 和 key up 事件，一切都按预期运行，并且所有样式都按预期工作。

我不知道接下来要看什么。任何帮助/方向表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T20:11:39.317

我最近遇到了同样的问题，直到我发现我在同一个`.control-group`. （`<input type="hidden">`在我的情况下是字段）。如果这也适用于您的情况，您可以使用`errorClass`由`highlight`和提供的`unhighlight`方法，如下所示：

```
function highlight(element, errorClass, validClass) {
    $(element)
        .addClass(errorClass)
        .closest(".control-group")
        .addClass("error");
};

function unhighlight(element, errorClass, validClass) {
    var c = $(element)
        .removeClass(errorClass)
        .closest(".control-group");
    // make sure not to remove parent container error class, 
    //if there is still an invalid input field inside
    if (c.find("." + errorClass).length < 1) 
        c.removeClass("error");
}; 
```

# c# - 是否有关于将现有 .NET 类库转换为可移植库的指导？

> ID：11265132
> 
> 赞同：53
> 
> 时间：2012-06-29T15:59:18.127
> 
> 标签：c#, projects-and-solutions, portability

我有一些包含大量现有代码的类库。类库当前面向 .NET 4.0。是否有关于如何将这些库转换为可移植库的指导？从 .csproj 看，似乎没有很多差异：

```
<Import Project="$(MSBuildExtensionsPath32)\Microsoft\Portable\$(TargetFrameworkVersion)\Microsoft.Portable.CSharp.targets" /> 
```

和

```
<ProjectTypeGuids>{786C830F-07A1-408B-BD7F-6EE04809D6DB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids> 
```

尝试将现有类库转换为可移植库是好主意还是坏主意？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-08-15T07:43:16.267

我们还将现有库转换为可移植库，并且运行良好。您必须修改项目文件。替换以下行：

```
<Import Project="..." /> 
```

和

```
<Import Project="$(MSBuildExtensionsPath32)\Microsoft\Portable\$(TargetFrameworkVersion)\Microsoft.Portable.CSharp.targets" /> 
```

在 PropertyGroup 标记内添加以下行

```
<ProjectTypeGuids>{786C830F-07A1-408B-BD7F-6EE04809D6DB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids> 
```

并从 AssemblyInfo.cs 文件中删除以下行

```
[assembly: ComVisible(false)]
[assembly: Guid("...")] 
```

之后，Visual Studio 应该会在项目属性页面中显示标签页“库”，您可以更改可移植库的目标框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-02T15:32:24.723

我创建了一个 Visual Studio 扩展来自动执行此操作。只需在 Visual Studio > 2012 的 Extension 中搜索“[转换为 pcl](https://visualstudiogallery.msdn.microsoft.com/e2dcdf06-444d-4501-8dae-732e76bc94aa?SRC=Home) ”

源代码也可以在 Github 上找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T06:10:31.250

您可以删除该`<Import Project="..." />`行。然后，当您重新加载项目时，Visual Studio 会询问您要定位哪些框架。然后，您可以稍后在项目的属性中更改它。

# php - 如何转换这个数组？

> ID：11265133
> 
> 赞同：9
> 
> 时间：2012-06-29T15:59:25.943
> 
> 标签：php, arrays

这是数据

```
$array = array(
    'random' => 1,
    'pewpew' => 2,
    'temp' => 5,
    'xoxo' => 3,
    'qweqweqe' => 4,
);

$fields = array('random', 'xoxo', 'temp'); 
```

我需要得到结果：

```
$result = array(
    'random' => 1,
    'xoxo' => 3,
    'temp' => 5,
); 
```

我的意思是来自 $fields 的键存在/顺序适用于 $array。

问题是：我可以仅使用 array_ 函数执行此转换吗？（我不想使用iteations）如果是：你能链接我需要的功能吗？

（抱歉拼写错误）

更新。

PHP 5.2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T16:12:03.240

```
$result=array_intersect_key($array ,array_flip($fields) ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T16:07:22.947

```
// little trick required here...
$fields = array('random' => 0, 'xoxo' => 0, 'temp' => 0);
$result = array_intersect_key($array,$fields); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T12:37:08.307

我总是对这些类型的问题感兴趣，它是关于***高效代码***的（包括代码使用和速度）。也就是说，我尝试了几种不同的方法并对其进行了**基准测试**，但没有什么比简单的`foreach`!

我尝试了所有发布的解决方案，以及我自己的 array_walk 和基本的 foreach。我使用 Miraage 发布的数组和字段进行了几次测试，其中一些使用了更大的数组。我还注意到结果有任何奇怪之处，例如如果 $fields 的值不在 $array 中，则附加值。

我已经按速度订购了。

### FOREACH：0.01245 秒

```
$result = array();
foreach ($fields as $k)
{
    if (isset($array[$k]))
        $result[$k] = $array[$k];
} 
```

### ARRAY_DIFF_KEY：0.01471 秒*（意外结果：附加值）*

```
$result = array_diff_key($fields, $array); 
```

### FOREACH（函数）：0.02449 秒

```
function array_filter_by_key($array, $fields)
{
    $result = array();
    foreach ($fields as $k)
    {
        if (isset($array[$k]))
            $result[$k] = $array[$k];
    }

    return $result;
} 
```

### ARRAY_WALK（参考）：0.09123 秒

```
function array_walk_filter_by_key($item, $key, $vars)
{
    if (isset($vars[1][$item]))
        $vars[0][$item] = $vars[1][$item];
}

$result = array();
array_walk($fields, 'array_walk_filter_by_key', array(&$result, &$array)); 
```

### 列表/每个：0.12456 秒

```
$result = array();
reset($fields);
while (list($key, $value) = each($fields))
{
    if (isset($array[$value]))
        $result[$value] = $array[$value];
} 
```

### ARRAY_INTERSECT_KEY：0.27264 秒*（顺序错误）*

```
$result = array_intersect_key($array, array_flip($fields)); 
```

### ARRAY_REPLACE（array_intersect_key 秒）：0.29409 秒*（意外结果：附加值）*

```
$result = array_replace(
    array_fill_keys($fields, false),
    array_intersect_key($array, array_flip($fields))
); 
```

### ARRAY_REPLACE（两个array_intersect_key）：0.33311 sec

```
$flip = array_flip($fields);
$result = array_replace(
    array_intersect_key($flip, $array),
    array_intersect_key($array, $flip)
); 
```

### ARRAY_WALK（设置为空）：3.35929 秒*（意外结果：附加值）*

```
function array_walk_filter_by_key_null(&$item, $key, $array)
{
    if (isset($array[$key]))
        $item = $array[$key];
    else
        $item = null;
}

$result = array_flip($fields);
array_walk($result, 'array_walk_filter_by_key_null', $array); 
```

### ARRAY_REPLACE（array_intersect_key 优先）：11.11044 秒

```
$flip = array_flip($fields);
$result = array_intersect_key(
    array_replace($flip, $array),
    array_intersect_key($flip, $array)
); 
```

### ARRAY_MERGE：14.11296 秒*（意外结果：附加值）*

```
$result = array_splice(
    array_merge(array_flip($fields), $array),
    0,
    count($fields)
); 
```

就这样。无法击败DIY。有时人们认为内置函数更快，但并非总是如此。这些天编译器非常好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T17:19:18.463

我相信这可以按您的要求工作。

```
$result = array_splice(array_merge(array_flip($fields) , $array) , 0 , count($fields)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-04T23:08:38.493

只是为了解决这个难题：

```
$result = array_replace(
  array_intersect_key(array_flip($fields), $array),
  array_intersect_key($array, array_flip($fields))
); 
```

第一个 array_intersect 以良好的顺序创建字段列表，另一个克服 array_replace 功能来创建第一个数组中不存在的键。

满足您的要求。但我不会在任何生产代码中使用它，因为这可能非常繁重（虽然我没有进行基准测试，所以这只是一种直觉）。array_walk 解决方案似乎更轻。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-09T10:16:32.383

此代码保留顺序并根据需要在 PHP 5.2 中工作

一条线：

```
$result = array_merge( array_flip($fields),
                       array_intersect_key(
                                          $array,
                                          array_flip( $fields )
                                          )
                       ); 
```

对于性能：

```
$flip = array_flip($fields);
$result = array_merge( $flip
                       array_intersect_key(
                                          $array,
                                          $flip
                                          )
                       ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-03T02:33:59.050

如果您想保留来自 的键顺序`$fields`，您可以尝试以下操作：（如果 中不存在键`$array`，则该键的值将为空。）

```
$result = array_flip($fields);
array_walk($result, function(&$item, $key, $array) {
  $item = isset($array[$key]) ? $array[$key] : null;
}, $array);

var_dump($result); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-04T12:57:22.270

我会认为您不能更改输入（$array 或 $fields 都不能）。

如果您有一个将 $fields 中的值用作键的数组，则可以实现这一点。之后，您可以合并两者（使用 $fields 作为第一个参数）并删除额外的元素。

考虑到您无法更改 $fields，我将创建它：

```
$tmp = array_combine($fields, range(1, count($fields)));
$result = array_merge($tmp, $array);
$result = array_splice($result, 0, count($fields)); 
```

完整的工作示例（带有一些评论）可以在这里找到：[http ://codepad.org/H0CDN7ok](http://codepad.org/H0CDN7ok)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-06T20:28:00.827

我的尝试：

```
 array_replace(
            array_fill_keys($fields, false),
            array_intersect_key($array,             # Keys in array, without order
                    array_flip($fields)))); 
```

很容易以与 $array 相同的顺序获取密钥。然后为了让它们按正确的顺序排列，我构建了一个键值等于 $fields 的数组。Array_replace 完成了剩下的工作。

该解决方案是“稳定的”，因为 $array 中缺少的键将被替换为 FALSE，因此可以在需要时将其过滤掉。

array_flip 遍历大小为 N 的字段数组一次，array_intersect 遍历 N 大小的数组 M 次，array_fill_keys 花费 N 并且我相信最终的 array_replace 是 N^2。

所以总成本是 M*N^5。

遍历最小数组并从大数组中选取值是 O(M^2*N^2)，因此对于较大的 NI 值，怀疑 PHP 解决方案可能会更快。这不会输入不在数据数组中的键。

```
 $answer = array();
   foreach($fields as $fld)     // N-sized cycle
       if (isset($array[$fld])) // Cost M
           $answer[$fld] =      // Assignment is N*1/2
               $array[$fld];    // Getting value is another M 
```

（一段时间后很困惑）

我进行了检查，我想我一定犯了一些愚蠢的错误，因为我得到的时间完全是荒谬的。诚然，我使用的是一个非常短的 $fields 数组，所以我预计结果会出现偏差，但不会出现**这种**偏差。除非 $answer[$fld] 是用一些非常聪明的哈希技巧计算出来的，否则解释解决方案的真正成本不是 O(M^2*N^2) 而是 O(K*N^2) 且 K 很小。

如果有人想玩弄时间或告诉我我可能犯了什么愚蠢的错误，这里是基准。

我对发布这个有两种想法，因为另一个明显的解释是我在某个地方犯了一个可笑、愚蠢的错误，我最终会在我的脸上留下鸡蛋，但是，哦，到底是什么。

```
 $array = array(
        'random' => 1,
        'pewpew' => 2,
        'temp' => 5,
        'xoxo' => 3,
        'qweqweqe' => 4,
    );
    $fields = array('random', 'xoxo', 'temp');
    // Let's not print anything just yet, maybe that's what screwing the timer?
    $results = '';
    $duh = 0;

    for ($cycle = 0; $cycle < 10; $cycle++)
    {
            // Add some more elements to $array.
            for ($i = 0; $i < 10000; $i++)
            {
                    $k = uniqid();
                    $array[$k] = 42;
            }
            $start  = explode(' ', microtime());
            // WTF? Do more cycles to average the timing.
            for ($j = 0; $j < 10; $j++)
            {
                    // 0 or 1 to switch
                    if (1)
                    {
                    // INTERPRETED ANSWER
                    $answer = array();
                    foreach($fields as $fld)     // N-sized cycle
                       if (isset($array[$fld])) // Cost M
                           $answer[$fld] =      // Assignment is N*1/2
                               $array[$fld];    // Getting value is another M
                    } else {
                    // FUNCTION ANSWER
                    $answer = array_replace(
                            array_fill_keys($fields, false),
                            // array_combine($fields, $fields),
                            array_intersect_key($array,             # Keys in array, without order
                                    array_flip($fields)));
                    }
                    // USE $answer so to avoid premature optimization?
                    // You can't be that clever.
                    $duh += strlen(serialize($answer));
            }
            $stop   = explode(' ', microtime());
            // An error in timing? Check via a stupid roundabout.
            $int    = $stop[1]-$start[1]+1;
            $int    += ($stop[0]-$start[0]);
            $int    -= 1;
            $elapsed = number_format($int * 1000000, 2);
            $results        .= "".(5000*$cycle)." = $elapsed us.\n";
    }

    // I need to get in result:
    $wanted = array(
        'random' => 1,
        'xoxo' => 3,
        'temp' => 5,
    );
    // DID we get the right answer?
    print "Wanted:\n"; print_r($wanted);
    print "Gotten:\n"; print_r($answer);
    print "Results: $results\n$duh -- count of array is " . count($array);

    // And yet I have always the same realtime, name of a dog, how can that be?
    // I must be doing something REALLY REALLY wrong somewhere. 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-06T22:22:13.213

这是一个解决方案，它还可以处理一些`$fields`不作为键出现的情况`$array`：

```
$flip = array_flip($fields);
$result = array_intersect_key(array_replace($flip, $array), array_intersect_key($flip, $array)); 
```

如果所有`$fields`已知都作为键`$array`存在，则有这个更简单的解决方案：

```
$flip = array_flip($fields);
$result = array_intersect_key(array_replace($flip, $array), $flip); 
```

可以写成这样的单行：

```
$result = array_intersect_key(array_replace($flip=array_flip($fields), $array), $flip); 
```

如果有些`$fields`不是 的键`$array`，但包含计数，因此返回缺失键`$array`的计数是有意义的，我们可以替换为：`0``flip()``array_fill_keys($fields, 0)`

```
$result = array_intersect_key(array_replace($fill=array_fill_keys($fields, 0), $array), $fill); 
```

如果需要，我们可以应用 an再次`array_filter()`过滤掉`0`s 。通过替换`0`or`false`我们可以在值不计数时`null`标记和处理缺少键的情况。`$array`

可悲的是，这些解决方案，就像这个页面上的所有其他解决方案一样，必须通过 的所有键`$array`，而任何显式循环都将在`$fields`。目前，似乎 when`count($array)`比`count($fields)`没有像显式循环一样快的基于数组函数的解决方案要大得多（因为他们会在回调函数中显式构造结果，我认为`array_walk()`这里`array_reduce()`是显式循环）。

问题是没有一个可用的`array_`函数破坏键和值之间的关联，并且由于我们想要循环`$fields`，或者更确切地说是一个翻转的数组，也为了保持它的排序顺序，同时保持 的值`$array`，我们没有运气。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-07-08T11:03:56.507

PHP 函数称为[array_diff_key](http://php.net/array_diff_key)。

示例代码：

```
$array = array(
    'random' => 1,
    'pewpew' => 2,
    'temp' => 5,
    'xoxo' => 3,
    'qweqweqe' => 4
);

$fields = array('random', 'xoxo', 'temp');
$result = array_diff_key($fields, $array); 
```

这将产生预期的结果。

演示：[http ://shaquin.tk/experiments/array1.php](http://shaquin.tk/experiments/array1.php)

**编辑：**如果`$fields`可以包含一个不是键的值`$array`，则使用以下代码：

```
$result = array_diff_key($fields, $array);
$result = array_intersect_key(array_flip($fields), $array);
$result = array_flip(array_diff(array_keys($result), $array));
$result = array_replace($result, $array);
$result = array_flip(array_intersect(array_flip($result), $fields)); 
```

可以稍微优化一下，但它有效！

注意：我无法链接到示例，因为我的（托管）站点没有 >= PHP 5.3，但是，我可以链接到类似的站点：[http](http://shaquin.tk/experiments/array2.php) ://shaquin.tk/experiments/array2.php 。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-07-09T11:29:10.920

简单的方法：

```
$array = array(
   'random' => 1,
        'pewpew' => 2,
        'temp' => 5,
        'xoxo' => 3,
        'qweqweqe' => 4,
);

$fields = array('random', 'xoxo', 'temp');

$output = array();

foreach ($fields as $value) 
    if(isset($array[$value]))
         $output[$value]=$array[$value]; 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-06-29T16:03:19.187

尝试：

```
$result=array();
reset($fields);
while(list($key,$value)=each($fields))
{
    if(isset($array[$value])) $result[$value]=$array[$value];
} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2012-07-03T15:25:56.977

这将为您工作并保持秩序：

```
$fields = array_flip($fields);
array_merge($fields,array_intersect_key($array, $fields));
$fields = array_keys($fields); 
```

请注意，您可以只调用 array_flip 两次，但上面看起来有点“干净”。

# jquery - jQuery 淡入淡出页面加载

> ID：11265134
> 
> 赞同：1
> 
> 时间：2012-06-29T15:59:31.937
> 
> 标签：jquery, fadein, fadeout

我想知道是否有人可以帮助我。

我知道对某些人来说这将是一个非常基本的问题，我很抱歉，但我才刚刚开始使用 jQuery，所以请多多包涵。

从[这里](http://net.tutsplus.com/tutorials/javascript-ajax/building-a-sleek-ajax-signup-form/)的教程开始，我使用下面的代码在`Submit`按钮上触发。

```
$(document).ready(function(){
    $(this).scrollTop(0);
    $('#addlocation').submit(function(){

        //check the form is not currently submitting
        if($(this).data('formstatus') !== 'submitting'){

            //setup variables
            var form = $(this),
                formData = form.serialize(),
                formUrl = form.attr('action'),
                formMethod = form.attr('method'), 
                responseMsg = $('#saverecordresponse');

            //add status data to form
            form.data('formstatus','submitting');

            //show response message - waiting
            responseMsg.hide()
                       .addClass('response-waiting')
                       .text('Please Wait...')
                       .fadeIn(200);

            //send data to server for validation
            $.ajax({
                url: formUrl,
                type: formMethod,
                data: formData,
                success:function(data){

                    //setup variables
                    var responseData = jQuery.parseJSON(data), 
                        klass = '';

                    //response conditional
                    switch(responseData.status){
                        case 'error':
                            klass = 'response-error';
                        break;
                        case 'success':
                            klass = 'response-success';
                        break;  
                    }

                    //show reponse message
                    responseMsg.fadeOut(200,function(){
                        $(this).removeClass('response-waiting')
                               .addClass(klass)
                               .text(responseData.message)
                               .fadeIn(200,function(){
                                   //set timeout to hide response message
                                   setTimeout(function(){
                                       responseMsg.fadeOut(250,function(){
                                           $(this).removeClass(klass);
                                           form.data('formstatus','idle');
                                       });
                                   },1000)
                                    setTimeout(function() { 
                                    $('body').fadeOut();}, 2000); 
                                });
                    });
                }
            });
        }

        //prevent form from submitting
        return false;
    });
});
</script> 
```

该代码有效，但我在脚本末尾遇到了一些困难，这里更准确地说：

```
setTimeout(function() { 
$('body').fadeOut();}, 2000); 
```

这会在 2 秒后正确淡出页面，但我现在想在短暂的延迟后淡入我的页面。

我已经阅读了该网站上的许多帖子并尝试合并以下内容：

```
$(this).fadeOut().next().delay(500).fadeIn(); 
```

但是在某些地方我做错了，因为页面现在无法淡出或淡入，但我必须诚实地说我不太确定我做错了什么。

我只是想知道是否有人可以看看这个，让我知道如何合并我现有的代码，然后在淡入之前添加一个时间延迟。

非常感谢和亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:19:09.457

有很多解决方案。那就是如果我正确理解了您的问题。但是，在查看您的代码之后，我会说以下代码片段可能会有所帮助。

```
setTimeout(function() { 
         $('body').fadeOut(400, function(){
              setTimeout(function(){
                   $('body').fadeIn(400);
              }, 500);
         });
    }, 2000); 
```

我相信这应该可以正常工作。

如果您试图在从服务器检索数据完成后让页面完全淡入，请尝试使用 $.ajax 调用中实现的“完成”事件。

我希望这会有所帮助:) 祝你好运

编辑：@torazaburo 提出了一个更微妙的解决方案。

```
$('body').delay(2000).fadeOut(500).delay(500).fadeIn(400). 
```

# prolog - 不间断的循环

> ID：11265143
> 
> 赞同：2
> 
> 时间：2012-06-29T15:59:57.397
> 
> 标签：prolog, infinite-loop

嗨，我有这个问题，我无法解决。我是 Prolog 菜鸟，我看过很多这样的家谱示例，但似乎没有一个能解决我的问题。

说我有

```
son(X, Y) :-
   \+daughter(X, Y),
   father(Y, X).

father(Y, X) :-
   male(X),
   son(X, Y). 
```

我调用其中一个，它会在条件之间来回切换，因为每个条件都会满足之前的条件，因此导致本地堆栈错误。

大多数人似乎建议删除其中一个定义，但我需要回答父子查询。请帮忙，这看起来很简单，但我就是想不通。循环一次后如何中断？

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T18:59:23.760

你可以：

1）您可以使用包装谓词：

```
father(Y,X):-
   male(X),
   son_data(X,Y).

son(X,Y):-
   son_data(X,Y).
son(X,Y):-
   \+daughter(X, Y), 
    father(Y, X). 
```

你的数据库应该看起来像

```
son_data(mike,steph).
....
father(nick,john).
.... 
```

（没有儿子/2 个条目）

2）使用支持表格的prolog版本[（](https://secure.wikimedia.org/wikipedia/en/wiki/Prolog#Tabling)例如XSB）（或实现它；不是c的好主意）

# knockout.js - KnockoutJS - 有没有简单的方法可以用单个对象覆盖 observables？

> ID：11265144
> 
> 赞同：0
> 
> 时间：2012-06-29T16:00:03.523
> 
> 标签：knockout.js

考虑以下代码：

```
 // data comes from AJAX call response (entity from db)
 var template = ko.mapping.fromJS(data);

 if ( isAddMode ) {                            
     self.selectedCategory().EmailTemplates.push(template);
     self.selectedTemplate(template);
 } else {
     // why can't this work?!?
     //vmTemplates.selectedTemplate(template);                   

     // have to do this instead...
     self.selectedTemplate().Name(template.Name());
     self.selectedTemplate().Subject(template.Subject());
     self.selectedTemplate().Content(template.Content());
} 
```

我有一个对话框来编辑电子邮件模板。保存模板后，使用映射插件从 AJAX 调用的响应创建“模板”对象。

如果我正在创建一个新模板 (isAddMode)，那么我可以将模板推送到数组中，然后设置 selectedTemplate()。这会导致在添加模板的对话框关闭后，编辑器字段会在主 UI 上显示所有最新字段。

但是，如果我正在更新模板（它是 UI 上的同一个编辑器），我现在想将 selectedTemplate() 设置为映射的模板对象。但是，这没有效果。我能做到这一点的唯一方法是如上所述设置每个单独的属性。为什么我不能像推送一个新的 observable 那样一次性做到这一点？我觉得这与新的 observables 在某种程度上与旧的 observables 分离这一事实有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:17:51.770

尝试推动它

```
// data comes from AJAX call response (entity from db)
var template = ko.mapping.fromJS(data);

if (isAddMode) {
    self.selectedCategory().EmailTemplates.push(template);
    self.selectedTemplate(template);
} else {
    // why can't this work?!?
    //vmTemplates.selectedTemplate(template);                   

    // try it!
    self.selectedTemplate.Push(template);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:41:32.737

你有没有尝试过：

```
ko.mapping.fromJS(template,self.selectedTemplate); 
```

?

# ruby-on-rails - 新的 .railsrc 给了我一个错误

> ID：11265145
> 
> 赞同：0
> 
> 时间：2012-06-29T16:00:06.007
> 
> 标签：ruby-on-rails, ruby-on-rails-3, .railsrc

我正在运行 Rails 3.2.6，在我的`.railsrc`文件中我有`-d postgresql -T`. 每当我`rails c`在我的应用程序上运行时，它都会给我一个错误

```
in `load': /Users/user/.railsrc:1: syntax error, unexpected tIDENTIFIER, expecting keyword_do or '{' or '(' (SyntaxError) 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-19T12:50:41.827

**`-T`**是 的别名**`--skip-test-unit`**。

您应该在 .railsrc 文件中一一添加每个标志。否则，只需添加以下命令即可。

**`ruby -d postgresql -T`**或者

**`ruby -d postgresql --skip-test-unit`**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T07:50:13.343

尝试从新行编写每个选项，如下所示：

```
--skip-test-unit
-d postgresql 
```

这对我有用。

# android - Android - 相同的不同ID包括布局

> ID：11265150
> 
> 赞同：5
> 
> 时间：2012-06-29T16:00:25.880
> 
> 标签：android

我有一个布局，我必须包含几次。它由 a`TextView`和 a组成`ImageView`：

```
<ImageView
    android:layout_width="wrap_content"
    android:layout_height="40dp"
    android:background="@drawable/back2"
    android:id="@+id/id_1"/>

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:id="@+id/id_2"
    android:textSize="15dp"
    android:typeface="sans"
    android:textColor="#ffffff" /> 
```

现在我想以编程方式设置文本，但我面临的问题是，`TextView`现在总是具有相同的 Id，因为我多次包含相同的布局。有没有办法以编程方式包含布局并始终更改每个包含布局的 Id？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T16:08:48.047

我要做的是，当您需要访问包含布局的特定实例上的视图时：

```
ViewGroup instance = (ViewGroup) findViewById(R.id.included1); // Replace ViewGroup with whatever your particlar type is
ImageView iView = (ImageView) instance.findViewById(R.id.id_1);
TextView tView = (TextView) instance.findViewById(R.id.id_2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T16:08:26.363

您可以动态创建 TextView，然后用于`TextView.setId(int id)`设置该视图的 id，以便以后可以使用新 id 调用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T16:10:07.997

对于每个文本视图

将行中的 id 更改`android:id="@+id/id_2"` 为不同的 id。

例如：

`android:id="@+id/id_4"`

要以编程方式添加它们，您可以这样做：

```
 TextView Label3 = new TextView(this);
            Label3.setId(300);
            Label3.setTextAppearance(this, android.R.attr.textAppearanceMedium);
            Label3.setLayoutParams(labelParams);
            Label3.setText("My textViewCaption:");
            ll3.addView(Label3); 
```

如果您将 Label3 设置为全局变量，您可以通过以下方式访问它来更改它`setText`

以编程方式，您可以循环遍历它并在循环时设置 Id

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T16:30:17.163

您可以使用它来更改您的 TextView id
`TextView textview = new TextView(this); textview.setId(int id);`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T16:06:24.433

据我所知，没有办法做到这一点。`<include>`如果您希望 XML 布局中的 id 是唯一的，则必须创建不使用 using的布局。

# sql - 正则表达式匹配sql中的字符串

> ID：11265151
> 
> 赞同：2
> 
> 时间：2012-06-29T16:00:26.210
> 
> 标签：sql, regex

如果从一开始至少有 3 个字符匹配，如何编写正则表达式来匹配字符串？

这是我的 SQL 查询现在的样子 -

```
SELECT * FROM tableName WHERE columnName REGEXP "^[a-zA-Z]{3}someString"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T16:13:34.113

您不能将 CONCAT 或类似方法与 REGEX 一起使用，它会失败。最简单的方法是：

```
$query = 'SELECT * FROM Test WHERE colb REGEXP "^'.substr($mystring,0,3).'"'); 
```

另一个是：

```
SELECT * FROM Test WHERE LEFT(colb, 3) LIKE "{$mystring}%" 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2019-06-21T15:29:25.243

请使用 jQuery 和 jqSQL 插件。请注意，使用此插件在 SQL 查询中必须对符号 $ 进行转义。

# eclipse - 第一次设置 Git/EGit/GitHub 需要一些帮助

> ID：11265154
> 
> 赞同：0
> 
> 时间：2012-06-29T16:00:42.637
> 
> 标签：eclipse, git, version-control, github, egit

我正在为我的组织创建一个全新的 OSS 项目，我想将它托管在 GitHub 上。该项目将使用 Eclipse 开发，我正在使用 EGit。我以前没有使用 Git 的经验，因为我以前只使用过 SVN。

这是我到目前为止所做的：

*   在 GitHub 上为我的组织创建了一个新帐户。（我已经有一个个人帐户。）
*   在我组织的 GitHub 帐户下为此项目创建了一个新存储库。
*   在新存储库的“合作者”部分下，添加了我的个人帐户。（我在我的个人帐户中验证了这一点。）
*   将 EGit 安装到我的 Eclipse 中。（我使用 Eclipse 4.2 和 EGit 2.0.0）
*   在新的 Eclipse 工作区中创建了一个新的 Eclipse 项目。（这是一个 Maven 项目，所以我通过 m2e 创建了它，但这应该没什么区别。）
*   将新的 Eclipse 项目添加到新的 Git 本地存储库（通过团队 -> 共享项目）。
*   创建了 .gitignore（忽略 Eclipse 特定的文件和目录）。
*   向项目添加了源代码（通过团队 -> 添加到索引）。
*   将本地更改提交到我的本地存储库。
*   从 GitHub 复制 HTTPS URL。
*   团队 -> 远程 -> 推送
*   剪贴板中的 URL 已被获取，并且大多数字段都已填充。
*   输入我的 GitHub 个人账户的用户名和密码，点击下一步，数据获取成功。
*   从 Source ref 下拉列表中选择“refs/head/master”（我不明白整个页面，也许我写错了？）
*   单击“添加规格”，然后单击下一步

此时，我收到错误“master：master [rejected - non-fast-forward]”

我在谷歌上搜索，但建议的解决方案是做一个拉。我尝试了“Team -> Pull”，但收到错误“当前分支未配置为 pull；在配置中找不到 key branch.master.merge 的值”

谁能帮我？我的远程仓库仍然是空的（除了 .gitignore 和 README.md）。我想从本地获取文件到远程仓库！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:51:11.527

看起来您的 Github 存储库中已经有提交的内容。我不完全知道出了什么问题，但我会做不同的事情：

*   首先在 Eclipse 中安装 Mylyn 和 Mylyn GitHub 连接器。这样您就可以更轻松地访问 github 存储库。
*   使用 Mylyn Github 连接器将现有（假定为空）Github 存储库克隆到新的本地存储库（文件->导入->Git->从 Github）。这是验证您的登录凭据、ssh 密钥等的最简单方法。
*   在上一个克隆步骤中，github 存储库被自动添加为本地存储库的“上游”存储库引用。因此，如果您现在将文件添加到本地存储库，您可以提交它们，然后使用“推送到上游”使它们在 Github 上可用。在这种情况下，不需要配置遥控器和 refspecs。
*   现在创建新的 Eclipse 项目并使用 Team -> Share 共享它，您可以在其中选择现有的本地存储库。

除此之外的一切都将如您已经描述的那样。

# objective-c - Objective-C 在哪里定义初始类属性

> ID：11265159
> 
> 赞同：-1
> 
> 时间：2012-06-29T16:00:56.040
> 
> 标签：objective-c, class, properties

只是想问我在哪里定义初始类属性？

在其他语言中，我习惯于在课程内容开始之前在头部定义一些标准属性。

例如文件的路径。设置等等。

我在哪里用 Objective-C 中的值填充这些初始属性？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:12:06.580

通常它是这样的：

MyClass.h：

```
extern NSString * const staticValue1;
extern NSString * const staticValue2;

@interface MyClass : NSObject
{
    NSString *_strval;
    int _intval;
    float _fltval;
}

@property (retain, nonatomic, readwrite) NSString *strval;
@property (assign, nonatomic, readwrite) int intval;
@property (assign, nonatomic, readwrite) float fltval;

@end 
```

我的班级.m：

```
NSString * const staticValue1 = @"Something";
NSString * const staticValue2 = @"Something else";

@interface MyClass

@synthesize strval = _strval;
@synthesize intval = _intval;
@synthesize fltval = _fltval;

- (id)init
{
    self = [super init];
    if (self != nil)
    {
        [self setStrval:[NSString stringWithFormat:@"This is a %@", @"string"]];
        [self setIntval:10];
        [self setFltval:123.45f];
    }
    return self;
}

- (void)dealloc
{
    [self setStrval:nil];
    [super dealloc];
}

@end 
```

这演示了使用合成属性来管理实例变量的内存`_strval`，这需要保留/释放以避免内存泄漏。请注意，它`[self setStrval]`是使用自动释放对象（来自）初始化的`[NSString stringWithFormat`，并将由 setter 方法保留。或者，如果您愿意，可以使用以下语法调用这些方法：

```
self.strval = [NSString stringWithFormat:@"This is a %@", @"string"];
self.intval = 10;
self.fltval = 123.45f; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:36:28.297

也许你所追求的一些东西可以用类方法来实现。

类方法用 a `+`（而不是实例方法' `-`）编码，并且不能引用实例变量，因为它们不与类的任何特定实例相关联。

这是一个返回默认字符串的类方法：

```
+ (NSString *)myDefaultString
{
    return @"Some default value";
} 
```

您只需在接收者处使用类名调用它即可调用它。想象一下，您已经在一个名为 的类中定义了该方法`MyClass`，您可以这样称呼它：

```
NSString *str = [MyClass myDefaultString]; 
```

你会注意到这里没有`alloc`/`init`调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:02:29.143

公共属性需要在 .h 文件中定义。

```
@interface MyClass {
}
@property(nonatomic, reatin) NSString *a;//Define as per needs, then synthesise in .m file

@end 
```

对于私有财产，您需要在 .m 文件中定义内联类别-

```
@interface MyClass ()

@property(nonatomic, reatin) NSString *b;//Define as per needs, then synthesise in .m file
@end

@implementation MyClass

@synthesize a = _a;
@synthesize b = _b;

- (void)viewDidLoad {
//You can initialise property here or in init method

self.a = @"Demo1";
self.b = @"Demo2";
}

//Now you can have other code for this class.
@end 
```

# jquery - 从服务器获取 json 后页面不会停止加载

> ID：11265160
> 
> 赞同：2
> 
> 时间：2012-06-29T16:00:57.190
> 
> 标签：jquery

我正在使用此代码从服务器获取一些 json

```
$(function () 
  {
    $.ajax({                                      
      url: 'fetch.php',                          
      data: "",      
      dataType: 'json',                 
      success: function(data)          
      {
        jQuery.each(data, function() {
        document.write(this[0] + "<br/>" + this[1]);
         });
      }  
    });

  }); 
```

我在服务器端有这个

```
$rows = Array();
while($row = mysql_fetch_array($result)){
  array_push($rows, $row);
}
echo json_encode($rows); 
```

当我尝试使用 json 加载我的 html 文件时，会显示数据，但页面不会停止加载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:20:08.467

我解决了问题。我改变了

```
document.write(this[0] + "<br/>" + this[1]); 
```

到

```
$(document.body).append(this[0] + "<br/>" + this[1]); 
```

但我不能声称完全是自己完成的。我从这篇文章中得到了一个提示 [Browser doesn't stop loading with jQuery $.get](https://stackoverflow.com/questions/3319177/browser-doesnt-stop-loading-with-jquery-get)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:03:51.577

这段代码在哪里？您是否尝试在就绪事件中执行它：

```
$(document).ready(function(){
    // your ajax call here...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:05:18.563

用 Chrome 打开它，打开 Web Inspector（右键单击 > 检查元素）并转到 Network 选项卡并刷新网站

您应该看到您的网站正在加载的所有资源，包括任何 AJAX 请求，并且您可以清楚地看到仍在加载的内容

# iphone - iOS 上的 Audiostreamer - 与 ARC 一起使用

> ID：11265162
> 
> 赞同：3
> 
> 时间：2012-06-29T16:01:02.937
> 
> 标签：iphone, objective-c, ios, xcode, audiostreamer

我正在使用 matt Gallagaher 的 AudioStreamer 类。在 ARC 出现之前，我曾在一个项目中使用过它，并且效果很好。当我将类添加到使用 ARC 的项目中时，我遇到了很多错误，我可以通过添加`__bridge`引用等来修复这些错误......

所以应用程序现在运行，但是当我启动流媒体时，`[streamer start]`我不断遇到这个错误，我不知道如何修复。编译器在下面的函数处停止并`Audiostreamer.m`出现错误`Thread 8: EXC_BREAKPOINT (code=EXC_I386_BPT, subcode=0x0)`- 我不知道从这里做什么......请帮助。

```
if (CFReadStreamSetProperty(stream, kCFStreamPropertyHTTPShouldAutoredirect, kCFBooleanTrue) == false)
        {
            [self presentAlertWithTitle:NSLocalizedStringFromTable(@"File Error", @"Errors", nil)
                                message:NSLocalizedStringFromTable(@"Unable to configure network read stream.", @"Errors", nil)];
            return NO;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-27T15:57:24.990

我在使用 muhku 的 FreeStreamer 时完全出错（推荐的好库）。检查您是否向 AudioStreamer 提供了正确/未为空的 url。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-12T11:03:04.713

试试我的 StreamingKit 库。它具有与 AudioStreamer 相同的功能，但使用 ARC 构建并具有相当多的附加功能。

[https://github.com/tumtumtum/StreamingKit](https://github.com/tumtumtum/StreamingKit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-31T18:43:43.403

我遇到了同样的问题，但是我禁用了 arc，现在工作正常，我遇到的唯一问题是，当我滑动滑块时，我得到了 seekToTime: 的新值，但没有从新值开始播放。知道那是什么吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-21T19:52:47.907

CoreAudio 似乎使用异常在内部工作，因此如果您安装了异常断点，这就是您将看到的。只需禁用断点，它就会工作。

# wpf - 使用不是窗口的代码启动 wpf？

> ID：11265163
> 
> 赞同：1
> 
> 时间：2012-06-29T16:01:03.273
> 
> 标签：wpf, vb.net

在 Winforms 中，您只有 Main 函数，这是首先运行的函数，但在 WPF 中，您可以在 Application.xaml 文件中设置要开始的窗口。如果我尝试运行除窗口以外的任何东西，我会怎么做？我正在移植一个 winforms 应用程序，该应用程序在开始时执行一些逻辑以确定要打开哪个窗口，我宁愿它只是一个运行的类，而不是一个永远不会出现的窗口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:03:23.617

删除[`StartupUri`](http://msdn.microsoft.com/en-us/library/system.windows.application.startupuri.aspx)from `App.xaml`，覆盖[`OnStartup`](http://msdn.microsoft.com/en-us/library/system.windows.application.onstartup.aspx)in `App.xaml.cs`。

# java - 寻找弹簧安全设置的额外解释

> ID：11265166
> 
> 赞同：0
> 
> 时间：2012-06-29T16:01:13.497
> 
> 标签：java, spring-mvc, spring-security

我的要求很简单：

*   我希望只有在用户登录时才能访问我的所有链接
*   如果用户未登录，将他重定向到登录页面

自己想想应该不会太难。我以前这样做过，但我自己编程。这次我们正在做一个新项目，我决定试一试。

除了我在项目中使用的 spring 依赖项之外 spring 安全依赖项：

```
 <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-core</artifactId>
        <version>${org.springsecurity-version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-config</artifactId>
        <version>${org.springsecurity-version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-web</artifactId>
        <version>${org.springsecurity-version}</version>
    </dependency> 
```

`${org.springsecurity-version}`在哪里`3.0.4.RELEASE`。这是我的重要部分`web.xml`：

```
<context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
       classpath:security-app-context.xml
       /WEB-INF/spring/root-context.xml
   </param-value>
    </context-param>

    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping> 
```

我的`security-app-context.xml`：

```
<beans:beans xmlns="http://www.springframework.org/schema/security" xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                    http://www.springframework.org/schema/security
                    http://www.springframework.org/schema/security/spring-security-3.0.xsd">

    <http once-per-request="false" auto-config="false">

        <!-- All other resources to require users to have user role USER_ROLE to view -->
        <intercept-url pattern="/*" access="ROLE_USER" />

        <!-- Don't apply any filters to the login form either, we want unauthenticated users to be able to see this -->
        <intercept-url pattern="/login" filters="none" />

        <anonymous />
        <http-basic />

        <form-login login-page="/login"/>
    </http>

    <authentication-manager alias="authenticationManager">
        <authentication-provider user-service-ref="myUserDetailsService" />
    </authentication-manager>

    <!-- I've defined a custom UserDetails service to lookup users in my db using me own implementation -->
    <beans:bean id="myUserDetailsService" class="fully.qualified.class.name.MyUserDetailsService">
        <!--<beans:property name="userServ" ref="UserService" /> -->
    </beans:bean>

</beans:beans> 
```

这是我的控制器（显示我只想登录用户查看的仪表板页面）：

```
@Controller
@RequestMapping("main")
public class DashboardController {

    @RequestMapping("start")
    public String getDashboard(){
        return "dashboard";
    }

} 
```

我的登录控制器（显示登录的方法）：

```
@RequestMapping("/login")
    public String getLogin(){
        return "login";
    } 
```

我没有例外。它只是不符合我上面描述的方式。唯一不能正常工作的东西，我无法打开登录页面。我收到消息说它找不到。但是当我将登录控制器方法更改为：

```
@RequestMapping("/login/me")
        public String getLogin(){
            return "login";
        } 
```

我的登录页面确实打开了。我不确定我做错了什么。我找到了几页，每页都有一些东西，但我无法拿起。我看着 ：

[http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html) http://blog.richardadamdean.com/?p=213 [https://cwiki.apache .org/WICKET/spring-security-and-wicket-auth-roles.html](https://cwiki.apache.org/WICKET/spring-security-and-wicket-auth-roles.html) http://springinpractice.com/2008/10/11/hashing-and-salting-passwords-with-spring-security-2/ [http： //www.codercorp.com/blog/spring/security-spring/writing-custom-userdetailsservice-for-spring-security.html](http://www.codercorp.com/blog/spring/security-spring/writing-custom-userdetailsservice-for-spring-security.html) http://static.springsource.org/spring-security/site/tutorial.html

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T18:19:13.743

我使用 Spring Security 已经有几年了，但是有一个 ROLE_ANONYMOUS 或类似的东西，未经身份验证的用户得到，你应该在安全 XML 中分配给你的登录页面。

另外，我会将包含登录访问权限的行移至通用 /* 行之上，因为我认为它是先到先得的。不过，这一切都是基于生锈的记忆，如果不好，请道歉。

# fancybox - 灯箱花式框在 WordPress 3.4 中不起作用

> ID：11265168
> 
> 赞同：0
> 
> 时间：2012-06-29T16:01:45.320
> 
> 标签：fancybox, wordpress, lightbox

我在我的网站[CoffeeDesignBlog上使用 Fancybox for WordPress 插件](http://blog.coffeedesign.net)

但是当我升级到 WordPress 3.4.1 后，我的 facnybox 根本不工作，我测试了很多灯箱插件，它们甚至都不能在我的其他博客上工作......两个博客都在使用 wp_head anf wp_footer 函数调用，插件的js文件也在加载中......

请检查我博客的任何帖子，让我知道您对此的想法......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T00:25:36.623

不确定您的网站有什么问题，但是我正在开发的预生产网站也发生了完全相同的事情...尝试了一些很好的解决方案，但似乎没有任何效果...

终于遇到了 WP jQuery 灯箱（[http://wordpress.org/extend/plugins/wp-jquery-lightbox/](http://wordpress.org/extend/plugins/wp-jquery-lightbox/)）...它不是最漂亮的灯箱，但可以调整（它也适用于响应式设计，这是一个奖金）...

在 mo (3.4.1) 上我的 WordPress 安装工作非常稳定......

希望有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T10:10:46.780

对于灯箱，我在 WP 3.4.1 中使用这个[插件](http://wordpress.org/extend/plugins/lightbox-plus/screenshots/)，试试这个它在我的最终工作......

# javascript - 使用 $.ajax VB.NET 返回数据

> ID：11265170
> 
> 赞同：0
> 
> 时间：2012-06-29T16:01:51.480
> 
> 标签：javascript, jquery, ajax, vb.net, json

```
<WebMethod()> Public Shared Function gtet() As String
    ...
    Dim GET = uClass.GetSets(dbuser, dbparam1)
    ...
End Function 
```

和

```
$(document).ready(function ()
{
    data = { };
    var jsondata = $.toJSON(data);
    $.ajax({
        type: "GET",
        url: "index.aspx/gtet",
        data: jsondata,
        contentType: "application/json; charset=utf-8",
        dataType: "text json",
        beforeSend: function (xhr)
        {
            xhr.setRequestHeader("Content-type",
                         "application/json; charset=utf-8");
        },
        success: function (cget)
        {
            alert(cget);
        },
        error: function (XMLHttpRequest, textStatus, errorThrown)
        {
            window.location.reload();

        }
    });
} 
```

我这样做对吗？我需要从 Dim GET 中拉出字符串

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:18:20.930

将 json 作为参数发送。

```
data: {
    "json": jsondata
}, 
```

另外，请确保您的 webmethod 返回有效的 json。

# mysql - MySQL：“递归”更新行。EMA 示例

> ID：11265172
> 
> 赞同：2
> 
> 时间：2012-06-29T16:01:54.163
> 
> 标签：mysql, recursion

一般问题是如何更新第 n 行上的 column_A，这取决于第 n-1 行上的 column_A。

具体问题是计算和持久化 EMA（指数移动平均线）是一个 MYSQL 表。

对于 EMA 计算（对于 10% 或 19 天 EMA），EMA(n) = 0.1 * price + 0.9 EMA(n-1) 所以，我们有一个递归方程，其中第 n 行的值取决于值行 (n -1)

在任何编程语言中，这都很容易计算。
但是如果 EMA 存储为 MYSQL 表中的列。如何在 MYSQL 脚本中有效地计算和更新 EMA 列？现在，我只能在循环中进行顺序更新。我的丑陋解决方案在这里列出。它需要 order(n) 更新。

任何只需要 order(1) 更新的聪明想法？

非常感谢

* * *

```
DELIMITER $$

DROP PROCEDURE IF EXISTS update_ema$$

CREATE PROCEDURE update_ema(
IN series_id INT
)
BEGIN

DECLARE counter INT;

SET counter = 2;

WHILE counter <= 5000 DO

    update price_table as x
    inner join  price_table y 
    on x.id = y.id and x.row_num = y.row_num+1 
    and x.Id=series_id and x.row_num = counter
    set x.EMA19 = func_ema(19, y.EMA19, x.price);

SET counter = counter + 1;

END WHILE;
END$$
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:38:10.713

如果 column_a, row(n) 的值取决于 column_a, row(n-1) 的值，则更改它会更改所有以下行中的值：

（不是代码）

```
if

x = row number
row(x) col(a) = f(row(x-1) col(a))

then

where x = n
row(n) col(a) = f(row(n-1) col(a))

where x = n + 1
row((n+1)) col(a) = f(row((n+1)-1) col(a))
row(n+1) col(a) = f(row(n) col(a)) 
```

当你改变 n 时，你必须更新 n+1，一直持续到表的末尾。我不相信你能比你所拥有的更好。

# php - 我如何理解嵌套的 ?: PHP 中的运算符？

> ID：11265173
> 
> 赞同：2
> 
> 时间：2012-06-29T16:02:12.977
> 
> 标签：php, ternary-operator, operator-precedence

> **可能重复：**
> [PHP 三元运算符的问题](https://stackoverflow.com/questions/6224330/problem-with-php-ternary-operator)

[我在这篇文章](http://me.veekun.com/blog/2012/04/09/php-a-fractal-of-bad-design/)中阅读了一些关于 PHP 的内容，我停下来考虑了他的一个抱怨。我无法弄清楚 PHP 究竟是如何得出它的结果的。

> 与（字面意思！）具有相似运算符的所有其他语言不同， ?: 是*左*关联的。所以这：
> 
> ```
> $arg = 'T';   
> $vehicle = ( ( $arg == 'B' ) ? 'bus' :
>             ( $arg == 'A' ) ? 'airplane' :
>             ( $arg == 'T' ) ? 'train' :
>             ( $arg == 'C' ) ? 'car' :
>             ( $arg == 'H' ) ? 'horse' :
>             'feet' );   
> echo $vehicle; 
> ```
> 
> 打印马。

PHP 遵循什么逻辑路径导致`'horse'`被分配到`$vehicle`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:06:49.783

> 笔记：
> 
> 建议您避免“堆叠”三元表达式。在单个语句中使用多个三元运算符时 PHP 的行为并不明显：
> 
> ```
> <?php
> // on first glance, the following appears to output 'true'
> echo (true?'true':false?'t':'f');
> 
> // however, the actual output of the above is 't'
> // this is because ternary expressions are evaluated from left to right
> 
> // the following is a more obvious version of the same code as above
> echo ((true ? 'true' : false) ? 't' : 'f');
> 
> // here, you can see that the first expression is evaluated to 'true', which
> // in turn evaluates to (bool)true, thus returning the true branch of the
> // second ternary expression.
> ?> 
> ```

[http://php.net/manual/en/language.operators.comparison.php#language.operators.comparison.ternary](http://php.net/manual/en/language.operators.comparison.php#language.operators.comparison.ternary)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:10:58.033

括号是理解*和*修复的解决方案：

这应该有*意想不到*的结果（`horse`）：

```
$arg = 'T';  
$vehicle = (
    (
        (
            (
                (
                    ( $arg == 'B' ) ? 'bus' : ( $arg == 'A' )
                ) ? 'airplane' : ( $arg == 'T' )
            ) ? 'train' : ( $arg == 'C' )
        ) ? 'car' : ( $arg == 'H' )
    ) ? 'horse' : 'feet'
);  
echo $vehicle; 
```

这应该具有预期的结果 ( `train`)：

```
$arg = 'T';   
$vehicle = (
    ( $arg == 'B' ) ? 'bus' : (
        ( $arg == 'A' ) ? 'airplane' : (
            ( $arg == 'T' ) ? 'train' : (
                ( $arg == 'C' ) ? 'car' : (
                    ( $arg == 'H' ) ? 'horse' : 'feet'
                )
            )
        )
    )
);   
echo $vehicle; 
```

# jquery - 使用 jQuery 覆盖“显示”css

> ID：11265178
> 
> 赞同：1
> 
> 时间：2012-06-29T16:02:39.813
> 
> 标签：jquery, css

我正在使用下面的 css 来隐藏一个元素：

```
.pds-pd-link {     
    display: none !important; 
} 
```

使用 jQuery 我可以在 css .pds-pd-link 上启用显示吗

像`$(.pds-pd-link).css("display","");`什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:04:16.007

简而言之，是的。

或者，您可以使用以下 to[`show`](http://api.jquery.com/show/)或[`hide`](http://api.jquery.com/hide/)元素：

```
$(.pds-pd-link).show();
$(.pds-pd-link).hide(); 
```

或者您甚至可以使用该[`toggle`](http://api.jquery.com/toggle/)方法在两者之间自动切换：

```
$(.pds-pd-link).toggle(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:06:28.643

虽然你可以这样做：

```
$(.pds-pd-link).css("display","none"); 
```

我会建议：

```
$(.pds-pd-link).hide(); 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-06-29T16:07:51.837

这应该工作

```
$('.pds-pd-link').css('cssText', 'display: block !important'); 
```

# animation - 将变量传递给 .animate 属性

> ID：11265180
> 
> 赞同：0
> 
> 时间：2012-06-29T16:02:47.610
> 
> 标签：animation, positioning, var

这里有点n00b。我试图修改悬停功能，我发现哪些位置和动画列表项中的图像。我不想在第一个实例中给出 .animate({top: 一个精确的像素值，而是将变量 imgHeight 传递给它，该变量获取包含 li 的高度，但我显然做错了什么。任何指针？

```
var imgHeight = $('li').height();
$(function() {
$('ul.hover_block li').hover(function(){
$(this).find('img').animate({top:'imgHeight' + 'px'},{queue:false,duration:200});
}, function(){
$(this).find('img').animate({top:'0px'},{queue:false,duration:200});
});
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:13:17.910

试试这个：你有

```
{top: 'imgHeight' + 'px'} 
```

应该

```
{top: imgHeight + 'px'} 
```

完整代码：

```
var imgHeight = $('li').height();
$(function() {
        $('ul.hover_block li').hover(function(){
            $(this).find('img').animate({top:imgHeight + 'px'},{queue:false,duration:200});
        }, function(){
            $(this).find('img').animate({top:'0px'},{queue:false,duration:200});
      });
});​ 
```

# javascript - 将非零长度文件推送到数组

> ID：11265182
> 
> 赞同：0
> 
> 时间：2012-06-29T16:02:49.767
> 
> 标签：javascript

假设我有一些文件需要收集有关信息并将这些信息推送到数组中。如果它们的长度不为零，则应加载它们，但如果它们的长度为零，则应忽略它们。我还需要将加载文件的总数作为全局变量。这似乎是一个 for 循环的工作，但是在我知道“长”文件的总数之前，我将如何构建它？我什至可以在 for 循环中访问全局 for 吗？如果不是 for 循环，那么“正确”的方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:21:09.997

如果您事先不知道文件总数，则应使用`while`循环并在其他条件下中断：

```
var TOTAL_FILES = 0,
    files = [],
    file;

// assume getNextFile() returns the next file in the list...
while (file = getNextFile()){

  // ...and the File object has a length instance attribute...
  if (file.length > 0){
    TOTAL_FILES++;

    // ...and processFile() works some magic on the file and returns it
    files.push(processFile(file));
  }
} 
```

此循环将继续执行，直到`getNextFile()`返回一个虚假值（`false`、`null`、`undefined`等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:26:22.063

不知道具体细节，我假设您使用 ajax 获取文件。由于 javascript 中的字符串类似于字符数组，因此您可以在 ajax 事件的 responseText 上获取长度。我希望这有帮助：

使用 jQuery Ajax...

```
var loadedFileData = [];
window.totalFiles = 0;
["file1", "file2", "file3"].forEach(function(file) {
 $.get("/path/to/files/"+file, function(data) {
  if (data.length) {
    loadedFileData.push(data);
    totalFiles++;
  }
 });
}); 
```

# jsf - f:param 和 f:viewparam 设置器未调用

> ID：11265183
> 
> 赞同：3
> 
> 时间：2012-06-29T16:02:50.637
> 
> 标签：jsf, el, viewparams

我有一个 xhtml 页面，其中有一个带有 f:param 的输出链接

`<h:outputLink value="#{formService.getStartFormData(v_process.id).formKey}"> Start <f:param name="processDefinitionKey" value="#{v_process.key}"></f:param> </h:outputLink>`

在目标页面中，我有查看参数

```
f:metadata>
        <!-- bind the key of the process to be started -->
        <f:viewParam name="processDefinitionKey" value="#{processList.processDefinitionKey}"/> 

    </f:metadata> 
```

我的豆是

```
@Named
@RequestScoped
public class ProcessList{

private String processDefinitionKey ; 

@Inject
private RepositoryService repositoryService;

@Produces
@Named("processDefinitionList")
public List<ProcessDefinition> getProcessDefinitionList() {
return repositoryService.createProcessDefinitionQuery()
        .list();
}

public void setProcessDefinitionKey(String processDefinitionKey1) {
  System.out.println("setProcessDefinitionKey "+processDefinitionKey1);
this.processDefinitionKey = processDefinitionKey1;
}

public String getProcessDefinitionKey() {
  System.out.println("getProcessDefinitionKey______ "+processDefinitionKey);
return processDefinitionKey;
}

} 
```

processDefinitionKey 为 null ，setter 没有被调用，怎么回事？web.xml 或 faces-config.xml 中是否有任何配置要添加？在同一个项目中，我使用 primefaces 和 spring security

这是整个页面

```
<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
template="/WEB-INF/templates/template.xhtml">

<ui:define name="metadata">
    <f:metadata>
        <!-- bind the key of the process to be started -->
        <f:viewParam name="processDefinitionKey" value="#{processList.processDefinitionKey}" />
    </f:metadata>
</ui:define>

<ui:define name="content"> 
```

谢谢回复，请问这个没用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-07T13:29:14.440

尝试更改[已在此处发布](https://stackoverflow.com/a/17333773/2032279)的名称空间。在我的情况下（glassfish 4.0）和链接的情况下，它必须是

```
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html" 
```

但试试

```
xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
xmlns:f="http://xmlns.jcp.org/jsf/core"
xmlns:h="http://xmlns.jcp.org/jsf/html" 
```

这对我来说适用于Tomcat。

如果有人知道为什么会这样，我会很高兴来到这里。第二个变体应该是我[在这里读到](http://www.oracle.com/webfolder/technetwork/jsc/xml/ns/javaee/index.html)的正确的变体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-09T15:49:46.517

这是一个 JEE7 错误。 [https://java.net/jira/browse/JAVASERVERFACES-2868](https://java.net/jira/browse/JAVASERVERFACES-2868) 作为一种解决方法，我提出：

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://xmlns.jcp.org/jsf/html"
xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
xmlns:f="http://xmlns.jcp.org/jsf/core"
xmlns:oldf="http://java.sun.com/jsf/core"
xmlns:p="http://primefaces.org/ui"
template="/WEB-INF/templates/template.xhtml">
<oldf:metadata>
    <oldf:viewAction action="#{chooseRoleBean.init()}" />
</oldf:metadata> 
```

# php - tcpdf writeHtml() only - 覆盖图像或图像和文本

> ID：11265186
> 
> 赞同：2
> 
> 时间：2012-06-29T16:03:01.530
> 
> 标签：php, html, css, tcpdf

任务是将图像覆盖在另一个图像或文本上。唯一允许使用的方法是 writeHtml()。

*   我试过 padding-left: -XXXmm 但它不起作用。
*   使用 css 对图像进行绝对定位也不起作用。

# mouse - Pygame 检查与最顶部的前景矩形的碰撞

> ID：11265187
> 
> 赞同：0
> 
> 时间：2012-06-29T16:03:04.510
> 
> 标签：mouse, sprite, pygame, rect

我有 10 个精灵，它们是我用不同图像和起始位置等编写的主要精灵的对象。但它们的行为方式都相同。它们是主精灵的子精灵。

我希望能够在一个人的矩形上按住鼠标单击并在屏幕上移动它，这非常好。但问题是它们都有相同的控件单击并拖动以移动它们。因此，如果我单击其中一个精灵矩形并将其拖动到另一个精灵矩形上，它也会将其拾起。我不希望这种情况发生。

有没有办法只检查与最上面的前景矩形的碰撞，或者是否有人可以解释一种可以达到类似结果的方法。我查看了 rect 文档，但找不到解决方案。

```
def update(self,):
    self.move(self.rect)

def move(self,rect):

    if pygame.mouse.get_pressed() == (1, 0, 0) and the_rect.collidepoint(pygame.mouse.get_pos()):
        self.state = 1

    elif pygame.mouse.get_pressed() == (0, 0, 0) and the_rect.collidepoint(pygame.mouse.get_pos()):
        self.state = 0

    if self.state == 0:
        the_rect.centerx = the_rect.centerx
        the_rect.centery =  the_rect.centery
    elif self.state == 1:
        (the_rect.centerx, the_rect.centery) = pygame.mouse.get_pos() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T11:56:02.717

不要使用 pygame.mouse.get_pressed() 函数，而是使用[事件队列](http://www.pygame.org/docs/ref/event.html)并检查 pygame.MOUSEBUTTONDOWN 事件。它只会在第一次按下按钮时触发一次。

# c# - 同一页面上的一个服务器和一个客户端表单

> ID：11265189
> 
> 赞同：0
> 
> 时间：2012-06-29T16:03:14.987
> 
> 标签：c#, asp.net, razor

我在 asp.net 页面上有两个表单。一个是整体表单标签，带有`runat="server"`，另一个是一个简单的表单，带有一个用于搜索的输入。表格本身：

```
<form method="post" id="searchForm">
  <input type="text" id="searchstring" class="search-box" name="searchstring"
    value="Search..." />
</form> 
```

用于检查回发的 Razor 脚本：

```
@{
  bool isPostBack = !String.IsNullOrEmpty(Request.Form["searchstring"]);
  var original_value = "Search...";
  if(isPostBack)
  {
   Response.Redirect("/SearchResults/?q=" + Request["searchstring"]);
   }
  } 
```

这是通过 jQuery 在输入时提交的，如下所示：

```
$(document).ready(function() {
var $search = $('#searchstring');
original_val = "@original_value";
$search.focus(function() {
    if ($(this).val() === original_val) {
        $(this).val('');
    }
}).blur(function() {
    if ($(this).val() === '') {
        $(this).val(original_val);
    }
}).keypress(function(e) {
    if (e.which == 13) {
        $('form#searchForm').submit();
    }
}); });​ 
```

我的问题是，一旦我将搜索表单放在页面上，服务器端表单就会被禁用。例如：我有一个常规的 asp.net 会员登录控件，一旦搜索表单出现在页面上，它就会停止回发。

我在谷歌上看了一会儿，但我能找到的只是人们在一页上谈论两个服务器端表单。也许这是微不足道的，但我无法让它工作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:25:31.430

您可能正在嵌套这两种形式。在这种情况下，外部的（或内部的，取决于浏览器）将不起作用。

解决这个问题很容易：只需将包含的表单移到其包含表单之外。

# linux - numa_police_memory

> ID：11265191
> 
> 赞同：0
> 
> 时间：2012-06-29T16:03:15.287
> 
> 标签：linux, assembly, mips, inline-assembly, numa

我正在 MIPS 机器上调试 NUMACTL。在 numa_police_memory() API 中，我们有：

```
void numa_police_memory(void *mem, size_t size)
{
        int pagesize = numa_pagesize_int();
        unsigned long i;
        for (i = 0; i < size; i += pagesize)
                asm volatile("" :: "r" (((volatile unsigned char *)mem)[i]));
} 
```

似乎“asm volatile("" :: "r" (((volatile unsigned char *)mem)[i]));" 用于读取 VM，以便将先前 mmap 应用的所有内存分配到某些特定的物理内存上。但是这个 asm 代码是如何工作的呢？我看不懂汇编语言！为什么第一个双引号是空的？？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:32:21.260

`asm`有趣的是，尽管使用了语句，但此代码段中根本没有汇编代码。它包含一个空白的程序集“程序”、一个空的输出列表和一个输入列表。输入规范强制`((volatile unsigned char *)mem)[i]`在寄存器中。因此，所有这些魔术都会生成每个页面的第一个字节的负载（页面故障前）。

# python - SQL插入进度条

> ID：11265201
> 
> 赞同：0
> 
> 时间：2012-06-29T16:03:29.500
> 
> 标签：python, python-2.7

我希望能够在这个脚本中插入一种进度条，因为它需要一段时间才能加载。

```
csvReader = csv.reader(open(fo, 'rb'), delimiter=',')
csvList = list(csvReader)
#print len(csvList)
#return
count = 1

for row in csvList[:50000]:
    if count != 1:
        cur.execute(sql2, [row[0], row[2], row[9], row[11], row[18], row[25], row[27], row[15], row[22]])
    count +=1

cnn.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:17:22.450

您正在将 csv 数据加载到内存中 - 所以您有它的长度......

```
# untested
from itertools import count
rows = len(csvList)
pctn = rows // 100
perc = count()
for rowno, row in enumerate(csvList):
    if rowno % pctn == 0:
        print '{}%'.format(next(perc)) 
```

附带说明一下，可能值得考虑让 Python 重新格式化数据，并使用数据库的导入/批量上传机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T19:04:23.823

> I want to be able to insert a kind of progress bar to this script as it takes a while to load

python does have a progress-bar package [http://code.google.com/p/python-progressbar/](http://code.google.com/p/python-progressbar/)

once installed this is how you might use it.

```
from progressbar import  Bar, ETA, Percentage, ProgressBar, RotatingMarker

csvReader = csv.reader(open(fo, 'rb'), delimiter=',')
csvList = list(csvReader)
#print len(csvList)
#return
count = 1
widgets = ['Parsing CSV: ', Percentage(), ' ', Bar(marker = RotatingMarker()), ' ', ETA()]
pbar = ProgressBar(widgets = widgets, maxval = 50000).start()

for index, row in enumerate(csvList[:50000]):
    if count != 1:
        cur.execute(sql2, [row[0], row[2], row[9], row[11], row[18], row[25], row[27], row[15], row[22]])
    count +=1
    pbar.update(index)

pbar.finish()
cnn.close() 
```

you can change the rate of the update by playing around with `maxval` and `update`.

# c# - 在所选数据源上找不到名为“用户名”的字段或属性

> ID：11265203
> 
> 赞同：2
> 
> 时间：2012-06-29T16:03:32.513
> 
> 标签：c#, asp.net, sql-server

我正在使用 SqlDataSource 为 userprofile 绑定 DetailsView，它允许用户查看他们的信息并同时更改他们的详细信息。（选择、检索和更新）

但是，发生了这个错误——当我单击超链接指向“用户配置文件”页面时，在所选数据源上找不到名为“用户名”的字段或属性。

```
Exception Details: System.Web.HttpException: A field or property with the name 'Username' was not found on the selected data source.

Source Error: 

An unhandled exception was generated during the execution of the current web request.   Information regarding the origin and location of the exception can be identified using the   exception stack trace below. 
```

这是 userprofile.aspx 文件中的代码：

```
 <asp:DetailsView ID="UserProfile" runat="server" 
        AutoGenerateRows="False" DataKeyNames="UserId" 
        DataSourceID="UserProfileDataSource" DefaultMode="Edit" 
        onitemupdated="UserProfile_ItemUpdated">
        <Fields>
           <asp:BoundField DataField="Username" HeaderText="Username" 
                SortExpression="Username" />
            <asp:BoundField DataField="HomeTown" HeaderText="HomeTown" 
                SortExpression="HomeTown" />
            <asp:BoundField DataField="HomepageUrl" HeaderText="HomepageUrl" 
                SortExpression="HomepageUrl" />
            <asp:BoundField DataField="Signature" HeaderText="Signature" 
                SortExpression="Signature" />
            <asp:CommandField ShowEditButton="True" />
        </Fields>
    </asp:DetailsView>

    <asp:SqlDataSource ID="UserProfileDataSource" runat="server" 
        ConnectionString="<%$ ConnectionStrings:SecurityTutorialsConnectionString %>" 

        SelectCommand="SELECT * FROM [UserProfiles] WHERE ([UserId] = @UserId)" 
        onselecting="UserProfileDataSource_Selecting" 
        UpdateCommand="UPDATE UserProfiles SET
        Username = @Username,
        HomeTown = @HomeTown,
        HomepageUrl = @HomepageUrl,
        Signature = @Signature   WHERE UserId = @UserId ">

        <SelectParameters>
        <asp:Parameter Name="UserId" Type="Object" />
        </SelectParameters>
        <UpdateParameters>
            <asp:Parameter Name="HomeTown" />
            <asp:Parameter Name="HomepageUrl" />
            <asp:Parameter Name="Signature" />
            <asp:Parameter Name="UserId" />
        </UpdateParameters>
    </asp:SqlDataSource> 
```

这是 userprofile.aspx.cs 背后的代码：

```
 protected void UserProfileDataSource_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
    {
        // Get a reference to the currently logged on user
        MembershipUser currentUser = Membership.GetUser();

        // Determine the currently logged on user's UserId value
        Guid currentUserId = (Guid)currentUser.ProviderUserKey;

        // Assign the currently logged on user's UserId to the @UserId parameter
        e.Command.Parameters["@UserId"].Value = currentUserId;
    } 
```

***编辑*** 我已将 SQL 查询更改为：

```
 SelectCommand= "SELECT [aspnet_Membership].UserId, [HomeTown], [HomepageUrl], [Signature] FROM [UserProfiles] INNER JOIN [aspnet_Membership] ON aspnet_Membership.UserId = UserProfiles.UserId WHERE aspnet_Membership.UserId=@UserId"
    onselecting="UserProfileDataSource_Selecting"
    UpdateCommand="UPDATE UserProfiles SET
    Username = @Username,
    HomeTown = @HomeTown,
    HomepageUrl = @HomepageUrl,
    Signature = @Signature   WHERE UserId = @UserId "> 
```

但错误仍然出现：在所选数据源上找不到名为“用户名”的字段或属性

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:11:11.823

检查 UserProfiles 表中的字段名称。看来您没有用户名字段。明确声明要选择的字段而不是使用`SELECT * FROM ..`语法是一种很好的做法。

```
 <asp:BoundField DataField="Username" HeaderText="Username"  
                SortExpression="Username" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:12:43.710

您可以尝试重新排序字段以查看是否只是用户名的问题？IE，

```
<asp:BoundField DataField="HomeTown" HeaderText="HomeTown" 
                SortExpression="HomeTown" />
<asp:BoundField DataField="Username" HeaderText="Username" 
                SortExpression="Username" /> 
```

如果数据源有问题，您现在应该在“HomeTown”上获得异常。如果这样做，可以尝试的一件事是从参数分配中删除 @：

```
e.Command.Parameters["UserId"].Value = currentUserId; 
```

**编辑**：看到修改后的 SQL 后，有两件事：

1.  在您的 SelectCommand 中，您似乎没有选择用户名。如果`[aspnet_Membership].UserId`是您的用户名，您可以`SELECT [aspnet_Membership].UserId AS Username`
2.  在您的 UpdateCommand 中，您正在为 Username 分配一个值，即使它在 UserProfiles 表中不存在。您还需要在那里使用 JOIN 。

# android - DDMS 中显示的关于已知主机异常的错误的含义是什么

> ID：11265210
> 
> 赞同：0
> 
> 时间：2012-06-29T16:04:06.987
> 
> 标签：android, titanium, ddms

![在此处输入图像描述](../Images/f346891af6d9876d6b02378d9258a87c.png)

你能帮我理解我应该如何调试这个错误吗？你会从这个堆栈跟踪中得到什么信息来帮助你理解这个代码有什么问题？

我认为 andy_lockscreen 不是我关心的问题，因为它与我的应用程序没有任何关系。但是标签 TiApplication 和 TiHttpClient 的错误是什么意思？如何过滤以仅查看有关我的应用程序的错误和跟踪？我正在使用钛开发 android 应用程序

谢谢，

瑞安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:11:37.873

UnkonwnHost 意味着任何试图连接到在线事物的东西都无法连接。在线内容已关闭（不太可能是谷歌地图）或设备没有足够的互联网连接，或者其他东西阻止了连接（可能是 iptables，如果你没有，DroidWall 会导致这种类型的错误将尝试连接的应用程序列入白名单）

您可以通过单击您提供的屏幕截图左侧窗格中的绿色“+”来进行过滤。输入您在应用程序中创建日志语句时使用的标签。这会将列表缩小到仅来自您的应用程序的日志。

# spring-mvc - Shiro Spring 与 @RequiresRoles logical.OR 等效的过滤器链定义

> ID：11265216
> 
> 赞同：1
> 
> 时间：2012-06-29T16:04:20.340
> 
> 标签：spring-mvc, annotations, shiro

我正在尝试使用 Apache Shiro 来增强启用弹簧的 Web 应用程序的安全性，从而将过滤器链定义配置到弹簧配置文件中。我如何达到相当于

```
@Controller
@RequestMapping("/mywebapp")
// @RequiresAuthentication (is this possible ? wish i could do this !)
public class MyWebAppController  {

@RequiresRoles(value={"Role1","Role2","Role3"},logical=Logical.OR)
@RequestMapping(value="/home", method = RequestMethod.GET)
public String home() { return .. } 
```

并且我的 spring-config 文件包含以下内容：假设我的 dispatcherservlet 映射到 /rest/*

```
 <bean id="shiroFilter" class="org.apache.shiro.spring.web.ShiroFilterFactoryBean">
    <property name="securityManager" ref="securityManager"/>
    <property name="loginUrl" value="/rest/secure/windowslogin"/>
    <property name="successUrl" value="/mywebapp/rest/menu"/>
    <property name="unauthorizedUrl" value="/mywebapp/rest/unauthorized"/>
    <property name="filters">
        <util:map>
            <entry key="anon">
                <bean class="org.apache.shiro.web.filter.authc.AnonymousFilter"/>
            </entry>
            <entry key="authc">
       <!-- why is this not invoked ? -->
                <bean class="org.apache.shiro.web.filter.authc.PassThruAuthenticationFilter">
                </bean>
            </entry>
            <entry key="roles">
                <bean class="org.apache.shiro.web.filter.authz.RolesAuthorizationFilter"/>
            </entry>
        </util:map>
    </property>
    <property name="filterChainDefinitions">
        <value>
            /rest/secure/** = anon
            /rest/mywebapp/** = authc, roles[Role1,Role2,Role3]
        </value>
    </property>
</bean> 
```

在上面的代码中，我需要一种逻辑或类型的映射到`/rest/mywebapp/**`使用提到的角色。这可以通过 shiro 注释实现，它可以工作，但不是在每个方法中都指定我宁愿在这里处理它（因为我不认为 shiro 支持类级别的注释？）。这可能吗 ？

另外，为什么不调用 authc 过滤器？（现在我们假设windows登录可以作为认证，shiro只用于授权）

```
home page = meta refresh to /rest/secure/windowslogin/
             if within intranet -> login ...
             else /rest/secure/login ... login page. 
```

是因为登录网址不同吗？我该如何规避这个？请注意，虽然使用配置文件中指定的角色 [ .. ] 部分调用了我的领域的 getAuthorizationInfo .. 但我假设应该检查请求是否为 'authc' ？（这可能意味着调用了过滤器并检查了 SubjectUtils.getSubject() 以进行身份​​验证）。我在流程或配置中遗漏了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T10:11:43.663

这就是 shiro-security.xml 的样子。

```
<bean id="customFilter1" class="com.pkg.RolesAuthorizationFilter">
        <property name="roles" value="ROLE1,ROLE3,ROLE5"></property>
</bean>
<bean id="customFilter2" class="com.pkg.RolesAuthorizationFilter">
        <property name="roles" value="ROLE1,ROLE2,ROLE5,ROLE6"></property>
</bean>

<bean id="shiroFilter" class="org.apache.shiro.spring.web.ShiroFilterFactoryBean">
        <property name="securityManager" ref="securityManager" />
        <property name="loginUrl" value="/login" />
        <property name="successUrl" value="/home" />
        <property name="unauthorizedUrl" value="/unauthorized" />    
     <property name="filters">
        <util:map>
            <entry key="authc">
                <bean   class="org.apache.shiro.web.filter.authc.PassThruAuthenticationFilter" />
            </entry>
        </util:map>
    </property>

<property name="filterChainDefinitions">
            <value>
             /resources/** = anon
                /login = anon
                /logout = authc             
                /unauthorized = authc
                /someurl/** = customFilter2
                /** = customFilter1
            </value>
        </property>
</bean> 
```

这是 RolesAuthorizationFilter 类

```
package com.pkg;

import java.util.Arrays;

import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;

import org.apache.log4j.Logger;
import org.apache.shiro.subject.Subject;
import org.apache.shiro.web.filter.authz.AuthorizationFilter;

public class RolesAuthorizationFilter extends AuthorizationFilter {
    protected Logger logger = Logger.getLogger(this.getClass()
            .getCanonicalName());

    private String[] roles;

    @Override
    protected boolean isAccessAllowed(ServletRequest request,
            ServletResponse response, Object mappedValue) throws Exception {

        logger.info("= Roles = " + Arrays.toString(roles));

        Subject subject = getSubject(request, response);
        boolean allowAccess = false;

        for (String role : roles) {
            if (subject.hasRole(role)) {

                logger.info("Authenticated role " + role);

                allowAccess = true;
                break;
            }
        }

        return allowAccess;
    }

    public void setRoles(String[] roles) {
        this.roles = roles;
    }   
} 
```

# javascript - 为什么我无法访问此 JavaScript 代码中的全局变量？

> ID：11265217
> 
> 赞同：0
> 
> 时间：2012-06-29T16:04:21.103
> 
> 标签：javascript, global-variables

在下面的代码中，我无法从函数中访问“颜色”，但可以访问“numColors”。getColors() 函数似乎正确设置了数组，但 init() 函数无法访问它，如警报语句结果所示。

可以使用参数字符串调用该页面，例如“?colors=0000FF|FF0000”。

```
<!DOCTYPE html>
<html lang="en">

<head></head>

<body>

<script>

( function () {

        var colors = [];
        var numColors;

        document.addEventListener("DOMContentLoaded", init, false );        

        function init() {   
            colors = getColors()

            alert(numColors);
            alert(colors);
        }

        function getColors() {
            var data = getURLParameter('colors');
            var list = data.split('|');

            for (i = 0; i < list.length; i++) {
                colors.push(list[i]);
            }

            numColors = colors.length;

            alert(numColors);
            alert(colors);
        }

        // from http://www.netlobo.com/url_query_string_javascript.html

        function getURLParameter(name) {
            name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");

            var regexS = "[\\?&]" + name + "=([^&#]*)";
            var regex = new RegExp( regexS );

            var results = regex.exec( window.location.href );

            if (results == null) {
                return "";
            } else {
                return results[1];      
            }
        }

} ) ();

</script>            

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:06:28.660

`getColors`修改`colors`它何时运行，然后`colors`用 which 的返回值覆盖`getColors()`（因为它缺少`return`语句）是`undefined`.

删除分配：

```
function init() {   
    getColors() 
```

或更改`getColors`，使其使用局部变量，然后返回它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T16:09:39.617

您的 getColors() 函数没有返回任何内容，但是当您说：

```
colors = getColors(); 
```

我认为如果您只是打电话，这会起作用：

```
getColors(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T16:08:02.417

你的`init()`功能不应该是

```
function init() {   
    getColors();

    alert(numColors);
    alert(colors);
 } 
```

您正在设置函数`colors`的返回值`getColors`。但是，您不返回值，因此`colors`将设置为`undefined`.

# java - 如何停止 WSO2 ESB 4.0.3

> ID：11265225
> 
> 赞同：1
> 
> 时间：2012-06-29T16:04:48.220
> 
> 标签：java, linux, wso2, wso2esb

我已经使用 ./wso2server.sh 启动了 WSO2 ESB 服务器，但是没有脚本可以停止服务器？

谁能告诉命令停止服务器？

谢谢苏雷什

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T19:31:38.567

如果您已经使用 ./wso2server.sh 启动了服务器，那么您可以通过在控制台上同时按 Ctrl 和 c 键来停止服务器，它只会杀死服务器。

如果您已经开始使用 ./wso2server.sh --start 或 ./deamon.sh start，那么您可以使用命令 ./wso2server.sh --stop 或 ./deamon.sh stop 来终止服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T18:57:11.250

`./wso2server.sh --stop`或者`./daemon.sh stop`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T14:06:47.840

Generally, pressing CTRL + C in the terminal you started the server would do.

If it's not possible for you, then do the following.

Enter the command `ps ax | grep wso2esb`

This will list the set of processes started that has the text wso2esb. Unless you opened several esb instances, there will be one process that would like the following [1]. There, the first number refers to the process id.

So, enter following command to **gracefully** shutdown the esb.

`kill <process-id>`

You may force the shutdown by sending signal `kill` (`-9`) like follows if you need to.

`kill -9 <process-id>`

As you may have noticed, the kill command is a native program that comes with most linux distros, not a wso2 provided one.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-06T10:00:29.983

要停止服务器，

*   如果您已经使用 ./wso2server.sh 启动了服务器，那么您可以通过在命令窗口中按 Ctrl+C 来停止服务器
*   如果您已经开始使用 ./wso2server.sh --start 然后停止使用 ./wso2server.sh --stop
*   如果你已经开始使用 ./deamon.sh start 使用 ./deamon.sh stop
*   单击管理控制台导航窗格中的关闭/重新启动链接对所有人都适用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-27T22:27:41.763

这是一个旧线程......但是自从我带着同样的问题来到这里后，我不妨将我找到的答案发布给未来的用户。

关闭 wso2 服务器的另一种方法是通过在线管理控制台。服务器运行后，只需在浏览器中导航到

```
https://localhost:9443/carbon 
```

使用默认用户名和密码“admin”登录服务器的管理页面。然后滚动到页面底部并选择“关机/重启”并从菜单中选择“正常关机”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-31T16:53:55.963

在管理控制台上，我们可以关闭或重启

[![在管理控制台上](../Images/3a04629304bfc37321ce432dc2bcca1f.png)](https://i.stack.imgur.com/CWXyH.png)

在管理控制台上，我们可以关闭/重启

# sql - 实体框架多对多查询生成粗糙的 SQL

> ID：11265226
> 
> 赞同：2
> 
> 时间：2012-06-29T16:04:51.200
> 
> 标签：sql, entity-framework-4.1

我正在开发佣金跟踪系统。商业案例需要销售人员和客户之间的多对多关系。（简化的）实体是：

```
public class Customer {
  public int Id { get; set; }
  public string Name { get; set; }

  public virtual ICollection<CustomerSeller> CustomerSellers { get; set; }
  public virtual ICollection<Payment> Payments { get; set; }
}

public class Seller {
  public int Id { get; set; }
  public string Name { get; set; }
  public virtual ICollection<CustomerSeller> CustomerSellers { get; set; }
}

// join table w/payload for many-to-many relationship
public class CustomerSeller {
  public int Id { get; set; }
  public Seller Seller { get; set; }
  public Customer Customer { get; set; }
  public decimal CommissionRate { get; set; }
}

public class Payment {
  public int Id { get; set; }
  public Customer ReceivedFrom { get; set; }
  public DateTime Date { get; set; }
  public decimal Amount { get; set; }
} 
```

我目前的目标是获取与给定销售人员相关联的所有客户付款清单。如果我直接写 SQL，它看起来像这样：

```
select Payment.* 
from Payment
inner join CustomerSeller on CustomerSeller.Customer_Id = Payment.ReceivedFrom_Id
where CustomerSeller.Seller_Id = @sellerIdToQuery 
```

我正在我的 ASP NET MVC 站点上使用 linq/EF 尝试此代码：

```
public ActionResult Sales(int id) {
  var qry = (
    from p in db.Payments
    join cs in db.CustomerSellers on p.ReceivedFrom equals cs.Customer 
    where cs.Seller.Id == id
    select p);
  var paymentList = qry.ToList();
  return View(paymentList);
} 
```

这确实有效，但幕后 SQL 看起来很复杂（这超出了我的 SQL 解码能力来分析）：

```
{SELECT 
[Extent1].[Id] AS [Id], 
[Extent1].[Date] AS [Date], 
[Extent1].[Amount] AS [Amount], 
[Extent1].[ReceivedFrom_Id] AS [ReceivedFrom_Id]
FROM  [dbo].[Payment] AS [Extent1]
INNER JOIN [dbo].[CustomerSeller] AS [Extent2] ON  EXISTS (SELECT 
    1 AS [C1]
    FROM      ( SELECT 1 AS X ) AS [SingleRowTable1]
    LEFT OUTER JOIN  (SELECT 
        [Extent3].[Id] AS [Id]
        FROM [dbo].[Customer] AS [Extent3]
        WHERE [Extent1].[ReceivedFrom_Id] = [Extent3].[Id] ) AS [Project1] ON 1 = 1
    LEFT OUTER JOIN  (SELECT 
        [Extent4].[Id] AS [Id]
        FROM [dbo].[Customer] AS [Extent4]
        WHERE [Extent2].[Customer_Id] = [Extent4].[Id] ) AS [Project2] ON 1 = 1
    LEFT OUTER JOIN  (SELECT 
        [Extent5].[Id] AS [Id]
        FROM [dbo].[Customer] AS [Extent5]
        WHERE [Extent1].[ReceivedFrom_Id] = [Extent5].[Id] ) AS [Project3] ON 1 = 1
    LEFT OUTER JOIN  (SELECT 
        [Extent6].[Id] AS [Id]
        FROM [dbo].[Customer] AS [Extent6]
        WHERE [Extent2].[Customer_Id] = [Extent6].[Id] ) AS [Project4] ON 1 = 1
    WHERE ([Project1].[Id] = [Project2].[Id]) OR (([Project3].[Id] IS NULL) AND ([Project4].[Id] IS NULL))
)
WHERE [Extent2].[Seller_Id] = @p__linq__0} 
```

如果我的 linq 查询（我是新来的）格式不正确，我会特别感兴趣......应该怎么写？还是我的实体结构有问题？还是 SQL 很好，并且可以在生产环境中的大量数据上高效运行？

**进步：**

首先，Slauma 提出了两个新的查询。在对它们进行试验时，我注意到 SQL 在处理 Customer 和 Seller 字段的连接表 CustomerSeller 上的 NULL 时付出了额外的努力。这是我的一个错误，因为这些字段应该是不可为空的。我在实体中将它们设置为 [必需]：

```
public class CustomerSeller {
  public int Id { get; set; }
  [Required]
  public Seller Seller { get; set; }
  [Required]
  public Customer Customer { get; set; }
  public decimal CommissionRate { get; set; }
} 
```

第一个查询 Slauma 写道：

```
var qry = from p in db.Payments
          where p.ReceivedFrom.CustomerSellers.Any(cs => cs.Seller.Id == id)
          select p; 
```

生成了非常出色的 SQL：

```
SELECT 
[Extent1].[Id] AS [Id], 
[Extent1].[Date] AS [Date], 
[Extent1].[Amount] AS [Amount], 
[Extent1].[ReceivedFrom_Id] AS [ReceivedFrom_Id]
FROM [dbo].[Payment] AS [Extent1]
WHERE  EXISTS (SELECT 
    1 AS [C1]
    FROM [dbo].[CustomerSeller] AS [Extent2]
    WHERE ([Extent1].[ReceivedFrom_Id] = [Extent2].[Customer_Id]) AND ([Extent2].[Seller_Id] = @p__linq__0)
) 
```

Slauma 建议的下一个调整是加入我对 Id 字段而不是整个实体的原始查询：

```
var qry = from p in db.Payments
          //old: join cs in db.CustomerSellers on p.ReceivedFrom equals cs.Customer
          //new:
                 join cs in db.CustomerSellers on p.ReceivedFrom.Id equals cs.Customer.Id
          where cs.Seller.Id == id
          select p; 
```

这会生成一个非常高质量的 SQL 语句：

```
SELECT 
[Extent1].[Id] AS [Id], 
[Extent1].[Date] AS [Date], 
[Extent1].[Amount] AS [Amount], 
[Extent1].[ReceivedFrom_Id] AS [ReceivedFrom_Id]
FROM  [dbo].[Payment] AS [Extent1]
INNER JOIN [dbo].[CustomerSeller] AS [Extent2] ON [Extent1].[ReceivedFrom_Id] = [Extent2].[Customer_Id]
WHERE [Extent2].[Seller_Id] = @p__linq__0 
```

本质上是我自己直接用 SQL 编写的。

**要点：**

(1) 加入键而不是完整实体。

(2) 如果连接表中的多对多映射字段不能有空值，则将它们标记为[必填]，这样可以稍微简化查询。

(3) 为你的 linq 查询检查幕后 SQL，尤其是在频繁使用时，或者当它们可能涉及大量数据时。可能有怪物隐藏。

(4) 斯劳马是一位绅士和一位学者。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:20:26.710

我会这样写查询：

```
var qry = from p in db.Payments
          where p.ReceivedFrom.CustomerSellers.Any(cs => cs.Seller.Id == id)
          select p;
var paymentList = qry.ToList(); 
```

或完全使用扩展方法：

```
var qry = db.Payments
    .Where(p => p.ReceivedFrom.CustomerSellers.Any(cs => cs.Seller.Id == id));
var paymentList = qry.ToList(); 
```

我不知道 SQL 是否与您的查询不同或有多少不同。

**编辑**

选择：

```
var qry = db.CustomerSellers
    .Where(cs => cs.Seller.Id == id)
    .SelectMany(cs => cs.Customer.Payments);
var paymentList = qry.ToList(); 
```

如果`Seller`和`Customer`in`CustomerSellers`具有复合唯一约束，则生成`Payment`的 s 应该没有重复项。否则你需要`Distinct()`在`SelectMany`.

# java - Arquillian 运行模式

> ID：11265227
> 
> 赞同：6
> 
> 时间：2012-06-29T16:04:52.910
> 
> 标签：java, jboss-arquillian

我正试图围绕 Arquillian 进行思考，但我只是没有从根本上理解`in-container`模式与`as-client`模式之间的区别。

我的理解是，使用 Arquillian/ShrinkWrap：

*   您创建一个仅包含您想要集成和测试的组件的存档
*   您将此内存存档流式传输到实际容器（部署它）
*   您将存档作为容器内的测试运行
*   您断言该测试会发生什么

所以，从我的角度来看，一切都“感觉”就像它永远一样`in-container`，因为测试总是在容器内执行。

**请帮助我了解这两种模式之间的区别以及这两种模式适合哪种类型的集成测试。**提供具体代码示例（而*不是*直接来自参考指南的模糊代码示例！）的奖励积分解释了为什么/如何在两种模式下运行测试。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T18:33:32.130

*   **容器内：**用于白盒、集成测试
*   **as-client：**用于黑盒、功能测试

即，对于 UI/功能测试（“作为”在生产中使用应用程序的“客户”角色）使用`as-client`模式与`@RunAsClient`. 对于真正的集成测试（测试您需要有关应用程序本身的内部“白盒”知识的类之间的依赖关系），使用`in-container`模式。

在这两种情况下，ShrinkWrap 和 Arquillian 都将您的内存存档 (JAR/WAR/EAR) 直接部署到配置的容器中（通过 JBoss-homegrown 流式协议），但是当测试以不同的模式运行时，它们对容器的访问权不同，具体取决于关于测试模式。

# mysql - INNER JOIN 执行/评估顺序

> ID：11265235
> 
> 赞同：1
> 
> 时间：2012-06-29T16:05:48.510
> 
> 标签：mysql, join

我想知道内部连接在 mysql 中究竟是如何工作的。

如果我做

```
SELECT * FROM A a 
INNER JOIN B b ON a.row = b.row
INNER JOIN C c ON c.row2 = b.row2
WHERE name='Paul'; 
```

它是否先进行连接，然后选择 name = paul 的连接？因为当我这样做时，它超级慢。

有没有办法做一些事情：

```
SELECT * FROM (A a WHERE name='paul')
INNER JOIN B b ON a.row = b.row
INNER JOIN C c ON c.row2 = b.row2] 
```

当我以这种方式尝试时，我只是得到一个错误。

或者，最好只有 3 个单独的查询，一个用于 A、B 和 C？例子：

```
string query1 = "SELECT * FROM A WHERE name = 'paul'";
//send query, get data reader
string query2 = "SELECT * FROM b WHERE b = " + query1.b;
//send query, get data reader
string query3 = "SELECT * FROM C WHERE c = " + query1.c;
//send query, get data reader 
```

显然这只是伪代码，但我认为它说明了这一点。

哪种方式更快/推荐？

**编辑** 表结构：

```
**tblTimesheet**
int timesheetID (primary key)
datetime date
varchar username
int projectID
string description
float hours

**tblProjects**
int projectID (primary key)
string project name
int clientID

**tblClients**
int clientID
string clientName

The join that I want is:

select * from tblTimesheet time
INNER JOIN tblProject proj on time.projectID = proj.projectID
INNER JOIN tblClient client on proj.clientID = client.clientID
WHERE username = 'paul'; 
```

类似的东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:09:45.513

一个连接的速度极不可能比三个数据库命中慢。如果 MySQL 的查询优化器完全可以胜任，那么重新排序子句也不应该产生影响。`WHERE`/子句中的列是否被`ON`索引？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T16:10:15.220

我认为您会发现查询优化器在大多数情况下都会为您提供最佳查询。您需要查看执行计划以找出查询缓慢的原因 - 我的猜测是缺少索引。

当 MySql 在这些表中查找时，它通常会以最佳方式来获得最佳速度 - 如您所示的简单连接不会混淆查询优化器，但缺少索引会导致数据库引擎改为扫描表查找值（即它需要逐行遍历表以匹配您指定的条件）

索引确保引擎不需要向下搜索到叶页级别，并且通常会加快查询速度

这里的表结构是什么，或者这都是假设的？

SQL 的一般经验法则是 - 试试看！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T16:28:04.223

您可能缺少键表上的索引；您可以使用 MySql [EXPLAIN](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)关键字来帮助找出您的查询慢的地方。

回答您问题的另一部分；

> ```
> is there a way to do something along the lines:
> 
> SELECT * FROM (A a WHERE name='paul')
> INNER JOIN B b ON a.row = b.row
> INNER JOIN C c ON c.row2 = b.row2] 
> ```

您可以使用[SubQuery](http://dev.mysql.com/doc/refman/5.0/en/from-clause-subqueries.html)；

```
SELECT * 
FROM (SELECT * FROM  tblTimesheet WHERE username = 'Paul') AS time
INNER JOIN tblProject proj on time.projectID = proj.projectID
INNER JOIN tblClient client on proj.clientID = client.clientID 
```

这个查询实际上是在尝试预过滤 JOIN 将操作的字段。它不会将所有字段连接在一起，然后将它们过滤掉，它只会尝试从 tblTimesheet 中首先连接名称为“Paul”的字段。

但是，查询优化器应该已经这样做了，因此该查询的执行应该与您的原始查询类似。

要获得更多关于索引的帮助，对索引的理解将极大地帮助您进行数据库开发，请从查看类似[这样的教程开始。](http://www.tizag.com/mysqlTutorial/mysql-index.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T16:10:27.330

使用你的第一个查询，mySql 查询优化器应该选择最快的策略

如果您希望它更快，请确保`name`列上有索引

# javascript - 谷歌地图关闭 infoWindow 不起作用

> ID：11265240
> 
> 赞同：1
> 
> 时间：2012-06-29T16:06:02.537
> 
> 标签：javascript, php, google-maps

我尝试在 PHP 中构建一个小的 Google Maps api，它从数据库中获取 Circles 和 Infowindows。除了在打开信息窗口后关闭它之外，其他任何方法都有效。

The Chrome Developer console throws out the following errors: GET [http://maps.googleapis.com/maps/api/js/StaticMapService.GetMapImage?1m2&1i151368577549307460&2i99567197161272770&2e2&3u50&4m2&1u512&2u496&5m3&1e2&2b1&5sde-DE&token=119415](http://maps.googleapis.com/maps/api/js/StaticMapService.GetMapImage?1m2&1i151368577549307460&2i99567197161272770&2e2&3u50&4m2&1u512&2u496&5m3&1e2&2b1&5sde-DE&token=119415) 404 (Not Found) main.js:33 <- Onload

在点击红色弹出窗口时，它显示以下错误：未捕获的类型错误：对象 # 没有方法“O”

试图找出几个小时的解决方案，希望你能帮助我！

谢谢！

```
 <script type='text/javascript'>
        var _infoWindow = new Array();var _marker = new Array();

        function initialize()   {
            var mapOptions = {
                zoom: 50,
                center: new google.maps.LatLng(48.52039, 9.05949),
                mapTypeId: google.maps.MapTypeId.SATELLITE
            };
            var map = new google.maps.Map(document.getElementById('map'), mapOptions);

            var circles = [{"color":"fff","center":new google.maps.LatLng(48.5204, 9.05949),"radius":200}];     

            for(var circle in circles)  {
                new google.maps.Circle({
                    strokeColor: circles[circle].color,
                    strokeOpacity: 1,
                    strokeWeight: 2,
                    fillColor: circles[circle].color,
                    fillOpacity: 0.35,
                    map: map,
                    center: circles[circle].center,
                    radius: circles[circle].radius
                });
            }

            var infoWindows = [{"center":new google.maps.LatLng(48.5204, 9.05949),"content":"<h2>Juhu!<\/h2>Html<br>Content <b>erlaubt<\/b>!"}];
            var i = 0;

            for(var infoWindow in infoWindows)  {
                _infoWindow[i] = new google.maps.InfoWindow({
                    content: infoWindows[infoWindow].content
                });

                _marker[i] = new google.maps.Marker({
                    position: infoWindows[infoWindow].center,
                    map: map,
                    title:'Test'
                });

                google.maps.event.addListener(_marker[i], 'click', new Function('_infoWindow['+i+'].open(map,_marker['+i+']);'));

                i++;
            }

        }

        window.onload = function(){
            initialize();
        }
    </script>
</head>

<body>
    <div id='map' style='height:500px;width:500px;'></div>      
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T04:30:10.963

您正在本地范围内定义地图变量（初始化），在点击处理程序中将无法访问它。

将此添加到脚本的顶部：

```
var map; 
```

并从此行中删除 var 关键字：

```
var map = new google.maps.Map(document.getElementById('map'), mapOptions); 
```

# excel - 如何使 Excel 单元格的颜色取决于另一个工作表中另一个单元格的值？

> ID：11265242
> 
> 赞同：0
> 
> 时间：2012-06-29T16:06:05.893
> 
> 标签：excel, conditional-formatting, vba

这是交易。

假设工作表 1 包含超过 的数值数据。例如 ：

```
Country Population  GDP  ...
India       V1       V4  ...
Russia      V2       V3  ...
  ...       ...     ...  ... 
```

在第 2、3、...、n 页上，每个国家/地区都由一个单元格表示。

我想： - 工作表 2 根据工作表 1 的第 2 列为各个国家着色... - 工作表 n 根据工作表 1 的第 n 列为各个国家着色

（如热图）

我找到了描述如何着色的链接： - 一个单元格取决于它包含的值（条件格式的简单使用） - 一个单元格取决于同一张表中另一个单元格的值

我需要的是一种根据另一张表中单元格的值对单元格着色的方法。

实现这一目标需要什么？一些 VBA 或只需点击几下鼠标...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:25:55.440

解决条件格式公式的同一张纸限制的一种解决方案是在另一张纸上命名范围。您可以在条件格式公式中使用对命名范围的引用，即使这些范围位于另一张纸上。

因此，例如，您可以将 Sheet1 上的国家列命名为“Countries”，然后将人口数据的（相同大小）列命名为“Pops”。然后，选择 Sheet2 上的热图区域（`B2`下例中的左上角），并使用如下公式应用条件格式规则

```
=INDEX(Pops,MATCH(B2,Countries,0))>1000000000 
```

以及您要应用的任何格式。此特定示例将格式应用于人口超过 10 亿的国家/地区。

以这种方式使用条件格式的缺点是您必须为每个颜色类别定义一个规则；您不能在 Excel 中使用预定义的“连续”色标。

# action - 如何为 Struts 1 创建 BaseAction？

> ID：11265243
> 
> 赞同：1
> 
> 时间：2012-06-29T16:06:07.200
> 
> 标签：action, struts1, struts-action

我有这个问题：

我需要为 java web 应用程序（使用 Struts 1）创建一个 BaseAction。所有的动作都将扩展这个 BaseAction 并且所有的动作都有更多的方法（创建、更新、删除、列表等）。没有“执行”方法。

我需要这个来获得 Spring 的 ApplicationContext 以及身份验证或所有操作都应该做的其他事情。

当只有“execute”方法时，事情就简单了……只需使用“execute”方法和抽象的“performTask”方法创建 BaseAction。“forward”将是所有其他操作都将实现的“performTask”方法的结果。

所以我不能为具有多个方法的动作做相同的设计，并且每种方法都有自己的前进。

谢谢，Adri108

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T07:53:05.647

在 Struts 1 中，`struts-config.xml`是一个驱动文件。该文件将各种操作重定向到相应的`ActionForward`方法。

# javascript - 如何覆盖 JS URL 覆盖？

> ID：11265244
> 
> 赞同：0
> 
> 时间：2012-06-29T16:06:11.657
> 
> 标签：javascript, facebook, browser

我注意到我已经登录到 FB，并且有人发布了一个链接，当我将鼠标悬停在它上面时，我的状态栏（在底部......那是状态，对吗？）显示故事的 URL ，但是如果我右键单击并说“复制链接”，则链接将转换为附加了 FB 跟踪的链接。例如，有人发布了波士顿评论的故事。屏幕和悬停文本都显示 URL 是：

[http://www.bostonreview.net/BR37.4/junot_diaz_paula_moya_drown_race.php](http://www.bostonreview.net/BR37.4/junot_diaz_paula_moya_drown_race.php)

但是，如果我真的单击链接或右键单击并说“复制链接地址”或“复制链接位置”，则 URL 将转换为类似这样的内容（我交换了一些 x）：

[http://www.facebook.com/l.php?u=http%3A%2F%2Fwww.bostonreview.net%2FBR37.4%2Fjunot_diaz_paula_moya_drow_race.php&h=wAQG1wXXXXXyoIDSg_ceA9JIXoBRD_o6XXXXXA0Llo4HA](http://www.facebook.com/l.php?u=http%3A%2F%2Fwww.bostonreview.net%2FBR37.4%2Fjunot_diaz_paula_moya_drown_race.php&h=wAQG1wXXXXXyoIDSg_ceA9JIXoBRD_o6XXXXXA0Llo4HA)

我可以使用元素检查器来绕过它，但我很好奇我是否可以通过其他方式禁用它。

我意识到这只是一个编程问题，因为我真的只是想调整我自己的浏览器行为，但我不知道还能问哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:15:46.033

> 但我很好奇我是否可以通过其他方式禁用它。

您可以编写自己的*用户 JavaScript* / 浏览器扩展程序 / 书签，它会遍历页面上的所有链接，如果它们的 href 具有正确的格式，则提取*u*参数并将其设置为新的 href ...</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:12:35.733

您无法更改 Facebook 上的链接。Facebook 上的所有链接都通过其链接跟踪页面。Facebook 可能以多种方式使用它（用户跟踪、防病毒等）。Faceboo 中的所有链接，无论是通过应用程序还是由用户手动发布，都将通过`l.php`.

# zend-framework - 为什么我的带有 Zend Framework 的 PHP 自更新到 5.4（在文件系统上存在会话之后）对“会话启动”感到疯狂？

> ID：11265245
> 
> 赞同：5
> 
> 时间：2012-06-29T16:06:13.710
> 
> 标签：zend-framework, php

我的任何项目都没有遇到过问题。就在最近，当我在 arch linux（更新到 5.4）中运行 pacman-update 时，我的许多项目不再可运行。

有趣的是，只有**在文件系统上创建会话文件**时才会出现问题。我的意思是，只要 /tmp/sess* 不存在，我就可以第一次调用该网站。

当我想第二次调用它并且 /tmp/sess* 已经写入时，我收到以下错误（包括堆栈跟踪、Zend 框架）。

```
Zend_Controller_Exception: session has already been started by session.auto-start or session_start()#0 /srv/http/bahasa/library/Zend/Session/Namespace.php(143): Zend_Session::start(true)
#1 /srv/http/bahasa/library/Zend/Auth/Storage/Session.php(87): Zend_Session_Namespace->__construct('Zend_Auth')
#2 /srv/http/bahasa/library/Zend/Auth.php(91): Zend_Auth_Storage_Session->__construct()
#3 /srv/http/bahasa/library/Zend/Auth.php(141): Zend_Auth->getStorage()
#4 /srv/http/bahasa/library/Skoch/Controller/Plugin/Navigation.php(59): Zend_Auth->hasIdentity()
#5 /srv/http/bahasa/library/Zend/Controller/Plugin/Broker.php(287): Skoch_Controller_Plugin_Navigation->dispatchLoopStartup(Object(Zend_Controller_Request_Http))
#6 /srv/http/bahasa/library/Zend/Controller/Front.php(928): Zend_Controller_Plugin_Broker->dispatchLoopStartup(Object(Zend_Controller_Request_Http))
#7 /srv/http/bahasa/library/Zend/Application/Bootstrap/Bootstrap.php(97): Zend_Controller_Front->dispatch()
#8 /srv/http/bahasa/library/Zend/Application.php(366): Zend_Application_Bootstrap_Bootstrap->run()
#9 /srv/http/bahasa/public/index.php(30): Zend_Application->run()
#10 {main} in /srv/http/bahasa/library/Zend/Controller/Plugin/Broker.php on line 312 
```

当然，我已经在stackoverflow上检查了这个问题的其他答案，但是：

*   session.auto-start 设置为 0
*   在 library/Zend/ 之外的地方没有 session_start() 调用（在整个项目目录上做了 grep -r）
*   在 Bootstrap.php 中编写 Zend_Session::start() （作为错误修复）会导致新的致命错误
*   文件系统权限没问题，/tmp 有 777 并且创建的 sess 文件有 http rw（777 不会改变行为）。

也正如所说，当我从 PHP 5.3 更新到 PHP 5.4 时，它就奇怪地发生了。问题是，降级似乎不起作用（然后mysql库以某种方式损坏）。

正如已经提到的，对我来说最奇怪的是，**它只发生在 /tmp 中创建会话文件时**。当 /tmp 没有会话文件时，一切正常。

是的，这不仅是我自己的项目受到影响，而且我正在为另一家公司工作（在他们的服务器和本地 PC 上运行就像魅力一样），所以这也与我自己的代码中的问题相矛盾（同样事情发生在两个 Zend Framework 项目中）。

当然，我的项目也使用 PHP 5.2.12 在我的在线网络空间上运行。

我想之前的 PHP 通知也可能很有趣：

```
Notice: Array to string conversion in /srv/http/bahasa/library/Zend/Session/Exception.php on line 58

Call Stack:
0.0009     134352   1\. {main}() /srv/http/bahasa/public/index.php:0
0.2805    3703732   2\. Zend_Application->run() /srv/http/bahasa/public/index.php:30
0.2805    3703756   3\. Zend_Application_Bootstrap_Bootstrap->run() /srv/http/bahasa/library/Zend/Application.php:366
0.2806    3703876   4\. Zend_Controller_Front->dispatch() /srv/http/bahasa/library/Zend/Application/Bootstrap/Bootstrap.php:97
0.2873    3829732   5\. Zend_Controller_Plugin_Broker->routeStartup() /srv/http/bahasa/library/Zend/Controller/Front.php:908
0.2873    3829820   6\. Skoch_Controller_Plugin_Autologin->routeStartup() /srv/http/bahasa/library/Zend/Controller/Plugin/Broker.php:237
0.2883    3840992   7\. Zend_Auth->hasIdentity() /srv/http/bahasa/library/Skoch/Controller/Plugin/Autologin.php:12
0.2884    3841016   8\. Zend_Auth->getStorage() /srv/http/bahasa/library/Zend/Auth.php:141
0.2960    3980864   9\. Zend_Auth_Storage_Session->__construct() /srv/http/bahasa/library/Zend/Auth.php:91
0.2960    3981072  10\. Zend_Session_Namespace->__construct() /srv/http/bahasa/library/Zend/Auth/Storage/Session.php:87
0.2961    3981232  11\. Zend_Session::start() /srv/http/bahasa/library/Zend/Session/Namespace.php:143
0.2968    3989956  12\. session_start() /srv/http/bahasa/library/Zend/Session.php:469
0.2972    3997536  13\. PropelAutoloader->autoload() /srv/http/bahasa/library/Zend/Session.php:0
0.3000    4060508  14\. require('/srv/http/bahasa/application/models/bahasa/User.php') /srv/http/bahasa/library/propel-1.6.4/runtime/lib/util/PropelAutoloader.php:108
0.3377    4925056  15\. Zend_Session_Exception::handleSessionStartError() /srv/http/bahasa/library/propel-1.6.4/runtime/lib/util/PropelAutoloader.php:16 
```

但是，Propel 似乎在自己的代码中没有任何 session_start()，所以这不是原因（propel 也位于检查的项目主管中）。

我个人还没有看到这个通知的全部含义，但是我看的时间越长，它似乎与错误相关的越多（至少是堆栈跟踪，我的意思是通知只是关于数组到字符串的转换）。

# 调用 Zend_Session::start() 的回溯

好的，我在`Zend_Session::start()`被调用两次时找到了回溯。

第一的：

```
#0  Zend_Session::start(1) called at [/srv/http/bahasa/library/Zend/Session/Namespace.php:143]
#1  Zend_Session_Namespace->__construct(Zend_Auth) called at [/srv/http/bahasa/library/Zend/Auth/Storage/Session.php:87]
#2  Zend_Auth_Storage_Session->__construct() called at [/srv/http/bahasa/library/Zend/Auth.php:91]
#3  Zend_Auth->getStorage() called at [/srv/http/bahasa/library/Zend/Auth.php:141]
#4  Zend_Auth->hasIdentity() called at [/srv/http/bahasa/library/Skoch/Controller/Plugin/Autologin.php:12]
#5  Skoch_Controller_Plugin_Autologin->routeStartup(Zend_Controller_Request_Http Object ([] => Array ([0] => _GET,[1] => _POST),[] => /de/,[] => ,[] => ,[] => ,[] => Array (),[] => ,[] => Array (),[] => ,[] => ,[] => module,[] => ,[] => controller,[] => ,[] => action)) called at [/srv/http/bahasa/library/Zend/Controller/Plugin/Broker.php:237]
#6  Zend_Controller_Plugin_Broker->routeStartup(Zend_Controller_Request_Http Object ([] => Array ([0] => _GET,[1] => _POST),[] => /de/,[] => ,[] => ,[] => ,[] => Array (),[] => ,[] => Array (),[] => ,[] => ,[] => module,[] => ,[] => controller,[] => ,[] => action)) called at [/srv/http/bahasa/library/Zend/Controller/Front.php:908]
#7  Zend_Controller_Front->dispatch() called at [/srv/http/bahasa/library/Zend/Application/Bootstrap/Bootstrap.php:97]
#8  Zend_Application_Bootstrap_Bootstrap->run() called at [/srv/http/bahasa/library/Zend/Application.php:366]
#9  Zend_Application->run() called at [/srv/http/bahasa/public/index.php:29] 
```

第二：

```
#0  Zend_Session::start(1) called at [/srv/http/bahasa/library/Zend/Session/Namespace.php:143]
#1  Zend_Session_Namespace->__construct(Zend_Auth) called at [/srv/http/bahasa/library/Zend/Auth/Storage/Session.php:87]
#2  Zend_Auth_Storage_Session->__construct() called at [/srv/http/bahasa/library/Zend/Auth.php:91]
#3  Zend_Auth->getStorage() called at [/srv/http/bahasa/library/Zend/Auth.php:141]
#4  Zend_Auth->hasIdentity() called at [/srv/http/bahasa/library/Skoch/Controller/Plugin/Navigation.php:59]
#5  Skoch_Controller_Plugin_Navigation->dispatchLoopStartup(Zend_Controller_Request_Http Object ([] => Array ([0] => _GET,[1] => _POST),[] => /de/,[] => ,[] => ,[] => de,[] => … 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T17:21:34.173

好的，我发现了错误。这完全不是你能找到的，但一般的答案对其他人来说可能很有趣。

# 一般回答

该通知确实与错误有关。问题是，Zend_Session_Exception 被注册为 session_start() 的错误处理程序，并且 session_start() 将小通知传递给 Zend_Session_Exception。即使它只是一个通知（它不会在生产系统上被触发，因此它在那里工作），Zend_Session_Exception 被触发并设置`Zend_Session_Exception::$sessionStartError`为错误。

一旦记录了这样的错误，会话将不会注册到 Zend_Session。**即使 session_start() 本身返回 true**

您可以在这一行中看到这一点（`$startedCleanly`表示 的返回值`session_start()`）： `if (!$startedCleanly || Zend_Session_Exception::$sessionStartError != null) {`

# 具体答案

在我的特殊情况下，这一切都是由于继承冲突。我没有将 Propels（数据库 ORM）基类的参数添加到我的子类中。然后 PHP 发送了一个通知，我应该更正这个。

因为这样的 Propel 对象存在于我的会话 ( `User`) 中，所以在调用 session_start() 时会触发通知。这就是 Zend_Session_Exception 被警告的原因。然后它就像上面描述的那样。

# 仍然悬而未决的问题

我还没有发现，为什么这种行为出现在 PHP 5.4 中。我之前也没有实现过参数，但在解决会话时从未将其视为问题。猜猜他们在打开会话值时已经改变了一些东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-17T15:13:39.337

如果您在从 PHP 5.3 升级到 PHP 5.4+ 后遇到 Zend_Session_Exception，则问题*可能*是由`E_STRICT`错误引起的。在 PHP 5.4`E_STRICT`中成为`E_ALL`.

您可以在 php.ini 中禁用严格错误：

```
error_reporting = E_ALL & ~E_STRICT 
```

您会期望异常会消失，但问题在于 Zend_Session 类中的以下几行：

```
$errorLevel = (is_int(self::$_throwStartupExceptions)) ? self::$_throwStartupExceptions : E_ALL;

// some code omitted
set_error_handler(array('Zend_Session_Exception', 'handleSessionStartError'), $errorLevel);

// some code omitted
set_error_handler(array('Zend_Session_Exception', 'handleSilentWriteClose'), $errorLevel); 
```

`error_reporting`基本上， Zend_Session_Exception 被注册为一个错误处理程序，如果您不设置该`throw_startup_exceptions`选项，它将为所有错误级别（不管设置的设置）调用。

我的解决方案是将选项设置`throw_startup_exceptions`为，`false`直到我修复代码中的严格/通知错误。

您可以在 application.ini 中设置它：

```
resources.session.throw_startup_exceptions = false 
```

或致电`Zend_Session::setOptions()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-29T20:46:38.800

清除浏览器的 cookie。PHP 会话似乎将 SID 存储在 cookie 中，因此当我从 php 5.3 切换到 5.4 时，似乎在处理会话的现有 cookie 值时出现了一些问题。简单地清除会话数据是不够的 - 尝试清除所有会话数据并删除浏览器 cookie。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-31T13:22:49.237

在我的情况下，它只是允许会话目录的写入模式

# excel - Replacing reference of Excel 2003 to Excel 2010 in my VB6 project

> ID：11265247
> 
> 赞同：3
> 
> 时间：2012-06-29T16:06:23.977
> 
> 标签：excel, vb6, early-binding

I have a VB6 application running for years. This application always reference Excel 2003 in the past for creating XLS files. Now we would like to use Excel 2010 in place of 2003\. So I installed only Excel 2010 on a separate dev computer and load my vb6 project.

When running the app, I got the error where my 'Microsoft Excel 10.0 Object Library' is missing. This is true because only Excel 2010 is installed on this computer and no more Excel 2003.

**The problem** is that when I would like the correct reference, I didn't find any 'Microsoft Excel 14.0 Object Library' or something equivalent for replacing this reference.

Any suggestion?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T22:53:05.570

Early bound reference are "bound" (excuse the pun) to cause a problem on applications being distributed to users with different Excel versions.

Using late binding and coding for the earliest version of Excel you are willing to support is the solution. For example, if you were supporting Excel 2000, your application would only use methods supported in Excel 2000.

However, if your code was late bound, you could use ambiguous method calls and detect the local version to determine which code to run.

Ex:

```
Dim excelVersion As Long  
Dim xl As Object

' get a reference to Excel.Application maybe from AddinInstance_OnConnection()?  
excelVersion = Val(xl.Version)

Select Case excelVersion 
Case 11 ' Excel 2003
  ' Excel 2003-only methods here
  ' ex: xl.FileSearch
Case 12 ' Excel 2007
  ' Excel 2007-only methods here
Case 14 ' Excel 2010
  ' Excel 2010-only methods here
  ' ex: something with Slicers
End Select 
```

Since the code is late bound (i.e. derived from Object), I can specify methods that are valid only in Excel 2010 and the code will still compile. If the code was early bound to Excel 2003, it wouldn't compile. At runtime I determine the version to decide which methods to use.

You might also consider compiling different versions of your application, if you are using Excel 2010-specific features. Only you would know if that is possible.

Also, and I thought of this after writing this answer, but can't you reference Excel 2010 in your app, and if it is installed on computers with earlier versions of Excel, won't the reference automatically adjust to whatever version of Excel is installed?

# python - 需要在 python 中列出缺少图像编号的图像序列

> ID：11265251
> 
> 赞同：0
> 
> 时间：2012-06-29T16:06:42.667
> 
> 标签：python

我可以列出目录中的图像文件，它们看起来像这样：

```
['IMG_3842.CR2', 'IMG_3843.CR2', 'IMG_3844.CR2', 'IMG_3846.CR2', 'IMG_3847.CR2', 
'IMG_3848.CR2', 'IMG_3849.CR2', 'IMG_3850.CR2', 'IMG_3851.CR2', 'IMG_3852.CR2', 
'IMG_3855.CR2', 'IMG_3856.CR2', 'IMG_3857.CR2', 'IMG_3858.CR2', 'IMG_3859.CR2'] 
```

文件编号范围从 3842 到 3859。但是，数字之间存在差距。我需要做的是得到一个这样的列表作为输出：

`3842-3844, 3846-3852, 3855-3859`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:42:00.057

[根据序列中缺失的数字](https://stackoverflow.com/questions/3149440/python-splitting-list-based-on-missing-numbers-in-a-sequence)参考Python拆分列表

```
import glob
from itertools import groupby

def ranges(seq, key=int):
    return [[x[1] for x in g] for k, g in groupby(enumerate(seq), lambda i,x:i-key(x))]

files = list(glob.glob('*.cr2'))
files.sort() 
```

现在你可以打电话

```
ranges(files, key=lambda s: int(s[4:8])) 
```

并得到

```
[
    ['IMG_3842.CR2',
     'IMG_3843.CR2',
     'IMG_3844.CR2'],
    ['IMG_3846.CR2',
     'IMG_3847.CR2',
     'IMG_3848.CR2',
     'IMG_3849.CR2',
     'IMG_3850.CR2',
     'IMG_3851.CR2',
     'IMG_3852.CR2'],
    ['IMG_3855.CR2',
     'IMG_3856.CR2',
     'IMG_3857.CR2',
     'IMG_3858.CR2',
     'IMG_3859.CR2']
] 
```

**编辑：**

```
filenums = [f[4:8] for f in files]
range_strings = ["{}-{}".format(rng[0], rng[-1]) for rng in ranges(filenums)] 
```

给

```
['3842-3844', '3846-3852', '3855-3859'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:25:54.713

假设列表已经排序，并且所有项目具有相同的格式

```
l = ['IMG_3842.CR2', 'IMG_3843.CR2', 'IMG_3844.CR2', 'IMG_3846.CR2', 'IMG_3847.CR2', 'IMG_3848.CR2', 'IMG_3849.CR2', 'IMG_3850.CR2', 'IMG_3851.CR2', 'IMG_3852.CR2', 'IMG_3855.CR2', 'IMG_3856.CR2', 'IMG_3857.CR2', 'IMG_3858.CR2', 'IMG_3859.CR2']

numl = [int(x[4:8]) for x in l]

first = numl[0]
result = []

for i in range(len(numl))[1:]:
    if numl[i] != numl[i-1] + 1:
        result.append(str(first) + '-' + str(numl[i-1]))
        first = numl[i]

result.append(str(first) + '-' + str(numl[-1]))

print result 
```

**输出**：

`['3842-3844', '3846-3852', '3855-3859']`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T16:13:05.010

像这样：[迭代很简单，我只是想尝试一下`reduce`；）]

```
S = ['IMG_3842.CR2', 'IMG_3843.CR2', 'IMG_3844.CR2', 'IMG_3846.CR2', 'IMG_3847.CR2', 'IMG_3848.CR2', 'IMG_3849.CR2', 'IMG_3850.CR2', 'IMG_3851.CR2', 'IMG_3852.CR2', 'IMG_3855.CR2', 'IMG_3856.CR2', 'IMG_3857.CR2', 'IMG_3858.CR2', 'IMG_3859.CR2', 'IMG_3863.CR2']

l = sorted([int(x[x.index("_")+1:x.index(".")]) for x in S])

def func(l,val):
    if val == l[-1][1]+1:
        l[-1] = (l[-1][0], l[-1][1]+1)
    else:
        l.append((val,val))
    return l

res = reduce(func, l, [(-1,-1)])[1:]
print [str(x[0]) if x[0] == x[1] else "{}-{}".format(x[0],x[1]) for x in res] 
```

输出：

```
['3842-3844', '3846-3852', '3855-3859', '3863'] 
```

# java - Java中的lm.wfit

> ID：11265252
> 
> 赞同：1
> 
> 时间：2012-06-29T16:06:44.460
> 
> 标签：java, r

我正在拼命寻找用 JAVA 编写的 R lm.wfit 的类比。我发现只有 Apache Commons 类似的东西 public void newSampleData(double[] y,double[][] x) 但它不使用权重进行估计，但在我的情况下权重非常重要。如果有人以前遇到过这个问题，请告诉我。谢谢！

# android - 包括具有自定义属性的布局

> ID：11265258
> 
> 赞同：54
> 
> 时间：2012-06-29T16:07:08.640
> 
> 标签：android, android-layout

我正在构建一个复杂的布局，我想`include`为我的自定义组件使用标签，如下所示：

```
<include layout="@layout/topbar"/> 
```

布局具有自定义根`topbar`组件，在布局 xml 文件中定义如下：

```
<my.package.TopBarLayout
 ... a lot of code 
```

现在，我想将自定义属性传递给“topbar”，如下所示：

```
<include layout="@layout/topbar" txt:trName="@string/contacts"/> 
```

然后在自定义组件代码或理想情况下在 xml 中获取这些自定义属性的值。

可悲的是，我无法获得`txt:trName`属性值以使其进入`topbar`布局，我只是没有收到任何代码。如果我从[该文档页面](http://developer.android.com/guide/topics/resources/layout-resource.html)中理解正确，我可以不为通过 、 但是 和 使用的布局设置`include`任何属性。`id``height``width`

所以我的问题是如何将自定义属性传递给通过添加的布局`include`？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2016-07-31T06:33:23.707

我知道这是一个老问题，但我遇到了它，发现现在可以通过数据绑定来实现。

首先，您需要在项目中启用[数据绑定](https://developer.android.com/topic/libraries/data-binding/index.html#includes)。使用`DataBindingUtil.inflate`( 而不是`setContentView`, 如果是`Activity`) 使其工作。

然后将数据绑定添加到要包含的布局中：

```
<?xml version="1.0" encoding="utf-8"?>    
<layout xmlns:android="http://schemas.android.com/apk/res/android">
    <data>
        <variable name="title" type="java.lang.String"/>
    </data>
    <RelativeLayout xmlns:app="http://schemas.android.com/apk/res-auto"
        android:id="@+id/screen_header"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="top"
        android:gravity="center">

    ...

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerInParent="true"
            android:textSize="20sp"
            android:textStyle="bold"
            android:text="@{title}"/>

    ...

    </RelativeLayout>
</layout> 
```

最后，将变量从主布局传递到包含的布局，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:app="http://schemas.android.com/apk/res-auto">
    <data>
        ...
    </data>
    ...
    <include layout="@layout/included_layout"
        android:id="@+id/title"
        app:title="@{@string/title}"/>
    ...
</layout> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-10T18:35:53.387

除了布局参数、可见性或 ID 之外，不能在包含标签上添加属性。这包括自定义属性。

您可以通过查看 LayoutInflater.parseInclude 方法的源代码来验证这一点，在第 705 行附近：http: [//grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1 .1/android/view/LayoutInflater.java#640](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/view/LayoutInflater.java#640)

充气器仅将 ID 和可见性属性应用于包含的布局。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-04-12T21:00:46.250

我今天遇到了这个问题。不管它值多少钱，我认为有一个直截了当的工作。不要向包含标签添加属性，而是为包含创建一个自定义包装器视图并为其添加属性。然后，从包装器中包含。让包装类实现提取属性并传递给它的单个孩子，这是包含布局的根视图。

因此，假设我们为一个名为 SingleSettingWrapper 的包装器声明了一些自定义属性，如下所示 -

```
<declare-styleable name="SingleSettingWrapper">
    <attr name="labelText" format="string"/>
</declare-styleable> 
```

然后，我们创建两个自定义视图类 - 一个用于包装器 (SingleSettingWrapper)，另一个用于将包含的子视图 (SingleSettingChild) -

```
<!-- You will never end up including this wrapper - it will be pasted where ever you wanted to include. But since the bulk of the XML is in the child, that's ok -->
<com.something.SingleSettingWrapper
    android:id="@+id/wrapper"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    custom:labelText="@string/my_label_string">

    <!-- Include the child layout -->
    <include layout="@layout/setting_single_item"/>

</com.something.SingleSettingWrapper> 
```

对于孩子，我们可以在其中放置我们想要的任何复杂布局。我只会放一些基本的东西，但实际上你可以包括任何东西 -

```
<com.something.SingleSettingItem
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">
    <RelativeLayout >
        <!-- add whatever custom stuff here -->
        <!-- in this example there would be a text view for the label and maybe a bunch of other stuff -->
        <!-- blah blah blah -->
    </RelativeLayout>
</com.something.SingleSettingItem> 
```

对于包装器（这是关键），我们在构造函数中读取了所有自定义属性。然后，我们覆盖 onViewAdded() 并将这些自定义属性传递给我们的孩子。

```
public class SingleSettingWrapper extends FrameLayout 
{
    private String mLabel;

    public SingleSettingWrapper(Context context, AttributeSet attrs)
    {
        super(context, attrs);

        TypedArray a = context.getTheme().obtainStyledAttributes(attrs,
                                                             R.styleable.SingleSettingWrapper,
                                                             0, 0);

        mLabel = a.getString(R.styleable.SingleSettingWrapper_labelText);
        a.recycle();
    }

    public void onViewAdded(View child)
    {
        super.onViewAdded(child);
        if (!(child instanceof SingleSettingItem))
            return;

       ((TextView)child.findViewById(R.id.setting_single_label)).setText(mLabel);
        /*
        Or, alternatively, call a custom method on the child implementation -
        ((SingleSettingItem)child)setLabel(mLabel);
        */
    }
} 
```

或者，您也可以实现孩子，让它从包装器接收消息并修改自身（而不是让包装器像我上面那样修改孩子）。

```
public class SingleSettingItem extends LinearLayout
{
    public SingleSettingItem(Context context, AttributeSet attrs)
    {
        super(context, attrs);
    }

    public void setLabel(String l)
    {
        // set the string into the resource here if desired, for example
    }
} 
```

在一天结束时，您想要`<include>`布局的每个 XML 文件都将包含大约 7 行 XML 用于包装器+包含而不是您想要的单个包含，但是如果包含的视图包含数百行您再好不过了。例如 -

```
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:custom="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <!-- this is the beginning of your custom attribute include -->
    <com.something.SingleSettingWrapper
        android:id="@+id/my_wrapper"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        custom:labelText="@string/auto_lock_heading">
        <include layout="@layout/setting_single_item"/>
    </com.something.SingleSettingWrapper>
    <!-- this is the end of your custom attribute include -->
</LinearLayout> 
```

在实践中，这似乎工作得很好，而且设置起来也相对简单。我希望它可以帮助某人。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-01-11T06:49:49.340

不幸的是，我唯一可以贡献的是我也无法在包含标签上设置自定义属性，并让它们传递到包含的布局。

在这一点上，这很可能是不可能的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-01T17:25:24.500

不能与自定义属性或 API 页面上声明的属性以外的任何属性一起使用（至少 5.0.0）：

[https://code.google.com/p/android/issues/detail?id=38023](https://code.google.com/p/android/issues/detail?id=38023)

[http://grepcode.com/file/repo1.maven.org/maven2/org.robolectric/android-all/5.0.0_r2-robolectric-1/android/view/LayoutInflater.java](http://grepcode.com/file/repo1.maven.org/maven2/org.robolectric/android-all/5.0.0_r2-robolectric-1/android/view/LayoutInflater.java)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-29T16:13:44.650

您必须在您的根 xml 元素中包含您的自定义命名空间。如果你的包名是 com.example.test 你的 xml 应该是这样的：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:txt="http://schemas.android.com/apk/res/com.example.test" /> 
```

一个不错的教程是：[http ://blog.infidian.com/2008/05/02/android-tutorial-42-passing-custom-variables-via-xml-resource-files/](http://blog.infidian.com/2008/05/02/android-tutorial-42-passing-custom-variables-via-xml-resource-files/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-20T03:36:32.147

我有同样的问题。访问此线程后，我最终使用`View`'s`setTag()`方法将识别信息附加到每个`View`during `onCreate()`，然后`getTag()`使用方法稍后检索它。

# google-analytics - jquery 地址和阻止谷歌分析跟踪？

> ID：11265259
> 
> 赞同：2
> 
> 时间：2012-06-29T16:07:13.587
> 
> 标签：google-analytics, jquery-address

在使用 jquery 地址插件时，我将如何防止在谷歌分析中跟踪哈希路径更改？

原网址：

```
/?watch 
```

在页面上移动滑块时，会附加地址栏：

```
/?watch#/204;276 
```

在分析中，我看到它被跟踪为独特的页面浏览量，如下所示：

```
/?watch/204;276 
```

我只是希望它被跟踪为：

```
/?watch 
```

非常感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T18:47:18.580

您可以使用[自定义搜索并将过滤器替换](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1034834&topic=1034830&ctx=topic)为搜索字符串中的正则表达式。

**在设置任何过滤器之前，请在 GA 中创建一个包含未过滤数据的“主”配置文件。**这样，如果您的过滤器对您的数据产生负面影响，您的所有数据都会未经过滤和备份。

我使用的正则表达式是`^/\?watch[/0-9;]+`You can test it at [RegExPlanet](http://www.regexplanet.com/advanced/java/index.html)。我没有在正则表达式中放置井号 (#) 符号，因为根据您的问题，GA 没有在请求 URI 中跟踪它。

![在此处输入图像描述](../Images/0c44df32162c4166079edbbeee399ed9.png)

# ms-access - 如何防止用户向只读表中添加字段？

> ID：11265262
> 
> 赞同：1
> 
> 时间：2012-06-29T16:07:46.940
> 
> 标签：ms-access, ms-access-2007

我正在使用一个按钮制作一个相当简单的表单，该按钮打开一个表格供用户阅读（但不是编辑）。这是命令：

```
DoCmd.OpenTable "Tbl_SendLog", acViewNormal, acReadOnly 
```

1.  好的部分：正如预期的那样，用户不能添加或更改记录
2.  不好的部分：用户仍然可以添加整个列。更好的是，Access 在关闭表格时甚至没有“是否要保存更改”提示。它只是保存它。

我原以为 acReadOnly 会处理这个问题。显然不是。所以我的问题是：*我如何修改它以使用户无法添加列？*

（如果需要，我会为表格制作表格或报告，但如果有更简单的选项，我会改为使用它）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:25:50.927

最简单的方法（=工作最少的方法）是使用查询，正如 Remou 在评论中所建议的那样。

只需进行查询`select * from Tbl_SendLog`并像这样打开它：

```
DoCmd.OpenQuery "YourQuery", acViewNormal, acReadOnly 
```

**优点：**右键查询时，上下文菜单中没有“添加列”（就像直接打开表格时一样），因此用户无法添加列
**反对：**用户仍然可以切换到设计视图查询并弄乱查询，所以也许在那之后它就不再起作用了。

如果您可以忍受（=如果您的用户不太可能更改查询），您可以这样做。

如果您不能忍受，那么构建一个表格或表格（正如您在问题中已经建议的那样）可能是最好的解决方案。

# javascript - 用于 jQuery 的 RSS 提要阅读器插件从博客文章中去除 HTML

> ID：11265264
> 
> 赞同：0
> 
> 时间：2012-06-29T16:08:00.183
> 
> 标签：javascript, jquery, html, rss

我在这里使用 RSS 提要阅读器：[http ://www.zazar.net/developers/jquery/zrssfeed/](http://www.zazar.net/developers/jquery/zrssfeed/)

我网站上包含 iframe 或其他内容的博客文章会被 Google Feeds API（或 jQuery 插件，但我猜是 Google）删除。我需要一种方法来防止这种情况发生，以便我可以在我的网站上获取博客的全部内容。

我使用 Blogger 博客作为我网站的主要内容更新工具，因此我的同事可以自行更新网站。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:18:50.117

Google Feeds API 正在删除这些标签。我建议您在服务器端使用[SimplePie](http://simplepie.org)（一个 PHP 类）来获取和处理提要。它可以配置为不去除任何 HTML 标记（参见[此处](http://simplepie.org/wiki/reference/simplepie/strip_htmltags#don_t_strip_any_tags_not_recommended)），并且可以完全自定义输出。

# silverlight - Silverlight GetTemplateChild 的控件内控件返回 null

> ID：11265266
> 
> 赞同：1
> 
> 时间：2012-06-29T16:08:08.047
> 
> 标签：silverlight, templates, datepicker

我正在尝试向 datepicker 控件添加一个指示器（我正在使用 TextBlock）。

视觉上它可以工作，但我无法通过 GetTemplateChild 获得控制。我认为这与我添加的 TextBlock 控件位于 DatePickerTextBox 样式模板中而不是 DatePicker 样式模板中的事实有关。

我已经尝试过 DefaultStyleKey（尽管我认为这没有意义，因为问题在于 DatePicker 中的 TextBox 控件）并在 TextBox 控件上使用了 OnApplyTemplate 和 UpdateLayout。

这是 Dictionary.xaml 的片段

```
<Style x:Key="Ind_DatePickerTextBoxStyle" TargetType="primitives:DatePickerTextBox">
   ...
   <Grid VerticalAlignment="Stretch">
      <TextBlock x:Name="Indicator" Text="*" Style="{StaticResource IndicatorStyle}" Visibility="Collapsed"/>

...

<!--datepicker style snippet-->

<primitives:BF_DatePickerTextBox 
   x:Name="TextBox" 
   SelectionBackground="{TemplateBinding SelectionBackground}" 
   Background="{TemplateBinding Background}" 
   BorderBrush="{TemplateBinding BorderBrush}" 
   BorderThickness="{TemplateBinding BorderThickness}" 
   Padding="{TemplateBinding Padding}" 
   Grid.Column="0" 
   Style="{StaticResource Ind_DatePickerTextBoxStyle}" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T15:17:03.170

[GetTemplateChild](http://msdn.microsoft.com/en-us/library/system.windows.controls.control.gettemplatechild%28v=VS.95%29.aspx)只能从“您的控件”中使用，以获取在其 [控件] 模板中定义的控件。定义控件并为其赋予样式后，您可以使用 GetTemplateChild

```
public class MyCustomControl : Control
{
    override OnApplyTemplate()
    {
        var textbox = GetTemplateChild("TextBox");
    }
}

<Style TargetType="local:MyCustomControl">
   <Setter Property="Template">
      <Setter.Value>
          <ControlTemplate TargetType="local:MyCustomControl">
              <TextBox x:Name="TextBox"/>
          </ControlTemplate>
      </Setter.Value>
  </Setter> 
```

因此，在此示例中，我能够使用 GetTemplateChild 来获取控件内的 TextBox 子项，因为我正在访问我的 [控件] 模板。我不能使用 GetTemplateChild 从另一个使用 MyCustomControl 的控件中获取 TextBox。只有 MyCustomControl 可以使用 GetTemplateChild 来获取 TextBox。

现在我可以扩展 MyCustomControl 来做同样的事情

```
public class MyOtherCustomControl : MyCustomControl
{
    override OnApplyTemplate()
    {
        var textbox = GetTemplateChild("TextBox");
    }
} 
```

我希望这有帮助！

# c++ - g ++不正确的循环？

> ID：11265272
> 
> 赞同：2
> 
> 时间：2012-06-29T16:08:19.517
> 
> 标签：c++, g++, disassembly

我有一个与此类似的真实世界程序，我将其称为`test.cpp`：

```
#include <stdlib.h>

extern void f(size_t i);

int sample(size_t x)
{
     size_t a = x;
     size_t i;  

     for (i = a-2; i>=0; i--) {
           f(i);   
     }
} 
```

我的问题是 i 是一个无限循环。

如果我运行以下命令：

```
g++ -S -o test.s test.cpp 
```

我得到以下组装顺序：

```
 .file   "test.cpp"
        .text
        .globl  _Z6samplem
        .type   _Z6samplem, @function
_Z6samplem:
.LFB0:
        .cfi_startproc
        pushq   %rbp
        .cfi_def_cfa_offset 16
        .cfi_offset 6, -16
        movq    %rsp, %rbp
        .cfi_def_cfa_register 6
        subq    $32, %rsp
        movq    %rdi, -24(%rbp)
        movq    -24(%rbp), %rax
        movq    %rax, -8(%rbp)
        movq    -8(%rbp), %rax
        subq    $2, %rax
        movq    %rax, -16(%rbp)
.L2:
        movq    -16(%rbp), %rax
        movq    %rax, %rdi
        call    _Z1fm
        subq    $1, -16(%rbp)
        jmp     .L2
        .cfi_endproc
.LFE0:
        .size   _Z6samplem, .-_Z6samplem
        .ident  "GCC: (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3"
        .section        .note.GNU-stack,"",@progbits 
```

我不是汇编语言专家，但我希望看到用于比较`i >= 0`的代码和有条件的跳出循环。这里发生了什么？？

Ubuntu Linux 上的 GNU C++ 4.6.3

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-29T16:10:03.220

`size_t`是无符号的，所以条件`i>=0`总是`true`。`i`消极是不可能的。

# c# - 根据 Kinect 传感器数据计算 BPM

> ID：11265276
> 
> 赞同：9
> 
> 时间：2012-06-29T16:08:32.490
> 
> 标签：c#, algorithm, math, datetime, kinect

我正在努力使用 Kinect for Windows SDK 来创建一个执行应用程序（使用 C#）。

基本上我需要跟踪指挥的一只手（通常是右手）并识别他的指挥速度（BPM），以通过 MIDI 将此值发送到另一个应用程序。

我开始的是`SkeletonFramesReadyEvent`将`JointType.HandRight`带有`DateTime.Now.Ticks`时间戳的添加到`List`更新并删除第一个条目的历史记录中。我保留了 60 帧（2 秒）的历史记录。

我通过搜索最后一个低点和高点来计算 BPM，`Joint.Position.Y`然后计算差异并除以`bpm = 60*ticksPerSecond/diff`。然而结果是错误的。还有另一种方法吗？我错过了什么？

这是我目前使用的：

```
public int DetectBPM(JointType type)
{
    // we have not history yet
    if (!HasHistory()) return 0;

    // only calculate every second
    var detectTime = DateTime.Now.Second;
    if (_lastBPM != 0 && _lastBPMDectect == detectTime) return _lastBPM;

    // search last high/low boundaries
    var index = (int) type;
    var list = History[index];
    var i = list.Count - 1;

    var lastHigh = list[i];
    var lastLow = list[i];

    // shift to last peak first
    while (i > 0 && list[i].Joint.Position.Y >= list[i - 1].Joint.Position.Y) i--;

    // find last low
    while (i >= 0 && lastLow.Joint.Position.Y >= list[i].Joint.Position.Y) lastLow = list[i--];

    // find last high
    while (i >= 0 && lastHigh.Joint.Position.Y <= list[i].Joint.Position.Y) lastHigh = list[i--];

    var ticks = lastLow.Timestamp - lastHigh.Timestamp;
    var elapsedTime = new TimeSpan(ticks);

    var bpm = (int) (60000/elapsedTime.TotalMilliseconds);

    Console.WriteLine("DEBUG: BPM = " + _lastBPM + ", elapsedMS: " + elapsedTime.TotalMilliseconds);

    _lastBPMDectect = detectTime;
    _lastBPM = bpm;

    return _lastBPM;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T16:08:29.427

我想出了怎么做。我错过了一点，计算了手的峰值和低位之间的 BPM，这是错误的。我必须计算最后两个低点之间的时间差才能得到正确的结果。

正确的方法是，找到最后一个峰的起始点。从那里移动到最后一个低点，这是计算差异的第一个点。移动到下一个峰值并再次下降到下一个低点，这是计算差异的第二个点。

原理如下图所示

![BPM 计算模式](../Images/971e5a4a65173a79735f9dd2d5bb6aa4.png)

这会产生一个很好的 BPM 计算结果，如下所示：

```
var ticks = Math.Abs(firstLow.Ticks - secondLow.Ticks);
var elapsedTime = new TimeSpan(ticks);

var bpm = (int) (60000/elapsedTime.TotalMilliseconds); 
```

无论如何，感谢您的参与。

# sftp - 使用 JSch 将所有文件从远程 FTP 服务器下载到本地机器

> ID：11265277
> 
> 赞同：1
> 
> 时间：2012-06-29T16:08:33.860
> 
> 标签：sftp, jsch

我有一个通过 SFTP 协议将 FTP 服务器中存在的所有文件下载到本地计算机的用例。我正在使用 JSch，它是`ChannelSftp`与远程 FTP 服务器通信的类。

我看到课堂上有`ls`和`get`方法`ChannelSftp`。因此，一种方法是首先使用 获取所有文件的列表，`ls`然后使用`get`.

还有其他更好的方法来完成这项任务吗？ChannelSftp 是否提供`mget *`某种功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T15:55:35.673

据我所知，ChannelSftp 没有提供`mget`方法。

您的解决方案似乎没问题。如果您真的想找到另一种方法，请查看以下示例`scp`：[ScpFrom.java](http://www.jcraft.com/jsch/examples/ScpFrom.java.html)

# python - 自动展开的动态列表

> ID：11265282
> 
> 赞同：6
> 
> 时间：2012-06-29T16:08:58.420
> 
> 标签：python, pop-11

如何从 Pop-11制作与**pdtolist等效的 Python？**

假设我有一个名为**g**的生成器，它一次返回（比如说）一个整数。我想构建一个列表**a**当我要求超出列表当前末尾的值时自动增长。例如：

```
print a # => [ 0, 1, 2, g]
print a[0] # => 0
print a[1] # => 1
print a[2] # => 2
# (obvious enough up to here)

print a[6] # => 6
print a # => [ 0, 1, 2, 3, 4, 5, 6, g]
# list has automatically expanded

a = a[4:] # discard some previous values
print a # => [ 4, 5, 6, g]
print a[0] # => 4 
```

术语 - 预测可能的误解：列表是“动态数组”，但这不是我的意思；我想要一个更抽象意义上的“动态列表”。

为了更好地解释动机，假设您有 999999999 项要处理。试图一次将所有这些都放入内存（在正常列表中）将是一个挑战。生成器通过一次呈现一个来解决这部分问题；每个都按需创建或从磁盘单独读取。但是假设在处理过程中您想引用一些最近的值，而不仅仅是当前值？您可以记住单独列表中的最后（例如）十个值。但是动态列表更好，因为它会自动记住它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:22:39.337

这可能会让你开始：

```
class DynamicList(list):
    def __init__(self, gen):
        self._gen = gen

    def __getitem__(self, index):
        while index >= len(self):
            self.append(next(self._gen))
        return super(DynamicList, self).__getitem__(index) 
```

您需要为切片添加一些特殊处理（目前，它们只返回一个普通列表，因此您失去了动态行为）。此外，如果您希望生成器本身成为列表项，则会增加一些复杂性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T16:29:10.613

刚刚回答了另一个类似的问题，并决定为您更新我的答案，这是怎么回事？

```
class dynamic_list(list):
    def __init__(self,num_gen):
        self._num_gen = num_gen
    def __getitem__(self,index):
        if isinstance(index, int):
            self.expandfor(index)
            return super(dynamic_list,self).__getitem__(index)

        elif isinstance(index, slice):
            if index.stop<index.start:
                return super(dynamic_list,self).__getitem__(index)
            else:
                self.expandfor(index.stop if abs(index.stop)>abs(index.start) else index.start)
            return super(dynamic_list,self).__getitem__(index)

    def __setitem__(self,index,value):
        if isinstance(index, int):
            self.expandfor(index)
            return super(dynamic_list,self).__setitem__(index,value)

        elif isinstance(index, slice):
            if index.stop<index.start:
                return super(dynamic_list,self).__setitem__(index,value)
            else:
                self.expandfor(index.stop if abs(index.stop)>abs(index.start) else index.start)
            return super(dynamic_list,self).__setitem__(index,value)

    def expandfor(self,index):
            rng = []
            if abs(index)>len(self)-1:
                if index<0:
                    rng = xrange(abs(index)-len(self))
                else:
                    rng = xrange(abs(index)-len(self)+1)
            for i in rng:
                self.append(self._num_gen.next()) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T16:11:09.597

非常感谢所有贡献想法的人！以下是我从所有回复中收集到的信息。这保留了普通列表类的大部分功能，在必要时添加了额外的行为以满足额外的要求。

```
class DynamicList(list):
    def __init__(self, gen):
        self.gen = gen

    def __getitem__(self, index):
        while index >= len(self):
            self.append(next(self.gen))
        return super(DynamicList, self).__getitem__(index)

    def __getslice__(self, start, stop):
        # treat request for "last" item as "most recently fetched"
        if stop == 2147483647: stop = len(self)
        while stop >  len(self):
            self.append(next(self.gen))
        return super(DynamicList, self).__getslice__(start, stop)

    def __iter__(self):
        return self

    def next(self):
        n = next(self.gen)
        self.append(n)
        return n

a = DynamicList(iter(xrange(10))) 
```

以前生成的值可以作为项目或切片单独访问。如果请求的项目超出列表的当前末尾，则记录的历史记录会根据需要扩展。可以使用 一次性访问整个记录的历史记录，也可以使用`print a`将其分配给普通列表`b = a[:]`。可以使用 删除一段记录的历史记录`del a[0:4]`。您可以使用 迭代整个列表`for`，随时删除，或在合适的时候删除。如果您到达生成值的末尾，`StopIteration`则会引发。

一些尴尬仍然存在。诸如`a = a[0:4]`成功截断历史记录之类的任务，但结果列表不再自动扩展。而是使用`del a[0:4]`保留自动增长属性。此外，我对必须识别一个`2147483647`代表最新项目的神奇值 并不完全满意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-09T18:25:12.680

感谢这个线程；它帮助我解决了自己的问题。我的有点简单：我想要一个列表，如果索引超过其当前长度，则自动扩展 - >允许读取和写入超过当前长度。如果读取超过当前长度，则返回 0 值。也许这可以帮助某人：

```
class DynamicList(list):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

    def __getitem__(self, idx):
        self.expand(idx)
        return super().__getitem__(idx)

    def __setitem__(self, idx, val):
        self.expand(idx)
        return super().__setitem__(idx, val)

    def expand(self, idx):
        if isinstance(idx, int):
            idx += 1
        elif isinstance(idx, slice):
            idx = max(idx.start, idx.stop)

        if idx > len(self):
            self.extend([0] * (idx - len(self))) 
```

# xcode4.3 - 我可以从 Xcode 构建回溯，但我不能从“Macintosh HD”开始回溯

> ID：11265283
> 
> 赞同：0
> 
> 时间：2012-06-29T16:09:03.477
> 
> 标签：xcode4.3, finder, application-loader

我需要通过 Application Loader 2.7 上传我的应用程序文件。但首先我需要获取应用程序的位置。我右键单击 Xcode 4.3.2 的 Products 文件夹中的应用程序文件并在 Finder 中显示。我一直使用 Finder Go > Enclosure Folder 进程返回 Macintosh HD。这是我写下的路径：

Macintosh HD/Users/Steve/Library/Developer/Xcode/DerivedData/[appname]-[string of letters]/Build/Products/Debug-iphonesos/

然而，当我开始从 Macintosh HD 向下钻取时，我一到 Users/Steve 就找不到 /Library。我仔细检查过，向上钻探时路径是正确的。

如何使 /Library 文件夹出现？我是个电脑人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:16:11.370

这是一个可能有帮助的链接：http: [//osxdaily.com/2011/07/04/show-library-directory-in-mac-os-x-lion/](http://osxdaily.com/2011/07/04/show-library-directory-in-mac-os-x-lion/)

# paypal-sandbox - Paypal - API Checkout (Rec. payment) - 沙盒测试账户 - 德国账户总是设置为“Premier”

> ID：11265288
> 
> 赞同：1
> 
> 时间：2012-06-29T16:09:14.380
> 
> 标签：paypal-sandbox

我正在与 Paypal 进行定期支付集成，此时主要功能运行良好。我有一个问题，虽然我无法解决，所以我想也许这里有人遇到了同样的问题，可能会给我一个提示。

为了测试对定期付款的订阅，我创建了一个卖家账户。卖家位于德国。

然后我创建了一些其他的测试账户来代表买家。我创建了一位代表德国客户的买家和一位代表美国 byuer 的买家。

当我被重定向到 Paypal 登录页面（结帐，购物车显示在左侧等）时，我可以使用美国帐户正确登录，同意付款并被重定向，一切都很好。

但是当我尝试使用德国测试帐户时，我总是在登录后直接出现一个页面，上面写着“此时无法处理付款。请返回卖家页面并选择其他付款方式”。

我将问题归结为一个令人惊讶的事实，那就是当我尝试使用沙盒的测试帐户部分中标记为“高级”的测试帐户登录时，我总是会收到此错误。所有（！）标记为“个人”的其他测试帐户都可以正常工作。

我正在使用 Paypal API 为快速结账设置 NVP 字符串。下面列出了结帐字符串，因为也许我在那里遗漏了一些东西：

```
$nvpstr = "";
$nvpstr .= "&METHOD=SetExpressCheckout";
$nvpstr .= "&VERSION=74.0";
$nvpstr .= "&LOCALECODE=".$this->localecode;
$nvpstr .= "&CURRENCYCODE=EUR";
$nvpstr .= "&RETURNURL=".$this->RETURN_URL_PLANUPGRADE;
$nvpstr .= "&CANCELURL=".$this->CANCEL_URL_PLANUPGRADE;
$nvpstr .= "&NOSHIPPING=1";
$nvpstr .= "&LANDINGPAGE=Billing";
$nvpstr .= "&BILLINGTYPE=RecurringPayments";
$nvpstr .= "&BILLINGAGREEMENTDESCRIPTION=" . urlencode('billing agreement description');

$nvpstr .= "&PAYMENTREQUEST_0_PAYMENTACTION=Sale";
$nvpstr .= "&PAYMENTREQUEST_0_DESC=" . urlencode('payment description');
$nvpstr .= "&PAYMENTREQUEST_0_CURRENCYCODE=EUR";
$nvpstr .= "&PAYMENTREQUEST_0_ITEMAMT=".$data['Payment']['item_amt'];
$nvpstr .= "&PAYMENTREQUEST_0_TAXAMT=".$data['Payment']['item_tax'];
$nvpstr .= "&PAYMENTREQUEST_0_AMT=".$data['Payment']['amt'];;

$nvpstr .= "&L_BILLINGTYPE0=RecurringPayments";
$nvpstr .= "&L_BILLINGAGREEMENTDESCRIPTION0=". urlencode('description');
$nvpstr .= "&L_PAYMENTTYPE0=Any";
$nvpstr .= "&L_PAYMENTREQUEST_0_ITEMCATEGORY0=Digital";
$nvpstr .= "&L_PAYMENTREQUEST_0_NAME0=". urlencode('item name');
$nvpstr .= "&L_PAYMENTREQUEST_0_DESC0=" . urlencode('item description');
$nvpstr .= "&L_PAYMENTREQUEST_0_AMT0=".$data['Payment']['item_amt'];
$nvpstr .= "&L_PAYMENTREQUEST_0_TAXAMT0=".$data['Payment']['item_tax'];
$nvpstr .= "&L_PAYMENTREQUEST_0_QTY0=1"; 
```

我希望有人遇到同样的问题，并能指出我正确的方向。也许选项“paymentaction”不适用于德国总理帐户，或者缺少其他任何东西......？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T09:55:04.090

我有同样的问题，这是来自 PayPal 支持的答案：

* * *

亲爱的xxx，

感谢您联系 PayPal 商家技术服务。

尽管我想给您一个肯定的答案，但不幸的是，德国买家目前不支持 Express Checkout Recurring Payment API。这些德国买家将始终收到您看到的错误，因为经常性支付 API 不支持德国资金来源，因此会引发此错误。非常抱歉，德国买家将无法使用此服务。解决此问题的唯一方法是使用预先批准的付款或参考交易 API 更改您的集成和处理德国的定期付款：

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECReferenceTxns](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECReferenceTxns)

[https://www.x.com/devzone/articles/recurring-payments-reference-transactions-and-preapproved-payments](https://www.x.com/devzone/articles/recurring-payments-reference-transactions-and-preapproved-payments)

* * *

# java - 线程状态java

> ID：11265289
> 
> 赞同：5
> 
> 时间：2012-06-29T16:09:14.957
> 
> 标签：java, multithreading

我想检查一下我的推理是否正确。

首先，我应该提供一些关于我要解决的问题的详细信息。线程（程序的一部分）执行以下操作：

1.  开始
2.  它调用 Thread.sleep (20ms)
3.  它调用 getIn() 方法
4.  它试图获得锁 (lock.lock())
5.  如果成功获得锁，它会调用 Thread.sleep (100ms)
6.  如果锁不可用，它会调用 waitingCond.await()
7.  调用 Thread.sleep (100ms) 后，它调用 lock.unlock()
8.  它调用另一个方法 getOut()
9.  它终止（thread.join（））

鉴于此，以下是我对线程状态的猜测：

1.  `READY TO RUN`状态
2.  `TIMED WAITING`状态
3.  `WAITING`状态
4.  `WAITING`状态
5.  `BLOCKED`状态
6.  `WAITING`状态
7.  `WAITING`状态
8.  `TERMINATED`状态

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-02T23:04:09.153

首先，您描述的状态`READY TO RUN`实际上是[RUNNABLE](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html#RUNNABLE)。对于我的学士论文，我创建了一个转换图，显示不同的线程状态以及它们应该何时改变。您还没有描述 的语义`getIn()`，所以我猜它只是一个随机方法。

如果线程正在执行代码，例如 on 您的方法`getIn()`，或者`getOut()`它 is`RUNNABLE`和 not `WAITING`。`BLOCKED`实际上只是一个很短的过渡状态，总是在线程试图申领锁时进入。如果锁不可用，则线程将继续被阻塞，并且无法执行您在步骤 6 中暗示的其他操作。此外，在调用`Thread.sleep()`它必须等待之后，它无法调用方法，直到时间过去。

我会通过以下方式纠正它：

1.  `RUNNABLE`
2.  `TIMED WAITING`
3.  `RUNNABLE`
4.  `BLOCKED`
5.  `TIMED WAITING`
6.  `BLOCKED`
7.  `RUNNABLE`
8.  `TERMINATED`

![线程状态转换](../Images/ec101bb952041a04b968a6c5df6c2d7e.png)

免责声明：不保证过渡。JVM 供应商甚至可能决定以另一种方式实现底层机制，例如它可以通过自旋等待来实现阻塞。

如果您想更深入地研究这个主题，请使用 Profiler 来找出线程的状态。我自己编写了一个来检测这些状态：[Java Concurrency Profiler](https://github.com/platzhirsch/java-concurrency-profiler)，但也有其他的，例如**VisualVM**或**YourKit**。

# r - 将表达式传递给 data.table 中的嵌套分组

> ID：11265291
> 
> 赞同：3
> 
> 时间：2012-06-29T16:09:16.643
> 
> 标签：r, data.table

我有一个`data.table`类似于这个的对象

```
library(data.table)

c <- data.table(CO = c(10000,10000,10000,20000,20000,20000,20000),
                SH = c(1427,1333,1333,1000,1000,300,350),
                PRC = c(6.5,6.125,6.2,0.75,0.5,3,3.5),
                DAT = c(0.5,-0.5,0,-0.1,NA_real_,0.2,0.5),
                MM = c("A","A","A","A","A","B","B")) 
```

我正在尝试使用嵌套分组执行计算，将表达式作为参数传递。这是我所拥有的简化版本：

```
setkey(c,MM)

mycalc <- quote({nobscc <- length(DAT[complete.cases(DAT)]); 
                 list(MKTCAP = tail(SH,n=1)*tail(PRC,n=1),
                      SQSUM = ifelse(nobscc>=2, sum(DAT^2,na.rm=TRUE), NA_real_),
                      COVCOMP = ifelse(nobscc >= 2, head(DAT,n=1), NA_real_),
                      NOBS = nobscc)}) 

myresults <- c[,.SD[,{setkey=CO; eval(mycalc)},by=CO],by=MM] 
```

产生

```
 MM    CO MKTCAP SQSUM COVCOMP NOBS
[1,]  A 10000 8264.6  0.50     0.5    3
[2,]  A 20000  500.0    NA      NA    1
[3,]  B 20000 1225.0  0.29     0.2    2 
```

在上面的示例中，我有两个使用该`ifelse`构造的列表元素（在实际代码中有 3 个），**都进行相同的测试**：如果观察数大于 2，则进行一定的计算（这对于列表的每个元素，每个元素都可以写成一个函数）将被执行，否则我希望这些元素的值为 NA。这些元素的另一个共同点是它们使用我的同一列`data.table`：称为`DAT`.

所以我的问题是：有什么方法可以`ifelse`只做一次测试，如果它是 FALSE，则将值传递`NA`给列表的各个元素，如果为 TRUE，则为列表的每个元素评估不同的表达式?

注意：我的目标是减少`system.time`（系统和经过）。如果这种修改不会减少时间和计算，**请记住我有 7200 万次观察**，这是一个可以接受的答案。我也欢迎更改代码其他部分的建议。

编辑： summaryRprof() 的结果

```
$by.total
                          total.time total.pct self.time self.pct
"system.time"                  18.94     99.79      0.00     0.00
".Call"                        18.92     99.68      0.10     0.53
"["                            18.92     99.68      0.04     0.21
"[.data.table"                 18.92     99.68      0.02     0.11
"eval"                         18.80     99.05      0.24     1.26
"ifelse"                       18.30     96.42      0.46     2.42
"lm"                           17.70     93.26      0.58     3.06
"sapply"                        8.06     42.47      0.36     1.90
"model.frame"                   7.74     40.78      0.16     0.84
"model.frame.default"           7.58     39.94      0.98     5.16
"lapply"                        6.62     34.88      0.70     3.69
"FUN"                           4.24     22.34      1.10     5.80
"model.matrix"                  4.04     21.29      0.02     0.11
"model.matrix.default"          4.02     21.18      0.26     1.37
"match"                         3.66     19.28      0.86     4.53
".getXlevels"                   3.12     16.44      0.12     0.63
"na.omit"                       2.40     12.64      0.24     1.26
"%in%"                          2.30     12.12      0.34     1.79
"simplify2array"                2.24     11.80      0.12     0.63
"na.omit.data.frame"            2.16     11.38      0.14     0.74
"[.data.frame"                  2.12     11.17      1.18     6.22
"deparse"                       1.80      9.48      0.66     3.48
"unique"                        1.80      9.48      0.54     2.85
"[["                            1.52      8.01      0.12     0.63
"[[.data.frame"                 1.40      7.38      0.54     2.85
".deparseOpts"                  1.34      7.06      0.96     5.06
"paste"                         1.32      6.95      0.16     0.84
"lm.fit"                        1.20      6.32      0.64     3.37
"mode"                          1.14      6.01      0.14     0.74
"unlist"                        1.12      5.90      0.56     2.95 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:50:42.523

而不是像这样形成和操作数据子集：

```
setkey(c,MM)
myresults <- c[, .SD[,{setkey=CO; eval(mycalc)},by=CO], by=MM] 
```

你可以尝试这样做：

```
setkeyv(c, c("MM", "CO"))
myresults <- c[, eval(mycalc), by=key(c)] 
```

这应该会加快您的代码速度，因为它避免了 .SD 对象的所有嵌套子集，每个对象都需要自己调用`[.data.table`.

* * *

在您最初的问题上，我怀疑`ifelse`评估需要花费很多时间，但如果您想避免它们，您可以将它们取出`mycalc`并使用以下内容`:=`覆盖所需的值`NA`：

```
mycalc <- quote(list(MKTCAP = tail(SH,n=1)*tail(PRC,n=1),
                      SQSUM = sum(DAT^2,na.rm=TRUE),
                      COVCOMP = head(DAT,n=1),
                      NOBS = length(DAT[complete.cases(DAT)]))) 
setkeyv(c, c("MM", "CO"))
myresults <- c[, eval(mycalc), by=key(c)]

myresults[NOBS<2, c("SQSUM", "COVCOMP"):=NA_real_]
## Or, alternatively
# myresults[NOBS<2, SQSUM:=NA_real_]
# myresults[NOBS<2, COVCOMP:=NA_real_] 
```

# asp.net - 两个asp元素之间的1px行间距？

> ID：11265292
> 
> 赞同：0
> 
> 时间：2012-06-29T16:09:19.343
> 
> 标签：asp.net, html, css

我希望能够控制两个 asp 元素之间的差距。

从中得到的差距太大了，我想把它缩小到一半。我尝试使用以下修改后的 br tah 无济于事。

请指教。

```
 <asp:Image ID="Image5" runat="server"  ImageUrl="/_Layouts/Bullet.png" />&nbsp;<asp:LinkButton ID="LinkButton4"  runat="server" CssClass="PreviousPollLinkButtonStyle"  Onclick="renderingCurrentPoll">Current Poll</asp:LinkButton>
 **<br style="line-height:2px;"/>**
 <asp:Image ID="Image2" runat="server" ImageUrl="/_Layouts/Bullet.png" />&nbsp<asp:LinkButton ID="LinkButton1" runat="server" CssClass="PreviousPollLinkButtonStyle" Onclick="renderingPreviousPollResults">Previous Poll Results</asp:LinkButton> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:18:36.047

您可以将 Image 和 LinkBut​​ton 放在 DIV 中并使用下边距：

```
<div style="bottom-margin:1px;padding:0;">
 <asp:Image ID="Image5" runat="server"  ImageUrl="/_Layouts/Bullet.png" />&nbsp;<asp:LinkButton ID="LinkButton4"  runat="server" CssClass="PreviousPollLinkButtonStyle"  Onclick="renderingCurrentPoll">Current Poll</asp:LinkButton> 
</div>

 <asp:Image ID="Image2" runat="server" ImageUrl="/_Layouts/Bullet.png" />&nbsp<asp:LinkButton ID="LinkButton1" runat="server" CssClass="PreviousPollLinkButtonStyle" Onclick="renderingPreviousPollResults">Previous Poll Results</asp:LinkButton> 
```

您可能必须更改 PreviousPollLinkBut​​tonStyle CSS 类。

# ios - 以下 iOS 代码出错，这不是确切的错误源

> ID：11265297
> 
> 赞同：1
> 
> 时间：2012-06-29T16:09:49.027
> 
> 标签：ios, uitableview

展开 UItableView 部分时出现以下错误，基本上，该部分会将单元格行添加到当前部分并折叠先前展开的部分的单元格行。

```
 [xtable beginUpdates];
[xtable insertRowsAtIndexPaths:indexPathsToInsert withRowAnimation:insertAnimation];

 [xtable deleteRowsAtIndexPaths:indexPathsToDelete withRowAnimation:deleteAnimation];
[xtable  endUpdates];

  2012-06-29 00:47:11.953 [9869:207] *** Assertion failure in
  -[UIViewAnimation initWithView:indexPath:endRect:endAlpha:startFraction:endFraction:curve:
    animateFromCurrentPosition:shouldDeleteAfterAnimation:editing:], /SourceCache/UIKit_Sim/UIKit-1912.3/UITableViewSupport.m:2522 
```

看起来错误来自动画？

动画部分是这样的

```
UITableViewRowAnimation insertAnimation;
UITableViewRowAnimation deleteAnimation;
if (previousOpenSectionIndex == NSNotFound || sectionOpened < previousOpenSectionIndex) {
    insertAnimation =UITableViewRowAnimationTop;
    deleteAnimation =UITableViewRowAnimationBottom;
}
else {
    insertAnimation =UITableViewRowAnimationBottom;
    deleteAnimation =UITableViewRowAnimationTop;
} 
```

我注释掉了动画代码，但它仍然给出了与动画相关的相同错误。

# php - 执行 ajax 调用后 $this->data 为空

> ID：11265298
> 
> 赞同：1
> 
> 时间：2012-06-29T16:09:54.660
> 
> 标签：php, ajax, cakephp

我正在使用来自另一个选择框的数据实现一个函数 populatig 一个选择框。

```
//views/users/ajax.ctp
$.ajax({
        url: url,
        type: "GET",
        dataType: "html",
        data:"arr=" + result,
        success: function(data){
            document.getElementById(child).innerHTML = data;
        }
    }); 
```

从上面的代码可以看出，调用传递的数据应该可以在`data`变量下的 getSectors() 函数中访问：

```
//controllers/users_controller.php
function getSectors() {
    $this->set('data', $this->data);
    $this->render('/users/ajax_data');
} 
```

在相应的视图中，我尝试查看传递的数据的内容：

```
//views/users/ajax_data.ctp
<?php var_dump($data); ?> 
```

$data 为空。

在 Firebug 中调试显示调用被正确调用（`status 200 ok`）并且 XMLHttpRequest 包含参数和值。

你有什么建议可能是错的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:14:55.930

为了让 Cake 填充`$this->data`变量，发送的数据需要遵循 format `data[Model][field]`，或者至少是`data[..]`数组的一部分。如果它是明确命名的`arr`，Cake 不会把它放在`$this->data`变量中。

# ios - UIImageView 背景颜色但不显示图像

> ID：11265302
> 
> 赞同：0
> 
> 时间：2012-06-29T16:10:00.793
> 
> 标签：ios, xcode, uiimageview, xib, nib

我有一个`UITableViewCell`nib 文件，其中有一个`UIImageView`和一个`UILabel`. 我有这两个到我的控制器的插座以及电池本身的插座。我正在以编程方式设置标签和图像，但图像未显示。

于是我去测试了一下，即使我在nib文件中设置了图片本身，也没有显示出来。如果我设置背景颜色，它显示得很好。有任何想法吗？我被困住了。

在我看来，它似乎与代码无关，因为它甚至不能通过 nib 文件工作。但无论如何它都在这里，以防它以某种方式有所帮助。

**MyViewController.h**

```
@interface MyViewController : UITableViewController

@property (strong, nonatomic) MyModel *myModel;
@property (strong, nonatomic) NSArray *tableViewCells;

@property (strong, nonatomic) IBOutlet UITableViewCell *tableViewCell;
@property (weak, nonatomic) IBOutlet UILabel *myLabel;
@property (weak, nonatomic) IBOutlet UIImageView *myImage;

@end 
```

**我的视图控制器.m**

```
@interface MyViewController ()

- (void)bindMyModel:(MyModel*)model toView:(UITableViewCell*)view;

- (UITableViewCell*)copyUITableViewCell:(UITableViewCell*)cell;

@end

@implementation MenuViewController

@synthesize myModel = _myModel;
@synthesize tableViewCells = _tableViewCells;

@synthesize tableViewCell = _tableViewCell;
@synthesize myLabel = _myLabel;
@synthesize myImage = _myImage;

- (void)viewDidLoad
{
    [super viewDidLoad];
    NSMutableArray *cells = [[NSMutableArray alloc] init];
    [MyModel loadAndOnSuccess:^(id data, id context) {
        self.myModel = data;
        for (MyModel *item in self.myModel.items) {
            [[NSBundle mainBundle] loadNibNamed:@"TableCellNib" owner:self options:nil];
            [self bindMyModel:item toView:self.tableViewCell];
            [cells addObject:[self copyUITableViewCell:self.tableViewCell]];
            self.tableViewCell = nil;
        }
        self.tableViewCells = [[NSArray alloc] initWithArray:cells];
    } onFail:^(NSString *error, id context) {
        NSLog(@"FAIL with error: %@", error);
    }];
}

- (void)viewDidUnload
{
    [self setTableViewCell:nil];
    [self setMyLabel:nil];
    [self setMyImage:nil];
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

- (void) bindMyModel:(MyModel*)model toView:(UITableViewCell*)view
{
    if (view) {
        self.myLabel.text = model.myLabelText;
        self.myImage.image = model.myImageResource;
        self.myLabel = nil;
        self.myImage = nil;
    }
}

- (UITableViewCell*)copyUITableViewCell:(UITableViewCell*)cell
{
    NSData *archivedData = [NSKeyedArchiver archivedDataWithRootObject: cell];
    return [NSKeyedUnarchiver unarchiveObjectWithData: archivedData];
}

#pragma mark - Table view data source

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return [self.tableViewCells objectAtIndex:indexPath.row];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return self.myModel.items.count;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Irrelevant code here
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return ((UITableViewCell*)[self.tableViewCells objectAtIndex:indexPath.row]).frame.size.height;
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:01:27.560

您正在尝试`IBOutlet`在您的 s 上使用两个 s`UITableViewController`来填充大量`UILabel`s 和`UIImageView`s 的一部分`UITableViewCell`。您需要创建一个自定义子类`UITableViewCell`并将`IBOutlet`s 添加到该子类。

```
@interface CustomCell : UITableViewCell

@property (weak, nonatomic) IBOutlet UILabel *myLabel;
@property (weak, nonatomic) IBOutlet UIImageView *myImage;

@end 
```

然后在你的`bindMyModel:toView:`

```
- (void) bindMyModel:(MyModel*)model toView:(CustomCell*)view
{
    if (view) {
        view.myLabel.text = model.myLabelText;
        view.myImage.image = model.myImageResource;
    }
} 
```

现在`IBOutlet`，您的每个 Cell 都有独立的 s。您还需要更改一些绑定。这是一个修复，但老实说，我会重写很多代码并仅`dequeueReusableCellWithIdentifier`在您的`cellForRowAtIndexPath`调用中使用，并保留一个您将重用的 s 池，并在调用中`CustomCell`设置`myLabel.text`and 。`myImage.image``cellForRowAtIndexPath`

# c++ - 获取子进程C++的执行结果

> ID：11265305
> 
> 赞同：2
> 
> 时间：2012-06-29T16:10:06.343
> 
> 标签：c++, linux, fork

我一直在尝试实现在线判断，但我被卡住了。我使用 fork 创建一个子进程，然后从子进程中我使用系统命令启动我应该测试的程序。

这是我用来测试分级机的程序。它处于无限循环中，但我只是评论该行以使其工作。

```
#include <stdio.h>
int main () {
    int a, b;
    scanf ("%d %d", &a, &b);
    while (1);
    printf ("%d\n", a + b);

    return 0;
} 
```

到目前为止我编码的分级机是

```
struct timeval start, end;
    struct rlimit rl, default_memory, default_time;
    getrlimit (RLIMIT_AS, &default_memory);
    getrlimit (RLIMIT_CPU, &default_time);

    pid_t pid = fork ();

    gettimeofday (&start, NULL);

    if (pid < 0) printf ("Error\n");
    else if (pid == 0) { // child process
        if (memory_limit > 0) {
            rl.rlim_cur = rl.rlim_max = memory_limit;
            setrlimit (RLIMIT_AS, &rl);
        }

        if (time_limit > 0) {
            rl.rlim_cur = rl.rlim_max = time_limit / 1000 + 1;
            setrlimit (RLIMIT_CPU, &rl);
        }

        ptrace (PTRACE_TRACEME, pid, NULL, NULL);
        system ("./sum < in.txt > out.txt");

        setrlimit (RLIMIT_CPU, &default_time);
        setrlimit (RLIMIT_AS, &default_memory);
    }
    else { // parent process
        int *status;

            // Is this ok?
            // Because here http://linux.die.net/man/2/ptrace it says that
            // PTRACE_GETSIGINFO is used to get information about the signal that
            // caused the stop. And I'm interested If the program was killed because of
            // rlimit (exceeding time or memory limit) or if it was something else.
        ptrace (PTRACE_GETSIGINFO, pid, NULL, NULL);
        if (wait (status) == -1) return 1; // waiting for the child process to finish

        if (WIFSIGNALED (status)) {
            int exit_signal = WTERMSIG (status);
            printf ("Terminated with signal: %d.\n", exit_signal);
            switch (exit_signal) {
                case 0:
                    printf ("OK\n");
                    break;
                case SIGSEGV: // RLIMIT_AS -- SIGSEGV is sent, when the memory limit is exceeded
                    printf ("Memory Limit Exceeded\n");
                    break;
                case SIGXCPU: // RLIMIT_CPU -- when soft limit is reached SIGXCPU is sent
                case SIGKILL: // when hard limit is reached SIGKILL is sent
                    printf ("Time Limit Exceeded\n");
                    break;
                default: // I didn't handle all the signals, so I made everything else a run time error
                    printf ("Run Time Error\n");
                    break;
            }
        }

        ptrace (PTRACE_KILL, pid, NULL, NULL); // Kill the process If it is not killed

        gettimeofday (&end, NULL); // This is working fine
        double time = (end.tv_sec - start.tv_sec) + 1e-6 * (end.tv_usec - start.tv_usec);
        printf ("%lf\n", time);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:27:46.423

您不需要使用 ptrace，您可以使用 向孩子发送信号`kill(2)`并通过 获取退出状态`wait(2)`，如果它因为使用 WTERMSIG 的信号而退出。

问题可能是您使用的是 system()，因此评分器实际上是在*第三个*进程中运行，而不是在子进程中。

注意我个人不会使用 system() 和这样的文件重定向，我会设置管道然后在孩子中使用 exec() ，所以评分器实际上在孩子中运行。或者我只是使用我的[pstreams](http://pstreams.sf.net)库。

# xml - 读取 SAML2 令牌时出现 XML 命名空间错误

> ID：11265312
> 
> 赞同：1
> 
> 时间：2012-06-29T16:10:17.110
> 
> 标签：xml, wif, saml-2.0

我有一个来自我的应用程序 IdP 的有效 SAML 2 令牌：

当我尝试使用如下 WIF 代码读取它时，出现以下错误：

> 无法从具有 BinarySecretSecurityToken 的“urn:oasis:names:tc:SAML:2.0:protocol”命名空间的“Response”元素中读取令牌，并带有“”ValueType。如果预计此元素有效，请确保将安全性配置为使用指定名称、命名空间和值类型的令牌。

这是我正在使用的代码，其中有一条注释显示它失败的地方

```
 string certPath = @"G:\Projects\myAPp\SAMLHandlingTests\bin\Debug\SSO.cer";
        X509Certificate2 cert = new X509Certificate2(certPath);
        //X509Certificate2 cert = new X509Certificate2(certPath, "LetMeIn!");

        // Open the SAML
        string samlPath = @"G:\Projects\myAPp\SAMLHandlingTests\bin\Debug\SAML.xml";

        string samlRaw = File.OpenText(samlPath).ReadToEnd();

        XmlReader rdr = XmlReader.Create(samlPath);

        List<System.IdentityModel.Tokens.SecurityToken> tokens = new List<System.IdentityModel.Tokens.SecurityToken>();

        var token = new X509SecurityToken(cert);
        tokens.Add(token);

        SecurityTokenResolver resolver = 
            SecurityTokenResolver.CreateDefaultSecurityTokenResolver(
            new System.Collections.ObjectModel.ReadOnlyCollection<SecurityToken>(tokens), true);

        //Fails on next line!
        SecurityToken securityToken = System.ServiceModel.Security.WSSecurityTokenSerializer.DefaultInstance.ReadToken(rdr, resolver);

        SamlSecurityToken deserializedSaml = securityToken as SamlSecurityToken; 
```

问题是 XML 命名空间异常，但我不知道如何“*确保将安全配置为使用指定名称、命名空间和值类型的令牌”*

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T08:41:54.353

好吧，我发现了问题，这是一个带有加密断言的 SAML 响应，它没有如下类型定义：

收到的 SAML 如下：

```
<saml:EncryptedAssertion> 
```

应该是什么时候

```
<saml:EncryptedAssertion xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"> 
```

当然可以在我的代码中解决这个问题，但根本问题是 System.Xml 和 WIF 不会让我在没有完全有效的 xml 的情况下通过。

我希望这对一路上的人有所帮助。

# c - 带有 CUDA 的 Nvidia GPU 上的良性数据竞争条件资格？

> ID：11265324
> 
> 赞同：3
> 
> 时间：2012-06-29T16:10:56.410
> 
> 标签：c, cuda, gpgpu, race-condition

作为我的问题的快速背景，对于 x86，可以保证对于 32 位字对齐的 4 字节或对于 64 位字对齐的 8 字节的单个内存访问将是原子的。因此，您可以创建“良性数据竞争”，其中至少一个线程写入内存地址，而另一个线程从同一地址读取，并且读者不会看到不完整写入的结果。读取线程将看到写入的整个效果，或者不会。

CUDA 编程模型中创建这些“良性”数据竞争条件的要求是什么？例如，如果两个独立的线程从两个不同的 SM 上的两个独立但同时运行的块将 64 位值写入相同的全局内存地址，则每个线程都会原子地写入它们的整个 64 位值，而第三个观察者只读回完全更新的 64 位内存块？或者写入会以更小的粒度进行，因此如果第三个观察者在两个线程同时写入后尝试从内存地址读回，则只会看到部分写入？

我知道竞争条件通常是要避免的，但是如果放宽内存排序的要求，则无需显式使用原子读/写函数。话虽如此，这取决于单个读/写的原子性是什么（即，多少位以及对齐方式）。有谁知道我在哪里可以找到这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:25:39.813

更新：@Heatsink 好心地通知我，确实可以通过使用该`__threadfence()`函数来强制实现一些内存一致性。

--

除非使用原子函数，否则 CUDA 在访问已由同一内核调用中调度的任何线程更新的全局内存时特别不保证任何一致性。只有读取由先前内核或内存副本写入的内存才是安全的。

因此，您不仅不能假设有关内存访问模式的任何事情——您甚至无法知道一个线程对全局内存所做的更新何时对另一个线程可见，或者实际上是否会变得可见。

当然，考虑到硬件在给定架构中的实现方式，您也许能够找到一种方法来实现线程之间的某种类型的非阻塞同步。但是，我真诚地怀疑是否有可能在区块之间安全地做到这一点。一个块中的线程所看到的将取决于该块运行哪个 SM，哪些块之前运行过，以及这些块完成的更新当前在缓存层次结构中的什么位置。

在考虑块中的线程时，讨论没有实际意义，因为块中的线程可以与共享内存通信，其行为由 CUDA 仔细指定。

# javascript - 使用 Prototype.js 更改浏览器光标

> ID：11265329
> 
> 赞同：2
> 
> 时间：2012-06-29T16:11:27.377
> 
> 标签：javascript, css, browser, prototypejs, mouse-cursor

加载页面时更改光标时遇到问题；我的代码是：

```
Event.observe(window, 'load', function() {
    document.body.style.cursor = 'wait';
     $$('select').each(function(s) {
        var ajaxRequest = new Ajax.Request(
            '/some_ajax_proc',
            { 
```

当页面加载时，光标不会改变。但是，它在其他事件侦听器中没有问题，例如：

```
 $('mytxt').observe('change', function() {
      document.body.style.cursor = 'wait';
   } 
```

更新：好的，它确实改变了光标，但是由于`document.body.style.cursor = 'default';`在 Ajax 循环之后有一个，它会立即将它改回来，所以我猜这是一个线程问题。在这种情况下有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T17:22:49.837

你试过这个吗？

```
Ajax.Responders.register({
   onCreate: function() {
                if (Ajax.activeRequestCount === 1) {
                   //Code for change the cursor, something like this:
                   document.body.style.cursor = 'wait';
                }
             },
   onComplete: function() {
                  if (Ajax.activeRequestCount === 0) {
                     // End loading...
                     ....
                  }
               }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T19:46:02.573

这个语法怎么样：

```
Event.observe(window, 'load', function() {
  $(document.body).setStyle({
    cursor: 'wait'
  });
}); 
```

这对我有用，但问题是，您是否有定义了光标的元素，或者有其他光标样式（可能是可拖动项目或可点击链接）覆盖？

我想看看`<body>`标签是否实际上具有使用 Firebug 或 Chrome 开发人员工具等实际应用的样式。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-10T07:57:08.907

因为，您已经在使用 jquery。

```
$('mytxt').observe('change', function() {
   $("body").css("cursor", "wait");
} 
```

# javascript - 使用backbone.marionette 和requireJs 的Web 应用程序的循环依赖项

> ID：11265332
> 
> 赞同：8
> 
> 时间：2012-06-29T16:11:41.117
> 
> 标签：javascript, backbone.js, requirejs, marionette, backbone-routing

我处于以下情况。

我正在使用 requireJs 加载模块，我不想使用全局变量。

main.js 负责加载路由器。
然后路由器加载应用程序，应用程序加载几个子应用程序。

一切都初始化后，子应用程序需要`router`制作`router.navigate`.

这里的架构：

```
main.js -> router -> app -> subApp -> router 
```

然后我遇到了循环依赖问题，因此 subApp 中的路由器将未定义。

重组我的代码或解决此问题的最佳方法是什么？有没有这方面的例子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T07:35:50.090

架构：

```
 main.js -> router -> app -> subApp -> router 
```

是正确的。

如果您使用的是[主干](https://github.com/derickbailey/backbone.marionette/blob/master/docs/marionette.application.md).marionette，为了从应用程序和子应用程序访问路由器，而不使用`global var`，您应该以这种方式在路由器中启动应用程序：

* * *

```
// router.js
YourApp.start(router: router); 
```

* * *

```
// app.js
YourApp.addInitializer(function(options){
  // do useful stuff here
  var myView = new MyView({
    router: options.router
  });
  YourApp.mainRegion.show(myView);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T20:59:29.003

在我的项目中，我使用以下依赖项：main.js -> app -> router -> subApp。

在 app.js 中，我创建了一个包含指向我的应用程序的指针的全局变量：

```
define([...], function(...) {
return {
  initialize: function() {
    window.MyApp = new Backbone.Marionette.Application();
    // ...
    MyApp.start();
  }
};
}); 
```

这使得从任何地方访问我的应用程序区域以及将全局状态信息存储在一个名称空间中变得非常容易。

起初我尝试在没有全局应用程序的情况下这样做，但最终放弃了，发现这种方法更加灵活。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T22:48:31.123

子应用可以引发路由器处理的事件，而不是显式依赖路由器

# c# - 如何将 .DBF 文件中的数据导入到 ElevateDB 等其他数据库？

> ID：11265333
> 
> 赞同：-1
> 
> 时间：2012-06-29T16:11:44.097
> 
> 标签：c#, sql, database, dbf, elevatedb

我有一个名为“客户”的大文件，它是 .DBF 格式。现在我想将该 .DBF 文件数据导入 ElevateDB 数据库。,,,有什么方法可以通过查询导入数据或编写从.DBF导入到ElevateDB的程序...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:25:45.753

如果您可以使用 Access，并且表结构相似，那么它应该很容易。

由于 ElevateDB 似乎有一个 ODBC 驱动程序，您应该能够通过[链接表](http://www.techonthenet.com/access/tables/link_table2007.php)功能访问 DB，并且 Access 还可以操作 DBF 文件。自从我不得不进行这种传输以来已经有很长时间了，但是一旦你有了 ODBC 驱动程序，它就很简单了。

# javascript - 一些 Javascript 变量不应该显示在窗口中

> ID：11265335
> 
> 赞同：1
> 
> 时间：2012-06-29T16:12:04.230
> 
> 标签：javascript, jquery

我有一个 Web 表单，我正在使用 JQuery 来提取用户输入的值并将它们显示在屏幕上，并添加了一个附加字符串。问题是只显示了两个值。当我查看调试器时，我可以看到变量已填充，但它们没有显示在屏幕上。

我的网络表格：

```
<form method="POST" id="sas_form" action="#">
  <select name="var_type" id="var_type">
    <option value="1">1</option>
  </select>
  <input type="text" name="name" id="name">
  <input type="text" name="value" value="0" id="value">
  <input type="text" name="something" id="something">
  <a href="#" id="add-row">Add Another row</a>

  <div id="renderArea"></div>
</form> 
```

我的Javascript：

```
$(document).ready(function() {
  var i = 0;
  $('#add-row').click(function() {
    var var_type = $('#var_type').val();
    var name = $('#name').val();
    var value = $('#value').val();
    var something = $('#something').val();

    $('#renderArea').append({'-Var VarType="'+var_type+'" Position="'+i+'"    
            Name="'+ name +'"><Imputed Value>' + value + '</Imputed Value>
            Something = ' + something});

    // increment the position
    i += 1;
  })
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:28:06.900

您需要将您的`.append()`声明更改为：

```
var html = '-Var VarType="' + var_type + '" Position="' + i + 
           '" Name="' + name + '"><Imputed Value>' + value + '</ImputedValue>' +
           'Something = ' + something;

$('#renderArea').append(html); 
```

注意 -`<Imputed Value></Imputed Value>`不是有效的 XML。标签名称中没有空格。由于您将其输出为 HTML - 这可能很重要。

您的问题可能与您将`.append()`参数放在 a中的事实有关`{}`- 这不是必需的。

# wolfram-mathematica - 数学中空列表的长度

> ID：11265349
> 
> 赞同：6
> 
> 时间：2012-06-29T16:12:55.113
> 
> 标签：wolfram-mathematica

我真的不知道为什么代码的输出：

```
State_Values = List[];
Print[Length[{}]]
Print[Length[State_Values]]; 
```

是 ：

```
0 
2 
```

无法提出任何理由。也许这很愚蠢，但我看不到。谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-29T16:54:19.083

不傻，但你犯了一个微妙的错误。中的下划线`State_Values`将其变为 a `Pattern`，而不是 a `List`。您可以使用该功能找到这一点`Head[]`。

```
stateValues = List[];
Length[stateValues]
Length[{}]

Out[11]= 0

Out[12]= 0 
```

如您所见，这是正确的和预期的。但是，引入下划线，一切都会中断：

```
state_Values = List[];
Length[state_Values]
Head[state_Values]
Head[stateValues]

Out[16]= 2

Out[17]= Pattern

Out[18]= List 
```

如果您使用的是 Mathematica 的 GUI 版本，则更容易查看它，因为它以`Pattern`不同的方式突出显示变量。

# api - 为什么 Play 2.0.2 中有 Form 的 fold 方法？

> ID：11265352
> 
> 赞同：6
> 
> 时间：2012-06-29T16:13:11.917
> 
> 标签：api, scala, playframework

我指的是这个：

[http://www.playframework.org/documentation/api/2.0.2/scala/index.html#play.api.data.Form](http://www.playframework.org/documentation/api/2.0.2/scala/index.html#play.api.data.Form)

如果您搜索名为 fold 的方法，它会显示用于处理表单的方法。这种方法被称为折叠有什么原因吗？鉴于 fold 已经对类似列表的对象具有含义，因此这个名称似乎很容易引起混淆。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T21:30:15.093

`fold`on`Form`非常接近 Scala 标准库中的on`fold`类`Either`，它同样经常用于捕获可能成功（在这种情况下您有一个`Right`包含结果）或失败（在这种情况下您有一个`Left`包含错误，或者可能是剩余输入等）。因此，我将`Either`在此处用作示例。如有必要，只需将图片`Form[T]`作为一种。`Either[Form[T], T]`

## 折叠收藏

我们可以（非常非正式地）将列表想象为具有许多不同的“形状”（空列表、长度为 1、长度为 2 的列表等），并且`fold`（或`foldLeft`，在以下示例中）作为折叠任何列表的方法一种事物的正确类型，无论它的形状是什么：

```
scala> def catInts(xs: List[Int]): String = xs.foldLeft("")(_ + _.toString)
catInts: (xs: List[Int])String

scala> catInts(List(1, 2, 3, 4))
res0: String = 1234

scala> catInts(Nil)
res1: String = "" 
```

## 折叠任何一个/表格

类似地，我们可以想象`Either`有两个形状（`Right`和`Left`），它`fold`是一个方法，可以采用`Either`任何一种形状并返回单一类型的东西。假设我们有以下方法将字符串解析为整数并返回`Either`：

```
def parseInt(s: String): Either[String, Int] =
  try Right(s.toInt) catch {
    case _: NumberFormatException => Left(s)
  } 
```

`fold`以及用于折叠的以下方法`Either`：

```
def toDefault(e: Either[String, Int]): Int = e.fold(_ => 42, identity) 
```

我们可以这样使用：

```
scala> toDefault(parseInt("AAARGH!!"))
res2: Int = 42

scala> toDefault(parseInt("123"))
res3: Int = 123 
```

这显然是非常印象派和手摇的，但它可能有助于更直观地了解不同`fold`方法在本质上是同一类事物。您可以查看[我在上面的评论中链接的问题](https://stackoverflow.com/q/8539935/334519)或[有关 catamorphisms 的 Wikipedia 条目以](http://en.wikipedia.org/wiki/Catamorphism)获取更多详细信息。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2014-07-19T10:14:09.957

这是对 {play for scala} 的解释：在 Scala 中，折叠通常用作将多个可能值折叠（或折叠）成单个值的方法的名称。在这种情况下，我们尝试将具有验证错误的表单或正确验证的表单折叠到响应中。

# perl - 简单的open3示例不起作用

> ID：11265357
> 
> 赞同：5
> 
> 时间：2012-06-29T16:13:21.217
> 
> 标签：perl, ipc, ipcopen3

我正在尝试制作一个主 perl 脚本调用子 perl 脚本并通过管道进行交互。

我已经为大师编写了这段代码：

```
#!/usr/bin/env perl

use strict;
use warnings;

use IPC::Open3;

my @children;

for my $i ( 0 .. 4 ) {
    print "Master: " . $i . ", I summon you\n";

    $children[$i] = {};

    $children[$i]->{'pid'} = open3( my $CH_IN, my $CH_OUT, my $CH_ERR, 'perl child.pl -i ' . $i );

    $children[$i]->{'_STDIN'}  = $CH_IN;
    $children[$i]->{'_STDOUT'} = $CH_OUT;
    $children[$i]->{'_STDERR'} = $CH_ERR;

    my $line = readline $children[$i]->{'_STDOUT'};
    print $line ;

}

print "Master: Go fetch me the sacred crown\n";

for my $i ( 0 .. 4 ) {
    $children[$i]->{'_STDIN'}->write("fetch the sacred crown\n");
    my $line = readline $children[$i]->{'_STDIN'};
    print $line ;
}

print "Master: Thanks. Now die!!!\n";

for my $i ( 0 .. 4 ) {
    $children[$i]->{'_STDIN'}->write("die !!\n");
    my $line = readline $children[$i]->{'_STDIN'};
    print $line ;
} 
```

这是给孩子的：

```
#!/usr/bin/env perl

use Getopt::Long ;

my $cmdline_id ;

GetOptions ('i=s' => \$cmdline_id) ;

my $id = $cmdline_id ;

exit 1 if !defined $id ;

print "I am $id, and I am awaken\n" ;

while(<STDIN>) {
    print STDOUT $id . ': Master ask me to ' . $_ ;

    if ($_ =~ /exit/oi) {
        exit 0 ;
    }
} 
```

但是当我启动Master时，他只是在阅读孩子的反应时挂了。

知道我做错了什么，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:23:20.540

你正在[遭受缓冲](http://perl.plover.com/FAQs/Buffering.html)。

在子进程开始附近说`$|=1`，以允许子进程打印而无需等待输出缓冲区填满。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T18:55:40.883

附带说明一下，将 undef 传递给第三个参数（就像您一样）并不能满足您的要求。您需要使用 Symbol 初始化变量`gensym`。

```
use Symbol qw( gensym );

my %child;
$child{pid} = open3(
    $child{'_STDIN' } = gensym,
    $child{'_STDOUT'} = gensym,
    $child{'_STDERR'} = gensym,
    'perl', 'child.pl', '-i' => $i
);

$children[$i] = \%child; 
```

# python - python插件IPDB安装

> ID：11265358
> 
> 赞同：2
> 
> 时间：2012-06-29T16:13:24.147
> 
> 标签：python

我尝试安装ipdb来调试python，但是我下载了ipdb0.61并解压后，只有几个.py文件。不知道怎么安装？我尝试运行 setup.py，但它不起作用。在“IPDB”文件夹中有两个 py 文件：**main** .py 和**init** .py。我应该如何安装它？我知道还有另一种方法可以通过easy_instal 来实现。但是我想修改它以支持 python3。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-31T10:33:15.857

easy_install 应该能够通过键入为您安装它

```
easy_install ipdb 
```

如果您没有 setup_tools 从[http://pypi.python.org/pypi/setuptools/获取它们](http://pypi.python.org/pypi/setuptools/)

# django - 如何删除 Django 页面中的查询信息

> ID：11265359
> 
> 赞同：0
> 
> 时间：2012-06-29T16:13:26.110
> 
> 标签：django

我想从网站上删除查询信息。我正在使用 django-html5-boilerplate。

查询不断出现在页面末尾，如下所示：

![在此处输入图像描述](../Images/495e7fa864985e6c1a05a8b167cdc561.png)

我怎样才能删除这个？这很烦人...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:11:05.763

没有官方或集中的 django-html5-boilerplate 包，但根据您的问题，我猜您使用[的是 mike360 在 github 上创建的包](https://github.com/mike360/django-html5-boilerplate)

如果是这种情况，在[base.html](https://github.com/mike360/django-html5-boilerplate/blob/master/projectname/templates/base.html)中，您会发现以下代码：

```
{% if debug %}{% include 'includes/debug.html' %}{% endif %} 
```

设置`DEBUG=False`将使它消失（您必须*在*生产中执行此操作，因此您仍然需要解决该静态文件问题），但如果您只是不想在开发过程中看到它，请将其从模板中删除。

# c++ - cv.h 代码错误？我链接错了吗？

> ID：11265361
> 
> 赞同：3
> 
> 时间：2012-06-29T16:13:31.010
> 
> 标签：c++, c, opencv, linker

我正在尝试编译[此代码](https://stackoverflow.com/questions/4785419/detection-of-coins-and-fit-ellipses-on-an-image/4788874#4788874)，以便为我的工作分析一些图像。如果对这段代码的工作原理有很好的解释，我将不胜感激，但现在我只是想让它编译。我安装了opencv（使用`sudo apt-get install libopencv-dev`），但由于某种原因该文件`cv.h`没有附带它。但是，此文件必须先前已安装在随机路径 ( `/usr/lib/perl/5.14.2/CORE/cv.h`) 下，因此我将其包含在内。`highgui.h`我还包括了与 opencv 一起正常安装的适当文件。这是我的错误：

```
/usr/lib/perl/5.14.2/CORE/cv.h:14:5: error: ‘_XPV_HEAD’ does not name a type
/usr/lib/perl/5.14.2/CORE/cv.h:15:5: error: ‘_XPVCV_COMMON’ does not name a type
/usr/lib/perl/5.14.2/CORE/cv.h:16:5: error: ‘I32’ does not name a type
/usr/lib/perl/5.14.2/CORE/cv.h:196:9: error: ‘OP’ does not name a type 
```

我有点明白这些错误的含义，并且已经在我之前编写的代码中得到了它们，但是为什么我要让它们用于似乎对其他人都有效的代码呢？我需要以不同的方式链接吗？正在使用 g++/gcc 编译器，是不是更新不正确？我在我的系统上安装了所有最近的更新...不知道还有什么可以尝试的。有什么想法吗？

# c# - 需要帮助了解当我们为数据绑定字段创建新的 BindingContext 时会发生什么

> ID：11265368
> 
> 赞同：4
> 
> 时间：2012-06-29T16:13:45.637
> 
> 标签：c#, data-binding

**背景：** 您有一个带有两个文本框的表单。每个文本框都绑定到类型化数据集中的同一字段。

使用视觉工作室设计器绑定每个文本框的 Text 属性。这就是 InitializeComponent() 方法中生成的代码的样子...

```
this.textBox1.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.testDataSet1, "TestTable.TestID", true)); 
```

到目前为止非常基本。现在，您添加一个按钮，其单击事件会向键入的数据集添加一行。执行此操作时，两个数据绑定文本框将显示第一行。这是简单的点击事件的样子。

```
private void button1_Click(object sender, EventArgs e)
    {
        this.testDataSet1.TestTable.AddTestTableRow(nTestID++, "Test" + nTestID.ToString());
    } 
```

好的，知道我们想在数据集行之间移动数据绑定字段。为此，我们只需创建一个 BindingManagerBase 对象并获取存在于 Forms BindingContext 属性中的 BindingManagerBase 对象。

```
private BindingManagerBase currentMgr = null; 
```

在表单构造函数中，您执行以下操作

```
this.currentMgr = this.bc[this.testDataSet1, "TestTable"]; 
```

然后在代码的其他地方我们可以使用 currentMgr 移动到下一条记录。

```
this.currentMgr.Position++; 
```

是的，这都是基本的！

**问题：**现在对于我不理解的部分，可以使用帮助...

假设您希望能够让其中一个文本框显示与 DataSet 不同的行。啊，这应该很容易。

创建一个新的 BindingContext，然后将第一个文本框的 BindingContext 属性分配给这个新的 BindingContext。然后获取这个新的 BindingContext 中存在的 BindingManagerBase 对象，并使用它来导航行。

问题是当您创建一个新的 BindingContext 并将其分配给文本框 BindingContext 属性，然后将数据加载到 DataSet 中时，文本框会显示文本*System.Data.DataRowView*。

这是代码的样子，非常简单..

```
 private BindingContext bc;
    private BindingManagerBase currentMgr = null;
    private BindingManagerBase currentMgr2 = null;

    public Form1()
    {
        InitializeComponent();

        this.bc = new BindingContext();
        this.textBox1.BindingContext = this.bc;

        this.currentMgr = this.BindingContext[this.testDataSet1, "TestTable"];
        this.currentMgr2 = this.bc[this.testDataSet1, "TestTable"];
    } 
```

当我调试此代码并查看*this.BindingContext[this.testDataSet1,"TestTable"]*（这是表单的绑定上下文）和*this.bc[this.testDataSet1,"TestTable"]*时，它们都返回一个 RelatedCurrencyManager 对象。

如果这两个绑定上下文都返回相似（显然不相同）的 RelatedCurrencyManager 对象，为什么绑定到新 BindingContext 的文本框显示文本*System.Data.DataRowView*而从不显示数据集中的数据？

我在调试器中多次查看了每个 RelatedCurrencyManager 对象，看看我是否可以判断一个属性是否与另一个 RelatedCurrencyManager 对象不同，但一切看起来都一样:-(。

我知道表单 BindingContext 的创建和初始化时间与我的新 BindingContext 不同，我认为这就是我的问题，但我无法确定这个问题。

任何见解将不胜感激！

谢谢，

# vbscript - VBScript 在 Windows 7 专业版中工作，而不是在 Windows 家庭高级版中

> ID：11265369
> 
> 赞同：1
> 
> 时间：2012-06-29T16:14:13.970
> 
> 标签：vbscript, zip, admin, uac

我的脚本所做的是，首先它检查 C:\Windows\System32\winevt\Logs 中的任何存档事件文件是否超过 7 天。如果是，则删除它们。

它所做的第二件事是任何剩余的 Archive*.evtx 文件（超过 7 天的文件），它将压缩并发送到您指定的任何路径。

现在我的问题在于我的桌面运行的是 Windows 7 专业版，并且昨晚我正在对其进行最后润色时脚本运行 100% 正确。现在我的笔记本电脑运行的是 Windows Home Premium，所以今天在工作时尝试从我的笔记本电脑运行脚本突然不起作用。

它将使 zip 文件位于正确的路径中，但实际上不会在 zip 文件中放入任何内容。

现在在家里，我必须以管理员身份运行脚本才能使其工作，这需要我进行注册表编辑，我在网上找到了甚至在您右键单击 .vbs 文件时添加“以管理员身份运行”按钮。（奇怪的是，这已经不存在了，但无论如何）

所以我在我的笔记本电脑上做了同样的编辑，尝试再次运行它，同样的事情发生了。在正确的路径中清空 zip 文件。

所以接下来我发现 UAC 搞砸了它。所以我关闭了笔记本电脑上的 UAC，然后以管理员身份运行，但它仍然遇到了同样的问题。在家里我的 UAC 仍然打开并且脚本可以工作，所以我完全不确定问题是什么。

然后我想也许在我的笔记本电脑上我遇到了 C: 驱动器的权限问题或类似的奇怪问题。所以我以管理员身份打开 cmd 并运行“takeown”以确保管理员允许访问驱动器。

然后再次运行脚本，仍然遇到同样的问题。

我现在不知道为什么它不会运行，当我下班回家时，我将再次在我的桌面上尝试它，看看它是否仍然有效。（它应该，我没有对脚本进行任何更改）

如果有人能在这里帮助我，那就太棒了。我希望在今天之前完成这一切并将其设置为计划任务，以便它开始运行，但它似乎想给我带来更多问题。

该脚本在下面找到：

* * *

```
Option Explicit

Dim oFSO, oFolder, sDirectoryPath, sDestinationPath, sOutputFilename, Shell, sFileExt,     sFilePrefix
Dim oFileCollection, oFile, sDir 
Dim iDaysOld 

Set Shell = WScript.CreateObject("WScript.Shell")
'Specify Directory Path From Where You want to clear the old files 'Also where you want destination for zip
sDirectoryPath = "C:\Windows\System32\winevt\Logs\"
sDestinationPath = "C:\Script\files\outzips\"
sOutputFilename = shell.ExpandEnvironmentStrings("%COMPUTERNAME%")
sFileExt = ".evtx"
sFilePrefix = "Archive*"
' Specify Number of Days Old File to Delete
iDaysOld = 7

Set oFSO = CreateObject("Scripting.FileSystemObject") 
Set oFolder = oFSO.GetFolder(sDirectoryPath) 
Set oFileCollection = oFolder.Files 

For each oFile in oFileCollection
'Specify the Extension of file that you want to delete 'and the number with Number of character in the file extension
If LCase(oFSO.GetExtensionName(oFile.Name)) = ".evtx" Then

    If oFile.DateLastModified < (Date() - iDaysOld) Then 
    oFile.Delete(True) 
    End If 

End If   
Next 

Set oFSO = Nothing 
Set oFolder = Nothing 
Set oFileCollection = Nothing 
Set oFile = Nothing 

Dim Command, RetVal
Dim d : d = Date() 
Dim dateStr : dateStr = Year(d) & "-" & Right("00" & Month(d), 2) & "-" & Right("00" &     Day(d), 2)
Dim t : t = Time()
Dim timeStr: timeStr = Hour(t) & "-" & Right("00" & Minute(t), 2) & "-" & Right("00" & Second(t), 2)

Command = """C:\Program Files\7-zip\7z.exe"" a  " & sDestinationPath & sOutputFilename & "-" & dateStr & "-" & timeStr & ".zip " & sDirectoryPath & sFilePrefix & sFileExt

        RetVal = Shell.Run(Command,0,true) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:15:42.490

Ahum .. 你的文件夹 C:\Windows\System32\winevt\Logs 中可能没有像 Archive*.evtx 这样的文件吗？通常没有，我想在你的桌面上出于任何原因有所以脚本在那里工作。尝试在 command = "...." 之后放置一个 wscript.echo 并尝试在控制台上运行它。在那里更容易找出命令不运行的原因，如果它运行的机会很高，它也会在你的脚本中运行。

# python - 为什么 Tkinter 堆栈在 Windows 上溢出？

> ID：11265371
> 
> 赞同：1
> 
> 时间：2012-06-29T16:14:39.683
> 
> 标签：python, tkinter, stack-overflow

这个简短的 Python 脚本[debugwin.py](https://gist.github.com/3013616)在我的 Linux 机器上运行良好：

```
>>> import debugwin
>>> l = []
>>> debuwin.watch(l)
0
>>> l.append(1) 
```

但是，[人们告诉我](http://www.reddit.com/r/Python/comments/vrcnn/debugwin_live_watch_windows_for_python/)，在 Windows（Python 2.7.3 Windows 7）上，它有时在追加后不会更新，有时会出现堆栈溢出：

```
>>> error in background error handler:
    out of stack space (infinite loop?) while executing "::tcl::Bgerror {out of stack
    space (infinite loop?)} {-code 1 -level 0 -errorcode NONE -errorinfo {out of stack
    space (infinite loop?)Unable to format..." 
```

脚本怎么会溢出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T17:41:47.083

如果为报告错误而编写的代码有错误，它可能会溢出。当它尝试报告错误时，它会调用错误报告代码，但它有错误，因此它会尝试调用错误报告代码，......我不是说这是问题，但这至少是获得什么的一种方法你看到了。

我对您链接到的 debugwin.py 代码崩溃并不感到特别惊讶（至少，在我编写此代码时该代码的版本）。Tkinter 不是线程安全的，传统观点认为它只能在应用程序的主线程中运行。看起来代码在子线程中创建了一个 tk 解释器。因此，即使错误报告代码中没有错误，tcl 解释器在子线程中运行的事实也让我认为它可能与线程相关。当然，崩溃似乎是随机的这一事实让我相信它与线程有关。

我看到另一件事看起来有些可疑。所有小部件都有一个`update`调用标准 tk`update`命令的方法。您有一个从 Label 继承的小部件，并且您创建了自己的`update`方法。这可能不会导致任何问题，但这是一种代码味道。

# wcf - 在每个 WCF 请求中传递用户名和密码

> ID：11265372
> 
> 赞同：1
> 
> 时间：2012-06-29T16:14:46.287
> 
> 标签：wcf, wcf-security

我有一个表，其中包含允许访问 WCF 服务的所有用户名及其哈希密码。

使用消息级安全性并将每个请求的用户名和密码作为加密正文的一部分传递是否存在问题？

为什么几乎没有人建议将此作为身份验证选项？

编辑以澄清：

将此与将传输安全性与证书进行对比，您必须在每个请求中将用户名和密码作为 ClientCredentials 的一部分发送。

如果消息级安全提供机密性、完整性和身份验证，那么为什么使用证书是更好的选择？将凭据作为加密正文的一部分传递而不是与 ClientCredentials 一起传递有什么缺点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:28:01.530

每次请求都传递密码进行攻击，有人设法读取传输的内容。如果他们得到密码，他们可以随时登录。如果他们愿意，他们甚至可以更改密码。使用会话 ID，他们只能劫持会话，只要它处于活动状态（并且无法访问更好的受保护区域，例如更改密码区域，您必须通过再次提供密码来重新确认）。为了防止密码被盗，您必须更改密码（并记住新密码）。要抵消被劫持的会话 ID，您只需结束会话。无论如何，您永远不会记得会话 ID。此外，如果您一次又一次地发送密码，则需要始终将密码存储在客户端应用程序中的某个位置。那'

被劫持的密码实际上更糟糕，因为通常相同的密码用于多个不同的应用程序。

除此之外，您通常会使用一种额外的慢速算法来散列密码（这使得*猜测*密码变得更加困难，因为您必须等待。您可能想要添加一些类似有限尝试的东西每个时间单位的密码，以排除字典攻击。这与您的想法并不一致。

我想说总的来说这是一个坏主意，一直发送密码，独立或使用的框架，它更多的是客户端/服务器应用程序的原则。既然有像带有 ID 的会话这样的技术，为什么不使用它们。这并不比一直验证密码更复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T18:04:03.857

@kratenko 是对的，在每条消息中发送密码并不是一个好方法，尽管我同意你的观点，但从加密消息中获取密码并不是一件容易的事。您可以做的是对 WCF 通信使用双重安全性，即消息安全性和传输安全性 (SSL)。这是一个解释如何实现它的链接：http: [//www.dotnetfunda.com/articles/article891-6-steps-to-implement-dual-security-on-wcf-using-user-name-ssl。 .aspx](http://www.dotnetfunda.com/articles/article891-6-steps-to-implement-dual-security-on-wcf-using-user-name-ssl.aspx) _

您还有其他选择，例如：仅在安全通道 (SSL) 上发送您的用户凭据一次，并根据用户身份验证的成功生成一个您发送回客户端的令牌。在这种情况下，对于任何进一步的请求，客户端必须在自定义标头中提供该令牌。在服务级别，您可以将生成的令牌保存在高性能缓存存储系统（例如 Couchbase）上，因此对于每个传入请求，您都将客户端提供的令牌与缓存中的令牌进行比较。通过这种方式，您可以一直保持服务无状态。如果您不喜欢这个想法，那么您可以选择使用 STS（安全令牌服务）。

# objective-c - 在 Cocoa 中，Class 类型是如何定义的？

> ID：11265375
> 
> 赞同：2
> 
> 时间：2012-06-29T16:15:06.867
> 
> 标签：objective-c, macos, cocoa

来自“objc.h”：

```
typedef struct objc_class *Class; 
```

但在“runtime.h”中：

```
struct objc_class {
    Class isa;

#if !__OBJC2__
    Class super_class                                        OBJC2_UNAVAILABLE;
    const char *name                                         OBJC2_UNAVAILABLE;
    long version                                             OBJC2_UNAVAILABLE;
    long info                                                OBJC2_UNAVAILABLE;
    long instance_size                                       OBJC2_UNAVAILABLE;
    struct objc_ivar_list *ivars                             OBJC2_UNAVAILABLE;
    struct objc_method_list **methodLists                    OBJC2_UNAVAILABLE;
    struct objc_cache *cache                                 OBJC2_UNAVAILABLE;
    struct objc_protocol_list *protocols                     OBJC2_UNAVAILABLE;
#endif

} OBJC2_UNAVAILABLE;
/* Use `Class` instead of `struct objc_class *` */ 
```

究竟是`Class`什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T19:39:58.927

```
typedef struct objc_class *Class; 
```

^ 这是`objc_class`指针的前向声明。它给了它一个好听的名字`Class`。

现在让我们看一下`objc_class`结构：（删除 Objective-C 2.0 检查以缩短它）

```
struct objc_class {
    Class isa;
};
//This is really saying
struct objc_class {
    struct objc_class *isa;
}; 
```

所以现在我们有了一个指向它自己类型的结构。但你为什么要问？

*摘自[Objective-C 运行时内部，第 2 部分](http://macdevcenter.com/pub/a/mac/2002/05/31/runtime_parttwo.html?page=2)*

> Class' isa (the Class' Class) 指向的Class 在其objc_method_list 中包含Class' 类方法。了解？运行时使用的术语是，当对象的 isa 指向它的类时，类的 isa 指向对象的“元类”。
> 
> 那么元类的 isa 指针呢？嗯，它指向层次结构的根类（大多数情况下为 NSObject）。（在 Foundation 框架中，NSObject 子类的每个元类“isa”都是 NSObject 的实例。）是的，顺便说一下，NSObject 的元类的 isa 指向同一个结构——它是一个循环引用，所以没有类的 isa永远为 NULL。

* * *

因此，根据该描述，当您创建一个继承自`NSObject`您的类时`isa`，它指向其类类型，该类类型指向其元类，该元类指向其根类（`NSObject`），其中包含对自身的循环引用。这就解释了为什么它[需要两个步骤来确定一个对象是一个实例还是一个类](https://stackoverflow.com/questions/6536244/check-if-object-is-class-type/6537756#6537756)。

假设您创建了以下类：

```
@interface MyClass : NSObject
@end
@implementation MyClass
@end 
```

如果您能够* 遍历 isa 指针，您将获得以下信息：
*[由于受保护，您不能`isa`。请参阅下面的 Cocoa with Love 帖子以创建您自己的实现。]

```
Class c = myClassInstance->isa; //This would be the MyClass
c = c->isa; //This would be MyClass' meta class
c = c->isa; //This would be NSObjects meta class
c = c->isa; //This going forward would still be the NSObjects meta class
... 
```

一旦`c == c->isa`你知道你在根对象。请记住，Objective-C 是 C 的适当超集，它本身不具有面向对象的构造，例如继承。这与其他实现细节一起，例如指向构成完整类层次结构的超类的指针，允许 Objective-C 提供面向对象的特性。有关类和元类的更多信息，请参阅 Cocoa with Love 上的帖子：[Objective-C 中的元类是什么？](http://cocoawithlove.com/2010/01/what-is-meta-class-in-objective-c.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-18T03:59:47.850

关于循环引用：

如果 isa 被定义为不是如下的指针，则它成为循环引用。

```
struct objc_class {
    struct objc_class isa;
}; 
```

因为编译器无法计算 objc_class 的大小。

但是，在以下情况下（真实定义），

```
struct objc_class {
    struct objc_class *isa;
}; 
```

isa 只是一个指针，所以没有问题。

# c# - 从 Asp.Net/C# 发送邮件时出错

> ID：11265376
> 
> 赞同：1
> 
> 时间：2012-06-29T16:15:07.667
> 
> 标签：c#, asp.net, email

我已经建立了一个反馈页面。我正在尝试从该页面发送邮件。客户端为我提供了`SMTP Server`名称`Email ID`和`Password`.但是当我尝试从该页面发送邮件时，我收到以下错误。

> 连接尝试失败，因为连接方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应 64.37.118.141:25

这是我的代码

```
MailMessage feedBack = new MailMessage();

//feedBack.To.Add("master@myclient.com");
feedBack.From = new MailAddress("master@myclient.com");
feedBack.Subject = "Mail from Explor Corporate Website.";  
feedBack.Body = "Sender Name: " + Name.Text + "<br/><br/>Sender Last Name:"+LastName.Text+"<br/><br/>Sender Company:"+Company.Text+"<br/><br/>Sender Designation"+Designation.Text+"<br/><br/>Sender Email:"+Email.Text+"Sender Phone No:"+ PhoneNo.Text+"Sender Enquiry:"+Enquiry.Text;
feedBack.IsBodyHtml = true;

SmtpClient smtp = new SmtpClient();
smtp.Host = "smtp.myclient.com"; //Or Your SMTP Server Address
//smtp.Port = 587;
smtp.EnableSsl = true;
smtp.Credentials = new System.Net.NetworkCredential("master@myclient.com", "*****");
//Or your Smtp Email ID and Password

smtp.Send(feedBack); 
```

谁能帮我解决这个问题？

欢迎任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:19:51.983

这很可能表明您没有正确的主机名或正确的端口。

如果您使用 SSL，则默认 SMTP 端口 25 将不起作用。我注意到您确实有一行设置了注释掉的端口。

尝试将端口设置为 587，如果不起作用，请尝试使用有时用于安全 SMTP 的端口 465。

如果这不起作用，请与您的客户端确认正确的端口和主机名..

您可能需要仔细检查的另一件事是您使用的 SMTP 服务器是否确实支持/需要 SSL。如果它不支持 SSL，您需要将`EnableSSL`选项设置为 false 并尝试在默认端口 25（或他们使用的任何端口）上连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:22:01.803

听起来可能是超时错误或身份验证问题。从代码访问外部资源时，您需要处理可能的错误：

```
try
{
 smtp.Send(feedBack); 
}
catch(Exception e)
{
    // Handle the exception here
} 
```

# html - 将css中的活动状态添加到导航栏

> ID：11265377
> 
> 赞同：0
> 
> 时间：2012-06-29T16:15:11.157
> 
> 标签：html, css

[http://jsfiddle.net/DaJWC/](http://jsfiddle.net/DaJWC/) 我不知道如何使其中一个链接反向，使其一开始是蓝色的。另外，我将如何在您正在查看的当前页面下创建一条线。

```
ul#list-nav {
  list-style: none;
  margin-left: 45px;
  padding: 0;
  width: 525px;
}
ul#list-nav li {
  display: inline
}
ul#list-nav li a {
  text-decoration: none;
  text-transform: capitalize;
  padding: 5px 0;
  width: 100px;
  background: ;
  color: #333;
  float: left;
  text-align: center;
}
ul#list-nav li a:hover {
  background: ;
  color: #09F
}
```

```
<ul id="list-nav">
  <li><a href="index.html" class="active">Home</a>
  </li>
  <li><a href="#" class="border_left">About Us</a>
  </li>
  <li><a href="#" class="border_left">Portfolio</a>
  </li>
  <li><a href="#" class="border_left">Get a Quote</a>
  </li>
  <li><a href="#" class="border_left">Contact</a>
  </li>

</ul>
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:22:41.133

您需要从设置颜色的位置删除“:hover”。我会创建一个新的选择器，例如： ul#list-nav li a {...} 然后您可以为非悬停和悬停选择颜色。[看看这个](http://jsfiddle.net/DaJWC/4/)。

# .net - WiX：注册 .NET COM 组件都 x86 x64

> ID：11265380
> 
> 赞同：5
> 
> 时间：2012-06-29T16:15:18.410
> 
> 标签：.net, com, wix, 64-bit

我有 C# COM .dll。我想安装 .dll 一次，但要为 x86 和 x64 注册它。

这是我仅用于注册 x64 的 WiX：

```
<Component Id="NETDLL.dll" Directory="INSTALLDIR">
  <File Id="NETDLL.dll" Name="NETDLL.dll" KeyPath="yes" Source="..\NETDLL.dll" />
  <Class Id="{78BE...}" Context="InprocServer32" Description="NETDLL" ThreadingModel="both" ForeignServer="mscoree.dll">
    <ProgId Id="NETDLL" Description="NETDLL" />
  </Class>
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Value="" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\InprocServer32\1.0.1.0" Name="Class" Value="NETDLL" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\InprocServer32\1.0.1.0" Name="Assembly" Value="NETDLL, Version=1.0.1.0, Culture=neutral" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\InprocServer32\1.0.1.0" Name="RuntimeVersion" Value="v4.0.30319" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\InprocServer32\1.0.1.0" Name="CodeBase" Value="file:///[#NETDLL.dll]" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\InprocServer32" Name="Class" Value="NETDLL" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\InprocServer32" Name="Assembly" Value="NETDLL, Version=1.0.1.0, Culture=neutral" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\InprocServer32" Name="RuntimeVersion" Value="v4.0.30319" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\InprocServer32" Name="CodeBase" Value="file:///[#NETDLL.dll]" Type="string" Action="write" />
  <RegistryValue Root="HKCR" Key="Component Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Name="0" Value=".NET Category" Type="string" Action="write" />
  <RegistryKey Root='HKLM' Key='Software\NETDLL'>
    <RegistryValue Name='Description' Type='string' Value='NETDLL'/>
  </RegistryKey>
</Component> 
```

如何一次写入 HKCR\CLSID、HKCR\Wow6432Node\CLSID、HKLM\Software 和 HKLM\Software\Wow6432Node？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-14T09:33:29.980

通过玩弄两个组件，一个用于 64 位，一个用于 x86 注册，我成功地在 64 位系统上为 x86 和 64 位注册了相同的 dll：

```
<Component Id="NETDLL.dll" Directory="INSTALLDIR" Guid="*">
   <Class Id="{78BE...}" Context="InprocServer32" Description="NETDLL"  
        ThreadingModel="both" ForeignServer="mscoree.dll">
      <ProgId Id="NETDLL" Description="NETDLL" />
   </Class>
   <File Id="NETDLL.dll" Name="NETDLL.dll" KeyPath="yes" 
          Source="..\NETDLL.dll" />
   <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\Implemented Categories {62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Value="" Type="string" Action="write" />
   ...
</Component>
<Component Id="NETDLLWin64.dll" Guid="{885F75B1-3046-42BD-8B37-F8FA0E8D7A51}" Win64="yes" Directory="INSTALLDIR">
   <Class Id="{78BE...}" Context="InprocServer32" Description="NETDLL" ThreadingModel="both" ForeignServer="mscoree.dll">
      <ProgId Id="NETDLL" Description="NETDLL" />
   </Class>
   <RegistryValue Root="HKCR" Key="CLSID\{78BE...}\Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Value="" Type="string" Action="write" />  
   ...
</Component> 
```

我在组件节点中添加了**Guid** -Attributes，更改了第二个组件的 Id 并添加了**Win64="yes"**属性。我也不复制文件。希望这会有所帮助，如果您有很多依赖项并且不会复制文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:47:41.383

安装该文件的两份副本，在`ProgramFiles64Folder`和下各一份`ProgramFilesFolder`。浪费 .5MiB，但很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T17:37:22.657

尝试`regasm.exe`开关 /x86 和 /x64。

您还有 32 位和 64 位版本`regasm.exe`，一个输入一个输入`C:\windows\microsoft .net\<version>\Framework`另一个输入`Framework64`，看看是否有帮助。

# linux - 如何在特定字符之后删除字符串中的所有内容？

> ID：11265381
> 
> 赞同：16
> 
> 时间：2012-06-29T16:15:20.107
> 
> 标签：linux, bash

例子：

```
 before: text_before_specific_character(specific_character)text_to_be_deleted
    after: text_before_specific_character 
```

我知道它可以用'sed'来完成。但我被困住了。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-29T16:23:16.690

没有理由为此使用 sed 之类的外部工具。bash 可以在内部[使用参数扩展](http://mywiki.wooledge.org/BashFAQ/073)：

如果要修剪的字符是`:`，例如：

```
$ str=foo_bar:baz
$ echo "${str%%:*}"
foo_bar 
```

你可以用贪婪和非贪婪的方式来做到这一点：

```
$ str=foo_bar:baz:qux
$ echo "${str%:*}"
foo_bar:baz
$ echo "${str%%:*}"
foo_bar 
```

特别是如果你在一个紧密的循环中调用它，启动一个新的 sed 进程，写入该进程，读取它的输出，并等待它退出（以获取它的 PID）可能是在内部进行所有处理的巨大开销bash 不会有。

* * *

现在 - 通常，当想要这样做时，您可能*真正*想要的是将变量拆分为字段，最好使用`read`.

例如，假设您正在阅读以下内容`/etc/passwd`：

```
line=root:x:0:0:root:/root:/bin/bash
IFS=: read -r name password_hashed uid gid fullname homedir shell _ <<<"$line"
echo "$name" # will emit "root"
echo "$shell" # will emit "/bin/bash" 
```

* * *

即使您想处理文件中的多行，也可以单独使用 bash 完成，无需外部进程：

```
while read -r; do
  echo "${REPLY%%:*}"
done <file 
```

`:`...将从 的每一行发出直到第一行的所有内容`file`，而无需启动任何外部工具。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-29T16:21:06.717

你要找的其实很简单：

```
sed 's/A.*//' 
```

Where`A`标记了特定的字符。请注意，它区分大小写，如果要捕获多个字符，请使用

```
sed 's/[aAbB].*//' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T16:32:33.863

如果 TEXT 包含您的文本，如

```
TEXT=beforexafter 
```

并且特定字符恰好（例如）是`x`，然后

```
echo "${TEXT%x*}" 
```

做你想做的事。

To Bash, `"$TEXT"`or `"${TEXT}"`is the whole `beforexafter`, but `"${TEXT%xafter}"`is just `before`, with the `xafter`cut off end 。为了砍掉它`x`和任何可能跟随它的东西，一个人写道`"${TEXT%x*}"`。

还有`"${TEXT%%x*}"`，顺便说一句。仅当存在多个 时，它才与另一个不同`x`。使用`%%`, Bash 砍掉所有`x`，而使用`%`it 仅从最后一个砍掉`x`。您可以通过松散地观察更长的`%%`文本来记住这一点。

当然，如果您愿意，您也可以对 Sed 进行同样的操作：

```
echo "$TEXT" | sed 's/x.*//' 
```

# foreach - 对于 ExpressionEngine 模板中的每个循环？

> ID：11265385
> 
> 赞同：2
> 
> 时间：2012-06-29T16:15:45.560
> 
> 标签：foreach, expressionengine

我创建了一个带有返回数组的函数的 EE 插件。例如

```
function things(){
    return array(
        array(
            'name'=>'bob',
            'age'=>40
        ),
        array(
            'name'=>'mary',
            'age'=>50
        )
    );
} 
```

我找不到任何方法来循环使用 vanilla EE 模板标签来遍历这个数组。插件只能返回字符串吗？这真的不可能还是我忽略了一些简单的事情？我想做类似的事情：

```
{foreach {things} }
    Name: {name}
    Age: {age}
{/foreach} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T17:03:31.953

您的数组结构正确，但您需要使用[模板类的解析变量方法](http://expressionengine.com/user_guide/development/usage/template.html#parsing-the-variables)。这种方法的好处在于，如果您愿意，它可以让您嵌套很多层（允许标签对内的标签对内的标签对），并且您还可以`{count}`自动获取`{total_results}`。

所以在你的插件中：

```
function things()
{
    $things = array(
        array(
            'name'=>'bob',
            'age'=> '40'
        ),
        array(
            'name'=>'mary',
            'age'=> '50'
        )
    );
    return $this->EE->TMPL->parse_variables($this->EE->TMPL->tagdata, $things);
} 
```

然后在您的模板中：

```
{exp:my_plugin:things}
    Name: {name}
    Age: {age}
{/exp:my_plugin:things} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-21T15:51:48.497

为 EE3 修改的先前答案的附加信息：

在模板中（相同）：

```
{exp:addon_name:method_name}

   Name: {name}
   Age: {age}

{/exp:addon_name:method_name} 
```

在插件插件中需要使用 ee()->TMPL：

```
$things = array(
        array(
            'name'=>'bob',
            'age'=> '40'
        ),
        array(
            'name'=>'mary',
            'age'=> '50'
        )
    );

    return ee()->TMPL->parse_variables(ee()->TMPL->tagdata, $things); 
```

# php - 在 PHP 中使用 ModRewrite 时抓取查询字符串

> ID：11265387
> 
> 赞同：0
> 
> 时间：2012-06-29T16:16:00.337
> 
> 标签：php, .htaccess, mod-rewrite, query-string

我在我的网站上通过 .htaccess 使用 URL 重写。然后我通过 PayPal 的 ExpressPay 提交并返回如下内容：

```
http://mydomian.com/cart/success?token=EC-123456789&PayerID=123456789 
```

/cart 和 /success 很棒，但是有没有一种简单的方法来获取“token”和“PayerID”变量？

这是我正在使用的 .htaccess ：

```
RewriteRule ^([^/\.]+)/?$ index.php?load=$1
RewriteRule ^([^/\.]+)/([^/\.]+)/?$ index.php?load=$1&query=$2
RewriteRule ^([^/\.]+)/([^/\.]+)/([^/\.]+)/?$ index.php?load=$1&query=$2&query2=$3 [L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:35:00.250

将 a 添加`[QSA]`到您的每个规则中，并将您的第三条规则更改为具有以下标志：`[L,QSA]`. 这将使您从 PayPal 返回的查询字符串将被附加，您将能够从 index.php 访问它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:17:51.880

您可以使用 {QUERY_STRING} 作为条件[http://www.simonecarletti.com/blog/2009/01/apache-rewriterule-and-query-string/](http://www.simonecarletti.com/blog/2009/01/apache-rewriterule-and-query-string/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:19:49.587

请参阅：[URL 重写 - 查询字符串](https://stackoverflow.com/questions/5606916/url-rewrite-query-string)

或者只是让 mydomain.com/cart/success 抓取 $_GET['token']

# c++ - c ++一个返回其行号的函数

> ID：11265388
> 
> 赞同：0
> 
> 时间：2012-06-29T16:16:01.547
> 
> 标签：c++

> **可能重复：**
> [被调用函数的 Gettin 行号](https://stackoverflow.com/questions/4452557/gettin-line-number-of-the-called-function)

我在调试，找到一个函数来返回这个函数在代码中的位置对我来说非常有用。更准确地说，是否有一个函数可以返回代码中函数的行号？例如，如果我在第 x 行调用 f()，则返回值是整数 x。

谢谢，迈克尔

# drag-and-drop - 如何设置 Vaadin 小部件的可拖动区域

> ID：11265391
> 
> 赞同：7
> 
> 时间：2012-06-29T16:16:40.553
> 
> 标签：drag-and-drop, vaadin7

我正在尝试创建一个包含可拖动组件的简单仪表板，但我对一个问题感到有些困惑。如果我在 DragAndDropWrapper 中包装我的可拖动“小部件”并将我的布局设置为接收拖放事件，从 UI 的角度来看，我不喜欢两件事：

1.  当我将东西（小部件，文件等）拖到它上面时，后面的整个布局区域会变成蓝色（一段时间）。我该如何关闭它 - 这是一个主题吗？

2.  整个小部件的区域都是可拖动的——如果我说小部件内的其他 UI 组件响应拖动事件，这是一个问题。

如何设置小部件的可拖动区域？我仍然希望在拖动时显示整个包装的组件，但我只希望在拖动时发生拖动，例如，小部件面板的标题栏。

我认为我暂时的解决方法是让小部件的一小部分可拖动，但我认为这不会a）容易或b）看起来不错（因为当你拖动小部件时它只会绘制它的可拖动区域- 标题栏，比如说）。

有任何想法吗？

提前谢谢了。

交流电

# php - php路径问题，需要解决方案

> ID：11265393
> 
> 赞同：-1
> 
> 时间：2012-06-29T16:16:46.280
> 
> 标签：php

当我将此脚本放在根目录中时，以下代码有效

```
if (file_exists("pics/2012/Blackhall Primary/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      } 
```

但是如果我将脚本移动到文件夹 /teacher/ 它将不再起作用。

我认为使路径 ~/pics/2012/blackhall primary/ 可行，但确实可行。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:19:52.450

有很多方法，一种方法是使用 ../pics/2012/Blackhall Primary/ 试试这个代码。有时特殊字符会导致问题，删除它们，如空格、% 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:19:20.697

最开始使用 / 表示你的原始 php 文件所在的根文件夹

```
if (file_exists("/pics/2012/Blackhall Primary/" . $_FILES["file"]["name"]))
{
  echo $_FILES["file"]["name"] . " already exists. ";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:21:55.847

该`file_exists`功能检查当前文件夹或子文件夹中的文件。因此，如果教师文件夹不是 *Blackhall Primary*的子文件夹，它将不起作用

[file_exists() - 文档](http://php.net/manual/en/function.file-exists.php)

# jsf - 会话 bean 在 HTTPS-DNS 组合上丢失

> ID：11265394
> 
> 赞同：1
> 
> 时间：2012-06-29T16:16:50.207
> 
> 标签：jsf, ssl, https, websphere

我有一个像这样的应用程序

F5 负载均衡器 - IHS(a&b) - Websphere 7(a&b) - JSF

当我尝试通过 https-dns 登录我的应用程序（通过 http 可以正常工作）时，会话 bean 会丢失，我不知道是什么可能导致这种情况，就好像您通过 https-dns 访问应用程序一样firefox 或 chrome bean 在那里，一切都很漂亮，但是 bean 在 IE7/8 中丢失（null）。

此外（我不知道它是否相关）如果您通过 https-ip 访问该应用程序在 IE7/8 中运行良好。

值得一提的是，我无法控制任何层的配置，我只是开发人员，我试图弄清楚，因为（显然）所有层支持的人都告诉我“这不是我们的问题，是你的应用程序" 甚至没有对 conf 进行简单检查，尽管相同的 EAR 被部署到两个相同的环境 (DEV-TESTING) 并且只有在后者中表现得很奇怪。

对此的任何启示将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T20:12:15.747

只是为了让任何人知道问题所在：

原来问题是我的会话cookie没有存储在IE中，经过很多谷歌魔法，我发现**DNS不能有下划线**

并从

**mysite_testing**

至

**我的网站测试**

解决了这个问题。

我找不到任何“官方”的东西，但这里有一些可能有用的链接。

[社交 MSDN A](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/666533ab-6634-4be5-a6d9-9b7239ed967f)
[社交 MSDN B](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/8e876e9e-b223-4f84-a5d1-1eda2c2bbdf4)
[SmartBear](http://blog.smartbear.com/software-quality/bid/170474/Internet-Explorer-Eats-Cookies-with-Underscores-in-the-Hostname)
[维基百科 RFC](http://en.wikipedia.org/wiki/Hostname)

# xcode - 在基于视图的应用程序上设置初始视图

> ID：11265398
> 
> 赞同：0
> 
> 时间：2012-06-29T16:17:02.663
> 
> 标签：xcode

我不知道如何使用 IBAction 和按钮从一个窗口转到另一个窗口，但我在徘徊，如果它们是一种执行“应用程序 didFinishLaunchingWithOptions”的方法 BOOL 目前（自创建以来未更改）它看起来像这样

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

// Override point for customization after application launch.

// Set the view controller as the window's root view controller and display.
self.window.rootViewController = self.viewController;
[self.window makeKeyAndVisible];

return YES;
} 
```

在这件事上的任何帮助都将受到极大的欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T14:58:57.780

在互联网上搜索了 2 个小时后，很明显我是唯一一个问过这样一个问题的人。但经过 1 个半小时的彻底失败后，我找到了解决方案。您必须首先做 3 件事，您必须进入 appDelegate.h 并更改以下内容

```
@class originalpageVeiwController;

@interface snakeAppDelegate : NSObject <UIApplicationDelegate> {
    UIWindow *window;
    originalpageVeiwController *viewController;
}

@property (nonatomic, retain) IBOutlet UIWindow *window;
@property (nonatomic, retain) IBOutlet originalpageVeiwController *viewController;

@end 
```

将 @class originalpageVeiwController 更改为 secoundpageViewController 并对该文件的其余部分执行相同操作（基本文件中再出现 2 次（@interface 和 @property））。

然后打开 MainWindow.xib 并单击 originalpageVeiwController 图标并进入属性检查器（⌘1）并将 ViewController 下的 NibName 更改为 secoundpageViewController 然后进入身份检查器（⌘4）并将类标识下的类更改为 secoundpageViewController 然后将更改保存到 MainWindow 并构建并运行。

# asp.net-mvc-3 - 在 MVC 3 Razor 中将下拉列表设置为特定值

> ID：11265400
> 
> 赞同：0
> 
> 时间：2012-06-29T16:17:07.483
> 
> 标签：asp.net-mvc-3, data-binding, drop-down-menu

整个下午。

**我的视图**中有一个下拉列表

 **```
 <div class="editor-label">
                    @Html.LabelFor(model => model.SiteTypeId, "SiteType")
                </div>
                <div class="editor-field">
                    @Html.DropDownList("SiteTypeId", (IEnumerable<SelectListItem>) ViewBag.SiteTypeId)
                    @Html.ValidationMessageFor(model => model.SiteTypeId)
                </div> 
```

**模型**看起来像这样：

```
public class SiteType
        {
            [Key]
            public int SiteTypeId { get; set; }
            public string SiteTypeName { get; set; }
        } 
```

目前下拉菜单中只有两个项目：

```
1 (value) - Foo (item)  
2 (value) - Bar (item) 
```

它通过**控制器**显示：

```
public ActionResult Details(Guid id)
    {
        var model = Model(id);

        ViewBag.SiteTypeId = new SelectList(db.SiteTypes, "SiteTypeId", "SiteTypeName");
        return View(model.Details);
    } 
```

用户将相应地对其进行更新，并将其存储在数据库中。

我可以从数据库中获取下拉列表的值没有问题，但是我将如何有效地将这个值绑定到列表？

伙计，我觉得问这个很简单:'(

任何帮助总是很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:19:14.080

不要为`ViewBag`包含 SelectList 的参数使用相同的名称作为 DropDownList 帮助器的第一个参数：

```
ViewBag.SiteTypes = new SelectList(db.SiteTypes, "SiteTypeId", "SiteTypeName"); 
```

在视图中：

```
@Html.DropDownList("SiteTypeId", (IEnumerable<SelectListItem>)ViewBag.SiteTypes) 
```

现在，在提交此表单时的 POST 操作中，选定的值将作为名为 的参数传递`SiteTypeId`。**

# php - 从其他文件中获取变量的值 - PHP

> ID：11265406
> 
> 赞同：2
> 
> 时间：2012-06-29T16:17:54.067
> 
> 标签：php, include, require

我需要获取另一个文件中存在的变量的值。我知道我可以使用 include 或 require 函数，但在这两种情况下，它都会打印出包含在文件中的整个输出。那么有没有办法只获取变量的值而不是另一个文件的输出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:20:39.867

```
ob_start();
include($filename);
ob_end_clean(); 
```

您的变量现在应该在范围内可用。

当然，如果您关心输出，您可能希望保留它：

```
ob_start();
include($filename);
$output = ob_get_contents();
ob_end_clean(); 
```

需要注意的是，如果您是整个应用程序的设计者，则永远不要这样做。相反，将所有变量设置在一个文件中，并使用一个单独的文件生成输出。理想情况下，查看 MVC 架构，其中控制器设置变量，视图/模板进行输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:21:49.900

以下可以做到：

```
ob_start();
include(...);
ob_end_clean(); 
```

ob_start() 开始输出缓冲，其中没有任何内容发送到浏览器/cli/等。包括你的文件。文件中的变量将可用，所有回显等都不会显示。

ob_end_clean() 将转储缓冲区，就像在擦除时一样，并且在释放内存时不会显示信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:25:27.270

取该值并将其放入第三个文件中。`include`该文件在您的文件 1 和 2 中。

换句话说，改进您的应用程序的结构，以便可以访问您需要单独访问的内容。

# ios - 丢失当前位置值

> ID：11265414
> 
> 赞同：0
> 
> 时间：2012-06-29T16:18:19.007
> 
> 标签：ios, xcode, cllocation

我可以毫无问题地获得当前位置。但是，当我尝试计算距离时，我的 currentLoc 的值为 0。我缺少什么来携带 currentLoc 所以它不是 0？

我在 LocationManager 中的 NSLog 给出了正确的值。

```
#import "AuthorViewController.h"
#import "Author.h"
#import <sqlite3.h>

@implementation AuthorViewController
@synthesize theauthors;
@synthesize currentLoc;

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    currentLoc = newLocation;

    if (newLocation.horizontalAccuracy <= 100.0f) {
        [locMgr stopUpdatingLocation];
}
    NSLog(@"Lat: %f, Long: %f", currentLoc.coordinate.latitude, currentLoc.coordinate.longitude);

    [self barList];
    [self.tableView reloadData];
}

- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error
{
    NSString *msg = [[NSString alloc]initWithString:@"Error obtaining location"];
    UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Error" message:msg delegate:nil cancelButtonTitle:@"Done" otherButtonTitles:nil];
    [alert show];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    locMgr = [[CLLocationManager alloc] init];
    locMgr.delegate = self;
    [locMgr startUpdatingLocation];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    // Return the number of rows in the section.
    return [self.theauthors count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
         cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
    int rowCount = indexPath.row;

    Author *author = [self.theauthors objectAtIndex:rowCount];

    cell.textLabel.text = author.barName;

    if (currentLoc == nil) {
        cell.detailTextLabel.text = [NSString stringWithFormat:@"?"];
    }else
    {
        cell.detailTextLabel.text = [NSString stringWithFormat:@"%.02f km", author.cachedDist];
    }

    return cell;
} 
```

它在我的数组中，我的 NSLog 显示当前位置的 lat 和 long 值为 0。

```
-(NSMutableArray *) barList{
    theauthors = [[NSMutableArray alloc] init];
    @try {
        NSFileManager *fileMgr = [NSFileManager defaultManager];
        NSString *dbPath = [[[NSBundle mainBundle] resourcePath ]stringByAppendingPathComponent:@"TulsaBars.sqlite"];
        BOOL success = [fileMgr fileExistsAtPath:dbPath];
    if(!success)
    {
        NSLog(@"Cannot locate database file '%@'.", dbPath);
    }
    if(!(sqlite3_open([dbPath UTF8String], &db) == SQLITE_OK))
    {
        NSLog(@"An error has occured: %@", sqlite3_errmsg(db));

    }

    const char *sql = "SELECT * FROM  TulsaBars";
    sqlite3_stmt *sqlStatement;
    if(sqlite3_prepare(db, sql, -1, &sqlStatement, NULL) != SQLITE_OK)
    {
        NSLog(@"Problem with prepare statement:  %@", sqlite3_errmsg(db));
    }else{

        while (sqlite3_step(sqlStatement)==SQLITE_ROW) {
            Author * author = [[Author alloc] init];
            author.barName = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement,1)];
            author.barAddress = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement,2)];
            author.barState = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement, 5)];
            author.barLat = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement, 8)];
            author.barLong = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement, 9)];

            if (currentLoc == nil) {
                NSLog(@"current location is nil %@", currentLoc);
            }

            CLLocation *barLocation = [[CLLocation alloc] initWithLatitude:[author.barLat doubleValue] longitude:[author.barLong doubleValue]];
            CLLocationDistance distancekm = [currentLoc distanceFromLocation: barLocation]/1000;
            NSString *distanceString = [[NSString alloc] initWithFormat: @"%f", distancekm];
            author.cachedDist = distanceString;

            [theauthors addObject:author];

            NSLog(@"Lat3: %@, Long3: %@, CurLocLat: %f, CurLocLong: %f, BarLoc: %@, DistKM: %@", author.barLat, author.barLong, currentLoc.coordinate.latitude, currentLoc.coordinate.longitude, barLocation, distancekm);

        }
    }
    sqlite3_finalize(sqlStatement);
}
@catch (NSException *exception) {
    NSLog(@"Problem with prepare statement:  %@", sqlite3_errmsg(db));
}
@finally {
    sqlite3_close(db);

    return theauthors;
}
}
end 
```

# c# - BeginInvoke 方法的全部内容，所以它不会关闭我的应用程序？

> ID：11265416
> 
> 赞同：2
> 
> 时间：2012-06-29T16:18:26.967
> 
> 标签：c#, winforms

我可以在 C# 中为 BeginInvoke 方法注册一个包罗万象的处理程序吗？

在我的 MainForm 中启动时，我有这个代码

```
 Application.ThreadException += new ThreadExceptionEventHandler(UIExceptionHandler);
        AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);
        AppDomain.CurrentDomain.ProcessExit += new EventHandler(CurrentDomain_ProcessExit); 
```

我认为这就足够了，但另一种形式的例外是取消我的申请。我该如何处理？（我真的不想进入每个用户控件，我有一个使用我自己的 try..catch 添加代理 BeginInvoke 方法，也不想将它添加到我拥有的每个 BeginInvoke 调用中......那会很乏味与添加一个包罗万象的处理程序相比）。

谢谢，院长

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:20:47.620

尝试这个：

```
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException); 
```

[这是关于 SetUnhandledExceptionMode 的 MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.setunhandledexceptionmode.aspx)

[此外，如果您在 debug (JoshL's answer) 中看到这个问题，可能会更有意义](https://stackoverflow.com/questions/545760/which-config-element-affects-exception-handling-with-unhandledexceptionmode-set)。基本上，它默认为自动，如果`jitDebugging`配置设置为 true（如果您正在调试，则为 true），那么应用程序将抛出而不是 catch 到您的处理程序中。

# android - 更新到 ADT 20 后的 Android 模拟器不再自动旋转屏幕

> ID：11265418
> 
> 赞同：1
> 
> 时间：2012-06-29T16:18:35.297
> 
> 标签：android, android-emulator, adt, autorotate

一切都很好，直到我昨天更新到 ADT 20，现在当我用 CTRL-F11 旋转屏幕时，屏幕旋转，但应用程序 (ANDROID) 仍处于纵向模式。

所以我的问题是是否有可能解决这个问题并使其轮换或降级到 ADT 19？

PS：检查 2.3.3 和 4.1 图像，开发平台是 Mac OS X 10.7.4

PPS：我能够降级的唯一方法是查看我的 Time Machine 备份并将 Eclipse 和平台工具文件夹复制到我的 Mac

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T03:17:30.037

我找到了解决方案，只需在模拟器属性中添加属性“键盘支持-->是”即可解决问题。希望它有所帮助。

# git - 版本控制 couchdb map-reduce 函数

> ID：11265422
> 
> 赞同：8
> 
> 时间：2012-06-29T16:18:47.267
> 
> 标签：git, version-control, couchdb, mapreduce

如何对 CouchDB 的 map/reduce 函数进行版本控制？我希望能够将它们签入 git/github，以便我的队友可以轻松地将它们应用到他们的本地测试环境中。我知道 CouchDB 中的复制功能，但我想将数据库视图与项目的源一起保留。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-30T18:22:11.047

您需要的是（许多）couchapp 工具之一。基本上它们都将一堆各种结构的 js 文件映射到 CouchDB 使用的设计文档布局，并且通常提供一些简单的推/拉机制来获取这些文件。

然后，您可以在主文件夹中 git init 并确保您正在对上传的设计文档进行版本控制。

有一个很好的解释[http://mindeavor.com/blog/the-anatomy-of-a-couchapp](http://mindeavor.com/blog/the-anatomy-of-a-couchapp)暂时忽略供应商/讨论，它不是必需的。

如果您更喜欢 JS/node 人，请尝试[https://github.com/mikeal/node.couchapp.js/](https://github.com/mikeal/node.couchapp.js/)或 kanso [http://kan.so/](http://kan.so/)很棒，但它还有更多功能；你可能会发现在进入它之前你需要更多的 Couch-fu。它非常好，但是你可以通过使用`kanso push`来开始。

如果您只是想开始，请使用 couchapp [http://github.com/couchapp/couchapp](http://github.com/couchapp/couchapp)这是一个 python 工具，可能是原始工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:54:17.327

我们（而且我相信大多数团队）完全按照您所说的那样做。我们将视图等保存在源代码树中并提交给 git。我们的应用程序是一个节点应用程序，因此我们特别简单地获取源代码并将它们保存到数据库中，但这在任何语言中都相当简单 - 只需提出一个命名方案，将 JS 文件存储在特定的放置并读取文件并将数据存储在数据库中适当的密钥结构中`_design/document`。

# facebook - 从我的网站登录 Facebook

> ID：11265424
> 
> 赞同：-2
> 
> 时间：2012-06-29T16:18:53.393
> 
> 标签：facebook, facebook-login

我需要使用我网站上的 facebook 实现登录。

请给我一个php中的示例代码

问候

阿伦·克里希南 G

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:21:58.573

Facebook 提供您需要的所有文档和示例代码：

[http://developers.facebook.com/docs/](http://developers.facebook.com/docs/)

[http://developers.facebook.com/docs/reference/php/](http://developers.facebook.com/docs/reference/php/)

# java - 设置 java 类路径（用于超级开发模式）

> ID：11265425
> 
> 赞同：6
> 
> 时间：2012-06-29T16:18:54.233
> 
> 标签：java, gwt, classpath, gwt-super-dev-mode

我正在尝试`gwt-codeserver.jar`使用以下命令在 OSX.7中运行 jar

```
java -cp ".:/sdk/gwt-2.5.0.rc1/gwt-dev.jar" -jar /sdk/gwt-2.5.0.rc1/gwt-codeserver.jar com.activegrade.TeacherView 
```

该命令失败并显示：

```
Exception in thread "main" java.lang.NoClassDefFoundError: com/google/gwt/core/ext/TreeLogger
Caused by: java.lang.ClassNotFoundException: com.google.gwt.core.ext.TreeLogger
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    ... 
```

但是 gwt-dev.jar 包含 com.google.gwt.core.ext.TreeLogger 的定义，所以我得出的结论是我在这里没有正确设置类路径。

我是否正确设置了类路径？jar 文件绝对是正确的 jar，它肯定在那个位置。我该如何进一步诊断？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T20:29:39.033

我已经让 CodeServer 作为 Eclipse 中的外部工具运行（警告 - 您仍然必须以某种方式提供您的 html 文件，我还没有这样做，但这似乎确实让 codeserver 运行）。要将 CodeServer 设置为 Eclipse 中的外部工具，

0) 请记住，您还应该更新您的 module.gwt.xml 文件以允许 Super Dev Mode 书签标记并启用源映射以进行调试。将这些喜欢添加到您的 module.gwt.xml 文件中。

```
<!-- enable the SuperDevMode book marklets  -->
<add-linker name="xsiframe"/>
<set-configuration-property name="devModeRedirectEnabled" value="true"/>

<!--  enable source maps -->
<set-property name="compiler.useSourceMaps" value="true" /> 
```

1) 打开外部工具/外部工具配置对话框；这是在 Windows 的顶级“运行”菜单下。

2) 通过在左侧列表中选择“程序”来创建新配置，然后按“新建”按钮（它看起来像一个文档）。在对话框中命名您的配置。

3) java.exe 文件的路径位于“位置：”框中。如果您不知道路径，可以使用“浏览文件系统”按钮来定位它。

4）我将工作目录留空。我不确定这是否重要；没有它似乎可以工作。有没有人知道这是否应该设置？

5）“参数：”框中的大部分工作。您将为类路径提供一个参数，其中包括 gwt-dev.jar、gwt.user.jar、gwt-codeserver.jar 和源目录的路径。然后，您将为 gwt-codeserver.jar 和要运行的 CodeServer 类提供一个 -jar 和参数，然后您将向 CodeServer 提供参数。我会分解它；

5a) -cp "逗号分隔的类路径列表，用双引号括起来"。为了使您的工具定义更加可移植，请使用 eclipse“Varaibles”来计算与您的安装相关的路径。特别是，我使用“workspace_loc”作为工作空间的相对路径（如 src 目录），使用“eclipse_home”作为 gwt SDK 的路径gwt-user.jar 之类的东西（因为我在 eclipse 插件文件夹中安装了 SDK）。这是我的类路径部分；

```
-cp "${eclipse_home}plugins\gwt-2.5.0.rc1\gwt-2.5.0.rc1\gwt-user.jar;${eclipse_home}plugins\gwt-2.5.0.rc1\gwt-2.5.0.rc1\gwt-dev.jar;${workspace_loc:\GWTFractionTest\war\WEB-INF\lib\gwtquery-1.1.0.jar};${eclipse_home}plugins\gwt-2.5.0.rc1\gwt-2.5.0.rc1\gwt-codeserver.jar" 
```

5b) 接下来是 java.exe 应该运行的类的名称。这是 CodeServer 类；

```
com.google.gwt.dev.codeserver.CodeServer 
```

5c) 接下来是 CodeServer 的参数。第一个是直接指向 src 的路径。对我来说，这是一个工作区相对路径；

```
-src "${workspace_loc:\GWTFractionTest\src}" 
```

5d）最后，模块路径（你的 gwt.xml 文件的类路径）这是我的；

```
com.conceptua.fractiontest.FractionTest 
```

这是我的完整参数列表；

```
-cp "${eclipse_home}plugins\gwt-2.5.0.rc1\gwt-2.5.0.rc1\gwt-user.jar;${eclipse_home}plugins\gwt-2.5.0.rc1\gwt-2.5.0.rc1\gwt-dev.jar;${workspace_loc:\GWTFractionTest\war\WEB-INF\lib\gwtquery-1.1.0.jar};${eclipse_home}plugins\gwt-2.5.0.rc1\gwt-2.5.0.rc1\gwt-codeserver.jar" com.google.gwt.dev.codeserver.CodeServer -src "${workspace_loc:\GWTFractionTest\src}" com.conceptua.fractiontest.FractionTest 
```

6) 选择“运行”按钮运行 CodeServer。当我在控制台中执行此操作时；

```
workDir: C:\Users\Ezward\AppData\Local\Temp\gwt-codeserver-6942784883227417581.tmp
binding: user.agent=safari
binding: compiler.useSourceMaps=true
binding: locale=en
Compiling module com.conceptua.fractiontest.FractionTest
   Validating units:
      Ignored 72 units with compilation errors in first pass.
Compile with -strict or with -logLevel set to TRACE or DEBUG to see all errors.
   Computing all possible rebind results for 'com.google.gwt.useragent.client.UserAgentAsserter'
      Rebinding com.google.gwt.useragent.client.UserAgentAsserter
         Checking rule <generate-with class='com.google.gwt.editor.rebind.SimpleBeanEditorDriverGenerator'/>
            [WARN] Detected warnings related to 'com.google.gwt.editor.client.SimpleBeanEditorDriver'.   Are validation-api-<version>.jar and validation-api-<version>-sources.jar on the classpath?
            Specify -logLevel DEBUG to see all errors.
            [WARN] Unknown type 'com.google.gwt.editor.client.SimpleBeanEditorDriver' specified in deferred binding rule
   Compiling 1 permutation
      Compiling permutation 0...
      Source Maps Enabled
   Compile of permutations succeeded
Linking into C:\Users\Ezward\AppData\Local\Temp\gwt-codeserver-6942784883227417581.tmp\com.conceptua.fractiontest.FractionTest\compile-1\war\fractiontest; Writing extras to C:\Users\Ezward\AppData\Local\Temp\gwt-codeserver-6942784883227417581.tmp\com.conceptua.fractiontest.FractionTest\compile-1\extras\fractiontest
   Link succeeded
   Compilation succeeded -- 58.257s
Compile completed in 60831 ms
2012-07-01 12:37:03.184::INFO:  Logging to STDERR via org.mortbay.log.StdErrLog
2012-07-01 12:37:03.185::INFO:  jetty-6.1.x

The code server is ready.
Next, visit: http://localhxst:9876/
2012-07-01 12:37:03.274::INFO:  Started SelectChannelConnector@127.0.0.1:9876 
```

我不确定为什么我会得到最初的“72 个带有编译错误的单元”，但它似乎继续成功编译和运行服务器。

7) 此时，您应该在 Chrome 中输入给定的 CodeServer url。您将获得一个指示 CodeServer 正在运行的页面，您可以将书签标记拖到书签工具栏；

```
GWT Code Server
Drag these two bookmarklets to your browser's bookmark bar:
Dev Mode On Dev Mode Off
Visit a web page that uses one of these modules:
fractiontest
Click "Dev Mode On" to start development mode. 
```

8) 下一步是获取您的 html 文件以运行它。它显然需要由单独的网络服务器提供服务。我还在做那部分工作。

埃德

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T17:00:31.910

[这](https://stackoverflow.com/questions/250166/noclassdeffounderror-while-trying-to-run-my-jar-with-java-exe-jar-whats-wron)可能是您问题的根源吗？“使用 -jar 选项时，JAR 文件是所有用户类的来源，其他用户类路径设置将被忽略。”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T19:32:11.273

我浪费了很多时间试图让它发挥作用。我尝试遵循出色的 Ezward 说明，但我的设置可能有些不同，并且对我不起作用。有许多移动部件，任何错误都会导致大量 NullPointer、StackOverflow 和 UnableToComplete 异常。

我在[http://blog.daniel-kurka.de/2012/07/mgwt-super-dev-mode.html（Daniel](http://blog.daniel-kurka.de/2012/07/mgwt-super-dev-mode.html) Kurka 博客）找到了唯一对我有用的说明。希望它能帮助像我这样被 GWT 超级开发模式困住的其他人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T17:25:06.917

你可以像下面这样使用它..

```
java -cp ".:/sdk/gwt-2.5.0.rc1/gwt-dev.jar:/sdk/gwt-2.5.0.rc1/gwt-codeserver.jar" com.activegrade.TeacherView 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T18:35:46.370

有同样的问题。这对我有帮助：

```
java -cp "./gwt-codeserver.jar:./gwt-dev.jar" com.google.gwt.dev.codeserver.CodeServer 
```

您可以像这样添加 --help ：

```
java -cp "./gwt-codeserver.jar:./gwt-dev.jar" com.google.gwt.dev.codeserver.CodeServer --help 
```

会输出：

```
CodeServer [-bindAddress address] [-port port] [-workDir dir] [-src dir] [module]

where 
  -bindAddress  The ip address of the code server. Defaults to 127.0.0.1.
  -port         The port where the code server will run.
  -workDir      The root of the directory tree where the code server willwrite compiler output. If not supplied, a temporary directorywill be used.
  -src          A directory containing GWT source to be prepended to the classpath for compiling.
and 
  module        The GWT modules that the code server should compile. (Example: com.example.MyApp) 
```

然后只需设置您的 -src 目录和模块的名称

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-08T17:43:15.987

除了 gwt-dev.jar 之外，我还可以通过将 gwt-user.jar 添加到类路径来解决此问题。GWT 超级开发模式[说明](http://www.gwtproject.org/articles/superdevmode.html)说您可能需要添加 gwt-user.jar。

# excel - 多条件查找功能

> ID：11265427
> 
> 赞同：1
> 
> 时间：2012-06-29T16:18:58.663
> 
> 标签：excel

我试图找出当地的新闻稿是否会影响公司加入某个政府计划的决定。我的 Excel 文档包含 A) 公司列表，B) 这些公司的邮政编码，以及 C) 这些公司与该计划中的人员取得联系的日期。

![公司](../Images/f974ee9d56b52be40030d1be1398816e.png)

其次，我建立了一份文件，其中包含该机构在过去一年中发出的所有新闻稿。它包含新闻稿发布的日期，以及新闻稿所涵盖区域的邮政编码的最小值和最大值。

![新闻稿](../Images/30215b50e75aeba94561d5246cf96435.png)

我正在尝试编写一个检查两件事的函数：

1.  公司的邮政编码是否在任何新闻稿所涵盖的范围内？
2.  是否有任何符合这些标准的新闻稿在建立联系前三个月内发出？

如果两者都为真，则该函数应返回 1 或其他值。如果不是 0 当然就足够了。

我该怎么做呢？

* * *

除了 Barry Houdini 的提议，我还添加了另一个截图：

![在此处输入图像描述](../Images/8c54536f948b6edda913c8585cc2191f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:37:12.740

这是一个公式方法，假设 Excel 2007 或更高版本

为简单起见，假设两个表都在一个工作簿中，第一个表是 sheet1，第二个表是 sheet2，然后您可以在 Sheet1 D3 中使用此公式复制下来

`=(COUNTIFS(Sheet2!D:D,"<="&B3,Sheet2!E:E,">="&B3,Sheet2!B:B,">="&EDATE(C3,-3),Sheet2!B:B,"<="&C3)>0)+0`

COUNTIFS 也可以在 2 个单独的工作簿之间应用，但都需要打开.....

# java - Arquillian 无人机/石墨烯/硒和 UI/功能测试

> ID：11265435
> 
> 赞同：5
> 
> 时间：2012-06-29T16:19:35.240
> 
> 标签：java, selenium, functional-testing, jboss-arquillian

在投入大量时间完全学习 JBoss Arquillian 并将其用于我所有的集成和功能测试方面，我半途而废。我 100% 确定我想将它用于我的集成测试框架，但对将它用于 UI/功能测试有点怀疑，并希望有 Arquillian Drone/Graphene/Selenium 经验的人可以担保它的能力：

*   我是否能够在我的 Java 测试用例中模拟对*任何DOM 元素（按钮、div、图像等）的**任何*类型的最终用户输入（鼠标单击、击键等） ？
**   我能否在所有主流浏览器（IE、FF、Chrome 和 Safari）和版本中模拟所有这些输入？*   我是否能够在所有主要移动设备（用于移动 Web 和 Android、iOS、Windows Phone、Blackberry、Kindle 和 Nook 用于原生）和版本的所有主要移动设备上模拟所有这些输入？*

 *提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-05T11:25:37.523

Arquillian Drone 和 Graphene 构建在 Selenium/Webdriver 之上。前者简化了驱动程序的配置和管理，后者提供了一些很好的抽象和外观来与浏览器交互。

您可以在项目文档页面上找到很多有用的信息：

*   [无人机](https://docs.jboss.org/author/display/ARQ/Drone)
*   [石墨烯](https://docs.jboss.org/author/display/ARQGRA2)

因此，当您将 Arquillain 与 Drone/Graphene 结合使用时，Happy Selenium User 已经提到的所有内容都可用。

Arquillian 生态系统中还有一个 Android 扩展，它可以驱动你的 Web 测试（再次通过 WebDriver），它简化了连接/管理你的 Android 设备或模拟器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T17:03:26.180

快乐的 Selenium (WebDriver) 用户在这里。我不知道 Arquillian Drone / Graphene 是什么，但我非常了解 Selenium：

1.  > 我是否能够在我的 Java 测试用例中模拟对任何 DOM 元素（按钮、div、图像等）的任何类型的最终用户输入（鼠标单击、击键等）？

    任何 DOM 元素的任何类型的输入：

    *   鼠标单击、双击、右键单击
    *   击键、同时按键、功能键
    *   drag'n'drop（在浏览器内 - 你不能真正将文件从桌面拖到页面上的元素）
    *   以上的任意组合，甚至定义为单个动作

        此外，

    *   上传文件（没有可靠的下载，尽管对于大多数浏览器/本地 Java 下载都有很好的用户制作的解决方法）
    *   运行 JavaScript
    *   截图
    *   cookie 管理

        但是，Selenium 对 Silverlight 和 Flash 元素的支持非常有限。

2.  > 我能否在所有主流浏览器（IE、FF、Chrome 和 Safari）和版本中模拟所有这些输入？

    IE、FF、Opera、Chrome，都没有问题。[对 Safari 的支持](http://code.google.com/p/selenium/wiki/SafariDriver)是非常新的（从 4 月开始），并且仍然带有注释[Beta](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/safari/SafariDriver.html)，所以那里没有确定性。但是，它大部分都可以工作，并且每个附加版本都更加完整。

3.  > 我是否能够在所有主要移动设备（用于移动 Web 和 Android、iOS、Windows Phone、Blackberry、Kindle 和 Nook 用于原生）和版本的所有主要移动设备上模拟所有这些输入？

    *   [Android](http://code.google.com/p/selenium/wiki/AndroidDriver)：是的，WebView 配置为 Android 浏览器
    *   [iOS](http://code.google.com/p/selenium/wiki/IPhoneDriver)：是的，UIWebView
    *   其他：只是非正式的：无头[WebKitDriver](http://code.google.com/p/webkitdriver/)，两年死了[BlackBerryDriver](http://code.google.com/p/webdriver-blackberry/)

        在那些移动浏览器上，当然包括旋转、手指滑动等。*

# sharepoint - 我无法将现有 Web 部件添加到页面

> ID：11265437
> 
> 赞同：0
> 
> 时间：2012-06-29T16:19:42.410
> 
> 标签：sharepoint, sharepoint-2010

我在使用 Sharepoint 时遇到了一个奇怪的问题。我创建了一个站点并添加了它的内容数据库，它包含例如 VisualStudio 上名为 Webpart1 的 Web 部件，因为无法找到 Web 部件，所以像往常一样不显示它。我部署了我的 Webparts 项目，重新加载页面，现在我可以看到呈现的 Wepart1。一切正常。

但是，如果我编辑页面，请转到添加 -> 自定义 Webpart -> Webpart1 我收到一条错误消息，提示无法找到该 Web 部件或未将其注册为安全的。

我已经检查了所有设置，它们似乎是正确的，如果不是，页面上已经存在的 webpart 将不会显示，但确实如此，所以如果画廊上的 webpart 与网站上的 webpart 相同，怎么可能不显示被发现或注册为安全？我错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T18:09:47.337

如果您通过按 F5（调试）从 Visual Studio 部署 Web 部件，它将在您停止调试项目时收回解决方案。尝试右键单击项目并选择部署。然后您应该能够转到侧面并编辑页面并添加 Web 部件。

# visual-studio-2010 - 使用 Visual Studio 中的 psscor

> ID：11265445
> 
> 赞同：2
> 
> 时间：2012-06-29T16:20:08.010
> 
> 标签：visual-studio-2010, debugging, visual-studio-debugging, sos

我在 Visual Studio 中使用过 sos。是否可以从 Visual Studio 运行 psscor ？它需要任何特殊配置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T20:01:36.050

您可以从 Visual Studio 2010 加载 PSSCOR，但与 SOS 相比，与在 WinDbg 中加载这些扩展所获得的体验相比，体验有些有限。要在 VS 中加载其中任何一个，您需要为项目启用本机调试。另外，请记住，.NET 2 和 .NET 4+ 有不同的 PSSCOR 版本。将扩展 DLL 放在 SOS 旁边（即与框架一起）。

您可能有兴趣了解 Visual Studio 2012 RC 扩展了对加载 SOS 的支持。要启用此功能，您必须同时安装平台 SDK 和设备驱动程序 SDK。如果这样做，您将获得用于用户模式和内核模式调试的新传输协议。选择适当的协议以启用新的调试器即时窗口。从这里您可以加载 SOS 并执行您在 WinDbg 中可以执行的几乎所有 SOS 任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T18:10:35.040

但是我认为 64 位进程转储的转储分析似乎不起作用。我想这是因为 Visual Studio 即使是 VS 2012 仍然是一个 32 位应用程序。所以我们仍然必须依赖 WinDBG 来处理 PSSCOR/SOS/SOSEX。

# jquery - 带有 HTML 属性的 jQuery 活动选项卡

> ID：11265449
> 
> 赞同：1
> 
> 时间：2012-06-29T16:20:29.053
> 
> 标签：jquery, html, tabs

有没有办法选择带有 HTML 属性的 jQuery 活动选项卡。

就像是：

```
<div id="tabs">
    <ul>
        <li><a href="#tabs-1">Nunc tincidunt</a></li>
        <li><a href="#tabs-2">Proin dolor</a></li>
        <li><a href="#tabs-3">Aenean lacinia</a></li>
    </ul>
    <div id="tabs-1" selected="true">
        tab 1
    </div>
    <div id="tabs-2">
        tab 2
    </div>
    <div id="tabs-3">
        tab 3
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:24:25.933

是的。

```
alert( $('#tabs[selected="true"]').html() ) 
```

你也可以做这样的事情

```
$("#tabs").tabs();
$('#tabs').tabs('select', $('div[selected=true]').attr('id')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:26:02.200

你可能正在寻找这样的东西吗？

```
$(function () {
    $("#tabs").tabs();
    $("#tabs").bind("tabsshow", function (event, ui) {
        window.location = ui.tab;
    });
}); 
```

# css - ie7中的z-index不起作用

> ID：11265455
> 
> 赞同：1
> 
> 时间：2012-06-29T16:21:01.627
> 
> 标签：css, internet-explorer

无法解决在 ie7 中为 DOM 元素提供 z-index 的解决方案。好的，这是真正的标记：

```
<div id="page-wrap">
<div class="push"></div>
<footer id="footer-container" class="source-org vcard copyright">
<div class="grass"></div>
<div id="footer"></div>
</footer> 
```

这里的CSS：

```
#page-wrap {
    height: auto !important;
    margin: 0 auto -60px;
    min-height: 100%;
    position: relative;
    width: 98%;
}
.push {
    height: 60px;
}
#footer-container {
    background-color: #1B1B1B;
    bottom: 0;
    height: 60px;
    position: relative;
    width: 100%;
}
.grass {
    background-image: url("assets/images/grass.png");
    background-repeat: repeat-x;
    height: 82px;
    position: absolute;
    top: -78px;
    width: 100%;
}
article, aside, figure, footer, header, hgroup, nav, section {
    display: block;
}
#footer {
    margin: auto;
    position: relative;
    top: 20px;
    width: 960px;
} 
```

希望能帮助到你。实际上，这在所有浏览器上都可以正常工作，即使是 ie9 和 ie8。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:39:11.780

好吧，您没有提供足够的代码和 z-index 的使用，所以我的逻辑猜测是 ie7 的问题是错误的 z-index 解释。要解决您的问题，请为您想要的元素提供负 z-index。例如，

```
<div style="z-index:-1;" id="beneath"></div>
<div style="z-index:1;" id="above"></div> 
```

会工作，但是，

```
 <div style="z-index:0;" id="beneath"></div>
 <div style="z-index:1;" id="above"></div> 
```

在ie7中不起作用。

**所以为了让它工作给下面的负值（*你想要的“下面”）div**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T12:51:37.047

我发现了一些关于 IE 的神秘之处
IE 无法读取超过 1000 的 z-index 值

# sitecore - sitecore 配置/插入选项（角色、访问设置？）

> ID：11265457
> 
> 赞同：1
> 
> 时间：2012-06-29T16:21:05.553
> 
> 标签：sitecore, sitecore6

在 sitecore cms UI 上，顶部有一个配置工具栏，有时可用，有时不可用。此工具栏允许我设置插入选项，但不可用。我试图弄清楚什么访问设置或用户角色控制这是否可见？

另外，我可以强制所有孩子的父母插入选项吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T16:18:47.407

sitecore 的 UI 都在核心数据库中定义，这些项目的安全设置决定了谁可以访问它们。

切换到 sitecore 桌面上的核心数据库并查看 /sitecore/content/applications/content 编辑器及其子项。（我不在电脑前，所以不一定准确，但应该很接近）。您可能正在寻找一个功能区项目来设置安全性。

祝你好运 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T06:28:24.307

您至少需要`Sitecore Client Authoring`or`Sitecore Client Designing`角色才能访问配置功能区。然后，您还需要访问该功能区中的块。据我所知，你需要这个`Sitecore Client Developing`角色。

所以最快的方法是给用户这三个角色。

如果您想要控制功能区的哪些部分可由特定角色访问，您可以在访问查看器`/sitecore/content/Applications/Content Editor/Ribbons/Chunks`中为**Core**数据库中的子项设置读取权限。

# eclipse - 在eclipse中运行clojure文件

> ID：11265459
> 
> 赞同：1
> 
> 时间：2012-06-29T16:21:10.030
> 
> 标签：eclipse, clojure

我已经在 eclipse 中安装了 clojure 插件，这样我就可以开始在 clojure 上开发应用程序了。我目前处于学习阶段。我需要知道如何在 Eclipse 中使用键盘快捷键或单击鼠标按钮来运行 clojure 文件。

### *目前我正在这样运行，*

1.  我按`Ctrl`+ `F11`，它启动 REPL
2.  然后在 REPL 中我调用函数名。例如（你好“世界”）。我必须在 REPL 中逐字输入

### *我在寻找什么。*

1.  我想按快捷键
2.  评估当前文件后的输出应该显示我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:35:24.197

使用`Clojure`->`Load the file in REPL`或快捷键`Ctrl`++ `Alt`。`S`

它将在 REPL 中加载文件并显示结果。

# javascript - 通过 ajax post (jQuery) 发送 input type="file" 表单数据

> ID：11265461
> 
> 赞同：2
> 
> 时间：2012-06-29T16:21:13.393
> 
> 标签：javascript, ajax, jquery

我想从这样的输入发送帖子数据：

```
<input type="file" name="userFile" id="userFile"/> 
```

?

我需要使用 $.post 通过 ajax 将它发送到指定的文件。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:23:46.327

如果没有 HTML5，这是不可能的，而且如果没有针对不支持它的浏览器的解决方法，html5 解决方案将无法在所有浏览器中运行。

解决此问题的最跨浏览器方法是不使用 ajax，而是发布到隐藏的 iframe。

或者使用诸如[uploadify 之](http://www.uploadify.com/)类的插件。

当不支持 html5 方法时，大多数（如果不是全部）实现此功能的 jQuery 插件使用 flash 或隐藏 iframe。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:36:52.590

使用[jquery.form](http://jquery.malsup.com/form/)插件......

# c# - 安全地遍历阻塞集合？

> ID：11265462
> 
> 赞同：0
> 
> 时间：2012-06-29T16:21:16.690
> 
> 标签：c#, .net-4.0, concurrent-collections

我有以下代码：

```
 private static void FetchAllDataForAllNodesInCache()
    {
        var tasksList = Cache.TreeNodeItemsCollection.Select(nodeToEnrich => new Task(() => InsertQueuesIntoNode(nodeToEnrich))).ToList();

        var count = tasksList.Count;
    }

    private static void InsertQueuesIntoNode(TreeNode toEnrich)
    {
        // blagh do something?
    } 
```

我的问题是，在设置新任务时是否需要使用 Take 或 Try Take 方法，或者上述方法是否可行？我的意思是，我不需要从收藏中安全地删除我的项目，然后在任务安全完成后重新添加它。我可以为任何想回答我的问题的人提供的唯一保证是，没有两个任务将使用“Cache.TreeNodeItemsCollection”中的同一个节点。

我还没有添加一些代码来启动任务，但是一旦我知道我当前的设置是否正常，就会添加这些代码？

# git - 将 git 代理重置为默认配置

> ID：11265463
> 
> 赞同：89
> 
> 时间：2012-06-29T16:21:21.990
> 
> 标签：git

我安装了 Socat 以通过 HTTP CONNECT 代理使用 Git 协议，然后我`gitproxy`在你的 bin 目录中创建了一个脚本。

```
#!/bin/sh
# Use socat to proxy git through an HTTP CONNECT firewall.
# Useful if you are trying to clone git:// from inside a company.
# Requires that the proxy allows CONNECT to port 9418.
#
# Save this file as gitproxy somewhere in your path (e.g., ~/bin) and then run
# chmod +x gitproxy
# git config --global core.gitproxy gitproxy
#
# More details at https://www.emilsit.net/blog/archives/how-to-use-the-git-protocol-through-a-http-connect-proxy/

# Configuration. Common proxy ports are 3128, 8123, 8000.
_proxy=proxy.yourcompany.com
_proxyport=3128

exec socat STDIO PROXY:$_proxy:$1:$2,proxyport=$_proxyport 
```

然后我配置了 git 来使用它：

```
$ git config --global core.gitproxy gitproxy 
```

现在我想将 git 重置为默认代理配置，我该怎么做？

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2013-12-31T07:24:55.070

对我来说，我不得不补充：

```
git config --global --unset http.proxy 
```

基本上，您可以运行：

```
git config --global -l 
```

获取所有已定义代理的列表，然后使用“--unset”禁用它们

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2012-06-29T16:22:45.327

您可以使用以下方法删除该配置：

```
git config --global --unset core.gitproxy 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2014-09-10T10:25:08.217

编辑 .gitconfig 文件（可能在用户的主目录中~）并将 http 和 https 代理字段更改为仅空格

```
[http]
    proxy = 
[https]
    proxy = 
```

这在窗户上对我有用。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-04-20T06:43:18.833

**在我的 Linux 机器上：**

```
git config --system --get https.proxy (returns nothing)
git config --global --get https.proxy (returns nothing)

git config --system --get http.proxy (returns nothing)
git config --global --get http.proxy (returns nothing) 
```

我发现我的 https_proxy 和 http_proxy 已设置，所以我只是取消了它们。

```
unset https_proxy
unset http_proxy 
```

**在我的 Windows 机器上：**

```
set https_proxy=""
set http_proxy="" 
```

可选择使用[setx](https://ss64.com/nt/setx.html)在 Windows 上永久设置环境变量，并使用“/m”设置系统环境

```
setx https_proxy=""
setx http_proxy="" 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-04-25T18:05:31.737

使用命令删除 http 和 https 设置。

`git config --global --unset http.proxy`

`git config --global --unset https.proxy`

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-08-09T01:45:28.623

```
git config --global --unset http.proxy 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-10T10:33:40.390

如果您使用 Powershell 命令在 Windows 机器上设置代理，则执行以下操作对我有帮助。

要**取消设置**代理使用： 1\. 打开 powershell 2\. 输入以下内容：

```
[Environment]::SetEnvironmentVariable(“HTTP_PROXY”, $null, [EnvironmentVariableTarget]::Machine)
[Environment]::SetEnvironmentVariable(“HTTPS_PROXY”, $null, [EnvironmentVariableTarget]::Machine) 
```

要再次**设置**代理，请使用： 1\. 打开 powershell 2\. 输入以下内容：

```
[Environment]::SetEnvironmentVariable(“HTTP_PROXY”, “http://yourproxy.com:yourportnumber”, [EnvironmentVariableTarget]::Machine)
[Environment]::SetEnvironmentVariable(“HTTPS_PROXY”, “http://yourproxy.com:yourportnumber”, [EnvironmentVariableTarget]::Machine) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-08T09:43:27.503

如果运行

```
git config --global --unset http.proxy 
```

发出警告：

> http.proxy 有多个值

并且没有删除任何代理，然后在命令中添加“-all”：

```
git config --global --unset-all http.proxy 
```

成功删除所有代理。

您可以通过以下方式进行检查：

```
git config --global --list 
```

# java - 来自servlet但不是来自独立应用程序的“SocketException：来自服务器的文件意外结束”

> ID：11265464
> 
> 赞同：4
> 
> 时间：2012-06-29T16:21:35.043
> 
> 标签：java, servlets, httpurlconnection

我想从我的 servlet 调用一个 servlet。我可以从独立应用程序调用远程 servlet，但不能从我的 servlet 调用它（它在 Glassfish 上）。我使用完全相同的代码进行调用（我在最后一行代码中得到错误）：

```
URL serverAddress = new URL(endpoint);
//Set up the initial connection
HttpURLConnection connection = (HttpURLConnection) serverAddress.openConnection();
connection.setRequestMethod("POST");
connection.setDoOutput(true);
connection.setDoInput(true);
connection.setReadTimeout(timeOut);
connection.setRequestProperty("Content-Type", "text/xml; charset=ISO-8859-1");
connection.connect();
OutputStreamWriter wr = new OutputStreamWriter(connection.getOutputStream());
wr.write(requestBody);
wr.flush();
BufferedReader rd = new BufferedReader(new InputStreamReader(connection.getInputStream())); 
```

怀疑此代码无法读取远程 servlet 的响应，因此 servlet 可能根本没有回复。但是，为什么当我从独立应用程序调用它时它会回复？我真的不明白......我得到了这个例外：

```
java.net.SocketException: Unexpected end of file from server
    at sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:769)
    at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:632)
    at sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:766)
    at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:632)
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1049) 
```

有人知道吗？servlet 是否有可能限制不使用 HttpURLConnection？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T11:34:40.957

这可能是因为`Content-Length`未设置标头而发生的。并且因为没有发送 POST 请求正文的结束。服务器正在等待直到超时以结束流。

您应该尝试以下两件事以使其正常工作：

*   在执行之前使用请求正文大小设置内容长度标头`connect()`
*   尝试关闭`connection.getOutputStream().close()`发送 POST 请求结束的那个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T09:12:44.077

查看您正在点击的网址。我遇到了同样的问题，经过多次回归后才知道生成的 url 比被击中有一个空格，这是问题的原因，通过替换来解决它`space`你也可以通过调用记住`underscore`
它来将其编码为 url`URIEncoder.encode(uri);`只有在 is 之后的 uri 部分`?`应该被编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-16T15:43:51.550

在我们的例子中，它是 tomcat 设置为 http2 协议（默认情况下已删除强制使用 http2 协议， `<UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" />` 从`server.xml`tomcat`config`文件夹中删除，但客户端使用 http1.1，java 也需要使用证书（keyimport 工具）签名，所以根本问题是有点棘手……

# javascript - tinymce 只读时使用 chrome 自动调整大小

> ID：11265465
> 
> 赞同：1
> 
> 时间：2012-06-29T16:21:36.860
> 
> 标签：javascript, jquery, iframe, tinymce

大家好，我尝试了一整天，但我没有得到它。

我使用 tinymce 编辑器，它在所有浏览器中都可以正常工作，除了*** * chrome。我在只读模式下使用自动调整大小，我总是遇到问题，在 chrome 中，编辑器 iframe 很小，所以经常丢失文本。

我不是 jquery 或 javascript 破解，也没有找到解决方案。有一行设置样式`h.setStyle(h.get(a.id + "_ifr"), "height", k + "px");`，但是当我添加 +20 时，我遇到的问题是，在编辑器模式下，它总是在 keydown 时添加 20 px。所以不是解决方案。

通过css添加一些像素？但是我如何访问 iframe 元素？也许你们中的某个人知道我可以在这里做什么来添加额外的像素。

**编辑**

好的，似乎没有人有兴趣提供帮助，所以我使用了一种解决方法。在插件文件中，我执行以下操作，也许它可以帮助遇到同样问题的人：

```
if (tinymce.isWebKit && tinymce.activeEditor.settings.readonly == true) { 
```

然后你可以添加一些额外的像素，在我的例子中是 20px。也许有更好的解决方案，但它有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T07:07:22.003

我在使用 Chrome、tinyMCE 3.5.6 和 autoresize 插件时遇到了类似的问题。有帮助的是在[`init_instance_callback`](http://www.tinymce.com/wiki.php/Configuration%3ainit_instance_callback). 我现在在加载窗口时像这样调用 tinyMCE（jQuery 版本）：

```
$('.tinymce').tinymce({
  theme : 'advanced',
  plugins : 'autoresize',
  width: '100%',
  height: 400,
  autoresize_min_height: 400,
  autoresize_max_height: 800,
  init_instance_callback: function (inst) { inst.execCommand('mceAutoResize'); }
}); 
```

# javascript - 禁用标题单击 jQuery 选项卡

> ID：11265475
> 
> 赞同：0
> 
> 时间：2012-06-29T16:22:17.150
> 
> 标签：javascript, jquery, html, tabs, wizard

如何禁用 jQuery 选项卡的标题单击。

我只想从选项卡内的元素更改选项卡，构建一个作为向导工作的组件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:25:11.923

```
$(tab).click(function(){ 
return false;
}); 
```

将阻止该选项卡的默认操作

# c++ - 与嵌套 for 循环相比，C++ 2D 矩阵迭代器效率

> ID：11265477
> 
> 赞同：2
> 
> 时间：2012-06-29T16:22:19.863
> 
> 标签：c++, arrays, iterator, 2d

我有一个二维数组的行主迭代器，具有如下的 derefence 运算符：

```
int& Iterator::operator*(){ return matrix_[y_][x_]; }  //matrix_ has type int** 
```

（前缀）增量运算符如下：

```
Iterator& Iterator::operator++()
{
    if((++x_ == xs_) && (++y_ != ys_)) //ys_, xs_ are the dimensions of the matrix
        x_ = 0;
    return *this;   
} 
```

我可以将此迭代器与 std::transform 的优化版本一起使用（不返回不需要的结果，以节省一些指令）

```
template < class InputIterator, class OutputIterator, class UnaryOperator >
inline void MyTransform( InputIterator first1, InputIterator last1,
                         OutputIterator result, UnaryOperator op )
{
    for (; first1 != last1; ++first1, ++result)
        *result = op(*first1);
} 
```

这样称呼它：

```
MyTransform(matrix1.begin(),matrix1.end(),matrix2.begin(), MyFunctor()); 
```

但是，当我将性能与经典的嵌套 for 循环进行比较时：

```
MyFunctor() f;
for (int y=0; y<ySize; y++)
    for (int x=0; x<xSize; x++)
        matrix2.[y][x] = f(matrix1.[y][x]); 
```

基于迭代器的解决方案约为。比嵌套 for 循环解决方案慢 25%。MSVC 和英特尔 C++ 编译器都是这种情况（两者似乎都可以根据需要自动内联）。

现在问题似乎不在于迭代器增量运算符，就好像我做了以下（丑陋的）混合解决方案，结合了迭代器遍历和原始数组访问（后者使用迭代器的内部计数进行索引）：

```
MyFunctor f;
for (; mat1Begin != mat1End; ++mat1Begin, ++mat2Begin)
{ 
    //mat1 and mat2 are type int**
    mat2[mat2Begin.y_][mat2Begin.x_] = f(mat1[mat1Begin.y_][mat1Begin.x_]);
} 
```

它实际上比嵌套的 for 循环解决方案快一点。这向我表明，性能损失在于迭代器在执行分配时的取消引用。

我的问题是，为什么在分配中取消引用迭代器

```
*result = op(*first1); 
```

相对于原始数组访问，会造成如此巨大的性能损失？有没有什么技术可以用于这个简单的设计，以获得（几乎）与原始数组版本相当的性能？

为了响应这个社区的有用反馈，我修改了代码，以便缓存循环的外部计数器，因此代码现在如下所示：

```
int& Iterator::operator*()
{
    return column_[x_]; 
} 

Iterator& Iterator::operator++()
{
    if(++x_ == xs_)      //ys_, xs_ are the dimensions of the matrix
    {
        if(++y_ != ys_)
        { 
            x_ = 0;
            column_ = matrix_[y_];
        }
    }
    return *this;
} 
```

这将英特尔 C++ 编译器的性能提高到原始 2D 数组性能的 85%，对于 MSVC 编译器也类似（实际上，在 MSVC 上对 MyTransform 的调用速度较慢 - 生成了更多的汇编指令 - 但现在让我们忽略这一点，因为我我对循环/取消引用行为更感兴趣）。

当我将代码转换为使用指针算法（再次缓存列）时，性能明显比英特尔编译器上的原始二维数组（~70%）差，但在 MSVC 编译器下的原始二维数组又是~85%

```
int& Image32Iterator::operator*()
{
    return *ptr_;
} 

//prefix
Image32Iterator& Image32Iterator::operator++()
{
    if(++ptr_ == ptrEnd_)
    {
        if(++row_ != rowEnd_)
        { 
            ptrEnd_ = (ptr_ = *row_) + xs_;
        }
    }
    return *this;
} 
```

因此，我试图了解使用基于迭代器的解决方案是否可以达到 85% 的最大性能。我很惊讶指针算术解决方案的表现如此糟糕（当我试图使用指针算术来查看我是否可以得到 > 85% 时，我感到很困惑！）。

我将继续调查并更新发现，但欢迎任何见解......

...所以，关注为什么迭代器的指针算术版本对英特尔执行如此糟糕，而它对 MSVC 编译器执行良好的问题，我查看了程序集，问题似乎出在代码中为循环生成。对于所有其他函数（即，构造函数、迭代器和取消引用运算符、不等式运算符等，生成的代码对于 Intel 和 MSVC 几乎相同，如果有的话，对于 Intel 来说更简洁一些）。

这是 Intel 生成代码的汇编器，后面是 MSVC 生成代码的汇编器。我已从 for 循环更改为 while 循环，以使生成的汇编程序更易于阅读：

英特尔生成的代码：

```
while(begin != end)
01392D31  push        eax  
01392D32  lea         eax,[begin]  
01392D35  lea         edx,[end]  
01392D38  mov         dword ptr [esp],edx  
01392D3B  mov         ecx,eax  
01392D3D  call        ImageExperiments::Image32Iterator::operator!= (139103Ch)  
01392D42  mov         byte ptr [ebp-74h],al  
01392D45  movzx       eax,byte ptr [ebp-74h]  
01392D49  movzx       eax,al  
01392D4C  test        eax,eax  
01392D4E  je          ImageExperiments::greyscale_iterator2+0BCh (1392DACh)  
{
    *it8 = gsf(*begin);
01392D50  lea         eax,[begin]  
01392D53  mov         ecx,eax  
01392D55  call        ImageExperiments::Image32Iterator::operator* (13910A5h)  
01392D5A  mov         dword ptr [ebp-10h],eax  
01392D5D  push        eax  
01392D5E  lea         eax,[gsf]  
01392D61  mov         edx,dword ptr [ebp-10h]  
01392D64  mov         edx,dword ptr [edx]  
01392D66  mov         dword ptr [esp],edx  
01392D69  mov         ecx,eax  
01392D6B  call        ImageExperiments::GreyScaleFunctor::operator() (139101Eh)  
01392D70  mov         byte ptr [ebp-72h],al  
01392D73  movzx       eax,byte ptr [ebp-72h]  
01392D77  mov         byte ptr [ebp-71h],al  
01392D7A  lea         eax,[it8]  
01392D7D  mov         ecx,eax  
01392D7F  call        ImageExperiments::Image8Iterator::operator* (1391050h)  
01392D84  mov         dword ptr [ebp-0Ch],eax  
01392D87  mov         eax,dword ptr [ebp-0Ch]  
01392D8A  movzx       edx,byte ptr [ebp-71h]  
01392D8E  mov         byte ptr [eax],dl  
    ++begin; 
01392D90  lea         eax,[begin]  
01392D93  mov         ecx,eax  
01392D95  call        ImageExperiments::Image32Iterator::operator++ (1391028h)  
01392D9A  mov         dword ptr [ebp-8],eax  
    ++it8;
01392D9D  lea         eax,[it8]  
01392DA0  mov         ecx,eax  
01392DA2  call        ImageExperiments::Image8Iterator::operator++ (1391014h)  
01392DA7  mov         dword ptr [ebp-4],eax  
01392DAA  jmp         ImageExperiments::greyscale_iterator2+41h (1392D31h)  
}
}
00CA2DAC  leave  
00CA2DAD  ret 
```

MSVC 生成的代码：

```
while(begin != end)
010316E0  lea         eax,[end]  
010316E3  push        eax  
010316E4  lea         ecx,[begin]  
010316E7  call        ImageExperiments::Image32Iterator::operator!= (1031096h)  
010316EC  movzx       ecx,al  
010316EF  test        ecx,ecx  
010316F1  je          ImageExperiments::greyscale_iterator2+74h (1031724h)  
{
    *it8 = gsf(*begin);
010316F3  lea         ecx,[begin]  
010316F6  call        ImageExperiments::Image32Iterator::operator* (10311EAh)  
010316FB  mov         eax,dword ptr [eax]  
010316FD  push        eax  
010316FE  lea         ecx,[gsf]  
01031701  call        ImageExperiments::GreyScaleFunctor::operator() (1031032h)  
01031706  mov         bl,al  
01031708  lea         ecx,[it8]  
0103170B  call        ImageExperiments::Image8Iterator::operator* (1031118h)  
01031710  mov         byte ptr [eax],bl  
    ++begin; 
01031712  lea         ecx,[begin]  
01031715  call        ImageExperiments::Image32Iterator::operator++ (1031041h)  
    ++it8;
0103171A  lea         ecx,[it8]  
0103171D  call        ImageExperiments::Image8Iterator::operator++ (103101Eh)  
}
01031722  jmp         ImageExperiments::greyscale_iterator2+30h (10316E0h)  
}
01031724  pop         edi  
01031725  pop         esi  
01031726  pop         ebx  
01031727  mov         esp,ebp  
01031729  pop         ebp  
0103172A  ret 
```

所以它看起来像英特尔编译器生成大约。指令数量增加 50%。我尝试使用 __restrict 限定指针，看看这是否会对英特尔一代产生任何影响，但它没有。如果有人对为什么英特尔编译器的循环代码与 MSVC++ 编译器相比如此庞大/缓慢有任何建议，我会非常感兴趣！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:54:45.710

我已经尝试过重新创建您的代码，请参见[此处](http://ideone.com/bN6ln)。

在 g++ (4.6.3, -O3) 下运行它，我发现：

1) 非迭代器版本确实更快，但在我的情况下大约是 4 倍。 2) 迭代器版本，无论您是否遵循迭代器或提取它们的计数器并使用它们直接访问数组，是较慢（由上述因素）。

我已经捕获了这两个版本的汇编程序，并发现它们与版本 2 中与迭代器递增逻辑相关的大量代码完全不同。请注意，在这两种情况下，所有内容都是内联的。

**案例 1 内部循环，没有迭代器：**

```
.L18:
    xorl    %eax, %eax
    .p2align 4,,10
    .p2align 3
.L19:
    movq    24(%rsp), %rdx
    movq    40(%rsp), %rsi
    movq    (%rdx,%rcx), %rdx
    movq    (%rsi,%rcx), %rsi
    movl    (%rdx,%rax), %edx
    imull   %edx, %edx
    movl    %edx, (%rsi,%rax)
    addq    $4, %rax
    cmpq    $20000, %rax
    jne .L19
    addq    $8, %rcx
    cmpq    $40000, %rcx
    jne .L18
    movl    $.LC2, %esi
    movl    std::cout, %edi 
```

**案例 2 内循环，迭代器：**

```
.L34:
    movl    %eax, 56(%rsp)
    movl    %ecx, 60(%rsp)
    movl    %edi, 72(%rsp)
    movl    %edi, 76(%rsp)
    movq    72(%rsp), %rdi
    cmpq    %rdi, 56(%rsp)
    je  .L36
    movq    24(%rsp), %rdi
    movslq  %eax, %r10
    movslq  %ecx, %r9
    movslq  %edx, %r11
    addl    $1, %eax
    movq    (%rdi,%r10,8), %rdi
    movslq  %esi, %r10
    movl    (%rdi,%r9,4), %edi
    movq    40(%rsp), %r9
    imull   %edi, %edi
    movq    (%r9,%r11,8), %r9
    movl    %edi, (%r9,%r10,4)
    movl    16(%rsp), %edi
    cmpl    %edi, %eax
    je  .L37
.L20:
    addl    $1, %edx
    cmpl    32(%rsp), %edx
    jne .L34
    addl    $1, %esi
    cmpl    %esi, %edx
    cmovne  %r8d, %edx
    jmp .L34
.L37:
    addl    $1, %ecx
    cmpl    %ecx, %eax
    cmovne  %r8d, %eax
    jmp .L20
.L36: 
```

最终，如果您喜欢迭代器模式，我认为最好的建议是将矩阵内部数组重新定义为`int*`，从而允许迭代器成为指针周围的简单包装器。这显然是以牺牲矩阵的随机访问索引为代价的，该索引需要处理计算到`int`给定数组`x`的一维偏移量`y`和行宽（尽管几乎不是火箭科学！）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:25:04.283

我认为你的迭代器太大了。当您调用`operator*()`最坏的情况时，您的编译器需要获取`y_`并且`x_`在它可以获取`matrix_`at的值之前`x_`，`y_`。如果可能，我会尝试使用原始指针作为迭代器。这意味着何时`matrix_`定义为`int matrix_[N][M]`您可以`&matrix_[0][0]`用作开始和`&matrix_[N-1][M]`结束进行迭代。当然，总是有`valarray`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:38:38.230

1\. 内存本地化。保证连续。我注意到您澄清了变量 mat1 和 mat2 是 int**。但是 matrix_ 在内存中是如何处理的。Interators 只是指向任何可以想象的地方。您对 matrix_ 的记忆是否已本地化？基于堆的多维数组可能不连续。但是 Vector<> 是。

这行代码没有使用实际的交互器，而是使用它们的变量来索引一个本地化的数组。

```
mat2[mat2Begin.y_][mat2Begin.x_] = f(mat1[mat1Begin.y_][mat1Begin.x_]); 
```

2\. 你忘记了优化。在使用递增运算符的第二种用法中，您在调用函子之前执行该步骤。

这可能意味着调用函子传递一个通过运算符取消引用的对象会干扰优化器确定优先顺序的能力。

在调用 op() 之前尝试存储取消引用的对象，看看这是否消除了成本。

```
for (; first1 != last1; ++first1, ++result)
{
    InputIterator::value_type val = *first1;
    *result = op(val);
} 
```

在参数赋值中使用运算符时，我看到了一些时髦的东西。甚至延迟到调用之后才解析（发送表达式的其他解释，并在调用之后解析表达式），并且不保证参数解析顺序。如果您有效率问题，最好通过参数发送实际的预期对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T17:05:03.087

您正在将`matrix_[y_][x_]`函数调用中的双重间接提升到循环中。可能编译器正在设法`matrix_[y_]`在一种情况下缓存指针，而不是在另一种情况下；您可以尝试`matrix_[y_]`在迭代器中缓存吗？

# ruby-on-rails - Rails - 'will_paginate' 插件如何工作？

> ID：11265479
> 
> 赞同：0
> 
> 时间：2012-06-29T16:22:25.607
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

[Will_paginate](https://github.com/mislav/will_paginate/wiki/%20%22Will_paginate)插件允许对任何 ActiveRecord 进行分页。

实际上，`paginate`此 ActiveRecord 中提供了一个方法。例如，如果我想分页`Order`，我会这样做：

```
Order.paginate page:params[:page], order: 'created_at desc' 
```

方法是如何`paginate`创建的？这是[Will_paginate](https://github.com/mislav/will_paginate/wiki/%20%22Will_paginate)插件，它执行某种操作：“采用 ActiveRecord 定义并将`paginate`方法注入其中？

此外，为了保持这个例子，如果上述假设是正确的：

`Order`如果出于某种原因定义了具有完全不同目的的适当分页，如何避免与插件发生冲突？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:43:47.093

will_paginate 使用 extend 方法将模块添加到 ActiveRecord::Base 类。见[https://github.com/mislav/will_paginate/blob/master/lib/will_paginate/active_record.rb#L202](https://github.com/mislav/will_paginate/blob/master/lib/will_paginate/active_record.rb#L202)

如果 Order 还有一个名为 paginate 的方法，那么它将覆盖 ActiveRecord::Base#paginate 方法。

# android - 如何在android中捕获设备后退按钮事件？

> ID：11265490
> 
> 赞同：5
> 
> 时间：2012-06-29T16:23:04.410
> 
> 标签：android

我通过我的应用程序打开了 pdf 文件。当单击设备后退按钮时，它会自动返回到我的应用程序。它工作正常。这里我想在设备中捕获后退按钮事件。我覆盖后退按钮。但它不起作用。请帮我。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T16:30:19.673

这是您要问的一个示例：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_BACK ) {
        //do your stuff
    }
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T17:14:33.250

只需调用愚蠢的函数，这将关闭当前活动并将您移动到上一个屏幕

```
finish(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:28:13.747

您将覆盖 Activity 类中的[onKeyDown](http://developer.android.com/reference/android/app/Activity.html#onKeyDown%28int,%20android.view.KeyEvent%29)事件并查找[KEYCODE_BACK](http://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_BACK)的 keyCode 。为了防止进一步传播，您将返回`true`以阻止系统处理它，这应该阻止后退按钮将您的用户带出您所在的任何地方。

但是，这违反了用户期望发生的事情的规则，并且不建议这样做，除非您覆盖返回按钮以返回 WebView 中的页面或类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-21T11:49:31.517

```
public void onBackPressed() {

        Intent intent = new Intent(CurrentActivity.this,
                PreviousActivity.class);
        startActivity(intent);

            return;
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-09T12:27:03.440

如果您在应用程序中处理了与 pdf 文件相关的操作（如阅读等），即在您的应用程序中有 Activity 或 Fragment 处理此 pdf 文件操作，那么您可以覆盖 onBackPressed() 方法以将您的逻辑放在那里。但是，如果您通过意图打开 pdf，即使用其他应用程序使用意图操作参数，那么您不能在应用程序中覆盖 onBackPressed() 或 onKeyDown() 事件。但是，您可以将您的逻辑放在您从中打开 pdf 文件的活动中覆盖 onActivityResult() 方法中。

# php - php：动态链接将内容附加到现有页面而不是打开新页面

> ID：11265496
> 
> 赞同：0
> 
> 时间：2012-06-29T16:23:23.537
> 
> 标签：php, html

我有一个动态链接，它根据发票 ID 获取发票详细信息。

```
<a href='<?php echo $_SERVER['PHP_SELF']; ?>/retrieve?class=InvoiceLineItems&amp;id=<?php echo $invoice['invoice_id']; ?>'><?php echo $invoice['invoice_number']; ?></a>&nbsp;<?php echo $invoice['customer_name'] ?>&nbsp;<?php echo $invoice['invoice_date'] ?> 
```

它调用这个函数

```
public function retrieve($class,
        $id = NULL)
{
    switch ($class) {
        case 'Invoice':
            $invoices = $this->invoice->getInvoices();
            include 'view/invoiceList.php';
            break;
        case 'InvoiceLineItems':
            $partnerInfo = $this->partnerInfo->getPartnerInfo($id);
            $invoiceLineItems = $this->invoiceLineItems->getInvoiceLineItems($id);
            include 'view/invoice.php';
            break;
    }
} 
```

但是，在现有页面的底部找到的 include 语句`case 'InvoiceLineItems:'`将内容附加`invoice.php`到现有页面的底部，而不是完全替换它。我尝试将目标添加到锚点，但没有奏效。如何获取打开新页面的链接？

**更新：**根据@sixeightzero 的建议，这里是调用retrieve();

```
 if (isset($_REQUEST['id'])) {

            //          A request ID value indicates arrival here through link.
            $this->retrieve('InvoiceLineItems',
                    $_REQUEST['id']);
        } 
```

另外，我尝试使用标头重定向。

```
ob_start();
header('Location: /view/invoice.php', 302);
ob_end_flush();
exit(); 
```

它重定向，但我无法访问我的数组变量

```
$invoiceLineItems = $this->invoiceLineItems->getInvoiceLineItems($id); 
```

所以，我得到像

`Notice: Undefined variable: partnerInfo in C:\xampp\htdocs\bp\view\invoice.php on line 25`

和

`Warning: Invalid argument supplied for foreach() in C:\xampp\htdocs\bp\view\invoice.php on line 25`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T18:29:50.063

为了**使链接以新鲜内容打开**，请执行以下操作：

> 1）***将javascript添加到页面***。在 Html Head 部分添加以下行：
> 
> ```
> <script type="text/javascript">
> function hideMainContentDiv(){
>  document.getElementById("mainContent").setAttribute("style", "display:none");
> }
> </script> 
> ```
> 
> 2）***将 onclick 属性添加到锚标记***为：
> 
> ```
> <a onclick="hideMainContentDiv()"> 
> ```
> 
> 3）现在，***将页面内容包含在***其中并将其 id="mainContent" 指定为：
> 
> ```
> <div id="mainContent"> <!-- All your content --> </div> 
> ```
> 
> 4）在页面末尾，当您包含您的内容时，***添加另一个 div 并将您的函数调用调用***为：
> 
> ```
> <div id="newContent">
> <?php retrieve($class,$id); ?>
> </div> 
> ```

**这将做**的是：

> *   当您单击该链接时，它将调用 javascript 并将您现有的所有页面内容隐藏在*id="mainContent"*的 div 中。
> *   当您的*函数retrieve()*将被调用时，它将包含“view/invoice.php”，它将显示您的新内容。
> *   您的*旧内容已被 javascript*调用隐藏。

*我希望这能解决您的疑问。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T15:46:33.177

答案原来是会话。

```
 case 'InvoiceLineItems':
            $partnerInfo = $this->partnerInfo->getPartnerInfo($id);
            $invoiceLineItems = $this->invoiceLineItems->getInvoiceLineItems($id);
            $_SESSION['partnerInfo'] = $partnerInfo;
            $_SESSION['invoiceLineItems'] = $invoiceLineItems;

            ob_start();
            header('Location: /view/invoice.php');
            ob_end_flush();
            exit();
            break; 
```

我将数组数据添加到控制器中的两个会话变量中。然后，在视图中，我将相应的变量名称 -`$partnerInfo`和`$invoiceLineItems`- 替换为会话等效项`$_SESSION['partnerInfo']`和`$_SESSION['invoiceLineItems']`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:26:38.693

放出口（）；在函数结束后停止执行代码。

或者最好还是使用 invoice.php 来显示发票而不是当前页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T16:56:00.227

> 1) 由于您使用的是**超级全局***$_SERVER['PHP_SELF']*，因此锚点将始终指向同一页面。
> 
> 2) 现在，我假设您在页面末尾调用**函数** *retrieve()*，然后在您点击链接后，将“view/invoice.php”附加到页面，因此您可以在结尾。

现在，您想**获取打开新页面的链接，有两种方法**：

> 1）您*将页面重定向到页面view/invoice.php*，然后 *调用函数retrieve并将target =“self”包含*在锚标记中。
> 
> 或者
> 
> 2）您*做您正在做的事情，但*在锚标记中包含 target="blank" 。

# python - 如何在 numpy 中对二维数组上的这个三重循环进行矢量化？

> ID：11265497
> 
> 赞同：7
> 
> 时间：2012-06-29T16:23:23.583
> 
> 标签：python, numpy, linear-algebra, vectorization

我可以消除此计算中的所有 Python 循环吗？

```
result[i,j,k] = (x[i] * y[j] * z[k]).sum() 
```

其中`x[i]`, `y[j]`,`z[k]`是长度向量`N`, `x`,具有长度为 , 的第一维`y`, st输出是形状并且每个元素是三重乘积的总和（元素方式）。`z``A``B``C``(A,B,C)`

我可以将其从 3 个循环减少到 1 个循环（下面的代码），但我一直试图消除最后一个循环。

如有必要，我可以制作`A=B=C`（通过少量填充）。

```
# Example with 3 loops, 2 loops, 1 loop (testing omitted)

N = 100 # more like 100k in real problem
A =   2 # more like 20 in real problem
B =   3 # more like 20 in real problem
C =   4 # more like 20 in real problem

import numpy
x = numpy.random.rand(A, N)
y = numpy.random.rand(B, N)
z = numpy.random.rand(C, N)

# outputs of each variant
result_slow = numpy.empty((A,B,C))
result_vec_C = numpy.empty((A,B,C))
result_vec_CB = numpy.empty((A,B,C))

# 3 nested loops
for i in range(A):
    for j in range(B):
        for k in range(C):
            result_slow[i,j,k] = (x[i] * y[j] * z[k]).sum()

# vectorize loop over C (2 nested loops)
for i in range(A):
    for j in range(B):
        result_vec_C[i,j,:] = (x[i] * y[j] * z).sum(axis=1)

# vectorize one C and B (one loop)
for i in range(A):
    result_vec_CB[i,:,:] = numpy.dot(x[i] * y, z.transpose())

numpy.testing.assert_almost_equal(result_slow, result_vec_C)
numpy.testing.assert_almost_equal(result_slow, result_vec_CB) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T16:34:55.767

如果您使用的是 numpy > 1.6，则有很棒的`np.einsum`功能：

```
np.einsum('im,jm,km->ijk',x,y,z) 
```

这相当于您的循环版本。我不确定一旦您在实际问题中达到阵列的大小，这将如何提高效率（当我移动到这些大小时，我的机器上实际上出现了段错误）。对于这类问题，我经常喜欢的另一种解决方案是使用 cython 重写方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-29T18:52:27.787

在您的情况下使用[`einsum`](https://stackoverflow.com/a/11265642/577088)很有意义；但是您可以很容易地手动完成此操作。诀窍是使数组可以相互广播。这意味着重新塑造它们，使每个阵列沿着自己的轴独立变化。然后将它们相乘，让`numpy`处理广播；然后沿最后一个（最右边的）轴求和。

```
>>> x = numpy.arange(2 * 4).reshape(2, 4)
>>> y = numpy.arange(3 * 4).reshape(3, 4)
>>> z = numpy.arange(4 * 4).reshape(4, 4)
>>> (x.reshape(2, 1, 1, 4) * 
...  y.reshape(1, 3, 1, 4) *
...  z.reshape(1, 1, 4, 4)).sum(axis=3)
array([[[  36,   92,  148,  204],
        [  92,  244,  396,  548],
        [ 148,  396,  644,  892]],

       [[  92,  244,  396,  548],
        [ 244,  748, 1252, 1756],
        [ 396, 1252, 2108, 2964]]]) 
```

您可以通过使用切片表示法、`newaxis`值（等于`None`，因此下面也可以使用`None`）以及`sum`接受负轴值的事实（`-1`表示最后一个，`-2`表示下一个-last，以此类推）。这样，您不必知道数组的原始形状；只要它们的最后一个轴兼容，这将一起广播前三个：

```
>>> (x[:, numpy.newaxis, numpy.newaxis, :] *
...  y[numpy.newaxis, :, numpy.newaxis, :] *
...  z[numpy.newaxis, numpy.newaxis, :, :]).sum(axis=-1)
array([[[  36,   92,  148,  204],
        [  92,  244,  396,  548],
        [ 148,  396,  644,  892]],

       [[  92,  244,  396,  548],
        [ 244,  748, 1252, 1756],
        [ 396, 1252, 2108, 2964]]]) 
```

# c++ - 将 TCHAR 数组中的数字存储到 VC++ 中的 INTEGER 变量中。（在 UNICODE 环境中）

> ID：11265498
> 
> 赞同：0
> 
> 时间：2012-06-29T16:23:24.257
> 
> 标签：c++, c, visual-c++, char, tchar

我在线程中问了一个与此非常相似的问题： [https ://stackoverflow.com/questions/11259474/store-the-numericals-in-char-array-into-an-integer-variable-in-vc](https://stackoverflow.com/questions/11259474/store-the-numericals-in-char-array-into-an-integer-variable-in-vc,)

WRT上面的线程，我的问题如下：：我在UNICODE环境中工作。所以 TCHAr 可能会被视为 wchar。

我的场景如下：（C++）

> 在**TCHAR** a[10] 中，数组 a[] 具有元素（数字），例如 '1'、'2'、'3' 等......
> 
> 说 a[0] = '1'; 一个[1](https://stackoverflow.com/questions/11259474/store-the-numericals-in-char-array-into-an-integer-variable-in-vc,) = '2'; a[2] = '3';
> 
> 现在 a[] 存储 3 个字符“1”、“2”和“3”。我想将其存储为 123（整数 123）的 int。
> 
> 如何在 C++ 中实现这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:29:38.663

首先，您必须以空值终止您的字符串。否则，你怎么知道在哪里停下来？然后有一个`_ttoi()`专门用于此的功能。

```
a[3] = 0;
int n = _ttoi[a]; 
```

您必须了解空终止位。根据您如何填充`a`字符（数字），确定字符串结尾的逻辑可能会有所不同。

# php - 过滤 includes_url() PHP 函数（更改 wp-includes URL）

> ID：11265501
> 
> 赞同：0
> 
> 时间：2012-06-29T16:23:37.267
> 
> 标签：php, wordpress

[`includes_url()`](http://queryposts.com/function/includes_url/)是一个在 WordPress 中检索包含目录的 url 的函数，默认情况下其输出看起来像`http://example.com/wp-includes/`.

该函数的[核心代码](https://github.com/WordPress/WordPress/blob/3.4/wp-includes/link-template.php#L1993)：

```
function includes_url($path = '') {
    $url = site_url() . '/' . WPINC . '/';

    if ( !empty($path) && is_string($path) && strpos($path, '..') === false )
        $url .= ltrim($path, '/');

    return apply_filters('includes_url', $url, $path);
} 
```

如何用我自己的函数替换它（使用functions.php）？本质上，我想将第二行更改为 -`$url = 'http://static-content.com/' . WPINC . '/';`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T17:36:03.477

您可以使用一个过滤器[`add_filter`](http://queryposts.com/function/add_filter/)来使现有函数返回*您*想要的内容：

```
$callback = function($url, $path) {
    $url = 'http://static-content.com/' . WPINC . '/';

    if ( !empty($path) && is_string($path) && strpos($path, '..') === false )
        $url .= ltrim($path, '/');

    return $url;
};

add_filter('includes_url', $callback, 10, 2); 
```

*编辑：* PHP 5.2 版本：

```
function includes_url_static($url, $path) {
    $url = 'http://static-content.com/' . WPINC . '/';

    if ( !empty($path) && is_string($path) && strpos($path, '..') === false )
        $url .= ltrim($path, '/');

    return $url;
}

$callback = 'includes_url_static';

add_filter('includes_url', $callback, 10, 2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:31:31.300

一种选择是创建您自己的函数并让它调用`includes_url()`和更改它。

```
function custom_includes_url($path = '') {
  $url = includes_url($path);

  return str_replace(site_url(), 'http://static-content.com', $url);
} 
```

但是你必须在`custom_includes_url()`任何地方调用。

# objective-c - 如何获得 ivar 的 Objective-C 类？

> ID：11265503
> 
> 赞同：5
> 
> 时间：2012-06-29T16:23:44.923
> 
> 标签：objective-c, c, objective-c-runtime

`NSManagedObject`我在单元测试中创建了一堆简单的 s。它们只有一个`name`type 属性`NSString *`。我总是给我`NSManagedObject`相同的`entityName`名字`Class`。

我想避免编写以下代码 30 次来设置单元测试：

```
@interface FooTest : GHTestCase {
Foo *foo;
}
@end
@implementation FooTest

- (void) setUp {
  [super setUp];

  foo = [NSEntityDescription insertNewObjectForEntityForName:@"Foo"
                                      inManagedObjectContext:managedObjectContext];
  foo.name = @"foo";
}
@end 
```

由于`foo`是 ivar，我认为我应该能够编写一个宏来获取`foo`( `Foo`) 的类型，并使用它来创建我的`Foo`：

```
#define InsertManagedObjectByVariable(variable) \
do { \
variable = [NSEntityDescription insertNewObjectForEntityName:NSStringFromClass([typeof(variable) class])]; \
variable.name = (NSString *) CFSTR(#variable);
} while(0) 
```

但是，这会在 clang 中导致以下警告：

```
variable = [NSEntityDescription insertNewObjectForEntityName:NSStringFromClass([typeof(variable) class])];
                                                                               ^
                                                             Expected expression 
```

我还认为我可以尝试使用来自 的objective-c 运行时来确定类型，但是`IVar`来自类型编码`Ivar class_getInstanceVariable(Class cls, const char* name)`的唯一`IVar`类型信息`ivar_getTypeEncoding`是`id`，这还不够。

`IVar`有人能想出一种在编译时或运行时获取类型信息的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T20:52:25.060

我没有尝试从 ivar 获取类信息，但我知道`@property`声明确实编码了关于类的信息。例如，这个属性声明：

```
@property (copy) NSString *normalString; 
```

在运行时生成此属性字符串（使用[property_getAttributes()](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)检索）：

```
T@"NSString",C,VnormalString 
```

我已经为此信息编写[了一些开源解析代码。](https://github.com/jspahrsummers/libextobjc/blob/master/extobjc/EXTRuntimeExtensions.m#L461)

获得类名后，您可以使用[NSClassFromString()](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/doc/uid/20000055-BCIJDAJA)将其转换为实际的 Class 对象，并从那里发送结果消息。

**免责声明：**这可能不应该依赖于生产应用程序，因为它没有记录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T17:34:03.843

一个`id`是一个`id`。在运行时，所有 Objective-C 对象都具有相同的类型 ( `objc_object`)。这与 ObjC 的动态特性有关。例如，对象可以在运行时更改类，可以创建新类，并且可以更改类层次结构。您可以询问特定实例它的类型是什么（因为它存储在 中`objc_object`），但指向对象的指针只是指向对象的指针。甚至更少：它实际上只是一个指向 C 结构的指针，该结构恰好在最后分配了额外的内存（以保存子类 ivars）。

您的宏看起来很有趣，但您可能需要将类名作为第二个参数传递，而不是自动检测它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T17:22:35.907

也许我误解了你想要达到的目标。要获取iVar的类，不能使用iVar的*类*方法吗？

喜欢：

```
NSString *aString = @"random string";
NSLog(@"%@",NSStringFromClass([aString class])); 
```

# javascript - javascript - 需要从字符串中提取数据

> ID：11265507
> 
> 赞同：0
> 
> 时间：2012-06-29T16:24:02.997
> 
> 标签：javascript, jquery, ajax, string

嗨，我有一个基于数据表的表来保存数据。我需要能够从以下字符串中获取值，到目前为止我已经能够做到这一点。

```
<input name="jobNo" value="job_no_123" />job_no_123 
```

我需要能够获取名称和值并将其存储到单独的变量中，然后我将其传递给其他事情。

但是，我还需要在页面上捕获另外 4 个字段：

```
<input name="item_1" value="data1" />data1
<input name="item_2" value="data2" />data2
<input name="item_3" value="data3" />data3
<input name="item_4" value="data4" />data4 
```

最重要的是，这只是来自一行的数据，我也需要对多行执行此操作。但我需要从某个地方开始。

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:28:00.990

我不确定您的需求是什么，但这里有一个应该有帮助的代码

```
$('input').each(function(i, val){
    $(this).attr('name'); // will get the attribute name
    $(this).attr('value'); // will get the attribute value
    $(this).attr('text');  // will get the text inside the input
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:30:43.353

此正则表达式可以从您的代码中找到值。但是，它假定输入严格采用该格式，即使空白也没有变化。

```
<input name="(.*)" value="(.*)" /> 
```

这些值将位于捕获的组 1 和 2 中。

注意：我知道不应该使用正则表达式来解析 HTML，但如果输入足够严格，它就可以工作。

# php - 多个 While 循环将第一个数据替换为第二个数据

> ID：11265508
> 
> 赞同：0
> 
> 时间：2012-06-29T16:24:12.477
> 
> 标签：php, mysql

我下面的代码有问题..

我想显示与我的 $jid 的 ID 无关的数据，但我认为我的循环有问题。显示的第一个数据被删除并替换为最后一个结果......

继承人的代码。有人可以帮我解决这个问题吗

$check_exist_query = mysql_query("SELECT * FROM physical_abilities_assignment where job_title_id = $jid");

```
while($check_exist_row = mysql_fetch_array($check_exist_query)){
$list = "";
 $physical_title_id = $check_exist_row['2'];

if(empty($physical_title_id)){

    $display_abilities_query = "SELECT * FROM physical_abilities";
}else{

    $display_abilities_query = "SELECT * FROM physical_abilities WHERE id != $physical_title_id";
}

$display_abilities_result = mysql_query($display_abilities_query);

while($display_abilities_row = mysql_fetch_array($display_abilities_result)){

$abilities_name = $display_abilities_row[2];
  $abilities_id = $display_abilities_row[0];

$list .= "<tr>
                    <td $bgcolor align=center><input type=\"checkbox\" ".$check." name=\"job_title[]\" value=".$title_id." id=\"".$title_id."\"></td>
                    <td $bgcolor style=\"padding-left:5px;\">".$abilities_name."</td>
                    <td $bgcolor align=center><a onClick=\"return confirm('Are you sure you want to delete this entry?');\" href=?do=delete&id=". $row[0] ."><img src=\"images/delete-icon.png\" border=0 ></a>&nbsp;&nbsp;&nbsp;<a href=\"physical-abilities.php?id=$row[0]\"><img src=\"images/edit-icon.png\" title=\"Edit This\" border=0/></a></td>
       </tr>"; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:36:37.240

```
$list = "";
$check_exist_query = mysql_query("SELECT * FROM physical_abilities_assignment where job_title_id = $jid");

while($check_exist_row = mysql_fetch_array($check_exist_query)){

 $physical_title_id = $check_exist_row['2'];

if(empty($physical_title_id)){

    $display_abilities_query = "SELECT * FROM physical_abilities";
}else{

    $display_abilities_query = "SELECT * FROM physical_abilities WHERE id != $physical_title_id";
}

$display_abilities_result = mysql_query($display_abilities_query);

while($display_abilities_row = mysql_fetch_array($display_abilities_result)){

$abilities_name = $display_abilities_row[2];
  $abilities_id = $display_abilities_row[0];

$list .= "<tr>
                    <td $bgcolor align=center><input type=\"checkbox\" ".$check." name=\"job_title[]\" value=".$title_id." id=\"".$title_id."\"></td>
                    <td $bgcolor style=\"padding-left:5px;\">".$abilities_name."</td>
                    <td $bgcolor align=center><a onClick=\"return confirm('Are you sure you want to delete this entry?');\" href=?do=delete&id=". $row[0] ."><img src=\"images/delete-icon.png\" border=0 ></a>&nbsp;&nbsp;&nbsp;<a href=\"physical-abilities.php?id=$row[0]\"><img src=\"images/edit-icon.png\" title=\"Edit This\" border=0/></a></td>
       </tr>";
}

echo $list; 
```

尝试这个。

# javascript - 如何使用javascript检查facebook粉丝页面是否存在？

> ID：11265509
> 
> 赞同：2
> 
> 时间：2012-06-29T16:24:17.993
> 
> 标签：javascript, facebook, sdk

在我的应用程序中，我有一个 facebook 字段，可以引用 facebook 用户或 facebook 用户粉丝专页。

仅当 Facebook 中存在粉丝页面时，我才想像框一样呈现 facebook 粉丝页面。有没有办法用 Javascript SDK 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:36:23.757

如果您使用 jQuery 并且可以找出这些页面的 URL 模式，则可以使用 jQuery.get 来检查它们是否存在。如果你不使用 jQuery，你可以用原始的 XmlHttpRequests 做同样的事情。

例如，如果 URL 是“www.facebook.com/fanpage/{{username}}”，你可以这样做：

```
function startCheckForFanPage(username) {
    $.get("www.facebook.com/fanpage/" + username, function(response) {
        // if response.showsThere'sAPageThere, do X
        // otherwise, do Y
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T22:59:48.347

如果您使用[Facebook JS SDK](http://developers.facebook.com/docs/reference/javascript/)，您可以在初始化 FB 对象后执行此操作

```
 FB.api('/the_fanpage_path', function(response) {
      if(response.is_published) {
        // it is a Fan Page!
      }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-24T07:15:36.447

如果您不想加载 FB SDK，可以向例如执行 AJAX 获取请求。[http://graph.facebook.com/facebook](http://graph.facebook.com/facebook)。这适用于跨域策略，因为 graph.facebook.com 允许不同的域。

响应是 JSON 格式，所以这样的东西可以工作：

```
function startCheckForFanPage(username) {
    $.get("graph.facebook.com/" + username, function(response) {
        if (response)
        // otherwise, do Y
    }, function() {
        // Handle 404 or other failures here
    })
} 
```

编辑：这不再有效

# sql - SAS EG：如何创建包含过滤器的连接？

> ID：11265511
> 
> 赞同：1
> 
> 时间：2012-06-29T16:24:26.003
> 
> 标签：sql, sas, enterprise-guide

[此问题说明](http://support.sas.com/kb/20/442.html)描述了 EG 4.1 中的一种情况，其中您使用包含过滤器的外连接（即谓词位于 ON 子句而不是 WHERE 子句中）。但是，您实际上如何告诉 Enterprise Guide 的查询构建器在连接中包含过滤器？问题说明说这在 4.2 中已修复，所以他们是否更改了用户界面，或者在 4.1 中是否已经有执行此操作的选项，但该选项不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T08:21:33.820

是的，用户界面已更改。在 SAS EG 4.3（也可能在 EG 4.2 中）中，加入属性窗口添加了输入“过滤器以包含在 'join tables on' 子句中”的可能性。您在此处输入的内容不会出现在 WHERE 子句中，而是会添加到 ON 子句中。例如，以下代码中的“your_additional_filters”：

```
...
FROM table1 t1 LEFT JOIN table2 t2 ON (t1.key = t2.key AND (your_additional_filters) )
WHERE some other conditions 
```

# django - pycharm - 如何使用 add_to_builtins“运行”一个项目？

> ID：11265513
> 
> 赞同：0
> 
> 时间：2012-06-29T16:24:38.277
> 
> 标签：django, pycharm

我正在将 pycharm 与 django 一起使用。当我执行 runserver 命令时，我的项目启动并且一切正常。

如果我使用 pycharm 运行命令 - 顶部的绿色箭头 - 那么我会遇到问题。

问题是：

> ```
> runnerw.exe C:\development\python\python.exe manage.py runserver 127.0.0.1:8000 
> ```
> 
> 回溯（最近一次通话最后）：
> 
> 导入设置中的文件“manage.py”，第 11 行
> 
> 文件“C:\development\PycharmProjects\dumpstown\settings.py”，第 185 行，在 add_to_builtins('gravatar.templatetags.gravatar')
> 
> 文件“C:\development\python\lib\site-packages\django\template\base.py”，第 1017 行，在 add_to_builtins builtins.append(import_library(module))
> 
> 文件“C:\development\python\lib\site-packages\django\template\base.py”，第 963 行，在 import_library
> 
> ```
> raise InvalidTemplateLibrary("ImportError raised loading %s: %s" % (taglib_module, e)) 
> ```
> 
> django.template.base.InvalidTemplateLibrary：ImportError 引发加载
> 
> gravatar.templatetags.gravatar：无法导入设置，因为环境变量 DJANGO_SETTINGS_MODULE 未定义。
> 
> 进程以退出代码 1 结束

并且源于我在这里使用 add_to_builtins ：（这是在 settings.py 文件中）

```
#gravatar stuff here.
add_to_builtins('gravatar.templatetags.gravatar') 
```

我知道这是问题所在，因为如果我在 settings.py 文件中删除这一行？一切正常。

有没有办法为pycharm解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:33:16.660

您需要在 Settings | 中设置您的 Django 设置模块。Django 支持 | 设置

[http://www.jetbrains.com/pycharm/webhelp/django-support.html](http://www.jetbrains.com/pycharm/webhelp/django-support.html)

*更新*

django-gravatar 的问题在于它的 templatetags import django.contrib.auth.models.User 依赖于设置模块，而设置模块由 DJANGO_SETTINGS_MODULE 环境变量加载到 Django 中，该环境变量由 manage.py 中的 execute_manager 函数调用在内部设置，这是在导入设置**后执行的。**因此，当您在 settings.py 中使用未记录的 add_to_builtins 功能时，您没有设置 DJANGO_SETTINGS_MODULE 环境变量。所以这不是 PyCharm 的问题，而是未设置环境变量和使用未记录的 Django 功能 add_to_builtin 的问题。

当我从 Unix 控制台运行相同的项目时，我得到了同样的错误。

如果它从控制台工作，可能你在你的环境中设置了 DJANGO_SETTINGS_MODULE。因此，要使其在 PyCharm 中工作，您需要在 Django 运行配置中设置变量。您可以[在此处](http://www.jetbrains.com/pycharm/webhelp/run-debug-configuration-django-server.html)阅读相关内容（请参阅环境变量部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T19:00:30.050

正如我在这里回答的那样：[https ://stackoverflow.com/a/11299516/1061426](https://stackoverflow.com/a/11299516/1061426)

pycharm 已损坏，不适用于 add_to_builtins。两个明显的解决方案是：

1.  不要使用 pycharm，使用一些免费的 django 插件进行 eclipse，或者老式的文本编辑？

2.  使用 pycharm，只是不要使用 add_to_builtins。这是我走的路线 - 修复所有模板以导入模块很烦人，但在我的情况下，它比移植到新 IDE 的麻烦要简单得多。

# jquery - 为什么动态创建的 ul 不呈现任何 HTML？

> ID：11265514
> 
> 赞同：0
> 
> 时间：2012-06-29T16:24:41.447
> 
> 标签：jquery

为什么，无论我使用以下哪一个来创建新`<ul>`元素，HTML 都是空的：

```
var complaintsList = $('<ul/>', { id : 'myId' }); 
```

或者

```
var complaintsList = $("<ul id='myId'></ul>");

alert($(complaintsList).html()); 
```

当我将`<li>`元素添加到列表并输出 HTML 时，仅`<li>`显示元素的 HTML。

有人可以解释我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:27:25.970

在控制台中：

```
var complaintsList = $('<ul/>', { id : 'myId' });

complaintsList
[
<ul id=​"myId">​&lt;/ul>​
]

complaintsList.html()
""

complaintsList.append("<li>")
[
<ul id=​"myId">​
<li>​&lt;/li>​
</ul>​
]

complaintsList.html()
"<li></li>" 
```

它按预期工作。的 html`ul`是空白的，因为其中没有任何内容。添加 后`li`，其中有一个列表项。

[`.html()`](http://api.jquery.com/html/)只为您提供元素**内容**的 HTML 。因此，当元素中没有任何内容时，HTML 将是一个空字符串。如果需要获取`outerHTML`元素的，可以使用[jQuery outerHTML 插件](http://darlesson.com/jquery/outerhtml/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:36:56.363

> 为什么，无论我使用以下哪个创建新元素，HTML 都是空的

因为该`html`方法返回 jQuery 对象中（第一个）元素内的元素的 HTML 代码。

> 有人可以解释我做错了什么吗？

您假设该`html`方法还包括 jQuery 对象中元素的 HTML 代码。

* * *

旁注：该变量`complaintsList`已经包含一个 jQuery 对象，因此您不必将其包装在另一个 jQuery 对象中即可在其上使用 jQuery 方法：

```
alert(complaintsList.html()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:32:49.847

[http://api.jquery.com/html/](http://api.jquery.com/html/)说：

> “获取匹配元素集中第一个元素的 HTML 内容。”

`.html()`只返回元素的内部内容，而不是元素本身。

参见`innerHTML`vs `outerHTML`，`.html()`类似于 `.innerHTML`属性。

# mysql - max_allowed_pa cket 的问题

> ID：11265515
> 
> 赞同：0
> 
> 时间：2012-06-29T16:24:43.393
> 
> 标签：mysql

我有一个使用 Drupal 7 的站点。最近它出现以下错误消息：

`PDOException: SQLSTATE[08S01]: Communication link failure: 1153 Got a packet bigger than 'max_allowed_packet'`

我们试图通过增加`max_allowed_packet`in mysql 来修复它。这解决了大部分问题，但我在某些页面上仍然遇到此错误。事情是只有在我登录时才会发生这种情况，匿名用户没有这样的问题。有时，即使是最简单的页面，例如“关于我们”页面，一个带有图片的简单基本页面，也会导致错误。有没有人知道发生了什么。我`max_allowed_packet`的已经增加到 64M 并且管理员犹豫要添加更多。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T08:07:57.870

1.  您是否有包含大量内容的页面，包括文档（我不确定这些是否存储在数据库中，但某些模块可能会这样做）。如果您不确定是否可以通过检查数据库中最大表的内容结构来找出答案，请查看每行大小最大的表（总大小/行数）。

2.  您可以使用此信息请求您的管理员进一步增加数据包大小，以便站点按照您的调查工作。

# python - Python 中 statsmodels 中的 ADF 测试

> ID：11265518
> 
> 赞同：5
> 
> 时间：2012-06-29T16:25:02.400
> 
> 标签：python, numpy, statistics, statsmodels

我正在尝试`statsmodels`在 Python 中运行 Augmented Dickey-Fuller 测试，但我似乎遗漏了一些东西。

这是我正在尝试的代码：

```
import numpy as np
import statsmodels.tsa.stattools as ts

x = np.array([1,2,3,4,3,4,2,3])
result = ts.adfuller(x) 
```

我收到以下错误：

```
Traceback (most recent call last):
  File "C:\Users\Akavall\Desktop\Python\Stats_models\stats_models_test.py", line 12, in <module>
    result = ts.adfuller(x)
  File "C:\Python27\lib\site-packages\statsmodels-0.4.1-py2.7-win32.egg\statsmodels\tsa\stattools.py", line 201, in adfuller
    xdall = lagmat(xdiff[:,None], maxlag, trim='both', original='in')
  File "C:\Python27\lib\site-packages\statsmodels-0.4.1-py2.7-win32.egg\statsmodels\tsa\tsatools.py", line 305, in lagmat
    raise ValueError("maxlag should be < nobs")
ValueError: maxlag should be < nobs 
```

我的 Numpy 版本：1.6.1 我的 statsmodels 版本：0.4.1 我正在使用 Windows。

我正在查看文档[here，](http://statsmodels.sourceforge.net/stable/generated/statsmodels.tsa.stattools.adfuller.html#statsmodels.tsa.stattools.adfuller)但无法弄清楚我做错了什么。我错过了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T19:51:12.580

我想到了。默认情况下`maxlag`设置为`None`，而应设置为整数。像这样的工作：

```
import numpy as np
import statsmodels.tsa.stattools as ts

x = np.array([1,2,3,4,3,4,2,3])
result = ts.adfuller(x, 1) # maxlag is now set to 1 
```

输出：

```
>>> result
(-2.6825663173365015, 0.077103947319183241, 0, 7, {'5%': -3.4775828571428571, '1%': -4.9386902332361515, '10%': -2.8438679591836733}, 15.971188911270618) 
```

# python - Google App Engine + PyCrypto = /dev/urandom 无法访问

> ID：11265520
> 
> 赞同：1
> 
> 时间：2012-06-29T16:25:06.247
> 
> 标签：python, linux, google-app-engine, random, pycrypto

我正在使用 Google App Engine 和 PyCrypto 进行一些加密。我得到的错误如下所示，仅发生在运行 Linux Mint Maya (13)*的本地开发服务器上。*我将相同的代码部署到 GAE 云中，它运行时没有错误。

```
ERROR    2012-06-29 16:04:20,717 webapp2.py:1553] [Errno 13] file not accessible: '/dev/urandom'
Traceback (most recent call last):
  File "/home/eric/google_appengine/lib/webapp2/webapp2.py", line 1536, in __call__
    rv = self.handle_exception(request, response, e)
  File "/home/eric/google_appengine/lib/webapp2/webapp2.py", line 1530, in __call__
    rv = self.router.dispatch(request, response)
  File "/home/eric/google_appengine/lib/webapp2/webapp2.py", line 1278, in default_dispatcher
    return route.handler_adapter(request, response)
  File "/home/eric/google_appengine/lib/webapp2/webapp2.py", line 1102, in __call__
    return handler.dispatch()
  File "/home/eric/google_appengine/lib/webapp2/webapp2.py", line 572, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "/home/eric/google_appengine/lib/webapp2/webapp2.py", line 570, in dispatch
    return method(*args, **kwargs)
  File "/home/eric/workspace/commentbox/src/controller/api.py", line 55, in get
    self.response.out.write(encrypt(json.dumps(to_json)))
  File "/home/eric/workspace/commentbox/src/controller/api.py", line 27, in encrypt
    iv = Random.new().read(AES.block_size)
  File "/usr/lib/python2.7/dist-packages/Crypto/Random/__init__.py", line 33, in new
    return _UserFriendlyRNG.new(*args, **kwargs)
  File "/usr/lib/python2.7/dist-packages/Crypto/Random/_UserFriendlyRNG.py", line 206, in new
    return RNGFile(_get_singleton())
  File "/usr/lib/python2.7/dist-packages/Crypto/Random/_UserFriendlyRNG.py", line 200, in _get_singleton
    _singleton = _LockingUserFriendlyRNG()
  File "/usr/lib/python2.7/dist-packages/Crypto/Random/_UserFriendlyRNG.py", line 144, in __init__
    _UserFriendlyRNG.__init__(self)
  File "/usr/lib/python2.7/dist-packages/Crypto/Random/_UserFriendlyRNG.py", line 86, in __init__
    self._ec = _EntropyCollector(self._fa)
  File "/usr/lib/python2.7/dist-packages/Crypto/Random/_UserFriendlyRNG.py", line 53, in __init__
    self._osrng = OSRNG.new()
  File "/usr/lib/python2.7/dist-packages/Crypto/Random/OSRNG/posix.py", line 60, in new
    return DevURandomRNG(*args, **kwargs)
  File "/usr/lib/python2.7/dist-packages/Crypto/Random/OSRNG/posix.py", line 42, in __init__
    f = open(self.name, "rb", 0)
  File "/home/eric/google_appengine/google/appengine/tools/dev_appserver_import_hook.py", line 592, in __init__
    raise IOError(errno.EACCES, 'file not accessible', filename)
IOError: [Errno 13] file not accessible: '/dev/urandom'
ERROR    2012-06-29 16:04:20,721 webapp2.py:1549] Exception 
ERROR    2012-06-29 16:04:20,721 webapp2.py:1549] AttributeError
ERROR    2012-06-29 16:04:20,721 webapp2.py:1549] : 
ERROR    2012-06-29 16:04:20,721 webapp2.py:1549] "'DevURandomRNG' object has no attribute 'closed'"
ERROR    2012-06-29 16:04:20,721 webapp2.py:1549]  in 
ERROR    2012-06-29 16:04:20,721 webapp2.py:1549] <bound method DevURandomRNG.__del__ of <Crypto.Random.OSRNG.posix.DevURandomRNG object at 0x52707d0>>
ERROR    2012-06-29 16:04:20,721 webapp2.py:1549]  ignored 
```

引发错误的 python 代码是此块中的第二行：

```
from Crypto.Cipher import AES
from Crypto import Random

key = b'Sixteen byte key' 
iv = Random.new().read(AES.block_size)
cipher = AES.new(key, AES.MODE_CBC, iv)
return iv + cipher.encrypt(plaintext) 
```

看到这个错误后，[我意识到这可能是一个权限错误](https://serverfault.com/questions/391386/why-is-dev-urandom-only-readable-by-root-since-ubuntu-12-04-and-how-can-i-fix)。于是我快速检查了 /dev/urandom 的权限：

```
eric@eric-Latitude-E5400 ~ $ dpkg -L udev | xargs grep urandom
/lib/udev/rules.d/50-udev-default.rules:KERNEL=="null|zero|full|random|urandom", MODE="0666"
eric@eric-Latitude-E5400 ~ $ ls -lart /dev/*random
crw-rw-rw- 1 root root 1, 9 Jun 29 10:53 /dev/urandom
crw-rw-rw- 1 root root 1, 8 Jun 29 10:53 /dev/random 
```

所以看起来我的权限很好。我也尝试过以 root 身份运行开发服务器，但我得到了同样的错误。由于某种原因，这只发生在开发服务器上，而不是部署到谷歌的云上。关于下一步尝试什么的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:18:54.407

您收到的错误是因为 GAE 限制文件访问，并且[/dev/urandom](http://en.wikipedia.org/wiki//dev/random#Linux)被阻止。

请注意，错误不是在您导入 PyCrypto 时，而是在您执行时`AES.new(key, AES.MODE_CBC, iv)`

您可以通过编辑`Crypto/Random/OSRNG/__init__.py` 和移动线条来修复它

```
if hasattr(os, 'urandom'):
    from Crypto.Random.OSRNG.fallback import new 
```

到顶部，或者在脚本的开头将 os.name 修改为不同于 posix 或 nt 的名称。我建议第一个选项。

ps：由于您的 Traceback，我假设您使用的是 python 2.5 和 pycrypto 2.2。下次请包括这些细节。

# php - PHP中未定义的索引和MYSQL中的数据类型POINT

> ID：11265527
> 
> 赞同：3
> 
> 时间：2012-06-29T16:25:47.537
> 
> 标签：php, mysql

我是在 MYSQL 中使用数据类型 POINT 的新手，所以我想在 PHP 中测试一个表的输出，但我收到错误“未定义的索引”。如何修复此错误并显示表中的点？

***错误消息*** Notice: Undefined index: my_point in C:\xampp\htdocs\view.php 第 23 行

（这些点没有显示在表格中。我该如何解决这个问题？）

***MYSQL 表***

/*表的表结构`highcharts_php`*/

```
 CREATE TABLE `highcharts_php` (
              `id` int(11) NOT NULL AUTO_INCREMENT,
              `run_name` varchar(150) DEFAULT NULL,
              `my_point` POINT DEFAULT NULL,
              `cur_timestamp`  TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
               PRIMARY KEY (`id`)

            ) ENGINE=InnoDB AUTO_INCREMENT=24 DEFAULT CHARSET=latin1;
              SET time_zone='+00:00';
            /*Data for the table `highcharts_php` */

            insert into highcharts_php (`id`,`run_name`,`cur_timestamp`,`my_point`) values ( 1, 'SSTP Keystone COOPER','2012-06-28 00:00:01', GeomFromText( ' POINT(0.6 70.18) ' ) ) 
```

* ***PHP 代码****

```
 <?php
            $con = mysql_connect("localhost","root","xxxxxxxx");
            if (!$con)
              {
              die('Could not connect: ' . mysql_error());
              }

            mysql_select_db("graph", $con);
            /*$result = mysql_query("SELECT * FROM highcharts_php");*/
            $result = mysql_query("SELECT run_name,cur_timestamp, x( my_point ), y( my_point ) FROM highcharts_php LIMIT 0 , 30")or die 
            (mysql_error());
            echo "<table border='1'>
            <tr>
            <th>run_name</th>
            <th>my_point</th>
            <th>cur_timestamp</th>
            </tr>";

            while($row = mysql_fetch_array($result))
              {
              echo "<tr>";
              echo "<td>" . $row['run_name'] . "</td>";
              echo "<td>" . $row['my_point'] . "</td>";
              echo "<td>" . $row['cur_timestamp'] . "</td>";
              echo "</tr>";
              }
            echo "</table>";

            mysql_close($con);
            ?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:30:05.820

您需要两个计算列的列别名：

```
$result = mysql_query("
  SELECT 
    run_name,
    cur_timestamp,
    /* Column aliases via AS */
    x( my_point ) AS my_point_x, 
    y( my_point ) AS my_point_y 
  FROM highcharts_php LIMIT 0 , 30") or die(); 
```

以`$row['my_point_x'], $row['my_point_y']`.

如果没有列别名，它们就存在于您的`$row`as 中，与它们在您的列表中`$row['x( my_point )'], $row['y (my_point)']`出现的完全一样。`SELECT`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:30:03.343

别名来自`X()`和`Y()`使用 AS 的返回值，如下所示：

```
X( my_point ) AS x_value, Y( my_point ) AS y_value 
```

然后在 PHP 中访问它们：

```
$row['x_value']
$row['y_value'] 
```

否则，您必须使用以下命令访问该列：

```
$row['X( my_point )'] 
```

或类似的东西 - 请参阅文档中[的示例](http://dev.mysql.com/doc/refman/5.0/en/geometry-property-functions.html#function_x)以了解如何根据您的查询动态生成列名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T16:38:34.337

```
SELECT run_name,
cur_timestamp, 
CONCAT(x( my_point ), ' ', y( my_point )) as my_point 
FROM highcharts_php LIMIT 0 , 30 
```

# javascript - 只有在任何字段中输入 3 个字符后才开始搜索

> ID：11265529
> 
> 赞同：1
> 
> 时间：2012-06-29T16:25:56.217
> 
> 标签：javascript, jquery, spring, hibernate, jsp

我在我的应用程序中使用 Spring MVC、hibernate 和 JSP。目前我已经实现了搜索多个字段的功能，并使用 JavaScript 在 onKeyUp() 函数上调用了它。但是现在我希望它仅在任何字段中至少有 3 个字符时才执行搜索。例如，如果有 3 个字段，那么如果我在一个/两个字段中输入 1 或 2 个字符，在第三个字段中输入 3 个字符，那么它应该只在第三个字段的基础上调用搜索方法，它应该忽略来自其他字段的输入。实现这一目标的简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:45:09.107

如果我理解正确，您只想在多个字段之一包含 3 个或更多字符时执行搜索功能。

仅基于该假设并且没有其他详细信息，以下内容应该起作用：

```
$('.fields').each(function(k, v){
    var obj = $(this);

    obj.keyup(function(){
        if(obj.val().length >= 3){
            // Execute submission
            alert(obj.val());
        }
    });
}); 
```

工作示例：http: [//jsfiddle.net/FtE9H/](http://jsfiddle.net/FtE9H/)

上面的代码假定您已将一个类分配给`fields`应检查以执行搜索功能的所需字段。这可以修改为只查看特定的元素类型，但这取决于您的完整实现。

此外，您可以在成功匹配时清空其他字段以获取长度为 3 个或更多字符的值，以避免与最终用户产生任何可能的混淆。

# jquery - jQuery控制动画

> ID：11265530
> 
> 赞同：0
> 
> 时间：2012-06-29T16:26:00.240
> 
> 标签：jquery

大家好，我有以下代码，我希望它持续一段时间，然后“.cta”应该回到原来的位置。有任何想法吗？

```
$('.cta').delay(1000).animate ({left: '5'}, 800) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:29:07.263

```
setTimeout(function(){
        $('.cta').animate ({left: '5'}, 800,).delay(4000).animate ({left: '82'};
},1000); 
```

# hibernate - 如何使用 Hibernate Tools 从 POJO 创建表？

> ID：11265539
> 
> 赞同：1
> 
> 时间：2012-06-29T16:26:54.577
> 
> 标签：hibernate, hibernate-tools

我在搜索我想做的事情时遇到了一些麻烦。有人告诉我，我可以使用 Hibernate 生成代表我用 Java 创建的 POJO 的数据库表。我肯定错过了什么。感谢您对琐碎问题的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:27:19.150

在配置文件中添加此属性

```
<property name="hibernate.hbm2ddl.auto">create</property> 
```

# postgresql - 移动 postgresql 数据集群

> ID：11265540
> 
> 赞同：7
> 
> 时间：2012-06-29T16:27:01.710
> 
> 标签：postgresql, postgresql-9.1

我们的 postgres 数据文件夹安装在空间非常有限的驱动器上。我现在正试图将其移至新安装的驱动器（更多空间）。我关注了几篇博客文章，他们都说......

1.  停止服务
2.  复制数据集群
3.  更新 postgresql-9.1 文件 (PGDATA=)
4.  重启服务

服务启动，但是当我去连接时，它给了我“无法连接到服务器：连接被拒绝”

我尝试远程登录到端口 5432，但什么也没有。

这是我一直在尝试的链接： [http ://www-01.ibm.com/support/docview.wss?uid=swg21324272](http://www-01.ibm.com/support/docview.wss?uid=swg21324272)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T18:21:35.610

感谢大家的帮助。看起来问题出在许可上。

而不是做

```
cp -R fromfolder tofolder 
```

我做了

```
cp -a fromfolder tofolder 
```

这解决了它。谢谢大家。

# ruby-on-rails-3 - Rails 3 Uploadify + Paperclip 文件数据从不发送

> ID：11265544
> 
> 赞同：0
> 
> 时间：2012-06-29T16:27:38.273
> 
> 标签：ruby-on-rails-3, paperclip, uploadify

我正在使用带有 Paperclip 的 Rails 3.1，并尝试在单个页面上实现 Uploadify 以实现多个文件上传。我尝试了各种示例，包括：[Rails3-Paperclip-Uploadify](https://github.com/websymphony/Rails3-Paperclip-Uploadify)

目前我有一个 Upload 模型，它与我的 UploadImage 模型有一对多的关系 - 这是我到目前为止为我的视图设置的：

UploadImages/new.html.erb

```
<%= javascript_include_tag "http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js" %>
<%= javascript_include_tag "swfobject.js", "jquery.uploadify.v2.1.0.js" %>

<script type="text/javascript" charset="utf-8">
    <%- session_key = Rails.application.config.session_options[:key] -%> 
    $(document).ready(function() 
    {
        // Create an empty object to store our custom script data
        var uploadify_script_data = {};

        // Fetch the CSRF meta tag data
        var csrf_token = $('meta[name=csrf-token]').attr('content');
        var csrf_param = $('meta[name=csrf-param]').attr('content');

        // Now associate the data in the config, encoding the data safely
        uploadify_script_data[csrf_token] = encodeURI(encodeURI(csrf_param));

        $('.uploadify').uploadify
        ({
            uploader        :   '/uploadify/uploadify.swf',
            cancelImg       :   '/uploadify/cancel.png',
            multi           :   true,
            auto            :   false,
            onComplete      :   function(event, queueID, fileObj, response, data)
                                { 
                                    var dat = eval('(' + response + ')');
                                    $.getScript(dat.upload);
                                },
            scriptData      :   {
                                    '_http_accept': 'application/javascript',
                                    'format' : 'json',
                                    '_method': 'post',
                                    '<%= session_key %>' : encodeURIComponent('<%= u cookies[session_key] %>'),
                                    'authenticity_token': encodeURIComponent('<%= u form_authenticity_token %>'),
                                    'upload_id' : '<%= @upload.id %>'
                                }
        });         
    }); 

</script>

<%= form_for @upload.upload_images.build, :html => { :class => "upload", :multipart => true } do |f| %>  
                    <%= f.file_field :image, :class => "uploadify" %>
                    <%= submit_tag "Submit Upload", :disable_with => "Uploading", :class => "submit"%>
<% end %> 
```

我看到了 uploadify flash 按钮，我选择了一些文件并提交，但这就是我在参数中看到的全部内容：

> {"utf8"=>"✓", "authenticity_token"=>"K1bSH/FO0Hjdum0aiNU45mHJXezXTiCgh9XVmk1jrZM=", "commit"=>"提交上传", "action"=>"create", "controller"=>"upload_images"}

如您所见，没有发送文件数据，甚至我指定的 scriptData 也没有发送，我注意到其他人的代码使用**脚本**参数作为 uploadify 函数。在 PHP 框架中，他们将其指向处理保存的 .php 文件。我正在使用回形针，所以我不确定如何实现这个......也许这是我的问题？如果您需要任何其他详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:11:41.123

我通过查看这个问题找到了答案：[uploadify rails 3 none after the file is selected](https://stackoverflow.com/questions/7276315/uploadify-rails-3-0-nothing-happens-after-file-is-chosen?rq=1)

我必须将一些事件附加到我的提交按钮，并将脚本参数添加到uploadify 函数中，正如我所猜测的那样。

因此，对于我的 config/routes.rb 中的初学者，我需要添加：

```
post "upload_images/create" 
```

在我看来，我补充说：

```
$('#submit').click(function(event){
            event.preventDefault();
        });

$('#submit').click(function(event){
            event.preventDefault();
            $('.uploadify').uploadifyUpload();
}); 
```

最后我将脚本参数添加到我最初的 uploadify 函数调用中：

```
script          :   '/upload_images/create' 
```

经过几个小时的打击我的头终于开始工作并且有意义了！希望这对其他人有帮助。

# sql - 从.Net应用程序调用存储过程后如何检测触发器失败？

> ID：11265545
> 
> 赞同：5
> 
> 时间：2012-06-29T16:27:40.950
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures, triggers

我们有一个 .NET 应用程序 (VB / VS2010) 并在 SQL Server 2008 上调用许多存储过程以进行数据库查询。我们还有很多更新/插入/删除触发器，一旦这些存储过程修改了数据库表，它们就会自动执行。

在很多情况下调用存储过程并且它似乎执行正常，因为没有引发错误并且 .NET 应用程序照常继续。但是，如果我随后深入了解并通过 SQL Server 客户端手动执行存储过程调用，我会看到在存储过程失败后立即执行的触发器，从而回滚所有更改。

所以我的问题是：在我们的 .NET --> 存储过程 --> 触发场景中检测和传递错误的最佳方法是什么，以便在 .NET 应用程序中确定在发生错误时一切是否成功？

非常感谢，史蒂夫

* * *

更新：我现在在家，周末远离我的办公桌（和代码库），所以没有机会检查存储过程的细节。非常感谢到目前为止给出的答案。下周我可以再看一下代码。

但与此同时...

一个问题是关于 MS SQL Server 的版本：它是 2008 年。

据我所知，我们以这种方式调用存储过程（至少是那些不读取数据并且“只是”更新、删除或插入数据的过程）：

```
Using connection As New SqlConnection("connectionString")
    Dim command As New SqlCommand("EXEC STORED_PROCEDUR_ENAME), connection)
    command.Connection.Open()
    command.ExecuteNonQuery()
End Using 
```

我认为上面代码背后的假设是，如果存储过程或相关触发器中出现故障，那么

```
command.ExecuteNonQuery() 
```

然后会失败。这可能是我的第一个问题，即我是否必须更改此代码？下面的一个问题是我是否使用 ExecuteDataReader，所以答案是否定的，至少目前还没有……

我将在下面评论 SQL 特定的问题和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T03:54:21.930

我今天确实遇到了同样的问题，

为了解决它，我使用了一个输出@msg 并将其放在存储过程中的每个函数之后。

```
SET @msg = 'Test print 1' 
```

每个部分我都添加了一个，所以我知道打印的最后一个数字是 sproc 失败的地方。然后我走到触发器失败的表并对其进行调整，直到它打印出最后一个数字并通过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T18:11:21.857

您应该在每条语句后检查@@error，如果存在则返回错误。

这是一篇给你的好文章。查看“为什么我的错误未引发”部分。它描述了一个可能是您的问题的场景。

[http://www.sommarskog.se/error-handling-II.html](http://www.sommarskog.se/error-handling-II.html)

您可能还想尝试打开 XACT_ABORT，这样存储过程会因大多数错误而失败。

编辑：这是另一个可能有助于解释这一点的链接。

[http://www.novicksoftware.com/tipsandtricks/tips-erorr-handling-in-a-stored-procedure.htm](http://www.novicksoftware.com/tipsandtricks/tips-erorr-handling-in-a-stored-procedure.htm)

如果您检查@@error 并找到它！= 0，您可以从您的过程中返回错误，或者您可以使用 RAISERROR，这肯定会导致调用代码时出现异常。

[http://msdn.microsoft.com/en-us/library/ms178592.aspx](http://msdn.microsoft.com/en-us/library/ms178592.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T21:36:07.097

正如您提到的，您正在使用 sql server 2008。这提供了使用 try..catch 的能力。这是这篇文章。

[http://msdn.microsoft.com/en-us/library/ms175976.aspx](http://msdn.microsoft.com/en-us/library/ms175976.aspx)

也看看这个论坛。

[http://social.msdn.microsoft.com/Forums/eu/transactsql/thread/03eae70e-d478-44a7-90f3-8e1d27d9f22e](http://social.msdn.microsoft.com/Forums/eu/transactsql/thread/03eae70e-d478-44a7-90f3-8e1d27d9f22e)

我认为 try..catch 会完成这项工作。同样在.net 方面，我将使用以下代码。

```
try
{
   // your stored procedure execution code.
}
Catch (sqlexception e)
{
  // do something with sql exception.
} 
```

试试这个场景，看看是否能解决你的问题。

# sql-server-2008 - 根据它是否已经存在来执行插入的最有效方法是什么？

> ID：11265549
> 
> 赞同：1
> 
> 时间：2012-06-29T16:27:50.473
> 
> 标签：sql-server-2008, tsql

我正在执行大量从详细表到 SQL Server 中的汇总表的插入操作。我目前正在使用 LEFT OUTER JOIN 来确定明细表中的行在插入之前是否已存在于汇总表中，如下例所示：

```
INSERT INTO TableA
       (columnA
       ,columnB
       ,columnC)
SELECT 
    b.columnA, 
    b.columnB, 
    b.columnC
FROM TableB b
    LEFT OUTER JOIN TableA a
        on a.columnA = b.columnA
WHERE
    a.columnA IS NULL 
```

我发现即使没有要插入的行，此方法也会花费大量时间，因为它必须比较所有行以确定已经存在的行。在这种情况下，我通常会考虑添加一个标志来`TableB`说明已插入哪些行。

然而，有几种不同的场景`TableB`可以插入一行，`TableA`这需要几个标志，我不希望使用存储空间，因为`TableB`它非常大并且越来越大。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:33:56.353

```
INSERT INTO TableA (columnA, columnB, columnC)
SELECT 
    b.columnA, 
    b.columnB, 
    b.columnC
FROM TableB as b
where not exists (select 1 from TableA as xx where xx.columnA = b.columnA) ; 
```

# java - 如何将 AppEngine 请求日志发送到远程日志服务器？

> ID：11265550
> 
> 赞同：2
> 
> 时间：2012-06-29T16:27:51.167
> 
> 标签：java, google-app-engine, logging, java.util.logging, splunk

我们有一个在 Google App Engine 上运行的 Java 应用程序，目前我正在研究一种将请求日志发送到日志服务器（在我们的例子中是 splunkstorm.com）的方法。

我们对 GAE 为每个请求自动生成的日志感兴趣，例如：

```
0.1.0.1 - - [25/Jun/2012:05:22:29 -0700] "GET /_ah/sessioncleanup?clear HTTP/1.1" 200 29 - "AppEngine-Google; (+http://code.google.com/appengine)" "map2app-platform.appspot.com" ms=307 cpu_ms=5081 api_cpu_ms=3412 cpm_usd=0.141154 
```

我读到 Splunk 支持 syslog、rsyslog、syslog-ng、snare、netcat 和 REST API。

我的想法是让 java.util.logging 像*syslog*一样发送日志，但没有找到任何相关信息。另一种是使用 SLF4J 并使用 3rd-party jar 发送日志，但我不确定是否会发送 GAE 自动生成的请求日志。

我们有什么选择？有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:46:42.927

[一种替代方法是有一个使用日志服务 API](https://developers.google.com/appengine/docs/java/logservice/)获取日志的 cron 作业。

此外，您可以使用 appcfg.sh 下载日志，有关详细信息，请参阅[文档](https://developers.google.com/appengine/docs/java/tools/uploadinganapp#Downloading_Logs)。

# c++ - 使用免费模板参数传递模板类型名

> ID：11265561
> 
> 赞同：2
> 
> 时间：2012-06-29T16:28:20.090
> 
> 标签：c++, templates, c++11

在 C++11（或 C++）中，是否可以传递未完全指定的模板类型。具体来说，我想传递一个尚未定义所有模板说明符的类型：

```
template <std::size_t N, typename ARRAYTYPE>
struct A {
  ARRAYTYPE<int, N> int_array;
};

int main() {
  A<10, std::array> my_a;
  return 0;
} 
```

我知道简单地重新定义`ARRAYTYPE = std::array<int, 10>`会起作用，但不会让我`ARRAYTYPE`在任何地方使用不同大小的`A`：

```
template <std::size_t N, typename ARRAYTYPE>
struct A {
  ARRAYTYPE<int, N> int_array;
  ARRAYTYPE<int, 1> tiny_int_array;
}; 
```

**这可能吗？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T16:33:36.193

它被称为“模板模板参数”，因为它是一个模板参数，其值为模板：

```
template <std::size_t N, template <typename, std::size_t> class ARRAYTYPE>
struct A {
  ARRAYTYPE<int, N> int_array;
  ARRAYTYPE<int, 1> tiny_int_array;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:33:00.890

那不是一个类型，而是一个模板：

```
template <std::size_t N, template <typename, std::size_t> class ARRAY_TMPL>
struct A {
   ARRAY_TMPL<int, N> int_array;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:31:48.833

如果我了解您要完成的工作，您可以将模板本身作为[模板模板参数](https://stackoverflow.com/questions/213761/what-are-some-uses-of-template-template-parameters-in-c)传递。

# php - HTML 表单，将空白表单设置为 NULL

> ID：11265564
> 
> 赞同：3
> 
> 时间：2012-06-29T16:28:27.927
> 
> 标签：php, mysql

我有一个 HTML 表单；我希望能够设置它，以便如果字段为空，数据库中的字段实际上将是 NULL，而不仅仅是字段中的单词 NULL。我认为使用此代码会有所帮助，但它只是将 NULL 这个词放在了字段中。PHP代码：

```
<pre>
<?php
            if (isset($_POST['oc_item'])) { 
            $oc_item = mysql_escape_string($_POST['oc_item']);
            $oc_itemdesc = (!empty($_POST['oc_itemdesc'])) ? $_POST['oc_itemdesc'] : NULL;

           $sql = "INSERT INTO catalog_dev (oc_item,oc_itemdesc)
            VALUES(''$oc_item','$oc_itemdesc')";

        mysql_query($SQL);
        if (mysql_query($sql)) {
            echo '<strong><em>Your data has been submitted</em></strong><br /><br />';
                } else {
            echo '<p>Error adding submitted info: ' . mysql_error(). '</p>';
        }
        }
        ?></pre> 
```

HTML 代码：

```
<pre>

<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">

        <table>
        <tr>
            <td>Item Name</td>
            <td><input class="forms" type="text" size="50" maxlength="50" name="oc_item" /></td>
        </tr>
        <tr>
            <td>Item Description</td>
            <td><input class="forms" type="text" size="50" maxlength="50" name="oc_itemdesc" /></td>
        </tr>
</table>

        <p><input type="submit" value="Submit item" /></p>
        </form></pre> 
```

我希望该字段实际上为*NULL*，并且该字段不包含单词 NULL。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:31:18.207

如果您打印出 $sql，您会看到它正在插入`, 'NULL'`.

您需要修改代码，使其插入工作“NULL”（*不带*'' 引号），或者更好的是，根本不插入该参数（消除`, 'NULL'`字符串的整个部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:31:41.560

如果你想将 NULL 写入 MySQL 数据库，你真的必须把 NULL 放在那里**而不带**引号。

像这样：

```
INSERT INTO table (column, column2) VALUES ('mystring', NULL); 
```

如果您想手动执行此操作，总是有点费力，因为您必须为查询创建 if 条件。

记住：PHP `null`!= MySQL `NULL`。他们俩根本不认识。

但我仍然想知道，这与问题名称有什么关系？（选择除非）

你可以这样写你的代码：

```
$oc_item = mysql_escape_string($_POST['oc_item']);
$oc_itemdesc = (isset($_POST['oc_itemdesc']) && trim($_POST['oc_itemdesc']) != '') ? "'" . mysql_escape_string($_POST['oc_itemdesc']) . "'" : 'NULL';

$sql = "INSERT INTO catalog_dev (oc_item,oc_itemdesc)
        VALUES('" . $oc_item . "', " . $oc_itemdesc . ")";
# sorry for adding " . all the time, but I dislike variables within strings :D 
```

但我不得不承认我也不太喜欢，因为它将 MySQL 字符串周围的引号从 SQL 查询本身移开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:33:24.253

试试这个：

```
$oc_itemdesc = (!empty($_POST['oc_itemdesc'])) ? "'".$_POST['oc_itemdesc']."'" : "NULL";

$sql = "INSERT INTO catalog_dev (oc_item,oc_itemdesc) 
    VALUES('$oc_item',$oc_itemdesc)"; 
```

就目前而言，您正在添加`'NULL'`而不是`NULL`添加单词而不是值。

旁注：我会小心并正确地转义/编码，`$_POST['oc_itemdesc']`因为在描述中加上撇号的人会完全放弃插入语句。例如： `I don't like this`看起来像这样：

```
$sql = "INSERT INTO catalog_dev (oc_item,oc_itemdesc) 
    VALUES('$oc_item','I don't like this')";//MYSQL Error 
```

PPS：就目前而言，您正在插入两次：

```
mysql_query($SQL);//insert 1
if (mysql_query($sql)) {//insert 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-19T06:09:38.647

我用于来自 HTML 表单的 MySQL 数据的函数。

```
function emptyHtmlFormToNull($arr){
   foreach($arr as $key => $val){
       if(empty($val) || strtolower($val) === 'null'){
           $arr[$key] = null;
       }
   }
   return $arr;
} 
```

# distributed-transactions - 三阶段提交协议

> ID：11265565
> 
> 赞同：5
> 
> 时间：2012-06-29T16:28:28.653
> 
> 标签：distributed-transactions

我正在阅读维基百科（http://en.wikipedia.org/wiki/Three-phase_commit_protocol）上的 3 阶段提交协议，这是我想到的 3PC 将失败的场景：

假设有两个参与者 A 和 B 以及一个协调者 C：

1）C 向 A 发送了 precommit 消息，在它向 B 发送 precommit 消息之前，A 和 C 同时失败。2）事务现在重新启动，B 最终中止它，因为没有来自 A 的回复。 3）A 提交事务，因为它已经收到了 precommit 消息。

这不也是3PC应该解决的2PC的原始问题吗？3PC是如何解决问题的？我错过了什么。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:42:34.923

**更新：**

*参与者在收到协调者的 doCommit 消息之前是否不提交？*

参与者收到 preCommit 消息后，会先等待，如果超时，则继续提交。

*如果协调器在发送预提交消息后失败并且至少有一个参与者具有预提交消息，则系统中的其余部分可以继续并提交，因为他们已经知道系统上的状态。*

是的，一旦新的 coordinator 看到他们是已经收到 preCommit 消息的参与者，它会重新向其他参与者发送 preCommit 消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T04:01:47.063

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-12T04:21:25.727

3PC只容忍单点故障，不能容忍多点故障。实际上，要确保 3PC 正常工作，必须满足以下三个条件：

1.  没有网络故障（即没有网络分区，如果目标机器正在工作（没有崩溃），每条消息都会在超时之前到达目标）

2.  最多一名参与者可能会失败（崩溃）。准确地说，如果协调器失败（崩溃），所有队列都不能失败

3.  参与者机器可以区分超时和失败（这不是微不足道的，考虑一下它什么时候在超时后崩溃（即断电），它无法向持久存储写入任何内容以提醒自己这是超时而不是崩溃恢复时）

这些条件都不实用。所以我不认为3PC可以在现实世界中实现。

# escaping - 是否可以“将带引号的字符串作为参数传递给需要自己引用的命令”？

> ID：11265572
> 
> 赞同：0
> 
> 时间：2012-06-29T16:29:13.753
> 
> 标签：escaping, cmd

我知道我知道。疯狂的谎言就是这样。

标题指的是这个[伟大的答案](https://stackoverflow.com/a/180767/4525)。我只想一劳永逸地解决是否真的可以做这样的事情：

```
cmd /C start c:\program files            (says "Windows cannot find c:\program)
cmd /C "start c:\program files"          (ditto)
cmd /C start "c:\program files"          (opens another command window)
cmd /C start \"c:\program files\"        (says "Windows cannot find \"c:\program files\")
cmd /C "start \"c:\program files\""      (ditto)
cmd /C "start ^"c:\program files^""      (opens another command window)
rem Ad nauseam. 
```

我想要做的就是启动一个名称中可能包含空格的文件夹或 url。这是“高级”吗？

我已经看到[了这个问题](https://stackoverflow.com/questions/10289385/using-command-line-argument-that-contains-quotes-and-spaces-e-g-an-xml-string)，但`\"`在上面没有工作。

我从 VFP 中的 WScript.Shell 对象调用它，所以我必须将整个命令作为单个字符串传递。但我想解决更一般的问题以供参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:42:18.840

您的问题不在于 cmd 以及它如何处理引号字符。它与开始以及它如何处理引号字符有关。如果要启动的第一个参数是带引号的字符串，则它是命令窗口的标题，而不是要执行的命令。

用法看起来像这样

```
START ["title"] [/D path] [/I] [/MIN] [/MAX] [/SEPARATE | /SHARED]
  [/LOW | /NORMAL | /HIGH | /REALTIME | /ABOVENORMAL | /BELOWNORMAL]
  [/NODE <NUMA node>] [/AFFINITY <hex affinity mask>] [/WAIT] [/B]
  [command/program] [parameters]

"title"     Title to display in window title bar. 
```

你来做这件事

```
cmd /c start "" "C:\Program Files" 
```

# iphone - iPhone 应用程序加载器故障排除

> ID：11265573
> 
> 赞同：0
> 
> 时间：2012-06-29T16:29:15.093
> 
> 标签：iphone, objective-c, ios, xcode, application-loader

我正在尝试通过应用程序加载器上传我的 iPhone 应用程序的下一个版本，但我收到此错误...

```
Application failed codesign verification.  The signature was invalid, contains disallowed entitlements, or it was not signed with an iPhone Distribution Certificate. 
```

我不确定这是否是错误的，但我截取了 Xcode 的屏幕截图给你们看......

![在此处输入图像描述](../Images/d85a7a8ae8f756993efe1f04e3b903f4.png)

我之前通过应用程序加载器提交了我的应用程序，我想我遇到了同样的问题，但我不记得我做了什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:31:39.490

从 Xcode 4 开始，您可以使用它将应用程序提交到 App Store。 有关如何执行此操作的更多信息，请参阅[此链接。](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/Xcode4UserGuide/DistApps/DistApps.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:32:42.497

在 Xcode 中打开 Organizer，然后在您的配置文件中获取战利品。他们的状态如何？它们是否标有“！”？

# json - 将文本转换为 JSON

> ID：11265575
> 
> 赞同：7
> 
> 时间：2012-06-29T16:29:37.413
> 
> 标签：json, text, format

您如何建议将文本文件转换为 JSON 格式？

我有一个包含大约 500 位文本的文本文件，格式如下：

```
[number in brackets or astriek]
[line1]
[line2]
[line3]
[space]
.
.
. 
```

我想将其转换为 JSON，如下所示：

```
"page1": {
   "line1": "LINE1",
   "line2": "LINE2",
   "line3": "LINE3"
},
"page2": {
   "line1": "LINE1",
   "line2": "LINE2",
   "line3": "LINE3"
}
.
.
. 
```

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:37:34.210

你可以用[明胶](https://github.com/knipknap/Gelatin/wiki/)。

您将使用语法来定义您的输入文本（如果您以前从未这样做过，可能会有点困难）。然后，您只需通过 Gelatin 使用您的语法文件运行您的文本文件，并指定输出。

编辑 1：如果您发布要转换的内容的片段会很有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T16:35:15.617

对我来说最简单的方法是用 java 或 go 来做。

**在 Java 中：**

*   `readLine`您可以使用 a逐行读取文件`new BufferedReader(new FileReader(file))`
*   你可以在阅读过程中`HashMap`填写一个`HashMap<String,String>`
*   创建一个`new BufferedWriter(new FileWriter(outputfilepath))`
*   使用[gson](http://code.google.com/p/google-gson/)，然后你只需要使用

这个 ：

```
Gson gson = new Gson();
gson.toJson(myList, myFileOutputStreamWriter); 
```

**在围棋中：**

您不需要导入外部包，Go 包含所需的包。

这将是这样的（其他一些错误测试会很好）：

```
package main

import (
    "bufio"
    "fmt"
    "io"
    "encoding/json"
    "log"
    "strings"
    "os"
)

func main() {
    myBigThing := make(map[string]map[string]string)
    f, _ := os.Open("/home/dys/dev/go/src/tests/test.go")
    r := bufio.NewReader(f)
    var currentPage map[string]string
    pageNum := 0
    for {
        line, err := r.ReadString('\n')
        if err != nil {
            if err != io.EOF {
                log.Println("Error in parsing :", err)
            }
            break
        }
        if currentPage==nil {
            currentPage = make(map[string]string)
            myBigThing[fmt.Sprintf("page%d",pageNum)] = currentPage
            pageNum++
        } else if line=="" {
            currentPage = nil
        } else {
            tokens := strings.Split(line, ":")
            if len(tokens)==2 {
                currentPage[tokens[0]] = tokens[1]
            }   
        }       
    }
    f, err := os.Create("/home/dys/test.json")
    if err != nil {
        log.Println("Error :", err)
        return
    }
    defer f.Close()
    bout, _ := json.Marshal(myBigThing)
    f.Write(bout)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-16T16:37:39.530

使用 Visual Studio

如果您在文本文件中有所需的数据，这将是最佳选择。

打开 Visual Studio 并在 File menu --> New --> File 下安装，你应该有“Web”选项。那里列出的格式之一是 JSON。

选择它并在VS中复制并粘贴您的文本文档。保存文件，它是 JSON 格式。

# jquery - jQuery GET 失败，没有错误消息

> ID：11265577
> 
> 赞同：4
> 
> 时间：2012-06-29T16:29:52.563
> 
> 标签：jquery, wcf, http-get

我正在`GET`向 WCF Web 服务发出请求。我的 WCF 服务位于`http://localhost/RestService/RestService.svc/web/GetMessage`并具有以下界面：

```
[OperationContract]
[WebGet(UriTemplate = "GetMessage", ResponseFormat = WebMessageFormat.Json)]
String GetMessage(); 
```

端点配置正确，因为我可以在浏览器中进行裸调用：

```
 <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WebServiceBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>

      <endpointBehaviors>
        <behavior name="WebEndpointBehavior">
          <webHttp />
          </behavior>
      </endpointBehaviors>
    </behaviors>

    <services>
      <service name="TestRestService.RestService"
               behaviorConfiguration="WebServiceBehavior">
        <endpoint name="RestWeb"
                  address="web"
                  binding="webHttpBinding"
                  behaviorConfiguration="WebEndpointBehavior"
                  contract="TestRestService.IRestService" />
      </service>
    </services>
  </system.serviceModel> 
```

在我的浏览器中通过导航调用它会返回：

```
{"GetMessageResult":"Hello World!"} 
```

到现在为止还挺好。这里没有问题。快速查看执行yield 的[jQuery 文档](http://api.jquery.com/jQuery.get/)`GET`：

```
<html>
    <head>
        <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
        <script type="text/javascript">
            $.ajax({
                url: 'http://localhost/RestService/RestService.svc/web/GetMessage',
                type: 'GET',
                dataType: 'json',
                success: function (data) {
                    alert(data);
                },
                error: function (xhr, status, message) {
                    alert("Error: " + status + " " + message); }
                });
        </script>
    </head>
    <body>
    </body>
</html> 
```

我使用 jQuery 1.72 在一个小的 html 测试页面中运行它，我收到以下错误：

```
Error: error 
```

是什么赋予了？[我在这里找到](https://stackoverflow.com/questions/4062317/jquery-get-error-response-function)的错误消息处理程序给了我*绝对零*有用的信息。简单的说：

*   为什么我的 GET 失败？
*   为什么错误信息没有用？

# 解决方案

[事实证明，正如 Kevin B在他的回答中所建议的](https://stackoverflow.com/a/11265761/312124)那样，jQuery 本身并不支持跨域 ajax 请求。为了解决这个问题，我不得不切换到使用`dataType: 'jsonp'`并添加一个启用属性`webHttpBinding`的`crossDomainScriptEnabled`：

```
<bindings>
  <webHttpBinding>
    <binding name="WebBindingWithScripts"
             crossDomainScriptAccessEnabled="true">
      <security mode="None" />
    </binding>
  </webHttpBinding>
</bindings>

<endpoint name="RestWeb"
          address="web"
          binding="webHttpBinding"
          behaviorConfiguration="WebEndpointBEhavior"
          bindingConfiguration="WebBindingWithScripts"
          contract="TestService.IRestService">
</endpoint> 
```

使用 only`dataType: 'jsonp'`时，除非您将 WCF 服务配置为允许跨域脚本，否则您仍然会收到错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:44:09.390

您是否正在发出跨域请求？我看到您使用的是 localhost，但这并不一定意味着您是从 localhost 请求的（据我们所知，您可能正在使用不同的端口或协议）。

在这种情况下，请求失败的原因有两个：

1.  返回的 JSON 包含其他字符，使其无效 json
2.  请求来自与 Web 服务不同的域。

由于您`same-origin`在控制台中没有看到错误，我希望它是 #1。但是，既然你得到了`error`而不是`parseerror`，那是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T17:31:28.197

这发生在我身上一次，我所做的只是在我的 web.config 中添加 endpointBehaviors 以支持这样的 WebHttp 请求

```
 <behaviors>
  <serviceBehaviors>
   ......
   </behavior>
  </serviceBehaviors>   
  <endpointBehaviors>
        <behavior name="EndpBehavior">
            <webHttp/>
        </behavior>
    </endpointBehaviors> 
```

并更改了我的端点以包含“behaviorConfiguration”并更改了绑定

```
 <endpoint address="" binding="webHttpBinding" contract="IService1" 
  behaviorConfiguration="EndpBehavior"> 
```

不要忘记将其添加到您的 IService ：

```
[WebGet(ResponseFormat =WebMessageFormat.Json)] 
```

# shell - 如何向 MongoDB 中的字典添加另一个值？

> ID：11265578
> 
> 赞同：6
> 
> 时间：2012-06-29T16:29:54.150
> 
> 标签：shell, mongodb, mongo-shell

这是我正在尝试做的一个例子，因为我无法解释我的意思。

我在 mongo CLI 中执行此操作：`db.posts.insert({name: "Hello, world!, body: "Here's my first blog post. Happy reading!", comments: []})`。我想要做的是更新该条目以向`comments`字典添加评论。

我将如何使用`db.posts.update()`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-06-30T16:56:28.850

OP的问题和示例不匹配。他实际上想在文档内的数组中插入一个字段，这意味着

```
db.posts.update({name: "Hello, world!" }, { $push: {comments: "First comment!"}}); 
```

工作得很好。

但是，如果您想向字典中添加值或子文档，则可以使用该`$set`命令。以这个文档为例：

```
{
    "_id": {
        "$oid": "538420b2862a656e9e99fc93"
    },
    "name": "Farmer John",
    "items": {
        "peaches": 5,
        "bananas": 10
    }
} 
```

假设您希望添加`"apples": 2`到项目中。该命令将是

```
db.collection.update({"name": "Farmer John"},
                     {"$set": {"items.apples": 2}}); 
```

您的文档将如下所示：

```
{
    "_id": {
        "$oid": "538420b2862a656e9e99fc93"
    },
    "name": "Farmer John",
    "items": {
        "peaches": 5,
        "bananas": 10,
        "apples: 2
    }
} 
```

请注意，这也适用于插入子文档，因此我们可以修改原始示例：

```
{
    "_id": {
        "$oid": "538420b2862a656e9e99fc93"
    },
    "name": "Farmer John",
    "items": {
        "peaches": {
            "yellow": 5,
            "white": 3
        }
    }
} 
```

让我们插入 4 个青苹果和 8 个富士苹果。

```
db.collection.update({"name": "Farmer John"},
                     {"$set": {"items.apples": {"fuji": 8, "granny smith": 4}}}); 
```

我们的文件现在是：

```
{
    "_id": {
        "$oid": "538420b2862a656e9e99fc93"
    },
    "name": "Farmer John",
    "items": {
        "peaches": {
            "yellow": 5,
            "white": 3
        },
        "apples": {
            "fuji": 8,
            "granny smith": 4
        }
    }
} 
```

最后一条评论：请注意，如果子文档或字段已经存在，那么它将被`$set`命令覆盖。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-07-10T11:40:32.613

对于像这样的对象：

```
{
  name: "Hello, world!",
  content: "This is my first post"
} 
```

如果你现在跑

```
db.posts.update({name: "Hello, world!"}, {name: "First post"}); 
```

这就是结果：

```
{
  title: "First post"
} 
```

content 属性将被删除，因为没有提供替换值。我提到这一点是因为这是一个常见的错误。

所以如果你想“添加”一个属性，你需要运行：

```
db.posts.update({name: "Hello, world!" }, { $push: {comments: "First comment!"}}); 
```

如果要将数据附加到数组，则使用 $push。如果它是一个普通字段，请使用 $set。

参考：[http ://www.mongodb.org/display/DOCS/Updating](http://www.mongodb.org/display/DOCS/Updating)

# java - 创建 bean 时是否可以让 ApplicationContext 使用验证器？

> ID：11265581
> 
> 赞同：1
> 
> 时间：2012-06-29T16:30:12.867
> 
> 标签：java, spring, validation

在 Spring 3.0 中，`ApplicationContext`在创建 bean 和执行依赖注入时执行杂项验证。

可以让它使用一个 bean`validator`还是我应该让它回调一个`@PostConstruct`调用这个验证器的方法？

**更新**

该验证器将执行比`ApplicationContext`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:34:04.553

你想验证什么？根据您的需要[BeanFactoryPostProcessor](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/beans/factory/config/BeanFactoryPostProcessor.html)可能适合。

# javascript - 由 jquery ajax 回调停止的主干收集垃圾收集

> ID：11265586
> 
> 赞同：1
> 
> 时间：2012-06-29T16:30:41.913
> 
> 标签：javascript, jquery, backbone.js

我一直在搞乱 Chrome 堆分析器和一些基本的 Backbone 对象，只是为了了解垃圾收集。我遇到了一些奇怪而令人困惑的行为。

使用仅加载了 jquery-1.7.2、underscore-1.3.3 和主干网 0.9.2 的基本页面。如果我从 Chrome (win/19) js 控制台窗口运行以下代码，则不会对集合进行垃圾收集。在堆分析器中，“对象的保留树”将列出 50 个用户以及模型和集合之间的循环引用，但它也会列出在 function() @234234 中显示 b 的 2。扩展这些引用，这些引用看起来来自 jQuery 的 ajax 回调处理程序。

```
(function () {
    var collection = new Backbone.Collection();
    collection.url = '/api/users/';
    collection.fetch();

    setTimeout(function wtf() { $('#content').append($('<div>' + collection.models[0].get('name') + '</div>')); }, 3000);
})() 
```

如果我运行以下代码，则集合将按预期正确进行垃圾收集。不同之处在于最后一行我进行了一些随机 ajax 调用，这似乎将 jQuery ajax 回调从集合中移出。

```
(function () {
    var collection = new Backbone.Collection();
    collection.url = '/api/users/';
    collection.fetch();

    setTimeout(function wtf() { $('#content').append($('<div>' + collection.models[0].get('name') + '</div>')); }, 3000);

    $.ajax({ url: '/api/users/' });
})() 
```

这是预期的行为还是错误或什么？如果我有随机的对象，那会很糟糕，因为他们过去做过 ajax 请求。

更新：所以我正在进一步测试它，它似乎只影响第一个或第二个实例。如果我创建一个 setinterval 来创建一个新集合并每 1 秒调用一次 fetch，那么创建的前 1-2 个实例将无限期地保留在内存中（20 分钟以上），而创建的所有其他实例将被正确处理。

如果我调用 jquerys Ajax 函数并在成功处理程序中将数据作为创建时的参数传递给新集合，则根本不会发生此行为。创建的所有实例都已正确清理。

看来，Backbone.wrapError 函数与成功的包装一起是问题的一部分。

# android - GC_CONCURRENT 释放了 1841K 并杀死了我的 MediaPlayer

> ID：11265590
> 
> 赞同：0
> 
> 时间：2012-06-29T16:30:55.960
> 
> 标签：android

**已解决：需要在全球范围内声明 MP。**

我有一个 MediaPlayer 播放/循环声音。

```
 MediaPlayer mp = MediaPlayer.create(this, R.raw.v);
    mp.setLooping(true);
    mp.start(); 
```

它工作正常，直到我突然得到

```
D/dalvikvm(14090): GC_CONCURRENT freed 1841K, 51% free 4335K/8839K, external 10702K/12379K, paused 2ms+4ms 
```

在 logcat 和 MP 死了。任何想法可能发生了什么，我该如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:39:25.053

在前面添加这一行`mp.start()`

`mp.setLooping(True)`

然后当你想停止它循环时设置为 false 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:00:07.210

知道了！只需要在全球范围内声明 MP 就可以了！

# gwt - 如何在 SmartGWT SelectItem 中选择一个项目？

> ID：11265591
> 
> 赞同：1
> 
> 时间：2012-06-29T16:31:13.743
> 
> 标签：gwt, smartgwt, gxt, smartclient

我有一个 SelectItem 对象，其中包含一些项目。我设置了一个值 MAP：

```
organizations[0] = "A";
organizations[0] = "B";
selectItem.setValueMap(organizations); 
```

显示时，组合框将“A”显示为选定项。然后，我需要以编程方式选择值“B”并在当前 SelectItem 对象上选择它。我找遍了整个地方都没有结果。

任何人？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T07:13:37.187

如果您希望手动选择 selectItem 的任何选项，那么您应该尝试以下操作：

```
selectItem.setValue("B"); 
```

在您打开 selectItem 的选项列表时执行此操作后，值“B”将突出显示。

# c# - sql数据源超时错误

> ID：11265593
> 
> 赞同：7
> 
> 时间：2012-06-29T16:31:19.923
> 
> 标签：c#, asp.net, sql, datasource

错误代码：

> 超时已过期。在操作完成之前超时时间已过或服务器没有响应。

有人可以提供我可以复制和粘贴的代码，以便我可以更改默认超时吗？我不确定将其放入此代码的何处：

```
<head runat="server">
<title>Proxy Report</title>
</head>
<body>
<form id="form1" runat="server">
<div>

    <asp:Label ID="Label1" runat="server" Text="Proxy Report"></asp:Label>

</div>
<asp:GridView ID="GridView1" runat="server" DataSourceID="SqlDataSource1">
</asp:GridView>
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:ISALog1ConnectionString %>" 
    SelectCommand="ProxyReport" SelectCommandType="StoredProcedure">

</asp:SqlDataSource>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-29T16:56:20.393

您可以像这样增加 Timeout 属性

```
protected void SqlDataSource1_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
        {
            e.Command.CommandTimeout = 0;
        } 
```

将超时设置为 0 表示没有超时

# jquery - 使光标周围半径内的前景图像透明

> ID：11265594
> 
> 赞同：0
> 
> 时间：2012-06-29T16:31:29.203
> 
> 标签：jquery, html, transparency, html5-canvas

我们有一个需要实现的设计，其概念是用户将手电筒照射到物体上，手电筒光束（光标周围的圆圈）内的任何东西都应该显示背景图像而不是前景图像。

我正在寻找有关如何使用 jQuery 和 HTML5 技术实现理想的建议。我很确定我们可以使用 Flash 实现这一点，但我们希望它对 iOS 友好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:43:23.300

我会建议像这样的[jsfiddle](http://jsfiddle.net/csPcb/2/)覆盖背景而不是使用蒙版。我用了一个基本的 png 来模拟你的手电筒，你当然应该使用更好的图像

提防 jsfiddle 性能缓慢，但在其他任何地方都应该更好

更新：更新 jsfiddle 链接以修复错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:45:32.227

您可以使用两个 html 画布。

前景是一个 z-index 比背景高的画布，它们都是 position:absolute 并且被容器元素包含。

然后您会找到以鼠标为中心的圆圈的位置（请参阅参考资料）

您可以通过使用鼠标移动事件并从鼠标的位置减去圆的高度和宽度的一半以使其以鼠标为中心来获得它的位置。

然后，您可以操纵画布上与圆具有相同坐标的像素，使其具有 0 的 alpha 值（或者如果您不希望它完全透明，则为 0 和 1 之间的数字）

希望这足以彻底解释它。随意问任何问题。不过，我不会只分发代码，因为这不是本论坛的真正意义所在。

资源：

基础知识： http: [//www.html5canvastutorials.com/tutorials/html5-canvas-tutorials-introduction/](http://www.html5canvastutorials.com/tutorials/html5-canvas-tutorials-introduction/)

获取圆的坐标： [按顺序计算圆坐标](https://stackoverflow.com/questions/4700404/calculate-circle-coordinates-in-a-sequential-fashion)

操作像素： [http ://tutorials.jenkov.com/html5-canvas/pixels.html](http://tutorials.jenkov.com/html5-canvas/pixels.html)

# python - 如何导出 Python 内置 help() 函数的输出

> ID：11265603
> 
> 赞同：23
> 
> 时间：2012-06-29T16:31:53.573
> 
> 标签：python, pydoc

我有一个 python 包，它从以下位置输出大量帮助文本：`help(package)`

我想将此帮助文本以显示的格式导出到文件中`help(package)`

我该怎么办？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-29T17:35:24.527

pydoc.render_doc(thing) 以字符串形式获取事物的帮助文本。pydoc 的其他部分，如 pydoc.text 和 pydoc.html 可以帮助您将其写入文件。

在linux中使用`-w`修饰符会将输出写入到当前目录下的一个html中，例如；

```
pydoc -w Rpi.GPIO 
```

将命令中显示的所有`help()`文本`help(Rpi.GPIO)`放入 shell 的当前目录中格式良好的文件 Rpi.GPIO.html

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-29T17:05:38.240

这有点骇人听闻（并且在某处可能有更好的解决方案），但这有效：

```
import sys
import pydoc

def output_help_to_file(filepath, request):
    f = open(filepath, 'w')
    sys.stdout = f
    pydoc.help(request)
    f.close()
    sys.stdout = sys.__stdout__
    return 
```

接着...

```
>>> output_help_to_file(r'test.txt', 're') 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-08-17T08:47:13.417

一个老问题，但较新的[推荐](https://twitter.com/raymondh/status/1030160198600548352)通用解决方案（用于 Python 3.4+）用于编写`print()`终端正在使用的函数的输出`contextlib.redirect_stdout`：

```
import contextlib

def write_help(func, out_file):
    with open(out_file, 'w') as f:
        with contextlib.redirect_stdout(f):
            help(func) 
```

使用示例：

```
write_help(int, 'test.txt') 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-12-20T00:40:06.700

要获得“干净”的文本输出，就像内置的 help() 会提供一样，并且适合导出到文件或其他任何内容，您可以使用以下内容：

```
>>> import pydoc
>>> pydoc.render_doc(len, renderer=pydoc.plaintext)
'Python Library Documentation: built-in function len in module builtins\n\nlen(obj, /)\n    Return the number of items in a container.\n' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-29T16:42:40.493

如果你帮助（帮助）你会看到：

```
Help on _Helper in module site object:

class _Helper(__builtin__.object)
 |  Define the builtin 'help'.
 |  This is a wrapper around pydoc.help (with a twist). 
```

[休息剪断]

所以 - 你应该看看 pydoc 模块 - 将有一个或多个方法返回`help(something)`作为字符串的内容......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-11-21T19:49:41.793

选定的答案对我不起作用，因此我进行了更多搜索，并找到了适用于 Daniweb 的内容。归功于 vegaseat。[https://www.daniweb.com/programming/software-development/threads/20774/starting-python/8#post1306519](https://www.daniweb.com/programming/software-development/threads/20774/starting-python/8#post1306519)

```
# simplified version of sending help() output to a file
import sys
# save present stdout
out = sys.stdout
fname = "help_print7.txt"
# set stdout to file handle
sys.stdout = open(fname, "w")
# run your help code
# its console output goes to the file now
help("print")
sys.stdout.close()
# reset stdout
sys.stdout = out 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-31T12:01:47.423

最干净的方法

假设`help(os)`

第 1 步 - 在 Python 控制台中

```
 import pydoc 
 pydoc.render_doc(os, renderer=pydoc.plaintext)` 

 #this will display a string containing help(os) output 
```

第 2 步 - 复​​制字符串

第 3 步 - 在终端上

```
echo "copied string" | tee somefile.txt 
```

如果要在文本文件中写入类信息。请按照以下步骤操作

1.  在类中的某处插入 pdb 钩子并运行文件

    导入pdb；pdb.set_trace()

2.  执行上述步骤 1 至 3

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-11-28T16:57:10.493

最简单的方法是通过使用

> 系统模块

它在操作系统和它自己之间打开一个数据流，它从帮助模块中获取数据，然后将其保存在外部文件中

```
file="str.txt";file1="list.txt"
out=sys.stdout
sys.stdout=open('str_document','w')
help(str)
sys.stdout.close 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-30T22:12:00.720

pydoc already provides the needed feature, a very well-designed feature that all question-answering systems should have. The pydoc.Helper.**init** has an output object, all output being sent there. If you use your own output object, you can do whatever you want. For example:

class OUTPUT():

```
def __init__(self):
    self.results = []
def write(self,text):
    self.results += [text]
def flush(self):
    pass
def print_(self):
    for x in self.results: print(x)
def return_(self):
    return self.results
def clear_(self):
    self.results = [] 
```

when passed as

O = OUTPUT() # Necessarily to remember results, but see below.

help = pydoc.Helper(O)

will store all results in the OUTPUT instance. Of course, beginning with O = OUTPUT() is not the best idea (see below). render_doc is not the central output point; output is. I wanted OUTPUT so I could keep large outputs from disappearing from the screen using something like Mark Lutz' "More". A different OUTPUT would allow you to write to files.

You could also add a "return" to the end of the class pydoc.Helper to return the information you want. Something like:

if self.output_: return self.output_

should work, or

if self.output_: return self.output.return_()

All of this is possible because pydoc is well-designed. It is hidden because the definition of help leaves out the input and output arguments.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-14T19:13:01.847

在 Windows 中，只需打开一个 Windows 命令行窗口，转到 Python 安装的 Lib 子文件夹，然后键入

python pydoc.py moduleName.memberName > c:\myFolder\memberName.txt

将 moduleName 中的属性或方法 memberName 的文档放入文件 memberName.txt 中。如果您想要一个对象在模块层次结构的更下方，只需放置更多点。例如

python pydoc.py wx.lib.agw.ultimatelistctrl > c:\myFolder\UltimateListCtrl.txt

把wxPython包中agw包中关于UltimateListCtrl控件的文档放到UltimateListCtrl.txt中。

# c++ - C++ 中的类不是对象吗？

> ID：11265604
> 
> 赞同：4
> 
> 时间：2012-06-29T16:31:56.477
> 
> 标签：c++, class

我正在阅读“[设计模式：可重用的面向对象软件的元素](https://rads.stackoverflow.com/amzn/click/com/0201633612)”，（特别是关于原型设计模式的章节），它指出......

> **“原型对于像 C++ 这样类不是对象**的静态语言特别有用，在运行时几乎没有或没有类型信息可用。” （第 121 页）

*（强调我的）*

我一直认为类是对象的同义词，我对这句话的含义感到困惑。类如何不是对象，如果语言是静态的，为什么这很重要？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T16:35:05.153

C++ 中的类不是对象：类是对如何构建对象的描述，以及对对象类型的引用。

与 Python 之类的语言相比：在 Python 中，就像在 C++ 中一样，您从一个类中实例化一个对象。与 C++ 不同，您使用的类也是一个对象：它通常具有 type `type`，您可以在运行时创建新的，像任何其他对象一样操作它们，甚至创建本身具有不同类型的类的对象。

您可能想知道为什么需要它，而且通常您不需要它——它就像 C++ 模板元编程一样，您只在需要时才*需要*它，因为您无法以任何其他方式实现您的目标。在 Python 中使用元类解决的问题也可能是在 C++ 中使用模板元编程解决的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T16:35:54.853

在 C++ 中，这声明了一个类：

```
class A {
public:
  int a;
}; 
```

而这声明了一个对象：

```
A a; 
```

一个人不能在运行时询问一个类，因为一个人可以询问一个对象。`operator+`说“对象'a'，你的地址是什么？请调用.等”是有道理的。在 C++ 中，由于它的静态类型，说“A 类，你的成员列表是什么？请添加一个新成员“b”是没有意义的。

在其他语言中（想到 Python），可以通过这种方式操作类，因为每个类也是一个对象。除了作为对象的模板之外，类*本身*也是一个对象——它可以被打印、修改等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T18:07:37.323

例如，一个类可以描述一本书是什么：名称、作者、出版日期、描述。

“Book”类的对象将是一本特定的书：C++ Primer Plus，Stephen Prata，2005，一本教 C++ 的书。

因此，类与对象不同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-29T16:41:05.490

扩展 Andrew Aylett 所说的内容。

> C++ 中的类不是对象：类是对如何构建对象的描述，以及对对象类型的引用。

此外，在 Python 或 smalltalk 等语言中。一切都是对象。函数是对象，类是对象。因此，这些语言是动态类型的，这意味着在运行时检查类型并且变量可以采用任何类型。

C++ 是静态类型的。变量只能采用一种类型，并且在编译时执行类型检查。

因此，例如在 python 中，您可以动态修改一个类。添加函数和字段，因为它是一个对象，并且可以修改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-29T16:36:17.533

那句话所指的是这样一个事实，即类不是像 C++ 这样的语言中的一阶实体。在其他语言中，您可以将类作为参数传递给函数，例如，与将对象或函数作为参数传递的方式相同。

是否是类一阶实体还有更多含义，例如，在运行时修改类的可能性，或检查类的完整内部结构等。

通常发现类是动态语言（如 ruby​​）或 lisp 的元对象协议等中的一阶实体。

希望这能澄清一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-29T16:39:54.587

当一个类被称为对象时，这意味着在运行时有一个对象代表该类。在 C++ 中，类在编译时被分解。它们的实例（即对象）只是保存对象字段的字节序列，没有对类本身的任何引用。现在，C++ 确实通过 RTTI 在运行时提供了一些类型信息，但这仅适用于多态类型，不被视为类对象。

缺乏在运行时表示类的对象是 C++ 中没有反射的原因 - 只是没有办法获取有关某个类的信息，因为没有代表它的对象。

顺便说一句，C++ 被认为是一种两级语言：对象是类的实例，但类不是任何东西的实例，因为它们只存在于编译类型。在 C# 和 Java 等 3 级语言中，类在运行时也是对象，因此，它们本身就是另一个类（Java 中的 Class，C# 中的 Type）的实例。最后一个类是它自己的一个实例，因此该语言只有 3 个级别。有更多级别的语言，但这超出了这个问题的范围......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-29T16:50:04.227

类与对象不同。类（或多或少）是类型，Object 是实例，类似于以下内容：

```
int i;
YourClass object; 
```

在这里你不会说`i`and`int`是一样的 - 也不是`YourClass`and `object`。

该声明想说的是：许多面向对象的语言都*非常*面向对象，因此它们开始将所有（或几乎所有）都变成（一个或另一个类的）对象。因此，在许多语言中， a`class`将是一些`class class`（可能会令人困惑）的实例（因此是一个对象）。

这有时具有优势，因为您可以像对待任何其他对象一样对待此类语言中的类（即类型）。你可以用它们做非常动态的东西，比如将它们存储在变量中，甚至在运行时操作类（例如，创建你的程序需要的新类）。

看看这个类似 c++ 的伪代码：

```
YourClass myObject = new YourClass();                // creates an object (an instance)
Class baseClass = myObject.get_class();              // store the class of myObject in baseClass. That's storing a type in a variable (more or less)
Class subClass = myObject.inherit();                 // dynamically create a new class, that only exists in variable subClass (a Class-object), inheriting from baseClass
subClass.add_method(some_function);                  // extend the new class by adding a new method
subClass.get_class() subClass.create_instance();     // declare a new variable (object) of your newly created type 
BaseClass another_onne = subClass.create_instance(); // also valid, since you inherited 
```

这显然不能很好地转换为 c++，因为 c++ 的严格类型。其他语言在打字方面更具动态性，这种灵活性可以派上用场（并使思维更加复杂；有时两者同时存在）。如果您了解 C++，我仍然认为它解释了原理。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-29T17:10:44.167

> 我一直认为类是对象的同义词

OOP 文献中的语言有时并不具体。编程语言对对象的概念有些不同也无济于事。

类是创建对象（该类的实例）的模板或定义。也就是说，一个类提供了该类（或类型……稍后会详细介绍）的对象的结构、类型签名和行为。

对象只是该类实例在内存中的一个位置。

维基百科对此提供了很好的文档。我建议你阅读它：

[http://en.wikipedia.org/wiki/Class_(computer_programming](http://en.wikipedia.org/wiki/Class_(computer_programming) )

[http://en.wikipedia.org/wiki/Object_](http://en.wikipedia.org/wiki/Object_(object-oriented_programming) (面向对象编程)

此外，还有*type*的概念。类型（或有时在某些文献或编程语言中称为接口）通常是类型/方法签名（可能还有行为）的集合。Java 接口和 C++ 纯虚拟类之类的东西倾向于表示*类型*（但并不完全相同）。

那么符合该*类型*的类（无论是接口还是纯虚拟类）都是该*类型的**实现*。

 *那个类，那个*类型的实现*只是如何在内存中构造那个类/类型的对象的一个​​秘诀。

当您实例化一个类/类型时，您会在内存中具体化、构造该类的实例（对象）。

在 C++ 中，类不是对象，因为类本身没有被实例化。C++ 类不是其他类的实例（请参阅我上面的定义。）

OTH，在像 Java 这样的语言中，类本身由原始类 (java.lang.Class) 的实例表示。所以一个类 X 在内存中有一个与之关联的对象（一个 java.lang.Class 实例）。有了它，有了那个*“类”*对象，你可以（理论上）实例化或制造另一个类/类型 X 的实例（或对象）。

它可能会让人感到困惑。我强烈建议您搜索和阅读有关类、类型、原型和对象/实例的文献。

> 我对这个声明的含义感到困惑。类怎么不是对象，

如上所述。类不是对象。对象是一个实例，一块由类或类型的“配方”构造和初始化的内存。

> 如果语言是静态的，为什么重要？

本书的这一部分有点误导，因为例如 Java 是静态类型的，而类本身可以是对象。也许文本指的是动态类型语言（如 JavaScript），其中类也可以是对象或实例。

我的建议是永远不要使用词对象，而只是将词汇限制为“类”和“实例”。但这是我个人的偏好。其他人可能不同意，就这样吧。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-29T17:37:50.463

我可以把它更简单地让你理解它：

对象是类的“物理”实例。它在程序运行时消耗内存。

一个类描述一个对象：层次结构、属性、方法。一个类，它就像一个用于创建对象的“模板”。*

# php - JavaScript 和 PHP 可以证明一个在线纸牌游戏吗？

> ID：11265606
> 
> 赞同：0
> 
> 时间：2012-06-29T16:31:59.643
> 
> 标签：php, javascript, performance

我想问，是否可以只使用 JavaScript、PHP 和 AJAX（没有 Flash）来创建在线纸牌游戏？

游戏应该像这样运行 - 每个玩家都会有一副带有 X 牌（例如 60 张）的牌组，每张牌都具有原始能力。游戏必须评估游戏中的每一个动作（例如——一张牌有能力抽另一张牌，游戏必须抽一张牌，等等）并且系统必须控制动作的可能性。所有这些东西都会控制 PHP。Javascript 只会通过 AJAX 发送问题，并且只会接收简单的命令（比如抽一张牌，将这张牌从手牌移到游戏中）。

另一件事是游戏同步（再次使用 AJAX），就像玩家必须经常看到的那样，他的对手在做什么（我猜是关于第二个请求）。JavaScript 能容纳所有这些东西吗？AJAX 请求是否足够快？PHP 能否以足够快的速度评估游戏（使用编写良好的核心应用程序）？

谢谢

PS：我不坚持支持老浏览器（比如IE7,8）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:34:22.090

答案是**肯定**的。有可能的。

# linux - 我应该如何使用位于多个子目录中的原始图像批量制作缩略图？

> ID：11265607
> 
> 赞同：1
> 
> 时间：2012-06-29T16:32:17.787
> 
> 标签：linux, image, terminal

我在一个目录结构中有原始图像，如下所示：

```
./Alabama/1.jpg
./Alabama/2.jpg
./Alabama/3.jpg
./Alaska/1.jpg
...the rest of the states... 
```

我想将所有原始图像转换为缩略图，以便可以在网站上显示它们。经过一番挖掘/试验，我想出了以下 Linux 命令：

```
find . -type f -iname '*.jpg' | sed -e 's/\.jpg$//' | xargs -I Y convert Y.jpg -thumbnail x100\> Y-small.jpg 
```

它递归地在我的子目录中查找所有 jpg 图像，从中删除文件类型 (.jpg)，以便我以后可以重命名它们，然后将它们制作成缩略图并在文件类型前附加“-small”重命名它们。

它适用于我的目的，但它有点复杂，而且不是很健壮。例如，我不确定如何在文件名的开头插入“small-”（so `./Alabama/small-1.jpg`）。

问题：

1.  有没有更好、更强大的方法从位于多个子目录中的图像创建缩略图？
2.  我可以使现有命令更健壮吗（例如，但在保存`sed`之前使用重命名输出的缩略图 - 基本上修改 Y-small.jpg 部分）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:41:53.710

无需构建如此复杂的结构。先制作小块，然后连接。

我决定**不在**文件名中间插入`-small`。它使一切变得更加复杂。最好使用前缀（更简单的代码，也更容易从拇指派生出原始文件名），它可以是 a`thumbsDir/`或 a `thumbsPrefix-`.

```
#!/bin/sh

make_thumbnail() {
    pic=$1
    thumb=$(dirname "$1")/thumb-$(basename "$1")
    convert "$pic" -thumbnail x100 "$thumb"
}

# Now we need a way to call make_thumbnail on each file.
# The easiest robust way is to restrict on files at level 2, and glob those
# with */*.jpg
# (we could also glob levels 2 and 3 with two globs: */*.jpg */*/*.jpg)

for pic in */*.jpg
do
    make_thumbnail "$pic"
done 
```

# sql - 来自 SQL 服务器的 iOS sqlite 数据

> ID：11265609
> 
> 赞同：2
> 
> 时间：2012-06-29T16:32:21.780
> 
> 标签：sql, ios, json, web-services, sqlite

我需要每天一次以无线方式将大数据（~100MB）从 sql server 获取到应用程序的 sqlite 中。

应用程序具有用于其他事物的 json/restful webservice，但认为这是不可能的，因为当我尝试将 json 写入 sqlite 时，通过 json 对象加载到内存中的 100MB 会导致内存崩溃。

我现在正在考虑从 url 检索文件并将其保存在本地。这样数据就不会加载到内存中。

我模糊的部分是获取数据的最佳方式，即下载一个.sqlite压缩文件或下载一个带有准备好的插入语句的文本文件到现有的sqlite。可以肯定的是，先验是最好的选择，但对数据库的了解不足以知道 sql server 上的可能性。sql server 是否可以选择数据子集并创建 sqlite 文件？也许它只需要编写脚本。

要考虑的一件事是 sql server 上的数据结构。我需要来自多个表的数据子集，而不是整个表。示例：SQL Server 包含 100 个物理站点数据，应用程序今天在站点 X，只需加载站点 X 数据。

我是在正确的轨道上还是我错过了一个明显的解决方案？

# mysql - 在忽略年份的mysql函数之间使用

> ID：11265610
> 
> 赞同：1
> 
> 时间：2012-06-29T16:32:27.253
> 
> 标签：mysql, date, between

好的，我有以下**用户**表：

```
id |  name  |  birthday 

1  |  nam1  |  1980-06-29  
2  |  nam2  |  1997-07-08  
3  |  nam3  |  1997-07-20 
```

> 假设今天是2012-06-29

我如何才能获得将在未来 15 天内为您庆祝生日的用户？我试过这个：

```
select * from users where birthday between '%-06-29' and '%-07-14'; 
```

但看起来不是一个有效的查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:48:25.527

我认为最安全的方法是将他们 15 天后的年龄与他们今天的年龄进行比较：

```
SELECT *
FROM   Users
WHERE  TIMESTAMPDIFF(YEAR, birthday, CURRENT_DATE + INTERVAL 15 DAY)
     > TIMESTAMPDIFF(YEAR, birthday, CURRENT_DATE) 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/62eeb/1/0)上查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:34:18.673

您应该尝试对“生日”的子字符串进行操作，这样您就可以将年份“删掉”

# selenium - Selenium 设置/拆卸最佳实践 - 将数据返回到原始状态

> ID：11265613
> 
> 赞同：0
> 
> 时间：2012-06-29T16:32:41.923
> 
> 标签：selenium

```
 {
        Assert.That(_editUserPage.State.SelectedText, Is.EqualTo("Illinois"));
        _editUserPage.State.SelectedText = "New York";
        Assert.That(_editUserPage.State.SelectedText, Is.EqualTo("New York"));
        _editUserPage.SaveChanges();
        Assert.That(_editUserPage.State.SelectedText, Is.EqualTo("New York"));
     } 
```

在上面的示例中，我将用户的州从伊利诺伊州更改为纽约州；我的问题是：我是否应该在测试结束时将状态更改回 Illiois 的原始值？

我在同一个文件中有大约 20 个其他独立测试，我想知道将数据返回到原始状态的最佳实践是什么。我们对整个测试套件使用 setup/teardown，而不是在每个单独的测试中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:24:14.870

到目前为止，我确实看到的最佳做法是：

1.  测试有一个测试数据输入（excel表）
2.  每次运行都会为数据添加一些前缀（例如名称 Pavel => Test01_Pavel）
3.  测试确实验证了系统中不存在此类数据
4.  测试根据输入创建测试数据并验证这些数据是否存在
5.  测试删除了所有测试数据并验证了这些数据已被删除。

但真正最好的答案是“视情况而定”。我个人不会从系统中删除任何测试数据，因为

*   测试环境与产品一严格划分
*   测试数据可以在以后的性能测试期间有用（例如从系统下载用户列表）

所以你应该问自己的真正问题是：

*   最后删除测试数据会给你带来什么好处吗？
*   反之亦然：如果测试数据保留在系统中会怎样？

顺便说一句，如果您觉得“如果其中有太多废话/虚拟数据，应用程序肯定会崩溃”，您绝对应该测试这种情况。想象一下，您的服务将在一夜之间变得流行（Charlie sheen 在推特上发布关于使用您的页面的消息：））并且数百万用户希望自己注册。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-22T09:00:31.260

我工作的公司采取的方法是：

1.  在云 (AWS) 中启动专用测试环境
2.  启动测试套件
3.  每个测试都会插入它需要的数据
4.  一旦测试套件完成，然后拆除服务器，公司。D b

这样，每次测试运行时您都有一个新的数据库，因此坏数据破坏测试的唯一危险是套件中的 2 个测试正在生成冲突的数据。

# java - JTA 事务管理器如何在运行时部署？

> ID：11265614
> 
> 赞同：2
> 
> 时间：2012-06-29T16:32:42.293
> 
> 标签：java, transactions, jta, acid

试图绕开 JTA 并随意选择 Bitronix 作为 impl，因为文档更容易获得（与 Atmikos 不同，Atmikos 让您注册并注册才能获得 src/docs/jars/etc. ）。

如果我想使用 Bitronix 作为我的 JTA 实现（使用 Tomcat 和 GlassFish），那么它的基本架构是什么（可能只是 JTA 本身的基本架构）？**事务管理器是我连接到的实际服务器/运行时（如 JMS 代理）吗？或者这只是一个我可以在需要交易时配置和点击的 API？**

我对JTA的理解是有：

*   你的代码
*   资源管理器 - 一些符合 ACID 的持久性适配器（如数据存储或消息代理）
*   事务管理器 - 管理您的代码和资源管理器之间的事务 API 调用

Bitronix 是否只是事务管理器，如果是，它是一个单独的应用程序，一个必须与您的应用程序一起部署的单独的 JAR/WAR，还是它“嵌入”在您的应用程序中运行？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:35:42.433

它嵌入在 Tomcat 中运行，并且可以通过 JNDI 访问，就像所有其他 JTA 事务管理器一样。将 Bitronix 嵌入 Tomcat 的整个过程在[此处](http://docs.codehaus.org/display/BTM/Tomcat)进行了描述。

请注意，没有理由将 Bitronix 与 Glassfish 一起使用，因为 Glassfish 是一个全栈 Java EE 应用程序服务器，因此已经有一个 JTA 事务管理器。

# c# - 缓存实体会导致不需要的插入

> ID：11265616
> 
> 赞同：0
> 
> 时间：2012-06-29T16:32:47.573
> 
> 标签：c#, asp.net, entity-framework, entity-framework-4

如果我缓存整个表：

```
static List<Table1> table1Cache = context.Table1.ToList(); 
```

然后我用它来关联：

```
var context = new Context();
var t2 = new Table2();
t2.MyTable1Reference = table1Cache.Single(x=>x.Id == paramIntId);
context.SaveChanges(); 
```

由于第三行，将向 Table1 插入新行。EF 认为这是一个新实体。我知道我可以做一些事情，比如在创建上下文时总是附加缓存（每个请求我有 1 个上下文），或者使用 MyTable1ReferenceID = table1Cache.Single(x=>x.Id == paramIntId).Id;

但是它不安全，我有时会忘记，有一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:41:40.607

是的，这是有道理的，因为实体当前没有与当前上下文相关联。因此 EF 认为它是暂时的并保存了一个新实例。

如果您要跨上下文进行缓存，那么您不想存储对象本身。这与上下文有关。相反，您希望将数据存储在缓存中。基本上序列化和反序列化实体。您还需要在当前上下文时关联实体，以便下次从缓存中检索它时，您可以将更改保存到缓存和数据库。

如果这一切听起来很多，那就是。保持 2 个数据存储同步并不是一个容易解决的问题。我会看看 NHibernate 的二级缓存的实现。

# java - 检测 Java NumberFormat 不准确

> ID：11265618
> 
> 赞同：0
> 
> 时间：2012-06-29T16:32:53.303
> 
> 标签：java, number-formatting

我想准确地解析一个整数，一个可能根据当前语言环境格式化的整数。如果我没有准确地解析整数，我想知道它。所以我使用：

```
String string = "1111122222333334444455555";
Locale locale = Locale.getDefault();
NumberFormat numberFormat = NumberFormat.getIntegerInstance(locale);
numberFormat.setParseIntegerOnly();
Number number = numberFormat.parse(string); 
```

显然`"1111122222333334444455555"`代表一个很大的数字，比一个`Long`可以处理的大。所以`NumberFormat`给了我……一个`Double`？？

我想我会期望收到 a`BigInteger`而不是 a `Double`，尤其是因为我要求使用特定于整数的数字格式化程序。但没关系；更大的问题是我得到的双倍价值是`1.1111222223333344E24`！这不等于`1111122222333334444455555`！！

如果`NumberFormat`给我的解析值*不*等于输入字符串中存储的值，我该如何检测？

换句话说：“我怎么知道`Double`我得到的值是否`NumberFormat`与原始字符串中表示的整数值完全相等？”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:47:06.160

[javadocs](http://docs.oracle.com/javase/7/docs/api/java/text/NumberFormat.html#parse%28java.lang.String,%20java.text.ParsePosition%29) for state 如果可能，`parse()`它将返回一个 Long，否则它将返回一个 Double。因此，只需检查返回值是否为 Long。

“如果可能，返回一个 Long（例如，在 [Long.MIN_VALUE, Long.MAX_VALUE] 范围内并且没有小数），否则返回一个 Double。”

> “我怎么知道我从 NumberFormat 得到的 Double 值是否完全等于原始字符串中表示的整数值？”

如果它返回一个 Double，那么它**不**完全等于您的整数值，因为 Double 不能准确地表示该大小的值。具体例子：

```
 Number a = numberFormat.parse("-9223372036854775809"); // Integer.MIN_VALUE - 1
  Number b = numberFormat.parse("-9223372036854775810"); // Integer.MIN_VALUE - 2
  System.out.println((a.equals(b))); // prints "true"
  Number c = numberFormat.parse("-9223372036854776800");
  System.out.println((a.equals(c))); // prints "true" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:48:57.770

这可能不是解决方案，但值得注意。

```
public static void main(String[] args) {
        String string = "1111122222333334444455555";
        Locale locale = Locale.getDefault();
        NumberFormat numberFormat = NumberFormat.getIntegerInstance(locale);
        numberFormat.setParseIntegerOnly(true);
        Number number = numberFormat.parse(string);
        BigDecimal b = new BigDecimal(number.toString());
        System.out.println(b.toBigInteger());

    } 
```

此代码的输出是：`1111122222333334400000000`

如您所见，这不等于实际字符串中的数字，因此它们可能发生溢出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:50:54.730

对于你的问题 -

```
If NumberFormat gives me a parsed value that does not equal that stored in the input string, how do I detect that? 
```

您可以使用

```
 if(number.toString().equals(string))
      //Parsed correctly
   else
     //Invalid parse 
```

# c++ - c++ 带参数运行.exe文件

> ID：11265622
> 
> 赞同：1
> 
> 时间：2012-06-29T16:33:29.027
> 
> 标签：c++, exe

我试图用 c++ 运行 exe 文件但没有运气

我试过这个：

```
system("C:\\Program Files (x86)\\Counter-Strike Condition Zero 1.2 build 2771\\hl.exe"); 
```

如何使用参数运行 hl.exe？

谢谢

更新：

`'C:\Program' is not recognized as an internal or external command, operable program or batch file`我收到这个错误。

我试过`system("C:\\hl.exe");`了，效果很好。我认为问题在于空格

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T16:38:13.037

您可以通过将参数添加到 hl.exe 的末尾来运行带有参数的可执行文件，就像在命令行中一样。

```
system("C:\\Program Files (x86)\\Counter-Strike Condition Zero 1.2 build 2771\\hl.exe fullscreen"); 
```

其中 fullscreen 是运行 hl.exe 的参数。

在路径中使用空格，您可以在包含可执行路径的字符串周围加上引号：

```
system("\"C:\\Program Files (x86)\\Counter-Strike Condition Zero 1.2 build 2771\\hl.exe\" fullscreen"); 
```

# java - 需要一种 2-Way Size Reduction 散列算法

> ID：11265624
> 
> 赞同：-1
> 
> 时间：2012-06-29T16:33:38.497
> 
> 标签：java, math, networking, hash

我们有 32 位全局 ID 字符串用于识别我们系统中的对象和移动 ID 字符串，用于唯一识别我们的手机客户端。目前，移动 id 是一个手机号码，但它可能被生成为任何东西。

为了节省网络流量，我们可以将这两个字符串组合成另一个更小的字符串，我们称之为本地 id，并将该 id 而不是全局 id 传输到手机。当手机将本地 id 传回给我们时，我们将本地 id 转换回全局 id 并进行处理。本地 id 对于手机必须是唯一的，但不是全局唯一的。mobile id 已经在客户端和服务器之间共享，因此无需传输它。

我们的第一个想法是在服务器上有一组巨大的表，每个表都将全局 id 映射到给定移动 id 的本地 id。但是，如果存在一个简单的算法，我们可以做到

```
algorithm(mobileid, globalid) = localid     -----> server sends localid to client

client sends localid back to server

algorithm(mobileid, localid) = globalid 
```

这甚至可能吗？如果是这样，最好的开始方式是什么？谢谢，麻烦您了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T18:40:03.760

您需要一个本地 ID，例如：

*   您可以从中解码 Global Id
*   您可以从中解码Mobile ID

所以最简单的方法是查找表，但你已经说过你不想要那个。

您需要的不是哈希算法，而是压缩算法，因为您想再次提取相同的数据。由于您没有太多数据（32 位 + 电话号码），我认为传统的压缩算法不适合您。

引起我注意的是当你说 32-bit **strings**时，如果你有一个 32 位数字的字符串表示，你需要 10 个字符（最大无符号整数 = 4294967295），但实际上你只需要 4 个字节。和电话号码一样。如果由于您的协议，您需要将数字存储为 ascii 字符串，则可以使用 base64 编码。

# facebook - Facebook取消授权回调网址未被ping通

> ID：11265626
> 
> 赞同：2
> 
> 时间：2012-06-29T16:33:41.587
> 
> 标签：facebook

我正在使用 wamp 在 localhost 上运行 facebook 应用程序。我的应用程序在 localhost 上运行良好。我已在应用设置中指定取消授权回调 url 为

“http://localhost/MyApp/deauthorize.php”

但是当我删除该应用程序时，没有对 deauthorize.php 进行 ping 操作。我可以通过我的机器访问这个脚本。我尝试了[http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)工具，但在解析 localhost URL 时出错。是不是我不能给 localhost url 取消授权？或者如果我错过了什么。任何帮助表示赞赏。谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:06:53.463

*当然，*您不能使用 localhost 地址作为回调 URL，因为从网络上的“外面”无法知道 localhost 应该是*您的*机器。

> 我可以通过我的机器访问这个脚本。

但是 Facebook 的服务器并没有在你的机器上运行……</p>

如果您想让它用于测试，请在某处获取 DynDNS 地址，并确保您的 Web 服务器也可以从外部访问。

# sql - 为什么这两个sql的结果不同

> ID：11265627
> 
> 赞同：0
> 
> 时间：2012-06-29T16:33:46.210
> 
> 标签：sql, db2

我尝试使用以下查询更新表中的列。在这种情况下，更新了 32000 行。

```
Update Table72D012 t2 set DEFINING_ARGUMENT_ID = 
(
SELECT   t3.ID
FROM     Table70t3 t3,
         Table70t1 t1,
         Table70t0 t0,         
         Table4 t4
WHERE    t2.Model_id = t4.ID
AND      t3.ID = t1.PARAM_VALUE_BPVA_ID
AND      t3.VALUE_BPAR_ID = t0.ID
AND      t0.KEY='SPECIAL_KEY'
AND      t1.LANGUAGE='en'
AND      t4.Model = t1.name

); 
```

我想要检查结果，我使用以下查询来获取相关 ID 的计数。我得到了结果 26500 .. 为什么结果（更新计数和选择结果计数）彼此不同？
如何更正 UPDATE 查询？

只选择

```
SELECT   t3.ID
FROM     Table70t3 t3,
         Table70t1 t1,
         Table70t0 t0,
         Table72D012 t2,
         Table4 t4
WHERE    t2.Model_id = t4.ID
AND      t3.ID = t1.PARAM_VALUE_BPVA_ID
AND      t3.VALUE_BPAR_ID = t0.ID
AND      t0.KEY='SPECIAL_KEY'
AND      t1.LANGUAGE='en'
AND      t4.Model = t1.name 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:38:07.257

首先，您需要学习正确的连接语法。在 WHERE 子句中进行连接是一个坏主意。

原因很简单。第一个查询正在更新表中的非常行，因为您没有 WHERE 子句或其他条件。

第二个查询返回与查询匹配的所有行。在更新版本中，这些行将获得 NULL 值。

这是很好的语法，MS SQL 支持但 DB2 不支持：

```
Update Table72D012 t2
    set DEFINING_ARGUMENT_ID = t3.ID
    from (SELECT t4.id as t4_id, t3.ID
          FROM Table70t3 t3 join 
               Table70t1 t1
               on t3.ID = t1.PARAM_VALUE_BPVA_ID join
               Table70t0 t0
               on t3.VALUE_BPAR_ID = t0.ID join
               Table4 t4 
               on t4.Model = t1.name
          WHERE t0.KEY='SPECIAL_KEY' AND t1.LANGUAGE='en'
          ) t
    WHERE t2.Model_id = t4_ID 
```

我认为 DB2 不允许在 UPDATE 中使用 FROM 子句，因此您需要这样的内容：

```
Update Table72D012 t2
    set DEFINING_ARGUMENT_ID = 
         (SELECT t3.ID
          FROM Table70t3 t3 join 
               Table70t1 t1
               on t3.ID = t1.PARAM_VALUE_BPVA_ID join
               Table70t0 t0
               on t3.VALUE_BPAR_ID = t0.ID join
               Table4 t4 
               on t4.Model = t1.name
          WHERE t0.KEY='SPECIAL_KEY' AND t1.LANGUAGE='en' and t2.Model_id = t4.ID
          ) 
    WHERE exists              
         (SELECT t3.ID
          FROM Table70t3 t3 join 
               Table70t1 t1
               on t3.ID = t1.PARAM_VALUE_BPVA_ID join
               Table70t0 t0
               on t3.VALUE_BPAR_ID = t0.ID join
               Table4 t4 
               on t4.Model = t1.name
          WHERE t0.KEY='SPECIAL_KEY' AND t1.LANGUAGE='en' and t2.Model_id = t4.ID
          ) 
```

# android - Android 日历意图

> ID：11265629
> 
> 赞同：0
> 
> 时间：2012-06-29T16:33:59.580
> 
> 标签：android, calendar

我正在制作一个闹钟应用程序。当警报处于活动状态（由日历激活）时，此应用程序会调用意图。当闹钟或日历响起时，我想调用一个活动，即`hello.class`. 在日历调用的未决意图中提到了此类。当调用日历并且应该处理待处理的意图时，什么都不会发生。关于我做错了什么的任何想法？

我的代码如下：注释标记为“ABC”的行`hello.class`是提到的地方

```
Intent myIntent = new Intent(AndroidAlarmService.this, Hello.class); // ABC

pendingIntent = PendingIntent.getService(AndroidAlarmService.this, 0, myIntent, 0);

AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);

Calendar calendar = Calendar.getInstance();
calendar.setTimeInMillis(System.currentTimeMillis());

calendar.add(Calendar.SECOND, 5);
alarmManager.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), pendingIntent); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:47:31.993

您必须添加`FLAG_ACTIVITY_NEW_TASK`到您的意图中，因为该活动将在现有活动的上下文之外启动。

文档是这样说的。

只需添加

```
myIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
```

以下`Intent myIntent = new Intent...`

并更改`PendingIntent.getService(...)`为`PendingIntent.getActivity(...)`

# java - 如何运行和编译java程序？

> ID：11265630
> 
> 赞同：1
> 
> 时间：2012-06-29T16:34:02.437
> 
> 标签：java, compilation

我正在编译一个简单的程序

```
class Test {
     public static void main(String[] args) {
        System.out.println("Hello");
     }
} 
```

我在命令提示符下输入了 java Test.java 但它不起作用

```
Could not find or load main class Test.java 
```

我没有使用任何 IDE

我应该将程序文件放在我的电脑上的哪个位置

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T16:35:45.973

您不能直接运行 java 源文件。您需要先使用以下命令编译它`javac`：

```
javac Test.java 
```

然后你会得到一个可以运行的 .class 文件：

```
java Test 
```

# .net - exception.ToString() 不返回任何信息

> ID：11265633
> 
> 赞同：1
> 
> 时间：2012-06-29T16:34:15.563
> 
> 标签：.net, exception

我在生产中有一个例外，它没有产生任何日志内容。我们在这个 catch 块中记录了正常的生产错误，但是由于某种原因，这个特殊的异常（我不知道它是什么）没有记录任何东西。这是 catch 块：

```
//catch any exception and add it to the list of exceptions, and process next id
catch (Exception e)
{
    if (exceptionMessageBuilder.Length != 0)
    {
        exceptionMessageBuilder.AppendLine("----------------------------------------");
    }
    exceptionMessageBuilder.AppendFormat("Error occurred in processing id {0}.\n", currentID);
    exceptionMessageBuilder.AppendLine(e.ToString());
} 
```

我得到的唯一输出是“处理 id d455e51f-6c86-4591-b75e-a2d29be73f4c 时发生错误。” 应用程序完成并将其作为电子邮件发送，因此它不会完全轰炸。

通常我会收到如下消息：

```
Error occurred in processing id 593abf56-5057-400e-bbfb-da819df59710.
System.ServiceModel.FaultException: The communication object, System.ServiceModel.Channels.ServiceChannel, cannot be used for communication because it is in the Faulted state.

Server stack trace:
   at System.ServiceModel.Channels.ServiceChannel.HandleReply(ProxyOperationRuntime operation, ProxyRpc& rpc)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs)
   at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
   at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) 
```

有什么理由我不会得到信息？是否可以捕获空异常？

# iphone - 无法从 ios 5 在 sqlite 中插入数据

> ID：11265636
> 
> 赞同：2
> 
> 时间：2012-06-29T16:34:22.903
> 
> 标签：iphone, ios, sqlite, ios5

我正在尝试插入一些数据 sqlite 数据库...我确信插入查询是正确的，因为我从终端和 sqlite 管理器测试了它，但它不是从 ios5 插入的...请帮助！！！

```
-(BOOL)insertWithRawQuery:(NSString*) query
{
        sqlite3_stmt    *statement;
        BOOL success = NO;
        if (sqlite3_open([databaseFilePath UTF8String], &database) == SQLITE_OK)
        {
            NSLog(@"%@",query);
            const char *insert_stmt = [query UTF8String];

            sqlite3_prepare_v2(database, insert_stmt, -1, &statement, NULL);
            if (sqlite3_step(statement) == SQLITE_DONE)
            {
                success=YES;
            } else 
            {
                success=NO;
                NSLog(@"%d",sqlite3_step(statement));
            }
            sqlite3_finalize(statement);
       }
         sqlite3_close(database);
        return success;
}

    NSLog(@"%d",sqlite3_step(statement)) 
```

打印 21 这是 SQLITE_MISUSE ..你知道吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T17:06:31.377

这就是我在 iOS 5 中将数据插入 sqlite 的方式，它工作正常。

```
-(void) checkAndCreateDatabase{
    BOOL success;
    NSFileManager *fileManager = [NSFileManager defaultManager];
    success = [fileManager fileExistsAtPath:databasePath];
    if(success) return;
    NSString *databasePathFromApp = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:databaseName];
    [fileManager copyItemAtPath:databasePathFromApp toPath:databasePath error:nil];
}

-(void) openDatabase
{   
    NSArray *documentsPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentDir = [documentsPaths objectAtIndex:0];   
    databasePath = [documentDir stringByAppendingPathComponent:YOUR_DATABASE_NAME];
    [self checkAndCreateDatabase];  
    if(sqlite3_open([databasePath UTF8String],&database) == SQLITE_OK)
        NSLog(@"Database opened.");
}

-(BOOL)insertDataWithUsername:(NSString*)name withPassword:(NSString*)password withAge:(int)age
{
    [self openDatabase];
    NSString *query = nil;
    query = [NSString stringWithFormat:@"INSERT INTO your_table(name, password, age) Values('%@','%@', %d)", name, password, age];

    sqlite3_stmt *compiledStatement;
    if(sqlite3_prepare_v2(database, [query UTF8String], -1, &compiledStatement, NULL) == SQLITE_OK) 
    {   
        if(SQLITE_DONE != sqlite3_step(compiledStatement))
            NSLog( @"Error while inserting data: '%s'", sqlite3_errmsg(database));
        else NSLog(@"New data inserted");

        sqlite3_reset(compiledStatement);       
    }else
    {
        NSLog( @"Error while inserting '%s'", sqlite3_errmsg(database));
    }
    sqlite3_finalize(compiledStatement);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T19:40:00.287

我认为作为参数发送的查询是问题的根源。查询构造可能使用了一些自动释放的变量或其他东西。请使用 XCode->Product Tab-> profile-> 选择 NSZombie-> 并运行程序检查是否有任何用于构造查询的对象被自动释放。

# hibernate - Jpa Group By Query 返回映射 >

> ID：11265640
> 
> 赞同：0
> 
> 时间：2012-06-29T16:34:49.190
> 
> 标签：hibernate, jpa, eclipselink

你好。

我正在尝试在以下场景中使用 EclipseLink JPA 通过查询来完成创建组：

emum BeanType
类 BeanParam { id, beanType, @ManyToOne 参数 }

枚举 ParamType
类 Param { id, name, paramType, foo, bar }

我希望通过 BeanType 查询 <ParamType, List<Param>> 的 Map，这意味着附加到该 BeanType 的参数按其 paramTypes 分组。

你们将如何进行这项工作？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:30:43.653

我将首先执行一个 JPQL 查询：

```
select distinct param from BeanParam beanParam
inner join beanParam.param param
where beanParam.beanType = :beanType 
```

然后我将遍历`List<Param>`返回的，并按 paramType 对它们进行分组。使用番石榴，它将是：

```
ListMultimap<ParamType, Param> m = ArrayListMultimap.create();
for (Param param : params) {
    m.put(param.getParamType(), param);
} 
```

# java - 找不到 Tools.jar

> ID：11265647
> 
> 赞同：5
> 
> 时间：2012-06-29T16:35:21.187
> 
> 标签：java, ant

我正在尝试构建 JOGL 的副本

但蚂蚁一直给我错误找不到tools.jar。

所以我在我的 JDK 目录中搜索，我也找不到它。有人可以帮我定位 tools.jar

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:38:46.550

您确定要搜索*JDK*目录而不是*JRE*目录吗？我希望它位于 JDK`lib`目录中。例如，在我的机器上，我有：

```
c:\Program Files\Java\jdk1.6.0_26\lib\tools.jar 
```

如果 Ant 找不到它，请确保您运行的是 JDK 目录中的 Java 版本，而不是 JRE 目录中的版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T16:41:42.490

我认为您的 JAVA_HOME 指向 JRE 而不是 JDK。

tools.jar 存在于 lib 文件夹中 - [http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/jdkfiles.html](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/jdkfiles.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-15T17:10:24.970

请检查您的环境变量： JAVA_HOME 和 CLASSPATH 应该指向 JDK 而不是 JRE

例如。

JAVA_HOME：C:\Program Files\Java\jdk1.6.0_25；

类路径：C:\Program Files\Java\jdk1.6.0_25\lib；

并且路径应该指向 JDK bin

C:\Program Files\Java\jdk1.6.0_25\bin;

# algorithm - 如何在二维数组上随机生成布局？

> ID：11265650
> 
> 赞同：4
> 
> 时间：2012-06-29T16:35:31.367
> 
> 标签：algorithm, layout, knapsack-problem

我有一个预定大小的二维数组和一个适合该空间的编号矩形列表。这些矩形中的每一个都具有已知的固定高度和宽度。保证 2D 阵列足够大以舒适地适应所有矩形。

我需要将这些矩形中的每一个随机放置到数组中，以便没有重叠并且全部放置。它们可以放置在任何方向。想象一下，将您的船只置于战舰游戏中，只是拥有更多不同的船只尺寸和更大的网格。

完成后的数组应该是这样的：（0代表一个空格，一个非零数字代表一个矩形数字）

0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 **1 1** 0 0 0 0 0 0 0 0 0 **4 4 4** 0
0 **1 1** 0 **2 2 2 2** 0 0 0 **4 4 4** 0
0 **1 1** 0 **2 2 2 2 2** 0 0 0 0 0 0 0 0
0 0 0 **2 2 2 2** 0 0 0 0 0 0 0 0
0 0 0 **2 2 2 2 2** 0 **5 5** 0 0 0 0
0 **3 3 3 3 3** 0 0 0 0 **5 5** 0 0 0 0
0 **3 3 3 3 3** 0 **7 7 7 5 5 6 6** 0 0
0 0 0 0 0 0 0 **7 7 7 5 5 6 6** 0 0

我考虑过的一种方法是为每个矩形选择一个随机的位置和方向，尝试将其放置在矩阵中。如果检测到与先前放置的块发生冲突，请重试。这可能是最简单的实现，但它似乎不是很有效，并且它不会以明确确定的方式终止（列表末尾附近的矩形可能会在很长一段时间内与先前生成的块发生冲突）。

有没有更好的方法来解决这个问题，放置后面的矩形不会那么成问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:40:13.137

IMO 问题降级为问题 - “我们是否有足够的空间来容纳下一个矩形以及如何以有效的方式找到这个地方？” 所以：

1.  初始条件 - 我们在“可用矩形列表”中有 1 个可用矩形（初始矩阵），基本上我们只需要存储空闲矩形的高度和重量以及初始矩阵的左上角位置
2.  选择要添加的随机矩形 =“toAdd”，将其从“添加矩形列表”中删除
3.  随机选择等于或大于“toAdd”=“available”的空闲可用矩形，将其从“可用矩形列表”中删除，如果没有可用矩形转到步骤2
4.  选择“可用”上的随机位置以在其上添加“toAdd”矩形
5.  剪切“可用”矩形以减去“toAdd”。此处可以应用不同的切割策略，但最后您最多可以获得 4 个新的可用矩形
6.  将新的可用矩形添加到“可用矩形列表”
7.  转到第 2 步

算法不是最优的，因为在理想世界中，我们应该在第 6 步连接 2 个可用的邻居。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:21:15.393

以下方法：

*   ~~找出你的最小尺寸是多少。计算一个小于此尺寸但可多次放入您的盒子的尺寸。例如：最小尺寸为 7 厘米/英寸，盒子为 120 厘米/英寸。选择 120/20 = 6 厘米/英寸。我希望您的问题足够小，因为您会将所有可能的坐标存储在一个列表中。在这种情况下，我们有 20x20 = 400 个坐标。~~

*   为保证不可能阻塞整个区域，请选择最小维度 (x,y) 大于或等于矩形最大维度的~~双~~四倍的矩阵（例如，矩形的最大长度 = 8，x 和 y必须至少有 32)，并且矩阵的整个区域至少有一个区域是所有插入元素的两倍。

*   放置选择：使用随机数发生器随机选择一个坐标。将矩形放在给定坐标上，并选择随机方向。尝试将矩形设置到框中，如果它不适合首先，旋转它。如果仍然不合适，请尝试下一个坐标。

*   如果它最终适合，请从列表中删除与矩形重叠的所有坐标。因此，您只为其他矩形选择有效坐标。

*   随机化：不要使用线性同余生成器（不幸的是，它是大多数编程语言的任务标准）。它们具有不良的多维特征。使用安全随机、硬件生成器或已知良好的生成器，例如 MersenneTwister。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:43:54.050

This problem is pretty much exactly the same as roguelike dungeon map generation. There are a ton of approaches to this with different looks.

I would suggest the BSP tree approach from here ( the steps are simple ): [http://www.futuregadgetlab.com/proceduraldungeon/](http://www.futuregadgetlab.com/proceduraldungeon/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T22:54:29.767

您可以简化计算并从旋转的一些限制开始，然后您可以使用 kd-tree。一个很好的例子是 jquery masonry 插件或 jquery treemap 算法。这个想法是在某处放置一个矩形，并将 x 指向树的左侧，y 指向树的右侧。

# php - PHP 高级安全会话类

> ID：11265651
> 
> 赞同：1
> 
> 时间：2012-06-29T16:35:44.163
> 
> 标签：php, mysql, security, session, login

在实习中，我正在学习一个非常好的教程，为购物车制作高级 PHP 安全会话，这将为用户提供个人级别的定价（无论如何，这就是目标。）

这是教程： [http ://tutorial-resource.com/2011/10/a-secure-session-management-class-in-php/](http://tutorial-resource.com/2011/10/a-secure-session-management-class-in-php/)

首先，为了测试这个会话，我创建了一个基于 Quickbooks 客户 ID 检查现有客户的原始登录。真正的处理使用注册、登录名和密码。然后我做了一个登录检查器，在 mysql 数据库中找到用户，找到后，逐页检索需要与用户保持一致的用户数据列。（我保证在我得到这个工作之后我会进一步防止 SQL 注入。）我添加了一些额外的字段来存储在 SessionData 中。

```
<?php
    include "class.session.php";

    if(empty($_POST['customer_id']))
    {
        $this->HandleError("Customer ID is empty!");
        return false;
    }

    $customer_id = trim($_POST['customer_id']);
    $dbuser = "CENSORED";
    $dbpass = "CENSORED";
    $host = "localhost";
    $dbname = "CENSORED";

// database connection 
mysql_connect("localhost", $dbuser, $dbpass) or die(mysql_error());
mysql_select_db($dbname) or die("Unable to select database");

//This query grabs all the puchases going back up to three months
//This debug line displays the query
$query = "SELECT * FROM customers";
echo $query."<br>";

$found = 0;
$result = mysql_query($query);
while($row=mysql_fetch_array($result))
{
    //Grab the database pieces the customer will need throughout the page.
    echo "Checking customer number ".$row['customer_id']."<br>";
    if ($row['customer_id'] == $customer_id)
    {
        $found = 1;
        break;
    }

}

//-create while loop and loop through result set
if ($found == 0)
{
    echo 'Wrong customer number';
}

while($row=mysql_fetch_array($result))
{
    //Grab the database pieces the customer will need throughout the page.
    $customer_id = $row['customer_id'];
    $first_name = $row['first_name'];
    $last_name = $row['last_name'];
    $first_name = $row['price_level'];
}

//Give the user a session.
$sessions = new sessionsClass;
$sessions->_sessionStart();

$sessionInfo = $sessions->sessionCheck();

if( $sessionInfo = false )
{
      # This session is invalid. Tell the user.
}
else
{
      # Update the name.
      $sessionInfo->sessionData['customer_id'] = $customer_id;
      $sessionInfo->sessionData['company_name'] = $company_name;
      $sessionInfo->sessionData['first_name'] = $first_name;
      $sessionInfo->sessionData['last_name'] = $last_name;
      $sessionInfo->sessionData['price_level'] = $price_level;
      $sessionInfo->setSessionData();
      # Session is valid, can use the data.
      echo "Your name is ".$sessionInfo->sessionData['first_name']." ".$sessionInfo->sessionData['last_name']."<br>";
}

?> 
```

成功登录后，我在 error_log 中看到一个错误，上面写着“调用未定义的方法 stdClass::setSessionData()”，当函数明显存在时，直接从教程中出来：$sessionInfo->setSessionData();

为什么登录不能将 setSessionData 识别为未定义的方法而不是函数？
我不完全理解的一个线索是，它将 setSessionData 称为“未定义的方法 stdClass”，而不是“未定义的函数”。该功能与教程非常相似，只是它连接到我的数据库：

```
public function setSessionData()
{
    $dbuser = "CENSORED";
    $dbpass = "CENSORED";
    $host = "localhost";
    $dbname = "CENSORED";

    // database connection 
    mysql_connect("localhost", $dbuser, $dbpass) or die(mysql_error());
    mysql_select_db($dbname) or die("Unable to select database");
    //Encrypt the data.
      $serialiseData = serialize( $this->sessionData );
    //Update the session data.
      mysql_query( "UPDATE sessions SET sessionData = '{$serialiseData}' WHERE sessionHash = '{$this->sessionHash}'" );

} 
```

我的最后一个问题是，每个单独的页面需要什么才能安全地区分普通用户和登录用户，无论是哪个页面？是这样的吗？

```
if (sessionCheck == false)
{show ordinary stuff}
else if (sessionCheck == return true)
{show personalized stuff} 
```

编辑本教程毕竟似乎有一些问题。例如，在教程接近尾声时。

```
# Session is valid, can use the data.
      echo "Your name is " . $sessionInfo->sessionData['fullname'];

      # Update the name.
      $sessionInfo->sessionData['fullname'] = "My New name";

      $sessionInfo->setSessionData();
} 
```

这是错误的，因为 sessionInfo 是一个布尔值，旨在为 false 返回 true。相反，我将其替换为

```
$sessions->sessionData['customer_id'] = $customer_id;
$sessions->sessionData['company_name'] = $company_name;
$sessions->sessionData['first_name'] = $first_name;
$sessions->sessionData['last_name'] = $last_name;
$sessions->sessionData['price_level'] = $price_level;
$sessions->setSessionData(); 
```

但这仍然没有奏效。此外，本教程让人们创建了一个完整的 MySQL 数据库，但在课堂或教程中的任何地方都没有发生任何一次 INSERT。对现有会话进行 UPDATE 查询的功能是存在的，但没有用于创建新会话的功能。我可以添加什么来使数据库成功创建会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:03:20.177

`stdClass`如果在反序列化期间找不到类，则将转换为序列化对象。我的猜测是，当您从数据库中读取会话信息并尝试将其放回`sessionClass`对象时，您还没有包含定义该类的文件。*确保在反序列化之前*定义了类。

由于`stdClass`没有调用方法`setSessionData`，因此您会收到“调用未定义方法”错误。方法是通常用来指代类中的函数的术语，而函数只是一个独立的函数定义。

为了在每个页面上区分登录用户和普通用户，您通常需要启动会话并检查向您指示用户已通过身份验证的应用程序特定值。这可以像`loggedIn`在会话中设置一个标志一样简单，或者存储一个更复杂的类型并检查它的值。但基本上，您需要在从登录用户中了解普通用户所需的每个页面上执行此操作。

希望有帮助。

`$this->HandleError("Customer ID is empty!");`顺便说一句，如果您在代码开头调用，如果该块执行，您将收到一个错误，说`$this`未定义。由于没有在类中调用该代码，因此没有实例，`$this`因此您必须找出处理该错误的正确方法。

# xml - 如何在perl中将表示为缩进树的多行文本转换为xml？

> ID：11265652
> 
> 赞同：2
> 
> 时间：2012-06-29T16:35:43.940
> 
> 标签：xml, perl, tree

例如，输入是

```
 root
    ^^aa
    ^^^^bb
    ^^cc
    ^^dd 
```

两个 ^^ 代表一个缩进，因此 aa 是 root 的孩子，bb 是 aa 的孩子。
aa,cc 和 dd 是兄弟，他们都是 root 的孩子。

输出是一个 xml 文件，它的内容是

```
<?xml version='1.0'?>
<dir name="root">
  <dir name="aa">
    <dir name="bb" />
  </dir>
  <dir name="cc" />
  <dir name="dd" />
</dir> 
```

但我找不到合适的 perl 脚本来解决这个问题。
所以寻求帮助，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:06:50.883

您也可以使用[XML::LibXML](https://metacpan.org/module/XML%3a%3aLibXML)来完成此任务。您只需要通过这种方式了解上一个级别和上一个元素：

```
use XML::LibXML;

my $doc = XML::LibXML::Document->new();
my $previousLevel = 0;
my $previousElement;

foreach my $line (@data) {
    if($line =~ m/^(\^*)(.+)$/) {
        my $level = (length $1) / 2;
        my $name = $2;

        my $dir = $doc->createElement('dir');
        $dir->setAttribute('name', $name);

        if($level == 0) {
            $doc->setDocumentElement($dir);
        }
        elsif($level > $previousLevel) {
            $previousElement->addChild($dir);
        }
        elsif($level < $previousLevel) {
            $previousElement = $previousElement->parentNode()
               for ($level .. $previousLevel -1);
            $previousElement->addSibling($dir);
        }
        elsif($level == $previousLevel) {
            $previousElement->addSibling($dir);
        }

        $previousElement = $dir;
        $previousLevel = $level;
    }
}

print $doc->toString(2); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T18:30:24.093

通过比较当前节点的深度和前一个节点的深度，您可以获得所需的所有信息。

```
my $last_depth = -1;
while (@input) {
   my $name = shift(@input);

   my $depth = 0;
   ++$depth while $name =~ s/^\^\^//;

   while ($depth <= $last_depth) {
      end_dir($last_depth);
      --$last_depth;
   }

   die if $depth != $last_depth + 1;

   start_dir($depth, $name);
   ++$last_depth;
}

while ($last_depth > -1) {
   end_dir($last_depth);
   --$last_depth;
} 
```

程序的其余部分

```
my %escapes = (
   '&' => '&amp;',
   '<' => '&lt;',
   '>' => '&gt;',
   '"' => '&quot;',
   "'" => '&apos;',
);

sub text_to_xml {
   my ($s) = @_;
   $s =~ s/([&<>'"])/$escapes{$1}/g;
   return $s;
}

sub start_dir { print(('  ' x $_[0]) . qq{<dir name="}.text_to_xml($_[1]).qq{">\n}); }
sub end_dir   { print(('  ' x $_[0]) . qq{</dir>\n}); }

my @input = split /\n/, <<'__EOI__';
root
^^aa
^^^^bb
^^cc
^^dd
__EOI__

binmode(STDOUT, ':encoding(UTF-8)');
print(qq{<?xml version="1.0"?>\n}); 
```

# c# - 在 C# 中创建计算器，需要帮助实现数学逻辑/其他东西

> ID：11265656
> 
> 赞同：1
> 
> 时间：2012-06-29T16:35:54.617
> 
> 标签：c#, c#-4.0

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        bool plus;
        bool minus;
        bool multiply;
        bool divide;

        private void button0_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "0";
        }

        private void button1_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "1";
        }

        private void button2_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "2";
        }

        private void button3_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "3";
        }

        private void button4_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "4";
        }

        private void button5_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "5";
        }

        private void button6_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "6";
        }

        private void button7_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "7";
        }

        private void button8_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "8";
        }

        private void button9_Click(object sender, EventArgs e)
        {
            textBox1.Text = textBox1.Text + "9";
        }

        private void buttonPlus_Click(object sender, EventArgs e)
        {
            if (textBox1.Text == "")
                return;
            else
            {
                plus = true;
                textBox1.Text = textBox1.Text + " + ";
            }
        }

        private void buttonDivide_Click(object sender, EventArgs e)
        {
            if (textBox1.Text == "")
                return;
            else
            {
                divide = true;
                textBox1.Text = textBox1.Text + " / ";
            }
        }

        private void buttonMinus_Click(object sender, EventArgs e)
        {
            if (textBox1.Text == "")
                return;
            else
            {
                minus = true;
                textBox1.Text = textBox1.Text + " - ";
            }
        }

        private void buttonMultiply_Click(object sender, EventArgs e)
        {
            if (textBox1.Text == "")
                return;
            else
            {
                multiply = true;
                textBox1.Text = textBox1.Text + " * ";
            }
        }

        private void buttonClear_Click(object sender, EventArgs e)
        {
            textBox1.Text = string.Empty;
        }

        private void buttonEquals_Click(object sender, EventArgs e)
        {
            if (plus)
            {

            }

            if (minus)
            {

            }

            if (multiply)
            {

            }

            if (divide)
            {

            }
        }

    }
} 
```

我坚持的部分是在我按下数学按钮（+、-、/、*）之后。我只想在文本框中显示一个字符，除非我按另一个数字。

示例：现在，这就是发生的事情：87 + + + + + + +

我想要 87 + 并且我想要它，如果用户添加另一个数字，我可以添加另一个，比如 87 + 87 + 等。

另外，在添加数学逻辑时，我需要一点指导。

我正在考虑以某种方式将字符串中的任何内容存储在变量中的数学符号之前，然后对进行数学符号的数字执行相同的操作。这很好还是有更简单/不太复杂的方法来完成这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:44:35.093

我相信，使用[状态](http://en.wikipedia.org/wiki/Finite-state_machine)来确定计算器的“时刻”，而不是测试字符串等，是使用计算器的好方法。让我们考虑一些状态：

*   **NotInitialized**：只接受数字。当给出第一个数字时，计算器转到**接收**
*   **接收**：将连接更多数字。任何操作员都会将计算器带到**NextNumber**
*   **NextNumber** : 只接受数字。当给出第一个数字时，计算器转到**接收**

然后它就走了。试着弄清楚描述计算器操作的状态是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:51:45.453

对于 +-*\ 情况。我建议使用像 lastCharIsSymbol 这样的布尔属性。每当您单击一个数字时，将其设置为假，当您单击一个符号时，将其设置为真。然后你可以在你的符号点击事件中添加一个 if 语句来只添加符号 IF lastCharIsSymbol = false。

```
public Boolean lastCharIsSymbol {get;set;}

private void button9_Click(object sender, EventArgs e)
{
    textBox1.Text = textBox1.Text + "9";
    lastCharIsSymbol = false;
}

private void buttonPlus_Click(object sender, EventArgs e)
{
    if (textBox1.Text == "" || lastCharIsSymbol)
        return;
    else
    {
        plus = true;
        textBox1.Text = textBox1.Text + " + ";
        lastCharIsSymbol = true;
    }
} 
```

如果您不想这样做，您也可以更改您的 if 语句以仅获取文本框中任何内容的子字符串并找出最后一个字符是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T17:02:28.150

虽然您可以简单地写入一个字符串，然后在用户按下 equals 时从那里解析它，但创建他们输入的内容的集合可能更有益。然后，当用户输入内容时，您可以确保他们不会将 2 个数字并排放置或 2 个运算符并排放置。例如，即使您只是在做一个简单的计算器，您也可以处理负数和多位数字。我会这样做，以便可以输入数字，并在按下操作员时，将数字和操作员提交到列表中。如果运算符是等号键，则迭代列表并执行计算。

一个例子是当前的 windows 计算器。您会注意到有 2 个文本框。一个给出当前的工作数字，而另一个给出整个方程。

这是一个例子。有更好的方法可以解决这个问题，但为了简单起见，可以为您指明正确的方向，这应该可行。

```
 List<object> calculatorChain = new List<object>();

    /// <summary>
    /// Handles the button press for the minus key
    /// </summary>
    /// <param name="sender">The originating object</param>
    /// <param name="e">Event arguments</param>
    private void buttonMinus_Click(object sender, EventArgs e)
    {
        CommitOperand(textBox1.Text, "-");
        textBox1.Text = string.Empty;
    }

    /// <summary>
    /// Commits the current working number to the calculator chain with a given operator
    /// </summary>
    /// <param name="operand">The current working number to add</param>
    /// <param name="operation">The operation to perform</param>
    private void CommitOperand(string operand, string operation)
    {
        if (string.IsNullOrWhiteSpace(operand) || string.IsNullOrWhiteSpace(operation))
        {
            return;
        }
        else
        {
            decimal number;
            if (decimal.TryParse(operand, out number))
            {
                calculatorChain.Add(number);
                calculatorChain.Add(operation);
            }
        }
    } 
```

# php - 使用 POST 捕获动态变量

> ID：11265659
> 
> 赞同：1
> 
> 时间：2012-06-29T16:36:01.513
> 
> 标签：php

我写了两个文件`main.php`和`download.php`.

**主文件**

```
echo"<form action='download.php' method='post'>"
for(i = 0; i < 10; i++){
    echo"<input type='submit' name='$i'>";
} 
```

在`download.php`，我想知道按下了哪个名字的按钮？（从1到10下载文件），这样我就可以在download.php中使用它来下载文件了。

我曾尝试使用 $_POST["$i"] 但失败了。

如果 $i 是随机文件名怎么办？

谢谢！

完整代码

main.php:http://codepad.org/4zXPhqFy

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:37:37.673

`$_POST`通过`$key => $value`循环访问。排除您知道名称的其他值（如果您有其他值）。

```
foreach ($_POST as $key => $value) {
  // Look for form keys not among other known ones
  if (!in_array($key, array('other','known','input','names')) {
    echo "You clicked $key";
  }
} 
```

或者，使用`ctype_digit()`post 键来确定它是否为数字，不包括您可能拥有的任何其他字符串键。

```
foreach ($_POST as $key => $val) {
  if (ctype_digit($key)) {
    echo "You clicked $key";
    // Access it via $_POST[$key]
  }
} 
```

请注意，除非您使用的是 HTML5，否则`name`属性必须以字母开头，而不是数字。如果您使用的是 HTML5，则在`name`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:46:12.063

首先，您应该以字母而不是数字开头提交的名称。如果你想要从 1 到 10 的按钮，你`$i`必须从 1 开始，而不是 0。

尝试这样做：

**主文件**

```
echo '<form action="download.php" method="post">';

for( $i = 1; $i <= 10; $i++){
    echo '<input type="submit" name="button[' . $i . ']" value="Send" />';
} 
```

回声''

**下载.php**

```
if( isset($_POST['button']) )
{
    $button = key($_POST['button']);

    echo 'Button ' . $button . ' was clicked';
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T17:18:27.403

这是另一个解决方案

构建按钮

```
for( $i = 1; $i <= 10; $i++){
  echo '<input type="submit" name="button[' .  chr($i+64) . ']"/>';
} 
```

我做了 chr，这样你就可以看到它可以是任何文本

找出被按下的

```
echo 'button ' . key($_POST['button']) . ' was pressed'; 
```

这种方式的优点是您不需要循环来找出按下的按钮

# dojo - 如何从增强网格的间接选择插件中取消选中复选框

> ID：11265665
> 
> 赞同：0
> 
> 时间：2012-06-29T16:36:41.247
> 
> 标签：dojo

我使用EnhancedGrid 的indirectSelection 插件来实现一个表。表格中有一列复选框。

用户可以选中复选框并通过单击页面上的按钮来执行某些操作。

但是当用户使用EnhancedGrid 的indirectSelection 插件返回主页面时，该复选框仍处于选中状态。

您能否告诉我如何使用 EnhancedGrid 的indirectSelection 插件刷新 UI，并确保当用户单击链接返回主页时未选中任何复选框？

```
 var mygrid = new dojox.grid.EnhancedGrid({
        id: "id",
        store: store,
        autowidth:"true", 
        rowselector:"15px",
        plugins: {indirectSelection: {headerSelector:true, width:"80px", styles:"text-align: center;"}},            
        keepRows: "30",
        rowsPerPage: "10",
        style:"height:300px",
        structure: layout},"mygridContainer");  
    mygrid.startup();
    dojo.connect(mygrid, "onApplyEdit", function(row){
        store.save();
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T23:47:38.407

尝试这个：

```
dojo.connect(mygrid, "onApplyEdit", function(row){
    store.save();
    mygrid.update();
}); 
```

# android - 在双闪屏期间取消 AsyncTask 时 Android 2.2 黑屏

> ID：11265666
> 
> 赞同：1
> 
> 时间：2012-06-29T16:36:41.303
> 
> 标签：android, eclipse, asynchronous, android-emulator, android-2.2-froyo

我有一个两部分的初始屏幕，我一直在尝试在 Android 2.2（eclipse 模拟器）上工作，一切都在 2.3 模拟器中工作。在 2.2 中，它的工作频率更高——有时会黑屏——有时我需要重新启动模拟器。如果我尝试单击屏幕以取消启动并直接进入主要活动，它将进入黑屏并在日志中看到：

```
06-29 12:23:54.474: I/ActivityManager(58): Starting activity: Intent { cmp=org.test.game/.MainActivity }
06-29 12:23:54.494: W/System.err(278): java.lang.InterruptedException
06-29 12:23:54.504: D/qemud(37): fdhandler_accept_event: accepting on fd 10
06-29 12:23:54.504: D/qemud(37): created client 0x17fe8 listening on fd 15
06-29 12:23:54.504: D/qemud(37): client_fd_receive: attempting registration for service 'sensors'
06-29 12:23:54.504: D/qemud(37): client_fd_receive:    -> received channel id 11
06-29 12:23:54.514: D/qemud(37): client_registration: registration succeeded for client 11
06-29 12:23:54.524: D/qemud(37): fdhandler_accept_event: accepting on fd 10
06-29 12:23:54.524: D/qemud(37): created client 0x18038 listening on fd 16
06-29 12:23:54.524: D/qemud(37): fdhandler_event: disconnect on fd 15
06-29 12:23:54.544: W/System.err(278):  at java.lang.VMThread.sleep(Native Method)
06-29 12:23:54.554: W/System.err(278):  at java.lang.Thread.sleep(Thread.java:1306)
06-29 12:23:54.554: W/System.err(278):  at java.lang.Thread.sleep(Thread.java:1286)
06-29 12:23:54.564: W/System.err(278):  at org.test.game.Splash$SplashScreenDelay.doInBackground(Splash.java:121)
06-29 12:23:54.574: W/System.err(278):  at org.test.game.Splash$SplashScreenDelay.doInBackground(Splash.java:1)
06-29 12:23:54.584: W/System.err(278):  at android.os.AsyncTask$2.call(AsyncTask.java:185)
06-29 12:23:54.594: W/System.err(278):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
06-29 12:23:54.604: W/System.err(278):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
06-29 12:23:54.604: W/System.err(278):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
06-29 12:23:54.614: W/System.err(278):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
06-29 12:23:54.624: W/System.err(278):  at java.lang.Thread.run(Thread.java:1096)
06-29 12:24:04.475: W/ActivityManager(58): Launch timeout has expired, giving up wake lock!
06-29 12:24:04.484: W/ActivityManager(58): Activity idle timeout for HistoryRecord{44eca1f8 org.test.game/.MainActivity}
06-29 12:24:14.494: W/ActivityManager(58): Activity destroy timeout for HistoryRecord{44ebb9b0 org.test.game/.Splash} 
```

灵感来自[http://webgarbage.de/splash-screen-on-android.html](http://webgarbage.de/splash-screen-on-android.html)

```
import android.app.Activity;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MotionEvent;
import android.widget.ImageView;

public class Splash extends Activity {

    private AsyncTask splashDelay;
    private ImageView ivSplash;
    private int splashCount = 0;
    private int splashTime = 2;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.splashscreen);
        ivSplash = (ImageView) findViewById(R.id.IVSplash);
        splashDelay = new SplashScreenDelay().execute(splashTime);
    }

    //Touch screen to skip splash
    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            splashDelay.cancel(true);
        }
        return true;
    }

    private class SplashScreenDelay extends AsyncTask<Integer, Integer, Integer> {

        @Override
        protected Integer doInBackground(Integer... params) {
            try {
                int count = 0;
                while (count < params[0]*10) {
                    if(count % 10 == 0) { 
                        Log.v("Splash", "Sleeping... " + count/10); 
                    }
                    Thread.sleep(100);
                    count++;
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            return new Integer(0);
        }

        @Override
        protected void onPostExecute(Integer result) {
            if (splashCount == 0) {
                splashCount = 1;
                ivSplash.setBackgroundResource(R.drawable.splash2);
                splashDelay = new SplashScreenDelay().execute(splashTime); 
            }
            else 
                startActivity(new Intent(getApplicationContext(), MainActivity.class));
        }

        protected void onCancelled() {
            startActivity(new Intent(getApplicationContext(), MainActivity.class));
        }
    }
} 
```

有什么建议吗？是什么使飞溅的取消导致黑屏？我读过当 MainActivity 必须等待太长时间时出现“启动超时已过期”错误，但是如果启动工作中断（更多时间），为什么在取消（更少时间）时它会失败？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T17:24:29.320

异步任务不太适合在初始屏幕上设置计时器。更合适的方法是使用[Handler](http://developer.android.com/reference/android/os/Handler.html)和 sendDelayed 来延迟启动画面。

# python - 串联的两个时间间隔之间的差异

> ID：11265670
> 
> 赞同：2
> 
> 时间：2012-06-29T16:37:00.343
> 
> 标签：python, time

可以说我有一段时间，例如 10 分钟。我定义了开始时间和结束时间。

例如，开始时间是上午 10 点，结束时间是下午 2 点。

我需要的时间间隔

```
10-10.10 , 10.10 - 10.20 , .. , 10.50-11 etc., 
```

存储在数据库中。

这是我的想法。

```
from datetime import datetime
time1 = '10:00'
time2 = '10.10' 
format = '%H:%M'
obj1 = datetime.strptime(time1, format) - datetime.strptime(time2, format) 
```

这对于两个已知的间隔是可以的。两个未知的时间间隔，然后将它们存储在数据库中呢？

我该如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:11:05.840

只需在数据库中存储持续时间、开始和结束时间。您总是可以稍后生成时间间隔：

```
def time_range(start, end, duration):
    dt = start
    while dt < end: #note: `end` is not included in the range
        yield dt
        dt += duration 
```

### 例子

```
from datetime import datetime, timedelta

# dummy data
duration = timedelta(minutes=10)
start = datetime.utcnow()
end = start + timedelta(hours=16)

# use list instead of tee(), islice() for simplicity 
lst = [dt.strftime('%H:%M') for dt in time_range(start, end, duration)] 
for interval in zip(lst, lst[1:]):
    print "%s-%s," % interval,
print 
```

# javascript - 在 joomla 中向 Tinymce 编辑器添加自定义格式

> ID：11265671
> 
> 赞同：2
> 
> 时间：2012-06-29T16:37:00.867
> 
> 标签：javascript, joomla, editor, tinymce, joomla2.5

我想在 TinyMCE 编辑器的格式列表中添加自定义格式。例如，我想当用户选择文本并选择我的格式时，`<div class="custom">`在选定区域之前插入 Tinymce，并`</div>`在此之后插入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T08:40:44.083

这不会像你希望的那样容易。要使用 custome_formats，您可能需要查看此自定义格式示例：[http](http://www.tinymce.com/tryit/custom_formats.php) ://www.tinymce.com/tryit/custom_formats.php尤其是查看“查看源代码”部分并检查设置格式和 style_formats 那里。

# facebook - 我如何“邀请” Facebook 朋友点赞和分享我的外部 URL？

> ID：11265674
> 
> 赞同：0
> 
> 时间：2012-06-29T16:37:11.840
> 
> 标签：facebook

我知道您可以通过管理面板 -> 邀请朋友邀请朋友到您的**Facebook 粉丝页面。**他们所有的朋友都会收到一条带有橙色小旗的消息，要求他们喜欢粉丝专页。

但是如何对**外部 URL**做同样的邀请呢？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:30:10.080

[https://developers.facebook.com/docs/reference/javascript/FB.ui/](https://developers.facebook.com/docs/reference/javascript/FB.ui/)

只要您提到的外部 URL 是 FB 应用程序，那么 FB.ui 对话框调用就应该这样做。

# facebook - 是否可以在多个域上使用 facebook 应用程序？

> ID：11265676
> 
> 赞同：1
> 
> 时间：2012-06-29T16:37:21.340
> 
> 标签：facebook, facebook-graph-api, dns

是否可以在多个域（*不是*子域而是完全不同的域）上使用 facebook 应用程序？

让我展示我得到错误的示例。[http://www.hazirportal.com/testler/test1.html](http://www.hazirportal.com/testler/test1.html)此页面有一个登录页面，当您单击登录按钮时效果很好。[http://www.hazirport.com/testler/test1.html](http://www.hazirport.com/testler/test1.html)此页面具有相同的登录部分，当您单击它时会出现 191 错误。那么我可以将重定向 uri 更改为成功此授权。或者如何让我的应用程序使用多个域？

# amazon-web-services - AWS 自动故障转移不同区域

> ID：11265679
> 
> 赞同：2
> 
> 时间：2012-06-29T16:37:39.690
> 
> 标签：amazon-web-services

是否可以在 AWS 的不同区域（例如美国东部和加利福尼亚或新加坡）自动执行故障转移计划？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-20T15:22:34.350

AWS 没有很多多区域服务，并且不能使用标准产品将 EC2 实例失败到不同区域。在 2012 年 AWS re:Invent 大会上，他们表示他们更喜欢单个区域内的多 AZ，因为 AZ 之间的延迟非常低，而且不同的 AZ 之间仍然相距数英里，彼此之间的隔离相当好。

他们确实建议使用单独的区域为这些不同区域的用户提供服务。这与失败不同。从北美故障转移到亚洲似乎不是正常用例的好解决方案。这两个地区都不会很好地为对面大陆的用户提供服务。

也就是说，您可以使用循环 DNS 来执行此操作。如果您在加利福尼亚有一个地址为 ip1 的服务器，而在新加坡有另一个地址为 ip2 的服务器，只需将 mywebsite.mydomain 的地址宣传为 ip1 和 ip2。通过测试我发现所有最近的网络浏览器都会随机尝试一个地址，如果无法连接到另一个地址。它对用户来说看起来非常无缝。但是你仍然随机地将美国客户路由到新加坡，反之亦然。

# java - Hibernate-使用spring HibernateTemplate的一对多级联选项

> ID：11265680
> 
> 赞同：0
> 
> 时间：2012-06-29T16:37:40.157
> 
> 标签：java, spring, hibernate

在我的应用程序中，我有一个一对多的关系，我有以下要求。以车主关系为例。车主可以拥有多辆车，而一辆车只能拥有一个车主。

*   当我将带有汽车的父实体（所有者）保存为其中的集合时，我希望汽车自动插入。更新也一样。
*   从集合中删除一些汽车对象并保存时，我希望删除的汽车对象从数据库中删除。

我尝试在休眠 xml 映射中使用以下选项：

```
inverse="false" fetch="select" cascade="all-delete-orphan" 
```

我插入使用

```
HibernateTemplate.persist() 
```

更新使用

```
HibernateTemplate.merge() 
```

更新运行良好，但插入工作不正常。

任何人都可以告诉我什么是确切的级联选项以及用于保存和更新此类场景的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:29:21.627

见 21.3。级联生命周期在这里：

[http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/example-parentchild.html](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/example-parentchild.html)

# php - 在关联数组中插入值，但前提是具有值

> ID：11265681
> 
> 赞同：1
> 
> 时间：2012-06-29T16:37:41.140
> 
> 标签：php

我有这个扣子：

```
foreach($jsonU as $j) {
        $jsonUId = $j->id;
        $jsonUName = $j->name;
        $jsonUDescription = $j->description;
        $jsonUDate = $j->date;
        $jsonUStatus = $j->status;
        $jsonUPicture = $j->picture;

        $jsonUncompleted[] = array('id'=> $jsonUId, 'name'=> $jsonUName, 'description' => $jsonUDescription, 'date' => $jsonUDate, 'status' => $jsonUStatus, 'picture' =>$jsonUPicture);
} 
```

只有当有值时，我才需要在数组中插入一个键。例如，`$jsonUPictore`并不总是有一个值，在这种情况下我不需要写那个键。

一些帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:44:34.833

您可以使用`array_filter`带或不带参数的函数：

[http://www.php.net/manual/en/function.array-filter.php](http://www.php.net/manual/en/function.array-filter.php)

例子：

```
$jsonUncompleted[] = array_filter( array(
  'id'=> $jsonUId, 'name'=> $jsonUName, 'description' => $jsonUDescription,
  'date' => $jsonUDate, 'status' => $jsonUStatus, 'picture' =>$jsonUPicture
)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:48:29.807

如果您想`NULL`从数组中删除所有值，有一种简单的方法可以使用`array_filter`最后一张海报提到的函数：

```
$new_array_without_nulls = array_filter($array_with_nulls, 'strlen'); 
```

来源：[http ://briancray.com/posts/remove-null-values-php-arrays/](http://briancray.com/posts/remove-null-values-php-arrays/)

# c# - EF 中的常量导致异常

> ID：11265682
> 
> 赞同：1
> 
> 时间：2012-06-29T16:37:43.637
> 
> 标签：c#, .net, entity-framework, exception, enums

我有以下代码。但它会导致异常。

```
 using (var context = new blogEntities())
                {
                    var listOfComments = context.Comments
                        .OrderByDescending(c => c.CreateDate)
                        .Where(c => c.CreateDate > fromDate)
                        .Select(c => new NewsFeedData()
                        {
                            ArticleID = c.ArticleID,
                            CommentID = c.CommentID,
                            Text = c.CommentText,
                            Author = c.Author,
                            CreateDate = c.CreateDate,
                            Type = 'C'
                        }).ToList();
                 } 
```

比我尝试枚举但有一些问题。实现我想要的最佳方式是什么？我想为 Type 分配一些常量

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:41:20.557

一种简单的方法是将数据库中的所有值提取为匿名类型，然后`AsEnumerable`在最终投影之前切换到 LINQ to Objects：

```
using (var context = new blogEntities())
{
    var listOfComments = context.Comments
        .OrderByDescending(c => c.CreateDate)
        .Where(c => c.CreateDate > fromDate)
        .Select(c => new { c.ArticleID, c.CommentID, c.CommentText,
                           c.Author, c.CreateDate })
        .AsEnumerable() // Switch into LINQ to Objects
        .Select(c => new NewsFeedData
        {
            ArticleID = c.ArticleID,
            CommentID = c.CommentID,
            Text = c.CommentText,
            Author = c.Author,
            CreateDate = c.CreateDate,
            Type = 'C'
        }).ToList();
 } 
```

# c++ - 将套接字传递给线程 C

> ID：11265684
> 
> 赞同：3
> 
> 时间：2012-06-29T16:37:53.333
> 
> 标签：c++, c, multithreading, sockets

我正在尝试使用 UDP 制作网络系统。我已经设法让它工作了，但现在我想把监听部分放在一个单独的线程中，这样我就可以继续程序而不必等待消息（它将用于游戏）。

问题是，当我将套接字传递给新线程并将其用于侦听时，它不起作用，只是不断地接收随机输入。当我在初始化套接字的方法中使用完全相同的代码时，一切正常。

这有效：

```
bool serverUDP() {
WSADATA w;
SOCKET sd;

struct sockaddr_in server, client;
char buffer[DEFAULT_BUFLEN];
int bytes_received;
int client_length;

/* Open windows connection */
if (WSAStartup(MAKEWORD(2,2)/*0x0101*/, &w) != 0) {
    fprintf(stderr, "Could not open Windows connection.\n");
    return false;
}

/* Open a datagram socket */
sd = socket(AF_INET, SOCK_DGRAM, 0);
if (sd == INVALID_SOCKET) {
    fprintf(stderr, "Could not create socket.\n");
    WSACleanup();
    return false;
}

/* Clear out server struct */
memset((void *)&server, '\0', sizeof(struct sockaddr_in));

/* Set family and port */
server.sin_family = AF_INET;
server.sin_port = htons(atoi(DEFAULT_PORT));

server.sin_addr.S_un.S_un_b.s_b1 = 127;
server.sin_addr.S_un.S_un_b.s_b2 = 0;
server.sin_addr.S_un.S_un_b.s_b3 = 0;
server.sin_addr.S_un.S_un_b.s_b4 = 1;

/* Bind address to socket */
if (bind(sd, (struct sockaddr *)&server, sizeof(struct sockaddr_in)) == -1) {
    fprintf(stderr, "Could not bind name to socket.\n");
    closesocket(sd);
    WSACleanup();
    return false;
}

client_length = (int)sizeof(struct sockaddr_in);

/* Receive bytes from client */
while (true) {
    bytes_received = recvfrom(sd, buffer, DEFAULT_BUFLEN, 0, (struct sockaddr *)&client, &client_length);
    fprintf(stderr,"received: %s\n", buffer);
}

closesocket(sd);
WSACleanup();   

return true;
} 
```

这不会：

```
bool serverUDP() {
WSADATA w;
SOCKET sd;

struct sockaddr_in server, client;
char buffer[DEFAULT_BUFLEN];
int bytes_received;
int client_length;

/* Open windows connection */
if (WSAStartup(MAKEWORD(2,2)/*0x0101*/, &w) != 0) {
    fprintf(stderr, "Could not open Windows connection.\n");
    return false;
}

/* Open a datagram socket */
sd = socket(AF_INET, SOCK_DGRAM, 0);
if (sd == INVALID_SOCKET) {
    fprintf(stderr, "Could not create socket.\n");
    WSACleanup();
    return false;
}

/* Clear out server struct */
memset((void *)&server, '\0', sizeof(struct sockaddr_in));

/* Set family and port */
server.sin_family = AF_INET;
server.sin_port = htons(atoi(DEFAULT_PORT));

server.sin_addr.S_un.S_un_b.s_b1 = 127;
server.sin_addr.S_un.S_un_b.s_b2 = 0;
server.sin_addr.S_un.S_un_b.s_b3 = 0;
server.sin_addr.S_un.S_un_b.s_b4 = 1;

/* Bind address to socket */
if (bind(sd, (struct sockaddr *)&server, sizeof(struct sockaddr_in)) == -1) {
    fprintf(stderr, "Could not bind name to socket.\n");
    closesocket(sd);
    WSACleanup();
    return false;
}

_beginthread((void(*)(void*))receiveThread,0,(void *)sd);

closesocket(sd);
WSACleanup();   

return true;
}

void receiveThread(SOCKET sd)
{
struct sockaddr_in client, server;
char buffer[DEFAULT_BUFLEN];

int bytes_received;
int client_length;

client_length = (int)sizeof(struct sockaddr_in);

while (true) {
    bytes_received = recvfrom(sd, buffer, DEFAULT_BUFLEN, 0, (struct sockaddr *)&client, &client_length);
    fprintf(stderr,"received: %s\n", buffer);
}
} 
```

第二段代码只是随机输入垃圾邮件，就好像它不断收到一些奇怪的消息一样。第一段代码等待消息并在收到消息时继续（我也有一个客户端部分）。

谢谢你的帮助！

干杯，

马克西姆·舒梅克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:56:58.270

主线程在启动另一个线程后立即关闭套接字。因此线程不再具有有效的套接字句柄。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T16:45:19.553

您的问题的根源是这一行：

```
_beginthread((void(*)(void*))receiveThread,0,(void *)sd); 
```

基本上，您使用`receiveThread()`错误的参数调用函数，但是您欺骗了编译器使其无法检测到错误的情况：您将函数转换为错误的签名并将参数转换为错误的类型。

更改`receiveThread()`函数以使其具有正确的签名，然后删除强制转换。

```
void * receiveThread(void * context);

_beginthread(receiveThread,0,(void *)sd); 
```

然后，将指针传递给您的`sd`变量并在线程函数中引用它：

```
_beginthread(receiveThread,0,&sd);

void * receiveThread(void * context)
{
    SOCKET socket = *(SOCKET*)context;
    // ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T16:40:49.360

```
(void *)&sd 
```

和

```
void receiveThread(void *param)

SOCKET sd = *(SOCKET *)param; 
```

我认为它应该解决它！

编辑：

写 (void *)sd 创建一个指向 sd 值地址的指针，这是错误的，你需要创建一个指向 sd 地址的指针，所以你写 &sd，这样你就可以在取消线程函数后获取它的值通过取消引用它： SOCKET sd = (SOCKET)*param;

我的英语不是很好，我希望你能理解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T01:14:34.533

该程序应读取（sudo 代码）：

```
 while(1){
 listen()
 newSD = accept()
 pthread_creat(newsd) 
```

}

这将为每个连接创建一个新线程，同时保持 main 运行

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-25T20:21:09.370

在关闭主函数中的套接字之前，您必须尝试包含 WaitForSingleObject() 。

# jquery - 如何制作自动完成文本框，在提交时将值传递给另一个 aspx 页面？

> ID：11265686
> 
> 赞同：1
> 
> 时间：2012-06-29T16:38:09.417
> 
> 标签：jquery, asp.net, ajax, vb.net

我有一个包含产品列表页面和产品详细信息页面的网站。

在 asp 母版页中，我放置了一个文本框来搜索数据库中的产品。

我需要做的是：当访问者开始在文本框中书写时，文本框会自动从数据库中的产品名称中完成。

当访问者在下拉列表中的结果上按 Enter 键时，站点会将他带到由来自主页的查询字符串传递的 ID 中提交的产品详细信息填充的产品详细信息页面。

请帮助我，我搜索了很多，并且有非常相似的问题对我的情况不起作用。

任何指向教程或像我这里这样的问题的链接都是完美的。

非常感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:48:53.003

你需要自动完成扩展器。阅读它

1.  代码项目教程[在这里](http://www.codeproject.com/Articles/71338/Using-the-AutoComplete-Extender-to-Automatically-P)
2.  官方文档[在这里](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/AutoComplete/AutoComplete.aspx)
3.  [MSDN 教程在这里](http://blogs.msdn.com/b/phaniraj/archive/2007/06/19/how-to-use-a-key-value-pair-in-your-autocompleteextender.aspx)完全涵盖了您的需求

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:02:58.830

我会检查[jQuery autocomplete](http://jqueryui.com/demos/autocomplete/)。

你可以像这样使用它：

```
$('#<%= yourTextBox.ClientID %>').autocomplete({
    source: 'HandlerThatReturnsProductNames.ashx',
    select: function (event, ui) {
        // this is where you would jump to your product page
    }
}); 
```

然后您需要创建通用处理程序“HandlerThatReturnsProductNames.ashx”。在该`ProcessRequest`方法中，它需要执行以下操作：

```
public void ProcessRequest(HttpContext context) {

    string term = context.Request.QueryString.Get("term");

    List<QuickProduct> listOfProducts = SomeMethodThatGetsMatchingProducts(term);
    var jsSerializer = new System.Web.Script.Serialization.JavaScriptSerializer();
    string json = jsSerializer.Serialize(listOfProducts);

    context.Response.ContentType = "application/json";
    context.Response.Write(json);
    context.Response.End();
} 
```

假设你`QuickProduct`是这样的：

```
public class QuickProduct {
    public int value { get; set; }
    public string label { get; set; }
} 
```

# maya - 将 Maya 2013 转换为 X3D 文件

> ID：11265694
> 
> 赞同：0
> 
> 时间：2012-06-29T16:38:52.420
> 
> 标签：maya, x3d

有没有办法将文件从 Maya 2013 转换为 X3D 文件？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T01:02:01.717

您是否特别需要 X3D？似乎唯一为玛雅做这件事的项目是 5 岁以上。

如果您正在寻找[相当广泛支持的基于 XML 的格式](http://en.wikipedia.org/wiki/COLLADA#Software_tools)，COLLADA 似乎很受欢迎。Maya 有一个名为[ColladaMaya的插件](http://colladamaya.sourceforge.net/)

以下是声称可以处理 COLLADA -> X3D 的转换工具列表：
[http ://www.web3d.org/x3d/content/examples/X3dResources.html](http://www.web3d.org/x3d/content/examples/X3dResources.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:01:30.913

如果您可以使用 webgl 而不是 x3d，您可以尝试[http://www.inka3d.com](http://www.inka3d.com)

# wpf - 固定大小的 GridSplitter MinWidth

> ID：11265698
> 
> 赞同：5
> 
> 时间：2012-06-29T16:39:31.387
> 
> 标签：wpf, silverlight, xaml, silverlight-toolkit, gridsplitter

我有一个由 GridSplitter 分隔的 2 列的网格，使用以下 XAML 代码：

```
<Grid>
    <Grid.ColumnDefinitions>
    <ColumnDefinition Width="100" MinWidth="20" />
    <ColumnDefinition Width="10" />
    <ColumnDefinition Width="*" MinWidth="100" />
    </Grid.ColumnDefinitions>

    <Rectangle Fill="Blue" />
    <GridSplitter Grid.Column="1" Background="LightGray" HorizontalAlignment="Stretch" />
    <Rectangle Fill="Yellow" Grid.Column="2" />
</Grid> 
```

**问题**：右侧列的 MinWidth 被忽略

*   当页面加载时，我绝对需要第一列宽度为“100px”，所以它不能是*大小。
*   我不想在第一列上设置 MaxWidth

*我知道之前已经解决过，但它总是建议将列大小设置为 * 或在第一列上设置一个 maxWidth ......我不想要那个。

* * *

找到了一个解决方案，**但它的丑陋！:p**，任何人都有更清洁的方法来实现我想要的......无码（如果可能的话）？

```
private void Grid_SizeChanged(object sender, SizeChangedEventArgs e)
{
   var g = (Grid)sender;

   Double maxW = e.NewSize.Width - g.ColumnDefinitions[2].MinWidth - g.ColumnDefinitions[1].ActualWidth;
   g.ColumnDefinitions[0].MaxWidth = maxW;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T08:03:33.813

基本问题是网格拆分器*仅*通过调整左列的宽度来工作，并假设右列将按*星形大小*调整以适应剩余空间。

这意味着您要解决的问题实际上是“如何限制左列的最大宽度，以使右列不会变得太小？”。这基本上就是您的代码示例正在做的事情。

如果您想要一个可以在 XAML 中实现的更便携的解决方案，请创建一个可以应用于网格的 Silverlight[行为（如下所示）。](http://www.silverlightshow.net/items/Behaviors-and-Triggers-in-Silverlight-3.aspx)它将附加到父网格的`SizeChanged`事件并几乎完全按照您的代码片段所做的事情，但作为一种行为，您可以将它们拖放到 Blend 中或附加到 XAML 中。

以下是我为您提供的示例行为作为示例（基于您自己的代码）：

## MinWidthSplitterBehavior.cs

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Interactivity;

namespace GridSplitterMinWidth
{
    public class MinWidthSplitterBehavior : Behavior<Grid>
    {
        public Grid ParentGrid { get; set; }

        protected override void OnAttached()
        {
            base.OnAttached();
            ParentGrid = this.AssociatedObject as Grid;
            ParentGrid.SizeChanged += parent_SizeChanged;
        }

        void parent_SizeChanged(object sender, SizeChangedEventArgs e)
        {
            if (ParentGrid.ColumnDefinitions.Count == 3)
            {
                Double maxW = e.NewSize.Width - ParentGrid.ColumnDefinitions[2].MinWidth -
                              ParentGrid.ColumnDefinitions[1].ActualWidth;
                ParentGrid.ColumnDefinitions[0].MaxWidth = maxW;
            }
        }

        protected override void OnDetaching()
        {
            base.OnDetaching();
            if (ParentGrid != null)
            {
                ParentGrid.SizeChanged -= parent_SizeChanged;
            }
        }
    }
} 
```

## 并像这样使用它：

```
<UserControl x:Class="GridSplitterMinWidthApp.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:GridSplitterMinWidth="clr-namespace:GridSplitterMinWidth"
    xmlns:interactivity="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
    xmlns:Controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
    mc:Ignorable="d"
    d:DesignHeight="300" d:DesignWidth="400">

    <Grid x:Name="LayoutRoot" Background="White">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100" MinWidth="20" />
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="*" MinWidth="100" />
            </Grid.ColumnDefinitions>
            <interactivity:Interaction.Behaviors>
                <GridSplitterMinWidth:MinWidthSplitterBehavior/>
            </interactivity:Interaction.Behaviors>
            <Rectangle Fill="Blue" />
            <Controls:GridSplitter Grid.Column="1" Background="LightGray" HorizontalAlignment="Stretch">
            </Controls:GridSplitter>
            <Rectangle Fill="Yellow" Grid.Column="2" />
        </Grid>
    </Grid>
</UserControl> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-09T16:08:25.847

在我看来，这似乎是 WPF GridSplitter 中的一个错误。问题的根源在于对 Width 列使用不同类型的值。

这将不起作用：

```
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="100" MinWidth="20" />
    <ColumnDefinition Width="10" />
    <ColumnDefinition Width="*" MinWidth="100" />
</Grid.ColumnDefinitions> 
```

因为列 [0] 的宽度为“100”，是显式数字类型，而列 [1] 的宽度为“*”。但这会起作用：

```
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="*" MinWidth="20" />
    <ColumnDefinition Width="10" />
    <ColumnDefinition Width="*" MinWidth="100" />
</Grid.ColumnDefinitions> 
```

执行此操作时，GridSplitter 会遵守左右“MinWidth”值。对我来说，这意味着 WPF 中的错误。

就我而言，我需要将左列设置为“Auto”，最小值为“*”，但如果没有某种形式的代码隐藏，似乎没有任何方法可以做到这一点。我的猜测是，最简单的解决方案是 * 调整所有内容的大小并使用自定义行为来替换列的“自动”功能（因为这是一列一次性修复），但我还没有做那。希望 XAML 看起来像这样：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" MinWidth="20" />
        <ColumnDefinition Width="10" />
        <ColumnDefinition Width="*" MinWidth="100" />
    </Grid.ColumnDefinitions>
    <interactivity:Interaction.Behaviors>
        <MyBehaviors:GridColumnStarSizedToAutoBehavior Column="0"/>
    </interactivity:Interaction.Behaviors>
    ...
</Grid> 
```

更新*：我实现了上面这篇文章中提到的行为。由于网格限制，它并不像我希望的那么简单。由于公司限制，我无法发布解决方案，但我可以提供一些提示。我遇到的最大问题是，即使有行为代码隐藏，您也无法真正摆脱星号大小，因为它使 MinWidth 停止为星号大小的列工作。

为了弥补这一点，需要处理网格的所有列。您必须获取要自动调整大小的列，通过按列获取 UIElements 并对其使用 Measure 来确定其子项的所需大小，然后将它们的星号值更改为总可用星号间距的百分比。您还必须相应地调整非自动星号大小的列星号值。

举个例子，考虑一个有 3 列的网格：第一个星形大小的 MinWidth 我们希望是自动的，第二个自动大小的没有 MinWidth，第三个星形大小的有 MinWidth。如果控件是 100 单位宽，并且第一列的内容需要 25 像素，第三列的内容需要 5 像素，则代码必须将第一列和最后一列的星号设置为“25*”和“70 *" 分别（或任何其他获得正确比率的数字）。

这不是微不足道的，但最终确实奏效了。我没有考虑列跨越。

抱歉，我无法发布代码。

# android - Google Maps 和 Admob 一起使用时要设置什么目标

> ID：11265702
> 
> 赞同：0
> 
> 时间：2012-06-29T16:40:00.093
> 
> 标签：android, google-maps, admob

我正在开发一个需要同时使用 Google Maps 和 Admob 的 android 应用程序。由于我在清单和 project.properties 文件中指定目标的方式，我遇到了错误，它只允许我使用谷歌地图或 admob。

清单文件中指定的最小 sdk 和目标版本是这样的

```
uses-sdk android:minSdkVersion="8" android:targetSdkVersion="13" 
```

在 project.properties 中，其指定为`"target=Google Inc.:Google APIs:8"`

在许多关于堆栈溢出的博客和问题中，我看到人们通过将 android 目标版本指定为 13 或更高版本来修复 admob 问题。但是在我的情况下，如果我这样做，它会开始给出与 MapActivity 相关的错误。

请建议我应该在清单文件和 project.properties 中指定哪些目标级别，以便我可以使地图和 admob 都工作。

提前谢谢了..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:18:18.813

我在我的项目中使用 minSdkVersion="4" targetSdkVersion="8" 并添加了 Android 3.0 Google API，过去我遇到了一些问题，但我只需要检查外部库，你也可以检查它。有时库需要时间才能包含在内，您可能会遇到 MapActivity 问题。

# c# - 缺少引用 OLEDB 连接类型的库

> ID：11265706
> 
> 赞同：3
> 
> 时间：2012-06-29T16:40:20.780
> 
> 标签：c#, ado.net, ssis, oledb

[我从SSIS 团队博客](http://blogs.msdn.com/b/mattm/archive/2008/08/22/accessing-oledb-connection-managers-in-a-script.aspx)中获得了以下代码来转换 OLEDB 连接类型，以便 AcquireConnection () 方法可以使用它。现在我不确定为什么 Dts.Connections 部分不起作用。我不知道我必须添加的库才能使其工作。我几乎添加了最重要的部分，包括 Dts.RuntimeWrap。如果您需要有关该问题的更多信息，请告诉我。

```
ConnectionManager cm = Dts.Connections["oledb"];
Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100 cmParams = cm.InnerObject as Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100;
OleDbConnection conn = cmParams.GetConnectionForSchema() as OleDbConnection; 
```

**编辑** 下面是这个组件的完整代码。

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using Microsoft.SqlServer.Dts.Runtime;
using System.Data.OleDb;
using System.Data.Common;
using System.Linq;
using System.Configuration;
using System.Collections;

//using System.Data.OleDb;

namespace AOC.SqlServer.Dts.Tasks
{

    [DtsTask(
        DisplayName = "Custom Logging Task",
        Description = "Writes logging info into a table")]
    public class CustomLoggingTask : Task
    {

        private string _packageName;
        private string _taskName;
        private string _errorCode;
        private string _errorDescription;
        private string _machineName;
        private double _packageDuration;

        private string _connectionName;
        private string _eventType;
        private string _executionid;
        private DateTime _handlerdatetime;
        private string _uid;
        public string ConnectionName
        {
            set
            {
                _connectionName = value;
            }
            get
            {
                return _connectionName;
            }
        }

        public string Event
        {
            set
            {
                _eventType = value;
            }
            get
            {
                return _eventType;
            }
        }

public override DTSExecResult Validate(Connections connections, VariableDispenser variableDispenser, IDTSComponentEvents componentEvents, IDTSLogging log)
        {
            const string METHOD_NAME = "CustomLoggingTask-Validate";

            try
            {

                if (string.IsNullOrEmpty(_eventType))
                {
                    componentEvents.FireError(0, METHOD_NAME, "The event property must be specified", "", -1);
                    return DTSExecResult.Failure;
                }

                if (string.IsNullOrEmpty(_connectionName))
                {
                    componentEvents.FireError(0, METHOD_NAME, "No connection has been specified", "", -1);
                    return DTSExecResult.Failure;
                }

                //SqlConnection connection = connections[_connectionName].AcquireConnection(null) as SqlConnection;
                DbConnection connection = connections[_connectionName].AcquireConnection(null) as DbConnection;

                ConnectionManager cm = Dts.Connections["oledb"];
                Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100 cmParams = cm.InnerObject as Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100;
                OleDbConnection conn = cmParams.GetConnectionForSchema() as OleDbConnection;

                if (connection == null)
                {
                    componentEvents.FireError(0, METHOD_NAME, "The connection is not a valid ADO.NET connection", "", -1);
                    return DTSExecResult.Failure;
                }

               if (!variableDispenser.Contains("System::SourceID"))
                {
                    componentEvents.FireError(0, METHOD_NAME, "No System::SourceID variable available. This task can only be used in an Event Handler", "", -1);
                    return DTSExecResult.Failure;
                }

                return DTSExecResult.Success;
            }
            catch (Exception exc)
            {
                componentEvents.FireError(0, METHOD_NAME, "Validation Failed: " + exc.ToString(), "", -1);
                return DTSExecResult.Failure;
            }
        }

public override DTSExecResult Execute(Connections connections, VariableDispenser variableDispenser, IDTSComponentEvents componentEvents, IDTSLogging log, object transaction)
       {
          try
            {
                string commandText =
@"INSERT INTO SSISLog (EventType, PackageName, TaskName, EventCode, EventDescription, PackageDuration, Host, ExecutionID, EventHandlerDateTime,UID)
VALUES (@EventType, @PackageName, @TaskName, @EventCode, @EventDescription, @PackageDuration, @Host, @Executionid, @handlerdatetime,@uid)";

                ReadVariables(variableDispenser);
                DbConnection connection = connections[_connectionName].AcquireConnection(transaction) as DbConnection;
                //SqlConnection connection = (SqlConnection)connections[_connectionName].AcquireConnection(transaction);
                DbCommand command = null;
                //using (SqlCommand command = new SqlCommand())
                if (connection is SqlConnection)
                    command = new SqlCommand();
                else if (connection is OleDbConnection)
                    command = new OleDbCommand();

                {
                    command.CommandText = commandText;
                    command.CommandType = CommandType.Text;
                    command.Connection = connection;

                    command.Parameters.Add(new SqlParameter("@EventType", _eventType));
                    command.Parameters.Add(new SqlParameter("@PackageName", _packageName));
                    command.Parameters.Add(new SqlParameter("@TaskName", _taskName));
                    command.Parameters.Add(new SqlParameter("@EventCode", _errorCode ?? string.Empty));
                    command.Parameters.Add(new SqlParameter("@EventDescription", _errorDescription ?? string.Empty));
                    command.Parameters.Add(new SqlParameter("@PackageDuration", _packageDuration));
                    command.Parameters.Add(new SqlParameter("@Host", _machineName));
                    command.Parameters.Add(new SqlParameter("@ExecutionID", _executionid));
                    command.Parameters.Add(new SqlParameter("@handlerdatetime", _handlerdatetime));
                    command.Parameters.Add(new SqlParameter("@uid", _uid));
                    command.ExecuteNonQuery();
                }
                connection.Close();
                return DTSExecResult.Success;

            }
            catch (Exception exc)
            {
                componentEvents.FireError(0, "CustomLoggingTask-Execute", "Task Errored: " + exc.ToString(), "", -1);
                return DTSExecResult.Failure;
            }

        }

        private void ReadVariables(VariableDispenser variableDispenser)
        {
            variableDispenser.LockForRead("System::StartTime");
            variableDispenser.LockForRead("System::PackageName");
            variableDispenser.LockForRead("System::SourceName");
            variableDispenser.LockForRead("System::MachineName");
            variableDispenser.LockForRead("System::ExecutionInstanceGUID");
            variableDispenser.LockForRead("System::EventHandlerStartTime");
            variableDispenser.LockForRead("User::UID");
            bool includesError = variableDispenser.Contains("System::ErrorCode");
            if (includesError)
            {
                variableDispenser.LockForRead("System::ErrorCode");
                variableDispenser.LockForRead("System::ErrorDescription");
            }

            Variables vars = null;
            variableDispenser.GetVariables(ref vars);

            DateTime startTime = (DateTime)vars["System::StartTime"].Value;
            _packageDuration = DateTime.Now.Subtract(startTime).TotalSeconds;
            _packageName = vars["System::PackageName"].Value.ToString();
            _taskName = vars["System::SourceName"].Value.ToString();
            _machineName = vars["System::MachineName"].Value.ToString();
            _executionid = vars["System::ExecutionInstanceGUID"].Value.ToString();
            _handlerdatetime = (DateTime)vars["System::EventHandlerStartTime"].Value;
            _uid = vars["User::UID"].Value.ToString();
            if (includesError)
            {
                _errorCode = vars["System::ErrorCode"].Value.ToString();
                _errorDescription = vars["System::ErrorDescription"].Value.ToString();
            }

            // release the variable locks.
            vars.Unlock();

            // reset the dispenser
            variableDispenser.Reset();
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T23:00:36.823

通过您发布的代码，我终于弄清楚了您要完成的工作。

这些是我为使其正常工作所做的事情：

**A）**您收到的编译错误：

```
"Error 1 The type or namespace name 'Connections' does not exist in the namespace 'AOC.SqlServer.Dts' (are you missing an assembly reference?)" 
```

仅仅是因为您尝试获取*oledb*连接管理器的方式：

```
ConnectionManager cm = Dts.Connections["oledb"]; 
```

该`Dts`对象是脚本任务组件中可用的工具。您应该将该行替换为：

```
ConnectionManager cm = connections["oledb"]; 
```

我在您的代码中看到您`Connection Manager`以这种方式访问​​ a ，所以也许这是您刚刚留下的东西。

**B)**要验证连接管理器是 ADO.NET 连接管理器还是 OLEDB 连接管理器，请更改这部分代码：

```
DbConnection connection = connections[_connectionName].AcquireConnection(null) as DbConnection;

ConnectionManager cm = Dts.Connections["oledb"];
Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100 cmParams = cm.InnerObject as Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100;
OleDbConnection conn = cmParams.GetConnectionForSchema() as OleDbConnection;

if (connection == null)
{
    componentEvents.FireError(0, METHOD_NAME, "The connection is not a valid ADO.NET connection", "", -1);
    return DTSExecResult.Failure;
} 
```

首先，在类级别添加一个私有变量来存储连接：

```
private DbConnection _connection; 
```

然后，修改验证以检查连接是否为 ADO.NET，如果不是，则检查它是否为 OLEDB：

```
_connection = connections[_connectionName].AcquireConnection(null) as DbConnection;

if (_connection == null)
{
    ConnectionManager cm = connections[_connectionName];
    Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100 cmParams = cm.InnerObject as Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100;
    _connection = cmParams.GetConnectionForSchema() as OleDbConnection;

    if (_connection == null)
    {
        componentEvents.FireError(0, METHOD_NAME, "The connection is not a valid ADO.NET or OLEDB connection", "", -1);
        return DTSExecResult.Failure;
    }
} 
```

请注意，我用变量替换了硬编码`"oledb"`，`_connectionName`并且`_connection`在两种情况下都修改了错误字符串。

**C)**要使用 OLEDB 提供程序执行命令，需要进行以下更改：

*   使用新`_connection`变量，它保存先前检索到的连接。
*   添加到命令的参数必须`OleDbParameter`代替`SqlParameter`.
*   [OLE DB .NET 提供程序](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbcommand.parameters.aspx)不支持命名参数。因此，需要修改语句命令中的`VALUES`部分以使用.`INSERT``?`

**D）**这是完整的工作代码：

```
using System;
using System.Data;
using System.Data.Common;
using System.Data.OleDb;
using System.Data.SqlClient;
using Microsoft.SqlServer.Dts.Runtime;

//using System.Data.OleDb;

namespace AOC.SqlServer.Dts.Tasks
{
    [DtsTask(
        DisplayName = "Custom Logging Task",
        Description = "Writes logging info into a table")]
    public class CustomLoggingTask : Task
    {
        private string _packageName;
        private string _taskName;
        private string _errorCode;
        private string _errorDescription;
        private string _machineName;
        private double _packageDuration;

        private string _connectionName;
        private string _eventType;
        private string _executionid;
        private DateTime _handlerdatetime;
        private string _uid;

        public string ConnectionName
        {
            set { _connectionName = value; }
            get { return _connectionName; }
        }

        public string Event
        {
            set { _eventType = value; }
            get { return _eventType; }
        }

        private DbConnection _connection;

        public override DTSExecResult Validate(Connections connections, VariableDispenser variableDispenser, IDTSComponentEvents componentEvents, IDTSLogging log)
        {
            const string METHOD_NAME = "CustomLoggingTask-Validate";

            try
            {
                if (string.IsNullOrEmpty(_eventType))
                {
                    componentEvents.FireError(0, METHOD_NAME, "The event property must be specified", "", -1);
                    return DTSExecResult.Failure;
                }

                if (string.IsNullOrEmpty(_connectionName))
                {
                    componentEvents.FireError(0, METHOD_NAME, "No connection has been specified", "", -1);
                    return DTSExecResult.Failure;
                }

                //SqlConnection connection = connections[_connectionName].AcquireConnection(null) as SqlConnection;
                _connection = connections[_connectionName].AcquireConnection(null) as DbConnection;

                if (_connection == null)
                {
                    ConnectionManager cm = connections[_connectionName];
                    Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100 cmParams = cm.InnerObject as Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManagerDatabaseParameters100;
                    _connection = cmParams.GetConnectionForSchema() as OleDbConnection;

                    if (_connection == null)
                    {
                        componentEvents.FireError(0, METHOD_NAME, "The connection is not a valid ADO.NET or OLEDB connection", "", -1);
                        return DTSExecResult.Failure;
                    }
                }

                if (!variableDispenser.Contains("System::SourceID"))
                {
                    componentEvents.FireError(0, METHOD_NAME, "No System::SourceID variable available. This task can only be used in an Event Handler", "", -1);
                    return DTSExecResult.Failure;
                }

                return DTSExecResult.Success;
            }
            catch (Exception exc)
            {
                componentEvents.FireError(0, METHOD_NAME, "Validation Failed: " + exc.ToString(), "", -1);
                return DTSExecResult.Failure;
            }
        }

        public override DTSExecResult Execute(Connections connections, VariableDispenser variableDispenser, IDTSComponentEvents componentEvents, IDTSLogging log, object transaction)
        {
            try
            {
                string commandText = null;

                ReadVariables(variableDispenser);
                //DbConnection connection = connections[_connectionName].AcquireConnection(transaction) as DbConnection;
                //SqlConnection connection = (SqlConnection)connections[_connectionName].AcquireConnection(transaction);
                DbCommand command = null;

                //using (SqlCommand command = new SqlCommand())
                if (_connection is SqlConnection)
                {
                    commandText = @"INSERT INTO SSISLog (EventType, PackageName, TaskName, EventCode, EventDescription, PackageDuration, Host, ExecutionID, EventHandlerDateTime,UID)
                                    VALUES (@EventType, @PackageName, @TaskName, @EventCode, @EventDescription, @PackageDuration, @Host, @Executionid, @handlerdatetime,@uid)";

                    command = new SqlCommand();

                    command.Parameters.Add(new SqlParameter("@EventType", _eventType));
                    command.Parameters.Add(new SqlParameter("@PackageName", _packageName));
                    command.Parameters.Add(new SqlParameter("@TaskName", _taskName));
                    command.Parameters.Add(new SqlParameter("@EventCode", _errorCode ?? string.Empty));
                    command.Parameters.Add(new SqlParameter("@EventDescription", _errorDescription ?? string.Empty));
                    command.Parameters.Add(new SqlParameter("@PackageDuration", _packageDuration));
                    command.Parameters.Add(new SqlParameter("@Host", _machineName));
                    command.Parameters.Add(new SqlParameter("@ExecutionID", _executionid));
                    command.Parameters.Add(new SqlParameter("@handlerdatetime", _handlerdatetime));
                    command.Parameters.Add(new SqlParameter("@uid", _uid));
                }
                else if (_connection is OleDbConnection)
                {
                    commandText = @"INSERT INTO SSISLog (EventType,PackageName,TaskName,EventCode,EventDescription,PackageDuration,Host,ExecutionID,EventHandlerDateTime,UID)
                                    VALUES (?,?,?,?,?,?,?,?,?,?)";

                    command = new OleDbCommand();

                    command.Parameters.Add(new OleDbParameter("@EventType", _eventType));
                    command.Parameters.Add(new OleDbParameter("@PackageName", _packageName));
                    command.Parameters.Add(new OleDbParameter("@TaskName", _taskName));
                    command.Parameters.Add(new OleDbParameter("@EventCode", _errorCode ?? string.Empty));
                    command.Parameters.Add(new OleDbParameter("@EventDescription", _errorDescription ?? string.Empty));
                    command.Parameters.Add(new OleDbParameter("@PackageDuration", _packageDuration));
                    command.Parameters.Add(new OleDbParameter("@Host", _machineName));
                    command.Parameters.Add(new OleDbParameter("@ExecutionID", _executionid));
                    command.Parameters.Add(new OleDbParameter("@handlerdatetime", _handlerdatetime));
                    command.Parameters.Add(new OleDbParameter("@uid", _uid));
                }

                command.CommandText = commandText;
                command.CommandType = CommandType.Text;
                command.Connection = _connection;

                command.ExecuteNonQuery();
                _connection.Close();
                return DTSExecResult.Success;

            }
            catch (Exception exc)
            {
                componentEvents.FireError(0, "CustomLoggingTask-Execute", "Task Errored: " + exc.ToString(), "", -1);
                return DTSExecResult.Failure;
            }
        }

        private void ReadVariables(VariableDispenser variableDispenser)
        {
            variableDispenser.LockForRead("System::StartTime");
            variableDispenser.LockForRead("System::PackageName");
            variableDispenser.LockForRead("System::SourceName");
            variableDispenser.LockForRead("System::MachineName");
            variableDispenser.LockForRead("System::ExecutionInstanceGUID");
            variableDispenser.LockForRead("System::EventHandlerStartTime");
            variableDispenser.LockForRead("User::UID");
            bool includesError = variableDispenser.Contains("System::ErrorCode");
            if (includesError)
            {
                variableDispenser.LockForRead("System::ErrorCode");
                variableDispenser.LockForRead("System::ErrorDescription");
            }

            Variables vars = null;
            variableDispenser.GetVariables(ref vars);

            DateTime startTime = (DateTime)vars["System::StartTime"].Value;
            _packageDuration = DateTime.Now.Subtract(startTime).TotalSeconds;
            _packageName = vars["System::PackageName"].Value.ToString();
            _taskName = vars["System::SourceName"].Value.ToString();
            _machineName = vars["System::MachineName"].Value.ToString();
            _executionid = vars["System::ExecutionInstanceGUID"].Value.ToString();
            _handlerdatetime = (DateTime)vars["System::EventHandlerStartTime"].Value;
            _uid = vars["User::UID"].Value.ToString();
            if (includesError)
            {
                _errorCode = vars["System::ErrorCode"].Value.ToString();
                _errorDescription = vars["System::ErrorDescription"].Value.ToString();
            }

            // release the variable locks.
            vars.Unlock();

            // reset the dispenser
            variableDispenser.Reset();
        }
    }
} 
```

只是为了记录，我给你留下一些我发现对开发、部署和调试自定义组件有用的链接（但也许你已经通过它们了！）：

[http://bennyaustin.wordpress.com/2009/06/30/steps-to-build-and-deploy-custom-ssis-components/](http://bennyaustin.wordpress.com/2009/06/30/steps-to-build-and-deploy-custom-ssis-components/)

[http://msdn.microsoft.com/en-us/library/ms403356%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms403356%28v=sql.105%29.aspx)

[http://toddmcdermid.blogspot.com.ar/2009/06/converting-your-script-task-into-custom_22.html](http://toddmcdermid.blogspot.com.ar/2009/06/converting-your-script-task-into-custom_22.html)

干杯。

# jquery - 谷歌地图点击标记功能问题

> ID：11265707
> 
> 赞同：0
> 
> 时间：2012-06-29T16:40:40.000
> 
> 标签：jquery, google-maps

你可以只有一个 window.location.href 吗？

问题只是标记的最后一次单击功能在单击时是正确的。其余的即使输出不同（这是正确的），它们总是打开最后一个 url。

注意cfloop。

```
 map = new google.maps.Map(document.getElementById("map"), options);
   // Create an Array for the Markers
   var markers = [];
     <cfloop array="#rc.details.poi.getPageRecords()#" index="local.poi">
      var latLng = new google.maps.LatLng(#local.poi.getpoiLat()#,#local.poi.getpoiLong()#);
      //var iconImg = '/assets/images/pin-50.png';

     <cfif !ArrayIsEmpty(local.poi.getimages())>
         var iconImg = new google.maps.MarkerImage("http://#CGI.HTTP_HOST#/plugins/api/index.cfm/image/#local.poi.getimages()[1].getimageID()#/50/50/get?apiKey=#application.factory.getBean('authenticationService').getAPIKey('image', 'GET')#&defaulttype=poi", null, new google.maps.Point(0,0), new google.maps.Point(0,0));
        <cfelse>
         var iconImg = new google.maps.MarkerImage("http://#CGI.HTTP_HOST#/plugins/api/index.cfm/image/1be71dec-a525-404f-a148-48ad74e46397/50/50/get?apiKey=#application.factory.getBean('authenticationService').getAPIKey('image', 'GET')#&defaulttype=poi", null, new google.maps.Point(0,0), new google.maps.Point(0,0));
      </cfif>

   var shadow = new google.maps.MarkerImage('/plugins/assets/images/AirTag50.png',
        // The shadow image is larger in the horizontal dimension
        // while the position and offset are the same as for the main image.
        new google.maps.Size(50, 80),
        new google.maps.Point(0,0),
        new google.maps.Point(0, 7));
        // Shapes define the clickable region of the icon.
        // The type defines an HTML <area> element 'poly' which
        // traces out a polygon as a series of X,Y points. The final
        // coordinate closes the poly by connecting to the first
        // coordinate.
    var shape = {
        coord: [1, 10, 10, 50, 55, 50,55 , 1],
        type: 'poly'
    };

    var URLonClick = "#buildURL(action='public:scape.view',queryString='scapeID=#local.poi.getScape().getscapeID()#&airtag=#local.poi.getpoiID()#')#";
     var marker = new google.maps.Marker({ position: latLng, map: map, draggable: false, title: 'Click to View AirTag', icon: iconImg, shadow: shadow, shape: shape, url: URLonClick });
     // Action Listener for the Marker
     google.maps.event.addListener(marker, 'click', function(event) {
            window.location.href = marker.url;
        });

      markers.push(marker);
    </cfloop>

    var mcOptions = {gridSize: 50, maxZoom: 15};
    var markerCluster = new MarkerClusterer(map, markers, mcOptions); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T18:04:17.510

这是关于函数闭包的。当您在循环内创建标记时，var URLonClick 的值会不断更新，因此最终它具有您放置的最后一个值。解决方案是在一个单独的函数中创建标记，向该函数传递必要的参数。

关于这个主题的好读物，在这里：

[http://econym.org.uk/gmap/closure.htm](http://econym.org.uk/gmap/closure.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T10:51:55.673

问题是**`marker.url`**

您正在覆盖每个循环上的标记变量，因此`marker.url`将始终指向已创建的最后一个标记的 url 成员。

使用**`this.url`**而不是**`marker.url`**访问单击标记的 url 成员。

# .net - 在 WebApi 中需要 SSL？

> ID：11265710
> 
> 赞同：68
> 
> 时间：2012-06-29T16:40:57.233
> 
> 标签：.net, ssl, asp.net-web-api

有没有办法要求 WebApi 使用 SSL？一个属性？

我在 下看不到适用`System.Web.Http`的属性，类似于`RequireHttps`我们为 MVC 拥有的属性。如果有内置解决方案，我只是想避免滚动我自己的属性/消息处理程序。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-05-01T09:37:23.243

```
public class RequireHttpsAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        if (actionContext.Request.RequestUri.Scheme != Uri.UriSchemeHttps)
        {
            actionContext.Response = new HttpResponseMessage(HttpStatusCode.Forbidden);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-06-29T20:25:05.080

您可以使用 WebAPIContrib 项目中的[RequireHttpsHandler](https://github.com/WebApiContrib/WebAPIContrib/blob/master/src/WebApiContrib/MessageHandlers/RequireHttpsHandler.cs)。基本上，它所做的只是检查传入的请求 URI 方案：

```
if (request.RequestUri.Scheme != Uri.UriSchemeHttps)
{
  // Forbidden (or do a redirect)...
} 
```

或者，Carlos Figueira在他的 MSDN 博客上有[另一个实现。](http://blogs.msdn.com/b/carlosfigueira/archive/2012/03/09/implementing-requirehttps-with-asp-net-web-api.aspx)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-09-12T14:59:12.093

令人费解的是，在 ASP.NET Web API 中没有等效于 ASP.NET MVC RequireHttps 属性。但是，您可以轻松地基于MVC 中的[RequireHttps](http://aspnetwebstack.codeplex.com/SourceControl/latest#src/System.Web.Mvc/RequireHttpsAttribute.cs)创建一个。

```
using System;
using System.Net.Http;
using System.Web.Http.Controllers;
using System.Web.Http.Filters;

...

public class RequireHttpsAttribute : AuthorizationFilterAttribute
{
    public override void OnAuthorization(HttpActionContext actionContext)
    {
        if (actionContext == null)
        {
            throw new ArgumentNullException("actionContext");
        }

        if (actionContext.Request.RequestUri.Scheme != Uri.UriSchemeHttps)
        {
            HandleNonHttpsRequest(actionContext);
        }
        else
        {
            base.OnAuthorization(actionContext);
        }
    }

    protected virtual void HandleNonHttpsRequest(HttpActionContext actionContext)
    {
        actionContext.Response = new HttpResponseMessage(System.Net.HttpStatusCode.Forbidden);
        actionContext.Response.ReasonPhrase = "SSL Required";
    }
} 
```

剩下要做的就是争论有多少冗余代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-03T13:32:03.393

您可以使用以下过滤器类来强制您的操作方法使用 SSL，这将处理您的请求，它是一个 GET 方法或任何其他动词，如果它是一个 get 方法，它会将浏览器（使用位置标头）重定向到新的URI。否则将显示一条消息以使用 https

下面的代码显示您必须在继承自 AuthorizationFilterAttribute 后重写 OnAuthorization 方法。

```
 string _HtmlBody = string.Empty;
        UriBuilder httpsNewUri;

        var _Request = actionContext.Request;

        if (_Request.RequestUri.Scheme != Uri.UriSchemeHttps )
        {

            _HtmlBody = "<p>Https is required</p>";

            if (_Request.Method.Method == "GET"){

                actionContext.Response = _Request.CreateResponse(HttpStatusCode.Found);
                actionContext.Response.Content = new StringContent(_HtmlBody, Encoding.UTF8, "text/html");

                httpsNewUri = new UriBuilder(_Request.RequestUri);
                httpsNewUri.Scheme = Uri.UriSchemeHttps;
                httpsNewUri.Port = 443;

                //To ask a web browser to load a different web page with the same URI but different scheme and port
                actionContext.Response.Headers.Location = httpsNewUri.Uri;

            }else{

                actionContext.Response = _Request.CreateResponse(HttpStatusCode.NotFound);
                actionContext.Response.Content = new StringContent(_HtmlBody, Encoding.UTF8, "text/html");

            }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-27T14:38:10.477

您可以使用以下代码；（自动重定向到 https）在发出基于 http 的请求时重定向到 https。

要在 Visual Studio 中检查它，您需要在 Visual Studio 中启用 ssl。这可以使用 enable ssl property to true 来完成。

```
public class RequireHttpsAttribute: AuthorizationFilterAttribute
{
    public override void OnAuthorization(HttpActionContext actionContext)
    {
        if(actionContext.Request.RequestUri.Scheme != Uri.UriSchemeHttps)
        {
            // constructing the https url
            var uriBuilder = new UriBuilder(actionContext.Request.RequestUri)
            {
                Scheme = Uri.UriSchemeHttps,
                Port = 44353 // port used in visual studio for this 
            };

            actionContext.Response.Headers.Location = uriBuilder.Uri;
        }
    }
} 
```

像这样在注册方法中使用它

```
config.Filters.Add(new RequireHttpsAttribute()); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-09-25T00:53:38.487

经过一些研究，我确定这可能是最合适的反应。尽管规范表明建议使用 Html，但它可以更新为提供 json、文本或 xml。

```
public class RequireHttpsAttribute : AuthorizationFilterAttribute
{
    public override void OnAuthorization(HttpActionContext context)
    {
        if (context.Request.RequestUri.Scheme != Uri.UriSchemeHttps)
        {
            context.Response = new HttpResponseMessage(HttpStatusCode.UpgradeRequired);
            context.Response.Headers.Add("Upgrade", "TLS/1.1, HTTP/1.1");
            context.Response.Headers.Add("Connection", "Upgrade");
            context.Response.Headers.Remove("Content-Type");
            context.Response.Headers.Add("Content-Type", "text/html");
            context.Response.Content = new StringContent("<html><head></head><body><h1>Http protocol is not valid for this service call.</h1><h3>Please use the secure protocol https.</h3></body></html>");
        }
        else base.OnAuthorization(context);
    }
} 
```

这是规范：[RFC 2817](https://www.rfc-editor.org/rfc/rfc2817#section-4.2 "RFC 2817")

# c# - 关联、聚合和组合

> ID：11265711
> 
> 赞同：5
> 
> 时间：2012-06-29T16:40:58.840
> 
> 标签：c#, oop, composition, aggregation

我正在处理这个问题。我正在创建数学问题，每个问题都有回应。例如。

*   **如果我的问题是关于“5x + 15 = 2 的结果？”** ，我将只等待一个答案（作为整数）。
*   **如果我的问题是关于“给我这个形状的面积和许可者”**，我将等待两个答案（作为双打）。
*   **在另一个中，我将等待一个字符串作为响应**
*   **还有一些，我可以有多种数据类型的答案或响应。**

我的大问题是。

班级问题和回答之间的关系如何。我也在处理这是否应该是一个关联、聚合或组合。

谢谢。

编辑：太好了，这是一个组合。最后一件事，根据上面的句子，我该如何表示设计？这些是我的一些想法，但我想我错了。

```
public class Question
{
    public Response _response;
    //public List<Response>
    //public Dictionary<string, Response>

    public Question()
    {
        this._response = new Response();
    }
}

public class Response
{
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-13T15:17:44.893

**关联**是所有对象都有自己的生命周期并且没有所有者的关系。让我们以教师和学生为例。多个学生可以与单个教师关联，单个学生可以与多个教师关联，但对象之间没有所有权，并且都有自己的生命周期。两者都可以独立创建和删除。

**聚合**是关联的一种特殊形式，其中所有对象都有自己的生命周期但有所有权：子对象不能属于另一个父对象。让我们以部门和老师为例。单个教师不能属于多个部门，但如果我们删除部门，教师对象不会被破坏。我们可以将其视为“拥有”关系。

**组合**再次是聚合的一种特殊形式，我们可以将其称为“死亡”关系。它是一种强大的聚合类型。子对象没有它们的生命周期，如果父对象被删除，所有子对象也将被删除。让我们再举一个 House 和 room 之间关系的例子。一个房子可以包含多个房间，一个房间没有独立的生命，一个房间不能属于两个不同的房子。如果我们删除房子，它的房间将被自动删除。让我们再举一个问题和选项之间的关系示例。单个问题可以有多个选项，一个选项不能属于多个问题。如果我们删除一个问题，它的选项也将被删除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T16:55:07.290

这两者之间存在关联。

问题组成答案。

这样做的原因是 - 聚合和组合都是关联。组合意味着子对象的生命周期取决于其父对象——没有父对象，子对象不能存在。

这正是你的情况。因此 - 组成。

# python - 我将如何迭代地编写这个递归函数？

> ID：11265717
> 
> 赞同：1
> 
> 时间：2012-06-29T16:41:14.377
> 
> 标签：python, function, recursion, iteration

在 Python 中：

```
def g(n):  
    if n <=3:        
        return n   
    return g(n-1) + 2 * g(n-2) + 3 * g(n-3) 
```

我理解这个函数在做什么，但我似乎不知道如何让它迭代。请帮忙。如果可能，请附上解释，以便我能完全理解问题所在。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T16:58:43.197

这看起来类似于斐波那契数列问题，并且以迭代方式实现并非易事。它看起来也像家庭作业，所以我将发布获得斐波那契迭代的步骤，您应该能够将其应用于您的问题。

如果你不知道，斐波那契是这样定义的：

```
def fib(n):
    if n <= 1:  # technically, this is not 100% correct, but it's fine for n>=0
        return n
    return fib(n-1) + fib(n-2) 
```

那么我们来分析一下`fib(n)`。首先我们看到有两种不同的情况：`n <= 1`和`not n <= 1`。For `n <= 1`,`fib(n)`没有依赖关系，所以我们可以评估：

```
def fib_iter(n):
    if n <= 1:
        return n 
```

现在我们需要介绍另一种情况。我们先来做一个依赖分析。我们需要`fib(n)`什么`n > 1`？我们调用`fib(n-1)`和`fib(n-2)`。在迭代语言中，这将是之前的两个值。很明显，我们需要跟踪这些。我们将从关于那个的两个琐碎案例开始：

```
def fib_iter(n):
    if n <= 1:
        return n
    prev1, prev2 = 0, 1 
```

我希望这是相当明显的。然后我们按照它们在递归方法中解析的顺序解析这些函数。在展开递归并分析函数时，我们发现要评估的第一个非平凡值当然是`fib(2)`。然后`fib(3)`以此类推，直到我们到达`n`。由于递归方法，多个值被多次评估，但我们不需要在迭代方法中。这些值被加在一起，这为我们提供了以下代码：

```
def fib_iter(n):
    if n <= 1:
        return n
    prev1, prev2 = 0, 1
    for i in xrange(2, n+1):
        curr = prev1 + prev2        # calculate fib(i)
        prev1, prev2 = prev2, curr  # shift previous value cache 
```

唯一缺少的是返回值，它正好`curr`在循环结束的时候。正如我们提前`xrange(2, n+1)`检查的`n <= 1`那样，循环将至少运行一次，因此`curr`将在循环之外定义。

```
def fib_iter(n):
    if n <= 1:
        return n
    prev1, prev2 = 0, 1
    for i in xrange(2, n+1):
        curr = prev1 + prev2
        prev1, prev2 = prev2, curr
    return curr 
```

（这是我的第一个家庭作业答案；如果我太宠坏了，SO 社区可能会给我反馈我本可以做得更好的地方）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T18:00:43.253

```
def g(n):
    if n <= 3:
        return n
    a, b, c = 1, 2, 3
    for i in range(3, n):
        a, b, c = b, c, (a * 3 + b * 2 + c)
    return c 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T18:25:41.507

您的递归函数可以读作

```
To find the value of g(30), find the value of g(29), g(28), and g(27)
  To find the value of g(29), find the value of g(28), g(27), and g(26)
    To find the value of g(28), find the value of g(27), g(26), and g(25)
      ...
        (repeat until all sub-finds have completed) 
```

迭代函数将从另一端开始，

```
I know the values of g(1), g(2), and g(3) -> calculate g(4)
I know the values of g(2), g(3), and g(4) -> calculate g(5)
I know the values of g(3), g(4), and g(5) -> calculate g(6)
...
(repeat until the desired g(n) is reached) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T17:33:13.530

这太有趣了，无法解决......

```
def g(n, *, _cache=[0, 1, 2, 3]):
    for _ in range(n - len(_cache) + 1):
        _cache.append(sum(i * _cache[-i] for i in (1, 2, 3)))
    return _cache[n] 
```

希望您已经找到了解决方案。

# python - Python中更好的方法链接方式？

> ID：11265720
> 
> 赞同：3
> 
> 时间：2012-06-29T16:41:23.550
> 
> 标签：python

所以我有一个很长的方法链，类似于：

```
return self.append_command("fbghasjfa").append_command(input_file_part).append_command(output_video_codec_part).append_command(output_resolution_part).append_command(output_video_bitrate_part).append_command(strict_part).append_command(output_audio_codec_part).append_command(output_number_of_audio_channels_part).append_command(output_audio_bitrate_part).append_command(output_file_part).__finalized 
```

它看起来很丑陋。有没有办法把每个方法放在单独的行上？像：

```
return self.append_command("ffasfgas")
.append_command("fvasgvsd")
.append_command("hsdhsdhsd")
#etc 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T16:45:07.050

您可以使用反斜杠续行：

```
return self.append_command("ffasfgas") \
    .append_command("fvasgvsd") \
    .append_command("hsdhsdhsd") 
```

或括号：

```
return (self.append_command("ffasfgas")
        .append_command("fvasgvsd")
        .append_command("hsdhsdhsd")) 
```

但最 Pythonic 的方法是将问题抽象为单个函数调用：

```
return self.append_commands("ffasfgas",
                            "fvasgvsd",
                            "hsdhsdhsd") 
```

使用`reduce`是另一种选择，但不是特别优雅：

```
return reduce(MyClass.append_command, ["ffasfgas",
                                       "fvasgvsd",
                                       "hsdhsdhsd"], self) 
```

甚至

```
return reduce(operator.methodcaller('append_command'),
              ["ffasfgas",
               "fvasgvsd",
               "hsdhsdhsd"], self) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T16:43:50.030

转义换行符或将表达式括起来。

```
foo \
.bar \
.baz

(foo
.bar
.baz) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T16:45:31.723

你可以这样做：

```
return self.append_command("ffasfgas") \
           .append_command("fvasgvsd") \
           .append_command("hsdhsdhsd") 
# etc 
```

# javascript - 在后台运行循环

> ID：11265724
> 
> 赞同：7
> 
> 时间：2012-06-29T16:41:37.403
> 
> 标签：javascript, loops, background, uiscrollview, titanium

因此，我需要在我的应用程序（用 JS 编写）的后台运行一个无限循环，该循环将用于每六秒循环一次 ScrollableView。然而，当这个循环运行时，我无法像你想象的那样在应用程序中执行任何其他操作。

总而言之，我怎样才能始终运行此循环，同时仍使应用程序运行？

代码：

```
function startScrolling() {
    for(; ; ) {
        sleep(6000);
        Ti.API.info('Scrolling To Index: ' + viewIndex);
        scrollView.scrollToView(viewIndex);
        if(viewIndex == 4) {
            viewIndex = 0;
            scrollView.scrollToView(viewIndex);
        } else {
            scrollView.scrollToView(viewIndex);
            viewIndex++;
        }
    }
}

function sleep(milliseconds) {
    var start = new Date().getTime();
    while((new Date().getTime() - start) < milliseconds) {
        // Do nothing
    }
} 
```

**编辑：解决方案**

```
setInterval(function() {
    Ti.API.info('Scrolling To Index: ' + viewIndex);
        scrollView.scrollToView(viewIndex);
        if(viewIndex == 4) {
            viewIndex = 0;
            scrollView.scrollToView(viewIndex);
        } else {
            scrollView.scrollToView(viewIndex);
            viewIndex++;
        }
}, 6000); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T16:43:20.790

看看[`window.setInterval()`](https://developer.mozilla.org/en/window.setInterval)。

```
/* 
    Calls a function repeatedly, with a fixed 
    time delay between each call to that function.
*/
setInterval(startScrolling, 6000); 
```

MDN 文档：[https ://developer.mozilla.org/en/window.setInterval](https://developer.mozilla.org/en/window.setInterval)

# eclipse - 无法在 Windows 7 上的端口 80 上运行 tomcat

> ID：11265725
> 
> 赞同：0
> 
> 时间：2012-06-29T16:41:38.237
> 
> 标签：eclipse, tomcat, windows-7, tomcat7

我想将tomcat 7配置为在windows 7上使用端口80，但似乎这个端口正在被另一个进程使用，以及如何解决这个问题而不给系统带来任何问题？

这是我得到的错误：

```
Port 80 required by Tomcat v7.0 Server at localhost is already in use. The server may already be running in another process, or a system process may be using the port. To start this server you will need to stop the other process or change the port number(s). 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T17:01:53.600

出于经验，Skype 通常会阻止端口。希望对您有所帮助。

`netstat -an |find /i "established"`在这种情况下可以帮助你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:01:36.730

在 cmd 中运行 netstat -ao ，您将获得正在使用的端口的 PID。

然后检查taskmgr，按PID排序，找到阻塞p80的程序。

作为个人说明：我打赌你已经启动并运行了 Skype，它喜欢阻塞端口 80

# javascript - AJAX 代码说明

> ID：11265732
> 
> 赞同：0
> 
> 时间：2012-06-29T16:42:14.960
> 
> 标签：javascript, jquery, ajax

我在搞乱 Jquery AJAX 几天，在网上我发现下面的代码：
我知道这段代码的作用，但我无法***理解***它的某些部分。例如，我不知道**(url)**是什么。我知道它是一个函数参数，但不知道它代表或包含什么。我也不明白这个函数里面的**responseText是什么。**所以我希望有人可以向我解释这些参数。对不起菜鸟问题！谢谢你！！

```
example_ajax_request(url) {

$('#example-placeholder').load(url, "",
    function(responseText, textStatus, XMLHttpRequest) {
        if(textStatus == 'error') {
            $('#example-placeholder').html('<p>There was an error making the AJAX request</p>');
        }
    }
);

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T16:46:26.823

[http://api.jquery.com/load](http://api.jquery.com/load)

`url`是您从中加载内容的 url，并且`responseText`包含从 ajax 请求返回的文本内容。您不需要做任何事情，`responseText`因为它会自动设置为`#example-placeholder`元素的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:47:09.900

url 是发送请求的 url。responseText 保存服务器的响应。在您的示例中， url 是之前必须设置的 var。也可以将字符串传递给函数，例如`'http://example.url'`一旦请求从服务器返回，将设置 responseText 变量，并将保存服务器呈现的任何数据。

# c++ - 将 libpng 链接到 android 本机项目

> ID：11265733
> 
> 赞同：2
> 
> 时间：2012-06-29T16:42:16.987
> 
> 标签：c++, eclipse, makefile, android-ndk, libpng

我在尝试在我的原生 android 项目中加载 libpng 时遇到问题。似乎编译器无法识别 libpng 函数，但可以识别类型（如 png_byte）。它可以使用类型正常编译，但如果我添加函数则会引发错误。

这是编译输出（Windows 7 cmd）：

```
D:\Dropbox\Workspace\Eclipse\GhostEngine\jni>C:\android-ndk-r8\ndk-build
"Compile++ thumb : ghost <= ImagePng.cpp
"Compile++ thumb : ghost <= MainAndroid.cpp
"Compile++ thumb : ghost <= PlatformAndroid.cpp
make: Circular D:/Dropbox/Workspace/Eclipse/GhostEngine//obj/local/armeabi/libst
lport_static.a <- D:/Dropbox/Workspace/Eclipse/GhostEngine//obj/local/armeabi/li
bstlport_static.a dependency dropped.
SharedLibrary  : libghost.so
D:/Dropbox/Workspace/Eclipse/GhostEngine//obj/local/armeabi/objs/ghost/ImagePng.
o: In function `loadPngFile':
D:/Dropbox/Workspace/Eclipse/GhostEngine//jni/ghost/ImagePng.cpp:48: undefined r
eference to `png_sig_cmp'
D:/Dropbox/Workspace/Eclipse/GhostEngine//jni/ghost/ImagePng.cpp:55: undefined r
eference to `png_create_read_struct'
D:/Dropbox/Workspace/Eclipse/GhostEngine//jni/ghost/ImagePng.cpp:61: undefined r
eference to `png_create_info_struct'
D:/Dropbox/Workspace/Eclipse/GhostEngine//jni/ghost/ImagePng.cpp:68: undefined r
eference to `png_create_info_struct'
D:/Dropbox/Workspace/Eclipse/GhostEngine//jni/ghost/ImagePng.cpp:75: undefined r
eference to `png_set_longjmp_fn'
D:/Dropbox/Workspace/Eclipse/GhostEngine//jni/ghost/ImagePng.cpp:77: undefined r
eference to `png_destroy_read_struct'
D:/Dropbox/Workspace/Eclipse/GhostEngine//jni/ghost/ImagePng.cpp:63: undefined r
eference to `png_destroy_read_struct'
D:/Dropbox/Workspace/Eclipse/GhostEngine//jni/ghost/ImagePng.cpp:70: undefined r
eference to `png_destroy_read_struct'
collect2: ld returned 1 exit status
make: *** [D:/Dropbox/Workspace/Eclipse/GhostEngine//obj/local/armeabi/libghost.
so] Error 1 
```

我在 libpng 中的 android.mk 看起来像这样：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_CFLAGS := 

LOCAL_MODULE    := libpng
LOCAL_SRC_FILES :=\
    png.c \
    pngerror.c \
    pngget.c \
    pngmem.c \
    pngpread.c \
    pngread.c \
    pngrio.c \
    pngrtran.c \
    pngrutil.c \
    pngset.c \
    pngtrans.c \
    pngwio.c \
    pngwrite.c \
    pngwtran.c \
    pngwutil.c 

LOCAL_LDLIBS := -lz

include $(BUILD_STATIC_LIBRARY) 
```

应用程序.mk：

```
APP_PLATFORM := android-10
STLPORT_FORCE_REBUILD := true
APP_STL := stlport_static
APP_MODULES := libpng ghost
#APP_CPPFLAGS += -fexceptions 
```

我的项目文件夹中的 Android.mk：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE := ghost
FILE_LIST := $(wildcard $(LOCAL_PATH)/*.cpp)
LOCAL_SRC_FILES := $(FILE_LIST:$(LOCAL_PATH)/%=%)
LOCAL_LDLIBS := -llog -landroid -lEGL -lGLESv2

# Support for additional libraries
#LOCAL_CFLAGS := -DANDROID_NDK -Wno-psabi
LOCAL_STATIC_LIBRARIES := android_native_app_glue
LOCAL_C_INCLUDES := $(LOCAL_PATH)/../libpng/
LOCAL_LDLIBS += -L$(SYSROOT)/usr/lib -ldl
LOCAL_LDLIBS += -L$(SYSROOT)/usr/lib -lz

include $(BUILD_SHARED_LIBRARY)

$(call import-module,android/native_app_glue) 
```

感谢您对这个主题的帮助。谢谢，马丁。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:57:25.857

我认为您可能需要将“libpng”添加到 LOCAL_STATIC_LIBRARIES 变量中。

如果这不起作用，请尝试`-lpng`在 Android.mk 文件中添加 LOCAL_LD_LIBS 变量。（需要哪一个取决于 libpng 库的放置位置。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:58:05.730

我`Makefile`对 Android 的 's 不熟悉，但您的问题是您没有与 libpng 链接。编译器生成目标文件是因为它具有 libpng 的头文件，但它不知道它应该与 libpng 链接（尝试添加`-lpng`）以及它的路径（如果它不在默认位置）。

# android - 带有自定义适配器和列表视图的 onItemClickListener

> ID：11265743
> 
> 赞同：6
> 
> 时间：2012-06-29T16:42:53.927
> 
> 标签：android, listview, android-arrayadapter, onitemclicklistener

我正在尝试使用自定义适配器和列表视图设置来设置 onItemClickListener。似乎无法让听众工作。我认为我没有正确设置它。任何帮助表示赞赏。非常感谢。

适配器：

```
public class ModuleAdapter extends ArrayAdapter<Module> {

Context context;
int layoutResourceId;
Module data[];

public ModuleAdapter(Context context, int layoutResourceId,
        Module data[]) {
    super(context, layoutResourceId, data);
    this.layoutResourceId = layoutResourceId;
    this.context = context;
    this.data = data;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    ModuleHolder holder = null;

    if(row == null)
    {
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent, false);

        holder = new ModuleHolder();
        holder.modJapTitle = (TextView)row.findViewById(R.id.moduleJapTitle);
        holder.modEngTitle = (TextView)row.findViewById(R.id.moduleEngTitle);
        holder.modComp = (TextView)row.findViewById(R.id.moduleCompletion);
        holder.modRating = (RatingBar)row.findViewById(R.id.moduleScore);

        row.setTag(holder);
    }
    else
    {
        holder = (ModuleHolder)row.getTag();
    }

    Module module = data[position];
    holder.modJapTitle.setText(module.moduleJapaneseTitle);
    holder.modEngTitle.setText(module.moduleEnglishTitle);
    holder.modComp.setText(module.moduleCompletionRate);
    holder.modRating.setRating(module.moduleRating);

    return row;
}

static class ModuleHolder
{
    TextView modEngTitle;
    TextView modJapTitle;
    TextView modComp;
    RatingBar modRating;
} 
```

}

执行：

```
ModuleAdapter moduleData = new ModuleAdapter(this, R.layout.module_box_item, module_data);
    ListView listView1 = (ListView)findViewById(R.id.moduleListContainer);
    listView1.setAdapter(moduleData);
    listView1.setCacheColorHint(Color.TRANSPARENT);
    listView1.setOnItemClickListener(new android.widget.AdapterView.OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            Log.v("Module Item Trigger", "Module item was triggered");
            Toast.makeText(getApplicationContext(), "hello", Toast.LENGTH_SHORT).show();
        }
    }); 
```

这里也是列表中单个项目之一的 XML 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
style="@style/moduleBox"
android:id="@+id/moduleBoxSingle" >

<TextView
    android:id="@+id/moduleJapTitle"
    style="@style/moduleTitleJap" />
<TextView
    android:id="@+id/moduleCompletion"
    android:layout_above="@+id/moduleSepartor"
    style="@style/moduleCompletion" />
<View
    android:id="@+id/moduleSepartor"
    android:layout_below="@+id/moduleJapTitle"
    style="@style/moduleSeperator" />
<TextView
    android:id="@+id/moduleEngTitle"
    android:layout_below="@+id/moduleSepartor"
    style="@style/moduleTitleEng" />
<RatingBar
    android:id="@+id/moduleScore"
    android:layout_below="@+id/moduleSepartor"
    style="@style/moduleRating"
    android:layout_alignParentRight="true" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-30T06:53:07.890

我认为这是类似的[问题](https://stackoverflow.com/questions/9765120/onlistitemclick-is-not-working-for-listview/9765368#9765368)。

`TextView`在 XML 中添加以下代码

```
android:focusableInTouchMode="false"
android:clickable="false"
android:focusable="false" 
```

然后再试一次。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T16:58:17.980

首先，您必须使用以下处理程序来隐含该类

```
implements  OnItemClickListener 
```

然后添加一个函数，如下所示 onItemClick()

```
public void onItemClick(AdapterView parent, View v, int position, long id) {
  Toast.makeText(getApplicationContext(), "hello", Toast.LENGTH_SHORT).show();   
} 
```

而当我们将数据适配器设置为 时，`listview`再添加以下代码行

```
itemlist.setOnItemClickListener(this); 
```

希望这对你有用...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-20T09:45:53.517

我有同样的问题，我通过这样做来解决它：（参考[https://github.com/sephiroth74/Horizo​​ntalVariableListView](https://github.com/sephiroth74/HorizontalVariableListView/issues/33) /issues/33 ）在布局的根视图中添加这一行

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
style="@style/moduleBox"
android:id="@+id/moduleBoxSingle"
android:descendantFocusability="blocksDescendants" > 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T03:19:48.423

试试这个...

```
ListView lv = (ListView)findViewById(R.id.Your_ListView_Id);  // If it extends Activity. 
```

或者

```
ListView lv = getListView;  // If it extends ListActivity.
lv.setOnItemClickListener(this); // Make the Activity implement onItemClickListener
lv.setAdapter(your_adapter); 
```

**编辑部分：在 Toast 的上下文中所做的更改，并添加了 SysOut**

// 将处理事件的方法。

```
public void onItemClick(AdapterView parent, View v, int position, long id{
     Toast.makeText(Your_Activity_Name.this, "hello", Toast.LENGTH_SHORT).show();
     System.out.println("This is a Test");
} 
```

**检查您的日志.. 是否打印了 SYSOUT 声明！**

# javascript - 以编程方式打开 Firefox 并执行 POST 请求？[想法：MozRepl，建议？]

> ID：11265744
> 
> 赞同：3
> 
> 时间：2012-06-29T16:42:59.843
> 
> 标签：javascript, firefox, post, mozrepl

在我的应用程序中，我需要一个按钮来打开 Firefox（如果尚未打开），执行包括文件上传在内的 POST 请求，并向用户显示结果页面（以便进一步导航）。

从我到目前为止的发现来看，这似乎需要使用像 MozRepl 或 JSSH 这样的 Firefox 扩展，所以我可以通过 Telnet 或 SSH 从我的应用程序连接到该进程。还有其他方法吗？我愿意接受好的建议...

然后我需要使用 content.XMLHttpRequest 来创建一个 POST 请求：

```
var req = new XMLHttpRequest();
req.open("POST", "http://myurl", true);
// [...]
req.send() 
```

但是 [...] 会带来什么？不知何故，有一个从本地表单构建的 File 对象；但是我怎样才能自己实例化和填充一个呢？以及如何让页面结果显示在 Firefox 中？

我可以将一个临时文件写入磁盘并从那里读取它，或者直接通过 Javascript/MozRepl 写入文件内容，两者都对我来说是可以接受的（但 1）可能不适用于 Javascript）。

在此先感谢，-M。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-30T22:45:02.703

您可以从命令行打开一个页面，该页面将包含已填写的表单和触发此表单发布的 JavaScript。XSS 保护仅适用于后台 XMLHttpRequest，如果您发布表单并自动将浏览移至该页面，则可以。

因此，您应该打开一个可以上传表单的网页。

但是你甚至不需要单独创建这个网页，你可以直接用 JavaScript 代替 URL 来设置它，就像书签一样工作：

```
firefox "javascript:'<html><body onload=\'document.forms[0].submit()\'><form action=\'http://www.example.com\' method=\'POST\'><input name=\'whatever\' value=\'whatever\' type=\'hidden\'></form></body></html>'" 
```

或者您可以创建一个将 GET 重定向到 POST 的 HTML 文件，然后用法如下：

```
file:///C:/getToPost?name1=value1&name2=value2#http://url.com/service 
```

此技术[在此超级用户答案](https://superuser.com/questions/426189/a/445984)中描述，并带有此类文件的源代码。

请注意，此 HTML 文件并非强制为本地文件，它可以放置在远程服务器上。但请注意，在远程文件浏览器的情况下，会将您的重定向页面通知最终网站作为 HTTP Referer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:47:43.000

您不能对服务器上包含发送到 POST 请求的 AJAX 代码的另一个页面执行 GET 请求吗？您始终可以使用任何可能包含查询字符串的 url 打开浏览器，而无需任何花哨的 API（即`system('firefox.exe http://stackoverflow.com')`。这样，您无需担心浏览器交互。

除此之外，为什么不在应用程序中发出 POST 请求并在应用程序中显示结果呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:47:53.940

从命令行：

```
firefox --new-window www.example.com 
```

将打开一个新的 Firefox 窗口，并导航到您提供的 URL。听起来您可以只使用您的 POST 目标作为 URL，但如果不是，您总是可以转到进行 $.POST 调用的页面。

# java - 查看布局中的位置

> ID：11265747
> 
> 赞同：1
> 
> 时间：2012-06-29T16:43:25.677
> 
> 标签：java, android

加载类（视图）：

```
public class Loading extends View {

    private long movieStart;
    private Movie movie;

    public Loading(Context context, InputStream inputStream) {
            super(context);
        movie = Movie.decodeStream(inputStream);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        canvas.drawColor(Color.WHITE);
        super.onDraw(canvas);
        final long now = SystemClock.uptimeMillis();
        if(movieStart == 0)
            movieStart = now;
        final int relTime = (int)((now - movieStart) % movie.duration());
        movie.setTime(relTime);
        movie.draw(canvas, 100, 100);
        this.invalidate();
    }

} 
```

活动 onCreate 方法：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    InputStream inputStream = null;
    try {
       inputStream = getAssets().open("loading.gif");
    } catch(IOException e) {
      e.printStackTrace();
    }
    Loading loading = new Loading(this, inputStream);
    setContentView(loading);
} 
```

我想将视图设置在设备布局的中心。就像在 XML 布局中一样，我们可以设置 android:layout_centerHorizo​​ntal="true"。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:56:55.363

您需要为视图设置 LayoutParams。我要做的是将您的自定义视图放入容器中，例如 FrameLayout。然后，创建您的视图并为您的视图设置 FrameLayout.LayoutParams，并将重力设置为 CENTER_HORIZONTAL。它看起来像这样

```
FrameLayout frame = new FrameLayout(context);

FrameLayout.LayoutParams flParams = new FrameLayout.LayoutParams(
    ViewGroup.LayoutParams.WRAP_CONTENT, 
    ViewGroup.LayoutParams.WRAP_CONTENT, 
    Gravity.CENTER_HORIZONTAL
);

Loading loading = new Loading(this, inputStream);
loading.setLayoutParams(flParams);
frame.addView(loading);
setContentView(frame); 
```

您可能需要配置 FrameLayout 以使其显示您想要的方式。

这是我将使用的 LayoutParams 构造函数的文档：http: [//developer.android.com/reference/android/widget/FrameLayout.LayoutParams.html#FrameLayout.LayoutParams%28int,%20int,%20int%29](http://developer.android.com/reference/android/widget/FrameLayout.LayoutParams.html#FrameLayout.LayoutParams%28int,%20int,%20int%29)

重要的是要记住，每个扩展 ViewParent 的 View 都有自己的 LayoutParams 类，因此，例如，如果您想使用 LinearLayout 而不是 FrameLayout，则可以使用 LinearLayout.LayoutParams。不同类型的 Params 具有不同的构造函数选项，因此您可以尝试使用它并找到最适合您的参数。祝你好运。

# java - WebLogic：如何使用服务器 x509 证书签署肥皂请求

> ID：11265748
> 
> 赞同：4
> 
> 时间：2012-06-29T16:43:28.883
> 
> 标签：java, weblogic, jax-ws, x509certificate, java-metro-framework

我正在尝试使用 WebLogic 10.3.6 库从独立的 JAX-WS 客户端调用 Metro 安全 Web 服务。WS 使用 2-way X.509 策略进行保护。

我的 WS 期望我的 SOAP 请求使用服务器公钥加密和签名。但是，在尝试了[WebLogic 手册](http://docs.oracle.com/cd/E23943_01/web.1111/e13713/message.htm "WebLogic 手册")中的示例后，我发现 JAX-WS 客户端使用客户端私钥对肥皂请求进行签名，并使用服务器公钥对它们进行加密。

*   需要：加密和签名 -> 服务器公钥
*   当前：加密 -> 服务器公钥；签名 -> 客户端私钥

如何配置我的独立客户端，以便它对 SOAP 请求进行所需的签名和加密？

客户端代码和策略粘贴在下面。谢谢，巴斯

**客户端代码：**

```
public class Main {
  public static void main(String[] args) {

    // Prepare request
    MyServiceService test = new MyServiceService();
    MyService port = test.getMyServicePort();

    // String constants to for server certificate, and client identity store
    String serverCertFile = "D:\\Development\\ws-config\\client_trust.der";
    String clientKeyStore = "D:\\Development\\ws-config\\client_store.jks";
    String clientKeyStorePass = "Leia";
    String clientKeyAlias = "trust";
    String clientKeyPass = "Leia";

    // Create list of credential providers
    List<CredentialProvider> credProviders = new ArrayList<CredentialProvider>();

    X509Certificate serverCertInit = null;
    CredentialProvider cp = null;
    try {
      // Create a credential provider with the client indentity and the server certificate
      serverCertInit = (X509Certificate) CertUtils.getCertificate(serverCertFile);
      serverCertInit.checkValidity();

      cp = new ClientBSTCredentialProvider(clientKeyStore, clientKeyStorePass, clientKeyAlias, clientKeyPass, "JKS", serverCertInit);
    } catch (Exception e) {
      e.printStackTrace();
      System.exit(1);
    }

    credProviders.add(cp);

    // Finally add the credential providers to the request context
    Map<String, Object> requestContext = ((BindingProvider) port).getRequestContext();
    requestContext.put(WSSecurityContext.CREDENTIAL_PROVIDER_LIST, credProviders);

    List certificate = CertUtils.getCertificate(clientKeyStore, clientKeyStorePass, clientKeyAlias, "JKS");

    final X509Certificate clientCert = (X509Certificate) certificate.get(0);
    final X509Certificate serverCert = serverCertInit;

    // Setup the TrustManager to verify the signature on the returned message
    requestContext.put(WSSecurityContext.TRUST_MANAGER, new TrustManager() {
      public boolean certificateCallback(X509Certificate[] chain, int validateErr) {
        // Check the server and client cert
        boolean validServer = chain[0].equals(serverCert);
        System.out.println("Server cert valid: " + validServer);
        boolean validClient = chain[0].equals(clientCert);
        System.out.println("Client cert valid: " + validClient);

        return validClient ^ validServer;
      }
    });

    // Invoke the service
    // port. ...
  }
} 
```

**WSDL 策略：**

```
<wsp:Policy wsu:Id="MyPortBindingPolicy">
    <wsp:ExactlyOne>
        <wsp:All>
            <wsam:Addressing wsp:Optional="false" />
            <sp:SymmetricBinding>
                <wsp:Policy>
                    <sp:ProtectionToken>
                        <wsp:Policy>
                            <sp:SecureConversationToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
                                <wsp:Policy>
                                    <sp:RequireDerivedKeys />
                                    <sp:BootstrapPolicy>
                                        <wsp:Policy>
                                            <sp:AsymmetricBinding>
                                                <wsp:Policy>
                                                    <sp:InitiatorToken>
                                                        <wsp:Policy>
                                                            <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
                                                                <wsp:Policy>
                                                                    <sp:WssX509V3Token10 />
                                                                    <sp:RequireIssuerSerialReference />
                                                                    <sp:RequireDerivedKeys />
                                                                </wsp:Policy>
                                                            </sp:X509Token>
                                                        </wsp:Policy>
                                                    </sp:InitiatorToken>
                                                    <sp:RecipientToken>
                                                        <wsp:Policy>
                                                            <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never">
                                                                <wsp:Policy>
                                                                    <sp:WssX509V3Token10 />
                                                                    <sp:RequireIssuerSerialReference />
                                                                    <sp:RequireDerivedKeys />
                                                                </wsp:Policy>
                                                            </sp:X509Token>
                                                        </wsp:Policy>
                                                    </sp:RecipientToken>
                                                    <sp:Layout>
                                                        <wsp:Policy>
                                                            <sp:Strict />
                                                        </wsp:Policy>
                                                    </sp:Layout>
                                                    <sp:IncludeTimestamp />
                                                    <sp:OnlySignEntireHeadersAndBody />
                                                    <sp:AlgorithmSuite>
                                                        <wsp:Policy>
                                                            <sp:Basic256 />
                                                        </wsp:Policy>
                                                    </sp:AlgorithmSuite>
                                                </wsp:Policy>
                                            </sp:AsymmetricBinding>
                                            <sp:Wss10>
                                                <wsp:Policy>
                                                    <sp:MustSupportRefIssuerSerial />
                                                </wsp:Policy>
                                            </sp:Wss10>
                                            <sp:EncryptedParts>
                                                <sp:Body />
                                            </sp:EncryptedParts>
                                            <sp:SignedParts>
                                                <sp:Body />
                                                <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing" />
                                                <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing" />
                                                <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing" />
                                                <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing" />
                                                <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing" />
                                                <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing" />
                                                <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing" />
                                                <sp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                                                <sp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                                                <sp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                                                <sp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                                            </sp:SignedParts>
                                        </wsp:Policy>
                                    </sp:BootstrapPolicy>
                                </wsp:Policy>
                            </sp:SecureConversationToken>
                        </wsp:Policy>
                    </sp:ProtectionToken>
                    <sp:Layout>
                        <wsp:Policy>
                            <sp:Strict />
                        </wsp:Policy>
                    </sp:Layout>
                    <sp:AlgorithmSuite>
                        <wsp:Policy>
                            <sp:Basic256 />
                        </wsp:Policy>
                    </sp:AlgorithmSuite>
                    <sp:IncludeTimestamp />
                    <sp:OnlySignEntireHeadersAndBody />
                </wsp:Policy>
            </sp:SymmetricBinding>
            <sp:Wss11>
                <wsp:Policy>
                    <sp:MustSupportRefIssuerSerial />
                    <sp:MustSupportRefThumbprint />
                    <sp:MustSupportRefEncryptedKey />
                </wsp:Policy>
            </sp:Wss11>
            <sp:Trust13>
                <wsp:Policy>
                    <sp:RequireClientEntropy />
                    <sp:RequireServerEntropy />
                    <sp:MustSupportIssuedTokens />
                </wsp:Policy>
            </sp:Trust13>
            <tcp:OptimizedTCPTransport enabled="true" />
        </wsp:All>
    </wsp:ExactlyOne>
</wsp:Policy>
<wsp:Policy wsu:Id="SecureInputMessagePolicy">
    <wsp:ExactlyOne>
        <wsp:All>
            <sp:EncryptedParts>
                <sp:Body />
            </sp:EncryptedParts>
            <sp:SignedParts>
                <sp:Body />
                <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                <sp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                <sp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                <sp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
            </sp:SignedParts>
        </wsp:All>
    </wsp:ExactlyOne>
</wsp:Policy>
<wsp:Policy wsu:Id="SecureOutputMessagePolicy">
    <wsp:ExactlyOne>
        <wsp:All>
            <sp:EncryptedParts>
                <sp:Body />
            </sp:EncryptedParts>
            <sp:SignedParts>
                <sp:Body />
                <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing" />
                <sp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                <sp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                <sp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
                <sp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrmp/200702" />
            </sp:SignedParts>
        </wsp:All>
    </wsp:ExactlyOne>
</wsp:Policy> 
```

# mercurial - 从 SVN 转换的 hg 存储库中的无操作合并失败

> ID：11265749
> 
> 赞同：0
> 
> 时间：2012-06-29T16:43:39.373
> 
> 标签：mercurial

似乎`hg convert`不承认这个项目应该只有一个头（我转换的SVN存储库没有任何分支）。我正在尝试使用[“无操作合并”技术](http://mercurial.selenic.com/wiki/PruningDeadBranches#No-Op_Merges)手动关闭旧头。但是，当我尝试这个时，我得到：

```
$ hg update -C tip
303 files updated, 0 files merged, 0 files removed, 0 files unresolved
$ hg merge $BRANCH
abort: merging with a working directory ancestor has no effect 
```

在我检查了提示之后，怎么可能既是头又是工作目录的祖先？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T09:48:01.493

它既可以是头，也可以是工作目录的祖先，因为它以前是一个“分叉”到当前头的分支，之后没有进行任何更改（所以是一个微不足道的分叉）。那里没有什么大秘密。

我相信在这种情况下不能使用“无操作合并”技术。请改用不同的技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:16:33.490

从中克隆另一个存储库会容易得多，`tip`这样您就不会得到所有其他的头。

在您当前的回购中，就像您所做的那样

```
hg update -C tip 
```

然后克隆它：

```
hg clone -r tip currentrepo newrepo 
```

新的存储库除了`tip`. 这有好有坏，取决于你如何看待它。

# html - 用户在 html 表单中的输入是否可以在没有 javascript 的情况下生成 python 列表

> ID：11265750
> 
> 赞同：0
> 
> 时间：2012-06-29T16:43:43.160
> 
> 标签：html, list, python-2.7, user-input

我希望最终使用 db.stringListProperty() 对用户的输入进行建模。如果可能的话，输入格式应该是什么样子？如何构建用户的输入（使用 []、引号、逗号等）？我将 jinja2 用于表单模板，如果这很重要的话。（如何验证数据输入正确的额外功劳。）谢谢。

我从 appengine 收到此错误。

```
raise BadValueError('Property %s must be a list' % self.name)
BadValueError: Property choices must be a list 
```

错误发生在下面的这一行。

person.choices = self.request.get('choices')

```
class PQ(db.Model):
    choices = db.StringListProperty()

    key = db.Key.from_path("PQ", ID_id)
    person = PQ.get(key)
    template_values = {'ID_id':person.key(),
                      'p': person,
                      }
    path = os.path.join(TEMPLATE_DIR, 'add_person.html')
    self.response.out.write(template.render(path, template_values))

class AddPerson(BaseHandler):
    def post(self):
        ID_id = self.request.get('ID')
        key = db.Key.from_path("PQ", ID_id)
        person = PQ.get(key)

        person.choices = self.request.get('choices')
        person.put()
        self.redirect("/?ID=%s" % ID_id)

add_person.html
<html>
  <body>

<div id="inputdata">
    <form action="add_person" method="post" enctype="multipart/form-data">
        <label>Enter your list of choices. Your list must follow this format:
            ["Less","Same","More"] </label>
    <input type="textbox" name="choices" size="30" value="{{ p.choices }}"></input><br/>
    <input type="submit" value="Submit"></input>
    </form>
</div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:03:32.207

似乎您收到此错误是因为`choices`必须是列表类型，但您从请求中获得的值是一个字符串 - 并且永远都是，因为您是从 HTTP 请求中获得的。

在表单方面，用户输入数据的格式并不重要，因为它总是作为字符串传递——一个逗号分隔的列表就足够了。然后你可以用 eg 解析它`self.request.get('choices').split(",")`（并修剪你身边的空白，这样你就不会因为确切的空白要求而打扰用户）。

最佳实践要求您应该尽可能地帮助用户 - 如果您有一组预定义的选择，您可以使用[Select2](http://ivaynberg.github.com/select2/)或类似的小部件来指导用户进行选择。

# iphone - iPhone 5.1 模拟器（视网膜）看起来好大

> ID：11265751
> 
> 赞同：8
> 
> 时间：2012-06-29T16:43:46.403
> 
> 标签：iphone, ios-simulator

我刚刚将 Xcode 从 4.2 升级到 4.3.3。然后我启动 iOS 模拟器（将“硬件 -> 设备”设置为“iPhone (Retina)”），模拟器现在显得如此之大，以至于应用页面必须滚动！！（以前它是正确的......不需要滚动）。甚至模拟器中的“主页”似乎也需要滚动！这是屏幕截图...请注意，“主页”的右侧和底部都有滚动条）...这是为什么呢？它不应该完全适合并且不需要任何滚动吗？

![在此处输入图像描述](../Images/5bcfbe24621a920b9615e37f89a3cef2.png)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-29T16:46:23.937

您可以使用 Command-1 或 Command-2 缩小视图。您还可以在硬件设备中将您的设备更改为非 Retina iPhone/iPad。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T17:43:21.487

我有一台 17 英寸的笔记本电脑，分辨率为 1920x1200，最新的 iPad 的分辨率为 2048x1536。iPad 实际上在任何一个方向上都有更多的像素作为我的笔记本电脑。

新的模拟器肯定会尝试向您展示所有像素，并且很可能以一对一的方式显示，这很可能会将模拟器关闭屏幕。

像素密度和总像素就是答案！！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T16:46:28.320

我的猜测是视网膜显示模拟器的像素密度比你的显示器高，但仍试图显示每个像素，因此它必须占用更多空间。

# java - 如何更改此代码以使命令提示符在完成执行后关闭？

> ID：11265754
> 
> 赞同：0
> 
> 时间：2012-06-29T16:43:51.787
> 
> 标签：java, batch-file, command

```
Runtime.getRuntime().exec("cmd /c start rake.bat"); 
```

我希望它运行 rake.bat 然后在完成后关闭命令行。我做过一次，但忘记了我做了什么。我正在使用 Java。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:34:26.047

您可能只是不需要`start`命令：

```
Runtime.getRuntime().exec("cmd /c rake.bat"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:50:18.957

将`Runtime`对象存储在变量中以使用它，然后`exit()`在完成后调用它的方法。

*退出（int状态）*：

> 通过启动其关闭序列来终止当前正在运行的 Java 虚拟机。

不存储在变量中：

```
Runtime.getRuntime().exit(0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T06:18:08.503

要关闭命令行，请使用此...

```
 Runtime.getRuntime().exec("cmd exit"); 
```

# java - 如何更正无效协议：使用 javax.mail 发送邮件为空

> ID：11265755
> 
> 赞同：4
> 
> 时间：2012-06-29T16:43:56.300
> 
> 标签：java, jakarta-mail, nosuchproviderexception

我正在尝试以这种方式发送邮件：

```
Properties props = new Properties();
props.setProperty("mail.transport.protocol", "smtp");
props.setProperty("mail.host", "out.alice.it");
props.setProperty("mail.user", "mymail@domain.it");
props.setProperty("mail.password", "*****");
Session mailSession = Session.getDefaultInstance(props, null);
Transport transport = mailSession.getTransport();
MimeMessage message = new MimeMessage(mailSession);
message.setFrom(new InternetAddress("Host", "Name")); 
```

在`Transport transport...`我检索此错误的行上：

```
javax.mail.NoSuchProviderException: Invalid protocol: null
    at javax.mail.Session.getProvider(Session.java:440)
    at javax.mail.Session.getTransport(Session.java:659)
    at javax.mail.Session.getTransport(Session.java:640)
    at javax.mail.Session.getTransport(Session.java:626)
    at Mail.sendMail(Mail.java:151) 
```

我该如何解决？有人能帮我吗？谢谢！！:)

编辑：

如果我创建一个 main 并启动该方法来发送邮件，它工作得很好！在我将邮件读入邮件文件夹后，我的问题就出现了：

```
Properties properties = System.getProperties();  
properties.setProperty("mail.store.protocol", "imap");  
Session session = Session.getDefaultInstance(properties, null);
Store store = session.getStore("pop3");
store.connect("pop3.domain.it", "mail@domain.it", "****");  
Folder inbox = store.getFolder("inbox");  
FlagTerm ft = new FlagTerm(new Flags(Flags.Flag.SEEN), false);
inbox.open(Folder.READ_ONLY);
Message messages[] = inbox.search(ft);
for(Message message:messages) {
   if(message.getFrom()[0].toString().equals("aMail")){
      sendMail(message.getFrom()[0].toString());//Error!
   }
} 
```

我认为异常的原因是我已经打开商店以获取收件箱邮件，所以我以这种方式编辑：

```
ArrayList<String> reply = new ArrayList<String();
for(Message message:messages) {
    if(message.getFrom()[0].toString().equals("aMail")){
        reply.add(message.getFrom()[0].toString());
    }
}
store.close();
for(String mail : reply){
   sendMail(mail); // ERROR AGAIN!
} 
```

很奇怪....

以这种方式解决：

我修改了这一行

```
Session mailSession = Session.getDefaultInstance(props, null); 
```

至

```
Session mailSession = Session.getInstance(props); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T17:16:03.177

你可以尝试另一种方式：

```
Properties props = new Properties();
props.setProperty("mail.transport.protocol", "smtp");
props.setProperty("mail.smtp.host", "out.alice.it");
props.setProperty("mail.smtp.auth", "true");
final PasswordAuthentication auth = new PasswordAuthentication(smtpUser, stmpPassword);
Session mailSession = Session.getDefaultInstance(props, new Authenticator() {
    @Override
    protected PasswordAuthentication getPasswordAuthentication() { return auth; }
});
MimeMessage message = ....;
// compose the message
Transport.send(message); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-28T00:09:00.937

我遇到了同样的错误，我的问题是我忘了包括：

```
props.put("mail.transport.protocol", "smtp"); 
```

# mysql - Mysql查询与联合和在哪里

> ID：11265756
> 
> 赞同：-1
> 
> 时间：2012-06-29T16:43:58.110
> 
> 标签：mysql, union, where-clause

在以下查询中，我想添加一个 where 语句以将结果缩小到具有 的结果`m.extracard>0`：

```
SELECT u.id, u.onoma_u, u.name_u,
coalesce(u.programa, a.programa) as programa,
coalesce(u.barcode, a.barcode) as barcode,
coalesce(u.plan, a.plan) as plan,
coalesce(u.im_exp, a.im_exp) as im_exp,
coalesce(u.symb, a.symb) as symb
FROM (SELECT a1.id, a1.onoma_u, a1.name_u, a1.programa, 
             a1.barcode, a1.plan, a1.im_exp, a1.symb
      FROM aitisi a1 
      where a1.id between 6017 and 6063
      UNION
           SELECT a2.id, m.name, m.surname, NULL, NULL, NULL, NULL, NULL
           FROM members m 
           JOIN aitisi a2 ON a2.id = m.symbid 
           WHERE m.extracard > 0
       ) u
JOIN aitisi a ON a.id = u.id 
where a.id between 6017 and 6063 
```

但在结果中，我得到的 ID 超出了 between 范围。有没有可能我把它放在`WHERE m.extracard > 0`了错误的地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:57:36.993

```
SELECT u.id, u.onoma_u, u.name_u,
coalesce(u.programa, a.programa) as programa,
coalesce(u.barcode, a.barcode) as barcode,
coalesce(u.plan, a.plan) as plan,
coalesce(u.im_exp, a.im_exp) as im_exp,
coalesce(u.symb, a.symb) as symb
FROM (SELECT a1.id, a1.onoma_u, a1.name_u, a1.programa, 
             a1.barcode, a1.plan, a1.im_exp, a1.symb
      FROM aitisi a1 
      JOIN mwmbers m ON a1.id = m.symbid 
           WHERE m.extracard > 0
      where a1.id between 6017 and 6063
      UNION
           SELECT a2.id, m.name, m.surname, NULL, NULL, NULL, NULL, NULL
           FROM members m 
           JOIN aitisi a2 ON a2.id = m.symbid 
           WHERE m.extracard > 0
       ) u
JOIN aitisi a ON a.id = u.id 
where a.id between 6017 and 6063 
```

# php - 使用 MYSQL ORDER BY 子句，是否可以按自定义顺序对某些字段进行 ORDER BY

> ID：11265759
> 
> 赞同：0
> 
> 时间：2012-06-29T16:44:01.790
> 
> 标签：php, mysql, sorting

我有这个名为`code`看起来像的专栏： `1-100-ETC-60`,,,`1-100-ETC-20``1-100-ETC-70`

最后两个字符总是以 6、2 或 7 开头。

如果我通过 SUBSTRING(code,13) ASC 或 DESC 进行排序，它将按数字顺序对它们进行排序。认为这不是我想要的（或客户想要的）。

正确的排序顺序应该是：6 然后 2 然后 7。

只是想知道这是否可以仅通过使用 SQL 查询来实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T17:01:54.313

您可以使用 MySQL 的[`FIELD()`](http://dev.mysql.com/doc/en/string-functions.html#function_field)功能：

```
ORDER BY FIELD(SUBSTRING(code, 11, 1), '6', '2', '7') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:46:41.677

使用案例陈述。

```
 ORDER BY CASE WHEN SUBSTRING(code,11) = '6' THEN '1' + substring(code, 12) ELSE SUBSTRING(code,11) END 
```

在这种情况下，应将 6 转换为 2 和 7 进行排序

（子字符串在 mysql 中索引为 1，所以是 11，而不是 10）

# c# - 在列表框中被选中后，我想在文本框中显示文件的内容

> ID：11265760
> 
> 赞同：0
> 
> 时间：2012-06-29T16:44:02.180
> 
> 标签：c#, silverlight

我按下一个按钮，我给定路径中的所有文件的列表就会出现在列表框中。

```
 IEnumerable<string> files = System.IO.Directory.EnumerateFiles(@"C:\Desktop\Stuffs\Dummi", "*.*", System.IO.SearchOption.AllDirectories);
        foreach (var f in files)
        {

            lbz.Items.Add(String.Format("{0}", f)); 
```

我希望能够从列表中选择一个文件并在列表框下方的文本框中打开它的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:48:44.160

这会将在所选项目中命名的文件的内容加载到文本框中：

```
TextBox1.Text = File.ReadAllText(lbz.SelectedItem.ToString()) 
```

这是最简单和最简单的方法。它适用于较小的文件，但如果您需要加载的文件较大，则加载文件可能需要很长时间，并且在加载时会锁定 UI。如果这是一个问题，您将需要在单独的线程上加载文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:55:19.570

[SteveDog 的答案](https://stackoverflow.com/a/11265825/105570)应该适用于小文件。

如果您有大文件，这可能会在读取文件内容时锁定 UI。在这种情况下，您可以使用 a`BackgroundWorker`来读取文件：

```
ListBox lbz;
TextBox tbx;
BackgroundWorker bgw;

void lbz_SelectedIndexChanged(object sender, EventArgs e)
{
    if (!bgw.IsBusy)
    {
        bgw.RunWorkerAsync(lbz.SelectedItem.ToString());
    }
}

void bgw_DoWork(object sender, DoWorkEventArgs e)
{
    e.Result = File.ReadAllText((string)e.Argument);
}

void bgw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    tbx.Text = (string)e.Result;
} 
```

# java - MATLAB MCR 中的 java 类路径设置是否跨 GLOBAL JAVA 作业？

> ID：11265762
> 
> 赞同：0
> 
> 时间：2012-06-29T16:44:24.473
> 
> 标签：java, matlab, classpath, matlab-deployment, matlab-compiler

我有一个 Java 代码来调用两个 MATLAB 作业。第一项工作是使用 javaaddpath 设置 java 类路径以包含 jdbc 驱动程序 jar。第二个工作是从数据库中读取数据。第一个作业成功执行。但是第二个作业不能拾取第一个作业设置的类路径。如果我使用 javaclasspath('-all') 打印出 java 类路径，则 jdbc 驱动程序 jar 不存在。javaaddpath 设置可以跨全局 java 作业吗？

我正在使用 MATLAB AND MCR 2012a。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:10:41.560

使用静态类路径解决了使用动态类路径时通常会出现的许多问题。

现在，当您部署 MATLAB 应用程序时，您可以手动将自定义`classpath.txt`文件放置在应用程序部署文件夹中。

# ios - 大型 JSON 数据的内存问题

> ID：11265765
> 
> 赞同：2
> 
> 时间：2012-06-29T16:44:37.187
> 
> 标签：ios, json

我的公司创建了一个供 iPad 应用程序使用的 Web 服务，并且没有内部 iOS 开发经验，我们将这项工作外包出去。

作为初始化过程的一部分，应用程序从 Web 服务接收一组 JSON 格式的起始数据。对于大多数应用程序用户来说，这个数据集的大小约为 4 MB（未压缩），应用程序可以毫无问题地处理这个问题。

对于较小的用户组，数据大小要大得多，大约 65 MB 未压缩。有了这个数据集，iPad 应用程序崩溃了，开发人员声称该应用程序正在被杀死，因为它使用了太多的内存。如果我理解正确，他们会说这是在尝试将 JSON 解析为内存对象时发生的。

我的感觉是具有 1 GB 内存的设备在处理 65 MB 数据时应该没有问题，但我没有基于 iOS 环境的经验。

有没有人能够在 iOS 中处理大量 JSON 数据？如果问题在于将整个 JSON 数据集加载到内存中，是否有适用于 iOS 的流式 JSON 解析器使用更少的内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:49:03.517

I don't believe the issue is with converting json into NSDictionaries/ NSArrays / NSStrings / NSNumbers.

My guess would be that you are using the result of the json with autoreleased objects in a tight loop, such as creating thumbnails for all images before the autoreleased pool is emptied.

If they doesn't not fit what your data is doing, can you give us some example as to what type of work is being done on the data set?

This is very bad code because it will continue to stack umcompressed uiimages into the autorelease pool which won't be hit until all the images have been downloaded and made into thumbnails.

```
NSArray* images = [jsonObject objectForKey:@"images"];

for(NSString* imageURL in images){
    NSURL* url = [NSURL URLWithString: imageURL];
    NSData* data = [NSData dataWithContentsOfURL: url];
    UIImage* image = [UIImage imageWithData: data];
    // write image to disk
    UIImage* thumbnail = CreateThumbnailFromImage(image);
    // write thumbnail to disk
} 
```

The same code can be fixed by adding in another autorelease pool that will clean up the autoreleased objects sooner.

```
for(NSString* imageURL in images){
    @autoreleasepool {
    NSURL* url = [NSURL URLWithString: imageURL];
    NSData* data = [NSData dataWithContentsOfURL: url];
    UIImage* image = [UIImage imageWithData: data];
    // write image to disk
    UIImage* thumbnail = CreateThumbnailFromImage(image);
    // write thumbnail to disk
    }
} 
```

# c# - 如何在 C# 程序中停止网络摄像头流式传输？

> ID：11265768
> 
> 赞同：0
> 
> 时间：2012-06-29T16:45:03.583
> 
> 标签：c#, user-interface, webcam

```
 private void button1_Click(object sender, EventArgs e)
    {

       cap = new Capture();
        Application.Idle += new EventHandler(showFromCam);
        button1.Hide();
    }

    private void button2_Click(object sender, EventArgs e)
    {

        button1.Show();
    } 
```

使用上面的代码，我通过单击 button1 将网络摄像头流式传输到我的应用程序中。我需要通过单击 button2 来关闭网络摄像头。有人可以建议任何方法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-26T09:23:13.970

我遇到了类似的问题，我找到了解决问题的方法。你应该调用`stop()`和`dispose()`方法。

```
private void button2_Click(object sender, EventArgs e)
{
    // stop the camera
    cap.Stop();
    cap.Dispose(); 

    button1.Show();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-26T22:58:20.830

我认为你应该使用 grabber = new Capture(); 抓取器.QueryFrame(); `Application.Idle -= FrameGrabber;`抓取器.Dispose（）；`

# c# - 使用 Windows Media Player SDK 获取最近或经常播放的播放列表

> ID：11265769
> 
> 赞同：0
> 
> 时间：2012-06-29T16:45:04.343
> 
> 标签：c#, .net, com, windows-media-player, wmp

*官方文档和 Visual Studio 中的对象浏览器都没有向我展示如何访问 Windows Media Player 最近的文件播放列表？还是经常出现的项目？*

即可以在 Windows 7 跳转列表中看到的内容 如何在 Windows Media Player 跳转列表中显示最近的文件而不是常用文件 [http://www.intowindows.com/how-to-display-recent-files-instead -of-frequent-files-in-windows-media-player-jump-list/](http://www.intowindows.com/how-to-display-recent-files-instead-of-frequent-files-in-windows-media-player-jump-list/)

### WMP 文档

播放列表和 PlaylistCollection 对象 [http://msdn.microsoft.com/en-us/library/windows/desktop/dd564122(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd564122(v=vs.85).aspx)

静态和自动播放列表 [http://msdn.microsoft.com/en-us/library/windows/desktop/dd564402(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd564402(v=vs.85).aspx)

播放列表和 MediaCollection 对象 [http://msdn.microsoft.com/en-us/library/windows/desktop/dd564121(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd564121(v=vs.85).aspx)

# gwt - GWT 如何制作由 2 种单元格组成的复合单元格或如何制作带有图像和文本的自定义单元格

> ID：11265775
> 
> 赞同：2
> 
> 时间：2012-06-29T16:45:20.557
> 
> 标签：gwt, datagrid, gwt-2.2-celltable, custom-cell, gwt-celltable

我想在包含图像+文本的单元格表/数据网格中添加一列。我只是做了一些研究，发现可能有 3 种方法可以做到这一点。

1.  制作一个 ImageResourceCell 和一个 TextCell 然后将它们组合成一个复合单元格。（还没有看到任何示例或参考，它只是从我的脑海中浮现出来。也许这行不通）

2.  使用 IconCellDecorator。我检查了文档。它说“一个将图标添加到另一个单元格的单元格装饰器”。不确定它是否可以做我想要的。我仍然没有找到任何关于它的例子。

3.  制作一个自定义单元格。GWT官网中有一个关于颜色名称和颜色样式组合的例子。我厌倦了这种结合图像和字符串的方式。但它不起作用。也许我的代码有问题，因为我不完全理解这些代码。

谁能给我一些关于实现这一目标的例子。你可以做任何你知道的方法。只需输入一些代码并给我看示例。

太感谢了。

此致

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-02T09:42:07.007

这不完全是您搜索的内容，但我认为您将能够修改我的示例。在这里，我使用 CompositeCell 来获取一个包含 2 个不同图像的 Cell，每个图像都呈现在一个 ImageCell 中。

```
//first make a list to store the cells, you want to combine
final ArrayList<HasCell> zellen = new ArrayList<HasCell>();

//then define the cells and add them to the list    
HasCell bearbeiten = new HasCell(){
    @Override
    public Cell getCell() {
        return new ImageCell();
    }

    @Override
    public FieldUpdater getFieldUpdater() {
        return null;
    }

    @Override
    public Object getValue(Object object) {
        String bearbBild = "images/pencil3.png";
        return bearbBild;
    }
};
zellen.add(bearbeiten);

HasCell ansicht = new HasCell(){

    @Override
    public Cell getCell() {
        return new ImageCell();
    }

    @Override
    public FieldUpdater getFieldUpdater() {
        return null;
    }

    @Override
    public Object getValue(Object object) {
        String ansichtBild = "images/gnome_edit_find.png";
        return ansichtBild;
    }
};
zellen.add(ansicht);

//use your CompositeCell in another Widget or Table         
Column<Benutzergruppe, Cell> options = new Column<Benutzergruppe, Cell>(new CompositeCell(zellen)){

    @Override
    public Cell getValue(Benutzergruppe object) {
        return zellen.get(0).getCell();
    }   
}; 
```

我将该列添加到 DataGrid，对我来说效果很好。

问候，妮可

# asp.net-mvc-3 - MVC3 与 AJAX 和验证的复杂模型绑定 - 获取动态图

> ID：11265776
> 
> 赞同：1
> 
> 时间：2012-06-29T16:45:27.593
> 
> 标签：asp.net-mvc-3

假设我有一些类似于这样的模型对象：

```
public class FooModel
{
    [Required]
    public string Name { get; set; }
    [StringLength(100)]
    public string Description { get; set; }
    public bool HasBar { get; set; }
    public BarModel Bar { get; set; }
}

public class BarModel
{
    [Required]
    public string Name { get; set; }
    [StringLength(100)]
    public string Description { get; set; }
    public bool HasWidgets { get; set; }
    public IEnumerable<WidgetModel> Widgets { get; set; }
}

public class WidgetModel
{
    [Required]
    public string Name { get; set; }
    [StringLength(100)]
    public string Description { get; set; }
    public string Type { get; set; }
    public bool Active { get; set; }
} 
```

我想为此构建一个视图`FooModel`，在`HasBar`检查输入后，将加载部分视图`Bar`，并完成验证（不显眼）。如果选中`Bar`'s `HasWidgets`，它将加载包含用于将类型项添加`WidgetModel`到表单数据的接口的部分视图。

单击表单的提交按钮时，我希望将完整的图表传递给控制器​​。

我想我可以用编辑器模板做这样的事情，但是我的子对象的命名方式不会被解析为图形的一部分（我希望是因为它们是在事后添加的，并且不知道它们是更大模型的一部分）。

是否有支持这种事情的机制/模式？我知道这有点递归，但我是否必须重新发明轮子才能正确命名所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:53:39.603

如果您的 UI 允许此解决方案，我建议您首先将所有模型加载到视图中，但隐藏“Bar”（以及“Widget”）部分（使用 CSS 隐藏）。然后使用 JavaScript/jQuery 展示它们。

即使“Bar”需要根据“Foo”属性值加载数据（而“Widget”取决于“Bar”），在第一步加载所有元素，然后通过 Javascript 或 AJAX 调用填充它们总是更容易.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:30:27.173

创建以下内容：

*   返回 BarModel 的操作
*   返回 WidgetModel 的操作
*   接受整个图或任何主对象的操作

检索各个组件，并在完成后提交到主操作。

```
public JsonResult GetBar(string name)
{
    var bar = //get bar
    return Json(bar);
}

public JsonResult GetWidget(string name)
{
    var widget = //get widget 
    return Json(widget);
}

[HttpPost]
public ActionResult SaveGraph(GraphModel graph)
{
    // save graph.Bar
    // save graph.Widget
    // save graph.Foo

    return ViewResult(graph);   // or redirect, JSON, etc.
} 
```

无论您的原始视图模型是什么，您都可以在您的客户端上构建和发布对象。

```
var graph = { Bar: { ... },
              Foo: { ... },
              Widget: { ... } 
            }

$.ajax({ url: '/mycontroller/savegraph',
         method: 'post',
         data: graph,
         success: function(resp) {
             // yay!
         }
      }); 
```

# jquery - Jquery方法来获取像节点一样的文本

> ID：11265783
> 
> 赞同：0
> 
> 时间：2012-06-29T16:46:03.270
> 
> 标签：jquery

我正在写博客，我想使用 jquery 效果使经过验证的帖子从 textarea 中消失，然后使其出现在帖子流中的 textarea 上方，如下所示：

```
//html 

...
<textarea id="textarea"></textarea>
...

<div class="invisible">
<div id="targetting"></div>
<div>
//script

$('#my-btn').click(function() {
    var comment = $('#textarea').val();
    $('.targetting:last').text(comment);

    var m = {$id};
    var data = {
          comment: $('#propo-textarea-spec').val(),
          m: {$id}
        };

        $.post('index.php?',data,function(callback_data){

        var content = $('div.my-btn').html();
        $('div .comments').append(content);

        var textarea=$('#textarea').val();
        $('textarea').fadeOut(1000,function(){
            $('.my-effect').fadeIn(800);
            $('.my-effect:last').css("display","none");

        });

   });
  }); 
```

但是淡出效果使我的文本区域完全消失（这是合乎逻辑的）。我试过`.text()`了，但没有用。我的问题是：像节点一样获取文本区域消息的 jquery 方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:49:11.820

```
var content = $('#textarea').val();
$('#textarea').parent().append( '<span class="blahnode">' ).html(content); 
```

如果我理解正确，会做你想做的事。

# java - 在独立的maven项目中将db属性加载到spring上下文文件中？

> ID：11265784
> 
> 赞同：0
> 
> 时间：2012-06-29T16:46:03.770
> 
> 标签：java, spring, hibernate

我有一个**独立的 Maven 项目**。我现在正在使用弹簧。我也想使用休眠。我可以将所有与数据库相关的属性放在外部属性文件中并将它们加载到 spring 上下文文件中吗？我的也是独立项目。我可以使用@Repository、@Service、@Autowired 注释吗？

我正在加载弹簧上下文，如下所示：

```
new ClassPathXmlApplicationContext(//passing spring context file path) 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T16:49:30.210

> 我可以将所有与数据库相关的属性放在外部属性文件中并将它们加载到 spring 上下文文件中吗？

是的，[使用`<context:property-placeholder />`](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-factory-placeholderconfigurer)

> 我的也是独立项目。我可以使用@Repository、@Service、@Autowired 注释吗？

是的，一起[使用`<context:annotation-config />`](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-annotation-config)[`<context:component-scan />`](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-scanning-autodetection)

在大多数情况下，Spring 不关心（或假装不关心）它是从 Main Class、Servlet 容器还是 JavaEE 服务器运行的。

# java - 添加到数组或链接器列表时游戏崩溃

> ID：11265789
> 
> 赞同：1
> 
> 时间：2012-06-29T16:46:21.330
> 
> 标签：java, android, arraylist, linked-list, andengine

所以我在添加到 ArrayList 或 Linked List 时遇到了问题（两者都试过，但每次崩溃都一样）。我正在研究 AndEngine 教程（Jimvaders，效果很好），但是在将其调整到我自己的项目时，它无法正常工作。基本上，当我射击子弹时，它会被添加到子弹列表中，但在我的项目中，试图从 playerChar 类中触摸位于 GameScene 中的 ArrayList 或 LinkedList 会导致整个游戏崩溃。我什至还没有对列表做任何事情，所以据我所知，这只是将我的 PlayerBullet 添加到导致问题的列表的行为。

游戏场景：

```
public ArrayList<PlayerBullet> bulletList; 
```

在我的 PlayerChar 类中

```
public void shoot(int playerFacing) { //TODO

    GameScene scene = (GameScene) BaseActivity.getSharedInstance().getCurrentScene();
    float shootX = 2;

    PlayerBullet b =(PlayerBullet)PlayerBulletPool.sharedBulletPool().obtainPoolItem();

    if (playerFacing == -1){
        shootX *= -1;
    }
    else{
        shootX += this.getWidth();
    }

    b.sprite.setPosition(this.getX() + shootX, this.getY()+(this.getHeight()/2));
    MoveXModifier mod = new MoveXModifier(0.5f, b.sprite.getX(), mCamera.getCenterX() + (mCamera.getWidth()*playerFacing));

    b.sprite.setVisible(true);
    b.sprite.detachSelf();
    scene.attachChild(b.sprite);
    //Log.v("checkin", "works to here");
    scene.bulletList.add(b);//<---------Crashes Here, works fine if this line is commented out

    //Log.v("checkin", "still working?");
    b.sprite.registerEntityModifier(mod);

} 
```

任何见解都会有所帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:54:55.593

我的猜测是你有一个 NullPointerException，尽管如果你告诉我们它会有所帮助。这一行：

```
scene.bulletList.add(b); 
```

要求`scene`和`scene.bulletList`都是非空的。我们可以说它`scene`是非空的，但我怀疑它`scene.bulletList`是空的——你*认为*你在哪里初始化它？

（顺便说一句，我强烈建议您避免使用公共变量。我可能会将一个`addBullet`方法放入`GameScene`- 并且可能使现在私有`bulletList`变量的类型`List<PlayerBullet>`......仅`ArrayList<E>`在初始化变量时指定。）

# search - 如果值与表单中的文本框值匹配，则删除工作表上的行？

> ID：11265795
> 
> 赞同：0
> 
> 时间：2012-06-29T16:46:28.853
> 
> 标签：search, excel, delete-row, userform, vba

好的，所以我在 excel 中有一个用户表单，并且表单上有一个名为“IMEITextBox”的文本框。我有一张库存表，在 Coloum B 中有 IMEI 编号，我有库存。当我在 IMEITextBox 中输入 IMEI 号码时，我希望它在保存时从工作表“库存”中删除包含该 IMEI 号码的行。我已经研究了好几天了。似乎找不到任何对我有用的东西。你能帮忙吗？

```
Sub DeleteRows(IMEI)

Dim ws As Worksheet
Dim lastRow As Long, i As Long
Dim strSearch As String
Dim aCell As Range

On Error GoTo Err
Set ws = Sheets("Inventory")
lastRow = ws.Range("IMEIRange" & Rows.Count).End(xlUp).Row
strSearch = IMEITextBox.Value
Set aCell = ws.Range("IMEIRange" & lastRow).Find(What:=strSearch, LookIn:=xlValues, _
LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
MatchCase:=False, SearchFormat:=False)
If Not aCell Is Nothing Then
  ws.Rows(lastRow).Delete
End If
Exit Sub
Err:
MsgBox Err.Description

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:02:40.597

我已经对代码进行了注释，以便您理解它不会有问题......看到代码后，您会意识到您非常接近;）

```
Option Explicit

Sub DeleteRows()
    Dim ws As Worksheet
    Dim strSearch As String
    Dim aCell As Range

    On Error GoTo Err

    '~~> Set the sheet where you want to search the IMEI
    Set ws = Sheets("Inventory")

    With ws
        '~~> Get the value which you want to search
        strSearch = IMEITextBox.Value

        '~~> Column A is Column 1 so Column B is 2\. This is where we are searching
        '~~> xlWhole is used in the code below so that we find a complete match
        '~~> xlPart is supposed to be used when you are finding a partial match.
        Set aCell = .Columns(2).Find(What:=strSearch, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False)

        '~~> Check if we found the value
        If Not aCell Is Nothing Then
            '~~> get the row of the cell where we found the match and delete it
            .Rows(aCell.Row).Delete
        Else '<~~ If not found
            MsgBox "IMEI Number not Found"
        End If
    End With

    Exit Sub
Err:
    MsgBox Err.Description
End Sub 
```

# python - 在两个文件中查找匹配项并输出它们

> ID：11265796
> 
> 赞同：0
> 
> 时间：2012-06-29T16:46:34.127
> 
> 标签：python, slider, analytics, match

我想使用第一个文件中的 x[#] 和第二个文件中的 x[#]，我想看看这两个值是否匹配，如果它们匹配，我想输出这些值以及其他几个 x[#] 值第二个文件，它们在同一行。

文件的格式：（但有数百万，我想在两个文件中找到对，因为它们都应该匹配）

```
 line 1  data,data,data,data
  line 2  data,data,data,data 
```

来自文件 1 的数据：

```
 (N'068D556A1A665123A6DD2073A36C1CAF', N'A76EEAF6D310D4FD2F0BD610FAC02C04DFE6EB67',    
N'D7C970DFE09687F1732C568AE1CFF9235B2CBB3673EA98DAA8E4507CC8B9A881'); 
```

来自文件 2 的数据：

```
00000040f2213a27ff74019b8bf3cfd1|index.docbook|Redhat 7.3 (32bit)|Linux
00000040f69413a27ff7401b8bf3cfd1|index.docbook|Redhat 8.0 (32bit)|Linux
00000965b3f00c92a18b2b31e75d702c|Localizable.strings|Mac OS X 10.4|OSX
0000162d57845b6512e87db4473c58ea|SYSTEM|Windows 7 Home Premium (32bit)|Windows
000011b20f3cefd491dbc4eff949cf45|totem.devhelp|Linux Ubuntu Desktop 9.10 (32bit)|Linux 
```

它的排序顺序是字母数字，我想使用滑块方法。我的意思是如果 file1[x] < file2[x] 根据一个值是否大于另一个值向下或向上移动滑块，直到找到匹配项，如果是，则打印输出以及其他值这将识别该哈希。

结果我想要的是：

file1[x] 及其在 file2[x] 上的对应匹配输出到一个文件，以及其他 file1[x]，其中 x 可以是该行的任何索引。值以及使用索引方法的其他值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T18:33:44.733

一个起点，添加你自己的盐和胡椒，它远非最佳，应该使用executemany等......但这由你决定。

```
from StringIO import StringIO
import csv
import sqlite3 as sq3
from operator import methodcaller, itemgetter
from itertools import groupby

data1 = """068D556A1A665123A6DD2073A36C1CAF
A76EEAF6D310D4FD2F0BD610FAC02C04DFE6EB67
D7C970DFE09687F1732C568AE1CFF9235B2CBB3673EA98DAA8E4507CC8B9A881"""

data2 = """00000040f2213a27ff74019b8bf3cfd1|index.docbook|Redhat 7.3 (32bit)|Linux
00000040f69413a27ff7401b8bf3cfd1|index.docbook|Redhat 8.0 (32bit)|Linux
00000965b3f00c92a18b2b31e75d702c|Localizable.strings|Mac OS X 10.4|OSX
0000162d57845b6512e87db4473c58ea|SYSTEM|Windows 7 Home Premium (32bit)|Windows
000011b20f3cefd491dbc4eff949cf45|totem.devhelp|Linux Ubuntu Desktop 9.10 (32bit)|Linux"""

file1 = StringIO(data1)
file2 = StringIO(data2)

db = sq3.connect(':memory:')
db.execute('create table keys (key)')
db.execute('create table details (key, f1, f2, f3)')

for f1data in file1:
    db.execute('insert into keys values(?)', (f1data.strip(),))

for f2data in file2:
    row = map(methodcaller('strip'), f2data.split('|'))
    db.execute('insert into details values (?,?,?,?)', row)

results = db.execute('select * from keys natural join details')

for key, val in groupby(results, itemgetter(0)):
    print key, list(val) 
```

# .net - 使用 .NET API 获取要在 Google Drive 中归档的公共 URL

> ID：11265798
> 
> 赞同：1
> 
> 时间：2012-06-29T16:46:36.390
> 
> 标签：.net, google-drive-api

我正在尝试获取存储在 Google Drive 中的给定文件的公共 URL。我想为通用二进制文件（即：没有 PDF、TXT 等，而是通用文件）执行此操作。

查看[https://developers.google.com/google-apps/documents-list/#downloading_documents_and_files](https://developers.google.com/google-apps/documents-list/#downloading_documents_and_files)可以*下载*文件，但我不想下载。我想获取公共 URL 以将其发布到其他地方。

请注意，该文件是在“任何有链接的人可见”级别共享的（所以如果我得到链接，任何有链接的人都可以看到它）。

我使用此处的建议找到了一个 hack：[获取公共 Google 文档文件的下载链接](https://stackoverflow.com/questions/9045392/getting-the-download-link-for-a-public-google-docs-file)。

我构建了类似[https://docs.google.com/uc?export=download&id=](https://docs.google.com/uc?export=download&id=) {Insert DocId here} 的 URL。我使用 Google Data .NET API 获取 DocId。

问题是 URL ( [https://docs.google.com/uc?export=download&id=](https://docs.google.com/uc?export=download&id=) ) 在我的代码中是硬编码的。我一直在寻找类以从 API 获取完整的 URL，而不是自己构建它。

顺便说一句：我正在使用 Google Data API 2.1 [http://code.google.com/p/google-gdata](http://code.google.com/p/google-gdata)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T00:24:34.280

您可以使用最近发布的 Google Drive API 版本 2 来列出`exportLinks`存储在 Drive 上的文件：

[https://developers.google.com/drive/v2/reference/files](https://developers.google.com/drive/v2/reference/files)

新版本 API 的 dll 将很快在[http://code.google.com/p/google-api-dotnet-client/wiki/APIs#Drive_API上发布](http://code.google.com/p/google-api-dotnet-client/wiki/APIs#Drive_API)

# c - 单步执行直到退出函数 gdb

> ID：11265803
> 
> 赞同：5
> 
> 时间：2012-06-29T16:46:54.887
> 
> 标签：c, multithreading, debugging, parallel-processing, gdb

我有一个正在处理的项目，它有多个文件，我使用 make 来编译项目。这是生成文件

```
CC =  /opt/gcc-4.7-cilkplus/bin/gcc
CFLAGS = -ggdb3 -Wall
COMPLILEFLAGS = `mysql_config --include` -I/opt/gcc-4.7-cilkplus/include/
LINKERINFO = `mysql_config --cflags --libs` -lrt -lm -lz
CILKFLAGS = -lcilkrts

# To be provided at the commandline
DIR = './bloom'
MODE = '2'
FILENAME = 'database.info'

exec: main.o mysql-client.o databaseConnection-common.o murmurhash3.o bloom-filter.o md5.o auxilary-functions.o
    $(CC) $(CFLAGS) -o exec main.o mysql-client.o databaseConnection-common.o murmurhash3.o bloom-filter.o \
    md5.o auxilary-functions.c $(LINKERINFO) $(CILKFLAGS)

main.o: main.c mysql-client.h databaseConnection-common.h bloom-filter.h
    $(CC) $(CFLAGS) $(COMPLILEFLAGS) -c main.c $(CILKFLAGS)

bloom-filter.o: bloom-filter.c bloom-filter.h murmurhash3.h auxilary-functions.h 
    $(CC) $(CFLAGS) $(COMPLILEFLAGS) -c bloom-filter.c

murmurhash3.o: murmurhash3.c murmurhash3.h
    $(CC) $(CFLAGS) -c murmurhash3.c

md5.o: md5.c md5.h
    $(CC) $(CFLAGS) -c md5.c

mysql-client.o: mysql-client.c mysql-client.h databaseConnection-common.h
    $(CC) $(CFLAGS) $(COMPLILEFLAGS) -c mysql-client.c

databaseConnection-common.o: databaseConnection-common.c databaseConnection-common.h
    $(CC) $(CFLAGS) $(COMPLILEFLAGS) -c databaseConnection-common.c

auxilary-functions.o: auxilary-functions.h auxilary-functions.c
    $(CC) $(CFLAGS) -c auxilary-functions.c

run:
    ./exec $(MODE) $(FILENAME) $(DIR) 
```

我设置`breakpoint`在某个位置，然后在`next`那里形成，但我得到了

`Single stepping until exit from function bf_dup_eleminate_read, which has no line number information.`

`bf_dup_eleminate_read`是 中的一个函数`bloom-filter.c`。即使`bloom-filter.c`使用正确的选项编译，我也无法理解为什么会发生这种情况

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T16:55:40.393

我在任何地方都看不到`-g`国旗。它通知编译器发出调试信息，因此如果您希望 gdb 显示行号，则需要将其添加到编译行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-04T14:12:42.107

尝试更新您的 gdb。可能是你的`gcc`版本太新了。我遇到了同样的问题并在更新我的 gdb 后修复了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-21T13:26:53.030

好吧，它是 2021 年，所以现在情况有些不同了。通常，我发现该`-ggdb`标志更有用。它不仅更冗长，而且似乎更不容易出错（但这是我的观点）。您还需要确保将`-ggdb`标志添加到所有目标文件中。提供某种参考，以及一种更可靠的方式来让您的项目在没有按预期调试的情况下进行。这是我刚刚构建并成功调试的项目的一个片段`VSCode v1.62.1`。它是用 编译**`GNU C++ Compiler g++ 10.3`**，用 调试**`GNU Debugger gdb v9.2`**，并使用 make 命令构建的**`GNU Make 4.2.1`**

```
# Here is an example from my current project that I debug on vscode
TARGET = A10
ALL = fraction.o main.o
GCC = g++
FLAGS = -Wall -c

${TARGET}: fraction.o main.o
    ${GCC} -Wall -ggdb ${ALL} -o ${TARGET}

main.o: main.cpp fraction.h
    ${GCC} -Wall -ggdb -c main.cpp

fraction.o: fraction.cpp fraction.h
    ${GCC} -Wall -ggdb -c fraction.cpp fraction.h 
```

# asp.net - 没有 Flash 的 ASP.NET 文件上传器控件

> ID：11265810
> 
> 赞同：0
> 
> 时间：2012-06-29T16:47:21.200
> 
> 标签：asp.net, ajax, flash, file-upload

我多年来一直在使用 obout 文件上传控件（[http://www.obout.com/Obout.Ajax.UI/FileUpload/](http://www.obout.com/Obout.Ajax.UI/FileUpload/)），它工作正常。我很舒服。但是现在我的客户提出了一个新要求。他想要一个没有flash的文件上传控制。但他需要以下功能：

1.  验证文件大小
2.  进度条

有人对此有解决方案吗？谁能指导我一步一步的程序。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T17:36:39.270

这在 ie9 和更早版本的浏览器以及 Android 2.3.x 和更早版本中是不可能的。对于其他浏览器，即支持文件 api 的浏览器：进度条和文件大小验证是 Fine Uploader 提供的众多功能中的一部分。也没有必需的依赖项。查看[演示页面](http://fineuploader.com)了解更多信息。

# python - PySide/PyQt - 启动 CPU 密集型线程会挂起整个应用程序

> ID：11265812
> 
> 赞同：15
> 
> 时间：2012-06-29T16:47:37.763
> 
> 标签：python, qt, pyqt4, pyside, qthread

我正在尝试在我的 PySide GUI 应用程序中做一件相当常见的事情：我想将一些 CPU 密集型任务委托给后台线程，以便我的 GUI 保持响应，甚至可以在计算进行时显示进度指示器。

这是我正在做的事情（我在 Python 2.7、Linux x86_64 上使用 PySide 1.1.1）：

```
import sys
import time
from PySide.QtGui import QMainWindow, QPushButton, QApplication, QWidget
from PySide.QtCore import QThread, QObject, Signal, Slot

class Worker(QObject):
    done_signal = Signal()

    def __init__(self, parent = None):
        QObject.__init__(self, parent)

    @Slot()
    def do_stuff(self):
        print "[thread %x] computation started" % self.thread().currentThreadId()
        for i in range(30):
            # time.sleep(0.2)
            x = 1000000
            y = 100**x
        print "[thread %x] computation ended" % self.thread().currentThreadId()
        self.done_signal.emit()

class Example(QWidget):

    def __init__(self):
        super(Example, self).__init__()

        self.initUI()

        self.work_thread = QThread()
        self.worker = Worker()
        self.worker.moveToThread(self.work_thread)
        self.work_thread.started.connect(self.worker.do_stuff)
        self.worker.done_signal.connect(self.work_done)

    def initUI(self):

        self.btn = QPushButton('Do stuff', self)
        self.btn.resize(self.btn.sizeHint())
        self.btn.move(50, 50)       
        self.btn.clicked.connect(self.execute_thread)

        self.setGeometry(300, 300, 250, 150)
        self.setWindowTitle('Test')    
        self.show()

    def execute_thread(self):
        self.btn.setEnabled(False)
        self.btn.setText('Waiting...')
        self.work_thread.start()
        print "[main %x] started" % (self.thread().currentThreadId())

    def work_done(self):
        self.btn.setText('Do stuff')
        self.btn.setEnabled(True)
        self.work_thread.exit()
        print "[main %x] ended" % (self.thread().currentThreadId())

def main():

    app = QApplication(sys.argv)
    ex = Example()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

该应用程序显示一个带有按钮的窗口。按下按钮时，我希望它在执行计算时自行禁用。然后，应重新启用该按钮。

相反，当我按下按钮时，整个窗口在计算进行时冻结，然后，当它完成时，我重新获得对应用程序的控制。该按钮似乎从未被禁用。我注意到的一件有趣的事情是，如果我`do_stuff()`用一个简单的 time.sleep() 替换 CPU 密集型计算，则程序会按预期运行。

我不完全知道发生了什么，但似乎第二个线程的优先级如此之高，以至于它实际上阻止了 GUI 线程被调度。如果第二个线程进入 BLOCKED 状态（就像它发生在 a 中一样`sleep()`），则 GUI 实际上有机会按预期运行和更新界面。我试图改变工作线程的优先级，但它看起来无法在 Linux 上完成。

此外，我尝试打印线程 ID，但我不确定我是否正确执行此操作。如果我是，线程亲和力似乎是正确的。

我还尝试了使用 PyQt 的程序，并且行为完全相同，因此标签和标题。如果我可以使用 PyQt4 而不是 PySide 运行它，我可以将整个应用程序切换到 PyQt4

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T17:03:12.077

这可能是由持有 Python 的 GIL 的工作线程引起的。在某些 Python 实现中，一次只能执行一个 Python 线程。GIL 阻止其他线程执行 Python 代码，并在不需要 GIL 的函数调用期间释放。

例如，在实际 IO 期间释放 GIL，因为 IO 由操作系统而不是 Python 解释器处理。

**解决方案：**

1.  显然，您可以`time.sleep(0)`在您的工作线程中使用以屈服于其他线程（[根据this SO question](https://stackoverflow.com/questions/787803/how-does-a-threading-thread-yield-the-rest-of-its-quantum-in-python)）。您必须定期调用`time.sleep(0)`自己，GUI 线程只会在后台线程调用此函数时运行。

2.  如果工作线程足够独立，你可以把它放到一个完全独立的进程中，然后通过管道发送腌制对象进行通信。在前台进程中，创建一个工作线程与后台进程做IO。由于工作线程将执行 IO 而不是 CPU 操作，因此它不会持有 GIL，这将为您提供一个完全响应的 GUI 线程。

3.  一些 Python 实现（JPython 和 IronPython）没有 GIL。

**CPython**中的线程仅对多路复用 IO 操作真正有用，而不是将 CPU 密集型任务置于后台。对于许多应用程序而言，CPython 实现中的线程从根本上被破坏了，并且在可预见的未来很可能会保持这种状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-08T18:07:08.907

最后，这适用于我的问题-代码可以帮助其他人。

```
import sys
from PySide import QtCore, QtGui
import time

class qOB(QtCore.QObject):

    send_data = QtCore.Signal(float, float)

    def __init__(self, parent = None):
        QtCore.QObject.__init__(self)
        self.parent = None
        self._emit_locked = 1
        self._emit_mutex = QtCore.QMutex()

    def get_emit_locked(self):
        self._emit_mutex.lock()
        value = self._emit_locked
        self._emit_mutex.unlock()
        return value

    @QtCore.Slot(int)
    def set_emit_locked(self, value):
        self._emit_mutex.lock()
        self._emit_locked = value
        self._emit_mutex.unlock()

    @QtCore.Slot()
    def execute(self):
        t2_z = 0
        t1_z  = 0
        while True:
            t = time.clock()

            if self.get_emit_locked() == 1: # cleaner
            #if self._emit_locked == 1: # seems a bit faster but less               responsive, t1 = 0.07, t2 = 150
                self.set_emit_locked(0)
                self.send_data.emit((t-t1_z)*1000, (t-t2_z)*1000)
                t2_z = t

            t1_z = t

class window(QtGui.QMainWindow):

    def __init__(self):
        QtGui.QMainWindow.__init__(self)

        self.l = QtGui.QLabel(self)
        self.l.setText("eins")

        self.l2 = QtGui.QLabel(self)
        self.l2.setText("zwei")

        self.l2.move(0, 20) 

        self.show()

        self.q = qOB(self)
        self.q.send_data.connect(self.setLabel)

        self.t = QtCore.QThread()
        self.t.started.connect(self.q.execute)
        self.q.moveToThread(self.t)

        self.t.start()

    @QtCore.Slot(float, float)
    def setLabel(self, inp1, inp2):

        self.l.setText(str(inp1))
        self.l2.setText(str(inp2))

        self.q.set_emit_locked(1)

if __name__ == '__main__':

    app = QtGui.QApplication(sys.argv)
    win = window()
    sys.exit(app.exec_()) 
```

# ms-access - 在哪里可以找到 Microsoft Access SQL 的完整参考资料？

> ID：11265817
> 
> 赞同：11
> 
> 时间：2012-06-29T16:48:19.950
> 
> 标签：ms-access, jet-sql

我正在寻找 Microsoft Access 所理解的 SQL 的明确参考。我能找到的所有链接都只谈论点点滴滴。理想情况下，我正在寻找一个语法规范，其中包含所有不同关键字的作用的详细信息。

动机：我正在尝试为 Microsoft Access SQL 语句编写自己的解析器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-11T11:53:26.487

打开 MS Access，转到一个模块并打开它，调出代码编辑器。在代码编辑器中，选择帮助 > Microsoft Visual Basic 帮助。现在选择“Microsoft Jet SQL 参考”。

我将很快发布一个包含 JET SQL 解析器的库。它增强了 JET SQL 以提供 SQL 中当前不可用的所有 DDL 功能，并使用版本号和版本更新脚本提供自动后端更新。

编辑：当然，我忘记了他们可能在更高版本的 Office 中搞砸了这一切。

我检查了以上内容在 Access 2003（最后一个可用的 Access 版本，我仍然用于开发）和 Access 2007 中工作。注意你必须在代码窗口中，而不是在主 Access 数据库窗口中！

在 Access 2013 中，这一切都转移到了网络上。然而，看起来网页上仍然有一个“开发者参考”链接，这会将您带到一个与离线页面基本相似的页面。单击一些链接后，我将访问：[msdn.microsoft.com/en-us/library/dn142571.aspx](http://msdn.microsoft.com/en-us/library/dn142571.aspx)

希望由于这是 Access 2013，因此链接不会很快消失。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T17:44:34.000

我刚刚做了一个快速的谷歌搜索，发现了这个：

*   [Microsoft Jet SQL 参考 (Access 2003)](http://office.microsoft.com/en-us/access-help/CH006252688.aspx)
*   [Microsoft Jet SQL 参考 (Access 2007)](http://office.microsoft.com/en-us/access-help/CH010072899.aspx)

对我来说，这看起来像你想要的，或者这些是你已经找到的一些“唯一的点点滴滴”链接？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-04T11:30:17.647

看起来我在这方面的游戏迟到了：但我正在寻找类似的东西，而且可以公平地猜测，你和我并不是唯一会寻找这些信息的人。

**尽我所能搜索到，在 Microsoft 的任何网站上都没有关于 Jet-SQL 的明确语言参考文档。**

这里有一个 Jet-SQL 关键字列表：

[http://support.microsoft.com/kb/248738](http://support.microsoft.com/kb/248738)

可以预见的是，这没有指向关键字基础功能的描述和规范的超链接。

我得到的最接近的是别人搜索的谷歌结果：

[http://office.microsoft.com/en-us/support/results.aspx?ctags=CH010072899](http://office.microsoft.com/en-us/support/results.aspx?ctags=CH010072899)

但是，这不是您想要的答案：它只是另一个“点点滴滴”的选择 - 不是明确的语言参考。它可以通过填补空白来帮助您（或者更确切地说，像我这样的后来的搜索者），因此它并非完全没用。

您为回答自己的问题所做的努力可能会以一种方便的格式找到缺失的数据。如果是这样，您将通过发布带有链接的后续答案来为开发人员社区提供有价值的服务。

完全有可能“停止搜索，它不存在”是当今可用的最有用的答案：令人失望，但如果其他人注意警​​告并减少浪费时间，则很有帮助。

如果 Stack Overflow 的其他成员反驳我的断言，即 Microsoft 没有为 Jet SQL 发布明确的语言规范，我会很高兴。然而，我怀疑这是否可能：MSDN 是一个死胡同和“浅坟”的集合——这些文件无处可寻相关信息，以及由隐藏了无数数据体的掘墓者“记录”的信息，因此他们只会永远如果有人确切地知道在哪里挖掘，就会看到曙光。

# android - 我的可展开列表视图不会展开

> ID：11265819
> 
> 赞同：3
> 
> 时间：2012-06-29T16:48:23.377
> 
> 标签：android, listview, android-listview

我正在尝试创建一个可扩展的列表视图。组的初始视图显示良好，唯一的问题是......当我单击它们时没有任何反应。没有扩展什么的。我已经遵循了我见过的大多数教程，但没有任何东西可以解决它！感谢您的帮助，这是我正在使用的代码：

特点适配器：

```
package com.me.app;

import java.util.HashMap;
import java.util.List;

import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseExpandableListAdapter;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.CompoundButton.OnCheckedChangeListener;
import android.widget.TextView;

public class FeaturesAdapter extends BaseExpandableListAdapter
{

private Context mContext;
private HashMap<String, List<String>> mFeatures = new HashMap<String, List<String>>();
private HashMap<Integer, String> mList = new HashMap<Integer, String>();

public FeaturesAdapter (Context con)
{
    mContext = con;
}

public boolean AddGroup(final String groupName, final List<String> features)
{
    final List<Feature> prev = mFeatures.put(groupName, features);

    if (prev != null)
        return false;

    mList.put(mFeatures.size() - 1, groupName);

    notifyDataSetChanged();
    return true;
}

@Override
public Object getChild(int groupPos, int childPos) 
{
    if (mList.containsKey(groupPos))
    {
        final String str = mList.get(groupPos);
        final List<Feature> data = mFeatures.get(str);

        return data.get(childPos);
    }

    return null;
}

@Override
public long getChildId(int groupPos, int childPos) 
{  
    return 0;
}

@Override
public View getChildView(int groupPos, int childPos, boolean isLastChild, View convertView, ViewGroup parent) 
{
    View rowView = convertView;
    FeatureView fView = null;
    int gPos = groupPos;
    int cPos = childPos;

    if (rowView == null)
    {
        LayoutInflater inflater = (LayoutInflater)mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);           
        rowView = inflater.inflate(R.layout.feature_row, null);

        fView = new FeatureView();
        fView.feature_name = (TextView) rowView.findViewById(R.id.feature_name);
        fView.feature_checked = (CheckBox) rowView.findViewById(R.id.feature_checked);

        rowView.setTag(fView);
    }
    else
        fView = (FeatureView) rowView.getTag();

    String str = mList.get(gPos);
    List<Feature> data = mFeatures.get(str);
    Feature feature = data.get(cPos);

    fView.feature_name.setText(feature.getName());
    fView.feature_checked.setChecked(feature.getChecked());
    int [] values = {gPos,cPos};
    fView.feature_checked.setTag(values);

    fView.feature_checked.setOnCheckedChangeListener(new OnCheckedChangeListener() 
    {
        @Override
        public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) 
        {
            doThings();             
        }
    });

    return rowView;
}

protected static class FeatureView {
    protected TextView feature_name;
    protected CheckBox feature_checked;
}

@Override
public int getChildrenCount(int groupPos) 
{
    if (mList.containsKey(groupPos))
        return mFeatures.get(mList.get(groupPos)).size();

    return 0;
}

@Override
public Object getGroup(int groupPos) 
{
    if (mList.containsKey(groupPos))
        return mFeatures.get(mList.get(groupPos));

    return null;
}

@Override
public int getGroupCount() 
{
    return mFeatures.size();
}

@Override
public long getGroupId(int groupPos) 
{
    return 0;
}

@Override
public View getGroupView(int groupPos, boolean isExpanded, View convertView, ViewGroup parent) 
{
    View rowView = convertView;
    FeatureView fView = null;
    int gPos = groupPos;

    if (rowView == null)
    {
        LayoutInflater inflater = (LayoutInflater)mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);           
        rowView = inflater.inflate(R.layout.group_row, null);

        fView = new FeatureView();
        fView.feature_name = (TextView) rowView.findViewById(R.id.group_name);
        fView.feature_checked = (CheckBox) rowView.findViewById(R.id.group_checked);

        rowView.setTag(fView);
    }
    else
        fView = (FeatureView) rowView.getTag();

    String str = mList.get(groupPos);
    List<Feature> data = mFeatures.get(str);

    fView.feature_name.setText(mList.get(groupPos));
    boolean flag = false;
    for (Feature feat : data)
    {
        if (feat.getChecked())
            flag = true;
    }
    fView.feature_checked.setChecked(flag);
    int[] values = {gPos};
    fView.feature_checked.setTag(values);

    fView.feature_checked.setOnCheckedChangeListener(new OnCheckedChangeListener() 
    {
        @Override
        public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) 
        {
            doOtherThings();
    });

    return rowView;
}

@Override
public boolean hasStableIds() 
{
    return false;
}

@Override
public boolean isChildSelectable(int groupPos, int childPos) 
{
    return false;
}
} 
```

这是我在实际文件中的代码：

```
 super.onCreate(savedInstanceState);
    this.setContentView(R.layout.feature_list);

    FeaturesAdapter adapter = new FeaturesAdapter(this);

    mBye.add("Cya");
    mBye.add("Bye");
    mBye.add("Adios");
    mBye.add("Goodbye");
    adapter.AddGroup("Bye", mBye);

    mStuff.add("Hi"));
    mStuff.add("Hey"));
    mStuff.add("Hello"));
    adapter.AddGroup("Salutations", mStuff);

    mSlang.add(new Feature("Yo"));
    adapter.AddGroup("Slang", mSlang);

    setListAdapter(adapter);
    ExpandableListView elv = getExpandableListView();
    elv.setTextFilterEnabled(true); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T17:38:01.557

我们有一个赢家。如果 ExpandableListView 中有可聚焦元素，则需要在其 xml 设置中设置 android:focusable="false"。哇哦。

# c# - 如何使用 Automapper 在两个枚举之间进行映射？

> ID：11265829
> 
> 赞同：59
> 
> 时间：2012-06-29T16:48:59.603
> 
> 标签：c#, automapper

我有一个面向公众的界面，我试图将两个不同的枚举相互映射。我尝试使用以下代码：

```
Mapper.CreateMap<Contract_1_1_0.ValidationResultType, Common.ValidationResultType>(); 
```

当那不起作用时，我尝试了：

```
Mapper.CreateMap<Contract_1_1_0.ValidationResultType, Common.ValidationResultType>().ConvertUsing(x => (Common.ValidationResultType)((int)x)); 
```

但这似乎也不起作用。反正有没有让自动映射器来处理这种情况？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2015-07-08T16:31:26.950

除了编写自定义转换器，只需使用 ConvertUsing()

```
Mapper.CreateMap<EnumSrc, EnumDst>().ConvertUsing((value, destination) => 
{
    switch(value)
    {
        case EnumSrc.Option1:
            return EnumDst.Choice1;
        case EnumSrc.Option2:
            return EnumDst.Choice2;
        case EnumSrc.Option3:
            return EnumDst.Choice3;
        default:
            return EnumDst.None;
    }
}); 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-06-29T20:43:32.727

您不需要为枚举类型执行 CreateMap。只要去掉 CreateMap 调用，它就可以工作，只要枚举类型之间的名称和/或值匹配。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-05-24T19:13:37.833

我的 Automapper 以这种方式工作：

**如果我创建一个地图：** Automapper 将按值匹配枚举，即使名称完全匹配。

**如果我不创建地图：** Automapper 将按名称匹配枚举。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-04-16T11:48:27.290

这里的其他答案对我不起作用。

您需要创建一个实现的类：

```
ITypeConvertor<SourceType ,DestinationType> 
```

举个例子

```
 Mapper.CreateMap<EnumType1.VatLevel, EnumType2.VatRateLevel>()
       .ConvertUsing(new VatLevelConvertor()); 
```

和班级：

```
internal class VatLevelConvertor : ITypeConverter<EnumType1.VatLevel, EnumType2.VatRateLevel>
{
    public EnumType2.VatRateLevel Convert(ResolutionContext context)
    {
        EnumType1.VatLevel value = (EnumType1.VatLevel)context.SourceValue;
        switch (value)
        {
            case EnumType1.VatLevel.Standard:
                return EnumType2.VatRateLevel.Normal;
            case EnumType1.VatLevel.Reduced:
                return EnumType2.VatRateLevel.Lower;
            case EnumType1.VatLevel.SuperReduced:
                return EnumType2.VatRateLevel.Other;
            default:
                return EnumType2.VatRateLevel.Other;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-10-14T07:46:28.590

我发现对我有用的最简单方法如下：

我的 Enum 嵌套在另一个类中，所以我使用 ForMember 方法和 MapFrom 如下：

```
 Mapper.CreateMap<ProblematicCustomer, ProblematicCustomerViewModel>()                
            .ForMember(m=> m.ProblemType, opt=> opt.MapFrom(x=> (ProblemTypeViewModel)(int)x.ProblemType))
            .ForMember(m=> m.JudgmentType, opt=> opt.MapFrom(x=> (JudgmentTypeViewModel)(int)x.JudgmentType)); 
```

ProblemType 和 JudgmentType 是枚举。它们的相关视图模型是 ProblemTypeViewModel 和 JudgmentTypeViewModel，它们的成员与其相关模型相同。

虽然我没有测试，但我认为下面的行应该适合你：

```
Mapper.CreateMap<Contract_1_1_0.ValidationResultType, Common.ValidationResultType>()
           .ForMember(m=> m, opt => opt.MapFrom(x=> (Common.ValidationResultType)(int)x); 
```

希望它有所帮助。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-02-11T18:00:48.847

这是在两种具有不同值的 Enum 类型之间进行转换的一种可能性，同时仍使用 AutoMapper。就我而言，我需要使用 AutoMapper，因为 Enum 类型是由 AutoMapper 转换的其他实体的属性；对这些实体使用 AutoMapper 是一项要求。

第一步是像这样设置 Mapper 配置：

```
Mapper.CreateMap<EnumSrc, EnumDst>()
    .ConstructUsing(EnumConversion.FromSrcToDst); 
```

调用`.ConstructUsing(...)`允许我们传入我们自己的方法来进行转换。转换方法非常简单：

```
public class EnumConversion
{
    internal static EnumDst FromSrcToDst(ResolutionContext arg)
    {
        EnumSrc value = (EnumSrc)arg.SourceValue;
        switch(value)
        {
            case EnumSrc.Option1:
                return EnumDst.Choice1;
            case EnumSrc.Option2:
                return EnumDst.Choice2;
            case EnumSrc.Option3:
                return EnumDst.Choice3;
            default:
                return EnumDst.None;
        }
    }
} 
```

我们只需`switch`通过源 Enum 的值并任意返回适当的目标 Enum 值。AutoMapper 负责其余的工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-02-19T05:52:31.930

只需为两个枚举创建一个映射器，就是这样！Automapper 将通过 Enum 的匹配值或索引值进行映射。（例如草稿 -> Step1）

```
public enum SourceStatus
{
    Draft,
    Submitted,
    Deleted
}

public enum DestinationStatus
{
    Step1,
    Step2,
    Step3
}

public class SourceObj
{
    public SourceStatus Status { get; set; }
}

public class DestinationObj
{
    public DestinationStatus Status { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        //Static APi style - this is obsolete now. From Version 5.0 onwards    this will be removed.
        SourceObj mySrcObj = new SourceObj();
        mySrcObj.Status = SourceStatus.Deleted;

        Mapper.CreateMap<SourceStatus, DestinationStatus>();
        Mapper.CreateMap<SourceObj, DestinationObj>();

        DestinationObj myDestObj = Mapper.Map<SourceObj, DestinationObj>(mySrcObj);

        //New way of doing it
        SourceObj mySrcObj2 = new SourceObj();
        mySrcObj2.Status = SourceStatus.Draft;

        var config = new MapperConfiguration(cfg =>
        {
            cfg.CreateMap<SourceObj, DestinationObj>();
        });

        IMapper mapper = config.CreateMapper();
        var source = new SourceObj();
        var dest = mapper.Map<SourceObj, DestinationObj>(source);

    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-11-09T15:08:13.267

我试图使用 Automapper 在“相等”枚举之间进行映射，但不幸的是它不起作用。我怀疑问题是外壳不同：

```
public enum Foo {
    val1,
    val2
}

public enum Bar {
    Val1,
    Val2
} 
```

`Foo`是从 XSD 自动生成的东西，供应商很烂。还有三十多岁的价值，我不想把`switch`这么大的东西放在任何地方，因为这样愚蠢。

我采用的方法是将源值转换为字符串并将其解析为目标值：

```
static Foo ConvertEnum(Bar source)
{
    Foo result;
    var parsed = Enum.TryParse(source.ToString().ToLowerInvariant(), true, out result);
    if(!parsed)
         // throw or return default value
         throw new ArgumentOutOfRangeException("source", source, "Unknown source value");
    return result;
} 
```

当然，这只适用于您的枚举只有大小写不同的情况。您可以通过清理输入字符串（例如删除下划线等）或根据需要向其中添加内容来使其更加精细。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-01-08T09:02:38.563

我知道这个问题很老，但如果像我这样的人经过这里......

在[AutoMapper 文档](https://docs.automapper.org/en/stable/Enum-Mapping.html)中，现在有一个[AutoMapper.Extensions.EnumMapping Nuget 包](https://www.nuget.org/packages/AutoMapper.Extensions.EnumMapping)，提供了一种简单的方法。

引用 AutoMapper 文档：

```
 public enum Source
{
    Default = 0,
    First = 1,
    Second = 2
}

public enum Destination
{
    Default = 0,
    Second = 2
}

internal class YourProfile : Profile
{
    public YourProfile()
    {
        CreateMap<Source, Destination>()
            .ConvertUsingEnumMapping(opt => opt
                // optional: .MapByValue() or MapByName(), without configuration MapByValue is used
                .MapValue(Source.First, Destination.Default)
            )
            .ReverseMap(); // to support Destination to Source mapping, including custom mappings of ConvertUsingEnumMapping
    }
} 
```

# tsql - 具有总和和多列的 tsql group by 子句

> ID：11265831
> 
> 赞同：0
> 
> 时间：2012-06-29T16:49:23.543
> 
> 标签：tsql, group-by

我正在尝试正确编写 TSQL 以创建一个包含以下旧列和新派生列的新表：

日期、10 分钟时间、代码、价格、SumItems。

新表应包括两个派生列；10minTime 仅包含 10min 时间段（例如 10:40、10:30、10:20），SumItems 包含每 10min 时间段内的项目总和。其他列应保持不变。

原始数据是这样的：

```
 Date        Time       Code Price   Items
    2012-05-10  10:43:00    a   1351.9  2
    2012-05-10  10:42:00    a   1351.7  5
    2012-05-10  10:41:00    a   1351.3  5
    2012-05-10  10:40:00    a   1351.5  8
    2012-05-10  10:39:00    a   1351.8  3
    2012-05-10  10:38:00    a   1351.9  5
    2012-05-10  10:37:00    a   1351.5  6
    2012-05-10  10:35:00    a   1352.2  2
    2012-05-10  10:34:00    a   1352.0  3
    2012-05-10  10:32:00    a   1352.3  6 
```

这是我到目前为止所拥有的，但它有错误。如果我删除 [Price] 然后它运行但产生错误的结果。

```
SELECT TOP 1000 [date]
      ,min([time]) as 10minTime
      ,[price]
      ,sum([Items]) as SumItems
  FROM [MarketData].[dbo].[MyData]
  group by [Date],DATEPART(hour, [Time]),(DATEPART(minute, [Time]))%10
  order by [date] desc, 10minTime desc 
```

感谢您的任何建议/帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:54:49.117

```
SELECT TOP 1000 
     m1.date
      ,min(m1.time) as 10minTime
      ,(Select price from dbo.MyData m2
        where m2.Date = m1.Date
        and DATEPART(hour, m2.Time) = DATEPART(hours, m1.Time)
        and DATEPART(minute, m2.Time) = DATEPART(minute, m2.Time) %10)

      ,sum(Items) as SumItems
  FROM dbo.MyData m1
  group by [Date],DATEPART(hour, [Time]),(DATEPART(minute, Time))%10
  order by [date] desc, 10minTime desc 
```

# android - 简单的点击listview并开始新的活动——（不可能）

> ID：11265832
> 
> 赞同：0
> 
> 时间：2012-06-29T16:49:27.293
> 
> 标签：android, listview, android-activity

好的，现在我想不出这个，那应该很简单。我已经阅读了很多 StackOverflow 问题，但仍然一无所获。我只想在用户点击列表后开始一个新的活动。太简单了！

```
public class Lista2Activity extends ListActivity {
    TextView selection;
    String[] items={"lorem", "ipsum", "dolor", "sit", "amet",
                    "consectetuer", "adipiscing", "elit", "morbi", "vel",
                    "ligula", "vitae", "arcu", "aliquet", "mollis",
                    "etiam", "vel", "erat", "placerat", "ante",
                    "porttitor", "sodales", "pellentesque", "augue", "purus"};

    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main);
        setListAdapter(new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, items));
        selection=(TextView)findViewById(R.id.selection);
    }

    public void onListItemClick(ListView parent, View v, int position,long id) {
        super.onListItemClick(parent, v, position, id);

        selection.setText(items[position]);
        Intent hash=new Intent(getApplicationContext(),another.class);
        startActivity(hash);

    }
} 
```

它在这方面失败了`Intent`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T13:20:10.517

**利用**

```
Intent hash=new Intent(YourActivity.this,another.class);
    startActivity(hash); 
```

**代替**

```
 Intent hash=new Intent(getApplicationContext(),another.class);
    startActivity(hash); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T19:33:24.540

您没有解释它究竟是如何“失败”的。然而，人们在尝试启动新活动时最常忘记的事情之一是在他们的 AndroidManifest.xml 文件中定义活动。对于每个 Activity 类，添加一个`<activity/>`节点作为节点的子`<application/>`节点：

```
<application ...>
...
    <activity android:name="fully.qualified.name.of.another.Class"/>
...
</application> 
```

...其中`android:name`包含您的活动类的完全限定名称。

# php - 在php中无法访问mySql结果

> ID：11265833
> 
> 赞同：3
> 
> 时间：2012-06-29T16:49:27.373
> 
> 标签：php, mysql, select

我有这个 mySQL 查询：

```
Select MIN(A.product_id  + 1)
From   Tabel A Left Join Tabel B
On A.product_id = B.product_id - 1
Where  B.product_id Is NULL 
```

我在 phpMyAdmin 上运行它，结果如下：

![phpMyAdmin 截图](../Images/e50b8035587408d591abeb78e7b42a0d.png)

它返回正确的值 (1803020005)，但在“MIN(a.product_id + 1)”字段下。

如何在 php 中使用它？

我使用它但不起作用：

```
$result = mysql_query ($select, $con);
$row = mysql_fetch_assoc($result); 
```

这是 $result = mysql_query ($select, $con); 的结果 ：

> 资源 ID #6

这是 $row = mysql_fetch_assoc($result); 的结果 ：

> 大批

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:51:44.967

你想要`SELECT MIN(a.product_id +1) AS min`然后得到它`$row['min'];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:51:28.633

```
Select MIN(A.product_id  + 1) AS product_id
From   Tabel A Left Join Tabel B
On A.product_id = B.product_id - 1
Where  B.product_id Is NULL 
```

尝试告诉它您希望该字段返回的内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T18:41:22.730

您的查询完全错误....

`On A.product_id = B.product_id -1 WHERE b.product_id IS NULL`

告诉 MySQL 只要 b.product_id 为空，A.product_id 必须与 b.product_id 减 1 相同

现在，我认为你正在寻找，你`WHERE B.product_id IS NOT NULL`所有的困境都会得到修复。

此外，请阅读 mysqli 和 PDO，因为 mysql 扩展（即：mysql_query）没有维护并且包含很多安全问题。 PDO 需要一些时间来适应，mysqli 你可以切换到相对容易而没有太多麻烦。

# java - Websphere 7 MQ 应用程序停止接收消息

> ID：11265835
> 
> 赞同：1
> 
> 时间：2012-06-29T16:49:42.940
> 
> 标签：java, ibm-mq, websphere-7

我有一段基于 websphere 的代码，旨在从 MQ 队列中提取消息并对其进行处理。大多数情况下，代码运行良好，但每隔几天，代码会继续运行，但即使队列中仍有消息，它也会停止接收消息。为了让这个过程恢复工作，我需要碰撞应用程序，然后一切都开始正常工作。

消息可能非常大（每条消息最多 4MB），我在 WAS 7 上运行

我没有看到任何似乎代表错误的消息或异常。

这是供人们评论的代码

```
public class BlipMqProcessor {

    protected static final int ONE_SECOND = 1000;
    protected static final int ONE_HOUR = 60 * 60 * ONE_SECOND;
    protected static final int MQ_READ_TIMEOUT = Integer.parseInt(Constants.MQ_READ_TIMEOUT_IN_SECONDS) * ONE_SECOND;

    protected static int previousMqReasonCode;
    protected static long previousMqErrorTime;

    private BlipXmlProcessor xmlProcessor;

    // Member variables for MQ processing
    protected MQQueueManager qMgr;
    protected MQQueue queue;
    protected MQGetMessageOptions gmo;

    /**
     * Constructs a new BlipMqProcessor with the given values.
     */
    public BlipMqProcessor() {
        this(new BlipXmlProcessor());
    }

    /**
     * Constructs a new BlipMqProcessor with the given values.
     * @param xmlProcessor the processor that will be used to create the
     *      staging table entries.
     */
    public BlipMqProcessor(final BlipXmlProcessor xmlProcessor) {
        super();
        this.xmlProcessor = xmlProcessor;
    }

    /**
     * Reads XML messages from the Constants.MQ_ACCESS_QUEUE_NAME
     * 
     * @throws BlipModelException if there are any 
     */
    public void readFromMQ() throws BlipModelException {
        try {
            createNewConnectionToMQ();
            while(true) {
                MQMessage outputMessage = new MQMessage();
                queue.get(outputMessage,gmo);
                String blipModelXml = outputMessage.readLine();
                BlipLogs.logXML("BlipREQ", "0", blipModelXml);
                processMessage(blipModelXml);
                qMgr.commit();
            }
        } catch (final MQException e) {
            if (e.reasonCode != MQException.MQRC_NO_MSG_AVAILABLE) {
                handleMqException(e);
            }
        } catch (final IOException e) {
            throw new BlipModelException("MQ", "Error reading MQ message.", "BlipMqProcessor.readFromMQ", e);
        } finally {
            cleanupMQResources();
        }
    }

    /**
     * Clean up MQ resources.
     */
    private void cleanupMQResources() {
        // Close queue
        if(queue != null) {
           try {
              queue.close();
           }catch(final MQException e) {
               BlipModelLogger.error("MQ", "BlipMqProcessor", "Problem closing queue: " + e);
           }
        }
        // Disconnect queue manager
        if(qMgr != null) {
            try {
                qMgr.disconnect();
            } catch (final MQException e) {
                BlipModelLogger.error("MQ", "BlipMqProcessor", "Problem disconnecting from qMgr: " + e);
            }
        }
    }

    protected void createNewConnectionToMQ() throws MQException {
        try {
            MQEnvironment.hostname = Constants.MQ_HOST;
            MQEnvironment.channel = Constants.MQ_CHANNEL;
            MQEnvironment.port      = Integer.parseInt(Constants.MQ_PORT);
            if(Constants.MQ_SSL_CIPHER_SUITE != null) {
                MQEnvironment.sslCipherSuite = Constants.MQ_SSL_CIPHER_SUITE;
                MQEnvironment.sslPeerName = Constants.MQ_SSL_PEER;
            } else {
                MQEnvironment.sslCipherSuite = "";
                MQEnvironment.sslPeerName = "";
            }

            qMgr = new MQQueueManager(Constants.MQ_QMGR);
            int openOptions = MQC.MQOO_INPUT_AS_Q_DEF;
            queue = qMgr.accessQueue(Constants.MQ_IN_ACCESS_QUEUE, openOptions);
            gmo = new MQGetMessageOptions();
            gmo.options = MQC.MQGMO_WAIT | MQC.MQGMO_SYNCPOINT | MQC.MQGMO_FAIL_IF_QUIESCING;
            gmo.waitInterval = MQ_READ_TIMEOUT;
        } finally {
            MQEnvironment.sslCipherSuite = "";
            MQEnvironment.sslPeerName = "";
        }
    }

    protected void handleMqException(final MQException e) {
        long currentTime = System.currentTimeMillis();
        long timeBetweenMqErrors = currentTime - previousMqErrorTime;
        if (previousMqReasonCode != e.reasonCode || timeBetweenMqErrors > ONE_HOUR) {
            previousMqReasonCode = e.reasonCode;
            previousMqErrorTime = currentTime;
            BlipModelLogger.error("MQ", "BlipMqProcessor", "MQException reading from Access Queue: " + e);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T19:31:40.247

更改 readFromMQ 方法；

```
public void readFromMQ() throws BlipModelException {
    try {
        createNewConnectionToMQ();
        while(true) {
          try {
            MQMessage outputMessage = new MQMessage();
            queue.get(outputMessage,gmo);
            String blipModelXml = outputMessage.readLine();
            BlipLogs.logXML("BlipREQ", "0", blipModelXml);
            processMessage(blipModelXml);
            qMgr.commit();
          } catch (MQException e) {
            if (e.reasonCode != MQException.MQRC_NO_MSG_AVAILABLE) {
              throw e;
            }
          }
        }
    } catch (final MQException e) {
      handleMqException(e);
    } catch (final IOException e) {
        throw new BlipModelException("MQ", "Error reading MQ message.", "BlipMqProcessor.readFromMQ", e);
    } finally {
        cleanupMQResources();
    }
} 
```

将是快速的解决方案；但不优雅。这里有很大的重构空间。

发生的事情是你实际上得到了一个 MQRC_NO_MSG_AVAILABLE 因为有趣的是，没有另一条消息可以检索（在某个时间点，而不是你想的时候）；当您决定忽略该异常时，您已经退出了 while(true) 循环。

您不能使用*queue.getCurrentQueueDepth()*，因为它性能不高（显然），还因为它不适用于别名队列或集群上的队列。差不多就是这样；糟透了。

# autoconf - 为什么 autoconf 脚本中的条件在变量前加上“x”？

> ID：11265847
> 
> 赞同：7
> 
> 时间：2012-06-29T16:50:58.947
> 
> 标签：autoconf

为什么 autoconf 脚本中的条件语句在其变量前加上“x”？例如，GNU 提供的用于测试 Boost 的宏具有条件，例如

```
if test "x$want_boost" = "xyes"; then 
```

为什么这没有被定义为：

```
if test "$want_boost" = "yes"; then 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T16:53:03.640

在一些早期的 shell 中，测试空字符串变量并不像现在那么容易，所以最好的选择是查看“x$variable”是否等于“x”。此外，由于这显然是在使用`test`，这比尝试正确引用/转义诸如 '$x != "y"' 之类的序列而不会失去理智和/或可移植性要简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-03-19T17:39:29.003

在符合 POSIX 的 shell 中，

```
test "$foo" = "$bar" 
```

无论变量的内容是什么，都会进行字符串`foo`比较`bar`。但是在旧的、不兼容的 shell 中，如果`foo`包含以破折号开头的内容，`test`则会尝试将其解释为一元运算符，因此它要么抛出语法错误，要么进行错误的测试。写作`x"$foo" = x"$bar"`使这成为不可能。如果任一参数扩展为空字符串，我也模糊地回忆起问题，但这可能只有在您省略双引号时才会出现（在这种情况下，现代 shell 也会出现问题）。

这在编写配置脚本时尤其重要，因为至少在原则上，无论 shell 环境有多旧，它们都应该工作；如果您今天在 2020 年编写一个新程序，那么您使用 C 和 autoconf 最合理的原因是您需要对某些旧系统具有可移植性……

# asp.net - 将 ASPX 重定向到 HTML

> ID：11265848
> 
> 赞同：0
> 
> 时间：2012-06-29T16:51:00.637
> 
> 标签：asp.net, html, redirect

我的公司最近为他们的网站切换了主机，因此摆脱了 .aspx 页面并切换到 .html。一切都很好，直到我们发现一个 flash 对象有一个指向旧 .aspx 页面的嵌入式链接。由于损坏，我们无法编辑 Flash 文件而不会丢失它。它是由一家外部公司为我们制作的。

此时我们唯一的选择是从 old.aspx url 重定向到 new.html url。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T22:56:19.220

如果您现在有一个 Apache Web 服务器，这可以为您节省几个小时

[http://www.webmasterworld.com/apache/4445316.htm](http://www.webmasterworld.com/apache/4445316.htm)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:54:16.467

如果您有权访问您的 htaccess 文件，则可以将其重定向到那里。

[通用 htaccess 将 www 重定向到非 www](https://stackoverflow.com/questions/234723/generic-htaccess-redirect-www-to-non-www)

# php - 尽管发生了变化，javascript文件被缓存

> ID：11265849
> 
> 赞同：1
> 
> 时间：2012-06-29T16:51:08.960
> 
> 标签：php, javascript, caching

```
<META http-equiv=Content-Type content="text/html;">
<META content="MSHTML 6.00.2900.3314" name=GENERATOR></HEAD>

<?php $current_time="D M j G:i:s"; ?>
<script language="javascript" src="JAVA/ClientSideScript.js?time=<?php echo date($current_time,time()); ?>"></script>
<script language="javascript" src="JAVA/valid_check.js?time=<?php echo date($current_time,time()); ?>"></script> 
```

我添加了上面的代码来防止缓存 javascript 文件。当我查看源代码时，它看起来工作正常。但是我从其他人那里得到这个消息，他们在查看源代码时看不到时间戳。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:56:04.340

如果你建议他们看到这个

```
<script language="javascript" src="JAVA/ClientSideScript.js"></script> 
```

如果没有您添加的任何残余`?time=`，那么他们可能已经缓存了 html 文件。要么通过 f5 键刷新它们，要么更改链接到该 html 文件的所有页面中的文件名，从而强制重新加载。

# asp.net - 带有数据绑定的 ASP.NET GridView 分页

> ID：11265852
> 
> 赞同：0
> 
> 时间：2012-06-29T16:51:15.207
> 
> 标签：asp.net, gridview

我有一个 GridView 控件。在那我有一个带有 2 个按钮（上一个，下一个）的模板字段。每当我单击这些按钮时，我都不想将数据集数据绑定到 GridView。如果我按分页号码，我想将数据绑定到 GridView。

任何帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T17:51:14.073

您可以使用 GridView PageIndexChanging 事件并绑定您的数据集：

在 GridView aspx 中，像这样注册：

```
 OnPageIndexChanging="gridView_PageIndexChanging" 
```

在您的代码隐藏（C# 代码）中：

```
protected void gridView_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
   gridView.PageIndex = e.NewPageIndex;
   gridView.DataSource = /* Specify your dataset you want to bind here */
   gridView.DataBind();
} 
```

# c# - DependencyProperty 未分配

> ID：11265858
> 
> 赞同：0
> 
> 时间：2012-06-29T16:52:02.363
> 
> 标签：c#, wpf, dependency-properties

我创建了一个公开 DependencyProperty 的 UserControl：

```
namespace MyApp.Sql
{
 public partial class SqlConnectionStringBuilder
 {
    private static readonly SqlConnectionString DefaultValue = new SqlConnectionString { IntegratedSecurity = true, Pooling = false };

    public static readonly DependencyProperty ConnectionStringProperty =
        DependencyProperty.Register("ConnectionString", typeof(SqlConnectionString),
                                    typeof (SqlConnectionStringBuilder),
                                    new FrameworkPropertyMetadata(
                                        DefaultValue, 
                                        FrameworkPropertyMetadataOptions.BindsTwoWayByDefault,
                                        ConnectionStringChanged));

    private static void ConnectionStringChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var builder = (SqlConnectionStringBuilder) d;
        if (e.NewValue == null)
            builder.Dispatcher.BeginInvoke((Action)(() => d.SetValue(ConnectionStringProperty, DefaultValue)));
        else
            builder.RegisterNewConnectionString((SqlConnectionString)e.NewValue);
    }

    public SqlConnectionString ConnectionString
    {
        get { return (SqlConnectionString)GetValue(ConnectionStringProperty); }
        set { SetValue(ConnectionStringProperty, value); }
    }

    private void RegisterNewConnectionString(SqlConnectionString newValue)
    {
        if (newValue != null)
            newValue.PropertyChanged += ConnectionStringPropertyChanged;
    }
    ...
  }
} 
```

现在我尝试在另一个 UserControl 中使用 ConnectionString 并将 TextBlock 附加到 ConnectionString：

```
</UserControl.Resources>
<Grid Grid.IsSharedSizeScope="True">
    <Grid.RowDefinitions>
        <RowDefinition Height="1*" />
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    <MyApp.Sql:SqlConnectionStringBuilder  ConnectionString="{Binding ElementName=_this, Path=ServerConnectionString}"  />
    <TextBlock Text="{Binding ElementName=_this, Path=ServerConnectionString, StringFormat='Produced Connection String: {0}'}"
               Grid.Row="1" />
</Grid> 
```

```
namespace MyApp
{
  public partial class SqlProvider
  {
    public SqlProvider
    {
       InitializeComponent();
       DataContext = this;
    }

    private SqlConnection _connection;
    public SqlConnection ServerConnectionString
    {
        get { return _connection; }
        set
        {
            _connection = value;
           OnPropertyChanged("ServerConnectionString");
        }
    }

    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            var e = new PropertyChangedEventArgs(propertyName);
            handler(this, e);
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
  }
} 
```

但是 SqlConnectionString 永远不会分配给 TextBlock。当我调试 ConnectionStringBuilder 的 SqlConnection 属性时，它总是显示 null

我的错在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T16:25:57.043

如果我像这样使用 ElementNames：

```
<MyApp.Sql:SqlConnectionStringBuilder x:Name="sqlConnectionStringBuilder"  ConnectionString="{Binding ElementName=_this, Path=ServerConnectionString, Mode=TwoWay}"  />
<TextBlock Text="{Binding ElementName=sqlConnectionStringBuilder, Path=ConnectionString, StringFormat='Produced Connection String: {0}'}" Grid.Row="1" /> 
```

有用。

但是为什么绑定到本地实例不起作用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T18:01:20.630

检查你的绑定。我假设您正在使用 SqlConnectionStringBuilder UserControl 来创建连接，在这种情况下，它的绑定模式应该是两种方式。

现在，您似乎正在尝试绑定到 MainWindow 的代码隐藏。如果您将 UserControl 的 ConnectionString 绑定设置为两种方式，则对该依赖项属性所做的任何更改都将被注入回 MainWindow 的 ServerConnectionString 属性。而且，因为您的 MainWindow 实现了 INotifyPropertyChanged，一旦更新了 ServerConnectionString 属性，TextBlock 应该更新。

此外，如果您要绑定到 MainWindow，则无需在绑定中指定 ElementName 属性。由于您`DataContext = this`在构造函数中设置，您可以只`{Binding Path=ServerConnectionString, Mode=TwoWay}`在您的 UserControl 上说。

# javascript - 哪个 HTML 5 Canvas Javascript 用于制作交互式绘图工具？

> ID：11265863
> 
> 赞同：2
> 
> 时间：2012-06-29T16:52:32.127
> 
> 标签：javascript, html, html5-canvas

我正在尝试使用 html 5 画布开发绘图工具。当我搜索一个好的 HTML 5 javascript 库时，它们中的大多数只专注于生成静态图像或动画。我正在寻找的是绘制矩形、圆形等原始形状并向它们添加点击事件的能力。我还应该能够使用手柄转换形状。

我知道我可能需要定制一些框架，但仍然......如果有一个具有这些功能的现有框架，那会很高兴知道。谢谢

[编辑] 感谢您的回复。顺便说一句，我在某些地方读到 SVG 将适用于我计划做的所有交互式内容，而不是画布。现在我完全糊涂了:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T16:58:45.213

**Paper.js**

根据他们的网站：

> [Paper.JS](http://paperjs.org)是一个在 HTML5 Canvas 之上运行的开源矢量图形脚本框架。

和

> 为您可以使用鼠标（或触摸屏）执行的不同操作提供鼠标处理程序。

**三.js**

javascript 中的另一个图形库是[three.js](https://github.com/mrdoob/three.js)。根据他们的网站：

> 该项目的目的是创建一个复杂度非常低的轻量级 3D 库——换句话说，是为假人设计的。该库提供 canvas、svg 和 WebGL 渲染器。

我不确定在库中处理鼠标事件的支持有多好。以下 SO 问题处理了一个示例：[Three.js 中几何的事件处理？](https://stackoverflow.com/questions/9145383/event-handling-for-geometries-in-three-js)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T16:59:34.223

这看起来非常适合您的需求： http: [//fabricjs.com/demos/](http://fabricjs.com/demos/)

这是一个简单的正方形示例，您可以使用鼠标移动和调整大小：http: [//fabricjs.com/controls/](http://fabricjs.com/controls/)

来自[http://fabricjs.com/](http://fabricjs.com/)：

> 使用 Fabric.js，您可以在画布上创建和填充对象；对象，例如简单的几何形状——矩形、圆形、椭圆形、多边形或更复杂的形状，由数百或数千条简单路径组成。
> 
> 然后，您可以使用鼠标缩放、移动和旋转这些对象；修改它们的属性——颜色、透明度、z-index 等。您还可以完全操纵这些对象——通过简单的鼠标选择将它们分组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-02T16:00:49.930

[KineticJS](http://kineticjs.com/)

现场说明：

> KineticJS 是一个 HTML5 Canvas JavaScript 框架，它支持高性能动画、过渡、节点嵌套、分层、过滤、缓存、桌面和移动应用程序的事件处理等等。

它可以绘制原始形状（矩形、圆形，甚至斑点）
它有许多事件处理程序（单击、悬停、拖动等）
然后您还可以为它们设置动画（移动、旋转、缩放）
您还可以应用过滤器（灰度、模糊，反转）

你可以在这里找到很多[例子和教程](http://www.html5canvastutorials.com/category/labs/)，这里有一个截图：

![KineticJS 的一个例子](../Images/785f11cd9f24e62405d346c83826148e.png)

* * *

**编辑**

KineticJS 不再维护。

您还应该尝试[Paper.js](http://paperjs.org/)或[Raphaël](http://raphaeljs.com/)。

# sql - 2 个 SQL 表上的全或无独占锁

> ID：11265864
> 
> 赞同：3
> 
> 时间：2012-06-29T16:52:33.123
> 
> 标签：sql, sql-server, locking, deadlock

我的简单测试表明，我可以在 2 个表上获取排他锁，或者推迟获取任一表上的锁，直到可以使用如下查询一次获取两者：

```
SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK)
WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode 
```

关键特性是用于在单个查询中包含多个表的 CROSS JOIN。我确认如果 OITM 行上已经存在另一个事务中 @ItemCode 的排他锁，那么该语句不会在 ONNM 上引入任何锁，直到它可以获取两个锁。但是，在更复杂的完整测试运行中，SQL 探查器返回一些相互冲突的信息。我已将 SQL 分析器结果导入表并执行以下查询：

```
select rownum, e.name, EventClass, TextData, SPID, ClientProcessID from #pmit t
join sys.trace_events e on t.EventClass = e.trace_event_id
where rownum between 275799 and 546130
and (TextData LIKE '(ca73a6396124)' or TextData LIKE '(36fa3e654c8f)'
     or TextData LIKE '%(XLOCK)%' or TextData LIKE '%DeadLock%')
order by rownum 
```

这些是我得到的结果：

```
Row    | Event                | SPID | Text
275799 | SP:StmtStarting      | 99   | SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode
304781 | Lock:Acquired        | 139  | (36fa3e654c8f)
305365 | Lock:Acquired        | 139  | (36fa3e654c8f)
351093 | Lock:Acquired        | 139  | (ca73a6396124)
468768 | Lock:Released        | 13   | (ca73a6396124)
470912 | Lock:Released        | 13   | (36fa3e654c8f)
470922 | Lock:Acquired        | 164  | (36fa3e654c8f)
470928 | Lock:Released        | 164  | (36fa3e654c8f)
470971 | Lock:Acquired        | 99   | (36fa3e654c8f)
471013 | RPC:Completed        | 99   | exec sp_executesql N'SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (''20'', ''10000048'') AND ItemCode = @ItemCode',N'@ItemCode nvarchar(3)',@ItemCode=N'FX1'
490843 | SP:StmtStarting      | 78   | SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode
490848 | Lock:Acquired        | 78   | (ca73a6396124)
495391 | Lock:Acquired        | 114  | (36fa3e654c8f)
495396 | Lock:Acquired        | 114  | (36fa3e654c8f)
542738 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 78 (36fa3e654c8f)                                                                                                                                                                                                                                                  
545746 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 154 (36fa3e654c8f)                                                                                                                                                                                                                                                  
545769 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 114 (ca73a6396124)                                                                                                                                                                                                                                                  
545982 | Lock:Deadlock        | 78   | (36fa3e654c8f)
545985 | RPC:Completed        | 78   | exec sp_executesql N'SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (''20'', ''10000048'') AND ItemCode = @ItemCode',N'@ItemCode nvarchar(3)',@ItemCode=N'FC3'
545990 | Lock:Released        | 78   | (ca73a6396124)
545998 | Lock:Acquired        | 114  | (ca73a6396124)
546130 | Deadlock graph       | 17   | (See below) 
```

死锁图如下：

```
<deadlock-list>
   <deadlock victim="process5e3ae08">
      <process-list>
         <process id="process5e3ae08" taskpriority="0" logused="0" waitresource="KEY: 6:72057598620205056 (36fa3e654c8f)" waittime="9507" ownerId="513854688" transactionname="user_transaction" lasttranstarted="2012-06-28T13:38:54.463" XDES="0x1bbf9b950" lockMode="RangeX-X" schedulerid="6" kpid="13248" status="suspended" spid="78" sbid="0" ecid="0" priority="0" trancount="1" lastbatchstarted="2012-06-28T13:38:54.483" lastbatchcompleted="2012-06-28T13:38:54.463" clientapp=".Net SqlClient Data Provider" hostname="PMIUSRSTL00013" hostpid="3180" loginname="RICFSE01SAPB1" isolationlevel="serializable (4)" xactid="513854688" currentdb="6" lockTimeout="4294967295" clientoption1="671088672" clientoption2="128056">
            <executionStack>
               <frame procname="adhoc" line="1" stmtstart="46" sqlhandle="0x02000000151c651e3c8b4437ee414cefdbc46b70aceca960">  SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (&apos;20&apos;, &apos;10000048&apos;) AND ItemCode = @ItemCode     </frame>
               <frame procname="unknown" line="1" sqlhandle="0x000000000000000000000000000000000000000000000000">  unknown     </frame>
            </executionStack>
            <inputbuf>  (@ItemCode nvarchar(3))SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (&apos;20&apos;, &apos;10000048&apos;) AND ItemCode = @ItemCode    </inputbuf>
         </process>
         <process id="process5e45048" taskpriority="0" logused="0" waitresource="KEY: 6:72057598620205056 (36fa3e654c8f)" waittime="12866" ownerId="513845303" transactionname="SELECT" lasttranstarted="2012-06-28T13:38:28.463" XDES="0x80048e50" lockMode="S" schedulerid="7" kpid="12772" status="suspended" spid="154" sbid="0" ecid="0" priority="0" trancount="0" lastbatchstarted="2012-06-28T13:38:28.390" lastbatchcompleted="2012-06-28T13:38:28.380" lastattention="2012-06-28T13:38:27.927" clientapp="TagClerkService" hostname="PMIUSRSTW00008" hostpid="2772" loginname="RICFSE01SAPB1" isolationlevel="read committed (2)" xactid="513845303" currentdb="6" lockTimeout="4294967295" clientoption1="671088672" clientoption2="128056">
            <executionStack>
               <frame procname="adhoc" line="1" sqlhandle="0x020000000d86e30171762b464b35e0923de532c497188b81">  SELECT T0.*  FROM [dbo].[ONNM] T0     </frame>
            </executionStack>
            <inputbuf>  SELECT T0.*  FROM [dbo].[ONNM] T0    </inputbuf>
         </process>
         <process id="process5e31708" taskpriority="0" logused="25240" waitresource="KEY: 6:72057597517103104 (ca73a6396124)" waittime="2031" ownerId="513831818" transactionguid="0xdefde99023405d4a96d101faac79ef96" transactionname="user_transaction" lasttranstarted="2012-06-28T13:38:19.237" XDES="0xd68df950" lockMode="RangeS-S" schedulerid="5" kpid="11564" status="suspended" spid="114" sbid="0" ecid="0" priority="0" trancount="1" lastbatchstarted="2012-06-28T13:38:58.560" lastbatchcompleted="2012-06-28T13:38:58.490" lastattention="2012-06-28T12:48:33.060" clientapp="TagClerkService" hostname="PMIUSRSTL00011" hostpid="2908" loginname="RICFSE01SAPB1" isolationlevel="serializable (4)" xactid="513831818" currentdb="6" lockTimeout="4294967295" clientoption1="671088672" clientoption2="128056">
            <executionStack>
               <frame procname="adhoc" line="1" stmtstart="24" sqlhandle="0x02000000a329a30eb1319f2df684296f889a1613a585b3a0">  SELECT ISNULL(a.U_FSE_ApplicationUsr,a.UserSign) ,a.DocNum ,b.LineNum ,f.IsLotTraced ,h.LotNumber ,b.WhsCode ,n.Bin ,g.Quantity ,b.LineTotal ,i.OnTimeDeliveryDaysEarly ,i.OnTimeDeliveryDaysLate ,i.ReceiptVarianceUnderAllowed ,i.ReceiptVarianceOverAllowed ,k.ItemCode ,d.Revision ,a.Comments ,e.RolledMaterialCost ,e.RolledLaborCost ,e.RolledVariableOverheadCost ,e.RolledFixedOverheadCost ,e.RolledOutsideCost ,ISNULL(c.Quantity, c2.Quantity) ,c.DocumentLineDetailKey /* TODO: Handle serial numbers for blanket deliveries */ ,ISNULL(c.InventoryCode, c2.InventoryCode) ,k.InvntryUom ,r.Resource ,p.ItemName ,CASE WHEN m.MOKey IS NULL THEN NULL ELSE b.U_FSE_STypeItemQty END ,a.DocDate FROM OPDN a LEFT JOIN PDN1 b ON a.DocEntry=b.DocEntry  LEFT JOIN FSE_PurchaseGoodsReceiptLineDetail c ON (b.DocEntry=c.DocumentKey and b.LineNum=c.DocumentLineKey) LEFT JOIN FSE_PurchaseGoodsReceiptDeliveryLineDetail c2 ON (b.DocEntry=c2.DocumentKey and b.LineNum=c2.DocumentLineKey) LEFT JOIN FSE_MO m ON m.DocumentNumber = b.U_FSE_MONumbe     </frame>
               <frame procname="unknown" sqlhandle="0x000000000000000000000000000000000000000000000000">  unknown     </frame>
               <frame procname="FSDB00.dbo.SBO_SP_TransactionNotification" line="25" stmtstart="1588" stmtend="2032" sqlhandle="0x030006000a73d75dfe95d60059a000000100000000000000">  exec usp_FSE_HandleSBONotification @object_type, @transaction_type, @num_of_cols_in_key, @list_of_key_cols_tab_del, @list_of_cols_val_tab_del, @error out, @error_message out  -- keep this on one line    --PMI DataTransfer     </frame>
               <frame procname="adhoc" line="1" sqlhandle="0x01000600fd116804e00371a5000000000000000000000000">  EXECUTE SBO_SP_TransactionNotification N&apos;20&apos;,N&apos;A&apos;,1,N&apos;DocEntry&apos;,N&apos;134138&apos;     </frame>
            </executionStack>
            <inputbuf>  EXECUTE SBO_SP_TransactionNotification N&apos;20&apos;,N&apos;A&apos;,1,N&apos;DocEntry&apos;,N&apos;134138&apos;    </inputbuf>
         </process>
      </process-list>
      <resource-list>
         <keylock hobtid="72057598620205056" dbid="6" objectname="FSDB00.dbo.ONNM" indexname="ONNM_PRIMARY" id="lock1aa7d9880" mode="RangeX-X" associatedObjectId="72057598620205056">
            <owner-list/>
            <waiter-list>
               <waiter id="process5e3ae08" mode="RangeX-X" requestType="wait"/>
            </waiter-list>
         </keylock>
         <keylock hobtid="72057598620205056" dbid="6" objectname="FSDB00.dbo.ONNM" indexname="ONNM_PRIMARY" id="lock1aa7d9880" mode="RangeX-X" associatedObjectId="72057598620205056">
            <owner-list>
               <owner id="process5e31708" mode="RangeX-X"/>
            </owner-list>
            <waiter-list>
               <waiter id="process5e45048" mode="S" requestType="wait"/>
            </waiter-list>
         </keylock>
         <keylock hobtid="72057597517103104" dbid="6" objectname="FSDB00.dbo.OITM" indexname="OITM_PRIMARY" id="lock215ce6980" mode="X" associatedObjectId="72057597517103104">
            <owner-list>
               <owner id="process5e3ae08" mode="X"/>
            </owner-list>
            <waiter-list>
               <waiter id="process5e31708" mode="RangeS-S" requestType="wait"/>
            </waiter-list>
         </keylock>
      </resource-list>
   </deadlock>
</deadlock-list> 
```

我的问题是，为什么 SPID 78 有可能（是否正常）获得对 OITM（ca73a6396124）的锁定（如果我没记错的话，它恰好代表 ItemCode FC1）即使它无法获得对 ONNM 的锁定（36fa3e654c8f） . 我对 SQL 语句获得全或全锁的假设是不正确的吗？如果 ONNM 锁的持有者是在另一个进程中包含多个连接的事务中的不同连接上的共享锁，它是否不成立？（我认为 SPID 99 是与 SPID 114 在同一进程中的另一个连接。）

这似乎是一个非常复杂的问题。我不知道是否有更好的方法来避免死锁或找出这里发生的事情。

# ruby - Ruby 每个循环的最后一次迭代

> ID：11265865
> 
> 赞同：1
> 
> 时间：2012-06-29T16:52:51.907
> 
> 标签：ruby

我试图在 ruby​​ 的每个循环中的每行末尾插入一个逗号。我不想要最后一行的逗号。我知道 array.join(',') 功能，但在这种情况下我有点困惑。

我如何重构我第一次尝试做我需要的事情？

**重要线路**

```
@headers.each do |header|
          file.puts "`#{table[:source_database]}`.`#{table[:current_name]}`.`#{header[:current_name]}` AS `#{header[:magi_name]}`#{("," unless @headers.last == header)}" if header[:table_id] == table[:id]
        end 
```

**全班**

```
class Table < ActiveRecord::Base        
  has_many :headers

  #--------------------------------------------------------------------------------------------------#

  def self.generate
    @tables = Table.select([:id, :source_database, :current_name, :magi_name])
    @headers = Header.select([:id, :table_id, :current_name, :magi_name])

    File.new("magi_generation.sql", "w")
    @tables.each do |table|
      File.open("magi_generation.sql", "a+") do |file|
        file.puts "#Drops current view #{table[:magi_name]} and then recreates it using updated columns"
        file.puts "DROP VIEW IF EXISTS `#{table[:magi_name]}`;"
        file.puts "CREATE ALGORITHM=UNDEFINED DEFINER=`user`@`127.0.0.1` SQL SECURITY DEFINER VIEW `#{table[:magi_name]}`"
        file.puts "AS select"
        @headers.each do |header|
          file.puts "`#{table[:source_database]}`.`#{table[:current_name]}`.`#{header[:current_name]}` AS `#{header[:magi_name]}`#{("," unless @headers.last == header)}" if header[:table_id] == table[:id]
        end
        file.puts "FROM `#{table[:source_database]}`.`#{table[:current_name]}`;"
        file.puts ""
      end
    end

  end

end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T17:10:04.417

您可以使用[`each_with_index`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-each_with_index)它为您提供当前元素和索引。这样，您可以将数组的大小与当前元素进行比较。

但是，我不喜欢这种方法。在您的情况下，这不干净，因为您在循环内过滤记录。我宁愿过滤记录，然后只循环有效记录。

```
file.puts @headers.
    # keep only elements where the condition matches
    select { |header| header[:table_id] == table[:id] }.
    # convert each element into a line
    map { |header| "`#{table[:source_database]}`.`#{table[:current_name]}`.`#{header[:current_name]}` AS `#{header[:magi_name]}`" }.
    # merge everything into a single string
    join(", ") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:25:07.417

处理您想要的所有内容，在末尾添加逗号和换行符并将其放入 String 变量中。完成后，`chop`关闭字符串的最后两个字符，然后将其写入文件。

```
for_file = ""
@header.each do |header|
   for_file << header + ",\n"
end
for_file.chop.chop # Gets rid of last newline and comma
file.puts for_file 
```

我意识到我的示例循环不包含您在循环中所做的事情的范围，而是将其放入字符串然后`.chop.chop`.

此外，不要`file.puts ...`考虑每条新行，而是考虑一个heredoc。

```
file.puts <<EOF
SELECT 'nothing'
FROM dual
UNION
SELECT 'something'
FROM dual;
EOF 
```

它可能会使您的 SQL 更具可读性，并且您仍然可以使用字符串插值。

这就是我在自己的脚本中使用字符串插值生成 SQL 代码的方式。

# tsql - 当列不是同一类型时如何按列排序？

> ID：11265868
> 
> 赞同：0
> 
> 时间：2012-06-29T16:53:03.673
> 
> 标签：tsql, sql-server-2005

我在列中的字段如下所示：

```
2/8B, 3, 3/8B, 4/8B, 2, 6, 4/9, 9, 8/9, 8, 7, 1, 5/9, 10, 3/9, 2/9, 7/9, 6/8B, 6/9, 1/9, 5, 8B, 5/8B, 4 
```

我需要以如下方式对该列表进行排序：

```
1, 1/9, 2, 2/8B, 2/9, 3, 3/8B, 3/9, 4, 4/8B, 4/9, 5, 5/8B, 5/9, 6, 6/8B, 6/9, 7, 7/9, 8, 8/9, 8B, 9, 10 
```

如何订购以创建此输出？

消除任何混乱（1/2）不是一个分数。“/”只是一个分隔符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T15:39:19.137

这个问题充满了问题。本质上，您正在尝试编写一个排序函数，可以查看这些字符串并对它们进行人工解释。这意味着最终命名模式将以任何人都能理解的方式更改，但您的代码不会，然后您就会遇到错误。

我不知道你怎么不走这条路。但要尽可能地捍卫、警告和提升。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:04:08.717

~~我不明白；使用您提供的字符确实按您要求的顺序排序。试一试：~~

 ~~```
SELECT Test
FROM (
    SELECT '38a' AS Test
    UNION
    SELECT '1'
    UNION 
    SELECT '1/2'
    UNION
    SELECT '12'
) MyData
ORDER BY Test ASC 
```~~  ~~**编辑**

既然你已经给出了具体的例子，我知道是`10`and`8B`把事情搞砸了。试试这个：

```
SELECT YourCol
FROM YourTable
ORDER BY CAST(REPLACE(REPLACE(REPLACE(YourCol, 'B', '.99'), '/', '.'), 
    '.8.99', '.899') AS NUMERIC(18, 4)) 
```

这会将其排序为：

> 1, 1/9, 2, 2/8B, 2/9, 3, 3/8B, 3/9, 4, 4/8B, 4/9, 5, 5/8B, 5/9, 6, 6/ 8B、6/9、7、7/9、8、8/9、8B、9、10

这很丑陋，但它有效。如果您有除 B 之外的其他字母，则必须更改脚本以处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T17:10:38.360

我假设您要排序的列是字符数据类型（因为有些值是非数字字符）——所以一个简单的 ORDER BY 就可以了

```
select '38a' as value
 union
select '12'
 union
select '1/2'
 union
select '1'
order by value 
```

这不会给你你正在寻找的结果吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T20:58:08.637

您可以使用的一种技巧是从字符串中提取前导整数，按整数值排序，然后按字符串排序。

我不知道在 SQL Server 中执行此操作的任何“简单”方法（即不构建函数）。

使用本机内置 SQL Server 函数执行此操作的一种方法是使用 PATINDEX 函数搜索“数字”和“非数字”的起始位置，然后使用这些值来确定前导整数的长度。使用 SUBSTRING 和 CONVERT 函数提取前导整数值。

这不漂亮：

```
ORDER BY
  CASE WHEN PATINDEX('[0-9]%', t.str ) = 1
    THEN
      CASE WHEN PATINDEX('%[^0-9]%', t.str ) > 0
        THEN CONVERT(INTEGER,SUBSTRING( t.str ,1,PATINDEX('%[^0-9]%', t.str )-1))
        ELSE CONVERT(INTEGER, t.str )
      END
    ELSE NULL
  END
, t.str 
```

* * *

**笔记：**

`t.str`是返回字符串值的表达式的占位符。

对于您的测试用例中给出的所有值，这符合指定的要求。

此外，当遇到“意外”值时，这不会**引发**异常（即导致语句失败），例如，空字符串 '' 或没有前导整数的字符串。

这仅处理字符串的“前导整数”部分。之后的所有内容都作为字符串进行比较。（这意味着例如“6/10B”将排在“1/8B”之前，因为“/1”<“/8”。

对于整数比较，前导整数值上的任何前导零都将被忽略，并在字符串比较时被考虑。（这意味着例如 '05/9' 将排在 '5/8' 之前，因为 5=5 但 '0' < '5'）

任何没有前导数字的字符串值都将被分配一个整数值 NULL 用于排序操作，因此它们将首先排序。~~

# javascript - JavaScript 如何识别事件对象变量？

> ID：11265869
> 
> 赞同：6
> 
> 时间：2012-06-29T16:53:08.073
> 
> 标签：javascript, event-handling, dom-events, parameter-passing

关于 JavaScript 事件对象的快速问题 - JavaScript 如何知道我何时尝试将事件变量传递给函数？例如，当我`onclick`像这样定义一个处理程序时：

```
<button onclick='SendMessage(event)'></button> 
```

JavaScript 是否仅仅因为我将它命名为“事件”而传递事件变量？如果是这样，它为传递事件变量保留了哪些其他变量名称？（例如？ev？等等。）

如果是这种情况，可以通过命名局部或全局变量“event”、“e”等来覆盖它们吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T16:56:54.490

它*必须*在内联事件中调用`event`。`event`不是关键字，*也不是 JavaScript**中*的保留字；它只是早期 Netscape 工程师决定的变量名。

为事件提供的内联文本有效地将¹*包装* 为：

```
function (event) {
   // the inline code
} 
```

IE 使用该`window.event`属性来传递事件信息，但名称一致，因此使用`event`将酌情通过正常的 JavaScript 变量解析回退。

当然，如果直接附加一个*函数对象*，那么事件变量，因为它只是第一个参数，可以任意命名。不幸的是，IE 的[`window.event`](http://docstore.mik.ua/orelly/webprog/jscript/ch19_03.htm)方法也必须处理，并且调用参数`event`并不能解决它。

```
elm.onclick = function (my_event_name) {
    my_event_name ||= window.event // for IE
    ...
} 
```

（我建议尽可能避免内联事件并使用统一/简化事件的库。）

快乐编码！

* * *

¹ [HTML 5：事件处理程序，事件处理程序内容属性](http://dev.w3.org/html5/spec/webappapis.html#events)中详细介绍了此行为：

> [内联事件，例如 onclick、文本] 必须包含有效的 JavaScript 代码，该代码在解析时将匹配 [a function] 生产..
> 
> 使用上面创建的脚本执行环境，创建一个函数对象 .. 让函数有一个*名为 event 的参数*。

# c++ - Windows 8 将 Stream 传递给 MFSourceReader

> ID：11265871
> 
> 赞同：4
> 
> 时间：2012-06-29T16:53:32.410
> 
> 标签：c++, audio, windows-8, windows-runtime, ms-media-foundation

我正在尝试制作一个程序，该程序可以从用户的音乐库中获取 .mp3 文件，并使用 Windows Media Foundation 将其转换`IMFSourceReader`为包含 PCM 值的数组，以进行一些令人兴奋的 DSP 操作。但是，我遇到了问题。

我的解决方案有两个项目；一个 C#/XAML 包含 UI 代码和一个 C++ 库，其中包含一些用于使用 Media Foundation 和 XAudio2 的本机代码以及一些`public ref`C# 代码可以与之交互的类。

我无法使用`MFCreateSourceReaderFromURL`，因为即使您在应用程序清单中具有音乐库功能，它也会返回 ACCESS DENIED HRESULT。所以看起来我将不得不使用`MFCreateSourceReaderFromByteStream`or 或`MFCreateSourceReaderFromMediaSource`. 现在，很容易使用`Windows.Storage.KnownFolders.MusicLibrary`并获取 a`Stream`或 an`IInputStream`以及其他一些流类型来访问音乐文件，但是如何将其转换为 an`IMFByteStream`或 an`IMFMediaSource`或仅以某种方式将 mp3 解码为具有 PCM 值的字节数组？

我还考虑了将音乐文件重新保存在应用程序文件夹中的想法，以便我可以使用`MFCreateSourceReaderFromURL`或者可能可以绕过直接使用 Media Foundation 并使用类似`Windows.Media.Transcoding`转换为 PCM 的方法。我不确定这是 Transcoding 命名空间的用途。

我花了几个小时阅读媒体基金会文档，发现了一线希望，`MFCreateMFByteStreamOnStream`可以将 COM 转换`IStream`为字节流，但我需要找到/编写一个包装器来将我的 .net 流转换为 IStream。在我开始这项任务之前，我只想确保我朝着正确的方向前进，或者有更好的方法吗？

提前致谢。如果我犯了一个愚蠢的错误或错过了使用这些库的一些关键方面，也请提前道歉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T11:32:21.380

好的大家，我知道你们都在吵着要回答这个问题，但是经过 2 天的挠头，我找到了解决方案。您可以将`Windows::Storage::Streams::IRandomAccessStream^`对象传递给`MFCreateMFByteStreamOnStreamEx`（[http://msdn.microsoft.com/en-us/library/windows/desktop/hh162754(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/hh162754(v=vs.85).aspx)），方法`(IUnknown*)`是：

```
ComPtr<IMFByteStream> spMFByteStream = nullptr; 

MFCreateMFByteStreamOnStreamEx((IUnknown*)streamHandle, &spMFByteStream);

//remember to add your own HRESULT error handling code

ComPtr<IMFSourceReader> _sourceReader = nullptr;

MFCreateSourceReaderFromByteStream(spMFByteStream.Get(),nullptr,&_sourceReader); 
```

`streamHandle`成为`IRandomAcessStream^`您想要提供给 Source Reader 的东西 。[这是一个正在运行的代码示例](http://code.msdn.microsoft.com/windowsapps/Media-Engine-Playback-ce1c82f0)

是时候吃些吐司了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T17:40:37.227

如果你可以用它制作一个组件（许可与否），我会感兴趣。我不知道有任何组件可以在 WinRT 下将 MP4、WMA 或 M4A 音频文件转码为 PCM。不幸的是，Windows 8 不支持将音频文件录制为 PCM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-05T15:58:55.777

晚会，补充原来的答案，对于那些想要采取用 COM`IStream`接口包装托管流的路线的人来说，[这里是一个很好的实现](http://csharpexamples.com/tag/managed-istream/)。

# php - 如何编写 PHP 脚本以正确下载文件？

> ID：11265875
> 
> 赞同：0
> 
> 时间：2012-06-29T16:54:09.477
> 
> 标签：php, http, cross-browser, cache-control

我无法解决文件下载问题。在 Chrome 中，下载工作正常。在 Firefox 中，它会在文件末尾生成一些 HTML 标题，例如：

```
<!DOCTYPE .....>
...
... 
```

对于其他一些浏览器，下载的文件也会丢失一些行。如何编写脚本以使其真正适用于许多浏览器？这是我当前的代码：

```
private  function downloadRawFileHelper($file) {
    if (ini_get('zlib.output_compression')) {
        ini_set('zlib.output_compression', 'Off');
    }
    if (!file_exists($file)) {
        die('File Not Found');
    }

    header("Pragma: public");
    header("Expires: 0");
    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
    header("Cache-Control: private", false);
    header("Content-Type: text/php");
    header("Content-Disposition: attachment; filename=\"". basename($file). "\"");
    header("Content-Transfer-Encoding: binary");
    header("Content-Length: " . filesize($file));
    ob_clean();
    flush();
    readfile($file);
    $this->view = 'fileedit';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:58:21.107

尝试放一个`exit`之后`readfile`，我认为这会解决你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:10:42.727

这是你的问题：

```
header("Content-Disposition: attachment; filename=\"". basename($file). "\""); 
```

尝试为您的档案命名，例如：

```
header("Content-Disposition: attachment; filename=\"". basename($file). "filename.extension\""); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T06:43:30.590

调试 HTTP 问题的最佳方法是实际检查发送的 HTTP 消息。今天的浏览器使这变得非常容易。

如果该站点是公开的，您可以尝试 redbot.org 来检查响应。

最后，您发送了大量未定义和/或无用的响应头字段，例如“Content-Transfer-Encoding”或 Cache-Control 中的“check”指令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T16:57:23.007

我找不到代码有任何问题。您可以尝试在函数末尾添加`exit()`或。`die()`将其更改为：

```
private  function downloadRawFileHelper($file) {
    if (ini_get('zlib.output_compression')) {
        ini_set('zlib.output_compression', 'Off');
    }
    if (!file_exists($file)) {
        die('File Not Found');
    }

    header("Pragma: public");
    header("Expires: 0");
    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
    header("Cache-Control: private", false);
    header("Content-Type: text/php");
    header("Content-Disposition: attachment; filename=\"". basename($file). "\"");
    header("Content-Transfer-Encoding: binary");
    header("Content-Length: " . filesize($file));
    ob_clean();
    flush();
    readfile($file);
    $this->view = 'fileedit';
    exit();
} 
```

您正在将文件输出到浏览器。所以你需要在那之后停止脚本执行。

希望这可以帮助 ：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T16:58:42.973

`flush()`添加之前`ob_end_clean();`和`exit()`之后`readfile()`。此外，您可能会考虑使用 X-SendFile 而不是纯 PHP 将文件发送到客户端，因为在大文件的情况下这会占用宝贵的资源。

# asp.net - Asp.net asp 页面点击页面加载两次......可能是由于文档类型？

> ID：11265880
> 
> 赞同：0
> 
> 时间：2012-06-29T16:54:34.163
> 
> 标签：asp.net, pageload

我已经阅读了所有关于 img 和 srcs、带有 autopostpack 的按钮的文章。我读过这个网站上的几乎所有内容。我继续有一个页面在加载过程中两次点击页面加载。

我的一位同事提到这可能是由于文档类型。正如我从字面上剥离我的页面一样。

页面语言 Doctype HTML Head Body

而且它仍然两次点击页面加载，我正在通过跟踪查看此内容。

任何想法，我完全被难住了，我在网上找不到任何关于这个的东西。

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="testlink.aspx.vb" Inherits="TestApp.testlink" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
    <title></title>

</head>
<body >
    <form id="Form1" style="margin: 0px" runat="server">

    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:39:01.160

刚刚想通了。

这是问题所在。

```
Private Sub Page_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load, Me.Load 
```

后面的代码中存在两个负载。

估计是我们系统升级到vs2010导致的……

# mysql - 运行 10,000 个查询每个更新单行，还是运行 100 个查询每个更新 100 行更快？

> ID：11265883
> 
> 赞同：3
> 
> 时间：2012-06-29T16:54:42.397
> 
> 标签：mysql, performance, postgresql, sql-update

假设我有一个主键列表，对于每一行，一个值需要更新。运行是否更好：

```
-- run 10,000 of these queries
UPDATE mytable SET myflag = 1 WHERE id = [each_id] 
```

或者将更新组合成批处理查询，如下所示：

```
-- run 100 of these queries, where the IN () list contains about 100 elements
UPDATE mytable SET myflag = 1 WHERE id IN (3, 4, 5, 9, 99, ... 7887 ) 
```

有 100 个 IN () 项的 100 个查询怎么样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T18:36:09.013

两者都不。在**PostgreSQL**中，我会改为：

```
WITH x AS (
   SELECT unnest('{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20
                 ,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40
                 ,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60
                 ,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80
                 ,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100
                 }'::int[]) AS id
   )
UPDATE mytable t
SET    myflag = 1
FROM   x
WHERE  t.id = x.id; 
```

我在我的示例中放置了这么多 ID，以提供一个直观的线索，即 10000 个 ID 很多。问题中提出的两个想法要么：

1.  必须解析列表并将 10000 条语句放在一起并将它们发送到服务器，这很可能比更新本身花费更长的时间。

2.  必须在包含 10000 个项目的列表（数组）中为每个人`id`搜索`mytable`匹配的 ID。不能使用标准索引。这会**很慢**。性能随着 的大小而降低`mytable`。

上的索引`mytable.id`是所有提出的替代方案都需要优于两个变体一个数量级。

[CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html)解析数组一次（子查询也有效 - MySQL 没有 CTE） - 并且[`unnest()`](http://www.postgresql.org/docs/current/interactive/functions-array.html#ARRAY-FUNCTIONS-TABLE)速度相当快。在一个语句中完成所有操作比 10000 个语句高出一个数量级。如果这些语句在单个事务中运行，则再增加一个数量级。如果您应该使用单独的会话，请添加另一个。

罕见的例外适用于在繁重的*写入*负载下存在锁定问题的数据库。只是按照建议进行基准测试。`EXPLAIN ANALYZE`是你在 PostgreSQL 中的朋友。

**如果**操作变得*庞大*，并且大部分表都已更新和/或您的磁盘空间或 RAM 不足，则将操作拆分为*几个*逻辑块可能仍然是一个好主意 - 不要太多，找到最合适的点。主要是为了让[HOT 更新](https://stackoverflow.com/questions/7806058/redundant-data-in-update-statement/7806610#7806610)`UPDATE`从以前的运行中回收表膨胀。考虑[这个相关的问题](https://stackoverflow.com/q/11086761/939860)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T17:01:40.563

我发现第二种方法在对非常大的数据集进行插入时要快几个数量级。这在很大程度上取决于您的系统，但是因为查询的 IN 部分的效率或多或少取决于表大小、索引等。

做自己的简单基准测试确实是唯一的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T17:01:03.507

在正常情况下，运行*一个*更新语句是最有效的。例如，

```
UPDATE mytable set myflag=1 where id IN (select id from someothertable where stuff). 
```

根据您的架构，这可能会更慢*。*您应该进行基准测试并找出答案。

请注意，几乎可以*肯定*的是，从客户端到数据库服务器运行 10,000 条语句会更慢。在存储过程中运行 10,000 次更新和从客户端运行 10,000 次更新是两个非常不同的事情。如果您要运行 10,000 次更新路线，请确保在 SP 中进行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-29T17:00:03.830

通常，RDBMS 往返是一个主要因素，但在这种情况下，解析`in`列表的成本也可能会很高。但是，如果您对查询进行参数化，则第二种解决方案很可能会更快，因为解析只会进行一次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T16:59:56.967

它主要取决于硬盘的 fsync 数量：这是系统中最慢的部分。

对于 PostgreSQL：在少量事务中进行，如果可能的话，只在一个事务中。但是要注意行锁定，两个事务不能同时更新同一行。

# sql - 我将如何解决 Rails 中的这种关联？

> ID：11265886
> 
> 赞同：1
> 
> 时间：2012-06-29T16:55:01.367
> 
> 标签：sql, ruby-on-rails, associations

我有一个用户系统，其中一个用户可以与一个组相关联。这工作正常。

现在我需要能够将用户与组相关联，并且该组可以与另一个组相关联。我希望能够在一次操作中获取同时属于父组和所有子组的用户。

就这样：

```
Group -> Group -> Member 
```

这就是今天的设置：

```
class Group < ActiveRecord::Base

  belongs_to :customer

  has_many    :child_groups, class_name: "Group", foreign_key: 'parent_group_id'
  belongs_to  :parent_group, class_name: "Group"

  has_many :memberships, :class_name => "Group::Membership"
  has_many :members, :through => :memberships
end 
```

`Group::Membership`看起来像这样：

```
class Group::Membership < ActiveRecord::Base

  belongs_to :member
  belongs_to :group
  has_many :customers, :through => :group

end 
```

假设我获取了一个组，该组与该命令相关联的多个子组，`Group.first.members`并在最好是一个数据库请求中获取主组中的所有成员和子组中的所有成员。

这是否可能仅使用基本 Rails 关联，或者我是否需要执行一些自定义 SQL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:07:30.920

我会考虑使用单表继承。让所有其他组从父组继承。

```
class ParentGroup < ActiveRecord::Base; 
 belongs_to :user
end

class Group < ParentGroup; end 
```

然后，您将能够查询 ParentGroup.all 并查看每个组。

[在此链接http://api.rubyonrails.org/classes/ActiveRecord/Base.html](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)中搜索 Single Table Inheritance

# android - 无法自动更新 R 文件并且它有问题

> ID：11265898
> 
> 赞同：0
> 
> 时间：2012-06-29T16:56:12.080
> 
> 标签：android

最近，在我的项目中，`R`文件没有自动更新，每次我在项目中更改某些内容时，我都必须自己构建项目。另外，每次我想在`R`文件中使用任何东西时，我都必须像这样插入`pakage`：`at.tutorial.R.layout.main`而不是`R.layout.main`像以前一样。我的问题是什么？谁能给我一个建议？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:01:56.437

**`i have to build the project myself.`**

在 Eclipse 的项目菜单中有“自动构建”，请检查它，以便每次更新 R 文件时。

**`I have to insert pakage like this: at.tutorial.R.layout.main instead of R.layout.main`**

您必须在 AndroidManifest.xml 文件中提供包名称，如下所示

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="at.tutorial"
      android:versionCode="1"
      android:versionName="1.0"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:04:14.020

`import android.R`如果存在，请从您的代码中删除 。

在 Eclipse 中，转到 Project -> Build Automatically，这样您就不必每次都手动构建它，然后尝试通过 Project -> Clean 清理您的项目几次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T17:03:08.810

1.  检查所有的 XML，
2.  项目 -> 清洁，
3.  右键单击-> 修复项目属性，
4.  重复。
5.  也许尝试重新启动 Eclipse

我的 R 代问题恐慌清单

# mysql - mysql：结合日期时间列并与现在进行比较

> ID：11265902
> 
> 赞同：0
> 
> 时间：2012-06-29T16:56:29.360
> 
> 标签：mysql, sql

我有一列日期类型，另一列时间类型，我想选择现在之前的所有项目。我无法让它工作。像这样的东西：

```
SELECT * FROM table WHERE CONCAT(date_field,' ',time_field)<=NOW() 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T16:57:57.063

使用 MySQL 的[`ADDTIME()`](http://dev.mysql.com/doc/en/date-and-time-functions.html#function_addtime)功能：

```
SELECT * FROM mytable WHERE ADDTIME(date_field, time_field) <= NOW() 
```

# c# - 如何从带有一些变量参数的javascript函数调用asp.net C#函数并从C#函数获取字符串返回？

> ID：11265905
> 
> 赞同：1
> 
> 时间：2012-06-29T16:56:37.097
> 
> 标签：c#, javascript, asp.net, html, ajax

我正在使用 div 在 C#“innerhtml”页面加载时显示来自数据库的内容

```
divid.InnerHtml="html code generated from dtabase"; 
```

但现在我想通过单击一些链接与数据库中的相应数据定期更新 div 的内容，而无需重新加载页面。我该怎么做，请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:51:23.443

首先，去这里：[http ://www.w3schools.com/ajax/default.asp](http://www.w3schools.com/ajax/default.asp)

它很好地解释了它。基本上，ajax 与服务器进行“幕后”通信，一旦服务器响应，您就可以更新页面。

更具体地说，您将需要编写一个 JavaScript ajax 函数，该函数调用服务器上包含任何必要数据的页面。然后该页面应返回所需的数据，然后您可以根据需要通过 javascript/jquery 放置这些数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T19:13:53.277

我会在页面中添加一个 ScriptManager 并启用 PageMethods；

和代码：

```
<script>
PageMethods.GetData(function(response){

divid.InnerHtml=response;

});

</script> 
```

//c#侧：

```
[System.Web.Services.WebMethod]

public static String GetData()
{
  //get your db data and return it
  return databasedata;
} 
```

# javascript - XML to JSON - 处理 JavaScript 中的 xml 命名空间和别名

> ID：11265906
> 
> 赞同：10
> 
> 时间：2012-06-29T16:56:44.423
> 
> 标签：javascript, json, node.js, xml-parsing, xml-namespaces

我正在尝试使用模块 xml2js 在 node.js 中将 XML 转换为 JSON。访问变量时如何处理命名空间别名？

以下代码转换我的文件（sampleWithNamespaces.xml）

```
var fs = require('fs'),
xml2js = require('xml2js');

var parser = new xml2js.Parser();
fs.readFile('sampleWithNamespaces.xml', function (err, data) {
    parser.parseString(data, function (err, result) {
        console.dir(result);
        console.log('Done');
    });
}); 
```

sampleWithNamespaces.xml ：

```
<d:student xmlns:d='http://www.develop.com/student'>
  <d:id>3235329</d:id>
  <d:name>Jeff Smith</d:name>
  <d:language>JavaScript</d:language>
  <d:rating>9.5</d:rating>
</d:student> 
```

输出：

```
$ node xml2jsTest.js
{ '@': { 'xmlns:d': 'http://www.develop.com/student' },
  'd:id': '3235329',
  'd:name': 'Jeff Smith',
  'd:language': 'JavaScript',
  'd:rating': '9.5' }
Done 
```

如果我没有命名空间别名，我可以使用符号`result['d:name']`来访问“名称”属性。`result.name`我想我的问题是，我这样做是否正确？

我[读过](https://developers.google.com/gdata/docs/json)“如果一个元素具有命名空间别名，则别名和元素使用“$”连接。例如，ns:element 变为 ns$element”如果我这样做，我可以将属性读取为`result.d$name`. 如果我走这条路，我怎么会这样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-02-20T16:31:18.657

我有一个类似的问题。我的大部分 XML 标记都在一个命名空间中。所以我决定从我的 XML 中去掉所有的命名空间。

在解析 XML 时，可以通过将 tagNameProcessors 添加到`xml2js`.

```
var parseString = require('xml2js').parseString;
var stripNS = require('xml2js').processors.stripPrefix;

parseString(xml_str, { tagNameProcessors: [stripNS] },function(err, result) {}); 
```

从技术上讲，这将忽略所有命名空间。如果您有来自多个名称空间的 XML 标记，那么这可能没什么用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-11-23T14:31:06.920

对于那些使用打字稿的人

*   添加此导入语句（您将需要 npm install -D @types/xml2js）

```
import { Parser, processors } from 'xml2js'; 
```

*   创建新解析器时添加 tagNameProcessor 选项

```
 const parser = new Parser(
        {  
            trim: true,  
            explicitArray: false,
            tagNameProcessors: [processors.stripPrefix]
        });
        parser.parseString(xmlData, function(err, result)
        { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-21T11:58:44.957

如果您使用 node 和 xml2js 使用`result["ns:entry"]`来引用特定条目

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T19:40:37.023

您引用的文档与 xml2js 无关，但是您可以根据需要获得相同的模式。您必须更改 xml2js 的源代码或在加载后循环重命名所有内容，这两个都不是好主意（第一个意味着您将无法如此轻松地更新，并且都增加了代码开销） ，所以你可能应该坚持使用 ['d:name'] 语法。唯一的缺点是它会为每个查找添加 3 个字符，但如果您的服务器使用 gzip，它不会对现实世界产生影响。

如果你*真的*想，这个函数将重命名所有内容：

```
function colonToDollar(obj){
    var r={};
    for(var k in obj){
        r[k.replace(/:/g,'$')] = (typeof obj[k]==='object') ? colonToDollar(obj[k]) : obj[k];
    }
    return r;
} 
```

# iis-7 - 在 IIS 中的 Microsoft Dynamics Crm 2011 下添加虚拟目录

> ID：11265912
> 
> 赞同：1
> 
> 时间：2012-06-29T16:56:57.950
> 
> 标签：iis-7, dynamics-crm-2011

在 IIS 中的 Microsoft Dynamics Crm 2011 下添加“虚拟目录”通常被认为是不好的做法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T16:45:47.097

> ......这是不好的做法......？

是的。

无论您的情况如何，这都被认为是不好的做法。根据 SDK，它不受支持，因此应避免使用。如果您“需要”这样做，请重新设计您提出的解决方案。

从 SDK：

> 开发新代码时，建议使用 Microsoft Dynamics CRM 2011 的 Web 资源功能。对于 Web 资源功能无法满足的场景，使用自己的 web.config***在自己的应用程序池中*****创建您的 Web 应用程序**

 *[在 SDK](http://msdn.microsoft.com/en-us/library/gg328350.aspx#Unsupported)中找到明确声明不支持的相关位：

> 不支持在 Microsoft Dynamics CRM 网站内为任何 VDir 创建 Internet 信息服务 (IIS) 应用程序，特别是在 ISV 文件夹内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T18:39:57.053

好吧，这取决于您的要求。

该文档强烈建议您使用 Web 资源（例如带有 JScript 或 Silverlight 的 HTML）来扩展 CRM。

但是对于特殊情况，**是**的，您可以在 IIS 下添加“虚拟目录”，并在 iFrame 或其他任何内容中引用 CRM 中的地址。

添加虚拟目录背后的这个缺点是，每当您将解决方案从开发环境导出到实时环境时，您也应该导出到实时环境。*

# php - 如何使用 php 提取或解压缩 gzip 文件？

> ID：11265914
> 
> 赞同：36
> 
> 时间：2012-06-29T16:57:01.437
> 
> 标签：php, gzip, compression

```
function uncompress($srcName, $dstName) {
    $sfp = gzopen($srcName, "rb");
    $fp = fopen($dstName, "w");

    while ($string = gzread($sfp, 4096)) {
        fwrite($fp, $string, strlen($string));
    }
    gzclose($sfp);
    fclose($fp);
} 
```

我尝试了这段代码，但这不起作用，我得到：

> **内部服务器错误**
> 服务器遇到内部错误或配置错误，无法完成您的请求。请联系服务器管理员 webmaster@domain.com 并告知他们错误发生的时间，以及您所做的任何可能导致错误的事情。服务器错误日志中可能提供有关此错误的更多信息。
> *此外，在尝试使用 ErrorDocument 处理请求时遇到 404 Not Found 错误。*

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2013-07-16T19:52:57.843

试试这个在[这里找到](https://stackoverflow.com/questions/3293121/how-can-i-unzip-a-gz-file-with-php)

```
//This input should be from somewhere else, hard-coded in this example
$file_name = '2013-07-16.dump.gz';

// Raising this value may increase performance
$buffer_size = 4096; // read 4kb at a time
$out_file_name = str_replace('.gz', '', $file_name); 

// Open our files (in binary mode)
$file = gzopen($file_name, 'rb');
$out_file = fopen($out_file_name, 'wb'); 

// Keep repeating until the end of the input file
while (!gzeof($file)) {
    // Read buffer-size bytes
    // Both fwrite and gzread and binary-safe
    fwrite($out_file, gzread($file, $buffer_size));
}

// Files are done, close files
fclose($out_file);
gzclose($file); 
```

# android - 如何从堆栈中不止一个的另一个活动返回到我的主要活动？

> ID：11265915
> 
> 赞同：0
> 
> 时间：2012-06-29T16:57:03.773
> 
> 标签：android, android-intent, nullpointerexception, activity-stack

我有一个带有一堆按钮的主菜单活动。一个按钮启动一个新活动，允许用户填写和提交表单。当用户提交表单时，第三个活动开始，基本上只是一个带有一些内容的屏幕和一个返回主菜单的按钮。但是，当我创建意图并转到主要活动时，setContentView() 不起作用，并且我的按钮分配导致 NullPointerException。

我知道有一些方法可以通过意图标志或调用完成（）返回堆栈。我没有成功使用诸如`Intent.FLAG_ACTIVITY_CLEAR_TOP`. finish() 将不起作用，因为我还有两项活动，而不是一项。回到主要活动的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T17:12:36.567

有很多方法可以做到这一点。最简单的方法可能是在第二个 Activity 启动 Intent 后调用 finish()，如下所示：

```
startActivity(activity3intent);
finish(); 
```

当第三个活动开始时，这将从堆栈中删除您的第二个活动。然后，您的 MainMenu 按钮可以在第三个活动上调用完成，让您返回第一个活动。

如果您更喜欢使用 Intent Flags，请尝试将其添加到从 Activity 3 调用 Activity 1 的 Intent 中：

```
activity1intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
```

这将使 Activity 1 重新成为焦点，并清除 Stack 上的任何内容。CLEAR_TOP 标志处理摆脱堆栈的其余部分，但 IIRC 不会启动 Activity 的新实例，如果它已经存在于堆栈中。如果您希望启动 Activity 1 的新实例，请不要使用任何标志，而是在 Activity 2 和 3 都发送了它们的 Intent 之后调用 finish()，这样就无法通过后退导航访问它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:14:46.567

在活动 2 中，如果您调用`startActivity(yourIntent); finish()`它应该允许您在活动 3 完成时返回活动 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T17:18:17.500

如果用户填写并提交您的表单，请尝试通过在提交表单的按钮的侦听器中调用 finish() 方法来关闭您的活动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T07:41:35.657

您还可以创建一个包含所有活动的静态类，以便您可以正确处理它们。这既非常有用又非常低效，但无论如何。

# actionscript-3 - 在 Flex3 的 2 列中显示复选框

> ID：11265916
> 
> 赞同：0
> 
> 时间：2012-06-29T16:57:09.983
> 
> 标签：actionscript-3, apache-flex, checkbox, flex3, repeater

我正在使用 Flex3 和一个新手。我正在使用中继器来创建复选框。我不想垂直对齐所有复选框，因为它们很多。我想在 2 列中显示复选框以节省一些空间？我可以对 x 和 y 属性做一些魔术。但是有什么简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T07:55:38.993

一种方法是将一对 CheckBox 包装在 HBox 中并重复此操作。像这样的东西：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script>
        <![CDATA[
        import mx.collections.ArrayCollection;
        [Bindable]
        private var dp:ArrayCollection = new ArrayCollection([1, 2, 3, 4]);
        [Bindable]
        private var checkBoxLabels:ArrayCollection = new ArrayCollection([
                                                    "Red",   "Blue",
                                                    "Green", "Yellow",
                                                    "Purple","Brown",
                                                    "Gray",  "Black"]);
        ]]>
    </mx:Script>
    <mx:VBox>
        <mx:Repeater id="myRep" dataProvider="{dp}">
            <mx:HBox>
                <mx:CheckBox label="{checkBoxLabels[myRep.currentIndex*2]}"/>
                <mx:CheckBox label="{checkBoxLabels[myRep.currentIndex*2+1]}"/>
            </mx:HBox>
        </mx:Repeater>
    </mx:VBox>
</mx:WindowedApplication> 
```

# javascript - Javascript源文件下载进度？

> ID：11265917
> 
> 赞同：2
> 
> 时间：2012-06-29T16:57:12.047
> 
> 标签：javascript, jquery

我正在采购一个大型映射/小部件 javascript 文件 (1.3 MB)，并希望在加载时显示一个进度条。我知道萤火虫的网络观察标签知道很多这些信息，但我想要更轻量级的东西。我遇到了这个网站：http: [//blog.greweb.fr/2012/04/work-in-progress/](http://blog.greweb.fr/2012/04/work-in-progress/)

除了我需要获取正在下载的文件之外，这几乎可以让我到达那里。当文件下载时，我没有在 jQuery 的 getScript 上看到任何侦听器。有谁知道如何获取源文件下载的进度？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T17:03:24.233

如果您使用[`getScript()`](http://api.jquery.com/jQuery.getScript/)，您可以使用成功回调执行函数，但这仅在脚本完成加载时。

我建议有一个加载指示器图像（您可以在[http://ajaxload.info/](http://ajaxload.info/)找到很多）并在脚本加载时隐藏它。

[这个 SO](https://stackoverflow.com/questions/399641/ajax-page-download-progress)还有其他一些想法。一种解决方案如下：

```
var myTrigger;
var progressElem = $('#progressCounter');
$.ajax ({
    type            : 'GET',
    dataType        : 'xml',
    url             : 'somexmlscript.php' ,
    beforeSend      : function (thisXHR)
    {
        myTrigger = setInterval (function ()
        {
            if (thisXHR.readyState > 2)
            {
                var totalBytes  = thisXHR.getResponseHeader('Content-length');
                var dlBytes     = thisXHR.responseText.length;
                (totalBytes > 0)? progressElem.html (Math.round ((dlBytes/ totalBytes) * 100) + "%") : progressElem.html (Math.round (dlBytes /1024) + "K");
            }
        }, 200);
    },
    complete        : function ()
    {
        clearInterval (myTrigger);
    },
    success         : function (response)
    {
        // Process XML
    }
}); 
```

这设置了一个间隔，通过获取加载的字节数和总字节数来计算进度。这可能对你有用。

# matlab - 没有 for 循环的 n 个函数结果数组

> ID：11265922
> 
> 赞同：0
> 
> 时间：2012-06-29T16:57:39.387
> 
> 标签：matlab, loops, vectorization

我有一个`fun`返回双精度的函数。我想调用函数`n`时间并将结果存储在一个数组中：

```
results = zeros(1, n);
for i = 1:n 
    results(i) = fun;
end 
```

我可以在没有循环的情况下实现这一点吗？

`n`在高达 10,000,000 的范围内，运行时间`fun`几乎可以忽略不计。

* * *

我试过`arrayfun`了，但它实际上慢了很多（慢了大约 87 倍）：

```
results = arrayfun(@(~) fun, 1:n); 
```

循环可能已经是最快的解决方案了吗？如果这可以用一个班轮完成，我仍然会感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T17:19:30.710

首先，要知道 ARRAYFUN 里面基本上有一个隐藏的 for 循环，所以我不确定你是否会加快速度。另外，好的旧 for 循环有时可以从即时编译器优化中受益，所以坚持使用循环 :)

如果您真的想优化您的代码，请编写您的 Java 函数以一次返回一个包含 n 个元素的数组，而不是每次从 MATLAB 调用 n 次返回一个值（瓶颈是这里的调用开销）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:05:38.187

如果我正确理解了您的问题，并且`fun`每次都返回随机/或不同的双精度，那么循环就是要走的路。

# android - 为新的 Android SDK R20 创建一个新的 Eclipse 工作区

> ID：11265923
> 
> 赞同：0
> 
> 时间：2012-06-29T16:57:51.950
> 
> 标签：android, eclipse, sdk, workspace

有人试过吗？

我已经用 Eclipse 安装了旧的 Android SDK，带有旧的工作区（名为“工作区”）。最近，我更新了 Android SDK R20，我尝试使用 MasterDetailFlow 模板新建一个 HelloWorld。好的，它按预期工作。

但是当我创建一个新工作区（例如“newworkspace”）并创建另一个 HelloWorld 时，它总是会生成带有错误的默认 java 代码：

*   在 ItemListActivity.java 中，ItemListActivity 类型的方法 onItemSelected(String) 必须覆盖一个超类方法

*   在 ItemListFragment.java 类型 new ItemListFragment.Callbacks(){} 的方法 onItemSelected(String) 必须覆盖超类方法

我在原始工作区中检查了 HelloWorld，代码相同，没有错误。

任何机构可以提供建议？

请。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:54:15.917

检查您的工作区设置。新的工作空间有自己的设置，可能与之前工作空间的设置不同。

此外，当您更新您的 SDK 时，您也需要更新您的 ADT 工具。转到窗口 > 检查更新。

# jquery - jquery-mobile 功能和样式失败

> ID：11265924
> 
> 赞同：1
> 
> 时间：2012-06-29T16:57:54.117
> 
> 标签：jquery, jquery-mobile, cordova

我想知道，为什么点击按钮后样式被破坏，如截图所示？而且文本也不会改变，只有在第二次点击之后。

这是屏幕截图： ![在敲击之前](../Images/0f932561da9b57bdc54d7fddd4ceae10.png) ![敲击后](../Images/5c050d64a6db8c1a8a5f34077c234b2e.png) 这是我的代码：

```
<!DOCTYPE HTML>
<html>
<head>
<link rel="stylesheet" href="css/jquery.mobile-1.1.0.min.css" />
<script type="text/javascript" src="js/cordova-1.8.1.js"></script>
<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.1.0.min.js"></script>
<style>
#pause
{
color:black;
font-size: 40px;    

}
</style>
<script>
$('#pause').live('tap', function(event){

    if ($('#pause').text() == "Start")
    {
        $('#pause').text("Pause");
    }

    else
    {
        $('#pause').text("Start");
    }

});
</script>
</head>
<body >
<div data-role="page" data-theme="c">
<div data-role="button"  id="pause"> Start </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:57:15.780

因为，您直接在按钮 ID 上应用 text() 方法。如果您检查元素，您将看到 jquery-mobile 在您的按钮 div 中添加子元素。

尝试这个：

```
$('#pause .ui-btn-text').text("Pause"); 
```

现场演示：http:
[//jsfiddle.net/nachiket/ww7Sc/](http://jsfiddle.net/nachiket/ww7Sc/)

# java - 对话服务器死机

> ID：11265927
> 
> 赞同：2
> 
> 时间：2012-06-29T16:58:10.230
> 
> 标签：java, swing, jframe, jdialog

我对 JOptionPane.showInputDialog(...) 方法（以及 JJOptionPane 的其他方法）有一个奇怪的行为。创建的对话框似乎永远不会消失。当我在对话框消失后调用 Window.getWindows() 时，窗口的数量增加了！

测试这个程序，你就会明白我的意思：

```
public static void main(String[] args) {
        final JFrame frame = new JFrame();
        final JPanel panel = new JPanel();
        final JButton button = new JButton("Show Dialog");
        panel.add(button);
        frame.add(panel);
        button.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                JOptionPane.showInputDialog(frame, "Enter some text : ");
                System.out.println(Window.getWindows().length);
            }
        });
        frame.setSize(400, 400);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
} 
```

有人可以解释发生了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T17:12:12.413

> 有人明白会发生什么吗？

`Window.getWindows()`总是返回在 中创建的每个[顶级容器](http://docs.oracle.com/javase/tutorial/uiswing/components/toplevel.html)（没有容器返回`!isDisplayable`）`current JVM`，这些容器从未离开`JVM memory`，也不会`GC'ed`，因为它们是作为资源来自的`Native OS`，[更多在这里](https://stackoverflow.com/questions/6309407/remove-top-level-container-on-runtime)

# .net - .net 2.0 继承与命名空间基类

> ID：11265934
> 
> 赞同：0
> 
> 时间：2012-06-29T16:58:44.140
> 
> 标签：.net, c#-2.0

试图将我的代码排除在 App_Code 之外，

有两个类：

```
namespace BackEnd
{

    public class PubTool 
    {

    }

} 
```

和

```
namespace BackEnd
{

    public class Hub : PubTool
    {

        private string _hubName;
        private DataTable _data;

        public Hub(string hubId)
        {
            GetData(hubId);
        }

    }
} 
```

如果这些类在一个文件中一切都很好，但是如果它们在两个不同的文件中，我会收到一个错误，即找不到 PubTool，所以我确定我在某处缺少参考，但我不知道在哪里它应该去。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:10:41.793

是否存在嵌套命名空间？尝试完全限定它并查看存在的内容：

```
BackEnd.PubTool 
```

control + space bar 通常会在 Visual Studio 中调出智能感知

查看您发布的代码，我确实注意到您使用的是 DataTable 对象，这需要一个 using 指令。

```
namespace BackEnd
{
    using System.Data;

    public class Hub : PubTool
    {
        private string _hubName;
        private DataTable _data;

        public Hub(string hubId)
        {
            GetData(hubId);
        }
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:50:54.190

所以最后，Web 项目不能那样工作，一切都必须驻留在 App_Code

# ruby-on-rails - 在 memcache 中缓存整个页面，并从中间件或控制器中选择提供服务

> ID：11265938
> 
> 赞同：2
> 
> 时间：2012-06-29T16:59:09.560
> 
> 标签：ruby-on-rails, ruby, controller, memcached, middleware

我有一个想要缓存在内存缓存中的页面。我在 Heroku，所以标准页面缓存不是一个选项。

我希望有一个中间件来检查是否设置了特定的 cookie 值。如果它不存在，我只想渲染缓存中的值。否则，我希望 Rails 像平常一样处理它，然后在控制器中选择服务器缓存中的值（在检查 cookie 中的值时）。

所以基本上，我需要一种方法来在 memcache 中缓存一个页面，然后再提供它。我不想只使用静态文件，因此页面可以利用布局、资产管道等。所以我想**主要问题是如何将页面呈现到内存缓存中。**

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:16:45.050

[Rack::Cache](http://rtomayko.github.com/rack-cache/)将满足您的需求，并在生产环境中自动启用。它使用[HTTP 标头来](http://www.mnot.net/cache_docs/)确定缓存行为。您可以使用 , 设置这些标头`fresh_when`，`stale?`并`expires_in`在控制器操作中调用。然而，重要的是设置`public: true`Rack::Cache 的选项来获取它。

```
fresh_when @product, public: true 
```

缓存默认存储在`Rails.cache`其中，因此需要将其配置为使用 memcached。

这种方法的一个很好的副作用是，由于它使用 HTTP 缓存，缓存可以存储在客户端的浏览器或本地网络代理上。由于缓存更接近，这将使用户感觉您的网站更快。

我将[在此 RailsCasts 剧集中详细介绍（需要付费订阅）](http://railscasts.com/episodes/321-http-caching)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T17:20:44.733

我已经看到使用带有 Proc 的 caches_action 的出色性能。尝试这个：

```
caches_action :index, :unless => { |c| c.user_logged_in? } 
```

如果用户未登录，这应该从 memcache 提供页面。因为它正在缓存操作，所以 application_controller 中的任何内容都将首先运行（方便，尽管速度较慢）。使用这种策略，我已经看到在 10 毫秒以下的范围内页面加载超出了内存缓存。这应该可以很好地工作而无需跳入中间件。

如果这还不够，您可能想看看 Rack::Cache

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T17:02:03.967

```
Rails.cache 'somekey' do
   do_whatever
end 
```

这将尝试获取密钥，如果存在它将呈现。如果不是，它将处理块并将键设置为值

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T17:25:08.070

页面缓存确实适用于 Heroku，但需要一些配置。如果你在竹栈上，你的应用前面已经有了 Varnish。如果您在 Cedar 上，则不需要，但仍有缓存选项供您使用。我建议看看：

[https://devcenter.heroku.com/articles/caching-strategies](https://devcenter.heroku.com/articles/caching-strategies)

那里概述了几种策略，例如页面缓存、动作缓存、片段缓存等。

您确实需要一个缓存插件（我使用 memcache，但我相信现在有替代方案）。如果您不需要大缓存，启动包是免费的。

# apache-flex - Flex中的右键单击位置

> ID：11265941
> 
> 赞同：0
> 
> 时间：2012-06-29T16:59:18.950
> 
> 标签：apache-flex, contextmenu, mouseevent, right-click

当用户右键单击时，我在 Canvas 内创建自己的上下文菜单，但我需要知道舞台中的 (x,y) 坐标。

我正在尝试`mouseX`and `mouseY`，但没有按预期工作，返回最后一次单击的坐标（即使在菜单选项内），而不是我单击以显示上下文菜单的位置。

**有什么方法可以通过右键单击 Flex 来获取鼠标位置？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:03:36.683

Flash 会阻止您访问右键单击事件。

但是，您可以使用一些 javascript hacking 来解决此问题。你会在网上找到几个例子，我成功地使用[了这个](http://blog.another-d-mention.ro/programming/right-click-and-custom-context-menu-in-flash-flex/)。

# java - java.lang.IllegalArgumentException：需要 contentIntent

> ID：11265942
> 
> 赞同：1
> 
> 时间：2012-06-29T16:59:19.597
> 
> 标签：java, android, android-notifications

完整的错误还包含：

```
 android.app.RemoteServiceException: Bad notification for startForeground: 
```

我在[这里](https://stackoverflow.com/questions/3112008/android-java-lang-illegalargumentexception-contentintent-required-error-cause)阅读了其他类似的帖子，尝试了他们的建议并阅读了他们的链接，但仍有少数用户报告此错误。

**概述**

活动由外部应用程序启动。此活动启动自定义语音识别服务。它**不**使用 startForeground：

```
 this.startService(intent); 
```

然后活动调用finish();

该服务启动自定义语音识别类并在构造函数中将上下文传递给它。在“检测到语音开始”时，我显示以下通知：

```
 String notTitle = "Hello";
    String notificationText = "hello there";

    notificationManager = (NotificationManager)getSystemService(Context.NOTIFICATION_SERVICE);
    myNotification = new Notification(
                android.R.drawable.ic_btn_speak_now, notTitle,
                System.currentTimeMillis());
    myNotification.flags |= Notification.FLAG_AUTO_CANCEL;

    Intent intent = new Intent();
    intent.setAction("com.android.settings.TTS_SETTINGS");
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    PendingIntent pendingIntent = PendingIntent.getActivity(mContext, 0, intent, 0);
        myNotification.contentIntent = pendingIntent;

    myNotification.setLatestEventInfo(mContext, notTitle,
                notificationText, pendingIntent);

    notificationManager.notify(MY_NOTIFICATION_ID, myNotification); 
```

该通知不需要执行任何“onClick”操作，因为一旦用户停止讲话，它就会被取消。我最初传递了一个“空意图”，但是，在阅读了很多帖子之后，我添加了显示 TTS 设置的随机意图/pendingIntent，只是为了排除这个问题。

我的 99% 的用户对上述代码或传递空意图都没有问题。不过，我需要为 1% 解决这个问题，因为它是我的应用程序中非常重要的一部分。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T08:23:51.640

在我的例子中，Logcat 的调试很有说服力：“android.app.RemoteServiceException：startForeground 的错误通知：”第二行显示：**PendingIntent null**！

在 Android 4.x 中，PendingIntent 为空对于启动前台服务来说不是问题，但在早期的 Android 版本中却是这样。

所以首先仔细检查调试日志（阅读所有行，为什么不，在这里发布）。如果您的代码中存在相同的问题，我将检查 pendingIntent 是否为空。***如果mContext***为空，这可能会发生！

查看*[setLatestEventInfo](http://developer.android.com/reference/android/app/Notification.html#setLatestEventInfo%28android.content.Context,%20java.lang.CharSequence,%20java.lang.CharSequence,%20android.app.PendingIntent%29)*的文档。

这是您的代码的外观（如果您从服务推送这些通知）：

```
 // The PendingIntent to launch our activity if the user selects this notification
    PendingIntent contentIntent = PendingIntent.getActivity(this, 0,
            new Intent(this, LocalServiceActivities.Controller.class), 0);

    // Set the info for the views that show in the notification panel.
    notification.setLatestEventInfo(this, getText(R.string.local_service_label),
                   text, contentIntent); 
```

代码引用自[Android 官方文档](http://developer.android.com/reference/android/app/Service.html)。

在 StackOverflow 上也可以看到[类似](https://stackoverflow.com/questions/11947928/startforeground-bad-notification-error/12138741#12138741)的问题。

# nginx - Nginx 作为负载均衡器

> ID：11265947
> 
> 赞同：0
> 
> 时间：2012-06-29T16:59:55.773
> 
> 标签：nginx, load-balancing

我使用 Nginx 作为反向代理，配置如下

```
upstream ba{
   server 127.0.0.1:8091;
   server 127.0.0.1:8092;    
}

server {
   listen 8098;
   server_name 127.0.0.1:8098;
   location / {
      proxy_pass http://ba;
   }
} 
```

我的问题是，如果客户端 A 被路由到 8091，客户端 B 被路由到 8092，那么 nginx 会处理客户端 A 到 8091 和客户端 B 到 8092 的所有后续调用吗？我确定如果我使用 ip_hash 肯定会这样做，但是在这种情况下 nginx 的行为如何。

谢谢
--SD

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T06:58:58.343

请。查看“粘性”模块

# objective-c - 如何禁用 iphone Simulator 应用程序的定位服务？

> ID：11265948
> 
> 赞同：1
> 
> 时间：2012-06-29T16:59:55.933
> 
> 标签：objective-c, ios, xcode, ios-simulator

有没有办法通过目标 c 代码在 iPhone 模拟器上禁用/启用位置服务？

![截屏](../Images/2d996d34f503839796add9509c6221e6.png)

我已经阅读了其他问题，但它们似乎大多是在谈论核心位置服务。有什么可以处理的吗？（如果有的话，我也不介意使用未记录的 API）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:03:52.113

不，您的代码无法启用或禁用用户定位服务。也不应该能够。您不希望应用程序能够为用户做出决定。

# c# - sql 表在按钮单击时未更新

> ID：11265950
> 
> 赞同：0
> 
> 时间：2012-06-29T17:00:00.020
> 
> 标签：c#, asp.net, sql, web-applications

以下代码来自详细信息页面，该页面从另一个页面接收查询字符串，然后根据传递的 id 加载详细信息。这很好，但现在我的问题是保存更改按钮似乎没有做它应该做的事情；页面就像它提交一样闪烁并加载所有值，我已经调试过，一切都很好，可能是什么问题？它是否与我使用查询字符串有关，因为我在另一个页面上有另一个更新命令（没有查询字符串）并且它工作得很好......

```
 namespace CC
{
    public partial class customerdetails : System.Web.UI.Page
    {
        int customerID = 0;

        protected void Page_Load(object sender, EventArgs e)
        {
            customerID = Convert.ToInt32(Request.QueryString["id"]);
            string strConnString2 = "Data Source=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";
            using (SqlConnection con = new SqlConnection(strConnString2))
            {
                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.Connection = con;
                    cmd.CommandType = CommandType.Text;
                    cmd.CommandText = "SELECT CustomerStatus, CustomerGroup, CustomerFirstName, CustomerLastName, CompanyName, CustomerAddress, CustomerCity, CustomerState, CustomerZipcode, CustomerEmail, CustomerEmail2, CustomerPhoneNumber, CustomerPhoneNumberExt, CustomerType, CustomerSubscriptionType, CustomerCost, CustomerPaymentMethod, CustomerSignUpDate, CustomerPickUpDay, CustomerPickUpDay2, CustomerNotes FROM Customers WHERE CustomerID = @CustomerID";
                    cmd.Parameters.AddWithValue("@CustomerID", customerID);
                    con.Open();
                    using (var reader = cmd.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            if (reader["CustomerStatus"].ToString() == "New")
                            {
                                StatusLabel.ForeColor = System.Drawing.Color.YellowGreen;
                            }
                            else
                            {
                                if (reader["CustomerStatus"].ToString() == "Suspended")
                                {
                                    StatusLabel.ForeColor = System.Drawing.Color.Aqua;
                                }
                                else
                                {
                                    StatusLabel.ForeColor = System.Drawing.Color.DarkRed;
                                }
                            }
                            StatusLabel.Text = reader["CustomerStatus"].ToString();
                            if (reader["CustomerGroup"].ToString() == "")
                            {
                            }
                            else
                            {
                                GroupDropDown.SelectedValue = reader["CustomerGroup"].ToString();
                            }
                            txtCustomerFirstName.Text = reader["CustomerFirstName"].ToString();
                            txtCustomerLastName.Text = reader["CustomerLastName"].ToString();
                            txtCompanyName.Text = reader["CompanyName"].ToString();
                            txtCustomerAddress.Text = reader["CustomerAddress"].ToString();
                            txtCustomerCity.Text = reader["CustomerCity"].ToString();
                            txtCustomerState.Text = reader["CustomerState"].ToString();
                            txtCustomerZipcode.Text = reader["CustomerZipcode"].ToString();
                            txtCustomerEmail.Text = reader["CustomerEmail"].ToString();
                            if (reader["CustomerEmail2"].ToString() == "")
                            {

                            }
                            else
                            {
                                Email2CheckBox.Checked = true;
                                txtCustomerEmail2.Visible = true;
                                txtCustomerEmail2.Text = reader["CustomerEmail2"].ToString();
                            }
                            txtCustomerPhoneNumber.Text = reader["CustomerPhoneNumber"].ToString();
                            txtCustomerPhoneNumberExt.Text = reader["CustomerPhoneNumberExt"].ToString();
                            CustomerType.SelectedValue = reader["CustomerType"].ToString();
                            SubscriptionType.SelectedValue = reader["CustomerSubscriptionType"].ToString();
                            CostTxtBx.Text = reader["CustomerCost"].ToString();
                            CustomerPaymentMethod.SelectedValue = reader["CustomerPaymentMethod"].ToString();
                            CustomerSignUpDate.Text = reader["CustomerSignUpDate"].ToString();
                            PickUpDay.SelectedValue = reader["CustomerPickUpDay"].ToString();
                            if (reader["CustomerPickUpDay2"].ToString() == "")
                            {

                            }
                            else
                            {
                                PickUpDay2CheckBox.Checked = true;
                                PickUpDay2.Visible = true;
                                PickUpDay2.SelectedValue = reader["CustomerPickUpDay2"].ToString();
                            }
                            if (reader["CustomerNotes"].ToString() == "")
                            {
                            }
                            else
                            {
                                string sqlfriendlyNotes = reader["CustomerNotes"].ToString().Replace("<br/>", "\n");

                                NotesTxtBx.Text = sqlfriendlyNotes;
                            }

                        }
                    }
                    con.Close();
                }
            }
        }

        protected void SaveCustomerChanges_Click(object sender, EventArgs e)
        {
            string Status = this.StatusLabel.Text;
            string Group = this.GroupDropDown.Text;
            string customerStatus = Status;
            string customerFirstName = this.txtCustomerFirstName.Text;
            string customerLastName = this.txtCustomerLastName.Text;
            string customerGroup = Group;
            string companyName = this.txtCompanyName.Text;
            string customerAddress = this.txtCustomerAddress.Text;
            string customerCity = this.txtCustomerCity.Text;
            string customerState = this.txtCustomerState.Text;
            string customerZipcode = this.txtCustomerZipcode.Text;
            string customerEmail = this.txtCustomerEmail.Text;
            string customerEmail2 = this.txtCustomerEmail2.Text;
            string customerPhoneNumber = this.txtCustomerPhoneNumber.Text;
            string customerPhoneNumberExt = this.txtCustomerPhoneNumberExt.Text;
            string customerType = this.CustomerType.Text;
            string customerSubscriptionType = this.SubscriptionType.Text;
            string customerCost = this.CostTxtBx.Text;
            string customerPaymentMethod = this.CustomerPaymentMethod.Text;
            string customerSignUpDate = this.CustomerSignUpDate.Text;
            string customerPickUpDay = this.PickUpDay.Text;
            string customerPickUpDay2 = this.PickUpDay2.Text;
            string customerNotes = this.NotesTxtBx.Text.Replace("\n", "<br/>");
            string strConnString1 = "Data Source=xxxxxxxxxxxxxx";
            using (SqlConnection con = new SqlConnection(strConnString1))
            {
                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.Connection = con;
                    cmd.CommandType = CommandType.Text;
                    cmd.CommandText = "UPDATE Customers SET CustomerStatus=@CustomerStatus, CustomerGroup=@CustomerGroup, CustomerFirstName=@CustomerFirstName, CustomerLastName=@CustomerLastName, CompanyName=@CompanyName, CustomerAddress=@CustomerAddress, CustomerCity=@CustomerCity, CustomerState=@CustomerState, CustomerZipcode=@CustomerZipcode, CustomerEmail=@CustomerEmail, CustomerEmail2=@CustomerEmail2, CustomerPhoneNumber=@CustomerPhoneNumber, CustomerPhoneNumberExt=@CustomerPhoneNumberExt, CustomerType=@CustomerType, CustomerSubscriptionType=@CustomerSubscriptionType, CustomerCost=@CustomerCost, CustomerPaymentMethod=@CustomerPaymentMethod, CustomerSignUpDate=@CustomerSignUpDate, CustomerPickUpDay=@CustomerPickUpDay, CustomerPickUpDay2=@CustomerPickUpDay2, CustomerNotes=@CustomerNotes WHERE CustomerID = @CustomerID";
                    cmd.Parameters.AddWithValue("@CustomerID", customerID);
                    cmd.Parameters.AddWithValue("@CustomerStatus", customerStatus);
                    cmd.Parameters.AddWithValue("@CustomerGroup", customerGroup);
                    cmd.Parameters.AddWithValue("@CustomerFirstName", customerFirstName);
                    cmd.Parameters.AddWithValue("@CustomerLastName", customerLastName);
                    cmd.Parameters.AddWithValue("@CompanyName", companyName);
                    cmd.Parameters.AddWithValue("@CustomerAddress", customerAddress);
                    cmd.Parameters.AddWithValue("@CustomerCity", customerCity);
                    cmd.Parameters.AddWithValue("@CustomerState", customerState);
                    cmd.Parameters.AddWithValue("@CustomerZipcode", customerZipcode);
                    cmd.Parameters.AddWithValue("@CustomerEmail", customerEmail);
                    cmd.Parameters.AddWithValue("@CustomerEmail2", customerEmail2);
                    cmd.Parameters.AddWithValue("@CustomerPhoneNumber", customerPhoneNumber);
                    cmd.Parameters.AddWithValue("@CustomerPhoneNumberExt", customerPhoneNumberExt);
                    cmd.Parameters.AddWithValue("@CustomerType", customerType);
                    cmd.Parameters.AddWithValue("@CustomerSubscriptionType", customerSubscriptionType);
                    cmd.Parameters.AddWithValue("@CustomerCost", customerCost);
                    cmd.Parameters.AddWithValue("@CustomerPaymentMethod", customerPaymentMethod);
                    cmd.Parameters.AddWithValue("@CustomerSignUpDate", customerSignUpDate);
                    cmd.Parameters.AddWithValue("@CustomerPickUpDay", customerPickUpDay);
                    cmd.Parameters.AddWithValue("@CustomerPickUpDay2", customerPickUpDay2);
                    cmd.Parameters.AddWithValue("@CustomerNotes", customerNotes);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:09:03.883

您的按钮单击事件处理程序`SaveCustomerChanges_Click`将在您的`Page_Load`事件处理程序之后发生。您的页面加载事件处理程序正在加载您的 UI。在您的 UI 已经加载之后，您正在更新数据。您需要在执行更新后重新加载 UI（想想“DataBind”）。

有关 ASP.NET 页面生命周期的概述，请参阅以下 msdn 文章：http: [//msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

# c# - 我应该拆分我的 edmx 吗？

> ID：11265953
> 
> 赞同：2
> 
> 时间：2012-06-29T17:00:08.797
> 
> 标签：c#, .net, entity-framework, entity-framework-4, unit-of-work

我正在开发一个我想在不同企业中安装的应用程序。每个企业可能需要此应用程序的不同部分。例如，该应用程序具有以下模块：公司管理、任务管理和簿记管理。一个企业希望我只安装公司管理和簿记管理模块，而其他企业希望安装所有三个模块。

这些模块（我有超过 3 个）位于一个数据库中（历史原因），我不希望将数据库分开。此外，存在依赖关系——每个模块都应该了解公司管理模型，因为它拥有所有客户、工人供应商等列表。除此之外，每个模块都可以被视为一个单独的应用程序。

该应用程序是用 C# .Net 编写的，我正在使用实体框架。这是我的解决方案中的项目列表：

1.  数据文件夹
    *   **MyApp.Data.EF4**：包含工作单元和存储库模式的 edmx 和实现。我正在使用 POCO，因此 edmx 不会创建实体。仅包含对 MyApp.Common 的引用。
2.  模块文件夹
    *   公用文件夹
        *   **MyApp.Common**：包含要实现的 MyApp.Data.EF4 项目的所有接口。
        *   **MyApp.Company.Domain**：包含 Company 模块的域对象 (POCO)。这个项目没有参考任何项目。
        *   **MyApp.Company.Services.Contract**：包含此模块公开的服务的接口。
        *   **MyApp.Company.Services**：包含服务实现。
    *   任务文件夹
        *   **MyApp.Tasks.Domain**：包含任务模块的域对象 (POCO)。此项目仅引用 MyApp.Company.Domain。
        *   **MyApp.Tasks.Services.Contract**：包含此模块公开的服务的接口。
        *   **MyApp.Tasks.Services**：包含服务实现。
    *   簿记文件夹
        *   **MyApp.Bookkeeping.Domain**：包含 Bookkeeping 模块的域对象 (POCO)。此项目仅引用 MyApp.Company.Domain。
        *   **MyApp.Bookkeeping.Services.Contract**：包含此模块公开的服务的接口。
        *   **MyApp.Tasks.Services**：包含服务实现。
3.  演示文件夹
    *   **MyApp.Web**：引用所有其他模块 Service、Contract 和 Domain 的 Web 应用程序。这个特定的网络应用程序应该涵盖我所有模块的演示。这意味着，只有需要所有模块的企业才能获得这个网络应用程序。

因为我的 edmx 真的很大，所以很难管理，所以我想把 edmx 拆分，让每个模块都有自己的 edmx。这将导致 MyApp.Web 项目为每个模块保存工作单元（因为 MyApp.Web 使用所有模块，因此需要所有工作单元）。

我正在考虑将 edmx 拆分为不同的 edmx 对我来说是否是一个好习惯。我会接受任何有助于我决定这是否是个好主意的解释，或者对我的情况有任何好的解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T02:36:09.967

我使用多个 emdx 文件，这是个好主意。它使系统的各个部分保持独立，这是一件好事。

但是，您的数据库中会有一部分可以从多个 edmx 文件中访问。它只是像这样结束:) 在这种情况下请注意，如果您更改数据库，那么您可能必须更新这些多个 edmx 文件。它不是障碍物，只是需要注意的事情。

话虽如此，如何：a）购买更多内存（[硬件很便宜，程序员](http://duckduckgo.com/l/?kh=-1&uddg=http://www.codinghorror.com/blog/2008/12/hardware-is-cheap-programmers-are-expensive.html) 很贵b）“冻结”旧的edmx并将新表放入新的emdx中，并且只进行增量更改

在更一般的层面上，如果你有一天不拆分你的 edmx，你的替代者会在 StackOverflow 上提出一个问题，其中包含以下行：“那些模块（我有超过 3 个）位于一个数据模型（edmx）中（历史原因）而且我不想破坏 edmx。” ;)

# c# - 简单的 MVC 评论审核

> ID：11265955
> 
> 赞同：5
> 
> 时间：2012-06-29T17:00:31.673
> 
> 标签：c#, asp.net-mvc, entity-framework, optimization

我有一种简单（可能是粗略）的方式来审核我正在构建的博客上的评论。这是一个学习/有趣的项目，所以我正在尽我所能自己来熟悉一些不同的技术。我想知道我的逻辑是否有任何漏洞，或者可能是我正在做的更好的实现。我将允许在网站上发表匿名评论，但我想对我认为不合适的任何内容进行审核。以下是我的做法：

我的模型使用 EF 代码优先方法：

```
public class Comment
{
    public int Id { get; set; }
    public bool Moderated { get; set; }
    public string DisplayName { get; set; }
    public string Email { get; set; }
    public DateTime DateCreated { get; set; }
    public string Content { get; set; }
    public int PostId { get; set; }
    public Post Post { get; set; }
} 
```

标准的东西在这里。然后我创建了一个 ViewModel 来显示博客文章的详细信息以及与之相关的所有评论，如下所示：

```
public class PostCommentViewModel
{
    public Post Post { get; set; }
    public List<Comment> Comment { get; set; }

    public PostCommentViewModel(int postId)
    {
        var db = new BlogContext();

        Post = db.Posts.First(x => x.Id == postId);
        var query = from x in db.Comments where x.PostId == postId && x.Moderated == true select x;

        Comment = query.ToList();
    }
} 
```

对于评论，这只是抓取与 PostId 相关且已审核的评论（即我已经能够查看它们）

对于显示的视图，我只使用基本脚手架模板：

```
public ActionResult Details(int id = 0)
    {
        var viewModel = new PostCommentViewModel(id);
        return View(viewModel);
    } 
```

该cshtml：

```
@model CodeFirstBlog.ViewModels.PostCommentViewModel

<fieldset>
<legend>PostCommentViewModel</legend>
@Html.DisplayFor(x => x.Post.Title)
<br />
@Html.DisplayFor(x => x.Post.Content)
<br />
@Html.DisplayFor(x => x.Post.CreatedDate)
<hr />    
@foreach(var comment in Model.Comment)
{
    @Html.DisplayFor(x => comment.Content)
    <br />
    @Html.DisplayFor(x => comment.DateCreated)
    <br />
    @Html.DisplayFor(x => comment.DisplayName)
    <br />
    @Html.DisplayFor(x => comment.Email)
    <br />
    <hr />
}

</fieldset>
@Html.ActionLink("Add Comment", "AddComment", new { id = Model.Post.Id} ) 
```

这是控制器中的 AddComment

```
public ActionResult AddComment(int id = 0)
    {
        return View();
    }

    [HttpPost]
    public ActionResult AddComment(Comment comment, int id)
    {
        if (ModelState.IsValid)
        {
            comment.PostId = id;
            db.Comments.Add(comment);
            db.SaveChanges();
            return RedirectToAction("Details", "Blog", new { id = id });
        }
        return RedirectToAction("Details", "Blog", new { id = id });
    } 
```

因此，当我添加评论时，Moderated 默认为 false，因此评论不会立即显示。现在，如果管理员登录，他可以转到 ViewModeration 视图，该视图只返回等待批准的所有评论的列表：

```
public ActionResult ViewModeration()
    {
        var comments = from x in db.Comments where x.Moderated == false select x;
        return View(comments);
    } 
```

如果他单击批准按钮，它将在控制器中执行：

```
 public ActionResult ApproveComment(int id)
    {
        Comment c = (from x in db.Comments
                     where x.Id == id
                     select x).First();
        c.Moderated = true;
        db.SaveChanges();
        return RedirectToAction("ViewModeration");
    } 
```

我真正想知道的是：

1.  此实现中是否存在任何漏洞，例如知情用户能否覆盖回发中的审核值？
2.  有没有更简单，或者更优雅的解决方案可以遵循？同样，我不想使用任何预先构建的东西。这个项目的重点是学习东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T17:17:50.433

到目前为止，该模型似乎推迟了，所以我将这样回答这个问题：

**此实现中是否存在任何漏洞，例如知情用户能否覆盖回发中的审核值？**

是的。我没有根据您发送的任何 FORM 代码，但我假设您正在通过 post 值创建评论并直接保存到数据库。这可能很糟糕。您最好只从用户那里获取您需要的值，然后在控制器中填写其余的值：

```
public ActionResult AddComment(Comment comment, int id)
{
    if (ModelState.IsValid)
    {
        // NEW
        comment.Moderated = false;

        comment.PostId = id;
        db.Comments.Add(comment);
        db.SaveChanges();
        return RedirectToAction("Details", "Blog", new { id = id });
    }
    return RedirectToAction("Details", "Blog", new { id = id });
} 
```

**有没有更简单，或者更优雅的解决方案可以遵循？同样，我不想使用任何预先构建的东西。这个项目的重点是学习东西。**

如前所述，到目前为止，这看起来不错。但是，出于可重用性和测试目的，我可能会在不同的类中获取数据库操作，例如服务或存储库。

因此，代码将如下所示：

```
public ActionResult AddComment(Comment comment, int id)
{
    if (ModelState.IsValid)
    {
        CommentService.Save(comment);
        return RedirectToAction("Details", "Blog", new { id = id });
    }
    return RedirectToAction("Details", "Blog", new { id = id });
} 
```

这不是一个大的变化，但如果你想重用这段代码，它会让你在以后获得更多的灵活性。

至于您的 PostCommentViewModel 类，我没有在 ViewModels 中执行任何操作，尤其是在构造函数中。您应该使用 ViewModels 的方式是将数据绑定到它上，而不是让 ViewModel 完成这项工作。无论如何，您都可以从中获取数据，ViewModel 仅代表需要显示的结构。因此，从那里获取代码，并将其放入服务中（即：CommentService）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T17:15:42.463

第一个问题的答案是**肯定的，知道的用户可以设置`Moderated`value**。不久前，类似的事情发生在 GitHub 上。有关完整说明，请参阅[此帖子](http://www.diaryofaninja.com/blog/2012/03/11/what-aspnet-mvc-developers-can-learn-from-githubrsquos-security-woes)。简短的解释是，用户可以在 Chrome 开发者工具中修改表单数据，并`Moderated`在发布之前在模型上设置属性。

要回答您的第二个问题，我可以看到两个选项（如果您知道更多，请发表评论）

**1）**您可以调用并仅指定应更新的属性，而不是`DefaultModelBinder`将值绑定到您的模型。例如`Comment``TryUpdateModel`

```
public ActionResult AddComment(int id)
{
    if (ModelState.IsValid)
    {
        Comment comment = new Comment();
        TryUpdateModel(comment, new[] { "Email ", "DateCreated", "Content", "etc" });
        comment.PostId = id;
        db.Comments.Add(comment);
        ...
    }
    ...
} 
```

**2）**更好的选择，恕我直言，是创建一个甚至不包含该`Moderated`属性的单独模型类，并将该模型用于用户评论。您可以将现有`Comment`模型用于仅管理员可访问的操作上的管理目的。

# javascript - 如何在单击时隐藏 div 并在另一个中更改 html

> ID：11265959
> 
> 赞同：0
> 
> 时间：2012-06-29T17:01:00.297
> 
> 标签：javascript, jquery

我有一个简单的请求（仍在学习 javascript）。我在它下面有一个标题 div 和 3 个 div（每个里面都有一个锚标记）。基本上我想要的是，当您单击一个锚标签时，该特定的锚标签应该隐藏（实际上是它的父 div），并且上面的标题 div 中的文本应该改变。我怎样才能做到这一点？请参阅[过于简化的示例](http://jsfiddle.net/gGAW5/53/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:05:18.820

试试这个 - [http://jsfiddle.net/gGAW5/54/](http://jsfiddle.net/gGAW5/54/)

```
$(document).ready(function() {
    $("a").click(function() {
        $("#myTitle").html( $(this).html() );
        $(this).hide();
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:05:27.573

您正在混合使用 jQuery DOM 访问和普通 DOM 访问，这会导致一些问题。使用`$('#id')`选择器代替 document.getElementById('blah');

要使 div 在单击时消失：

```
$('#mydiv').click(
    function()
    {
        $(this).hide();
        $('#otherdiv').html('new html');
    }
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T17:10:09.787

不确定这是您要查找的内容**[检查演示](http://jsfiddle.net/gGAW5/59/)**。

您正在将 javascript 与 jquery 混合使用。您可以通过这样的方式隐藏元素

```
$(this).hide(); 
```

# ios - 缩进自定义表格视图单元格

> ID：11265963
> 
> 赞同：1
> 
> 时间：2012-06-29T17:01:37.470
> 
> 标签：ios, uitableview, storyboard

我`UITableViewCell`使用`Storyboard`. 该单元格包含 3 个`UILabel`项目。当点击编辑按钮时。(-) 符号在左侧滑入，但单元格不缩进，并且 (-) 符号覆盖 UITextLabels 之一。

`UITextLabels`我想知道按下编辑按钮时使所有 3 个缩进的最佳方法是什么。我尝试将 3 个标签添加到`UIView`(contentView) 并将其添加到 contentsView：

```
-(void)layoutSubviews {

[super layoutSubviews];
[self.contentView addSubview:self.theContent];

} 
```

尽管这会产生相同的结果。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:33:22.913

内容的框架是什么？您是否尝试过修改框架（从“x”值中减去您希望缩进的数量）？你甚至可以在一个漂亮的动画中做到这一点：

```
[UIView beginAnimations : @"cell edit" context:nil];
[UIView setAnimationDuration:1];

CGRect frame = theContent.frame;
frame.origin.x -= 40; // add or subtract here however much you want to indent and in which direction
theContent.frame = frame;   

[UIView commitAnimations]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-24T07:58:47.957

您可以像这样在情节提要中设置它。 [![在此处输入图像描述](../Images/75f444bca842d6b84aaf22d8ad7febaa.png)](https://i.stack.imgur.com/H6cAw.png)

# css - gumby 框架 CSS 框架

> ID：11265965
> 
> 赞同：0
> 
> 时间：2012-06-29T17:01:42.690
> 
> 标签：css, css-frameworks, gumby-framework

我需要开发一个简单的网站，我通常使用引导 CSS 框架，但是我想使用 Gumbyn，它允许我使用 16 列而不是 12 列。

我想知道是否：

*   我可以轻松更改绿色吗？

*   如何使用固定布局而不是流动布局？

*   它与所有浏览器兼容吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:09:46.327

是的，你可以改变绿色。只需添加第二个样式表并确保在 gumby 之后包含它，然后为您的颜色添加规则。如果你从 gumby 中删除 @media 规则，它将是一个固定的布局。我确信它是兼容的。

# blackberry - Sencha Touch 2 Web 应用程序未在 BlackBerry Torch 上加载

> ID：11265976
> 
> 赞同：0
> 
> 时间：2012-06-29T17:02:37.053
> 
> 标签：blackberry, touch, extjs, sencha-touch-2

我已经部署了一个 Web 应用程序，它在 iOS 中运行良好，但在 Blackberry Torch 上，该网站甚至无法加载。显示淡黄色屏幕。

我尝试过使用 Blackberry Bold，该网站显示但您无法与按钮交互。

有任何想法吗？

谢谢

拉维

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:14:41.197

您能否提供有关该应用程序的更多详细信息？听起来您的应用程序有一些 BB OS 6 平台不支持的东西（这就是它没有在 9800 上加载的原因）但是如果它在 9900 上工作，那么按钮应该是响应式的。

它是浏览器应用程序吗？

谢谢

纳文 M

# ios - 使用 CoreData 进行双向迁移

> ID：11265986
> 
> 赞同：0
> 
> 时间：2012-06-29T17:03:28.557
> 
> 标签：ios, core-data, core-data-migration

有没有人知道是否可以使用 Core Data 进行双向迁移？例如，我想添加一个仅在较新的 iOS（外部图像）支持的同时仍支持 iOS3.1 的功能。我希望做的是允许用户在使用旧设备时将数据导出到旧型号。

这可能是一场噩梦，但我只是好奇是否有人尝试过这个？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T05:33:17.570

最好的方法可能是创建某种基于 JSON 或 XML 的中间数据格式，您可以将新模型输出到旧模型并写入旧模型。

或者，您可以创建具有新功能的数据模型和仅使用旧功能的数据模型，然后为每个功能打开存储协调器并以这种方式在模型之间复制内容。起初，这似乎更容易，并且实际上更多的是您所要求的，但我非常警惕在无数 Core Data 用户已经走在您之前并用他们风化的骨头铺平道路的范围之外交易太远。大多数人只有一名商店协调员；别介意两个指向不同的模型。

# android - Android 视频海报在 webview 中播放后移位

> ID：11265991
> 
> 赞同：1
> 
> 时间：2012-06-29T17:03:47.397
> 
> 标签：android, video, android-webview

遵循此处的建议：[如何使用 android 在 webview 中播放视频？](https://stackoverflow.com/questions/4989738/how-to-play-a-video-in-a-webview-with-android)

我能够在从 JS 调用的 webview 中播放视频。但是，在播放视频的海报图像后，它会移位。使用测试js：

```
var anchor = "<button id=\"open\" type='button'>openLink</button><button type='button' onclick='playPause();'>Play/Pause</button>"+"<video id='video' poster='{imageURL}' onclick='this.play();'><source src='{videoURL}'</video>"; 
```

最初页面显示有两个按钮，后面是海报图像。播放视频后，摆姿势的图像显示在屏幕中央的按钮顶部。

有想法该怎么解决这个吗？

谢谢

# c# - 在许多属性中使用 ReaderWriterLockSlim 的更简洁的方法

> ID：11265993
> 
> 赞同：2
> 
> 时间：2012-06-29T17:04:01.927
> 
> 标签：c#, thread-safety, dry, readwritelock

我正在尝试实现许多利用 ReaderWriterLockSlim 实现线程安全的属性。所以像大多数人一样，我最终在我的所有属性中都得到了这样的结果：

```
public string Name
{
    get
    {
        rwLock.EnterReadLock();
        try {
            return name;
        }
        finally {
            rwLock.ExitReadLock();
        }
    }
    set
    {
        rwLock.EnterWriteLock();
        try {
            name = value;                    
        }
        finally {
            rwLock.ExitWriteLock();
        }
    }
} 
```

这在 10 个属性中感觉非常冗长和重复，因此我正在寻找更 DRY 的实现。

显而易见的解决方案是将它包装到一个类中，该类释放 dispose 的锁并允许我将线程安全操作放在 using 语句中。[根据这个](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=21)和其他一些来源，显然这不是很安全。

所以我尝试使用 lambda 表达式和匿名方法想出一个漂亮的解决方案：

```
private TResult ThreadSafeRead<TResult>(Func<TResult> value)
{
    rwLock.EnterReadLock();
    try {
        return value();
    }
    finally {
        rwLock.ExitReadLock();
    }            
}

private void ThreadSafeWrite(Action value)
{
    rwLock.EnterWriteLock();
    try {
        value();
    }
    finally {
        rwLock.ExitWriteLock();
    }
}

public string Name
{
    get { return ThreadSafeRead(() => name); }
    set { ThreadSafeWrite(() => { name = value; }); }
} 
```

虽然这消除了让我烦恼的重复代码，但我不知道它是否与我最初的详细实现一样线程安全。

是否有人对 MSIL 这将产生和多线程理论有更深入的了解，能够告诉我我的实现是否安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:08:05.227

我见过人们解决这个问题的常用方法是将锁包裹在一个对象中并按照以下方式做一些事情：

```
using (var obj = new ReadOnlyLock(this.rwLock))
{
    this.name = value;
} 
```

我承认我不这样做（为什么要创建另一个对象只是为了获得锁？）但它确实实现了一些人认为最重要的更好的风格目标......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T17:19:31.167

您的博文中提到的问题确实存在，是的。有关此主题的更彻底处理，请参阅[Joe Duffy 的帖子](http://www.bluebytesoftware.com/blog/PermaLink.aspx?guid=c1898a31-a0aa-40af-871c-7847d98f1641)。

您的代码是否甚至遭受异步异常？它们很可能只在 ASP.NET 下运行并且当前请求由于超时而中止时发生。当然，您永远不应该出于各种原因自己中止线程。

我认为您实际上不应该关心这个问题。

# mongodb - 我可以在 mongod 进程运行时更改我的副本集的名称吗？

> ID：11265997
> 
> 赞同：10
> 
> 时间：2012-06-29T17:04:09.630
> 
> 标签：mongodb

如果是这样，怎么做？

当我第一次创建副本集时，我选择了一个令人困惑的名称；我现在想改变它。

中提到了副本集名称`/etc/mongod.conf`，我不确定它何时读取/重读该名称。由于副本集名称也可以作为命令行参数传入，因此我假设（并且当前正在测试）以下内容：

*   它只在启动时使用副本集名称，同时与其他节点同步
*   我必须重新配置、停止、更改`replSet`CLI 参数或`replSet`值`/etc/mongod.conf`，然后重新启动

换句话说，我假设我最初问题的答案是“不，您必须重新启动”或“不，副本集名称是不可变的”。我可能很快就会弄清楚这一点，因为我正在本地尝试。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-29T17:44:00.543

以下是如何在停机时做到这一点：

1.  停止所有服务器
    *   如果启用了身份验证，请确保将其禁用，否则可能无法授权对 local.system.replset 集合的更改。
2.  在没有 --replSet 选项的情况下启动每个服务器，指向正确的数据目录。
3.  使用新的副本集名称更新每台服务器上的 local.system.replset 文档。 *您必须更改此处的每台服务器。*
    以下是如何在 mongo shell 中更新 local.system.replset：

    ```
    use local  
    var doc = db.system.replset.findOne()  
    doc._id = 'NewReplicaSetName'
    db.system.replset.save(doc)  
    db.system.replset.remove({_id:'OldReplicaSetName'}) 
    ```

4.  再次关闭它们。
5.  将 /etc/mongod.conf replSet 选项更改为所有服务器上的新名称。
6.  使用原始选项启动它们。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-06-09T22:21:44.930

克里斯蒂娜的回答很好，但第 3 步可能需要更多解释。在您的 mongo shell 中，像这样编辑 db.system.replset：

```
use local
var doc = db.system.replset.findOne()
doc._id = 'NewReplicaSetName'
db.system.replset.save(doc)
db.system.replset.remove({_id:'OldReplicaSetName'}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T17:39:39.337

不。

请参阅[mongodb-user 中的线程“更改副本集名称”](https://groups.google.com/d/topic/mongodb-user/VLuGAJHSFdQ/discussion) ... Kristina Chodorow 断言停机时间是必要的。

一旦我弄清楚了（除非其他人击败我），我将在此处添加有关如何更改副本集名称的说明（有停机时间）。

# php - 将数组值传递给foreach，最后传递给另一个变量？

> ID：11265998
> 
> 赞同：0
> 
> 时间：2012-06-29T17:04:14.010
> 
> 标签：php, variables, global-variables

在 PHP 中，处理变量中的循环的最佳做法是什么？让我解释。

我有一个名为 index.php 的文件，其中包含以下内容：

```
<?php 
$SELECT_INDUSTRY = array("Industry1", "Industry2", "Industry3");
require_once('form.inc');
?>
<html>
<head></head>
<body>
<?php echo $FORM_FIELD_INDUSTRY ?>
</body>
</html> 
```

然后我有第二个名为 form.inc 的文件：

```
<?php
$FORM_FIELD_INDUSTRY = '<select><option value=>Select an Industry</option>'.$INDUSTRY.'</select>';
?> 
```

这是需要的。我想将输入的数组值传递给 foreach 以处理数组并吐出`<option></option>`代码。这是一个例子：

```
foreach ($SELECT_INDUSTRY as $INDUSTRY) {
echo '<option value="$INDUSTRY">$INDUSTRY</option>';
} 
```

所以这个函数会根据数组值构建我的选择选项。这可行，但是我如何能够将总值传递到我在上面的 form.inc 文件中定义的变量中？在 form.inc 文件中，我将 $INDUSTRY 作为变量，我想它需要从另一个函数返回某种形式。如果涉及到，这可能还需要全局变量在函数之间传递。有没有更好的方法来处理这个？

我的最终目标是让变量 $FORM_FIELD_INDUSTRY 根据数组值吐出 foreach 函数。

**解决方案**

下面列出了解决方案，但是对于遇到此问题的任何人，这就是我所做的：

**索引.php**

```
<?php 
$SELECT_INDUSTRY = array("Industry1", "Industry2", "Industry3");
$FORM_SELECT_SIZE = ''; 
require_once('form.inc');
?>
<html>
<head></head>
<body>
<?php get_options( $FORM_FIELD_INDUSTRY ) ?>
</body>
</html> 
```

**表格公司**

```
<?php
function get_options( $arr = array() ) {
    global $FORM_SELECT_SIZE;
    echo '<select id="industry" class="'.$FORM_SELECT_SIZE.'"><option value=>Select an Industry</option>';
    foreach( $arr as $option ) {
        echo '<option>'.$option.'</option>';
    }
    echo '</select></div></div>';
}
$FORM_FIELD_INDUSTRY = $SELECT_INDUSTRY;
?> 
```

在函数和变量之间传递值的非常简单的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:21:58.010

您可以只使用一个函数来构建选项并像这样返回它：

```
function get_options( $arr = array() ) {
    echo '<select>';
    foreach( $arr as $option ) {
        echo '<option>'.$option.'</option>';
    }
    echo '</select>';
} 
```

然后在您的 HTML 中，您可以这样称呼它：

```
<html>
<head></head>
<body>
<?php get_options( $SELECT_INDUSTRY ); ?>
</body>
</html> 
```

因此，如果我将您提供给我们的代码放在首位并将其组合起来，它将如下所示：

```
<?php 
$SELECT_INDUSTRY = array("Industry1", "Industry2", "Industry3");
require_once('form.inc');
?>
<html>
<head></head>
<body>
<?php get_options( $SELECT_INDUSTRY ); ?>
</body>
</html>
<?php
function get_options( $arr = array() ) {
    echo '<select>';
    foreach( $arr as $option ) {
        echo '<option>'.$option.'</option>';
    }
    echo '</select>';
}
?> 
```