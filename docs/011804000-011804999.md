# StackOverflow 问答 11804000-11804999

# sql - sql什么时候在update语句中独占锁定一行？

> ID：11804000
> 
> 赞同：7
> 
> 时间：2012-08-03T22:13:31.530
> 
> 标签：sql, multithreading, synchronization

在这些条件下，sql中会出现竞争条件吗？

如果我在一个线程中运行此 SQL 更新，则将其称为语句 1：

```
Update Items
Set Flag = B
where Flag = A; 
```

这个 SQL 更新在另一个调用它的语句 2 中运行：

```
Update Items
Set Flag = C
where Flag = A; 
```

每个线程是否可以读取 Flag 等于 A 的同一记录并用自己的值写入记录？这样语句 1 可以先写，然后语句 2 写，反之亦然？

这个问题的答案取决于数据库何时以独占方式锁定更新。它是在找到记录之前发生还是在找到记录并评估 where 子句之后发生？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-04T00:12:10.933

首先，存在三种锁上下文：

*   数据库级锁
*   表级锁
*   行级锁

然后你有四种锁定模式：

*   九
*   是
*   X
*   小号

IX 和 IS 锁是“意图”锁。这些锁在获取其他类型的锁之前被持有。X 锁是排他（写）锁，S 锁是共享（读）锁。

可以在任何上下文级别获取锁（IX、IS、X 或 S）锁。例如，数据库级别的 X 锁将阻止数据库中的所有其他操作。这是 SQLlite 采用的锁类型。在读取期间为整个数据库获取 S 锁，在写入期间为整个数据库获取 X 锁。写入将等待任何 S 锁完成，并将阻止新的 S 和 X 锁，直到释放写入锁为止。这提供了可序列化的隔离事务级别。

对于 MySQL，锁定取决于存储引擎。MyISAM 将在整个（组）表上使用 X 和 S 锁。X 锁将等待现有的 S 或 X 锁并阻止新锁。新的 X 锁将在队列中被赋予更高的优先级，排在新的 S 锁之前。可以通过设置 LOW_PRIORITY_UPDATES 来更改此行为，这可能会导致写入不足，因为写入将被取消优先级以支持读取。

在 MySQL 中，可以使用'FLUSH TABLES WITH READ LOCK'获得整个数据库的 X 锁。

InnoDB 在通过索引读取遇到行时锁定行。InnoDB 锁定索引记录，并在遍历索引记录时锁定记录。InnoDB 使用称为“间隙”锁的特殊锁来确保 REPEATABLE-READ 事务隔离级别。锁定在索引条目上，因此如果一个表没有很好地为 UPDATE 查询建立索引，那么许多行将被锁定。请注意，InnoDB 不会为正常的 SELECT 查询创建 S 锁。它使用行版本控制，而不是行级锁定来获得一致的快照。

在获取 X 锁时，数据库需要检测死锁。考虑以下：

```
>connection 1
start transaction;
update T set c = c + 1 order by id asc;

>connection 2
start transaction;
update T set c = c - 1 order by id desc; 
```

在行锁定模型中，这两条语句不可能都成功完成。第一个将永远等待获取第二个持有的锁，反之亦然。数据库将选择其中一个连接进行回滚。InnoDB 将选择更改次数最少的连接。MyISAM 将为首先获得锁的连接锁定整个表，然后第二个将在第一个完成后运行。

您给出的简单示例将通过任何上下文（数据库、表或行）的 X 锁来解决。如果两个连接以完全相同的类型开始，都运行两个尝试更新同一行的更新，则两者都将尝试获取 X 锁。只有一个连接可以获取 X 锁。无法准确确定哪一个将获得锁。另一个连接必须等到锁被释放，才能获得 X 锁。请记住，如果该行被 DELETE 或 UPDATE 锁定，那么等待者在等待后可能最终没有获得锁，因为数据库中没有任何东西可以锁定。

在您的示例中，第一个 UPDATE 获取 X 锁，然后第二个 UPDATE 将等待 X 锁并最终执行但不匹配任何行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T22:40:39.000

所有 SQL 数据库都几乎可以保证不会发生这种冲突。“何时”发生锁定取决于锁定是在表、分区、页还是行级别。或者，您是否在数据库中关闭了此类锁定。

如果您有并发更新语句并且要更新多行，则可能发生的情况是，第一行更新了第一行，第二行更新了一些行。

一般来说，我认为 where 子句被评估为选择行集，一次锁定一个行，进行更新和解锁。但是，这取决于锁定的类型。在这种情况下，上述情况将继续值翻转。

如果您担心这种情况，请在处理并发更新请求时使用表级锁定来强制序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T22:30:42.713

听起来您应该阅读有关锁定的内容。SQL Server 有一组复杂的逻辑，将根据它估计需要更新的行数来执行表或行级别的锁定。除非您明确告诉它您希望它执行哪个，否则它甚至可能因查询而异。通常，如果您要修改表的一小部分，它将选择行级锁。

SQL Server 在设计时考虑了 ACID，因此它会在对数据执行任何实际更新之前将更改写入其日志。这允许回滚任何失败的更新，并允许查询之间的一致性（就像您询问的那样）。您可以执行脏读来解决锁定问题，但是您不能阻止 SQL Server 锁定插入、更新和/或删除的记录。

[SQL Server 锁定](http://msdn.microsoft.com/en-us/library/aa213039%28v=sql.80%29.aspx)

编辑：这是一篇关于 ACID 的文章。 [酸 - 维基百科](http://en.wikipedia.org/wiki/ACID#Atomicity)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T22:28:27.217

排他锁，用于数据修改操作，如 INSERT、UPDATE 或 DELETE，将在此场景中使用。

排他锁确保不能同时对同一资源进行多次更新。

在这种情况下，您不会获得竞争条件。

如果您有一个涉及多个表的更复杂的场景，那么您可能会遇到竞争条件或死锁。有很多方法可以避免这种情况，简化和分离查询等。

您还可以将提示应用于告诉 SQL 使用哪种类型的锁的查询。

[http://msdn.microsoft.com/en-us/library/aa213026(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa213026(v=sql.80).aspx)

# java - 如何将变量传递给 .property 文件中引用的 JVM？

> ID：11804008
> 
> 赞同：1
> 
> 时间：2012-08-03T22:14:02.107
> 
> 标签：java, variables, junit, intellij-idea

我的 .properties 文件中有以下内容：

```
connection1.username=${cloud.db.username}
connection1.password=${cloud.db.password} 
```

我想在运行/调试配置中传递这些变量

我认为我需要做的就是在 JVM 命令行中传递以下参数：`-Dcloud.db.username=JOHN -Dcloud.db.password=SECRET`.

但在代码调用中`Properties.getProperty()`仍然返回`${cloud.db.username}`.

我在 IntelliJ IDEA 下将它作为 junit 运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T22:46:19.187

使用 -D 将属性传递到 jvm 会将它们放入系统属性中（通过 System.getProperties() 访问）。

从代码中的文件创建 java.util.Properties 可为您提供一组完全独立的属性。

许多应用程序允许您通过命令行 -D 选项和在文件中指定属性。为此，他们必须在两者之间实现某种回退机制，并决定哪一个获得优先权。

此外，一些应用程序允许您将属性定义为引用另一个属性，它们通常通过扩展或包装 java.util.Properties 来实现。

您期望这两个东西都能正常工作，但 Java 都没有提供开箱即用的功能。

如果您想实现这些功能，请查看一些支持它们的开源项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T22:28:23.963

我不完全明白你为什么要做这样的事情。如果您没有真正使用它，为什么需要属性文件中的这些值？

如果您想将这两个参数作为自定义命令行参数 (-D) 传递，那么您不能这样做：

```
System.getProperty("cloud.db.username");
System.getProperty("cloud.db.password"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T22:36:57.733

的值`connection1.username`将始终为`"${cloud.db.username}"`，java 不会将其替换为另一个属性或环境变量的值。

如果您想要这样的替换，那么您必须实现它（遍历属性对象的整个值集并替换所有与此模式匹配的值与引用的属性的值）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T22:28:40.683

尝试通过访问`System.getProperty(...)`它们

# class - 为什么我不能将 Python 类字段作为参数传递？

> ID：11804009
> 
> 赞同：1
> 
> 时间：2012-08-03T22:14:03.333
> 
> 标签：class, python-2.7

我正在使用 Python 2.7 编写程序，发现自己试图将 Python 类字段作为同一类中的参数传递。虽然我已经修改了我的代码以使其更简洁（从而消除了对这种构造的需要），但我仍然很好奇。

对于一些例子（大大简化，但概念是存在的）：

[注意：对于示例 1 和 2，假设我想将一个数字作为输入并增加它，或者增加当前值。]

示例 1。

```
class Example:
    def __init__(self,x):
        self.value = x
    def incr(self,x=self.value):
        self.value = x + 1 
```

结果：

```
"NameError: name 'self' is not defined" 
```

示例 2。

```
class Example:
    def __init__(self,x):
        self.value = x
    def incr(self,x=value):
        self.value = x + 1 
```

结果：

```
"NameError: name 'value' is not defined" 
```

示例 3。

```
class Example:
    def __init__(self,x):
        ex2 = Example2()
        self.value = ex2.incr(x)
    def get_value(self):
        return self.value

class Example2:
    def __init__(self):
        self.value = 0
    def incr(self,x):
        return x + 1

ex = Example(3)
print ex.get_value() 
```

结果：

```
4 
```

重申我的问题，为什么我不能将 Python 类字段作为参数传递给它自己的方法？

如果您有任何其他问题或需要更多信息，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T22:18:34.983

方法默认值是在定义方法时评估的，而不是在调用方法时评估的。此时该类仍在定义中，因此不存在该类型的对象。因此你不能使用`self`.

您可以使用在您的方法中设置默认值`None`并对此进行测试的解决方法：

```
def incr(self,x=None):
    if x is None:
        x = self.value
    self.value = x + 1 
```

# performance - 信号器性能发生巨大变化的原因是什么？

> ID：11804019
> 
> 赞同：3
> 
> 时间：2012-08-03T22:15:15.447
> 
> 标签：performance, azure, signalr

我编写了一个基本的信号器集线器，它接受来自客户端的呼叫，更新数据库，然后向所有客户端发出通知。

```
public class ElementHub : Hub
{
    public void RenameElement(Guid elementId, string elementName)
    {
        //save details of rename

        //notify clients
        Clients.elementRenamed(elementId, elementName, DateTime.Now);
    }
} 
```

这在我的开发机器上完美运行 - 所有更新都是即时的（足够接近） - 但是当我将它发布到 Windows Azure 网站时，我开始看到一些奇怪的行为。

发布后，通过集线器的*第一个*通知仍然几乎是即时的 - 可能会延迟几秒钟。但是*第二次*通知有时会延迟多达 30 秒！

我在通知中包含了服务器时间戳，因此我可以确认服务器响应速度足够快。问题可能出在运输的某个地方。

我是信号员的新手，所以我什至不知道在哪里看。谁能建议可能导致这种行为的原因或我如何调试它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T23:44:00.587

缓冲和 Azure 网站现在存在一个错误，请参阅[http://github.com/SignalR/SignalR/issues/510](http://github.com/SignalR/SignalR/issues/510)。您现在可以通过使用 longpolling 来解决这个问题。与此同时，我们正在努力解决这个问题。

# java - HotspotFX 上的 Java EOF 问题

> ID：11804023
> 
> 赞同：0
> 
> 时间：2012-08-03T22:15:58.507
> 
> 标签：java

在过去的 30 天里，我在[Hotspot](http://www.hotspotfx.com/)上两次遇到此错误。

```
java.io.EOFException
at java.io.ObjectInputStream$BlockDataInputStream.peekByte(ObjectInputStream.java:2570)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1314)
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:368)
at xy.wZV(Unknown Source)
at xy.run(Unknown Source)
at java.lang.Thread.run(Thread.java:679) 
```

**关于如何复制错误的任何想法？**

如果有任何其他程序员/交易员遇到同样的错误，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T22:23:16.533

看起来您`ObjectInputStream`在读取对象的过程中发现了文件结尾。这是哪里`ObjectInputStream`来的？也许文件被截断，或者连接过早关闭？

# jquery - Farbtastic 将 HSL 转换回 RGB 或 Hex

> ID：11804027
> 
> 赞同：0
> 
> 时间：2012-08-03T22:16:10.067
> 
> 标签：jquery, hsl

**编辑：发布解决方案**

我想根据 Farbtastic 中选择的颜色创建色板。我对 HSL 值进行了计算，因为它更容易并产生更好的结果。

从 Farbtastic 获得 HSL 值后，我添加了亮度以创建新颜色。新颜色是 HSL 格式，我需要将其切换回 RGB 或 Hex，以便显示并保存以备后用。一些浏览器显示 HSL，但我不相信所有移动浏览器等都会这样做。

问题是在计算完成后将变量“newcolor”转换回 RGB 或 Hex。

```
// collect parent ids for farb
$(".farbtastic").parent().each(writeColorpanel);

function writeColorpanel (i, elem) {
    var picker = $.farbtastic(elem);  //farb object
    picker.linkTo(onColorChange); //a farb function
}  

    function onColorChange(color) {

    // retrieve hsl value, do calculations and place in hidden input.
    var hslcolor = $.farbtastic('#example_colorpicker_picker').hsl;

    // brighten by 40%
    var brightness = 1.4 * (Math.round(hslcolor[2]*10000)/10000);
    if (brightness>1) { brightness = 1 };
    if (brightness<0) { brightness = 0; }

    // create the new brighter color
    var newcolor = hslcolor;
    newcolor[2]=brightness;

    //convert to rgb (safer than trusting all mobile browsers to display HSL)
    var rgb = hsl2rgb(newcolor);

    //apply the color to swatches
    var firstSwatch = $('#section-example_colorpicker').find('.square1');
    firstSwatch.css( {'background-color': color } );
    var secondSwatch = $('#section-example_colorpicker').find('.square2');
    secondSwatch.css('background-color', 'rgb('+rgb.r+','+rgb.g+','+rgb.b+')');

}

function hsl2rgb(hsl) {
    var h = hsl[0], s = hsl[1], l = hsl[2];
    var m1, m2, hue;
    var r, g, b
    h = (Math.round( 360*h )/1);
    if (s == 0)
        r = g = b = (l * 255);
    else {
        if (l <= 0.5)
            m2 = l * (s + 1);
        else
            m2 = l + s - l * s;
        m1 = l * 2 - m2;
        hue = h / 360;
        r = Math.round(HueToRgb(m1, m2, hue + 1/3));
        g = Math.round(HueToRgb(m1, m2, hue));
        b = Math.round(HueToRgb(m1, m2, hue - 1/3));
    }
    return {r: r, g: g, b: b};
}

function HueToRgb(m1, m2, hue) {
    var v;
    if (hue < 0)
        hue += 1;
    else if (hue > 1)
        hue -= 1;

    if (6 * hue < 1)
        v = m1 + (m2 - m1) * hue * 6;
    else if (2 * hue < 1)
        v = m2;
    else if (3 * hue < 2)
        v = m1 + (m2 - m1) * (2/3 - hue) * 6;
    else
        v = m1;

    return 255 * v;
} 
```

请注意，标记为答案的脚本适用于整数值。由于 Farb 返回了小数值，所以我做了一些小的编辑，如上所示。

Wordpress 主题作者：如果您正在使用Wordpress 的[Options Framework 主题](http://wptheming.com/options-framework-theme/)，并且想要使用 Farbtastic 以便您可以使用 HSL 值，请参阅[Elihorn 的这个 Fork](https://github.com/elihorn/options-framework-theme/commit/34c3e702c523d83ba22d94d8d11190c5f90ce6f2)，其中包含您需要的文件。在这组文件中，我需要在我们将脚本排入队列的行中添加“wp_enqueue_style('farbtastic');”。不需要包含 farbtastic 的 .JS 文件，因为 WP 已经有了它。当然，您还需要将 Jquery 排入队列，可能位于 functions.php 的顶部。

对于这个问题的第 2 部分（重复问题），请参阅： [Return different values from function used multiple times](https://stackoverflow.com/questions/11821258/return-different-values-from-function-used-multiple-times)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:21:17.030

我决定分离这些功能并稍微重写它们，以便它们正常工作。
结束了这个：

```
function hsl2rgb(h, s, l) {
    var m1, m2, hue;
    var r, g, b
    s /=100;
    l /= 100;
    if (s == 0)
        r = g = b = (l * 255);
    else {
        if (l <= 0.5)
            m2 = l * (s + 1);
        else
            m2 = l + s - l * s;
        m1 = l * 2 - m2;
        hue = h / 360;
        r = Math.round(HueToRgb(m1, m2, hue + 1/3));
        g = Math.round(HueToRgb(m1, m2, hue));
        b = Math.round(HueToRgb(m1, m2, hue - 1/3));
    }
    return {r: r, g: g, b: b};
}

function HueToRgb(m1, m2, hue) {
    var v;
    if (hue < 0)
        hue += 1;
    else if (hue > 1)
        hue -= 1;

    if (6 * hue < 1)
        v = m1 + (m2 - m1) * hue * 6;
    else if (2 * hue < 1)
        v = m2;
    else if (3 * hue < 2)
        v = m1 + (m2 - m1) * (2/3 - hue) * 6;
    else
        v = m1;

    return 255 * v;
} 
```

它被称为：

```
//the HSL values to use
var h = 30;
var s = 20;
var l = 70;

//call the function into a variable, returns an object rgb = {r:163, g:174, b:196}
var rgb = hsl2rgb(h, s, l);

//can now be accessed with rgb.r etc, and remember that the last two are percentages 
```

这是一个[**演示**](http://jsfiddle.net/fxyt6/)

如果你的变量 newcolor 是一个字符串，你必须这样做：

```
var colorArray = newcolor.split(','),
    h = colorArray[0],  //  0.10434092941291336
    s = colorArray[1],  //  1
    l = colorArray[2];  //  0.756 
```

将 HSL 值放入正确的变量中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T22:29:55.933

[Michael Jackson 在他的网站](https://web.archive.org/web/20130204191053/http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript)上使用 JavaScript 进行了这种转换以及其他颜色转换。

```
function hslToRgb(h, s, l) {
    var r, g, b;

    if (s == 0) {
        r = g = b = l; // achromatic
    } else {
        function hue2rgb(p, q, t) {
            if (t < 0) t += 1;
            if (t > 1) t -= 1;
            if (t < 1 / 6) return p + (q - p) * 6 * t;
            if (t < 1 / 2) return q;
            if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
            return p;
        }

        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        var p = 2 * l - q;
        r = hue2rgb(p, q, h + 1 / 3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1 / 3);
    }

    return [r * 255, g * 255, b * 255];
} 
```

# c++ - 为什么直接调用字符数组不返回内存地址？

> ID：11804028
> 
> 赞同：1
> 
> 时间：2012-08-03T22:16:10.953
> 
> 标签：c++

我从[这里](http://pw1.netcom.com/~tjensen/ptr/ch2x.htm)了解到数组的名称是数组中第一个元素的地址，所以这对我来说很有意义：

```
int nbrs[] = {1,2};
cout << nbrs << endl;   // Outputs: 0x28ac60 
```

但是，为什么这里返回的是整个 C 字符串而不是 的地址`ltrs`？

```
char ltrs[] = "foo";
cout << ltrs << endl;   // Outputs: foo 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-03T22:18:30.570

因为 iostreams 有一个重载，`char *`它会打印出指针所指的内容，直到包含`\0`.

如果要打印地址，`void *`请先投射。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-03T22:18:52.683

`cout`已经`operator<<()`为 char* 数组重载，因此它输出数组的每个元素，直到它到达一个空字符，而不是输出指针的地址

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T22:18:41.873

`cout`，通常，C++ 流可以以特殊方式处理 C 字符串。`cout`运算符`<<`，`>>`被重载以处理许多不同的事情，这就是其中之一。

# c# - silverlight 项目文件的 ItemGroup 中的 WCFMetadata 标记

> ID：11804032
> 
> 赞同：7
> 
> 时间：2012-08-03T22:16:40.987
> 
> 标签：c#, .net, wpf, silverlight

此行出现在我的 Silverlight 应用程序 cs.project 文件中。

```
<ItemGroup>
<WCFMetadata Include="Service References\" />
</ItemGroup> 
```

只是想知道是否有人知道它是如何工作的以及它为什么在那里。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T22:32:10.523

当您右键单击`Service References`解决方案资源管理器中的节点并选择时，`Add Service Reference..`您可以将服务引用添加到您的 silverlight 项目。您将在您的 csproject 中看到一些额外的节点，并且在 Service References 文件夹下您将看到一堆自动生成的文件，这些文件可以帮助您轻松连接到服务并调用方法

然后你的项目看起来像这样

```
 <ItemGroup>
    <WCFMetadata Include="Service References\" />
  </ItemGroup>
  <ItemGroup>
    <WCFMetadataStorage Include="Service References\ServiceReference1\" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Service References\ServiceReference1\Foo-Web-Services-Bar.disco" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Service References\ServiceReference1\configuration91.svcinfo" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Service References\ServiceReference1\configuration.svcinfo" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Service References\ServiceReference1\Reference.svcmap">
      <Generator>WCF Proxy Generator</Generator>
      <LastGenOutput>Reference.cs</LastGenOutput>
    </None>
  </ItemGroup> 
```

您的为**空**，因为您尚未添加任何服务引用

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-03T22:32:22.477

根据我的经验，当您尝试添加对 WCF 服务的引用时，这些行会出现在 csproj 中

*   右键单击项目名称
*   选择“添加对服务的引用”（我使用的是非英语 VS，因此可能类似）

从您的线路状态来看，我认为您没有任何活动参考。
但是 VS 已经创建了子文件夹，它将存储定义未来引用所需的每个文件。（查看您的项目文件夹，您将找到文件夹“服务参考”

# c++ - QtTest单元测试，如何添加位于另一个项目中的头文件？

> ID：11804038
> 
> 赞同：15
> 
> 时间：2012-08-03T22:17:49.220
> 
> 标签：c++, qt, unit-testing, qt-creator, qttest

也许我遗漏了一些东西，但对我来说，为 QtTest 框架提供的唯一教程让您测试 QString 类似乎真的很愚蠢。

单元测试的典型用例是....测试您自己编写的类，但是在教程中没有提到如何在不同的项目中引用您的类进行测试，谷歌也让我失望了（我真的怀疑复制粘贴类是一个很好的方法）。

我什至翻阅了 3 种不同的 Qt 书籍，但没有提到 QtTest。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-03T23:24:21.600

您可以将包含路径添加到 .pro 文件中的其他项目目录，如下所示：

```
INCLUDEPATH += <directory> 
```

然后它应该能够找到您包含的标题。

**编辑：**基于评论

那完全是另一个故事。未定义的引用通常意味着您缺少依赖项。这通常可以通过以下两件事之一来解决。

最简单的方法是包含缺少的源文件：

```
INCLUDEPATH += ../myotherproject/
SOURCES = main.cpp ../myotherproject/missingsource.cpp 
```

也许更好的解决方案是通过将可重用代码编译为库并链接到它来公开可重用代码。例如，Windows 上的 .DLL 或 .LIB 和 Linux 上的 .SO 或 .A。

```
INCLUDEPATH += ../myotherproject/
win32:LIBS += ../myotherproject/linkme.lib 
```

你能告诉我们你得到的具体错误吗？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-12T03:58:16.100

我建议您将主应用程序项目和单元测试项目所需的所有源代码和头文件放入一个 .pri（.pro 包含）文件中。将此文件放在主项目中。然后将此文件包含在两个项目中。

请注意，每当向主项目添加新类时，QtCreator 会自动将`SOURCES +=`和`HEADERS +=`行附加到 .pro 文件中，但您希望它们位于 .pri 文件中，因此您需要在之后手动移动它们。我认为没有办法告诉 QtCreator 把它们放在哪里。

* * *

**主要项目：**

```
myproject.pro
myproject.pri
main.cpp
someclass.h
someclass.cpp 
```

我的项目.pro：

```
QT += ...
TARGET = ...
...

SOURCES += main.cpp       # "private" to this project
include(myproject.pri)    # needed in unit test 
```

我的项目.pri：

```
SOURCES += someclass.cpp
HEADERS += someclass.h 
```

* * *

**单元测试项目：**

```
unittest.pro
main.cpp
test.h
test.cpp 
```

单元测试.pro：

```
QT += ...
TARGET = ...
...

SOURCES += main.cpp test.cpp
HEADERS += test.h

# include the classes from the main project:
INCLUDEPATH += ../myproject/
include(../myproject/myproject.pri) 
```

# php - 如何使用 javascript 检测 php POST？

> ID：11804040
> 
> 赞同：2
> 
> 时间：2012-08-03T22:17:53.323
> 
> 标签：php, javascript, post, webforms

## 我的情况

我有一段 javascript 可以对 form.php 上的 web 表单进行多次操作。表单设置为`action="form.php"`并因此在提交时自行加载。webform 只是构建的`if (!isset($_POST['submit']))`，所以在发布之后，构成 webform 的输入元素和容器都不在那里。这通常是代码的结构：

```
<?php if (!isset($_POST['submit'])) { 
//the form has not been submitted
?>
  <form action="<?php $_SERVER['PHP_SELF']?>" method="post" id="form" name="form">
    <!-- general input elements -->
    <input type="submit" name="submit" value="Send">
  </form>
<?php }
else {
// the form has been submitted
  // posted values are submitted to a database
}
?> 
```

不过，javascript 仍然尝试对这些元素进行操作。由于这些不再存在，因此会发生错误。`if (HTMLElement)`我可以为对某个 HTMLElement 的每次操作使用一堆语句，但我希望有一个更可靠、更通用的解决方案。

## 问题

鉴于表单提交到其页面，并且不能在 POST 后简单地继续显示表单，你有什么建议我可以检测到 webform 的 POST 并关闭我的 javascript 的某些部分吗？

一个更普遍的问题是：

**javascript如何检测php POST？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T22:27:52.473

想到的一件事是这样的：

```
<?php if ($_SERVER['REQUEST_METHOD'] == 'POST') $isPost = true; ?>

// later on in your script

<?php if (!$isPost): ?>
<script type="text/javascript">
// the JS code that manipulates your form
</script>
<?php endif; ?> 
```

基本上，如果表单已发布，则不要渲染操作它的 JS 代码。如果该代码与您始终希望包含的其他代码混合在一起，那么您将不得不稍微改变它的工作方式。在这种情况下，您可以尝试：

```
<script type="text/javascript">
var isPost = <?php echo $isPost ? 'true' : 'false' ?>;

if (!isPost) {
    document.getElementById('blah').doSomething();
}
</script> 
```

# web - 是否合并多个http请求？

> ID：11804041
> 
> 赞同：0
> 
> 时间：2012-08-03T22:17:55.933
> 
> 标签：web, httprequest, backend

一些网页设计问题。

1.  将 POST 与 GET 结合使用？

    当用户点击一个按钮时，我需要发送一个 POST 来提交一个表单，然后需要 GET 一个 json 对象来替换一些 DOM 字段。我应该将它们组合成一个请求以节省一次往返时间吗？

2.  多个GET json请求？

    当用户单击按钮时，我需要获取 3 或 4 个 json 对象。我应该发送 3 个或 4 个 GET 请求，还是只发送一个并将 json 在后端组合成一个大 json？

所以基本上，我不确定哪个更重：往返时间​​VS有点复杂的后端和前端逻辑。

欢迎任何评论！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T22:25:19.203

如果我正确理解了您的问题...您对获取请求有依赖性...也就是说第二个获取取决于第一个...如果是这种情况，显然您需要进行连续的获取操作.. .但是，如果不是这种情况，如果您知道获取请求的顺序并且响应不会受到当地条件的影响...那么我建议您在服务器端进行发布/获取操作...触发第一个让服务器处理其余的并得到结果......

当然，您不希望用户为一个简单的操作执行多个 get 请求...

# javascript - Rails 3.1 将 JS.erb 返回为 html

> ID：11804046
> 
> 赞同：0
> 
> 时间：2012-08-03T22:18:29.803
> 
> 标签：javascript, ruby, ruby-on-rails-3.1

我有 3.0，不久前我升级到 3.1。我现在正在尝试在项目中添加一些 ajax，但由于某种原因，虽然它看起来设置正确并且链接作为远程链接触发，但它返回的响应是 html。

所以我像这样设置控制器：

```
respond_to do |format|
  format.js
end 
```

在视图中：

```
%li=link_to comp.title, company_filter_path(comp.id), :remote=>true 
```

但在萤火虫它返回这样的页面：

```
<!DOCTYPE html>
<html>
  <head>
    <title>test</title>

  </head>
  <body id='home' lang='en'>

      <section>
        <!-- = content_tag :h1, yield(:title) if show_title? -->

        alert("hello")

        console.log(2)

      </section>
  </body>
</html> 
```

我想这可能是我在升级时错过的东西，但我看不到是什么，有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T22:43:44.430

一位朋友给了我任何面临同样问题的人的答案。

我在应用程序文件夹中定义布局，这迫使 js 呈现为模板。

将格式更改为：

```
respond_to do |format|
      format.html { render "index"}
      format.js{render :content_type=>'text/javascript',:layout=>false}
    end 
```

一切正常！

# mvvm-light - 在 Messenger 类中使用令牌的正确方法是什么？

> ID：11804050
> 
> 赞同：4
> 
> 时间：2012-08-03T22:18:37.790
> 
> 标签：mvvm-light

我正在使用 MVVM Light Toolkit 的 3.0.3.19 版本。

来自[http://blog.galasoft.ch/archive/2010/03/16/whatrsquos-new-in-mvvm-light-v3.aspx](http://blog.galasoft.ch/archive/2010/03/16/whatrsquos-new-in-mvvm-light-v3.aspx)：

> 现在可以使用令牌通过 Messenger 发送消息。
> 
> *   要发送带有令牌的消息，请使用方法重载 Send(TMessage message, object token)。
>     
>     
> *   要接收带有令牌的消息，请使用方法 Register(object recipient, object token, Action action) 或 Register(object recipient, object token, bool receiveDerivedMessagesToo, Action action)
>     
>     
> 
> 标记可以是一个*简单的值（int、string 等）*或一个类的实例。消息不会传递给使用不同令牌或根本没有令牌注册的收件人。

* * *

根据上面的文档，我在 ViewModel A 中尝试了以下操作：

```
Messenger.Default.Send(new NotificationMessage("message"), "token"); 
```

连同 ViewModel B 中的以下内容：

```
Messenger.Default.Register<NotificationMessage>(this, "token", (msg) => Console.WriteLine(msg.Notification)); 
```

* * *

但是，回调永远不会执行。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T14:33:51.860

我的 ViewModelLocator 在 ViewModel B 之前初始化 ViewModel A。换句话说，消息由 ViewModel A 正确发送，但 ViewModel B 还没有实际接收到它。

我更改了 ViewModelLocator 中的初始化顺序，问题就解决了。此外，验证了 Messenger 可以使用除字符串之外的其他类型的令牌。

# php - 从 cURL XML 响应自定义数组

> ID：11804054
> 
> 赞同：1
> 
> 时间：2012-08-03T22:19:12.783
> 
> 标签：php, xml, curl

我需要从 cURL 请求中输出具有特定格式的数组。我尝试了很多方法来根据需要格式化 XML 结果，但没有运气。

这是PHP代码

```
<?php
$request_url = "http://ws.correios.com.br/calculador/CalcPrecoPrazo.aspx?nCdEmpresa=&sDsSenha=&sCepOrigem=71939360&sCepDestino=72151613&nVlPeso=1&nCdFormato=1&nVlComprimento=16&nVlAltura=5&nVlLargura=15&sCdMaoPropria=s&nVlValorDeclarado=200&sCdAvisoRecebimento=n&nCdServico=41106%2C40045&nVlDiametro=0&StrRetorno=xml 4110616,9034,000,001,50SN04004519,2014,000,002,00SS0";

$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $request_url);
curl_setopt($curl, CURLOPT_TIMEOUT, 130);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);

$response = curl_exec($curl);
            curl_close($curl);    

print_r($response);
?> 
```

它打印以下 XML

```
<servicos>
    <cservico>
        <codigo>41106</codigo>
        <valor>16,90</valor>
        <prazoentrega>3</prazoentrega>
        ...
        <erro>0</erro>
        <msgerro>
        </msgerro>
    </cservico>
    <cservico>
        <codigo>40045</codigo>
        <valor>19,20</valor>
        <prazoentrega>1</prazoentrega>
        ...
        <erro>0</erro>
        <msgerro>
        </msgerro>
    </cservico>
</servicos> 
```

或者如果我申请以下数组`$xml = new SimpleXMLElement($response);`

```
SimpleXMLElement Object
(
    [cServico] => Array
        (
            [0] => SimpleXMLElement Object
                (
                    [Codigo] => 41106
                    [Valor] => 16,90
                    [PrazoEntrega] => 3
                    ...
                    [Erro] => 0
                    [MsgErro] => SimpleXMLElement Object
                        (
                        )
                )
            [1] => SimpleXMLElement Object
                (
                    [Codigo] => 40045
                    [Valor] => 19,20
                    [PrazoEntrega] => 1
                    ...
                    [Erro] => 0
                    [MsgErro] => SimpleXMLElement Object
                        (
                        )
                )
        )
) 
```

我需要返回的是这样的数组。我在这里尝试了其他问题中发现的几乎所有方法，但从未找到构造这个二维数组的好方法。

```
array(
    'Option Name' => array(
       'id'=>'40045',
       'quote'=>'20,20',
       'days'=>'1',
    ),
    'Option Name' => array(
       'id'=>'40215',
       'quote'=>'29,27',
       'days'=>'3',
    )
) 
```

*选项名称将通过 ID 代码检索。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T22:22:13.883

这应该完美无缺！

```
$xml = simplexml_load_string($response);
$json = json_encode($xml);
$arr = json_decode($json,true);

$temp = array();
foreach($arr as $k=>$v) {
  foreach($v as $k1=>$v1) {
    $temp[$k][$k1] = $v1;
  }
}

echo "<pre>";print_r($temp);echo "</pre>"; 
```

[http://ka.lpe.sh/2012/07/26/php-convert-xml-to-json-to-array-in-an-easy-way/](http://ka.lpe.sh/2012/07/26/php-convert-xml-to-json-to-array-in-an-easy-way/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T22:33:01.603

试试这个函数（将响应传递给它，它应该返回你的数组）：

```
function getArrayFromResponse($response) {
  $xml = new SimpleXMLElement($response);
  $array = array();
  foreach($xml->cServico as $node){
    $array[] = array(
       'id' => $node->Codigo,
       'quote' => $node->Valor,
       'days' => $node->PrazoEntrega
    );
  }
  return $array;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-13T06:51:48.920

```
 $ch = curl_init();
 $sendurl = "http://example.com";
 curl_setopt($ch, CURLOPT_URL, $sendurl);
 curl_setopt($ch, CURLOPT_POST, 1);
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
 $data = curl_exec($ch);
 curl_close($ch);

 $response = preg_replace("/(<\/?)(\w+):([^>]*>)/", "$1$2$3", $data);
 $xml = new \SimpleXMLElement($response);
 $array = json_decode(json_encode((array)$xml), TRUE);

 echo "<pre>";
 print_r($array); 
```

Working charming for me.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-04T20:07:17.203

我终于明白了。在测试了你所有的建议和在谷歌上找到的许多其他建议之后，我想出了这个：

```
<?php
$request_url = "http://ws.correios.com.br/calculador/CalcPrecoPrazo.aspx?nCdEmpresa=&sDsSenha=&sCepOrigem=71939360&sCepDestino=72151613&nVlPeso=1&nCdFormato=1&nVlComprimento=16&nVlAltura=5&nVlLargura=15&sCdMaoPropria=s&nVlValorDeclarado=200&sCdAvisoRecebimento=n&nCdServico=41106%2C40045&nVlDiametro=0&StrRetorno=xml 4110616,9034,000,001,50SN04004519,2014,000,002,00SS0";

//Setup cURL Request
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $request_url);
curl_setopt($curl, CURLOPT_TIMEOUT, 130);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);

$response = curl_exec($curl);
            curl_close($curl);  

$xml = simplexml_load_string($response); 

$services = $xml->cServico;

$result = array();

foreach($services as $service) {
    $id = $service->Codigo->__toString();
    $quote = $service->Valor->__toString();
    $delivery_days = $service->PrazoEntrega->__toString();

    //Get simplified service name (option_name) 
    switch ($id) {
        case "40010":
        case "40096":
        case "40436":
        case "40444":
        case "40568":
        case "40606":
            $option_name = 'SEDEX'; break;
        case "81019":
        case "81868":
        case "81833":
        case "81850":
            $option_name = 'e-SEDEX'; break;
        case "41106":
        case "41068":
            $option_name = 'PAC'; break;
        case "40045":
        case "40126":
            $option_name = 'SEDEX a Cobrar'; break;
        case "40215":
            $option_name = 'SEDEX 10'; break;
        case "40290":
            $option_name = 'SEDEX Hoje'; break;
        case "81027":
            $option_name = 'e-SEDEX Prioritário'; break;
        case "81035":
            $option_name = 'e-SEDEX Express'; break;
    }

    $result[$option_name] = array('id' => $id, 'quote' => $quote, 'delivery_days' => $delivery_days);
}
?> 
```

最后一个秘密是添加`__toString()`以将作为数组返回的值转换为简单字符串。它打印完美。感谢你们！！

```
Array
(
    [PAC] => Array
        (
            [id] => 41106
            [quote] => 16,90
            [delivery_days] => 3
        )

    [SEDEX a Cobrar] => Array
        (
            [id] => 40045
            [quote] => 19,20
            [delivery_days] => 1
        )

) 
```

# java - 解释的java IDE环境

> ID：11804060
> 
> 赞同：3
> 
> 时间：2012-08-03T22:19:39.800
> 
> 标签：java, scripting, ide

在 Ruby/Python/Perl 等脚本语言中，我们可以启动一个交互式会话并创建新变量，然后执行任何语句。

但是在 Java 中，我只知道一种打印任意表达式的方法——在 Eclipse 的调试表达式视图中。

无法创建新的 var，然后再使用该 var（尽管您可以分配给预先存在的 var）。

有没有办法像脚本语言一样在解释型 IDE 环境中运行 Java？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T22:27:35.960

查看[Groovy](http://groovy.codehaus.org)。如果您想坚持使用纯 Java，我认为 Groovy 会很乐意执行任何有效的 Java 代码。您可以通过 GroovySH [交互式 shell](http://groovy.codehaus.org/Groovy+Shell)来查看它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-03T22:26:14.913

查看[Beanshell](http://www.beanshell.org/) 已经有一段时间了。您还可以查看[IDEOne](http://ideone.com/)网站，了解多种语言的类似 IDE 的在线环境（不完全是 shell）。是的，我也想提一下 Groovy，它有 groovy shell。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-02T06:53:52.910

从 Java 9 开始，将有一个 REPL 可让您启动交互式 Java 会话。

它叫做 JShell，你可以阅读原始提案：[JEP 222: jshell: The Java Shell (Read-Eval-Print Loop)](http://openjdk.java.net/jeps/222)

如果您希望看到 JShell 的实际应用，有许多博客和文章[探讨](http://jakubdziworski.github.io/java/2016/07/31/jshell-getting-started-examples.html)了 JShell的一些[特性。](http://blog.takipi.com/java-9-early-access-a-hands-on-session-with-jshell-the-java-repl/)

# javascript - 在多个输入字段上粘贴多个数字

> ID：11804064
> 
> 赞同：7
> 
> 时间：2012-08-03T22:20:02.873
> 
> 标签：javascript, jquery, html, forms, webforms

我的网站上有一个使用 6 个输入字段的表单。网站访问者只需在这 6 个框中输入一个 6 位代码。问题是他们将获得 6 位代码，理想的做法是让他们简单地将我们发送给他们的 6 位代码复制到这些输入字段中，只需将粘贴到第一个输入字段并让剩下的 5 位数字去进入剩余的 5 个输入字段。它只会比手动将每个数字输入每个输入字段更容易。

这是我们当前使用的代码，但可以很容易地对其进行更改以完成上述内容：

```
<input type="text" maxlength="1" class="def-txt-input" name="chars[1]">
<input type="text" maxlength="1" class="def-txt-input" name="chars[2]">
<input type="text" maxlength="1" class="def-txt-input" name="chars[3]">
<input type="text" maxlength="1" class="def-txt-input" name="chars[4]">
<input type="text" maxlength="1" class="def-txt-input" name="chars[5]">
<input type="text" maxlength="1" class="def-txt-input" name="chars[6]"> 
```

我在这里看到了类似的帖子：[Pasing of serialnumber over multiple textfields](https://stackoverflow.com/questions/8028862/pasting-of-serialnumber-over-multiple-textfields)

但它没有我正在寻找的解决方案。理想情况下，这可以使用 jQuery 或纯 JavaScript 实现。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-03T23:21:03.027

**Edit**

I didn't like the timer solution I used in the `paste` event and the complexity of just using the `input` or `paste` event.

After looking at this for a while I added a solution which uses a hybrid between the 2. The code seems to do all that is required now.

The Script:

```
var $inputs = $(".def-txt-input");
var intRegex = /^\d+$/;

// Prevents user from manually entering non-digits.
$inputs.on("input.fromManual", function(){
    if(!intRegex.test($(this).val())){
        $(this).val("");
    }
});

// Prevents pasting non-digits and if value is 6 characters long will parse each character into an individual box.
$inputs.on("paste", function() {
    var $this = $(this);
    var originalValue = $this.val();

    $this.val("");

    $this.one("input.fromPaste", function(){
        $currentInputBox = $(this);

        var pastedValue = $currentInputBox.val();

        if (pastedValue.length == 6 && intRegex.test(pastedValue)) {
            pasteValues(pastedValue);
        }
        else {
            $this.val(originalValue);
        }

        $inputs.attr("maxlength", 1);
    });

    $inputs.attr("maxlength", 6);
});

// Parses the individual digits into the individual boxes.
function pasteValues(element) {
    var values = element.split("");

    $(values).each(function(index) {
        var $inputBox = $('.def-txt-input[name="chars[' + (index + 1) + ']"]');
        $inputBox.val(values[index])
    });
};​ 
```

See [**DEMO**](http://jsfiddle.net/D7jVR/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T03:18:18.540

Here is an example of a **jquery plugin that does the same thing as the original answer** only generalized.

I went to great lengths to modify the original answer ( [http://jsfiddle.net/D7jVR/](http://jsfiddle.net/D7jVR/) ) to a jquery plugin and the source code is here: [https://github.com/relipse/jquery-pastehopacross/blob/master/jquery.pastehopacross.js](https://github.com/relipse/jquery-pastehopacross/blob/master/jquery.pastehopacross.js)

An example of this on jsfiddle is here: [http://jsfiddle.net/D7jVR/111/](http://jsfiddle.net/D7jVR/111/)

The source as of 4-Apr-2013 is below:

```
/**
 * PasteHopAcross jquery plugin
 * Paste across multiple inputs plugin, 
 * inspired by http://jsfiddle.net/D7jVR/
 */
(function ($) {
    jQuery.fn.pastehopacross = function(opts){ 
       if (!opts){ opts = {} }
        if (!opts.regexRemove){
            opts.regexRemove = false;   
        }
        if (!opts.inputs){
           opts.inputs = [];   
        }
        if (opts.inputs.length == 0){
            //return 
            return $(this);   
        }

        if (!opts.first_maxlength){
            opts.first_maxlength = $(this).attr('maxlength');
            if (!opts.first_maxlength){
                return $(this);
            }
        }

       $(this).on('paste', function(){

           //remove maxlength attribute
           $(this).removeAttr('maxlength'); 
           $(this).one("input.fromPaste", function(){
               var $firstBox = $(this);

                var pastedValue = $(this).val();
                if (opts.regexRemove){
                     pastedValue = pastedValue.replace(opts.regexRemove, "");
                }

                var str_pv = pastedValue;
                $(opts.inputs).each(function(){
                    var pv = str_pv.split('');
                    var maxlength;
                    if ($firstBox.get(0) == this){
                       maxlength = opts.first_maxlength;   
                    }else{
                       maxlength = $(this).attr('maxlength'); 
                    }
                    if (maxlength == undefined){
                        //paste them all!
                        maxlength = pv.length;   
                    }
                    //clear the value
                    $(this).val('');
                    var nwval = '';           
                    for (var i = 0; i < maxlength; ++i){
                        if (typeof(pv[i]) != 'undefined'){
                           nwval += pv[i];
                        }
                    }
                    $(this).val(nwval);
                    //remove everything from earlier
                    str_pv = str_pv.substring(maxlength);
                });

                //restore maxlength attribute
                $(this).attr('maxlength', opts.first_maxlength);
            });    

       });

       return $(this);
    }
})(jQuery); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T22:31:11.600

这应该不会太难......在第一个*input上为**paste*事件添加一个处理程序，然后根据要求进行处理。

 ***编辑**

实际上这比我想象的要棘手得多，因为似乎没有办法获得粘贴的文本。您可能不得不使用类似这样的东西（半工作）......（参见[JSFiddle](http://jsfiddle.net/pnNjH/3)）来破解这个功能。

```
$(document).on("input", "input[name^=chars]", function(e) {
    // get the text entered
    var text = $(this).val();

    // if 6 characters were entered, place one in each of the input textboxes
    if (text.length == 6) {
        for (i=1 ; i<=text.length ; i++) {
            $("input[name^=chars]").eq(i-1).val(text[i-1]);
        }    
    }
    // otherwise, make sure a maximum of 1 character can be entered
    else if (text.length > 1) {
        $(this).val(text[0]);
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-13T06:22:24.970

HTML

```
<input id="input-1" maxlength="1" type="number" />
<input id="input-2" maxlength="1" type="number" />
<input id="input-3" maxlength="1" type="number" />
<input id="input-4" maxlength="1" type="number" /> 
```

jQuery

```
$("input").bind("paste", function(e){
   var pastedData = e.originalEvent.clipboardData.getData('text');
   var num_array = [];
   num_array = pastedData.toString(10).replace(/\D/g, '0').split('').map(Number); // creates array of numbers
   for(var a = 0; a < 4; a++) {  // Since I have 4 input boxes to fill in
     var pos = a+1;
     event.preventDefault();
     $('#input-'+pos).val(num_array[a]);
   }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-03T23:07:55.470

您将不得不纠正一些自定义代码。您可能必须删除 maxlength 属性并使用 javascript 来强制每个输入一个数字的限制。

As dbasemane suggests, you can listen for a paste event. You can listen to keyup events too to allow the user to type out numbers without having to switch to the next input.

Here is one possible solution:

```
function handleCharacter(event) {
    var $input = $(this),
        index = getIndex($input),
        digit = $input.val().slice(0,1),
        rest = $input.val().slice(1),
        $next;

    if (rest.length > 0) {
        $input.val(digit);  // trim input value to just one character
        $next = $('.def-txt-input[name="chars['+ (index + 1) +']"]');

        if ($next.length > 0) {
            $next.val(rest);  // push the rest of the value into the next input
            $next.focus();
            handleCharacter.call($next, event);  // run the same code on the next input
        }
    }
}

function handleBackspace(event) {
    var $input = $(this),
        index = getIndex($input),
        $prev;

    // if the user pressed backspace and the input is empty
    if (event.which === 8 && !$(this).val()) {
        $prev = $('.def-txt-input[name="chars['+ (index - 1) +']"]');
        $prev.focus();
    }
}

function getIndex($input) {
    return parseInt($input.attr('name').split(/[\[\]]/)[1], 10);
}

$('.def-txt-input')
    .on('keyup paste', handleCharacter)
    .on('keydown', handleBackspace); 
```

I have this code set up on jsfiddle, so you can take a look at how it runs: [http://jsfiddle.net/hallettj/Kcyna/](http://jsfiddle.net/hallettj/Kcyna/)*

# php - CakePHP - 创建 2 个 $content_for_layout 变量

> ID：11804071
> 
> 赞同：4
> 
> 时间：2012-08-03T22:21:20.277
> 
> 标签：php, cakephp, cakephp-1.2

我正在为我的公司进行全面的重新设计，但遇到了问题。我们正在使用 Cake Framework (1.2.0.7296 RC2) 进行构建，我正在尝试找到创建可靠布局模板的最佳解决方案。我创建的设计在每个页面中都有多个包装器。下面是代码的简化版本。

```
<body style="background:url(somebackground.png);">
    <div class="page">
    <!--Page is used to constrain the content within a specific width-->
        <div class="header">
        <div class="nav">

      </div><!--End Nav-->
    </div><!--End Header-->
    <div class="content">
      <!--This area contains a slideshow and other info that varies from page-to-page-->
    </div><!--End Content-->
 </div><!--End Page-->
 <div class="wrapper" style="background:url(someotherbackground.png);">
    <div class="page">
    <div class="content">
        <!--Additional content-->
    </div><!--End Content-->
  </div><!--End Page-->
 </div><!--End Wrapper-->
 </body> 
```

问题是在 Cake 布局中只有一个 $content_for_layout，它适用于大多数网站。但是，由于我的结构方式，很难充分利用布局模板。我想到的唯一解决方案如下。

*   关闭标题后的顶部 div class='page ，然后在其下方添加另一个 div class='page' 。这样我就可以将标题和导航放在元素中，并将它们仅保留在布局模板中。问题是我没有充分利用模板，因为我仍然要重复很多 html。

理想情况下，我想要 2 个 $content_for_layout。一个用于第一页下方的内容，另一个用于第二页的内容。这样我就可以充分利用布局模板。然后在我的页面上，我会有一个可以放置透视内容的部分。在我对这个问题的研究中，我找到了一些解决方案。

*   [http://cakephp.1045679.n5.nabble.com/Multiple-content-for-layout-td1281556.html](http://cakephp.1045679.n5.nabble.com/Multiple-content-for-layout-td1281556.html)
*   [http://bakery.cakephp.org/articles/rtconner/2007/08/28/anything_for_layout-making-html-from-the-view-available-to-the-layout](http://bakery.cakephp.org/articles/rtconner/2007/08/28/anything_for_layout-making-html-from-the-view-available-to-the-layout)

我不确定这些是否是最好的解决方案，或者是否会给我我正在寻找的东西。我是一名设计师和前端开发人员，所以我对 PHP 的了解有限。我对Cake的了解就更有限了。我正在寻找最简单的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T22:47:00.577

如果可能（但我假设不是），请使用最新版本的 Cake（2.2.1 稳定版）。从 2.1 开始，Cake 支持[View Blocks](http://book.cakephp.org/2.0/en/appendices/new-features-in-cakephp-2-1.html#view)，可以解决您遇到的确切问题。

如果不可能，您可以从 Controller 设置一些变量（可能是渲染的元素，或者更好的是，您必须转发到从布局渲染的元素的变量），并在布局上的任何位置回显. 您从控制器传递到视图的所有变量也`Controller::set`将可用于布局。

# google-maps - Google Map V3，如何获取多个目的地的最佳行车路线列表？

> ID：11804073
> 
> 赞同：21
> 
> 时间：2012-08-03T22:21:27.003
> 
> 标签：google-maps, routes

我想使用 Gmap API 来计算许多目的地的最佳行车路线。我已阅读此页面：

[http://googlegeodevelopers.blogspot.de/2010/03/good-day-for-salesmen-that-travel-on.html](http://googlegeodevelopers.blogspot.de/2010/03/good-day-for-salesmen-that-travel-on.html)

这几乎是我想要的东西。但是，我只想获取目的地列表，该列表已排序并告诉首先去哪个目的地。

例如：我将三个目的地 A、B、C 的位置发送到 Gmap。我需要接收一个像 $bestroute[] = {B,C,A} 这样的数组。

我将使用 PHP 和 javascript 进行编码。如果您可以帮助我或知道任何教程，请提供帮助。

非常感谢。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-03T23:01:12.607

您引用的链接解释了如何执行此操作：诚然，您还可以返回一些您不关心的方向信息，但您可以简单地忽略它。

需要明确的是，除了您的起点和目的地（A 和 E）之外，您只需使用一些航路点（例如 B、C 和 D）提出路线请求。

如果使用[网络服务](https://developers.google.com/maps/documentation/directions/)，请确保在列出您的航点之前设置 optimize:true，并检查 waypoint_order 数组（靠近此 url 结果的底部）以获得您想要的信息：

```
http://maps.googleapis.com/maps/api/directions/json?origin=Adelaide,SA&destination=Adelaide,SA&waypoints=optimize:true|Barossa+Valley,SA|Clare,SA|Connawarra,SA|McLaren+Vale,SA&sensor=false 
```

如果使用 JS API，请在您的请求中设置 optimizeWaypoints:true。

与往常一样，请确保您遵守服务条款（例如，您的网络服务请求的结果必须显示在 Google 地图上）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-04T12:52:15.770

您可能想查看距离矩阵服务：[https ://developers.google.com/maps/documentation/javascript/distancematrix](https://developers.google.com/maps/documentation/javascript/distancematrix)

它为您提供一组起点和终点之间的距离，并可能帮助您缩小选项范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-12T16:07:53.850

经过一番搜索后，我使用了这个包[https://github.com/alexpechkarev/google-maps](https://github.com/alexpechkarev/google-maps) 和下面的参数：

```
$origin = ['lat' => 35.762288, 'lng' => -5.866525, 'ville' => 'tanger'];
    $destination = ['lat' => 33.565567, 'lng' => -7.552402, 'ville' => 'casablanca'];
    $points = [
        ['lat' => 33.951825, 'lng' => -6.839634, 'ville' => 'rabat'],
        ['lat' => 35.475028, 'lng' => -6.015167, 'ville' => 'assilah'],
        ['lat' => 35.178713, 'lng' => -6.132972, 'ville' => 'laarach'],
        ['lat' => 34.868921, 'lng' => -6.247939, 'ville' => 'moulay Bouslham'],
        ['lat' => 33.834129, 'lng' => -6.054144, 'ville' => 'khmissat'],
        ['lat' => 35.574788, 'lng' => -5.360490, 'ville' => 'Tetouan'],

    ];

    $wayPointsString = collect($points)->transform(function ($point) {
        return $point['lat'] . ',' . $point['lng'];
    })->implode('|');

    $data = \GoogleMaps::load('directions')
        ->setEndpoint('json')
        ->setParam([
            'origin' => collect($origin)->take(2)->implode(','),//tanger
            'destination' => collect($destination)->take(2)->implode(','), // casablanca
            'waypoints' => ['optimize:true|' . $wayPointsString
            ],
            'mode' => 'driving',
            'alternatives' => true,
            'departure_time' => 'now',
        ])
        ->get();

    $data = json_decode($data, true);
    $points_ = [];
    $points_[] = $origin;

    foreach ($data['routes'][0]['waypoint_order'] as $key => $value) {
        $points_[] = $points[$value];
    }
    $points_[] = $destination;
    dd($points_); 
```

作为回应：

```
array:8 [
  0 => array:3 [
    "lat" => 35.762288
    "lng" => -5.866525
    "ville" => "tanger"
  ]
  1 => array:3 [
    "lat" => 35.574788
    "lng" => -5.36049
    "ville" => "Tetouan"
  ]
  2 => array:3 [
    "lat" => 35.475028
    "lng" => -6.015167
    "ville" => "assilah"
  ]
  3 => array:3 [
    "lat" => 35.178713
    "lng" => -6.132972
    "ville" => "laarach"
  ]
  4 => array:3 [
    "lat" => 34.868921
    "lng" => -6.247939
    "ville" => "moulay Bouslham"
  ]
  5 => array:3 [
    "lat" => 33.834129
    "lng" => -6.054144
    "ville" => "khmissat"
  ]
  6 => array:3 [
    "lat" => 33.951825
    "lng" => -6.839634
    "ville" => "rabat"
  ]
  7 => array:3 [
    "lat" => 33.565567
    "lng" => -7.552402
    "ville" => "casablanca"
  ]
] 
```

# android - 在Android中保存大量文本和图像的方法

> ID：11804074
> 
> 赞同：0
> 
> 时间：2012-08-03T22:21:29.140
> 
> 标签：android, sqlite, data-storage

**底部的简短版本**

我正在为电脑游戏《新英雄英雄》开发一个安卓应用程序。应用程序功能的一部分是列出游戏中的所有英雄。每个英雄都有：

*   简短的描述
*   一些统计数据（派系和主要属性）
*   一个图标
*   4个法术，其中还有：
    *   简短的描述
    *   一些统计数据（法力消耗，等级差异等）
    *   一个图标。

大约有 110 个英雄，这意味着我有大约 500 组描述和统计数据。

我制作了该应用程序的工作版本。我下载了所有图像并将它们放在`drawable`文件夹中*（注意，这是 500 张图像）*，并创建了一个`Hero Enum`存储的`name`,`faction`和`primary attribute`. 显然，这是一个坏主意，因为它看起来很糟糕，并且很难扩展到存储其余数据。

我虽然有使用数据库，但由于我对数据库没有任何经验，我不太确定如何做到这一点，尤其是在 Android 中。我查了一下，似乎我需要在手机上初始化数据库，这意味着我必须从某个地方获取这些数据——这再次意味着我又回到了原点。

我从未在编程项目中处理过这么多数据，也不知道如何保存所有数据。似乎这还不够，游戏开发商 S2 Games 仅间隔数周就发布了新英雄。由于我不想每隔一周更新一次我的应用程序，我希望该应用程序能够使用新数据进行自我更新。我在脑海中看到这一点的最佳方式是您下载该应用程序，可以使用当前英雄的数据库，也可以不使用任何数据库，并且该应用程序会在每个星期五（补丁在星期五发布）检查应用程序是否是最新的。如果没有，请更新数据库（使用文本和图标）。

# 精简版

我想保存几千个字符串，一些以特殊方式格式化（除非我之后可以这样做），以及大约 500 个图标。我应该如何处理这个？

*注意：我知道这是一个非常糟糕的问题，结构很糟糕，但我已经被困在这里好几个星期了，我无法让自己问别人，我真的需要帮助！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:48:10.460

well it's very recommended that you use sql and databases . you could go to w3schools for the basics .

if you don't want to use DB (or don't have time) , you can store all the data in xml files , and then parse them all . the images should never be part of the DB (or the xml files) , since they cause a bad performance while moving between items.put their names/paths instead .

if the images take a lot of space , consider using google expansion library .

# java - 为什么tomcat7在JAAS中找不到LoginModule类

> ID：11804075
> 
> 赞同：0
> 
> 时间：2012-08-03T22:21:31.430
> 
> 标签：java, tomcat, tomcat7, jaas

我有一个打包在 WAR 中的应用程序，它在现有的 Tomcat6 服务器上运行良好。

我现在正在尝试将它部署在 tomcat7 中，但是一旦我运行登录操作，就会收到以下错误：登录失败。原因：LoginException：找不到 LoginModule 类：security.jass.SimpleLoginModule

我在 conf 文件中有以下内容，该文件在 Java 的 security.properties 中定义：

```
UserLoginImpo
{
security.jass.SimpleLoginModule required;
}; 
```

在此处更改类名（更改为错误的类名）将使tomcat说找不到该类名，从而消除了“未拾取conf文件”的原因。

该类应该在类路径中：它在 WAR 的 lib 文件夹中的一个 jar 中。

我会错过什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T10:19:47.127

正如@Jim 指出的那样，包名不正确：security.jaas，而不是security.jass。

去证明你真的需要注意细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T16:15:51.067

ssomrone 可以告诉我这两个类路径之间的区别吗？我看不到它。编辑哇，很明显，但也很滑 - 两个 's' 字符与两个 's' 字符。

# javascript - shell中的node.js鼠标按下事件

> ID：11804077
> 
> 赞同：0
> 
> 时间：2012-08-03T22:22:11.343
> 
> 标签：javascript, events, node.js, mouse

是否可以在 node.js 中跟踪 shell 上的鼠标点击。

东西链接：

```
process.on('mousepress', function(data){

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T22:26:14.523

也许这会有所帮助：[https ://github.com/mscdex/node-ncurses](https://github.com/mscdex/node-ncurses)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-25T03:09:17.213

该`keypress`软件包具有以下功能：

[https://www.npmjs.com/package/keypress#listening-for-mousepress-events](https://www.npmjs.com/package/keypress#listening-for-mousepress-events)

# emacs - 在emacs中替换文件

> ID：11804080
> 
> 赞同：3
> 
> 时间：2012-08-03T22:22:46.357
> 
> 标签：emacs, elisp, emacs24

我在这里找到了替换 filen 的功能，但它似乎无法正常工作：[http](http://www.emacswiki.org/emacs/InsertFileName) ://www.emacswiki.org/emacs/InsertFileName 。它正确地找到了文件点，但替换似乎采用了您输入的文件，而不是从我所看到的最初检测到的文件。我不知道如何解决这个问题。

如果我在 /home/testfile 上运行该函数

首先它说要替换的文件，例如：/home/secondfile 然后它说将'/home/secondfile'替换为：/home/secondfile 然后它说：此时没有文件

有任何想法吗？？

这是功能：

```
(autoload 'ffap-guesser "ffap")
(autoload 'ffap-read-file-or-url "ffap")

(defun my-replace-file-at-point (currfile newfile)
"Replace CURRFILE at point with NEWFILE.

  When interactive, CURRFILE will need to be confirmed by user
  and will need to exist on the file system to be recognized,
  unless it is a URL.

  NEWFILE does not need to exist.  However, Emacs's minibuffer
  completion can help if it needs to be.
  " 

(interactive
 (let ((currfile (ffap-read-file-or-url "Replace filename: "
                                        (ffap-guesser))))
   (list currfile
         (ffap-read-file-or-url (format "Replace `%s' with: "
                                        currfile) currfile))))
(save-match-data
  (if (or (looking-at (regexp-quote currfile))
          (let ((filelen (length currfile))
                (opoint (point))
                (limit (+ (point) (length currfile))))
            (save-excursion
              (goto-char (1- filelen))
              (and (search-forward currfile limit
                                   'noerror)
                   (< (match-beginning 0) opoint))
                   (>= (match-end 0) opoint))))
      (replace-match newfile)
    (error "No file at point to replace")))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T10:40:33.520

这里可能有一些错误/正在发生的事情。第一个是执行此操作时的点位置。第二个是，如果您使用的是 /home/user/something，则很有可能 /home/user/something 和 ~/something 之间存在不匹配（ffap 返回后者，而此时您可能已经编写了以前的）。

**第一的：**

与正则表达式引用的文件名一起使用`looking-at`预计该点位于开头：例如`|/home/user/something`.

它的合作伙伴`looking-back`期望`/home/user/something|`. 在中间的某个地方会抛出这个错误。

对此的一种**快速解决**方法是更改`looking-at`​​为`thing-at-point-looking-at`.

**第二：**

如果你写了 /home/user/something，ffap 函数（在我的例子中）使用 ~ 来缩短它。可能有一些设置可以控制这一点，但我所知道的最简单、快速的解决方法是使用`expand-file-name`. 这将处理第一种情况，如果它被写为 ~/something，`save-excursion`主体将在替代情况下替换它。

我看到的唯一负面结果是，您有时可能会替换：

`/home/user/something`和`~/somethingelse`

但是，无论如何，这两个快速修复只会导致这种彻底的变化：

`(thing-at-point-looking-at (regexp-quote (expand-file-name currfile)))`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T06:48:20.623

看不到“ffap-guesser”的定义位置。看起来像一个错误。

也许试试

“查找文件点”

# javascript - 如何获取列表框中所选项目的索引？

> ID：11804081
> 
> 赞同：3
> 
> 时间：2012-08-03T22:23:07.657
> 
> 标签：javascript, google-apps-script, google-sites

我想在 Google Apps 脚本列表框中获取所选项目的索引，而不是所选项目本身。到目前为止，我看到的所有示例都创建了一个服务器处理程序，它通过以下方式获取列表框的值

```
var list1Value = e.parameter.list1; 
```

我想获得索引，所以我可以索引到一个数组中。我尝试使用此解决方案 [http://productforums.google.com/forum/#!category-topic/apps-script/services/vXa57-9T6E4](http://productforums.google.com/forum/#!category-topic/apps-script/services/vXa57-9T6E4) 但我的脚本抱怨 indexOf 无法识别

```
var currentmonth = months.indexOf(e.parameter.list1); 
```

有人对如何获取索引有一个好主意吗？顺便说一句，这是一个在站点中而不是在电子表格中运行的谷歌应用程序脚本，如果这有所作为的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T12:49:37.643

另一个答案没有多大意义，因为 Google Apps 脚本是在 Google 的服务器上执行的，而不是在您的浏览器`indexOf()`中，并且在 GAS 中得到了很好的识别。

您应该将数组与 listBox 的元素一起使用，然后使用`listArray.indexOf(listelement);`您将获得所选项目的索引。

例子 ：

```
//in the UI construction 

var ItemlistArray = ['item1','item2','item3','item4'];// note that this variable definition could be placed outside of the function so it becomes a global variable...
for (n=0,n<ItemlistArray.length;++n){
ListBox.addItem(ItemlistArray[n]
}

//in the Handler function

var item = e.parameter.listBoxName
var ItemlistArray = ['item1','item2','item3','item4'];// if ItemlistArray is global this line can be removed
var index = ItemlistArray.indexOf(item); // if for example the selected item was 'item3', index will be 2 
```

# bash - bash 脚本变量数组名

> ID：11804087
> 
> 赞同：0
> 
> 时间：2012-08-03T22:23:16.673
> 
> 标签：bash, shell

你好我想问一个[在这里](https://stackoverflow.com/questions/8045474/bash-use-a-variable-as-an-array-name)重复的问题。

我在 bash 脚本中定义了四个服务器，如下面的代码所示。对于每台服务器，我想维护我在其上启动的进程的 ID。只是为了测试，我想用 10 20 30 40 初始化每个数组。看看我是否可以按预期访问这些元素。但是我无法访问这些元素。有人可以告诉我我到底做错了什么。

```
#!/bin/bash
SERVER_LIST=("server1" "server2" "server3")

for server in ${SERVER_LIST[@]} ; do
    echo $server
    arrayName=$server"process"
    echo $arrayName
    set -a "$arrayName=(10 20 30 40)"
done

current_sever=${SERVER_LIST[0]}
arrayName=$current_server"process"
# The attempt below is failing.
eval "echo Server ${current_server} \${$arrayName[*]}"
echo $(eval echo \${arrayName[*]})Server server1 
```

服务器1进程

它给我的输出如下 -

> 服务器 server1
> 
> 服务器1进程

有人可以帮忙吗。您还可以告诉我如何将新元素附加到数组中吗？我尝试了以下方法，但它不起作用 -

```
sleep 10 &
arrayName=$current_server"process"
eval "\${$arrayName[*]}+=$!" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T11:08:04.710

尝试替换第 8 行：

```
set -a "$arrayName=(10 20 30 40)" 
```

和：

```
eval "$arrayName=(10 20 30 40)" 
```

# php - 为什么这个 PHP spintax 代码重复相同的迭代？

> ID：11804093
> 
> 赞同：0
> 
> 时间：2012-08-03T22:24:55.577
> 
> 标签：php, spintax

[http://ronaldarichardson.com/2011/09/23/recursive-php-spintax-class-3-0/](http://ronaldarichardson.com/2011/09/23/recursive-php-spintax-class-3-0/)

我喜欢这个脚本，但它并不完美。如果您使用此测试输入用例：

> {这是我的 {spintax|spuntext} 格式化字符串，我的 {spintax|spuntext} 格式化字符串，我的 {spintax|spuntext} 格式化字符串示例。}

您可以看到结果总是包含 3 次重复的“spintax”或“spuntext”。例如，它从不包含 1 个“spintax”和 2 个“spuntext”。

例子：

> 这是我的 spuntext 格式化字符串、我的 spuntext 格式化字符串、我的 spuntext 格式化字符串示例。

为了真正随机，它需要为每个 spintax {|} 块生成随机迭代，而不是对相同的块重复相同的选择，例如 {spintax|spuntext}。

如果您查看该页面上的评论 #7，fransberns 正在做某事，但是当在实时环境中使用他修改过的代码时，该脚本将在无限循环中反复运行并耗尽所有服务器内存。所以那里一定有一个错误，但我不确定它是什么。

有任何想法吗？或者有谁知道一个强大的 PHP spintax 脚本，它允许嵌套 spintax 并且是真正随机的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T14:16:49.020

请检查这个[要点](https://gist.github.com/3285710)，它正在工作（它比原始代码简单得多..）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T14:38:30.280

Spintax 类用相同的随机选择的选项替换{spintax|spuntext} 的**所有**实例的原因是因为类中的这一行：

```
 $str = str_replace($match[0], $new_str, $str); 
```

该`str_replace`函数用搜索字符串中的替换替换子字符串的**所有实例。**要仅替换**第一个**实例，按照您的需要以串行方式进行，我们需要使用`preg_replace`传递的“count”参数为 1 的函数。但是，当我查看[您指向](http://ronaldarichardson.com/2011/09/23/recursive-php-spintax-class-3-0/)Spintax 类的链接并引用帖子 #7 时我注意到他建议的对 Spintax 类的扩充中有一个错误。

*fransberns*建议更换：

```
$str = str_replace($match[0], $new_str, $str); 
```

有了这个：

```
//one match at a time
$match_0 = str_replace("|", "\|", $match[0]);
$match_0 = str_replace("{", "\{", $match_0);
$match_0 = str_replace("}", "\}", $match_0);
$reg_exp = "/".$match_0."/";
$str = preg_replace($reg_exp, $new_str, $str, 1); 
```

*fransbergs*建议的问题在于，在他的代码中，他没有正确构造函数的正则表达式`preg_replace`。他的错误来自没有正确地逃避`\`角色。他的替换代码应该是这样的：

```
//one match at a time
$match_0 = str_replace("|", "\\|", $match[0]);
$match_0 = str_replace("{", "\\{", $match_0);
$match_0 = str_replace("}", "\\}", $match_0);
$reg_exp = "/".$match_0."/";
$str = preg_replace($reg_exp, $new_str, $str, 1); 
```

*考虑利用我对fransberns*建议的 replacemnet的更正，用这个增强版本替换原始类：

```
class Spintax {

   function spin($str, $test=false)
   {
      if(!$test){
         do {
            $str = $this->regex($str);
         } while ($this->complete($str));
         return $str;
      } else {
         do {
            echo "<b>PROCESS: </b>";var_dump($str = $this->regex($str));echo "<br><br>";
         } while ($this->complete($str));
         return false;
      }
   }

   function regex($str)
   {
      preg_match("/{[^{}]+?}/", $str, $match);
      // Now spin the first captured string
      $attack = explode("|", $match[0]);
      $new_str = preg_replace("/[{}]/", "", $attack[rand(0,(count($attack)-1))]);
//      $str = str_replace($match[0], $new_str, $str); //this line was replaced
      $match_0 = str_replace("|", "\\|", $match[0]);
      $match_0 = str_replace("{", "\\{", $match_0);
      $match_0 = str_replace("}", "\\}", $match_0);
      $reg_exp = "/".$match_0."/";
      $str = preg_replace($reg_exp, $new_str, $str, 1);    
      return $str;
   }

   function complete($str)
   {
      $complete = preg_match("/{[^{}]+?}/", $str, $match);
      return $complete;
   }
} 
```

当我尝试使用*fransberns*建议的替换“原样”时，由于`\`角色转义不当，我得到了一个无限循环。我认为这就是您的记忆问题的根源。在更正*了 fransberns 的*建议替换为正确转义`\`字符后，我没有进入无限循环。

使用更正的增强尝试上面的类，看看它是否适用于您的服务器（我看不出它不应该的原因）。

# twitter - 获取 Foursquare 的推文地理位置

> ID：11804100
> 
> 赞同：2
> 
> 时间：2012-08-03T22:25:55.710
> 
> 标签：twitter, foursquare, twitter4j

提取推文中“签到”位置的经纬度字段的最简单方法是什么？通过客户端查看推文并“扩展”它们时，即使推文并不总是包含 geoLocation 属性，也会显示位置。我想达到相同的结果（是否需要 Foursquare API 帐户？）顺便说一下，我正在使用 Twitter4j。谢谢你的帮助，鲍里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T20:58:49.820

如果该信息不在 geoLocation 属性中，您将需要调用foursquare API ( [https://developer.foursquare.com](https://developer.foursquare.com) ) 来检索用户签到的地点的纬度/经度。您可能想查看过去被问到的类似问题以了解更多详细信息，例如：[如何获得在 Twitter 上发布的四方签到的位置（纬度、经度）？](https://stackoverflow.com/questions/8780866/how-can-i-get-the-position-lat-lon-of-a-foursquare-checkin-posted-on-twitter/8807791#8807791)

# javascript - 用 jquery 验证我的 ckeditor 文本区域

> ID：11804102
> 
> 赞同：0
> 
> 时间：2012-08-03T22:26:13.840
> 
> 标签：javascript, jquery, ckeditor

我有一个使用 ckeditor 的文本区域：

```
<form name="product_edit" action="products.php" method="post" id="edit_form" enctype="multipart/form-data">
<textarea name="products_description" wrap="soft" cols="75%" rows="20" id="products_description"></textarea> 
```

同样在包含 jQuery 之后，我有以下内容来验证表单：

```
$(document).ready(function() {
  $('#edit_form').submit(function() {
     if ($('#products_description').val() == '') {
        alert('Please include a product description.');
        return false;
     }
  }); // end submit()
}); // end ready() 
```

我还验证了其他几个字段，为了简洁起见，这些字段不包括在内。

我的问题是，虽然所有其他字段都可以正常工作，但文本区域有时却不行。如果我在其中输入内容，有时无法识别它并且仍然会弹出警报。然后，如果我返回并单击（我什至不必再输入任何内容）并尝试提交它就可以了。

任何猜测为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T21:30:31.917

这仍然是一个问题吗？如果没有，请发布您的解决方案。

CKEeditor 不能那样工作，你不会得到像`$('#products_description').val()`. CKEditor 不直接使用 textarea，它会生成一个 iframe 来代替它。要获取该值，请调用`CKEDITOR.instances.editor1.getData()`where editor1 在您的情况下可能是`products_description`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-13T09:32:02.083

这对我有用，而没有添加描述可以正常工作，但是如果您放置一些空间，则将其视为内容。请为您的文本区域添加必需的属性。 **请包括 jquery 验证器和 jquery 库。**

```
 $(document).ready(function() {
    $('#edit_form').validate({
        ignore: [],         
        rules: {
                    products_description: {
                            required: function() 
                            {
                                    CKEDITOR.instances.products_description.updateElement();
                            }
                        }
                    },
                    messages: {             
                    products_description: "مطلوب"
                    },
                    /* use below section if required to place the error*/
                    errorPlacement: function(error, element) 
                    {
                        if (element.attr("name") == "products_description") 
                       {
                        error.insertAfter("#cke_description");
                        } else {
                        error.insertAfter(element);
                        }
                    }
                });
    }); 
```

# android - eclipse中的“意图无法解析为类型”错误

> ID：11804112
> 
> 赞同：6
> 
> 时间：2012-08-03T22:26:51.560
> 
> 标签：android, eclipse, apk, adt

我正在编写 eclipse 中的第一个[android 教程](http://developer.android.com/training/basics/firstapp/starting-activity.html "安卓教程")，并且在编译此代码时：

```
Intent intent = getIntent(); 
```

它给出了错误

> Intent 无法解析为类型

我如何解决它？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-03T22:29:25.763

很可能，该`import`声明丢失了。尝试按`Ctrl`++ ，如果缺少导入语句，Eclipse 会自动添加`Shift`。`O`

然后查看文件顶部，看看添加了什么。它应该是这样的：

```
import android.content.Intent; 
```

# google-apps-script - 将工作表重命名为单元格值保持格式

> ID：11804116
> 
> 赞同：1
> 
> 时间：2012-08-03T22:27:37.520
> 
> 标签：google-apps-script, google-sheets

下面的代码有效。它会将我的工作表重命名为单元格的值。但在新项目的情况下，例如，单元格的值恰好是 2012 年 8 月 4 日的日期。如果我运行以下代码，工作表将重命名为“Sat Aug 04 2012 02:00:00 GMT-0500 (CDT)”。

如何调整以下代码，使工作表的名称仅反映“2012 年 8 月 4 日”

```
 // The code below will rename the active sheet to last production week's date
var myValue = SpreadsheetApp.getActiveSheet( ).getRange("P1").getValue();
SpreadsheetApp.getActiveSpreadsheet().renameActiveSheet(myValue); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:44:13.760

您应该使用[Utilities.formatDate()](https://developers.google.com/apps-script/class_utilities?hl=fr-FR#formatDate)来获取您想要的格式。

在你的代码中应该是

```
SpreadsheetApp.getActiveSpreadsheet().renameActiveSheet(Utilities.formatDate(myValue, "GMT", "MM/dd/yyyy")); 
```

如果您不在格林威治标准时间，请不要忘记更改它，因为即使您不使用小时数，有时也会弄乱您的日期；-)

# .net - SpecFlow - 没有为一个或多个步骤找到匹配的步骤定义

> ID：11804117
> 
> 赞同：3
> 
> 时间：2012-08-03T22:27:42.153
> 
> 标签：.net, bdd, specflow

SpecFlow 的新手

如果我设置了我的 Given、When 和 Then 场景并且不传递参数，那么一切正常：

给定登录到 WebQA

```
 [Given(@"Login to WebQA")]
    public void LoginToWebQA()
    { 
```

网上的所有阅读都表明我所要做的就是更改属性以包含正则表达式并将参数添加到方法中，如下所示：

```
 [Given(@"Login to '(.*)'")]
    public void LoginTo(string url)
    {enter code here 
```

但是当我这样做时，重新编译并运行测试，我得到以下错误：

```
No matching step definition found for one or more steps. 
```

[绑定] public class StepDefinitions { [Given(@"Login to WebQA")] public void GivenLoginToWebQA()

提前致谢

乔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T23:55:02.610

尝试不使用单引号：

```
 [Given(@"Login to (.*)")]
    public void LoginTo(string url)
    {enter code here 
```

这是我使用的随机代码示例：

鉴于某某

当某某

那么结果描述应该是[测试描述]

```
[Binding]
public class AssertionSteps
{
    [Then(@"result description should be (.*)")]
    public void ThenResultDescriptionShouldBe(string hitDescription)
    {
        //here I also clean up the param value to remove []
    }   
} 
```

# node.js - Node.js OAuth2：获取 Google+ 活动

> ID：11804121
> 
> 赞同：1
> 
> 时间：2012-08-03T22:28:21.077
> 
> 标签：node.js, oauth-2.0, google-plus

从今天开始，我无法通过向该网址发出 GET 请求来检索我的 Google+ 活动：

```
https://www.googleapis.com/plus/v1/people/me/activities/public?key={API_KEY} 
```

我收到 401 错误。所以我尝试使用 node.js oauth2 库对请求进行签名，包括预先生成的用户令牌，但我得到了同样的错误。我的测试脚本的js代码是：

```
var OAuth2 = require('oauth').OAuth2,
    GOOGLEPLUS_APP_ID = {APP_ID},
    GOOGLEPLUS_APP_SECRET = {APP_SECRET},
    accessToken = {USER_TOKEN};

var _oauth2 = new OAuth2(GOOGLEPLUS_APP_ID, GOOGLEPLUS_APP_SECRET, '',
'https://accounts.google.com/o/oauth2/auth',
'https://accounts.google.com/o/oauth2/token');

_oauth2.get('https://www.googleapis.com/plus/v1/people/me/activities/public?key={API_KEY}',
accessToken, function (err, body, res) {
    if (err) {
        console.log('error:');
        console.log(err);
    }
    else console.log(body);
}); 
```

我提出了相同的请求以获取基本用户信息（网址：[https](https://www.googleapis.com/oauth2/v1/userinfo) ://www.googleapis.com/oauth2/v1/userinfo ）并且工作正常。

你能帮我解决这个问题吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:16:03.500

如果您已经拥有访问令牌，您应该能够使用它`{?|&}access_token=X`来获取结果，例如下面的示例。

```
var accessToken = 'XYZ';
require('http').get('https://www.googleapis.com/plus/v1/people/me/activities/public?access_token=' + accessToken, function(result){
    //Use result here!
}); 
```

可以在[Google+ API（通用参数）](https://developers.google.com/+/api/#common-parameters)部分找到更多信息

# github - 你如何 rebase 一个 GitHub 分支？

> ID：11804126
> 
> 赞同：3
> 
> 时间：2012-08-03T22:28:38.870
> 
> 标签：github

GitHub 上有一个我已经 fork 的项目。我的工作流程包括将我的 fork 克隆到我的本地机器上。

有时我会将更改提交到本地分支。最终我将这些更改推送到我在 GitHub 上的 fork 中。我这样做是为了在工作中处理我的项目，推送我的更改，然后回家，从我的 fork 中提取最新的并继续工作。

此时，在我的分支上，我有几个提交。我想将我的更改链接到某些人以进行代码审查，但是当我查看单个提交时，它的差异仅与我之前的提交进行比较。我不希望我的同行不得不筛选我所有的提交，试图了解从一开始发生了什么变化。

是否可以准确指定您要针对的提交？就我而言，我想将我的最新提交与源分支中的最新提交进行比较。

如果没有，有没有办法在 GitHub 上重新设置一个分支，以便它将我选择的提交合并到一个提交中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T22:47:21.810

在大多数基于 git 的代码审查中，通常的做法是对每个提交和评论分别进行审查和审查。这通常有助于在提交大小、范围和可测试性方面实施良好的编码实践。

在命令行中，几乎所有命令都支持修订间隔作为参数

*   `git diff <some commit>..<some other commit>`

*   `git log <some commit>..<some other commit>`

这将为您提供仅在该范围内的更改结果

之间也有区别

`git diff <some commit>..<some other commit>` 和 `git diff <some commit>...<some other commit>`

因为第三个点表示包容性，也显示默认为 HEAD 的结果

在 github 网络客户端中，我认为你不能这样做，我只是检查了他们的本地客户端，这也是不行的。

我只是查看了 Atlassian/bitbucket 的[SourceTree](http://www.atlassian.com/software/sourcetree/overview)，它允许您按预期选择一系列提交

# performance - 如何防止 HTML5 音频在加载时预下载/流式传输？

> ID：11804129
> 
> 赞同：15
> 
> 时间：2012-08-03T22:28:42.870
> 
> 标签：performance, html, audio, audio-streaming

我有一个单页网站，其中列出了 HTML5 音频播放器的集合。问题是网站变慢了，因为以下浏览器开始预下载内容（mp3 和 ogg）

```
Internet Explorer
Google Chrome
Firefox
Safari
(probably Opera) 
```

我使用基本代码来实现播放器。有没有办法可以阻止浏览器预下载音频文件，并且仅在它们单击播放时才起作用？

```
<audio controls="controls" height="32" width="300" tabindex="0">
<source type="audio/mpeg" src="http://cdn.com/track.mp3"></source>
<source type="audio/ogg" src="http://cdn.com/track.ogg"></source>
</audio> 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-03T22:46:06.130

```
<audio controls="controls" preload="none">
  <source src="song.ogg" type="audio/ogg" />
  <source src="song.mp3" type="audio/mpeg" />
  Your browser does not support the audio element.
</audio> 
```

注意 - `preload="none"`- 可以与 VIDEO HTML5 和 AUDIO HTML5 一起使用。

除了 Internet Explorer 和 Opera，所有主流浏览器都支持 preload 属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-04T09:25:11.087

MSIE 仍占所有 Web 流量的 30% 左右，因此`preload="none"`只是部分解决方案。在我遇到此问题的几页中，我在页眉中添加了一个小脚本：

```
<script type="text/javascript">
function addAudio(t) {
  var l=t.innerHTML.length;
  var audioName=t.parentElement.id;
  if( t.children.length==0) {
    t.innerHTML=t.innerHTML+'&nbsp; &nbsp; <audio controls="controls"><source src="'+
      audioName+'.ogg" type="audio/ogg" /><source src="'+
      audioName+'.mp3" type="audio/mp3" /> No audio tag support</audio>';
  }
}
</script> 
```

然后使用 DHMTL 动态添加音频标签，例如：

```
<li id="2_Lesson_1_Hello"><span onclick="addAudio(this)">Γεια σας</span></li> 
```

它的作用是定义一个包含文本跨度的列表项。当浏览者点击跨区文本时，javascript 会触发并附加`<audio>`标签。您也可以使用该`onmouseover`属性，以便在悬停时添加音频标签。

`preload`如果您愿意，可以将该属性添加到生成的代码中。这是一种简单的方法，但如果您已经在网页上使用**jQuery**，我注意到这提供了优雅的替代方案。

# c# - 异步 TCP 套接字字节合并

> ID：11804131
> 
> 赞同：1
> 
> 时间：2012-08-03T22:28:45.843
> 
> 标签：c#, .net

我不太确定如何在标题中解释我的问题，但我会尝试详细说明我的问题。

基本上我正在编写一个不是 P2P 的聊天，但所有用户都连接到中央服务器，类似于 IRC。连接是异步的，几乎可以完美运行。主要问题是，当一次将大量数据发送给一个用户（或从一个用户发送到服务器）时，字节可能会合并，从而导致错误。我通过在其余数据前面添加一个包含数据长度的 4 字节标头来解决此问题。不过，字节似乎合并了。我也尝试将**NoDelay**设置为**true**并将**DontFragment**设置为**false**；仍然，它不起作用。

我猜问题是当字节合并时，我只处理第一个字节，然后对剩余的字节不做任何事情。解决这个问题的最佳方法是什么？

接收回调码： http: [//pastebin.com/f0MvjHag](http://pastebin.com/f0MvjHag)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T22:52:23.697

这就是为什么他们称之为流。您将字节放入一端，TCP 保证它们在远端以相同的顺序输出，不会丢失或重复。任何大于一个字节的东西都是你的问题。

您必须在缓冲区中累积足够的字节才能拥有您的标头。然后解释它并开始处理额外的字节。您可能还剩下一些可以开始下一个标题。

这是正常行为。当您的应用程序未接收数据时，系统将为您缓冲它。下次您提出请求时，它将尝试传递可用数据。另一方面，大型写入可能会通过不支持足够帧大小的连接。它们将根据需要进行拆分，并最终以点点滴滴的形式到达。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T22:56:29.980

这通常发生在两个或多个数据包以接近的间隔发送时。我最近自己也遇到了这个问题，我解决它的方法是使用分离键。然后，您可以标记每条消息。例如，您可以像我一样将 ASCII 字符 #4（传输结束字符）添加到正在发送的每条消息的末尾。

```
Write("Message1" + ((char)4).ToString())
Write("Message2" + ((char)4).ToString()) 
```

然后，当客户端接收到数据时，就可以对接收到的数据进行迭代。当它找到那个特殊字符时，它就知道这是一条消息的结尾，并且（也许）是一条新消息的开始。

```
"Message1(EOT char)Message2(EOT char)" 
```

`\n`可能比使用 ASCII 字符更容易使用。

# java - 可以从几层面板和表单中获取所有表单输入

> ID：11804132
> 
> 赞同：0
> 
> 时间：2012-08-03T22:28:52.270
> 
> 标签：java, wicket

对wicket来说有点新，我想知道是否可以使用AjaxButton来从第一个表单中的表单中获取表单值......

例如，使用下面的“ajaxButton”是否也可以获得“anothervalue”的值，即使它的形式不同？

```
<form>
  <input type="submit" wicket:id="ajaxButton" />
  <input type="text" wicket:id="aValue" />
  <panel>
      <form>
        <input type="text" wicket:id="anothervalue" />
      </form>
  </panel>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T13:44:09.417

Wicket 支持嵌套表单。当您提交外部表单时，内部表单也应该被处理（验证参数，更新模型）。

# active-directory - Jenkins + Active Directory 身份验证 - 登录缓慢

> ID：11804133
> 
> 赞同：8
> 
> 时间：2012-08-03T22:29:01.840
> 
> 标签：active-directory, jenkins, jenkins-plugins

我有一个在 Windows 2008 SP2 上运行的 Jenkins 主服务器，设置了 Active Directory 身份验证。身份验证工作正常，通常登录没有问题。然而，Jenkins 偶尔会花费 4 到 5 分钟来登录用户。这似乎与用户处于非活动状态的时间量相关（即 2 或 3 周未登录的用户在尝试时会遇到极慢的响应登录）。

有没有其他人经历过这种行为？我真的不确定是否应该开始查看活动目录或 Jenkins 来解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-10T06:20:29.223

插件维护者积极建议[启用日志记录](https://wiki.jenkins-ci.org/display/JENKINS/Active+Directory+plugin)（使用“hudson.plugins.active_directory”到 ALL）并在出现问题时提交错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-22T14:30:14.007

Jenkins 使用 Active Directory 缓慢登录几乎总是与 DNS 问题有关。检查您的 dns 服务 (srv)、NS、DomainDnsZones、_ldap.tcp.domaine.com、_gc._tcp.domaine.com 和来自 AD/DNS 服务器的 ForestDnsZone 响应。如果您无法访问列出的所有 ip/端口，当 jenkins AD 插件尝试查询这些服务器/服务时，您将面临一些随机缓慢的登录（30 或 60 秒，取决于查询）。

您可以在 jenkin 的服务器或 DNS 服务器上使用 tcpdump 或 wireshark 轻松捕获 dns 查询。

tcpdump -i 接口端口 53

指定站点可以帮助您制定一个可行的解决方法，因为这将在查询 ForestDnsZone 的不存在/无法访问的 ip/端口返回时将缓慢的登录限制为只有糟糕的结果。

# javascript - YUI Image Rotator / YUI3-Slideshow Link 问题

> ID：11804139
> 
> 赞同：0
> 
> 时间：2012-08-03T22:29:59.750
> 
> 标签：javascript, yui, slideshow, yui3

首先，我不能使用 jQuery。不要这样建议！

我在使用 YUI 标准图像幻灯片时遇到问题。我可以让它在没有链接的情况下完美地工作，但没有链接。我需要将其用作广告横幅平台，并且没有链接真的会使它变得无用。

没有链接：http: [//jsfiddle.net/ndreckshage/U6q2K/](http://jsfiddle.net/ndreckshage/U6q2K/)

带有链接（它会以红色开始！褪色！但后来又变成红色......）：http: [//jsfiddle.net/ndreckshage/ef2QV/](http://jsfiddle.net/ndreckshage/ef2QV/)

由于某种原因，这里没有锚标签？为什么会这样断？这对我来说真的没有意义。

我是 YUI 的新手——如果这只是一个无法修复的错误，我将如何在这里伪造链接——添加一个适用于不同图像的 onclick 类？

谢谢你的帮助 -

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:09:22.957

好的——当我在 SO 上发帖时，这似乎总是发生在我身上。我挣扎了3个小时，然后我发帖并弄清楚了。

所以所有的风格都是完全不必要的，并通过 YUI 管理——哎呀

```
style="visibility: hidden; z-index: -30000; opacity: 0; 
```

这现在适用于链接！-- [http://jsfiddle.net/ndreckshage/bn3TL/](http://jsfiddle.net/ndreckshage/bn3TL/)

# android - Android的textview的定位

> ID：11804143
> 
> 赞同：1
> 
> 时间：2012-08-03T22:30:37.290
> 
> 标签：android

有没有办法将 textview 定位在居中的 android 按钮上方？我显然不想硬编码特定屏幕的值，而是会动态缩放的东西。该按钮将始终居中，但是...

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T22:39:46.370

是的，如果您的父布局是[RelativeLayout](http://developer.android.com/reference/android/widget/RelativeLayout.html)，您可以将视图相对于彼此或与父级进行定位，这是一个简单的示例（警告没有将其输入 IDE，可能包含错字）：

```
<RelativeLayout
android:layout_width="fill_parent"
android:layout_height="fill_parent">

<Button
android:id="@+id/mBtn"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="I am a Button!"
android:layout_centerInParent="true" />

<TextView
android:id="@+id/mTxt"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_centerHorizontal="true"
android:text"Some Text"
android:layout_above="@+id/mBtn" />

</RelativeLayout> 
```

这将使您的布局大致如下所示：

```
________________________
|                      |
|                      |
|      Some Text       |
|   [I am a Button!]   |
|                      |
|                      |
|______________________| 
```

# ruby - 元素属于与当前框架不同的框架 - 切换到其包含框架以使用它

> ID：11804146
> 
> 赞同：1
> 
> 时间：2012-08-03T22:31:10.817
> 
> 标签：ruby, capybara

我对 Capybara 中的框架有疑问。我切换到一帧并单击足球，然后单击该类别的所有链接，但仅单击了 2 个链接，然后出现该错误并显示该元素不在当前帧上的消息。

```
require 'rubygems'
require 'capybara'
require 'capybara/dsl'

Capybara.run_server = false
Capybara.current_driver = :selenium
Capybara.default_wait_time = 5
Capybara.app_host = 'http://sports.sbobet.com'

module MyCapybaraTest
  class Test
    include Capybara::DSL
    def test
      visit('/')
      page.driver.browser.switch_to.frame 'leftFrame'

      wait_until {page.find('table span.SportName').visible?}
      page.all('table span.SportName').each do |span|
        if (span.text == 'Football')
          span.click
          page.all('div#MarketTbl span.LMenuLeft a').each do |a|
            puts a[:href]
            a.click
            sleep 3
          end
        end
      end

    end
  end
end

t = MyCapybaraTest::Test.new
t.test 
```

详细错误为： [https ://gist.github.com/3252149](https://gist.github.com/3252149)

我不知道出了什么问题，因为如果我删除`sleep 3`它，它就会正常运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T13:09:12.013

这`Selenium::WebDriver::Error::StaleElementReferenceError`意味着当前页面上有一个 DOM 元素与用于查找您正在调用方法的 Selenium 元素对象的选择器匹配，但它不是同一个 DOM 元素。

在您的情况下，您似乎正在与一组页面共有的一些导航链接进行交互。例如，如果`page.all('div#MarketTbl span.LMenuLeft a')`返回 3 个链接，并且这 3 个链接存在于每个链接到达的所有页面上，如果您没有`sleep`在循环中，则前两个链接可能在页面实际更改之前被点击。

在`sleep`循环中，当`a.click`调用第二个时，`a`在第一页上找到了对象，但它所代表的链接现在是一个不同的物理 DOM 节点，因为第二页已经有时间加载。

我会尝试取出循环并单独查找并单击每个链接。

另请注意，`#all`它不使用 Capybara 的`wait_until`功能，因此它可能会在缓慢的应用程序中表现得不直观。

# python - 解析 HTML 以获取元素内的文本

> ID：11804148
> 
> 赞同：31
> 
> 时间：2012-08-03T22:31:15.090
> 
> 标签：python, html, python-2.x, html-parser

我需要将两个元素内的文本转换成一个字符串：

```
source_code = """<span class="UserName"><a href="#">Martin Elias</a></span>"""

>>> text
'Martin Elias' 
```

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-03T23:37:35.820

我搜索了“python parse html”，这是第一个结果： [https ://docs.python.org/2/library/htmlparser.html](https://docs.python.org/2/library/htmlparser.html)

此代码取自 python 文档

```
from HTMLParser import HTMLParser

    # create a subclass and override the handler methods
    class MyHTMLParser(HTMLParser):
        def handle_starttag(self, tag, attrs):
            print "Encountered a start tag:", tag
        def handle_endtag(self, tag):
            print "Encountered an end tag :", tag
        def handle_data(self, data):
            print "Encountered some data  :", data

    # instantiate the parser and fed it some HTML
    parser = MyHTMLParser()
    parser.feed('<html><head><title>Test</title></head>'
                '<body><h1>Parse me!</h1></body></html>') 
```

结果如下：

```
Encountered a start tag: html
Encountered a start tag: head
Encountered a start tag: title
Encountered some data  : Test
Encountered an end tag : title
Encountered an end tag : head
Encountered a start tag: body
Encountered a start tag: h1
Encountered some data  : Parse me!
Encountered an end tag : h1
Encountered an end tag : body
Encountered an end tag : html 
```

使用它并通过查看 HTMLParser 中的代码，我想出了这个：

```
class myhtmlparser(HTMLParser):
    def __init__(self):
        self.reset()
        self.NEWTAGS = []
        self.NEWATTRS = []
        self.HTMLDATA = []
    def handle_starttag(self, tag, attrs):
        self.NEWTAGS.append(tag)
        self.NEWATTRS.append(attrs)
    def handle_data(self, data):
        self.HTMLDATA.append(data)
    def clean(self):
        self.NEWTAGS = []
        self.NEWATTRS = []
        self.HTMLDATA = [] 
```

你可以像这样使用它：

```
from HTMLParser import HTMLParser

pstring = source_code = """<span class="UserName"><a href="#">Martin Elias</a></span>"""

class myhtmlparser(HTMLParser):
    def __init__(self):
        self.reset()
        self.NEWTAGS = []
        self.NEWATTRS = []
        self.HTMLDATA = []
    def handle_starttag(self, tag, attrs):
        self.NEWTAGS.append(tag)
        self.NEWATTRS.append(attrs)
    def handle_data(self, data):
        self.HTMLDATA.append(data)
    def clean(self):
        self.NEWTAGS = []
        self.NEWATTRS = []
        self.HTMLDATA = []

parser = myhtmlparser()
parser.feed(pstring)

# Extract data from parser
tags  = parser.NEWTAGS
attrs = parser.NEWATTRS
data  = parser.HTMLDATA

# Clean the parser
parser.clean()

# Print out our data
print tags
print attrs
print data 
```

现在您应该能够轻松地从这些列表中提取数据。我希望这有帮助！

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-08-03T23:46:52.810

我推荐使用 Python [Beautiful Soup 4](http://www.crummy.com/software/BeautifulSoup/)库。

```
pip install beautifulsoup4 
```

它使 HTML 解析变得非常容易。

```
from bs4 import BeautifulSoup
source_code = """<span class="UserName"><a href="#">Martin Elias</a></span>"""
soup = BeautifulSoup(source_code)
print soup.a.string
>>> 'Martin Elias' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-04T09:26:12.883

安装beautifulsoup，你可以这样做：

```
from BeautifulSoup import  BeautifulSoup
source_code = '"""<span class="UserName"><a href="#">Martin Elias</a></span>"""'
soup = BeautifulSoup(source_code)
print soup.find('span',{'class':'UserName'}).text 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-04T09:22:29.037

您也可以尝试使用 html5lib 和 XPath，[这里有一个很好的问题](https://stackoverflow.com/a/5073316/1514681)，该答案有一个重要的细节 ( `namespaceHTMLElements`) 需要记住，以使 html5lib 按预期运行。我浪费了很多时间试图让它工作，因为我忽略了我需要改变它。

# objective-c - 在 XCode 4.3 中向项目添加外部库

> ID：11804149
> 
> 赞同：3
> 
> 时间：2012-08-03T22:31:18.943
> 
> 标签：objective-c, ios5, xcode4.2

新手在这里，试图将 CHDataStructures 库添加到我正在处理的计算器项目中。我按照[在 XCode 4 中将静态库链接到 iOS 项目中](https://stackoverflow.com/questions/6124523/linking-a-static-library-to-an-ios-project-in-xcode-4)接受的答案中的建议做了，并最终得到了这个：

![添加了库的 XCode](../Images/465032234b8533bd50cc1bddb69be1fe.png)

不幸的是，`'CHDataStructures.h' file not found`当我尝试将标头添加到项目中的类时出现错误（`Calculator.m`例如）。

关于如何让 CHDataStructures 库像死星一样全面运行有什么想法吗？

**编辑**

好的，这里尝试两者`$(SRCROOT)`和绝对路径。有什么想法吗？

![与`$（SRCROOT）](../Images/e5386927ddae00c8e21e50e5f1802ddf.png)

![带绝对路径](../Images/c0be8d13be593f0009853a81d873c2ad.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-03T22:59:00.170

默认情况下，Xcode 在项目自己的目录中递归搜索头文件。如果您使用的是静态库，则需要使用可能位于其他位置的 lib 头文件。Xcode 项目中有 2 个设置允许您在编译期间指定要搜索的其他路径：

**用户标题搜索路径**

```
#import "SomeHeader.h" 
```

**标头搜索路径**

```
#import <SomeHeader.h> 
```

根据您打算使用的样式，选择适当的设置，并提供您希望使用的头文件的路径：

![在此处输入图像描述](../Images/3e7c16deda9200673f77e1e5015e2a5b.png)

路径可以是递归的、相对于项目的（使用`$(SRCROOT)/`）或绝对的。如果您正确设置了 Xcode，您也可以使用派生数据目录。

# html - 顺序 中的标签 破坏浏览器兼容性

> ID：11804153
> 
> 赞同：0
> 
> 时间：2012-08-03T22:32:09.277
> 
> 标签：html, audio

我的页面上有以下音频标签，并使用 FFmpeg 创建了正确的 MP3 和 Ogg Vorbis 音频文件，以便我可以根据需要访问尽可能多的现代浏览器。但是，如果我没有将 MP3 文件首先放在列表中，则音频将无法在 Safari 中运行。Chrome 和 Firefox 的 Ogg 文件也是如此。我应该以不同的方式订购或识别它们吗？

```
<audio controls="controls">
<source src="/plus/content/2012/08/025_conventions/abbotts.mp3" type="audio/mp3">
<source src="/plus/content/2012/08/025_conventions/abbotts.ogg"  type="audio/ogg">
</audio> 
```

到目前为止，我已经尝试将音频标签用作控件或控件 =“控件”，没有任何变化。我还尝试了使用和不使用每个音频标签的“类型”属性。

我错过了什么？

最好的，

史蒂文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:00:12.390

该页面似乎已缓存在 Chrome 中，所以我被误导了。一切都很好。请忽略。

# css - -ms-grid-row-align 属性中可能存在的错误

> ID：11804157
> 
> 赞同：0
> 
> 时间：2012-08-03T22:32:22.533
> 
> 标签：css, windows-8, microsoft-metro, winjs

我有以下代码，其中图像高于 44px：

```
<div style="width:300px;display:-ms-grid;-ms-grid-rows:44px 44px">
    <div style="-ms-grid-row:1; -ms-grid-column:1;/*-ms-grid-row-align: start;*/">
        <img style="max-width:100%;max-height:100%" src="/picture000.png"/> </div>
    <div style="-ms-grid-row:2; -ms-grid-column:1">hola mundo</div>
</div> 
```

这显示图像重新调整为 div 的大小，保持其外观（我期望的），但是，如果您取消注释该`ms-grid-row-align`属性并将其值设置为`start`（根据[http://msdn.microsoft.com/en-us的默认值/library/windows/apps/xaml/hh466348.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh466348.aspx)）图像显示为全尺寸。

这是一个错误还是我应该将该属性与另一个我不知道的属性一起使用？

[ps：我在MSDN Metro Style 应用程序](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/d384a5e2-5aa4-4175-a6af-476fe3f650c0)上问了同样的问题，但完全没有答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:16:22.070

首先：初始值是“stretch”而不是“start”；这是一个文档错误。将其设置为“开始”实际上是更改“拉伸”的值。

这实际上不是一个错误。您看到的行为是因为在确定图像的基于百分比的最大高度时，尚未定义父级（网格项）的高度。结果是它被视为“最大高度：自动”，这导致了大图像。

这也解释了为什么当网格项的 -ms-grid-row-align 值设置为“拉伸”时，您会得到较小的图像。当设置为“stretch”时，网格项的高度设置为行的高度（在这种情况下为 44px），并且可以根据该值解析图像的基于百分比的最大高度。

您可以在不使用 Grid 的情况下看到相同的行为：

```
<div style="max-height:100px;"><img id="img" style="max-height:100%" src="/picture000.png"/></div> 
```

虽然您的描述没有完全解释您为什么要尝试这样做，但您可能需要考虑将图像本身设为网格项，这将允许其最大高度百分比值针对网格行本身进行解析。请注意，您还需要添加“-ms-grid-column-align: start”以确保它不会拉伸并变得不成比例：

```
<div style="width:300px;display:-ms-grid;-ms-grid-rows:44px 44px">
    <img style="max-width:100%;max-height:100%;-ms-grid-row:1;-ms-grid-column:1;-ms-grid-row-align: start;-ms-grid-column-align: start;" src="/picture000.png"/>
    <div style="-ms-grid-row:2; -ms-grid-column:1">hola mundo</div>
</div> 
```

披露：我在从事 Microsoft 实施 CSS 网格的团队中。

# mysql - MySQL 查询以平均组中的不同项目

> ID：11804160
> 
> 赞同：0
> 
> 时间：2012-08-03T22:32:30.370
> 
> 标签：mysql

表 >>> 销售额

```
state | date | item | px

101   1/1/2012   tennis   2
101   1/1/2012   soccer   10
101   1/1/2012   crystal  100
101   1/1/2012   soccer   10

102   1/1/2012   crystal  100
102   1/1/2012   tennis   2
102   1/2/2012   tennis   2

103   1/2/2012   tennis   2
103   1/2/2012   crystal  100
103   1/3/2012   soccer   10
103   1/3/2012   crystal  100

$query="SELECT state, MAX(date), COUNT(state), AVG(px) FROM sales GROUP BY state ORDER by state ASC"; 
```

...产生：

```
state | date | item count | avg px

101   1/1/2012   4   30.5
102   1/2/2012   3   34.67
103   1/3/2012   4   53 
```

问题：如何修改查询以生成每个状态中 DISTINCT 项的平均 px？（而不是每个状态所有项目的平均 px）

例如，状态 101 的平均值应该/将是 (2+10+100)/3 = 37.33；即 1 个网球、1 个足球和 1 个水晶的平均像素。

12 年 8 月 4 日编辑 >>> 将第二个表中的 px 列标题更改为 avg px。/ 为清楚起见进行了编辑。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T22:41:39.633

试试这个。

编辑：根据项目和状态添加了一个内部查询来区分。

```
SELECT
    state,
    CONVERT(DATETIME, AVG(AverageDate)) AS AverageDate,
    SUM(ItemCount) AS [item count],
    AVG(px) AS px
FROM
(
    SELECT
        state,
        item,
        COUNT(*) AS ItemCount,
        AVG(CAST(date AS INT)) AS AverageDate,
        AVG(px) AS px
    FROM sales
    GROUP BY
        state,
        item
)
GROUP BY state; 
```

# jquery - Jquery ajax 根据从数据库检索的数据选择单选、复选框和下拉菜单？

> ID：11804161
> 
> 赞同：1
> 
> 时间：2012-08-03T22:32:41.883
> 
> 标签：jquery

我正在尝试根据从数据库中检索到的数据来选择 Radio、复选框和下拉菜单。到目前为止，我只尝试了单选按钮，但没有成功，这就是我所拥有的。

**edit_cc_form.php**

```
<?php

include("../MySqlConnection.php"); 

        if(isset($_GET['edit']))

        {

            $id = $_GET['edit'];

            $query = "SELECT DesiredEffectiveDate,
                             NameofAssociation,
                             DBA,
                             TaxID,
                             StreetAddress,
                             City,
                             State,
                             Zip,   
                             AssociationContactName,    
                             Telephone,     
                             Email,     
                             CurrentEligibleMembers,    
                             PaymentMethods,    
                             LifeLockBasic,     
                             LifeLockCommandCenter,     
                             LifeLockUltimate,  
                             EsignatureTitle, 
                             Esignature,    
                             DateSigned,    
                             WritingProducer,   
                             WritingProducerCode 
                             FROM Association_Enrollment WHERE id = '$id'";

            $result = mysql_query($query);

            $row = mysql_fetch_row($result);  

            $DesiredEffectiveDate = $row[0];

            $NameofAssociation = $row[1];

            $DBA = $row[2];

            $TaxID = $row[3];

            $StreetAddress = $row[4];

            $City = $row[5];

            $State = $row[6];

            $Zip = $row[7];

            $AssociationContactName = $row[8];

            $Telephone = $row[9];

            $Email = $row[10];

            $CurrentEligibleMembers = $row[11];

            $PaymentMethods = $row[12];

            $LifeLockBasic = $row[13];

            $LifeLockCommandCenter = $row[14];

            $LifeLockUltimate = $row[15];

            $EsignatureTitle = $row[16];

            $Esignature = $row[17];

            $DateSigned = $row[18];

            $WritingProducer = $row[19];

            $WritingProducerCode = $row[20];

            $full = $DesiredEffectiveDate.":".$NameofAssociation.":".$DBA.":".$TaxID.":".$StreetAddress.":".$City.":".$State.":".$Zip.":".$AssociationContactName.":".$Telephone.":".$Email.":".$CurrentEligibleMembers.":".$PaymentMethods.":".$LifeLockBasic.":".$LifeLockCommandCenter.":".$LifeLockUltimate.":".$EsignatureTitle.":".$Esignature.":".$DateSigned.":".$WritingProducer.":".$WritingProducerCode.":".$id;

            echo $full;

        } 
```

?>

**Jquery Ajax 处理返回的数据**

```
 $('a.edit_cc_form').click(function(){

                                $.ajax({

                                    type: 'get',

                                    url: 'cc_form/edit_cc_form.php',

                                    data: 'ajax=1&edit=' + $(this).attr('id'),

                                    success: function(data){

                                            var temp = data.split(':');

                                             $('#DesiredEffectiveDate').val(temp[0]);

                                             $('#NameofAssociation').val(temp[1]);

                                             $('#DBA').val(temp[2]);

                                             $('#TaxID').val(temp[3]);

                                             $('#StreetAddress').val(temp[4]);

                                             $('#City').val(temp[5]);

                                             $('#State').val(temp[6]);

                                             $('#Zip').val(temp[7]);

                                             $('#AssociationContactName').val(temp[8]);

                                             $('#Telephone').val(temp[9]);

                                             $('#Email').val(temp[10]);

                                             $('#CurrentEligibleMembers').val(temp[11]);

                                             if(temp[12] == 'Deduction handled by Association')
                                                {

                                                    $("input[name='PaymentMethods1']:checked").val();

                                                }

                                            if(temp[12] == 'Direct Bill Members with Credit Card')
                                                {

                                                    $("input[name='PaymentMethods2']:checked").val();

                                                }

                                             $('#LifeLockBasic').val(temp[13]);

                                             $('#LifeLockCommandCenter').val(temp[14]);

                                             $('#LifeLockUltimate').val(temp[15]);

                                             $('#EsignatureTitle').val(temp[16]);

                                             $('#Esignature').val(temp[17]);

                                             $('#DateSigned').val(temp[18]);

                                             $('#WritingProducer').val(temp[19]);

                                             $('#WritingProducerCode').val(temp[20]);

                                             $('#update_cc').val(temp[21]);

                                    }

                                });

                    $("#cc_form").show();

                    $("#user_list_cc").hide();  

        }); // edit CC forms end 
```

在解析返回的结果后，我试图根据存储在 temp[12] 上的数据来选择表单的一部分。关于如何做到这一点的任何想法，任何帮助都非常感谢。

```
<td class="section-sub-head">
                                                    <label>Payment Methods:</label>
                                                    <br /><br />

                                                    <input type="radio" name="PaymentMethods1" id="PaymentMethods"  value="Deduction handled by Association" style="width:20px !important;" class="required"/> Deduction handled by Association

                                     <br /> <br />      
                                                <input type="radio" name="PaymentMethods2" id="PaymentMethods"  value="Direct Bill Members with Credit Card"  style="width:20px !important;" class="required" /> Direct Bill Members with Credit Card      
                                                     <br />
                                                        <label for="PaymentMethods" class="error" generated="true"></label>
                                                        <br />
                                                </td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T12:15:12.080

-> 你需要列出需要检查的东西。

*   首先将警报放入您的成功函数并检查它是否成功返回了您想要的数据。

*   我检查了您的 html 格式。完全错误。Id 是唯一字段，您使用了 2 次。如果付款方式在组中，则两个单选按钮中的名称字段相同，这在您的 html 中有所不同，例如 PaymentMethods1 和 PaymentMethods2。需要纠正这一点。

*   在 jquery 中， $("input[name='PaymentMethods1']:checked").val();
    我不明白你为什么放这个。它是在获取值，而你没有使用任何变量来获取这个值。

# jquery - 如何在 Analytics 中跟踪 #ajax 链接？

> ID：11804163
> 
> 赞同：0
> 
> 时间：2012-08-03T22:32:47.737
> 
> 标签：jquery, ajax, seo, google-analytics

我有带有普通谷歌分析代码的基本单页网站：

```
 var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-##-##']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })(); 
```

然而，我的链接就像书签——它们基本上是在单页上滑动。单击时，我的链接本质上是页面，但在同一模板中-它们滑动以显示内容元素。

```
<a href="#section-3">about us</a> 
```

**有没有办法可以更新 Analytics 跟踪器或以某种方式跟踪链接？**所以在分析中，我会看到人们在一个页面上花费了很多时间等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T22:54:10.340

尝试这个。在 HEAD 中放置：

```
var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-##-##']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })(); 
```

在 FOOTER 或任何其他地方 - 这个：

```
jQuery(function($){

  $("a[href*='#']").on("click", function(){
        var $url = $(this);

        _gaq.push(['_trackEvent', 'ajaxLink', $url.text(), $url.attr('href')]);
        console.log('_trackEvent', $url.text(), $url.attr('href'));
  });
});​ 
```

并且 HTML 应该是对链接的 #Id 引用。如：

```
<a href="#home-page">Home</a>
<br />
<a href="#about-us-page">About Us</a> 
```

我用[这个](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)来学习它。

UPD：这是示例：http: [//jsfiddle.net/K2PcL/](http://jsfiddle.net/K2PcL/)

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T23:31:36.127

您应该能够将页面跟踪添加到 onclick 事件。尝试将您的链接更改为以下内容：

```
<a href="#section-3" onclick="_gaq.push(['_trackPageview', '/AboutUs']);”&gt;about us</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T22:49:24.100

你需要`push`的信息`into the gaq array`。

[您需要知道的一切都在这里找到。](https://developers.google.com/analytics/devguides/collection/gajs/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-04T00:12:34.750

为此使用 jQuery。

将分析放在您的脑海中，注意更简洁的代码：

```
<script>
    var _gaq = [['_setAccount', 'UA-XXXXX-X'], ['_trackPageview']];
    (function(d, t) {
    var g = d.createElement(t),
    s = d.getElementsByTagName(t)[0];
    g.src = '//www.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
    }(document, 'script'));
</script> 
```

现在把它放在你的页脚中，#main-navigation 是你的 UL > LI 菜单列表的一个例子。它将跟踪所有这些页面。

```
jQuery(function($){
        $("#main-navigation a[href*='#']").on("click", function(){
            var $url = $(this)
        _gaq.push(['_trackPageview', $url.attr('href')]);
        console.log('_trackPageview', $url.attr('href'));
    });
}); 
```

另请注意；我使用协议和更简洁的 JavaScript 的代码速度提高了 2000 倍。 [http://jsperf.com/protocol-check-vs-hardcoded-string](http://jsperf.com/protocol-check-vs-hardcoded-string)进一步参考[http://mathiasbynens.be/notes/async-analytics-snippet](http://mathiasbynens.be/notes/async-analytics-snippet)

# jquery - JSON 数组转换为可读值

> ID：11804167
> 
> 赞同：0
> 
> 时间：2012-08-03T22:33:16.803
> 
> 标签：jquery, ajax, json

我已经在这个网站上耕耘了很长时间，但找不到如何将这个 json 数组转换为人类可读和可用值的答案。

一个警报体面地显示了这一点：

```
{"item1":"value1","item2":"value2","item3":"value3"} 
```

我想使用这样的值：

```
succes: function(data) {
    alert(value1);
    $("#div").append(value1);
} 
```

但似乎我的 Jquery 词汇表中还没有这个。所有警报都给出未定义的值。

肯定可以在这里使用一些帮助！

**编辑：**

```
$.ajax({ 
        type: "POST", 
        url: "/include/process/xxxx.php", 
        data: dataString, 
        success: function(data) { 
           alert(data); alert(data.item1); 
        } 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T22:36:20.630

```
success: function(data) {
    alert(data.item1); // alerts "value1"
    $("#div").append(data.item1); // appends "value1"
} 
```

`item1`, 和类似`item2`的 , etc. 是键。要获取与键关联的值，您必须引用键本身，而不是值（即`value1`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T23:04:34.520

如果`alert(value1);`正在显示，`{"item1":"value1","item2":"value2","item3":"value3"}`则它不是 json 对象（否则警报会显示类似的内容`[object Object]`）。如果您正在使用[`$.ajax`](http://api.jquery.com/jQuery.ajax/)确保您设置`dataType: "json"`正确，否则请先尝试在数据上执行此操作。

```
var obj = $.parseJSON(data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T22:37:19.817

您的代码中有一个错字，`succes`应该是`success`，您可以这样读取对象的属性：

```
success: function(data) {
    alert(data.item1);
    $("#div").append(data.item1);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T22:38:08.403

尝试：

```
alert(data.item1); 
```

您当前正在使用 value1 进行警报，这在您的代码中当时没有任何意义，因此当该警报弹出时，您看不到您的预期。

# node.js - 使用 node.js 设置 SSL

> ID：11804168
> 
> 赞同：4
> 
> 时间：2012-08-03T22:33:26.267
> 
> 标签：node.js

我在 GoDaddy 购买了 SSL 证书，并使用以下 node.js 服务器尝试设置它：

```
var https = require('https'),      // module for https
    fs =    require('fs');         // required to read certs and keys

var options = {
    key: fs.readFileSync('../../ssl/example.com.key'),
    cert: fs.readFileSync('../../ssl/example.com.crt'),
    ca: fs.readFileSync('../../ssl/gd_bundle.crt'),
    requestCert:        true,
    rejectUnauthorized: false
};

https.createServer(options, function (req, res) {
    if (req.client.authorized) {
        res.writeHead(200, {"Content-Type": "application/json"});
        res.end('{"status":"approved"}');
    } else {
        res.writeHead(401, {"Content-Type": "application/json"});
        res.end('{"status":"denied"}');
    }
}).listen(443); 
```

运行服务器后，我尝试访问[https://example.com](https://example.com)的网站，我得到了

```
{"status":"denied"} 
```

我想这是正常工作，因为我得到了回应，但我认为我对 SSL 工作原理的理解是错误的。我认为浏览器从服务器获取证书，然后根据根证书（即来自 GoDaddy）对其进行身份验证。所以我不应该得到

```
{"status":"approved"} 
```

只是简单地访问[https://example.com](https://example.com)？

所以我想我的问题是，我如何访问[https://example.com](https://example.com)并获得 {"status":"approved"}？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T22:44:17.423

您被拒绝的原因是因为您正在尝试使用客户端证书身份验证进行身份验证。每个最终用户都需要一个由您的服务器证书签名的客户端证书。 [如何](http://blog.nategood.com/client-side-certificate-authentication-in-ngi)[使用 Node](http://blog.nategood.com/nodejs-ssl-client-cert-auth-api-rest)设置客户端证书和证书身份验证。

如果您只是尝试加密您的网络流量，则不需要客户端证书。如果您只想加密流量，请使用此处的示例[http://nodejs.org/docs/latest/api/https.html 。](http://nodejs.org/docs/latest/api/https.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-14T15:19:57.180

这是错误的：

```
ca: fs.readFileSync('../../ssl/gd_bundle.crt') 
```

`ca`需要是包含单个证书的字符串或缓冲区数组。如果您提供捆绑包，则仅使用第一个证书，其余的将被忽略。

另请参阅：[http ://nodejs.org/api/tls.html#tls_tls_createserver_options_secureconnectionlistener](http://nodejs.org/api/tls.html#tls_tls_createserver_options_secureconnectionlistener)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-10T03:21:35.940

1.) 首先打开您的 cpanel 2.) SSL/TLS 3.) 管理 SSL 站点。4.) 选择要添加 ssl 的域 5.) 然后按证书自动填充

你会在这里 crt 和 key 创建 2 个文件 domain.pem 和 domain.crt

将 crt 代码放入 domain.crt 并将关键代码放入 domain.pem 文件中，并将两个文件放在主根目录中

```
const https = require('http');
const fs = require('fs');

const httpsOptions = {
key: fs.readFileSync('domain.pem'),
cert: fs.readFileSync('domain.crt'),
ca: fs.readFileSync('domain.crt'),
passphrase: '??'
}

https.createServer(options, function (req, res) {
  if (req.client.authorized) {
    res.writeHead(200, {"Content-Type": 
    "application/json"});
    res.end('{"status":"approved"}');
  } else {
    res.writeHead(401, {"Content-Type": 
    "application/json"});
    res.end('{"status":"denied"}');
  }
}).listen(443); 
```

# windows - SDL OpenGL 代码似乎没有深度

> ID：11804170
> 
> 赞同：0
> 
> 时间：2012-08-03T22:33:54.923
> 
> 标签：windows, opengl, sdl, codeblocks

我在 PC 上运行此代码（在 code::blocks 10.05 中编译）
当我使用 GLUT（GL Utiltiy Toolkit）做基本的 OpenGL 代码时，一切正常。
现在，当我尝试更改平移函数的 z 轴（第三个参数）时，我正在通过 SDL 框架运行 OpenGL 代码，几何图元（四边形）的位置似乎没有深度，并且要么显示覆盖当深度达到某一点时，整个屏幕或完全消失。
我错过了什么吗？：/

```
#include <sdl.h>
#include <string>
#include "sdl_image.h"
#include "SDL/SDL_opengl.h"
#include <gl\gl.h>
// Declare Constants
const int FRAMES_PER_SECOND = 60;
const int SCREEN_WIDTH = 640;
const int SCREEN_HEIGHT = 480;
const int SCREEN_BPP = 32;
// Create Event Listener
SDL_Event event;
// Declare Variable Used To Control How Deep Into The Screen The Quad Is
GLfloat zpos(0);
// Loop Switches
bool gamestarted(false);
bool exited(false);
// Prototype For My GL Draw Function
void drawstuff();

// Code Begins

void init_GL() {
    glShadeModel(GL_SMOOTH);                        // Enable Smooth Shading
    glClearColor(0.0f, 0.0f, 0.0f, 0.5f);               // Black Background
    glClearDepth(1.0f);                         // Depth Buffer Setup
    glEnable(GL_DEPTH_TEST);                        // Enables Depth Testing
    glDepthFunc(GL_LEQUAL);                     // The Type Of Depth Testing To Do
    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);          // Really Nice Perspective Calculations
    glViewport(0, 0, 640, 513);                     // Viewport Change
    glOrtho(0, 640, 0, 513, -1.0, 1.0);                 // Puts Stuff Into View
}
bool init() {
    SDL_Init(SDL_INIT_EVERYTHING);
    SDL_SetVideoMode(640, 513, 32, SDL_OPENGL);
    return true;
}  
void drawstuff() {
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();
    glTranslatef(0.0f, 0.0f, zpos);
    glColor3f(0.5f,0.5f,0.5f);
    glBegin(GL_QUADS);
    glVertex3f(-1.0f, 1.0f, 0.0f);
    glVertex3f( 1.0f, 1.0f, 0.0f);
    glVertex3f( 1.0f,-1.0f, 0.0f);
    glVertex3f(-1.0f,-1.0f, 0.0f);
    glEnd();
}
int main (int argc, char* args[]) {
    init();
    init_GL();
    while(exited == false) {
        while( SDL_PollEvent( &event ) ) {
            if( event.type == SDL_QUIT ) {
                exited = true;
            }
            if( event.type == SDL_MOUSEBUTTONDOWN ) {
                zpos-=.1;
            }
        }
        glClear( GL_COLOR_BUFFER_BIT);
        drawstuff();
        SDL_GL_SwapBuffers();
        }
    SDL_Quit();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T11:34:25.083

我想我知道答案：

在正交投影中（投影和透视分割后）：

Zb = -2/(fn) -(f+n)/((fn)*Z)

Zb:z 深度缓冲区中的值

Z：你给定的顶点的 z 值

在您的情况下： glOrtho(0, 640, 0, 513, -1.0, 1.0);
f = 1.0, n = -1.0 所以你的 Zb 总是 -2/(f - n) = -1，这会导致你所有的基元的深度相同。

可以参考红皮书的附录C.2.5。有一个正交投影的矩阵，然后是透视除法。在透视投影中还有一个技巧要记住，zNear 值不能设置为零，这会导致深度缓冲区中所有图元的深度值与此值相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T07:31:49.803

我不知道你的问题的原因，但我在你的代码中发现了一个问题。渲染一帧后，您清除了颜色帧缓冲区​​，但您忘记清除深度缓冲区。所以，使用 glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); 在您的主要功能中并查看效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T22:56:14.123

当您说深度时，您指的是透视效果吗？如果你想让更远的东西看起来更小，你需要使用透视投影矩阵（参见 gluPerspective）。

您当前正在使用正交投影 (glOrtho)，它没有任何透视效果。

# sql - 删除 SQL 查询中的重复行

> ID：11804172
> 
> 赞同：4
> 
> 时间：2012-08-03T22:34:21.600
> 
> 标签：sql, sql-server, sql-server-2005

> **可能重复：**
> [重复结果](https://stackoverflow.com/questions/119896/duplicate-result)
> [面试 - 检测/删除重复条目](https://stackoverflow.com/questions/7649498/interview-detect-remove-duplicate-entries)

我有一个 SQL 查询，它返回一个包含一列的表。

返回的数据可能重复。例如，我的查询可能类似于：

```
SELECT item FROM myTable WHERE something = 3 
```

并且返回的数据可能是这样的：

```
item
-----
2
1
4
5
1
9
5 
```

**我的问题是，如何从我的查询中删除重复的项目？**

我的意思是，我想得到这些结果：

```
item
-----
2
1
4
5
9 
```

请注意，我**不想**更改或删除**表中的任何行。**我只想删除**该查询**中的重复项。

怎么做？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-03T22:35:42.090

```
SELECT DISTINCT item FROM myTable WHERE something = 3 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-03T22:55:17.083

如前所述，`distinct`关键字从结果集中消除了重复的行（其中行在列中具有相同的值）。

但是，对于针对正确设计的数据库的非平凡查询，结果集中存在重复行 - 以及通过`select distinct`or消除它们`select ... group by`，恕我直言，通常是“代码气味”，表明连接条件不正确或不正确，或者缺少了解表之间关系中存在的基数。

如果我正在查看代码，`select distinct`或者`group by`在没有任何明显需要的情况下无偿使用，则会标记包含的查询，并且该查询会用细齿梳完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T22:38:34.687

您需要在查询中添加**DISTINCT**关键字。
这个关键字非常标准，所有主要数据库都支持。

[在此处查看 DISTINCT 参考](http://www.w3schools.com/sql/sql_distinct.asp)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T22:37:19.213

`SELECT DISTINCT item FROM myTable WHERE something = 3`

你只需要使用 distinct

# jsf-2 - 向 SpringSecurity 命名空间 FilterChain 添加多个过滤器

> ID：11804183
> 
> 赞同：1
> 
> 时间：2012-08-03T22:36:20.730
> 
> 标签：jsf-2, spring-security

如何将标准 Http 过滤器的多个自定义实现添加到 Spring Security 命名空间 FilterChainProxy？我知道我可以通过使用 after、before 或 position 属性向链中添加一个过滤器。但是如何添加多个过滤器？这是我的安全配置文件

```
<http pattern="/javax.faces.resource/**" security="none"/>
<http pattern="/resources/**" security="none"/> 
<http pattern="/session_list.jsp" security="none"/>
<http pattern="/security/cas_logout.jsf" security="none"/>
<http pattern="/user/account_signup.jsf" security="none"/>
<http pattern="/user/company_user_association.jsf" security="none"/>
<http pattern="/user/account_signup_review.jsf" security="none"/>                       

<http auto-config="true" use-expressions="true" entry-point-ref="casEntryPoint" access-decision-manager-ref="accessDecisionManager">            
    <intercept-url pattern="/**" access="hasRole('ROLE_USER')"/>
    <logout logout-success-url="/security/cas_logout.jsf" invalidate-session="true"/>
    <custom-filter position="CAS_FILTER" ref="casFilter"/>
    <custom-filter ref="requestSingleLogoutFilter" before="LOGOUT_FILTER"/>
    <custom-filter ref="singleLogoutFilter" before="CAS_FILTER"/>       
</http>

     <beans:bean id="portalSessionFilter" class="org.x.web.security.PortalSessionInterceptor"/>     
     <beans:bean id="requestUrlStackFilter" class="org.x.web.security.RequestUrlStackFilter"/> 
```

我想将**portalSessionFilter 和 requestUrlStackFilter**添加到上面的过滤器链中。我可以做到这一点

```
<custom-filter ref="portalSessionFilter" before="LAST"/> 
```

但是如何在 LAST 之前和**portalSessionFilter之后添加****requestUrlStackFilter**顺便说一句，它们都是简单的 GenericFilterBean 实现。

 **我尝试在其链列表中创建另一个具有上述两个过滤器的**FilterChainProxy** bean，并将该 bean 作为自定义过滤器添加到 LAST 之前的命名空间配置中，过滤器似乎工作但我的 JSF 导航被破坏，尤其是使用 commandLink（我认为 AJAX使用此 FilterChainProxy 时调用失败）

任何人都可以就如何将这两个过滤器和可能的其他过滤器添加到 Spring Security 过滤器链提出任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T23:30:27.323

我找到了解决我遇到的问题的方法。我通过实现我自己的过滤器链而不是使用弹簧安全过滤器链代理来链接我的过滤器来解决它。FilterChainProxy 的问题在于它在过滤器链的末尾使用了 reset 方法，如果将它注入到主 spring 安全过滤器链代理之间会导致问题。

自定义过滤器链只处理所需的过滤器并将控制权交还给主弹簧安全过滤器链代理。这是更改后配置的外观

```
<http auto-config="false" use-expressions="true" entry-point-ref="casEntryPoint" access-decision-manager-ref="accessDecisionManager">           
    <intercept-url pattern="/**" access="hasRole('ROLE_USER')"/>
    <logout logout-success-url="/security/cas_logout.jsf" invalidate-session="true"/>
    <custom-filter position="CAS_FILTER" ref="casFilter"/>
    <custom-filter ref="requestSingleLogoutFilter" before="LOGOUT_FILTER"/>
    <custom-filter ref="singleLogoutFilter" before="CAS_FILTER"/>
    <custom-filter ref="customFilterChain" before="LAST"/>
</http>

<beans:bean id="customFilterChain" class="org.x.web.security.CustomFilterChain">
<beans:constructor-arg>
    <beans:list>
        <filter-chain pattern="/javax.faces.resource/**" filters="none"/>
        <filter-chain pattern="/resources/**" filters="none"/>
        <filter-chain pattern="/**" filters="portalSessionFilter,requestUrlStackFilter"/>
    </beans:list>
</beans:constructor-arg> 
```

这里**CustomFilterChain**扩展了**GenericFilterBean**但在**doFilter**方法中链接过滤器（匹配请求模式）并最终将控制权传递回主 spring 安全 FilterChainProxy**

# java - if else 语句执行

> ID：11804186
> 
> 赞同：-2
> 
> 时间：2012-08-03T22:36:49.020
> 
> 标签：java

我是编程新手。当我运行下面的代码时，它只执行 if 语句并只打印“xmap”。但是我的输入有'x'和'y'，所以我希望我的程序爬过每一行，看看是'x'还是'y'并打印两者。谁能帮我这个。

```
import java.io.*;
import java.util.*;

public class abc {

    public static void main(String[] args) {
        Map<String, List<String>> xMap = new HashMap<String, List<String>>();
        Map<String, List<String>> yMap = new HashMap<String, List<String>>();
        try {
            Scanner scanner = new Scanner(new FileReader("C:/"));

            while (scanner.hasNextLine()) {
                String nextLine = scanner.nextLine();
                String[] column = nextLine.split(":");
                if (column[0].equals("x")) {
                    if (column.length == 4) {
                        xMap.put(column[1], Arrays.asList(column[2], column[3]));
                    } else {
                        yMap.put(column[1], Arrays.asList(column[2], column[3]));
                    }
                }

            }
            scanner.close();

        }

        catch (Exception e) {

            e.printStackTrace();
        }
        System.out.println(xMap);
        System.out.println(yMap);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T22:40:48.563

*如果输入是 x 并且它有 4 列，*它会打印 xma​​p 。*如果输入是 x （再次！）并且它没有 4 列*，它将打印 ymap

 *也许，这就是你想要的：

```
if (column[0].equals("x")) {
    if (column.length == 4) {
        xMap.put(column[1], Arrays.asList(column[2], column[3]));
    } 
else if (column[0].equals("y")){
    if (column.length == 4) {
        yMap.put(column[1], Arrays.asList(column[2], column[3]));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T22:58:46.837

另一种变体，

```
if (column.length == 4) {
    if (column[0].equals("x")) {
        xMap.put(column[1], Arrays.asList(column[2], column[3]));
    }
    else if (column[0].equals("y")){
        yMap.put(column[1], Arrays.asList(column[2], column[3]));
    }
} 
```

还有一个变种，

```
if (column.length == 4 && column[0].equals("x")) {
    xMap.put(column[1], Arrays.asList(column[2], column[3]));
}
else if (column.length == 4 && column[0].equals("y")){
    yMap.put(column[1], Arrays.asList(column[2], column[3]));
} 
```*

# java - 休眠 java.lang.NoClassDefFoundError: org/hibernate/util/DTDEntityResolver

> ID：11804194
> 
> 赞同：1
> 
> 时间：2012-08-03T22:37:36.600
> 
> 标签：java, spring, hibernate

我对休眠很陌生，我只是想制作我的第一个使用它的程序。

我正在使用 Maven 来构建项目。我声明了这些依赖项：

```
 <dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-core</artifactId>
    <version>4.1.5.SP1</version>
   </dependency>

   <dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-entitymanager</artifactId>
    <version>4.1.5.SP1</version>
   </dependency>

   <dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-tools</artifactId>
    <version>3.2.4.GA</version>
   </dependency> 
```

然后我创建了休眠配置文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
                                         "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
 <session-factory name="">
  <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
  <property name="hibernate.connection.password">******</property>
  <property name="hibernate.connection.url">jdbc:mysql://localhost/vcsdb</property>
  <property name="hibernate.connection.username">vcsuser</property>
  <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
  <mapping class="org.test.database.Project"/>
 </session-factory
</hibernate-configuration> 
```

然后我创建了一个逆向工程文件：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

使用 eclipse hibernate 插件，我创建了代表数据库中唯一表的实体：

```
package org.test.database;

// Generated Jul 28, 2012 4:34:03 PM by Hibernate Tools 3.4.0.CR1

import java.util.Date;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import static javax.persistence.GenerationType.IDENTITY;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;

/**
 * Project generated by hbm2java
 */
@Entity
@Table(name = "project", catalog = "versioncontroldb")
public class Project implements java.io.Serializable {

    private Integer id;
    private String name;
    private String longName;
    private String siteUrl;
    private String projectUrl;
    private Date registered;
    private String description;
    private String userId;

    public Project() {
    }

    public Project(String name, String projectUrl, Date registered) {
        this.name = name;
        this.projectUrl = projectUrl;
        this.registered = registered;
    }

    public Project(String name, String longName, String siteUrl,
            String projectUrl, Date registered, String description,
            String userId) {
        this.name = name;
        this.longName = longName;
        this.siteUrl = siteUrl;
        this.projectUrl = projectUrl;
        this.registered = registered;
        this.description = description;
        this.userId = userId;
    }

    @Id
    @GeneratedValue(strategy = IDENTITY)
    @Column(name = "id", unique = true, nullable = false)
    public Integer getId() {
        return this.id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    @Column(name = "name", nullable = false, length = 30)
    public String getName() {
        return this.name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Column(name = "long_name", length = 65535)
    public String getLongName() {
        return this.longName;
    }

    public void setLongName(String longName) {
        this.longName = longName;
    }

    @Column(name = "site_url", length = 150)
    public String getSiteUrl() {
        return this.siteUrl;
    }

    public void setSiteUrl(String siteUrl) {
        this.siteUrl = siteUrl;
    }

    @Column(name = "project_url", nullable = false, length = 200)
    public String getProjectUrl() {
        return this.projectUrl;
    }

    public void setProjectUrl(String projectUrl) {
        this.projectUrl = projectUrl;
    }

    @Temporal(TemporalType.DATE)
    @Column(name = "registered", nullable = false, length = 10)
    public Date getRegistered() {
        return this.registered;
    }

    public void setRegistered(Date registered) {
        this.registered = registered;
    }

    @Column(name = "description", length = 65535)
    public String getDescription() {
        return this.description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    @Column(name = "user_id", length = 25)
    public String getUserId() {
        return this.userId;
    }

    public void setUserId(String userId) {
        this.userId = userId;
    }

} 
```

最后，我将以下代码行添加到应用程序的主要 servlet 类中：

```
Configuration sessionFactory = (Configuration) new Configuration()
    .configure() // configures settings from hibernate.cfg.xml
    .buildSessionFactory(); 
```

但是当我尝试启动应用程序时，我收到以下错误消息：

```
org.springframework.web.util.NestedServletException: Handler processing failed; nested exception is java.lang.NoClassDefFoundError: org/hibernate/util/DTDEntityResolver
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:839)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

和：

```
java.lang.NoClassDefFoundError: org/hibernate/util/DTDEntityResolver
java.lang.ClassLoader.defineClass1(Native Method)
java.lang.ClassLoader.defineClass(ClassLoader.java:791)
java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2901)
org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1170)
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
org.hibernate.cfg.Configuration.reset(Configuration.java:326)
org.hibernate.cfg.Configuration.<init>(Configuration.java:265)
org.hibernate.cfg.Configuration.<init>(Configuration.java:269)
org.versioncontrolanalyzer.controllers.MainController.helloWorld(MainController.java:18)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method.invoke(Method.java:601)
org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:426)
org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:414)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T08:44:57.650

好的，我自己找到了解决方案。

有几个错误。我在 pom 中删除了这个依赖项：

```
 <dependency>
<groupId>org.hibernate</groupId>
<artifactId>hibernate-tools</artifactId>
<version>3.2.4.GA</version> 
```

然后我收到另一个错误：找不到 hibernate.cfg.xml，我环顾四周，发现这个配置文件必须放在 java 源的根文件夹中（所以在部署应用程序时它会放在 classes 文件夹中）。

最后我有另一个。转换为 sessionFactory 的声明，我将其声明为 Configuration 变量，但它必须是 SessionFactory 变量。

最后，映射还有另一个问题（Project 类的包错误）。

它似乎有效:)

# php - 为什么 COM 类在 PHP 5.4.5 中不再存在？

> ID：11804195
> 
> 赞同：4
> 
> 时间：2012-08-03T22:37:42.583
> 
> 标签：php, com, configuration

我有以下代码在 PHP 5.4.4 中运行良好：

```
if (@class_exists('COM'))
{
    // Do the actual work here...
}
else
{
    throw new MissingComponentException('COM');
} 
```

一旦升级到 PHP 5.4.5，代码就会停止工作，并且总是抛出异常。Stack Overflow 上的其他答案没有帮助，因为它们指的是在 Windows 以外的平台上运行的 PHP（[例如](https://stackoverflow.com/a/10678341/240613)；[另一个](https://stackoverflow.com/a/11704312/240613)）。

我能做些什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-03T22:37:42.583

在以前的 PHP 版本中，嵌入了 COM。从 PHP 5.4.5 开始，有一个新的扩展名为`php_com_dotnet.dll`. 为了继续使用 COM，将以下行添加到`php.ini`：

```
extension=php_com_dotnet.dll 
```

# java - 如何让我的 JFree 图表在显示新的 Y 范围后更新？

> ID：11804198
> 
> 赞同：0
> 
> 时间：2012-08-03T22:37:45.133
> 
> 标签：java, jfreechart

这是我如何显示图表并尝试使用新的 Y 范围重新渲染的片段。

```
fpe2.FPE_ExportData(outPutFilePath, xmlOutDescriptorPath);

g = new GraphUtil();
g.collectData(fpe2.subTaskType, "FPE", MaxY, MinY, PlotGraphPanel);
g.graphMake();

PlotGraphPanel.add(g.cPanel1, BorderLayout.CENTER);
PlotGraphPanel.validate();
PlotGraphPanel.repaint(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:55:52.890

Absent your [sscce](http://sscce.org/), it's not clear how your program fails. You should only need `validate()` and `repaint()` if you add or remove components. You can update your chart dynamically as shown [here](https://stackoverflow.com/a/5522583/230513) and [here](https://stackoverflow.com/a/5048863/230513).

# user-interface - 为什么不向用户显示错误消息和系统规格？

> ID：11804201
> 
> 赞同：2
> 
> 时间：2012-08-03T22:38:04.837
> 
> 标签：user-interface, error-handling, security, code-access-security

有时我在我的一个网站上，我遇到了一个数据库错误，它只是把自己扔到一个公开可见的页面上。我赶紧把它清理干净，当它不属于时修复错误，并在它属于时创建自定义错误。我被无数次告知不要让用户查看错误消息并尽量避免泄露系统规格。不过，我似乎忘记了原因。为什么这如此重要？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T22:40:34.933

因为 baddee 对您的系统架构了解得越多，他们就越容易定制攻击以获取访问权限、将其关闭等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T22:41:40.173

简短的回答是，攻击者拥有的信息越多，他们就越有可能以某种方式破坏该站点。

例如，如果数据库错误中包含表名或列名，那么攻击者现在知道在 SQL 注入攻击中要尝试什么。

[https://www.owasp.org/index.php/Top_10_2007-Information_Leakage_and_Improper_Error_Handling](https://www.owasp.org/index.php/Top_10_2007-Information_Leakage_and_Improper_Error_Handling)

Owasp 对这个问题有很好的处理。上面的链接是旧的，但仍然有效。一般来说，我推荐 OWASP 作为一个很好的资源，不仅可以了解什么是好的安全实践，还可以了解它们为什么好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T22:43:09.710

1.  因为用户也可以是破解者/黑客。
2.  它让用户看到很多奇怪的文本/代码 => 对用户不友好。

但主要原因是黑客获得了您系统的知识。

# node.js - 如何为 express.js 服务器设置 SSL 证书？

> ID：11804202
> 
> 赞同：142
> 
> 时间：2012-08-03T22:38:06.240
> 
> 标签：node.js, express, ssl-certificate

以前，在旧版本的 express 中，我可以这样做：

```
express.createServer({key:'keyFile', cert:'certFile'}); 
```

但是，在较新版本的 express 中，这不再有效：

```
var app = express(); 
```

我应该打电话`app.use()`来设置证书吗？如果有怎么办？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2012-08-04T04:31:49.880

请参阅[Express 文档](http://expressjs.com/api.html#app.listen)以及[https.createServer 的 Node 文档](http://nodejs.org/api/https.html#https_https_createserver_options_requestlistener)（这是 express 推荐使用的）：

```
var privateKey = fs.readFileSync( 'privatekey.pem' );
var certificate = fs.readFileSync( 'certificate.pem' );

https.createServer({
    key: privateKey,
    cert: certificate
}, app).listen(port); 
```

createServer 的其他选项位于：[http ://nodejs.org/api/tls.html#tls_tls_createserver_options_secureconnectionlistener](http://nodejs.org/api/tls.html#tls_tls_createserver_options_secureconnectionlistener)

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2012-08-22T17:35:45.363

我能够让 SSL 使用以下样板代码：

```
var fs = require('fs'),
    http = require('http'),
    https = require('https'),
    express = require('express');

var port = 8000;

var options = {
    key: fs.readFileSync('./ssl/privatekey.pem'),
    cert: fs.readFileSync('./ssl/certificate.pem'),
};

var app = express();

var server = https.createServer(options, app).listen(port, function(){
  console.log("Express server listening on port " + port);
});

app.get('/', function (req, res) {
    res.writeHead(200);
    res.end("hello world\n");
}); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2018-08-20T20:18:29.067

这是我的***express 4.0******工作代码***。

 *express 4.0 与 3.0 和其他版本有很大不同。

4.0 你有 /bin/www 文件，你要在这里添加 https。

“npm start”是启动 express 4.0 服务器的标准方式。

readFileSync() 函数应该使用***__dirname***获取当前目录

而 require()***使用 ./***引用当前目录。

***首先你把 private.key 和 public.cert 文件放在 /bin 文件夹下，它和 WWW 文件是同一个文件夹****。*

没有找到这样的目录错误：

```
 key: fs.readFileSync('../private.key'),

  cert: fs.readFileSync('../public.cert') 
```

错误，找不到这样的目录

```
 key: fs.readFileSync('./private.key'),

  cert: fs.readFileSync('./public.cert') 
```

***工作代码应该是***

```
key: fs.readFileSync(__dirname + '/private.key', 'utf8'),

cert: fs.readFileSync(__dirname + '/public.cert', 'utf8') 
```

***完整的https代码是：***

```
const https = require('https');
const fs = require('fs');

// readFileSync function must use __dirname get current directory
// require use ./ refer to current directory.

const options = {
   key: fs.readFileSync(__dirname + '/private.key', 'utf8'),
  cert: fs.readFileSync(__dirname + '/public.cert', 'utf8')
};

 // Create HTTPs server.

 var server = https.createServer(options, app); 
```*

# xaml - Windows 8 AppBar 覆盖页面内容；我想要 squish

> ID：11804204
> 
> 赞同：0
> 
> 时间：2012-08-03T22:38:10.650
> 
> 标签：xaml, windows-runtime, appbar

是否有一些技巧可以使 WinRT 中的 Page.AppBars 挤压/移动页面的内容而不是越过内容的顶部？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T21:17:34.283

你可以，但你需要编写一些代码来做到这一点。

我的版本使用视觉状态：

```
<Page.BottomAppBar>
    <AppBar
        x:Name="bottomAppBar"
        Opened="OnBottomAppBarOpened"
        Closed="OnBottomAppBarClosed">
        <StackPanel
            Orientation="Horizontal">
            <Button
                Style="{StaticResource PlayAppBarButtonStyle}" />
        </StackPanel>
    </AppBar>
</Page.BottomAppBar>
<Grid
    Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <VisualStateManager.VisualStateGroups>
        <VisualStateGroup
            x:Name="AppBarPushStates">
            <VisualState
                x:Name="AppBarClosed">
                <Storyboard>
                    <DoubleAnimation
                        Storyboard.TargetName="pushedContentTransform"
                        Storyboard.TargetProperty="Y"
                        To="0"
                        Duration="0:0:0.2">
                        <DoubleAnimation.EasingFunction>
                            <CubicEase
                                EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                    </DoubleAnimation>
                </Storyboard>
            </VisualState>
            <VisualState
                x:Name="AppBarOpened">
                <Storyboard>
                    <DoubleAnimation
                        Storyboard.TargetName="pushedContentTransform"
                        Storyboard.TargetProperty="Y"
                        To="-88"
                        Duration="0:0:0.2">
                        <DoubleAnimation.EasingFunction>
                            <CubicEase
                                EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                    </DoubleAnimation>
                </Storyboard>
            </VisualState>
        </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>
    <Border
        VerticalAlignment="Stretch"
        HorizontalAlignment="Stretch"
        BorderBrush="Orange"
        BorderThickness="5">
        <Border.RenderTransform>
            <TranslateTransform
                x:Name="pushedContentTransform" />
        </Border.RenderTransform>
        <TextBox
            TextWrapping="Wrap"
            Foreground="Brown"
            FontSize="48"
            Text="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Maecenas porttitor congue massa. Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. Nunc viverra imperdiet enim. Fusce est. Vivamus a tellus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Proin pharetra nonummy pede. Mauris et orci. Aenean nec lorem. In porttitor. Donec laoreet nonummy augue. Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. Mauris eget neque at sem venenatis eleifend. Ut nonummy. Fusce aliquet pede non pede. Suspendisse dapibus lorem pellentesque magna. Integer nulla. Donec blandit feugiat ligula. Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. Donec ut est in lectus consequat consequat." />
    </Border>
</Grid> 
```

后面的代码：

```
 private void OnBottomAppBarClosed(object sender, object e)
    {
        VisualStateManager.GoToState(this, "AppBarClosed", true);
    }

    private void OnBottomAppBarOpened(object sender, object e)
    {
        VisualStateManager.GoToState(this, "AppBarOpened", true);
    } 
```

# mysql - mysql 更新一个字段并随后使用它

> ID：11804209
> 
> 赞同：4
> 
> 时间：2012-08-03T22:38:40.700
> 
> 标签：mysql, sql

我有一个纯粹的理论问题，有一个废话的例子：

```
 UPDATE mytable
      binaryData = '___GIANT_BINARY_DATA___',
      isBig      = LENGTH('___THE_SAME_GIANT_BINARY_DATA___') > 1000000000
  WHERE id = 22 
```

现在，如果我的二进制数据是“十亿字节”，我想避免在普通 SQL 中写两次

```
 UPDATE mytable
      binaryData = '___GIANT_BINARY_DATA___',
      isBig      = LENGTH(binaryData) > 1000000000
  WHERE id = 22 
```

**我想更新一个列字段，然后在同一个查询中使用它的列名重新使用它**

或者也许有办法在 UPDATE 语法中定义别名，就像我可以用 SELECT 一样？

先感谢您

（ps 我也对等效的 INSERT 语法感兴趣）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T22:51:27.037

你可以`CROSS JOIN`这样使用：

```
UPDATE     mytable a
CROSS JOIN (SELECT '__GIANT_BINARY_DATA__' AS bindata) b
SET        a.binaryDate = b.bindata,
           a.isBig = LENGTH(b.bindata) > 1000000000
WHERE      a.id = 22 
```

这将使您可以访问每一行中的相同值，并且您只需在 SQL 语句字符串中传递一次数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T22:53:47.413

您可以使用用户变量：

```
set @content = '___GIANT_BINARY_DATA___';
UPDATE mytable
   SET binaryData = @content,
       isBig = LENGTH(@content) > 1000000000
 WHERE id = 22;
set @content = NULL; -- free up memory 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T22:55:01.110

MySql 的奇怪之处在于`SET`语句是非原子的，这意味着一旦为一列分配了新值，如果在更新语句的其他地方使用该新值，它将被反映。

以下陈述：

```
CREATE TABLE Swap (
  a CHAR(1),
  b CHAR(1)
);

INSERT INTO Swap (a, b) VALUES ('a', 'b');

UPDATE Swap SET a = b, b = a;

SELECT * FROM Swap; 
```

将导致`b`，`b`在 MySql 中，但是`b`，`a`在我知道的所有其他 RBDMS 中......

因此，对于您的问题，您不需要 alias `binaryData`，因为一旦更新，更新后的值将反映在`isBig`赋值语句中。

但是，依赖这种行为可能是个坏主意，因为它是非标准的。

# android - 如何在 android 上使用 OAuth 将数据拉入我们的服务器（而不是手机）？

> ID：11804210
> 
> 赞同：0
> 
> 时间：2012-08-03T22:38:56.597
> 
> 标签：android, facebook, oauth-2.0

我有 3 个实体：

1.安卓手机

2.本地服务器

3.FB服务器

我希望用户从他的手机登录到 FB，但是一旦通过身份验证，我希望能够将数据从 FB 提取到本地服务器（手机上没有数据）。

做这个的最好方式是什么 ？。有没有办法使用 oAuth 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T12:12:45.650

这当然没有问题。只需在您的 Web 服务器上实现[服务器端身份验证流程。](https://developers.facebook.com/docs/authentication/server-side/)您无需在网站上放置登录按钮，将用户重定向到 Facebook 对话框，而是使用该 URI 在智能手机上打开浏览器（或嵌入 Web 视图）。然后`redirect_uri`指向您的 Web 服务器回调，您会在其中收到授权码。然后，您通过从您的服务器调用 Facebook 来将该代码交换为访问令牌，然后您就完成了。

在手机上，将浏览器指向：

```
https://www.facebook.com/dialog/oauth?
    client_id=YOUR_APP_ID
    &redirect_uri=https://YOUR_SERVER/YOUR_CALLBACK
    &scope=COMMA_SEPARATED_LIST_OF_PERMISSION_NAMES
    &state=SOME_ARBITRARY_BUT_UNIQUE_STRING 
```

处理回调后，从您的服务器发出请求：

```
https://graph.facebook.com/oauth/access_token?
    client_id=YOUR_APP_ID
    &redirect_uri=https://YOUR_SERVER/YOUR_CALLBACK
    &client_secret=YOUR_APP_SECRET
    &code=AUTHORIZATION_CODE_YOU_RECEIVED 
```

# python - Django - 在视图注释中指定模板

> ID：11804213
> 
> 赞同：1
> 
> 时间：2012-08-03T22:39:23.827
> 
> 标签：python, django

是否可以在视图注释中指定模板名称。

我想在我的views.py中做类似的事情：而不是：

```
def home(request, url):    
    page = PageFactory.create_for_url(url)    
    return render_to_response('front/home.html', {'page': page}) 
```

我宁愿这样做：

```
@view('front/home.html')
def home(request, url):    
    page = PageFactory.create_for_url(url)    
    return {'page': page} 
```

可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T22:52:36.397

有几个自制的装饰师可以做到这一点

以下看起来是一个好的开始

```
def renderer(func):
        def wrapper(request, *args, **kw):
            output = func(request, *args, **kw)
            if isinstance(output, (list, tuple)):
                return render_to_response(output[1], output[0], RequestContext(request))
            elif isinstance(output, dict):
                return render_to_response(template, output, RequestContext(request))
            return output
        return wrapper
    return renderer 
```

[http://djangosnippets.org/snippets/821/](http://djangosnippets.org/snippets/821/)

谷歌结果产生 4-5。

# python - 我的代码不起作用

> ID：11804217
> 
> 赞同：-1
> 
> 时间：2012-08-03T22:40:05.433
> 
> 标签：python

```
for i in l1:
    print "the i is ", i
    print i[0]   # 'a'
    print i[1]   # (1, 1)
    n = re.search(r'[a-z]', i[0])
    v = (1,1)
    if i[0] != n:
    v = (1,1)
    n = i[0]
    if i[1] != v:
        raise ValueError, '[%s, %s] is missing in %s' %(i[0], (i[1][0], i[1][1]-1), production)

    v = (v[0], v[1] + 1) 
```

我需要检查给定列表中是否缺少任何项目 l1 = [['a', (1, 2)], ['a', (1, 3)], ['a', (1, 4) ]] `in this case`['a', (1, 1)]` 不见了，所以我应该报错。

同样，如果我们有列表 l1 = ['b', (1,1)] ,['b', (1, 3)], ['a', (1, 4)]] `. In this case`['b', ( 1, 2)]` 缺失，所以应该报错如下代码所示。

我总是得到 ['a', (1,1)] 尽管它是否存在于列表中 l1 = [['a', (1, 1)],['a', (1, 2) ], ['a', (1, 3)], ['a', (1, 4)]]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T22:49:24.413

您想增加元组的第二个值，而不是元组本身：

```
v = (v[0], v[1] + 1) 
```

如图所示，您需要创建一个新元组，因为元组本身是不可变的。

# android - 除非按下后退按钮，否则无法弄清楚如何让 android 键盘消失

> ID：11804223
> 
> 赞同：1
> 
> 时间：2012-08-03T22:40:33.723
> 
> 标签：android

我有一个编辑视图。当有人单击 EditView 时，keywbaord 消失的唯一方法是按下后退按钮 id。

我看到一些应用程序有它，所以当键盘出现时，右下角有一个显示完成的按钮。按下时，键盘消失。我的应用程序不这样做，有人知道他们是怎么做到的吗？

当按下回车键时，是否可以让键盘消失，让它添加另一行文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:11:49.550

您可以使用[TextView.setImeOptions()](http://developer.android.com/reference/android/widget/TextView.html#setImeOptions%28int%29)并将其传递给 actionDone 或在布局中使用 android:imeOptions="actionDone" 属性。

要在按下 enter 时关闭，请使用自定义[OnEditorActionListener](http://developer.android.com/reference/android/widget/TextView.html#setOnEditorActionListener%28android.widget.TextView.OnEditorActionListener%29)。但是，最好将回车键更改为如上所述的完成，以便传达将发生的操作。

请参阅[这个 SO 问题](https://stackoverflow.com/questions/1919742/android-editview-done-button)。

# linux - 使用命令行检查新电子邮件

> ID：11804225
> 
> 赞同：3
> 
> 时间：2012-08-03T22:40:43.180
> 
> 标签：linux, email

我在 Ubuntu 上，我在 gmail 上有一些电子邮件帐户，我想每隔一段时间轮询一次，看看是否有新邮件。我想为此编写一个脚本，这样每次我运行脚本时它都会告诉我我的帐户中有多少新消息。我必须从命令行运行什么应用程序才能做这样的事情？我在网上找到的所有内容都在谈论使用“邮件”命令，但这似乎检查了一些本地邮件目录而不是我的远程电子邮件（显然，任何此类应用程序也需要我将其配置为使用正确的密码登录我的帐户） .

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T22:47:18.737

Python 使检查 IMAP 帐户变得相当容易，而无需安装任何额外的包。

Yuji Tomita 的博客上有一篇关于如何使用 python`imaplib`与 Gmail 对话的好文章。 [http://yuji.wordpress.com/2011/06/22/python-imaplib-imap-example-with-gmail/](http://yuji.wordpress.com/2011/06/22/python-imaplib-imap-example-with-gmail/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T16:55:39.930

尝试以下操作：

```
curl -u user@gmail.com:password --silent "https://mail.google.com/mail/feed/atom" | perl -ne 'print "\t" if /<name>/; print "$2\n" if /<(title|name)>(.*)<\/\1>/;' | espeak 
```

# ruby - 使用 Ruby 和 Mechanize 计算新的奥运奖牌

> ID：11804226
> 
> 赞同：1
> 
> 时间：2012-08-03T22:40:44.010
> 
> 标签：ruby, mechanize

我想改造2012年伦敦奥运会的奖牌，以更好地体现奖牌的价值。目前仅按金牌排序。我想按点重新列出它，所以黄金=4，白银=2，青铜=1，以创建一个新的更合理的列表。我可能想记住以前的排名，然后还要添加一个新的排名列。

我想尝试机械化以从站点获取原始数据，然后将数据解析为行和列，应用新计数，然后重新制作列表。

来自[http://www.london2012.com/medals/medal-count/](http://www.london2012.com/medals/medal-count/)的来源，每个国家/地区都有一个带有奖牌的区块，如下所示：

```
<span class="countryName">Canada</span></a></div></div></td><td class="gold c">0</td><td class="silver c">2</td><td class="bronze c">5</td> 
```

如果我使用 agent.get('http://www.london2012.com/medals/medal-count') 它会显示整个列表。如何解析特定的跨度和表数据？

我还需要记住排名，然后当我制作新页面时，将新排名放在它旁边。

任何有关机械化解析和记忆数据的技巧都会非常有帮助。更重要的是你在做这样的事情时的思考过程，我很感激能帮助我开始。这不一定是代码答案

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T02:20:42.423

首先要识别表。在 chrome 中加载页面并右键单击表格上的任意位置。去检查元素。向上层级，直到你在桌子上。现在选择它，你会看到它看起来像这样：

```
<table class="or-tbl overall_medals sortable" summary="Schedule"> 
```

general_medals 类看起来是独一无二的，所以它是一个很好用的类。现在启动 irb 并执行以下操作：

```
require 'mechanize'
agent = Mechanize.new
page = agent.get 'http://www.london2012.com/medals/medal-count/' 
```

仔细检查表是否唯一：

```
page.search('table.overall_medals').size 
#=> 1 (good, it is) 
```

您可以使用以下命令将表中的所有数据放入数组中：

```
page.search('table.overall_medals tr').map{|tr| tr.search('td').map(&:text)} 
```

请注意，前 2 行是空的，让我们通过使用范围来摆脱它们：

```
data = page.search('table.overall_medals tr')[2..-1].map{|tr| tr.search('td').map(&:text)} 
```

第二行并不是真正的空，它有列名（在 th 中而不是 td 中）。你可以得到那些：

```
columns = page.search('table.overall_medals tr[2] th').map{|th| th.text.strip} 
```

您可以使用以下方法将它们放入哈希中：

```
rows = data.map{|row| Hash[columns.zip row]} 
```

现在你可以做

```
rows[0]['Country']
#=> "United States of America" 
```

甚至是一个大哈希：

```
countries = rows.map{|row| {row['Country'] => row}}.reduce &:merge 
```

现在：

```
countries['France']['Gold']
#=> "8" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T20:00:08.837

您可能会发现此 Medals API 很有用（假设您的问题不是专门针对 Mechanize）

[http://apify.heroku.com/resources/5014626da8cdbb0002000006](http://apify.heroku.com/resources/5014626da8cdbb0002000006)

它使用 Nokogiri 来解析站点，并且输出以 JSON 格式提供：

[http://apify.heroku.com/api/olympics2012_medals.json](http://apify.heroku.com/api/olympics2012_medals.json)

# linux - CMake - SDL - 静态链接

> ID：11804229
> 
> 赞同：2
> 
> 时间：2012-08-03T22:40:50.077
> 
> 标签：linux, cmake, sdl

我有一个使用 cmake 在 windows 和 linux 上构建的应用程序。我想分发我的 linux 版本，但找不到通过 cmake 使其静态编译/包含 SDL 的方法。我宁愿不假设/要求任何用户已经安装了 SDL。

# ios - iOS：创建 UIImage 时出现 CGBitmapContextCreate 错误

> ID：11804230
> 
> 赞同：1
> 
> 时间：2012-08-03T22:41:08.360
> 
> 标签：ios

我想从 Pix 获取 UIImage 而不对文件进行任何读/写操作。我收到 CGBitmapContextCreate 错误。

这是 Pix 结构：

```
 struct Pix
{
     l_uint32             w;           /* width in pixels                   */
     l_uint32             h;           /* height in pixels                  */
     l_uint32             d;           /* depth in bits                     */
     l_uint32             wpl;         /* 32-bit words/line                 */
     l_uint32             refcount;    /* reference count (1 if no clones)  */
     l_int32              xres;        /* image res (ppi) in x direction    */
                                       /* (use 0 if unknown)                */
     l_int32              yres;        /* image res (ppi) in y direction    */
                                       /* (use 0 if unknown)                */
     l_int32              informat;    /* input file format, IFF_*          */
     char                *text;        /* text string associated with pix   */
     struct PixColormap  *colormap;    /* colormap (may be null)            */
     l_uint32            *data;        /* the image data                    */
 };
 typedef struct Pix PIX; 
```

完整的文档可以在这里找到：http: [//tpgit.github.com/Leptonica/pix_8h_source.html](http://tpgit.github.com/Leptonica/pix_8h_source.html)

这是我的尝试：

```
- (UIImage *) getImageFromPix:(PIX *) thePix
{
    CGColorSpaceRef colorSpace;
    uint32_t *bitmapData;

    size_t bitsPerComponent = thePix->d;

    size_t width = thePix->w;
    size_t height = thePix->h;

    size_t bytesPerRow = thePix->wpl * 4;

    colorSpace = CGColorSpaceCreateDeviceGray();

    if(!colorSpace) {
        NSLog(@"Error allocating color space Gray\n");
        return NULL;
    }

    // Allocate memory for image data
    bitmapData = thePix->data;

    if(!bitmapData) {
        NSLog(@"Error allocating memory for bitmap\n");
        CGColorSpaceRelease(colorSpace);
        return NULL;
    }

    //Create bitmap context

    CGContextRef context = CGBitmapContextCreate(bitmapData, 
                                    width, 
                                    height, 
                                    bitsPerComponent, 
                                    bytesPerRow, 
                                    colorSpace, 
                                    kCGImageAlphaNone); 
    if(!context) {
        free(bitmapData);
        NSLog(@"Bitmap context not created");
    }

    CGColorSpaceRelease(colorSpace);

    CGImageRef imgRef = CGBitmapContextCreateImage(context);
    UIImage * result = [UIImage imageWithCGImage:imgRef];
    CGImageRelease(imgRef);
    CGContextRelease(context);

    return result;
} 
```

这是我得到的错误：

```
<Error>: CGBitmapContextCreate: unsupported parameter combination: 1 integer bits/component; 1 bits/pixel; 1-component color space; kCGImageAlphaNone; 16 bytes/row. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T01:59:34.140

`CGBitmapContextCreate()`不支持像素格式的每种组合。它可能不支持许多 Pix 格式。支持格式的完整列表可以在[Quartz 2D Programming Guide](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-CJBHBFFE)中找到。iOS 上支持的格式相当有限。您可能需要将从 Pix 获得的内容转换为一种受支持的格式。通常很难做到这一点，但对于您的特定情况，如果您总是得到 1 位/像素、1 位/分量、没有 Alpha 通道，那么转换为 8 位/像素、8 位的灰度格式应该不会太难/component，iOS 上不支持 alpha 通道。

# exception - LockModeType.PESSIMISTIC_WRITE 给出：当前没有事务处于活动状态

> ID：11804232
> 
> 赞同：1
> 
> 时间：2012-08-03T22:41:16.547
> 
> 标签：exception, jpa, transactions, locking, jpql

冗余行显示在数据库中：

```
mysql> 
mysql> 
mysql> USE usenet;SHOW TABLES;DESCRIBE ARTICLE;DESCRIBE NEWSGROUP;SELECT * FROM NEWSGROUP;
Database changed
+------------------+
| Tables_in_usenet |
+------------------+
| ARTICLE          |
| NEWSGROUP        |
+------------------+
2 rows in set (0.00 sec)

+---------------+------------+------+-----+---------+----------------+
| Field         | Type       | Null | Key | Default | Extra          |
+---------------+------------+------+-----+---------+----------------+
| ID            | bigint(20) | NO   | PRI | NULL    | auto_increment |
| MESSAGENUMBER | int(11)    | YES  |     | NULL    |                |
| NEWSGROUP_ID  | bigint(20) | YES  | MUL | NULL    |                |
+---------------+------------+------+-----+---------+----------------+
3 rows in set (0.00 sec)

+-----------+--------------+------+-----+---------+----------------+
| Field     | Type         | Null | Key | Default | Extra          |
+-----------+--------------+------+-----+---------+----------------+
| ID        | bigint(20)   | NO   | PRI | NULL    | auto_increment |
| NEWSGROUP | varchar(255) | YES  |     | NULL    |                |
+-----------+--------------+------+-----+---------+----------------+
2 rows in set (0.00 sec)

+----+-------------------------------+
| ID | NEWSGROUP                     |
+----+-------------------------------+
|  1 | gwene.com.androidcentral      |
|  2 | gwene.com.androidcentral      |
|  3 | gwene.com.blogspot.emacsworld |
|  4 | gwene.com.blogspot.googlecode |
|  5 | gwene.com.blogspot.googlecode |
|  6 | gwene.com.economist           |
|  7 | gwene.com.economist           |
+----+-------------------------------+
7 rows in set (0.00 sec)

mysql> 
```

`NEWSGROUP.newsgroup`应该有独特的价值。我有理由确定我需要在`Article`构造函数中锁定数据库：

```
public Article(Message message, Folder folder) {
    messageNumber = message.getMessageNumber();
    EntityManagerFactory emf;
    EntityManager em;
    emf = Persistence.createEntityManagerFactory("USENETPU");
    em = emf.createEntityManager();
    String fullNewsgroupName = folder.getFullName();
    TypedQuery<Newsgroup> query = em.createQuery("SELECT n FROM Newsgroup n WHERE n.newsgroup = :newsGroupParam", Newsgroup.class);
    query.setParameter("newsGroupParam", fullNewsgroupName);
    em.lock(query, LockModeType.PESSIMISTIC_WRITE);
    try {
        newsgroup = query.getSingleResult();
        LOG.info("found " + query.getSingleResult()); //ok
    } catch (javax.persistence.NoResultException e) {
        newsgroup = new Newsgroup(folder);
        LOG.info(e + "\ncould not find " + fullNewsgroupName); //ok
    } catch (NonUniqueResultException e) {
        LOG.info(e + "\nshould never happen\t" + fullNewsgroupName); //not ok
    }
} 
```

但是，该锁定会导致：

```
run:
DEBUG: nntp: newsrc loading /home/thufir/.newsrc
DEBUG: nntp: newsrc load: 5 groups in 35ms
[EL Info]: 2012-08-03 15:35:28.386--ServerSession(17944810)--EclipseLink, version: Eclipse Persistence Services - 2.3.0.v20110604-r9504
[EL Info]: 2012-08-03 15:35:29.526--ServerSession(17944810)--file:/home/thufir/NetBeansProjects/USENET/build/classes/_USENETPU login successful
Aug 03, 2012 3:35:30 PM net.bounceme.dur.usenet.driver.FetchBean <init>
INFO: [gwene.com.androidcentral, gwene.com.blogspot.emacsworld, gwene.com.blogspot.googlecode, gwene.com.blogspot.googlereader, gwene.com.economist]
Aug 03, 2012 3:35:31 PM net.bounceme.dur.usenet.driver.FetchBean main
SEVERE: null
javax.persistence.TransactionRequiredException: 
Exception Description: No transaction is currently active
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionWrapper.throwCheckTransactionFailedException(EntityTransactionWrapper.java:113)
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionWrapper.checkForTransaction(EntityTransactionWrapper.java:50)
    at org.eclipse.persistence.internal.jpa.EntityManagerImpl.checkForTransaction(EntityManagerImpl.java:1776)
    at org.eclipse.persistence.internal.jpa.EntityManagerImpl.lock(EntityManagerImpl.java:1617)
    at org.eclipse.persistence.internal.jpa.EntityManagerImpl.lock(EntityManagerImpl.java:1593)
    at net.bounceme.dur.usenet.model.Article.<init>(Article.java:34)
    at net.bounceme.dur.usenet.driver.FetchBean.<init>(FetchBean.java:41)
    at net.bounceme.dur.usenet.driver.FetchBean.main(FetchBean.java:21)

BUILD SUCCESSFUL (total time: 16 seconds) 
```

而将其注释掉则可以正常运行：

```
run:
DEBUG: nntp: newsrc loading /home/thufir/.newsrc
DEBUG: nntp: newsrc load: 5 groups in 14ms
[EL Info]: 2012-08-03 15:36:28.103--ServerSession(17944810)--EclipseLink, version: Eclipse Persistence Services - 2.3.0.v20110604-r9504
[EL Info]: 2012-08-03 15:36:29.186--ServerSession(17944810)--file:/home/thufir/NetBeansProjects/USENET/build/classes/_USENETPU login successful
Aug 03, 2012 3:36:29 PM net.bounceme.dur.usenet.driver.FetchBean <init>
INFO: [gwene.com.androidcentral, gwene.com.blogspot.emacsworld, gwene.com.blogspot.googlecode, gwene.com.blogspot.googlereader, gwene.com.economist]
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NoResultException: getSingleResult() did not retrieve any entities.
could not find gwene.com.androidcentral
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: found gwene.com.androidcentral
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.androidcentral
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.androidcentral
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.androidcentral
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.androidcentral
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.androidcentral
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.androidcentral
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NoResultException: getSingleResult() did not retrieve any entities.
could not find gwene.com.blogspot.emacsworld
Aug 03, 2012 3:36:31 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NoResultException: getSingleResult() did not retrieve any entities.
could not find gwene.com.blogspot.googlecode
Aug 03, 2012 3:36:32 PM net.bounceme.dur.usenet.model.Article <init>
INFO: found gwene.com.blogspot.googlecode
Aug 03, 2012 3:36:32 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.blogspot.googlecode
Aug 03, 2012 3:36:32 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.blogspot.googlecode
Aug 03, 2012 3:36:32 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.blogspot.googlecode
Aug 03, 2012 3:36:32 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.blogspot.googlecode
Aug 03, 2012 3:36:32 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.blogspot.googlecode
Aug 03, 2012 3:36:32 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.blogspot.googlecode
Aug 03, 2012 3:36:32 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NoResultException: getSingleResult() did not retrieve any entities.
could not find gwene.com.economist
Aug 03, 2012 3:36:33 PM net.bounceme.dur.usenet.model.Article <init>
INFO: found gwene.com.economist
Aug 03, 2012 3:36:33 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.economist
Aug 03, 2012 3:36:33 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.economist
Aug 03, 2012 3:36:33 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.economist
Aug 03, 2012 3:36:33 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.economist
Aug 03, 2012 3:36:33 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.economist
Aug 03, 2012 3:36:33 PM net.bounceme.dur.usenet.model.Article <init>
INFO: javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult()
should never happen gwene.com.economist
Aug 03, 2012 3:36:33 PM net.bounceme.dur.usenet.driver.FetchBean <init>
INFO: **************************done
BUILD SUCCESSFUL (total time: 16 seconds) 
```

只有`Article`构造函数会实例化`Newsgroup`实体；目前的表生成策略是`drop and create`.

在这种情况下，如何获得锁以防止重复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T13:59:15.477

您需要在执行锁定查询之前启动事务。您只能在数据库事务的上下文中锁定某些内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-15T13:02:52.767

就我而言，我使用 jpa 存储库和查询提示来获得乐观悲观写锁。通常，我会`@transactional`在服务层上使用注释，但它不适用于以下存储库设置。因此，在使用存储库之前，我必须明确启动事务。也许这可能会对您有所帮助。

```
@Repository
public interface BookRepository extends JpaRepository<Book, Long> {

    /**
     * "The lock acquisition request skips the already locked rows.
     * It uses a SELECT …​ FOR UPDATE SKIP LOCKED in Oracle and PostgreSQL 9.5,
     * or SELECT …​ with (rowlock, updlock, readpast) in SQL Server."
     */
    String UPGRADE_SKIPLOCKED = "-2";

    @Lock(value = LockModeType.PESSIMISTIC_WRITE) // adds 'FOR UPDATE' statement
    @QueryHints({@QueryHint(name = "javax.persistence.lock.timeout", value = UPGRADE_SKIPLOCKED)})
    Book findFirst();
} 
```

和服务：

```
import org.springframework.stereotype.Service;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.TransactionDefinition;
import org.springframework.transaction.TransactionStatus;
import org.springframework.transaction.support.DefaultTransactionDefinition;

@Service
public class BookService {

    private final PlatformTransactionManager transactionManager;
    private final BookRepository bookRepository;

    public BookService(PlatformTransactionManager transactionManager, BookRepository bookRepository) {
        this.transactionManager = transactionManager;
        this.bookRepository = bookRepository;
    }

    public void doSomethingWithBook() {
        final DefaultTransactionDefinition transactionDefinition = new DefaultTransactionDefinition(TransactionDefinition.PROPAGATION_REQUIRES_NEW);
        TransactionStatus transaction = transactionManager.getTransaction(transactionDefinition);
        Book book = bookRepository.findFirst();
        // ....
        bookRepository.save(book);
        transactionManager.commit(transaction);
    }
} 
```

# objective-c - 椭圆形NSTextField？

> ID：11804239
> 
> 赞同：11
> 
> 时间：2012-08-03T22:42:10.060
> 
> 标签：objective-c, cocoa

有没有办法省略 NSTextField 的文本内容，而不是截断？

所以而不是：

```
The quick brown fox jumped over 
```

它会说：

```
The quick brown fox jumped ... 
```

我在文档中找不到任何内容。我错过了什么？

更新：有什么方法可以省略和自动换行 - 换句话说，有多行并省略最后一个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T23:53:01.147

所以这是一个很好的问题！即使它在 IB 中公开，它也不是视图或任何子视图上的属性。相反，它作为 NSTextField 使用的单元格上的属性被掩埋。因此，如果您向该对象询问其单元格，则可以读取或设置值：lineBreakMode。

在 NSCell 的类描述中查看所有选项 - truncateCenter 是一个（获取中心省略号）。

编辑：更新的问题提示了以下想法。就个人而言，我认为尝试获取该 google 代码过于矫枉过正，也许您可​​以通过创建一个迷你自定义 textField 来做一些不那么复杂的事情。

*   创建一个客户 NSView 对象并给它一个字符串和字体属性以及一些与以下操作相关的方法，甚至可能是一个宽度属性

*   本质上，这个想法是使用 Cocoa NSString 类别，它可以让您从字符串/字体组合中确定字符串的长度（可能还有它的高度）（我在 UIKit 中使用它，在 Cocoa 中确实使用了等价物，但已经有一段时间了.. .)

*   您的视图方法之一将是“计算”。当你得到这个时，将字符串转换为一个单词数组，使用单个空格作为分隔符（或使其更复杂）。然后，开始计算绘制字符串的长度，取第一个工作，附加一个空格和第二个，等等，直到你发现你已经超过了他的宽度。这是您的第一行字符串。

*   继续为要绘制的线数（2？3？）执行此操作。计算 unicode char 的长度... - 我记得它的选项分号 - 并保留它。

*   在最后一行中，继续添加单词直到超过长度，然后一次备份一个单词，验证最后附加的字符串字符串（减去尾随空格）但带有 '...' 字符是否适合空间。

*   您可以通过在边框周围添加填充等来使这个更漂亮。

*   一旦计算完成（当然你会缓存答案的所有位），当它得到'drawRect：...'时，你的视图就准备好了。您定位在 (0, bounds.size.height - 21) 并绘制第一段，然后向下移动 21 个点并绘制第二条线，依此类推。

如果我要编写这个代码，我会计划 2-4 小时 - 这不是微不足道的，也许逻辑有点复杂，但它很简单。祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T05:47:08.777

虽然在这个旧问题中不接受正确答案 - 滚动到最后一个答案 - 它包括代码[截断多行 NSTextField 的最后一行](https://stackoverflow.com/questions/11138786/truncate-the-last-line-of-multi-line-nstextfield/11721872#11721872)

该解决方案包括结合使用椭圆和换行。

# windows - 扩展和自定义性能监视器

> ID：11804241
> 
> 赞同：1
> 
> 时间：2012-08-03T22:42:57.643
> 
> 标签：windows, profiling, performance

.NET 有几个内置的 Perfmon，我想知道是否可以扩展其中一个内置的并添加自定义功能。

更具体地说，我想采用 RateOfCountsPerSecond32 并使其成为诸如 RateOfCountsPerMinute 之类的东西。基本上我希望能够监控在给定时间内发生的事件的平均数量，但超过一秒。

扩展正确的想法吗？如果是这样，是否有人有一个快速的语法示例来说明它是如何完成的？我已经读过它可以完成，但是关于这个主题的文档非常差。或者有没有更好的方法来完全解决这个问题，非常愿意接受建议。

谢谢你的帮助，

# linux - Ubuntu作为服务器？

> ID：11804244
> 
> 赞同：0
> 
> 时间：2012-08-03T22:43:32.747
> 
> 标签：linux, networking, ubuntu, webserver, ip

我已经在我的电脑上安装了最新的 Ubuntu (12.04)，当我这样做时`ifconfig`它会显示这个 IP `192.168.1.22`：.

我不想使用内部 ip，我想将它用作服务器。

但是，当我访问[www.whatismyip.com](http://www.whatismyip.com)网站时，它实际上显示的是我的 IP`27.82.XXX.XXX`

如何在我的电脑上获取此 IP，以便我可以将我的电脑用作服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T22:54:15.337

27.82.XXX.XXX IP 实际上是您的互联网路由器的全球 IP，而不是您的 PC/服务器。如果您希望能够使用该 IP 访问您的服务器，则需要将**适当**的端口从路由器转发到服务器的本地 IP (192.168.1.22)。例如，如果您想将其用作 Web 服务器，您可能需要转发端口 80 (HTTP) 和/或 443 (HTTPS)。或者，如果您需要 SSH 访问，请转发端口 22。 [这](http://www.howtogeek.com/66214/how-to-forward-ports-on-your-router/)是一个很好的指南，解释了如何做。

此外，除非您有来自互联网提供商的静态 IP，否则不要期望您的全球 IP 会保持不变。这就是[动态 DNS](http://en.wikipedia.org/wiki/Dynamic_DNS)的用武之地。它允许您分配一个主机名，即使 IP 更改，该主机名也始终指向您的服务器。我个人更喜欢[dnsdynamic.org](http://dnsdynamic.org/)，因为它简单、免费且不受限制。

# php - 如何将 localhost 添加到 php 正则表达式？

> ID：11804248
> 
> 赞同：0
> 
> 时间：2012-08-03T22:43:59.673
> 
> 标签：php, regex

我不知道如何编写正则表达式，但我需要使 localhost url 在我正在使用的程序之一中有效。这是程序用来验证 URL 的正则表达式：

```
preg_match ( '/^https?:\/\/(([a-z0-9-]+\.)+[a-z]{2,6}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(:[0-9]+)?(\/?|\/\S+)$/iu', $url ) 
```

我的本地网站的根 URL 是`http://localhost/`，如何使其验证？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T22:47:02.453

我看到你已经有了 IPv4 地址的选项，所以只是另一个选项`localhost`.

在`\d{1,3}`链之后，就在 之前`)`，添加`|localhost`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-03T22:47:05.943

我只是将 localhost 作为选项添加到模式的开头，所以它的开头看起来像这样：

```
preg_match('/^https?:\/\/(localhost|([a-z0-9-]+\.)+[a-z]{2,6} (the rest as before) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T22:49:17.360

正则表达式可以分成一些部分：

```
https?://
(
    ([a-z0-9-]+\.)+[a-z]{2,6}
    |\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}
)
(:[0-9]+)?
(/?|/\S+) 
```

为了将 localhost 添加到一组有效 url，只需`localhost|`在协议后面的两个左括号之间添加。

# html - 转换为存储过程

> ID：11804252
> 
> 赞同：0
> 
> 时间：2012-08-03T22:44:28.253
> 
> 标签：html, sql-server-2005, autocomplete

我目前有一个 jQuery Autocomplete 插件的查询字符串，但应该使用存储过程。谁能帮我转换？当我这样做时，它似乎不起作用。

原装 ASHX

```
public class Search_CS : IHttpHandler {

public void ProcessRequest (HttpContext context) {
    string prefixText = context.Request.QueryString["q"];
    using (SqlConnection conn = new SqlConnection())
    {
        conn.ConnectionString = ConfigurationManager
                .ConnectionStrings["Rollup2ConnectionString"].ConnectionString;
        using (SqlCommand cmd = new SqlCommand())
        {
            //cmd.CommandText = "select NUID from T_USER where " +
            //"NUID like @SearchText + '%'";
            cmd.CommandText = "select rtrim(NUID) NUID, rtrim(FNAME) FNAME, rtrim(LNAME) LNAME from T_USER where NUID like @SearchText + '%' OR FNAME like @SearchText + '%' OR LNAME like @SearchText + '%'"; 
            cmd.Parameters.AddWithValue("@SearchText", prefixText);
            cmd.Connection = conn;
            StringBuilder sb = new StringBuilder(); 
            conn.Open();
            using (SqlDataReader sdr = cmd.ExecuteReader())
            {
                while (sdr.Read())
                {
                    sb.Append(sdr["NUID"].ToString() + " ").Append(sdr["FNAME"].ToString() + " ").Append(sdr["LNAME"].ToString() + " ")
                        .Append(Environment.NewLine); 
                }
            }
            conn.Close();
            context.Response.Write(sb.ToString()); 
        }
    }
} 
```

用于存储过程的新 ASHX：

```
public class Search_CS : IHttpHandler {

public void ProcessRequest (HttpContext context) {
    string prefixText = context.Request.QueryString["q"];
    using (SqlConnection conn = new SqlConnection())
    {
        conn.ConnectionString = ConfigurationManager
                .ConnectionStrings["Rollup2ConnectionString"].ConnectionString;
        using (SqlCommand cmd = new SqlCommand())
        {
            //cmd.CommandText = "select NUID from T_USER where " +
            //"NUID like @SearchText + '%'";
            cmd.CommandText = "SP_AUTOCOMPLETE"; 
            cmd.Parameters.AddWithValue("@SearchText", prefixText);

            cmd.Parameters.Add(new SqlParameter("@SearchText", SqlDbType.VarChar));
            cmd.Parameters["@SearchText"].Value = prefixText;

            cmd.Connection = conn;
            StringBuilder sb = new StringBuilder(); 
            conn.Open();
            using (SqlDataReader sdr = cmd.ExecuteReader())
            {
                while (sdr.Read())
                {
                    sb.Append(sdr["NUID"].ToString() + " ").Append(sdr["FNAME"].ToString() + " ").Append(sdr["LNAME"].ToString() + " ")
                        .Append(Environment.NewLine); 
                }
            }
            conn.Close();
            context.Response.Write(sb.ToString()); 
        }
    }
} 
```

存储过程：

```
@SearchText VARCHAR(255)
AS
BEGIN

    SET NOCOUNT ON;
    SELECT RTRIM(NUID) NUID, RTRIM(FNAME) FNAME, RTRIM(LNAME) LNAME 
    FROM T_USER 
    WHERE NUID like @SearchText + '%' OR FNAME like @SearchText + '%' OR LNAME like @SearchText + '%' 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T22:52:47.460

您需要将 SqlCommand 'CommandType' 设置为 'CommandType.StoredProcedure'。

```
cmd.CommandType = CommandType.StoredProcedure; 
```

我还建议使用“sp_”以外的前缀。这就是 Microsoft 用于他们的系统过程的内容，您可能会不小心覆盖您想要保留的一个。:)

这就是我生成参数的方式：

```
public static SqlParameter GetParameter(string parameterName, object value, SqlDbType type, int size)
{
    if (value == null)
    {
        value = DBNull.Value;
    }

    if (size <= 0 && type == SqlDbType.VarChar)
    {
        switch (type)
        {
            case SqlDbType.VarChar:
                size = 8000;
                break;
            case SqlDbType.NVarChar:
                size = 4000;
                break;
        }
    }

    SqlParameter parameter = new SqlParameter(parameterName, type, size);
    parameter.Value = value;
    parameter.IsNullable = true;

    return parameter;
} 
```

而我就是这样做的。

```
cmd.Parameters.Add(GetParameter("@SearchText", searchText, SqlDbType.VarChar)); 
```

# dialog - Web 可访问性：将焦点转到除整个页面框架或页面上的第一个可聚焦元素之外的另一个元素是否有意义？

> ID：11804257
> 
> 赞同：1
> 
> 时间：2012-08-03T22:45:12.543
> 
> 标签：dialog, keyboard, focus, accessibility

我的问题是关于 Web 可访问性的焦点管理。当我们启动一个弹出/对话框时，出于可访问性的原因，焦点是否总是需要转到第一个可聚焦的元素，或者将焦点设置在我们认为用户更有可能想要使用的元素上是否可以接受？

例如，如果对话框以输入字段和取消链接开头，然后是下拉菜单，并且我们认为用户很可能希望在对话框加载时使用下拉菜单，是否可以将焦点设置在下拉元素上？在这种情况下，用户如何知道对话框中先前存在的可聚焦元素？但是，如果下拉菜单是对话框启动时 80% 的用户想要的位置，那么将焦点放在初始输入字段上没有多大意义......

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:24:50.860

根据我的研究和公众舆论：[http](http://webaim.org/discussion/mail_thread?thread=5435) : //webaim.org/discussion/mail_thread?thread=5435 似乎模态对话框/弹出窗口的重点取决于用例。例如，将焦点设置在 www.google.com 的搜索输入字段上是有意义的，尽管前面有用户可以与之交互的元素——这最大限度地提高了屏幕阅读器和仅键盘用户的可用性。但是，一般来说，焦点需要转到用户可以与之交互的第一个元素——取决于场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:36:03.823

我会告诫不要将焦点设置在第一个表单元素或引入表单的标题/内容之外的任何内容上。请参阅[WCAG 2.0 焦点顺序](http://www.w3.org/TR/UNDERSTANDING-WCAG20/navigation-mechanisms-focus-order.html)：

> 如果网页可以按顺序导航并且导航顺序影响意义或操作，则可聚焦组件以保留意义和可操作性的顺序接收焦点。（甲级）

虽然您提出的案例是我认为的边缘案例，但我认为焦点顺序规则仍然适用。如果您认为大多数用户都希望与 select 进行交互，为什么不将它放在表单的首位，而不是将焦点放在表单中间的元素上呢？

# c++ - gluUnProject 不工作

> ID：11804258
> 
> 赞同：1
> 
> 时间：2012-08-03T22:45:22.870
> 
> 标签：c++, opengl, glu

我正在尝试使用 gluUnProject 将鼠标坐标转换为世界坐标，但是它似乎不起作用，或者我只是误解了 glUnProject 函数的功能，这是我正在使用的代码，我的矩阵都检查得很好至于鼠标 x 坐标上的 -300，我使用的是 C++ Win32 对话框，而 ScreenToClient 给了我很时髦的结果。

```
 int appWidth  = CApplication::GetInstance()->GetWidth();
        int appHeight = CApplication::GetInstance()->GetHeight();
        float fAspect = (float)appWidth / (float)appHeight;

        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        gluPerspective(60.0f, fAspect, 0.1f, 100000.0f);

        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
        glTranslatef(m_vecCamera.x, -m_vecCamera.y, m_vecCamera.z);

        GLint viewport[4];
        GLdouble modelview[16];
        GLdouble projection[16];
        GLfloat winX, winY, winZ;
        GLdouble posX, posY, posZ;

        glEnable(GL_DEPTH);
        //Retrieve the Model/View, Projection, and Viewport Matrices
        glGetDoublev( GL_MODELVIEW_MATRIX, modelview );
        glGetDoublev( GL_PROJECTION_MATRIX, projection );
        glGetIntegerv( GL_VIEWPORT, viewport );

        //Retrieve the Mouse X and the flipped Mouse Y
        winX = (float)pInput->msg.param1-300.0f;
        winY = (float)viewport[3]-(float)pInput->msg.param2;
        glReadPixels( int(winX), int(winY), 1, 1, GL_DEPTH_COMPONENT, GL_FLOAT, &winZ );

        gluUnProject(winX, winY, winZ, modelview, projection, viewport, &posX, &posY, &posZ); 
```

然而，这给了我相对于屏幕中心的坐标，我假设是相对于我的相机，我也尝试实现自己的功能

```
Vector2f MouseUnProject(int x, int y)
{

        GLint viewport[4];
        GLdouble modelview[16];
        GLdouble projection[16];
        GLfloat winX, winY, winZ;
        GLdouble posX, posY, posZ;

        glEnable(GL_DEPTH);
        //Retrieve the Model/View, Projection, and Viewport Matrices
        glGetDoublev( GL_MODELVIEW_MATRIX, modelview );
        glGetDoublev( GL_PROJECTION_MATRIX, projection );
        glGetIntegerv( GL_VIEWPORT, viewport );

        //Retrieve the Mouse X and the flipped Mouse Y
        winX = (float)x;
        winY = (float)viewport[3]-y;
        glReadPixels( int(winX), int(winY), 1, 1, GL_DEPTH_COMPONENT, GL_FLOAT, &winZ );

        double projectionX, projectionY;
        double viewX, viewY;
        double worldX, worldY;

        //Convert from Screen Coords to Projection Coords
        projectionX = (double)winX / ((double)viewport[2]/2.0) - 1.0;
        projectionY = (double)winY / ((double)viewport[3]/2.0) + 1.0;

        //Convert from projection Coords to View Coords
        viewX = projectionX * modelview[14];
        viewY = projectionY * modelview[14];

        //Convert from View Coords to World Coords
        worldX = viewX + modelview[12];
        worldY = viewY - modelview[13];

        return Vector2f(worldX, worldY);

} 
```

它适用于特定的安装，但是当移动相机时，数字会立即下降一点，从投影到视图坐标的转换“似乎”没问题，投影坐标肯定很好。

我真的更喜欢使用 glUnProject 而不是我自己的函数，但我无法让它为我的生活工作，而且我发现的所有谷歌搜索似乎都没有回答我的问题。GL文档中的“对象空间”到底是什么意思，也许我对此的理解是错误的，如果是这样，我还需要做什么才能将我的坐标放在正确的空间中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-20T17:43:30.850

是在一年前发布的，但无论如何......所以你得到了相对于屏幕的坐标，因为你调用了 gluPerspective。此调用在内部调用 glfrustum，它将在 {-1, 1} 范围内生成归一化坐标。但是，如果您直接使用您的近/远值调用 glfrustum，您将在该范围内从 gluUnproject 获得结果。

要返回您的地图编辑器坐标，只需从 gluUnproject 获取结果并手动将范围转换回您的编辑器坐标系，即{-1,1} => {0, max}

要开始，您应该通过输入 (0,0), (midX, midY), (maxX, maxY) 来测试 gluUnProject，gluUnProject 的结果应该是 (-1, -1, depth), (0, 0, depth)和 (1, 1, 深度)。如果您使用 glFrustum 设置投影矩阵，则上述结果将在近/远范围内返回。

# java - 为复杂属性实现 Java 观察者模式的最佳方法

> ID：11804259
> 
> 赞同：4
> 
> 时间：2012-08-03T22:45:23.130
> 
> 标签：java, observer-pattern

我正在尝试使用 JDK Observer/Observable 实现观察者模式，但是我正在努力寻找在包含 bean 作为属性的 bean 上使用它的最佳方法。让我给你一个具体的例子：

我需要观察更改（在它的任何属性中）的主要 bean 是..

```
public class MainBean extends Observable {
    private String simpleProperty;
    private ChildBean complexProperty;
    ...
    public void setSimpleProperty {
        this.simpleProperty = simpleProperty;
        setChanged()
    }
} 
```

..但是，当我想为其中的任何内容设置新值时，`ChildBean`它不会触发 MainBean 中的任何更改：

```
...
mainBean.getComplexProperty().setSomeProperty("new value");
... 
```

我认为更明显的解决方案是也制作`ChildBean`一个 Observable，`MainBean`并将`ChildBean`. 但是，这意味着我需要在 上显式调用 notifyObservers `ChildBean`，如下所示：

```
...
mainBean.getComplexProperty().setSomeProperty("new value");
mainBean.getComplexProperty().notifyObservers();
mainBean.notifyObservers();
... 
```

我什至应该在 mainBean 上调用 notifyObservers() 吗？或者是否应该对 complexProperty 级联调用并触发 mainBean 中的 notifyObservers() 调用？

这是执行此操作的正确方法，还是有更简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T22:58:06.660

你的 Observables 需要在它们的任何属性发生变化时调用 notifyObservers。

在这个例子中：

mainBean 将是 Observable complexProperty 的 Observer。

complexProperty 必须在任何状态发生变化时调用 notifyObservers 。

如果 mainBean 也是一个 Observable，它的更新方法（它从 complexProperty 或任何其他成员 Observable 接收通知）将不得不调用 notifyObservers 以将此事件冒泡到结构中。

mainBean 不应该负责调用 complexProperty.notifyObservers。complexProperty 应该这样做。它应该只对自己调用 notifyObservers。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T22:56:36.393

如果您希望您在修改您的`MainBean`属性时做出反应，您*应该*将孩子设为. `ChildBean`*`Observable`*

 *然后，您`setSomeProperty(...)`应该在设置属性后 notifyObservers 。*

# php - CakePHP，使用 HABTM 表

> ID：11804264
> 
> 赞同：1
> 
> 时间：2012-08-03T22:46:06.473
> 
> 标签：php, mysql, database, cakephp, has-and-belongs-to-many

我正在使用 CakePHP 2.x，我想知道是否有任何内置功能可用于使用 HABTM 连接表。我真的没有在文档中看到任何直接更改 HABTM 关系属性的内容。这就是我的意思：

我有一个连接表，其中包含两个模型之间关系的标志，可以这样证明：

```
(int) id | (int) user_id | (int) video_id | (bool) hasRated | (bool) hasWatched | (bool) hasDownloaded 
```

第一列只是常规表 ID。接下来的两个（user_id 和 video_id）是用户表和视频表的典型 HABTM 外键。以下 3 个标志是两个模型之间关系的指标（此视频是否已观看？是否已评分？等）

我目前正在构建自己的查询，这是我的引导设置。我的最终目标是在两个模型的关系之间添加属性。这是解决这个问题的正确方法，还是有更Cakey的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T06:44:50.483

为了维护一个`HABTM`你可以维护连接表。连接表的蛋糕约定`HABTM`是：

> 这个新连接表的名称需要包含所涉及的两个模型的名称，按字母顺序排列，并用下划线 (_) 分隔。表的内容应该是两个字段，每个外键（应该是整数）指向所涉及模型的两个主键。为避免任何问题 - 不要为这两个字段定义组合主键，如果您的应用程序需要它，您可以定义唯一索引。如果您打算向该表添加任何额外信息，最好添加一个额外的主键字段（按照约定“id”），以使对表的操作与任何其他模型一样容易。

所以它对你来说似乎很好。但是您必须遵循命名约定。

有关更多详细信息，请参阅[文档](http://book.cakephp.org/1.3/view/1044/hasAndBelongsToMany-HABTM)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:14:55.110

尤里卡。

在 2.x 中，cake 会自动为您创建模型并识别关系。

`$this->Video->UserVideo`将生成一个适合 HABTM 连接表的模型`users_videos`。然后，您可以像常规模型一样与之交互，它将更新数据库。

# objective-c - 检查更新的 SQLite 数据库

> ID：11804265
> 
> 赞同：-2
> 
> 时间：2012-08-03T22:46:08.190
> 
> 标签：objective-c, ios, database, sqlite

更新我的应用程序时如何处理更新我的 SQLite 数据库文件。基本上当我更新时，数据库需要更新到。我考虑将一个表添加到具有数据库版本的数据库中，但我唯一关心的是如何从两个具有相同名称的数据库中读取数据。一个将是文档目录中的一个（旧的），而新的（具有相同名称的）将在 Main Bundle 中。它本身的应用程序不需要将任何用户首选项存储在数据库中，因此我不必担心过度写入用户数据。但该应用程序确实从 Internet 对数据库进行了更新，但这些最终将被合并到下一个版本中。有任何关于如何处理这个问题的提示吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-04T00:38:33.570

您可以使用“NSFileManager”将数据库从应用程序包复制到 Documents 目录中，然后再打开它。

# ruby - NoMethodError with 'sign_in' using Devise::TestHelpers

> ID：11804266
> 
> 赞同：1
> 
> 时间：2012-08-03T22:46:12.037
> 
> 标签：ruby, ruby-on-rails-3, devise, rspec2

我正在尝试让 Devise 的辅助方法适用于控制器规范。以下是相关代码：

```
# spec/spec_helper.rb
RSpec.configure do |config|
  # other config stuff ...
  config.include Devise::TestHelpers, :type => :controller
end

#spec/controllers/posts_controller_spec.rb
require 'spec_helper'

describe PostsController do

  describe "GET index" do

    admin = FactoryGirl.create(:admin)
    sign_in admin  # NoMethodError occurs
    it "does something..." do
    # etc etc etc
end 
```

您必须经过身份验证才能从该路由呈现模板，这就是我尝试登录管理员以便测试通过的原因。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:00:54.773

我认为 sign_in 方法必须在它的上下文中或在块之前使用。尝试：

```
before do
   admin = FactoryGirl.create(:admin)
   sign_in admin  # NoMethodError occurs
end 
```

# linux - 是否有一个 VNC 服务器在 Unix 域套接字而不是标准端口 (5900) 上进行侦听？

> ID：11804269
> 
> 赞同：-1
> 
> 时间：2012-08-03T22:46:31.653
> 
> 标签：linux, vnc

我正在尝试使用一个 vncserver（有很多变体。我什么都可以。）它侦听 Unix 域套接字而不是标准端口（5900）（即 Internet 域套接字）。我还没有找到任何支持它的版本。（我确实知道域套接字是什么，并且想在同一个盒子上使用服务器和客户端。奇怪的要求。）我已经得到了它的客户端。我修改了一个以支持我的要求。有谁知道任何支持此要求的 vnc 服务器？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-06-13T16:34:45.950

我怀疑[https://stackoverflow.com/a/2150188/20146](https://stackoverflow.com/a/2150188/20146)会起作用。

这里有一些额外的字符来安抚 StackOverflow，它坚持至少 30 :-|

# objective-c - setValue:forKey: 以什么顺序搜索符合 KVC 的方法或 ivar？

> ID：11804270
> 
> 赞同：1
> 
> 时间：2012-08-03T22:46:40.623
> 
> 标签：objective-c, ios, key-value-coding

一些背景：

我写了一个 UIScrollView 派生类，它有一个名为 contentView 的 outlet，类似于以下内容：

```
@interface MyScrollView : UIScrollView {
    IBOutlet UIView * contentView;
}

...

@end 
```

在这种情况下，我的出口是 iVar，而不是财产。我在 Interface builder 中使用了我的类并将视图连接到`contentView`插座。然而，在运行时，我发现我的 iVar 仍然是 nil 并且没有设置为所需的视图对象。

一些实验表明，如果我重命名插座或将插座设为属性而不是 iVar，一切都会正常工作。进一步的研究表明，使用我的插座作为名为 的 iVar `contentView`，加载 nib 实际上会将我想要的视图对象连接到 UIScrollView 中名为 的私有 iVar `_contentView`。

我知道 nib 加载使用 KVC 设置值，并且 KVC`setValue:forKey:`方法将使用以下任何一种设置值：

*   `set{Key}:`方法
*   `{key}`iVar
*   `_{key}`iVar

我怀疑但无法证明`set{Key}:`首先尝试找到该方法，如果失败，则进行 iVar 的枚举以找到下一个`{key}`或`_{key}`iVar。此枚举可能以从超类在子类之前处理 iVar 的顺序发生。

是否有记录上述候选人的顺序？与子类相关的超类成员的尝试顺序是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:15:23.787

具体的搜索算法记录在[Key-Value Coding Programming Guide](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/SearchImplementation.html)中。

# ruby-on-rails - 在 Ruby/Rails 代码块之间重 构这个 if else

> ID：11804271
> 
> 赞同：0
> 
> 时间：2012-08-03T22:46:41.543
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, refactoring, ruby-on-rails-3.2

这是代码。基本上，用户选择一个计费日（每月 1 日，或每月 15 日）。`start_date`是“合同”开始时，是`expire_date`到期时。

因此，如果今天是 3 号，并且他们想在 15 号结算，那么只需转到当月的 15 号。但是，如果今天是第 3 天，并且他们想在第 1 天计费，则获取下个月的第 1 天......等等。

```
if params[:billing_day] == 1 && start_date.day > 1
  expire_date = start_date.at_beginning_of_month.next_month
elsif params[:billing_day] == 15 && start_date.day < 15
  expire_date = start_date.change(:day => 15)
elsif params[:billing_day] == 15 && start_date.day > 15
  expire_date = start_date.at_beginning_of_month.next_month.change(:day => 15)
else
  expire_date = start_date.change(:day => params[:billing_day])
end 
```

这看起来很疯狂，当然它可以在 Rails 中简化。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:51:53.383

I would write something along the lines of

```
expire_date = start_date.change(:day => params[:billing_day])
if expire_date <= start_date
  expire_date += 1.month
end 
```

You'd need to validate that a valid billing day was picked before this

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:00:52.247

```
class ExpireDate

  def initialize(billing_day, start_date)
    @billing_day = billing_day
    @start_date = start_date
  end 

  def expires_on
    if billing_day == 1
      return billing_on_1st
    elsif billing_day == 15
      return billing_on_15th
    else
      raise "Unknown billing_day"
    end
  end

  def billing_on_1st
    if @start_date.day > 1
      return @start_date.at_beginning_of_month.next_month
    else
      return @start_date.change(:day => @billing_day)
    end
  end

  def billing_on_15th
    if @start_date.day < 15
      return @start_date.change(:day => 15)
    else
      return @start_date.at_beginning_of_month.next_month.change(:day => 15)
    end
  end
end

expire_date = ExpireDate.new(params[:billing_day], start_date).expires_on 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T23:46:00.097

想出了这个。但不确定这是不是好主意

```
expire_date = if params[:billing_day] == 1 && start_date.day > 1
  start_date.at_beginning_of_month.next_month
elsif params[:billing_day] == 15 && start_date.day < 15
  start_date.change(:day => 15)
elsif params[:billing_day] == 15 && start_date.day > 15
  start_date.at_beginning_of_month.next_month.change(:day => 15)
else
  start_date.change(:day => params[:billing_day])
end 
```

万一`params[:billing_day] == 15 && start_date.day == 15`呢？应该发生什么？

也想出了这个，但它的行为有点不同`start_date.day == 15`

```
expire_date = if params[:billing_day] == 1 && start_date.day > 1
  start_date.at_beginning_of_month.next_month
elsif params[:billing_day] == 15
    if start_date.day < 15
        start_date.change(:day => 15)
    else
        start_date.at_beginning_of_month.next_month.change(:day => 15)
    end
else
   start_date.change(:day => params[:billing_day])
end 
```

另请注意，在 Rails 中，将逻辑放入模型中是一种很好的做法，并且由于您使用的是 params[]，因此您是在控制器中执行此操作。

# c++ - 包装一个采用 char** [in/out] 的 C 函数调用，以在 cython 中返回一个 python 列表

> ID：11804284
> 
> 赞同：0
> 
> 时间：2012-08-03T22:47:42.493
> 
> 标签：c++, python, arrays, cython

**你如何包装一个需要预分配`char**`作为参数来存储结果的 C 函数调用？我正在尝试返回 python 列表结果。**

我找到了相反的例子，还有[这个 ctypes 例子](https://stackoverflow.com/questions/3494598/passing-a-list-of-strings-to-from-python-ctypes-to-c-function-expecting-char)，但我不完全确定 ctypes 是 cython 中的合适方法。

作为参考，我正在练习包装[openni](http://www.openni.org)库：
[http ://openni.org/Documentation/Reference/classxn_1_1_pose_detection_capability.html](http://openni.org/Documentation/Reference/classxn_1_1_pose_detection_capability.html)

我包装的原始 C 签名是（它实际上是一个 C++ 方法，只是在内部包装了一个 C 函数）：

```
/**
 * @brief Gets the names of all poses supported by this capability.

 * @param [out]     pstrPoses   Pre-allocated memory for the names of the supported poses.
 * @param [in,out]  nPoses      In input - size of the preallocated memory, in output
 *                              - the number of pose names.
 */

XnStatus GetAvailablePoses(XnChar** pstrPoses, XnUInt32& nPoses) const 
```

（`XnChar`只是一个 typedef `char`）

到目前为止，这是我的尝试，它崩溃了：

```
from libc.stdlib cimport malloc, free

def get_available_poses(self):
    cdef: 
        int i 
        bytes name 
        XnStatus stat
        XnUInt32 size = self.handle.GetNumberOfPoses()
        XnChar **buf = <XnChar**>malloc(size * sizeof(XnChar*))

    if not buf:
        raise MemoryError()

    try:
        # this crashes: Segmentation fault
        stat = self.handle.GetAvailablePoses(buf, size)

        # if I could get to here, I would want to 
        # build a list to return (not saying this is
            # even correct either)
        for i in range(size):
            name = <char*>(buf[i])
            ...

    finally:
        free(buf) 
```

该版本的 C 函数在技术上已被弃用，但较新的版本在我看来更可怕：

```
/**
 * Gets the names of all poses supported by this capability.

 * @param [out]     pstrPoses       Pre-allocated memory for the names of the supported poses.
 * @param [in]      nNameLength     Memory size for each pose name.
 * @param [in,out]  nPoses          In input - size of the preallocated memory, in output
 *                                  - the number of pose names.
 */

 XnStatus GetAllAvailablePoses(XnChar** pstrPoses, XnUInt32 nNameLength, 
                                XnUInt32& nPoses) const; 
```

理想情况下，如果我能弄清楚如何传入一个正确的`char**`并生成一个列表，我会使用新的，它还需要我指定分配的名称的长度。

**更新**：

我将这个问题简化为基本问题，以确保我一开始就做对了：

源代码：

```
//chars.h

void setChars(char** str_array, int size);

//chars.cc

#include "chars.h"

void setChars(char** str_array, int size) {
    for (int i = 0; i < size; i++) {
        char *s = "FOO";
        str_array[i] = s;
    }
} 
```

赛通：

```
#chars.pxd

cdef extern from "chars.h":
    void setChars(char**, int)

#chars.pyx

from libc.stdlib cimport malloc, free

def py_setChars():
    cdef: 
        bytes s
        int i
        int size = 6
        char** buf = <char**>malloc(size * sizeof(char*))

    if not buf:
        raise MemoryError()

    out = []

    try:
        setChars(buf, size)

        for i in range(size):
            s = buf[i]
            out.append(s)

    finally:
        free(buf)

    return out 
```

它按预期工作：

```
In [1]: import chars
In [2]: chars.py_setChars()
Out[2]: ['FOO', 'FOO', 'FOO', 'FOO', 'FOO', 'FOO'] 
```

我猜想`GetAllAvailablePoses()`我想使用的调用是期待某种我做得不对的预分配内存，因此参数要求每个字符的大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:43:54.200

玩够了我终于弄明白了。`GetAllAvailablePoses`确实希望您预先分配每个空间`char*`并告诉它要填充的空间有多大：

```
# foo.pxd

XnStatus GetAllAvailablePoses(XnChar **, XnUInt32, XnUInt32&)

# foo.pyx

def get_available_poses(self):
    cdef: 
        int i 
        bytes name 
        XnStatus stat
        XnUInt32 nameLength = 256
        XnUInt32 size = self.handle.GetNumberOfPoses()

    cdef XnChar **buf = <XnChar**>malloc(size * sizeof(XnChar*))

    if not buf:
        raise MemoryError()

    for i in range(size):
        buf[i] = <XnChar*>malloc(nameLength)

    out = [None]*size

    try:
        stat = self.handle.GetAllAvailablePoses(buf, nameLength, size)

        for i in range(size):
            name = <char*>buf[i]
            out[i] = name

    finally:
        free(buf)

    return out

# Out: ['Psi', 'CrossHandsPose', 'Wave', 'Click', 'RaiseHand', 'MovingHand'] 
```

# javascript - JavaScript - 在数组中设置包含变量的数组

> ID：11804285
> 
> 赞同：1
> 
> 时间：2012-08-03T22:47:59.547
> 
> 标签：javascript, arrays, variables

在设置数组时使用变量时，我通过一段脚本遇到错误。如果我只是用它们拥有的数值替换变量（我已经验证过），我不会收到错误消息。

设置这样的数组有什么问题吗？

```
arrayOfData = new Array(
            [leftAmount, 'Get', '#2697C9'],
            [middleAmount, 'Neutral', '#E7E7E7'],
            [rightAmount, 'Don\'t Get', '#EB5830']
        ); 
```

如果有帮助，您可以查看整个功能

```
function generateChart(viewerObj){

        if(viewerObj.getActiveUsers){
            var leftAmount = viewerObj.getActiveUsers;
        }
        else{
            window.leftAmount = 0;
        }
        if(viewerObj.getActiveUsers){
            var middleAmount = viewerObj.getActiveUsers;
        }
        else{
            var middleAmount = 0;
        }
        if(viewerObj.dontGetActiveUsers){
            var rightAmount = viewerObj.dontGetActiveUsers;
        }
        else{
            var rightAmount = 0;
        }

        arrayOfData = new Array(
            [leftAmount, 'Get', '#2697C9'],
            [middleAmount, 'Neutral', '#E7E7E7'],
            [rightAmount, 'Don\'t Get', '#EB5830']
        );

        $('.divGraph').jqBarGraph({ data: arrayOfData }); 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:03:57.253

我能看到的唯一潜在问题是大多数时候你有......

```
var variable_name 
```

...在`if`和`else`中，但有一次你有这个...

```
if(viewerObj.getActiveUsers){
    var leftAmount = viewerObj.getActiveUsers;
}
else{
    window.leftAmount = 0;
} 
```

...因此，当`if`条件失败时，本地`leftAmount`将是`undefined`，并且将遮蔽`leftAmount`具有`0`值的全局。

我猜想无论您在哪里使用该数组，它都不`undefined`喜欢`0`.

* * *

更改`window.leftAmount`为`var leftAmount`或更好，将您的变量声明移动到函数的顶部。

```
function generateChart(viewerObj){
    var leftAmount = 0, middleAmount = 0, rightAmount = 0;

    if(viewerObj.getActiveUsers)
        leftAmount = viewerObj.getActiveUsers;

    if(viewerObj.getActiveUsers)
        middleAmount = viewerObj.getActiveUsers;

    if(viewerObj.dontGetActiveUsers)
        rightAmount = viewerObj.dontGetActiveUsers;

    arrayOfData = new Array(
        [leftAmount, 'Get', '#2697C9'],
        [middleAmount, 'Neutral', '#E7E7E7'],
        [rightAmount, 'Don\'t Get', '#EB5830']
    );

    $('.divGraph').jqBarGraph({ data: arrayOfData }); 
} 
```

* * *

这里我也在顶部设置了默认初始化。如果您愿意，可以将其移回`else`，或者您可以使用条件运算符...

```
rightAmount = viewerObj.dontGetActiveUsers ? viewerObj.dontGetActiveUsers : 0; 
```

或者，由于您正在进行基本的真假测试，您可以这样做......

```
rightAmount = viewerObj.dontGetActiveUsers || 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:09:50.550

我能发现的唯一奇怪之处是您使用`window.leftAmount`. 你为什么这么写？如果`viewerObj.getActiveUsers`现在不真实，则局部变量`leftAmount`将为`undefined`.

[`OR`但是，您可以使用运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Logical_Operators)而不是各种 if 子句来大大缩短脚本（[它是如何工作](https://stackoverflow.com/q/2100758/1048572)的）：

```
var arrayOfData = [
  [viewerObj.getActiveUsers || 0, 'Get', '#2697C9'],
  [viewerObj.getActiveUsers || 0, 'Neutral', '#E7E7E7'],
  [viewerObj.dontGetActiveUsers || 0, 'Don\'t Get', '#EB5830']
];

$('.divGraph').jqBarGraph({ data: arrayOfData }); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-03T23:08:38.670

您正在使用`var`将这些变量的范围限制为 if/else 块，然后尝试使用该范围之外的变量，这会导致它们未定义。我建议在您尝试使用它们的同一范围内声明变量。

```
function generateChart(viewerObj){

        var leftAmount = 0, middleAmount = 0, rightAmount = 0; // declare variables in this scope.

        if(viewerObj.getActiveUsers){
           leftAmount = middleAmount = viewerObj.getActiveUsers;
        }

        if(viewerObj.dontGetActiveUsers){
           rightAmount = viewerObj.dontGetActiveUsers;
        }

        arrayOfData = new Array(
            [leftAmount, 'Get', '#2697C9'],
            [middleAmount, 'Neutral', '#E7E7E7'],
            [rightAmount, 'Don\'t Get', '#EB5830']
        );

        $('.divGraph').jqBarGraph({ data: arrayOfData }); 
    } 
```

# django - 在 django admin 中显示带有可编辑 = False 的 DateTimeField

> ID：11804287
> 
> 赞同：0
> 
> 时间：2012-08-03T22:48:11.043
> 
> 标签：django, django-admin

我有日期字段`editable=False`。

`datetime.now()`该字段在创建时填充。

由于管理员不会显示`editable=False`字段，我创建了一个自定义管理员。

自定义管理员使用带有此字段的表单：

```
date = forms.DateTimeField(widget=widgets.AdminSplitDateTime, required=False) 
```

我想要实现的是：

1.  用户将无法触摸此字段（因此，`editable=False`）
2.  管理员将能够更改字段的值，但不会被迫（这就是为什么我有`required=False`）
3.  管理员将能够看到该字段的当前值。

我没有达到（3）。我创建了一个条目，当我查看数据库时，我发现它有一个有效的日期。但是当我从管理面板打开它时，日期小部件是空的。

任何想法如何使日期小部件显示字段的当前值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T05:41:21.897

首先，在 Admin 中默认`models.DateTimeField`使用`widgets.AdminSplitDateTime`，您不必明确指定它。

对于普通员工，用于[`readonly_fields`](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.readonly_fields)防止日期字段被更改。

对于管理员，呈现不同的更改表单以允许对日期字段进行修改。在 Django 1.4 中，可以通过覆盖来轻松完成[`ModelAdmin.get_readonly_fields()`](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.get_readonly_fields)：

```
class YourModelAdmin(admin.ModelAdmin):
    def get_readonly_fields(self, request, obj=None):
        # we don't use self.readonly_fields anymore
        if request.user.is_superuser:
            return ()
        return ['date'] 
```

# facebook - 新定义的操作类型未显示在我自己的新闻提要中

> ID：11804293
> 
> 赞同：1
> 
> 时间：2012-08-03T22:48:55.147
> 
> 标签：facebook, facebook-graph-api

我为我的 Facebook 应用程序创建了一个新的操作类型。我按照 Facebook 教程中的说明进行操作：

[http://developers.facebook.com/docs/opengraph/tutorial][1]

我已经成功设置了所有内容，包括每个帖子包含所有元标记的页面等。事实上，当我从我的 Facebook 应用程序发布操作时，我可以在我的活动日志中看到该操作。

但是，它没有出现在我自己的新闻源或我自己的墙上。

我可以做些什么来调试正在发生的事情吗？

# sql-server - SqlServer 错误 HY000：使用 varbinary(max) 字段中超过 400 KB 的对象调用 SQLPutData 时部分插入/更新

> ID：11804300
> 
> 赞同：3
> 
> 时间：2012-08-03T22:49:52.713
> 
> 标签：sql-server, blob, sqlbindparameter

当我尝试在 varbinary(max) 列中保存大于 400KB 的对象时，我遇到了一个大问题，从 C++ 调用 ODBC。

这是我调用 SqlPrepare、SQLBindParameter、SQLExecute、SQLPutData（最后一个不同时间）的基本工作流程：

**SqlPrepare**：
StatementHandle 0x019141f0
StatementText“更新 DT460 SET DI024543 = ？，DI024541 = ？，DI024542 =？哪里DI006397 =？和DI008098 =？”
文本长度 93

第一个参数（BLOB 字段）的绑定：
**SQLBindParameter**：
StatementHandle 0x019141f0
ParameterNumber 1
InputOutputType 1
ValueType -2 (SQL_C_BINARY)
ParameterType -4 (SQL_LONGVARBINARY)
ColumnSize 427078
DecimalDigits 0
ParameterValPtr 1
BufferLength 4
StrLenOrIndPtr -427178 (27_LEN_8的结果)

**SQLExecute**：
语句句柄 0x019141f0

尝试通过多次调用 SQLPutData 以 32K 的块保存 blob：
**SQLPutData** :
StatementHandle 0x019141f0
具有 32768 个字符的 std::vector 的 DataPtr 地址
StrLen_or_Ind 32768

在使用前 32KB 数据的第一个 SQLPutData 操作期间，我收到以下 SQL Server 错误：
*[HY000][Microsoft][ODBC SQL Server Driver]Warning: Partial insert/update。文本或图像列的插入/更新未成功。*
当我尝试保存大小超过 400KB 的对象时，总是会发生这种情况。保存小于 400KB 的内容就可以了。
我发现关键参数是 SQLBindParemter 的 ColumSize。SQLBindParameter 期间的参数 StrLenOrIndPtr 可以具有较低的值（如 32K），它仍然会导致相同的错误。
但是根据 SQL Server API，我不明白为什么只要我用小于 32KB 的数据块调用 SQLPutData 就会有问题。

有谁知道问题可能是什么？
任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T11:57:29.240

好的，我刚刚发现这实际上是一个 sql 驱动程序问题！安装最新版本的 Microsoft® SQL Server® 2012 Native Client（来自[http://www.microsoft.com/de-de/download/details.aspx?id=29065](http://www.microsoft.com/de-de/download/details.aspx?id=29065)）后，保存更大的 BLOB 可以使用这些参数以上。

# asp.net - 即使使用正确的 Accepts 标头，WebAPI 也不会返回 XML

> ID：11804301
> 
> 赞同：32
> 
> 时间：2012-08-03T22:50:02.563
> 
> 标签：asp.net, asp.net-web-api

我正在使用 ASP.NET WebAPI RC，并托管了一个 API 控制器，对此毫无兴趣。一切都适用于 JSON，但我正在测试使用 Accepts 标头请求不同的格式，这就是我遇到问题的地方。

我正在使用 jQuery 发出 AJAX 请求，并设置请求的“dataType”参数。这会正确设置适当的 Accept 标头，如下所示。

```
$.ajax({
    type: method,
    url: url,
    dataType: "xml",
    data: data || null,
    success: function (data) {
        // omitted
    }
}); 
```

这是提琴手请求/响应的保存。如您所见，Accept 标头显示 application/xml，但 WebAPI 返回 JSON。我还尝试手动将 Accept 标头设置为“application/xml”（因此它也没有 text/html 内容），但无济于事。

我到底错过了什么？（注意：我在数据中*剪掉*了一些机密信息，但没有进行其他调整）

```
GET http://localhost/insp**snip**6716 HTTP/1.1
Host: localhost
Connection: keep-alive
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.60 Safari/537.1
Accept: application/xml, text/xml, */*; q=0.01
Referer: http://localhost/inspector/api/test?
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: m=34e2:|2c69:t|47ba:t|4e99:t; .INSPECTOR3COOKIE=08BA683091E2A457B1832E9B*snip*F911D9ED97076

HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: application/json; charset=utf-8
Expires: -1
Server: Microsoft-IIS/7.5
X-AspNet-Version: 4.0.30319
Persistent-Auth: true
X-Powered-By: ASP.NET
Date: Fri, 03 Aug 2012 22:27:42 GMT
Content-Length: 1816

{"Id":2416716,"ProjectId":36,"Url":"http://ins *snip, but obviously this is JSON not XML * 
```

我想指出我没有调整 AppStart 中的任何格式化程序或任何东西，据我所知，默认情况下应该启用 JSON 和 XML 格式化程序。

**更新：**我想通了——在下面查看我自己的答案

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-03T23:00:49.080

我想到了！

我在我的 AppStart 中有这个，因为我想要 Xml 序列化程序而不是 DataContract 序列化程序：

```
GlobalConfiguration.Configuration.Formatters.XmlFormatter.UseXmlSerializer = true; 
```

但是......显然我的模型有一些东西让 Xml 序列化器认为它不能序列化它。我猜这导致 WebAPI 决定使用 JSON 格式化程序。

这种看似无害的设置实际上会影响使用哪种格式化程序，这完全是不直观的。希望 WebAPI 的人看到这一点 :)

某种工具可以让您了解内容协商过程的输入和输出，以便您可以调试这样的问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-07-17T14:06:32.503

我有同样的问题，但通过向我返回的所有模型添加默认构造函数来修复它。

XML 序列化程序创建空白模型对象，然后通过属性上的设置器填充它。如果设置器是受保护的或私有的，那么该属性也不会被序列化

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-08-04T05:14:57.617

该线程中的当前答案已经说明了很多原因，但总结一下，XmlSerializer 仅支持有限数量的类型。

在寻找“最佳”格式化程序时，AASoft 正确描述的 DefaultContentNegotiator 会询问每个格式化程序是否可以支持特定类型。然后它将这些格式化程序与请求中的接受标头进行匹配。

如果它没有根据接受标头找到任何匹配项，那么它会选择第一个可以序列化类型的匹配项，在本例中是 JSON 格式化程序。但是，您可以将 DefaultContentNegotiator 配置为不返回默认格式，而是返回 406 None Accepted 状态代码。这向客户端表明找不到匹配的表示，而不是发送客户端可能无法使用的数据，而是生成错误响应。

在“内容协商改进”部分下的博客“ASP.NET Web API 更新 – 5 月 14 日”[1] 中描述了设置此选项。

希望这可以帮助，

亨里克

[1] [http://blogs.msdn.com/b/henrikn/archive/2012/05/14/asp-net-web-api-updates-may-14.aspx](http://blogs.msdn.com/b/henrikn/archive/2012/05/14/asp-net-web-api-updates-may-14.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-09-02T00:09:57.530

答案已经提供，但我想我会把我的发现放在后面，以便对以后来的人有所帮助。

罪魁祸首是 IEnumerable。例如，返回包含 IEnumerable 并且永远不会返回 XML 的类 Album 的对象 - 只有 JSON。

我用了

```
GlobalConfiguration.Configuration.Formatters.XmlFormatter.UseXmlSerializer = true; 
```

在 Global.asax 中也是如此。这实际上是 xml 返回所必需的。我仍然没有得到 XML。

然后我将 IEnumerable 更改为 List 并且效果很好。看起来 Web API 中的 XML 格式化程序无法处理返回对象中的 IEnumerable。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-08-02T15:03:49.700

就像对此的后续行动。当我们的返回模型中有一个对象列表但列表中的对象没有无参数构造函数时，我们遇到了这个问题。我们的代码如下所示：

```
public class ReturnClass
{
    public int Value { get; set; }

    public List<OtherClass> ListOfThings { get; set; }
}

public class OtherClass 
{
    public int OtherValue { get; set; }

    public OtherClass(OtherObject o) 
    {
       this.OtherValue = o.OtherValue;
    }  
} 
```

我们只需要为 SubClass 对象添加一个无参数的构造函数。

```
public class ReturnClass
{
    public int Value { get; set; }

    public List<OtherClass> ListOfThings { get; set; }
}

public class OtherClass 
{
    public int OtherValue { get; set; }

    public OtherClass(OtherObject o) 
    {
       this.OtherValue = o.OtherValue;
    }

    public OtherClass()
    {
    }

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-13T02:50:12.600

对于您可能正在序列化的任何属性，请小心使用可为空的 int。`config.Formatters.XmlFormatter.UseXmlSerializer = true`无论您的接受标头说什么，带有 set 的可为空的 int将导致 Web API 返回 JSON

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-09T19:40:40.803

我只想添加一个可能发生这种情况的原因，即具有内部获取或设置的属性。当您通过按 Ctrl- 向类添加属性时由​​ VS 生成的类型。

像`public string Foo {get; internal set;}`

# objective-c - 沙盒 Mac 应用程序可以在哪里保存文件？

> ID：11804309
> 
> 赞同：29
> 
> 时间：2012-08-03T22:51:33.337
> 
> 标签：objective-c, macos, cocoa

我的 Mac 应用程序是沙盒的，我需要保存一个文件。我在哪里保存这个文件？如果不使用打开的面板，我似乎无法找到允许这样做的特定位置。这就是我在 iOS 上的做法：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *path = [paths objectAtIndex:0]; 
```

Mac 上沙盒目录的等价物是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-03T23:33:00.807

无论您的应用程序是否被沙盒化，该代码片段都可以在 Mac 上运行。

在非沙盒 Mac 应用程序中，`path`将引用您家中的 Documents 文件夹：例如`/Users/username/Documents`.

在沙盒应用中，它指的是应用沙盒中的一个文件夹：例如`/Users/username/Library/Containers/com.yourcompany.YourApp/Documents`

有关详细信息，请参阅[文档](https://developer.apple.com/library/mac/documentation/Security/Conceptual/AppSandboxDesignGuide/AppSandboxInDepth/AppSandboxInDepth.html#//apple_ref/doc/uid/TP40011183-CH3-SW15)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-03T23:32:10.370

Apple 的沙盒指南非常有用，可在[此处](http://developer.apple.com/library/mac/documentation/Security/Conceptual/AppSandboxDesignGuide/AppSandboxDesignGuide.pdf)找到。

正如 theAmateurProgrammer 在[此处](https://stackoverflow.com/questions/10169223/storing-downloaded-files-in-cocoa)回答我的问题时所述，您基本上有一个专用于您的应用程序的文件夹。

> ~/Library/Container/com.yourcompany.yourappname/

这是我目前所拥有的，稍后我会改进它：

```
//Create App directory if not exists:
NSFileManager* fileManager = [[NSFileManager alloc] init];
NSString* bundleID = [[NSBundle mainBundle] bundleIdentifier];
NSArray* urlPaths = [fileManager URLsForDirectory:NSApplicationSupportDirectory 
                                        inDomains:NSUserDomainMask];

NSURL* appDirectory = [[urlPaths objectAtIndex:0] URLByAppendingPathComponent:bundleID isDirectory:YES];

//TODO: handle the error
if (![fileManager fileExistsAtPath:[appDirectory path]]) {
    [fileManager createDirectoryAtURL:appDirectory withIntermediateDirectories:NO attributes:nil error:nil];
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-10-21T19:00:28.567

将@Mazyod 的答案转换为**Swift (5.1)**：

```
var appPath: URL? {
    //Create App directory if not exists:
    let fileManager = FileManager()
    let urlPaths = fileManager.urls(for: .applicationSupportDirectory, in: .userDomainMask)
    if let bundleID = Bundle.main.bundleIdentifier, let appDirectory = urlPaths.first?.appendingPathComponent(bundleID,isDirectory: true) {
        var objCTrue: ObjCBool = true
        let path = appDirectory.path
        if !fileManager.fileExists(atPath: path,isDirectory: &objCTrue) {
            do {
                try fileManager.createDirectory(atPath: path, withIntermediateDirectories: true, attributes: nil)
            } catch {
                return nil
            }
        }
        return appDirectory
    }
    return nil
} 
```

但是，目录已更改，我不确定是否需要额外重复捆绑 ID，因为路径是

```
"/Users/**user name**/Library/Containers/**bundleID**/Data/Library/Application Support/**bundleID**". 
```

但它似乎工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-07-10T09:32:59.520

是更容易。对于 macOS 上的沙盒应用程序，该功能`NSHomeDirectory`为您提供了具有读写访问权限并可以保存所有文件的路径。这将是一条这样的道路

```
/Users/username/Library/Containers/com.yourcompany.YourApp 
```

# asp.net-web-api - WebAPI GET 可选整数参数

> ID：11804314
> 
> 赞同：0
> 
> 时间：2012-08-03T22:52:41.357
> 
> 标签：asp.net-web-api, asp.net-routing

有人可以用我的 webapi GET 方法帮我填空吗？我想不传入任何参数并获得所有结果。传入一个 int 并获得一个结果并传入一个命名参数以按 typeId / zoneId 或两者进行过滤，但我正在努力让它工作。

```
TimeController : ApiController

// Time/  

//Time/1

//Time/typeId=1

//Time/zoneId=1

Time/typeId=1&zoneId=1 
```

我得到的最接近的是

全球的

```
 RouteTable.Routes.MapHttpRoute(name: "DefaultApi",
           routeTemplate: "api/{controller}/{id}",
           defaults: new { id = System.Web.Http.RouteParameter.Optional}
           );

        RouteTable.Routes.MapHttpRoute(name: "TemplateTimeApi",
           routeTemplate: "api/{controller}/{typeId}/{zoneId}",
           defaults: new {typeId = RouteParameter.Optional, zoneId = RouteParameter.Optional }
           ); 
```

控制器

```
 List<TimeView> Get(int typeId, int? zoneId = null)

 TimeView Get(int id) 
```

但我在没有参数的情况下得到 404。

如果问题与两个整数有关，我可以将其中一个参数更改为字符串，但是，我更愿意理解问题并让它发挥作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T07:08:10.870

> // 时间/

如果你看一下你的路由表：第一个路由匹配，但是你没有没有参数 => 404 抛出的动作。

> //时间/1

运行正确，第一个路由匹配，在这里，它选择操作： TimeView Get(int id) 因为名称：路由上的 id 匹配参数“id”使用此方法。请记住，Web API 很大程度上基于命名约定。

> //时间/typeId=1
> 
> //时间/zoneId=1

错误的 URL => 404 抛出，我猜你想作为查询字符串，应该是： Time?typeId=1 但即使是错误的，因为第一个路由匹配参数“Id”，而不是“typeId”，所以没有动作方法找到了。

> 时间/typeId=1&zoneId=1

网址也错了，同上。

您应该拥有的正确 URL：GET Time/1/1 将与您的第二条路线匹配。

有关路由和操作的更多理解： [http ://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-and-action-selection](http://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-and-action-selection)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T05:08:21.163

如果您想将 typeId 和 zoneId 作为查询字符串参数传递，您的 URI 应该是：

/时间?typeId=1

/时间?zoneId=1

...在这种情况下，您不需要路由模板中的 typeId 和 zoneId 。

另一方面，如果您希望它们作为 URI 段（这是您的“TemplateTimeApi”路由显示的内容），那么您的 URI 应该是：

/时间/1/1

使用第二个选项，您必须在 URI 中包含两个参数才能触发路由，因为像“/Time/1”这样的 URI 将匹配“DefaultApi”路由。

# django - 如何使用“包含”模板标签传递布尔关键字参数

> ID：11804315
> 
> 赞同：12
> 
> 时间：2012-08-03T22:52:43.527
> 
> 标签：django, django-templates

```
{% include "example.html" with name="John" hide_last_name=True %} 
```

基本上，我试图在我的主模板中包含“example.html”作为子模板。附加上下文是通过传递关键字参数`name`和`hide_last_name`. 虽然 django 模板系统可以毫无问题地识别`name`，但它就是无法识别`hide_last_name`。我怀疑现在允许在标签中使用布尔关键字参数，`Include`但是我在官方文档中找不到任何地方提到这一点。请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-12T10:36:48.210

**对于 Django <= 1.4.x**

如前所述，Django 试图找到一个名为“True”的变量。处理这个问题的最简单方法是使用一个整数值，它不会被计算。

您可以在包含器模板中编写

```
{% include "example.html" with show_last_name=1 %} 
```

并在包含的模板中

```
John
{% if show_last_name %}
    Doe
{% endif %} 
```

**对于 Django >= 1.5**

您可以在模板中使用 True 和 False，因此这不再是问题

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-04T04:20:23.260

**更新：**这个答案适用于旧版本的 Django。对于 Django >=1.5，请参见[下面的答案](https://stackoverflow.com/a/13837828/1526703)

Django 模板会将 视为`True`变量并尝试在上下文中找到它。
您可以使用非空字符串来表示真值或将真值分配给`True`上下文，例如通过`TEMPLATE_CONTEXT_PROCESSORS`：

```
def common_vars(request):
    return {
        'True': True,
        'False': False,
        'newline': '\n',
        ...
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-13T07:08:19.377

在 django 1.5 中，您可以根据[发行说明](https://docs.djangoproject.com/en/dev/releases/1.5/#minor-features)在 django 模板中使用 True 。

如果您正在使用早期版本，则必须按照@okm 的建议进行操作！

# linux - bash 脚本：网站中出现的单词

> ID：11804318
> 
> 赞同：0
> 
> 时间：2012-08-03T22:53:30.580
> 
> 标签：linux, bash, shell, dns

我需要制作一个脚本来计算网页上出现的单词

我正在做的是计算随机IP（避免多次检查相同的ip），使用nmap查看端口80是否打开以了解它是否是Web服务器，然后我使用w3m将http页面作为文件。在它很容易计算单词出现之后

我有几个问题和问题

*   这个过程需要很多，但我想不出任何方法可以让它更快
*   许多开放了 80 端口的 ip 不是网站，它们没有启动并且可能有一些问题，有没有办法只检查启动的站点？
*   这种方法只检查网站索引页面中出现的单词，有没有办法同时检查其他公共页面？

多谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-12T06:03:26.030

我用 awk 做类似的事情。awk 非常适合文本解析。我所做的是分析在 Apache 日志中每个 IP 地址完成了多少 HTTP GET。所以像你这样的机器人很容易出现在我的统计数据中：P 使用 awk，我的性能优于我所有同事在 PHP、Ruby 和 bash 脚本中提出的所有解决方案。

问题是您没有为每个文件（或页面）生成统计信息。您正在总结所有结果，对吗？所以我会使用 SQLite 来跟踪一个单词在所有扫描文本中出现的次数。使用 shell 脚本在 SQLite 中添加数据很容易（而且很快）。

此外，您应该使用 wget --spider 或其他蜘蛛 HTTP 客户端，因为它们不仅会从索引页面下载内容，还会从第一页中包含链接 (HREF) 的所有页面下载内容。因此，您可以递归地扫描网站。

# c++ - OpenGL/GLM - 切换坐标系方向

> ID：11804321
> 
> 赞同：1
> 
> 时间：2012-08-03T22:54:02.560
> 
> 标签：c++, math, opengl

我正在转换一些旧软件以支持 OpenGL。DirectX 和 OpenGL 有不同的坐标系（OpenGL 在右边，DirectX 在左边）。我知道在旧的固定管道功能中，我会使用：

```
glScalef(1.0f, 1.0f, -1.0f); 
```

这一次，我正在使用 GLM 和着色器，需要一个兼容的解决方案。我尝试将我的相机矩阵乘以缩放向量，但没有成功。

这是我的相机设置：

```
// Calculate the direction, right and up vectors
 direction = glm::vec3(cos(anglePitch) * sin(angleYaw), sin(anglePitch), cos(anglePitch) * cos(angleYaw));
 right = glm::vec3(sin(angleYaw - 3.14f/2.0f), 0, cos(angleYaw - 3.14f/2.0f));
 up = glm::cross(right, direction);

 // Update our camera matrix, projection matrix and combine them into my view matrix
 cameraMatrix = glm::lookAt(position, position+direction, up);
 projectionMatrix = glm::perspective(50.0f, 4.0f / 3.0f, 0.1f, 1000.f);
 viewMatrix = projectionMatrix * cameraMatrix; 
```

我尝试了很多方法，包括反转向量和反转着色器中的 z 坐标。我还尝试乘以各种矩阵和向量的逆，并将相机矩阵乘以缩放向量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T23:12:58.197

不要过多地考虑惯用手。确实，它们使用不同的约定，但您可以选择不使用它们，归结为两种 API 中几乎相同的东西。我的建议是在两个 API 中使用完全相同的矩阵和设置，除了以下两点：

从 DX 移植到 GL 所需要做的就是：

1.  反转剔除面缠绕 - 默认情况下 DX 逆时针剔除，而这正是 GL 保留的。
2.  针对不同的深度范围进行调整：DX 使用 0（近）到 1（远）的深度范围，而 GL 使用 -1 表示近，1 表示远的有符号范围。您可以将其作为投影矩阵中的“最后一步”。

DX9 也有像素坐标偏移的问题，但这完全是另外一回事，DX10 以后不再是问题。

根据您的描述，缠绕可能是您的问题，因为您正在使用 GLM 函数来生成对 OpenGL 来说应该没问题的矩阵。

# solr - 如何在 Solr 3.6 中对两个字段进行排序

> ID：11804322
> 
> 赞同：15
> 
> 时间：2012-08-03T22:54:05.503
> 
> 标签：solr

在 Web 请求 URL 中有一个“排序”选项。但是，我如何按两个字段排序？如果我这样做：

```
 sort=field1 asc&sort=field2 desc 
```

只有第一个字段将用于对我的观察进行排序。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-04T05:54:34.167

你这样做：

```
sort=field1 asc, field2 desc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-10T13:17:53.940

SOLR(3.6.2) 但是如果你想对额外的**intField**和*'score'*
进行排序， 试着搜索而不是：

```
sort=score desc,intField desc 
```

这个：

```
sort=intField desc,score desc 
```

# google-apps-script - Google App Script HtmlService Form如何改变页面中div的innerHtml

> ID：11804326
> 
> 赞同：0
> 
> 时间：2012-08-03T22:54:09.940
> 
> 标签：google-apps-script

我有一个使用 Google App Script 创建的表单。它真的很棒，因为它让我可以创建一个可以以任何方式成型的表单，并且不受谷歌表单的限制。但是我现在很难弄清楚如何运行脚本以在提交表单时使用表单操作来操作 div 的 innerHTML。有人可以帮我解决这个问题或提出解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T15:34:35.507

这应该是标准的 JavaScript。HtmlService 的好处是，你可以在 jQuery 中做的任何事情，你都应该可以在 JavaScript 中做。有一些限制适用，因为我们需要将[Caja](http://code.google.com/p/google-caja/)应用于 JavaScript 沙箱，这样它是安全的，但这不应该干扰你正在做的事情。

你想要做的是：

1.  将 onClick 处理程序附加到提交按钮。从此函数返回 false，因此它不会执行 HTTP POST/GET。

2.  在 onClick 函数中，使用 jQuery 函数找到要填充的 div 元素并用数据填充它。

如果你还没有学过的话，我强烈推荐 John Resig 的[jQuery 教程。](http://docs.jquery.com/Tutorials%3aHow_jQuery_Works)

# css - 使用 img 获取两列 div 表以防止溢出的问题

> ID：11804329
> 
> 赞同：0
> 
> 时间：2012-08-03T22:54:20.093
> 
> 标签：css

我正在尝试创建一个列表，两个项目宽，但有很多。div 里面是一个图像，即使我告诉它不要，这个图像似乎也会溢出 div。一个例子可以在[这里](http://jsfiddle.net/aRZct/)找到。

有人可以帮我按照我想要的方式格式化吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:00:16.243

将`overflow`属性设置为`hidden`将防止`div`内容溢出：

```
.catalogentry {
    overflow: hidden;
} 
```

[http://jsfiddle.net/6XXrp/](http://jsfiddle.net/6XXrp/)

*根据您的评论：*

然后你需要做的是将每个包装`img`在一个 中`div`，比如 class `contain`，并在 CSS 中指定以下内容：

```
.contain {
    height: /* max height you want */
    width: /* max width you want */
    overflow: hidden;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:24:52.290

尝试调整您的 img 大小，而不是使用 overflow:hidden 剪切它；

像这样的东西：

```
.catalogentry .itemImage img {
  max-width: auto;
  max-height: 80px;
} 
```

请注意，调整图片大小最好在服务器端处理，以缩短加载时间，但这是另一回事......

# android - 从 sd 卡动态加载图像会改变相对布局？

> ID：11804330
> 
> 赞同：0
> 
> 时间：2012-08-03T22:54:21.420
> 
> 标签：android, android-layout, android-widget, android-ndk

**现实布局问题**

> 从 SD 卡加载图像 相对布局受到干扰 如何在不干扰相对布局的情况下解决加载图像的问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:43:04.550

好吧，您需要设置正确的图像尺寸。

这里有一些关于如何处理位图的文档：

[http://developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)

# c - Ruby C 扩展编译错误：“事件”之前的预期“）”

> ID：11804331
> 
> 赞同：0
> 
> 时间：2012-08-03T22:54:23.080
> 
> 标签：c, ruby, compilation, ruby-c-extension

我正在尝试使用 C 扩展来扩展 Ruby，以添加事件挂钩。

不幸的是，我收到以下错误：

```
timber.c:7: error: expected ‘)’ before ‘event’
timber.c: In function ‘timber_init_event_hook’:
timber.c:15: error: ‘timber_trap’ undeclared (first use in this function)
timber.c:15: error: (Each undeclared identifier is reported only once
timber.c:15: error: for each function it appears in.)
timber.c: At top level:
timber.c:21: error: expected ‘)’ before ‘event’
make: *** [timber.o] Error 1 
```

我写的代码：

```
#include <ruby.h>
#include </Users/paulengel/.rvm/src/ruby-1.9.2-p180/node.h> // #include <node.h> raises `error: node.h: No such file or directory`

// Declarations

static void timber_init_event_hook();
static void timber_trap(rb_event_t event, NODE *node, VALUE self, ID mid, VALUE klass);
VALUE timber_start(VALUE self);
void Init_timber();

// Definitions

static void timber_init_event_hook() {
  #if defined(RB_EVENT_HOOKS_HAVE_CALLBACK_DATA) || defined(RUBY_EVENT_VM)
    rb_add_event_hook(timber_trap, RUBY_EVENT_CALL | RUBY_EVENT_RETURN | RUBY_EVENT_C_CALL | RUBY_EVENT_C_RETURN, 0);
  #else
    rb_add_event_hook(timber_trap, RUBY_EVENT_CALL | RUBY_EVENT_RETURN | RUBY_EVENT_C_CALL | RUBY_EVENT_C_RETURN);
  #endif
}

static void timber_trap(rb_event_t event, NODE *node, VALUE self, ID mid, VALUE klass) {
  rb_funcall(rb_mKernel, rb_intern("puts"), 1, rb_str_new2(event));
}

VALUE timber_start(VALUE self) {
  // Do something
}

void Init_timber() {
  VALUE mTimber = rb_define_module("Timber");
  timber_init_event_hook();
  rb_define_singleton_method(mTimber, "start", timber_start, 0);
} 
```

有人可以帮我解决这个问题吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:09:11.650

编辑：尝试命名你的`rb_event_t`东西，而不是`event`. 尽管我几乎可以肯定它不是 C 关键字，但您遇到的编译错误似乎与该类型的问题一致。

编辑编辑：显然不是实际问题，但看起来错误肯定在这两行。

# google-chrome - 在 chrome 扩展中插入图像

> ID：11804332
> 
> 赞同：41
> 
> 时间：2012-08-03T22:54:55.303
> 
> 标签：google-chrome, google-chrome-extension

我想知道如何在 Chrome 扩展程序中插入图像。

```
<img id="image" src="logo.png" /> 
```

我将该 html 标记正确插入到网站中，但自然无法加载该 logo.png 图像。

关于如何修改 manifest.json 的任何想法？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-08-04T09:20:04.067

该问题有两个可能的原因。

1.  您正在使用`src="logo.png"`. 插入的图像元素成为页面的一部分，因此浏览器**不会尝试**从扩展加载图像。
    要解决此问题，请使用[`chrome.extension.getURL('logo.png');`](http://code.google.com/chrome/extensions/extension.html#method-getURL)获取资源的绝对 URL。

2.  [`"manifest_version": 2`](http://code.google.com/chrome/extensions/manifestVersion.html)在清单文件中启用。默认情况下，这会禁用所有资源供外部使用。发生此错误时，控制台中会显示以下消息：

    > 不允许加载本地资源：chrome://gbmfhbpbiibnbbgjcoankapcmcgdkkno/logo.png

    为了解决这个问题，将资源添加到白名单中，即[`"web_accessible_resources"`](http://code.google.com/chrome/extensions/manifest.html#web_accessible_resources)在清单文件中：

    ```
     ...,
      "web_accessible_resources": ["logo.png"]
    } 
    ```

更新： `chrome.extension.getURL('logo.png')`

> 自 Chrome 58 起已弃用。请使用[`runtime.getURL`](https://developer.chrome.com/extensions/runtime#method-getURL).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-22T12:41:11.867

我找到的唯一实用的解决方案是：

#### 我的.html

```
<img id="icon" src="./icon.png"> 
```

#### 内容.js

```
let icon = document.getElementById("icon");
icon.src = chrome.runtime.getURL("icon.png"); 
```

#### manifest.js

```
"web_accessible_resources": [{
    "matches": ["<all_urls>"],
    "resources": ["icon.png"]
}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-03T12:04:35.843

这个解决方案对我有用。

*   在扩展目录中创建一个名为“images”的文件夹。
*   保留该目录中的所有图像文件。
*   `"web_accessible_resources": ["logo.png"]`在 manifest.json 文件中添加
*   使用`src='chromeextension://[ID]/images/logo.png'`from content.js访问它

# iphone - 在情节提要中表示自定义视图控制器

> ID：11804335
> 
> 赞同：2
> 
> 时间：2012-08-03T22:55:23.673
> 
> 标签：iphone, ios, xcode

我有一个根视图控制器初始化加载到应用程序的委托 didLaunchWithOptions 方法。我在没有故事板的情况下开始了这个项目。现在，我如何在情节提要中表示这个“根视图控制器”，以便我可以拖放界面对象？

我希望根视图控制器类显示在情节提要中。可能吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:02:16.987

是的 。它很容易。选择适当的对象 (ViewController) 并将其拖放到 storyBoard 中。我的意思是如果您的 rootviewcontroller 是 UIViewController，那么选择它作为 UIViewController 对象。如果它是一个 TableViewVontroller，然后拖放 UITableviewcontroller 的一个对象

完成此操作后，通过选择对象将情节提要与班级连接起来，然后转到身份检查器（情节提要上的右窗格，带有 3 个选项卡，看起来像报纸）如果找不到它，请转到查看 -> 实用程序 - >显示身份检查员。

在那里有一个选项来指定类。提到你的 rootviewcontroller 类名等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:02:17.243

您只需将 a 拖到`UIViewController`故事板并将其类设置为`RootViewController`. 还将它设置为初始视图控制器（应该有一个复选框）。

然后你可以拖放任何你想要的东西。

# javascript - 在 D3 中从 JSON 获取最大值

> ID：11804337
> 
> 赞同：2
> 
> 时间：2012-08-03T22:55:31.100
> 
> 标签：javascript, json, scale, d3.js

我将 D3 与 JSON 数据一起使用，其功能类似于：

```
 d3.json("http://api.json", function(jsondata) {
 var data = jsondata.map(function(d) { return d.number; }); 
```

这导致数据相等`["2", "5", "8", "12"]`

然后，如果我使用： `var x = d3.scale.linear() .domain([0, d3.max(data)])`

返回的最大值是 8 而不是 12。我意识到这是因为 8 大于 12 中的 1，但我不知道如何解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T23:11:04.800

根据 API 参考，[d3.max使用](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_max)**natural order**返回最大值。由于您正在计算字符串数组的最大值，因此使用[字典（字母）顺序](http://en.wikipedia.org/wiki/Lexicographical_order)。比较：

```
console.log("8" > "12"); // true
console.log(8 > 12); // false 
```

如果要计算数组的最大数值，您可能应该首先将这些字符串转换为数字。一种方便的方法是一元运算`+`符：

```
var data = jsondata.map(function(d) { return +d.number; }); 
```

如果您愿意，还可以使用 parseFloat、parseInt、Number 或各种其他方法将字符串强制转换为数字。从技术上讲，您可以将其作为 d3.max 调用 ( `d3.max(data, Number)`) 的一部分来执行，但是显式执行强制转换通常更快更安全。

当然，由于您已经在使用 JSON 并且 JSON 是一种类型化的序列化格式，因此将数字存储在 JSON 中而不是字符串中也可能更有意义；那么您将不需要任何类型强制。

# android - 为什么它不起作用（字符串数组）？

> ID：11804339
> 
> 赞同：0
> 
> 时间：2012-08-03T22:55:40.483
> 
> 标签：android, arrays, string

嗨，我想通过这种方法将新字符串添加到字符串数组，但它不起作用，因为当我开始新活动时，favaorites 数组不会更新。为什么 ？

```
Resources res = getResources();
    String[] favorites = res.getStringArray(R.array.favorites);
    String[] planets = res.getStringArray(R.array.planets_array);
    String[] temp = new String[favorites.length+1];
    System.arraycopy(favorites,0,temp,0,favorites.length);
    temp[favorites.length] = planets[mCounter];
    favorites = temp; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:14:13.567

在您的情况下，您可以做的是使用 SharedPreferences 将字符串存储到其中。没有数组分配要求，这是一种更清洁的方法。一些帮助您入门的链接：

1.  [http://saigeethamn.blogspot.in/2009/10/shared-preferences-android-developer.html](http://saigeethamn.blogspot.in/2009/10/shared-preferences-android-developer.html)

2.  [http://saigeethamn.blogspot.in/2009/10/shared-preferences-android-developer.html](http://saigeethamn.blogspot.in/2009/10/shared-preferences-android-developer.html)

3.  [http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T05:03:27.177

为了解决您的问题，您应该创建一个包含所有这些属性的 SQLite 数据库。然后您应该从光标中检索它们（在查询数据库之后）并根据需要使用结果

另一个注意事项是你**不能**添加到已经定义的 R.array.* 因为它是一个预编译的资源。

# android - 将 Android Spinner 显示为下拉菜单？

> ID：11804340
> 
> 赞同：0
> 
> 时间：2012-08-03T22:55:46.543
> 
> 标签：android

有什么方法可以真正将 Spinner 显示为下拉菜单，如下所示：

[http://developer.android.com/guide/topics/ui/controls/spinner.html](http://developer.android.com/guide/topics/ui/controls/spinner.html)

我只能获得以整个屏幕为中心的默认模式对话框。

使用 API 8，我的实现与上面链接中显示的基本相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:11:07.683

我建议学习 QuickActionWidget 并扩展它来完成这项工作，这是 StackOverflow 上提出的类似[问题](https://stackoverflow.com/questions/9833621/custom-spinners-drop-down-menu)，我认为答案就是你需要的。您可能需要对代码和设计进行一些编辑，但基本思想是相同的。

# hadoop - HADOOP datanode 奇怪的东西

> ID：11804341
> 
> 赞同：1
> 
> 时间：2012-08-03T22:55:53.080
> 
> 标签：hadoop, hdfs

我想我对 Hadoop Cluster 中的数据节点一定有一些误解。我有一个由 master、slave1、slave2、slave3 组成的 hadoop 虚拟集群。Master和slave1在一台物理机上，slave2和slave3在一台物理机上。当我启动集群时，在 HDFS webUI 中，我只能看到三个活的数据节点，slave1、master、slave2。但有时，三个活着的数据节点是 master、slave1、slave3。那很奇怪。我ssh到未启动的数据节点，虽然我执行jps并没有找到数据节点，但我仍然可以在这个节点上复制和删除HDFS上的文件。所以我相信我一定不能正确理解datanode。我在这里有三个问题。1 每个节点是否有一个数据节点？2 为什么不是datanode的节点仍然可以在HDFS上读写？3 我们可以决定datanode的数量吗？

这是未启动的数据节点的日志：

> * * *
> 
> ```
> STARTUP_MSG: Starting DataNode
> STARTUP_MSG:   host = slave11/192.168.111.31
> STARTUP_MSG:   args = []
> STARTUP_MSG:   version = 1.0.3
> STARTUP_MSG:   build = https://svn.apache.org/repos/asf/hadoop/common/branches/branch-    1.0 -r 1335192; compiled by 'hortonfo' on Tue May  8 20:31:25 UTC 2012
> ************************************************************/
> 2012-08-03 17:47:07,578 INFO org.apache.hadoop.metrics2.impl.MetricsConfig: loaded     properties from hadoop-metrics2.properties
> 2012-08-03 17:47:07,595 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean     for source MetricsSystem,sub=Stats registered.
> 2012-08-03 17:47:07,596 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Scheduled snapshot period at 10 second(s).
> 2012-08-03 17:47:07,596 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: DataNode metrics system started
> 2012-08-03 17:47:07,911 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source ugi registered.
> 2012-08-03 17:47:07,915 WARN org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Source name ugi already exists!
> 2012-08-03 17:47:09,457 INFO org.apache.hadoop.ipc.Client: Retrying connect to server: master/192.168.111.21:54310\. Already tried 0 time(s).
> 2012-08-03 17:47:10,460 INFO org.apache.hadoop.ipc.Client: Retrying connect to server: master/192.168.111.21:54310\. Already tried 1 time(s).
> 2012-08-03 17:47:11,464 INFO org.apache.hadoop.ipc.Client: Retrying connect to server: master/192.168.111.21:54310\. Already tried 2 time(s).
> 2012-08-03 17:47:19,565 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Registered FSDatasetStatusMBean
> 2012-08-03 17:47:19,601 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Opened info server at 50010
> 2012-08-03 17:47:19,620 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Balancing bandwith is 1048576 bytes/s
> 2012-08-03 17:47:24,721 INFO org.mortbay.log: Logging to org.slf4j.impl.Log4jLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog
> 2012-08-03 17:47:24,854 INFO org.apache.hadoop.http.HttpServer: Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
> 2012-08-03 17:47:24,952 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: dfs.webhdfs.enabled = false
> 2012-08-03 17:47:24,953 INFO org.apache.hadoop.http.HttpServer: Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1\. Opening the listener on 50075
> 2012-08-03 17:47:24,953 INFO org.apache.hadoop.http.HttpServer: listener.getLocalPort() returned 50075 webServer.getConnectors()[0].getLocalPort() returned 50075
> 2012-08-03 17:47:24,953 INFO org.apache.hadoop.http.HttpServer: Jetty bound to port 50075
> 2012-08-03 17:47:24,953 INFO org.mortbay.log: jetty-6.1.26
> 2012-08-03 17:47:25,665 INFO org.mortbay.log: Started SelectChannelConnector@0.0.0.0:50075 
> ```
> 
> 2012-08-03 17:47:25,688 信息 org.apache.hadoop.metrics2.impl.MetricsSourceAdapter：已注册源 jvm 的 MBean。2012-08-03 17:47:25,690 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter：已注册源 DataNode 的 MBean。2012-08-03 17:47:30,717 INFO org.apache.hadoop.ipc.Server：启动 SocketReader 2012-08-03 17:47:30,718 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter：源 RpcDetailedActivityForPort50020 的 MBean挂号的。2012-08-03 17:47:30,718 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter：已注册源 RpcActivityForPort50020 的 MBean。2012-08-03 17:47:30,721 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: dnRegistration = DatanodeRegistration(slave11:50010, storageID=DS-1062340636-127.0.0.1-50010-1339803955209, infoPort=50075 , 50020 上的 IPC 服务器侦听器：从 2012-08-03 17:47:30,773 开始 INFO org.apache.hadoop.ipc.Server：50020 上的 IPC 服务器处理程序 0：从 2012-08-03 17:47:30,773 INFO org.apache .hadoop.ipc.Server：50020 上的 IPC 服务器处理程序 1：从 2012-08-03 17:47:30,795 开始信息 org.apache.hadoop.hdfs.server.datanode.DataNode：启动定期块扫描程序。2012-08-03 17:47:30,816 INFO org.apache.hadoop.hdfs.server.datanode.DataNode：在 52 毫秒内完成异步块报告扫描 2012-08-03 17:47:30,838 INFO org.apache.hadoop.hdfs .server.datanode.DataNode：在 32 毫秒内生成粗略（无锁）块报告 2012-08-03 17:47:30,840 INFO org.apache.hadoop.hdfs.server.datanode.DataNode：根据当前状态调整异步块报告2 毫秒 2012-08-03 17:47:31,158 信息 org.apache.hadoop.hdfs.server.datanode.DataBlockScanner：blk_-6072482390929551157_78209 验证成功 2012-08-03 17:47:33,775 INFO org.apache.hadoop.hdfs.server.datanode.DataNode：在 1 毫秒内根据当前状态协调异步块报告 2012-08-03 17:47： 33,793 WARN org.apache.hadoop.hdfs.server.datanode.DataNode：DataNode 正在关闭：org.apache.hadoop.ipc.RemoteException：org.apache.hadoop.hdfs.protocol.UnregisteredDatanodeException：数据节点 192.168.111.31:50010正在尝试报告存储 ID DS-1062340636-127.0.0.1-50010-1339803955209。预计节点 192.168.111.32:50010 将为该存储提供服务。在 org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getDatanode(FSNamesystem.java:4608) 在 org.apache.hadoop.hdfs.server.namenode.FSNamesystem.processReport(FSNamesystem.java:3460) 在 org.apache .hadoop.hdfs.server.namenode.NameNode。

```
 at org.apache.hadoop.ipc.Client.call(Client.java:1070)
    at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:225)
    at $Proxy5.blockReport(Unknown Source)
    at org.apache.hadoop.hdfs.server.datanode.DataNode.offerService(DataNode.java:958)
    at org.apache.hadoop.hdfs.server.datanode.DataNode.run(DataNode.java:1458)
    at java.lang.Thread.run(Thread.java:636) 
```

2012-08-03 17:47:33,873 信息 org.mortbay.log：已停止 SelectChannelConnector@0.0.0.0:50075 2012-08-03 17:47:33,980 信息 org.apache.hadoop.ipc.Server：停止 50020 上的服务器2012-08-03 17:47:33,981 信息 org.apache.hadoop.ipc.Server：50020 上的 IPC 服务器处理程序 0：退出 2012-08-03 17:47:33,981 信息 org.apache.hadoop.ipc.Server： 50020 上的 IPC 服务器处理程序 2：退出 2012-08-03 17:47:33,981 INFO org.apache.hadoop.ipc.Server：50020 上的 IPC 服务器处理程序 1：退出

```
2012-08-03 17:47:33,981 INFO org.apache.hadoop.ipc.Server: IPC Server handler 0 on 50020: exiting
2012-08-03 17:47:33,981 INFO org.apache.hadoop.ipc.Server: IPC Server handler 2 on 50020: exiting
2012-08-03 17:47:33,981 INFO org.apache.hadoop.ipc.Server: IPC Server handler 1 on 50020: exiting
2012-08-03 17:47:33,981 INFO org.apache.hadoop.ipc.metrics.RpcInstrumentation: shut down
2012-08-03 17:47:33,982 WARN org.apache.hadoop.hdfs.server.datanode.DataNode: DatanodeRegistration(192.168.111.31:50010, storageID=DS-1062340636-127.0.0.1-50010-1339803955209, infoPort=50075, ipcPort=50020):DataXceiveServer:java.nio.channels.AsynchronousCloseException
    at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:202)
    at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:170)
    at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:102)
    at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
    at java.lang.Thread.run(Thread.java:636)

2012-08-03 17:47:33,982 INFO org.apache.hadoop.ipc.Server: Stopping IPC Server listener on 50020
2012-08-03 17:47:33,982 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Exiting DataXceiveServer
2012-08-03 17:47:33,983 INFO org.apache.hadoop.ipc.Server: Stopping IPC Server Responder 
```

> 2012-08-03 17:47:33,982 INFO org.apache.hadoop.hdfs.server.datanode.DataNode：等待线程组退出，活动线程为 1 2012-08-03 17:47:33,984 INFO org.apache。 hadoop.hdfs.server.datanode.DataBlockScanner：退出 DataBlockScanner 线程。2012-08-03 17:47:33,985 INFO org.apache.hadoop.hdfs.server.datanode.FSDatasetAsyncDiskService：关闭所有异步磁盘服务线程... 2012-08-03 17:47:33,985 INFO org.apache。 hadoop.hdfs.server.datanode.FSDatasetAsyncDiskService：所有异步磁盘服务线程已关闭。2012-08-03 17:47:33,985 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: DatanodeRegistration(192.168.111.31:50010, storageID=DS-1062340636-127.0.0.1-50010-1339803955209, infoPort=50075 , ipcPort=50020):完成DataNode in: FSDataset{dirpath='/app/hadoop/tmp/dfs/data/current'} 2012-08-03 17:47:

在 com.sun.jmx.mbeanserver.JmxMBeanServer.unregisterMBean(JmxMBeanServer.java:540) 在 org.apache.hadoop.metrics2.util.MBeans.unregister(MBeans.java:71) 在 org.apache.hadoop.hdfs.server .datanode.FSDataset.shutdown(FSDataset.java:2067) 在 org.apache.hadoop.hdfs.server.datanode.DataNode.shutdown(DataNode.java:799) 在 org.apache.hadoop.hdfs.server.datanode.DataNode .run(DataNode.java:1471) 在 java.lang.Thread.run(Thread.java:636)

> 2012-08-03 17:47:33,988 警告 org.apache.hadoop.hdfs.server.datanode.FSDatasetAsyncDiskService：AsyncDiskService 已经关闭。2012-08-03 17:47:33,989 信息 org.apache.hadoop.hdfs.server.datanode.DataNode：退出 Datanode

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T00:35:54.080

每个主机名有多个 DataNode 存在问题。你说它是虚拟的，那么它们是在不同的虚拟机上吗？如果是这样，这应该不是问题......

我会检查 slave2 和 slave3 的 DataNode 日志，看看为什么没有启动。错误消息将在那里打印。如果错误说明与正在占用的端口或类似的内容有关。

* * *

您无需在 DataNode 上即可访问 HDFS。HDFS 客户端（例如`hadoop fs -put`）直接与 NameNode 和其他 DataNode 进程通信，而无需访问本地进程。

实际上，在大型集群中，拥有一个可以访问 HDFS 和 MapReduce 但不运行任何 DataNode 或 TaskTracker 服务的单独“查询节点”是很常见的。

只要您安装了 Hadoop 软件包并且配置文件正确指向 NameNode 和 JobTracker，您就可以“远程”访问您的集群。

# c++ - 在matlab中调用可执行函数，比本机matlab代码慢？

> ID：11804348
> 
> 赞同：2
> 
> 时间：2012-08-03T22:57:00.067
> 
> 标签：c++, performance, matlab, process, exec

我有一个我编译的可执行函数，当我在终端中运行它时，它接受一个输入并吐出一些输出。该函数是用 C++ 编写的，我知道它应该比 matlab 快得多。但是，如果我的 matlab 代码像使用它自己的那样使用这个外部函数，那么它的外部调用会以任何方式使其变慢吗？

当我可以在 matlab 中使用 system() 执行它时，我试图辩论是否有任何意义在我编写这个函数的 matlab 版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:39:41.063

这取决于...您必须尝试并测试性能。

更好的方法是将您的代码编写为[MEX-function](http://www.mathworks.com/help/techdoc/matlab_external/f7667.html)。这为您提供了两全其美的优势（将 MEX 文件视为 DLL）：C 代码性能，调用开销低于外部进程。

由于您已经在 C\C++ 中实现了您的程序，因此您应该能够毫不费力地将其包装为 MEX 函数。

# iphone - 如何针对不同的 MPMoviePlayerControllers 定位 NSNotification？

> ID：11804349
> 
> 赞同：1
> 
> 时间：2012-08-03T22:57:01.933
> 
> 标签：iphone, xcode, mpmovieplayercontroller, nsnotifications

我正在尝试创建一个在播放不同视频后显示唯一信息页面的应用程序。目前，我正在使用`moviePlayBackDidFinish`通知方法显示信息页面，但我不知道如何为不同的视频自定义它。这是我的代码...提前非常感谢！！

子类化movieplayercontroller后编辑...我如何使用新属性`NSNotification`？

//子类movieplayercontroller myMovie.h

```
#import <UIKit/UIKit.h>
#import <MediaPlayer/MediaPlayer.h>

@interface myMovie: MPMoviePlayerViewController
{
    myMovie *videoPlayer;
}

@property (nonatomic, strong) NSString *movieTitle;

@end 
```

我的电影.m

```
#import "myMovie.h"

@interface myMovie ()

@end

@implementation myMovie

@synthesize movieTitle;

@end 
```

//主视图控制器

videoPlayViewController.h

```
#import <UIKit/UIKit.h>
#import <MediaPlayer/MediaPlayer.h>
#import "View2.h"
#import "myMovie.h"

@interface videoPlayViewController : UIViewController

-(IBAction) playMovie; 
```

视频播放视图控制器.m

```
#import "videoPlayViewController.h"
#import "myMovie.h"

@interface videoPlayViewController ()

@end

@implementation videoPlayViewController

-(void)playMovie
{
    NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] 
                                         pathForResource:@"sample" ofType:@"mov"]];

   myMovie *videoPlayer =  [[myMovie alloc]
                    initWithContentURL:url];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(moviePlayBackDidFinish:)
                                                 name:MPMoviePlayerPlaybackDidFinishNotification
                                               object:videoPlayer.moviePlayer];

   videoPlayer.moviePlayer.controlStyle = MPMovieControlStyleDefault;
    videoPlayer.moviePlayer.shouldAutoplay = NO;
    videoPlayer.movieTitle = @"sample";
    [self.view addSubview:videoPlayer.view];
    [videoPlayer.moviePlayer setFullscreen:YES animated:YES];

}

- (void) moviePlayBackDidFinish:(NSNotification*)notification {
    MPMoviePlayerController *player = [notification object];
    [[NSNotificationCenter defaultCenter] 
     removeObserver:self
     name:MPMoviePlayerPlaybackDidFinishNotification
     object:player];

    NSLog(@"Is this working?");

    View2 *second =[[View2 alloc] initWithNibName:nil bundle:nil];

    [self presentModalViewController:second animated:YES];

    [player.view removeFromSuperview];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:13:36.217

创建一个 MPMoviePlayerController 的子类，其中包含一个属性（或多个属性）来保存视频结束时所需的信息。然后，当视频结束时，您将在通知对象中获得自定义的 MPMoviePlayerController，并且您可以检查属性以找出您想知道的关于结束的电影的任何内容。

# javascript - 使用 nodejs 渲染图像

> ID：11804351
> 
> 赞同：3
> 
> 时间：2012-08-03T22:57:15.520
> 
> 标签：javascript, node.js, mongodb

我正在使用 BinData 类型将图像存储在 mongodb 中。

我可以使用[mongojs](https://github.com/gett/mongojs)查询数据库。

```
db.images.findOne({

                   file_name: 'temp.jpg',
                  },

              function(err, data){

                console.log(data.image); // image buffer appears on the console
                res.writeHead(200, {'Content-Type': 'image/jpg'});
                res.end(data.image);

           }); 
```

这会产生“TypeError：第一个参数必须是字符串或缓冲区”。

我很确定这与缓冲区或编码有关。有人可以解释一下在发送到浏览器之前我应该​​对图像数据做什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T14:23:57.883

*   设置正确的内容类型
*   设置正确的内容长度

简短的例子我如何从 mongodb gridfs 提供我的文件

```
.getFileFromGridFs(doc,function(err, buffer){
  if(err) return next(err)
  res.setHeader('content-type',doc.mimeType)
  res.setHeader('content-length',doc.size)
  buffer.pipe(res)
}) 
```

# hadoop - Passing date as command line arguments in Hive

> ID：11804353
> 
> 赞同：7
> 
> 时间：2012-08-03T22:57:27.817
> 
> 标签：hadoop, mapreduce, hive

I have my below query in `test1.hql file`. I am trying to pass the `date (dt)` as the command line argument.

```
select * from lip_data_quality where dt = '${hiveconf: start_date}'; 
```

So whenever I try to run the above `test1.hql` file from shell prompt like this-

```
 hive -f hivetest1.hql -hiveconf start_date=20120709 
```

I get zero records back. But the data is there in that table for that particular date. Why is it so? Something wrong I am doing?

Can anyone help me out here? I was following [Bejoy's Article](http://kickstarthadoop.blogspot.com/2011/10/include-values-during-execution-time-in.html)

I am working `Hive 0.6`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T01:51:36.663

Eliminate the space between hiveconf: and start_date.

This may only be for string types, but Hive is picky in this respect.

# fft - 反基数 4 FFT

> ID：11804357
> 
> 赞同：0
> 
> 时间：2012-08-03T22:58:15.267
> 
> 标签：fft

我有一个正向工作的 radix4 FFT。逆 fft 与 froward 有何不同？我认为唯一的区别是旋转因素。我的代码是 [Source](http://www.gweep.net/~rocko/FFT/node6.html#SECTION00060000000000000000)的修改版本。有人可以启发我吗？谢谢。

我的输出

1.  50 688
2.  -26 -6
3.  -10 -16
4.  6.0 -26

预期产出

1.  50 688
2.  6 -26
3.  -10 -16
4.  -26 -6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T23:09:24.717

谷歌搜索“如何计算逆 FFT”。最佳结果：

[http://www.adamsiembida.com/node/23](http://www.adamsiembida.com/node/23)

方程：

```
IFFT(X) = 1/N * conj(FFT(conj(X))) 
```

`conj()`表示“复共轭”，基本上只是将所有复数值乘以`-1`.

[http://en.wikipedia.org/wiki/Complex_conjugate](http://en.wikipedia.org/wiki/Complex_conjugate)

# c# - 使用 SOAP API 过滤 JIRA 问题

> ID：11804359
> 
> 赞同：1
> 
> 时间：2012-08-03T22:58:28.940
> 
> 标签：c#, api, soap, jira

我正在努力有效地找到上周关闭的所有 JIRA 问题。有谁知道如何以一种好的方式做到这一点？

我现在凌乱的解决方案是遍历项目中的每个问题，并将其结束日期和时间与当前时间进行比较。但是，循环必须以给定的键开始和结束，例如 PROJECT-1000 到 PROJECT-2000。必须硬编码这些值并不是很令人满意，而且我不想每次添加更多问题时都必须将上限从 2000 增加到更高的值。我可以选择一个非常大的数字，它几乎肯定会大于最高 id 数字（扫描到 PROJECT-7777777），但这会大大减慢程序的速度。

（请记住，即使是 ID 较小的旧问题也可能在最近关闭，这意味着仅扫描自上次运行应用程序以来创建的问题是行不通的。）

对这样做的优雅方式有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T08:07:20.790

您可以使用 JQL 创建过滤器，然后使用 SOAP API 访问它。

首先，要创建过滤器，请使用此类查询：

```
resolutionDate  >= "-7d" 
```

然后，您可以使用[`getIssuesFromFilterWithLimit`](http://docs.atlassian.com/rpc-jira-plugin/4.4/com/atlassian/jira/rpc/soap/JiraSoapService.html#getIssuesFromFilterWithLimit%28java.lang.String,%20java.lang.String,%20int,%20int%29)SOAP 函数访问您的过滤器。

顺便说一句，如果出于任何将来的原因您想找到最高的问题密钥，[请查看此答案](https://stackoverflow.com/questions/11617376/efficient-ways-to-find-the-highest-jira-issue-id-in-a-project/11631805#11631805)。

**编辑**

要查找过滤器 ID，请转到[http://your.jira.com/ManageFilters.jspa](http://your.jira.com/ManageFilters.jspa)（管理过滤器）并选择过滤器。然后在 URL 中，您将看到`requestId`.

正如@C.Williamson 所说，还有[getIssuesFromJqlSearch(token, jqlQuery, maxIssuesReturned)](http://docs.atlassian.com/rpc-jira-plugin/4.4/com/atlassian/jira/rpc/soap/JiraSoapService.html#getIssuesFromJqlSearch%28java.lang.String,%20java.lang.String,%20int%29)，它通过直接执行 JQL 来节省过滤器的使用。

# digest - SHA-1 摘要减少

> ID：11804360
> 
> 赞同：0
> 
> 时间：2012-08-03T22:58:35.450
> 
> 标签：digest, reduction, sha1

我正在使用 QR 码条形码将 UUID 存储在我的系统中，我需要检查生成的条形码是否是我的，而不是其他人的。我还需要保持编码数据简短，以便 QR 码保持在较低版本范围内并易于扫描。

我的方法是采用 UUID 原始值编号（128 位值）和 16 位校验和，然后在转换为 QR 码之前对该数据进行 Base64 编码。到目前为止一切顺利，这非常有效。

为了生成校验和，我采用 UUID 的字符串版本并将其与一个长秘密字符串组合，并对奇数字节进行异或运算以生成 SHA-1 哈希。但是这个散列太长了，所以我将所有旧字节异或在一起以产生一半的校验和，同样与偶数字节产生另一半。

让我担心的是，我通过 XORing 不必要地损害了 SHA-1 系统。从结果中的某处获取两个未经处理的字节会更好吗？我承认 16 位校验和不如 160 位校验和安全，但这是我必须为条形码的可用性付出的代价。我真正不想找到的是，我现在提供了一个易于破解的校验和，因为 UUID 是明文传输的。

如果有更好的方法来生成校验和，这也将是该问题的合适答案。一如既往地非常感谢您抽出宝贵的时间或只是阅读本文，如果您发布答案，请加倍感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T06:55:17.400

没有理由进行任何异或运算。简单地取前两个字节将是（in）安全的。

为了使代码版本尽可能小，您可能希望将 144 位值转换为十进制字符串并对其进行编码。QR 码具有不同的字符集并有效地编码数字。Base64 只能在 QR 码中编码为 8 位值，因此您可以在此处添加 30%。

# javascript - JavaScript 类中的 Image.onLoad 范围

> ID：11804361
> 
> 赞同：0
> 
> 时间：2012-08-03T22:58:45.550
> 
> 标签：javascript, oop

在 Javascript 中的类中加载图像时，如何让回调成为类的方法而不是全局方法？

```
tc = new TestClass();

var TestClass = function(){

    var img = new Image();
    img.src = 'mars.png';
    img.onLoad = this.imagesHasLoaded(); //does not work, 
            //uncaught TypeError: Object [object Object] has no method 'imagesHasLoaded' ....js:28

            img.onLoad = imageLoaded(); //Works, logs yes, its loaded

    function imageLoaded(){

        console.log("yes, its loaded");
    }

    this.imagesHasLoaded = function(){

        console.log("loaded happened");
    }

    function isLoaded(){

        trace("loaded happened");
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:07:36.220

在您调用 时`this.imagesHasLoaded();`，该功能尚不存在。

我建议您先定义所有函数，然后再调用初始化部分。最后，您可以返回一个包含公共函数的对象：

```
var TestClass = function (path) {
    var priv, publ;

    /*
     * PRIVATE
     */
    priv = {
        img: null,

        imageLoaded: function () {
            console.log("yes, its loaded");
        }
    };

    /*
     * PUBLIC
     */
    publ = {
        isLoaded: function () {
            trace("loaded happened");
        }
    };

    priv.img = new Image();
    priv.img.src = path;
    priv.img.onload = priv.imageLoaded;

    return publ;
};

var tc = TestClass('mars.png'); 
```

PS：`imageLoaded()`可以调用，因为它没有被定义为变量（在你的代码中）。此外，您并没有`img.onload`简单地设置函数，而是设置了函数的结果：使用函数作为回调时要小心使用括号；）！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:08:29.753

您看到的问题是，当您到达错误行时，您尚未定义 this.imagesHasLoaded。

Javascript 是按顺序执行的，不会提前创建函数。

如果您将代码更改为此它将起作用：

```
tc = new TestClass();

var TestClass = function(){
    var img = new Image();
    img.src = 'mars.png';

    this.imagesHasLoaded = function(){

        console.log("loaded happened");
    }

    function isLoaded(){

        trace("loaded happened");
    }

    img.onLoad = this.imagesHasLoaded;
} 
```

另请注意，我删除了`this.imagesHasLoaded`. 这是因为使用括号，您将立即调用 this.imagesHasLoaded，并将该调用的结果分配为事件处理程序。如果删除括号，则将函数指定为事件处理程序，并且仅在图像完成加载时才会调用它。

# c# - 要在 HTML 控件中显示的 XML 元素中的空格

> ID：11804364
> 
> 赞同：2
> 
> 时间：2012-08-03T22:59:13.137
> 
> 标签：c#, html, xml, xslt, xslcompiledtransform

我正在使用 C# 3.5。我有一个传递给 XslCompiledTransform 对象的 XML 字符串。然后我在 WebBrowser 中显示输出。一切都很好，除了 XML 元素包含我需要在 WinForms HTML 浏览器中显示的额外空格。我不能在 html 中使用任何 javascript。这是一个示例 XML 元素：

```
<myelement>Here is where           extra spaces need to be retained</myelement> 
```

我尝试用“”替换字符串，`"&nbsp;"`但这使得 XslCompiledTransform 对象用于转换的 xml 无效（XML 无效）。然后我尝试将“”替换为，`"&amp;nbsp"`但随后文本`&amp;nbsp;`出现在我的 html 中而不是空格中。我怎样才能让多余的空间出现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T23:05:34.157

添加

```
xml:space="preserve" 
```

到您的 xsl 样式表或输入文档。

这是XSLT 中空白处理[的详尽指南。](http://msdn.microsoft.com/en-us/library/aa468566.aspx)

编辑：

要在呈现的 HTML 中保留空白，请在要保留空白`white-space:pre`的元素上使用 css 样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T15:25:38.570

`&nbsp;`是 XHTML DTD 中的一个实体，其实际值为字符`&#xA0;`.

**因此，您需要将每个空格替换为`&#xA0;`.**

很简单：

```
translate(., ' ', '&#xA;') 
```

**这是一个完整的例子**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" encoding="ascii"/>

 <xsl:template match="/*">
     <p>
       <xsl:value-of select="translate(., ' ', '&#xA0;')"/>
     </p>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<myelement>Here is where           extra spaces need to be retained</myelement> 
```

**产生了想要的正确结果**：

```
<p>Here&#160;is&#160;where&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;extra&#160;spaces&#160;need&#160;to&#160;be&#160;retained</p> 
```

**它在浏览器中显示为**：

这是需要保留额外空间的地方

# javascript - jquery-ui-map 设置缩放级别

> ID：11804365
> 
> 赞同：2
> 
> 时间：2012-08-03T22:59:37.273
> 
> 标签：javascript, jquery, jquery-ui, google-maps

我有以下代码来如何映射。除缩放参数外，一切正常。无论我为缩放设置什么，它总是显示相同的缩放级别。我能做些什么？

```
$('#pagemap').live("pageshow", function() {

            $('#map_canvas').gmap().bind('init', function(evt, map) {

                $('#map_canvas').gmap('getCurrentPosition', function(position, status) {

                        if ( status === 'OK' ) {

                            var clientPosition = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

                            $('#map_canvas').gmap('option', 'mapTypeId', google.maps.MapTypeId.SATELLITE);

                            $('#map_canvas').gmap('option', 'zoom', 13);            

                            $('#map_canvas').gmap('addMarker', {'position': clientPosition, 'bounds': true});

                        }
                });   
            });
      }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-04T00:16:34.057

您需要将标记的 'bounds' 选项更改为 false。

`$('#map_canvas').gmap('addMarker', {'position': clientPosition, 'bounds': false});`

> 如果您将属性边界设置为 true，则地图将计算视口并自动缩放，覆盖在构造函数 Blockquote 中设置的任何缩放

[这](http://code.google.com/p/jquery-ui-map/wiki/jquery_ui_map_v_3_sample_code)是更多信息的链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-05T14:10:14.213

我遇到了该解决方案的问题。如果我将 bounds 设置为 false，则地图将保持在其初始中心坐标的中心。好的。那么为什么我的地图的中心点是一个远离大头针的点呢？好的，没问题。但是，如果我在添加标记后仍想设置特定的缩放级别？

```
$("your-selector").gmap('addMarker', { 
    'position': latlng, 
    'bounds': true
}, function(map, marker) {
    map.set('zoom', 12);
}).click(function() {
    $(this.container).gmap('openInfoWindow', { 'content': 'TEXT_AND_HTML_IN_INFOWINDOW' }, this);
}); 
```

你只需回调 gmap 函数。但是人们，是不是该纠正该插件 API 文档中所有损坏的链接的时候了？是时候为任何插件编写明确指定和清晰的 Javascript 文档了吗？让我们互相帮助，这种方式相当复杂。我们正在失去很多时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-18T17:31:28.233

> 试试这个，看看缩放级别代码中的“缩放：9”......

```
<div id="MyDivScrolling">
    <div>
        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyC8KY7rkZP7Xyq5oVM0nssUc4OPIP7MQtw&callback=initMap"></script>
        <script type="text/javascript">
            var markers = [{
            "title": 'Havana',
            "lat": '23.1330200',
            "lng": '-82.3830400',
            "description": 'José Martí International Airport, Havana'
        }
    ,
         {
             "title": 'Tampa',
             "lat": '27.964157',
             "lng": '-82.452606',
             "description": 'Tampa International Airport, Tampa'
         }
    ,
         {
             "title": 'Orlando',
             "lat": '28.538336',
             "lng": ' -81.379234',
             "description": 'Orlando International Airport, Orlando'
         }
    ,
        {
            "title": 'Havana',
            "lat": '23.1330200',
            "lng": '-82.3830400',
            "description": 'José Martí International Airport, Havana'
        }

    ,
        {
            "title": 'Havana',
            "lat": '23.1330200',
            "lng": '-82.3830400',
            "description": 'José Martí International Airport, Havana'
        }
      ,
        {
            "title": 'Miami',
            "lat": '25.7742700',
            "lng": '-80.1936600',
            "description": 'Miami International Airport, Miami'
        }
    ,
        {
            "title": 'Camagüey-Ignacio Agramonte',
            "lat": '21.416666666667',
            "lng": '-77.866666666667 ',
            "description": 'Camagüey-Ignacio Agramonte Airport, Camagüey'
        }

         ,
          {
              "title": 'Camagüey-Ignacio Agramonte',
              "lat": '21.416666666667',
              "lng": '-77.866666666667 ',
              "description": 'Camagüey-Ignacio Agramonte Airport, Camagüey'
          }
           ,
         {
             "title": 'Tampa',
             "lat": '27.964157',
             "lng": '-82.452606',
             "description": 'Tampa International Airport, Tampa'
         }];
            window.onload = function () {
                var mapOptions = {
                    center: new google.maps.LatLng(markers[0].lat, markers[0].lng),
                    zoom: 9,
                    mapTypeId: google.maps.MapTypeId.Streapmap
                };
                var map = new google.maps.Map(document.getElementById("dvMap"), mapOptions);
                var infoWindow = new google.maps.InfoWindow();
                var lat_lng = new Array();
                var latlngbounds = new google.maps.LatLngBounds();
                for (i = 0; i < markers.length; i++) {
                    var data = markers[i]
                    var myLatlng = new google.maps.LatLng(data.lat, data.lng);
                    lat_lng.push(myLatlng);
                    var marker = new google.maps.Marker({
                        position: myLatlng,
                        map: map,
                        title: data.title
                    });
                    latlngbounds.extend(marker.position);
                    (function (marker, data) {
                        google.maps.event.addListener(marker, "click", function (e) {
                            infoWindow.setContent(data.description);
                            infoWindow.open(map, marker);
                        });
                    })(marker, data);
                }
                map.setCenter(latlngbounds.getCenter());
                map.fitBounds(latlngbounds);

                //***********ROUTING****************//

                //Intialize the Path Array
                var path = new google.maps.MVCArray();

                //Intialize the Direction Service
                var service = new google.maps.DirectionsService();

                //Set the Path Stroke Color
                var poly = new google.maps.Polyline({ map: map, strokeColor: 'Blue' });

                //Loop and Draw Path Route between the Points on MAP
                for (var i = 0; i < lat_lng.length; i++) {
                    if ((i + 1) < lat_lng.length) {
                        var src = lat_lng[i];
                        var des = lat_lng[i + 1];
                        path.push(src);
                        poly.setPath(path);
                        service.route({
                            origin: src,
                            destination: des,
                            travelMode: google.maps.DirectionsTravelMode.DRIVING
                        }, function (result, status) {
                            if (status == google.maps.DirectionsStatus.OK) {
                                for (var i = 0, len = result.routes[0].overview_path.length; i < len; i++) {
                                    path.push(result.routes[0].overview_path[i]);
                                }
                            }
                        });
                    }
                }
            }
        </script>
        <div class="MainSliderItem2 ImagesContainerItem">
            <div id="dvMap" style="width: 100%;height: 490px;position: relative;overflow: hidden;background-color: rgb(229, 227, 223);max-width: 80%;margin: 98px auto;">
            </div>
        </div>
    </div>
</div> 
```

# android - 通过 HashMaps 数组中的 ID 将项目动态添加到列表视图

> ID：11804366
> 
> 赞同：0
> 
> 时间：2012-08-03T22:59:38.163
> 
> 标签：android, listview, dynamic, hashmap

我有一个 HashMaps 的 ArrayList，即 Arraylist>，我们称它为 Array1。每个 HashMap 都有不同的数据类型，主要是字符串和整数，例如 {"string1","stringGoesHere", "int1", intGoesHere}

我想遍历 Array1 中的每个 HashMap 并将每个项目添加到我在 xml 文件中使用不同 ID 的不同 TextView 设置的 ListView 中。所以我想将stringGoesHere添加到ListView中TextView的“string1”ID中，并将int作为货币字符串，即intGoesHere = 2，所以我想将$ 2.00放入正确的ID中。

我很不确定如何做到这一点。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T05:39:41.783

1.  为您的列表视图项目使用自定义布局。其中包含 2 个 TextViews，每个 1 个用于存储 String 和 int。

2.  使用自定义适配器填充您的自定义 ListView。使用适配器中的 getView() 方法使用 holder 将文本设置为相应的 TextView。

遵循这些教程。

[http://www.mkyong.com/android/android-listview-example/](http://www.mkyong.com/android/android-listview-example/)

# php - 按日期对多维数组进行排序

> ID：11804370
> 
> 赞同：0
> 
> 时间：2012-08-03T23:00:22.247
> 
> 标签：php, date, multidimensional-array, sorting

我已经用 usort 尝试过这个，但我没有成功。我有以下数组：

```
array(
    [0] => array(
        'date' => '3:6:2012'
    ),
    [1] => array(
        'date' => '5:5:2012'
    ),
    [2] => array(
        'date' => '20:12:2011'
    )
) 
```

日期采用 d:m:yyyy 格式，因此没有前导零。我想对数组进行排序以获得这个：

```
array(
    [0] => array(
        'date' => '20:12:2011'
    ),
    [1] => array(
        'date' => '5:5:2012'
    ),
    [2] => array(
        'date' => '3:6:2012'
    )
) 
```

我试过这样：

```
function cmp($a, $b) {
    if($a['date'] = $b['date']) {
        return 0;
    }
    $partsa = explode(":", $a['date']);
    $partsb = explode(":", $b['date']);
    $daya = $partsa[0];
    $montha = $partsa[1];
    $yeara = $partsa[2];
    $dayb = $partsb[0];
    $monthb = $partsb[1];
    $yearb = $partsb[2];
    if($yeara < $yearb) {
        return -1;
    } elseif($yeara > $yearb) {
        return 1;
    } elseif($yeara == $yearb) {
        if($montha < $monthb) {
            return -1;
        } elseif($montha > $monthb) {
            return 1;
        } elseif($montha == $monthb) {
            if($daya < $dayb) {
                return -1;
            } elseif($daya > $dayb) {
                return 1;
            } elseif($daya == $dayb) {
                return 0;
            }
        }
    }
} 
```

但这并没有给 usort 带来好的结果......如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:04:59.870

PHP 提供了函数`strcmp`，它为我们做比较的东西。为了正确比较日期，我们从中创建时间戳。

但首先我们需要解析字符串：爆炸`:`并最终将它们扔到`mktime`.

```
function cmp($a, $b) {
    $a = explode(':', $a['date']);
    $a = mktime(0, 0, 0, intval($a[1]), intval($a[0]), intval($a[2]));

    $b = explode(':', $b['date']);
    $b = mktime(0, 0, 0, intval($b[1]), intval($b[0]), intval($b[2]));

    return strcmp($a, $b); 
} 
```

注意： 的前三个参数`mktime`是小时、分钟和秒，在这种情况下可以忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:21:19.520

首先，使它们成为日期（正常的、php 可读的日期）：

```
foreach($array as $innerarray){
    foreach($innerarray as $key=>$value){
        $date = explode(":", $value);
        $date = date($date[2]."/".$date[1]."/".$date[0]);
        $array[$innerarray][$key] = $date;
    }
} 
```

在此之后，您可以使用以下功能对它们进行排序：

```
 function sort_bydate($a, $b) { 
     return strnatcmp($a['date'], $b['date']); 
 } 
 // sort by date 
 usort($data, 'sort_bydate'); 
```

这应该可以解决问题。

顺便说一句，我建议不要在数组中使用数组，因为在你的情况下它是没用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T23:24:30.230

您可以使用标准化日期 () 创建一个临时数组`yyyymmdd`，然后使用[`array_multisort`](http://php.net/manual/en/function.array-multisort.php)：

```
$arr = array(
    array(
        'date' => '3:6:2012'
    ),
    array(
        'date' => '5:5:2012'
    ),
    array(
        'date' => '20:12:2011'
    ),
    array(
        'foo' => 'no date here'
    ),
);

foreach($arr as $key=>$row) {
    if(isset($row['date'])) {
        $date = explode(':',$row['date']);
        $date = $date[2] . str_pad($date[1],2,'0',STR_PAD_LEFT) . str_pad($date[0],2,'0',STR_PAD_LEFT);
        $sort_arr[$key] = $date;
    } else {
        $sort_arr[$key] = null;
    }
}
array_multisort($sort_arr, SORT_ASC, $arr);
print_r($arr); 
```

# javascript - 在 setInterval 函数中使用 .call() 传递参数

> ID：11804372
> 
> 赞同：0
> 
> 时间：2012-08-03T23:00:39.290
> 
> 标签：javascript, jquery, callback, setinterval

我要做的是创建一个函数，只要按住鼠标按钮，它就会连续调用另一个函数。我这样做只是为了更好地理解 .call() 和回调。这是我的代码：

```
jQuery.fn.contmousedown = function(mousedownCallback){
  var interval, self = this;
  jQuery(this).mousedown(function(event){
    interval = setInterval(function(self, event){
      mousedownCallback.call(self, event);
      console.log('on');
    },0);
  });
  jQuery(this).mouseup(function(event){
    clearInterval(interval);
  });
}

$(document).contmousedown(function(e){
  $('#run').html(e.pageX+', '+e.pageY);
}); 
```

我收到的错误是：

```
Uncaught TypeError: Cannot read property 'pageX' of undefined 
```

当然，我每秒接收大约 300 倍。:) 如果我将间隔声明行更改为，`interval = setInterval(function(self){`那么我会以大约每秒 300 倍的速度“打开”登录到我的控制台，但我会丢失事件。所以我的问题是我怎样才能做到，以便我可以回调函数并将事件参数传递给它？

[**示例 - http://jsfiddle.net/ZxKxD/**](http://jsfiddle.net/ZxKxD/)

* * *

在通勤回家的路上考虑到这一点，我决定保留这两项活动会很好。所以这是我的最终代码：

```
jQuery.fn.mousehold = function(mousedownCallback){
  var interval, self = this, move_event;
  jQuery(this).mousemove(function(e){
    move_event = e;
  });
  jQuery(this).mousedown(function(click_event){
    interval = setInterval(function(){
      mousedownCallback.call(self, click_event, move_event);
    },0);
  });
  jQuery(this).mouseup(function(){
     clearInterval(interval);
  });
  jQuery(this).mouseout(function(){
     clearInterval(interval);
  });
}

$(document).mousehold(function(click_event, move_event){
  $('#run').html(click_event.pageX+':'+move_event.pageX+', '
                +click_event.pageY+':'+move_event.pageY);
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T23:03:59.157

`setInterval`不将参数传递给回调，因此删除`self`and`event`参数。这样做不会“丢失”事件。

```
$.fn.contmousedown = function(mousedownCallback)
{
    var interval,
        self = this;

    $(this).mousedown(function(event)
    {
        interval = setInterval(function()
        {
            mousedownCallback.call(self, event);
            console.log('on');
        }, 0);
    });

    $(this).mouseup(function()
    {
        clearInterval(interval);
    });
} 
```

演示：http: [//jsfiddle.net/mattball/9veUQ](http://jsfiddle.net/mattball/9veUQ)

* * *

> 那么如何获得光标位置的持续更新呢？

用于`mousemove`捕获事件。

```
$.fn.contmousedown = function(mousedownCallback)
{
    var interval,
        self = this,
        event;

    $(this).mousemove(function(e)
    {
        event = e;
    });

    $(this).mousedown(function ()
    {
        interval = setInterval(function()
        {
            mousedownCallback.call(self, event);
        }, 0);
    });

    $(this).mouseup(function()
    {
        clearInterval(interval);
    });
}; 
```

演示：http: [//jsfiddle.net/mattball/dVaWS/](http://jsfiddle.net/mattball/dVaWS/)

# objective-c - 删除特定字符之前的子字符串（NSString）

> ID：11804375
> 
> 赞同：2
> 
> 时间：2012-08-03T23:01:08.783
> 
> 标签：objective-c, ios, xcode, nsstring, substring

基本上，我通过 Facebook Connect 获得了一个用户城市。结果始终采用以下格式：

悉尼，澳大利亚

但是由于会有很多用户，所以城市和国家可能会有所不同。格式如下：首先是带有逗号的城市，然后是空格和国家/地区。

但是，我只想检索国家/地区名称。我是否可以在字符串中找到逗号，然后删除它后面的所有内容。然后我可以`replaceOccurancesOfString:" "`删除空间。

我已经看到了其他关于此的问题，但它们使用不同的语言。我要的是 Objective-C

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:06:35.090

一种简单的方法是使用它`- (NSArray *)componentsSeparatedByString:(NSString *)separator`制作一个数组，然后选择数组的第二个对象。

# asp.net-mvc - 在 MVC 中对 @Html.TextBox 禁用验证

> ID：11804376
> 
> 赞同：1
> 
> 时间：2012-08-03T23:01:09.297
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, html.textbox

我有一个表单，我想在其中禁用 @Html.TextBox 元素之一所需的验证。前端如下：

```
@model Models.NewUser

@using (Html.BeginForm("Register", "Account"))
{
    <div class="field">
        <span class="textOverField absolute em1-2" style="top:6px;left:4px;">Key</span>
        @Html.TextBox("SchoolGroupKey", "", new { @class = "textField" }) 
    </div>
    <div class="field">
        <span class="textOverField absolute em1-2" style="top:6px;left:4px;">Name</span>
         @Html.TextBox("Names", "", new { @class = "textField" }) <div class="absolute validationMessage">@Html.ValidationMessageFor(u => u.Names)</div>
    </div>
    <div class="field">
        <span class="textOverField absolute em1-2" style="top:6px;left:4px;">Last Name</span>
        @Html.TextBox("LastNames", "", new { @class = "textField" }) <div class="absolute validationMessage">@Html.ValidationMessageFor(u => u.LastNames)</div>
    </div>
    <div class="em0-9" style="margin-bottom:20px;">
        <input class="submitButton cursorHand" style="margin-top:10px;" type="submit" value="Registrarme" />
    </div>
} 
```

该模型的代码如下：

```
public class NewUser
{
    [Required(ErrorMessage = "Name required")]
    public string Names { get; set; }

    [Required(ErrorMessage = "Last name required")]
    public string LastNames { get; set; }

    public System.Guid SchoolGroupKey { get; set; }
} 
```

我猜 @Html.TextBox 有一个默认验证，即使我没有指定它。有没有办法删除它？，我尝试删除 html 标签 data-val-required 和 data-val，但仍然没有结果。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:07:03.773

`Guid`是一个表现为简单类型的结构（就像`int`or `DateTime`）。因此，它会自动验证。如果您想解决方法，请将您的属性类型从更改`Guid`为 nullable `Guid?`。例子：

```
public System.Guid? SchoolGroupKey { get; set; } 
```

当然，当您使用该属性时，您必须更改位置，以通过`Value`可为空类型的属性访问 guid 值。

如果映射失败，那么您将不会收到任何验证错误 - 只是`null`在您的`SchoolGroupKey`属性中设置值。

# objective-c - Core Data 中的两个不同的获取请求

> ID：11804378
> 
> 赞同：0
> 
> 时间：2012-08-03T23:01:33.850
> 
> 标签：objective-c, ios, core-data, nsfetchrequest

我注意到在一个完整的核心数据进程中有两个不同的获取请求。

**获取请求 A**：上下文 (MOC) 实例通过创建获取请求并执行它 (executeFetchRequest) 将数据从磁盘获取到内存。

**获取请求 B**：FRC 实例与另一个获取请求一起初始化，从内存（指定上下文）获取数据到内存，这是自动发生的，因此无需“执行”此获取。

**Fetch 请求 A 和 Fetch 请求 B 之间的连接**

1.A和B的上下文必须相同

2.fetch B的结果是fetch A结果的子集

**问题** 我想知道我的理解是否绝对正确。请指出任何不准确的陈述和误解。谢谢。

**示例代码**

**获取 A（显式执行）：从磁盘到内存**

```
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Photo"];   

request.predicate = [NSPredicate predicateWithFormat:@"unique = %@", [flickrInfo 
objectForKey:FLICKR_PHOTO_ID]]; 

NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"title" ascending:YES]; 

request.sortDescriptors = [NSArray arrayWithObject:sortDescriptor];

NSError *error = nil;

// execute the fetch    
NSArray *matches = [context executeFetchRequest:request error:&error]; 
```

**获取 B（自动）：从内存到内存**

```
- (void)setupFetchedResultsController 
{
    NSFetchRequest *request = 
        [NSFetchRequest fetchRequestWithEntityName:@"Photo"];
    request.sortDescriptors = 
        [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"title"
                                                                                     ascending:YES
                                                                                      selector:@selector(localizedCaseInsensitiveCompare:)]];
    request.predicate = [NSPredicate predicateWithFormat:@"whoTook.name = %@", self.photographer.name];

    self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                                                        managedObjectContext:self.photographer.managedObjectContext
                                                                          sectionNameKeyPath:nil
                                                                                   cacheName:nil];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T10:47:32.337

获取请求 A. 正确。

获取请求 B。几乎正确。您不知道 FRC 从哪里获取数据，是在内存中还是必须从存储中检索。您不必在意，这就是 FRC 的美妙之处。

关系 1\. 相同的上下文。错误的。上下文与关系无关。两个实体 A 和 B 必须在同一个**数据模型**中，而不是在上下文中。上下文主要用于获取和保存。

关系 2\. 子集。错误的。如果您获取实体 A，您可以访问它的关系，但您不知道在什么时候实际检索了多少数据（这称为故障）。核心数据将为您解决这个问题。因为可以以任何方式建立关系（一对多、多对多、一对一）并且可能为空，所以您关于子集的陈述是不正确的。例如：

```
// A --one-to-many--> B
NSSet *bSet = anAObject.bRelationship; 
```

在这种情况下，该集合确实包含所有 B 实体的子集（如果还有其他实体），但您会看到这只是一个特例。在上面的代码中，您还可以看到通过点符号访问关系实体是多么方便。

# web-services - 将应用程序转变为 Web 应用程序

> ID：11804379
> 
> 赞同：0
> 
> 时间：2012-08-03T23:01:35.240
> 
> 标签：web-services, web-applications, web

请原谅我的问题。我主要在这里寻找一些方向和流行语来开始挖掘。

我花了一些时间[用 Python 开发一个应用程序](https://github.com/jlengrand/FaceMovie) 基本上，它需要一堆图像并从中创建一个视频。

它很简单，并且只使用几个库（主要是 opencv 和 nunmpy）。

我在 gtk 中设计了一个小 gui，但我认为通过 Web 提供服务是个好主意。我想我可以重用我的一些核心并设计一个人们可以在浏览器中访问的前端。我只需要一些数据就可以让它运行（图片、电子邮件）

问题是我的网络开发技能真的接近于 0，而且我不知道从哪里开始。我不打算每天有数百人在平台上。

人们会联系，向我提供数据（链接到保管箱文件夹、谷歌驱动器等），然后我会在完成后向他们发送消息。

如果您可以提供一些名称或链接，以便我可以接触该领域，我将非常高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:30:49.670

您可以从查看[Python CGI 模块](http://wiki.python.org/moin/CgiScripts)开始，看看它是否适合您。然后，您需要执行以下步骤：

1.  决定一个网络服务器并安装它，Apache 可能是一个很好的起点。
2.  设计用户界面。在纸上画出线框。弄清楚您希望用户如何浏览您的网站以及您希望在每个页面/视图上获得什么。
3.  您在 #2 中的决定推动了从这一点开始的所有决定。如今，大多数 Web 应用程序都是 Web 1.0 和 JSON/REST“服务”的组合（有几个流行语！）。JQuery 是一个流行且广泛使用的 JavaScript 库，用于开发网站的前端。那将是另一件事。JQuery 完全独立于后端，可以与任何类型的后端（PHP、Ruby、Perl、.NET 等）一起使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T05:13:27.683

CGI 是一个不错的选择，但如果你已经有 Python 经验，Django 绝对值得一试（它属于流氓的 #3 类别，除了它使用 Python！）。Django 完全为您处理所有数据库后端细节，这比简单的 CGI 有优势。它还提供易于使用的预定义类，用于处理文件上传、图像等。它还有一个很棒的[教程](https://docs.djangoproject.com/en/1.4/intro/tutorial01/)，可以帮助您启动和运行。请注意您使用的是 1.3、1.4 还是最新的开发版本，因为框架的某些方面已经发生了相当快的变化。确保您始终查看正确版本的文档。

通过网络应用程序进行图像处理之类的另一个方便的服务是托管云计算服务提供商，如[PiCloud](http://www.picloud.com/). 除非您已经拥有一个具有大量内存和处理能力的私有 Web 服务器，否则这些由 ms 收费的云服务真的很酷。它们还为您提供了 1000 个内核，可以让您进行大量的并发处理。他们提供了一个不错的 Python API，并且在 v2.6 和 v2.7 中都预装了 numpy 和 opencv。（他们使用 PyOpenCV，但你也有 root 权限来安装你想要的任何东西，所以如果你正在使用它，你可以设置“cv2”界面——实际上我只是查看了你的 GitHub，看起来你是使用旧的“cv”界面。你也可以在 PiCloud 上安装任何你想要的应用程序——它不必是 Python。）

# android - Android：从在线数据库更新本地数据库

> ID：11804380
> 
> 赞同：4
> 
> 时间：2012-08-03T23:01:35.353
> 
> 标签：android, database, sqlite

我有一个 android 应用程序，可用作不同商店的库存应用程序（您可以根据某些规格搜索任何电子设备，并查找哪些商店出售它及其位置）。该应用程序带有一个本地数据库，该数据库需要通过肥皂服务进行更新，以获取有关电子设备、优惠和商店的最新信息。肥皂服务将从托管在网络上的另一个数据库中获取数据，并通过指定网站从不同来源进行更新。

我们面临的问题是，如果用户每次更新时都从网上下载整个“在线”数据库，我们无法弄清楚更新本地数据库的方法，因为这会消耗数据库可以获得的带宽大至几兆字节。

我们提出了以下解决方案：

*   创建将在在线数据库上完成 SQL 事务的版本化更新脚本，应用程序将下载它们并运行它们以更新本地数据库。**这个解决方案的问题是，如果用户不定期更新应用程序，他们将不得不下载大量脚本来更新应用程序，并且很可能会包含很多垃圾脚本（项目在早期脚本中添加，然后在稍后被删除）**。

*   下载在线数据库并用它替换本地数据库。**如上所述，这可能很烦人，因为 DB 大小可能只有几兆字节。**

有人可以帮我解决这个问题吗？

泰伊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:10:09.777

您最好的选择是适用于 Android 的 Google Cloud Messaging (GCM)

[http://developer.android.com/guide/google/gcm/index.html](http://developer.android.com/guide/google/gcm/index.html)

没有比这更好的了。这段视频应该让你立即启动并运行，伙计。

[http://www.youtube.com/watch?v=51F5LWzJqjg](http://www.youtube.com/watch?v=51F5LWzJqjg)

# gwt - 有没有办法去混淆已经被我混淆的 GWT javascript 代码？

> ID：11804383
> 
> 赞同：3
> 
> 时间：2012-08-03T23:03:21.567
> 
> 标签：gwt, obfuscation

我希望有可能解码出现在生产环境中的错误堆栈跟踪。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T23:20:44.813

如果您保留符号图，是的；例如退房

[http://code.google.com/p/speedtracer/wiki/ResymbolizationProtocol](http://code.google.com/p/speedtracer/wiki/ResymbolizationProtocol)

（免责声明：我自己从未尝试过）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T15:23:31.163

您需要使用 JsEmulateStackTrace 类。它似乎非常复杂，而且我自己从来没有真正开始完全实现它。

[http://code.google.com/p/google-web-toolkit/wiki/WebModeExceptions](http://code.google.com/p/google-web-toolkit/wiki/WebModeExceptions)

这假设为您重新映射您的符号映射，但老实说，我怀疑它是否完全有效，因为我还没有看到为 gwt 提供正确堆栈跟踪的库/模块。所以这告诉我它很难或没有完全工作。

老实说，在编译时创建一些代码以提供堆栈跟踪支持可能会更好，它允许您生成自己的堆栈跟踪，而不是使用实际的 java 脚本堆栈跟踪。IE .. 您也许可以为您编译的所有类创建一个基类。可能带有注释或其他东西。然后让您的构建脚本扩展所有预编译的类，以便它们对开发人员透明，但包含在编译的缓存文件中。您可以让您的基类获取类名和/或方法名或其他内容。并使用可以弹出的简单堆栈来管理它。

# c# - 工作几个小时后来自 wcf 服务方法的错误

> ID：11804384
> 
> 赞同：2
> 
> 时间：2012-08-03T23:03:24.267
> 
> 标签：c#, .net, wcf, web-services

我对 wcf 服务有疑问。Wcf 服务方法由应用程序调用。这个应用程序调用服务方法非常频繁（每分钟几十次）。服务方法被正确调用（最后使用 Close()，或异常后使用 Abort()）。对我来说最奇怪的是几个小时后我的应用程序从服务中收到错误：

*[接收对http://domain.xx/MyService.svc](http://domain.xx/MyService.svc)的 HTTP 响应时出错。这可能是由于服务端点绑定未使用 HTTP 协议。这也可能是由于服务器中止了 HTTP 请求上下文（可能是由于服务关闭）。有关更多详细信息，请参阅服务器日志。底层连接已关闭：接收时发生意外错误。无法从传输连接读取数据：现有连接被远程主机强行关闭。*

或者这个：

* *00:15:00 后等待回复时请求通道超时。增加传递给 Request 调用的超时值或增加 Binding 上的 SendTimeout 值。分配给此操作的时间可能是较长超时的一部分。对“http://domain.xx/MyService.svc”的 HTTP 请求已超过分配的超时时间 00:15:00。分配给此操作的时间可能是较长超时的一部分。操作已超时 **

什么会导致这样的错误？为什么服务在最初的几个小时内就能正常运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:14:30.150

我会检查您的应用程序日志。根据我的经验，这些错误对我来说更倾向于与服务器相关而不是与代码相关。IIS 可能有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:14:46.133

我知道你提到了它，但看起来你没有正确关闭你的频道。此外，请确保不要将同一个客户端用于许多服务器调用。只需创建一个，将其用于单个调用，然后处理它。

这是关于关闭 WCF 通道的[好读物。](http://weblogs.asp.net/cibrax/archive/2009/06/26/disposing-a-wcf-proxy.aspx)

# hadoop - 带块压缩的序列文件

> ID：11804398
> 
> 赞同：1
> 
> 时间：2012-08-03T23:05:59.007
> 
> 标签：hadoop, mapreduce, hive

我需要使用块压缩数据启用序列文件。下面是将存储为 SequenceFile 的表。

```
create table lip_data_quality
( buyer_id bigint,
  total_chkout bigint,
  total_errpds bigint
 )
 partitioned by (dt string)
row format delimited fields terminated by '\t'
stored as sequencefile
location '/apps/hdmi-technology/b_apdpds/lip-data-quality'
; 
```

在上表中，我通过启用这些命令以像这样的压缩形式获取数据-

```
set mapred.output.compress=true;
set mapred.output.compression.type=BLOCK;
set mapred.output.compression.codec=org.apache.hadoop.io.compress.LzoCodec; 
```

所以我的问题是我只需要使用序列文件启用块压缩吗？或者我还有什么需要做的吗？我正在关注这篇文章[Hadoop](http://books.google.com/books?id=H3mvcxPeUfwC&pg=PA172&lpg=PA172&dq=Sequence+Files+with+BLOCK+compression&source=bl&ots=pXtKy9-Kuc&sig=IFMfUAcW6XfA2TY8zvBhMyNjfic&hl=en&sa=X&ei=sakaUMAGhNHhBJ7AgMAN&ved=0CHIQ6AEwBg#v=onepage&q=Sequence%20Files%20with%20BLOCK%20compression&f=false)

任何建议将不胜感激。

**更新：-**

我通过将所有内容放入 a并从 shell 命令提示符`.hql file`运行它来加载上表中的数据。`hql file`并在每次运行以下 hql 文件时更改分区日期。

```
set mapred.output.compress=true;
set mapred.output.compression.type=BLOCK;
set mapred.output.compression.codec=org.apache.hadoop.io.compress.LzoCodec;

insert overwrite table lip_data_quality partition (dt='20120712') 
SELECT query here which will give the output for the above table. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T18:10:04.023

那应该没问题。您还可以通过查看 HDFS 上的文件来验证它。加载后，HDFS 中应该有一个名为 /user/hive/warehouse/lip_data_quality/dt=20120712 的目录。如果你跑

```
hadoop fs -cat 
```

在该文件夹中的一个文件上，您应该能够看到文件的标题，这将为您提供文件的基本信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-18T14:17:30.297

在提交作业之前设置以下属性。

*   setProperty(job, "mapred.output.compress", "true");
*   setProperty(job,"mapred.output.compression.type", "BLOCK");
*   setProperty(job,"mapred.output.compression.codec","org.apache.hadoop.io.compress.DefaultCodec");

使用 DefaultCodec，可以使用 org.apache.hadoop.io.compress.LzoCodec；

# csv - 将 html 表转换为 csv

> ID：11804399
> 
> 赞同：0
> 
> 时间：2012-08-03T23:05:59.850
> 
> 标签：csv, export-to-csv

所以..我自己对这个问题有点困惑，所以我转向一个我知道我肯定会寻求帮助的地方！

我有一个购物车，为了购买东西，用户必须先填写一张表格。最后，我将显示他们在表格中输入的信息以及他们购买的产品、他们支付的金额以及产品可能具有的任何类型的修饰符（如尺寸、颜色、运输等）。我有一家第三方公司需要在 CSV 文件中检索该信息。

关于如何实现这一点的任何想法。我是这种事情的新手，所以如果我可能在论坛的其他地方错过了这个，我深表歉意。

谢谢！杰米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:10:32.393

这其实并不太难！CSV 文件只是一个逗号分隔值文件。

无论您使用什么作为后端（PHP、c#、c），您都可以像这样写入文件：

客户 ID、名称、项目 1

1，约翰，表

这将在 Excel 中显示为 CustomerID Name，Item1 作为标题行，1, John, Table 作为第一条记录。确保在创建文件时将其命名为 MyFile.CSV，以便通过 windows 与 Excel 相关联！

在这里查看如何正确格式化您的 CSV 文件！

[http://creativyst.com/Doc/Articles/CSV/CSV01.htm](http://creativyst.com/Doc/Articles/CSV/CSV01.htm)

编辑：

我现在看到您说的是 HTML 表格，所以如果您没有服务器代码访问权限，我会在此处指导您了解更多信息。

[在 jQuery 中导出为 csv](https://stackoverflow.com/questions/4639372/export-to-csv-in-jquery)

# c# - 以编程方式在加载的松散 xaml 文件中的控件上设置文本

> ID：11804401
> 
> 赞同：3
> 
> 时间：2012-08-03T23:06:08.170
> 
> 标签：c#, wpf, xaml, xamlreader

我想在加载的松散 xaml 文件中定义的 TextBoxes 中设置文本。文本框是应用程序的一部分。

```
StackPanel LooseRoot;

        if (fTeleFound == true)
        {
            try
            {
                using (System.IO.FileStream fs = new System.IO.FileStream(sXamlFileName, System.IO.FileMode.Open))
                {
                    LooseRoot = (StackPanel)System.Windows.Markup.XamlReader.Load(fs);
                }
                this.DetailsViewFrame.Children.Add(LooseRoot);
            }
            catch (ArgumentException ex)
            {
                // TBD Error xamlfile
                return;
            }

            // set Elements
            //foreach (TextBox textBox in LooseRoot.Children as TextBox) // does not work ?
            //{
                //

            //}
        } 
```

xaml 文件是这样的：

```
<StackPanel Margin="10" Orientation="Vertical"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"> 

<StackPanel Orientation="Horizontal">
    <Label Margin="5,5,0,5">CRCDB=</Label>
    <TextBox Margin="0,5,5,5" Name="DetailsviewTB1" Height="20"/>

    <Label Margin="10,5,0,5">Infonummer=</Label>
    <TextBox Margin="0,5,5,5" Name="DetailsviewTB2" Height="20"/>

    <Label Margin="10,5,0,5">Daten=</Label>
    <TextBox Margin="0,5,5,5" Name="DetailsviewTB3" Height="20"/>
</StackPanel> 
```

这是一个细节视图，必须在不编译新应用程序的情况下进行定制。松散的 xaml 文件的数量及其名称在编译时是未知的。

如何动态设置文本框上的文本？我有一个额外的 xml 文件，可以指定哪些数据来自哪个 TextBox。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:09:26.527

你能[绑定](http://msdn.microsoft.com/en-us/library/ms752347.aspx)它们吗？如果是这样，我肯定会建议这样做，那么您只需将 设置为[`DataContext`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.datacontext.aspx)包含这些值的对象。

否则，您可以使用[`Logical`](http://msdn.microsoft.com/en-us/library/system.windows.logicaltreehelper.aspx)and[`VisualTreeHelpers`](http://msdn.microsoft.com/en-us/library/system.windows.media.visualtreehelper.aspx)来寻找一个具有正确名称的 TextBox 递归。您也可以尝试[`FindName`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.findname.aspx)一些`FrameworkElement`包含您的`StackPanel`.

# ruby-on-rails - 如何修复 Heroku 上 HTTP 读取操作的“连接超时”错误？

> ID：11804402
> 
> 赞同：1
> 
> 时间：2012-08-03T23:06:13.320
> 
> 标签：ruby-on-rails, ruby, heroku

我在 Heroku 托管的 Rails 应用程序中进行了一项操作，该应用程序在后台进程中运行，并调用速度很慢的政府网站。我收到无法修复的超时错误（在下方）。

读取超时出现在请求的 20 秒处。

以下行导致问题：

```
Mechanize.new.get('http://ai.fmcsa.dot.gov/SMS/Data/Search.aspx') 
```

是否有解决此问题的环境变量？还有什么我想念的吗？

```
Errno::ETIMEDOUT: Connection timed out - connect(2)
    from /app/vendor/bundle/ruby/1.9.1/gems/net-http-persistent-2.7/lib/net/http/persistent/ssl_reuse.rb:29:in `initialize'
    from /app/vendor/bundle/ruby/1.9.1/gems/net-http-persistent-2.7/lib/net/http/persistent/ssl_reuse.rb:29:in `open'
    from /app/vendor/bundle/ruby/1.9.1/gems/net-http-persistent-2.7/lib/net/http/persistent/ssl_reuse.rb:29:in `block in connect'
    from /usr/local/lib/ruby/1.9.1/timeout.rb:44:in `timeout'
    from /usr/local/lib/ruby/1.9.1/timeout.rb:89:in `timeout'
    from /app/vendor/bundle/ruby/1.9.1/gems/net-http-persistent-2.7/lib/net/http/persistent/ssl_reuse.rb:29:in `connect'
    from /usr/local/lib/ruby/1.9.1/net/http.rb:637:in `do_start'
    from /usr/local/lib/ruby/1.9.1/net/http.rb:632:in `start'
    from /app/vendor/bundle/ruby/1.9.1/gems/net-http-persistent-2.7/lib/net/http/persistent.rb:768:in `reset'
    from /app/vendor/bundle/ruby/1.9.1/gems/net-http-persistent-2.7/lib/net/http/persistent.rb:503:in `connection_for'
    from /app/vendor/bundle/ruby/1.9.1/gems/net-http-persistent-2.7/lib/net/http/persistent.rb:806:in `request'
    from /app/vendor/bundle/ruby/1.9.1/gems/mechanize-2.5.1/lib/mechanize/http/agent.rb:258:in `fetch'
    from /app/vendor/bundle/ruby/1.9.1/gems/mechanize-2.5.1/lib/mechanize.rb:407:in `get'
    from /app/app/models/inspection.rb:14:in `fmcsa_summary'
    from (irb):5
    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/commands/console.rb:47:in `start'
    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/commands/console.rb:8:in `start'
    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T13:21:04.280

作为临时修复的解决方案是通过 Mechanize 使用代理服务器。在我连接的服务器和 Heroku EC2 实例的 IP 地址范围之间一定有什么事情发生了。

```
agent = Mechanize.new { |a| a.set_proxy(url,port,username,password) } 
```

如果有人知道原始问题的根本原因，它仍然会有所帮助。

# python - ImagingCore Python 对象

> ID：11804405
> 
> 赞同：1
> 
> 时间：2012-08-03T23:06:37.307
> 
> 标签：python, memory, memory-management

我正在使用 Python 内存验证器对我的 Python 程序进行内存使用分析。似乎正在创建许多“ImagingCore”对象并保存在程序的内存中。我只是想检查一下：这些对象到底是什么？它们是 PIL 图像实例吗？其他与照片相关的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:38:38.500

你是对的，[ImagingCore 对象](http://code.activestate.com/lists/python-image-sig/205/)是 PIL 中呈现的 Image API 的基础。

# c++ - 有什么方法可以访问工会内部的受保护声明？

> ID：11804407
> 
> 赞同：3
> 
> 时间：2012-08-03T23:06:59.123
> 
> 标签：c++, binding, wrapper

我在为 C++ 库生成包装器绑定的上下文中问这个问题。示例代码：

```
union Union
{
protected:
    struct ProtClass
    {
    };
}; 
```

包装器绑定是用 extern "C" 函数编写的，它要求类型是可访问的（IOW 嵌套类型声明必须是公共的）。访问受保护声明的简单解决方法`classes`是从类继承并使用 C++ 的公共重新声明功能，该功能允许在外部“C”函数中使用声明。例如：

```
class Class
{
protected:
    struct NestClass
    {
    };
};

class PubDeclClass : Class  // autogenerated
{
public:
    Class::NestClass;  // redeclare nested class as public (can also use 'using' here)
};

// autogenerated (normally generated only if NestClass isn't a POD type)
void* getNewNestClass() { return new PubDeclClass::NestClass; } 
```

很简单，但是这个技巧不能用于联合，因为它们不能被继承。你知道我可以使用什么技巧来从外部“C”函数访问联合的嵌套保护声明吗？

允许这样做的目的是在目标语言中创建 C++ 库的一对一镜像，这意味着目标语言将具有与库中相同的访问说明符。“C”函数是 C++ 代码和目标语言代码之间的粘合剂（SWIG 也使用这种方法，尽管它并不总是包装嵌套声明）。

就个人而言，我很想拥有某种 g++ 扩展，我可以使用它来使用一些特殊的语法将非公共符号重新声明为公共，其唯一目的是编写库包装器。这将极大地简化我的代码生成器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T04:44:55.360

为什么不能使用简单的包装器：

```
struct UnionWrapper
{
    union
    {
    protected:
        struct ProtClass { };
    };
};

class Z12 : public UnionWrapper
{
}; 
```

这只是一个围绕 phohibition 的工作。

# javascript - 如何缩小 html 元素以适应固定大小的 div？

> ID：11804409
> 
> 赞同：2
> 
> 时间：2012-08-03T23:07:08.577
> 
> 标签：javascript, html, css

我有`<div id="preview"></div>`一个固定宽度和高度的 div 标签，在预览中我想显示一些 html：h1、h2、p、块引号、列表，所有这些都缩小了，所以整个 html 块都适合预览，完美的比例和比例。我该怎么办？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T23:11:26.950

使用 CSS 的`zoom`属性：

```
#preview { 
    zoom: 0.5; 
    /* For Firefox */
    -moz-transform: scale(0.5); 
    -moz-transform-origin: 0 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T14:01:42.117

经过更多研究，似乎 iframe 更适合显示 html：您可以直接使用原始 html 加载 iframe，而不是提供指向网页的外部链接。您也可以在 iframe 中嵌入样式表，并且样式表不会影响您网站的其余部分。完美的主题。你可以在这里看到 jsfiddle [。](http://jsfiddle.net/ExPraliteMonk/Cfjg9)

**HTML**

```
<textarea id="editor"><p>This is plain html to keep it simple. In my 
application, this would be Markdown text and converted to html by a 
Markdown converter in javascript.</p></textarea>

<iframe id="preview"></iframe>​​​ 
```

**JavaScript**

```
var html = document.getElementById('editor').value;
head = '<style type="text/css">#inner {color: blue; margin: auto; zoom: 0.6; -moz-transform: scale(0.6); -moz-transform-origin: 0 0;}</style>';     
var body = '<div id="inner">' + html + '</div>';
var preview = document.getElementById('preview').contentWindow.document;
preview.head.innerHTML = head;
preview.body.innerHTML = body;​ 
```

**CSS**

```
#editor, #preview {
    height: 300px;
    width: 200px;
}

textarea {
    resize: none;
}​ 
```

# ruby - 对结构数组进行分组和计数

> ID：11804413
> 
> 赞同：1
> 
> 时间：2012-08-03T23:08:23.193
> 
> 标签：ruby, group-by

红宝石菜鸟在这里！

我有一组看起来像这样的结构

```
Token = Struct.new(:token, :ordinal) 
```

所以这些数组看起来像这样，以表格形式：

```
 Token | Ordinal
 ---------------
    C  | 2
    CC | 3
    C  | 5 
```

而且我想按结构的“令牌”（即左侧列）进行分组并获得计数，但还要保留“序数”元素。所以上面看起来像这样

```
 Token | Merged Ordinal | Count
 ------------------------------
    C  | 2, 5           | 2
    CC | 3              | 1 
```

请注意，最后一列是分组标记的计数，中间列合并“序数”。第一列（“令牌”）可以包含可变数量的字符，我想对这些进行分组。

我尝试了各种方法，使用 group_by （我可以得到计数，但不是中间列），注入，迭代（似乎不是很实用），但我就是做错了，部分原因是我没有很好地掌握 Ruby 和可用的操作/功能。

我也很好地环顾了 SO，但我并没有走得太远。

任何帮助，指针将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T01:38:10.750

用于[`Enumerable#group_by`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-group_by)为您进行分组，并使用生成的哈希来获得您想要的`map`或类似的东西。

```
structs.group_by(&:token).map do |token, with_same_token|
  [token, with_same_token.map(&:ordinal), with_same_token.size]
end 
```

# firebase - 使用 .off 停用事件

> ID：11804424
> 
> 赞同：4
> 
> 时间：2012-08-03T23:10:08.827
> 
> 标签：firebase

我的大多数 .on 事件都使用闭包：

```
 ref.on( 'child_added',
          function( snapshot ) {
             userCallback( snapshot.val() );
          } ); 
```

这意味着，无法使用 .off() 停用这些监视器，因为 off 需要原始回调指针以及 eventType。我怎么能做这种事情？

我的应用程序（jQuery Mobile）是基于页面的。当用户点击某个页面时，我想激活监视器。当用户离开该页面时，我想停用，所以当他们重新进入时，我不会有多个显示器。我想我想只用 eventType 调用 .off() 并删除所有回调。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T23:36:15.260

现在唯一的选择是存储对回调的引用。实际上，通过让 .on() 将其返回给您，我们实际上使这变得更容易一些。所以你可以这样做：

```
var childCallback = ref.on('child_added', function(snapshot) { /* whatever */ });

// later...
ref.off('child_added', childCallback); 
```

但是我们收到了几条与您类似的反馈，称跟踪您的回调引用有时很麻烦。因此，我们计划了 API 更改，以便您可以仅使用事件类型或根本不使用任何参数调用 .off()，并且我们将删除任何注册的回调。但我们现在专注于其他功能，所以这个变化可能需要 1 个多月的时间。

感谢您的反馈！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-04T17:46:16.123

在此期间，您可以使用简单的管理器模式重现这种行为。例如：

```
function ObserverManager( firebaseRef, page ) {
   this.firebaseRef = firebaseRef;
   this.listeners = {child_added: [], child_removed: [], value: [], child_updated: [], child_changed: []};
   this.page = page;
}

FirebaseObservable.prototype.on(event, callback) {
   this.listeners[event].push( 
      this.firebaseRef.on(event, function(snapshot) {
         callback(snapshot.val());
      })
   );
}

FirebaseObservable.prototype.off(event) {
   var list = this.listeners[event], i = list.length;
   while(i--) {  // 50% more efficient than for(i..; list.length; ...) in IE due to scoping
      firebaseRef.off(event, list[i]);
   }
} 
```

# php - 如何将php代码组合为超链接

> ID：11804427
> 
> 赞同：-1
> 
> 时间：2012-08-03T23:10:33.920
> 
> 标签：php

我正在尝试将用于为我的站点提取商店名称的代码与一个单词结合起来，它将商店名称和单词分开，而不是形成超链接。

例如，它将显示........**下午 6 点**交易，但仅超链接商店名称，这里是提取商店名称的代码......

```
<div class="store-name">
                        <?php echo get_the_term_list($post->ID, APP_TAX_STORE, ' ', ', ', ''); ?> 
                    </div> 
```

我想让它说**下午 6 点交易**和超链接整个学期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:15:28.540

```
<div class="store-name"><a href=""><?php echo get_the_term_list($post->ID, APP_TAX_STORE, ' ', ', ', ''); ?>.....6pm deals</a></div> 
```

# jquery - iPhone Web 应用程序的 jQuery Mobile 高度问题，假设页面高度为 480 而不是 460

> ID：11804428
> 
> 赞同：3
> 
> 时间：2012-08-03T23:10:35.500
> 
> 标签：jquery, iphone, ios, jquery-mobile, cordova

jQuery Mobile 似乎在初始化时计算页面高度，但由于我们在应用程序中启用了状态栏，JQM 假设我们有 480 像素而不是 460 像素可用。

我们正在为 iPhone 构建移动网络应用程序。

我们正在使用 JQM 1.1.1 和 PhoneGap 2.0。

知道如何覆盖 JQM 设置吗？我们尝试自己手动将页面高度设置为 460 像素（在 JQM 定义页面高度之后），但这不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:48:46.640

事实证明这不是 JQM 问题。我们的视口元标记中有“height=device-height”。删除它解决了这个问题。

# java - OpenGL es 2.0 Android 纹理

> ID：11804431
> 
> 赞同：1
> 
> 时间：2012-08-03T23:11:06.647
> 
> 标签：java, android, opengl-es-2.0

我似乎无法为我的正方形渲染纹理。我已经让我的程序用颜色渲染空白方块。任何帮助是极大的赞赏。

我已将我的代码重新设计为以下内容，并认为我设置顶点坐标和纹理坐标的方式存在问题。我还在 glDrawArrays 函数中得到了一个 libc 致命信号 11。

这是顶点和纹理坐标：

```
private final FloatBuffer vertexBuffer;
private final FloatBuffer textureBuffer;

static final int COORDS_PER_VERTEX = 3;
static float positionCoords[] = { // in counterclockwise order:
    -1.0f, 1.0f, 1.0f,              
    -1.0f, -1.0f, 1.0f,
    1.0f, 1.0f, 1.0f, 
    -1.0f, -1.0f, 1.0f,                 
    1.0f, -1.0f, 1.0f,
    1.0f, 1.0f, 1.0f,
};

static final int COORDS_PER_TEXTURE = 2;
static float textureCoords[] = {
    0.0f, 0.0f,                 
    0.0f, 1.0f,
    1.0f, 0.0f,
    0.0f, 1.0f,
    1.0f, 1.0f,
    1.0f, 0.0f,
}; 
```

这是我的正方形类中的绘制函数：

```
public void draw(float[] mvpMatrix) 
{
    int MVPMatrixHandle = GLES20.glGetUniformLocation(shader.getProgram(), "u_MVPMatrix");
    int textureHandler = GLES20.glGetUniformLocation(shader.getProgram(), "u_s_texture");
    int positionHandler = GLES20.glGetAttribLocation(shader.getProgram(), "a_position");
    int texCoordHandler = GLES20.glGetAttribLocation(shader.getProgram(), "a_texCoord");

        Log.d(TAG, "Setting up GLProgram Handlers");
        GlRenderer.checkGlError("Setup GLProgram Handlers");

    GLES20.glEnableVertexAttribArray(positionHandler);
    GLES20.glEnableVertexAttribArray(texCoordHandler);

        GlRenderer.checkGlError("EnableVertexAttribArrays");

    GLES20.glVertexAttribPointer(positionHandler, COORDS_PER_VERTEX,
                                GLES20.GL_FLOAT, false,
                                vertexStride, vertexBuffer);        

    GLES20.glVertexAttribPointer(textureHandler, COORDS_PER_TEXTURE,
                                GLES20.GL_FLOAT, false, 
                                textureStride, textureBuffer);

        GlRenderer.checkGlError("VertexAttribPointers (Position, Texture)");

    GLES20.glUniformMatrix4fv(MVPMatrixHandle, 1, false, mvpMatrix, 0);

    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);
    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureID);

    GLES20.glUniform1i(textureHandler, 0);

        GlRenderer.checkGlError("Binding Texture");

    GLES20.glDrawArrays(GLES20.GL_TRIANGLES, 0, vertexCount);

        GlRenderer.checkGlError("Draw Arrays");

    GLES20.glDisableVertexAttribArray(positionHandler);
    GLES20.glDisableVertexAttribArray(texCoordHandler);

        GlRenderer.checkGlError("DisableVertexAttribArrays");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:30:00.397

你的`SetupGLPositionHandle`功能对我来说看起来不对。为什么要在函数末尾禁用 PositionHandle 属性？

该属性必须在调用 glDrawArrays 时启用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T23:26:54.557

`textureHandle`上面代码中的主要问题是我`texCoordHandler`在`glVertexAttribPointer //Texture`

代码应如下所示：

```
GLES20.glVertexAttribPointer(texCoordHandler, COORDS_PER_TEXTURE,
                            GLES20.GL_FLOAT, false, 
                            textureStride, textureBuffer); 
```

由于出现了这个问题，我再次重写了我的代码。添加索引（draworder），将我的Vertex和Texture数组组合成一个Vertices数组，并且只引用a `vertexBuffer`//同时包含位置坐标和纹理坐标而不是a`textureBuffer`和a `vertexBuffer`//只包含位置坐标

我也将其更改`GLES20.glDrawArrays(GLES20.GL_TRIANGLES, 0, vertexCount);`为：

```
GLES20.glDrawElements(GLES20.GL_TRIANGLES, indices.length, 
                      GLES20.GL_UNSIGNED_SHORT, indexBuffer); 
```

# linux - Unix解压缩：如何批量解压缩文件夹中的zip文件并保存在子文件夹中？

> ID：11804438
> 
> 赞同：3
> 
> 时间：2012-08-03T23:12:05.780
> 
> 标签：linux, unix, zip, unzip

假设我有一个文件夹“images”，其中有 0001.zip 到 9999.zip，我想将它们全部解压缩并将它们保存在具有其文件名的子文件夹中，例如，0001.zip 将被解压缩并保存到/0001，0002.zip将被解压并保存到/0002，我试着做

```
unzip '*.zip' 
```

但这会提取当前文件夹中的所有文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T23:18:55.580

你可以这样做：

```
 for file in *.zip; do
       dir=$(basename "$file" .zip) # remove the .zip from the filename
       mkdir "$dir"
       cd "$dir" && unzip ../"$file" && rm ../"$file" # unzip and remove file if successful
       cd ..
  done 
```

或者，在一行上一起运行它：

```
 for file in *.zip; do dir=$(basename "$file" .zip); mkdir "$dir"; cd "$dir"; unzip ../"$file" && rm ../"$file"; cd ..; done 
```

如果您需要/想要保留原始 .zip 文件，只需删除该`&& rm ../"$file"`位即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-03T23:54:51.033

```
for zip in *.zip
do
    unzip "$zip" -d "${zip%.zip}"
done 
```

# linux - Shell 脚本仅在通过 ssh 使用时启动应用程序

> ID：11804441
> 
> 赞同：2
> 
> 时间：2012-08-03T23:12:18.947
> 
> 标签：linux, bash, debian, sh

什么可以导致 .sh 脚本通过 SSH shell 正常工作，但在通过 PHP 或 crontab 执行时不能正常工作？

我有一个运行游戏服务器的 VPS，但为了使其可维护，我计划自动化大部分繁琐的过程（如设置或删除服务器）并轻松制作重要功能（如启动和停止服务器）真正需要的人可以接受。

现在，当我制作 shell 脚本并对其进行测试时，它们工作得非常好。startserver 启动了服务器，restartserver 重新启动了它，等等。但是当从 PHP 运行时，或者 - 正如我后来发现的 - crontab，启动服务器神奇地不起作用。停止它们，检查它们是否正在运行，更新和所有其他功能都按预期工作，但启动服务器并没有做任何事情。它只是返回 0 而没有打印任何内容。

例如，下面是在任何一种情况下都有效的脚本示例：(statusserver.sh)

```
/sbin/start-stop-daemon -v -t --start --exec ~mta/servers/$1/files/mta-server -- -d 
```

这是一个在任何情况下都不起作用的：（startserver.sh）

```
/sbin/start-stop-daemon -v --start --exec ~mta/servers/$1/files/mta-server -- -d 
```

唯一的区别是 statusserver.sh 有“-t”，它只会告诉你在没有 -t 的情况下执行相同的命令是否真的会成功。并像这样执行 statusserver.sh：

```
sudo -u mta ~mta/sh/statusserver.sh test 
```

确实可以，打印一些类似于“Would start ~mta/servers/test/files/mta-server -d”的内容。但是这样做：

```
sudo -u mta ~mta/sh/startserver.sh $2 
```

绝对什么都不做。它不打印任何东西，它实际上返回0。（这应该意味着操作成功）

现在是有趣的部分：当服务器已经在运行时，startserver.sh 将做它应该做的事情：假设服务器已经在运行，并返回一个错误代码。（因为 start-stop-daemon 对我来说很友好）但它完全拒绝启动任何东西。

将 start-stop-daemon 替换为以下内容：

```
sudo -u mta ~mta/servers/test/files/mta-server -d 
```

做同样的事情：它只会拒绝运行，同时仍然返回 0。

哦，顺便说一句，这不是 sudo 的问题。我很确定，因为以下工作也很好

```
sudo -u web1 sudo -u mta ~mta/scripts/startserver.sh test 
```

* * *

回到我的问题：什么会导致 Linux、Shell、Bash 或其他任何东西在通过 PHP 或 crontab 运行时拒绝启动应用程序，而在通过 SSH 启动时愉快地接受它？我需要切换任何设置吗？任何可以阻止我想做的事情的包？还有什么我只是想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:04:27.950

正如我认为贾斯汀正在触及，但没有具体说，似乎无法运行脚本的问题是 apache 用户帐户（通常是有意限制的）无法查看用户的主目录，因为权限。一般只有用户和root才能看到自己的主目录。您可以做一些事情，sudo 在主目录中运行脚本，将其移出用户的主目录或可能更改脚本/主目录的权限，以便它们可以由 apache 在用户的主目录中运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:30:26.210

研究使用 sudo。

为运行 Apache 的用户（通常为“nobody”用户或“apache”用户）设置 /etc/sudoer（使用 visudo），因为这是 Apache 通常运行的用户。使用 NOPASSWD 选项授予对要运行的命令的 sudo 访问权限。

在您的 PHP 脚本中，使用 exec() 执行启动/停止守护进程的命令，并在命令前加上 sudo 命令。

这是一篇关于 sudo 的文章：

[http://www.cyberciti.biz/tips/allow-a-normal-user-to-run-commands-as-root.html](http://www.cyberciti.biz/tips/allow-a-normal-user-to-run-commands-as-root.html)

# javascript - Rails / Javascript：将实例变量传递给Coffeescript时未捕获ReferenceError

> ID：11804442
> 
> 赞同：0
> 
> 时间：2012-08-03T23:12:23.563
> 
> 标签：javascript, ruby-on-rails, instance-variables

我有一个控制器#action，它定义了一个实例变量：

```
@min_rating = 4 
```

在视图中，我有以下内容：

```
<%= javascript_tag do %>
  min_rating = <%= @min_rating %>
<% end %> 
```

然后在我的 Coffeescript 中，我可以执行以下操作：

```
jQuery ->
  alert min_rating 
```

如果我在该视图的页面上，它可以正常工作。

但是，如果我在另一个视图中，我会收到一个 JS 错误，指出未定义 var min_rating：

```
Uncaught ReferenceError: min_rating is not defined 
```

这是因为我为 application.js 中的所有视图加载了所有 JS：

```
//= require_tree . 
```

所以，我的问题是：在 Rails 中处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T06:34:39.543

由于咖啡脚本没有 var 语句，它会自动将它插入到咖啡脚本中的所有变量中，这样就可以防止编译后的 JavaScript 版本将所有内容泄漏到全局命名空间中。

因此，由于没有办法故意从咖啡脚本方面“泄漏”到全局命名空间中，因此您需要将全局变量定义为全局对象的属性。

```
attach them as properties on window

<%= javascript_tag do %>
  window.min_rating = <%= @min_rating %>
<% end %> 
```

然后在您的咖啡脚本中访问 min_rating。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:20:59.863

这取决于你的目标。一个简单的选择是在引用之前检查 min_rating 是否在 javascript 中定义：

```
jQuery ->
  if typeof min_rating != 'undefined'
    alert min_rating 
```

或者，您可以确保在每个页面上都定义了 min_rating - 可能通过将 javascript_tag 调用移动到装饰器并回退到默认值。这对您的应用程序是否有意义取决于您。

或者您可以尝试避免在不需要的页面上加载在 min_rating 上引用的脚本。但这意味着您将无法在每个页面上使用相同的组合 javascript 文件。

# sql - CFWheels - 计算属性在查询中生成列错误

> ID：11804443
> 
> 赞同：2
> 
> 时间：2012-08-03T23:12:27.433
> 
> 标签：sql, coldfusion, railo, cfwheels

好的，所以现在这真的让我很困惑，因为我之前有过这个工作，并且发生了一些变化，导致我的计算属性不起作用。

我有一个在“链接”模型上执行 findAll() 的“页面”控制器。这很好用，除非我尝试包含一个计算属性（它曾经工作）。

**page.cfc（控制器）**

```
<cfset linkListHottest = model("link").findAll(

            select="

                links.linkID,
                linkTitle,
                linkPoints,
                linkAuthority,
                linkCreated,
<!--- Here I specifiy the 'property' names from the model --->
                linkUpVoteCount,
                linkDownVoteCount,
                linkCommentCount,

                users.userID,
                userName,

                categories.categoryID,
                categoryTitle,
                categoryToken",

            include="user,category", 
            order="linkPoints DESC",
            handle="linkListHottestPaging",

            page=params.page,
            perPage=5

        ) /> 
```

**链接.cfc（模型）**

```
<cffunction name="init">

        <cfset table("links") />

<!--- These three lines aren't populating my queries on the link model --->
        <cfset property(name="linkUpVoteCount", sql="(SELECT COUNT(*) FROM votes WHERE votes.linkID = links.linkID AND voteType = 1)") />
        <cfset property(name="linkDownVoteCount", sql="(SELECT COUNT(*) FROM votes WHERE votes.linkID = links.linkID AND voteType = 0)") />
        <cfset property(name="linkCommentCount", sql="(SELECT COUNT(*) FROM comments WHERE comments.linkID = links.linkID AND commentRemoved = 0)") />

        <cfset belongsTo(name="user", modelName="user", joinType="outer", foreignKey="userID") />
        <cfset belongsTo(name="category", modelName="category", joinType="outer", foreignKey="categoryID") />

        <cfset hasMany(name="vote", modelName="vote", joinType="outer", foreignKey="linkID") />
        <cfset hasMany(name="comment", modelName="comment", joinType="outer", foreignKey="linkID") />   

        <cfset validatesPresenceOf(property='linkTitle') />
        <cfset validatesPresenceOf(property='linkURL') />
        <cfset validate(property='linkURL', method='isValidURL') />
        <cfset validate(property='linkURL', method="validateUniqueUrl", when="onCreate") />

    </cffunction> 
```

**home.cfm（查看）**

```
#linkListHottest.linkUpVoteCount# 
```

我收到以下错误：

> “字段列表”中的未知列“linkUpVoteCount”

好的，我想，让我们从 findAll() 中的 SELECT 中删除列名，看看是否能解决它。没有：

> 在查询中找不到列 [LINKUPVOTECOUNT]，列是 [linkID,linkTitle,linkPoints,linkAuthority,linkCreated,userID,userName,categoryID,categoryTitle,categoryToken]

因此，这似乎是第 22 条问题。就好像我的“链接”模型完全忽略了那里设置的属性。

我会很感激任何关于我哪里出错的反馈（我确定是我！）。

非常感谢，迈克尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T15:55:14.340

听起来这是 Wheels 的一个错误。我建议提出一个问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-09T14:27:57.303

我不熟悉你的框架，但试试这个：

```
<cfset property(name="linkUpVoteCount", sql="(SELECT COUNT(*) FROM votes WHERE votes.linkID = links.linkID AND voteType = 1) as linkUpVoteCount") /> 
```

将`as linkUpVoteCount`别名放在 sql 子查询之外。

另外，我很确定您不需要`/>`在`<cfset>'s`. html5 英尺。

# android - 在 Android 中管理构建标志

> ID：11804445
> 
> 赞同：1
> 
> 时间：2012-08-03T23:12:50.693
> 
> 标签：android, build, release, manifest, flags

我有几个选项 - 在代码和清单文件中 - 我想根据它是调试版本还是发布版本轻松打开和关闭。

在 Android 应用程序中处理此类事情的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T03:00:38.120

您可以使用属性文件，例如，一个用于 prod，一个用于 dev。然后，您可以创建一个具有两个目标的 Ant 脚本，一个 prod 构建和一个 dev 构建，在构建 APK 之前复制相应的属性文件。确保使用相同的名称复制属性文件，然后您可以访问已部署的文件，而不管您构建的环境如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T03:06:39.317

除了 Tyler 提到的内容之外，如果您正在考虑包含可选代码以防它是一个 Debug 并且如果它是一个发行版则没有该代码，那么您可以查看使用 ADT 生成的 BuildConfig 文件。

根据文档：“添加了一项功能，允许您仅在调试模式下运行某些代码。构建现在生成一个名为 BuildConfig 的类，其中包含根据您的构建类型自动设置的 DEBUG 常量。您可以检查（BuildConfig.DEBUG ) 常量在您的代码中运行仅调试功能，例如输出调试日志。”

您将在 Project/gen 文件夹中找到此文件，该文件夹与生成 R.java 的位置相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-21T14:30:07.087

现在有了 Android Studio 和 Gradle，使用自动生成的标志很容易做到这一点`BuildConfig.DEBUG`。喜欢：

```
if (BuildConfig.DEBUG) {
    // Debug code
} else {
    // Resease code
} 
```

# ruby - 带有 Model.create 的 RSpec 测试控制器

> ID：11804448
> 
> 赞同：0
> 
> 时间：2012-08-03T23:13:11.880
> 
> 标签：ruby, ruby-on-rails-3, rspec, ruby-on-rails-3.2

我正在尝试测试控制器以确保只有授权方才能使用 RSpec 查看正确的子对象。当我收到此错误时，我无法弄清楚我做错了什么：

```
ActiveRecord::RecordInvalid: Validation failed: Company can't be blank 
```

我有一个 Plan 对象和一个 Company 对象。商店可以有很多计划（想想害虫防治公司）。我想测试给定一个已知场景，我可以检索公司的计划（假设只有一个）。

该计划如下所示：

```
class Plan < ActiveRecord::Base
  before_save :default_values

  # Validation
  validates :amount, :presence => true
  validates :company, :presence => true

  # Plans belong to a particular company.
  belongs_to :company, :autosave => true    

  scope :find_all_plans_for_company, lambda {
    |company| where(:company_id => company.id)
  }
  # Other code ...

end 
```

公司长这样：

```
class Company < ActiveRecord::Base
  validates :name, :presence => true
  validates :phone1, :presence => true

  validates_format_of :phone1, :phone2,
                      :with => /^[\(\)0-9\- \+\.]{10,20}$/,
                      :message => "Invalid phone number, must be 10 digits. e.g. - 415-555-1212",
                      :allow_blank => true,
                      :allow_nil => true

  has_many :users
  has_many :plans

end 
```

.. 控制器看起来像这样

```
def index
    @plans = Plan.find_all_plans_for_company(current_user.company)

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @plans }
    end
  end 
```

.. 我的 RSpec 测试看起来像这样（如果它充满噱头，请原谅，我只是在玩弄它，无法让它工作）。

```
describe PlansController do

  def valid_attributes
    {
        :company_id => 1,
        :amount => 1000
    }
  end

  describe "GET index" do
    it "should return the Plans for which this users company has" do

      @company = mock_model(Company, :id => 1, :name => "Test Company", :phone1 => "555-121-1212")
      Company.stub(:find).with(@company.id).and_return(@company)

      controller.stub_chain(:current_user, :company).and_return(@company)

      plan = Plan.create! valid_attributes

      get :index, {}
      assigns(:plans).should eq([plan])
    end

    # Other tests ...
  end

end 
```

问题是，当我尝试这个（或我尝试过的任何疯狂的其他变体）时，我得到了这个错误：

```
ActiveRecord::RecordInvalid: Validation failed: Company can't be blank 
```

我不确定为什么会发生这种情况，因为我认为`Company.stub`电话会为我处理这个问题。但显然不是。

我在这里错过了什么，我做错了什么？我怎样才能让这个测试通过？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T05:31:26.927

让我们回顾一下这个规范的层次，以确保事情有意义（并确保我理解发生了什么）。首先，你在测试什么？

```
it "should return the Plans for which this users company has" do

  ...

  assigns(:plans).should eq([plan]) 
```

因此，您要检查与当前用户的公司关联的计划是否已分配给`@plans`. 我们可以存根或模拟其他所有内容。

查看控制器代码，我们有：

```
def index
  @plans = Plan.find_all_plans_for_company(current_user.company) 
```

我们需要什么才能让它工作，而不需要访问数据库并且不依赖于模型？

首先，我们想`company`从`current_user.company`. 这就是规范代码中这两行的作用：

```
 @company = mock_model(Company, :id => 1, :name => "Test Company", :phone1 => "555-121-1212")
  controller.stub_chain(:current_user, :company).and_return(@company) 
```

这将导致`current_user.company`返回模拟模型`@company`。到现在为止还挺好。

现在到类方法`find_all_plans_for_company`。这是我有点困惑的地方。在您的规范中，您将`find`方法存根`Company`以返回`@company`for `id = 1`。

但实际上，在你的控制器代码中做这样的事情还不够吗？：

```
 @plans = current_user.company.plans 
```

如果你这样做了，那么在你的测试中你可以模拟一个计划，然后将它作为`plans`你的模拟公司的关联返回：

```
 @plan = mock_model(Plan)
  @company = mock_model(Company, :plans => [ @plan ])
  controller.stub_chain(:current_user, :company).and_return(@company) 
```

然后分配应该工作，您不需要实际创建任何模型或访问数据库。您甚至不需要给您的模拟公司一个 id 或任何其他属性，这些属性与规范无关。

也许我在这里遗漏了一些东西，如果是这样，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T06:11:37.180

为什么需要嘲笑？

我的标准测试设置是使用 Database Cleaner 从测试期间创建的任何记录中清除数据库。通过这种方式，测试使用真实的数据库记录运行，因此在每次测试后从测试数据库中删除这些记录。

您可能还想看看 Factory Girl 在测试期间创建模型实例（例如，可以轻松创建 10 条公司记录）。

看：

*   [http://rubygems.org/gems/database_cleaner](http://rubygems.org/gems/database_cleaner)
*   [http://rubygems.org/gems/factory_girl](http://rubygems.org/gems/factory_girl)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T23:22:51.017

我有三个想法可以解决您的问题：

1.  尝试添加`attr_accessible :company_id`到计划类。

2.  因为当您创建 company_id 为 1 的计划时，mock_model 实际上并没有保存到数据库中，所以验证失败，因为它不存在于数据库中。

3.  确保`before_save :default_values`在 Plan 类中不会混淆新创建实例的 company_id 属性。

# vim - 在多个会话中自动重新加载 .vimrc

> ID：11804450
> 
> 赞同：4
> 
> 时间：2012-08-03T23:13:19.743
> 
> 标签：vim

我通常在多个选项卡/终端中打开 vim 进行开发。当我对我的 vimrc 进行更改时，这意味着关闭并重新打开 vim 的所有会话。有没有办法在所有打开的会话中自动重新加载你的 vimrc？似乎如果这是可能的，答案很容易找到，但我想我还是会问。

我已经看过[这里了](https://stackoverflow.com/questions/4158277)。正如答案所暗示的，它不适用于常规 vim（仅 gvim）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:14:47.237

您可以在不退出 vim 的情况下重新加载 vimrc：

```
:source ~/.vimrc 
```

但是您需要在所有打开的 vim 实例中执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T00:18:53.037

请参阅有关 Mac 上客户端服务器的[答案（假设这可能是您的问题）。](https://stackoverflow.com/questions/10231223/compile-vim-7-3-with-clientserver-feature-on-mac-os-x)

# python - 如何向 pygobject 虚拟终端发送命令？

> ID：11804455
> 
> 赞同：0
> 
> 时间：2012-08-03T23:13:49.340
> 
> 标签：python, terminal, gtk, gtk3, pygobject

现在我可以制作一个终端，但输出不用作命令。它只是将一个字符串打印到虚拟终端。

```
from gi.repository import Gtk, GObject, Vte

class TheWindow(Gtk.Window):

    def __init__(self):
        Gtk.Window.__init__(self, title="inherited cell renderer")
        self.set_default_size(400, 200)

        box = Gtk.Box(orientation=Gtk.Orientation.HORIZONTAL)
        v = Vte.Terminal()
        #v.connect ("child-exited", lambda term: gtk.main_quit())
        length = len("echo \"string\"\n")
        v.feed("echo \"string\"\n", length)
        box.pack_start(v, True, True, 0)

        self.add(box) 
```

我尝试使用此处的文档 [http://developer.gnome.org/vte/0.30/](http://developer.gnome.org/vte/0.30/)，但我在搞清楚这一切时遇到了一些麻烦。我根本找不到关于 vte for python gtk3 的任何文档。

主要是我只是想弄清楚如何在虚拟终端中获取命令提示符，以便它接受来自 python gtk3 接口内部的命令。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T16:36:31.417

这是答案。:) 重要的部分是 fork_command_full 和 feed_child。

```
from gi.repository import Gtk, GObject, Vte
#GObject is not required. I just import it everywhere just in case.
#Gtk, Vte, and GLib are required.
from gi.repository import GLib
import os
#os.environ['HOME'] helps to keep from hard coding the home string.
#os is not required unless you want that functionality.

class TheWindow(Gtk.Window):

    def __init__(self):
        Gtk.Window.__init__(self, title="inherited cell renderer")
        self.set_default_size(600, 300)
        self.terminal     = Vte.Terminal()
        self.terminal.fork_command_full(
                Vte.PtyFlags.DEFAULT, #default is fine
                os.environ['HOME'], #where to start the command?
                ["/bin/sh"], #where is the emulator?
                [], #it's ok to leave this list empty
                GLib.SpawnFlags.DO_NOT_REAP_CHILD,
                None, #at least None is required
                None,
                )
        #Set up a button to click and run a demo command
        self.button = Gtk.Button("Do The Command")
        #To get the command to automatically run
        #a newline(\n) character is used at the end of the
        #command string.
        self.command = "echo \"Sending this command to a virtual terminal.\"\n"
        command = Gtk.Label("The command: "+self.command)
        self.button.connect("clicked", self.InputToTerm)
        #end demo command code

        #set up the interface
        box = Gtk.Box(orientation=Gtk.Orientation.VERTICAL)
        box.pack_start(self.button, False, True, 0)
        box.pack_start(command, False, True, 1)
        #a scroll window is required for the terminal
        scroller = Gtk.ScrolledWindow()
        scroller.set_hexpand(True)
        scroller.set_vexpand(True)
        scroller.add(self.terminal)
        box.pack_start(scroller, False, True, 2)
        self.add(box)

    def InputToTerm(self, clicker):
        #get the command when the button is clicked
        length = len(self.command)
        #A length is not required but is the easiest mechanism.
        #Otherwise the command must be null terminated.
        #Feed the command to the terminal.
        self.terminal.feed_child(self.command, length)

win = TheWindow()
win.connect("delete-event", Gtk.main_quit)
win.show_all()
Gtk.main() 
```

# objective-c - Objective C - Box2d 浮点类型转换：在 float32 上乘以 * 操作数

> ID：11804460
> 
> 赞同：0
> 
> 时间：2012-08-03T23:14:36.100
> 
> 标签：objective-c, casting, type-conversion, box2d-iphone

请帮助我通过解释消除错误

以下行出错：

_Sprite.position.x = _Body->GetPosition().x * _PhysicsWorld->RATIO;

错误消息：二进制表达式的操作数无效（'float32 (aka 'float') 和 'float32( *)()*）

_Body 是一个 B2Body 对象

_Sprite 是一个 CCSprite 对象

_PhysicsWorld->RATIO 返回 float32

如果我将行更改为：

_Sprite.position.x = _Body->GetPosition().x * (float) _PhysicsWorld->RATIO;

另一个错误消息来了：C-style cast from float32(*)() to float is not allowed.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:11:16.483

你可能需要做：

```
_Sprite.position.x = _Body->GetPosition().x * _PhysicsWorld->RATIO(); 
```

请注意 RATIO 之后的尾随 '()'。

您正在将一个浮点数（它解析为指针解引用）乘以一个返回浮点数的函数（我相信）。

# jquery - jquery网络摄像头插件图片

> ID：11804465
> 
> 赞同：0
> 
> 时间：2012-08-03T23:15:20.973
> 
> 标签：jquery, webcam, jquery-webcam-plugin

我正在尝试使用 jquery 网络摄像头插件，我相信我已经把每件事都做好了，但我仍然有问题。
认为#webcam div 工作正常并显示来自摄像头的帧，但单击捕获时未拍摄图像，我在 chrome 控制台上收到以下错误：Uncaught TypeError: Object # has no method 'capture'

这里有类似的问题，但似乎没有一个可以解决我的问题，我也放置了回调。

```
jQuery("#webcam").webcam({

    width: 320,
height: 240,
mode: "callback",
swffile: "../jcam/jscam_canvas_only.swf",

onTick: function(remain) {
},

onSave: function(data) {...
    }
},
onCapture: function () {....
},

debug: function (type, string) {
},
onLoad: function () {.......
    }
}
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T19:22:07.793

尝试这个

$(函数(){

```
jQuery("#webcam").webcam({

    width: 320,

    height: 240,

    mode: "callback",

    swffile: "../jcam/jscam_canvas_only.swf",

    onTick: function(remain) {
    },

    onSave: function(data) {...
        }
    },
    onCapture: function () {....
    },

    debug: function (type, string) {
    },
    onLoad: function () {.......
        }
    }
}); 
```

});

# git - 调试“回购上传”问题 - 权限被拒绝（公钥）

> ID：11804469
> 
> 赞同：3
> 
> 时间：2012-08-03T23:15:31.147
> 
> 标签：git, repository, gerrit

我们正在尝试为代码审查设置一个 Gerrit 实例，并计划在 in 中使用“repo”。我可以*直接推送到 Gerrit*，但使用`repo upload`失败并出现公钥错误：

```
user@machine:~/workspace/git/gerrit-test$ repo upload
Upload project path/gerrit_test/ to remote branch master:
branch master ( 1 commit, Fri Aug 3 15:23:50 2012 -0700):
     8ef17a1b this better effin work
to gerrit.test.com:8081 (y/N)? y
Permission denied (publickey).
fatal: The remote end hung up unexpectedly

----------------------------------------------------------------------
[FAILED] path/gerrit_test/ master          (Upload failed) 
```

我已将问题缩小到用于此 repo 的用户名，但不知道在哪里设置此用户名（我也不知道如何检查正在使用的用户名）。我尝试在**.repo/manifests.git/config**中添加以下内容，但仍然失败。

```
[review "gerrit.test.com:8081"]
        username = <my_username_from_gerrit_profile_page> 
```

在哪里添加正确的用户名？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-18T14:23:05.107

确保您在配置文件中有您的用户名。

```
$ git config --global review.<"URL">.username $USER 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T16:41:07.893

默认情况下，gerrit ssh 服务器在端口 29418 上启动。您似乎正在连接到端口 8081，我怀疑这是 Web 服务器端口号。

如需确认，请检查“etc/gerrit.config”文件的以下部分：

```
[sshd]
    listenAddress = *:29418
[httpd]
    listenUrl = http://*:8081/ 
```

您还可以通过运行以下命令检查您的私钥凭据：

```
$ ssh -p 29418 your_user_id@localhost

  ****    Welcome to Gerrit Code Review    ****

  Hi mark, you have successfully connected over SSH.

  Unfortunately, interactive shells are disabled.
  To clone a hosted Git repository, use:

  git clone ssh://your_user_id@your_machine:29418/REPOSITORY_NAME.git

Connection to localhost closed. 
```

我认为您能够“直接推送到 Gerrit”的原因是 ssh 端口号是存储库 URL 的一部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-30T03:11:28.507

repo 工具使用您的电子邮件前缀作为 review.URL.username

例如，

**用户名**：john_chen

**电子邮件**：John_Chen@gmail.com

**John_Chen**将是 review.URL.username。

因此，您必须检查您是否有能力通过 John_Chen 进行连接

你可以通过**repo --trace upload来追踪它**

# octopress - Octopress - 生成空白文件

> ID：11804471
> 
> 赞同：2
> 
> 时间：2012-08-03T23:15:39.023
> 
> 标签：octopress

在 superuser.com 上问这个问题，不确定 stackoverflow 是否更适合它，但我还没有得到任何答案：

===

我正在尝试在我的 octopress 设置中生成一个新的博客条目，但我注意到以前的一些帖子正在公开生成为空文件，我正在尝试生成的新帖子也是如此。

从一个正在正确生成的条目到另一个没有正确生成的条目的标记文件之间似乎根本没有区别

我有两个 octopress 安装，一个正在工作，而我正在谈论的这个不是，在两者上都更新了 octopress，重新安装了捆绑包但没有运气，也没有正确生成 atom.xml 文件。

也从 ruby​​ 1.9.2p290 更新到 1.9.3 的最新版本，但也没有区别。

有人遇到过这种情况吗？

===

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T07:00:15.350

这很可能是因为您开始使用代码块。这发生在我身上，甚至不使用代码块的帖子/页面也无法生成。我的问题（在 Windows 上）是我什至没有安装 Python（以为我安装了）。安装它解决了这个问题，然后给了我另一个错误，通过更新`pygments.rb`(note `.rb`) gem 修复了这个错误。做这两件事解决了我所有的问题。

如果您使用的是arch linux，则会出现类似的问题，该版本将python默认为尚不支持的版本3 `pygments.rb`。您必须四处寻找如何解决该问题以使用 2.7，但它应该非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T03:31:58.610

您能否提供以下示例：a)*未*正确生成的帖子，以及 b) 正确生成的帖子*？*

我假设它们只是单独的帖子（而不是，例如，/about/ 之类的页面）。我还假设它们在首页的博客索引*和*单个帖子页面上都呈现为空白。

另外 -渲染什么*？*它是否呈现页面的其余部分，但只是没有帖子本身的“内容”？或者该页面甚至不存在？（404？）

# ios - 解除多个视图控制器的委托问题

> ID：11804472
> 
> 赞同：0
> 
> 时间：2012-08-03T23:15:41.197
> 
> 标签：ios, uiviewcontroller, uitableview, modalviewcontroller

我之前问过一个关于解除多个视图控制器的问题，我得到的答案以及我在其他地方找到的可能解决方案都未能达到预期的效果。我已将我的问题范围缩小到我组建代表团的方式。代码如下，我非常感谢任何反馈。

我的完整项目可以在这里下载：https: [//www.yousendit.com/download/TEhWckhYQVNYSHpIRHNUQw](https://www.yousendit.com/download/TEhWckhYQVNYSHpIRHNUQw)

谢谢。

```
//
//  QuestionViewController.h
//  learningTheRopes1
//
//  Created by James Ulle on 7/18/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import <UIKit/UIKit.h>
#import "Question.h"
#import "AnswerViewController.h"

@interface QuestionViewController : UIViewController <AnswerViewControllerDelegate>

@property (weak, nonatomic) IBOutlet UILabel *currentQuestionDisplay;

@property (weak, nonatomic) IBOutlet UITextField *userAnswerTextField;

@property (nonatomic, strong) Question *currentQuestion;

- (IBAction)dismissKeyboard:(id)sender;

- (void)dismissQVC;

@end

    //
    //  QuestionViewController.m
    //  learningTheRopes1
    //
    //  Created by James Ulle on 7/18/12.
    //  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
    //

    #import "QuestionViewController.h"

    @interface QuestionViewController ()

    @end

    @implementation QuestionViewController

    @synthesize currentQuestionDisplay;
    @synthesize userAnswerTextField;
    @synthesize currentQuestion;

    - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
    {
        AnswerViewController *avc = [segue destinationViewController];
        [avc setCurrentQuestion:currentQuestion];
        [avc setUserAnswer:[userAnswerTextField text]];
    }

    - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
    {
        self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];

    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self.currentQuestionDisplay setText:[currentQuestion question]];

    // Do any additional setup after loading the view.
}

- (void)viewDidUnload
{
    [self setCurrentQuestionDisplay:nil];
    [self setUserAnswerTextField:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (IBAction)dismissKeyboard:(id)sender {
    [userAnswerTextField resignFirstResponder];
}

- (void)dismissQVC {
    NSLog(@"Dismiss QVC");
    [self.navigationController popViewControllerAnimated:NO];
}

@end

    //
//  AnswerViewController.h
//  learningTheRopes1
//
//  Created by James Ulle on 7/18/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import <UIKit/UIKit.h>
#import "Question.h"

@protocol AnswerViewControllerDelegate <NSObject>
- (void)dismissQVC;
@end

#import "QuestionViewController.h"

@interface AnswerViewController : UIViewController

@property (weak, nonatomic) IBOutlet UILabel *displayCurrentAnswer;

@property (nonatomic, strong) Question *currentQuestion;

@property (nonatomic, strong) NSString *userAnswer;

@property (nonatomic, weak) id <AnswerViewControllerDelegate> delegate;

- (IBAction)dismissAnswerVC:(id)sender;

@end

    //
//  AnswerViewController.m
//  learningTheRopes1
//
//  Created by James Ulle on 7/18/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import "AnswerViewController.h"

@interface AnswerViewController ()

@end

@implementation AnswerViewController

@synthesize displayCurrentAnswer;
@synthesize currentQuestion;
@synthesize userAnswer;
@synthesize delegate;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    if([userAnswer isEqualToString:currentQuestion.answer]) {
        [self.displayCurrentAnswer setText:@"You are correct!"];
    }
    else {
        [self.displayCurrentAnswer setText:@"You are wrong!"];
    }

    // Do any additional setup after loading the view.
}

- (void)viewDidUnload
{
    [self setDisplayCurrentAnswer:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (IBAction)dismissAnswerVC:(id)sender {
    [self dismissViewControllerAnimated:YES completion:^{

        NSLog(@"Dismiss AVC");
        [[self delegate] dismissQVC];

    }];

}

@end 
```

最后我的输出是这样的（这表明确实调用了完成块，但是没有发生对 dimissQVC 的委托回调：

```
2012-08-03 19:04:34.235
learningTheRopes1[4165:f803] Dismiss AVC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:14:37.017

在 prepareForSegue 方法中，您错过了这一行：

avc.delegate = 自我；

# javascript - 一种将（添加隐私）封装到 MVC 中的模型的方法？

> ID：11804475
> 
> 赞同：3
> 
> 时间：2012-08-03T23:15:55.310
> 
> 标签：javascript, architecture

我命名我的模型和一个这样的控制器：

```
var MC = {}; 
```

然后根据需要添加属性。

例如，初始化我所有模型的代码如下所示：

```
MC.initAll = function() {

    MC.MASettings.init();
    MC.MATweet.init();

    MC.MUserTry.init();
    MC.MUserNew.init();
    MC.MUserExist.init();

    Su.UserOut.init();
    Su.Media.init();
} 
```

我计划将其更改为循环...只需循环通过 MC，如果 init() 存在则执行它。

这种架构唯一困扰我的是没有传统意义上的隐私或封装，即一切都是公开的。

另外，我不实例化我的模型，我只是将它们称为函数，但这与 .js 中的实例化几乎相同。

有没有一种简单的方法可以为我的模型添加隐私，并且仍然可以将它们作为对象中的属性进行访问。

仅举一个例子，这里是我最简单的模型：

```
MC.MUserTry = {
    init: function() {
        document.getElementById( 'ut_but' ).addEventListener( "click", function( ) {
            MC.Controller( MC.o_p( 'MUserTry' ) );
        }, false );
    },
    pre : function( o_p ) {
        o_p.page.email = document.getElementById( 'ut_but' ).getAttribute( 'data-email' );
        return o_p; 
    },
    post : function( o_p ) {
        sLocal( o_p.server.hash, o_p.server.privacy, o_p.server.name, o_p.server.picture, 'ma' );
        vStateUpdate( o_p.server.name, o_p.server.picture, o_p.server.privacy );
        vTPane( o_p.server.tweets ); vBPane( o_p.server.bookmarks ); 
        vFlipP( 'ma' ); 
    }
}; 
```

pre() 在 ajax 调用之前运行，post() 之后运行，init() 通过 onload 事件或类似事件调用。

这是实际实现这一点的控制器。

```
MC.Controller = function( o_p ) {

   console.log( 'o_p = ' + o_p.model );

   var t1, t2, t3, t4, 
       i1, i2, i3, i4,
       o_p_string_send;

    if( SU.get('debug') ) {
        t1 = new Date().getTime();
    }

    o_p = MC[ o_p.model ].pre( o_p );  

    if ( o_p.result !== 'complete' ) {
        o_p_string_send = JSON.stringify( o_p );

        if( SU.get('debug') ) {
            t2 = new Date().getTime();
            console.log( '---------------Server Send: \n ' + o_p_string_send );
        } 

        cMachine( 'pipe=' + o_p_string_send , function( o_p_string_receive ) {

            if( SU.get('debug') ) { 
                console.log( '---------------Server Receive: \n ' + o_p_string_receive ); 
                t3 = new Date().getTime();
            }

            o_p.server = JSON.parse( o_p_string_receive );

            MC[ o_p.model ].post( o_p );

            if( SU.get('debug') ) {
                t4 = new Date().getTime(); i1 = t2-t1 ; i2 = t3-t2 ; i3 = t4-t3; i4 = o_p.server.time;
                console.log( '---------------Time: \n Pre | Transit | Post | Server = ', i1, ' | ', i2, ' | ', i3,' | ', i4 );  
            }

        } );
    }
}; 
```

我想添加隐私。我该如何做到这一点并且仍然保持我的模型作为对象属性可访问？

**有关的**

[如何从本地范围创建全局的、基于实例的对象？](https://stackoverflow.com/questions/11729973/how-to-create-global-instance-based-objects-from-local-scope)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:28:52.740

你可以用闭包来做到这一点。

```
var MyNamespace = {};
MyNamespace.MyClass = (function() {
    function privateMethod() {
        // ...
    }

    function publicMethod() {
        // can call privateMethod() from in here
    }

    return ({
        publicMethod: publicMethod
    });
}()); 
```

这将创建一个`MyNamespace.MyClass`使用一种私有方法和一种公共方法调用的对象。在您的情况下，您可能希望为每个模型类执行此操作。让他们的`init`方法公开并隐藏他们的其他方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T23:20:33.243

> 有没有一种简单的方法可以为我的模型添加隐私，并且仍然可以将它们作为对象中的属性进行访问？

显然，您需要将整个对象设为私有。是的，这也可以像 JavaScript 中的任何其他隐私一样工作——闭包。

看看[模块模式](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth/)（网上有很多关于这个的教程）。

# c# - 如何显示带有样式 PhoneTextSubtleStyle 的承载 TextBlock 的按钮？

> ID：11804477
> 
> 赞同：0
> 
> 时间：2012-08-03T23:16:07.103
> 
> 标签：c#, wpf, xaml, styles, windows-phone-7.1

我需要创建一个带有两行文本的按钮：

第一个是命令标题，如“保存”

第二个是命令的描述，例如“将保存应用程序状态”

所以我写了下一个xaml：

```
<Button Margin="0,128,0,0" Padding="10,5" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
  <StackPanel Margin="0" UseLayoutRounding="False">
    <TextBlock FontSize="{StaticResource PhoneFontSizeMediumLarge}" FontFamily="{StaticResource PhoneFontFamilySemiBold}">Save</TextBlock>
    <TextBlock Style="{StaticResource PhoneTextSubtleStyle}" Margin="0">The application state will be saved</TextBlock>
  </StackPanel>
</Button> 
```

除了一个问题外，此代码运行良好。按下按钮时，描述行变得不可见。

我确定根本原因是描述行的低对比度颜色。但我不知道如何解决它。

更新：我尝试使用 PhoneTextSubtleStyle 样式，但仍然有同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:19:43.817

你能试试这样的吗

```
System.Windows.Visibility.Visible;
System.Windows.Visibility.Hidden;
or
System.Windows.Visibility.Collapsed 
```

这是一个链接，将显示如何在 StackPanel 中使用它的示例

[如何：更改可见性属性](http://msdn.microsoft.com/en-us/library/ms748821%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:23:27.877

您可以*重新模板*（`Button`使用`Control.Template`属性）看起来不同，以便在推送时不再干扰内容。

# android - 手机关机时的Android AlarmService

> ID：11804479
> 
> 赞同：0
> 
> 时间：2012-08-03T23:16:42.503
> 
> 标签：android, service

当用户登录我的应用程序时，我会创建一个 AlarmService 以在 10 分钟内触发。为了响应警报，我启动了一个轮询一些数据的服务。轮询后，该服务会设置一个新警报，以便在另外 10 分钟内再次触发。这很好用，但是当用户手机关机时究竟会发生什么？闹钟会等到手机重启吗？还是警报被破坏？我该如何处理这种情况，以便在用户重新启动手机时警报可以继续？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:28:44.737

手机关机时无法发出警报，但您可以检测手机何时启动并在那一刻做某事，例如计算剩余时间做某事。

此链接可以帮助您： [Trying to start a service on boot on Android](https://stackoverflow.com/questions/2784441/trying-to-start-a-service-on-boot-on-android)

希望有所帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T23:27:27.967

如果用户完全关闭手机，您的闹钟就会消失。通常，解决方案是注册一个`BroadcastReceiver`以在启动时通过`BOOT_COMPLETED`广播获得控制，进入并再次设置您的警报。这是一个演示这[一点的示例应用程序。](https://github.com/commonsguy/cw-omnibus/tree/master/AlarmManager/Scheduled)

# sitecore - 营销人员的 Web 表单重定向到错误路径

> ID：11804480
> 
> 赞同：2
> 
> 时间：2012-08-03T23:16:44.023
> 
> 标签：sitecore, web-forms-for-marketers

为什么 WFFM 不使用 LinkManager 来获取成功重定向项的 URL？在 web.config 中，我的网站有以下设置：

根路径：/sitecore/content/我的网站

开始项目：/首页

如果我浏览 www.MySite.com，它工作得很好：主页项目显示。我使用 LinkManager.GetItemUrl 链接到的所有内容都可以正常工作。

对于我的 Web 表单，我选择了成功项目：/sitecore/content/My Site/Home/Some Directory/Thank You

但是，在完成 Web 表单后，WFFM 会尝试将用户重定向到 www.MySite.com/My%20Site/Home/Some%20Directory/Thank%20You（我希望它会重定向到 www.MySite.com/Some% 20目录/谢谢%20你）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T18:59:38.677

我也遇到过这个问题，我能够纠正这种情况的唯一方法是在成功项目的实际字段中手动输入您期望的路径。

# python - 没有德语词典的 PyEnchant

> ID：11804481
> 
> 赞同：6
> 
> 时间：2012-08-03T23:16:49.447
> 
> 标签：python, dictionary, pyenchant

感谢 Stackoverflow，我了解了 pyenchant 库。

我正在寻找通过附魔使用的德语词典“de_DE”，但找不到。我在哪里可以得到它，我应该把它放在哪个目录以便 pyenchant 可以看到它？

我正在使用运行 Ubuntu 的 linux 机器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T20:33:58.337

从终端类型：

```
sudo apt-get install myspell-de-de 
```

您可以从 Python 提示符类型中检查它是否可用：

```
import enchant
print enchant.list_languages() 
```

要检查它是否有效，请从 Python 提示符键入：

```
import enchant
d = enchant.Dict('de_DE')
d.check("Hello") # False
d.check("Guten") # True 
```

有关更完整的字典列表，请参阅：

[http://packages.ubuntu.com/precise/myspell-dictionary](http://packages.ubuntu.com/precise/myspell-dictionary)

[http://packages.ubuntu.com/precise/aspell-dictionary](http://packages.ubuntu.com/precise/aspell-dictionary)

[http://packages.ubuntu.com/source/precise/openoffice.org-dictionaries](http://packages.ubuntu.com/source/precise/openoffice.org-dictionaries)

[http://packages.ubuntu.com/precise/ispell-dictionary](http://packages.ubuntu.com/precise/ispell-dictionary)

# c# - 嵌套随机生成器不是随机的

> ID：11804488
> 
> 赞同：2
> 
> 时间：2012-08-03T23:18:54.923
> 
> 标签：c#, asp.net, random

我有以下代码。随机 r 工作，让我大约 10% 进入 if。但是 rr 似乎不起作用。它总是返回 0。我做错了什么？

我只想在 10% 的时间里随机选择两个选项。这是在一个 asp.net 应用程序中。代码在按钮单击时执行。

```
 Random r = new Random();
        Random rr = new Random();

        int randomnum = r.Next(0, 100);
        if (randomnum <= 10)
        {

            int randompick = rr.Next(0, 2);
            if (randompick == 0)
            { 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T23:22:27.047

如果您对外部循环的随机性感到满意，请考虑

```
int randompick = randomnum % 2; 
```

而不是嵌套的 Random 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T23:32:06.640

`Random`您可以对两个随机选择使用相同的对象，对吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T23:42:05.007

如前所述，您应该只使用一个伪随机流并将其实例化一次。我将按照以下方式构建我的解决方案：

```
class SomeWidget
{
    private static Random rng ;

    static SomeWidget()
    {
        rng = new Random() ;
        return ;
    }

    public SomeWidget()
    {
        return ;
    }

    public int DoOneThing90PercentOfTheTimeAndSomethingElseTheRestOfTheTime()
    {
        int rc ;
        int n = rng.Next() % 10 ; // get a number in the range 0 - 9 inclusive.
        if ( n != 0  ) // compare to whatever value you wish: 0, 1, 2, 3, 4, 5, 6, 8 or 9\. It makes no nevermind
        {
             rc = TheNinetyPercentSolution() ;
        }
        else
        {
            rc = TheTenPercentSolution() ;
        }
        return rc ;
    }

    private int TheTenPercentSolution()
    {
        int rc ;
        int n = rng.Next() % 2 ;
        if ( n == 0 )
        {
            rc = DoOneThing() ;
        }
        else
        {
            rc = DoAnotherThing() ;
        }
        return rc ;
    }

    private int DoOneThing()
    {
        return 1;
    }

    private int DoAnotherThing()
    {
        return 2 ;
    }

    private int TheNinetyPercentSolution()
    {
        return 3 ;
    }

} 
```

# haskell - 当 Emacs 23 Haskell 编译（Cc Cl）进入无休止的过程时该怎么办？

> ID：11804492
> 
> 赞同：4
> 
> 时间：2012-08-03T23:19:22.350
> 
> 标签：haskell, emacs, haskell-platform, haskell-mode

很多时候，当我尝试编译一个`.hs`文件时，Emacs 23 Haskell 模式进入一个无休止的过程并且没有显示任何响应。唯一发生的事情是光标变成了一个圆圈，并且在圆圈内，点开始盘旋。

避免这种情况的最佳方法是什么？如果我陷入这种境地，我该如何脱身？目前，我重新启动计算机。请指导。

最近，它发生在以下代码中：

```
import Control.Monad
import Data.Char
main = do
  putStrLn "This is an addition"
  contents <- getContents
  putStrLn $ (shortLinesOnly contents)
  shortLinesOnly :: String -> String
shortLinesOnly input =
  allLines = lines input
   shortLines = filter (\line -> length line < 10) allLines
               res = unlines shortLines
                     in result 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T07:31:13.007

也许找到进行编译的函数并将其包装成如下内容是有意义的：

```
(with-local-quit
  (with-timeout (60 (error "The process didn't finish in 60 seconds"))
     ;; do the calls to the compiler here
     )) 
```

如果这还没有完成。如果这已经完成，那么，正如幻象所建议的那样，您应该能够使用`C-g`.

但是，有时 Emacs 可能会变得太慢或太无响应（系统可能会为其启动的进程赋予非常高的优先级，因此您将不得不等待很长时间，直到控制权从具有高优先级的阻塞进程返回到 Emacs） . 不过，这还不是重新启动计算机的原因。在 Linux 上，您可能在运行级别 3 中运行，在这种情况下，您可以执行`Ctrl+Alt+1`或小于运行 X-server 的 shell，然后执行

```
$ ps aux | grep "my process name" 
```

这将为您打印有关该过程的一些详细信息，从它的 id 开始，给定您可以执行的 id：

```
$ kill id 
```

或者，您可以杀死所有 emacs 实例以及由此产生的所有进程：

```
$ killall emacs 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T07:12:46.417

使用`C-g`. 您可以使用它来停止任何内部或外部同步过程。

# vim - Vim 命令行颜色设置

> ID：11804495
> 
> 赞同：9
> 
> 时间：2012-08-03T23:19:57.280
> 
> 标签：vim, syntax-highlighting

有没有办法为命令行颜色和vim中的“普通”文本颜色设置不同的颜色。当我使用

```
:hi Normal guifg=orange 
```

命令行和正常文本颜色变为橙色。但是，我希望 gui 底部的命令行具有不同的颜色。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-04T01:52:40.957

不，不是我知道的。

并非没有弄乱 Vim 的源代码。

命令行*位于*正常突出显示组下。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-11-02T08:12:58.933

现在 NeoVim 具有该功能。`MsgArea`颜色组。例如

```
:hi MsgArea guifg=#03ff13 
```

[![截屏](../Images/5be5ebae516a0b7c130d3488e46600f9.png)](https://i.stack.imgur.com/jfnEy.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-02T05:07:08.990

这可以通过自动命令来完成：

```
hi Normal=white guifg=white
au CmdLineEnter * hi Normal ctermfg=cyan guifg=cyan
au CmdLineLeave * hi Normal ctermfg=white guifg=white 
```

令我惊讶的是，这只影响 CmdLine，而不影响其他一切。

我原以为所有普通文本在输入 CmdLine 时都会立即改变颜色。没有 CmdLineLeave，对普通文本的更改无处不在，但只有在退出命令行之后；这解释了为什么它做我们想要的。

请注意，我从终端使用 vim，所以我使用 ctermfg 而不是 guifg；但我预计它与 gui 版本的 vim 的工作方式相同。

您可能还想突出显示 ModeMsg。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-10-23T11:38:21.770

这可以通过`wincolor`Vim 8.2 中引入的新选项来完成：

```
set wincolor=NormalAlt
autocmd WinEnter set wincolor=NormalAlt
hi Normal       guifg=#CED1CF       guibg=#000000       gui=NONE
hi NormalAlt    guifg=#CED1CF       guibg=#1B1D21       gui=NONE 
```

[![在此处输入图像描述](../Images/43b23dfbff428f3a4118be4c15267d0a.png)](https://i.stack.imgur.com/Cjw8J.png)

# android - imageview - 需要覆盖 onShowPress 行为

> ID：11804496
> 
> 赞同：0
> 
> 时间：2012-08-03T23:20:09.493
> 
> 标签：android, onclick, imageview

新手问题。我在我的活动布局中使用 ImageView，并希望有与按钮类似的行为。我注意到 ImageView 已经生成了 onClick。它不做的是在触摸和非触摸时提供任何视觉反馈，这是我想添加的。

同样，我将需要长按处理；还不知道 ImageView 是否这样做。

我挖了一点，我看到 View 实现了 Runnable；当用户点击图像时调用 performClick，然后调用 ImageView.PerformClick，最后为所有侦听器调用 onClick（这是我的活动）。到 ImageView 处理 PerformClick 时，改变图像外观已经太晚了；在 onShowPress 时间我该怎么做？

还有一点需要注意：我已经看过（并尝试过）向 ImageView 添加了一个gestureDetector，但后来看来我需要重新实现 onClick 处理 - 无论如何，活动停止接收 onClick。

可能有一种完全不同的方式来做我想做的事，我很乐意听到它。

谢谢。

编辑：监控触摸动作的测试代码：package com.example.mockup；

```
import android.content.Context;
import android.util.AttributeSet;
import android.view.DragEvent;
import android.view.MotionEvent;
import android.view.View;
import android.widget.ImageButton;

public class ImageGestureButton extends ImageButton
   implements View.OnTouchListener, View.OnClickListener, View.OnDragListener,
   View.OnLongClickListener
{
  public ImageGestureButton (Context context, AttributeSet attrs)
  {
    super(context, attrs);
    setOnTouchListener (this);
    setOnClickListener (this);
    setOnLongClickListener (this);
    setOnDragListener (this);
    setLongClickable (true);
  }

  public boolean onTouch (View v, MotionEvent e)
  {
    System.out.println ("onTouch " + e.getAction());
    return false;
  }

  public void onClick (View v)
  {
    System.out.println ("onClick");
  }

  public boolean onDrag (View v, DragEvent e)
  {
    System.out.println ("onDrag");
    return false;
  }

  public boolean onLongClick (View v)
  {
    System.out.println ("onLongClick");
    return false;
  }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:33:35.857

我会使用[ImageButton](http://developer.android.com/reference/android/widget/ImageButton.html)。然后使用[setOnClickListener()](http://developer.android.com/reference/android/view/View.html#setOnClickListener%28android.view.View.OnClickListener%29)连接您想要在单击它时调用的方法。此外，您可以将[setOnLongClickListener()](http://developer.android.com/reference/android/view/View.html#setOnLongClickListener%28android.view.View.OnLongClickListener%29)用于长按行为。

最后，还可以根据状态（聚焦、选中等）设置不同的背景、颜色等。看看文档。

至于测试代码，您的 onLongClick() 返回 false，这表明没有消耗长按。尝试将返回值更改为 true，这应该会阻止 onClick() 也被触发。此外，您需要调用 startDrag() 方法才能触发 onDrag() 事件。有关不同事件侦听器和 startDrag() 方法的更多信息，请参阅[android.view 文档](http://developer.android.com/reference/android/view/package-summary.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T05:00:56.783

听起来你想做的是使用和扩展它：

[http://developer.android.com/reference/android/widget/ToggleButton.html](http://developer.android.com/reference/android/widget/ToggleButton.html)

它有两种状态，还因为它的视图具有可用的 OnClick 和 OnLongClick。

# javascript - Python 3、网页抓取和 Javascript [Oh My]

> ID：11804497
> 
> 赞同：4
> 
> 时间：2012-08-03T23:20:25.643
> 
> 标签：javascript, python, python-3.x, web-scraping

我已经到了使用 Javascript 和 Python3 在网络抓取网页上进入混战的地步。我很清楚我的靴子可能会碰到一匹死马，但无论如何我还是想画出我的六射手。这是一部意大利式西部片；做我的灰帽子？

**::背景故事::**

我正在使用 Python 3.2.3。

我有兴趣收集 YTD、1 年、3 年、5 年 10 年......和/或用户定义的股票、etf 或共同基金。我将我的网站设置在 Morningstar.com 上，因为它们倾向于提供尽可能多的数据，而无需登录；Finance.google.com &c 等其他人在他们提供的关于股票、etfs 和共同基金的数据方面往往不一致。

使用晨星来获取这些历史数据，或者他们称之为“追踪总回报”的权衡是，为了生成这些数据，他们使用了 Javascript。

以下是晨星的一些示例链接：

[共同基金；](http://performance.morningstar.com/fund/performance-return.action?t=VHCOX)

[ETF；](http://performance.morningstar.com/funds/etf/total-returns.action?t=VAW)

[股票。](http://performance.morningstar.com/stock/performance-return.action?t=INTC)

我对 Javascript 生成的图表中的“尾随回报”部分、顶行左右的数字感兴趣。

**::到目前为止尝试过::**

我已经确认 wget 不能使用 Javascript；即使下载所有相关文件 [css, .js, &c] 也不允许我在浏览器或脚本中本地呈现 javascript。StackOverflow 上的研究证实了这一点。我愿意在这里纠正。

我的研究告诉我，Python3 不存在 Mechanize。无论如何我都试过了，然后变成了警察沙威，大声喊道：“我知道！” 在错误消息“模块不存在”。

**::我听说过...::**

->硒。但是，我的理解是，这需要你最喜欢的浏览器实际打开一个网页，四处导航，然后不关闭，因为 Selenium 没有“关闭此选项卡//窗口”命令//选项。如果我//my_user 想要获取许多 etf、股票和/或共同基金的历史数据怎么办？这是在浏览器中打开的很多选项卡//窗口，不一定希望打开。

->httplib2\. 我认为这很好，但我怀疑它是否会与 Javascript 一起使用。例如，是否使用 .cache 和 get 选项？

```
import httplib2
conn = httplib2.Http(".cache")
page = conn.request(u"http://the_url","GET") 
```

- >风车。见“硒”。然而，我唱得不够调调，无法唱“Man of La Mancha”。

->谷歌的[网页抓取](http://code.google.com/p/webscraping/)代码。尝试下载包含 Javascript 的页面会导致...积极的结果吗？

我读过关于必须“在没有浏览器的情况下模拟浏览器”的喋喋不休。听起来像机械化，但不是我目前理解的 Python3。

**：：我的问题：：**

有任何建议、指示、解决方案或“看这里”的指示吗？

非常感谢，

迈尔斯，尘土飞扬的沙漠村民。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-03T23:26:26.313

当页面通过 javascript 加载数据时，它必须向服务器发出请求以通过 XMLHttpRequest 函数 (XHR) 获取该数据。您可以查看他们提出的请求，然后使用 wget 自己提出请求！

要找出他们发出的请求，请使用 Web Inspector（Chrome 和 Safari）或 Firebug (Firefox)。以下是在 Chrome 中执行此操作的方法：

扳手/工具/开发者工具/网络（工具顶部的选项卡）/底部的 XHR 过滤器。

[这是他们在 javascript 中提出的示例请求](http://performance.morningstar.com/Performance/fund/trailing-total-returns.action?t=VHCOX&s=SPYZ&ndec=2&ep=true&align=d&annlz=true&cur=USD&region=USA&culture=en-US&ops=clear&comparisonRemove=true&loccat=&taxadj=&restr=true&pageCacheFlag=true&productCode=COM&version=&benchmarkSecId=&benchmarktype=)

如果您仔细查看 XHR 请求 url，您会注意到所有尾随返回具有相同的格式：

[http://performance.morningstar.com/Performance/cef/trailing-total-returns.action?t=](http://performance.morningstar.com/Performance/cef/trailing-total-returns.action?t=)

您只需要指定`t`. 例如：

[http://performance.morningstar.com/Performance/cef/trailing-total-returns.action?t=VAW](http://performance.morningstar.com/Performance/cef/trailing-total-returns.action?t=VAW) [http://performance.morningstar.com/Performance/cef/trailing-total-returns.action?t=INTC](http://performance.morningstar.com/Performance/cef/trailing-total-returns.action?t=INTC) [http://performance.morningstar.com/Performance/cef/trailing-total-returns.action?t=VHCOX](http://performance.morningstar.com/Performance/cef/trailing-total-returns.action?t=VHCOX)

现在您可以`wget`直接解析这些 URI 并解析出数据。

# python - 如何使用 Python io 模块构建内存驻留数据结构？

> ID：11804502
> 
> 赞同：3
> 
> 时间：2012-08-03T23:20:44.587
> 
> 标签：python, io, data-acquisition

我正在尝试将从数据采集系统收集的数据写入内存中的位置，然后对数据进行异步进一步处理，或者将其写入文件以进行离线处理。我正在尝试以这种方式实现这种架构，以将数据采集与数据分析和传输隔离开来，为我们未来的扩展和改进提供了一些灵活性，但它肯定比简单地将数据直接写入文件更复杂。

这是我写的一些探索性代码。

```
#io.BufferedRWPair test
from io import BufferedRWPair

# Samples of instrumentation data to be stored in RAM
test0 = {'Wed Aug  1 16:48:51 2012': ['20.0000', '0.0000', '13.5', '75.62', '8190',
                    '1640', '240', '-13', '79.40']}
test1 = {'Wed Aug  1 17:06:48 2012': ['20.0000', '0.0000', '13.5', '75.62', '8190',
             '1640', '240', '-13', '79.40']}

# Attempt to create a RAM-resident object into which to read the data.
data = BufferedRWPair(' ', ' ', buffer_size=1024)

data.write(test0)
data.write(test1)

print data.getvalue()

data.close() 
```

这里有几个问题（也许更多！）：

-> 'data' 是一个变量名，用于选取我正在尝试组装的构造（Python 之外）——这是一个类似数组的结构，应该保存顺序记录，每条记录包含多个过程数据测量值，前言通过可以作为检索键的时间戳。我将此作为我的设计意图的背景，以防代码太模糊而无法反映我的真实问题。

-> 此代码不起作用，因为未创建“数据”对象。我只是想打开一个空缓冲区，稍后再填充，但 Python 正在寻找两个对象，一个可读，一个可写，它们在我的代码中不存在。因此，我不确定我是否使用了正确的构造，这会导致以下问题：

1.  io.BufferedRWPair 是处理这些数据的最佳方式吗？我已经尝试过 StringIO，因为我使用的是 Python 2.7.2，但没有运气。我喜欢带有时间戳键的记录的想法，因此我选择了 dict 结构，但我肯定会考虑替代方案。我应该看其他 io 类吗？

2.  我看过的另一种选择是在 NumPy/SciPy/Pandas 世界中定义的 DataFrame 构造。它看起来很有趣，但似乎需要很多额外的模块，所以我回避了。我对这些模块中的任何一个都没有经验——我应该查看这些更复杂的模块来获得我需要的东西吗？

我欢迎任何建议或反馈，伙计们......感谢您查看这个问题！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T23:33:53.820

如果我理解您的要求，那么使用内存中的 sqlite 数据库可能是可行的方法。Sqlite 允许您完全在内存中创建功能齐全的 SQL 数据库。您可以进行选择和插入，而不是读取和写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T16:55:46.293

编写一种机制来在内存中保存合适的数据，并且只在必要时将其写入文件是多余的——操作系统无论如何都会为你做这件事。如果您使用普通文件并从应用程序的不同部分访问它，只要有足够的内存可用，操作系统就会将文件内容保存在磁盘缓存中。

如果您想通过内存地址访问文件，您可以使用[`mmap`](http://docs.python.org/library/mmap.html)模块对其进行内存映射。但是，我的印象是，您所需要的只是一个标准数据库，或者 Python 标准库提供的更简单的替代方案之一，例如[`shelve`](http://docs.python.org/library/shelve.html)any[`anydbm`](http://docs.python.org/library/anydbm.html)模块。

[`Redis`](http://redis.io/)根据您的评论，还可以查看和之类的键值对存储[`memcached`](http://memcached.org/)。

# ruby - Sinatra、Mongoid、Heroku、MongoHQ：连接到 Mongodb

> ID：11804510
> 
> 赞同：2
> 
> 时间：2012-08-03T23:21:41.823
> 
> 标签：ruby, mongodb, sinatra, mongoid

尝试在 Heroku (MongoHQ) 上使用 Sinatra 启动并运行 Mongoid。以前使用过 Rails，但第一次使用堆栈和 Sinatra。

从网络上的一个简单示例开始（`app.rb`）：

```
require 'rubygems'
require 'sinatra'
require 'mongo'
require 'mongoid'

configure do
  Mongoid.load!('mongoid.yml')

  Mongoid.configure do |config|
    if ENV['MONGOHQ_URL']
      conn = Mongo::Connection.from_uri(ENV['MONGOHQ_URL'])
      uri = URI.parse(ENV['MONGOHQ_URL'])

      # problem happens here 
      config.master = conn.db(uri.path.gsub(/^\//, ''))
    else
      config.master = Mongo::Connection.from_uri("mongodb://localhost:27017").db('test')
    end
  end
end

# Models
class Counter
  include Mongoid::Document

  field :count, :type => Integer

  def self.increment
    c = first || new({:count => 0})
    c.inc(:count, 1)
    c.save
    c.count
  end
end

# Controllers
get '/' do
  "Hello visitor n" + Counter.increment.to_s
end 
```

供参考，`mongoid.yml`如下所示：

```
development:
  sessions:
    default:
      database: localhost
production:
  sessions:
    default:
      uri: <%= ENV['MONGOHQ_URL'] %> 
```

根据`app.rb (# problem happens here)`，我的日志说：

```
/app/app.rb:15:in `block (2 levels) in <top (required)>': undefined method `master=' for Mongoid::Config:Module (NoMethodError)
    from /app/vendor/bundle/ruby/1.9.1/gems/mongoid-3.0.3/lib/mongoid.rb:112:in `configure'
from /app/app.rb:11:in `block in <top (required)>'
from /app/vendor/bundle/ruby/1.9.1/gems/sinatra-1.3.2/lib/sinatra/base.rb:1273:in `configure'
from /app/app.rb:8:in `<top (required)>' 
```

我也尝试过变体，包括：

```
config.master = Mongo::Connection.from_uri(ENV['MONGOHQ_URL']).db('appXXXXX')
Mongoid.database = Mongo::Connection.from_uri(ENV['MONGOHQ_URL']).db('appXXXXXXX') 
```

但得到同样的错误：

```
undefined method `master` for Mongoid::Config:Module (NoMethodError) 
```

或者：

```
undefined method `database=` for Mongoid::Config:Module (NoMethodError) 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T23:09:03.137

使用 Mongoid 3.x 也是如此……其中：

*   不使用 10gen 驱动程序：使用轻便摩托车
*   不使用`config.master`

上面遍布网络的规范示例代码在 Mongoid 2.x 中开箱即用，因此暂时回落到那个位置。

谢谢！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T12:56:14.457

不应该

```
configure do
  Mongoid.load!('mongoid.yml')
end 
```

足够的？

这就是[mongid 文档](http://mongoid.org/en/mongoid/docs/installation.html#configuration)所说的。`MONGOHQ_URL`环境变量已经包含了初始化数据库连接的所有信息。

# javascript - 解析具有 target="new" 的链接并添加 onclick 事件

> ID：11804514
> 
> 赞同：1
> 
> 时间：2012-08-03T23:22:00.333
> 
> 标签：javascript

我有一个可以动态生成链接的网站。我想看看是否可以添加一个 onclick 事件处理程序来跟踪外部链接。我正在寻找具有 target="new" 的链接（这意味着我们网站的外部）并添加事件处理程序

html代码

```
 <a target="new" href="http://twitter.com/cnn">CNN</a> 
```

我尝试测试的代码不起作用。让我知道我的代码有什么问题，或者我是否应该将 onclick 事件附加到外部链接？

js代码

```
var links = document.getElementsByTagName("a");
for (var i=0; <links.length; i++) { 
    if(links[i].target == 'new'){   
        links[i].onclick = function() {
            alert("Added onClick: " + links[i].href);        
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:27:37.333

您可以`this`在 onclick 函数中使用并避免关闭问题

```
var links = document.getElementsByTagName("a");
for (var i=0; i<links.length; i++) { 
    if(links[i].target == 'new'){   
        links[i].onclick = function(){  
            alert("Added onClick: " + this.href);           
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T23:49:01.157

这里的另一个答案是您应该使用什么（使用它），但值得解决 for 循环中的闭包问题。

如果要在 for 循环中创建的闭包中的 for 循环中使用每次迭代都会更改的变量，请定义并调用一个匿名函数，该函数返回一个要绑定（绑定？）到 onclick 事件的函数。

```
var links = document.getElementsByTagName("a");
for (var i=0; i<links.length; i++) { 
    if(links[i].target == 'new'){   
        links[i].onclick =
            function (obj) {
                return function(event) {
                    alert("Added onClick: " + obj.href);        
                }                   
            }(links[i]);
    }
} 
```

由于匿名函数的参数 (obj) 是按值传递的，因此在 for 循环的后续迭代中不会更改。返回的函数将拥有自己的对象副本。

当您将函数视为可以传递的对象时，Javascript 中的很多东西开始变得有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T23:34:37.527

你对 jQuery 不利吗？

```
$("a[target='new']").click(function(){alert($(this).attr("href"));}); 
```

# google-app-engine - exit() 函数创建 500 错误（Google App Engine 和 Python 2.7）

> ID：11804518
> 
> 赞同：0
> 
> 时间：2012-08-03T23:22:19.357
> 
> 标签：google-app-engine, python-2.7

我创建了一个检查参数并决定运行其余代码的函数。我看起来像：

```
def assert_something(a):
    if a>3:
        exit(0) 
```

我尝试使用类似的东西：

```
class SomeHandler(webapp2.RequestHandler):
    def get(self,parameter):
        #check and if something wrong then quit
        assert_something(parameter)

        #otherwise do other things 
```

问题是`exit()`函数总是使用 500 代码创建响应。

如何修改此代码，以便我可以使用 200 代码退出此请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:39:54.387

问题在于，由于您使用的是框架，很多事情都发生在幕后，例如在您的一个处理程序返回标头并将其他信息发送到浏览器之后。但是当您退出时，您会中断正常流程，因此会出现内部服务器错误。

您可以做的是拥有一个声明参数有效的装饰器。请注意，如果参数无效，您仍然应该为用户提供一些有用的东西。

装饰器可能是这样的：

```
from functools import wraps

def assert_something(f):
  @wraps(f)
  def wrapper(*args, **kwds):
    if args[1] > 3: #args[0] is self, args[1] is parameter. Better to use kwargs
      return None
    return f(*args, **kwds)
  return wrapper 
```

然后将其用作：

```
@assert_something
def get(self, parameter):
  ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T20:22:19.987

您可以使用 return 代替：

```
def everything_ok(a):
  return a <= 3

class SomeHandler(webapp2.RequestHandler):
    def get(self,parameter):
        if not everything_ok(parameter)
           #if you want to return something
           #self.response.out.write("")
           return

        #do something else 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T23:30:38.997

您不能退出（），这将引发您发现的错误。

您需要构建一个有效的响应（它可能是空的）。

阅读[http://webapp-improved.appspot.com/guide/response.html](http://webapp-improved.appspot.com/guide/response.html)

如果你需要返回某种 HTTP 错误，你仍然需要构造一个有效的响应。

# c# - 检测 HTTP 响应中的流数据

> ID：11804520
> 
> 赞同：1
> 
> 时间：2012-08-03T23:22:33.080
> 
> 标签：c#, .net, sockets, http-headers

我创建了一个简单的代理服务器，一切都在处理视频请求等无流媒体。正如我所说，这是一个代理，我正在使用套接字。我想知道是否有任何方法可以检测 HTTP 响应包含流数据，例如特定标头，让我知道该响应包含流数据？所以我可以检测到这一点并使用 UDP 将数据发送回客户端。

# java - How to make Integer.toBinaryString return at least 4 bits

> ID：11804525
> 
> 赞同：5
> 
> 时间：2012-08-03T23:23:42.053
> 
> 标签：java, binary, decimal

I am writing a method where I am converting int values into binary strings and storing them. I am using the method Integer.toBinaryString to do so, and it's working correctly, but the problem is that I need the method to return exactly 4 bits in the string instead of less (it will never be more because the numbers are not large enough). Here is an example of my code and where the problem is occurring:

```
int value5 = 3;
String strValue5 = Integer.toBinaryString(value5);
for(int index = 0; index < 4; index++){
     sBoxPostPass[4][index] = strVal5.charAt(index);
} 
```

Clearly, this will throw an ArrayOutOfBoundsException because `strValue5 == 11` and not `0011`, like it needs to be. I hope this is sufficiently clear. Thanks in advance for the help.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T08:13:17.733

A trick to return at least 4 digits is have a 5 digit number and chop off the first digit.

```
String strValue5 = Integer.toBinaryString(value5 + 0b10000).substring(1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T23:44:57.837

I'm not guaranteeing this is the most efficient method, but you can always make your own method that calls Integer.toBinaryString and formats it appropriately:

```
public static String toBinaryStringOfLength(int value, int length) {
    String binaryString = Integer.toBinaryString(value); 
    StringBuilder leadingZeroes = new StringBuilder();
    for(int index = 0; index < length - binaryString.length(); index++) {
        leadingZeroes = leadingZeroes.append("0");
    }

    return leadingZeroes + binaryString;
} 
```

Keep in mind I didn't account for the situation in which the value you're sending requires more bits to represent in binary than the length that you provide.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T23:38:52.867

If your value will always have exactly 4 bits then that's small enough to use a look-up table for the 16 values in question. Correcting any errors in my Java is left as an exercise for the reader.

```
static String binary4[16] = {"0000", /* another exercise for the reader */, "1111"};
static String toBinary4(int value) {
    return binary4[value & 0xF];
} 
```

# wordpress - BuddyPress 中的 PHP 回显功能可超链接到会员资料页面

> ID：11804527
> 
> 赞同：0
> 
> 时间：2012-08-03T23:24:01.073
> 
> 标签：wordpress, buddypress

当我第一次在我的网站上设置 BuddyPress 时，启用了根配置文件。基本上，如果注册用户想要编辑其个人资料的帐户设置，他们可以执行此操作的 URL 将是：“domain.com/username”。但是，如果您在浏览器中输入“domain.com/members/username”，您将获得完全相同的页面。

我决定不希望启用根配置文件，因为我更喜欢 URL：“domain.com/members/username”，因此基于本指南（http://codex.buddypress.org/extending-buddypress/changeing-internal -configuration-settings），我将functions.php中的代码编辑成这样：

```
 define ( 'BP_ENABLE_ROOT_PROFILES', false ); 
```

但是，在我的导航所在的 header.php 中，PHP 函数仍然链接到我想要禁用的根配置文件。这是它的样子：

```
 <a href="<?php echo bp_loggedin_user_domain() ?>">Profile</a> 
```

我试图弄清楚如何更改函数以使其链接到：“domain.com/members/username”而不是“domain.com/username”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T06:44:13.000

请删除`define ( 'BP_ENABLE_ROOT_PROFILES', false );`您的 function.php 文件中的 。

因为 Buddypress 默认提供 domain.com/members/username。

如果上面的代码在那里，请检查 wp-config.php 文件，只需将其删除

请试试这个

# javascript - 在javascript中拆分字符串时转义引号

> ID：11804528
> 
> 赞同：2
> 
> 时间：2012-08-03T23:24:07.557
> 
> 标签：javascript

> **可能重复：**
> [用于解析 CSV 数据的 Javascript 代码](https://stackoverflow.com/questions/1293147/javascript-code-to-parse-csv-data)

简单直接，如果我有这样的字符串： 1001,"abc, xyz", 34

我希望它分成 3 个字符串而不是 4 个。如果我使用 split(',')，它将 abc 和 xyz 分成两个字符串，但是我希望它作为一个字符串，因为它在双引号内。

所以我的最终结果应该是：

```
1001
abc, xyz
34 
```

我应该在 split() 中使用什么，以便获得预期的输出？

# javascript - Sencha Touch 2 - 选项卡式面板中的轮播

> ID：11804535
> 
> 赞同：0
> 
> 时间：2012-08-03T23:24:55.917
> 
> 标签：javascript, sencha-touch, sencha-touch-2, carousel

我想查看 2 个 v-box 位于两个不同选项卡中的视图。我的代码没有显示错误，但唯一显示在没有选项卡的选项卡式面板中的内容。您可以看到部分编辑了教程 Carousel 并带有一些相同类的副本，但请忽略它。

```
Ext.define("caryhartline.view.Carousel", {
    extend : 'Ext.tab.Panel',
    requires : ['Ext.carousel.Carousel'],
    config : [{
        tabBarPosition : 'top',
        items : [{
            title : 'Business',
            iconCls : 'action',
            layout : 'card',
            config : [{
                cls : 'cards',
                layout : {
                    type : 'vbox',
                    align : 'stretch'
                },
                defaults : {
                    flex : 1
                },
                items : [{
                            xtype : 'carousel',
                            items : [{
                                        html : '',
                                        cls : 'card businesstemplatepicture'
                                    }, {
                                        html : '',
                                        cls : 'card businesstemplatepicture'
                                    }]
                        }, {
                            xtype : 'carousel',
                            ui : 'light',
                            direction : 'vertical',
                            items : [{
                                        html : '',
                                        cls : 'card dark businesstemplate2picture'
                                    }, {
                                        html : 'And can also use <code>ui:light</code>.',
                                        cls : 'card dark'
                                    }, {
                                        html : 'Card #3',
                                        cls : 'card dark'
                                    }]
                        }]
            }]
        }]
    }, {
        title : 'Minimalist',
        iconCls : 'action',
        layout : 'card',
        config : {
            cls : 'cards',
            layout : {
                type : 'vbox',
                align : 'stretch'
            },
            defaults : {
                flex : 1
            },
            items : [{
                        xtype : 'carousel',
                        items : [{
                                    html : '',
                                    cls : 'card businesstemplatepicture'
                                }, {
                                    html : '',
                                    cls : 'card businesstemplatepicture'
                                }]
                    }, {
                        xtype : 'carousel',
                        ui : 'light',
                        direction : 'vertical',
                        items : [{
                                    html : '',
                                    cls : 'card dark businesstemplate2picture'
                                }, {
                                    html : 'And can also use <code>ui:light</code>.',
                                    cls : 'card dark'
                                }, {
                                    html : 'Card #3',
                                    cls : 'card dark'
                                }]
                    }]
        }
    }]
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T02:51:13.047

出于某种原因，将东西放入配置会导致问题。不知道出了什么问题。我认为当我们不能在类定义中使用嵌套配置时。但这应该有效

```
Ext.define("App.view.Carousel", {
    extend : 'Ext.tab.Panel',
    requires : ['Ext.carousel.Carousel'],
    config : {
        tabBarPosition : 'top',
        items : [{
            title : 'Business',
            iconCls : 'action',
            cls : 'cards',
            layout : {
                type : 'vbox',
                align : 'stretch'
            },
            defaults : {
                flex : 1
            },
            items : [{
                xtype : 'carousel',
                items : [{
                    html : 'Test 1',
                    cls : 'card businesstemplatepicture'
                }, {
                    html : 'Test 2',
                    cls : 'card businesstemplatepicture'
                }]
            }, {
                xtype : 'carousel',
                ui : 'light',
                direction : 'vertical',
                items : [{
                    html : 'Test 3',
                    cls : 'card dark businesstemplate2picture'
                }, {
                    html : 'And can also use <code>ui:light</code>.',
                    cls : 'card dark'
                }, {
                    html : 'Card #3',
                    cls : 'card dark'
                }]
            }]
        }, {
            title : 'Minimalist',
            iconCls : 'action',
            xtype:'panel',            
            layout:'vbox',
            defaults:{
                flex:1
            },
            items:[{
                xtype : 'carousel',
                direction:'vertical',
                items:[
                    {
                        style:'background-color:blue;'
                    },
                    {
                        style:'background-color:red;'
                    }
                ]
            },{
                xtype : 'carousel',
                direction:'horizontal',
                items:[
                    {
                        style:'background-color:green;'
                    },
                    {
                        style:'background-color:orange;'
                    }
                ]
                }
            ]
        }]
    }
}); 
```

# python - 以 git 安全的方式从子目录导入 python

> ID：11804537
> 
> 赞同：4
> 
> 时间：2012-08-03T23:25:04.187
> 
> 标签：python, git, pythonpath

这是我当前的目录结构：

```
proj/
proj/__init__.py
proj/submodFolder/
proj/submodFolder/submod/
proj/submodFolder/submod/__init__.py 
```

我正在写一个项目，我想拥有`import submod`甚至`import submodFolder.submod`在`proj/__init__.py`. 但是，如果没有`__init__.py`submodFolder，这将不起作用。

假设 submodFolder 是一个 git 存储库，我有 sub-repoed（如果你愿意的话，一个第三方库）；添加必需品`__init__.py`将破坏 git 子存储库并使从其主存储库更新库变得复杂。

假设 submodFolder 是不可变的 git sub-repo 将 python 向下推到模块的最佳方法是什么？修改 python 路径对我来说似乎是最接近的解决方案——但已经提出的问题都没有假设一个不可变的 submodFolder。

欢迎示例，注意相对路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:44:59.230

如果您不想修改 PYTHONPATH 环境变量，您可以`sys.path`在 proj/__init__.py 内部进行修改，以下应该可以工作：

```
import sys
import os
sys.path.append(os.path.join(os.path.dirname(os.path.realpath(__file__)), 'submodFolder'))

import submod 
```

带有注释的分步代码，因此更有意义：

```
# get absolute path to proj/__init__.py
script_path = os.path.realpath(__file__)

# strip off the file name to get the absolute path to proj
proj_path = os.path.dirname(script_path)

# join on os.sep to get absolute path to proj/submodFolder
submod_path = os.path.join(proj_path, 'submodFolder')

# add the complete path to proj/submodFolder to sys.path
sys.path.append(submod_path) 
```

# java - EventListeners 和自定义 gui 组件

> ID：11804542
> 
> 赞同：6
> 
> 时间：2012-08-03T23:26:49.263
> 
> 标签：java, swing, user-interface, actionlistener

我有一个 SWING GUI 类，它为显示的一部分实例化一个自定义 JPanel。这个自定义类具有按钮和文本字段等。拥有自定义 JPanel 的我的 GUI 类也有一个控制器类，用于处理我的数据模型的修改。如何将自定义面板中的操作传递给它的所有者（我的 gui 类）来处理事件？

我曾想过，也许我可以在自定义面板的构造函数中添加对 gui 中的控制器类的引用，以便我可以将其设置为按钮上的 actionListener。这种方法是否可取？有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T23:35:15.893

您的`View`代码（您的自定义`JPanel`）应该有一个`Controller`字段（或获取控制器类的其他方式）。这样，当您收到来自用户的操作（例如鼠标单击按钮）时，您可以调用`controller.doTheAppropriateAction()`. 要么在构造时传入，要么`Controller`在其上使用 Javabean 设置器模式，并在构造之后在启动逻辑中设置它（这听起来像你的“GUI 类”）。我更喜欢 Javabean 模式，因为 GUI 编辑器需要无参数构造函数。

您应该将您`View`的注册为`Listener`相关`Controller`（或`Model`）类，以便在发生任何变化时自动通知您 - 这样您就可以使用`repaint()`您`Component`的 s（或做一些更高级的事情）。这将涉及在（或）中设置您自己的`interface`（用于`View`实现）和侦听器处理逻辑。`Controller``Model`

[Lombok PG](https://github.com/peichhorn/lombok-pg/wiki/%40ListenerSupport)从后者中取出样板。

`akf`提供了另一种选择：将您的注册`Controller`为`ActionListener`您的`View`代码。这种方法的优点是您的`View`代码不会被绑定到特定的`Controller`- 但缺点是您`Controller`将被绑定到您的`View`代码。`Controller`我倾向于为不同的 UI 实现（例如 Swing、GWT、JSP）重用代码，因此我`Controller`的 s 和`Model`s 永远不会依赖于任何特定的`View`或原子的用户操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T23:38:10.370

您可以将对父 GUI 的引用作为`ActionListener`自定义面板传递。然后，您的自定义面板可以使用您`ActionListener`的所有按钮等注册您的 -implementing 父类。

然后，您的父类将收到有关每个操作的通知。

# php - php 提供下载后刷新

> ID：11804543
> 
> 赞同：3
> 
> 时间：2012-08-03T23:26:53.770
> 
> 标签：php, javascript, header, download, refresh

第 1 页链接到第 2 页。第 2 页使用以下代码提供下载：

```
header("Content-disposition: attachment; filename= '$filename'");
header('Content-type: application/pdf');
readfile($file);
header("location: mainpage.php"); 
```

结果是用户“停留”在第 1 页上，但提供了下载服务。

如何进行设置，以便用户保留在第 1 页上，但在提供下载后刷新。

我不知道 javascript，所以我希望有一个纯粹的 PHP 解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:52:06.917

Didn't know of this before, but it's just one of the nice HTTP headers and most of us already know of it from HTML: `Refresh`.

Just add the following `header` call:

```
header('Refresh: 0; url=http://stackoverflow.com/'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-04T00:18:06.997

在我看来，我认为您根本不需要刷新 page1。您应该能够通过 page1 中的链接强制下载。见下文：

Page1.php 带链接

```
<a href="http://www.domain.com/page2.php?pdf=name-of-pdf">Download PDF</a> 
```

Page2.php

```
$filename = $_GET['pdf'] . '.pdf';

header('Content-type: application/pdf');
header("Content-disposition: attachment; filename= '$filename'");
header("location: $filename"); 
```

这将允许在您停留在 page1 时开始下载。

希望这是你的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-21T02:41:35.280

不知道你是否得到了这个答案，但我遇到了同样的问题，这是我的解决方案 AJAX jquery

```
$(function(){

$("#itemList").on("click", "a.downloadLink", function(){ //this binds a click event handler on the itemList container that will listen out for any a with class of downloadLink inside it being clicked

       var link = $(this);
       var item = link.parent();
       var forId = item.data("itemid");
       var started = new Date(); //the alternative to tracking time elapsed is to just use a simple counter you increment - "poll 5 times" etc. if your doing .5 second intervals, then 5 times = 2.5 seconds for example. Time elapsed may result in less polls, if a poll takes a long time to return, for example. Use whichever approach feels better.
       var maxTime = 5000; //5 seconds
       function poll(){
             $.ajax({
                type: "POST",
                url: "Watergetstatus.php", 

                  data: {FID: forId},   //this will be turned into a request for page1?forId=1&oldValue=2  - I expect it in this example to return a json-encoded response of {"changed":true|false, "newHtml":"replacementContent on success"}
                  datatype :'json',
                  success: function(data){
                         if (data.changed=true)
                         {
                         window.location.reload(true);
                         }
                         else {
                               var elapsed = (new Date())-started;
                               //window.location.reload(true);
                               if (elapsed <= maxTime) setTimeout(poll, 500); // Poll again in .5 seconds
                               //else you can assume the link didn't open / work / the database never changed etc - handle or ignore as needed
                          }
                   },
                   error: function() {
                       alert("borken");  //the request to the server bombed out; up to you if you want to simply re-queue for another try like above until the expiry time or if you want to show an error or just simply ignore it.
                   }
             });
       }

       setTimeout(poll, 500); //wait 0.5 seconds before polling
});

}); 
```

HTML 有大量动态链接

```
<div data-itemid="<?php echo $row_Files['FID']; ?> " >
<a class="downloadLink" href="PLC_FILES/WaterCheckOut.php?FID=<?php echo $row_Files['FID']; ?> " target=""><img src="PLCImages/download.fw.png"></a>
</div> 
```

轮询文件 watergetstatus.php

```
mysql_select_db($database_PLC, $PLC);
$query_files = "SELECT * FROM files WHERE FID = '{$_POST['FID']}'";
$files = mysql_query($query_files, $PLC) or die(mysql_error());
$row_files = mysql_fetch_assoc($files);
$totalRows_files = mysql_num_rows($files);

if($row_files['Status'] ==2)
{
        $data= array("changed"=>true); 
        echo json_encode($data);
}
else
{
        $data= array("changed"=>false); 
        echo json_encode($data);
} 
```

下载文件链接 watercheckout.php

```
if ( $row_files['Status']==1 ) {

$file_path  = $row_files['FileName'];;
$path_parts = pathinfo($file_path);
$file_name  = $path_parts['basename'];
$file_ext   = $path_parts['extension']; 

 $content_types = array(
            "exe" => "application/octet-stream",
            "zip" => "application/zip",
            "mp3" => "audio/mpeg",
            "mpg" => "video/mpeg",
            "avi" => "video/x-msvideo",
    );
    $ctype = isset($content_types[$file_ext]) ? $content_types[$file_ext] : $ctype_default;

$file = $row_files['FileName'];
$path = "Historical/".date('Y-m-d-His');
$newfile = $path."_".$file;
$today = date('Y-m-d H:i:s');

header('Content-disposition: attachment; filename='.$file);
header("Content-Type: " . $ctype);
header('Content-Length: ' . filesize($file));
header('Content-Transfer-Encoding: binary');
header('Cache-Control: must-revalidate');
header('Pragma: public');
mysql_select_db($database_PLC, $PLC);
mysql_query("UPDATE files SET Status = '2'");

ob_clean();
flush();

readfile($file);
rename($file, $newfile); 
```

我已经简化了我的代码并删减了很多，所以它可能会遗漏一些东西，但这是我使用的一般框架，它适用于我

希望这对某人有所帮助，因为那里没有多少

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T23:37:46.330

您可以通过 $_SERVER['HTTP_REFERER'] 来检查引用者是什么。所以你应该可以把它放在你的 page1.php 中：

```
if($_SERVER['HTTP_REFERER'] == page2.php) {
  echo "<meta http-equiv=\"refresh\" content=\"0;url=http://www.yourdomain.com/page1.php\">";
exit();
} 
```

这样，您检查您的访问者是否来自 page2.php，如果是，您只解析一个刷新浏览器的元标记。当它刷新时，它不会再次刷新，因为 HTTP_REFERER 现在是 page1.php。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-08-22T17:13:43.763

```
//----------------- TOP OF DOWNLOAD_PAGE.PHP ----------------------

$download_code = mysql_real_escape_string(urldecode($_GET['code']));
$download = mysql_real_escape_string(urldecode($_GET['download']));

$self = $_SERVER["PHP_SELF"]."?code=$download_code";

//refresh page after download...

echo"
    <script type=\"text/javascript\">
        function downloadRedirect(){
           var redirect_url = \"$self\";

           setTimeout(\"DoTheRedirect('\"+redirect_url+\"')\",
            parseInt(0.5*1000));
        }
        function DoTheRedirect(url) { window.location=url; }
    </script>
";

...

$filepath = "/var/www/vhosts/YOUR_DOMAIN.com/digital_downloads/";

if (isset($_GET['download'])) {

    $file = $_GET['download'];

    if (file_exists($filepath.$download) && 
is_readable($filepath.$download) && (preg_match('/\.zip$/',$download) || preg_match('/\.zipx$/',$download) )) {

...

    header("Pragma: public");
    header("Expires: 0");
    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
    header("Cache-Control: public");
    header("Content-Description: File Transfer");
    header("Content-type: application/octet-stream");
    header("Content-Disposition: attachment; filename=\"".$download."\"");
    header("Content-Transfer-Encoding: binary");
    header("Content-Length: ".filesize($filepath.$download));
    ob_end_flush();
    readfile($filepath.$download);

}//end if file_exists

}//end if isset

//----------------- BOTTOM HALF OF DOWNLOAD_PAGE.PHP ----------------------

//link generated to download and call JS to refresh page
echo "<a href=\"".$_SERVER["PHP_SELF"]."?download=$download_id.zipx&code=$download_code\" target=\"_top\" onclick=\"javascript:downloadRedirect()\">Click to Download</a> 
```

# javascript - 如何通过 $.getScript() 获取脚本文件

> ID：11804545
> 
> 赞同：5
> 
> 时间：2012-08-03T23:26:58.160
> 
> 标签：javascript, jquery

我正在尝试从一些代码主机导入一些 javascript 文件。

```
 $.when(
        $.getScript('http://pingzi.googlecode.com/svn-history/r30/branches/wangqi/web/jquery.window.min.js'),
        $.getScript('http://mottie.github.com/tablesorter/js/jquery.tablesorter.js'),
        $.getScript('http://tconnell.com/samples/scroller/lib/jquery.tablesorter.scroller.js'),
        $.getScript('http://code.highcharts.com/stock/highstock.js'), 
        $.Deferred(
            function(deferred) { 
                $(deferred.resolve);
            }
        )
    ).done(function() {  
       // my function goes here....
    }); 
```

当我尝试调用这些 URL 来导入 js 文件时，URL 会附加`?_=1344036242417`，然后我实际上无法访问我想要的脚本文件。

IE `"NetworkError: 404 Not Found - http://pingzi.googlecode.com/svn-history/r30/branches/wangqi/web/jquery.window.min.js?_=1344036242417"`

任何人都知道如何绕过这个问题？先感谢您。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T23:48:13.487

That's because caching in ajax is turned off by default in jQuery, to turn it on and remove the querystring do :

```
$.ajaxSetup({ 
    cache: true 
}); 
```

but that could also affect other ajax calls that you don't want to cache, there's a lot more on this in the [docs for getScript](http://api.jquery.com/jQuery.getScript/), and there's even a little how-to on creating a cached getScript function called cachedScript.

You can also enable caching in $.getScript by redefining the function with a new option to turn the cache on/off by passing true or false :

```
$.getScript = function(url, callback, cache){
    $.ajax({
            type: "GET",
            url: url,
            success: callback,
            dataType: "script",
            cache: cache
    });
}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-03T23:33:09.730

`jQuery`对此类查询具有自动缓存机制。如果您不希望添加额外的参数，请使用以下设置：

```
$.ajaxSetup({
  cache: true
}); 
```

来源：[http ://api.jquery.com/jQuery.getScript/#caching-requests](http://api.jquery.com/jQuery.getScript/#caching-requests)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-03T23:31:33.587

jQuery 会自动添加`_=1344036242417`，这会破坏 URL。笔记：

*   [没有查询参数，URL 很好](http://pingzi.googlecode.com/svn-history/r30/branches/wangqi/web/jquery.window.min.js)
*   [但是它带有查询参数的 404s](http://pingzi.googlecode.com/svn-history/r30/branches/wangqi/web/jquery.window.min.js?_=1344036242417)

为了防止 jQuery 添加该参数：[Ajax get request with useless parameter](https://stackoverflow.com/questions/10425215/ajax-get-request-with-useless-parameter)。总结这个答案，`$.ajaxSetup`在调用`$.getScript()`set之前使用`cache: true`。

> 是[*原文如此*] 默认值，`$.getScript()`将缓存设置设置为`false`. 这会将时间戳查询参数附加到请求 URL，以确保浏览器在每次请求时下载脚本。您可以通过使用全局设置缓存属性来覆盖此功能[`$.ajaxSetup()`](http://api.jquery.com/jquery.ajaxsetup/)：
> 
> ```
> $.ajaxSetup({
>     cache: true
> }); 
> ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-03T23:30:38.047

附加的查询字符串是为了防止缓存。[您可以通过启用缓存](http://api.jquery.com/jQuery.getScript/)来禁用此功能：

```
$.ajaxSetup({
  cache: true
}); 
```

# javascript - 刷新闪烁（Tumblr）上的随机背景

> ID：11804546
> 
> 赞同：0
> 
> 时间：2012-08-03T23:27:04.107
> 
> 标签：javascript, html, css, tumblr

我一直试图在我的 Tumblr 主题上获得一个有效的“刷新随机背景”。对于那些不知道的人，Tumblr 主题是由嵌入了 CSS 和 JavaScript 的 HTML 组成的。

现在，我正在使用这个脚本：

```
<script type="text/javascript">
        var bg1 = 'http://i.imgur.com/image1.jpg';
        var bg2 = 'http://i.imgur.com/image2.jpg';
        var bg3 = 'http://i.imgur.com/image3.jpg';
        var bg4 = 'http://i.imgur.com/image4.jpg';
        var bg5 = 'http://i.imgur.com/image5.jpg';

        var randBG=[bg1,bg2,bg3,bg4,bg5];

        window.onload=function() {
           num=Math.floor(Math.random()*randBG.length);
           document.body.style.background='url('+randBG[num]+') no-repeat center center fixed';
</script> 
```

它可以工作，但会导致屏幕闪烁并使我的“背景尺寸：封面”属性无效。我已经尝试过图像预加载，但没有成功。Tumblr 不支持 php，而且我没有办法托管要链接的 php 文件。

**所以，有两件事。如何在没有屏幕闪烁的情况下在刷新时随机化背景，并在此过程中保持以下 CSS 属性？**

```
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:32:51.227

首先，闪烁取决于预取和背景图像的大小。因此，如果背景图像很大，它不会与文档同时准备好。其次，在`load`事件上调用它意味着您要等到所有内容都加载到屏幕上后再加载背景，因此，您正在增加延迟。第三，就像我在评论中所说的那样，您`background-size`在 Javascript 中大吃一惊，因此您需要以不同的方式进行操作。

这就是我所做的。

CSS 片段

```
<style>
...
body {
  background: url('') no-repeat center center fixed;
  -moz-background-size: cover;
  background-size: cover;
}
...
</style> 
```

Javascript

```
<script type="text/javascript">
    $(document).ready(function(){
        var bg1 = 'http://i.imgur.com/enkkn.jpg';
        var bg2 = 'http://i.imgur.com/BZBke.jpg';
        var bg3 = 'http://i.imgur.com/QOvQH.jpg';
        var bgs = [bg1, bg2, bg3];
        var num = Math.floor(Math.random() * bgs.length);
        var bg = new Image();
        bg.src = bgs[num];
        $(bg).load(function(){
            document.body.style.backgroundImage = "url(" + this.src + ")";
        });
    });
</script> 
```

注意：这些背景图像实际上很大，我不建议使用那么大的东西。保持它们压缩和小，以便它们加载更快。

我使用了 jQuery，因为它能够在`$(document).ready`事件触发时立即运行某些东西，这意味着它会在文档在后台准备好时立即触发。我也等到图像实际加载以供使用，然后才将其备份为背景图像。我不相信你能完全消除闪烁，但我认为这会有所帮助。

# php - 从 RSS 源转换日期

> ID：11804547
> 
> 赞同：1
> 
> 时间：2012-08-03T23:27:10.143
> 
> 标签：php

我正在尝试使用以下代码格式化来自 RSS 提要的日期：

```
foreach ($xml->channel->item as $item) {
    $originalDate = trim($item->pubDate);
    $newDate = date("d-m-Y", strtotime($originalDate));
    var_dump($newDate);
} 
```

日期的格式`Fri, 03 Aug 2012 13:08:11 UT`来自`$item->pubDate`. 不幸的是，此代码不起作用，结果是`"31-12-1969"`如何获得正确的日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:46:23.433

由于您似乎不需要时间，只需要日期，这对我有用：

```
$newDate = date("d-m-Y", strtotime(str_replace("UT", "", $originalDate))); 
```

PHP 似乎无法识别 UT 部分。

# redirect - 将特定网页重定向到该特定页面的移动版本

> ID：11804551
> 
> 赞同：0
> 
> 时间：2012-08-03T23:28:37.500
> 
> 标签：redirect, mobile

我们已经将我们的主站点重定向到移动版本。但是，我们需要将移动用户在移动站点上提交表单后（主站点和移动站点使用相同的表单）重定向到移动感谢页面。

目前：在 mob 网站上完成表单 > 提交 > 重定向到主站点上的感谢页面（使用相同的表单仅允许我们在提交后重定向到一个 URL - 目前此页面位于主站点上）。

我猜这将需要在主站点感谢页面上添加一些额外的 js 代码来检测并重定向到感谢页面的移动版本。

已经有人建议我们克隆表单；主站点的原始版本和移动站点的克隆版本。由于数据库要求，这不是首选选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:35:59.810

您可以使用 AJAX Post 从移动页面提交表单，然后重定向到感谢页面。

# ruby-on-rails - 如何在 has_many 上对 Active Record 关系进行分组：通过关联

> ID：11804554
> 
> 赞同：11
> 
> 时间：2012-08-03T23:28:59.237
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我想要做的是通过 has_many :through 关系的 :through 模型对 Active Record 关系中的记录进行分组，但我不知道最好的方法是什么。

首先，我的模型：

```
User has_many :subscriptions
     has_many :courses, :through => :subscriptions

Subscription belongs_to "both"

Course has_many :subs...
       has_many :users, :through => :subscriptions 
```

我像这样抓住与 current_user 相关的课程：`@courses = current_user.courses` 而且我希望能够做类似的事情：`@courses = current_user.courses.group('subscriptions.state')`<-- 这显然不起作用。

另外，在记录分组后，在视图中循环显示它们的正确方法是什么？在我的应用程序的另一个地方，我分别使用 group_by 和 each_pair 来完成此操作，但这是使用一个单独的模型。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-03T23:57:42.517

```
current_user.courses.select('courses.*, subscriptions.state').group_by(&:state) 
```

这将返回一个哈希，每个键都是一个状态。这是有效的，因为该`courses`方法已经在进行连接。

# php - PHP动态获取站点URL

> ID：11804556
> 
> 赞同：4
> 
> 时间：2012-08-03T23:29:25.610
> 
> 标签：php

我试图在不进行硬编码的情况下获取 siteurl**并将**其存储在配置文件中的常量中，这样我就可以在我的脚本中使用它，而不管嵌套/嵌套文件夹如何。此配置文件存储在网站主安装目录中的文件夹中。

**例子：**

在 www.mydomain.com 上安装网站

位于 www.mydomain.com/my_folder/configuration.php 的配置文件

想要在 configuration.php 文件中声明一个常量，以便它始终动态获取安装路径，而无需对其进行硬编码。所以`define("MY_SITE_URL", ???? )`

应该用什么代替？？？在上面的代码中，即使我的主网站安装在嵌套文件夹中也能正常工作？

**示例：所有页面都将在文件开头包含相同的 configuration.php 作为要求**

***在站点 1 中安装网站：***

网站根目录：**www.mydomain.com/demos/site1/**

配置位置：**www.mydomain.com/demos/site1/my_folder/configuration.php**

子文件夹：**www.mydomain.com/demos/site1/1/index.php**

在 index.php 中回显 MY_SITE_URL 应该给 www.mydomain.com/demos/site1/

子文件夹：**www.mydomain.com/demos/site1/1/2/index.php**

配置位置：**www.mydomain.com/demos/site1/my_folder/configuration.php**

在 index.php 中回显 MY_SITE_URL 应该给 www.mydomain.com/demos/site1/

***在站点 2 中安装网站：***

网站根目录：**www.mydomain.com/demos/site2/**

配置位置：**www.mydomain.com/demos/site2/my_folder/configuration.php**

子文件夹：**www.mydomain.com/demos/site2/1/index.php**

在 index.php 中回显 MY_SITE_URL 应该给 www.mydomain.com/demos/site2/

子文件夹：**www.mydomain.com/demos/site2/1/2/index.php**

配置位置：**www.mydomain.com/demos/site2/my_folder/configuration.php**

在 index.php 中回显 MY_SITE_URL 应该给 www.mydomain.com/demos/site2/

请注意，TLD 可以更改。这意味着，在 www.mydomain.tk、www.mydomai.org、www.mydomain.net、www.mydomain.co.ca 等上安装网站不应使代码无用。

**到目前为止我有什么：**

我试图整理一个脚本。我几乎到达那里，但不是100％。这里是：

```
function domain_url()
{
    $pageURL = 'http';
    if(isset($_SERVER["HTTPS"]))
    if ($_SERVER["HTTPS"] == "on") {$pageURL .= "s";}
    $pageURL .= "://";
    if ($_SERVER["SERVER_PORT"] != "80") 
    {
        $pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
    } 
    else 
    {
        $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
    }

    //Remove any GET params from url
    $remmove_get = strtok($pageURL, '?');
    //Removes trailing slash only at the end of string. This slash is received only when accessing a page within sub folders.
    $pageURL = preg_replace('{/$}', '', $remmove_get);

    //Remove page name
    $pageURL = dirname($pageURL);

    return $pageURL;
}
define("MY_SITE_URL", domain_url().'/'); 
```

**我当前代码的问题：**

在 www.mydomain.com/demos/site1/ 和 www.mydomain.com/demos/site1/1/ 上运行代码会将 MY_SITE_URL 设为 www.mydomain.com/demos/site1/，这是正确的。

但是当我在 www.mydomain.com/demos/site1/1/2/index.php 上运行代码时，回显 MY_SITE_URL 给了我**www.mydomain.com/demos/site1/1/**实际上我想要的是：**www.mydomain .com/demos/site1/**

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:46:34.050

如果你总是想要第二个目录，那么你可以使用

```
$boom = explode("/", $_SERVER['REQUEST_URI']);
$domain_url = $_SERVER["SERVER_NAME"].'/'.$boom[1].'/'.$boom[2];
echo $domain_url; 
```

如果该站点不在第二个目录中，您可以使用：（此代码应该更简洁一些）。只需将 site1 替换为站点名称即可

```
$site_search = "site1";
$url = $_SERVER["SERVER_NAME"].$_SERVER['REQUEST_URI'];
$domain_url = substr($url, 0, strpos($url, $site_search)+strlen($site_search));;
echo $domain_url; 
```

**更新** 这将获得 /my_folder 之前所有内容的 url

```
$domain_url = "http://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];
$domain_url = substr($url, 0, strpos($url, '/my_folder'));
define("MY_SITE_URL", domain_url().'/'); 
```

另外，您应该尝试[Code-Igniter](http://codeigniter.com/)框架。该框架使这种事情变得非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:51:03.777

试试这个：

```
define('PROTOCOL', array_key_exists('HTTPS', $_SERVER) && $_SERVER['HTTPS'] == 'on' ? 'https://' : 'http://');
define('DOMAIN', $_SERVER['HTTP_HOST']);
define('FOLDER', (dirname($_SERVER['SCRIPT_NAME']) == '/' ? null : dirname($_SERVER['SCRIPT_NAME'])) . '/');
define('BASE_URL', PROTOCOL . DOMAIN . dirname(FOLDER)); 
```

这 4 个常量应该涵盖您正在寻找的内容。我在这篇文章中写了更多关于这个的内容 - [http://bit.ly/MPls0E](http://bit.ly/MPls0E)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-28T06:37:57.823

虽然我知道这是一个非常古老的帖子，但它让我开始朝着答案的方向前进。这是我的结果。我希望这对将来的某人有所帮助。

这为您提供了安装目录：

```
$path = 'FindMe.locate';
while(! realpath($path)){
$path = '../' . $path;
}
define('DIR_FS_ROOT', dirname(realpath($path)) . '/'); 
```

对于我简单使用的网址：

```
define('HTTP_ROOT', 'http://' . $_SERVER["SERVER_NAME"] . ':8080/'); 
```

这给了我基本目录，然后我只需添加我正在寻找的任何文件。

```
echo HTTP_ROOT . 'images/logo.png';
echo DIR_FS_ROOT . 'images/logo.png'; 
```

这样您就可以在服务器端或客户端使用代码，而无需硬编码。:-)

# ios - iPhone网络请求有时不起作用

> ID：11804557
> 
> 赞同：3
> 
> 时间：2012-08-03T23:29:45.820
> 
> 标签：ios, networking, nsurlrequest

在我的应用程序中，我使用 MKNetworkKit 向我的服务器发出请求，并使用 Facebook SDK 直接调用 Facebook。有时（几天一次）我会遇到一个奇怪的问题：来自我的应用程序的所有网络请求都停止工作（对我的服务器和 Facebook 的请求）。我无法弄清楚究竟是什么步骤导致了这种情况。当我遇到问题时，我会通过手机检查其他应用程序/Safari，并且互联网连接正常。如果我关闭我的应用程序，请等待几分钟并再次打开它，然后一切都会恢复正常。我正在使用 WiFi 进行测试。什么会导致这种情况？

这似乎与这个问题完全一样：[iPhone app get into a state where network requests never complete](https://stackoverflow.com/questions/6553919/iphone-app-gets-into-a-state-where-network-requests-never-complete)，尽管我不使用 MonoTouch。

**更新：** 我确实收到了来自 MKNetworkKit 的回调，说“请求超时”（我在 MKNetworkKit 设置中有 10 秒的请求超时）。而且我没有收到来自 Facebook 的回电。

# android - Android 构建错误

> ID：11804558
> 
> 赞同：4
> 
> 时间：2012-08-03T23:29:48.437
> 
> 标签：android, eclipse, compiler-errors, preference

尝试在 Eclipse 中构建我的应用程序时出现这些错误。当编译器警告我我的 .project 文件丢失时，事情开始走下坡路。

然后我尝试修复该项目，现在出现以下错误：

> 构建过程中发生错误。在项目“net.learn2develop.Layouts.LayoutsActivity”上运行构建器“Android 资源管理器”时出错。首选项节点“org.eclipse.jdt.core”已被删除。在项目 net.learn2develop.Layouts.LayoutsActivity 上运行构建器“Android Pre Compiler”时出错。路径必须包含项目和资源名称：/net.learn2develop.Layouts.LayoutsActivity 在项目“net.learn2develop.Layouts.LayoutsActivity”上运行构建器“Java Builder”时出错。首选项节点“org.eclipse.jdt.core”已被删除。

我的项目顶部只有一个红色 x，但项目中的任何单个文件都没有。

关于如何重新创建我的 .project 文件或解决这些 Preference 节点错误的任何建议？

我是 Android/Eclipse 的新手，所以详细信息会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-26T10:48:39.980

对我有用：**文件-> 属性-> Java 编译器-> 配置工作区设置...**

然后**恢复默认值**，应用并重新启动 Eclipse。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T22:29:44.557

通过从工作区中删除所有项目然后重新导入它们，我能够修复这些非常烦人的错误。类似于 Jazzmine 的解决方案，但少了一步。现在等着看错误是否回来......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-04T00:09:31.833

我认为，我通过创建一个新工作区、将我的项目文件的副本移动到新工作区然后导入项目来解决了这个问题。不知道之前有多少文件被吹走，但从头开始似乎可以解决它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-22T12:52:16.243

基本问题是，当应用恢复默认值时，首选项代码正确地发现节点中没有保留项目特定的设置，因此它删除了节点。但是 WorkingCopyPreferences 从来没有发现这个事实，所以从那时起一颗定时炸弹就在滴答作响。

请注意，由于 JDT 选项页面都共享一个 WorkingCopyManager，但每个页面仅修改 jdt.core 设置的子集，因此任何单个页面都无法判断恢复该页面设置的默认值是否会导致节点即将被删除。所以它不能，例如，巧妙地调用WorkingCopyManager 上的removeNode()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-24T08:14:12.180

从工作区中删除项目并再次结帐并配置项目...当我从 SVN 结帐时，它对我有用。

# android - 应用程序中的用户可配置本地化

> ID：11804561
> 
> 赞同：0
> 
> 时间：2012-08-03T23:30:08.043
> 
> 标签：android, localization

我有一个应用程序，我想在其中添加本地化。但是，由于该应用程序文本繁重，并且本地化将是一个社区项目，因此翻译可能并不总是最新的。

因此，我更愿意将本地化设为可选，而不是强迫用户使用混合翻译/非翻译文本的版本。

我认为这可以使用配置和语言环境来完成，但我还没有尝试过。我确定我不是第一个需要这样做的人，那么对于那些使用 Locales 做过任何工作的人来说，推荐的处理方法是什么？潜在的陷阱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T15:27:05.353

来自评论：

您可以[`Locale`](http://developer.android.com/reference/java/util/Locale.html)使用[`Locale.setDefault()`](http://developer.android.com/reference/java/util/Locale.html#setDefault(java.util.Locale))和修改应用程序本身[`Resources.updateConfiguration()`](http://developer.android.com/reference/android/content/res/Resources.html#updateConfiguration(android.content.res.Configuration,%20android.util.DisplayMetrics))：

```
// From https://stackoverflow.com/a/4986481/1438733
Locale locale = new Locale("en"); // For English; see below for more codes
Locale.setDefault(locale);
Configuration config = new Configuration();
config.locale = locale;
getBaseContext().getResources().updateConfiguration(config,
      getBaseContext().getResources().getDisplayMetrics()); 
```

*（注意：可[在 Wikipedia](http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes)上找到 ISO 639-1 代码列表。）*

[可以在此处](https://stackoverflow.com/q/2264874/1438733)找到有关此问题的更复杂和详细的帖子。

# database - cakephp 没有从表中提取数据

> ID：11804562
> 
> 赞同：1
> 
> 时间：2012-08-03T23:30:10.197
> 
> 标签：database, cakephp, associations

我的网站/数据库设置为用户 habtm 帐户，因此当一个人创建一个帐户时，一个用户将数据保存在 accounts_users 表中。一个人登录（使用用户表中的信息）并创建一个模板，问题是accounts_templates 表没有从accounts_users 表中提取accountid，它引发了数据库错误。

帐户hambt用户，

用户hambt帐户，

账户有很多模板，

模板属于帐户

有accounts_templates，其中包含id、account_id、template_id

有accounts_users，其中包含id、account_id、user_id

有包含 id、name、description、active 的模板

有包含 id、companyname、postcode、abn 的帐户

有包含id，用户名，密码的用户

模板模型

```
<?php
    class Template extends AppModel{ 
    var $name='Template'; 
    public $useTable = 'templates';
    public $primaryKey = 'id';

    public $belongsTo = array(
        'Account' => array(
            'classname' => 'Account',
            'foreignKey' =>'account_id'
            )
        );
    } 
```

帐户模板

```
var $hasMany = array(
        'Template' =>
            array(
                'className'=>'Template',
                'foreignKey'=>'account_id',
                )
            ); 
```

从模板控制器添加功能

```
function add(){

    if($this->request->is('post')){

    $this->Template->create(); 

    if ($this->Template->save($this->request->data)) 
    { 
        $this->Session->setFlash('The template has been saved');
        $this->redirect( array('controller' => 'Fields','action' => 'add'));

    }
    else { $this->Session->setFlash('The template could not be saved. Please, try again.'); } 
    } 

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:13:46.563

我看不到你的数据库，但从你的问题来看可能有几个错误：

```
user_accounts 
```

Cakephp 中连接表的名称是错误的。它应该是：

```
accounts_users 
```

复数和按字母顺序排列。

如果创建了accounts_templates 连接表，则表示帐户HABTM 模板。你说这是一个HasMany。要么是 HasMany，然后不需要连接表，要么是 HABTM，你应该在模型中这样说。

编辑：好的。在您的问题中，您写道：

```
accounts_templates which contains id, accounts_id, templates_id 
```

它应该是：

```
id, account_id, template_id 
```

单数。

[cakephp 关系文档](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#associations-linking-models-together)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:32:40.767

实际上没有你所谓的 account_template 模型。一个帐户有一个模板，然后一个模板有多个帐户。

因此，对于此任务，您应该有两个模型：帐户和模板

```
Account Model

var $hasOne = array(
    'Template' =>
        array(
            'className'=>'Template',

            )
        );

Template Model

public $hasMany = array(
    'Account' => array(
        'classname' => 'Account',
        'foreignKey' =>'Template_id'
        )
    ); 
```

# python - python urllib2 文档登录

> ID：11804565
> 
> 赞同：0
> 
> 时间：2012-08-03T23:30:34.703
> 
> 标签：python, web-scraping, urllib2, cookielib

您将如何使用 python urllib2 登录到这样设置的网站

下面是表单上的 javascript 处理程序和 onsubmit。我将如何在 python 中处理这个？

```
<script>

function handleLogin() {document.login.un.value = document.login.username.value;document.login.width.value = screen.width;document.login.height.value = screen.height;}

</script> 
```

下面是包含要作为帖子发送的所有组件的 html 表单。让我坚持的是 onsubmit 功能。

```
<form id='login' name='login' method='post' onsubmit="handleLogin();" action='login.php'>

<input class="txtbox glow" type="text" id="username" name="username" value="blanksss">

<input class="txtbox glow" type="password" id="password" name="pw" size="18" autocomplete="off" onkeypress="checkCaps(event)">

<input class="checkbox" type="checkbox" id="rememberUn" name="rememberUn" checked="checked">

<input class="loginButton" type="submit" id="Login" name="Login" value="Login">

</form> 
```

我拥有的适用于没有 javascript 的简单网站的 Python 代码是：

```
cj = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
opener.addheaders.append(('User-agent', 'Mozilla/4.0'))
opener.addheaders.append( ('Referer', 'https://login.site.com/') )
login_data = urllib.urlencode({'username' : 'mylogin',
                               'pw' : 'mypass',
                               'Login' : 'Login',
                               'rememberUn' : 'checked'
                               })
resp = opener.open('https://login.site.com/', login_data)
website = opener.open('https://eu1.site.com/a03/o')

bowl = BeautifulSoup(website) 
```

关于如何处理 javascript 代码然后将完成的结果发布到表单的操作的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T10:12:26.703

是的，您可以使用 Web 开发人员工具尝试找出发送到服务器的内容，也可以使用 selenium webdriver 来驱动实际的浏览器。您甚至可以使用 xvfb 无头执行此操作。

```
from selenium import webdriver

browser = webdriver.Chrome()
browser.get('http://some_url.com')
browser.find_element_by_id('username').send_keys('your_login') 
browser.find_element_by_id('password').send_keys('your_password')
browser.find_element_by_id('Login').click() 

print browser.page_source
browser.close() 
```

您需要在路径中包含[chromedriver 可执行文件](http://code.google.com/p/selenium/downloads/list)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-07T16:40:15.380

使用请求

```
import requests

data = {
      "username" : "youruser",
      "password" : "yourpass",
      "Login" : "Login",
}
r = requests.post(url, data=data) 
```

此脚本适用于 Python 2.7

# bash - 运行 MATLAB 的 Bash 脚本错误

> ID：11804571
> 
> 赞同：3
> 
> 时间：2012-08-03T23:30:51.103
> 
> 标签：bash, matlab, cluster-computing, pbs

我正在尝试在集群中运行 matlab 脚本（ga_opt_main.m）。我必须编写一个作业提交文件，它本质上只是一个 shell 脚本。但我从来没有写过shell脚本，这就是我写的

```
 #!/bin/bash
  #PBS -q *queuename*
  #PBS -l nodes=1:ppn=20
  #PBS -l walltime=02:00:00
  #PBS -N ga_opt_main

  module load matlab/R2011b
  module list

  unset DISPLAY
  matlab -nodisplay -nodesktop -r *directory path/ga_opt_main.m* 
```

MATLAB 在后台打开，但我的工作没有运行。相反，我收到一个错误文件说

```
 bash: -c: line 0: syntax error in conditional expression
  bash: -c: line 0: syntax error near `fraction' 
```

关于为什么会发生这种情况以及如何避免这种情况的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:25:27.817

我以前从未使用过 PBS，但要从 shell 运行 MATLAB 脚本，请尝试以下操作：

```
matlab -nodesktop -nodisplay -r "addpath('/directory/path'); ga_opt_main; quit;" 
```

where`ga_opt_main.m`是脚本文件的名称，`'/directory/path'`是它所在的目录。请注意，您还必须在 MATLAB 路径上对该脚本有任何其他依赖项。

还有一个方便的[RUN](http://www.mathworks.com/help/techdoc/ref/run.html)函数可以做类似的事情：

```
matlab ... -r "run('/directory/path/ga_opt_main.m'); quit;" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T00:49:28.827

```
 ###############################
 #!/bin/sh
 #PBS -l nodes=1
 #PBS -l walltime=2:0:0
 #PBS -j oe
 #PBS -o localhost:/dev/null
 #PBS -d /your/working/directory

     cd $PBS_O_WORKDIR
     matlab -nodisplay -nodesktop -nojvm -nosplash -r "your_matlab_function" 
```

我喜欢添加`addpath(genpath('~/your/script's/home'));`到实际的 matlab 脚本/函数中。另外，不要将“.m”添加到您的 matlab 文件名中。

# java - Java - 最简单的方法是查找基元数组中是否存在位置？

> ID：11804574
> 
> 赞同：1
> 
> 时间：2012-08-03T23:31:25.187
> 
> 标签：java, arrays, primitive, primitive-types, indexoutofboundsexception

我有一个字符数组，对于我拥有的程序类型，它必须通过设计检查边界上的索引。我以为我已经解决了这个问题，但显然不是。那么有没有办法检查索引是否超出范围？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T23:32:45.690

获取`array.length`哪个给出了数组中存在多少个元素。可用索引将比数组长度小一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:10:26.333

我希望我能正确理解你的问题。我写了这段代码。它是一个字符数组，长度=5。现在，如果你想打印 MyArray[8]，它会给出这个错误信息：

```
java.lang.ArrayIndexOutOfBoundsException 
```

这回答了你的问题了吗？您想使用以下内容吗？：

```
if(index>MyArray.length) 
{
System.out.println("Index does not exist");

} 
```

这是代码：

```
 public class prac
        {
            public static void main(String args[])
            {
                char[] MyArray=new char[5];
                MyArray[0]='a';
                MyArray[1]='b';
                MyArray[2]='c';
                MyArray[3]='d';
                MyArray[4]='e';

                int index=7;
                System.out.println(MyArray[index]);
                System.out.println(MyArray);
                System.out.println(MyArray.length);
            }
        } 
```

# magento - 动态插入 Magento 的布局 xml

> ID：11804575
> 
> 赞同：1
> 
> 时间：2012-08-03T23:31:33.143
> 
> 标签：magento

我是 Magento 的新手。我正在尝试构建一个模块，该模块在呈现之前将代码 xml 动态插入到布局 xml 中——类似于 CMS>pages 的构建方式。

就像我们如何在页面的设计部分（管理员 > cms > 页面）中指定布局 xml 一样，我想通过我的模块插入到 layout.xml 中。

基本上，我想

*   有一个管理部分，我可以在其中通过表单输入布局代码并存储在数据库中 - 我已经弄清楚了这部分
*   让 Magento 提取这些存储在数据库中的代码，并在布局文件被聚合和解释之前创建一个 xml 文件。- 我无法构建这部分。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-04T17:23:15.377

只是一点启示您可以使用观察者添加那些布局xml，假设您希望在生成xml之前添加那些布局xml

我们可以使用事件`controller_action_layout_generate_xml_before`

这是示例代码（在`config.xml`）

```
<frontend>
    <events>
        <controller_action_layout_generate_xml_before>
            <observers>
                <add_new_layout>
                    <class>test/observer</class>
                    <method>addNewLayout</method>
                </add_new_layout>
            </observers>
        </controller_action_layout_generate_xml_before>
    </events>
</frontend> 
```

这是`Observer.php`

```
public function addNewLayout($observer){
    $layout = $observer->getEvent()->getLayout();
    $update = $layout->getUpdate();

    //$action = $observer->getEvent()->getAction();
    //$fullActionName = $action->getFullActionName();
    //in case you're going to add some conditional (apply these new layout xml on these action or other things, you can modify it by yourself)

    //here is the pieces of layout xml you're going to load (you get it from database)
    $xml = "<reference name='root'><remove name='footer'></remove></reference>";
    $update->addUpdate($xml);

    return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-20T08:04:36.823

另一种可能性是使用`core_layout_update_updates_get_after`-event 和占位符（不存在）布局 xml：

```
<frontend>
    <layout>
        <updates>
            <foobar>
                <file>foo/bar.xml</file>
            </foobar>
        </updates>
    </layout>
    <events>
        <core_layout_update_updates_get_after>
            <observers>
                <foobar>
                    <type>singleton</type>
                    <class>foobar/observer</class>
                    <method>coreLayoutUpdateUpdatesGetAfter</method>
                </foobar>
            </observers>
        </core_layout_update_updates_get_after>
    </events>
</frontend> 
```

观察者中的示例 PHP：

```
/**
 * Event dispatched when loading the layout
 * @param Varien_Event_Observer $observer
 */
public function coreLayoutUpdateUpdatesGetAfter($observer)
{
    /** @var Mage_Core_Model_Config_Element $updates */
    if (Mage::getStoreConfig('foobar/general/enabled')) {
        $file = Mage::getStoreConfig('foobar/general/layout_xml');
        if (!empty($file)) {
            $updates = $observer->getUpdates();
            if ($updates->foobar) {
                $updates->foobar->file = $file;
            }
        }
    }
} 
```

# javascript - 密码框内的文字

> ID：11804579
> 
> 赞同：0
> 
> 时间：2012-08-03T23:31:48.933
> 
> 标签：javascript, asp.net, html, passwords

我目前有一个登录框，其中显示在文本框中的文本 ID 和密码。当用户单击它时，它会消失并允许用户输入密码。但是，我将密码文本框的文本模式设置为“密码”，它似乎不再适用于密码框。有人有任何线索吗？

HTML

```
 <input name="Login1$UserName" type="text" value="NUID" id="Login1_UserName" class="txtbox" onfocus="if(this.value==this.defaultValue) {this.value='';$(this).css('color','black');}" onblur="if(this.value=='') {this.value=this.defaultValue;$(this).css('color','rgb(173,180,195)');}" style="width:240px;" />
    <span id="Login1_UserNameRequired" title="User Name is required." style="color:#DA6426;visibility:hidden;">*</span>
  </td>
</tr>
<tr>
  <td>
    <input name="Login1$Password" type="password" id="Login1_Password" style="width:240px;" />
    <span id="Login1_PasswordRequired" title="Password is required." style="color:#DA6426;visibility:hidden;">*</span>
  </td>
</tr>
<tr>
  <td align="center" style="color:#DA6426;">
  </td>
</tr>
<tr>
  <td align="right">
     <input type="submit" name="Login1$LoginButton" value="Log In" onclick="javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;Login1$LoginButton&quot;, &quot;&quot;, true, &quot;Login1&quot;, &quot;&quot;, false, false))" id="Login1_LoginButton" style="font-family:Arial;height:22px;" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:36:53.673

对asp不是很熟悉，但是使用javascript你不能改变输入的类型（出于安全原因）；如果您想要在密码输入中具有可见文本的效果，您必须物理隐藏密码并显示另一个交换的输入`onfocus`。

编辑：

这是我不久前创建的密码交换功能的链接，它是我的 js 库的一部分。对于其他人来说，我意识到它不使用 jQuery，但我在使用 jQuery 之前创建并且没有时间或理由来更新它。

[http://jsfiddle.net/thundercracker/DXLe3/1/](http://jsfiddle.net/thundercracker/DXLe3/1/)

编辑：

我很确定它是完全独立的。只需要`window.onload`使用两个输入的 ID 调用它。

还需要底部的 eventListener 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:46:50.970

这可以使用 javascript 中的 onfocus 和 onblur 事件并更改输入元素的 type 属性来完成。但是，我在某些浏览器上遇到了问题，没有将字段更改回密码输入。这是一篇使用带有验证器的 asp.net 控件完成的文章。

[http://planetofcoders.com/watermark-property-password-textbox-web-page/](http://planetofcoders.com/watermark-property-password-textbox-web-page/)

# facebook - Facebook iFrame 应用程序未在 Mountain Lion 操作系统中显示

> ID：11804588
> 
> 赞同：0
> 
> 时间：2012-08-03T23:33:10.577
> 
> 标签：facebook, osx-mountain-lion

这很奇怪。我创建了一个[Facebook iFrame 应用程序](http://www.facebook.com/YellowMountainStoneWorksInc/app_473880402626901)，它在我测试过的每个浏览器中都能正常工作。然后山狮出来了。由于某些原因，运行新操作系统和 Safari 6 的 Mac 无法看到该应用程序。Facebook chrome 在那里，但网站没有加载。（该应用程序只是一个托管在其他地方的网站）。我有另一个运行着 Safari 6 的 mac 狮子，但它运行良好。所以它必须是造成这个问题的山狮。我看不出操作系统会如何影响这一点，但似乎是这样。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:39:23.270

尝试清除浏览器的缓存。它对我来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T07:46:13.163

无论我使用什么浏览器，地址[https://www.yellow-mountain.com/latest_picture/](https://www.yellow-mountain.com/latest_picture/)都无法访问（我的浏览器尝试连接到 HTTPS 版本，因为我正在通过 HTTPS 浏览 FB）。即使在任何 iframe 之外，我也无法连接到该地址。

不过，仅通过 HTTP 即可正常工作。

因此，请与您的服务器管理员讨论如何让 SSL 为您的服务器/域工作。

# python - 实现 Class.magic_class_method

> ID：11804589
> 
> 赞同：0
> 
> 时间：2012-08-03T23:33:16.437
> 
> 标签：python, google-app-engine

Python 有一个神奇的`__getattr__`方法，允许返回自定义值：

```
class A(object):
    def __getattr__(self, name):
        return name

B = A()
print B.foo  # 'foo' 
```

但是，调用`A.foo`没有类似的效果，因为 A 不是实例。

[使用 metaclasses](https://stackoverflow.com/questions/3155436/getattr-for-static-class-variables-in-python)，Google App Engine 会在实例化时引发此错误：

```
File "/base/python27_runtime/python27_lib/versions/1/google/appengine/ext/db/__init__.py", line 913, in __init__
key_name.__class__.__name__)
    BadKeyError: Name must be string type, not tuple 
```

假设引用的问题已正确实现，魔术类还有哪些其他方法可以`__getattr__`实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:02:11.607

元类解决方案应该可以工作，这里有一个例子：

```
class GetAttrMeta(type):
    def __getattr__(self, name):
        return name

class A(object):
    __metaclass__ = GetAttrMeta

print A.foo  # 'foo' 
```

或者使用 Python 3.x：

```
class GetAttrMeta(type):
    def __getattr__(self, name):
        return name

class A(object, metaclass=GetAttrMeta):
    pass

print(A.foo)  # 'foo' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T23:44:45.133

不确定这是否回答了您的问题，但也许结帐[属性描述符](http://docs.python.org/howto/descriptor.html)..

```
class RevealAccess(object):
"""A data descriptor that sets and returns values
   normally and prints a message logging their access.
"""

def __init__(self, initval=None, name='var'):
    self.val = initval
    self.name = name

def __get__(self, obj, objtype):
    print 'Retrieving', self.name
    return self.val

def __set__(self, obj, val):
    print 'Updating' , self.name
    self.val = val

>>> class MyClass(object):
    x = RevealAccess(10, 'var "x"')
    y = 5
>>> MyClass.x
Retrieving var "x"
10
>>> MyClass().x
Retrieving var "x"
10
>>> 
>>> m = MyClass()
>>> m.x
Retrieving var "x"
10
>>> m.x = 20
Updating var "x"
>>> m.x
Retrieving var "x"
20
>>> m.y
5 
```

# c# - 如何在 Silverlight 中找到字体的 em 高度？

> ID：11804590
> 
> 赞同：1
> 
> 时间：2012-08-03T23:33:29.840
> 
> 标签：c#, silverlight, fonts

我正在尝试根据 Silverlight 中的字体大小计算字体的高度（[类似于这个人在 WPF 中需要的](https://stackoverflow.com/questions/4509613/how-to-calculate-font-height-in-wpf)）。根据我收集的信息，我需要字体的 em 高度。但是，似乎没有任何方法可以从我正在使用的[FontFamily获得这个；](http://msdn.microsoft.com/en-us/library/system.windows.media.fontfamily%28v=vs.95%29.aspx)没有什么方法可以让我自己计算得到信息。

有没有其他方法可以在代码中获得这个？

我使用 Century Gothic 作为我的字体，如果这很重要的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T01:29:14.810

如果您查看这篇[Charles Petzold MSDN 杂志关于 Silverlight 中字体度量的文章](http://msdn.microsoft.com/en-us/magazine/hh335068.aspx)，他讨论了 Silverlight 中缺少 a `Font Metric Class`。他建议使用 TextBlock 来获取文本尺寸而不渲染文本，但您可能感兴趣的是他创建了自己的 Font Metric Class，看看这是否适合您。

# java - 如何使用反射从 JPA 对象中检索私有变量属性

> ID：11804598
> 
> 赞同：0
> 
> 时间：2012-08-03T23:34:55.080
> 
> 标签：java, jpa, reflection

我的目标之一是创建一个引擎，该引擎将使用反射动态地从 JPA 对象中设置 pojo 对象中的值。匹配条件之一是字段名称应匹配。

我成功地为两个 pojo 对象实现了这个。但是当我尝试使用 JPA 对象作为对象参数之一时，它不起作用。根据我的研究，我发现方法`Class.getDeclaredFields()`，并没有给我字段的名称，而是 JPA 对象的成员变量的 getter/setter 方法名称。

任何人都可以给我一个领导或方向，比如我应该在哪里/做什么来完成这项任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:40:04.957

JPA 提供者通常会使用具体 JPA 类的[动态代理类](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Proxy.html)，因此您无法保证代理中的字段名称。关于代理的唯一保证是*方法*是相同的。使用调试器检查您尝试使用的 JPA 类实例的运行时类，您会发现问题。

您能做的最好的事情是使用反射来调用 JPA 返回的对象上的方法。

* * *

[除此之外，我真的不明白为什么你需要 POJO 化实体类，因为实体主要是带注释的...... POJO。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:53:04.370

> 匹配条件之一是字段名称应匹配。

我认为这是你问题的根源。根本无法保证 Java 对象的字段名称将匹配 getter 和 setter 的名称......或其他任何东西。如果你做出这个假设，你会遇到不起作用的情况。

最好的解决方案是干脆不使用这种方法。要求 Pojo 类符合 JavaBeans 规范并依赖 setter 来设置属性。这可能比对（私有）字段名称做出假设更有效。

* * *

事实上，使用动态代理实现的通用 JPA 对象的状态可以很好地保存在哈希映射中。您可以看到的那些字段可能只是用于其他用途的常量。

# scripting - JMeter 和端到端测试

> ID：11804606
> 
> 赞同：0
> 
> 时间：2012-08-03T23:36:06.717
> 
> 标签：scripting, jmeter, jmx

我有一个用于执行功能和负载测试的 jmx 脚本。

该脚本使用 1 个用户和多个线程用户测试了一个简单的订单管理系统，该系统执行以下操作：

1.  加载系统
2.  登录
3.  下单（选择产品，加入购物车，结账，提交订单直到订单确认页面）
4.  登出

这些步骤成为 jmx 脚本中的步骤。

执行脚本时，我看不到任何重大问题。JMeter 在收集性能指标和处理时间时不会报告任何错误。

但是测试后，当我们检查数据库（以及 JMeter 之外的系统本身）时 - 那些本应在我们运行 JMeter 测试时创建的订单并没有被创建。

我假设当 JMeter 以虚拟用户身份登录并在 UI 上执行任何事务时，这些事务会进入数据库。有一个端到端的交易。但这里的情况似乎并非如此。

关于可能导致这种情况的任何想法？
JMeter 是否真的将 UI 上的操作一直推送到后端？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T08:03:45.247

首先，JMeter 不是浏览器，它只通过服务器重现流量。

其次，您是否添加断言以检查响应是否正常并包含它们应该包含的内容？

第三，您说您使用 1 个用户和 N 个线程，这意味着您只有 1 个用户您的多线程然后您测试是错误的，因为它会引发缓存、事务争用......

我建议您首先使用一个用户检查您的脚本并查看结果树侦听器。然后通过以少量线程运行所有用户来检查您的用户。

最后运行真实负载测试。

# xml - 在 XSL 变量中搜索并插入换行符

> ID：11804608
> 
> 赞同：1
> 
> 时间：2012-08-03T23:36:19.847
> 
> 标签：xml, xslt, xml-parsing, xslt-2.0

我已经搞砸了一段时间了，我希望你们能提供帮助。所以我有一个 XSL 变量，比如

```
<xsl:variable name="blah" select="'texttexttext texttexttexttext Note:texttexttexttext'" /> 
```

我要做的是首先在 $blah 中搜索“注意：”。如果找到，请在它之前添加一个换行符，如`&#xD;`. 所以输出会像

```
blah-> "'texttexttext texttexttexttext &#xD;Note:texttexttexttext'" 
```

我可以使用通常的 contains 函数来搜索该术语，例如：

```
<xsl:if test="(contains($blah,'Note:'))">true</xsl:if> 
```

但我对替换/插入换行符感到困惑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:50:07.370

XSLT 2.0 带有一些不错的正则表达式函数。

通过使用这里的替换功能：

```
replace($blah, "(.*)(Note:.*)", "$1&amp;#xD;$2") 
```

你会得到想要的结果。所以基本上，我在之前和之后都抓住了一切，`Note:`我只是把你的换行符放在结果之间。

# backbone.js - 让 jGestures 与 Backbone.js 一起工作需要什么特别的东西吗？

> ID：11804609
> 
> 赞同：1
> 
> 时间：2012-08-03T23:36:25.753
> 
> 标签：backbone.js, jgestures

我试图让[jGestures](http://jgestures.codeplex.com)与[Backbone.js](http://backbonejs.org)应用程序一起工作，但运气不佳。

我在页面正文的底部包含了我的脚本。

```
<script type="text/javascript" src="jquery-1.7.2.js"></script>

<script type="text/javascript" src="jgestures.min.js"></script>

<script type="text/javascript" src="underscore.js"></script>
<script type="text/javascript" src="backbone.js"></script>
<script type="text/javascript" src="backbone.localStorage.js"></script>

<script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>

<script type="text/javascript" src="src/app_root.js"></script>
<script type="text/javascript" src="src/app_beverage.js"></script>
<script type="text/javascript" src="src/app_order.js"></script>
<script type="text/javascript" src="src/app_people.js"></script>
<script type="text/javascript" src="src/app_router.js"></script> 
```

并像这样附加手势处理程序。

```
events: {
    "tapone .test": "something"
} 
```

我知道事件处理程序已正确附加，因为我可以通过控制台手动触发它（在桌面上，而不是在移动设备上）。

```
$(".test").trigger("tapone"); 
```

但是在 iOS 5 中运行代码，看起来 jGestures 代码没有生成触摸事件。我需要做其他人来触发这些触摸事件吗？我正在使用主干路由器，所以也许我需要在更新 DOM 后再次初始化库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T10:24:13.770

`Backbone.View.events`直接委托`jQuery.bind`，`jQuery.delegate`查看[Backbone.View.delegateEvents 的代码](https://github.com/documentcloud/backbone/blob/master/backbone.js#L1248-1265)。

因此，如果您的事件绑定定义可以像这样工作：

```
$(<your View.el DOM element>).delegate(selector, eventName, method); 
```

然后它应该与 Backbone 一起使用。

例如，在您的情况下，您可以尝试：

```
$(<your View.el DOM element>).delegate( ".test", "tapone", function(){ console.log( "hi! tapone" ); } ); 
```

尝试直接在 jQuery 中定义事件绑定，看看是否以这种方式触发事件，如果没有，则问题出在 Backbone，如果确实如此，则问题应该出在您的实现中。我认为无论哪种情况，问题都出在 Backbone 本身。

# javascript - 如何解析来自sharepoint的json结果以显示列表名称

> ID：11804610
> 
> 赞同：0
> 
> 时间：2012-08-03T23:36:27.093
> 
> 标签：javascript, jquery, json, rest

这是我第一次与 JSon 合作，所以请不要对我粗鲁:)

我有这个网站。 [http://msdn.microsoft.com/en-us/library/jj164022(v=office.15).aspx](http://msdn.microsoft.com/en-us/library/jj164022(v=office.15).aspx)

这个javascript示例：

```
jQuery.ajax({
url: http:// site url/_api/web/lists,
type: "GET",
headers: {
"ACCEPT","application/json;odata=verbose",
"Authorization", "Bearer " + accessToken
},
}) 
```

问题是我有一个名为 results 的 div，我想显示其余服务返回给我的列表名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:41:33.253

参见 jQuery 官方文档：

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

有很多例子。

**编辑**

如果您的调用返回一个可序列化对象，您可以执行以下操作：

```
$.ajax({
   url: http:// site url/_api/web/lists,
   type: "GET",
   headers: {
      "ACCEPT","application/json;odata=verbose",
      "Authorization", "Bearer " + accessToken
   },
   success: function(data) {
    $.each(data, function(index, elem){
        //... do some work where ...
        alert(elem);
    });
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T23:51:23.573

在不知道返回的 JSON 格式的情况下，很难准确地说出如何在 div 中显示列表。但主要的想法是，您需要在 jQuery.ajax() 调用中添加一个成功回调函数，在该调用中解析返回的数据并将其插入到您的 div 中。例如：

```
jQuery.ajax({
    url: "http://siteurl/_api/web/lists",
    type: "GET",
    headers: {
        "ACCEPT","application/json;odata=verbose",
        "Authorization", "Bearer " + accessToken
    },
    success: function(data) {
        var listTitle = data.title; // just an example; not sure if this property exists in your data
        $("$myDiv").append('<p>' + listTitle + '</p>');
    }
}); 
```

# java - Rails ActiveRecord 相当于 Hibernate load()？

> ID：11804612
> 
> 赞同：0
> 
> 时间：2012-08-03T23:36:41.153
> 
> 标签：java, ruby-on-rails, ruby, ruby-on-rails-3, activerecord

我是 Rails 的新手，具有 Java 背景。

我在多对多（通过第三个连接表）关联上遇到了一些麻烦。

```
class Physician < ActiveRecord::Base
  has_many :appointments
  has_many :patients, :through => :appointments
end

class Appointment < ActiveRecord::Base
  belongs_to :physician
  belongs_to :patient
end

class Patient < ActiveRecord::Base
  has_many :appointments
  has_many :physicians, :through => :appointments
end 
```

在我的休息方法中，我将过去医生 ID 和患者 ID。要设置医生和患者连接，我使用

```
py = Physician.find(params[:physician_id])
pa = Patient.find(params[:patient_id])
py.patients<<pa 
```

我的意思是，在这里，两个选择和一个插入对我来说似乎太昂贵了。反正只要触发一次插入，因为我已经知道医生和患者存在于数据库中。

在 hibernate 中，有一个 load() 函数可以创建加载模型的代理对象而不会影响 DB。

```
Physician py = session.load(1);
Patient pa = session.load(2);
AppointmentDao.save(new Appointment(py,pa)); 
```

感谢您的任何回答。以及关于 Rails 哲学的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:46:14.310

你可以做`Appointment.create physician_id: 1, parient_id: 2`

# java - 如何在没有闪光灯的情况下与 blazeds 端点通话

> ID：11804619
> 
> 赞同：4
> 
> 时间：2012-08-03T23:37:56.437
> 
> 标签：java, javascript, blazeds

我想重用我现有的 blazeds/java/spring 应用程序来编写一些 html 5 客户端。是否有人知道具有发布/订阅功能的纯 js（不允许 swf 桥接）客户端

到目前为止，我的谷歌搜索已经找到了 2 个项目 - **jsasmf**（它使用一个小 swf）和缺少 pub/sub 的**amf.js**，但除了这 2 个之外没有其他项目

关于如何做到这一点的任何想法（疯狂很好）表示赞赏

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T12:12:30.850

这可能与另一台服务器有关。您将在该服务器上使用带有闪存的服务，并通过 Web 套接字（例如）向其他客户端公开其 api。您的客户不需要安装闪存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T13:59:12.267

为什么不使用[jersey](http://jersey.java.net/)注释来注释您的 blazeds 服务对象实现，以将其公开为休息服务。应该可以通过 blazeds 暴露相同的服务并同时休息。您可以使用[Atmosphere](https://github.com/Atmosphere/atmosphere/wiki/Getting-Started-with-the-samples)来实现 pub/sub

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:20:34.693

扩展 Erik Martino 的答案......您可以尝试使用 GWT 自己将 Java AMF 客户端编译为 JavaScript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-04T10:18:09.143

迟到了，但似乎 Adob​​e 也有一个 JS 客户端。我在资源文件夹中下载了 Dataservices ES 4.6 的踪迹。教程可以在[这里找到](http://help.adobe.com/en_US/dataservicesjee/4.6/Developing/WS74a1cc3271d4c9821a4a3ad3132cc2454ba-8000.html)

# javascript - 如何在 sharepoint 2013 中获取 oauth 访问令牌？

> ID：11804624
> 
> 赞同：27
> 
> 时间：2012-08-03T23:38:21.757
> 
> 标签：javascript, jquery, sharepoint, oauth

我在这里有这个网站：http: [//msdn.microsoft.com/en-us/library/jj164022 (v=office.15).aspx](http://msdn.microsoft.com/en-us/library/jj164022(v=office.15).aspx)

某些部分的文本说：以下 JavaScript 代码演示了如何使用 JQuery 发出此 GET 请求，该请求返回所有站点列表的 JSON 表示。它还假设您有一个存储在 accessToken 变量中的有效 OAuth 访问令牌。如果从应用程序 Web 内部进行此调用，则不需要访问令牌，就像在 SharePoint 托管的应用程序中一样。

```
jQuery.ajax({
url: http:// site url/_api/web/lists,
type: "GET",
headers: {
"ACCEPT","application/json;odata=verbose",
"Authorization", "Bearer " + accessToken
},
}) 
```

具体问题是如何获得访问令牌？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T05:28:53.523

似乎没有办法仅使用 JavaScript 获取访问令牌。您需要使用应用程序来生成访问令牌。有关如何获取令牌的更多信息，请参阅[Sharepoint OAuth 提示和常见问题解答。](http://msdn.microsoft.com/en-us/library/fp179932%28v=office.15%29)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-18T07:45:31.327

你的整个方法是不正确的。在使用 javascript 访问 sharepoint 2013 服务器的 REST 服务时，您不需要访问令牌。您必须改用 Sharepoint 2013 跨域库。

[http://msdn.microsoft.com/en-us/library/jj164022.aspx](http://msdn.microsoft.com/en-us/library/jj164022.aspx)上的页面在显示使用 oauth 令牌的经典 REST 请求后进行了解释：

> 如果您使用 JavaScript 编写应用程序但使用 SharePoint 2013 跨域库，则此请求看起来会有些不同。在这种情况下，您不需要提供访问令牌。以下代码演示了如果您使用跨域库并希望将列表的 OData 表示形式接收为 XML 而不是 JSON，则此请求的外观。有关使用跨域库的详细信息，请参阅如何：使用跨域库从远程应用程序访问 SharePoint 2013 数据。

这是目前该文章的 [网址 http://msdn.microsoft.com/en-us/library/fp179927.aspx](http://msdn.microsoft.com/en-us/library/fp179927.aspx)

这应该是你的正确答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-12T09:47:13.493

*   这回答了在线共享点的问题。
*   任何带有 OAuth2 的 SharePoint 列表都应该是类似的。
    [这谈到 Postman 或 Fiddler，但我们可以针对 JavaScript / JQuery 修改它](http://www.ktskumar.com/2017/01/access-sharepoint-online-using-postman/)

# iphone - 如何在应用程序启动时播放视频或使用完成按钮在 viewdidload 上播放视频？

> ID：11804626
> 
> 赞同：0
> 
> 时间：2012-08-03T23:38:49.280
> 
> 标签：iphone, ios, ipad

通过调用在 viewDidLoad 方法中播放视频的函数，我已经能够在应用程序启动时成功播放视频。但是这样做时，我看不到“完成”按钮。只有当我在按钮的帮助下调用相同的函数时，才会出现“完成”按钮。我在下面发布代码。我将如何通过在 viewDidLoad 方法中调用相同的函数来完成此操作？我做错了什么？谢谢！

在我的 viewcontroller.m 文件中

```
- (void)viewDidLoad
{
      [super viewDidLoad];

      [self playMedia];
}

- (void) playMedia {

        //hide status bar first
        [[UIApplication sharedApplication] setStatusBarHidden:YES];
        //resets again in playMediaFinished

        movieFile = [[NSBundle mainBundle] pathForResource:@"sec" ofType:@"mp4"];
        NSURL *url = [NSURL fileURLWithPath: movieFile];

        moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];

        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(playMediaFinished:) name:MPMoviePlayerPlaybackDidFinishNotification object:moviePlayer];

        moviePlayer.controlStyle = MPMovieControlStyleDefault;

        [moviePlayer setFullscreen:NO animated:YES];
        [self.view addSubview:moviePlayer.view];

        moviePlayer.controlStyle = MPMovieControlStyleDefault;

        CGAffineTransform transform = self.view.transform;

        [moviePlayer.view setFrame:CGRectMake(0, 0, 480, 320)];

        moviePlayer.shouldAutoplay = YES;

        NSLog(@"Should be playing Movie");

    }

- (void) playMediaFinished: (NSNotification*) theNotification {
       moviePlayer = [theNotification object];

        [[NSNotificationCenter defaultCenter] removeObserver:self name:MPMoviePlayerPlaybackDidFinishNotification object:moviePlayer];

        if ([moviePlayer
             respondsToSelector:@selector(setFullscreen:animated:)])
        {
            [moviePlayer.view removeFromSuperview];
            [playerView removeFromSuperview];
            //reset status bar
            [[UIApplication sharedApplication] setStatusBarHidden:NO];
        }    
            NSLog(@"Should be DONE playing Movie");

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T14:29:28.013

尝试使用`viewDidAppear`而不是`viewDidLoad`. `viewDidLoad`考虑到您在主视图出现在屏幕上之前呈现视频，开始播放视频会导致意外行为，我并不感到惊讶。请记住，视图在实际可见之前已完成加载。

# html - HTML5 音频/视频停止缓冲区

> ID：11804631
> 
> 赞同：2
> 
> 时间：2012-08-03T23:39:21.303
> 
> 标签：html, audio, buffer

有没有办法停止浏览器中的缓冲。

我有一个指向某个 mp3 文件的音频标签。

浏览器在播放时开始缓冲音频。

我可以停止缓冲吗？

理想情况下，我知道如果您的音频数据输入速度更快，那么客户端可以播放什么，为什么不缓冲它。

我要问的是音频播放器应该只缓冲最小数量并要求更多数据。

我知道这是一个获取请求，所以它并不是一个真正要求更多的协议。所以只需消耗一大块，玩它并消耗更多。

有任何想法吗。也许 206 并寻求功能以请求更多。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T13:32:24.087

Try to put this option in your tag:

```
<audio preload='none'> 
```

This option avoids pre-buffering, so it should solve your problem

# php - 在wordpress中结合php函数

> ID：11804633
> 
> 赞同：0
> 
> 时间：2012-08-03T23:39:32.157
> 
> 标签：php, wordpress

我有以下代码

```
<?php the_content(); ?> 
```

它会显示我网站的优惠券描述，

我想在最后添加每个商店的名称，使用以下代码

```
at <?php echo appthemes_get_custom_taxonomy($post->ID, APP_TAX_STORE, 'name'); ?> 
```

例如，它会说............ 6pm.com 服装折扣 20%。

截至目前，当我添加代码时，它会分离并创建一个新段落，如下所示......

服装折扣 20%。

在下午 6 点。

我如何将其组合为一个句子。

这是完整的优惠券功能

```
 <!-- #coupon-main -->

                        </div> <!-- #head-box -->

                        <div class="box-bottom">&nbsp;</div>

                        <div class="text-box">

                            <?php appthemes_before_post_content(); ?>

                            <?php the_content(); ?>

                            <?php clpr_edit_coupon_link(); ?>

                            <?php clpr_reset_coupon_votes_link(); ?>

                            <?php appthemes_after_post_content(); ?> 

                        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T14:11:43.677

```
<?php

$content = trim(get_the_content());
if(substr($content, -4) == '</p>') {
echo substr($content, 0, -4);
echo appthemes_get_custom_taxonomy($post->ID, APP_TAX_STORE, 'name');
echo '</p>';
}
else{
$content = preg_replace("/\.$/"," ",$content);
echo $content, appthemes_get_custom_taxonomy($post->ID, APP_TAX_STORE, 'name');
} ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T23:43:36.277

WordPress 可能会`<p></p>`在编辑器内围绕您的内容添加一个，该内容将保存在帖子的内容中。您可以使用`get_the_content()`并检查它是否以 a 结尾`</p>`，如果是，则删除它，`echo`商店的名称，然后在之后重新添加`</p>`。

```
<?php

$content = trim(get_the_content());
if(substr($content, -4) == '</p>') {
    echo substr($content, 0, -4);
    echo appthemes_get_custom_taxonomy($post->ID, APP_TAX_STORE, 'name');
    echo '</p>';
}
else{
    echo $content, appthemes_get_custom_taxonomy($post->ID, APP_TAX_STORE, 'name');
} 
```

# php - php 5.4 使用自定义会话处理上传进度

> ID：11804637
> 
> 赞同：1
> 
> 时间：2012-08-03T23:40:03.073
> 
> 标签：php, file-upload

在我的组织 PHP 应用程序中，我们在数据库中设置了自定义 PHP 会话存储，因为我们有多个 Web 服务器不能很好地共享默认的序列化文件。同样在 PHP 5.3 中，我们在开发环境中实现了文件上传的进度条。我们使用了此处提供的 DLL ( [http://downloads.php.net/pierre/](http://downloads.php.net/pierre/) )。现在我们已经更新到 php 5.4，虽然我们知道它内置支持在上传文件时获取有关文件的信息，但会话的超级全局变量似乎没有任何数据可供我们使用。我们要么需要知道如何：

1.  当 PHP 存储有关正在上传的文件的信息时，使用我们的自定义会话存储方法。
2.  获取 php 5.4 的上传进度 dll 的编译版本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-02T20:55:51.330

更新：在 2013 年底，我们切换到使用[XHR 进度事件](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Monitoring_progress)，因此我们不再依赖任何 PHP 模块来进行进度（我们目前达到 PHP 5.6，考虑很快升级到 PHP 7）。

# node.js - node js 是否适合使用慢速 api？

> ID：11804639
> 
> 赞同：1
> 
> 时间：2012-08-03T23:40:09.267
> 
> 标签：node.js

我需要通过肥皂向 api 发出请求，但这个 api 可能非常慢。（有时响应需要 30 秒）。我基本上想提出请求，然后在一段时间后得到响应，而不会阻塞。然后我会缓存这个结果。

我不太了解 node.js，想知道它是否适合这个。它是否支持这种非阻塞 http 请求和响应？它是否取决于我用来发出请求的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:07:08.393

是的，node.js 中的所有 I/O 操作都是非阻塞的。这是 node.js 的一般设计原则。

Node.js 已经带有[API](http://nodejs.org/api/http.html#http_http_get_options_callback)来发出 http 请求。

# graph-theory - 对于具有 n 个顶点的图，是否有任何多项式时间算法可以找到 k 顶点独立集？

> ID：11804640
> 
> 赞同：0
> 
> 时间：2012-08-03T23:40:24.820
> 
> 标签：graph-theory

对于具有 n 个顶点的图，我怎样才能找到一个 k 顶点独立集？（实际上，它不一定是多项式时间算法，只要它在 n = 200，k = 10 的合理时间内运行即可。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:42:57.157

如果 k 不固定，这是一个 NP 难题。如果 k 是固定的，则它是平凡多项式。此外，您最好在其他溢出站点之一上询问纯算法问题。

至于实用算法，你已经尝试过什么？即使像贪婪搜索这样简单的事情也可能适用于小问题。

# java - 尝试升级到 jetty-runner 8.1.5，在 JSTL <%@ taglib %> 导入 JSTL 标准标签时启动失败

> ID：11804648
> 
> 赞同：4
> 
> 时间：2012-08-03T23:42:17.653
> 
> 标签：java, jakarta-ee, jetty, jstl

我的实际目标是得到

```
<%@ page trimDirectiveWhitespaces=true %> 
```

去工作。我目前正在使用 jetty-runner 7.4.2 运行我的 Web 应用程序。作为一个随机的尝试，我下载了一个更新的版本。有了这个，当我尝试启动我的 web 应用程序时，我得到了这个异常：

> PWC6188：绝对 uri： http: [//java.sun.com/jsp/jstl/core](http://java.sun.com/jsp/jstl/core)无法在 web.xml 或随此应用程序部署的 jar 文件中解析

我发现很多提到这一点，但没有任何答案对我来说有任何意义。对于它的价值，我的 WEB-INF/lib 目录中有一个最新的 jstl jar 文件（当然，它与以前版本的 jetty-runner 完美配合，或者至少我猜它确实；我当然没有得到那个例外）。

从结构上讲，我正在运行的 .war 文件没有什么特别之处，我不认为，它在 Jetty（通过 jetty-runner）上运行了很长时间。它也适用于未修改的 Tomcat 和 Resin。因此，jetty-runner 版本 7 和版本 8 之间存在一些关键区别（可能是 Jetty 本身；不确定），我怀疑解决方案非常简单；我就是找不到。

这是一个 v2.5 网络应用程序，所以我的 taglib 参考如下所示：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
```

*编辑*这是我的 web.xml 中的 web-app 标记（应用程序之一）：

```
<web-app
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    metadata-complete="false"
    version="2.5"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-03T22:27:45.817

如果您使用 Java EE 7，则必须在某些服务器中使用 jcp 命名空间，而不是 java.sun，以保持兼容性，但由于新规范适用于 EE 7，并且 java 不再是 sun 的一部分，因此他们将其删除，如果您使用的是 Java ee 6，您应该保留它并且不要更新到 Java ee 7 编译服务器，或者检查具有该名称空间的服务器，如果您想使用 EE 7，那么您必须更改所有名称空间。缺少命名空间也是一个错误的想法，因为可能导致重复的 id 和各种东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-03T23:50:51.417

只是为了支持 rekiem87 写的内容，这是`<web-app>`我用来使 Jetty-Runner 9.2.3 工作的 3.1 标头：

```
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
     version="3.1"> 
```

我所做的只是更改我`web.xml`以使用该标头，然后重新启动 Jetty（使用新版本），一切正常。

# ruby-on-rails - 如何防止我的闪存中的参数散列与视图模板中的 ERB 输出一起显示

> ID：11804649
> 
> 赞同：1
> 
> 时间：2012-08-03T23:42:17.343
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller

我已经实现了一个应用程序助手来动态地向视图提供 Flash 消息的类，以便使用 Bootstrap 进行样式设置。设置有效，但与 ERB 一起，实际参数散列被输出到视图。我在帮助程序和视图中查看了我的所有应用程序代码，但无法查明来源。我还查看了输出 HTML，它并不表示源问题。以下是帮助程序和视图以及问题输出结果的快照。

**问题视图输出**

[http://screencast.com/t/9KZHxjqm1Pq](http://screencast.com/t/9KZHxjqm1Pq)

--

```
# layouts/application.html.erb
...
</head>
<body>

  <%= render "layouts/header" %>

  <div class="container">

  <% if flash.any? %>
  <%= render 'shared/flash_messages' %>
  <% end %>

  <%= yield %>
  ... 
```

--

```
# views/shared/_flash_messages.html.erb
<div>
<%= flash.each do |key, value| %>
  <div class="<%= flash_class(key) %> fade in">
    <a href="#" data-dismiss="alert" class="close">x</a>
    <%= "#{value}" %>
  <% end %>
  </div>
</div> 
```

--

```
# helpers/application_helper.rb
module ApplicationHelper

  def  flash_class(level)
  case level
    when :notice then "alert alert-info"
    when :success then "alert alert-success"
    when :error then "alert alert-error"
    when :alert then "alert alert-error"
  end
end

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T23:45:58.740

这是因为你在做

```
 <%= flash.each 
```

因此`each`会显示结果，以及块产生的任何内容。将 <%= 更改为 <%

# javascript - 由多个输入字段触发的绑定事件

> ID：11804657
> 
> 赞同：0
> 
> 时间：2012-08-03T23:43:38.910
> 
> 标签：javascript, html, jquery

绑定由 jquery 中相互依赖的多个输入字段触发的事件的最佳实践是什么？

例如：让我们使用一个搜索引擎，它根据在下面的字段中输入和选择的内容来搜索学生。

```
1\. text boxes
2\. select lists
3\. select boxes
4\. option buttons 
```

如果没有会触发这些事件的按钮，那么实现以下目标的最佳方法是什么：

1.  用户在其中一个输入字段中输入或选择值后立即显示搜索结果，并在用户在其他字段选项中输入或选择值时优化搜索。

2.  仅在每个字段具有有效值后才显示搜索结果。

任何输入都会被欣赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T01:06:41.087

我把这个 jsFiddle [http://jsfiddle.net/VJwpv/1/](http://jsfiddle.net/VJwpv/1/)放在一起。

如果您正在考虑使用 JavaScript 进行验证，那么我建议您查看这个[jQuery Validation 插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

**HTML**

```
<div id="searchForm"> 
    <input id="textBox" class="searchField" type="text" />
    <select id="dropDown" class="searchField">
        <option value="Option1">Option1</option>
        <option value="Option2">Option2</option>
    </select>
    <input id="checkbox1Value" type="checkbox" name="checkbox" value="Checkbox1" />Checkbox1 
    <input id="checkbox2Value" type="checkbox" name="checkbox" value="Checkbox2" />Checkbox2
    <input type="radio" name="radio" value="Radio1" /> Radio1
    <input type="radio" name="radio" value="Radio2" /> Radio2
</div>

<div id="results"></div> 
```

**JavaScript**

```
function validateForm() {
    // if valid
    return true;
    // else return false
}

function performSearch() {
    var textBoxValue = $("#textBox").val();
    var dropDownValue = $("#dropDown").val();
    var checkbox1Value = $("#checkbox1Value").is(":checked");
    var checkbox2Value = $("#checkbox2Value").is(":checked");
    var radioValue = $("input:radio[name=radio]:checked").val();
    // What you'd actually do here is an AJAX call to get the search results
    // and pass all the values defined above in the request
    $("#results").html("Textbox: " + textBoxValue + ". Dropdown: " + dropDownValue + ". Checkbox1: " + checkbox1Value + ". Checkbox2: " + checkbox2Value + ". Radio: " + radioValue);
}

function onChange() {
    if (validateForm()) {
        performSearch();
    }
}

$(document).ready(function() {
    $("#searchForm input, #searchForm select").change(function() {
        onChange();
    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T00:33:53.183

只需给它们一个通用的类名，并使用类选择器绑定更改事件：

**HTML：**

```
<input type="text" class="search-field" />
<input type="text" class="search-field" />
<select class="search-field" ><option>1</option><option>2</option></select>
<input type="radio" class="search-field" /> 
```

**JS：**

```
$('.search-field').change(function() {
    // validate all search field values
    // display search results based on values
    // if search results already shown, filter based on $(this).val()
}); 
```

* * *

如果您有许多这样的字段，而不是将处理程序绑定到每个字段（如上面的代码完成的那样），则使用委托事件处理程序可以获得更好的性能：

**HTML：**

```
<div id='parent'>
    <input type="text" class="search-field" />
    <input type="text" class="search-field" />
    <select class="search-field" ><option>1</option><option>2</option></select>
    <input type="radio" class="search-field" />
</div> 
```

**JS：**

```
$('#parent').on('change', '.search-field', function() {
    // validate all search field values
    // display search results based on values
    // if search results already shown, filter based on $(this).val()
}); 
```

# javascript - 年百分比率：需要建议

> ID：11804659
> 
> 赞同：0
> 
> 时间：2012-08-03T23:44:10.577
> 
> 标签：javascript, math

我有这个代码：

```
Round((Math.pow( (( 1 + (comission / initial))), ( 1 / (days / 365))) - 1) * 100, 2) 
```

如果我在 60 天内收取 1000 美元并在 60 天后一次性退回 1000 美元以上的佣金，则效果很好。

但我想每 60 天支付 2 次或 3 次或更多次付款。

我不能只划分“APR/付款次数”，因为 APR 必须增加而不是减少。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:38:02.137

APR 取决于复利频率，并且在连续复利时可能是无限级数的总和。

[周期性和连续公式在“moneychimp”](http://moneychimp.com)网站上的[连续计算利息公式和计算器](http://www.moneychimp.com/articles/finworks/continuous_compounding.htm)页面上得到了很好的解释（并且有一个计算器可以演示！） 。

基本上，对于周期复利，周期*n*的终值是...

FV [n] = P(1 + r/n) ^(Yn)

年复一年的本金`P`复合`n`时间`Y`。

`X`您可以通过计算一年后固定金额的未来值并找到由此产生的利率来确定 APR ，例如

APR = ((FV - P) / P) * 100

例如，假设本金为 10,000，按 5% (0.05) 每月复利（12 个周期/年），您将得到

10,000 * (( 1 + 0.05/12 )^12) = 10,511.62

(10,511.62 - 10,000) / 10,000 = 0.051162 ... * 100 = 5.1152（或 5.12）% APR

# spring-security - 在 netbeans 上添加 spring 安全性

> ID：11804672
> 
> 赞同：1
> 
> 时间：2012-08-03T23:46:21.497
> 
> 标签：spring-security

我在netbeans上创建了我的项目并检查了spring mvc框架和hibernate。

这创建了一个 web.xml 文件：

```
 <?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>2</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.htm</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>redirect.jsp</welcome-file>
    </welcome-file-list>
</web-app> 
```

但是，每当我添加

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

我能够将它部署在 tomcat 上但无法运行它:( 我收到此错误：

```
FAIL - Deployed application at context path /project but context failed to start
          <nbdeploy clientUrlPart="${client.urlPart}" debugmode="false" forceRedeploy="${forceRedeploy}"/> 
```

任何人都有修复它的建议？

# java - 在 Eclipse 和 unix 中运行 Junit

> ID：11804675
> 
> 赞同：0
> 
> 时间：2012-08-03T23:46:40.853
> 
> 标签：java, eclipse

我知道这是基本的 Java Eclipse 问题。但是，如果我从 Eclipse 创建 Junit 测试用例并能够在 Eclipse 中执行它们。

我也可以在 unix/linux 环境中运行相同的测试用例吗？我是否需要在 eclipse 中设置不同才能在 unix/linux 环境中运行它们？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T23:51:23.127

The Java Virtual Machine (JVM) is fully platform-independent. Any JUnit tests that work on one OS, such as Windows, will work on another, such as Linux.

To run a JUnit test inside UNIX/Linux, you can:

*   Install and run it from Eclipse, just like you would on any other OS (Eclipse, being built in Java, is also platform-independent).
*   Run `java org.junit.runner.JUnitCore test class` in the terminal, where `test` is the name of the test you want to run, and `class` is the class that that test resides in.

# jquery - jQuery用来自url的数据替换数据

> ID：11804678
> 
> 赞同：1
> 
> 时间：2012-08-03T23:47:03.113
> 
> 标签：jquery

如何用来自 url 的数据替换当前内容？我可以用（）替换负载（）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T23:49:05.717

你根本不需要`.replaceWith()`。`.load()`足够了。

```
$('#foo').load('/bar'); 
```

`foo`用HTML at替换带有 ID 的元素的内容`/bar`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T23:51:37.747

从文档：

> 此方法是从服务器获取数据的最简单方法。它大致相当于 $.get(url, data, success) ，只是它是一个方法而不是全局函数，并且它具有隐式回调函数。当检测到成功响应时（即当 textStatus 为“success”或“notmodified”时），.load() 将匹配元素的 HTML 内容设置为返回的数据。这意味着该方法的大多数用途都非常简单：

```
$('#elementToLoadInto').load('path/contentToLoad.html'); 
```

是的，它将替换所选元素中已有的内容。

# scala - 如何使用scala反射2.10检查案例类的哪些参数具有默认值

> ID：11804687
> 
> 赞同：8
> 
> 时间：2012-08-03T23:48:34.393
> 
> 标签：scala, reflection, macros

我的任务是查找有默认值的案例类的参数名称。

在 2.9 中，我使用来自 scalap 的 ScalaSigParser 并做了类似的事情：

```
(...)
case x: MethodSymbol if x.name.startsWith("init$default$") => (...)
(...) 
```

我希望 2.10 中的反射能让我更轻松地访问此类信息。

最终我想编写一个宏，我将包含在案例类的伴随对象中，它将自动创建一个用于该案例类的序列化/反序列化的代码。为此，我需要知道哪些参数具有默认值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T08:37:18.750

目前没有办法做到这一点，但是我刚刚提交了一个添加请求（https://github.com/scala/scala/pull/1047）`TermSymbol.isDefaultParam`，它公开了请求的功能。我希望它能进入 RC1 和 2.10.0-final。

```
scala> case class C(x: Int, y: Int = 2)
defined class C

scala> val ctor = typeOf[C].declaration(nme.CONSTRUCTOR).asMethod
ctor @ 39fe9830: reflect.runtime.universe.MethodSymbol = constructor C

scala> ctor.params.flatten filter (_.asTerm.isDefaultParam)
res0 @ 7ad2093b: List[reflect.runtime.universe.Symbol] = List(value y) 
```

# node.js - Using interpolation within Node.js EJS includes

> ID：11804691
> 
> 赞同：15
> 
> 时间：2012-08-03T23:49:43.457
> 
> 标签：node.js, include, express, ejs

My Express app is using EJS, and my views directory looks like this:

```
./views
  ./contents
    home.ejs
  ./includes
    header.ejs
    footer.ejs
  layout.ejs 
```

I'm trying to load home.ejs in my layout.ejs view conditionally based on a local variable named `contents` in my routes/index.js. That file looks like this:

```
/*
 * GET home page.
 */

exports.index = function(req, res){
  res.render('index', { title: 'Home', contents: 'home.ejs' });
}; 
```

Ideally I could simply write (in layout.ejs):

```
<% include '/contents' + contents %> 
```

where the trailing "contents" is the local variable which contains the relative path to the body text to load.

But alas, it appears EJS always interprets the text following an `include` directive literally, and there is no chance for any interpolation magic to happen.

I've also tried to no avail:

```
<% function yieldContent(contents){ %>
  <% var contentPath = 'contents/' + contents; %>
  <% include contentPath %>
<% }; %>
<% loadContent(); %> 
```

Does anyone have a creative solution for conditionally including a view based on a variable passed in routes?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T06:55:50.313

我认为没有办法在 EJS 中进行这种动态包含。它可能会打破业务逻辑和视图的分离。解决方案可以是在控制器中呈现子模板，并将其内容传递给布局。

对于在控制器中渲染子模板，请使用以下内容：

```
var ejs = require('ejs'),
, fs = require('fs')
, home = ejs.render(fs.readFileSync("contents/home.ejs", "utf-8")) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-21T21:07:20.123

在 EJS 的第 2 版中，该`include`功能做得很好。有了它，包含在运行时插入，因此变量可以用作路径名。

在这种情况下，解决方案可能是：

```
<%- include('contents/' + contents) %> 
```

如果需要，该函数还可以有另一个参数：

```
<%- include('mypathname', {foo:"bar"}) %> 
```

路径名必须相对于调用函数的模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-30T08:52:04.633

目前这还没有在 ejs 中实现，但是有这个讨论和提供该功能的请求请求。

[https://github.com/visionmedia/ejs/issues/93](https://github.com/visionmedia/ejs/issues/93)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-11T01:48:59.140

在您的渲染函数中，您可以包含`fs.readFileSync`和`__dirname`。

**使用这样的选项渲染您的页面**

```
res.render('pages/'+req.file,{file_get_contents:fs.readFileSync,__dirname:__dirname}); 
```

**然后你可以`.ejs`像这样在你的页面中使用它。这仍然在服务器端。**

```
<% var products=JSON.parse(file_get_contents(__dirname+'/web/data/products.json','utf8')) %> 
```

**您可以像这样在客户端 HTML 上打印数据。**

```
<%- JSON.stringify(products)%> 
```

**注意：使用此方法意味着您已经`fs`在脚本顶部的某个位置包含了内容。**

```
var fs = require('fs') 
```

# python - 正确检查单词是否在字符串中？

> ID：11804703
> 
> 赞同：3
> 
> 时间：2012-08-03T23:51:39.117
> 
> 标签：python, string

比如说，我想检查单词`test`是否在字符串中。通常，我只会：

```
if 'test' in theString 
```

但我想确保它是实际单词，而不仅仅是字符串。例如，`test`在“It was detestable”中会产生误报。我可以检查以确保它包含`(\s)test(\s)`（之前和之后的空格），但不是“......准备测试！” 会产生假阴性。看来我唯一的其他选择是：

```
if ' test ' in theString or ' test.' in theString or ' test!' in theString or..... 
```

有没有办法正确地做到这一点，比如`if 'test'.asword in theString`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-03T23:53:42.207

```
import re
if re.search(r'\btest\b', theString):
    pass 
```

这将在`test`. 从[文档](http://docs.python.org/library/re.html)中，`\b`：

> 匹配空字符串，但只匹配单词的开头或结尾。单词被定义为字母数字或下划线字符的序列，因此单词的结尾由空格或非字母数字、非下划线字符表示。

# c# - 如何阅读这个大文本文件？内存映射文件？

> ID：11804705
> 
> 赞同：0
> 
> 时间：2012-08-03T23:51:58.867
> 
> 标签：c#, performance, memory, file-io

我正处于一个简单工具的设计阶段，我想在需要读取大型日志文件的地方编写。为了给你们一些背景，我将首先向你们解释一下。

我需要阅读的日志文件由日志条目组成，这些条目始终包含以下 3 行格式：

```
statistics : <some data which is more of less of the same length about 100 chars>
request :  <some xml string which can be small (10KB) or big (25MB) and anything in between>
response :  <ditto> 
```

日志文件的大小约为 100-600MB，这意味着大量的日志条目。现在这些日志条目可以相互关联，为此我需要从头到尾读取文件。这些关系可以从统计线推导出来。

我想使用统计行中的信息来构建一些数据网格，用户可以使用这些数据网格来搜索数据并进行一些过滤操作。现在我不想将请求/响应行加载到内存中，直到用户真正需要它。此外，我想通过限制加载的请求/响应条目的最大值来保持较小的内存负载。

所以我认为我在第一次解析文件并创建统计索引时需要保存统计行的偏移量。然后，当用户单击某个作为日志条目元素的统计信息时，我使用此偏移量从文件中读取请求/响应。然后我可以保留一些内存池，以确保没有太多加载的请求/响应条目（请参阅前面的请求）。

问题是我不知道用户多久需要一次请求/响应数据。可能很多，也可能是几次。此外，日志文件可以从网络共享加载。

我的问题是：

1.  这是因为可能有很多读取操作而应该使用内存映射文件的情况吗？还是使用普通文件流更好。顺便提一句。在这个阶段我不需要对日志文件进行写操作，但将来可能会！

到目前为止，如果您有其他提示或发现我的想法存在缺陷，请也告诉我。我愿意接受任何方法。

**更新：**

澄清一些：

*   当用户从驱动器或网络共享加载日志文件时，该工具本身必须进行解析。

*   该工具将被编写为 WinForms 应用程序。

*   用户可以导出选定的日志条目。目前此导出的格式未知（二进制、文件 db、文本文件）。此导出可以由应用程序本身导入，然后仅显示用户所做的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:01:41.197

您正在谈论一些在实际条目之间具有一些已定义关系的存储数据......也许只是我，但这种情况只需要某种关系数据库。我建议考虑一些便携式数据库，例如 SQL Server CE。它将使您的生活更轻松，并提供您需要的功能。如果您改用 db，则可以准确查询所需的数据，而无需处理这样的大文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T00:08:47.357

如果您通过网络发送请求/响应块，则网络 send() 时间可能比 seek()/read() 和使用 memmap 之间的差异大得多，这无关紧要。要真正实现这种规模，一个简单的解决方案是将文件分解为许多文件，每个文件用于您要服务的每个块（因为“请求”可以达到 25 MB）。然后，您的 HTTP 服务器将尽可能高效地发送该块（甚至可能使用 zerocopy，具体取决于您的网络服务器）。如果你有很多小的“请求”块，而只有几个大块，你可以只突破超过某个阈值的那些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T00:10:42.150

我不同意沃尔特的回答。我会去分贝或所有内存。

为什么您如此关心节省内存，因为 600 MB 并不多。您要在内存小于 2 GB 的机器上运行吗？

将统计信息作为键加载到字典中，将值作为具有两个属性的类 - 请求和响应。字典很快。LINQ 功能强大且速度快。

# c# - EntityFramework cascading update

> ID：11804710
> 
> 赞同：3
> 
> 时间：2012-08-03T23:52:51.677
> 
> 标签：c#, entity-framework, cascade

Coming from an NHibernate background - I have some auditing columns to reflect who last edited a record, and when that edit occurred.

I've overridden SaveChanges to look for a common base class, and update anything with EntityState.Modified/Added and set these values --

However, I want to cascade updates from child to parent in some cases, so that when I edit child, the audit tracking fields of Parent are also updated.

Does EntityFramework support this in any way?

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:26:16.353

我想我要在我想要级联的父母上添加一个自定义属性 - 然后当我检测到修改过的实体时，找到具有该属性的属性并更新它们。

# select - 如何在 vbscript 中定义一个空的 select case 语句

> ID：11804711
> 
> 赞同：1
> 
> 时间：2012-08-03T23:52:55.247
> 
> 标签：select, vbscript

如果我有以下选择案例：

```
Select Case var
    Case 1
        doA()
    Case 2
        doB()
    Case 3
        'empty
End select 
```

这个空的选择案例有什么影响？是否有官方/合法的方式来定义一个空的选择案例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T06:07:16.740

拥有一个空案例（由适当的注释标记）是处理以下案例的正确方法：

```
Select Case DayOfWeek
  Case Sat
    doSaturday
  Case Sun
    ' nothing to do for sundays
  Case Else
    doWorkingDay
End Select 
```

在这里，省略 Sun Case 将是一个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T23:59:02.017

你为什么不完全忽略那个案例呢？

```
Select Case var
    Case 1
        doA()
    Case 2
        doB()
End select 
```

# c++ - Non-Blocking Timer C++

> ID：11804714
> 
> 赞同：1
> 
> 时间：2012-08-03T23:53:19.333
> 
> 标签：c++, timer, nonblocking

I'm trying to create a simple non-blocking timer in C++ that can be reset. I've google searched for a while to find some code examples but everything I find is either too complicated to understand or does not compile without extra non example code.

I have a program that logs a key press to a file, but I want this file to be written over one seconds after the key has been pressed unless another key has been pressed before the second is up.

I believe I should use Win32 timers, (I am using windows) however I can't find a simple compilable example of their use.

for example this method taken from the info page:

```
SetTimer(hwnd,                // handle to main window 
IDT_TIMER1,                   // timer identifier 
1000,                        // 1-second interval 
(TIMERPROC) MyTimerProc);     // no timer callback 

VOID CALLBACK MyTimerProc( 
HWND hwnd,        // handle to window for timer messages 
UINT message,     // WM_TIMER message 
UINT idTimer,     // timer identifier 
DWORD dwTime)     // current system time 
{

// my proceedure code 

FILE *OUTPUT_FILE;
OUTPUT_FILE = fopen("LOG.TXT", "w");
fprintf(OUTPUT_FILE, "%s", "");
fclose(OUTPUT_FILE);

// writes a blank text file.

KillTimer(hwnd, IDT_TIMER1); // stop timer after one call
} 
```

doesn't compile because the IDT_TIMER1 hasnt' been defined I think.

Also, I'm not sure if this would be reset by calling it twice or would just start two separate calls 1 second apart.

Any help greatly appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:01:59.460

您有责任提供`ID_TIMER1`价值。我相信你（99%）还必须有一个 Windows 消息循环才能工作。

这里有几个最小的、可编译的[例子](http://www-user.tu-chemnitz.de/~heha/petzold/ch08c.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:43:17.647

只需使用硬件性能计时器，可以通过 google 快速找到，或者如果您想要更多跨平台的东西使用 timegettime 方法，也可以通过 google 找到，不需要 Win32 消息循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T14:26:27.553

以下控制台程序有效。`SetTimer` 它使用消息循环中的 then 循环设置计时器。消息循环接收和处理`WM_TIMER`消息，并且每个时间间隔都会调用计时器回调。它不会阻塞。

```
#define STRICT 1 
#include <windows.h>
#include <iostream.h>

VOID CALLBACK TimerProc(HWND hWnd, UINT nMsg, UINT nIDEvent, DWORD dwTime) 
{
  cout << "Time: " << dwTime << '\n';
  cout.flush();
}

int main(int argc, char *argv[], char *envp[]) 
{
    int Counter=0;
    MSG Msg;

    UINT TimerId = SetTimer(NULL, 0, 500, &TimerProc); //SetTimer

    cout << "TimerId: " << TimerId << '\n';
   if (!TimerId)
    return 16;

   while (GetMessage(&Msg, NULL, 0, 0)) 
   {
        ++Counter;
        if (Msg.message == WM_TIMER)
        cout << "Counter: " << Counter << "; timer message\n";
        else
        cout << "Counter: " << Counter << "; message: " << Msg.message << '\n';
        DispatchMessage(&Msg);
    }

   KillTimer(NULL, TimerId);
return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-04T10:10:37.150

您不需要窗口甚至事件循环。查看[WaitForSingleObject 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687032%28v=vs.85%29.aspx)。

这是一些代码

```
HANDLE hStdin; 
hStdin = GetStdHandle(STD_INPUT_HANDLE); 

FILE *OUTPUT_FILE;
OUTPUT_FILE = fopen("LOG.TXT", "w");

bool previous_input_written = TRUE;

switch (WaitForSingleObject(hStdin, 1000) {

  case WAIT_OBJECT_0:  
    // input happened on hStdin 
    if (!previous_input_written) {
      // the previous input was not saved to file
      fprintf(OUTPUT_FILE, ...
      previous_input_written= TRUE;
    }
    ReadConsoleInput(hStdin, ...
    previous_input_written = FALSE;

  case WAIT_TIMEOUT: 
    // the 1000ms delay timed out, write to file
    fprintf(OUTPUT_FILE, ...
    previous_input_written= TRUE;
}

fclose(OUTPUT_FILE); 
```

# ruby - 如何从此 Ruby 哈希中提取值？

> ID：11804716
> 
> 赞同：1
> 
> 时间：2012-08-03T23:53:50.753
> 
> 标签：ruby, json, api, parsing, hash

我正在使用 Foursquare API，我想从这个哈希中提取“id”值

```
[{"id"=>"4fe89779e4b09fd3748d3c5a", "name"=>"Hitcrowd", "contact"=>{"phone"=>"8662012805", "formattedPhone"=>"(866) 201-2805", "twitter"=>"hitcrowd"}, "location"=>{"address"=>"1275 Glenlivet Drive", "crossStreet"=>"Route 100", "lat"=>40.59089895083072, "lng"=>-75.6291255071468, "postalCode"=>"18106", "city"=>"Allentown", "state"=>"Pa", "country"=>"United States", "cc"=>"US"}, "categories"=>[{"id"=>"4bf58dd8d48988d125941735", "name"=>"Tech Startup", "pluralName"=>"Tech Startups", "shortName"=>"Tech Startup", "icon"=>"https://foursquare.com/img/categories/shops/technology.png", "parents"=>["Professional & Other Places", "Offices"], "primary"=>true}], "verified"=>true, "stats"=>{"checkinsCount"=>86, "usersCount"=>4, "tipCount"=>0}, "url"=>"http://www.hitcrowd.com", "likes"=>{"count"=>0, "groups"=>[]}, "beenHere"=>{"count"=>0}, "storeId"=>""}] 
```

当我尝试使用 提取它时`['id']`，我收到此错误`can't convert Symbol into Integer`。如何使用 ruby​​ 提取值？另外，我如何为每次提取“id”值的多个哈希执行此操作？

请原谅我的经验不足。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T23:59:10.657

它被包裹在一个数组中，这就是开头和结尾的`[`and的`]`含义。但看起来这个数组中只有一个对象，这就是你真正想要的散列。

所以假设你想要这个数组中的第一个对象：

```
mydata[0]['id'] # or mydata.first['id'] as Factor Mystic suggests 
```

但通常当 API 返回一个数组时，是有原因的（它可能会返回许多结果而不仅仅是一个），并且天真地从中提取第一项可能不是您想要的。因此，在将其硬编码到您的应用程序之前，请确保您获得了您真正期望的那种数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-04T00:07:12.957

对于多个哈希，如果你想*用 id 做一些事情*（运行某种程序）然后

```
resultsArray.each do |person|
  id = person["id"] #then do something with the id
end 
```

如果你只想*得到一个包含 id 的数组，*那么

```
resultsArray.map{|person| person["id"]}  
# ["4fe89779e4b09fd3748d3c5a", "5df890079e4b09fd3748d3c5a"] 
```

要从数组中获取一项，请参阅[Alex Wayne](https://stackoverflow.com/users/62076/alex-wayne)的回答

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T05:01:22.337

要获取 id 数组，请尝试：`resultsArray.map { |result| result["id"] }`

# java - 无法从与特定“uid”匹配的 MySQL 表中检索数据

> ID：11804718
> 
> 赞同：0
> 
> 时间：2012-08-03T23:54:54.077
> 
> 标签：java, android, mysql, json

我正在尝试更多地了解 MySQL 并使用 Java（在 Android 上）从我的 WAMS 服务器上的数据库中访问和检索信息。我的应用程序的设置方式是它有一个初始登录屏幕，它还获取正在登录的用户名的“uid”（来自不同的表）并存储它。

登录后（这是功能性的 - 我设置了一个 toast 通知，显示检索到的用户登录用户名和 uid），它进入一个新屏幕（dashboard.xml），其中设置了一个 TextView 字段来显示检索到的数据（来自下面发布的表）与存储的“uid”相关联。这是我试图从中提取数据的表：

[http://db.tt/4izVQuGB](http://db.tt/4izVQuGB "我查询的表")

现在，我已经设置了一个 PHP 文件，该文件在我的数据库中查询与特定“uid”关联的行。我已经使用 HTML 表单测试了这个文件。

```
$connect = mysql_connect($dbhost, $dbuser, $dbpass) or die("connection error");
mysql_select_db($dbdb)or die("database selection error");

//Retrieve the User ID
$uid = $_POST['uid'];

//Query
$query = mysql_query("SELECT * FROM node WHERE uid='$uid' AND type='goal'");

//store # of rows returned
$num_rows = mysql_num_rows($query);

if ($num_rows >= 1) {
    while($results=mysql_fetch_assoc($query)) {
        //Store the returned data into a variable
        $output = $results;

        //encode the returned data in JSON format
        echo json_encode($output);
    }
    mysql_close();
} 
```

我通过使用 uid 值为 1 测试 PHP 文件得到的结果是：

> {"nid":"1","vid":"1","type":"goal","language":"","title":"test","uid":"1","status ":"1","created":"1342894493","changed":"1342894493","comment":"2","promote":"1","moderate":"0","sticky": "1","tnid":"0","翻译":"0"}
> 
> {"nid":"2","vid":"2","type":"goal","language":"","title":"test2","uid":"1","status ":"1","created":"1342894529","changed":"1342894529","comment":"2","promote":"1","moderate":"0","sticky": "1","tnid":"0","翻译":"0"}
> 
> {"nid":"5","vid":"5","type":"goal","language":"","title":"run","uid":"1","status ":"1","created":"1343506987","changed":"1343506987","comment":"2","promote":"1","moderate":"0","sticky": "1","tnid":"0","翻译":"0"}
> 
> {"nid":"9","vid":"9","type":"goal","language":"","title":"跑到山上","uid":"1" “状态”：“1”，“已创建”：“1343604338”，“已更改”：“1343605100”，“评论”：“2”，“提升”：“0”，“中等”：“0”，粘性":"0","tnid":"0","翻译":"0"}

现在，我已经编写了一些 android 代码来设置 httppost 并应该在我的数据库表中检索“标题”。我知道这是错误的（显然因为它不起作用），但我对下一步该做什么感到困惑。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;
import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

public class Dashboard extends Activity implements OnClickListener {

    // variable declarations
    String uid = "1";

    // create textview to display retrieved data
    TextView display;

    HttpClient httpclient;
    HttpPost httppost;
    HttpResponse httpresponse;
    HttpEntity httpentity;

    ArrayList<NameValuePair> resultArray;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.dashboard);
        display = (TextView) findViewById(R.id.test);

        // initialize HttpClient
        httpclient = new DefaultHttpClient();

        // initialize HttpPost
        httppost = new HttpPost("http://192.168.1.112/android/fetch.php");

        try {
        // Create new List
        List<NameValuePair> resultList = new ArrayList<NameValuePair>();
        resultList.add(new BasicNameValuePair("uid", uid));

        httppost.setEntity(new UrlEncodedFormEntity(resultList));

        httpresponse = httpclient.execute(httppost);

        httpentity = httpresponse.getEntity();

        InputStream instream = entity.getContent();

        try {
                            // store incoming stream in an array
            JSONArray jArray = new JSONArray(streamToString(instream));
            JSONObject jData = null;

            for (int i = 0; i < jArray.length(); i++) {
                jData = jArray.getJSONObject(i);
                String goals = jData.getString("title");
                display.setText(goals);
            }
        //} catch (JSONException e) {
            //Toast.makeText(this, "No entries found", Toast.LENGTH_LONG).show();
        } catch (Exception e) {
            Toast.makeText(this, e.toString(), Toast.LENGTH_LONG)
                    .show();
        }

    } catch (Exception e) {
        e.printStackTrace();
        Notifications error = new Notifications();
        error.userPassErrorDialog();
    }

}

private static String streamToString(InputStream is) {

    BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    StringBuilder sb = new StringBuilder();

    String line = null;
    try {
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            is.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    return sb.toString();
}

public void onClick(View v) {
    // TODO Auto-generated method stub

} 
```

}

在 Android 模拟器中测试时出现以下错误：

[http://db.tt/2vg9MqYh](http://db.tt/2vg9MqYh "错误")

任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T15:01:10.843

在您的 Android 应用程序中，您需要一个 JSONArray：

```
// store incoming stream in an array
JSONArray jArray = new JSONArray(streamToString(instream)); 
```

但是，在您的 PHP 文件中，您只输出多个单独的 JSON 对象，而不是一个真正的数组。我认为，您应该首先将数据库中的所有项目收集到一个 PHP 数组中，然后只对其进行编码和输出一次。

我的 PHP 技能有点生疏，但我希望这个能奏效：

```
//store # of rows returned
$num_rows = mysql_num_rows($query);

if ($num_rows >= 1) {
    $output = array();

    while($results = mysql_fetch_assoc($query)) {
        // append row to output
        $output[] = results
    }

    mysql_close();  // shouldn't that be outside the if block?

    //encode the returned data in JSON format
    echo json_encode($output);
} 
```

我希望输出是这样的（也许没有缩进）：

```
[
    {"nid":"1","vid":"1","type":"goal","language":"","title":"test","uid":"1","status":"1","created":"1342894493","changed":"1342894493","comment":"2","promote":"1","moderate":"0","sticky":"1","tnid":"0","translate":"0"},
    {"nid":"2","vid":"2","type":"goal","language":"","title":"test2","uid":"1","status":"1","created":"1342894529","changed":"1342894529","comment":"2","promote":"1","moderate":"0","sticky":"1","tnid":"0","translate":"0"},
    {"nid":"5","vid":"5","type":"goal","language":"","title":"run","uid":"1","status":"1","created":"1343506987","changed":"1343506987","comment":"2","promote":"1","moderate":"0","sticky":"1","tnid":"0","translate":"0"},
    {"nid":"9","vid":"9","type":"goal","language":"","title":"run to the hills","uid":"1","status":"1","created":"1343604338","changed":"1343605100","comment":"2","promote":"0","moderate":"0","sticky":"0","tnid":"0","translate":"0"}
] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-23T21:10:54.057

问题在于JSON的编码和解码。从您的 JSON 响应看来，您正在从服务器接收 JSON 对象，也请尝试在[此处](http://jsonlint.com/)验证您的 JSON 响应。在浏览器中运行您的 php 文件，在 JSON 验证器上复制整个响应并检查您收到响应的括号。

1\. 如果您的响应以 '[' 开头，它是一个数组，如果它以 '{' 开头，它是一个 JSON 对象。在解析 JSON 时，您首先定义了 JSON 数组，但服务器响应是 JSON 对象。在使用 JSON 时，您必须在服务器端注意它将发送的响应格式，并且您必须在客户端注意接收到的响应格式。我正在为您发布示例脚本。

-> 服务器端

```
if (mysql_num_rows($result)>0){
$response["data"] = array();        //this is an array
while($row= mysql_fetch_array($result))
{
$data = array();      //here I have created another temp array
$data["name"] = $row["name"];         
$data["surname"] = $row["surname"];   

array_push($response["data"], $data);   //this makes an array of objects in the response
}}
}//endif
else{
echo "no input";
}}
mysql_close();
echo json_encode($response);    //and finally I echo it as an JSON object 
```

因为这个 php 脚本将返回我一个对象数组的对象（不是有点复杂！！）下面是响应的格式

-> 验证的 JSON 响应

```
{
    "data": [
        {
            "name": "Setu",
             "surname": "Desai",
        }
     ]
} 
```

并对此进行解码，我的客户站点脚本需要如下

-> 解析 JSON 对象

```
JSONObject snObject = new JSONObject(jsonString);
    JSONArray snArray = snObject.getJSONArray("data");
    for (int i = 0; i < snArray.length(); i++) {
        JSONObject snObject2 = snArray.getJSONObject(i);
        String surname = snObject2.getString("surname");
        surnamearray.add(surname);
    } 
```

理解的简单方法是验证您的 JSON 响应并识别 JSON 数组和对象的位置，然后开始解码。

# ruby-on-rails - Rails: side effect of including the same filter twice

> ID：11804719
> 
> 赞同：2
> 
> 时间：2012-08-03T23:55:02.047
> 
> 标签：ruby-on-rails, gem, before-filter, applicationcontroller

I have a gem I'm developing that is based around using filters on ApplicationController. It's basically for logging, and one of the modules defines an around filter like so:

```
module LogExceptionFilter
  self.included(base)
      base.around_filter :do_a_bunch_of_logging_stuff
  end

  def do_a_bunch_of_logging_stuff
      ...
  end
end 
```

It happens to be an around filter where I deal with exception logging, but my question would apply for any filter.

So it's supposed to be used like this

```
class ApplicationController
    include LogExceptionFilter
end 
```

So what I'm worried about is if someone does:

```
class ApplicationController
    include LogExceptionFilter
    include LogExceptionFilter
end 
```

I don't want to execute `do_a_bunch_of_logging_stuff` twice. So first

1)If `do_a_bunch_of_logging_stuff` is included twice, will rails apply the filter twice?

2)Is it my responsibility to protect the user from doing this? I could do so with a class variable, something like:

```
module LogExceptionFilter

  class << self
     cattr_accessor :filter_loaded
  end

  self.included(base)
    unless filter_loaded
      base.around_filter :do_a_bunch_of_logging_stuff
      filter_loaded = true
    end
  end

  def do_a_bunch_of_logging_stuff
      ...
  end
end 
```

This variable is not thread safe so it's something that I'd want to be careful about putting in. But I don't want to write a library that can be easily broken. Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T08:26:44.163

以下是一些相关链接： [http](http://www.ruby-forum.com/topic/95269) ://www.ruby-forum.com/topic/95269 http://www.ruby-forum.com/topic/164588

基本上，一个模块只会被包含一次，但包含的回调可能会被多次调用。

# html - websocket消息可以乱序到达吗？

> ID：11804721
> 
> 赞同：68
> 
> 时间：2012-08-03T23:55:49.520
> 
> 标签：html, networking, websocket, socket.io

如果我们在同一个 html5 websocket 上发送两条消息，间隔毫秒，

从理论上讲，消息是否有可能以与发送顺序不同的顺序到达？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-08-04T14:49:06.090

简短的回答：没有。

长答案：

WebSocket 在 TCP 上运行，因此在该级别 @EJP 的答案适用。WebSocket 可以被中介（如 WS 代理）“拦截”：允许重新排序 WebSocket 控制帧（即 WS pings/pongs），但当没有 WebSocket 扩展时，不允许重新排序消息帧。如果存在原则上允许重新排序的新扩展扩展，那么中介只有在理解扩展和适用的重新排序规则时才能这样做。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-08-04T04:03:54.697

他们不可能乱序到达*您的应用程序。*网络上可能发生任何事情，但 TCP 只会按照发送顺序向您显示字节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-15T22:33:01.783

在网络层，假设 TCP 保证消息按顺序到达。在应用程序层，代码中可能会出现错误，并导致您的消息在代码逻辑中出现乱序。它可能是您的应用程序正在使用的网络堆栈或您的应用程序代码本身。

如果你问我，我的 Node.js 应用程序能否保证按顺序发送和接收消息？我不得不说不。我已经在高延迟和低信号下运行连接到 WiFi 的 websocket 应用程序。它会导致非常奇怪的行为，就好像数据包被丢弃并且消息乱序一样。

这篇文章很好读[https://samsaffron.com/archive/2015/12/29/websockets-caution-required](https://samsaffron.com/archive/2015/12/29/websockets-caution-required)

# android - 将 Drawable 绘制到位图

> ID：11804723
> 
> 赞同：2
> 
> 时间：2012-08-03T23:55:56.307
> 
> 标签：android, bitmap, drawable

我有一个带有笔划的 XML 可绘制文件，并且我还有几个要应用笔划的位图。我尝试调用 Drawable.draw(canvas)，但它抛出 IllegalStateException

笔画 XML：

```
<shape xmlns:android="http://schemas.android.com/apk/res/android"
       android:shape="rectangle">
    <stroke android:width="3dp"
            android:color="#ffffffff"/>
</shape> 
```

绘图代码：

```
Drawable strokeDrawable = getResources().getDrawable(R.drawable.stroke);
Bitmap bmp1 = BitmapFactory.decodeResource(getResources(), R.drawable.bmp1);
Canvas canvas = new Canvas(bmp1);
strokeDrawable.draw(canvas); 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T00:39:55.490

解决方案：

```
final int STROKE_WIDTH = 3;
Bitmap copy = Bitmap.createBitmap(bmp1.getWidth() + STROKE_WIDTH * 2, bmp1.getHeight() + STROKE_WIDTH * 2, Bitmap.Config.ARGB_8888);
Canvas canvas = new Canvas(copy);
strokeDrawable.setBounds(0, 0, copy.getWidth(), copy.getHeight());
strokeDrawable.draw(canvas);
canvas.drawBitmap(bmp1, STROKE_WIDTH, STROKE_WIDTH, null);
bmp1.recycle();
bmp1 = copy; 
```

# android - 如何在 Activity 中禁用 Toast

> ID：11804724
> 
> 赞同：1
> 
> 时间：2012-08-03T23:56:19.887
> 
> 标签：android

是否可以禁用 Activity 中的所有 Toast？我使用一个图书馆，它在每次开始时都会显示祝酒词。这对我的应用程序的一些用户来说越来越烦人了。是否可以强制 Toasts 禁用？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T00:13:24.543

`Toasts`抱歉，除了获取 JAR 的源代码、在源级别删除它们并重新构建 JAR 之外，您无法禁用 的显示。

# c# - 在 PowerShell cmdlet 中导航父子关系

> ID：11804725
> 
> 赞同：3
> 
> 时间：2012-08-03T23:56:30.737
> 
> 标签：c#, powershell, pipeline, cmdlet

假设我有这样的父子关系的对象：

```
public class Node
{
   public string Name { get; set; }
   public string Type { get; set; }
   public Node Parent { get; set; }
} 
```

现在，我想创建一个支持如下语法的 cmdlet：

```
Get-Node | where {$_.Type -eq "SomeType" -and $_.Parent.Name -eq "SomeName" } 
```

在这里，Parent 属性需要以某种方式引用管道中的另一个对象。在 PowerShell 中甚至可能发生这样的事情吗？如果没有，有什么替代方案？

[编辑]如果我像这样使用上面的类：

```
var root = new Node
{
    Name = "root",
    Type = "root",
    Parent = null
};
var nodeA = new Node
{
    Name = "A",
    Type = "node",
    Parent = root
}
WriteObject(root);
WriteObject(nodeA); 
```

然后加载模块并尝试以下命令：

```
Get-MyNode | where {$_.Parent.Name = "root"} 
```

我收到此错误：

```
Property 'Name' cannot be found on this object; make sure it exists and is settable.
At line:1 char:31
+ Get-MyNode | where {$_.Parent. <<<< Name = "root"}
    + CategoryInfo          : InvalidOperation: (Name:String) [], RuntimeException
    + FullyQualifiedErrorId : PropertyNotFound 
```

我希望 Parent 属性能够像真正的 Node 对象一样引用管道中的另一个对象。

[编辑] 此错误是由类定义中缺少 public 关键字引起的。添加关键字解决了问题并使示例工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T16:44:39.537

我希望您的 Get-Node cmdlet 将返回一个完全填充的对象图。这是一个使用 XML 的类似示例：

```
$xml = [xml]@'
<?xml version="1.0" encoding="ISO-8859-1"?>
 <bookstore>
     <book>
       <title lang="eng">Harry Potter</title>
       <price>29.99</price>
     </book>
     <book>
       <title lang="eng">Learning XML</title>
       <price>39.95</price>
     </book>
 </bookstore> 
'@

$xml.SelectNodes('//*') | Where {$_.ParentNode.Name -eq 'book'} 
```

在回答您关于访问管道中另一个对象的问题时，创建中间变量作为管道的一部分以供以后引用的情况并不少见：

```
Get-Process | Foreach {$processName = $_.Name; $_.Modules} | 
              Foreach {"$processName loaded $($_.ModuleName)"} 
```

在这种情况下，我在沿管道传播完全不同的类型（即 System.Diagnostic.ProcessModule）之前存储了 System.Diagnostics.Process 对象的名称。然后我可以将隐藏的进程名称与模块的名称结合起来以产生我想要的输出。

上述方法适用于教学目的，但并不是真正的规范 PowerShell。这将是在 PowerShell 中执行此操作的更典型方法：

```
Get-Process | Select Name -Exp Modules | Foreach {"$($_.Name) loaded $($_.ModuleName)"} 
```

在这个场景中，我们采用了 Process 的名称并将其投影到每个 ProcessModule 对象中。请注意，当您尝试枚举其模块集合时，某些进程会产生错误。

# python - 具有特定位置的networkx add_node

> ID：11804730
> 
> 赞同：38
> 
> 时间：2012-08-03T23:57:31.647
> 
> 标签：python, networkx

我仍然是networkx的初学者我想在不同的位置添加多种类型的节点，我使用了以下代码

```
pos = {0: (40, 20), 1: (20, 30), 2: (40, 30), 3: (30, 10)} 
X=nx.Graph()
nx.draw_networkx_nodes(X,pos,node_size=3000,nodelist=[0,1,2,3],node_color='r') 
```

但是当我想访问 Graph X 时，如果我输入 X.node 它会返回一个空列表，如果我想添加更多节点，我必须在开始时使用 pos 字典设置它们的位置。

如何使用 add_node() 将节点添加到特定位置 x 和 y 的图形中

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-04T13:54:06.993

您可以使用以下方法设置单个节点位置，然后提取“pos”字典以在绘图时使用。

```
In [1]: import networkx as nx

In [2]: G=nx.Graph()

In [3]: G.add_node(1,pos=(1,1))

In [4]: G.add_node(2,pos=(2,2))

In [5]: G.add_edge(1,2)

In [6]: pos=nx.get_node_attributes(G,'pos')

In [7]: pos
Out[7]: {1: (1, 1), 2: (2, 2)}

In [8]: nx.draw(G,pos) 
```

**更新**

添加绘图

[![在此处输入图像描述](../Images/a163846faa82d2b4b95ed437015a12ae.png)](https://i.stack.imgur.com/MscDX.png)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-08-04T07:35:04.870

我不完全确定您想要完成什么，但我认为您想将节点添加到图形中，将它们绘制在想要的位置，并且仍然能够在图形对象中访问它们。

由于您没有将节点添加到图表中，这将是一个开始：

```
X.add_nodes_from(pos.keys()) 
```

然后在绘制图形时不必指定节点列表，因此在添加新节点时不必在两个不同的地方更改代码。

如果您希望节点的位置作为节点属性，您也可以这样做：

```
for n, p in pos.iteritems():
    X.nodes[n]['pos'] = p 
```

请注意，这些位置不会用作绘制图形时的位置，必须明确设置。然后，您可以使用以下命令绘制和显示图形：

```
nx.draw(X, pos)
plt.show() 
```

假设你做了 import `from matplotlib import pyplot as plt`。

# c++ - DBGrid 按计算字段排序

> ID：11804731
> 
> 赞同：1
> 
> 时间：2012-08-03T23:57:39.387
> 
> 标签：c++, sorting, filter, c++builder, dbgrid

我的问题是：如何通过计算字段订购 DBGrid。我正在使用 C++Builder Starter Editon，并且在此版本中没有可用的 ClientDataSet 来在字段上创建索引并按列的索引排序。所以这不是一个选项。（在许多线程中阅读此内容）我正在使用 TIBDataSet（下面的 ibds）并且正在过滤数据。工作正常....对于 DB 列，而不是计算的列...关于我如何解决这个问题的任何想法？

```
void __fastcall TForm1::DBGrid3TitleClick(TColumn *Column)
{
    static cIdx = 0;
    static String oby = "ASC";

    TBookmark CurrentPosition;
    TIBDataSet *ibds = IBDS_accountsDist;
    CurrentPosition = ibds->GetBookmark();
    if (cIdx != Column->Index) {
        oby = "ASC"; // ANOTHER column choosen
    } else if (oby == "ASC") {
        oby = "DESC";
    } else oby = "ASC";
    cIdx = Column->Index;

    ibds->Filtered = false;
    switch (Column->Index){
        case 0: ibds->Filter = "ORDER BY SumAj "+oby; break; // SumAj is a calculated field => Does not work
        case 1: ibds->Filter = "ORDER BY CSAL_ACCOUNTNAME "+ oby; break; // DB-field WORKS FINE
    }
    ibds->Filtered = true;
    ibds->GotoBookmark(CurrentPosition);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T18:16:55.387

你做不到。TIBDataSet 是底层数据库的表示。基本上，它按照 SQL 中定义的顺序获取记录。

最简单的方法是使用 TDBClientDataset 但它不包含在 C++ Builder 的 Starter 版本中。您可以探索其他方式，例如在 std::list 中预加载所有记录，然后使用 order 函数对记录进行排序。最后，您可以使用简单的 TGrid o TStringGrid 显示它们。

无论如何，我建议升级 C++Builder，因为 TClientDataSet 是大多数数据项目中的主要部分之一，特别是当您需要创建中大型项目时。

将 TIBDataSet 等数据库特定组件与用户界面混合使用会降低项目的可伸缩性和维护性。

# java - Java get String CompareTo as a comparator object

> ID：11804733
> 
> 赞同：49
> 
> 时间：2012-08-03T23:57:50.680
> 
> 标签：java, string, object, comparator

I would like to sort and binary search a static array of strings via the String.CompareTo comparator.

The problem is that both sorting, and binary searching requires that a Comparator object be passed in -- So how do I pass in the built in string comparator?

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-04T00:02:54.890

您可以编写自己的比较器

```
public class ExampleComparator  implements Comparator<String> {
  public int compare(String obj1, String obj2) {
    if (obj1 == obj2) {
        return 0;
    }
    if (obj1 == null) {
        return -1;
    }
    if (obj2 == null) {
        return 1;
    }
    return obj1.compareTo(obj2);
  }
} 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2015-09-11T17:02:52.447

基于[java.util.Comparator.comparing(...)](https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html#comparing-java.util.function.Function-)的 Java 8 解决方案：

```
Comparator<String> c = Comparator.comparing(String::toString); 
```

或者

```
Comparator<String> c = Comparator.comparing((String x) -> x); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-08-04T00:00:06.103

该类`Arrays`具有不需要的版本例如，您可以使用`sort()`仅[需要对象数组的](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort(java.lang.Object[]))[版本](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort(java.lang.Object[]))。这些方法调用数组中对象的方法。`binarySearch()``Comparator.`[`Arrays.sort()`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort(java.lang.Object[]))`compareTo()`

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-05-15T02:07:43.670

如果您确实发现自己需要一个`Comparator`，并且您已经在使用[`Guava`](http://code.google.com/p/guava-libraries/)，您可以使用[`Ordering.natural()`](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/Ordering.html#natural())。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-08-13T18:48:49.783

好的，这是几年后的事了，但是使用 java 8，您可以使用 Comparator.naturalOrder()：

[http://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html#naturalOrder--](http://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html#naturalOrder--)

来自 javadoc：

```
static <T extends Comparable<? super T>> Comparator<T> naturalOrder() 
```

返回按自然顺序比较 Comparable 对象的比较器。返回的比较器是可序列化的，并在比较 null 时抛出 NullPointerException。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-11-07T15:16:38.933

`Comparator`这对于任何类型的对象都是通用的`Comparable`，而不仅仅是`String`：

```
package util;

import java.util.Comparator;

/**
 * The Default Comparator for classes implementing Comparable.
 *
 * @param <E> the type of the comparable objects.
 *
 * @author Michael Belivanakis (michael.gr)
 */
public final class DefaultComparator<E extends Comparable<E>> implements Comparator<E>
{
    @SuppressWarnings( "rawtypes" )
    private static final DefaultComparator<?> INSTANCE = new DefaultComparator();

    /**
     * Get an instance of DefaultComparator for any type of Comparable.
     *
     * @param <T> the type of Comparable of interest.
     *
     * @return an instance of DefaultComparator for comparing instances of the requested type.
     */
    public static <T extends Comparable<T>> Comparator<T> getInstance()
    {
        @SuppressWarnings("unchecked")
        Comparator<T> result = (Comparator<T>)INSTANCE;
        return result;
    }

    private DefaultComparator()
    {
    }

    @Override
    public int compare( E o1, E o2 )
    {
        if( o1 == o2 )
            return 0;
        if( o1 == null )
            return 1;
        if( o2 == null )
            return -1;
        return o1.compareTo( o2 );
    }
} 
```

如何使用`String`：

```
Comparator<String> stringComparator = DefaultComparator.getInstance(); 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2015-04-16T19:40:54.180

`Arrays.binarySearch(Object[] a, Object key)`同样，只要对象的类型具有可比性，就不需要比较器，但是使用 lambda 表达式现在更容易了。

只需将比较器替换为方法参考：`String::compareTo`

例如：

```
Arrays.binarySearch(someStringArray, "The String to find.", String::compareTo); 
```

你也可以使用

```
Arrays.binarySearch(someStringArray, "The String to find.", (a,b) -> a.compareTo(b)); 
```

但即使在 lambdas 之前，总是有匿名类：

```
Arrays.binarySearch(
                someStringArray,
                "The String to find.",
                new Comparator<String>() {
                    @Override
                    public int compare(String o1, String o2) {
                        return o1.compareTo(o2);
                    }
                }); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-04-01T00:35:18.037

此外，如果您想要不区分大小写的比较，在最近的 Java 版本中，`String`该类包含一个`public static final`名为`CASE_INSENSITIVE_ORDER`which is of type的字段`Comparator<String>`，正如我最近发现的那样。因此，您可以使用`String.CASE_INSENSITIVE_ORDER`.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-07-15T10:53:36.760

我们可以使用 String.CASE_INSENSITIVE_ORDER 比较器以不区分大小写的顺序比较字符串。

```
Arrays.binarySearch(someStringArray, "The String to find.",String.CASE_INSENSITIVE_ORDER); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-07-12T15:22:28.427

为了概括 Mike Nakis 的好答案`String.CASE_INSENSITIVE_ORDER`，您还可以使用：

```
Collator.getInstance(); 
```

见[校对者](https://docs.oracle.com/javase/7/docs/api/java/text/Collator.html "整理者")

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-01-28T21:10:41.980

您可以使用`StringUtils.compare("a", "b")`

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2016-06-14T14:52:05.663

关于南巴里的[回答](https://stackoverflow.com/a/11804763/369450 "回答")，有一个错误。如果您使用双等号***==***比较值，程序将永远不会到达 compare 方法，除非有人会使用***new***关键字来创建 String 对象，这不是最佳做法。这可能是一个更好的解决方案：

```
public int compare(String o1, String o2) {
        if (o1 == null && o2 == null){return 0;}
        if (o1 == null) { return -1;}
        if (o2 == null) { return 1;}
        return o1.compareTo(o2);
    } 
```

PS 感谢您的评论；）

# java - Java innacurate in calulating my angle?

> ID：11804736
> 
> 赞同：0
> 
> 时间：2012-08-03T23:58:15.557
> 
> 标签：java, math, graphics

I am having a user draw a line on the screen, there is a start point and a end point. If the user extends over a certain angle I change the position of the endpoint so the user cannot extend beyond the specified angle. However it seems that when I cacluate the angle the user is drawing and make suer it is not over MAX ANGLE, and set the angle to the MAX ANGLE, there is a difference. This can be seen by when I draw the line, once i get to a certain angle, the line jumps and locks at the MAX ANGLE, but there shouldnt be any jump, it should be smooth, like the line ran into a invisible barrier. This could just be me though, my PosX and PosY are floats.

```
 private void CheckAngle() {
    double adj = Math.abs(PosX - PosX2);
    double c1 = adj;
    double c2 = Math.abs(PosY - PosY2);
    double hyp = Math.hypot(c1, c2);

    double angle = Math.cos((adj/hyp));
    angle = angle * 100;

    if (angle > MAX_ANGLE) {

        double opp = (Math.tan(MAX_ANGLE) * Math.abs(PosX - PosX2));

        if (PosY > PosY2) {
            PosY2 =(float) (PosY - opp);
        } else {
            PosY2 =(float) (PosY + opp);
        }

    }
} 
```

My answer was a combination of using radians, as well as unsing

```
 Math.acos() & Math.atan() 
```

so the final code looks like this

```
 private void CheckAngle() {
    double adj = Math.abs(PosX - PosX2);
    double opp = Math.abs(PosY - PosY2);
    double hyp = Math.sqrt((adj*adj)+(opp*opp));

    double angle = Math.acos((adj/hyp));
    angle = angle * 100;
    angle = Math.toRadians(angle);

    if (angle > MAX_ANGLE) {

        opp = (Math.atan(MAX_ANGLE) * adj);

        if (PosY > PosY2) {
            PosY2 =(float) (PosY - opp);
        } else {
            PosY2 =(float) (PosY + opp);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:09:38.417

这是转换：

```
final double MAX_ANGLE = Math.toRadians(80); 
```

请注意，这与说：

```
final double MAX_ANGLE = 80 * Math.PI / 180; 
```

# iphone - Load a map through an NSString

> ID：11804737
> 
> 赞同：0
> 
> 时间：2012-08-03T23:58:19.880
> 
> 标签：iphone, objective-c

I am working on a game that requires a tile map saved in multidimensional array. In my game I have all of these maps made that are NSStrings with all the saved values needed, I'm looking to save all the 256 values of the NSString into an int 16x16 multidimensional array.

Here is my current code however it doesn't work

```
-(void)LoadMap:(NSString*)mapString
{
    for(int h = 0; h < kMapSize; h++)
    {
        for(int w = 0; w < kMapSize; w++)
        {
            map[w][h] = [[mapString substringWithRange:NSMakeRange((h)+(w*kMapSize), 1)] intValue];
        }

    }

} 
```

Any help would be great thankyou :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T01:49:07.703

有两个潜在的错误：

*   `kMapSize`可能不等于 16。这个变量有一个误导性的名称，因为不经意的读者会认为它应该是 256。也许重命名它`kMapWidth`。
*   `mapString`可能不是 256 个字符长。您可能想`[mapString length]`在`LoadMap`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T14:24:26.373

下面的代码没有问题。也许第二行是错误的原因。

```
// initial data
NSInteger kMapSize = 3;
char map[3][3];   <-- this row ?
NSString *mapString = @"000111222";

// put initial data into 'map' array
for(int h = 0; h < kMapSize; h++) {
    for(int w = 0; w < kMapSize; w++) {
        map[w][h] = [[mapString substringWithRange:NSMakeRange((h)+(w*kMapSize), 1)] intValue];
    }
}

// confirm whether the data is stored successfully
for (int h = 0; h < kMapSize; h++) {
    for (int w = 0; w < kMapSize; w++) {
        NSLog(@"%d", map[w][h]);
    }
} 
```

# ruby-on-rails - 如何从thinking-sphinx将额外的字段加载到模型中？

> ID：11804742
> 
> 赞同：0
> 
> 时间：2012-08-03T23:59:29.140
> 
> 标签：ruby-on-rails, sphinx, thinking-sphinx

我像这样使用thinking-sphinx：

```
class Project < ActiveRecord::Base
  define_index do
    indexes title
    indexes comments.message, as: :comment_message
    indexes category_projects.description, as: :category_description
  end

  class << self
    def text_search(word)
      ThinkingSphinx.search(word, include: :comments)
    end
  end
end 
```

当我这样做时，`Project.text_search('test')`它可以工作，但我想这样做：

```
@projects = Project.text_search('test')
@projects.each do |project|
  puts project.comment_message
end 
```

目前我有这个消息：

```
undefined method `comment_message' for #<ThinkingSphinx::Search:0x000000057e11c0>
    from /home/dougui/.rvm/gems/ruby-1.9.3-p194-perf@comment_my_projects/bundler/gems/thinking-sphinx-b293abdbdf0c/lib/thinking_sphinx/search.rb:185:in `method_missing'
    from (irb):1
    from /home/dougui/.rvm/gems/ruby-1.9.3-p194-perf@comment_my_projects/gems/railties-3.2.6/lib/rails/commands/console.rb:47:in `start'
    from /home/dougui/.rvm/gems/ruby-1.9.3-p194-perf@comment_my_projects/gems/railties-3.2.6/lib/rails/commands/console.rb:8:in `start'
    from /home/dougui/.rvm/gems/ruby-1.9.3-p194-perf@comment_my_projects/gems/railties-3.2.6/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

那么，如何从thinking-sphinx 中将字段加载到模型中呢？

我没有找到任何医生。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T13:21:23.237

在 TS 邮件列表中也有回答，但本质上，Sphinx 不会返回这些字段，因此您只需要参考构建这些字段的关联/列：

```
projects.each do |project|
  puts project.comments.message.join("\n")
end 
```

# php - GED/PHP/Zend 如何保存和生成保持相同哈希的 pdf

> ID：11804746
> 
> 赞同：0
> 
> 时间：2012-08-04T00:00:13.507
> 
> 标签：php, zend-framework, pdf, hash

我需要首先使用 Zend_Pdf->save('blabla.pdf') 生成一个 pdf 以将 pdf 文件保存到系统，然后：

```
$pdf = Zend_Pdf::load('blabla.pdf'); $pdfData = $pdf->render(); 

header("Content-Type: application/x-pdf");
header("Content-Disposition: attachment; filename=".$preuve.".pdf");
header("Cache-Control: no-cache, must-revalidate");

echo $pdfData; 
```

在不给他任何链接的情况下向用户发送 pdf。

然后当我想将这两个文件与 hash_files('sha512','blabla.pdf') 和 hash_files('sha512','blabladownloadedbyuser.pdf') 进行比较时

我得到2个不同的哈希。

有没有办法比较具有完全相同内容但由 2 种不同方式生成的 2 个 pdf。

编辑 ：

现有的所有解决方案都是 header("Content-Type: application/x-pdf"); 回声布拉布拉;

但这会在您每次重新生成时生成一个新文件，并且我需要用户在内容方面拥有完全相同的文件，并且能够使用哈希来控制它。

谢谢 DG

# ssh - 远程端口访问

> ID：11804747
> 
> 赞同：0
> 
> 时间：2012-08-04T00:00:30.283
> 
> 标签：ssh, port, redhat, remote-access

我在为我的项目设置的虚拟机上工作时在 Intranet 上工作，有时我必须通过输入 localhost:port 号来访问它，它可以工作。

现在我在家工作，我可以下载/上传，使用 SSH 等。但是我不能通过输入 URL：端口号来访问同一个端口，而其他一切都正常。

我对这一切都很陌生，所以请原谅我对可能是一个非常基本的主题的无知。<

PS据说系统管理员给了我对机器的完全和完全的访问权限，包括给我完全的防火墙权限。如果需要，我还可以通过 SSH 进行 root 访问。

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T22:25:55.140

尝试运行

```
ssh -L port:localhost:port remotehost 
```

然后像在工作一样访问 localhost:port 。

（注意，您不需要 root 访问权限。）

# html - 不刷新缓存的图像不更新

> ID：11804750
> 
> 赞同：-1
> 
> 时间：2012-08-04T00:00:47.223
> 
> 标签：html, image, caching

当我将新图像上传到我的网站时，如果没有先清除浏览器缓存，它似乎不会显示更新的图像。

我很确定这不是正常行为，但我不知道如何解决它，这导致我拔掉头发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:06:26.637

我认为图像缓存是一种正常的浏览器行为。这是有道理的：图像很大，并且不会经常更改。如果您因为正在开发网站而需要刷新图像，但您希望图像在未来保持不变，我建议您在开发网站时暂时禁用浏览器中的缓存。

### 在 Chrome 中出于开发目的临时禁用缓存：

`wrench/tools/developer tools/gear icon (bottom right)/check "Disable cache"`

如果您需要为网站的生产版本不断更改图像，您可以配置您的服务器以告诉浏览器不要缓存页面。

# c# - 将 System.Type 转换为 T 参数

> ID：11804759
> 
> 赞同：3
> 
> 时间：2012-08-04T00:02:40.727
> 
> 标签：c#, json, generics, types

我有`System.Type`一个对象，我想将它用作泛型函数的参数：`JsonConvert.DeserializeObject<T>()`

当然`JsonConvert.DesierializeObject<theType>()`不起作用..我似乎需要类的名称，但我不确定如何从类型中获取它。

有没有办法将类型转换回 T 以便我可以调用该函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-04T00:09:29.710

我猜 DeserializeObject 是一个静态方法？尝试使用反射：

```
var methodInfo = typeof(JsonConverter).GetMethod("DeserializeObject", System.Reflection.BindingFlags.Static | BindingFlags.Public);
var genericArguments = new Type[] { theType };
var genericMethodInfo = methodInfo.MakeGenericMethod(genericArguments );
var result = genericMethodInfo.Invoke(null, null); 
```

如果需要`DeserializeObject`一些参数，则将它们传递到`Invoke`最后一行方法的第二个参数中......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-04T05:15:35.060

你在使用 json.net 吗？`JsonConvert`有另一种方法

```
 public static object DeserializeObject(string value, Type type); 
```

你可以用这个，比如

```
var result = JsonConvert.DeserializeObject("{ some json }", theType); 
```

# c++ - 将可变参数模板类的模板参数解包为常量和常量数组

> ID：11804760
> 
> 赞同：4
> 
> 时间：2012-08-04T00:02:45.407
> 
> 标签：c++, templates, variadic-templates, unpack

我对 C++2011 的可变参数模板很陌生，我想知道是否存在做以下事情的技巧：

```
template<typename T, unsigned int... TDIM> class VariadicTest
{
    public:
        static const unsigned int order_const = sizeof...(TDIM);
        static const unsigned int size_const = // TDIM1*TDIM2*TDIM3...
        static const unsigned int dim_const[order_const] = // {TDIM1, TDIM2, TDIM3...} 
                                                          // if not possible : 
                                                          // dim_const[64] = {TDIM1, TDIM2, TDIM3, 0, ..., 0}

}; 
```

做这样的事情有什么“技巧”吗？

非常感谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T17:44:47.753

这是实现其他两个功能的方法：

```
template<unsigned int... T> struct mul;
template<unsigned int L,unsigned int... T> struct mul<L,T...>
{
static const int val= L*mul<T...>::val;
};
template<unsigned int L> struct mul<L>
{
static const int val= L;
};

template<typename T, unsigned int... TDIM> class VariadicTest
{
    public:
        static const unsigned int order_const = sizeof...(TDIM);
        static const unsigned int size_const = mul<TDIM...>::val;
        static const unsigned int dim_const[order_const];
};
template<typename T, unsigned int... TDIM> 
const unsigned int VariadicTest<T,TDIM...>::dim_const[order_const] = {TDIM...}; 
```

测试： http: [//liveworkspace.org/code/cfb0ec09a05931cfcc00edf29866e716](http://liveworkspace.org/code/cfb0ec09a05931cfcc00edf29866e716)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T00:39:20.907

这是部分答案，它确实`order_const`和`size_const`. 但我还看不到该怎么做`dim_const`。

```
#include<iostream>
using namespace std;

template<typename T, unsigned int... TDIM>
class VariadicTest;

template<typename T>
class VariadicTest<T>
{
    public:
        static const unsigned int order_const = sizeof...(TDIM);

        static const unsigned int size_const = 1;
};
template<typename T, unsigned int baseTDIM, unsigned int... others>
class VariadicTest<T, baseTDIM, others...>
{
    public:
        static const unsigned int order_const  = sizeof...(TDIM);
        static const unsigned int size_const = baseTDIM * VariadicTest<T,others...> :: size_const;    
};

int main() {
        VariadicTest<double, 9, 4, 5> x;
        cout << x.order_const << endl;
        cout << x.size_const << endl;
} 
```

# javascript - Ajax 加载带有内容的 javascript 和 css

> ID：11804764
> 
> 赞同：0
> 
> 时间：2012-08-04T00:03:02.567
> 
> 标签：javascript, ajax, jquery, jquery-load

我正在使用 jquery ajax 将内容从一个页面加载到当前页面的 div 中，类似于 gmail 在收件箱、垃圾箱等之间切换的方式。我使用的是 jQuery 的加载方法

```
$("#divGlobal").load("newPage.html #container"); 
```

将我需要的内容加载到我的 div 中。

`newpage.html #container`也有与之关联的相关 javascript & css 文件。现在我通过附加必要的`<script>`和`<link>`标签来加载它们，`<head>`但它并不总是有效。文件总是加载（我在 Firefox 中观看 XHR 信息），但似乎并不总是正常工作。

例如，如果我加载`page1.html`和关联文件（包括 UI 的 jQuery 函数），一切正常。但是，如果我然后加载`page2.html`并返回`page1.html`，文件加载但 jQuery 函数没有响应。

有没有更好的方法来加载与我正在加载的内容相关的 javascript 和 css 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:09:39.983

重新加载您之前加载的相同 javascript 可能无法达到您想要的效果，因为所有变量和函数已经从之前的加载中定义，并且某些状态可能已经在之前的加载中到位。将其再次加载到同一页面不会从头开始，这可能是您想要的。

如果您控制正在加载的页面，那么您可以通过专门设计的内容加载中的脚本来编写 javascript，以便它们准确地设置您想要的状态并清理任何以前加载的内容状态，但是您必须以这种方式编写它们才能以这种方式工作。这将包括重置脚本的第一次调用可能已修改的任何 DOM 修改、事件处理程序、全局变量等。

# java - 在意图中添加 2 个额外内容

> ID：11804766
> 
> 赞同：0
> 
> 时间：2012-08-04T00:03:51.787
> 
> 标签：java, android

我已经做了一个打算，我已经在里面放了 2 个额外的东西

```
Intent intent = new Intent(MainActivity.this, Options.class);
                TextView labelName = (TextView) findViewById(R.id.label1); // value = "Counter1"
                TextView label2Name = (TextView) findViewById(R.id.label2); // value = "Counter 2"
                String lblNameDefault = labelName.getText().toString();
                String lbl2NameDefault = label2Name.getText().toString();
                intent.putExtra(LABEL_NAME_DEFAULT, lblNameDefault);
                intent.putExtra(LABEL_2_NAME_DEFAULT, lbl2NameDefault); 
```

在我的其他活动中，我像这样从他们那里检索信息

```
//Get name from the label
    Intent intent = getIntent();
    String lblNameDefault = intent.getStringExtra(MainActivity.LABEL_NAME_DEFAULT);
    String lbl2NameDefault = intent.getStringExtra(MainActivity.LABEL_2_NAME_DEFAULT);

   //Set current name to editText
    EditText labelNameDefault = (EditText)findViewById(R.id.set_name);
    EditText label2NameDefault = (EditText)findViewById(R.id.set_name2);
    labelNameDefault.setText(lblNameDefault, TextView.BufferType.EDITABLE);
    label2NameDefault.setText(lbl2NameDefault, TextView.BufferType.EDITABLE); 
```

问题是我从 LABEL_2_NAME_DEFAULT 接收到 labelNameDefault 和 label2NameDefault 结果。

我只能通过一个额外的吗？我怎样才能通过它们？

默认情况下，labelName 的值为“计数器 1”，label2Name 的值为“计数器 2”

如果我注释掉`intent.putExtra(LABEL_2_NAME_DEFAULT, lbl2NameDefault);`第一个标签名称就可以了。看起来 LABEL_2_NAME_DEFAULT 正在覆盖 LABEL_NAME_DEFAULT

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T01:37:29.357

如果您愿意，您可以传递额外的“捆绑”而不是单独的额外，例如：-

```
Intent intent = new Intent(this, MyActivity.class);
Bundle extras = new Bundle();
extras.putString("LABEL_NAME_DEFAULT",lblNameDefault);
extras.putString("LABEL_2_NAME_DEFAULT",lbl2NameDefault);
intent.putExtras(extras);
startActivity(intent);
Then in your Activity that your triggering, you can reference these like so:-

Intent intent = getIntent();
Bundle extras = intent.getExtras();
String username_string = extras.getString("LABEL_NAME_DEFAULT");
String password_string = extras.getString("LABEL_2_NAME_DEFAULT");
Or (if you prefer):-

Bundle extras = getIntent().getExtras();
String username_string = extras.getString("LABEL_NAME_DEFAULT");
String password_string = extras.getString("LABEL_2_NAME_DEFAULT");

Hope this helps! :-) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T03:30:21.447

活动一

```
Intent intent = new Intent(MainActivity.this, Options.class);
            TextView labelName = (TextView) findViewById(R.id.label1); // value = "Counter1"
            TextView label2Name = (TextView) findViewById(R.id.label2); // value = "Counter 2"
            String lblNameDefault = labelName.getText().toString();
            String lbl2NameDefault = label2Name.getText().toString();
            intent.putExtra("LABEL_NAME_DEFAULT", lblNameDefault);
            intent.putExtra("LABEL_2_NAME_DEFAULT", lbl2NameDefault); 
```

活动二

```
 username_string = getIntent().getExtras().getString("LABEL_NAME_DEFAULT");
 password_string = getIntent().getExtras().getString("LABEL_2_NAME_DEFAULT"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T00:07:22.783

您可以在一个意图中传递两个（或更多）额外内容。不过，您需要确保`LABEL_2_NAME_DEFAULT`和`LABEL_NAME_DEFAULT`不具有相同的值。

# python - 在python中使用嵌套的for循环加载字典

> ID：11804769
> 
> 赞同：2
> 
> 时间：2012-08-04T00:04:11.820
> 
> 标签：python, list, dictionary, for-loop

我只是在学习python（具有VBA背景）。

为什么这本字典没有加载？我试图拿出一副完整的纸牌。

这是我的代码：

```
class Deck:
    def load_deck(self):
        suite = ('Spades', 'Hearts', 'Diamonds', 'Clubs')
        rank = (2, 3, 4, 5, 6, 7, 8, 9, 10, "Jack", "Queen", "King", "Ace")
        full_deck={}
        for s in suite:
            for r in rank:
                full_deck.setdefault(s,r)
        return full_deck
raw_deck = Deck()
raw_deck1 = raw_deck.load_deck()
print raw_deck1 
```

这是我的输出：

```
{'Hearts': 2, 'Clubs': 2, 'Spades': 2, 'Diamonds': 2} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T00:11:20.403

JBernardo 的评论为您提供了 for 的正确用法`setdefault()`，但您可以将循环简化为以下内容：

```
full_deck = {}
for s in suite:
    full_deck[s] = rank 
```

或者，如果您想要一个列表而不是一个元组，请使用`list(rank)`.

单线：

```
full_deck = {s: rank for s in suite} 
```

Python 2.6 或以下：

```
full_deck = dict((s, rank) for s in suite) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T00:18:10.960

您正在创建的方法实际上并不需要在一个类中 - 取决于您要执行的操作...如果您只是尝试填充字典，那么您可以分配值而不是使用 setdefault( ) 方法（如上所述）。

你可以像这样简单地做到这一点：

```
cards = {}
for suit in ('Heart', 'Club', 'Spade', 'Diamond'): 
    cards[suit] = range(2, 11) + ['Jack', 'Queen', 'King', 'Ace']
print cards 
```

如果你试图用信息填充一个新的类类型，那么你应该定义一个**init**函数（它在 Python 中充当类构造函数）来创建和存储新的成员变量，即：

```
class Deck:
    def __init__( self ):
        self._cards = {}
        for suit in ('Heart', 'Club', 'Spade', 'Diamond'):
            self._cards[suit] = range(2, 11) + ['Jack', 'Queen', 'King', 'Ace']

    def cards( self ):
        return self._cards

deck = Deck()
print deck.cards() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T03:38:35.210

这是在支持*字典理解*的 Python 2.7 中执行此操作的有效方法：

```
def load_deck():
    suite = ('Spades', 'Hearts', 'Diamonds', 'Clubs')
    rank = ('2', '3', '4', '5', '6', '7', '8', '9', '10', "Jack", "Queen", "King", "Ace")
    return {item[0]:item[1] for item in enumerate(((r,s) for r in rank for s in suite))} 
```

对于 Python < 2.7，您需要将另一个*生成器表达式*与`dict`类构造函数一起使用，如下所示：

```
def load_deck():
    suite = ('Spades', 'Hearts', 'Diamonds', 'Clubs')
    rank = ('2', '3', '4', '5', '6', '7', '8', '9', '10', "Jack", "Queen", "King", "Ace")
    return dict((item[0],item[1])
                for item in enumerate(((r,s) for r in rank for s in suite))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-04T02:24:56.277

使用来自@ernie 的回复指出我需要一个带有单个键的字典，用于 52 个单独的对，我想出了以下内容，它可以满足我的需求。

```
def load_deck():
    suite = ('Spades', 'Hearts', 'Diamonds', 'Clubs')
    rank = ('2', '3', '4', '5', '6', '7', '8', '9', '10', "Jack", "Queen", "King", "Ace")
    full_deck = {}
    i = 0
    for s in suite:
        for r in rank:
            full_deck[i] = r,s  # took this solution from the comment below.  it works.
            i += 1
    return full_deck
print load_deck() 
```

# javascript - 输入类型图像在 Internet Explorer 中不起作用，但在 Chrome 和 Firefox 中有效

> ID：11804773
> 
> 赞同：1
> 
> 时间：2012-08-04T00:05:47.247
> 
> 标签：javascript, image, internet-explorer, input, onclick

我无法弄清楚为什么以下输入在 IE 中不起作用。我也试过`type="button"`了，还是不行。

```
<input type="image" src="/images/150x200.png" alt="Profile" onClick="window.open('http://www.genericname.com/blah.aspx','Blah - Blah Blah','width=790,height=600,resizable=yes,scrollbars=yes,toolbar=no,location=no,directories=no,status=no,menubar=no,copyhistory=no')" /> 
```

我的目标是在单击按钮时打开一个新*窗口*作为*弹出窗口。*

我需要知道这是否是一个已知的错误。如果是这样，我将需要找到其他解决方案。欢迎任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:07:44.053

问题是您使用的窗口名称“Blah - Blah Blah”会让 IE 不高兴。它应该看起来像一个标识符（没有空格，我认为也没有“-”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:17:48.010

您应该在 IE 中收到错误 Invalid Argument 并且这就是它无法打开的原因，因为 Window,open() 不喜欢传递给 window,open() 的空格字符。如果你摆脱了等等等等之间的空格，它就会起作用。

# php - 是否可以将答案作为整数存储在数据库中？

> ID：11804774
> 
> 赞同：-2
> 
> 时间：2012-08-04T00:05:49.073
> 
> 标签：php, html, mysql

在您继续阅读之前，我只想说清楚，我不是在找人为我编写代码，我只需要知道我是否可以这样做，因为我没有那么长时间可以花在这部分任务上，我认为最好询问 Stackoverflow 上的专家/人。

所以我的问题是：我有一些问卷，将由参与者完成，因为答案是字符串，我想知道是否可以将这些答案存储为整数，例如，你有：

1 ="从不正确" 2="很少正确" 3="有时正确" 4="经常正确" 5="经常正确"。我只想存储数字，我只是想知道这是否可能。

谢谢你。

**完成的**

我想在我把这个问题措辞得很糟糕之前，我的错。但是，我确实设法完成了那部分，我将值存储在数据库中，并分配给每个答案。同样正如@octern 提到的创建代码，这也非常方便，所以谢谢。

我感谢所有的答复，以及您处理这个问题的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:08:23.937

是的，您可以将整数存储在数据库中。显然，您可以为这些整数分配您自己的含义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-04T00:09:31.100

你可以。如果您的参与者使用 HTML 表单提交他们的答案，只需将表单元素的 VALUE 属性设置为答案的数字代码，这就是您数据库中的内容。

只需**非常非常确定**您创建了一个密码本，这样您就可以找出哪个数字对应于将来的哪个答案！您不想依赖解析网页，这可能会随着时间的推移而发生变化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-04T00:11:01.433

是的，你可以这么做。或者，您可以创建一个名为“possible_answers”的表，例如以 id 作为主键，将文本作为问题。存储问题答案的表现在可以具有到 possible_answers 表的外键，以确保保存的整数始终有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-04T19:04:44.867

有两种基本方法可以以相对容易阅读和理解的方式将值存储为整数。

最简单的方法是将它们存储为 ENUM，因为存储在行中的值实际上是 ENUM 声明中可能性列表的索引。ENUM 的问题是必须提前知道可能答案的列表，并且该列表需要保持相对静态，除非您每次想要维护该列表时都喜欢中断以更改表的结构。

最灵活的方法是创建一个带有 ID 列（通常是 auto_increment 或某种序列）和用于该数字的标签的表。然后，原始表只是引用“其他”表中的 ID 列。这通常称为外键引用。

In MySQL, the performance of ENUMs versus foreign key references is nearly identical.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-04T00:09:38.977

是的，您当然可以将整数存储在数据库中。请记住，如果您这样做，您需要将这些整数“翻译”为应用程序中的实际答案，可能使用 switch 语句。

# java - 不成功：使用休眠创建表

> ID：11804775
> 
> 赞同：4
> 
> 时间：2012-08-04T00:06:22.207
> 
> 标签：java, spring, hibernate

当我想在休眠中创建一个新表时出现此错误

```
SEVERE: Unsuccessful: create table gmail.messages.test (CODE_PERS varchar(255) not null, LAST_NAME varchar(255), FIRST_NAME varchar(255), primary key (CODE_PERS))
3.8.2012 18:30: org.hibernate.tool.hbm2ddl.SchemaExport create
SEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.test (CODE_PERS varchar(255) not null, LAST_NAME varchar(255), FIRST_NAME varch' at line 1
3.8.2012 18:30: org.hibernate.tool.hbm2ddl.SchemaExport execute 
```

这是我的 hibernate.cfg 文件

```
<property name="dialect">org.hibernate.dialect.MySQLDialect</property>
<property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
<property name="hibernate.connection.url">jdbc:mysql://localhost:3306/gmail.messages</property>
<property name="hibernate.connection.username">root</property>
<property name="hibernate.connection.password">admin</property>
<!-- <property name="hbm2ddl.auto" value="auto"/> -->

<property name="hibernate.show_sql">true</property>
<property name="transaction.factory_class">
    org.hibernate.transaction.JTATransactionFactory
</property>
<property name="use_outer_join">false</property>
<property name="jta.UserTransaction">java:comp/UserTransaction</property>
<property name="hibernate.connection.pool_size">12</property>
<property name="hibernate.hbm2ddl.auto">create</property>
<property name="hibernate.default_schema">gmail.messages</property>
<property name="current_session_context_class">thread</property>

<mapping resource="HibernateMapping/hibernate.hbm.xml"/> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-04T07:45:08.543

如堆栈跟踪所示，Hibernate 从 MySQL 数据库中捕获了一个异常，因此请尝试直接在数据库中执行查询（直接调试比通过框架调试要容易得多）。

如果您将表名中的点更改为下划线，您的查询将成功执行。

# php - 创建一个简单的 PHP 登录/注销系统

> ID：11804779
> 
> 赞同：1
> 
> 时间：2012-08-04T00:06:31.160
> 
> 标签：php, session, cookies, login, logout

这是一项任务，但我在研究方面做了很多工作，但我觉得我已经走到了尽头。我需要创建一个用户可以登录的页面（login.php），一旦他们登录，他们就会被重定向到索引页面。他们单击登录的链接应替换为注销链接。

但是，注意到所有这些后，首先我确实进入了会话部分，我回显了变量并检索了它们，但是当我在记录会话变量后手动单击 index.php 时，它也不会重定向到 index.php是空的。我在这里做错了什么？？？

所以这是我在 login.php 中的 php 代码

```
 $found = false;
          //read the read.txt until the end of file
          while(!feof($inputFile) && $found == false)  
          {

            $line = fgets($inputFile);  
            // replace the special charater within the lines by there proper entity code
            $lineArray = preg_split("/\,/", (string)$line);

            if(strcmp($_REQUEST['email'],$lineArray[2])  && strcmp($_REQUEST['pwd'],$lineArray[4]))
            {
                        $found = true;
                        echo "<script>alert(' FOUND!')</script>";
                        session_start();
                        $myuseremail=$_REQUEST['email'];
                        $mypassword= $_REQUEST['pwd'];

                        $_SESSION['login_email']=$myuseremail;
                        $_SESSION['login_pwd']=$mypassword;
                        setcookie("login_email", $_SESSION['login_email'], time()+60*60*24);
                        setcookie("login_pwd", $_SESSION['login_pwd'], time()+60*60*24);
                        header('Location:index.php');
            }
          }
          fclose($inputFile); 
```

然后在我的 index.php 中，我在我的 html 正文之前包含此代码

```
 <?php

      session_start();
   if(isset($_SESSION['login_email']) && isset($_SESSION['login_pwd']))
   {
    $user_check=true;
    echo $_SESSION['login_email'];
   }
   else
   {
    $user_check=false; 
   }

?> 
```

在 index.php 中，我也为我的链接添加了这段代码

```
 <li><a href="index.php">Home</a></li>
 <li><a href="register.php">Register</a></li>

 <?php

if ($user_check){
                 print "<li><a href='logout.php'>Logout</a></li>";
 }
 else{
 print "<li><a href='login.php'>Login</a></li>";
 }
 ?>
            <li><a href="#"> Link 4</a></li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T01:39:01.777

实际上，您的脚本与您可能打算做的相反：

`strcmp`确实比较了两个参数，但它不返回布尔值。

首先要做的就是将该行更改为：

```
if ($_REQUEST['email'] === $lineArray[2] && $_REQUEST['pwd'] === $lineArray[4]) { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-04T03:12:56.960

I found some errors in your code, all coming down to the same point: You **cannot** send any custom headers after you have began outputting other data.

Where have you done this?

Here:

```
echo "<script>alert(' FOUND!')</script>";
session_start();//session_start() sends a cookie to the clients machine. 
//How are cookies sent to clients browsers? Through headers. 
```

And here:

```
setcookie("login_email", $_SESSION['login_email'], time()+60*60*24);
setcookie("login_pwd", $_SESSION['login_pwd'], time()+60*60*24);
header('Location:index.php'); 
```

Personally, I think your code is a complete mess. Because I have nothing better to do, I'll re-write it for you, explaining each step as I go along.

Let's begin:

So the first thing you want to work on is your text file, which stores all the user details.

Instead of using plain lines or whatever, we should use JSON to split users details, from user to user.

So here's what the text file will look like with two users in it:

```
{"navnav":{"username":"navnav","pass":"deb1536f480475f7d593219aa1afd74c"},"user2":{"username":"user2","pass":"deb1536f480475f7d593219aa1afd74c"}} 
```

Notice how I've also used the username as keys too and how I've hashed the password. So we call this file user.txt and store it somewhere safe.

Now, for the login page, we shall simply get the data through the POST method, compare it, set sessions and tell the user to go somewhere else (redirect them).

```
session_start();//need to start our session first, of course

//check if any login data has been posted our way
if ( isset($_POST['login']) && !empty($_POST['username']) && !empty($_POST['password']) )
{

//assign input data to temp vars
$username = $_POST['username'];
$password = md5($_POST['password']);//notice how I hash the password 

// get the data fro the text file
$userData = file_get_contents('path to your text file');

//decode the json data to an assoc array 
$userData = json_decode( $userData , true );

//check if the user exists
if ( array_key_exists( $username , $userData ) === false )
{

echo 'the username '.$username.' is invalid.';//notify the user
exit();//bye bye

}//end of user does not exist

//so now we know the user name exists (because we've got to this line)
//we shall compare with the password

if ( $userData['$username']['password'] !== $password )
{

echo 'Your password is incorrect';//notify the user
exit();//bye bye

}//end of incorrect password
else
{

//time to set sessions and stuff
$_SESSION['username'] = $username;
$_SESSION['password'] = $password;

//send the redirect header
header('Location: index.php');
exit();

}//end of password is correct

}//end of login data has been sent 
```

That's all your login code, but you need your html form setup correctly for the right things to be posted with the right names. So use this html form:

```
<form action="login.php" method="post" name="login" target="_self" id="login">
  <p>
    <label for="username">Username</label>
    <input type="text" name="username" id="username" />
  </p>
  <p>
    <label for="password">Password</label>
    <input type="text" name="password" id="password" />
  </p>
</form> 
```

That's your login page completely sorted.

Now for your index.php:

As you did before, check if the user is logged in and throw the status is in a var:

```
session_start();//resume your session (if there is one) or start a new one

//set default user status
$userStatus = false;

if ( isset($_SESSION['username']) && isset($_SESSION['password']) )
{

$userStatus = true;

}//end of user is logged in 
```

For your HTML login/logout:

```
<li><a href="index.php">Home</a></li>
<li><a href="register.php">Register</a></li>

<?php
if ($userStatus === true){
echo "<li><a href='logout.php'>Logout</a></li>";
}
else{
echo "<li><a href='login.php'>Login</a></li>";
}
?>
<li><a href="#"> Link 4</a></li> 
```

And there you have it.

Let me know if you have any problems.

One more thing:

This is **far** from secure. Why? You're using text files, you're using text files and you're using text files.

EDIT:

To separate the JSON data by user, simply edit the text file manually (see my comment).

Or you could just paste this into your text file:

```
{"navnav":{"username":"navnav","pass":"deb1536f480475f7d593219aa1afd74c"},
"user2":{"username":"user2","pass":"deb1536f480475f7d593219aa1afd74c"}} 
```

Do you see how there is no `\n` in the above? Because I just created a new line manually (by just hitting enter). `\n` will make the JSON code invalid, so that's why you should avoid it. This method just means if you have to create new users, and you **need** a new line for each user, then you will have to do it manually.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-04T01:47:54.920

首先，在某些输出发生后永远不要发送标题，即当你这样做时`echo "<script>alert(' FOUND!')</script>";`被认为是输出，PHP 将生成一个标题，稍后你的标题行将被忽略。

尝试在不先发送任何输出的情况下使用标头，这应该可以解决重定向问题。

至于会话信息被擦除的原因，请在重定向上尝试以下行：

```
header('Location:index.php?'.SID); 
```

它不应该是必需的，但值得一试。

# css - CSS：图像出现在内容区域旁边（左和右）

> ID：11804780
> 
> 赞同：2
> 
> 时间：2012-08-04T00:06:32.567
> 
> 标签：css

我目前正在处理图像和背景 css 位置。我一直在努力让相同的图像出现在内容区域的旁边（左/右）。我试图让图像位置不受 pagee re size 的影响。

我怎样才能让相同的图片出现在内容区域旁边？[例子](http://webprolearner2346.zxq.net/css-test/)

这就是我的目标：

![这就是我的目标](../Images/da258d437d5215db8f69be93ba79543b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T01:04:38.197

这是[我的尝试](http://tinkerbin.com/HG4t3vbB)。我使用了一个位于中心的绝对定位的 div 来包含图像，然后使用相对位置将它们定位到任一侧的特定像素位置。诀窍是，如果您不使用相对定位，它们会彼此重叠，因此您必须将`top:`与图像高度相等的值应用于其中一个以使其移动以匹配。

HTML：

```
 <div id="image_container">
        <div id="img_r" class="outside_image">
            <img />
        </div>
        <div id="img_l" class="outside_image">
            <img />
        </div>  
    </div> 
```

CSS：

```
#image_container{
  position: absolute;
  top: 0px;
  left: 50%;
  width: 0px;
  z-index: 900; /* not really required */
}

.outside_image img{
  width: 200px;
  height: 200px;
}
.outside_image {
    position: relative;
}
#img_r{
  float: right;
  right: -725px;
  top: 200px;
}
#img_l{
  float: left;
  left: -725px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:14:10.757

您可以在#left2 上使用负边距：

```
#left2 {    
    float: left;    
    width: 200px;    
    background: #DDD;    
    -moz-border-radius: 10px;    
    border-radius: 10px;    
    margin-right: 15px;   
    padding: 5px;    
    margin-left: -248px;    
} 
```

如果您需要它保持在同一个位置（即使您调整页面大小），您可以使用绝对位置：

```
#left2 {   
    position: absolute;    
    left: 20px;   
    top: 160px;   
} 
```

我使用 Chrome 开发者工具来尝试这些东西。这是带有我的代码的页面截图：http: [//d.pr/i/wXQ2](http://d.pr/i/wXQ2)

# c# - 在 MVC 中为 DateTime 创建一个编辑器模板，其中包含日、月、年的三个输入字段

> ID：11804781
> 
> 赞同：1
> 
> 时间：2012-08-04T00:06:53.103
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, datetime, datetimepicker

我想为 DateTime 创建一个编辑器模板？具有日、月、年 3 个文本框的字段。目前我的 EditorTemplates/Date.cshtml 看起来像这样：

```
@Html.TextBox(string.Empty, Model.HasValue ? Model.Value.Day.ToString() : "",
                            new { @class = "day-box", title = "day", min = "1", max = "31", type = "number" })
@Html.TextBox(string.Empty, Model.HasValue ? Model.Value.Month.ToString() : "",
                            new { @class = "month-box", title = "month", min = "1", max = "12", type = "number" })
@Html.TextBox(string.Empty, Model.HasValue ? Model.Value.Year.ToString() : "",
                    new { @class = "year-box", title = "year", min = "1900", max = "2020", type = "number" }) 
```

明显的问题是（原样） id 和 name 属性都设置为相同的值。我需要在这些值上附加一些东西，并且永远不要让它回到我的模型中。

我希望将 _Day 附加到 id，并将 .Day 附加到 Day 输入的名称，同样的月份和年份可以解决问题。但我看不到这样做的简单方法。

我打算使用隐藏输入作为实际值，然后每次在我的三个（d/m/y）文本框之一中的值发生更改时，使用 javascript 更新隐藏字段的值。

那么，当我传入 string.Empty 时，有没有办法获取 MVC 将使用的名称和 ID？使用 ViewData.TemplateInfo.HtmlPrefix 似乎没有提供全部价值。

有没有更好的方法来做我想做的事？我无法想象我是第一个解决这个问题的人。

我知道那里有第 3 方日期选择器。为了这个问题，我对它们不感兴趣。

谢谢，~S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T04:59:34.320

如果 DateTime 的年月日是***可***设置的，您可以在 DateTime.cshtml EditorTemplates 上执行此操作

```
@model System.DateTime
@Html.TextBoxFor(model => model.Year) / @Html.TextBoxFor(model => model.Month) / @Html.TextBoxFor(model => model.Day) 
```

以上是不可能的。DateTime 的年、月和日属性是只读的。

您可以做的只是创建一个单独的数据类型：

```
public struct DatePart
{
    public int Year { get; set; }
    public int Month { get; set; }
    public int Day { get; set; }

    public DateTime Date { get { return new DateTime(Year, Month, Day); } }
} 
```

然后在您的日期 EditorTemplates 上执行此操作

```
@model TestV.Models.DatePart           
@Html.TextBoxFor(model => model.Year) / @Html.TextBoxFor(model => model.Month) / @Html.TextBoxFor(model => model.Day) 
```

然后只需访问 DatePart 的 Date(DateTime 类型) 属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T04:22:24.550

您可以使用 javascript 从自定义模板中的三个字段形成日期，并将其写入将绑定到您的 Model.Date 的隐藏字段中

# c# - 读取 HttpWebRequest 的 HTTP POST 请求

> ID：11804785
> 
> 赞同：0
> 
> 时间：2012-08-04T00:07:20.710
> 
> 标签：c#, .net, http, post, httpwebrequest

我需要为我正在编写的一些测试创建 Http POST 请求和一些 GET 请求作为字符串。目前，我的测试使用 StringBuilder 构建它们，并且从 fiddler 中提取的硬编码 POST 请求有点像这样：

```
var builder = new StringBuilder();
builder.Append("POST https://some.web.pg HTTP/1.1\r\n");
builder.Append("Content-Type: application/x-www-form-urlencoded\r\n");
builder.Append("Referer: https://some.referer.com\r\n");
builder.Append("Accept-Language: en-us\r\n");
builder.Append("Accept-Encoding: gzip, deflate\r\n");
builder.Append("User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\r\n");
builder.Append("Host: login.yahoo.com\r\n");
//    ... other header info
builder.Append("\r\n");
builder.Append("post body......\r\n");
var postData = builder.ToString(); 
```

这很快使我的测试变得混乱，并且希望有一种更简洁的方式来构建这些 POST 请求。我一直在研究 HttpWebRequest 类，希望它可以为我创建这些。我认为，它必须有某种方式来构建这个我试图以某种形式创建的确切请求。但可惜的是，GetRequestStream 是一个只可写的流。

有没有办法读取 HttpWebRequest 将生成的请求流（然后将其更改为字符串）？甚至任何关于如何生成这些 POST 请求的想法都可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T01:51:33.390

这里有一个 msdn 示例来发出 Get 请求：

```
using System; 
```

使用 System.Net；使用 System.IO；

namespace MakeAGETRequest_charp { /// /// Class1 的摘要描述。/// 类 Class1 { static void Main(string[] args) { string sURL; sURL = " [http://www.microsoft.com](http://www.microsoft.com) ";

```
 WebRequest wrGETURL;
        wrGETURL = WebRequest.Create(sURL);

        WebProxy myProxy = new WebProxy("myproxy",80);
        myProxy.BypassProxyOnLocal = true;

        wrGETURL.Proxy = WebProxy.GetDefaultProxy();

        Stream objStream;
        objStream = wrGETURL.GetResponse().GetResponseStream();

        StreamReader objReader = new StreamReader(objStream);

        string sLine = "";
        int i = 0;

        while (sLine!=null)
        {
            i++;
            sLine = objReader.ReadLine();
            if (sLine!=null)
                Console.WriteLine("{0}:{1}",i,sLine);
        }
        Console.ReadLine();
    }
} 
```

这里是一个 for post 请求（来自[带有 post 的 HTTP 请求](https://stackoverflow.com/questions/4015324/http-request-with-post)）

```
 HttpWebRequest httpWReq =
    (HttpWebRequest)WebRequest.Create("http:\\domain.com\page.asp");

ASCIIEncoding encoding = new ASCIIEncoding();
string postData = "username=user";
postData += "&password=pass";
byte[] data = encoding.GetBytes(postData);

httpWReq.Method = "POST";
httpWReq.ContentType = "application/x-www-form-urlencoded";
httpWReq.ContentLength = data.Length;

using (Stream newStream = httpWReq.GetRequestStream())
{
    newStream.Write(data,0,data.Length);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T01:56:03.370

我建议您使用模拟，因为它是单元测试的最佳实践：请参阅此答案 on stack [Unit testing HTTP requests in c#](https://stackoverflow.com/questions/9095627/unit-testing-http-requests-in-c-sharp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T05:32:33.080

```
 HttpWebRequest req = (HttpWebRequest)WebRequest.Create(yoururllink);
    var c = HttpContext.Current;

    //Set values for the request back
    req.Method = "POST";
    req.ContentType = "application/x-www-form-urlencoded";
    byte[] param = Request.BinaryRead(HttpContext.Current.Request.ContentLength);
    string strRequest = Encoding.ASCII.GetString(param);
    string strResponse_copy = strRequest;  //Save a copy of the initial info sent from your url link
    strRequest += "&cmd=_notify-validate";
    req.ContentLength = strRequest.Length;

    //for proxy
    //WebProxy proxy = new WebProxy(new Uri("http://url:port#"));
    //req.Proxy = proxy;

    //Send the request to PayPal and get the response
    StreamWriter streamOut = new StreamWriter(req.GetRequestStream(), System.Text.Encoding.ASCII);
    streamOut.Write(strRequest);
    streamOut.Close();
    StreamReader streamIn = new StreamReader(req.GetResponse().GetResponseStream());
    string strResponse = streamIn.ReadToEnd();
    streamIn.Close(); 
```

# internet-explorer - 仅在 Chrome 中使用 SyntaxHighlighter 的额外行？

> ID：11804789
> 
> 赞同：20
> 
> 时间：2012-08-04T00:07:28.430
> 
> 标签：internet-explorer, google-chrome, blogger, syntaxhighlighter

当我使用 Chrome 查看使用语法荧光笔的草稿博客文章（在博客上）时，正在插入额外的行，例如

![插入了 Chrome 多余的行](../Images/ad36c1392dbac0aef0f8448857e74039.png)

但在 IE 上看起来不错：

![IE看起来不错](../Images/0e2132df273c1d7a59d9aab4a654e332.png)

有什么想法我在这里做错了吗？

编辑：

我正在使用的 SyntaxHighlighter 的配置/设置如下：

```
<!-- Syntax Highlighter Additions START -->
<link href='http://alexgorbatchev.com/pub/sh/current/styles/shCore.css' rel='stylesheet' type='text/css'/>
<link href='http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css' rel='stylesheet' type='text/css'/>
<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js' type='text/javascript'/>
<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushcsharp.js' type='text/javascript'/>
<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCss.js' type='text/javascript'/>
<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js' type='text/javascript'/>
<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJScript.js' type='text/javascript'/>
<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js' type='text/javascript'/>

<script language='javascript' type='text/javascript'>
SyntaxHighlighter.config.bloggerMode = true;
SyntaxHighlighter.all();
</script>
<!-- Syntax Highlighter Additions END --> 
```

编辑：

生成的 HTML 是：

```
<pre class="brush: csharp;">using System;
<br />using System.Text;
<br />using System.Collections.Generic;
<br />using System.Linq;
<br />using Microsoft.VisualStudio.TestTools.UnitTesting;
<br />using AccountTypeFollowUp;
<br />
<br />namespace PluginsUnitTests
<br />{
<br />    [TestClass]
<br />    public class AccountTypeFollowUpTests
<br />    {
<br />        [TestMethod]
<br />        public void AccountTypeFollowUp_Account_Is_Supplier()
<br />        {
<br />            throw new NotImplementedException();
<br />        }
<br />
<br />        [TestMethod]
<br />        public void AccountTypeFollowUp_Account_Is_Client()
<br />        {
<br />            throw new NotImplementedException();
<br />        }
<br />
<br />        [TestMethod]
<br />        public void AccountTypeFollowUp_Account_Is_Other)
<br />        {
<br />            throw new NotImplementedException();
<br />        }
<br />    }
<br />}
<br /></pre> 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-07T16:15:57.640

有同样的问题；它似乎是由 shCore.css 文件的这一部分引起的：

```
.syntaxhighlighter table td.gutter .line {
  text-align: right !important;
  padding: 0 0.5em 0 1em !important;
} 
```

如果我将“填充”替换为：

```
padding: 0 5px  !important; 
```

编号在 Chrome 中正常工作（不会对 Firefox 和 IE 显示产生负面影响）所以现在我的博客指向自定义的 shCore.css 而不是[http://alexgorbatchev.com/pub/sh/current/styles/shCore.css](http://alexgorbatchev.com/pub/sh/current/styles/shCore.css)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T16:07:02.360

粘贴前`<pre class="brush: js;">`

```
<style>
    .syntaxhighlighter table td.gutter .line {
        padding: 0 !important;
    }
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T16:43:10.020

无需引用不同的 CSS 文件。在引用 shCore.css 的链接标记*之后*粘贴以下样式块：

```
<style>
  .syntaxhighlighter table td.gutter .line {
    padding: 0 5px !important;
  }
  .syntaxhighlighter table td.code .line {
    padding: 0 !important;
  }
  .syntaxhighlighter .gutter {
    padding-right: 1em !important;
  }
  .syntaxhighlighter table {
    padding-bottom: 1px !important;
  }
</style> 
```

`.syntaxhighlighter table td.gutter .line`在每个行号周围添加 5 个像素的水平填充。

`.syntaxhighlighter table td.code .line`从代码行本身中删除所有填充。

`.syntaxhighlighter .gutter`在装订线和代码行之间添加 1 em 的填充。

`.syntaxhighlighter table`解决了我在 Chrome 中看到的溢出问题。对于水平溢出的代码块，Chrome 正在渲染一个可以滚动 1 个像素的垂直滚动条。在容器 div 内的表格中添加 1 个像素的填充来修复它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T19:01:52.223

我无法让这些解决方案中的任何一个起作用。但是，[这个问题](http://code.google.com/p/chromium/issues/detail?id=140868)的评论给了我解决方案......

打开模板编辑器（编辑 html），并搜索“13px”。变量定义附近有两个实例。我将字体大小更新为 12px，一切正常。

```
 <Variable name="body.font" description="Font" type="font"
     default="normal normal **12px** Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal **12px** Arial, Tahoma, Helvetica, FreeSans, sans-serif"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-09T09:24:54.207

blogger.com 和最新的 Firefox 也有同样的问题。
我发现这是因为 class 上的样式重叠而发生的`.container`，所以基本上你必须将 class 重命名为`.containerSH`SyntaxHighlighter 中的名称。
查看我的[提交：更改 .container -> .containerSH](https://github.com/dsatsura/syntaxhighlighter/commit/9e77c6f943b8b9d8c3ff17f41bb339efead4e84c)
现在它对我来说没问题。

# c++ - 没有它的 glTranslatef 等效

> ID：11804790
> 
> 赞同：0
> 
> 时间：2012-08-04T00:07:38.947
> 
> 标签：c++, opengl

好的，所以我正在玩游戏以从中检索数据并使用它。我得到了挂钩文本（通过 CallLists）。

游戏使用：

![在此处输入图像描述](../Images/cb448796aa399090d2506afc0a7c13ac.png)

```
glNewlist()
glBegin(GL_QUADS)
glVertex2i(....);    //Stored the location of each char in the bitmap above..
glTexCoords2f(....); //Not sure what this is..
glEnd()
glEndList()

glCallList(876);   //Represents a single character in the above bitmap.
glLoadIdentity();   //Resets the matrix.
glTexEnvi(GL_TEXTURE_ENV, GL_COMBINE, GL_REPLACE);
glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_RGB, GL_TEXTURE);
glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_RGB, GL_PREVIOUS);
glTranslatef(336, 196, 0);  //Places it on screen somehow! :S? This is what I need to know.
glColor4ub(0, 0, 0, 255);  //Colours the text.
LoadIdentity();            //Resets the matrix and does the next character.
glCallList(877);           //Next char. 
```

将文本渲染到屏幕上。有没有办法找出屏幕上文本的坐标？我可以通过 Detours 访问所有功能。

我不确定 glTranslate 做了什么。如何获取文本的 X 和 Y？

我用它来投影 glTranslate 的坐标，但它仍然投影错误。我将什么传递给我的 WorldVector？它只是一个带有 X、Y、Z 的结构。我已将 glTranslate 坐标传递给它，但这不起作用。

```
bool WorldToScreen(GLfloat &X, GLfloat &Y, Vector3D World, GLdouble* ModelViewMatrix, GLdouble* ProjectionMatrix)
{
    GLint ViewPort[4];
    GLdouble Screen[3];
    glGetIntegerv(GL_VIEWPORT, ViewPort);

    if(gluProject(World.X, World.Y, World.Z, ModelViewMatrix, ProjectionMatrix, ViewPort, &Screen[0], &Screen[1], &Screen[2]) == GL_TRUE)
    {
        X = Screen[0];
        Y = ViewPort[3] - Screen[1];
        return true;
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:39:50.220

这真的取决于，如果你在正交模式下绘制你的文本，无论你传递给 glTranslatef 的是实际的屏幕坐标，如果你处于透视模式，你将不得不通过转换管道来获取屏幕坐标，我相信执行此操作的函数将在名为 gluProject 的 GLU 库中，其中 gluUnProject 会将屏幕坐标带到世界空间

```
translate to world position 
translate to view position 
divide by W (Copy of Z) to get projection coordinates 
ScreenX = Px * ScreenWidth/2 + ScreenWidth/2 
ScreenY = -Py * ScreenWidth/2 + ScreenWidth/2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T05:07:28.243

这是一个以正字法翻译和调用列表的示例

```
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
glOrtho(0.0, SCREEN_WIDTH, SCREEN_HEIGHT, 0.0, -1.0, 1.0);

glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glTranslatef(336.0f, 196.0f, 0.0f);
glColor4f(1.0f, 0.0f, 0.0f, 1.0f); //Red
glCallList(877); //Or whatever list you wish to call 
```

此时，您可能希望获得下一个要写入的字符的宽度，并简单地转换值以将您的文本直接放在它的右侧，

顺便说一句，有一个很棒的免费使用库，叫做 FreeType 2 ，暴雪将它用于那里的游戏，以及我自己，前者给了它很好的可信度。

如果我仍然没有回答您的问题，请务必让我知道

# powershell - Powershell：将参数传递给存储在变量中的函数

> ID：11804792
> 
> 赞同：2
> 
> 时间：2012-08-04T00:08:07.323
> 
> 标签：powershell, powershell-jobs

我试图获得一个在工作中使用函数的简单工作示例。我已经设法将我的函数传递到用于我的工作的脚本块中，但我似乎无法获取函数的参数。

```
# concurrency
$Logx = 
{
    param(
    [parameter(ValueFromPipeline=$true)]
    $msg
    )    
    Write-Host ("OUT:"+$msg)
}

# Execution starts here
cls
$colors = @("red","blue","green")
$colors | %{
    $scriptBlock = 
    {   
        Invoke-Expression -Command $args[1]
        Start-Sleep 3        
    } 

    Write-Host "Processing: " $_
    Start-Job -scriptblock $scriptBlock -args $_, $Logx
}

Get-Job

while(Get-Job -State "Running")
{
    write-host "Running..."
    Start-Sleep 2
}

# Output
Get-Job | Receive-Job

# Cleanup jobs
Remove-Job * 
```

这是输出：

> ```
> Processing:  red 
> ```

```
Id              Name            State      HasMoreData     Location             Command  
--              ----            -----      -----------     --------             -------  
175             Job175          Running    True            localhost               ...   
Processing:  blue
177             Job177          Running    True            localhost               ...   
Processing:  green
179             Job179          Running    True            localhost               ...   
179             Job179          Running    True            localhost               ...   
177             Job177          Running    True            localhost               ...   
175             Job175          Running    True            localhost               ...   
Running...
Running...
OUT:
OUT:
OUT: 
```

因此，正如输出中的 OUT: x3 所证明的那样，我的函数被调用了，但我还没有找到任何允许我获取函数参数的语法。想法？

编辑：

请注意下面 Shawn 的观察和我的回复，我尝试使用函数作为变量，因为使用传统函数似乎不起作用。如果有办法让它工作，我会很高兴不必将我的函数作为变量传递。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T19:00:49.430

答案是使用Start-Job的initializationscript参数。如果您在一个块中定义所有函数并传递该块，它们将变为可用。

在这篇文章中找到了解决方案：

[如何开始我刚刚定义的函数的工作？](https://stackoverflow.com/questions/7162090/how-do-i-start-a-job-of-a-function-i-just-defined)

这是我以前的示例，现在可以使用：

```
# concurrency
$func = {
    function Logx 
    {
        param(
        [parameter(ValueFromPipeline=$true)]
        $msg
        )    
        Write-Host ("OUT:"+$msg)
    }
}

# Execution starts here
cls
$colors = @("red","blue","green")
$colors | %{
    $scriptBlock = 
    {   
        Logx $args[0]
        Start-Sleep 9        
    } 

    Write-Host "Processing: " $_
    Start-Job -InitializationScript $func -scriptblock $scriptBlock -args $_
}

Get-Job

while(Get-Job -State "Running")
{
    write-host "Running..."
    Start-Sleep 2
}

# Output
Get-Job | Receive-Job

# Cleanup jobs
Remove-Job * 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T12:21:22.620

走到这一步。必须用完，稍后再试。PS：在 args[1] 上传递了什么，我得到了很多红色，

```
 CategoryInfo          : InvalidData: (:) [Invoke-Expression], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.InvokeExpressionCommand 
```

这是我到目前为止所管理的。

```
# concurrency
$Logx =
{
    param(
    [parameter(ValueFromPipeline=$true)]
    $msg
    )    
    Write-Host ("OUT:"+$msg)
}

# Execution starts here
cls
$colors = @("red","blue","green")
$colors | %{
    & $scriptBlock = 
    {   Invoke-Expression -Command $args[1]
        Start-Sleep 3  
    } 

    Write-Host "Processing: " $_
    Start-Job -scriptblock $scriptBlock -ArgumentList @($_, $Logx)
}

# Get-Job

while(Get-Job -State "Running")
{
    write-host "Running..."
    Start-Sleep 2
}

# Output
Get-Job | Receive-Job

# Cleanup jobs
Remove-Job * 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T00:49:17.680

如果您不使用关键字`function`作为函数名称的前缀，PowerShell 不知道如何处理它。当您编写脚本时，它基本上是一个包含一些特殊文本的变量。正如您的输出所示，它仅执行它在该变量内容中识别的命令：`Write-Host "OUT:"`.

使用正确的语法将告诉 PowerShell 它是一个函数，并且您有需要执行的变量要传递给它：

```
 function Logx
{
    param(
    [parameter(ValueFromPipeline=$true)]
    $msg
    )    
    Write-Host ("OUT:"+$msg)
} 
```

然后，当您在脚本中调用它时，您只需使用`Logx`

# html - 完全使用 CSS3 绘制具有悬停效果的 L 形按钮

> ID：11804797
> 
> 赞同：2
> 
> 时间：2012-08-04T00:08:27.237
> 
> 标签：html, css, button, polygon

一直试图弄清楚如何仅使用 CSS3 创建 L 形按钮。我设法通过镜像一个矩形来创建形状来做到这一点，但我也试图在按钮上实现悬停效果。它仅适用于主矩形。

关于如何解决这个问题或者可能是执行这个问题的更有效方法的任何想法。

这是jsfiddle：

[http://jsfiddle.net/kryon17/kpRKA/](http://jsfiddle.net/kryon17/kpRKA/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T03:07:28.083

不确定这是否是您需要的，但我使用边框重新创建了它。让我知道这是否可以解决您的问题。

### HTML

```
<a href="http://www.google.com" class="rectangle rectangle1" target="_blank"></a>​ 
```

### CSS

```
a {
    margin:100px;
    display:block;
    width:50px;
    height:50px;
    border-bottom: 30px solid black;
    border-right: 30px solid black;

}

a:hover {
    border-color: #676767;
   -webkit-transition: all  0.25s ease-out;
    -moz-transition: all 0.25s ease-out;
    -ms-transition: all 0.25s ease-out;
    -o-transition: all 0.25s ease-out;
    transition: all 0.25s ease-out;
} 
```

[来源](http://jsfiddle.net/mnht2/)| [演示](http://jsfiddle.net/mnht2/show)

# iphone - iOS 3D室内导航应用

> ID：11804798
> 
> 赞同：0
> 
> 时间：2012-08-04T00:08:40.850
> 
> 标签：iphone, ios, opengl-es, 3d

创建室内 3D 导航应用程序需要哪些步骤。我有一些建筑物的自动 cad 文件，使用 3dmax 创建 3d 模型不会有问题。惯性传感器将用于定位，位得到模型后，如何将其集成到iOS中并创建可视化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:35:56.443

根据您的完整要求，我相信听起来您确实需要 openGL 编程才能创建该 3D 环境。对于导航，我建议使用 GPS 来指定您所在的位置，而不是惯性传感器。或者可能两者兼而有之，以减少您的错误。我猜您希望能够在没有 GPS 和 wifi 或 3G 信号的建筑物中定位自己。仅仅使用惯性传感器肯定容易出错。

# c# - 语音识别和用硬件做一些动作

> ID：11804800
> 
> 赞同：0
> 
> 时间：2012-08-04T00:09:08.780
> 
> 标签：c#, speech-recognition, robotics

我是一名优秀的程序员，但我是机器人技术的新手。我想做一个小项目，它可以识别我的演讲和我的灯开关。

请为我提供一些有关所有事物的参考库。

我需要什么样的硬件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T14:06:16.333

在你的评论中给出的例子是说“关灯”来关掉房间里的灯，这听起来更像是家庭自动化而不是机器人。[我会看看CodePlex 上名为 Mayhem](http://mayhem.codeplex.com/)的开源项目。该应用程序使用插件模块可以轻松地将事件与操作联系起来，由 Microsoft Labs 开发。模块易于开发，并且带有用于语音识别的事件模块开箱即用。您只需通过告诉应用程序您要查找的短语（例如“关灯”）来配置语音识别事件。Mayhem已经有[大量附加模块](http://makemayhem.com/Packages/All)，其中一个是 Insteon 设备的反应模块。这个[附加模块](http://makemayhem.com/Packages/Insteon.Mayhem)让您控制 INSTEON 品牌的照明和家庭自动化设备。还有一个[Phidg​​etsModule](http://makemayhem.com/Packages/PhidgetModules)允许您控制 Phidg​​ets，这是一组“即插即用”构建块，用于从您的 PC 进行低成本 USB 感应和控制。微软举办了一场比赛来鼓励开发人员创建新的附加模块，你可以[在这里看到一个](http://www.youtube.com/watch?v=drvwok9mYbM)名为[RemoteCommand](http://remotecommand.codeplex.com/)的模块的演示，它展示了如何通过电话使用语音识别来远程控制你的家。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:18:12.753

如果您不熟悉机器人技术，我强烈建议您查看 Arduino 设备。Arduino 设备是一个易于编程的电路板。您可以在[http://www.arduino.cc阅读更多内容](http://www.arduino.cc)

关于语音识别，您可以使用 Microsoft 语音识别软件，它允许您与您的应用程序进行通信。一个图书馆。在此处了解如何安装它：http: [//support.microsoft.com/kb/306537](http://support.microsoft.com/kb/306537)

# ruby - 使用命名空间创建节点

> ID：11804810
> 
> 赞同：0
> 
> 时间：2012-08-04T00:10:01.550
> 
> 标签：ruby, nokogiri

我正在使用 Nokogiri 构建一些 XML。我需要在声明相同命名空间的命名空间中创建一个节点。与 XML 一样，这个过程被证明是非常困难的。我需要看起来像的 XML

```
<?xml version="1.0"?>
<bar:foo xmlns:bar="http://www.bar.com">
  <bar:baz>baz</bar:baz>
</bar:foo> 
```

这（显然）没有给我：

```
builder=Nokogiri::XML::Builder.new do |xml|
  # Doesn't put foo in the bar namespace
  xml.foo( "xmlns:bar" => "http://www.bar.com") do
    xml['bar'].baz "baz"
  end
end 
```

这也不是：

```
builder=Nokogiri::XML::Builder.new do |xml|
  # undefined method `namespace_definitions' for #<Nokogiri::XML::Document:0x3fcc11b590ec name="document">
  xml['bar'].foo( "xmlns:bar" => "http://www.bar.com") do
    xml['bar'].baz "baz"
  end
end 
```

如何让 Nokogiri 给我我想要的 XML？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-04T00:25:32.830

哦，我们开始：[使用 Nokogiri 的 XML Builder 添加命名空间](https://stackoverflow.com/questions/8009842/adding-namespace-using-nokogiris-xml-builder)

显然，您要么在创建过程中无法做到这一点，要么太难以至于即使 SO 也无法弄清楚。但是您*可以*在创建后执行此操作：

```
builder=Nokogiri::XML::Builder.new do |xml|
  xml.foo( "xmlns:bar" => "http://www.bar.com") do
    xml['bar'].baz "baz"
  end
end
root=builder.doc.root
ns=root.namespace_definitions.first # because thankfully there's only one namespace here
root.namespace=tns 
```

不过，这很烦人。

# jquery - 在头部标签之间移动 JS

> ID：11804811
> 
> 赞同：2
> 
> 时间：2012-08-04T00:10:14.903
> 
> 标签：jquery, append, head

我正在使用这个网页设计应用程序，出于某种原因，它将 JS（如下所示）放在`<body>`标签之间，而不是放在头标签中。

那么有没有办法使用某种形式的 JS 将此代码放入 HEAD 标记中？

```
<script type="text/javascript">
  $(document).ready(function(){
    $('body').rollbar({zIndex:100});
  });
</script> 
```

这样做的原因是，我希望 jQuery 插件适用于“body”div，但如果它位于 BODY 标签中则不起作用 - 但它位于 HEAD 标签中时会起作用。如果无论如何动态地将代码从 body 标签移动到 HEAD 标签，那就太棒了。我一直想知道如何/现在是否有可能

期待回复！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:59:20.750

这段代码：

```
<script type="text/javascript">
  $(document).ready(function(){
    $('body').rollbar({zIndex:100});
  });
</script> 
```

只要在它之前加载了 jQuery，无论是在 HEAD 部分还是在 BODY 部分中，它的工作原理都是一样的。这是因为`$(document).ready`导致`$('body').rollbar({zIndex:100});`文档加载后才会执行，无论原始代码从哪里加载，这将是同一时间。

如果您在移动它时看到行为上的差异，那么其他原因导致了您尚未披露的差异，因为简单地将这段代码移动到 HEAD 部分不会导致差异（只要 jQuery 已经加载）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:15:19.450

不，至少不在页面上。无论是什么，您都将使用您的“网页设计应用程序”来解决这个问题。

Javascript 不能更改 DOM 中未解析的任何部分。脚本标签在解析后立即执行。因此，在脚本标签执行之前，您不能移动它。即使您确实移动了它，它也会已经运行，此时移动它不会产生任何实际影响。

大多数有经验的 Web 开发人员都会手工编写所有这些东西的代码，这样您就可以控制脚本标签的位置等事情。那么我是否可以建议这个“网页设计应用程序”可能没有考虑到您的最大利益？

# actionscript-3 - 嵌套函数？

> ID：11804812
> 
> 赞同：2
> 
> 时间：2012-08-04T00:10:21.020
> 
> 标签：actionscript-3

我没有设计许多在其中一个函数（例如一行）中只有少量差异的类，而是根据构造函数参数更改函数。像这样的东西：

```
public class SomeClass {
    public var toDo : Function;

    public SomeClass1( option: Boolean){
        if (option){
            function function1():void{
                // something here;
            }
            toDo = function1;

        } else{
            function function2():void{
                // something here;
            }
            toDo = function2;
        }
    }
} 
```

这是好习惯吗？或者，我可以将它分成一个基类和 2 个子类，但是当它们相差如此之小时，将它们作为具有 2 个不同功能的两个不同的类似乎是一种浪费。或者我可以在函数中存储选项和 if 语句，但是每次运行函数时我都必须检查它，因为它每次都相同。最好的办法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T21:15:03.117

你的方法本质上没有任何问题——这是一种完全有效的方法——只要你准确地理解你在做什么，以及一些警告是什么。

# 重复的功能

使用这种方法时，我最大的担忧之一是每次新建此类的实例时，都会创建一个新函数。制作 1000 个实例，你就有 1000 个函数浮动。作为方法，只有一个引用实例在稳定的上下文中执行。

解决此问题的一种可能方法是在构造函数之外使用静态函数定义：

```
public class SomeClass {
    public var toDo:Function; 

    private static var doIt1:Function = function():void { };
    private static var doIt2:Function = function():void { };

    public function SomeClass(options:Boolean) {
        this.toDo = (option) ? doIt1 : doIt2;
    }
} 
```

或者，您可以使用对实例方法的引用而不是函数：

```
public class SomeClass {
    public var toDo:Function; 

    private function doIt1():void { };
    private function doIt2():void { };

    public function SomeClass(options:Boolean) {
        this.toDo = (option) ? doIt1 : doIt2;
    }
} 
```

请参阅下一节以更好地区分这两种方法。

不管怎样，这只会分配一个函数，不管你有多少这个类的实例。

# 绑定与未绑定函数

*在 ActionScript 中，方法*和*函数*之间存在细微差别。虽然相似，但它们的工作方式并不完全相同。[绑定方法](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7f30.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7fa5)是从实例中提取的方法。在执行这些方法时，`this`将始终指向它们来自的实例。

考虑以下代码：

```
public class SomeClass {

    private var number:Number;

    public function SomeClass(val:Number):void {
        number = val;
    }

    public var doIt:Function;

    public var getNumberUnbound:Function = function():Number {
        return this.number;
    }

    public function getNumberBound():Number {
        return this.number;
    }
} 
```

非常简单的示例，构造函数接受一个`Number`，然后有一个返回该值的方法和一个也返回该值的函数，然后调用`doIt`一个当前未分配的公共函数。所以首先让我们考虑一下：

```
var instance1:SomeClass = new SomeClass(1);
instance1.getNumberBound(); // 1
instance1.getNumberUnbound(); // 1 
```

`1`正如我们对这两个调用所期望的那样，这将返回。但是现在，让我们尝试变得棘手并玩弄`.call()`- 或`.apply()`.

```
var instance1:SomeClass = new SomeClass(1);
var instance2:SomeClass = new SomeClass(2);
instance1.getNumberBound.call(instance2); // 1
instance1.getNumberUnbound.call(instance2); // 2 
```

注意这次我们得到了不同的结果。绑定调用仍然返回`1`，因为它仍然*粘*在`instance1`，当未绑定调用返回时`2`，它会在它认为应该在的任何上下文中执行。事实上，考虑一下：

```
instance1.getNumberBound.call(null); // 1;
instance1.getNumberUnbound.call(null); // ERROR! 
```

在这种情况下，again`getNumberBound`仍然在 的上下文中执行`instance1`，但是未绑定的函数失败了，因为`this`现在等于`null`，并且`null.number`显然没有任何意义。

现在让我们变得更奇怪：

```
var instance1:SomeClass = new SomeClass(1);
var instance2:SomeClass = new SomeClass(2);

instance2.doIt = instance1.getNumberBound;
instance2.doIt(); // 1

instance2.doIt = instance1.getNumberUnbound
instance2.doIt(); // 2 
```

在这里您可以看到，无论您尝试做什么来脱离`getNumberBound`，`instance1`您都做不到。即使我们将一个方法的引用塞进了`instance2`，它仍然在 . 的范围内执行`instance1`。

所以这就是我的意思，当我说`this`可能不是你所期望的那样。取决于它是绑定还是未绑定，或者调用者是否使用`.call()`or显式更改它`.apply()`，`this`可能与您预期的完全不同。

# 我的本能

我会使用 occam 的剃须刀，它对我来说是存储选项并在名为`toDo`. 即使您大量调用此函数，单个条件语句的成本也可以忽略不计，我会等待分析器告诉我在尝试找出解决任何性能问题的更好方法之前花费了太长时间。奇怪的是，您的性能问题将在其他地方。

也就是说，当它有意义时，我确实使用了这种模式。事实上，您可以将您的工作人员注入您的实例，并一起避免这种情况。

```
public class SomeClass {
    public var toDo:Function; 

    public SomeClass(doIt:Function) {
        toDo = doIt;
    }
} 
```

了解 ActionScript 中的函数式编程概念可能是一件非常强大的事情，一旦您掌握了窍门。我不会避免它，但我会小心使用它。与大多数强大的东西一样，如果使用不当，可能会非常危险。

继承可能有用，但尽量不要陷入“继承是解决一切的办法”。继承应该只真正尝试建模“是”关系，. 组合可能在结构上更好，但也可以为功能方法提出论据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T20:09:31.367

在考虑代码时，我会问两个问题：

*   阅读起来有多容易？
*   扩展有多容易？

我发现我通常依靠类继承。我发现调试起来很简单，而且（大部分）扩展起来也很简单。如果存在将标志（如`willProcessConfirmKey`）更改为方法或单独的子结构的问题，那么它很简单（即使需要大量测试）。将许多类折叠回一个较小的类组也很简单。

根据您的评论，我认为它可能会设置如下：

```
import flash.display.Sprite;
import flash.events.KeyboardEvent;

public class Menu extends Sprite
{
    protected var keys:Array;
    protected var _willProcessConfirmKey:Boolean;

    public function Menu(willProcessConfirmKey:Boolean)
    {
        super();

        this.willProcessConfirmKey = willProcessConfirmKey;

        addEventListener(KeyboardEvent.KEY_DOWN, keyHnd, false, 0, true);
    }

    private function keyHnd(e:KeyboardEvent):void
    {
        storeKeys();
        processKeys();
    }

    private function storeKeys():void
    {
        // store keys in some fashion here
    }

    protected function processKeys():void
    {
        // this function is provided for overriding.
    }

    public function get willProcessConfirmKey():Boolean 
    {
        return _willProcessConfirmKey;
    }

    public function set willProcessConfirmKey(value:Boolean):void 
    {
        _willProcessConfirmKey = value;
    }
}

public class Menu1Level extends Menu
{
    public function Menu1Level(willProcessConfirmKey:Boolean)
    {
        super(willProcessConfirmKey);
    }

    override protected function processKeys():void
    {
        super.processKeys();

        // handle movement and selection of items here.
        if (willProcessConfirmKey) {
            // process confirms
        } else {
            // skip processing confirms.
        }
    }
}

public class Menu2Level extends Menu
{
    public function Menu2Level(willProcessConfirmKey:Boolean)
    {
        super(willProcessConfirmKey);
    }

    override protected function processKeys():void
    {
        super.processKeys();

        // handle movement and selection of items here.
        if (willProcessConfirmKey) {
            // process confirms
        } else {
            // skip processing confirms.
        }
    }
} 
```

并像这样使用它：

```
public var menu1Level_NoConfirm:Menu1Level = new Menu1Level(false);
public var menu2Level_Confirm:Menu2Level = new Menu2Level(true); 
```

如果您发现将`willProcessConfirmKey`标志作为单独的类会更好，那么您可以扩展`Menu1Level`and `Menu2Level`，并重新编码`Menu`以适应。

说了这么多，我最初会考虑找到一个免费的菜单系统，甚至付费。它们是正确编程的主要痛苦。由于 Actionscript 与 Javascript 密切相关，您可能会发现可以将 JS 菜单系统直接移植到 AS3 中。

## 编辑

（更正了声明示例中的一个错误。）

# django - 如何强制 Django 进程在视图导入错误时崩溃？

> ID：11804817
> 
> 赞同：0
> 
> 时间：2012-08-04T00:11:29.463
> 
> 标签：django, importerror

我在生产中遇到了一个问题，其中一个 apache Django 进程由于加载相关视图模块时发生异常而吐出 ViewDoesNotExist 错误。异常是由于在导入链深处发生的难以置信的不可能事件。

发生错误时，此进程只是继续提供 ViewDoesNotExist 错误，因为视图无法导入。

我宁愿处理不可预见的未来错误是让进程在导入错误时崩溃。如果进程重新启动，最多只有一个请求会引发此错误。

有没有办法改变这种行为？（不修改django源）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T03:41:19.737

我不相信。Django 本身被设计成一个带有测试服务器的框架（作为一个服务器，它不应该崩溃，除非在极端情况下）。根据 OP，问题出在 Django 引导程序中的竞争条件。我在[这里找到了答案（由其他人解决）](https://code.djangoproject.com/ticket/18251)

# php - PHP foreach循环不增加

> ID：11804818
> 
> 赞同：2
> 
> 时间：2012-08-04T00:11:35.407
> 
> 标签：php

如果这是一个微不足道的问题，我深表歉意。我进行了搜索，但没有找到我的问题的答案，所以我发布了。预先感谢任何可以帮助我的人，并感谢您抽出宝贵的时间。我正在尝试对 api (sanfrancisco.crimespotting.org) 返回的犯罪数据进行简单解析并遇到障碍。下面的代码非常简单。

```
<? 
$url = "http://sanfrancisco.crimespotting.org/crime-data?format=xml&count=5&dstart=2009-04-20";

$reports = new SimpleXMLElement($url, NULL, TRUE);

foreach ($reports-> report as $key => $value)
            {
            echo '<br />';
            echo '<b>Case #:</b> '.$reports -> report['case_number'];
            echo '<br />';
            echo '<b>Crime type</b> '.$reports -> report['crime_type'];
            echo '<br />';
            echo '<b>Date/Time:</b> '.$reports -> report['date_time'];
            echo '<br />';
            echo '<b>Date </b> '.$reports -> report['date'];
            echo '<br />';
            echo '<b>Time:</b> '.$reports -> report['time'];
            echo '<br />';
            echo '<b>More Info </b> '.$reports -> report['href'];
            echo '<br />';
            echo '<br />';
            echo '<br />';
            }
?> 
```

api 返回 5 个报告，因为当我在浏览器中测试 url 时，我看到返回了 5 个报告标签。这是我的浏览器的输出。

```
 <reports>
            <report case_number="120220205" crime_type="Vehicle Theft" date_time="2012-07-17T23:10:00-07:00" date="Tuesday, Jul 17, 2012" time="11:10pm" lat="37.772441" lon="-122.412422" beat="" href="http://sanfrancisco.crimespotting.org/crime/2012-07-17/Vehicle_Theft/320858">STOLEN AUTOMOBILE</report>
            <report case_number="120560807" crime_type="Alcohol" date_time="2012-07-16T13:35:00-07:00" date="Monday, Jul 16, 2012" time="1:35pm" lat="37.783288" lon="-122.408954" beat="" href="http://sanfrancisco.crimespotting.org/crime/2012-07-16/Alcohol/334582">
            UNDER INFLUENCE OF ALCOHOL IN A PUBLIC PLACE (ARREST, BOOKED)
            </report>
            <report case_number="120559850" crime_type="Disturbing the Peace" date_time="2012-07-16T13:00:00-07:00" date="Monday, Jul 16, 2012" time="1:00pm" lat="37.778678" lon="-122.416545" beat="" href="http://sanfrancisco.crimespotting.org/crime/2012-07-16/Disturbing_The_Peace/334575">COMMITTING PUBLIC NUISANCE (ARREST, CITED)</report>
            <report case_number="120560653" crime_type="Theft" date_time="2012-07-16T12:35:00-07:00" date="Monday, Jul 16, 2012" time="12:35pm" lat="37.784644" lon="-122.414271" beat="" href="http://sanfrancisco.crimespotting.org/crime/2012-07-16/Theft/334580">PETTY THEFT SHOPLIFTING</report>
            <report case_number="120560700" crime_type="Theft" date_time="2012-07-16T12:00:00-07:00" date="Monday, Jul 16, 2012" time="12:00pm" lat="37.78966" lon="-122.400934" beat="" href="http://sanfrancisco.crimespotting.org/crime/2012-07-16/Theft/334581">GRAND THEFT BICYCLE</report>
            </reports> 
```

如您所见（上图），每个报告标签都有不同的 case_number 属性（例如 120220205、120560807 等）。但是，当我加载页面时，这是我收到的输出。

```
 Case #: 120220205
            Crime type Vehicle Theft
            Date/Time: 2012-07-17T23:10:00-07:00
            Date Tuesday, Jul 17, 2012
            Time: 11:10pm
            More Info http://sanfrancisco.crimespotting.org/crime/2012-07-17/Vehicle_Theft/320858

            Case #: 120220205
            Crime type Vehicle Theft
            Date/Time: 2012-07-17T23:10:00-07:00
            Date Tuesday, Jul 17, 2012
            Time: 11:10pm
            More Info http://sanfrancisco.crimespotting.org/crime/2012-07-17/Vehicle_Theft/320858

            Case #: 120220205
            Crime type Vehicle Theft
            Date/Time: 2012-07-17T23:10:00-07:00
            Date Tuesday, Jul 17, 2012
            Time: 11:10pm
            More Info http://sanfrancisco.crimespotting.org/crime/2012-07-17/Vehicle_Theft/320858

            Case #: 120220205
            Crime type Vehicle Theft
            Date/Time: 2012-07-17T23:10:00-07:00
            Date Tuesday, Jul 17, 2012
            Time: 11:10pm
            More Info http://sanfrancisco.crimespotting.org/crime/2012-07-17/Vehicle_Theft/320858

            Case #: 120220205
            Crime type Vehicle Theft
            Date/Time: 2012-07-17T23:10:00-07:00
            Date Tuesday, Jul 17, 2012
            Time: 11:10pm
            More Info http://sanfrancisco.crimespotting.org/crime/2012-07-17/Vehicle_Theft/320858 
```

由于我使用 foreach 循环遍历返回的结果，我不知道为什么第一种情况会重复 5 次，因为我知道 foreach 循环应该自动递增。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T00:17:44.850

`$reports -> report`只需在循环中替换`$value`即可使其工作。

在没有多个相同标签的情况下，它似乎`SimpleXMLElement`允许`$reports->report`用作可枚举对象和简单对象以进行简化。

这很可能是您没有收到错误的原因！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-04T00:17:55.900

您没有在 foreach 循环中使用增量数据。你想做这样的事情：

```
foreach ($reports->report as $report)
{
    echo '<br />';
    echo '<b>Case #:</b> ' . $report['case_number'];
    // ...
} 
```

在您的代码中，您正在迭代`$reports->report`,`$key => $value`而不是使用迭代值（`$key`和`$value`），而是调用`$reports->report`，这不会随着循环的迭代而改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T00:34:54.630

我要感谢所有这么快就提供帮助的人。在查看了更多 PHP 文档（特别是[http://tinyurl.com/36a4aet](http://tinyurl.com/36a4aet)）之后，我发现我需要在 $reports （作为它的根标记）上使用 children() 方法来获取每个报告，然后为每个报告标签调用 attributes() 方法来获取报告的其余数据。下面的新代码似乎已经成功了:)。

```
 foreach ($reports->children() as $node)
            {
                    $attribs = $node->attributes();
                    echo '<br />';
                    echo '<b>Case #:</b> '.$attribs["case_number"];
                    echo '<br />';
                    echo '<b>Crime type:</b> '.$attribs["crime_type"];
                    echo '<br />';
                    echo '<b>Date/Time:</b> '.$attribs["date_time"];
                    echo '<br />';
                    echo '<b>Date </b>: '.$attribs["date"];
                    echo '<br />';
                    echo '<b>Time:</b> '.$attribs["time"];
                    echo '<br />';
                    echo '<b>More Info: </b> <a href='.$attribs["href"].'>'.$attribs["href"].'</a>';
                    echo '<br />';
                    echo '<br />';
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-04T00:20:29.943

您在循环中既没有提到 $key 也没有提到 $value ！您总是指的是 $reports->report['case_number']，它总是相同的。

**编辑**：我忘了提到你应该迭代 $reports。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-04T00:17:31.723

您的 foreach 语法错误。尝试将`$reports -> report`foreach 块内部替换为`$value`

# video - 如何在 GitHub wiki 页面上嵌入 YouTube 视频？

> ID：11804820
> 
> 赞同：404
> 
> 时间：2012-08-04T00:12:03.830
> 
> 标签：video, github, youtube, embed, markdown

我对标记相当陌生（尽管它非常容易上手）。我正在开发一个包，并试图让 wiki 页面看起来不错，作为帮助手册。我可以很容易地将 YouTube 视频链接插入 wiki 页面，但如何嵌入 YouTube 视频。我知道这可能是不可能的。

我已阅读您可以使用 HTML 标记，因此我尝试按此[链接](http://htmlpurifier.org/docs/enduser-youtube.html)嵌入 HTML ，如下所示：

```
<object width="425" height="350">
  <param name="movie" value="http://www.youtube.com/user/wwwLoveWatercom?v=BTRN1YETpyg" />
  <param name="wmode" value="transparent" />
  <embed src="http://www.youtube.com/user/wwwLoveWatercom?v=BTRN1YETpyg"
         type="application/x-shockwave-flash"
         wmode="transparent" width="425" height="350" />
</object> 
```

并保存了页面，但什么也没发生。

1.  是否可以在 GitHub wiki 页面上嵌入 YouTube 视频？
2.  如果有怎么办？

* * *

## 回答 #1

> 赞同：636
> 
> 时间：2013-04-18T09:35:49.373

无法直接嵌入视频，但您可以放置​​一个链接到 YouTube 视频的图片：

```
[![IMAGE ALT TEXT HERE](https://img.youtube.com/vi/YOUTUBE_VIDEO_ID_HERE/0.jpg)](https://www.youtube.com/watch?v=YOUTUBE_VIDEO_ID_HERE) 
```

*   有关 Markdown 的更多信息，请查看GitHub 上的[Markdown 备忘单。](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#youtube-videos)
*   有关 Youtube 图片链接的更多信息，[请查看此问题](https://stackoverflow.com/questions/2068344/how-do-i-get-a-youtube-video-thumbnail-from-the-youtube-api)。

* * *

## 回答 #2

> 赞同：360
> 
> 时间：2015-04-25T08:10:59.353

# 完整示例

> 扩展*@MGA*的答案

虽然无法在 Markdown 中*嵌入*视频，但您可以通过在标记文件中包含有效的链接图像来“伪造”它，使用以下格式：

`[![IMAGE ALT TEXT](http://img.youtube.com/vi/YOUTUBE_VIDEO_ID_HERE/0.jpg)](http://www.youtube.com/watch?v=YOUTUBE_VIDEO_ID_HERE "Video Title")`

## 降价的解释

如果此标记片段看起来很复杂，请将其分为两部分：

`![image alt text](https://example.com/link-to-image)`
包含在链接中的图像
`[link text](https://example.com/my-link "link title")`

## 使用有效 Markdown 和 YouTube 缩略图的示例：

[![一切都很棒](../Images/11cc2893bed490ab5f07c49c1ae888b5.png)](https://www.youtube.com/watch?v=StTqXEQ2l-Y "一切都很棒")

我们直接从 YouTube 获取缩略图图像并链接到实际视频，因此当人们单击图像/缩略图时，他们将被带到视频中。

## 代码：

`[![Everything Is AWESOME](https://img.youtube.com/vi/StTqXEQ2l-Y/0.jpg)](https://www.youtube.com/watch?v=StTqXEQ2l-Y "Everything Is AWESOME")`

***或者***，如果您想给读者一个视觉提示，即图像/缩略图实际上是一个*可播放*的视频，请在 YouTube 中拍摄您自己的视频屏幕截图并将其用作缩略图。

## 使用带有视频控件的屏幕截图作为视觉提示的示例：

[![一切都很棒](../Images/1fec2a79e50385de7966884cab7201ef.png)](https://youtu.be/StTqXEQ2l-Y?t=35s "一切都很棒")

## 代码：

`[![Everything Is AWESOME](http://i.imgur.com/Ot5DWAW.png)](https://youtu.be/StTqXEQ2l-Y?t=35s "Everything Is AWESOME")`

##  ***明显*优势**

虽然这需要几个额外的步骤（**a**）*拍摄*视频的屏幕截图和（**b**）*上传它*以便您可以将图像用作缩略图，但它确实具有**3 个*明显*的优势**：

1.  阅读您的降价（或生成的 html 页面）的人有一个**视觉提示**，告诉他们他们可以观看视频（*视频控件鼓励点击*）
2.  您可以选择视频中的**特定帧**用作缩略图（从而使您的内容**更具吸引力**）
3.  您可以**链接到视频中的特定时间**，单击链接图像时将从该时间开始播放。（在我们的例子中，从 35 秒开始）

截取和上传屏幕截图需要几秒钟，但有很大的回报。

# 无处不在！

由于这是标准降价，它适用于任何地方。在 GitHub、Reddit、Ghost 和 Stack Overflow 上试用。

# 维密欧

这种方法也适用于 Vimeo 视频

## 例子

[![小红帽](../Images/27f796b65067f0398c77c84d05ec7464.png)](https://vimeo.com/3514904 "小红帽 - 点击观看！")

## 代码

```
[![Little red riding hood](http://i.imgur.com/7YTMFQp.png)](https://vimeo.com/3514904 "Little red riding hood - Click to Watch!") 
```

# 笔记：

*   如何截图：[http](http://www.take-a-screenshot.org/) ://www.take-a-screenshot.org/ （所有平台）
*   上传缩略图：截取屏幕截图后，您可以将其拖放到[imgur.com](https://imgur.com/Ot5DWAW)进行上传并立即将其用作缩略图
*   YouTube 缩略图信息：[如何从 YouTube API 获取 YouTube 视频缩略图？](https://stackoverflow.com/questions/2068344/how-do-i-get-a-youtube-video-thumbnail-from-the-youtube-api)

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2019-01-16T01:11:50.500

Markdown 不*正式*支持视频嵌入，但您可以在其中嵌入原始 HTML。我使用**GitHub Pages**进行了测试，它完美无缺。

1.  转到 YouTube 上的视频页面，然后单击分享按钮
2.  选择嵌入
3.  将 HTML 片段复制并粘贴到您的降价中

该片段看起来像：

```
 <iframe width="560" height="315"
src="https://www.youtube.com/embed/MUQfKFzIOeU" 
frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe> 
```

PS：你可以[在这里查看实时预览](https://daksh.github.io/Learning-Git-and-GitHub/)

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2020-04-27T23:55:42.620

我创建了[https://yt-embed.herokuapp.com/](https://yt-embed.herokuapp.com/)来简化这一点。从上面的示例中可以直接使用：

```
[![Everything Is AWESOME](https://yt-embed.herokuapp.com/embed?v=StTqXEQ2l-Y)](https://www.youtube.com/watch?v=StTqXEQ2l-Y "Everything Is AWESOME") 
```

将导致：![yt-embed 的使用示例](../Images/a4af4f6213c9f8dfe0528bea9126f6d2.png)

只需调用：[https://yt-embed.herokuapp.com/embed?v=[video_id]](https://yt-embed.herokuapp.com/embed?v=[video_id])作为图像而不是[https://img.youtube.com/vi/](https://img.youtube.com/vi/)。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-10-30T16:57:31.830

如果你喜欢 HTML 标签而不是 markdown + 居中对齐：

```
<div align="center">
  <a href="https://www.youtube.com/watch?v=YOUTUBE_VIDEO_ID_HERE"><img src="https://img.youtube.com/vi/YOUTUBE_VIDEO_ID_HERE/0.jpg" alt="IMAGE ALT TEXT"></a>
</div>
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-02-12T10:30:14.780

将视频与缩略图和链接居中对齐：

```
<div align="center">
      <a href="https://www.youtube.com/watch?v=StTqXEQ2l-Y">
     <img 
      src="https://img.youtube.com/vi/StTqXEQ2l-Y/0.jpg" 
      alt="Everything Is AWESOME" 
      style="width:100%;">
      </a>
    </div> 
```

**结果：**

[![在此处输入图像描述](../Images/f7361b6f36eee1ab6b6ccd50b3ba333e.png)](https://i.stack.imgur.com/iEj3w.png)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-07-19T13:34:11.157

添加带有缩略图的链接（最初由 YouTube 使用）是一种可行的解决方案。YouTube 使用的缩略图可通过以下方式访问：

*   如果官方视频链接是：`https://www.youtube.com/watch?v=5yLzZikS15k`
*   那么缩略图是：`https://img.youtube.com/vi/5yLzZikS15k/0.jpg`

按照这个逻辑，下面的代码会产生完美的结果：

```
<div align="left">
      <a href="https://www.youtube.com/watch?v=5yLzZikS15k">
         <img src="https://img.youtube.com/vi/5yLzZikS15k/0.jpg" style="width:100%;">
      </a>
</div>
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2021-12-06T18:19:26.437

我编写了一个 Chrome 浏览器扩展程序[xhub](https://github.com/nschloe/xhub)，它允许您在 GitHub 页面中嵌入 YouTube 视频（以及其他内容）。

[在这里](https://chrome.google.com/webstore/detail/xhub/anidddebgkllnnnnjfkmjcaallemhjee)得到它。然后添加这样的东西

```
A video:
```youtube-embed
{
   "width": "560",
   "height": "315",
   "src": "https://www.youtube.com/embed/dQw4w9WgXcQ",
   "title": "YouTube video player",
   "frameborder": "0",
   "allow": "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",
   "allowfullscreen": true
}
``` 
```

到您的降价代码。它给你

[![在此处输入图像描述](../Images/759ea4c1233b31ac914511a761177af2.png)](https://i.stack.imgur.com/IK0mk.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-07-08T04:59:05.870

就我而言，作为一个技巧，我通过使用在线转换器将我的屏幕录制视频转换为 gif 遇到了这个问题，然后我将它添加到我的降价中，如下所示：

```
## Quick Overview of the project

![Functional Programming with Javascript using NASA API](./functionJsWithNasaAPI.gif) 
```

结果如下图所示

检查[此 repo](https://github.com/DinaTaklit/Mars-Dashbord-functional-programming-Intermediate-JavaScript-Nanodegree-Program)以获取上述示例的实时预览。希望这个技巧可以帮助某人:)。

[![使用 gif 而不是在降价中使用不受支持的视频的示例](../Images/75fbd8797f682407b01752639fb23b59.png)](https://i.stack.imgur.com/RrczT.gif)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-25T05:42:22.707

如果您尝试在 GitHub 页面上嵌入视频，您只需转到 youtube 视频，点击分享，复制嵌入代码（应该如下所示）

```
<iframe width="560" height="315" src="https://www.youtube.com/embed/Z7PExj_v-ZU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> 
```

并将其粘贴到您的降价页面。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-02T09:25:25.107

实际上不仅是 youtube，使用一个小技巧，您可以上传任何视频，甚至可以直接从您的计算机上传。要做到这一点，

*   您可以创建一个**问题**，只需将视频文件拖入其中
*   我总是喜欢**缩略图**，为此，从视频中**截取**一张图片并像上一步一样拖动它
*   你现在有两个`urls`来自视频和图像
*   使用网址：`[![img_tag](https://image-url.png)](https://video-url.mp4)`
*   例如，

> [![IM1](../Images/236ac29b3fb80f76045b2125856c949b.png)](https://user-images.githubusercontent.com/12484581/131813771-c47bc071-f607-4f80-ade9-7d2f123e3212.mp4)

*   只需立即关闭**问题**（如果您愿意）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-18T01:08:38.177

将我的 YouTube 视频 ID 替换为您的 YouTube 视频 ID

```
<a href="https://youtu.be/5xwHkLPgvtQ" title="Music Caster Video Demo">
  <p align="center">
    <img width="75%" src="https://img.youtube.com/vi/5xwHkLPgvtQ/maxresdefault.jpg" alt="Music Caster Video Demo Thumbnail"/>
  </p>
</a> 
```

```
html {
  background: #2D2D2D;
}
```

```
<a href="https://youtu.be/5xwHkLPgvtQ" title="Music Caster Video Demo">
  <p align="center">
    <img width="75%" src="https://img.youtube.com/vi/5xwHkLPgvtQ/maxresdefault.jpg" alt="Music Caster Video Demo Thumbnail"/>
  </p>
</a>
```

[现实世界的例子](https://github.com/elibroftw/music-caster/blob/master/README.md#demo)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2021-03-14T11:01:04.797

您可以尝试以下方法：

```
<iframe width="500" height="300" src="https://www.youtube.com/embed/<VIDEO_ID>" frameborder="0" allowfullscreen></iframe> 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2021-12-30T11:55:26.487

现在（2021 年），您可以轻松地在 gitHub markdown 上使用视频。您只需在 Markdown 上粘贴纯视频 url，它将转换为视频。

```
 To have a video on your markdown, just add the video url, some like this:

https://www.youtube.com/watch?v=G3Cytlicv8Y 
```

您可以在[此视频](https://www.youtube.com/watch?v=G3Cytlicv8Y)中看到有关此新功能的信息。

# python - 如何通过提前检测边界情况来减少递归时间

> ID：11804822
> 
> 赞同：1
> 
> 时间：2012-08-04T00:12:16.517
> 
> 标签：python, algorithm

例如，教科书中的代码——使用递归解决斐波那契问题——是这样的：

```
cache = {}

def fibo(n):
    if n in cache :
        return cache[n]
    elif n <=2:
        cache[n] = 1
    else:
        cache[n] = fibo(n-1) + fibo(n-2)
    return cache[n] 
```

但是，我担心每次进行函数调用时都需要成本。为什么教科书不使用这段代码，以避免不必要的函数调用：

```
cache = {}

def fibo(n):
    if n <=2:
        cache[n] = 1
    else:
        # to avoid unnecessary function call
        if n-1 in cache:
            f1 = cache[n-1]
        else:
            f1 = fibo(n-1)
        if n-2 in cache:
            f2 = cache[n-2]
        else:
            f2 = fibo(n-2)

        cache[n] = f1 + f2

    return cache[n] 
```

这样，我们可以在实际调用之前避免不必要的函数调用。

无论如何，我的问题是，为什么教科书的作者不使用第二种方式编写代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T00:19:16.610

您所描述的是[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)。您正在使用一个数组来存储递归的步骤，ala [memoization](http://en.wikipedia.org/wiki/Memoization)。对于像斐波那契这样的东西，每次迭代有不止一个递归调用，动态编程确实是首选技术。

至于为什么教科书向您展示了它所做的代码，很可能是因为作者只想演示递归，而不是一次涉及太多概念。

# mysql - 在mysql中创建一个表作为另一个表

> ID：11804832
> 
> 赞同：3
> 
> 时间：2012-08-04T00:14:42.960
> 
> 标签：mysql

我正在尝试创建一个表（即 test1）作为另一个表（test2）。test2 有所有记录。有一些重复的记录，如下所示：

![在此处输入图像描述](../Images/6397cea6f78c3450f1e1316a81aed642.png)

现在我想在表 test1 中记录表 test2 的所有记录，如下所示（使用 create 命令）：

![在此处输入图像描述](../Images/1b793b5bb38e7176688f5b16d3dc812d.png)

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T00:19:05.340

使用 MySQL，您可能可以这样尝试：

```
INSERT INTO test1(id, name, address, mobile, genere) 
   SELECT id, name, address, mobile, genere 
   FROM test2 
   GROUP BY name, address, mobile, genere 
```

或者如果你想要一个`CREATE`语法试试

```
CREATE TABLE test1 AS  
   (SELECT id, name, address, mobile, genere 
   FROM test2 
   GROUP BY name, address, mobile, genere) 
```

# c# - 使用 LINQ 插入/选择 - 绕过查询中的实体构造

> ID：11804833
> 
> 赞同：4
> 
> 时间：2012-08-04T00:15:11.797
> 
> 标签：c#, sql, linq, select

我已经阅读了几个关于“不允许在查询中显式构造实体类型”错误的问题，以及解决它的各种方法。

*   [不允许在查询中显式构造实体类型“###”。](https://stackoverflow.com/questions/787296/explicit-construction-of-entity-type-in-query-is-not-allowed)
*   [不允许在查询中显式构造实体类型 [MyClass]](https://stackoverflow.com/questions/2952856/explicit-construction-of-entity-type-myclass-in-query-is-not-allowed)
*   [不允许在查询中显式构造实体类型“”](https://stackoverflow.com/questions/7352092/explicit-construction-of-entity-type-in-query-is-not-allowed-web-service-cal)

我在我的代码中使用 DBML 自动生成的 LINQ to SQL 类，因此能够适当地选择和插入数据会很棒。这是另一篇文章中建议的一种方法；在下面的示例中，e_activeSession 是 DataContext 中表的自动生成表示：

```
var statistics =
    from record in startTimes
    group record by record.startTime into g
    select new e_activeSession
            {
                workerId = wcopy,
                startTime = g.Key.GetValueOrDefault(),
                totalTasks = g.Count(),
                totalTime = g.Max(o => o.record.timeInSession).GetValueOrDefault(),
                minDwell = g.Min(o => o.record.dwellTime).GetValueOrDefault(),
                maxDwell = g.Max(o => o.record.dwellTime).GetValueOrDefault(),
                avgDwell = g.Average(o => o.record.dwellTime).GetValueOrDefault(),
                stdevDwell = g.Select(o => Convert.ToDouble(o.record.dwellTime)).StdDev(),
                total80 = g.Sum(o => Convert.ToInt16(o.record.correct80) + Convert.ToInt16(o.record.wrong80)),
                correct80 = g.Sum(o => Convert.ToInt16(o.record.correct80)),
                percent80 = Convert.ToDouble(g.Sum(o => Convert.ToInt16(o.record.correct80))) /
                            g.Sum(o => Convert.ToInt16(o.record.correct80) + Convert.ToInt16(o.record.wrong80))
            }; 
```

上面抛出了错误，所以我尝试了以下方法：

```
var groups =
    from record in startTimes
    group record by record.startTime
    into g
    select g;

var statistics = groups.ToList().Select(
    g => new e_activeSession
             {
                 workerId = wcopy,
                 startTime = g.Key.GetValueOrDefault(),
                 totalTasks = g.Count(),
                 totalTime = g.Max(o => o.record.timeInSession).GetValueOrDefault(),
                 minDwell = g.Min(o => o.record.dwellTime).GetValueOrDefault(),
                 maxDwell = g.Max(o => o.record.dwellTime).GetValueOrDefault(),
                 avgDwell = g.Average(o => o.record.dwellTime).GetValueOrDefault(),
                 stdevDwell = g.Select(o => Convert.ToDouble(o.record.dwellTime)).StdDev(),
                 total80 = g.Sum(o => Convert.ToInt16(o.record.correct80) + Convert.ToInt16(o.record.wrong80)),
                 correct80 = g.Sum(o => Convert.ToInt16(o.record.correct80)),
                 percent80 = Convert.ToDouble(g.Sum(o => Convert.ToInt16(o.record.correct80))) /
                             g.Sum(o => Convert.ToInt16(o.record.correct80) + Convert.ToInt16(o.record.wrong80))
             }); 
```

然而，这`ToList`似乎是非常低效的，只是让我的代码在那里呆了很长时间。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T01:08:51.413

`AsEnumerable()`将做与将处理引入 linq-to-objects 相同的事情`ToList()`，但不会浪费时间和内存先存储所有这些。相反，当您遍历它时，它会一次创建一个对象。

作为一项规则，您应该使用`AsEnumerable()`将操作从另一个源移动到内存中，而不是`ToList()`除非您真的想要一个列表（例如，如果您将多次访问相同的数据，因此该列表充当缓存）。

到目前为止，我们有：

```
var statistics = (
  from record in startTimes
  group record by record.startTime
  into g
  select g;
  ).AsEnumerable().Select(
    g => new e_activeSession
    {
      workerId = wcopy,
      startTime = g.Key.GetValueOrDefault(),
      totalTasks = g.Count(),
      totalTime = g.Max(o => o.record.timeInSession).GetValueOrDefault(),
      /* ... */
     }); 
```

但还有一个更大的问题。你也要小心`group by`。当与聚合方法一起完成时，通常没问题，但否则它最终会变成许多数据库调用（一个用于获取键的不同值，然后每个值一个）。

考虑到上述情况（我省略了没有提到每一列）。如果不使用`AsEnumerable()`（或`ToList()`你有什么），因为`wcopy`可能完全在查询之外（我看不到它的定义位置），第一个生成的 SQL 将是（如果允许的话），类似于：

```
select startTime, count(id), max(timeInSession), /* ... */
from tasks
group by startTime 
```

这应该由数据库非常有效地处理（如果不是，请检查索引并在生成的查询上运行数据库引擎优化顾问）。

但是，在内存中进行分组时，它可能会首先执行：

```
select distinct startTime from tasks 
```

进而

```
select timeInSession, /* ... */
from tasks
where startTime = @p0 
```

对于找到的每一个不同的`startTime`，将其作为`@p0`. 无论其余代码的效率如何，这很快就会变成灾难性的。

我们有两个选择。哪个是最好的会因情况而异，所以我会给出两者，尽管第二个在这里是最有效的。

有时我们最好的方法是加载所有相关行并在内存中进行分组：

```
var statistics =
  from record in startTimes.AsEnumerable()
  group record by record.startTime
  into g
  select new e_activeSession
  {
    workerId = wcopy,
    startTime = g.Key.GetValueOrDefault(),
    totalTasks = g.Count(),
    totalTime = g.Max(o => o.record.timeInSession).GetValueOrDefault(),
    /* ... */
  }; 
```

我们也许可以通过只选择我们关心的列来提高效率（如果上面使用了表中的每一列，则无关紧要）

```
var statistics =
  from record in (
    from dbRec in startTimes
    select new {dbRec.startTime, dbRec.timeInSession, /*...*/}).AsEnumerable()
    group record by record.startTime
    into g
    select new e_activeSession
    {
      workerId = wcopy,
      startTime = g.Key.GetValueOrDefault(),
      totalTasks = g.Count(),
      totalTime = g.Max(o => o.record.timeInSession).GetValueOrDefault(),
      /* ... */
    }; 
```

不过，我认为这不是最好的情况。我会在我要枚举组的情况下使用它，然后枚举每个组。在您对每个组进行聚合而不枚举它们的情况下，最好将该聚合工作保留在数据库中。数据库擅长它们，它将大大减少通过网络发送的数据总量。在这种情况下，我能想到的最好的方法是强制一个新对象，而不是镜像它的实体类型，但它不被识别为实体。您可以为此创建一个类型（如果您对此进行了多个变体，则很有用），否则只需使用匿名类型：

```
var statistics = (
  from record in startTimes
  group record by record.startTime
  into g
  select new{
    startTime = g.Key.GetValueOrDefault(),
    totalTasks = g.Count(),
    totalTime = g.Max(o => o.record.timeInSession).GetValueOrDefault(),
    /* ... */
  }).AsEnumerable().Select(
    d => new e_activeSession
    {
      workerId = wcopy,
      startTime = d.startTime,
      totalTasks = d.totalTasks,
      /* ... */
    }); 
```

这样做的明显缺点是纯粹的冗长。但是，它将保持操作最好在数据库中完成，在数据库中，同时仍然不会像这样`ToList()`做那样浪费时间和内存，不会重复访问数据库，并将`e_activeSession`创建从 linq2sql 拖到 linq2objects 中，因此应该允许。

（顺便说一句，.NET 中的约定是类和成员名称以大写开头。这没有技术原因，但这样做意味着您将匹配更多人的代码，包括 BCL 和您使用的其他库的代码）。

编辑：顺便说一下；我刚刚看到你的另一个问题。请注意，在某种程度上，`AsEnumerable()`这里是导致该问题的确切原因的变体。了解这一点，您就会对不同的 linq 查询提供程序之间的界限有了很多了解。

# modelsim - 有没有办法通过 TCL API 在 ModelSim 中切换叶子名称？

> ID：11804835
> 
> 赞同：11
> 
> 时间：2012-08-04T00:15:17.477
> 
> 标签：modelsim

我正在寻找一种在 GUI 模式下在 ModelSim 视图中切换网络叶子名称的方法。换句话说，相当于按下“切换叶子名称<->全名”按钮：

![在此处输入图像描述](../Images/558ce8a01fd148b34f56db127fb741f3.png)

我知道添加短名称的方式。例如，我一直在使用这样的代码：

```
add wave -group "stimulus" -label "valid" ${sim_module}/aso_src0_valid
add wave -group "stimulus" -label "ready" ${sim_module}/aso_src0_ready
add wave -group "stimulus" -label "data" -radix ascii ${sim_module}/aso_src0_data
add wave -group "stimulus" -label "begin" ${sim_module}/aso_src0_startofpacket
add wave -group "stimulus" -label "end" ${sim_module}/aso_src0_endofpacket
add wave -group "stimulus" -label "error" ${sim_module}/aso_src0_error 
```

但是，对于一个快速的模拟脚本草图，当我想为一个看起来太多而无法输入的模块添加所有信号时，我就这样做了：

```
add wave -group "stimulus" "/aso_src0_*" 
```

默认情况下，它在“刺激”组下显示全名。我找不到`add`在叶子名称和全名之间切换的函数参数或另一个函数。鉴于 ModelSim 有多么强大，很难相信它没有这个 API 或其他简单的方法来实现我想要的。那么有没有办法，它是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-25T22:09:27.620

```
config wave -signalnamewidth 1 
```

**来自 ModelSim 参考手册，v6.5e：**

```
-signalnamewidth [<value>] 
```

*（可选）控制作为路径名窗格中显示的信号名称的一部分显示的分层区域的数量。相关的 Tcl 变量是 PrefWave(SignalNameWidth)。也可以使用 modelsim.ini 文件中的 WaveSignalNameWidth 变量进行设置。*

*<value> — 默认为 0 的任何非负整数（显示完整路径。例如，1 仅显示叶路径元素，2 显示最后两个路径元素，依此类推。*

# ruby - 通过 API 上传本地 CSV 失败

> ID：11804840
> 
> 赞同：1
> 
> 时间：2012-08-04T00:16:07.650
> 
> 标签：ruby, google-bigquery

我正在使用官方的 Google Ruby gem，虽然到目前为止我尝试过的所有其他东西都运行良好（包括列出项目、数据集和表以及创建表），但启动加载作业失败，JSON 中出现以下内容错误响应：

```
"Job configuration must contain exactly one job-specific configuration object (e.g., query, load, extract, spreadsheetExtract), but there were 0: " 
```

我创建的正文字符串如下所示：

```
--xxx
Content-Type: application/json; charset=UTF-8
{"configuration":{"load":{"destinationTable":{"projectId":"mycompany.com:projectId","datasetId":"all_events","tableId":"install"},"createDisposition":"CREATE_NEVER","writeDisposition":"WRITE_APPEND"}}}
--xxx
Content-Type: application/octet-stream
test,second,1234,6789,83838
--xxx 
```

我之前已经`install`为该数据创建了具有适当架构的表，所以这不应该是问题。

最后，为了完整起见，这里是我用来触发请求的实际代码（这是更大类中的两种方法）：

```
def create_insert_job
  config = {
    'configuration' => {
      'load' => {
        'destinationTable' => {
          'projectId' => 'mycompany.com:projectId',
          'datasetId' => 'all_events',
          'tableId' => 'install'
        },
        'createDisposition' => 'CREATE_NEVER',
        'writeDisposition' => 'WRITE_APPEND'
      }
    }
  }

  body = "#{multipart_boundary}\n"
  body += "Content-Type: application/json; charset=UTF-8\n"
  body += "#{config.to_json}\n"
  body += "#{multipart_boundary}\n"
  body +="Content-Type: application/octet-stream\n"
  body += "test,second,1234,6789,83838\n"
  body += "#{multipart_boundary}\n"

  prepare_big_query # This simply gets tokens and instantiates google_client and big_query_api
  param_hash = { api_method: big_query_api.jobs.insert }
  param_hash[:parameters] = {'projectId' =>'mycompany.com:projectId'}
  param_hash[:body] = body
  param_hash[:headers] = {'Content-Type' => "multipart/related; boundary=#{multipart_boundary}"}

  result = google_client.execute(param_hash)
  JSON.parse(result.response.body)
end

def multipart_boundary
  '--xxx'
end 
```

有任何想法吗？

**对以下答案的补充以使此代码有效**

请注意，上面的#multipart_boundary 方法返回时已经添加了“--”。这是一个问题，因为设置边界标头（在参数散列中）会在我们真正想要“xxx”时导致“--xxx”。

此外，这个 gem 的文档非常粗糙，因为在修复了我的换行问题（根据 @jcondit 的回答）后，我收到了一个关于上传到错误 URL 的新错误。那是因为您需要添加：

```
'uploadType' => 'multipart' 
```

到参数，以便将请求发送到正确的 URL。

所以最终的 param_hash （同样，在修复换行符和边界问题之后）看起来像：

```
param_hash = { api_method: big_query_api.jobs.insert }
param_hash[:parameters] = {'projectId' => project_id, 'uploadType' => 'multipart'}
param_hash[:body] = body
param_hash[:headers] = {'Content-Type' => "multipart/related; boundary=#{multipart_boundary}"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T02:57:30.073

您的 http 请求格式不正确—— bigquery 根本不认为这是一个加载作业。我正在出去吃晚饭的路上，所以我不能做任何更深入的调查，但希望这能给你一个继续前进的指导。

我仔细看了看，我看不出你的要求有什么问题。一个建议是尝试在 bigquery UI 中执行相同的加载，并使用 chrome 工具->开发者工具/网络选项卡查看发送的 RPC。

如果我使用虚拟 csv 文件执行此操作，我会得到：

```
--yql9f05215ct
Content-Type: application/json; charset=utf-8

{"jobReference":{"projectId":"helixdata2"},"configuration":{"load":{"destinationTable":{"projectId":"helixdata2","datasetId":"lotsOdata","tableId":"import"}}}}
--yql9f05215ct
Content-Type: application/octet-stream
Content-Transfer-Encoding: base64

YSxiLGMKYyxkLGUKZixnLGgK
--yql9f05215ct-- 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:01:15.513

您需要在每个 MIME 部分的标题和每个 MIME 部分的正文之间插入一个额外的换行符。您的请求正文应如下所示：

```
--xxx
Content-Type: application/json; charset=UTF-8

{"configuration":{"load":{"destinationTable":{"projectId":"mycompany.com:projectId","datasetId":"all_events","tableId":"install"},"createDisposition":"CREATE_NEVER","writeDisposition":"WRITE_APPEND"}}}
--xxx
Content-Type: application/octet-stream

test,second,1234,6789,83838
--xxx-- 
```

请注意每个部分中 Content-Type 标头后的额外换行符。

另外，不要忘记最后的边界分隔符有一个尾随 -- 附加到它上面。

# c# - 为什么我在运行应用程序时在表单中看不到变量 newGPUTextLabel？

> ID：11804841
> 
> 赞同：0
> 
> 时间：2012-08-04T00:16:16.257
> 
> 标签：c#

```
private void GPULabels()
        {

                newGPUTextLabel.Location = new Point(340, 100);
                newGPUTextLabel.Height = 250;
                newGPUTextLabel.Width = 500;
                newGPUTextLabel.ForeColor = Color.Blue;
                newGPUTextLabel.Font = new Font("Arial", 35, FontStyle.Bold);
                newGPUTextLabel.Text = " - הטמפרטורה כעת";
                button3.Enabled = false;

                newGPULabel.Location = new Point(250, 100);
                newGPULabel.Height = 250;
                newGPULabel.Width = 500;
                newGPULabel.ForeColor = Color.Red;
                newGPULabel.Font = new Font("Arial", 35, FontStyle.Bold);
                button3.Enabled = false;

        }

        private void CPULabels()
        {
            temperature_label.Location = new Point(250, 200);
            temperature_label.Height = 250;
            temperature_label.Width = 500;
            temperature_label.ForeColor = Color.Red;
            temperature_label.Font = new Font("Arial", 35, FontStyle.Bold);

            textMode_label.Location = new Point(340, 200);
            textMode_label.Height = 250;
            textMode_label.Width = 500;
            textMode_label.ForeColor = Color.Blue;
            textMode_label.Font = new Font("Arial", 35, FontStyle.Bold);
            textMode_label.Text = " - הטמפרטורה כעת";
            button3.Enabled = false;
        } 
```

我将标签添加到控件并为每个控件做了实例。我还在构造函数中调用了这两个函数。

我在表格上看到了所有标签，除了：newGPUTextLabel

Form1 尺寸为：800x600

如果我换行：

```
newGPUTextLabel.Location = new Point(340, 100); 
```

到

```
newGPUTextLabel.Location = new Point(340, 10); 
```

所以我看到了 newGPUTextLabel，但它在表单的顶部，我希望它靠近 textMode_label。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:27:54.810

根据您的描述，听起来好像 newGPUTextLabel 与其他控件不在同一个容器中。

我会在设计器中查看它的添加位置（例如，其中一个控件可能在面板或组框中，而另一个可能不在）。

# objective-c - 如何将 NSString 从一个视图控制器传递到另一个视图控制器？

> ID：11804842
> 
> 赞同：2
> 
> 时间：2012-08-04T00:16:18.480
> 
> 标签：objective-c, properties, uiviewcontroller, nsstring, scope

我用两个视图控制器制作了一个非常简单的基于故事板的项目。

我想简单地从 VC2 访问在 VC1 中声明的字符串。然后，第二个 VC 应在按下按钮后在文本字段中显示文本。

我不想使用**委托**、全局数据或**全局变量的****单独类**和 Extern 。相反，我读到使用对另一个 VC 的引用很容易实现变量共享。

 **对于下面显示的代码，XCode 没有抱怨，但是我的问题是：**第二个 VC 中的 NSLog 返回 null。**

如果有人能告诉我如何修改代码以将字符串传递给第二个 VC/告诉我哪里出错了，我将不胜感激。

VC1 标头：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController

@property NSString* textToPassToOtherVC; 
```

VC1 实现：

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize textToPassToOtherVC = _textToPassToOtherVC;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    _textToPassToOtherVC = @"Here is some text";
    NSLog (@"Text in VC1 is: %@", _textToPassToOtherVC);
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

@end 
```

VC2 标头：

```
#import <UIKit/UIKit.h>

@class ViewController;

@interface ViewController2 : UIViewController

@property (nonatomic, strong) ViewController *received;

@property (strong, nonatomic) IBOutlet UITextField *textDisplay;

- (IBAction)textButton:(id)sender;

@end 
```

VC2 实现：

```
#import "ViewController2.h"
#import "ViewController.h"

@interface ViewController2 ()

@end

@implementation ViewController2
@synthesize textDisplay;
@synthesize received;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

}

- (void)viewDidUnload
{
    [self setTextDisplay:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

- (IBAction)textButton:(id)sender {

    NSLog (@"Text in VC1 from VC2 is: %@", self.received.textToPassToOtherVC);

    textDisplay.text = self.received.textToPassToOtherVC;
}
@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T09:38:07.220

您的第二个视图控制器需要将其`received`属性设置为代表第一个视图控制器的值。

对于基于故事板的项目，这通常在`prepareForSegue:`. 在执行第二个视图控制器的 segue 之前，将在您的第一个视图控制器中调用此方法。

*（在我看来，你最好只将字符串传递给你的第二个视图控制器，而不是一个指向整个视图控制器的指针，因为这减少了依赖性并且是你的第二个视图控制器真正需要的唯一信息，但我们不要让事情复杂化。）*

以下是我认为您需要执行此操作的步骤：

*   在情节提要中为您的第一个视图控制器到第二个视图控制器的转场命名。对于此示例，我将其命名为`mySegue`.
*   在“ViewController.m”中导入“ViewController2.h”——你的第一个视图控制器需要知道第二个视图控制器有一个`received`属性。
*   `prepareForSegue:`在您的第一个视图控制器中添加这样的方法：

    ```
    - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
    {
        if ([segue.identifier isEqualToString:@"mySegue"])
        {
            ViewController2 *targetVC = (ViewController2*)segue.destinationViewController;
            targetVC.received = self;
        }
    } 
    ```

希望很清楚这段代码在做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T00:34:27.613

您的错误是基于对属性的基本误解。属性只是处理 getter 和 setter 的样板和实现细节的语法糖。尽管设置 _textToPassToOtherVC 确实会使属性返回该值，但它不会“通知”另一个，因为它对“received”的引用默认设置为 nil，并且永远不会由您设置。

如果在您实际检查此共享文本的值之前的任何地方，您有以下几行：

```
ViewController *myVC1; 
ViewController2 *myVC2;

// ...some initialization.

myVC2.received = myVC1;
// Now the IBAction will display the correct text. 
```

一切都会奏效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T00:23:46.863

您是否检查过您`self.received`的不是 null/nil？

在代码中设置断点以查看是否`self.received`实际初始化（如果不是，那么这就是您看不到任何内容的原因）：

```
- (IBAction)textButton:(id)sender {

    // Breakpoint here
    NSLog (@"Text in VC1 from VC2 is: %@", self.received.textToPassToOtherVC);

    textDisplay.text = self.received.textToPassToOtherVC;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-04T01:05:23.647

尝试使用 NSNotification。当您需要发送字符串时，使用该对象发布一个 NSNotification ！

当你想发送字符串时放置（当然在你给字符串一个值之后）：

```
 yourString = @"Hello";

    [[NSNotificationCenter defaultCenter] postNotificationName:@"sendString" object:yourString]; 
```

在你的第二个视图控制器中：

```
-(void)viewDidLoad:
{
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(ThingYouWantToDoWithString:) name:@"sendString" object:nil];
}

- (void)ThingYouWantToDoWithString:(NSNotification *)notification{
        // Make sure you have an string set up in your header file or just do NSString *theString = [notification object] if your using ARC, if not allocate and initialize it and then do what I just said
        theString = [notification object];
        NSLog("%@", theString);
        [self performSelector:@selector(OtherThings:) object:theString];
} 
```

希望这可以帮助！**

# c++ - 关于数组初始化的警告

> ID：11804844
> 
> 赞同：-1
> 
> 时间：2012-08-04T00:16:48.353
> 
> 标签：c++

我正在尝试在用 c++ 编写的 for 循环中将数组初始化为全零：

```
for( int k=1; k<4; k++ ){

    p[n]={0};
    for(int k1=0; k1<n; k1++){

        x=x+y;
    }
} 
```

但是当我编译时，我收到一条警告：

警告：扩展初始化列表仅适用于 -std=c++0x 或 -std=gnu++0x [默认启用]

有谁知道这意味着什么？或者我应该怎么做才能不得到那个警告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T00:23:30.037

这意味着您使用的初始化语法是在 C++11 中引入的。为了消除警告，您必须通过传递 -std=c++0x 在编译器中启用 C++11 支持。

另外，我认为您在代码示例中混淆了 ks 和 ns 。事实上，外循环一遍又一遍地做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:55:34.767

int myArray[5]={0}; 然后您可以将数组初始化为全零！试试看嘛 ！！

# android - Android - Jsoup HTML 抓取

> ID：11804845
> 
> 赞同：0
> 
> 时间：2012-08-04T00:16:49.883
> 
> 标签：android, html, screen-scraping, jsoup

在过去的两天里，我搜索了这个网站，寻找它无法正常运行的原因！我正在尝试在 crossfit.com 上进行当天的锻炼，当我运行该程序时，它会显示一段时间的白屏然后崩溃。请告诉我这里有什么问题！

```
public class MainActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    TextView tv = (TextView) findViewById(R.id.textView1);

    Document doc = null;
    try {
        doc = Jsoup.connect("http://www.crossfit.com").get();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    Element content = doc.getElementsByClass("blogbody").first();
    System.out.println(content.text());
    tv.setText(content.text());
}
} 
```

日志猫：

```
08-04 00:14:08.105: E/AndroidRuntime(339): FATAL EXCEPTION: main
08-04 00:14:08.105: E/AndroidRuntime(339): java.lang.OutOfMemoryError
08-04 00:14:08.105: E/AndroidRuntime(339):  at java.util.ArrayList.add(ArrayList.java:123)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.nodes.Node.addChildren(Node.java:411)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.nodes.Element.appendChild(Element.java:267)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.HtmlTreeBuilder.insertNode(HtmlTreeBuilder.java:204)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.HtmlTreeBuilder.insertEmpty(HtmlTreeBuilder.java:173)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.HtmlTreeBuilderState$7.process(HtmlTreeBuilderState.java:443)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.HtmlTreeBuilder.process(HtmlTreeBuilder.java:89)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.HtmlTreeBuilderState$15.anythingElse(HtmlTreeBuilderState.java:1197)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.HtmlTreeBuilderState$15.process(HtmlTreeBuilderState.java:1191)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.HtmlTreeBuilder.process(HtmlTreeBuilder.java:84)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.TreeBuilder.runParser(TreeBuilder.java:48)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.TreeBuilder.parse(TreeBuilder.java:41)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.HtmlTreeBuilder.parse(HtmlTreeBuilder.java:37)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.parser.Parser.parseInput(Parser.java:30)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.helper.DataUtil.parseByteData(DataUtil.java:101)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.helper.HttpConnection$Response.parse(HttpConnection.java:469)
08-04 00:14:08.105: E/AndroidRuntime(339):  at org.jsoup.helper.HttpConnection.get(HttpConnection.java:147)
08-04 00:14:08.105: E/AndroidRuntime(339):  at com.example.lookingfor.MainActivity.onCreate(MainActivity.java:36)
08-04 00:14:08.105: E/AndroidRuntime(339):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
08-04 00:14:08.105: E/AndroidRuntime(339):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
08-04 00:14:08.105: E/AndroidRuntime(339):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
08-04 00:14:08.105: E/AndroidRuntime(339):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
08-04 00:14:08.105: E/AndroidRuntime(339):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
08-04 00:14:08.105: E/AndroidRuntime(339):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-04 00:14:08.105: E/AndroidRuntime(339):  at android.os.Looper.loop(Looper.java:123)
08-04 00:14:08.105: E/AndroidRuntime(339):  at android.app.ActivityThread.main(ActivityThread.java:3683)
08-04 00:14:08.105: E/AndroidRuntime(339):  at java.lang.reflect.Method.invokeNative(Native Method)
08-04 00:14:08.105: E/AndroidRuntime(339):  at java.lang.reflect.Method.invoke(Method.java:507)
08-04 00:14:08.105: E/AndroidRuntime(339):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-04 00:14:08.105: E/AndroidRuntime(339):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-04 00:14:08.105: E/AndroidRuntime(339):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:53:18.500

好吧，.. Jsoup 并非完美无缺。虽然它是一刀切的，但所有下载似乎都很吸引人，但有时最好自己下载流。

```
URL url = new URL("http://www.crossfit.com");
url.openConnection();
InputStream is = url.openStream();
byte[] b = new byte[8192];
int count;
ByteArrayOutputStream os = new ByteArrayOutputStream();
while ((count = is.read(b)) != -1) {
    os.write(b, 0, count);
}
is.close();
doc = Jsoup.parse(os.toString("UTF-8")); 
```

这是一个相当大的页面——每次弹出大约 70k 的 HTML 并不适合在任何小型内存打印设备中使用类似 DOM 的模型。自己加载它可以工作..在*大多数设备上..否则 - 改为使用***TagSoup**寻找流解决方案。

# css - 记事本++的CSS插件

> ID：11804846
> 
> 赞同：4
> 
> 时间：2012-08-04T00:17:02.140
> 
> 标签：css, plugins, autocomplete, stylesheet, notepad++

我希望找到一个可以为 CSS 自动完成的 Notepad++ 插件。类似于 TextFX 但用于 CSS 的东西。理想的（IMO）是完成括号的东西，但也可以在结束时折腾；对于每个 :，有什么建议吗？

# html-email - HTML电子邮件中的图像精灵？

> ID：11804850
> 
> 赞同：6
> 
> 时间：2012-08-04T00:17:42.800
> 
> 标签：html-email, css-sprites

我做了一些谷歌搜索，发现没有在 HTML 电子邮件中进行图像精灵的指导。所以我有以下问题：

1.  可能吗？
2.  推荐吗？有好处吗？缺点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-04T00:21:23.453

在电子邮件中，您应该只使用非常基本的 html，以及基本的内联样式。邮件客户端兼容性非常不同且很差（尤其是前景，这是相当普遍的）。我绝对不会在电子邮件中使用精灵。

# ubuntu - 无法运行 TeamCity 自定义脚本

> ID：11804859
> 
> 赞同：2
> 
> 时间：2012-08-04T00:18:30.207
> 
> 标签：ubuntu, continuous-integration, teamcity, ubuntu-12.04

我使用 Ubuntu Server 12.04 LTS 创建了一个新实例，安装了所有必需的包（如 Java、RVM 和 Ruby），然后下载并安装了 TeamCity 7.0.4

TeamCity 位于 /home/ubuntu，但我在运行“sudo su”后以 root 身份启动服务器。

出于某种原因，我无法运行我的 rake 测试，因为之前的步骤（这是必要的）失败了。这是构建日志的一部分：

```
[Step 1/5] Starting: /home/ubuntu/TeamCity/buildAgent/temp/agentTmp/custom_script3896719423178259098
[00:06:03][Step 1/5] in directory: /webserver/K2
[00:06:03][Step 1/5] /home/ubuntu/TeamCity/buildAgent/temp/agentTmp/custom_script3896719423178259098: 1: /home/ubuntu/TeamCity/buildAgent/temp/agentTmp/custom_script3896719423178259098: source: not found
[00:06:03][Step 1/5] /home/ubuntu/TeamCity/buildAgent/temp/agentTmp/custom_script3896719423178259098: 2: /home/ubuntu/TeamCity/buildAgent/temp/agentTmp/custom_script3896719423178259098: bundle: not found
[00:06:03][Step 1/5] Process exited with code 127 
```

我要运行的第一个构建步骤是“捆绑安装”

我不知道为什么会出现这个问题。在 centos 5 中，我可以运行所有这些步骤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T10:55:15.217

有关如何在 TeamCity 的 PATH 中实际添加其他条目的更多信息是

*   进入项目配置编辑界面
*   在配置步骤（右侧）中，选择“#7 Build Parameters”
*   单击“添加新参数”，输入名称“PATH”，选择“环境变量”种类（名称输入字段中的名称应更改为 env.PATH），然后在值输入字段中，将您需要的路径附加到现有的PATH 变量（例如`%env.PATH%:/usr/local/sbin:/usr/local/bin`）；节省

应该是这样，尝试运行你的任务

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-04T02:31:05.493

看起来您的 PATH 中没有“捆绑包”，您可以在代理参数页面中检查您的 PATH 并附加正确的路径（如果为真）。

# hibernate - 作为限制类实例的对象的休眠条件限制

> ID：11804868
> 
> 赞同：2
> 
> 时间：2012-08-04T00:19:49.430
> 
> 标签：hibernate, criteria

因此，如果我要对员工进行限制，我会说

```
Criteria crit = sess.createCriteria(Employee.class); 
```

所以现在我试图弄清楚是否有可能而不是这样做：

```
List<String> employeeIds;

Criteria crit = sess.createCriteria(Employee.class);
crit.add(Restrictions.in("id", employeeIds));
crit.createAlias("car", "car");
return crit.list(); 
```

去做这个：

```
List<Employee> employees;

Criteria crit = sess.createCriteria(Employee.class);
crit.add(Restrictions.in("", employees));                //Doesn't work, but I think you get what I'm trying to do, query by objects themselves
crit.createAlias("car", "car");
return crit.list(); 
```

我试图通过员工对象列表限制对员工的查询。稍后我与另一个表进行连接，因此通过我正在为其创建条件的类的特定实例列表进行限制是很有用的。

这将与此示例 SQL 相同

```
SELECT * FROM employees
    JOIN cars
        ON cars.ownerName like employees.name
    WHERE employees.id in
        (<list of employee ids goes here>); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-10T22:02:09.787

我要做的唯一想法是实际获取要检查的 ID 列表。Restrictions.in 意味着您指定一个属性，因此“”将不起作用。尽管这比您发布的代码要多得多，但我认为这是解决您发布的问题的方法：

```
List<Employee> employees; // This has to be the list o employees
List<Integer> ids = new ArrayList();
Iterator it = employees.iterator();
while(it.hasNext()){
ids.add(((Employee)it.next()).getId());
}
Criteria crit = sess.createCriteria(Employee.class);
crit.add(Restrictions.in("id", ids));
crit.add(Restriction.eq("car","car")); 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T17:21:43.077

你试过这个吗？

```
 Criteria crit = sess.createCriteria(Employee.class, "employee");
     crit.add(Restrictions.in("employee", employees)); 
```

# php - 如何防止我的 WordPress 网站中的评论部分跨越整个屏幕？

> ID：11804871
> 
> 赞同：0
> 
> 时间：2012-07-29T21:27:48.570
> 
> 标签：php, html, css, wordpress

我最近建立了我的 wordpress 网站，但每篇文章下方的评论部分跨越了屏幕的整个宽度，而不是跟随页面其余部分使用的边距。如何将页边距设置为与本节页面的其余部分相同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T21:36:34.107

您的页脚元素必须位于`container`ID div 标记内。或者它们必须用给定样式的 ID 或类包装在自己的 div 中

```
#footerWrapper {
width: 768px;
margin: 0 auto;
} 
```

这将使它们居中并与主容器 div 对齐。很可能 wordpress 函数在模板文件中被移动了。

您将看到主页上的页脚被包裹在

`<div id="footer" class="full left"></div>`

所以有人弄乱了你的 single.php 模板文件。就是这样，因为您的索引、页面、档案都没有问题，所以任何模板最有可能 single.php 都需要编辑。

# hibernate - 从属性文件替换persistence.xml中的占位符（不使用spring）

> ID：11804874
> 
> 赞同：0
> 
> 时间：2012-08-04T00:20:29.603
> 
> 标签：hibernate, jpa, properties

在运行时从属性文件中获取值并将它们替换为 persistence.xml。无论如何可以轻松实现这一目标？我正在考虑在代码本身中执行此操作（即从属性文件中读取值并将其替换为persistence.xml；不知道这是否可行，或者是个好主意）。

我认为使用弹簧是可能的，但我没有使用弹簧。

# java - 错误消息的顺序不正确

> ID：11804879
> 
> 赞同：8
> 
> 时间：2012-08-04T00:21:28.810
> 
> 标签：java, spring, spring-mvc

在我的 Spring MVC 验证中，我的错误消息的顺序随机变化，我希望消息的顺序与它们出现在页面上的顺序相同。

我的 AccountForm.java 类看起来像：

```
@NotNull(message = "Account name cannot be empty.")
@Size(min=3, max=50, message="Account name must be between 3 and 50 characters long.")
private String accountName;

@NotNull(message = "Company name cannot be empty.")
@Size(min=3, max=50, message="Company name must be between 3 and 50 characters long.")
private String companyName; 
```

而且我还在我的控制器中附加了一些自定义错误：

```
 public ModelAndView create(@Valid AccountForm accountForm, BindingResult bindingResult) {

    ModelAndView mav = new ModelAndView("accounts/new");
    mav.addObject("errors", bindingResult.getAllErrors());
    mav.addObject("accountForm", accountForm);

    if (!bindingResult.hasErrors()) {
        if(accountService.findByAccountName(accountForm.getAccountName()) != null) {
            bindingResult.addError(new ObjectError("accountName", "Account name is already is use"));
        }
        ..
        ..
    }

    if(bindingResult.hasErrors() {
      return mav;
    }

    .. 
```

当我在表单上点击提交时，消息的顺序不断变化。

我使用以下方法在我的视图中呈现错误：

```
 <#list errors as error>
            <li>${error.defaultMessage}</li>
        </#list> 
```

这可以解决吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T06:51:12.417

这是通过验证组实现的，Spring 支持它。您正在使用**@Valid**注释，但它应该是**@Validated**以便使用验证组：

```
 public ModelAndView submitSearch(@Validated(value={OrderChecks.class}) @ModelAttribute("SearchStringBackingObject") final SearchStringBackingObject backingObject 
```

OrderChecks.class：

```
 @GroupSequence(value={NotEmptyGroup.class, LengthCheckGroup.class, DiacriticeCheckGroup.class, EmailValidationGroup.class, EmailLengthValidationGroup.class,
    Email3EntriesValidationGroup.class, EntityAlreadyExistsValidatorGroup.class, Default.class})
 public interface OrderChecks {} 
```

在支持对象内部：

```
 @NotBlank(groups=NotEmptyGroup.class)
@Length(max=25, groups=LengthCheckGroup.class)
@DiacriticeCheck(groups=DiacriticeCheckGroup.class)
private String firstname=""; 
```

@GroupSequence 中的每个条目都是一个接口。

**编辑**

因此，如果您希望首先验证帐户名称，则为其创建一个接口：

```
public interface AccountNameGroup{} 
```

然后在验证组界面中，这将是第一个界面：

```
@GroupSequence(value={AccountNameGroup.class, the rest of groups})
public interface OrderOfGroups{}

And of course inside the Controller you specify the @Validated annotation with the OrderOFGroups interface. 
```

这样，将首先验证帐户名称

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T05:09:56.633

我也面临同样的问题并尝试了很多。我认为现在在 JSR-303 中有这样做的标准方法。
这可以使用[组](http://www.jroller.com/eyallupu/entry/jsr_303_beans_validation_using)（我个人不喜欢）或通过定义`<form:error>`所需的顺序来实现。

# javascript - 将文本设置为 google+ 分享按钮

> ID：11804881
> 
> 赞同：7
> 
> 时间：2012-08-04T00:22:28.660
> 
> 标签：javascript, share, facebook-opengraph, google-plus, code-snippets

我正在创建一个具有 g+ 共享按钮的页面，但我想动态更改要共享的内容的描述。要自定义共享按钮，我正在使用带有 Open Graph 协议的[片段。](https://developers.google.com/+/plugins/snippet/?hl=en)

我尝试的解决方案如下，但无法正常工作：

```
<meta property="og:title" content="O Fabuloso Gerador De Lero Lero v3" />
<meta property="og:image" content="images/robot.png" />
<meta property="og:description" content="..." /> 
```

```
$('meta[property="og:description"]').attr('content',text);

var shareButtons = $('div:first','section.share-buttons');
shareButtons.html('');
shareButtons
    .prepend('<a href="https://twitter.com/share" class="twitter-share-button" data-text="' + text.trunc(120,true) + '" data-url="http://goo.gl/1KHFM" data-lang="pt">Tweetar</a>')
    .prepend('<div class="g-plus" data-action="share" data-href="http://lerolero.miguelborges.com/t=' + new Date().getTime() + '" data-annotation="bubble"></div>');

try {
    window.twttr.widgets.load();
    window.gapi.plus.go();
} catch(e) {} 
```

但是，分享按钮中的描述内容始终是初始的。

有谁知道如何使它工作？

# 编辑：

我在按钮 twitte 上遇到了同样的问题，但设法解决了这个问题：

```
 shareButtons
            .prepend('<a href="https://twitter.com/share" class="twitter-share-button" data-text="' + text.trunc(120,true) + '" data-url="http://goo.gl/1KHFM" data-lang="pt">Tweetar</a>');

        window.twttr.widgets.load(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T23:18:26.013

您页面的代码段是由您的页面的服务器端提取生成的。页面提取器不执行 JavaScript。这就是您对该元素所做的更改未在您的共享中表达的原因。

您可以使用 get 参数并指定目标来解决此问题。

1.  配置您的页面以接受描述作为 GET 参数。例如，[http](http://exmaple.com?desc=foobar) ://exmaple.com?desc=foobar会使您的 Open Graph 标记看起来像这样：`<meta property="og:description" content="foobar" />`
2.  当您呈现您的分享链接、分享按钮或 +1 按钮时，使用 GET 参数指定所需的描述来定位页面。对于共享按钮，您的标记可能如下所示：`<div class="g-plus" data-action="share" data-href="http://example.com/?desc=foobar"></div>`

但是，这将影响计数。如果您将此技术与 +1 按钮一起使用，则每个描述都将被视为不同的页面，并且计数将单独累积。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T23:46:31.250

我知道 Facebook 会缓存描述和其他元数据的信息。根据[这个链接](https://groups.google.com/forum/#!msg/google-plus-developers/AoP1BluGuek/erdS3kgmZocJ%5B1-25%5D)，谷歌+似乎也是如此。似乎它被无限期地缓存了......这使您的情况几乎不可能，具体取决于您想要更改内容的频率。要么这样，要么等几天，看看它是否会改变。我想指出 Jenny 也是正确的，但是在经历了那个之后，你很可能仍然不会得到理想的结果。

# ruby-on-rails - Rails：实现acts_as_commentable_with_threading 表单

> ID：11804884
> 
> 赞同：1
> 
> 时间：2012-08-04T00:23:06.123
> 
> 标签：ruby-on-rails, acts-as-commentable

我正在尝试创建一个利用acts_as_commentable_with_threading gem 的表单。虽然我有工作代码，但它有几个问题。我主要担心的是我必须为可评论对象的 ID 创建一个 hidden_​​field。由于 gem 的内置方法 build_from，我怀疑有一种方法可以绕过它。如果你知道怎么做，请分享。目前，我的代码如下所示：

在我的印象控制器中，我有：

```
@impression = @book.impressions.find_by_user_id(user)
@new_comment = Comment.build_from( @impression, current_user.id, "" ) 
```

在我看来，我有：

```
<%= form_for @new_comment, :remote => true do |f| %>
  <%= f.text_area :body %>
  <%= f.hidden_field :commentable_id, :value => @impression.id %>
  <%= f.submit 'Submit' %>
<% end %> 
```

在评论控制器中，我有：

```
def create
  @comment = Comment.build_from( Userimpression.find(params[:comment][:commentable_id]), current_user.id, params[:comment][:body] )
  @comment.save
end 
```

在评论模型中：

```
def self.build_from(obj, user_id, comment)
  c = self.new
  c.commentable_id = obj.id
  c.commentable_type = obj.class.base_class.name
  c.body = comment
  c.user_id = user_id
  c
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-09T20:08:59.947

我知道这是一个旧的答案，但一个很好的教程涵盖了这个 gem 的几个方面，是：[http ://twocentstudios.com/blog/2012/11/15/simple-ajax-comments-with-rails/](http://twocentstudios.com/blog/2012/11/15/simple-ajax-comments-with-rails/)

它不能帮助您处理孩子，但很容易弄清楚。

# php - Preg_match 删除创建模式的文本

> ID：11804891
> 
> 赞同：0
> 
> 时间：2012-08-04T00:24:43.297
> 
> 标签：php, regex, preg-match-all

我目前有代码

```
$sPattern = "/<\/td><td>\(Shotgun\)(.*?)<\/td><td>/";
preg_match_all($sPattern,$homepage,$aMatch); 
```

它可以很好地从特定网站中提取多行，但是当它提取它们并在数组中回显它们时，它会带来`</td><td>`and `</td><td>`。

是否有可能阻止它将这些标签带入模式中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:26:52.283

只需回显您在捕获组中捕获的内容，而不是整个匹配：

```
foreach( $aMatch[1] as $match)
    echo $match; 
```

如果您还想在输出中使用“（Shotgun）”，请修改您的正则表达式以捕获它：

```
$sPattern = "/<\/td><td>(\(Shotgun\).*?)<\/td><td>/"; 
```

然后你可以使用相同的代码在上面打印出来。

# ruby-on-rails - Ruby on Rails link_to 路由路径，同时保留原始查询字符串参数

> ID：11804892
> 
> 赞同：4
> 
> 时间：2012-08-04T00:24:47.753
> 
> 标签：ruby-on-rails, html-helper

我有一个像这样的网址[http://example.com/?sort=pop](http://example.com/?sort=pop)

在我看来，我正在使用`link_to category.name, categories_path(category)`

如何保留请求 URL 上可能已经存在的任何查询字符串参数？

所以最终的链接 URL 是[http://example.com/categories/1?sort=pop](http://example.com/categories/1?sort=pop)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-04T01:32:58.923

```
<%= link_to category.name, category_path(category, params) %> 
```

应该做的伎俩

注意访问特定类别的默认路由助手是`category_path`. 单数，因为它只适用于一个类别，是有道理的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T14:58:41.797

安东尼的解决方案几乎对我有用。但是，它不喜欢仅仅将其`params`作为传递变量之一。相反，我必须在链接中添加`params:`或`:params =>`。它现在对我有用。

`<%= link_to "XLS ", users_path(format: "xls", params: params) %>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T19:33:52.363

```
<%= link_to category.name, category_path(category,
  request.parameters.merge({:new_params => 42}) ) %> 
```

这应该链接到正确的路径，保留现有参数并添加您可能拥有的任何新参数。

[Rails：在 link_to 中保留 GET 查询字符串参数](https://stackoverflow.com/questions/3762430/rails-preserving-get-query-string-parameters-in-link-to/4174493#4174493)

# c++ - 如何使用 libsndfile 将 .wav 文件加载到数组中？

> ID：11804894
> 
> 赞同：2
> 
> 时间：2012-08-04T00:25:24.403
> 
> 标签：c++, windows-7, wav, libsndfile

我查看了使用 libsndfile 的示例程序，但无法编译它们中的任何一个。我希望能够将 .wav 文件读入整数（或双精度）数组，而不必担心它是什么类型的 .wav 文件，甚至不必担心标题中的任何内容。我只关心将数据放入数组中，因此我可以对单个样本进行自己的处理。

我已经下载了 libsndfile 的源代码。有这么多文件和文件夹，我不知道从哪里开始。我需要包括什么？我需要使用哪些方法？有人有一个实际有效的简单示例吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T00:19:43.310

我是 libsndfile 的主要作者/维护者。

预编译的二进制包包含 windows DLL、文档、头文件和一些示例 VC7 和 VC9 项目文件。

您需要源代码的唯一原因是查看示例/目录中的示例程序（如果源代码 tarball）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-12-19T16:18:58.883

有点老了，但我想我会为未来的读者插话。

两者都没有回答主要问题：如何使用 libsndfile 将 .wav 文件加载到数组中？

使用 SndFileHandle 和 C++17 的答案（确实不需要 17 个，但是嘿，我喜欢鼓励使用）：

```
#include <sndfile.hh>
std::filesystem::path path = "file/path.wav";
if (std::filesystem::path::is_regular_file(path))
{
  SndfileHandle myf = SndfileHandle(&path.string()[0]);
  std::vector<float> array(myf.frames());
  myf.read(&array[0], int(myf.frames());
} 
```

更多信息可以在这里找到：http: [//ofdsp.blogspot.com/2011/07/loading-wav-file-with-sndfilehandle.html](http://ofdsp.blogspot.com/2011/07/loading-wav-file-with-sndfilehandle.html)（这个例子是受这个启发的）

另请注意，我选择将其读入浮点向量。可能是任何东西，只要记住你得到的可能取决于 wav（或其他声音类型）文件的比特率，尽管我相信 libsndfile 的编写是为了让你在很大程度上忘记这一点。

至于最初问题的其他部分，其他答案就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T11:36:06.190

这里似乎是*libsndfile，经过*预编译和打包以便在 Windows 7 上轻松安装： [http](http://www.mega-nerd.com/libsndfile/libsndfile-1.0.25-w64-setup.exe) ://www.mega-nerd.com/libsndfile/libsndfile-1.0.25-w64-setup.exe 。

（当然，如果您有兴趣，没有什么可以阻止您随时研究源代码；但是，即使您对源代码感兴趣，您使用预编译包的练习也将有助于您了解源代码。它似乎*libsndfile 的*本机平台是 Debian GNU/Linux，因此在 Windows 下使用源代码可能有点棘手。幸运的是，如果预编译的软件包适合您，那么您不必再担心源代码。）

# objective-c - 对音频和视频使用 appendSampleBuffer 时暂停 AVAssetWriter 会导致不同步。有没有办法暂停录音？

> ID：11804895
> 
> 赞同：12
> 
> 时间：2012-08-04T00:25:25.477
> 
> 标签：objective-c, avassetwriter

我有两种方法（一种用于音频，一种用于视频），它们通过各自的 AVAssetWriterInput 将它们各自的样本附加到 AVAssetWriter。一切都适用于简单的启动和停止情况。这里的一些背景是音频流来自 coreAudio，我在其中应用了回声抑制，而视频馈送来自通过 setSampleBufferDelegate 从 AVCaptureVideoDataOutput 馈送的 AVCaptureVideoDataOutputSampleBufferDelegate。

问题是当我想暂停录制并稍后恢复录制时，提要的音频和视频部分会发生不同的事情。到目前为止，我一直无法在暂停恢复后保持音频和视频同步。

似乎在通过 appendSampleBuffera 附加音频样本数据时，即使 CMSampleBufferRef 具有准确的时间戳，它似乎也不会“跳过”没有样本的时间段。我的意思是，当附加音频样本时，它并不真正关心 CMSampleBuffer 上的时间戳是什么......它只是不断堆积样本，即使有（例如）120 秒音频数据中的间隙，它不会为它创造一个“空白空间”。

坦率地说，我不在乎，只要视频样本的行为相同（但事实并非如此）。对于视频样本，生成的视频编码确实会跳过样本，尽管它会在没有数据的时间段内产生一个延长的空视频帧。

因此，从一个简单的实现来看，在暂停期间，您会在暂停期间获得一个空白视频部分，但对于音频部分，您会连续获得下一个未暂停部分的样本。这意味着暂停和取消暂停（通过禁止向 avasset writer 添加缓冲区数据）会导致音频和视频之间完全不同步。

我尝试过的补救措施：

1.  使用 CMSetAttachment() 设置 kCMSampleBufferAttachmentKey_FillDiscontinuitiesWithSilence - 对于音频通道，希望它会像视频流一样做。这根本没有效果。我可能做错了，但没有关于这方面的真正文档，所以在这个黑暗中拍摄。

2.  为受影响的“暂停”持续时间添加我自己的空样本（通过 appendLapsedAudiotime）。问题是我认为我的缓冲区不正确，我不清楚是否可以添加一个只有 0 或 1 个样本的音频缓冲区，并将其延长很长一段时间。如果我还将音频缓冲区格式更改为在整个暂停期间执行 1 个样本，这可能是可能的，但下游低级 API 不太可能会喜欢不稳定的采样率设置）。

3.  使用 CMSampleBufferCreateCopyWithNewTiming() 更改视频的呈现时间，以与音频的行为一致。事实证明，这既不稳定又不起作用。我对此进行了多次迭代，包括调整音频和视频的时间戳。可能我在那里犯了错误，但考虑到几乎没有文档，我也对这种方法视而不见。

4.  使用多个 startSessionAtSourceTime / endSessionAtSourceTime 以及在暂停状态期间抑制写入戳记，但这不起作用，实际上 Apples 头文件中的一个注释提醒您这不受支持（与他们的在线文档相反）：注意：目前不支持多个样本编写会话。在调用 endSessionAtSourceTime 后第二次调用 startSessionAtSourceTime: 时出错：

所以我的下一个方法是创建多个 AVAsset。当有“暂停开始”时，我将完成录制，当有“暂停停止”时，我将开始一个全新的录制，当一切都说完后，我将使用 AVAssetComposition 来再次将它们串在一起。我对这种方法有点紧张，因为我发现在设置新的 av 捕获时，快速 av 捕获会停止并开始在各个地方出现莫名其妙的失败。我可能不得不强制“取消暂停”等待一段时间，然后才能尝试开始新的 av 捕获。

所以问题是......有更好的方法吗？

# android - 进度条 - 增量暂停 0.5 秒？

> ID：11804898
> 
> 赞同：0
> 
> 时间：2012-08-04T00:25:34.820
> 
> 标签：android

我有一个进度条，我想准确推进 5 秒。我试图通过 'for' 循环 10 次，每次循环运行时，进度条都会增加 1/10。我有将条形增加 1/10 的代码，但我现在尝试创建一个循环：

将条增加到 1/10 等待 0.5 秒...将条增加到 2/10 等待 0.5 秒...将条增加到 3/10 等待 0.5 秒...等等。

到目前为止，这是我的代码，但它不起作用，它将栏提高到 10/10（满）。有任何想法吗？

非常感谢。

```
 for(int a = 0; a <= 10; a++){  
                 if(mp1.isPlaying()){   // my 5 second wav file

                       int newProgress = pBar1.getProgress() + (pBar1.getMax() / 10);
                        if (newProgress < 0) {
                            newProgress = 0;
                           }
                  pBar1.setProgress(newProgress);
                 // pause for 0.5 seconds here//
               } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:45:16.003

`Thread.sleep(500);`将暂停半秒。但是您必须在 UI 线程以外的线程中执行此操作。如果您让 UI 线程进入睡眠状态，您应用中的所有其他交互都将锁定，直到睡眠结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T22:56:53.090

[您要问的问题是，虽然我让线程 sleep](http://developer.android.com/reference/java/lang/Thread.html#sleep%28long%29)很容易暂停 0.5 秒，但您的整个 UI 都会冻结，这很糟糕，您不应该这样做。

您真正的问题似乎是您想要一个进度条来说明您正在播放的音频剪辑中经过的时间。如果您使用[MediaPlayer](http://developer.android.com/reference/android/media/MediaPlayer.html)，您可以使用`getCurrentPosition`和`getDuration`计算任何大小的音频剪辑。IE：

```
//Calculate the current clip position as a value between 0 and 100
int progress = (int) ((float) mp1.getCurrentPosition() / mp1.getDuration() * 100); 
```

# ruby-on-rails - Rails - 将 Metasearch / Ransack 与单个文本字段一起使用

> ID：11804900
> 
> 赞同：1
> 
> 时间：2012-08-04T00:25:53.440
> 
> 标签：ruby-on-rails, search

有谁知道是否可以将 Metasearch / Ransack gem 与单个文本字段而不是多个文本字段一起使用？对于我的应用程序，我只想在我的模型中搜索两个关联的属性，而全文搜索似乎有点矫枉过正。无论如何，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:25:01.853

是的当然。以下代码包含 4 个字段，但您可以只有一个。这是一个很好的资源（railscast），但很快就会进入您试图避免的搜索的高级方面：[http ://railscasts.com/episodes/370-ransack?autoplay=true](http://railscasts.com/episodes/370-ransack?autoplay=true)

控制器

```
def search
  @search = Entry.search(params[:q])
  @entries = @search.result
end 
```

查看 (haml)

```
%h1 Search
= search_form_for @search, :url=>search_entries_path do |f|

  .field
    =f.label :make_or_model_cont, "Make or Model"
    =f.text_field :make_or_model_cont
  .field
    =f.label :last_four_cont, "Last Four contains"
    =f.text_field :last_four_cont
  .field
    =f.label :created_at_gt, "Date after"
    =f.text_field :created_at_gt, :class=>"scroller time_field" # using jquery datetime picker plugin
  .field
    =f.label :created_at_lt, "Date is before"
    =f.text_field :created_at_lt, :class=>"scroller time_field"
  .actions
    =f.submit "Search"

=render 'results' # contains table, ths and tr + tds to hold the data 
```

# html - 超链接图像的背景颜色问题

> ID：11804901
> 
> 赞同：0
> 
> 时间：2012-08-04T00:25:57.103
> 
> 标签：html, wordpress, css

我的博客上有一个奇怪的 CSS 问题，你可以在这里看到：http: [//springecho.net/](http://springecho.net/)

对于我的主要内容区域中的文本链接，它们具有背景颜色和不同的文本颜色，它们在翻转时会发生变化。

对于也带有超链接的图像，您会在它们的底部看到一条黑线，这是此 CSS 代码的结果。当您翻转图像时，黑线消失（复制文本链接的行为）。

我可以在 CSS 中更改什么以完全隐藏图像后面的翻转背景颜色，或者让它根本不这样做？

非常感谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:33:56.410

起初：`background-color`只是似乎在悬停时被删除，因为它被设置为`#FFC909`.

`vertical-align`设置为默认值，这`baseline`意味着图像下方仍有一些空间。只需将其设置为`top`：

```
a > img {
    vertical-align: top;
} 
```

# hadoop - MapReduce 的哪些任务是不够的？

> ID：11804905
> 
> 赞同：1
> 
> 时间：2012-08-04T00:26:24.700
> 
> 标签：hadoop, mapreduce

我想知道是否有任何不适合 MapReduce 的任务示例。有一些具体的例子会很棒。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T00:45:18.220

其中一些可能是主观的，所以我会尽量坚持最一致的：

*   **流数据**——MapReduce 本质上是批处理的。您在 MapReduce 中编写的东西时不时运行，但很难获得它，因此它处理实时数据流。有一些项目正在计划解决这个问题，比如 Storm。
*   **实时分析**——同样，MapReduce 是批处理的，专为聚合和大规模性能而定制，不能快速得到答案。每个作业都会有 1-2 分钟的开销，因此使用 MapReduce 将响应时间控制在不到一分钟是非常具有挑战性的。这与作为软件的 Hadoop 而非作为范式的 MapReduce 有很大关系。
*   **记录获取**——就像您无法在短时间内运行分析一样，使用 MapReduce 获取单个记录或小块数据也不是一件容易的事。MapReduce 擅长全表扫描，而不是挑选一两条记录。这是 HBase 填补的利基市场。
*   **大规模重组**——不知道用什么词来形容它是个好词，但是任何需要在网络上洗牌的大量数据都可能对您的网络基础设施构成挑战。这是因为这些问题没有充分利用数据局部性。这方面的一些示例是全顺序排序和跨大型数据集的连接。

# java - 使用 PreparedStatement 将行插入数据库

> ID：11804906
> 
> 赞同：21
> 
> 时间：2012-08-04T00:26:38.390
> 
> 标签：java, mysql, prepared-statement

我想使用 PreparedStatement 在表中插入一行。该表有 3 列（int、String、String）。问题是 int 列是 AUTO_INCREMENT，所以我想将该变量留空并让数据库完成这项工作（它是一个 id）。虽然还没有找到如何做到这一点！

这是一个 MySQL 数据库。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-04T00:29:53.700

只需在 sql 查询字符串中提供 String 条目，数据库就会填充 auto_increment 字段：

```
String insertSQL = "INSERT INTO MyTable (StrCol1, StrCol2) VALUES (?, ?)";
PreparedStatement preparedStatement = dbConnection.prepareStatement(insertSQL);
preparedStatement.setString(1, "Val 1");
preparedStatement.setString(2, "Val 2");
preparedStatement.executeUpdate(); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-04T00:30:16.377

这比较简单，只需从列列表中省略自动增量列：

```
insert into mytbl(str1, str2) values (?, ?) 
```

准备语句，设置两个参数，以非查询方式执行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-04T00:35:48.493

如果该字段已经是自动增量的，则仅填充其他两个字段就足够了。这里有一个例子

```
String sql = "INSERT INTO mytableName("
    + "fistStringColumnName,"
    + "secondStringColumnName) "
    +  "VALUES(?,?)";

try (PreparedStatement pstmt = connection.prepareStatement(sql)) {

    // Set the values
    pstmt.setString(1, "firstString");
    pstmt.setString(2, "secondString");

    // Insert 
    pstmt.executeUpdate();

} catch (SQLException e) {

} catch (FileNotFoundException e) {

} 
```

# python - 导入模块错误Python

> ID：11804908
> 
> 赞同：4
> 
> 时间：2012-08-04T00:27:19.637
> 
> 标签：python, import, package, enthought, mayavi

我尝试使用 Enthought 发行版在 mayavi 中导入 mlab。它失败了

```
 from enthought.mayavi import mlab 
```

并且还与

```
 import enthought.mayavi
 from enthought.mayavi import mlab 
```

所以我有一个想法，也许要添加包 mayavi（空）中的**init .py**

```
 import mlab 
```

但现在前面的命令引发异常并出现错误

```
 Traceback (most recent call last):
  File "<pyshell#1>", line 1, in <module>
    import enthought.mayavi
 File "C:\Python27\lib\site-packages\enthought\mayavi\__init__.py", line 1, in <module>
import mlab
  File "C:\Python27\lib\site-packages\enthought\mayavi\mlab.py", line 3, in <module>
    from mayavi.mlab import *
ImportError: No module named mayavi.mlab 
```

我发现的一些主题提到 vtk 可能是这个精确的 mlab 导入问题的根本原因。我用 Tcl-Tk Installer 安装了 vtk。但实际上，enthought 发行版已经包含了一些 tvtk 包。我将 tvtk 位置添加到 PYTHONPATH。

这仍然行不通。

关于如何解决此类导入问题的任何想法？或任何与使用 enthought mlab 相关的评论（可能需要已知的解决方法）？

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:11:39.433

我通过安装包 mayavi2 在 Ubuntu 12.04 上为自己解决了这个问题

```
sudo apt-get install mayavi2 
```

然后这个导入咒语起作用了：

```
from mayavi.mlab import contour_surf 
```

现在我只需要记住如何使用它！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T05:02:45.770

卸载 Enthought 发行版并安装 python(x,y) 最后发行版。这现在与

```
from mayavi import mlab 
```

# xcode - Xcode 编译错误 - ld：未找到架构 armv7 的符号

> ID：11804909
> 
> 赞同：0
> 
> 时间：2012-08-04T00:27:48.507
> 
> 标签：xcode, serial-port, symbols

我最近将该文件添加`Serial.c`到`Serial.h`我的 Xcode 项目中。

的代码`Serial.c`如下，

```
#include <stdio.h>   /* Standard input/output definitions */
#include <stdlib.h>
#include <string.h>  /* String function definitions */
#include <unistd.h>  /* UNIX standard function definitions */
#include <fcntl.h>   /* File control definitions */
#include <errno.h>   /* Error number definitions */
#include <termios.h> /* POSIX terminal control definitions */

/*
* 'open_port()' - Open serial port on dock connector pins 13RX / 12TX
*
* Returns the file descriptor on success or -1 on error.
*/

int open_port(void)
{
int fd = -1; /* File descriptor for the port */

struct termios options; 

fd = open("/dev/tty.iap", O_RDWR | O_NOCTTY | O_NDELAY); // O_NOCTTY - don't be controlling terminal, O_NODELAY don't care about DCD signal state
if ( fd == -1)
{
    // couldn't open the port

    perror("open_port: Unable to open /dev/tty.iap - ");
}
else
    fcntl(fd, F_SETFL, 0);

tcgetattr(fd, &options); // get current options for the port

// set the baud rate
cfsetispeed(&options, B2400);
cfsetospeed(&options, B2400);

// enable the receiver and set local mode
options.c_cflag |= (CLOCAL | CREAD);

// set the new options for the port
tcsetattr(fd, TCSANOW, &options);

return (fd);

} 
```

该`serial.h`文件，

`NSInteger openPort();`

我正在尝试将来自 iPhone 的串行 RX 数据流的输出转换为 NSLog 语句。

我在文件中调用`OpenPort`函数`ViewControllerSerialConsole.m`

```
- (void)viewDidLoad
{
 [super viewDidLoad];
// Do any additional setup after loading the view.

#if !TARGET_IPHONE_SIMULATOR    
NSInteger serial = openPort();
NSLog(@"The serial data is %d",serial);
//_serialView.text = serial;
#endif
} 
```

该程序在 iPhone 模拟器上编译良好，但在 iPhone 上无法编译。

我收到以下错误消息，

架构 armv7 的未定义符号：“_openPort”，引用自：-[ViewControllerSerialConsole viewDidLoad] in ViewControllerSerialConsole.o ld：未找到架构 armv7 的符号 clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

ld：未找到架构 armv7 的符号

任何有关解决此问题的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-04T00:39:27.487

您的应用程序可以很好地为模拟器编译，因为您不是指缺少的“ `open_port`”或“ `openPort`”符号**。

在您的 Xcode 项目中，在`Serial.m`文件列表中选择您的“”文件（沿着工作区的左边缘）并查看该文件的文件检查器。

***确保在“Target Membership*** ”设置中为您的项目选中该复选框。

![确保为您的 .m 文件选择了 Target Membership](../Images/77aadfbd6f649c902ca57a67c935f6af.png)

** 当我们讨论这个主题时，您的函数在您的 Serial.m 和 Serial.h 文件之间是否正确命名？我`open_port`在一个中看到“”，在另一个中看到“” `openPort`。

# php - 通过 FTP 将查询结果存储到 CSV

> ID：11804912
> 
> 赞同：0
> 
> 时间：2012-08-04T00:28:14.280
> 
> 标签：php, mysql

我想从 SQL 查询结果创建一个 CSV 文件。到目前为止，我一直在使用本地存储来存储文件。但现在我想打开一个 ftp 连接并打开文件并写下我的 chnages。

我的代码如下：

```
$ftp_server = "subdomain.domain.com";
$conn_id = ftp_connect($ftp_server) or die("Couldn't connect to $ftp_server");
$login_result = ftp_login($conn_id, 'uN@m3', '$pWd00');

$filename = 'ftp://uN@m3:$pWd00@subdomain.domain.com.com:21/db_user_export_'.time().'.csv';       //Change this to FTP URL of the server where File is going to be placed

function populateCSVforRightNowDatabase(){

global $database, $filename, $queryInterval, $logger;
/*My Query*/

if($resultSet->load()) {

    // Create or Overwrite file
    $handle = fopen($filename, 'w+');

    // Write the spreadsheet column titles / labels
    fputcsv($handle, array( /*columns*/));

    foreach($resultSet as $result) {
        fputcsv($handle, array(/*Results*/));
    }
} else {
        $message = "Load Error: " . $resultSet->getLoadError();
        $logger->error($message);
}
// Finish writing the csv
fclose($handle); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T01:53:48.133

`fopen`支持多种[读/写模式](http://php.net/manual/en/function.fopen.php)。但是，您选择的模式`w+`是读/写模式，FTP 不支持该模式。除非出现其他错误，否则使用`w`or`a`应该可以。

# ios - 弱属性调用 objc_storeStrong

> ID：11804914
> 
> 赞同：1
> 
> 时间：2012-08-04T00:29:11.683
> 
> 标签：ios, automatic-ref-counting

我有一个名为 Panel 的类，其中包含这样的弱属性：

@property (nonatomic, weak) 对话框 *container;

在 Instruments 中，我可以看到 setContainer 方法最终调用了 objc_storeStrong。

这个对吗？我认为弱属性不会增加保留计数。

我的初始化方法如下：

```
- (id) initWithContainer:(Dialog *)pContainer{
    self = [self init];
    if (self) {
        self.container = pContainer;
    }
    return self;
} 
```

请指教。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T03:12:37.547

Thanks you all for your help while debugging this issue. I greatly appreciate it. My knowledge was/is correct, and weak does not increase the retain count. Unfortunately, I have spent hours debugging this issue that ended up being Instruments picking up an old version of the App that was built without the property being made weak. I don't know how this happened because I was launching instruments from within Xcode project, did a clean, etc... but something was wrong because when I launched instruments it would ask me for the instrument twice, not once, and then instead of launching the app automatically, I would have to start it manually by picking the target (which was wrong, because it usually launches the app automatically.) I resolved the issue by quitting instruments, Xcode and the simulator and restarting again. Thanks!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T02:55:29.450

使用仪器的荣誉。

首先，您应该直接在 init/dealloc 中使用 iVar。

其次，是自己综合，还是自己实现setter？

另外，您是在运行调试代码还是发布优化代码？

现在，解释我为什么用更多问题回答你的问题。

如果你自己合成它（即，声明你自己的实例变量，你还必须将它声明为__weak。如果你让编译器来做它，它会正确处理它。

现在，您显然正在使用 ARC。因此，编译器将自动添加代码来执行手动引用计数（其中一些可能会被优化器稍后删除）。现在，我不会假装自己是编译器自动创建的专家，但它会非常接近以下内容。

以一个基本任务为例...

```
- (void)setContainer(Container*)container {
    _container = container;
} 
```

当编译器完成注入其 ARC 代码时，这将类似于（假设 _container 未声明为 __weak）...

```
// Converted by ARC -- so it's MRC
- (void)setContainer(Container*)container {
    [container retain];
    Container *oldContainer = _container;
    _container = [container retain];
    [oldContainer release];
    [container release];
} 
```

现在，让我们更进一步，假设 _container 是 __weak，我们会得到这样的东西......

```
- (void)setContainer(Container*)container {
    [container retain]
    Container *oldContainer = [_container retain];
    objc_storeWeak(&_container, container);
    [oldContainer release];
    [container release];
} 
```

现在，objc_storeStrong 是分配给强变量的序列，因此很明显它适合上面的代码。

另外，请注意，编译器在添加代码方面非常明智。优化器非常激进，可以删除大多数明显不需要的保留/释放对。因此，在大多数情况下，您会在函数中看到不同的保留/释放语义，具体取决于您构建的是调试还是发布。

但是，一般来说，您必须期望在任何参数上至少获得一个保留，除非指定为 __unsafe_unretained。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T02:34:33.923

您应该收到一条`objc_storeStrong`消息，但不会发送到容器属性。它被发送到您的 arg 是因为局部变量会自动传递强并保留（如果未指定弱），并在分配时保留。当您的方法返回时，arc 会自动为您释放 arg。

# regex - Emacs 正则表达式加入行，也抓住换行符

> ID：11804920
> 
> 赞同：2
> 
> 时间：2012-08-04T00:29:56.907
> 
> 标签：regex, emacs

获取“行尾的等号 ( `=$`)，**加上**紧随其后的“换行符””的正则表达式语法是什么？

我的文本格式错误（真的坏了），如下所示：

```
Tiens, encore du HTML, batard rouge, et un charact=C3=A8re accentu=C3=A9, P=
=C3=80F 
```

（每一行都以 = 结尾）所以我想抓住的是字面上的

```
"=
" 
```

我用下面粘贴的函数处理它。

但我也想加入这些行，即删除换行符，但我无法`M-x regexp-builder`突出显示最后一个“=”符号***和****后面的换行符*，以便我可以用空字符串“”替换它并因此加入线..？

```
(setq entities
  '(("=C3=A9" "é")
    ("=C3=89" "É")
    ("=C3=A8" "è")
    ("=C3=88" "È")
    ("=C3=A7" "ç")
    ("=C3=87" "Ç")
    ("=C3=A0" "à")
    ("=C3=80" "À")
    ("=C3=B9" "ù")
    ("=C3=99" "Ù")
    ("=C3=AA" "ê")
    ("=C3=8A" "Ê")
    ("=C3=BB" "û")
    ("=C3=9B" "Û")
    ("=C3=AB" "ë")
    ("=C3=8B" "Ë")
    ("=C3=BC" "ü")
    ("=C3=9C" "Ü")
    ("=20" "")
    ("=3D\"" "=\"")
    ("=$" "")))

(defun px-decode-string (string entities)
  "decode a string against a list of entities / chars pairs."
  (setq i 0)
  (while (< i (length entities))
    (setq my-operand (format "%s" (car (car (nthcdr i entities)))))
    (setq my-char (format "%s" (car (cdr (car (nthcdr i entities))))))
    (setq string (replace-regexp-in-string my-operand my-char string 't))
    (setq i (1+ i))
    )
  (format "%s" string)) 
```

（alist 是 a`setq`而不是 a`defvar`仅用于测试目的）

测试：

```
(px-decode-string "Tiens, encore du HTML, batard rouge, et un charact=C3=A8re accentu=C3=A9, P=
=C3=80F!
" entities) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T02:08:47.603

在字符串文字中，您可以使用“\n”而不是“$”来匹配换行符。

交互式地，例如`query-replace-regexp`，使用`C-q C-j`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T02:08:30.457

好吧，没关系，我找到了：`=\n`

# python - Flask-Admin +（Flask-Login 和/或 Flask-Principal）

> ID：11804922
> 
> 赞同：11
> 
> 时间：2012-08-04T00:30:54.727
> 
> 标签：python, plugins, import, flask

身份验证和授权可以通过*Flask-Login*和*Flask-Principal*插件集成到 Flask 中。（或者也可能通过 Flask-Security 插件。）

但是：*Flask-* Admin——另一个提供后端仪表板的插件——不是注册的蓝图……而且，我相信（据我所知），Flask-Login 和 Flask-Principal 使用的装饰器——和否则用户访问渲染视图所必需的......这些装饰器仅对作为注册蓝图一部分的视图进行操作。

两个问题：

1) 如何在我的应用程序中将 Flask-Admin 注册为蓝图，和/或启用 Flask-Login 和/或 Flask-Principal 装饰器来保护与 Flask-Admin 关联的视图？

2) 为什么 Flask-Login 和 Flask-Principal 仅适用于我的应用程序“本机”一部分的对象......而不是从插件导入的对象（例如，“Admin”对象）？我该如何解决这个问题......如果我确实正确地感知它？

我认为这是问题所在，因为我可以毫不费力地为我的应用程序的主索引页面创建受保护的视图......或任何其他具有位于蓝图中的视图的页面。我似乎无法为 Flask-Admin 索引页面（同样没有蓝图）这样做。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-04T01:38:36.803

Flask-Admin 提供了另一种提供身份验证的方式 - 您只需子类化`AdminIndex`和`BaseIndex`视图（或视图，`contrib`如果您只需要它们）并实现该`is_accessible`方法。有关更多详细信息，请参阅[文档](http://flask-admin.readthedocs.org/en/latest/quickstart/#authentication)。存储库中还提供了[一个示例。](https://github.com/mrjoes/flask-admin/blob/fe6f14e6b7606931d20925a96b4de7cff11447b9/examples/auth/app.py)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-07T19:11:08.423

如何将 Flask-Admin 与 Flask-Principal 一起使用的简单示例

```
from functools import partial
from flask.ext.admin import Admin as BaseAdmin, AdminIndexView
from flask.ext.principal import Permission, identity_loaded, Need
from flask.ext.security import current_user

PartnerAccessNeed = partial(Need, 'access')

class PartnerAccessPermission(Permission):
    def __init__(self, partner_id):
        need = PartnerAccessNeed(partner_id)
        super(PartnerAccessPermission, self).__init__(need)

@identity_loaded.connect
def on_post_identity_loaded(sender, identity):  
    if hasattr(current_user, 'partner'):
        identity.provides.add(PartnerAccessNeed(current_user.partner.id))

class PartnerAdminIndexView(AdminIndexView):

    def __init__(self, partner_id, *args, **kwargs):
        self.partner_id = partner_id
        super(PartnerAdminIndexView, self).__init__(*args, **kwargs)

    def is_accessible(self):

        if current_user.is_anonymous():
            return redirect(url_for_security('login'))

        if not current_user.is_partner():
            return False

        permission = PartnerAccessPermission(self.partner_id)

        if permission.can():    
            return True

        return False

class PartnerAdmin(BaseAdmin):
    def __init__(self, partner_id, endpoint, name, subdomain, *args, **kwargs):

        index = PartnerAdminIndexView(name=name, 
                                      endpoint=endpoint,
                                      url='/dashboard',
                                      partner_id=partner_id)

        super(PartnerAdmin, self).__init__(base_template='mcnm/master.html', index_view=index, subdomain=subdomain) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-16T22:56:54.380

这个[存储库](https://github.com/briancappello/flask-react-spa)是一个很好的例子，说明了[flask-login](https://github.com/maxcountryman/flask-login)和[flask-security](https://github.com/mattupstate/flask-security)如何与 flask-admin 连接。

在[这篇 reddit 帖子](https://www.reddit.com/r/flask/comments/7tr82o/example_integrating_flask_admin_into_flask_webapp/)中，样板的作者简要描述了实现逻辑。

# linux - 什么是非阻塞信号量？

> ID：11804924
> 
> 赞同：6
> 
> 时间：2012-08-04T00:31:24.527
> 
> 标签：linux, multithreading, concurrency, mutex, semaphore

似乎是一个矛盾，因为信号量应该阻止运行。

[互联网搜索没有显示出任何有用的信息来定义这意味着什么。]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-04T00:38:50.403

如果信号量的值为 0，对它的向下操作将阻塞，直到有人释放资源并增加信号量。

如果资源不可用，非阻塞信号量不会阻塞关闭操作，而是产生错误。如果程序立即需要该资源或不暂停执行，并且如果资源不可用，则程序逻辑可以执行其他操作，这可能很有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-04T00:38:34.460

非阻塞信号量通常是指允许您尝试在*不阻塞*的情况下获取的信号量。如果信号量不能被“锁定”，那么它会失败但不会阻塞。如果它可以被锁定，它将锁定它并返回true（它被锁定）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-04T10:19:55.303

例如，相关的等待操作`WaitForSingleObject()`允许指定超时值*dwMilliseconds*。如果将此参数设置为`0`调用的结果将始终立即返回。这样就可以在不阻塞的情况下测试信号量的状态。

# selenium - 有没有办法使用 Selenium 的网络驱动程序单击图像地图中的区域？

> ID：11804926
> 
> 赞同：4
> 
> 时间：2012-08-04T00:32:13.537
> 
> 标签：selenium

我是 Selenium 的新手，我正在尝试单击图像地图的区域。

我的图像地图有两个区域。第一个区域触发JS；第二个区域充当常规链接。

我尝试了以下方法：

*   单击由于被区域阻止而失败的图像（即“区域元素将收到点击”）

    ```
    driver.find_element(:css, '.foo img').click 
    ```

*   单击因相同原因而失败的区域（即“html 元素将收到点击”）

    ```
    driver.find_element(:css, '.foo area').click 
    ```

*   移动鼠标（到两个区域）并执行单击，执行单击，但似乎不会触发图像映射。单击后它在任何一行都失败。

    ```
    driver.action.move_to(driver.find_element(:css, '.foo img'), 10, 10).click 
    ```

如果我需要提供更多信息，请告诉我。任何想法，将不胜感激。

旁注...我还没有尝试使用 jQuery 来触发点击。我希望找到一个纯硒解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T02:07:47.463

这可能是 Selenium webdriver 的问题。单击区域元素似乎存在一个已知错误。

从他们的论坛：[https ://groups.google.com/forum/?fromgroups#!topic/selenium-developer-activity/dTSvAm9ysVk](https://groups.google.com/forum/?fromgroups#!topic/selenium-developer-activity/dTSvAm9ysVk)

# c# - 如何从字符串运行代码？

> ID：11804927
> 
> 赞同：1
> 
> 时间：2012-08-04T00:32:16.617
> 
> 标签：c#, dynamic-code

我的程序中有一个文本框。在文本框中，您可以编写要运行的函数/方法的名称以及传递参数。如果我的案例被填充，这一切都被解析并通过一个大的开关块我为那个特定案例的代码，以及传递参数。

但是我真正想做的是**使用stringbuilder构建源代码然后运行它！**

这是使用我的 stringbuilder 构建的源代码示例。

```
 outlook outlooken = new outlook(appNwindow); 
```

和

```
 outlooken.createNewEmail(scriptarray[i][1],scriptarray[i][2],
  scriptarray[i][3],scriptarray[i][4]); 
```

使用 stringbuilder 创建字符串完全没有问题。但是我该如何运行它们呢？

我已经进行了很多测试，并设法将所有东西都准备好，但我认为我遗漏了一些东西，因为我的代码总是会产生错误......

**这是我的源代码**

```
 CodeDomProvider myCodeDomeProvider = CodeDomProvider.CreateProvider("CSharp");
 String [] referenceAssemblies = {"System.dll"};
 //  string myAssemblyName = "myAssembly.dll";
 CompilerParameters myCompilerparameters = 
 new CompilerParameters(referenceAssemblies);

        myCompilerparameters.GenerateExecutable = false;
        myCompilerparameters.GenerateInMemory = true;

  //*** Here's the sourcecode it want to compile
  string[] arr1 = new string[] { "outlook outlooken = new outlook(appNwindow);","outlooken.createNewEmail(scriptarray[i][1],scriptarray[i][2],scriptarray[i[3],scriptarray[i][4]);"};

        CompilerResults myResults = myCodeDomeProvider.CompileAssemblyFromSource(myCompilerparameters, arr1);
        string objectname = "testet";
        string method = "createNewEmail";
        object[] args = new object[2];

        args[0] = "to";
        args[1] = "CC";

        if (myResults.Errors.HasErrors)

         {
            StringBuilder errors = new StringBuilder("Compiler Errors :\r\n");
            foreach (CompilerError error in myResults.Errors)
            {
            errors.AppendFormat("Line {0},{1}\t: {2}\n",
            error.Line, error.Column, error.ErrorText);
            }

            throw new Exception(errors.ToString());
            }
            else
            {
            Assembly assem = myResults.CompiledAssembly;
            object instance = null;

            Type type = assem.GetType(objectname);
            MethodInfo miChk = type.GetMethod(method);

            if (!miChk.IsStatic)
            {
            instance = assem.CreateInstance(objectname);
            type = instance.GetType();
            }

            MethodInfo mi = type.GetMethod(method);

            mi.Invoke(instance, args);
            } 
```

这些是我在运行它时遇到的错误：

附加信息：编译器错误：

第 1,1 行：命名空间不能直接包含字段或方法等成员

第 1,25 行：预期的类、委托、枚举、接口或结构

第 1,1 行：命名空间不能直接包含字段或方法等成员

第 1,41 行：预期标识符

第 1,59 行：预期标识符

第 1,77 行：预期标识符

第 1,95 行：需要标识符

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T00:33:53.747

CodeDom 不会编译和执行任意语句。您编译的代码必须是有效的 C# 代码，就像您从源代码执行 C# 文件一样。

这意味着您需要将语句包装到命名空间 + 类中，并将其放在类中的方法（可能是静态的）中。

基本上，将输入想象成您正在编写一个普通的 C# 文件并使用编译器编译 .cs 文件 - 您需要在输入中使用相同的“文本”。

# php - 试图 rand() 不重复

> ID：11804935
> 
> 赞同：-1
> 
> 时间：2012-08-04T00:33:26.183
> 
> 标签：php, random

好吧，我对 rand() 有用；我需要从 1 到 x 数量 4 次，并确保该值不会返回。

这是我的代码：

```
 $Count = 15;
 $secondstage = '';
 $arrayindex = '';
 for($i=1; $i<5; $i++){
    $arrayindex = rand(1,$Count);
    if($secondstage == $arrayindex){
        for($b=1; $arrayindex == $secondstage; $b++){
            $arrayindex = rand(1,$Count);
        }
    }
    $secondstage = $arrayindex;
    echo $secondstage;
    echo '<br>';
 } 
```

我在这里有一些逻辑错误吗？我想也许使用 while 但 for 也应该工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:38:12.663

所以基本上你想要4个1到15之间的随机非重复数字，包括在内？您为此使用了太多代码。一个更简单的版本：

```
$numbers = array();
do {
   $possible = rand(1,15);
   if (!isset($numbers[$possible])) {
      $numbers[$possible] = true;
   }
} while (count($numbers) < 4);
print_r(array_keys($numbers)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T00:48:32.677

我会将已经随机的数字放入一个数组中：

```
<?php 
$count = 15;
$cArray = array();
for($i=1; $i<5; $i++){
    $rand = rand(1, $count);
    if(in_array($rand, $cArray)){
        $i--;
    } else {
        $cArray[] = $rand;
        echo $rand . "<br>";
    }
   }
?> 
```

我检查了一下，这段代码在本地服务器上工作:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-04T02:43:03.050

```
$count = 15;
$values = range(1, $count);
shuffle($values);
$values = array_slice($values, 0, 4); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-04T00:37:30.217

你可以这样做（这会给你一个带有原始数组随机键的数组）：

```
<?php

$array = array();
$max = 100;
$numberValuesWanted = 5;

for($i = 0; $i < $max; $i++)
  $array[] = $i;

$randomKeys = array_rand($array, $numberValuesWanted);

print_r($randomKeys); 
```

# gwt - gwt 通知具体客户

> ID：11804937
> 
> 赞同：0
> 
> 时间：2012-08-04T00:33:47.030
> 
> 标签：gwt, client, notify

嗨，

我实际上在我的应用程序中使用 gwt，但可能不是与 gwt 相关的问题：我有一些用户可以向其他用户（连接或未连接）发送消息，我想通知收件人（并且只有这个收件人）他收到了一条消息，我想知道最好的方法吗？

欢迎任何想法。

我喜欢彗星方法，但我不确定我是否可以处理只有接收者应该被通知的约束（而不是其他连接的用户）

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T12:17:55.383

这是一个老问题，对不起话题...

首先，我假设 GWT 应用程序是 Web 应用程序（客户端/服务器架构）

AFAIK，有两种选择：

Comet 方法更像是推送方法，服务器为每个客户端保持连接，因此当用户向服务器发送通知时，服务器可以将其分派给相关的客户端。

另一种方法是轮询服务器，它不知道任何客户端，它将数据提供给请求的任何人，因此所有客户端只需反复请求新数据。您的服务器只需要保存数据并在相应的客户端请求时交付它们。

所以一切都取决于你需要什么......

# php - 客户端系统详细信息

> ID：11804945
> 
> 赞同：4
> 
> 时间：2012-08-04T00:35:29.410
> 
> 标签：php, javascript

是否有获取客户端系统详细信息，如 cpu 速度、RAM 详细信息等？javasctipt 有这个能力吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-04T00:37:06.510

不，由于安全问题，您不能在 javascript 中执行此操作。您可以获得的是系统名称和版本、浏览器名称、屏幕分辨率等，但不是硬件规格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-04T00:52:48.277

不，使用 javascript 是不可能的。

但是您可以做的是使用[java applet](http://en.wikipedia.org/wiki/Java_applet)甚至是[flex](http://flex.org)应用程序。为此，用户必须通过 java/flex 自动提出的简单“允许”或“拒绝”访问对话框授予您访问其计算机详细信息的权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-04T00:39:21.160

这是不可能的。浏览器可以访问该信息，但遗憾的是您无权访问该浏览器。

# python - Django：自动创建用户配置文件时，它设置为什么？

> ID：11804962
> 
> 赞同：1
> 
> 时间：2012-08-04T00:38:55.970
> 
> 标签：python, django, authentication, django-models, django-users

我有一个用户配置文件，它是在保存用户后自动创建的：

```
def create_user_info(sender, instance, created, **kwargs):
    if created:
        UserInfo.objects.create(user=instance)

post_save.connect(create_user_info, sender=User)

class UserInfo(models.Model):
    user = models.OneToOneField(User)
    pen_name = models.CharField(max_length=30)
    activated = models.BooleanField()
    def __unicode__(self):
        return self.email + '-' + self.pen_name 
```

当我使用该函数创建用户对象时`User.objects.create_user`，用户配置文件中的变量/字段会发生什么。除非我弄错了，否则它们不能为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T01:02:49.973

他们一开始是空的。`UserInfo`您可以像任何其他模型一样通过操作来填写字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T01:05:52.827

`User Profile`与任何其他模型没有什么不同。因此，如果您将其保存到数据库而不指定所有字段，它的行为与任何其他模型的行为完全相同。它将有空字段。
当然，在您的情况下，由于您不允许`blank=True, null=True`，这将引发错误并要求您指定字段。

# php - 在表单中对齐 php div

> ID：11804963
> 
> 赞同：1
> 
> 时间：2012-08-04T00:39:05.293
> 
> 标签：php, css, html

我有一个 php 表单和 css 代码。我正在尝试修改它，以便消息字段向右。我试图将名称和电子邮件字段放在一个 div 中，将消息和提交字段放在另一个 div 中，然后将这两个放在第三个 div 中，但我无法让它工作，我得到的最好的是将所有字段移动到对，但这不是我想要的。我不知道 php，所以不确定它是否应该像在 html 中那样工作。

我已经尽我所能定制了它，但水平对齐 div 是我的问题。

您可以在下图中看到我想要实现的目标。

![在此处输入图像描述](../Images/ef5b8525354791f7b9d3d3549bfe46c0.png)

我试图以正确的方式将代码放在这里，但我做不到。对不起，我对所有这些东西都很陌生。所以下面有一个链接，您可以从中下载文件。

我一直在使用的文件是：“contactform.php”和“contact.css”

[php 和 css 文件](http://dl.dropbox.com/u/26373038/simple-contact-form-1-2.zip)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T00:49:52.513

首先我们需要增加字段集的宽度：

```
#contactus fieldset {
    width: 580px;
} 
```

现在创建两个 div。一个围绕名称和电子邮件字段，一个围绕消息和提交。

`float: left;`最后使用或设置样式属性（或更好地使用 classNames）`float: right;`。

而已。希望能帮助到你？！

# java - 使用 Spring 表单的验证错误

> ID：11804968
> 
> 赞同：0
> 
> 时间：2012-08-04T00:39:32.080
> 
> 标签：java, spring, validation, jsp, controller

我正在尝试使用 sf:form 来持久化一个实体。

这是jsp：

```
<sf:form method="POST" action="${pageContext.request.contextPath}/addStudent" modelAttribute="student">
<fieldset>
<table>
<tr>
    <th><sf:label path="nb">Number:</sf:label></th>
    <td><sf:input type="text" path="nb"/><br/>
    <sf:errors path="nb"></sf:errors>
</tr>
......
</table>  
</fieldset> 
```

实体中的属性是这样的：

```
@NotNull(message="not null")
@Size(min=5, max=10, message="length min 5")
@Column(name="NB", unique=true)
private String nb; 
```

控制器：

```
@RequestMapping(value="/addStudent", method=RequestMethod.POST)
public ModelAndView addStudent(HttpServletRequest request, @ModelAttribute("student") @Valid Student student, BindingResult bR){

    ModelAndView mav = new ModelAndView("students");
    if(bR.hasErrors()){
        return mav;
    }
    studentService.saveStudent(student);
    return mav;
} 
```

好吧，当我将 nb 字段留空或条目太短时，我会收到验证错误。我的问题是jsp中没有显示错误但是抛出了异常：

```
List of constraint violations:[
ConstraintViolationImpl{interpolatedMessage='length min 5', propertyPath=nb, rootBeanClass=class i.have.serious.problem.Student, messageTemplate='length min 5'}  
javax.validation.ConstraintViolationException: Validation failed for classes [i.have.serious.problem.Student] during persist time for groups [javax.validation.groups.Default, ] 
```

也许我错过了一些东西..我感谢任何提示或帮助，谢谢

**-----------------------------**已解决**-------- ---------------**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T01:21:49.000

确实……我错过了一些东西->如果类路径上存在JSR-303 Provider，则支持使用@Valid 验证@Controller 输入。

```
xmlns:mvc="http://www.springframework.org/schema/mvc"
http://www.springframework.org/schema/mvc 
http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

<mvc:annotation-driven /> 
```

现在工作正常:) .. 感谢您的关心！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T01:02:13.053

您正在该方法中创建一个新的 ModelAndView，这可能不会将 bindingResult 带回视图。

您能否改为将`ModelAndView`其作为附加参数，看看是否可行：

```
@RequestMapping(value="/addStudent", method=RequestMethod.POST)
public ModelAndView neuStudent(HttpServletRequest request, @ModelAttribute("student") @Valid Student student, BindingResult bR, ModelAndView mav){

    mav.setViewName("students");
    if(bR.hasErrors()){
        return mav;
    }
    studentService.saveStudent(student);
    return mav;
} 
```

# jquery - 检测页内图像链接并使用 jQuery 显示它们

> ID：11804975
> 
> 赞同：0
> 
> 时间：2012-08-04T00:40:13.067
> 
> 标签：jquery

强制 jQuery 检测 post-content 类中的元素是否是图像然后在页面中显示该图像的最佳方法是什么。我已经用 BBCode 做过很多次了，但想让用户更容易。只需允许他们粘贴链接，系统就会从那里开始。

```
 $comments = $posts_row['post_content'];

            $m = preg_match_all( "/(http|https)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/", $comment, $match);

            if ($m) {
                 $links = $match[0];
                 foreach($links as $link) {
                 $extension = strtolower(trim(@end(explode(".",$link))));
                 switch($extension) {
                 case 'gif':
                 case 'png':
                 case 'jpg':
                 case 'jpeg':
                   $comment = str_replace($link, '<img src="'.$link.'">', $comment);       
                 break;
                 default:
                 $comment = str_replace($link, '<a rel="nofollow" href="'.$link.'">'.$link.'</a>', $comment);
                 break;
                 }
              }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T00:48:41.877

试试这个：

```
$('.post-content').find('img').show() 
```

# ruby-on-rails - 2012-08-03 20:24:48 UTC:Time 的未定义方法“completed_at”

> ID：11804977
> 
> 赞同：1
> 
> 时间：2012-08-04T00:40:51.460
> 
> 标签：ruby-on-rails, ruby, controller, activesupport

这是错误消息及其应用程序跟踪：

```
NoMethodError in Shopping::OrdersController#index

(the root of error is the application directory.)
undefined method `completed_at' for 2012-08-03 20:24:48 UTC:Time

app/models/coupon.rb:44:in `eligible?'
app/models/coupon.rb:40:in `qualified?'
app/models/coupon.rb:34:in `value'
app/models/order.rb:276:in `coupon_amount'
app/models/order.rb:260:in `find_total'
app/models/order.rb:284:in `credited_total'
app/controllers/shopping/orders_controller.rb:100:in `form_info'
app/controllers/shopping/orders_controller.rb:21:in `index' 
```

但是，当我选择查看完整跟踪时，第一行是

```
activesupport (3.2.7) lib/active_support/time_with_zone.rb:328:in `method_missing' 
```

我不确定是控制器的问题还是 active_support 的问题。有人知道怎么修这个东西吗？谢谢！

在优惠券.rb

```
def qualified?(item_prices, order, at = nil)
  at ||= order.completed_at || Time.zone.now
  item_prices.sum > minimum_value && eligible?(at)
end

def eligible?(order, at = nil)
  at ||= order.completed_at || Time.zone.now
  starts_at <= at && expires_at >= at
end 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T01:45:14.360

在第 44 行，`coupon.rb`你们正在调用`completed_at`一个`Time`对象。我不知道这是您的代码中的哪一行，但这应该足以让您通过。

# winapi - 唯一区分多个摄像头 [dshow, directx, win32api]

> ID：11804978
> 
> 赞同：4
> 
> 时间：2012-08-04T00:41:02.613
> 
> 标签：winapi, camera, directshow

是否有可靠的方法以编程方式区分多个相机？我枚举 CLSID_VideoInputDeviceCategory，然后在每个 IMoniker 上获取显示名称。我发现*有些*相机将它们插入不同的 USB 插座会返回不同的唯一 ID，也就是说，插入不同插座的同一个相机被我的程序视为在不同时间连接的多个相机。插入不同 USB 插座的其他摄像头使用相同的 GetDisplayName 进行标识。最重要的是，我有两个相同的相机（Microsoft LifeCam HD-3000），当我将不同的硬件插入同一个插座时，我无法区分插入的是哪个硬件。

那么，如果我将多个相同的相机插入同一个 USB 端口，有没有办法真正区分它们？以及相关的反向问题：当我将同一台相机插入不同的 USB 插座时，如何识别它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T07:09:48.983

根据 USB 设备序列号的可用性，将其重新插入不同的端口将为您提供相同或不同的绰号显示名称。仍然绰号显示名称是您能做的最好的。在此处查看有关此主题的更多信息：[如何正确识别视频设备？](http://social.msdn.microsoft.com/Forums/en-US/windowsdirectshowdevelopment/thread/b9b19705-6805-4625-97dd-ac357f0ed394).

# mysql - 我可以按功能对我的自定义 sql 进行排序吗？

> ID：11804984
> 
> 赞同：1
> 
> 时间：2012-08-04T00:41:47.227
> 
> 标签：mysql, sql-order-by

我正在使用 MySQL，我查看了一些 SQL 教程，我看到这是一个名为 的语句，`ORDER BY`通常是`ORDER BY`一个列，带有`AESC`or `DESC`。但这是否可以`ORDER`通过不同的排序算法来处理数据？

例如，我的数据库中有以下值：

```
`id`,`name`,`notice_day` 
```

我想先`sort`有今天的那一天，然后是靠近今天的那一天，然后，明天....巴巴巴，在整理完今天、未来、昨天和到目前为止的日子之后......这里是例如，今天的 assame 是`1/1/2012`

```
`1`, `peter`, `1/1/2012`
`2`, `tom`, `31/12/2011`
`3`, `mary`, `1/2/2012`
`4`, `steve`, `1/1/2011`
`5`, `bill`, `1/4/2012` 
```

我想要的排序顺序在这里：

```
`1`, `peter`, `1/1/2012`

`3`, `mary`, `1/2/2012`

`5`, `bill`, `1/4/2012`

`2`, `tom`, `31/12/2011`

`4`, `steve`, `1/1/2011` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T07:47:44.840

如果notice_day 是今天或将来，那么升序，如果notice_day 是过去，降序？可以做类似的事情：

`select * from my_table order by if(notice_day >= date(now()), notice_day, 9999) asc, notice_day desc`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:47:19.490

```
SELECT * FROM ##### ORDER BY CONVERT(DateTime, EventDate,101)  DESC 
```

mySQL 不是我的强项，但我相信以上内容应该可行。

# android - ListView 中 TextView 中的图像（表情符号）

> ID：11804987
> 
> 赞同：0
> 
> 时间：2012-08-04T00:42:56.960
> 
> 标签：android, image, listview, textview, adapter

所以我一直在寻找这个，尝试了很多东西，但它似乎不起作用......我最近开始为 Android 编程，我正在为一个聊天应用程序网站。

现在我想在应用程序中添加笑脸/表情符号，通过搜索我找到了这些网站：http: [//blog.stylingandroid.com/archives/177](http://blog.stylingandroid.com/archives/177) http://www.coderanch.com /t/488673/Android/Mobile/styling-items-ListView

我的代码：

```
private void updateList()
{
    ListView list = this.getListView();

    if(!parsedData.isEmpty())
    {
        ArrayAdapter<String> adapter = new MyAdapter(this, R.layout.list_item, parsedData);

    list.setAdapter(adapter);
    list.setTextFilterEnabled(true);
    }
}

class MyAdapter extends ArrayAdapter<String>
{
    ArrayList<String> mStrings;
    LayoutInflater mInflater; 

    public MyAdapter(Context context, int textViewResourceId, ArrayList<String> parsedData)
    {
        super(context, textViewResourceId, parsedData);
        mStrings = parsedData;
        mInflater = (LayoutInflater) HopeloosChatActivity.this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent)
    {
        if (convertView == null)
        {
            convertView = mInflater.inflate(R.layout.main, null, false);  
        }

        TextView text = (TextView)convertView.findViewById(R.id.TextView);
        SpannableStringBuilder ssb = new SpannableStringBuilder("Test  ");
        Bitmap emoticon = BitmapFactory.decodeResource( getResources(), R.drawable.icon);
        ssb.setSpan(new ImageSpan(emoticon), 5, 6, Spannable.SPAN_INCLUSIVE_INCLUSIVE); 
        text.setText(ssb, BufferType.SPANNABLE);

        return convertView;
    }
} 
```

我确实使用 setContentView(R.layout.main); 在 OnCreate() 方法中

我的 main.xml 包含 ListView 部分：

`<ListView android:id="@android:id/list" android:layout_width="match_parent" android:layout_height="0dip" android:layout_weight="1" />`

list_item.xml 包含 TextView：

```
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/TextView"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:padding="10dp"
android:textSize="16sp"
android:autoLink="web"
android:linksClickable="true" >
</Textview> 
```

当我运行我的代码时，我得到一个空指针，因为文本为空，我有点卡住了。有人能指出我正确的方向或帮助我吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T05:29:03.583

首先取一个哈希映射，如下所示：

```
private static final HashMap<String, Integer> emoticons = new HashMap<String, Integer>();
static {
  emoticons.put(":)", R.drawable.smilie1);} 
```

其次，编写将笑脸文字转换为图像的函数

```
// Get image for each text smiles
public static Spannable getSmiledText(Context context, String text) {
      SpannableStringBuilder builder = new SpannableStringBuilder(text);
      int index;
      for (index = 0; index < builder.length(); index++) {
        for (Entry<String, Integer> entry : emoticons.entrySet()) {
          int length = entry.getKey().length();
          if (index + length > builder.length())
            continue;
          if (builder.subSequence(index, index + length).toString().equals(entry.getKey())) {
            builder.setSpan(new ImageSpan(context, entry.getValue()), index, index + length,
                Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
            index += length - 1;
            break;
          }
        }
      }
      return builder;
    } 
```

第三，当您发送文本时，将所有文本变为红色，如果它包含“:)”，则调用如下函数

```
chattext.(getSmiledText(getApplicationContext(),":)")); 
```

希望能帮助到你！如果您有任何疑问，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:46:14.717

您正在`convertView`使用充气`R.layout.main`：

```
convertView = mInflater.inflate(R.layout.main, null, false); 
```

这是不对的；你`ListView`每次都在夸大你的布局。改用这个：

```
convertView = mInflater.inflate(R.layout.list_item, null, false); 
```

~~此外，你`TextView`应该被包裹在一个布局中，或者`convertView`可能是它`TextView`本身，并且`findViewById(...)`不会在它上面工作。~~实际上，感谢@Jens，这个划掉的文本不适用；`findViewById`在您正在寻找的同一对象上使用仍然有效。

# r - adehabitatHS compana 测试返回 lambda = NaN？

> ID：11804994
> 
> 赞同：1
> 
> 时间：2012-08-04T00:44:15.827
> 
> 标签：r, statistics

我使用 R 包**adehabitatHS**和函数得到了不好的测试结果`compana()`。

compana 测试将栖息地的可用性与动物的栖息地使用情况进行比较。该测试执行成分分析，产生 Wilk 的 lambda 和 p 值。

我正在对满足 compana 测试的规定格式和内容要求的经验数据（16 种动物，8 个栖息地类别）进行测试，但测试返回：`lambda = NaN, p-value = 1.0`.

我检查了我的数据以了解 NaN 的标准原因，我没有发现任何问题，例如缺失值 ( `NA`s)、负比例或行总和 > 100%。此外，当我使用完整数据集（16 行，8 列）时会出现错误，但当我使用子集（缺少一列）时不会出现错误。排除哪些列似乎并不重要，只要包含 7 个或更少。

我的数据的详细信息如下。任何帮助或建议将不胜感激。

平台：OSX 10.7.4 (Lion) R 版本：R 2.15.1 GUI 1.52 Leopard build 64-bit (6188)

代码：

使用的栖息地比例（矩阵）：

```
used.m
    Atr   Cre    DW  Dist  Gra   Mar   Mes   Opn
1   2.76 19.31  4.14 17.24 0.00 28.28  0.00  0.00
2  15.12  1.16  3.49  5.81 2.33 32.56 25.58  3.49
3  57.35 13.24  1.47  0.00 6.62  0.00  8.09 12.50
4  41.18  0.98  2.94  0.00 3.92  0.00 29.41 18.63
5   9.52 17.01 23.13  0.00 0.00 37.41  3.40  0.00
6   2.54 67.01  0.00  0.51 0.51  6.09  3.05  0.00
7  10.45 15.67  5.22  5.97 0.00  0.00 33.58 10.45
8   6.34  0.00  0.00  4.23 0.00  0.00  0.00 21.83
9   0.66 18.54  1.32 39.74 0.00  8.61  2.65  0.66
10 20.75  0.00  0.00  0.00 0.00  0.00  0.00 49.06
11 20.14 18.06 12.50  8.33 0.00  5.56 22.22  9.72
12  0.00  0.00  0.00 58.04 0.00  0.00 13.99  0.00
13 44.23  4.81  0.00  0.00 0.00  0.00 28.85 19.23
14 13.04  2.61  1.74  2.61 0.00 19.13  6.09 25.22
15 35.96  3.51  0.00  2.63 0.00  1.75 25.44  0.88
16  0.00  0.00  0.00 35.14 0.00  7.21  0.00  8.11 
```

可用栖息地的比例（矩阵）：

```
avail.m
    Atr   Cre    DW  Dist   Gra   Mar   Mes   Opn
1   1.11 39.18 15.50  0.29  0.00 30.18  4.15  3.43
2  18.96  1.02  0.87  7.40  4.36 37.80  6.17 10.56
3  65.75  3.85  0.57  0.00 12.36  0.00  9.97  3.43
4  20.52  5.44  2.01  0.00  0.08  0.00 10.99 44.22
5  11.16 43.55 10.34  0.00  0.00 18.11  9.60  3.17
6  25.24  9.88  2.77  2.44  4.95 12.90 11.44  2.19
7   5.47 21.13  6.67  0.57  0.00  0.10 30.73  9.59
8   6.23  0.00  0.00  4.85  0.00  0.00  0.00  5.72
9   0.85  1.97  0.09 33.52  0.00  5.58  1.73  0.84
10 18.97  0.00  0.00  0.00  0.00  0.00  0.00  5.59
11  0.16 44.41 19.16  3.53  0.00  1.28 21.65  4.13
12  6.67  3.89  0.31 13.63  0.00  0.00 20.56  0.00
13 21.40  2.38  2.66  0.00  0.00  0.00 21.23 46.96
14 42.62  9.36  1.49  3.89  0.43  3.61 20.79  5.80
15 33.32 12.90  4.17  4.09  0.15  3.96 12.32  4.94
16  5.65  0.00  0.00  1.36  0.00  0.59  0.00  9.71 
```

加载 adehabitatHS 包

```
library(adehabitatHS) 
```

对完整数据集（所有行，所有 8 列）运行 compana 测试

```
fulldata.comp <- compana(used.m, avail.m) 
```

检查结果

```
fulldata.comp$test
Lambda      P 
   NaN      1 
```

对部分数据（所有行，第 1-7 列）运行 compana

```
partdata.comp <- compana(used.m[, 1:7], avail.m[, 1:7]) 
```

检查结果

```
partdata.comp$test
   Lambda         P 
 0.3319731 0.6280000 
```

# c# - 如何合并除对象类型外相同的方法

> ID：11804995
> 
> 赞同：0
> 
> 时间：2012-08-04T00:44:17.480
> 
> 标签：c#

除了对象的类型外，我有 7 个方法相同。

这是其中的两个：

1)

```
public MyResult CreateMyResult(MyResult mi, MyVersion myv)
{
    MyVersionEntity myve = _db.MyVersionEntity.Where(r => r.Id == myv.Id).First();
    MyResultEntity mie = new MyResultEntity();
    myve.MyResultEntityAssoc.Add(mie);
    mie = _updateMyResultEntity(mi, mie);
    mi.Id = mie.Id;
    return mi;
} 
```

2)

```
public MyIssue CreateMyIssue(MyIssue mi, MyVersion myv)
{
    MyVersionEntity myve = _db.MyVersionEntity.Where(r => r.Id == myv.Id).First();
    MyIssueEntity mie = new MyIssueEntity();
    myve.MyIssueEntityAssoc.Add(mie);
    mie = _updateMyIssueEntity(mi, mie);
    mi.Id = mie.Id;
    return mi;
} 
```

有没有办法合并所有这些？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T01:34:01.267

使用泛型即

```
public T Create<T>(T mi, MyVersion myv)
{
    MyVersionEntity myve = _db.MyVersionEntity.Where(r => r.Id == myv.Id).First();
    Entity<T> mie = new Entity<T>();
    myve.EntityAssoc<T>.Add(mie);
    mie = _updateEntity<T>(mi, mie);
    mi.Id = mie.Id;
    return mi;
} 
```

像这样称呼它之后

```
 Create<MyResult>(...)
 Create<MyIssue>(...) 
```

# emacs - Emacs - 导航时如何避免回溯光标移动

> ID：11804996
> 
> 赞同：5
> 
> 时间：2012-08-04T00:44:32.140
> 
> 标签：emacs, editor, workflow

多年来我一直在使用 emacs，但我注意到我的一个习惯减慢了我的工作流程。我用“向前”移动命令做了很多“回溯”。

例如，当我多次使用 Mf to 向前跳转一个单词时，它会将我跳到单词的末尾，所以当我到达单词时，我经常试图按 Mb 回到开头这个单词。

当我用 Cs 搜索时也会发生类似的情况，当我找到模式时，光标在匹配模式的末尾，我需要再次按 Mb 才能回到开头。

考虑到我执行此类操作的频率，这会导致工作流程变慢。在某些情况下，使用反向命令（如 back-kill）会有所帮助，但这需要记住更多命令，并且并非适用于所有情况（例如，如果我想从单词的开头开始输入）。

在 emacs 中是否有更好的导航方法来避免这些冗余操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T03:20:05.007

最近我用Ace Jump模式

“什么是王牌跳跃模式？

ace-jump-mode 是一种快速/直接光标定位次要模式。它将在内部创建 N-Branch 搜索树，并在当前视图中使用预定义的键标记所有可能的位置。让您几乎可以直接移动到字符/单词/行。” --emacswiki

有一个视频[http://emacsrocks.com/e10.html](http://emacsrocks.com/e10.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:49:51.050

我用于在单词`C-u` `N` `C-f`或中间进行导航`C-u` `N` `C-b`，其中 N 是我要跳转的字符数。

# hadoop - hadoop 守护进程没有启动

> ID：11804997
> 
> 赞同：1
> 
> 时间：2012-08-04T00:44:33.593
> 
> 标签：hadoop, mapreduce, cloudera

我已经在 linux 集群中安装了 Hadoop。当我尝试通过命令 $bin/start-all.sh 启动服务器时，出现以下错误：

```
mkdir: cannot create directory `/var/log/hadoop/spuri2': Permission denied
chown: cannot access `/var/log/hadoop/spuri2': No such file or directory
/home/spuri2/spring_2012/Hadoop/hadoop/hadoop-1.0.2/bin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-spuri2-namenode.pid: Permission denied
head: cannot open `/var/log/hadoop/spuri2/hadoop-spuri2-namenode-gpu02.cluster.out' for reading: No such file or directory
localhost: /home/spuri2/.bashrc: line 10: /act/Modules/3.2.6/init/bash: No such file or directory
localhost: mkdir: cannot create directory `/var/log/hadoop/spuri2': Permission denied
localhost: chown: cannot access `/var/log/hadoop/spuri2': No such file or directory 
```

我已将 conf/hadoop-env.sh 中的日志目录参数配置为 /tmp 目录，并且我已将 core-site.xml 中的“hadoop.tmp.dir”配置为 /tmp/ 目录。由于我无权访问 /var/log 目录，但 hadoop 守护进程仍在尝试写入 /var/log 目录并失败。

我想知道为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T01:25:25.067

您必须将此目录写入“core.site.xml”文件而不是 hadoop-env.sh

```
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

<!-- Put site-specific property overrides in this file. -->

<configuration>
<property>
  <name>hadoop.tmp.dir</name>
  <value>/Directory_hadoop_user_have_permission/temp/${user.name}</value>
  <description>A base for other temporary directories.</description>
</property>

<property>
  <name>fs.default.name</name>
  <value>hdfs://localhost:54310</value>
  <description>The name of the default file system.  A URI whose
  scheme and authority determine the FileSystem implementation.  The
  uri's scheme determines the config property (fs.SCHEME.impl) naming
  the FileSystem implementation class.  The uri's authority is used to
  determine the host, port, etc. for a filesystem.</description>
</property>

</configuration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T01:29:24.743

简而言之，我遇到了这个问题，因为在大学集群中安装了多个 hadoop。以 root 用户身份安装 hadoop 弄乱了我的本地 hadoop 安装。

Hadoop-daemons 无法启动的原因是它无法写入某些具有 root 权限的文件。我以普通用户的身份运行 Hadoop。出现问题是因为我们大学的系统管理员以 root 用户身份安装了 Hadoop，所以当我开始本地安装 hadoop 时，root 安装配置文件优先于我的本地 hadoop 配置文件。花了很长时间才弄清楚这一点，但在以 root 用户身份卸载 hadoop 后，问题得到了解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T05:15:39.990

我曾经遇到过同样的错误，如果您在配置标签下添加了然后在运行更改为超级用户之前：su - 用户名（这是拥有 hadoop 目录所有权的用户）然后尝试执行 start-all.sh

确保您已在教程中提到的配置标签之间添加了必要的内容：

[http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/](http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/)

# asp.net-mvc-3 - 如何修复不应被 GoogleBot 和其他搜索引擎爬虫抓取的索引页面？

> ID：11804999
> 
> 赞同：0
> 
> 时间：2012-08-04T00:44:58.177
> 
> 标签：asp.net-mvc-3, http-status-code-404, http-redirect, google-crawlers, search-engine-bots

在现有的 .Net MVC3 站点上，我们实现了 URL 类似于 的分页`www.mysite.com/someterm/anotherterm/_p/89/10`，其中 89 是页码，10 是每页的结果数。

不幸的`rel="nofollow"`是，大于 3 的页码链接丢失了，并且这些页面也丢失了`<meta name="robots" content="noindex,nofollow" />`。

问题是谷歌和其他一些搜索引擎现在已经索引了这些页面，并且现在尝试非常频繁地抓取所有这些页面，正如我们发现的那样，这开始对 prod db 服务器产生巨大影响。我们不希望抓取所有额外的数千个页面，只抓取前几个。

我将代码恢复为不包含分页的站点版本，这样我们的数据库服务器现在就不会受到如此严重的打击。因此，虽然搜索引擎会为所有这些页面收到 404 错误，但我想知道这是否是最好的做法，因为过一段时间我会再次介绍分页站点？

我可以将以下内容添加到 web.config 以将所有 404 重定向到主页：

```
 <httpErrors errorMode="Custom">
     <remove statusCode="404"/>
     <error statusCode="404" path="/" responseMode="ExecuteURL"/>
  </httpErrors> 
```

但我认为，对于所有具有分页 URL 参数的页面，这样做将被呈现为“重复内容”。

让那些 404 持续一两个星期然后重新引入寻呼站点是最好的主意吗？

另一种选择可能是释放分页站点，并添加一些代码以拒绝超过 3 个页面的爬虫。建议？

有没有更快的方法将这些页面从索引中取出，这样它们就不会被抓取？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:39:19.310

简单地将页面保留为 404 是行不通的，因为这是永久删除。查看 RFC 2616 超文本传输​​协议 – HTTP/1.1 第 10 章。状态代码定义：

> “请求的资源在服务器上不再可用，并且不知道转发地址。预计这种情况将被视为永久性的。具有链接编辑能力的客户端应该在用户批准后删除对 Request-URI 的引用。如果服务器不知道或无法确定条件是否是永久的，则应该使用状态代码 404（未找到）。除非另有说明，否则此响应是可缓存的。
> 
> 410 响应的主要目的是通过通知接收者资源故意不可用并且服务器所有者希望删除到该资源的远程链接来协助 Web 维护任务。这种事件对于限时促销服务和属于不再在服务器站点工作的个人的资源很常见。没有必要将所有永久不可用的资源标记为“已消失”或将标记保留任意时间——这由服务器所有者自行决定。”</p>

我只是添加了一个新的 ActuionResult 方法：

```
 public ActionResult Http410()
    {
        return new HttpStatusCodeResult(410);
    } 
```

并创建了匹配“__p”的新路由：

```
routes.MapRoute(name: "WholeCountryResultsWithPaging__p", url: "{searchTerm}/__p/{pageNumber}/{pageSize}", defaults: new { controller = "Errors", action = "Http410", pageNumber = UrlParameter.Optional, pageSize = UrlParameter.Optional }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T08:51:58.753

除非万不得已，否则我不会诉诸 404，重复的内容可能会导致您的页面排名下降。我要做的第一件事是创建一个[Google 网站管理员工具](https://www.google.com/webmasters/tools/home?hl=en)帐户并配置您希望它如何抓取您的页面、删除页面、使用哪些属性等。

为 Bing 做同样的事情（网站管理员工具），你应该在一两天内就清楚了。（Bing 的引擎被许多其他搜索引擎使用，而且您对 Bing 的更改似乎也影响到了它们。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T08:54:12.527

尝试创建 robots.txt 大多数（非黑帽）爬虫应该尊重该页面的阻止，如果您将它放在 robots.txt 文件中。

这是一个工具： [http ://www.mcanerin.com/EN/search-engine/robots-txt.asp](http://www.mcanerin.com/EN/search-engine/robots-txt.asp)

谷歌的网站管理员工具也为您提供了出色的网站，还可以帮助您使用 robots.txt