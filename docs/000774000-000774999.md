# StackOverflow 问答 000774000-000774999

# actionscript-3 - 从 Flash 媒体服务器流式传输时，FLVPlayback 不会搜索。怎么修？

> ID：774002
> 
> 赞同：1
> 
> 时间：2009-04-21T18:40:24.307
> 
> 标签：actionscript-3, streaming, flvplayback, flash-media-server

我有一个简单的视频播放器设置，从 Flash 媒体服务器流式传输。视频播放良好，但大多数搜索命令将其发送回视频的第一帧。如果我不使用闪存媒体服务器，它将寻找已经加载的任何点。

有什么想法可能导致这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T19:39:36.567

尝试从这里下载 jw 播放器[http://www.longtailvideo.com/players/jw-flv-player/](http://www.longtailvideo.com/players/jw-flv-player/)并测试它是否适用于该播放器。问题可能出在流媒体服务器上。

> 大多数查找命令将其发送回第一帧

其余的会发生什么？- 他们工作还是什么也没发生？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:56:52.123

问题是我正在检查 FLVPlayback 播放属性，看看我是否想在搜索后调用 play（视频没有自动播放，如果你搜索，我希望它播放）。然而，在搜索调用之后，playing 属性设置为 false，直到它明显完成搜索。这导致每次都调用 play ，从而将播放头重置为开始。

# .net - 嵌入资源 DLL 的命名约定？

> ID：774009
> 
> 赞同：0
> 
> 时间：2009-04-21T18:41:37.783
> 
> 标签：.net, resources, naming-conventions, embedded-resource

我以前从未使用过嵌入式资源 DLL。我想从正确开始，这样我以后就不必重命名 DLL。

假设，我有一个名为“Demo.exe”的主 Exe 文件，
你会如何命名与之关联的嵌入资源？

Demo.Resource.dll？资源.Demo.dll？ETC？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T18:44:30.583

这可能是一个愚蠢的问题，但您有任何理由使用单独的 DLL 吗？

为什么不直接将资源嵌入到 Demo.exe 中？

如果您绝对必须有一个单独的资源 DLL，我会选择 Demo.Resources.dll

# java - 使用池化 JDBC 连接的应用程序

> ID：774018
> 
> 赞同：0
> 
> 时间：2009-04-21T18:44:20.100
> 
> 标签：java, jdbc, weblogic, jndi

我正在使用一个旧的 WebLogic 应用程序，该应用程序包含一个 Web 服务应用程序和一个独立的命令行应用程序。两者都需要访问公共数据库，我想尝试让命令行应用程序使用与 Web 服务器的 JDBC 连接的池连接。（独立应用程序只能在服务器处于活动状态时运行，并且两者都将在同一台物理机上运行。）

我一直在尝试使用 JNDI 查找 JDBC 驱动程序，如下所示：

```
try {
    Context ctx = null;
    Hashtable ht = new Hashtable();
    ht.put(Context.INITIAL_CONTEXT_FACTORY,
           "weblogic.jndi.WLInitialContextFactory");
    ht.put(Context.PROVIDER_URL, "t3://localhost:7001");

    ctx = new InitialContext(ht);
    DataSource ds = (DataSource) ctx.lookup ("dbOracle");
    Connection conn = null;
    conn = ds.getConnection();  // <-- Exception raised here
    // conn = ds.getConnection(username, password); // (Also fails)

    // ...

} catch (Exception e) {
    // Handle exception...
} 
```

我已经确认 JNDI 名称是正确的。我可以使用其他 Web 应用程序连接到数据库，但我的独立应用程序仍然遇到困难。[- 我从WebLogic 应用笔记](http://download.oracle.com/docs/cd/E12840_01/wls/docs103/jdbc/programming.html)中得到了这个想法。

关于我忽略了什么的任何想法？

**编辑 1.1：** 我看到“java.lang.ClassCastException：java.lang.Object”异常。

**编辑2：** 当我执行以下操作时：

```
Object dsObj = ctx.lookup("dbOracle");
System.out.println("Obj was: " + dsObj.getClass().getName()); 
```

在独立应用程序中，它报告：

```
"Obj was: weblogic.jdbc.common.internal._RemoteDataSource_Stub" 
```

我试图在 web 应用程序中测试相同的代码块（在原始问题中描述）并且能够连接到数据源（即它似乎“工作”）。该工作测试报告：

```
"Obj was: weblogic.jdbc.common.internal.RmiDataSource" 
```

此外，这是失败时的堆栈跟踪：

```
####<Apr 22, 2009 10:38:21 AM EDT> <Warning> <RMI> <mlbdev16> <cgServer> <[ACTIVE] ExecuteThread: '0' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS Kernel>> <> <> <1240411101452> <BEA-080003> <RuntimeException thrown by rmi server: weblogic.jdbc.common.internal.RmiDataSource.getConnection()
 java.lang.ClassCastException: java.lang.Object.
java.lang.ClassCastException: java.lang.Object
    at weblogic.iiop.IIOPOutputStream.writeAny(IIOPOutputStream.java:1584)
    at weblogic.iiop.IIOPOutputStream.writeObject(IIOPOutputStream.java:2222)
    at weblogic.utils.io.ObjectStreamClass.writeFields(ObjectStreamClass.java:413)
    at weblogic.corba.utils.ValueHandlerImpl.writeValueData(ValueHandlerImpl.java:235)
    at weblogic.corba.utils.ValueHandlerImpl.writeValueData(ValueHandlerImpl.java:225)
    at weblogic.corba.utils.ValueHandlerImpl.writeValue(ValueHandlerImpl.java:182)
    at weblogic.iiop.IIOPOutputStream.write_value(IIOPOutputStream.java:1957)
    at weblogic.iiop.IIOPOutputStream.write_value(IIOPOutputStream.java:1992)
    at weblogic.iiop.IIOPOutputStream.writeObject(IIOPOutputStream.java:2253)
    at weblogic.jdbc.common.internal.RmiDataSource_WLSkel.invoke(Unknown Source)
    at weblogic.rmi.internal.BasicServerRef.invoke(BasicServerRef.java:589)
    at weblogic.rmi.cluster.ClusterableServerRef.invoke(ClusterableServerRef.java:224)
    at weblogic.rmi.internal.BasicServerRef$1.run(BasicServerRef.java:479)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:363)
    at weblogic.security.service.SecurityManager.runAs(Unknown Source)
    at weblogic.rmi.internal.BasicServerRef.handleRequest(BasicServerRef.java:475)
    at weblogic.rmi.internal.BasicServerRef.access$300(BasicServerRef.java:59)
    at weblogic.rmi.internal.BasicServerRef$BasicExecuteRequest.run(BasicServerRef.java:1016)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:200)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:172) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T19:30:07.307

很难用如此有限的信息来判断发生了什么。

您是否将应用程序设置为瘦客户端？当您不在其中一个 Java EE 容器中操作时，执行查找的上下文和方法不会以相同的方式工作（因供应商而异）。您可能想研究如何从这样的客户端使用 Weblogic 查找资源，以及如何正确设置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T19:36:48.180

也许是类路径问题，甚至是 jvm 版本的问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T21:50:42.057

您在客户端 JVM 中用于 Oracle 驱动程序的 JAR 可能与服务器中的 JAR 不同。确保命令行工具和 weblogic webapp 的类路径中都有相同的 Oracle JDBC 驱动程序 jar

祝你好运 ！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T16:45:26.600

这个异常看起来像是在服务器端生成的。我要做的第一件事是验证 WebLogic Server 的版本并检查客户端应用程序的类路径。您需要确保您的客户端应用程序具有与 WebLogic Server 相同版本的 WebLogic 客户端 jar 文件。您在客户端的类路径中包含 weblogic 客户端 jar 文件，对吗？由于您使用的是 WebLogic 的 RMI 驱动程序，因此我认为您在客户端的类路径中不需要任何 Oracle jar 文件。您的客户端本质上是在向 WebLogic Server 说 RMI。您配置的 WebLogic Server 连接池知道如何与 Oracle 对话。在连接池中使用什么 JDBC 驱动程序并不重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-01T14:56:58.647

我认为这个问题可以通过执行 bea 或 weblogic\user_projects\domains\base_domain\bin>setDomainEnv.cmd 来解决

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T20:39:40.057

一种可能性：您导入了不正确的“DataSource”类:-)

尝试替换这行代码：

```
DataSource ds = (DataSource) ctx.lookup ("dbOracle"); 
```

为了这：

```
javax.sql.DataSource ds = (javax.sql.DataSource) ctx.lookup ("dbOracle"); 
```

只是一个想法，希望对你有帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-12T20:50:07.813

我遇到了类似的问题，但在创建 wlfullclient.jar 并将其保存在类路径中后得到了修复。

[https://docs.oracle.com/cd/E12840_01/wls/docs103/client/jarbuilder.html#wp1078098](https://docs.oracle.com/cd/E12840_01/wls/docs103/client/jarbuilder.html#wp1078098)

服务器：weblogic 10.3.6

DS JNDI：jdbc/hr

```
DataSource dataSource = null;
    Context ctx = null;
    Properties p = new Properties();

    p.put(Context.INITIAL_CONTEXT_FACTORY, "weblogic.jndi.WLInitialContextFactory");
    p.put(Context.PROVIDER_URL, "t3://localhost:7001");
    ctx = new InitialContext(p);
    if (ctx != null) {
        dataSource = (DataSource) ctx.lookup("jdbc/hr");
    }

    if (dataSource != null) {
        Connection connection = dataSource.getConnection();
        ResultSet rs = connection.createStatement().executeQuery(
                "Select sysdate from dual");
        while (rs.next()) {
            System.out.println(rs.getString(1));
        }
        connection.close();
    } 
```

即使我能够从独立的弹簧应用程序中调用它......

```
<bean id="applicationServerEnviromentProperties"
    class="org.springframework.beans.factory.config.PropertiesFactoryBean">
    <property name="properties">
        <props>
            <prop key="java.naming.factory.initial">weblogic.jndi.WLInitialContextFactory</prop>
            <prop key="java.naming.provider.url">t3://localhost:7001</prop>
        </props>
    </property>
</bean>

<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName">
        <value>jdbc/hr</value>
    </property>
    <property name="jndiEnvironment">
        <ref local="applicationServerEnviromentProperties" />
    </property>
</bean> 
```

# wcf - 带有最终客户端身份的 SOAP 标头

> ID：774026
> 
> 赞同：1
> 
> 时间：2009-04-21T18:45:55.727
> 
> 标签：wcf, soap, header

该环境是在带有 WCF 的 Windows 环境中运行的基于内部服务的应用程序。

*   有几个“中间层”ASP.NET Web 应用程序和 Web 服务使用 Windows 身份验证对最终客户端进行身份验证，并使用 ASP.NET Roles 将 Thread.CurrentPrincipal 设置为合适的 RolePrincipal。这些应用程序每个都在自己的服务帐户下运行，这是一个域帐户，并且被认为是受信任的子系统。

*   某些后端 WCF Web 服务只能由这些受信任的“中间层”应用程序访问。他们使用 Windows 身份验证来限制对这些应用程序使用的服务帐户的访问。

我们现在需要后端服务来审核最终客户端的身份，该客户端对中间层应用程序的调用导致对后端服务的调用。

为了避免对应用程序进行任何更改，我正在考虑编写一个端点行为，它将带有最终客户端身份的 SOAP 标头插入到发送到后端服务的请求中。请注意，中间层应用程序是受信任的，因此不需要对此 SOAP 标头进行身份验证。

我突然想到这个要求可能不是唯一的，所以在我为此目的发明自己的 SOAP Header 之前，我想我会问在这个领域是否存在任何可以重用的标准？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T12:30:37.417

听起来您正在使用 WCF 模拟，请查看[MSDN 链接](http://msdn.microsoft.com/en-us/library/ms730088.aspx)或 Google 该搜索词以获取更多信息。我自己从未使用过它，因此无法完全提供建议，但希望这是您所追求的。祝你好运

编辑：WCF OperationContext 是否不会将身份传递到第二阶段？(OperationContext.Current.ServiceSecurityContext.PrimaryIdentity.Name)

# php - jQuery .getJSON 函数需要重新绑定返回的数据

> ID：774033
> 
> 赞同：1
> 
> 时间：2009-04-21T18:47:24.383
> 
> 标签：php, javascript, jquery

我无法让我的模态窗口函数绑定到一些返回的数据。我正在使用 Cody Lindy 的 http://swip.codylindley.com/DOMWindowDemo.html">Jquery.DomWindow 插件。请注意，除此问题外，一切正常。

当从我的 jQuery.getJSON 调用返回的数据包含应该打开模式窗口的链接时，就会出现问题。然而，该链接不被 DOM 识别，因此不受任何函数的约束。

我的 jQuery 函数是：

```
$(".deleteThis").live("click", function(){
    var $this = $(this);

    $.getJSON(this.href, function(data) {
        if( data.success == '1') {
        $this.parent().html('<span style="background:#f1ffd6;padding:5px;">' +data.msg+'</span>');         
        } 
        else if( data.success == '2') {
        $this.parent().html('<span style="background:#f1ffd6;padding:5px;">' +data.msg+'</span>');         
        }      
        else {alert("Failure (most likely our fault).");}
    });

    return false;
}); 
```

jQuery 发送到的 php 脚本包含一些数据库脚本（下面没有显示，因为它不相关）。返回 JSON 数组的相关 php 代码如下：

```
if($del ==1 ){
    $msg= "$name has been deleted. (<a href='media/delete_coll.php?cid=$cid&delete=0' class='deleteThis' >undo</a>)";
    print json_encode(array("success" => 1,"msg" => $msg));
}

if($del ==0 ){ 
    $msg= "$name <a href='media/editCollab.php?coll=$coll_id' class='absoluteIframeDOMWindow'>edit</a> 
     <a href='media/delete_coll.php?cid=$coll_id&delete=1&coll=$coll' class='deleteThis' > delete</a> | 
     Collaborator has restored.";
     print json_encode(array("success" => 2, "msg" => $msg));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T18:58:17.337

发生这种情况是因为插件在页面加载时绑定了事件处理程序，然后您在事后将动态内容添加到页面。最简单的解决方案是将您必须将 DomWindow 插件实例化的任何代码移动到一个函数中，并在页面加载时调用它一次，并在添加新链接时再次调用它。如果它开始对已经存在的链接进行双重绑定，那么您必须给动态链接一个不同的类，并为该类第二次实例化。

**编辑**：

这里似乎有一些误解，所以我将进一步解释：

jQuery[`live`](http://docs.jquery.com/Events/live#typefn)功能（您正在使用`.deleteThis`）旨在解决您遇到的问题。您可能已经知道这一点，因此您正在使用它。上一段是因为我相信您所说的是`edit`您返回的 DomWindow 链接没有像您预期的那样打开 DomWindow。这是因为 DomWindow 不使用`live`内部绑定事件。因此，当您最初在页面加载时启用 DomWindow 时，链接会被绑定，但新链接不会。如果您愿意编辑插件的源代码，您可以通过简单地使用来直接解决这个问题`live`，但是将代码移动到一个函数并在您添加时调用它更容易（尽管不是“干净”）页面内容更多。

# java - 如何在不复制代码的情况下在 Java Web 应用程序中包含 jsp 页面？

> ID：774038
> 
> 赞同：2
> 
> 时间：2009-04-21T18:48:44.020
> 
> 标签：java, jsp, include

让我首先说我对 Java Web 应用程序完全陌生，所以如果这是一个非常基本的问题，我很抱歉。

我正在编写一个能够让用户登录帐户的应用程序。每个页面的顶部都包含一个信息栏（有点像 GMail 中的顶部栏），其中包含以下内容：

```
Logged in as <userid> | Settings | Help 
```

由于该部分将出现在每个页面上，因此将功能拆分出来对我来说是有意义的，这样我就不会重复我的代码。

我做了一些搜索，发现我可以使用这个：

```
<jsp:include page="userInfoBar.jsp" flush="true" /> 
```

在另一个 JSP 的中间。不过，我的 userSettings.jsp 页面遇到了问题，该页面还从数据库中获取了一些用户详细信息。我不仅在 2 个 JSP 之间复制了一些代码，而且我感觉在呈现网页期间我正在做双倍的工作。

例如（伪代码）：

```
userInfoBar.jsp:
user = getCurrentUser
if ( user ) {
  print Logged in as user.userid | Settings | Help
}

userSettings.jsp:
<jsp:include page="userInfoBar.jsp" flush="true" />
user = getCurrentUser
Change settings for user.userid 
```

所以在那个小例子中，getCurrentUser 被调用了两次（我认为，除非 Java 以某种方式对其进行了优化）。

如何避免这种重复工作，但仍将 userInfoBar 与每个 JSP 保持一定程度的分离？

提前致谢！

布赖恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T18:55:51.197

问题是您的 JSP 中有 java 代码。当你这样做时，大多数邪恶的事情都会发生。你应该在谷歌上查找 MVC 模式。

无论如何，这样做的好方法是使用 MVC 模式，并在控制器中进行繁重的工作，完成繁重的工作后，您可以传递字符串/列表来显示视图，该视图显示它们，仅此而已.

此外，如果您开始使用带有 JSTL 的 MVC，将会有更多的人能够帮助您，因为每个人都知道如何做这些事情，并且希望没有多少人仍然在他们的 JSP 中使用内联 java

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T19:02:38.947

尝试使用[JSF](http://java.sun.com/javaee/javaserverfaces/)。这允许轻松实现 MVC。

您可以将两个前端指向同一个会话范围的 bean 以获取用户信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T19:07:38.920

您还可以使用 jspf（JSP 片段文件）来存储 JSP 块。

jsp:include 是包含 JSP 的一种方法。

另一种方法是使用 JSTL 库中的 c:include。

此处涵盖了差异：* [http://sharat.wordpress.com/2006/09/08/40-what-is-the-difference-between-jspinclude-and-cimport/](http://sharat.wordpress.com/2006/09/08/40-what-is-the-difference-between-jspinclude-and-cimport/)

希望有帮助。我确信有特定于框架的方法，但这是我所知道的两种 JSP 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T19:33:35.800

好吧，对于一个只有几页的小项目，我认为做纯 jsp 是可以的，掌握它也不是一个坏主意。

我可以向您保证，任何框架都会添加更多“不必要的”代码，这些代码会被一遍又一遍地调用，但您不会注意到，因为它隐藏在抽象背后。

（我真的不能推荐一个像样的 java html 框架，但也许 GWT 是最有前途的，或者至少是最不痛苦的。至少我可以在一个像样的编辑器中编写真正的可调试代码......）

# php - SFTP 列表目录

> ID：774039
> 
> 赞同：0
> 
> 时间：2009-04-21T18:49:03.800
> 
> 标签：php, python, sftp

我正在尝试连接到一个安全的 sftp 站点，但是我无法列出该目录，但是，可以使用 python“expect”或 php“ssh2_connect”进行连接，但它给了我以下消息：已收到与 xx.xx.xx 断开连接。

如果我使用诸如 winscp 之类的 GUI 应用程序，我就可以访问 sftp 服务器并检索文件。

我需要编写脚本，因此需要一个 cli 界面。

PS：以防万一有人遇到这个。我正在尝试连接到 Avisena.com sftp 服务器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T19:25:30.093

您可以使用[paramiko](http://www.lag.net/paramiko)轻松完成此操作，使用 Python 签出[SFTP](http://commandline.org.uk/python/sftp-python/)

# c++ - 如何从 C++ 更改 Windows shell (cmd.exe) 环境变量？

> ID：774047
> 
> 赞同：1
> 
> 时间：2009-04-21T18:51:26.137
> 
> 标签：c++, windows, cmd, environment-variables

我想编写一个程序，在调用它的 shell (cmd.exe) 实例中设置环境变量。这个想法是我可以在这个变量中存储一些状态，然后在后续调用中再次使用它。

我知道有像 SetEnvironmentVariable 这样的命令，但我的理解是这些命令只会更改当前进程的变量，不会修改调用 shell 的变量。

具体来说，我希望能够创建一个可以在两个目录之间跳转的命令。Pushd/Popd 可以去一个目录并返回，但没有办法第二次返回到最初推送的目录。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T19:04:53.373

[MSDN 声明如下](http://msdn.microsoft.com/en-us/library/ms682653(VS.85).aspx)：

> 调用`SetEnvironmentVariable`对系统环境变量没有影响。要以编程方式添加或修改系统环境变量，请将它们添加到 `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment`注册表项，然后广播一条设置为字符串“Environment”的`WM_SETTINGCHANGE`消息。`lParam`这允许应用程序（例如 shell）获取您的更新。请注意，此键中列出的环境变量的值限制为 1024 个字符。

考虑到有两个级别的环境 - 系统和进程 - 更改 shell 中的环境将构成更改另一个进程的环境。我不相信这是可能的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T19:03:29.647

在 Windows 中，当一个进程创建另一个进程时，它可以简单地让子进程继承当前的环境字符串，或者它可以给新的子进程一个修改过的，甚至是全新的环境。

查看[CreateProcess() win32 API的完整信息](http://msdn.microsoft.com/en-us/library/ms682425.aspx)

没有支持子进程返回父进程并更改父进程环境的方法。

话虽如此，使用 CMD 脚本和 PowerShell，父命令 shell 可以从子进程获取输出并更新自己的环境。这是一种常见的技术。

就个人而言，我不喜欢任何类型的复杂 CMD 脚本 - 它们是编写调试程序的婊子。您可能希望在 PowerShell 中执行此操作 - 可以肯定的是，有一个学习曲线，但它要丰富得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-21T19:36:18.633

一种常见的技术是编写一个 env 文件，然后从脚本中“调用”该文件。

```
del env.var
foo.exe ## writes to env.var
call env.var 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T07:01:34.163

有一种方法......只需将您的代码注入父进程并在cmd的进程内存中调用SetEnvironmentVariableA。注入后释放分配的内存。

# c - 正确使用fork、wait、exit等

> ID：774048
> 
> 赞同：0
> 
> 时间：2009-04-21T18:51:35.217
> 
> 标签：c, process, fork, system-calls

我有这个问题要解决，我不知道该怎么做，因为只有几个系统调用我们可以用来解决它，而且我看不出它们对这种情况有什么帮助。

**练习：**
我有一个大小为 [10][1000000] 的矩阵，其中包含整数，并且对于每一行，我使用 fork() 创建一个新进程。每个过程的想法是遍历该特定行的所有数字并找到一个特定数字，然后打印有关它的消息。这是问题的第一步，并且已经完成。第二步是**按顺序**打印每行中该数字的出现总数。最后，该数字出现的总数。

**调用：**
我可以使用的系统调用在本练习的文档中是这样描述的：

*   `pid_t fork(void);`
*   `void exit(int status);`
*   `pid_t wait(int *status);`
*   `pid_t waitpid(pid_t pid, int *status, int options);`

**问题：**
我不知道该怎么做，因为`exit()`调用只允许我传递一个低于 256 的数字，如果出现的次数大于这个数字怎么办？我该如何返回这样的号码？

**另一个问题：**
我不完全理解两者之间的区别`wait()`以及`waitpid()`如何/在哪里使用另一个。除了手册页之外，是否还有更多文档可以让我查看代码示例等以便更好地理解它们？或者有人可以向我解释这些差异并提供一个证明这种差异的基本示例吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T19:54:02.537

用于`waitpid()`依次获取子进程的退出状态；using`wait()`不能保证检索子尸体的顺序。

在 Unix 上，退出状态限制为 8 位，检索数据的程序可以将其视为有符号或无符号。您还将获得一个 8 位值，用于标识终止子进程的信号编号和核心转储状态。AFAIK，状态或信号位始终为零（通常两者都为零 - 当进程成功退出时）。

如果您不知道要返回的数字小于 256，则退出状态不是要走的路。正如其他人所说，在这种情况下您必须使用其他一些 IPC。如果唯一允许的系统调用是那些，那么您必须得出结论，这些值将小于 255，或者溢出无关紧要。作为家庭作业之外的结论，两者都不是令人满意的，但在“现实世界”中，您也不仅限于 4 个系统调用。

另请参阅[大于 255 的退出代码？](https://stackoverflow.com/questions/179565/exitcodes-bigger-than-255-possible). 请注意，在 Windows 上，退出代码的范围要大得多 - 但您不使用问题中列出的系统调用。

* * *

观察：当我这样做时`exit(1)`，状态中的`wait()`值为256；这有什么原因吗？

回答：是的。状态字的低 8 位编码信号号等；（16 位）状态字的高 8 位编码退出状态。

请参阅`<sys/wait.h>`宏 WIFEXITED()、WEXITSTATUS() 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T19:36:15.623

我认为您正在做的事情应该可以正常工作-只需将出现次数作为退出代码返回即可。

你提到 exit() 只允许低于 256 的数字。我非常怀疑是否是这种情况，但它很简单，你可以编写一个测试程序来确定。

听起来这实际上只是[Map-Reduce](http://en.wikipedia.org/wiki/MapReduce)的简化版本。您可能还想查看该算法，以了解有关如何进一步并行化程序的一些想法 - 并可能获得一些额外的功劳:)

至于 wait() 和 waitpid() 之间的区别 - 如果您只想等待任何子进程完成，您将使用 wait()。如果你只想等待一个特定的子进程，或者你只想检查一个子进程是否已经退出而不挂起，你可以使用 waitpid()。

# php - URL 在 Zend 框架中的行为不符合预期

> ID：774051
> 
> 赞同：0
> 
> 时间：2009-04-21T18:51:40.643
> 
> 标签：php, zend-framework, get

在控制器的 init 方法中调用以下类型的 url 时，我在两个不同的服务器上得到两个不同的结果：

> [http://address.com/index/action/?start=2009-04-18&end=2009-04-21](http://address.com/index/action/?start=2009-04-18&end=2009-04-21)

打电话

> 回声 $_GET['start'];

在一台服务器上给我 2009-04-18 而在另一台服务器上什么都没有。

然而，这是奇怪的部分，添加

> 出口（）;

在该 echo 语句之后， 2009-04-18 在两台服务器上都按预期显示。

仅供参考，转储请求参数表明它们在一台服务器上可用，但在另一台服务器上不可用......除非你调用 exit();

这到底是什么原因造成的？我意识到这不是在 ZF 中构建 URL 的方式，但它是在这个特定项目中完成的方式。也许某种自定义路线会有所帮助？仍然没有解释 exit(); 位导致 $_GET 变量显示。

**编辑：**为了暂时解决这个问题，我编写了一条自定义路线，但是？在网址中搞砸了。通过包含它，似乎 GET 变量被强制并覆盖了我的自定义路由。离开它，在我创建的路线中一切正常，但我没有选择删除它？任何人都知道如何使自定义路由优先于填充的 GET 变量？在里面吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T00:11:40.617

我的猜测是 $_GET['start'] 实际上在两台服务器上都工作，问题是在此语句之后没有显示任何问题的服务器，但回显的输出仍在输出缓冲区中。如果你在 echo 之后执行 flush()，你应该能够看到输出，那么无论什么崩溃的后记仍然会崩溃，但你会看到日期。

我不确定你在用路由做什么（没有足够的代码可以看到），但是你的查询字符串（后面的所有内容？）与你的路由完全不同。如果要使用路由，则需要使用 ZF 快速入门页面上提供的 .htaccess 文件来启用 mod_rewrite。

我想你会想要制作你自己的自定义路由器（不仅仅是一个路由），然后使用 $_GET 参数路由到你想要的控制器，以及它需要的参数。默认路由器不会对 QueryString 做复杂的事情，至少我上次检查时没有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-31T20:58:01.090

检查损坏的服务器上的 .htaccess 文件。 [http://framework.zend.com/manual/en/zend.controller.router.html](http://framework.zend.com/manual/en/zend.controller.router.html)

# return-value - 异常，返回，可序列化，

> ID：774052
> 
> 赞同：1
> 
> 时间：2009-04-21T18:52:01.547
> 
> 标签：return-value, serializable

( `throw Exception`) 和 ( `return value`) 如何在 Java 或 C# 等语言中实现？我想知道它的支持如何包含在语言中的机制，而不仅仅是`try { .... } catch (Exception) {}`.

我们知道什么时候调用一个函数，即

```
public void doSomething() {
  ....
  ....
  return;
} 
```

然后 on 调用被放入堆栈，当方法返回时调用`doSomething`on stack 弹出。

在 return 语句返回一个值的情况下会发生什么，比如说`return 4;`，`doSomething()`堆栈上的调用弹出，并且 Prog 计数器上的下一条语句得到处理？返回值发生了什么？它在哪里保存以及如何使用？

* * *

类似地，在抛出异常的情况下，`throw ex;`语句在堆栈上找到适当的`catch`语句，直到找到它，它才会不断从堆栈中弹出东西……这个机制是如何工作的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T19:36:57.710

看看[这篇文章](http://msdn.microsoft.com/en-us/magazine/dd419661.aspx)，看看它是否有帮助。它讨论了 .NET (C#) 异常系统的 SEH 基础。

**编辑：**

如果您问“如何在 C# 和 Java 中使用参数和返回值调用方法”，请查看[这篇文章](http://en.wikipedia.org/wiki/Call_stack)。

在一个非常低的级别（我想你在问什么），当你调用一个方法时，你将你的参数压入堆栈，然后运行该函数，然后将堆栈的返回值弹出到一个[寄存器](http://en.wikipedia.org/wiki/Processor_register)中，然后处理它，如下所示：

*   从方法返回（汇编代码）
*   `pop esx`- 从堆栈中弹出值并将其存储在 EAX 寄存器中
*   `jz esx A01h`- 如果 EAX 寄存器为零，则跳转到该位置。

**编辑＃2：**

在发生异常的情况下，托管框架（Java、.NET 等）开始逐步展开堆栈，以寻找可以处理错误的“catch”或“finally”块。它会一直这样做，直到找到一些可以处理它的代码块，或者它用完代码并终止程序。要了解这一切在堆栈级别如何工作取决于您所谈论的托管框架，但上面的第一篇文章结合[本文](http://www.microsoft.com/msj/0197/exception/exception.aspx)将为您提供更深入的了解。

# html - 我应该将输入元素放在标签元素中吗？

> ID：774054
> 
> 赞同：686
> 
> 时间：2009-04-21T18:52:05.527
> 
> 标签：html, semantics

是否有关于嵌套`label`和`input`HTML 元素的最佳实践？

经典方式：

```
<label for="myinput">My Text</label>
<input type="text" id="myinput" /> 
```

或者

```
<label for="myinput">My Text
   <input type="text" id="myinput" />
</label> 
```

* * *

## 回答 #1

> 赞同：578
> 
> 时间：2009-04-21T18:54:35.583

来自 W3 的[HTML4 规范](http://www.w3.org/TR/html401/interact/forms.html#edef-LABEL)：

> 标签本身可以位于相关控件之前、之后或周围。

* * *

```
<label for="lastname">Last Name</label>
<input type="text" id="lastname" />
```

或者

```
<input type="text" id="lastname" />
<label for="lastname">Last Name</label>
```

或者

```
<label>
   <input type="text" name="lastname" />
   Last Name
</label>
```

请注意，当表格用于布局时，不能使用第三种技术，标签位于一个单元格中，其关联的表单字段位于另一个单元格中。

任何一个都是有效的。我喜欢使用第一个或第二个示例，因为它为您提供了更多的样式控制。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2011-09-11T15:03:03.137

我更喜欢

```
<label>
  Firstname
  <input name="firstname" />
</label>

<label>
  Lastname
  <input name="lastname" />
</label> 
```

超过

```
<label for="firstname">Firstname</label>
<input name="firstname" id="firstname" />

<label for="lastname">Lastname</label>
<input name="lastname" id="lastname" /> 
```

主要是因为它使 HTML 更具可读性。而且我实际上认为我的第一个示例更容易使用 CSS 设置样式，因为 CSS 非常适用于嵌套元素。

但我想这是一个品味问题。

* * *

如果您需要更多样式选项，请添加一个 span 标签。

```
<label>
  <span>Firstname</span>
  <input name="firstname" />
</label>

<label>
  <span>Lastname</span>
  <input name="lastname" />
</label> 
```

在我看来，代码仍然看起来更好。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2014-07-06T14:02:30.410

**行为差异：点击标签和输入之间的空间**

如果单击标签和输入*之间*的空格，则仅当标签包含输入时才会激活输入。

这是有道理的，因为在这种情况下，空格只是标签的另一个字符。

```
div {
  border: 1px solid black;
}
label {
  border: 1px solid black;
  padding: 5px;
}
input {
  margin-right: 30px;
}
```

```
<p>Inside:</p>
<label>
  <input type="checkbox" />
  Label. Click between me and the checkbox.
</label>

<p>Outside:</p>
<input type="checkbox" id="check" />
<label for="check">Label. Click between me and the checkbox.</label>
```

能够在标签和框之间单击意味着它是：

*   更容易点击
*   不太清楚事情的开始和结束

Bootstrap 复选框 v3.3 示例使用里面的输入：[http](http://getbootstrap.com/css/#forms) : //getbootstrap.com/css/#forms 遵循它们可能是明智的。[但是他们在 v4.0 https://getbootstrap.com/docs/4.0/components/forms/#checkboxes-and-radios](https://getbootstrap.com/docs/4.0/components/forms/#checkboxes-and-radios)中改变了主意，所以我不知道什么是明智的了：

> 复选框和收音机的使用旨在支持基于 HTML 的表单验证并提供简洁、可访问的标签。因此，我们`<input>`的 s 和`<label>`s 是兄弟元素，而不是 a `<input>`within a `<label>`。这稍微有点冗长，因为您必须指定 id 和属性来关联`<input>`and `<label>`。

详细讨论这一点的 UX 问题：[https ://ux.stackexchange.com/questions/23552/should-the-space-between-the-checkbox-and-label-be-clickable](https://ux.stackexchange.com/questions/23552/should-the-space-between-the-checkbox-and-label-be-clickable)

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2009-04-21T18:56:09.370

如果在标签标签中包含输入标签，则不需要使用“for”属性。

也就是说，我不喜欢在我的标签中包含输入标签，因为我认为它们是独立的，不包含实体。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-04-21T18:59:59.610

就我个人而言，我喜欢把标签放在外面，就像你的第二个例子一样。这就是 FOR 属性存在的原因。原因是我经常将样式应用于标签，例如宽度，以使表单看起来不错（下面的简写）：

```
<style>
label {
  width: 120px;
  margin-right: 10px;
}
</style>

<label for="myinput">My Text</label>
<input type="text" id="myinput" /><br />
<label for="myinput2">My Text2</label>
<input type="text" id="myinput2" /> 
```

这样我就可以避免表格和表格中的所有垃圾。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2010-10-08T20:22:00.233

有关 W3 的建议，请参见[http://www.w3.org/TR/html401/interact/forms.html#h-17.9](http://www.w3.org/TR/html401/interact/forms.html#h-17.9)。

他们说这两种方法都可以。他们将这两种方法描述为显式（使用带有元素 id 的“for”）和隐式（将元素嵌入标签中）：

显式：

> for 属性将标签与另一个控件显式关联：for 属性的值必须与关联控件元素的 id 属性的值相同。

隐式：

> 要将标签与另一个控件隐式关联，控件元素必须在 LABEL 元素的内容内。在这种情况下，标签可能只包含一个控制元素。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2009-04-21T18:59:24.103

两者都是正确的，但是将输入放在标签内会使其在使用 CSS 进行样式设置时变得不那么灵活。

首先，[a`<label>`被限制在它可以包含的元素中](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/label)。例如，您只能`<div>`在 the`<input>`和标签文本之间放置 a，如果`<input>`不在`<label>`.

其次，虽然有一些变通方法可以使样式更容易，例如用跨度包装内部标签文本，但某些样式将从父元素继承，这会使样式更加复杂。

### 第三方编辑

根据我的理解，标签的[html 5.2 规范](https://www.w3.org/TR/html52/sec-forms.html#the-label-element)声明标签 `Content model`是`Phrasing content`. 这意味着只有其内容模型是短语 content 的标签`<label> are allowed inside </label>`。

> 内容模型 对必须作为元素的子元素和后代元素包含的内容的规范性描述。
> 
> 大多数被归类为短语内容的元素只能包含本身被归类为短语内容的元素，而不是任何流内容。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2011-11-04T18:28:04.770

一个值得注意的 'gotcha' 规定，您永远不应在具有显式“for”属性的 <label> 元素内包含多个输入元素，例如：

```
<label for="child-input-1">
  <input type="radio" id="child-input-1"/>
  <span> Associate the following text with the selected radio button: </span>
  <input type="text" id="child-input-2"/>
</label> 
```

虽然这对于自定义文本值次于单选按钮或复选框的表单功能可能很诱人，但标签元素的单击焦点功能将立即将焦点转移到其 id 在其“for”属性中明确定义的元素，使用户几乎不可能单击包含的文本字段来输入值。

就个人而言，我尽量避免带有输入子项的标签元素。一个标签元素包含的不仅仅是标签本身，这在语义上似乎是不合适的。如果您将输入嵌套在标签中以实现某种美感，则应该改用 CSS。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-09-03T14:28:50.283

正如大多数人所说，两种方式确实有效，但我认为只有第一种应该。由于语义严格，标签不“包含”输入。**在我看来，标记结构中的**包含（父/子）关系应该反映**视觉输出中的**包含。**即，标记中**围绕另一个元素的元素应该**在浏览器中**围绕该元素绘制。据此，标签应该是输入的兄弟，而不是父。因此，选项二是任意且令人困惑的。[读过Python 之禅的](http://legacy.python.org/dev/peps/pep-0020/)每个人都可能同意（扁平优于嵌套，稀疏优于密集，应该有一种——最好只有一种——明显的方式……）。

由于 W3C 和主要浏览器供应商的决定（允许“以您喜欢的方式做”，而不是“以正确的方式做”）是今天的网络如此混乱，我们开发人员必须处理纠结以及如此多样化的遗留代码。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-08-11T12:58:13.600

我通常选择前两个选项。我已经看到了使用第三个选项时的场景，当嵌入在标签中的单选选项和 css 包含类似

```
label input {
    vertical-align: bottom;
} 
```

以确保对讲机的正确垂直对齐。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-11-21T08:30:43.123

我非常喜欢将元素包装在我的内部`<label>`，因为我不必生成 id。

我是一名 Javascript 开发人员，使用 React 或 Angular 生成可以被我或其他人重用的组件。然后**很容易**在页面中复制一个 id，从而导致奇怪的行为。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-01-07T09:32:36.730

参考**WHATWG**（[编写表单的用户界面](http://www.whatwg.org/specs/web-apps/current-work/multipage/forms.html#writing-a-form%27s-user-interface)）将输入字段放在标签内并没有错。这可以节省您的代码，因为不再需要`for`来自 的属性。`label`

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-02-15T15:04:13.747

您需要考虑的一件事是复选框和无线电输入与 javascript 的交互。

使用以下结构：

```
<label>
  <input onclick="controlCheckbox()" type="checkbox" checked="checkboxState" />
  <span>Label text</span>
</label> 
```

当用户点击“标签文本”时，controlCheckbox() 函数将被触发一次。

但是当点击输入标签时，controlCheckbox() 函数可能会在一些较旧的浏览器中被触发两次。这是因为输入和标签标签都会触发附加到复选框的 onclick 事件。

那么你的 checkboxState 中可能会有一些错误。

我最近在 IE11 上遇到了这个问题。我不确定现代浏览器是否存在这种结构的问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-04-10T13:37:09.187

将输入嵌套到标签有几个优点，尤其是单选/复选框字段，

```
.unchecked, .checked{display:none;}
  label input:not(:checked) ~ .unchecked{display:inline;}
  label input:checked ~ .checked{display:inline;}
```

```
<label>
  <input type="checkbox" value="something" name="my_checkbox"/>
  <span class="unchecked">Not Checked</span>
  <span class="checked">Is Checked</span>
</label>
```

从演示中可以看出，首先嵌套输入字段，然后是其他元素允许，

*   要单击以激活字段的文本
*   输入字段后面的元素根据字段的状态动态设置样式。

此外，HTML std 允许[多个标签](https://developer.mozilla.org/en-US/docs/Learn/Forms/How_to_structure_a_web_form#multiple_labels)与一个输入字段相关联，但这会混淆屏幕阅读器，解决此问题的一种方法是将输入字段和其他元素嵌套在单个标签元素中。

# wcf-security - 基于 Web 服务调用的 DB 连接的安全上下文

> ID：774056
> 
> 赞同：0
> 
> 时间：2009-04-21T18:52:13.483
> 
> 标签：wcf-security

如果我有一个在用户上下文（例如 DOMAIN\StandardUser）下运行的应用程序（在 C# 上）调用 Web 服务，该 Web 服务工作进程在不同的上下文（例如 DOMAIN\WebServiceUser）下运行，并且该 Web 服务连接到 SQL 数据库，数据库从哪个用户上下文连接，StandardUser 还是 WebServiceUser？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T18:56:24.377

使用集成安全性，因此您的用户上下文也将用于 Web 服务。

# midi - XG MIDI 文件格式

> ID：774058
> 
> 赞同：5
> 
> 时间：2009-04-21T18:52:46.787
> 
> 标签：midi

我有一把 Yamaha MIDI 吉他，当我播放使用 XG MIDI 标准编码的 MIDI 文件时，它会导致吉他上的某些灯打开和关闭。我正在尝试确定导致此问题的 MIDI 事件，以便我可以在不使用 MIDI 文件的情况下以编程方式发送相同的事件（就像我可以发送 Note On (144) 或 Note Off (128) 命令一样）。

但是，虽然我能够找到 MIDI 协议的副本，但我无法找到 XG MIDI 协议。除了尝试将所有可能的命令发送到设备直到找到适当的命令之外，有没有办法确定导致灯改变状态的 MIDI 事件是什么？或者在某个地方我可以获得 XG MIDI 协议的副本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-01T14:16:09.557

雅马哈产品手册详细说明了您正在寻找的信息。XG 命令是特定于设备的。一些 XG 命令可以直接访问设备内存，而我的 MU2000 音频发生器手册警告说“发送不正确的数据可能会损坏设备”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-18T19:43:47.283

两件事情：

1.  XG 是 MIDI 协议的语义扩展。它不会改变 MIDI 文件的结构。唯一的问题是，如果您使用兼容 XG 的仪器来记录，例如，滤波器共振的变化，它将在任何其他 XG 仪器上产生相同的效果。但是在 MIDI 协议级别上，您仍然会收到 CC（控制更改）消息 #71 (IIRC)。

2.  MIDI 协议的扩展性很强，给厂商留下了很大的空间。您不仅可以使用 CC 消息，还可以使用注册参数编号 (RPN) 和 NRPN（未注册的）。最重要的是，您有 System Exclusive (SysEx) 消息，我敢打赌，精心制作的 SysEx 消息可以改变吉他上的灯光。尝试为您的乐器获取所谓的“数据列表”，它应该包含有关您的吉他发送/接收的 MIDI 消息的所有信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-26T17:11:03.290

*维基百科*：“1999 年，官方 GM [[通用 MIDI]](http://en.wikipedia.org/wiki/General_MIDI)标准进行了更新，以包括更多控制器、补丁、RPN 和 SysEx 消息，以试图协调冲突和专有的 Roland GS 和 Yamaha XG 添加。” 这被称为[通用 MIDI 2](http://en.wikipedia.org/wiki/General_MIDI_Level_2)。

我建议查看 Java ( [javax.sound.midi](http://java.sun.com/j2se/1.5.0/docs/api/javax/sound/midi/package-summary.html) ) 必须提供的内容（C# 似乎缺乏可靠的 MIDI 库）。阅读[MetaMessage](http://java.sun.com/j2se/1.5.0/docs/api/javax/sound/midi/MetaMessage.html)、[ShortMessage](http://java.sun.com/j2se/1.5.0/docs/api/javax/sound/midi/ShortMessage.html)、[SysexMessage](http://java.sun.com/j2se/1.5.0/docs/api/javax/sound/midi/SysexMessage.html)和[Patch](http://java.sun.com/j2se/1.5.0/docs/api/javax/sound/midi/Patch.html)。据我了解，特殊系统消息是通过 SysexMessage 发送的（照明数据可能在这里）。

如果您需要一些示例代码，请查看[Java Sound Resources](http://www.jsresources.org/examples/)。

我发现的其他链接：

*   [在 Yamaha QY70 上使用 XG SYSEX](http://www.ksanti.net/qy70/index.html)
*   [Win32API::MIDI::SysEX::Yamaha](http://search.cpan.org/~hayashi/Win32API-MIDI-0.05/MIDI/SysEX/Yamaha.pm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-18T08:08:23.787

对于托管的 .NET Midi 库，请在 codeproject.com 上查找 C# Midi Toolkit。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-18T18:12:41.813

我正在使用 Leslie Sanford 的 codeproject midi 工具包与吉他进行交流。 [http://www.codeproject.com/KB/audio-video/MIDIToolkit.aspx](http://www.codeproject.com/KB/audio-video/MIDIToolkit.aspx)

您需要了解的有关吉他通信的所有信息都在手册背面附近的单页上。

这是我构建的编辑器的视频 - 它具有与吉他的完整通信。

[吉他课程的 YouTube 视频](http://www.youtube.com/watch?v=5UYJI1MhPbo)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-23T00:36:07.953

最终，您需要从制造商那里找到该信息。它可能是一条 sysex 消息，尽管它也可能是一个控制器。

在软件中遍历所有控制器非常简单，因此您可以根据需要尝试。但是偶然或详尽搜索偶然发现正确的 sysex 消息的机会接近天文数字。

翻阅手册的背面。它可能在里面。如果没有，请谷歌搜索您设备的 sysex。否则你需要向雅马哈询问信息。

# properties - 在 BizTalk 中的第一个属性之后添加更多提升的属性

> ID：774059
> 
> 赞同：1
> 
> 时间：2009-04-21T18:52:50.313
> 
> 标签：properties, xsd, biztalk

我有一个 BizTalk 解决方案，我在其中添加了一个架构并提升了一个字段 - 这添加了默认的 PropertySchema.xsd 和 稍后
的元素 ，添加了另一个架构，但是当我尝试提升几个字段时，但是当

我选择 Show Promotions，我最终将新字段映射到 PropertySchema 中的现有字段之一

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T21:35:15.960

我的错...我应该使用快速推广

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T20:33:31.437

You can manually add items to the property schema as you would with correlation and then associate the promoted property.

# xml - XSLT 去规范化/透视/展平 xml 文件？第2部分

> ID：774071
> 
> 赞同：3
> 
> 时间：2009-04-21T18:55:57.967
> 
> 标签：xml, xslt, pivot

（注意：我已经按照建议发布了[我之前问题](https://stackoverflow.com/questions/771369/muenchian-xslt-to-denormalize-pivot-flatten-xml-file)的变体）

给定一个具有以下结构的输入 xml 文件：

```
 <widgets>
    <widget shape="square" material="wood" color="red" />
    <widget shape="square" material="metal" color="blue" />
    <widget shape="square" material="plastic" color="green" />
    <widget shape="square" material="kevlar" color="red" />
    <widget shape="round" material="metal" color="orange" />
    <widget shape="round" material="wood" color="green" />
    <widget shape="round" material="kevlar" color="blue" />
    <widget shape="diamond" material="plastic" color="blue" />
    <widget shape="diamond" material="wood" color="brown" />
    <widget shape="diamond" material="metal" color="red" />
  </widgets> 
```

以及以下信息：

1.  每个小部件都有形状、材质和颜色
2.  每种形状、材料和颜色组合都是独一无二的
3.  并非所有形状、材料和颜色的组合都存在，例如没有圆形的塑料小部件
4.  可以有无限的形状、材料和颜色
5.  所需的输出是一个表格，其中每行代表一种形状，每列代表一种材料。

如何使用 XSLT 输出以下结构？

```
 <table>
    <tr id="diamond">
      <td class="kevlar"></td>
      <td class="metal red"></td>
      <td class="plastic blue"></td>
      <td class="wood brown"></td>
    </tr>
    <tr id="round">
      <td class="kevlar blue"></td>
      <td class="metal orange"></td>
      <td class="plastic"></td>
      <td class="wood green"></td>
    </tr>
    <tr id="square">
      <td class="kevlar green"></td>
      <td class="metal blue"></td>
      <td class="plastic green"></td>
      <td class="wood red"></td>
    </tr>
  </table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T20:35:12.173

**这种转变：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:key name="kShapeByVal" match="@shape"
  use="."/>

 <xsl:key name="kMaterByVal" match="@material"
  use="."/>

 <xsl:key name="kcolorByVal" match="@color"
  use="."/>

 <xsl:key name="kColorByShapeAndMat" match="@color"
  use="concat(../@shape, '+', ../@material)"/>

  <xsl:variable name="vShapes" select=
  "/*/*/@shape
          [generate-id()
          =
           generate-id(key('kShapeByVal',.)[1])
           ]
  "/>

  <xsl:variable name="vMaterials" select=
  "/*/*/@material
          [generate-id()
          =
           generate-id(key('kMaterByVal',.)[1])
           ]
  "/>

  <xsl:variable name="vColors" select=
  "/*/*/@color
          [generate-id()
          =
           generate-id(key('kcolorByVal',.)[1])
           ]
  "/>

    <xsl:template match="/*">
      <table>
         <xsl:for-each select="$vShapes">
           <xsl:sort select="."/>

           <xsl:variable name="vShape" select="."/>

           <tr id="{.}">
             <xsl:for-each select="$vMaterials">
               <xsl:sort select="."/>

               <xsl:variable name="vMat" select="."/>

               <xsl:variable name="vShapeMatColors" select=
               "key('kColorByShapeAndMat',
                    concat($vShape, '+', $vMat)
                   )
                "/>

                <xsl:if test="not($vShapeMatColors)">
                  <td class="{$vMat}"></td>
                </xsl:if>

                <xsl:for-each select="$vShapeMatColors">
                  <td class="{concat($vMat, ' ', .)}"></td>
                </xsl:for-each>

               </xsl:for-each>
           </tr>
         </xsl:for-each>
      </table>
    </xsl:template>

</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<widgets>
    <widget shape="square" material="wood" color="red" />
    <widget shape="square" material="metal" color="blue" />
    <widget shape="square" material="plastic" color="green" />
    <widget shape="square" material="kevlar" color="red" />
    <widget shape="round" material="metal" color="orange" />
    <widget shape="round" material="wood" color="green" />
    <widget shape="round" material="kevlar" color="blue" />
    <widget shape="diamond" material="plastic" color="blue" />
    <widget shape="diamond" material="wood" color="brown" />
    <widget shape="diamond" material="metal" color="red" />
</widgets> 
```

**产生想要的结果：**

```
<table>
   <tr id="diamond">
      <td class="kevlar"/>
      <td class="metal red"/>
      <td class="plastic blue"/>
      <td class="wood brown"/>
   </tr>
   <tr id="round">
      <td class="kevlar blue"/>
      <td class="metal orange"/>
      <td class="plastic"/>
      <td class="wood green"/>
   </tr>
   <tr id="square">
      <td class="kevlar red"/>
      <td class="metal blue"/>
      <td class="plastic green"/>
      <td class="wood red"/>
   </tr>
</table> 
```

**这一切是如何运作的**：

1.  **使用 Muenchian 方法进行分组，我们可以**在变量和中找到所有不同的形状`$vShapes`、材料和颜色。`$vMaterials``$vColors`

2.  **`<tr>`**我们为每个值**输出一个**`$vShapes`

3.  **对于其中包含的所有可能的材料，`$vMaterials`我们输出一个或多个`<td>`**具有属性的**元素**`class`，其值在两种不同的情况下确定：

4.  **第一种情况是没有为这种形状和材料的组合指定颜色**（`key('kColorByShapeAndMat', concat($vShape, '+', $vMat)` 为空）。在这种情况下，类属性只包含材料。

5.  **第二种情况是为这种形状和材料的组合指定了一种或多种颜色**。然后，对于每一种这样的颜色，都会输出一个单独的`<td>`元素，并且它的`class`属性作为材质和颜色的连接生成，由空格分隔。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T19:35:28.713

[我对问题第 1 部分的](https://stackoverflow.com/questions/771369/muenchian-xslt-to-denormalize-pivot-flatten-xml-file)回答的一个变体是：

```
<xsl:stylesheet 
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>

  <!-- prepare some keys for later use -->
  <xsl:key name="kWidgetsByShape"       match="widget" use="@shape" />
  <xsl:key name="kWidgetsByMaterial"    match="widget" use="@material" />
  <xsl:key name="kWidgetsByComposition" match="widget" use="concat(@shape, ',', @material)" />

  <!-- select the <widget>s that are the first in their respective @shape -->
  <xsl:variable name="vShapes" select="
    /widgets/widget[
      generate-id()
      =
      generate-id(key('kWidgetsByShape', @shape)[1])
    ]
  " />  

  <!-- select the <widget>s that are the first in their respective @material -->
  <xsl:variable name="vMaterials" select="
    /widgets/widget[
      generate-id()
      =
      generate-id(key('kWidgetsByMaterial', @material)[1])
    ]
  " />

  <!-- output basic table structure -->
  <xsl:template match="/widgets">
    <table title="shapes: {count($vShapes)}, materials: {count($vMaterials)}">
      <xsl:apply-templates select="$vShapes" mode="tr">
        <xsl:sort select="@shape" />
      </xsl:apply-templates>
    </table>
  </xsl:template>

  <!-- output the <tr>s, one for each @shape -->
  <xsl:template match="widget" mode="tr">
    <tr id="{@shape}">
      <xsl:apply-templates select="$vMaterials" mode="td">
        <xsl:sort select="@material" />
        <xsl:with-param name="vCurrentShape" select="@shape" />
      </xsl:apply-templates>
    </tr>
  </xsl:template>

  <!-- output the right number of <td>s in each row, empty or not -->
  <xsl:template match="widget" mode="td">
    <xsl:param name="vCurrentShape" />

    <xsl:variable 
      name="vWidget" 
      select="key('kWidgetsByComposition', concat($vCurrentShape, ',', @material))[1]" 
    />

    <td class="{normalize-space(concat(@material, ' ', $vWidget/@color))}">
      <xsl:apply-templates select="$vWidget" />
    </td>
  </xsl:template>

  <xsl:template match="widget">
    <xsl:value-of select="." />
  </xsl:template>

</xsl:stylesheet> 
```

产生：

```
<table title="shapes: 3, materials: 4">
  <tr id="diamond">
    <td class="kevlar"></td>
    <td class="metal red"></td>
    <td class="plastic blue"></td>
    <td class="wood brown"></td>
  </tr>
  <tr id="round">
    <td class="kevlar blue"></td>
    <td class="metal orange"></td>
    <td class="plastic"></td>
    <td class="wood green"></td>
  </tr>
  <tr id="square">
    <td class="kevlar red"></td>
    <td class="metal blue"></td>
    <td class="plastic green"></td>
    <td class="wood red"></td>
  </tr>
</table> 
```

基本上我在其他答案中所说的所有内容仍然适用。

这次我用了三个`<xsl:key>`而不是两个。其中两个用于迭代，一个用于通过and查找`<widget>`s 。`@shape``@material`

我将不同的模板模式与`<xsl:apply-templates>`而不是`<xsl:for-each>`. 这使得代码长了几行，但有利于清晰和可读性。

最后一个模板 ( `<xsl:template match="widget">`) 仅用于演示目的，向您展示如何继续。它是从内部调用的`<xsl:template match="widget" mode="td">`，每个`<widget>`实际存在的都调用一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T18:51:28.500

**正如 eft 在评论中所问的那样，这是一个 XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    exclude-result-prefixes="xs"
    >
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:key name="kColorByShapeAndMat" match="@color"
     use="concat(../@shape, '+', ../@material)"/>

    <xsl:template match="/*">
      <xsl:for-each-group select="*/@shape" group-by=".">
        <xsl:sort select="."/>

        <xsl:variable name="vShape" select="current-grouping-key()"/>
        <tr id="{.}">
          <xsl:for-each-group select="/*/*/@material" group-by=".">
            <xsl:sort select="."/>

              <xsl:variable name="vMat" select="."/>

              <xsl:variable name="vColors" 
               select="key('kColorByShapeAndMat',
                            concat($vShape,'+',.)
                         )"/>
            <xsl:for-each select="''[empty($vColors)],$vColors/concat(' ',.)">
             <xsl:sort select="."/>

             <td class="{concat($vMat,.)}"></td>
            </xsl:for-each>
          </xsl:for-each-group>
        </tr>
      </xsl:for-each-group>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于最初提供的 XML 文档时**：

```
<widgets>
    <widget shape="square" material="wood" color="red" />
    <widget shape="square" material="metal" color="blue" />
    <widget shape="square" material="plastic" color="green" />
    <widget shape="square" material="kevlar" color="red" />
    <widget shape="round" material="metal" color="orange" />
    <widget shape="round" material="wood" color="green" />
    <widget shape="round" material="kevlar" color="blue" />
    <widget shape="diamond" material="plastic" color="blue" />
    <widget shape="diamond" material="wood" color="brown" />
    <widget shape="diamond" material="metal" color="red" />
</widgets> 
```

**产生所需的结果**：

```
<tr id="diamond">
   <td class="kevlar"/>
   <td class="metal red"/>
   <td class="plastic blue"/>
   <td class="wood brown"/>
</tr>
<tr id="round">
   <td class="kevlar blue"/>
   <td class="metal orange"/>
   <td class="plastic"/>
   <td class="wood green"/>
</tr>
<tr id="square">
   <td class="kevlar red"/>
   <td class="metal blue"/>
   <td class="plastic green"/>
   <td class="wood red"/>
</tr> 
```

# c# - 如何在 C# 3.0 的存储过程方法中传递 char null？

> ID：774072
> 
> 赞同：0
> 
> 时间：2009-04-21T18:56:01.040
> 
> 标签：c#, sql-server, linq-to-sql

我试图让这个 SP 运行：

```
myDataContext.InsertEvent(codEvent, dateOfEvent, statusOfEvent); 
```

codEvent 是一个整数；dateOfEvent 是一个日期时间；statusOfEvent 是一个字符。

问题是如果我传递一个 statusOfEvent null，Visual Studio 会抛出一个错误。而且，我的 SP 接受可为空的字符，就像我的表一样。

我也尝试过这样做：

```
char? statusOfEvent= null;
      if (!String.IsNullOrEmpty(f["statusOfEvent"]))
           statusOfEvent= Convert.ToChar(f["statusOfEvent"]); 
```

但它也会抛出一个错误......

谢谢！！

我试过做这个三元表达式：

```
!String.IsNullOrEmpty(f["statusOfEvent"]) ? Convert.ToChar(f["statusOfEvent"]) : DBNull.Value 
```

但据说'char和DBNull之间没有隐式转换'

我还查看了“*.dbml”designer.cs 文件，我的 SP 方法有这一行：

```
[Parameter(DbType="Char(1)")] System.Nullable<char> statusOfEvent 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-21T18:56:33.253

我相信您需要[DBNull](http://msdn.microsoft.com/en-us/library/system.dbnull.aspx) [.Value](http://msdn.microsoft.com/en-us/library/system.dbnull.value.aspx)而不是`null`.

**更新**
要使用，您可以将它传递到您可能会传递的地方`null`。因此，假设它`statusOfEvent`可以为空，您可以执行以下操作。

```
myDataContext.InsertEvent(
    codEvent,
    dateOfEvent,
    statusOfEvent ?? DBNull.Value); 
```

但是，`InsertEvent`需要接受它作为此参数的有效输入。如果您使用一些 .NET 支持（如 XSD 数据集）来描述存储过程。您可以修改它以将参数更改为`char?`从接受`char`。然后你应该可以通过`null`，底层系统会`DBNull.Value`为你转换成这个。在这种情况下，您可以将呼叫保留为：

```
myDataContext.InsertEvent(
    codEvent,
    dateOfEvent,
    statusOfEvent); 
```

这也应该适用于 Linq2Sql。要更改存储过程在 Linq2Sql 对象中的表示，您需要打开 dbml 并编辑存储过程的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T19:03:58.273

DBNull.Value 是该数据库所期望的...

这是我将 IsActive （这是一个可为空的布尔值）作为参数传递的方式...

```
_ExecutedSP = new StoredProcedure("EvaluationType_GetList", base._SPInputOutput);
if (this.IsActive == null)
{
    _ExecutedSP.AddParameter("@IsActive", SqlDbType.Bit, DBNull.Value);
}
else
{
    _ExecutedSP.AddParameter("@IsActive", SqlDbType.Bit, this.IsActive);
} 
```

# java - 字符编码检测算法

> ID：774075
> 
> 赞同：46
> 
> 时间：2009-04-21T18:56:32.880
> 
> 标签：java, character-encoding

我正在寻找一种方法来检测文档中的字符集。我一直在这里阅读 Mozilla 字符集检测实现：

[通用字符集检测](http://www.mozilla.org/projects/intl/UniversalCharsetDetection.html)

我还找到了一个名为 jCharDet 的 Java 实现：

[JCharDet](http://jchardet.sourceforge.net/)

这两者都是基于使用一组静态数据进行的研究。我想知道是否有人成功地使用了任何其他实现，如果是的话怎么办？您是否推出了自己的方法，如果是的话，您用于检测字符集的算法是什么？

任何帮助，将不胜感激。我不是通过 Google 寻找现有方法的列表，也不是在寻找 Joel Spolsky 文章的链接——只是为了澄清：）

**更新：**我对此进行了大量研究，最终找到了一个名为 cpdetector 的框架，该框架使用可插入的字符检测方法，请参阅：

[CP检测器](http://cpdetector.sourceforge.net/)

这提供了 BOM、chardet（Mozilla 方法）和 ASCII 检测插件。自己编写也很容易。还有另一个框架，它提供了比 Mozilla 方法/jchardet 等更好的字符检测......

[ICU4J](http://site.icu-project.org/)

为 cpdetector 编写自己的插件非常容易，它使用这个框架来提供更准确的字符编码检测算法。它比 Mozilla 方法更有效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-21T19:15:37.777

几年前，我们对邮件应用程序进行了字符集检测，并且推出了自己的。邮件应用程序实际上是一个 WAP 应用程序，而手机需要 UTF-8。有几个步骤：

**普遍的**

我们可以很容易地检测到文本是否为 UTF-8，因为在字节 2/3/等的高位中有一个特定的位模式。一旦您发现该模式重复了一定次数，您就可以确定它是 UTF-8。

如果文件以 UTF-16 字节顺序标记开头，您可能可以假设文本的其余部分是该编码。否则，检测 UTF-16 并不像 UTF-8 那样容易，除非您可以检测到代理对模式：但是代理对的使用很少见，因此这通常不起作用。UTF-32 与此类似，只是没有要检测的代理对。

**区域检测**

接下来我们假设读者在某个区域。例如，如果用户看到的是日文本地化 UI，那么我们可以尝试检测三种主要的日文编码。ISO-2022-JP 再次向东使用转义序列进行检测。如果失败，确定 EUC-JP 和 Shift-JIS 之间的区别就不是那么简单了。用户更有可能收到 Shift-JIS 文本，但 EUC-JP 中的字符在 Shift-JIS 中不存在，反之亦然，因此有时您可以获得很好的匹配。

相同的程序用于中文编码和其他区域。

**用户的选择**

如果这些不能提供令人满意的结果，用户必须手动选择一种编码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-23T09:41:32.743

不完全符合您的要求，但我注意到[ICU 项目](http://site.icu-project.org/)包含一个[CharsetDetector](http://icu-project.org/apiref/icu4j/com/ibm/icu/text/CharsetDetector.html)类。

# c# - 大型项目中进程间通信的最佳和最简单方法

> ID：774084
> 
> 赞同：1
> 
> 时间：2009-04-21T18:58:52.063
> 
> 标签：c#, .net, ipc

在一个非常大的项目中，可用于进程间通信的最佳和最简单的方法是什么？

我的要求是在普通的 Windows 窗体应用程序和 Windows 服务之间进行通信。

易于维护和实施的方法是首选。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T19:24:02.640

从标签中我了解到我们正在谈论.NET。也许您应该尝试 Microsoft WCF。它统一了这个问题，从实际代码中抽象出特定的进程间（服务间）通信技术。因此，通常您将设计和编写您的进程将用来相互通信的接口，然后您将在 XML 配置文件中配置特定的通信技术。也就是说，您在“进程谈论什么”和“如何具体实施这种通信”之间有相当明确的区别。

WCF 支持 SOAP、TCP\IP 通信、MSMQ 等，您的进程可以是 IIS 托管的 Web 服务、通常的 Windows 服务、控制台应用程序等——所有这些都在统一的框架下。我认为，这正是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T19:09:38.947

这真的取决于项目，因为有很多方法。

这可能取决于项目的不同部分在哪里运行（它们可以在不同的服务器上运行，或者完全在不同的技术堆栈上运行。）。

最常见的方法可能是 Web 服务。尽管这些都带来了开销，因此可能值得通过 DLL 研究一个简单的接口 API。

无论您做什么，都应该仔细考虑和设计它，考虑安全性和性能，以及将来如何扩展或修改它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T19:39:40.467

不一定是最好的或最简单的......

在 .NET 世界中尝试 MSMQ 或 IBM MQ 消息队列中间件。

如果通信主要是单向通信，则考虑使用 WCF 服务，如果您让 Visual Studio 中的代码生成器为您完成大部分工作，这既好又容易。

# sql-server - Sql Server 字符串比较

> ID：774089
> 
> 赞同：0
> 
> 时间：2009-04-21T18:59:51.920
> 
> 标签：sql-server, string, algorithm, comparison, sql-like

是否有任何关于 SQL Server 如何比较字符串并在其中处理搜索（如语句）的信息？我试图找出是否有一种方法可以确定将信息存储为大字符串的效率，并使用 sql server 对行进行一堆比较以确定哪个匹配。我知道这可能会很慢（每个信息字符串的长度为 2400 个字符），但我需要一些文件来说明字符串的比较方式，以便我可以展示它的效率（或低效率）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T19:03:47.010

> 每个信息字符串的长度为 2400 个字符

正好2400？所以你那里有固定宽度的字段？节省您的时间，只需将其拆分为单独的列。以后你会感谢自己的。

如果您*必须*有数据，请设置一个测试数据库并尝试两种方式。然后，至少您将拥有特定于*您的*系统的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T21:37:00.700

只是已经提到的附加信息。如果您需要使用like 过滤大字符串，则也不会使用索引（通配符 % 仅位于搜索字符串的末尾）。因此，最好避免喜欢，并使您需要过滤的部分在自己的领域中可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T19:11:27.180

在它们中搜索会很慢，因为您将无法创建索引，因为索引的长/宽不能超过 900 字节

我会按照 Joel Coehoorn 的建议去做，并将其分成几列

您还可能希望将其拆分为更多表，因为您只能存储 3 行 pr 页面，每行 2400 个字符

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T19:55:15.717

您可以将全文搜索索引应用于 sql server，这些索引通常用于搜索引擎之类的东西。全文索引通常允许布尔逻辑运算符用于搜索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T21:29:24.087

在有关全文搜索的[MSDN文章中，关于 LIKE 谓词如何使用字符模式，请注意以下内容。](http://msdn.microsoft.com/en-us/library/ms142571.aspx#like)

> 将 LIKE 与全文搜索进行比较
> 
> 与全文搜索相比，LIKE Transact-SQL 谓词仅适用于字符模式。此外，您不能使用 LIKE 谓词来查询格式化的二进制数据。此外，针对大量非结构化文本数据的 LIKE 查询比针对相同数据的等效全文查询要慢得多。对数百万行文本数据的 LIKE 查询可能需要几分钟才能返回；而对于相同的数据，全文查询可能只需要几秒钟或更短的时间，具体取决于返回的行数。

# sqlxml - XML xs：选择 SQLXMLBulkload

> ID：774091
> 
> 赞同：1
> 
> 时间：2009-04-21T19:00:07.300
> 
> 标签：sqlxml

我有一些 XML 文件需要批处理到 SQL Server 中。以下 Schema 和 XML 部分概述了我遇到问题的一个领域。

```
<xs:complexType>
    <xs:sequence>
        <xs:choice maxOccurs="unbounded">
            <xs:element name="TextLine" type="xs:string" sql:field="AdvertLine" sql:relation="XmlAdvert" sql:relationship="XmlAdvert" />
            <xs:element name="BreakPoint" sql:is-constant="1" />
        </xs:choice>
    </xs:sequence>
</xs:complexType>

<Advert>
 <AdvertText>
  <TextLine>Isuzu 4 X 4TRUCKMAN</TextLine> 
  <BreakPoint /> 
  <TextLine>2.0TD, Red, 5 dr, 60,000 miles, MOT, 5 SEATER</TextLine> 
  <BreakPoint /> 
  <TextLine>£2500</TextLine>
  <BreakPoint /> 
  <TextLine>01234 567890</TextLine> 
 </AdvertText>
</Advert> 
```

但是由于 SQLXMLBulkload 不支持 xs:choice，我想知道是否有另一种表示方式，因为没有 xs:choice 部分，xs:sequence 一旦到达第二个 TextLine 就无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T19:42:36.403

我不熟悉 SQLXMLBulkload，但这是我的想法：

我不确定相邻元素`TextLine`和`BreakPoint`元素之间是否有任何关系。假设没有，那么最简单的解决方案可能是使用 XSLT 来转换模式和数据以消除对`choice`.

请注意，我已经插入`maxOccurs="unbounded"`了两个元素。如果这不起作用，那么还有一种替代方法应该起作用；见下文。

```
<xs:complexType>
    <xs:sequence>
        <xs:element name="TextLine" type="xs:string" sql:field="AdvertLine" sql:relation="XmlAdvert" sql:relationship="XmlAdvert" maxOccurs="unbounded"/>
        <xs:element name="BreakPoint" sql:is-constant="1" maxOccurs="unbounded"/>
    </xs:sequence>
</xs:complexType> 
```

等效的 XML 将是：

```
<Advert>
 <AdvertText>
  <TextLine>Isuzu 4 X 4TRUCKMAN</TextLine> 
  <TextLine>2.0TD, Red, 5 dr, 60,000 miles, MOT, 5 SEATER</TextLine> 
  <TextLine>£2500</TextLine>
  <TextLine>01234 567890</TextLine> 
  <BreakPoint /> 
  <BreakPoint /> 
  <BreakPoint /> 
 </AdvertText>
</Advert> 
```

但据我所知，SQLXMLBulkload 也不喜欢这种安排。在那种情况下，仅基于您的示例 XML，我敢打赌它会接受这个：

匹配的 XML 为：

```
<Advert>
 <AdvertText>
    <TextLines>
      <TextLine>Isuzu 4 X 4TRUCKMAN</TextLine> 
      <TextLine>2.0TD, Red, 5 dr, 60,000 miles, MOT, 5 SEATER</TextLine> 
      <TextLine>£2500</TextLine>
      <TextLine>01234 567890</TextLine>
    </TextLines> 
  <BreakPoints> 
      <BreakPoint /> 
      <BreakPoint /> 
      <BreakPoint /> 
  </BreakPoints> 
 </AdvertText>
</Advert> 
```

这仍然留下了如何编写您需要的 XSLT 的问题，但也许这是一个开始。

# asp.net - 支持和恢复 SQL Server 数据以更改数据库结构

> ID：774094
> 
> 赞同：0
> 
> 时间：2009-04-21T19:01:02.633
> 
> 标签：asp.net, sql-server

场景是这样的。我有一个在线的 SQL Server 数据库，我正在演示一个应用程序。在开发过程中，我添加了额外的字段、修改了字段类型、更改了键并在本地添加了一些新表。

我用新结构更新在线数据库而不丢失数据的最佳方法是什么？该数据库是 SQL Server 2005 的一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T19:05:12.280

编写更新脚本以将您的实时数据库结构修改为新结构，并插入所需的任何数据。

您可能会发现有必要使用临时表来执行此操作。

最好先在测试环境中测试此过程，然后再在实时环境中运行脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T19:08:51.587

[下载Red Gate SQL Compare](http://www.red-gate.com/products/SQL_Compare/index.htm)试用版，比较您的两台服务器即可。如果您经常这样做，那么 400 美元是非常值得的，或者买一个他们的捆绑包以获得更好的收益。

* * *

而且我不为红门工作，只是一个快乐的客户！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T19:05:54.183

根据您所做的具体操作，您可能能够摆脱更改语句，尽管从它的声音（删除键和诸如此类的东西）来看，您正在做一些繁重的工作，这可能会使该解决方案不太理想。您可能应该考虑在 Visual Studio 中创建维护计划，或者更好的是 SQL Server Integration Services 项目。您应该能够使用这些工具将现有数据库中的数据迁移到新数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T19:08:01.353

回想起来，这可能没有太大帮助，但是我总是将所有结构数据库更改编写到我的开发数据库中，然后使用版本号来确定数据库的当前版本，我可以在实时数据库上运行所需的脚本，从而带来它在上传新代码的同时重新排队。

这也适用于任何内容更改，例如，如果底层结构的更改对存储的内容有影响，您还可以编写脚本来相应地迁移数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T19:08:31.150

1.  制作现有数据库的副本以从中复制。

2.  制作另一个副本并将其更改为您的新架构。保存 DDL 以供重用。

3.  编写将数据从 #1 复制到 #2 的查询。保存查询以供重用。

4.  检查结果。

5.  重复直到完成。

# django - 在django中将对象从一个多对多关联移动到另一个？

> ID：774096
> 
> 赞同：0
> 
> 时间：2009-04-21T19:02:17.297
> 
> 标签：django, django-models, many-to-many

有个问题。假设我有两个处于多对多关系的模型（文章、出版物）。文章 A 在出版物一、二和三中。我想从这些出版物中删除它并将其放入出版物 X。django 文档涵盖了删除对象和添加对象，但我不想删除或添加对象，只是“移动”它们。我该怎么做？

提前致谢，

Ĵ

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T19:14:20.480

```
pubx = Pubblication(.....)
pubx.save()

article_obj = Article.objects.get(id=1)

remove_from_lst = ["pubblication a", "pubblication b", "pubblication c"]
remove_from_qs = Pubblication.objects.filter(name__in=remove_from_lst)

for qs in remove_from_qs:
    article_obj.pubblications.remove(qs)

article_obj.pubblications.add(pubx)

article.save() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T19:12:04.543

您只需删除与出版物 1、2 和 3 的关联，并创建与出版物 x 的关联：

```
# `a` being an instance of the Article object, pub{1,2,3,x}, being 
# instances of Publication objects
a.publications.remove(pub1)
a.publications.remove(pub2)
a.publications.remove(pub3)
a.publications.add(pubx) 
```

[在django 文档](http://www.djangoproject.com/documentation/models/many_to_many/)中有一个很好的例子来说明如何做到这一点。

# c# - File.Move 的原子性

> ID：774098
> 
> 赞同：22
> 
> 时间：2009-04-21T19:02:38.027
> 
> 标签：c#, .net, filesystems

我想将目录中的文件重命名为原子事务。该文件不会更改目录。该路径作为 NTFS 文件系统的 UNC 路径提供，可能位于服务器 03 或 08 上。

File.Move() 对于这些目的是原子的吗？例如，它要么成功完成，要么失败，使得原始文件仍然完好无损？

我的直觉说是的，但我想确定一下。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-21T19:17:04.407

是的，在 NTFS 中。从[这里](http://social.microsoft.com/Forums/en-US/netfxbcl/thread/38733d72-e1d4-493b-8533-cbdef22f46ed#reply)：

> 顺便说一句，如果您在 NTFS 下运行，那么文件操作在文件系统级别是原子的。就任何更高的代码而言，重命名将在单个操作中发生。您看到的问题几乎似乎是跨应用程序共享 FileInfo 对象的问题。它是一个 MarshalByRef 对象，因此可以在远程环境中使用。不知道这是否适用于你。

# c# - .NET 中的无效或意外参数应引发哪些异常？

> ID：774104
> 
> 赞同：186
> 
> 时间：2009-04-21T19:03:40.600
> 
> 标签：c#, .net, vb.net, exception

.NET 中的无效或意外参数应引发哪些类型的异常？我什么时候会选择一个而不是另一个？

## 跟进：

如果你有一个函数需要一个对应于一个月的整数并且你传入了'42'，你会使用哪个例外？即使它不是一个集合，这是否会属于“超出范围”类别？

* * *

## 回答 #1

> 赞同：287
> 
> 时间：2009-04-21T19:06:18.783

我喜欢使用：`ArgumentException`、、`ArgumentNullException`和`ArgumentOutOfRangeException`。

*   [`ArgumentException`](http://msdn.microsoft.com/en-us/library/system.argumentexception(loband).aspx)– 论证有问题。
*   [`ArgumentNullException`](http://msdn.microsoft.com/en-us/library/system.argumentnullexception(loband).aspx)– 参数为空。
*   [`ArgumentOutOfRangeException`](http://msdn.microsoft.com/en-us/library/system.argumentoutofrangeexception(loband).aspx)– 我不经常使用这个，但一个常见的用途是索引到一个集合中，并给出一个很大的索引。

还有其他选项，它们不会过多地关注论点本身，而是将调用作为一个整体来判断：

*   [`InvalidOperationException`](http://msdn.microsoft.com/en-us/library/system.invalidoperationexception(loband).aspx)– 参数可能正常，但不是对象的当前状态。^([归功于 STW（以前的 Yoooder）。[也给他的答案](https://stackoverflow.com/a/774149)投票。])
*   [`NotSupportedException`](http://msdn.microsoft.com/en-us/library/system.notsupportedexception(loband).aspx)– 传入的参数是有效的，但在此实现中不支持。想象一个 FTP 客户端，你传递了一个客户端不支持的命令。

诀窍是抛出最能说明为什么不能按原样调用方法的异常。理想情况下，异常应该详细说明出了什么问题，为什么是错误的，以及如何修复它。

我喜欢错误消息指向帮助、文档或其他资源。例如，Microsoft 在其知识库文章中迈出了良好的第一步，例如[“为什么我在 Internet Explorer 中访问网页时会收到“操作中止”错误消息？</a>。当您遇到错误时，他们会将您指向错误消息中的知识库文章。他们做得不好的是他们没有告诉你，为什么具体失败了。](http://support.microsoft.com/kb/927917)

 [^([再次感谢 STW（前 Yoooder）的评论。])

* * *](http://support.microsoft.com/kb/927917) 

[作为对您的跟进的回应，我会抛出一个](http://support.microsoft.com/kb/927917)[`ArgumentOutOfRangeException`](http://msdn.microsoft.com/en-us/library/system.argumentoutofrangeexception(loband).aspx). 看看 MSDN 关于这个异常的说法：

> `ArgumentOutOfRangeException`当调用方法并且传递给该方法的至少一个参数不是空引用（`Nothing`在 Visual Basic 中）并且不包含有效值时引发。

因此，在这种情况下，您传递的是一个值，但这不是一个有效值，因为您的范围是 1-12。但是，您记录它的方式清楚地表明您的 API 抛出了什么。因为虽然我可能会说`ArgumentOutOfRangeException`，但另一个开发人员可能会说`ArgumentException`。让它变得简单并记录行为。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-04-21T19:13:56.550

我投票支持[Josh 的回答](https://stackoverflow.com/questions/774104/what-exceptions-should-be-thrown-for-invalid-or-unexpected-parameters-in-net/774116#774116)，但想在列表中再添加一个：

如果参数有效，则应抛出 System.InvalidOperationException，但对象处于不应使用参数的状态。

**来自 MSDN 的**更新：****

 **> InvalidOperationException 用于调用方法失败是由无效参数以外的原因引起的情况。

假设您的对象有一个 PerformAction(enmSomeAction action) 方法，有效的 enmSomeAction 是 Open 和 Close。如果您连续两次调用 PerformAction(enmSomeAction.Open)，则第二次调用应抛出 InvalidOperationException（因为参数有效，但不适用于控件的当前状态）

由于您已经通过防御性编程来做正确的事情，因此我还有一个例外要提及的是 ObjectDisposedException。 **如果**你的对象实现了 IDisposable 那么你应该总是有一个类变量来跟踪释放状态；如果您的对象已被释放并且一个方法被调用，您应该引发 ObjectDisposedException：

```
public void SomeMethod()
{
    If (m_Disposed) {
          throw new ObjectDisposedException("Object has been disposed")
     }
    // ... Normal execution code
} 
```

**更新：**回答您的后续问题：这有点模棱两可，并且由于用于表示特定数据集的泛型（不是 .NET 泛型意义上的）数据类型而变得更加复杂；枚举或其他强类型对象将是更理想的选择——但我们并不总是拥有这种控制权。

我个人倾向于 ArgumentOutOfRangeException 并提供一条消息，表明有效值为 1-12。我的理由是，当您谈论月份时，假设月份的所有整数表示都是有效的，那么您期望的值在 1-12 的范围内。如果只有某些月份（比如有 31 天的月份）有效，那么您将不会处理 Range 本身，我会抛出一个指示有效值的通用 ArgumentException，并且我还会在方法的注释中记录它们。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-04-21T19:05:34.247

根据实际值和最适合的例外情况：

*   [`ArgumentException`](http://msdn.microsoft.com/en-us/library/system.argumentexception(VS.80,loband).aspx)（值有问题）

*   [`ArgumentNullException`](http://msdn.microsoft.com/en-us/library/system.argumentnullexception(VS.80,loband).aspx)（参数为空，但这是不允许的）

*   [`ArgumentOutOfRangeException`](http://msdn.microsoft.com/en-us/library/system.argumentoutofrangeexception(VS.80,loband).aspx)（参数的值超出有效范围）

如果这还不够精确，只需从`ArgumentException`.

Yoooder的回答启发了我。如果输入在任何时候都**无效**，则输入无效，而如果输入对于系统的当前状态无效，则输入是**意外的。**所以在后一种情况下an[`InvalidOperationException`](http://msdn.microsoft.com/en-us/library/system.invalidoperationexception(VS.80,loband).aspx)是一个合理的选择。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-21T19:05:29.520

[参数异常。](http://msdn.microsoft.com/en-us/library/system.argumentexception(VS.71).aspx)

*   System.ArgumentException
*   System.ArgumentNullException
*   System.ArgumentOutOfRangeException

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-21T19:06:38.313

[参数异常](http://msdn.microsoft.com/en-us/library/system.argumentexception.aspx)：

> 当调用方法并且至少有一个传递的参数不符合被调用方法的参数规范时，将引发 ArgumentException。ArgumentException 的所有实例都应带有描述无效参数的有意义的错误消息，以及参数的预期值范围。

对于特定类型的无效性，还存在一些子类。该链接包含子类型的摘要以及它们应该适用的时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T19:07:30.917

您可以使用标准的 ArgumentException，或者您可以子类化并创建自己的。有几个特定的​​ ArgumentException 类：

[http://msdn.microsoft.com/en-us/library/system.argumentexception(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.argumentexception(VS.71).aspx)

哪个效果最好。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-21T21:54:36.117

**简短的回答：**
两者都不是

**更长的答案：**
使用 Argument*Exception （除了在其上的产品库中，例如组件库）是一种气味。例外是处理特殊情况，而不是错误，也不是用户（即 API 使用者）的不足。

**最长的答案：**
为无效参数抛出异常是粗鲁的，除非你写了一个库。
我更喜欢使用断言，有两个（或更多）原因：

*   断言不需要测试，而 throw 断言需要测试，并且针对 ArgumentNullException 进行测试看起来很荒谬（试试看）。
*   断言更好地传达了单元的预期用途，并且比类行为规范更接近于可执行文档。
*   您可以更改断言违规的行为。例如，在调试编译中，一个消息框很好，这样你的 QA 会立即用它来打击你（你也会让你的 IDE 在它发生的地方中断），而在单元测试中你可以将断言失败指示为测试失败.

以下是空异常的处理方式（显然是讽刺的）：

```
try {
    library.Method(null);
}
catch (ArgumentNullException e) {
    // retry with real argument this time
    library.Method(realArgument);
} 
```

当情况是预期的但异常时（发生消费者无法控制的事情，例如 IO 故障），应使用异常。Argument*Exception 是一个错误的指示，应该（我认为）通过测试处理并通过 Debug.Assert 进行协助

顺便说一句：在这种特殊情况下，您可以使用 Month 类型，而不是 int。C# 在类型安全（Aspect# rulez！）方面存在不足，但有时您可以一起防止（或在编译时捕获）这些错误。

是的，微软在这方面是错误的。

# javascript - jQuery插件开发帮助

> ID：774111
> 
> 赞同：2
> 
> 时间：2009-04-21T19:05:27.897
> 
> 标签：javascript, jquery, jquery-plugins

这是我第一次尝试插件，但我认为我错过了整个“如何”。

好的，这里是：

试图为表单验证编写一个错误弹出框。

我喜欢此页面上此 JavaScript 代码的外观和功能，请参见此处的演示和此处的源代码。

如果用户输入无效数据，这基本上就是我想要做的。

现在我尝试使用此代码创建一个 jQuery 插件，但它不起作用，任何帮助都会很棒:-)

```
(function($){

/* Might use the fadein fadeout functions */
var MSGTIMER = 20;
var MSGSPEED = 5;
var MSGOFFSET = 3;
var MSGHIDE = 3;

var errorBox = function(target, string, autohide, options)
{
    var ebox        = $(ebox);
    var eboxcontent = $(eboxcontent);
    var target      = $(target);
    var string      = $(string);
    var autohide    = $(autohide);
    var obj = this;

    if (!document.getElementById('ebox')) {
        ebox = document.createElement('div');
        ebox.id = 'ebox';
        eboxcontent = document.createElement('div');
        eboxcontent.id = 'eboxcontent';
        document.body.appendChild(ebox);
        ebox.appendChild(eboxcontent);
        ebox.style.filter = 'alpha(opacity=0)';
        ebox.style.opacity = 0;
        ebox.alpha = 0;
    }
    else {
        ebox = document.getElementById('ebox');
        eboxcontent = document.getElementById('eboxcontent');
    }
    eboxcontent.innerHTML = string;
    ebox.style.display = 'block';
    var msgheight = ebox.offsetHeight;
    var targetdiv = document.getElementById(target);
    targetdiv.focus();
    var targetheight = targetdiv.offsetHeight;
    var targetwidth = targetdiv.offsetWidth;
    var topposition = topPosition(targetdiv) - ((msgheight - targetheight) / 2);
    var leftposition = leftPosition(targetdiv) + targetwidth + MSGOFFSET;
    ebox.style.top = topposition + 'px';
    ebox.style.left = leftposition + 'px';
    clearInterval(ebox.timer);
    ebox.timer = setInterval("fadeMsg(1)", MSGTIMER);
    if (!autohide) {
        autohide = MSGHIDE;
    }
    window.setTimeout("hideMsg()", (autohide * 1000));

    // hide the form alert //
    this.hideMsg(msg) = function (){
        var msg = document.getElementById('msg');
        if (!msg.timer) {
            msg.timer = setInterval("fadeMsg(0)", MSGTIMER);
        }
    };

    // face the message box //
    this.fadeMsg(flag) = function() {
        if (flag == null) {
            flag = 1;
        }
        var msg = document.getElementById('msg');
        var value;
        if (flag == 1) {
            value = msg.alpha + MSGSPEED;
        }
        else {
            value = msg.alpha - MSGSPEED;
        }
        msg.alpha = value;
        msg.style.opacity = (value / 100);
        msg.style.filter = 'alpha(opacity=' + value + ')';
        if (value >= 99) {
            clearInterval(msg.timer);
            msg.timer = null;
        }
        else 
            if (value <= 1) {
                msg.style.display = "none";
                clearInterval(msg.timer);
            }
    };

    // calculate the position of the element in relation to the left of the browser //
    this.leftPosition(target) = function() {
        var left = 0;
        if (target.offsetParent) {
            while (1) {
                left += target.offsetLeft;
                if (!target.offsetParent) {
                    break;
                }
                target = target.offsetParent;
            }
        }
        else 
            if (target.x) {
                left += target.x;
            }
        return left;
    };

    // calculate the position of the element in relation to the top of the browser window //
    this.topPosition(target) = function() {
        var top = 0;
        if (target.offsetParent) {
            while (1) {
                top += target.offsetTop;
                if (!target.offsetParent) {
                    break;
                }
                target = target.offsetParent;
            }
        }
        else 
            if (target.y) {
                top += target.y;
            }
        return top;
    };

    // preload the arrow //
    if (document.images) {
        arrow = new Image(7, 80);
        arrow.src = "images/msg_arrow.gif";
    }
};

$.fn.errorbox = function(options)
{
    this.each(function()
    {
        var element = $(this);

        // Return early if this element already has a plugin instance
        if (element.data('errorbox')) return;

        // pass options to plugin constructor
        var errorbox = new errorBox(this, options);

        // Store plugin object in this element's data
        element.data('errorbox', errorbox);
    });
}; 
```

})(jQuery);

我怎么称呼它

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title>jQuery Plugin - Error ToolTip</title>
    <script type="text/javascript" src="js/jquery.js">
    </script>
    <script type="text/javascript" src="js/jquery.errorbox.js">
    </script>
    <script type="text/javascript">
        $(document).ready(function(){
            var name = document.getElementById('name');

            if(name == "") {
                $('#name','You must enter your name.',2).errorbox();
                alert("Blank");
            }
        });
    </script>
    <link rel="stylesheet" type="text/css" href="css/errorbox.css" />
</head>
<body>
    <div>
        Name: <input type="text" id="name" width="30"></input>
    </div>
</body> 
```

对我的第一个插件的任何帮助都会很棒，在此先感谢。

--菲尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T19:13:17.253

var`errorBox = function(...`需要更改为：

```
$.errorBox = function(... 
```

然后你可以在 jquery 对象上调用它。

其次，为清楚起见，您可能希望使用`$('#eboxcontent')`而不是`document.getElementById('eboxcontent')`. 它不会更快，但对其他 jquery 开发人员来说“更清晰”。

最后，jQuery 有许多内置函数用于在指定时间段内淡化事物，看来您已经构建了自己的函数。我知道 jQuery 的淡入淡出是跨浏览器兼容的。只需使用：

```
$('#someDivId').fadeOut(timeInMilliseconds); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T19:18:28.113

```
var name = document.getElementById('name');

if(name == "") {
    //...
} 
```

应该

```
var name = document.getElementById('name');

if(name.value == "") {
    //...
} 
```

或者

```
var name = $('#name').val();

if(name == "") {
    //...
} 
```

# audio - 从一个音频文件同时播放多个音频流

> ID：774114
> 
> 赞同：3
> 
> 时间：2009-04-21T19:05:46.680
> 
> 标签：audio, multimedia

我编写了一个应用程序，它从中央服务器接收媒体文件并根据播放列表播放这些文件。一切正常。一位客户与我们联系并希望使用我们的应用程序在信息亭式应用程序中播放一些音频文件作为演示文稿。到目前为止，一切都很好，我们的应用程序可以毫无问题地处理这个问题。

作为一项潜在功能，他要求我们在信息亭的前面有多个耳机插孔。每个耳机插孔将以不同的语言播放相同的音频演示。

我想出了用多种语言对单个音频文件进行编码的想法，每种语言在不同的频道中。然后我们需要一个声卡，它可以解码每个通道并将其输出到不同的耳机插座上。问题是，虽然我认为这个理论是合理的，但我完全不知道这是否可行以及需要什么来实现它。

有任何想法吗？！

附带说明：该应用程序使用媒体播放器作为底层组件来处理音频和视频的播放。对于我们可以用来生成多声道音频流的软件和我们可以用来解码流的硬件（USB 声卡就可以了），我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T20:06:24.957

您需要使用多个文件而不是频道，这样会更容易。
而不是使用媒体播放器使用[DirectShow](http://msdn.microsoft.com/en-us/library/ms783323.aspx)（在 .NET 上你有[DirectShow.NET](http://directshownet.sourceforge.net/)），在 DirectShow 中你有多个文件在同一个图表上的符号。

您将能够控制在哪个音频设备上播放哪些文件，并且您的播放、暂停、停止命令将对所有文件执行，而无需担心同步。有很多关于如何使用 DiectShow 构建媒体播放器的示例，将它们扩展为使用多个文件应该非常容易。

对于硬件，请查看[此](http://www.esi-audio.com/products/gigaporthd/)（带有 8 个输出通道的 USB）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T21:59:05.580

我认为使用 Shay 的硬件，您可以获得完整的解决方案：在每个通道上使用不同的单声道音轨对 7.1 文件进行编码。在 7.1 模式下使用 8 通道输出设备，在每个端口上使用不同的耳机，就可以了。或者，如果您只有 6 种语言，则可以使用 5.1 文件。许多 PC 内置 5.1 输出，您只需要 3 个分配器即可从每个插孔中分离出左右声道。

您可以使用[Windows Media Encoder](http://www.microsoft.com/windows/windowsmedia/howto/articles/Multichannel.aspx)或其他专业音频工具进行编码。

# ruby-on-rails - Ruby IDE：值得一看吗？

> ID：774117
> 
> 赞同：3
> 
> 时间：2009-04-21T19:06:18.830
> 
> 标签：ruby-on-rails, ruby, ide, textmate

我目前在我所有的 Rails 开发中都使用 TextMate，我非常喜欢它，但我想知道我是否因为不使用 IDE 而遗漏了什么。有没有人从使用 TextMate 或其他强大的文本编辑器切换到 Ruby IDE？我错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T19:09:24.937

JetBrains 是为 Java 创建传奇的 IDEA IDE 的人，他们拥有[RubyMine](http://www.jetbrains.com/ruby/)的测试版。DHH有提过，一定不错！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T04:29:23.203

TextMate 是 Mac 上开发的王者，它并不太臃肿，并且有很多由使用这些特定语言的开发人员制作的好包。在我看来不能被打败。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-22T17:55:05.343

我认为 IntelliJ/RubyMine 非常好，因为我编写 Java 代码已经有一段时间了。Rails 开发存在一些功能漏洞，但我预计 Jetbrains 将在未来版本中快速修复这些漏洞。

我刚开始使用 Textmate，因为我的笔记本电脑是 Powerbook 12" G4。运行 IntelliJ 非常快，但它会使风扇不断运转，音量接近“飞机引擎”。使用 Textmate 可以让我的笔记本电脑保持安静。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T16:57:19.053

在我看来，如果你有 Mac，**textmate是最好的 IDE。**它是高度可定制的，你几乎可以用它做任何你想做的事情。此外，许多开发人员正在使用 textmate for rails，因此创建了可以导入和使用的脚本和功能。

当我在 Windows 上时，我将**Aptana**与**radrails一起使用，但效果不是很好。**另外，您无法对其进行太多自定义。另一个问题是，由于它基于 Eclipse，因此它的资源非常密集，并且根据我的经验，它不如 textmate 稳定。Aptana 有一些很酷的功能，比如能够直接从界面调用脚本/生成和 rake 任务，但这是我可以没有的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T20:22:19.397

我使用 Netbeans 是因为我喜欢测试支持和测试覆盖率特性以及我可以将它用于多种语言和环境的事实。他们确实试图提供一个完整的环境，但我发现我仍然需要经常使用命令行——启动thinking_sphinx、运行黄瓜、拖尾日志等。所以它从来都不是很全面。在我慢得要命的笔记本电脑上，它也慢得要命。

我使用了一段时间的 eclipse rails 插件，它也很不错，但 Netbeans 6.5 的功能激增。这赢得了我的支持。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-18T04:08:06.240

> 有没有人从使用 TextMate 或其他强大的文本编辑器切换到 Ruby IDE？我错过了什么吗？

是的，我最近从 Vim 切换到[RubyMine](http://www.jetbrains.com/ruby/)。（在此之前我也使用过 TextMate。）我个人认为这种权衡是值得的，因为 RubyMine 的设计和实现非常好。因此，工具的质量弥补了更大的占地面积。

我觉得我在 Vim 中“缺少”的东西包括良好实现的代码完成、通过键入部分文件名打开文件、单击符号转到声明以及许多其他东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-21T19:09:10.447

[Aptana RadRails](http://aptana.com/rails)是目前最好的 Ruby IDE 之一，具有 Rails 支持、HTML 编辑器等。它是 Eclipse 的插件，也是独立提供的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-22T18:27:01.770

如果你在 Windows 上，你可能想看看[“Ruby in Steel”](http://www.sapphiresteel.com/)

我刚刚找到它并没有使用它太多，但是到目前为止的体验很好。因此，如果您在工作中使用 VisualStudio，这可能是一个很好的插件，可以帮助 Ruby 进入相同的环境。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-27T14:26:52.840

在 Mac 上，这可能不值得，因为 TextMate 通过捆绑包针对 Rails 开发进行了非常优化。不过，当我在 Windows 上时，我确实使用了 AptanaIDE。这里的主要问题不是 IDE 本身，而是它在我拥有的机器上不可用（就像足够快的那样）。奇怪的是，对于 Ruby 程序员来说，我认为在 1Ghz/Gbyte 机器上编辑无格式文本感觉迟缓的程序做错了什么。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-22T16:59:36.537

我真的很喜欢[Komod](http://www.activestate.com/komodo_edit/)用于 Ruby 和 Python 开发。

# asp.net - 在 ASP.NET 的 URL 中检索锚链接

> ID：774136
> 
> 赞同：23
> 
> 时间：2009-04-21T19:09:20.977
> 
> 标签：asp.net, anchor

我有一个这样的网址：

http://localhost/place/663828/bangkok-paradise-restaurant-toronto#r306040

我试图查看是否存在锚标记以及获取其值以在后面的代码中执行一些代码逻辑。

我一直在尝试使用 Page.Request，但没有一个属性显示 URL 的锚链接部分。

例如：

```
Response.Write(this.Page.Request.RawUrl.ToString()); 
```

我几乎尝试了此页面上的组合/属性：[http ://www.west-wind.com/weblog/posts/269.aspx](http://www.west-wind.com/weblog/posts/269.aspx)

只是为了完成这个话题：

我用永久链接复制了 Stack Overflow 的方法...：D

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-21T19:19:17.083

在 ASP.NET 中无法从服务器端检索 #anchor。

这是一个客户端标志，告诉浏览器移动到页面中的特定位置。

您可以在正文*onLoad事件中使用一些 JavaScript 代码来检查锚点并使用*[Ajax](https://en.wikipedia.org/wiki/Ajax_%28programming%29)将其发送回服务器。

```
var anchorValue;
var url = document.location;
var strippedUrl = url.toString().split("#");
if(strippedUrl.Length > 1)
    anchorvalue = strippedUrl[1]; 
```

参考：*[从 URL 中检索锚值](http://www.wacdesigns.com/2008/01/16/retrieving-anchor-value-from-url/)*

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-21T19:38:33.200

更明确地说，任何浏览器都不会将锚标记作为 HTTP 请求的一部分发送。它仅在浏览器中本地解释。ASP.NET 或任何其他 Web 服务器技术、Microsoft 或其他方式都不会看到该请求的锚点。

> [RFC 1808](http://www.isi.edu/in-notes/rfc1808.txt) 第 2.4.1 节 - “请注意，片段标识符不被视为 URL 的一部分。”

正如其他人所建议的那样，您可以获得的最接近的方法是使用客户端来读取浏览器窗口位置。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-14T12:23:51.663

可以通过以下方式从 C# 中的 URL 解析片段：

```
var uri = new Uri("http://localhost?id=2#token=23");
var fragment = uri.Fragment; // Will return #token=23 
```

There is a problem however in that the *browser* won't send fragments to the server. If you receive requests from a service that includes this information in the request, it will be available from the server side too.

# session - 将自定义用户信息存储在身份验证票证中，而不是成员资格提供程序中

> ID：774165
> 
> 赞同：1
> 
> 时间：2009-04-21T19:18:44.587
> 
> 标签：session, forms-authentication, cookies, membership, roles

我一直在研究实现一个自定义的基于 SQL Server 的成员资格提供程序，我的问题之一是membershipUserObject 是在 GUID 上键入的。由于我使用现有的 ID 作为角色和用户数据的键，这提出了一个有趣的问题。

如果我想在 Web 会话中保留我自己的 ID，而不需要经常往返于数据库，我希望您对使用哪个选项（或者是否有其他我没有考虑过的选项）发表意见。我知道，默认情况下，登录控件会使用成员资格对象的用户名创建一个表单身份验证 cookie。所以，我可以：

1.  实现登录控件的 Logging_In 方法，手动将我的字段添加到身份验证 cookie

> if (Membership.ValidateUser(Login1.UserName, Login1.Password)) { FormsAuthenticationTicket ticket = new FormsAuthenticationTicket( 1, Login1.UserName, DateTime.Now, DateTime.Now.AddMinutes(30), Login1.RememberMeSet,
> 
> "一些自定义数据想要存储在票证中......", // 用户数据，在本例中为角色 FormsAuthentication.FormsCookiePath);
> 
> 字符串哈希 = FormsAuthentication.Encrypt(ticket); HttpCookie cookie = new HttpCookie(FormsAuthentication.FormsCookieName, hash);
> 
> if (ticket.IsPersistent) cookie.Expires = ticket.Expiration;
> 
> Response.Cookies.Add(cookie);

2.  创建一个自定义 MembershipUser 对象，该对象继承自 MembershipUser 并提供我的额外属性。我仍然必须以某种方式坚持它（在会话中？eww ..）

3.  创建一个包含额外字段的自定义配置文件提供程序并将其缓存在会话中。不过，对于我实际缓存的少数字段，这似乎有点矫枉过正。

这里的最佳做法是什么？我已经阅读了无数文章，并且表单票中的额外数据似乎是迄今为止最好的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T19:38:24.417

MembershipUser.ProviderUserKey 是对象类型，使用默认提供者我们将其转换为 Guid 以便使用它。

由于您使用的是自定义会员提供程序，当您从数据库中检索用户时，您不能使用 int（或您的 id 的任何类型）填充 MembershipUser.ProviderUserKey 吗？当然，每次您想使用它时，您都必须将 MembershipUser.ProviderUserKey 转换为 int。

# php - 如何使用 PHP 从 MySQL 中提取信息？

> ID：774172
> 
> 赞同：0
> 
> 时间：2009-04-21T19:21:24.427
> 
> 标签：php, mysql

我在问是否不仅可以从 MySQL 表中提取数据，还可以在表或 DIV 中显示每一行，最好是 DIV。我该怎么做？

桌子：

ID |正文 |标题 |

1 |你好世界1 |标题1 |
2 |你好世界2 |标题2 |
ETC..

我想将每一行放入一个具有标题和正文的 DIV 中，但我希望 php 生成这些表并将信息放入每个 DIV 中。

有可能做到吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-21T19:41:00.353

我们将使用此表作为示例数据集：

```
Database Name: friends
-----------------------------
| firstname  ||  lastname  |
----------------------------
|Chris       || Geizz       |
|Steve       || Michalson   |
|Ken         || Bohlin      |  
|Doug        || Renard      | 
----------------------------- 
```

首先，您必须像这样连接到您的数据库：

[http://www.w3schools.com/PHP/php_mysql_connect.asp](http://www.w3schools.com/PHP/php_mysql_connect.asp)

您将运行 MYSQL 查询以从 MySQL 数据库中获取数据：

```
$query =  mysql_query("SELECT * FROM friends"); 
```

然后，您将使用以下内容将它们放入表中：

```
echo "<table><tr><td>First Name</td><td>Last Name</td></tr>";

while($row = mysql_fetch_array($query))
{
    echo "<tr><td>";
    echo $row['firstname'];
    echo "</td><td>";
    echo $row['lastname'];
    echo "</td></tr>";
}

echo "</table>"; 
```

这基本上做的是提取我的 mysql_query 返回的信息并将其放入一个数组中，您可以使用我们设置的 $row 变量调用该数组。我们在 while 循环中执行此操作，以便它对数据库中的所有记录重复。

while 循环之前和 while 循环之后的代码都在那里，因此它们都在一个表中，我们只是为数据库中的每一行创建行而不是单独的表。

这将完成你想要的。当您执行 while 循环时，您可以根据需要使用变量（$row['firstname'] 和 $row['lastname']）。如果您愿意，也可以将它们放在单独的 DIV 中。

希望这对你有帮助！如果您有任何问题，请发表评论，我会回复。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-21T19:31:49.020

基本上你可以做任何你想做的事，一旦你有了行集。此类代码的一般结构（如果未划分层/MVC）如下所示：

```
connect to db
write query
retrieve results

loop for each row in resultset
{
    echo html and column content as you wish
} 
```

所以例如你可以使用

```
foreach ($rowset as $row)
{
    echo '<div>'.$row['column1'].' is a friend of '.$row['column2'].'</div>';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T19:37:03.313

```
<?php
    $result = mysql_query("SELECT * from table");

    if($result && mysql_num_rows($result))
    {
        $numrows = mysql_num_rows($result);
        $rowcount = 1;

        while($row = mysql_fetch_assoc($result))
        {
            print "<div><b>$rowcount</b>";
            foreach($row as $var => $val)
            {
                print"|$var: $val|";
            }
            print "</div>";
            ++$rowcount;
        }
    }
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T19:32:00.173

以下是如何访问/查询 MySQL 数据库的手册页：

*   MySQL：[http ://www.php.net/manual/en/book.mysql.php](http://www.php.net/manual/en/book.mysql.php)
*   MySQLi：[http ://www.php.net/manual/en/book.mysqli.php](http://www.php.net/manual/en/book.mysqli.php)

使用那里的功能，您可以轻松查询和显示您认为合适的数据。如果您想访问列信息（字段名称），您要么需要使用[information_schema](http://dev.mysql.com/doc/refman/5.0/en/information-schema.html)表的访问权限，要么使用[describe table](http://dev.mysql.com/doc/refman/5.0/en/describe.html)之类的查询。

**更新：**根据评论，这个问题更多地与塔昆的回答有关。

# delphi - Delphi中dxDBGrid中的多个列标题行？

> ID：774173
> 
> 赞同：0
> 
> 时间：2009-04-21T19:21:38.293
> 
> 标签：delphi, grid

用户希望网格在列标题中有多行，但我没有找到解决方案。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T19:34:58.043

您是否尝试过 TdxDBGridColumn 的 HeaderMaxLineCount 属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-18T10:56:11.200

附加信息：

当您使用 devexpress 中的**cxGrid**组件时，您必须将 HeaderAutoHeight 属性设置为 true（属于 cxGridDBTableView）。

# windows - 显示 Windows 批处理文件中的弹出/消息框

> ID：774175
> 
> 赞同：161
> 
> 时间：2009-04-21T19:21:54.410
> 
> 标签：windows, batch-file, command-line, messagebox

有没有办法从批处理文件中显示消息框（类似于如何`xmessage`从 Linux 中的 bash 脚本中使用）？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-04-21T19:36:08.867

首先，DOS 与它无关，您可能想要一个 Windows 命令行解决方案（再次：没有 DOS，纯 Windows，只是不是一个窗口，而是一个控制台）。

您可以使用 boflynn 提供的 VBScript 方法，也可以误用`net send`或`msg`. `net send`仅适用于旧版本的 Windows：

```
net send localhost Some message to display 
```

不过，这也取决于要运行的 Messenger 服务。

对于较新的版本（显然是 XP 及更高版本）：

```
msg "%username%" Some message to display 
```

需要注意的是，使用 发送的消息框`msg.exe`只会持续 60 秒。然而，这可以被`/time:xx`开关覆盖。

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2009-04-21T19:26:00.997

我会制作一个非常简单的 VBScript 文件并使用 CScript 调用它来解析命令行参数。

类似以下内容的内容保存在`MessageBox.vbs`：

```
Set objArgs = WScript.Arguments
messageText = objArgs(0)
MsgBox messageText 
```

你会这样称呼：

```
cscript MessageBox.vbs "This will be shown in a popup." 
```

[`MsgBox`](http://msdn.microsoft.com/en-us/library/sfw6660x%28v=vs.84%29.aspx)如果您有兴趣走这条路线，请[参考。](http://msdn.microsoft.com/en-us/library/sfw6660x%28v=vs.84%29.aspx)

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2012-01-22T22:10:17.823

可能会显示一点闪光，但不需要临时文件。应该一直工作到（IIRC）IE5时代的某个地方。

```
mshta javascript:alert("Message\n\nMultiple\nLines\ntoo!");close(); 
```

如果您正在使用，请不要忘记[转义括号](https://stackoverflow.com/questions/12976351/escaping-parentheses-within-parentheses-for-batch-file)`if`：

```
if 1 == 1 (
   mshta javascript:alert^("1 is equal to 1, amazing."^);close^(^);
) 
```

* * *

## 回答 #4

> 赞同：81
> 
> 时间：2009-04-21T19:45:11.670

这将弹出另一个命令提示符窗口：

```
START CMD /C "ECHO My Popup Message && PAUSE" 
```

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2009-09-23T14:43:31.293

尝试 ：

```
Msg * "insert your message here" 
```

如果您使用的是 Windows XP 的 command.com，这将打开一个消息框。

我收集到，打开一个新的 cmd 窗口并不是您所要求的。您也可以使用[VBScript](http://en.wikipedia.org/wiki/VBScript)，并将其与您的 .bat 文件一起使用。您可以使用以下命令从 bat 文件中打开它：

```
cd C:\"location of vbscript" 
```

这样做是更改目录 command.com 将从中搜索文件，然后在下一行：

```
"insert name of your vbscript here".vbs 
```

然后创建一个新的[记事本](http://en.wikipedia.org/wiki/Notepad_%28Windows%29)文档，输入

```
<script type="text/vbscript">
    MsgBox "your text here"
</script> 
```

然后将其保存为 .vbs 文件（通过将“.vbs”放在文件名的末尾），在文件名下方的下拉框中另存为“所有文件”（因此它不会另存为 .txt )，然后单击保存！

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2014-09-19T02:03:40.133

还有几个方法。

**1)**最极客和最黑客 - 它使用 IEXPRESS 创建小型 exe，该 exe 将创建一个带有单个按钮的弹出窗口（[它可以创建另外两种类型的弹出消息](http://www.dostips.com/forum/viewtopic.php?f=3&t=5901)）。适用于 XP 及更高版本的每个窗口：

```
;@echo off
;setlocal

;set ppopup_executable=popupe.exe
;set "message2=click OK to continue"
;
;del /q /f %tmp%\yes >nul 2>&1
;
;copy /y "%~f0" "%temp%\popup.sed" >nul 2>&1

;(echo(FinishMessage=%message2%)>>"%temp%\popup.sed";
;(echo(TargetName=%cd%\%ppopup_executable%)>>"%temp%\popup.sed";
;(echo(FriendlyName=%message1_title%)>>"%temp%\popup.sed"
;
;iexpress /n /q /m %temp%\popup.sed
;%ppopup_executable%
;rem del /q /f %ppopup_executable% >nul 2>&1

;pause

;endlocal
;exit /b 0

[Version]
Class=IEXPRESS
SEDVersion=3
[Options]
PackagePurpose=InstallApp
ShowInstallProgramWindow=1
HideExtractAnimation=1
UseLongFileName=0
InsideCompressed=0
CAB_FixedSize=0
CAB_ResvCodeSigning=0
RebootMode=N
InstallPrompt=%InstallPrompt%
DisplayLicense=%DisplayLicense%
FinishMessage=%FinishMessage%
TargetName=%TargetName%
FriendlyName=%FriendlyName%
AppLaunched=%AppLaunched%
PostInstallCmd=%PostInstallCmd%
AdminQuietInstCmd=%AdminQuietInstCmd%
UserQuietInstCmd=%UserQuietInstCmd%
SourceFiles=SourceFiles
[SourceFiles]
SourceFiles0=C:\Windows\System32\
[SourceFiles0]
%FILE0%=

[Strings]
AppLaunched=subst.exe
PostInstallCmd=<None>
AdminQuietInstCmd=
UserQuietInstCmd=
FILE0="subst.exe"
DisplayLicense=
InstallPrompt= 
```

**2）**使用`MSHTA`。也适用于 XP 及更高版本的每台 Windows 机器（尽管 OP 不想要“外部”语言，但此处的 JavaScript 已最小化）。应保存为`.bat`：

```
@if (true == false) @end /*!
@echo off
mshta "about:<script src='file://%~f0'></script><script>close()</script>" %*
goto :EOF */

alert("Hello, world!"); 
```

或在一行中：

```
mshta "about:<script>alert('Hello, world!');close()</script>" 
```

或者

```
mshta "javascript:alert('message');close()" 
```

或者

```
mshta.exe vbscript:Execute("msgbox ""message"",0,""title"":close") 
```

**3）**这里是参数化的`.bat/jscript`混合（应该保存为`bat`）。尽管有 OP 请求，但它再次使用 JavaScript，但由于它是一个 bat，因此可以毫无顾虑地将其称为 bat 文件。它使用[POPUP比更流行的](http://msdn.microsoft.com/en-us/library/x83z1d9f(v=vs.84).aspx)[MSGBOX](http://msdn.microsoft.com/en-us/library/sfw6660x(v=vs.84).aspx)允许更多的控制。它使用 WSH，但不像上面的示例那样使用 MSHTA。

```
 @if (@x)==(@y) @end /***** jscript comment ******
     @echo off

     cscript //E:JScript //nologo "%~f0" "%~nx0" %*
     exit /b 0

 @if (@x)==(@y) @end ******  end comment *********/

var wshShell = WScript.CreateObject("WScript.Shell");
var args=WScript.Arguments;
var title=args.Item(0);

var timeout=-1;
var pressed_message="button pressed";
var timeout_message="timed out";
var message="";

function printHelp() {
    WScript.Echo(title + "[-title Title] [-timeout m] [-tom \"Time-out message\"] [-pbm \"Pressed button message\"]  [-message \"pop-up message\"]");
}

if (WScript.Arguments.Length==1){
    runPopup();
    WScript.Quit(0);
}

if (args.Item(1).toLowerCase() == "-help" || args.Item(1).toLowerCase() == "-h" ) {
    printHelp();
    WScript.Quit(0);
}

if (WScript.Arguments.Length % 2 == 0 ) {
    WScript.Echo("Illegal arguments ");
    printHelp();
    WScript.Quit(1);
}

for (var arg = 1 ; arg<args.Length;arg=arg+2) {

    if (args.Item(arg).toLowerCase() == "-title") {
        title = args.Item(arg+1);
    }

    if (args.Item(arg).toLowerCase() == "-timeout") {
        timeout = parseInt(args.Item(arg+1));
        if (isNaN(timeout)) {
            timeout=-1;
        }
    }

    if (args.Item(arg).toLowerCase() == "-tom") {
        timeout_message = args.Item(arg+1);
    }

    if (args.Item(arg).toLowerCase() == "-pbm") {
        pressed_message = args.Item(arg+1);
    }

    if (args.Item(arg).toLowerCase() == "-message") {
        message = args.Item(arg+1);
    }
}

function runPopup(){
    var btn = wshShell.Popup(message, timeout, title, 0x0 + 0x10);

    switch(btn) {
        // button pressed.
        case 1:
            WScript.Echo(pressed_message);
            break;

        // Timed out.
        case -1:
           WScript.Echo(timeout_message);
           break;
    }
}

runPopup(); 
```

**4）**和一个 `jscript.net/.bat`混合（应该保存为`.bat`）。这次它使用`.NET`并编译一个`.exe`可以删除的小文件：

```
@if (@X)==(@Y) @end /****** silent jscript comment ******

@echo off
::::::::::::::::::::::::::::::::::::
:::       compile the script    ::::
::::::::::::::::::::::::::::::::::::
setlocal

::if exist "%~n0.exe" goto :skip_compilation

:: searching the latest installed .net framework
for /f "tokens=* delims=" %%v in ('dir /b /s /a:d /o:-n "%SystemRoot%\Microsoft.NET\Framework\v*"') do (
    if exist "%%v\jsc.exe" (
        rem :: the javascript.net compiler
        set "jsc=%%~dpsnfxv\jsc.exe"
        goto :break_loop
    )
)
echo jsc.exe not found && exit /b 0
:break_loop

call %jsc% /nologo /out:"%~n0.exe" "%~f0" 
::::::::::::::::::::::::::::::::::::
:::       end of compilation    ::::
::::::::::::::::::::::::::::::::::::
:skip_compilation

::
::::::::::
"%~n0.exe" %*
::::::::
::
endlocal
exit /b 0

****** end of jscript comment ******/

import System;
import System.Windows;
import System.Windows.Forms

var arguments:String[] = Environment.GetCommandLineArgs();
MessageBox.Show(arguments[1],arguments[0]); 
```

**5）**最后一次调用powershell创建一个弹出窗口（如果安装了powershell，可以从命令行或批处理调用）：

```
powershell [Reflection.Assembly]::LoadWithPartialName("""System.Windows.Forms""");[Windows.Forms.MessageBox]::show("""Hello World""", """My PopUp Message Box""") 
```

**6）**[这里](https://stackoverflow.com/a/12516524/388389)看到的dbenham的方法

```
start "" cmd /c "echo(&echo(&echo              Hello world!     &echo(&pause>nul" 
```

**7** ) 对于系统托盘通知，您可以试试[这个](https://github.com/npocmaka/batch.scripts/blob/master/hybrids/.net/SystemTrayNotification.bat)：

```
call SystemTrayNotification.bat  -tooltip warning -time 3000 -title "Woow" -text "Boom" -icon question 
```

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2011-03-02T23:56:01.583

这样，您的批处理文件将创建一个 VBS 脚本并显示一个弹出窗口。运行后，批处理文件将删除该中间文件。

使用 MSGBOX 的优点是它确实是可定制的（更改标题、图标等），而 MSG.exe 则没有那么多。

```
echo MSGBOX "YOUR MESSAGE" > %temp%\TEMPmessage.vbs
call %temp%\TEMPmessage.vbs
del %temp%\TEMPmessage.vbs /f /q 
```

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2017-02-22T20:27:52.640

这是一个 PowerShell 变体，它不需要在创建窗口之前加载程序集，但是它的运行速度明显比@npocmaka 在此处发布的 PowerShell MessageBox 命令慢（~+50%）：

```
powershell (New-Object -ComObject Wscript.Shell).Popup("""Operation Completed""",0,"""Done""",0x0) 
```

您可以将最后一个参数从“0x0”更改为以下值以在对话框中显示图标（请参阅[弹出方法](https://msdn.microsoft.com/en-us/library/x83z1d9f(v=vs.84).aspx)以获取更多参考）：

        [![停止](https://i.stack.imgur.com/nWMdU.png)](https://i.stack.imgur.com/nWMdU.png)0x10 停止
        [![问号](https://i.stack.imgur.com/MzIeL.png)](https://i.stack.imgur.com/MzIeL.png)0x20 问号
        [![感叹号](https://i.stack.imgur.com/vnNZ5.png)](https://i.stack.imgur.com/vnNZ5.png)0x30 感叹号
        [![信息标记](https://i.stack.imgur.com/CW5yC.png)](https://i.stack.imgur.com/CW5yC.png)0x40 信息标记

改编自 Microsoft TechNet 文章[PowerTip：使用 PowerShell 显示弹出窗口](https://blogs.technet.microsoft.com/heyscriptingguy/2014/04/04/powertip-use-powershell-to-display-pop-up-window/)。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2013-10-17T18:29:21.073

```
echo X=MsgBox("Message Description",0+16,"Title") >msg.vbs 
```

– 您可以写 0、1、2、3、4 中的任何数字，而不是 0（在“+”符号之前）& 这里是每个数字的含义：

```
0 = Ok Button  
1 = Ok/Cancel Button  
2 = Abort/Retry/Ignore button  
3 = Yes/No/Cancel  
4 = Yes/No 
```

– 您可以写 16、32、48、64 中的任何数字，而不是 16（在“+”符号之后）& 这里是每个数字的含义：

```
16 – Critical Icon  
32 – Warning Icon  
48 – Warning Message Icon   
64 – Information Icon 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2011-02-21T22:38:00.023

Msg * "在此处插入您的信息"

工作正常，只需在记事本中保存为 .bat 文件或确保格式设置为“所有文件”

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2016-05-26T04:48:36.307

```
msg * /time:0 /w Hello everybody! 
```

此消息将永远等待，直到单击 OK（默认情况下仅持续一分钟）并且在 Windows 8.1 中正常工作

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-04-21T19:24:48.537

为此，您需要有一个小程序来显示消息框并从批处理文件中运行它。

您可以打开一个显示提示的控制台窗口，但仅使用 cmd.exe 和朋友获取 GUI 消息框是不可能的，AFAIK。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-11-21T07:25:13.250

我在这里使用了一个名为 msgbox.exe 的实用程序：http: [//www.paulsadowski.com/WSH/cmdprogs.htm](http://www.paulsadowski.com/WSH/cmdprogs.htm)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-07-16T09:52:27.350

您可以使用[Zenity](https://live.gnome.org/Zenity)。Zenity 允许在命令行和 shell 脚本中执行对话框。更多信息也可以在[Wikipedia](http://en.wikipedia.org/wiki/Zenity)上找到。

它是跨平台的：可以在[此处](http://www.placella.com/software/zenity/)找到适用于 Windows 的 Windows 安装程序。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2017-04-18T07:14:22.757

按照@Fowl的回答，您可以使用以下方法通过超时来改进它，使其仅出现10秒：

```
mshta "javascript:var sh=new ActiveXObject( 'WScript.Shell' ); sh.Popup( 'Message!', 10, 'Title!', 64 );close()" 
```

有关更多详细信息，请参见[此处](https://stackoverflow.com/a/21165566/679334)。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2015-10-19T01:47:52.990

您可以从 user32.dll 调用 dll 函数，我认为类似

> Rundll32.exe user32.dll, MessageBox (0, "text", "titleText", {extra flags for like topmost messagebox etc})

从我的手机输入，不要评判我......否则我会链接额外的标志。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-07-22T00:08:20.877

msg * /server:127.0.0.1 在此处输入您的消息

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-08-26T17:34:23.333

如果您将批处理文件转换（包装）为可执行文件，此[应用程序可以做到这一点。](http://www.f2ko.de/en/b2e.php)

* * *

1.  **简单的消息框**

    ```
    %extd% /messagebox Title Text 
    ```

* * *

2.  **错误消息框**

    ```
    %extd% /messagebox  Error "Error message" 16 
    ```

3.  **取消重试消息框**

    ```
    %extd% /messagebox Title "Try again or Cancel" 5 
    ```

* * *

**4）“不再问我”消息框**

```
%extd% /messageboxcheck Title Message 0 {73E8105A-7AD2-4335-B694-94F837A38E79} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-11-25T21:10:02.240

**更好的选择**

**`set my_message=Hello world`**`&& start cmd /c "@echo off & mode con cols=15 lines=2 & echo %my_message% & pause>nul"`

* * *

说明：
`lines=` 行数，加1
`cols=` 字数，加3（但必须最少`15`）

# 自动计算`cols`版本：

**`set my_message=Hello world`**`&& (echo %my_message%>EMPTY_FILE123 && FOR %? IN (EMPTY_FILE123 ) DO SET strlength=%~z? && del EMPTY_FILE123 ) && start cmd /c "@echo off && mode con lines=2 cols=%strlength% && echo %my_message% && pause>nul"`

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-02-06T03:33:37.647

这是我根据此处和其他帖子中的好答案整理的批处理脚本

您可以设置标题超时甚至睡眠以安排后者和 \n 用于新行

将其命名为 popup.bat 并将其放在您的 Windows 路径文件夹中，以便在您的 PC 上全局工作

例如`popup Line 1\nLine 2`将产生一个 2 行弹出框（`popup /?`使用类型）

这是代码

```
<!-- : Begin CMD
@echo off
cscript //nologo "%~f0?.wsf" %*
set pop.key=[%errorlevel%]
if %pop.key% == [-1] set pop.key=TimedOut
if %pop.key% == [1]  set pop.key=Ok
if %pop.key% == [2]  set pop.key=Cancel
if %pop.key% == [3]  set pop.key=Abort
if %pop.key% == [4]  set pop.key=Retry
if %pop.key% == [5]  set pop.key=Ignore
if %pop.key% == [6]  set pop.key=Yes
if %pop.key% == [7]  set pop.key=No
if %pop.key% == [10] set pop.key=TryAgain
if %pop.key% == [11] set pop.key=Continue
if %pop.key% == [99] set pop.key=NoWait
exit /b 
-- End CMD -->

<job><script language="VBScript">
'on error resume next
q   =""""
qsq =""" """
Set objArgs = WScript.Arguments
Set objShell= WScript.CreateObject("WScript.Shell")
Popup       =   0
Title       =   "Popup"
Timeout     =   0
Mode        =   0
Message     =   ""
Sleep       =   0
button      =   0
If objArgs.Count = 0 Then 
    Usage()
ElseIf objArgs(0) = "/?" or Lcase(objArgs(0)) = "-h" or Lcase(objArgs(0)) = "--help" Then 
    Usage()
End If
noWait = Not wait() 
For Each arg in objArgs
    If (Mid(arg,1,1) = "/") and (InStr(arg,":") <> 0) Then haveSwitch   =   True
Next
If not haveSwitch Then 
    Message=joinParam("woq")
Else
    For i = 0 To objArgs.Count-1 
        If IsSwitch(objArgs(i)) Then 
            S=split(objArgs(i) , ":" , 2)
                select case Lcase(S(0))
                    case "/m","/message"
                        Message=S(1)
                    case "/tt","/title"
                        Title=S(1)
                    case "/s","/sleep"
                        If IsNumeric(S(1)) Then Sleep=S(1)*1000
                    case "/t","/time"
                        If IsNumeric(S(1)) Then Timeout=S(1)
                    case "/b","/button"
                        select case S(1)
                            case "oc", "1"
                                button=1
                            case "ari","2"
                                button=2
                            case "ync","3"
                                button=3
                            case "yn", "4"
                                button=4
                            case "rc", "5"
                                button=5
                            case "ctc","6"
                                button=6
                            case Else
                                button=0
                        end select
                    case "/i","/icon"
                        select case S(1)
                            case "s","x","stop","16"
                                Mode=16
                            case "?","q","question","32"
                                Mode=32
                            case "!","w","warning","exclamation","48"
                                Mode=48
                            case "i","information","info","64"
                                Mode=64
                            case Else 
                                Mode=0
                        end select
                end select
        End If
    Next
End If
Message = Replace(Message,"/\n", "°"  )
Message = Replace(Message,"\n",vbCrLf)
Message = Replace(Message, "°" , "\n")
If noWait Then button=0

Wscript.Sleep(sleep)
Popup   = objShell.Popup(Message, Timeout, Title, button + Mode + vbSystemModal)
Wscript.Quit Popup

Function IsSwitch(Val)
    IsSwitch        = False
    If Mid(Val,1,1) = "/" Then
        For ii = 3 To 9 
            If Mid(Val,ii,1)    = ":" Then IsSwitch = True
        Next
    End If
End Function

Function joinParam(quotes)
    ReDim ArgArr(objArgs.Count-1)
    For i = 0 To objArgs.Count-1 
        If quotes = "wq" Then 
            ArgArr(i) = q & objArgs(i) & q 
        Else
            ArgArr(i) =     objArgs(i)
        End If
    Next
    joinParam = Join(ArgArr)
End Function

Function wait()
    wait=True
    If objArgs.Named.Exists("NewProcess") Then
        wait=False
        Exit Function
    ElseIf objArgs.Named.Exists("NW") or objArgs.Named.Exists("NoWait") Then
        objShell.Exec q & WScript.FullName & qsq & WScript.ScriptFullName & q & " /NewProcess: " & joinParam("wq") 
        WScript.Quit 99
    End If
End Function

Function Usage()
    Wscript.Echo _
                     vbCrLf&"Usage:" _
                    &vbCrLf&"      popup followed by your message. Example: ""popup First line\nescaped /\n\nSecond line"" " _
                    &vbCrLf&"      To triger a new line use ""\n"" within the msg string [to escape enter ""/"" before ""\n""]" _
                    &vbCrLf&"" _
                    &vbCrLf&"Advanced user" _
                    &vbCrLf&"      If any Switch is used then you must use the /m: switch for the message " _
                    &vbCrLf&"      No space allowed between the switch & the value " _
                    &vbCrLf&"      The switches are NOT case sensitive " _
                    &vbCrLf&"" _
                    &vbCrLf&"      popup [/m:""*""] [/t:*] [/tt:*] [/s:*] [/nw] [/i:*]" _
                    &vbCrLf&"" _
                    &vbCrLf&"      Switch       | value |Description" _
                    &vbCrLf&"      -----------------------------------------------------------------------" _
                    &vbCrLf&"      /m: /message:| ""1 2"" |if the message have spaces you need to quote it " _
                    &vbCrLf&"                   |       |" _
                    &vbCrLf&"      /t: /time:   | nn    |Duration of the popup for n seconds " _
                    &vbCrLf&"                   |       |<Default> untill key pressed" _
                    &vbCrLf&"                   |       |" _
                    &vbCrLf&"      /tt: /title: | ""A B"" |if the title have spaces you need to quote it " _
                    &vbCrLf&"                   |       | <Default> Popup" _
                    &vbCrLf&"                   |       |" _
                    &vbCrLf&"      /s: /sleep:  | nn    |schedule the popup after n seconds " _
                    &vbCrLf&"                   |       |" _
                    &vbCrLf&"      /nw /NoWait  |       |Continue script without the user pressing ok - " _
                    &vbCrLf&"                   |       | botton option will be defaulted to OK button " _
                    &vbCrLf&"                   |       |" _
                    &vbCrLf&"      /i: /icon:   | ?/q   |[question mark]"  _
                    &vbCrLf&"                   | !/w   |[exclamation (warning) mark]"  _
                    &vbCrLf&"                   | i/info|[information mark]"  _
                    &vbCrLf&"                   | x/stop|[stop\error mark]" _
                    &vbCrLf&"                   | n/none|<Default>" _
                    &vbCrLf&"                   |       |" _
                    &vbCrLf&"      /b: /button: | o     |[OK button] <Default>"  _
                    &vbCrLf&"                   | oc    |[OK and Cancel buttons]"  _
                    &vbCrLf&"                   | ari   |[Abort, Retry, and Ignore buttons]"  _
                    &vbCrLf&"                   | ync   |[Yes, No, and Cancel buttons]" _
                    &vbCrLf&"                   | yn    |[Yes and No buttons]" _
                    &vbCrLf&"                   | rc    |[Retry and Cancel buttons]" _
                    &vbCrLf&"                   | ctc   |[Cancel and Try Again and Continue buttons]" _
                    &vbCrLf&"      --->         | --->  |The output will be saved in variable ""pop.key""" _
                    &vbCrLf&"" _
                    &vbCrLf&"Example:" _
                    &vbCrLf&"        popup /tt:""My MessageBox"" /t:5 /m:""Line 1\nLine 2\n/\n\nLine 4""" _
                    &vbCrLf&"" _
                    &vbCrLf&"                     v1.9 By RDR @ 2020"
    Wscript.Quit
End Function

</script></job> 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-10-14T21:32:48.790

蝙蝠档案：

```
@echo off
echo wscript.Quit((msgbox("question?",4+32+256, "title")-6) Mod 255) > %temp%\msgbox.vbs
start /wait %temp%\msgbox.vbs
rem echo wscript returned %errorlevel%
if errorlevel 1 goto error
echo We have Yes
goto end
:error
echo We have No
:end
del %temp%\msgbox.vbs /f /q 
```

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2015-07-15T20:47:35.753

它只需要在虚拟机内弹出，所以从技术上讲，应该有一些代码，如：

```
if %machine_type% == virtual_machine then
   echo message box code
else
   continue normal installation code 
```

# c# - 在什么情况下脱离事件是必要的？

> ID：774176
> 
> 赞同：16
> 
> 时间：2009-04-21T19:22:25.063
> 
> 标签：c#, .net, events, event-handling

我不确定我是否完全清楚附加到对象中的事件的含义。

这是我目前的理解，正确或详细：

**1\. 附加到本地类事件不需要分离**

例子：

`this.Closing += new System.ComponentModel.CancelEventHandler(MainWindow_Closing);`

`public event EventHandler OnMyCustomEvent = delegate { };`

我假设当您的对象被处置或垃圾收集时，函数被释放并自动与事件分离。

**2\. 附加到不再需要的对象 (= null;) 必须从**

示例：附加到计时器的 Elapsed 事件，您只响应一次。我假设您需要将 Timer 存储在局部变量中，以便在事件触发后分离 Elapsed 事件。因此，像这样在本地方法范围内声明计时器会导致泄漏：

`System.Timers.Timer myDataTimer = new System.Timers.Timer(1000); myDataTimer.Elapsed += new System.Timers.ElapsedEventHandler(myDataTimer_Elapsed);`

**3\. 将本地对象中的事件附加到您的类不需要处置吗？**

例如，如果您有一个 ObservableCollection，您可以创建、监控并让其消失。如果您使用本地私有函数附加到 CollectionChanged 事件，当您的类被垃圾收集时，该函数不会释放，导致 ObservableCollection 也被释放吗？

我确定我有一些地方我已经停止使用对象并且未能从事件中分离（例如，我制作的计时器示例），所以我正在寻找关于它如何工作的更清晰的解释。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-21T19:26:44.477

我认为你让它变得比它需要的更复杂。你只需要记住两件事：

*   当您订阅事件时，事件的“所有者”（发布者）通常会保留对您订阅的委托的引用。
*   如果您使用实例方法作为委托的操作，则委托具有对其“目标”对象的引用。

这意味着如果你写：

```
publisher.SomeEvent += subscriber.SomeMethod; 
```

除非您稍后取消订阅，否则之前将`subscriber`没有资格进行垃圾收集。`publisher`

请注意，在许多情况下，`subscriber`只是`this`：

```
publisher.SomeEvent += myDataTimer_Elapsed; 
```

相当于：

```
publisher.SomeEvent += this.myDataTimer_Elapsed; 
```

假设它是一个实例方法。

*仅由于事件订阅不存在*反向关系 - 换句话说，订阅者不会让发布者保持活动状态。

顺便说一下，有关更多信息，请参阅[我关于事件和代表的文章。](http://pobox.com/~skeet/csharp/events.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T21:28:40.017

其余的防止垃圾收集的引用还有一个可能很明显但尚未在此线程中说明的效果；附加的事件处理程序也将被执行。

我经历过几次。一个是当我们有一个应用程序运行时间越长越慢。该应用程序通过加载用户控件以动态方式创建用户界面。容器使用户控件订阅环境中的某些事件，并且在“卸载”控件时未取消订阅其中之一。

过了一段时间，这导致每次引发特定事件时都会执行大量事件侦听器。当大量“睡眠”实例突然醒来并尝试对相同的输入采取行动时，这当然会导致严重的竞争条件。

简而言之; 如果您编写代码来连接事件侦听器；确保在不再需要时立即发布。我几乎敢于保证它会在未来的某个时候让你免于至少一次头痛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T19:28:04.677

您必须取消订阅事件的相关案例如下：

```
public class A
{
    // ...
    public event EventHandler SomethingHappened;
}

public class B
{
    private void DoSomething() { /* ... */ } // instance method

    private void Attach(A obj)
    {
       obj.SomethingHappened += DoSomething();
    }
} 
```

在这种情况下，当您处理 B 时，仍然会有来自`obj`的事件处理程序的悬空引用。如果要回收 B 的内存，则需要先`B.DoSomething()`与相关的事件处理程序分离。

如果事件订阅行看起来像这样，你可能会遇到同样的事情，当然：

```
obj.SomethingHappened += someOtherObject.Whatever.DoSomething(); 
```

现在它已经`someOtherObject`陷入困境，不能被垃圾收集。

# serialization - 对象的序列化

> ID：774177
> 
> 赞同：2
> 
> 时间：2009-04-21T19:22:27.793
> 
> 标签：serialization

对象的序列化如何工作？如何反序列化对象并从序列化日期创建实例而不调用任何构造函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T19:35:47.590

因为没有给出语言，所以我一直保持这个答案语言不可知论。

当对象被序列化时，重建它所需的所有信息都以可以检索的方式编码。这通常包括对象的类型，以及所有实例变量的值。

当对象被反序列化时，内存中正确大小的区域被分配并使用序列化信息填充，以便新对象与序列化对象相同。

然后，运行的程序可以在内存中引用这个新对象，而无需实际调用构造函数。

有很多小细节这里没有解释，但这是序列化/反序列化的一般概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T19:23:52.783

你在谈论Java吗？如果是这样，序列化是一种语言外的对象创建机制。这是一个后门，它使用本机代码创建对象而不调用任何构造函数。因此，在设计可序列化类时，您需要确保通过反序列化创建的类与通过构造函数路径创建的类保持相同的不变量（正在初始化的键字段）。在 Java 中创建对象的第三种方法是通过克隆，类似的问题也适用。

如果您需要将该字段的值设置为不同于克隆或反序列化过程返回的值，则克隆和序列化与使用 final 字段的交互效果不佳。

Josh Bloch 的“Effective Java”有一些章节更深入地解释了这些问题。

（这个答案也可能适用于其他语言，但我只在 Java 中使用过序列化）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T19:30:42.017

关于 .NET：这不是一个明确的或教科书式的答案，我可能完全错了......

.NET 序列化需要分离为二进制与其他（通常是 XML 或 XML 衍生）。二进制序列化对我来说主要是一个黑盒，但它允许对象被序列化并恢复到当前状态。XML 序列化通常只序列化对象的公共字段/属性，除非通过添加自定义 ISerializable 实现来覆盖。

在 XML 序列化的情况下，我相信 .NET 使用反射来确定哪些字段和属性被转换为它们的等效元素。添加 [XMLSerializable] 属性将实现默认行为，可以通过在字段级别应用其他属性（例如 [XMLAttribute]）来调整该行为。

元数据（Reflection 所依赖的）存储所有对象成员以及它们的属性和地址，这允许序列化程序确定它应该如何构建输出。

# php - PHP 的 PDO 准备方法在循环中失败

> ID：774178
> 
> 赞同：0
> 
> 时间：2009-04-21T19:22:56.967
> 
> 标签：php, mysql, pdo

给定以下代码：

```
// Connect to MySQL up here

$example_query = $database->prepare('SELECT * FROM table2');
if ($example_query === false) die('prepare failed');

$query = $database->prepare('SELECT * FROM table1');
$query->execute();
while ($results = $query->fetch())
{
    $example_query = $database->prepare('SELECT * FROM table2');
    if ($example_query === false) die('prepare failed'); //it will die here
} 
```

我显然尝试准备语句以从 table2 中选择所有内容两次。第二个（WHILE 循环中的那个）总是失败并导致错误。

这仅在我的生产服务器上，在本地开发我没有问题，所以它必须是某处的某种设置。

我的直接想法是 MySQL 有某种 max_connections 设置被设置为 1 并且连接保持打开直到 WHILE 循环完成所以当我尝试准备一个新查询时它说“没有太多连接已经”并且大便.

有任何想法吗？

**编辑：**是的，我知道没有必要做两次，在我的实际代码中，它只在 WHILE 循环中准备好，但就像我说的那样，在我的生产服务器上失败了，所以经过一些测试，我发现一个简单的 SELECT * 查询失败了WHILE 循环，但没有退出它。我给出的示例代码显然被淡化了，只是为了说明这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T19:52:52.820

问题是在运行无缓冲查询时我无法做某事（它在 WHILE 循环中）

解决方案是添加以下行以确保使用缓冲查询：

```
$database->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY,true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T19:26:19.250

不需要多次准备 $example_query 。只需在循环内执行查询。

**编辑：**如果您必须在每次循环迭代中准备一个新查询，循环结束时的显式 $example_query->closeCursor() 应该释放与语句对象关联的任何资源。

# java - Java：无法获得要打印的增量值。

> ID：774180
> 
> 赞同：1
> 
> 时间：2009-04-21T19:23:25.577
> 
> 标签：java, string, int, println

我正在学习做一些 Java 101 语法的东西。在我尝试做的练习中，我无法打印增量值。有任何想法吗？

这是我的代码：

```
class StaticTest { 
    static int i = 47;  
}
class incrementable { 
    static void increment() { StaticTest.i++; } 
}

class DataOnly { 

    int i;
    double d;
    boolean b; 

    public static void main (String[] args) { 
        incrementable t = new incrementable(); 
        DataOnly df = new DataOnly(); 
        df.i = t.increment(); 
        System.out.println(df.i);
    } 

} 
```

我得到的错误是：

```
aTyp0eName.java:18: incompatible types
found: void 
required: int 
df.i = t.increment(); 
```

`df.i`是一个`int`，所以是`t.increment`。我猜是因为`increment()`是`void`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T19:26:19.187

`increment()`没有返回值。你需要让它返回一个`int`你的代码才能工作：

```
class incrementable { 
    static int increment() { 
        StaticTest.i++;
        return StaticTest.i;
    } 
} 
```

" `void`" 是为不返回任何值的方法保留的关键字。否则，您指定返回什么类或原语（`int`, `double`, `String`, 不管）。[您可以在此处](http://java.sun.com/docs/books/tutorial/java/javaOO/returnvalue.html)阅读有关返回值的更多信息。

此外，为了将来参考，类名应该大写，所以你应该使用“Incrementable”而不是“incrementable”。（在我的示例代码中，我保持它与您的相同，因此您现在可以将代码放入其中。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-21T19:29:35.547

您的方法签名是：

```
static void 
```

这意味着此方法不会返回任何内容。

因此，尝试分配给`increment()`是`df.i`行不通的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T20:17:37.410

> *我得到的错误是：*

```
aTyp0eName.java:18: incompatible types
found: void 
required: int 
df.i = t.increment(); 
```

> *df.i 是一个 int 和 t.increment [故障？]。我猜这是因为 increment() 是无效的？*

Eeeexactly，你的猜测是正确的。

这是逐行解释的错误消息：

```
aTyp0eName.java:18: incompatible types 
```

您正在尝试将“void”分配给第 18 行的 int。

```
df.i = t.increment(); 
```

这是错误所在。

```
found: void 
```

您在方法“签名”中声明返回类型是什么。方法签名是：

```
<访问修饰符> <返回类型> <方法名>（<参数>）
静态无效增量（）

```

所以返回类型是无效的。

下一行：

```
required: int 
```

df.i 是 int 正如您之前所说的那样。

因此，您几乎已经回答了自己的问题。

拥有编译器的好处是它会在出现问题时告诉您。

坏事（对人类来说）你必须学会​​阅读这些信息。它们因编程语言而异，甚至因编译器而异。

这将是一个更正的版本：

```
class StaticTest { 
    static int i = 47;  
}
class Incrementable { 
    static int increment() { 
        return ++StaticTest.i;
    } 

}

class DataOnly { 

    int i;
    double d;
    boolean b; 

    public static void main (String[] args) { 
        Incrementable t = new Incrementable(); 
        DataOnly df = new DataOnly(); 
        df.i = t.increment(); 
        System.out.println(df.i);
    } 

} 
```

还可以进行一些其他增强，例如向方法和属性添加访问修饰符，但现在我认为这会有所帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T19:41:17.327

答案是 increment() 方法返回一个 void。话虽如此，程序员通常使用的Java标准语法有很多违反，即：

1.  类名应以大写字母开头。
2.  字段不应该从不同的类中改变，而是一个辅助方法应该在同一个类中
3.  如果要调用静态方法，请不要引用实例变量，而是使用 ClassName.reference
4.  如果仅在本地需要变量，则它不应该是字段（df.i 可能只是在 main 方法中声明的 int i）。

编辑：同一类中的辅助方法示例：

```
class StaticTest { 
    private static int i = 47; //keep i private and mutate and access via methods
    public static void increment() { i++; }
    public static int getI() { return i; }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T19:36:04.470

另外，你的`incrementable`课真的应该是`Incrementable`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T19:33:11.807

此外，如果您实例化可增量，则不应将方法 increment() 定义为静态。或者你可以，但不需要。

如果它是静态的，你可以简单地 incrementable.increment() 。

只是一个提示。至于你的问题的答案，toolkit 已经说过了。

# c# - 为什么我不能继承静态类？

> ID：774181
> 
> 赞同：238
> 
> 时间：2009-04-21T19:23:37.900
> 
> 标签：c#, inheritance, static

我有几个不需要任何状态的类。从组织的角度来看，我想把它们放在层次结构中。

但似乎我不能为静态类声明继承。

像这样的东西：

```
public static class Base
{
}

public static class Inherited : Base
{
} 
```

不管用。

为什么语言的设计者关闭了这种可能性？

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2009-04-21T19:27:20.217

[从这里](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=97955)引用：

> 这实际上是设计使然。似乎没有充分的理由继承静态类。它具有公共静态成员，您始终可以通过类名本身访问它们。**我所看到的继承静态内容的唯一原因是不好的，例如节省了几个打字字符。**
> 
> 可能有理由考虑将静态成员直接带入作用域的机制（实际上我们将在 Orcas 产品周期之后考虑这一点），但静态类继承不是要走的路：这是使用错误的机制，并且有效仅适用于恰好位于静态类中的静态成员。
> 
> *（Mads Torgersen，C# 语言 PM）*

来自channel9的其他意见

> **.NET 中的继承仅适用于实例库。**静态方法是在类型级别而不是在实例级别定义的。这就是为什么覆盖不适用于静态方法/属性/事件...
> 
> 静态方法只在内存中保存一次。没有为他们创建的虚拟表等。
> 
> 如果您在 .NET 中调用实例方法，则始终为其提供当前实例。这被 .NET 运行时隐藏了，但它确实发生了。**每个实例方法都有一个指向运行该方法的对象的指针（引用）作为第一个参数。静态方法不会发生这种情况**（因为它们是在类型级别定义的）。编译器应该如何决定选择要调用的方法？
> 
> *（小小）*

作为一个有价值的想法，*littleguru*为这个问题提供了部分“解决方法”：[Singleton](https://www.dofactory.com/net/singleton-design-pattern)模式。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-04-21T19:31:44.307

您不能继承静态类的主要原因是它们是抽象的和密封的（这也可以防止创建它们的任何实例）。

所以这：

```
static class Foo { } 
```

编译为此 IL：

```
.class private abstract auto ansi sealed beforefieldinit Foo
  extends [mscorlib]System.Object
 {
 } 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-04-21T19:29:51.363

这样想：您通过类型名称访问静态成员，如下所示：

```
MyStaticType.MyStaticMember(); 
```

如果您要从该类继承，则必须通过新类型名称访问它：

```
MyNewType.MyStaticMember(); 
```

因此，在代码中使用时，新项目与原始项目没有任何关系。对于多态性之类的事情，没有办法利用任何继承关系。

也许您认为您只想扩展原始类中的一些项目。在这种情况下，没有什么可以阻止您在全新类型中使用原始成员。

也许您想将方法添加到现有的静态类型。您已经可以通过扩展方法做到这一点。

也许您希望能够`Type`在运行时将静态传递给函数并调用该类型的方法，而无需确切知道该方法的作用。在这种情况下，您可以使用接口。

所以，最终你并没有从继承静态类中获得任何好处。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-21T19:26:23.227

嗯......如果你只是有一个充满静态方法的非静态类......会不会有很大不同？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-21T20:27:36.670

您想通过使用类层次结构来实现的目标可以仅通过命名空间来实现。因此，支持命名空间的语言（如 C#）将无法实现静态类的类层次结构。由于您不能实例化任何类，您所需要的只是类定义的分层组织，您可以通过使用命名空间获得它

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-03-10T14:19:03.537

您可以改用组合...这将允许您从静态类型访问类对象。但仍然无法实现接口或抽象类

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-21T20:50:15.040

虽然您可以通过继承的类名访问“继承的”静态成员，但静态成员并不是真正继承的。这就是为什么它们不能是虚拟的或抽象的，也不能被覆盖的部分原因。在您的示例中，如果您声明了 Base.Method()，编译器会将对 Inherited.Method() 的调用映射回 Base.Method()。您也可以显式调用 Base.Method() 。您可以编写一个小测试并使用 Reflector 查看结果。

所以......如果你不能继承静态成员，如果静态类只能包含*静态*成员，那么继承静态类有什么好处呢？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-14T21:16:42.877

你可以做一些看起来像静态继承的事情。

这是诀窍：

```
public abstract class StaticBase<TSuccessor>
    where TSuccessor : StaticBase<TSuccessor>, new()
{
    protected static readonly TSuccessor Instance = new TSuccessor();
} 
```

然后你可以这样做：

```
public class Base : StaticBase<Base>
{
    public Base()
    {
    }

    public void MethodA()
    {
    }
}

public class Inherited : Base
{
    private Inherited()
    {
    }

    public new static void MethodA()
    {
        Instance.MethodA();
    }
} 
```

该类`Inherited`本身不是静态的，但我们不允许创建它。它实际上继承了构建的静态构造函数`Base`，以及所有`Base`可用的静态属性和方法。现在唯一要做的就是为您需要公开给静态上下文的每个方法和属性制作静态包装器。

有一些缺点，比如需要手动创建静态包装方法和`new`关键字。但是这种方法有助于支持与静态继承非常相似的东西。

PS 我们用它来创建编译查询，它实际上可以用 ConcurrentDictionary 代替，但是具有线程安全性的静态只读字段就足够了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-05T16:21:43.867

您可以做的解决方法是不使用静态类，而是隐藏构造函数，因此类静态成员是类外部唯一可访问的东西。结果本质上是一个可继承的“静态”类：

```
public class TestClass<T>
{
    protected TestClass()
    { }

    public static T Add(T x, T y)
    {
        return (dynamic)x + (dynamic)y;
    }
}

public class TestClass : TestClass<double>
{
    // Inherited classes will also need to have protected constructors to prevent people from creating instances of them.
    protected TestClass()
    { }
}

TestClass.Add(3.0, 4.0)
TestClass<int>.Add(3, 4)

// Creating a class instance is not allowed because the constructors are inaccessible.
// new TestClass();
// new TestClass<int>(); 
```

不幸的是，由于“设计”的语言限制，我们无法做到：

```
public static class TestClass<T>
{
    public static T Add(T x, T y)
    {
        return (dynamic)x + (dynamic)y;
    }
}

public static class TestClass : TestClass<double>
{
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-05-23T22:39:16.050

我的回答：糟糕的设计选择。;-)

这是一个关注语法影响的有趣辩论。在我看来，这个论点的核心是设计决策导致了密封的静态类。关注静态类名称的透明度出现在顶层而不是隐藏（“混淆”）在子名称后面？人们可以想象一种可以直接访问基类或子类的语言实现，令人困惑。

一个伪示例，假设静态继承是以某种方式定义的。

```
public static class MyStaticBase
{
    SomeType AttributeBase;
}

public static class MyStaticChild : MyStaticBase
{
    SomeType AttributeChild;
} 
```

会导致：

```
 // ...
 DoSomethingTo(MyStaticBase.AttributeBase);
// ... 
```

哪个可能（会？）影响相同的存储

```
// ...
DoSomethingTo(MyStaticChild.AttributeBase);
// ... 
```

很混乱！

可是等等！编译器将如何处理在两者中定义相同签名的 MyStaticBase 和 MyStaticChild？如果孩子覆盖比我上面的例子不会改变相同的存储，也许？这会导致更多的混乱。

我相信有限的静态继承有很强的信息空间理由。很快就会有更多关于限制的信息。此伪代码显示值：

```
public static class MyStaticBase<T>
{
   public static T Payload;
   public static void Load(StorageSpecs);
   public static void Save(StorageSpecs);
   public static SomeType AttributeBase
   public static SomeType MethodBase(){/*...*/};
} 
```

然后你得到：

```
public static class MyStaticChild : MyStaticBase<MyChildPlayloadType>
{
   public static SomeType AttributeChild;
   public static SomeType SomeChildMethod(){/*...*/};
   // No need to create the PlayLoad, Load(), and Save().
   // You, 'should' be prevented from creating them, more on this in a sec...
} 
```

用法如下：

```
// ...
MyStaticChild.Load(FileNamePath);
MyStaticChild.Save(FileNamePath);
doSomeThing(MyStaticChild.Payload.Attribute);
doSomething(MyStaticChild.AttributeBase);
doSomeThing(MyStaticChild.AttributeChild);
// ... 
```

创建静态子项的人不需要考虑序列化过程，只要他们了解可能放在平台或环境的序列化引擎上的任何限制。

静态（单例和其他形式的“全局”）经常出现在配置存储周围。静态继承将允许在语法中清晰地表示这种责任分配，以匹配配置的层次结构。但是，正如我所展示的，如果实现了基本的静态继承概念，则很有可能出现大量歧义。

我相信正确的设计选择是允许具有特定限制的静态继承：

1.  没有覆盖任何东西。子不能替换基属性、字段或方法，... 重载应该没问题，只要签名存在差异，允许编译器对子与基进行排序。
2.  只允许泛型静态基，不能从非泛型静态基继承。

您仍然可以通过通用引用更改同一个商店`MyStaticBase<ChildPayload>.SomeBaseField`。但是您会感到气馁，因为必须指定泛型类型。虽然子参考会更干净：`MyStaticChild.SomeBaseField`.

我不是编译器作者，所以我不确定我是否遗漏了在编译器中实现这些限制的困难。也就是说，我坚信信息空间需要有限的静态继承，基本的答案是你不能因为糟糕的（或过于简单的）设计选择。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-08-12T10:59:41.980

静态类和类成员用于创建无需创建类实例即可访问的数据和函数。静态类成员可用于分隔独立于任何对象身份的数据和行为：无论对象发生什么，数据和函数都不会改变。当类中没有依赖于对象标识的数据或行为时，可以使用静态类。

一个类可以声明为静态的，这表明它只包含静态成员。不能使用 new 关键字来创建静态类的实例。加载包含类的程序或命名空间时，.NET Framework 公共语言运行时 (CLR) 会自动加载静态类。

使用静态类来包含与特定对象无关的方法。例如，创建一组不作用于实例数据并且不与代码中的特定对象关联的方法是一个常见的要求。您可以使用静态类来保存这些方法。

以下是静态类的主要功能：

1.  它们只包含静态成员。

2.  它们不能被实例化。

3.  它们是密封的。

4.  它们不能包含实例构造函数（C# 编程指南）。

因此，创建静态类与创建仅包含静态成员和私有构造函数的类基本相同。私有构造函数防止类被实例化。

使用静态类的优点是编译器可以检查以确保没有意外添加实例成员。编译器将保证不能创建此类的实例。

静态类是密封的，因此不能被继承。它们不能继承自除 Object 之外的任何类。静态类不能包含实例构造函数；但是，它们可以有一个静态构造函数。有关详细信息，请参阅静态构造函数（C# 编程指南）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-09-22T06:58:39.840

当我们创建一个只包含静态成员和私有构造函数的静态类时。唯一的原因是静态构造函数阻止了该类的实例化，因为我们无法继承静态类。访问该成员的唯一方法静态类通过使用类名本身。尝试继承静态类不是一个好主意。

# c# - vshost.exe 文件的用途是什么？

> ID：774187
> 
> 赞同：494
> 
> 时间：2009-04-21T19:24:48.020
> 
> 标签：c#, visual-studio, debugging

当我创建和编译“Hello, World!”时 在 C# 中的应用程序中，除了主 exe（例如 HelloWorld.exe），我在 Debug 文件夹中获得了三个文件

1.  HelloWorld.vshost.exe
2.  你好世界.pdb
3.  HelloWorld.vshost.exe.manifest

这些文件有什么用途？

* * *

## 回答 #1

> 赞同：418
> 
> 时间：2009-04-21T19:30:07.837

vshost.exe 功能是随 Visual Studio 2005 引入的（回答您的评论）。

它的目的主要是使调试启动更快 - 基本上已经有一个框架正在运行的进程，只要你想要它就可以加载你的应用程序。

有关详细信息，请参阅[此 MSDN 文章](https://docs.microsoft.com/visualstudio/debugger/debugging-and-the-hosting-process)和[此博客文章](https://docs.microsoft.com/archive/blogs/dtemp/vshost-the-hosting-process)。

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2009-04-21T19:31:39.517

*   .exe - '正常' 可执行文件

*   .vshost.exe - 用于帮助调试的特殊版本的可执行文件；有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms185331(VS.80).aspx)

*   .pdb -带有调试符号的[程序数据库](http://msdn.microsoft.com/en-us/library/yd4f8bd1(vs.71).aspx)

*   .vshost.exe.manifest - 一种[配置文件](http://msdn.microsoft.com/en-us/library/aa375632(VS.85).aspx)，主要包含对库的依赖

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2009-04-21T19:28:12.397

vshost.exe 文件是 Visual Studio 运行的可执行文件（Visual Studio 宿主可执行文件）。这是链接到 Visual Studio 并改进调试的可执行文件。

将应用程序分发给其他人时，不要使用 vshost.exe 或 .pdb（调试数据库）文件。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2017-05-17T03:26:15.850

**此外，您可以为Release**构建配置关闭 vshost 文件的创建，并为**Debug**启用它。

**脚步**

*   **项目属性**>**调试**> 配置（发布） > 禁用 Visual Studio 托管进程
*   **项目属性**>**调试**> 配置（调试）> 启用 Visual Studio 托管进程

[![VS2010 截图](https://i.stack.imgur.com/mRxIL.png)](https://i.stack.imgur.com/mRxIL.png)

**参考**

1.  [MSDN 如何：禁用托管进程](https://msdn.microsoft.com/en-us/library/ms185330.aspx)
2.  [MSDN 托管进程 (vshost.exe)](https://msdn.microsoft.com/en-us/library/ms185331.aspx)

摘自[MSDN 如何：禁用托管进程](https://msdn.microsoft.com/en-us/library/ms185330.aspx)

启用托管进程后，对某些 API 的调用可能会受到影响。在这些情况下，必须禁用托管进程才能返回正确的结果。

禁用托管进程

1.  在 Visual Studio 中打开一个可执行项目。不生成可执行文件的项目（例如，类库或服务项目）没有此选项。
2.  在**项目**菜单上，单击**属性**。
3.  单击**调试**选项卡。
4.  清除**启用 Visual Studio 托管进程**复选框。

禁用托管进程时，一些调试功能不可用或性能下降。有关详细信息，请参阅[调试和托管过程](https://msdn.microsoft.com/en-us/library/ms242202.aspx)。

> 一般来说，当宿主进程被禁用时：
> 
> *   开始调试 .NET Framework 应用程序所需的时间会增加。
> *   设计时表达式评估不可用。
> *   部分信任调试不可用。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-04-21T19:33:22.540

我不确定，但我相信这是一个调试优化。但是，我通常将其关闭（请参阅项目的调试属性）并且我没有注意到任何减速，并且在调试方面我没有看到任何限制。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-09-10T04:08:35.523

这似乎是一个长期运行的调试框架过程（以减少加载时间？）。我发现当您从调试器启动应用程序两次时，通常会使用相同的 vshost.exe 进程。它只是首先卸载所有用户加载的 DLL。如果您在托管进程中使用 API 挂钩，这会产生奇怪的效果。

# xml - 表示 null XML 元素的正确方法是什么？

> ID：774192
> 
> 赞同：175
> 
> 时间：2009-04-21T19:24:56.227
> 
> 标签：xml, null, xml-nil

我已经看到`null`以多种方式表示的元素：

**该元素存在于`xsi:nil="true"`：**

```
 <book>
     <title>Beowulf</title>
     <author xsi:nil="true"/>
 </book> 
```

**该元素存在，但表示为一个空元素**（我认为这是错误的，因为“空”并且`null`在语义上是不同的）：

```
 <book>
     <title>Beowulf</title>
     <author/>
 </book>

 <!-- or: -->
 <book>
     <title>Beowulf</title>
     <author></author>
 </book> 
```

**返回的标记中根本不存在该元素**：

```
 <book>
     <title>Beowulf</title>
 </book> 
```

**该元素有一个`<null/>`子元素**（来自下面的[TStamper](https://stackoverflow.com/questions/774192/what-is-the-correct-way-to-represent-null-xml-elements/774229#774229)）：

```
 <book>
     <title>Beowulf</title>
     <author><null/></author>
 </book> 
```

是否有正确或规范的方式来表示这样的`null`值？除了上面的例子还有其他方法吗？

上面示例的 XML 是人为设计的，所以不要读得太深。:)

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-04-21T19:32:39.297

xsi:nil 是表示值的正确方法：当发出 DOM 级别 2 调用 getElementValue() 时，返回 NULL 值。xsi:nil 也用于指示没有内容的有效元素，即使该元素的内容类型通常不允许空元素。

如果使用空标签，getElementValue() 将返回空字符串 ("") 如果省略标签，则甚至不存在作者标签。这在语义上可能与将其设置为“nil”不同（例如，将“Series”设置为 nil 可能意味着该书不属于任何系列，而省略系列可能意味着该系列对当前元素来说是不适用的元素。）

来自：[W3C](http://www.w3.org/TR/xmlschema-1/#xsi_nil)

> XML Schema：Structures 引入了一种机制，用于发出信号，当一个元素没有内容时，它应该被接受为·有效·，尽管内容类型不需要甚至不一定允许空内容。如果一个元素的属性xsi:nil 的值为true，它可能是没有内容的有效的。如此标记的元素必须为空，但如果相应的复杂类型允许，则可以携带属性。

澄清：
如果您有一个 book xml 元素并且其中一个子元素是 book:series 您在填写它时有几个选项：

1.  完全删除元素 - 当您希望表明该系列不适用于本书或该书不是系列的一部分时，可以这样做。在这种情况下，永远不会调用具有与 book:series 匹配的模板的 xsl 转换（或其他基于事件的处理器）。例如，如果您的 xsl 将 book 元素转换为表格行 (xhtml:tr)，则使用此方法可能会得到不正确数量的表格单元格 (xhtml:td)。
2.  将元素留空 - 这可能表明该系列是“”，或者是未知的，或者该书不是系列的一部分。任何与 book:series 匹配的 xsl 转换（或其他基于 evernt 的解析器）都会被调用。current() 的值将是“”。使用此方法，您将获得与下一个描述的相同数量的 xhtml:td 标记。
3.  使用 xsi:nil="true" - 这表示 book:series 元素为 NULL，而不仅仅是空的。将调用具有模板匹配 book:series 的 xsl 转换（或其他基于事件的解析器）。current() 的值将为空（不是空字符串）。此方法与 (2) 的主要区别在于 book:series 的模式类型不需要允许空字符串 ("") 作为有效值。这对于系列元素没有实际意义，但对于在架构中定义为枚举类型的语言元素，xsi:nil="true" 允许元素没有数据。另一个例子是十进制类型的元素。如果您希望它们为空，您可以合并一个仅允许 "" 和小数的枚举字符串，或使用可空的小数。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-23T03:54:41.047

没有规范的答案，因为 XML 基本上没有空概念。但我假设你想要 Xml/Object 映射（因为对象图有空值）；所以你的答案是“无论你的工具使用什么”。如果你写处理，那意味着你喜欢什么。对于使用 XML Schema 的工具，这`xsi:nil`是可行的方法。对于大多数映射器，省略匹配元素​​/属性是这样做的方法。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-21T19:32:28.580

这取决于您如何验证 XML。如果您使用 XML 模式验证，则表示`null`值的正确方法是使用`xsi:nil`属性。

[[来源](http://www.w3.org/TR/xmlschema-1/#xsi_nil)]

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-01T07:34:12.143

w3链接中的文档：

[http://www.w3.org/TR/REC-xml/#sec-starttags](http://www.w3.org/TR/REC-xml/#sec-starttags)

说这些是推荐的形式：

```
<test></test>
<test/> 
```

另一个答案中提到的属性是一种验证机制，而不是状态的表示。请参考：[http ://www.w3.org/TR/xmlschema-1/#xsi_nil](http://www.w3.org/TR/xmlschema-1/#xsi_nil)

> XML Schema：Structures 引入了一种**机制，用于发出信号，当一个元素没有内容时，它应该被接受为·有效·**，尽管内容类型不需要甚至不一定允许空内容。如果一个元素的属性xsi:nil 的值为true，它可能是没有内容的有效的。**如此标记的元素必须为空**，但如果相应的复杂类型允许，则可以携带属性。

为了澄清这个答案：

```
<?xml version="1.0" encoding="utf-8" ?>
<Books>
  <Book>
    <!--This element should alway be empty-->
    <BuildAttributes HardCover="true" Glued="true" xsi:nil="true"/>
    <Index></Index>
    <pages>
      <page pageNumber="1">Content</page>
    </pages>
    <!--Valid representation of a null or empty ISBN-->
    <ISBN></ISBN>
  </Book>

  <Book>
    <!--Invalid construct since the element attribute xsi:nil="true" signal that the element must be empty-->
    <BuildAttributes HardCover="true" Glued="true" xsi:nil="true">
      <anotherAttribute name="Color">Blue</anotherAttribute>
    </BuildAttributes>
    <Index></Index>
    <pages>
      <page pageNumber="1">Content</page>            
    </pages>
    <!--Missing ISBN could be confusing and misguiding since its not present-->
  </Book>
</Books> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-22T03:48:48.997

当您`xsi:nil`的模式语义表明一个元素具有默认值并且如果该元素不存在时应该使用该默认值时，您可以使用该默认值。我不得不假设有一些聪明人认为前面这句话不是一个不言而喻的可怕想法，但对我来说这听起来像是九种坏事。我曾经使用过的每种 XML 格式都通过省略元素来表示空值。（或属性，祝你好运用 . 标记属性`xsi:nil`。）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-23T03:44:58.700

简单地省略属性或元素在不太正式的数据中效果很好。

如果您需要更复杂的信息，GML 模式会添加属性 nilReason，例如：在[GeoSciML](https://www.seegrid.csiro.au/twiki/bin/view/Xmml/GeochemExamples)中：

*   `xsi:nil`值为“true”用于指示没有可用的值
*   `nilReason`可用于记录缺失值的附加信息；这可能是标准 GML 原因之一（`missing, inapplicable, withheld, unknown`），或前面的文本`other:`，或者可能是指向更详细说明的 URI 链接。

当您交换数据时，通常使用 XML 的角色、发送给一个接收者或用于特定目的的数据可能具有模糊的内容，而这些内容对于支付或具有不同身份验证的其他人是可用的。了解内容丢失的原因可能非常重要。

科学家们还关心信息缺失的原因。例如，如果出于质量原因将其删除，他们可能希望查看原始的不良数据。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-21T19:42:45.623

在许多情况下，Null 值的目的是为以前版本的应用程序中不存在的数据值提供服务。

假设您有一个来自应用程序“ReportMaster”版本 1 的 xml 文件。

现在，在 ReportMaster 版本 2 中，添加了更多可能定义或未定义的属性。

如果您使用“无标签意味着空”表示，您将获得自动向后兼容来读取您的 ReportMaster 1 xml 文件。

# asp.net-mvc - asp.net MVC中的单元测试，如何模拟页面请求？

> ID：774204
> 
> 赞同：8
> 
> 时间：2009-04-21T19:26:58.377
> 
> 标签：asp.net-mvc, unit-testing, mocking

如何模拟 .net MVC 页面的页面请求？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-21T19:33:26.783

使用 RhinoMocks：

```
 var httpContext = MockRepository.GenerateMock<HttpContextBase>();
 var httpRequest = MockRepository.GenerateMock<HttpRequestBase>();

 httpContext.Expect( c => c.Request ).Return( httpRequest ).Repeat.Any();

 ... set up expectations on request...

 var controller = new MyController();
 controller.ControllerContext = new ControllerContext( httpContext,
                                                       new RouteData(),
                                                       controller );

 ...invoke action, check assertions...

 httpContext.VerifyAllExpectations();
 httpRequest.VerifyAllExpectations(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-02T20:55:34.730

使用[起订量](http://code.google.com/p/moq/)：

```
var request = new Mock<HttpRequestBase>(MockBehavior.Strict);
request.Setup(x => x.ApplicationPath).Returns("/");
request.Setup(x => x.Url).Returns(new Uri("http://localhost/home"));
request.Setup(x => x.ServerVariables).Returns(new System.Collections.Specialized.NameValueCollection());

var context = new Mock<HttpContextBase>(MockBehavior.Strict);
context.SetupGet(x => x.Request).Returns(request.Object);

var controller = new YourController();
controller.ControllerContext = new ControllerContext(context.Object, new RouteData(), controller); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-06-28T23:15:38.097

手动（因为我讨厌每次测试需要 8 行设置的 Mocking 框架）

```
// in some common location, only once
public class MockHttpContext : HttpContextBase
{
    public MockHttpRequest m_request = new MockHttpRequest();
    public MockHttpResponse m_response = new MockHttpResponse();

    public override HttpRequestBase Request
    { get { return m_request; } }

    public override HttpResponseBase Response
    { get { return m_response; } }
}

public class MockHttpRequest : HttpRequestBase
{
    // override whatever bits you want (eg cookies)
}

public class MockHttpResponse : HttpResponseBase
{
    // override whatever bits you want (eg cookies)
}

// in your specific test
controller = new YourController {
    ControllerContext = new ControllerContext { HttpContext = new MockHttpContext() }
}; 
```

# comments - 如何为 CVS 设置默认签入注释？

> ID：774208
> 
> 赞同：1
> 
> 时间：2009-04-21T19:27:53.803
> 
> 标签：comments, cvs

如何为 cvs 生成默认注释？我希望每个签入评论都以“更改#：”开头，并可供用户编辑。

我知道这可以在存储库中全局完成。它也可以作为客户端的单个用户完成吗？

我正在使用命令行 cvs。

我们已经验证了签入以“Change #:”开头，并且提供了有效的更改编号。我想将签入注释默认为“更改#：”以节省开发人员的一些输入。如何在全球范围内做到这一点？可以在本地/客户端完成吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T19:39:07.830

要小心。您还必须确保默认评论不会成为拐杖。例如，您应该验证缺陷编号是否有效（例如，当前打开以及实际存在）。否则，程序员将简单地使用默认注释作为唯一注释。

在我看来，最好是努力验证评论而不是提供默认值。告诉开发人员，除非评论符合要求，否则他们的更改将被拒绝 - 并记录预期（和接受）的内容。

* * *

提问者挑战“说得很好，但没有回答问题”。

很公平。我并没有真正使用 CVS，因此请注意以下内容。

查看 Karl Fogel 的书“使用 CVS 进行开源开发”（科里奥利，1999 年），我看不出有什么好的方法。有“commitinfo”、“loginfo”和“verifymsg”文件，它们似乎都指定了验证日志消息的程序，并且当用户没有为文件中的消息指定“ `cvs ci -m"Why I committed this"`”（或“ ”）时启动编辑器`cvs ci -F why`)，但就我个人而言，我总是在命令行上查看评论，并且不愿意为我启动一个编辑器。因此，除了为命令编写包装器`cvs`（这将是适度复杂的）之外，我在书中看不到按照您的要求执行操作的方法。

`cvs`嗯...除非您使用在给定文件中创建默认消息然后启动的程序覆盖用户在 shell 脚本包装器中对 CVSEDITOR 的定义`${VISUAL:-${EDITOR:-vim}}`。Ick，同样糟糕！但是，仔细操作，它会起作用的。可能最困难的部分是确保程序员使用您的脚本版本`cvs`而不是二进制文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T07:29:49.397

您可以使用 rcsinfo 文件指定用于签入的模板。

有关详细信息，请参阅此[页面](http://www.cvsnt.org/manual/html/rcsinfo.html)。

这是在服务器端完成的，因此您需要服务器上的模板文件。

此外，如上所述，您可以在 CVS 命令行上使用自己的签入注释覆盖模板。

# apache-flex - 格式化 AdvancedDataGrid 单元格

> ID：774212
> 
> 赞同：1
> 
> 时间：2009-04-21T19:28:26.093
> 
> 标签：apache-flex, rendering, advanceddatagrid

我有一个关于渲染高级数据网格单元格的快速问题。

我需要根据条件以编程方式为数据网格的单元格着色。比方说，股票报价。如果比前一天增加，我需要在减少时将单元格涂成绿色和红色。

现在，重要的部分是，我需要动态地做这些事情，这意味着，当用户启用比较/条件时，单元格就会被着色。当用户禁用比较时，它会再次回到默认行为。

我知道我必须使用渲染器。但不确定，如何将它用于单元格，并且过于动态。谁能解释一下如何去做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T23:51:25.260

项渲染器是用于定义组件“项”或子组件外观的组件。在 ADG 的情况下，“项目”是单个单元格。您可以创建一个完全自定义的类来充当渲染器（假设它实现了某些必需的接口），或者在大多数情况下，您可以扩展现有组件。由于 ADG 单元格的默认渲染器不支持背景颜色，因此您必须创建或扩展一个支持该功能的组件并将其用作渲染器。这是以下问题中链接到的这些教程的基本前提：

[在 Adob​​e Flex 中设置数据网格行的背景颜色](https://stackoverflow.com/questions/748213/setting-background-color-for-datagrid-row-in-adobe-flex/748342#748342)

在创建一个支持背景颜色的 itemRenderer 之后，您有两个选项可以定义您的“条件”；在 itemRenderer 内部或使用 ADG 的 styleFunction（另外要求您的 itemRenderer 定义“背景”样式）。

在您的情况下，您可以在发送到每个单元格的数据中同时包含今天和昨天的股票价格值，并比较两者以确定用于绘制背景的颜色。同样，更多关于上面提供的教程链接。在 itemRenderer 或 styleFunction 中，您将比较 itemRenderer/styleFunction 数据对象的属性（对应于您正在查看的行），例如：

```
if(data.today > data.yesterday)
{
    // set color or return style
}
else ... 
```

要“切换”自定义单元格颜色，请在自定义渲染器和默认（无色）渲染器之间切换。换句话说，当您需要显示颜色时，将 itemRenderer 属性设置为您的自定义 itemRenderer 类，并在您想要“默认行为”时将其设置为“null”。

# django - Django admin 水平显示组

> ID：774216
> 
> 赞同：8
> 
> 时间：2009-04-21T19:29:36.840
> 
> 标签：django, datetime, django-admin, alignment

如何让 Django 管理员水平显示组？如果我有 3 个相邻的日期时间字段，我宁愿它们占据 1 行，而不是 3 行。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-22T09:28:39.630

您是否尝试过将您的字段集分组为元组？：

```
fieldsets = (
        (None, {
            'fields': ('name','description',('start_date','end_date'), 'location', ('latitude','longitude'))
        }),
    ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T19:56:29.397

我这样做的方式是制作一个自定义管理模板。你可以拿 django 自带的那个，复制它，然后编辑你想要改变的部分。

关于如何做到这一点的一个很好的教程在 django 网站上。具体来说，有一个关于 [制作自定义管理模板](http://docs.djangoproject.com/en/dev/intro/tutorial02/#customize-the-admin-look-and-feel)的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-20T21:57:41.063

它已经在 Django==2.0.7 上进行了测试并且工作起来就像一个魅力，关于使用参数“fieldsets”的一个非常重要的建议是你不能同时使用“fields”属性，否则你会得到您的控制台上出现以下错误：

```
(admin.E005) Both 'fieldsets' and 'fields' are specified. 
```

语法会像这样：

```
fieldsets = (
    ('General Information', {
        'fields': (
            ("id", "created_at", "updated_at",),
            ("name", "coupon_type", "discount", "is_active",),
            ("quantity", "minumum_quantity", "before_expire",),
        ),
    }),
    ('Expiration Dates', {
        'fields': (
            ("expiration_from", "expiration_to",),
        ),
    }),
    ('Grants for', {
        'fields': (
            "products", "campaigns_product", "sellers", "platforms",
        ),
    }),
) 
```

# c++ - 对 STL 的 MS 扩展

> ID：774233
> 
> 赞同：1
> 
> 时间：2009-04-21T19:32:37.237
> 
> 标签：c++, stl, visual-studio-2003

如果这是一个“谷歌是你的朋友”的问题，我提前道歉。我已经搜索过，但也许我一直在使用错误的术语进行搜索。

任何人都可以向我指出任何关于 MS 随 Visual Studio 2003 提供的 STL 扩展的介绍性文档吗？我相信这些库是从 Dinkumware 获得许可的，我看过他们的文档，但他们没有帮助解决这个问题。

我试图确保我们在使用这些扩展容器时没有犯一些愚蠢和明显的错误。我自己没有解决这个问题——我正在帮助另一个开发人员——但我相信这个问题与在 hash_set 容器中创建桶进入某种无限循环的算法有关。正如我所说，我只是想确保我们已经消除了明显和愚蠢的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T19:39:06.927

像往常一样，微软的 API 由微软在 MSDN 上记录：

[http://msdn.microsoft.com/en-us/library/1t4xas78(VS.80).aspx](http://msdn.microsoft.com/en-us/library/1t4xas78(VS.80).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T19:58:37.800

微软从 VS 2003 开始​​做的一件事就是将非标准 C++ 扩展放入`stdext`命名空间：

*   [http://msdn.microsoft.com/en-us/library/ek139e86(VS.71).aspx](http://msdn.microsoft.com/en-us/library/ek139e86(VS.71).aspx)

因此，在`stdext`（标题或 MSDN 上）进行搜索将对您有所帮助。请注意，虽然上面的链接只讨论`<hash_set>`和`<hash_map>`（即使在页面的 VS 2008 版本中），但 stdext 命名空间用于其他内容，例如检查的迭代器和检查的算法。

# sql-server - SQL Server 2000 临时表与表变量

> ID：774242
> 
> 赞同：3
> 
> 时间：2009-04-21T19:33:39.467
> 
> 标签：sql-server, variables, sql-server-2000

存储一些临时数据（一个是 50k 行，另一个是 50k 行）来执行计算会更有效。我会做一次这个过程，每晚。

比较这样的东西时，你如何检查效率？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T19:37:25.743

结果会有所不同，哪个更容易将数据存储在磁盘（#temp）或内存（@temp）中。

以下参考文献中的一些摘录

*   在系统数据库 tempdb 中的磁盘上创建并填充了一个临时表。
*   表变量是在内存中创建的，因此性能略好于#temp 表（也因为表变量中的锁定和日志记录更少）。表变量可能仍对 tempdb 执行 I/O（这是 #temp 表的性能问题显而易见的地方），尽管文档对此并不十分明确。
*   与临时表相比，表变量导致存储过程的重新编译次数更少。
*   [Y]您可以在临时表上创建索引以提高查询性能。

关于您有 50k 行的具体情况：

> 随着您的数据量变大，和/或临时数据的重复使用增加，您会发现使用#temp 表更有意义

参考：

*   [我应该使用#temp 表还是@table 变量？](http://databases.aspfaq.com/database/should-i-use-a-temp-table-or-a-table-variable.html)
*   [MSKB 305977 - SQL Server 2000 - 表变量](http://support.microsoft.com/default.aspx/kb/305977)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T19:38:37.160

使用表变量和临时表之间可能存在很大的性能差异。在大多数情况下，临时表比表变量快。我从私人 SQL Server MVP 新闻组中获取了以下提示，并获得了 Microsoft 与您分享的许可。一位 MVP 注意到，虽然使用表变量的查询不会在大型 SMP 机器上生成并行查询计划，但使用临时表（本地或全局）并在相同环境下运行的类似查询确实会生成并行计划。

来自[SQL Mag](http://www.sqlmag.com/Article/ArticleID/40404/sql_server_40404.html)的更多内容（不幸的是，需要订阅，我会立即尝试查找更多资源）

**编辑：这是来自**[CodeProject](http://www.codeproject.com/KB/database/SQP_performance.aspx)的一些更深入的信息

# c# - 使用 Microsoft Visual Web Developer Express 2008 创建站点时出现问题

> ID：774244
> 
> 赞同：1
> 
> 时间：2009-04-21T19:34:33.567
> 
> 标签：c#, visual-studio-2008, visual-studio-express, visual-web-developer

这是一个非常新手的问题，对不起！

我需要创建一个基于 con C# 的 aspx 网站，并根据我已经拥有的一些 DLL 调用一些 web 服务。在购买 Visual Studio 之前，我决定尝试使用 Microsoft Visual Web Developer Express（可以吗？）创建基于 Visual C# 的 Web 应用程序 ASP.NET。

我创建了表单来输入单击流程按钮时提交的数据。此时我需要从 DLL 中调用东西，我通过添加引用在解决方案资源管理器中添加了这些内容，从 COM 列表中选择 DLL。但是每当我运行项目时，我总是在尝试创建对象时收到错误“找不到类型或命名空间 xxx - 可能缺少 using 指令或汇编程序指令”。

我的愚蠢错误是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T19:43:21.113

如果您查看错误消息，您还没有涵盖另一半。在您想要使用 DLL 中的命名空间的每个代码文件的顶部，您需要包含一个“using 指令”以让编译器知道它可能在编译期间链接到该 DLL。基本上编译器想知道某些东西在哪里，即使你将它包含在函数中，你也没有采取最后一步在文件顶部添加 using 语句。

# python - 计算价格的业务规则

> ID：774245
> 
> 赞同：0
> 
> 时间：2009-04-21T19:34:36.687
> 
> 标签：python, ruby, scripting, rules, dynamic-language-runtime

我工作的企业是一家在线零售商，我目前正在从事一个项目，其中包括计算产品的客户价格。我们可能会创建一个看起来像...的服务

```
public interface IPriceService
{
  decimal CalculateCustomerPrice(ISupplierPriceProvider product);
}

public interface ISupplierPriceProvider
{
    decimal SupplierPrice { get; }
    string Currency { get; }
} 
```

不用担心它看起来不会完全一样，但是您会明白总体思路。在我们实施这项服务的过程中，将有许多计算这个价格的规则，这些规则可以经常改变，我们可能想要做的是为这些规则创建某种 DSL。目前，虽然我们不太确定销售部门等实际会要求进行哪些更改，所以我正在考虑托管 DLR 并拥有一个包含大量价格计算的 Iron Python 或 Iron Ruby 脚本文件。通过这种方式，我们可以快速更新价格计算规则，也可以了解业务人员需要什么类型的 DSL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T19:43:49.613

对我来说，这绝对是一个明智的想法。您可以从 IronPython 轻松访问 CLR 内部（对象和返回值），我不了解 IronRuby。[IronPython in Action](http://www.ironpythoninaction.com)的第 1 章和第 7 章可在线获取，可能会有所帮助。[在学习 python](http://www.learningpython.com/2006/10/02/ironpython-hello-world-tutorial/)博客上还有一个“hello world”风格的教程。

# c# - 在自定义角色提供者实现中忽略 ProviderUserKey

> ID：774262
> 
> 赞同：0
> 
> 时间：2009-04-21T19:37:04.233
> 
> 标签：c#, membership, provider, sqlmembershipprovider

我没有使用 MembershipUser 对象中的 ProviderUserKey，因为我的角色数据库有它自己的 ID。

如果我使用 C#，如何调用 membersuser 构造函数以便它创建没有此键的用户？

不向提供者提供此密钥有什么影响？ProviderUserKey 是否成为 FormsAuthentication cookie 中 Principal 对象的一部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T19:41:32.757

您使用什么唯一值来识别数据库中的用户？无论该值是什么，都将其存储在 ProviderUserKey ...

# image - 如何在 Google App Engine 中批量上传图像 BLOB？

> ID：774265
> 
> 赞同：3
> 
> 时间：2009-04-21T19:37:56.897
> 
> 标签：image, google-app-engine, upload, blob

我有一个模型*我想要*包含一个图像 blob。我的本地文件系统上有图像，但由于我的应用程序的性质，我需要将它们放在数据存储中。这是我的模型：

```
class JeanImage(db.Model):
    type = db.StringProperty(required=True, choices=set(["main","front","back","detail"]))
    image = db.BlobProperty(required=True) 
```

我还没有尝试过任何东西，因为我在处理图像时并不出色。

我如何/应该将我的图像转换为 blob，以便我可以在我的 bulkupload csv 文件中获取它们？

标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T05:42:44.403

您可以做到，只是不能使用批量上传器。您需要直接访问远程 api。

该站点有一个如何使用它的基本示例：http: [//www.billkatz.com/2009/2/Remote-API-Hello-World](http://www.billkatz.com/2009/2/Remote-API-Hello-World)

有一个重试机制是相当缓慢的一个好主意。

可以在此处找到更详细的说明： [http ://code.google.com/appengine/articles/remote_api.html](http://code.google.com/appengine/articles/remote_api.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T07:40:14.103

我相信使用应用程序引擎批量加载程序无法实现您想要实现的目标。

而是尝试自己创建某种上传器。例如，您可以将图像作为 zip 文件上传，然后将其解压缩并存储在数据存储中。如果您可以将图像映射到数据存储实体（例如通过使用命名约定），那么代码应该相当简单。

# asp.net - 来自 asp.net 网站的 Mathtran

> ID：774269
> 
> 赞同：2
> 
> 时间：2009-04-21T19:38:31.623
> 
> 标签：asp.net, latex, tex

我想在 ASP.NET 中建立一个网站，它会显示许多方程式。我想自动生成它们，所以我需要使用一些库，它可以让我动态地从 TeX 或 LaTex 生成图像。出于性能原因，我想让它在我的本地服务器上运行。

我尝试将 MimeTex 与 CodeProject 的 Eq2Img 项目一起使用，但我对图像的质量不满意，并且找不到任何自定义选项。

现在我正在尝试使用 Mathtran，但正如官方常见问题解答所说：“你需要一个安装了 TeX、Python 和 dvipng 的 Unix 或 Linux 服务器。”。

我的问题是：有人成功使用在本地运行的 ASP.NET 应用程序 Mathtran，还是可以提供其他解决方案？

感谢您的任何回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T19:52:57.563

您可以很容易地推出自己的解决方案。将您的源输入 LaTeX 以创建 DVI 文件。然后使用[dvipng](http://savannah.nongnu.org/projects/dvipng/)创建一个 PNG 文件，然后在您的网页中显示该文件。

编辑：更多细节和其他选项可从[WikiBooks 获得](http://en.wikibooks.org/wiki/LaTeX/Export_To_Other_Formats#Convert_to_image_formats)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T09:41:50.100

[常见问题解答](http://www.mathtran.org/faq.html)还说：“提供此服务的软件是开源的，可以下载并安装在您自己的网络服务器或台式机上（目前仅适用于 Unix/Linux）。” 由于您绝对可以获得适用于 Windows 的[TeX](http://www.tug.org/protext/)、[Python](http://python.org/download/windows/)和[dvipng](http://sourceforge.net/projects/dvipng/)，因此您只需将 Mathtran 使用的任何 Unix 基础架构替换为类似的 Windows 部件。Mathtran 的开发人员很可能自己不需要使用 Windows 服务器，而“目前”的措辞表明他们可能会接受一个补丁，使其也可以在 Windows 上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T21:16:10.523

[您可以根据http://www.mathtran.org/wiki/index.php/TeX_image](http://www.mathtran.org/wiki/index.php/TeX_image)使用 MathTran 网络服务吗？

# sharepoint - 有什么方法可以让 SharePoint 停止将入站电子邮件的附件文件名转换为全部小写？

> ID：774279
> 
> 赞同：1
> 
> 时间：2009-04-21T19:40:41.807
> 
> 标签：sharepoint, email, filenames, lowercase

我有一个文档库，可以成功接收和保存来自入站电子邮件的附件。问题是它正在使用我漂亮的混合大小写文件名并将它们转换为全部小写。我在互联网上寻找解决方案，只发现一堆“我也是”有同样问题的人。有没有办法控制这种行为？由于文件名成为链接文本，如果 SharePoint 不理会它会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T20:30:29.627

这是一个已知的错误，根据：

[http://social.technet.microsoft.com/Forums/en-US/sharepointgeneral/thread/0daedbf4-ddd1-4dd9-b7f0-70c03dc4afc4/](http://social.technet.microsoft.com/Forums/en-US/sharepointgeneral/thread/0daedbf4-ddd1-4dd9-b7f0-70c03dc4afc4/)

（也有更新包的链接）

# c++ - 如何在与 C++ 中的派生类型匹配的元素上创建迭代器？

> ID：774293
> 
> 赞同：3
> 
> 时间：2009-04-21T19:46:02.917
> 
> 标签：c++, stl, iterator

我想要一个 C++ 中的迭代器，它只能迭代特定类型的元素。在下面的示例中，我只想迭代作为 SubType 实例的元素。

```
vector<Type*> the_vector;
the_vector.push_back(new Type(1));
the_vector.push_back(new SubType(2)); //SubType derives from Type
the_vector.push_back(new Type(3));
the_vector.push_back(new SubType(4)); 

vector<Type*>::iterator the_iterator; //***This line needs to change***

the_iterator = the_vector.begin();
while( the_iterator != the_vector.end() ) {
    SubType* item = (SubType*)*the_iterator;
    //only SubType(2) and SubType(4) should be in this loop.
    ++the_iterator;
} 
```

我将如何在 C++ 中创建这个迭代器？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-21T20:09:18.647

[提升过滤器迭代器？](http://www.boost.org/doc/libs/1_38_0/libs/iterator/doc/filter_iterator.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-21T19:57:41.173

您必须使用动态转换。

```
the_iterator = the_vector.begin();
while( the_iterator != the_vector.end() ) {
    SubType* item = dynamic_cast<SubType*>(*the_iterator);
    if( item != 0 )
       ... 

    //only SubType(2) and SubType(4) should be in this loop.
    ++the_iterator;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-21T20:35:42.157

没有提升的解决方案。但是，如果您可以访问 boost 库 - 按照建议使用过滤器迭代器。

```
template <typename TCollection, typename T>
class Iterator
{
public:
    typedef typename TCollection::iterator iterator;
    typedef typename TCollection::value_type value_type;

    Iterator(const TCollection& collection,
             iterator it):
        collection_(collection),
        it_(it)
    {
        moveToNextAppropriatePosition(it_);
    }
    bool operator != ( const Iterator& rhs )
    {
        return rhs.it_ != it_;
    }
    Iterator& operator++()
    {
        ++it_;
        moveToNextAppropriatePosition(it_);
        return *this;
    }
    Iterator& operator++(int);
    Iterator& operator--();
    Iterator& operator--(int);
    value_type& operator*()
    {
        return *it_;
    }
    value_type* operator->()
    {
        return &it_;
    }
private:
    const TCollection& collection_;
    iterator it_;
    void moveToNextAppropriatePosition(iterator& it)
    {
        while ( dynamic_cast<T*>(*it) == NULL && it != collection_.end() ) 
            ++it;
    }
};

class A
{
public:
    A(){}
    virtual ~A(){}
    virtual void action()
    {
        std::cout << "A";
    }
};
class B: public A
{
public:
    virtual void action()
    {
        std::cout << "B";
    }
};
int main()
{
    typedef std::vector< A* > Collection;
    Collection c;
    c.push_back( new A );
    c.push_back( new B );
    c.push_back( new A );

    typedef Iterator<Collection, B> CollectionIterator;
    CollectionIterator begin(c, c.begin());
    CollectionIterator end(c, c.end());

    std::for_each( begin, end, std::mem_fun(&A::action) );
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T19:57:03.623

正如paintballbob 在评论中所说，您应该创建自己的迭代器类，可能继承自`vector<Type*>::iterator`. 特别是，您将需要实现或覆盖`operator++()`并`operator++(int)`确保您跳过非 SubType 对象（您可以使用它`dynamic_cast<SubType*>()`来检查每个项目）。[这篇 O'Reilly Net文章](http://www.oreillynet.com/pub/a/network/2005/11/21/what-is-iterator-in-c-plus-plus-part2.html)中对实现您自己的容器和迭代器进行了很好的概述。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-21T22:14:01.093

只是另一种使用 boost 迭代器的方法。这一次，使用`std::remove_copy_if`：

```
std::remove_copy_if(v.begin(), v.end(), 
    boost::make_function_output_iterator(boost::bind(&someFunction, _1)),
    !boost::lambda::ll_dynamic_cast<SubType*>(boost::lambda::_1)); 
```

它将`someFunction`为每个指向`SubType`.

# java - 在 Swing 中使用 InputVerifier 来检查日期和时间

> ID：774304
> 
> 赞同：1
> 
> 时间：2009-04-21T19:53:08.780
> 
> 标签：java, swing, validation

我目前正在开发一个 Swing 应用程序，我有一些 JTextArea 将被解析、转换为日期，然后添加到 MySQL 数据库中。一个是日期字段，其他是日期时间，我要做的是使用 InputVerifier 来确保它们输入正确。

我创建了一个 InputVerifier，它尝试使用 DateFormat.parse() 将文本转换为日期，并且大多数情况下都有效，但是有两个缺陷：首先，它无法检查我是否只有日期，而不是日期和time 其次，它无法检查我是否同时拥有日期和时间，而不仅仅是其中一个。

有没有办法解决？或者在我不知道的 Swing 中验证日期字段的更好方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T21:35:35.587

Swing 支持使用带有[DateFormatter的](http://java.sun.com/javase/6/docs/api/javax/swing/text/DateFormatter.html "DateFormatter")[JFormattedTextField](http://java.sun.com/javase/6/docs/api/javax/swing/JFormattedTextField.html "JFormattedTextField")将日期输入文本字段。使用 DateFormatter，您可以指定 DateFormat 对象，因此可以具有仅日期字段或日期和时间字段。

请查看Swing 教程中的[How To Use Formatted Text Fields](http://java.sun.com/docs/books/tutorial/uiswing/components/formattedtextfield.html)作为介绍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T20:01:17.013

只是一个想法：您可以考虑将 a[`SpinnerDateModel`](http://java.sun.com/javase/6/docs/api/javax/swing/SpinnerDateModel.html)与 a 一起使用`JSpinner`，而不是文本字段。也许您可以通过调用[setCalendarField(Calendar.DAY)](http://java.sun.com/javase/6/docs/api/javax/swing/SpinnerDateModel.html#setCalendarField%28int%29)来处理仅限日期的字段- 不过，我自己从来没有做过，所以我不确定。

# c# - 为什么我的自定义控件不接收拖放事件？

> ID：774308
> 
> 赞同：1
> 
> 时间：2009-04-21T19:54:50.320
> 
> 标签：c#, .net, winforms, drag-and-drop, c++-cli

我在 C++/CLI 中编写了一个自定义控件（Forms.Control 的直接子级），它将把它的大部分处理和所有的绘制卸载到一个单独的传统 MFC 控件。我将此控件包装在 C# 应用程序中。我需要能够将项目从应用程序中同一窗体上的 UserControl 拖到 C++/CLI 控件上。

出于某种原因，尽管我将 AllowDrop 设置为 true，但我的自定义控件没有收到任何拖放事件。（我已经验证 AllowDrop 在运行时是真的。）我从来没有机会检查/操作 DragEventArgs，因为从不调用回调。

我已经验证了拖放功能正常。例如，如果我用面板替换自定义控件，我会得到拖放回调就好了。

是否必须在控件中实现一些额外的东西来支持拖放回调？系统是否必须处理一些微妙的事情才能识别控件正在悬停并且应该是拖放操作的目标？

**笔记：**

用于绘制的 MFC 控件对我来说尚不可用，所以我只是绘制一个简单的渐变背景（通过`OnPaintBackground`），我正在尝试绘制。我还在`OnPaint`.

我尝试在创建自定义控件的句柄之前（通过设计器/构造函数代码）和创建句柄之后（通过 OnHandleCreated 覆盖）设置 AllowDrop = true。行为上没有区别。

拖动光标永远不会从自定义控件上的默认“无可用拖动”光标更改。

我正在`this.DoDragDrop()`从事件处理程序调用`MouseDown`UserControl 的子控件上的事件。

DragDrop 似乎可以与我在 C# 中创建的另一个自定义控件在与用户控件相同的程序集中工作。它很好地捕获了回调。只有我的 C++/CLI 控件没有看到它们。初始化组件 goo 是无关紧要的。我可以毫无改变地评论它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T13:49:34.793

我发现了我的错误，所以我会在这里回答，以防其他人犯类似的错误。看起来我确实在我的问题中暗示了答案，尽管我当时没有意识到这一点。

在我的问题中，我说

> 我尝试在创建自定义控件的句柄之前（通过设计器/构造函数代码）和创建句柄之后（通过 OnHandleCreated 覆盖）设置 AllowDrop = true。行为上没有区别。

这实际上是发生故障的地方。我没有阅读具体说明我需要记住调用基类的实现的[`OnHandleCreated`文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.onhandlecreated(loband).aspx)`OnHandleCreated`。

Reflector 表示`Control::OnHandleCreated`负责设置`Control`的内部事件通知结构。我从来没有打电话`Control::OnHandleCreated`，所以内部事件通知结构从来没有得到正确建立。这个事件结构（反射器再次显示）负责触发`OnDragOver`等，因此缺少事件结构导致我丢失事件。

**回答：**

确保`OnHandleCreated`在覆盖它时调用基类实现！

# c# - 使用 FaxComEx 库？

> ID：774309
> 
> 赞同：0
> 
> 时间：2009-04-21T19:55:10.633
> 
> 标签：c#, com

我正在尝试编写一个将传真发送到 Windows 传真系统的程序，但我遇到了 COM 库 FaxComEx 的问题。

我的代码：

```
try
{
    var faxServer = new FAXCOMEXLib.FaxServer();
    var faxDoc = new FAXCOMEXLib.FaxDocument();
    faxServer.Connect("");
    faxDoc.Body = @"C:\\test.txt";
    faxDoc.Recipients.Add("5551212", "Recipient");
    faxDoc.ConnectedSubmit(faxServer);
} 
```

应该可以工作，但是每当我尝试发送传真时它都会失败，我不知道为什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-30T13:49:13.077

您同时使用了文字限定符和转义字符。您应该只使用其中一种。

您应该尝试以下方法**之一**。

```
faxDoc.Body = @"C:\test.txt"; 
```

或者

```
faxDoc.Body = "C:\\test.txt"; 
```

# image-processing - 图像托管站点如何执行内容策略？

> ID：774312
> 
> 赞同：1
> 
> 时间：2009-04-21T19:56:16.230
> 
> 标签：image-processing, hosting, web-hosting, web-site-project

我试图弄清楚如何最好地实施公共数据托管服务。

允许用户上传图片的网站如何执行有关淫秽图片的服务条款？他们是否使用图像处理算法来标记潜在的违规行为（太多的肤色像素）？我认为 Imageshack 会查看他们的图片被热链接的网站，并检查关键字。如果它检测到任何与色情相关的内容，则会删除图片并禁止该帐户。还有其他方法吗？

执行很大程度上是自动化的还是更多地基于用户报告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T20:15:40.067

我想这取决于您的“公共数据托管服务”的规模。

如果它很小，每天可能有几百张图片流入，您可以自己调整它们。

如果是几十万，您将需要大量的人来整理杂草。提交滥用报告的要么是版主团队，要么是用户自己。

选择哪一个可能取决于您的服务的预算/财务成功以及服务类型。如果是像 Rapidshare 这样简单的事情，其中​​一个人看不到另一个人所做的事情，那么用户看到彼此内容并通过此通知并希望报告不可接受的内容的可能性很小。如果它是像 Flickr 这样非常社交的东西，你可以打赌它的报告将会涌入。

我想你可以自动化一些东西，但这几乎是一项不可能完成的任务。您无法自动检测色情内容。您无法自动检测侵犯版权的图像 - 制作版权材料的足迹以便将它们与上传的内容进行比较对于拥有 Rapidshare、Youtube 等资源的公司来说是一个真正的挑战。目前，这种工作只能由人类有效地完成。

它也存在法律问题。在某些国家/地区，服务所有者不对用户贡献的内容负责（好吧，如果他足够合作，可以根据要求删除某些内容），在其他国家/地区，他将因没有预先审核所有传入内容而自己收取费用。还要考虑到您要在哪里启动的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:54:50.910

我没有链接，但是虽然这肯定是一项容易出错的艰巨任务，但确实存在检测不当内容的软件。或者至少这是 NASA 的安全经理告诉我的——如果只是吓唬我的一种手段，我不知道 ;-)

# python - Python difflib：内联突出差异？

> ID：774316
> 
> 赞同：33
> 
> 时间：2009-04-21T19:57:32.280
> 
> 标签：python, diff

在比较相似的行时，我想强调同一行的不同之处：

```
a) lorem ipsum dolor sit amet
b) lorem foo ipsum dolor amet

lorem <ins>foo</ins> ipsum dolor <del>sit</del> amet 
```

虽然 difflib.HtmlDiff 似乎做了这种内联突出显示，但它会产生非常冗长的标记。

不幸的是，我找不到另一个不能逐行运行的类/方法。

我错过了什么吗？任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-04-25T12:05:12.540

对于您的简单示例：

```
import difflib
def show_diff(seqm):
    """Unify operations between two compared strings
seqm is a difflib.SequenceMatcher instance whose a & b are strings"""
    output= []
    for opcode, a0, a1, b0, b1 in seqm.get_opcodes():
        if opcode == 'equal':
            output.append(seqm.a[a0:a1])
        elif opcode == 'insert':
            output.append("<ins>" + seqm.b[b0:b1] + "</ins>")
        elif opcode == 'delete':
            output.append("<del>" + seqm.a[a0:a1] + "</del>")
        elif opcode == 'replace':
            raise NotImplementedError, "what to do with 'replace' opcode?"
        else:
            raise RuntimeError, "unexpected opcode"
    return ''.join(output)

>>> sm= difflib.SequenceMatcher(None, "lorem ipsum dolor sit amet", "lorem foo ipsum dolor amet")
>>> show_diff(sm)
'lorem<ins> foo</ins> ipsum dolor <del>sit </del>amet' 
```

这适用于字符串。您应该决定如何处理“替换”操作码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-12-03T10:50:49.897

这是受@tzot[上面的回答](https://stackoverflow.com/a/788780/37020)启发的内联差异（也兼容 Python 3）：

```
def inline_diff(a, b):
    import difflib
    matcher = difflib.SequenceMatcher(None, a, b)
    def process_tag(tag, i1, i2, j1, j2):
        if tag == 'replace':
            return '{' + matcher.a[i1:i2] + ' -> ' + matcher.b[j1:j2] + '}'
        if tag == 'delete':
            return '{- ' + matcher.a[i1:i2] + '}'
        if tag == 'equal':
            return matcher.a[i1:i2]
        if tag == 'insert':
            return '{+ ' + matcher.b[j1:j2] + '}'
        assert False, "Unknown tag %r"%tag
    return ''.join(process_tag(*t) for t in matcher.get_opcodes()) 
```

它并不完美，例如，扩展“替换”操作码以识别替换的完整单词而不是仅仅几个不同的字母会很好，但这是一个很好的起点。

样本输出：

```
>>> a='Lorem ipsum dolor sit amet consectetur adipiscing'
>>> b='Lorem bananas ipsum cabbage sit amet adipiscing'
>>> print(inline_diff(a, b))
Lorem{+  bananas} ipsum {dolor -> cabbage} sit amet{-  consectetur} adipiscing 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-21T20:04:02.530

[difflib.SequenceMatcher](http://docs.python.org/library/difflib.html#sequencematcher-objects)将在单行上运行。您可以使用“操作码”来确定如何更改第一行以使其成为第二行。

# vbscript - 为什么这个 VBScript 给我一个错误？

> ID：774319
> 
> 赞同：17
> 
> 时间：2009-04-21T19:58:17.613
> 
> 标签：vbscript

我将此[VBScript](http://en.wikipedia.org/wiki/VBScript)脚本作为 c:\test.vbs 保存到我的本地计算机：

```
WScript.StdOut.WriteLine "This is a test" 
```

当我从命令行运行它时，我收到此错误：

```
---------------------------
Windows Script Host
---------------------------
Script: C:\test.vbs
Line:   1
Char:   1
Error:  The handle is invalid. 
Code:   80070006
Source:     (null)

---------------------------
OK   
--------------------------- 
```

我在 Windows Vista (SP1) 和 Windows XP Pro (SP3) 下得到了这个。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-21T20:05:15.647

此链接可以帮助您：

[http://www.tech-archive.net/Archive/Scripting/microsoft.public.scripting.vbscript/2004-07/0979.html](http://www.tech-archive.net/Archive/Scripting/microsoft.public.scripting.vbscript/2004-07/0979.html)

似乎该句柄`StdOut`仅在使用控制台主机 ( `cscript.exe`) 而不是窗口主机 ( `wscript.exe`) 时可用。如果你想让代码工作，你必须使用`cscript.exe`它来运行它。

该帖子还描述了如何更改默认行为以使用 cscript 而不是 wscript 运行脚本。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-21T20:15:53.657

如已接受答案中的文章所述，当我从命令提示符处调用它时，我的脚本可以正常工作，如下所示：

```
cscript test.vbs 
```

您还可以更改默认脚本主机，这样就不必每次都调用 cscript。完成此操作后，原始命令无需修改即可工作。

```
cscript //h:cscript //s 
```

您可以通过以下方式恢复原始行为：

```
cscript //h:wscript //s 
```

谢谢！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T18:32:58.353

我在错误“ [cscript - 在控制台的同一行打印输出？](https://stackoverflow.com/questions/2897698/cscript-print-output-on-same-line-on-console/13688813#13688813) ”中提交了这个解决方案，我觉得这与这个问题有关。

我在我的 JavaScript 中使用以下“日志”函数来支持 wscript 或 cscript 环境。正如你所看到的，这个函数只有在可以的情况下才会写入标准输出。

```
var ExampleApp = {
    // Log output to console if available.
    //      NOTE: Script file has to be executed using "cscript.exe" for this to work.
    log: function (text) {
        try {
            // Test if stdout is working.
            WScript.stdout.WriteLine(text);
            // stdout is working, reset this function to always output to stdout.
            this.log = function (text) { WScript.stdout.WriteLine(text); };
        } catch (er) {
            // stdout is not working, reset this function to do nothing.
            this.log = function () { };
        }
    },
    Main: function () {
        this.log("Hello world.");
        this.log("Life is good.");
    }
};

ExampleApp.Main(); 
```

# .net - 基于 http 的文件系统，支持查找和锁定

> ID：774321
> 
> 赞同：2
> 
> 时间：2009-04-21T19:58:39.483
> 
> 标签：.net, http, filesystems, locking, seek

我正在构建一个需要使用像文件系统这样的 Web 服务器的应用程序。具体来说，理想的解决方案是：

*   一个服务器端组件，允许通过 HTTP 打开（锁定）、读取、写入、查找和截断一个文件。我需要能够同时锁定多个文件。我需要它在任何标准 Web 主机上运行，​​因此它必须在 IIS 或 Apache 之上运行，使用服务器端脚本（Web 服务、PHP 等）
*   我给它一个 URI 的客户端接口，它打开并像文件一样工作。我的客户端应用程序位于 .NET 中，因此理想情况下客户端 API 将实现 FileSteam 子类。

我需要这个的原因是我有相当大的文件将放在网络主机上。我需要读取部分文件（使用搜索）、截断并附加到末尾。下载和上传整个文件太占用带宽。另外，我需要同时锁定多个文件。

我的问题：

*   这样的事情存在吗？
*   如果不是，为什么不呢？这似乎不是一项非常有用的服务吗？

似乎这样的组件可以让我使用任何网络托管公司作为网络文件服务器。这似乎很有用，不是吗？

谢谢你的帮助！

埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T21:12:22.663

看来您正在寻找的是[WebDAV](http://en.wikipedia.org/wiki/WebDAV)服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T19:36:37.417

**长版**
Web 主机最初设计用于将内容发送给单独连接的用户。会话的整个概念是一种相对现代的现象（关键词：相对）——其中大部分只是跟踪来自同一用户的单个连接的简单方法。通常情况下，它只是给人一种您仍然连接到服务器的*印象*，而实际上您已经连接、下载、断开连接 - 并且每次执行操作时都执行相同的连接/下载/断开连接。

WebDav 之类的东西是标准 HTTP 对话框的附加功能，允许专门设计的软件通过 HTTP 与服务器进行更复杂的通信。WebDav 非常常见的用途是 Subversion、iCal（日历支持）等 - 这些允许*单连接*上传数据。

您正在谈论的是拥有基于会话的文件系统服务。虽然这似乎是一项很好的服务，但我怀疑它尚未实施，因为其复杂性和危险超过了好处。例如，这样的服务不仅需要担心标准文件系统问题（授权、文件权限、锁定、超时等），而且现在还必须担心在 Web 上的复杂性（身份验证、会话跟踪、断开连接、重放攻击、DDoS 等）。例如，如果客户端锁定文件然后离线会发生什么？文件是否保持锁定直到服务器重新启动？如果不，什么时候自动解锁文件？如果自动解锁触发并且原来的储物柜重新上线会发生什么？您是否强制所有事情都在一个连接中完成以进行补偿？如果他们在会话中间断开连接会发生什么？

它们只是您必须担心的几件事。我闲逛的时间比我打算的要长得多，但最重要的是......

**短版**
你当然可以使用 WebDav 来实现它，这需要你构建一个服务器端库。然而，虽然这并非不可能，但你正处于一个设计的伤害世界。我建议简化它的设计，这样你就不需要它像文件系统那样工作了。

# java - 基于属性文件中的类路径加载 Java 类

> ID：774323
> 
> 赞同：0
> 
> 时间：2009-04-21T19:58:59.873
> 
> 标签：java, jdbc, properties, classpath

我的应用程序使用 JDBC 数据库驱动程序。我从一个 jar 文件中加载这些文件，对于我目前正在使用的 DB2，我是 db2jcc.jar。在类路径中使用这个 jar，一切都很好，但我需要从应用程序配置文件中的属性中找到 jar - 例如，

```
database.driver=/opt/IBM/db2/V9.5/java/db2jcc.jar 
```

我可以通过 URLClassLoader 加载类，但问题是我需要将由此创建的对象视为显式 DB2XADataSource。例如：

```
URLClassLoader dbClassLoader = new URLClassLoader(new URL[]{driverJar});
xaClass = dbClassLoader.loadClass("com.ibm.db2.jcc.DB2XADataSource");

DB2XADataSource dataSource = (DB2XADataSource) xaClass.newInstance();

dataSource.setCurrentSchema(DATABASE_SCHEMA); // <- dataSource has to be a 
dataSource.setDatabaseName(DATABASE_NAME);    // DB2XADataSource to do this 
```

（重新排列和重命名；我实际上在包含此代码的类的构造函数中执行 loadClass，而 newInstance 在其方法之一中。）

我想我陷入了类加载器的纠结，因为加载我的类的类加载器试图找到 DB2XADataSource 以进行强制转换，但 URL 类加载器不在树中它的上方。问题是，在我应该停止一天工作（在英国）之后很久，我想不出如何以一种模糊整洁和理智的方式最好地解决它。

想法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T20:08:29.320

最简单的方法是只使用 java.beans API（或者如果必须的话直接反射）来调用 setter 方法。

或者：您的数据库代码需要链接到动态加载的代码。因此，动态加载您的数据库代码。多少取决于你。除了“引导程序”之外，您几乎可以加载所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:34:52.970

是的 - 该类无法加载自己的依赖项。你可以做一些 ClassLoader 魔术，但我想它会很快变得混乱。

减少反射量的一种方法是将依赖于*DB2XADataSource*的任何代码放入通过调用 ClassLoader 可用的接口调用的实现中。

```
//in mydb2driver.jar
public class MyDb2Driver implements IDriver {

    private DB2XADataSource dataSource = new DB2XADataSource();

    public void init() {
        dataSource.setCurrentSchema(DATABASE_SCHEMA);
    }

    //etc.

} 
```

这与您的驱动程序一起加载：

```
database.driver=/opt/IBM/db2/V9.5/java/db2jcc.jar:/foo/mydb2driver.jar 
```

调用代码位于常规类路径中：

```
public interface IDriver {
    public void init();
    //etc.
}

...

URLClassLoader dbClassLoader = new URLClassLoader(new URL[]{driverJar});
xaClass = dbClassLoader.loadClass("foo.MyDb2Driver");
IDriver dataSource = (IDriver) xaClass.newInstance();
dataSource.init(); 
```

# c# - 克隆 Web 服务的最简单方法是什么？

> ID：774326
> 
> 赞同：3
> 
> 时间：2009-04-21T19:59:26.957
> 
> 标签：c#, .net, oracle, web-services, clone

我正在开发一个项目，我们将使用 .NET (c#) 连接到 Oracle Web 服务。唯一的事情是我们将从我们的办公地点构建我们的客户端，但我们的客户不会让我们远程访问他们的网络服务（公司政策等）。所以我们的解决方案是访问我们的客户现场并“克隆”他们的网络服务，以便我们可以使用代理网络服务来开发我们的客户。

克隆此 Web 服务的最佳方法是什么？

我们的克隆将需要输出样本数据，但使用它们的确切方法调用和类型。我们首选的克隆语言是 c#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T20:06:03.787

*“我们的克隆将需要输出样本数据，但要使用它们准确的方法调用和类型。”*

那么记录原始的webservice数据并回放可能就足够了？

作为起点，带有*自动响应功能的*[Fiddler](http://www.fiddler2.com/fiddler2/)可能会有所帮助。作为高级解决方案，您的合作伙伴是[SOAPUI](http://www.soapui.org/features.html#Web_Service_Simulation)。

 *[![替代文字](https://i.stack.imgur.com/IyjEv.gif)](https://i.stack.imgur.com/IyjEv.gif)
[（来源：[soapui.org](http://www.soapui.org/images/screenshot5.gif)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T20:06:28.717

获取 WSDL 和任何关联的 XSD 并使用 WSDL.exe 生成类并将它们添加到 Web 服务项目。

# amazon-web-services - 我应该使用 CouchDB 还是 SimpleDB？

> ID：774329
> 
> 赞同：7
> 
> 时间：2009-04-21T20:00:50.073
> 
> 标签：amazon-web-services, amazon-ec2, couchdb, amazon-simpledb

我正在创建一个将托管在亚马逊 EC2 上的应用程序，并且将保存的许多数据都更加面向文档（以及保存推文等与这些文档相关的内容）。

现在我正处于十字路口......我应该使用simpleDB还是couchDB？使用其中任何一个的优点/缺点是什么？我应该两个都试一个月然后再决定吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-21T20:06:33.180

您可能会发现文章[Amazon SimpleDB 和 CouchDB 比较](http://www.automatthew.com/2007/12/amazon-simpledb-and-couchdb-compared.html)很有用。

我还发现[MongoDB](http://www.mongodb.org/display/DOCS/Home)提供了出色的性能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-21T20:28:04.390

请记住，如果您的代码位于 EC2 中，那么 SimpleDB 可能会托管在与您的代码相同的数据中心中，这将使 SimpleDB 对于来自 EC2 服务器的请求的延迟低于 CouchDB。此外，Amazon 不会向您收取 EC2 和 SimpleDB 之间的带宽费用。

由于这些原因，我希望 SimpleDB 对于在 EC2 中运行的代码来说更快更便宜。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-06T01:24:20.737

SimpleDB 由 Amazon 为您托管和维护，CouchDB 完全由您决定。这就是最大的不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-09T08:08:42.447

如果可能的话，我绝对会用您自己的用例对这两种解决方案进行一些基准测试，即如果您可以构建应用程序的合理子集以在任一数据库上运行（它们具有完全不同的 API，因此这可能并不容易） .

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-09T08:14:19.097

如果您在 .Net 环境中开发，那么有一个出色的 SimpleDB 库，称为[Simple Savant](http://www.codeplex.com/SimpleSavant)，它真正简化了集成..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-07T11:09:26.627

I've built some live solutions using SimpleDB and it works very well, especially with a caching layer in front of it (cf memcached et al). However I've recently started scoping out a new project and have decided to move to CouchDB for the primary reason of having control over the data.

As your commitment to SimpleDB grows, it gets harder and harder to migrate away to anything else (ah the joys of vendor lock in) and, frankly, that just isn't great for our business.

I remain a strong evangelist of cloud tech, and Amazon in particular, but I feel a lot better running couchdb on EC2 than I do with SimpleDB.

Roger

# domain-driven-design - 这真的是DDD吗？

> ID：774335
> 
> 赞同：23
> 
> 时间：2009-04-21T20:03:08.630
> 
> 标签：domain-driven-design

我有 80% 的把握我不应该问这个问题，因为这可能会让人觉得它是负面的，我的意思不是不尊重任何人，尤其是这本书的作者。我看过几篇推荐这[本书](http://www.wrox.com/WileyCDA/WroxTitle/-NET-Domain-Driven-Design-with-C-Problem-Design-Solution.productCd-0470147563.html)及其配套[项目](http://www.codeplex.com/dddpds)的帖子。我没有读过这本书，但我今天花了几个小时研究这个项目。虽然它看起来确实很完整，但我很难理解各种事物的细节散落在各处。我在自己的设计中苦苦挣扎，如果实体发生变化，我必须改变多少，而这个项目并没有让我很舒服地作为解决方案。

例如，有一个从 Person 继承的 Employee 对象。Person 有一个包含名字、姓氏等的构造函数，因此 Employee 也是如此。Private to Employee 是名字、姓氏的成员，以及相同的公共属性。

有一个 EmployeeFactory 知道 Employee 和 Person 属性，以及 SQL 列名（从读取器中提取值）。

有一个 EmployeeRepository 具有未实现的 PersistNewItem 和 PersistUpdatedItem 方法，我怀疑如果实现了这些方法，它将为我在 CompanyRepository 中看到的 INSERT 和 UPDATE 语句构建 SQL。这些将属性写入字符串以构建 SQL。

有一个“数据契约”PersonContract，它具有与 Person 相同的私有成员和公共属性，还有一个 EmployeeContract，它像 Employee 一样从 PersonContract 继承，具有镜像实体的公共属性。

有一个静态的“转换器”类，它带有将实体映射到合同的静态方法，包括

```
EmployeeContract ToEmployeeContract(Employee employee) 
```

它将字段从一个复制到另一个，包括 Person 字段。可能有一种相反的方法——不确定。

我认为也有单元测试。

我总共计算了 5-10 个类、方法和构造函数，它们具有关于实体属性的详细知识。也许它们是自动生成的——不确定。如果我需要向 Person 添加“Salutation”或其他属性，我是否必须调整所有这些类/方法？我确定我会忘记一些事情。

再说一次，我没有不尊重的意思，这似乎是本书的一个非常彻底、详细的例子。DDD是这样完成的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-21T20:32:29.373

领域驱动设计非常简单。它说：让你的模型类反映现实世界。因此，如果您有员工，请拥有一个员工类，并确保它包含赋予其“员工特质”的属性。

您要问的问题不是关于 DDD，而是关于一般的类架构。我认为您对您正在查看的类的一些决定提出质疑是正确的，但这与 DDD 无关。一般来说，它与 OOP 编程设计模式更相关。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-21T20:15:48.040

DDD 足够新（至少在某种意义上），现在说确切的“它是如何完成的”可能还为时过早。不过，这个想法已经存在了很长时间，尽管我们并没有给它起一个很酷的名字。

无论如何，简短的回答 (IMAO) 是“是的，但是....” 进行领域驱动设计的想法是非常明确地对领域进行建模。你正在看的是一个领域模型，也就是说一个面向对象的模型，它用问题域的语言描述了问题域。这个想法是域模型，因为它模拟“现实世界”，所以对变化相对不敏感，并且也倾向于本地化变化。因此，例如，如果您对 Employee 是什么的想法发生了变化，可能是通过添加邮寄地址和实际地址，那么这些变化将是相对本地化的。

然而，一旦你有了那个模型，你就拥有了我认为仍然需要做出的架构决策。例如，您有未实现的持久层，它可能确实只是 SQL 的构造。它也可以是一个 Hibernate 层，或者使用 Python pickling，或者甚至是像 Google AppEngine 分布式表结构这样的狂野的东西。

问题是，这些决策是单独做出的，并且有其他理由，而不是域建模决策。

我尝试过的一些好的结果是在 Python 中做域模型，然后用它构建一个模拟器，而不是实现最终系统。这使得客户可以进行试验，并且还可能允许您对最终实施必须确定的事情进行定量估计。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-12-07T04:15:14.770

对我来说，DDD 与“单纯”模型驱动设计的不同之处在于“聚合根”的概念，即应用程序*只允许保存对聚合根的引用*，并且通常您将只有聚合根的存储库类，而不是聚合根使用的类

这大大清理了代码；替代方案是每个模型类的存储库，这“仅仅是”分层设计，而不是 DDD

# javascript - 带有 onclick 处理程序的元素顶部的链接

> ID：774344
> 
> 赞同：1
> 
> 时间：2009-04-21T20:05:20.593
> 
> 标签：javascript, html

嘿。我有一个愚蠢但令人讨厌的问题。

如果我遇到这种（简化的）情况：

```
<div onclick="doSomething(); return false;">
    lorem ipsum <a href="somewhere.html">dolor sit</a> amet
</div> 
```

...是否有任何（方便的）方法可以防止在单击链接时触发父 div 的 onclick 处理程序。

在我的场景中，我有一个大的包装 div，它被制作成一个带有 onclick 处理程序的“链接”，但我想用其中的链接覆盖一些文本数据，但至少在 Firefox 中当我点击时文本中的链接，首先执行父级的onclick。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T20:10:11.593

使用 jQuery，您可以为每个锚点添加一个单击处理程序，并使用[event.stopPropagation()](http://docs.jquery.com/Events/jQuery.Event#event.stopPropagation.28.29)来防止事件冒泡到 DIV。

```
 $('div#wrapperDiv > a').click( function(event) {
       event.stopPropagation();
   }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T21:19:59.820

您可以通过在处理程序中测试事件的原始目标来解决此问题。类似于以下内容：

```
function doSomething ( e ) {
  // get event object and target element
  var e = e || window.event;
  var target = e.srcElement || e.target;
  // is target a div?
  if ( target && /^div$/i.test( target.nodeName ) ) {

    // do your magic in here ...

  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T20:07:45.157

恕我直言，这是 HTML/行为的错误嵌套。整个 div 可以作为 1 个元素点击，或者链接可以点击，但不能同时点击两者……除非你“取消嵌套”它们。

# c# - 如何在 Silverlight 网格上定位椭圆？

> ID：774345
> 
> 赞同：3
> 
> 时间：2009-04-21T20:05:21.107
> 
> 标签：c#, .net-3.5, silverlight-2.0

我正在创建一个 silverlight 应用程序，它允许您单击屏幕上的两个位置，并绘制一个椭圆，其主轴在单击位置开始和结束。可单击区域是 Silverlight Grid 控件。目前：

当你第一次点击时，我是：

1.  在点击点放置一个标记。
2.  创建一个椭圆并将其作为 Grid 的父级。
3.  在椭圆上创建和设置 AngleTransform。

当你移动鼠标时，我是：

1.  计算到第一个点击点的距离。
2.  将椭圆的宽度设置为此长度。
3.  计算一条线到点击点和网格 X 轴的角度。
4.  将 Ellipse 的 AngleTransform Angle 设置为这个角度。

到目前为止，一切都很好。椭圆会显示出来，它的长度和旋转角度会随着鼠标的移动而跟随鼠标移动。

**但是，椭圆的长轴从点击点偏移。如何定位椭圆，使其主轴从单击点开始并在当前鼠标位置结束？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T20:49:11.977

答案原来是：

*   不要使用`System.Windows.Shapes.Ellipse`. 而是使用`System.Windows.Shapes.Path`并嵌入`EllipseGeometry`其中。

*   还将 设置`Path.RenderTransform`为`RotateTransform`。

*   不要在. `Width`_ `Height`_ 而是设置,和的。`Stretch``Path``Center``RadiusX``RadiusY``EllipseGeometry`

*   最后，将 设置为长轴与 X 轴`RotateTransform.Angle`的交角（长轴斜率）。也设置和到.`Ellipse``ArcTan``RotateTransform.CenterX``CenterY``EllipseGeometry` `Center`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:20:50.070

如果我不得不猜测（代码会有所帮助），我认为您可以从开始单击点到网格左侧的差异添加填充，这应该有助于将其移动偏移量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T23:59:50.340

为您的应用程序使用 Canvas 而不是网格可能是一个好主意，这样您就可以直接设置形状坐标。

# wcf - 使用 WCF 进入 N 层架构？

> ID：774346
> 
> 赞同：6
> 
> 时间：2009-04-21T20:05:24.867
> 
> 标签：wcf, architecture, n-tier-architecture, crud

我为*一个有点*落伍的大型州政府机构工作。我们的技能已经过时，预算冻结阻止了对新员工/顾问的任何培训或雇用（解雇人员也是不可能的）。设计业务对象、实现设计模式、建立代码库和服务、单元测试、源代码控制等都是您在这里找不到的事情。我们在 Joel 测试中的得分尽可能为 0。好消息是我们只能从这里上去！

我们开发直接通过 ODBC 连接访问 Oracle 数据库的桌面 CRUD 应用程序（使用 C++、C# 或 Java）。我们基本上在 GUI 上散布着 SQL 语句和拼凑代码。我们被告知要转向面向服务的 n 层架构，以防止直接访问数据库并消除用户计算机上的 Oracle 客户端需求。

WCF 是我们应该走的路吗？我们已经完成了一些 n 层应用程序演练（例如[这个](http://msdn.microsoft.com/en-us/library/bb384570.aspx)），它们似乎很容易实现，但我们只是不知道我们是否正在考虑正确的技术。利用 .NET 生成的类型化 DataSet 似乎是一个不错的权宜之计，可以节省我们数月/数年的工作（而不是从头开始为众多项目创建新的业务对象）。这种罐装方法在第一步是否可行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T20:12:50.293

我最近开始在一些 Web 应用程序中为我的数据层使用 WCF 服务，我必须说，一开始（第一周左右）这很令人沮丧，但是一旦部署了代码，这是完全值得的。

您应该首先使用现有的小型应用程序进行尝试，或者进行概念验证，以确保它符合您的需求。

从您所处环境的描述来看，我相信您几乎会立即意识到它的好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T20:15:59.957

我工作的最后一家公司选择 WCF 的原因几乎与您上面描述的完全一样。WCF 有很多好的文档和书籍，它相对容易上手，而且 WCF 支持很多配置选项。

当您开始尝试使 WCF 以非专门设计的开箱即用方式工作时，可能会有些头疼。这些通常是配置问题。但是像这样的网站或[IDesign](http://www.idesign.net/idesign/DesktopDefault.aspx)可以帮助你完成这些。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T20:21:50.957

首先，我绝对**不会**（抱歉强调）担心使用 typed`DataSet`与创建自己的业务对象相比会节省多少时间。这通常不是您花费大部分开发时间的地方。我更喜欢自己使用业务对象。

在您的情况下，我想先实施概念验证。解决您可能遇到的所有问题的解决方案。这个概念验证应该实现一个完整的用例，从客户端开始，从数据库中检索数据并将其返回给客户端。在继续之前，您应该对自己的实施充满信心。

然后是技术的选择。WCF 绝对是您的客户端应用程序和服务层之间通信的一个不错的选择。我想您的客户端和服务层都将成为 C# 应用程序？这使事情变得容易多了，因为不同平台（例如 Java/C#）之间的互操作性仍然不是微不足道的，尽管它应该在大多数情况下都可以工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T20:28:38.117

结合 .NET 3.5 SP1 查看实体框架（因为已经有几个可用的 Oracle 提供程序），它启用了 EF 生成的类的内置 WCF 序列化。

这是一个很好的入门博客：http: [//blogs.msdn.com/dsimmons](http://blogs.msdn.com/dsimmons)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-22T13:18:58.393

[CSLA](http://www.lhotka.net/cslanet/)可能非常适合您的 N 层桌面应用程序。它支持 WCF，拥有庞大的开发社区，并且有据可查。它非常面向对象。

# memory-management - 垃圾回收机制是如何工作的？

> ID：774357
> 
> 赞同：27
> 
> 时间：2009-04-21T20:07:14.347
> 
> 标签：memory-management, garbage-collection

用外行术语来说，垃圾收集机制是如何工作的？

如何识别对象可用于垃圾收集？

`Reference Counting, Mark and Sweep, Copying, Train`另外， GC算法是什么意思？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-21T20:38:00.327

当您使用带有垃圾收集的语言时，您将无法直接访问内存。相反，您可以访问该数据之上的一些抽象。正确抽象的一件事是数据块在内存中的实际位置，以及指向其他数据块的指针。当垃圾收集器运行时（这种情况偶尔会发生），它会检查您是否仍然持有对它为您分配的每个内存块的引用。如果不这样做，它将释放该内存。

不同类型的垃圾收集器之间的主要区别在于它们的效率以及它们可以处理哪种分配方案的任何限制。

最简单的是正确的引用计数。当您创建对对象的引用时，该对象上的内部计数器会增加，当您偶然引用或它不再在范围内时，（前）目标对象上的计数器会减少。当此计数器达到零时，对象将不再被引用并且可以被释放。

引用计数垃圾收集器的问题是它们无法处理循环数据。如果对象 A 具有对对象 B 的引用，而对象 B 又具有对对象 A 的某些（直接或间接）引用，则它们永远不能被释放，即使链中的任何对象都没有在链外被引用（因此不是t 完全可以访问程序）。

另一方面，标记和扫描算法*可以*处理这个问题。标记和扫描算法通过定期停止程序的执行来工作，将程序分配的每个项目标记为不可达。然后程序运行程序具有的所有变量并将它们指向的变量标记为可达。如果这些分配中的任何一个包含对程序中其他数据的引用，则该数据同样被标记为可访问等。

这是算法的标记部分。此时，程序可以访问的*所有内容*，无论多么间接，都被标记为可达，而程序无法访问的所有内容都被标记为不可达。垃圾收集器现在可以安全地回收与标记为无法访问的对象关联的内存。

标记和清除算法的问题在于它效率不高——必须停止整个程序才能运行它，而且很多对象引用不会改变。

为了改进这一点，可以使用所谓的“分代垃圾收集”来扩展标记和清除算法。在这种模式下，已经在系统中进行了一些垃圾回收的对象会被提升到老年代，而老年代并不经常检查。

This improves efficiency because objects tend to die young (think of a string being changed inside a loop, resulting in perhaps a lifetime of a few hundred cycles) or live very long (the objects used to represent the main window of an application, or the database connection of a servlet).

Much more detailed information can be found on wikipedia.

**Added based on comments:**

With the mark and sweep algorithm (as well as any other garbage collection algorithm except reference counting) the garbage collection do *not* run in the context of your program, since it has to be able to access stuff that your program is not capable of accessing directly. Therefore it is not correct to say that the garbage collector runs on the stack.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-21T20:12:20.607

垃圾收集只是知道您的程序中是否需要变量，如果没有，则收集并删除它们。

重点是**垃圾**这个词，你家里完全用完的东西被扔进垃圾箱，垃圾人会来帮你处理它，把它拿走，给你家里的垃圾桶更多的空间。

参考计数、标记和扫描、复制、训练等在[GC FAQ中有详细讨论](http://www.iecc.com/gclist/GC-algorithms.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-21T20:15:01.490

*   引用计数 - 每个对象都有一个计数，当有人引用该对象时递增，当有人释放引用时递减。当引用计数变为零时，该对象被删除。COM 使用这种方法。
*   标记和扫描 - 每个对象在使用时都有一个标志。从对象图的根（全局变量、堆栈上的局部变量等）开始，每个引用的对象都设置了它的标志，依此类推。最后，图中未引用的所有对象都被删除。

[此幻灯片](http://blogs.msdn.com/tess/attachment/8402569.ashx)中描述了 CLR 的垃圾收集器。幻灯片 15 上的“根”是首先进入图表的对象的来源。它们的成员字段等用于查找图中的其他对象。

[维基百科](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science))更详细地描述了其中几种方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T20:15:54.733

完成的一般方法是在后台跟踪对对象的引用数量，当该数量变为零时，该对象将被垃圾收集，但是 GC 不会启动，直到它被明确需要，因为这是一项昂贵的操作。当它启动时，GC 会遍历内存的托管区域并找到每个没有引用的对象。gc 通过首先调用它们的析构函数来删除这些对象，允许它们自行清理，然后释放内存。通常，GC 将通过将每个幸存对象移动到一个内存区域来压缩托管内存区域，从而允许进行更多分配。

就像我说的，这是我知道的一种方法，并且在该领域正在进行大量研究。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T20:18:38.237

[垃圾回收](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science))是一个很大的话题，实现的方法有很多。

但简而言之，垃圾收集器会记录对通过`new`运算符创建的任何内容的所有引用，即使该运算符的使用对您来说是隐藏的（例如，在`Type.Create()`方法中）。每次添加对对象的新引用时，都会确定该引用的*根并将其添加到列表中（如果需要）。*只要超出范围，引用就会被删除。

当不再有对对象的引用时，可以（不是“将”）收集它。为了提高性能并确保正确完成必要的清理，一次为多个对象批处理集合并在多代中发生。

# c# - 为 .NET 程序集设置 CLS 合规性

> ID：774359
> 
> 赞同：31
> 
> 时间：2009-04-21T20:07:50.883
> 
> 标签：c#, .net, vb.net, cls-compliant

可以为整个 .NET 程序集设置 CLS 合规性。但它实际上是如何完成的？例如使用 Visual Studio 2008？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-21T20:17:38.300

Visual Studio 为编译器添加了一个指令，编译器会检查代码中是否存在比本机编程语言更严格的规则。

您可以通过添加程序集级别属性将符合 CLS 的属性添加到您的所有项目中

```
[assembly: CLSCompliant(true)] 
```

项目中的任何位置，通常在`assemblyinfo.cs`文件中。

如果该行`using System;`不在文件的顶部，请添加它。或者，使用长格式：

```
[assembly: System.CLSCompliant(true)] 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-21T20:09:13.000

您需要将此行添加到您的源文件之一：

```
[assembly: System.CLSCompliant(true)] 
```

有关 CLS 兼容代码的更多信息，请[点击此处](http://msdn.microsoft.com/en-us/library/bhc3fa7f(loband).aspx)。

通常你把它放在 assemblyinfo.cs

# c# - 签署程序集后未找到 WCF 方法

> ID：774360
> 
> 赞同：0
> 
> 时间：2009-04-21T20:07:51.117
> 
> 标签：c#, .net, web-services, wcf, gac

我在这样的解决方案中有 3 个项目：

*   WCF 服务：托管几个方法
*   类库：通过返回其 Soap 客户端的实例充当 WCF 服务的网关
*   WPF 应用程序：通过引用的类库使用服务方法

一切都运行良好......应用程序正在通过库访问soap客户端的实例并相应地使用方法。

现在我签署了我的程序集，一切仍在编译，当我添加新方法并更新库中的服务引用时，新方法出现在应用程序中......但是当运行应用程序并尝试使用方法时，`MissingMethodException`抛出了 a ：

> 找不到方法：“MusicData.Entities.User DBAccess_Gateway.DBInteraction_Service.DBInteractionGatewayClient.User_Login(System.String, System.String)”。

这是它失败的地方：

```
 var user = WSGateway.MR_WebService.User_Login(username.Text, crypto.Encrypt(passphrase.Password)); 
```

我认为这与正在签名的程序集（现在在 gac 中，因为它们已签名？）有关...但是为什么找不到方法？现在没有正确更新已签名的程序集吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T14:15:09.973

当您更新类库中的服务引用时，请确保您正在创建新版本的程序集并在 GAC 中注册此新版本，然后确保您的 WPF 应用程序正在引用此新版本。

# java - 从 Java 打印多个 PDF 作为单个打印作业（物理打印）

> ID：774361
> 
> 赞同：3
> 
> 时间：2009-04-21T20:07:53.377
> 
> 标签：java, pdf, printing

我想在一个打印作业中从 java（使用 java 打印服务）打印多个 pdf。

我想将多个 pdf 作为单个作业发送到打印机。这样一来，我的“批处理”中的所有文档都可以一起打印，并且当我从打印机中取出它们时不会与其他人的打印作业交错。

一个批次可能包含 1000 个打印作业。

我试过 jpedal，但它不支持 java.awt.print.Book

```
 Book book = new Book();
        PdfDecoder pdfDecoder = readFileApplyOptions("C:/Temp/singlepagetest.pdf", pageFormat);
        book.append(pdfDecoder, pageFormat);

        PdfDecoder pdfDecoderTwo = readFileApplyOptions("C:/Temp/printfax-test.pdf",pageFormat);
        book.append(pdfDecoderTwo, pageFormat);

        printJob.setPageable(book);
        printJob.print(); 
```

只打印出第一个pdf。如何在一个作业中打印多个 pdf？

readFileAndApplyOptions() 基本上创建一个新的 PdfDecoder 对象并返回它。

我还以类似的方式（使用 Book 对象）尝试了 Sun 的 PDFRenderer [PDFRenderer](https://pdf-renderer.dev.java.net/)，但我的代码仍然只打印出第一页。

有没有人遇到过类似的问题？有没有我可能会错过的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-23T12:44:29.140

当一次打印 JTabbedPane 的几个 JPanel 时，我遇到了同样的困难，每个 JTabbedPane 都在单独的页面上。我将它们收集在一本书中，但它只打印第一页。

Book 类运行良好（页数正确），但我认为问题来自 setPageable。因为一本书不是可打印的，所以我做了它，它有效！

解决方法：

1.  设计一个 PrintableBook 类：扩展 Book，实现 Printable

    ```
    public class PrintableBook extends Book implements Printable {
        Vector<Printable> pages;// NB: we assume pages are single

        public PrintableBook() {
            super();
            pages = new Vector<Printable>();
        }

        public void add(Printable pp) {
            append(pp, pp.getPageFormat());
            pages.add(pp);
        }

        public int print(Graphics g, PageFormat pf, int pageIndex) {
            if (pageIndex >= pages.size())
                return NO_SUCH_PAGE;
            else {
                Printable pp = pages.elementAt(pageIndex);
                return pp.print(g, pf, 0);
            }
        }
    } 
    ```

2.  然后使用`printJob.setPrintable( printableBook )`代替`setPageable`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-04T13:02:11.793

不是 Java 特定的，但我在 C# 中体验过这一点。我通过将每个文档打印到一个文件来解决它（以编程方式相当于检查打印对话框上的“PrintToFile”复选框），然后将每个文件连接到一个内存流中，我以原始格式将其传递给 Win32 API 打印机假脱机（因为默认情况下，输出到文件的格式已经正确）。

您也许可以在 Java 中使用类似的技术

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-06T12:44:06.110

[您应该使用iText](http://itextpdf.com/)库将所有​​ pdf 文档合并到一个文档中，然后逐页打印合并的文档。

请参阅[用 Java 打印 PDF 文档](http://juixe.com/techknow/index.php/2008/01/17/print-a-pdf-document-in-java/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T20:21:16.887

AFAIK，你不能，多个文档将在多个作业中打印。

一种解决方法是将所有 pdf 文件加入到一个文档中并打印出来。

：-/

# c# - 如何在 MS SQL 2005 / 2008 中正确实现触发器？

> ID：774371
> 
> 赞同：0
> 
> 时间：2009-04-21T20:10:31.093
> 
> 标签：c#, sql, visual-studio-2008, triggers

这可能是一个微不足道的问题，但无论如何我都会问：**一个数据库中的三个或四个表中的更新是否会触发另一个数据库中的一个或两个表的更新（在 MS SQL 2005 中？）** 我很高兴创建任意数量的 T -SQL 是必需的，而且我也有具有 C# 能力的 VS 2008，但以前从未编写过这样的触发器。

本质上，我让数据存储库的“GetProducts()”在任何时候以他们需要的范围加载任何数据时调用我的存储过程，并且我在物理上更改了“缓存”数据。生活中的一切都很好。

现在，他们根本不希望将数据更新作为存储库的一部分。他们认为这是项目外部的，应该在没有交互的情况下处理。

有人对追求什么有任何建议吗？链接到已经存在的想法会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T20:22:18.570

只有当一个表被更新、插入或删除时，触发器才会启动。如果您有一个必须插入表格的特定顺序，您可以将触发器放在最后一个。

或者，您也可以编写触发器来检查其他表，以确保所有表都有记录。或者您可以为每个表编写一个触发器。或者，如果不需要实时更新，您可以有一个定期运行的作业来处理所需的更改。不确切知道您想做什么，很难说处理您的特定情况的最佳方法是什么。无论您对触发器做什么，请记住触发器对一组数据进行操作，而不是一次操作一行。应该始终编写它们以处理多行插入、更新或删除，否则您的触发器迟早会导致数据完整性问题。不要在游标中执行此操作，除非您喜欢在有人需要为新客户输入 3,000,000 条新记录时将生产表锁定几个小时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T20:25:25.630

如果这是你想要的：

```
check database A for updates of table1, table2, table3, and or table4    
then update database B table5 and/or table6 
```

您需要使用存储过程来封装数据库 A 中的原始更新以及数据库 B 中的结果更新所需的所有逻辑和事务

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T20:18:36.520

您是在问是否更新这三个表，然后触发触发器？但是如果你只更新三个表中的两个不触发触发器呢？

您的触发器可以更新任意数量的表，它们还可以导致其他触发器触发，如果您喜欢生活在危险的一面，您甚至可以让这些是递归的，从而导致原始触发器再次触发。

但是，没有任何东西可以协调我认为您所描述的内容。不是说做不到。

# c# - 在后面的代码中使用资源图像

> ID：774375
> 
> 赞同：7
> 
> 时间：2009-04-21T20:11:13.010
> 
> 标签：c#, wpf, visual-studio, resources

我需要动态更改应用于我的一个按钮的背景图像，但不知道如何。图像被添加到项目中，并将它们的 Build Action 设置为 Resource。我尝试了以下方法：

```
buttonUnits.Background = new ImageBrush(new BitmapImage(new Uri("/Images/InchDOWN.png",UriKind.Relative))); 
```

这编译成功，但会因 DirectoryNotFoundException 而崩溃，提示“找不到路径 'C:\Images\InchDOWN.png' 的一部分”。

我不希望应用程序在磁盘上查找图像。如何将图像用作嵌入式资源？我认为这涉及将构建操作更改为嵌入式资源，但是如何在后面的代码中使用此资源？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-21T22:14:24.620

您必须将图像构建为资源而**不是**嵌入式资源。资源是专门供 WPF 项目使用的。

要在程序代码中使用它：

```
 buttonUnits.Background = new ImageBrush(new BitmapImage(new Uri("pack://application:,,,/Images/InchDOWN.png"))); 
```

这在我推荐的 XAML 中要容易得多。

**编辑**

我忘记了图像之前的正斜杠，这可能是问题所在。如果您需要更多信息，这里是[关于 pack Uris 的 MSDN 文章。](http://msdn.microsoft.com/en-us/library/aa970069.aspx)

也许您应该发布一个问题，说明您到底想要完成什么，并希望发现解决多状态按钮问题的不同方法。

# ruby-on-rails - Rails 搜索插件和解决方案

> ID：774376
> 
> 赞同：6
> 
> 时间：2009-04-21T20:11:39.767
> 
> 标签：ruby-on-rails, search

我希望在我的 Rails 站点上添加一个搜索框，并想知道您是否可以向我推荐用于跨指定列进行一般搜索的解决方案。我注意到acts_as_ferret 插件看起来不错，但我也在寻找其他意见。任何线索或建议将不胜感激。

感谢您的关注！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T20:21:12.643

[斯芬克斯](http://www.sphinxsearch.com/)非常好。在 Thinking Sphinx 插件上查看这个[出色的 Railscast](http://railscasts.com/episodes/120-thinking-sphinx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:13:56.577

我过去使用过 Ferret，但问题很少，尽管我听说 Sphinx 更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T13:52:08.547

我没有听说过关于 Ferret 的好消息，所以我使用了 Solr（它基于 Apache 的 Lucene）。它工作得很好，但我在输入中的某些字符出现问题导致问题，并且它们在发布包含所有补丁的更新时很慢。我的计划是将我必须的现有项目切换到 Sphinx，看看它是否确实像某些人所说的那样好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T14:56:03.480

Ferret 有问题，我正在使用 Sphinx（Thinking Sphinx 插件）。Solr 基于 Java。Sphinx 速度很快，它支持增量索引并与 will_paginte 集成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-29T05:43:54.733

我在内部应用程序上使用 ferret 已经 2 年了，没有任何问题。性能和稳定性还可以，但我的用户群和数据量不是很大。在大约 600MB 的索引大小上，每天可能进行 300-400 次搜索。

# asp.net - 如何使用 javascript 标签发送参数？

> ID：774384
> 
> 赞同：1
> 
> 时间：2009-04-21T20:15:03.453
> 
> 标签：asp.net, javascript, query-string

如何将 javascript 标记中的参数（使用 QueryString）作为源属性发送到 ASP.NET 页面？

例子：`<script language="javascript" src="myDomain/myPage.aspx?id=123&no=43"></script>`

我必须在“myPage.aspx”中做什么？

例如，我想根据它的 src 查询字符串将图片发送到脚本标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T20:22:21.860

script 标签用于在页面中包含 javascript 代码。如果要在页面上显示图像，即使是动态生成的图像，也需要使用 img 标签，而不是 script 标签。

```
<img src="myDomain/myPage.aspx?id=123&no=43" alt="some text" /> 
```

通常，您会为此使用 HttpHandler（ashx 而不是 aspx），它只需要构造图像（或从文件中读取它），然后使用正确的 MIME 类型、长度在响应中发送数据， ETC。

有关如何使用 HttpHandler 从数据库中检索图像的信息，请参阅此[参考。](http://www.developerfusion.com/code/5223/using-ashx-files-to-retrieve-db-images/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T20:29:53.577

目前尚不清楚您打算在 myPage.aspx 中做什么。由于它是一个脚本标签，它应该是生成 javascript 代码。但我看不出有什么理由需要动态生成 javascript 代码。Javascript变量基本上具有全局范围，因此在包含脚本标记之前将图像定义在变量中。

因此，在您的 html 页面中，您将在标题中执行以下操作：

```
<script type="text/javascript">
var imageURL = 'http://www.google.com/intl/en_ALL/images/logo.gif';
</script>
<script src="myScript.js" type="text/javascript"></script> 
```

然后在 myScript.js 中：

```
alert("The image URL is: " + imageURL);
//do whatever processing with the image that you need to do... 
```

谷歌分析过去就是这样工作的（在他们采用更面向对象的方法之前）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T20:25:25.537

为什么要将图片发送到脚本标签？基本上你所拥有的将在客户端工作。在 MYPage.aspx 中，您需要输出要发送的内容。

我建议使用 HttpHandler，它非常适合动态提供 CSS、Javascript 或图像等内容

*   [Asp.net System.Web.HttpContext.Current.Session 在 global.asax 中为空](https://stackoverflow.com/questions/293276/asp-net-system-web-httpcontext-current-session-null-in-global-asax)
*   [在 asp.net 中显示来自 sql server 数据库的图像的最佳方法是什么？](https://stackoverflow.com/questions/612342/whats-the-best-way-to-display-an-image-from-a-sql-server-database-in-asp-net/612360)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-20T22:07:19.823

您所要做的就是为您的`<SCRIPT>`标签提供一个指向 ASPX 页面的 SRC 属性，就像您想要的那样。唯一的技巧是您必须让返回 javascript 的 ASPX 页面将 contentType 设置为`text/javascript`. （确保它只发回有效的 javascript。）

这里有两个文件可以证明它有效：

### JavascriptLibraryTester.aspx

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script src="JavascriptLibraryTest.js.aspx?Color=red" type="text/javascript" charset="utf-8">
</script>
</head>
<body>
    <a href="javascript:showServerGeneratedJavascript()">show Server Generated Javascript</a>
</body> 
```

### JavascriptLibraryTest.js.aspx

```
<%@ Page Language="C#" %>
<%
    Response.ContentType = "text/javascript";
    string color = Request["Color"];
    string now = DateTime.Now.ToString();
%>
function showServerGeneratedJavascript(){
    alert('<%=now %>\n<%=color %>');
} 
```

# c# - 您如何编写易于理解（/可维护）的搜索功能？也许以模块化方式？

> ID：774394
> 
> 赞同：0
> 
> 时间：2009-04-21T20:16:07.273
> 
> 标签：c#, java

每次看到一个搜索功能，背后的代码都是一团糟。数百行代码，意大利面条式代码，几乎总是一种巨大的方法。一种编程语言（Java/C#/PHP/等）用于构造一个大的胖 SQL 查询。很多，如果不是的话。

必须有比这更优雅的方法吗？或者，当您使用 RMDBS 而不是平面数据结构时，您会得到什么？

我愿意更多地了解这个话题，甚至可能买一本书。/亚当

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T20:23:14.637

使用[查询对象模式](http://www.martinfowler.com/eaaCatalog/queryObject.html)。如果可以的话，也可以使用 ORM，它会让事情变得更容易。实现细节取决于您的平台和架构，但这里有一些示例：

*   [http://www.theserverside.com/patterns/thread.tss?thread_id=29319](http://www.theserverside.com/patterns/thread.tss?thread_id=29319)
*   [http://www.lostechies.com/blogs/chad_myers/archive/2008/08/01/query-objects-with-the-repository-pattern.aspx](http://www.lostechies.com/blogs/chad_myers/archive/2008/08/01/query-objects-with-the-repository-pattern.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:47:43.173

在我当前的项目中，我们使用了 mausch 提到的查询对象模式的简化版本。在我们的例子中，我们有一个由一个字段和一个值组成的搜索条件对象，并且可以将几个这样的对象添加到一个列表中。从一开始我们确实有一个 operator 属性，但它从未使用过，所以我们将其删除。条件是被视为 AND 还是 OR 取决于所使用的搜索方法（我会说在该项目中 95% 的情况下它是 AND）。

find 方法本身并没有对这些信息做很多事情。他们将调用数据库中存储的过程，将标准作为参数传递。这些过程中的大多数都是相当直接的，即使我们有一些确实涉及一些字符串处理来解包某些字段的标准列表。

从调用者的角度来看，代码可能看起来像这样（控制器类将重复的东西包装为使用可配置实现*实例化搜索对象，并使用搜索条件等填充它）：

```
CustomerCollection customers = CustomerController.Find(new SearchCriterion("Name", "<the customer name>")); 
```

如果需要多个搜索条件，则可以传递一个集合。在 finder 函数中，代码将遍历集合，将当前值映射到 SqlCommand 对象中的适当参数。

这种方法对我们来说效果很好。

*) “可配置实现”意味着我们已经创建了一个架构，其中搜索对象被定义为抽象类，这些类仅定义接口并包含一些通用的前后验证。实际的搜索代码是在单独的子类中实现的；除其他外，这使我们能够快速创建一个“假数据层”，该层可用于模拟一些单元测试的数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T00:24:13.997

你看过 Lucene 项目（[http://lucene.apache.org](http://lucene.apache.org)）吗？它正是为此目的而设计的。这个想法是您构建然后维护一组索引，然后可以轻松搜索这些索引。生命周期是这样工作的：

*   编写一堆 sql 语句来索引数据库的所有可搜索区域
*   对整个数据库运行它们以创建数据的初始索引
*   每次数据更改时，更新这些索引。

查询语言更简单，您的查询变得更有针对性。

hibernate 工具套件中有一个很棒的项目叫做 hibernate search ( [http://search.hibernate.org](http://search.hibernate.org) )，如果你使用 hibernate 作为 ORM，它会为你维护索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T06:45:50.303

我一直在修改这个想法（因为我实际上必须在前一段时间实现类似的东西）并且我得出的结论是，有两种方法可以使它既工作又特别可维护。但在进入这些之前，这里首先是一些历史。

## 1.为什么还会存在问题

大多数搜索功能都基于源自数据库中的算法和技术。SQL 最初是在 1970 年代初开发的（[维基百科说是 1974 年](http://en.wikipedia.org/wiki/SQL)），那时的编程与今天相比完全是另一种野兽，因为每一个字节都被计算在内，每一个额外的函数调用都可能在卓越性能和破产之间产生差异，编写代码由那些在大会中思考的人......好吧，你明白了。

问题在于，这些技术最初大部分都被带到了现代世界而没有改变它们（为什么要改变它们，*不要修复没有被破坏的东西*），这意味着旧的范式也在蔓延。然后在某些情况下，原始算法由于某种原因被误解，最终得到你现在拥有的东西，比如[慢正则表达式](http://swtch.com/~rsc/regexp/regexp1.html)。不过，这里需要强调一下，技术本身还不错，通常只是遗留范式！

## 2.问题的解决方案

我最终使用的解决方案是一个混合了[构建器模式](http://en.wikipedia.org/wiki/Builder_pattern)和[查询对象模式](http://www.martinfowler.com/eaaCatalog/queryObject.html)（已经由 mausch 链接）的系统。例如，如果我要创建一个实用的系统来构建 SQL 查询，它看起来像这样：

```
SQL.select("column1", "column2")
   .from("relation")
   .where().valueEquals("column1", "hello")
           .and().valueIsLargerThan("column2", 3)
   .toSQL(); 
```

这样做的明显缺点是构建器模式倾向于过于冗长。好处是每个构建步骤（=方法）本质上都非常小，例如`.valueIsLargerThan("a", x)`可能只是`return columnName + ">=" + x;`. 这意味着它们很容易进行单元测试，最大的好处之一是它们可以很容易地从 XML/whatnot 等外部源生成，最值得注意的是它很容易创建从 SQL 查询到 Lucene 查询的转换器（*Lucene已经为此提供了自动化功能，这只是一个示例*）。

我宁愿使用但真正避免使用的第二个是因为它不是顺序安全的（*除非您花费大量时间创建元数据帮助器类*），而构建器是。写一个例子比更详细地说明我的意思更容易，所以：

```
import static com.org.whatever.SQL.*;

query(select("column1", "column2"),
      from("relation"),
      where(valueEquals("column1", "hello"), 
            valueIsLargerThan("column2", 3))); 
```

我确实将静态导入视为不利因素，但除此之外，这看起来像是我真正想要使用的东西。

# php - 如何在现有站点上逐步引入和测试memcached？

> ID：774395
> 
> 赞同：3
> 
> 时间：2009-04-21T20:17:19.503
> 
> 标签：php, memcached

我并不是说实际安装它。我目前使用 LAMP 进行开发，并希望开始将 memcached 用于高流量站点。应该缓存哪些类型的数据库调用？（全部？）在开发服务器上进行负载测试的好方法是什么？是否有我应该首先在我的生产站点上查看的基准？该站点主要是选择很少更新/插入的。就内存使用与流量而言，是否应遵循任何一般准则，或者主要是通过反复试验？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T01:46:50.007

始终先测量，然后优化。写下您的主要瓶颈并对其进行一些良好的性能测试。

目前没有多少基准测试程序可以模拟您自己的负载，我不认为我可以向您推荐一个，因为每个站点都是独一无二的。

但是有一些工具可以尝试模拟高流量。

*   [网络流量测试工具列表](http://www.softwareqatest.com/qatweb1.html#LOAD)
*   [压力工具来测试您的 Web 服务器](http://support.microsoft.com/kb/231282)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T01:47:03.967

首先，这取决于您必须使用多少内存、您需要数据的频率以及数据更新的频率。

> 应该缓存哪些类型的数据库调用？（全部？）

如果您以与您选择它的速度大致相同的速度更新数据，那么它可能不值得缓存。

正如 Eric 所说，下拉列表和您用于站点的任何其他静态内容都可以很好地利用 memcache。

更新后请记住删除/刷新缓存的项目。

> 什么是在开发服务器上进行负载测试的好方法？

不确定您对此有什么样的负载测试。

> 是否有我应该首先在我的生产站点上查看的基准？该站点主要选择很少的更新/插入。

检查您正在进行的查询类型，可能记录它们以及调用的次数。最频繁的可能会被缓存。

还要确保没有任何其他可以先进行的 sql 优化。

> 就内存使用与流量而言，是否应遵循任何一般准则，或者主要是通过反复试验？

我认为内存与流量之间的关系并不大。我会弄清楚你的盒子需要什么样的内存才能在高峰流量时间运行，并相应地设置内存缓存的内存限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T00:44:45.227

我会先从支持次要功能的查询开始。观察它如何响应首先被缓存，稍微修改一下。然后当您了解您的网站对其的反应时，然后开始尝试缓存其他查询。我从未使用过 memcached，但我正在使用 codeigniter 中的查询缓存。

我从缓存查询开始，这些查询用于填充我网站上的某些下拉框和表单元素。它们很少更改，并且如果没有管理操作（例如将新文件加载到将记录添加到我的表中的数据库），它们也不会更改。如果您有任何类似的疑问，我建议您先尝试一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T16:00:53.827

如果您`SELECT`对数据库的写入次数多而少，那么 MySQL 的查询缓存应该可以很好地为您缓存数据。

要查看查询缓存的工作效率，请尝试以下操作：

```
> SHOW GLOBAL STATUS LIKE 'Qcache_hits';
+---------------+--------+
| Variable_name | Value  |
+---------------+--------+
| Qcache_hits   | 735740 |
+---------------+--------+
1 row in set (0.00 sec)

> SHOW GLOBAL STATUS LIKE 'Com_select';
+---------------+---------+
| Variable_name | Value   |
+---------------+---------+
| Com_select    | 5644038 |
+---------------+---------+
1 row in set (0.00 sec) 
```

找到命中率计算`Qcache_hits / (Qcache_hits + Com_select)`

在这种情况下`735740 / (735740 + 5644038) = 0.1153`

那是11％的命中率，非常差。

如果您在计算机上看到更高的百分比，那么使用 memcached 的情况可能会更少。

MySQL 的查询缓存在许多情况下都运行良好（我怀疑这包括你的）。每次更新表时，缓存条目都会失效（即使您的缓存查询与未更改的行相关），这是它的一大缺点。在某些情况下，当您和您的应用程序可以比 MySQL 查询缓存更智能地处理缓存到期时，您可以使用 memcached 将项目缓存在更接近行级别的位置。

让我知道查询缓存命中率的结果。您甚至可能会发现您目前已禁用查询缓存（！）

您可以通过运行以下查询来验证它是否已启用：

```
> SHOW GLOBAL VARIABLES LIKE '%cache'; 
```

检查`have_query_cache = YES`并`query_cache_size > 0`在那里。

# c# - 从 .ToString("c") 格式的数字中删除尾随小数

> ID：774399
> 
> 赞同：34
> 
> 时间：2009-04-21T20:18:12.277
> 
> 标签：c#, localization, currency

基本上我正在像这样格式化数字

```
price.ToString("c") 
```

结果是英语为 615.00 美元，法语为 615,00 美元。

然而，我想要的结果分别是 615 美元和 615 美元。我怎样才能做到这一点，同时仍然利用 .net 本地化处理？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-21T20:23:20.970

如果你不介意四舍五入...

```
price.ToString("c0") 
```

# sql-server - 一张只有一列的表格有什么问题吗？（MSSQL 服务器）

> ID：774402
> 
> 赞同：0
> 
> 时间：2009-04-21T20:18:40.357
> 
> 标签：sql-server, database-design

考虑以下场景：

表：

*   员工（EmpId（PK），姓名）
*   TeamMembers（TeamId（PK），EmpId（PK））
*   项目（ProjId（PK），TeamId）

我真的想避免使用复合 PK，但我看到的唯一方法是创建一个只有 1 列 TeamId(PK) 的 Team 表（我不想存储与团队相关的任何信息，而不是其成员） （**编辑**：如果我创建一个团队表，我会将 TeamMeberId 添加到 TeamMembers 表并使其成为 PK）

当前设置的另一个问题是我无法在 Project 和 TeamMebers 表之间为 TeamId 设置关系

我应该只创建一个 1 列的团队表吗​​？在这种情况下，最好的方法是什么？

### 编辑

只是为了澄清一下，我唯一想知道的关于那个团队的事情就是它的存在，没有任何额外的信息

### 编辑2

表新设计（有什么问题吗？）：

*   员工（EmpId（PK），姓名）
*   团队(TeamId(PK))
*   TeamMembers（TeamMemberId（PK），TeamId（FK），EmpId（FK））
*   项目（ProjId（PK），TeamId（FK））

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T20:25:45.630

如果一个团队唯一有趣的是它存在的事实，那么`Team`只有一列的表没有任何问题：`TeamId`. `TeamMembers`它确保了和`Project`表的引用完整性。

但是我不明白你反对复合PK。表中的列`TeamId`和列已经是复合主键。`EmpId``TeamMembers`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T20:25:57.140

这种情况没有任何问题。我会做的。

另一方面，您可以在团队表中保存其他信息，例如团队名称或其他信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T20:33:04.800

1 列表没有任何问题。但是，您可能需要考虑您的 Team 表可能具有的其他属性。例如，团队名称？

对于项目和员工之间的关系，您只需通过 TeamMembers 表加入即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T20:25:13.570

EmpId 真的需要成为 TeamMembers 表中的主键吗？你可以说每个团队都有很多员工，而且关系很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T20:33:47.513

由于看起来 Project 和 TeamMembers 之间存在一对一的关系（如果我错了，请纠正我），并且您不想存储有关团队的其他信息，那么摆脱它不是更容易吗TeamMembers 表，并使用 Project 和 Employee 之间的多对多链接表

```
Employee (EmpId(PK), Name)
EmployeeProjects(EmpId(PK), ProjId(PK))
Project(ProjId(PK), <other project info>) 
```

但要回答你原来的问题。使用单列表并没有什么特别的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T20:38:51.337

这就是我构建表格的方式

1.  员工（EmployeeId（PK），姓名）
2.  团队 (TeamID(PK))
3.  TeamMembers（TeamMembersID（PK）、TeamId、EmployeeId）
4.  项目（ProjectID（PK），TeamId）

我喜欢有一个 PK 作为表名，以 ID 为后缀。
这种约定确实有有时会创建看似冗余的主键（如 TeamMembersID）的副作用，但它解决了您的复合键问题。

# firefox-addon - 使用 DOM 文档而不是 URI 创建选项卡/窗口？

> ID：774405
> 
> 赞同：1
> 
> 时间：2009-04-21T20:19:21.213
> 
> 标签：firefox-addon, xul, xpcom

我有一个需要在请求中发送特殊标头的 Web 服务。我能够使用 XMLHttpRequest 和 setRequestHeader() 检索预期的 responseXML。

现在我想创建一个包含响应文档的新选项卡（或窗口）。我希望将默认 XMLPrettyPrint.xsl 文件应用到它，并且在查看源代码时，我希望在查看普通 .xml 文件时看到未设置样式的源代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T21:27:46.407

我最终创建了一个协议处理程序。

我发现没有很好记录的最大技巧是 XPCOM 合同 ID 必须以“@mozilla.org/network/protocol;1?name=”开头。例如，：

```
/* as in foo:// . This is called the scheme. */
var thisIsWhatMyProtocolStartsWith = "foo"; 
var contractID = "@mozilla.org/network/protocol;1?name=" + thisIsWhatMyProtocolStartsWith; 
```

# c# - 从启用分页的 GridView 控件中检索所有 GridViewRow 对象

> ID：774406
> 
> 赞同：0
> 
> 时间：2009-04-21T20:19:49.043
> 
> 标签：c#, asp.net, gridview, paging

我目前在我的 aspx 页面上有一个启用分页的 GridView 控件，我需要遍历整个行集合/计数来处理选定的记录。使用我当前的代码，它只会循环遍历 GridView 行的当前页面。

完成这项任务的最佳方法是什么？

这是我当前的代码：

ASPX 页面：

```
<asp:GridView ID="MyGridView" runat="server" AllowPaging="true" PageSize="20">
   <Columns>
      <!-- My Column list -->
   </Columns>
</asp:GridView>
<asp:Button id="MyButton" runat="server" Text="Add" OnClick="MyButton_Click" /> 
```

后面的代码：

```
protected void MyButton_Click(object sender, EventArgs e)
{
    for (int Count = 0; Count < MyGridView.Rows.Count; Count++)
    {
        //The row count is 20 and only contains the GridViewRow object in the current page view  
        //I want to retrieve the all GridViews rows so I can add them to a ReorderList control
    }   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T06:59:57.493

是的，因为您的 gridview UI 只知道当前页面。获取数据源并从那里确定行数...

```
 int count = ((DataTable)MyGridView.DataSource).Rows.Count; 
```

//或者

```
 int count = ((ICollection<SomeRecord>)MyGridView.DataSource).Count; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-09T05:21:31.103

只需使用以下代码：

```
//Change gridview to
GridView1.AllowPaging = false;
GridView1.DataBind();

 //Transfer rows from GridView to table
for (int i = 0; i < GridView1.Rows.Count; i++)
{
    if (GridView1.Rows[i].RowType == DataControlRowType.DataRow)
    {
        for (int j = 0; j < GridView1.Rows[0].Cells.Count; j++)
        {
              //Add your code here..
        }
    }
}

//After filling your datatable change gridview paging style back to first, ie.

GridView1.AllowPaging = true;
GridView1.DataBind(); 
```

这可能会帮助你，让我知道这是否对你有帮助......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T20:23:13.200

我认为您应该从数据源的行数中获取行数。

如果需要过滤行，可以使用DataTable的/DataView的**Select**方法。

**编辑：**如果 gridview 被分页，你不能通过 gridview.Rows.Count 获得实际的行数。根据您的评论，我假设您正在使用 listDataSource 通用列表来绑定您的 gridview，您可以将您的行数设为：

```
List<DataSourceItem> selectedRows = 
  listDataSource.FindAll(delegate(DataSourceItem item)
  {
      // Assuming you have a IsSelected bool property 
      // that refers your row is selected : 
      return item.IsSelected;
  });
  int rowCount = selectedRows.Count; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T12:52:49.020

使用会话或状态来存储：

```
protected void Set_CheckboxStatus()
    {
        CheckBox selectall = (CheckBox)EmployeeGrid.HeaderRow.FindControl("gcb_selectall");
        ArrayList cbstatuslist = new ArrayList();
        if (Session["childcbstatus"] != null)
        {
            cbstatuslist = (ArrayList)Session["childcbstatus"];
        }
        foreach (GridViewRow row in EmployeeGrid.Rows)
        {
            int cb_index = (int)row.DataItemIndex;  //For Getting DataItemIndex of EmployeeGrid 
            //int cb_index = (int)row.RowIndex;
            CheckBox cb_selemp = (CheckBox)row.FindControl("gcb_selemp");
            CheckBox cb_active = (CheckBox)row.FindControl("gcb_active");

            if (cb_selemp.Checked == true)
            {
                if (!cbstatuslist.Contains(cb_index))
                    cbstatuslist.Add(cb_index);
            }
            else
            {
                cbstatuslist.Remove(cb_index);
            }
        }
        Session["childcbstatus"] = cbstatuslist;
    } 
```

从数组列表中，您可以获取所有行索引以循环并从带有分页的网格视图中获取值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-02T23:30:07.357

@CRice 的回答应该是官方的回答。

这是我的解决方案。您需要将 gridview 的数据通过其`DataSource`、 、`ViewState`或`Session`.

GridView.Rows 仅指“可见”行，或当前显示在屏幕上的页面。

```
 protected void GridView_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        GridView gv = (GridView)sender;

        DataSourceSelectArguments dss = new DataSourceSelectArguments();

    //get the datasource related to the gridview
    string wsDataSourceID = (gv.DataSourceID == string.Empty) ? ViewState["DataSourceID"].ToString() : gv.DataSourceID;
    SqlDataSource sds = (SqlDataSource)pnlMAIN.FindControl(wsDataSourceID);
    if (sds != null)
    {
        //load the data again but this time into a dataview object
        DataView dv = (DataView)sds.Select(DataSourceSelectArguments.Empty);
        if (dv != null)
        {
            //convert the dataview to a datatable so we can see the row(s)
            DataTable dt = (DataTable)dv.ToTable();
            if (dt != null)
            {
                //Save your data before changing pages
                ViewState["AllTheData"] = dt;

                gv.DataSource = dt;
                gv.DataSourceID = null;
            }
        }
    }

    //now change pages!
        gv.PageIndex = e.NewPageIndex;
        gv.DataBind();
    } 
```

接下来，换页的时候，我们这里保存数据

```
protected void GridView_PageIndexChanged(object sender, EventArgs e)
{
    GridView gv = (GridView)sender;

    DataSourceSelectArguments dss = new DataSourceSelectArguments();

    //reload the datatable back to the gridview
    gv.DataSource = ViewState["AllTheData"];
    gv.DataSourceID = null;
    gv.DataBind(); 
```

我希望代码不言自明。

谢谢

# c - 在 C 中如何编写适合操作系统的行尾字符？

> ID：774409
> 
> 赞同：7
> 
> 时间：2009-04-21T20:20:47.700
> 
> 标签：c, portability

Unix 有\n，Mac 是\r，但现在是\n，DOS/Win32 是\r\n。使用 C 创建文本文件时，如何确保使用适合操作系统的行尾字符？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-21T20:23:33.497

```
fprintf(your_file, "\n"); 
```

如果您以文本模式打开文件，这将由操作系统上的 stdio 库转换为适当的 EOL。在二进制模式下，不会发生转换。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-21T20:23:46.007

来自维基百科：

> 在文本模式下写入文件时，'\n' 被透明地转换为系统使用的本机换行符序列，它可能比一个字符长。（请注意，C 实现不允许在文件中存储换行符。例如，文本文件的行可以存储为 SQL 表的行或固定长度的记录。）在文本模式下读取时，本机换行序列被翻译回'\n'。二进制模式，C库支持的第二种I/O模式，不进行翻译，直接输出任何转义序列的内部表示。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-21T20:26:17.280

当您以文本模式打开文件时（传递“w”`fopen`而不是“wb”）写入文件的任何换行符都将自动转换为系统的适当换行符序列。当您阅读文件时，换行符序列将被转换回换行符。

这就是区分文本和二进制模式很重要的原因；如果您以二进制模式编写，C 将不会篡改您写入文件的字节。

# c# - 为什么这段代码在运行了将近一年的情况下却无法正常工作

> ID：774420
> 
> 赞同：1
> 
> 时间：2009-04-21T20:22:09.913
> 
> 标签：c#, .net, vb.net, assemblies

自动软件更新是否会导致某些模块属性不起作用？我真的对我在这里发布的这个功能摸不着头脑。它们基本上与从当前执行的程序集中读取图像徽标的功能相同。名为“Get2LogoImageStream”的函数与“Get1LogoImageStream”的区别仅在于 Current.ManifestModule.Name 与 Current.ManifestModule.ScopeName。

此“Current.ManifestModule.Name”版本的代码适用于 Web From 应用程序和 Windows 窗体应用程序，但现在它仅适用于 Windows 应用程序窗体。但是，当我用“Current.ManifestModule.ScopeName”更改此代码“Current.ManifestModule.Name”时，它在 WEB 上运行没有任何问题。所以我对其他 C# 或 VB.NET 开发人员的问题是，自动软件更新会导致这类问题吗？

```
 protected Stream Get1LogoImageStream()
{
    Assembly current = Assembly.GetExecutingAssembly();
    string imageName = "logo.jpg";
    string file = string.Format("{0}.{1}", current.ManifestModule.ScopeName.Replace(".dll", string.Empty), imageName);
    return current.GetManifestResourceStream(file);
}

protected Stream Get2LogoImageStream()
{
    Assembly current = Assembly.GetExecutingAssembly();
    string imageName = "logo.jpg";
    string file = string.Format("{0}.{1}", current.ManifestModule.Name.Replace(".dll", string.Empty), imageName);
    return current.GetManifestResourceStream(file);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T20:37:29.283

由于 .Name 仅返回程序集而 .ScopeName 返回完整路径，因此似乎某些原因导致您的程序需要标识文件的绝对路径才能运行。

从那里开始，可能会有很多事情，我脑海中的想法：1）您有一个环境变量存储允许找到图像的路径。

2）您移动了图像或程序集，或者以某种方式更改了程序集运行的上下文，使得它在错误的位置搜索图像。

3) 某些 .NET 更新可能要求使用完全限定名称，但我对此表示怀疑。

没有更多细节，很难说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T20:26:55.423

你能告诉我们它是**如何**使用原始实现的吗？任何特定的例外情况及其消息？

**更新：**另外，您能否进行一些挖掘以查看最近安装了哪些更新？

**更新：**所以您是在谈论将程序集从 .NET 2.0 转换为 3.0/3.5 而不是 Windows 自动更新？这是一个很大的区别。

据我所知，.NET 3.0/3.5 专门设计为与 .NET 2.0 组件完全向后兼容，因此在 3.5 上运行 2.0 程序集应该不是问题。如果您指的是升级 .NET 2.0 项目/解决方案，那么我不确定。

另一种可能性是您在 .NET 2.0 中所依赖的错误可能在 .NET 3.5 中已得到纠正——但这纯粹是猜测。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T20:42:30.970

我将从使用`System.IO`类开始您正在执行的一些路径操作。Path 类有一个很好的[`GetFileNameWithoutExtension`](http://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension.aspx)方法，应该（嗯）替换你的`Replace`方法调用（或者甚至可能[`ChangeExtension`](http://msdn.microsoft.com/en-us/library/system.io.path.changeextension.aspx)因为这就是你似乎正在尝试做的事情）。

我看到的主要区别在于`Name`，`ScopeName`后者有完整的路径，而前者没有。这使我认为这是某种路径问题。

正如其他人所说，您能否发布更多详细信息，例如您遇到的错误/异常？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T20:48:17.570

GetManifestResourceStream() 需要包含 Namespace.ResourceName.Ext 的资源名称。

由于您必须指定命名空间（而不是程序集名称），因此您应该将其包含在您的字符串中：

```
protected Stream Get2LogoImageStream()
{
    Assembly current = Assembly.GetExecutingAssembly();
    string file = "YourNamespace.logo.jpg";
    return current.GetManifestResourceStream(file);
} 
```

# windows - 什么是在 Windows Vista 中监视 IIS 的好/免费软件？

> ID：774425
> 
> 赞同：1
> 
> 时间：2009-04-21T20:23:02.327
> 
> 标签：windows, iis, logging, monitoring

我总是忘记检查我们网络服务器上的 IIS 中发生了什么，并且想知道：是否有一些愚蠢的小程序或总是在本地运行的东西，我可以单击以检查远程计算机上的事件日志和 IIS 日志？

标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T06:43:36.707

一次一个。Compmgmt.msc -> 连接到另一台计算机。

但是一个接一个很无聊。监控几十台机器？我一直在使用[MS 的 logparser 来](http://www.microsoft.com/downloads/details.aspx?FamilyID=890cd06b-abf8-4c25-91b2-f8d975cf8c07&displaylang=en)满足我的日志监控需求。我每天运行几次将错误和警告转储到 csv 文件的查询。

到目前为止，我只用它来聚合我们 QA 环境中十几个服务器的事件日志，但它似乎在日志输入上采取了多种形式，包括 IIS。一个伪日志文件查询（我没有样本）

```
logparser "Select [eventtype], [message] into output.csv FROM \\server1\system, \\server2\system" -i EVT 
```

这表明：您可以聚合多个服务器。你告诉它输入格式——它支持十几种日志类型。您可以将其转储到 csv 文件中。它看起来有点像 SQL。 [这篇以安全为中心](http://www.securityfocus.com/infocus/1712)的文章有一个 IIS 日志示例。

我不是一个applet 类型的人，所以我对桌面小部件没有太多了解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T12:21:04.037

您可以设置[samurize](http://www.samurize.com/modules/news/)以跟踪本地和远程计算机上的日志记录输出，但它需要一些设置。

您可以使用 OpenSSH 等远程 shell 实用程序安全地连接到远程计算机。

# algorithm - 将字符串转换为整数（不是 atoi！）

> ID：774426
> 
> 赞同：1
> 
> 时间：2009-04-21T20:23:07.290
> 
> 标签：algorithm, numbers

我希望能够将一个字符指针作为输入，该指针指向一个以 2 到 16 为基数的数字，并作为第二个参数，该数字所在的基数，然后将其转换为以 2 为基数的表示形式。整数可以是任意长度。我的解决方案现在执行 atoi() 函数的功能，但如果查找表解决方案是可能的，我纯粹出于学术兴趣而感到好奇。

我发现这对于二进制、八进制和十六进制都很简单。我可以简单地为每个数字使用查找表来获取一系列位。例如：

0xF1E ---> (F = 1111) (1 = 0001) (E = 1110) ---> 111100011110

0766 ---> (7 = 111) (6 = 110) (6 = 110) ---> 111110110

1000 ---> ??? ---> 1111101000

但是，我的问题是我想为奇数基数（例如基数 10）执行此查找表方法。我知道我可以像 atoi 那样编写算法并执行一堆乘法和加法，但是对于这个特定问题我我想看看我是否可以用查找表来做到这一点。不过，以 10 为底的情况肯定不是那么明显。我很好奇是否有人有任何聪明的方法来弄清楚如何为 Base X -> Base 2 生成通用查找表。我知道对于 base 10，你不能一次只给它一个数字，所以解决方案可能必须一次查找一组数字。

我知道乘法和加法解决方案，但由于这些是任意长度的数字，所以乘法和加法操作不是免费的，所以如果可能的话，我想避免它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T20:29:49.363

`m`您将不得不使用带有返回位的基本`b`符号输入宽度的查找表，`n`以便

```
n = log2(b) * m 
```

对于正整数`b`和。因此，如果不是 2 的幂，将没有（简单）查找表解决方案。`n``m``b`

我不认为有解决办法。以下以 10 为底的示例说明了原因。

```
65536 = 1 0000 0000 0000 0000 
```

将最后一位从 6 更改为 5 将翻转所有位。

```
65535 = 0 1111 1111 1111 1111 
```

如果您从头开始处理输入，则几乎相同。将第一个数字从 6 更改为 5 会翻转大量位。

```
55535 = 0 1101 1000 1111 0000 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-21T20:56:52.357

在不是 2 的幂的基础中，这是不可能转换为 base-2 的。基数为 8（和 16）的原因是转换的工作方式如下：

```
八进制 ABC = 8^2*A + 8^1*B + 8^0*C（十进制）
          = 0b10000000*A + 0b1000*B + C（二进制）

```

因此，如果您有 A = (0b000 到 0b111) 的查找表，则乘法始终是 1 和一些尾随零，因此乘法很简单（只是左移）。

但是，请考虑 10 的“奇数”底数。当您查看 10 的幂时：

```
10^1 = 0b1010
10^2 = 0b1100100
10^3 = 0b1111101000
10^4 = 0b10011100010000
..ETC

```

您会注意到乘法永远不会变得简单，因此无论您对它们进行多大的分组，都不能有任何查找表并进行位移和或运算。它总是会重叠。您可以做的最好的事情是有一个如下形式的查找表： (a,b) 其中 a 是数字位置，b 是数字 (0..9)。然后，您只需要添加 n 个数字，而不是乘以和添加 n 个数字（加上查找表的内存成本）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T20:27:51.257

该算法非常简单。语言不可知将是：

```
total = 0
base <- input_base
for each character in input:
   total <- total*base + number(char) 
```

在 C++ 中：

```
// Helper to convert a digit to a number
unsigned int number( char ch )
{
   if ( ch >= '0' && ch <= '9' ) return ch-'0';
   ch = toupper(ch);
   if ( ch >= 'A' && ch <= 'F' ) return 10 + (ch-'A');
}
unsigned int parse( std::string const & input, unsigned int base )
{
   unsigned int total = 0;
   for ( int i = 0; i < input.size(); ++i )
   {
      total = total*base + number(input[i]);
   }
   return total;
} 
```

当然，您应该注意可能出现的错误（不连贯的输入：base 2 和输入字符串 'af12'）或任何其他异常情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T20:45:48.297

弦有多大？您可以通过执行以下操作将乘法加法转换为查找加法：

*   将数字 0-9, 10, 20, 30, 40, ... 90, 100, 200, ... 900, 1000, 2000, ... , 9000, 10000, ... 存储在目标库中桌子。
*   对于从最右边开始的每个字符，适当地索引到表中并将其添加到运行结果中。

当然，我不确定这实际上会表现如何，但这是一个想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T20:30:28.627

*   从运行计数 0 开始。
*   对于字符串中的每个字符（从左到右阅读）
    *   将计数乘以基数。
    *   将字符转换为 int 值（0 到基数）
    *   将字符值添加到运行计数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T20:59:40.273

您需要准确到什么程度？

如果您正在寻找完美，那么乘加法确实是您唯一的选择。如果它是您应用程序中最慢的部分，我会感到非常惊讶。

如果数量级足够好，请使用查找表查找最接近的 2 次方。

示例 1：1234，最接近 2 的幂是 1024。示例 2：98765，最接近的是 65536

您也可以通过计算位数，并将 2 的适当幂乘以最左边的数字来驱动它。这可以实现为左移：

示例 3：98765 有 5 位，最接近 2 到 10000 的幂是 8192 (2^13)，所以结果是 9 << 13

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-21T21:11:29.730

> 我在你澄清评论之前写了这个，所以它可能不太适用。我不确定查找表方法是否可行。如果您真的不需要任意精度，请利用运行时。

如果 C/C++ 解决方案是可以接受的，我相信以下是您正在寻找的内容，类似于以下内容。它可能在极端情况下包含错误，但至少对于正数，它确实可以按预期编译和工作。让它真正发挥作用是读者的练习。

```
/*
 * NAME
 *    convert_num - convert a numerical string (str) of base (b) to
 *                  a printable binary representation
 * SYNOPSIS
 *    int convert_num(char const* s, int b, char** o)
 * DESCRIPTION
 *    Generates a printable binary representation of an input number
 *    from an arbitrary base.  The input number is passed as the ASCII
 *    character string `s'.  The input string consists of characters
 *    from the ASCII character set {'0'..'9','A'..('A'+b-10)} where
 *    letter characters may be in either upper or lower case.
 * RETURNS
 *    The number of characters from the input string `s' which were
 *    consumed by this operation.  The output string is placed into
 *    newly allocated storage which is pointed to by `*o' upon successful
 *    completion.  An error is signalled by returning `-1'.
 */
int
convert_num(char const *str, int b, char **out)
{
    int rc = -1;
    char *endp = NULL;
    char *outp = NULL;
    unsigned long num = strtoul(str, &endp, b);
    if (endp != str) { /* then we have some numbers */
        int numdig = -1;
        rc = (endp - str); /* we have this many base `b' digits! */
        frexp((double)num, &numdig); /* we need this many base 2 digits */
        if ((outp=malloc(numdig+1)) == NULL) {
            return -1;
        }
        *out = outp; /* return the buffer */
        outp += numdig; /* make sure it is NUL terminated */
        *outp-- = '\0';
        while (numdig-- != 0) { /* fill it in from LSb to MSb */
            *outp-- = ((num & 1) ? '1' : '0');
            num >>= 1;
        }
    }
    return rc;
} 
```

# c# - 实现 MS Access 风格的“关系”GUI

> ID：774450
> 
> 赞同：2
> 
> 时间：2009-04-21T20:28:27.650
> 
> 标签：c#, .net, visual-studio-2008, user-interface, gui-designer

我不知道这种 UI 样式的正确名称是什么。在 MS Access 中，“关系”工具将 db 表显示为可以与线条链接的小可移动框。Visio 和一些音频应用程序也是如此 - 可移动的框，包含可以以有意义的方式连接在一起的文本行。

如何使用 Visual Studio 2008 和 C# 在 .NET 中创建类似的东西？我以前从未创建过自己的控件。

这是我的意思的那种东西的图像：[点击例如](http://www.kexi-project.org/pics/0.1beta3/relation_beta3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T08:43:33.020

您将需要两个主要的自定义控件：**主视图**和**表格控件**。

**表格控件**负责绘制其所有列并确保项目可以在需要时滚动。它还负责为指定的行标题提供 x/y 坐标。这样关系线可以匹配到正确的行。

主**视图**负责接受表格对象列表（存储在自定义表格对象中），创建相同数量的表格控件并按指定顺序排列它们。它还负责在表格控件之间绘制线条。

总而言之，这不是微不足道的。您需要覆盖这两个控件的 OnPaint() 方法来完成所有这些自定义绘图。对 GDI+ 图形例程进行一些研究，找出可以使用哪些方法来绘制它。您可能最常使用这些对象/方法：

```
Pen
SolidBrush
LinearGradientBrush
DrawRectangle()
FillRectangle()
DrawString()
DrawImage()
DrawLine()
DrawPath() 
```

您还需要捕获各种鼠标事件以启用控件的移动。这可以通过重写方法来完成，例如`OnMouseDown`或`OnMouseMove`。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-27T14:39:18.127

您尝试绘制的图表是 ERD 或数据库设计。您可能还在寻找的是类图。

您正在尝试做的事情非常复杂。

以下是一些可能有帮助的链接。这些都是做图表的开源类型 UML 工具。

[http://imar.spaanjaars.com/501/automatically-generating-class-diagrams-from-a-type-using-reflection](http://imar.spaanjaars.com/501/automatically-generating-class-diagrams-from-a-type-using-reflection)

[http://www.codebydesign.com/](http://www.codebydesign.com/)

[http://sourceforge.net/projects/use-case-maker/](http://sourceforge.net/projects/use-case-maker/)

[http://projects.gnome.org/dia/](http://projects.gnome.org/dia/)

[http://www.monouml.org/doku.php?id=documentation](http://www.monouml.org/doku.php?id=documentation)

# objective-c - touchesMoved 和 drawRect 的问题

> ID：774453
> 
> 赞同：0
> 
> 时间：2009-04-21T20:29:04.387
> 
> 标签：objective-c, cocoa-touch, drawing, touch

我有一个我似乎无法弄清楚的棘手错误，我认为它与 touchesMoved 的实现方式有关。

在 touchesMoved 中，我检查触摸的位置（if 语句），然后相应地在触摸点附近的 40 x 40 区域调用 setNeedsDisplayWithRect。在 DrawRect 中发生的情况是，如果之前有一个白色图像，则会放下一个黑色图像，反之亦然。在调用 setNeedsDisplayWithRect 的同时，我在布尔数组中设置了一个布尔变量，这样我就可以跟踪当前图像是什么，从而显示相反的图像。（其实我并不总是翻转图像...我看第一次触摸会做什么，比如从黑色切换到白色，然后在所有后续触摸上放置白色图像，所以有点像绘图或与图像一起删除）。

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
{
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:self];
    CGPoint lastTouchPoint = [touch previousLocationInView:self];

    touchX = touchPoint.x;
    touchY = touchPoint.y;

    int lastX = (int)floor((lastTouchPoint.x+0.001)/40);
    int lastY = (int)floor((lastTouchPoint.y+0.001)/40);
    int currentX  = (int)(floor((touchPoint.x+0.001)/40));
    int currentY  = (int)(floor((touchPoint.y+0.001)/40));

    if  ((abs((currentX-lastX)) >=1) || (abs((currentY-lastY)) >=1))
    {
        if ([soundArray buttonStateForRow:currentX column:currentY] == firstTouchColor){
            [soundArray setButtonState:!firstTouchColor row:(int)(floor((touchPoint.x+0.001)/40)) column:(int)(floor((touchPoint.y+0.001)/40))];

            [self setNeedsDisplayInRect:(CGRectMake((CGFloat)(floor((touchPoint.x+0.001)/40)*40), (CGFloat)(floor((touchPoint.y+0.001)/40)*40), (CGFloat)40.0, (CGFloat)40.0))];
        }
    }
} 
```

我的问题是布尔数组似乎与我放下的图像格格不入。只有当我在屏幕上快速拖动时才会发生这种情况。最终布尔数组和图像不再同步，即使我同时设置它们。知道是什么原因造成的，或者我能做些什么来解决它？

这是我的drawRect：

```
- (void)drawRect:(CGRect)rect {

    if ([soundArray buttonStateForRow:(int)(floor((touchX+0.001)/40)) column:(int)(floor((touchY+0.001)/40))])
        [whiteImage drawAtPoint:(CGPointMake((CGFloat)(floor((touchX+0.001)/40)*40), (CGFloat)(floor((touchY+0.001)/40))*40))]; 
    else
        [blackImage drawAtPoint:(CGPointMake((CGFloat)(floor((touchX+0.001)/40)*40), (CGFloat)(floor((touchY+0.001)/40))*40))]; 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T20:12:47.057

我想出了这个问题的答案。touchX 和 touchY 是实例变量，在每次调用 drawRect 完成之前，它们在 touchesMoved 中被重置。因此，如果我在屏幕上快速移动，将调用 touchesMoved，然后调用 drawRect，然后在 drawRect 使用 touchX 和 touchY 之前再次调用 touchesMoved，因此绘图将与布尔数组后端不同步。

为了解决这个问题，我停止在 drawRect 中使用 touchX 和 touchY，并开始使用从 touchesMoved 传入的脏矩形来推导相同的点。

多田！

# c# - Linq 中的组合生成器

> ID：774457
> 
> 赞同：19
> 
> 时间：2009-04-21T20:30:21.937
> 
> 标签：c#, linq, combinations

是否可以创建一些生成包含一系列数字的所有可能组合的列表的 Linq？

如果您输入“21”，它将生成一个包含以下元素的列表：

```
list[0] = "21"
list[1] = "22"
list[2] = "11"
list[3] = "12" 
```

（不一定按这个顺序）

我了解您可以使用 range 执行以下操作：

```
List<char> letterRange = Enumerable.Range('a', 'z' - 'a' + 1).Select(i => (Char)i).ToList(); //97 - 122 + 1 = 26 letters/iterations 
```

从 az 生成字母表。但我似乎无法转移这些知识来制作组合生成器

我已经能够用下面的代码弄清楚它，但它看起来太笨重了，我相信它可以用几行来完成。我确实觉得这是一个糟糕的解决方案。

`GetAllCombinations("4321")`想象一下，如果有帮助，我已经打过电话

```
public static String[] GetAllCombinations(String s)
{
    var combinations = new string[PossibleCombinations(s.Length)];

    int n = PossibleCombinations(s.Length - 1);

    for (int i = 0; i < s.Length; i++)
    {
        String sub;
        String[] subs;

        if (i == 0)
        {
            sub = s.Substring(1); //Get the first number
        }
        else if (i == s.Length - 1)
        {
            sub = s.Substring(0, s.Length - 1);
        }
        else
        {
            sub = s.Substring(0, i) + s.Substring(i + 1); 
        }

        subs = GetAllCombinations(sub);

        for (int j = 0; j < subs.Length; j++)
        {
            combinations[i * n + j] = s[i] + subs[j];
        }
    }

    return combinations;
}
public static int PossibleCombinations(int n) //Combination possibilities. e.g 1-2-3-4 have 24 different combinations
{
    int result = 1;

    for (int i = 1; i <= n; i++)
        result *= i;

    return result;
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-21T21:10:09.767

对于它的价值，尝试这样的事情：

```
public static IEnumerable<string> GetPermutations(string s)
{
    if (s.Length > 1)
        return from ch in s
               from permutation in GetPermutations(s.Remove(s.IndexOf(ch), 1))
               select string.Format("{0}{1}", ch, permutation);

    else
        return new string[] { s };
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-10-13T06:59:58.683

作为记录：乔希的回答是通用的方式：

```
public static IEnumerable<IEnumerable<T>> GetPermutations<T>(IEnumerable<T> items) {
        if (items.Count() > 1) {
            return items.SelectMany(item => GetPermutations(items.Where(i => !i.Equals(item))),
                                   (item, permutation) => new[] { item }.Concat(permutation));
        } else {
            return new[] {items};
        }
    } 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-17T19:58:34.177

这是我使用 Linq 的排列和组合函数

```
public static IEnumerable<TSource> Prepend<TSource>(this IEnumerable<TSource> source, TSource item)
{
    if (source == null)
        throw new ArgumentNullException("source");

    yield return item;

    foreach (var element in source)
        yield return element;
}

public static IEnumerable<IEnumerable<TSource>> Permutate<TSource>(this IEnumerable<TSource> source)
{
    if (source == null)
        throw new ArgumentNullException("source");

    var list = source.ToList();

    if (list.Count > 1)
        return from s in list
                from p in Permutate(list.Take(list.IndexOf(s)).Concat(list.Skip(list.IndexOf(s) + 1)))
                select p.Prepend(s);

    return new[] { list };
}

public static IEnumerable<IEnumerable<TSource>> Combinate<TSource>(this IEnumerable<TSource> source, int k)
{
    if (source == null)
        throw new ArgumentNullException("source");

    var list = source.ToList();
    if (k > list.Count)
        throw new ArgumentOutOfRangeException("k");

    if (k == 0)
        yield return Enumerable.Empty<TSource>();

    foreach (var l in list)
        foreach (var c in Combinate(list.Skip(list.Count - k - 2), k - 1))
            yield return c.Prepend(l);
} 
```

对于 DNA 字母“A”、“C”、“G”、“T”：

```
var dna = new[] {'A', 'C', 'G', 'T'};

foreach (var p in dna.Permutate())
    Console.WriteLine(String.Concat(p)); 
```

给

```
ACGT ACTG AGCT AGTC ATCG ATGC CAGT CATG CGAT CGTA CTAG CTGA GACT GATC GCAT GCTA GTAC GTCA TACG TAGC TCAG TCGA TGAC TGCA 
```

和 DNA 字母表的组合 (k = 2)

```
foreach (var c in dna.Combinate(2))
        Console.WriteLine(String.Concat(c)); 
```

是

```
AA AC AG AT CA CC CG CT GA GC GG GT TA TC TG TT 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T20:34:25.000

您正在寻找的实际上是排列。简而言之，排列意味着顺序是相关的（即 12 与 21 不同），而组合意味着顺序不相关（12 和 21 是等价的）。有关更多信息，请参阅[维基百科。](http://en.wikipedia.org/wiki/Permutation)

看到[这个线程。](https://stackoverflow.com/questions/756223/can-you-write-a-permutation-function-just-as-elegantly-in-c)

至于做是在纯 LINQ 中，这听起来像是为了使用 LINQ 而使用 LINQ。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-08T22:54:16.337

正如其他人指出的那样，如果任何元素相同，则此页面上的解决方案将生成重复项。Distinct() 扩展将删除它们，但它的可扩展性不是很高，因为它通常会导致整个搜索树被遍历。您将通过在遍历期间调用它来显着修剪搜索空间：

```
private static IEnumerable<string> Permute(string str)
{
    if (str.Length == 0)
        yield return "";
    else foreach (var index in str.Distinct().Select(c => str.IndexOf(c)))
        foreach (var p in Permute(str.Remove(index, 1)))
            yield return str[index] + p;
} 
```

对于示例字符串“bananabana”，这将导致访问 8,294 个节点，而不是在不进行遍历剔除时访问的 9,864,101 个节点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-25T01:25:52.677

您可以使用这个 Permute LINQ 扩展：

```
foreach (var value in Enumerable.Range(1,3).Permute())
  Console.WriteLine(String.Join(",", value)); 
```

结果是：

```
1,1,1
1,1,2
1,1,3
1,2,1
1,2,2
1,2,3
1,3,1
1,3,2
1,3,3
2,1,1
2,1,2
2,1,3
2,2,1
2,2,2
2,2,3
2,3,1
... 
```

您可以选择指定排列的#

```
foreach (var value in Enumerable.Range(1,2).Permute(4))
  Console.WriteLine(String.Join(",", value)); 
```

结果：

```
1,1,1,1
1,1,1,2
1,1,2,1
1,1,2,2
1,2,1,1
1,2,1,2
1,2,2,1
1,2,2,2
2,1,1,1
2,1,1,2
2,1,2,1
2,1,2,2
2,2,1,1
2,2,1,2
2,2,2,1
2,2,2,2 
```

要添加的扩展类：

```
public static class IEnumerableExtensions
{
  public static IEnumerable<IEnumerable<T>> Permute<T>(this IEnumerable<T> values) => values.SelectMany(x => Permute(new[] { new[] { x } }, values, values.Count() - 1));
  public static IEnumerable<IEnumerable<T>> Permute<T>(this IEnumerable<T> values, int permutations) => values.SelectMany(x => Permute(new[] { new[] { x } }, values, permutations - 1));
  private static IEnumerable<IEnumerable<T>> Permute<T>(IEnumerable<IEnumerable<T>> current, IEnumerable<T> values, int count) => (count == 1) ? Permute(current, values) : Permute(Permute(current, values), values, --count);
  private static IEnumerable<IEnumerable<T>> Permute<T>(IEnumerable<IEnumerable<T>> current, IEnumerable<T> values) => current.SelectMany(x => values.Select(y => x.Concat(new[] { y })));
} 
```

# c++ - 未定义参考？有什么我没看到的吗？（c++，单例类）

> ID：774464
> 
> 赞同：0
> 
> 时间：2009-04-21T20:32:54.473
> 
> 标签：c++, reference, singleton, undefined

我似乎无法让这个未定义的引用消失。

[![（问题截图）](https://i.stack.imgur.com/I0HXh.png)](https://imgur.com/1qqDi.png)

我在 Scene.h 的私有部分下有这段代码：

```
static Scene * scene_; 
```

Scene.cpp 头文件的第一部分有一个#include "Scene.h"

这是我目前收到的唯一错误，有什么想法吗？

我会提供你想要的任何其他信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-21T20:37:03.887

当您声明一个静态成员时，您还必须在一个编译单元（并且只有一个）中定义它：

```
// a.h
class A
{
   static int x;
};

// a.cpp
int A::x = 0; 
```

类中变量的声明不会保留内存，只是告诉编译器（从其他编译单元）将有一个可以通过在某处定义的名称访问的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T22:54:23.213

为什么使用 a`Scene*`而不是 a `Scene`？您本质上是在说“`static`用于为指向 a 的指针分配足够的空间`Scene`”，然后在运行时将该`Scene`对象放在堆上`new`（并且，我假设，永远不会`delete`）。

相反，只需静态分配**并初始化**`Scene`对象：

```
static Scene scene_; 
```

然后相应地更改对场景的所有引用（-> 变为。）：

```
scene_.addObject(&object); 
```

这更容易并且需要更少的击键来启动。C++ 不需要`new`像 Java 或 C# 那样频繁。

# scheduled-tasks - 设置脚本按计划运行？

> ID：774469
> 
> 赞同：2
> 
> 时间：2009-04-21T20:34:20.397
> 
> 标签：scheduled-tasks

如何设置 PHP 脚本按计划运行？由于我使用的是托管公司，因此我无法完全控制服务器，但我有一个 PLESK 管理用于托管。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T20:37:58.453

我相信 PLESK在每个域下面都有一个**crontab区域。**

![](https://farm4.static.flickr.com/3545/3463845464_6696f65f68_o.png)

或者，如果你有 shell 访问权限，这里有一个很好[的从命令行编辑 crontab 的](http://www.adminschoice.com/docs/crontab.htm)教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:43:11.233

crontab。视频教程在这里：

[http://www.webhostingresourcekit.com/flash/plesk-8-linux/plesk8linux_crontab.html](http://www.webhostingresourcekit.com/flash/plesk-8-linux/plesk8linux_crontab.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T20:51:34.990

您要查找的内容称为 cron 作业：可以在您的服务器上执行 http 请求的自动化任务。

由于您是托管的，因此无法手动设置要运行的 cron 作业。但是，许多网络主机提供在线工具，用于通过其控制面板（cpanel、plesk 等）创建 cron 作业。

如果这不是一个选项，那么如果您花费足够长的时间，您可能会找到一些付费和一些免费的 cron 服务。

# c++ - 如何在自动启动中隐藏 MFC 启动画面？

> ID：774474
> 
> 赞同：0
> 
> 时间：2009-04-21T20:35:12.643
> 
> 标签：c++, mfc, splash-screen

我有一个没有主窗口的 MFC 应用程序。当用户启动它时，它会显示启动画面 1~2 秒，然后启动画面淡出到系统托盘。用户通过单击托盘中的图标开始访问菜单。

该应用程序还可以在用户登录 Windows 时自动启动（在启动文件夹中添加条目）。重复上述相同过程。我认为启动画面在自动启动期间有点麻烦。我喜欢在自动启动时隐藏启动画面，但如果用户手动运行应用程序，则保持显示启动画面。我想知道最好的方法是什么？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T20:50:33.650

一种简单的方法是在 Startup 文件夹中设置应用程序的快捷方式，在命令行上指定一个参数，例如，如果您的应用程序**`myapp.exe`**在您可以键入的快捷方式属性中调用**`<path to myapp>\myapp.exe -nosplash`**。

然后修改您的应用程序代码以检查命令行参数，可能使用
[GetCommandLine](http://msdn.microsoft.com/en-us/library/ms683156(VS.85).aspx "获取命令行")以查看是否**`-nosplash`**已通过，然后不显示启动屏幕。显然，如果用户只是通过双击应用程序本身来启动它，则**`-nosplash`**它不会出现并且它会正常显示启动屏幕。

# sqlite - SQLite 支持哪些连接？

> ID：774475
> 
> 赞同：36
> 
> 时间：2009-04-21T20:35:31.987
> 
> 标签：sqlite, join

根据[join-op 语法](http://sqlite.org/syntaxdiagrams.html#join-op)，SQLite 有 13 个不同的连接语句：

```
,
JOIN
LEFT JOIN
OUTER JOIN
LEFT OUTER JOIN
INNER JOIN
CROSS JOIN
NATURAL JOIN
NATURAL LEFT JOIN
NATURAL OUTER JOIN
NATURAL LEFT OUTER JOIN
NATURAL INNER JOIN
NATURAL CROSS JOIN 
```

它们都是独一无二的吗？哪些是等价的？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-04-21T20:36:53.403

[SQLite 语法与 SQL-92 规范](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)有点不同，根据后者，以下是非法的：

```
*OUTER JOIN
*NATURAL OUTER JOIN
*NATURAL CROSS JOIN 
```

前两个，因为 a `<join type>`，为了包含`OUTER`，还必须`<outer join type>`在它之前包含 a 。最后一个，因为`NATURAL`只能出现在`<qualified join>`'s，而不是`<cross join>`'s。这些似乎不符合任何规范，因此最好避免使用它们。

正如[邮件列表中的](http://sqlite.org:8080/cgi-bin/mailman/private/sqlite-users/2009-April/011007.html)回答，SQLite3 仅支持三种连接：`CROSS JOIN`、`INNER JOIN`和`LEFT OUTER JOIN`。以下是等价的：

```
, == CROSS JOIN
JOIN == INNER JOIN
LEFT JOIN == LEFT OUTER JOIN 
```

正如[维基百科文章中解释的](http://en.wikipedia.org/wiki/Join_(SQL)#Natural_join)那样， NATURAL 关键字是在同名列上查找和匹配的简写，并且不影响连接类型。

根据[SQLite 页面](http://sqlite.org/omitted.html)，不支持' `RIGHT`' 和 ' `FULL`'  。`OUTER JOIN`

# html - Flash (as3) 打印 .. 数据 ? html?

> ID：774480
> 
> 赞同：1
> 
> 时间：2009-04-21T20:36:12.607
> 
> 标签：html, flash, actionscript-3, printing

我需要在我的页面上添加一个打印按钮，该按钮应该打印某个页面

最好的方法应该是我添加一个 html 并且它会从 flash 中打印或者是否可以打开一个 html 页面并自动打开打印对话框？

它在 AS3 中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T22:31:35.437

您可以在 TextField 中打开简单的 html（并非每个 html 标签都受支持），而且使用 css 可能会有点棘手。

如果你把它整理出来，AS3 支持直接从闪存打印。您可以在此处找到更多内容：http: [//livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/printing/PrintJob.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/printing/PrintJob.html)

但我认为最简单的方法是从 Flash 调用 javascript（使用 ExternalInterface），并让 javascript 请求用户打印它。GMail 做了一些类似的事情，没有闪光灯的想法。

# linux - 更改文件中的行

> ID：774481
> 
> 赞同：0
> 
> 时间：2009-04-21T20:36:27.443
> 
> 标签：linux, text, file, replace

我想（例如）用另一个文件中第 6-15 行的文本替换文件中第 5-15 行的文本。但我想对大约 2000 个文件执行此操作，而不必手动执行此操作。

我可以在 perl 中编写一些脚本，但我想尝试使用任何可能的内置函数来完成它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T20:59:10.667

```
for files in PATTERN ; do
  sed -n '1,14p' $files > newfile.$files
  sed -n '6,15p' ANOTHERFILE >> newfile.$files
  sed -n '15,$p' $files >> newfile.$files
done 
```

注意：它不是资源高效的，但我在一个非常强大的服务器上编写它;-) 还有其他几种方法可以做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T19:36:39.827

我可能会使用 sed

```
for file in bar baz bam; do
    newfile=$(mktemp)
    (sed '5q' $file; sed -n '6,15p' foo; sed '1,15d' $file) > $newfile
    mv -f $newfile $file
done 
```

或 Perl

```
#!/usr/bin/env perl

use v5.6;  # lexical filehandles need Perl >= 5.6

# usage: $0 foo bar baz bam
# replaces lines 4-15 of qw(bar baz bam) with lines 6-15 of foo 

my @ins;

{
    open my $fh, shift;
    while (<$fh>) {
        push @ins, $_ if 6 .. 15;
        last if $. >= 15;
    }
}

$^I = '';

while (<>) {
    print if not 5 .. 15;
    print @ins if $. == 4;
}
continue {
    close ARGV if eof ARGV;
} 
```

但`ed`也有效。

```
echo '6,15wq foo-part' | ed foo
for i in bar baz bam; do
    echo -e '5,15d\n4r foo-part\nwq' | ed $i
done
rm -f foo-part 
```

# dns - 基于客户端 IP 的 DNS 解析

> ID：774490
> 
> 赞同：3
> 
> 时间：2009-04-21T20:38:52.337
> 
> 标签：dns, bind, hosts-file

我想配置基于客户端 IP 地址解析 DNS 请求的绑定/写入驱动程序。

我们希望为我们的 Web 应用程序统一所有测试环境的域名。我们不想为不同的暂存环境拥有许多域，如`test.mysite.com`,`qa.mysite.com`等，我们只想拥有`www.mysite.com`并使其可配置它“指向”的测试环境。

为此，我正在考虑提供 Web 界面来配置必须使用的测试环境。DNS 请求应根据此配置得到答复。

你认为这样的事情对 bind 或其他 dns 服务器是可行的吗？它与编写修改本地主机文件的客户端应用程序相比如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T20:56:59.437

您可以将[PowerDNS](http://www.powerdns.com)与[管道后端](http://downloads.powerdns.com/documentation/html/backends-detail.html#PIPEBACKEND-PROTOCOL)一起使用，以根据客户端的 IP 地址返回不同的 IP 地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T20:44:18.063

您可以使用[djbdns中的](http://cr.yp.to/djbdns.html)[定位](http://cr.yp.to/djbdns/tinydns-data.html)工具来执行此操作。您制作 Web 界面的任务是以正确的格式写出（并解析，如果您不想拥有单独的数据库后端）DNS 数据文件。

这是有关相关主题的另一个资源，“水平分割 DNS”。和你的问题不一样，但是文章中的想法可以根据你的需要进行调整：http: [//jdebp.eu./FGA/dns-split-horizo​​n.html](http://jdebp.eu./FGA/dns-split-horizon.html)

# c# - 有哪些匿名类型有用的例子？

> ID：774491
> 
> 赞同：8
> 
> 时间：2009-04-21T20:38:59.030
> 
> 标签：c#, .net, anonymous-types

我已经阅读了一些关于如何在 C# 中创建匿名类型的文章。

这些东西有哪些用例？对我来说，似乎它可能会让事情变得更难理解声明对象及其内联成员。

什么时候使用匿名类型有意义？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T20:46:50.273

当我需要绑定到不完全符合我需要的集合时，我喜欢使用匿名类型。例如，这是我的应用程序中的一个示例：

```
 var payments = from terms in contract.PaymentSchedule
                   select new
                   {
                       Description = terms.Description,
                       Term = terms.Term,
                       Total = terms.CalculatePaymentAmount(_total),
                       Type=terms.GetType().Name
                   }; 
```

在这里，我将一个数据网格绑定到 payment.ToList()。这里的事情是我可以聚合多个对象而无需定义中介。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T20:44:39.453

在将数据绑定到复杂控件（如网格）时，我经常使用它们。它为我提供了一种简单的方法来格式化我发送到控件的数据，以使控件更容易处理该数据的显示。

GridView1.DataSource = myData.Select(x => new {Name=x.Description, Date = x.Date.ToShortDate() });

但是，稍后，在代码稳定后，我会将匿名类转换为命名类。

我也有需要使用非关系数据加载它们的案例（Reporting Services），而 Reporting Services 要求数据是 FLAT！我使用 LINQ/Lambda 为我轻松地展平数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T20:50:38.003

LINQ/Lambda 的

```
 var quantity = ...
 var query = db.Model.Select( m => new
                                  {
                                    Name = m.Name,
                                    Price = m.Price,
                                    Cost = M.Price * quantity
                                  } );
 foreach (var q in query)
 {
     Console.WriteLine( q.Name );
     Console.WriteLine( q.Price );
     Console.WriteLine( q.Cost );
 } 
```

ASP.NET MVC -HtmlHelpers 或返回 JSON 时

```
<%= Html.TextBox( "Name", Model.Name, new { @class = "required" } ) %>

public ActionResult SearchModels( var q, int limit )
{
     var query = db.Models.Where( m => m.Name.StartsWith( q ) )
                          .Take( limit )
                          .Select( m => new { m.DisplayName, m.Name, m.ID } );

     return Json( query.ToList() );
} 
```

实际上，几乎任何地方都只需要一个临时容器类型来执行短期操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T20:52:53.317

从马（微软）的[嘴里](http://msdn.microsoft.com/en-us/library/bb397696.aspx)说：

> 匿名类型提供了一种方便的方法，可以将一组只读属性封装到单个对象中，而无需首先显式定义类型。

匿名类型在您通常会使用已定义结构但不想使用的领域很有用，因为它只会在有限的范围内使用。我倾向于将它们用作数据源或聚合（总和、计数等）值的容器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T20:48:27.243

我发现它们是简单结构/结构对象的非常有用的替代品，尤其是在使用 VB.NET 时，因为它不支持自动实现的属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T20:47:02.707

它们在使用[LINQ时很有用](http://www.davidhayden.com/blog/dave/archive/2006/12/06/AnonymousTypesCSharp.aspx)

```
var query = from c in listOfCustomers
            select new {FirstName = c.Name,c.City}; 
```

看看这个[LINQ 简介](http://dotnetslackers.com/articles/csharp/IntroducingLINQ1.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-21T20:47:43.797

[这](http://blogs.msdn.com/charlie/archive/2007/09/26/choosing-not-to-use-anonymous-types-in-query-expressions.aspx)是 Charlie Calvert 关于匿名类型使用的一篇很好的博客文章。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-21T20:50:45.757

就个人而言，我发现匿名类型没有多大用处。至少要谨慎使用它们。通常使用它们的情况是在创建返回多个值的 LINQ 查询时，您只需在函数执行期间使用查询的数据。（如果需要在外部使用数据，则不能使用匿名类型 - 您需要声明自己的类型，这是有充分理由的，即可读性。）更一般地说，它们有时在使用普通 lambda 表达式时很有用，不过我自己也很少需要它们。（当我说需要时，根据上下文几乎有替代方案，但*有时*匿名类型实际上是最优雅的选择。）如果您想要一个代码示例，请告诉我，我会尝试提供一个相当不错的应用程序。

# asp.net - 如何创建自动建议以像谷歌搜索或实时搜索一样快速获取关键字

> ID：774492
> 
> 赞同：4
> 
> 时间：2009-04-21T20:39:16.250
> 
> 标签：asp.net, javascript, autocomplete

我正在我的网站搜索框中创建自动建议功能，每次用户按下新键时，javascript 都会在服务器端调用 web 服务以从数据库中获取 10 个最相关的关键字并再次提供给 javascript，然后 javascript 填充搜索自动推荐列表。

我的功能并不算太慢，但与 live.com 或 google.com 的速度相比，我对它们进行了测试，我真的觉得他们是从我的电脑而不是从他们的服务器获取关键字。

他们如何像这样快速获得关键字，并确保他们拥有数百万倍于我的关键字？
有一个著名的风格是这样做的吗？
同样使用我的萤火虫，我发现他们没有调用网络服务“可能以我不知道的方式调用”，但我在“网络”选项卡中发现正在发生新的获取。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T20:55:37.617

不知道你在看哪里，但肯定在 live.com 上我收到了每封信的请求：

[![Firbug Net 控制台 - 自动完成](https://i.stack.imgur.com/wxooV.png)](https://i.stack.imgur.com/wxooV.png)

正如您所看到的，通过网络返回的数据很少 - 500B - 这就是您的目标 - 一个精益 Web 服务，它返回您需要向用户显示的最小值。

然后最重要的是，正如其他人所说，缓存以前的响应等。

并不是说结果通常不是按字母顺序排列的，因此如果您不显示您的排序标准，您可以按照“现在总比以后完全准确”的原则工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-21T21:05:10.590

与其在每次按键时都发出请求，不如在中间有按键的情况下每隔一定时间发出一个请求会怎样？如果您执行类似 100 毫秒间隔的操作，它看起来仍然是“即时的”，但您的服务器上的负载可能会少得多。另外，您是否让客户端缓存关键字？如果用户在搜索字段中退格，则不必重新联系服务器来获取关键字。此外，您可以立即过滤每个按键上的当前关键字列表，而无需联系服务器（您最终会得到少于 10 个关键字，因为您已经拥有的部分/全部不包含刚刚输入的字母）。这可以填补实际数据请求之间的“空白”，使其看起来更即时。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-21T21:13:40.473

没有理由在每次按键时都请求搜索词。谷歌这样做（1）因为他们可以，（2）因为他们在互联网的语料库中呈现术语。

在大多数 Web 应用程序中，“常用”搜索词的数量要少得多——通常不超过一百个左右，而与上下文相关的只有十几个。

您可以在页面加载时检索整个相关术语集并在客户端构建前缀映射。通过将当前搜索词与此前缀映射匹配，您可以比 Google 更快地提供建议。

限制是，在某些时候，您会用完建议的术语。但同样，这真的不是问题：即使是谷歌也没有关于“transnormative”（一个虚构的词，但完整搜索有 191 个结果）的建议。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T08:54:43.350

您可以做两件主要的事情：

1.  在服务器端使用尽可能多的缓存。毕竟，搜索查询遵循幂律。有很多请求的查询很少，每个请求很少的很多查询。完美的缓存环境
2.  您需要尽量减少传输的数据量，一种方法是使用[基数树](http://en.wikipedia.org/wiki/PATRICIA)。如果您需要传输一个包含 20 个字符串的列表，所有这些字符串都共享一个公共前缀，那么您不需要传输 20 个单独的字符串。您可以传输前缀一次，然后传输 20 个不同的部分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-21T20:45:54.613

我建议的第一件事是确保您的 Web 服务将它们的关键字缓存在内存中，而不是每次都访问数据库 - 当然假设您的数据集足够小来执行此操作。

除此之外，您必须以某种方式跨多个服务器并行化查询，这可能比您想要的要复杂得多。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-19T11:22:02.757

找到这篇博客文章，在这一点上详细讨论：

[自动完成数据结构](http://stevedaskam.wordpress.com/2009/05/17/autocomplete-data-structures/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-21T20:47:55.747

首先，您可能应该重新表述您的问题。任何关于“我怎么能像谷歌一样快”的答案都必然是“习惯失望”。

鉴于此，您仍然可以使您的解决方案更好。似乎每次按键，您都会往返于服务和数据库。我怀疑谷歌会这样做。也许您应该专注于减少往返次数（cahcing，当您必须去数据库时带回更多，等等）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-21T21:25:59.040

正如上面有人建议的那样，将 ETags 与 REST api 一起使用可能意味着对重复查询进行一些额外的缓存。查看Jeo Gregorio 博客上的[这篇](http://bitworking.org/news/150/REST-Tip-Deep-etags-give-you-more-benefits)文章，了解 REST 上下文中的更多信息 etags。

# graphics - Google O3D 可以用作富互联网应用程序框架吗？

> ID：774493
> 
> 赞同：1
> 
> 时间：2009-04-21T20:39:21.430
> 
> 标签：graphics, 3d, browser, rich-internet-application

虽然它被固定为浏览器的 3D 图形框架，但[Google O3D](http://code.google.com/apis/o3d/)是否可以用作类似于 GWT、Flex 或 Rails 的 RIA 框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T20:40:49.243

简短的回答：

是的。

长答案：

它更有可能只用于浏览器内的游戏。在 3d 框架之上构建一个体面的 RIA 框架需要做很多工作，而且这样的框架（如果它曾经发布的话）不太可能对开发人员非常友好。

如果您想要一个好的 RIA 框架，请查看[Silverlight](http://silverlight.net/)或[Flex](http://www.adobe.com/products/flex/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T20:34:06.603

可以，但是没有可以在 O3D 窗口上绘制的用户界面小部件。这是一个经典的游戏开发问题——让常见的 UI 库在硬件加速的 3d 窗口之上实际正确渲染是非常复杂的。如果您想在世界空间中渲染附加到具有正确排序的对象的窗口，则更是如此。通常，游戏使用自定义 UI 引擎。

O3D 确实具有用于 2d 绘图的高性能 Canvas，并且很有可能用 JS 编写一个可以在该画布上绘图的 UI 库。但是……那就像用 JS 重写 Flex 一样。

这样做的好处是 2d 和 3d 内容之间的紧密集成 - 以及在 UI 层中拥有复杂 UI 的能力，并通过渲染到纹理技术附加到 3d 场景中的对象。

# css - Div 宽度问题

> ID：774497
> 
> 赞同：0
> 
> 时间：2009-04-21T20:40:57.450
> 
> 标签：css, html, styling

当有水平滚动条时，是什么阻止 div 水平延伸超过屏幕边缘？

DIV 的内容会溢出到左侧，但不会溢出到 DIV 本身。

什么可以让 div 一直向右移动？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T23:36:49.600

要使 div 扩展到视图窗格之外，您需要它具有宽度。如果它没有宽度，那么它需要它的容器的宽度。当内容大于它的容器（div 或 body 等）时，它的行为根据溢出，默认为可见。

选项是：

```
overflow: visible;
overflow: hidden;
overflow: auto;
overflow: scroll; 
```

[http://www.w3schools.com/Css/pr_pos_overflow.asp](http://www.w3schools.com/Css/pr_pos_overflow.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:45:13.430

我不确定我是否完全理解您的问题，但我会查看 CSS 溢出声明： [http ://www.quirksmode.org/css/overflow.html](http://www.quirksmode.org/css/overflow.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T20:56:48.800

看看添加 clearfix 类是否可以解决您的问题，这里有一些信息：

[http://www.webtoolkit.info/css-clearfix.html](http://www.webtoolkit.info/css-clearfix.html)

# nhibernate - NHibernate 将 0 保存到多对一列而不是 null

> ID：774498
> 
> 赞同：3
> 
> 时间：2009-04-21T20:41:03.313
> 
> 标签：nhibernate

我有一个表 Donations，其中有一个与 Campaigns 表相关的 CampaignID 列。如果活动不用于此捐赠，我需要在 CampaignID 列中插入 0 而不是 Null。

我的捐赠表中的映射如下所示：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true">
    <class name="Donation,Entities" lazy="true" table="Donations" dynamic-update="true" >
        <id name="DonationID" column="PledgeID" type="Int64">
            <generator class="native" />
        </id>
        <many-to-one name="FundraisingCampaign" class="Campaign, Entities" column="CampaignID" lazy="proxy" not-found="ignore" cascade="none" /> 
```

在我保存到数据库之前，我会检查我的捐赠实体上的活动实体是否为空。如果是这样，那么我将它设置为一个新的活动实体并像这样设置 CampaignID = 0。

```
 if (null == donation.FundraisingCampaign)
    {
        donation.FundraisingCampaign = new Campaign() {CampaignID = 0};
    } 
```

问题是我得到一个错误消息“对象引用了一个未保存的瞬态实例 - 在刷新之前保存瞬态实例。” 尝试保存时。

我不明白为什么它关心我的 Campaign 对象上的任何内容，而不是 CampaignID，因为我有 cascade="none" 它不应该尝试将任何内容保存到 Campaign 表中。

当前系统迫使我在那里设置 0 而不是 Null ，因此保存 Null 不是一种选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T21:00:25.560

尝试从数据库中加载数据库标识为 0 的 Campaign 对象。然后它将是一个完全持久的对象。然后，您应该能够设置它并坚持捐赠。

如果可行，您需要更改 Campaign 对象的 ID 属性映射。Nh 无法确定您在此处创建的临时活动对象：

```
new Campaign() {CampaignID = 0}; 
```

实际上是一个分离的对象。您应该做的是在您的映射中添加一个“未保存的值”，例如 -1。现在 Nh 可以区分 DB 身份 ID 为 0 的有效分离活动和 ID 为 -1 的临时新活动。然后记得将新创建的广告系列的 ID 设置为 -1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T21:11:03.383

1.  NHibernate 通过检查主键来知道一个实体是否已经被存储。如果为 0，则不存储。您可以在映射中更改此行为。
2.  如果您尝试保存实体，则所有引用实体必须级联或已存储。这对于 NHibernate 获取外键很重要。它不能用外键指向你的内存，它必须在数据库中，所以它必须被存储。如果不是这种情况，您会收到异常消息。

有了这些信息，您应该了解您遇到问题的原因。

CampaignID 是否使用自动计数器生成？然后它无论如何都不起作用。（您不能在应用程序中设置 id。）除非您使用 CampaignID = 0 存储 Campaign（见下文）。

您可以将 CampaignID 设为可为 null 的 int，则未保存的值默认为 null。

请注意，您在数据库中获得了一个 CampaignID=0 的营销活动。这是一个“空对象”。您需要存储它，例如在设置数据库之后。

如果你想避免空对象，你会遇到麻烦。NHibernate 在概念上不允许您访问外键，它会为您管理它。您可能可以做一些技巧（例如在拦截器中），但我认为这不值得麻烦。您还必须确保没有外键约束，这也不好。

# php - Python 脚本化 mp3 数据库，带有 php 前端

> ID：774502
> 
> 赞同：2
> 
> 时间：2009-04-21T20:44:08.050
> 
> 标签：php, python, database, mp3, id3

所以，这就是交易。我正在尝试编写一个快速的 python 脚本，它从 mp3（艺术家、专辑、歌曲名、流派等）中读取基本的 id3 标签。python 脚本很可能会使用诱变剂库（除非您知道更好的库）。我不确定如何递归扫描目录以获取每个 mp3 的标签，然后填充数据库。另外，就数据库而言，我想让它尽可能坚固，所以我想知道是否有人对我应该如何设计数据库本身有任何想法。我应该只使用一张大表吗，我应该使用某些关系等等。我不太擅长关系数据库，所以我会很感激任何帮助。哦，这是在linux机器上运行的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T20:53:35.360

要开始在 Python 中提取 ID3 标签，有一个模块。

```
from ID3 import ID3

mp3_filepath = r'/music/song.mp3'
id3_data = ID3(mp3_filepath)
print 'Artist:', id3_data['ARTIST']
print 'Title:', id3_data['TITLE'] 
```

[有关 ID3 模块的更多信息。](http://id3-py.sourceforge.net/)

如果您想递归搜索目录中的 mp3 文件，内置`os`模块可以做到这一点：

```
import os

def mp3_files(root):
  # this is a generator that will return mp3 file paths within given dir
  for f in os.listdir(root):
      fullpath = os.path.join(root,f)
      if os.path.isdir(fullpath) and not os.path.islink(fullpath):
          for x in mp3_files(fullpath):  # recurse into subdir
              yield x
      else:
          if fullpath[len(fullpath)-3:] == 'mp3':
            yield fullpath

for p in mp3_files(root_dir):
  id3_data = ID3(p)
  print 'Artist:', id3_data['ARTIST']
  print 'Title:', id3_data['TITLE'] 
```

[参考。](http://code.activestate.com/recipes/105873/)

在创建数据库方面，您不需要重新发明轮子（存储音乐数据是一个常见的数据库问题）——谷歌搜索将帮助您。 [这是一个例子](http://webforumz.com/databases/4711-music-database-design-help.htm)。

# sharepoint - 下拉列表中的空白选项从自定义 Sharepoint 列表中消失

> ID：774509
> 
> 赞同：4
> 
> 时间：2009-04-21T20:45:53.130
> 
> 标签：sharepoint, sharepoint-2007

我有一个部署为 .wsp 的自定义列表模板。该列表有近 30 列，包括几个列类型为“Choice”的 DropDownList。所有列都不是必需的，客户希望将空白选项作为每个列的默认选择。不幸的是，一旦保存了列表项，任何已选择值的列都不能再取消选择。

为了解决这个问题，我们在 schema.xml 和 event.xml 文件中添加了一个空白的 <CHOICE> </CHOICE> 元素。

不幸的是，其中一列完全忽略了空白选项 - 行为与我上面描述的相同（SP 默认行为）。我已经检查了（对我而言）显而易见的事情 - 确保 guid 匹配，两个文件中都存在空白选项等。

关于我可以解决的问题的任何其他想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-04-15T12:53:33.027

我想在经历了很多挫折和反复试验之后，我解决了这个长期存在的问题。每个人似乎都认为这在设计上是不可能的，但实际上很简单。

列选择中的空格似乎已被 SharePoint 擦除，但我在 ASCII 表中发现了一个空白字符，该字符不会被 SharePoint 引擎擦除。

这是 ASCII 字符 0x81 或 0129。

非空白空间（0160）似乎也被刷了

要创建空白字符，请按住“Alt”键并在数字键盘上键入“0129”。

替代选项：我使用 PSPAD 编辑器创建了单个字符 129，并将其复制并粘贴到我的一个选择类型列中，然后：在列选择器中出现了一个空白选择。我怀疑它也适用于您的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T20:44:02.567

只要它们的默认设置为空，还有另一个选项。选择了选项并且他们希望将其作为空值的字段，只需进入库或列表，操作，在数据表中编辑。然后只需手动删除您想要空值的字段，您将被设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T21:48:27.770

没有办法解决这种行为。您要么必须创建自己的自定义字段以允许此行为，要么添加一个默认值为“[blank]”的选项（并将该字段设为必填）。

在这两种情况下都不是很理想。

# javascript - 在表单提交后保留动画 GIF

> ID：774515
> 
> 赞同：1
> 
> 时间：2009-04-21T20:47:27.543
> 
> 标签：javascript, html

以下适用于 ie6,ie7,chrome 但不适用于 ff3

```
document.getElementById("form-name").submit();
var image = document.getElementById("loader-img");
setTimeout(function() { image.src = image.src; },50); 
```

我能做些什么来提高一致性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T21:01:59.287

您应该异步发布帖子，否则 UI 可能会挂起。查看[jQuery 表单插件](http://malsup.com/jquery/form/)以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:52:34.580

尝试将 src 设置为空白，然后重新设置图像。第二个更改也可能需要稍后调用（settimeout）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T05:25:32.307

您是否尝试过删除图像节点并替换它？就像是：

```
var image = document.getElementById("loader-img");
image.parentNode.removeChild(image);
image.parentNode.appendChild(image); 
```

（您可能还需要`image.cloneNode(true)`在 remove 和 append 调用之间进行。）

显然，您的 HTML 需要结构化，以免弄乱显示。

但是，knut 所说的适用（发布到隐藏的 IFRAME 或使用 XHR 会给你更多的控制权）。而且我不确定您所说的“这不是表单提交，而是 document.location='url' 调用”是什么意思，因此，如果您阐明用例和工作流程，我可能会提供更多帮助。

# ruby - 应用中真正奇怪的方法

> ID：774521
> 
> 赞同：4
> 
> 时间：2009-04-21T20:47:59.257
> 
> 标签：ruby

我刚刚在一些 Ruby 代码中遇到了一个奇怪的方法，我想知道我是否遗漏了一些基本的东西。它看起来像这样：

```
def funny
  !funny
end 
```

这可能会返回什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T20:49:46.460

这将递归运行，直到你得到堆栈溢出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-21T20:49:14.683

它会递归，直到你得到一个堆栈溢出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T20:52:04.537

这是一种标记为有趣的方法，然后包含 !funny 或字面意思是“不有趣”。

它递归直到堆栈溢出。

# c# - 在 C# 中将 IPv6 格式化为 int 并将其存储在 SQL Server 中

> ID：774536
> 
> 赞同：21
> 
> 时间：2009-04-21T20:51:29.467
> 
> 标签：c#, sql-server, algorithm, ipv6

在`IPv4`我一直在解析 IP 地址的字符串表示形式`Int32`并将它们存储`INT`为`SQL Server`.

现在，`IPv6`我试图找出是否有标准或可接受的方法来解析字符串表示`IPv6`为两个`Int64`使用`C#`？

另外，人们如何将这些值存储在`SQL Server`- as 的两个字段中`BIGINT`？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-21T21:44:38.467

正如 IPv4 地址实际上是一个 32 位数字一样，IPv6 地址实际上是一个 128 位数字。地址有不同的字符串表示，但实际地址是数字，而不是字符串。

因此，您无需将 IP 地址转换为数字，而是将地址的字符串表示形式解析为实际地址。

甚至 a`decimal`都不能容纳 128 位数字，因此留下了三个明显的替代方案：

*   存储分成两个`bigint`字段的数值
*   将地址的字符串表示形式存储在`varchar`字段中
*   将数值存储在 16 字节`binary`字段中

两者都不像将 IPv4 地址存储在`int`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-22T09:48:00.880

最简单的方法是让框架为您执行此操作。用于[`IPAddress.Parse`](http://msdn.microsoft.com/library/system.net.ipaddress.parse)解析地址，然后[`IPAddress.GetAddressBytes`](http://msdn.microsoft.com/library/system.net.ipaddress.getaddressbytes)将“数字”作为字节[]获取。

最后，将数组分成第一个和第二个 8 字节，以转换为两个 Int64，例如通过`MemoryStream`在字节数组上创建 a 然后通过 a 读取`BinaryReader`。

这避免了需要了解 IPv6 地址的所有可用快捷方式表示。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-23T23:56:42.220

如果您使用的是 SQL Server 2005，则可以使用该`uniqueidentifier`类型。此类型存储 16 个字节，非常适合 IPv6 ip 地址。您可以使用构造函数在`IPAddress`和之间进行转换 和。`Guid``ToByteArray`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-29T21:19:39.777

我使用以下方法将 IP 地址转换为两个`UInt64`s (C# 3.0)。

```
/// <summary>
/// Converts an IP address to its UInt64[2] equivalent.
/// For an IPv4 address, the first element will be 0,
/// and the second will be a UInt32 representation of the four bytes.
/// For an IPv6 address, the first element will be a UInt64
/// representation of the first eight bytes, and the second will be the
/// last eight bytes.
/// </summary>
/// <param name="ipAddress">The IP address to convert.</param>
/// <returns></returns>
private static ulong[] ConvertIPAddressToUInt64Array(string ipAddress)
{
    byte[] addrBytes = System.Net.IPAddress.Parse(ipAddress).GetAddressBytes();
    if (System.BitConverter.IsLittleEndian)
    {
        //little-endian machines store multi-byte integers with the
        //least significant byte first. this is a problem, as integer
        //values are sent over the network in big-endian mode. reversing
        //the order of the bytes is a quick way to get the BitConverter
        //methods to convert the byte arrays in big-endian mode.
        System.Collections.Generic.List<byte> byteList = new System.Collections.Generic.List<byte>(addrBytes);
        byteList.Reverse();
        addrBytes = byteList.ToArray();
    }
    ulong[] addrWords = new ulong[2];
    if (addrBytes.Length > 8)
    {
        addrWords[0] = System.BitConverter.ToUInt64(addrBytes, 8);
        addrWords[1] = System.BitConverter.ToUInt64(addrBytes, 0);
    }
    else
    {
        addrWords[0] = 0;
        addrWords[1] = System.BitConverter.ToUInt32(addrBytes, 0);
    }
    return addrWords;
} 
```

确保在将它们放入数据库之前将`UInt64`s 转换为s，否则您将得到一个. 当您恢复您的值时，您可以将它们转换回以获取无符号值。`Int64``ArgumentException``UInt64`

我不需要做相反的事情（即将 a 转换`UInt64[2]`为 IP 字符串），所以我从来没有为它构建方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-04T14:59:22.133

```
function encode_ip ($ip)
{
    return bin2hex(inet_pton($ip));
}

function decode_ip($ip)
{
    function hex2bin($temp) {
       $data="";
       for ($i=0; $i < strlen($temp); $i+=2) $data.=chr(hexdec(substr($temp,$i,2)));
       return $data;
    }
    return inet_ntop(hex2bin($ip));
} 
```

* * *

```
-- max len row db
echo strlen(inet_pton('2001:db8:85a3::8a2e:370:7334'));

-- db row info
ip varchar(16)

-- sql binary save and read
save base
$bin_ip='0x'.bin2hex(inet_pton($data['ip_address']));

-- db read
select ip_address from users;

-- encode binary from db
echo inet_ntop($row['ip_address']); 
```

# c# - 如何以功能方式获取中间和列表？使用 LINQ？

> ID：774537
> 
> 赞同：6
> 
> 时间：2009-04-21T20:51:34.380
> 
> 标签：c#, linq, functional-programming

给定一个对象列表，我需要返回一个列表，该列表由对象和到目前为止看到的列表中所有对象的对象属性的总和组成。

更普遍地给出

```
var input = new int[] {1,2,3} 
```

我想要输出

```
// does not compile but did not want to include extra classes.
var output = { (1,1), (2,3), (3,6) }; 
```

执行此操作的“正确”功能方式是什么？我当然可以用标准的迭代方法来做，但我正在寻找如何以一种实用的、懒惰的方式来做。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T21:09:11.483

我认为这是最短的方法：

```
int sum = 0;
var result = input.Select(i => new { i, S = sum += i }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-21T21:37:52.537

就功能而言，这是以下各项的组合：

### 压缩

取两个序列并创建元素的元组序列

和

### 地图

获取一个函数`f`和一个序列并返回一个新序列，即原始序列中每个 x 的 f(x)

zip[在 c# 4.0 中是微不足道的](http://bartdesmet.net/blogs/bart/archive/2008/11/03/c-4-0-feature-focus-part-3-intermezzo-linq-s-new-zip-operator.aspx) 从那里我们得到了简单的实现

```
static class Enumerable 
{ 
    public static IEnumerable<TResult> Zip<TFirst, TSecond, TResult>(
        this IEnumerable<TFirst> first, 
        IEnumerable<TSecond> second, 
        Func<TFirst, TSecond, TResult> func) 
    { 
        var ie1 = first.GetEnumerator(); 
        var ie2 = second.GetEnumerator();

        while (ie1.MoveNext() && ie2.MoveNext()) 
            yield return func(ie1.Current, ie2.Current); 
    } 
} 
```

然后我们需要地图。我们已经有了，这就是我们在c#中所说的Select

```
IEnumerable<int> input = { 1,2,3,4 };
int a = 0;
var accumulate = input.Select(x => 
    {
         a += x; 
         return a;
    }); 
```

但是将它烘焙到它自己的方法中（在 c# 中没有柯里化）并允许支持任意类型/累加会更安全。

```
static class Enumerable 
{ 
    public static IEnumerable<T> SelectAccumulate<T>(
        this IEnumerable<T> seq,
        Func<T,T,T> accumulator) 
    { 
        var e = seq.GetEnumerator(); 
        T t = default(T);             
        while (e.MoveNext()) 
        {
            t = accumulator(t, e.Current);
            yield return t;
        } 
    } 
} 
```

然后我们可以像这样把它们放在一起

```
var input = new int[] {1,2,3};
var mapsum = input.Zip(
    input.SelectAccumulate((x,y) => x+y), 
    (a,b) => new {a,b}); 
```

这将在序列上迭代两次，但更通用。您可以选择在标准选择和简单闭包中自己执行累加器，但它不再像“构建块”那样有用，这是函数式编程背后的驱动力之一。

元组支持是一种痛苦，除非在方法中，因为匿名类型不会在没有很多麻烦的情况下遍历方法边界。c# 4.0 中应该包含一些基本的元组。`Pair<T,U>`假设您可以调用一个元组类/结构：

```
public static IEnumerable<Pair<T,T>> ZipMapAccumulate<T>(
    this IEnumerable<T> input,
    Func<T,T,T> accumulator)
{
    return input.Zip(
        input.SelectAccumulate((x,y) => accumulator (x,y)), 
        (a,b) => new Pair<T,T>(a,b));
}

//get an int specific one
public static Func<IEnumerable<int>, IEnumerable<Pair<int,int>>> 
    ZipMapSum()
{
    return input => Enumerable.ZipMapAccumulate(
        input, 
        (i,j) => i + j);
} 
```

c# linq 变得比 f# 之类的语言更麻烦的地方是对运算符、柯里化和元组的支持很差，除非你把所有东西都放在一个函数中，并且每次都为每种类型“重建”它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T20:57:44.460

```
var output = input.Select((i, indexI) => 
    new {
           Element = i,
           RunningSum = input.Where((j, indexJ) => indexJ <= indexI).Sum()
        }); 
```

这将产生一个具有两个属性 Element 和 RunningSum 的匿名类型的集合。

**UPDTAE**

这是另一个仅使用 LINQ 聚合扩展方法的解决方案。是的，它很丑。

```
var output = input.Aggregate(
   new List<KeyValuePair<Int32, Int32>>(),
   (result, element) =>
   {
      result.Add(new KeyValuePair<Int32, Int32>(
         element,
         element + result.LastOrDefault().Value));
      return result;
   }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T21:01:04.483

```
 int runningTotal=0;
    var p = input.Select((l)=>
        {
            runningTotal+=l;
            return new {l,Total=runningTotal};
        }); 
```

# 编辑

Foreach 将永远井然有序。打开反射器并查看列表中的 ForEach（数组中不存在 ForEach）但是 ForEach 所做的只是对元素进行 for 循环。

我不确定选择，据我所知，但我从未深入研究过。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T20:59:20.227

```
var input = new int[] {1,2,3}
var output = new List<KeyValuePair<int,int>>();
int runningTotal = 0;

foreach (int current in input)
{
  runningTotal += current;
  output.Add(new KeyValuePair(current, runningTotal);
} 
```

如果您真的需要，可以很容易地将其转换为 Linq .Foreach() 函数。问题是如果你不想要一个单独的运行总数。

功能版本：

```
intput.Foreach(current=>
{
    runningTotal += current;
      output.Add(new KeyValuePair(current, runningTotal);

}
); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T22:39:09.410

功能实现（无副作用）且无扩展：

```
internal struct Tuple<T> {
    public T A;
    public T B;
}

internal class Program {
    private static void Main(string[] args) {
        var ints = new[] { 5, 7, 11, 13 };
        IEnumerable<Tuple<int>> result = ints.Aggregate<int, IEnumerable<Tuple<int>>>(new List<Tuple<int>>(),
                (sum, item) => sum.Concat(new[] { new Tuple<int> { A = sum.LastOrDefault().A + item, B = item } }));

        Console.WriteLine(string.Join(" ", result.Select(item => "(" + item.A + "," + item.B + ")").ToArray()));
    }
} 
```

虽然无法弄清楚如何使用匿名类型而不是元组来制作它。如果有的话也可以简化：

```
IEnumerable<T> Append(this IEnumerable<T> @this, T item); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T02:45:43.327

只是为了好玩，这里是在 F# 中，使用内置的 Seq.scan 函数：

```
> let input = [1;2;3];;

val input : int list

> input |> Seq.scan (fun (_, acc) x -> (x, acc + x)) (0,0) |> Seq.skip 1;;

val it : seq<int * int> = seq [(1, 1); (2, 3); (3, 6)] 
```

# svn - 我如何知道目录中的哪些文件不在我的 SVN 存储库中？

> ID：774540
> 
> 赞同：2
> 
> 时间：2009-04-21T20:51:57.047
> 
> 标签：svn

瓷砖正是我的问题。

[编辑出错误代码]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T20:53:29.027

您可以使用[svn status](http://svnbook.red-bean.com/en/1.2/svn.ref.svn.c.status.html)命令。

如果您没有设置忽略属性，文件将显示为“？” 字首。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-21T20:53:55.030

如果您使用的是 PC，[TortoiseSVN](http://tortoisesvn.tigris.org/)会使用覆盖图标突出显示每个文件，指示其相对于 SVN 的状态

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T20:54:36.090

如果您从命令行运行不受颠覆控制的“svn st”文件，将显示 ? 在他们旁边。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T20:55:29.910

您可以使用`svn stat`查看工作副本中存在的任何未被忽略且不在存储库中的文件。它们将标有问号？。要查看不在存储库中的每个文件（即使是那些通常会被 svn 忽略的文件），请使用 svn stat --no-ignore。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-22T22:59:05.393

为了放大@RichardE 的答案，Tortoise SVN 中的图标如下所示：

[替代文字 http://img144.imageshack.us/img144/1906/subversionicons.png](http://img144.imageshack.us/img144/1906/subversionicons.png)

尚未在存储库中的文件标有“？”

（来自帮助文件）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-21T20:54:51.627

如果您使用的是 linux，请从 svn 下的最顶层目录运行以下命令：

```
svn status 
```

出现的任何文件？它们旁边的符号不受版本控制。您可以使用 'svn add < filename >' 添加它们

像往常一样使用 svn commit 将它们提交到您的存储库。

# android - Android：确定当前上下文以显示警报

> ID：774545
> 
> 赞同：1
> 
> 时间：2009-04-21T20:53:21.397
> 
> 标签：android, multithreading, android-intent, android-context, offloading

我正在使用`Intent`s 从 Screen-A 调用 ZXing 扫描仪。扫描完成后，控制权当然会返回到 Screen-A 后面的代码，我在调用 Screen-B 之前做一些其他工作。

问题是：在此工作期间屏幕是黑色的，我无法确定用于显示“正在工作...”Toast/msgbox 的正确上下文。有什么帮助或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T20:19:12.007

Execute your "**work period**" in it's own `thread`, while that thread works in the background Android will pass control to Screen-A which will can display a ProgressBar. The "work period" thread will pass Messages to Screen-A updating the value of a variable that measures progress. Here's a good place to start with Android threads:

[http://developer.android.com/guide/appendix/faq/commontasks.html#threading](http://developer.android.com/guide/appendix/faq/commontasks.html#threading)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T21:21:40.883

您不能`ProgressDialog`在调用 ZXing 之前显示 a 然后将其关闭`onActivityResult()`吗？

# oracle - Oracle 字符类型

> ID：774550
> 
> 赞同：1
> 
> 时间：2009-04-21T20:54:06.373
> 
> 标签：oracle, types, char, varchar2

使用 VARCHAR2 (1 BYTE) 是否比使用 CHAR(1 BYTE) 效率低？

如果我从未在字段中输入任何超过一个字符的值，那么使用 VARCHAR2（2000 BYTE）是否比使用 CHAR（1 BYTE）效率低？

** 高效是指在时间（搜索）和空间（存储）方面都高效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T21:04:24.380

根据您的字符集，CHAR(1 BYTE) 可能无法存储任何特定字符，因此如果我们谈论多字节字符，则 VARCHAR2(2000 BYTE) 和 CHAR(1 BYTE) 之间可能存在差异。

更一般地说，在 SQL（PL/SQL 规则有点不同）中，如果您只存储 1 个字节的数据（我假设“高效”主要转化为存储效率）。一个 VARCHAR2(2000 BYTE) 会经常导致客户端应用程序分配一个 2000 字节的缓冲区来保存字段的内容，因为客户端应用程序事先不知道实际数据大小，这可能会导致客户端应用程序使用过多RAM 量。不过，这可能会或可能不会转化为真正的问题。大多数客户端应用程序不会因为 RAM 而受到伤害，大多数结果集也不会向客户端返回数百万行，因此在几百行上浪费几个 k 可能没什么大不了的。

有一个[AskTom 线程](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:1542606219593)更详细，特别是关于 PL/SQL 规则。

# java - 如何处理java线程

> ID：774552
> 
> 赞同：1
> 
> 时间：2009-04-21T20:54:49.413
> 
> 标签：java, multithreading

我有一个名为communicator的类。此类是从另一个程序接收事件的线程的侦听器。这个类还有一个方法调用刷新，它向程序发送和操作等待来自侦听器的响应。

这两种方法都在同一个类中，但由不同的线程调用。

```
public void processRefreshEvent(ManagerEvent event){
    //processing event
    //...
    //I'm done
    notify();
}

public synchronized void refresh() throws Exception {
    isRefreshing = true;    
    try {
                    manager.send(new refresh());
    } catch (ManagerException e) {
        isRefreshing = false;
    }

    try {
            wait(5000);
    } catch (InterruptedException e) {
    } finally{
        isRefreshing = false;
    }
} 
```

执行上面的代码时，出现以下异常：

> ```
> java.lang.IllegalMonitorStateException: current thread not owner
>         at java.lang.Object.wait(Native Method)
>         at Communicator.refresh(Communicator.java:203)
>         ... 
> ```

“等待”另一个线程完成的正确方法是什么。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T20:59:38.310

您需要在监视器上同步线程。例如（使用当前对象作为监视器）：

```
public void processRefreshEvent(ManagerEvent event){
        //processing event
        //...
        //I'm done
    synchronized(this) {
        notify(); // you are basically notifying any thread who has blocked
                  // on this monitor - in our case, the instance of this object
    }
}

public synchronized void refresh() throws Exception {
        isRefreshing = true;    
        try {
                    manager.send(new refresh());
        } catch (ManagerException e) {
                isRefreshing = false;
        }

        try {
          synchronized(this) {
                wait(5000); // wait will give up the monitor
          }
        } catch (InterruptedException e) {
        } finally{
                isRefreshing = false;
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T21:01:25.903

方法[`wait()`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#wait())和[`notify()`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#notify())只能从当前在其实例上同步的线程中调用。

声明“processRefreshEvent” `synchronized`，或者更好的是，只是修改`refresh`方法使用的状态的代码块，以及`notify()`调用。

```
public void processRefreshEvent(ManagerEvent event){
  // processing event
  synchronized (this) {
    // modify shared state with results of processing.
    notify();
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T21:16:16.130

你说你想等到另一个线程完成？然后只需在要等待的 Thread 对象上调用 join() 即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T20:59:53.487

来自`Object.wait()`的 JavaDocs：“当前线程必须拥有该对象的监视器。” 因此，您需要在您正在调用等待的对象上进行同步。

或者，您可以使用`BlockingQueue`, 实现`Collection`和`Queue`. `BlockingQueue`完成所有等待和通知的工作。您的线程可以只调用`take()`，这将阻塞直到数据可用。您可以使用各种插入方法（添加、放置等）将数据添加到队列中。顺便说一句，插入方法在调用`notify`时`take()`调用`wait`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T21:03:30.500

请阅读[java.lang.Object.wait()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#wait())和[notify()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#notify())上的 JavaDoc 。

您应该将 wait() 与适当的监视器同步，在这种情况下：

```
try{
    synchronized(this){
          wait(5000);
    }
}
catch (InterruptedException e) {
} finally{
            isRefreshing = false;
} 
```

# linux - linux/unix 进程的内存使用峰值

> ID：774556
> 
> 赞同：447
> 
> 时间：2009-04-21T20:55:25.993
> 
> 标签：linux, command-line, memory-management

是否有一个工具可以运行命令行并报告 RAM 使用总量的峰值？

我在想象类似于 /usr/bin/time 的东西

* * *

## 回答 #1

> 赞同：481
> 
> 时间：2009-04-21T21:03:58.657

[**编辑**：适用于 Ubuntu 14.04：`/usr/bin/time -v command` 确保使用完整路径。]

如果您通过了，看起来`/usr/bin/time`确实会给您该信息`-v`（这是在 Ubuntu 8.10 上）。参见，例如，`Maximum resident set size`下面：

```
$ /usr/bin/时间 -v ls /
……
        正在计时的命令：“ls /”
        用户时间（秒）：0.00
        系统时间（秒）：0.01
        此作业获得的 CPU 百分比：250%
        经过（挂钟）时间（h:mm:ss 或 m:ss）：0:00.00
        平均共享文本大小（千字节）：0
        平均非共享数据大小（千字节）：0
        平均堆栈大小（千字节）：0
        平均总大小（千字节）：0
        最大驻留集大小（kbytes）：0
        平均驻留集大小（kbytes）：0
        主要（需要 I/O）页面错误：0
        次要（回收帧）页面错误：315
        自愿上下文切换：2
        非自愿上下文切换：0
        掉期：0
        文件系统输入：0
        文件系统输出：0
        发送的套接字消息：0
        收到的套接字消息：0
        传递的信号：0
        页面大小（字节）：4096
        退出状态：0

```

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2010-08-16T08:22:37.540

（这是一个已经回答的老问题......但仅供记录：）

我受到杨的剧本的启发，想出了这个小工具，名为[memusg](http://gist.github.com/526585)。我只是将采样率提高到 0.1 来处理很短的生命过程。我没有监控单个进程，而是让它测量进程组的 rss 总和。（是的，我编写了许多可以协同工作的单独程序）它目前可以在 Mac OS X 和 Linux 上运行。用法必须类似于`time`：

```
memusg ls -alR ///dev/null

```

它只显示了目前的峰值，但我对记录其他（粗略）统计数据的轻微扩展感兴趣。

在我们开始任何认真的分析之前，有这样一个简单的工具来看看是件好事。

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2012-06-09T00:08:52.373

Valgrind 单线：

`valgrind --tool=massif --pages-as-heap=yes --massif-out-file=massif.out ./test.sh; grep mem_heap_B massif.out | sed -e 's/mem_heap_B=\(.*\)/\1/' | sort -g | tail -n 1`

注意使用 --pages-as-heap 来测量进程中的所有内存。更多信息在这里：http: [//valgrind.org/docs/manual/ms-manual.html](http://valgrind.org/docs/manual/ms-manual.html)

这将显着减慢您的命令速度。

* * *

## 回答 #4

> 赞同：62
> 
> 时间：2017-10-22T13:40:14.943

**在 Linux 上：**

使用`/usr/bin/time -v <program> <args>`并查找“*最大驻留集大小*”。

*（不要与 Bash`time`内置命令混淆！所以使用**完整路径**，`/usr/bin/time`）*

例如：

```
> /usr/bin/time -v ./myapp
        User time (seconds): 0.00
        . . .
        Maximum resident set size (kbytes): 2792
        . . . 
```

**在 BSD、MacOS 上：**

使用`/usr/bin/time -l <program> <args>`，寻找“*最大驻留集大小*”：

```
>/usr/bin/time -l ./myapp
        0.01 real         0.00 user         0.00 sys
      1440  maximum resident set size
      . . . 
```

* * *

## 回答 #5

> 赞同：57
> 
> 时间：2019-02-13T00:44:43.177

这是一个单行程序，不需要任何外部脚本或实用程序，也不需要您通过 Valgrind 或 time 等其他程序启动进程，因此您可以将其用于任何已经运行的进程：

```
grep ^VmPeak /proc/$PID/status 
```

（替换`$PID`为您感兴趣的进程的PID）

* * *

## 回答 #6

> 赞同：39
> 
> 时间：2009-04-21T21:05:38.043

也许 (gnu) [time(1)](http://unixhelp.ed.ac.uk/CGI/man-cgi?time)已经做了你想要的。例如：

```
$ /usr/bin/time -f "%P %M" command
43% 821248 
```

但其他分析工具可能会根据您要查找的内容提供更准确的结果。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2009-04-21T21:05:04.630

/usr/bin/time 实际上可能会做你想做的事。就像是。

```
/usr/bin/time --format='(%Xtext+%Ddata %Mmax)'

```

详情见时间(1)...

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2016-11-30T13:48:23.440

在 MacOS Sierra 上使用：

```
/usr/bin/time -l commandToMeasure 
```

你可以`grep`用来拿你想要的东西。

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2009-08-13T00:47:23.390

如果进程运行了至少几秒钟，那么您可以使用以下 bash 脚本，该脚本将运行给定的命令行，然后将峰值 RSS 打印到标准错误（替换`rss`您感兴趣的任何其他属性）。它有点轻巧，它适用`ps`于 Ubuntu 9.04 中包含的我（我不能说`time`）。

```
#!/usr/bin/env bash
"$@" & # Run the given command line in the background.
pid=$! peak=0
while true; do
  sleep 1
  sample="$(ps -o rss= $pid 2> /dev/null)" || break
  let peak='sample > peak ? sample : peak'
done
echo "Peak: $peak" 1>&2 
```

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2018-08-09T15:56:41.083

```
time -f '%M' <run_program> 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2009-04-21T21:00:40.240

好吧，如果您真的想显示内存峰值和一些更深入的统计信息，我建议使用分析器，例如[valgrind](http://valgrind.org/)。一个不错的 valgrind 前端是[alleyoop](http://alleyoop.sourceforge.net/)。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2020-09-06T22:09:47.157

因为`/usr/bin/time`在许多现代发行版中不存在（改为 Bash 内置时间），您可以使用带有`-v`参数的 Busybox 时间实现：

```
busybox time -v uname -r 
```

它的输出类似于 GNU 时间输出。Busybox 预装在大多数 Linux 发行版（Debian、Ubuntu 等）中。如果你使用 Arch Linux，你可以安装它：

```
sudo pacman -S busybox 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-04-21T21:02:56.490

您可以使用[Valgrind](http://en.wikipedia.org/wiki/Valgrind)之类的工具来执行此操作。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2012-03-01T09:12:53.477

这是（基于其他答案）一个非常简单的脚本，可以监视已经运行的进程。您只需使用要监视的进程的 pid 作为参数运行它：

```
#!/usr/bin/env bash

pid=$1

while ps $pid >/dev/null
do
    ps -o vsz= ${pid}
    sleep 1
done | sort -n | tail -n1 
```

示例用法：

```
max_mem_usage.sh 23423 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-05-25T05:22:33.183

[Heaptrack](https://github.com/KDE/heaptrack)是具有 GUI 和文本界面的 KDE 工具。我发现它比 valgrind 更适合理解进程的内存使用情况，因为它提供了更多细节和火焰图。它也更快，因为它检查 valgrind 的次数更少。它为您提供了峰值内存使用量。

无论如何，跟踪 rss 和 vss 会产生误导，因为页面可以共享，这就是`memusg`. 您真正应该做的是跟踪`Pss`in`/proc/[pid]/smaps`或 use的总和`pmap`。[GNOME 系统监视器](https://wiki.gnome.org/Apps/SystemMonitor)曾经这样做，但它太贵了。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-02-23T19:32:46.297

使用地块：http: [//valgrind.org/docs/manual/ms-manual.html](http://valgrind.org/docs/manual/ms-manual.html)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-10-12T11:34:01.130

使用手工制作的 bash 脚本重新发明轮子。又快又干净。

**我的用例：**我想监控一台 RAM 较少的 linux 机器，并希望在它在大量使用情况下运行时拍摄每个容器使用情况的快照。

```
#!/usr/bin/env bash

threshold=$1

echo "$(date '+%Y-%m-%d %H:%M:%S'): Running free memory monitor with threshold $threshold%.."

while(true)
    freePercent=`free -m | grep Mem: | awk '{print ($7/$2)*100}'`    
  do

  if (( $(awk 'BEGIN {print ("'$freePercent'" < "'$threshold'")}') ))
  then
       echo "$(date '+%Y-%m-%d %H:%M:%S'): Free memory $freePercent% is less than $threshold%"
       free -m
       docker stats --no-stream
       sleep 60  
       echo ""  
  else
       echo "$(date '+%Y-%m-%d %H:%M:%S'): Sufficient free memory available: $freePercent%"
  fi
  sleep 30

done 
```

样本输出：

> 2017-10-12 13:29:33：以 30% 的阈值运行空闲内存监视器。
> 
> 2017-10-12 13:29:33：足够的可用内存：69.4567%
> 
> 2017-10-12 13:30:03：足够的可用内存：69.4567%
> 
> 2017-10-12 16:47:02: 可用内存 18.9387% 小于 30%
> 
> 您的自定义命令输出

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-03-19T17:00:34.853

在 macOS 上，您可以改用 DTrace。“仪器”应用程序是一个很好的 GUI，它带有 XCode afaik。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-05-25T05:07:23.277

'htop' 是查看哪个进程正在使用多少 RAM 的最佳命令.....

更多细节 [http://manpages.ubuntu.com/manpages/precise/man1/htop.1.html](http://manpages.ubuntu.com/manpages/precise/man1/htop.1.html)

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2018-10-14T16:55:28.760

> > 请务必回答问题。提供详细信息并分享您的研究！

抱歉，我是第一次来，只能问问题……</p>

使用建议：

```
valgrind --tool=massif --pages-as-heap=yes --massif-out-file=massif.out ./test.sh; grep mem_heap_B massif.out | sed -e 's/mem_heap_B=\(.*\)/\1/' | sort -g | tail -n 1 
```

然后：

```
grep mem_heap_B massif.out
...
mem_heap_B=1150976
mem_heap_B=1150976
... 
```

`top`这与类似时刻显示的命令非常不同：

```
14673 gu27mox   20   0 3280404 468380  19176 R 100.0  2.9   6:08.84 pwanew_3pic_com 
```

Valgrind 的测量单位是什么？

从未回答的`/usr/bin/time -v ./test.sh`问题 - 您必须直接将可执行文件提供给`/usr/bin/time`喜欢：

```
/usr/bin/time -v  pwanew_3pic_compass_2008florian3_dfunc.static  card_0.100-0.141_31212_resubmit1.dat_1.140_1.180   1.140 1.180 31212

    Command being timed: "pwanew_3pic_compass_2008florian3_dfunc.static card_0.100-0.141_31212_resubmit1.dat_1.140_1.180 1.140 1.180 31212"

    User time (seconds): 1468.44
    System time (seconds): 7.37
    Percent of CPU this job got: 99%
    Elapsed (wall clock) time (h:mm:ss or m:ss): 24:37.14
    Average shared text size (kbytes): 0
    Average unshared data size (kbytes): 0
    Average stack size (kbytes): 0
    Average total size (kbytes): 0
    Maximum resident set size (kbytes): 574844
    Average resident set size (kbytes): 0
    Major (requiring I/O) page faults: 74
    Minor (reclaiming a frame) page faults: 468880
    Voluntary context switches: 1190
    Involuntary context switches: 20534
    Swaps: 0
    File system inputs: 81128
    File system outputs: 1264
    Socket messages sent: 0
    Socket messages received: 0
    Signals delivered: 0
    Page size (bytes): 4096
    Exit status: 0 
```

# vim - 在 vim 中，如何让文件以我上次关闭它的同一行号打开？

> ID：774560
> 
> 赞同：161
> 
> 时间：2009-04-21T20:56:23.713
> 
> 标签：vim

我想配置 vim 在我离开的同一个地方打开一个文件。

* * *

## 回答 #1

> 赞同：221
> 
> 时间：2009-04-21T21:03:50.717

在 Ubuntu 的`/etc/vim/vimrc`文件中，这个例子被注释掉了：

```
" Uncomment the following to have Vim jump to the last position when                                                       
" reopening a file
if has("autocmd")
  au BufReadPost * if line("'\"") > 0 && line("'\"") <= line("$")
    \| exe "normal! g'\"" | endif
endif 
```

如果这不起作用，一个常见的问题是没有您的`~/.viminfo`文件的所有权。如果是这种情况，请运行：

```
sudo chown user:group ~/.viminfo 
```

其中用户是您的`username`，`group`通常与您的用户名相同。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-04-22T06:37:56.173

如果您不介意为简单起见交易自动化，只需`'``"`在打开文件时按下按键（撇号，后跟双引号），您将跳转到您所在的位置。这基本上就是@marcog 的回答。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-04-22T06:21:00.300

```
 :h views-sessions 
```

你可以把它放在你的*.vimrc*中：

```
 autocmd BufWinLeave *.* mkview
  autocmd BufWinEnter *.* silent loadview 
```

视图将放置在 .vim/view 中。您可能需要创建这些目录。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2017-11-24T22:46:30.243

您可以在不指定文件名的情况下使用以下命令启动 vim

```
vim 
```

接下来按两次 CTRL+O 移动到您处理的任何文件中的最后一个位置。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-01-17T03:19:51.993

有一个名为[vim-lastplace](https://github.com/farmergreg/vim-lastplace)的插件（我是作者），它会在你离开的地方打开你的文件。它通过忽略提交消息改进了上述建议，因为您通常正在编辑新消息并希望从提交消息文件的顶部开始。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-03-30T07:34:57.847

如果你启用了 viminfo，它就像``0`转到最后编辑的文件位置一样简单。您会注意到这只是一个“转到标记”命令；

实际上，您可以稍后执行 '3 以转到之前编辑的第三个位置（可能在另一个文件中），然后再次返回到最后``0`一个

看一下

```
 :marks 
```

查看记住的位置。另请注意，viminfo 存储各种其他内容（如寄存器的内容、每个文件的标记、命令和搜索历史）。大多数人出于明显的原因启用了此功能

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-09-15T10:29:40.600

Sometimes `~/.viminfo` becomes read-only or your user don't have access to the file. That could also be a reason that vim does not store your cursor position when you close your file.

# windows - 使用 Windows 的 Wamp 和文件权限

> ID：774561
> 
> 赞同：-1
> 
> 时间：2009-04-21T20:56:31.407
> 
> 标签：windows, permissions, wamp, chmod

抱歉，如果已经回答。列出的答案似乎都不令人满意。

我正在使用 WAMP 来构建一个站点（显然是 windows）。图像文件夹需要打开权限才能显示在网站上。每次我在文件夹上使用“属性”时，它都会恢复为只读。更改高级工具栏中的内容并尝试启用权限并没有帮助。

任何人都知道在这种环境中 CHMOD 的替代品或等效物是什么？（Windows/WAMP 等）

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-21T22:52:51.063

想通了这个问题。与文件权限无关 - 但与 CMS 特定标签无关。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-21T22:56:31.693

您需要授予特定文件夹中“IUSR_Machinename”的权限。只需在文件夹上单击右键搜索属性窗口，转到安全设置并添加具有所需权限的“IUSR_machinename”用户。

# regex - 验证 Active Directory 默认密码复杂性的正则表达式

> ID：774569
> 
> 赞同：6
> 
> 时间：2009-04-21T20:57:26.193
> 
> 标签：regex, active-directory, passwords

我有一个密码列表，我需要检查并确定它们是否符合 AD 的默认 3 of 4 规则。

规则包含以下 4 个要求中的 3 个：小写字符 (az) 大写字符 (AZ) 数字 (0-9) 特殊字符 (!@#$%^&*()_+=)

我还在学习正则表达式。我知道如何只选择满足任何一个字符大小写的那些，但我不确定如何做 3 of 4。

作为旁注，AD 复杂性还有两个重要的微妙之处（但超出了原始问题的范围）。

真的是 3 of 5。第五个是 Unicode 字符。很高兴用它来更新正则表达式。

另一个是您不能在密码中包含整个 sAMAccountName 值（不区分大小写），也不能将 displayName 值拆分为按空格、逗号、破折号、下划线、磅、管道和其他标记拆分的标记（3 个字符和更长）不能在密码中是完整的，不区分大小写。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-07-02T14:52:41.663

如果你真的想要一个大的正则表达式，它会是这样的：

```
(?=^.{8,255}$)((?=.*\d)(?=.*[A-Z])(?=.*[a-z])|(?=.*\d)(?=.*[^A-Za-z0-9])(?=.*[a-z])|(?=.*[^A-Za-z0-9])(?=.*[A-Z])(?=.*[a-z])|(?=.*\d)(?=.*[A-Z])(?=.*[^A-Za-z0-9]))^.* 
```

请注意，它还强制密码长度在 8 到 255 个字符之间。您可以更改第一部分中的“{8,255}”部分以调整长度要求。还值得注意的是，这在标准 ASP.NET [RegularExpressionValidator](http://msdn.microsoft.com/en-us/library/eahwtc9e.aspx)控件中对我有用。

匹配：“Passw0rd”“passW@rd”“1B2a345@#$%”

不匹配：“123123123”“密码”“asdf&”

[来源](http://regexlib.com/REDetails.aspx?regexp_id=887)（Matthew Hazzard 通过 RegExLib.com）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T21:20:50.207

它必须是一个大的正则表达式吗？你可以做 4 个正则表达式，每个检查一件事，然后确保 4 个中的 3 个匹配。这将更容易，更不容易出错并且更易于维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T21:15:27.723

您必须像这样构建正则表达式：

```
rule = [ "[a-z]", "[A-Z]", "[0-9]", "[!@#$%\^\&\(\)\+=]" ]

regex = ""
first = true
for a in 0..3:
  for b in 0..3:
    if a == b: continue
    for c in 0..3:
      if a == c or b == c: continue
      if not first:
        regex += "|"
      regex += "(" + rule[a] + ".*" + rule[b] + ".*" + rule[c] + ")"
      first = false 
```

我不确定我是否正确转义了特殊字符。这有点取决于您使用的语言/工具包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-11T09:23:53.777

我编辑了[@saul-dolgin](https://stackoverflow.com/a/3166778/1170950)答案以与问题中指定的有效字符集完全匹配（不是非字母数字字符`[^A-Za-z0-9]`）：

```
(?=^[A-Za-z\d!@#\$%\^&\*\(\)_\+=]{8,20}$)((?=.*\d)(?=.*[A-Z])(?=.*[a-z])|(?=.*\d)(?=.*[!@#\$%\^&\*\(\)_\+=])(?=.*[a-z])|(?=.*[!@#\$%\^&\*\(\)_\+=])(?=.*[A-Z])(?=.*[a-z])|(?=.*\d)(?=.*[A-Z])(?=.*[!@#\$%\^&\*\(\)_\+=]))^.* 
```

Microsoft 强制密码仅包含列表中的字符。我还将最大长度更改为 20。

# sockets - 服务器与客户端套接字（低级细节）？

> ID：774571
> 
> 赞同：16
> 
> 时间：2009-04-21T20:57:29.483
> 
> 标签：sockets

一般编程：在服务器套接字 accept() 方法中究竟发生了什么。在低级别服务器套接字与客户端套接字有何不同？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-25T07:06:11.450

在低级别套接字只是套接字，无论它们是在服务器还是客户端应用程序中使用。两者的区别在于每种应用程序所做的系统调用。

服务器套接字将调用`bind()`以与端口关联。他们希望与一个端口相关联，以便其他程序知道从哪里到达他们。客户端套接字*可以*调用`bind()`但几乎从不调用，因为没有太多意义。如果套接字不调用`bind()`，操作系统只会为其选择一个临时端口，这对客户端来说很好，因为他们正在调用；没有人*需要*打电话给他们。

服务器套接字调用`listen()`. 这在其他答案中得到了很好的解释。

服务器套接字调用`accept()`，我认为这是您问题的症结所在，因为起初它有点神秘。要掌握的重要一点是，在调用`accept()`内核时会传回一个*新*的套接字。它现在与原始侦听套接字分开，是您的服务器将用来与其对等方通信的。

理解侦听套接字如何在接受的连接执行其操作时继续侦听的关键在于理解 tcp 连接依赖于 (1) 本地地址 (2) 本地端口 (3) 外部地址 (4) 的 4 元组外国港口。这些定义了一个独特的连接。在`accept()`传回新套接字之前，内核使用这些值来创建各种结构，以便与 tcp/ip 堆栈协作，该元组的所有流量都将进入连接的套接字。即使您的服务器可能与本地地址 192.168.1.100 端口 80 有一千个连接，但地址和端口的客户端组合将始终不同，因此元组始终是唯一的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-21T21:03:17.363

首先，服务器套接字通常绑定到众所周知的名称（在本例中为端口），并且它们使用`listen()`. 这就是真正的区别发生的地方，因为客户端套接字使用`connect()`. 调用`listen()`套接字会导致内核的 tcp/ip 实现开始接受发送到套接字绑定名称（端口）的连接。无论您是否调用过，都会发生这种情况`accept()`。

`accept()`只是为您的服务器提供了一种访问连接到您的侦听套接字的客户端套接字并与之交互的方法。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-21T21:26:56.247

如果您真的感兴趣，那么我建议您阅读[TCP/IP Illustrated, Volume 2](http://books.google.com/books?id=ESM3CWY5xRYC)。如果您想要一个更少的“胆量”答案，那么：

*   服务器套接字绑定到众所周知的端点，其中端点是（协议、地址、端口）元组。端点由系统调用中指定的协议`socket()`和系统调用中指定的寻址信息构成`bind()`。
*   当服务器调用`listen()`系统调用时，网络堆栈会创建一个队列，将挂起的连接放入其中。队列大小的提示作为 的`backlog`参数给出`listen()`。
*   然后服务器调用`accept()`以从队列中拉出一个新连接。
*   客户端套接字通过在调用中指定服务器端点来向服务器套接字发送消息，`connect()`然后使用`send()`or发送数据`write()`。
*   当客户端调用`connect()`时，一个连接被推送到它所在的服务器端队列，直到服务器*接受该连接*。

但是，此描述仅对 TCP/IP 套接字真正有效。UDP 情况更简单且完全不同，因为 UDP 套接字没有（必然）连接。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-21T21:12:11.257

如果不指定编程语言，很难完全回答您的问题。我将就 python 进行回答，因为据我所知，答案可能具有代表性。

如果`s`是一个`socket`对象，那么服务器首先通过调用绑定到一个端口`s.bind(('',12345))`。这将在服务器模式下创建一个套接字。它准备在端口 12345 上捕获数据。

然后一个电话`s.listen(10)`。这会使套接字进入服务器模式。这意味着此套接字将接收到一个连接请求（一次最多 10 个挂起的请求）。

当我们到达 时`s.accept()`，操作系统已经知道我们正在侦听端口 12345。 `s.accept()`只是说明我们将如何处理收到的请求。在python中，`s.accept()`将返回`(connection,address)`连接是通过另一个端口的连接。在这种情况下，`connection`与客户端打开的套接字对象没有太大区别。从现在开始，它是相当对称的。

# xslt - XPath 有序优先属性搜索

> ID：774585
> 
> 赞同：4
> 
> 时间：2009-04-21T21:01:26.730
> 
> 标签：xslt, search, xpath, attributes

我想编写一个可以在 HTML DOM 上返回一些链接元素的 XPath。

语法是错误的，但这是我想要的要点：

```
//web:link[@text='Login' THEN_TRY @href='login.php' THEN_TRY @index=0] 
```

THEN_TRY 是一个虚构的运算符，因为我找不到要使用的运算符。如果对于给定的一组 [attribute=name] 对，页面上存在许多链接，则应返回与最左侧属性匹配的链接，而不是任何其他链接。

例如，考虑上面的示例 XPath 找到 3 个与任何给定属性匹配的链接的情况：

```
link A: text='Sign In', href='Login.php', index=0
link B: text='Login', href='Signin.php', index=15
link C: text='Login', href='Login.php', index=22 
```

链接 C 被列为最佳匹配，因为它匹配 First 和 Second 属性。

Link B 排名第二，因为它只匹配 First 属性。

链接 A 排在最后，因为它与 First 属性不匹配；它只匹配第二个和第三个属性。

XPath 应该返回最佳匹配，Link C。

如果多个链接与“最佳匹配”相关联，则 XPath 应该返回它在页面上找到的第一个最佳链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T22:06:55.807

有一个蛮力解决方案。我将演示两个属性而不是三个。

```
(
  //web:link[@text != 'Login' 和 @href != 'Login.php'
             而不是(//web:link[@text = 'Login' or @href = 'Login.php'])]
| //web:link[@text != 'Login' 和 @href = 'Login.php'
             而不是(//web:link[@text = 'Login'])]
| //web:link[@text = 'Login' 和 @href != 'Login.php'
             而不是(//web:link[@text = 'Login' and @href = 'Login.php'])]
| //web:link[@text = 'Login' 和 @href = 'Login.php']
)[1]

```

也就是说，选择所有属性都不匹配的链接，但前提是没有更好匹配的链接。然后选择所有具有较小属性匹配的链接，但仅当没有与高级属性匹配的链接时。只有第一个属性匹配的选择链接，但前提是没有两个属性都匹配的链接。然后选择两个属性都匹配的链接。这四个合取词中只有一个是非空的，因此“ `|`”运算符实际上从未组合任何内容。最后，选择文档顺序中的第一个链接，以防任何这些节点集包含多个元素。

我只做两个属性而不是三个的原因是因为我不想输入所有八个案例。如果您对任何链接不感兴趣，则可以省略第一种情况，除非至少有一个属性匹配。

在这种情况下，您最好在[Jeff 展示的更简单的查询中选择](https://stackoverflow.com/questions/774585/xpath-ordered-priority-attribute-search/774617#774617)*所有*候选者，然后使用其他代码对结果进行排名，在这种情况下，您可以更轻松地使用迭代和变量来选择最佳候选者。

**如果您可以使用 XPath 2**，那么您可以使用[逗号运算符](http://www.w3.org/TR/xpath20/#construct_seq)[（`concat`](http://www.w3.org/TR/xpath-functions/#func-concat)或[函数](http://www.w3.org/TR/xpath-functions/#func-concat)）来连接节点序列（取代节点集）。试试这个，例如：

```
(
  //web:link[@text = 'Login' 和 @href = 'Login.php' 和 @index = 0]
, //web:link[@text = 'Login' and @href = 'Login.php' and @index != 0]
, //web:link[@text = 'Login' and @href != 'Login.php' and @index = 0]
, //web:link[@text = 'Login' and @href != 'Login.php' and @index != 0]
, //web:link[@text != 'Login' and @href = 'Login.php' and @index = 0]
, //web:link[@text != 'Login' and @href = 'Login.php' and @index != 0]
, //web:link[@text != 'Login' 和 @href != 'Login.php' 和 @index = 0]
, //web:link[@text != 'Login' and @href != 'Login.php' and @index != 0]
)[1]

```

* * *

顺便说一句，这是为每个链接分配排名的简单方法，这使得比较它们变得非常简单。想象一个位字段，您要检查的每个属性一个位。如果第一个属性匹配，则设置最左边的位，否则不设置。如果第二个属性匹配，则设置下一个最高有效位等。因此，对于您的示例，您将获得以下位值：

```
011链接A：text='登录'，href='Login.php'，索引=0
100 链接 B: text='Login', href='Signin.php', index=15
110 链接 C: text='Login', href='Login.php', index=22

```

要选择最佳匹配，请将位字段视为二进制数。链接 A 的得分为 3，链接 B 的得分为 4，链接 C 的得分为 6。（这有点让人想起[CSS 选择器的特异性是](http://www.w3.org/TR/CSS21/cascade.html#specificity)如何确定的。）这是一种排序标准建模的方法，但是现在我已经全部输入了，我不太明白它会导致 XPath 中的任何简明解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T03:14:48.080

*前两个答案似乎并不准确*。

**这是一种可能的解决方案**：

您想找到以下函数的最大值的第一个节点：

```
100*number(@text='Login') 
+10*number(@href='Login.php') 
+ 1*number(@index=0) 
```

**在 XPath 2.0**中，这可以通过以下方式表示为单个 XPath 表达式：

```
 /*/link[
           100*number(@text='Login') 
           +10*number(@href='Login.php') 
           + 1*number(@index=0)

          eq
             max(/*/link
                     /(100*number(@text='Login') 
                       +10*number(@href='Login.php') 
                       + 1*number(@index='0')
                       )
                )

          ] 
```

**在 XPath 1.0 中，如果可能的话，构建这样一个单一的表达式将是极其困难**的，即使可能，这样的 XPath 表达式也将无法理解、证明是正确的和/或维护。

但是，*可以在作为 XPath 1.0 宿主的任何语言中**选择最匹配的`link`*元素。

**下面的一个示例是使用 XSLT 1.0**作为宿主语言：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/">
      <xsl:for-each select="*/link">
        <xsl:sort data-type="number" order="descending" select=
        "100*(@text='Login') 
         +10*(@href='Login.php') 
         + 1*(@index=0)
        "/>
        <xsl:if test="position() = 1">
          <xsl:copy-of select="."/>
        </xsl:if>
      </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

**当在此 XML 文档上应用上述转换时**：

```
<links>
  <link name="A" text="Sign in" href="Login.php" 
        index="0"/>
  <link name="B" text="Login" href="SignIn.php" 
        index="15"/>
  <link name="C" text="Login" href="Login.php" 
        index="22"/>
</links> 
```

**产生正确的结果**：

```
<link name="C" text="Login" href="Login.php" index="22" /> 
```

**这让我想起了我在** **七年前解决的****[另一个“单一 XPath 表达式找到最佳匹配”问题:)](http://www.biglist.com/lists/xsl-list/archives/200207/msg00804.html)**

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T21:08:14.480

尝试[`or`](http://www.w3schools.com/xpath/xpath_operators.asp)运算符，如下所示：

```
web:link[@text='Login' or @href='login.php' or @index=0] 
```

但是，这可能会为您提供所有这些节点，而不仅仅是指定优先级中的一个。

**更新**
所以，我尝试了这个并且它有效。它很长，但它应该可以满足您的需求（对您的架构进行适当的更改）。

```
//link[@text='Login'] | //link[not(//link[@text='Login']) and @href='Login.php'] | //link[not(//link[@text='Login']) and not(//link[@href='Login.php']) and @index='0'] 
```

我在以下测试 XML 上运行它，注释掉每一行以测试不同的部分，它按预期工作。

```
<?xml version="1.0" encoding="utf-8"?>
<Test>
  <link text='Sign In' href='Login2.php' index="0"></link>
  <link  text='Login' href='Signin.php' index="15"></link>
  <link  text='LoginBlah' href='Login.php' index="22"></link>
</Test> 
```

**更新 2**
我注意到我还没有完全解决这个问题，因为你想要最好的匹配而不是按优先顺序排列的匹配。这可以完成，但需要相当长的 XPath 来按顺序执行每个组合的等效操作。我不知道有任何其他方法可以简化它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T13:21:23.097

我今天遇到了类似的问题，并找到了一个可以在 XSLT 上下文中工作的解决方案。对于纯 XPath 解决方案，您将需要其他方法之一。

```
<xsl:variable name="first" select="/web:link[@text='Login']"/>
<xsl:variable name="second" select="/web:link[@href='login.php']"/>
<xsl:variable name="third" select="/web:link[@index=0]"/>
<xsl:variable name="theAnswer" 
 select="$first | $second[not($first)] | $third[not($first or $second)]"/> 
```

当然，这里的技巧是空节点集的计算结果为假。

# c# - ASP.NET 中的多选下拉列表

> ID：774587
> 
> 赞同：36
> 
> 时间：2009-04-21T21:01:32.487
> 
> 标签：c#, asp.net, web-controls

对于 asp.net，是否存在带有复选框（webcontrol）的任何好的多选下拉列表？

非常感谢

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-21T21:12:33.613

您可以使用`[System.Web.UI.WebControls.CheckBoxList](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkboxlist.aspx)`控件或使用属性设置为的`[System.Web.UI.WebControls.ListBox](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listbox.aspx)`控件。`SelectionMode``Multiple`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-07-11T17:11:54.550

[**jQuery Dropdown Check List**](http://code.google.com/p/dropdown-check-list/)可用于将常规的多选 html 元素转换为下拉复选框列表，它适用于客户端，因此可以与任何服务器端技术一起使用：

[![替代文字](https://i.stack.imgur.com/CPNOF.png)](https://i.stack.imgur.com/CPNOF.png)
[（来源：[googlecode.com](http://dropdown-check-list.googlecode.com/svn/trunk/doc/demo.png)）]

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-05-30T14:57:49.307

试试这个直接从 CheckBoxList 继承的服务器控件（免费，开源）： [http ://dropdowncheckboxes.codeplex.com/](http://dropdowncheckboxes.codeplex.com/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-07-03T01:22:25.740

[我使用了http://dropdowncheckboxes.codeplex.com/](http://dropdowncheckboxes.codeplex.com/)上的开源控件并且对它非常满意。我的补充是如果“选定”标题太长，则允许检查文件列表仅使用文件名而不是完整路径。在您的回发处理程序中调用了我的添加而不是 UpdateSelection：

```
// Update the caption assuming that the items are files<br/> 
// If the caption is too long, eliminate paths from file names<br/> 
public void UpdateSelectionFiles(int maxChars) {
  StringBuilder full = new StringBuilder(); 
  StringBuilder shorter = new StringBuilder();
  foreach (ListItem item in Items) { 
    if (item.Selected) { 
      full.AppendFormat("{0}; ", item.Text);
      shorter.AppendFormat("{0}; ", new FileInfo(item.Text).Name);
    } 
  } 
  if (full.Length == 0) Texts.SelectBoxCaption = "Select...";
  else if (full.Length <= maxChars) Texts.SelectBoxCaption = full.ToString(); 
  else Texts.SelectBoxCaption = shorter.ToString();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T21:06:24.610

HTML 不支持带有复选框的下拉列表。您可以有一个下拉列表或一个复选框列表。您可以使用 javascript 和隐藏 div 来伪造一个下拉复选框列表，但这比标准复选框列表更不可靠。

当然也有看起来像下拉复选框列表的 3rd 方控件，但它们使用的是 div 技巧。

您还可以使用双列表框，它通过在两个列表之间来回移动项目来处理多选。这有一个额外的好处，即可以轻松地一次查看所有选定的项目，即使总项目列表很长

（想象一下世界上每个城市的列表，只有第一个和最后一个被选中）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-21T21:08:21.830

我喜欢 Infragistics 控件。[WebDropDown](http://www.infragistics.com/dotnet/netadvantage/aspnet/webdropdown.aspx#Overview)有你需要的东西。唯一的缺点是他们可能有点花钱。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-11T17:05:09.823

看一下这个。它是免费的。

[http://irfaann.blogspot.com/2009/07/ajax-based-multiselect-dropdown-control.html](http://irfaann.blogspot.com/2009/07/ajax-based-multiselect-dropdown-control.html)

高温下，

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-12T00:21:44.387

这是一个很酷的 ASP.NET Web 控件，名为 Multi-Select List Field，位于[http://www.xnodesystems.com/](http://www.xnodesystems.com/)。它能够：

(1) 多选；(2) 自动完成；(3) 验证。

# iphone - 无法从回调中重绘矩形

> ID：774590
> 
> 赞同：0
> 
> 时间：2009-04-21T21:02:34.447
> 
> 标签：iphone

我是 iphone 新手

我想做的是将图像渲染到iphone

所以我有一个模块来生成图像数据，在调用回调函数通知 UIView 后，在 UIView 我有回调函数将图像提供给 UIImage，然后我 setNeedsDisplay 并返回。

在我的 UIView 类 drawRect:(CGRect)rect 我调用 drawImage，但它没有调用，没有刷新，我也得到了 NSAutoreleaseNoPool UIImage 自动释放，没有池到位错误。

有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T22:04:52.177

您需要从图像数据中创建一个 UIImageView，然后通过向其发送`addSubView:`消息将新的 UIImageView 添加到主视图。之后，您的图像将自动呈现。您不需要实现 drawRect。

听起来好像您尝试将 UIImageView 子类化 - 除非您有自己的图像数据内部格式，否则您不需要这样做。

# php - PHP达到内存限制导致函数重新运行

> ID：774593
> 
> 赞同：1
> 
> 时间：2009-04-21T21:03:01.640
> 
> 标签：php, zend-framework, memory

所以我有一个非常奇怪的问题。

首先，我使用 PHP 5.2.6（作为 MAMP 的一部分，虽然这也发生在运行 5.2.6 的 LAMP 服务器上），使用 Zend Framework 1.7.2 编写网站。

其次，我正在编写的软件进行了相当复杂的统计计算，需要大量内存。通常它运行良好，将 128MB 设置为内存限制。

所以这是有趣的部分。

我有一个类专门负责获取所需的数据，进行所需的计算，然后返回值。在它运行之后，我一直在取消设置它，因为 PHP 似乎认为它仍在范围内并为它保留了内存，尽管完成了调用它的函数（这导致了第二次计算运行的问题）达到内存限制并且脚本死亡）。在该函数内运行一次此计算后，它会在另一个函数中再次运行以进行另一次计算（这是在同一执行运行期间）。这就是事情变得奇怪的地方。

如果我运行第二个计算，调用函数会再次运行，尽管在执行此计算的代码中绝对没有调用该函数。此外，PHP 中不会出现错误或警告。

但是，如果我增加内存限制（例如，增加到 1024 MB），*它就不会发生。*整个调用函数运行一次并继续其愉快的方式。

所以，让我在下面画一张地图。

```
function A{
   calls function B
   calls function D
}

function B{
   calls calculation function C
}

function D{
   calls calculation function C
} 
```

使用 128 MB 内存，函数路径如下（进出调用者）：A->B->C->B->A->D->C->D->然后它运行 A 从由于某种原因，函数的开始到结束（在此执行路径中存在一个条件情况，因此路径不会重复）

1GB内存，函数路径如下：A->B->C->B->A->D->C->D->A端，这是应该发生的。

如果我从函数 D 中删除第二个计算，它会起作用。如果我提高内存限制，它会起作用。

问题是：我是否在 PHP 内存管理中发现了一个错误？或者也许在 Zend 框架中？再次; 通过增加 php.ini 中每个脚本的内存限制，我没有看到这个问题。那，或删除运行此计算的第二个实例，它使用大量内存。

我非常非常确定这就是它发生的方式，尽管它的方式很奇怪（我从未见过这种跳回调用函数的开头）。通常在这种情况下会发生的是 PHP 会出错并死掉，而不是重新启动调用函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T21:15:02.890

您是否使用[debug_backtrace()](http://www.php.net/debug_backtrace)验证了程序流程？我认为您的 php 代码比 zend 引擎更有可能是导致此问题的原因。我建议在每个函数的开头将跟踪转储到文件中并首先分析：

```
function myFunction() {
    file_put_contents(print_r(debug_backtrace(), true) . "\n--\n", 'trace.txt');
    //... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T21:09:47.817

首先，打开所有[错误报告](http://uk.php.net/manual/en/function.error-reporting.php)，包括 E_STRICT。

我怀疑内存不足会导致您没有预料到的执行路径，并且可能额外的错误输出会更加清楚。

# sql - 使用重新分发的组件导出 SQL Server 数据

> ID：774602
> 
> 赞同：0
> 
> 时间：2009-04-21T21:04:12.527
> 
> 标签：sql, sql-server-2005, sql-server-2008, bcp

我正在编写一个应用程序，它试图将数据从 SQL Server 数据库（具有给定的连接字符串）批量导出到本地文件（以任何格式）。

通常，sql server 实用程序**BCP.exe**是理想的，但是，**bcp**实用程序在我的应用程序运行的机器上可能不可用。*此外*，bcp 不被视为可再发行应用程序。

那么我的问题是：BCP.exe 是否不可再发行？如果不是，那么对我和我的应用程序可用的最佳可再分发模块是什么。

将考虑任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T22:00:32.437

如果您使用的是 VB.Net 或 C#，则不需要框架以外的任何可再发行组件。

**编辑：**我想知道您的应用程序的目标系统是什么，以及您计划使用什么编程语言来生成它。以便我可以给出适当的回应。

**再次编辑：**您可能希望尝试使用 SQL [OPENROWSET](http://msdn.microsoft.com/en-us/library/aa276850(SQL.80).aspx)方法，它可以让您直接插入任何 OLEDB 提供程序。除此之外，您将为此使用 ADO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T00:14:39.883

您关注 BCP 是否有特定原因？您是否正在导出*大量*的批量数据？BCP 非常快，但它倾向于“在幕后”工作，因此围绕着一些正常的制衡。AFAIK 这是一个 SQL 工作站工具（与 SSMS 等一起安装），通常不用于客户端计算机。

听起来您正在开发基于“拉”的导出。另一种选择可能是将数据从 SQL Server 集成服务推送到每台目标机器（或发布所需的数据并让客户端订阅它）。

否则，您可以编写一个基于 .Net（或其他）的应用程序，该应用程序利用 ADO 将数据拉下并将其写入文件。您有多种选择 - 您能提供一些更多关于你在什么环境中工作？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:40:20.450

不，基于拉的导出是我需要的。它用于大量数据。ADO 比 bcp 慢，否则我会考虑。我需要具有 SSIS 或 bcp 速度的批量数据传输功能。

没错，bcp 是一个 SQL 工作站工具，从未在客户端机器上使用过，这是我的难题。

Jeremy，C# 应用程序很好。

# c# - 如何在 C# 中捕获触发 DataGridView 上的“CellEndEdit”的击键？

> ID：774608
> 
> 赞同：5
> 
> 时间：2009-04-21T21:05:04.753
> 
> 标签：c#, .net, datagridview, keydown

我有一个设置为 EditOnF2 的 DataGridView。我在设置单元格值的 CellEndEdit 事件处理程序中对数据进行了一些特殊处理。我仍然希望 EditOnKeystrokeOrF2 在按下 Esc 键时恢复到原始值的功能。不幸的是，在 CellEndEdit 事件处理程序中，我看不到一种方法来判断导致 CellEndEdit 事件被触发的原因。如果未按下 Esc 键，我只想更改单元格的值。我怎么知道是不是？

编辑：值得注意的是，在编辑单元格时不会触发 KeyDown 事件，也不会触发最终结束的击键。

Edit2：我已经尝试过 KeyPreview 建议，但表单仍然没有捕获被按下的 Escape 键。

Edit3：我一直在尝试让这个工作。我最初将以下一些内容作为单独的帖子发布，但觉得将其包含在此处可能更相关。

我在 DataGridView 中有一个单元格，现在设置为 EditProgrammatically。为了捕获开始编辑的击键，我将 cell.Value 设置为等于击键。但是，这会破坏单元格的“转义”功能 - 当您按下转义键时，它不会恢复到原始值，而是恢复到我以编程方式插入到单元格中的击键。

我相信如果我可以在一个单元格上设置“EditedFormattedValue”，这将是我想要放置我的击键值的地方，但这似乎是只读的。我怎样才能完成我正在尝试的事情？

一个澄清的例子：如果单元格中有一个值“54.3”，我按下“9”键，它开始编辑单元格并在那里放置一个“9”。如果我点击 Escape，它不会恢复为“54.3”，而是恢复为“9”。我想要的是让它恢复到“54.3”的原始值。

所以，我试图从头到尾解决这个问题。我认为真正的问题是我正在覆盖原始值并且无法确定是否应该恢复它。

Edit4：看起来 CellValidating 可能值得使用，但是当我尝试它时，我看到了奇怪的行为。在一个新项目中，我创建了 DataGridView 并注册了各种事件，并看到 CellValidating 在 CellEndEdit 之前被触发。但是，在我试图让它工作的项目中，CellEndEdit 在 CellValidating 之前触发。关于可能有什么区别的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T21:12:41.193

将表单上的[KeyPrevew 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx)设置为 true；这将防止控件首先吞噬它。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-17T21:23:38.163

我的问题类似，这是我的解决方法：

`Problem:`当用户开始在 DGV 中编辑单元格值并在提交值 EndEdit 被调用之前按下 ESC 键时，它将所有 DGV 字段重新写入数据库，从而更新更新日期和时间字段，我只希望 DGV.EndEdit 在用户运行时运行实际上改变了值并且在这样做时没有按ESC。

`Solution:`在单元格验证中，我使用这样的标志[来](https://stackoverflow.com/questions/8899329/how-to-run-run-cellendedit-only-when-cell-valuechanged-in-datagridview/8899620#8899620)检查值是否已更改，如果标志值为 false，则只需`if(!flag)return;`在 EndEdit 上执行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-10T13:58:26.940

首先，你是绝对正确的，`KeyPreview`不会工作。起初，我认为我可以通过覆盖表单的[IsInputKey](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.isinputkey%28v=VS.100%29.aspx)方法来解决这个问题。这种技术在其他一些我无法抓住我需要抓住的钥匙的情况下对我有用。那也不起作用，所以我尝试在那里继承`DataGridView`和覆盖`IsInputKey`。那也没有用。在对我可以覆盖的其他方法进行了一些挖掘之后，我了解到我需要拦截另一类称为命令键的键。为此，请覆盖您的[ProcessCmdKey](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.processcmdkey.aspx)`DataGridView`（您需要对其进行子类化）。

这是我的代码：

```
public class CommandKeyInterceptingDataGridView : DataGridView
{
    protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
    {
        Debug.WriteLine(keyData);
        return base.ProcessCmdKey(ref msg, keyData);
    }
} 
```

以及使用 F2 进入编辑模式、修改单元格以说“Hello”并使用 Escape 取消编辑的输出。

```
F2
ShiftKey, Shift
H, Shift
E
L
L
O
Escape 
```

希望这能给你你所需要的。

# asp.net - 保护ajax调用

> ID：774615
> 
> 赞同：0
> 
> 时间：2009-04-21T21:07:19.977
> 
> 标签：asp.net, ajax, security

我需要从一个站点向另一个站点和服务器上公开的服务进行 ajax 调用，并且我需要确保它的安全，以便我确定该调用是来自客户端站点和表单的真正调用。

获得这个的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T21:09:58.767

我会在您的服务器上创建一个服务来调用另一个站点，并在那里实施任何类型的清理。许多浏览器甚至不允许跨站点 ajax 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T21:10:39.000

在安全范围的超高端，您可以让客户端应用程序的服务器使用私钥创建签名消息，并将该消息包含在客户端的 html 中。然后，ajax 调用将在其调用中转发该消息，此时 ajax 服务器可以进行验证。

最理想的情况是消息会更改为包含用户 ID、时间戳等，这样一个已知的好消息就不会被恶意客户端保存和重用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T21:16:57.177

有几种方法。

我倾向于让您的服务器代理请求，因此客户端只与您的站点对话。

1.  用户（使用您的客户端）向您的站点进行身份验证。
2.  客户端向您的服务器发出请求
3.  您的服务器将请求转发到远程服务器
4.  您的服务器将响应转发回客户端

# list - 如何将目标应用于 Ant 中的项目子列表？

> ID：774623
> 
> 赞同：3
> 
> 时间：2009-04-21T21:09:44.743
> 
> 标签：list, ant, path, fileset

我在各种目录中有一堆子项目。我想将它们指定为一个列表，然后对于给定的目标，我想逐个遍历每个目标并调用 subant。

我有类似的东西：

```
<target name="run">
    <subant target="run" failonerror="true" verbose="true">
        <fileset dir="${projectA}" includes="build.xml"/>
    </subant>
    <subant target="run" failonerror="true" verbose="true">
        <fileset dir="${projectB}" includes="build.xml"/>
    </subant>
</target> 
```

但是我必须为每个项目和每个目标集指定一个单独的子行。我要做的就是创建一个作为子项目列表的属性，并以某种方式使用它。它应该很简单，但是....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T21:22:51.217

您可以定义一个宏来执行此操作：

```
<macrodef name="iterate-projects">
    <attribute name="target" />
    <sequential>
        <subant target="@{target}">
            <filelist dir="${src_dir}">
              <file name="projectA/build.xml"/>
              <file name="projectB/build.xml"/>
              <file name="projectC/build.xml"/>
            </filelist>
        </subant>
    </sequential>
</macrodef> 
```

然后从另一个任何任务中，您可以按顺序在所有构建上调用目标，例如：

```
<target name="clean" description="Clean all projects">
   <iterate-projects target="clean"/>
</target> 
```

# c# - 客户端和服务器端之间的兼容加密库（JavaScript -> C# 或 Java）

> ID：774627
> 
> 赞同：0
> 
> 时间：2009-04-21T21:10:04.633
> 
> 标签：c#, javascript, encryption

有时 HTTPS 是不够的。特别是当我们谈论保护用户数据免受木马程序的访问时，他们可以在 winsock32 级别访问，他们可以在纯文本或 BHOs 对象中嗅探已经可以访问浏览器内存中解密的发布数据的 BHOs 对象。

在这个场景中，我开发了一个 JavaScript -> 经典的 asp 客户端服务器例程，其中 JavaScript 对 ASP 接收和解密的数据进行加密和发送。它工作得很好。

该解决方案采用 xICE 加密构建，可在 JavaScript 和 PHP 或 ASP 之间提供良好的兼容性。但是现在我正在迁移到 ASP.NET 或 Java，并且在 XICE 中没有这些环境的端口。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T21:41:28.257

我从来没有听说过xICE，所以我试图搜索更多信息。我发现的只是该公司发布的信息，以及一篇关于一种名为“ICE”的算法的文章，但没有明确的相关性。我找不到有关 xICE 使用的算法的信息。我找到的信息是 4 到 5 岁。

所有这些迹象都与“蛇油”密码学一致。您不太可能为其他平台找到任何信誉良好的兼容库提供商。

我建议使用众所周知的算法，例如 AES。提供支持客户端加密的免费 JavaScript 实现。就个人而言，我喜欢[“JavaScrypt”](http://www.fourmilab.ch/javascrypt/)的透明性（以及其作者的信条），但还有其他实现可能更快。

像这样的解决方案免费提供了更好的密码学和更容易与其他平台的集成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T21:53:07.493

从根本上说，SSL**就**足够了。或者更确切地说，尽可能好。

客户端可以通过 JavaScript 或其他方式看到的任何内容都可以被客户端上的木马等查看。

任何 JavaScript 加密都是默默无闻的安全性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T23:34:08.610

根据 JavaScript 库的不同，移植到 C# 可能很容易，但您可能想要运行并稍微重构一下。学习一门语言的最好方法之一是将一个库移植到它上面。否则，在 JS 中有很多用于 AES 等的实现。其中许多针对 ActionScript 和 JavaScript 进行了优化（与 EcmaScript 本身的一些细微差别）。

# asp.net-mvc - asp.net中的自动模型绑定

> ID：774634
> 
> 赞同：0
> 
> 时间：2009-04-21T21:11:39.777
> 
> 标签：asp.net-mvc, wcsf

我一直在使用 asp.net mvc，我喜欢 UpdateModel 和 TryUpdateModel 提供的功能。现在我正在使用 Web Client Software Factory 开发一个应用程序。我可以使用任何模型粘合剂吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T06:13:53.360

MVC 中的模型绑定器，与 MVC 基础设施非常相关。虽然可以将其调整为与 WebForms 一起使用，但我不知道今天有谁在这样做。

# c# - 只有在以下情况下，EditItemTemplate 中的控件才在 Page_Load() 中可用

> ID：774638
> 
> 赞同：1
> 
> 时间：2009-04-21T21:12:29.683
> 
> 标签：c#, asp.net, gridview, viewstate

在我的页面上，我定义了控件 TextBox1、Label1 和 GridView1。在 GridView1 中，我定义了以下模板：

```
 <asp:TemplateField>

              <ItemTemplate>
                <asp:LinkButton runat="server" Text="Edit" CommandName="Edit" ID="cmdEdit" />         
              </ItemTemplate>

              <EditItemTemplate>
                <asp:TextBox Text='<%# Bind("Notes") %>' runat="server" id="textBoxNotes" />
                <br /><br />
                <asp:LinkButton runat="server" Text="Update" 
                 CommandName="Update" ID="cmdUpdate" /> 
                <asp:LinkButton runat="server" Text="Cancel" 
                 CommandName="Cancel" ID="cmdCancel" />
              </EditItemTemplate>

            </asp:TemplateField> 
```

如果用户在 textBoxNotes 中输入文本并单击 cmdUpdate 按钮，则在回发时调用 Page_Load() 时该文本将已经可用。

因此，如果用户在点击更新按钮 cmdUpdate 之前，还在 TextBox1 中输入了一个字符串“something”，那么下面的代码将提取用户在 textBoxNotes 中输入的文本

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if(TextBox1.Text=="text from Notes")
        Label1.Text =((TextBox)gridEmployees.Rows[0].Cells[0].FindControl("textBoxNotes")).Text;
    } 
```

A) 下面的代码也应该提取用户输入到 textBoxNotes 中的文本，但是当我单击 cmdEdit 按钮时，我得到“对象引用未设置为对象的实例”。例外

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if(IsPostBack)
        Label1.Text =((TextBox)gridEmployees.Rows[0].Cells[0].FindControl("textBoxNotes")).Text;
    } 
```

为什么我会得到这个异常？看起来好像 textBoxNotes 不存在。但它为什么不存在呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T04:51:38.100

当 Update 事件发生时，该行不再处于编辑模式。因此页面上不存在 textBoxNotes。使用 gridview 的 RowUpdating 事件处理程序来访问编辑模板控件。

```
public void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
     TextBox1.Text = ((TextBox)GridView1.Rows[e.RowIndex]
                              .FindControl("textBoxNotes")).Text;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-15T16:23:54.923

您在 Page_Load 中引用的方式发生在 gridview 的行实际存在之前。因为它发生在 PostBack 上，所以必须从 ViewState 重新创建 GridView（和触发事件）（重新：填充其行）。虽然页面上的对象已经被初始化并且它们的值已经被填充，但是 GridView 还没有被重新创建并且它的事件还没有被触发。

正如博士所说，这应该在 RowUpdating 事件中完成。

# sql-server - 带有约束的 SQL Server 2000 删除列

> ID：774644
> 
> 赞同：4
> 
> 时间：2009-04-21T21:13:59.117
> 
> 标签：sql-server, sql-server-2000

[我遇到](https://stackoverflow.com/questions/314998/sql-server-2005-drop-column-with-constraints)了与此问题中描述的相同的问题，但它是 SQL Server 2005，并且“已接受”的答案在 SQL Server 2000 中不起作用。

具体来说：我正在尝试运行`ALTER TABLE foo DROP COLUMN bar`，但它失败了，因为有一个“默认约束”。意思是，我在该列上有一个默认值，SQL Server 将其作为一个单独的约束实现，我需要先删除它。

问题是在创建列时没有为默认约束指定名称，因此我必须查询系统表以发现约束的（自动生成的）名称。

另一个问题中给出的答案在 SQL Server 2005 中对我有用，但在 SQL Server 2000 中不适用。我需要后者。

[更新] 我需要一个可以回答“表中列的默认约束的名称是什么”问题的*查询*。不是人类手动找到答案的方法。`bar``foo`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T21:33:55.980

刚刚弄清楚引用的 SQL 2005 查询实际上在做什么。这是在 SQL 2000 中工作的该查询的复制

```
select 
    col.name, 
    col.colorder, 
    col.cdefault, 
    OBJECTPROPERTY(col.cdefault, N'IsDefaultCnst') as is_defcnst, 
    dobj.name as def_name
from syscolumns col 
    left outer join sysobjects dobj 
        on dobj.id = col.cdefault and dobj.type = 'D' 
where col.id = object_id(N'dbo.table_name') 
and dobj.name is not null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T21:28:20.830

要获取表的默认约束列表，请尝试此操作

```
select * from sysobjects [constraint] 
 join sysobjects [table] on [constraint].parent_obj = [table].id 
where [constraint].type = 'D'
 and [table].name = 'table_name'
--another option: and [table].id = OBJECT_ID(N'dbo.table_name') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T21:25:26.373

```
sp_help 'tablename' 
```

为您提供有关表的大量信息 - 包括所有约束和约束名称

实际上 sp_help 称之为：

```
sp_helpconstraint 'tablename', nomsg 
```

默认约束将显示“第 xxx 列的默认值”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T21:40:53.950

这个是在 bdukes 提供的第一个解决方案之上构建的，与 information_schema.columns 混合，似乎 info 包含默认所属列的序号位置

```
SELECT name 
FROM sysobjects [constraint] 
 JOIN sysobjects [table] on [constraint].parent_obj = [table].id
 JOIN information_schema.columns col ON [table].name = col.table_name AND [constraint].info = col.ordinal_position
WHERE [constraint].type = 'D'
 AND [table].name = 'table_name'
 AND col.column_name = 'column_name' 
```

# entity-framework - Ado.Net 实体数据模型未正确更新

> ID：774645
> 
> 赞同：6
> 
> 时间：2009-04-21T21:14:00.647
> 
> 标签：entity-framework

我已经完成了以下步骤： - 打开 Visual Studio
- 创建新项目
- 选择“ADO.Net 实体数据模型”
- 将其指向现有数据库
- 接受所有默认值。
- 然后将“Model1.edmx”文件添加到我的解决方案和相应的“Model1.Designer.cs”文件中。

但是在输出中我收到以下错误：
“错误：由于以下异常而无法生成模型：'值不在预期范围内。'。”

我之前已经从这个数据库创建了一个模型，所以我不认为错误是复杂表设计的结果（事实并非如此）。

有没有其他人遇到这个错误？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-11T18:33:56.167

我有一个类似的问题。原因很简单。我忘记在我的一张表中设置主键。希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-24T04:32:15.987

我在使用 Ria 服务的 MYSQL 数据库中遇到了同样的问题。

**解决方法：**
我发现实体模型在导入多张表时，至少需要一张表的主键。
我的表的主键也设置为自动递增。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T21:35:35.057

好的....
我想我可能有一个解决方案。我刚刚完成了以下操作，它奏效了。

*   创建一个新项目
*   向其中添加一个 Ado 数据模型。
*   所以项目中唯一的东西就是模型，它不引用任何其他项目，所以它可以独立存在和构建。
*   我在这个项目中遇到了上面提到的错误
*   删除 Model1.edmx 文件。
*   删除对“System.Data.Entity.dll”的项目引用（这是关键）
*   从“App.config”中删除连接字符串
*   重建项目
*   将“ADO.Net 实体数据模型”添加回您的项目。

现在可以了。
不紧张。
但它有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T18:58:34.380

好的。
我能够阅读它。这就是我所做的。

上述要点中的所有步骤加上：

*   关闭 Visual Studio 2008
*   重启 Sql Server 2005
*   重新打开 Visual Studio 08。

仍然为如何解决这个问题感到困惑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-22T13:38:43.187

当我在单击 model.edmx 文件时无法打开“设计视图”时，我在 VS2008 中卸载项目，然后再次加载它，它似乎解决了这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-08T23:21:59.937

请检查是否已经为表定义了主键。如果您在 xml 编辑器中打开实体模型，您应该能够看到注释错误消息，该注释可能对您有所帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-05T02:57:06.743

您可以先将一个表添加到模型中，然后在创建 edmx 文件时，您可以从数据库中更新模型。它对我有用。我希望它也能解决你的问题。

干杯帕明德

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-16T12:47:21.633

我刚刚研究了一个类似的问题。事实证明，Entity Framework在 Visual Studio 的窗口 `Messages`部分中输出了额外的错误信息。`Error List`

`Output`如您所见，它比出现在窗口中的一般错误有用得多。这对于帮助我解决问题至关重要。

![在此处输入图像描述](https://i.stack.imgur.com/lJnHM.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-20T15:37:29.673

我有同样的问题 。

原因似乎很简单：缺少主键列。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-20T15:21:28.937

我遇到了同样的问题，简单的解决方案是：从 Visual Studio 中删除您的模型和具有相同名称的新 ado.net 模型，然后从配置文件中删除所有连接字符串

# jquery - Vista 侧边栏小部件 + jQuery = 弹出问题

> ID：774647
> 
> 赞同：1
> 
> 时间：2009-04-21T21:14:34.810
> 
> 标签：jquery, windows-desktop-gadgets

我创建了一个 Vista 侧边栏小部件，它使用 jQuery 获取 XML 并在小工具的主 HTML 中显示 XML 响应的一些基本细节（事件的日期）。但是，一旦用户单击链接，我就很难让弹出页面正常工作（或完全正常工作）以显示详细信息。

由于我将 XML 响应传递给浮出控件，因此我为整个应用程序使用了一个 .js 文件。我不能使用 $('document').ready() 函数，因为它适用于浮出控件并且浮出控件根本不显示。所以我创建了两个初始化函数：

mainInit 处理与主应用程序上的 .ready() 相同的职责，而 flyInit 处理浮出控件的 .ready()。

只要 mainInit 就位，应用程序就可以正常工作，为主应用程序文档和身份验证添加事件处理程序。但是，当我单击详细信息的链接时，无论 flyInit 函数中有什么，浮出控件都不会出现。

我试图了解 Vista Sidebar 应用程序的基本结构 - 在一个 .js 文件中注册的全局变量是否可用于小工具中的所有 HTML 页面？我尝试通过使用 jQuery 或纯 ol' js 操作 System.Gadget.Flyout.document 来处理弹出窗口，但没有效果。

书籍对于小工具来说非常薄弱，而 MSDN 毫无用处。我已经拆开其他应用程序并遵循教程，但它似乎对我不起作用。

另外：我有一个奇怪的问题，因为我已经多次重新安装这个小工具来测试它，Vista 正在使用来自当前迭代的先前迭代的背景图像。我已经从 settings.ini 文件中清除了有关我的小工具的所有内容 - 但我是否还需要进入注册表并将其清除？我在想也许这种堆积的废话是什么让事情无法正常工作。

这是一个很长的问题，我很抱歉。我对此感到非常沮丧，如果这不是一场付费演出，我会像一块滚烫的石头一样放弃它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T21:18:54.290

考虑记录整个 System.Gadget.Flyout.document.parentWindow。事物。这就是答案，伙计们。通过使用上述命名空间，您可以从您的 Vista 小工具的父 index.html 中使用全局注册的变量和函数。

# c# - 需要示例触发并忘记对 WCF 服务的异步调用

> ID：774648
> 
> 赞同：12
> 
> 时间：2009-04-21T21:14:54.950
> 
> 标签：c#, wcf, asynchronous

在预定的时间间隔内，我需要异步调用 WCF 服务调用另一个 WCF 服务。安排对我制定的 WCF 服务的调用。

我认为我需要什么，并且我在 stackoverflow 上读到过，有必要……，（本质上）准备或更改 WCF 服务的代码，以便能够处理对它们的异步调用。如果是这样，一个简单的例子会是什么样子？（可能是之前和之后的例子）在.Net 3.5中仍然需要它吗？

其次，我使用来自 WCF 服务的代理来调用下一个 WCF 服务，如果它看起来与典型异步示例的 BeginEnvoke 和 EndEnvoke 的典型情况不同，则需要一个对 WCF 服务的异步调用示例。

如果我完全不在我的问题上，我会相信它，并且希望任何更正以建立一个更好的问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-21T21:25:49.103

[在您调用的 WCF 方法上，将 OperationContract 特性的IsOneWay](http://msdn.microsoft.com/en-us/library/system.servicemodel.operationcontractattribute.isoneway(v=vs.110).aspx)属性设置为 true。这告诉 WCF 调用只对一个方向重要，客户端不会等待方法完成执行。

即使在调用 BeginInvoke 时，您的客户端代码仍会等待服务器方法完成执行，但它会在线程池线程上执行此操作。

```
[ServiceContract]
interface IWCFContract
{
   [OperationContract(IsOneWay = true)]
   void CallMe()
} 
```

另一种方法是让 WCF 服务将其工作转移到后台线程并立即返回。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-21T21:33:52.627

请务必仔细测试 OneWay WCF 调用的执行方式。当您达到 X 个同时呼叫时，我已经看到它停止了，就好像 WCF 实际上确实在等待呼叫结束一样。

一个更安全的解决方案是让“目标”代码尽快返回控制：与其让它完全处理调用，不如让它只将数据放入队列并返回。让另一个线程轮询该队列并异步处理数据。

并确保应用线程安全机制以避免在该队列上工作的两个线程之间发生冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-02T18:24:33.153

不要为您的模式使用 BeginInvoke 甚至线程。确保根据 Microsoft 网站使用 AsyncPattern 装饰您的类，否则您的 Async 委托和线程将以同步模式运行。WCF 强制执行此行为。此信息是由另一个操作员发布的，他找到了解决堆栈上的阻塞回调问题的解决方案.. 抱歉，但我不记得链接了。

# apache-flex - Flash 绘图库

> ID：774649
> 
> 赞同：-1
> 
> 时间：2009-04-21T21:14:55.667
> 
> 标签：apache-flex, flash, graph, data-visualization, gnuplot

随着时间的推移，我收集了一堆数字统计数据。

我需要在 HTML 页面中将其作为折线图显示给用户。我想在客户端上渲染图形。如果图形是交互式的（允许用户缩放、滚动、切换图形线的可见性等），那将是完美的。

有没有适合 Flash / Flex（或者，也许是带有 Canvas 的 JavaScript）的免费图形绘制库？

我更喜欢类似 gnuplot 的东西，但会处理任何足够理智的东西。

**更新：***除了* [Flare](http://flare.prefuse.org/)之外的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T21:17:45.427

Actionscript 3有[Flare。Flex](http://flare.prefuse.org) Professional 也有一个图表库（但不是免费的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T21:19:32.973

我想到了两个（免费）库：

*   [Dojo 图表](http://www.sitepen.com/blog/2008/06/06/a-beginners-guide-to-dojo-charting-part-1-of-2/)(Javascript + Canvas)
*   [打开 Flash 图表](http://teethgrinder.co.uk/open-flash-chart/)(Flash)

# gwt - 从不同的选项卡添加 GWT 选项卡

> ID：774654
> 
> 赞同：0
> 
> 时间：2009-04-21T21:15:29.863
> 
> 标签：gwt

我想从内容区域内向某个标签栏添加一个标签。内容区域是动态的，因此位于不同的类文件中。我知道获取标签栏当前状态的唯一方法（不是创建新的标签栏对象）是创​​建一个静态方法和变量来访问该对象。但是，在我得到它之后，我在对标签栏进行任何修改时遇到了问题。我可以毫不费力地调用其中的函数，例如检索字符串，但我无法添加选项卡，这是我需要做的。这是一般要点：

在一个名为 XYZ 的类中：

```
private static MyPersonalTabPanel mypersonalTabPanel;

public XYZ {
  myperosonalTabPanel = this;
} 
```

在我的另一个文件中，单击一个按钮，我触发了这个：

```
MyPersonalTabPanel.getAppInstance().getXYZTabPanel().add(mywidget, "My Widget"); 
```

我可以毫无错误地使用我的函数“getXYZTabPanel()”，但是当我尝试“添加”时，它只会以白屏崩溃，没有相关错误。有什么帮助吗？我以前见过项目添加选项卡，但找不到任何通过这样的静态对象进行的操作。

我在 onClick 方法中还没有这个，我必须这样做才能访问静态会话变量吗？它基本上是在页面加载的那一刻被调用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T22:06:58.137

检查您的初始化顺序？您需要确保要添加选项卡的 XYZ 实例是您最近调用“new XYZ()”创建的实例，并且您需要确保它在您之前已经被新建尝试添加选项卡。

另外，我假设 XYZ 扩展了 MyPersonalTabPanel，它扩展了 TabPanel？澄清一下，此代码是否适用于您的情况：

```
public class MyPersonalTabPanel extends TabPanel {
  public static MyPersonalTabPanel instance;

  public MyPersonalTabPanel() {
    instance = this;
  }
}

public class TestClass {
  public void createPanel() {
    RootPanel.get().add(new MyPersonalTabPanel());
  }
  public void addTab(Widget widget) {
    MyPersonalTabPanel.instance.add(widget, "My Widget");
  }
} 
```

确保在 addTab(Widget) 调用发生之前调用 TestClass 的 createPanel()。

# ruby-on-rails - 我应该如何升级 Rails 应用程序以使用最新版本的 Rails

> ID：774658
> 
> 赞同：4
> 
> 时间：2009-04-21T21:17:43.693
> 
> 标签：ruby-on-rails, upgrade

我正在开发一个目前使用 Rails 1.2 的 Rails 应用程序，所以我现在距离最新的稳定版本（Rails 2.3）还有很长的路要走。

我应该如何进行迁移到更新版本的 Rails 的过程？

我应该一次升级一个版本还是直接升级到 Rails 2.3？

我如何找出 Rails 版本之间的变化，两者

*   让我有更多升级理由的改进或新功能
*   Rails 更改需要我修改我的应用程序才能与新版本一起使用。

（我在升级机制上看到过[这个问题](https://stackoverflow.com/questions/184550/what-do-i-need-to-do-to-upgrade-an-application-to-the-latest-rails-version)，但我更感兴趣的是我应该经历的过程，以使升级尽可能轻松。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T01:58:04.817

几个月前我经历了这件事，做了很多研究并整理了一个 rake 任务（基于其他人的脚本和其他资源），这可能会帮助您标记代码中需要更改的内容。这是为了升级到 Rails 2.2，所以它不考虑 Rails 2.3 的变化：

[http://gist.github.com/99535](http://gist.github.com/99535)

哦，请务必检查您使用的插件和 gem 是否与 Rails 2.x 兼容并使用最新版本。

而且我绝对同意一次性直接升级到 Rails 2.3。不要一直拖延；不升级的时间越长，它就越困难，因为会发生更多变化。而且维护 Rails 1.x 代码更加困难，因为支持它的资源较少。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T23:09:18.263

我的建议是花一周时间偿还你积累的所有测试债务，然后一举完成升级。

在我工作的地方，我们去年夏天将一个非常大的应用程序从 1.2 升级到了 2.0.2，同时升级到了 Ruby 1.8.6。

花费的时间比预期的要长得多。该应用程序使用了一些已被删除或弃用的旧功能（如 ActionWebService），因此转换这些功能需要一些时间。但大多数情况下，我们遇到了很多细微的错误，例如单选按钮参数的工作方式略有不同，其中一些是由于 Ruby（与 Rails 相比）升级造​​成的。

该应用程序的某些部分的测试覆盖率参差不齐。如果我们进行了更好的测试，一切都会容易得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-07T10:49:40.240

我刚刚开始将 Rails 1.2.3 应用程序升级到 Rails 2.3.4 环境。我遇到的基本步骤和注意事项是：

*   创建一个类似于您的基本应用程序的框架应用程序
*   检查您在旧应用程序中的任何`environment.rb`设置，以查看新版本是否需要这些设置。
*   将所有 .rhtml 文件迁移到 .html.erb；使用脚本或手册。就我而言，有 100 多个文件，因此自动化更容易
*   `routes.rb`鉴于 RoR2.3.4 已简化指定路线，请检查可能需要进行的任何更改。
*   确保您手头有一个良好的 SCM 系统；例如 Git、SVN 甚至 CVS，以便可以捕获小的增量更改。
*   检查您需要的插件。一开始我只是删除了所有插件，实际上有些插件对于要在移植的应用程序中实现的功能已经过时了。
*   更新任何`form_tag`条目；例如`<%= form_tag :action => 'search' %>`变成 `<% form_tag :action => 'search' do %> 否则你会得到一些有趣的错误信息
*   同样将`<%= end_form_tag%>``<% end %> 更改为关闭块
*   检查您是否有 1.2.3 版本中的任何插件，这些插件现在已从核心中删除，并且必须作为插件安装并针对依赖项进行配置。我对弹出窗口的`in_place_edit`和调用有一些问题。`calendar`

正如其他人所说，它可能需要比预期更长的时间。我已经完成了大约 30 小时的迁移工作。我估计需要更长的时间。所以这很好；但在生成 PDF 方面仍有一些工作要做。

只是为了让应用程序在 MS-Windows 环境中运行更有趣；Ruby 1.8.7、Rails 1.2.3 和 MS SQL Server。目的是迁移到 Linux 环境；Ruby 1.9.x、Rails 2.3.4 和 MySQL 数据库等涉及到 MySQl 服务器数据库迁移工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T21:28:40.953

我认为您可以获得一些 Rails rake 任务，这些任务将在您的应用程序中寻找弃用。

只要您的应用程序处于版本控制中，我就会一次性完成升级，并一次查看一条错误消息。

此外，除了您看到的 2.2 和 2.3 的发行说明页面外，源本身中还应该有发行说明或更改日志。另外，您可以使用“rails xxx 新功能”等搜索词搜索博客文章（使用 google 博客搜索）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T21:25:01.837

我将首先用我通过谷歌搜索找到的资源回答我自己的问题。[Rails 2.2 发行说明](http://guides.rubyonrails.org/2_2_release_notes.html)和[Rails 2.3 发行说明](http://guides.rubyonrails.org/2_3_release_notes.html)详细介绍了这两个发行版中的新功能和更改功能，但我找不到任何早期版本的明确信息。

除了[这个发布公告](http://weblog.rubyonrails.org/2009/3/16/rails-2-3-templates-engines-rack-metal-much-more)提到旧版本的Passenger 不能与Rails 2.3 一起使用之外，我还没有发现太多关于升级时会出现什么问题的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-06T14:07:57.793

我发现那些文档缺少一些细节，从 2.1 => 2.2 迁移需要相当长的时间。这是我的笔记：

最大的时间槽：`assert_redirected_to`发生了显着变化，不再支持哈希（完全？）

*   [灯塔入口](http://rails.lighthouseapp.com/projects/8994/tickets/1490-assert_redirected_to-is-too-strict)
*   [更多关于 Rails 2.2.2 下 assert_redirected_to 的问题](http://tjhanley.com/wp/2009/01/31/rails-22-assert_redirected_to-partial-matching/)

另外，需要设置`environment/test.rb`禁用防伪保护

如果有人有关于 2.3 的这些要点的消息，那就太棒了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-13T02:42:55.800

在这一点上，你可能已经有很多经验了，但是我在搜索不同的 Rails 1.2>2.3 升级问题时遇到了这个问题，并认为我自己会提出一些建议：

我在一个相对简单的应用程序中最大的突破是使用 Pagination。我发现 Classic Pagination 插件是天赐之物。

# c - C多线程起源

> ID：774661
> 
> 赞同：5
> 
> 时间：2009-04-21T21:18:23.350
> 
> 标签：c, multithreading

[在我的C Programming Language](https://rads.stackoverflow.com/amzn/click/com/0131103628) （又名：K&R）副本中，似乎没有提到多线程。这本书是不是没有我想象的那么完整？多线程是在写出来之后出现的吗？我在想这个错误的方式吗？

多线程的概念在哪里适合 C 世界？

* * *

**编辑：**我认为我原来的问题是：

*   你可以用 C 写任何东西
*   存在多线程
*   你不能用 C 编写多线程 <--*逻辑矛盾*

造成这种矛盾的原因是什么？多线程的起源在哪里？如果是POSIX，那么如果不是C，那么POSIX是用什么写的？C 无法访问的一种汇编形式？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-21T21:20:08.463

C是一种相当低级的语言。对典型 C 程序中的线程的支持来自操作系统，而不是来自 C 运行时 - 如果您的环境不支持线程，那么您必须自己实现它们，找到一个可以实现它的库，或者不使用线程。这与像 Java 这样的语言形成对比，其中运行时环境提供了许多服务，这些服务保证可用于 Java 程序，无论底层操作系统是否以 Java 平台公开的方式支持它们。

现在，话虽如此，我很确定当 K&R 的第一版出版时，Unix 不支持线程。由于 C 最初是作为 Unix 环境的系统语言实现的，因此它没有本机线程支持也就不足为奇了。

如果您正在为类似 Unix 的环境编写代码，如果您需要支持良好的 API 以在 C 中实现多线程程序，请寻找 POSIX 线程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-21T21:23:25.053

本书已完成。C 能够运行线程，但只有在它所在的运行时的支持下。C 本身并不支持很多东西。例如，如果您想打开一个文件或从鼠标获取输入，您将需要一个库来为您提供支持。这在某种程度上很好，因为这意味着 C 可以在小型嵌入式计算机上运行，​​并且不需要大量内存来存储您可能想要或不想要的功能。

多线程在 C 之前就已经存在了。（根据这个：[http](http://www.cs.clemson.edu/~mark/multithreading.html) ://www.cs.clemson.edu/~mark/multithreading.html ）

你需要一个线程库。例如，在 Windows 上，您可以：

```
#include "Windows.h"

int main()
{
   CreateThread(/*Google the function for details of the parameters.*/);   
   return 0;
} 
```

您需要下载 windows 平台 sdk 才能做到这一点。大多数平台都有某种 sdk，它有一个库，其中包含一些用于创建线程的函数。大多数都有一个 CreateThread 风格的函数，您可以在其中传递一个函数的地址，您希望新启动的线程开始与在主函数上开始的当前线程并行运行。

您可能想要查找的标准化线程库是 posix。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-21T21:24:35.783

如果我没记错的话，多线程实际上比 C 编程语言晚得多。[POSIX 线程](http://en.wikipedia.org/wiki/POSIX_Threads)库是在 Unix/Linux 程序中执行多线程的典型方法，它不是标准库的一部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T21:35:04.637

C 和 C++ 语言不包括内置线程库。因此，不同的平台有不同的线程范式（PThreads、WinAPI CreateThread(..) 函数、MFC 线程等）。

C++0x似乎[将包含一个标准线程库。](http://en.wikipedia.org/wiki/C%2B%2B0x)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T21:25:09.107

多线程（或多处理）肯定在此之前出现。然而，即使是现在，编程语言中的多线程支持也很少，尤其是 C 语言没有。所以我认为你应该读一本关于例如的书。POSIX 线程，或任何支持您的环境的线程（线程库现在彼此非常相似，至少在它们的同步原语的原则上；像 RCU 这样的奇怪东西只在特定环境中使用）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-21T21:26:26.527

它确实在我的副本（第 2 版）的引言章节（第 2 页）中提到了它：

> 同样，C 仅提供简单的单线程控制流：测试、循环、分组和子程序，但不提供多道程序、并行操作、同步或协程。

# asp.net - ASP.NET 运行时错误：长度不能小于零。参数名称：长度

> ID：774663
> 
> 赞同：1
> 
> 时间：2009-04-21T21:18:42.380
> 
> 标签：asp.net, visual-studio-2008

我在 vista 业务上使用 Visual Studio 2008。我们刚刚从 xp 升级。现在，当我打开一个 Web 项目时，我收到了这个错误

> ASP.NET 运行时错误：长度不能小于零。参数名称：长度<

在这行代码的每个 .aspx 文件中：

```
<%@ Page Language="C#" MasterPageFile="~/Site.master" AutoEventWireup="true" CodeFile="ContactNotes.aspx.cs" Inherits="ContactNotes" Title="Contact Note" %> 
```

这在新安装后开始发生，有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T21:58:52.550

听起来像一个 Web.config 问题。我记得在 ASP.NET 成员资格提供程序部分中遇到了这个错误，我们对最小密码长度有限制，或者类似的东西。这导致了那个错误。寻找类似的东西。我知道这相当模糊，但也许它会引导你朝着正确的方向前进。

# stored-procedures - 如何使用 SubSonic 编写此代码？

> ID：774666
> 
> 赞同：0
> 
> 时间：2009-04-21T21:19:46.340
> 
> 标签：stored-procedures, ado.net, subsonic

我有一些遗留代码，我正在使用 SubSonic 重写以帮助未来的维护者。在大多数情况下，它相对简单，因为一切都进行了存储过程调用。但是现在我在使用一些紧密耦合的 ADO.NET 代码时遇到了一些困难。

该代码取决于 SqlDataAdapter 来决定何时调用 INSERT 或 UPDATE 存储过程，我理解。如何以 SubSonic 的方式重写此代码？

```
public void SaveInvoice(InvoiceItems invoiceItems)
{
    // extraneous code removed
    // invoiceItems is a dataset

    cmd.CommandType = CommandType.StoredProcedure;
    cmd.CommandText = "InvoiceItem_INSERT";
    cmd.Connection = conn;

    updateCmd.CommandType = CommandType.StoredProcedure;
    updateCmd.CommandText = "InvoiceItem_UPDATE";
    updateCmd.Connection = conn;

    SqlCommandBuilder.DeriveParameters(cmd);
    SqlCommandBuilder.DeriveParameters(updateCmd);

    adapter.InsertCommand = cmd;
    adapter.UpdateCommand = updateCmd;

    adapter.Update(invoiceItems._InvoiceItemTable);
} 
```

我是 SubSonic 的新手，因此不胜感激。所有有用的答案都将得到热烈的支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T21:59:08.697

使用 SubSonic 不会有这种代码的精确表示，因为自动插入/更新是由该`SqlDataAdapter.Update()`方法专门完成的。如果不知何故，埋在 SubSonic 命名空间的某个地方，我也想知道如何使用它！

如果您正在处理一张表（例如`InvoiceItems`），您可以自己进行测试（这使用 SubSonic 的自动生成的活动记录实现）：

```
int key = InvoiceItems.ID; // not sure what your primary key identifier is called
InvoiceItem item = new InvoiceItem(key);
if (item != null)
{
    SPs.InvoiceItem_UPDATE(param1, param2, etc).Execute();
}
else 
{
    SPs.InvoiceItem_INSERT(param1, param2, etc).Execute();
} 
```

希望这能让你开始。

作为一个完全不相关的旁注，[不要依赖该`DeepSave()`方法](http://forums.subsonicproject.com/forums/t/4249.aspx)来尝试跨多个表保存，因为它没有实现。我发现这很难...

# svn - 我如何学习有效地使用 SVN？

> ID：774677
> 
> 赞同：1
> 
> 时间：2009-04-21T21:23:19.407
> 
> 标签：svn

我刚刚问了一个[关于 SVN的](https://stackoverflow.com/questions/774540/how-do-i-know-which-files-in-a-directory-arnt-in-my-svn-repository)*rtm*有价值的问题。我使用 SVN 已经好几年了，我管理着多个用于不同项目的存储库；显然，我一直在设法通过对 SVN 客户端应用程序的简单掌握来过关。

我如何进入下一个级别（有效的 SVN 工作流程）？当我不亲自认识任何可以指导我并给我指点的人时，我如何学习掌握应用程序。是否有任何资源（除了手册及其示例）来帮助我学习在基础知识之外使用它（向我展示为什么/何时我想要使用高级命令等）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T21:26:23.953

在网络或 pdf 上免费阅读[SVN-Book 。](http://svnbook.red-bean.com/)获得良好的服务器实现（如[VisualSVN](http://www.visualsvn.com/server/)）。并与使用它的人交谈。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-21T21:26:08.637

加入一个开源项目。您将学到很多关于他们如何使用版本控制系统来管理他们的版本，例如标记/分支/合并等。这就是我十年前通过查看 OpenBSD 发布过程学会使用 CVS 的方式。:-P

当然，现在很少有项目仍然使用 CVS；你可能会学习 Subversion、Git 或 Mercurial。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-21T21:29:16.320

我强烈推荐[使用 Subversion 的实用版本控制](https://rads.stackoverflow.com/amzn/click/com/0977616657)。这是一本介绍性的书，但它确实有很多关于 Subversion 最佳实践的好话要说。通过阅读本书，我学到了很多关于如何最好地在 SVN（以及其他版本控制系统）中组织和维护项目结构的知识。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T21:26:41.770

我建议你阅读[免费的颠覆书](http://svnbook.red-bean.com/)。它真的很值得一读，因为它介绍了基本的版本控制主题，然后（当然）详细介绍了颠覆（从基本使用到高级和管理任务）。

另外，如果你在 windows 上工作，我建议你使用[TortoiseSVN](http://tortoisesvn.net/)作为 subversion 客户端。并查看[TortoiseSNV 的帮助](http://tortoisesvn.net/docs/release/TortoiseSVN_en/index.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T21:31:36.563

虽然一般来说只提供参考来回答问题是不好的形式，但无论如何我都会这样做。

[http://svnbook.red-bean.com/en/1.5/svn-book.pdf](http://svnbook.red-bean.com/en/1.5/svn-book.pdf)

这本书很棒。我先玩了一点颠覆，然后读了这本书，它对进入创作者的头脑有很大帮助。

此外，在本地创建自己的存储库，并根据您在书中阅读的内容尝试不同的东西。不要为此使用真实数据，除非它是副本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-30T13:37:48.553

也是关于 SVN 的一个很好的来源。您可以从此链接[http://tortoisesvn.net/support.html下载文档](http://tortoisesvn.net/support.html)

# regex - 学习中高级正则表达式的好教程？

> ID：774690
> 
> 赞同：7
> 
> 时间：2009-04-21T21:26:10.537
> 
> 标签：regex, language-agnostic

所以我熟悉正则表达式的基础知识，但我正在寻找好的教程来学习基础知识之外的任何东西。我也很感激任何指向交互式问题的链接，我可以在其中输入正则表达式并查看它们是否解决了它。即使是我可以尝试通过自己的编码解决的中级或高级问题的想法也会很棒。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-21T21:29:25.570

这是学习正则表达式的零基础：

[正则表达式教程](http://www.regular-expressions.info/tutorial.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-21T21:31:40.150

“[掌握正则表达式](http://oreilly.com/catalog/9780596528126/)”，作者 Jeffrey EF Friedl。是的，这是一本书而不是在线教程，但是非常好……

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-21T21:32:11.070

我真的可以推荐[www.regular-expressions.info](http://www.regular-expressions.info)和[RegexBuddy](http://www.regexbuddy.com/)。Regexbuddy 是一个很棒的工具，可以帮助你用各种语言编写正则表达式。它还具有为您解释正则表达式的功能。

![替代文字](https://images.betanews.com/screenshots/1131007638-1.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-21T21:29:52.260

[正则表达式信息](http://www.regular-expressions.info/tutorialcnt.html)涵盖了正则表达式的各个方面。

还有一些用户发布的[高级正则表达式](http://wiki.tcl.tk/21360) **示例以测试您的知识**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-21T21:39:01.193

我经常回来的一个程序是[RegexDesigner](http://www.sellsbrothers.com/tools/#regexd)。这是一个非常简单的工具，可让您编写、测试和保存正则表达式；很像上面的 RegEx Buddy，但更简单且免费。它还生成 C# 和 VB.NET 代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-21T21:48:33.167

如何在 emacs 中重新构建器

[替代文字 http://img4.imageshack.us/img4/9887/rebuilder.png](http://img4.imageshack.us/img4/9887/rebuilder.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-29T09:59:17.063

中级到高级正则表达式？...在​​这里。

[http://www.asiteaboutnothing.net/regexp/](http://www.asiteaboutnothing.net/regexp/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-21T21:31:38.870

在这里，您有一个正则表达式库。这并不完全符合您的要求，但无论如何您可能会发现它很有用：[http ://regexlib.com](http://regexlib.com)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-20T06:53:28.250

这是 我最近编写[的 Python 快速和高级正则表达式教程。](http://www.cofoh.com/quick-advanced-re-tutorial-python)它涵盖了很多小尺寸的信息，我付出了很多努力使它变得更好。

如果您想立即测试，可以在线加载代码片段。

# c# - 如何使用按键导航数据网格？

> ID：774692
> 
> 赞同：1
> 
> 时间：2009-04-21T21:26:22.770
> 
> 标签：c#, datagrid, navigation

在我看来，我记得我的 DataGrid 曾经能够将我带到已排序列的第一行，其文本以与按下的键相同的字母开头，即键入“k”，光标将位于该行以“肯尼”为内容。我不知道我是否不小心禁用了此属性，或者将此功能与我已经以这种方式导航的树视图混淆了。是否有我无意中禁用的属性？另外，这个功能的官方术语是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T19:09:01.857

我认为 DataGrid 类中没有内置功能可以执行此操作。我发现覆盖 Datagrid 类的 OnKeyDown 或 OnKeyPress 可以很容易地模拟这一点。

`
类 NavDataGrid : System.Windows.Forms.DataGrid { 保护覆盖无效 OnKeyDown(System.Windows.Forms.KeyEventArgs ke) { base.OnKeyDown(ke); //这里处理导航
} }

`

# .net - 跨负载平衡服务器的选择性缓存清除 (ASP.Net)

> ID：774695
> 
> 赞同：8
> 
> 时间：2009-04-21T21:26:34.017
> 
> 标签：.net, asp.net, architecture, caching, load-balancing

我们有一个在两台负载平衡服务器上运行的网站。我们使用 ASP.Net 缓存通过缓存高使用率数据来帮助提高性能。但是，有时数据会发生变化。当它发生时，我们需要清除负载平衡服务器上的相关缓存项。有没有人有一些易于实施的建议来说明如何做到这一点？

我知道有软件可以为您管理这个（Microsoft Velocity 为其中之一）。我也知道还有其他选项可以拥有单独的状态服务器等。但是，对于我们想要的，它们似乎都过大了。我们现在只需要一个简单的机制来清除跨服务器的特定缓存项。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T21:37:15.537

为什么不在两个服务器都可以看到的对象上定义缓存依赖关系？您可以使用[SQL](http://msdn.microsoft.com/en-us/library/ms178604.aspx)或[文件](http://msdn.microsoft.com/en-us/library/system.web.caching.cachedependency.aspx)缓存依赖关系。

[链接到缓存 Msdn 页面](http://msdn.microsoft.com/en-us/library/ms178597.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T21:44:30.493

我们使用简单的 Web 服务方法。我们的缓存清除机制检查 Web 配置设置以查看是否存在任何其他服务器并异步调用这些服务器上的 Web 服务。

我们使用特定的命名约定存储数据，以便轻松清除我们想要的内容。因此，我们为要删除的项目传入前缀或后缀，因为有时它可能是用户特定的（例如，用户 ID 附加到项目的名称）或应用程序特定的（例如，项目的前缀是应用程序姓名）。

这是 ClearItem 例程的一个 VB 示例，它将在您的任一节点上调用：

```
Public Shared Sub ClearItem(ByVal strPrefix As String, ByVal strPostfix As String)

    If WebConfig.Caching_Enabled() Then

        ' Exit if no criteria specified '
        If IsNothing(strPrefix) AndAlso IsNothing(strPostfix) Then
            Exit Sub
        End If

        ' At the very least we need a Postfix '
        If Not IsNothing(strPostfix) AndAlso Not strPostfix.Length.Equals(0) Then
            _ClearItem(strPrefix, strPostfix)
        End If

        If WebConfig.Caching_WebFarmEnabled() Then
            ' Now clear the cache across the rest of the server farm '
            _ClearItem_WebFarm(strPrefix, strPostfix)
        End If

    End If

End Sub

Private Shared Sub _ClearItem_WebFarm(ByVal strPrefix As String, ByVal strPostfix As String)

    If WebConfig.Caching_WebFarmEnabled() Then

        ' Use a web service on each server in the farm to clear the '
        ' requested item from the Cache '

        ' Determine which servers need to remove cache items '
        Dim arrServers As String()
        arrServers = Split(WebConfig.Caching_WebFarmServers(), "|")

        Dim strServer As String ' Holds which server we are currently contacting ' 

        ' Loop through all the servers and call their web services '
        For Each strServer In arrServers

            Dim WS As New WebServiceAsyncCall
            WS.StartCallBack(strServer, strPrefix, strPostfix)

        Next

    End If

End Sub

Private Shared Sub _ClearItem(ByVal strPrefix As String, ByVal strPostfix As String)

    If WebConfig.Caching_Enabled() Then

        ' Determine how we are comparing keys '
        Dim blnPrefix, blnPostfix As Boolean

        If strPrefix.Length.Equals(0) Then
            blnPrefix = False
        Else
            blnPrefix = True
        End If

        If strPostfix.Length.Equals(0) Then
            blnPostfix = False
        Else
            blnPostfix = True
        End If

        ' Reference the Cache collection '
        Dim objCache As System.Web.Caching.Cache = HttpContext.Current.Cache

        ' Exit if the cache is empty '
        If objCache.Count.Equals(0) Then
            Exit Sub
        End If

        ' Clear out the cache for all items matching the input(s) (on this local server) '
        Dim objCacheEnum As IEnumerator = objCache.GetEnumerator()
        Dim objCacheItem As Object
        Dim objCurrentKey As System.Collections.DictionaryEntry
        Dim strCurrentKey As String

        ' Enumerate through the cache '
        While objCacheEnum.MoveNext()

            objCurrentKey = CType(objCacheEnum.Current, DictionaryEntry)
            strCurrentKey = objCurrentKey.Key.ToString()

            ' How are we comparing the key? '
            If blnPrefix AndAlso Not (blnPostfix) Then ' Only by PREFIX '

                If strCurrentKey.StartsWith(strPrefix) Then
                    ' Remove it from the cache '
                    objCacheItem = objCache.Remove(strCurrentKey) ' Returns a reference to the item '
                    objCacheItem = Nothing ' Need to explicitly nuke this because the objCache.Remove() above doesn t destroy '
                End If

            ElseIf Not (blnPrefix) AndAlso blnPostfix Then ' Only by POSTFIX '

                If strCurrentKey.EndsWith(strPostfix) Then
                    ' Remove it from the cache '
                    objCacheItem = objCache.Remove(strCurrentKey) ' Returns a reference to the item '
                    objCacheItem = Nothing ' Need to explicitly nuke this because the objCache.Remove() above doesn t destroy '
                End If

            ElseIf blnPrefix AndAlso blnPostfix Then ' By both PREFIX and POSTFIX'

                If strCurrentKey.StartsWith(strPrefix) AndAlso strCurrentKey.EndsWith(strPostfix) Then
                    ' Remove it from the cache '
                    objCacheItem = objCache.Remove(strCurrentKey) ' Returns a reference to the item '
                    objCacheItem = Nothing ' Need to explicitly nuke this because the objCache.Remove() above doesn t destroy '
                End If

            Else
                ' Not comparing prefix OR postfix? Why bother continuing then! '
                Exit Sub
            End If

        End While

    End If

End Sub 
```

您可以看到上面的代码通过使用此帮助程序类调用其他服务器：

```
Private Class WebServiceAsyncCall

    Public Sub StartCallBack(ByVal strService As String, ByVal strPrefix As String, ByVal strPostfix As String)

        ActiveWebServiceCounter += 1

        Dim clearCacheProxy As New CacheClearService.CacheClear ' This is the web service which of course will exist on the other node as well '
        clearCacheProxy.Url = strService

        AddHandler clearCacheProxy.ClearItemCompleted, AddressOf DoneCallBack

        clearCacheProxy.ClearItemAsync(strPrefix, strPostfix)

    End Sub

    Public Sub DoneCallBack(ByVal sender As Object, ByVal e As CacheClearService.ClearItemCompletedEventArgs)

        ActiveWebServiceCounter -= 1

        If e.Result.Length > 0 Then ' Something failed '
            ' Log the error '
        End If

    End Sub

End Class 
```

然后，远程服务器上的 Web 服务调用 _ClearItem 调用的相同代码。

# google-maps - 谷歌地图 api 密钥应该是什么？

> ID：774706
> 
> 赞同：0
> 
> 时间：2009-04-21T21:28:40.267
> 
> 标签：google-maps

如果我有这个网址

[http://domain.com/test3/eu/flickr-map/](http://domain.com/test3/eu/flickr-map/)

我使用什么 url 来生成 api 密钥。我已经将我的代码投入生产，而无论我做什么，我似乎都无法获得一个 API 密钥来工作。

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T21:42:45.740

在生成密钥时，我会使用“ [http://domain.com](http://domain.com) ”作为我的 URL。这样您就可以在您网站上的其他文件夹中使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T21:32:06.157

您是否阅读过关于密钥和域的[常见问题解答条目？](http://code.google.com/apis/maps/faq.html#keysystem)

如果您有效地更改了 URL，您可能需要注册一个新密钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T21:48:43.010

在[此地址](http://code.google.com/apis/maps/signup.html)注册以获取特定域的密钥，然后在调用 Google JS 文件时使用该密钥。

示例：假设我在上面的地址输入了一个域并获得了以下密钥：

> ABQIAAAAohKw8F5hsRCukQas4PbQXxS6jl7DzHm5BhVW2hKJ3KnZdh5-DxTaQN7mL8OMRAQtuGL6z2B0_Ql19Q

然后我会在我的调用中使用该键，如下所示：

```
<script src="http://maps.google.com/maps?file=api&v=2&key=ABQIAAAAohKw8F5hsRCukQas4PbQXxS6jl7DzHm5BhVW2hKJ3KnZdh5-DxTaQN7mL8OMRAQtuGL6z2B0_Ql19Q" type="text/javascript"></script> 
```

# php - php/regex: 在这种模式下允许破折号

> ID：774712
> 
> 赞同：0
> 
> 时间：2009-04-21T21:29:37.783
> 
> 标签：php, regex

如何在这种模式中允许破折号？

```
$str = preg_replace ( "/[^a-z \d]/i", "", $str ) ; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T21:32:05.390

把它放在第一位。

```
$str = preg_replace ( "/[^-a-z \d]/i", "", $str ) ; 
```

# c# - C++ 对象图到 C#

> ID：774717
> 
> 赞同：2
> 
> 时间：2009-04-21T21:30:47.813
> 
> 标签：c#, c++

是否有一个工具可以获取一系列 C++ 头文件并生成一个 XSD 和一个将 C++ 序列化为 XML 的类？

或者我们真正要寻找的是将数据从 C++ 迁移到 C# 的最简单方法？我们有一个 C++ 库，我们想用 C# 编写一个 GUI。使用托管包装器类似乎我们必须为每个类制作包装器。自动化是目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T21:36:03.463

一个可能的解决方案......但仍然需要一些工作！：

如果您使用的是 Microsoft Visual Studio，您可以使用 CodeDom ( [http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx) ) 来解析您的 C++ 代码。然后，您可以使用 T4 模板编写 C# 代码或将序列化 C++ 对象的 C++ 函数。

如果您拥有 2008 版的 Visual Studio，您将获得 T4。对于 2005 年，它需要额外下载。（[http://msdn.microsoft.com/en-us/library/bb126445.aspx](http://msdn.microsoft.com/en-us/library/bb126445.aspx)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T21:41:13.107

这将是序列化 C++ 内容的一个很好的起点。

[http://www.boost.org/doc/libs/1_38_0/libs/serialization/doc/index.html](http://www.boost.org/doc/libs/1_38_0/libs/serialization/doc/index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T22:53:16.197

您是否考虑过编写一个小脚本来将 C++ 标头转换为[协议缓冲区](http://code.google.com/apis/protocolbuffers/docs/cpptutorial.html) `.proto`文件。

这个变换应该比较简单。然后存在 C++ 和 c# 协议缓冲区实现，您应该能够生成大部分 c#，并有一种半合理的方式在您更改时使它们保持同步。

也就是说，我仍然会说，如果可能的话，让你的库用 /clr 编译以使其在 c# 中可以轻松使用。如果库的其他使用者当然不能依赖 CLR 运行时，这可能是不可能的。

# .net - 泛型：访问新成员，而不是隐藏成员

> ID：774726
> 
> 赞同：2
> 
> 时间：2009-04-21T21:33:21.987
> 
> 标签：.net, generics

我遇到了泛型和新成员的问题。我编写了一个对 ObjectA 类型的对象进行操作的泛型类。ObjectB 派生自 ObjectA 并隐藏了一些 ObjectA 的成员。当我将 ObjectB 的类型作为类型参数提供给泛型类时，我希望当我调用任何被 ObjectB 隐藏的成员时，我会调用 ObjectB 的实现。但是，CLR 仍然调用隐藏成员（ObjectA 的实现）。这似乎不合逻辑，因为我明确地将 ObjectB 的类型提供给了泛型类。这是泛型本身的问题，还是我做错了什么？

编辑：不幸的是，我无权访问 ObjectA 的源代码，并且我想要覆盖的成员不是虚拟的。如果我可以访问 ObjectA 的源代码，我会将成员设为虚拟，但由于我不能这样做，我唯一的“覆盖”成员的选择是通过“new”关键字。

 `````
class GenericClass<T> where T : ObjectA  
{  
    public void DoWork(T item)  
    {  
        // When type parameter 'T' is ObjectB, should get ObjectB's implementation  
        item.Invoke();  
    }  
}  

class ObjectA  
{
    public void Invoke()  
    {  
        // A's implementation...  
    }  
}

class ObjectB : ObjectA  
{
    public new void Invoke()  
    {  
        // B's implementation...  
    }  
}

static void Main()  
{  
    GenericClass<ObjectB> genericClass = new GenericClass<ObjectB>();  
    ObjectB objectB = new ObjectB();  
    genericClass.DoWork(objectB);  
} 
````  `* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-21T21:37:54.643

不。编译器生成的调用是针对*它在 compile-time 知道*的成员的。那是被曝光的成员`ObjectA`。

有什么原因你不使用普通继承，使用虚拟/覆盖方法？

顺便说一下，这是同一类型的另一个示例 - 未使用字符串的重载 == 运算符，即使`T`在`string`调用中`Foo`：

```
using System;

class Test
{
    static bool Foo<T>(T first, T second)
        where T : class
    {
        return first == second;
    }

    static void Main()
    {
        string x = "hello";
        string y = new string(x.ToCharArray());

        Console.WriteLine(Foo(x, y));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T21:46:22.097

这可能不是您问题的答案，但我看不出您的方法有什么意义（可能是因为我只看到了一个简化的示例）。

我建议使用以下方法：

```
class ObjectA
{
    public virtual void Invoke()
    {
        // do some work
    }
}

class ObjectB : ObjectA
{
    public override void Invoke()
    {
        // do some other work
    }
}

class GenericNotNeededClass
{  
    public void DoWork(ObjectA item)  
    {  
        item.Invoke();  
    }  
}  

static void Main()  
{  
    GenericNotNeededClass nonGenericClass = new GenericNotNeededClass();  
    ObjectB objectB = new ObjectB();  
    nonGenericClass.DoWork(objectB);
} 
```

根据您的示例代码，我相信该代码可以满足您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T22:45:19.710

您将 T 定义为泛型的 ObjectA 类型。如果 Invoke() 是虚拟的，它会按照您的想法工作，但因为它不是，所以您的泛型调用 ObjectA 实现，因为这是 T 定义的。

没有虚拟方法表条目指向 Invoke() 的 ObjectB 实现，因此这是运行时可以调用的所有内容。如果它是一个虚拟方法，那么 VMT 中就会有一个方法地址，并且它的行为就像您认为的那样。

# c# - 为什么 hasExited 会抛出“System.ComponentModel.Win32Exception”？

> ID：774730
> 
> 赞同：0
> 
> 时间：2009-04-21T21:33:59.567
> 
> 标签：c#, process

我可以使用 ShellExecuteEx 成功运行一个新进程，但是如果我访问 HasExited 属性，则会引发 Win32Exception。这是什么异常，如何检查进程是否存在？

```
ShellExecuteEx(ref info);
clientProcessId = NativeMethods.GetProcessId(info.hProcess);
Process clientProcess = Process.GetProcessById((int)clientProcessId);

if (clientProcess.HasExited) //<---- throws Win32Exception, but the process is alive! I can see its window
{
   //run new one
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T00:20:02.367

有关信息，您是否将 fMask 设置为`SEE_MASK_NOCLOSEPROCESS`，以便 hProcess 有效？

另外，您为什么要 P/Invoke'ing 到 ShellExecuteEx，为什么不使用 Process.Start w/ProcessStartInfo，它将为您处理 ShellExecuteEx？

编辑：由于您正在执行 runas，因此您只能在句柄上获得 SYNCHRONIZE 访问权限，而不是`PROCESS_QUERY_INFORMATION`访问权限，因此 GetExitCodeProcess 失败，导致 hasEnded 抛出 Win32 异常。

作为一种解决方法，您可以使用超时为零的 P/Invoke WaitForSingleObject 来查看进程是否已退出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-08T18:33:37.943

我今天遇到了这个问题。还有另一种解决方案。WaitForExit 函数在另一个用户环境中运行良好。因此，如果您执行 runas 来提升进程权限，您可以使用此功能查询进程状态。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-21T21:58:11.337

可能会引发错误，因为该对象不再存在，因此您检查一个被破坏的对象

处理图片时在vb中出现类似问题

```
function openimg(imgpath)
img = get image from path
return img
end function 
```

由于某种原因无法正确返回图像

相反，该行需要是

return img.clone() 以正确返回图像

然而，这就是我的例子

# c# - SerialPort + CF 2.0 防止数据丢失

> ID：774731
> 
> 赞同：1
> 
> 时间：2009-04-21T21:34:00.457
> 
> 标签：c#, .net, compact-framework, serial-port

谁能告诉我为什么下面的代码会丢失或丢失数据。我整晚都在谷歌上搜索，但找不到任何指针。串口正在使用以下设置；38400,n,8,1 xon/xoff 流量控制。ReceivedBytesThreshold = 1。

isReceiving 和 stockReceived 都是表单的成员

```
 private void serialPort1_DataReceived(object sender, System.IO.Ports.SerialDataReceivedEventArgs e)
    {
        string dataReceived = serialPort1.ReadExisting();
        bytecount += dataReceived.Length;
        processSerialData(dataReceived);
    }

    private void processSerialData(string dataReceived)
    {
        if (isReceiving == false)
        {
            int stxpos = dataReceived.IndexOf('\x02');
            if (stxpos != -1)
            {
                dataReceived = dataReceived.Replace("\x02", "");
                labelcaption = "Receiving... ";
                this.Invoke(new EventHandler(SetLabel));
                isReceiving = true;
            }
        }

        int etxpos = dataReceived.IndexOf('\x03');
        if (etxpos != -1)
        {
            dataReceived = dataReceived.Replace("\x03", "");
            //tmpFile.Write(dataReceived);
            writeToFile(dataReceived);
            tmpFile.Close();
            isReceiving = false;
            stockReceived = true;
        }

        // Now we need to write the data to file
        if (isReceiving == true)
        {
            if ((bytecount / recordSize) % 100 == 0)
            {
                labelcaption = "Receiving... " + (bytecount / recordSize);
                this.Invoke(new EventHandler(SetLabel));
            }
            //tmpFile.Write(dataReceived);
            writeToFile(dataReceived);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T22:03:27.313

几个潜在的问题（不是说他们是问题，但他们对我提出了危险信号）是：

*   您正在使用字符串，然后查找不可打印的字符数据。这是IMO的一个可疑处理想法。您应该接收字节，然后查找字节值。谁知道底层编码可能会做什么，但是丢失一些字符，特别是如果它使用 ASCII 编码，我不会感到惊讶。
*   这看起来也是一个潜在的线程问题。当您收到 DataRecieved 事件时，您会读取数据，然后在接收处理程序的上下文中继续处理数据。如果您在处理最后一个事件时收到另一个事件会发生什么？我打赌 byteCount 变量会被冲洗掉。就我个人而言，我有一个专门用于接收数据的线程和另一个用于处理它的线程。至少我会在那里添加某种同步对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T22:30:06.437

您不处理在一个 DataReceived 数据包中接收多个 STX 或 ETX 的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-28T22:17:46.043

由于 serialPort1_DataReceived 是一个触发事件，它只发生在主线程中。因此它不能由 2 个线程同时进入。为了证明这一点，打印出执行线程的线程ID（Thread.CurrentThread.ManagedThreadId）。

您可以坚持在 serialPort1_DataReceived 调用中假脱机数据。如果您可以保证串行链路中活动的“停机时间”，请假脱机，直到您知道何时会触发您的处理。

例如，数据最多包含 X 个字节/字符。然后另一组字符不会在 500 毫秒内进入。然后您有 500 毫秒的时间来处理接收到的字节。

# bash - 无法在没有反斜杠的情况下使用制表符完成系统变量

> ID：774734
> 
> 赞同：2
> 
> 时间：2009-04-21T21:34:49.237
> 
> 标签：bash, tab-completion

我的 inputrc 是空的。我使用 Bash。

**问题：** 我在

```
cd $te 
```

我按 Tab，我得到

```
cd \$test 
```

**在 Bash 中，如何在没有反斜杠的情况下完成制表符？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T21:51:41.287

你没有。在 Bash 中，$ 用于检索变量。例如：

```
SWEETVAR='hi'
echo $SWEETVAR 
```

因此，必须对文件或文件夹名称中的 $ 进行转义，否则将其解释为 var。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T17:12:28.037

问题似乎出在 MacPorts 上。

它有一个旧版本的 Bash_completion。

最新版本有以下内容

```
complete -o nospace -F _cd cd 
```

虽然执行命令后我有以下内容

```
$complete | grep cd
complete -o filenames -o nospace -F _cd cd 
```

我向 MacPorts 的 irc 发送了一条评论以更新 bash-completion @20060301 (sysutils)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T20:04:21.070

我终于搬到了 Zsh。它为我解决了这个问题。

# javascript - 动态脚本加载同步

> ID：774752
> 
> 赞同：10
> 
> 时间：2009-04-21T21:39:20.740
> 
> 标签：javascript

我有一个知道动态加载包含 javascript 类的脚本的脚本。我正在使用以下代码加载类脚本：

```
var head = document.getElementsByTagName("head")[0];
var script = document.createElement("script");
script.type = "text/javascript";
script.src = "myscript.js";
head.appendChild(script); 
```

然后我尝试使用 eval 创建新类：

```
var classObj = eval(" new MyClass()" ); 
```

问题是 eval 的代码正在执行 bofre 脚本已加载到内存中，我得到一个错误，即`MyClass is undefined.`

有没有办法同步这些事件？我需要确保脚本已完全加载到内存中，然后才能开始从中分配类。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-12-17T21:05:16.273

您需要将事件处理程序附加到 onload 方法（在符合 Web 标准的浏览器中）或 onreadystatechange（在 Internet Explorer 中检查 script.readyState 属性是否等于“loaded”或“complete”）。

在您收到脚本已加载的通知之前，您可能正在尝试访问尚未声明或创建的对象、函数和属性。

这是一个示例函数，从我的[Javascript 库bezen.org 中的模块](http://bezen.org/javascript/)[bezen.dom.js](http://bezen.org/javascript/src/bezen.dom.js)中提取：

```
var appendScript = function(parent, scriptElt, listener) {
    // append a script element as last child in parent and configure 
    // provided listener function for the script load event
    //
    // params:
    //   parent - (DOM element) (!nil) the parent node to append the script to
    //   scriptElt - (DOM element) (!nil) a new script element 
    //   listener - (function) (!nil) listener function for script load event
    //
    // Notes:
    //   - in IE, the load event is simulated by setting an intermediate 
    //     listener to onreadystate which filters events and fires the
    //     callback just once when the state is "loaded" or "complete"
    //
    //   - Opera supports both readyState and onload, but does not behave in
    //     the exact same way as IE for readyState, e.g. "loaded" may be
    //     reached before the script runs.

    var safelistener = catchError(listener,'script.onload');

    // Opera has readyState too, but does not behave in a consistent way
    if (scriptElt.readyState && scriptElt.onload!==null) {
      // IE only (onload===undefined) not Opera (onload===null)
      scriptElt.onreadystatechange = function() {
        if ( scriptElt.readyState === "loaded" || 
             scriptElt.readyState === "complete" ) {
          // Avoid memory leaks (and duplicate call to callback) in IE
          scriptElt.onreadystatechange = null;
          safelistener();
        }
      };
    } else {
      // other browsers (DOM Level 0)
      scriptElt.onload = safelistener;
    }
    parent.appendChild( scriptElt );
}; 
```

为了适应您的需要，您可以替换对 catchError 的调用，它包装了侦听器以捕获和记录错误，并使用修改后的函数：

```
var appendScript = function(parent, scriptElt, listener) {
    // append a script element as last child in parent and configure 
    // provided listener function for the script load event
    //
    // params:
    //   parent - (DOM element) (!nil) the parent node to append the script to
    //   scriptElt - (DOM element) (!nil) a new script element 
    //   listener - (function) (!nil) listener function for script load event
    //
    // Notes:
    //   - in IE, the load event is simulated by setting an intermediate 
    //     listener to onreadystate which filters events and fires the
    //     callback just once when the state is "loaded" or "complete"
    //
    //   - Opera supports both readyState and onload, but does not behave in
    //     the exact same way as IE for readyState, e.g. "loaded" may be
    //     reached before the script runs.

    var safelistener = function(){
      try {
        listener();
      } catch(e) {
        // do something with the error
      }
    };

    // Opera has readyState too, but does not behave in a consistent way
    if (scriptElt.readyState && scriptElt.onload!==null) {
      // IE only (onload===undefined) not Opera (onload===null)
      scriptElt.onreadystatechange = function() {
        if ( scriptElt.readyState === "loaded" || 
             scriptElt.readyState === "complete" ) {
          // Avoid memory leaks (and duplicate call to callback) in IE
          scriptElt.onreadystatechange = null;
          safelistener();
        }
      };
    } else {
      // other browsers (DOM Level 0)
      scriptElt.onload = safelistener;
    }
    parent.appendChild( scriptElt );
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-19T05:35:24.530

既然您似乎能够编辑外部脚本（因为您使用警报对其进行了测试），为什么不把这段代码放在那个脚本中呢？

如果您不能这样做（可能会生成额外的代码或共享第一个文件），只需在您正在加载的脚本末尾添加一个函数调用，如下所示：

```
load_complete(); 
```

然后将您的额外代码放入该函数中：

```
function load_complete() {
    var classObj = eval(" new MyClass()" );
} 
```

它比任何类型的加载触发器都简单和万无一失。此外，如果 js 文件是共享的，那么您可以在使用它的每个页面上使用不同的 load_complete 函数（只要确保始终定义 load_complete，即使它是空的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-29T20:22:24.947

我相信这实际上可以通过确保将加载外部脚本的代码和使用外部脚本的代码分开脚本块来解决，如下所示：

```
<script>
var head = document.getElementsByTagName("head")[0];
var script = document.createElement("script");
script.type = "text/javascript";
script.src = "myscript.js";
head.appendChild(script);

//this is in the same script block so it wouldn't work
//var classObj = eval(" new MyClass()" );
</script>

<script>
//this is in a separate script block so it will work
var classObj = eval(" new MyClass()" );
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T21:59:21.487

使用[jQuery](http://jquery.com/)（一个 JavaScript 库）`[getScript](http://docs.jquery.com/Ajax/jQuery.getScript#urlcallback) function to load your script async. Use the callback function to create your objects. Example:`

```
$.getScript("script.js", function () {
  var classObj = new MyClass();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T21:41:45.477

您确定向`<script>`DOM 添加元素会导致浏览器实际评估脚本吗？我有一个模糊的记忆，在某个地方没有读到，但也许我昨天吸入了太多的烤箱清洁剂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T21:48:20.907

Amir，在我看来，脚本似乎仍然位于服务器上，也就是说，还没有被浏览器加载。所以你`head.appendChild(script);`正在附加**null**。`<script>`您不能仅通过说出其名称来从服务器获取脚本，您需要使用 ajax 或通过使用标签加载它来请求它并将其注入页面。

# .net - ASP.NET 应用程序的自定义配置（使用应用程序设置或其他框架）

> ID：774759
> 
> 赞同：0
> 
> 时间：2009-04-21T21:42:33.527
> 
> 标签：.net, asp.net, configuration

我知道如何为我的 .NET 应用程序创建自定义配置处理程序。StackOverflow 上有很多帖子涵盖了需要做的事情。我花了很多时间编写派生自 ConfigurationElement 的类。

我越来越担心这种方法涉及大量工作——比我预期的要多。我正在创建很多类并用很多属性装饰它们，我不禁想到很多这样的工作可以嵌入到一个框架中。

Windows 窗体最近获得了一项称为[应用程序设置](https://docs.microsoft.com/en-us/dotnet/framework/winforms/advanced/application-settings-for-windows-forms)的功能。这为您提供了一个设置编辑器，并创建了一些代码，详细说明了将类型序列化进出配置文件。应用程序设置似乎为处理自定义配置带来了很多痛苦，但我并不特别喜欢由此产生的配置部分的格式，而且我不希望将我的配置保存回来。

所以，我的问题是：

1.  在 ASP.NET 站点中使用应用程序设置机制是否合适？我会在这样的应用程序中发现这种机制的性能/线程问题吗？
2.  是否有其他（更好的）框架可以消除从 web.config 读取自定义配置的繁重工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T02:21:42.887

请参阅[配置部分设计器](http://www.codeplex.com/csd/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T01:37:47.953

我不是特别喜欢应用程序设置功能。就此而言，我真的不喜欢为我自动生成代码的**任何东西。**在某些情况下它很有用，但我讨厌无法控制自己的项目的感觉。

至于比 System.Configuration“更好”的系统，我想不出任何一个。是的，您最终可能会得到大量类和大量属性，但您还将获得一个高度可定制的类型安全配置机制，**用户**可以轻松使用它。因为，归根结底，用户体验才是最重要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T02:08:12.047

合适的？当然。很多工作？明确地。

我认为如果您将产品运送给其他人使用会更合适。但如果它是内部的......它可能比它的价值更多的工作/头痛。

这可能是一个不受欢迎的观点，但我不喜欢我的配置文件中的任何特定于应用程序的东西，除了两件事。

1.  配置提供者
2.  连接字符串

我将所有配置设置都放在数据库中，并且在 web.config 中定义了一个设置，它将覆盖数据库配置设置。

这对我来说效果很好，我通常会尽可能避免使用自定义配置部分。

# c# - 写出 zip 文件在 IE7 中不起作用

> ID：774761
> 
> 赞同：4
> 
> 时间：2009-04-21T21:42:47.083
> 
> 标签：c#, asp.net, internet-explorer, zip

我继承了一个旧应用程序，该应用程序将 zip 文件存储在数据库中，需要检索该文件。在 Firefox 中工作正常，我可以打开 zip 并且其中的每个文件都很好。当我在 IE7 中运行它时，出现以下错误。

> Internet Explorer 无法从 localhost 下载 ProductContentFormImage.aspx。
> 
> Internet Explorer 无法打开此 Internet 站点。请求的站点不可用或找不到。请稍后再试。

我正在使用下面的代码。

```
byte[] content = (byte[])Session["contentBinary"];

Response.ClearContent();
Response.ClearHeaders();
Response.Clear();

Response.Buffer = true;
Response.Expires = 0;
Response.ContentType = "application/zip";
Response.AddHeader("Content-Length", content.Length.ToString());
Response.AddHeader("Content-Disposition", "attachment; filename=content.zip");
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.BinaryWrite(content);
Response.End(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T21:46:46.463

这是 IE 特有的一个奇怪的小错误。

基本上，当您将到期时间设置为 0 时，问题就会出现。

IE基本上经过以下过程：

1.  IE 确定文件是要“下载”的东西，这会导致 IE 打开文件下载弹出窗口。

2.  一旦用户单击“打开”或“保存”，IE 就会尝试下载文件，但由于它被设置为立即过期，IE 就会出错。

将您的到期时间设置为一个小的非零数字，例如 1 分钟，您应该会看到问题消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-16T05:27:28.663

我发现将 HttpCacheability 设置为 private 可以解决问题

```
context.Response.Cache.SetCacheability(HttpCacheability.Private); 
```

# c# - 完全任意的 C# 问题

> ID：774762
> 
> 赞同：2
> 
> 时间：2009-04-21T21:43:27.547
> 
> 标签：c#, architecture

假设您有一个对象，例如，我们将其称为 ScoreHotChicksEngine。并且说，ScoreHotChicksEngine 的构造函数期望传递一个 IDataReader，其中包含显然与为 Lonely Geeks 评分热小鸡有关的属性值。

```
ScoreChicksEngine(IDataReader reader); 
```

好的，这就是我想收集的内容...

作为开发人员，您是否会发现假设必须在将阅读器传递到 ScoreChicksEngine 之前阅读它更有用

```
IDataReader = command.ExecuteReader();
reader.Read();
ScoreChicksEngine SCE = new ScoreChicksEngine(reader); 
```

还是您会假设引擎本身会调用该函数并可能处理空值？

```
IDataReader  = command.ExecuteReader();
ScoreChicksEngine SCE = new ScoreChicksEngine(reader);
if (SCE.HasReaderData()) doSomething(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T21:47:19.270

您不应该考虑将数据收集与算法分离并在两者之间使用桥接解决方案（例如迭代器适配器）吗？只是我的 0.02 美元。

这种设计的含义是算法负责根据需要通过适配器进行调用以读取数据。适配器隐藏了集合及其与正在解决的问题无关的任何特定方面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T21:47:37.350

我会选择第一种方法。第二种方法违反了单一职责原则。我还将构造函数的输入参数声明为`IDataRecord`and not `IDataReader`。基本上，SCE 类基于单个记录构建自身，而不关心那里的一组记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T21:47:49.893

除非 ScoreChicksEngine 有理由假设读者将处于特定状态，否则我会让它自己完成所有工作。如果在初始化之前忘记调用 Read() 怎么办？没有办法真正检查这一点，所以只需在 SCE 中进行检查即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T21:48:09.270

好吧，经过几年痛苦的基于 .Net 的经验，我会假设第一种情况。但是，每次我输入它时，我都希望我输入第二个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T21:53:07.540

我会让 ScoreChicksEngine 做这项工作。我的理由：

1.  不依赖于用户知道/记得这样做。
2.  可能存在不必要的情况，例如 ScoreChicksEngine 决定其配置不完整。
3.  如果每次都必须做某事，为什么调用者要到处复制呢？
4.  使用户更容易，允许更紧凑的代码，例如：

    ScoreChicksEngine SCE = new ScoreChicksEngine(command.ExecuteReader());

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-21T21:53:41.160

我会使用第一种方法。也许读者返回不止一条记录，那么你可以这样做：

```
IDataReader = command.ExecuteReader();
while (reader.Read())
    list.Add(new ScoreChicksEngine(reader)); 
```

事实上，我过去所做的是围绕数据读取器创建了一个包装类（使用 GetInt32(name)、GetString("name") 等方法）。

这样，ScoreChicksEngine 就无法访问读者的方法，而只能访问包装类的方法。

上面的示例将看起来像这样：

```
IDataReader = command.ExecuteReader();
while (reader.Read())
    list.Add(new ScoreChicksEngine(new MyDataReaderWrapper(reader))); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-21T21:53:45.807

自发地第二种方法更有意义，但它在某种程度上取决于引擎将如何对待读者：

*   它会使用阅读器读取当前行，还是
*   它会遍历阅读器中的所有行并制作一个列表

如果是第一种情况，那么我希望引擎不会调用 Read 方法，如果第二种情况是真的，我会假设引擎在驾驶座上并负责调用 Read。

这可能指向像之前建议的那样考虑解耦。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-21T22:01:16.367

这取决于您的 ScoreChicksEngine 对读者做了什么。如果读者正在读取少量数据，那么传入该数据可能会更好：

```
IDataReader = command.ExecuteReader();
ObservableCollection<HotChicks> Wowzer = reader.Read();
ScoreChicksEngine SCE = new ScoreChicksEngine(Wowzer); 
```

这也可能是一个延迟加载的集合，您的 SCE 不会在意。无论哪种方式，我都不认为 SCE 必须在读取器访问结果之前调用任何内容。当您第一次尝试访问集合时，您的 IDataReader 应该具有调用 read 函数的内部逻辑，或者应该在构造函数中调用它。哪个更好取决于您的情况。不管怎样，建议你使用 ObservableCollection ！

# sql - 在一个语句中选择两个表的连接中的第一行

> ID：774769
> 
> 赞同：9
> 
> 时间：2009-04-21T21:47:16.400
> 
> 标签：sql, db2

我只需要从连接表 A 和 B 的查询中选择第一行。在表 B 上存在多个同名记录。这两个表中的任何一个都没有标识符。我也无法更改方案，因为我不拥有数据库。

```
TABLE A
NAME

TABLE B
NAME
DATA1
DATA2

Select Distinct A.NAME,B.DATA1,B.DATA2 
From A 
Inner Join B on A.NAME = B.NAME 
```

这给了我

```
NAME       DATA1    DATA2
sameName   1        2
sameName   1        3
otherName  5        7
otherName  8        9 
```

但我只需要检索每个名称的一行

```
NAME       DATA1    DATA2
sameName   1        2
otherName  5        7 
```

我可以通过将结果添加到带有标识列的临时表中来做到这一点，然后选择每个名称的最小 id。

这里的问题是我需要在一个语句中执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-10T04:03:35.593

这将起作用：

```
with temp as (
    select A.NAME, B.DATA1, B.DATA2, 
        row_number() over (partition by A.NAME order by A.NAME) as rownum
    from TABLEA A inner join TABLEB B
    on A.NAME = B.NAME
)
select NAME, DATA1, DATA2 from temp where rownum = 1 
```

如果要选择 data1 和其中 data2 的最小值，请使用以下变体：

```
with temp as (
    select A.NAME, B.DATA1, B.DATA2, 
        row_number() over (partition by A.NAME order by B.DATA1, B.DATA2) as rownum
    from TABLEA A inner join TABLEB B
    on A.NAME = B.NAME
)
select NAME, DATA1, DATA2 from temp where rownum = 1 
```

这两个查询都将为每个名称提供一行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-21T22:14:43.590

使用 GROUP BY 可能会让你分道扬镳，但要小心。如果你做这样的事情：

```
Select A.NAME, min(B.DATA1), min(B.DATA2) 
From A Inner Join B on A.NAME = B.NAME 
Group by A.NAME; 
```

你会得到你正在寻找的结果：

```
 NAME      DATA1   DATA2
  sameName   1        2    
  otherName  5        7 
```

但这仅仅是因为您正在测试的数据。如果您更改数据，则改为：

```
otherName  8        9 
```

你有过：

```
otherName  8        4 
```

它会返回：

```
 NAME      DATA1   DATA2
  sameName   1        2    
  otherName  5        4 
```

请注意，otherName 不会从同一记录返回 DATA1 和 DATA2！

更新：对其中一个数据值进行比较的自联接可能会对您有所帮助，例如：

```
SELECT a.*, b.* FROM a,b 
   LEFT JOIN b b2 ON b.name = b2.name AND b.data2 < b2.data2 
   WHERE a.name = b.name AND b2.data2 IS NOT NULL; 
```

但是，这仅在 DATA2 中的值对于每个 NAME 都是唯一的情况下才有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T10:45:16.827

尝试像这样对 B 进行重复数据删除

```
选择 A.NAME，bb.DATA1，bb.DATA2
从一个
加入BB
ON A.NAME = B.NAME
不存在的地方（选择 *
                    从 B
                    WHERE NAME = bb.NAME
                            AND (DATA1 > bb.DATA1
                                或 DATA1 = bb.DATA1 AND DATA2 > bb.DATA2))
```

如果存在更多 DATAx 列，则添加更多 OR 子句。

如果 A 也包含重复项，只需像在 OP 中一样使用 DISTINCT。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T21:50:27.127

不确定这是否能解决您的问题，但您可以尝试使用 GROUP BY 子句并按名称列之一分组。

[DB2 分组教程](http://www.geocities.com/srcsinc/database/db2_tutorials/sql_tutorials/DB2_SQL_TUTORIAL_5.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T22:23:23.553

如果您可以添加到临时表，然后从中查询，则可以一次性完成。

```
WITH T AS (temp table select), RN AS (select min row-numbers from T) SELECT T.NAME, T.DATA1, T.DATA2 FROM T INNER JOIN RN on T.row_number = RN.row_number 
```

还有很多其他的方法可以写这个，但这就是我一直在做类似事情的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-03T19:33:16.487

```
SELECT  A.NAME, bb.DATA1, bb.DATA2 
From A Inner Join B on A.NAME = B.NAME
WHERE B.DATA1 = (SELECT MIN(DATA1) FROM B WHERE NAME = A.NAME) 
```

这将给出您想要的结果，前提是 B.DATA1 值在与表 A 相关的集合中是*唯一的。*

如果它们不是唯一的，我知道的唯一其他方法是在 MSSQL 2005 及更高版本中使用 CROSS APPLY。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-22T19:08:55.647

这个问题的标签表明这将是 DB2 的解决方案，但这与 MS-SQL 服务器非常相似，如果是，请尝试以下解决方案：

使用 CROSS，可以显示仅存在于两个表中的内容

```
select A.*, B.DATA1, B.DATA2
from A
cross apply (select top 1 * from B where B.name = A.name) B 
```

但是可以更改为 OUTER 以显示存在于 A 中的内容而无需存在于 B 中

```
select A.*, B.DATA1, B.DATA2
from A
OUTER apply (select top 1 * from B where B.name = A.name) B 
```

在 apply 语句的结构中，也可以包含 ORDER 语句，因为表 B 中没有指示退出的顺序

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-06T04:08:29.453

您可以使用行号为每个名称获取一行，尝试如下所示

```
Select name,data1,data2 from 
(Select A.NAME,B.DATA1,B.DATA2,row_number() over(partitioj by a.name order by a.name) rn
From A 
Inner Join B on A.NAME = B.NAME) where rn=1 
```

# django - CentOS 上的 Django

> ID：774772
> 
> 赞同：4
> 
> 时间：2009-04-21T21:47:43.700
> 
> 标签：django, centos, yum, pysqlite, mysql-python

我希望在运行未知版本 CentOS 的共享主机上使用 Django。我的主要问题是尝试与数据库交互。服务器安装了 MySQL，但没有安装 MySQL-python。我最初想建议运行“yum install MySQL-python”，但显然 CentOS 默认存储库中的 MySQL-python 版本是 1.2.1，而 Django 需要 1.2.1p2。

这个要求首先从 Django 0.96 开始。在[发行说明](http://docs.djangoproject.com/en/dev/releases/0.96/)中，添加了一个名为 mysql_old 的已弃用接口，以与旧版本的 MySQL-python 兼容。去年 7 月，这个已弃用的接口被毫不客气地[删除了](http://code.djangoproject.com/changeset/7949)。此更改的[公告](http://code.djangoproject.com/wiki/BackwardsIncompatibleChanges#MySQL_oldbackendremoved)仅表明它已旧，并没有说明其他原因。

是否可以在 Django 1.1 中恢复这个旧界面？从那时起，数据库接口是否有任何变化？强制 Django 跳过版本检查并使用 1.2.1 会有什么危险？是否可以在另一台机器上编译更高版本并将文件复制到主机？为了做到这一点，我需要知道什么？

我还研究了 SQLite，但 CentOS 附带 Python 2.4.3，因此需要 pysqlite2 扩展，存储库中不存在（afaict）。

一切都可以通过简单地从源代码安装来解决，但这相当麻烦，与让他们从存储库安装某些东西相比，我说服公司这样做的机会要小得多。我意识到我似乎应该换一个主机，但你必须相信我，我有理由尝试完成这项工作。

*注意：我没有任何使用 CentOS 或 yum 的经验，所以我所说的关于它们的一切都是有根据的猜测。如果我需要做的只是指定一些设置或更改存储库以获取这些软件包的更新版本，请告诉我。谢谢。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T11:30:09.027

如果您无法从 centos 存储库获取最新的软件包，您实际上可以手动安装 mysql-python 适配器而无需编译任何内容。只需下载 mysql-python tarball（来自 sourceforge 站点）。在 tar 球中有各种设置脚本、自述文件等。您可以运行 ez_setup 文件、设置文件，或者，只需将 MySQLdb 目录复制到 pythonpath 中的某个位置。我认为在 centos 上，/usr/lib/python2.4/site-packages/ 有效。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-11T08:08:37.237

您可以安装 centos 的软件包`python-setuptools`，然后在其中使用您可以安装像这样`easy-install`的最新版本`mysql-python`

```
easy_install mysql-python 
```

# jquery - 如何在 jQuery 中选择表格单元格而不选择嵌套表格单元格

> ID：774774
> 
> 赞同：2
> 
> 时间：2009-04-21T21:48:00.533
> 
> 标签：jquery, css-selectors, sizzle

我只想选择表中的第一级“td”元素，而不是任何嵌套表的单元格。例如：

```
<table id="Outer">
    <tr>

        <td> --this one
        </td> 

        <td> --this one
            <table>
                <tr>
                    <td></td> -- but not this one or any deeper nested cells
                </tr>
            </table>
        </td>

    </tr> 
</table> 
```

（是的，在产品代码中，我将包括 tbody、thead...）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-21T21:55:14.540

我会使用[子](http://docs.jquery.com/Traversing/children#expr)选择器，它只选择与表达式匹配的直接子代。为了便于只选择外部表，我给它起了个名字。 **注意：**这不适用于您的示例，因为我已在 thead、tbody 和 tfoot 的选择器中添加，因为您表示您将在生产中使用。针对您的样品进行相应调整。

```
$('table#namedTable').children('tbody,thead,tfoot')
                     .children('tr')
                     .children('td') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T21:53:20.787

给最外层的表一个 id 为“Outer”：

```
$("table#Outer > td").text("selected"); 
```

# python - 是否可以在 Python 中重载 ++ 运算符？

> ID：774784
> 
> 赞同：2
> 
> 时间：2009-04-21T21:49:16.113
> 
> 标签：python, operator-overloading

是否可以在 Python 中重载 ++ 运算符？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-21T21:52:13.067

Python中没有`++`运算符（也没有'--'）。递增通常由`+=`运算符完成。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-21T21:51:54.987

不，不可能重载一元 ++ 运算符，因为它在 Python 中根本不是运算符。

只有 Python 语法允许的运算符（其子集）（在该语言中已经有一个或多个用途的运算符）可能会被重载。

[这些](http://docs.python.org/reference/lexical_analysis.html#operators)是有效的 Python 运算符，[此页面](http://docs.python.org/library/operator.html)列出了您可以定义以重载它们的方法（具有两个前导和尾随下划线的方法）。

与其他语言中常用的 i++ 不同，在 Python 中写为 i += 1。

在 python 中，+ 号需要在其右侧有一个操作数。它的左侧也*可能*有一个操作数，在这种情况下，它将被解释为二进制而不是一元运算符。+5, ++5, ..., ++++++5 都是有效的 Python 表达式（都计算为 5），7 + 5, 7 ++ 5, ..., 7 ++++ ++++ 5（全部计算为 7 + (+...+5) = 12）。5+*不是*有效的 Python。另请参阅[此问题](https://stackoverflow.com/questions/470139/why-does-12-3-in-python)。

**另一种想法**：根据您实际想要使用 ++ 运算符的目的，您可能需要考虑重载[一元（前缀）加运算符](http://docs.python.org/reference/datamodel.html#object.__pos__)。请注意，认为这可能会导致一些看起来很奇怪的代码。其他查看您的代码的人可能会认为它是无操作的并且会感到困惑。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-21T22:05:23.797

每个人都说得很好，我只想澄清另一件事。打开 Python 解释器并检查一下：

```
>>> i = 1
>>> ++i
1
>>> i
1 
```

Python 中没有 ++（或 --）运算符。它表现得如此（而不是语法错误）的原因是 + 和 - 是有效的一元运算符，基本上就像数字上的符号一样。您可以将其`++i`视为“+(+i)”和`--i`“-(-i)”。期望`++i`像使用任何其他语言一样工作会导致绝对阴险的错误搜索。*C 程序员：请注意。*

对于它的价值，顺子`i++`或确实失败了。`i--`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-21T21:53:05.670

好吧，Python 中不存在 ++ 运算符，所以你真的不能重载它。

当您执行以下操作时会发生什么：

```
1 ++ 2
```

实际上是

```
1 + (+2)
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-07-28T22:49:21.630

你可以破解它，尽管这会带来一些不良后果：

```
class myint_plus:
    def __init__(self,myint_instance):
        self.myint_instance = myint_instance

    def __pos__(self):
        self.myint_instance.i += 1
        return self.myint_instance

class myint:
    def __init__(self,i):
        self.i = i

    def __pos__(self):
        return myint_plus(self)

    def __repr__(self):
        return self.i.__repr__()

x = myint(1)
print x
++x
print x 
```

输出是：

```
1
2 
```

# iphone - 在 iPhone 上使用 Quartz2D 设计替代输入

> ID：774793
> 
> 赞同：0
> 
> 时间：2009-04-21T21:52:49.867
> 
> 标签：iphone, quartz-graphics, menu

我正在尝试创建一个形状像磁盘的简单 iPhone 输入设备，其中一半可以在屏幕上查看。这个想法是这个磁盘将被旋转，当磁盘停止旋转时，选择将是中间的菜单项。知道实现这种事情的最佳方式是什么吗？我现在正在阅读 Quartz2D 和 CoreAnimation，但不确定如何继续。

我只需要一个应用程序，所以在photoshop中预渲染整个shebang然后用CoreAnimation旋转它，并有一些机制来跟踪磁盘的哪个部分在“中间”（例如哪个菜单项被选中）？还是有更通用、更简单的方法？（我肯定错过了什么...）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T14:47:14.093

如果你想要一个“快速”的旋转（运动模糊等），那么预渲染这个东西可能会更容易

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T00:42:05.043

你基本上有正确的想法。CoreAnimation 使使用 AffineTransforms 轻松“旋转”层。

您也可以使用通用 UIView 来实现。它们还支持转换。这可能无关紧要，但对于 GUI 元素，UIVIew 对象运行良好。

# silverlight - 使用 Silverlight 框架是否有价值？

> ID：774801
> 
> 赞同：6
> 
> 时间：2009-04-21T21:54:04.183
> 
> 标签：silverlight, silverlight-3.0

我花了三周时间设计 Silverlight 3 LOB 应用程序，我决定使用实体框架、RIA 服务和 MVVM 模式。

现在我正在调查所有的胶水。我正在检查行为、ICommand、依赖属性、IoC 等。

在撰写本文时，有许多 Silverlight 框架。

[Silverlight.FX用于 Silverlight](http://projects.nikhilk.net/SilverlightFX/) [Prism](http://www.pnpguidance.net/Post/Prism2DevelopingCompositeSilverlightApplications.aspx) [Caliburn的](http://www.codeplex.com/caliburn/)
[Silverstone](http://code.google.com/p/silverstone/)
[CSLA](http://www.lhotka.net/weblog/OverviewOfCSLANET36ForWindowsAndSilverlight.aspx)

这些有必要吗？
你有使用这些框架的经验吗？
这些框架是否仍然适用于 Silverlight 3？
使用这些框架中的任何一个的优点和缺点是什么。

老实说，我对 CSLA 并不是很感兴趣，因为我们今天不使用它，但为了完整起见，我将它包括在内。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T08:31:40.563

仍然缺少的一件事（这对 MVVM 很重要）是指挥。因此，您将至少滚动框架为自己提供的部分内容。

我个人不使用任何第 3 方框架，但确实使用了公司内部框架，该框架为我提供了指挥权，并为 MVVM 的 ViewModel 部分提供了基类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T18:54:48.143

我喜欢 Nikhil 的 Silverlight.FX，因为它包括命令、mvvm 和一些“有趣”的项目，如鼠标滚轮滚动行为。Prism也不错，我觉得它的事件发布/订阅系统比Silverlight.FX的指挥要强大。总的来说，我觉得 Prism 有点麻烦（如果你打算构建一个 SL3 导航应用程序，这并不完全相关）。Ninject 是我目前最喜欢的 DI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T03:57:49.160

我对这些框架没有任何经验，但仅基于[YAGNI](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)以及 Silverlight 3 和 RIA 服务的新颖性，我会坚持使用 Silverlight 3 和 RIA 服务，直到您可以证明您需要额外的框架。

我猜想（纯属猜测）新的 Silverlight 3 功能与 .NET RIA 服务一起解决了这些框架解决的许多相同的 Silverlight 缺点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T01:36:24.557

基于我在工作中所做的工作，我当然有个人偏见，但我发现在任何 Silverlight 项目中都非常有用的功能......

1.  数据
2.  认证/安全
3.  触发器/动作（让您的大部分观点保持声明性）
4.  行为（将视图功能封装到可附加到控件的可重用组件中）
5.  查看模型/MVVM（将视图与代码分开）
6.  简单的 IoC - 将依赖项注入到您的视图模型中
7.  效果和过渡

如果您的应用程序很复杂/有多个屏幕... 8\. 导航和可能的一些 MVC

1 和 2 - 我们希望通过 .NET RIA 服务来解决。

其他人，我试图通过 Silverlight.FX 提供一个实现......最初作为一个实现人们可以按原样使用或作为起点，并随着时间的推移将它们驱动到平台/SDK。

就命令本身而言，它肯定有用，但在我看来不是必需的，如果您具有绑定的基本功能以及通过操作将事件拼接到普通方法的能力。

# c++ - 是否有类似于 Visual Studio 的关于可能丢失数据的 gcc 4.2 警告？

> ID：774802
> 
> 赞同：5
> 
> 时间：2009-04-21T21:54:25.900
> 
> 标签：c++, gcc, visual-studio-2005

gcc 是否有一个标志，以便从 long 到 short 的转换会生成有关可能丢失数据的警告？

我正在开发一个为 Visual Studio (2005) 和 GCC 4.2 (for Mac OS X) 编译的 C++ 应用程序。

Visual Studio 打印出的警告遵循以下模式：

```
: warning C4244: 'argument' : conversion from 'long' to 'short', possible loss of data 
```

我试过-Wconversion，但这不是我想要的。到目前为止，我唯一能找到的是一个实验性标志 -Wcoercion，它与 GCC 4.3 相关联（我不确定我们是否还想投资）。

**2009 年 4 月 22 日 @ 11:00 EST 编辑：**为了澄清，我想看到那个警告。我们有代码，我们想知道何时会发生数据丢失。如果我有代码：

```
unsigned long value1 = LONG_MAX;
std::cout << "value1: " << value1 << std::endl;

unsigned short value2 = value1;
std::cout << "value2: " << value2 << std::endl; 
```

我得到了这个预期的结果：

**  值1：2147483647
  值2：65535**

在我们的代码中，我们放置了特殊的断言来执行强制并警告我们执行的代码是否会导致数据丢失。我们使用 Visual Studio 的警告在我们的大型代码库中找到了这些位置。

有什么方法可以在 gcc 4.2 中生成这些警告？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T22:01:21.483

看看这个[GCC bug entry](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=2707)，也许它有助于理解为什么从 long 转换为 short 不会导致警告。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T13:39:53.010

使用 -Wconversion。即使您已经指定了 -Wall，您似乎也需要它。

它绝对适用于 gcc4.3。如果 4.2 版没有修复它，您必须升级才能获得它。

示例警告：

```
warning: conversion to 'short int' from 'int' may alter its value 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T18:44:40.753

GCC 4.2 不支持此功能，但已在 GCC 4.3 中添加。 [维基页面解释它](http://gcc.gnu.org/wiki/NewWconversion)。

感谢 schnaader 和 Evan Teran 提供了引导我到达那里的链接。

# php - 从字符串中删除无用的段落标签

> ID：774804
> 
> 赞同：4
> 
> 时间：2009-04-21T21:54:37.053
> 
> 标签：php, regex

如果我有一个像这样的字符串：

```
<p>&nbsp;</p>
<p></p>
<p class="a"><br /></p>
<p class="b">&nbsp;</p>
<p>blah blah blah this is some real content</p>
<p>&nbsp;</p>
<p></p>
<p class="a"><br /></p> 
```

我怎样才能把它变成：

```
<p>blah blah blah this is some real content</p> 
```

正则表达式需要选择`&nbsp;`s 和空格。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-21T21:58:31.723

```
$result = preg_replace('#<p[^>]*>(\s| ?)*</p>#', '', $input);
```

这不会在输出中捕获文字 nbsp 字符，但这很少见。

由于您正在处理 HTML，如果这是用户输入，我可能会建议使用 HTML Purifier，它也将处理 XSS 漏洞。您希望在那里删除空 p 标记的配置设置是 %AutoFormat.RemoveEmpty。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-21T21:58:26.937

此正则表达式将针对您的示例起作用：

```
<p[^>]*>(?:\s+|(?: )+|(?:<br\s*/?>)+)*</p>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T22:05:09.400

正如原始回复者所说，正则表达式在这里不是最好的解决方案，你想要的是某种 html 剥离器。

本站的一个功能：http: [//nadeausoftware.com/articles/2007/09/php_tip_how_strip_html_tags_web_page](http://nadeausoftware.com/articles/2007/09/php_tip_how_strip_html_tags_web_page)

应该可以帮助您，您只需要使用一些字符串操作来获取新行以及不返回您想要的格式的内容。

# delphi - 如何使用 Delphi 制作 Rocketdock / OSX 风格的启动栏

> ID：774809
> 
> 赞同：2
> 
> 时间：2009-04-21T21:56:33.227
> 
> 标签：delphi, toolbar

我想制作一个带有图标的工具栏，当您将鼠标悬停在它们上方时会变得更大。我不介意重新发明轮子，但如果有人能提出一个好的建议：

1.  图像格式（不确定位图是否可以在这里工作，也不确定如何处理矢量）
2.  现有控制（付费或免费，只要我可以在封闭源应用程序中使用它）
3.  容器类（TPanel 够用吗？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T22:04:16.250

我个人还没有使用过它，但也许看看 TMS TAdvSmoothDock 而不是重新发明轮子..？

[http://www.tmssoftware.com/site/advsmoothdock.asp](http://www.tmssoftware.com/site/advsmoothdock.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:27:11.310

在 delphi.about.com 网站上有一些示例代码可以做到这一点。

下面的链接显示了代码以及运行时扩展坞的示例图像。

[http://delphi.about.com/od/fullcodeprojects/a/mac-doc-launch.htm](http://delphi.about.com/od/fullcodeprojects/a/mac-doc-launch.htm)

我不知道代码是否兼容 D2009，但即使不是，代码也不应该那么难提出来。反正我会想。

高温下，

瑞安。

# python - 解释 Python 入口点？

> ID：774824
> 
> 赞同：235
> 
> 时间：2009-04-21T21:59:55.277
> 
> 标签：python, setuptools

我已经阅读了 Pylons 和 Peak 页面上关于 egg 入口点的文档，但我仍然不太明白。有人可以向我解释吗？

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2009-04-23T18:37:08.280

“入口点”通常是 Python 包的开发人员或用户可能想要使用的函数（或其他可调用的类似函数的对象），尽管也可以提供不可调用的对象作为入口点（同样正确）在评论中指出！）。

最流行的入口点类型是`console_scripts`入口点，它指向您希望作为命令行工具提供给安装您的包的​​任何人的功能。这进入你的`setup.py`脚本，如：

```
entry_points={
    'console_scripts': [
        'cursive = cursive.tools.cmd:cursive_command',
    ],
}, 
```

我有一个我刚刚部署的名为 的包`cursive.tools`，我希望它能够提供一个可以从命令行运行的“草书”命令，例如：

```
$ cursive --help
usage: cursive ... 
```

这样做的方法是定义一个函数，比如`cursive_command`文件`cursive/tools/cmd.py`中的一个函数，如下所示：

```
def cursive_command():
    args = sys.argv[1:]
    if len(args) < 1:
        print "usage: ..." 
```

等等；它应该假设它是从命令行调用的，解析用户提供的参数，并且......好吧，做任何命令被设计做的事情。

安装该[`docutils`](http://pypi.python.org/pypi/docutils/)软件包以获得一个很好的入口点使用示例：它将安装一些类似六个有用的命令，用于将 Python 文档转换为其他格式。

* * *

## 回答 #2

> 赞同：207
> 
> 时间：2012-03-08T09:39:04.107

[EntryPoints](https://setuptools.readthedocs.io/en/latest/pkg_resources.html#entry-points "入口点")提供持久的、基于文件系统的对象名称注册和基于名称的直接对象导入机制（由[setuptools](http://pypi.python.org/pypi/setuptools)包实现）。

它们将 Python 对象的名称与自由格式的标识符相关联。因此，任何其他使用相同 Python 安装并知道标识符的代码都可以访问具有关联名称的对象，而不管对象是在哪里定义的。**关联名称可以是 Python 模块中存在的任何**名称；例如类、函数或变量的名称。入口点机制不关心名称指的是什么，只要它是可导入的。

例如，让我们使用一个函数（名称）和一个具有完全限定名称“myns.mypkg.mymodule”的假想 python 模块：

```
def the_function():
   "function whose name is 'the_function', in 'mymodule' module"
   print "hello from the_function" 
```

入口点通过 setup.py 中的入口点声明进行注册。在名为“my_ep_func”的入口点下注册 the_function：

```
 entry_points = {
        'my_ep_group_id': [
            'my_ep_func = myns.mypkg.mymodule:the_function'
        ]
    }, 
```

如示例所示，入口点是分组的；有相应的 API 来查找属于一个组的所有入口点（下面的示例）。

在安装包时（即运行“python setup.py install”），上述声明由 setuptools 解析。然后它将解析的信息写入特殊文件。之后，可以使用[pkg_resources API](https://setuptools.readthedocs.io/en/latest/pkg_resources.html#api-reference)（setuptools 的一部分）查找入口点并访问具有关联名称的对象：

```
import pkg_resources

named_objects = {}
for ep in pkg_resources.iter_entry_points(group='my_ep_group_id'):
   named_objects.update({ep.name: ep.load()}) 
```

在这里，setuptools 读取写入特殊文件的入口点信息。它找到入口点，导入模块 (myns.mypkg.mymodule)，并在调用 pkg_resources.load() 时检索在那里定义的_function。

调用 the_function 就很简单了：

```
>>> named_objects['my_ep_func']()
hello from the_function 
```

因此，虽然一开始可能有点难以掌握，但入口点机制实际上非常易于使用。它为可插拔的 Python 软件开发提供了一个有用的工具。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-21T22:10:16.017

从抽象的角度来看，入口点用于创建实现某些接口的 Python 可调用函数的系统范围注册表。pkg_resources 中有 API 可以查看给定包通告了哪些入口点，也有 API 可以确定哪些包通告了某个入口点。

入口点对于允许一个包使用另一个包中的插件很有用。例如，Ian Bicking 的[Paste](http://pythonpaste.org/)项目广泛使用入口点。在这种情况下，您可以编写一个包，使用入口点来宣传其 WSGI 应用程序工厂`paste.app_factory`。

入口点的另一个用途是枚举系统上提供一些插件功能的所有包。[TurboGears](http://www.turbogears.org) Web 框架使用[`python.templating.engines`](http://docs.turbogears.org/1.0/TemplatePlugins)入口点来查找已安装且可用的模板库 。

# ruby-on-rails - 基本 Rails 问题：一对一关系

> ID：774825
> 
> 赞同：2
> 
> 时间：2009-04-21T22:00:26.540
> 
> 标签：ruby-on-rails, activerecord, one-to-one

遗憾的是，我对 RoR 的理解不足。我想在一个视图中保持三个一对一的关系。我有以下型号：

```
class  Ood< ActiveRecord::Base
  has_one :female_trait
  has_one :male_trait
end

class Female_Trait < ActiveRecord::Base
  belongs_to :ood
end

class Male_Trait < ActiveRecord::Base
  belongs_to :ood
end 
```

一个 Ood 将在 Female_Trait 表或 Male_Trait 表中有一个条目，但不能同时具有。我在 OodController 中调整脚手架的新/创建编辑/更新定义的努力没有成功。这是我在 OodController 中的错误逻辑的示例：

```
def new
  @ood = Ood.new
  @female_trait = Female_trait.new   
  @male_trait = Male_trait.new
  ...
end

def create
  @ood = Ood.new(params[:ood])
  if !params[:female_trait][:trait1].blank? and !params[:female_trait[:trait2].blank?
    @female_trait = @ood.female_trait.build(params[:female_trait])
  if !params[:male_trait][:trait1].blank? and !params[:male_trait[:trait2].blank?
    @male_trait = @ood.male_trait.build(params[:male_trait])
  ...
end 
```

我错过了什么概念？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T22:22:05.520

为什么不使用指向 Female_Trait 或 Male_Trait 的多态关系？

```
class  Ood< ActiveRecord::Base
  belongs_to :trait, :polymorphic => true
end

class Female_Trait < ActiveRecord::Base
  has_one :oods, :as => :trait
end

class Male_Trait < ActiveRecord::Base
  has_one :oods, :as => :trait
end 
```

# java - RMI-如何通过远程方法传递远程对象？

> ID：774828
> 
> 赞同：6
> 
> 时间：2009-04-21T22:01:16.787
> 
> 标签：java, rmi

据我了解，一旦我在两个系统之间建立了 RMI 通信链接，我就可以将实现“远程”的对象传递给采用该类型对象的远程方法之一，而远端只会得到新对象的远程接口（换句话说，它将成为一个新的远程连接，而不是仅仅序列化对象。）

这个对吗？

如果是这样，我认为这与方法签名有关——但我想确切地知道它如何确定它应该创建一个新的远程对象，而不是简单地序列化整个对象。

这真的很难用言语表达。让我试试这个：

假设我有一个客户端和一个服务器系统。在服务器系统上，我创建并发布一个 RMI 对象，在客户端系统上，我检索接口并可以与服务器系统交互。

```
Client                            Server
Object1 RemoteIface     ----   Object1 Implementation 
```

到目前为止，一切都很好。在客户端上，Object1.remoteMethod() 将在服务器上执行（在对参数进行序列化之后）。

现在，问题来了，在客户端我执行如下代码：

```
Object2 object2=new object2(); // Also a remote object
object1.send(object2); 
```

据我了解，到那时，我的系统将有一个新的通信机制：

```
Client                           Server
Object1 RemoteIface    -----    Object1 Implementation
Object2 Implementation -----    Object2 RemoteIface 
```

此时，如果服务器调用 Object2 上的某个方法，该方法实际上会在客户端上执行。

我想知道系统在什么时候决定这样做而不是仅仅序列化它（就像任何非远程对象一样）。

还是我完全错了，它只是将它序列化，我需要某种“getRemoteInterface()”方法调用来实际创建远程调用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T22:10:31.680

这就是所谓的[代理模式](http://en.wikipedia.org/wiki/Proxy_pattern)。在远端实例化的事物已经生成了用于传输值和激活方法的代码。

java.rmi.Remote 本身只是一个“标记接口”。您需要一个实现来完成实际工作。查看[这个 JavaCamp 教程](http://www.javacamp.org/moreclasses/rmi/rmi2.html)了解更多信息。

更新：好的，换个方向，是的，您需要序列化对象并通过网络传递。最好的办法可能是先完成[RMI 上的 Java 教程](http://java.sun.com/docs/books/tutorial/rmi/overview.html)。但是，基本上，Serializable 是另一个标记接口，它告诉 Java 对象已准备好转换为内部字符串格式，有点像 XML 或 YAML。只要该对象的类文件可用，该格式就可以在接收端“重新水化”为匹配的对象。

# php - 确保相册内容新鲜

> ID：774830
> 
> 赞同：1
> 
> 时间：2009-04-21T22:01:30.750
> 
> 标签：php, mysql

我正在一个用户提交照片的网站上工作，这些照片可以在页面上一张一张地查看。

还有另一个页面，您可以在其中看到多张照片的较小版本。

当用户点击任何这些较小的照片时，他们会得到大版本页面，按“下一步”会将他们带到该类别中的另一张照片。

我非常希望新照片优先于旧照片。

我的想法是，当用户单击下一步时，他会被带到最新的照片，然后从那里移动下一个将使用户向后浏览所有新照片。

问题是，当用户离开单个照片页面，返回到多个拇指页面，然后单击那里的另一张照片时，用户将在单击下一步时开始看到相同的新照片。

我想确保用户看不到同一张照片。我考虑为每个访问者放置一个唯一的 cookie，然后当用户访问照片时，我将其记录在访问表中。当从数据库中为“下一张”选择新照片时，我确保用户之前没有访问过该照片。

我（过早地）担心这会对数据库负载产生什么影响。

关于执行此操作的最佳方法或替代方法的任何想法？

编辑：

可能不够清楚，非常简短的版本：我想确保在循环浏览图片时没有重复的内容。最好在延长的时间内，而不仅仅是一个会话。

编辑2：

所以这就是我目前正在考虑做的事情。看起来不错？我把它放在一起（字面意思是，电源在 5 分钟内关闭进行维修，我明天必须回来，希望这是有道理的）。

[![替代文字](https://i.stack.imgur.com/CiZ53.jpg)](https://i.stack.imgur.com/CiZ53.jpg)
[（来源：[googlepages.com](http://amything.googlepages.com/next.jpg)）]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T22:05:47.667

如果您使用会话，则可以跟踪用户查看过的最早的“新”照片 ID。因此，当他们单击下一步时，您会显示最新照片并将其 ID 存储在用户会话中。每次他们单击下一步时，给他们您拥有的最新照片，该照片低于他们在会话中拥有的照片的 ID。这样，您的会话将始终知道从哪里开始向他们展示他们尚未看到的相对较新的照片。您可以从中断的地方继续浏览照片记录。

由于会话使用 cookie 工作，这将一直有效，直到他们清除他们的 cookie，即使他们没有注册或登录。

但是，这不会考虑自用户开始浏览以来已提交或上传的新照片。如果不存储用户查看过的每张照片的记录，那么找出一种模拟该级别记录保存的方法将非常具有挑战性。

编辑：

仔细考虑这一点，您不仅可以存储用户查看过的最早的照片 ID，还可以存储最新的。这样，每次他们单击下一步时，您都会看到您的最新照片是否比他们查看过的最新照片新。如果是这样，向他们展示最新的照片。如果没有，请向他们展示您拥有的比他们“最旧查看”的照片更老的最新照片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T22:11:26.547

我不能完全说出您的确切意思，但是您要做的就是根据添加项目的时间（最高=最新）订购带有 id 的照片，并在您点击下一个时减少 id，这样他们就可以跳转到查看队列无论在哪里，然后单击下一步将移动到下一张在线照片。

编辑：听起来您需要将用户唯一变量存储在他们查看过的内容和未查看过的内容上。

从您的其他回复中，您希望它在更长的时间范围内。

如果您不愿意将其减少到会话长度时间范围（更简单的实现），您可以按照您的建议将视图存储在数据库中。

为了解决您对磁盘空间的担忧，您可以采取各种措施来减少它。

举个例子： - 存储单个视图，但在可能的情况下存储视图序列。以简单的形式压缩。所以用户查看 id 1,2,3,4,6,12,13,15。您的数据库视图表可能如下所示：查看

```
UserID  ImageIDStart  ImageIDEnd
jim        1             4
jim        6            null
jim        12            13
jim        15           null 
```

您可能希望将这些概念拆分为两个表，“序列”和“单个视图”，以便进行正确的查询和更轻松的处理。您可能需要某种形式的压缩器，它可以获取单个视图并在可能的情况下转换为序列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T22:18:50.803

当“图像查看器”关闭时，您可以简单地存储开始 id（用户看到的第一张照片）和用户最后看到的照片的 id。

当用户回来时，您可以简单地检查是否在哪里添加了较新的照片，如果是，则首先显示这些，直到您到达用户首先看到的图像的 ID（存储在 cookie 或数据库中）。然后跳过直到用户最后看到的图像的 id，然后从那里继续。

这不会在 cookie / 会话或数据库上产生巨大的开销。它基本上是万无一失的 .. 至少相对准确，直到您必须解决以下问题；如果用户在一系列照片的中间出现怎么办？显然，您可以存储一系列 id。

像这样的大量解决方案。想想“聪明”。并考虑到精度的需要。如果您将每张访问过的照片记录在数据库中，您将对用户看到的内容有准确的回忆，但性能很可能会下降（我可以向您保证，随着时间的推移会急剧下降）。如果您喜欢性能，并且我相信您的用户会喜欢，那么我建议您查看一个可能不太准确（如上所述）但尊重性能的解决方案。

# asp.net - ASP.NET 和虚拟目录

> ID：774831
> 
> 赞同：0
> 
> 时间：2009-04-21T22:01:55.820
> 
> 标签：asp.net, iis, virtual-directory

我们有一个将用 ASP.NET 替换的 ASP 系统。几个不同的实体使用这个系统作为他们网站的扩展（这个系统的外部），使用虚拟目录、CSS 等。这个架构在 .NET 世界中仍然合理吗？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T22:05:08.977

虚拟目录是 IIS 的功能，而不是 .net。当您引用路径（以及调用 MapPath 方法）时，.net 中的工作方式与 asp 中的完全相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T22:05:59.257

您的问题有点含糊……但是，您可以将 ASP.NET 与虚拟目录一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T22:07:40.347

虚拟目录是 IIS 的一项功能。CSS 可以在 ASP.NET 应用程序中使用，无论服务器端是用 ASP 还是 ASP.NET 实现的，发送到客户端/浏览器的仍然是 HTML/CSS/JavaScript。

因此，您可能能够在 ASP.NET 中完成您在 ASP 中完成的所有操作。

尽管 ASP.NET 提供了许多附加功能，例如[VirtualPathProviders](http://msdn.microsoft.com/en-us/library/system.web.hosting.virtualpathprovider.aspx)、[HttpHandlers](http://msdn.microsoft.com/en-us/library/system.web.ihttphandler.aspx)、[HttpModules](http://msdn.microsoft.com/en-us/library/system.web.ihttpmodule.aspx)。这些都是 ASP 中不可能实现的（至少在没有编程 C++、ISAPI 的情况下是不可能的）。

虽然很难说出什么对你有用，因为你的问题有点含糊。

# eclipse - 在 Mac OS X 上安装 BlackBerry Eclipse JDE 插件

> ID：774832
> 
> 赞同：12
> 
> 时间：2009-04-21T22:02:23.900
> 
> 标签：eclipse, macos, blackberry, jde

是否可以在 Mac OS X 上安装 BlackBerry Eclipse JDE 插件？我尝试通过 Eclipse 更新以及从 BlackBerry 站点下载 zip 文件来安装插件。

这是在开发环境中设置的最不直观的过程。黑莓网站并不容易。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-22T15:10:26.017

受支持的 Blackberry 开发领域非常以 Windows 为中心。编译器 (rapc) 是 Windows 可执行文件。我的 Mac 经验为零，所以我不知道这是否会有所帮助，但这[个人似乎已经成功编译](http://codeforfun.wordpress.com/2008/06/23/build-native-blackberry-apps-natively-on-a-mac-using-maven/)。那里可能会有一些帮助。

祝你好运。

* * *

**编辑：**虽然在回答问题时是正确的，但从那时起，Mac Eclipse 插件已经发布。查看其他答案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-09-28T01:25:38.070

截至今天，RIM 为 Mac OS 提供了他们的开发插件的一个版本。一探究竟：

[https://developer.blackberry.com/java/download/#eclipse](https://developer.blackberry.com/java/download/#eclipse)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-09-29T05:22:34.620

RIMM 发布了一个用于黑莓开发的 MacOS Eclipse 插件：http: [//na.blackberry.com/eng/developers/javaappdev/macosx.jsp](http://na.blackberry.com/eng/developers/javaappdev/macosx.jsp)

虽然没有内置模拟器，但该插件确实支持对 Torch 9800 手持设备进行 USB 连接设备调试。我打算买一个；无合同价格约为 499 美元。借助 Torch 和新插件，无需使用 VM 即可进行黑莓开发。（最后！）

看到[这个帖子](https://stackoverflow.com/questions/2022379/blackberry-development-on-mac-os-x/3748061#3748061)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-01-28T17:28:14.353

是的。OS X 上仍然没有模拟器，所以如果你想在 mac 上开发，你需要一个物理设备。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-27T01:29:37.077

你可以让一些东西工作——比如编译——但模拟器尤其是一个 Windows 程序。我在我的 Mac Book Pro 上的 VMWare Fusion 下运行 BB 环境。

我完全同意他们不会让事情变得容易。不久前我[发表了一篇博文](http://www.thinkingblackberry.com/archives/21)，可能会清理一些东西（它确实假设在 Windows 下运行）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-19T15:50:48.713

在 Windows 以外的任何东西上开发黑莓都是一件苦差事。我成功地让 RAPC 4.3 版在 OS X 上运行良好，但任何早于 4.3 的版本都会变得棘手。（如果我一天有 35 小时的时间，我可以让它工作。）如果您使用我的 4.3 解决方案运行，那么不要，我重复一遍，不要针对比 OS 4.3 更早的任何东西。按照 Linux 教程，我几乎可以让模拟器在 OS X 上运行，但我遇到了 X11 问题。我也未能成功让模拟器在 Mepis Linux 上运行，这很可能是由于 Wine 的不同版本。通过在本地运行 OTA 服务器（使用我修改后的天线支持来部署 cod 文件）并打开与 www. 您的编译器（4.3 及更高版本）和您的签名工具应该可以工作。调试是不行的，虽然 Linux 上的黑莓 USB 驱动程序支持仍未完成（据我所知），但您需要进行 OTA 加载，而不是更快的 Javaloader.exe。我的建议是使用 WTK 的 Eclipse 插件（如果它现在可以在 OS X 上运行）并设计您的应用程序的一般外观/感觉。然后在设备上进行本地部署和测试。其他东西总是有 VMWare/Parallels/Virtual Box。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-22T12:41:43.580

“RIMM 发布了一个用于黑莓开发的 MacOS Eclipse 插件：http://na.blackberry.com/eng/developers/javaappdev/macosx.jsp”

如果你下载，解压，在macosx 10.7上会有一条消息：powerpc app is not supported。:)

因此，不支持那些基于英特尔的（iPhone 开发机器）作为本机。

[截屏](http://imageshack.us/photo/my-images/508/screenshot20110922at343.png)

如果您从插件站点下载 Eclipse 插件：http: [//www.blackberry.com/go/eclipseUpdate/3.6/java](http://www.blackberry.com/go/eclipseUpdate/3.6/java) 他们将为 5.0 和 7.0（看不到 6.0）安装插件，并且在重新启动后将不可用黑莓应用程序向导（它似乎在正在运行的 Windows 上的 mac 上完全没用）

正如我现在看到的，你必须有 windows 或并行，或者在 WM 或 Bootcamp 中，不确定 Wine。还有一篇文章说 SSD 的运行速度可以接受（比本机 Windows 快，但是 HDD）。我没有测试。不值得 Fuckberry 开发 Windows 零售许可证。

# xml - 调用 FileStream.readUTFBytes() (Adobe AIR) 后 FileStream.truncate() 不起作用

> ID：774834
> 
> 赞同：0
> 
> 时间：2009-04-21T22:02:40.170
> 
> 标签：xml, apache-flex, adobe, air, filestream

我正在尝试将 xml 文件读入内存，添加一个节点，然后覆盖原始文件。

以下代码可以正常工作（它清除文件，然后将新字节写入顶部）：

```
var stream:FileStream = new FileStream();
stream.open(file, FileMode.UPDATE);
stream.position = 0;
stream.truncate();
stream.writeUTFBytes("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
stream.writeUTFBytes(File.lineEnding);
stream.writeUTFBytes(xml.toXMLString());
stream.close(); 
```

但是，如果我在文件打开后尝试执行读取，则位置/截断调用不起作用：

```
var stream:FileStream = new FileStream();
stream.open(file, FileMode.UPDATE);

var xml:XML = XML(stream.readUTFBytes(stream.bytesAvailable));

// Modify xml here

stream.position = 0;
stream.truncate();
stream.writeUTFBytes("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
stream.writeUTFBytes(File.lineEnding);
stream.writeUTFBytes(xml.toXMLString());
stream.close(); 
```

有谁知道为什么这不起作用？

如果您检查流，在第一个代码中，在调用 truncate() 之后，bytesAvailable 属性将读取 0。但在第二个代码中，bytesAvailable 不会改变（它将显示当前文件大小）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-29T18:12:01.500

在 truncate() 之后关闭流，然后再次打开它。或者改用 openAsync 。

```
stream.position = 0;
stream.truncate();
stream.close();
stream.open(file, FileMode.UPDATE);
stream.writeUTFBytes("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
stream.writeUTFBytes(File.lineEnding);
stream.writeUTFBytes(xml.toXMLString());
stream.close(); 
```

或者

```
var stream:FileStream = new FileStream();
stream.openAsync(file, FileMode.UPDATE);
stream.position = 0;
stream.truncate();
stream.writeUTFBytes("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
stream.writeUTFBytes(File.lineEnding);
stream.writeUTFBytes(xml.toXMLString());
stream.close(); 
```

# ruby - 如何使用 Activewarehouse-etl 删除字段？

> ID：774835
> 
> 赞同：1
> 
> 时间：2009-04-21T22:02:47.767
> 
> 标签：ruby, data-warehouse

我正在解析一个 csv 文件并尝试将其发送到一个字段少于原始 csv 文件的表。如果我将额外字段设置为空，如何删除那些多余的逗号？

这是原始的 csv 格式：

```
columns => id,first_name,last_name,phone,fax
sample row => 1,ben,tomas,5555555,6666666 
```

这是最终格式：

```
column => id,phone,fax
sample row => 1,5555555,6666666 
```

注意名字和姓氏缺少逗号。

这是暂定的行处理器：

```
module ETL 
  module Processor
    class PhoneProcessor < ETL::Processor::RowProcessor

  def process(row)
    #debugger
    row = {:id => row[:id], 
           :phone => row[:phone], 
           :fax => row[:fax]}
    row
  end
end
end
end 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-18T04:12:22.857

在向 gem 的邮件列表发送电子邮件并等待几周后，我得出的结论是 gem 已经死了，或者我正在以不打算使用的方式使用它。答案很弱，但这就是我所得到的。

PS决定只制作activerecord模型并从那里开始。

# ms-access - 在 Access VBA 中可以使用这种查找方法吗？

> ID：774844
> 
> 赞同：1
> 
> 时间：2009-04-21T22:05:37.650
> 
> 标签：ms-access, vba, ms-access-2007, lookup

我正在使用 Access 2007 通过 ODBC 连接到 MS SQL 数据库。我有一个名为“bases”的表，它看起来像这样：

```
Name     ID     Site
--------------------
Home      1      111
Work      2      111
Car       3      111
Castle    4      111
Store     1      222
Rest      2      222 
```

现在棘手的部分是该表中唯一会知道的部分是站点。
我知道我可以进行 DLookup 并获取第一条记录 (Home,1) 并将它们存储在变量中。
但是我需要以某种方式获取下一条记录（工作，2）并将它们存储在其他变量中，然后循环遍历表，直到我在站点为 111 时将每条记录存储在变量中。
有任何想法吗？这样做的目的是将这些返回值保存为字符串，并最终将它们放入一个复杂的 Query 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T22:15:13.573

我有点生疏了，但是您应该可以进行类似的查询。

```
SELECT * FROM Bases WHERE Site = 111 
```

将其返回到记录集，然后简单地遍历记录集，将项目添加到数组中以供存储和将来使用，具体取决于您的需要。

如果您不熟悉记录集，请查看[这篇文章](http://allenbrowne.com/ser-29.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T16:32:39.163

正如*onedaywhen*在我之前所说，遍历结果集以构造第二个查询并不是最佳解决方案。

我不知道第二个（复杂的）查询是什么样子的，但你不能做这样的事情吗？

```
select * from OtherTable 
where Name in 
(
    select Name from Bases where Site = 111
) 
```

# delphi - 对于在同一类中设置全局变量的例程，什么是好的命名约定

> ID：774848
> 
> 赞同：2
> 
> 时间：2009-04-21T22:06:35.263
> 
> 标签：delphi, naming-conventions, synchronized, code-complete, routines

Code Complete（第 7 章第 3 节）说，一个好的函数应该根据它返回的值来命名，而一个类中的一个好的过程名称应该根据它所做的来命名。

当我在 Delphi 中（2009 年之前）编写同步方法时，有时需要使用它们来设置全局变量，这似乎是一种不好的编程习惯，但由于我无法传递变量，因此这是必要的。我不想称它们为“Get”或“Set”，因为我将它们用于我的属性方法。

有人对这些有更好的命名约定吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T22:14:36.960

> 我不想称它们为“Get”或“Set”，因为我将它们用于我的属性方法。

这似乎是一个相当武断的决定。您是否还说您不想在“setName”上使用“set”，因为您也在“setAge”上使用过它？

也就是说，使用 setter 进行静态实际上是一个公共全局变量 ALA Basic——您确定这是完成任务的唯一方法吗？

我并不是说静态是绝对错误的，但是您应该尽最大努力在定义它的对象中操纵它，而不是使用 setter，否则您会以一种很难的方式暴露很多对象的内部状态控制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T04:10:08.150

属性 getter 和 setter 没有以*get*和*set*开头的名称，因为它是为命名 getter 和 setter 保留的一些约定。他们有这些名字是因为*他们就是这样做的*。由于您的同步方法的目的是设置变量的值，因此给它一个“设置”名称非常有意义。

您可以选择一个同义动词，例如*assign*或*copy*，只是为了区别于*set*不同，但出于您所描述的目的，这些都是非常规的名称。当您有一个设置 的值的例程时`Foo`，约定规定该函数必须命名为`SetFoo`。最终，我认为您只需要克服使用*get*和*set*处理非属性访问器的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T23:03:09.353

我想说 Code Complete 的建议非常有力，而您的反对意见“因为我将它们用于我的属性方法”非常弱。无论如何，这些属性设置器/获取器应该是私有的。将其视为一种重载形式并将它们称为 SetFoo 和 GetFoo。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T03:18:53.420

你用的是什么德尔福版本？如果使用 D2006 或 2007，您可以使用类方法将全局变量移动到类属性中以获取和设置值。由于这些是属性获取器和设置器，因此使用 Get 和 Set 是合适的。

```
type
 TMyObject = class(TObject)
 private
    class var
      FStringProperty : string;

    class function GetStringProperty: String; static;
    class procedure SetStringProperty(const Value : string);static;
  public
    class property StringProperty : String read GetStringProperty write SetStringProperty;
  end; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-27T09:09:40.370

在我看来，写入全局变量应该很容易与普通的 setter 区分开来。如果无法避免全局变量，我通常使用

```
SetGlobalFoo(...); 
```

以此目的。长名称的开销是好的 IMO，因为这些结构应该很少使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-27T12:11:51.387

我将`SetXXX`and`GetXXX`用于私有和全局变量，因为我看不出这些方法的作用有什么不同。对数据区域的操作`SetXXX`是一个集合。如果该数据区域是全局的、本地的或远程的，则它是该方法的内部细节，不应从外部看到。

IDE 将帮助您了解该数据区域是否是本地的，但如果您愿意，您可以编写一行简单的注释来说明它。

# c# - C# 属性限制

> ID：774849
> 
> 赞同：3
> 
> 时间：2009-04-21T22:06:52.140
> 
> 标签：c#, .net-2.0, attributes

是否可以限制在特定类中应用属性的属性数量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T22:35:04.443

在编译时没有。

在运行时，您可以通过静态初始化程序验证这一点，如果违反了此不变量，则该初始化程序将抛出，尽管这将被认为是非常糟糕的样式，但从某种意义上说，当不变量不成立时，没有代码可以执行，这是安全的。

如果您考虑 .Net 固有的可扩展性，即使您可以在编译时验证这一点，想象一下：

编译dll A

```
public class Foo 
{
     public int Property1 {get;}
} 
```

用类编译引用 A.dll 的 dll B

```
public class Bar
{
     [OnlyOneAllowedOnAnyPropertiesPerClass]
     public int Property2 {get;}
} 
```

然后你重新编译 A.dll

```
public class Foo 
{
     [OnlyOneAllowedOnAnyPropertiesPerClass]
     public int Property1 {get;}
} 
```

并尝试用旧的 B.dll 运行这个新的 A.dll（它们在所有其他方面都是二进制兼容的，所以这很好）

显然，运行时必须做相当大的努力来检查这一点，更不用说 B 可能会在一段时间内突然没有加载 使 A 和 B 中的一个或两个“非法”。

因此，您不应期望这将成为框架中可用的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T22:21:53.960

我认为在编译时不可能。但是您可以将一些代码添加到实例构造函数或静态构造函数中，该构造函数在运行时通过反射进行检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T23:01:04.490

如果它在编译时（或之后）很重要，您应该为您的属性创建一个[FxCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)规则或自定义搜索（类似于*[OnlyOnceAttribute]*的模式）。

```
findstr "[OnlyOnceAttribute]" *.cs 
```

*findstr*实用程序返回匹配的行。您只需要一个批处理文件来捕获行数并将错误[返回给调用者（=MSBuild 任务），然后构建失败。](http://geekswithblogs.net/SudheersBlog/archive/2007/10/19/116172.aspx)

# c# - 如何获取带有加号和括号的电话号码并返回号码？

> ID：774852
> 
> 赞同：2
> 
> 时间：2009-04-21T22:07:52.187
> 
> 标签：c#, regex, phone-number

我有一个简单的问题，我有一部这样的电话：+1 (123) 123-1234，我想使用正则表达式从该字符串中取出数字。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-21T22:10:03.117

这将去掉一个非数字字符：

```
string input = "+1 (123) 123-1234";
string digits = Regex.Replace(input,@"\D",string.Empty); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-21T22:54:02.073

使用 RegEx 是一种解决方案。 **另一种方法是使用 LINQ**（前提是您使用的是 .Net 3.5）

```
 string myPhone = "+1 (123) 123-1234";
    string StrippedPhone = new string((from c in myPhone
                                       where Char.IsDigit(c)
                                       select c).ToArray()); 
```

最终结果是相同的，但我认为在这种情况下 LINQ 比 RegEx 提供了一些优势。首先，可读性。RegEx 要求您知道“D”表示非数字（与 Char.IsDigit() 相比）- 这里的评论中已经存在混淆。另外，我做了一个非常简单的基准测试，每个方法执行 100,000 次。

LINQ：127 毫秒

正则表达式：485 毫秒

因此，乍一看，似乎 LINQ 在这种情况下执行了正则表达式。而且，我认为它更具可读性。

```
 int i;
    int TIMES = 100000;
    Stopwatch sw = new Stopwatch();
    string myPhone = "+1 (123) 123-1234";

    // Using LINQ            
    sw.Start();
    for (i = 0; i < TIMES; i++)
    {
        string StrippedPhone = new string((from c in myPhone
                                           where Char.IsDigit(c)
                                           select c).ToArray());
    }
    sw.Stop();
    Console.WriteLine("Linq took {0}ms", sw.ElapsedMilliseconds);

    // Reset 
    sw.Reset();

    // Using RegEx
    sw.Start();
    for (i = 0; i < TIMES; i++)
    {
        string digits = Regex.Replace(myPhone, @"\D", string.Empty);
    }
    sw.Stop();
    Console.WriteLine("RegEx took {0}ms", sw.ElapsedMilliseconds);

    Console.ReadLine(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T22:12:35.373

```
string digits = Regex.Replace(input, @"[^\d]", String.Empty); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-21T22:11:33.800

为什么不直接更换？

```
string phoneNumber = "+1 (123) 123-1234";
phoneNumber = phoneNumber.Replace("+", "");
phoneNumber = phoneNumber.Replace("(", "");
phoneNumber = phoneNumber.Replace(")", "");
phoneNumber = phoneNumber.Replace("-", "");
phoneNumber = phoneNumber.Replace(" ", ""); 
```

# php - 将纯文本输入转换为 HTML

> ID：774854
> 
> 赞同：1
> 
> 时间：2009-04-21T22:09:28.127
> 
> 标签：php, mysql, html, user-interface

对于我们公司的内部网，内置 PHP 和 MySQL，我想添加一个区域，员工可以在其中发布自己的简短个人资料 - 几段文字和一张图片。

将这种纯文本输入转换为 HTML 段落、项目符号列表、链接等的最佳方法是什么？

**澄清**：当您在办公室地图上单击员工的办公桌时，此内容将以模式显示，因此单独的 wiki 或类似的东西将不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T22:14:08.053

您可以实现一些非常简单的类似 wiki 的标记，尽管此处的“简单”可能会有所不同；[考虑使用Markdown](http://daringfireball.net/projects/markdown/)之类的东西来加速这个过程。

如果您的受众不是很技术，您可以尝试简单地将“富文本编辑器”类型的控件集成到页面上，使用[FCKeditor](http://www.fckeditor.net/)或[TinyMCE](http://tinymce.moxiecode.com/)之类的东西，您可以从中删除/禁用多余的控件。这为您的用户提供了一种更熟悉的所见即所得风格的行为。

在任何情况下，您都可以执行一些简单的白名单来限制允许通过的 HTML 子集。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-22T04:28:22.257

对于最简单、最直观的解决方案，有很多话要说。Stackoverflow 是一个程序员社区，因此人们对这种“Markdown”标记非常满意。

但是为了让不习惯使用任何类型标记的普通人更容易使用它，那么最基本的解决方案可能是最好的，因此他们在输入时看到的内容与输入内容之间的差异绝对是最小的原来是在网站上。类似的东西

```
$html = "<p>"
  . preg_replace("\n\r?\n", "</p><p>", htmlspecialchars($text))
  . "</p>"; 
```

它没有任何格式，除了一个空行会创建一个分节符，但取决于受众，例如，如果是普通受众，您可能会发现这是一个更好的主意。如果你给非技术人员一个格式化的标记语法，你可能会发现它要么让他们感到困惑，要么他们使用不正确，弄乱了一些东西，需要帮助，或者你可能会发现他们在格式化上太过分了，使用了尽可能多的文本风格尽可能。

在我的角色中，我维护一个 MediaWiki wiki 作为这家公司的内部网，并且注意到一般来说，虽然拥有一个 wiki 是一个好主意，但它的标记语言不适合一般的非技术受众，其中许多人更喜欢用 MS Word 写东西，因为这对他们来说很熟悉，然后将 Word 文档上传到 wiki。

另一个选项是 wiki 软件中的 WYSIWYG 编辑控件。它需要很好，并且尽可能接近“实际”所见即所得。在服务器端过滤后弄乱的预览中应该不可能得到看起来不错的东西，因为有人会找到一种方法来做到这一点。

如何让非技术人员在页面之间创建链接是另一回事，您可能会发现它很复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T16:49:37.713

虽然您可以使用 FCKEditor 之类的 WYSIWYG 编辑器，但您可以使用许多[轻量级标记语言](http://en.wikipedia.org/wiki/Lightweight_markup_language)。流行的包括

*   [Markdown](http://en.wikipedia.org/wiki/Markdown) - 由您正在阅读的网站使用（尽管我相信[SO fork 编辑系统的元素](https://blog.stackoverflow.com/2008/12/reverse-engineering-the-wmd-editor/)）
*   [Textile](http://en.wikipedia.org/wiki/Textile_(markup_language)) - 这个被流行的[Basecamp](http://www.basecamphq.com/)项目消息系统使用
*   [BBCode](http://en.wikipedia.org/wiki/BBCode) - 在许多论坛上使用，但我认为它不支持项目符号列表

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T22:13:40.800

公司 wiki 页面对此很有用，并且使用户可以轻松地对其进行格式化。也有一些开源软件。

# javascript - jquery切换效果重置元素宽度

> ID：774855
> 
> 赞同：1
> 
> 时间：2009-04-21T22:09:45.317
> 
> 标签：javascript, jquery, animation

出于某种原因，当我使用带有速度选项的 jquery 切换功能时，元素宽度会同时进行动画处理（从宽度的 50% 到其全部范围）。我不记得在以前版本的 jquery 中注意到它。有没有办法确保切换不会触及宽度？问题是我在元素中有一些浮动内容，所以当切换时，浮动布局被破坏，直到动画完成。有想法该怎么解决这个吗？

我正在使用最新版本的 jquery：1.3.2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T22:16:03.350

如果您只想沿垂直轴切换，请查看[slideToggle](http://docs.jquery.com/Effects/slideToggle#speedcallback)函数。

# .net - 如何使用 Linq to XML 检索数据？

> ID：774860
> 
> 赞同：1
> 
> 时间：2009-04-21T22:10:20.853
> 
> 标签：.net, linq-to-xml

我需要从以下 XML中查找和`ShippingMethod`属性：`Code``Destination`

```
<ScoreRule>
    <ShippingMethod Code="UPS1DA">
        <Destination Country="US" Area="IL" Value="0" />
    </ShippingMethod>
</ScoreRule> 
```

如何使用 Linq to XML 检索该数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T22:32:05.043

这是你想要的吗？

```
XElement scoreRuleElement = XElement.Parse("<ScoreRule><ShippingMethod Code=\"UPS1DA\"><Destination Country=\"US\" Area=\"IL\" Value=\"0\" /></ShippingMethod></ScoreRule>");

XElement shippingMethodElement = scoreRuleElement.Element("ShippingMethod");
string code = shippingMethodElement.Attribute("Code").Value;
XElement destinationElement = shippingMethodElement.Element("Destination"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T23:00:29.640

这是用于选择它的 XML 查询表达式的链接。

我不知道您是如何加载初始数据的，所以我只是将其解析为一个文档，但您应该根据获取数据的方式创建 XDocument。

```
var data = XDocument.Parse("<ScoreRule><ShippingMethod Code=\"UPS1DA\"><Destination Country=\"US\" Area=\"IL\" Value=\"0\" /></ShippingMethod></ScoreRule>");

            var results = from item in data.Descendants("ShippingMethod")
                          select new
                              {
                                  ShippingMethodCode = item.Attribute("Code").Value,
                                  Country = item.Element("Destination").Attribute("Country").Value,
                                  Area = item.Element("Destination").Attribute("Area").Value
                              }; 
```

# perl - 是否有用于解析柱状文本的 Perl 模块？

> ID：774861
> 
> 赞同：2
> 
> 时间：2009-04-21T22:10:27.187
> 
> 标签：perl, parsing, module

假设我有一个制表符分隔的文本文件，其中包含按列排列的数据（带有标题）。

不同的列可以“堆叠”成类似“工作表”的排列，即有一些分隔线（可能提前知道也可能不知道）允许垂直排列不同的列。

是否有一个 Perl 模块可以帮助将此文本文件中的列数据解析为数据结构（例如，一个哈希表，其中键是列标题，值是列数据标量数组）？

**编辑**“堆叠”是指一列文本可能包含多个单独的数据“向量”，每个“向量”都有不同的标题和不同的长度。诚然，这使解析变得复杂。

**编辑**老实说，我不确定混乱在哪里。尽管如此，这里有一个例子：

```
header_one\theader_three
data_1\tdata_7
data_2\tdata_8
data_3\tdata_9
\tdata_10
header_two\tdata_11
data_4\theader_four
data_5\tdata_12
data_6\tdata_13
\tdata_14 
```

该脚本会将其转换为具有四个键的哈希表：`header_one`、`header_two`、`header_three`和`header_four`，每个键引用指向`data_n`标题下方元素的数组引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T23:18:29.223

我认为这与您所说的很接近。如果列数发生变化，则将输入视为不同的表。可以轻松修改此代码以识别其他标记（例如等号行），而不是使用列计数。

```
#!/usr/bin/perl

use strict;
use warnings;

use Text::CSV_XS;

#setup the parser, here we want tab separated and we allow
#loose quoting, so qq/foo\t"bar\tbaz"\tquux/ is 
#("foo", "bar\tbaz", "quux")
my $p = Text::CSV_XS->new(
    {
        sep_char           => "\t",
        allow_loose_quotes => 1,
    }
);

my @stacked;
my $cur = 0;
while (<>) {
    $p->parse($_) or die $p->error_input;
    my @rec = $p->fields;
    #normal case, just add the record to the last
    #section in @stacked
    if (@rec == $cur) {
        push @{$stacked[-1]}, \@rec;
        next;
    }
    #if the number of columns don't match then
    #we have a new section
    push @stacked, [\@rec];
    $cur = @rec; #set the new number of columns
}

for my $table (@stacked) {
    print "header: ", join("::", @{$table->[0]}), "\n";
    for my $i (1 .. $#$table) {
        print "data: ", join("::", @{$table->[$i]}), "\n";
    }
    print "\n";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T22:13:57.257

如果可能，我将从[DBD::CSV](http://search.cpan.org/~jzucker/DBD-CSV-0.22/lib/DBD/CSV.pm)开始，尽管您的“堆叠”要求（我不完全理解）可能需要使用[Text::CSV_XS](http://search.cpan.org/~hmbrand/Text-CSV_XS-0.64/CSV_XS.pm)进行一些手动解析。

不要被他们的名字所迷惑——他们可以使用任何分隔符进行解析，而不仅仅是逗号。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-21T22:26:28.427

不是很顺利，但我一直在这样做：

```
 my $recordType = unpack("A3", $_);

        if ($recordType eq "APT")
        {
            $currentKey = parseFAAAirportAirportRecord($_);
        }
        elsif ($recordType eq "ATT")
        {
            parseFAAAirportAttendenceRecord($currentKey, $_);
        }
        elsif ($recordType eq "RWY")
        {
            parseFAAAirportRunwayRecord($currentKey, $_);
        }
        elsif ($recordType eq "RMK")
        {
            parseFAAAirportRemarkRecord($currentKey, $_);
        }
...
sub parseFAAAirportAirportRecord($)
{
    my ($line) = @_;

    my ($recordType, $datasource_key, $type, $id, $effDate, $faaRegion,
        $faaFieldOffice, $state, $stateName, $county, $countyState,
        $city, $name, $ownershipType, $facilityUse, $ownersName,
        $ownersAddress, $ownersCityStateZip, $ownersPhone, $facilitiesManager,
        $managersAddress, $managersCityStateZip, $managersPhone,
        $formattedLat, $secondsLat, $formattedLong, $secondsLong,
        $refDetermined, $elev, $elevDetermined, $magVar, $magVarEpoch, $tph,
        $sectional, $distFromTown, $dirFromTown, $acres,
        $bndryARTCC, $bndryARTCCid,
        $bndryARTCCname, $respARTCC, $respARTCCid, $respARTCCname,
        $fssOnAirport, $fssId, $fssName, $fssPhone, $fssTollFreePhone,
        $altFss, $altFssName,
        $altFssPhone, $notamFacility, $notamD, $arptActDate,
        $arptStatusCode, $arptCert,
        $naspAgreementCode, $arptAirspcAnalysed, $aoe, $custLandRights,
        $militaryJoint, $militaryRights, $nationalEmergency, $milUse,
        $inspMeth, $inspAgency, $lastInsp, $lastInfo, $fuel, $airframeRepairs
,
        $engineRepairs, $bottledOyxgen, $bulkOxygen,
        $lightingSchedule, $tower, $unicomFreqs, $ctafFreq, $segmentedCircle,
        $lens, $landingFee, $isMedical,
        $numBasedSEL, $numBasedMEL, $numBasedJet,
        $numBasedHelo, $numBasedGliders, $numBasedMilitary,
        $numBasedUltraLight,
        $numScheduledOperation, $numCommuter, $numAirTaxi,
        $numGAlocal, $numGAItinerant,
        $numMil, $countEndingDate,
        $aptPosSrc, $aptPosSrcDate, $aptElevSrc, $aptElevSrcDate,
        $contractFuel, $transientStorage, $otherServices, $windIndicator,
        $icaoId) =
        unpack("A3 A11 A13 A4 A10 A3 A4 A2 A20 A21 A2 A40 " .
        "A42 A2 A2 A35 A72 A45 A16 A35 A72 A45 A16 A15 A12 A15 A12 A1 A5 A1 " .
        "A3 A4 A4 A30 A2 A3 A5 A4 A3 A30 A4 A3 A30 A1 A4 A30 A16 A16 " .
        "A4 A30 A16 A4 " .
        "A1 A7 A2 A15 A7 A13 A1 A1 A1 A1 A18 A6 A2 A1 A8 A8 A40 A5 A5 A8 " .
        "A8 A9 A1 A42 A7 A4 A3 A1 A1 A3 A3 A3 A3 A3 A3 A3 " .
        "A6 A6 A6 A6 A6 A6 A10" .
        "A16 A10 A16 A10 A1 A12 A71 A3 A7", $line); 
```

# python - Python中列表组合中的多个语句？

> ID：774876
> 
> 赞同：16
> 
> 时间：2009-04-21T22:14:48.767
> 
> 标签：python, list-comprehension

是否有可能有类似的东西：

```
list1 = ...

currentValue = 0
list2 = [currentValue += i, i for i in list1] 
```

我试过了，但没有用？写这些的正确语法是什么？

编辑：打印语句就是一个例子。实际上我是在循环外增加一个值。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-21T22:45:01.677

语句*不能*进入 Python 中的表达式；这是一种故意用语言设计的复杂功能。对于这个问题，请尝试使用**确实**使其成为语言的复杂性：生成器。手表：

```
def total_and_item(sequence):
    total = 0
    for i in sequence:
        total += i
        yield (total, i)

list2 = list(total_and_item(list1)) 
```

生成器保留到目前为止看到的项目的运行记录，并将其添加到每个项目的前缀，就像您的示例尝试做的那样。当然，一个简单的循环可能更简单，它在顶部创建一个空列表，并且只调用 append() 很多！:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-21T22:18:46.013

我不太确定您要做什么，但可能类似于

```
list2 = [(i, i*2, i) for i in list1]
print list2 
```

列表推导中的语句必须是单个语句，但您始终可以将其设为函数调用：

```
def foo(i):
    print i
    print i * 2
    return i
list2 = [foo(i) for i in list1] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-22T16:33:03.463

正如 pjz 所说，您可以使用函数，因此在这里您可以使用闭包来跟踪计数器值：

```
# defines a closure to enclose the sum variable
def make_counter(init_value=0):
    sum = [init_value]
    def inc(x=0):
        sum[0] += x
        return sum[0]
    return inc 
```

然后你用list1做你想做的事：

```
list1 = range(5)  # list1 = [0, 1, 2, 3, 4] 
```

现在只有两行，我们得到 list2：

```
counter = make_counter(10)  # counter with initial value of 10
list2 = reduce(operator.add, ([counter(x), x] for x in list1)) 
```

最后，list2 包含：

```
[10, 0, 11, 1, 13, 2, 16, 3, 20, 4] 
```

这就是您想要的，您可以在循环后通过一次调用获取计数器的值：

```
counter()  # value is 20 
```

最后，你可以用任何你想要的操作来替换闭包，这里我们有一个增量，但这完全取决于你。另请注意，我们使用 reduce 来展平 list2，这个小技巧要求您在使用 reduce 调用该行之前导入*运算符：*

```
import operator 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T22:20:33.637

[这是另一个问题](https://stackoverflow.com/questions/364621/python-get-position-in-list/364769#364769)的示例：

```
[i for i,x in enumerate(testlist) if x == 1] 
```

枚举生成器返回一个进入 i,x 的 2 元组。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T22:18:18.587

首先，您可能不想使用`print`. 它不返回任何内容，因此`for`如果您只想打印内容，请使用常规循环。您正在寻找的是：

```
>>> list1 = (1,2,3,4)
>>> list2 = [(i, i*2) for i in list1] # Notice the braces around both items
>>> print(list2)
[(1, 2), (2, 4), (3, 6), (4, 8)] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-21T22:25:15.560

在列表理解中调用打印是一件奇怪的事情。如果您向我们展示了您想要的输出，而不仅仅是不起作用的代码，将会有所帮助。

这里有两个猜测给你。无论哪种方式，重要的一点是列表推导中的值语句必须是*单个*值。您不能一次插入多个项目。（如果这就是您要执行的操作，请跳至第二个示例。）

```
list1 = [1, 2, 3]
list2 = [(i, i*2, i) for i in list1]
# list2 = [(1, 2, 1), (2, 4, 2), (3, 6, 3)] 
```

要获取平面列表：

```
list1 = [1, 2, 3]
tmp = [(i, i*2) for i in list1]
list2 = []
map(list2.extend, tmp)
# list2 = [1, 2, 1, 2, 4, 2, 3, 6, 3] 
```

编辑：在列表理解的中间增加一个值仍然很奇怪。如果你真的需要这样做，你最好只编写一个常规的 for 循环，并在你去的时候附加值。在 Python 中，像这样的聪明几乎总是被贴上“unpythonic”的标签。如果你必须这样做，但你会在这样的论坛中得到无休止的抨击。;)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-21T23:46:55.800

对于您编辑的示例：

```
currentValue += sum(list1) 
```

或者：

```
for x in list1:
    currentValue += x 
```

列表推导很棒，我喜欢它们，但是简陋的`for`循环并没有错，你不应该害怕使用它 :-)

编辑：“但是如果我想增加与收集的值不同的值怎么办？”

那么，你想增加什么？您拥有 python 的全部功能！

按 x 平方递增？

```
for x in list1:
    currentValue += x**2 
```

增加 x 的某个函数及其在列表中的位置？

```
for i, x in enumerate(list1):
    currentValue += i*x 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-24T06:02:04.653

为什么要创建重复列表。似乎列表理解所做的只是对内容求和。

为什么不只是。

```
list2 = list(list1)   #this makes a copy
currentValue = sum(list2) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-21T22:36:57.607

你不能做多个语句，但你可以做一个函数调用。要执行您在上面似乎想要的操作，您可以执行以下操作：

```
list1 = ...
list2 = [ (sum(list1[:i], i) for i in list1 ] 
```

通常，由于列表推导是 python 的“功能”部分的一部分，因此您仅限于...函数。其他人建议您可以在必要时编写自己的函数，这也是一个有效的建议。

# active-directory - 基于 Web 的 LDAP 浏览器

> ID：774881
> 
> 赞同：4
> 
> 时间：2009-04-21T22:17:13.957
> 
> 标签：active-directory, ldap, jndi, adam, sunone

是否有人知道允许开发人员浏览 LDAP 服务器并查看 objectClasses 和 attributeClasses 的“基于 Web”的应用程序？理想情况下，我会喜欢用 Java 或 .NET 编写的开源软件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-22T00:01:12.927

您有通用工具，例如 [http://ldapweb.sourceforge.net/](http://ldapweb.sourceforge.net/) (HP) 和 [http://ldapusrmgr.sourceforge.net/](http://ldapusrmgr.sourceforge.net/)

许多目录产品开箱即用，具有非常强大的 Web 界面，例如 [Sun Java System Directory Server Enterprise Edition](http://www.sun.com/software/products/directory_srvr_ee/)，它也是“免费的”。我相信使用 DSEE webmin 工具，如果您也设置了“虚拟目录”，您也可以访问其他目录服务器的数据。

您还可以跳出框框，使用 OpenSSO 之类的工具进行基本的目录编辑（尽管它不会暴露 LDAP 安装的太多细节，只是一种编辑实际数据的方法。

我个人喜欢 Apache Directory Studio，它是一个基于 Eclipse 的桌面应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-22T13:00:38.623

虽然不是 Java 或 .Net，但也有 phpLDAPadmin：

[http://phpldapadmin.sourceforge.net/wiki/index.php/Main_Page](http://phpldapadmin.sourceforge.net/wiki/index.php/Main_Page)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-06T15:59:43.263

不是用 Java 或 .NET编写的[——web2ldap](https://www.web2ldap.de/web2ldap.htm)是用 Python 编写的，但它是在[Apache 2.0 许可](https://www.web2ldap.de/download.html#license)下开源的，而且——可以说是最重要的——它仍然在**2021 年 9 月**得到积极维护。

# javascript - 对于 Web UI 专家

> ID：774895
> 
> 赞同：1
> 
> 时间：2009-04-21T22:20:24.137
> 
> 标签：javascript, jsp, user-interface

我终于在我的网络应用程序中达到了实现简单要求变得势不可挡的地步。我猜是时候进行一次漂亮的重构或简单的垃圾和重做了。

以下是我需要在表上实现的简单要求：

1) 使列可排序 2) 冻结 2 个标题行和前 3 列

现在让我解释一下为什么它变得如此复杂。该表不是简单的二维表。前 3 列是名称、电子邮件和角色，之后有不确定数量的列代表每天 3 种类型的数据。换句话说，用户将定义他想要多少天的数据，并且每一天将由我们称为 data1、data2 和 data3 的 3 列表示。

一个不熟练的 ASCII 表示会是这样的：

```
 01/01/1970                 01/02/1970                 total
name    email    role    data1    data2    data3    data1    data2    data3    data1    data2    data3 

toto    t@t.com  boss     23      test     54       10       test1    54 
```

这是一个非常糟糕的表示，但它应该让您对输出应该是什么样子有一个模糊的概念。所以我需要在第一行显示日期，但是 3 列偏移，然后是 3 个第一个标题是固定的标题，但以下列是相同 3 个标题的重复，每天一个，最后我需要把所有数据在正确的地方......

现在，我使用 JSP 和来自控制器的自定义数据结构来正确显示它（虽然没有排序，也没有冻结），我以不同的方式迭代以显示所有元素。

现在你可能开始理解我的头痛了......有这么多定制的东西，也许不一定以正确/有效的方式完成我将如何添加这些新功能？分类和冷冻？

我确实查看了一些 jquery 数据网格和其他 javascript 组件，但它们似乎都不够灵活，无法允许 2 行标题，第二行基于第一行分组。

任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T03:58:05.353

这是一个非常自定义的 GUI，所以我会使用一个相当本土的解决方案。我会将问题分解为几个步骤，并让浏览器负责大部分工作（ergo JavaScript）。

首先，您希望对象代表数据。基于这个问题，我建议你有一个三层的对象结构：一层代表用户（示例中的每一行）；此对象中的子数组将保存每天的数据；并且数组的每个成员都是一个对象，其中包含用户选择的单元格。JSP 将负责写出这个数据结构，但 JavaScript 会从那里获取它。下面是构造函数的样子：

```
function DayOfData(dateString, dataObject) {
    this.date = Date.parse(dateString); //storing a Date is cleaner separation of presentation & data
    this.dataCells = dataObject;
}
function User(name, email, role) {
    this.name = name; //and so on
    this.data = [];
    this.addData = function(date, dataSet) {
        this.data.push( new DayOfData(date, dataObject) );
    }
} 
```

JSP（或任何中间层）编写的实例如下所示：

```
var users = [];    //a global to hold it all
users[someId] = new User("foo", "foo@something.org", "boss");
users[someId].addData("1/1/1970", {"label 1": 23, "label 2": "test"} );
//...and so on 
```

请注意存储用户选择显示的数据单元格的 JSON 对象。在这个匿名对象中，我将视觉标签与值相关联；这比创建另一个子对象以从某个唯一 ID 中抽象标签要简单。如果确实有必要，您可以采取额外的步骤，但这是层次结构中的一个级别，所以我认为最好采用更简单的路线。

（当然，你会想要正确地命名所有这些......我正在使用裸全局变量来简化语法。对于一个真正强大的系统，我也会使用私有成员。）

我会在显示阶段使用 TrimPath（在 JSP 写出此结构中的数据之后）。只需将 users 数组传递给一个看起来像这样的模板（在 TrimPath 处理它之后，显示代码将把它放在一个表中）：

```
<tbody>
    {for user in user}
        <tr>
            <td>${user.name}</td> <!-- and so on -->
            {for day in user.data}
                {for datum in day}
                    <td>${datum}</td>
                {/for}
            {/for}
        </tr>
    {for}
</tbody> 
```

您需要对这种模式稍作改动来编写标题行，尽管您可能可以在服务器端代码中更轻松地做到这一点，因为它不是 GUI 的动态部分。要让标签行在表格顶部“冻结”（它将在 THEAD 元素中），只需使用 CSS 设置 TBODY 的高度，然后将 overflow-y 设置为“滚动”。那应该可以达到你想要的效果。

要对列重新排序，您实际上需要根据用户单击的列重新排序 users 数组（参见[Array.sort的描述）。](http://www.w3schools.com/jsref/jsref_sort.asp)然后，清除 TBODY 并使用[TrimPath](http://code.google.com/p/trimpath/wiki/JavaScriptTemplates)重新处理模板。

这听起来很复杂而且很复杂，但实际上并非如此。您希望避免难以更改布局，因此分离数据和表示是关键。一组纯数据 JavaScript 对象与上面概述的 TrimPath（或类似）模板相结合，实现了良好的 MVC 模式，并通过将问题分解为离散的步骤使问题变得更简单。管理可排序的数据表（更不用说水平分组到主要部门的数据）——如果没有好的 MVC，这几乎是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T09:13:43.550

迄今为止我见过的最好的 UI 框架是 ExtJs。您可以访问：[http](http://extjs.com/deploy/dev/examples/grid/array-grid.html) ://extjs.com/deploy/dev/examples/grid/array-grid.html以查看他们的网格在运行中。它非常易于使用和支持。

# c++ - 在 C++ 中使用花括号实例化对象是什么意思？

> ID：774898
> 
> 赞同：10
> 
> 时间：2009-04-21T22:20:40.563
> 
> 标签：c++, data-structures, constructor

假设我有一个结构定义为：

```
typedef
struct number{
    int areaCode;
    int prefix;
    int suffix;
} PhoneNumber; 
```

当我创建这个结构的一个实例时，如果我使用以下语法：

```
PhoneNumber homePhone = {858, 555, 1234}; 
```

...它调用的是哪个构造函数？默认构造函数，或复制构造函数，或者根本没有，因为它没有调用'new'？

这个问题的真正目的是弄清楚如何添加第四个字段。所以我想将我的结构重新定义为：

```
typedef
struct number{
    int areaCode;
    int prefix;
    int suffix;
    int extension; // NEW FIELD INTRODUCED
} PhoneNumber; 
```

所以现在，我可以使用四个字段创建新的 PhoneNumber 对象：

```
PhoneNumber officePhone = {858, 555, 6789, 777} 
```

但是，我已经创建了数百个这样的 PhoneNumber 实例，只有 3 个字段（xxx、xxx、xxxx）。因此，我不想检查和修改已定义的 PhoneNumber 对象的每一个实例。我希望能够不理会这些，但仍然能够创建具有四个字段的新电话号码实例。所以我试图弄清楚如何覆盖构造函数，以便我现有的三参数实例不会中断，但它也将支持我的新四参数实例。

当我尝试定义一个采用 3 个字段并将第四个字段设置为默认值“0”的覆盖默认构造函数时，我收到错误（在代码的实例化部分，而不是构造函数定义中）抱怨我的对象必须由构造函数，而不是 {...}。所以似乎如果我确实覆盖了默认构造函数，我就不能再使用花括号来创建我的新对象了？

抱歉，如果这完全偏离了原始问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T22:44:42.283

成员实际上是复制初始化的。每个人的默认构造函数都没有被调用，并且`operator=`与其他一些答案所暗示的相反，没有涉及到。它可以通过一个名为`geordi`- 或者通过阅读标准的软件来显示。我将展示使用该软件的“有趣”方式。它有一个类`tracked::B`可以告诉我们何时调用构造函数/复制构造函数或析构函数/复制赋值运算符。它显示的输出是（`TRACK`限制跟踪到它后面的语句）：

```
B1*(B0) B1~ 
```

我用了这段代码

```
struct T { tracked::B b; }; int main() { tracked::B b; TRACK T t = { b };  } 
```

如您所见，第二个`B`对象（局部变量中的成员`t`）是从另一个对象复制初始化的`b`。当然，没有激活赋值运算符。`12.6.1/2`如果您愿意，您可以在标准中阅读有关它的信息。

顺便说一句，数组（同样是聚合）也是如此。许多人认为作为数组成员的对象必须具有具有默认构造函数的类型。但事实并非如此。它们可以由它们类型的另一个对象复制初始化，并且可以正常工作。

聚合中未显式初始化的所有*其他*元素都是值初始化的。值初始化是默认初始化和零初始化的混合。实际上，如果成员的类型具有用户声明的构造函数，则调用该构造函数。如果它的类型没有*用户*声明的构造函数，那么它的每个成员都是值初始化的。对于内置类型（int、bool、指针等），值初始化与零初始化相同（这意味着此类变量将变为零）。以下将每个成员初始化为零 - 第一个 (a) 除外，它将是一个：

```
struct T { int a, b, c; }; int main() { T t = { 1 }; } 
```

这些初始化规则确实很可怕——尤其是因为 2003 年的 C++ 版本引入了值初始化。它[不是](https://stackoverflow.com/questions/734958/c-empty-paren-member-initialization-zeroes-out-memory/735007#735007)1998 年标准的一部分。如果您对括号括起来的初始化更感兴趣，您可以阅读[如何在 C++ 中初始化嵌套结构？](https://stackoverflow.com/questions/629433/how-to-initialize-nested-structures-in-c/629448#629448).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T22:50:11.443

正如其他人所写的那样，它没有调用默认的ctor。从概念上讲，它是相同的，但在实践中，您会发现汇编代码中没有函数调用。

相反，成员保持未初始化；您正在使用花括号构造初始化它们。

有趣的是，这个：

```
PhoneNumber homePhone = {858, 555, 1234}; 
```

此程序集的结果（GCC 4.0.1，-O0）：

```
movl  $858, -20(%ebp)
movl  $555, -16(%ebp)
movl  $1234, -12(%ebp) 
```

那里没有多少惊喜。该程序集内联包含上述 C++ 语句的函数。值（以 $ 开头）被移动（movl）到堆栈（ebp 寄存器）的偏移量中。它们是负数，因为结构成员的内存位置在初始化代码之前。

如果您没有完全初始化结构，即省略一些成员，如下所示：

```
PhoneNumber homePhone = {858, 555}; 
```

...然后我得到以下汇编代码：

```
movl  $0, -20(%ebp)
movl  $0, -16(%ebp)
movl  $0, -12(%ebp)
movl  $858, -20(%ebp)
movl  $555, -16(%ebp) 
```

似乎编译器实际上做了一些与调用默认构造函数非常相似的事情，然后是赋值。但同样，这是在调用函数中的内联，而不是函数调用。

另一方面，如果您定义了一个将成员初始化为给定值的默认构造函数，如下所示：

```
struct PhoneNumber {
  PhoneNumber()
    : areaCode(858)
    , prefix(555)
    , suffix(1234)
  {
  }

  int areaCode;
  int prefix;
  int suffix;
};

PhoneNumber homePhone; 
```

然后你得到实际调用函数的汇编代码，并通过指向结构的指针初始化数据成员：

```
movl  8(%ebp), %eax
movl  $858, (%eax)
movl  8(%ebp), %eax
movl  $555, 4(%eax)
movl  8(%ebp), %eax
movl  $1234, 8(%eax) 
```

每一行都`movl 8(%ebp), %eax`将指针值（eax 寄存器）设置为结构数据的开头。在其他几行中，直接使用eax，偏移量为4，偏移量为8，类似于前两个示例中的直接堆栈寻址。

当然，所有这些都是特定于编译器实现的，但如果其他编译器做了一些非常不同的事情，我会感到惊讶。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T23:42:42.940

至少对我来说，初始化是 C++ 标准中最难的部分之一。您使用的语法：`Aggregate x = { 1, 2, 3, 4 };`定义聚合类型的初始化，前四个成员赋值为 1、2、3 和 4。

作为对您的特定情况的说明（结构已从 3 个元素增长到 4 个元素），大括号之间的初始化列表中不存在的字段将被*value initialized*，特别是对于标量类型，它等同于*零初始化*本身与分配 0 相同。因此，您的第四个元素将被初始化为 0。

**参考**

它都在 C++ 标准第 8.5 章中定义，更准确地说是在 8.5.1 聚合中定义。不会使用任何隐式声明的默认构造函数初始化聚合。如果您使用上面的语法，则要求编译器使用提供的值初始化给定的字段。聚合中的任何额外字段都应进行*值初始化*

现在，如果类型是具有此类构造函数的类，则*值初始化被定义为对用户定义的默认构造函数的调用。*如果它是没有用户定义构造函数的数组或非联合类，则每个成员属性都将被*初始化*。否则，对象将被*零初始化*，然后再次定义为...

*零初始化*定义为将标量类型的值设置为 0。对于类，每个类数据成员和基类都将被*零初始化*。对于联合，第一个成员（仅）将被*零初始化*，对于数组，所有成员都将被*零初始化*。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T22:22:59.637

C++ 中的结构就像一个类。正在调用默认构造函数。之后，每个字段都使用其赋值运算符进行复制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T22:21:50.483

它有效地调用了默认的ctor；发生的事情是分配了一个结构，并使用默认“=”分配了每个值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T23:15:35.207

> 但是，我已经创建了数百个这样的 PhoneNumber 实例，只有 3 个字段（xxx、xxx、xxxx）。因此，我不想检查并修改已定义的 PhoneNumber 对象的每一个实例。

没问题，您只需调用 update-instance-for-redefined-class 和......呃，没关系。继续标记这个“无用”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T00:25:32.930

您的类型不涉及构造函数，因此需要在聚合初始化站点修改现有的三参数语法。

除非您新添加的字段的语义，即。新的字段类型是“零设计感知”（.NET 编程、Brad 和 Co 等在设计指南废话中推荐的成语），你

不能 ：

a) 提供一些更有意义的东西作为 C++ 默认参数，如果有一些魔法涉及一种方法（默认/可选参数很快将在 grocers web 4.0 附近的大众市场 C# 商店和旧 COM 中可用）

你也不能

b）遵循类似 C# 的模式，将无效值标记为 0 的值类型设计（在这种情况下，如果您无法控制常量，这可以说是非常糟糕和糟糕的 - 源级库做得非常好，所有-JavaTM MS 类框架很烂）。

简而言之，如果 0 是一个有效值，那么您就被塞满了，并且大多数编译器编写者在任何托管样式或习语存在之前就认为它是有用的；但这不一定是正确的。

无论如何，你最好的机会不是 C++ 或 C#。它是代码生成，即。比现代 C++“模板”推动更自由的元编程。你会发现它类似于 JSON 数组注释，可以使用精神或（我的建议是）滚动你自己的实用程序。从长远来看，它会有所帮助，最终你会想要做得更好（即他们所说的跛脚人建模，也就是 .NET 中的 Oslo）。

[ 很多语言都有这样的问题，它是所有 C 风格语言（C、C++、Java、C#，你的名字）的缺点；非常类似于任何类型的跨域或语义 I/O 工作所需的数组数组，甚至在 SOAP 等 Web 技术中也很明显。新的 C++0x 可变参数位在这里也没有多大帮助，但显然可以如果您选择使用一些模板黑客，则可以带来指数级更快的编译时间。谁在乎 ：） ]

# sql-server - SQL Server - 表查找的查询性能

> ID：774902
> 
> 赞同：2
> 
> 时间：2009-04-21T22:21:39.237
> 
> 标签：sql-server, performance

我有一个数据库，我需要在其中查询以从一个表中获取记录，然后在另一个表上查找以查看该值是否存在于那里。该表可能会返回多条记录，我想要最近日期的记录。

所以表1基本上是：

```
ID (Primary Key)
Name
Test_Score 
```

表 2 是

```
Test_Id (Primary)
Student_ID (Foreign Key)
Test_Score
Test_Date 
```

当我浏览记录时，如果表 2 中不存在 Student_id 的测试，我想使用表 1 中的分数，否则我想使用表 2 中最近日期的分数。我有这一切都在 C# 代码中工作，但客户希望它在存储过程中用于报告目的，并且由于表非常大，我看到了一些性能问题。此外，这个基本示例实际上针对多个表多次发生。

我确信有一种优雅的方式可以快速高效地执行此操作，但除了使用光标之外，我似乎什么都想不出来。

有人知道直接的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T22:33:31.767

不是 100% 确定句法细节，但像这样：

```
select table1.Name, ISNULL(table2.Test_Score, table1.Test_Score)
from 
  table1
  left outer join table2
    on table1.id = table2.Student_ID
    AND table2.Test_Date = (
      select max(x.Test_Date)
      from table2 x
      where table1.id = x.Student_ID
      group by x.Student_ID) 
```

如果子查询所在的位置不允许，则将其移至 where 子句。（对不起，我现在无法尝试。）

仅当 Test_Date 是唯一的时，该查询才有效。如果没有，你会得到重复的结果。然后你应该使用 Group By

```
select table1.Name, min(ISNULL(table2.Test_Score, table1.Test_Score))
from 
  table1
  left outer join table2
    on table1.id = table2.Student_ID
    AND table2.Test_Date = (
      select max(x.Test_Date)
      from table2 x
      where table1.id = x.Student_ID
      group by x.Student_ID)
group by table1.id, table1.Name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T22:38:21.347

Stefan Steinegger 基本上有正确的答案。

通过功能分解让自己更轻松：编写一个视图，为每个学生提供最近日期的行。

然后将其外连接到学生表（您的问题中的表 1），并使用 isnull 或合并获取表 1 中视图中没有行的测试分数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T22:49:12.507

如果您使用的是 Sql Server 2005，那么公用表表达式 (CTE) 提供了一个优雅的解决方案。您为每个学生创建一个具有最新测试分数的 CTE，然后将连接左连接到学生表。如果结果存在于所使用的测试表中，则使用学生表中的分数。

我假设您的表分别称为 Student 和 TestResult，并且还假设 test_id 是一个自动递增的 ID

```
WITH RecentResults as (
  SELECT student_id,
     test_score
  FROM TestResult tr
  WHERE tr.test_id = (SELECT MAX(test_id) FROM TestResult WHERE student_id = tr.student_id)
)
SELECT s.ID as 'Student ID',
  isnull(rr.test_score, s.test_score)
FROM Students s LEFT JOIN RecentResults rr ON s.ID = rr.student_id 
```

我无法在这台机器上测试代码 - 如果您提供数据库模式将更容易改进。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T22:57:08.837

给你，在 SQL 2005 上测试解决方案，可以避免视图，但我同意它提高了清晰度

```
create table students (id int primary key, name nvarchar(50), score int) 
create table scores (test_id int, student_id int, score int, date datetime)

insert students values (1, 'bob', 1)
insert students values (2,'bill', 55)
insert scores values (22,1,88,getdate())
insert scores values (23,1,88,getdate() + 1 )
insert scores values (23,1,89,getdate() + 2 )

go

create view latest_scores
as
select scores.student_id, scores.date, score
from scores
join
(
  select student_id, date = max(date) from scores
  group by student_id 
) maxDates on maxDates.student_id = scores.student_id and maxDates.date = scores.date

go 

select Id, isnull(l.score, s.score) from students s
left join latest_scores l on student_id = id 
```

# version-control - 在不使用命令行的情况下管理修订的最佳方法是什么？

> ID：774919
> 
> 赞同：2
> 
> 时间：2009-04-21T22:24:35.890
> 
> 标签：version-control

我正在用 PHP/HTML/CSS/JS 编写一些简单的 Web 应用程序，并且正在寻找一种控制修订的方法。我每天都在更新源代码（目前将新版本保存在单独的文件夹中）。我真的没有命令行 fu，而且 git/subversion 看起来令人生畏。管理代码修订的最简单的非命令行方式是什么？它可以独立于平台，但我使用的是 Mac OS X。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T22:28:19.703

SVN 不一定必须通过命令行。它有很多 GUI 和 Web 界面。

在 Windows 中，我会推荐 TortoiseSVN。我刚刚搜索了“TortoiseSVN for OSX”，发现这个链接看起来很有希望：

[http://blog.evandavey.com/2008/03/tortoisesvn-for-mac-os-x-scplugin.html](http://blog.evandavey.com/2008/03/tortoisesvn-for-mac-os-x-scplugin.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T08:19:40.937

大多数商业工具都提供适用于 Mac 的 GUI，有些工具对 1 或 2 个用户免费。

您可能需要检查[perforce](http://www.perforce.com "强制执行")、[purecm](http://www.purecm.com)、[plasticscm](http://www.plasticscm.com)或[accurev](http://www.accurev.com)。

正如有人指出的那样，在mac（版本和更改）上也有很好的颠覆GUI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T22:27:14.323

对您选择的版本控制系统使用 GUI 前端。例如，谷歌搜索“subversion GUI Mac OS X”，[第二个结果](http://www.rubyrobot.org/tutorial/subversion-with-mac-os-x)在底部提到了几个 GUI 客户端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T22:31:10.507

IIRC Xcode 具有开箱即用的内置 subversion 支持。不过，我不确定这会让您在哪里实际设置服务器并创建存储库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T22:34:40.920

鉴于您使用的是 Mac，如果您碰巧使用 TextMate ( [http://macromates.com/](http://macromates.com/) )，那么有一个非常不错的 Subversion 包可用。

还有一个名为 Versions ( [http://versionsapp.com/](http://versionsapp.com/) ) 和 Cornerstone ( [http://www.zennaware.com/](http://www.zennaware.com/) ) 的商业产品让 svn 感觉很像 Visual Source Safe，带有图形浏览器等等。

最后，还有一个我不熟悉但看起来很有前途的新产品，称为 Changes ( [http://changesapp.com](http://changesapp.com) )，它集成了几个流行的编程编辑器。

很抱歉，所有这些都是商业解决方案，但我对 Mac 上免费 Subversion 客户端的状态印象并不深刻。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T22:56:45.500

内置在您的 GUI 中可能会很有帮助（我一直在使用它们，这里已经有很多好的建议）。

至于 CLI 很复杂，您需要了解以下内容：

```
svn co URL dir  #Check out a URL, get all the files into directory "dir"
svn up          #Get any updates
svn -m "" ci    #Send all your changes:
svn add         #add a new file
svn revert      #undo changes 
```

这些就是你做的大部分事情所需要的。你可以走很长时间而不做任何其他事情。

这并不是那么糟糕。

ci 具有该选项，因为它希望您使用消息来描述签入。如果你在引号之间加上描述，很酷；如果您忽略这些选项，它将提供其他有用的解决方案。

即使您使用 GUI，您也确实应该尝试适应这些。我并不是说要一直使用它，但是当程序员因为没有自己喜欢的工具而被停止使用时，它看起来永远不会非常专业；如果您可以在没有正常环境的情况下继续吃一两天，那就更令人印象深刻了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-21T23:00:50.047

看看[svnX](http://code.google.com/p/svnx/ "svnX")。我一直使用它，直到我对命令行界面感到满意为止。但是，老实说，当我不得不使用命令行客户端时，我可以正常使用它。只有两三个命令要学习，而且都很简单。

祝你好运，无论你的选择！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-21T23:05:37.273

许多优秀的（也许可以说都是优秀的）程序员编辑器对内置的修订系统有某种支持。至少对于日常操作而言。也许您不需要新工具？

# xna - 在 XNA 游戏中我应该把我的自定义关卡文件夹放在哪里？

> ID：774924
> 
> 赞同：2
> 
> 时间：2009-04-21T22:25:35.670
> 
> 标签：xna, storage

我对在我的游戏中存储 *.txt 级别文件的位置和方式感到非常困惑。

在我的游戏中，我想要的是一些随游戏安装的“预烘焙”关卡的可用性，以及用户创建自己的 OWN 关卡的能力。

所以我所做的是在 Visual Studio 中的“内容”中创建一个名为级别的新目录，并在其中放置一个“level1.txt”。但是我可以访问级别 *.txt 文件的唯一方法是使用完整路径，并且我不能在我的 Visual Studio 解决方案中包含它们，因为它没有构建：

```
 "C:\My Documents\blahblabh....\levels\level1.txt" 
```

*   我是否将这些“预烘焙”地图放入可执行文件附近的某个目录中？在编译项目之前，如何在 /bin 目录中创建一个目录？
*   ~~如何禁止用户删除随游戏安装的“预烘焙”关卡？~~
    （我不再需要这个）
*   另外，我在哪里存储用户自定义创建的级别？我认为应该使用 StorageDevice 来完成。但这与第一个问题有关如何在游戏部署后创建目录。

欢迎任何指点！谢谢

编辑：回复：自定义内容处理器。这似乎比我需要的要复杂得多。但是我还需要将我的游戏部署到 xbox360，那么存储设备可以工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T22:45:36.010

您可以编写一个自定义内容处理器来处理您的关卡文件，但这可能是矫枉过正。这样做的好处是您可以将关卡“编译”为用户更难以修改的某种格式。

您可以将其添加到您的项目（不在内容中）并在属性中指定“复制到输出目录 - 始终复制”。在您的项目中创建一个新的子文件夹并将其放置在那里 - 这将是它被复制到的目录。

对于不允许用户删除预烘焙级别，Windows 上不允许这样做。如果用户要删除一些预期的文件，您可以检查您的代码，这将导致它失败。

要创建新目录，可以使用 StorageDevice.OpenContainer().Path 获取根路径并使用 Directory.CreateDirectory。这将适用于 PC 和 Xbox。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T22:44:48.570

您绝对应该将“预烘焙”级别与可执行文件放在一起。我不使用VS，所以我不能告诉你怎么做。

确实没有办法阻止用户删除您的关卡，但是您可以使用哈希来验证它们是否未被修改（用户仍然可以通过修改您的可执行文件来解决这个问题，但这应该会阻止大多数用户）。

您应该将自定义级别放在用户的文件夹中，例如`C:\Documents and Settings\User\MyGame\levels\level.txt`.

# windows - 检测用户何时截取我的程序的屏幕截图

> ID：774925
> 
> 赞同：7
> 
> 时间：2009-04-21T22:25:41.910
> 
> 标签：windows, security, screenshot

我正在编写一个 Windows 应用程序。我怎么知道什么时候截屏了？我读到了如何检测被按下的热键，但我更担心每隔 100 毫秒左右另一个程序对其进行截图的情况。也就是说，当有人创建另一个程序（比如使用 ImageGrab 的 python 程序，如另一篇文章中所述）时，我试图注意到它不断截取我的应用程序的屏幕截图并使用它们从中读取信息。

我不太关心阻止截屏 - 一旦注意到这种行为，我就可以禁止用户。

这可能吗？当任何应用程序截取屏幕截图时是否会发送 Windows 消息，例如 WM_HOTKEY？还是 Windows 只是使用最新绘制事件中的最新信息，然后直接将其返回给其他程序，而我的应用程序根本无法注意到？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-21T22:31:14.220

无论你做什么，人们都会找到绕过它的方法。假设存在这样的方法，您可以可靠地检测到另一个程序为您的应用程序截屏。为了解决这个问题，我可以安装 VirtualBox，在 VM 中运行您的应用程序，然后让一个程序截取 VirtualBox（然后包含您的应用程序）的屏幕截图。您的应用程序绝对无法知道它正在拍摄照片。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-21T22:29:15.440

如果我使用摄像机怎么办？如果我捕捉到计算机和显示器之间的视频怎么办？

我会惊讶地发现有任何实用的方法可以做到这一点。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-21T22:42:02.713

这永远行不通。不仅如此，提供这种安全级别的尝试也会给 99% 的合法用户带来不便。

您可能最好从尝试识别您的信息的不需要的用途/副本的角度来解决问题，并与使用该信息的人/公司联系。

版权法适用于这种方法，但我知道在某些情况下这种方法不可用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-22T00:24:50.407

您可以（不可靠地）使用[SetWindowsHookEx](http://msdn.microsoft.com/en-us/library/ms644990.aspx)来做到这一点。

[这是一个完整的 VB.NET 示例。](http://jo0ls-dotnet-stuff.blogspot.com/2008/12/vbnet-global-keyboard-hook-to-detect.html)

但是，有很多方法可以解决这个问题。在你之后安装的钩子将“覆盖”你的钩子。用户可以通过多种方式为他们的屏幕拍照，如本主题所述。我会尝试考虑除此之外的其他保护选项。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-21T22:55:34.880

首先，关于使用虚拟机的评论完全没有意义——检测在虚拟机下运行的窗口比检测正在拍摄的屏幕截图要容易得多。

使屏幕截图变得困难的一个好方法是重写您的程序以在某些祖先的 dos 扩展程序下以全屏模式运行。

禁止 95% 曾尝试截屏的用户的一个好方法是在启动时显示一个巨大的闪烁横幅（“禁止截屏！你被禁止！”），并检测用户在接下来的 15 秒内按下 PrtScrn。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-21T22:30:25.297

完全阻止它是相当困难的......一个有足够决心的用户可以用数码相机拍摄屏幕的照片。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-21T22:57:46.747

我认为不可能实现这一目标的另一个原因：

很久以前，我未能对 Windows Media Player 的内容进行屏幕截图，因为（我认为）WMP 会立即将该内容流式传输到视频卡。（有趣的细节：粘贴屏幕截图后，视频将继续在 MS Paint 中播放，但保存图像最终会产生一个黑色方块）。无论如何，使用 VNC 使得截屏变得非常容易。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-21T22:30:05.377

我通常截屏的方式（来自 C#）是调用 BitBlt，这是很多屏幕绘制的基础。不确定如何以任何有意义的方式拦截对它的调用，因为可能系统上的每个程序都在低级别使用它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-21T22:34:19.907

我假设你真的不能，因为人们总是可以在一个带有虚拟机的窗口中运行你的程序，然后在外部平​​台上使用一个捕获程序，并且知道这是否正在发生是非常困难的。我建议更多地考虑特殊渲染速度或隔行扫描，特殊对比等方式......

您还可以将输出像电影一样运行到屏幕上，使用低速率和分辨率的编码器对其进行编码，这样每 100 毫秒的静态捕获质量就会非常低，以至于毫无价值。（你有没有冻结一部低质量的电影？）

但是，您确实应该考虑使用其他方式来保护您的信息。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-06T02:37:17.753

我认为有一种方法可以阻止它。例如，了解在复制图形显示时模糊图形显示的技术。

截图，由虚拟操作系统的数码相机截图拍摄。

玩它，谁知道你可能会发明一些能让你赚上百万的东西。

# java - 两个eclipse项目的循环依赖

> ID：774929
> 
> 赞同：1
> 
> 时间：2009-04-21T22:29:00.810
> 
> 标签：java, eclipse, architecture, classpath

我正在尝试在 Java 中实现某种 MVC。实际上，它更像是一个 MVP，但这对我的问题并不重要。

以下情况：我有一个使用 Netbeans 制作的 GUI（因为有更好的 GUIeditor），它经常更新和更改。

由于我的主项目在 Eclipse 中更易于维护，因此我选择将 Netbeans 项目作为单独的项目导入 Eclipse。所以这里我有一个`App`包含控制器和模型包的项目“ `GUI`”和一个包含视图包的项目“”。问题是我遵循的模式在视图和控制器之间具有循环依赖性。每当视图更改时，控制器都会收到通知，决定从模型中获取哪些数据，然后对视图进行更改。

当我添加`App`到构建路径时`GUI`，反之，我将收到此错误消息“在项目'GUI'的构建路径中检测到循环”。*我的意思是这是真的，这个循环已经在我的设计中了。*

目前在启动时，我通过以下方式向其控制器注册一个视图（这不是真正的代码，我正在尝试缩短它）

```
package view;
import controller.*;
class viewA{
   ...
   public viewA() {
       controllerA.register(this);
   }
   ...  
}

package controller;
import view.*;
class controllerA implements SomeListener{
   ...
   protected viewA[] registeredViews;
   public static register(viewA interestedView){
       arrayPush(registeredViews,interestedView);
       interestedView.addSomeListener(this)    
   }
   ...
} 
```

因此，您会看到连接是通过将引用传递给控制器​​然后将侦听器注册到此视图来建立的。问题是：如果我`GUI`在 's buildpath 中没有项目，`App`则无法解决导入问题，在没有 in 's buildpath 时也会发生同样的`App`情况`GUI`。

我想保留这个项目结构并坚持我的 MVC 架构。我该如何解决它？你有什么建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-21T22:50:57.527

你让你的听众从通常的方式倒退——通常，控制器有主动权。它创建视图对象并将自己注册为视图事件的侦听器。

此外，监听器类型应该是 View 项目中定义的接口。然后，Contoller 实现该接口，视图不必知道具体的控制器类。循环解决。当然，您也可以在“反向”设置中执行此操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-22T06:17:16.173

类之间的循环依赖本身不是问题（它是一个特性）。但是，您应该检查您的设计并证明依赖关系的合理性。

Eclipse 项目可能有点过度使用。不幸的是，Eclipse 并不能真正处理很多（10+ 左右）项目，而且其他优秀的部分编译器变得更慢，并且编译过程似乎变得更加错误。

在我参与的几个开发项目中，合并和减少项目数量导致构建时间更短，构建问题更少。

在内部应用程序中，无论大小，如果每个编写代码的人都可以访问所有代码，那么在项目之间划分代码实际上没有什么意义。

如果您担心跟踪依赖关系，可以强制执行包之间的依赖关系规则。

大型应用程序中的每个“模块”都有一个“业务层”项目、一个“数据”层项目和一个 gui 项目是很常见的，如果你不创建，你最终会得到一些循环依赖人工“界面项目”等。

在您竭尽全力删除依赖项之前，请考虑依赖项实际上是否真实，并且可能应该合并项目。

请记住，诸如“模块”或“层”之类的抽象概念并不一定意味着您必须拥有匹配的项目或文件夹（或其他）。Eclipse 项目是您处理的一组文件，实际上或多或少。

您可能想阅读有关[the-mythical-business-layer 的](http://thedailywtf.com/Articles/The-Mythical-Business-Layer.aspx)内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T22:35:02.637

首先，您可能希望使用接口而不是实际的类来表示控制器和视图。

这类问题相当普遍，不幸的是，我认为没有真正好的解决方案，因为项目不应该在 Eclipse 中创建循环（它们是否允许在 Netbeans 中创建？我觉得这很令人惊讶）。

你能做的最多就是相互独立开发，并使用具有系统每个部分所依赖的共享接口的公共项目。这可以在某些设计中起作用。然后，您可以拥有另一个知道这两个部分并进行实际初始化的驱动程序项目。

如果你真的想避免这种情况，你可能需要使用像 Spring 这样的依赖注入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-08T22:59:47.843

您也可以只将两个项目之一的 .jar 文件添加到另一个项目，而不是使其依赖于项目本身。只要记住在必要时更新 jar。

# wpf - 将 ObjectDataProvider 绑定到属性而不是方法

> ID：774931
> 
> 赞同：3
> 
> 时间：2009-04-21T22:29:29.763
> 
> 标签：wpf, binding, objectdataprovider

假设您有以下课程：

```
class ProcessController
{
    public List<Process> Active { get { ... } }
    ...
    public List<Process> GetProcesses() { ... }
} 
```

我可以使用`GetMethod`将 a 绑定`ObjectDataProvider`到`GetProcesses()`方法：

```
<ObjectDataProvider x:Key="pList"
                    MethodName="GetProcesses"
                    ObjectType="{x:Type local:ProcessController}"/> 
```

我的问题是，我也可以绑定到该属性`Active`吗？

如果发现我可以执行以下操作：

```
<ObjectDataProvider x:Key="pList"
                    MethodName="get_Active"
                    ObjectType="{x:Type local:ProcessController}"/> 
```

但不知何故，这感觉不对。

是否有一些更清洁的方式或“正确”的方式来访问属性而不是调用方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-08-22T20:34:36.880

如果属性是静态的，只有当它是实例成员时，gcores 给出的答案才会起作用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-21T22:38:21.287

您不需要绑定到属性，只需绑定到对象并使用 Path 访问属性

```
<ObjectDataProvider x:Key="pList"
                    ObjectType="{x:Type local:ProcessController}"/> 
```

# ajax - 在假设的 ajaxed 博客引擎中，哪些博客功能可以使用异步请求？

> ID：774933
> 
> 赞同：0
> 
> 时间：2009-04-21T22:29:58.747
> 
> 标签：ajax, http, asynchronous

我试图了解何时应该使用异步 Web 调用返回服务器以获取 ajax 应用程序中的数据。

我以前从未使用过 ajax，所以我仍然坚持我对 HTTP 有状态模型的想法，已经使用了十多年。

在我作为 ajax 练习编写的博客引擎中，我想添加一些异步调用。

对于博客类型的功能，什么是合适的地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T22:34:01.747

注释是进行 AJAX 调用的好地方。当用户添加评论时，他们可能不想等待整个页面重新加载才能看到添加的评论。更好的方法是使用 AJAX 调用将评论插入数据库，并将评论的内容动态添加到页面中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T22:39:39.847

我会说; 通常会让您刷新页面的所有内容。

但是（更）认真地；我认为 stackoverflow 是一个很好的（！）后台调用可以为你做什么的例子。我特别喜欢在输入我的评论时收到通知，而另一个用户刚刚发表了评论。

此外，您可以从其他博客（可能使用 google 或其他工具）中抓取一些相关的博客文章，并在博客作者键入博客时将其展示给他（也是 stackoverflow 所做的）。这样，他也可以从别人那里学到一两件事，同时输入自己的想法。

当然还有明显的图片上传和预览的东西..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T22:32:39.973

提交评论是一个明显的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T22:33:58.393

从博客作者的角度来看，预览帖子是 AJAX 的绝佳机会。我把它写到我自己的博客引擎中（不幸的是它并不总是有效:-P 但我相信你可以做得更好）。预览/提交评论是另一种可能性。[Slashdot有一个不错的系统，尽管除非您的博客获得](http://www.slashdot.org)*大量*评论，否则他们的系统可能有点矫枉过正。

# cocoa - 用 Cocoa 应用程序制作一个 firefox 插件？

> ID：774971
> 
> 赞同：0
> 
> 时间：2009-04-21T22:38:08.370
> 
> 标签：cocoa, firefox, plugins

我的朋友想让我把他的 Cocoa 应用程序变成一个 firefox 插件。该应用程序获取要从中下载数据的站点的 URL，然后下载它，从而减轻浏览器的负担。我的问题是，由于 firefox 插件是用 javascript 编写的（我认为），而应用程序是用目标 C 编写的，这可能吗？此外，从其他地方下载文件是否有任何优势，以免干扰其他网络浏览？由于正在使用互联网连接，浏览仍然会很慢吗？这有什么可能的优势吗？

多谢你们！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T22:45:35.387

实际上 Firefox 插件（例如 Flash、Java 和视频编解码器支持）大多是用 C 和/或 C++ 编写的，而不是 Javascript。

您不应将插件与 Firefox 附加组件混淆（后者是用 Javascript 编写的）。

您可以使用 Objective-C 编写 Firefox 插件，只要您的插件与 Firefox 插件 API 接口二进制兼容。

[以下](https://developer.mozilla.org/En/Writing_a_plugin_for_Mac_OS_X)是有关如何设置的一些说明。

> 此外，从其他地方下载文件是否有任何优势，以免干扰其他网络浏览？

就在这里。一个单独的下载管理器程序可以做一些 Firefox 不做的其他聪明的事情（比如自动打开多个下载连接，具有可搜索的下载历史，根据文件类型自动将下载的文件添加到特定文件夹等）。查看[Speed Download](http://www.yazsoft.com/sd/index.html)以获取其中一些选项的示例。

（您也可以使用 Firefox 附加组件（例如[this](https://addons.mozilla.org/en-US/firefox/addon/201)）来实现大部分这些东西，但本机代码总是更加集成和灵活）。

> 由于正在使用互联网连接，浏览仍然会很慢吗？

连接的总带宽由所有正在运行的应用程序共享，因此让另一个应用程序下载内容在这方面对您没有帮助。但是，这种安排将减轻浏览器必须处理打开的下载连接的负担，因此理论上浏览器可能会更快一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T22:43:44.987

我建议您查看 SQLite Manager 和 FireFTP 插件。他们做了一些你可以使用的非常了不起的东西（尤其是 FireFTP），或者至少让你相信它实际上是可能的。

另外，我认为 Firefox 已经在下载队列方面做得很好。如果您的 Internet 连接有限（在速度和连接方面），您最终会使用较慢的浏览器（或下载）。

但也许插件可以优先下载？通过确保始终有足够的带宽，给浏览本身提​​供优先权？

祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T22:48:22.120

我也没有真正看到您朋友的应用程序有任何优势。如果您想要的话，通过让应用程序实现[自定义 URL 方案](http://developer.apple.com/documentation/Carbon/Conceptual/LaunchServicesConcepts/LSCConcepts/LSCConcepts.html#//apple_ref/doc/uid/TP30000999-CH202-CIHFEEAD)，从 Firefox 插件与应用程序通信将非常容易。

# ipv6 - IPv6 地址范围

> ID：774976
> 
> 赞同：6
> 
> 时间：2009-04-21T22:38:56.667
> 
> 标签：ipv6, ipv4

继[这篇文章](https://stackoverflow.com/questions/774536/formatting-ipv6-as-an-int-in-c-and-storing-it-in-sql-server)之后，我对搜索 IPv6 地址范围很感兴趣。

在 IPv4 下，我将能够确定 ISP 提供的开始和结束 IP 地址，并使用这些整数值作为范围边界快速搜索数据库以查看数据库中是否有任何条目落入该范围。

IPv6 将如何影响这一点？ISP 是否仍会像现在一样在范围内拥有 IPv6 地址？如果您将 IPv6 地址作为两个 bigint 存储在 SQL Server DB 中，您将如何有效地搜索这些范围？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-21T23:14:18.390

在范围内使用 IP 地址（既不是 IPv4 也不是 IPv6）是不正确的。对 IP 地址的特定“范围”进行分组的正确方法是使用前缀（CIDR 表示法）或掩码（已过时，仅对 IPv4 有效，如果您尝试使用非连续掩码，则会出现精神错乱）。

有时您会看到有人（有时甚至是应用程序、家庭路由器等）使用 IPv4 范围，但这是错误的做法。

使用[无类域间路由 (CIDR)](http://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing)，您将有一个元组 <Address, Prefix>，其中 Address 是一个 128 位无符号整数，Prefix 是一个微小的 (0..128) 无符号整数。前缀告诉地址有多少个最高有效位代表网络地址，剩下的其他 128 个前缀最低有效位代表该网络中的特定主机。

因此，例如，2620:0:860:2::/64 (wikimedia.org) 的 IPv6“范围”表示从 2620:0:860:2:: 到 2620:0:860:2 的所有主机： FFFF:FFFF:FFFF:FFFF。

您不应该使用两个“bigint”将这样的值存储在数据库中，而应在单个列中使用任何本机表示，除非您想让您的开发人员生活成为一场噩梦。如果您的 DBMS 不支持这么大的整数，除了替换您的 DBMS 之外，我建议使用 16 字节长的固定大小的二进制数据列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-22T20:25:29.240

使用适当支持 IPv6 地址的 DBMS 并不是一个坏主意。以下是 PostgreSQL 版本 8.3 的示例：

```
mydb=> CREATE TABLE Networks (name TEXT, prefix INET);
CREATE TABLE
mydb=> INSERT INTO Networks VALUES ('Documentation', '2001:DB8::/32');
INSERT 0 1
mydb=> INSERT INTO Networks VALUES ('ULA', 'FC00::/7');
INSERT 0 1
mydb=> INSERT INTO Networks VALUES ('Orchid', '2001:10::/28');
INSERT 0 1

mydb=> SELECT * FROM Networks;
 name      |    prefix     
---------------+---------------
 Documentation | 2001:db8::/32
 ULA           | fc00::/7
 Orchid        | 2001:10::/28
(3 rows)

mydb=> SELECT * FROM Networks WHERE '2001:DB8::dcaf:BAD' << prefix;
 name      |    prefix     
---------------+---------------
 Documentation | 2001:db8::/32
(1 row) 
```

# scala - Scala 库在命名包时是否遵循与 Java 相同的倒置域约定？

> ID：774979
> 
> 赞同：6
> 
> 时间：2009-04-21T22:40:18.537
> 
> 标签：scala, coding-style, naming-conventions, packages

我正在寻找编写一个小型 Scala 库来了解它的 Actor 编程模型。

在我遇到的示例代码中，一些库使用反向域（例如 org.foo.bar）作为包，而另一些则没有（可能只是为了简洁）。

Scala 库是否建议使用与 Java 相同的包命名约定？更一般地说，是否有任何好的 Scala 编码风格建议，比如 Python 对[PEP 8](http://www.python.org/dev/peps/pep-0008/)的建议？

是的，可能是本末倒置，但我发现通过看到一些已经动摇的约定，我可以对一门语言有一种不错的感觉。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-21T22:42:36.610

[Lift](http://liftweb.net/)是 Scala 中较大的项目之一，它使用倒置的域名约定，这实际上很有意义，因为 Scala 和 Java 可以互操作，因此您希望尽可能地让事情变得轻松，这是理所当然的，我真的想不出任何其他方式的任何有价值的优势。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T23:44:50.113

Scala 基本上继承了 Java 的大部分约定（几乎在所有方面）。有几个例外。例如，Scala“getter and setter”实际上是通过以下方式完成的：

```
class Person {
  private var _name: String = _

  def name = _name

  def name_=(s: String) {
    _name = s
  }
} 
```

如有疑问，请借鉴 Java、Ruby 或 Haskell 的约定（按优先顺序）。关于包，答案是“是”，Scala 包是使用倒置域约定命名的。``*****