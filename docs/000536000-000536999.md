# StackOverflow 问答 000536000-000536999

# c# - Ninject OnePerRequestBehaviour 似乎无法正常工作？

> ID：536007
> 
> 赞同：6
> 
> 时间：2009-02-11T09:07:01.483
> 
> 标签：c#, inversion-of-control, ninject

我一直在我的网络应用程序中使用 Ninject 作为我的 IOC。这很棒，我认为它工作得很好，但是我一直在尝试将一些接口/类注册为 OnePerRequestBehaviour，但它似乎并没有真正使用这种行为。代码运行正确，但在我的一个类中，它延迟从数据库加载页面信息，然后一旦加载它就不需要访问数据库。

我的问题是延迟加载的属性将在我的第一个请求中加载，然后当我请求下一页时使用该类的相同实例。我知道这是因为该类没有再次实例化并且已经设置了延迟加载的属性。

此代码在我的模块类中：

```
public class NinjectModule : StandardModule
{
    public override void Load()
    {
        Bind<IUnitOfWorkDataStore>().To<HttpContextDataStore>().Using<OnePerRequestBehavior>();

        Bind<CmsService>().ToSelf().Using<OnePerRequestBehavior>();
        Bind<CmsRepository>().ToSelf().Using<OnePerRequestBehavior>();
    }
} 
```

然后在继承自 NinjectHttpApplication 的 Global.asax 中，我有以下内容：

```
 protected override IKernel CreateKernel()
        {
            OnePerRequestModule module = new OnePerRequestModule();
            module.Init(this);

            KernelOptions options = new KernelOptions();
            options.InjectNonPublicMembers = true;

            IKernel kernel = new StandardKernel(options, new NinjectModule());

            return kernel;
        } 
```

对 CmsService 的第一次调用是在 global.asax 中以及在 authenticate_request 上进行的：

```
protected void Application_AuthenticateRequest(object sender, EventArgs e)
        {
            if (HttpContext.Current.Request.Url.AbsoluteUri.Contains(".aspx") &&
                !HttpContext.Current.Request.Url.AbsoluteUri.Contains(".aspx/"))
            {
                CmsService facCMS = HttpKernelFactory.Get<CmsService>();
                ContentPage page = facCMS.GetCurrentPage();

                // DO Logic based on the page being brought back
            }
        } 
```

上面的 GetCurrentPage() 代码：

```
public ContentPage GetCurrentPage()
{
    if (_currentPage != null)
        return _currentPage;

    return GetCurrentPage(_isAdmin);
} 
```

因此，您可以看到 _currentPage 变量仅在之前未设置的情况下才被加载，这应该是每个请求一次，但是 Ninject 似乎并没有为每个请求创建 CmsService 它似乎是为任意数量的时间。

Deos 任何人都知道为什么这对我不起作用或它肯定起作用的任何示例代码？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-11T14:41:01.180

OnePerRequestModule 是一个 HttpModule，需要加载到 ASP.NET 管道中才能工作。如果将它添加到 web.config，它应该可以工作：

IIS7：

```
<system.webServer> 
  <modules>
    <add name="OnePerRequestModule" type="Ninject.Core.Behavior.OnePerRequestModule, Ninject.Core"/>
  </modules>
</system.webServer> 
```

IIS6：

```
<system.web>
  <httpModules>
    <add name="OnePerRequestModule" type="Ninject.Core.Behavior.OnePerRequestModule, Ninject.Core"/>
  </httpModules>
</system.web> 
```

OnePerRequest 行为在 Ninject2（尚未发布）中得到了极大的改进。

# session - 当多个浏览器窗口共享同一个会话时，如何最好地处理用户状态？

> ID：536014
> 
> 赞同：2
> 
> 时间：2009-02-11T09:09:30.697
> 
> 标签：session, session-state

我有一个 Web 应用程序（Java、Websphere、JSP），它允许同事注册各种公司展览的访客。用户对象存储在记录当前选择的展览的会话中，并在输入新访客的详细信息时使用。

一位用户决定打开第二个浏览器窗口，该窗口似乎共享同一个会话。用户在第二个窗口中浏览到另一个展览。这会改变当前选定展览的状态。回到第一个窗口，单击一个菜单项：“列出访问者”。结果列表是在第二个窗口中选择的展览参观者列表。

我知道我可以将展览 ID 添加到每个页面上的每个表单，但我的实际场景比我描述的更复杂。

您处理此类问题的策略是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T09:12:34.887

我的第一个猜测是，您可以通过在 URL 而不是会话中保留（或可能仅识别）视图状态来避免该问题。

# c# - 可以推荐用于 .NET 的 ZedGraph 图表库吗？

> ID：536018
> 
> 赞同：13
> 
> 时间：2009-02-11T09:10:11.523
> 
> 标签：c#, graphics, charts, zedgraph

我正在为我的公司做一个项目，在研究股票市场的过程中，我需要将一些不同类型和平均复杂度的图表集成到 C# 中。我在 Internet 上找到了这个免费库[ZedGraph](http://zedgraph.org/wiki/index.php?title=Main_Page)。如果你遇到它，你推荐使用它吗？它的支持程度如何？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-07-07T17:44:21.167

我可以推荐 ZedGraph。几年来，我在[MSQuant](http://msquant.sourceforge.net)中使用它取得了巨大成功，用于大多数绘图：质谱显示、重新校准误差图、LC 峰值图、定量曲线等。

以下是 MSQuant 使用 ZedGraph 的一些屏幕截图：

1.  [散点图，带有趋势线](https://i.stack.imgur.com/bvUae.png)
2.  [显示实际数据点的 XY 图，线连接数据点](https://i.stack.imgur.com/xyznI.png)
3.  [棒图，带有重叠注释（`TextBox`实际上是es）](https://i.stack.imgur.com/6CY5H.png)
4.  [同一窗口中的多个绘图，类型为 2\. 和 3.](https://i.stack.imgur.com/HG6Wb.png)（下半部分的两个绘图）
5.  [仔细看看类型2。](https://i.stack.imgur.com/xtFna.png)
6.  [Visual Studio 中的拼贴、类型 2 和代码](https://i.stack.imgur.com/b94Zj.png)

第一个图背后的源代码可以在 MSQuant 的*[源代码中找到：frmRecalibrationVisualisation.vb、MSQuant/msquant/src/GUI/forms/frmRecalibrationVisualisation.vb。](http://pmortensen.eu/1/MSQuant/MSQsrcWWW,1.5,2008-12-19/frmRecalibrationVisualisation.vb.html)*.

与许多其他图表库相比，ZedGraph 还可用于面向科学/数学的绘图/图表（例如散点图），而不仅仅是用于业务类型的绘图/图表。股票市场应用程序可能还需要散点图。

在 ZedGraph 中，内置支持用户放大（无限）和缩小、平移（按住 `Ctrl`键拖动）、将绘图保存到文件或将其复制到剪贴板。

我在 ZedGraph 中缺少一件事：用户能够选择图中的项目以便对这些选定的项目执行一些操作（例如，计算一些数字，将它们接受为已验证或将它们标记为异常值）应用程序）。

不要被 ZedGraph 的发展状态所推迟。ZedGraph 成熟，质量非常高，可以按原样使用。在其进一步发展的背后应该有一个新的团队。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-01-14T00:13:19.717

ZedGraph 似乎不再受到原始开发人员的支持。但是，您可以在已进行更新的其他项目中找到它。

例如，根据ZedGraph 项目讨论列表上的讨论[：](http://sourceforge.net/projects/zedgraph/forums/forum/392231/topic/3487337)

> 所以我为所有的曲线和对象高度优化了 ZedGraph。基本上，我优化了它使用 GDI 的方式，特别是让它只绘制适合图表的对象。
> 
> 因此，即使图表上有数百万个对象，它现在也可以非常有效地滚动和缩放。此外，它在实时运行时使用几乎为零的 CPU，因为跟踪财务图表的速度较慢。
> 
> 我也修复了一些缺陷。

[您可以在此处](https://github.com/jspraul/TickZoomPublic/tree/integrate/Platform/ZedGraph)找到带有更改的 repo 的分支。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-11T23:58:30.050

我强烈推荐[Microsoft Chart Controls For .NET Framework 3.5](http://www.microsoft.com/downloads/details.aspx?FamilyId=130F7986-BF49-4FE5-9CA8-910AE6EA442C&displaylang=en) over ZedGraph。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T09:45:56.913

你的意思是 Zedgraph 而不是 Zgraph？Zedgraph 的主页在[**此处，并在**](http://zedgraph.org/wiki/index.php?title=Main_Page)[**此处**](http://www.codeproject.com/KB/graphics/zedgraph.aspx)的 CodeProject 文章中进行了描述。如果您在谈论 Zedgraph，我可以推荐它，我在 C# 方面的经验相对较少，但在数据可视化方面却相当多。我发现让 Zedgraph 启动并运行并生成漂亮的图表很简单。Zedgraph 非常适合 2D 绘图，我仍在寻找 3D 绘图的等价物。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-11T23:55:07.063

我讨厌成为一个killjoy，但我不会推荐ZedGraph。

几年前我正在使用它，并注意到支持是由一个爱好者提供的，似乎被每个想要他​​的免费软件而没有补偿或贡献的人滥用。[这是许多FOSS](https://en.wikipedia.org/wiki/Free_and_open-source_software)作者面临的诅咒。

看起来该软件已经一年多没有更新了，帮助论坛充满了没有回复的查询。看来作者失去了兴趣，走了过去。

如果你使用 ZedGraph，那么这样做是因为你想维护底层代码，并且因为你想回馈用户/开发者社区。如果您对贡献没有兴趣，并且您无法为自己维护它，请为那些不起作用且永远不会起作用的事情做好准备。一家有进取心的公司可以赞助软件的开发并提供有偿支持，但您需要自己决定这样做是否足够好，以及是否有真正的收入模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-14T09:35:24.893

尽管开发似乎停滞不前，但[WPF 动态数据显示](http://dynamicdatadisplay.codeplex.com/)看起来很有希望。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-02T07:13:47.783

ZedGraph 不支持 3D 绘图，例如 Surface Chart: Implied Vol Surface

# sas - 在 SAS 8.2 中合并/加入 2 个大型数据集的有效方法

> ID：536022
> 
> 赞同：1
> 
> 时间：2009-02-11T09:10:42.223
> 
> 标签：sas

我尝试了以下选项，但响应时间不可接受 - 创建索引“键”也无济于事（注意：两个数据集中的重复“键”）：

```
data a;
merge b
      c;
by key
if b;
run; 
```

=== 或 ===

```
proc sql;
create a
as select * 
from b
left outer join c
on b.key;
quit; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T09:25:54.480

在合并它们之前，您应该首先对这两个数据集进行排序。这就是将要表现的东西。当您必须扫描整个表以获得结果时使用索引通常比预排序数据集并合并它们要慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T13:32:33.030

一定要尽可能地修剪你的数据集。在数据步骤或 proc sql 之前对数据集进行排序。另外，如果重要的话，我不是 100%，但 ANSI SQL 会是`proc sql; create a as select * from b left outer join c on b.key=C.KEY; quit;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T13:01:48.353

您可以尝试 SQL 合并。我不知道它是否会更快满足您的需求，但我发现 SQL 比常规 SAS 合并更有效。此外，一旦您意识到可以使用 SQL 做什么，操作数据集就会变得更容易！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T14:37:58.707

创建密钥是让数据集准备好加入的最快方法。对它们进行排序可能需要与合并它们一样长的时间，如果不是更长的话，但仍然是一个好主意。

AFHood 的修剪建议很好。您可以通过 PROC Summary 运行它们吗？有没有可以删除的列？这些中的任何一个都将减少数据集的大小并加快合并速度。

然而，这些方法都不可能奏效。我经常合并几百万行的文件，这可能需要一段时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-29T05:41:28.007

不要使用数据步骤合并来执行此操作。
如果两个数据集中有重复的键，结果将是错误的。
唯一的方法是使用

```
Proc SQL;   
  Create table newdata    
  as select firsttable.aster, secondtable.aster    
  from table1 as firsttable   
  inner join table2 as secondtable    
  on (firstable.keyfield = secondtable.keyfield);   
quit; 
```

如果您有多个关键字段，则连接顺序应该是最不匹配字段首先到最大匹配字段最后。SAS 有一个坏习惯，即创建一个包含所有可能匹配项的临时数据集并从那里将其分割。可能会破坏您的临时空间分配并减慢一切。

如果您仍希望使用 DATA Step，则需要从其中一个数据集中删除重复的键。

# c# - 这是对 ExtensionMethod 的良好使用吗？

> ID：536034
> 
> 赞同：10
> 
> 时间：2009-02-11T09:14:43.773
> 
> 标签：c#, extension-methods

我刚刚在以下行中写了一个 if 语句

```
if (value == value1 || value == value2 || value == value3 || value == value4)
    //do something 
```

我总是不得不重复“价值==”部分，这让我很恼火。在我看来，除了使它难以阅读之外，这没有任何目的。

我编写了以下 ExtensionMethod 应该使上述场景更具可读性：

```
public static bool IsEqualToAny<T>(this T value, params T[] objects)
{
    return objects.Contains(value);
} 
```

现在我可以简单地写

```
if (value.IsEqualToAny(value1, value2, value3, value4))
    //do something 
```

这是 ExtensionMethod 的一个很好的用法吗？

编辑：

感谢所有伟大的答案。备案：我保留了该方法。虽然您可以简单地使用的建议`new []{value1,value2,value3,value4}.Contains(value)`是正确的，但我只是更喜欢从左到右阅读这种 if 语句（***如果这个值等于其中任何一个，***而不是***这些值是否包含这个值***）。在每个对象的智能感知中显示另一种方法对我来说不是问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T09:22:44.877

为不受限制的`T`. 尤其重要的是，这种方法很快就会让你的智能感知变得非常难以使用。

虽然有效，但我可能会避免将其*作为扩展方法*- 也许只使用标准的静态实用程序方法。

C# 3 数组初始值设定项语法可能更简单？

```
bool isTrue = new[] { 1, 2, 3 }.Contains(3); 
```

当然，对于大型数据集，您可能希望在`HashSet<T>`某处缓存一个 ;-p

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T09:22:43.020

您尚未添加仅对特定应用程序或上下文有用的功能，您的扩展已明确命名并且行为很明显，无需查看实现。

答案是“是的，是的”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T09:16:55.157

对我来说看起来不错，虽然它看起来有点不合常规。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T09:17:03.597

这似乎很公平，但我会退后一步。你能把任何商业意义放在比较中吗？这些价值观是什么？也许你最好使用一个被调用的方法`IsSpecialCustomerLocation`或表达代码实际意图的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T09:19:35.790

您还可以对该任务使用 LINQ 方法语法（通过使用 System.Linq 命名空间）：

```
 object[] objects = new object[10];
        objects.Contains(new MyClass()); 
```

嗯，让我想一想……哦，你已经在使用它了。但是您已将其放在单独的方法中，而不是直接调用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T09:59:21.717

我会为此目的制作一个静态类。我不喜欢那个解决方案，因为它为所有类添加了一个方法，这似乎有点矫枉过正。然而，它在某种程度上与 OOD 一致，因为您要求对象对自己执行功能（有点）。

尽管如此，我还是会选择一个可重用的类，因为我可以看到反模式是如何形成的。我还没有将其称为反模式，但如果出现太多这些结构，我会称其为可读性反模式，因为每个对象都会被扩展方法弄得杂乱无章。我有点像命名空间污染，但类成员污染。

```
if (ConditionHelper.IsEqualToAny(value, value1, value2, value3)) 
{
    // Do something
} 
```

做同样的工作，不会污染任何东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-11T10:21:15.673

您是否真的打算执行 Contains 并保证您将在可能使用此扩展方法的**所有可能对象上应用 Contains？**

如果某些给定对象通过重载 operator== 来测试相等性，那么您的通用解决方案将失败。这使得它不是多个 == 测试的真正等价物。这也是编写扩展方法危险的一个很好的例子！

以下 Linq 代码在您实现运算符重载时以及如果您使用比较对象引用的默认 == 含义时起作用，也就是说 value 实际上是与 value1、2、3 或 4 相同的对象，给定 V 作为对象在这种特殊情况下您的值的类型：

```
V[] lv = { value, value2, value3, value4 };
if (lv.Any( v => v==value))
   // do something 
```

或简写版本：

```
if (new List<V>{value, value2, value3, value4 }.Any( v => v==value))
   // do something 
```

我无法让上述 lambda 表达式在通用扩展方法中工作。

作为我认为可爱、易读的语法的一个很好（如果不相关）的例子，Python 中的成语是

```
if value in (value1, value2, value3, value4): 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T22:07:38.930

如果您只检查 Enum 值（正如您在 Rogers 答案的评论中所说），您应该在 Enum 上使用[FlagsAttribute 。](http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx)

```
[Flags]
public enum Value
{
  Value1 = 0,
  Value2 = 1,
  Value3 = 2,
  Value4 = 4
}

Value value = Value.Value1;
if (value | Value.Value1 | Value.Value2 | Value.Value3 | Value.Value4)
{
  // You can also use other bitwise operations, like & (AND), ^ (XOR) and ~ (NOT)
} 
```

除此以外; 如果它是特定于域的，请将其添加到您的业务逻辑中。如果它是通用的，请创建一个辅助类。

# python - 使用sqlalchemy从mysql一次输出一行数据

> ID：536051
> 
> 赞同：0
> 
> 时间：2009-02-11T09:19:22.170
> 
> 标签：python, mysql, sqlalchemy

我想使用 sqlalchemy 从 mysql 数据库中获取数据并使用不同类中的数据。基本上我一次获取一行，使用数据，获取另一行，使用数据等等。我遇到了这样做有些问题..

基本上，我如何从 mysql 数据中一次输出一行数据？.. 我查看了所有教程，但它们并没有太大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T10:36:33.547

你到底遇到了什么问题？

您可以简单地遍历 ResultProxy 对象：

```
对于 conn_or_sess_or_engine.execute(selectable_obj_or_SQLstring) 中的行：
   do_something_with(行)

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T09:59:46.550

From what I understand, you're interested in something like this:

```
# s is object returned by the .select() method
rs = s.execute()
row = rs.fetchone()
# do something with the row
row = rs.fetchone()
# do something with another row 
```

You can find this in a tutorial [here](http://www.rmunn.com/sqlalchemy-tutorial/tutorial.html).

# c# - 在 C# 中使用 OpenGL？

> ID：536065
> 
> 赞同：120
> 
> 时间：2009-02-11T09:22:53.783
> 
> 标签：c#, opengl

C# 是否有免费的 OpenGL 支持库？如果是这样，我应该使用哪一个？在哪里可以找到示例项目？

C# 是否为 OpenGL 提供类？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2009-05-07T15:53:17.260

[OpenTK](https://github.com/opentk/opentk)是对 Tao API 的改进，因为它使用具有重载、强类型枚举、异常和标准 .NET 类型的惯用 C# 样式：

```
GL.Begin(BeginMode.Points);
GL.Color3(Color.Yellow);
GL.Vertex3(Vector3.Up); 
```

与仅反映 C API 的 Tao 不同：

```
Gl.glBegin(Gl.GL_POINTS);   // double "gl" prefix
Gl.glColor3ub(255, 255, 0); // have to pass RGB values as separate args
Gl.glVertex3f(0, 1, 0);     // explicit "f" qualifier 
```

这使得移植更加困难，但使用起来非常好。

作为奖励，它提供字体渲染、纹理加载、输入处理、音频、数学......

**2016 年 1 月 18 日更新**：今天 OpenTK 的维护者已经[离开了这个项目](https://github.com/opentk/opentk/commit/2e51fe019771f4c70b15bb25b3a560f712a45fbf)，留下了不确定的未来。论坛充满了垃圾邮件。维护者建议迁移到 MonoGame 或 SDL2#。

**2020 年 6 月 30 日更新**：OpenTK 已经有了新的维护者一段时间，并且拥有一个活跃的不和谐社区。所以之前使用另一个库的建议不一定正确。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-07T15:26:52.033

我认为@korona 的意思是因为它只是一个 C API，您可以直接从 C# 中使用它，并输入大量如下内容：

```
[DllImport("opengl32")]
public static extern void glVertex3f(float x, float y, float z); 
```

不幸的是，您需要为您调用的每个 OpenGL 函数执行此操作，这基本上是 Tao 为您所做的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-11T09:35:15.080

[Tao](http://www.mono-project.com/Tao)应该是一个不错的框架。

从他们的网站：

> .NET 的 Tao 框架是一个绑定集合，用于促进使用 .NET 和 Mono 平台的跨平台媒体应用程序开发。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-10-26T02:50:23.070

[SharpGL](http://www.codeproject.com/Articles/3144/SharpGL-a-C-OpenGL-class-library)是一个允许您在 Windows 窗体或 WPF 应用程序中使用 OpenGL 的项目。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-11T09:41:18.857

I would also recommend the [Tao Framework](http://sourceforge.net/projects/taoframework/). But one additional note:

Take a look at these tutorials: [http://www.taumuon.co.uk/jabuka/](http://www.taumuon.co.uk/jabuka/)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-10-22T22:26:42.200

您可以在没有包装器的情况下使用 OpenGL，并在 C# 中本地使用它。正如 Jeff Mc 所说，您必须使用 DllImport 导入所需的所有功能。

他遗漏的是必须先创建上下文，然后才能使用任何 OpenGL 函数。这并不难，但几乎没有其他不那么直观的 DllImports 需要完成。

我在 VS2012 中创建了一个示例 C# 项目，几乎是让 OpenGL 在 Windows 机器上运行所需的最低限度。它只会将窗口涂成蓝色，但应该足以让您入门。该示例可以在[http://www.glinos-labs.org/?q=programming-opengl-csharp](http://www.glinos-labs.org/?q=programming-opengl-csharp)找到。在底部查找*No Wrapper示例。*

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-11T09:27:43.790

您希望这些支持库做什么？仅使用 C# 中的 OpenGL 就足够简单，并且不需要任何额外的库 afaik。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-09-03T08:36:51.420

关于（我知道有点离题，但因为它是较早提出的）XNA 与 OpenGL 的选择，在某些情况下使用 OpenGL 而不是 XNA（以及在其他 XNA 中而不是 OpenGL ......）可能是有益的。

如果您打算使用 Mono 在 Linux 或 Mac 上运行应用程序，那么使用 OpenGL 可能是一个不错的选择。另外，我认为这并不广为人知，如果您的客户将在 Citrix 环境中运行您的应用程序，那么 DirectX/Direct3D/XNA 不会像 OpenGL 那样经济实惠。这样做的原因是，与需要专用虚拟服务器在硬件中运行的 DirectX/XNA 应用程序相比，OpenGL 应用程序可以共同托管在较少数量的服务器上（由于性能问题，单个服务器无法托管无限数量的应用程序实例）加速模式。存在其他要求，例如支持的显卡等，但我将继续讨论 XNA 与 OpenGL 的问题。作为一名 IT 架构师、软件开发人员等，在选择 OpenGL 和 DirectX/XNA 之前必须考虑这一点……

附带说明的是，WebGL 基于 OpenGL ES3 afaik ...

作为进一步说明，这些不是唯一的考虑因素，但它们可能会使某些人的选择更容易......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-07T15:12:41.257

XNA 2.0 至少需要着色器 1.1 卡。虽然旧技术，但不是每个人都有。一些较新的笔记本电脑（根据我们的经验，配备英特尔显卡的东芝平板电脑）不支持着色器 1.1。XNA 根本无法在这些机器上运行。

这对我们来说是一个重要的问题，我们已经转向 Tao 和 OpenGL。加上 Tao，我们绑定了音频和 Lua 支持。

# .net - 如何在.Net中使用触控板滚动

> ID：536066
> 
> 赞同：5
> 
> 时间：2009-02-11T09:23:01.740
> 
> 标签：.net, scroll, input-devices, trackpad

我的 WinForms 应用程序使用鼠标滚轮订阅`Control.MouseWheel`事件。如何让它与来自其他输入设备的滚动方法一起使用，特别是在我的 T61 上的（Synaptics）触控板上“沿边缘手指”滚动？我假设我需要以`Control.MouseWheel`某种方式将触控板消息连接到事件，但我不知道从哪里开始......

编辑：这目前不起作用；所以我的触控板显然没有发送`Control.MouseWheel`消息。

谢谢！

（我使用的是 C#，但这肯定是 .Net 通用的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-09-10T13:56:14.270

如果它只是您的机器，那么最简单的方法是编辑 TP4table.dat 文件并在其中添加应用程序名称，如下所述：[http ://www.syaoran.net/blog/2010/01/how-to-启用-thinkpad-trackpoint-滚动/](http://www.syaoran.net/blog/2010/01/how-to-enable-thinkpad-trackpoint-scrolling/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-29T02:53:28.887

联想驱动程序无法按照您希望的方式工作。有一个解决方法，发布在这里：[链接](https://docs.microsoft.com/en-us/archive/blogs/markrideout/datagridview-mouse-scrolling-button-with-ibmultranav-driver)涉及欺骗鼠标驱动程序以识别您想要滚动消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T09:28:32.117

通常，触控板上的滚动操作只是向 PC 发送与鼠标滚轮相同的信号，因此您当前的实现应该可以工作。

# apache-flex - Flex 中的深度绑定

> ID：536067
> 
> 赞同：0
> 
> 时间：2009-02-11T09:23:26.747
> 
> 标签：apache-flex, data-binding

所以我在 flex 中有一个模块，我在其中添加了一个自定义组件。我也有一个类来处理我想要显示的数据，让我们调用这个类 DataHandler。

DataHandler 从后端解决方案接收数据，然后开始为我的模块和自定义组件放置数据。

当数据准备好时，它会调度我的模块捕获的事件。我将新数据发送到我的组件。

模块中的示例代码：

```
private function onDataChange(evt:Event=null):void
{ 
   _customComponent.ItemData = _dataHandler.DataProvider;
} 
```

_customComponent 然后获取数据：

```
public function set ItemData(value:ItemDataVO):void
{   
   _itemdata  = value;
} 
```

// _itemdata 是一个名为 ItemDataVO 的自定义类

现在在我的自定义组件中，我只是将数据绑定到我的 mxml 组件，例如

```
<mx:Label 
   text       = "Text: {_itemdata.Text}"
   fontFamily = "Hel"
   fontSize   = "12"     
   x          = "83" 
   y          = "40" /> 
```

当我获得新数据时，标签会自动更改。

到现在为止还挺好。但是我的自定义组件中还有 i List。这是我的问题。当我将数据绑定到列表时，我执行以下操作：

```
<mx:List
   id            = "_list"
   dataProvider  ="{_itemdata.Collection}"
   itemRenderer  = "components.renderers.CustomRenderer" /> 
```

// 这个 _itemdata.Collection 是一个 ArrayCollection，它包含基于自定义类的项目集合。

绑定不起作用，我还在运行时为列表中的每个项目获得了一个 varning：

警告：无法绑定到类 'modules::CustomModule' 上的属性 'parent'

（作为一种解决方法，我还尝试在每次设置 ItemData 时设置 _list 的 itemrenderer。新的 listdata 然后更新，但我在列表中看不到任何视觉更新。）

任何人都知道如何使这种绑定工作？

问候阿德勒茨 =)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T10:05:44.370

您是否将 ItemDataVo 上的集合属性设置为可绑定...类似于

```
package
{
    import mx.collections.ArrayCollection;

    public class ItemDataVo
    {
        [Bindable]
        public var text : String;

        [Bindable]
        public var collection : ArrayCollection
        public function ItemDataVo()
        {
        }

    }
} 
```

我做了一个简化的工作示例，显示绑定在与您的模型相似的模型上工作（尽管显然会有差异），只要文本和集合属性都附加了可绑定元数据，绑定就可以正常工作：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical" xmlns:local="*" creationComplete="creationCompleteHandler(event)">

    <mx:Script>
        <![CDATA[
            import mx.collections.ArrayCollection;
            import mx.events.FlexEvent;

            [Bindable]
            protected var itemData : ItemDataVo;

            private function creationCompleteHandler(event : FlexEvent) : void
            {
                generateItemData(); 
            }

            protected function generateItemData() : void
            {
                itemData = new ItemDataVo();
                itemData.text = "New Text With Random " + Math.random() * 100;
                itemData.collection = generateCollection();
            }

            protected function generateCollection() : ArrayCollection
            {
                var arrayCollection : ArrayCollection = new ArrayCollection();
                arrayCollection.addItem("New Item With Random " + Math.random() * 100);
                arrayCollection.addItem("New Item With Random " + Math.random() * 100);
                arrayCollection.addItem("New Item With Random " + Math.random() * 100);
                arrayCollection.addItem("New Item With Random " + Math.random() * 100);
                arrayCollection.addItem("New Item With Random " + Math.random() * 100);
                arrayCollection.addItem("New Item With Random " + Math.random() * 100);

                return arrayCollection;
            }

            private function fullClickHandler(event : MouseEvent) : void
            {
                generateItemData(); 
            }
            private function collectionClickHandler(event : MouseEvent) : void
            {
                itemData.collection = generateCollection();
            }

        ]]>
    </mx:Script>

    <mx:VBox width="100%" height="100%">
        <mx:VBox>
            <mx:Label text="{itemData.text}" />
            <mx:List dataProvider="{itemData.collection}" />
        </mx:VBox>
        <mx:HBox>
            <mx:Button label="UPDATE FULL ITEM DATA" click="fullClickHandler(event)"/>
            <mx:Button label="UPDATE COLLECTION" click="collectionClickHandler(event)"/>
        </mx:HBox>
    </mx:VBox>
</mx:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T10:26:32.900

过去我将我的列表添加到我的模块中，它从来没有给我任何绑定问题。但是，是的，中间的组件打破了绑定似乎很奇怪。

存储在 Collection 中的对象如下所示：

```
package code.converters.objects
{
    public class LineupLI
    {
        private var _plid:int;
        private var _lastname:String;
        private var _firstname:String;
        private var _shirtnumber:int;
        private var _onpitch:Boolean;

        private var _distance:Number;
        private var _topspeed:Number;

        private var _goals:int = 0;

        private var _subin:Boolean      = false;
        private var _subout:Boolean     = false;

        private var _redcard:Boolean    = false ;
        private var _yellowcard:Boolean = false;

        private var _teamid:int;

        private var _teamlongdesc:String;

        private var _second_increase:Number;

        [Bindable]
        public function get OnPitch():Boolean { return _onpitch; }
        public function set OnPitch(value:Boolean):void { _onpitch = value; }

        [Bindable]
        public function get ShirtNumber():int { return _shirtnumber;  }
        public function set ShirtNumber(value:int):void { _shirtnumber = value; }

        [Bindable]
        public function get PlId():int { return _plid; }
        public function set PlId(value:int):void { _plid = value; }

        [Bindable]
        public function get FirstName():String { return _firstname;  }
        public function set FirstName(value:String):void { _firstname = value; }

        [Bindable]
        public function get LastName():String { return _lastname;  }
        public function set LastName(value:String):void { _lastname = value; }

        [Bindable]
        public function get Distance():Number { return _distance;  }
        public function set Distance(value:Number):void { _distance = value; }

        [Bindable]
        public function get TopSpeed():Number { return _topspeed;  }
        public function set TopSpeed(value:Number):void { _topspeed = value; }

        [Bindable]
        public function get Goals():int { return _goals;  }
        public function set Goals(value:int):void { _goals = value; }

        [Bindable]
        public function get SubIn():Boolean { return _subin;  }
        public function set SubIn(value:Boolean):void { _subin = value; }

        [Bindable]
        public function get SubOut():Boolean { return _subout;  }       
        public function set SubOut(value:Boolean):void { _subout = value; }

        [Bindable]
        public function get RedCard():Boolean { return _redcard;  }
        public function set RedCard(value:Boolean):void { _redcard = value; }

        [Bindable]
        public function get YellowCard():Boolean { return _yellowcard;  }
        public function set YellowCard(value:Boolean):void { _yellowcard = value; }

        [Bindable]
        public function get TeamId():int { return _teamid;  }
        public function set TeamId(value:int):void { _teamid = value; }

        [Bindable]
        public function get TeamLongDesc():String { return _teamlongdesc;  }
        public function set TeamLongDesc(value:String):void { _teamlongdesc = value; }

        [Bindable]
        public function get SecondIncrease():Number { return _second_increase;  }
        public function set SecondIncrease(value:Number):void { _second_increase = value; }                             
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T10:48:10.023

对我来说看起来不错...我认为这里可能存在一些问题。一个是绑定不起作用，第二个（正如大卫哈纳克所说）是警告的原因

```
warning: unable to bind to property 'parent' on class 'modules::CustomModule' 
```

被抛出似乎与您的任何对象都不相关。我会尝试先解决后者，并尝试找出发生这种情况的原因。您可能会发现这解决了原来的绑定问题。

# java - 在网络连接重试之间暂停

> ID：536073
> 
> 赞同：0
> 
> 时间：2009-02-11T09:25:49.863
> 
> 标签：java, database, multithreading, jakarta-ee

我正在为 JBoss Java EE 服务器编写一个应用程序。我希望数据库访问代码非常健壮。因此，我创建了重试循环，以便请求不会因为临时网络问题而失败。现在我希望请求的执行在重试之间暂停。

服务器线程是由对 Axis Web 服务的请求产生的。让服务器线程进入睡眠状态是否安全，或者我是否必须为此生成一个自己的线程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T09:43:24.203

Yes you can put the thread to sleep using Thread.currentThread().sleep(XXX). But you should limit the number of tries otherwise in case of long network issue the thread will keep hanging for that long.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T18:12:32.420

如果您正在尝试让进程重新连接到数据库以防连接丢失，您最好让 JBoss 为您处理，只需在 JBoss 中定义您的数据源，它将为您管理一个连接池，验证连接并丢弃不再有效的连接，以便您始终获得有效连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:48:41.137

Trying to control the threading within your JBoss server will end up causing you more problems and quickly become a nightmare. JBoss already manages the database connections and transactions very well; so, unless your database is located somewhere outside your local network, it is unlikely your transaction will fail because of network outages. Also, adding in 'retry' logic to your business methods (ala session beans) is not really a good idea either as this would introduce long running transactions which would lead to transaction timeouts and entity locking issue - which puts you in the same boat as the less likely network outage.

Typically, you would catch any rollback errors on the client side and handle retries there. But, if you really need to introduce 'retry' behavior on the server side, I would recommend leveraging MessageDrivenBeans to perform those operations asynchronously. When a client calls a method on your session bean, instead of running the business logic, constructs and deliver a JMS Message to a local queue. This message would contain the name of the called method and a map of the parameters passed by the client. Listening on that queue would be a MDB that deconstructs the message to either perform the business logic directly, or make a call to a session bean to perform the logic. If there is a transaction rollback, then the message is pushed back onto the queue and redelivered to the MDB at a later time.

For JBoss 4.2.3 messaging, you can add the following properties to your JMS message to control the delivery time and how long JBoss should wait to redeliver a message after a failure:

*   `JMS_JBOSS_SCHEDULED_DELIVERY` - takes the delivery time in millis
*   `JMS_JBOSS_REDELIVERY_DELAY` - number of millis to wait before redelivery

You would add these values to the message before pushing them onto the queue - manipulating the delivered message from the MDB doesn't work. Also, be aware that if a message is delivered too many times (defaults to 10 times), then the message will be moved to the deal letter queue (DLQ).

# jquery-ui - 使用 addClass 和 removeClass 的 JQuery 和自定义选项卡

> ID：536076
> 
> 赞同：1
> 
> 时间：2009-02-11T09:26:53.853
> 
> 标签：jquery-ui

所以我对 JQuery 很陌生，只花了 5 个小时来完成这项工作。如果有人有更好的方法，我很想听听。

*这是我的基本问题，如何才能做得更干净、更精简？*

我所做的是使用 minitabs 插件，下面的代码将做的是来回切换自定义选项卡。我需要一种方法让一个选项卡为蓝色，另一个选项卡为灰色，具体取决于我所在的选项卡。我遇到的是**tab1**即使我点击**tab2**也会保持蓝色，只是在修复它之前很时髦。如您所见，这不是最干净的方法，但它有效。我敢肯定，如果你想试试这个 minitab 插件可以在这里。

```
http://minitabs.googlecode.com/files/jquery.minitabs.js 
```

查询：

```
$(document).ready(function(){

   $("#tabs").minitabs('slow', 'fade');

        $("#tab1").click(function()
            {
                var $this = $(this);
                if( $this.is('.removed') ) 
                     {
                       $this.removeClass('removed');
                       $this.addClass('selected');
                       $('#tab2').removeClass('selected');
                       $("#tab2").addClass('removed');
                } else {
                       $('#tab2').removeClass('selected');
             }
    return false;
        });
        $("#tab2").click(function()
            {
                var $this = $(this);
                if( $this.is('.removed') ) 
                  {
                        $this.removeClass('removed');
                        $this.addClass('selected');
                       $("#tab1").removeClass('selected');
                       $("#tab1").addClass('removed');
                } else {
                       $('#tab1').removeClass('selected');

              }
                return false;
        });
   }); 
```

身体：

```
<div id="tabs"> 
          <ul>
            <li><a href="#quick-links" class="tab-l selected" id="tab1">tab-l</a></li>
            <li><a href="#newsletter-link" class="tab-r removed" id="tab2">tab-r</a></li>
        </ul>

        <div id="quick-links">
<ul>
  <li>Look at me getting myself all in a frenzy!</li>               
</ul>
        </div>

        <div id="newsletter-link">
  Sometimes it's would be nice if they reported the fun news!
        </div>   

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T10:04:39.533

我简要地看了一下，并没有看到这个不太复杂的设置有任何问题，它利用 minitabs 自动将类“current”应用到当前选定的选项卡：

```
<head>
    <style type="text/css">
    .tabs a {
        background: grey;
    }
    .tabs a.current {
        background: blue;
    }
    </style>
    <script type="text/javascript">
    $(document).ready(function(){
        $("#tabs").minitabs('slow', 'fade');
    });
    </script>
</head>
<body>
    <div id="tabs">
        <ul class="tabs">
            <li><a href="#quick-links" class="tab-l current" id="tab1">tab-l</a></li>
            <li><a href="#newsletter-link" class="tab-r" id="tab2">tab-r</a></li>
        </ul>

        <div id="quick-links">
            <ul>
                <li>Look at me getting myself all in a frenzy!</li>
            </ul>
        </div>

        <div id="newsletter-link">
            Sometimes it's would be nice if they reported the fun news!
        </div>
    </div>
</body> 
```

对我来说，处理你完美描述的情况。

# sql-server - 将 MS SQL 表的现有列设置为 NOT NULL

> ID：536077
> 
> 赞同：45
> 
> 时间：2009-02-11T09:27:30.840
> 
> 标签：sql-server, sql-server-2005

如何将 MS SQL 表的现有列设置为 NOT NULL？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-02-11T09:32:12.500

```
ALTER TABLE tablename
ALTER COLUMN columnname datatype NOT NULL 
```

在执行此操作之前，您显然必须确保该列不包含任何 NULL 值。

例如

```
ALTER TABLE orders
ALTER COLUMN customer_id INT NOT NULL 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-04-16T16:09:30.223

首先确保字段具有非空值。在这种情况下，我正在使用具有 GUID nvarchar 的字段，所以我会这样做

```
UPDATE tablename 
SET    fieldname = Newid() 
WHERE  fieldname IS NULL; 
```

然后正如亚当拉尔夫所说

```
ALTER TABLE tablename ALTER COLUMN fieldname datatype NOT NULL 
```

# css - CSS的速度

> ID：536091
> 
> 赞同：16
> 
> 时间：2009-02-11T09:32:25.867
> 
> 标签：css, performance, rendering, micro-optimization

这只是一个帮助我更好地理解 CSS 渲染的问题。

假设我们有一百万行。

```
<div class="first">
    <div class="second">
        <span class="third">Hello World</span>
    </div>
</div> 
```

将 Hello World 的字体更改为红色的最快方法是什么？

```
.third { color: red; }
div.third { color: red; }
div.second div.third { color: red; }
div.first div.second div.third { color: red; } 
```

此外，如果中间的 at 标记具有唯一 id 为“foo”怎么办。上面哪一种 CSS 方法最快。

我知道为什么要使用这些方法等，我只是想更好地掌握浏览器的渲染技术，我不知道如何进行测试。

更新：很好的答案秋葵。从外观上看，在常规站点中进行标记的完整定义会更快。因为它找到了父母并缩小了对找到的每个父母的搜索范围。

从某种意义上说，这可能很糟糕，尽管您将拥有一个相当大的 CSS 文件。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T09:52:40.233

要记住两件事：

*   这将取决于 CSS 解析器/渲染引擎：即它因浏览器而异。

*   无论如何， CSS 真的，真的，*真的*很快，即使是最慢的人类观看时也不会注意到

一般来说，最简单的事情是最快的（正如 Gumbo 很好地说明的那样），但是因为我们已经处于如此快速的环境中，所以不要认为你应该牺牲清晰度和适当的范围（低特异性就像让所有东西都公开）。`*`只要尽可能避免:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-05-24T05:22:50.020

根据[Mozilla 开发人员中心](https://developer.mozilla.org/en/Writing_Efficient_CSS)的说法，这种情况下最有效的选择器就是`.third`

事实上，他们在那里明确声明“不要用标签名称限定类规则”。通常，为了获得最大效率，请使用匹配的最简单的选择器。这就是为什么beat beats`.third`等。`span.third``.second span.third`

我不知道 Gumbo 的结论是什么意思，但 Ólafur 似乎从中得出的结论是，在选择器中使用更多的东西会使 CSS 解析更有效率，而事实上，恰恰相反（假设其他 CSS解析引擎的工作方式与 Mozilla 的类似。）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-11T09:42:58.433

您必须了解选择器的处理方式：

*   **`.third`：**获取每个元素并检查类名`third`，
*   **`div.third`：**获取每个`DIV`元素并检查类名`third`，
*   **`div.second div.third`：**获取每个`DIV`元素，检查类名`second`，遍历这些并找到每个后代`DIV`元素并检查类名`third`，
*   **`div.first div.second div.third`：**获取每个`DIV`元素，检查类名`first`，遍历这些并找到每个后代`DIV`元素，检查类名`second`，遍历这些并最后检查类名`third`。

* * *

**编辑**   我不得不承认，上面的过程是幼稚的方法，通常效率不高。实际上，有些实现是从下到上而不是从上到下：

*   **`div.first div.second div.third`：**获取每个`DIV`元素，检查类名`third`，获取第一个`DIV`具有类名的祖先`second`，获取第一个具有类名的`DIV`祖先`first`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T09:50:08.523

我会说这取决于浏览器。没有什么比实验更好的了，在这种情况下，一个简单的 JavaScript 可能就可以了。

*更新：*我打算做这样的事情：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>CSS Speed Test</title>
    <style type="text/css">
    .first { color: red; }
    </style>
    <script type="text/javascript">
    window.onload = function()
    {
        var container = document.getElementById("container");
        var totalTime = 0;
        var passes = 100;
        for (var p=1; p<=passes; p++)
        {
            var startTime = new Date();
            for (var i=0; i<1000; i++)
            {
                var outerDiv = document.createElement("div");
                var innerDiv = document.createElement("div");
                var span = document.createElement("span");
                outerDiv.className = "first";
                innerDiv.className = "second";
                span.appendChild(document.createTextNode("Hello, world!"));
                outerDiv.appendChild(innerDiv);
                innerDiv.appendChild(span);
                container.appendChild(outerDiv);
            }                       
            var endTime = new Date();
            totalTime += (endTime - startTime);
        }                           
        alert("Average time: " + totalTime/passes);
    }
    </script>
</head>
<body>
    <div id="container"></div>
</body>
</html> 
```

…但是正如 annakata 所说，由不同选择器引起的时间差异似乎太小而无法测量。

# search - 微软搜索服务器

> ID：536098
> 
> 赞同：0
> 
> 时间：2009-02-11T09:34:43.070
> 
> 标签：search, search-engine, microsoft-search-server

如何以编程方式从 Microsoft Search Server 检索最流行的搜索词？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T18:09:04.463

1.  您将需要[启用搜索使用报告](http://technet.microsoft.com/en-us/library/cc262541.aspx)。
2.  提取热门搜索词看起来不支持 OOB。所以你可以查看[这篇文章，或者](http://jopx.blogspot.com/2008/04/extending-usage-analysis-reporting-in.html)[CodePlex](http://www.codeplex.com/usage/Release/ProjectReleases.aspx?ReleaseId=14372)上的这个 v1 代码来让你做到这一点。

# powerbuilder - PowerBuilder (PBOrca) 自动构建

> ID：536103
> 
> 赞同：0
> 
> 时间：2009-02-11T09:35:57.000
> 
> 标签：powerbuilder, powerbuilder-build-deploy

我每天晚上都在运行我们的 PowerBuilder 应用程序的工作自动化构建过程。我用来设置的资源是[http://dm.char.com.ua/pb/pborca.htm](http://dm.char.com.ua/pb/pborca.htm)。我不清楚 PBOrca 是官方支持的工具还是由谁负责（是运行链接站点的绅士吗？）。我从那个链接下载了它，但我相信可能会有更新的版本。我从哪里得到这个？我用谷歌搜索无济于事，并在 sybase.com 上找到了有关使用的文档，但没有实际下载。

我正在寻找新版本的原因是 PB11.5 中支持的新样式控件在自动构建中不可用，但在开发中可以正常工作，因此当我们部署构建时，它使用一种 Windows 经典主题。我在其他人的 orca 脚本中找到了对在线传递 NEWVSTYLECONTROLS 的引用，但是当我尝试它时它抱怨参数数量错误，并且我查看的示例具有不同的参数列表。

谢谢你的时间。

艾伦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T17:46:03.827

ORCA 曾经上传到[CodeXchange](http://www.sybase.com/detail?id=1058501)，但我看到上传的最后一个版本是 10.2。CX 处于过渡阶段，所以这可以解释为什么它不是最新的。

然而，如今使用 ORCA 建造蛋糕不像从头开始做蛋糕，更像是自己种小麦来做蛋糕。（从蛋糕装饰师的儿子那里得到，他们都来自混合。;-)） ORCAScript 是一种用于构建的类批处理语言。请参阅应在您的机器上安装的用户指南中的附录 B，或链接到[在线用户指南](http://infocenter.sybase.com/help/topic/com.sybase.dc00844_1150/pdf/pbug.pdf)。另请注意，从 PB8 开始，您可以[从命令行部署项目](http://www.techno-kitten.com/Changes_to_PowerBuilder/New_In_PowerBuilder_8/PB8_New_-_Building_and_deployi/pb8_new_-_building_and_deployi.html)。

祝你好运，

特里

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T01:42:12.477

我们对 E.Crane PowerGen 有很好的经验。它不是免费的，但它是您自动化构建过程的可靠解决方案。

[http://ecran.com/powergen-overview/](http://ecrane.com/powergen-overview/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T10:14:32.850

自从我使用 powerbuilder 已经有一段时间了。直到几年前，人们还编写了一些工具来创建个人可执行文件。随着 PB 社区变得越来越小，这些人很可能还没有将实用程序更新到较新的版本。

最好的方法是让您使用 Sybase 提供的 API 构建自己的应用程序。您可能已经知道详细信息在此位置。 [http://manuals.sybase.com/onlinebooks/group-pb/adt0650e/orca/@Generic__BookTextView/86](http://manuals.sybase.com/onlinebooks/group-pb/adt0650e/orca/@Generic__BookTextView/86)

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-24T15:42:52.393

尝试 ：

构建可执行文件“easynexus32.exe”“wings.ico”“”“YYYYYYYY”newvstylecontrols

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-22T13:27:58.603

是的，ORCA 仍然是 PB 11.5.1 中包含的 Sybase 产品 处理脚本的二进制文件可以在以下位置找到：c:\program files\Sybase\shared\powerbuilder\orcascr115.exe

我最近使用了与 Philip Ross 所描述的语法相同的语法。

# javascript - 关于 JavaScript 鼠标事件异常，我遇到了麻烦

> ID：536104
> 
> 赞同：1
> 
> 时间：2009-02-11T09:36:03.487
> 
> 标签：javascript, events

我正在设计一个类似于 RPG 的小型界面，用户将可以自由地创建他们使用的物品和武器。请放心，该特定系统经过深思熟虑，不是我担心的原因。:)

不，这与我为实际绘制用户项目设置的机制有关。我可以尝试用文字表达设计，但如果我只是带你去那里可能会最有益，所以在继续之前单击[此处](http://howironique.site90.com/itemDraw/index.html)。

还不错吧？*除了一个小*问题外，它几乎在所有方面都没有缺陷，除了 IE（多年来没有为它编码） ；事实上，它太小了，我敢肯定几乎所有玩家都会使用这个界面而没有注意到它。然而，我对自己的设计有点挑剔，在这个设计上辛勤工作几个小时，唉，把我带到了这里。

所以，Stack Overflow JavaScript 大师，关于这个问题的一些帮助：

目前，有两种方法可以将颜色注入画布；您可以单独单击方块，也可以拖动鼠标并在进行时填充图块。好吧，试试第二个选项。现在，你有没有注意到，虽然拖拽确实发生了，但你的拖拽直到你离开*你*开始的方格才真正开始。

当然，没什么大不了的，只需返回并单击错过的位置即可。这绝对是我不介意解决的事情；不过，在这一点上，这只是理解为什么代码不能完全按照应有的方式工作的问题。任何帮助将*不胜*感激。

此外，如果您无法破译我的代码，则算法的失败：

*   全局变量**md**（鼠标按下）在开始时设置为 0
*   document.onmousedown 将 md 设置为 1；相反，onmouseup 将其放回 0
*   用户当前选择的颜色作为索引存储在**cur_color**
*   存储在**调色板**数组中的用户颜色调色板
*   **调色板[cur_color]**引用用户当前选择的颜色
*   在一个瓷砖上移动时，如果鼠标被按住，**toggle()**函数会启动
*   **toggle()**将相关图块的 backgroundColor 与用户的**cur_color进行比较**
*   如果它们不同，**则 cur_color**覆盖，有效地“绘制”画布的那部分
*   这种情况一直持续到用户松开鼠标按钮

总体而言，这是一种非常基本的方法，但是整个鼠标被按下-不注册-直到一个平方-迟到的事情正在杀死我。再次，我们将非常感谢您帮助了解此事的真相。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T11:19:08.390

这是因为您最初在鼠标按下时没有调用 tile_over 。阅读上述步骤，您可以看到这一点。

这是一个修复，将其添加到 onmousedown 函数：

```
var target = e.target || e.srcElement;
if (target.tagName == 'DIV' && target.className == 'tile') {
    tile_over(target);
} 
```

显然，拥有一个框架来处理获取鼠标事件的目标等将使这更容易。

您需要在没有触发鼠标悬停的情况下删除鼠标悬停时发生的切换，我没有费心跟踪它，因为它应该很明显。

# asp.net - 将 HTML 用于列表框项

> ID：536108
> 
> 赞同：1
> 
> 时间：2009-02-11T09:36:33.660
> 
> 标签：asp.net, html, listbox

我想知道是否有一种方法可以将 HTML 用于我的 ASP:Listbox 项目的内容而不是纯文本？我问的原因是因为我想对列表中的每个项目进行一些额外的格式化。不仅仅是字体的变化，可能还有文本或表格行旁边的图标来划分每个列表项。

我隐约知道这个问题可能有一个 JavaScript 解决方案，但我运气不好，所以如果有人能提供任何建议或指示，那就太好了。

编辑：我应该澄清我的目标平台是 .NET 2.0 和 IE6。

* * *

彼得，这与我所追求的非常接近。我已经在我的 .NET 应用程序中完成了这项工作；

```
itemToAdd.Attributes.Add("style", "padding-left: 20px; background: url(" + image + ".gif) no-repeat left center;"); 
```

这在 FF3 中完全符合预期，但在 IE 中，由于某种原因，图像没有显示。有谁知道在 IE 中使用背景 CSS 元素的任何问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T09:56:20.413

您不能格式化列表框中的项目。您应该设计自己的列表框。

也许您可以创建一个 HTML 项目表。然后您可以根据需要进行格式化。对于选择项目，您可以添加带有单选或复选框的列。

对于 ASP.NET，自定义控件看起来不错： [JavaScript ListBox Control](http://www.codeproject.com/KB/scripting/List_Box.aspx?display=Print)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:52:21.670

这里还有另一个相关的堆栈溢出问题：

[有没有办法在 IE 6 上通过 CSS 增强 HTML <select> 及其 <option> ？](https://stackoverflow.com/questions/182035/is-there-a-way-to-enhance-by-css-an-html-select-and-its-option-on-ie-6)

由此看来，您似乎无法为 SELECT 中的 OPTION 元素设置许多 css 选择器。

您可以在 IE6 中设置一些颜色和背景色等内容，但不能设置填充等其他内容（在某些较新的浏览器中可以使用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T09:45:04.887

您可以对列表项使用 CSS 样式属性。但[看起来](http://www.velocityreviews.com/forums/t360823-format-text-in-dropdownlist.html)它只能在 Firefox 中实现。

* * *

编辑：用 IE 6 测试它并且它工作。

# command-line - 递归删除文件但不包括某个文件的命令行

> ID：536109
> 
> 赞同：10
> 
> 时间：2009-02-11T09:36:36.327
> 
> 标签：command-line, batch-file, dos

我需要使用命令行从文件夹及其所有子文件夹中删除某种类型的文件（例如 .zip 文件）。理想情况下，我正在寻找可以在 Windows 中作为 .bat 文件运行的东西。

我知道 DEL 命令有一个 /S 开关来查看子文件夹，但为了增加挑战，我需要排除某个名称的文件（例如“Backup.zip”）。

有没有办法递归删除文件但排除特定名称的文件。在我的情况下，明确列出我要删除的所有文件名是不切实际的，只列出我不想删除的匹配类型的文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T10:04:27.303

一个不错的技巧：将[要排除的文件设为只读](http://www.computing.net/answers/dos/excluding-folders-when-using-del-s/16548.html)！

`DEL /S`不会删除只读文件。

以下脚本并不*完全*符合您的要求（请参阅下面的评论），但向您展示了如何使用只读文件来避免删除。

```
@ECHO OFF
:: This example supposes your first parameter is
:: the relative path to the folder to be deleted
:: and the second is the relative path (from the
:: the target folder) of the one to be excluded
:: Notice that this will only work if the folders
:: are in the working drive, if not, you ll
:: have to specify full paths

IF "%1"=="" GOTO ERROR
IF "%2"=="" GOTO ERROR
IF NOT EXIST %1\NUL GOTO ERROR
CD %1
IF NOT EXIST %2\NUL GOTO ERROR
ECHO Starting up the deletion process
ECHO. * Setting attributes
attrib %1\*.mp3 -r -s -h > NUL
attrib %2\*.mp3 +r > NUL
ECHO. * Deleting files
del /s %1\*.mp3
ECHO. * Reseting attributes
attrib %2\*.mp3 -r > NUL
ECHO.
ECHO Operation completed!
ECHO.
GOTO END

:ERROR
ECHO Parameters:
ECHO. Param1 -> target folder
ECHO. Param2 -> folder to be ignored
ECHO.
GOTO END

:END 
```

注意：您可以调整此脚本，以便不仅忽略子文件夹，而且忽略给定类型的所有文件：

```
attrib /S *.xxx +r > NUL 
```

实际上会帮助您排除当前目录*和所有子目录的*所有“xxx”文件（因此有该`/S`选项）。

* * *

注意：“ `> NUL`”部分是一个**[重定向](http://www.robvanderwoude.com/redirection.php)**，通常用于隐藏标准输出，而不是在屏幕上显示。
如果过于频繁使用（例如，在涉及不同路径的大循环中）可能会很危险，因为它是一个**device** ，并且像所有设备（`AUX`、`COMn`、`LPTn`和）一样：`NUL``PRN`

*   打开设备将要求一个文件句柄。但是，与文件不同的是，设备在重新启动之前永远不会关闭。
*   每个设备都存在于每个驱动器上的每个目录中，因此，如果您使用重定向到`NUL`in ，`C:\`然后在 中再次使用它`C:\TEMP`，您将丢失另一个文件句柄。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T09:50:09.243

您可以轻松地循环一组文件并对每个文件执行一个命令，如下所示：

```
set match=D:\blah\M*.zip
for %%x in (%match%) do (
del %%x
) 
```

那么我认为你需要阅读这篇关于如何在 DOS 中操作字符串的文章：http: [//www.dostips.com/DtTipsStringManipulation.php](http://www.dostips.com/DtTipsStringManipulation.php)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-04T10:09:37.697

这样做，很简单

1.  窗户按钮 + r
2.  输入`cmd`并按回车
3.  导航到父目录：
    键入`c:`或`d:`（或您要导航到的驱动器的字母）
4.  键入`dir`以查看该目录内容的列表（`dir /ah`查看隐藏文件）
5.  然后要更改目录，请键入`cd xxxx`（ xxxx = 目录名称）
6.  重复 4&5，直到到达要运行批量删除的目录
7.  然后键入您的模式。类似的东西：`del /S /ah *.jpg`然后按Enter。它将遍历所有子目录，并删除所有可见和隐藏的 .jpg 文件

*****   是通配符
**/S**   从所有子文件夹中删除
**/ah**   a = 根据属性选择文件，h = 隐藏

**示例：**要删除从 Mac 复制到 Windows 时出现的那些烦人的 .DS_Store 文件，请运行：

`del /S /ah .DS_Store`

或者

`del /S /ah ._*`

这将获得从 Mac 复制到 Windows 时创建的所有“重复”隐藏文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-11T16:40:58.627

您可以简单地在下面使用：

```
forfiles /p C:\temp-new /s /c "cmd /c if @isdir==FALSE del @file" 
```

[TechNet 参考在此处输入链接描述](http://technet.microsoft.com/en-us/library/cc753551.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T09:40:33.727

也许“forfiles”命令可能有用

[http://technet.microsoft.com/en-us/library/cc753551.aspx](http://technet.microsoft.com/en-us/library/cc753551.aspx)

希望有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-21T18:39:22.720

此脚本将从文件夹（和子文件夹）中删除所有 .zip 文件，但仅当文件名不包含单词“backup”、“Backup”或“BACKUP”等时。

```
# Script DeleteZip.txt
var str folder, filelist, file
cd $folder
lf -r -n "*.zip" > $filelist
while ($filelist <> "")
do
    lex "1" $filelist > $file
    # Does this $file contain the word "backup" ? Do case independent search (-c option).
    if ( { sen -c "^backup^" $file } <= 0 )
        system del ("\""+$file+"\"")
    endif
done 
```

脚本在 biterscripting ( [http://www.biterscripting.com](http://www.biterscripting.com) ) 中。将脚本保存在文件 C:/Scripts/DeleteZip.txt 中。运行脚本为

```
script "C:/Scripts/DeleteZip.txt" folder("C:/testfolder") 
```

将在所有级别的文件夹 C:/testfolder 及其所有子文件夹上执行删除操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-10T12:23:55.960

您需要的一种简单方法：

```
FORFILES /P "DIRECTORY" /S /M SEARCHMASK /C "cmd /c if @file neq \"FILE_TO_EXCLUDE\" del /f @file" 
```

您仍然可以根据您的需要调整命令以排除特定文件和/或按日期。下面的“forfiles”文档中有更多详细信息。

*[https://docs.microsoft.com/pt-br/windows-server/administration/windows-commands/forfiles](https://docs.microsoft.com/pt-br/windows-server/administration/windows-commands/forfiles)*

# user-interface - UI设计和文化敏感性/意识

> ID：536110
> 
> 赞同：11
> 
> 时间：2009-02-11T09:36:43.410
> 
> 标签：user-interface, internationalization, culture

在为将要在国际范围内使用的应用程序设计用户界面时，可能会意外地设计 UI 的某个方面，该方面冒犯或不适合另一种文化。

你有没有遇到过这样的问题，如果有，你是如何解决设计问题的？

一些例子：

1.  在北爱尔兰使用的测量应用程序中的 GPS 天图。卫星必须以不同的颜色显示它们是在天空中上升还是下降。许多上升的卫星被认为是好的，因为这表明 GPS 覆盖范围将在接下来的几个小时内变得更好。
    我选择绿色代表上升，橙色代表下降。我没有[意识到](http://www.infoplease.com/spot/irishflag1.html)这些颜色与爱尔兰天主教徒和爱尔兰新教徒有关。有人建议我们改变颜色。最后选择了蓝色和深粉色。
2.  对于要翻译成德语的应用程序，我发现与英语文本相比，您应该为德语文本添加大约 50% 的额外空间。
3.  一位朋友正在为中东的一位客户开发战场规划应用程序。规定所有十字准线应采用对角十字的形式，以避免任何宗教意义。
4.  （编辑 - 添加了这个）在英国，勾号（类似于 √）表示*yes*而叉号 (x) 表示*no*。在 Windows 3.1 中，选中的复选框使用了十字，我第一次看到它时感到很困惑。从 Windows 95 开始，他们就使用了（我称之为）一个刻度线。据我所知，勾号和叉号在美国都称为复选标记，意思相同

## 编辑

请确保您添加到此问题的任何回复与我们都试图构建的用户界面一样具有文化敏感性！谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T10:03:57.447

您应该尝试遵循外观指南为您正在使用的 UI 库或您交付的平台提供的 i18n 和 l10n 指针。它们通常包含有关如何避免文化问题的提示，甚至可能包含已对此类潜在香蕉皮进行过广泛测试的图标库。

*   [Windows 用户体验交互指南](http://msdn.microsoft.com/en-us/library/aa511258.aspx)
*   [Java 外观设计指南](http://java.sun.com/products/jlf/ed2/book/index.html)
*   [Apple 人机界面指南](http://developer.apple.com/documentation/UserExperience/index.html)
*   [GNOME 人机界面指南](http://library.gnome.org/devel/hig-book/stable/)
*   [KDE 用户界面指南](http://developer.kde.org/documentation/design/ui/index.html)

我想最重要的是从头开始设计你的应用程序时考虑到 i18n，以便你的 UI 可以根据翻译的文本调整大小；助记符适用于不同的语言；标签在拉丁语的左侧，但在希伯来语和阿拉伯语等的右侧。

考虑到 i18n 和 l10n 的设计意味着将您的产品运送到具有不同文化、语言或货币的位置不需要重写或不同版本，只需不同的资源。

一般来说，我相信你会遇到更多关于图形和图标的问题，而不是文本（除了令人尴尬的翻译），这仅仅是因为人们更强烈地认同符号而不是特定的文本段落。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T07:19:10.727

使用大（绿色）复选标记符号表示 OK/Yes/Correct 的习语在瑞典有些令人困惑，在瑞典，复选标记通常用于表示“错误”。即在学校给考试评分时，老师通常会使用大写的 R（来自瑞典语中的“正确”一词）来表示正确答案，并使用复选标记（瑞典语中的“ [bock](http://sv.wikipedia.org/wiki/Bock) ”）表示“错误”。

我发现这个问题很有趣，不仅因为我在受影响的群体中（我是瑞典人），还因为它强调了这些类型的问题可能会出现在你可能没想到的地方。瑞典是一种通用的西方文化，你可能会认为这些符号的用法应该是一样的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T07:23:08.690

日本的另一个是/否示例

*我必须使用具有一些可以打开和关闭的用户设置的在线数据库工具。**开启**用**绿色十字**(×) 表示，**关闭**用**红色圆圈**(○) 表示。*

在日本，这是令人困惑的，因为通常关闭（NG，停止，关闭）将由十字（×：batsu）表示，而打开（ok，打开）由圆圈（○：maru）表示。除此之外，绿色红色组合使事情变得非常混乱。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T10:32:07.393

Windows 资源（而不仅仅是）包含的不仅仅是字符串是有充分理由的。许多元素应该被认为是可本地化的： - 颜色 - 图像（包括图标、工具栏等） - 声音 - 字体和字体大小 - 对齐 - 控制标志和属性（想想阿拉伯语和希伯来语的 UI 镜像） - 对话框大小 - 等等.

这样，本地化人员可以解决所有大多数问题，而无需更改任何代码。

对于对话框，调整大小应该由本地化人员完成（不需要留出额外的空间），或者应该使用自动布局（在 Java、.NET、Flex、wxWidgets、Qt 等框架中可用）

这也可能是一个很好的阅读：http: [//msdn.microsoft.com/en-us/goglobal/bb688120.aspx](http://msdn.microsoft.com/en-us/goglobal/bb688120.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T09:47:22.213

您将无法自行识别所有问题。UI/文化方面的专家会花费你很多钱。

首先为您的主要区域设计，然后一一发现并修复（如果可以）问题。

/* 这是我对应用于软件设计的宗教问题的看法。由于线程启动器不喜欢它而被删除。*/

当您成长为大型/国际/公司级别时，这些问题开始发挥作用。在那之前最好不要打扰。他们称之为“过早优化”。

德语，没错，与英语相比，内容/标记比率明显较低。另一个区别是单词往往很长，这意味着不仅文本区域会更长，而且当单词扩展出容器而不是换行时，您可能会遇到问题。

你喜欢那个： Kesselsteinentfernungsmittelherstellungsbetrieb 吗？

老实说，您无法以取悦所有人的方式进行设计。世界文化在许多方面是矛盾的。一旦你达到一定的扩展级别，你将不可避免地成为全世界许多混蛋的目标，他们认为你的应用程序的 UI 和颜色“令人反感”。

# string - C# Formatting - 如何正确格式化名称？即名字或姓氏

> ID：536112
> 
> 赞同：2
> 
> 时间：2009-02-11T09:38:02.843
> 
> 标签：string, compact-framework, formatting, c#-2.0

我目前正在被我的一个系统上显示和输入的所有名称所攻击。基本上，用户使用屏幕键盘并且不倾向于整齐地写东西！即约翰史密斯最终以约翰史密斯或约翰史密斯的身份进入。

我想要一种巧妙地输入名称并显示它们的方法。我编写了一个方法，它遍历了所有的名称并做到了这一点，但它大约有 20 行代码并且效率不高。

有没有实现这一目标的好方法？我尝试过.ToTitleCase()，但它不适用于O'Brien 和McCarthy 等案例？有什么比这更好的吗？我目前的代码基本上有一个特殊情况列表，如果它们包含特殊情况，则通过并操作它们......虽然这不是世界上最有效的事情。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T10:27:20.713

真的有关系吗？如果用户不关心他们的名字是全部大写还是全部小写，那么我建议您也不必担心。

确实关心他们的名字如何大写的用户可能会小心输入他们的名字。

如果你开始乱用大小写，那么就有弄错和冒犯用户的风险。

当然，该系统还有其他方面需要更多关注……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T10:18:47.550

正如您已经建议的那样，没有真正简单的方法可以实现这一点，而不必处理总是被名字抛出的特殊情况。

这个问题有几个可能对你有帮助的建议：

[如何在C#中将名字和姓氏的第一个字母大写？](https://stackoverflow.com/questions/72831/how-do-i-capitalize-first-letter-of-first-name-and-last-name-in-c/74023#74023)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-07T19:09:02.940

我有一个客户坚持某种程度的自动格式。以下代码正确解析了所有以前的海报示例。我们只运行一次并在表单上设置标志，这样如果用户感到沮丧，就可以覆盖自动设置。反馈实际上非常积极。希望这可以帮助那里的人。

```
public string FormalFormat(string inString)
{
    string outString = string.Empty;
    string _ErrorMessage = string.Empty;
    try
    {
        // Formal Format is made for names and addresses to assure 
        // proper formatting and capitalization
        if (string.IsNullOrEmpty(inString))
        {
            return string.Empty;
        }
        inString = inString.Trim();
        if (string.IsNullOrEmpty(inString))
        {
            return string.Empty;
        }
        // see if this is a word or a series of words
        //if(inString.IndexOf(" ") > 0)
        //{
        // Break out each word in the string. 
        char[] charSep = { ' ' };
        string[] aWords = inString.Split(charSep);
        int i = 0;
        int CapAfterHyphen = 0;
        for (i = 0; i < aWords.Length; i++)
        {

            string Word = aWords[i].Trim();
            CapAfterHyphen = Word.IndexOf("-");
            char[] chars = Word.ToCharArray();
            if (chars.Length > 3)
            {
                if (Char.IsLower(chars[1]) && Char.IsUpper(chars[2]))
                {
                    Word = Word.Substring(0, 1).ToUpper() + Word.Substring(1, 1).ToLower() + Word.Substring(2, 1).ToUpper() + Word.Substring(3).ToLower();
                }
                else
                {
                    Word = Word.Substring(0, 1).ToUpper() + Word.Substring(1).ToLower();
                }
            }
            if (CapAfterHyphen > 0)
            {
                Word = Word.Substring(0, CapAfterHyphen + 1) + Word.Substring(CapAfterHyphen + 1, 1).ToUpper() + Word.Substring(CapAfterHyphen + 2);
            }
            if (i > 0)
            {
                outString += " " + Word;
            }
            else
            {
                outString = Word;
            }
        }
    }
    catch (Exception e)
    {
        outString = inString;
        _ErrorMessage = e.Message;
    }
    return outString;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T09:44:30.533

当来自世界各地的中文、日文、阿拉伯文、希伯来文和许多其他人加入您的系统时，就会出现问题......

放眼全球。与爱尔兰人相处已经很困难了：P

也许向您的用户展示名称将如何显示，他们会更加小心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T11:26:38.263

还要考虑到，对于某些文化，它是先姓后跟名字，根本没有姓氏。

此外，有些名称不仅仅是两三个词。考虑：

*   曼努埃尔·德拉克鲁兹
*   肖恩·范德马克
*   爱丽丝圣克莱尔
*   安娜伊士曼-史密斯
*   宝银
*   胡志明
*   朱莉娅跑熊
*   与精灵对话

（最后一个是没有姓氏的美洲原住民名字。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T23:41:16.763

我相信格式很重要。格式错误的名称在列表或信封中看起来很糟糕（至少在我看来）。我总是有正确格式化它们的冲动。它几乎是我的痴迷。

所以 DanD，*我*就是这样做的：当用户在我的应用程序中输入他们的全名时，我会修剪（）所有名称，删除双空格，然后以正确大小写格式格式化所有名称。然后，我会向用户显示名称，提示如下：“我们的名称格式是否正确？” 并让用户有机会更正格式。在此之后，我只保存名称。祝你好运。

# c++ - Windows 上的 Unicode 基础知识

> ID：536123
> 
> 赞同：2
> 
> 时间：2009-02-11T09:42:53.393
> 
> 标签：c++, visual-studio, visual-c++, unicode

我有一个 C++ 库，我提供给其他开发人员。其中一个需要 i18n，所以他问我是否可以在 API 中的字符串中添加 L 前缀。

我对 i18n 不太了解，所以我有一些基本问题：

1.  当我用 Unicode 编译我的库时，其他开发人员可以像往常一样使用这个构建吗？或者开发人员是否也应该更改他们的 Visual Studio 设置以使用 unicode ？

2.  当我使用 Unicode 编译我的库时，是否需要更改标头和 .cpp 文件中的所有字符串？或者将 L 前缀添加到头文件中的字符串就足够了？

提前致谢！

保罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T09:53:30.263

对国际化 (i18n) 的支持远不止 Unicode。在我的头顶上，有：

*   货币
*   数字表示
*   文本编码（通过使用 Unicode 部分抽象）
*   从右到左的脚本
*   文本翻译机制

其中大部分都可以通过 Window 上的 APIs 以某种形式获得，无论是 Win32 还是 .Net 等。我建议你看看：

*   [微软 .Net 国际化](http://msdn.microsoft.com/en-us/goglobal/bb688096.aspx)
*   [Microsoft Win32 国际化清单](http://msdn.microsoft.com/en-us/library/cc194756.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T10:03:21.020

添加 L 前缀会将字符串从`char`数组更改为`short`数组。更好的选择是用“TEXT”宏包装所有字符串，即

```
TEXT("My string") 
```

如果您的构建是 Unicode 构建，则您的所有字符串都将成为`short`s 的数组，但如果不是，它们仍保留为`char`s 的数组。Windows 还提供以下类型：

```
LPWSTR = short *

LPTSTR = short *, or char * if UNICODE not defined

LPSTR = char * 
```

不过不要忘记；即使您在`TEXT`字符串中添加了前缀或包装，您也需要确保调用正确的函数。标准的 Windows 字符串 API，例如`lstrlen`自动切换`char *`到`short *`if`UNICODE`已定义，但您需要确保您没有使用仅使用`char *`.

您的库导出的使用字符串的函数也会破坏使用您的库的旧应用程序，因为这些应用程序仍将传递`char`s 而不是`short`s 的数组，因此您可能希望在其中以某种向后兼容性工作。

# java - 面向非程序员的 Java 移动游戏生成器？

> ID：536126
> 
> 赞同：0
> 
> 时间：2009-02-11T09:43:06.390
> 
> 标签：java, mobile

市场上是否有任何工具支持用 Java 为移动设备制作游戏，供非程序员使用？

在我们计划构建这样的工具（仅适用于简单游戏）作为我们主要产品的附加组件之前，我需要找到最好和最快的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T10:06:56.567

[在Game Builder](http://wiki.netbeans.org/CreatingJavaMEGamesWithGameBuilder)获得战利品。

# c# - Excel VSTO 如何工作？

> ID：536130
> 
> 赞同：8
> 
> 时间：2009-02-11T09:43:58.150
> 
> 标签：c#, excel, vsto, clr-hosting

Excel VSTO 如何工作？如果我在 Visual Studio 2005 中创建 Excel 工作簿解决方案，我就可以愉快地编写代码并完全访问 Excel 对象模型，甚至可以将 Excel 工作表视为设计图面。当我构建解决方案时，我得到一个`.XLS`文件和一个`.DLL`（包含我的 C# 代码）。

我现在可以通过双击来启动 Excel 工作表，`.XLS`并且我的工作表可以使用我的所有 C# 代码和我放在工作表上的任何控件等运行。

工作表是如何引用的`.DLL`？excel 工作簿/工作表的哪一部分告诉它需要启动 CLR 并托管我的程序集？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T10:23:04.780

根据[这个](http://msdn.microsoft.com/en-us/library/zcfbd2sk.aspx)（感谢 PintSizedCat）对于 Excel 2003，会发生以下情况：

> Microsoft Office 应用程序检查自定义文档属性以查看是否存在与文档关联的托管代码扩展。有关详细信息，请参阅自定义文档属性概述。
> 
> 如果存在托管代码扩展，则应用程序会加载 AddinLoader.dll。这是一个非托管 DLL，它是 Visual Studio 2005 Tools for Office Second Edition 运行时的加载器组件。有关详细信息，请参阅用于 Office 运行时概述的 Visual Studio 工具。
> 
> AddinLoader.dll 加载 .NET Framework 并启动 Visual Studio Tools for Office 运行时的托管部分。
> 
> Visual Studio Tools for Office 运行时创建应用程序域，为应用程序域设置策略以不信任我的电脑区域，并检查代码访问安全策略存储以查找自定义程序集的策略。
> 
> .NET Framework 根据策略验证程序集提供的证据。如果失败，则会引发错误。如果通过，则该过程继续。
> 
> 如果自定义项使用部署清单，则 Visual Studio Tools for Office 运行时使用它来检查程序集更新。如果需要任何更新，则立即执行。
> 
> Visual Studio Tools for Office 运行时将程序集加载到应用程序域中。
> 
> Visual Studio Tools for Office 运行时调用自定义程序集中的启动事件处理程序。有关详细信息，请参阅用于 Office 项目事件的 Visual Studio 工具。

在我的测试项目的 Excel 工作簿中，我有两个自定义属性：

_AssemblyName，值 = * _AssemblyLocation，值 = {533b2c13-a125-418a-bfff-9546b0762807}

我想这些是将 VSTO 运行时引导到我的程序集的属性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T09:48:33.037

这一切都在注册表中完成，您应该能够在`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Excel`或您的等效应用程序中找到密钥。我对在注册表中其他地方注册的 COM 插件有更多的经验。这个键下面应该有一个 LoadBehaviour 项，用于确定应用程序是如何加载的（2 是手动加载，3 是启动时自动加载）。

您有 VSTO 的安装项目吗？在那里你可以看到设置的注册表项，但安装程序将/应该也注册 GAC 中的 VSTO（尽管不要相信我的话，因为我对 VSTO 有点动摇，正如我所说的）。

希望这会有所帮助，我将尝试为您找到更多信息。

编辑您应该尝试阅读以下[http://msdn.microsoft.com/en-us/library/bb386298.aspx](http://msdn.microsoft.com/en-us/library/bb386298.aspx)，它将为您解释插件是什么。它实际上只是一个从注册表加载的 COM 主机的包装器，VSTO 使用一些互操作性代码与之对话。

[http://msdn.microsoft.com/en-us/library/23cw517s.aspx](http://msdn.microsoft.com/en-us/library/23cw517s.aspx)也很有用（Visual Studio Tools for Office 入门，不要敲它，因为它说入门，有很多有用的信息在那里）和[http://msdn.microsoft.com/en-us/library/hy7c6z9k.aspx](http://msdn.microsoft.com/en-us/library/hy7c6z9k.aspx)（从第一个链接开始，是 VSTO 插件的概述）。

# javascript - IE 的 styleWithCSS

> ID：536132
> 
> 赞同：6
> 
> 时间：2009-02-11T09:44:35.683
> 
> 标签：javascript, internet-explorer, wysiwyg, rte

我正在构建一个自定义 RTE，将用户输入转换为自制标记，现在我是白痴，我使用带有 designMode = "On" 的 iframe 完成此操作，并使用 styleWithCSS = false 让它在 Firefox 中工作，这样我就可以轻松转换将`<b>`(是... b :( ) 放入我的标记中，然后输出正确的代码，而不是我必须从`<span style="...`现在开始阅读我的问题是，我似乎无法找到看起来或行为类似于 styleWithCSS = false 的东西，用于 IE、Chrome或 Opera，欢迎提出任何建议。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-08-25T10:51:59.337

用这个：

```
 try {
                Editor.execCommand("styleWithCSS", 0, false);
            } catch (e) {
                try {
                    Editor.execCommand("useCSS", 0, true);
                } catch (e) {
                    try {
                        Editor.execCommand('styleWithCSS', false, false);
                    }
                    catch (e) {
                    }
                }
            } 
```

在任何其他 execCommands 之前。在 ff3 ie7 ie8 safari chrome 上测试

# sharepoint - 以编程方式更改 SharePoint 中目录的名称是否可行？

> ID：536136
> 
> 赞同：5
> 
> 时间：2009-02-11T09:46:05.647
> 
> 标签：sharepoint

快速总结我的问题：

以编程方式更改 SharePoint 中目录的名称（包括文件和子文件夹）是否可行？我希望用户至少在某些情况下会签出我正在尝试重命名的文件。

的背景：

我目前正在与一家生产带有可配置文档管理系统的基于 Web 的软件 (ASP.NET) 的公司签订合同。该系统可以配置为使用不同的底层系统，最常见的环境是 SharePoint (WSS 3)。

我被分配了一项任务来扩展现在必须是一个相当简单的系统（只需将文件输出到一个固定的目录结构中，偶尔读取）。在我对最佳实践进行一些研究之前从未使用过 SharePoint，并试图找出可行的方法。在这个阶段，我自己无法访问测试环境，因此仅限于在线阅读。

一种要求是让目录结构反映当前客户端的名称（作为一个示例） - 因此客户端的所有文档都将位于一个位置，并且可以通过 SharePoint 或其他兼容的应用程序从外部访问。规范指出，如果客户端名称发生更改，则目录结构应立即更新。我担心这会直接导致错误（例如，权限被拒绝）或间接导致错误（外部签出文件的用户丢失工作）。

如果对上述内容有疑问，作为后续问题，是否有更好的方法来实施上述内容？我已经看过建议用户使用视图来访问 SharePoint 中的结构，但是我们的 BA 担心用户将无法直接将新文件上传到此结构中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T21:02:45.880

SharePoint 中的文件夹的问题在于，它们并不是您所期望的文件系统中的真正文件夹。SiteCollection 中的所有文件都存储在数据库上的一个大表中（查看 AllDocs 表）。

我不能断然地说重命名文件夹而不做一些测试是安全的，我知道文件夹“名称”不是访问文档的关键，尽管它似乎基于您在浏览器中看到的 Url。

最好的办法是进行快速测试，但我很确定您的计划不会有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T02:25:43.217

潜在的问题是任何内容查询 Web 部件等是否依赖于特定文件夹的存在，或者是否有任何其他“代码”或“页面”查找该文件夹而不是文件夹 ID。

在生产中“尝试”它之前保存列表的内容。您不想丢失数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T15:53:56.143

签出的文档仍将按照您期望的方式工作。但是，您可能必须再次运行爬网。

# c# - C# Regex partial string match

> ID：536147
> 
> 赞同：2
> 
> 时间：2009-02-11T09:49:10.540
> 
> 标签：c#, regex

everyone, i've got below function to return true if input is badword

```
public bool isAdultKeyword(string input)
{
    if (input == null || input.Length == 0)
    {
        return false;
    }
    else
    {
        Regex regex = new Regex(@"\b(badword1|badword2|anotherbadword)\b");
        return regex.IsMatch(input);
    }
} 
```

above function only matched to whole string i.e if input badword it wont match but it will when input is bawrod1.

what im trying to do it is get match when part of input contains one of the badwords

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T09:51:39.503

So under your logic, would you match as to ass?

Also, remember the classic place Scunthorpe - your adult filter needs to be able to allow this word through.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T10:08:42.427

You probably don't have to do it in such a complex way but you can try to implement [Knuth-Morris-Pratt](http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm). I had tried using it in one of my failed(totally my fault) OCR enhancer modules.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-03T03:39:34.863

尝试：

```
Regex regex = new Regex(@"(\bbadword1\b|\bbadword2\b|\banotherbadword\b)"); 
return regex.IsMatch(input); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-29T01:02:00.663

你的方法似乎工作正常。你能澄清一下它有什么问题吗？下面我的测试程序显示它通过了许多测试而没有失败。

```
using System;
using System.Text.RegularExpressions;

namespace CSharpConsoleSandbox {
  class Program {
    public static bool isAdultKeyword(string input) {
      if (input == null || input.Length == 0) {
        return false;
      } else {
        Regex regex = new Regex(@"\b(badword1|badword2|anotherbadword)\b");
        return regex.IsMatch(input);
      }
    }

    private static void test(string input) {
      string matchMsg = "NO : ";
      if (isAdultKeyword(input)) {
        matchMsg = "YES: ";
      }
      Console.WriteLine(matchMsg + input);
    }

    static void Main(string[] args) {
      // These cases should match
      test("YES badword1");
      test("YES this input should match badword2 ok");
      test("YES this input should match anotherbadword. ok");

      // These cases should not match
      test("NO badword5");
      test("NO this input will not matchbadword1 ok");
    }
  }
} 
```

输出：

```
YES: YES badword1
YES: YES this input should match badword2 ok
YES: YES this input should match anotherbadword. ok
NO : NO badword5
NO : NO this input will not matchbadword1 ok 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T11:48:14.720

\b 是正则表达式中的单词边界吗？

在这种情况下，您的正则表达式只会查找整个单词。删除这些将匹配任何出现的坏词，包括它作为更大单词的一部分包含在哪里。

```
Regex regex = new Regex(@"(bad|awful|worse)", RegexOptions.IgnoreCase); 
```

# c++ - C++ 字符串解析（python 风格）

> ID：536148
> 
> 赞同：19
> 
> 时间：2009-02-11T09:49:23.910
> 
> 标签：c++, python, parsing, string, text-files

我喜欢在 python 中我可以执行以下操作：

```
points = []
for line in open("data.txt"):
    a,b,c = map(float, line.split(','))
    points += [(a,b,c)] 
```

基本上它正在读取一个行列表，其中每行代表 3D 空间中的一个点，该点表示为三个用逗号分隔的数字

如何在 C++ 中做到这一点而不会让人头疼？

性能不是很重要，这种解析只发生一次，所以简单性更重要。

PS我知道这听起来像是一个新手问题，但相信我，我已经用 D 语言编写了一个词法分析器（非常像 C++），它涉及逐个字符地读取一些文本字符并识别标记，
就是这样，在很长一段时间后回到 C++ python的时期，只是让我不想在这些事情上浪费我的时间。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-11T10:33:17.250

我会做这样的事情：

```
ifstream f("data.txt");
string str;
while (getline(f, str)) {
    Point p;
    sscanf(str.c_str(), "%f, %f, %f\n", &p.x, &p.y, &p.z); 
    points.push_back(p);
} 
```

x,y,z 必须是浮点数。

并包括：

```
#include <iostream>
#include <fstream> 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-11T11:45:35.893

除了所有这些很好的例子，在 C++ 中，您通常会覆盖`operator >>`for 您的点类型以实现如下效果：

```
point p;
while (file >> p)
    points.push_back(p); 
```

甚至：

```
copy(
    istream_iterator<point>(file),
    istream_iterator<point>(),
    back_inserter(points)
); 
```

运算符的相关实现可能看起来很像 j_random_hacker 的代码。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-20T15:57:05.953

C++ 字符串工具包库[(StrTk)](http://www.partow.net/programming/strtk/index.html)为您的问题提供了以下解决方案：

```
#include <string>
#include <deque>
#include "strtk.hpp"

struct point { double x,y,z; }

int main()
{
   std::deque<point> points;
   point p;
   strtk::for_each_line("data.txt",
                        [&points,&p](const std::string& str)
                        {
                           strtk::parse(str,",",p.x,p.y,p.z);
                           points.push_back(p);
                        });
   return 0;
} 
```

更多示例可以在[这里找到](http://www.codeproject.com/KB/recipes/Tokenizer.aspx)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-11T09:59:21.730

```
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <vector>
#include <algorithm>     // For replace()

using namespace std;

struct Point {
    double a, b, c;
};

int main(int argc, char **argv) {
    vector<Point> points;

    ifstream f("data.txt");

    string str;
    while (getline(f, str)) {
        replace(str.begin(), str.end(), ',', ' ');
        istringstream iss(str);
        Point p;
        iss >> p.a >> p.b >> p.c;
        points.push_back(p);
    }

    // Do something with points...

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-11T10:19:55.300

该答案基于 j_random_hacker 先前的答案，并利用了 Boost Spirit。

```
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <boost/spirit.hpp>

using namespace std;
using namespace boost;
using namespace boost::spirit;

struct Point {
    double a, b, c;
};

int main(int argc, char **argv) 
{
    vector<Point> points;

    ifstream f("data.txt");

    string str;
    Point p;
    rule<> point_p = 
           double_p[assign_a(p.a)] >> ',' 
        >> double_p[assign_a(p.b)] >> ',' 
        >> double_p[assign_a(p.c)] ; 

    while (getline(f, str)) 
    {
        parse( str, point_p, space_p );
        points.push_back(p);
    }

    // Do something with points...

    return 0;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-11T16:01:43.297

Boost.Tuples 的乐趣：

```
#include <boost/tuple/tuple_io.hpp>
#include <vector>
#include <fstream>
#include <iostream>
#include <algorithm>

int main() {
    using namespace boost::tuples;
    typedef boost::tuple<float,float,float> PointT;

    std::ifstream f("input.txt");
    f >> set_open(' ') >> set_close(' ') >> set_delimiter(',');

    std::vector<PointT> v;

    std::copy(std::istream_iterator<PointT>(f), std::istream_iterator<PointT>(),
             std::back_inserter(v)
    );

    std::copy(v.begin(), v.end(), 
              std::ostream_iterator<PointT>(std::cout)
    );
    return 0;
} 
```

请注意，这并不严格等同于您问题中的 Python 代码，因为元组不必位于单独的行上。例如，这个：

```
1,2,3 4,5,6 
```

将给出与以下相同的输出：

```
1,2,3
4,5,6 
```

由您决定这是错误还是功能:)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-11T09:55:27.700

您可以逐行从 std::iostream 读取文件，将每一行放入 std::string 中，然后使用 boost::tokenizer 将其拆分。它不会像 python 那样优雅/简短，但比一次读取一个字符中的内容要容易得多......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-11T20:58:00.290

它远没有那么简洁，当然我没有编译它。

```
float atof_s( std::string & s ) { return atoi( s.c_str() ); }
{ 
ifstream f("data.txt")
string str;
vector<vector<float>> data;
while( getline( f, str ) ) {
  vector<float> v;
  boost::algorithm::split_iterator<string::iterator> e;
  std::transform( 
     boost::algorithm::make_split_iterator( str, token_finder( is_any_of( "," ) ) ),
     e, v.begin(), atof_s );
  v.resize(3); // only grab the first 3
  data.push_back(v);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-25T14:19:26.773

Sony Picture Imagework 的开源项目之一是[Pystring](http://code.google.com/p/pystring/)，它应该可以直接翻译字符串分割部分：

> Pystring 是 C++ 函数的集合，它们使用 std::string 匹配 python 字符串类方法的接口和行为。在 C++ 中实现，它不需要或使用 python 解释器。它为标准 C++ 库中不包含的常见字符串操作提供了方便和熟悉

有[几个例子](http://code.google.com/p/pystring/wiki/Examples)和[一些文档](http://code.google.com/p/pystring/wiki/Documentation)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-19T15:15:48.213

所有这些都是很好的例子。但他们没有回答以下问题：

1.  具有不同列号的 CSV 文件（某些行的列比其他行多）
2.  或者当某些值有空格时（ya yb,x1 x2,,x2,）

所以对于那些还在寻找的人来说，这个类： http: [//www.codeguru.com/cpp/tic/tic0226.shtml](http://www.codeguru.com/cpp/tic/tic0226.shtml) 很酷......可能需要一些改变

# perl - 如何使用 Perl 找到挂载卷上的可用空间？

> ID：536160
> 
> 赞同：6
> 
> 时间：2009-02-11T09:53:14.010
> 
> 标签：perl, diskspace

我正在尝试解压缩文件。在解压之前，我想知道已安装卷上的可用空间。计划是如果没有足够的空间，我不会解压它！那么如何使用 Perl 找到已安装卷上的可用空间？顺便说一句，我正在使用 Perl 进行 tar 和 untar。

每个人都在谈论`df`，`dh`但这些命令在挂载点上不起作用。如果我想在挂载点上找到可以写入的空闲空间怎么办？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T09:55:40.210

您可能需要 CPAN 模块[Filesys::DfPortable](https://metacpan.org/pod/Filesys::DfPortable)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T11:26:37.837

使用 shell 命令生成 Perl 可以使用的单个 K-free 数字：

切换到要解压的目录（如果还没有的话）并执行：

```
df . | grep -v '^Filesystem' | awk 'NF=6{print $4}NF==5{print $3}{}' 
```

或替换“。” 与实际的安装点。

grep 去掉了标题，awk 打印出可用于拆分行和非拆分行的千字节。

这是基于以下类型的输出，如果您的 UNIX 输出不同，您可能需要进行调整：

```
文件系统 1K-blocks Used 可用 Use% Mounted on
/dev/sda4 206434224 56965356 139065176 30% /
varrun 1037296 132 1037164 1% /var/run
varlock 1037296 0 1037296 0% /var/lock
开发 1037296 68 1037228 1% /开发
devshm 1037296 12 1037284 1% /dev/shm
/dev/sda2 93327 43535 44973 50% /boot
/dev/sdc1 155056484 29417456 117824612 20% /media/extra160
gvfs-fuse 守护进程
              206434224 56965356 139065176 30% /home/pax/.gvfs

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T10:00:54.693

您可以使用内置的 linux 命令来获得结果：

```
my $vol = "/dev/volume";
my $freespace = `df $vol | grep '$vol' | awk '{print \$4}'`;
# free space in megabytes.
$freespace = sprintf("%01.2f", $freespace / 1024); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-18T21:14:23.450

尝试[Filesys::DF](http://search.cpan.org/~iguthrie/Filesys-Df-0.92/Df.pm)（posix 系统）或[Filesys::DfPortable](http://search.cpan.org/~iguthrie/Filesys-DfPortable-0.85/DfPortable.pm)（也适用于 Windows）。它们都使用本机代码来枚举 FS 统计信息。

# linq-to-entities - LINQ to Entities, how to return all records from the Parent table?

> ID：536162
> 
> 赞同：1
> 
> 时间：2009-02-11T09:54:02.010
> 
> 标签：linq-to-entities, left-join

I am unable to select all the records from the parent table using Linq to Entities.

This is a simple DB design (image below):

~~[Image Link](http://www.thinkboard.com/myimages/tablerelation.jpg)~~ (Dead Link)

This is the exact output I want using Linq to Entities or Linq to SQL (image below):

~~[Image Link](http://www.thinkboard.com/myimages/sqlresults.jpg)~~ (Dead Link)

When I use Linq to Entities or Linq To Sql, I can only get the records from the child table that has a foreign key relation. I am not able to get the null values as shown above.

I want to have the null values show just like when you use `left outer join`.

Thanks for any help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T17:00:53.483

```
from entity in MyContext.EntityType.Include("ChildEntitiesNavigationPropertyName")
select entity; 
```

这将返回 EntityType 的所有实例，以及 ChildEntitiesNavigationPropertyName（如果存在）。对于表格形式，使用匿名类型：

```
from entity in MyContext.EntityType.Include("ChildEntitiesNavigationPropertyName")
select new {ParentProperty = entity.ParentProperty, 
            ChildProperty  = entity.ChildEntitiesNavigationPropertyName.ChildProperty}; 
```

对于 1..* 属性：

```
from entity in MyContext.EntityType.Include("ChildEntitiesNavigationPropertyName")
from child in entity.ChildEntitiesNavigationPropertyName.DefaultIfEmpty()
select new {ParentProperty = entity.ParentProperty, 
            ChildProperty  = child.ChildProperty}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T00:10:43.063

我很确定您可以从员工中进行选择，然后在 LINQ 中进行左连接，就像这样（我在这台机器上没有 VS）：

```
var results = from e in dbContext.Employees join s in dbContext.Sales on e.EmployeeID equals s.EmployeeID select new { e, s }; 
```

您可能想要选择您想要的列。希望它能给你你想要的结果。

# c++ - 为什么我的 OpenGL 不会绘制任何东西？

> ID：536168
> 
> 赞同：0
> 
> 时间：2009-02-11T09:56:24.967
> 
> 标签：c++, opengl, sdl

我正在将我的开源粒子引擎测试从 SDL 移植到 SDL + OpenGL。我已经设法让它编译并运行，但无论我做什么，屏幕都保持黑色。主.cpp：

```
#include "glengine.h"

int WINAPI WinMain(
    HINSTANCE hInstance,
    HINSTANCE hPrevInstance,
    LPSTR lpCmdLine,
    int nCmdShow
)
{
//Create a glengine instance
ultragl::glengine *gle = new ultragl::glengine();

if(gle->init())
    gle->run();

else
    std::cout << "glengine initializiation failed!" << std::endl;

//If we can't initialize, or the lesson has quit we delete the instance
delete gle;

return 0;
}; 
```

glengine.h:

```
//we need to include window first because GLee needs to be included before GL.h
#include "window.h"
#include <math.h>           // Math Library Header File
#include <vector>
#include <stdio.h>

using namespace std;

namespace ultragl
{
    class glengine
    {
        protected:
                window m_Window; ///< The window for this lesson
                unsigned int m_Keys[SDLK_LAST]; ///< Stores keys that are pressed
                float piover180;

                virtual void draw();
                virtual void resize(int x, int y);
                virtual bool processEvents();
                void controls();

        private:
            /*
             * We need a structure to store our vertices in, otherwise we
             * just had a huge bunch of floats in the end
             */
            struct Vertex
            {
                float x, y, z;

                Vertex(){}

                Vertex(float x, float y, float z)
                {
                    this->x = x;
                    this->y = y;
                    this->z = z;
                }
            };

            struct particle
            {
                public :
                double angle;
                double speed;
                Vertex v;
                int r;
                int g;
                int b;
                int a;

                particle(double angle, double speed, Vertex v, int r, int g, int b, int a)
                {
                    this->angle = angle;
                    this->speed = speed;
                    this->v = v;
                    this->r = r;
                    this->g = g;
                    this->b = b;
                    this->a = a;
                }

                particle()
                {

                }

            };

            particle p[500];
            float particlesize;

        public:
            glengine();
            ~glengine();

            virtual void run();
            virtual bool init();
            void glengine::test2(int num);
            void glengine::update();
    };
}; 
```

窗口.h：

```
#include <string>
#include <iostream>

#include "GLee/GLee.h"

#include <SDL/SDL.h>
#include <SDL/SDL_opengl.h>
#include <GL/glu.h>

using namespace std;

namespace ultragl
{
    class window
    {
        private:
            int w_height;
            int w_width;
            int w_bpp;
            bool w_fullscreen;
            string w_title;

        public:
            window();
            ~window();

            bool createWindow(int width, int height, int bpp, bool fullscreen, const string& title);
            void setSize(int width, int height);
            int getHeight();
            int getWidth();
    };
}; 
```

glengine.cpp（要查看的主要文件）：

```
#include "glengine.h"

namespace ultragl{

    glengine::glengine()
    {
        piover180 = 0.0174532925f;
    }

    glengine::~glengine()
    {

    }

    void glengine::resize(int x, int y)
    {
        std::cout << "Resizing Window to " << x << "x" << y << std::endl;

        if (y <= 0)
        {
            y = 1;
        }

        glViewport(0,0,x,y);

        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        gluPerspective(45.0f,(GLfloat)x/(GLfloat)y,1.0f,100.0f);

        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
    }

    bool glengine::processEvents()
    {
        SDL_Event event;

        while (SDL_PollEvent(&event))//get all events
        {
            switch (event.type)
            {
                // Quit event
                case SDL_QUIT:
                {
                    // Return false because we are quitting.
                    return false;
                }

                case SDL_KEYDOWN:
                {
                    SDLKey sym = event.key.keysym.sym;

                    if(sym == SDLK_ESCAPE) //Quit if escape was pressed
                    {
                        return false;
                    }

                    m_Keys[sym] = 1;
                    break;
                }

                case SDL_KEYUP:
                {
                    SDLKey sym = event.key.keysym.sym;
                    m_Keys[sym] = 0;
                    break;
                }

                case SDL_VIDEORESIZE:
                {
                    //the window has been resized so we need to set up our viewport and projection according to the new size
                    resize(event.resize.w, event.resize.h);
                    break;
                }
                // Default case
                default:
                {
                    break;
                }
            }
        }

        return true;
    }

    bool glengine::init()
    {
        srand( time( NULL ) );

        for(int i = 0; i < 500; i++)
            p[i] = particle(0, 0, Vertex(0.0f, 0.0f, 0.0f), 0, 0, 0, 0);

        if (!m_Window.createWindow(640, 480, 32, false, "Paricle Test GL"))
        {
            return false;
        }

        particlesize = 0.01;
        glShadeModel(GL_SMOOTH);                // Enable Smooth Shading
        glClearColor(0.0f, 0.0f, 0.0f, 0.5f);   // Black Background
        glClearDepth(1.0f);                     // Depth Buffer Setup
        glEnable(GL_DEPTH_TEST);                // Enables Depth Testing
        glDepthFunc(GL_LEQUAL);                 // The Type Of Depth Testing To Do
        glEnable(GL_BLEND);
        glBlendFunc(GL_ONE , GL_ONE_MINUS_SRC_ALPHA);

        return true;
    }

    void glengine::test2(int num)
    {
        glPushMatrix();
            glTranslatef(p[num].v.x, p[num].v.y, p[num].v.z);
            glBegin(GL_QUADS);
                glColor4i(p[num].r, p[num].g, p[num].b, p[num].a);                // Green for x axis
                    glVertex3f(-particlesize, -particlesize,  particlesize);
                    glVertex3f( particlesize, -particlesize,  particlesize);
                    glVertex3f( particlesize,  particlesize,  particlesize);
                    glVertex3f(-particlesize,  particlesize,  particlesize);
            glEnd();

        glPopMatrix();
    }

    void glengine::draw()
    {
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // Clear Screen And Depth Buffer
        glLoadIdentity();                   // Reset The Current Modelview Matrix

        gluLookAt(0, 5, 20, 0, 0, 0, 0, 0, 0);
        for(int i = 0; i < 500; i++)
            test2(i);
    }

    void glengine::update()
    {
        for(int i = 0; i < 500; i++)
        {
            if(p[i].a <= 0)
                p[i] = particle(5 + rand() % 360, (rand() % 10) * 0.1, Vertex(0.0f, 0.0f, 0.0f), 0, 255, 255, 255);

            else
                p[i].a -= 1;

            p[i].v.x += (sin(p[i].angle * (3.14159265/180)) * p[i].speed);
            p[i].v.y -= (cos(p[i].angle * (3.14159265/180)) * p[i].speed);
        }
    }

    void glengine::run()
    {
        while(processEvents())
        {
            update();
            draw();
            SDL_GL_SwapBuffers();
        }
    }
}; 
```

最后是window.cpp：

```
#include "window.h"

namespace ultragl
{
    window::window(): w_width(0), w_height(0), w_bpp(0), w_fullscreen(false)
    {

    }

    window::~window()
    {
        SDL_Quit();
    }

    bool window::createWindow(int width, int height, int bpp, bool fullscreen, const string& title)
    {
        if( SDL_Init( SDL_INIT_VIDEO ) != 0 )
            return false;

        w_height = height;
        w_width = width;
        w_title = title;
        w_fullscreen = fullscreen;
        w_bpp = bpp;

        //Set lowest possiable values.
        SDL_GL_SetAttribute(SDL_GL_RED_SIZE, 5);
        SDL_GL_SetAttribute(SDL_GL_GREEN_SIZE, 5);
        SDL_GL_SetAttribute(SDL_GL_BLUE_SIZE, 5);
        SDL_GL_SetAttribute(SDL_GL_ALPHA_SIZE, 5);
        SDL_GL_SetAttribute(SDL_GL_DEPTH_SIZE, 16);
        SDL_GL_SetAttribute(SDL_GL_DOUBLEBUFFER, 1);

        //Set title.
        SDL_WM_SetCaption(title.c_str(), title.c_str());

        // Flags tell SDL about the type of window we are creating.
        int flags = SDL_OPENGL;

        if(fullscreen == true)
            flags |= SDL_FULLSCREEN;

        // Create window
        SDL_Surface * screen = SDL_SetVideoMode( width, height, bpp, flags );

        if(screen == 0)
            return false;

        //SDL doesn't trigger off a ResizeEvent at startup, but as we need this for OpenGL, we do this ourself
        SDL_Event resizeEvent;
        resizeEvent.type = SDL_VIDEORESIZE;
        resizeEvent.resize.w = width;
        resizeEvent.resize.h = height;

        SDL_PushEvent(&resizeEvent);

        return true;
    }

    void window::setSize(int width, int height)
    {
        w_height = height;
        w_width = width;
    }

    int window::getHeight()
    {
        return w_height;
    }

    int window::getWidth()
    {
        return w_width;
    }
}; 
```

无论如何，我真的需要完成这个，但我已经尝试了我能想到的一切。我以许多不同的方式测试了 glengine 文件，使其在某一时刻看起来像这样：

```
#include "glengine.h"
#include "SOIL/SOIL.h"
#include "SOIL/stb_image_aug.h"
#include "SOIL/image_helper.h"
#include "SOIL/image_DXT.h"

namespace ultragl{

    glengine::glengine()
    {
        piover180 = 0.0174532925f;
    }

    glengine::~glengine()
    {

    }

    void glengine::resize(int x, int y)
    {
        std::cout << "Resizing Window to " << x << "x" << y << std::endl;

        if (y <= 0)
        {
            y = 1;
        }

        glViewport(0,0,x,y);

        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        gluPerspective(45.0f,(GLfloat)x/(GLfloat)y,1.0f,1000.0f);

        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
    }

    bool glengine::processEvents()
    {
        SDL_Event event;

        while (SDL_PollEvent(&event))//get all events
        {
            switch (event.type)
            {
                // Quit event
                case SDL_QUIT:
                {
                    // Return false because we are quitting.
                    return false;
                }

                case SDL_KEYDOWN:
                {
                    SDLKey sym = event.key.keysym.sym;

                    if(sym == SDLK_ESCAPE) //Quit if escape was pressed
                    {
                        return false;
                    }

                    m_Keys[sym] = 1;
                    break;
                }

                case SDL_KEYUP:
                {
                    SDLKey sym = event.key.keysym.sym;
                    m_Keys[sym] = 0;
                    break;
                }

                case SDL_VIDEORESIZE:
                {
                    //the window has been resized so we need to set up our viewport and projection according to the new size
                    resize(event.resize.w, event.resize.h);
                    break;
                }
                // Default case
                default:
                {
                    break;
                }
            }
        }

        return true;
    }

    bool glengine::init()
    {
        srand( time( NULL ) );

        for(int i = 0; i < 500; i++)
            p[i] = particle(0, 0, Vertex(0.0f, 0.0f, 0.0f), 0, 0, 0, 0);

        if (!m_Window.createWindow(640, 480, 32, false, "Paricle Test GL"))
        {
            return false;
        }

        particlesize = 10.01;
        glShadeModel(GL_SMOOTH);                // Enable Smooth Shading
        glClearColor(0.0f, 0.0f, 0.0f, 0.5f);   // Black Background
        glClearDepth(1.0f);                     // Depth Buffer Setup
        glEnable(GL_DEPTH_TEST);                // Enables Depth Testing
        glDepthFunc(GL_LEQUAL);                 // The Type Of Depth Testing To Do
        glEnable(GL_BLEND);
        glBlendFunc(GL_ONE , GL_ONE_MINUS_SRC_ALPHA);

        return true;
    }

    void glengine::test2(int num)
    {
        //glPushMatrix();
            //glTranslatef(p[num].v.x, p[num].v.y, p[num].v.z);
                glColor4i(255, 255, 255, 255);

        glBegin(GL_QUADS);
            glNormal3f( 0.0f, 0.0f, 1.0f);
            glVertex3f(-particlesize, -particlesize,  particlesize);
            glVertex3f( particlesize, -particlesize,  particlesize);
            glVertex3f( particlesize,  particlesize,  particlesize);
            glVertex3f(-particlesize,  particlesize,  particlesize);
        glEnd();

        // Back Face
        glBegin(GL_QUADS);
            glNormal3f( 0.0f, 0.0f,-1.0f);
            glVertex3f(-particlesize, -particlesize, -particlesize);
            glVertex3f(-particlesize,  particlesize, -particlesize);
            glVertex3f( particlesize,  particlesize, -particlesize);
            glVertex3f( particlesize, -particlesize, -particlesize);
        glEnd();

        // Top Face
        glBegin(GL_QUADS);
            glNormal3f( 0.0f, 1.0f, 0.0f);
            glVertex3f(-particlesize,  particlesize, -particlesize);
            glVertex3f(-particlesize,  particlesize,  particlesize);
            glVertex3f( particlesize,  particlesize,  particlesize);
            glVertex3f( particlesize,  particlesize, -particlesize);
        glEnd();

        // Bottom Face
        glBegin(GL_QUADS);
            glNormal3f( 0.0f,-1.0f, 0.0f);
            glVertex3f(-particlesize, -particlesize, -particlesize);
            glVertex3f( particlesize, -particlesize, -particlesize);
            glVertex3f( particlesize, -particlesize,  particlesize);
            glVertex3f(-particlesize, -particlesize,  particlesize);
        glEnd();

            // Right face
        glBegin(GL_QUADS);
            glNormal3f( 1.0f, 0.0f, 0.0f);
            glVertex3f( particlesize, -particlesize, -particlesize);
            glVertex3f( particlesize,  particlesize, -particlesize);
            glVertex3f( particlesize,  particlesize,  particlesize);
            glVertex3f( particlesize, -particlesize,  particlesize);
        glEnd();

            // Left Face
        glBegin(GL_QUADS);
            glNormal3f(-1.0f, 0.0f, 0.0f);
            glVertex3f(-particlesize, -particlesize, -particlesize);
            glVertex3f(-particlesize, -particlesize,  particlesize);
            glVertex3f(-particlesize,  particlesize,  particlesize);
            glVertex3f(-particlesize,  particlesize, -particlesize);
        glEnd();

        //glPopMatrix();
    }

    void glengine::draw()
    {
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // Clear Screen And Depth Buffer
        glLoadIdentity();                   // Reset The Current Modelview Matrix

        gluLookAt(0, 5, 20, 0, 0, 0, 0, 1, 0);
        for(int i = 0; i < 500; i++)
            test2(i);
    }

    void glengine::update()
    {
        for(int i = 0; i < 500; i++)
        {
            if(p[i].a <= 0)
                p[i] = particle(5 + rand() % 360, (rand() % 10) * 0.1, Vertex(0.0f, 0.0f, -5.0f), 0, 255, 255, 255);

            else
                p[i].a -= 1;

            p[i].v.x += (sin(p[i].angle * (3.14159265/180)) * p[i].speed);
            p[i].v.y -= (cos(p[i].angle * (3.14159265/180)) * p[i].speed);
        }
    }

    void glengine::run()
    {
        while(processEvents())
        {
            update();
            draw();
            SDL_GL_SwapBuffers();
        }
    }
}; 
```

它仍然没有工作。我真的在这个问题上束手无策。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T11:59:13.240

我没有检查你的代码，但是在调试这类问题时我总是做的一件事就是将清晰的颜色设置为像 (1, 0, 1) 左右这样的颜色。

这将帮助您查看问题是您绘制的对象是完全黑色的还是根本没有绘制。

编辑：正如评论中提到的那样：如果清除操作清除为正确的颜色或保持黑色，它还会显示您是否有正确的 GL 上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T00:18:37.017

好的，我设法使用您的很多建议以及我放置的其他一些源代码来修复它。原来问题出在 3 条不同的线路上。

颗粒大小 = 0.01；应该更大：粒子大小 = 1.01；

`glColor4i(255, 255, 255, 255)`正在将立方体变成与透明颜色相同的颜色，因为我用错了。我无法弄清楚如何正确使用它，所以我正在使用它`glColor4f(0.0f,1.0f,1.0f,0.5f)`，并且有效。

最后`gluLookAt(0, 5, 20, 0, 0, 0, 0, 0, 0)`需要`gluLookAt(0, 5, 20, 0, 0, 0, 0, 1, 0)`

感谢大家的帮助和时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T12:01:20.473

您没有检查 SDL-GL-SetAttribute() 调用的返回值。

您的显卡是否支持 5/5/5/5 20-bpp 颜色？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T10:33:16.360

检查 OpenGL 的错误状态。使用或。`glslDevil`_ 检查功能。你能测试一下 SDL 是否真的获得了设备上下文吗？Window 是否反映 glClearColor 调用的变化？不要使用 0.5 作为. 尝试这些建议并用 Simucal 建议的最小示例进行报告。`glIntercept``gDebugger``glGetError``glClearColor`

# asp.net - common error page in ASP.NET

> ID：536169
> 
> 赞同：1
> 
> 时间：2009-02-11T09:56:33.517
> 
> 标签：asp.net, exception

How to setup a common error page in ASP.NET website? Also how to handel the error in Data Access Layer by common error page?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T10:29:04.327

在我当前的项目中，我坚持使用 global.asax 中的 Application_Error 来向最终用户显示一个统一的错误页面，以防出现任何未处理的错误。我添加了一个 sendmail 调用，将某些例外情况发送到邮件地址，以便更好地了解问题所在（您不能依赖客户/访客来正确描述问题）。发送邮件和/或记录问题后，我将用户重定向到带有通用错误消息的 error.html。

在我的 DAL 中，我尝试/捕获大多数关键功能并相应地显示警告/错误（我返回状态/消息以显示例如连接是否无法建立/超时）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T10:33:42.100

这是我在启动新应用程序时倾向于开始的模式。抱歉，这是在 VB.NET 中；）

在 global.asax Server.Transfer 到您的自定义错误页面。

```
 Sub Application_Error(ByVal sender As Object, ByVal e As EventArgs)

        Server.Transfer("~/Error.aspx", False)

    End Sub 
```

然后在您的自定义错误页面中。

```
 Private Sub Page_Load

         Response.Clear() 
         Dim err As Exception = Server.GetLastError
         ...
    End Sub 
```

现在您可以测试异常的类型。您需要通过内部异常向下递归，因为父异常可能是一般的 Web 异常。让你的 DAL 抛出一个自定义类型的异常，你可以测试它并以不同的方式处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-21T10:15:34.870

在这里，我正在解释实现自定义错误页面功能的方法。

***分步实施***

*   创建错误页面：在根目录中开发一个错误页面（发生错误时必须显示的页面）。让我们认为错误页面的名称是**ErrorPage.aspx**

*   **配置 Web.Config ：在Web.Config**中编写以下代码

     **```
     <configuration>
     <system.web>
     <customErrors mode="On" defaultRedirect="~\ErrorPage.aspx"/>
     </system.web>
     </configuration> 
    ```** 

 **而已！！！现在，如果发生任何错误，它将重定向到错误页面。现在有时我们需要显示错误。在这种情况下，我们可以在 Global.asax 中编写几行代码

```
 void Application_Error(object sender, EventArgs e) 
       {
            Exception ex = Server.GetLastError().GetBaseException();
            Session["LastException"] = ex.ToString();
       } 
```

由于异常已被捕获并存储在 Session 中，现在我们可以显示来自会话的消息。所以我们可以在ErrorPage.aspx.cs中写下以下几行

```
 protected void Page_Load(object sender, EventArgs e)
            {
                 lblDisplayError.Text = Session["LastException"].ToString();

            } 
```

我们将能够在 ErrorPage 的标签上看到错误。希望它会正常工作。

谢谢

普里托姆·南迪

# iphone - Can you put a button in the Preferences for your iPhone app?

> ID：536175
> 
> 赞同：2
> 
> 时间：2009-02-11T09:58:38.643
> 
> 标签：iphone, cocoa-touch, preferences

I'm building an iphone app, and I wanna use the iPhone's built in Preferences stuff. It looks like I put options in there, but I'm interested in putting a Reset button in the Prefs. I see that Apple's built-in apps like Safari have buttons in their prefs (Clear History, Clear Cookies, etc). I don't see a way to do this for SDK apps. Help!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T13:19:19.647

您的[设置包](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationSettings/chapter_12_section_4.html#//apple_ref/doc/uid/TP40007072-CH13-SW12)不能包含任何可运行的代码，因此不可能有 safari 之类的按钮（清除历史记录、清除 Cookie 等）。

Safari 是 Apple 提供的内置应用程序，因此它可以访问普通 AppStore 应用程序无法访问的 API/权限。

您可以在[此处](http://developer.apple.com/iphone/library/documentation/PreferenceSettings/Conceptual/SettingsApplicationSchemaReference/Introduction/Introduction.html)查看可能的元素列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-09T22:52:56.927

由于您可以在运行时设置自己的应用程序首选项，因此您可以做的一件事是创建“下次运行时重置首选项”切换。

当您的应用程序启动时，请检查此设置，如果设置为“开”，请采取相应措施。不要忘记也重置切换。;-)

这是一个解释如何执行此操作的问答：[如何通过代码更改应用程序偏好设置？](https://stackoverflow.com/questions/1459275/how-to-change-the-app-preference-settings-through-code)

# asp.net - Web.config 在另一个项目中注册用户控件

> ID：536179
> 
> 赞同：0
> 
> 时间：2009-02-11T09:59:33.337
> 
> 标签：asp.net, user-controls, web-config

我有一个名为.Net 的项目：

What.Web.UI：我使用这个项目来放置所有将在所有网站项目中重用的自定义和用户控件。这些被组织在两个文件夹中：

```
 - CustomControls folder (with all the custom controls)
   - UserControls folder (with all the user controls) 
```

这是应该使用这些用户和自定义控件的 Web 项目的未来示例

随便.Web.UI.WebSite1 随便.Web.UI.WebSite2 .... .... ....随便.Web.UI.WebSiteN

在每个网站项目中使用自定义控件是没有问题的，我在web.config中使用如下方式注册了它：

```
<add tagPrefix="CustomControls" namespace="Whatever.Web.UI.CustomControls" assembly="Whatever.Web.UI"/> 
```

但是，我如何注册用户控件以计算他们有我需要引用的 ascx 部分，以便显示每个网站？

提前致谢。亲切的问候，何塞马。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T14:20:04.693

```
<system.web>
    <pages>
        <controls>
            <add src="~/UserControls/MyControl.ascx" tagName="MyControl" tagPrefix="MyControls"/>
        </controls>
    </pages>
</system.web> 
```

# sql-server - MSSQL2005：在不恢复全文目录的情况下恢复数据库

> ID：536182
> 
> 赞同：2
> 
> 时间：2009-02-11T10:00:40.917
> 
> 标签：sql-server, sql-server-2005, tsql

恢复我的数据库时，我遇到了正在使用的全文目录的物理文件的问题。

```
The file 'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\FTData\MyCatalog' cannot be overwritten.  It is being used by database 'demo2'. 
```

我使用这个恢复语句

```
 RESTORE database demo from disk = N'c:\temp\demo.bak' WITH REPLACE 
,MOVE 'demo_Data' TO 'd:\Program Files\Microsoft SQL Server 2005\MSSQL\Data\demo.MDF'     
,MOVE 'demo_Log' TO 'd:\Program Files\Microsoft SQL Server 2005\MSSQL\Data\demo.LDF'; 
```

一个解决方案是在没有全文目录的情况下进行恢复，但我可以弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T07:57:55.237

我不确定如何在没有全文文件的情况下进行还原，但您始终可以使用 move 进行还原。您已经在为数据库和日志文件执行此操作，只需使用以下命令完成您的语句：

```
,MOVE 'sysft_demo_ft' TO 'd:\NewLocationForFullTextFile.ft' 
```

您可以通过以下方式获取文件的确切名称：

```
RESTORE FILELISTONLY
FROM DISK='C:\yourbackupfile.bak' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-07T19:29:28.407

我也不得不用全文恢复数据库（事实上，我的自动恢复脚本也修复了自动恢复全文索引）

我不知道不恢复它们的任何方法（如果您没有为全文索引指定 RESTORE WITH MOVE，SQL 恢复会给您一个错误，除非存在与 .bak 文件中的原始路径匹配的路径)

我建议

1.  恢复整个数据库，包括全文索引
2.  删除数据库中的所有全文索引 枚举所有全文目录 SELECT name FROM DB.sys.fulltext_catalogs (SQL2005/2008) 然后生成 drop 命令（您可能必须在删除目录之前删除表上的索引） DROP全文目录 [名称]

# ruby - 类似于 DrScheme 的 Ruby 文本编辑器/IDE

> ID：536203
> 
> 赞同：2
> 
> 时间：2009-02-11T10:10:46.133
> 
> 标签：ruby, ide, racket, irb

对于那些没有使用过 DrScheme 的人来说，窗口分为两部分：一部分是您正在编辑的文件，另一部分是交互式 shell。当我运行一个文件时，它被加载到交互环境中，所以我可以调用我定义的函数等。交互环境仍然具有文本编辑器的所有功能（语法突出显示，自动完成等......）

那么是否有一个用于 Ruby 的 IDE，它不仅执行我正在制作的脚本，而且将它加载到 irb 中，并带有所有文本编辑器的好东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T20:52:21.947

这个确切的要求（即使是由 Scheme 博士推动的事实）最终促使我学习 Emacs。

这是我在 Windows Vista 下安装它的方法：

1.  [从http://ftp.gnu.org/gnu/windows/emacs/emacs-22.3-bin-i386.zip](http://ftp.gnu.org/gnu/windows/emacs/emacs-22.3-bin-i386.zip)下载 Emacs

2.  解压到你选择的目录

3.  解压后在任何你想要的地方创建一个*包含目录并复制*[ruby](http://svn.ruby-lang.org/cgi-bin/viewvc.cgi/trunk/misc/) *​​-mode.el*和*ruby* ​​-inf.el

4.  修改您的*.emacs*以告诉它在哪里可以找到您的包含并使用它们

> ```
> ; directory to put various el files into
> (add-to-list 'load-path "C:/emacs-22.3/includes")
> ;(1)modify .emacs to use ruby-mode 
> (autoload 'ruby-mode "ruby-mode"
>   "Mode for editing ruby source files" t)
> (setq auto-mode-alist
>       (append '(("\\.rb$" . ruby-mode)) auto-mode-alist))
> (setq interpreter-mode-alist (append '(("ruby" . ruby-mode))
>                               interpreter-mode-alist))
> ;(2)set to load inf-ruby and set inf-ruby key definition in ruby-mode. 
> 
> (autoload 'run-ruby "inf-ruby"
>   "Run an inferior Ruby process")
> (autoload 'inf-ruby-keys "inf-ruby"
>   "Set local key defs for inf-ruby in ruby-mode")
> (add-hook 'ruby-mode-hook
>       '(lambda ()
>          (inf-ruby-keys)
> )) 
> ```

（可选）我还从[http://perso.tls.cena.fr/boubaker/distrib/mode-compile.el安装了](http://perso.tls.cena.fr/boubaker/distrib/mode-compile.el)*mode-compile.el*并在 .emacs 中进行了相应的编辑

> ```
> ; Install mode-compile
> (autoload 'mode-compile "mode-compile"
>    "Compile current buffer based on the major mode" t)
> (global-set-key "C-cc" 'mode-compile)
> (autoload 'mode-compile-kill "mode-compile"
>  "Kill compilation launched by `mode-compile'" t)
> (global-set-key "C-ck" 'mode-compile-kill) 
> ```

通过这些更改，Emacs 将自动将 .rb 文件识别为 ruby​​ 并进行语法高亮。然后使用和弦 \Cc\Cs (Control-c, release 然后 Control-s) irb 将在您的文件下方的框中开始，您可以使用 inf-ruby 定义的所有键：（\M 是 Meta Key这对于 Windows 意味着 Alt）

```
 "\C-c\C-b" 'ruby-send-block
  "\C-c\M-b" 'ruby-send-block-and-go
  "\C-c\C-x" 'ruby-send-definition
  "\C-c\M-x" 'ruby-send-definition-and-go
  "\C-c\C-r" 'ruby-send-region
  "\C-c\M-r" 'ruby-send-region-and-go
  "\C-c\C-z" 'switch-to-ruby
  "\C-c\C-l" 'ruby-load-file
  "\C-c\C-s" 'run-ruby 
```

如果您执行了可选步骤并安装了 mode-compile，您还可以使用 \C-cc 将当前文件发送到 ruby​​ 而不是 irb

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T10:28:57.450

我还没有使用过 DrScheme，但是 Netbeans 6.5 包含一个功能齐全的 IRB。你试过了吗？

# django - 在一个表格设计问题中显示多个相关的 Django 模型

> ID：536205
> 
> 赞同：3
> 
> 时间：2009-02-11T10:13:00.967
> 
> 标签：django, django-models

我正在努力设计 django 应用程序。给定以下模型：

```
class A(models.Model):
    name = models.CharField(max_length=255)

class B(models.Model):
    name = models.CharField(max_length=255)
    a = models.ForeignKey(A)

class C(models.Model):
    val = models.IntegerField()
    b = models.ForeignKey(B) 
```

我想要一个显示 HTML 表格的视图/模板，该表格在第一列中显示所有 A 对象，在第二列中显示所有引用 A 的 B 对象（按 A 分组），在最后一列中显示所有 val 的总和每个 B 引用的 C 对象。所有这些都带有每个 A 对象的总和。以下示例显示了我正在寻找的内容：

```
A1.name | B1.name [其中 FK 到 A1] | sum(C.val) [其中 FK 到 B1]
A1.name | B2.name [其中 FK 到 A1] | sum(C.val) [其中 FK 到 B2]
A1.name | 总计 | sum(C.val) [其中 FK 到 Bx（所有 B 具有 FK 到 A1]
A2.name | B3.name [其中 FK 到 A2] | sum(C.val) [其中 FK 到 B3]
A2.name | 总计 | sum(C.val) [其中 FK 到 Bx（所有具有 FK 到 A2 的 B]

```

谁能给我一个如何设计这样一个问题的建议（不幸的是，我的代码经常会变得一团糟）？

我应该用适当的方法扩展模型类吗？对视图中的整个表数据进行自定义查询？只需通过管理器获取所有对象并执行模板中的大部分操作？

感谢您的每一个回答。

问候，

卢克。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T10:56:55.837

如果您有该日期模型，那么您可以获取所有`b`s 然后将它们分组`a`并计算总金额。代码可能如下所示：

看法：

```
from django.utils.itercompat import groupby

def view(request):
   bs = B.objects.all().annotate(sum_of_c_val=Sum('c.val'))\
                       .select_related('a')
   b_by_a = [
            {
               'grouper': key,
               'list': list(val),
               'total': sum([b.sum_of_c_val for b in val])
            }
            for key, val in
            groupby(bs, lambda b: b.a)
   ]

   return render_to_response('tmpl.html', {'b_by_a': b_by_a}) 
```

和模板：

```
{% for b_group in b_by_a %}
  {% for b in b_group.list %}
    <tr>
        <td>{{b_group.grouper.name}}</td>
        <td>{{b.name}}</td>
        <td>{{b.sum_of_c_val}}</td>
    </tr>
  {% endfor %}
  <tr>
      <td>{{b_group.grouper.name}}</td>
      <td>Total</td>
      <td>{{b_group.total}}</td>
  </tr>
{% endfor %} 
```

**编辑：**

为了与 Django 1.0 兼容，您必须将`annotate`call替换为`extra`select 或 in-python 金额计算。

1.  使用子查询：

    ```
    bs = B.objects.all().extra(
        select={
          'sum_of_c_val': 'SELECT SUM(app_c.val) FROM app_c WHERE app_c.b_id=app_b.id'
        }).select_related('a')
    #... 
    ```

    Where `app`- 应用程序名称

2.  这个 in-python 计算：

    ```
     bs = B.objects.all().select_related('a')
     for b in bs:
         b.sum_of_c_val = sum(map(int, b.c.all().values_list("val", flat=True)))
     #... 
    ```

    但它会产生 N 个额外的查询（其中`N = len(bs)`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T10:37:57.567

免责声明：我自己是 Django 初学者，但如果我正确理解了它的基本概念，那么：

鉴于您想要的视图 - 正如您所说 - 只是底层数据的视图，那么您应该在视图模块中进行排序和分组。我认为您不应该弄乱模型（这只是数据），也不应该弄乱模板（这只是视图的布局）。

# java - Doubt in Java Service wrapper while running jar application fom window service

> ID：536211
> 
> 赞同：0
> 
> 时间：2009-02-11T10:14:59.073
> 
> 标签：java

I have a jar application which process and converts file into csv file. I have made it to run in windows service using Java Service Wrapper. It got installed my jar application successfully when I run "InstallApp-NT. Bat" file and starts running my application when I run "app" command.

But when I try to start the service in services, its not starting and showing following message in dialog box<

```
Windows could not start the generic Preprocessor application on Local Computer. For more information, review the System Event Log. If this is a non-microsoft service, contact the service vendor, and refer to service-specific error code1
I have the system log file and it showing the below error message
System Event log: 
--> Wrapper Started as Service
Java Service Wrapper Community Edition 3.3.2
Copyright (C) 1999-2009 Tanuki Software, Ltd. All Rights Reserved. 
http://wrapper.tanukisoftware.org
Launching a JVM... 
WrapperManager: Initializing... 
WrapperSimpleApp: 
WrapperSimpleApp: Encountered an error running main: 
WrapperSimpleApp: java. Lang. NullPointerException
WrapperSimpleApp: at java. Util. Hashtable. Put(Hashtable. Java: 396)
WrapperSimpleApp: at java. Util. Properties. SetProperty(Properties. Java: 128)
WrapperSimpleApp: at java. Lang. System. SetProperty(System. Java: 701)
WrapperSimpleApp: at com. Dnb. Genericpreprocessor. Process. ProcessRunner. Main(Unknown Source)
WrapperSimpleApp: at sun. Reflect. NativeMethodAccessorImpl. Invoke0(Native Method)
WrapperSimpleApp: at sun. Reflect. NativeMethodAccessorImpl. Invoke(NativeMethodAccessorImpl. Java: 39)
WrapperSimpleApp: at sun. Reflect. DelegatingMethodAccessorImpl. Invoke(DelegatingMethodAccessorImpl. Java: 25)          
WrapperSimpleApp: at java. Lang. Reflect. Method. Invoke(Method. Java: 585)
WrapperSimpleApp: at org. Tanukisoftware. Wrapper. WrapperSimpleApp. Run(WrapperSimpleApp. Java: 238)
WrapperSimpleApp: at java. Lang. Thread. Run(Thread. Java: 595)
<-- Wrapper Stopped 
```

I don't think any error in application code because it running fine when run "app" command. Please help what I should now. Thanks in advance.

* * *

I am using the following code in `com.dnb.genericpreprocessor.process.ProcessRunner` class.

```
String projectHome = "D:\BL";
System.setProperty("project.home", projectHome);
System.setProperty("log.home",System.getenv("DBE")); ---> DBE is the envirinment variable I created in user variables. 
```

When I run the application by giving app command... Its running the application by printing the environment value but showing the same error when I start it in service.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T15:56:48.207

回答您所说的[问题更新](https://stackoverflow.com/questions/536211/doubt-in-java-service-wrapper-while-running-jar-application-fom-window-service/536273#536273)作为答案，您需要确保该变量实际上是在您运行应用程序的特定环境中设置的。看来不是。实际上，为了避免`NullPointerException`，我会将您的代码修改为：

```
String loghome = System.getenv("DBE");
if (loghome == null) {
  // LOG A COMPLAINT that the environment variable is not set
  loghome = "some reasonable default value";
}
System.setProperty("log.home", loghome); 
```

因此，如果在错误的环境中执行，至少您的应用程序不会因钝 NPE 而失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T10:19:17.080

Check com.dnb.genericpreprocessor.process.ProcessRunner if that is your code and see what data you are setting in System property. NullPointer is telling that the key or the value you passed is Null.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T10:19:35.787

Check your wrapper.config; you need to have all the necessary jars in order, and each with their *own* index number (for some reason):

wrapper.java.classpath.*1*=../lib/wrapper.jar

wrapper.java.classpath.*2*=%JAVA_HOME%/lib/tools.jar

...

Just a first thought.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T10:20:02.213

I am not familiar with the proprietary solution you are using, but it seems you somehow configured it wrong.

Looks like some parameter the wrapper should have is null and is propagating all the way up until the system is trying to set it as property.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T03:37:23.083

也许你应该把你的“DBE”环境放在系统变量而不是用户变量中。Windows 服务以系统帐户启动。

# asp.net - 如何处理从“DBNull”类型到“String”类型的转换无效

> ID：536212
> 
> 赞同：8
> 
> 时间：2009-02-11T10:16:16.793
> 
> 标签：asp.net, dbnull

我需要一些关于如何处理以下内容的期望建议：- 我有一个数据字段 misc_text_2，它的类型为 varchar(25)，并且允许为 NULL。现在，如果我使用以下语法

```
<asp:Label ID="lblPrinter" runat="server"  Text='<%# iif(eval("misc_text_2") is dbnull.value, "", iif(eval("misc_text_2") like "NA", "None", iif(eval("misc_text_2") like "KP1", "Kitchen Printer 1", iif(eval("misc_text_2") like "KP2", "Kitchen Printer 2", iif(eval("misc_text_2") like "KP3", "Kitchen Printer 3", iif(eval("misc_text_2") like "BP1", "Bar Printer 1", iif(eval("misc_text_2") like "BP2", "Bar Printer 2", iif(eval("misc_text_2") like "BP3", "Bar Printer 3", Eval("misc_text_2")))))))))%>'></asp:Label> 
```

我不断收到错误异常详细信息：System.InvalidCastException：从“DBNull”类型到“String”类型的转换无效。

我知道我错过了什么，但什么...

提前致谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T10:23:42.703

您必须自己明确检查`DBNull.Value`并进行转换。

换句话说，考虑到，构建一个将为您进行转换的方法`DBNull.Value`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T10:30:44.013

不回答您的问题，但是：您应该真正创建一个代码背后的方法来进行转换。这将使代码更易于理解和调试，并使重用代码成为可能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-11T19:23:29.213

每次使用 Eval 时，都必须以某种方式填充惰性求值。为此，请替换以下每个实例：

`iif(eval("misc_text_2") like ...`

和

`iif(IsDbNull(eval("misc_text_2")) OrElse eval("misc_text_2") like ...`

这`OrElse`将阻止任何尝试将 DbNull 转换为布尔值。但是，从更基本的角度来看，bang 是最正确的。这一切都应该在代码隐藏中完成，可能在 ItemDataBound（或 RowDataBound）事件处理程序中。

**进一步反思...**

OP 也可能`Convert.ToString()`在他的代码中使用该方法，它将 DBNulls 转换为 String.Empty。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-22T21:20:16.330

由于我们有一个为 MS-Dynamics (Solomon) 设置的遗留数据库，我们处理空值的方法是在 ASP 或 VB.NET 代码中将它们转换为空字符串。IE

```
Trim$(misc_text_2 & " ") 
```

摆脱任何版本的 VB 的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-22T05:26:45.787

如果您使用的是数据集设计器，那么摆脱此错误的最简单方法是更改​​尊重列的属性。

NullValue 异常为“空”而不是“抛出异常”。

希望这会对大家有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-05T03:15:17.087

对于转换 DBNull 或 IsDBNull，您可以尝试以下方法：

1.  将 DBNull 转换为空字符串

    (DBNullObj).ToString

2.  创建一个 DBNull 转换器函数

    公共函数 ConvertDBNullToString(DBNullObj As Object) 作为字符串

    如果 IsDBNull(DBNullObj) 那么

    返回 ””

    万一

    返回 DBNullObj

    结束功能

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-01T17:04:02.300

正如 spiritUMTP 建议的那样，如果您使用的是数据集设计器，请将 DataColumn.NullValue 从“Throw exception”更改为“empty”或“Nothing”。我选择了后者，它解决了问题。我现在只检查 Nothing (If IsNothing(columnFax) then ...)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-11T10:21:41.723

您可以在 sql 查询中使用 isNull(misc_text_2, '') 来返回空字符串而不是 DBNull。

# c# - How to limit a generic type 's type arguments to a specific type besides using constraints?

> ID：536214
> 
> 赞同：3
> 
> 时间：2009-02-11T10:16:20.850
> 
> 标签：c#, generics

I need to specify that a Generic type should only accept enumerated types only in the closed type. Can anyone suggest a way to do this if contraints cannot work?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T10:30:44.777

您不能直接在 C# 中执行此操作 - 枚举类型不能用作约束。一种选择（蹩脚的）是使用类型初始化器（静态构造函数）在运行时进行检查。它会在运行时阻止它使用不适当的类型，但不会在编译时阻止它。

```
class Foo<T> where T : struct {
    static Foo() {
        if (!typeof(T).IsEnum) {
            throw new InvalidOperationException("Can only use enums");
        }
    }
    public static void Bar() { }
}
enum MyEnum { A, B, C }
static void Main() {
    Foo<MyEnum>.Bar(); // fine
    Foo<int>.Bar(); // error
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T10:20:23.477

Closest constraint is struct:

class C<E> where E : /* enum */ struct

If you need to make sure it is an enum use typeof ( E ).IsEnum

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T10:31:26.460

既然你说你不能使用约束，我想到的唯一其他解决方案是使用动态强制转换并在运行时检查结果。这与使用约束作为解决方案相去甚远。但是，您可以[在此处](http://www.codeproject.com/KB/cs/Constraints_in_Generics.aspx)找到可能有帮助的文章。

# java - 为什么使用 .war 文件部署时 getRealPath() 返回 null？

> ID：536228
> 
> 赞同：30
> 
> 时间：2009-02-11T10:21:14.300
> 
> 标签：java, xml, jsp, jakarta-ee

`getRealPath()`正在返回本地系统中的实际路径，但在使用`.war`文件部署时返回 null。

```
<%@ page import="java.io.*" %>
<%@ page contentType="text/html;charset=ISO-8859-1" %> 
<%
int iLf = 10;
char cLf = (char)iLf;
String a= application.getResource("/");
//String myfile = application.getRealPath("/")+ "generate.xml";
//String myfile = request.getContextPath()+"generate.xml";
//String myfile = request.getRealPath("/")+"generate.xml";

out.println(myfile);    
File outputFile = new File(myfile);
outputFile.createNewFile();
FileWriter outfile = new FileWriter(outputFile);
outfile.write(" <?xml version='1.0' encoding='UTF-8'?> "+cLf);
outfile.write(" <playlist version='1' xmlns = 'http://xspf.org/ns/0/' > " +cLf);
outfile.write(" <title>My Band Rocks Your Socks</title> "+cLf); 
outfile.write("<trackList>"+cLf); 
%>
 <%! String[] sports; %>
 <%
    sports = request.getParameterValues("sports");

    out.println("<html><body><h1>hello</h1></body></html>");

    if (sports != null)
    { 
         for (int i = 0; i < sports.length; i++)
         { 
              // outfile.writeln (sports[i]); 
              String total=sports[i];
              String[] sa=total.split("[,]");
              // String[] sub=new String();
              outfile.write("<track>"+cLf);
              for (int j=0;j<sa.length;j++)
              {
                // outfile.writeln(sa[j]);
                // outfile.writeln("sa["+j+"]="+sa[j]);
                if( j == 0)
                {
                     outfile.write("<location>" + sa[0] +"</location>"+cLf); 
                }
                else if (j == 1)
                     {
                        outfile.write("<image>" + sa[1] +"</image>"+cLf); 
                     }
                     else if( j==2)
                          {
                            outfile.write("<title>" + sa[2] +"</title>"+cLf);
                          }

               }// end of inner for loop()       
               outfile.write("</track>"+cLf);
         //outfile.writeln();
      }// end of outer for()
    } 
    //else outfile.writeln ("<b>none<b>");

  outfile.write(" </trackList> "+cLf);
  outfile.write(" </playlist> "+cLf);
  outfile.close();

  %>
<object type="application/x-shockwave-flash" width="400" height="170"
          data="xspf_player.swf?playlist_url=generate.xml">
          <param name="movie" value="xspf_player.swf?playlist_url=generate.xml" />

</object> 
```

任何人都可以为我提供替代方案吗？如果您也显示一些示例代码，那将非常有帮助。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-11T10:32:09.157

首先，不推荐使用[ServletRequest.getRealPath(String path)](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/ServletRequest.html#getRealPath(java.lang.String))。适当的替换是：

```
ServletContext context = session.getServletContext();
String realContextPath = context.getRealPath(request.getContextPath()); 
```

但是，[ServletContext.getRealPath(String path)](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/ServletContext.html#getRealPath(java.lang.String))状态的 API 文档：

> `null` “如果 servlet 容器由于任何原因（例如从 .war 存档中提供内容时）无法将虚拟路径转换为真实路径，则此方法返回。”

所以 API 正在履行它的合同！[但是，一切都不会丢失，因为您可以使用ServletContext](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/ServletContext.html)中定义的以下方法从 WAR 加载资源：

```
ServletContext context = session.getServletContext();
InputStream is = context.getResourceAsStream("generate.xml"); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-02-06T09:30:38.590

有点晚了，但是当我在 WebLogic 中遇到这个问题时，我遇到了这个问题。我的解决方案是将其添加到我的`weblogic.xml`：

```
<?xml version='1.0' encoding='UTF-8'?>
<weblogic-web-app>
    <container-descriptor>
        <show-archived-real-path-enabled>true</show-archived-real-path-enabled>
    </container-descriptor>
</weblogic-web-app> 
```

当您不想（或不能）编辑 WebLogic 服务器上的配置时，我发现此解决方案更好。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-21T08:19:45.217

你使用 Weblogic 吗？

如果是 - 那么这是一个 Weblogic 问题，您可以在 Weblogic 管理控制台 -> 域 -> Web 应用程序中修复它 - 单击复选框“已启用存档真实路径”。

见：[http ://ananthkannan.blogspot.com/2009/12/servletcontextgetrealpath-returns-null.html](http://ananthkannan.blogspot.com/2009/12/servletcontextgetrealpath-returns-null.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-18T14:15:24.230

这也解决了这个问题：

weblogic.xml

```
<?xml version = '1.0' encoding = 'windows-1252'?>
<weblogic-web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.bea.com/ns/weblogic/weblogic-web-app http://www.bea.com/ns/weblogic/weblogic-web-app/1.0/weblogic-web-app.xsd" xmlns="http://www.bea.com/ns/weblogic/weblogic-web-app">

<container-descriptor>
  <index-directory-enabled>true</index-directory-enabled>
  <show-archived-real-path-enabled>true</show-archived-real-path-enabled>
</container-descriptor>

<virtual-directory-mapping>
  <local-path>bla.war</local-path>
  <url-pattern>*</url-pattern>
</virtual-directory-mapping>

<context-root>bla</context-root> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-11T10:39:50.853

我不相信有可能做你想做的事。

您应该使用 getResource 从您的战争文件中读取 xml 文件（这也适用于没有战争）

```
servletContext.getResourceAsStream("/generate.xml") 
```

前导斜杠取决于 generate.xml 的存储位置。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-08-13T19:42:00.033

如果你想写入

利用

```
this.getClass().getResource("/").getPath(); 
```

获取路径

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-23T07:44:11.617

我也有同样的问题。部署到独立服务器时调用 getRealPath() 返回 null。搜索了一会，我找到了解决方案，它不在代码中。它在您的网络服务器的配置中。

对我来说它是 Weblogic 10.3，你去 Home - - Configuration - Web Application，将 Archived Real Path Enabled 设置为 true。重新启动服务器，一切正常。

希望这有帮助，问候。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-06-23T02:29:15.347

注意`context.getRealPath()`当用户权限问题时可以返回null，检查Web服务器在哪个用户下运行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-16T05:36:13.963

以下修复对我来说很好。

```
// I am using Struts2 
ServletContext sc = (ServletContext) ac.get(StrutsStatics.SERVLET_CONTEXT);
fileInputStream = sc.getResourceAsStream("test.xls"); 
```

部署war文件后，我可以从上下文路径中获取文件。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-12-14T11:22:42.543

以下解决了我的问题。

```
 public EHWInit()
  {
   String resetRootPath = ""; 

   try{
   resetRootPath = this.getClass().getResource("/").getPath();
      boolean isWinOS = System.getProperty("os.name").startsWith("Windows");
   if( isWinOS )
      {resetRootPath = resetRootPath.substring(1, resetRootPath.lastIndexOf("chucec"));}
   else
      {resetRootPath = resetRootPath.substring(0, resetRootPath.lastIndexOf("chucec"));}

   resetRootPath = resetRootPath.replace("%20", " ");
   System.out.println("EHWInit#75:resetRootPath=" + resetRootPath); 
```

当您尝试在操作系统为 Windows 时通过**this.getClass** **().getResource("/").getPath()**获取 getRealPath时，您可能会得到如下字符串：

```
EHWInit#73:getPath=/C:/Program%20Files%20(x86)/Apache%20Software%20Foundation/Tomcat%208.5/webapps/chucec/WEB-INF/classes/

```

因此，您需要对返回的字符串做一些额外的工作。此外，如果您想通过请求获取**getRealPath 。**您可以将代码替换如下：

```
 public void resetSystemPath(HttpServletRequest paramHttpServletRequest)
  {
    //String str = paramHttpServletRequest.getRealPath("/");

    HttpSession session = paramHttpServletRequest.getSession(true);
    String str = session.getServletContext().getRealPath("/");
    System.out.println("getRealPath:"+str); 
```

# c# - 学习谓词的资源

> ID：536230
> 
> 赞同：1
> 
> 时间：2009-02-11T10:21:17.187
> 
> 标签：c#, linq-to-sql, predicate

有没有什么好的在线教程来学习 c# 2.0 语言特性“谓词”？

我正在尝试学习如何使用谓词以及 linq to sql 来修改我的查询

我想做的是查询客户表并根据不断变化的标准对其进行过滤。例如

*   查找所有邮政编码 = 90210 的客户
*   查找所有男性客户
*   查找所有男性且 > 邮政编码 = 90210 的客户

现在我正在使用 if/else 语句来做这件事，感觉很不对劲

另外，我可能必须添加其他过滤器，所以我想要一个灵活的解决方案来解决这个问题，它很容易扩展而不会破坏任何东西（我认为开放封闭原则）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T12:24:13.070

谓词只是具有以下签名的方法：

```
bool Predicate<T>(T item) 
```

它表示可以由 T 类型的对象验证或不验证的条件。

它在链接中用于过滤`.Where`子句中的枚举。

您还可以使用返回布尔值的 lambda：

```
item => item.Nickname == "ThinkBeforeCoding"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T10:27:00.667

（顺便说一句 - 与 LINQ-to-SQL 一起使用的基于 lambda 的谓词是 C# 3.0 / .NET 3.5，而不是 C# 2.0）

好吧，你具体想做什么？

谓词只是过滤器（作为委托或表达式）；它们不允许您*直接*修改 TSQL 等，除非您将它们与 LINQ-to-SQL 提供程序可以处理的函数（[这些](http://msdn.microsoft.com/en-us/library/bb386970.aspx)）或映射到您的数据上下文的 UDF 作为可组合函数（`FunctionAttribute`）。

最简单的：

男性且 > 邮政编码 = 90210

```
var qry1 = from cust in ctx.Customers
          where cust.Gender == 'M' && cust.Zip = '90210'
          select cust;

var qry2 = from cust in ctx.Customers
          where cust.Zip = '90210'
          select cust; 
```

或者对于一个不平凡的例子（动态搜索表单/单独组合）

```
IQueryable<Foo> query = ctx.Customers;
// note "gender" here is "char?" for this example
if(gender != null) query = query.Where(x=>x.Gender == (char)gender);
if(zip != null) query = query.Where(x=>x.Zip == zip); 
```

ETC

您也可以手动构建基于表达式的谓词，但这需要更多的工作，并且需要[Expression API](http://marcgravell.blogspot.com/2008/10/express-yourself.html)的知识。

# asp.net - RegularExpressionValidator Expression needed

> ID：536232
> 
> 赞同：0
> 
> 时间：2009-02-11T10:21:58.743
> 
> 标签：asp.net, regex, validation

i am using asp.net 3.5 and VB.net, i need a validation expression to validate a string of 1 to 50 characters, white spaces, numbers, special character are all allowed, simply, it should match an nvarchar(50) database field. it will be applied to a textbox, also, the same case but for 1-200 characters which will be validating a multi-line textbox..

Thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T10:28:01.943

Do you mean that it just needs to ensure that there are between 1 and 50/200 characters in the strings?

If so, try these:

```
^[\s\S]{1,50}$
^[\s\S]{1,200}$ 
```

Testing for `[\s\S]` rather than `[.]` ensures that any newlines in the multiline textarea don't cause problems.

# actionscript-3 - 自定义 flash.display.textfield 类（源）

> ID：536253
> 
> 赞同：0
> 
> 时间：2009-02-11T10:30:26.027
> 
> 标签：actionscript-3, flex3

是否可以在某处获得源代码只是为了对 textfield 类进行一些小修复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T11:30:51.123

您应该扩展 Textfield 类。覆盖您想要更改的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T11:40:39.883

如前所述，内部 flash.* 类的源不可用。要修改或添加行为，您需要继承 TextField。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T11:09:03.000

Flex 是基于 Flash 构建的开源 SDK，因此在 SDK 中查找相关源文件并应用修复应该不是问题。

但它可能更简单：

1.  从外部应用修复程序。例如，通过从类派生和覆盖。
2.  向 SDK 人员打开一个错误并要求他们修复它（也就是说，如果它不是紧急的严重错误）。

如果您最终在 SDK 中修复它，请考虑将您的修复发布回社区。

# sql - 棘手的活动记录关系 - 多态双向自引用

> ID：536261
> 
> 赞同：8
> 
> 时间：2009-02-11T10:32:09.687
> 
> 标签：sql, ruby-on-rails, activerecord

您将如何对出版物（文章、书籍、章节等）的参考和引用进行建模？

出版物可以是一篇文章、一本书或一章，它有许多对其他出版物的引用，其他出版物也引用它（称为这些引文）

我需要能够列出出版物之间的关系：出版物中的引用以及其他出版物对该出版物的引用

我最初的理解是，这将是一种处理不同类型出版物的多态关系，并且需要双向自连接。

我的刺

```
Publication
belongs_to :writing, :polymorphic =>true
has_and_belongs_to_many :references 
   :class_name => "Publication"
   :join_table => 'reference_citation' 
   :foreign_key => 'reference_id'
   :foreign_key => 'citation_id'

Book,    Chapter,    Article all have:
has_many :publications :as =>writing 
```

我觉得这有点令人困惑，所以任何有助于澄清它的建议都会很棒。甚至对象和字段命名建议。

[[我在这里](https://stackoverflow.com/questions/499934/how-would-you-model-articles-with-references-and-citations-in-rails-activerecord)问了这个问题的不太清楚的版本。]

我也可能需要使用has many through 因为我需要破坏关系的能力

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-15T14:31:04.123

这是使用单表继承的自引用关系的解决方案。使用这些命令来创建应用程序：

```
$ rails myproject
$ cd myproject
$ script/generate model publication type:string name:string
$ script/generate model citation publication_id:integer reference_id:integer 
```

以这种方式设置关系：

```
class Publication < ActiveRecord::Base
  has_many :citations
  has_many :cited_publications, :through => :citations, :source => :reference
  has_many :references, :foreign_key => "reference_id", :class_name => "Citation"
  has_many :refered_publications, :through => :references, :source => :publication
end

class Citation < ActiveRecord::Base
  belongs_to :publication
  belongs_to :reference, :class_name => "Publication"
end

class Article < Publication
end

class Book < Publication
end

class Chapter < Publication
end 
```

现在我们可以创建数据库并从控制台试用它：

```
$ rake db:migrate
$ script/console 
Loading development environment (Rails 2.2.2)
>> a = Article.create!(:name => "Article")
=> #<Article id: 1, ...>
>> b = Book.create!(:name => "Book")
=> #<Book id: 2, ...>
>> a.citations.create(:reference => b)
=> #<Citation id: 1, publication_id: 1, reference_id: 2, created_at: "2009-02-15 14:13:15", updated_at: "2009-02-15 14:13:15">
>> a.citations
=> [#<Citation id: 1, ...>]
>> a.references
=> []
>> b.citations
=> []
>> b.references
=> [#<Citation id: 1, publication_id: 1, reference_id: 2, created_at: "2009-02-15 14:13:15", updated_at: "2009-02-15 14:13:15">]    
>> a.cited_publications
=> [#<Book id: 2, type: "Book", name: "Book", created_at: "2009-02-15 14:11:00", updated_at: "2009-02-15 14:11:00">]
>> a.refered_publications
=> []
>> b.cited_publications
=> []
>> b.refered_publications
=> [#<Article id: 1, type: "Article", name: "Article", created_at: "2009-02-15 14:10:51", updated_at: "2009-02-15 14:10:51">] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T13:50:05.763

这是一个不对出版物使用单表继承的解决方案。这意味着有文章、书籍和章节表，而不是一个出版物表。以下是运行以创建应用程序的命令：

```
$ rails myproject
$ cd myproject
$ script/generate model book name:string
$ script/generate model chapter name:string
$ script/generate model article name:string
$ script/generate model citation publication_type:string publication_id:integer reference_type:string reference_id:integer 
```

在以下位置创建此文件`lib/acts_as_publication.rb`：

```
module ActsAsPublication
  def self.included(base)
    base.extend(ClassMethods)
  end
  module ClassMethods
    def acts_as_publication
      has_many :citations, :as => :publication
      has_many :references, :as => :reference, :class_name => "Citation"      
    end
  end
end 
```

在以下位置创建此文件`config/initializers/acts_as_publication.rb`：

```
ActiveRecord::Base.send(:include, ActsAsPublication) 
```

然后在每个模型、文章、书籍和章节中调用它，如下所示：

```
class Article < ActiveRecord::Base
  acts_as_publication
end 
```

然后将这些关系添加到`app/models/citation.rb`：

```
class Citation < ActiveRecord::Base
  belongs_to :publication, :polymorphic => true
  belongs_to :reference, :polymorphic => true
end 
```

现在我们可以创建数据库并从控制台试用它：

```
$ rake db:migrate
$ script/console 
Loading development environment (Rails 2.2.2)
>> a = Article.create!(:name => "a")
=> #<Article id: 1, ...>
>> b = Article.create!(:name => "b")
=> #<Article id: 2, ...>
>> Citation.create!(:publication => a, :reference => b)
=> #<Citation id: 1, publication_type: "Article", publication_id: 1, reference_type: "Article", reference_id: 2, created_at: "2009-02-15 13:14:27", updated_at: "2009-02-15 13:14:27">
>> a.citations
=> [#<Citation id: 1, ...>]
>> a.references
=> []
>> b.citations
=> []
>> b.references
=> [#<Citation id: 1, ...>]
>> Book.create!(:name => "foo")
=> #<Book id: 1, name: "foo", created_at: "2009-02-15 13:18:23", updated_at: "2009-02-15 13:18:23">
>> a.citations.create(:reference => Book.first)
=> #<Citation id: 2, publication_type: "Article", publication_id: 1, reference_type: "Book", reference_id: 1, created_at: "2009-02-15 13:18:52", updated_at: "2009-02-15 13:18:52">
>> Book.first.references
=> [#<Citation id: 2, ...>]
>> a.citations
=> [#<Citation id: 1, publication_type: "Article", publication_id: 1, reference_type: "Article", reference_id: 2, created_at: "2009-02-15 13:14:27", updated_at: "2009-02-15 13:14:27">, #<Citation id: 2, publication_type: "Article", publication_id: 1, reference_type: "Book", reference_id: 1, created_at: "2009-02-15 13:18:52", updated_at: "2009-02-15 13:18:52">] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T15:36:06.900

我在[http://github.com/francois/so-536261/tree/master有一个不完整的答案](http://github.com/francois/so-536261/tree/master)

基本上，数据库模式确实支持您的用例，但 ActiveRecord 不支持。该解决方案可能涉及使用通过 sql 查找或其他技巧。

# java - Java / C# 中的 C++ 切片

> ID：536267
> 
> 赞同：5
> 
> 时间：2009-02-11T10:36:11.533
> 
> 标签：java, c#, c++, object-slicing

C++ 切片是否也适用于其他语言，例如 Java/C#？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T10:42:32.580

切片意味着如果将子类实例分配给超类变量，则子类包含的额外信息将被“切片”掉，因为超类变量没有额外的空间来存储子类的这些额外信息。

这在 Java 和 C# 中都不会发生，因为所有对象变量都是引用；当您将子类实例分配给超类变量时，实际上只是复制了引用；子类对象本身保持不变。

# iphone - 在 iphone 上搜索文件内容

> ID：536270
> 
> 赞同：1
> 
> 时间：2009-02-11T10:36:52.327
> 
> 标签：iphone, search

是否有用于搜索资源文件的 Iphone SDK API？

我有一组 html 文件资源，我希望用户能够在其中搜索，但我想避免将文件读入内存并逐个搜索它们。

是否有任何 API 可以帮助我做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T13:23:52.007

不，您必须阅读文件才能搜索它们。手机上没有像“Spotlight”这样的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-30T10:04:01.277

我建议您使用 SQLite FTS3 扩展来对您的文档进行全文搜索。它有很好的能力。但是你需要先去除 HTML 标签，这样它就可以只索引你的文本，而不用担心标签

# c++ - AddRef 和函数签名

> ID：536281
> 
> 赞同：1
> 
> 时间：2009-02-11T10:40:24.067
> 
> 标签：c++, coding-style, refcounting

我一直使用以下规则来签名函数的签名，这些函数根据它们是否执行 AddRef 来返回引用计数的对象，但也想向我的同事解释它......所以我的问题是，下面描述的规则是广泛遵循的规则？我正在寻找（例如）倡导这种风格的编码规则的指针。

* * *

如果函数没有添加对对象的引用，则应将其作为函数的返回值返回：

```
class MyClass
{
protected:
    IUnknown *getObj() { return m_obj; }
private:
    IUnknown *m_obj;
}; 
```

但是，如果函数添加对对象的引用，则对象的指针作为参数传递给函数：

```
class MyClass
{
public:
    void getObj(IUnknown **outObj) { *outObj = m_obj; (*outObj)->AddRef(); }
private:
    IUnknown *m_obj;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T10:59:34.537

在创建新对象并且调用者必须拥有它的情况下，使用引用计数智能指针更为典型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T11:40:11.833

我在有很多 COM 的项目中使用了相同的样式。有几个人在 NuMega 开发一个叫做 SoftICE 的小东西时学会了它。我认为这也是 Don Box 所著的“Essential COM”一书中所教授的风格（[这里是亚马逊](https://rads.stackoverflow.com/amzn/click/com/0201634465)）。这本书曾一度被认为是 COM 的圣经。我认为情况并非如此的唯一原因是 COM 已不仅仅是 COM。

尽管如此，我更喜欢 CComPtr 和其他智能指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T11:42:27.397

一种方法是从不使用函数的返回值。仅使用输出参数，如第二种情况。无论如何，这在已发布的 COM 接口中已经是一条规则。

这是一个“官方”参考，但通常情况下，它甚至没有提到你的第一个案例：http: [//support.microsoft.com/kb/104138](http://support.microsoft.com/kb/104138)

但是在组件内部，禁止返回值会使代码变得丑陋。具有可组合性要好得多 - 即方便地将函数组合在一起，将一个函数的返回值直接作为参数传递给另一个函数。

智能指针允许您这样做。它们在公共 COM 接口中被禁止，但非 HRESULT 返回值也是如此。因此，您的问题就消失了。如果要使用返回值来传回接口指针，请通过智能指针进行。并将成员存储在智能指针中。

但是，假设由于某种原因您不想使用智能指针（顺便说一句，您疯了！）那么我可以告诉您您的推理是正确的。您的函数充当“属性获取器”，在您的第一个示例中它不应该`AddRef`。

所以你的规则是正确的（尽管你的实现中有一个错误，我会在一秒钟内找到它，因为你可能没有发现它。）

这个函数需要一个对象：

```
void Foo(IUnknown *obj); 
```

它根本不需要影响`obj`的引用计数，除非它想将它存储在成员变量中。在它返回之前调用它当然**不应该是 Foo 的责任！**想象一下会造成的混乱。`Release``obj`

现在这个函数返回一个对象：

```
IUnknown *Bar(); 
```

我们经常喜欢组合函数，将一个函数的输出直接传递给另一个函数：

```
Foo(Bar()); 
```

`Bar`如果增加了它返回的任何内容的引用计数，这将不起作用。谁`Release`去呢？所以`Bar`不叫`AddRef`。这意味着它正在返回它存储和管理的东西，即它实际上是一个属性获取器。

此外，如果调用者使用智能指针，则`p`：

```
p = Bar(); 
```

`AddRef`当它被分配一个对象时，任何理智的智能指针都会指向它。如果`Bar`还`AddRef`-ed 好，我们又泄露了一个计数。这实际上只是同一个可组合性问题的一个特例。

输出参数（指针到指针）是不同的，因为它们不受可组合性问题的影响以相同的方式：

同样，智能指针提供了最常见的情况，使用您的第二个示例：

```
myClass.getObj(&p); 
```

智能指针不会在这里进行任何引用计数，所以`getObj`必须这样做。

现在我们来看看这个错误。假设`p`当您将智能指针传递给`getObj`...

更正的版本是：

```
void getObj(IUnknown **outObj) 
{
    if (*outObj != 0)
        (*outObj)->Release();

    *outObj = m_obj;
    (*outObj)->AddRef();  // might want to check for 0 here also
} 
```

在实践中，人们经常犯这个错误，以至于我发现让我的智能指针断言`operator&`当它已经有一个对象时调用它更简单。

# asp.net - jquery getJson没有将任何值传递给控制器

> ID：536283
> 
> 赞同：8
> 
> 时间：2009-02-11T10:41:00.430
> 
> 标签：asp.net, jquery, asp.net-mvc, json

我正在尝试将一些文本从文本框传递到控制器以获得 JSON 结果，如下所示

```
function invokeAction() {
        var searchText = $("#SearchTextBox").val();

        // Invoke MVC controller action
        $.getJSON("/Home/Results/" + searchText, bindResults);
    } 
```

如果我在这里发出警报，我可以看到 searchText 肯定有一个值，但是当我在这个控制器操作上放置一个断点时：

```
 public ActionResult Results(string search)
    {
        var r = from t in db.Restaurants
                where SqlMethods.Like(t.Name, "%" + search + "%") || SqlMethods.Like(t.Postcode, search + "%") || SqlMethods.Like(t.CuisineType.Type, search + "%")
                orderby t.Name ascending
                orderby t.Rating descending
                orderby t.NumOfViews
                    descending
                select t;

        return Json(r.ToList());
    } 
```

传入的字符串为空，但是当我在调试器中检查 http 上下文时，我的 searchtext 是 url 的一部分。

由于这是 null，因此查询不返回任何结果。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-11T19:15:59.787

我在从服务返回 json 时遇到了一些问题，但我没有收到任何回电。事实证明，json 格式不正确，我能够通过处理普通 ajax 调用的错误选项对其进行测试并获取这些错误。

```
$.ajax({
  type: "GET",
  url: "Home/Results/",
  data: { search: searchText },
  dataType: "json",
  error: function(xhr, status, error) {
    // you may need to handle me if the json is invalid
    // this is the ajax object
  },
  success: function(json){
    alert( "Data Returned: " + json);
  }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T14:16:42.783

您必须修复您的路线并将 {id} 替换为 {search} 以使其绑定到正确的参数 - 尝试如下操作：

```
routes.MapRoute("search", "Home/Results/{search}", 
  new { controller = "Home", action = "Results" }); 
```

如果您不想这样做，可以通过将参数名指定为标准查询字符串参数来执行此操作

```
$.getJSON("/Home/Results?search=" + searchText,bindresults); 
```

这将修复绑定。

# database-performance - 慢查询/禁用高速缓存 - Sybase Adaptive Server

> ID：536299
> 
> 赞同：1
> 
> 时间：2009-02-11T10:45:17.660
> 
> 标签：database-performance, sqlanywhere

在客户端数据库的 Sybase v10 上，此查询似乎运行得非常慢（400 万条记录需要 25 秒！）：

```
Select max(tnr) from myTable; 
```

以 tnr 为主键。

但是，如果我在我们的服务器上以 1000 倍的速度运行它，它似乎运行得很快（15 毫秒……），这让我认为这是因为查询结果被缓存了。有没有办法在 Sybase 中禁用此查询（或整个数据库）的缓存以重现此问题？

我试过了：

```
call sa_flush_cache ();
call sa_flush_statistics (); 
```

但似乎没有奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T12:30:40.813

不幸的是，dbcc cacheremove 不起作用，因为它不会从缓存中清除页面，而是删除描述符并将其放回空闲链上。

除了重新启动数据服务器之外，唯一的方法是将对象绑定到缓存，然后进行测试，然后取消绑定将从缓存中删除所有页面的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T23:29:29.240

尝试`dbcc cacheremove`

# user-interface - 可感知的最短应用程序响应延迟是多少？

> ID：536300
> 
> 赞同：78
> 
> 时间：2009-02-11T10:46:24.303
> 
> 标签：user-interface, response-time, perception

在用户操作和应用程序响应之间总是会出现延迟。

众所周知，响应延迟越低，应用程序瞬间响应的感觉就越大。众所周知，长达 100 毫秒的延迟通常是不可察觉的。但是 110 毫秒的延迟呢？

可以感知的最短应用程序响应延迟是多少？

我对任何确凿的证据、一般的想法和意见感兴趣。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2010-03-30T19:03:59.123

100 毫秒的阈值是在 30 多年前建立的。看：

Card, SK, Robertson, GG 和 Mackinlay, JD (1991)。信息可视化器：信息工作空间。过程。ACM CHI'91 会议。（路易斯安那州新奥尔良，4 月 28 日至 5 月 2 日），181-188。

米勒，RB（1968 年）。人机对话事务中的响应时间。过程。AFIPS 秋季联合计算机会议卷。33, 267-277。

迈尔斯，文学士（1985 年）。计算机人机界面完成百分比进度指标的重要性。过程。ACM CHI'85 会议。（加利福尼亚州旧金山，4 月 14-18 日），11-17。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-11T23:52:20.980

我记得学到的是，任何超过 1/10 秒 (100 毫秒) 的延迟都会在输入字母后开始对工作效率产生负面影响（例如，您本能地放慢速度，不太确定您是否输入正确），但低于该水平的延迟生产力基本持平。

鉴于该描述，小于 100 毫秒的延迟可能会被*认为*不是瞬时的（例如，训练有素的棒球裁判可能会比 100 毫秒更接近地解决两个事件的顺序），但它足够快，可以考虑就对生产力的影响而言，立即响应反馈。100ms 和更大的延迟是绝对*可以感知*的，即使它仍然相当快。

这是针对已收到特定输入的视觉反馈。然后在请求的操作中会有一个响应标准。如果您单击表单按钮，在 100 毫秒内获得该单击的视觉反馈（例如，按钮显示“沮丧”的外观）仍然是理想的，但在那之后您预计会发生其他事情。如果在一两秒钟内没有发生任何事情，正如其他人所说，你真的想知道它是点击还是忽略它，因此当操作可能需要超过一秒钟时显示某种“工作......”指示器的标准在显示清晰效果之前（例如，等待新窗口弹出）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-11-07T16:54:18.713

我不认为轶事或意见对这里的答案真的有效。这个问题涉及到用户体验和潜意识的心理学。人脑功能强大且速度快，只需几毫秒即可计算和记录。我不是专家，但我知道背后有很多科学依据，例如 Matt Jacobsen 提到的。在此处查看 Google 的研究[http://services.google.com/fh/files/blogs/google_delayexp.pdf](http://services.google.com/fh/files/blogs/google_delayexp.pdf)了解它对网站流量的影响程度。

这是 Akami 的另一项研究 - 2 秒响应时间 [http://www.akamai.com/html/about/press/releases/2009/press_091409.html](http://www.akamai.com/html/about/press/releases/2009/press_091409.html)（来自[https://ux.stackexchange.com/questions/5529/once -apon-a-time-there-was-a-10-seconds-to-load-a-page-rule-what-is-it-nowa](https://ux.stackexchange.com/questions/5529/once-apon-a-time-there-was-a-10-seconds-to-load-a-page-rule-what-is-it-nowa) )

有人有其他研究可以分享吗？

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-07-23T21:34:01.283

截至 2014 年 1 月的新研究：

[http://newsoffice.mit.edu/2014/in-the-blink-of-an-eye-0116](http://newsoffice.mit.edu/2014/in-the-blink-of-an-eye-0116)

> ...来自麻省理工学院的一组神经科学家发现，人脑可以处理眼睛看到的整个图像只需 13 毫秒...这个速度远远快于先前研究建议的 100 毫秒...

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-09-26T04:49:30.697

在旧金山歌剧院，我们定期为每个扬声器设置精确的延迟设置。我们可以检测到扬声器延迟时间的 5 毫秒变化。当你做出如此细微的改变时，你改变了声音的来源。很多时候，我们希望声音听起来像是来自扬声器以外的其他地方。精确的延迟调整使这成为可能。即使对于未经训练的耳朵来说，15 毫秒的声音延迟也是非常明显的，因为它从根本上改变了声源的位置。一个简单的测试是证明这是通过多个扬声器播放声音，并让对象闭上眼睛并指向声音的来源。现在稍微改变一个扬声器的延迟时间，只需几毫秒，然后让该人再次指向声音的来源。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-11T10:56:41.703

视觉持续时间在 100ms 左右，因此应该是一个合理的视觉反馈延迟。110ms 应该没有区别，因为它是一个近似值。在实践中，您不会注意到低于 200 毫秒的延迟。

根据我的记忆，研究表明，用户在大约 2 秒不活动（在没有反馈的情况下）后会失去耐心并重试操作，例如单击确认或操作按钮。因此，如果动作时间超过 1 秒，请计划使用某种动画。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-11T10:56:46.727

我开发了一个应用程序，其明确的业务目标是超快，我们有一个最大允许的服务器时间为 150 毫秒来处理一个完整的网页。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-11T10:54:02.723

没有确凿的证据，但对于我们自己的应用程序，我们在用户操作和反馈之间最多允许一秒钟。如果确实需要更长的时间，则应显示“等待箱”。

用户应该在引起动作的一秒钟内看到“某事”发生。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-10-11T19:23:20.197

我是一名研究视觉感知和认知的认知神经科学家。

上面提到的 Mary Potter的[论文涉及对视觉刺激进行分类所需的最短时间。](https://www.researchgate.net/publication/259490307_Detecting_meaning_in_RSVP_at_13_ms_per_picture)但是，请理解这是在没有任何其他视觉刺激的实验室条件下，在现实世界的用户体验中肯定不会出现这种情况。

刺激-响应/输入-刺激交互的典型基准，即个人最小反应速度或输入-响应检测的平均时间量约为 200 毫秒。为了确定没有可检测到的差异，这个阈值可以降低到 100 毫秒左右。低于这个阈值，你的认知过程的时间动态计算事件比事件本身需要更长的时间，因此几乎没有任何能力检测或区分它。您可以降低到 50 毫秒，但这确实没有必要。10 毫秒，你就进入了矫枉过正的境地。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-07-22T05:21:02.880

100ms 是完全错误的。您可以用手指、桌子和带有可见秒针的手表自己证明这一点。与手表的秒针同步，在桌子上连续敲出节拍，每秒敲出 16 个节拍。我选择 16 是因为它很自然地会敲出 2 的倍数，所以这就像四个强拍中间有三个弱拍。相邻节拍的声音清晰可辨。节拍间隔约 60 毫秒，因此即使 60 毫秒实际上仍然太高。因此阈值远低于 100 毫秒，尤其是在涉及声音的情况下。

例如，鼓应用程序或键盘应用程序需要大约 30 毫秒的延迟，否则它会变得非常烦人，因为您会在声音从扬声器中发出之前就听到来自物理按钮/打击垫/键的声音。像 ASIO 和 jack 这样的软件是专门为解决这个问题而开发的，所以没有任何借口。如果你的鼓应用程序有 100 毫秒的延迟，我会恨你的。

VoIP 和高功率游戏的情况实际上更糟，因为您需要实时对事件做出反应，而在音乐方面，至少您至少可以提前计划一点。对于 200 毫秒的平均人类反应时间，再延迟 100 毫秒是一个巨大的损失。它显着改变了 VoIP 的会话流程。在游戏中，200 毫秒的反应时间已经足够了，尤其是在玩家进行大量练习的情况下。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-11-30T16:15:39.900

对于一篇相当最新的学术文章，请尝试[“快多少才够快？” 用户对直接和间接触摸中延迟和延迟改进的感知](http://www.tactuallabs.com/papers/howMuchFasterIsFastEnoughCHI15.pdf)(PDF)。虽然主要关注延迟的 JND（Just Noticeable Difference），但在绝对延迟感知方面有一些很好的背景，他们在第二个实验中也承认并考虑了 60Hz 监视器（16.7 ms 重绘时间）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-03-29T14:09:14.390

对视觉空间分辨率使用双重测试（两个平行的黑条，宽度相等，它们之间的间隙相等。减少对向角直到它们看起来是一条线，即按比例缩小或简单地移开。点它似乎合并成一行显示阈值）。

使用功能 gen 使 LED 闪烁一段时间，然后关闭，然后打开，然后关闭 --- 每个间隔相同的时间延迟，但在逐渐减少延迟的同时重复该模式，因此与上述相同，但时间代替空间. 想象一下这样的示波器图像：

```
_________/^d^\_d_/^d^\_________ 
```

我注意到，在 41 毫秒的间隔，我只感觉到一次较长的眨眼，但在 42 毫秒，我只感觉到它非常快速的两次眨眼。因此，阈值约为 42 毫秒。可能因人，年龄，状况等而异。

这接近 24 fps，这可能就是电影以这种呈现速度运行的原因。

看到某些东西的反应时间，然后决定做出反应，比如点击鼠标等，又要长得多了。因此，需要反应响应来测量的实验产生更长的时间也就不足为奇了，但更长的延迟并不是您所要求的，上述实验既简单又富有启发性！

但也要注意——平滑移动的动画需要视觉皮层更加努力地工作，从而延迟视觉理解。这种延迟是“隐藏”的，因此可以通过提供一些因移动而难以看到的东西来“隐藏”更长的延迟（几百毫秒）。

隐藏它的效果称为[Chronostasis](https://en.wikipedia.org/wiki/Chronostasis)。基本上，看一眼“新”的地方需要视觉皮层更加努力地“去渲染”/“识别”场景。这需要相当长的时间，在此期间你的意识基本上是“暂停”的。

一旦看到一个基本不变的场景，只有变化需要这种处理，所以更小/更快的变化是可能的，你的感知体验会恢复，更快/更小的运动是可以检测到的。

视觉上的变化检测基本上是在你的视网膜上进行的。你的眼睛也有一种自然的“带通”反应——在足够长的时间内不眨眼地盯着任何东西，并且在足够的距离上扫视无法改变图像，你会发现你的视觉馈送逐渐消失为“灰色”。这就是我们的“白平衡”，有点类似于模拟收音机/电视上的自动增益控制。

关键是，你的眼睛本身有反应的时间常数，但这实际上取决于刺激的强度。（对于我们来说，LED 的亮度）。

太亮了，你的视网膜细胞从亮度中“放松”回来的能力，即对“突然变暗”的反应，会受到损害。

在光线停止后让你看到明亮事物的效果被称为“视觉暂留”，旧的阴极射线显像管或多或少在很大程度上依赖它才能工作。

这通常是 100 毫秒左右，但它不是一个“尖锐”的间隔——更像是一个指数滚降，再次——根据刺激的亮度相对于暗调整的程度而改变持续时间（即，敏感）眼睛在那一刻。

对于更迟钝、更快的变化，尤其是中央凹外的变化，您会更容易察觉到更高的变化率。例如，闪烁的灯光。你视网膜的那些外部部分（实际上是大部分区域）适合于检测运动，并引起你的注意。因此，尽管缺乏空间分辨率，但它们具有更高的时间分辨率/更短的响应率是有道理的。

但这也意味着动画通常需要更精细的时间步长，否则“跳跃”是可察觉的，主要是由于更快的响应。

请注意 iOS 使用的所有缩放/滑动全屏动画——这些动画本质上是利用 chronostasis 来隐藏技术上不可避免的加载延迟，给人一种感觉，即这些产品在任何时候都可以立即流畅地响应。

因此，在 42 毫秒内显示不同的内容 -> 即时响应。继续以高帧速率连续制作原本无用的难以正确看到的视觉效果，然后在完成后突然停止 -> 只要视觉上足够繁忙，就隐藏延迟，并且延迟不会太长。（大概 250ms 正在推动友谊）。

这似乎也与其他人对输入滞后的看法相吻合，例如：[http ://danluu.com/input-lag/](http://danluu.com/input-lag/)

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-02-11T10:54:22.940

对于 Web 应用程序，200 毫秒被认为是不明显的延迟，而 500 毫秒是可以接受的。

# namespaces - 在命名空间声明之后立即添加“使用命名空间”是否可以接受？

> ID：536301
> 
> 赞同：1
> 
> 时间：2009-02-11T10:47:50.790
> 
> 标签：namespaces, c++-cli, typedef, using-statement

我有一个包含一些类型定义的小命名空间，我用它来使我的代码看起来更干净。但是，我不想为每个使用其中一种类型的文件添加“使用命名空间...”行，毕竟我已经为文件添加了#include。

* * *

*我的文件.cpp：*

```
#include "typedefs.h"
void Bob()
{
    IntList^ list = gcnew IntList;
} 
```

* * *

*typedefs.h：*

```
namespace Typedefs
{
    typedef List<int> IntList;
    typedef array<int> IntArray;
    typedef List<Byte> ByteList;
    typedef array<Byte> ByteArray;
    typedef List<String^> StringList;
    typedef array<String^> StringArray;
}
using namespace Typedefs; 
```

* * *

在命名空间声明之后立即添加“使用命名空间”行是否可以接受？如果不是，为什么不呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T10:54:45.017

这是可能的，但我认为这不明智。它只是通过将其内容暴露在任何地方而破坏了命名空间的全部目的。如果您想要不必指定`Typedefs::`or的舒适感，`using Typedefs::xxx;`或者`using namespace Typedefs;`我根本就不会创建命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T10:59:01.930

使用未命名的命名空间。如果您想让名称仅对包含标题的文件可见

```
namespace {
  int i = 10;
} 
```

上面的效果与下面的代码相同

```
namespace randomName {
  int i = 10;
}
using randomName; 
```

因此任何其他文件都无法访问任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T10:57:04.340

放置一个“使用命名空间 XXX;” 头文件中的指令通常被认为是一个坏主意，因为它确实破坏了首先拥有命名空间的想法。它很容易导致命名空间的引入应该避免的那种命名冲突。

我的建议 - 不要这样做，如有必要，请将它们粘贴到适当的源文件 (.cpp) 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T10:56:46.803

您不妨在任何命名空间之外定义您的新类型，还是我遗漏了什么？

# ruby-on-rails - 在 Ruby on Rails 中查找未使用的视图/部分

> ID：536307
> 
> 赞同：16
> 
> 时间：2009-02-11T10:51:44.337
> 
> 标签：ruby-on-rails, ruby

我目前正在开发一个大型 Rub​​y on Rails 项目。它足够老和足够大，不清楚是否所有视图都在实际使用中。

是否有任何脚本/插件可以生成未使用的视图文件列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T16:35:52.340

我写了一个脚本来查找未使用的部分/视图。不过，我假设“未使用”意味着存在一个没有定义控制器方法的视图文件（不再）。该脚本不会检查视图是否被调用，因为没有从默认路由到它的链接。这会复杂得多。

将以下脚本放在应用程序的脚本文件夹中：

```
#!/usr/bin/env ruby
require 'config/environment'
(Dir['app/controllers/*.rb'] - ['app/controllers/application.rb']).each do |c|
  require c
  base = File.basename(c, '.rb')
  views = Hash.new
  Dir["app/views/#{base.split('_')[0]}/*"].each do |v|
    views.store(File.basename(v).split('.')[0], v)
  end
  unused_views = views.keys - Object.const_get(base.camelcase).public_instance_methods - ApplicationController.public_instance_methods
  puts "Unused views for #{base.camelcase}:" if unused_views.size > 0
  unused_views.each { |v| puts views[v] }
end 
```

它有点老套和未完成，但它完成了工作 - 至少对我而言。

像这样执行它（您只需要第一次使用 chmod 更改执行位）：

```
chmod +x script/script_name
./script/script_name 
```

享受！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-03-16T14:22:16.837

看看 GitHub 上的以下脚本[http://github.com/vinibaggio/discover-unused-partials](http://github.com/vinibaggio/discover-unused-partials)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-03T18:17:21.463

只需安装并运行**[discover-unused-partials](https://github.com/vinibaggio/discover-unused-partials)** gem：

```
gem install discover-unused-partials

discover-unused-partials rails_root_directory 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T17:50:26.093

遍历您的部分，grep（或 awk）项目以获取文件名。调整您的搜索正则表达式以在行首查找“render :partial”以查找通用部分（例如，“_form”）。

# c++ - 使用立方体贴图（不是反射贴图）对球体进行纹理处理

> ID：536314
> 
> 赞同：1
> 
> 时间：2009-02-11T10:55:21.877
> 
> 标签：c++, opengl, texture-mapping

我想用立方体贴图纹理一个球体。到目前为止，我的研究已经在 Google 上提出了许多关于使 OpenGL 自动生成纹理坐标的结果，但我想生成自己的坐标。

给定一个坐标数组，其中包含以 0,0,0 为中心的不完美球体（高度映射但本质上是一个球体）的顶点，如何为立方体贴图生成纹理坐标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T11:12:20.700

你是通过 GLSL 做的吗？在这种情况下，textureCube 接受 vec3 作为纹理坐标，它是球体上的单位向量。在您的情况下，您将获取片段相对于球体中心的坐标，对其进行标准化并将其作为坐标传递。无需担心内部表示为六个二维纹理。

```
uniform samplerCube cubemap;
varying vec3 pos; // position of the fragment w.r.t. the center of the sphere
/* ... */
vec4 color = textureCube(cubemap, normalize(pos).stp); 
```

在固定流水线 OpenGL 中也是如此。

顺便说一下，这里是如何在内部使用坐标的：绝对值中的最大坐标用于选择从六个纹理中的哪一个读取（符号选择正或负）。其他两个坐标在除以最大坐标后用于查找所选地图中的纹素。

# asp.net - 使用 AspNetSqlMembershipProvider 的最低要求

> ID：536316
> 
> 赞同：1
> 
> 时间：2009-02-11T10:55:34.310
> 
> 标签：asp.net, sql-server-2005

我正在为我的应用程序使用 AspNetSqlMembershipProvider。

在我的开发机器上，我最近卸载了 SQL Server 2005 Express 和 Management Studio Express，以便安装完整版的 Management Studio。我选择不安装 SQL Server 2005，因为我不想在我的机器上运行不必要的东西。

现在，每当我的代码尝试执行与身份验证相关的任何操作时，我都会收到以下错误：

> 与 >SQL Server 建立连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例 >name 是否正确，并且 SQL Server 已配置为允许远程连接。（提供者：>SQL 网络接口，错误：26 - 错误定位服务器/指定实例）

那么，我必须安装多少 SQL Server 才能使其正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T11:43:37.443

您可以在没有安装任何 SQL Server 实例的情况下离开，特别是如果您使用它的只是成员身份、角色和默认配置文件。

默认连接字符串通常如下所示：

```
<connectionStrings>
  <add name="LocalSqlServer" 
       connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true"
       providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

如果您更改 SQL 连接字符串以匹配上面“connectionString”的值，这将强制 ASP.NET 使用您站点的“App_Data”文件夹为您生成标准 ASP.NET 数据库 - 保留部分是“AttachDBFilename” " 它告诉它直接打开 mdf 文件，而不是附加到 SQL 实例。

但是，使用 SQL Management Studio 连接到该文件可能会有些困难。

一旦您将站点从开发转移到生产中，您可能必须更改连接字符串，以指向完整的 SQL 实例（如果您愿意），而不是坚持使用基于文件的版本。

或者，我倾向于安装 SQL Server（Express 或其他方式），但除非我实际使用它们，否则服务会停止。然后我只是在开发时启动它们。

此外，您还可以将 Express 版本的 SQL Server 与完整版 SQL Management Studio 安装在同一台机器上，而不会出现任何问题。

# winforms - Datagridview 滚动/最后一行问题（.Net Winforms）

> ID：536319
> 
> 赞同：2
> 
> 时间：2009-02-11T10:56:44.527
> 
> 标签：winforms, datagridview, scroll, repaint

我有一个可见 7 行半的网格。我已经设法完全显示最后一行，但最后一行之后的半行空间不会重新绘制并显示以前存在的任何内容。即使我用网格将另一个窗口拖到我的表单上然后将其最小化，空白区域也会显示最小化窗口的内容。我试过 Invalidate() 但没有运气。

希望你能理解。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T21:54:02.867

我有这个确切的问题。我尝试了各种疯狂。最后，起作用的是，我在插入一行后会隐藏/显示 datagridview 控件。

希望这可以帮助...

# java - 使用 java.util.concurrent.FutureTask 是不是一个好方法？

> ID：536327
> 
> 赞同：37
> 
> 时间：2009-02-11T11:04:24.557
> 
> 标签：java, multithreading, concurrency, futuretask

首先，我必须说我对 API java.util.concurrent 很陌生，所以也许我正在做的事情是完全错误的。

我想做什么？

我有一个 Java 应用程序，它基本上运行 2 个单独的处理（称为*myFirstProcess*、*mySecondProcess*），但这些处理必须同时运行。

所以，我试着这样做：

```
public void startMyApplication() {
    ExecutorService executor = Executors.newFixedThreadPool(2);
    FutureTask<Object> futureOne = new FutureTask<Object>(myFirstProcess);
    FutureTask<Object> futureTwo = new FutureTask<Object>(mySecondProcess);
    executor.execute(futureOne);
    executor.execute(futureTwo);
    while (!(futureOne.isDone() && futureTwo.isDone())) {
        try {
            // I wait until both processes are finished.
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
    logger.info("Processing finished");
    executor.shutdown();
    // Do some processing on results
    ...
} 
```

*myFirstProcess*和*mySecondProcess*是实现 的类，`Callable<Object>`它们的所有处理都在 call() 方法中进行。

它工作得很好，但我不确定这是否是正确的方法。是做我想做的事的好方法吗？如果没有，您能否给我一些提示来增强我的代码（并且仍然尽可能简单）。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-11T11:16:03.903

你最好用这个`get()`方法。

```
futureOne.get();
futureTwo.get(); 
```

两者都等待来自它完成处理的线程的通知，这为您节省了您现在使用的忙等待计时器，它既不高效也不优雅。

作为奖励，您拥有 API `get(long timeout, TimeUnit unit)`，它允许您定义线程休眠和等待响应的最长时间，否则继续运行。

有关更多信息，请参阅[Java API](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Future.html#get())。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-11-22T23:30:55.780

上面的用法`FutureTask`是可以容忍的，但绝对不是惯用的。您实际上是*在* `FutureTask`您提交给`ExecutorService`. 您`FutureTask`被. `Runnable`_ `ExecutorService`在内部，它将您的`FutureTask`-as-包装`Runnable`成一个 new`FutureTask`并将其作为一个`Future<?>`.

相反，您应该将您的`Callable<Object>`实例提交到[`CompletionService`](http://java.sun.com/javase/7/docs/api/java/util/concurrent/CompletionService.html). 您将两个`Callable`s 放入 via `submit(Callable<V>)`，然后转身并调用`CompletionService#take()`两次（每次提交一次`Callable`）。这些调用将阻塞，直到一个然后其他提交的任务完成。

鉴于您已经有一个`Executor`在手，[`ExecutorCompletionService`](http://java.sun.com/javase/7/docs/api/java/util/concurrent/ExecutorCompletionService.html)围绕它构建一个新的并将您的任务放在那里。不要旋转和睡觉等待；`CompletionService#take()`将阻塞，直到您的一项任务完成（完成运行或取消）或等待的线程`take()`被中断。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-11T11:26:50.213

Yuval 的解决方案很好。作为替代方案，您也可以这样做：

```
ExecutorService executor = Executors.newFixedThreadPool();
FutureTask<Object> futureOne = new FutureTask<Object>(myFirstProcess);
FutureTask<Object> futureTwo = new FutureTask<Object>(mySecondProcess);
executor.execute(futureOne);
executor.execute(futureTwo);
executor.shutdown();
try {
  executor.awaitTermination(Long.MAX_VALUE, TimeUnit.NANOSECONDS);
} catch (InterruptedException e) {
  // interrupted
} 
```

这种方法的优点是什么？实际上并没有太大的区别，只是这样你可以阻止执行者接受更多的任务（你也可以用另一种方式来做）。我倾向于喜欢这个成语而不是那个成语。

此外，如果任何一个 get() 抛出异常，您可能最终会出现在假设两个任务都已完成的代码的一部分中，这可能很糟糕。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-04-18T08:45:45.413

您可以使用 invokeall(Colelction....) 方法

```
package concurrent.threadPool;

import java.util.Arrays;
import java.util.List;
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;

public class InvokeAll {

    public static void main(String[] args) throws Exception {
        ExecutorService service = Executors.newFixedThreadPool(5);
        List<Future<java.lang.String>> futureList = service.invokeAll(Arrays.asList(new Task1<String>(),new Task2<String>()));

        System.out.println(futureList.get(1).get());
        System.out.println(futureList.get(0).get());
    }

    private static class Task1<String> implements Callable<String>{

        @Override
        public String call() throws Exception {
            Thread.sleep(1000 * 10);
            return (String) "1000 * 5";
        }

    }

    private static class Task2<String> implements Callable<String>{

        @Override
        public String call() throws Exception {
            Thread.sleep(1000 * 2);
            int i=3;
            if(i==3)
                throw new RuntimeException("Its Wrong");
            return (String) "1000 * 2";
        }

    }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-11T11:22:39.893

如果您有兴趣同时启动线程，或者等待它们完成然后做一些进一步的处理，您可能想要使用[CyclicBarrier 。](http://java.sun.com/javase/6/docs/api/java/util/concurrent/CyclicBarrier.html)有关更多信息，请参阅 javadoc。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-12-12T03:02:42.277

如果您的 futureTasks 超过 2 个，请考虑`[ListenableFuture][1]`.

> 当几个操作应该在另一个操作开始时立即开始时——“**扇出**”——ListenableFuture 才起作用：它触发所有请求的回调。通过稍微多一点的工作，我们可以“**扇入**”或触发一个 ListenableFuture，以便在其他几个未来都完成后立即计算。

# security - 如何提高 Delphi 中的内存安全性？

> ID：536328
> 
> 赞同：3
> 
> 时间：2009-02-11T11:04:28.410
> 
> 标签：security, delphi, memory-management, ram-scraping

是否可以在 Delphi 中“擦除”字符串？让我解释：

我正在编写一个应用程序，其中将包含一个用于授权用户的 DLL。它将加密文件读入 XML DOM，使用那里的信息，然后释放 DOM。

很明显，未加密的 XML 仍然位于 DLL 的内存中，因此容易受到检查。现在，我不会过分保护它——用户可以创建另一个 DLL——但我想采取一个基本步骤来防止用户名在内存中存在很长时间。但是，由于引用，我认为无论如何我都不能轻易擦除内存。如果我遍历我的 DOM（这是一个 TNativeXML 类）并找到每个字符串实例，然后将其变成类似“aaaaa”的内容，那么它实际上不会将新字符串指针分配给 DOM 引用，然后将旧字符串留在原处内存中有等待重新分配吗？有没有办法确保我正在杀死唯一的原始副本？

还是在 D2007 中有一种方法可以告诉它从堆中擦除所有未使用的内存？所以我可以释放 DOM，然后告诉它擦除。

或者我应该继续我的下一个任务而忘记这一点，因为它真的不值得打扰。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T11:51:23.990

我认为这不值得打扰，因为如果用户可以使用 DLL 读取进程的内存，则同一用户也可以在任何给定时间点停止执行。在擦除内存之前停止执行仍将使用户可以完全访问未加密的数据。

IMO 任何足够感兴趣并能够执行您所描述的操作的用户都不会因您的 DLL 擦除内存而受到严重不便。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T17:10:38.607

关于此的两个一般要点：

首先，这是“如果你不得不问，你可能不应该这样做”的领域之一。请不要采取错误的方式；我的意思不是不尊重你的编程技能。只是编写安全、加密功能强大的软件是你要么是专家要么不是专家的事情。就像知道“一点点空手道”比完全不知道空手道要危险得多一样。有许多第三方工具可用于在 Delphi 中编写安全软件，并提供专家支持；我强烈鼓励没有深入了解 Windows 中的密码服务、密码学的数学基础以及击败侧信道攻击经验的人使用它们，而不是尝试“自己动手”。

要回答您的具体问题：Windows API 有许多有用的函数，例如[CryptProtectMemory](http://msdn.microsoft.com/en-us/library/aa380262(VS.85).aspx)。然而，如果你加密了你的记忆，但在系统的其他地方有一个漏洞，或者暴露了一个侧通道，这会带来一种错误的安全感。这就像在你的门上放了一把锁，但让窗户保持打开状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-30T22:15:18.363

这样的事情怎么样？

```
procedure WipeString(const str: String);
var
  i:Integer;
  iSize:Integer;
  pData:PChar;

begin
    iSize := Length(str);
    pData := PChar(str);

    for i := 0 to 7 do
    begin
      ZeroMemory(pData, iSize);
      FillMemory(pData, iSize, $FF); // 1111 1111
      FillMemory(pData, iSize, $AA); // 1010 1010
      FillMemory(pData, iSize, $55); // 0101 0101
      ZeroMemory(pData, iSize);
    end;
end; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T11:43:13.153

DLL 不拥有分配的内存，进程拥有。一旦进程终止，您的特定进程分配的内存将被丢弃，无论 DLL 是否挂起（因为它正在被另一个进程使用）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T11:23:00.330

如何将文件解密为流，使用 SAX 处理器而不是 XML DOM 进行验证，然后在释放之前覆盖解密的流？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T21:46:59.343

如果您在完全调试模式下使用 FastMM 内存管理器，则可以在释放内存时强制它覆盖内存。

通常，该行为用于检测野指针，但它也可以用于您想要的。

另一方面，请确保您了解 Craig Stuntz 所写的内容：不要自己编写这些身份验证和授权内容，尽可能使用底层操作系统。

顺便说一句：Hallvard Vassbotn 写了一篇关于 FastMM 的不错的博客： [http ://hallvards.blogspot.com/2007/05/use-full-fastmm-consider-donating.html](http://hallvards.blogspot.com/2007/05/use-full-fastmm-consider-donating.html)

问候，

杰伦·普莱默斯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T11:16:13.640

凌乱，但你可以记下你在堆中填充敏感数据时使用的堆大小，然后在释放时执行 GetMem 为你分配一个大块，跨越（比如说）200%。对该块进行填充，并假设任何碎片对考官都有很大用处。布里

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T11:37:07.567

如何将密码保留为 XML 中的哈希值，并通过将输入密码的哈希与 XML 中的哈希密码进行比较来验证。

编辑：您可以仅在最后一刻加密和解密所有敏感数据。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-11T21:57:56.743

是否可以将解密的 XML 加载到 char 或 byte 数组而不是字符串中？那么就没有写时复制处理，所以你可以在释放之前用#0回填内存吗？

将 char 数组分配给字符串时要小心，因为 Delphi 在这里有一些智能处理以兼容传统的 char 压缩数组 [1..x]。

另外，你可以使用 ShortString 吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-10T17:38:18.787

如果您使用 XML（即使是加密的）来存储密码，您的用户也会面临风险。更好的方法是存储密码的哈希值，然后将哈希值与输入的密码进行比较。这种方法的优点是即使知道散列值，您也不会知道产生散列的密码。添加蛮力标识符（计算无效密码尝试，并在一定次数后锁定帐户）将进一步提高安全性。

您可以使用多种方法来创建字符串的哈希值。一个好的起点是查看 turbo power 开源项目“ [LockBox](http://sourceforge.net/projects/tplockbox/) ”，我相信它有几个创建单向哈希键的示例。

**编辑**

但是，如果它的一种方式有帮助，那么知道哈希值有什么帮助呢？如果您真的很偏执，您可以通过只有您知道的可预测的东西来修改哈希值......比如说，使用特定种子值加上日期的随机数。然后，您可以在 xml 中仅存储足够的哈希值，以便将其用作比较的起点。伪随机数生成器的好处在于，它们总是在给定相同种子的情况下生成相同系列的“随机”数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-11-21T20:23:00.427

小心那些试图将字符串视为指针并尝试使用`FillChar`或`ZeroMemory`擦除字符串内容的函数。

*   这都是错误的（字符串是共享的；你正在搞砸目前正在使用该字符串的其他人）
*   并且可能导致访问冲突（如果字符串恰好是一个常量，则它位于进程地址空间中的只读数据页上；并且尝试写入它是访问冲突）

```
procedure BurnString(var s: UnicodeString);
begin
    {
        If the string is actually constant (reference count of -1), then any attempt to burn it will be
        an access violation; as the memory is sitting in a read-only data page.

        But Delphi provides no supported way to get the reference count of a string.

        It's also an issue if someone else is currently using the string (i.e. Reference Count > 1).
        If the string were only referenced by the caller (with a reference count of 1), then
        our function here, which received the string through a var reference would also have the string with
        a reference count of one.

        Either way, we can only burn the string if there's no other reference.

        The use of UniqueString, while counter-intuitiave, is the best approach.
        If you pass an unencrypted password to BurnString as a var parameter, and there were another reference,
        the string would still contain the password on exit. You can argue that what's the point of making a *copy*
        of a string only to burn the copy. Two things:

            - if you're debugging it, the string you passed will now be burned (i.e. your local variable will be empty)
            - most of the time the RefCount will be 1\. When RefCount is one, UniqueString does nothing, so we *are* burning
                the only string
    }
    if Length(s) > 0 then
    begin
        System.UniqueString(s); //ensure the passed in string has a reference count of one
        ZeroMemory(Pointer(s), System.Length(s)*SizeOf(WideChar));

        {
            By not calling UniqueString, we only save on a memory allocation and wipe if RefCnt <> 1
            It's an unsafe micro-optimization because we're using undocumented offsets to reference counts.

            And i'm really uncomfortable using it because it really is undocumented.
            It is absolutely a given that it won't change. And we'd have stopping using Delphi long before
            it changes. But i just can't do it.
        }
        //if PLongInt(PByte(S) - 8)^ = 1 then //RefCnt=1
        //  ZeroMemory(Pointer(s), System.Length(s)*SizeOf(WideChar));

        s := ''; //We want the callee to see their passed string come back as empty (even if it was shared with other variables)
    end;
end; 
```

获得`UnicodeString`版本后，您可以创建`AnsiString`和`WideString`版本：

```
procedure BurnString(var s: AnsiString); overload;
begin
    if Length(s) > 0 then
    begin
        System.UniqueString(s);
        ZeroMemory(Pointer(s), System.Length(s)*SizeOf(AnsiChar));

        //if PLongInt(PByte(S) - 8)^ = 1 then //RefCount=1
        //  ZeroMemory(Pointer(s), System.Length(s)*SizeOf(AnsiChar));

        s := '';
    end;
end;

procedure BurnString(var s: WideString);
begin
    //WideStrings (i.e. COM BSTRs) are not reference counted, but they are modifiable
    if Length(s) > 0 then
    begin
        ZeroMemory(Pointer(s), System.Length(s)*SizeOf(WideChar));

        //if PLongInt(PByte(S) - 8)^ = 1 then //RefCount=1
        //  ZeroMemory(Pointer(s), System.Length(s)*SizeOf(AnsiChar));

        s := '';
    end;
end; 
```

# sql-server - 有没有办法让事务或连接在 SQL Server 中只读？

> ID：536329
> 
> 赞同：2
> 
> 时间：2009-02-11T11:04:28.627
> 
> 标签：sql-server, transactions

我需要对 DELETE/UPDATE/INSERT 快速表示“否”，因为 3p 报告工具允许用户编写自己的 SQL。

我知道我可能应该添加一个新用户并设置表/sp/views/etc 的权限...，然后以受限用户的身份创建一个新连接。

有没有更快的方法来强制 SQL Server 中的事务或连接进入只读模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T11:10:37.833

我不知道。如果 3P 工具那么疯狂，我会完全怀疑我接触到的东西。我认为建立一个新用户是最好的。甚至可能只是给他们某些视图和/或存储的过程并称之为一天。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T11:26:29.107

为什么您担心您的用户在他们的**报告**查询中添加任意 SQL 的能力？如果他们有权更改数据库中的数据，那么他们当然可以使用任何 ODBC 客户端连接到数据库并直接执行 SQL。

我不确定这里的问题是 3P，这听起来更像是您需要限制您的用户，但没有。

如果您有一类用户不应该被允许更改您的数据，那么请以这种方式设置他们的帐户。依靠他们只会使用不允许他们更改数据的报告工具这一事实，这是我可以驾驶卡车穿过的安全漏洞。

如果允许他们更改数据，限制 3P 会话将无助于保护您的系统。

除非我误解了你的设置。我以前错了，问问我的妻子。在这种情况下，请随时教育我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T11:09:46.790

[在 SQL Server 上更改](http://www.databasejournal.com/features/mssql/article.php/2246271/Managing-Users-Permissions-on-SQL-Server.htm)用户（连接字符串中使用的用户）的权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T12:03:38.237

Does it have to be with named users ? I have a "report" user and a "browser" user that just has select rights on most tables. Anyone that needs data uses those accounts and since they are select only I don't have to worry about them.

See Kern's link.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T11:42:47.443

如果您可以控制何时创建和关闭连接，您可以执行 BEGIN TRAN，然后在最后执行 ROLLBACK。这样，此报告工具所做的任何事情都会在最后回滚。但是，如果它有能力管理这些事务或新连接，或者如果用户群是未知的并且可能是恶意的，那么它就不是万无一失的。此外，任何大型事务都可能导致您的数据库被您的用户操作锁定

我不得不说，真正的答案是安全性分配给用户。您追求的“更快”方式是具有只读权限的新用户。

# wpf - 简单的 WPF UI 数据绑定

> ID：536330
> 
> 赞同：1
> 
> 时间：2009-02-11T11:04:48.643
> 
> 标签：wpf, data-binding

我正在尝试编写一个简单的 WPF 应用程序，它有两个椭圆，由一条线连接，就像您在网络图中看到的那样。当椭圆动画时，我只想让连接线自动“粘”到线连接的两个椭圆的画布位置。XAML 只是一个画布：

```
<Window x:Class="UIDataBindingDemo.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="400" Width="400">
<Grid>
    <Canvas x:Name="cnvExample" />
</Grid> 
```

...我只是在这里的构造函数中做一些非常简单的事情：

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;

namespace UIDataBindingDemo
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            // create 2 ellipses, one next to the other, and add them to the canvas
            Ellipse el1 = new Ellipse();
            Canvas.SetTop(el1, 100);
            Canvas.SetLeft(el1, 100);
            el1.Width = 20;
            el1.Height = 20;

            el1.Fill = Brushes.Red;
            el1.Stroke = Brushes.Black;

            Ellipse el2 = new Ellipse();
            Canvas.SetTop(el2, 100);
            Canvas.SetLeft(el2, 200);
            el2.Width = 20;
            el2.Height = 20;

            el2.Fill = Brushes.Blue;
            el2.Stroke = Brushes.Black;

            cnvExample.Children.Add(el1);
            cnvExample.Children.Add(el2);

            // create a line that connects the 2 ellipses.  Bind the two points that define this line to the 
            // locations of our ellipses, so the line always connects them, through animations, drag and drop
            // operations, whatever.
            Line line = new Line();
            line.StrokeThickness = 3;
            line.Stroke = Brushes.Black;
            line.SetBinding(Line.X1Property, new Binding("(Canvas.Left)") { Source = el1 });
            line.SetBinding(Line.X1Property, new Binding("(Canvas.Top)") { Source = el1 });
            line.SetBinding(Line.X1Property, new Binding("(Canvas.Left)") { Source = el2 });
            line.SetBinding(Line.X1Property, new Binding("(Canvas.Top)") { Source = el2 });

            cnvExample.Children.Add(line);

            // animate the second ellipse, so it moves down and to the right, nice and slow
            var moveTheBlueOne = new DoubleAnimation(300, TimeSpan.FromSeconds(10));
            el2.BeginAnimation(Canvas.LeftProperty, moveTheBlueOne);
            el2.BeginAnimation(Canvas.TopProperty, moveTheBlueOne);
        }
    } 
```

我对 WPF 很陌生，我确定我缺少一些简单的东西。为什么我看不到线？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T11:24:17.050

我不知道这是否是剪切和粘贴错误，但是您将每个绑定分配给相同的 DependencyProperty“Line.X1Property”，您应该使用所有四个 X 和 Y 属性来定义一条线的起点和终点。

```
line.SetBinding(Line.X1Property, new Binding("(Canvas.Left)") { Source = el1 });
line.SetBinding(Line.Y1Property, new Binding("(Canvas.Top)") { Source = el1 });
line.SetBinding(Line.X2Property, new Binding("(Canvas.Left)") { Source = el2 });
line.SetBinding(Line.Y2Property, new Binding("(Canvas.Top)") { Source = el2 }); 
```

这种方式对我有用。

# php - 跟踪对象状态

> ID：536332
> 
> 赞同：1
> 
> 时间：2009-02-11T11:05:21.653
> 
> 标签：php, oop

在 PHP 中，跟踪对象状态的最佳方法是什么，以判断它是否已被修改？我有一个创建新实体的存储库对象，然后它们被其他组件读取/修改并最终返回到存储库。如果对象已更改，我希望存储库将数据保存回持久存储 (DB)。

我可以想到四个选项：

1.  使用一个名为 $_modified 的内部布尔属性，每个 setter 在进行修改时都会更新该属性（如果有很多 setter，那就很乏味了）。
2.  使用 serialize() 和比较字符串的一些可怕的丑陋黑客（我确信这是一个*非常*糟糕的主意，但我想我会为了完整性添加它）
3.  类似于上面的东西，但带有对象属性的散列（不确定它是否适用于包含其他对象的对象）
4.  从仓库中取出对象的克隆并比较进来的东西（比听起来更复杂，因为你怎么知道将对象与哪个克隆进行比较？）

    或者...

5.  其他一些我不知道的聪明技巧？

谢谢，
杰克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T11:11:41.713

选项 1 - 使用布尔标志 - 是最好的方法。在性能以及一般可用性和便携性方面。

所有其他选项都会产生过多的开销，在这种情况下根本不需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:55:17.607

您可能想[研究工作单元](http://martinfowler.com/eaaCatalog/unitOfWork.html)模式，因为这是它旨在解决的大部分问题。当对象被更改时，它们会向 UoW 注册自己或被动注册，UoW 负责跟踪哪些对象已更改，并在播放结束时确定需要将哪些内容保存回数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T16:15:39.223

首先，我通常认为 $modified 或 $dirty 属性是这里最好的解决方案。

但我写信的原因是你的评论

> 如果有很多二传手会很乏味

我想知道您是否不使用PHP5？

如果你是，这是对 __set() 魔术方法的完美使用。您甚至可以按原样使用它，从 __set() 方法调用现有的设置器。

例如：

```
class some_concept
{

    private $x = 1;
    private $y = 2;
    private $dirty = false;

    // This represents your existing setter methods
    function set_y($i)
    {
        $this->y = $i;
    }

    function __set($name, $value)
    {
        if ($value != $this->{$name}) $this->dirty = true;

        return $this->{'set_' . $name}($value);
    }

    function __get($name)
    {
            return $this->{$name};
    }
} 
```

但是，您比较序列化字符串的想法有一些优点。序列化可能很昂贵。这是真的。

但它是您列表中最准确的解决方案。想象一下加载上面的对象，将 $y 设置为 0，然后将其设置回 2，然后保存。脏吗？它会这么说，但实际上，它与加载时的状态相同。

我在这里使用的测试是你的 save() 有多贵。如果保存是非常昂贵的 API 调用、数据库事务等，那么您可能会发现在加载时序列化对象并保存它的 md5 哈希值是值得的。

如果这个只需要几分之一秒的操作可以节省几秒钟的交易，那么它真的是值得的。

* * *

最后，我想指出 Damien Katz 对这个问题的反对意见。Katz 是一位才华横溢的开发人员，他创建了 CouchDb，目前为 MySQL 工作。

他的[Error Codes v Exceptions](http://damienkatz.net/2006/04/error_code_vs_e.html)帖子很长，但是关于这个主题的阅读非常好。

当它开始谈论抛出异常的返回错误代码的优点时，他真的最终谈论了如何编写可靠的软件。

首先，他谈到了如何以与 SQL 事务相同的方式创建原子类。一般的想法是你制作一个对象的副本，修改它的状态，并且只有在最后一步，如果成功，你会将该副本换成主要对象。这允许有意义的撤消功能。像这样的模式虽然很难填充到现有的应用程序中，但也为这个 is_modified 问题提供了解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T11:16:42.187

我认为第一个选项对于更易读的代码和更快的执行来说是最好的。我还会考虑先序列化对象（比如文件），然后对内容进行哈希处理。

相同的内容应该产生相同的哈希值。

# video - DirectX 渲染的 WMV 流式传输

> ID：536333
> 
> 赞同：1
> 
> 时间：2009-02-11T11:05:48.280
> 
> 标签：video, streaming, directx

我在 DirectX 中编写了一个实时可视化应用程序。问题是，它应该以视频流的形式显示在多台计算机上。

我猜 WMV 将是最简单的编解码器，因为它是 MS 等等。

那么，如何将一系列 DirectX 屏幕抓图转换为流畅的 30fps WMV 视频流？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-13T23:47:22.190

我建议您编写一个 directshow 源过滤器。源过滤器可以为编码器提供一系列位图，这些位图要以压缩格式编码以进行传输。您可以使用文件写入器过滤器将其保存到磁盘，或使用网络流过滤器对其进行流式传输。

然而，这是一项不平凡的任务！

我们可以看到您的可视化应用程序代码吗？请？！

# vim - 如何防止 Vim 在括号中缩进包装的文本

> ID：536334
> 
> 赞同：14
> 
> 时间：2009-02-11T11:06:18.263
> 
> 标签：vim, latex, indentation, word-wrap

这困扰了我很长时间，并且尽我所能尝试我找不到解决方法。

当我编辑文本（特别是乳胶，但这没关系）文件时，我希望它在 80 列时自动换行。它会这样做，除非我碰巧在一个括号子句的中间，它会缩进*非常*烦人的文本。例如，这工作正常

```
Here is some text... over
two lines. 
```

但这不是

```
Here is some text... (over
                      two
                      lines 
```

如果有人能告诉我如何关闭它（仅适用于文本/乳胶文件），我将不胜感激。大概这与这是 C 中的期望行为这一事实有关，但我仍然无法弄清楚出了什么问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-01-24T23:09:03.120

```
:set nocindent 
```

其他选项什么都不做，文件类型检测不会改变它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T11:22:03.047

您可能需要关闭三个选项：set noai、set nosi 和 setnocin（autoindent、smartindent 和 cindent）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-07T19:47:34.063

这可能是相关的，当从 gui 粘贴到终端窗口时，vim 无法区分粘贴模式，所以要阻止任何奇怪的事情发生：

```
set paste 
```

然后粘贴文本

```
set nopaste 
```

我在尝试粘贴 xml 文本时遇到了类似的问题，它只会继续缩进。:)

**gvim**是 vim 的 gui 版本，可以检测粘贴模式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T11:14:45.997

你可以看看 autoindent 选项：

> 自动缩进-ai
> 
> 开始新行时从当前行复制缩进（在插入模式下键入或使用“o”或“O”命令时）。如果您没有在新行中键入任何内容，除了然后键入 or ，缩进将再次被删除。当自动缩进打开时，格式化（使用“gq”命令或在插入模式下达到“textwidth”时）使用第一行的缩进。当 'smartindent' 或 'cindent' 在特定情况下，缩进会改变。当设置 'paste' 选项时，'autoindent' 选项会被重置。{与Vi的小区别：输入or时删除缩进后，上下移动时光标位置在删除缩进后；Vi 将光标放在已删除缩进中的某处}。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-11T11:25:26.660

来自官方[Vim 文档](http://vimdoc.sourceforge.net/htmldoc/usr_05.html)

> 文件类型插件缩进
> 
> 这开启了三个非常聪明的机制：
> 
> 1.  文件类型检测。每当您开始编辑文件时，Vim 都会尝试找出这是什么类型的文件。当你编辑 "main.c" 时，Vim 会看到 ".c" 扩展名并将其
>     识别为 "c" 文件类型。当你编辑一个以 "#!/bin/sh" 开头的文件时，Vim 会将它识别为 "sh" 文件类型。文件类型检测用于语法高亮和
>     下面的其他两项。见 |文件类型|。
>     
>     
> 2.  使用文件类型插件文件 许多不同的文件类型使用不同的选项进行编辑。例如，
>     当你编辑一个 "c" 文件时，设置 'cindent' 选项来自动缩进行是非常有用的。这些常用的选项设置
>     包含在 Vim 的文件类型插件中。你也可以添加你自己的，见
>     |write-filetype-plugin|。
>     
>     
> 3.  使用缩进文件 编辑程序时，通常可以自动计算行的缩进。Vim 为许多文件类型提供了这些缩进规则。见 |:filetype-in​​dent-on| 和'indentexpr'。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T11:12:15.083

:set noai

设置不自动缩进 tt 可能是 smartindent。查看文档，看看是否可以找到更多内容

[http://www.vim.org/htmldoc/indent.html](http://www.vim.org/htmldoc/indent.html)

# django - 如何确保 url 在内置 Web 服务器和 Apache 中的工作方式相同

> ID：536339
> 
> 赞同：0
> 
> 时间：2009-02-11T11:09:55.213
> 
> 标签：django, django-admin, django-urls, mod-python, apache-config

情况是：
我在 windows xp 上有带有 mod_python 的 Apache，而我的 django 项目不在文档根目录中。
Django 项目位置是用标签定义的。django.root 也在那里定义。
所有 url 在内置服务器中都可以正常工作，但不幸的是在 Apache 中不行。在某些 URL 中，尤其是那些不指向管理员的 URL 不起作用。django.root 部分被切断。
我怎样才能避免这种情况？

一种解决方案是将 django-project 设置为 Apache 的文档根目录。还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T22:49:29.443

[如果您使用{% url %} 标记](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#url)在模板文件中编写链接并在 HTTPResponseRedirects() 调用中调用[reverse()](http://docs.djangoproject.com/en/dev/topics/http/urls/#reverse) ， Django 将正确使用 django.root 部分。

它的值存储在 HttpRequest - request.META['SCRIPT_NAME'] 中，您也可以在模板中使用它：

```
 {% if user.is_staff %}
    <li>
        <a href="{{ request.META.SCRIPT_NAME }}/admin">Administration</a>
    </li>
    {% endif %} 
```

# c# - 在管理工具中看不到我的服务 -> 服务

> ID：536345
> 
> 赞同：0
> 
> 时间：2009-02-11T11:11:58.033
> 
> 标签：c#, windows, service

我有一个我自己用 C# 开发的服务，它包括一个 msi 安装包。当我在自己的计算机上安装它时，我可以在管理工具 - > 服务中看到它（并启动/停止它），但在另一台（非常相似的）机器上我看不到。我不太关心我是否可以在那里看到它，但不知何故我希望能够启动/停止服务。除了通过管理工具-> 服务之外，还有其他方法可以做到这一点吗？

当然，对于“为什么服务没有出现在管理工具->服务中”的回答也将不胜感激:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T12:32:09.853

我不记得看到任何具有未出现在“服务”窗口中的功能服务的机器。我的第一个猜测是您的服务实际上是**not installed**。

尝试再次安装它[ [MSDN](http://msdn.microsoft.com/en-us/library/aa984379(VS.71).aspx) ]

```
installutil yourproject.exe 
```

如果它不在您的 PATH 中，请在 %systemroot%\Microsoft.NET\Framework\v2.0.50727\ （或您在其中获得的任何 .NET 版本）中查找*installutil 。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T11:44:44.553

这台其他机器是否安装了适当版本的.Net？

# c# - 为什么没有 ICloneable ?

> ID：536349
> 
> 赞同：241
> 
> 时间：2009-02-11T11:13:56.810
> 
> 标签：c#, .net, icloneable

`ICloneable<T>`泛型不存在是否有特殊原因？

如果我不需要每次克隆某些东西时都投射它，那会舒服得多。

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-02-11T11:19:21.773

除了安德烈的回复（我同意，+1）-完成后，您`ICloneable` *还*可以选择显式实现以使公共`Clone()`返回一个类型化的对象：

```
public Foo Clone() { /* your code */ }
object ICloneable.Clone() {return Clone();} 
```

当然，泛型还有第二个问题`ICloneable<T>`——继承。

如果我有：

```
public class Foo {}
public class Bar : Foo {} 
```

而我实施了`ICloneable<T>`，那我要实施`ICloneable<Foo>`吗？`ICloneable<Bar>`? 你很快就开始实现许多相同的接口......与演员表相比......真的那么糟糕吗？

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2009-02-11T11:16:44.760

ICloneable 现在被认为是一个糟糕的 API，因为它没有指定结果是深拷贝还是浅拷贝。我认为这就是他们不改进这个界面的原因。

您可能可以使用类型化克隆扩展方法，但我认为它需要一个不同的名称，因为扩展方法的优先级低于原始方法。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-02-25T02:03:46.607

我需要问，除了实现它*之外，你会对接口做什么？*接口通常仅在您转换为它时才有用（即此类是否支持'IBar'），或者具有接受它的参数或设置器（即我采用'IBar'）。使用 ICloneable - 我们浏览了整个框架，但未能在任何地方找到一个单独的用法，而不是它的实现。我们也未能在“现实世界”中找到任何除了实现它之外的用途（在我们可以访问的约 60,000 个应用程序中）。

现在，如果您只想强制执行您希望您的“可克隆”对象实现的模式，那么这是一个完全好的用法 - 并继续。您还可以确定“克隆”对您的确切含义（即深或浅）。但是，在这种情况下，我们（BCL）不需要定义它。当需要在不相关的库之间交换类型为抽象的实例时，我们只在 BCL 中定义抽象。

大卫·基恩（BCL 团队）

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-11T11:26:27.733

我认为“为什么”这个问题是不必要的。有很多接口/类/等...非常有用，但不是 .NET Frameworku 基础库的一部分。

但是，主要是你可以自己做。

```
public interface ICloneable<T> : ICloneable {
    new T Clone();
}

public abstract class CloneableBase<T> : ICloneable<T> where T : CloneableBase<T> {
    public abstract T Clone();
    object ICloneable.Clone() => return this.Clone();
}

public abstract class CloneableExBase<T> : CloneableBase<T> where T : CloneableExBase<T> {
    protected abstract T CreateClone();
    protected abstract void FillClone(T clone);
    public override T Clone() {
        T clone = this.CreateClone();
        if (clone is null ) {
            throw new NullReferenceException( "Clone was not created." );
        }

        this.FillClone(clone);
        return clone
    }
}

public abstract class PersonBase<T> : CloneableExBase<T> where T : PersonBase<T> {
    public string Name { get; set; }

    protected override void FillClone( T clone ) {
        clone.Name = this.Name;
    }
}

public sealed class Person : PersonBase<Person> {
    protected override Person CreateClone() => return new Person();
}

public abstract class EmployeeBase<T> : PersonBase<T> where T : EmployeeBase<T> {
    public string Department { get; set; }

    protected override void FillClone(T clone) {
        base.FillClone(clone);

        clone.Department = this.Department;
    }
}

public sealed class Employee : EmployeeBase<Employee> {
    protected override Employee CreateClone() => return new Employee();
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-11T11:19:17.407

如果需要，[自己编写接口](http://mb-unit.googlecode.com/svn/trunk/v3/src/Gallio/Gallio/Common/ICloneable.cs)非常容易：

```
public interface ICloneable<T> : ICloneable
        where T : ICloneable<T>
{
    new T Clone();
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-11-12T19:29:15.470

最近阅读了文章[为什么复制对象是一件可怕的事情？](http://www.agiledeveloper.com/articles/cloning072002.htm)，我认为这个问题需要额外的澄清。这里的其他答案提供了很好的建议，但答案仍然不完整 - 为什么不`ICloneable<T>`？

1.  **用法**

    所以，你有一个实现它的类。虽然以前您有一个想要的方法`ICloneable`，但现在它必须是通用的才能接受`ICloneable<T>`。您需要对其进行编辑。

    然后，你可以有一个方法来检查一个 object `is ICloneable`。现在怎么办？您不能这样做`is ICloneable<>`，并且由于您不知道编译类型的对象类型，因此您不能使该方法成为通用方法。第一个真正的问题。

    所以你需要同时拥有`ICloneable<T>`and `ICloneable`，前者实现后者。因此，实现者需要实现这两种方法 -`object Clone()`和`T Clone()`. 不，谢谢，我们已经玩得很开心了`IEnumerable`。

    正如已经指出的，还有继承的复杂性。虽然协变似乎可以解决这个问题，但派生类型需要实现`ICloneable<T>`它自己的类型，但是已经有一个具有相同签名（= 参数，基本上）的方法 -`Clone()`基类的。使新的克隆方法接口显式是没有意义的，您将失去创建时所寻求的优势`ICloneable<T>`。所以添加`new`关键字。但是不要忘记您还需要覆盖基类' `Clone()`（实现必须对所有派生类保持统一，即从每个克隆方法返回相同的对象，因此基克隆方法必须是`virtual`）！但是，不幸的是，你不能`override`同时`new`具有相同签名的方法。选择第一个关键字，您将失去添加时想要的目标`ICloneable<T>`。选择第二个，你会破坏接口本身，使应该做同样事情的方法返回不同的对象。

2.  **观点**

    您想要`ICloneable<T>`舒适，但舒适不是接口设计的目的，它们的含义是（通常是OOP）统一对象的行为（尽管在C＃中，它仅限于统一外部行为，例如方法和属性，而不是他们的工作）。

    如果第一个原因还没有说服您，您可以反对也`ICloneable<T>`可以限制性地工作，以限制从 clone 方法返回的类型。但是，讨厌的程序员可以实现`ICloneable<T>`T 不是实现它的类型。所以，为了实现你的限制，你可以给泛型参数添加一个很好的约束：
    `public interface ICloneable<T> : ICloneable where T : ICloneable<T>`
    当然比没有的更严格`where`，你仍然不能限制*T*是实现接口的类型（你可以从`ICloneable<T>`不同的类型派生实现它）。

    你看，连这个目的都达不到（原来`ICloneable`在这点上也失败了，没有接口可以真正限制实现类的行为）。

正如你所看到的，这证明了通用接口既难以完全实现，也确实不需要和无用。

但回到这个问题，你真正寻求的是在克隆对象时获得舒适感。有两种方法可以做到：

### 其他方法

```
public class Base : ICloneable
{
    public Base Clone()
    {
        return this.CloneImpl() as Base;
    }

    object ICloneable.Clone()
    {
        return this.CloneImpl();
    }

    protected virtual object CloneImpl()
    {
        return new Base();
    }
}

public class Derived : Base
{
    public new Derived Clone()
    {
        return this.CloneImpl() as Derived;
    }

    protected override object CloneImpl()
    {
        return new Derived();
    }
} 
```

该解决方案为用户提供了舒适和预期的行为，但实施起来也太长了。如果我们不想让“舒适”方法返回当前类型，那么使用`public virtual object Clone()`.

那么让我们看看“终极”解决方案——C# 中的什么是真正旨在让我们感到舒适的东西？

### 扩展方法！

```
public class Base : ICloneable
{
    public virtual object Clone()
    {
        return new Base();
    }
}

public class Derived : Base
{
    public override object Clone()
    {
        return new Derived();
    }
}

public static T Copy<T>(this T obj) where T : class, ICloneable
{
    return obj.Clone() as T;
} 
```

它被命名为*Copy*以不与当前的*Clone*方法发生冲突（编译器更喜欢类型自己声明的方法而不是扩展方法）。限制是为了`class`速度（不需要空检查等）。

我希望这能澄清为什么不做的原因`ICloneable<T>`。但是，建议根本不要实施`ICloneable`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-10-29T05:38:20.917

虽然这个问题很老了（写这个答案5年了:)并且已经回答了，但我发现这篇文章很好地回答了这个问题，[在这里查看](http://www.sysexpand.com/?path=howto/implement-icloneable-or-not)

**编辑：**

这是回答问题的文章的引述（请务必阅读完整的文章，其中包括其他有趣的内容）：

> Internet 上有许多参考资料指向 Brad Abrams 2003 年的一篇博客文章——当时他在微软工作——其中讨论了关于 ICloneable 的一些想法。可以在以下地址找到博客条目：[Implementing ICloneable](http://blogs.msdn.com/b/brada/archive/2003/04/09/49935.aspx)。尽管标题具有误导性，但这篇博文呼吁不要实现 ICloneable，主要是因为浅/深的混淆。文章以直截了当的建议结束：如果您需要克隆机制，请定义自己的克隆或复制方法，并确保您清楚地记录它是深拷贝还是浅拷贝。一个合适的模式是：`public <type> Copy();`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-19T22:04:17.357

一个大问题是他们不能将 T 限制为同一类。例如，什么会阻止你这样做：

```
interface IClonable<T>
{
    T Clone();
}

class Dog : IClonable<JackRabbit>
{
    //not what you would expect, but possible
    JackRabbit Clone()
    {
        return new JackRabbit();
    }

} 
```

他们需要一个参数限制，例如：

```
interfact IClonable<T> where T : implementing_type 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-11T11:19:40.137

这是一个很好的问题......不过，你可以自己做：

```
interface ICloneable<T> : ICloneable
{
  new T Clone ( );
} 
```

Andrey 说它被认为是一个糟糕的 API，但我还没有听说过这个接口被弃用的任何消息。这会破坏大量的接口...... Clone 方法应该执行浅拷贝。如果对象还提供深拷贝，则可以使用重载的克隆 (bool deep)。

编辑：我用于“克隆”对象的模式是在构造函数中传递一个原型。

```
class C
{
  public C ( C prototype )
  {
    ...
  }
} 
```

这消除了任何潜在的冗余代码实现情况。顺便说一句，谈到 ICloneable 的局限性，是否应该由对象本身决定是否应该执行浅克隆或深克隆，甚至是部分浅/部分深克隆？只要对象按预期工作，我们真的应该关心吗？在某些情况下，一个好的克隆实现很可能同时包含浅层和深层克隆。

# sql - 在一条 sql 语句中删除所有表、存储过程、触发器、约束和所有依赖项

> ID：536350
> 
> 赞同：303
> 
> 时间：2009-02-11T11:14:25.313
> 
> 标签：sql, sql-server, sql-server-2005, tsql

有什么方法可以通过删除所有表并删除一个 SQL 语句中的存储过程、触发器、约束和所有依赖项来清理 SQl Server 2005 中的数据库？

**请求的理由：**

我想要一个数据库脚本来清理现有的未使用的数据库，而不是创建新的数据库，特别是当您必须向数据库管理员提出请求并等待一段时间才能完成时！

* * *

## 回答 #1

> 赞同：632
> 
> 时间：2009-09-24T18:18:41.907

此脚本清除所有视图、SPS、函数 PK、FK 和表。

```
/* Drop all non-system stored procs */
DECLARE @name VARCHAR(128)
DECLARE @SQL VARCHAR(254)

SELECT @name = (SELECT TOP 1 [name] FROM sysobjects WHERE [type] = 'P' AND category = 0 ORDER BY [name])

WHILE @name is not null
BEGIN
    SELECT @SQL = 'DROP PROCEDURE [dbo].[' + RTRIM(@name) +']'
    EXEC (@SQL)
    PRINT 'Dropped Procedure: ' + @name
    SELECT @name = (SELECT TOP 1 [name] FROM sysobjects WHERE [type] = 'P' AND category = 0 AND [name] > @name ORDER BY [name])
END
GO

/* Drop all views */
DECLARE @name VARCHAR(128)
DECLARE @SQL VARCHAR(254)

SELECT @name = (SELECT TOP 1 [name] FROM sysobjects WHERE [type] = 'V' AND category = 0 ORDER BY [name])

WHILE @name IS NOT NULL
BEGIN
    SELECT @SQL = 'DROP VIEW [dbo].[' + RTRIM(@name) +']'
    EXEC (@SQL)
    PRINT 'Dropped View: ' + @name
    SELECT @name = (SELECT TOP 1 [name] FROM sysobjects WHERE [type] = 'V' AND category = 0 AND [name] > @name ORDER BY [name])
END
GO

/* Drop all functions */
DECLARE @name VARCHAR(128)
DECLARE @SQL VARCHAR(254)

SELECT @name = (SELECT TOP 1 [name] FROM sysobjects WHERE [type] IN (N'FN', N'IF', N'TF', N'FS', N'FT') AND category = 0 ORDER BY [name])

WHILE @name IS NOT NULL
BEGIN
    SELECT @SQL = 'DROP FUNCTION [dbo].[' + RTRIM(@name) +']'
    EXEC (@SQL)
    PRINT 'Dropped Function: ' + @name
    SELECT @name = (SELECT TOP 1 [name] FROM sysobjects WHERE [type] IN (N'FN', N'IF', N'TF', N'FS', N'FT') AND category = 0 AND [name] > @name ORDER BY [name])
END
GO

/* Drop all Foreign Key constraints */
DECLARE @name VARCHAR(128)
DECLARE @constraint VARCHAR(254)
DECLARE @SQL VARCHAR(254)

SELECT @name = (SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE constraint_catalog=DB_NAME() AND CONSTRAINT_TYPE = 'FOREIGN KEY' ORDER BY TABLE_NAME)

WHILE @name is not null
BEGIN
    SELECT @constraint = (SELECT TOP 1 CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE constraint_catalog=DB_NAME() AND CONSTRAINT_TYPE = 'FOREIGN KEY' AND TABLE_NAME = @name ORDER BY CONSTRAINT_NAME)
    WHILE @constraint IS NOT NULL
    BEGIN
        SELECT @SQL = 'ALTER TABLE [dbo].[' + RTRIM(@name) +'] DROP CONSTRAINT [' + RTRIM(@constraint) +']'
        EXEC (@SQL)
        PRINT 'Dropped FK Constraint: ' + @constraint + ' on ' + @name
        SELECT @constraint = (SELECT TOP 1 CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE constraint_catalog=DB_NAME() AND CONSTRAINT_TYPE = 'FOREIGN KEY' AND CONSTRAINT_NAME <> @constraint AND TABLE_NAME = @name ORDER BY CONSTRAINT_NAME)
    END
SELECT @name = (SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE constraint_catalog=DB_NAME() AND CONSTRAINT_TYPE = 'FOREIGN KEY' ORDER BY TABLE_NAME)
END
GO

/* Drop all Primary Key constraints */
DECLARE @name VARCHAR(128)
DECLARE @constraint VARCHAR(254)
DECLARE @SQL VARCHAR(254)

SELECT @name = (SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE constraint_catalog=DB_NAME() AND CONSTRAINT_TYPE = 'PRIMARY KEY' ORDER BY TABLE_NAME)

WHILE @name IS NOT NULL
BEGIN
    SELECT @constraint = (SELECT TOP 1 CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE constraint_catalog=DB_NAME() AND CONSTRAINT_TYPE = 'PRIMARY KEY' AND TABLE_NAME = @name ORDER BY CONSTRAINT_NAME)
    WHILE @constraint is not null
    BEGIN
        SELECT @SQL = 'ALTER TABLE [dbo].[' + RTRIM(@name) +'] DROP CONSTRAINT [' + RTRIM(@constraint)+']'
        EXEC (@SQL)
        PRINT 'Dropped PK Constraint: ' + @constraint + ' on ' + @name
        SELECT @constraint = (SELECT TOP 1 CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE constraint_catalog=DB_NAME() AND CONSTRAINT_TYPE = 'PRIMARY KEY' AND CONSTRAINT_NAME <> @constraint AND TABLE_NAME = @name ORDER BY CONSTRAINT_NAME)
    END
SELECT @name = (SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE constraint_catalog=DB_NAME() AND CONSTRAINT_TYPE = 'PRIMARY KEY' ORDER BY TABLE_NAME)
END
GO

/* Drop all tables */
DECLARE @name VARCHAR(128)
DECLARE @SQL VARCHAR(254)

SELECT @name = (SELECT TOP 1 [name] FROM sysobjects WHERE [type] = 'U' AND category = 0 ORDER BY [name])

WHILE @name IS NOT NULL
BEGIN
    SELECT @SQL = 'DROP TABLE [dbo].[' + RTRIM(@name) +']'
    EXEC (@SQL)
    PRINT 'Dropped Table: ' + @name
    SELECT @name = (SELECT TOP 1 [name] FROM sysobjects WHERE [type] = 'U' AND category = 0 AND [name] > @name ORDER BY [name])
END
GO 
```

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2011-11-16T10:49:40.810

我正在使用 Adam Anderson 的这个脚本，更新后支持 dbo 以外的其他模式中的对象。

```
declare @n char(1)
set @n = char(10)

declare @stmt nvarchar(max)

-- procedures
select @stmt = isnull( @stmt + @n, '' ) +
    'drop procedure [' + schema_name(schema_id) + '].[' + name + ']'
from sys.procedures

-- check constraints
select @stmt = isnull( @stmt + @n, '' ) +
'alter table [' + schema_name(schema_id) + '].[' + object_name( parent_object_id ) + ']    drop constraint [' + name + ']'
from sys.check_constraints

-- functions
select @stmt = isnull( @stmt + @n, '' ) +
    'drop function [' + schema_name(schema_id) + '].[' + name + ']'
from sys.objects
where type in ( 'FN', 'IF', 'TF' )

-- views
select @stmt = isnull( @stmt + @n, '' ) +
    'drop view [' + schema_name(schema_id) + '].[' + name + ']'
from sys.views

-- foreign keys
select @stmt = isnull( @stmt + @n, '' ) +
    'alter table [' + schema_name(schema_id) + '].[' + object_name( parent_object_id ) + '] drop constraint [' + name + ']'
from sys.foreign_keys

-- tables
select @stmt = isnull( @stmt + @n, '' ) +
    'drop table [' + schema_name(schema_id) + '].[' + name + ']'
from sys.tables

-- user defined types
select @stmt = isnull( @stmt + @n, '' ) +
    'drop type [' + schema_name(schema_id) + '].[' + name + ']'
from sys.types
where is_user_defined = 1

exec sp_executesql @stmt 
```

[资料来源：亚当安德森博客文章](https://web.archive.org/web/20120308203046/http://blog.falafel.com/Blogs/AdamAnderson/09-01-06/T-SQL_Drop_All_Objects_in_a_SQL_Server_Database.aspx)

* * *

## 回答 #3

> 赞同：106
> 
> 时间：2011-04-22T19:01:58.530

最好的办法是“**为 Drop 生成脚本**”

选择**数据库**->**右键单击**​​ ->**任务**->**生成脚本**- 将打开生成脚本的**向导**

在设置脚本选项中选择对象后单击**高级**按钮

*   -> 将选项“要创建的脚本”设置为 true（想要创建）

*   -> 将选项 ' **Script to Drop** ' 设置为 true （想要删除）

*   -> 选中复选框以选择希望创建脚本的对象

*   -> 选择编写脚本的选项（文件、新窗口、剪贴板）

*   它默认包含依赖对象。（首先会删除约束）

    执行脚本

这样我们就可以自定义我们的脚本了。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2009-02-11T11:22:24.513

要删除所有表：

```
exec sp_MSforeachtable 'DROP TABLE ?' 
```

当然，这将删除除存储过程之外的所有约束、触发器等。

对于存储过程，恐怕您需要另一个存储过程存储在`master`.

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-02-11T11:21:38.663

我会在两个陈述中做到这一点：[`DROP DATABASE ???`](http://msdn.microsoft.com/de-de/library/ms178613.aspx)

进而[`CREATE DATABASE ???`](http://msdn.microsoft.com/de-de/library/ms176061.aspx)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2014-12-10T15:37:47.110

我在这里尝试了一些脚本，但它们对我不起作用，因为我的表在模式中。所以我整理了以下。请注意，此脚本采用模式列表，然后按顺序删除。您需要确保在您的模式中有完整的排序。如果有任何循环依赖，那么它将失败。

```
PRINT 'Dropping whole database'
GO

------------------------------------------
-- Drop constraints
------------------------------------------
DECLARE @Sql NVARCHAR(500) DECLARE @Cursor CURSOR

SET @Cursor = CURSOR FAST_FORWARD FOR
SELECT DISTINCT sql = 'ALTER TABLE ['+tc2.CONSTRAINT_SCHEMA+'].[' + tc2.TABLE_NAME + '] DROP [' + rc1.CONSTRAINT_NAME + ']'
FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS rc1
LEFT JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc2 ON tc2.CONSTRAINT_NAME =rc1.CONSTRAINT_NAME

OPEN @Cursor FETCH NEXT FROM @Cursor INTO @Sql

WHILE (@@FETCH_STATUS = 0)
BEGIN
PRINT @Sql
Exec (@Sql)
FETCH NEXT FROM @Cursor INTO @Sql
END

CLOSE @Cursor DEALLOCATE @Cursor
GO

------------------------------------------
-- Drop views
------------------------------------------

DECLARE @sql VARCHAR(MAX) = ''
        , @crlf VARCHAR(2) = CHAR(13) + CHAR(10) ;

SELECT @sql = @sql + 'DROP VIEW ' + QUOTENAME(SCHEMA_NAME(schema_id)) + '.' + QUOTENAME(v.name) +';' + @crlf
FROM   sys.views v

PRINT @sql;
EXEC(@sql);
GO
------------------------------------------
-- Drop procs
------------------------------------------
PRINT 'Dropping all procs ...'
GO

DECLARE @sql VARCHAR(MAX) = ''
        , @crlf VARCHAR(2) = CHAR(13) + CHAR(10) ;

SELECT @sql = @sql + 'DROP PROC ' + QUOTENAME(SCHEMA_NAME(p.schema_id)) + '.' + QUOTENAME(p.name) +';' + @crlf
FROM   [sys].[procedures] p

PRINT @sql;
EXEC(@sql);
GO

------------------------------------------
-- Drop tables
------------------------------------------
PRINT 'Dropping all tables ...'
GO
EXEC sp_MSForEachTable 'DROP TABLE ?'
GO

------------------------------------------
-- Drop sequences
------------------------------------------

PRINT 'Dropping all sequences ...'
GO
DECLARE @DropSeqSql varchar(1024)
DECLARE DropSeqCursor CURSOR FOR
SELECT DISTINCT 'DROP SEQUENCE ' + s.SEQUENCE_SCHEMA + '.' + s.SEQUENCE_NAME
    FROM INFORMATION_SCHEMA.SEQUENCES s

OPEN DropSeqCursor

FETCH NEXT FROM DropSeqCursor INTO @DropSeqSql

WHILE ( @@FETCH_STATUS <> -1 )
BEGIN
    PRINT @DropSeqSql
    EXECUTE( @DropSeqSql )
    FETCH NEXT FROM DropSeqCursor INTO @DropSeqSql
END

CLOSE DropSeqCursor
DEALLOCATE DropSeqCursor
GO

------------------------------------------
-- Drop Schemas
------------------------------------------

DECLARE @schemas as varchar(1000) = 'StaticData,Ird,DataImport,Collateral,Report,Cds,CommonTrade,MarketData,TypeCode'
DECLARE @schemasXml as xml = cast(('<schema>'+replace(@schemas,',' ,'</schema><schema>')+'</schema>') as xml)

DECLARE @Sql NVARCHAR(500) DECLARE @Cursor CURSOR

SET @Cursor = CURSOR FAST_FORWARD FOR
SELECT sql = 'DROP SCHEMA ['+schemaName+']' FROM 
(SELECT CAST(T.schemaName.query('text()') as VARCHAR(200)) as schemaName FROM @schemasXml.nodes('/schema') T(schemaName)) as X
JOIN information_schema.schemata S on S.schema_name = X.schemaName

OPEN @Cursor FETCH NEXT FROM @Cursor INTO @Sql

WHILE (@@FETCH_STATUS = 0)
BEGIN
PRINT @Sql
Exec (@Sql)
FETCH NEXT FROM @Cursor INTO @Sql
END

CLOSE @Cursor DEALLOCATE @Cursor
GO 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-11-27T13:21:11.197

这是我尝试过的：

```
SELECT 'DROP TABLE [' + SCHEMA_NAME(schema_id) + '].[' + name + ']' FROM sys.tables 
```

它将打印什么输出，只需复制所有内容并粘贴到新查询中，然后按执行。这将删除所有表。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-09-24T19:16:34.190

备份一个完全空的数据库。无需删除所有对象，只需恢复备份即可。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-04-30T00:21:10.990

今晚我不小心对我的主数据库运行了一个 db init 脚本。无论如何，我很快就遇到了这个线程。我使用了： exec sp_MSforeachtable 'DROP TABLE ?' 答案，但必须多次执行它，直到它没有错误（依赖关系）。之后我偶然发现了一些其他线程并将其拼凑在一起以删除所有存储过程和函数。

```
DECLARE mycur CURSOR FOR select O.type_desc,schema_id,O.name
from 
    sys.objects             O LEFT OUTER JOIN
    sys.extended_properties E ON O.object_id = E.major_id
WHERE
    O.name IS NOT NULL
    AND ISNULL(O.is_ms_shipped, 0) = 0
    AND ISNULL(E.name, '') <> 'microsoft_database_tools_support'
    AND ( O.type_desc = 'SQL_STORED_PROCEDURE' OR O.type_desc = 'SQL_SCALAR_FUNCTION' )
ORDER BY O.type_desc,O.name;

OPEN mycur;

DECLARE @schema_id int;
DECLARE @fname varchar(256);
DECLARE @sname varchar(256);
DECLARE @ftype varchar(256);

FETCH NEXT FROM mycur INTO @ftype, @schema_id, @fname;

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @sname = SCHEMA_NAME( @schema_id );
    IF @ftype = 'SQL_STORED_PROCEDURE'
        EXEC( 'DROP PROCEDURE "' + @sname + '"."' + @fname + '"' );
    IF @ftype = 'SQL_SCALAR_FUNCTION'
        EXEC( 'DROP FUNCTION "' + @sname + '"."' + @fname + '"' );

    FETCH NEXT FROM mycur INTO @ftype, @schema_id, @fname;
END

CLOSE mycur
DEALLOCATE mycur

GO 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-02-24T18:40:08.517

试试这个

```
Select 'ALTER TABLE ' + Table_Name  +'  drop constraint ' + Constraint_Name  from Information_Schema.CONSTRAINT_TABLE_USAGE

Select 'drop Procedure ' + specific_name  from Information_Schema.Routines where specific_name not like 'sp%' AND specific_name not like 'fn_%'

Select 'drop View ' + table_name  from Information_Schema.tables where Table_Type = 'VIEW'

SELECT 'DROP TRIGGER ' + name FROM sysobjects WHERE type = 'tr'

Select 'drop table ' + table_name  from Information_Schema.tables where Table_Type = 'BASE TABLE' 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-03-10T08:40:47.460

除了@Ivan 的回答，所有类型都需要包含在内

```
 /* Drop all Types */
DECLARE @name VARCHAR(128)
DECLARE @SQL VARCHAR(254)

SELECT @name = (SELECT TOP 1 [name] FROM sys.types where is_user_defined = 1 ORDER BY [name])

WHILE @name IS NOT NULL
BEGIN
    SELECT @SQL = 'DROP TYPE [dbo].[' + RTRIM(@name) +']'
    EXEC (@SQL)
    PRINT 'Dropped Type: ' + @name
    SELECT @name = (SELECT TOP 1 [name] FROM sys.types where is_user_defined = 1 AND [name] > @name ORDER BY [name])
END
GO 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-01-08T13:32:52.600

**您必须首先禁用`triggers`所有`constraints`。**

```
EXEC sp_MSforeachtable @command1="ALTER TABLE ? NOCHECK CONSTRAINT ALL"

EXEC sp_MSforeachtable @command1="ALTER TABLE ? DISABLE TRIGGER ALL" 
```

**之后，您可以生成用于删除对象的脚本**

```
SELECT 'Drop Table '+name FROM sys.tables WHERE type='U';

SELECT 'Drop Procedure '+name FROM  sys.procedures WHERE type='P'; 
```

**执行生成的语句。**

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-07-20T11:18:45.810

要删除 oracle 中的所有对象：

1) 动态

```
DECLARE
CURSOR IX IS
SELECT * FROM ALL_OBJECTS WHERE OBJECT_TYPE ='TABLE' 
AND OWNER='SCHEMA_NAME';
 CURSOR IY IS
 SELECT * FROM ALL_OBJECTS WHERE OBJECT_TYPE 
IN ('SEQUENCE',
'PROCEDURE',
'PACKAGE',
'FUNCTION',
'VIEW') AND  OWNER='SCHEMA_NAME';
 CURSOR IZ IS
 SELECT * FROM ALL_OBJECTS WHERE OBJECT_TYPE IN ('TYPE') AND  OWNER='SCHEMA_NAME';
BEGIN
 FOR X IN IX LOOP
   EXECUTE IMMEDIATE('DROP '||X.OBJECT_TYPE||' '||X.OBJECT_NAME|| ' CASCADE CONSTRAINT');
 END LOOP;
 FOR Y IN IY LOOP
   EXECUTE IMMEDIATE('DROP '||Y.OBJECT_TYPE||' '||Y.OBJECT_NAME);
 END LOOP;
 FOR Z IN IZ LOOP
   EXECUTE IMMEDIATE('DROP '||Z.OBJECT_TYPE||' '||Z.OBJECT_NAME||' FORCE ');
 END LOOP;
END;
/ 
```

2)静态

```
 SELECT 'DROP TABLE "' || TABLE_NAME || '" CASCADE CONSTRAINTS;' FROM user_tables
        union ALL
        select 'drop '||object_type||' '|| object_name || ';' from user_objects 
        where object_type in ('VIEW','PACKAGE','SEQUENCE', 'PROCEDURE', 'FUNCTION')
        union ALL
        SELECT 'drop '
        ||object_type
        ||' '
        || object_name
        || ' force;'
        FROM user_objects
        WHERE object_type IN ('TYPE'); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-01T20:47:46.380

对我来说似乎是一个相当危险的功能。如果您实施这样的事情，我会确保以某种方式妥善保护它，您将无法在每次事故中运行它。

正如之前建议的那样，您可以自己制作某种存储过程。在 SQL Server 2005 中，您可以查看此系统表以确定并找到您想要删除的对象。

```
select * from sys.objects 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-05-15T12:46:33.447

在这里我找到了删除所有 sp、函数和触发器的新查询

```
declare @procName varchar(500)
declare cur cursor 

for select [name] from sys.objects where type = 'p'
open cur
fetch next from cur into @procName
while @@fetch_status = 0
begin
    exec('drop procedure ' + @procName)
    fetch next from cur into @procName
end
close cur
deallocate cur 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-08-22T21:01:01.423

为了补充 Ivan 的答案，我还需要删除所有用户定义的类型，因此我将其添加到脚本中：

```
/* Drop all user-defined types */
DECLARE @name VARCHAR(128)
DECLARE @SQL VARCHAR(254)

SELECT @name = (select TOP 1 [name] from sys.types where is_user_defined = 1)

WHILE @name IS NOT NULL
BEGIN
    SELECT @SQL = 'DROP TYPE [dbo].[' + RTRIM(@name) +']'
    EXEC (@SQL)
    PRINT 'Dropped Type: ' + @name
    SELECT @name = (select TOP 1 [name] from sys.types where is_user_defined = 1)
END
GO 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-02-23T12:27:59.470

```
DECLARE @name VARCHAR(255)
DECLARE @type VARCHAR(10)
DECLARE @prefix VARCHAR(255)
DECLARE @sql VARCHAR(255)

DECLARE curs CURSOR FOR
SELECT [name], xtype
FROM sysobjects
WHERE xtype IN ('U', 'P', 'FN', 'IF', 'TF', 'V', 'TR') -- Configuration point 1
ORDER BY name

OPEN curs
FETCH NEXT FROM curs INTO @name, @type

WHILE @@FETCH_STATUS = 0
BEGIN
-- Configuration point 2
SET @prefix = CASE @type
WHEN 'U' THEN 'DROP TABLE'
WHEN 'P' THEN 'DROP PROCEDURE'
WHEN 'FN' THEN 'DROP FUNCTION'
WHEN 'IF' THEN 'DROP FUNCTION'
WHEN 'TF' THEN 'DROP FUNCTION'
WHEN 'V' THEN 'DROP VIEW'
WHEN 'TR' THEN 'DROP TRIGGER'
END

SET @sql = @prefix + ' ' + @name
PRINT @sql
EXEC(@sql)
FETCH NEXT FROM curs INTO @name, @type
END

CLOSE curs
DEALLOCATE curs 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-03-02T08:30:22.983

**用sql2012或更高版本试试这个，**

这将有助于按选定的模式删除所有对象

```
DECLARE @MySchemaName VARCHAR(50)='dbo', @sql VARCHAR(MAX)='';
DECLARE @SchemaName VARCHAR(255), @ObjectName VARCHAR(255), @ObjectType VARCHAR(255), @ObjectDesc VARCHAR(255), @Category INT;

DECLARE cur CURSOR FOR
    SELECT  (s.name)SchemaName, (o.name)ObjectName, (o.type)ObjectType,(o.type_desc)ObjectDesc,(so.category)Category
    FROM    sys.objects o
    INNER JOIN sys.schemas s ON o.schema_id = s.schema_id
    INNER JOIN sysobjects so ON so.name=o.name
    WHERE s.name = @MySchemaName
    AND so.category=0
    AND o.type IN ('P','PC','U','V','FN','IF','TF','FS','FT','PK','TT')

OPEN cur
FETCH NEXT FROM cur INTO @SchemaName,@ObjectName,@ObjectType,@ObjectDesc,@Category

SET @sql='';
WHILE @@FETCH_STATUS = 0 BEGIN    
    IF @ObjectType IN('FN', 'IF', 'TF', 'FS', 'FT') SET @sql=@sql+'Drop Function '+@MySchemaName+'.'+@ObjectName+CHAR(13)
    IF @ObjectType IN('V') SET @sql=@sql+'Drop View '+@MySchemaName+'.'+@ObjectName+CHAR(13)
    IF @ObjectType IN('P') SET @sql=@sql+'Drop Procedure '+@MySchemaName+'.'+@ObjectName+CHAR(13)
    IF @ObjectType IN('U') SET @sql=@sql+'Drop Table '+@MySchemaName+'.'+@ObjectName+CHAR(13)

    --PRINT @ObjectName + ' | ' + @ObjectType
    FETCH NEXT FROM cur INTO @SchemaName,@ObjectName,@ObjectType,@ObjectDesc,@Category
END
CLOSE cur;    
DEALLOCATE cur;
SET @sql=@sql+CASE WHEN LEN(@sql)>0 THEN 'Drop Schema '+@MySchemaName+CHAR(13) ELSE '' END
PRINT @sql
EXECUTE (@sql) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-01-22T09:11:22.653

再来一份样品

```
declare @objectId int,  @objectName varchar(500), @schemaName varchar(500), @type nvarchar(30), @parentObjId int, @parentObjName nvarchar(500)
declare cur cursor 
for 

select obj.object_id, s.name as schema_name, obj.name, obj.type, parent_object_id
from sys.schemas s
    inner join sys.sysusers u
        on u.uid = s.principal_id
        JOIN
        sys.objects obj on obj.schema_id = s.schema_id
WHERE s.name = 'schema_name' and (type = 'p' or obj.type = 'v' or obj.type = 'u' or obj.type = 'f' or obj.type = 'fn')

order by obj.type

open cur
fetch next from cur into @objectId, @schemaName, @objectName,  @type, @parentObjId
while @@fetch_status = 0
begin
    if @type = 'p'
    begin
        exec('drop procedure ['+@schemaName +'].[' + @objectName + ']')
    end

    if @type = 'fn'
    begin
        exec('drop FUNCTION ['+@schemaName +'].[' + @objectName + ']')
    end

    if @type = 'f'
    begin
        set @parentObjName = (SELECT name from sys.objects WHERE object_id = @parentObjId)
        exec('ALTER TABLE ['+@schemaName +'].[' + @parentObjName + ']' + 'DROP CONSTRAINT ' +  @objectName)
    end

    if @type = 'u'
    begin
        exec('drop table ['+@schemaName +'].[' + @objectName + ']')
    end

    if @type = 'v'
    begin
        exec('drop view ['+@schemaName +'].[' + @objectName + ']')
    end
    fetch next from cur into  @objectId, @schemaName, @objectName,  @type, @parentObjId
end
close cur
deallocate cur 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2014-06-26T10:16:31.843

试试这个....

```
USE DATABASE
GO
DECLARE @tname VARCHAR(150)
DECLARE @strsql VARCHAR(300)

SELECT @tname = (SELECT TOP 1 [name] FROM sys.objects WHERE [type] = 'U' and [name] like N'TableName%' ORDER BY [name])

WHILE @tname IS NOT NULL
BEGIN
    SELECT @strsql = 'DROP TABLE [dbo].[' + RTRIM(@tname) +']'
    EXEC (@strsql)
    PRINT 'Dropped Table : ' + @tname
    SELECT @tname = (SELECT TOP 1 [name] FROM sys.objects WHERE [type] = 'U' AND [name] like N'TableName%'  AND [name] > @tname ORDER BY [name])
END 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2009-02-11T11:21:08.870

没有单一的陈述可以用来实现这一目标。

您当然可以自己创建一个`stored procedure`用于执行这些不同管理任务的程序。

然后，您可以使用这条语句执行该过程。

```
Exec sp_CleanDatabases @DatabaseName='DBname' 
```

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2020-04-27T20:50:42.153

如果您正在开发，另一种选择是：

```
DROP SCHEMA public CASCADE;
CREATE SCHEMA public; 
```

# c# - WebClient + HTTPS 问题

> ID：536352
> 
> 赞同：62
> 
> 时间：2009-02-11T11:15:39.600
> 
> 标签：c#, https, webclient

我目前正在与第 3 方创建的系统集成。该系统要求我使用 XML/HTTPS 发送请求。第 3 方将证书发送给我，我安装了它

我使用以下代码：

```
using (WebClient client = new WebClient())
{
   client.Headers.Add(HttpRequestHeader.ContentType, "text/xml");

   System.Text.ASCIIEncoding  encoding=new System.Text.ASCIIEncoding();
   var response = client.UploadData(address, "POST", encoding.GetBytes(msg));
} 
```

此代码返回以下内容`WebException`：

> 基础连接已关闭：无法为 SSL/TLS 安全通道建立信任关系。

**更新**因为它是我正在使用的测试服务器，所以证书不受信任并且验证失败......要在测试/调试环境中绕过这个，创建一个新的`ServerCertificateValidationCallback`

```
ServicePointManager.ServerCertificateValidationCallback += new System.Net.Security.RemoteCertificateValidationCallback(bypassAllCertificateStuff); 
```

这是我的“假”回调

```
private static bool bypassAllCertificateStuff(object sender, X509Certificate cert, X509Chain chain, System.Net.Security.SslPolicyErrors error)
{
   return true;
} 
```

[在这里](http://developers.de/blogs/damir_dobric/archive/2006/06/29/585.aspx)和[这里](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.servercertificatevalidationcallback.aspx)阅读更多

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2011-04-03T23:29:05.090

允许所有证书的代码的最短符号实际上是：

```
ServicePointManager.ServerCertificateValidationCallback = delegate { return true; }; 
```

并且适用于这个错误。不用说，您应该提供一个实际检查证书并根据证书信息决定通信是否安全的实现。出于测试目的，请使用上面的代码行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-10-01T20:18:49.500

对于原始答案的 VB.NET 版本，请看这里（当需要使用“AddressOf”运算符连接事件时，转换器无法正常工作）。使用 WebClient() 或 HttpWebRequest() 对象之前的第一个代码：

```
ServicePointManager.ServerCertificateValidationCallback = New System.Net.Security.RemoteCertificateValidationCallback(AddressOf bypassAllCertificateStuff) 
```

..和连线的方法代码：

```
Private Shared Function bypassAllCertificateStuff(ByVal sender As Object, ByVal cert As X509Certificate, ByVal chain As X509Chain, ByVal [error] As System.Net.Security.SslPolicyErrors) As Boolean
    Return True
End Function 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-24T20:37:54.547

试试这个，它有效：

```
class Ejemplo
{
    static void Main(string[] args)
    {
        string _response = null;
        string _auth = "Basic";
        Uri _uri = new Uri(@"http://api.olr.com/Service.svc");

        string addres = @"http://api.olr.com/Service.svc";
        string proxy = @"http://xx.xx.xx.xx:xxxx";
        string user = @"platinum";
        string pass = @"01CFE4BF-11BA";

        NetworkCredential net = new NetworkCredential(user, pass);
        CredentialCache _cc = new CredentialCache();

        WebCustom page = new WebCustom(addres, proxy);
        page.connectProxy();

        _cc.Add(_uri, _auth, net);

        page.myWebClient.Credentials = _cc;

        Console.WriteLine(page.copyWeb());
    }

}

public class WebCustom
{
        private string proxy;
        private string url;
        public WebClient myWebClient;
        public WebProxy proxyObj;
        public string webPageData;

        public WebCustom(string _url, string _proxy)
        {
            url = _url;
            proxy = _proxy;
            myWebClient = new WebClient();
        }

        public void connectProxy()
        {
            proxyObj = new WebProxy(proxy, true);
            proxyObj.Credentials = CredentialCache.DefaultCredentials;
            myWebClient.Proxy = proxyObj;
        }

        public string copyWeb()
        { return webPageData = myWebClient.DownloadString(url); }
} 
```

# asp-classic - ADO varchars 中是否有受限制的字符？

> ID：536358
> 
> 赞同：0
> 
> 时间：2009-02-11T11:17:24.027
> 
> 标签：asp-classic, vbscript, ado, filesystemobject

我们的 Intranet 上有一个简单的文件浏览器，使用 ASP/vbscript 构建。这些文件由脚本读取并添加到 ADO 记录集（未连接到数据库），因此我们可以轻松地对内容进行排序：

```
 Set oFolderContents = oFolder.Files
        Set rsf = Server.CreateObject("ADODB.Recordset")
        rsf.Fields.Append "name", adVarChar, 255
        rsf.Fields.Append "size", adInteger
        rsf.Fields.Append "date", adDate
        rsf.Fields.Append "type", adVarChar, 255
        rsf.Open

        For Each oFile In oFolderContents
            if not left(oFile.Name, 3) = "Dfs" then 'Filter DFS folders
                rsf.AddNew
                rsf.Fields("name").Value = oFile.Name
                rsf.Fields("size").Value = oFile.Size
                rsf.Fields("date").Value = oFile.DateCreated
                rsf.Fields("type").Value = oFile.Type
            end if
        Next 
```

在一个特定文件夹中，我们收到一个错误：

```
Microsoft Cursor Engine error '80040e21'
Multiple-step operation generated errors. Check each status value. 
```

这指向线

```
rsf.Fields("name").Value = oFile.Name 
```

在上面的代码中。

我最初认为这是由长文件名引起的，但我检查了目录中所有文件的长度 - 虽然有些很长，但都在上面设置的 255 个字符的限制之下（最大的是 198 个字符长）。

有问题的文件夹中有近 2000 个 PDF，我无权更改内容，只是阅读（这是一个技术库）。这些文件的命名约定为“ID# - 论文标题”。有些具有特殊字符，例如 '、& 和 ( 或 ) - 其中一些是否会导致问题？我不记得以前有过这样的问题。我尝试在 Google 中搜索 ADO 中的特殊字符，但找不到任何似乎相关的内容。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T11:31:54.757

您是否尝试过使用 adVarWChar 作为名称列？

# .net - 为什么微软在 .net 3.5 SP1 之前使 JavaScriptSerializer 过时，之后又再次激活？

> ID：536359
> 
> 赞同：17
> 
> 时间：2009-02-11T11:17:43.760
> 
> 标签：.net, asp.net, json

JavaScriptSerializer 在 .net 3.5 SP1 之后并未过时。我应该使用 JavaScriptSerializer 还是之前推荐的 DataContractJsonSerializer？还有为什么它被淘汰了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-11T13:07:19.237

我很乐意使用`JavaScriptSerializer`- 但如果有疑问，请考虑第三种选择 - [Json.NET](http://james.newtonking.com/projects/json-net.aspx)。因为它是第 3 方，它与 MS 的决定无关......当然，这是一把双刃剑 - 但通常更容易将小修复应用于独立的第 3 方库。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T11:44:07.503

我还没有看到明确的解释。当 JavaScriptSerializer 被淘汰时，有不少人感到不安。

Scott Gu在他的博客上发表了[这条评论](http://weblogs.asp.net/scottgu/archive/2007/10/01/tip-trick-building-a-tojson-extension-method-using-net-3-5.aspx)，称他认为将其标记为过时没有意义。

> JavaScriptSerializer 目前被标记为过时 - 虽然我不确定为什么（今天要问别人这个问题）。它非常方便。请注意，过时并不意味着在 .NET 3.5 中删除 - 至少会支持另一个或两个版本（或者如果我能说服他们，则支持更长的版本）。

我想也许他确实说服了他们:-)

我继续使用 JavaScriptSerializer，因为它比 DataContractJsonSerializer 更直接。

# python - 远程执行任意 python 代码 - 可以吗？

> ID：536370
> 
> 赞同：7
> 
> 时间：2009-02-11T11:21:41.083
> 
> 标签：python, grid

我正在研究一个网格系统，它有许多非常强大的计算机。这些可用于非常快速地执行 python 函数。我的用户有许多 python 函数需要很长时间才能在工作站上计算，理想情况下他们希望能够在远程强大的服务器上调用一些函数，但让它看起来在本地运行。

Python 有一个名为“apply”的旧函数 - 现在 Python 支持扩展调用语法（例如 **arguments），现在它几乎没用了，但是我需要实现一些有点像这样的东西：

```
rapply = Rapply( server_hostname ) # Set up a connection
result = rapply( fn, args, kwargs ) # Remotely call the function
assert result == fn( *args, **kwargs ) #Just as a test, verify that it has the expected value. 
```

Rapply 应该是一个类，它可以用来`fn`在远程服务器上远程执行一些任意代码（可以是任何东西）。它将发回`rapply`函数将返回的结果。“结果”应该与我在本地调用该函数具有相同的值。

现在让我们假设这`fn`是一个用户提供的功能，我需要某种方式将其通过线路发送到执行服务器。如果我能保证 fn 总是很简单，它可能只是一个包含 python 源代码的字符串......但如果它不是那么简单呢？

如果`fn`可能有本地依赖项怎么办：它可能是一个简单的函数，它使用在不同模块中定义的类，是否有一种封装方式`fn`以及所有`fn`需要的不是标准库的东西？一个理想的解决方案不需要这个系统的用户对 python 开发有太多的了解。他们只是想编写他们的函数并调用它。

澄清一下，我对讨论可以使用哪种网络协议来实现客户端和服务器之间的通信不感兴趣。我的问题是如何将函数及其依赖项封装为可以序列化和远程执行的单个对象。

我也对在远程服务器上运行任意代码的安全隐患不感兴趣——我们只是说这个系统纯粹是为了研究而设计的，它位于一个防火墙环境中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T14:56:50.957

看看[PyRO](https://pyro4.readthedocs.io/en/stable/) （Python 远程对象），它能够在集群中的所有计算机上设置服务，并直接或通过名称服务器和发布-订阅机制间接调用它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T11:38:18.343

听起来您想要执行以下操作。

*   定义一个共享文件系统空间。

*   将你所有的 python 源代码放在这个共享的文件系统空间中。

*   定义将“执行文件”代码块的简单代理或服务器。

*   然后，您的客户端使用代码块联系代理（带有 POST 方法的 REST 协议
    对此非常有效）。代理保存代码块并对该`execfile`代码块执行操作。

由于所有代理共享一个公共文件系统，它们都具有相同的 Python 库结构。

我们使用一个简单的 WSGI 应用程序，我们称之为“批处理服务器”。我们有用于创建和检查远程请求的 RESTful 协议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T12:57:51.100

[Stackless](http://pypy.readthedocs.org/en/latest/stackless.html#unimplemented-features)有能力对正在运行的代码进行腌制和解封。不幸的是，当前的实现不支持此功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T14:21:54.190

您可以使用现成的集群解决方案，例如[Parallel Python](http://www.parallelpython.com)。您可以相对轻松地设置[多个远程从站并在它们上运行任意代码](http://www.parallelpython.com/content/view/15/30/#QUICKCLUSTERS)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T12:55:01.483

您可以使用 SSH 连接到远程 PC 并直接在另一台机器上运行命令。您甚至可以将 python 代码复制到机器上并执行它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-16T05:20:41.327

# 句法：

猫./test.py | sshpass -p 'password' ssh user@remote-ip "python - script-arguments-if-any for test.py script"

1）这里的“test.py”是本地python脚本。2) sshpass 用于将 ssh 密码传递给 ssh 连接

# math - 坐标系转换

> ID：536372
> 
> 赞同：0
> 
> 时间：2009-02-11T11:22:12.720
> 
> 标签：math

我有一个游戏世界，其中有许多不规则物体，它们具有不同的坐标系，控制着物体表面的工作方式。然而，相机和这些对象可以离开并移出到使用正常笛卡尔坐标系的空旷空间中。如何管理两者之间的映射？

我的一个想法是将这些对象包装在诸如球体或盒子之类的范围内，在该范围内将使用所述坐标系，但是如果这些边界对象重叠，这将成为问题，此时我不确定这个想法是否是根本上存在缺陷或可以找到解决方案，因为这些对象正在移动并且可能在某个点重叠

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T11:44:33.070

我认为您应该通过不规则对象坐标系与位置矩阵的组合将所有对象放置在笛卡尔“空白空间”坐标系中。

它增加了一个级别，但会使一切变得更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T13:09:26.127

关于边界的使用，我有一个想法，对象将使用它占用的最小边界的坐标系，然后根据系统的层次结构从上到下进行变换。

因此，假设与大型物体相邻的圆柱体上的简笔画将跟随圆柱体，而不是在两个物体及其坐标系之间来回穿梭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T11:43:45.070

不管每个不规则对象周围的局部坐标系如何，所有点仍将在一个或另一个点映射到全局世界坐标，因为最终当您要渲染对象时，它们必须先映射到世界空间，然后再映射到相机空间. 您可以使用相同的对象空间到世界空间变换矩阵来进行映射。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T12:17:09.280

您可以使用 Lame 系数来转换不同坐标系的维度。

您可以转换任何类型的坐标系，也可以转换您自己的坐标系。唯一的条件是具有正交维度（每个维度都必须独立于其他维度）。

这是我找到的一些文件：[链接文本](http://math.arizona.edu/~vpiercey/Lame.pdf)。

希望能帮助到你。

# java - 从窗口服务运行 jar 应用程序时，环境变量中的用户变量值在运行时未获取？

> ID：536378
> 
> 赞同：2
> 
> 时间：2009-02-11T11:24:31.233
> 
> 标签：java, runtime.exec

我使用了一种方法“System.getenv();” 在 jar 应用程序中获取用户定义的环境变量的值。我已经让 jar 应用程序从窗口服务运行。但是当我尝试启动服务时，它没有获取用户定义的环境变量的值并显示空指针异常。我已经尝试在“System.getenv("JAVA_HOME");”中使用系统变量名 方法，通过获取相应的值可以正常工作。环境变量中的用户变量有什么错误。我应该在代码中做任何事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T12:53:30.487

我确认 Windows 服务默认以“本地系统帐户”运行，它不访问用户环境。

您可以使用服务的用户帐户登录。

[替代文字 http://www.adobe.com/devnet/contribute/articles/cps_autodeploy/fig06.gif](http://www.adobe.com/devnet/contribute/articles/cps_autodeploy/fig06.gif)

但请注意，在您的计算机重新启动之前，您的服务**不会知道环境变量的** ***变化！***（请参阅此[Microsoft 技术](http://support.microsoft.com/kb/821761)说明或此[SO 问题](https://stackoverflow.com/questions/305870)）：

> `[`您的服务`]`将从**Services.exe**进程继承其环境。
> 当 Windows 启动时，Services.exe 进程接收本地系统帐户的环境设置。
> 由于 Services.exe 进程不使用 Windows 消息传递，因此当它接收到指示在 Windows 启动后值已更改的消息时，Services.exe 进程不会更新其环境设置。
> 您不能强制正在运行的服务确认本地系统帐户环境的动态更改。

这可能不是问题`JAVA_HOME`（它不会经常改变），但可能是其他动态设置的环境变量。

* * *

如果这成为一个问题（例如，如果您无法使用给定的用户帐户启动服务），您可以在您的 java 程序中嵌入一个***run as***命令，以便查询注册表并获取您的环境的当前值多变的

```
 String  commands [] = new String [] {
    "CMD.EXE",
    "/C",
    "RUNAS   /savecred /user:" 
    + username 
    + " " + "regedit.exe"
  };

  Runtime.getRuntime().exec(commands); 
```

with username = 当前连接的用户的登录名（如果没有人连接，则需要跳过基于 USER 环境变量的程序的所有部分）

然后，您将能够[查询窗口注册表](http://www.rgagnon.com/javadetails/java-0480.html)，直接读取存储在其中的“用户变量”（它们保存在 中`HKEY_CURRENT_USER\Environment`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T11:34:37.620

Windows 服务代表系统而不是特定用户运行。我相信您可以将服务配置*为*以特定用户身份运行，此时您*可能会*获得相关的环境变量 - 但使用属性文件或类似文件配置应用程序会好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T19:28:46.327

A windows service gets the user environment of the user the service runs as.

# vb6 - 您如何处理 VB6 中的错误处理程序中的错误？

> ID：536379
> 
> 赞同：4
> 
> 时间：2009-02-11T11:25:16.813
> 
> 标签：vb6, error-handling

我在我的 VB6 应用程序中经常遇到这种情况

```
Private Sub DoSomething

  On Error Goto err1

  Call ProcessLargeBatch1
  Call ProcessLargeBatch2
  '... more ...'

  Exit Sub

err1:
  Call Cleanup 'Specific for DoSomething'
  Call HandleError 'General error handling: Logging, message box, ...'

End Sub 
```

Cleanup 过程有时会恢复操作、回滚事务、删除临时文件等。在大多数情况下，此操作也可能失败。

在这种情况下我该怎么办？我会`On Error Resume Next`在错误处理程序中添加一个，但这会删除现有`Err`对象。添加错误处理程序`Cleanup`有同样的问题。

确保原始错误仍然得到处理/记录的最佳方法是什么？

**编辑**：另一个问题是我还想通知用户错误。有时重要的是，清理发生得很快，我不希望消息框长时间阻塞应用程序并在用户确认错误后进行清理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T11:45:10.153

首先，从 Err 对象中读取您需要的所有信息，即编号、描述等，然后清除错误并执行您想要的操作。

更改通知用户使用缓存的值的方式，而不是使用 Err 对象本身。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T13:15:38.967

从您的示例中，您正在正确地进行清理。您的 HandleError 应该只记录错误而不执行任何 UI。UI 在表单级别处理。

发生错误时您需要做的是

1.  清理
2.  记录错误
3.  通过 Err.Raise 再次引发错误

这将在调用堆栈向上到达调用原始代码的事件。然后序列将变为

1.  清理
2.  记录错误
3.  显示错误通知对话框

请注意，您的错误日志记录可以是智能的，因为相同错误的后续日志可以添加到记录的调用堆栈中。

您要确保每个事件都有一个错误处理程序。不是每个程序都需要一个，但绝对是每个事件。事件中未处理的错误将导致 VB6 应用程序意外关闭。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T12:03:34.430

如果我可以在一个地方处理所有错误，我通常会放入这样的结构中：

```
Public Sub SubThatShouldHandleErrors()
Const ROUTINE_NAME = "SubThatShouldHandleErrors"
On Error Goto Catch

    ' "normal" processing here...

Finally:
    ' non-error case falls through to here
    ' perform clean-up that must happen even when an error occurred
    On Error Goto 0 ' reset: not really needed any more, but it makes me feel more comfortable
    Exit Sub

Catch:
    ' Error handling here, I may have logging that uses ROUTINE_NAME
    Resume Finally

End Sub 
```

如果我需要多个错误处理程序，我会非常努力地重组我的代码以使其不再是这种情况，但如果绝对必要，我会编写一个自定义处理程序；我的模板只是一个指导方针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T11:31:22.183

首先记录您的错误。然后执行 On Error Resume Next。将您的清理封装在具有自己的错误处理的方法中。这应该是你最好的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T11:42:33.857

我真的很不喜欢错误处理程序。这就是我所做的；

*   创建一个包含内置的所有属性的错误类或模块，以及一个从错误对象填充这些属性的 CopyError 方法。
*   注意可能出现的错误：

.

```
' lots of code that will probably work
On Error Resume Next
Open "c:\filethatdoesntexist.txt" For Input As #1
Error.CopyError
On Error Goto 0
Select Case Error.Number
    Case 53'File doesn't exist
        ' handle that error here
    Case 0
        ' no error
    Case Else
        ' Just throw the error on
        Err.Raise Error.Number, Error.Description, ...
End Select
' more code that will probably work 
```

# delphi - 如何改变 TDBNavigator 组件的行为？

> ID：536382
> 
> 赞同：7
> 
> 时间：2009-02-11T11:25:46.253
> 
> 标签：delphi, components, vcl

我想将标准 DBNavigator 栏上的插入按钮的行为从数据集插入更改为追加。

我可以在 BeforeAction 事件中捕获按钮单击，执行附加等；然后在 OnClick 事件中中止原始插入，但这似乎有点 hack。有更好的想法吗？我正在使用 D6（500,000 公里的时钟，并且仍然很强劲......）。

感谢您的任何建议

问候，

菲尔W。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T12:06:06.327

您可以从 TDBNavigator 派生您自己的类并覆盖 BtnClick 方法。或者，为了快速而肮脏的修复，您可以在运行时更改插入按钮的单击处理程序，例如：

```
type
  THackDBNavigator = class(TDBNavigator);

procedure TForm1.DBNavigatorInsertClick(Sender: TObject);
var
  DBNavigator: TDBNavigator;
begin
  DBNavigator := ((Sender as TControl).Parent as TDBNavigator);
  if Assigned(DBNavigator.DataSource) and (DBNavigator.DataSource.State <> dsInactive) then
  begin
    if Assigned(DBNavigator.BeforeAction) then
      DBNavigator.BeforeAction(DBNavigator, nbInsert);

    DBNavigator.DataSource.DataSet.Append;

    if Assigned(DBNavigator.OnClick) then
      DBNavigator.OnClick(DBNavigator, nbInsert);
  end;
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  THackDBNavigator(DBNavigator1).Buttons[nbInsert].OnClick := DBNavigatorInsertClick;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T12:14:19.833

在大多数数据库中插入和追加之间没有区别。进行实际的物理插入将意味着实际移动所有数据，从插入新行的位置开始，减小一行的大小，然后在新打开的位置写入新行。由于所有磁盘活动，这将非常慢。

数据库改为执行追加操作，将数据写入物理文件的末尾，并且索引顺序控制行在文件中正确位置的显示方式。

因此，对于大多数意图和目的，您可能已经获得了追加而不是插入，无论您使用哪种方法或 DBNavigator 上的按钮说什么。它是使它以其他方式出现的索引。

您可以通过创建没有索引的数据库来检查其有效性，并尝试执行几次插入和追加，在每次操作后仔细检查数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T13:39:39.660

@TOndrej：太好了！我没有欣赏过这种技术。谢谢！

@Ken White：我理解你的意思，但在视觉上对我的用户来说会有所不同——DBNavigator 控制一个 DBGrid，在大多数情况下，网格中有很多未使用的行。让新记录出现在网格底部而不是刚好在当前记录所在的位置上方似乎更加一致。但是谢谢你的回答。

问候，菲尔W。

# objective-c - 自变量和变量差异

> ID：536388
> 
> 赞同：5
> 
> 时间：2009-02-11T11:27:42.427
> 
> 标签：objective-c, cocoa-touch, cocoa, declared-property

当我使用/创建 `myVariable?`self.myVariable = obj;`和之间有什么区别？`myVariable = obj;``@propery``@synthesize`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-20T18:29:46.877

值得注意的是，点语法被编译器转换为简单的 objc_msgSend 调用：也就是说，在它下面的行为与发送给该变量访问器的消息完全一样。因此，以下所有三个都是等效的：

```
self.myVariable = obj;

[self setMyVariable:obj];

objc_msgSend(self, @selector(setMyVariable:), obj); 
```

当然，这意味着使用点语法实际上会导致完整的消息发送，这意味着调用一个新函数以及与之相关的所有开销。相比之下，使用简单赋值 (myVariable = obj;) 不会产生任何开销，但它当然只能在相关类的实例方法中使用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-11T12:01:53.420

@synthesize 指令告诉编译器根据 .h 文件中 @property 指令中给出的规范为您的成员变量生成访问器。（即如果你指定retain，setter会保留变量，如果你指定copy，它会复制它。）

访问器将（除非您另外指定）被命名为 propertyName 和 setPropertyName。

使用 。表示法（注意，不是上面所说的 self 语法）表示您要使用访问器（例如，如果您正在设置字符串并希望确保保留计数是正确的，这是一件好事）。

因此，在您的类实现中：

*   self.bill = fred 将调用访问器 setBill。
*   bill = fred 将直接将 bill 设置为 fred，无需通过访问器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-16T06:44:04.033

我在开始 Cocoa 开发时发现的差异之一是，如果我将变量设置为使用 @Property/@Synthesize 语法并且我没有使用**self.myVariable = obj**或**[self setMyVariable:obj]**而是使用 **myVariable = obj**，那么如果稍后释放**obj** ，则不会保留对象。（假设 @Property 设置为使用保留。）

原因是使用**myVariable = obj**时未设置保留计数，当释放 obj 时，计数现在为零。（除非你自己保留它）但是通过使用访问器它会为你做保留计数。（再次假设您在声明时将其设置为使用保留）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-12T15:59:25.263

害羞

如果我可以为此添加一个重要说明。上面的答案都很棒，所以我不会添加到技术方面。但这只是：

如果您创建合成属性

```
@synthesize myProp; 
```

始终使用**self.myProp**模式来设置它。

```
self.myProp = newVal; 
```

这似乎很明显，但很重要。确实没有理由这样做，但是在您真正了解合成 setter 是如何创建的之前，您只想假设您必须使用 self。模式来设置值。

诚实：这将为您节省很多深夜调试会话。非保留内存访问违规是最难调试的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-11T11:34:22.613

该`self`语法使用访问器方法，其他语法不使用。如果访问者所做的不仅仅是分配新值，这可能是一个很大的区别。请参阅 Objective-C 教程的[声明属性](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/ObjectiveC/Articles/chapter_5_section_1.html#//apple_ref/doc/uid/TP30001163-CH17-SW1)部分。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-11T13:33:44.027

其他答案是正确的，不同之处在于点符号导致 ivar 通过附件而不是直接更改。

在您知道自己在做什么之前，我建议您使用点表示法（即`self.propertyName = ...`）。Cocoa/Obj-C 在键值编码方面做了很多工作，虽然手机 SDK 没有充分利用这一点（比如绑定），但最终它会。现在习惯使用访问器将在将来为您省去很多麻烦。

使用访问器方法还可以让您有机会覆盖它们并在需要时提供更多功能。通过简单地更改 ivar 的值，您就剥夺了自己的这种能力。

# excel - 激活范围，允许编辑，继续

> ID：536392
> 
> 赞同：0
> 
> 时间：2009-02-11T11:29:24.370
> 
> 标签：excel, vba

作为我的问题的次要方法：[在用户窗体上显示单元格范围；然后更新](https://stackoverflow.com/questions/511488/show-cell-range-on-userform-then-update)

我想要一个宏来选择一个范围并激活它，但允许用户编辑该范围内的单元格。然后，它需要有一个按钮可以移动到下一个范围。有没有办法保持表单可见，但允许用户访问范围？

如果可能的话，我可以在更新期间暂时锁定范围内的所有其他单元格，以避免错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T11:55:17.443

您可以在“无模式”状态下显示表单，这意味着用户未锁定到该表单：

```
Dim interactionForm As New DemoForm

interactionForm.Show vbModeless 
```

您还可以根据您想要执行的操作以编程方式锁定和解锁某些单元格范围：

```
Dim bigRange As Range
Set bigRange = Sheet1.Range("SomeRange")

Sheet1.Cells.Locked = True
bigRange.Locked = False
Sheet1.Protect "password1" ' add other options here 
```

使用它，您可以锁定工作表上的所有单元格，但解锁您希望它们编辑的范围。您甚至可以将该范围着色为绿色或其他颜色，以强制执行您希望他们执行的操作。

完成后不要忘记解锁所有内容！

```
Sheet1.Unprotect "password1"
Sheet1.Cells.Locked = False 
```

# objective-c - 在 Objective-C 中，Java 的“instanceof”关键字等价于什么？

> ID：536396
> 
> 赞同：191
> 
> 时间：2009-02-11T11:32:34.037
> 
> 标签：objective-c, types, casting, equality, downcast

我想检查一个对象（例如`someObject`）是否可分配（可转换）给另一种类型的变量（例如`SpecifiedType`）。在 Java 中，我可以写：

```
someObject instanceof SpecifiedType 
```

一个相关的问题是查找对象的运行时类型是否等于另一种类型。在 Java 中，我可以写：

```
someObject.getClass().equals(SpecifiedType.class) 
```

如何在 Objective-C 中做到这一点？

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2009-02-11T11:35:36.620

尝试`[myObject class]`返回对象的类。

您可以与以下内容进行精确比较：

```
if ([myObject class] == [MyClass class]) 
```

但不是直接使用`MyClass`标识符。

同样，您可以通过以下方式查找对象是否属于您的类的子类：

```
if ([myObject isKindOfClass:[AnObject class]]) 
```

正如 Jon Skeet 和 zoul 所建议的那样。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-02-11T11:38:02.650

来自[维基百科](http://en.wikipedia.org/wiki/Introspection_(computer_science)#Objective-C)：

> 例如，在 Objective-C 中，泛型`Object`和`NSObject`（在 Cocoa/OpenStep 中）都提供方法 ，如果方法的参数是指定类的实例，则该方法`isMemberOfClass:`返回。如果参数继承自指定的类，则`true`该方法类似地返回 true。`isKindOfClass:`

`isKindOfClass:`听上去最接近`instanceof`。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-11T11:40:34.843

请参阅[NSObject](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html)文档中的[isKindOfClass:](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/occ/intfm/NSObject/isKindOfClass:)方法。（对于此类问题，通常的警告词是检查对象类通常是做错事的标志。）

# fxcop - 如何让 FxCop 规则 CA1726 忽略首选术语？

> ID：536398
> 
> 赞同：8
> 
> 时间：2009-02-11T11:33:49.167
> 
> 标签：fxcop, suppression

FxCop 有一个[规则 (CA1726)](https://msdn.microsoft.com/en-gb/library/ms182258.aspx)检查首选术语。这会查找诸如“不要”之类的词，并告诉您用更好的词（例如“不要”）替换它们。通常这很好，但是它反对的术语之一是“标志”。在我们公司，业务涉及旗帜，意思是旗杆末端的那些布料。每次都压制这条规则正在成为一种痛苦。有谁知道让这条规则适用于除“标志”之外的所有内容的方法吗？

注意：我知道我可以完全关闭规则，但我不想这样做。我只想关闭部分规则。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T13:02:42.773

我已经回答了我自己的问题。

事实证明，首选术语列表列在 FxCop 安装目录 (C:\Program Files\Microsoft FxCop 1.36\CustomDictionary.xml) 中的 CustomDictionary.xml 文件中。<Dictionary><Words><Deprecated> 部分包含许多 <Term> 元素。简单地删除我不想要的就可以了。

# iphone - 如何更改图像和禁用 UIBarButtonItem

> ID：536399
> 
> 赞同：9
> 
> 时间：2009-02-11T11:33:50.540
> 
> 标签：iphone, cocoa-touch

我有一个带有两个视图的 NavigationBar 应用程序：父视图和子视图。在子视图中，我在右上角添加了一个按钮，如下所示：

```
- (void)viewDidLoad {
    UIBarButtonItem *tempButton = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"lock-unlocked.png"] style:UIBarButtonItemStylePlain target:self action:@selector(lockScreen)];
    self.navigationItem.rightBarButtonItem = tempButton;
    [tempButton release];
} 
```

单击该按钮时，我想更改此 rightBarButtonItem 的图像并禁用 leftBarButtonItem （由控制器自动添加）。一个按钮基本上有两种状态，锁定和解锁。

问题 1：我能找到如何更改图像的唯一方法是使用新图像创建一个新的 UIButtonItem 并用该新图像替换 rightBarButtonItem。但我想知道是否有办法只更改图像而不创建新的 UIBarButtonItem。如果我继续创建新的 UIBarButtonItem，是否会造成内存泄漏？

问题 2：如何获取 self.navigationItem.leftBarButtonItem 并禁用/启用它？我不是手动创建的，它是由控制器自动为我创建的。我在 UIBarButtonItem 上没有看到任何方法/属性来启用/禁用用户与之交互。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-11T12:40:24.140

问题一：在界面中声明UIBarButtonItem *tempButton

```
@interface MyAppDelegate : NSObject <UIApplicationDelegate> {
    UIBarButtonItem *tempButton;
}

@property (nonatomic, retain) UIBarButtonItem *tempButton; 
```

并在实现中综合它。

```
@synthesize tempButton; 
```

在 viewDidLoad 中创建与您现在类似的对象。

```
- (void)viewDidLoad {
  tempButtom = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"lock-unlocked.png"] style:UIBarButtonItemStylePlain target:self action:@selector(lockScreen)];
  self.navigationItem.rightBarButtonItem = tempButton;
} 
```

但是不要在这里释放它，在通常在底部找到的dealloc方法中释放它。

然后当调用 lockScreen 时

```
tempButton.image = [UIImage imageNamed:@"myImage.png"] 
```

恐怕我没有问题2的答案！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-23T08:18:36.550

关于问题 2，使用“启用”属性：

```
 self.navigationItem.leftBarButtonItem.enabled = NO; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-08-24T09:09:33.997

我不明白你是否有一个导航控制器，但在这种情况下要禁用后退按钮，你需要调用：

```
self.navigationItem.hidesBackButton = YES; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-17T19:52:18.693

上面不应该在 [self.window addSubView:l] 调用之后释放 UILabel *l 吗？这样它在添加到子视图时会保留 +1，但在同一分支中释放 -1。否则，您必须调用 disableLeftBarButtonItemOnNavbar:NO 来释放它。虽然最终你会在同一个地方结束，但你没有泄漏，我认为他们内置在 XCode 中的静态分析工具不喜欢在单独的分支中。小细节:-)

```
- (void) disableLeftBarButtonItemOnNavbar:(BOOL)disable
{
    static UILabel *l = nil;

    if (disable) {
        if (l != nil)
            return;
        l = [[UILabel alloc] initWithFrame:CGRectMake(0, 20, 160, 44)];
        l.backgroundColor = [UIColor clearColor];
        l.userInteractionEnabled = YES;
        [self.window addSubview:l];
        [l release];
    }
    else {
        if (l == nil)
            return;
        [l removeFromSuperview];
        l = nil;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-13T06:38:14.883

我无法通过以下方式禁用/灰显 NavBar 按钮：

```
self.navigationItem.leftBarButtonItem.enabled = NO; 
```

...但是隐藏后退按钮效果很好！

```
self.navigationItem.hidesBackButton = YES; 
```

谢谢扎米尔！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-31T12:12:23.947

使用“hidesBackButton=YES”确实不是一个优雅的解决方案，因为它隐藏了我们不想要的按钮。一个可接受的解决方法是在窗口中添加一个 UILabel 到后退按钮上方，至少禁用按钮上的触摸。

将此方法添加到您的 AppDelegate 类：

```
- (void) disableLeftBarButtonItemOnNavbar:(BOOL)disable
{
    static UILabel *l = nil;

    if (disable) {
        if (l != nil)
            return;
        l = [[UILabel alloc] initWithFrame:CGRectMake(0, 20, 160, 44)];
        l.backgroundColor = [UIColor clearColor];
        l.userInteractionEnabled = YES;
        [self.window addSubview:l];
    }
    else {
        if (l == nil)
            return;
        [l removeFromSuperview];
        [l release];
        l = nil;
    }
} 
```

您可以从任何视图控制器中这样调用它来禁用：

```
MyAppDelegate *appDeleg = (MyAppDelegate *) [[UIApplication sharedApplication] delegate];
[appDeleg disableLeftBarButtonItemOnNavbar:YES]; 
```

启用：

```
MyAppDelegate *appDeleg = (MyAppDelegate *) [[UIApplication sharedApplication] delegate];
[appDeleg disableLeftBarButtonItemOnNavbar:NO]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-11T06:31:14.597

我认为这段代码可以帮助你，

```
UIButton *m_objbtnFlip= [[UIButton alloc] initWithFrame:CGRectMake(0,0,89, 37)];
    [m_objbtnFlip setBackgroundImage:[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"btn_purchased"
                                                                                                 ofType:IMAGETYPE]]
                       forState:UIControlStateNormal];
    [m_objbtnFlip setBackgroundImage:[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"btn_allavailable"
                                                                                                 ofType:IMAGETYPE]]
                       forState:UIControlStateSelected];
    [m_objbtnFlip addTarget:self action:@selector(flipViews) forControlEvents:UIControlEventTouchUpInside];

    UIBarButtonItem *objBarButtonItemRight = [[UIBarButtonItem alloc] initWithCustomView:m_objbtnFlip];

    self.navigationItem.rightBarButtonItem=objBarButtonItemRight;
    [objBarButtonItemRight release];
    objBarButtonItemRight = nil; 
```

并在这里写下动作，

```
-(void)flipViews    {
   // put action code here
} 
```

# c# - LINQ 中的实体附件问题

> ID：536400
> 
> 赞同：17
> 
> 时间：2009-02-11T11:34:10.537
> 
> 标签：c#, asp.net-mvc, linq-to-sql

从表单 POST 收到 LINQ 实体后，我试图将其附加到数据上下文。但是，我得到的只是以下异常：

```
An entity can only be attached as modified without original state if it declares a version member or does not have an update check policy. 
```

我也尝试过附加原始行，如下所示：

```
dataContext.People.Attach(person, originalPerson); 
```

在这种情况下，我得到以下异常：

```
Object reference not set to an instance of an object. 
```

这是我的控制器中的代码：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(int id, Person person) {
    var prevPerson = dataContext.People.Single(p => p.ID == id);
    dataContext.People.Attach(person, prevPerson);
    dataContext.SubmitChanges();
    return Redirect("~/People/Index");
} 
```

关于我在这里做错了什么的任何想法？如果需要，我可以发布实体代码。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-01-30T12:44:58.533

尝试以下操作：

```
dataContext.People.Attach(person);
dataContext.Refresh(RefreshMode.KeepCurrentValues, person);
dataContext.SubmitChanges(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-11T17:36:22.430

在 LinqToSQL 设计器中，将所有更新检查设置为从不，并且在附加时调用它，如下所示：

```
 context.entity.Attach(entity, true); 
```

或者，您也可以从数据库中获取实体并使用 POSTed 实体中的数据对其进行更改，然后将其作为更改提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-04T12:53:28.623

我通过`UpdateCheck=Never`在 .Dbml 文件中设置我的属性来 解决`context.entity.Attach(entity, true);`

# open-source - 托管项目元搜索引擎

> ID：536424
> 
> 赞同：0
> 
> 时间：2009-02-11T11:44:21.310
> 
> 标签：open-source, search-engine, code-search-engine, project-hosting

有[无数](http://en.wikipedia.org/wiki/Comparison_of_free_software_hosting_facilities)可用的站点，如[sourceforge](http://sourceforge.net/)、[github](http://github.com/)、[berlios](http://www.berlios.de/)、[ruby​​forge](http://rubyforge.org/)和许多其他托管开源项目的站点，我一直想知道是否有专门的搜索引擎可以对这些不同站点上的所有可用项目进行分类。

我不是在谈论搜索实际源代码（如[koders](http://www.koders.com/)或[google codesearch](http://www.google.com/codesearch) ）的搜索引擎，而是对项目本身进行编目的东西。

例如，如果我正在搜索开源文件比较/合并实用程序。我可能会把“文件比较”放到这个搜索引擎中，然后得到一堆匹配的项目。我什至可以根据操作系统、实现语言、许可证或其他标准来缩小搜索范围。

我能想到的最接近的是[freshmeat](http://freshmeat.net/)，尽管在这种情况下项目所有者必须将信息提交给freshmeat，但它不会蜘蛛出信息本身。 [Krugle](http://www.krugle.org/)确实有一个“开源项目”选项卡，但每当我点击它时，页面就会重新加载，所以这并没有真正的帮助......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T03:17:09.297

有[http://www.ohloh.net](http://www.ohloh.net)以类似 wiki 的方式，有人必须提交有关项目的信息。然后他们的爬虫接管并提供有关该项目的数据。

# c# - 在不级联删除的情况下解决对数据模型的依赖关系

> ID：536425
> 
> 赞同：0
> 
> 时间：2009-02-11T11:44:27.440
> 
> 标签：c#, data-modeling, dependencies

数据模型：

tTemplate (TemplateId int PK)
tPage (PageId int PK, TemplateId int FK)
tEmailMessage (EmailMessageId int PK, TemplateId int FK)

要求：

只有在没有依赖关系的情况下才允许删除模板。

TemplateService 负责删除模板：

新模板服务（）。删除（我的模板）；

Page 和 Email 模块依赖于 Template 模块，而后者又很高兴地不知道这些依赖关系。在某些设置中，页面或电子邮件模块将不存在。我将如何解决对底层数据模型的依赖？如何让 TemplateService 开始查询以了解是否可以删除该项目？

我对 EventBrokers 和 Message Queues 进行了一些研究，但看不到它们如何单独帮助我。我也看不到单独使用 .net 事件模型如何解决这个问题。

我并不是真的在寻找一种维护数据完整性的方法，而是一种允许服务间通信而不会导致不必要的服务依赖的方法。我可能有一个 PageService 的实现，可以在其中删除模板，并且可以通过将 tPage.TemplateId 设置为 null 来解决依赖关系。在其他实现中，我可能想要创建级联删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T11:52:26.780

这就是您的后备存储应该实现参照完整性的原因。在可能的情况下，您的模型将实现相同的功能，但只有在没有引用任何内容的情况下，删除才会起作用。

此外，我建议不要在尝试删除之前检查所有数据，因为您最终可能会遇到可能导致问题的竞争条件。从效率的角度来看，您可以从一开始就简单地实现级联删除，假设您的顶级对象总是有子行。

.Net 模型仅在您拥有所有数据时才保证引用完整性，否则只会尝试删除，而不是保证。

# c - 用 C 在内存中查找程序代码

> ID：536429
> 
> 赞同：0
> 
> 时间：2009-02-11T11:45:33.023
> 
> 标签：c, pointers, memory

如果我在 C 中有一个字符串格式化程序，它只包含一个文件，是否可以找到该文件在内存中的位置并让正在运行的程序处理它自己的源文件？

当 C 程序运行时，是否可以定义一个指向实际代码的指针并对其进行处理？

我不想打开并读取源文件，而是从内存中进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T11:49:46.693

通常 C 在运行之前被编译。这意味着源代码被翻译成可执行的机器指令。因此，当您运行程序时，源代码可能在内存中不可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T11:51:49.123

你的意思是你的程序分析机器代码？还是C源？

您的 C 程序一旦被编译，就不再是 C 语言了，所以正在运行的程序将是机器代码，而不是 C。

为什么不想从磁盘打开源文件？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T11:58:28.343

我不知道我是否正确理解了这个问题，但我试了一下：

您可以使用该`__FILE__`指令访问 C 软件源文件的路径名。将它用于显示它以外的目的意味着它自上次编译以来没有移动或消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-27T17:26:03.597

> 当 C 程序运行时，是否可以定义一个指向实际代码的指针并对其进行处理？

我想您可以通过使用函数指针来获取函数的地址，并通过将其转换为整数指针来读取/写入。然而，由于许多原因，这将是非常不寻常、困难和危险的。对于编写代码，机器代码可以位于内存的只读部分中。此外，您必须将机器代码写入内存。

# c# - 将 180 更改为 03:00 的简单方法

> ID：536430
> 
> 赞同：2
> 
> 时间：2009-02-11T11:45:33.693
> 
> 标签：c#, time, formatting

嘿！我正在尝试将秒数更改为正确的时间戳格式。就像我这样做是为了将 180 更改为 03:00

```
private void writeTime(int tempo)
        {
            TimeSpan otempo = new TimeSpan(0, 0, tempo);        

            string minutos = ((otempo.Minutes <= 9) ? "0" : "") + otempo.Minutes.ToString();
            string segundos = ((otempo.Seconds <= 9) ? "0" : "") + otempo.Seconds.ToString();

            label1.Text = minutos + ":" + segundos;

            centrarLabel();
        } 
```

这确实给了我 180 的正确格式。我只是想知道是否有更简单的方法。这个函数可能会被调用很多次，我不想每次都创建一个新的 TimeSpan 实例，因为我认为这可能会导致内存等问题。我尝试使用 DateTime 类但是......我只是简单地不'不知道我怎么能把它传递几秒钟，它给了我正确的格式:(

我对 c# 不是很好。我真的很想学习:)谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T11:47:18.197

```
 int tempo = 180;
    TimeSpan time = TimeSpan.FromSeconds(tempo);
    string txt = string.Format(
        "{0:00}:{1:00}", time.Minutes, time.Seconds); 
```

（编辑）正如已经观察到的那样 - 没有直接的记忆问题`TimeSpan`，因为它是`struct`. 但是，如果您想偏执：

```
int tempo = 180;
string txt = new StringBuilder(5)
    .Append((tempo / 60).ToString().PadLeft(2, '0')).Append(':')
    .Append((tempo % 60).ToString().PadLeft(2, '0')).ToString(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T11:48:27.367

```
TimeSpan t = TimeSpan.FromSeconds(180);
string s = String.Format("{0:00}:{1:00}", t.Hours, t.Seconds); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T11:48:28.570

利用

```
label.Text = string.Format("{0:d2}:{1:d2}", otempo.Minutes, otempo.Seconds); 
```

如果您的分钟数可以增加到 60 以上，您可以使用 oTempo.TotalMinutes...

并且不要忘记指定一种文化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T13:41:01.310

就像其他人提到的那样，可能不需要担心创建一个新的 TimeSpan 来进行转换，但是在不创建任何临时对象的情况下格式化它的最简单方法是：

```
String.Format("{0:00}:{1:00}", tempo / 60, tempo % 60) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T11:52:31.383

TimeSpan 是一个结构，它（在这种情况下）分配在堆栈上，因此它的成本可以忽略不计，特别是考虑到无论如何您必须至少进行一个字符串分配，这是昂贵的部分。

```
TimeSpan.FromSeconds(tempo).ToString(); 
```

只要 180 秒 -> "00:03:00" 就可以满足您的需求

# c - 这种僵局隐藏在哪里？

> ID：536432
> 
> 赞同：2
> 
> 时间：2009-02-11T11:46:30.757
> 
> 标签：c, multithreading, pthreads, deadlock

我实际上正在编写一个 MPI 程序。这是一个基本的客户端/服务器模式。服务器有一组工作要计算。客户得到这个大集合的子集。每个客户端使用多个线程来计算子集。在向服务器请求另一个子集之前，我必须确保所有线程都已完成。

客户端分为几个线程：一个主线程（用于通信）和几个工作线程。

这是我的实际代码，应该发生死锁。我清除了任何 MPI 调用，使其更具可读性。我真的看不出我在这里做错了什么。

```
void* worker ( void * arg ) {
  while (work != 0) {
    int x;
    while ( get_job(&x) ) {
      do_job(x);
    }
    pthread_mutex_lock(&mutex_worker);
    nb_job_empty++;
    if (nb_job_empty == NB_THREADS) {
      nb_job_empty = 0;
      pthread_cond_signal(&cond_master);
    }
    nb_worker_woken--;
    pthread_cond_wait(&cond_worker, &mutex_worker);
    nb_worker_woken++;
    pthread_mutex_unlock(&mutex_worker);
  }
    return ( void * ) 0 ;
}

void server() {
    for (int i = 0; i < 100; i++) {
      add_job();
      pthread_mutex_lock(&mutex_master);
      pthread_cond_broadcast(&cond_worker);
      pthread_cond_wait(&cond_master, &mutex_master);
      pthread_mutex_unlock(&mutex_master);
    }
    work = 0;
    pthread_mutex_lock(&mutex_master);
    pthread_cond_broadcast(&cond_worker);
    pthread_mutex_unlock(&mutex_master);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T11:48:25.200

您应该对这两个条件使用相同的互斥锁（mutex_master 和 mutex_worker 应该相同）

此外，您应该按照建议在 while 循环中使用 pthread_cond_wait :)

# c# - 在 C#/LINQ 中是否有更好的/内联方式来完成以下任务？

> ID：536435
> 
> 赞同：1
> 
> 时间：2009-02-11T11:48:04.827
> 
> 标签：c#, linq, lambda

我经常发现自己用需要根据索引设置 CSS 类的项目填充 ASP.NET 中继器：索引 0 的“first”，索引（length-1）的“last”和中间的“mid”：

```
_repeater.DataSource = from f in foos
                       select new
                       {
                         ...,
                         CssClass = MakeCssClass( foos, f )
                       };

private static string MakeCssClass( Foo[] foos, Foo f )
{
  var index = Array.IndexOf( foos, f );

  if( index == 0 )
  {
    return "first";
  }
  else if( index == foos.Length - 1 )
  {
    return "last";
  }
  else
  {
    return "mid";
  }
} 
```

有没有更好的方法可以实现这一点（例如使用 lambda 函数）？如果我尝试得到 CS0828，“无法将 lambda 表达式分配给匿名类型属性”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T11:53:27.323

您可能对我在[MiscUtil中的](http://pobox.com/~skeet/csharp/miscutil)[SmartEnumerable](http://www.yoda.arachsys.com/csharp/miscutil/usage/smartenumerable.html)类型感兴趣。

从使用页面，有一个例子：

```
using System;
using System.Collections.Generic;

using MiscUtil.Collections;

class Example
{
    static void Main(string[] args)
    {
        List<string> list = new List<string>();
        list.Add("a");
        list.Add("b");
        list.Add("c");
        list.Add("d");
        list.Add("e");

        foreach (SmartEnumerable<string>.Entry entry in
                 new SmartEnumerable<string>(list))
        {
            Console.WriteLine ("{0,-7} {1} ({2}) {3}",
                               entry.IsLast  ? "Last ->" : "",
                               entry.Value,
                               entry.Index,
                               entry.IsFirst ? "<- First" : "");
        }
    }
} 
```

使用隐式类型变量和更多类型推断，可以很容易地整理语法。我必须花一些时间来解决这个问题，但基础知识已经存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T14:16:35.000

这是获得这些中频的巧妙方法 - 跳过、反向、跳过（这是什么，UNO？）。

```
List<SomeClass> myList = foos
  .Select(f => new SomeClass{ ..., CssClass=string.Empty })
  .ToList();

if (myList.Any())
{        
  myList.First().CssClass = "first";
  myList.Last().CssClass = "last";
  foreach(var z in myList.Skip(1).Reverse().Skip(1))
  {
    z.CssClass = "mid";
  }
}

_repeater.DataSource = myList; 
```

这是此问题陈述的更好方法。

```
List<SomeClass> myList = foos
  .Select(f => new SomeClass{ ..., CssClass="mid" })
  .ToList();

if (myList.Any())
{    
  myList.First().CssClass = "first";
  myList.Last().CssClass = "last";
}

_repeater.DataSource = myList; 
```

当然，如果您使用匿名类型（它们的属性是只读的），这些技术都不会起作用。不要对查询结果使用匿名类型。

# c++ - 现代 C++ 是否变得越来越流行？

> ID：536439
> 
> 赞同：133
> 
> 时间：2009-02-11T11:49:40.437
> 
> 标签：c++

当我 6-7 年前第一次学习 C++ 时，我学到的基本上是“C with Classes”。`std::vector`绝对是一个高级主题，如果你*真的*想学习，你可以学习。而且肯定没有人告诉我可以利用析构函数来帮助管理内存。今天，无论在哪里，我都能看到 RAII、[SFINAE](http://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error)、STL 和 Boost，以及，嗯，现代 C++。即使是刚开始接触这门语言的人，似乎几乎从第一天就开始学习这些概念。

我的问题是，这仅仅是因为我只看到“最好的”，即 SO 和其他倾向于吸引初学者的编程网站（gamedev.net）上的问题，还是这实际上代表了整个 C++ 社区？

现代 C++ 真的会成为默认值吗？与其成为专家所写的一些花哨的东西，它是否正在成为“C++ 的本来面目”？还是我只是无法看到成千上万仍在学习“C with classes”并编写自己的动态数组而不是使用的人`std::vector`，并通过从顶级代码中手动调用 new/delete 来进行内存管理？

尽管我很想相信，如果整个 C++ 社区作为一个整体在短短几年内发展得如此之快，这似乎令人难以置信。你的经历和印象是什么？

（免责声明：不熟悉 C++ 的人可能会将标题误解为询问 C++ 是否比其他语言更受欢迎。这不是我的问题。“现代 C++”是 C++ 中方言或编程风格的通用名称，以“ [Modern C++ Design: Generic Programming and Design Patterns Applied](https://rads.stackoverflow.com/amzn/click/com/0201704315) ”，我只对这个和“旧 C++”感兴趣。所以没必要告诉我 C++ 的时代已经过去了，我们都应该使用 Python ;))

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-02-11T15:23:54.590

以下是我认为事情的发展方式。

第一代 C++ 程序员是 C 程序员，他们实际上将 C++ 用作带有类的 C。另外，STL 还没有到位，所以这就是 C++ 的本质。

当 STL 出来时，那是先进的东西，但大多数人写书、整理课程和教学课程都是先学习 C，然后是额外的 C++ 东西，所以第二代从这个角度学习。正如另一个答案指出的那样，如果您习惯于编写常规的 for 循环，那么改用 use`std::for_each`并不会给您带来太多好处，除了您正在以“现代”方式做事的温暖模糊感觉。

现在，我们有讲师和书籍作者一直在使用整个 C++，并从这个角度获得指导，例如 Koenig & Moo 的 Accelerated C++ 和 Stroustrup 的新教科书。`char*`所以我们不学习`std::strings`。

这是一个有趣的教训，说明“遗留”方法需要多长时间才能被替换，尤其是当它们具有有效性记录时。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-02-11T11:55:49.003

绝对没错。对我来说，如果你不是按照你所说的这种“现代 C++”风格来编程 C++，那么使用 C++ 就没有意义了！您不妨只使用 C。在我看来，“现代 C++”应该是 C++ 编程的唯一方式，我希望所有使用 C++ 并以这种“现代”方式编程的人都会同意我的观点。事实上，当我听到一个 C++ 程序员不知道诸如 auto_ptr 或 ptr_vector 之类的东西时，我总是完全震惊。就我而言，这些想法是 C++ 的基础和基础，所以我无法以其他方式想象它。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-11T12:15:07.367

在 Windows 3.1 时代，C 是标准。当 C++ 进入开发者市场并后来成为 ANSI 标准时，它是新的热点。它普及了 OOP 的首字母缩写词和一些使用多态性的基本设计模式。

现在，随着对低门槛托管平台（如 C#/.NET）的广泛接受，使用 C++ 的理由越来越少。如此多的开发人员群体将有一个选择，老实说：C++ 对于新手来说是一头熊学习。使用 C#，您可以使用它运行。

这真的只剩下需要 C++ 的平台和顽固的 C++ 传道者继续实践艺术。这是一个需要所有被认为是“现代 C++”的抽象层的社区。

所以是的，我相信“现代 C++”，正如你所说的，正变得越来越流行。尽管它在不同的受众中流行，但与过去使用它的受众不同。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-11T12:03:27.673

我是学习如何使用 STL 并从第一天开始就听到很多关于 RAII 和良好 C++ 编程实践的人之一。看起来像是当今学习 C++ 的一些最推荐的书籍（如 Accelerated C++ 和 Effective C++ 系列) 专注于使用 STL 工具而不是汇总自己的东西，并且还为有效（或“现代”）编程提供了许多“规则”。

但与朋友交谈时，我还注意到一些公司仍在使用“C with Classes”，而不是“Modern C++”。也许“现代 C++”的作者和用户提出的文化有一天会盛行 :)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-11T11:58:48.357

我想你刚开始的经历很糟糕。

你需要给自己[买一本 Scott Meyers](http://www.aristeia.com/) Effective C++ 书籍。我在 1999 年愤怒地开始使用 C++，在我被允许签入任何代码之前，我的团队领导让我坐下来阅读 Effective C++ 和 More Effective C++。

他的大部分建议是“不要使用此*功能*，但如果必须，请记住*这*一点”

如果你听从他的建议，你会写出好的或“现代”的 C++。

他现在也有一本关于 STL 的书，但我还没有读过。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-11T16:57:43.100

在我的 C++ 工作中，我发现现代功能越来越多地被使用，越来越多的人在电话筛选和面试中向我询问这些功能。据我所知，他们正在赶上。

我最初学习 C++ 就像 C with Classes 一样；尽管这门语言已经远远超出了这一点，但我读过的书和与我一起工作的人都牢牢地停留在“旧 C++”上。RAII 是人们会思考而不是自动执行的事情，我记得阅读过一些关于异常安全问题的早期文章。

正如所指出的，现在有新书出版。许多旧的想法仍然相关，但它们似乎越来越多地解释了为什么明显的坏想法是坏的。（同样，现代读者很难理解弗洛伊德关于无意识思想的革命性思想，因为它现在是传统智慧。）

Stroustrup 刚刚出版了一本教科书，*Programming: Principles and Practice Using C++*。我买它是因为我还没有从 Stroustrup 的书中学到好东西，但还没有读完前几章。到目前为止，我只能说我赞同他的起步方式，而且这至少是对如何使用 C++ 的一个很好的介绍。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-08-26T21:27:56.027

在从事我目前参与的项目时，有很多 C++ 代码在很长一段时间内（现在已经超过 10 年）发展了。您所说的演变在那里清晰可见：较旧的代码通常是“带有类的 C”——原始指针、`char*`字符串以及相关 C 函数、数组等的使用；较新的代码使用 ATL 智能指针等来管理资源，但大部分时间仍坚持手工编码循环，迭代器很少见；最新的一个塞满了 STL 容器、算法、`shared_ptr`（包括管理句柄的自定义删除器等），高度泛化的函数和类模板，等等。大多数传统的“带类的 C”编码技术，例如带有手动生命周期管理的原始未封装指针，如今在代码审查中非常不受欢迎。由此看来，您的观察似乎是准确的。

最近的发展似乎是 C++0x lambdas 的一种时尚——它有一个积极的一面，它也倾斜了平衡，有利于使用标准算法而不是手动编码的循环，因为现在你可以让你的所有代码内联算法也是如此。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-02-11T12:00:30.910

这些天我不会说 std::vector 有资格被称为“现代”。这真的很基本。

总的来说，我的印象是人们已经获得了一些现代 C++ 风格的经验，并且稍微清醒了一点。举个简单的例子，STL for_each 很有趣，但实际上它并没有比普通的 C 循环增加很多可怕的价值。它更难调试，有时不能提供最佳性能。此外，当前 STL 中的函数式编程结构通常非常繁琐，尤其是如果您从 ML 等真正的函数式语言中获得经验。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-11T15:06:18.937

不幸的是，根据我的经验（西班牙大学），标准是不考虑语言本身。他们使用最简单的语言来教授编程（即Java），因为它对教师和学生来说应该很容易，然后他们将C用于OS类等。

C++ 的介绍非常简单（无论如何在任何课程中），只是为了给 C 提供类。他们不会进入 boost 甚至 STL。我认为跟上 C++ 的所有特性和思维方式对教师和学生来说都是代价高昂的。这里有多少 C++ 程序员足够了解所有 Boost 库以使用它们来提供更好的解决方案或设计它？必须有兴趣跟上所有新的库和习语。

然而，正如我所说，一般的编程（尤其是编程语言）似乎并没有被太认真地对待，因为当他们开始工作时，这似乎是一项临时任务，然后在他们升职时忘记如何编程企业树。这里的许多企业，以及大学本身，都觉得任何人都可以做编程。

如果您遵循这一理念，那么对于我认识的大多数人来说，C++ 将永远是“C with classes”。

问候，

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-02-11T15:42:00.520

以我的经验，这在很大程度上取决于软件产品/项目的年龄。我知道的大多数新项目都使用现代 C++（RAII、STL、Boost）。但是，有许多 C++ 项目已有 10 年以上的历史，而且您在那里看不到现代 C++。

另外，请记住，一些最流行的 STL 实现在大约 5 年前几乎都被破坏了（MSVC < 7.0 和 GNU < 3.00）

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-11-05T17:49:23.580

我认为我遇到的最大障碍是工具链支持，尤其是在跨平台项目上。直到几年前，通常会看到构建注释说“x 平台需要 STLport 才能工作，因为他们的编译器很糟糕”。即使是现在，我也看到人们试图使用与不同版本的 BOOST 相关的多个第三方依赖项的问题。这使得链接变得不可能，这意味着您必须返回并从头开始重建您的部门。

现在几乎每个人都停止使用 MSVC++ 6，STLport 混乱已经过去了。但是一旦 TR1 推出，我们就会回到“哪些环境的哪些版本支持它并让它正确”，这将再次减慢采用速度。

我在 1992 年开始使用 C（不是 C++）进行一个项目。在遗留代码库中部署现代实践是不可能的。同样，我在另一个更接近 C++ 语言前沿的项目上工作。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-08-26T21:38:09.780

我参加过并听说过的许多团队都在考虑“我们是否使用异常？” 问题。这是“我们使用现代 C++ 吗？”的代码。

一旦您不使用异常，您就无法使用该语言及其库的全部功能。

但是许多旧代码库是无异常的，并且很难将异常硬塞到不期望它们的代码库或不知道如何使用它们的团队中，因此在这种情况下的答案是经常“不”。

根据我的经验，现代 C++ 需要团队中对它充满热情的人来推动它。它还需要克服那些希望它更像遗留代码的人的反对意见。

虽然我认为旧的 C++ 代码库不会很快消失，但我确实相信世界上这些充满激情的人比五年前要多。他们面临着五年前同样的艰苦战斗，但他们更有可能找到志同道合的人。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-11-06T00:01:53.227

在回答这样的问题之前，您必须同意“现代”是什么。这不太可能发生，因为“现代”是一个定义不明确的词，对不同的人意味着不同的事物。Alexandrescu 的书名（现代 C++ 设计）也没有真正的帮助，因为它主要是一本关于模板元编程的书，它是 C++ 的一个特定领域，但绝不是唯一的。

对我来说，“现代 C++”！=“模板元编程”。我想说 C++ 在 C 之上的特性将分为以下几类：

*   类（构造函数、析构函数、RAII、动态转换和 RTTI）
*   例外
*   参考
*   标准库 (STL) 中的数据结构和算法
*   iostream
*   简单的类和函数模板
*   模板元编程

这些都不是特别现代，因为它们都已经存在了将近 10 年或更长时间。这些功能中的大多数都很有用，并且在许多用例中可以让您比直接 C 更有效率。一个优秀的程序员应该并且将在一个体面的项目中使用所有这些，但其中一个与另一个不同：

模板元编程。

模板元编程的简短回答就是说不。不幸的是，对于某些人来说，由于这本书，它是“现代 C++ 编程”的同义词，但最终它产生的问题多于解决的问题。除非 C++ 开发出更好的泛型编程机制，如反射，否则它将不适合泛型编程，而 Python 等高级语言将更适合这些用例。出于这个原因和许多其他原因，请参阅[C++ FQA](http://yosefk.com/c++fqa/ "C++ 常见问题解答")

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-11T11:55:37.507

学习 C++ 的最佳书籍。Koenig & Moo 的“Accelerated C++”教你所谓的现代 C++，所以我猜现在大多数人都在使用它。对于我们这些已经使用 C++ 很长一段时间（在我的例子中是从 80 年代中期开始）的人来说，现代 C++ 极大地缓解了编写我们自己的数组、字符串、哈希表（重复令人作呕）的繁琐任务。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-11-05T15:20:55.033

我确实看过[C++ Jobs](http://www.indeed.com/jobtrends?q=c%2B%2B+Qt%2C+c%2B%2B+boost%2C+c%2B%2B+stl%2C+c%2B%2B+mfc&l=)并且“现代”库越来越多地用于职位描述，MFC 是一个相当“旧式”的 C++ 库使用较少。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-11T12:15:20.890

1990 年代后期语言的标准化是第一步，它允许编译器制造商专注于“标准”功能集，也允许语言修复一些在标准化过程中出现的粗糙边缘。

这反过来又允许基于语言的标准特性开发框架，而不是基于特定编译器实现提供的特性。Boost 库在这方面尤为突出。这也允许新的开发基于以前的工作，从而为更复杂的问题提供可能的解决方案。

这里的一个显着变化是以前的框架如何基于基类和派生类的概念（运行时特性）。但是现在大多数高级功能通常都大量基于“递归”模板（编译时功能）。

STL 有其优点和缺点，但它经受住了时间的考验，如果你想要一些有效且简单的东西，STL 肯定有一些东西可以帮助你开始。重新发明轮子没有意义（除非出于教学原因）。

计算机硬件从 1990 年代也有了很大的飞跃，那时内存和 CPU 不再是编译器的约束。所以现在大部分书本上的理论优化都是可能的。

该语言的下一步是支持多核编程，这是 0x 标准工作的一部分。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-11-05T04:57:38.000

是和不是。当然，对于新项目来说，它越来越受欢迎。但是，仍然存在其他人没有提到的实际而非政治性的采用障碍。有很多商业 C++ 库使用来自古老编译器的 ABI，这些编译器不能正确支持现代 C++ 中的功能，并且很多公司都依赖这些库。例如，Solaris 上的 Sun Studio 不能在不使用 STLport 的情况下与 Boost 一起使用，但是您想要使用的任何第 3 方商业库都需要 Sun 的 STL 版本。GCC 2.95 和 Redhat Enterprise Linux 也是如此。

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2009-11-05T05:13:56.190

令人惊讶的是，让 c++ 更稳定的努力是多么的少。预警系统已经到位，但发展不大。与 10 年前相比，用脚射击自己甚至更容易。不知道为什么，但 c++ 仍然是我最喜欢的语言。:)

# xml - XPath 选择具有命名空间的节点

> ID：536441
> 
> 赞同：66
> 
> 时间：2009-02-11T11:49:57.177
> 
> 标签：xml, vb.net, xpath, xml-namespaces

它是一个 .vbproj，看起来像这样

```
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <ProjectGuid>15a7ee82-9020-4fda-a7fb-85a61664692d</ProjectGuid> 
```

我想要得到的只是 ProjectGuid 但是当有命名空间时它不起作用......

```
 Dim xmlDoc As New XmlDocument()
 Dim filePath As String = Path.Combine(mDirectory, name + "\" + name + ".vbproj")
 xmlDoc.Load(filePath)
 Dim value As Object = xmlDoc.SelectNodes("/Project/PropertyGroup/ProjectGuid") 
```

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-02-11T12:05:57.077

我可能倾向于使用~~Bartek 的~~* 命名空间解决方案，但一般的 xpath 解决方案是：

`//*[local-name()='ProjectGuid']`

**由于Bartek的回答已经消失，我推荐Teun的（实际上更彻底）*

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-02-11T12:14:38.833

做这样的事情（恕我直言）的最好方法是创建一个命名空间管理器。这可以用来调用 SelectNodes 来指示哪些命名空间 URL 连接到哪些前缀。我通常设置一个静态属性，它返回一个足够的实例（它是 C#，你必须翻译）：

```
private static XmlNamespaceManager _nsMgr;
public static XmlNamespaceManager NsMgr
{
  get
  {
    if (_nsMgr == null)
    {
      _nsMgr = new XmlNamespaceManager(new NameTable());
      _nsMgr.AddNamespace("msb", "http://schemas.microsoft.com/developer/msbuild/2003");
    }
    return _nsMgr;
  }
} 
```

我在这里只包括一个命名空间，但你可以有多个。然后你可以像这样从文档中选择：

```
Dim value As Object = xmlDoc.SelectNodes("/msb:Project/msb:PropertyGroup/msb:ProjectGuid", NsMgr) 
```

请注意，所有元素都在指定的命名空间中。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-02-11T12:19:19.867

这个问题已经出现过[好](https://stackoverflow.com/questions/11345/xpaths-and-default-namespaces) [几次](https://stackoverflow.com/questions/24734/selectnodes-not-working-on-stackoverflow-feed) [了](https://stackoverflow.com/questions/103576/whats-wrong-with-my-xpath-xml)。

您可以使用与命名空间无关的 XPath 表达式（不推荐使用它的笨拙和误报匹配的可能性 -`<msb:ProjectGuid>`并且`<foo:ProjectGuid>`对于此表达式是相同的）：

```
//*[本地名称() = 'ProjectGuid']
```

或者你做正确的事并使用 a`XmlNamespaceManager`来注册命名空间 URI，这样你就可以在你的 XPath 中包含一个命名空间前缀：

```
Dim xmlDoc As New XmlDocument()
xmlDoc.Load(Path.Combine(mDirectory, name, name + ".vbproj"))

Dim nsmgr As New XmlNamespaceManager(xmlDoc.NameTable)
nsmgr.AddNamespace("msb", "http://schemas.microsoft.com/developer/msbuild/2003")

Dim xpath As String = "/msb:Project/msb:PropertyGroup/msb:ProjectGuid"
Dim value As Object = xmlDoc.SelectNodes(xpath, nsmgr) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T12:20:50.097

您只需注册此 XML 名称空间并与前缀关联，即可使查询正常工作。选择节点时创建并传递命名空间管理器作为第二个参数：

```
Dim ns As New XmlNamespaceManager ( xmlDoc.NameTable )
ns.AddNamespace ( "msbuild", "http://schemas.microsoft.com/developer/msbuild/2003" )
Dim value As Object = xmlDoc.SelectNodes("/msbuild:Project/msbuild:PropertyGroup/msbuild:ProjectGuid", ns) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-11T13:37:51.350

一种方法是使用扩展 + NameSpaceManager。
代码在 VB 中，但很容易转换为 C#。

```
Imports System.Xml
Imports System.Runtime.CompilerServices

Public Module Extensions_XmlHelper

    'XmlDocument Extension for SelectSingleNode
    <Extension()>
    Public Function _SelectSingleNode(ByVal XmlDoc As XmlDocument, xpath As String) As XmlNode
        If XmlDoc Is Nothing Then Return Nothing

        Dim nsMgr As XmlNamespaceManager = GetDefaultXmlNamespaceManager(XmlDoc, "x")
        Return XmlDoc.SelectSingleNode(GetNewXPath(xpath, "x"), nsMgr)
    End Function

    'XmlDocument Extension for SelectNodes
    <Extension()>
    Public Function _SelectNodes(ByVal XmlDoc As XmlDocument, xpath As String) As XmlNodeList
        If XmlDoc Is Nothing Then Return Nothing

        Dim nsMgr As XmlNamespaceManager = GetDefaultXmlNamespaceManager(XmlDoc, "x")
        Return XmlDoc.SelectNodes(GetNewXPath(xpath, "x"), nsMgr)
    End Function

    Private Function GetDefaultXmlNamespaceManager(ByVal XmlDoc As XmlDocument, DefaultNamespacePrefix As String) As XmlNamespaceManager
        Dim nsMgr As New XmlNamespaceManager(XmlDoc.NameTable)
        nsMgr.AddNamespace(DefaultNamespacePrefix, XmlDoc.DocumentElement.NamespaceURI)
        Return nsMgr
    End Function

    Private Function GetNewXPath(xpath As String, DefaultNamespacePrefix As String) As String
        'Methode 1: The easy way
        Return xpath.Replace("/", "/" + DefaultNamespacePrefix + ":")

        ''Methode 2: Does not change the nodes with existing namespace prefix
        'Dim Nodes() As String = xpath.Split("/"c)
        'For i As Integer = 0 To Nodes.Length - 1
        '    'If xpath starts with "/", don't add DefaultNamespacePrefix to the first empty node (before "/")
        '    If String.IsNullOrEmpty(Nodes(i)) Then Continue For
        '    'Ignore existing namespaces prefixes
        '    If Nodes(i).Contains(":"c) Then Continue For
        '    'Add DefaultNamespacePrefix
        '    Nodes(i) = DefaultNamespacePrefix + ":" + Nodes(i)
        'Next
        ''Create and return then new xpath
        'Return String.Join("/", Nodes)
    End Function

End Module 
```

并使用它：

```
Imports Extensions_XmlHelper

......
Dim FileXMLTextReader As New XmlTextReader(".....")
FileXMLTextReader.WhitespaceHandling = WhitespaceHandling.None
Dim xmlDoc As XmlDocument = xmlDoc.Load(FileXMLTextReader)
FileXMLTextReader.Close()
......
Dim MyNode As XmlNode = xmlDoc._SelectSingleNode("/Document/FirstLevelNode/SecondLevelNode")

Dim MyNode As XmlNodeList = xmlDoc._SelectNodes("/Document/FirstLevelNode/SecondLevelNode")

...... 
```

* * *

## 回答 #6

> 赞同：-7
> 
> 时间：2009-02-11T11:56:46.363

为什么不使用 // 来忽略命名空间：

```
Dim value As Object = xmlDoc.SelectNodes("//ProjectGuid") 
```

// 充当通配符，通过根和指定的下一个节点名称之间的所有内容（即 ProjectGuid）

# c# - 列出 .netassembly 名称

> ID：536443
> 
> 赞同：2
> 
> 时间：2009-02-11T11:51:21.400
> 
> 标签：c#, .net-3.5

.NET 3.5 中有多少个程序集？我可以列出它们吗例如：系统；System.Windows.Forms 等等...请帮助 C# 中的代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T12:57:23.490

您可以在 Microsoft 网站上下载[.NET Framework 3.5 通用命名空间和类型海报。](http://www.microsoft.com/downloads/details.aspx?FamilyID=7b645f3a-6d22-4548-a0d8-c2a27e1917f8&displaylang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T18:18:14.410

这是一个快速程序，用于搜索`C:\Windows\assembly\`所有`.dll`程序集并输出具有以下版本的程序集`3.5`：

```
// Get all "*.dll" files from "C:\Windows\assembly".
string windowsDirectory = Environment.GetEnvironmentVariable( "windir" );
string assemblyDirectory = Path.Combine( windowsDirectory, "assembly" );
string[] assemblyFiles = Directory.GetFiles(
  assemblyDirectory, "*.dll", SearchOption.AllDirectories
);

// Get version of each file (ignoring policy, integration, and design files).
var versionedFiles =
  from path in assemblyFiles
  let filename = Path.GetFileNameWithoutExtension( path )
  where !filename.StartsWith( "policy" ) 
     && !filename.EndsWith( ".ni" ) 
     && !filename.EndsWith( ".Design" )
  let versionInfo = System.Diagnostics.FileVersionInfo.GetVersionInfo( path )
  select new { Name = filename, Version = versionInfo.FileVersion };

// Select all 3.5 assemblies.
var assembliesIn3_5 = versionedFiles
  .Where( file => file.Version.StartsWith( "3.5" ) )
  .OrderBy( file => file.Name );

foreach( var file in assembliesIn3_5 )
  Console.WriteLine( "{0,-50} {1}", file.Name, file.Version ); 
```

基于此 PowerShell 查询：

```
dir C:\Windows\assembly -filter *.dll -recurse | 
  ? { [Diagnostics.FileVersionInfo]::GetVersionInfo($_.FullName).FileVersion.StartsWith('3.5.') } | 
  % { [IO.Path]::GetFileNameWithoutExtension($_.Name) } | 
  ? { -not $_.EndsWith('.ni') } | 
  sort 
```

此外，您可能会发现 Hanselman's [Changes in the .NET BCL between 2.0 and 3.5](http://www.hanselman.com/blog/ChangesInTheNETBCLBetween20And35.aspx) post 很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T12:50:16.330

我需要向我的学生显示列表..他们有兴趣看看它是否可以完成，以及我们是否只能列出 .net 3.5 的组合（类名）

# java - 无法引用初始化程序中的静态枚举字段？

> ID：536449
> 
> 赞同：50
> 
> 时间：2009-02-11T11:52:34.597
> 
> 标签：java, compiler-construction

我刚得到有此错误的 Java5 项目，我尝试使用 Java5 和 Java6，但它仍然存在。它以前以某种方式工作（因为它在svn中），我怎样才能绕过那个编译器错误？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-02-11T11:56:50.687

不要“绕过”错误——它不会做你想做的事。错误是有充分理由的。

枚举值在任何其他静态字段之前初始化。如果您想做一些事情，比如将所有值添加到地图中，请在其他所有操作*之后*在静态初始化程序中执行此操作：

```
import java.util.*;

public enum Foo
{
    BAR, BAZ;

    private static final Map<String, Foo> lowerCaseMap;

    static
    {
        lowerCaseMap = new HashMap<String, Foo>();
        for (Foo foo : EnumSet.allOf(Foo.class))
        {
            // Yes, use some appropriate locale in production code :)
            lowerCaseMap.put(foo.name().toLowerCase(), foo);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-11-14T12:01:09.943

另一种“绕过”它的方法，例如，如果您需要一个计数器或需要在每次初始化时运行的东西，是创建一个私有静态内部类，如下所示：

```
public enum Foo {
    BAR, BAZ;

    private static final class StaticFields {
        private static final Map<String, Foo> lowerCaseMap = new HashMap<>();
        private static int COUNTER = 0;
    }

    private Foo() {
        StaticFields.lowerCaseMap.put(this.name().toLowerCase(), this);
        StaticFields.COUNTER++;
    }
} 
```

# jquery - 在 jquery 中使用 size() 查找孩子的数量

> ID：536455
> 
> 赞同：0
> 
> 时间：2009-02-11T11:55:27.100
> 
> 标签：jquery, syntax

我有一个 jquery 菜单，其中包含太多条目，以至于超出了页面的长度。我想获取每个菜单部分中的条目数，以便我可以使用它来调整页面末尾的填充 div 的大小。

```
$('.hideMe').click(function(){ 
    alert( $(this).next('ul').children() );
}); 
```

所以我想找出ul标签下的li标签的数量。

```
<h3 class="hideMe">Items</h3>
    <ul class="myul">
        <li id="001" >
            <a href="products.php?item=001">Item 1</a>
        </li>
        <li id="002" >
            <a href="products.php?item=002">Item 2</a>
        </li>   
        <li id="003" >
        <a href="products.php?item=003">Item 3</a>
        </li> 
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T11:58:21.913

那这个呢：

```
$(this).next('ul').find('li').length 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T12:00:36.683

```
$(".hideMe").click(function(){ 
    alert( $(this).next("ul").find("li").length);
}); 
```

但我宁愿`$(this).next("ul").height()`马上得到高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T12:20:15.123

我同意 Staicu 提供的答案（我已经投票赞成），但是您需要考虑孩子的数量是否足以满足您想要做的事情。

不要忘记允许不同的显示器分辨率以及浏览器窗口的大小（更具体地说是您的情况 - 高度）可以更改的事实。

我不完全确定“填充 div”在整体布局中扮演什么角色——也许一个更详细的例子可以帮助我们理解。

# c++ - 工厂对象与工厂函数

> ID：536464
> 
> 赞同：6
> 
> 时间：2009-02-11T11:58:30.230
> 
> 标签：c++, design-patterns, factory

我有一个带有几个派生类的 ABC。要创建这些派生类，我使用工厂模式：

.h 文件：

```
class derivedFactory
{
public:
    base* createInstance();
}; 
```

.cpp 文件：

```
base* derivedFactory::createInstance()
{
    return new derived();
} 
```

与仅具有免费功能相比，这有什么好处：

.h 文件：

```
base* derivedFactoryFunction(); 
```

.cpp 文件：

```
base* derivedFactoryFunction()
{
    return new derived();
} 
```

另外：我使用抽象工厂模式进行依赖注入。我可能会使用基于 ABC 的继承层次结构：

```
class objectCreator
{
public:
    base* create() = 0;
}; 
```

在函数指针上使用它有什么好处：

```
boost::function<base* ()> factory_ptr; 
```

使用 boost::bind/lambda 这似乎使我的代码更具可组合性，如果我希望我可以在其中包装一个真正的工厂对象。我可以看到性能可能会略有下降，但这很值得担心，因为它只在启动期间调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T12:08:48.223

这取决于您的工厂需要有多灵活。如果工厂需要外部信息（例如来自配置文件、程序选项等）来确定如何构造对象，那么对象是有意义的。如果您所需要的只是工厂的参数，那么函数可能就可以了。

我可以看到拥有指针的唯一优势是用于测试，您可以在其中使用不同的工厂函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T12:04:40.293

具有单个方法的接口或指向方法的指针是等效的。

但是在第二种情况下，如果您想要另一种方法与第一种方法一起使用，您会遇到麻烦......

在我看来，接口比方法指针更具可读性。

那你选择了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T12:05:07.157

我想说将工厂函数作为类本身中的静态方法的优势在于，它显然是该类生命周期的一部分。将其分开意味着使用您的类的其他程序员将不得不在其他地方寻找工厂方法。

抱歉，我不确定您将函数指针传递给因子方法的确切含义，但如果您不需要，我通常不会使用函数指针。函数指针不能内联，因为它们无法在编译时解析，这意味着它们可能会更慢。但除此之外，如果您已经可以确定要在编译时调用哪个函数，那么使用函数指针似乎是不好的设计。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T12:07:36.370

您是否曾经想要一个类型的多个工厂？如果是这样，您需要工厂对象。

# silverlight - 行或列定义是否可以根据其内容的尺寸自动调整大小

> ID：536468
> 
> 赞同：1
> 
> 时间：2009-02-11T12:00:06.200
> 
> 标签：silverlight, silverlight-2.0

因此，例如...在以下用户控件中，我有一个包含两行的网格。我希望底行是其内容的高度，顶行是网格其余部分的高度。我可以像示例中那样设置绝对高度，但这并不是特别灵活。假设有人更改了字体大小，文本可能会被剪裁。有没有内置的方法来实现这一点？

```
<UserControl x:Class="Tournament.View.TeamCreator"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >
    <Grid x:Name="LayoutRoot" Background="White" ShowGridLines="True">
        <Grid.RowDefinitions>
            <RowDefinition Height="1*" />
            <RowDefinition Height="20" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="1" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <RowDefinition Height="1*" />
            </Grid.RowDefinitions>

            <TextBlock Grid.Column="0" Grid.Row="0" Text="TEAM NAME" />
            <TextBox Grid.Column="1" Grid.Row="0" />
            <TextBlock Grid.Column="2" Grid.Row="0" Text="MANAGER NAME" />
            <TextBox Grid.Column="3" Grid.Row="0" />
            <Button Grid.Column="4" Grid.Row="0" />
        </Grid>
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T14:06:17.083

在 WPF 中，这很简单：

```
<Grid.RowDefinitions>
    <RowDefinition Height="1*" />
    <RowDefinition Height="Auto" />
</Grid.RowDefinitions> 
```

我怀疑在 Silverlight 中同样的作品？

# c++ - 我有 VS C++ Express。有没有办法创建 .DEF 文件？

> ID：536469
> 
> 赞同：0
> 
> 时间：2009-02-11T12:00:10.617
> 
> 标签：c++, dll

如果有人可以帮助我，我将非常感激。我正在学习 C++，我一直在尝试解决这个问题。

基本上，VS C++ Express 不附带 .DEF 模板。我还有什么其他方法可以创建这个文件？

我可以在 VS 中设置一个参数，以便链接器可以即时创建它吗？

谢谢！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T12:16:42.260

您可以在以下位置找到定义的 DF 文件的语法

*   [使用 DEF 文件从 DLL 导出](http://msdn.microsoft.com/en-us/library/d91k01sh(VS.80).aspx)
*   [模块定义 (.def) 文件](http://msdn.microsoft.com/en-us/library/28d6s79h(VS.80).aspx)

第一个链接的底部还提到了 DEF 文件的替代方案（例如`__declspec(dllexport)`指令）。

如果您没有创建 DEF 文件的模板，您可以使用文本编辑器手动创建文件（使用上面定义的语法）。

创建它后，将其添加到项目的链接器选项中（以便链接器使用它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T14:34:23.057

手动创建它并将其命名为 yourcurrentproject.def 并在其中添加导出符号。

# java - Java 简单的字符串差异工具

> ID：536478
> 
> 赞同：2
> 
> 时间：2009-02-11T12:01:41.517
> 
> 标签：java, algorithm, string, swing, diff

我正在寻找一个简单的 java lib/src 来突出两个字符串之间的差异，区分大小写。html 输出会很棒，但我很乐意获得差异的索引，例如：

```
diff("abcd","aacd") 
> [2,2]
diff("maniac", "brainiac")
> ["man",brain"] or [0,3] or something like that 
```

这个想法是在一个摇摆程序中突出显示拼写错误等，因为输入遵循严格的约定。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T12:11:54.753

Apache Commons Lang 有一个名为 StringUtils 的类，它既有差异又有 indexOfDifference，可以满足您的需求。

[http://commons.apache.org/lang/](http://commons.apache.org/lang/)

看看这个

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T15:38:39.530

[java-diff](https://java-diff.dev.java.net/)项目也可能有用。

> 这是 Java 的最长公共子序列 (LCS) 算法的实现。该`Diff#diff()`方法返回一个`Difference`对象列表，每个对象描述两个集合之间的添加、删除或更改。

# php - 如何在 htaccess Apache 中将 /en/file.php 转换为 file.php?lang=en

> ID：536483
> 
> 赞同：3
> 
> 时间：2009-02-11T12:03:27.753
> 
> 标签：php, .htaccess, mod-rewrite, internationalization, multilingual

我正在编写多语言网站。我在服务器上有几个文件，例如：

```
/index.php
/files.php
/funny.php 
```

并希望通过将语言代码放入 URL 来添加语言支持，如下所示：

```
http://mywebsite/en/index.php 
```

将重定向到：

```
http://mywebsite/index.php?lang=en 
```

和

```
http://mywebsite/en/files.php 
```

将重定向到：

```
http://mywebsite/files.php?lang=en 
```

我想添加更多语言，例如：

```
http://mywebsite/ch-ZH/index.php 
```

而且我希望这仅适用于具有 php 和 php5 扩展名的文件。其余文件应与它们相同。

所以例如我什么时候去地址

```
http://mywebsite/ch-ZH/index.php 
```

我希望我的 PHP 能够识别当前路径是

```
http://mywebsite 
```

并不是

```
http://mywebsite/ch-ZH 
```

这对我来说是必要的，因为在我的 PHP 代码中，我与当前路径相关，并希望它们像现在一样工作。

你能写下如何在 Apache 上准备 htaccess 文件来满足这个标准吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T12:21:29.520

试试这个：

```
RewriteEngine on
RewriteRule ^([a-z]{2}(-[A-Z]{2})?)/(.*) $3?lang=$1 [L,QSA] 
```

对于*当前的路径*问题，您必须知道如何解析相对 URI：如果未另行声明*，则客户端*从作为当前资源的 URI（*不是文件系统路径！ ）的基本 URI 解析相对 URI。*

因此，如果文档中包含 URI`/en/foo/bar`和相对路径`./baz`，*客户端*会将其解析为`/en/foo/baz`（显然客户端不知道实际的文件系统路径）。
为了`./baz`解决这个问题`/baz`，您必须更改可以使用[HTML 元素`BASE`](http://www.w3.org/TR/html4/struct/links.html#edef-BASE)完成的基本 URI 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T12:19:25.623

像这样的东西应该可以解决问题，

```
RewriteEngine on
RewriteRule ^(.[^/]+)/(.*).php([5])?$ $2.php$3?lang=$1 [L] 
```

这只会匹配 .php 和 .php5 文件，因此您的其余文件将不受影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T12:41:06.163

如果不想使用 ModRewrite，可以将符号链接放在 web 文件夹 ( `ln -s . en`) 中并检查 PHP 中的 URL。

# .net - 如何检查配置文件是否正确？

> ID：536495
> 
> 赞同：1
> 
> 时间：2009-02-11T12:07:16.557
> 
> 标签：.net, configuration-files

如果我的配置文件（我提供自己的配置）是正确的，而无需针对 Xml Schema 进行验证，有什么方法可以检查 .net？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T12:10:20.560

查看 System.Configuration 命名空间。有一个用于阅读配置设置的类，它可以为您轻松完成这项工作。

我相当肯定 AppSettingsReader 类会给你一些很好的验证技术。我通常只使用 Visual Studio 中应用程序设置提供的样板代码来执行此操作，如果文件无效，则系统将回退到默认值。

# jquery - 如何使用 jQuery 淡出 div？

> ID：536502
> 
> 赞同：39
> 
> 时间：2009-02-11T12:09:54.103
> 
> 标签：jquery

有没有办法在不使用 setTimeOut 函数的情况下在 5 秒后淡出 div？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2010-02-19T05:38:55.337

大家都知道jquery 1.4现在有延迟功能了吧？

```
$('#div').delay(5000).fadeOut(400) 
```

您就是这样做的，无需添加任何自定义功能或插件。它是 jquery 1.4 原生的

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-11T13:07:54.913

案例1：如果你想在5秒后**开始淡出，使用这个：**

```
jQuery.fn.delay = function(time,func){
    return this.each(function(){
        setTimeout(func,time);
    });
}; 
```

然后，像这样使用它：

```
$('#div').delay(5000, function(){$(#div').fadeOut()}) 
```

完全不使用 setTimeOut 是无法实现的

案例 2：如果您希望 fadeOut 的**持续时间**为 5 秒，请使用：

```
$('#div').fadeOut(5000) 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-02-11T12:17:06.363

[fadeOut()](http://docs.jquery.com/Effects/fadeOut)函数怎么样。看起来像这样：

```
$("#myDiv").fadeOut(5000); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-12-30T13:27:09.547

我只是遇到了同样的问题，在我看来，标记的答案实际上并不能真正满足这个问题。如果有人指定它像

```
$("#myDiv").fadeOut(5000); 
```

正如建议的那样，褪色过程本身将持续 5 秒，但不会在 5 秒后**开始**。

所以我正在寻找替代方案，而不必包含另一个 jQuery 插件等。我想出的最简单的解决方案是如下编写：

```
$("#myDiv").fadeTo(5000,1).fadeOut(1000); 
```

它使用了 fadeTo 效果，它在某种程度上是一个“黑客”。我让 fadeTo 运行 5 秒，让它褪色到 1 = 100% 不透明度。以这种方式，用户不会感知到任何变化。之后正常调用fadeOut，效果持续时间为1 秒。

我想这个解决方案非常简单，因为它不需要任何额外的插件并且可以写在 1 行中。

干杯。

**//编辑：**
显然现在有可能做这样的事情：

```
$('#myDiv').delay(800).fadeOut(1000); 
```

[这里有](http://addyosmani.com/blog/31-jquery-snippets/)一些更酷、更有用的功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T12:13:31.707

不确定您是希望它花 5 秒还是在 5 秒后开始。

耗时 5 秒：可以在 div 上使用 jQuery 淡出功能，它会降低元素的不透明度，直到它为 0，然后不显示该 div。淡入淡出的速度是函数的一个参数。

[http://docs.jquery.com/Effects/fadeOut#speedcallback](http://docs.jquery.com/Effects/fadeOut#speedcallback)

要在 5 秒内启动它，您需要某种计时器，该计时器在文档或窗口准备好时启动，或者当 div 准备好时启动，具体取决于您想要什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-16T07:59:32.697

// 我使用我刚刚写的这个暂停插件

```
$.fn.pause = function(duration) {
    $(this).animate({ dummy: 1 }, duration);
    return this;
}; 
```

像这样称呼它：

```
$("#mainImage").pause(5000).fadeOut(); 
```

注意：您不需要回调。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T12:12:47.077

假设您的意思是“等待五秒钟然后淡出”，我认为您将不得不使用插件来强制延迟，例如[这个](http://www.evanbot.com/article/jquery-delay-plugin/4)

# operating-system - 实时操作系统如何工作？

> ID：536506
> 
> 赞同：26
> 
> 时间：2009-02-11T12:11:31.213
> 
> 标签：operating-system, rtos

我的意思是实时操作系统如何以及为什么能够满足最后期限而不会错过它们？或者这只是一个神话（他们不会错过最后期限）？它们与任何常规操作系统有何不同，是什么阻止了常规操作系统成为 RTOS？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-11T13:37:06.873

满足最后期限是您编写的应用程序的一项功能。RTOS 只是提供帮助您按时完成任务的设施。您还可以在一个大的主循环中对“裸机”（w/oa RTOS）进行编程，并满足您的最后期限。

还要记住，与更通用的操作系统不同，RTOS 运行的任务和进程非常有限。

RTOS 提供的一些功能：

*   基于优先级的调度器
*   系统时钟中断程序
*   确定性行为

**基于优先级的调度器**

大多数 RTOS 有 32 到 256 个可能的单个任务/进程的优先级。调度程序将运行具有最高优先级的任务。当一个正在运行的任务放弃 CPU 时，下一个最高优先级的任务就会运行，以此类推……

系统中优先级最高的任务将拥有 CPU，直到：

*   它运行完成（即它自愿放弃CPU）
*   更高优先级的任务准备就绪，在这种情况下，原始任务被新的（更高优先级）任务抢占。

作为开发人员，您的工作是分配任务优先级，以便满足您的最后期限。

**系统时钟中断例程**

RTOS 通常会提供某种系统时钟（从 500 uS 到 100 毫秒），允许您执行对时间敏感的操作。如果你有一个 1 毫秒的系统时钟，并且你需要每 50 毫秒执行一次任务，那么通常有一个 API 可以让你说“在 50 毫秒内，唤醒我”。此时，任务将处于休眠状态，直到 RTOS 将其唤醒。

请注意，刚刚被唤醒并不能确保您将在那个时候准确运行。这取决于优先级。如果当前正在运行具有更高优先级的任务，您可能会被延迟。

**确定性行为**

RTOS 竭尽全力确保无论您有 10 个任务还是 100 个任务，都不再需要切换上下文、确定下一个最高优先级任务是什么等......

通常，RTOS 操作尝试为 O(1)。

RTOS 中确定性行为的主要领域之一是中断处理。当一条中断线发出信号时，RTOS 立即切换到正确的中断服务程序并立即处理中断（不管当前运行的任何任务的优先级如何）。

请注意，大多数特定于硬件的 ISR 将由项目的开发人员编写。RTOS 可能已经为串行端口、系统时钟、网络硬件提供了 ISR，但任何专门的（起搏器信号、执行器等）都不会成为 RTOS 的一部分。

这是一个粗略的概括，与其他一切一样，RTOS 实现有很多种。一些 RTOS 做事不同，但上面的描述应该适用于大部分现有的 RTOS。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-15T06:02:43.120

在 RTOS 中，应该注意的最关键参数是较低的延迟和时间确定性。它通过遵循某些政策和技巧来愉快地做到这一点。

而在 GPOS 中，除了可接受的延迟外，关键参数是高吞吐量。您不能指望 GPOS 的时间确定性。

RTOS 的任务比 GPOS 中的进程/线程轻得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T12:14:32.890

并不是他们能够按时完成，而是他们有固定的最后期限，而在常规操作系统中没有这样的最后期限。

在常规操作系统中，任务调度程序并不是很严格。也就是说，处理器每秒会执行这么多指令，但它有时可能不会这样做。例如，一项任务可能被抢占以允许执行更高优先级的任务（并且可能执行更长的时间）。在 RTOS 中，处理器将始终执行相同数量的任务。

此外，通常有完成任务的时间限制，之后会报告失败。这在常规操作系统中不会发生。

显然还有更多细节需要解释，但以上是 RTOS 中使用的两个重要设计方面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T12:51:25.343

您的 RTOS 的设计方式可以保证重要事件的计时，例如硬件中断处理和在需要时准确唤醒睡眠进程。

这个精确的时间允许程序员确定他的（比如说）起搏器会在需要的时候准确地输出一个脉冲，而不是几十毫秒后，因为操作系统正忙于另一个低效的任务。

它通常是一个比成熟的 Linux 或 Windows 更简单的操作系统，仅仅是因为它更容易分析和预测简单代码的行为。没有什么可以阻止像 Linux 这样的成熟操作系统在 RTOS 环境中使用，并且它具有 RTOS 扩展。由于代码库的复杂性，它无法保证它的时序可以降低到与较小的操作系统一样小的规模。

RTOS 调度器也比通用调度器更严格。重要的是要知道调度程序不会改变您的任务优先级，因为您已经运行了很长时间并且没有任何交互式用户。大多数操作系统会降低此类进程的内部优先级，以支持不应看到界面滞后的短期交互式程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-28T07:39:59.220

您可能会发现阅读典型 RTOS 的源代码很有帮助。那里有几个开源示例，以下通过一些快速搜索产生了链接：

*   [自由实时操作系统](http://www.freertos.org/)
*   [eCos](http://ecos.sourceware.org/)

[µC/OS-II](http://www.micrium.com/)是一个有据可查、以源代码形式提供且易于使用的商业 RTOS 。它有一个非常宽松的教育用途许可证，并且（稍微过时的版本）它的源代码可以绑定到一本书中，使用实际实现作为示例代码来描述其操作理论。这本书是Jean Labrosse 的**[MicroC OS II: The Real Time Kernel](https://rads.stackoverflow.com/amzn/click/com/1578201039)**。

这些年来，我在几个项目中使用了 µC/OS-II，我可以推荐它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T12:21:24.340

重要的是实时应用程序，而不是实时操作系统。通常实时应用程序是可预测的：许多测试、检查、WCET 分析、证明……已经执行，表明在任何特定情况下都能满足最后期限。

碰巧 RTOS 有助于完成这项工作（构建应用程序并验证其 RT 约束）。但我见过在标准 Linux 上运行的实时应用程序，更多地依赖硬件功能而不是操作系统设计。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T12:41:44.337

我没有使用过 RTOS，但我认为这就是它们的工作方式。

“硬实时”和“软实时”是有区别的。您可以在 Windows 等非 RTOS 上编写实时应用程序，但它们是“软”实时的：

*   作为一个应用程序，我可能有一个线程或计时器，我要求 O/S 每秒运行 10 次......也许 O/S 会在大多数情况下这样做，但不能保证它会一直能够......这种缺乏保证就是它被称为“软”的原因。操作系统可能无法做到这一点的原因是不同的线程可能使系统忙于做其他事情。作为一个应用程序，我可以将我的线程优先级提高到例如`HIGH_PRIORITY_CLASS`，但即使我这样做了，O/S 仍然没有我可以用来请求**保证**我将在特定时间运行的 API。

*   一个“硬”实时 O/S 确实（我想）有让我请求有保证的执行切片的 API。RTOS 可以做出此类保证的原因是它愿意异常终止线程，这些线程花费的时间超出预期/超出了允许的时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T11:58:44.507

... 好 ...

实时操作系统试图确定性并满足最后期限，但这完全取决于您编写应用程序的方式。如果您不知道如何编写“正确”的代码，您可以制作非常非实时的 RTOS。

即使您知道如何编写正确的代码：更多的是要尝试确定性而不是快速。

当我们谈论决定论时

1) 事件决定论

对于每组输入，系统的下一个状态和输出是已知的

2) 时间决定论

… 每组输出的响应时间也是已知的

这意味着如果您有异步事件，例如中断，您的系统严格来说不再是时间确定性的。（并且大多数系统都使用中断）

如果您真的想确定性，请轮询所有内容。

...但也许没有必要 100% 确定性

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-13T02:59:52.173

教科书/面试的答案是“确定性先发制人”。如果更高优先级的进程准备好运行（在就绪队列中）或断言中断（通常在 CPU/MCU 外部输入），则系统保证在有限的时间段内转移控制。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-13T03:34:04.500

他们实际上并不能保证按时完成。他们所做的使他们真正成为 RTOS 的是提供识别和处理截止日期超限的方法。“硬” RT 系统通常是那些错过最后期限是灾难性的并且需要某种关闭的系统，而“软” RT 系统是继续降级功能有意义的系统。无论哪种方式，RTOS 都允许您定义对此类溢出的响应。非 RT 操作系统甚至不检测溢出。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-07-13T23:39:12.437

“基本上，您必须对 RTOS 中的每个“任务”进行编码，以便它们在有限时间内终止。”

这实际上是正确的。RTOS 将有一个由体系结构定义的系统时钟，例如 10 毫秒，所有任务（线程）都经过设计和测量以在特定时间内完成。例如，在处理实时音频数据时，音频采样率为 48kHz，对于任何正在处理数据的下游任务，有一个已知的时间量（以毫秒为单位），预缓冲区将变为空。因此，使用 RTOS 需要正确调整缓冲区大小、估计和测量这需要多长时间，以及测量系统中所有软件层之间的延迟。然后可以满足最后期限。否则申请将错过截止日期。这需要分析整个堆栈中的最坏情况数据处理，一旦知道最坏情况，系统就可以设计用于，例如，

实时操作系统网络应用程序设计的示例时序图在 EE Times 的这篇文章中， ***产品操作方法：在基于 VoIP 的电话设计中提高实时语音质量*** [http://www.eetimes.com/ design/embedded/4007619/PRODUCT-HOW-TO-Improving-real-time-voice-quality-in-a-VoIP-based-telephony-design](http://www.eetimes.com/design/embedded/4007619/PRODUCT-HOW-TO-Improving-real-time-voice-quality-in-a-VoIP-based-telephony-design)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-11T12:17:00.903

基本上，您必须对 RTOS 中的每个“任务”进行编码，以便它们在有限时间内终止。

此外，您的内核将为每个任务分配特定的时间，以确保某些事情在某些时间发生。

但是请注意，这不是一件容易的事。想象一下像虚函数调用这样的事情，在 OO 中很难确定这些事情。此外，RTOS 必须根据优先级仔细编码，它可能需要在 x 毫秒内为 CPU 分配高优先级任务，这可能很难做到，具体取决于您的调度程序的工作方式。

# apache-flex - Flex JSON 套接字消息传递

> ID：536507
> 
> 赞同：2
> 
> 时间：2009-02-11T12:11:31.790
> 
> 标签：apache-flex, json, sockets

在 Flex 客户端和自定义服务器之间实现异步 json 套接字通信的最佳方式是什么？

当完整的 json 消息/对象被竞争时，是否有一个库可以监听套接字和触发事件？

编辑：我知道我可以使用 Socket 并监听 SOCKET_DATA 事件，但是只要收到新数据就会触发事件，而只有在收到（完整）jton 对象时才需要通知我。

我希望有更自动的东西:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T13:25:47.913

您需要为此使用[Socket](http://livedocs.adobe.com/flex/3/langref/flash/net/Socket.html)类。接收到新数据时触发 socketData 事件。当连接打开和关闭或出现 io 或安全错误时，也会触发一些事件。

如果您使用的是 AIR，您还可以使用[SocketMonitor](http://livedocs.adobe.com/flex/3/langref/air/net/SocketMonitor.html)来监控您的服务器端点。

# xaml - 在标签上设置触发器的 XAML 语法是什么？

> ID：536510
> 
> 赞同：5
> 
> 时间：2009-02-11T12:12:01.663
> 
> 标签：xaml, triggers

我有一个 DataTemplate 显示具有三个字段的对象，例如：

```
Name = "Font Color"
Value = "Orange"
Editable = "True" 
```

但我想将它们显示为例如：

***字体颜色：橙色可编辑***

但是我很难找到在此处使用触发器的语法，以便在字段 Editable="True" 时显示“Editable”

有谁知道这样做的语法？

以下代码导致“无法在属性中使用绑定”：

```
<DataTemplate x:Key="settingsItemTemplate">
    <StackPanel Orientation="Horizontal">
        <Label Content="{Binding XPath=Name}" ContentStringFormat=" {0}:"/>
        <Label Content="{Binding XPath=Value}"/>
        <Label>
            <Label.Triggers>
                <Trigger Property="{Binding XPath=Editable}" Value="True">
                    <Setter Property="Content" Value="Editable"/>
                </Trigger>
                <Trigger Property="{Binding XPath=Editable}" Value="False">
                    <Setter Property="Content" Value="NOT Editable"/>
                </Trigger>
            </Label.Triggers>
        </Label>
    </StackPanel>
</DataTemplate> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T12:34:15.447

使用 a`TextBlock`而不是 a会起作用`Label`吗？在这种情况下，您应该能够绑定到`TextBlock`一个属性。`Text`

如果您真的想使用 a `Label`，另一种方法是创建两个`DataTemplate`'s - 一个用于可编辑的情况，另一个用于不可编辑的情况。然后，您可以将该`ContentTemplate`属性绑定到适当的模板。

**更新**：在进一步研究之后，它看起来`Trigger`不支持其`Property`属性的绑定。但是，`DataTrigger`确实支持这一点：

```
<StackPanel>
    <CheckBox Name="EditableCheckBox">Is Editable</CheckBox>
    <Label>
        <Label.Resources>
            <Style TargetType="{x:Type Label}">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=EditableCheckBox, Path=IsChecked}" Value="True">
                        <Setter Property="Content" Value="Editable" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=EditableCheckBox, Path=IsChecked}" Value="False">
                        <Setter Property="Content" Value="NOT Editable" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Label.Resources>
    </Label>
</StackPanel> 
```

您应该能够修改`Binding`属性以绑定到您的 XML 数据源，而不是执行另一个控件的值。

# ant - 如何在 Ant 中创建映射器指定的目录

> ID：536511
> 
> 赞同：2
> 
> 时间：2009-02-11T12:12:33.830
> 
> 标签：ant, build-process, directory-structure

给定一个文件集

```
<fileset id="myFiles" dir=".">
    <include name="**/*.file"/>
</fileset> 
```

如何在集合中的每个文件上创建一个子目录，以不带扩展名的文件名命名？

例如，给定文件 folderA/X.file 和 folderA/folderB/Y.file，我想创建目录 folderA/X 和 folderA/folderB/Y

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T16:04:51.450

ant touch任务支持创建文件、父目录和文件名映射，所以可以用来实现：

```
 <target name="mkdirs">
    <touch mkdirs="true">
      <fileset dir="the_dir"/>
      <mapper type="glob" from="*.file" to="the_dir/*/.tmp" />
    </touch>
    <delete>
      <fileset dir="the_dir" includes="**/.tmp"/>
    </delete>
  </target> 
```

这会在目标目录中创建临时文件（如果不存在则创建目录），然后删除临时文件留下您想要的目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T12:25:23.317

您将使用 for task 来迭代您的文件列表。但是我在 Ant 中没有遇到任何子字符串类型的实用程序，您可以使用它来剥离扩展并创建目录。一定要搜索这个实用程序，如果它不存在，那么你需要实现一个 Ant 任务来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:20:50.663

很抱歉回答我自己的问题。除非有人知道，否则开箱即用的 ANT 似乎无法创建相对于文件集中条目的目录（例如使用 mkdir）。

正如 Bhushan 所建议的，Ant-Contrib 包含有用的循环任务，它可能执行此类任务。

有一些更好的事情要做，所以最后，我只写了一个由 ANT 任务调用的批处理文件（应用任务可以遍历文件集）。

```
<apply executable="cmd" failonerror="1">
    <arg value="/c"/>
    <arg line="build\tools\makeRelDir.bat"/>
    <fileset dir=".">
        <include name="**/*.file"/>
    </fileset>
</apply> 
```

批处理文件在哪里执行此操作： mkdir %~dp1%~n1

（为什么在 ANT 中做一些简单的事情这么难？我错过了什么吗？）

# php - （何时）我应该在 PHP 中使用类型提示？

> ID：536514
> 
> 赞同：24
> 
> 时间：2009-02-11T12:13:50.800
> 
> 标签：php, coding-style

我无法理解 PHP 作者添加类型提示的动机。在它出现之前，我快乐地生活着。然后，随着它被添加到 PHP 5，我开始在各处指定类型。现在我认为这是一个坏主意，因为鸭子类型确保了类之间的最小耦合，并利用了代码模块化和重用。

感觉就像类型提示将语言分成两种方言：有些人用静态语言风格编写代码，带有提示，而其他人则坚持良好的旧动态语言模型。还是不是“全有或全无”的情况？我应该在适当的时候以某种方式混合这两种风格吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-11T13:11:02.800

这与静态与动态类型无关，php 仍然是动态的。这是关于接口的合同。如果您知道一个函数需要一个数组作为其参数之一，请在函数定义中强制它。我更喜欢快速失败，而不是稍后在函数中出错。

（另请注意，您不能为 bool、int、string、float 指定类型提示，这在动态上下文中是有意义的。）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-11T12:40:49.753

只要函数中的代码确实依赖于传递参数的类型，就应该使用类型提示。无论如何，代码都会产生错误，但类型提示会给你一个更好的错误消息。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-11T16:46:50.787

PHP 小组添加类型提示的动机是为习惯 Java 风格 OOP 的人们提供另一个功能，使平台更加熟悉、舒适和吸引人。反过来，这将使 PHP 更加“为企业做好准备”，这将有助于 Zend 的核心业务。

除了营销，它确实有它的用途。如果您正在编写一个以特定方式对参数进行操作的方法，如果该参数是其他东西，则会导致意外（通常是静默）失败，那么使用类型提示可确保代码在开发过程中中断，而不是在生产过程中中断。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-11T14:02:07.857

如果您决定进行类型提示，至少使用接口而不是具体或抽象类。原因很简单，PHP 不允许多重继承，但允许实现多个接口。因此，如果有人尝试使用您的库，那么实现您的接口不会有困难，而他必须扩展您的抽象/具体类，因为他已经扩展了另一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T13:48:34.897

如果没有类型提示，IDE 就不可能知道方法参数的类型，从而提供正确的智能感知——你的编辑器确实有智能感知，对吗？;)。应该说我只是假设 IDE 将它用于智能感知，因为这是我第一次听说 PHP 中的类型提示（顺便说一句，感谢提示）。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2016-07-21T13:17:36.430

类型提示是我们公司争论的焦点（主要是 Java 人喜欢它），而我是一个非常老派的 PHP 程序员（以及其他语言的程序）。

我的建议是避免类型提示，并在每个复杂函数中包含 try/catch 处理程序。

类型提示迫使应用程序依赖调用者异常处理环境，这种环境通常很糟糕并且未经测试，这是主要问题。对于 Web 应用程序，这会导致白屏死机，对于批处理，它只会导致致命的退出，而在大多数情况下没有记录好的消息，并且您坐在他们的头上，试图重新创建管理在您身上的用户或应用程序问题回来解决。

本地异常处理提供了一个更可控的测试场景，包括数据类型中的垃圾和数据值中的垃圾，与在调用者中通过传入不正确的类型并期望例外。

由于堆栈版本问题，异常测试在许多情况下也会失败（例如，某些 PHP 版本（例如 5.4）没有以适当的方式捕获“可捕获的致命”错误，并且 ergo phpunit 只会破坏测试套件。这是一个特定于堆栈的问题，但是以我的经验，类型提示根本是不必要的，使习惯于类型化语言的人更好地接受 PHP 而没有意识到影响，并导致更复杂的测试场景（很难测试处理异常路径结果的调用者）。

Java 和其他类型语言的人不接受或理解如何利用 PHP 中的默认混合类型参数并从中受益……他们总有一天会学习，但前提是他们接受 PHP 方式。;-)

在开发健壮的基于 PHP 单元的测试场景时可以学到最好的经验教训，这通常会阐明为什么类型提示是与测试相关的麻烦，并且导致的问题多于好处......对他们自己和我的应用程序运行得更好、更可靠，测试结果也更加完整，代码覆盖率通常为 100%，包括本地函数中的捕获路径。

# regex - 在一个巨大的文件中匹配 IP 和 UserAgent 的正则表达式模式

> ID：536515
> 
> 赞同：1
> 
> 时间：2009-02-11T12:14:09.023
> 
> 标签：regex

我有一个巨大的日志文件，其结构如下：

```
ip=X.X.X.X
userAgent=Firefox
-----
Referer=hxxp://www.bla.org 
```

我想创建一个这样的自定义输出：ip:userAgent

例如：

```
X.X.X.X:Firefox 
```

并且该模式将忽略不以 ip= 和 userAgent= 开头的行。（正如我上面提到的，这两个必须形成一对。）

我是新手管理员，我们的客户需要立即排序文件。任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T12:25:36.063

```
^ip=(\d+(?:\.\d+){3})[\r\n]+userAgent=(.+)$ 
```

以全局+多行模式应用。

组 1 将包含 IP，组 2 将包含用户代理字符串。

编辑：上面的表达式可以简化一点，我们可以去掉 IP 地址格式检查——假设日志文件中只有真实的 IP 地址：

```
^ip=(\d+\.?)+[\r\n]+userAgent=(.+)$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T07:21:06.943

试一试（如果您的日志文件与上面的示例片段不同，这绝不是可靠的）：

```
sed -n -e '/^ip=/ {s///
N
s/\nuserAgent=/:/
p 
}' HugeFile > customoutput 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T12:22:38.503

您可以使用：

```
^ip=((?:[0-9]{1,3}\.){3}[0-9]{1,3})$ 
```

和

```
^userAgent=(.*)$ 
```

为两者获取第 1 组，您将获得所需的数据。

# oracle - 如何在 Oracle 中开发后服务器错误触发器？

> ID：536516
> 
> 赞同：6
> 
> 时间：2009-02-11T12:14:16.090
> 
> 标签：oracle, plsql, triggers, error-logging

我正在尝试将数据库中的所有错误记录到表中。因此，作为用户 sys，我编写了以下代码：

```
CREATE TABLE servererror_log (
    error_datetime  TIMESTAMP,
    error_user      VARCHAR2(30),
    db_name         VARCHAR2(9),
    error_stack     VARCHAR2(2000),
    captured_sql    VARCHAR2(1000));
/
CREATE OR REPLACE TRIGGER log_server_errors
AFTER SERVERERROR
ON DATABASE
DECLARE
 captured_sql VARCHAR2(1000);
BEGIN
  SELECT q.sql_text
  INTO captured_sql
  FROM gv$sql q, gv$sql_cursor c, gv$session s
  WHERE s.audsid = audsid
  AND s.prev_sql_addr = q.address
  AND q.address = c.parent_handle;

  INSERT INTO servererror_log
  (error_datetime, error_user, db_name,
   error_stack, captured_sql)
  VALUES
  (systimestamp, sys.login_user, sys.database_name,
  dbms_utility.format_error_stack, captured_sql);
END log_server_errors; 
```

但是，当我强制尝试从不存在的表中选择错误时，它不会在表中记录错误。

有什么方法可以检查触发器是否触发？此外，我尝试创建一个测试表以插入其中，但它也不起作用，即使将触发器定义为自主事务并在触发器内提交。

谢谢，华金

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T12:59:02.517

不查询 v$sql；使用 ora_sql_txt 获取语句。

```
CREATE OR REPLACE TRIGGER log_server_errors
AFTER SERVERERROR
ON DATABASE
DECLARE
sql_text ora_name_list_t;
stmt clob;
n number;
BEGIN
  n := ora_sql_txt(sql_text);
  if n > 1000 then n:= 1000; end if ;
  FOR i IN 1..n LOOP
     stmt := stmt || sql_text(i);
   END LOOP;

   INSERT INTO servererror_log
   (error_datetime, error_user, db_name,
    error_stack, captured_sql)
   VALUES
   (systimestamp, sys.login_user, sys.database_name,
   dbms_utility.format_error_stack, stmt);
   commit;
 END log_server_errors;
 / 
```

然后：

```
SQL> select * from c; 
```

这会产生：

```
select * from c
              *
ERROR at line 1:
ORA-00942: table or view does not exist 
```

现在可以查询：

```
select * from servererror_log; 
```

生产：

```
ERROR_DATETIME
---------------------------------------------------------------------------
ERROR_USER                     DB_NAME
------------------------------ ---------
ERROR_STACK
--------------------------------------------------------------------------------
CAPTURED_SQL
--------------------------------------------------------------------------------
11-FEB-09 02.55.35.591259 PM
SYS                            TS.WORLD
ORA-00942: table or view does not exist
select * from c 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T20:51:28.060

要查看触发器是否正在触发，请向其中添加一行或多行，如下所示：

```
DBMS_OUTPUT.PUT_LINE( 'Got this far' ); 
```

在 SQLPlus 中，SET SERVEROUTPUT ON 然后执行命令以生成错误。你应该得到这样的输出：

```
dev> select * from aldfjh;
select * from aldfjh
              *
ERROR at line 1:
ORA-00942: table or view does not exist

ORA-00942: table or view does not exist

Got this far 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T21:35:51.033

检查触发器的状态和/或其他触发器的存在：

```
select trigger_name, status
from all_triggers
where triggering_event like 'ERROR%' 
```

这应该导致：

```
TRIGGER_NAME        STATUS
------------        -------
LOG_SERVER_ERRORS   ENABLED 
```

如果未启用触发器或另一个触发器失败，则可能无法正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-20T22:17:33.580

另存为`ORA-00942.sql`：

```
-- Drop trigger and ignore errors (e.g., not exists).
DECLARE
    existential_crisis EXCEPTION;
    PRAGMA EXCEPTION_INIT( existential_crisis, -4080 );
BEGIN
    EXECUTE IMMEDIATE 'DROP TRIGGER TRG_CATCH_ERRORS /*+ IF EXISTS */';
    EXCEPTION WHEN existential_crisis THEN
    DBMS_OUTPUT.PUT_LINE('Ignoring non-existence.');
END;
/

-- Drop table and ignore errors (e.g., not exists).
DECLARE
    existential_crisis EXCEPTION;
    PRAGMA EXCEPTION_INIT( existential_crisis, -942 );
BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE TBL_ERROR_LOG /*+ IF EXISTS */';
    EXCEPTION WHEN existential_crisis THEN
    DBMS_OUTPUT.PUT_LINE('Ignoring non-existence.');
END;
/

-- Create the table (will not exist due to drop statement).
CREATE TABLE TBL_ERROR_LOG (
    occurred      timestamp,
    account       varchar2(32),
    database_name varchar2(32),
    stack         clob,
    query         clob
);

-- Create the trigger to log the errors.
CREATE TRIGGER TRG_CATCH_ERRORS AFTER servererror ON database
DECLARE
    sql_text   ora_name_list_t;
    n          number;
    query_     clob;
BEGIN
    n := ora_sql_txt( sql_text );

    IF n > 1000 THEN n := 1000; END IF;

    FOR i IN 1 .. n LOOP
        query_ := query_ || sql_text( i );
    END LOOP;

    INSERT INTO TBL_ERROR_LOG
        (occurred, account, database_name, stack, query)
    VALUES
        (systimestamp, sys.login_user, sys.database_name,
     dbms_utility.format_error_stack, query_);
END;
/ 
```

使用 sqlplus 运行：

```
SQL> @ORA-00942.sql
PL/SQL procedure successfully completed.

PL/SQL procedure successfully completed.

Table created.

Trigger created. 
```

测试它：

```
select * from blargh;
select * from TBL_ERROR_LOG; 
```

输出：

```
 2017-10-20 15:15:25.061   SCHEMA  XE  "ORA-00942: table or view does not exist"   select * from blargh 
```

# asp.net-mvc - 如何将数据从控制器传递到 asp.net mvc 中的强类型用户控件？

> ID：536527
> 
> 赞同：0
> 
> 时间：2009-02-11T12:17:10.730
> 
> 标签：asp.net-mvc, user-controls, master-pages

我有一个强类型的用户控件，它应该在所有页面上显示用户的订单，它包含在母版页中。我有一个 OrdersController，它可以给我当前的订单并在其他位置使用。

我如何告诉母版页中的 UserControl 它应该从特定的控制器/控制器操作中获取其数据？我想像在普通视图中一样访问 ascx 中的视图数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T12:36:38.093

将模型和 ViewData 作为参数传递给 RenderPartial 方法。它将使模型和视图数据可以访问，就像您在父视图页面中一样。

```
<% Html.RenderPartial ( "../Shared/HRMasterData/DependentPersonDossiers",
  ViewData.Model, ViewData ); %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T12:30:55.830

一种方法是实现一个基本控制器。将获取订单的逻辑移至基本控制器。在基本控制器中覆盖 OnActionExecuted 并检查结果是否为 ViewResult。如果是，找到订单并将它们添加到 ViewData。在您的主文件中，检查订单是否存在于视图数据中，如果存在，则呈现它们。如果没有，请显示“订单数据不可用”消息（后者不应该发生，但最好是安全的）。重用（调用）OrdersController 中基本控制器中的代码，用于呈现订单视图的操作。

# open-source - 在多个站点托管一个开源项目

> ID：536528
> 
> 赞同：16
> 
> 时间：2009-02-11T12:19:08.887
> 
> 标签：open-source, project-hosting

假设我有一个开源项目，我想尝试并为其带来一些曝光率。[例如，在github](http://github.com/)、[sourceforge](http://sourceforge.net/)和[google code](http://code.google.com/)等多个站点上为其设置项目条目会被认为是不道德的吗？

这纯粹是为了给它更大的曝光率。我意识到这样做可能有一些实际原因，例如想要使用 github 进行源代码控制，以及使用 sourceforge 进行问题跟踪、论坛等。为了这个问题，我想更多地关注您使用其中一个站点作为项目的主站点，并在指向主站点的其他站点上制作“存根”项目的情况。

我的直觉是，虽然它可能不是完全不道德的，但它可能接近于低俗的一面......

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-11T12:41:24.480

坚持使用一个提供商。“如果你盖了，他们会来的” ：）

此外，一旦人们*开始*来，他们无论如何都会用谷歌搜索项目名称。在 Sourceforge、Github 和 Google Code 上找到相同的项目只会惹恼人们。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-11T12:55:09.610

我不了解道德规范，但请考虑实用性：

*   您将不得不多次重复上传到多个不同的站点，对单个站点执行此操作可能会很痛苦
*   用户不知道在哪个站点报告错误
*   如果您使用 SVN/CVS/git 存储库，您将在不同的存储库中拥有多个代码副本 - 这是一个非常糟糕的主意

我确定还有其他问题。所以坚持一个网站 - 我一直在使用谷歌代码来完成我刚刚开始的一个小项目（[CSVfix](http://code.google.com/p/csvfix/)，如果有人感兴趣的话），我可以推荐谷歌，因为它很容易设置。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T14:11:06.183

我认为这很好，因为每个提供商可能都有您想要的东西。您应该选择最适合您的项目的服务。例如：

*   谷歌代码有文件托管，但问题管理很糟糕，所以
*   Launchpad 有很好的错误跟踪，但没有 wiki，我们使用 Mercurial，所以
*   Bitbucket.org 有 mercurial 托管等。

因此，使用 Launchpad 进行错误跟踪，使用 Google 代码托管文件和 wiki，以及使用 Bitbucket.org 托管源代码可能是合理的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T12:28:41.687

我建议为您的项目选择您喜欢的主机。您可以在许多论坛上发布有关您的项目的信息。曝光将通过搜索引擎来。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-14T15:43:52.943

我不知道你为什么认为这是不道德的或低俗的。也许你可以多说一些，这样人们就可以直接解决你的问题。要衡量这一点，请考虑您是否故意违反服务规则、​​向任何人谎报您如何使用服务以及以其他方式进行欺骗。如果您使用多种服务，我认为您没有什么可隐藏的。

考虑一下我处理的 Perl 社区。多个项目托管在源代码控制服务之一上，例如 SourceForge、Google Code 或 Github。不过，大多数 Perl 东西的主要发行版是 CPAN。其他人可能会通过 Freshmeat 或其他服务进行分发。主要问题跟踪器来自 Best Practical，它为 CPAN 上的每个 Perl 模块提供免费[RT](http://rt.cpan.org)。我认识的大多数人都使用了不止一项服务中最好的。实际上，Web 2.0 的方式是通过将来自多个供应商的服务组合在一起来创建应用程序。:)

您还应该考虑这些免费网站的社会建设。SourceForge 和 Github 等地方提供免费帐户，但它们也出售服务。他们通过免费的东西获得嗡嗡声，这些东西允许他们销售优质服务。我看不出有什么问题。如果您正在使用免费服务，请意识到作为免费使用的回报，他们可以将您用作免费测试员、广告商等。再说一次，我看不出有什么问题。这只是交易的一部分。你不只是从他们那里拿走，你也在给他们。同意方之间有交流。

我认为，任何禁止您使用其他服务或故意设置一种情况，通过与常用工具不兼容或不允许您访问您的数据而使您难以使用其他服务的任何服务都是不道德的（例如，以某种方式禁止 git-svn，等等）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-14T14:51:45.300

跨越这些不同主机的服务将不方便且难以维护。对于上述对搜索引擎产生流量的依赖，请注意选择一个能够将您的项目与网络噪音区分开来的名称。流量不会到达的一个明确迹象是，如果您的项目首先获得了关于拼写的重新推荐。以从 GNU 为您带来 chattr 项目的人为例。立即建议将 chatr 作为正确的搜索，您的流量将因此受到影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-14T15:09:04.540

正如我已经说过的那样，必须在多个主机上维护代码会使它变得更加麻烦，这是值得的。您必须考虑的是，您需要确保它在多个主机上正确上传，如果一个副本是合法的而其他副本不是合法的，那么它可能会导致一些人混淆，这反过来可能会导致坏名声在你开始之前的项目。一天结束时，有更多更好的方式来传播您的项目，社交网站，特定相关论坛是您需要考虑的两个主要方式，无论哪种方式，您最好花时间在多个网站上发布您将在多个站点上上传和维护代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-10T04:56:05.397

我认为拥有多个（独立的）镜像对社区有利，因为这种分布式确保了现在和将来更可靠地访问您的公共工作（它将在任何单个托管站点的故障中幸存下来）。

这就是为什么我要跟踪公开托管开源项目的可用不同选项：

*   [有哪些 darcs 项目的公共托管站点？](https://stackoverflow.com/q/6300954/94687)
*   [有哪些公共 Git 托管站点是免费软件？](https://stackoverflow.com/q/6301781/94687)

我相信付出一些努力来确保您的公共作品以最容易获得的方式发表是相当合乎道德的（或道德的）（有据可查，并保证在有人感兴趣的任何时候都可以访问它）。

您将工作独立推到多个地方（我的意思是，它们不会相互依赖）并管理所有这一切的努力可能并不是真正的噩梦（正如此处的其他一些答案所建议的那样），尤其是使用 DVCS 时。例如，[您甚至可以设置 Git，以便只需一个命令即可推送到多个地方](https://stackoverflow.com/questions/36862/how-do-you-organise-multiple-git-repositories/779812#779812)。

我觉得除非你强迫别人阅读你所做的东西，而是你只是把你的东西放在某个地方，以便在有人感兴趣时可以找到和访问，否则你不是自私的或自负的。

# javascript - 从窗口将值传递给 iframe

> ID：536538
> 
> 赞同：81
> 
> 时间：2009-02-11T12:20:51.563
> 
> 标签：javascript, html, iframe

我需要向 iframe 发送一个值。

iframe 存在于当前窗口中。我怎样才能做到这一点？

我需要在包含 iframe 的父窗口中使用 javascript 来完成。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-02-11T12:45:45.170

首先，您需要了解您有两个文档：框架和容器（包含框架）。

从容器中操作框架的主要障碍是框架异步加载。您不能简单地随时访问它，您必须知道它何时完成加载。所以你需要一个技巧。通常的解决方案是`window.parent`在框架中使用“up”（进入包含`iframe`标签的文档）。

现在您可以调用容器文档中的任何方法。此方法可以操作框架（例如使用您需要的参数调用框架*中的一些 JavaScript）。*要知道何时调用该方法，您有两种选择：

1.  从框架的 body.onload 调用它。

2.  将脚本元素作为最后一件事放入调用容器方法的框架的 HTML 内容中（留给读者作为练习）。

所以框架看起来像这样：

```
<script>
function init() { window.parent.setUpFrame(); return true; }
function yourMethod(arg) { ... }
</script>
<body onload="init();">...</body> 
```

和这样的容器：

```
<script>
function setUpFrame() { 
    var frame = window.frames['frame-id'].contentWindow;
    frame.yourMethod('hello');
}
</script>
<body><iframe name="frame-id" src="..."></iframe></body> 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2009-02-11T12:29:20.140

取决于您的具体情况，但如果 iframe 可以在页面的其余部分加载*后*部署，您可以简单地使用查询字符串，a la：

```
<iframe src="some_page.html?somedata=5&more=bacon"></iframe> 
```

然后在 some_page.html 的某个地方：

```
<script>
var params = location.href.split('?')[1].split('&');
data = {};
for (x in params)
 {
data[params[x].split('=')[0]] = params[x].split('=')[1];
 }
</script> 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2017-01-11T15:26:48.383

这是另一种解决方案，如果帧来自不同的域，则可用。

```
var frame = /*the iframe DOM object*/;
frame.contentWindow.postMessage({call:'sendValue', value: /*value*/}, /*frame domain url or '*'*/); 
```

在框架本身：

```
window.addEventListener('message', function(event) {
    var origin = event.origin || event.originalEvent.origin; // For Chrome, the origin property is in the event.originalEvent object.
    if (origin !== /*the container's domain url*/)
        return;
    if (typeof event.data == 'object' && event.data.call=='sendValue') {
        // Do something with event.data.value;
    }
}, false); 
```

不过不知道哪些浏览器支持这个。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-02-11T12:27:07.260

使用[框架集合](https://developer.mozilla.org/En/DOM/Window.frames)。

从链接：

```
var frames = window.frames; // or // var frames = window.parent.frames;
for (var i = 0; i < frames.length; i++) { 
  // do something with each subframe as frames[i]
  frames[i].document.body.style.background = "red";
} 
```

如果 iframe 有名称，您还可以执行以下操作：

```
window.frames['ponies'].number_of_ponies = 7; 
```

只有当这两个页面来自同一个域时，您才能执行此操作。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2013-12-11T13:10:43.550

另外两个选项，它们不是最优雅的，但可能更容易理解和实现，特别是如果 iframe 需要从其父级获取的数据只是几个 var，而不是复杂的对象：

**使用 URL 片段标识符 (#)**

在容器中：

```
<iframe name="frame-id" src="http://url_to_iframe#dataToFrame"></iframe> 
```

在 iFrame 中：

```
<script>
var dataFromDocument = location.hash.replace(/#/, "");
alert(dataFromDocument); //alerts "dataToFrame"
</script> 
```

**使用 iFrame 的名称**

（我不喜欢这个解决方案——它滥用了 name 属性，但它是一个选项，所以我提到它是为了记录）

在容器中：

```
<iframe name="dataToFrame" src="http://url_to_iframe"></iframe> 
```

在 iFrame 中：

```
<script type="text/javascript">
alert(window.name); // alerts "dataToFrame"
</script> 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2019-04-02T05:12:36.093

我们可以使用“postMessage”概念将数据从主窗口发送到底层 iframe。

[您可以使用此链接查看有关 postMessage 的更多信息](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) ，在主窗口页面中添加以下代码

```
// main window code
window.frames['myFrame'].contentWindow.postMessage("Hello World!"); 
```

我们将通过“Hello World！” 向 iframe id="myFrame" 的 iframe contentWindow 发送消息。

现在在 iframe 源代码中添加以下代码

```
// iframe document code
function receive(event) {
    console.log("Received Message : " + event.data);
}
window.addEventListener('message', receive); 
```

在 iframe 网页中，我们将附加一个事件侦听器来接收事件，在“接收”回调中，我们会将数据打印到控制台

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-01-22T00:34:51.207

如果您在内部使用 angular 和 iframe，则需要收听 iframe 以完成加载。你可以这样做：

```
 document.getElementsByTagName("iframe")[0].addEventListener('load', () => {
            document.getElementsByTagName("iframe")[0].contentWindow.postMessage(
                {
                    call: 'sendValue',
                    value: 'data'
                },
                window.location.origin)
        }) 
```

您将不得不以一种或另一种方式获取 iframe（有更好的方法可以以角度进行），然后等待它加载。否则即使您在生命周期方法中执行此操作，侦听器也不会附加到它，例如`ngAfterViewInit()`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T12:26:31.987

看看下面的链接，它表明可以使用 Javascript 更改页面中 iFrame 的内容，尽管您很可能会遇到一些跨浏览器问题。如果你能做到这一点，你可以使用页面中的 javascript 将隐藏的 dom 元素添加到包含你的值的 iFrame，iFrame 可以读取这些元素。 [访问 iFrame 中的文档](http://xkr.us/articles/dom/iframe-document/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-08T19:37:13.767

在您的主页中，添加这一行 -

```
window.postMessage("Hello data from Homepage"); 
```

在您的 iframe 中，添加此行-

```
window.addEventListener("message", receiveDataFromWeb);

const receiveDataFromWeb=  (data)=> {
    console.log(data);
    //this should print Hello data from Homepage
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-24T17:46:04.300

只是另一种方式。在 iframe 中，您可以添加事件侦听器并将事件分派到父文档中：

```
parent.document.addEventListener('iframe-event', (e) => {
    console.log('iframe-event', e.detail);
});

setTimeout(() => {
    console.log('dispatchEvent from iframe');
    const event = new CustomEvent('frame-ready', { detail: 'parent event dispatched from iframe' });
    parent.document.dispatchEvent(event);
}, 1000); 
```

您可以从父级添加事件侦听器并在其自己的文档中调度事件：

```
document.addEventListener('frame-ready', (e) => {
        const event = new CustomEvent('iframe-event', { detail: 'iframe event dispatched from parent' });
        document.dispatchEvent(event);
    }); 
```

此外，如果在任何情况下您需要在新选项卡中打开此框架，您仍然可以使用事件进行通信。从您的框架/标签：

```
if (opener) {
        const event = new CustomEvent('frame-ready', { detail: 'parent event dispatched from new tab' });
        opener.document.dispatchEvent(event);
    } 
```

从你的父母/开瓶器：

```
window.open('my-frame.html', '_blank');

document.addEventListener('frame-ready', (e) => {
    const event = new CustomEvent('iframe-event', { detail: 'iframe event dispatched from parent' });
    document.dispatchEvent(event);
}); 
```

请注意 window.open 会将您的 DOM 暴露给它打开的下一页，因此如果您使用它打开任何第三方 url，则必须始终使用 rel=noopener 以避免安全问题：

```
window.open('third-part-url.html', '_blank', 'noopener'); 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-11-06T09:10:25.723

您要做的是将值作为参数附加到 iframe src (URL) 中。

例如`<iframe src="some_page.php?somedata=5&more=bacon"></iframe>`

然后在`some_page.php`你用来`php $_GET['somedata']`从 iframe URL 中检索它的文件中。注意：iframe 在您的文件中作为单独的浏览器窗口运行。

# c# - 如何从 C# 调用 MSBuild

> ID：536539
> 
> 赞同：26
> 
> 时间：2009-02-11T12:21:14.153
> 
> 标签：c#, .net, msbuild

从 C#/.NET 调用 MSBuild 是否有比使用 msbuild.exe 更好的方法？如果是，如何？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-11T12:24:32.600

[是的，添加对Engine](http://msdn.microsoft.com/en-us/library/microsoft.build.buildengine.engine.aspx)类的引用`Microsoft.Build.Engine`并使用它。

PS：注意参考正确的版本。有 2.0 和 3.5 程序集，您必须[确保每个人都得到正确的](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/2772a075-4e2f-42af-9e7a-2228b794368e/)程序集。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-08-29T00:07:02.830

对于特定于 .NET 2.0 的版本，您可以使用以下内容：

```
Engine engine = new Engine();
engine.BinPath = System.Environment.GetFolderPath(System.Environment.SpecialFolder.System)
    + @"\..\Microsoft.NET\Framework\v2.0.50727";

FileLogger logger = new FileLogger();
logger.Parameters = @"logfile=C:\temp\test.msbuild.log";
engine.RegisterLogger(logger);

string[] tasks = new string[] { "MyTask" };
BuildPropertyGroup props = new BuildPropertyGroup();
props.SetProperty("parm1","hello Build!");

try
{
  // Call task MyTask with the parm1 property set
  bool success = engine.BuildProjectFile(@"C:\temp\test.msbuild",tasks,props);
}
catch (Exception ex)
{
  // your error handler
}
finally
{
 engine.UnregisterAllLoggers();
 engine.UnloadAllProjects();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-26T04:50:08.490

如果你使用`Microsoft.Build.Engine.Engine`，你会得到一个警告：`This class has been deprecated. Please use Microsoft.Build.Evaluation.ProjectCollection from the Microsoft.Build assembly instead.`

现在，从 C# 运行 MSBuild 的正确方法如下所示：

```
public sealed class MsBuildRunner
{

    public bool Run(FileInfo msbuildFile, string[] targets = null, IDictionary<string, string> properties = null, LoggerVerbosity loggerVerbosity = LoggerVerbosity.Detailed)
    {
        if (!msbuildFile.Exists) throw new ArgumentException("msbuildFile does not exist");

        if (targets == null)
        {
            targets = new string[] {};
        }
        if (properties == null)
        {
            properties = new Dictionary<string, string>();
        }

        Console.Out.WriteLine("Running {0} targets: {1} properties: {2}, cwd: {3}",
                              msbuildFile.FullName,
                              string.Join(",", targets),
                              string.Join(",", properties),
                              Environment.CurrentDirectory);
        var project = new Project(msbuildFile.FullName, properties, "4.0");
        return project.Build(targets, new ILogger[] { new ConsoleLogger(loggerVerbosity) });
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-20T15:45:13.063

如果您想要的只是 MSBuild 工具文件夹的路径，则可以使用 Microsoft.Build.Utilities.Core 程序集中的[`ToolLocationHelper`类](https://msdn.microsoft.com/en-us/library/microsoft.build.utilities.toollocationhelper.aspx)：

```
var toolsetVersion = ToolLocationHelper.CurrentToolsVersion;
var msbuildDir = ToolLocationHelper.GetPathToBuildTools(toolsetVersion); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-15T06:05:01.673

CurrentToolsVersion 在 ToolLocationHelper 类中不可用，我在这里使用 V

# sql - DB2 关系表

> ID：536543
> 
> 赞同：0
> 
> 时间：2009-02-11T12:21:42.810
> 
> 标签：sql, schema, db2

是否可以创建一个数据库，使得数据库中有 2 个跨 2 个不同模式的表相互引用？

我想用一个例子来澄清我的问题。

考虑表格`EMPLOYEE (empID, empName, deptId)`和`DEPARTMENT (deptId, deptName)`。我们可以对`EMPLOYEE.deptId`. 在这种情况下，我可以让这两个表跨越两个不同的模式并且仍然施加约束吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T02:28:47.493

答案是肯定的。DB2 不要求外键关系中的两个表都驻留在同一个模式中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T12:32:55.420

你的意思是通过外键或连接？

当然：只需始终在表名前面加上模式名称和“。” （点）。像这样：

```
select t1.id, t2.id from schema1.table1 t1 join schema2.table2 t2 on t1.fid = t2.id 
```

# wcf - WCF 的 netTcpBinding 中 closeTimeout 的默认值是多少？

> ID：536548
> 
> 赞同：0
> 
> 时间：2009-02-11T12:23:27.907
> 
> 标签：wcf, timeout, wcf-binding

WCF 的 netTcpBinding 中 closeTimeout 的默认值是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T12:25:36.577

默认值为 1 分钟。

# c# - 字符串到时间格式，但如何？

> ID：536552
> 
> 赞同：1
> 
> 时间：2009-02-11T12:24:52.913
> 
> 标签：c#, .net, sql, datetime

我想将值从`int`或`string`格式更改为`datetime`格式。SQL中有如下函数吗？：

```
    功能：结果            

    TimeAdd(nextrundate,"sec",45) 00:00:45
    TimeAdd(nextrundate,"min",45) 00:45:00
    TimeAdd(nextrundate,"hour",4) 04:00:00

但：

    TimeAdd(nextrundate,"min",70) 01:10:00
    TimeAdd(nextrundate,"min",190) 03:10:00

```

在 C# 中是否也有一种方法可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T12:29:14.040

你的意思是：

*   TimeSpan.FromSeconds(双)
*   TimeSpan.FromMinutes(double)

请参阅 MSDN： http: [//msdn.microsoft.com/en-us/library/system.timespan_members (VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.timespan_members(VS.80).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T12:30:23.117

```
System.TimeSpan s = new TimeSpan();
s.Add(new TimeSpan(days, hours, minutes, seconds, milliseconds)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T19:16:22.170

在 SQL 中，你可以使用类似的东西

convert(varchar(8),dateadd(second,45,nextrundate),114) convert(varchar(8),dateadd(minute,45,nextrundate),114) convert(varchar(8),dateadd(hour,4,nextrundate) ),114)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T13:51:04.953

日期时间 d = 新日期时间（）；d = d.AddMinutes(70); Console.WriteLine(d.ToString("yyyy-MM-dd HH:mm:ss"));

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T12:35:15.010

在 C# 中，您可以使用 DateTime 和 TimeSpan 类。

```
DateTime rundate = DateTime.Now();
DateTime nextRunDate= rundate .AddDays(1);
TimeSpan oneDay=(TimeSpan)(nextRunDate-rundate); 
```

分钟，秒等有类似的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T13:55:07.063

```
DateTime d = new DateTime();
d = d.AddMinutes(70);
Console.WriteLine(d.ToString("yyyy-MM-dd HH:mm:ss")); 
```

# actionscript-3 - 如果 TextArea 字体为空白，则不会更改（用于编辑）

> ID：536557
> 
> 赞同：2
> 
> 时间：2009-02-11T12:25:45.297
> 
> 标签：actionscript-3, flex3

我有一个用于编辑的文本字段 (flash.display.textField)，但默认字体不会改变，除非我在其中放置一些数据，例如使用 AppendText() 或 .Text=""

```
private var editarea:TextField
editarea.setTextFormat(FontFormat);
editarea.appendText (""); // = " "; // font stays wrong if blank
editarea.setTextFormat(FontFormat); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T12:30:17.267

editarea.defaultTextFormat = 字体格式；

# svn - 从 SVN 迁移到 TFS 的工具

> ID：536564
> 
> 赞同：27
> 
> 时间：2009-02-11T12:27:07.430
> 
> 标签：svn, tfs, migration, tfs-migration

谁能推荐一个从 SVN 迁移到 TFS 的工具？最好是开源的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-06-11T12:28:08.733

看到作为原始答案被接受的 codeplex 项目现在已经关闭，我认为注意微软在此处列出了许多转换工具会很有用：[源代码控制迁移工具](http://msdn.microsoft.com/en-us/vstudio/bb840033.aspx)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-12T16:09:00.087

您可以尝试使用 codeplex 项目[SVN to TFS Migration Tool](http://www.codeplex.com/MigrationSyncToolkit/WorkItem/View.aspx?WorkItemId=78)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-10T11:44:42.583

试试这个通过迁移提供免费解决方案的链接：

SVN -> GIT -> TFS

[http://www.incyclesoftware.com/2013/08/migrate-svn-to-tfs-its-free/](http://www.incyclesoftware.com/2013/08/migrate-svn-to-tfs-its-free/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T12:54:25.430

你可能想看看这个讨论：[这个讨论](http://social.msdn.microsoft.com/Forums/en-US/tfsversioncontrol/thread/dafc9550-1c17-40ae-ad0a-fc463b336507/)。其中命名了两个工具。顺便说一句，我以另一种方式迁移的经验非常糟糕。从 TFS 中获取历史记录非常困难，并且需要自定义编码。只是让你知道。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-26T05:19:39.160

你可以试试：

*   [www.kyrosoft.com/products/index2.html](http://www.kyrosoft.com/products/index2.html)
*   [www.microsoft.com/india/vsts/third_party_products.aspx](http://www.microsoft.com/india/vsts/third_party_products.aspx)

# javascript - 使用 outerHTML 重写 html 时避免页面刷新

> ID：536571
> 
> 赞同：0
> 
> 时间：2009-02-11T12:29:17.287
> 
> 标签：javascript, flash, internet-explorer-7, refresh

我必须使用 node.outerHTML 读取、更改和重写 HTML OBJECT 标记。在 IE7 上。

当我这样做时，屏幕会短暂刷新。我猜想当我编写 HTML 时浏览器会重新绘制屏幕。实际的 OBJECT 标记数据与以前相同，只有一个参数 (wmode) 发生了变化。对象的大小和其他参数保持不变。

知道如何避免屏幕“闪烁”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:28:56.410

如果您将 OBJECT 包装在容器中并改用 innerHTML，这有什么不同吗？

或者，您可以通过直接操作对象来更改参数的值吗？

我对可能解决方案的最后猜测是将对象移出可见屏幕（可见性：隐藏，或位置：绝对 + 左侧：-10000）并尝试在该点执行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T13:30:24.080

如果您要重写整个标签，那么重新渲染对象是有意义的。是否可以仅编写 WMODE 参数/属性？在这种情况下，您可能不会获得刷新。

# security - 密码哈希的非随机盐

> ID：536584
> 
> 赞同：91
> 
> 时间：2009-02-11T12:33:10.240
> 
> 标签：security, authentication, hash, cryptography, password-protection

更新：我最近从[这个问题](https://security.stackexchange.com/q/379/33)中了解到，在下面的整个讨论中，我（我相信其他人也这样做）有点令人困惑：我一直称之为彩虹表的东西实际上被称为哈希表。彩虹表是更复杂的生物，实际上是 Hellman Hash Chains 的一种变体。尽管我相信答案仍然是相同的（因为它不归结为密码分析），但某些讨论可能有点歪曲。
问题：“[什么是彩虹表，它们是如何使用的？](https://security.stackexchange.com/q/379/33) ”

* * *

通常，我总是建议使用加密强度高的随机值作为盐，与散列函数（例如密码）一起使用，例如防止彩虹表攻击。

但是，盐在加密上是否真的有必要是随机的？在这方面是否有任何唯一值（每个用户唯一，例如 userId）就足够了？事实上，它会阻止使用单个彩虹表来破解系统中的所有（或大部分）密码......
但是缺乏熵真的会削弱散列函数的加密强度吗？

* * *

注意，我不是在问为什么要使用盐，如何保护它（它不需要），使用单个常量哈希（不要），或者使用什么样的哈希函数。
只是盐是否需要熵。

* * *

到目前为止，感谢所有人的回答，但我想专注于我（有点）不太熟悉的领域。主要是对密码分析的影响——如果有人对密码数学 PoV 有一些意见，我将不胜感激。
此外，如果还有其他未考虑的向量，那也是很好的输入（请参阅@Dave Sherohman 关于多个系统的观点）。
除此之外，如果您有任何理论、想法或最佳实践 - 请用证据、攻击场景或经验证据支持这一点。甚至是对可接受的权衡的有效考虑......我熟悉这个主题的最佳实践（资本 B 资本 P），我想证明这实际上提供了什么价值。

* * *

编辑：这里有一些非常好的答案，但我认为正如@Dave 所说，它归结为常见用户名的彩虹表......以及可能不太常见的名称。但是，如果我的用户名是全球唯一的怎么办？对于我的系统来说不一定是唯一的，但对于每个用户来说都是独一无二的——例如电子邮件地址。
没有动力为单个用户构建 RT（正如@Dave 强调的那样，盐不是保密的），这仍然会阻止集群。唯一的问题是我可能在不同的站点上拥有相同的电子邮件和密码 - 但无论如何盐不会阻止这种情况。
所以，它回到密码分析——熵是否必要？（我目前的想法是从密码分析的角度来看没有必要，但出于其他实际原因。）

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-02-11T13:28:13.227

Salt 传统上存储为哈希密码的前缀。这已经让任何有权访问密码哈希的攻击者都知道了。是否使用用户名作为盐不会影响该知识，因此，它不会影响单系统安全性。

但是，使用用户名或任何其他用户控制的值作为盐会降低跨系统安全性，因为在使用相同密码散列算法的多个系统上具有相同用户名和密码的用户最终会得到相同的密码散列这些系统中的每一个。我不认为这是一项重大责任，因为作为攻击者，我会先尝试已知目标帐户已在其他系统上使用过的密码，然后再尝试任何其他方式来破坏该帐户。相同的哈希值只会提前告诉我已知密码会起作用，它们不会使实际攻击变得更容易。（但请注意，帐户数据库的快速比较将提供更高优先级目标的列表，因为它会告诉我谁在重用密码，谁没有重用密码。）

这个想法的更大危险是用户名通常会被重复使用——例如，几乎任何你想访问的网站都会有一个名为“Dave”的用户帐户，而“admin”或“root”甚至更常见——这会使构建针对具有这些通用名称的用户的彩虹表更容易和更有效。

这两个缺陷都可以通过在散列密码之前向密码添加第二个盐值（固定和隐藏或像标准盐一样暴露）来有效解决，但是，在这一点上，你也可以使用标准熵盐代替将用户名放入其中。

**编辑添加：** 很多人都在谈论熵以及盐中的熵是否重要。它是，但不是因为大多数评论似乎认为的原因。

一般的想法似乎是熵很重要，因此攻击者很难猜到盐。这是不正确的，事实上，完全不相关。正如许多人多次指出的那样，受盐影响的攻击只能由拥有密码数据库的人进行，拥有密码数据库的人可以查看每个帐户的盐是什么。当您可以轻松查找它时，它是否可以猜测并不重要。

熵很重要的原因是为了避免盐值的聚类。如果盐是基于用户名的，并且您知道大多数系统都有一个名为“root”或“admin”的帐户，那么您可以为这两种盐制作一个彩虹表，它将破解大多数系统。另一方面，如果使用随机的 16 位盐并且随机值大致均匀分布，那么您需要一个彩虹表来存储所有 2^16 种可能的盐。

这不是要阻止攻击者知道个人帐户的盐是什么，而是要不给他们一个大而肥的目标，这种盐将用于相当大比例的潜在目标。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-11T13:40:13.573

**使用高熵盐对于安全地存储密码是绝对必要的。**

获取我的用户名“gs”并将其添加到我的密码“MyPassword”中会得到 gsMyPassword。使用彩虹表很容易打破这一点，因为如果用户名没有足够的熵，则可能是该值已经存储在彩虹表中，尤其是在用户名很短的情况下。

另一个问题是您知道用户参与了两个或多个服务的攻击。有很多常见的用户名，可能最重要的用户名是 admin 和 root。如果有人创建了一个彩虹表，其中包含最常见用户名的盐，他可以使用它们来破坏帐户。

[他们曾经有一个 12-bit salt](http://en.wikipedia.org/wiki/Salt_(cryptography))。12 位是 4096 种不同的组合。这还不够安全，因为[现在可以轻松存储这么多信息](http://en.wikipedia.org/wiki/Password_cracking#Early_Unix_password_vulnerability)。这同样适用于 4096 个最常用的用户名。您的一些用户可能会选择属于最常见用户名的用户名。

我找到了这个[密码检查器](http://rumkin.com/tools/password/passchk.php)，它可以计算出你密码的熵。在密码中具有较小的熵（例如通过使用用户名）使得彩虹表更容易，因为它们试图覆盖至少所有具有低熵的密码，因为它们更有可能发生。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-10-26T17:18:18.847

确实，单独的用户名可能是有问题的，因为人们可能会在不同的网站之间共享用户名。但是，如果用户在每个网站上使用不同的名称，这应该是没有问题的。那么为什么不让它在每个网站上都是独一无二的呢。哈希密码有点像这样

hashfunction("www.yourpage.com/"+username+"/"+password)

This should solve the problem. I'm not a master of cryptanalysis, but I sure doubt that the fact that we don't use high entropy would make the hash any weaker.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-11T13:34:18.987

我喜欢同时使用这两种方法：每条记录的高熵随机盐，以及记录本身的唯一 ID。

尽管这并没有增加对字典攻击等的安全性，但它确实消除了有人将他们的盐和哈希复制到另一条记录以用他们自己的密码替换密码的边缘情况。

（诚​​然，很难想到这种情况适用，但在安全方面，我认为安全带和背带没有任何危害。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-11T12:44:43.583

散列函数的强度不是由它的输入决定的！

使用攻击者已知的盐显然会使构建彩虹表（特别是对于像**root**这样的硬编码用户名）更具吸引力，但它不会削弱*hash*。使用攻击者未知的盐将使系统更难攻击。

用户名和密码的连接可能仍然为智能彩虹表提供一个条目，因此使用一系列伪随机字符的盐，与散列密码一起存储可能是一个更好的主意。例如，如果我有用户名“potato”和密码“beer”，则您的哈希的串联输入是“potatobeer”，这是彩虹表的合理条目。

每次用户更改密码时更改盐值可能有助于抵御长时间的攻击，实施合理的密码策略（例如混合大小写、标点符号、最小长度、*n*周后更改）也将有助于抵御长期攻击。

但是，我想说您选择的摘要算法更重要。例如，对于生成彩虹表的人来说，使用 SHA-512 比使用 MD5 更痛苦。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-11T13:21:57.893

如果盐是已知的或容易猜到的，那么您并没有增加字典攻击的难度。甚至可以创建一个修改后的彩虹表，将“恒定”盐考虑在内。

使用独特的盐增加了 BULK 字典攻击的难度。

具有独特的、加密的强盐值将是理想的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-11T13:51:40.613

我会说，只要每个密码的盐不同，你就可以了。加盐的要点是，您不能使用标准的彩虹表来解决数据库中的每个密码。因此，如果您对每个密码应用不同的盐（即使它不是随机的），攻击者基本上必须为每个密码计算一个新的彩虹表，因为每个密码使用不同的盐。

使用具有更多熵的盐并没有多大帮助，因为在这种情况下假定攻击者已经拥有数据库。由于您需要能够重新创建哈希，因此您必须已经知道盐是什么。因此，无论如何，您都必须将盐或构成盐的值存储在文件中。在像 Linux 这样的系统中，获取盐的方法是已知的，因此拥有秘密盐是没有用的。您必须假设拥有您的哈希值的攻击者也可能知道您的盐值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-11T13:06:36.900

Salt应该具有尽可能多的熵，以确保如果给定的输入值被多次散列，则生成的散列值将尽可能接近，总是不同的。

在盐中使用尽可能多的熵的不断变化的盐值将确保散列的可能性（例如，密码+盐）将产生完全不同的散列值。

盐中的熵越少，生成相同盐值的机会就越大，因此生成相同哈希值的机会就越大。

当输入已知且“恒定”时，哈希值的本质是“恒定”的，这使得字典攻击或彩虹表如此有效。通过尽可能多地改变生成的哈希值（通过使用高熵盐值）确保对相同的输入+随机盐进行哈希处理会产生许多不同的哈希值结果，从而击败（或至少大大降低）彩虹表的有效性攻击。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-11T12:40:59.207

熵是盐值的点。

如果盐背后有一些简单且可重复的“数学”，那么它与盐不存在相同。只需添加时间价值就可以了。

# actionscript-3 - 防止 TextArea() 的复制+粘贴

> ID：536588
> 
> 赞同：1
> 
> 时间：2009-02-11T12:34:57.943
> 
> 标签：actionscript-3, apache-flex, flex3

如何防止 ctrl+v 粘贴 flash.display.textarea()？

field.selectable = false; 似乎不起作用，它也禁用插入符号/光标

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T13:36:24.363

这似乎在 TextEvent 侦听器中有效，任何评论是避免复制+粘贴到字段的解决方案太糟糕了吗？

```
if (evt.text.length >1) 
evt.preventDefault () ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T10:08:37.877

TextArea 是一个可编辑的文本字段。如果您想防止复制/粘贴，您应该使用另一个组件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-17T23:30:28.280

TextArea 组件有一个 textField 属性。设置 textField 的 mouseEnabled 属性应该会产生预期的效果。

```
var ta:TextArea = new TextArea();
ta.textField.mouseEnabled = false; 
```

这将禁用插入光标并阻止选择文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T10:26:49.160

如果可以，请使用不同的组件而不是 TextArea，如 Monkeye[建议](https://stackoverflow.com/questions/536588/prevent-copypaste-for-textarea/540692#540692)的那样。

如果您真的想防止复制您的文本数据，您甚至可能想要考虑直接在画布上绘制文本，因此除非用户执行 OCR 或其他操作，否则真的不可能抓取它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-27T14:40:27.733

我们有另一种解决方案

```
field.mouseChildren = false; 
```

所以它不允许复制数据

# ios - stringWithFormat 生成带有乱码字符的字符串

> ID：536589
> 
> 赞同：3
> 
> 时间：2009-02-11T12:35:00.127
> 
> 标签：ios, objective-c, iphone, xcode, nsstring

调试以下代码时

```
NSString *var1 = @"blaa";
NSString *var2 = @"blaaaaa";

NSString* script = [NSString stringWithFormat:@"Set_Variable( %s, %s )",var1,var2]; 
```

脚本中的`%s`占位符被替换为有趣的乱码字符。你能看到代码中的任何错误吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-11T12:37:46.720

%s 是 C 字符串 char* 的格式说明符

对于objective-c 对象（例如NSString），你应该使用%@

# asp.net - ASP.NET 和 System.Diagnostics 跟踪 - 我错过了什么，还是这是个坏主意？

> ID：536596
> 
> 赞同：5
> 
> 时间：2009-02-11T12:37:51.493
> 
> 标签：asp.net, thread-safety, trace, system.diagnostics

出于各种常见原因，我想对我的 ASP.NET 应用程序使用跟踪。特别是因为我发现了使用[服务跟踪查看器](http://msdn.microsoft.com/en-us/library/aa751795.aspx)工具的可能性，它允许您以一种强大的方式检查您的跟踪。

由于我之前从未使用过这个trace的东西，所以我开始研究它。经过一段时间的 Google、SO 和 MSDN，我终于对事情的运作方式有了一个很好的了解。但我也发现了一件非常令人不安的事情。

在 ASP.NET 应用程序中使用跟踪时，通过 Web 请求将跟踪消息组合在一起非常有意义。特别是因为我想使用它的原因之一是研究性能问题。上述工具还通过`<Corrleation>`在生成的 XML 文件中使用标签来支持这一点。又是从哪来的`System.Diagnostics.Trace.CorrelationManager`。它还允许其他不错的功能，例如 Activity 启动/停止，它提供了更好的跟踪消息分组。很酷，对吧？

我也是这样，直到我开始检查`CorrelationManager`实际居住的地方。毕竟 - 这是一个静态属性。在玩了一些 Reflector 之后，我发现了一些可怕的东西 - 它存储在`CallContext`！[我们不应该在 ASP.NET 中使用](http://piers7.blogspot.com/2005/11/threadstatic-callcontext-and_02.html)哪种东西，对吗？

所以......我在这里错过了什么吗？ASP.NET 中的跟踪真的存在根本缺陷吗？

**补充：** Emm，我有点自己重写这些东西的边缘。我仍然想使用整洁的工具来探索痕迹。有什么理由我不应该这样做？也许还有更好的东西？如果我能尽快得到一些答案，那就太好了。:)

**补充2：**我的一位同事证实这不仅仅是一个理论问题。他在他正在研究的系统中观察到了这一点。这样就解决了。我将建立一个新的小系统，按照我想要的方式做事。:)

**补充 3：**哇，太棒了……微软的人找不到在 ASP.NET 中使用 Correlation Manager 有什么问题。所以显然我们毕竟没有修复这个错误......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T08:17:14.867

你提出了一个非常有趣的问题。查看 Reflector 后，我还看到 CorrelationManager 正在使用 CallContext 来存储活动 ID。我没有进行过多的跟踪工作，所以我不能真正代表它跟踪的活动类型，但是如果它在页面请求的整个生命周期中跟踪单个活动，根据您上面引用的文章，那里活动 id 可能与实际活动不相关。这项活动似乎会在中途消失。

HttpContext 似乎非常适合从头到尾跟踪整个页面请求，因为即使执行更改为不同的线程，它也会继续执行。但是，HttpContext 不会像 CallContext 那样传输到您的业务对象。顺便说一句，我看到 CallContext 也可以在客户端和服务器应用程序之间使用远程处理时进行传输，这非常漂亮，但在跟踪网站的情况下，这并不是那么有用。

如果您还没有，请查看[此人的网站](http://sticklebackplastic.com/post/2007/08/14/One-mighty-gotcha-for-SystemDiagnostic-activity-Ids.aspx)。本文中描述的问题与[Cup(Of T) 文章](http://piers7.blogspot.com/2005/11/threadstatic-callcontext-and_02.html)提到的问题并不完全相同，但它仍然很有趣。他还在页面上提供了几个非常有用的链接，这些链接描述了 CorrelateionManager 的组件。

不幸的是，我对你的问题没有真正的答案，但我肯定觉得这个话题很有趣，并将继续研究它。因此，当您了解更多信息时，请更新此帖子。我很想看看你或其他人（希望有人能对这个话题有所了解）在调查这个问题时发现了什么。

无论如何，祝你好运。我会和我工作中的一些偷窥者谈谈这个问题，如果我发现任何东西，我会在以后发布更多。

克里斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T14:31:18.597

OK，就这样结束了。

我的同事打电话给微软，并向他们报告了这个错误。成为认证合作伙伴意味着我们可以访问一些优先级更高的修复队列或其他东西......不知道那些东西。无论如何，他们正在努力。希望我们能很快看到补丁。:)

同时，我创建了自己的小跟踪类。它不支持默认跟踪框架所做的所有花里胡哨，但这正是我所需要的。：） 进一步来说：

*   它写入与默认相同的 XML 格式，`XmlWriterTraceListener`因此我可以使用该工具分析日志。
*   它有一个内置的日志轮换功能——我的同事必须自己在`XmlWriterTraceListener`.
*   实际的日志记录被推迟到另一个线程，因此可以更准确地测量性能。
*   相关性现在存储在其中，`HttpContext.Items`因此 ASP.NET 线程特性不会影响它。

快乐的结局，我希望。:)

# sql-server - 在 SQL 2005 中使用 XML.modify() 在多个 XML 节点中插入一个属性

> ID：536597
> 
> 赞同：5
> 
> 时间：2009-02-11T12:38:33.817
> 
> 标签：sql-server, xml, sql-server-2005, xml-dml

我有一个从单个 select 语句创建的 @XML 文档。

```
<root>
 <node>
  <node1>
   <targetNode>
   </targetNode>
  </node1>
  <node1>
   <targetNode>
   </targetNode>
  </node1>
  <node1>
   <targetNode>
   </targetNode>
  </node1>
 </node>
 <node>
  ......
 </node>
</root> 
```

我想插入 xsi:nil 作为此文档的“targetNode”属性。

```
@XML.modify( 'insert attribute xsi:nil {"true"} into (root/node/node1/targetNode) [1]') 
```

上面将属性插入到@XML 文档中 targetNode 的第一次出现中。但是，插入语句仅适用于单个节点。有什么方法可以将此属性插入到@XML 文档中 targetNode 的所有实例中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T15:34:43.897

**我在多个节点上的 DML 操作** 中找到了一个简单而优雅的解决方案[http://blogs.msdn.com/b/denisruc/archive/2005/09/19/471562.aspx](http://blogs.msdn.com/b/denisruc/archive/2005/09/19/471562.aspx)

思路是统计有多少节点，并一一修改：

```
DECLARE @iCount int
SET @iCount = @var.value('count(root/node/node1/targetNode)','int')

DECLARE @i int
SET @i = 1

WHILE (@i <= @iCount)
BEGIN
   @xml.modify('insert attribute xsi:nil {"true"} into (root/node/node1/targetNode)[sql:variable("@i")][1]')
   SET @i = @i + 1
END 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T13:34:38.750

使用修改功能是不可能的。它仅适用于单个节点。

您可以将其作为字符串进行操作，尽管在某些情况下这绝对是丑陋的并且可能是错误的，具体取决于 XML 的实际结构。

像这样：

```
declare @xml as xml
set @xml = '<root>
 <node>
  <node1>
   <targetNode>
   </targetNode>
  </node1>
  <node1>
   <targetNode>
   </targetNode>
  </node1>
  <node1>
   <targetNode>
   </targetNode>
  </node1>
 </node>
</root>
'

set @xml = replace(cast(@xml as nvarchar(max)), '<targetNode/>', '<targetNode xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" />')
select @xml 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T14:06:58.283

您可以使用 XSINILL 参数在用于创建 xml 的选择中执行此操作。

[http://msdn.microsoft.com/en-us/library/ms178079.aspx](http://msdn.microsoft.com/en-us/library/ms178079.aspx)

（这是一个非常粗略的例子）

```
--create 2 tables and put some data in them
create table node
(
   id int identity(1,1) primary key,
   node int
)
GO
create table node1
(
   id int identity(1,1) primary key,
   nodeid int foreign key references node(id),
   targetnode int
)
GO

insert into node
select 1
GO 5

insert into node1
select 1,2
union 
select 2,null
union 
select 3,2
union 
select 4,null
--

--select statement to generate the xml
SELECT TOP(1)
   (SELECT
      (  SELECT targetnode
         FROM    node1
         WHERE   nodeid = node.id 
         FOR XML AUTO,
         ELEMENTS XSINIL,
         TYPE
      )
   FROM    node FOR XML AUTO,
   ELEMENTS,
   TYPE
   )
FROM   node FOR XML RAW('root'),
       ELEMENTS 
```

# debugging - 你最喜欢的 Grails 调试技巧是什么？

> ID：536601
> 
> 赞同：56
> 
> 时间：2009-02-11T12:40:52.670
> 
> 标签：debugging, grails

Grails 的长堆栈转储可能有点难以调试。找到问题的根源可能很棘手。例如，我在 BootStrap.groovy 中多次执行“def foo = new Foo(a: a, b: b).save()”。您最喜欢调试 Grails 应用程序的技巧是什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-16T02:08:19.063

一些一般提示：

*   清除 stacktrace.log，执行 grails run-app，然后在查看器中打开 stacktrace.log（我更喜欢`less stacktrace.log`在 linux 上）...一旦在您的查看器中，搜索 .groovy 和 .gsp ......这通常会带你到你想要的其实在乎。

*   当堆栈跟踪引用 GSP 文件中的行号时，您应该在浏览器`?showSource`中使用查询字符串打开该视图，即`http://localhost:8080/myProject/myController/myAction?showSource`...这显示已编译的 GSP 源，并且堆栈跟踪中的所有 GSP 行号都引用已编译的普惠制，而不是实际的普惠制来源

*   总是，总是，总是用至少一些最小的错误处理来围绕你的保存。

例子：

```
try {
    if(!someDomainObject.save()) {
        throw new Exception ("Save failed")
    } 
} catch(Exception e) {
    println e.toString()
    // This will at least tell you what is wrong with
    // the instance you are trying to save
    someDomainObject.errors.allErrors.each {error ->
        println error.toString()
    }
} 
```

除此之外，其中很多都归结为识别堆栈跟踪和错误消息......很多时候，Grails 在它给你的错误消息方面非常无用，但你可以学习识别模式，如下所示：

*   一些最难理解的错误是因为你没有运行`grails clean`或者`grails upgrade`......为了避免这些问题，我总是在命令行上使用以下命令来运行 grails：`grails clean; yes | grails upgrade; grails run-app`

*   如果错误与类的重复定义有关，请确保在类文件的顶部声明该类所属的包

*   如果错误与模式元数据、连接、套接字或类似的东西有关，请确保您的数据库连接器位于 中`lib/`，确保您`DataSource.groovy`的用户名、密码和主机在数据库中和数据库中的权限都是正确的，并确保您知道连接器版本的来龙去脉（即 mysql 连接器版本 5.1.X 有一个奇怪的别名问题，可能需要您`useOldAliasMetadataBehavior=true`在 url 中设置`DataSource.groovy`）

等等。有很多模式需要学习识别。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-16T21:19:00.543

*   为了增加 Chris King 关于保存的建议，我写了一个可重用的闭包：

    ```
     Closure saveClosure = { domainObj ->
          if(domainObj.save())
              println "Domain Object $domainObj Saved"
          else
          {
                  println "Errors Found During Save of $domainObj!"
                  println domainObj.errors.allErrors.each {
                      println it.defaultMessage
                  }
          }
       } 
    ```

然后你可以在任何地方使用它，它会处理错误报告：

```
 def book = new Book(authorName:"Mark Twain")
  saveClosure(book) 
```

*   此外，我使用了[调试插件](http://www.grails.org/Debug+Plugin)——它允许额外的日志记录，并且我在 main 的底部添加了标签——这让我可以查看会话/请求中的所有变量。

*   [运行时日志插件](http://www.grails.org/Runtime+Logging+Plugin)允许在运行时启用日志记录。

*   在编写此答案时，[P6SPY 插件](http://www.grails.org/p6spy+plugin)似乎也很有用 - 它通过充当代理记录您的应用程序对数据库所做的所有语句。

*   Grails 控制台也很有用。我用它来交互式地探索和试验一些代码，这在调试过程中也很方便。

*   当然，能够单步执行 Debugger 也很不错。我切换到 IntelliJ IDEA，因为它有最好的 Grails / Groovy 支持。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-20T19:41:35.443

我曾经向一位经验丰富的 groovy 开发人员询问他如何有效地调试他的应用程序。他的回答：

> 我写测试！

他有一个很好的观点：如果你的代码有足够的单元和集成测试，你几乎不需要调试任何东西。另外，您还可以对您的开发人员同事说这样的自鸣得意的话……

对于 Grails：

*   [单元测试](http://grails.org/Unit+Testing)
*   [功能测试](http://grails.org/Functional+Testing)
*   真正优秀的 grails 应用程序测试[developerWorks 文章](http://www.ibm.com/developerworks/java/library/j-grails10148/index.html?ca=drs-)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-10-12T18:27:40.283

使用 GrailsUtil 记录异常。

```
try{
   ...
}catch (Exception e){
   log.error("some message", GrailsUtil.sanitize(e))
   ...
} 
```

[有关消毒的更多信息。](http://www.grails.org/doc/latest/api/grails/util/GrailsUtil.html#sanitize(java.lang.Throwable))

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-01-02T01:48:54.950

我不确定这是否可以开箱即用，但在 web 应用程序中，我发现有一个“我是谁？”很有用。各种视图文件中的设施。

这个想法是将消息发送到呈现的 HTML 中，以识别片段。当我第一次遇到应用程序时尤其如此。

在 Grails 中，我使用自定义标记来执行此操作。例如，考虑一个学生的 list.gsp：

```
<g:debug msg="student list" /> 
```

这是代码：

```
class MiscTagLib {
    def debug = { map ->
        if (grailsApplication.config.grails.views.debug.mode == true) {
            def msg = map['msg']
            out << "<h2>${msg}</h2><br/>"
        }
    }
} 
```

关键是如果需要，您可以将这些标签保留在其中，因为它们仅在 Config.groovy 中启用该模式时才会出现：

```
grails.views.debug.mode=true 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-12-05T16:22:17.693

将此代码添加到 Bootsrap.groovy:init 将覆盖 save 方法并同时执行一些其他代码，在这种情况下打印出错误消息。

```
class BootStrap {

    def grailsApplication

    def init = {servletContext ->

        grailsApplication.domainClasses.each { clazz ->
            clazz.clazz.get(-1)

            def gormSave = clazz.metaClass.getMetaMethod('save')

            clazz.metaClass.save = {->

                def savedInstance = gormSave.invoke(delegate)
                if (!savedInstance) {
                    delegate.errors.each {
                        println it
                    }
                }
                savedInstance
            }

            def gormSaveMap = clazz.metaClass.getMetaMethod('save', Map)
            clazz.metaClass.save = { Map m ->
                def savedInstance = gormSaveMap.invoke(delegate, m)
                if (!savedInstance) {
                    delegate.errors.each {
                        println it
                    }
                }
                savedInstance

            }

            def gormSaveBoolean = clazz.metaClass.getMetaMethod('save', Boolean)
            clazz.metaClass.save = { Boolean b ->
                def savedInstance = gormSaveBoolean.invoke(delegate, b)
                if (!savedInstance) {
                    delegate.errors.each {
                        println it
                    }
                }
                savedInstance

            }
        }
...
} 
```

希望对某人有所帮助:)

（我知道它不是很干）

参考： http: [//grails.1312388.n4.nabble.com/How-to-override-save-method-on-domain-class-td3021424.html](http://grails.1312388.n4.nabble.com/How-to-override-save-method-on-domain-class-td3021424.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-05-30T15:11:26.137

看源代码！这已经救了我很多次了！现在代码托管在 GitHub 上，比以往任何时候都容易。只需按“t”并开始输入即可找到您要查找的课程！

[http://github.com/grails/grails-core](http://github.com/grails/grails-core)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-12T00:36:14.383

[以下是@groovymag](http://twitter.com/groovymag)在 Twitter 上从 Grails 人那里收集的一些技巧：

[http://blog.groovymag.com/2009/02/groovygrails-debugging/](http://blog.groovymag.com/2009/02/groovygrails-debugging/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-18T04:16:56.287

对于简单的应用程序，我使用 println 语句。这是非常简单的技巧。对于复杂的应用程序，使用 intellij idea 中的调试模式。

# jquery - jquery UI - 简单的例子，我做错了什么？

> ID：536605
> 
> 赞同：1
> 
> 时间：2009-02-11T12:41:33.293
> 
> 标签：jquery, jquery-ui

我正在尝试将一些 jquery UI 代码放入现有的 asp.net 应用程序中，并且可以使用帮助之手...

我有一个按钮，当用户单击它时，我想弹出一个带有两个 go/nogo 确认按钮的 jquery UI 对话框。

这有效，除非当我单击按钮时，它会打开然后立即关闭......作为一个新的 jquery 用户，我确信我只是错过了一些简单的东西......

这是打开对话框的javascript：

```
<script type="text/javascript" >

    $(function() {
    // Cancel Event Dialog Box
    $('#CancelDialog').dialog({
        autoOpen: false,
        width: 500,
        buttons: {
            "Cancel This Event": function() {$(this).dialog("close");}, 
            "Do Not Cancel": function() {$(this).dialog("close");} 
        }
    });

});
</script> 
```

这是调用它的代码：

```
<asp:Button id="btnCancelMeeting" Text="Cancel Event" runat="server" />
 <script language="javascript" type="text/javascript">  
    $(document).ready(function() {  
    $('#CancelDialog').dialog();  
    $('#btnCancelMeeting').click(function() {$('#CancelDialog').dialog('open'); });  
         });  
</script>

<div id="CancelDialog" title="Cancel and Event or Meeting"><p>Cancel this event.</p></div> 
```

回顾一下：我单击按钮，我得到了带有两个按钮和我想要的消息的对话框，但它在大约 1 秒后自行关闭......我做错了什么？

**编辑：**好的，现在我想我知道发生了什么......当我单击按钮时，对话框会根据需要弹出，但随后页面会再次从服务器重新加载......这会重置整个页面，包括清除对话。

所以我真正想要发生的是模仿这种行为：

```
<asp:Button id="btnDelete" Text="Delete Event" runat="server" OnClientClick='javascript:return confirm(&quot;Are you sure you would like to permanently delete this event/meeting? This action cannot be undone.&quot;)' OnClick="btnDelete_Click" /> 
```

如果点击生成客户端事件，则只有选择“确定”，该页面才会强制重新加载。谁能给出将这个 queryUI 对话框挂在 OnClientClick 事件之外的语法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T14:17:06.683

所以你想在事件触发服务器之前捕获它，对吧？

首先，您需要取消 Click 事件，将该按钮仅用作普通按钮，将当前按钮更改为：

```
<asp:Button id="btnShowDialog" Text="Delete Event" runat="server" OnClientClick="$('#myDialog').dialog('open');" /> 
```

或者为此，您可以使用普通链接或 html 按钮，而不是使用服务器来创建它

```
<input type="button" value"Delete Event" onclick="$('#myDialog').dialog('open');" /> 
```

这将打开对话框：

现在，您需要将触发服务器事件的 Button 放在它自己的对话框中！

您可以完成传递保存 javascript 当您单击按钮时您可以找到浏览器状态栏，换句话说，只使用 javascript 执行回发 - 您可以找到将 Button 更改为 LinkBut​​ton 的正确代码并将鼠标悬停在它上面。

更改：

```
 "Cancel This Event": function() {$(this).dialog("close");} 
```

到：

```
"Cancel This Event": function() {
    __doPostBack('btnDeleteEvent', '');
} 
```

这将与 btnDeleteEvent 执行相同的操作，**您确实需要**一个名为此名称的 LinkBut​​ton 才能实际执行单击行为（使 text = "" 因此它不会显示在页面中）。

```
<asp:LinkButton ID="btnDeleteEvent" runat="server" Text="" onclick="btnDeleteEvent_Click" /> 
```

记得在代码隐藏文件中包含要触发的事件

```
protected void btnDeleteEvent_Click(object sender, EventArgs e)
{
    // do something
} 
```

**更新**

添加：[链接到完整的源](http://pastebin.com/f3621e08e)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T12:58:22.737

去除那个

```
$('#CancelDialog').dialog(); 
```

后

```
$(document).ready(function() { 
```

试试看。

采取 2\. 提交的“按钮”的默认行为可能是导致它重新加载页面的原因。您可以尝试将 type='button' 添加到按钮，这样就不会默认提交？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T13:28:30.140

我不知道 jquery 比你好多少，但我认为做你想做的事，你应该让取消会议按钮点击返回 false：

```
$('#btnCancelMeeting').click(function() {$('#CancelDialog').dialog('open'); return false; }); 
```

然后使“取消此事件”按钮启动与服务器的取消：

```
"Cancel This Event": function() { CallFunctionThatReallyCancelsTheEvent(); $(this).dialog("close");}, 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T14:12:51.327

您不需要第一个 JavaScript，因为无论如何它都会由第二个完成（我怀疑争夺系统导致关闭）。您的第二段 JavaScript 应该位于页眉的脚本块中，并且应该如下所示。

```
<script>
  $(document).ready(function() {
  $("#btnCancelMeeting").click(function() {
      $("#CancelDialog").dialog({ 
          autoOpen: true,
          width: 500,
          buttons: {
          "Cancel This Event": function() { $(this).dialog("close"); },
          "Do Not Cancel": function() { $(this).dialog("close"); }
            } 
            });
      });
  });
</script> 
```

我有点担心 ASP.NET 按钮上的事实，因为我怀疑它会进行回发（除非您已将其关闭 - 如果内存服务有一个控制该按钮的属性）并且这也可能导致问题.

工作版本可在以下位置获得：[test.html 示例](http://cid-84dd6ce2da273835.skydrive.live.com/browse.aspx/.Public?uc=1&isFromRichUpload=1)- 我使用普通按钮而不是 ASP.NET 按钮，因为我只是想获得正确的功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T14:26:17.830

我不熟悉其中的服务器端 .NET 部分，但如果此问题发生在常规 jQuery 客户端设置中，则需要将其添加到点击处理函数中：

```
function(event){
  event.preventDefault();
  event.stopPropagation();
  $(this).dialog("open");
}
```

编辑：对不起，这将在对话框打开调用中，而不是在关闭处理程序中。

# ruby-on-rails - rails：获取文章的预告片/摘录

> ID：536619
> 
> 赞同：9
> 
> 时间：2009-02-11T12:44:27.077
> 
> 标签：ruby-on-rails, ruby, plugins, teaser

我有一个将列出新闻文章的页面。为了减少页面的长度，我只想显示一个预告片（文章的前 200 个字/600 个字母），然后显示一个“更多...”链接，单击该链接时，将展开其余部分以 jQuery/Javascript 方式撰写的文章。现在，我已经弄清楚了，甚至在一些粘贴页面上找到了以下帮助方法，这将确保新闻文章（字符串）不会在单词中间被切碎：

```
 def shorten (string, count = 30)
    if string.length >= count
      shortened = string[0, count]
      splitted = shortened.split(/\s/)
      words = splitted.length
      splitted[0, words-1].join(" ") + ' ...'
    else
      string
    end
  end 
```

我遇到的问题是我从数据库中获得的新闻文章正文是格式化的 HTML。所以如果我不走运，上面的助手会在 html 标签的中间切掉我的文章字符串，并在那里插入“more...”字符串（例如在“”之间），这会破坏我在页面上的 html .

有什么办法可以解决这个问题，还是有一个插件可以用来从 HTML 字符串生成摘录/预告片？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-11T14:27:50.260

您可以结合使用[Sanitize](http://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html)和[Truncate](http://api.rubyonrails.com/classes/ActionView/Helpers/TextHelper.html#M001711)。

```
truncate("And they found that many people were sleeping better.", 
  :omission => "... (continued)", :length => 15)
# => And they found... (continued) 
```

我正在做一个类似的任务，我有博客文章，我只想快速摘录。所以在我看来，我只是这样做：

```
sanitize(truncate(blog_post.body, length: 150)) 
```

这去掉了 HTML 标记，给了我前 150 个字符，并在视图中处理，因此它对 MVC 友好。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T13:56:58.540

[我在这里的回答](https://stackoverflow.com/questions/395783/truncate-markdown/395814#395814)应该有效。最初的问题（错误，由我提出）是关于截断降价的，但我最终将降价转换为 HTML，然后将其截断，所以它应该可以工作。

当然，如果您的网站访问量很大，您应该缓存摘录（也许在创建/更新帖子时，您可以将摘录存储在数据库中？），这也意味着您可以允许用户修改或输入他们自己的摘抄

用法：

```
>> puts "<p><b><a href=\"hi\">Something</a></p>".truncate_html(5, at_end = "...")
=> <p><b><a href="hi">Someth...</a></b></p> 
```

..和代码（从另一个答案复制）：

```
require 'rexml/parsers/pullparser'

class String
  def truncate_html(len = 30, at_end = nil)
    p = REXML::Parsers::PullParser.new(self)
    tags = []
    new_len = len
    results = ''
    while p.has_next? && new_len > 0
      p_e = p.pull
      case p_e.event_type
      when :start_element
        tags.push p_e[0]
        results << "<#{tags.last}#{attrs_to_s(p_e[1])}>"
      when :end_element
        results << "</#{tags.pop}>"
      when :text
        results << p_e[0][0..new_len]
        new_len -= p_e[0].length
      else
        results << "<!-- #{p_e.inspect} -->"
      end
    end
    if at_end
      results << "..."
    end
    tags.reverse.each do |tag|
      results << "</#{tag}>"
    end
    results
  end

  private

  def attrs_to_s(attrs)
    if attrs.empty?
      ''
    else
      ' ' + attrs.to_a.map { |attr| %{#{attr[0]}="#{attr[1]}"} }.join(' ')
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T14:43:54.467

非常感谢你的回答！然而，与此同时，我偶然发现了[jQuery HTML Truncator 插件](http://henrik.nyh.se/examples/truncator/)，它完全符合我的目的并将截断转移到客户端。它没有变得更容易:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T13:50:08.463

如果您不想在 html 元素中间拆分，则必须编写更复杂的解析器。它必须记住它是否在 <> 块的中间以及是否在两个标签之间。

即使你这样做了，你仍然会遇到问题。如果有人将整篇文章放入一个 html 元素中，由于缺少结束标记，解析器无法将其拆分到任何地方。

如果可能的话，我会尽量不要在文章中添加任何标签或将其保留在不包含任何内容的标签中（不`<div>`，等等）。这样你只需要检查你是否在一个非常简单的标签中间：

```
 def shorten (string, count = 30)
     if string.length >= count
       shortened = string[0, count]
       splitted = shortened.split(/\s/)
       words = splitted.length
       if(splitted[words-1].include? "<")
         splitted[0,words-2].join(" ") + ' ...'
       else
         splitted[0, words-1].join(" ") + ' ...'
     else
       string
     end   
  end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T10:56:36.357

我会清理 HTML 并提取第一句话。假设您有一个文章模型，其“body”属性包含 HTML：

```
# lib/core_ext/string.rb
class String
  def first_sentence
    self[/(\A[^.|!|?]+)/, 1]
  end
end

# app/models/article.rb
def teaser
  HTML::FullSanitizer.new.sanitize(body).first_sentence
end 
```

这将转换为“<b>This</b> is an <em>important</em> article！这是文章的其余部分。” 进入“这是一篇重要的文章”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-28T07:56:17.993

我使用以下解决方案解决了这个问题

安装 gem 'sanitize'

```
gem install sanitize 
```

并使用以下代码，这里的*正文*是包含 html 标签的文本。

```
<%= content_tag :div, Sanitize.clean(truncate(body, length: 200, separator: ' ', omission: "... #{ link_to '(continue)', '#' }"), Sanitize::Config::BASIC).html_safe %> 
```

给出有效 html 的摘录。我希望它可以帮助某人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-28T22:08:23.187

现在有一个名为[HTMLTruncator](https://github.com/nono/HTML-Truncator)的 gem可以为您解决这个问题。我用它来显示帖子摘录等，它非常强大。

# c# - C#中异步Web服务调用的超时

> ID：536629
> 
> 赞同：3
> 
> 时间：2009-02-11T12:48:35.350
> 
> 标签：c#, web-services, service

我正在使用 C# 并通过使用 VSTS 2008 的 Add Web Reference... 功能从客户端的 ASP.Net asmx Web 服务创建了一个代理。

而且我使用的是异步方法调用模型（即调用AsyncXXX方法，该方法将立即返回）并处理完成事件（即使从服务器端收到响应，我也会添加事件处理程序来处理完成）。

我发现如果服务器长时间没有响应，则不会触发完整事件。

我的问题是，

1.  如果在调用 AsyncXXX 方法后服务器没有响应，则不会调用完整的事件处理程序，这是预期的功能还是我的错误？

2.  有没有办法分配超时值——这样我就不会无限等待完整的事件处理程序？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T13:26:18.990

在 Web 服务的 web.config 中，您可以设置超时（如果是，您还需要更改为不处于调试模式）。这应该会导致它抛出一个异常，该异常将引发您的已完成事件。然后，您将需要检查异常以查看它是通过还是失败。

```
<system.web>
    <httpRuntime executionTimeout="120" />
</system.web> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-08T20:32:02.450

如果您希望您的 Web 服务永远不会超时，您可以将此行放在 Web 服务类中：

```
this.Timeout = System.Threading.Timeout.Infinite; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-11T13:03:55.533

`SoapHttpClientProtocol`您的代理应继承的`Timeout`属性具有从其祖先继承的属性`WebClientProtocol`。它可以回答你的第二个问题。

# c# - 将数组写入 Excel 范围

> ID：536636
> 
> 赞同：53
> 
> 时间：2009-02-11T12:51:56.343
> 
> 标签：c#, excel, interop

我目前正在尝试使用以下代码将对象数组中的数据写入 Excel 中的范围，其中`objData`只是一个字符串数组：

```
private object m = System.Type.Missing;
object[] objData = getDataIWantToWrite();

Range rn_Temp;
rn_Temp = (Range)XlApp.get_Range(RangeName, m);
rn_Temp = rn_Temp.get_Resize(objData.GetUpperBound(), 1);
rn_Temp.value2 = objData; 
```

这几乎可以工作，问题是范围被填满，但每个单元格都获得`objData`.

逆向作品，即

```
private object m = System.Type.Missing;
object[] objData = new object[x,y]

Range rn_Temp;
rn_Temp = (Range)XlApp.get_Range(RangeName, m);
rn_Temp = rn_Temp.get_Resize(objData.GetUpperBound(), 1);
objData = (object[])rn_Temp.value2; 
```

将返回一个包含工作表中所有值的数组，所以我不确定为什么读取和分配的工作方式不同。

有没有人成功地做到这一点？我目前正在逐个单元格地编写数组，但它需要处理很多（> 50,000）行，因此这非常耗时。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-02-11T13:15:01.060

这是我的方法的摘录，它将a `DataTable`（`dt`变量）转换为数组，然后将数组写入`Range`工作表（`wsh`var）上的a。您还可以将`topRow`变量更改为您希望放置字符串数组的任何行。

```
object[,] arr = new object[dt.Rows.Count, dt.Columns.Count];
for (int r = 0; r < dt.Rows.Count; r++)
{
    DataRow dr = dt.Rows[r];
    for (int c = 0; c < dt.Columns.Count; c++)
    {
        arr[r, c] = dr[c];
    }
}
Excel.Range c1 = (Excel.Range)wsh.Cells[topRow, 1];
Excel.Range c2 = (Excel.Range)wsh.Cells[topRow + dt.Rows.Count - 1, dt.Columns.Count];
Excel.Range range = wsh.get_Range(c1, c2);
range.Value = arr; 
```

当然，您不需要`DataTable`像我一样使用中间体，代码摘录只是为了演示如何在单次调用中将数组写入工作表。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-11T14:32:00.110

感谢您的指点 - Value vs Value2 参数让我获得了一组不同的搜索结果，帮助我意识到答案是什么。顺便说一句，Value 属性是一个参数化属性，必须通过 C# 中的访问器访问。这些称为 get_Value 和 set_Value，并采用可选的枚举值。如果有人感兴趣，[这很好地解释了它](http://blogs.msdn.com/eric_carter/archive/2004/09/06/225989.aspx)。

但是，可以通过 Value2 属性进行分配，这是更可取的，因为互操作文档建议不要使用 get_Value 和 set_Value 方法，原因超出了我的理解。

关键似乎是对象数组的维度。为了使调用生效，必须将数组声明为二维，即使您只分配一维数据。

我将我的数据数组声明为 an`object[NumberofRows,1]`并且赋值调用有效。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T13:01:23.353

您可以将数据放入记录集中并使用[Excel 的 CopyFromRecordset 方法](http://msdn.microsoft.com/en-us/library/aa223845.aspx)- 它比逐个单元格填充要快得多。

[您可以使用此代码](http://www.eggheadcafe.com/community/aspnet/2/10057763/convert-recordset-to-data.aspx)从数据集创建记录集。您将不得不做一些试验，看看使用这种方法是否比您目前正在做的更快。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-07-13T20:38:35.837

在我的例子中，程序查询返回 DataGridView 的数据库。然后我将它复制到一个数组中。我得到刚刚创建的数组的大小，然后将数组写入 Excel 电子表格。此代码在大约两秒内输出超过 5000 行数据。

```
//private System.Windows.Forms.DataGridView dgvResults;
dgvResults.DataSource = DB.getReport();

Microsoft.Office.Interop.Excel.Application oXL;
Microsoft.Office.Interop.Excel._Workbook oWB;
Microsoft.Office.Interop.Excel._Worksheet oSheet;
try
{
    //Start Excel and get Application object.
    oXL = new Microsoft.Office.Interop.Excel.Application();
    oXL.Visible = true;

    oWB = (Microsoft.Office.Interop.Excel._Workbook)(oXL.Workbooks.Add(""));
    oSheet = (Microsoft.Office.Interop.Excel._Worksheet)oWB.ActiveSheet;

    var dgArray = new object[dgvResults.RowCount, dgvResults.ColumnCount+1];
    foreach (DataGridViewRow i in dgvResults.Rows)
    {
        if (i.IsNewRow) continue;
        foreach (DataGridViewCell j in i.Cells)
        {
            dgArray[j.RowIndex, j.ColumnIndex] = j.Value.ToString();
        }
    }

    Microsoft.Office.Interop.Excel.Range chartRange;

    int rowCount = dgArray.GetLength(0);
    int columnCount = dgArray.GetLength(1);
    chartRange = (Microsoft.Office.Interop.Excel.Range)oSheet.Cells[2, 1]; //I have header info on row 1, so start row 2
    chartRange = chartRange.get_Resize(rowCount, columnCount);
    chartRange.set_Value(Microsoft.Office.Interop.Excel.XlRangeValueDataType.xlRangeValueDefault, dgArray);

    oXL.Visible = false;
    oXL.UserControl = false;
    string outputFile = "Output_" + DateTime.Now.ToString("yyyyMMddHHmmss") + ".xlsx";

    oWB.SaveAs("c:\\temp\\"+outputFile, Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookDefault, Type.Missing, Type.Missing,
        false, false, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlNoChange,
        Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);

    oWB.Close();
}
catch (Exception ex)
{
    //...
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-23T08:51:02.693

当您想在 Excel 工作表中编写一维数组时，**您必须对其进行转置，**并且**您不必**像我在上面读到的那样创建具有 1 列 ([n, 1]) 的二维数组！这是一个代码示例：

```
 wSheet.Cells(RowIndex, colIndex).Resize(RowsCount, ).Value = _excel.Application.transpose(My1DArray) 
```

祝你有美好的一天，吉尔斯

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-10-25T21:03:01.790

将**ExcelUtility**类添加到您的项目并享受它。

**ExcelUtility.cs**文件内容：

```
using System;
using Microsoft.Office.Interop.Excel;

static class ExcelUtility
{
    public static void WriteArray<T>(this _Worksheet sheet, int startRow, int startColumn, T[,] array)
    {
        var row = array.GetLength(0);
        var col = array.GetLength(1);
        Range c1 = (Range) sheet.Cells[startRow, startColumn];
        Range c2 = (Range) sheet.Cells[startRow + row - 1, startColumn + col - 1];
        Range range = sheet.Range[c1, c2];
        range.Value = array;
    }

    public static bool SaveToExcel<T>(T[,] data, string path)
    {
        try
        {
            //Start Excel and get Application object.
            var oXl = new Application {Visible = false};

            //Get a new workbook.
            var oWb = (_Workbook) (oXl.Workbooks.Add(""));
            var oSheet = (_Worksheet) oWb.ActiveSheet;
            //oSheet.WriteArray(1, 1, bufferData1);

            oSheet.WriteArray(1, 1, data);

            oXl.Visible = false;
            oXl.UserControl = false;
            oWb.SaveAs(path, XlFileFormat.xlWorkbookDefault, Type.Missing,
                Type.Missing, false, false, XlSaveAsAccessMode.xlNoChange,
                Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);
            oWb.Close(false);
            oXl.Quit();
        }
        catch (Exception e)
        {
            return false;
        }

        return true;
    }
} 
```

用法 ：

```
var data = new[,]
{
    {11, 12, 13, 14, 15, 16, 17, 18, 19, 20},
    {21, 22, 23, 24, 25, 26, 27, 28, 29, 30},
    {31, 32, 33, 34, 35, 36, 37, 38, 39, 40}
};

ExcelUtility.SaveToExcel(data, "test.xlsx"); 
```

最好的祝福！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-02T12:57:32.243

出于某种原因，转换为二维数组对我不起作用。但是以下方法做到了：

```
public void SetRow(Range range, string[] data)
{
    range.get_Resize(1, data.Length).Value2 = data;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-12-09T08:14:21.740

数组定义的类型似乎是关键：在我的情况下，它是一个包含 17 个项目的一维数组，必须转换为二维数组

列定义：object[,] Array = new object[17, 1];

rows object[,] Array= new object[1,17] 的定义；

value2 的代码在这两种情况下都是相同的 Excel.Range cell = activeWorksheet.get_Range(Range); cell.Value2 = 数组；

LG乔治

# java - 更新了容器中的物品信息，如何刷新？

> ID：536645
> 
> 赞同：0
> 
> 时间：2009-02-11T12:56:18.733
> 
> 标签：java

我在这里很危险，希望有人以前使用过 IT Mill Toolkit：

我有一张桌子，里面有一堆物品。我编辑其中一个——如何让表格刷新并重新渲染自己？我已经在表格和包含表格的布局上尝试了`requestRepaint()`,`requestRepaintAll()`但我无法让它自行刷新。当我重新加载页面或来回滚动（以便项目从视图中返回并返回视图）时，项目已更新。

有没有办法以编程方式让表格刷新其当前视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T12:59:35.857

物品容器没有实现这个功能吗？假设您在表中使用 IndexedContainer。AFAIK IndexedContainer 会在您更改内容时通知，然后它会向使用它作为数据源（=表）的所有内容发送通知。所以一张普通的桌子应该能把它捡起来。

编辑-检查了这个：

IndexedContainer 实现 Property.ValueChangeNotifier

表实现了运行 requestRepaint() 的 ValueChangeListener。

换句话说，您的容器还必须实现通知程序，以便可以调用自动重绘。

# uml - 学习 UML 的最佳资源是什么？

> ID：536648
> 
> 赞同：31
> 
> 时间：2009-02-11T12:57:31.977
> 
> 标签：uml

什么是学习好的 UML 设计的好方法？你多久画一次图（除了类的静态图）？学习它的最佳来源是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-11T13:17:11.443

我认为 Martin Fowler 的[“UML Distilled”](https://rads.stackoverflow.com/amzn/click/com/0321193687)是学习 UML 语法的最佳书籍。它简洁明了，信息丰富。

不幸的是，了解 UML 语法与了解如何设计并不相同。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-11T13:05:43.610

[实用的 UML](http://dn.codegear.com/article/31863)

[UML 概述](http://www.developer.com/design/article.php/1553851)

我不知道，这取决于团队有多大。我认为类/序列/用例是我最常用的。最重要的是不要过度使用图表，因为主要目标是帮助团队之间进行沟通，帮助以相同的方式理解事物，而不仅仅是制作一些无用的图表文件而不使用它们。

然而，由一组团队开发的非常复杂的系统，显然需要更多的图表，我认为，只是为了确保每个人都知道他们在做什么以及系统中的事情是如何关联的。现在有很多很好的工具可以帮助建模。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T13:22:25.987

我参与了一个项目，我们使用 Enterprise Architect 制作 UML 图，我们使用 C# 源代码来回（正向和反向工程）。

它（UML）不擅长定义每个方法的实现（使用序列图），但定义接口和类的签名（即方法的声明，而不是定义）是可以的。

它很有用，因为您可以：

*   显示一组类如何交互的图表（而在源代码中，您一次只能看到一个类）

*   具有不同类组的不同图表；有时同一个类可以出现在多个图表上。

这适用于一个需要创建设计文档的项目，并且可以从用例到设计进行跟踪。

# qt4 - QThread 向数据库发送大型查询

> ID：536660
> 
> 赞同：3
> 
> 时间：2009-02-11T13:01:25.710
> 
> 标签：qt4

我创建了这个继承自 QThread 的类，用于将数据发送到数据库服务器，你怎么看？可以改善吗？

谢谢

```
#ifndef QUERYTHREAD_H
#define QUERYTHREAD_H

＃包括

类 QSqlQuery；

类查询线程：公共 QThread {
    公共插槽：
        bool exec(QSqlQuery *query, Priority priority=InheritPriority);
    受保护：
        虚空运行（）；
    私人的：
        布尔 m_hasError;
        QSqlQuery *q;
};

#endif // QUERYTHREAD_H
```

```
#include "querythread.h"

＃包括
＃包括

bool QueryThread::exec(QSqlQuery *query, Priority 优先级)
{
    q=查询；
    开始（优先级）；
    while(isRunning()) qApp->processEvents();
    返回 m_hasError;
}

无效查询线程::运行()
{ m_hasError=q->exec(); }
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-10T14:17:33.277

几点意见：

该`while`循环`exec`消除了拥有单独线程的优势。您应该在构造函数中传递查询，每个查询有一个线程，**不要**覆盖`exec`，更喜欢只使用[start](http://doc.qt.nokia.com/latest/qthread.html#start)并使用信号来异步报告任何错误。

您还应该按值传递 QSqlQuery 或将其存储在托管指针中，例如`std::auto_ptr`（或`std::unique_ptr`用于 C++11）。许多 Qt 类是[隐式共享](http://doc.qt.nokia.com/latest/implicit-sharing.html)的（尽管不是这个），但托管指针为您提供异常安全性。

就个人而言，我会简单地做这样的事情

```
class Query : public QThread {

    QSqlQuery m_query;
    // I prefer values unless there's a particular reason to use pointers.

public:

    Query (const QSqlQuery & query)
    : m_query (query)
    {
    }

    void run ()
    {
        emit finished (m_query .exec ());
        deleteLater ();
    }

public signals:

    void finished (bool);
};

Query * q = new Query ("SELECT foo FROM bar");

connect (q, SIGNAL (finished (bool), ...);

q -> start (); 
```

# asp.net - 从 aspx 劫持输出

> ID：536661
> 
> 赞同：0
> 
> 时间：2009-02-11T13:02:10.497
> 
> 标签：asp.net, pdf-generation

我想使用可以将 Html 转换为 PDF 的组件将 aspx 页面转换为 PDF。是否可以在回发期间重定向 aspx 页面的输出并将其作为流或字符串发送到 HtmlToPdf 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T14:19:59.140

```
protected override void Render(HtmlTextWriter writer)
{
    // setup a TextWriter to capture the page markup
    TextWriter tw = new StringWriter();
    HtmlTextWriter htw = new HtmlTextWriter(tw);

    // render the page into our surrogate TextWriter
    base.Render(htw);

    // convert the TextWriter markup to a string
    string pageSource = tw.ToString();

    if (convertToPDF)
    {
        // convert the page markup to a pdf
        // eg, byte[] pdfBytes = HtmlToPdf(pageSource);
    }

    // write the page markup into the output stream
    writer.Write(pageSource);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T13:24:24.703

您是否尝试发送从“HttpContext.Current.Response.OutputStream;”返回的值？在回发？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T13:40:05.867

嗨，我认为这样做的方法是使用 Reponse.Filter 属性来拦截和更改发送到页面的 HTML。

在 ASP.net 网站的这个页面上有一个 VB.net 和 C# 的教程视频和示例代码：

[http://www.asp.net/learn/videos/video-450.aspx](http://www.asp.net/learn/videos/video-450.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T14:02:03.850

您将编写一个附加到请求的 HttpFilter。这是在 ASP.NET 页面的渲染步骤编写后可以更改输出的代码。

[本文](http://aspnetresources.com/articles/HttpFilters.aspx)展示了如何做到这一点（他们将输出从 HTML 更改为有效的 XHTML，但想法是相同的）。

# actionscript-3 - TextArea() - 将文本内容作为单词列表处理

> ID：536662
> 
> 赞同：1
> 
> 时间：2009-02-11T13:02:35.083
> 
> 标签：actionscript-3, flex3

我喜欢访问 TextArea 中的项目/单词列表，例如 Word(2)。TextArea() 中是否有对它的本机支持或要使用的一些好的 List 对象？

例如

```
 1stword = TextArea.TextAsList(1)
 2ndword = TextArea.TextAsList(2) 
```

由于已经有 .htmltext，是否有一些 HTML 对象可以用来轻松制作这样的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:17:24.847

没有。只需在其中获取文本并使用 String.Split。

而且，如果有这样的方法，它也会做分裂。

# php - 使用 cookie 和 php 更改样式表（CSS）

> ID：536665
> 
> 赞同：1
> 
> 时间：2009-02-11T13:03:33.817
> 
> 标签：php, css, cookies, styles

我有一些代码可以工作并使用表单更改样式表。只要您保持浏览器窗口打开，它就可以工作。您可以返回另一个站点，样式将是您选择的样式，这很好，但是如果您关闭浏览器并返回，它将被设置为默认值。这是因为我每次都开始一个新会话，还是因为我没有设置 cookie 的有效期？那是问题一。

问题 2 是我有当前可用的下拉菜单并选择正确的样式表，但我也有一些用于文本大小的单选按钮。我希望将它们合并，但它们将使用不同的样式表工作，这些样式表只包含文本大小，因此默认文本大小是标准的，用户可以与样式表一起更改它们，但它们可以独立工作。任何人都可以建议一些编码谢谢。

以下是我目前正在使用的内容。干杯

php设置样式：

```
 if (isset($_COOKIE["selectedStyle"])) // has the cookie already been set
  {
    $style=$_COOKIE["selectedStyle"];
  }else{
$style = spring;
}

  if (isset($_POST["changeStyle"]))  // changing the style
  {
    $style=$_POST["changeStyle"];
  }

  setcookie("selectedStyle",$style); // update or create the cookie
 ?> 
```

带有适用于文本转换器的下拉菜单和单选按钮的表单：

```
<div id="headerInfo">
<p><strong>User Controls</strong></p>
  <form method="post" action="<?= $_SERVER["PHP_SELF"];?>">
Select Page Style:<br/>
<select name="changeStyle">
<option value="spring">Spring (Green)</option>
<option value="summer">Summer (Yellow)</option>
<option value="winter">Winter (Blue)</option>
<option value="autumn">Autumn (Orange)</option>
</select>
<input type="submit" name="submitstyle" value="Set Style">
  </form>
    <form method="post" action="<?= $_SERVER["PHP_SELF"];?>">
Select Font Size:<br/>
<span class="smallText">A</span><input type="radio" name="changeFontSize" value="small"/>
<span class="standardText">A</span><input type="radio" name="changeFontSize" value="standard"/>
<span class="largeText">A</span><input type="radio" name="changeFontSize" value="large"/>
<span class="xLargeText">A</span><input type="radio" name="changeFontSize" value="extraLarge"/>
</select>
<input type="submit" name="submitfont" value="Set Size">
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:09:17.453

[setcookie](http://php.net/setcookie)有一个`expire`参数，您可以使用它来设置所需的到期日期。文档有一个关于如何做到这一点的例子。

只需创建另一个带有字体大小信息的 cookie 并调用相关的样式表。单选按钮需要在`form`标签内作为 http 请求的一部分发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T19:50:57.957

当谈到字体大小调整时，我个人会说，你最好在客户端更改大小，[例如使用 jQuery](http://www.shopdev.co.uk/blog/text-resizing-with-jquery/)。我认为一般来说，如果有人在每个页面上需要更大的字体大小（为了可访问性），他们会在浏览器中增加字体大小。

尽管如果您想更改样式表元素/永久设置更高的字体大小，您也可以执行 AJAX 调用来设置 cookie/在数据库中保存记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T20:08:51.780

您最好使用`$_SESSION`跨页面保留样式。这样，即使用户关闭了 cookie，它也能正常工作，因为它会用会话 ID 为您重写 URL。

# popup - 在不使用 javascript 的情况下打开一个弹出窗口

> ID：536675
> 
> 赞同：0
> 
> 时间：2009-02-11T13:08:37.627
> 
> 标签：popup, window

如何在不使用 javascript 的情况下在代码后面（C#）中打开弹出窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:49:24.957

这是不可能的，因为“后面的代码在服务器上运行；您需要弹出窗口出现在客户端计算机上。因此您后面的代码无法触发弹出窗口”。

或者，您可以在页面中将面板显示为弹出窗口，方法是设置它的 z-index 并给出绝对位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T13:13:58.300

除了弹出窗口会激怒很多人这一事实之外，如果不使用 javascript，实际上是不可能这样做的（如果您不考虑 target="_blank"）。用后面的代码编写的代码只生成客户端代码（可以包括 javascript）或执行一些服务器端的东西。

使用闪光灯或silverlight可能还有其他解决方法，但我不确定。也许如果您进一步阐明您的目标，我可以为您的问题提供更好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T13:38:22.750

背后的代码在服务器上运行；您需要弹出窗口出现在客户端计算机上。因此，您背后的代码无法触发弹出窗口。

此外，如果您使用 javascript，您可能会发现客户端的弹出窗口阻止程序会阻止新窗口出现（除非弹出窗口是对点击的直接响应 - 无需回发 - 在这种情况下，您可以使用 <a target=" _blank"...> 如果你真的不喜欢 javascript)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-18T02:38:04.053

只需将属性添加到链接按钮或后面代码中的按钮即可。尝试使用此代码进行页面加载或按钮事件处理程序。

```
Button1.Attributes.Add("onclick","javascript: SP.UI.ModalDialog.showModalDialog
({ url: 'PopUp.aspx', title: 'Pop Up Window', width: 600, height: 500 }); return false;"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T13:14:50.843

我不认为这是可能的。你可以做的事情是打开一个定义了小宽度/高度的新窗口，所有菜单都被剥离......

# jquery - 如何在可拖动和可放置之间画一条线？

> ID：536676
> 
> 赞同：53
> 
> 时间：2009-02-11T13:08:37.720
> 
> 标签：jquery, html, jquery-ui, drawing, svg

我正在使用出色的 JQuery UI 进行“映射”，因此用户可以将一个程序中的人员“映射”到其他程序中的人员。

使用这个简单的 JQuery：

```
$(document).ready(function() {
    $("div .draggable").draggable({
        revert: 'valid',
        snap: false
    });

    $("div .droppable").droppable({
        hoverClass: 'ui-state-hover',
        helper: 'clone',
        cursor: 'move',
        drop: function(event, ui) {
            $(this)
                .addClass('ui-state-highlight')
                .find("img")
                .removeAttr("src")
                .attr("src", "_assets/img/icons/check-user-48x48.png");

            $(this).droppable('disable');

            $(ui.draggable)
                .addClass('ui-state-highlight')
                .find("img")
                .removeAttr("src")
                .attr("src", "_assets/img/icons/check-user-48x48.png");

            $(ui.draggable).draggable('disable');
        }
    });

    $("div .droppable").bind("dblclick", function() {
        $(this)
            .removeClass('ui-state-highlight')
            .find("img")
            .removeAttr("src")
            .attr("src", "_assets/img/icons/user-48x48.png");
        $(this).droppable('enable');

        EnableSource($(this));
    });
}); 
```

我明白了这一点：

![替代文字](https://i.stack.imgur.com/Cyynb.png)

**我真正想要**的是（如果可能的话）在 **Elsa**和**Kjell**之间建立一条线，这样它们之间的联系就很清楚了。

我总是可以用方框内的数字来做到这一点，但我真的很想知道如何使用线条来做到这一点。

**谢谢**。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-02-12T23:15:33.553

*   **更新 (08.Jul.2013)**更新了最新版本的库；使用 JsRender 重构 html；
*   **更新（2011 年 9 月 29 日）**添加了 GIT 回购；清理代码；更新到最新的框架版本；
*   **更新（2013 年 3 月 3 日）**固定链接与工作示例；

当前示例使用：

*   HTML 5 文档类型
*   [jQuery](http://jquery.com/) v.1.10.2
*   [jQuery UI](http://jqueryui.com/) v.1.10.3
*   [拉斐尔](http://raphaeljs.com/)v.2.0.1
*   [JsRender](https://github.com/BorisMoore/jsrender) v.1pre35 *（可选，用于 HTML 简化）*

来源

> [**Git 存储库**中的源代码](https://github.com/balexandre/Draggable-Line-to-Droppable)

 **演示

> [JSBIN 的页面演示](http://jsbin.com/aliniz/2/edit)

* * *

适用于**FF**、**IE**、**Chrome**、**Safari**和**Opera**。

测试：

*   火狐 6 和 7 .. 22
*   即 8 和 9 .. 10
*   铬 12+ .. 27
*   野生动物园 5+ .. 6
*   歌剧 11.51 .. 15

为了向大家展示，我只是做了一个小演示（我今天是一个骄傲的人！）：

> [**视频演示**](http://www.balexandre.com/temp/showFlash.aspx?swf=2009-08-19_1126_StackOverflow_DragLine.swf&w=936&h=652)

和一个小图像：

![替代文字](https://i.stack.imgur.com/qz7D4.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T10:12:07.117

我太新了，无法发布链接，但如果你在谷歌上搜索“使用 jQuery 进行简单绘图的库”，你可能会找到你要找的东西。:)

[链接在这里](http://www.openstudio.fr/Library-for-simple-drawing-with.html)

# asp.net - 我可以使用线程在 IIS 上执行长时间运行的作业吗？

> ID：536681
> 
> 赞同：87
> 
> 时间：2009-02-11T13:09:58.543
> 
> 标签：asp.net, multithreading, iis, background-process

在 ASP.Net 应用程序中，用户单击网页上的按钮，然后通过事件处理程序实例化服务器上​​的对象并调用对象上的方法。该方法转到外部系统来做一些事情，这可能需要一段时间。所以，我想做的是在另一个线程中运行该方法调用，这样我就可以通过“您的请求已提交”将控制权返回给用户。我很高兴将其作为即发即弃的方式进行，尽管如果用户可以继续轮询对象的状态会更好。

我不知道 IIS 是否允许我的线程继续运行，即使用户会话过期也是如此。想象一下，用户触发事件，我们在服务器上实例化对象并在新线程中触发方法。用户对“您的请求已提交”消息感到满意并关闭了他的浏览器。最终，此用户会话将在 IIS 上超时，但线程可能仍在运行，正在工作。IIS 会允许线程继续运行，还是会在用户会话到期后终止它并处理对象？

编辑：从答案和评论中，我了解到最好的方法是将长期运行的处理移到 IIS 之外。除此之外，这还涉及 appdomain 回收问题。在实践中，我需要在有限的时间内启动版本 1，并且必须在现有框架内工作，所以想避开服务层，因此希望只在 IIS 内启动线程。在实践中，这里的“长时间运行”只会是几分钟，网站上的并发会很低，所以应该没问题。但是，下一个版本肯定需要拆分成一个单独的服务层。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-02-11T21:53:01.407

你可以完成你想要的，但这通常是个坏主意。一些 ASP.NET 博客和 CMS 引擎采用这种方法，因为它们希望可安装在共享主机系统上，而不依赖于需要安装的 Windows 服务。通常，当应用程序启动时，他们会在 Global.asax 中启动一个长时间运行的线程，并让该线程进程将任务排队。

除了减少 IIS/ASP.NET 可用于处理请求的资源之外，当 AppDomain 被回收时，您还会遇到线程被杀死的问题，然后您必须在任务运行时处理任务的持久性，如以及在 AppDomain 恢复时开始备份工作。

请记住，在许多情况下，AppDomain 会以默认间隔自动回收，以及更新 web.config 等。

如果您可以随时处理线程被杀死的持久性和事务方面，那么您可以通过一些外部进程在您的站点上每隔一段时间发出请求来绕过 AppDomain 回收 - 这样如果站点被回收，您保证在 X 分钟内自动重新启动。

同样，这通常是一个坏主意。

编辑：以下是这种技术的一些实际应用示例：

[社区服务器：使用 Windows 服务与后台线程以计划的时间间隔运行代码在](http://web.archive.org/web/20090504010733/http://dev.communityserver.com/forums/t/459942.aspx) [网站首次启动时创建后台线程](http://professionalaspnet.com/archive/2007/09/02/creating-a-background-thread-when-the-web-site-first-starts.aspx)

编辑（来自遥远的未来） - 这些天我会使用[Hangfire](http://hangfire.io)。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2014-09-15T08:43:44.903

我不同意接受的答案。

在 ASP.NET 中使用后台线程（或以 开头的任务`Task.Factory.StartNew`）很好。与所有托管环境一样，您可能希望了解管理关闭的设施并与之合作。

`HostingEnvironment.RegisterObject`在 ASP.NET 中，您可以使用该方法注册需要在关机时正常停止的工作。请参阅[本文](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx/)和评论以进行讨论。

（正如杰拉德在他的评论中指出的那样，现在还`HostingEnvironment.QueueBackgroundWorkItem`需要`RegisterObject`为后台项目注册一个调度程序来处理。总的来说，新方法更好，因为它是基于任务的。）

至于您经常听到的一般主题是一个坏主意，请考虑部署 Windows 服务（或其他类型的额外进程应用程序）的替代方案：

*   使用 Web 部署不再进行琐碎的部署
*   不能纯粹部署在 Azure 网站上
*   根据后台任务的性质，进程可能必须进行通信。这意味着某种形式的 IPC 或服务必须访问一个公共数据库。

另请注意，某些高级方案甚至可能需要后台线程与请求在同一地址空间中运行。我认为 ASP.NET 可以做到这一点是通过 .NET 成为可能的巨大优势。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-11T16:58:17.077

您不希望将 IIS 线程池中的线程用于此任务，因为它会使该线程无法处理未来的请求。您可以查看[ASP.NET 2.0 中的异步页面](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)，但这也不是正确的答案。相反，听起来您会从中受益的是研究[Microsoft Message Queuing](http://www.microsoft.com/windowsserver2003/technologies/msmq/default.mspx)。本质上，您会将任务详细信息添加到队列中，而另一个后台进程（可能是 Windows 服务）将负责执行该任务。但底线是后台进程与 IIS 完全隔离。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-02-04T12:40:16.480

我建议使用[HangFire](http://hangfire.io/)来满足这些要求。它是一个很好的后台运行的“一劳永逸”引擎，支持不同的架构，可靠，因为它由持久性存储支持。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-01-12T20:05:12.790

这里有一个很好的线程和示例代码：[http ://forums.asp.net/t/1534903.aspx?PageIndex=2](http://forums.asp.net/t/1534903.aspx?PageIndex=2)

我什至玩过从线程调用我网站上的保持活动页面以帮助保持应用程序池活动的想法。请记住，如果您使用这种方法，您需要非常好的恢复处理，因为应用程序可以随时回收。正如许多人所提到的，如果您可以访问其他服务选项，这不是正确的方法，但对于共享主机，这可能是您唯一的选择之一。

为了帮助保持应用程序池处于活动状态，您可以在线程处理时向您自己的站点发出请求。如果您的进程运行很长时间，这可能有助于保持应用程序池处于活动状态。

```
string tempStr = GetUrlPageSource("http://www.mysite.com/keepalive.aspx");

    public static string GetUrlPageSource(string url)
    {
        string returnString = "";

        try
        {
            Uri uri = new Uri(url);
            if (uri.Scheme == Uri.UriSchemeHttp)
            {
                HttpWebRequest req = (HttpWebRequest)WebRequest.Create(uri);
                CookieContainer cookieJar = new CookieContainer();

                req.CookieContainer = cookieJar;

                //set the request timeout to 60 seconds
                req.Timeout = 60000;
                req.UserAgent = "MyAgent";

                //we do not want to request a persistent connection
                req.KeepAlive = false;

                HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
                Stream stream = resp.GetResponseStream();
                StreamReader sr = new StreamReader(stream);

                returnString = sr.ReadToEnd();

                sr.Close();
                stream.Close();
                resp.Close();
            }
        }
        catch
        {
            returnString = "";
        }

        return returnString;
    } 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-11-06T03:11:51.237

我们从这条路开始，当我们的应用程序在一台服务器上时，它实际上运行良好。当我们想要扩展到多台机器（或在 Web garen 中使用多个 w3wp）时，我们必须重新评估并研究如何管理工作队列、错误处理、重试以及正确锁定以确保只有一个的棘手问题服务器拿起下一个项目。

...我们意识到我们不从事编写后台处理引擎的业务，因此我们寻找现有的解决方案，并使用了很棒的 OSS 项目[hangfire](http://hangfire.io/)

Sergey Odinokov 创建了一个真正的 gem，它非常容易上手，并允许您更换工作如何持久化和排队的后端。Hangfire 使用后台线程，但保留作业、处理重试并让您查看工作队列。因此，hangfire 作业是强大的，并且可以在所有变幻莫测的 appdomains 被回收等情况下幸存下来。

它的基本设置使用 sql server 作为存储，但您可以在需要扩展时换成 Redis 或 MSMQ。它还具有出色的 UI，用于可视化所有作业及其状态，并允许您重新排队作业。

我的观点是，虽然它完全有可能在后台线程中做你想做的事，但要使其具有可扩展性和健壮性还有很多工作要做。它适用于简单的工作负载，但当事情变得更复杂时，我更喜欢使用专门构建的库而不是通过这项工作。

有关可用选项的更多观点，请查看 Scott Hanselman 的[博客](http://www.hanselman.com/blog/HowToRunBackgroundTasksInASPNET.aspx)，其中涵盖了在 asp.net 中处理后台作业的一些选项。（他给了hangfire一个热情洋溢的评论）

同样正如 John 所引用的，值得阅读 Phil Haack 的[博客](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx/)，了解为什么该方法存在问题，以及如何在卸载 appdomain 时优雅地停止线程上的工作。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-11T21:57:18.493

您可以创建一个 Windows 服务来完成该任务吗？然后使用 .NET remoting 从 Web Server 调用 Windows Service 来执行操作？如果是这样的话，我会这样做。

这将消除在 IIS 上中继的需要，并限制其部分处理能力。

如果不是，那么我会在该过程完成时强迫用户坐在那里。这样，您可以确保它已完成并且不会被 IIS 杀死。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-05T15:19:18.757

似乎有一种受支持的方式可以在 IIS 中托管长期运行的工作。 [工作流服务](http://msdn.microsoft.com/en-us/library/ff432975.aspx)似乎是为此而设计的，尤其是与[Windows Server AppFabric](http://msdn.microsoft.com/en-us/magazine/gg535671.aspx)结合使用。该设计通过支持自动持久化和恢复长期运行的工作来允许应用程序池回收。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-10-27T03:21:52.937

您可以在后台运行任务，即使在请求结束后它们也会完成。**不要让未捕获的异常被抛出**。通常，您希望始终抛出异常。如果在新线程中引发异常，那么它将使[IIS 工作进程崩溃 - w3wp.exe](http://geekswithblogs.net/EltonStoneman/archive/2011/09/30/uncaught-exceptions-in-task-threads-will-kill-iis---even-with-wcf-error-handling.aspx)，因为您不再处于请求的上下文中。如果您正在使用它们，那么除了进程内内存支持的会话之外，这还将杀死您正在运行的任何其他后台任务。这将很难诊断，这就是不鼓励这种做法的原因。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-13T13:21:55.050

只需创建一个代理进程来运行异步任务；它不必是 Windows 服务（尽管在大多数情况下这是更理想的方法。MSMQ 已经过时了。

# sim-toolkit - 不使用手机以编程方式访问 STK 应用程序

> ID：536682
> 
> 赞同：9
> 
> 时间：2009-02-11T13:10:25.283
> 
> 标签：sim-toolkit

我想在不使用手机的情况下以编程方式访问 STK（SIM 应用程序工具包）应用程序。GSM 调制解调器和/或手机通过 USB 和/或 RS232 连接连接到我的 PC。我正在寻找自动化与 STK 应用程序的交互。为此，我对完成此操作的方法一无所知。任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T14:14:55.920

这可以通过使用 AT+STGI 和 AT+STGR 等 AT 命令来完成。AT+STGI 用于打开 SIM 菜单 & AT+STGR 用于选择菜单。这也可以使用 GSM 调制解调器的串行端口接口以编程方式完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-17T05:56:48.647

请注意，不同的制造商有不同的 AT 命令来访问 STK 功能。而且，并非所有设备都支持运行 STK 应用程序。到目前为止，我已经设法让 ZTE MF100 工作：打开后，以下命令会派上用场：

```
AT+ZSTM                // select STK app (initialize, lists the available options in return)
AT+ZSELM=1             // select the first main menuentry (you will get the submenu options as return)
AT+ZSELI=1             // select the first submenu entry (you will get some response as well)
AT+ZINPR=2,1234567890  // this is a response, in my case i had to send a phone number. the first parameter means "numeric only", setting this to 0 will allow any characters (from the standard SMS charset)
AT+ZINPR=1,1           // this is a confirmation response (first parameter=1 means yes/no answer, second is the parameter, yes in this case)
AT+ZBK=0               // return to the main menu 
```

您应该打开 /dev/ttyUSBx 非阻塞，并轮询数据的输入，因为调制解调器不仅会响应您的请求，还会向您的客户端发送状态更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T01:59:40.177

虽然我自己没有直接与 SAT/STK 合作，但我可以提供一些信息，您可以在哪里阅读更多信息。维基[百科文章](http://en.wikipedia.org/wiki/SIM_Application_Toolkit)包含一些信息和提示，并且 GSM 11.14 标准可[在此处](http://www.3gpp.org/ftp/Specs/html-info/1114.htm)获得。

[此讨论主题](http://www.bladox.com/forum/viewtopic.php?t=236&sid=23485109e323905ee54acdb5ffb8823e)包含一些实用信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-21T11:40:34.147

对于移远通信，请点击此手册[链接](http://www.cika.com/soporte/Information/GSMmodules/Quectel/UC20/Quectel_UC20_STK_AT_Commands_Manual.pdf)

# php - 使用正则表达式将每个单独的字符匹配为自己的组？

> ID：536683
> 
> 赞同：0
> 
> 时间：2009-02-11T13:10:27.983
> 
> 标签：php, regex, pcre

在 PHP 中，我试图将每个字符匹配为自己的组。这将模仿`str_split()`. 我试过：

```
$string = '123abc456def';
preg_match_all('/(.)*/', $string, $array);
// $array = array(2) { 
//   [0]=>  array(2) { 
//      [0]=>  string(12) "123abc456def"
//      [1]=>  string(0) "" } 
//   [1]=>  array(2) { [0]=>  string(1) "f" [1]=>  string(0) "" } } 
```

我期待类似的东西：

```
//$array = array(2) { 
//   [0]=> string(12) "123abc456def", 
//   [1]=> array(12) { 
//       [0]=>  string(1) "1", [1]=> string(1) "2"
//       ... 
//       [10]=> string(1) "e", [11]=> string(1) "f" } } 
```

我想使用正则表达式而不是 a`str_split()`的原因是因为正则表达式将成为另一个正则表达式的基础。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T13:19:11.143

括号外的 * 表示您要重复捕获组。（这意味着您将只捕获最后一次迭代。）尝试任何单个字符的全局匹配，如下所示：

```
preg_match_all('/(.)/', $subject, $result, PREG_PATTERN_ORDER);
$result = $result[0]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T16:46:29.180

试试这个：

```
preg_match_all('/./s', $str, $matches) 
```

这也匹配换行符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T16:41:33.933

也许这就是你正在寻找的：

> preg_match_all('/(.)+?/', $string, $array);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-08T00:01:10.443

我不知道这是否对这个站有帮助，但你可以访问像数组这样的字符串的字母.. 所以

```
<?php
$a = "hede";
print $a[0] . "\n";
print $a[1] . "\n";
print $a[2] . "\n";
print $a[3] . "\n";
?> 
```

将输出

H

e

d

e

# delphi - 如何更改主菜单一级标题？

> ID：536687
> 
> 赞同：0
> 
> 时间：2009-02-11T13:11:30.257
> 
> 标签：delphi, winapi, menu

我在 MDI 父窗体中有一个主菜单，它作为主菜单。现在我需要在运行时更改我的第一个菜单项的第一级标题。我怎样才能做到这一点？

- - 更新 - -

对不起。我忘了告诉你 mainMenu 位于 TcontrolBar 中。我认为这是问题所在，因为到目前为止所有答案都不起作用。我以前尝试过所有这些。但这仅发生在第一级，所有其他级别都正确更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:20:37.660

也许我错过了一些东西，但这似乎很简单：

```
MainMenu1.Items[0].Caption := '&Hello'; // first top-level item
MainMenu1.Items[1].Caption := '&World'; // second top-level item, etc. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T19:56:05.933

如果您使用在 TControlBar 内添加 TToolbar 的旧技术，然后为每个顶级菜单项添加一个工具按钮，那么您在表单中看到的顶级菜单项实际上是工具按钮。直接设置他们的标题，一切都应该工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T14:18:17.913

在菜单编辑器中（在 IDE 中的设计时），单击要更改的菜单，打开属性检查器并将名称更改为相关的名称，即 MyFirstMenu。

然后在您的代码中，每当您想更改菜单项标题时，您都可以使用：

```
MyFirstMenu.Caption := 'A New Caption'; 
```

或者如果主菜单是动态构建的，请参见上面 TOndrej 给出的答案。

[编辑1]

您的意思是您可以在菜单项上成功设置标题，但在 TControlBar 上看不到更改？

# php - 包括安全

> ID：536688
> 
> 赞同：1
> 
> 时间：2009-02-11T13:11:49.010
> 
> 标签：php, include

```
<?php
if (preg_match('/^[a-z0-9]+$/', $_GET['page'])) {
$page = realpath('includes/'.$_GET['page'].'.php');
$tpl = realpath('templates/'.$_GET['page'].'.html');
if ($page && $tpl) {
    include $page;
    include $tpl;
} else {
    // log error!
}
} else {
// log error!
}
?> 
```

你会说这有多安全？Gumbo 在 Stack Overflow 上写了它。
[动态包括安全](https://stackoverflow.com/questions/524908/dynamic-include-safety/524959#524959)

我想听听你的意见。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:16:12.867

我的第一个想法不是关于安全，而是关于你为什么要这样做？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T13:18:05.843

我会说这很安全。只是不允许任何内容写入这些文件夹。PHP 文件传统上位于服务器的 Web 根目录中，这很危险。如果配置错误或 .htaccess 文件丢失，最好将正在加载的文件放置到外部绝对无法访问的区域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T13:13:50.487

你包括你自己的代码。它有多安全？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T13:21:35.663

我可以在那里看到一些潜在的问题，特别是如果'page'变量包含'..'或其他可能让他们看到他们不应该看到的东西的东西。

我在我的几个网站上做了类似的事情，但我会首先检查“页面”以确保它引用了一组允许的页面中的一个。

# javascript - JavaScript：更改浏览器窗口状态消息

> ID：536691
> 
> 赞同：4
> 
> 时间：2009-02-11T13:12:40.800
> 
> 标签：javascript, browser

曾经可以更改浏览器在窗口底部状态栏中显示的消息。由于滥用，此功能已在较新的浏览器版本中被禁用。

```
<script type="text/javascript">
window.status = 'hello world';
</script> 
```

还有什么方法可以实现这一点（考虑 jQuery 可用）？我想我仍然可以看到更改状态消息的页面，但他们可能使用 Flash 或 Java 来更改窗口状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T07:03:55.517

在没有 Flash 或 Java 的情况下，您可以做两件事：

1.  假装它：显示一个`div`看起来像状态栏的东西。

    ```
    position: fixed;
    bottom: 0;
    left: 0;
    border: 1px solid silver;
    background: #aaaaaa; 
    ```

2.  选择 URL，以便在用户将鼠标悬停在链接上时向他们显示所需的信息。

但请不要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T13:26:45.073

使用浏览器状态栏来显示页面信息在大多数情况下是一个非常糟糕的主意，浏览器不会无缘无故地禁用它。

1.  没有人往下看去寻找这样的信息。
2.  人们期望它显示*浏览器*信息。例如，当悬停链接时，我想知道我是否离开网站，是否为 mailto:-link，是否为 pdf 等。

而是使用类似橙色（黄色？）stackoverflow 在页面顶部的东西。“你是 stackoverflow 的新手吗……”、“新帖子已添加……”等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T14:02:29.120

查看仍在更改此信息的页面。如果它是由 javascript 完成的，您应该能够看到源代码。

# ajax - Ajax 本地测试

> ID：536693
> 
> 赞同：1
> 
> 时间：2009-02-11T13:12:54.433
> 
> 标签：ajax, autosuggest, spry

我是这个 Ajax 的新手。我想试试这个
[http://labs.adobe.com/technologies/spry/samples/data_region/SuggestSample.html](http://labs.adobe.com/technologies/spry/samples/data_region/SuggestSample.html)
简洁的 Autosuggest 小表格。当我将其保存在本地时，该表单不起作用。
下面是我到目前为止所做和使用的列表：

*   Firefox -> 将页面另存为 ..(index.html)
*   新文件夹（ test23 ）
*   还保存了 products.xml
*   打开 index.html
*   改变这一行：`var dsProducts = new Spry.Data.XMLDataSet("../../demos/products/products.xml", "/products/product", { sortOnLoad: "name" })`
*   进入 ：`var dsProducts = new Spry.Data.XMLDataSet("products.xml", "/products/product", { sortOnLoad: "name" })`
*   测试失败:(

谁能帮我吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T01:03:28.770

AJAX 请求无法访问本地文件系统，因此这样的请求将失败。您需要将页面放在网络服务器上。如果你想要一个本地的，安装[XAMPP](http://www.apachefriends.org/en/xampp.html)或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T23:15:16.970

我只试了大约三分钟，第一次尝试就让它工作（没有图像）。您必须记住获取所有脚本并在主 html 文件中实际指向它们。

不要忘记第 41 到 43 行的脚本标签。

克里斯

-- 补充：

我在没有任何服务器的情况下使用 Safari 作为我的浏览器在我的 Mac 的本地文件系统上进行了测试。此后我删除了这些文件，但可以轻松地再次删除并将文件上传以供下载。

# http-headers - 如何在 Python 中向 Amazon S3 发送 HEAD HTTP 请求？

> ID：536694
> 
> 赞同：2
> 
> 时间：2009-02-11T13:13:33.920
> 
> 标签：http-headers, amazon-s3, request, amazon, head

我正在尝试使用 Python 从 S3 资源中检索 HTTP HEAD 信息。不幸的是，响应总是返回 403 错误。我正在使用 [此处](https://stackoverflow.com/questions/107405/how-do-you-send-a-head-http-request-in-python)建议的代码，但不幸的是这不适用于 S3 请求。这是代码（省略了主机和密钥详细信息）：

```
>>> import httplib
>>> conn = httplib.HTTPConnection("www.mybucket.us")
>>> conn.request("HEAD", "/mykey?myparamterers")
>>> res = conn.getresponse()
>>> res.status
>>> 403 
```

该请求还发送一个签名过期作为查询字符串的一部分。

我也尝试过使用 httplib2，但 HEAD REQUEST 只是挂起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-16T21:33:54.530

如果您使用的是签名 URL，则 URL 由方法（例如 HEAD 或 GET）签名。因此，每种方法都需要不同的 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-18T10:16:23.880

403 HTTP 代码表示禁止。可能，站点管理员禁用了此方法。

尝试远程登录

```
telnet www.mybucket.us 80
HEAD http://www.mybucket.us/mykey?myparamterers
Host: www.mybucket.us
<ENTER>
<ENTER> 
```

并注意服务器响应。

或者，您可以`conn.set_debuglevel(1)`在 python 代码中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T13:22:14.537

403 告诉您发送的请求是有效的（是否正确是另一回事），但由于某种原因您无权访问请求的页面。至少您知道正在发送一个有效的 HTTP 请求。

您可以检查服务器日志吗？这可能有助于阐明问题...

我也不确定“HEAD”请求。你能不使用“GET”或“POST”并自己提取标题吗？可能是库没有实现“HEAD”......我不确定 - 我通过快速谷歌搜索能够找到的文档严重不足。

# windows-server-2003 - 确定您要连接的服务器是否是虚拟化的？

> ID：536702
> 
> 赞同：3
> 
> 时间：2009-02-11T13:15:45.053
> 
> 标签：windows-server-2003, virtualization

有没有办法确定您要连接的 win 2003 服务器服务器是否是虚拟化的？我试过问，但不能 100% 确定答案是正确的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T13:33:01.330

这是[此问题](https://stackoverflow.com/questions/39533/how-to-identify-that-youre-running-under-a-vm/ "如何识别您在虚拟机下运行？")的重复：[如何识别您在 VM 下运行？](https://stackoverflow.com/questions/39533/how-to-identify-that-youre-running-under-a-vm/ "如何识别您在虚拟机下运行？").

引用[JawnV6](https://stackoverflow.com/users/3869/jawnv6)对该问题的已[接受答案](https://stackoverflow.com/questions/39533/how-to-identify-that-youre-running-under-a-vm/39619#39619)：

> 检测 VM 的经典技巧是填充 ITLB，运行必须虚拟化的指令（当它将控制权交给管理程序时，这必然会清除此类处理器状态），然后运行更多代码来检测 ITLB 是否仍然填充. 关于它的第一篇论文位于[此处](http://www.symantec.com/avcenter/reference/Virtual_Machine_Threats.pdf)，来自研究人员博客的相当丰富的解释位于[此处](http://www.symantec.com/avcenter/reference/Virtual_Machine_Threats.pdf)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T13:24:35.827

这是一个体面的解释。您可以从 WMI 或设备管理器中检查硬件的制造商，以确定它是否是物理设备。

[http://blogs.msdn.com/virtual_pc_guy/archive/2005/10/27/484479.aspx](http://blogs.msdn.com/virtual_pc_guy/archive/2005/10/27/484479.aspx)

你能告诉我们更多关于你是如何连接到这个服务器的吗*？*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T13:26:39.253

我想看看设备管理器（控制面板|系统|硬件|设备管理器）应该会给你一个好主意。

在一台运行 VMWare ESX 的服务器上，我看到以下虚拟机迹象：

*   系统设备：VMware 服务器内存控制器
*   网络适​​配器：VMware 加速 AMD PCNet 适配器
*   鼠标：VMware 指针设备
*   磁盘驱动器：VMware 虚拟磁盘 SCSI 磁盘设备

检测 VMware 网络适配器的简单测试是：

```
ipconfig /全部 | grep "VMware 加速"

```

（也许还会检测到运行 VMware 工作站的主机）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T13:20:54.087

这取决于几个因素。

1.  您是否使用远程桌面连接到服务器并且可以访问系统文件和文件夹？
2.  您知道服务器运行的是什么类型的虚拟化软件吗？

在不知道这些信息的情况下，这个问题可能很难正确回答。有大量虚拟化软件供应商，每个供应商在虚拟服务器中都有不同的设置。

如果没有更多信息，简短的回答是否定的。对于实际的客户操作系统来说，它看起来和行为就像在裸机上运行的操作系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T13:23:31.757

您可以查找已安装的支持软件，例如 VMware 通常会在客户操作系统上安装[VMware Tools 。](http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=340)

# sql - 我可以向 Oracle 发送“批量”插入吗？

> ID：536712
> 
> 赞同：1
> 
> 时间：2009-02-11T13:18:12.627
> 
> 标签：sql, ruby-on-rails, ruby, oracle

## 设想：

*   我每天将一些数据加载到本地 MySQL 数据库中，大约 200 万行；
*   我必须（*必须*——这是一个审计/监管的事情）移动到一个“正确”管理的服务器，它目前看起来是 Oracle 10g；
*   服务器在不同的国家：一个网络往返电流需要60-70毫秒；
*   输入是一个非规范化形式的 CSV 文件：我在加载之前对数据进行规范化，每行通常会导致最多 4 个表的 3-8 个 INSERT；
*   加载脚本目前在 Ruby 中实现，使用 ActiveRecord 和 fastercsv。我已经尝试了 ar-extensions gem，但它假设 MySQL 样式的多值子句的想法会起作用。它没有。

**编辑**：已经非常有用的答案 - 谢谢！更多关于那个讨厌的输入文件。字段的数量是可变的，并且位置已经改变了几次——我当前的脚本通过分析标题行来确定内容（好吧，fastcsv 和一个狡猾的转换器会这样做）。因此，如果没有多个版本的加载文件，直接上传和后处理 SQL 将无法工作，这太可怕了。它也是一个德语 CSV 文件：分号分隔（没什么大不了的）和用逗号表示的小数点（除非我们加载为 VARCHAR 和之后的文本处理 - 呃，否则更重要的是）。

## 问题：

以大约 7/秒的速度加载 200 万行将需要超过 24 小时！这可能是日常流程的一个缺点，更不用说用户希望能够在数据以 CSV 形式提供后大约 5 小时访问数据！

我研究了每次网络旅行应用多个插入：相当笨拙的`INSERT ALL...`语法会很好，除了目前我使用序列对每一行应用一个唯一的 id。事实证明

```
INSERT ALL
    INTO tablea (id,b,c) VALUES (tablea_seq.nextval,1,2)
    INTO tablea (id,b,c) VALUES (tablea_seq.nextval,3,4)
    INTO tablea (id,b,c) VALUES (tablea_seq.nextval,5,6)
SELECT 1 FROM dual; 
```

（我说这很笨拙吗？）尝试对所有三行使用相同的 id。Oracle 文档似乎证实了这一点。

最新尝试是在一次执行中发送多个 INSERT，例如：

```
 INSERT INTO tablea (id,b,c) VALUES (tablea_seq.nextval,1,2);
    INSERT INTO tablea (id,b,c) VALUES (tablea_seq.nextval,3,4);
    INSERT INTO tablea (id,b,c) VALUES (tablea_seq.nextval,5,6); 
```

我还没有找到说服甲骨文接受这一点的方法。

## 问题

*   我错过了什么明显的东西吗？（如果是这样的话，我会很*高兴*的！）
*   如果我不能发送多个插入，我还能尝试什么？

## 为什么接受那个？

无论出于何种原因，我更喜欢让我的代码尽可能地不受特定于平台的结构的影响：出现这个问题的一个原因是我正在从 MySQL 迁移到 Oracle；由于地理原因，有一天可能会发生另一次搬迁，我无法确定该平台。因此，让我的数据库库能够使用文本 SQL 命令来实现合理的扩展是很有吸引力的，而 PL/SQL 块实现了这一点。现在，如果确实出现了另一个平台，则更改将仅限于更改代码中的适配器：很可能是单行。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-11T13:24:39.603

如何将 csv 文件传送到 oracle db 服务器，使用[SQLLoader](http://www.orafaq.com/wiki/SQL*Loader_FAQ)将 csv 文件加载到临时表中，然后运行存储过程以将其转换并插入到最终表中？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T13:30:46.640

你可以使用：

```
insert into tablea (id,b,c)
 ( select tablea_seq.nextval,1,2 from dual union all
   select tablea_seq.nextval,3,4 from dual union all
   select tablea_seq.nextval,3,4 from dual union all
   select tablea_seq.nextval,3,4 from dual union all
   ...
 ) 
```

当我没记错时，这一直有效到大约 1024 行。

您也可以将其作为 PL/SQL 批处理指令发送：

```
BEGIN
 INSERT INTO tablea (id,b,c) VALUES (tablea_seq.nextval,1,2);
 INSERT INTO tablea (id,b,c) VALUES (tablea_seq.nextval,3,4);
 INSERT INTO tablea (id,b,c) VALUES (tablea_seq.nextval,5,6);
 ...
 COMMIT;
END 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T14:13:17.863

我将使用 SQL*Loader 将原始 CSV 文件加载到数据库中的专用表而不对其进行规范化，然后针对表中的数据运行代码以将其规范化为各种所需的表。这将最大限度地减少往返，并且是 Oracle 社区中非常传统的方法。

SQL*Loader 在初始学习曲线方面可能有点挑战，但如果您遇到困难，您可以很快再次发布。

[http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/part_ldr.htm#i436326](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/part_ldr.htm#i436326)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T16:50:30.827

我有一个快速的建议。我来自 MySQL 世界，但接受过 Oracle 培训，我认为这会奏效。

在 MySQL 中，您可以使用单个 insert 语句插入多条记录。它看起来像这样：

```
INSERT INTO table_name (column_one, column_two, column_three, column_four)
VALUES
    ('a', 'one', 'alpha', 'uno'),        // Row 1
    ('b', 'two', 'beta', 'dos'),         // Row 2
    ('c', 'three', 'gamma', 'tres'),     // etc.
....
    ('z', 'twenty-six', 'omega', 'veintiséis'); 
```

现在显然你一次只能插入一个表，你不想做 200 万条记录，但你可以轻松地一次做 10 或 20 或 100 条记录（如果你被允许那么大的数据包）。您可能必须手动生成它，我不知道您使用的框架（或任何框架）是否支持为您制作这种代码。

在 MySQL 世界中，这极大地加快了插入速度。我假设它会同时进行所有索引更新等，但它也可以防止它不得不在每次插入时重新解析 SQL。

If you combine this with prepared statements (so the SQL is cached and it doesn't have to be parsed out each time) and transactions (to make sure things are always in a sane state when you have to do inserts across multiple tables... I think you will be doing pretty good.

* * *

NunoG is right that you can load the CSVs directly into Oracle. You may be best off reading in the input file, generating a normalized set of CSV files (one for each table), and then loading in each of those one at a time.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T23:24:17.263

Instead of executing the SQL over the network you could write the Inserts to a text file, move it over the network and run it locally there.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T11:16:56.820

SQL*Loader is an Oracle-supplied utility that allows you to load data from a flat file into one or more database tables. This will be 10-100 times faster than inserts using queries.

[http://www.orafaq.com/wiki/SQL*Loader_FAQ](http://www.orafaq.com/wiki/SQL*Loader_FAQ)

如果 SQL*Loader 无法解决问题，请尝试使用小型预处理程序将文件格式化为 SQL*Loader 可读格式。

# database - 如何在整个数据库中搜索字符串？

> ID：536721
> 
> 赞同：1
> 
> 时间：2009-02-11T13:21:09.580
> 
> 标签：database, search, informix

我有一个由大量表组成的 informix 数据库。

我知道某个表中某处有一个字符串“示例”，但不知道它是哪个表或哪个列。（我知道这是一个非常罕见的情况）

由于表较多，无法手动查找。我如何在这个大型数据库中找到这个值？有什么查询可以找到吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:44:18.070

In Informix, determining the columns that contain character data is fiddly, but doable. Fortunately, you're unlikely to be using the esoteric features such as DISTINCT TYPE that would make the search harder. (Alphadogg's suggestion of unload - using dbexport as I note in my comment to his answer - makes sense, especially if the text might appear in a CLOB or TEXT field.) You need to know that types CHAR, NCHAR, VARCHAR, NVARCHAR, and LVARCHAR have type numbers of 0, 13, 15, 16 and 43\. Further, if the column is NOT NULL, 256 is added to the number. Hence, the character data columns in the database are found via this query:

```
SELECT t.owner, t.tabname, c.colname, t.tabid, c.colno
    FROM "informix".systables t, "informix".syscolumns c
    WHERE t.tabid = c.tabid
      AND c.coltype IN (0, 13, 15, 16, 43, 256, 269, 271, 272, 299)
      AND t.tabtype = 'T'  -- exclude views, synonyms, etc.
      AND t.tabid  >= 100  -- exclude the system catalog
    ORDER BY t.owner, t.tabname, c.colno; 
```

This generates the list of places to search. You could get fancy and have the SELECT generate a string suitable for resubmission as a query - that's left as an exercise for the reader.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T15:15:14.983

通常，您有两种方法。

一种方法是将每个表转储到单独的文本文件并 grep 文件。这可以在小型数据库上手动完成，或者在较大数据库的情况下通过脚本完成。查看 UNLOAD 和 dbaccess。BASH 脚本中的示例：（您需要在脚本中静态或通过查询生成表列表。）

```
unload_tables () {

for table in ${TABLE_LIST} do
    dbaccess database_name << EOF
    unload to "${OUT_PATH}/${table}/.out"
    select * from $table;
    EOF
done
} 
```

或者，这有点复杂。`systables`您可以使用and以类似的自动方式为数据库中的每个表和列创建特定的 SELECT（按“示例”过滤每个列）`syscolumns`，然后运行每个 sql。

例如，此查询显示所有表中的所有列：

```
SELECT tabname, colno, colname, coltype, collength
FROM systables a, syscolumns b 
WHERE a.tabid = b.tabid 
```

调整这一点很容易，这样 SELECT 返回一个格式正确的 SQL 字符串，允许您查询数据库以匹配“示例”。抱歉，我没有现成的完整解决方案，但是如果您在 Google 上搜索“informix systables syscolumns”，您会看到很多可以使用这些信息的方式。

# sql - 动态sql语句更新变量

> ID：536728
> 
> 赞同：3
> 
> 时间：2009-02-11T13:23:02.243
> 
> 标签：sql, sql-server, sql-server-2005

我的 sql 语句如下所示

```
DECLARE @OLD_NAV_VALUE AS INT
DECLARE @FINAL AS INT

SELECT @OLD_NAV_VALUE = [col1] from TBL_BA where DATE = @id_Date

SET @FINAL =  @OLD_NAV_VALUE * 50 
```

但是我在这里遇到的问题是 select 语句中以 [col1] 形式给出的列名是一个动态值。所以我在下面尝试这样的事情。

```
DECLARE @OLD_NAV_VALUE AS INT
DECLARE @FINAL AS INT

EXEC('SELECT @OLD_NAV_VALUE = [' + @DYNAMIC_COL_NAME + '] from TBL_BA where DATE = ' + @id_Date)

SET @FINAL =  @OLD_NAV_VALUE * 50 
```

这给出了必须声明 @OLD_NAV_VALUE 的错误。所以我尝试在 EXEC 语句中声明 @OLD_NAV_VALUE 。但是，如果我这样做，我将无法在 EXEC 语句之外使用相同的内容。

请让我知道如何做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T14:10:50.723

您还可以使用带有输出参数的**sp_executesql语句：**

```
declare @field nvarchar(50);
set @field = N'FieldToSelect';

declare @sql nvarchar(3000);
declare @parmDefinition nvarchar(500);

SET @parmDefinition = N'@returnValueOUT nvarchar(50) OUTPUT';

set @sql = N'SELECT @ReturnValueOUT = ' + @Field + ' FROM [TableName] WHERE [SomeCondition]'

declare @returnValue nvarchar(50);
EXECUTE sp_executesql @sql, @parmDefinition, @returnValueOut = @returnValue OUTPUT;

SELECT @returnValue 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T13:42:13.617

首先，我建议您在“Erland 动态 SQL”上进行谷歌搜索，并阅读他关于该主题的白皮书。

如果要求您使用这样的动态列名，您的设计可能不是最好的。

你不能做你想做的事情的原因是 EXEC 中的一切都完全在它自己的范围内。如果您绝对必须这样做，那么您可以使用一个表（普通表或全局临时表）来存储在 EXEC 之外使用的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T13:50:07.183

这对我有用。

我声明了一个临时表并用它来接收来自 select 语句的值。

像下面的东西。

```
declare @i int
declare @v int 
create  table #t (val int)
insert into #t
exec ('declare @i int  set @i = 0 select @i+1') 
select * from #t 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T14:37:59.770

我们用过`sp_executesql`。这是参数化记录计数的另一个示例：

```
DECLARE @sql AS nvarchar(MAX)
SET @sql = N'SELECT @RecordCount = COUNT(*) FROM [{@SchemaName}].[{@TableName}]'
SET @sql = REPLACE(@sql, '{@SchemaName}', @SchemaName)
SET @sql = REPLACE(@sql, '{@TableName}', @TableName)

DECLARE @RecordCount AS int
EXEC sp_executesql 
    @query = @sql, 
    @params = N'@RecordCount INT OUTPUT', 
    @RecordCount = @RecordCount OUTPUT 
```

# asp.net - 如何在我的 Sharepoint WebPart 中使用自定义 CSS？

> ID：536734
> 
> 赞同：13
> 
> 时间：2009-02-11T13:24:29.353
> 
> 标签：asp.net, css, sharepoint

'你好！

我正在为 Sharepoint 开发我的第一个 WebPart，现在我想知道在哪里/如何包含/存储我的 CSS。我应该把我的 .css 文件放在哪里？我应该如何将它们包含在我的 webpart 中？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-07-07T02:48:26.247

这是我的方法

```
protected override void CreateChildControls()
{
    CssRegistration.Register("/_layouts/STYLES/WebPartName/styles.css");
} 
```

这确保了 CSS 只注册和包含一次，并提供了修改 CSS 而无需重新部署整个 dll 的机会。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-11T16:20:47.540

您应该使用可以链接或嵌入的 Web 部件资源。这篇文章很好地解释了如何使用它们：

[管理 Web 部件资源的最佳实践](http://www.synergyonline.com/blog/blog-moss/Lists/Posts/Post.aspx?ID=42)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-18T13:51:42.670

你也可以使用：

```
HtmlLink linkCss = new HtmlLink();

//Defining attributes and values of the link tag
linkCss.Attributes.Add("href", "StyleSheet1.css");
linkCss.Attributes.Add("type", "text/css");
linkCss.Attributes.Add("rel", "Stylesheet");

//Add HtmlLink instance to the header of the current page
Page.Header.Controls.Add(linkCss); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T21:11:07.840

如果您从不打算更改 Web 部件的 CSS，那么将 CSS 嵌入到 Web 部件中就可以了。

我建议您将 css 包含在存储在样式库中的单独文件中，或者更改页面布局或母版页中链接的 css 文件（例如 core.css）。

如果需要，只需为您的 Web 部件定义唯一的类，然后将其呈现方式的定义留给每个网站。这允许 SharePoint 实施的不同区域以不同方式显示相同的 Web 部件。

这意味着您永远不必发布 dll 来更改较小的外观问题。

# cocoa - 减少 Core Animation 内存使用的技巧

> ID：536735
> 
> 赞同：3
> 
> 时间：2009-02-11T13:24:29.790
> 
> 标签：cocoa, memory, core-animation, calayer

所以情况如下：

我有一个屏幕大小的 CALayer，我将内容属性设置为 2 Mb JPEG，大小约为 3500 x 2000 像素，分辨率为 240ppi。

我预计使用 CALayer 会产生轻微的开销，但我的示例应用程序（仅执行上述操作）显示使用了大约 33Mb RSIZE、22Mb RPVT 和 30Mb RSHRD。我注意到当以 64 位运行应用程序时，这些数字比以 32 位进程运行时要好得多。

我正在做我在这个示例来自的实际应用程序中能想到的所有事情，包括将我的 CGImageRefs 重新采样为仅是图层的大小，但这对我来说似乎无关紧要 - 它不应该更简单吗？

有没有人遇到过减少 CALayers 和 CGI​​mageRefs 使用的内存量的好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T18:06:39.423

首先，您将遇到在普通 CALayer 中大小的图像的问题，因为您可能会达到 2048 x 2048 的纹理大小限制（取决于您的显卡）。像这样的应用程序就是 CATiledLayer 的设计目的。Bill Dudney 在他的[博客](http://bill.dudney.net/roller/objc/entry/catiledlayer_example)（大 PDF）上有一些代码示例，以及[他的书随附的代码](http://www.pragprog.com/titles/bdcora/source_code)。

考虑到它将作为未压缩的位图存储在 CGImage 中，如此大的图像会占用如此多的内存对我来说并不奇怪。除了将图像缩放到所需的分辨率并使用 CATiledLayer 平铺之外，我想不到太多。将 CGImageRef 分配给 CAlayer 的内容后，您是否正在释放它？那时你不需要坚持下去。

# flash - 为 Flash Player 10 构建 flex builder

> ID：536736
> 
> 赞同：0
> 
> 时间：2009-02-11T13:24:30.040
> 
> 标签：flash, papervision3d

是否可以在 Flex Builder 最新版本中构建 Flash player 10 的东西，特别是 papervision？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:27:58.720

是的。只需获取[最新版本的 SDK 即可](http://opensource.adobe.com/wiki/display/flexsdk/Download+Flex+3)。

我发现了一些[设置 FP10 预览的说明](http://blog.everythingflex.com/2008/05/20/using-flash-player-10-within-flex-builder/)，应该与完整版非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T14:57:16.027

是的，有可能，只需在编译时添加：

-目标玩家 10

如前所述，您还需要最新的 Flex SDK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T16:00:02.007

也许你搞错了。Papervision3D 不是 Flash Player 10 独有的。您可以使用 Flash Player 9 运行 Papervision3D。因此您不必经历这些麻烦。特别是因为只有少数人安装了 FP 10。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-01T23:24:26.360

Pepervision3D 目前没有利用 FP10 的非仿射变换能力，仍然将四边形切成三角形。这意味着它适用于 FP9 和 FP10。.. PapervisionX 总有一天会出现并对此进行改进

# asp.net-mvc - Html.AntiForgeryToken() 升级到 .NET 3.5 SP1 后导致错误

> ID：536739
> 
> 赞同：5
> 
> 时间：2009-02-11T13:25:04.733
> 
> 标签：asp.net-mvc, .net-3.5, cryptography, viewstate

我刚刚更新到 .NET 3.5 SP1，我曾经工作的 ASP.NET MVC 页面现在已经停止工作。

尝试加载页面时，我得到以下 YSOD

```
[CryptographicException: Padding is invalid and cannot be removed.]
   System.Security.Cryptography.RijndaelManagedTransform.DecryptData(Byte[] inputBuffer, Int32 inputOffset, Int32 inputCount, Byte[]& outputBuffer, Int32 outputOffset, PaddingMode paddingMode, Boolean fLast) +7596702
   System.Security.Cryptography.RijndaelManagedTransform.TransformFinalBlock(Byte[] inputBuffer, Int32 inputOffset, Int32 inputCount) +208
   System.Security.Cryptography.CryptoStream.FlushFinalBlock() +33
   System.Web.Configuration.MachineKeySection.EncryptOrDecryptData(Boolean fEncrypt, Byte[] buf, Byte[] modifier, Int32 start, Int32 length, IVType ivType, Boolean useValidationSymAlgo) +225
   System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) +195

[ViewStateException: Invalid viewstate. 
    Client IP: 127.0.0.1
    Port: 
    User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.9.0.6) Gecko/2009011913 Firefox/3.0.6 (.NET CLR 3.5.30729)
    ViewState: hC6BC8KsuD/yoy2iG74bUZ8TYhGfuDDeIjh9fg/L18yr/E+1Nk/pjS5gyn9O+2jY
    Referer: http://localhost:1092/admin/product
    Path: /admin.aspx/product/edit/4193]

[HttpException (0x80004005): Validation of viewstate MAC failed. If this application is hosted by a Web Farm or cluster, ensure that <machineKey> configuration specifies the same validationKey and validation algorithm. AutoGenerate cannot be used in a cluster.]
   System.Web.UI.ViewStateException.ThrowError(Exception inner, String persistedState, String errorPageMessage, Boolean macValidationError) +106
   System.Web.UI.ViewStateException.ThrowMacValidationError(Exception inner, String persistedState) +14
   System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) +242
   System.Web.UI.ObjectStateFormatter.System.Web.UI.IStateFormatter.Deserialize(String serializedState) +4
   System.Web.Mvc.AntiForgeryTokenSerializer.Deserialize(String serializedToken) +73 
```

如果我删除线

```
<%= Html.AntiForgeryToken() %> 
```

一切都恢复正常了，有什么想法可能导致这种情况吗？如果这是 MVC 或 .NET 问题，我本来希望找到解决方案的运气更好，所以我猜这与我的配置有关。

我尝试重新安装 MVC 框架，看看是否是因为我在 SP1 之前安装，但我仍然遇到同样的问题。Google 和 SO 搜索尚未得出任何确定的结论。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-11T14:07:23.960

呵呵，刚刚解决了。

清除了我的浏览器缓存和 cookie，一切正常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-06-20T17:18:23.673

如果站点已部署并且您正在进行维护，包括 ASP.NET MVC 程序集更新，则不能选择清除浏览器缓存。这是我使用的解决方案：

```
@Html.AntiForgeryTokenReset() @* use this instead*@ 
```

这是扩展方法

```
public static MvcHtmlString AntiForgeryTokenReset(this HtmlHelper htmlHelper)
{
    try
    {
        return htmlHelper.AntiForgeryToken();
    } catch (Exception ex)
    {
        var request = HttpContext.Current.Request;
        request.Cookies.Clear();
        return htmlHelper.AntiForgeryToken();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T15:27:22.333

看起来这个问题现在已经解决了。看看[http://forums.asp.net/p/1388671/2960554.aspx](http://forums.asp.net/p/1388671/2960554.aspx)

# database - 为什么要使用 Oracle 数据库？

> ID：536741
> 
> 赞同：100
> 
> 时间：2009-02-11T13:25:38.680
> 
> 标签：database, oracle, comparison

我很好奇您为什么选择 Oracle 数据库而不是最新版本的技术原因：
1) Microsoft SQL Server
2) MySQL
3) PostgreSQL

哪些特性或功能可以证明额外成本是合理的。我对技术论点感兴趣，而不是宗教战争。一位朋友问我这个问题，我一直使用我列出的 3 个中的一个。我对 Oracle 数据库了解得不够多，无法提供意见。

谢谢。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-01-04T13:55:07.907

似乎没有人谈论开发人员与 Oracle 合作的时间成本。大多数了解任何其他数据库的开发人员都讨厌 Oracle，那些不认为所有数据库代码和/或 ORM 工具都难以使用的开发人员。

如果我创办了一家我认为可以扩展到亚马逊规模的企业，我可能会考虑 NoSQL 解决方案，否则我每次都会选择 PostgreSQL、SQL Server（甚至现在甚至是 Sybase）而不是 Oracle。我说这已经（作为开发人员）与 Oracle 合作了 2 年 - 使用起来很糟糕！

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-02-11T14:03:32.910

只有 Oracle 和 Microsoft 的 SQLServer 是闭源的，当出现问题并且您遇到问题时，只需一个电话即可解决（当然还有现金）。无论如何，MySQL 和 PostGre 有几个企业咨询服务，但最终这些顾问并不真正对产品负责，因为产品属于每个人。这很好，因为如果您擅长 C 和相对低级的编程，您可以进入并修复代码，但如果您没有找到解决方案，则可能会成为一场疯狂的追逐。

现在由于不是每个人都足够熟练，而且那些有钱的企业更喜欢闭源数据库的安全性（在商业意义上），这就是这些解决方案没有停业的原因，除了它们的实现是可靠的事实如果你有钱，那就物有所值。

好的，现在最后最重要的区别是 SQLServer 和 Oracle 之间的区别，那个区别是操作系统，大多数使用 Windows 的人会坚持使用，你猜对了，SQLServer，但如果你在 Unix 上运行，Oracle 是你的闭源解决方案。无论如何，我在 Solaris 上使用 Oracle，但如果我们的目标是 Windows，我可能会使用 SQLServer，因为这两种产品都坚如磐石，但我相信微软有一些特殊的技巧可以在 Windows 上获得最佳性能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T13:33:37.707

仅举几个：

*   Oracle Real Application Cluster - 提供高级集群功能
*   [Oracle Data Guard](http://www.oracle.com/technology/deploy/availability/htdocs/DataGuardOverview.html) - 简而言之，提供物理和逻辑备用特性。
*   Oracle Exadata - 实现数据库感知存储（可以进行谓词过滤、列投影过滤、连接处理、加速表空间创建）。该解决方案附带惠普服务器、24/7 全天候保修和其他好东西。对于具有高度密集数据加载的应用程序（例如，由于独立的表空间创建），这非常好。
*   Oracle 虚拟化

当然还有品牌的魔力；）

当谈到选择 RDBMS 时？通常选择很明显——甲骨文或世界其他地方。之后，您可以通过以下方式缩小选择范围：

*   平台（是否仅限 Windows）
*   重量（sqlite，MySQL，PostgreSQL，...）
*   预算（初始许可成本、维护 + 支持成本）
*   进化观点，例如：
    *   甲骨文快递 -> 甲骨文
    *   SQL Server Express -> MSSQL
*   商业观点——“安全、知名的产品”或开源产品（记住第一句话的引文）。其他帖子倾向于更深入地研究这方面。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T13:40:30.670

真正的问题是，将使用哪种应用程序来使用 RDMS。您的 wordpress 博客或 twitter 克隆当然不需要 oracle。但是如果你想做一些重要的商业智能，那么甲骨文可能有一些特性可以帮助你比其他人更有效地做到这一点。

Ms sql server 也非常好，它有很多功能。如果您对 linux 感兴趣，并且需要具有 ms sql 提供的功能的数据库，那么 oracle 将是一个不错的选择。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-01-06T00:23:21.113

我认为这是因为**Oracle**是第一个支持“**分片**”的 RDMS

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T14:02:00.667

你知道，SQL Server 和 Oracle 的成本相差不大。

事实上，对于小型系统，Oracle 与您最喜欢的免费数据库的成本在零（Oracle 快捷版）和不太大（标准版 1 的永久处理器成本 5,800 美元）之间。

这是 11g 中各个版本的功能的链接：[http](http://www.oracle.com/database/product_editions.html) ://www.oracle.com/database/product_editions.html 。

[在http://store.oracle.com](http://store.oracle.com)上提供所有地区的标价——当然，大公司通常不支付零售费用；）

# winforms - WinForms 树视图

> ID：536743
> 
> 赞同：3
> 
> 时间：2009-02-11T13:25:48.583
> 
> 标签：winforms, treeview, drag-and-drop

我正在寻找具有以下要求的 WinForms 树视图控件：

*   为它编写代码应该不难（大多数树/列表组合都太复杂了）
*   应该具有某种简单的拖放功能（包括 vista-explorer 样式的拖放标记）
*   应该是免费的或至少是负担得起的
*   应该提供一些文本/颜色/样式/等的自由。树节点的（经典的“蓝色数字风格的粗体外观）

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T13:51:16.277

我会推荐[http://www.lidorsystems.com/](http://www.lidorsystems.com/)！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T11:02:04.203

另一个有趣的选择是[TreeViewAdv](http://www.codeproject.com/KB/tree/treeviewadv.aspx)，正如另一个线程中所建议的那样。

[C# 替换标准 Treeview？](https://stackoverflow.com/questions/581985/c-replacement-for-standard-treeview)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T13:50:03.613

我认为标准 WinForms 的树形视图控件将完成您列表中的所有操作。我不知道第二项是指什么，因为我没有使用过 Vista。它被声明为`System.Windows.Forms.TreeView`并且在 VS200* 的表单设计器中可用。我想不出任何更简单的方法来做树视图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T22:53:41.717

我是[Divements](http://www.divelements.com/net/controls/sandgrid/)的 SandGrid 的忠实粉丝。我将它用于我所有的 ListViews 和 TreeViews。它甚至同时支持两者（带有列的 TreeView）。我发现它易于使用且速度非常快。

# design-patterns - 使用 Front Controller 模式的优缺点是什么？

> ID：536744
> 
> 赞同：10
> 
> 时间：2009-02-11T13:26:18.553
> 
> 标签：design-patterns, front-controller

我目前为我的所有网站设计每个页面都有一个文件，然后包含常见的元素，如页眉、页脚等。但是，我注意到许多框架和 CMS 都使用前端控制器模式。

使用前置控制器有哪些优点和缺点？该模式是否只是在框架和 CMS 中使用，因为不知道最终系统中将存在哪些页面？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T13:51:25.887

Srikanth 有一个很好的答案。不过，我想详细说明替代方案。假设您有这个简单的 URL 层次结构：

```
/画廊
/博客
/管理员/登录
/管理员/新帖子

```

如果这是使用页面控制器（例如 PHP）实现的，则两者`gallery.php`都`blog.php`需要`common.php`在开头（或附近）包含一些。但是，两者都`login.php`可能`newpost.php`包括`admin-common.php`，它本身会引入 'common.php' 并执行 '/admin/' 特定设置，例如验证用户是否经过身份验证。

一般来说，如果你有一个 URL 层次结构，它最终看起来很像对象继承树。除了不使用语言级继承之外，您还继承了所`foo-common.php`包含的任何内容的环境。

我无法想象前端控制器如何提高可测试性，最终，无论实现如何，都需要来自自动 HTTP 用户代理的完全相同的测试。

页面控制器的一个主要缺点是它确实使您的 Web 应用程序依赖于其托管环境。它还迫使您的开发人员“看到”与最终用户相同的结构，但我认为这是一件好事，考虑到我看到的具有绝对恶劣 URL 的网站的数量。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-12-06T18:29:53.210

这就是我永远不会使用前端控制器的原因。

*   我们有一个非常好的前端控制器，它被称为网络浏览器。
*   每个 http 请求都是唯一且独立的，应该这样对待。
*   无法使用前端控制器扩展应用程序。
*   如果您将 Web 应用程序分解为松散耦合的小模块，则更容易测试单元/模块（例如，您没有测试架构和控制器）。
*   如果您唯一地处理单个请求，性能会更好。

前控制器模式根本不适合恕我直言。构建应用程序的方式与 UNIX 大致相同，将一个较大的问题分解为执行一项任务的小单元，并且非常好地完成该任务。大多数框架都在推动开发人员使用前端控制器，他们完全错了。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-11T13:37:35.983

改写[关于 Front Controller 的 Wikipedia 文章](http://en.wikipedia.org/wiki/Front_controller)：

一句话—​​—**你用它来避免重复**。

稍微详细一点：

前端控制器“为处理请求提供了一个集中的入口点”。假设您的网络应用程序的前端控制器是`index.php`.

这个脚本 index.php 将处理整个应用程序或周围框架共有的所有任务，如**会话处理、缓存、输入过滤**。根据给定的输入，它将实例化更多对象并调用方法来处理特定任务。

前端控制器的替代方案是单独的脚本，例如 login.php 和 order.php，它们每个都包含所有任务共有的代码或对象。这将需要在每个脚本中重复包含代码，但也可能为脚本的特定需求留出更多空间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T13:36:26.530

使用前端控制器的一个优点是它的可测试性。如果您使用 TDD，那么测试控制器比请求许多不同的网站要容易得多。

稍后添加： Tom：我的意思是它更可测试的原因是因为您通常将 webhandler 实现为类而不是服务器页面。然后你可以直接在课堂上做很多测试。

# ruby-on-rails - ruby on rails：将子记录添加到现有父级而不访问父级

> ID：536750
> 
> 赞同：1
> 
> 时间：2009-02-11T13:26:53.403
> 
> 标签：ruby-on-rails

您将如何处理允许用户将子对象添加到父对象而不要求他们导航到父对象？

例如，无需导航到期刊并先发行就可以添加期刊文章？父母也可能还不存在。

我不想让用户的数据输入变得繁琐，所以让他们找到期刊或创建它，然后找到或创建一个问题似乎有点多。我宁愿只有一个带有期刊和问题字段的表单。如果不是因为用户对文章而不是期刊或问题感兴趣，那么逻辑会很简单。

您是否只需为孩子修改一个 create 以便它找到或创建父母？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T16:00:09.463

我假设您有一个包含许多文章的期刊模型和一个属于期刊的文章模型。首先，您应该创建通过期刊而不是期刊的文章控制器的路由：

```
ActionController::Routing::Routes.draw do |map|
  map.resources :journals, :has_many => :articles
  map.resources :articles
end 
```

现在您可以使用 URL`/articles/new`或`/journals/1/articles/new`. 然后在您的文章控制器的新操作中，您执行以下操作：

```
@article = Article.new(:journal_id => params[:journal_id]) 
```

它将文章的设置`journal_id`为传入的任何参数。如果不传递任何参数，则 journal_id 将为 nil。

在 ERB 模板中，您只需执行以下操作即可创建下拉列表：

```
<%= f.collection_select :journal_id, Journal.all(:order => "name"), :id, :name, :include_blank => true %> 
```

然后用户可以选择一个期刊，但如果一个被传入，它将被预选为正确的值。

# arrays - 在 Erlang 中使用二维（多）维数组

> ID：536753
> 
> 赞同：7
> 
> 时间：2009-02-11T13:27:36.770
> 
> 标签：arrays, erlang

这些天我正在用 Erlang 解决[Project Euler](https://projecteuler.net)问题。

由于我从一开始就是一名 C++ 程序员，所以有时我真的很想使用二维数组进行编码。

我的想法之一是使用这样的元组和列表：

```
List=[{X,0}||X<-lists:seq(1,3)]
{1,0}
{2,0}
{3,0} 
```

有没有在 Erlang 中实现多维数组的好方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T14:41:48.417

请参阅[数组模块](http://www.erlang.org/doc/man/array.html)，但对于多维访问，您必须编写自己的包装器。如果您的任何维度都很短并且访问权限主要是读取，您可以使用元组并使用`erlang:element`and `erlang:setelement`。无论如何，建议使用自己的包装器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T19:03:05.433

尝试使用 {X, Y, Z} 作为键的数组（实际上是 dict）。它看起来像 3d 数组；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-01T21:22:23.653

我为二维数组的数组模块写了一个小包装器

```
-module(array_2d).
-export([new/2, get/3, set/4]).

new(Rows, Cols)->
    A = array:new(Rows),
    array:map(fun(_X, _T) -> array:new(Cols) end, A).

get(RowI, ColI, A) ->
    Row = array:get(RowI, A),
    array:get(ColI, Row).

set(RowI, ColI, Ele, A) ->
    Row = array:get(RowI, A),
    Row2 = array:set(ColI, Ele, Row),
    array:set(RowI, Row2, A). 
```

# ruby - 在 Ruby 中阻止评论

> ID：536760
> 
> 赞同：98
> 
> 时间：2009-02-11T13:28:42.790
> 
> 标签：ruby, comments, keyboard-shortcuts, text-editor, block-comments

Ruby 有块注释吗？

如果没有，是否有一种有效的方法可以`#`在 TextMate 中突出显示的代码块前面插入？

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2009-02-11T13:31:42.767

你可以做

```
=begin
  [Multi line comment]
=end 
```

`=begin`并且`=end`必须在行首（根本不缩进）。

[来源](http://www.ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/syntax.html#embed_doc)

此外，在 TextMate 中，您可以按`Command`+`/`在突出显示的代码块上切换常规注释。

[来源](http://v1.garrettdimon.com/archives/trick-your-textmate-the-series)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-11T13:32:15.853

Ruby 有文档注释——它们看起来像这样：

```
=begin
...
=end 
```

不完美，但他们在紧要关头完成了工作。

[编辑] 重要的是要注意，`=begin`并且`=end`必须在各自行的开头。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T02:00:13.880

在 TextMate 中，您可以垂直拖动 alt 来选择一列文本。这将在您选择的所有行中复制插入点，因此您可以`#`一次插入或删除多个 s。

更新：同样在 TextMate 中，假设您选择了正确的语言，Cmd + / 将切换评论选择中的每一行，而不考虑语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-15T07:57:41.673

在 TextMate 2 中，您可以 ⌘/ 注释掉当前行或选定的行。

# .net - 有了这项技术，是否可以在 Flash 中编译和运行 silverlight IL？

> ID：536771
> 
> 赞同：3
> 
> 时间：2009-02-11T13:32:43.733
> 
> 标签：.net, c++, flash, silverlight, mono

我真的不明白[这篇文章](http://developers.slashdot.org/article.pl?sid=08/11/19/2321230&from=rss)。但听起来你可以为 Flash 编译 C/C++。如果可能的话，在 Flash 中编译和运行 Mono 有多难？

听起来很愚蠢，我知道……也许我的年龄快要疯了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T08:16:47.537

我敢肯定，一个非常优秀且敬业的黑客，能够同时更改单声道运行时和 Flash 播放器，可以在几个月的工作中获得一个类似 hello-world 的微不足道的程序。也就是说，实现所有功能要么极其复杂，要么极其缓慢，因此，从实际角度来看，使用这种方法是行不通的。

如果您想在浏览器中运行基于 CLR 的托管代码，请在[此处](http://tirania.org/blog/archive/2009/Feb-11.html)查看 Moonlight 2.0 进度：它现在可以运行，速度很快，并且可以轻松移植以在各种设备上运行（还有例如，单声道端口到 Android）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T13:47:21.340

第一次可能是可能的，但只需*编译*. 让我看看有没有你想去的地方。

Mono 可以运行即时代码，但即使现在有一个[C# Shell](http://www.mono-project.com/CsharpRepl) ，它首先会编译为 IL（也可能是 JIT），然后再执行。使用该技术将有可能使 Flash 生成 .NET 程序集，但不能运行它们！

为了在 Flash 中运行 .NET 程序集，我们需要一个 .NET IL 到 AS3 字节码转换器。可能你在想这个，对吧？但这根本不是疯狂，而是*兼容性*！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T14:01:42.383

没有理由你不能在炼金术中编写 CLR，但炼金术不会将 C 编译为本机代码（它被编译为字节码），因此它的性能和安全性都会受到与普通动作脚本相同的限制。因此，您可能需要重写很多单声道。

简而言之：这是可能的，但你不会赢得任何表演奖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T16:56:14.133

Alchemy 使用 LLVM 将编译后的 C/C++ 代码转换为 ActionScript。LLVM ( [http://www.llvm.org/](http://www.llvm.org/) ) 是一个编译器基础结构（从该页面的标题中摘录！），支持将 C/C++ 编译为低级指令集。你可以在它之上构建一个虚拟机，分析关于编译代码的事情（比如数据流或代码覆盖率等等），并且通常做各种很酷的事情。

我不认为你可以用它来把 IL 翻译成 flash。

# c# - C#表单应用系统账号

> ID：536775
> 
> 赞同：0
> 
> 时间：2009-02-11T13:33:44.977
> 
> 标签：c#, winforms, system, account

是否可以在系统帐户下运行 Windows 窗体应用程序或控制台应用程序？像 asp.net 应用程序可以通过更改机器配置文件在系统帐户下运行：

```
<processModel  userName="machine" password="AutoGenerate" /> 
```

这是为了给程序更多的特权...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:50:09.680

听起来你是在攻击症状而不是问题。您的程序究竟需要做什么需要额外的权限？也许有一种不同的方式来完成这项任务，而无需任何提升。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T13:43:18.870

是的。您可以在系统帐户下运行任何应用程序。一种技术是将其作为计划任务启动，或者使用“at”命令行实用程序启动。

然而不幸的是，从 Windows Vista 开始，以这种方式运行的应用程序无法与用户交互，因为它们在不同的会话中运行。

这意味着以这种方式运行 WinForms（或任何类型的 GUI）应用程序是毫无意义的。同样对于控制台应用程序，如果您想查看输出。

如果它是一次性的，你可能可以忍受它。否则，您应该考虑创建一个 Windows 服务，该服务可以配置为在任何用户帐户（包括 SYSTEM）下运行。如果您想与它交互，您需要实现一个单独的应用程序，通过（例如）.NET 远程处理与它对话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T13:46:55.897

这取决于你的目标是什么。如果您希望它在系统帐户下运行并让用户与之交互，则不能这样做。如果您绝对需要这样做，最好的办法是创建一个服务来处理需要额外权限并作为系统运行的操作，并从作为用户运行的 GUI 连接到该服务。但是，如果您走这条路，请意识到您在标准用户可以做的事情和系统可以做的事情之间的安全边界上创建了一个漏洞，因此请确保您保护 GUI 和服务之间的连接并限制只为您绝对需要它做的事情提供服务。

正如 lassevk 提到的，如果您只需要执行一次或偶尔执行此操作，您可以使用 runas 在另一个安全上下文中运行，但仍然具有交互式 GUI/控制台。

另一方面，如果您只是希望它在某个时间无人看管地运行，您应该能够像 Martin 建议的那样使用任务调度程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T13:37:13.473

您不能通过从 Windows 中的计划任务启动它来做到这一点吗？

# ruby-on-rails - 用于 Rails 应用程序的 Git 或 SVN？

> ID：536779
> 
> 赞同：5
> 
> 时间：2009-02-11T13:34:37.800
> 
> 标签：ruby-on-rails, svn, git, version-control

我应该为 Rails 应用程序使用哪个版本控制系统：Git 还是 SVN？

以下是一些需要考虑的因素：

*   我是唯一的开发者
*   我熟悉SVN
*   我只用了一个星期的Git，它看起来和SVN真的很相似。
*   我想将我的存储库放在一个远程位置并通过 SSH 或其他协议（我已经使用 SVN）连接到它。

* * *

编辑：感谢到目前为止的回复。似乎 Git 更受青睐。它有任何 SSH 功能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-11T13:39:50.580

我会说去Git。主要是因为我有偏见，但也因为你不需要使用 Git 设置任何类型的服务器，你就`git init`可以了。[Git 通常更好](http://whygitisbetterthanx.com/#svn)，它比 SVN 提供更多的灵活性和功能。

编辑：这有点欺骗[为什么 Git 比 Subversion 更好](https://stackoverflow.com/questions/871/why-is-git-better-than-subversion)，或者至少是相关的。

Edit2：Git 有 3 种主要的通信方法，Git 协议、SSH 和 HTTP。Github 使用 SSH 进行“推送访问”，例如 git@github.com/user/repo.git。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T13:40:10.173

作为已经熟悉 SVN 的单一开发人员 - 如果您想尽可能提高工作效率，请使用 SVN。

另一方面，如果您真的想学习 GIT 并且可以花更多时间学习它，请使用 GIT。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T15:57:00.500

使用 Git，如果没有其他原因，您几乎可以像 SVN 一样使用它（包括通过 SSH 远程管理多个分支），而且它更快、更可靠。本地签入和分支、分布式版本控制、修订历史管理等只是附带的好处。

根据我的经验，选择 SVN 而不是 Git 的唯一原因是：遗留 SVN 存储库，或者需要在客户端上使用 Windows。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-15T06:50:46.440

我会在评论中回复，但我还不能。

对于那些不知道的人，Git 与 Windows 一起工作。如果你不喜欢 msys 的版本，[TortoiseGit](http://code.google.com/p/tortoisegit/)已经可以使用了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T13:40:38.033

因为你是一个人并且想把它放在一个远程位置：SVN，但你也应该学习/使用 Git。您也可以将两者结合起来，在本地使用 Git，在远程使用 SVN。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T15:45:31.917

使用某种版本控制可能是个好主意。对您的代码进行远程备份也可能是一个好主意。

Git 和 svn 都是很好的版本控制解决方案，并且在 Ruby/Rails 社区中都很流行。

如果您在分布式开发组中，我建议 git 可能更合适，因为它的特定设计目标之一就是针对这种情况。

如果你在 Windows 上，我会暗示 TortoiseSVN 提供的体验可能不如 msysGit 那样具有挑战性。

大多数情况下，尽管他们似乎都在做类似的工作并且做得很好。

如果您在构建项目时特别想学习新的源代码控制系统，请选择 git。或者，如果您打算花很多时间在例如位于 Github 的 edge Rails 上，那么不妨再次选择 git。

否则我会说你应该坚持使用svn。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-11T17:44:15.657

如果你有一天学习 Git，那就学习 Git。它具有 svn 的所有功能，加上便宜的分支/合并、本地提交和分布式开发选项。

使用远程存储库很容易。如果您只是在寻找某种公共托管，那么您可能想看看[Github](http://www.github.com/)，它具有免费的公共托管、良好的 Ruby 集成和许多漂亮的图表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T16:02:21.813

我会说没有特别的区别。

这两个系统都只是工具，它们都将为您提供您正在寻找的功能。如果没有其他参数需要考虑，我会说使用 SVN，因为您已经知道它并且您不需要时间来学习它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-13T20:41:57.910

我要添加一个后续问题：您是在单独做这个吗？Git 的 GUI 工具支持通常落后于 Subversion，所以如果这是或可能成为考虑因素，那么我会选择 Subversion。

例如，如果您的设计师使用 Adob​​e CS4，他们可以使用其内置的 Subversion 支持（您不必教他们 Git）。因此，将团队当前和未来的组成作为决策的一个因素。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-15T06:31:24.490

我曾经喜欢 git，但最近改用了 mercurial。它具有与 git 完全相同的语法，但是是用 python 编写的，并且有很多开箱即用的漂亮的花里胡哨，就像一个用于视觉跟踪提交的 Web 服务器。

我知道这可以使用 gitweb 为 git 设置，但它需要一些工作。

# html - 混合 HTML 表单和表格

> ID：536787
> 
> 赞同：2
> 
> 时间：2009-02-11T13:36:53.923
> 
> 标签：html, user-interface

对于一个标准的“添加项目”表单页面，最好有两个提交按钮：一个“确定”按钮和一个“取消”按钮，前者将表单发布到一个 URL，而后者获取其他 URL。

这显然意味着需要两个单独的 FORM，如果与表格一起布置，标记将如下所示：

```
<form action="add.html" method="post">
 <table>
  <tr>
   <td>Enter data:</td><td><input type="text" name="data"/></td>
  </tr>
 </table>
 <input type="submit" value="OK"/>
</form>
<form action="index.html" method="get">
 <input type="submit" value="Cancel"/>
</form> 
```

但是，这将导致两个按钮被放置在彼此下方。最好将它们并排放置。以下作品：

```
<form action="add.html" method="post">
 <table>
  <tr>
   <td>Enter data:</td><td><input type="text" name="data"/></td>
  </tr>
  <tr>
   <td><input type="submit" value="OK"/></td>
</form>
<form action="index.html" method="get">
   <td><input type="submit" value="Cancel"/></td>
  </tr>
 </table>
</form> 
```

但是虽然我在商业网站上看到过它，但我猜它不是完全合法的 HTML。

因此：

1）既然第二种方法有效，有什么不使用它的充分理由吗？

2）有没有更好的解决方案？

编辑：这是一个愚蠢的问题。第二种方法是不必要的。解决方案：在第一个方法中添加一个 CSS 规则：

```
form
{
  display: inline;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T13:56:18.793

你打破了我的想法。

您在这里遇到的问题有很多不同的问题，但我首先要指出，取消/重置通常[不](http://discuss.fogcreek.com/joelonsoftware/default.asp?cmd=show&ixPost=416)[被认为是](http://www.useit.com/alertbox/20000416.html)好事。

我会指出您可以在第一个示例中使用 CSS 来并排设置按钮的样式，然后*指出*一个简单的 type="button" 可以附加任意脚本来执行您的操作取消导航，并遵循*一个*简单的锚标记将更加直接的事实。

我不会提到这张桌子，因为那只会引起一些麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T14:05:42.123

不要使用第二种形式。将两个按钮包装成相同的形式，并使用取消按钮执行以下操作：

```
<input type="button" text="Cancel"
       onclick="document.location.href='index.html';return false;" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T13:59:42.513

1）当您使用“合法的 HTML”创建页面时，您可以期望在今天的浏览器中有效的内容将在明天的浏览器中有效，或者在您可能没有签入站点的其他用户代理中有效。但在示例中您已经给出了，不同浏览器在如何“修复”HTML 以进行显示方面达成一致的程度要不确定得多。它为使用“有效 HTML”时页面的显示方式增加了一定程度的可预测性。另外，谁知道屏幕阅读器之类的用户代理会如何描述相关代码。

2) 使用常规锚标签是一种选择吗？

```
<td><input type="submit" value="OK"/></td>
<td> or <a href="index.html">Cancel</a></td> 
```

或者您可以使用 CSS 将第二个表单及其提交按钮向上移动到第一个表单中，但具体细节可能会很棘手。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-28T13:23:33.293

在表格中添加一行

```
<tr>
<td><input type="button" value="Cancel" onClick="window.location='./index.html'"/></td>
<td><input type="submit" value="OK" name="submit"/></td>
<tr> 
```

# reporting-services - SSRS 报告电子邮件传递订阅失败

> ID：536796
> 
> 赞同：0
> 
> 时间：2009-02-11T13:38:38.303
> 
> 标签：reporting-services, report, subscription

我有一份报告，当我尝试创建订阅以将电子邮件发送到我的地址时，我收到了一条状态消息

> 发送邮件失败：报告处理过程中发生错误。

此消息的可能原因是什么。该报告工作正常，是因为它由于某种原因而失败，错误消息是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T13:48:20.590

可能您的报告中有发送邮件时无法填写的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T14:05:39.097

您确定电子邮件首选项设置正确吗？您的 SMTP 服务器是否允许从 SSRS 机器进行中继？您可以从 SSRS 机器发送任何其他电子邮件吗？

# memory - Windows Mobile 内存损坏

> ID：536797
> 
> 赞同：2
> 
> 时间：2009-02-11T13:38:43.750
> 
> 标签：memory, windows-mobile, corruption

WM 操作系统是否相互保护进程内存？一个写得不好的应用程序是否会因为错误地写入第一个内存而导致其他应用程序崩溃？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T14:54:32.287

Windows Mobile，至少在当前的所有版本中，都是基于 Windows CE 5.0 构建的，因此使用[CE 5.0 的内存模型](http://msdn.microsoft.com/en-us/library/ms836325.aspx)（与 CE 3.0 中的内存模型相同）。操作系统实际上并没有在保护进程内存方面做很多事情，但它通常足以*防止*进程相互干扰。不过，这并不难。

CE 进程在其中有 32 个“插槽”中运行。当前运行的进程被交换到插槽 0，并且它的地址重新设置为零（因此运行进程中的所有内存实际上都有 2 个地址，插槽 0 地址和它是非零插槽地址）。这些地址是受保护的（尽管有一个[简单的 API 调用](http://msdn.microsoft.com/en-us/library/aa908794.aspx)来跨越边界）。这意味着指针损坏等不会踩到其他应用程序，但如果你*愿意*，你仍然可以。

CE也有共享内存的概念。所有进程都可以访问该区域，并且 100% 不受保护。如果您的应用程序正在使用共享内存（并且内存管理器可以在没有您特别询问的情况下为您提供共享地址，具体取决于您的分配及其大小）。如果您有共享内存，那么是的，任何进程都可以访问该数据，包括破坏它，并且您在任何一个进程中都不会收到错误或警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T13:43:26.157

> WM 操作系统是否相互保护进程内存？

是的。

> 一个写得不好的应用程序是否会因为错误地写入第一个内存而导致其他应用程序崩溃？

否（但它可能会做其他事情，例如用完所有“磁盘”空间）。

即使您是设备驱动程序，要获得写入由不同进程拥有的内存的权限，您也必须显式调用一个 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T14:20:10.827

虽然 ChrisW 的回答在技术上是正确的，但我对 Windows 移动的体验是，从应用程序崩溃整个设备比在桌面上崩溃要容易得多。我可以猜到出现这种情况的几个原因；

*   操作系统通常比 Windows 桌面更多地进行 OEM，即制造商特定的低级代码的数量可能非常高，这导致制造商特定的错误可能导致严重的崩溃。在许多设备上，每个月左右都会看到一个新的固件版本，这些版本是对此类错误的修复。

*   资源更稀缺，耗尽所有可用资源的应用程序很容易导致崩溃。

*   保护机制和架构差异很大。我目前使用的设备是基于 SH4 的，而你主要看到的是 ARM、X86 和奇怪的 MIP CPU。

# c# - ReSharper - 空分配问题

> ID：536798
> 
> 赞同：2
> 
> 时间：2009-02-11T13:38:51.970
> 
> 标签：c#, resharper

JetBrains ReSharper 问题

我们有以下 C# 代码，其中我们从图像资源文件填充图像列表。ReSharper 指示“可能为具有“NotNull”属性的实体分配“空”。

该问题向我们表明，我们只需要检查以确保我们的 ResMan_Graphics 不为空，但是当我们对空进行检查时......问题仍然存在。

这是生成 ReSharper 问题的代码；

```
ResourceManager ResMan_Graphics = new ResourceManager("_Graphics", Assembly.ReflectionOnlyLoad("lib"));
ImageList Icons = new ImageList();

Icons.Images.Add((Image)ResMan_Graphics.GetObject("ICON_Main")); 
```

以前有没有人遇到过这个 ReSharper 评论，您对我们如何在不产生这个问题的情况下从资源中填充 imageList 有什么建议吗？

注意：如果我们将 imageList 组件放置到表单上，然后从代码中的资源填充 imageList，ReSharper 不会生成注释。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-11T13:49:04.317

这是因为`GetObject`可能返回 null。你想这样做：

```
Image image = (Image)ResMan_Graphics.GetObject("ICON_Main");
if (image != null)
    Icons.Images.Add(image); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T13:49:50.663

ReSharper 应该能够确定 ResMan_Graphics 不为空 - 您刚刚调用了构造函数。但是，GetObject 可能会返回 null - 我希望这就是它所抱怨的。

是不是最后一行出错了？听起来你可以这样做：

```
Image image = (Image) ResMan_Graphics.GetObject("ICON_Main");
if (image == null)
{
    // Throw some nasty exception
}
Icons.Images.Add(image); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-11T13:46:00.970

所以你已经尝试过：

```
if( ResMan_Graphics != null ) {
  Icons.Images.Add((Image)ResMan_Graphics.GetObject("ICON_Main"));
} 
```

# .net - 服务器移动，WebServices

> ID：536799
> 
> 赞同：0
> 
> 时间：2009-02-11T13:38:59.257
> 
> 标签：.net, web-services, web-applications

我处于必须将 Web 应用程序/Web 服务从一台服务器移动到另一台服务器的情况。应用程序/服务已发布，大多数服务器名称可以在 web.config 中修改。但是我想知道指向前一个服务器的 Web 服务会发生什么？我是否必须打开项目并在新服务器上重新添加新服务？这清楚吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T13:46:00.800

奥利弗 - 被问到我认为没有足够的信息，因为答案似乎很清楚：如果在目标服务器上找不到服务，那么你会得到一个异常。如果您已配置应用程序以便从 Web.Config 中提取服务地址，则不必“重新添加新服务...”。您只需要确保 Web.config 中的地址更改传播到您的应用程序中的 Web 服务调用。我错过了什么吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T13:47:09.610

你的意思是网络参考？不可以，您可以在 Web 参考的属性中更改 Web 参考 URL 字段中的地址。实际上，这仅在更新 Web 参考以构建代理时才需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T13:52:57.710

您应该将 Web 服务 URL 配置为参数表或 web.config 文件。

然后在您的应用程序中从 web.config 或参数表中获取 URL，并将其设置为您的 Web 服务代理的 Url 参数。

像这样 ：

```
MyWebService myWebService = new MyWebService();
myWebService.Url = "http://127.0.0.1/MywebService/Service1.asmx"; 
```

当您想将应用程序部署到另一台服务器时，只需更改 URL 参数即可。

# cocoa - 在 Cocoa 中实现“scrubby sliders”？

> ID：536807
> 
> 赞同：1
> 
> 时间：2009-02-11T13:40:24.510
> 
> 标签：cocoa, user-interface

我将如何实现一些类似于“scrubby sliders”的东西，比如在 Photoshop 和很多其他图像处理应用程序中？

它们有点难以描述......基本上你有一个常规的数字输入框，但你可以单击并按住鼠标按钮，它的功能就像一个滑块（直到你释放）。如果单击该框，则可以像往常一样选择文本、编辑/粘贴/等。

[Photoshop 文档](http://livedocs.adobe.com/en_US/Photoshop/10.0/help.html?content=WSB2D515AF-367C-4aec-9B3D-36D2044E360F.html)对其进行了描述，我整理了[一个快速示例视频](http://data.dbrweb.co.uk/tmp/scrubbysliders.mov)（[Shake](http://www.apple.com/shake/)中的滑块示例）

另一个类似的实现是 Final Cut Pro 中的缓动轮，它的功能类似，但下方没有数字读数。

我似乎找不到任何关于实现这些的提及，尽管可能有替代名称。它适用于 OS X 10.5 Cocoa 应用程序。

它适用于颜色分级应用程序，用户可能需要在同一控件上进行微小调整（例如 0.001）到巨大调整（例如，-100 +100）。常规滑块在该值范围内不够准确。

将值复制并粘贴到框中将是擦洗值的次要问题，并且 Photoshop/Shake 设置非常好。控件的不明显性也是一个低问题，因为它不是“常规桌面应用程序”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T13:53:47.613

这些我都遇到过。它们很糟糕，因为它们阻止用户拖动以选择数字的文本。

一个更好的想法是在字段下方放置一个微型滑块，当用户按住其上的鼠标按钮时，它会展开为全尺寸滑块，并在用户释放鼠标按钮时折叠回其微型尺寸。这样，选择行为仍然可用，但您还提供了滑块 - 并且以更明显的方式。

Cocoa 中没有任何一个内置类。你必须实现你自己的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T13:56:16.030

我怀疑这是否存在于 Cocoa 框架中。据我记得[Apple Human Interface Guidelines](http://developer.apple.com/documentation/userexperience/Conceptual/AppleHIGuidelines/index.html)中没有提到它。

您可以通过使用自定义视图和跟踪鼠标事件 ( `-mouseDown:`, `mouseUp:`, `-mouseDragged:`) 自行开发。

# java - 怀疑异常处理并最终在java中阻塞

> ID：536811
> 
> 赞同：2
> 
> 时间：2009-02-11T13:41:34.023
> 
> 标签：java, exception-handling

你能说出如何做的想法吗？

代码 ：

```
public void main(String[] args) {
    try {
        //Some Exception throws here
    }
    catch(SomeException se) {
        se.printStackTrace();
    } 
    finally {
        try {
            //SomeException1 throws here
        }
        catch(SomeException1 se1) {
            se.printStackTrace();
            //Control is getting stop in this block itself but i wanna print the below statement
        }

        // I need to print this statement whatever exception occurs
        System.out.println("End Program"); 
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T13:50:57.277

只需添加另一个 finally 块

```
public void main(String[] args) {
  try {

    //Some Exception throws here

  }
  catch(SomeException se) {
    se.printStackTrace();
  }
  finally {
    try {

      //SomeException1 throws here

    }
    catch(SomeException1 se1) {
      se.printStackTrace();
    }
    finally {
      System.out.println("End Program"); ----> I need to print this statement whatever exception occurs
    }
  }
} 
```

或者，如果您知道只有您处理的异常，您可以完全删除 finally 块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T13:50:55.467

看起来它应该工作。

几个想法：

*   您可以将 System.out.println(...) 放在另一个 finally 块中。

*   程序应该在那个 catch 块中*停止的唯一方法是调用 System.exit()。*如果您调用 exit，就是这样……不再运行代码。

*   堆栈跟踪被写入标准错误，但您想要的行被写入标准输出。您是否将它们重定向到不同的地方，也许？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T13:52:22.233

添加另一个 finally 块应该可以工作：

```
try {
    //Some Exception throws here
} catch(SomeException se) {
    se.printStackTrace();
} finally {
    try {
        //SomeException1 throws here
    } catch(SomeException1 se1) {
        se.printStackTrace();
    } finally {
       System.out.println("End Program"); 
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T13:45:09.863

在主要结束之前在嵌套尝试块中的第一个尝试块之外打印怎么样？

```
 public void main(String[] args) {
    try {
      //Some Exception throws here
    } catch(SomeException se) {
      se.printStackTrace();
    } finally {
      try {
        //SomeException1 throws here
      } catch(SomeException1 se1) {
        se.printStackTrace();
        //Control is getting stop in this block itself but i wanna print the below statement
      }
    }

    System.out.println("End Program"); // --- How about here? (Srikanth)  ----
  } 
```

您正在捕获异常，因此您的程序无论如何都不会突然结束。但我想它会被打印出来，不确定你在 nested-catch 块中到底在做什么。它会抛出一些 RuntimeException 吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T14:05:43.963

其他方式：

```
public void main(String[] args) {
        boolean exceptionOccured = false;
        try {
            exceptionOccured = true;
            //Some Exception throws here
            exceptionOccured = false;
        }
        catch(SomeException se) {
            se.printStackTrace();
        } 
        finally {
            Exception e = null;
            try {
                //SomeException1 throws here
            }
            catch(SomeException1 se1) {                
                exceptionOccured = true;
                se.printStackTrace();
                //Control is getting stop in this block itself but i wanna print the below statement
            }

            // I need to print this statement whatever exception occurs
            if(exceptionOccured)
              System.out.println("End Program"); 
        }
    } 
```

# javascript - 如果内容太宽，请在 HTML 标记中插入省略号 (...)

> ID：536814
> 
> 赞同：151
> 
> 时间：2009-02-11T13:43:08.170
> 
> 标签：javascript, html, ellipsis, elasticlayout

我有一个具有弹性布局的网页，如果调整浏览器窗口的大小，它会改变其宽度。

在此布局中，标题 ( `h2`) 的长度可变（实际上是我无法控制的博客文章的标题）。目前 - 如果它们比窗口宽 - 它们被分成两条线。

是否有一个优雅的、经过测试的（跨浏览器）解决方案 - 例如使用 jQuery - 缩短该标题标签的 innerHTML 并添加“...”如果文本太宽而无法在当前屏幕上放入一行/容器宽度？

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2009-07-09T03:16:35.300

以下仅用于在单行上截断文本的 CSS 解决方案适用于截至撰写本文时[http://www.caniuse.com上列出的所有浏览器，Firefox 6.0 除外。](https://www.caniuse.com/#search=ellipsis)请注意，除非您需要支持换行多行文本或更早版本的 Firefox，否则完全不需要 JavaScript。

```
.ellipsis {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    -o-text-overflow: ellipsis;
} 
```

如果您需要对 Firefox 早期版本的支持，请查看[我对其他问题的回答](https://stackoverflow.com/a/1101702/2766)。

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2009-06-20T22:09:47.483

我有一个在 FF3、Safari 和 IE6+ 中使用单行和多行文本的解决方案

```
.ellipsis {
    white-space: nowrap;
    overflow: hidden;
}

.ellipsis.multiline {
    white-space: normal;
}

<div class="ellipsis" style="width: 100px; border: 1px solid black;">Lorem ipsum dolor sit amet, consectetur adipisicing elit</div>
<div class="ellipsis multiline" style="width: 100px; height: 40px; border: 1px solid black; margin-bottom: 100px">Lorem ipsum dolor sit amet, consectetur adipisicing elit</div>

<script type="text/javascript" src="/js/jquery.ellipsis.js"></script>
<script type="text/javascript">
$(".ellipsis").ellipsis();
</script> 
```

jquery.ellipsis.js

```
(function($) {
    $.fn.ellipsis = function()
    {
        return this.each(function()
        {
            var el = $(this);

            if(el.css("overflow") == "hidden")
            {
                var text = el.html();
                var multiline = el.hasClass('multiline');
                var t = $(this.cloneNode(true))
                    .hide()
                    .css('position', 'absolute')
                    .css('overflow', 'visible')
                    .width(multiline ? el.width() : 'auto')
                    .height(multiline ? 'auto' : el.height())
                    ;

                el.after(t);

                function height() { return t.height() > el.height(); };
                function width() { return t.width() > el.width(); };

                var func = multiline ? height : width;

                while (text.length > 0 && func())
                {
                    text = text.substr(0, text.length - 1);
                    t.html(text + "...");
                }

                el.html(t.html());
                t.remove();
            }
        });
    };
})(jQuery); 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2012-01-30T21:54:24.823

我使用许多其他帖子构建了此代码，并进行了以下增强：

1.  它使用二进制搜索来查找恰到好处的文本长度。
2.  它通过设置一次性显示事件来处理省略号元素最初隐藏的情况，该事件在项目首次显示时重新运行省略号代码。这对于最初未显示某些项目的主详细信息视图或树视图非常方便。
3.  它可以选择为悬停效果添加带有原始文本的标题属性。
4.  添加`display: block`到样式中，因此跨度工作
5.  它使用省略号字符而不是 3 个句点。
6.  它会自动运行带有 .ellipsis 类的任何内容的脚本

CSS：

```
.ellipsis {
        white-space: nowrap;
        overflow: hidden;
        display: block;
}

.ellipsis.multiline {
        white-space: normal;
} 
```

jquery.ellipsis.js

```
(function ($) {

    // this is a binary search that operates via a function
    // func should return < 0 if it should search smaller values
    // func should return > 0 if it should search larger values
    // func should return = 0 if the exact value is found
    // Note: this function handles multiple matches and will return the last match
    // this returns -1 if no match is found
    function binarySearch(length, func) {
        var low = 0;
        var high = length - 1;
        var best = -1;
        var mid;

        while (low <= high) {
            mid = ~ ~((low + high) / 2); //~~ is a fast way to convert something to an int
            var result = func(mid);
            if (result < 0) {
                high = mid - 1;
            } else if (result > 0) {
                low = mid + 1;
            } else {
                best = mid;
                low = mid + 1;
            }
        }

        return best;
    }

    // setup handlers for events for show/hide
    $.each(["show", "toggleClass", "addClass", "removeClass"], function () {

        //get the old function, e.g. $.fn.show   or $.fn.hide
        var oldFn = $.fn[this];
        $.fn[this] = function () {

            // get the items that are currently hidden
            var hidden = this.find(":hidden").add(this.filter(":hidden"));

            // run the original function
            var result = oldFn.apply(this, arguments);

            // for all of the hidden elements that are now visible
            hidden.filter(":visible").each(function () {
                // trigger the show msg
                $(this).triggerHandler("show");
            });

            return result;
        };
    });

    // create the ellipsis function
    // when addTooltip = true, add a title attribute with the original text
    $.fn.ellipsis = function (addTooltip) {

        return this.each(function () {
            var el = $(this);

            if (el.is(":visible")) {

                if (el.css("overflow") === "hidden") {
                    var content = el.html();
                    var multiline = el.hasClass('multiline');
                    var tempElement = $(this.cloneNode(true))
                        .hide()
                        .css('position', 'absolute')
                        .css('overflow', 'visible')
                        .width(multiline ? el.width() : 'auto')
                        .height(multiline ? 'auto' : el.height())
                    ;

                    el.after(tempElement);

                    var tooTallFunc = function () {
                        return tempElement.height() > el.height();
                    };

                    var tooWideFunc = function () {
                        return tempElement.width() > el.width();
                    };

                    var tooLongFunc = multiline ? tooTallFunc : tooWideFunc;

                    // if the element is too long...
                    if (tooLongFunc()) {

                        var tooltipText = null;
                        // if a tooltip was requested...
                        if (addTooltip) {
                            // trim leading/trailing whitespace
                            // and consolidate internal whitespace to a single space
                            tooltipText = $.trim(el.text()).replace(/\s\s+/g, ' ');
                        }

                        var originalContent = content;

                        var createContentFunc = function (i) {
                            content = originalContent.substr(0, i);
                            tempElement.html(content + "…");
                        };

                        var searchFunc = function (i) {
                            createContentFunc(i);
                            if (tooLongFunc()) {
                                return -1;
                            }
                            return 0;
                        };

                        var len = binarySearch(content.length - 1, searchFunc);

                        createContentFunc(len);

                        el.html(tempElement.html());

                        // add the tooltip if appropriate
                        if (tooltipText !== null) {
                            el.attr('title', tooltipText);
                        }
                    }

                    tempElement.remove();
                }
            }
            else {
                // if this isn't visible, then hook up the show event
                el.one('show', function () {
                    $(this).ellipsis(addTooltip);
                });
            }
        });
    };

    // ellipsification for items with an ellipsis
    $(document).ready(function () {
        $('.ellipsis').ellipsis(true);
    });

} (jQuery)); 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-02-24T18:54:47.217

**我的回答只支持单行文本。查看下面 gfullam 对多线分叉的评论，它看起来很有希望。**

我从第一个答案中重写了几次代码，我认为这应该是最快的。

它首先找到一个“估计的”文本长度，然后添加或删除一个字符，直到宽度正确。

它使用的逻辑如下图所示：

![在此处输入图像描述](https://i.stack.imgur.com/8KfW2.png)

在找到“估计的”文本长度后，将添加或删除字符，直到达到所需的宽度。

我确定它需要一些调整，但这里是代码：

```
(function ($) {
    $.fn.ellipsis = function () {
        return this.each(function () {
            var el = $(this);

            if (el.css("overflow") == "hidden") {
                var text = el.html().trim();
                var t = $(this.cloneNode(true))
                                        .hide()
                                        .css('position', 'absolute')
                                        .css('overflow', 'visible')
                                        .width('auto')
                                        .height(el.height())
                                        ;
                el.after(t);

                function width() { return t.width() > el.width(); };

                if (width()) {

                    var myElipse = "....";

                    t.html(text);

                    var suggestedCharLength = (text.length * el.width() / t.width()) - myElipse.length;

                    t.html(text.substr(0, suggestedCharLength) + myElipse);

                    var x = 1;
                    if (width()) {
                        while (width()) {
                            t.html(text.substr(0, suggestedCharLength - x) + myElipse);
                            x++;
                        }
                    }
                    else {
                        while (!width()) {
                            t.html(text.substr(0, suggestedCharLength + x) + myElipse);
                            x++;
                        }
                        x--;
                        t.html(text.substr(0, suggestedCharLength + x) + myElipse);
                    }

                    el.html(t.html());
                    t.remove();
                }
            }
        });
    };
})(jQuery); 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2013-10-24T19:17:00.573

以防万一你们都在 2013 年来到这里 - 这是我在这里找到的纯 css 方法：http: [//css-tricks.com/snippets/css/truncate-string-with-ellipsis/](http://css-tricks.com/snippets/css/truncate-string-with-ellipsis/)

```
.truncate {
  width: 250px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
} 
```

它运作良好。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-12-26T06:44:28.180

我制作了一个非常酷的 jQuery 插件，用于处理各种文本省略号，名为 ThreeDots @ [http://tpgblog.com/threedots](http://tpgblog.com/threedots)

它比 CSS 方法灵活得多，并且支持更高级的、可定制的行为和交互。

享受。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-10-11T13:24:06.847

一个更灵活的 jQuery 插件，使您可以在省略号之后保留一个元素（例如“阅读更多”按钮）并更新 onWindowResize。它也适用于带有标记的文本：

[http://dotdotdot.frebsite.nl](http://dotdotdot.frebsite.nl)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2012-08-24T08:55:52.163

trunk8 jQuery 插件支持多行，并且可以使用任何 html，而不仅仅是省略号，用于截断后缀：[https ://github.com/rviscomi/trunk8](https://github.com/rviscomi/trunk8)

演示在这里：http: [//jrvis.com/trunk8/](http://jrvis.com/trunk8/)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-11T14:06:55.630

实际上有一个非常简单的方法可以[在 CSS 中做到这一点，](http://www.jide.fr/emulate-text-overflowellipsis-in-firefox-with-css)利用 IE 使用非标准和 FF 支持这一事实进行扩展`:after`

如果您愿意，您也可以[在 JS 中执行此操作，](http://www.switchonthecode.com/tutorials/javascript-tutorial-how-to-auto-ellipse-text)方法是检查目标的 scrollWidth 并将其与其父宽度进行比较，但恕我直言，这不太健壮。

编辑：这显然比我想象的要发达。CSS3 支持可能很快就会出现，一些不完善的扩展可供您尝试。

*   [http://www.css3.info/preview/text-overflow/](http://www.css3.info/preview/text-overflow/)
*   [http://ernstdehaan.blogspot.com/2008/10/ellipsis-in-all-modern-browsers.html](http://ernstdehaan.blogspot.com/2008/10/ellipsis-in-all-modern-browsers.html)

最后一个很好读。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-11T13:58:53.123

好吧，一个简单的解决方案，它并没有完全添加“...”，但确实防止 <h2> 分成两行，那就是添加这一点 css：

```
h2 {
    height:some_height_in_px; /* this is the height of the line */
    overflow:hidden; /* so that the second (or third, fourth, etc.)
                        line is not visible */
} 
```

我给了它更多的想法，我想出了这个解决方案，你必须用另一个标签（例如跨度）包装你的 h2 标签的文本内容（或者用具有给定高度的东西包装 h2s）然后您可以使用这种 javascript 过滤掉不需要的单词：

```
var elems = document.getElementById('conainter_of_h2s').
                     getElementsByTagName('h2');

    for ( var i = 0, l = elems.length; i < l; i++) {
        var span = elems.item(i).getElementsByTagName('span')[0];
        if ( span.offsetHeight > elems.item(i).offsetHeight ) {
            var text_arr = span.innerHTML.split(' ');
            for ( var j = text_arr.length - 1; j>0 ; j--) {
                delete text_arr[j];
                span.innerHTML = text_arr.join(' ') + '...';
                if ( span.offsetHeight <= 
                                        elems.item(i).offsetHeight ){
                    break;
                }
            }
        }
    } 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-11T14:34:14.740

我最近为客户做了类似的事情。这是我为他们所做的一个版本（在 Win Vista 上的所有最新浏览器版本中测试的示例）。并非全面完美，但可以很容易地进行调整。

演示：[http ://enobrev.info/ellipsis/](http://enobrev.info/ellipsis/)

代码：

```
<html>
    <head>
        <script src="http://www.google.com/jsapi"></script>
        <script>            
            google.load("jquery", "1.2.6");
            google.setOnLoadCallback(function() {
                $('.longtext').each(function() {
                    if ($(this).attr('scrollWidth') > $(this).width()) {
                        $more = $('<b class="more">&hellip;</b>');

                        // add it to the dom first, so it will have dimensions
                        $(this).append($more);

                        // now set the position
                        $more.css({
                            top: '-' + $(this).height() + 'px',
                            left: ($(this).attr('offsetWidth') - $more.attr('offsetWidth')) + 'px'
                        });
                    }
                });
            });
        </script>

        <style>
            .longtext {
                height: 20px;
                width: 300px;
                overflow: hidden;
                white-space: nowrap;
                border: 1px solid #f00;
            }

            .more {
                z-index: 10;
                position: relative;
                display: block;
                background-color: #fff;
                width: 18px;
                padding: 0 2px;
            }
        </style>
    </head>
    <body>
        <p class="longtext">This is some really long text.  This is some really long text.  This is some really long text.  This is some really long text.</p>
    </body>
</html> 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-01-19T12:29:52.007

这是另一个 JavaScript 解决方案。工作得非常好而且非常快。

[https://github.com/dobiatowski/jQuery.FastEllipsis](https://github.com/dobiatowski/jQuery.FastEllipsis)

在 Windows 和 Mac 上的 Chrome、FF、IE 上测试。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-08-25T10:00:16.753

有一个纯 css 多行文本的解决方案。它被称为`line-clamp`，但它仅适用于 webkit 浏览器。然而，有一种方法可以在所有现代浏览器（比 IE8 更新的浏览器）中模仿这一点。此外，它只适用于纯色背景，因为您需要背景图像来隐藏最后一行的最后一句话。事情是这样的：

鉴于此html：

```
<p class="example" id="example-1">
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
</p> 
```

这是CSS：

```
p {
    position:relative;
    line-height:1.4em;
    height:4.2em;      /* 3 times the line-height to show 3 lines */
}
p::after {
    content:"...";
    font-weight:bold;
    position:absolute;
    bottom:0;
    right:0;
    padding:0 20px 1px 45px;
    background:url(ellipsis_bg.png) repeat-y;
} 
```

ellipsis_bg.png 是与背景颜色相同的图像，宽度约为 100 像素，高度与行高相同。

它不是很漂亮，因为您的文本可能会在字母中间被剪掉，但在某些情况下它可能很有用。

参考：[http ://www.css-101.org/articles/line-clamp/line-clamp_for_non_webkit-based_browsers.php](http://www.css-101.org/articles/line-clamp/line-clamp_for_non_webkit-based_browsers.php)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-06-19T20:54:46.870

文本内容的纯 CSS 多行省略号：

```
.container{
    position: relative;  /* Essential */
    background-color: #bbb;  /* Essential */
    padding: 20px; /* Arbritrary */
}
.text {
    overflow: hidden;  /* Essential */
    /*text-overflow: ellipsis; Not needed */
    line-height: 16px;  /* Essential */
    max-height: 48px; /* Multiples of line-height */
}
.ellipsis {
    position: absolute;/* Relies on relative container */
    bottom: 20px; /* Matches container padding */
    right: 20px; /* Matches container padding */
    height: 16px; /* Matches line height */
    width: 30px; /* Arbritrary */
    background-color: inherit; /* Essential...or specify a color */
    padding-left: 8px; /* Arbritrary */
}
```

```
<div class="container">
    <div class="text">
        Lorem ipsum dolor sit amet, consectetur eu in adipiscing elit. Aliquam consectetur venenatis blandit. Praesent vehicula, libero non pretium vulputate, lacus arcu facilisis lectus, sed feugiat tellus nulla eu dolor. Nulla porta bibendum lectus quis euismod. Aliquam volutpat ultricies porttitor. Cras risus nisi, accumsan vel cursus ut, sollicitudin vitae dolor. Fusce scelerisque eleifend lectus in bibendum. Suspendisse lacinia egestas felis a volutpat. Aliquam volutpat ultricies porttitor. Cras risus nisi, accumsan vel cursus ut, sollicitudin vitae dolor. Fusce scelerisque eleifend lectus in bibendum. Suspendisse lacinia egestas felis a volutpat.
    </div>
    <div class="ellipsis">...</div>
</div>
```

请查看片段以获取实时示例。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-04-15T12:33:41.353

[Devon Govett](https://stackoverflow.com/users/140951/devongovett)有一个简单的 jQuery 解决方案：

[https://gist.github.com/digulla/5796047](https://gist.github.com/digulla/5796047)

> 要使用，只需在 jQuery 对象上调用 ellipsis()。例如：
> 
> $("span").ellipsis();

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-05-18T16:54:23.963

这类似于 Alex 的，但它是在对数时间而不是线性的，并采用 maxHeight 参数。

```
jQuery.fn.ellipsis = function(text, maxHeight) {
  var element = $(this);
  var characters = text.length;
  var step = text.length / 2;
  var newText = text;
  while (step > 0) {
    element.html(newText);
    if (element.outerHeight() <= maxHeight) {
      if (text.length == newText.length) {
        step = 0;
      } else {
        characters += step;
        newText = text.substring(0, characters);
      }
    } else {
      characters -= step;
      newText = newText.substring(0, characters);
    }
    step = parseInt(step / 2);
  }
  if (text.length > newText.length) {
    element.html(newText + "...");
    while (element.outerHeight() > maxHeight && newText.length >= 1) {
      newText = newText.substring(0, newText.length - 1);
      element.html(newText + "...");
    }
  }
}; 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-01-05T18:28:23.170

我重写了 Alex 的函数以用于 MooTools 库。我将其更改为单词跳转，而不是在单词中间添加省略号。

```
Element.implement({
ellipsis: function() {
    if(this.getStyle("overflow") == "hidden") {
        var text = this.get('html');
        var multiline = this.hasClass('multiline');
        var t = this.clone()
            .setStyle('display', 'none')
            .setStyle('position', 'absolute')
            .setStyle('overflow', 'visible')
            .setStyle('width', multiline ? this.getSize().x : 'auto')
            .setStyle('height', multiline ? 'auto' : this.getSize().y)
            .inject(this, 'after');

        function height() { return t.measure(t.getSize).y > this.getSize().y; };
        function width() { return t.measure(t.getSize().x > this.getSize().x; };

        var func = multiline ? height.bind(this) : width.bind(this);

        while (text.length > 0 && func()) {
            text = text.substr(0, text.lastIndexOf(' '));
            t.set('html', text + "...");
        }

        this.set('html', t.get('html'));
        t.dispose();
    }
}
}); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-10-25T12:25:57.497

我找不到一个完全按照我想要的脚本工作的脚本，我自己的 jQuery 也是如此 - 有很多选项可以设置更多选项:)

[https://github.com/rmorse/AutoEllipsis](https://github.com/rmorse/AutoEllipsis)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2012-01-16T13:04:43.590

不过，我对 css 的行为感到有点惊讶。

```
var cssEllipsis = 
{   "width": "100%","display": "inline-block", 
"vertical-align": "middle", "white-space": "nowrap", 
"overflow": "hidden", "text-overflow": "ellipsis" 
}; 
```

除非我提供了我需要绑定省略号的控件的宽度，否则我的原因并不支持。宽度是必须添加的属性吗？？？请提出你的想法。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-01-18T13:26:31.320

**仅使用 CSS**做省略号

 **```
<html>
<head>
<style type="text/css">
#ellipsisdiv {
    width:200px;
    white-space: nowrap;  
    overflow: hidden;  
    text-overflow: ellipsis;  
}  
</style>
</head>
<body>
<div id="ellipsisdiv">
This content is more than 200px and see how the the ellipsis comes at the end when the content width exceeds the div width.
</div>
</body>
</html> 
```

*此代码适用于大多数当前浏览器。如果您在使用 Opera 和 IE 时遇到任何问题（可能不会），请在样式中添加这些：

```
-o-text-overflow: ellipsis;  
-ms-text-overflow: ellipsis; 
```

* 此功能是 CSS3 的一部分。它的完整语法是：

```
text-overflow: clip|ellipsis|string; 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-04-07T14:55:21.147

这是一个很好的小部件/插件库，它内置了省略号：http: [//www.codeitbetter.co.uk/widgets/ellipsis/](http://www.codeitbetter.co.uk/widgets/ellipsis/)你需要做的就是引用该库并调用以下代码：

```
<script type="text/javascript"> 
   $(document).ready(function () { 
      $(".ellipsis_10").Ellipsis({ 
         numberOfCharacters: 10, 
         showLessText: "less", 
         showMoreText: "more" 
      }); 
   }); 
</script> 
<div class="ellipsis_10"> 
   Some text here that's longer than 10 characters. 
</div> 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2013-06-27T14:03:03.850

您可以仅使用 css 更轻松地完成此操作，例如：sass 模式

```
.truncatedText {
   font-size: 0.875em;
   line-height: 1.2em;
   height: 2.4em; // 2 lines * line-height
   &:after {
      content: " ...";
   }
} 
```

你有省略号；）

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-04-10T10:48:07.123

就像@acSlater 一样，我找不到我需要的东西，所以我自己动手了。分享以防其他人可以使用：

方法：

```
ellipsisIfNecessary(mystring,maxlength); 
```

用法：

```
trimmedString = ellipsisIfNecessary(mystring,50); 
```

代码和演示链接：[https ://gist.github.com/cemerson/10368014](https://gist.github.com/cemerson/10368014)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-05-21T01:08:49.057

```
<html>
<head>
    <!-- By Warren E. Downs, copyright 2016\.  Based loosely on a single/multiline JQuery using example by Alex,
    but optimized to avoid JQuery, to use binary search, to use CSS text-overflow: ellipsis for end,
    and adding marquee option as well.
    Credit: Marquee: http://jsfiddle.net/jonathansampson/xxuxd/
            JQuery version: http://stackoverflow.com/questions/536814/insert-ellipsis-into-html-tag-if-content-too-wide
            (by Alex, http://stackoverflow.com/users/71953/alex)
            (Improved with Binary Search as suggested by StanleyH, http://stackoverflow.com/users/475848/stanleyh)
    -->
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <style>

        .single {
            overflow:hidden;
            white-space: nowrap;
            width: 10em;
            padding: 10px;
            margin: 0 auto;
            border: solid 1px blue;
        }

        .multiline {
            overflow: hidden;
            white-space: wrap;
            width: 10em;
            height: 4.5em;
            padding: 10px;
            margin: 0 auto;
            border: solid 1px blue;
        }

        .marquee {
            overflow: hidden;
            width: 40em;
            padding: 10px;
            margin: 0 auto;
            border: solid 1px blue;
        }

</style>
    <script>
        var _marqueeNumber=0;
        // mode=start,end,middle
        function clipText(text, len, mode) {
            if(!mode) { mode="end"; }
            else { mode=mode.toLowerCase(); }
            if(mode == "start") { return "&hellip;"+clipText(text,len,"_start"); }
            if(mode == "_start") { return text.substr(text.length - len); }
            if(mode == "middle") { 
                return clipText(text, len/2, "end") + clipText(text, len/2, "_start");
            }
            return text.substr(0, len) + "&hellip;";
        }

        function generateKeyframes(clsName, start, end) {
            var sec=5;
            var totalLen=parseFloat(start)-parseFloat(end);
            if(start.indexOf('em') > -1)      { sec=Math.round(totalLen/3); }
            else if(start.indexOf('px') > -1) { sec=Math.round(totalLen/42); }

            var style = document.createElement('style');
            style.type = 'text/css';
            style.innerHTML = 'body {}';
            document.getElementsByTagName('head')[0].appendChild(style);
            this.stylesheet = document.styleSheets[document.styleSheets.length-1];
            try {
                this.stylesheet.insertRule('.'+clsName+' {\n'+
                    '    animation: '+clsName+' '+sec+'s linear infinite;\n'+
                    '}\n', this.stylesheet.rules.length);
                this.stylesheet.insertRule('.'+clsName+':hover {\n'+
                    '    animation-play-state: paused\n'+
                    '}\n', this.stylesheet.rules.length);
                this.stylesheet.insertRule('@keyframes '+clsName+' {\n'+
                    '    0%   { text-indent: '+start+' }\n'+
                    '    100% { text-indent: '+end+' }\n'+
                    '}', this.stylesheet.rules.length);
            } catch (e) {
                console.log(e.message);
            }
        }

        function addClone(el, multiline, estyle) {
            if(!estyle) { 
                try { estyle=window.getComputedStyle(el); }
                catch(e) { return null; }
            }
            var t = el.cloneNode(true);
            var s=t.style;
            //s.display='none';
            s.visibility='hidden'; // WARNING: Infinite loop if this is not hidden (e.g. while testing)
            s.display='inline-block';
            s.background='black';
            s.color='white';
            s.position='absolute';
            s.left=0;
            s.top=0;
            s.overflow='visible';
            s.width=(multiline ? parseFloat(estyle.width) : 'auto');
            s.height=(multiline ? 'auto' : parseFloat(estyle.height));

            el.parentNode.insertBefore(t, el.nextSibling);

            return t;
        }
        function getTextWidth(el, multiline) {
            var t=addClone(el, multiline);
            if(!t) { return null; }
            var ts=window.getComputedStyle(t);
            var w=ts.width;
            if(multiline) {
                var es=window.getComputedStyle(el);
                var lines=Math.round(parseInt(ts.height)/parseInt(es.height))*2+0.5;
                w=w+'';
                var unit=''; // Extract unit
                for(var xa=0; xa<w.length; xa++) {
                    var c=w[xa];
                    if(c <= '0' || c >= '9') { unit=w.substr(xa-1); }
                }
                w=parseFloat(w);
                w*=lines; // Multiply by lines
                w+=unit; // Append unit again
            }
            t.parentNode.removeChild(t);
            return w;
        }

        // cls=class of element to ellipsize
        // mode=start,end,middle,marq (scrolling marquee instead of clip)
        function ellipsis(cls, mode) {
            mode=mode.toLowerCase();
            var elems=document.getElementsByClassName(cls);
            for(xa in elems) {
                var el=elems[xa];
                var multiline = el.className ? el.className.indexOf('multiline') > -1 : true;
                if(mode == "marq") {       
                    var w=getTextWidth(el, multiline);
                    if(!w) { continue; }
                    var mCls="dsmarquee"+(_marqueeNumber++);
                    var es=window.getComputedStyle(el);
                    generateKeyframes(mCls,es.width, '-'+w);
                    el.className+=" "+mCls; 
                    continue; 
                }
                if(mode == "end" && !multiline) { el.style.textOverflow="ellipsis"; continue; }
                var estyle=null;
                try { estyle=window.getComputedStyle(el); }
                catch(e) { continue; }
                if(estyle.overflow == "hidden") {
                    var text = el.innerHTML;
                    var t=addClone(el, multiline, estyle);

                    function height() {
                        var ts=window.getComputedStyle(t);
                        var es=window.getComputedStyle(el);
                        return parseFloat(ts.height) - parseFloat(es.height); 
                    }
                    function width() { 
                        var ts=window.getComputedStyle(t);
                        var es=window.getComputedStyle(el);
                        return parseFloat(ts.width) - parseFloat(es.width); 
                    }

                    var tooLong = multiline ? height : width;

                    var len=text.length;
                    var diff=1;
                    var olen=0;
                    var jump=len/2;
                    while (len > 0) {
                        var diff=tooLong();
                        if(diff > 0) { len-=jump; jump/=2; }
                        else if(diff < 0) { len+=jump; }
                        len=Math.round(len);
                        //alert('len='+len+';olen='+olen+';diff='+diff+';jump='+jump+';t='+JSON.stringify(t.innerHTML));
                        t.innerHTML=clipText(text, len, mode);
                        if(olen == len) { break; }
                        olen=len;
                    }
                    el.innerHTML=t.innerHTML;
                    t.parentNode.removeChild(t);
                }           
                //break;
                t.style.visibility='hidden';
            }
        }

        function testHarness() {
            ellipsis('ellipsis1', 'start'); 
            ellipsis('ellipsis2', 'end'); 
            ellipsis('ellipsis3', 'middle'); 
            ellipsis('marquee', 'marq')
        }
    </script>
    </head>
    <body onload="testHarness()">
    <div class="single ellipsis1" style="float:left">some long text that should be clipped left</div>
    <div class="single ellipsis2" style="float:right">right clip long text that should be clipped</div>
    <div class="single ellipsis3" style="float:center">some long text that should be clipped in the middle</div>

    <br />

    <p class="single marquee">Windows 8 and Windows RT are focused on your life—your friends and family, your apps, and your stuff. With new things like the <a href="http://windows.microsoft.com/en-US/windows-8/start-screen">Start screen</a>, <a href="http://windows.microsoft.com/en-US/windows-8/charms">charms</a>, and a <a href="http://windows.microsoft.com/en-US/windows-8/microsoft-account">Microsoft account</a>, you can spend less time searching and more time doing.</p>
    &nbsp;

    <br />

    <div class="multiline ellipsis1" style="float:left">Test test test test test test, some more long text, such as asdasdasdasdasd, that should be multiline clipped left(*)</div>

    <div class="multiline ellipsis2" style="float:right">right clip multiline long text, such as Test test test test test test, and some more long text that should be multiline clipped right.</div>

    <div class="multiline ellipsis3" style="float:center">Test test test test test test, some more long text, such as asdasdasdasdasd, that should be multiline clipped in the middle(*)</div>

    <br />

    <p class="multiline marquee">Multiline Marquee: Windows 8 and Windows RT are focused on your life—your friends and family, your apps, and your stuff. With new things like the <a href="http://windows.microsoft.com/en-US/windows-8/start-screen">Start screen</a>, <a href="http://windows.microsoft.com/en-US/windows-8/charms">charms</a>, and a <a href="http://windows.microsoft.com/en-US/windows-8/microsoft-account">Microsoft account</a>, you can spend less time searching and more time doing.</p>
    &nbsp;

    </body>
</html> 
```

# wpf - WPF 数据绑定 IsEnabled 属性

> ID：536820
> 
> 赞同：2
> 
> 时间：2009-02-11T13:44:18.290
> 
> 标签：wpf, data-binding, menuitem, isenabled

所以我现在正在学习 WPF，并且想在 bool 值和是否`MenuItem`启用 a 之间进行简单的数据绑定。

我已经这样编码了：

```
<MenuItem Name="miSaveFile" Header="Save" Click="miSaveFile_Click"
IsEnabled="{Binding}" /> 
```

在我设置的 .cs 文件中：

```
miSaveFile.DataContext = dataChanged; 
```

出于某种原因，`MenuItem`似乎没有正确反映 dataChanged 的​​状态。

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T14:52:49.797

你最好绑定到一个对象而不是一个原始类型。该对象通常被称为您的视图的“模型”。

WPF 使用模型（或通常是视图模型）的 INotifyPropertyChanged 接口来通知视图模型已更改状态。

因此，您首先需要将数据类定义为实现 INotifyPropertyChanged 接口并在属性更改时触发 PropertyChanged 事件的模型。

设置绑定时，您需要担心绑定的 5 个主要元素。绑定具有源对象、源对象上的源路径、目标对象、目标对象上的目标属性和可选的转换器。

如果不指定源，则默认为设置绑定的控件的 DataContext。还有其他用于设置源的选项。[这](http://msdn.microsoft.com/en-us/library/ms746695.aspx)是关于设置源的 Microsoft 文章。然后，您可以设置属性的路径以从绑定源中拉出。在您的情况下，源是一个布尔值并且没有路径，因为绑定正在使用整个源对象。

目标始终是您设置绑定的控件，目标属性是您要绑定到的此控件的属性。在这种情况下，MenuItem 和 IsEnabled。

转换器可以选择将源值转换为与目标属性兼容的值。您可以将任何对象用于实现 IValueConverter 或 IMultiValueConverter（用于 MutliBindings）的转换器。

在您的情况下，我将首先创建一个实现 INotifyPropertyChanged 的​​模型。接下来，我会将菜单的 DataContext 分配给模型的一个实例。然后我将绑定设置为：

```
IsEnabled="{Binding Path=EnableFlag}" 
```

（其中 EnableFlag 是模型中要通过菜单绑定到的布尔属性）

如果您正确设置了 INotifyPropertyChanged 接口，则只要您更改模型上的此属性，菜单项就会启用/禁用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-10T16:58:26.333

对于 MenuItem，使用 Command 模型而不是 Click 和 IsEnabled 属性不是更好的方法吗？

在初始化组件（）之后：

```
this.CommandBindings.Add(new CommandBinding(ApplicationCommands.Save, fileSaveExecuted, fileSaveCanExecute)); 
```

附加方法：

```
/* here is where you set e.CanExecute true for enabled: */
    private void fileSaveCanExecute(object x, CanExecuteRoutedCommandEventArgs e)) { e.CanExecute = ...; e.Handled = true; }
/* here is where you act on the command: */
    private void fileSaveExecuted(object sender, ExecutedRoutedEventArgs e) { ... } 
```

XAML：

```
<MenuItem Header="_Save" Command="Save"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T13:59:08.740

UI 如何知道 dataChanged 变量何时实际更改？

我通常绑定到对象的属性，并让该类实现 INotifyPropertyChanged。每当调用 PropertyChanged 事件时，UI 就会“自动”更新。

所以我会

```
<MenuItem Name="miSaveFile" Header="Save" Click="miSaveFile_Click"
IsEnabled="{Binding DataChanged}"</MenuItem> 
```

然后设置 miSaveFile.DataContext = myObject.DataChanged （如果您使用代码隐藏，myObject 可以是这个）

编辑：我刚刚做了一个快速测试。如果将数据上下文直接设置为 DataChanged 属性，则不会添加对所有者对象的 PropertyChanged 事件的订阅。但我建议的解决方案有效。

# java - 将 UrlRewriteFilter 和 struts 2 与 get 参数结合使用

> ID：536821
> 
> 赞同：0
> 
> 时间：2009-02-11T13:44:20.757
> 
> 标签：java, jakarta-ee, url-rewriting, struts2, model-driven

跟进我的一个较早的问题，我设法让 URL 重写在我的 struts 项目中正常工作，其中 URL 之类的 URL`search?q=blah`被转换为 query `search.action?q=blah`。我们为此使用[UrlRewriteFilter 。](http://code.google.com/p/urlrewritefilter/)这似乎可以很好地转发到 struts（如果确保它具有与 FORWARD 的过滤器映射），但是当`ParametersIntercepter`运行时它似乎会捕获每个参数两次，并在其间添加逗号。所以以下内容：

```
search.action?q=blah 
```

将 Criteria 对象上的参数 q（见进一步）设置为：

```
[ blah, blah ] 
```

参数设置使用`ModelDriven<Criteria>`Where Criteria 是一个简单的类，其中包含要从 GET 字符串设置的一组属性。

我不知道为什么会发生这种情况。有没有人见过这样的事情？我在过滤器/拦截器方面做错了吗？

编辑：似乎`ParametersInterceptor`只是设置了 ActionContext 对象中包含的参数。我不确定（也没有看到任何指示的调试消息）这些值在 ActionContext 中的设置位置。有谁愿意澄清这一切应该如何运作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T09:21:24.590

我还没有解决上面的奇怪行为，但是我设法在 url 重写中发现了一个错误，页面没有被重定向到“mySearch.action”而是“mySearch.action？”。现在使用带有固定规则的 url 重写并且不包括查询参数似乎可以正常工作。

编辑：我最终将此追溯到设置为同时侦听 REQUEST 和 FORWARD 的 urlrewritefilter 的问题。显然这会导致 GET 参数被解析两次。但是，我仍然不包括查询参数（因为这通常会使事情混淆），因此这可能无法完全解决问题。虽然它是最有可能的罪魁祸首。

特别是，我的过滤器映射现在看起来像：

```
<filter-mapping>
     <filter-name>UrlRewriteFilter</filter-name>
     <url-pattern>/*</url-pattern>
     <dispatcher>REQUEST</dispatcher>
</filter-mapping> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T03:44:04.947

以防万一您可能仍然对额外的信息感兴趣，您是否知道最新版本的 Struts2（即 2.1.？）不会对`.action`您的操作进行扩展？事实上，您根本不需要任何扩展！

如果我没记错的话，唯一的要求是，在 中`web.xml`，将 Struts2 过滤器 ( `org.apache.struts2.dispatcher.FilterDispatcher`) 映射到 url-pattern：`/*`

```
<filter-mapping>
   <filter-name>action2</filter-name>
   <url-pattern>/*</url-pattern>
</filter-mapping> 
```

从那时起，`<s:url>`出现在扩展名为空的页面上的标签将依次生成一个没有扩展名的 url...

# vba - 如何通过双击一张表的特定单元格将数据复制到另一张表

> ID：536822
> 
> 赞同：0
> 
> 时间：2009-02-11T13:44:42.987
> 
> 标签：vba, excel

我正在写下我想在 excel 中使用宏的要求：

*   我有一个包含 4 个工作表的工作簿：我保存数据库的 SourceSheet，我想发送一些数据库产品的 TargetSheet，以便进行一些计算，resultsSheet 和 InfoSheet。
*   **如果用户双击 SourceSheet 中属于 A 列的单元格，例如 A8，则应将单元格 A8 到 F8 的数据复制到 TargetSheet 的单元格 C18 到 H18 中，并将 sourceSheet 的单元格 J8 复制到单元格 B18的目标表。如果 TargetSheet 的单元格 B18 到 H18 被占用，则应将数据复制到下一行。**
*   如果用户双击 SourceSheet 中不属于 A 列的单元格，则不会发生任何事情。
*   如果用户双击任何其他工作表，则不会再发生任何事情。

我遇到的麻烦是上面的粗体字。我知道我必须确定使用以下内容：

```
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

End Sub 
```

因此，我在 SourceSheet 中尝试了类似以下内容（但没有成功：（）

```
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    Range("ActiveCell:(ActiveCell.Offset(0, 5))").Copy Worksheets("TargetSheet ").Range("C2:G2")
    ActiveCell.Offset(0, 9).Copy Worksheets("TargetSheet ").Range("B18")
End Sub 
```

我是 vba 的新手，所以任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T14:02:23.053

您需要测试您是否真的在 A:A 范围内双击（= 列 1）。

```
 Private Sub Workbook_SheetBeforeDoubleClick(ByVal Sh As Object, ByVal Target As Range, Cancel As Boolean)

    If ActiveCell.Column = 1 Then
        MsgBox "Double click on A:A range."
    End If
End Sub 
```

# php - PHP 将图像附加到电子邮件

> ID：536838
> 
> 赞同：6
> 
> 时间：2009-02-11T13:49:02.383
> 
> 标签：php, email, attachment

有没有办法将图像附加到用 PHP 创建的 html 格式的电子邮件？

我们需要确保发送给在阅读电子邮件时可能无法访问互联网的客户的电子邮件中包含公司徽标（他们显然可以下载文件）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T13:53:49.483

试试 PEAR [Mail_Mime](http://pear.php.net/package/Mail_Mime)包，它可以[为您嵌入图像](http://pear.php.net/manual/en/package.mail.mail-mime.addhtmlimage.php)。

您需要使用[addHTMLImage()](https://pear.php.net/manual/en/package.mail.mail-mime.addhtmlimage.php)方法并传递内容 id (cid)，这是一个唯一的文本字符串，您还将在 img 的 src 属性中用作`cid:`URL。例如：

```
include('Mail.php');
include "Mail/mime.php";

$crlf = "\r\n";
$hdrs = array( 
        'From' => 'foo@bar.org', 
        'Subject' => 'Mail_mime test message' 
        ); 

$mime = new Mail_mime($crlf); 

//attach our image with a unique content id
$cid="mycidstring";
$mime->addHTMLImage("/path/to/myimage.gif", "image/gif", "", true, $cid);

//now we can use the content id in our message
$html = '<html><body><img src="cid:'.$cid.'"></body></html>';
$text = 'Plain text version of email';

$mime->setTXTBody($text);
$mime->setHTMLBody($html); 

$body = $mime->get();
$hdrs = $mime->headers($hdrs);

$mail =& Mail::factory('mail');
$mail->send('person@somewhere.org', $hdrs, $body); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T13:54:09.547

使用一些可以处理电子邮件附件的库可能是最简单的。例如，PEAR 的[Mail_Mime](http://pear.php.net/package/Mail_Mime)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T14:02:42.740

PEAR 的[Mail_Mime](http://pear.php.net/package/Mail_Mime)包就是您想要的。

设置好消息后，添加附件非常简单：

```
$mime = new Mail_mime("\n");

$mime->setTXTBody($msg_text);
$mime->setHTMLbody($msg_html);

// Add gif as attachment to mail
$mime->addAttachment("/path/to/image/smile.gif", "image/gif");

$body = $mime->get();
$headers = $mime->headers($headers);
$mail->send("joe@bloggs.com", $headers, $body); 
```

如果您希望您的徽标显示在电子邮件的特定位置 - 而不仅仅是作为附件 - 您可以执行以下操作：

```
// In your message html:
<img src='logo.gif' alt='Our logo' />

// PHP:
$mime->addHTMLImage('/path/to/image/logo.gif'); 
```

根据您用户的邮件客户端，这种方法可能会产生不同的结果，因此在发送之前尝试在虚拟 gmail、雅虎和 hotmail 帐户上测试您的格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T13:54:57.750

> 您是自己滚动还是使用预制类？我自己推荐 PHP Mailer[0]，还有 PEAR::Mail_Mime[1] 等等，Google 很乐意帮你找到。多年来，我一直在使用 PHP Mailer 发送带有嵌入式图像[2] 的消息而没有遇到任何问题，但请记住，每个图像都会极大地增加电子邮件的带宽权重，因此通常不应将其用于任何批量处理。为了呼应比尔，也要 *使用*纯文本替代方案。
> 
> [0] [http://phpmailer.sourceforge.net/](http://phpmailer.sourceforge.net/)
> 
> [1] [http://pear.php.net/manual/en/package.mail.mail-mime.php](http://pear.php.net/manual/en/package.mail.mail-mime.php)
> 
> [2] [http://phpmailer.sourceforge.net/docs/PHPMailer/PHPMailer.html#AddEmbeddedImage](http://phpmailer.sourceforge.net/docs/PHPMailer/PHPMailer.html#AddEmbeddedImage)

取自[http://lists.evolt.org/archive/Week-of-Mon-20060612/183029.html](http://lists.evolt.org/archive/Week-of-Mon-20060612/183029.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T14:37:32.360

这里有足够多的答案可以帮助解决您的特定问题，但我只是认为值得指出的是，您可能有一个*更大的*问题，您可能没有考虑过。

具体来说 - 编写通过 PHP 发送的电子邮件充满了潜在的陷阱，只有在您非常清楚可能出现的问题时才应该这样做。

如果您计划相当密集地发送电子邮件，我强烈建议您通过专用的电子邮件营销客户端或实施将为您发送电子邮件的众多电子邮件营销 API 之一。（[mailchimp](http://www.mailchimp.com/api/)显然是一个不错的）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-03T21:36:24.213

在这里试用 swiftmailer 是一个很好的例子，如何使用嵌入图像[http://swiftmailer.org/wikidocs/v3/embedding_images?s[]=embed](http://swiftmailer.org/wikidocs/v3/embedding_images?s[]=embed)

# php - 包含警告：无法在正确路径中找到文件？

> ID：536854
> 
> 赞同：0
> 
> 时间：2009-02-11T13:52:28.990
> 
> 标签：php, include, warnings

```
Warning: include(/2008/2009/assets/inc/base/error.inc.php) [function.include]:
failed to open stream: No such file or directory in
C:\Program Files\Apache Group\Apache2\htdocs\2008\2009\assets\inc\base\header.inc.php on line 82 
```

在 WAMP 设置中包含文件时，我收到上述错误。Windows是否有可能将 /2​​008/ 解释为 c:/2008 而不是实际的[http://localhost/2008](http://localhost/2008)？

为了提供更多细节，我有一个定义为 ROOT 的常量，我在整个网站上都使用它。（本例中的 ROOT 设置为 /2008/2009/）。我在图像、链接、css 文件、包含/需要文件等的路径之前使用 ROOT。CSS 和链接正确缩放到 localhost/2008/2009，但找不到包含文件。

任何帮助将不胜感激。

PS php.ini 包含定义为的路径：

```
include_path = C:\Program Files\Apache Group\Apache2\htdocs" 
```

**更新**

我正在使用 URL 重写将 item/x 更改为 item-display.php?id=x，文件夹中的这种更改是构建 ROOT 的基础。这使得向浏览器显示的任何内容（imgs、链接等）都可以正常工作，但是内部的任何内容都无法正常工作，因为 item-display.php 实际上是一个文件夹。我将 item-display.php 移动到一个项目文件夹，这使得客户端和服务器端的操作保持一致。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T13:54:09.890

您使用的是绝对路径而不是相对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T13:58:00.177

如果您使用包含路径，则必须指定一个相对 URL，从第一个目录或`./`. 顺便说一句，您应该`dirname(__FILE__)`在项目中的位置不会改变的文件中定义路径，或者通过查看 server.xml 来定义路径。否则，在另一台服务器上安装您的应用程序将会变得不必要地复杂。

# sql - 跨数据库存储过程性能注意事项

> ID：536861
> 
> 赞同：2
> 
> 时间：2009-02-11T13:54:04.867
> 
> 标签：sql, stored-procedures

在我的项目中，我在同一台服务器上有两个单独的数据库。除了需要在数据库“A”中访问的数据库“B”中的三列之外，这些数据库是自给自足的。

如果我在 A 中有一个直接从 B 访问三列的存储过程，是否有性能考虑？

目前，我们每晚运行一个作业，将所需数据从表 B 导入到表 A，这样存储过程就不会超出 A 的范围。

这是最好的方法吗？

跨数据库存储过程是否符合最佳实践？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T13:58:44.713

应该没有问题，因为数据库在同一台服务器上。当您使用链接服务器执行此操作时，通常会出现问题，并且您可能会遇到网络延迟

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T13:59:35.510

是的，您当前正在做的事情——即复制——是“正确”的事情。

当引用另一个数据库中的数据时，您不能使用引用完整性、数据约束和许多其他使 RDBMS 成为使用的好工具的好东西。

直接访问其他数据库会将数据库联系在一起——它们必须始终存在于同一台服务器上。您可能会在使用链接服务器并按需执行 proc 时遇到宽度问题。

复制为您提供了更大的灵活性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T14:19:32.263

澄清其他张贴者的评论。

通过存储过程使用跨数据库访问时，没有“直接”的负面性能影响。性能将取决于各个数据库的底层架构，即可用索引、物理存储位置等。

这实际上是一种很常见的做法，只要您遵循标准的查询调优原则，就可以了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T13:58:20.520

这完全取决于您引用的数据以及是否设置了索引以支持这种直接访问。我能告诉你的最好的事情是创建查询，运行它，看看性能是否足够好。

如果性能不令人满意，请再次运行查询并让您的管理工具生成执行计划，以便您识别瓶颈。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T14:52:35.257

我们一直这样做。只要它们在同一台服务器上，就没有问题。如果您要求数据必须在数据库 a 上的表 a 中才能进入数据库 b 上的表 B 中，您将需要编写一个触发器来检查，因为不能跨数据库设置外键关系。

# c++ - 同一台机器上的 libstdc++ 64 位和 32 位版本

> ID：536865
> 
> 赞同：6
> 
> 时间：2009-02-11T13:54:49.920
> 
> 标签：c++, build-process, 64-bit, linker, 32-bit

我正在尝试为 64 位平台交叉编译我的软件版本。我可以在同一台机器上安装 32 位和 64 位版本的 libstdc++，而不必担心会破坏我的 linux 安装。操作系统是 32 位的 ubuntu。

我以前没有交叉编译过，只是想检查一下，如果我为适当的 CPU 设置了我的 CFLAGS 和 LDFLAGS，一旦我安装了正确版本的 libstdc++，我应该没问题。

我检查了 64 位版本的 ubuntu，但是这有一个符号链接

lib64 -> 库

如果在 32 位机器上也是这种情况，这会搞砸很多事情，有人知道如何排序吗？

我目前遇到以下错误

> ```
>  [exec] /usr/bin/ld: skipping incompatible /usr/lib/gcc/i486-linux-gnu/4.2.4/libstdc++.so
>  [exec] /usr/bin/ld: skipping incompatible /usr/lib/gcc/i486-linux-gnu/4.2.4/libstdc++.a
>  when searching for -lstdc++ [exec] /usr/bin/ld: skipping incompatible 
> ```
> 
> 依此类推，直到

```
 [exec] /usr/bin/ld: cannot find -lstdc++
 [exec] collect2: ld returned 1 exit status 
```

这似乎是因为我没有 64 位版本的 libstdc++

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T14:02:17.577

你当然可以。

只需将它们分别放入`/usr/lib`和`/usr/lib64`。

无法检查它`Ubuntu`，但`Fedora`他们可以从包裹中直接到达那里：

```
[~#] repoquery -q -l libstdc++.i386
/usr/lib/libstdc++.so.6
/usr/lib/libstdc++.so.6.0.10

[~#] repoquery -q -l libstdc++.x86_64
/usr/lib64/libstdc++.so.6
/usr/lib64/libstdc++.so.6.0.10 
```

# asp.net-mvc - 是否有工具可以自动/强调对我的站点进行 POST 调用以进行测试？

> ID：536870
> 
> 赞同：2
> 
> 时间：2009-02-11T13:55:57.357
> 
> 标签：asp.net-mvc, testing

我想强调（不确定这是正确的词，但请继续阅读）我的控制器的 [POST] 操作。是否存在会生成许多场景的工具，例如省略字段、添加一些字段、生成有效和无效值、注入攻击等等？谢谢

**更新**：我不想对我的网站进行基准测试/性能测试。只需**自动填写/篡改**表格，看看会发生什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T14:04:49.507

Spidynamics 的 WebInspect（HP 购买了它们）。

我在以前的工作中使用过这个（我当时向我的雇主推荐了它），我对我可以用它做的大量信息和测试感到不知所措。

[https://download.spidynamics.com/webinspect/default.htm](https://download.spidynamics.com/webinspect/default.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:52:39.047

Apache JMeter 更有可能对自己而不是您的站点进行基准测试/强调。我最近指出[了 Faban](http://faban.sunsource.net/)，它可以用于非常简单和更复杂的测试和场景，它非常高效。此外，看看[OpenSTA](http://www.opensta.org/)和[WebLoad](http://www.webload.org/)，它们既免费又强大，具有记录和回放复杂场景的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-09T06:28:49.130

使用带有 HtmlAgilityPack 的 WebClient 自己构建一个。使用 agilitypack 解析您的 html 并获取表单，然后随机填写字段并进行 POST

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T14:12:44.307

[Apache JMeter](http://jakarta.apache.org/jmeter/)可能符合要求？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-03T21:05:48.717

您在 CodePlex看过[CrossBow Web 压力测试器吗？](http://crossbow.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=14770)

*   支持获取和发布操作
*   您指定线程数、请求数、等待数和超时数
*   读取带有名称/值对的 txt 文件以发布值

如果您想为您的 Post 变量生成随机数据，您必须下载并修改源代码。

# windows-vista - 以编程方式在设备管理器中禁用设备 (Vista x64)

> ID：536879
> 
> 赞同：4
> 
> 时间：2009-02-11T13:58:07.087
> 
> 标签：windows-vista, 64-bit, device

有没有办法以编程方式禁用设备？（最好在 .net、win32 或批处理中）。

谷歌上的大多数点击都建议使用 devcon，但它似乎不适用于 Windows Vista/7 64 位。

[如何禁用系统设备？](https://stackoverflow.com/questions/252185/-net-how-do-i-disable-a-system-device)有一个使用 SetupDiSetClassInstallParams 的解决方案，但它也不适用于 Vista64。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T15:32:40.357

32 位版本`devcon`在 WoW64 仿真中不完全可用；我已经看到它也无法禁用设备。[Windows 驱动程序工具包](http://www.microsoft.com/whdc/devtools/wdk/default.mspx)包括一个 64 位版本`devcon`，它可以工作。它还包含 的源代码`devcon`，因此您可以看到它`devcon`只是 Setup API 的包装器。

当您尝试直接调用 Setup API 时，它是来自 32 位还是 64 位进程？根据使用经验`devcon`，我怀疑您需要从 64 位进程调用 Setup API。

# javascript - 检索 iframe 的内容

> ID：536883
> 
> 赞同：0
> 
> 时间：2009-02-11T13:58:57.460
> 
> 标签：javascript, html

我有一个窗口，里面有一个 iframe。当我单击按钮时，iframe 将加载（从网站加载）。是否可以检索该 iframe 的内容？如何检索该页面的内容？

我可以通过左键单击 iframe 查看源代码来查看源代码。

我需要将源存储在数据库中。

1\. var iframe = document.getElementById("ifrm");

警报（iframe.contentWindow.document.body.innerHTML）；

2.alert(window.frames['ifrm'].document.body.innerHTML);

这两条评论显示“拒绝访问”错误。

请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T14:03:25.547

这应该有效（如果它在同一个域上）：

```
document.getElementById('iframeId').contentWindow.document.body.innerHTML 
```

请注意，在运行此代码之前，您需要确保框架已完全加载。否则，你会得到奇怪的异常。

免责声明：我没有对此进行测试。

这是我使用的谷歌查询：[谷歌查询](http://www.google.com/search?q=iframe+get+content)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:06:29.190

[由于同源安全策略](http://en.wikipedia.org/wiki/Same_origin_policy)，通常无法读取从另一台服务器加载的 iframe 的内容。但是，看起来您无论如何都想将内容存储在服务器上，那么为什么不从服务器请求内容呢？

# c# - .NET WinForms 应用程序的 MVC/MVP 框架

> ID：536888
> 
> 赞同：7
> 
> 时间：2009-02-11T14:00:06.333
> 
> 标签：c#, .net, windows, winforms, frameworks

有人知道企业 WinForms 应用程序的可用 MVC/MVP 框架吗？

在[.NET 的用户界面进程应用程序块之前](http://msdn.microsoft.com/en-us/library/ms998252.aspx)。[但自从Windows Workflow Foundation](http://msdn.microsoft.com/en-us/library/ms735967.aspx)发布以来，它不再处于开发阶段（它也将用 .NET 4.0 完全重写）。

也许我不是最新的，但在我看来，目前似乎存在差距。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-11T15:38:35.130

Microsoft 具有用于 WinForms 应用程序的复合应用程序块 (CAB)。虽然在技术上不是 MVC/MVP 实现，但它确实在 UI 代码和非 UI 代码之间提供了很好的分离：http: [//msdn.microsoft.com/en-us/library/aa480450.aspx](http://msdn.microsoft.com/en-us/library/aa480450.aspx)

只要您对相关模式感到满意，自己动手而不使用任何框架也很受欢迎。Jeremy Miller 有一系列关于采用这种方法时的最佳实践的优秀文章：

[构建您自己的 CAB 第 1 部分 - 序言](http://codebetter.com/blogs/jeremy.miller/archive/2007/05/21/build-your-own-cab-part-1-the-preamble.aspx)

[构建您自己的 CAB 第 2 部分 - 简陋的对话框](http://codebetter.com/blogs/jeremy.miller/archive/2007/05/23/build-your-own-cab-part-2-the-humble-dialog-box.aspx)

[构建您自己的 CAB 第 3 部分 - 监督控制器模式](http://codebetter.com/blogs/jeremy.miller/archive/2007/05/25/build-you-own-cab-part-3-the-supervising-controller-pattern.aspx)

[构建您自己的 CAB 第 4 部分 - 被动视图](http://codebetter.com/blogs/jeremy.miller/archive/2007/05/30/build-your-own-cab-part-4-the-passive-view.aspx)

[构建您自己的 CAB 第 5 部分 - 演示模型](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/03/build-your-own-cab-part-5-the-presentation-model.aspx)

[构建您自己的 CAB 第 6 部分 - 查看到演示者的通信](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/04/build-your-own-cab-part-6-view-to-presenter-communication.aspx)

[建立自己的 CAB - 回答一些问题](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/05/build-your-own-cab-answering-some-questions.aspx)

[构建您自己的 CAB 第 7 部分 - 模型是什么？](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/05/build-your-own-cab-part-7-what-s-the-model.aspx)

[构建您自己的 CAB 第 8 部分 - 在模型视图演示器架构中分配职责](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/10/build-your-own-cab-part-8-model-view-presenter-wrapup.aspx)

[构建您自己的 CAB 第 9 部分 - 使用通知模式进行以域为中心的验证](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/13/build-your-own-cab-part-9-domain-centric-validation-with-the-notification-pattern.aspx)

[构建您自己的 CAB 第 10 部分 - 使用 NUnitForms 对 UI 进行单元测试](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/26/build-your-own-cab-part-10-unit-testing-the-ui-with-nunitforms.aspx)

[构建您自己的 CAB 第 11 部分 - 事件聚合器](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/29/build-your-own-cab-11-event-aggregator.aspx)

[构建您自己的 CAB 第 12 部分 - 使用“Latch”控制失控事件](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/02/build-your-own-cab-12-rein-in-runaway-events-with-the-quot-latch-quot.aspx)

[构建您自己的 CAB 第 13 部分 - 带有 DSL 的嵌入式控制器](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/06/build-your-own-cab-13-embedded-controllers-with-a-dash-of-dsl.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T14:04:27.977

你试过[MVC#](http://www.mvcsharp.org)吗？我不久前开始使用它，但该项目被搁置了，所以我不能保证太多 - 抱歉！

**编辑：**我刚刚发现[这篇](http://www.c-sharpcorner.com/UploadFile/rmcochran/PassiveView01262008091652AM/PassiveView.aspx)文章看起来也不错。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T14:59:11.013

我们使用 MS 的 Smart Client Software Factory。它提供 IDE 集成、完整的 MVC 支持，一旦你理解了它背后的概念，它就是一个非常称职的实现。您可以从以下网址获取它：http: [//msdn.microsoft.com/en-us/library/aa480482.aspx](http://msdn.microsoft.com/en-us/library/aa480482.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T14:14:54.957

智能客户端软件工厂？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T14:16:35.093

我总是自己动手——这并不难，而且我越能“控制”我的代码库，我的感觉就越好。

我只是想知道 MVC 框架如何适应 CastleWindsor 之类的？

这可能不是最有帮助的答案，只是想知道您是否已经考虑过这个选项！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T19:59:52.383

我不喜欢 Prism、CAB 或 SmartClient 过于复杂，最终推出了我自己的实现。

随着时间的推移，一些常见的模式正在出现。这些被从一个应用程序重用到一个应用程序。这是一个示例：[Windows.Forms 中的 DDD 和规则驱动的 UI 验证与 MVC](http://abdullin.com/journal/2009/1/29/ddd-and-rule-driven-ui-validation-in-net.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T21:28:08.297

我正在插入我自己的框架：[TrueView for .NET](http://www.evolving-software.co.uk)。它基于 DDD 和 Naked Objects 模式。

至少，使用它来创建快速原型是从业务用户那里获得体面反馈的好方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T05:07:23.607

所有这些标准框架都不适合大型复杂的应用程序开发，它们假设显示是静态的。由于屏幕控件必须是动态的共同要求，我也开发了自己的，即使 MVC/MVP 模式也假设显示将是静态的，因此当控件中显示的字段取决于用户的角色时MVC/MVP 模式不适合。我开发了一个工具，您可以在其中构建屏幕，将业务对象及其属性加载到数据库中，然后用户只需选择她想要显示的对象和对象属性，控件可以由任意数量的控件组组成，每个控制组可以包含任何业务对象属性，业务对象是由我的 Linq ORM 从视图中生成的。因此，控件将仅显示用户有权访问的控件组的字段。您还可以使用面向方面的编程来为 MVC 模式提供规范，但是当显示必须根据角色动态显示时，这种开销可能会增加一些复杂性和性能成本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-23T08:03:18.943

除了 TrueView，还有[适用于 .NET 的 Naked Objects](http://nakedobjects.net)。这支持客户端/服务器模式，并且当前正在移植 Web 查看器（基于 Java 等效查看器）。

至于给定用户/角色可以使用哪些属性/操作，这是在 Naked Objects 中动态完成的。支持三种业务规则先决条件： 1\. 成员是否可见？2\. 会员可以使用吗？3\. 对成员（新的属性值或动作参数）的更改是否有效？或者，更简洁地说：你能看到它吗？你能用吗？你能做到吗？裸对象编程模型允许以声明方式和命令方式指定这些规则。

即使您最终将域模型包装在自己的 UI 层中，我还是建议您看一下 NO。

干杯

丹·海伍德

作者：“使用裸对象进行领域驱动设计”，pragprog.com

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-19T00:03:44.190

我已成功使用以下开源项目在 ASP.NET + WinForms + C# 中实现 MVP 模式：

*   城堡项目。

看看我的博客文章，它展示了一个完整的 ASP.NET Web 应用程序示例：

[在 ASP.NET 中使用 Castle 模型查看 Presenter 模式](http://www.leniel.net/2010/02/model-view-presenter-mvp-castle-asp-net.html)

# unit-testing - 对第三方软件 API (AutoCAD) 进行单元测试的最佳实践

> ID：536895
> 
> 赞同：11
> 
> 时间：2009-02-11T14:01:31.387
> 
> 标签：unit-testing, design-patterns, architecture, autocad

我们正在开发在 AutoCAD 中使用的应用程序。基本上，我们创建一个类库项目，并使用命令 (NETLOAD) 在 AutoCAD 中加载 .dll。

因此，我们可以使用命令、“调色板”、用户控件、表单等......

AutoDesk 通过一些 dll 提供 API，在它们的程序目录中运行。引用这些 dll 时，您只能在运行时调用 dll，同时在 AutoCAD 中加载您的应用程序（这是 AutoDesk 的许可安全）。

对我们来说，在开发的时候，这不是问题，我们需要在 AutoCAD 的上下文中进行可视化测试，所以我们只需设置 Debug Properties 以便它们启动 acad.exe 并在 acad.exe 参数中使用脚本加载我们的 dll .

问题是，当尝试对我们的代码进行单元测试时，NUnit 或 mstest 没有在 AutoCAD 上下文中运行，它们也无法启动它。有一个名为 Gallio 的工具，它提供了与 AutoCAD 的接口，因此它可以通过 IPC 和 Named Pipes 运行单元测试。

但是，对我来说，这个解决方案太麻烦了。我希望能够快速编写测试，而不必离开我心爱的 IDE。

那么，从“好的设计观点”来看，什么是解决这个问题的好方法呢？我想我基本上需要一个不引用 AutoCAD dll 的可测试代码库和一个引用不可测试 AutoCAD dll 的不可测试代码库。

我确信有办法让它发挥作用：（IOC、DI、适配器模式，..）我只是没有深入了解这些原则，因此我不知道哪条路线最适合我的目的和目标。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-11T14:25:17.320

第一步是对需要 AutoCAD 的部分和真正独立的部分的代码进行分类。像往常一样为独立部分创建单元测试。

对于其他部分，您需要行为类似于 AutoCAD 的模型。使它们尽可能简单（例如，只在方法中返回正确答案而不进行任何计算）。现在，您需要几组类：

1.  一组接口，您的代码用于实现某些目标（例如，加载绘图）。

2.  用于调用 AutoCAD dll 的所述一组接口的一组实现。

3.  一组在 AutoCAD 上下文中尝试实现的类。只需创建一个带有几个按钮的小型 UI，您可以在其中运行此代码。它用于向自己保证您的模型做正确的事情。将方法参数和结果记录到某个文件中，以便您可以尝试 AutoCAD 的响应方式。如果模型中断，您可以使用此代码来验证 AutoCAD 正在做什么，并且可以在开发模型时将其用作参考。

4.  当您知道 AutoCAD 如何响应时，创建模型。在您的测试中，使用所需的结果（和错误，以便您也可以测试错误处理）来创建它们。因此，当您拥有 时`boolean loadDrawing(File filename)`，请创建一个返回`true`文件名`exists.dxf`和`false`其他任何内容的模型。

5.  使用工厂或 DI 告诉您的应用程序代码使用哪个实现。我倾向于拥有一个大型的全局配置类，其中包含许多公共字段，我只是在其中存储要使用的对象。我可以在一开始就设置它，它很快，很容易理解。如果您需要在运行时创建对象，则将工厂放在为您生成对象的配置类中，这样您就可以将它们交换出去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-15T02:05:59.897

我写了......后来打破了...... AutoCAD的测试运行器。它位于[https://github.com/CADbloke/CADtest](https://github.com/CADbloke/CADtest)。如果您对它感兴趣，请轻推我，我会更快地修复它。在我解决它之前，我正在等待 NUnit v3 版本。

如果您重置到该仓库中的第三次提交（我认为）并从那里摆弄它应该运行。

# ruby-on-rails - ActionMailer 的多站点支持

> ID：536909
> 
> 赞同：0
> 
> 时间：2009-02-11T14:03:25.123
> 
> 标签：ruby-on-rails, ruby, actionmailer

存在允许基于不同站点的多个视图文件夹的多站点插件 ( [http://github.com/dasil003/rails-multisite/tree/master )。](http://github.com/dasil003/rails-multisite/tree/master)它特别允许您只覆盖站点中的某些视图，而其他视图保持不变（即其他视图不存在两次）。

ActionMailer 是否也存在类似的情况？设置`ActionMailer::Base.template_root`是不够的，因为它必须是一个字符串并且不允许一个数组（就像`ActionController::Base.view_paths`这样）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T08:21:21.860

自己做的：[multisite_action_mailer](http://github.com/msales/multisite_action_mailer/tree/master)

# c# - 如何从字符串为深层属性创建表达式树/lambda

> ID：536932
> 
> 赞同：11
> 
> 时间：2009-02-11T14:07:13.837
> 
> 标签：c#, lambda, expression-trees

给定一个字符串：“Person.Address.Postcode”我希望能够在 Person 的实例上获取/设置这个 postcode 属性。我怎样才能做到这一点？我的想法是用“。”分割字符串。然后遍历这些部分，寻找前一个类型的属性，然后构建一个看起来像这样的表达式树（为伪语法道歉）：

```
(person => person.Address) address => address.Postcode 
```

不过，我在创建表达式树时遇到了真正的麻烦！如果这是最好的方法，有人可以建议如何去做，还是有更简单的选择？

谢谢

安德鲁

```
public class Person
{
    public int Age { get; set; }
    public string Name { get; set; }
    public Address Address{ get; set; }

    public Person()
    {
        Address = new Address();
    }
}

public class Address 
{
    public string Postcode { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-11T15:01:33.957

听起来你是用正则反射排序的，但对于信息，为嵌套属性构建表达式的代码与[这个 order-by code](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/7d931ec0e2356d21)非常相似。

请注意，要设置一个值，您需要`GetSetMethod()`在属性上使用并调用它 - 没有用于在构造后分配值的内置表达式（尽管它[在 4.0 中受支持](http://marcgravell.blogspot.com/2008/11/future-expressions.html)）。

（编辑）像这样：

```
using System;
using System.Linq;
using System.Linq.Expressions;
using System.Reflection;
class Foo
{
    public Foo() { Bar = new Bar(); }
    public Bar Bar { get; private set; }
}
class Bar
{
    public string Name {get;set;}
}
static class Program
{
    static void Main()
    {
        Foo foo = new Foo();
        var setValue = BuildSet<Foo, string>("Bar.Name");
        var getValue = BuildGet<Foo, string>("Bar.Name");
        setValue(foo, "abc");
        Console.WriteLine(getValue(foo));        
    }
    static Action<T, TValue> BuildSet<T, TValue>(string property)
    {
        string[] props = property.Split('.');
        Type type = typeof(T);
        ParameterExpression arg = Expression.Parameter(type, "x");
        ParameterExpression valArg = Expression.Parameter(typeof(TValue), "val");
        Expression expr = arg;
        foreach (string prop in props.Take(props.Length - 1))
        {
            // use reflection (not ComponentModel) to mirror LINQ 
            PropertyInfo pi = type.GetProperty(prop);
            expr = Expression.Property(expr, pi);
            type = pi.PropertyType;
        }
        // final property set...
        PropertyInfo finalProp = type.GetProperty(props.Last());
        MethodInfo setter = finalProp.GetSetMethod();
        expr = Expression.Call(expr, setter, valArg);
        return Expression.Lambda<Action<T, TValue>>(expr, arg, valArg).Compile();        

    }
    static Func<T,TValue> BuildGet<T, TValue>(string property)
    {
        string[] props = property.Split('.');
        Type type = typeof(T);
        ParameterExpression arg = Expression.Parameter(type, "x");
        Expression expr = arg;
        foreach (string prop in props)
        {
            // use reflection (not ComponentModel) to mirror LINQ 
            PropertyInfo pi = type.GetProperty(prop);
            expr = Expression.Property(expr, pi);
            type = pi.PropertyType;
        }
        return Expression.Lambda<Func<T, TValue>>(expr, arg).Compile();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T14:16:35.313

为什么不使用递归？就像是：

```
setProperyValue(obj, propertyName, value)
{
  head, tail = propertyName.SplitByDotToHeadAndTail(); // Person.Address.Postcode => {head=Person, tail=Address.Postcode}
  if(tail.Length == 0)
    setPropertyValueUsingReflection(obj, head, value);
  else
    setPropertyValue(getPropertyValueUsingReflection(obj, head), tail, value); // recursion
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T13:02:14.493

[如果有人对简单反射方法（](https://stackoverflow.com/a/536964/188926)[这里](https://stackoverflow.com/a/4474015/188926)和[这里](https://stackoverflow.com/a/2692951/188926)也有很好的例子）和 Marc 的[表达式构建](https://stackoverflow.com/a/537189/188926)方法之间的性能权衡感兴趣......

我的测试涉及获得相对深度的属性 (ABCDE) 10,000 次。

1.  简单反射：64 ms
2.  表达构建：1684 毫秒

显然，这是一个非常具体的测试，我没有考虑优化或设置属性，但我认为 26 倍的性能命中是值得注意的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-17T21:10:37.290

您想查看通过 TypeConverter 或其他来源提供您自己的 PropertyDescriptor。

通过从 BindingSource 派生并通过那里提供信息，我已经完全实现了您对当前项目的描述（对不起，商业，否则我会分享）。

思路如下：

所有你需要做的是，一旦你有了类型，就是为属性的 getter 和 setter 创建小的“堆栈”，你可以通过首先遍历类型的属性树及其属性广度来收集这些堆栈，将深度限制为指定数量的级别并根据您的数据结构删除循环引用。

我在 Linq2SQL 对象中非常成功地使用了它，并结合了它们的绑定列表:)

* * *

## 回答 #5

> 赞同：-10
> 
> 时间：2009-07-06T07:40:15.163

表达式树

```
struct tree
{
    char info;
    struct tree *rchild;
    struct tree *lchild;
};

int prec(char data);

typedef struct tree * node;

char pop_op();
node pop_num();
void push_op(char item);

node create()
{
    return((node)malloc(sizeof(node)));
}

node num[20],root=NULL;
char op[20],oprt,ev[20];
int nt=-1,ot=-1,et=-1;

main()
{
    node newnode,item,temp;
    char str[50];
    int i,k,p,s,flag=0;
    printf("ENTER THE EXPRESSION ");
    scanf("%s",str);
    printf("\n%s",str);
    for(i=0;str[i]!='\0';i++)
    {
        if(isalnum(str[i]))
        {
            newnode=create();
            newnode->info=str[i];
            newnode->lchild=NULL;
            newnode->rchild=NULL;
            item=newnode;
            push_num(item);
        }
        else
        {
            if(ot!=-1)
                p=prec(op[ot]);
            else
                p=0;
            k=prec(str[i]);
            if(k==5)
            {
                while(k!=1)
                {
                    oprt=pop_op();
                    newnode=create();
                    newnode->info=oprt;
                    newnode->rchild=pop_num();
                    newnode->lchild=pop_num();
                    // if(root==NULL)
                    root=newnode;
                    // else if((newnode->rchild==root)||(newnode->lchild==root))
                    // root=newnode;
                    push_num(root);
                    k=prec(op[ot]);
                }
                oprt=pop_op();
            }
            else if(k==1)
                push_op(str[i]);
            else
            {
                if(k>p)
                    push_op(str[i]);
                else
                {
                    if(k<=p)
                    {
                        oprt=pop_op();
                        newnode=create();
                        newnode->rchild=pop_num();
                        newnode->lchild=pop_num();
                        if(root==NULL)
                        root=newnode;
                        else if((newnode->rchild==root)||(newnode->lchild==root))
                        root=newnode;
                        push_num(newnode);
                        push_op(str[i]);
                        // k=prec(op[ot]);
                    }
                }
            }
        }
    }
    printf("\nThe prefix expression is\n ");
    preorder(root);
    printf("\nThe infix exp is\n ");
    inorder(root);
    printf("\nThe postfix expression is\n ");
    postorder(root);
    evaluate();
}
void push_op(char item)
{
    op[++ot]=item;
}
push_num(node item)
{
    num[++nt]=item;
}
char pop_op()
{
    if(ot!=-1)
    return(op[ot--]);
    else
    return(0);
}
node pop_num()
{
    if(nt!=-1)
    return(num[nt--]);
    else
    return(NULL);
}
int prec(char data)
{
    switch(data)
    {
        case '(':return(1);
            break;
        case '+':
        case '-':return(2);
            break;
        case '*':
        case '/':return(3);
            break;
        case '^':return(4);
            break;
        case ')':return(5);
            break;
    }
}

inorder(node temp)
{
    if(temp!=NULL)
    {
        inorder(temp->lchild);
        printf("%c ",temp->info);
        inorder(temp->rchild);
    }
}

preorder(node temp)
{
    if(temp!=NULL)
    {
        printf("%c ",temp->info);
        preorder(temp->lchild);
        preorder(temp->rchild);
    }
}

postorder(node temp)
{
    if(temp!=NULL)
    {
        postorder(temp->lchild);
        postorder(temp->rchild);
        printf("%c ",temp->info);
        ev[++et]=temp->info;
    }
}
evaluate()
{
    int i,j=-1,a,b,ch[20];
    for(i=0;ev[i]!='\0';i++)
    {
        if(isalnum(ev[i]))
            ch[++j]=ev[i]-48;
        else
        {
            b=ch[j];
            a=ch[j-1];
            switch(ev[i])
            {
                case '+':ch[--j]=a+b;
                    break;
                case '-':ch[--j]=a-b;
                    break;
                case '*':ch[--j]=a*b;
                    break;
                case '/':ch[--j]=a/b;
                    break;
            }
        }
    }
    printf("\nValue = %d",ch[0]);
} 
```

# mdx - MDX 问题

> ID：536939
> 
> 赞同：0
> 
> 时间：2009-02-11T14:10:38.540
> 
> 标签：mdx

我正在使用 Analysis Services 2000 为一个 Web 应用程序开发一个多维数据集，用户可以在其中注册和取消注册到该站点。所以，“用户”表有这三个字段：

*   激活（1 或 0）
*   费查阿尔塔
*   费查巴哈

当用户激活他的帐户时，应用程序保存“fechaAlta”并将 1 放在“activo”字段中。当用户取消订阅他的帐户时，应用程序将“activo”字段更新为 0 并保存“fechaBaja”。

我需要的信息是通过时间维度了解一次有多少用户处于活动状态。就像是：

年 月 日 活跃用户

2009 年 1 月 1 日 10 日（本日激活 10 次）
2009 年 1 月 2 日 12 日（本日激活 3 次，**未注册 1**次）
2009 年 1 月 10 日 17 日（本日激活 5 次）

即使我在 2009 年 2 月查询，我也需要知道 1 月 1 日有 10 个活跃用户（必须计算 2 日退订的用户）。

我开发了一个多维数据集，其中事实表是用户表，并为两个日期字段（fechaAlta 和 fechaBaja）创建了两个维度。我还创建了这个计算字段：

按月激活：
计算子立方体：{[Measures].[Altas]}, [Fecha Alta].[Mes].MEMBERS
计算公式：sum({Descendants([Fecha Alta].currentmember,[Fecha Alta].[Día] )},[措施].[Activo])

当天活动：
计算子立方体：{[Measures].[Inscritos]},[Fecha Alta].MEMBERS
计算公式：sum({Periodstodate([Fecha Alta].[(Todos)])},[Measures].[Activo ])

我不知道如何仅从 fechaBaja 指示的那一天开始对未注册用户进行折扣。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T00:05:39.923

这是一个经典的渐变维度问题。您所描述的是类型 2 缓慢变化的维度，请参见[此处](http://en.wikipedia.org/wiki/Slowly_changing_dimension)

您需要确保您的用户维度具有代理键。然后，每次用户更改状态时，您都会在用户表中创建一条新记录，然后使用生效日期来控制要插入事实表的代理键。这将使您可以随时报告用户的有效状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T11:17:27.510

我认为您需要一个“用户状态”维度，然后您可以根据时间显示此维度，衡量标准是用户数。

# maintenance - 在维护期间保持系统的概念完整性

> ID：536944
> 
> 赞同：2
> 
> 时间：2009-02-11T14:11:43.483
> 
> 标签：maintenance, integrity

在开始一个新项目时，我们会根据“最新”和“已知”来启动它。

这包括选择编程语言、这些语言的框架等。在使用特定框架和设计模式等方面，相当多的时间花在架构设计和详细关卡设计上。

事情进展顺利，直到我们完成开发并将其推向生产。

然后是维护（缺陷修复和增强）。人变了，建筑师和设计师搬走了。

可能没有任何项目历史细节的新人现在正在维护它。他们开始包含架构、设计原则等方面的内容，以提供快速修复和添加增强功能。

我在我工作过的许多项目中都看到了这种趋势。

在进行维护的同时如何保持系统的“概念完整性”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T14:23:21.037

1.  从最小的改变开始。
2.  进入项目的风格。
3.  创造理智岛。
4.  每次提交都必须改进代码的状态。

请参阅[此出色的截屏视频](http://screencasts.lostechies.com/screencasts/rhouston/EliminatingStaticDependencies.htm)，了解可以在没有太多中断的情况下对遗留代码执行哪些操作。

当然，这需要管理层对代码质量第一战略的承诺，才能使这些修复“正确”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:30:08.367

保持概念的完整性是困难的。这是一个需要在架构、设计和施工过程中不断解决的问题，而且当项目易手时，情况只会变得更糟。

可以帮助的一件事是让原始开发团队的人员参与维护。与从头开始学习的人相比，已经了解项目概念框架的人将能够更好地遵守该框架。

不过，除此之外，这归结为**最佳实践**这个巨大的话题。几乎所有“好的”编程实践都旨在易于维护。良好的设计和施工实践导致项目更容易被后来的开发人员掌握。Steve McConnell 谈到管理复杂性是软件工作的核心要求。如果事先对复杂性进行了良好的管理，那么对于后来者来说，保持项目概念完整性的完整性会更容易。

另一方面，良好的维护实践涉及**对抗熵**。保持系统处于测试状态。不要为了快速修复或新功能而降低内聚或增加耦合。事实上，旨在使项目与所做的每一次更改都更加一致。

如果系统的设计考虑到了可扩展性，那么维护程序员在工作时保持概念完整性应该不难。即使不是，他们仍然应该可以在维护期间改进项目，而不是进一步降低项目。

如果维护开发人员只是简单地将事物组合在一起并以“简单”的方式做事，它总是会降低概念的完整性并增加项目的复杂性。开发人员必须意识到这一点，他们必须有意识地选择最能避免这种情况的做法。

主要思想是维护应该是一个不断改进项目的过程，而不是不断降低它。[Michael Feathers 的《有效地处理遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)》是一本涉及该主题的优秀书籍。你可能想检查一下。

# c# - 如何获取我们网页访客的IP号码

> ID：536955
> 
> 赞同：4
> 
> 时间：2009-02-11T14:14:49.997
> 
> 标签：c#, asp.net

我有网站（用 ASP.NET，c# 编码），我想显示其页面的基于 IP 的统计信息。我不想使用其他分析工具（如 Google Analytics）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T14:18:12.983

在您的 ASP.NET 页面中，您可以使用 Request.UserHostAddress 属性来获取用户的 IP 地址。

此外，您可以使用 IIS 日志（默认情况下在 C:\Windows\System32\LogFiles\W3SVCxxxxx....）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:21:42.367

```
HttpContext.Current.Request.UserHostAddress 
```

将用户的 IP 地址作为字符串返回。

# generics - 在 Scala 中创建参数图类型

> ID：536958
> 
> 赞同：5
> 
> 时间：2009-02-11T14:15:11.853
> 
> 标签：generics, scala, graph, types

我想创建一个通用类型层次结构来表示图形。特别是，我想要类 Graph 和 Node，并且我希望每个 Graph 类型都有一个相应的 Node 类型，如果我创建一个用于操作 Graph 的通用函数，我希望这个函数使用实际的 Node类型。我试过的一个例子

```
trait GNode[Graph]
{
 ... functions to get edges from this vertex, etc. ...
}

trait Graph
{
  type Node <: GNode[Graph]
}

def dfs[G <: Graph](g : G, nodeAction : G#Node => Unit) = ... code ... 
```

但这不起作用，因为当我这样做时

```
class ConcreteGraph extends Graph
{
  class Node extends GNode[ConcreteGraph] { ... }
} 
```

dfs 函数不接受 as 类型的函数`ConcreteGraph#Node=>Unit`，`nodeAction`而只接受`AnyRef=>Unit`or `GNode[ConcreteGraph]=>Unit`。

更清楚地说，如果我用 C++ 做，我会做类似的事情

```
template <class T> struct graph_traits;
template <> struct graph_traits<concrete_graph> 
{ typedef concrete_graph::node node_type; }

template <class G>
void dfs(const G& g, boost::function<void(
           const graph_traits<G>::node_type&)> action) { ... } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T15:35:29.193

可扩展图结构的一个很好的例子是 [http://www.scala-lang.org/node/124](http://www.scala-lang.org/node/124)

我有你写你的方法。请注意，在所有情况下都需要进行一些类型更改 - 即 GNode 的类型参数需要是协变的，并且 ConcreteGraph 需要使用不同的节点类和为 Node 绑定的类型来编写。

完成后，编写 dfs 的第一种方法是使其成为方法（如果您想避免虚拟调度开销，它可以是最终的）。

```
trait GNode[+Graph] {
//... functions to get edges from this vertex, etc. ...
}

trait Graph {
  type Node <: GNode[Graph]

  def dfs(nodeAction : Node => Unit) = print("dfsing!")
}

class ConcreteGraph extends Graph {
  class CGNode extends GNode[ConcreteGraph]
  type Node <: CGNode
}

new ConcreteGraph dfs {node => println("foo")} 
```

第二个， dfs 不是一种方法，似乎只需要一点额外的类型提示就可以使用它。

```
def dfs[G <: Graph](graph : G, nodeAction : G#Node => Unit) = print("dfsing!")

dfs[ConcreteGraph](new ConcreteGraph, {node => println("foo")}) 
```

第三种方法是使用咖喱 dfs。由于 Scala 的类型推断的工作方式，这实际上导致了更清晰的界面

```
def dfs[G <: Graph](graph : G)(nodeAction : G#Node => Unit) = print("dfsing!")

dfs(new ConcreteGraph){node => println("foo")} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T19:38:27.207

我不明白为什么所有这些参数都是必要的。Scala 中的内部类（与 Java 不同）具有依赖于外部对象特定实例的类型。尤其：

```
trait Graph {
  trait Node
  def dfs(n: Node) = println("DFSing!")
}

val graphA = new Graph {}
val nodeA = new graphA.Node {}
val graphB = new Graph {}
val nodeB = new graphB.Node {}
graphA.dfs(nodaA)  // prints "DFSing!"
graphB.dfs(nodeB)  // prints "DFSing!"
graphA.dfs(nodeB)  // type mismatch; found: graphB.Node required: graphA.Node
graphB.dfs(nodeA)  // type mismatch; found: graphA.node required: graphB.Node 
```

当然，如果你想依赖依赖类型，你不能在图形之外定义 dfs。

# performance - 当源代码不可用时，有什么好的分析工具可以使用？

> ID：536959
> 
> 赞同：0
> 
> 时间：2009-02-11T14:15:42.023
> 
> 标签：performance, profiling

我有一个大问题。我的老板对我说，他想要两个“神奇的黑匣子”： 1- 接收微处理器的东西，比如输入和返回，比如输出，MIPS 和/或 MFLOPS。2-接收交流代码的东西，例如输入和返回，例如输出，可以在性能方面表征代码的东西（例如uP必须在一段时间内执行代码所必需的MIPS）。

因此，我认为第一个“黑匣子”可能是 EEMBC 或 SPEC 的基准……不同的 uP，返回每个 uP 的 MIPS/MFLOPS 的相同基准。第一个问题是好的（我希望）

但是第二个……第二个黑匣子是我的噩梦……我发现的唯一事情是使用分析工具，但我问了一个特定的分析工具。有没有人知道一个分析工具，它可以像输入一样具有简单的 c 代码，并像输出一样给我我的 c 代码的性能特征（或调用某些汇编指令的时间）？

真正的问题是我们必须为特定的 c 代码选择正确的 uP……但我们想要为我们的 c 代码量身定制的 uP……所以如果我们知道 MIPS（以及 uP 的架构结构、内存结构…… ) 以及我们的代码需要什么

谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T14:27:33.787

不。如果有人制作了一个可以分析（非平凡的）源代码并告诉您其性能特征的工具，那将是常见的地方。即每个人都会使用它。

在针对特定目标架构编译源代码之前，您将无法确定其整体性能。例如，一个针对 n 个处理器的并行编译器可能能够将 O(n^2) 算法更改为 O(n) 之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:03:04.713

你不会找到一个工具来做你想做的事。

您唯一的选择是交叉编译代码并在您正在运行的体系结构的模拟器上对其进行分析。分析高级代码的问题是编译器进行了一系列非平凡的优化，您需要知道特定的编译器是如何做到的。

这听起来很愚蠢，但是为什么要让你的代码适合一个 uP 和一个 uP 适合你的代码呢？如果您正在编写信号处理，请购买 DSP。如果你正在构建一个 SCADA 盒子，那么看看 Atmel 或 ARM 的东西。您是否正在构建具有用户界面的通用设备？查看 PPC 或 X86 兼容的东西。

简而言之，选择一个适合并提供您需要的功能的血腥架构。选择处理器之前的优化是迟缓的（非常粗略地解释 Knuth）。

将架构固定在大致合适的位置，粗略计算出处理要求（您可以手动草拟一个估计，这在查看 C 代码时总是太高）并购买一个匹配的 uP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T19:30:10.337

我必须同意亚当的观点，尽管我会更亲切一点。编译器优化只在热点代码中很重要，即 a) 不调用函数和 b) 占用大量时间的紧密循环。

从积极的方面来说，这是我的建议：

*   在处理器上运行 C 代码，任何处理器。在该处理器上，找出最耗时的。

您可以为此使用分析器。我更喜欢的简单方法是在调试器下运行它并手动停止它，多次（如 10 次），每次都记下调用堆栈。我想代码中有些东西占用了很大一部分时间，比如 50%。如果是这样，您将看到它在大约该百分比的样本上执行该操作，因此您不必猜测它是什么。

*   如果某些特殊处理器可以帮助该活动，请尝试使用该处理器。

重要的是不要**猜测**。如果你说“我认为这需要一个 DSP 芯片”，或者“我认为它需要一个多核芯片”，那都是猜测。猜测可能是正确的，但可能不是。可能是您永远猜不到的最耗时的事情，例如内存管理或 I/O 格式化。性能问题非常善于向你隐瞒。

# wpf - 我可以在 ASP.net 2.0 或 sharepoint 中托管 WPF 控件吗？

> ID：536961
> 
> 赞同：1
> 
> 时间：2009-02-11T14:16:24.157
> 
> 标签：wpf, sharepoint, asp.net-2.0

这似乎是一个[高级别的](http://www.bugbash.net/comic/8.html)问题。但那是因为我不熟悉尖端的 ASP.net，更不熟悉这个名为 Sharepoint 的庞然大物。所以请多多包涵。。

*   首先，是否可以采用包含某些非托管子组件的功能性自定义 WPF 控件进行 DirectX 渲染（出于性能原因）并将其放入 ASP.Net 中？作为一个例子，考虑一个专门的图表控件
*   Sharepoint 是否添加了任何使这成为可能的东西？

用例是从厚 WPF 客户端获取某些窗格或区域，并将其插入现有的基于 Sharepoint 的解决方案中。

这是可能的还是它们（WPF 控件和 Web 控件）与粉笔和奶酪一样不同？（假设当前控件界面可以自由更改。）开发这些控件的 Web 感知精简版是否比尝试以某种方式敲击当前控件...

从根本上讲，网页是否可以包含一个控件来接管其客户区/矩形的呈现？还是在浏览器访问时所有内容都必须分解为纯 html。

我在网上找到了一些未回答的问题。但除此之外，它未经探索（或禁止）..在任何一种情况下，我都想知道。谢谢阅读..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T15:01:57.293

简短的回答是：是的，这是可能的，但您可能不想这样做。

Asp.Net，除了 java 脚本，主要是一种服务器端技术。这意味着大多数处理代码在服务器和客户端上运行。IIRC 共享点建立在 Asp.Net 之上，因此具有相同的格式。

WPF 是一种客户端技术。代码在实际的物理客户端计算机上运行。

由于它们的冲突性质，将这两种技术组合到一个应用程序中是行不通的。但是，您有多种选择。

1.  Silverlight：最容易将其视为 .Net 的闪存。它允许通过客户端计算机上的 Web 浏览器运行丰富的 WPF 应用程序。它是完整 .Net 框架的一个子集，但足够丰富，可以构建出色的应用程序。

    Silverlight 的局限性在于它必须是 100% 托管的解决方案。您使用我认为是本机代码的 DirectX 控件发布提及。如果是这种情况，Silverlight 将不适合您

2.  ActiveX 控件：这些控件基本上允许将任何形式的客户端代码托管在 Web 浏览器中并在客户端计算机上运行。这包括 .Net、WPF、C++ 等……如果您有本机组件，这确实是您唯一的选择。

    不幸的是，ActiveX 控件正在失宠。主要是由于他们不安全的性质。一旦你在你的机器上运行了一个 ActiveX 控件，你就会受到控件作者的摆布，并且很容易做出恶意行为。

    有关 ActiveX 控件的更多数据：[http ://en.wikipedia.org/wiki/ActiveX](http://en.wikipedia.org/wiki/ActiveX)

# sharepoint - SPFarm.Local.Solutions.Add - 异常 - “拒绝访问”

> ID：536965
> 
> 赞同：1
> 
> 时间：2009-02-11T14:16:37.700
> 
> 标签：sharepoint, sharepoint-2007

这是我的代码片段：

```
SPSecurity.RunWithElevatedPrivileges(delegate()
{
    SPSolution newSolution = SPFarm.Local.Solutions.Add(@fullPath);                            
}); 
```

stacktrace 和 innerexception 没有提供进一步的线索。Exception.Source 说**Microsoft.SharePoint**。

SPFarm.Local.CurrentUserIsAdministrator() 为用户 ID 返回 TRUE。

用户 ID 位于 Farm Administrators 组中。

有任何想法吗？

**编辑**

我已将代码更改为以下内容，但仍然收到拒绝访问错误：

```
private void AddSolution()
{
   SPSolution newSolution = SPFarm.Local.Solutions.Add(@fullPath);
}

SPSecurity.CodeToRunElevated elevatedAddSolution = new SPSecurity.CodeToRunElevated(AddSolution);
SPSecurity.RunWithElevatedPrivileges(elevatedAddSolution); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T14:25:25.417

您是否尝试在 RunWithElevatedPriviliges 调用之外声明委托？

***编辑：****忽略下面，因为您似乎已检查权限。*

RunWithElevatedPriviliges 将使用 SP 在其下运行的应用程序池的标识。您是否确保此帐户在您的环境中具有足够的权限？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:12:21.977

我确实相信您遇到的问题是由于您使用静态成员来访问 SPFarm 对象。我认为它类似于运行 SPcontext 静态类，它仍将在登录用户的安全上下文下运行，而不是在提升的权限上下文（即本地应用程序池标识）下运行。

在你的委托中试试这个：

```
SPFarm spFarm = SPWebService.AdministrationService.Farm;
SPSolution newSolution = spFarm.Solutions.Add(@fullPath); 
```

编辑：由于上述内容没有帮助，那么您的问题可能与配置数据库的数据库权限有关。RunWithElevatedPriviliges 将以运行代码的应用程序池的身份运行。向您的场添加解决方案会影响配置数据库，因此您的应用程序池身份将需要访问配置数据库。作为测试尝试将应用程序池身份添加到配置数据库并为其授予 dbo 权限。如果这样可以解决问题，那么您将需要找到每个应用程序池帐户添加解决方案所需的最低权限（不要保留为 dbo）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T05:03:05.397

您的主要问题可能只是您不是共享点数据库的 DBO（如果我没记错的话，_Config）。向场添加解决方案需要更多权限，而不仅仅是访问场。

确保运行此程序的用户是适当数据库的农场管理员和 DBO。

如果您仍然有问题...尝试运行

> stsadm -o 添加解决方案-文件名“myWsp.wsp”

如果你有正确的权利，它会给你正确的错误。

# xml - XSLT - 向外递归工作

> ID：536968
> 
> 赞同：3
> 
> 时间：2009-02-11T14:17:31.877
> 
> 标签：xml, xslt, recursion

我了解如何使用 XSLT 从最外层的*person*元素到最内层处理这个文档（如下）。但我想知道是否：

1.  如果有可能从最深的元素开始工作。
2.  以我的例子为例。

```
<?xml version="1.0" encoding="utf-8" ?>
<container>
  <person name="Larry">
    <person name="Moe">
      <person name="Curly">
        <person name="Shemp">

        </person>
      </person>
    </person>
  </person>
</container> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T14:20:13.913

您可以使用 parent:: 轴进行处理。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
      <xsl:apply-templates select="//person[not(person)]"/>
    </xsl:template>
  <xsl:template match="person">
    <xsl:value-of select="@name"/> -&gt; <xsl:apply-templates select="parent::person"/>
  </xsl:template>
</xsl:stylesheet> 
```

未经测试，我可能是语法错误。

它应该打印 Shemp -> Curly -> Moe -> Larry

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T00:06:24.190

**这是执行“向后递归”的最通用方法**，它不依赖于这个特定问题，可以用于各种各样的问题。

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="/">
      <xsl:call-template name="backwardsRecursion">
        <xsl:with-param name="pList" select="//person"/>
      </xsl:call-template>
    </xsl:template>

    <xsl:template name="backwardsRecursion">
      <xsl:param name="pList"/>

      <xsl:if test="$pList">
        <xsl:apply-templates select="$pList[last()]"/>

        <xsl:call-template name="backwardsRecursion">
          <xsl:with-param name="pList" select=
           "$pList[position() &lt; last()]"/>
        </xsl:call-template>
      </xsl:if>
    </xsl:template>

    <xsl:template match="person">
      <xsl:value-of select="concat(@name,'&#xA;')"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于最初提供的 XML 文档时，会产生想要的结果**：

```
Shemp
Curly
Moe
Larry 
```

**请注意**，调用了一个名为“backwardsRecursion”的通用模板，它真正实现了向后递归。**这个模板不知道它处理的节点，也不知道它们将如何被处理**。

因此，此模板**可用于需要反向递归处理的所有情况。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T14:59:27.207

**一个类似于 teun 的解决方案，但允许“人”元素不是直接的父子关系**，如下所示：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="/">
      <xsl:apply-templates select="//person[not(person)]"/>
    </xsl:template>

    <xsl:template match="person" name="tPerson">
       <xsl:value-of select="concat(@name,'&#xA;')"/>

       <xsl:apply-templates select=
          "ancestor::person[1]"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于最初提供的 XML 文档时，会产生正确的结果**：

麻

卷曲

萌

拉里

**很高兴知道这种类型的许多问题根本不需要递归！这种转换产生完全相同的结果，只涉及迭代**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="/">
       <xsl:for-each select="//person[not(person)]">
          <xsl:for-each select="ancestor::person | .">
            <xsl:sort select="position()" order="descending"/>
                <xsl:value-of select="concat(@name,'&#xA;')"/>
          </xsl:for-each>
       </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

**请注意**确保处理顺序相反的排序。

# java - 升级第三方 jar 时是否必须重新编译我的应用程序？

> ID：536971
> 
> 赞同：4
> 
> 时间：2009-02-11T14:18:11.330
> 
> 标签：java

我有一个使用第三方 API 的 java 应用程序。由于各种补丁，第三方 jar 文件的更改相当频繁，但 API 本身并不会经常更改。

每次第三方 jar 更改时，我是否必须重新编译我的应用程序？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-11T14:24:02.737

如果 API 发生更改，即使您不需要对源代码进行任何更改，也应该重新编译。如果 API 未更改，则无需重新编译。

“即使您不需要进行任何更改”的原因是某些源兼容的更改可能不是二进制兼容的。例如，假设您当前正在调用：

```
public void foo(String x) 
```

在以后的版本中，这更改为：

```
public void foo(Object x) 
```

显然你的代码仍然可以编译，但是它解析调用的方法会改变。

当然，这有点极端。基本上，只要您知道 API 何时更改，就应该没问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T14:32:17.800

理论上需要重新编译的另一种情况是常量。常量的值实际上被编译成使用它的类的字节码。如果在新版本的 API 中更改了该值，则针对旧版本编译的任何内容都将继续使用旧值，这可能会导致不同的行为并且很难诊断错误。

当然，任何有头脑的 API 设计者都不会在可以避免的情况下更改公共常量的值，但在某些情况下可能是必要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T14:20:30.387

不，您只需要重新编译您更改的代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T14:26:03.963

如果第三方设计良好，一般不会。

但是，在 API 更改方法签名或删除方法/类的（可怕的）情况下，您将需要修改和重新编译您自己的代码。

例如，如果您已经`doSomething(String value);`成为`doSomething(int value);`（或`String doSomething()`成为`int doSomething()`），那么调用 doSomething(...) 的应用程序代码将不再工作。因此需要修改您的代码（然后重新编译）。

但是，您必须知道这种情况极为罕见（例如，除非您使用的是 pre-alpha 依赖项）。通常，为了确保向后兼容性，API 从不删除类或方法。取而代之的是 @Deprecated 注释，以强制开发人员使用另一个方法/类...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T14:24:29.270

java 不是 C++：当您使用库时，您不会导入任何一行代码。您只需根据请求加载库并使用它。出于这个原因，您不需要重新编译您的代码:)

# .net - 如何*有效*地在程序集中定位特定类型？

> ID：536978
> 
> 赞同：5
> 
> 时间：2009-02-11T14:19:48.923
> 
> 标签：.net, reflection, assemblies, types

我正在寻找一种更有效的方法来查找从已知特定类型派生的程序集中的类型。基本上，我的应用程序中有一个插件架构，并且我们这样做的时间最长：

```
For Each t As Type In assem.GetTypes()
    If t.BaseType Is pluginType Then
        'Do Stuff here'
    End If
Next 
```

一些插件有很多类型，我们开始看到这需要几秒钟。有什么方法可以让我询问所有 BaseType 为“pluginType”的类型吗？

编辑：我过度简化了我的代码示例。我在实际代码中使用了 .GetExportedTypes() 。但是，我的很多课程都被标记为公开，所以它并没有太大帮助。我梳理了项目并将所有内容都标记为“朋友”，除了实际的插件类，检查程序集仍然需要几乎相同的时间。我将 1.3 秒的时间缩短了 100 毫秒（小于 10%）。这只是我必须处理的最短时间吗？我还尝试了 Assembly Attribute 建议，但仍然没有产生太大差异（可能又是 100 毫秒）。其余时间是我必须支付动态加载程序集的开销吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T14:28:02.007

首先，您可以尝试使用`GetExportedTypes()`来缩小潜在类型的列表。除此之外，您无法加快迭代过程。但是，您可以包含一个插件 mainfest，它将指定特定程序集中的插件的确切类型（类型）：

```
<manifest>
    <plugin type="FooBar.Plugins.BazPlugin, FooBar" />
</manifest> 
```

这样你就可以做到`Type.GetType(string)`

```
IPlugin plugin = (IPlugin)Type.GetType("manifest/plugin/@type" /* for the sake of this discussion */); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:27:52.727

Assembly.GetExportedTypes() 仅返回公共类。这有帮助吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-09T16:15:58.057

来自 Jonathan Pryor和[插件框架（第 1 部分）的](http://weblogs.asp.net/justin_rogers/articles/61042.aspx)[mono-devel 邮件列表帖子的](http://lists.ximian.com/pipermail/mono-devel-list/2009-December/033691.html)解决方案：标记消费类型：**使用程序集级属性**。

 **简而言之，您将添加一个新属性：

```
[AttributeUsage(AttributeTargets.Assembly, AllowMultiple=true)]
class PluginAttribute : Attribute {
  public PluginAttribute (Type type) {this.Type = type;}
  public Type Type {get; private set;}
} 
```

然后在程序集级别指定此属性：

```
[assembly:Plugin (typeof(Plugin1))]
[assembly:Plugin (typeof(Plugin2))] 
```

然后查询所有 PluginAttributes 的程序集：

```
Assembly a = ...;
PluginAttribute[] plugins =
    (PluginAttribute[]) a.GetCustomAttributes (
        typeof(PluginAttribute), true);
foreach (var plugin in plugins)
// plugin.Type is the type to use as a plugin 
```

这可能比使用`Assembly.GetTypes()`/快得多，因为实际上只需要加载属性`Assembly.GetExportedTypes()`中列出的类型，这可以显着减少内存消耗量（取决于程序集中的类型数量）。`[assembly:Plugin]`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-21T10:27:21.617

鉴于我对这个问题的评论，如果可以的话，在做其他事情的同时枚举另一个线程上的所有类型。[然后，根据我的测试](http://share.linqpad.net/k3ffxb.linq)，当您准备好枚举所需的类型时，它应该至少快两个数量级。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T14:53:08.283

我们的插件系统利用属性来识别插件类型。然后，我们只需扫描程序集以查找特定属性。

# actionscript-3 - TextField() 设置插入符号位置

> ID：536986
> 
> 赞同：8
> 
> 时间：2009-02-11T14:20:45.660
> 
> 标签：actionscript-3, apache-flex, flex3

如何设置插入符号的位置，只有

> this.caretIndex（阅读）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-11T14:23:50.520

采用`setSelection(beginIndex:int, endIndex:int):void`

例如

```
this.textField.setSelection(20, 20) 
```

# .net - Visual Studio 2005 和 .Net 框架 1.1

> ID：536992
> 
> 赞同：3
> 
> 时间：2009-02-11T14:23:10.383
> 
> 标签：.net, visual-studio, msbuild, visual-studio-2005, .net-1.1

是否可以使用 Visual Studio 2005 创建和维护 .Net framework 1.1 应用程序？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T14:36:14.780

实际上有一个 MSBuild 扩展允许这种情况。它被称为[MSBee](http://www.codeplex.com/Wiki/View.aspx?ProjectName=MSBee)，您可以在 CodePlex 上找到它。

> MSBuild Extras – .NET 1.1 工具包“MSBee”是 MSBuild 的一个补充，它允许开发人员使用面向 .NET 1.1 的 Visual Studio 2005 项目构建托管应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T14:24:25.933

没有 Visual Studio 2005 只允许您使用 .net 2.0 及更高版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T14:28:46.220

实际上，是的，你可以，但它并不漂亮，你仍然需要在机器上安装 .Net 1.1。您不能做的是使用 Visual Studio 编译或构建站点或打开解决方案文件。您必须从命令行构建它。您将获得参差不齐或不正确的智能感知支持。

但是您可以像使用任何其他文本编辑器一样使用它来创建您需要的源文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T14:27:18.390

没有 Visual Studio 2005 仅适用于 2.0 .Net Framework。如果要维护 1.1 应用程序，则需要使用 Visual Studio .Net 或 Visual Studio 2003。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-13T18:05:31.443

MSBuild Toolkit for .NET 1.1 “MSBee” 从 vs2005 编译到 net1.1 bot 仅在 webform 中，在 asp.net 中不起作用...

# c# - 不了解在系统架构中创建 IoC 容器的位置

> ID：536994
> 
> 赞同：11
> 
> 时间：2009-02-11T14:23:27.167
> 
> 标签：c#, architecture, ioc-container

假设我有以下 4 个 .net 程序集：

1.  Winform 用户界面
2.  商业逻辑
3.  SQL Server 数据访问（实现 IRepository）
4.  通用接口（IRepository 等的定义）

我的业务逻辑 (2) 通过使用构造函数依赖注入的 IRepository（在 4 中定义）调用数据访问层 (3)。但是，当我创建一个业务对象时，我需要传入一个实际的存储库。为此，我的业务逻辑层中有一个单例类返回当前正在使用的实现 IRepository 的具体对象。我得出的结论是，这是一件坏事，因为我的业务逻辑层现在必须引用 3 和 4。

我想我需要一个 IoC 容器，但问题是我在哪里创建/放置它，因为我似乎在哪里创建它（1 - UI）？还需要持有对 3（SQL Server 数据访问）的引用。我不只是在解决问题，而不是实现实际的脱钩吗？

我是否在 UI 中创建 IoC 容器。或者通过另一个新程序集公开它。

（我正在使用 C#、.net 3.5 和 AutoFac）

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T19:54:33.563

IoC 容器一般应在**宿主项目**（应用程序入口点）中创建。对于作为 exe 项目的 Windows.Forms 应用程序。

通常在简单的解决方案中（10 个项目以下），只有一个宿主项目应该有对 IoC 库的引用。

PS：[使用 Autofac IoC 构建 .NET 应用程序](http://abdullin.com/journal/2009/2/12/structuring-net-applications-with-autofac-ioc.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T14:44:22.280

注册组件时有几种可能性：

1.  注册码：

    *   直接
        问题：你必须引用一切（你在这里）
    *   间接
        问题：找出必须注册的内容
        解决方案：
        1.  使用属性
        2.  使用标记接口作为 IService
        3.  使用约定（参见 StructureMap）
2.  使用配置文件注册：

    *   让容器做一切
    *   自己阅读文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T20:25:16.373

顶级是一种方法（UI，正如 Rinat 所说）。

现在至于引用，最简单的方法就是检查当前文件夹中的所有程序集并使用一些约定来获取服务。属性可以正常工作，将注册器类放入每个程序集中都可以正常工作，无论适合您。提取所有内容的代码可能应该在单独的程序集中，除非您的 IoC 框架已经这样做了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T14:29:37.137

模块区别和模块定义的“范围”主要存在于编译时。在运行时，一切都是一团糟；）大多数 IOC 容器都在使用它，它们并不真正关心它们的位置。Web 应用程序的 IoC 容器通常会在最外层创建（非常接近 Web 容器本身）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T14:43:13.313

确实可以在任何地方创建它，但我会引入一个额外的层，我们称之为 3.5。

您当前的 3 将是您的 IoC 用于数据访问的位置 - 这将成为您实际 DAL 的包装器。根据您的配置，3 将创建一个模拟存储库或一个具体存储库。

所以 2 仍然引用 3，但它只是通过 IoC 框架配置的实际 DAL 的接口。

或者，您可以推出自己的“el-cheapo” IoC - 将 Big Ugly Singleton 更改为静态网关 -[在 Singleton 后面抽象 IoC 容器 - 做错了吗？](https://stackoverflow.com/questions/277438/abstracting-ioc-container-behind-a-singleton-doing-it-wrong)

# javascript - 创建 Javascript 日历（完整，不弹出）

> ID：536999
> 
> 赞同：5
> 
> 时间：2009-02-11T14:24:26.713
> 
> 标签：javascript, jquery, jquery-plugins, calendar

我在创建 javascript 约会样式日历时遇到了一些困难。虽然它会渲染，但我知道会有一种更有效的方式来实现它。有没有人有他们用来创建日历的模式？我将使用 jQuery，但我不想使用某人的日历插件，因为 a) 我还没有找到适合我需要的插件，并且 b) 我永远不会通过使用别人的工作而变得更好。

现在，请记住，我的问题不是关于加载数据或重复出现或类似的事情。我基本上需要知道实际呈现日历标记的良好模式。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T01:24:00.880

我刚刚发布了一个名为 FullCalendar ( [http://arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/) )的新操作系统项目

听起来像你可能想要的。将一组事件/约会传递给它，它将呈现。该插件仅提供必需品，但您可以使用事件挂钩来扩展它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T14:31:12.280

从[date.js](http://www.datejs.com/)库开始，为什么要重新发明诸如找出星期几的名称、闰年之类的东西。在它之上构建你自己的可视化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T14:32:19.283

从头开始开发日历控件有很多陷阱。由于您已经在使用 jQuery，我建议您自定义一个解决方案，例如[jCalendar](http://tedserbinski.com/jcalendar/index.html#demo)，并创建您自己的包装器，例如[这里描述的包装器](http://dotnetslackers.com/ASP_NET/re-62163_Implementing_a_jQuery_Calendar_ASP_NET_Control.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T14:32:32.137

我认为接受别人的工作是你最好的选择。为什么要重新发明轮子？您至少可以参与计算该年该月的日子，以及哪些日子是周末。我认为你不应该浪费时间试图弄清楚这一点。

我不得不这样做一次，尽管它只是一个模型实现，我使用了某人的工作，请参阅： [http://kpmm.doesthatevencompile.com/calendar.htm](http://kpmm.doesthatevencompile.com/calendar.htm?p=5.1.2.1) ?p=5.1.2.1 我添加了一些东西但不多。我认为日历呈现干净漂亮。

祝你好运

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T01:43:00.913

[日历是非常棘手的野兽，Javascript 的 Date() 对象还有很多不足之处，如果没有date.js](http://www.datejs.com/)，我什至不想尝试它。

您必须了解 JS Date() （作为用户当前的时区）与服务器日期/时间和 JS 的时代以及各种愚蠢的东西。

我过去写过日历，现在因为费力而不会这样做，但这是一次很好的学习经历。

如果您必须退回到其他人的日历，我建议您使用 jQuery UI 的 [http://jqueryui.com/demos/datepicker/](http://jqueryui.com/demos/datepicker/)********