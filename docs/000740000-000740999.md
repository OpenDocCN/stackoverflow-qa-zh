# StackOverflow 问答 000740000-000740999

# .net - 你会选择什么 ORM 来处理遗留数据库？

> ID：740006
> 
> 赞同：2
> 
> 时间：2009-04-11T12:39:13.713
> 
> 标签：.net, orm, legacy-database

我正在整合一些遗留系统。他们每个人都有不同的数据库；我需要为其中的大多数编写数据访问代码。

无法更改数据库模式（我可能可以应用一些索引等，但表及其列必须保留结构）。一些数据库设计良好，具有适当的关系和主/外键，而其他一些数据库则非常缺乏。

您会为此任务选择哪个 ORM？我想在整个项目中使用相同的 ORM；我的要求是：

*   能够在代码中重命名表或列；但在数据库中保留旧名称。
*   合理的代码生成
*   高效的 LINQ 支持（针对数据模型的 LINQ 查询应转换为高效的 SQL）。
*   生成的数据类最好是[POCO 的](http://en.wikipedia.org/wiki/Plain_Old_CLR_Object)。
*   最好支持不同的数据库引擎。

我目前对 LINQ-To-SQL 的经验最丰富；但我觉得这可能是这个项目的错误选择。我愿意花一些时间来学习一个新的框架。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T12:44:47.710

猜测一下，我认为 ORM 可能会给您带来比它节省的更多的麻烦。如果您有几个不同的遗留数据库，其中一些设计不佳，您可能会发现在较低级别构建数据访问层比 ORM 更容易。Fowler 的[企业应用程序架构模式在](https://rads.stackoverflow.com/amzn/click/com/0321127420)对构建数据访问层的各种方法进行分类方面做得非常好。

某些数据访问层可能适用于代码生成解决方案；但是，各种模式的存在（如您所说的有些混乱）表明，一刀切的方法可能不起作用，或者可能需要付出不成比例的努力才能使其与所有遗留数据库很好地配合使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T13:37:32.747

nHibernate 将是您最好的选择，它提供 POCO 支持，包括对我所知道的每个数据库的支持，并且 LINQ 支持绰绰有余。听起来您会想要生成映射文件，那里有用于 mygeneration 和 codesmith 的模板，可以帮助您做到这一点并避免大量的手动工作。（在初始生成之后，很容易调整和更改表名称、关系等，这在大多数基于生成的框架中要困难得多）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T12:43:54.313

LINQ to SQL 仅适用于 SQL Server。ADO.NET 实体框架适用于 ADO.NET 支持的任何数据库。

我在您的列表中看到的唯一未实现的是这些类不是 POCO。特别是，在 Web 服务中公开其中一个是一个坏主意，因为特定于实现的数据也将被序列化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T12:48:11.057

nHibernate 符合您的大部分要求。唯一的限制是 linq；但是，他们有一个由赞助商捐赠的全职开发人员，致力于添加对 linq 查询的支持。

它支持很多数据库引擎，它是免费的，可以使用 POCO 的。它有很多钩子可以使各种部件可扩展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T12:54:50.993

在我看来，最重要的因素是您是否计划实现域模型或将表直接映射到数据传输对象 (DTO)。如果您要对域进行建模，那么我绝对推荐 NHibernate。如果您打算使用 DTO，那么有很多不错的候选者，包括实体框架和数据表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T14:36:00.953

我猜你正在使用C#？

我想说也许可以试试 SubSonic，当数据库已经存在时，它是一个不错的选择，尤其是在处理存储过程和视图时。没有像 nHib 那样需要配置的 xml，您可以在几个小时内启动并运行它（或者如果您知道自己在做什么，则需要 20 分钟）。它也支持一些数据库。

我相信 Rob 和 Co. 现在正在添加 Linq 部分，因此它也可能在其中，但那将是我尚未尝试过的最新内容的一部分。

[http://subsonicproject.com/](http://subsonicproject.com/)

# sql - SQL 从多个表中删除

> ID：740013
> 
> 赞同：1
> 
> 时间：2009-04-11T12:43:35.887
> 
> 标签：sql, join

比如说，我有两个表 Courses 和 Faculty_courses - 每个表都有一个主键 course_ID，它是 varchar(50) 不为空。

我正在尝试从 Courses 表中删除一行 - 因此假设必须从两个表中删除该行，因为它们是通过关系链接的。

我写了这个 - 不起作用 - 关键字“JOIN”附近的语法不正确

从课程中删除加入 Faculty_courses ON Courses.course_ID = Faculty_courses.course_ID WHERE Faculty_courses.course_ID = 'ITM731'

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T12:49:08.963

你必须发表两个声明。

```
DELETE Courses where course_ID = 'ITM731'
DELETE faculty_courses WHERE course_ID = 'ITM731' 
```

或者，如此处所述，使用删除级联。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T12:49:40.430

您可以通过在表之间使用[ON DELETE CASCADE](http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqls.doc/sqls118.htm)链接来处理您想要的内容。前提是您的 RDBMS 允许这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T12:50:23.143

[您可以使用 CASCADE Delete](http://msdn.microsoft.com/en-us/library/ms188066(SQL.90).aspx)创建FK 参考

# 编辑

我建议您使用 Ocedecio 从两个表中显式删除而不是级联的方法。它使您的意图更加清晰。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T12:50:51.020

`DELETE`仅从一个表中删除记录 - JOIN 语法仅用于在该表上选择正确的行，例如，在具有 1:n 关系的表上（不是您在此处拥有的），并且您想从表中删除所有记录与“1”表上的可选记录有关的“n”表，那么你会这样做`DELETE FROM ntable INNER JOIN reftable ON ntable.ref = reftable.ref WHERE reftable.column = 'whatyouneedtolookup'`。

现在正如我所说，这与您当前的情况无关，在这种情况下，您只需要`DELETE`在同一个键上发出两个语句 - 每个表一个语句。

话虽这么说，听起来你在表之间有一个 1:1 的引用，这让我觉得很奇怪——通常使用这种引用，微不足道的规范化是将表合并到一个包含两个表中的列的表中。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-11-05T11:45:44.367

```
alter table tablename drop column columnname 
```

# c# - 页面重新加载时文件上传链接清除，为什么？

> ID：740022
> 
> 赞同：0
> 
> 时间：2009-04-11T12:47:49.060
> 
> 标签：c#, asp.net, html, vb.net, file-upload

我将 ASP.net(2.0) 与 VB.NET 一起使用。

我有一个用户注册表单。在该表单上，用户提供他所有的联系方式，他可以使用 ASP.net 中的正常文件上传控件上传图像。

**这是我的问题。**
如果页面上出现任何问题，我会给用户一条错误消息，说明他遗漏了什么或出了什么问题。但是当这种情况发生时页面会刷新。现在，指向用户选择的图像的链接消失了。现在，当用户修复他的错误时，他认为他正在上传图片，但他从未这样做过，因为当页面重新加载时，它删除了文件上传控件内指向他的图片的链接。

注意，用户不必上传图片，所以字段为空时不会出错。

有人知道我必须做什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-11T13:12:55.460

> 有人知道我必须做什么吗？

两种常用方法：

1.  添加客户端（JavaScript）表单验证，这样对于大多数人来说，在他们提交表单*之前*会弹出一个错误，而不是稍后在服务器端弹出错误，届时上传将丢失。

2.  给每个表单实例一个唯一的 ID。当文件上传到有错误的表单时，将该文件存储在服务器上，并在数据库中记录具有该 ID 的表单具有附件。在第二次机会表单中，将 ID 作为隐藏字段包含在内，并直观地表明上传的文件已被记住。提交时，拖出记住的文件并将其与新提交一起附加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T13:01:23.757

我认为你无能为力。在过去的几年中，浏览器已经锁定了文件表单字段，以防止路过上传。我将有一个单独的过程来上传照片。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T13:04:22.530

这种行为是设计使然。这是浏览器强加的安全限制，因此所有文件只能通过用户的明确操作从用户的计算机上传。

如果在表单提交过程中出现问题，您应该提示用户重新上传他/她的文件。这是正确的做法。将其视为交易（全有或全无）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-11T13:00:14.943

出于安全原因，没有人可以在 HTML 的文件字段中写入值。可以上传文件，然后报错，给用户一个取消上传的方法。编辑：这是 bobince 在另一个答案中更详细地描述的内容。

# c++ - 提升反序列化优化？

> ID：740026
> 
> 赞同：0
> 
> 时间：2009-04-11T12:49:48.837
> 
> 标签：c++, optimization, serialization, boost

我正在通过 Boost.Serialization 反序列化大量数据（每帧一个）。但是，当我输出反序列化需要多长时间时，它变化很大。目前它并不是非常慢，但让它更快会很好。数据表示相同的类、数组、映射和向量，但只是具有不同的值。

看着每次反序列化发生时的内存峰值，我必须相信有比不断分配和释放所有这些内存更好的方法。

以下是一些读取时间作为示例：

```
Deserialization - 390 milliseconds
Deserialization - 422 milliseconds
Deserialization - 422 milliseconds
Deserialization - 422 milliseconds
Deserialization - 438 milliseconds
Deserialization - 2156 milliseconds
Deserialization - 1797 milliseconds
Deserialization - 1656 milliseconds
Deserialization - 1328 milliseconds
Deserialization - 1219 milliseconds
Deserialization - 1078 milliseconds
Deserialization - 1078 milliseconds 
```

有没有一种方法可以为使用 Boost.Serialization 的相同数据编写自定义反序列化函数，以便我可以指定在开始时分配内存，然后只更改每帧的值？

更新：我意识到我使用的优化标志的一个小问题是导致序列化数据写入不正确，从而导致反序列化时间不一致。修复此问题后，它现在始终保持在每帧 750 - 780 毫秒。

但是，我最初的问题仍然存在，因为目前我正在序列化和反序列化整个 stl 容器，而我真的只想序列化内容（因为容器的大小和索引将保持完全相同）。不过，我不确定执行此操作的最佳方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T19:40:39.727

您可能需要重新考虑使用此序列化的功能设计。

从您的描述看来，您似乎非常频繁地序列化/反序列化整个 STL 容器。这不应该是必需的。除非数据需要持久化以便以后或由其他人重新构建，否则不应使用[序列化。](http://en.wikipedia.org/wiki/Serialization)

如果您的应用程序需要序列化，您可以考虑单独序列化容器中的每个项目，然后仅在项目更改时重新序列化。这样你就不会不必要地重新做所有的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T20:31:57.517

免责声明：我不使用 boost 序列化。

话虽这么说：这些问题的标准问题或多或少是您所描述的：对于任何单个序列化，您从操作系统请求几个（有时很多）内存块，然后释放它们，当您实际了解更多或少你需要多少内存开始。我知道的唯一解决方案是实现类似于 Apache“池”的东西：你分配一块内存并让你的分配器（你给 stl 或 boost）在这个池中工作；然后你有像 Pool::string 这样的类，它们在池内分配内存。两个警告：

*   是的，这不是很 c++ish，但你可以在它周围加上一个漂亮的信封（我工作的系统架构师做了这样的事情）。
*   是的，您必须处理需要分配另一个池的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T09:06:48.383

Boost 序列化为 STL 集合提供了一个模板化的保存方法，例如一个集合：

```
template<class Archive, class Key, class Compare, class Allocator >
inline void save(
    Archive & ar,
    const std::set<Key, Compare, Allocator> &t,
    const unsigned int /* file_version */
){
    boost::serialization::stl::save_collection<
        Archive, std::set<Key, Compare, Allocator> 
    >(ar, t);
} 
```

它只是委托给 save_collection。我想你可以为你的集合类型定义一个专业化，它以你选择的方式进行序列化，例如：

```
namespace boost {
namespace serialization {

template<class Archive>
inline void save<MyKey, MyCompare, MyAlloc> (
    Archive & ar,
    const std::set<MyKey, MyCompare, MyAlloc> &t,
    const unsigned int /* file_version */
){
    // ...
}

}
} 
```

您可以将 save_collection 实现的副本（来自 collections_save_imp.hpp）作为起点，并对其进行优化以满足您的要求。例如，使用一个类，它会记住上一次调用的集合大小，如果它没有改变，则重新使用相同的缓冲区。

您可能还需要针对您的会员类型进行专业化。在这一点上，您是否从 boost 序列化中获得任何价值是值得怀疑的。

我知道这有点含糊，但如果不知道您使用的是什么集合类型、成员类型是什么等，就很难更具体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T17:10:33.517

由于我看不到您的代码，我的第一个建议是使用分析工具来确定实际的瓶颈。

内存分配/释放很可能是核心问题，在这种情况下，池分配 - 假设您有固定大小的对象 - 正如大卫提到的那样。可能会有所帮助。

如果您将大量对象序列化为常规 ASCII 格式文件，则从 ASCII 到二进制的转换可能会消耗一些不小的时间。atoi() 的等价物可能很快，但是当您说“帧”时，我假设某种图片或网络缓冲区，它可能很大/很长。因此， atoi() 的开销一旦完成数百万次就可能很重要。

我也不明白您在内容和对象之间所做的区别。一般来说，集合在空间方面没有太多开销，在散列和树重新平衡方面可能有一些“时间”，但分析器也应该显示这一点。

简而言之，您认为缓慢的部分可能对整体性能的影响有限。配置文件并确定。

# c++ - 如何释放字符串的未使用容量

> ID：740030
> 
> 赞同：6
> 
> 时间：2009-04-11T12:51:16.680
> 
> 标签：c++, string, visual-c++, memory-management

我在我的程序中处理很多字符串。这些字符串数据在读入我的程序后的整个生命周期都不会改变。

但是由于 C++ 字符串保留了容量，因此它们浪费了大量无法确定使用的空间。我试图释放这些空间，但没有奏效。

以下是我尝试过的简单代码：

```
string temp = "1234567890123456";
string str;

cout << str.capacity() << endl;   

str.reserve(16);    
cout << str.capacity() << endl;     
// capacity is 31 on my computer    

str += temp;    
cout << str.capacity() << endl;    

str.reserve(16);    
cout << str.capacity() << endl;     
// can't release. The capacity is still 31. 
```

（编译器是Visual C++）

我怎么能释放它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-11T12:56:49.100

当您调用 时`reserve`，您正在*请求*更改容量。实现将仅保证保留等于或大于此数量的数字。**因此，特定实现可以安全地忽略*****缩减*****容量的请求。**

 *但是，我鼓励您考虑这是否不是过早的优化。你确定你真的制作了这么多的字符串，这对你来说是一个内存瓶颈吗？您确定实际上是内存是瓶颈吗？

从文档中`reserve`：

> 这可以扩大或缩小字符串中存储空间的大小，尽管请注意调用此函数后的结果容量不一定等于`res_arg` 但可以等于或大于`res_arg`，因此缩小请求可能会也可能不会产生特定库实现中分配空间的实际减少。在任何情况下，它都不会修剪字符串内容（为此，请参阅修改内容的调整大小或清除）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T12:55:32.147

那你为什么不使用 char 数组呢？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-11T15:41:32.310

拼出[Naveen 的答案](https://stackoverflow.com/questions/740030/how-to-release-the-unused-capacity-of-a-string/740056#740056)：

```
string x = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz";
cerr << x.capacity() << "\n";    // MSVC++: 63    g++: 52

// This tends not to work (although in theory it could):
//x = "XYZ";
//cerr << x.capacity() << "\n";  // MSVC++: 63    g++: 52

// This tends to work (although in theory it might not):
string("XYZ").swap(x);
cerr << x.capacity() << "\n";    // MSVC++: 15    g++: 3 
```

请注意，如果底层分配器在构造长度为*n*的 a 时分配了多于*n*个字节（例如，通过四舍五入到最接近的 32，如 MSVC++ 似乎所做*的那样），则无法使其使用更少的字节*。但是您可能无论如何都不想这样做，因为这种“四舍五入”是为了使动态内存分配过程更有效，并且还具有平均更快地连接短字符串的副作用（因为更少的重新分配需要发生）。`string`

 *** * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-14T04:21:31.843

尝试使用`std::string`交换技巧来缩小字符串：

```
std::string( str.data(), str.size() ).swap( str ) 
```

`str`您要缩小到大小的字符串在哪里。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-11T13:09:34.843

我认为您可以使用交换方法来释放数据。将其与空的本地字符串交换，以便当本地字符串超出范围时释放内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-11T19:37:04.663

这主要是特定于实现的。这个想法是最小化分配请求*和*内存碎片。很容易证明，通过每次扩展块时将现有大小加倍，分配计数和内存碎片都被最小化。因此，通常 STL 容器实现在扩展时会将现有块加倍。

您可以做的一件事是使用自定义分配器，该分配器不会分配超出必要的内容，接下来，当您不再需要操作它们时构造您的 std::string 对象（或者在完成操作后，只需换成新的 std::sting对象 - 这基本上是其他人在他们的答案中所做的）最后，您可以使用池化内存分配器来最大限度地减少内存碎片、浪费的 slack 并提高性能。

看：

[http://www.codeguru.com/cpp/cpp/cpp_mfc/stl/article.php/c4079](http://www.codeguru.com/cpp/cpp/cpp_mfc/stl/article.php/c4079) [http://www.sjbrown.co.uk/2004/05/01/pooled-allocators-for-the-stl /](http://www.sjbrown.co.uk/2004/05/01/pooled-allocators-for-the-stl/) [http://www.codeproject.com/KB/stl/blockallocator.aspx](http://www.codeproject.com/KB/stl/blockallocator.aspx)

搜索“STL 分配器”和“内存池”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-11T15:23:02.480

没有保证的最小容量`std::string`。您可以通过调用来请求所需的任何容量，`reserve`但特定实现仅保证将容量设置为大于或等于请求大小的某个量。

这是您的程序的修改版本，它测试了几种字符串收缩的方法：

```
#include <string>
#include <iostream>
using namespace ::std;

template< typename S >
S & reserve_request( S & s, typename S::size_type n ) {
    s.reserve( n ); return s;
}

template< typename S >
S & shrink_request1( S & s ) { s.reserve(); return s; }

template< typename S >
S & shrink_request2( S & s ) { S( s ).swap( s ); return s; }

template< typename S >
S & shrink_request3( S & s ) { S( s.c_str() ).swap( s ); return s; }

template< typename S >
void test( S & s ) { cout << s.capacity() << endl; }

int main() {
    string temp = "1234567890123456";    // length 16
    string str;

    test( str );                         // 15
    test( reserve_request( str, 16 ) );  // 31
    test( str += temp );                 // 31
    test( reserve_request( str, 16 ) );  // 31
    test( shrink_request1( str ) );      // 31
    test( shrink_request2( str ) );      // 31
    test( shrink_request3( str ) );      // 31
    return 0;
} 
```

看起来 Visual C++`std::string`通常会保留一些备用容量。

如果您的项目加载从外部源读取的大量字符串，其大小永远不会改变，您最好（正如其他人建议的那样）将它们存储在由字符分隔的单个大块字符内存中`'\0'`（即，作为 C-字符串）。`std::string`如果您愿意，您可以提供即时返回 s 的包装函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T22:44:46.587

dinkumware STL 的容量永远不会低于 15。std::basic_string 有一个联合，它是指向已分配缓冲区或 16 字节缓冲区的指针（如果 capacity()<=15）（对于 char 字符串）

查看 xstring 头文件

在您给出的示例中，您保留 16，您实际上是在保留 17（一个为空），大于 16，因此被分配而不是缓存在缓存指针联合中的 16 字节中。该分配使先前的大小（16）翻倍，因此您得到 32。该字符串的容量可能是 31。

但这取决于 STL 实现。

在 std::basic_string 的模板 decl 中更改分配器模板参数是不够的 - 何时分配和分配多少的选择在 std::basic_string 增长算法中而不在分配器中。以前大小的两倍（当 < 1/4 时缩小）是算法介绍中的标准内容 - Cormen Lieserson Rivest Stein

不确定 dinkumware 中的缩小算法.......

# shell - 如何检查文件中的制表符？

> ID：740037
> 
> 赞同：0
> 
> 时间：2009-04-11T12:56:37.933
> 
> 标签：shell, grep

我想检查一些文件中是否存在制表符（ASCII 0x09）。（在将它们提交到存储库之前断言我的源是无标签的。）

最好使用标准工具。当然，grep 浮现在脑海中，但显然`grep "\t" file.txt`不匹配......？！？

我知道答案可能非常简单，但我不知所措。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-11T13:02:57.183

> 当然，我会想到 grep，但显然 grep "\t" file.txt 不匹配......？！？

搜索文字字符`t`。要使用 搜索选项卡文字`grep`，您的 shell 通常会有一个文字插入方法。例如，在 中`bash`，使用`grep $'\t' foo.txt`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T13:03:13.487

尝试使用 $'\t' 而不是 \t

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T13:18:53.293

我不相信 grep 理解转义序列`\t`。尝试插入文字标签：

```
grep "<tab>" file.txt 
```

或者，您可以改用 awk。

# c# - C# WCF：WCF 服务在发送项目数组时返回 (404) 错误请求

> ID：740039
> 
> 赞同：3
> 
> 时间：2009-04-11T12:58:33.560
> 
> 标签：c#, wcf, wcf-binding

我正在尝试将大约 50 个元素的数组发送到 WCF 服务方法，但我总是收到`(404) Bad Request`错误消息。

我认为这与消息大小或类似的东西有关，因为如果我发送一个空数组，它就可以工作。

我做了一些研究并在 WCF 的 web.config 中添加了一些东西，但我仍然无法让它工作。

任何人都可以提供一些关于如何**增加我可以发送的消息大小的**额外信息吗？

* * *

**[更新]解决方案：**

[解决方案](https://stackoverflow.com/questions/740039/c-wcf-wcf-service-returning-a-404-bad-request-when-sending-an-array-of-items/740087#740087)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T13:30:19.927

愚蠢，愚蠢的我:(

问题是我在 web.config 中创建了绑定配置，如下所示：

```
<bindings>
    <wsHttpBinding>
        <binding name="netTcpBindingConfig" closeTimeout="00:10:00" openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00" transactionFlow="false" hostNameComparisonMode="StrongWildcard"  maxBufferPoolSize="524288" maxReceivedMessageSize="6000000">
            <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="6000000" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
        </binding>
    </wsHttpBinding>
</bindings> 
```

但是后来我没有将配置应用到端点！所以，我不得不将它添加到端点标签：

```
bindingConfiguration="netTcpBindingConfig" 
```

现在它就像一个魅力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T13:06:38.190

这很明显，但是您是否尝试将[MaxReceivedMessageSize](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.transportbindingelement.maxreceivedmessagesize.aspx)设置为 65536 并查看它是否仍然失败？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T13:06:55.537

您的服务主机应配置为接收大量数据，如果没有，则将其丢弃在服务级别。

*   添加对 System.Runtime.Serialization 的引用。
*   创建绑定时设置消息大小：

    ```
     return new NetTcpBinding(SecurityMode.None, true)  
    {  
        MaxReceivedMessageSize = 99999999,  
        ReaderQuotas = { MaxArrayLength = 99999999 }  
    }; 

    ```

# svn - 为什么我应该使用 git 而不是 svn？

> ID：740053
> 
> 赞同：33
> 
> 时间：2009-04-11T13:07:59.807
> 
> 标签：svn, git, version-control

我曾经使用 Visual Studio + C#，并且之前一直在使用 svn，但目前还没有，所以我想再次将我的代码放在源代码的控制之下。

最近我听说了 git，我一直在阅读 git wiki 和[this](http://git.or.cz/gitwiki/GitSvnComparsion)和[this](http://myxman.org/dp/node/165)，并且我读到没有像 TortoiseSvn 这样的 git gui 客户端，或者至少，我还没有找到它们。

我的问题是：

*   git比svn有什么优势
*   我在哪里可以找到易于使用 git 的前端。
*   是否有任何用于 git 与 Visual Studio 一起使用的插件（类似 ANKH）？
*   我还能在哪里找到从 git 开始的资源？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-11T13:29:25.280

这是我个人使用 git 与 svn 的经验：

*   **Git vs. SVN：** git 跟踪源代码树的状态、历史和完整性。SVN 只跟踪状态。

特别是在合并时，git 广泛使用存储历史（跨重命名和合并）可以方便地做出更明智的决策，从而减少冲突。

通过存储库拥有完整的、可加密验证的完整性链有助于建立对底层系统的信任，或检测它们何时失败。不利的一面是，创建“干净”的补丁可能很复杂。拥有适当的工作流程会有所帮助。

最后，git 默认在本地工作，与 SVN 相比，它具有令人难以置信的巨大提升，SVN 几乎任何操作都必须转到中央存储库。

*   **软件：**见[这个问题](https://stackoverflow.com/questions/32383/is-there-anything-like-tortoisecvs-and-tortoisesvn-for-git)，有几个独立的 GUI 用于处理 repo、历史浏览器和 shell 扩展。

*   **Studio 插件：** [GitExtensions](http://sourceforge.net/projects/gitextensions/)有一个 Visual Studio 2005 和 2008 插件。

*   **文档：**从[GIT 用户手册](http://www.kernel.org/pub/software/scm/git/docs/user-manual.html)开始。[git-scm.com](http://git-scm.com/documentation)上有更多教程和书籍的链接。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-11T13:12:58.470

关于类似于乌龟的 GIT 工具有一个相关的[问题。](https://stackoverflow.com/questions/32383/is-there-anything-like-tortoisecvs-and-tortoisesvn-for-git)

GIT 相对于 SVN 的优势已被反复讨论[，](http://git.or.cz/gitwiki/GitSvnComparsion)[因此](http://markmcb.com/2008/10/18/3-reasons-to-switch-to-git-from-subversion/)这里不应该详细说明

至于 Visual Studio 插件，我不认为有，或者在相当长的一段时间内都会有。也许我在这里遗漏了一些东西。

[在此处](http://kylecordes.com/2008/04/30/git-windows-go/)尝试获取有关如何在 Windows 中开始使用 git 的良好指南

*至于我完全个人的品味和观点，我继续坚持使用 svn，基于我对版本控制的个人要求，我认为 svn 处于完全不同级别的工具和社区支持中。另外我认为 svn 非常成熟，这并不一定意味着 git 不能完成工作。*

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-11T13:26:11.013

我不想讨论 git 与 svn 的优缺点，但这里有一组简单的比较：-[为什么 Git 比 X 更好](https://web.archive.org/web/20120423073434/http://whygitisbetterthanx.com/#git-is-small)。

一些好的 Git 资源：

1.  [Git 准备好了](http://gitready.com/)。一种关于 git 的初级、中级和高级使用的博客。
2.  [吉特魔术](http://www-cs-students.stanford.edu/~blynn/gitmagic/book.html)。一个很好的运行你可以做什么。
3.  [GitCasts 截屏视频](http://gitcasts.com/)- 没有什么比亲眼目睹它更能帮助您了解它的力量了。包括有用的[Git On Windows](http://gitcasts.com/posts/git-on-windows)截屏视频。

玩得开心！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-11T13:15:49.117

TortoiseGit 可用 - 只需谷歌它（我不记得 URL）并且：

*   由于是分布式的，您不需要一直连接到服务器，只需在`push`需要时在本地工作即可。

*   它非常快并且不使用太多带宽

*   而且，经典的，如果它对 Linus 来说足够好，它对你来说就足够好了 :)

更新：[链接到 TortoiseGit](http://code.google.com/p/tortoisegit/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-01-02T14:52:16.340

> git比svn有什么优势

在决定是使用 Git 还是 SVN 之前，请确保您完全了解您的需求并了解 Git 和 SVN 提供和支持的内容。不幸的是，就我最近在[http://svnvsgit.com/](http://svnvsgit.com/)发现的那样，Git 和 SVN 主题存在很多不公平的偏见。

让我在这里引用一位回答者（@Konstantinos）：

> GIT 相对于 SVN 的优势已被反复讨论，因此这里不应该详细说明

这个问题是近 7 年前提出的。但至少这个话题仍然有点热或温暖。我最近偶然发现了[http://svnvsgit.com](http://svnvsgit.com)页面，我有点沮丧地发现，实际上互联网上大多数 Git 和 SVN 比较和测试都是基于一些奇怪的信息，比如关于 Mozilla 存储库的信息在 SVN 中非常大。这根本不是真的，[http://git.or.cz/gitwiki/GitSvnComparsion](http://git.or.cz/gitwiki/GitSvnComparsion)中描述的大多数观点都是不公平或错误的。

或者这里是@DavidSchmitt 的引述（其中一位回答者）：

> Git vs. SVN：git 跟踪源代码树的状态、历史和完整性。SVN 只跟踪状态。

SVN 和 Git 都确保数据完整性（SVN 在 IMO 方面做得更好）。跟踪历史和状态。

SVN 和 Git 之间唯一真正的区别是 Subversion 是中心化的，而 Git 是去中心化的。Subversion 支持 Git 在设计上无法支持的一些概念、工作流程和案例。同时，Git 的不连贯性对某些人来说可能是一大好处。

做出明智的选择！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-11T13:18:04.387

我没用过git，但是我用过svn和bazaar（在哲学上和git差不多），所以我可以笼统的回答你。

所谓的分布式版本控制系统 (DVCS) 的优点是 repo 和代码一起在您的机器上，并且您不依赖远程 repo 进行操作。每个开发人员都有一个“分支”，即他自己提交的 repo 副本。您可以提交、还原、检查以前的版本，而无需连接到网络。存储库的官方性是通过人工协议授予的，而不是技术设置。在 svn 中，你只有一个 repo，即 _the_repo_ 你和所有其他人都承诺。在 DVCS 中，你提交自己的 repo，另一个开发者提交他自己的 repo，你们每个人都可以根据自己的喜好将他的修改推送到官方设计的 repo。

另一个明显的优势是 DVCS 中的操作速度非常快，非常快。当你开始在你的仓库中有很多东西时，svn 变得非常慢。这很快就会变得烦人。

不利的一面是，DVCS 更难使用，但如果您愿意，可以将 DVCS 用作集中式 VCS。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-11T15:02:32.543

我不确定现阶段 TortoiseGIT 的稳定性如何，当您谈论与 Explorer 紧密集成的东西时，这是一个重要的考虑因素。任何人都可以谈论这个吗？

还要记住，如果您正在寻找分布式 VCS 的好处，git 并不是唯一的选择。Git 具有非常强大和非常复杂的双重优点。[您可能会发现Bazaar](http://bazaar-vcs.org/)或[Mercurial](http://www.selenic.com/mercurial/)等其他 DVCS更容易过渡，从而获得分布式系统的好处。两者都有[乌龟](http://bazaar-vcs.org/TortoiseBzr) [接口](http://bitbucket.org/tortoisehg/stable/wiki/Home)在开发中，但同样，我不确定它们的稳定性。（不过，Bazaar 包含在他们的 windows 包中，所以你会认为它处于相当好的阶段。）

快速搜索也出现了[VisualHg](http://sharesource.org/project/visualhg/)和[Bzr-VisualStudio](http://bazaar-vcs.org/VisualStudioIntegration) ，尽管我不知道它们是否准备好在愤怒中使用。买者自负。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-21T21:09:13.710

Git 现在似乎是版本控制的行业标准，取代了 SVN 和 CVS 等。从用户的角度来看，Git 产生了更多的功能，并有助于比 SVN 更好地管理代码更改。[借助GitHub](https://github.com/)和[BitBucket](https://bitbucket.org/)等网站，设置存储库也更容易，而不需要您自己的服务器。

Git 很容易在命令行中运行（helfpul 命令比 SVN 多得多）。[还有一系列优秀的 GUI 程序有助于为您的 Git 存储库、 GitHub Desktop](https://desktop.github.com/)和[SourceTree](https://www.sourcetreeapp.com/)提供一个很好的前端，仅举几例。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-02T15:47:59.043

正如其他人指出的那样，git 更快、更稳定。它是分布式与集中式的，在 svn 中，如果你把中央仓库弄乱了，你就会失去一切。以我的经验，将代码与 git 合并时问题较少。

我不喜欢的只有一件事。这是您无法使用 git 下载存储库的一部分。如果您只需要一个文件夹，则需要下载所有 repo。你可以用 svn 做到这一点。

# .net - 使用 LINQ 从 Sql 加载完整图

> ID：740063
> 
> 赞同：1
> 
> 时间：2009-04-11T13:15:13.487
> 
> 标签：.net, linq-to-sql, eager-loading

假设我们有一个 Menu 类，它具有 SubMenus（这是相同类型的 Menu，因此也可以有 SubMenus 和 Items）和 Items（具有不同类型），我们将它们存储在两个表中（一个用于 Menus，一个用于 Items） . 有没有办法使用 LINQ to SQL 加载菜单类的完整图形（所有子菜单和项目）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T13:23:39.037

如果您在 SQL 中正确定义了关系，LINQToSQL 应该通过对菜单的单个查询为您返回所有菜单/项目。但是，这不会让它重新用作图形，而是用作菜单的枚举（带有相关的菜单和项目）。您需要遍历此枚举并自行构建图形。

另一方面，您可能可以执行以下操作：

```
var roots = db.Menus.Where( m => !m.SubMenus.Count == 0 ); 
```

然后，`roots`将是基本菜单的集合。如果您不打算对其执行任何图形分析算法，而只是打算从上到下遍历它以构造 GUI 组件，这可能就足够了。

# .net - 在 .NET 中更新线程上的计数器

> ID：740066
> 
> 赞同：0
> 
> 时间：2009-04-11T13:17:24.527
> 
> 标签：.net, multithreading

我正在编写一个执行一些基本线程的服务器程序。它需要更新一些 UI 控件，并且我学习了如何使用委托以使一切都是线程安全的。例如，这是我的委托，它允许我从线程更新 TextBox 控件：

```
Private Delegate Sub AddMessageToTXTDelegate(ByVal lst As TextBox, ByVal str1 As String)
Private Sub AddMessageToTXT(ByVal txt As TextBox, ByVal str1 As String)
    Try
        If Me.InvokeRequired Then
            Dim addTXT As New AddMessageToTXTDelegate(AddressOf AddMessageToTXT)
            Me.BeginInvoke(addTXT, New Object() {txt, str1})
        Else
            txt.Text = str1
        End If
    Catch ex As Exception
        Console.WriteLine(ex.Message)
        Throw (ex)
    End Try
End Sub 
```

现在我需要更新一个计数器，我认为同样的模式会适用。我整理了以下代表：

```
Private Delegate Sub IncrementCounterDelegate(ByVal ctr As Integer)
Private Sub IncrementCounter(ByVal ctr As Integer)
    Try
        If Me.InvokeRequired Then
            Dim incCtr As New IncrementCounterDelegate(AddressOf IncrementCounter)
            Me.BeginInvoke(incCtr, New Object() {ctr})
        Else
            ctr += 1
        End If
    Catch ex As Exception
        Console.WriteLine(ex.Message)
        Throw (ex)
    End Try
End Sub 
```

问题是我的计数器没有增加。当我用调试跟踪它时，“ctr += 1”语句被执行，但实际计数器保持为零。我想我应该通过引用传递计数器。

有人可以在这里提供一些建议吗？谢谢！

\cbf

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T13:23:22.783

[使用System.Threading.Interlocked.Increment](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.increment.aspx)可以实现增加整数的线程安全方法。您应该使用它并避免使用委托。

# 编辑

我不确定您为什么要尝试使用代表。您增加一个可以在任何线程上完成的值对象。您只是无法从其他线程更新 UI 控件。

如果您试图使这个线程安全，那么您需要使用监视器（作为一个示例）或使用 Interlocked 的 Increment 方法来引入锁定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T13:28:33.673

您正在按值传递计数器，因此`ctr += 1`递增函数的参数。您需要通过引用传递计数器，或者只是增加一个私有字段`InterlockedIncrement`——不需要委托或调用。

# c# - 一个通用事件名称或多个描述性事件名称

> ID：740074
> 
> 赞同：3
> 
> 时间：2009-04-11T13:20:52.290
> 
> 标签：c#

你会怎么做：

```
this.btSomeButton.Click += btSomeButton_OnClick;

private void btSomeButton_OnClick(object sender, EventArgs e)
{
    this.DoFunc1();
    this.DoFunc2();
} 
```

或者：

```
this.btSomeButton.Click += DoFunc1;
this.btSomeButton.Click += DoDunc2; 
```

使用第二种方法有什么隐藏的含义吗？比如，是否保证 DoFunc2() 将在 DoFunc1() 之后运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T13:23:02.457

我认为第一种方法更安全。

AFAIK 无法保证方法执行顺序，如果方法确实按顺序出现，那么第一种方法更有意义。

此外，当多个事件处理程序附加到一个事件时，在分离单个事件处理程序时很容易错过其他事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T13:35:44.233

我也要做第一个。。

在 2 个示例中，性能应该非常接近，但 #1 更容易阅读恕我直言 - 但是，它有点取决于他们在做什么。例如，我更喜欢这个：

```
this.btSomeButton.Click += DoSomethingRelatedToDataPersistence;
this.btSomeButton.Click += DoSomethingRelatedToTheDirectionTheMoonSpinsAroundTheEarth; 
```

..我希望你能明白我的意思：P

如果您可以将 2 个事件处理程序绑定到 1 个通用程序中（从域的角度来看），我会这样做。如果处理程序完全不相关，我会将它们保存在不同的处理程序中。

答案是非常主观的恕我直言。没有人能够提供“最终答案，案例已结束”——有点答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T14:16:53.747

如果只是因为它是传统做法，我会使用第一个，对其他开发人员来说更清楚。事件处理程序的杂耍在任何情况下都很难追踪，因此请尽可能多地帮助每个人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T20:03:26.300

依靠。

如果以下所有（或大多数）为真，我将使用第二个选项：

*   DoFunc1 和 DoFunc2 在功能上是完全独立的。
*   调用顺序无关紧要（即使在异常情况下等）。
*   DoFunc1 和 DoFunc2 在接收标准事件参数时没有签名问题。
*   DoFunc1 和 DoFunc2 不是设计上下文中的原始函数。
*   源代码的不同区域可能决定需要多少订阅者。
*   DoFunc1 和 DoFunc2 是需要解耦的其他类的一部分。
*   我想在订阅或取消订阅 DoFunc1 和 DoFunc2 时进行自定义处理。

如果顺序很重要，那么第一选择是必须的，因为它很清楚。我不知道 C# 语言规范是否保证第二个选项的顺序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T20:18:19.587

啊，现在我明白了。这是一个关于[Multicast Delegates](http://msdn.microsoft.com/en-us/library/system.multicastdelegate.aspx)的问题。根据文档...

*MulticastDelegate 有一个委托的链接列表，称为调用列表，由一个或多个元素组成。当调用多播委托时，调用列表中的委托会按照它们出现的顺序被同步调用。*

但是，如果您关心调用的顺序，我不会依赖这个，我会使用第一种方法或下面的方法。

如果你喜欢语法，你可以两者都做，但想要两个调用的功能抽象......

```
this.btSomeButton.Click += (sender, args)
{
  this.doFunc1();
  this.doFunc2();
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T20:49:35.207

出于单一（主观）原因，我更喜欢第一种选择。

这更具描述性，并且其他人以后更容易理解。如果该事件是人们稍后需要取消订阅的事件，这一点就变得很重要 - 与 2 个事件相比，未来有一个需要取消订阅的事件更有可能被其他人正确处理。

Since you asked about order of execution, this suggests that the 2 functions are related. Doing this forces the event to be unsubscribed together, so it wouldn't be possibel to unsubscribe from func1() and not func2(), which is likely very critical if you're worried about order of execution (which, btw, is guaranteed).

# mercurial - 水银“服务器”

> ID：740075
> 
> 赞同：74
> 
> 时间：2009-04-11T13:21:54.690
> 
> 标签：mercurial, version-control

我一直在使用 Mercurial 一段时间，但主要是为了我自己的使用。不过，现在我有一个项目，我们两个人正在构建同一个项目，我们可能会修改彼此的文件。

我想在服务器上设置一个 Mercurial 存储库，使该存储库成为“服务器”，因此我的更改和其他编辑器的更改都推送到该服务器（基本上是[Subversion](http://en.wikipedia.org/wiki/Apache_Subversion) / [CVS](http://en.wikipedia.org/wiki/Concurrent_Versions_System)模型）；虽然我喜欢 Mercurial，但不想切换到 Subversion 之类的东西。

在我自己的网络中，一切都在 Linux 上完成，我的“服务器”安装了[OpenSSH](http://en.wikipedia.org/wiki/OpenSSH)。因此，将我的更改（我在多台计算机上工作）从一台计算机推送到服务器只是“hg push”的问题；用于传输更改的协议是[SSH 。](http://en.wikipedia.org/wiki/Secure_Shell)

问题是我使用 Linux，服务器将是 Windows（所以没有 OpenSSH，对吗？），另一个编辑器也将使用 Windows。据我所知，在 Mercurial 中在这些类型的设置中工作的最佳方式是让存储库从源中提取更改，而不是将源推送到“服务器”。我在几个防火墙后面（不完全是我的网络），我的计算机从服务器上看不到，我假设另一个编辑器也在防火墙后面（所以我们不能只启动本地 Mercurial HTTP 服务器并让“服务器”计算机从中提取）。

对于两位编辑来说，让我们对服务器存储库进行更改的最佳方式是什么？（我应该补充一点，该服务器是 Internet 上的服务器，因此它与类似 的东西一样可见`google.com`。它是一个托管的 Windows 服务器，但如果需要，我可能有权安装软件。）

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-04-11T14:03:53.980

我相信阅读该项目的文档是一个不错的开始：[https](https://www.mercurial-scm.org/wiki/PublishingRepositories) ://www.mercurial-scm.org/wiki/PublishingRepositories 。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-22T17:21:23.720

它还可以简化管理以将其外包——如果你只有一个存储库和几个人推/拉它，你可以做的比仅仅将它托管在像[Bitbucket](http://en.wikipedia.org/wiki/Bitbucket)这样的地方要糟糕得多。（对于单一存储库的解决方案，它实际上是免费的。）

更新：现在是 2020 年，Bitbucket 不再支持 mercurial，请参阅：[https ://bitbucket.org/blog/sunsetting-mercurial-support-in-bitbucket](https://bitbucket.org/blog/sunsetting-mercurial-support-in-bitbucket)

有关托管或自托管免费或付费解决方案的列表，请参阅[https://www.mercurial-scm.org/wiki/MercurialHosting](https://www.mercurial-scm.org/wiki/MercurialHosting)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-10-27T10:21:04.833

看看[rhodecode](http://rhodecode.org/)，它是一个开源的 Mercurial 服务器，具有[Kiln](http://www.fogcreek.com/kiln/)提供的许多功能，包括代码搜索。它甚至可以与 LDAP 很好地集成，因此您可以使用您的 Windows 域对 HG 用户进行身份验证。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-05-31T15:48:10.500

更新：现在是 2020 年，Bitbucket 不再支持 mercurial，请参阅：[https ://bitbucket.org/blog/sunsetting-mercurial-support-in-bitbucket](https://bitbucket.org/blog/sunsetting-mercurial-support-in-bitbucket)

有关托管或自托管免费或付费解决方案的列表，请参阅[https://www.mercurial-scm.org/wiki/MercurialHosting](https://www.mercurial-scm.org/wiki/MercurialHosting)

~~我建议将您的项目放在[http://bitbucket.org/](http://bitbucket.org/)上，这是一个 Mercurial 存储库托管站点。~~

如果您不希望其他人看到源代码，他们可以设置创建私有存储库。我认为在他们开始向您收费之前，您可以拥有一个私人存储库。

**编辑：** Bitbucket 现在[提供无限](https://bitbucket.org/plans)的私有/隐藏存储库。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-05-31T15:44:12.707

我建议来自[www.fogbugz.com](http://www.fogbugz.com)的 Kiln 。这是一个商业源代码控制解决方案，基本上是一个带有 Mercurial 的 Windows 包装器。

## 2020 年 10 月 24 日更新

11 年前，Mercurial 可能是一个可行的解决方案，但现在不行了：Git 可以正常工作。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-13T21:01:03.493

确实有许多可用于 Windows 的 SSH 服务器。这里有两个例子：

*   [SSH 窗口](http://sshwindows.sourceforge.net/)
*   [免费 SSHd](http://www.freesshd.com/)

查看*Mercurial：* Windows 用户连接的权威指南一书中的[Putty](http://hgbook.red-bean.com/read/collaborating-with-other-people.html)示例。

 ** * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-02-03T08:28:46.377

您可以使用[SCM-Manager](https://bitbucket.org/sdorra/scm-manager)通过 http 或 https 共享您的存储库。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-11T13:47:59.773

Mercurial 和[PuTTY](http://en.wikipedia.org/wiki/PuTTY)是一个得到很好支持和有据可查的解决方案。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-02-19T17:43:10.883

最简单的解决方案似乎是使用 Samba 共享文件夹，尤其是在仅限 Windows 的环境中。我刚设置好，好像可以。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-04-14T13:24:11.490

我自己没有使用过它，但看看LShift 的[Mercurial Server](http://www.lshift.net/mercurial-server.html)。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-12-09T06:16:47.030

我们的设置：Windws 服务器 + Apache + Mercurial

我们 http.conf 的一部分

```
<Location /hg>

    DirectoryIndex hgweb.cgi #from mercurial source, put it in htdocs/hg
    AddHandler cgi-script .cgi
    Options ExecCGI
    Options +FollowSymLinks
        Order deny,allow
        Deny from all
        <Limit GET POST>
            Allow from 127.0.0.1 10.1.2 
        </Limit>   

    AuthUserFile D:/hg/htpasswd
    AuthGroupFile D:/hg/hggroups
    AuthType Basic
    AuthName "Mercurial xxxx repositories"

    Require group admin somegroup

    RewriteBase /hg
    RewriteRule ^$ hgweb.cgi  [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule (.*) hgweb.cgi/$1  [QSA,L]  
</Location>

<Location /hg/project1>    
    Require group somegroup admin
</Location>
<Location /hg/project2>    
    Require group somegroup admin
</Location>
<Location /hg/test>    
    Require valid-user
</Location> 
```

还有其他文件需要设置，例如 hgweb.conf/htpasswd/hggroups，但它们是最简单的部分。

它一直工作得很好。如果有用户想修改密码，我会让他去一个在线的 htpasswd 生成器为我生成 htpasswd 序列，我会把它放在 htpasswd 文件中。

我认为我们的设置与 VisualSvn Server 所做的非常相似。（当然，一个非常简化的版本）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-08-12T08:59:21.843

共享包含您的“服务器存储库”的[Dropbox文件夹。](https://www.dropbox.com/home)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-01-14T08:23:40.633

> 据我所知，在这些类型的设置中使用 mercurial 工作的最佳方式是让 repo 从源中提取更改，而不是将源推送到“服务器”。

我知道没有“最佳工作方式”吗？Mercurial 支持多种可能的工作流程，甚至[将它们列在他们的指南](https://www.mercurial-scm.org/guide)中。我实际上使用的是“svn-ish”设置，我在本地存储库中开发，并在共享服务器上有多个存储库。如果有任何更改，我会将它们推送到中央存储库。我通过 HTTPS 推送它们，而且我（自然）将推送能力限制在开发人员身上。这是一种很棒的工作方式。

我可以理解人们希望中央存储库从开发人员所做的克隆中提取更改，但是没有什么能阻止您在共享服务器上为自己和您的同事提供一个专用存储库，中央存储库*可以*从中提取.

您可能想重新考虑您对推动 v 拉动问题的看法？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-10-24T06:04:51.857

在 2020 年，您可以使用 heptapod：

[https://about.heptapod.host/](https://about.heptapod.host/)

这是一个基于 gitlab 的解决方案。他们提供托管解决方案，但您也可以下载它并托管在您自己的基础架构上。

[https://heptapod.net/heptapod-commercial-service-enters-free-public-beta.html#heptapod-commercial-service-enters-free-public-beta](https://heptapod.net/heptapod-commercial-service-enters-free-public-beta.html#heptapod-commercial-service-enters-free-public-beta)

# c++ - C++：调试引用计数系统中的内存泄漏

> ID：740100
> 
> 赞同：2
> 
> 时间：2009-04-11T13:38:33.603
> 
> 标签：c++, memory-leaks

在我的一些应用程序中，以及在这些应用程序使用的 dll 中，我有许多引用计数类，它们都继承并实现了 IRefCounted 接口。

为了帮助找到这些内存泄漏的来源，我希望每个应用程序都维护一个现有的所有这些引用计数类的列表。

问题是管理这些列表的实例，以便它们的使用不会影响我的类的使用（例如，我不需要一直传递指向列表的指针，而是以某种方式将其附加到进程中）。

- 这些应用程序中的几个很有可能同时运行，并使用相同的 dll。每个应用程序都需要自己的对象列表，并且该应用程序加载的所有 dll 等都需要使用该列表（但请记住，一个 dll 可能会被多个应用程序加载......）。
- 列表必须在应用程序中的所有其他全局变量和静态变量之后被销毁，因此当列表被销毁时留在列表中的对象是未正确释放的对象。

然后我将简单地在列表的析构函数中添加一个断点，这样我就可以在调试器中查看任何未分配的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T14:31:31.557

如果进程使用相同的 DLL，则每个进程都会获得该 DLL 的静态（或“全局”）数据的私有副本。

因此，您需要做的就是使列表成为 DLL 中的全局变量，并从每个应用程序链接到该 DLL。这样，就不需要传递任何额外的东西。

由于多 DLL 进程中对象的破坏顺序的不可预测性，您捕获列表破坏的想法充满了困难。

`main`在or`WinMain`函数的末尾转储列表的内容会简单得多。

如果您没有以一致的方式使用智能指针类，那么就这样做。此外，可能值得寻找循环引用计数 - 对象 A 对对象 B 有计数，反之亦然。这是未释放对象的常见原因。

**更新：**

要强制所有静态析构函数运行和释放对象，以便之后检查列表中的条目，您需要以某种方式构造应用程序。

假设您有一个非常小的 EXE 来启动进程，并加载许多其他实际完成所有工作的 DLL。这些其他 DLL 以某种方式通过 LoadLibrary 加载（可能通过 COM 或类似 COM 的系统）。LoadLibrary API 通过将 DLL 加载到进程中来工作，或者如果 DLL 已经加载，则增加 DLL 上的内部引用计数器。FreeLibrary API 递减计数器直到它达到零，然后卸载 DLL（此时该 DLL 的静态析构函数将执行）。

为此，我们现在添加我们的诊断 DLL，该 DLL 包含所有未完成的引用计数对象的列表。所有其他 DLL 使用 import-lib 链接到诊断 DLL，EXE 也使用 LoadLibrary。

当`main`即将退出时，EXE 会遍历它之前加载的 DLL 句柄列表，并在所有这些句柄上调用 FreeLibrary。通过保持诊断 DLL 的加载，它确保它最终仍然存在。至少理论上是这样的。

但是应该以什么顺序卸载其他 DLL？如果 A.DLL 具有指向 B.DLL 中定义的对象的静态指针，那么您最好先卸载 A。因此，您需要了解您的各种 DLL 如何形成“分层”架构，较高层依赖于较低层，从而为您提供卸载它们的安全顺序。

此外，一旦您卸载了所有 DLL，诊断列表中引用 DLL 中对象的任何条目现在都将指向堆上的有效数据，但 vtable 将指向由 DLL 定义的代码现在已被卸载，因此您将无法在这些对象上调用虚函数。不过，您应该能够检查他们的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T14:02:49.537

~~我猜你正在使用COM。~~ 您可能需要找到某种方法来使用[弱指针](http://www.ddj.com/cpp/184402026)，以便实例化对象的注册表不会阻止它们被破坏。

如果您可以修改所有类，则可以注入一个静态成员来跟踪所有实例，并让实例的析构函数从静态成员中删除自己。例如，您可以使用如下基类或实用程序类：

```
class InstanceRegistry {
protected:
    InstanceRegistry() {
       registry.insert(this);
    }
    ~InstanceRegistry() {
       registry.remove(this);
    }
private:
  static SomeContainerType<InstanceRegistry*> registry;
}; 
```

如果您想为不同类型的类等使用不同的注册表，则需要做额外的工作。

# linux - 无法将文件快速复制到 Linux 计算机中的剪贴板

> ID：740109
> 
> 赞同：7
> 
> 时间：2009-04-11T13:47:25.393
> 
> 标签：linux, clipboard

我还没有找到一个简单的解决方案来将您的文件复制到 Linux 中的剪贴板，就像在 Mac 中一样

```
cat file | pbcopy 
```

我尝试在 Vim 中使用以下命令失败

```
:copy 1,9999999 
```

复制文件。

**如何在 Linux 中快速将文件复制到剪贴板，**然后将其粘贴到 dpaste？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-11T13:52:40.123

xclip适合你吗[？](http://www.cyberciti.biz/faq/xclip-linux-insert-files-command-output-intoclipboard/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-11T13:52:31.153

Linux 等效`pbcopy`于`xclip`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-11T14:02:42.640

除了已经提到的 xsel 和 xclip 之外，还有[uclip](http://www.typo.co.il/~mooffie/uclip/)。从手册页描述：

*uclip 是 X 剪贴板的命令行界面。它要么从 FILE 或从标准输入复制文本到 X 剪贴板，要么将 X 剪贴板打印到标准输出。uclip 支持 Unicode 并且可以识别区域设置（与其他类似的实用程序相比）。uclip 是使用 Qt 编写的。*

更新：显然 uclip 不是一个很好的建议，因为它目前不适用于复制，请参阅[此处](https://stackoverflow.com/questions/741129/what-is-the-minimum-amount-of-tweaking-needed-to-get-qclipboardsettext-to-wor)了解问题描述（希望有一天能解决？）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-11T13:52:22.167

试试[xsel](http://www.vergenet.net/~conrad/software/xsel/)。它确实很神奇，但它并不真正适用于剪贴板，而是适用于 X 选择缓冲区。

猫文件 | xsel

然后您可以单击鼠标滚轮粘贴内容。

# javascript - 如何使用jQuery获取文件输入字段的当前值

> ID：740114
> 
> 赞同：27
> 
> 时间：2009-04-11T13:51:41.793
> 
> 标签：javascript, jquery, dom

根据我准备的内容，您应该能够使用文件输入字段的“值”属性来获取该字段当前设置的路径。但是当我这样做时：

```
 $('#fileinput').value() 
```

我得到'未定义'。我确定该字段的 ID 设置为“fileinput”。有人对为什么这对我不起作用有任何想法吗？

顺便说一句，这有效：

```
var d = document.getElementById('AttachmentFile');
alert(d.value); 
```

所以我想这与我不完全理解的 jQuery 工作方式有关。

谢谢！

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-04-11T13:56:04.887

您需要使用 val 而不是 value。

```
$("#fileinput").val(); 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-12-21T14:00:29.500

在 Chrome 8 中，路径始终是具有正确文件名的“C:\fakepath\”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-07-15T18:58:40.077

它不是 .val() 如果你想获得文件 /home/user/default.png 它会得到 .val() 只是 default.png

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-11T13:56:07.180

我认为没有任何真正合法的方式可以通过 DOM 访问它。这将是浏览器最近锁定以防止路过上传的安全风险。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-11T13:57:18.003

我认为应该是

```
 $('#fileinput').val(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-17T10:59:19.473

Jquery 在 IE 和其他浏览器中的工作方式不同。您可以使用访问最后一个文件名

```
alert($('input').attr('value')); 
```

在 IE 中，上面的警告会给出完整的路径，但在其他浏览器中，它只会给出文件名。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-10T16:43:42.460

你也可以吗

`$(input[type=file]).val()`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-03T18:49:22.423

我已经尝试过了，它有效：

```
 yourelement.next().val(); 
```

你的元素可能是：

```
$('#elementIdName').next().val(); 
```

祝你好运！

# web - 如何使用单个域在两个不同的物理服务器上托管两个具有不同端口号的不同网站？

> ID：740115
> 
> 赞同：2
> 
> 时间：2009-04-11T13:51:46.317
> 
> 标签：web, port

我想在某个地方的共享服务器上托管[http://somedomain.com](http://somedomain.com)。我想在运行 Apache 的家庭服务器上托管[http://somedomain.com:89 。](http://somedomain.com:89)设置它的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T13:54:07.373

做到这一点的唯一方法是使用您的一台服务器作为另一台服务器的代理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T13:57:18.037

IETF 不是为 telnet 网关保留 89 吗？

我建议您可能选择不同的端口号？

运行 Apache 的两个实例，第一个在标准端口 80 上。第二个实例在您选择的端口上，并重定向到您的最终服务器。

高温高压

干杯，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T13:55:48.493

你可以通过[负载平衡来做到这一点](http://en.wikipedia.org/wiki/Load_balancing_(computing))

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T14:06:24.537

我以前做过，我的注册商（dyndns）支持那些类型的重定向（我在 Windows 2003 Server 上工作）

# oracle11g - Oracle 11g 的默认密码？

> ID：740119
> 
> 赞同：85
> 
> 时间：2009-04-11T13:52:48.703
> 
> 标签：oracle11g

我安装了 Oracle 11g。我没有更改 SYSTEM 和 SYS 的密码。但是现在我发现默认密码不起作用。请帮忙。

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2009-04-11T22:25:41.543

可以在不指定密码的情况下连接到数据库。完成后，您可以重置密码。我假设你已经在你的机器上安装了数据库；如果不是，您首先需要连接到运行数据库的机器。

1.  确保您的用户帐户是该`dba`组的成员。您如何执行此操作取决于您正在运行的操作系统。

2.  根据需要输入`sqlplus / as sysdba`命令提示符/shell/终端窗口。这应该让您以 SYS 身份登录到数据库。

3.  登录后，您可以进入

    ```
    alter user SYS identified by "newpassword"; 
    ```

    重置 SYS 密码，对于 SYSTEM 也是如此。

（注意：我没有在 Oracle 12c 上尝试过任何这些；我假设自 Oracle 11g 以来他们没有改变任何东西。）

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-09-16T23:00:22.070

以 oracle 登录用户 id 登录机器（安装了 oracle）..

1.  添加`ORACLE_HOME = <Oracle installation Directory>`环境变量

2.  打开命令提示符

3.  将目录更改为`%ORACLE_HOME%\bin`

4.  输入命令`sqlplus /nolog`

5.  *SQL>* `connect /as sysdba`

6.  *SQL>* `alter user SYS identified by "newpassword";`

再检查一次，在 oracle 安装和数据库配置助手设置时，如果您配置任何数据库，那么您可能已经给了密码并为所有其他帐户检查了相同的密码。如果是这样，那么您尝试使用您在您的密码中提供的密码数据库配置助手设置。

希望这对你有用..

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-27T06:48:21.580

在 Windows 中安装后按照从**运行 SQL 命令行**（命令提示符）开始的说明进行操作

然后... v. SQL> 连接 /as sysdba

*连接的。*【SQL提示响应】

六。SQL> 更改由“newpassword”标识的用户 SYS；

*用户更改。*【SQL提示响应】

谢谢你。这减少了头痛

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-23T01:14:38.983

实际上在安装过程中。它会提示你输入密码。在安装的最后一步，会出现一个显示克隆数据库文件的窗口。复制后会有一个选项..密码管理..我们必须设置我们的密码..并且用户名将是默认的..

# c++ - C++ 中的变量转储

> ID：740120
> 
> 赞同：5
> 
> 时间：2009-04-11T13:53:44.050
> 
> 标签：c++, data-structures

是否可以在 C++ 中对复杂结构甚至数组进行“转储”，以便直观地检查它们内部的内容？

我正在考虑类似于 PHP 中的 print_r() 或 var_dump() 的东西。

干杯，-Fin

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-11T13:58:34.023

简短的回答是：不，除非您自己手动编写这样的例程。

这通常不是一个坏主意，但如果您经常添加/更改成员，它通常会出现与班级不同步的问题。这是不可避免的，因为 C++ 缺乏对`struct`s 的任何形式的自省。

如果您决定采用这种方式，最好的办法是为 编写一个重载`std::ostream& operator<<(std::ostream& os, MyClass const&)`，这将使您的类能够打印到任何 IOStreams 输出流。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-11T15:12:25.140

通常调试器足够聪明地做到这一点。

在 GDB 中，您可以使用：

```
print structure 
```

在 NTSD 中，你可以做超级酷的事情：

```
dt -r structure 
```

如果您只是将其用于调试目的，我强烈建议您学习使用调试器。即使它是您想要记录的内容（即打印无数次），您也可以设置断点宏。

在 NTSD 中：

```
bp yourdll!yourobject::yourfunction "dt -r structure;g" 
```

而且我确信在 GDB 中也有办法做到这一点

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T14:40:06.170

如果您向 C++ 添加反射（使用第三方库或供应商扩展），您可以编写一个例程来使用该反射数据来转储任意结构。例如，我有一些代码使用 CERN 的[Reflex](http://root.cern.ch/drupal/content/reflex)库来迭代类或结构的成员并将它们转储到[YAML](http://en.wikipedia.org/wiki/YAML)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-11T14:07:36.077

除了其他答案之外，根据您想要它的用途以及您是否关心可移植性，您可能会考虑从编译器生成的调试信息中获取所需的信息。您可以从构建中解析 COFF/ELF/任何格式的文件，这为您提供了计算对象中变量的名称和类型所需的信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-11T13:57:21.327

在 C++ 中通常不可能，因为它需要使用 C++ 所没有的反射。您当然可以编写自己的函数来转储特定的数据结构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T17:08:39.200

实际上，在您可以使用 gdb 并在启用调试符号的情况下编译源代码（例如 -ggdb）的环境中，您可以使用调试器（例如，当您需要图形化的东西时，来自命令行的 gdb 或 ddd）。

考虑这段代码：

```
#include <string>
#include <vector>

struct test
{
    int a;
    float b;
    std::string c;
};

int main()
{
    std::vector<int> v;

    test t;
    t.a=1;
    t.b=2.0;
    t.c="hello there";

    return 0;
} 
```

当礼貌地询问 gdb 时，它可以给我以下输出：

```
(gdb) 突破 20
0x8048622 处的断点 1：文件 bla.cpp，第 20 行。
(gdb) 运行
启动程序：/home/edb/a.out

断点 1, main () at bla.cpp:21
21 返回 0；
(gdb) 打印
$1 = {a = 1, b = 2, c = {静态 npos = 4294967295,
    _M_dataplus = {> = {> = {}, }, _M_p = 0x96b6014 “你好”}}}
(gdb) ping v
未定义的命令：“ping”。试试“帮助”。
(gdb) 打印 v
$2 = { >> = {
    _M_impl = {> = {> = {}, }, _M_start = 0x0, _M_finish = 0x0,
      _M_end_of_storage = 0x0}}，}

```

编辑：请注意，此数据可从调试器上下文中获得，为了在运行时生成这些转储，您需要预见自己的转储/格式化函数，通常通过重载 C++ 中的 << 运算符来完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-16T06:15:04.937

为什么不使用二进制文件？fstream 具有二进制模式，您可以转储除`struct,class,namespace`STL 列表（如向量、队列）之外的任何类型。想将结构、类、命名空间（或 STL 列表）转储为二进制文件吗？创建一个函数，并转储文件中的每个变量！结束！这不会那么难......但需要更多帮助？请参阅此代码片段！

```
#include <iostream>
#include <fstream>//ofstream,ifstream
using namespace std;
ifstream myBdumpin ("data.bin"/*filename*/, ios::in);//ifstream = input
ofstream myBdumpout ("data.bin"/*filename*/, ios::out);//ofstream = output
int main()
{
    char a[8]="Binary!"
    myBdumpout << a;
    char b[8];
    myBdumpin >> b;
    if(a == b)cout << "It worked!" << endl;
    else cout << "It failed..." << endl;
    return 0;
} 
```

它应该工作...

# error-handling - 示例——即使是初学者示例——是否应该包含错误处理代码？

> ID：740121
> 
> 赞同：7
> 
> 时间：2009-04-11T13:54:02.193
> 
> 标签：error-handling

Brian Kernighan 在[最近的一次采访](http://broadcast.oreilly.com/2009/04/an-interview-with-brian-kernig.html)中被问到这个问题。我将引用他的回复：

> 布赖恩：我对此感到很伤心。错误处理代码往往很庞大，而且非常无趣和没有指导意义，因此它经常妨碍学习和理解基本的语言结构。同时，重要的是要提醒程序员错误确实会发生，并且他们的代码必须能够处理错误。
> 
> 我个人的偏好是在教程的前面部分几乎忽略错误处理，除了提到可能会发生错误，并且类似地忽略参考手册中的大多数示例中的错误，除非某些部分的重点是错误。但这会强化无意识的信念，即忽略错误是安全的，这总是一个坏主意。

我经常在此处和我自己的博客上的代码示例中省略错误处理，我注意到这是 Stack Overflow 的总体趋势。我们是否在强化坏习惯？我们应该花更多的时间来完善错误处理示例，还是只是妨碍说明这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-11T14:02:45.603

我认为如果在发布示例代码时我们至少在其中添加注释说您应该在某些位置添加错误处理代码，这可能是一种改进。这至少可以帮助使用该代码的人记住他们需要进行错误处理。这将保留用于错误处理的额外代码，但仍会强化需要有错误处理代码的想法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-11T14:01:11.553

任何提供的示例代码都将至少复制一次粘贴到生产代码中，因此在编写时要做到最好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-11T14:03:22.797

除了在演示编码点时代码混乱的问题之外，我认为问题变成了，您*如何*选择处理示例代码中的错误？

也就是说，你是做什么的？对一个应用程序来说是致命的，对另一个应用程序来说是非致命的。例如，如果我无法从网络服务器检索某些信息（可能是 404 错误或无响应的服务器），如果没有这些数据就无法执行任何操作，这可能是致命的。但是，如果这些数据是对您正在做的事情的补充，那么也许您可以没有它。

所以上面可能只是简单地记录错误。这比完全忽略错误要好。但我认为通常困难在于知道如何/何时（以及何时不）从错误中恢复。也许这本身就是一个全新的教程。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-11T14:55:41.827

例子应该是说明性的。他们应该始终以尽可能少的干扰清楚地表明所提出的观点。这是一个元示例：

假设我们要从文件中读取一个数字，加 3，然后将其打印到控制台。我们需要展示一些东西。

```
infile = file("example.txt")
content = infile.read()
infile.close()
num = int(content)
print (3 + num) 
```

罗嗦，但正确，除了有几件事可能出错。首先，如果文件不存在怎么办？如果它确实存在但不包含数字怎么办？

因此，我们展示了如何处理错误。

```
try:
    infile = file("example.txt")
    content = infile.read()
    infile.close()
    num = int(content)
    print (3 + num)
except ValueError:
    print "Oops, the file didn't have a number."
except IOError:
    print "Oops, couldn't open the file for some reason." 
```

在展示如何处理由文件处理和解析引发的错误的几次迭代之后。当然，我们想展示一种更 Python 的方式来表达 try 子句。现在我们放弃错误处理，因为这不是我们要演示的。

首先让我们消除不需要的额外变量。

```
infile = file("example.txt")
print (3 + int(infile.read()))
infile.close() 
```

由于我们没有写入它，它也不是长时间运行过程中的昂贵资源，因此将其保持打开状态实际上是安全的。程序终止时它将关闭。

```
print ( 3 + int(file("example.txt").read())) 
```

但是，有些人可能会认为这是一个坏习惯，并且有更好的方法来处理这个问题。我们可以使用上下文使其更清晰一些。当然，我们会解释文件将在 with 块的末尾自动关闭。

```
with file("example.txt") as infile:
    print (3 + int(infile.read())) 
```

然后，既然我们已经表达了我们想要表达的一切，我们将在本节的最后展示一个完整的示例。此外，我们将添加一些文档。

```
# Open a file "example.txt", read a number out of it, add 3 to it and print
# it to the console.
try:
    with file("example.txt") as infile:
        print (3 + int(infile.read()))
except ValueError: # in case int() can't understand what's in the file
    print "Oops, the file didn't have a number."
except IOError: # in case the file didn't exist.
    print "Oops, couldn't open the file for some reason." 
```

这实际上是我通常看到的指南表达的方式，并且效果很好。当任何部分丢失时，我通常会感到沮丧。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-11T14:00:39.743

我并不经常不同意 BWK，但我认为初学者示例**尤其**应该显示错误处理代码，因为这是初学者很难处理的事情。更有经验的程序员可以将错误处理视为已读。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-11T14:05:12.213

我认为解决方案在中间的某个地方。如果您要定义一个函数以在列表“y”中查找元素“x”，则可以执行以下操作：

```
function a(x,y) 
{
   assert(isvalid(x))
   assert(isvalid(y))
   logic()
} 
```

无需明确说明是什么使输入有效，读者应该知道逻辑假定输入有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-11T14:01:35.983

错误处理本身就是一种范式；它通常不应该包含在示例中，因为它严重破坏了作者试图表达的观点。

如果作者想在特定领域或语言中传递有关错误处理的知识，那么作为读者，我希望有一个不同的章节来概述错误处理的所有主要范例以及这如何影响其余章节。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-11T14:06:12.337

我的一个想法是在您的示例代码中的某处包含如下一行：

```
DONT_FORGET_TO_ADD_ERROR_CHECKING();   // You have been warned! 
```

所有这一切都是为了防止任何盲目复制和粘贴代码的人“立即”编译代码（因为显然`DONT_FORGET_TO_ADD_ERROR_CHECKING()`没有在任何地方定义）。但这也很麻烦，并且可能被认为是粗鲁的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-11T14:11:12.777

我会说这取决于上下文。在博客条目或教科书中，我会专注于执行或演示所需功能的代码。我可能会对错误处理表示强制性的点头，甚至可能会进行检查，但会用省略号对代码进行存根。在教学中，您可能会通过包含太多不直接关注手头主题的代码来引入很多混乱。特别是在 SO 中，更短（但完整）的答案似乎更受青睐，因此在这种情况下，用“挥手”处理错误也可能更合适。

也就是说，如果我提供了一个可供下载的代码示例，我通常会使其尽可能完整并包含合理的错误处理。这里的想法是，为了学习，人们总是可以回到教程/博客并使用它来帮助理解实际实现的代码。

以我个人的经验，这是我对 TDD 的典型呈现方式所遇到的问题之一——通常您只会看到开发的测试来检查代码在主要执行路径中是否成功。我希望看到更多 TDD 教程包括为备用（错误）路径开发测试。我认为，测试的这一方面是最难掌握的，因为它要求你思考的不是应该发生什么，而是所有可能出错的事情。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-11T14:26:53.550

我见过的一种方法，特别是在[UNIX 环境中的高级编程](http://www.kohala.com/start/apue.html)和[UNIX 网络编程](http://www.kohala.com/start/unpv12e.html)中看到的一种方法是使用错误检查代码包装调用，然后在示例代码中使用包装器。例如：

```
ssiz_t Recv(...)
{
    ssize_t result;
    result = recv(...);
    /* error checking in full */
} 
```

然后，在调用代码中：

```
Recv(...); 
```

这样，您就可以显示错误处理，同时让调用代码的流程清晰简洁。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-11T16:29:31.413

如果错误处理模糊了逻辑，我认为不应该在示例中进行错误处理。但是一些错误处理只是做一些事情的习惯用法，在这些情况下包括它。

此外，如果指出需要添加错误处理。为了爱神也指出需要处理的*错误*。

这是阅读一些示例时最令人沮丧的部分。如果您不知道自己在做什么（我们必须假设示例的读者......）您也不知道要查找哪些错误。这将“添加错误处理”建议变成了“这个例子没用”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-19T01:29:08.263

示例代码不需要包括错误处理，但它应该以其他方式展示适当的安全编码技术。许多 Web 代码片段违反了[OWASP](http://www.owasp.org/)前十名。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-11T15:11:39.277

不，除非该示例的目的是演示异常处理的一个方面。这是我的一个小烦恼——许多示例试图展示最佳实践，最终使示例变得模糊和复杂化。我一直在代码示例中看到这一点，这些示例首先定义了一些示例不需要的接口和继承链。过度复杂化的一个典型例子是我去年在 TechEd 做的一个动手实验室。实验室是在 Linq 上进行的，但我被指示编写的示例代码毫无目的地创建了一个多层应用程序。

示例应该从演示这一点的最简单的代码开始，然后进入实际使用和最佳实践。

顺便说一句，当我向求职者询问代码示例时，几乎所有人都小心翼翼地展示了他们对异常处理的了解：

```
public void DoSomethingCool()
{
    try
    {
         // do something cool
    }
    catch (Exception ex)
    {
        throw ex;
    }
} 
```

我已经收到了数百行这样的每种方法的代码。我已经开始为那些使用 throw 的人奖励积分；而不是扔前;

# c++ - Visual Studio 2005 中的 C/C++ 代码荧光笔

> ID：740131
> 
> 赞同：0
> 
> 时间：2009-04-11T13:57:59.423
> 
> 标签：c++, c, visual-studio-2005, visual-c++-2005, codehighlighter

我刚开始使用 VS2005，我希望在 C/C++ 中突出显示代码。VS 菜单 Tools->Options->TextEditor->C/C++ 很差。
我来自 PHP，IDE 在突出显示时非常友好。我没想到 Visual Studio 在这种选择上如此糟糕。

你能推荐我一个免费的工具/插件/lib，以便为 C/C++ 突出显示代码吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T14:06:57.030

它不是免费的，但[Visual Assist X](http://www.wholetomato.com/)有一些非常好的突出显示。

另一个（对您来说不是最佳的）解决方案是切换编辑器。Emacs 是无限可配置的。我相信[Eclipse CDT](http://www.eclipse.org/cdt/)和[NetBeans](http://www.netbeans.org/)有更好的语法高亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T00:45:39.020

我们还在我工作的地方使用[Visual Assist X ；](http://www.wholetomato.com/)我会极力推荐它。除了简单的突出显示，它还有重构工具、去定义、自动完成等等。

# xml - 如何在 RSS 中创建活动链接？

> ID：740150
> 
> 赞同：0
> 
> 时间：2009-04-11T14:07:44.203
> 
> 标签：xml, rss, xslt

在 RSS 中，例如，如果我想为频道添加一个链接： RSS 代码的一部分：

```
<link>
 <a href="http://www.nytimes.com/2009/04/10/technology/internet/10google.html?ref=technology"/>
</link> 
```

现在这里是 XSL 代码：

```
 <span> <xsl:value-of select="channel/link"/></span> 
```

这里的问题是，当我预览代码时，链接在浏览器中实际上并没有处于活动状态（意味着它仍然看起来像普通文本并且无法在浏览器上单击它）

请你帮我如何在 RSS 代码中创建一个链接，以便它最终可以在浏览器中激活？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T14:19:48.573

我会用

```
<link>http://www.nytimes.com/2009/04/10/technology/internet/10google.html?ref=technology</link> 
```

然后在 XSLT 中，创建一个`a`标记并将`href`属性设置为该值。我不太了解 XSLT，但这可能是可能的，或者可以解决的问题：

```
<span>
    <a>
        <xsl:attribute name="href">
            <xsl:value-of select="channel/link"/>
        </xsl:attribute> 
        Some text
    </a>
</span> 
```

# opengl - OpenGL 纹理不显示的常见故障排除步骤是什么？

> ID：740151
> 
> 赞同：15
> 
> 时间：2009-04-11T14:09:11.703
> 
> 标签：opengl, textures

在我的应用程序中进行一些更改后，我的纹理不再显示。到目前为止，我已经检查了以下内容：

*   相机方向没有改变。
*   我可以看到矢量（当着色而不是纹理时）。

有什么常见的嫌疑人吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-11T14:26:19.260

您可能需要检查以下内容：

*   `glEnable(GL_TEXTURE_2D);`在场

*   `glBindTexture(GL_TEXTURE_2D, texture[i]);``glBindTexture(GL_TEXTURE_2D, 0);` 当你不再需要纹理时

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T22:50:20.997

我不时遇到的一个常见问题是

```
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_NEAREST); 
```

但我忘了提供 mipmap。快速解决：

```
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T01:18:15.543

还有几件事要检查：

*   glColorMaterial(...); 确保颜色不会覆盖纹理
*   glEnable/glDisable(GL_LIGHTING); 有时光照会洗掉纹理
*   glDisable(GL_BLEND); 确保你没有混合纹理
*   确保纹理坐标设置正确。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T03:55:44.263

我假设你已经实现了必须的操作，比如 glEnable(GL_TEXTURE_2D) 和纹理绑定，因为你的纹理之前工作得很好，然后突然它们就不会显示了。

如果您正在执行面向对象的代码，您可能希望在实际执行绘制的线程被实例化时发生纹理生成，换句话说：避免在构造函数中执行它或来自构造函数的调用，这可能会实例化您的纹理窗口或将要使用它的应用程序打开之前的对象。

我通常做的是创建纹理创建的手动 Init 函数，该函数在 App 的 Init 函数中调用。因此，我保证在绑定发生时应用程序存在。

更多信息在这里：[http ://www.opengl.org/wiki/Common_Mistakes#The_Object_Oriented_Language_Problem](http://www.opengl.org/wiki/Common_Mistakes#The_Object_Oriented_Language_Problem)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T20:15:45.740

渲染纹理对象之前的 glColor3ub(255,255,255) 有帮助吗？我认为默认的 OpenGL 状态将当前 glColor 乘以传入的纹素；一个流浪的 glColor3ub(0,0,0) 会让你所有的纹理看起来都是黑色的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-11-25T10:29:11.280

我花了一些时间才弄清楚这个...

```
glMatrixMode(GL_TEXTURE);
glLoadIdentity();
glDisable(GL_TEXTURE_GEN_S);
glDisable(GL_TEXTURE_GEN_T);
glDisable(GL_TEXTURE_GEN_R);
glDisable(GL_TEXTURE_GEN_Q); 
```

还要确保取消绑定你的东西：

```
glBindBuffer(GL_ARRAY_BUFFER, 0);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);
glBindVertexArray(0); 
```

如果您使用经过优化的第三方引擎，它可能具有用于 OpenGL 的“直接状态访问”层（不使用慢速 OpenGL 查询功能）。如果是这样，不要直接调用 OpenGL，而是使用引擎包装器。否则，您的代码无法与引擎代码的其余部分配合使用。

# asp.net - 动态生成的 WebUser 控件

> ID：740153
> 
> 赞同：0
> 
> 时间：2009-04-11T14:10:34.743
> 
> 标签：asp.net

我有两个 WebUser 控件，它们根据上一页的用户输入多次动态添加到 Webform。WebUser 控件中有一些文本框和下拉菜单。我需要从动态添加的 WebUsercontrol 的文本框中获取值。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T14:24:52.183

您应该将控件值公开为用户控件中的属性。然后，您可以遍历容器的 Controls 集合。

```
foreach (Control ctl in container.Controls)
{
    if (ctl is MyUserControl)
    {
         MyUserControl uctl = (MyUserControl)ctl;
         // do something with uctl properties, e.g.
         string myString = uctl.Address1;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T13:32:03.580

据我所知，转换为用户控件类型仅适用于 Web 应用程序项目，因此您还有一些其他选项 - 创建会话或视图状态值并在这些控件之间共享。- 创建一个基类，这两个用户控件都继承自，并且在基类中，您可以定义控件应该交互的属性。-创建一个接口，这两个用户控件都将在其中实现。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T14:16:32.093

一些伪代码：

```
Let the parent container control be ParentContainerControl

For Each ctl` In ParentContainerControl.Controls

    If ctl is a TextBox
        Use ctr.Text
    End If

Next 
```

# javascript - 如何在 Firefox 中的纯 txt 文件上使用 innerHTML？

> ID：740156
> 
> 赞同：1
> 
> 时间：2009-04-11T14:11:15.617
> 
> 标签：javascript, firefox, dom, innerhtml

如果您在浏览器中打开一个文本文件（.txt、.js、.css、...），它将被包裹在一个漂亮的 DOM 树中。

例如，打开[这个 .txt 文件](http://www.ietf.org/rfc/rfc2549.txt)并输入

```
javascript:alert(document.documentElement.innerHTML); 
```

进入您的地址栏。不错...每个主流浏览器都支持对这个包装的文本文件进行 DOM 操作，这对于编写强大的小书签或[用户脚本](http://www.userscripts.org)来说是一件好事。

但是，Firefox 无法*分配*任何元素的 innerHTML。例如，

```
javascript: document.body.innerHTML = document.body.innerHTML.replace(/(\d+\s+\w+(?=\s+\d+))/g, '<span style="color:red">$1</span>'); void 0; 
```

将适用于除 Firefox 之外的所有浏览器。

有解决此问题的技巧吗？

（不，我不想手动解析 innerHTML 字符串，不，它也不适用于 jQuery。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T14:19:05.817

它失败了，因为没有`body`- 即使您链接的文件也只是一个没有正文的文本文件（也许您正在 firebug 中查看它？）。

最好的办法是使用正则表达式替换，因为您正在处理文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T15:21:29.150

我想我找到了一个可行的解决方案。首先，让我就这个问题提供更多细节。

问题是：Firefox 创建了类似的东西

```
[some wrapper]
+---document
    +---<html>[=documentElement]
        +---<body>
            +---<head/>
            +---<pre>
                +---[actual plain text contents] 
```

但包装的文档对象不支持正确设置 innerHTML。因此，基本思想是，创建一个完全支持 innerHTML 的新文档对象。以下是它的工作原理：

```
var setInnerHTML = function(el, string) {
    if (typeof window.supportsInnerHTML == 'undefined') {
        var testParent = document.createElement('div');
        testParent.innerHTML = '<br/>';
        window.supportsInnerHTML = (testParent.firstChild.nodeType == 1);
    }
    if (window.supportsInnerHTML) {
        el.innerHTML = string;
    } else {
        if (!window.cleanDocumentObject) {
            /* this is where we get a 'clean' document object */
            var f = document.createElement('iframe');
            f.style.setProperty('display', 'none', 'important');
            f.src = 'data:text/html,<!DOCTYPE html><html><title></title></html>';
            document.body.appendChild(f); /* <- this is where FF creates f.contentDocument */
            window.cleanDocumentObject = f.contentDocument;
            document.body.removeChild(f);
        }

        /* let browser do the parsing */
        var div = window.cleanDocumentObject.createElement('div');
        div.innerHTML = string; /* this does work */

        /* copy childNodes */
        while(el.firstChild) {
            el.removeChild(el.firstChild); /* cleanup */
        }
        for (var i = 0; i < div.childNodes.length; i++) {
            el.appendChild(div.childNodes[i].cloneNode(true));
        }
        delete div;
    }
} 
```

* * *

编辑：

这个版本更好更快；使用 XSLTProcessor 而不是 iFrame。

```
var setInnerHTML = function(el, string) {
    // element.innerHTML does not work on plain text files in FF; this restriction is similar to
    // http://groups.google.com/group/mozilla.dev.extensions/t/55662db3ea44a198
    var self = arguments.callee;
    if (typeof self.supportsInnerHTML == 'undefined') {
        var testParent = document.createElement('div');
        testParent.innerHTML = '<p/>';
        self.supportsInnerHTML = (testParent.firstChild.nodeType == 1);
    }
    if (self.supportsInnerHTML) {
        el.innerHTML = string;
        return el;
    } else if (typeof XSLTProcessor == 'undefined') {
        return undefined;
    } else {
        if (typeof self.cleanDocument == 'undefined')
            self.cleanDocument = createHTMLDocument();

        if (el.parentNode) {
            var cleanEl = self.cleanDocument.importNode(el, false);
            cleanEl.innerHTML = string;
            el.parentNode.replaceChild(document.adoptNode(cleanEl), el);
        } else {
            var cleanEl = self.cleanDocument.adoptNode(el);
            cleanEl.innerHTML = string;
            el = document.adoptNode(cleanEl);
        }

        return el;
    }

    function createHTMLDocument() {
        // Firefox does not support document.implementation.createHTMLDocument()
        // cf. http://www.quirksmode.org/dom/w3c_html.html#t12
        // the following is taken from http://gist.github.com/49453
        var xmlDoc = document.implementation.createDocument('', 'fooblar', null);
        var templ = '<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">'
                + '<xsl:output method="html"/><xsl:template match="/">'
                + '<html><title/><body/></html>'
                + '</xsl:template></xsl:stylesheet>';
        var proc = new XSLTProcessor();
        proc.importStylesheet(new DOMParser().parseFromString(templ,'text/xml'));
        return proc.transformToDocument(xmlDoc);
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T14:13:44.533

使用 GreaseMonkey

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T16:17:10.243

似乎在 Firefox 3 中的文本文档上，分配任何节点的 innerHTML 就像您分配给 innerText 一样（带有“<html><body><pre>”前缀）。

（由于非 XML/HTML 文档上的 DOM 脚本是完全未定义的，这当然是 Firefox 的权利；在 HTML 页面中显示文本文件似乎是一种快速破解。）

所以你不能在 Firefox 上使用 innerHTML，但是其他 DOM 方法可以工作：

```
var span= createElement('span');
span.style.color= 'red';
span.appendChild(document.createTextNode(match)); 
```

# java - 以特定格式将数据存储在txt文件中

> ID：740157
> 
> 赞同：2
> 
> 时间：2009-04-11T14:11:41.073
> 
> 标签：java, file, file-format, text-files

我的问题与我之前的问题（[如何以特定格式显示 txt 文件中的数据](https://stackoverflow.com/questions/731917/how-to-display-data-from-txt-file-in-specific-format)）有关。

我想知道是否有可能首先以特定格式将数据存储在 txt 文件中，而不是先存储它然后再次检索它并以特定格式显示它？

例如，而不是像这样将数据存储在 txt 文件中

```
杰西卡
步行
20分钟
马修
跑
10分钟

```

我想以这种格式将它存储在txt文件中

```
杰西卡步行 20 分钟
马修跑 10 分钟

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T14:37:02.947

关于您对阿德尔回答的评论：

> 谢谢adeel825，但是我不知道把“\t”放在哪里。到目前为止，我使用这个方法：new PrintStream(fout).println(name); 新的 PrintStream(fout).println (练习); new PrintStream(fout).println("10 分钟");

首先，不要在`new PrintStream(fout)`每次打印时都调用“”。做这个：

```
PrintStream ps = new PrintStream(fout);
ps.print(name);
ps.print('\t');
ps.print(exercise);
ps.print('\t');
ps.print(time);
ps.println(); 
```

或者简单地说：

```
PrintStream ps = new PrintStream(fout);
ps.println(name + '\t' + exercise + '\t' + time); 
```

**编辑**

回应您的评论：

> 还有一个问题……有些名字太长了，需要更多标签……我放了 ps.print('\t','\t'); 但它似乎不起作用..

如果这是一个问题，听起来您正试图以您想要显示它们的方式存储它们。我曾假设您正在尝试以易于以编程方式解析的方式存储它们。如果您想将它们存储在列中，我建议使用空格而不是制表符填充。

如果您知道所有列的宽度都将小于 30 个字符，您可以使用 printf 执行以下操作：

```
ps.printf("%30s%30s%30s%n", name, exercise, time); 
```

如果您不习惯，该语法可能看起来很拜占庭式。基本上每个“%30s”都意味着填充字符串参数，使其至少有 30 个字符宽。如果任何值的宽度为 30 或更多字符，您的结果将看起来不正确。如果您无法提前知道，则必须遍历每列中的值以确定列需要多宽。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T14:16:16.633

以这种方式存储数据没有问题。您需要做的就是写出值并用制表符“\t”分隔它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T14:18:19.467

您需要“手动编码”您的格式。最好的方法是将你的文件访问代码包装在某个地方，并创建如下内容：

```
OpenFile()
CreateEntry(name, type, time) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T16:11:00.990

如果要写入固定长度的记录，可以使用 String.[format][1] 方法

```
ps.println(String.format("%20s%20s%20s",name,exercise,time)) 
```

这将创建一个在每个字段中包含 20 个字符的表。[您可以在此处](http://java.sun.com/javase/6/docs/api/java/util/Formatter.html#syntax)阅读语法

[1]： http: [//java.sun.com/javase/6/docs/api/java/lang/String.html#format](http://java.sun.com/javase/6/docs/api/java/lang/String.html#format(java.lang.String) (java.lang.String, java.lang.Object...)

# c++ - lib 读取 DVD FS（数据光盘）

> ID：740169
> 
> 赞同：1
> 
> 时间：2009-04-11T14:19:03.537
> 
> 标签：c++, hardware, io, disk, dvd

我在想我可能想移植一个库来读取 DVD 文件系统。我不是在谈论电影，而是在谈论数据光盘。有现有代码可供我从光盘进行原始读取。我需要请求这些数据并允许我浏览光盘上的文件的代码。我可以为此使用什么库？

-edit- 注意：我使用的是无操作系统硬件。Ppl 似乎错过了这一点，但 Alnitak 抓住了它并给了我一个很好的答案:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T14:33:03.613

您需要`libudf`哪个是 GNU 的一部分[`libcdio`](http://www.gnu.org/software/libcdio/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T14:31:02.650

如果您想浏览文件，为什么不让您的操作系统来完成繁重的工作呢？鉴于现代操作系统已经具备从 DVD 挂载文件系统所需的一切——并且已经有很多人已经在使用和调试此代码，而不是像 libdvdread 这样的用户空间库的更小、更集中的用户群——不利用它们似乎很愚蠢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T14:31:09.577

为什么不直接使用与从硬盘读取文件相同的 I/O 库？

# smalltalk - 当前的 Smalltalk 开发活动

> ID：740175
> 
> 赞同：11
> 
> 时间：2009-04-11T14:23:04.323
> 
> 标签：smalltalk, squeak

我现在已经进入 Smalltalk 学习之旅几个月了。我从一开始就知道，Smalltalk 有几种“方言”（也许“方言”不是最好的词），但我的意思是 VisualWorks、Squeak 和 Dolphin 仅提及三个。到目前为止，我的尝试仅限于 Visualworks 和 Squeak。但我现在发现 Squeak 似乎正在变形（双关语！）成其他几个变体，例如 Tweak、Pharo、Cobalt 和 Croquet。

有人可以解释一下：a) 为什么会出现这些举措（Tweak、Pharo、Croquet 和 Cobalt）？b) 我应该花时间跟上 - 记住我是 Smalltalk 新手？c) 如此不受欢迎的语言为何会出现如此充满活力的发展？d) 还有其他我应该注意的举措吗？（作为初学者而不是计算机研究人员）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-11T19:08:41.343

至于“为什么这种不受欢迎的语言会发生如此充满活力的发展？”，我不得不说“流行”与实用性或生产力无关。逆向者会告诉你，大多数人*总是*错的。

当您被 Smalltalk 虫咬时，您往往会被咬。有许多以前的 Smalltalk 人正在使用其他语言谋生，他们怀念这门语言，并会抓住机会再次在 Smalltalk 中谋生。

这种现象解释了充满活力的社区。

就个人而言，我发现我在 Smalltalk 的工作效率最高。工具和语言一起工作，使想法和执行之间的差距非常小。在 Smalltalk 中，当我面临使用新库时，我可以使用调试器“降落”到操作的中间 - 在单个工具中查看状态和代码。您无法通过阅读代码和研究日志文件来复制这种体验......

Smalltalk 有其怪癖，而这些怪癖确实使 Smalltalk 脱离了主流。但是一些怪癖使 Smalltalk 成为一个高效的工作环境，这可能意味着它永远不会成为主流。

但是有一个充满活力和活跃的社区支持 Smalltalk（在各种方言中），Smalltalk 是否是主流是否重要？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T06:57:08.510

一些背景知识可能会有所帮助：Tweak 是一项研究工作，试图将 Etoys 中的一些很棒的东西带到系统级别（即玩家服装架构、并发模型、“无处不在的事件”、异步通知等）。Tweak 是一种处理图形、合成和脚本的“蓝平面”方法，并且在某些方面从未真正打算成为一种生产工具。它成为一个是它的失败，因为它没有足够的抛光以供广泛使用，并且通过成为一种生产工具，它变得不可行实施一些必要的根本性变化，以使其为世界统治做好准备;-)

槌球有一个完全不同的目标。我们需要 Croquet，因为我们需要一个完全相同的复制计算机。Croquet 在需要修改虚拟机和一些库（例如浮点）的所有平台上进行位相同的计算。Cobalt 是 Croquet 的衍生产品，它采用 SDK 并从中构建应用程序。从这个意义上说，Cobalt 并不是真正的分叉——它是 Croquet 社区当前的焦点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-11T14:33:34.517

这只是展示了 Smalltalk 是多么鼓舞人心的语言，以及它有多么健全和巧妙设计的根源。它激发了从学术界到工业界的人们尝试扩展和构建新的“方言”，然后通常在他们之间进行某种程度的合并，以便最终我们都获利。

这就是我喜欢 Smalltalk 及其社区/社区的原因，即使有时你会在那里感到紧张。但每一个进步都首先需要紧张。

例如，Pharo 就是这种紧张的结果。Pharo 是 Squeak 的一个分支，由一群具有强大领导力和多工作/少说话心态的 Squeakers 组成，这已经显示了结果，如果不是所有的 Smalltalk，它肯定会让 Squeak 更进一步。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-11T14:33:37.730

我不知道你提到的其他举措，但[Pharo](http://pharo-project.org/home)是一个分支，旨在生产一个没有所有杂乱无章的 Squeak 版本（例如 EToys），更好的开发人员支持和使用现代（??）技术，如TrueType 字体。下载当前图像并查看一下非常值得 - 我发现在我的旧硬件上它有点慢，但我打算密切关注它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-30T19:14:23.280

I think there are that initiatives or forks because the community is able to do it :) This small smalltalk community is stuffed up with smart guys that know what they do. There is enough knowledge about virtual machines, language design and such. On the other hand it is like every other community, too. There are people with different opinions. So it is only a matter of time until a few people start "something slightly different" to check/realize their ideas. And they do because they can.

# performance - 当有许多关联时使用像 NHibernate 这样的 ORM - 性能问题

> ID：740180
> 
> 赞同：0
> 
> 时间：2009-04-11T14:28:14.780
> 
> 标签：performance, nhibernate, web-applications, orm

我创建了一个应用程序（基于 Web 的应用程序），它现在具有大量关联。简单地说，一个帐户：

*   有很多用户
*   有设置
*   有很多项目

同样的一个项目：

*   有很多项目

一个用户：

*   有很多任务

等等，加载更多的关联。我希望没有什么特别不寻常的。我选择使用 NHibernate 为我提供一组不错的持久类，其中映射器定义了所有关联。

但这种方法对吗？在对应用程序的每次请求时，都会加载帐户（因为需要它），然后从数据库中请求大量不需要的数据。延迟加载是一种选择，但我不知道我的初始方法是否更好。在那个阶段我想要的只是帐户和相关设置，那么映射是否应该反映这一点？麻烦的是我想要在其他点上的所有项目之类的东西，所以我需要映射器来反映所有的关联。

我担心延迟加载可能只是为了弥补我糟糕的初始架构。我很清楚这可能只是由于我对 NHibernate 的内部工作原理知之甚少。因此，我将不胜感激任何关于良好实践的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T14:34:04.670

默认情况下，使用 NHibernate 为大多数关联和对象启用延迟加载通常是一种很好的做法，除非您知道您总是需要关联的数据。然后，当您进入优化阶段时，您可以选择性地切换到预先加载的项目，这样效率更高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T14:45:15.363

在理解这些情况时，领域驱动设计对我帮助很大。[DDD 中的关联](http://stochastyk.blogspot.com/2008/06/associations-in-domain-driven-design.html)

在您的情况下您应该问自己的问题：您真的需要双向关联 - 或者在某些情况下单向关联就足够了吗？这个决定是架构的一部分。所以你是对的。默认情况下选择双向关联时，延迟加载有很大帮助。但它可以被认为是一个设计缺陷。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T14:48:52.827

好吧，在我看来，你的架构看起来很健康。协会很好。

考虑替代方案：

1.  更少的关联：会导致糟糕的数据库设计
2.  不要使用 ORM：你会发现自己在做“延迟初始化”——反正有点编码

一切看起来都很好，延迟初始化也很好:) - 但是，有很多现实生活中的使用陷阱：

1.  在使用延迟初始化的东西之前不要关闭会话（需要你“破解”一些关于你的关联的无用阅读语句来强制阅读它）
2.  使用 NHibernate，您需要使用它执行所有 DAL 活动才能启用二级缓存
3.  你会有一些开销（如果我不想知道帐户名，只知道其中的用户怎么办）

这就是 ORM 的工作方式。他们有 pro（更容易开发，避免大量样板代码）和 con（更多开销，更少灵活性）。

# apache-flex - 弹性事件处理

> ID：740181
> 
> 赞同：0
> 
> 时间：2009-04-11T14:28:59.973
> 
> 标签：apache-flex, actionscript, event-handling

我为特定事件添加了一个事件侦听器，例如 CollectionEvent.COLLECTION_CHANGE。在该事件侦听器中，基于特定条件，我想调用该事件的默认事件处理程序。这怎么可能？我能想到的一种方法是：

在事件监听器内部：

```
If(Condition)
{
  Remove event listener
  dispatch event
  add event listener again
} 
```

这会导致事件溢出，这意味着删除事件侦听器不起作用。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T16:31:06.497

您可以添加多个事件侦听器。似乎您想阻止某个事件在某些条件下传播。为此，您需要其中之一：

停止传播（）

停止立即传播（）

# mysql - 获取触发器以仅在审计表中插入更改的列值

> ID：740182
> 
> 赞同：0
> 
> 时间：2009-04-11T14:30:01.390
> 
> 标签：mysql, triggers, audit-tables

我正在使用触发器将更改存储在审计表中，我只想存储已更改列中的值。

```
BEGIN
IF NEW.history_of_repair_trigger_fired = 1 THEN
INSERT INTO history_of_repair SET
edit_date_time=NEW.last_edited_date_time,
edited_by=NEW.edited_by,
repair_id=NEW.repair_id,
tenant_name=NEW.tenant_name,
property_id=NEW.property_id,
priority=NEW.priority,
comments=NEW.comments,
signed_off=NEW.signed_off;
END IF;
END 
```

目前这也将未更改的值存储在审计表中，这是不可取的。

仅将更改的列存储在我的审计表中的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T15:58:18.167

根据您的评论，我不会担心只存储更改的值——磁盘空间很便宜。存储实际值的好处是，如果您需要赶时间，可以轻松地将记录恢复到某个时间点。如果您需要生成人类可读的审计记录，请将其存储在 varchar/nvarchar 中，并通过将更改累积到字符串中来在触发器中构造消息。除了实际值之外，我可能还会存储它。请注意，您还可以提供一个表值函数，该函数为您动态构建这个人类可读的列，而不是存储它。

# css - 关于 XSL 中文本的布局和边距的问题

> ID：740186
> 
> 赞同：0
> 
> 时间：2009-04-11T14:31:24.070
> 
> 标签：css

我关于在网页上正确布局文本的另一个问题。我想编写 RSS 代码，然后使用 XSL 将 RSS 格式化为 HTML 我的问题：

为什么 ITEM DESCRIPTION 的文字超出了网页的边缘？如何强制那段文本保持在边距内？ [用完保证金 http://i40.photobucket.com/albums/e236/ngquochung86/somemargin.jpg](http://i40.photobucket.com/albums/e236/ngquochung86/somemargin.jpg)

我的 XML 代码：

```
<channel>
 .......
  <description>
   CHANNEL DESCRIPTION: Website of New York Times
  </description>
  <item>
    <title>
      ITEM TITLE:YouTube and Universal to Create a Hub for Music
    </title>
    <link>
     <a href="http://www.nytimes.com/2009/04/10/technology/internet/10google.html?ref=technology"/>
    </link>
    <description>
     CHANNEL DESCRIPTION: The agreement is an effort by YouTube, which is owned by Google, to put more professionally produced content in front of its huge audience, and in turn, earn more money from advertising.
    </description>
  </item> 
```

我的 XSL 代码：

```
<span class="channelDescription"> <xsl:value-of select="channel/description"/></span>
           <xsl:for-each select="channel/item">
              <span class="itemTitle"><xsl:value-of select="title"/></span>
              <span class="itemLink"><xsl:value-of select="link"/></span>
              <span class="itemDescription"><xsl:value-of select="description"/></span>
           </xsl:for-each> 
```

你能帮帮我吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T15:01:44.137

就像 AnthonyWJones 所说，这似乎是一个 CSS/HTML 问题。一旦使用 XSLT 将 RSS 提要转换为 HTML，它就会被简单地视为（并因此呈现）为标准 HTML 文档。

在这一点上，我最好的猜测是，您需要在描述（或整个文档）周围放置一个容器（块级元素，例如**<DIV>** ）并使用 CSS 为其指定在显示尺寸范围内的宽度.

所以这样的事情应该有效：

```
<style type="text/css">
#container {
    width: 90%;
}
</style>
<div id="container">
    // Your XSL code
</div> 
```

# c# - C# 和 Java 之间的随机行为差异：种子

> ID：740190
> 
> 赞同：1
> 
> 时间：2009-04-11T14:31:45.253
> 
> 标签：c#, java, math

我有一个 Random 到一个旨在在不同上下文中生成随机序列的类：这是从 Java 代码移植的结果。在 Java 版本中一切正常，因为 java.lang.Random 类具有方法 setSeed，它允许动态更改种子值。

```
Random rnd = new Random();
...
rnd.nextInt();
...
rnd.setSeed(seedValue); 
```

这会产生一致的结果，因为每次设置种子值时，结果都是随机的。

不幸的是，在 C# 中，行为有很大不同，因为 Random 类需要在构造时设置种子：

```
Random rnd = new Random(seedValue);
...
rnd.Next();
... 
```

所以我每次都必须使用给定的种子构建一个新的 Random 实例，在某些备用情况下，它会生成与先前调用相同的值。

是否可以在 C# 中动态设置 Random 实例的种子，而不会失去全局实例的一致性？

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T14:39:44.720

通常，我为我的应用程序创建一个 Random 实例，并且在实例化设置种子后，可以依靠对 Next 的每次调用给我一个新的随机数。诀窍是确保种子尽可能随机。在 C# 应用程序中使用 Random 是单例非常适合的一个很好的例子。

有多种方法可以在种子中获得不同强度的随机性，并且有一些很好的 SO 问题可以解决这个问题。

下面的示例是我使用的方法。

```
m_randomURL = "https://www.random.org/cgi-bin/randnum?num=1&min=1&max=1000000000";
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(m_randomURL);
StreamReader stIn = new StreamReader(req.GetResponse().GetResponseStream());
Random rand = new Random(Convert.ToInt32(stIn.ReadToEnd())); 
```

random.org 使用大气噪声来产生随机性，显然用于彩票等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T14:38:53.600

尝试将 Random 实例包装为伪代码：

```
class MyRandom {
   private Random random;

   public void setSeed(long seed) {
        random = new Random(seed);
        ...

   public long next() {
        return random.next(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T15:53:54.370

首先，我不希望在运行时多次`setSeed`调用 a `Random`。*FreeCell*这样做是为了让您可以通过记下所使用的种子来“加载”游戏实例。

如果您更改种子，它应该就像*重置*Random 实例一样，因此如果您重新实例化它应该没有冲突。`Random`只是底层算法的包装器。

如果你想每次都收到不同的结果（即使你使用 setSeed），你可以试试这个：

```
class MyRandom {
  private Random random = new Random(DateTime.Now.Ticks);

  public void setSeed(long seed) {
    random = new Random(seed * this.random.next());
    ...

  public long next() {
    return random.next();
}

class MyClass {
  private MyRandom random = new MyRandom();
  public void Test() {
    random.setSeed(seedValue);
    int x = random.next();
    random.setSeed(seedValue);
    int y = random.next();
    // x,y will be different in most of the cases now
  }
} 
```

这将改变随机生成器的种子应该如何工作的前置/后置条件，但可能对您有用。

# user-interface - GUI 模式问题：PropertyChangeListener 与专用视图接口

> ID：740191
> 
> 赞同：0
> 
> 时间：2009-04-11T14:32:50.820
> 
> 标签：user-interface, language-agnostic, design-patterns

我想通过界面将模型与它的视图配对。我想控制视图更新的时间和频率。所以像 PropertyChangeListener 这样的东西不能很好地工作（在设置每个属性后触发一个事件）。

我不是为特定的 GUI 框架开发的。这里的目标是能够交换不同的 GUI 前端（现在用于测试，但以后可能对不同版本的应用程序有用）。这些可能是 Swing，也可能是 Web 浏览器（例如，通过 GWT）。

下面是我的方法。视图实现了一个接口来提供更新的方法。这由控制器在确定模型更新完成时触发。这对我来说仍然感觉不错，因为控制器只是通过模型与视图交互，控制器不依赖于视图的特定实现。

所以，我想我的问题是

*   这行得通吗？
*   这是标准做法吗？
*   这种模式有名字吗？

粗略的代码示例（Java）：

```
// Controller, manages Items (the model)
class ItemList {

   void addItem(Item item) {
   }

   void doStuffWithItems() {

     // perform some set of operations, such as sorting or layout
     for (Item item : items) {
       // ....
     }

     // now with everything in it's final position:
     for (Item item : items) {
       item.updateView();
     }
   }
}

// Model
class Item {
  private int top;
  private int left;
  private int width;
  private int height;

  // Can remember it's previous position/size:
  public void savePostion() {
  }

  // And recall it for the Controller to use:
  public public Position getSavedPosition() {
  }

  // Plus some other useful functions:
  public boolean intersectsWith(Item other) {

  }

  public void updateView() {
    this.view.update();
  }

  void setView(ItemView view) {
    this.view = view;
  } 
}

// Interface used by View implementations
public interface ItemView {
  // Trigger the view to reflect the current state of the model
  void update();
}

// Example, as a Swing component
class ItemComponent extends JComponent implements ItemView {
  private Item item;

  public ItemComponent(Item item) {
    this.item = item;
    item.setView(this);
  }

  // ItemView#update
  public void update() {
    // update the component's size/position
    setBounds(new Rectangle(item.getLeft(), item.getTop(), item.getWidth(), item.getHeight()));
  }

  @Override
  public void paint(Graphics g) {
    // ...
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T15:15:11.577

我会避免强制 View 只为更改通知实现一个接口。而是在模型上创建一个单独的“立即更新”事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T16:17:35.953

模型不应该直接控制或了解视图。视图应该向控制器注册一个回调，以便控制器可以告诉视图何时更新，这就是它的控制器。您可以让模型允许 modelChangedEvent 的外部侦听器。然后视图可以在这方面向模型注册，而模型不知​​道有视图。请参阅 MVC 的 J2EE[蓝图](http://java.sun.com/blueprints/patterns/MVC-detailed.html)以及模型中状态更改的间接事件通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T19:33:57.633

对于在计算机桌面上运行的传统应用程序，我建议使用[Passive View](http://www.martinfowler.com/eaaDev/PassiveScreen.html)的变体。负责创建和管理表单的类是一个将事件传递给 UI 对象的瘦壳。UI_Object 通过接口与表单交互。在术语中，UI 对象实现了一个 UI_View 接口并将其自身注册到位于对象层次结构中较低的视图控制器。

UI_Object 然后执行实现修改模型的[命令模式的对象。](http://en.wikipedia.org/wiki/Command_pattern)命令对象可以通过视图控件公开的接口与各种视图交互。

这样做是允许您撕掉表单类并将它们替换为实现表单接口的存根类。存根类用于自动化测试，尤其是集成测试。

这些接口精确地定义了 Form、UI_Object、Commands 和视图之间的交互。它们可以设计为与语言无关，因此它们可以使平台之间的移植更容易。

您在示例中缺少的是命令对象。你需要这个结构

*   项目视图表单
*   ItemView 实现
*   ItemViewForm接口
*   项目视图命令
*   项目视图接口
*   我的模型

将 ItemList 合并到 ItemViewImplementation

ItemComponent 将使用 ItemViewInterface 向 ItemViewImplementation 注册。

事件的顺序看起来像这样

*   用户想要更新项目
*   点击 UI（假设 UI 涉及用鼠标点击）
*   Form 通过 ItemViewInterface 告诉 ItemViewImplementation X 已经使用 Y 参数完成。
*   然后 ItemViewImplementation 使用 Y 所需的参数创建一个命令对象。
*   命令对象接受 Y 参数修改模型，然后告诉
*   ItemViewImplementation 通过 ItemViewInterface 来更新 UI。
*   ItemViewImplementation 告诉 ItemViewForms 通过 ItemViewFormInterface 更新 UI。
*   ItemViewForms 更新。

这种方法的优点是每一层的交互都是通过接口精确定义的。软件操作被本地化为命令对象。表单层专注于显示结果。View 层负责在 Commands 和 Forms 之间路由动作和响应。命令是唯一修改模型的东西。此外，您还可以利用表单实现来替换您想要的任何 UI，包括用于单元测试的模拟对象。

# javascript - 将选项添加到使用 jQuery？使用 jQuery 向下拉列表添加选项的最简单方法是什么？这行得通吗？$("#mySelect").append('<option value=1>我的选项</option>'); 效果很好。如果添加多个选项元素，我建议执行一次附加，而不是对每个元素执行附加。如果选项名称或值是动态的，您就不必担心转义其中的特殊字符；在这种情况下，您可能更喜欢简单的 DOM 方法： var s= document.getElementById('myS

> ID：740195
> 
> 赞同：843
> 
> 时间：2009-04-11T14:34:04.563
> 
> 标签：javascript, jquery, html-select

* * *

## 回答 #1

> 赞同：946
> 
> 时间：2013-01-21T21:01:00.843

就个人而言，我更喜欢这种语法来附加选项：

```
$('#mySelect').append($('<option>', {
    value: 1,
    text: 'My option'
})); 
```

如果您要从一组项目中添加选项，您可以执行以下操作：

```
$.each(items, function (i, item) {
    $('#mySelect').append($('<option>', { 
        value: item.value,
        text : item.text 
    }));
}); 
```

* * *

## 回答 #2

> 赞同：368
> 
> 时间：2010-01-29T14:37:36.943

这在 IE8 中不起作用（但在 FF 中起作用）：

```
$("#selectList").append(new Option("option text", "value")); 
```

这确实有效：

```
var o = new Option("option text", "value");
/// jquerify the DOM object 'o' so we can use the html method
$(o).html("option text");
$("#selectList").append(o); 
```

* * *

## 回答 #3

> 赞同：131
> 
> 时间：2013-09-07T22:21:44.430

您可以使用以下语法添加选项，也可以访问[jQuery 中的方式处理选项以](http://mycodeprograms.blogspot.in/2013/09/how-to-handle-select-and-option-tag-in.html)获取更多详细信息。

> 1.  `$('#select').append($('<option>', {value:1, text:'One'}));`
>     
>     
> 2.  `$('#select').append('<option value="1">One</option>');`
>     
>     
> 3.  `var option = new Option(text, value); $('#select').append($(option));`

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2009-04-11T15:46:30.410

如果选项名称或值是动态的，您就不必担心转义其中的特殊字符；在这种情况下，您可能更喜欢简单的 DOM 方法：

```
var s= document.getElementById('mySelect');
s.options[s.options.length]= new Option('My option', '1'); 
```

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2016-05-23T04:15:15.623

## 选项1-

你可以试试这个-

```
$('#selectID').append($('<option>',
 {
    value: value_variable,
    text : text_variable
})); 
```

像这样-

```
for (i = 0; i < 10; i++)
{ 
     $('#mySelect').append($('<option>',
     {
        value: i,
        text : "Option "+i 
    }));
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<select id='mySelect'></select>
```

## 选项 2-

或者试试这个——

```
$('#selectID').append( '<option value="'+value_variable+'">'+text_variable+'</option>' ); 
```

像这样-

```
for (i = 0; i < 10; i++)
{ 
     $('#mySelect').append( '<option value="'+i+'">'+'Option '+i+'</option>' );
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<select id='mySelect'></select>
```

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2017-11-07T16:29:22.070

这很简单：

```
$('#select_id').append('<option value="five" selected="selected">Five</option>'); 
```

或者

```
$('#select_id').append($('<option>', {
                    value: 1,
                    text: 'One'
                })); 
```

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2009-04-11T14:51:44.800

效果很好。

如果添加多个选项元素，我建议执行一次附加，而不是对每个元素执行附加。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2009-04-18T19:14:54.013

无论出于何种原因`$("#myselect").append(new Option("text", "text"));`，在 IE7+ 中对我都不起作用

我不得不使用`$("#myselect").html("<option value='text'>text</option>");`

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2014-03-08T13:59:32.927

为了提高性能，您应该尝试只更改一次 DOM，如果您要添加许多选项，则更应如此。

```
var html = '';

for (var i = 0, len = data.length; i < len; ++i) {
    html.join('<option value="' + data[i]['value'] + '">' + data[i]['label'] + '</option>');
}           

$('#select').append(html); 
```

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2013-02-12T14:53:31.077

```
$('#mySelect').empty().append('<option value=1>My option</option>').selectmenu('refresh'); 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2015-08-03T16:05:47.070

我喜欢使用非 jquery 方法：

```
mySelect.add(new Option('My option', 1)); 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2014-08-11T07:38:47.970

```
var select = $('#myselect');
var newOptions = {
                'red' : 'Red',
                'blue' : 'Blue',
                'green' : 'Green',
                'yellow' : 'Yellow'
            };
$('option', select).remove();
$.each(newOptions, function(text, key) {
    var option = new Option(key, text);
    select.append($(option));
}); 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2017-05-19T07:07:58.570

您可以将选项动态添加到下拉列表中，如下例所示。在此示例中，我获取了数组数据并将这些数组值绑定到下拉列表，如输出屏幕截图所示

**输出：**

[![在此处输入图像描述](https://i.stack.imgur.com/nwIkW.png)](https://i.stack.imgur.com/nwIkW.png)

```
var resultData=["Mumbai","Delhi","Chennai","Goa"]
$(document).ready(function(){
   var myselect = $('<select>');
     $.each(resultData, function(index, key) {
	     myselect.append( $('<option></option>').val(key).html(key) );
       });
      $('#selectCity').append(myselect.html());
});
```

```
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.min.js">
</script>

<select  id="selectCity">

</select>
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2020-09-25T15:48:31.663

为什么不简单呢？

```
$('<option/>')
  .val(optionVal)
  .text('some option')
  .appendTo('#mySelect') 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2014-06-18T08:57:11.503

任何答案中都没有提到，但有用的是您希望该选项也被选中，您可以添加：

```
var o = new Option("option text", "value");
o.selected=true;
$("#mySelect").append(o); 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2017-11-29T10:29:39.350

有两种方法。您可以使用这两个中的任何一个。

第一的：

```
$('#waterTransportationFrom').append('<option value="select" selected="selected">Select From Dropdown List</option>'); 
```

第二：

```
$.each(dataCollecton, function(val, text) {            
    options.append($('<option></option>').val(text.route).html(text.route));
}); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2014-01-22T09:14:49.357

如果要在选择中的特定索引处插入新选项：

```
$("#my_select option").eq(2).before($('<option>', {
    value: 'New Item',
    text: 'New Item'
})); 
```

这将插入“新项目”作为选择中的第三个项目。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2018-03-27T07:49:28.177

> *这个怎么样*

```
var numbers = [1, 2, 3, 4, 5];
var option = '';

for (var i=0;i<numbers.length;i++){
     option += '<option value="'+ numbers[i] + '">' + numbers[i] + '</option>';
    }

    $('#items').append(option); 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2017-01-04T10:47:35.773

当您附加选项并使用 jquery validate 时，我们发现了一些问题。您必须单击多选列表中的一项。您将添加此代码来处理：

```
$("#phonelist").append("<option value='"+ 'yournewvalue' +"' >"+ 'yournewvalue' +"</option>");

$("#phonelist option:selected").removeAttr("selected"); // add to remove lase selected

$('#phonelist option[value=' + 'yournewvalue' + ']').attr('selected', true); //add new selected 
```

[![https://i.stack.imgur.com/HOjIY.png](https://i.stack.imgur.com/HOjIY.png)](https://i.stack.imgur.com/HOjIY.png)

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2015-11-12T18:55:38.183

您可以使用文本附加和设置 Value 属性：

```
$("#id").append($('<option></option>').attr("value", '').text(''));
$("#id").append($('<option></option>').attr("value", '4').text('Financial Institutions')); 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2014-10-01T07:32:54.610

if u have **optgroup** inside **select**, u got error in DOM.

I think a best way:

```
$("#select option:last").after($('<option value="1">my option</option>')); 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2017-11-06T21:40:32.907

```
$('#select_id').append($('<option>',{ value: v, text: t })); 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2018-03-08T19:25:45.203

我就是这样做的，用一个按钮来添加每个选择标签。

```
$(document).on("click","#button",function() {
   $('#id_table_AddTransactions').append('<option></option>')
} 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2018-08-17T08:19:32.587

您可以在 ES6 中执行此操作：

```
$.each(json, (i, val) => {
    $('.js-country-of-birth').append(`<option value="${val.country_code}"> ${val.country} </option>`);
  }); 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2018-09-18T13:39:26.160

根据dule对附加项目集合[的回答，](https://stackoverflow.com/a/14447147/6225838)**单行[`for...in`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...in)**也可以创造奇迹：

```
let cities = {'ny':'New York','ld':'London','db':'Dubai','pk':'Beijing','tk':'Tokyo','nd':'New Delhi'};

for(let c in cities){$('#selectCity').append($('<option>',{value: c,text: cities[c]}))}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.0/jquery.min.js"></script>
<select  id="selectCity"></select>
```

对象值和索引都分配给选项。这个解决方案甚至适用于旧的[jQuery (v1.4)](https://ajax.googleapis.com/ajax/libs/jquery/1.4.0/jquery.min.js)！

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2018-12-11T20:57:42.633

If someone comes here looking for a way to add options with data properties

Using **attr**

```
var option = $('<option>', { value: 'the_value', text: 'some text' }).attr('family', model.family); 
```

Using **data** - version added 1.2.3

```
var option = $('<option>', { value: 'the_value', text: 'some text' }).data('misc', 'misc-value); 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2017-11-25T02:11:54.557

这只是获得最佳性能的快速要点

总是在处理许多选项时，构建一个大字符串，然后将其添加到“选择”以获得最佳性能

fg

var $mySelect = $('#mySelect'); var str = '';

```
$.each(items, function (i, item) {
    // IMPORTANT: no selectors inside the loop (for the best performance)
    str += "<option value='" + item.value + "'> " + item.text + "</option>";
});
// you built a big string

$mySelect.html(str); // <-- here you add the big string with a lot of options into the selector.
$mySelect.multiSelect('refresh'); 
```

## 甚至更快

```
var str = ""; 
for(var i; i = 0; i < arr.length; i++){
    str += "<option value='" + item[i].value + "'> " + item[i].text + "</option>";
}    
$mySelect.html(str);
$mySelect.multiSelect('refresh'); 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2018-05-13T17:00:36.053

```
$(function () {
     var option = $("<option></option>");
     option.text("Display text");
     option.val("1");
     $("#Select1").append(option);
}); 
```

如果您从某个对象获取数据，那么只需将该对象转发给函数......

```
$(function (product) {
     var option = $("<option></option>");
     option.text(product.Name);
     option.val(product.Id);
     $("#Select1").append(option);
}); 
```

Name 和 Id 是对象属性的名称......所以你可以随意调用它们......当然，如果你有 Array......你想用 for 循环构建自定义函数......然后只需调用该函数文件准备好了……干杯

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2020-07-20T19:17:19.573

尝试

```
mySelect.innerHTML+= '<option value=1>My option</option>'; 
```

```
btn.onclick= _=> mySelect.innerHTML+= `<option selected>${+new Date}</option>`
```

```
<button id="btn">Add option</button>

<select id="mySelect"></select>
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2016-08-14T08:06:48.943

你可以尝试下面的代码附加到选项

```
 <select id="mySelect"></select>

    <script>
          $("#mySelect").append($("<option></option>").val("1").html("My enter code hereoption"));
    </script> 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-06-19T08:01:27.457

> 只需一行

```
 $.each(result, function (k,v) {
                         **if(k == selectedMonthNumber) var selectedMonth = 'selected'; else var selectedMonth = '';**
                             $("#periodMonth").append($('<option>', {
                                 value: k,
                                 text: v,
                                 **selected: selectedMonth**
                         }));
                    }) 
```

# c# - 您如何使用新的复杂绑定语法处理删除项目？

> ID：740201
> 
> 赞同：0
> 
> 时间：2009-04-11T14:36:37.660
> 
> 标签：c#, asp.net-mvc, data-binding, forms

你们中的许多人可能已经注意到，从 RC1 开始，您不必包含 .Index 隐藏字段来启用复杂的模型绑定。然而，缺点之一是现在您必须让索引从 0 开始，并且不能中断。例如。从 4 跳到 6 等。

使用旧语法，我可以从 DOM 中删除项目，当表单提交时，除了已删除的项目之外的所有项目都已发布。但是，如果我删除索引 5，则使用新语法，则只会发布 0-4，因为索引已损坏。

您现在如何处理从列表中删除项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T14:44:32.913

是的，“完整索引”是个麻烦事！我在我的项目中有两种处理方法：

第一种方法是让客户端上的删除方法用来自服务器的新 html 替换整个列表。这对于小型列表来说很好，而且很“容易”，因为索引序列是在服务器上重新生成的。

使用较大的列表但效率不高，在这种情况下，我更喜欢在客户端使用 jquery 重新排序索引。

# mysql - 书店数据库设计

> ID：740204
> 
> 赞同：3
> 
> 时间：2009-04-11T14:37:05.430
> 
> 标签：mysql, database, database-design, modeling

我要建立一个书店，其中我们有 3 个实体（类）：卖方、买方、图书。我将数据库设计为以下细节：
- 买家和卖家都可以分别购买/出售一本或多本书。
- 如果买家想卖一本书，他/她需要一个卖家账户。
- 买家将提供他们的价格，卖家想卖给最好的买家，我必须保存其中的所有信息。

```
在此模型中，*流程*类将是其他三个类的连接器：
    卖家书买家
   -------- ------ --------
     sID* bID* 按ID*
     名称 --> sID     

这是我的第一个想法，然后我发现这个模式在这个过程中会失败，因为买家可以同时购买多本书，还有其他原因。所以我改变了它：

```
在此模型中，*流程*类将是其他三个类的连接器：
     ______ ______ ________ _______
    |卖家| | 书 | |工艺 | | 买家 |
    -------- -------- ---------- ---------
    | 身份证* | | 出价* | | 身份证* | | 按ID* |
    | 姓名 | | XXX | --> | 标识 | |日期&..|
                              ----------
(*) 表示主键  

```

我认为这会更好，但是如何开始使用**价格优惠**？

是的，我可以在*流程*类中添加一个报价，所以我改变了主意，这个模型就出现了：（对不起，描述太长了）

*Offer* 字段将被添加到 *process* 类中：
     ______ ______ _________ _______  
    |卖家| | 书 | |工艺 | | 买家 |
    -------- -------- ------------ ---------  
    | 身份证* | | 出价* | | 身份证* | | 按ID* |   
    | 姓名 | | XXX | --> | 标识 | | 报价 |
                              | 日期&..|
                              ------------       
(*) 表示主键  

```

由于这是我的第一次，我对数据库设计感到非常困惑。这会满足系统需求吗？如果没有，我怎样才能让它工作？如果有，有没有更好的设计？

任何建议表示赞赏，在此先感谢:)

*更新*- 我真的无法在这里选择最佳答案，一切都有帮助。很多很多谢谢你们。希望你最好^o^

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T14:40:43.877

如果买方可以是卖方（反之亦然），为什么不使用一个带有一组帐户类型标志的客户表呢？

如果书籍是唯一的（即，Moby Dick 的一份副本与另一份副本分开查看......更像 eBay 而不是亚马逊），那么您的 book 表可能有一个买方和卖方外键。您的商店最简单的设计现在只剩下两张桌子。例如：

```
Cust table
cust_id
name
is_buyer
is_seller

Book table
book_id
description
seller_cust_id
buyer_cust_id 
```

**编辑**：即使一个买家/卖家必须有两个账户，我认为这个解决方案也不会改变。您只需在您的应用程序中添加客户不能既是买家又是卖家的限制。一张桌子的好处是您不需要复制安全/登录/等。逻辑...

**编辑2**：另外，如果买家可以购买多本书，那么拥有一个购物车表来存储买家购买的每本书不是更有意义吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T14:59:54.720

我认为您需要一个类似于以下的域模型：

```
Buyer(BuyerId, ... buyer details ... )
Seller(SellerId, ... seller details ... )
Book(BookId, ... book details ... )
Bid(BidId, BuyerId, BookId, Price, Expiry)
Offer(OfferId, SellerId, BookId, Price, Expiry 
```

它的工作原理是用户（买方或卖方）可以根据需要创建出价或出价。因此，如果您是买家，您可以从搜索可用的优惠开始。如果你喜欢一个，你可以选择接受它并继续结帐。也许您不太喜欢任何优惠，但价格接近您想要的。您可以创建一个出价并将其发送给要约的创建者以供考虑。

或者，如果没有任何东西符合您作为买家的要求，您可以创建一个投标并将其留在系统中，供潜在卖家浏览/搜索并考虑直到您选择的到期时间。

我添加了 Bid 和 Offer 类，我认为它们的好处是不言自明的。但是，如果您想进一步解释，请随时发表评论，我会回复。Expiry 字段不是必需的，但很可能每个 Bid 和 Offer 都会有时间限制，在这种情况下您将需要它们。

我增加了类/表的数量，但我认为您会发现您的系统变得更易于管理和扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T00:53:16.673

看起来确实有点令人困惑，数据模型、对象模型、功能性和非功能性规范和要求——每个部分都在讨论中。保持符号和设计元素干净、清晰和分开。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T14:54:23.267

如果我理解正确，买家会在任何卖家做任何事情之前发出报价。然后卖家可以接受其中一个待处理的报价。我会在流程中添加一个买家 ID（实际上，当买家提出报价时会创建一个流程），以及图书 ID 和报价。一旦卖家完成交易，该过程可以通过 sID 字段链接到卖家。通过这种方式，买家可以在不同的书籍上同时持有多个报价。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T14:55:05.120

将 LuckyLindy 的评论更进一步，使用单个 Customer 表，创建一个名为 Order 的表（可能类似于您的 Process 表）和一个名为 OrderItem 的表。您的买家和卖家都是客户......如果您的订单严格在两个人之间，那么您的订单表可以包含买家和卖家字段。对于 Order 中的每个项目，您在 OrderItem 中有一个元组（带有返回 Order 的 ID 以绑定组）。

```
Customer    Order         OrderItem
--------    -----------   ---------
id          id (pk)       id
name        date          order_id (fk)
            buyer (fk)    book
            seller (fk)   price
            total 
```

这确实是一个基本示例，但它正在形成您的需求可以只使用一个常见的购物车设计。您可以通过 Google 搜索找到很多[示例](http://www.phpwebcommerce.com/shopping-cart-database-design.php)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T15:09:32.263

好吧，根据规范，我会做出一些假设：

*   买家和卖家需要单独的账户——所以他们*必须*是原子的并且不能共享数据，因此我们将有两个表。
*   一本书是一个真实世界的实例。因此，如果卖家想要出售 3 本书《霍比特人》，那将导致 3 个表格行。
*   因此，这本书可能会涉及属性：（`seller`只读）和`buyer`. 但这不适用于等待买家报价的“过程”。
*   `AuctionProcess`由于可能有“批次”的图书购买，因此创建一个实体是有意义的。另外我会添加另一个`Bid`实体。这导致以下方案。

    ```
    Seller(id*)
    Buyer(id*)
    Book(id*, seller_id)
    AuctionProcess(id*, book_id, winning_bid_id, end_date, start_date?)
    Bid(id*, process_id, buyer_id, price) 
    ```

    `winning_bid_id`当然，`NULL`直到买家选出获胜者。

它与（刚刚注意到）Ankur 的响应非常相似，只是增加了`winning_bid_id`关系。

# mysql - MySQL中的作用域/复合代理键

> ID：740211
> 
> 赞同：0
> 
> 时间：2009-04-11T14:40:47.540
> 
> 标签：mysql, transactions, innodb, auto-increment, composite

这是我当前数据库的摘录（更改了表名以便于理解）：

```
Pet(ownerFK, id, name, age)
Owner(id, name) 
```

Where`id`总是一个代理键，用`auto_increment`.

我想让代理键`Pet.id`被“限定”`Pet.ownerFK`或换句话说，有一个复合键`[ownerFk, id]`作为我的最小键。我希望表的行为如下：

```
INSERT Pet(1, ?, "Garfield", 8);
INSERT Pet(1, ?, "Pluto", 12);
INSERT Pet(2, ?, "Mortimer", 1);

SELECT * FROM Pet;
  RESULT:
   Pet(1, 1, "Garfield", 8)
   Pet(1, 2, "Pluto", 12)
   Pet(2, 1, "Mortimer", 1) 
```

我目前正在使用[MyISAM 的此](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)[*功能*](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)，其中“您可以`AUTO_INCREMENT`在多列索引中的辅助列上指定。在这种情况下，该`AUTO_INCREMENT`列的生成值计算为`MAX(auto_increment_column) + 1 WHERE prefix=given-prefix`。当您要将数据放入有序组时，这很有用。”

但是，由于各种（也许是显而易见的）原因，我想从 MyISAM 切换到 InnoDB，因为我需要在某些地方进行事务。

**有什么方法可以用*InnoDB*达到这个效果吗？**

我发现了一些关于这个问题的帖子，其中许多建议在插入之前对表进行写锁定。我对此不是很熟悉，但是对于这个来说，这不会是一个表写锁的大修吗？如果可能的话，我宁愿考虑使用写安全事务（我以前从未做过）——将 a`Owner.current_pet_counter`作为辅助字段。

*所以另一个可接受的解决方案是......*

实际上，我不需要“作用域”ID 成为实际密钥的一部分。我实际的数据库设计使用了一个单独的“永久链接”表，它使用了这个“功能”。我目前使用它作为丢失交易的解决方法。我想到了以下替代方案：

```
 Pet(id, ownerFK, scopedId, name, age), KEY(id), UNIQUE(ownerFK, scopedId)
 Owner(id, name, current_pet_counter)

 START TRANSACTION WITH CONSISTENT SNAPSHOT;
 SELECT @new=current_pet_counter FROM Owner WHERE id = :owner_id;
 INSERT Pet(?, :owner_id, @new, "Pluto", 21);
 UPDATE Owners SET current_pet_counter = @new + 1 WHERE id = :owner_id;
 COMMIT; 
```

我还没有在 MySQL 中使用过 transactions/transactionvars，所以我不知道这个是否会有严重的问题。 *注意：*我不想重复使用`id`曾经给宠物的 s。这就是为什么我不使用`MAX()`. **这个解决方案有什么注意事项吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T15:57:16.967

我不相信。如果您确实必须拥有该架构，则可以使用事务来选择 MAX(id) WHERE ownerFK，然后插入。

不过，我非常怀疑这种模式是否有充分的理由；主键现在也是关于键的事实，这可能会让数据库理论家不高兴。

通常，您希望 'id' 本身真的是一个正确的主键，ownerFK 用于分组，如果需要，一个单独的 'rank' 列用于将宠物按每个所有者的特定顺序排列，以及一个 UNIQUE索引超过（ownerFK，rank）。

# asp.net - 为 asp.net webforms 应用程序实现插件架构的最佳方法是什么？

> ID：740214
> 
> 赞同：0
> 
> 时间：2009-04-11T14:42:22.640
> 
> 标签：asp.net, architecture, plugins

我们有一个用 ASP.Net Webforms 编写的 3 层 Web 应用程序，我们将无法移植它 - 经济衰退真的很糟糕！- 到 MVC。我们的目标是实现一个插件架构。一种方法是使用 App_Code 文件夹。有没有更好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T14:52:40.413

我的插件架构是在一个完全独立的解决方案中开发的。我在我的 Web 项目中包含了对库的引用。我使用在 Application_Start 中运行的插件管理器并从 web.config 文件加载插件配置。配置指定正在使用的实际插件的全名，并使用 Activator.CreateInstance 来实例化插件。所有插件都实现了一个 IPlugin 接口以及每个特定类型插件的接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T14:50:51.650

制作一个插件加载器程序集可能吗？:)

避免在 ASP.NET 应用程序中使用业务级代码。尽量将其保留为“仅演示”-尽可能...

# activex - 在本地检测和访问正在运行的 SWF

> ID：740215
> 
> 赞同：0
> 
> 时间：2009-04-11T14:42:49.097
> 
> 标签：activex, flash

有没有办法询问 Flash Player 是否播放任何 SWF 文件，如果是，它们是哪些？

我想在浏览器中检查正在运行的 SWF 很容易。

我想知道是否有任何其他应用程序正在运行 Flash 内容...我可以检测到并访问 swf 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T14:53:34.453

没有这样的信息可以直接从 Actionscript 中检索（这在安全方面真的很糟糕）。

一种解决方法是检查 FP 使用的总内存以检测是否正在播放其他内容（但您不知道是什么）

# jquery - 如何使用 jquery append & appendTo

> ID：740224
> 
> 赞同：0
> 
> 时间：2009-04-11T14:49:01.483
> 
> 标签：jquery, firefox

我试图用来`append`将块内容放在正文的底部并以绝对位置显示，但是当显示时，输入复选框在 Firefox 上变得不可点击。

问题是什么？

js：

```
var box = $('#subbox');
box.css('top',  200);
box.css('left', 300);     
$(document.body).append(box); 
```

HTML：

```
 <div id="Subbox" class="subbox">
    <input type="checkbox" checked="checked"> 
  </div> 
```

CSS：

```
 .subbox {
position:absolute !important;
z-index: 5 !important;
background-color: #eee;
padding: 5px;
margin:0px;
margin-top:0px; 
border:1px solid #ccc;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T16:18:42.283

您是否在 JavaScript 中生成`<div id="Subbox" />`及其内容？

如果我理解正确，您是否正在寻找这样的东西？

```
$(function() {

    var cssObject = { top: 200, left: 300 }

    $('<div id="Subbox" class="subbox">')
        .append('<input type="checkbox" checked="checked"/>')
        .css(cssObject)
        .appendTo(document.body);

}); 
```

[工作演示在这里](http://jsbin.com/uboxu)（添加**/edit**到 URL 以编辑演示）

在 Firefox 3.0.8 和 IE6 中测试，它可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T14:59:27.653

由于我不完全理解您的问题（“可破解”是什么意思？）我会在这里提到显而易见的事情。

首先，我想说的是，一般来说，在同一个文档中对 ID 和类名使用相同的名称是个坏主意。即使其中一个有大写字母，也不是很好。

其次，HTML 是无效的，因为`INPUT`标签没有结尾。在尝试其他任何操作之前，请始终确保 HTML 是有效的（或至少没有完全损坏）。

# c++ - 在 c++ 中定义可以容纳六个值的最小可能数据类型

> ID：740228
> 
> 赞同：4
> 
> 时间：2009-04-11T14:50:34.100
> 
> 标签：c++, memory, binary, memory-management, hex

我想定义我自己的数据类型，它可以保存六个可能值中的一个，以便了解更多关于 C++ 中的内存管理的信息。在数字上，我希望能够保持 0 到 5。二进制，三个位（101 = 5）就足够了，尽管不会使用一些（6 和 7）。数据类型也应该消耗尽可能少的内存。

我不确定如何做到这一点。首先，我尝试了一个为所有字段定义值的枚举。据我所知，那里的值是十六进制的，所以一个“hexbit”应该允许我存储 0 到 15。但是将它与一个字符（使用 sizeof）进行比较，它表明它是字符大小的 4 倍，并且如果我没记错的话，一个 char 包含 0 到 255。

```
#include <iostream>

enum Foo
{
    a = 0x0, 
    b = 0x1,
    c = 0x2,
    d = 0x3,
    e = 0x4,
    f = 0x5,
};

int main()
{
    Foo myfoo = a;
    char mychar = 'a';

    std::cout << sizeof(myfoo); // prints 4
    std::cout << sizeof(mychar); // prints 1

    return 1;
} 
```

我显然误解了一些东西，但看不到是什么，所以我转向 SO。:)

此外，在写这篇文章时，我意识到我显然缺乏某些词汇。我已将此帖子设为社区 wiki，请对其进行编辑，以便我可以学习所有内容的正确单词。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-11T14:57:45.380

A`char`是可能的最小类型。

如果您碰巧知道在一个地方需要多个这样的 3 位值，则可以使用具有位域语法的结构：

```
struct foo {
  unsigned int val1:3;
  unsigned int val2:3;
}; 
```

因此在一个字节内得到其中的 2 个。理论上，您可以将 10 个这样的字段打包成一个 32 位的“int”值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T16:43:54.860

C++ 0x 将包含[强类型枚举](http://en.wikipedia.org/wiki/C++0x#Strongly_typed_enumerations)，您可以在其中指定基础数据类型（在您的示例 char 中），但当前的 C++ 不支持这一点。该标准并不清楚此处是否使用 char（示例为 int、short 和 long），但它们提到*了基础整数类型*，并且也包括 char。

截至今天，Neil Butterworth 为您的问题创建一个类的答案似乎是最优雅的，因为如果您想要值的符号名称，您甚至可以将其扩展为包含嵌套枚举。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T15:06:24.250

C++ 不表示小于字节的内存单位。如果你一次生产一个，那是你能做的最好的。您自己的示例效果很好。如果您只需要一些，您可以使用 Alnitak 建议的位域。如果您打算一次分配一个，那么您的情况会更糟。大多数架构分配页面大小单位，16 字节是常见的。

另一种选择可能是包装 std::bitset 来做你的投标。这将浪费很少的空间，如果你需要很多这样的值，每 8 只需要大约 1 位。

如果您将问题视为一个以 6 为底的数字，并将该数字转换为以 2 为底的数字，可能使用无限精度整数（例如 GMP），您根本不会浪费任何位。

当然，这假设您的值具有均匀的随机分布。如果它们遵循不同的发行版，那么最好使用 gzip 之类的第一个示例的一般压缩。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T22:26:39.980

您可以存储小于 8 位或 32 位的值。您只需要将它们打包成一个结构（或类）并使用[位字段](http://cplus.about.com/od/learningc/ss/lowlevel_10.htm)。

例如：

```
struct example
{
    unsigned int a : 3; //<Three bits, can be 0 through 7.
            bool b : 1; //<One bit, the stores 0 or 1.
    unsigned int c : 10; //<Ten bits, can be 0 through 1023.
    unsigned int d : 19; //<19 bits, can be 0 through 524287.
} 
```

在大多数情况下，您的编译器会将结构的总大小四舍五入到 32 位平台上的 32 位。另一个问题是，就像您指出的那样，您的值可能没有两个范围的幂。这会浪费空间。如果您将整个结构读取为一个数字，如果您的输入范围不是 2 的所有幂，您会发现无法设置的值。

您可能会发现另一个有趣的功能是[union](http://en.wikipedia.org/wiki/Union_(computer_science))。它们像结构一样工作，但共享内存。因此，如果您写入一个字段，它会覆盖其他字段。

现在，如果您的空间真的很紧，并且想将每个位推到最大，那么有一种简单的编码方法。假设您要存储 3 个数字，每个数字可以从 0 到 5。位字段是浪费的，因为如果您每个使用 3 个位，您将浪费一些值（即您永远不能设置 6 或 7，即使您有存放它们的空间）。所以，让我们做一个例子：

```
//Here are three example values, each can be from 0 to 5:
const int one = 3, two = 4, three = 5; 
```

为了最有效地将它们打包在一起，我们应该考虑以 6 为基数（因为每个值都是从 0 到 5）。所以装进尽可能小的空间是：

```
//This packs all the values into one int, from 0 - 215.
//pack could be any value from 0 - 215\. There are no 'wasted' numbers.
int pack = one + (6 * two) + (6 * 6 * three); 
```

看看我们以六为基数编码的样子？每个数字乘以它的位置，例如 6^n，其中 n 是位置（从 0 开始）。

然后解码：

```
const int one = pack % 6;
pack /= 6;
const int two = pack % 6;
pack /= 6;
const int three = pack; 
```

当您必须对条形码或字母数字序列中的某些字段进行编码以供人工输入时，这些方案非常方便。仅仅说出这几个部分就可以产生**巨大**的影响。此外，这些字段不必都具有相同的范围。如果一个字段是从 0 到 7，则在适当的位置使用 8 而不是 6。不要求所有字段具有相同的范围。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-11T15:00:43.423

您可以使用的最小大小 - 1 个字节。

但是，如果您使用一组枚举值（写入文件或存储在容器中，..），您可以打包这个组 - 每个值 3 位。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-11T15:02:19.720

最好的解决方案是创建您自己的使用 char 实现的类型。这应该有 sizeof(MyType) == 1，尽管这不能保证。

```
#include <iostream>
using namespace std;

class MyType {

    public:

        MyType( int a ) : val( a ) {
            if ( val < 0 || val > 6 ) {
                throw( "bad value" );
            }
        }

        int Value() const {
            return val;
        }

    private:

        char val;
};

int main() {

    MyType v( 2 );
    cout << sizeof(v) << endl;
    cout << v.Value() << endl;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-11T15:03:21.933

您不必枚举枚举的值：

```
enum Foo
{
    a, 
    b,
    c,
    d,
    e,
    f,
}; 
```

> ```
> Foo myfoo = a; 
> ```

这`Foo`是 的别名`int`，在您的机器上占用 4 个字节。

最小的类型是`char`，它被定义为目标机器上最小的可寻址数据。宏产生 a 中的`CHAR_BIT`位数，`char`并在 中定义`limits.h`。

[编辑]

请注意，一般来说，您不应该问自己这样的问题。如果足够，请始终使用`[unsigned] int`，除非您分配了大量内存（例如`int[100*1024]`vs `char[100*1024]`，但考虑`std::vector`改为使用）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-11T22:36:22.703

由于架构不支持位级操作（因此每个操作需要多个处理器指令），将奇数大小的值打包到位域中可能会导致相当大的性能损失。在你实现这种类型之前，问问自己是否*真的*需要尽可能少地使用空间，或者你是否犯了过早优化的编程大罪。最多，我会将值封装在一个类中，如果您出于某种原因确实需要压缩每个最后一个字节，则该类的后备存储可以透明地更改。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-11T14:56:32.823

您可以使用无符号字符。可能将其 typedef 为一个 BYTE。它只占用一个字节。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-11T17:02:18.200

枚举的大小被定义为与 int 相同。但是根据您的编译器，您可以选择创建更小的枚举。例如，在 GCC 中，您可以声明：

```
enum Foo {
    a, b, c, d, e, f
}
__attribute__((__packed__)); 
```

现在，sizeof(Foo) == 1。

# wordpress - Xampp 上的 Wordpress 导致长 ttfb

> ID：740233
> 
> 赞同：0
> 
> 时间：2009-04-11T14:52:26.407
> 
> 标签：wordpress, xampp

有谁知道为什么 Xampp 上的 Wordpress 会导致第一个字节的时间很长，大约 10-15 秒？我在 100mbit 盒子、最新的 Xampp 和最新的 Wordpress 上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T21:56:20.163

如果我们甚至可以帮助您，我认为需要更多信息 - 如果您在本地运行它，网络连接速度应该无关紧要。也许是你机器的规格之类的东西。

在一个稍微有用的注释（:-）上：

*   尝试运行网络嗅探器，例如 Wireshark（或使用任务管理器）来检查实际通过网络的流量 - 是否已满？
*   是否有一个进程占用大量 CPU 时间，或者大量颠簸磁盘？
*   检查 MySQL 数据库的速度
*   尝试重新下载 Wordpress 和 XAMPP，以确保
*   重新安装 Wordpress（即再次运行 setup.php）
*   运行 XAMPP 的初始化批处理脚本

这些只是疯狂的建议，所以我不确定它们会有多大用处。

# .net - debug.write 和 Trace.write 有什么区别？

> ID：740240
> 
> 赞同：23
> 
> 时间：2009-04-11T14:55:42.263
> 
> 标签：.net

**debug.write**和**Trace.write 有**什么区别？什么时候应该使用每个？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-11T15:05:45.907

在典型的发布构建配置中，`Debug`该类被禁用并且什么都不做。`Trace`但是，仍然可以在发行版中使用。您通常会使用`Debug.Write`仅在调试时才需要并且对于生产来说过于冗长的东西。

`Debug, Trace`这是一篇关于等的好文章：http: [//www.codeproject.com/KB/trace/debugtreatise.aspx](http://www.codeproject.com/KB/trace/debugtreatise.aspx)

但是，我更倾向于使用**log4net**等可以即时重新配置的日志库。因此，如果您正在调查应用程序的问题，您仍然可以在生产环境中打开完全登录。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-11T15:00:22.190

[`Debug.Write`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debug.write(loband).aspx)仅对定义标志的构建有效`DEBUG`，而[`Trace.Write`](http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.write(loband).aspx)仅在`TRACE`定义标志时有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-12T08:26:58.887

一个区别也是，**DEBUG**（默认）**仅在 Debug**项目构建配置**中定义，而 TRACE**（再次默认）**在 Debug 和 Release**项目构建配置中定义。（至少在 VS 2015 中。）

您可以在项目属性中更改每个项目的默认行为。

**调试：** [![在此处输入图像描述](https://i.stack.imgur.com/GcGMo.png)](https://i.stack.imgur.com/GcGMo.png)

**释放：** [![在此处输入图像描述](https://i.stack.imgur.com/v81sK.png)](https://i.stack.imgur.com/v81sK.png)

# c# - 仅支持启用 Javascript 的用户

> ID：740243
> 
> 赞同：8
> 
> 时间：2009-04-11T14:56:54.133
> 
> 标签：c#, asp.net, javascript

我正在考虑创建一个仅支持启用 JavaScript 的用户的网站。

我这样做的理由是我想在相当有限的时间预算内提供丰富的用户体验，所以如果我只支持启用 JS 的人，我不必花时间确保 UI 在没有 JS 的情况下工作并创建用于验证等的服务器端等效项。

1.  这可能吗？不同的浏览器\平台会阻止我实现这一目标吗？
2.  这些天禁用 JS 的用户百分比是多少？
3.  我将如何检查是否在 C# 中启用了 JS。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-11T15:11:57.670

你的理由很好。但是，您**必须**在服务器端实现验证，否则只需禁用 JavaScript 就很容易滥用您的代码。

不，不使用 JavaScript 就“不可能”提交任何数据并不能解决问题。

从个人经验来看，我认为现在大多数互联网用户都启用了 JS。可能对 JS-heavy 网站有问题的部分用户是基于移动设备的用户，所以除非你需要接触他们，否则这可能不是什么大问题。

确定 JS 的最简单方法是仅使用一次重定向，那就是使用 JavaScript 代码（document.cookie）设置一个 cookie，然后使用前面提到的 window.location 进行重定向。之后服务器应该能够读取 JS 设置的 cookie，假设它已启用。

此外，虽然使用 C# 等技术在服务器和客户端上自动共享验证规则和其他逻辑非常困难，但我建议查看 Aptana Jaxer。Jaxer 是一个基于 JavaScript 的服务器端框架，除其他外，它允许您在客户端和服务器上共享完全相同的 JavaScript 代码。如果您想在客户端进行验证，但又不想编写两次验证规则，那就太好了！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-11T15:13:03.500

看：

*   [有多少人禁用 Javascript？](https://stackoverflow.com/questions/121108/how-many-people-disable-javascript)（约 1%）；
*   [如何检测 JavaScript 是否被禁用？](https://stackoverflow.com/questions/121203/how-to-detect-if-javascript-is-disabled); 和
*   [检测何时在 ASP.NET 中禁用 JavaScript](https://stackoverflow.com/questions/246480/detect-when-javascript-is-disabled-in-asp-net)。

至于验证，您应该**始终**进行服务器端验证，并且**永远不要**依赖客户端验证。您只是要求以其他方式被黑客入侵。

如果您正在做丰富的用户体验和/或您没有时间为您的网站制作两个（或更多）版本来满足如此小的比例，我认为我们已经达到了通常可以接受的时间。

不过也要看具体情况。某些网站可能会针对不成比例地禁用 Javascript 等的用途。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-11T16:02:20.777

您缺少几个浏览器场景：

*   越来越多的*人*在使用 NoScript 和类似的系统，这些系统最初是禁用 javascript 的。这对您来说可能不是真正的问题，因为大多数人只会在需要时打开它。
*   **Googlebot**不知道 JavaScript。您需要确保没有 javascript 的内容足够好，以便 Google 正确索引它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T15:06:33.220

这些天来，唯一不使用 JS 的人通常是：

*   视障，并使用屏幕阅读器（JS的所有效果通常会丢失）
*   具有安全意识（或偏执？）并在关闭 NoScript 的情况下浏览
*   浏览器受限的移动用户

在 ASP.NET 或任何 HTML 站点中，使用：

```
<script type="text/javascript">
    window.location="/hasJs.aspx";
</script> 
```

这会将他们重定向到 JavaScript 用户的页面，这可能会设置 cookie 或您可以在母版页中检查的内容。像这样（或类似）：

（在 hasJs.aspx 中）：

```
protected void Page_Load(object sender, object e) {
    Response.Cookies.Add(new HttpCookie("hasJs", "yes"));
    Response.Redirect("/Default.aspx");
} 
```

（网站主）：

```
<% if ( ! Request.Cookies.Contains("hasJs") ) { %>
    <script type="text/javascript">
         window.location="/hasJs.aspx";
    </script>
    This site requires JavaScript.
<% } %> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T15:03:23.120

这当然是可能的，如果客户（如果你有的话）同意也没关系。但是您仍然必须在服务器端进行验证.. 否则一些脚本小子（即使它将在公司中使用）会破坏您的脚本，甚至可能会做您不想发生的事情。

[http://www.w3schools.com/browsers/browsers_stats.asp](http://www.w3schools.com/browsers/browsers_stats.asp)

您将检查 JS 以检查 JS 是否已启用；）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T15:40:23.420

请不要将此视为对您计划的批评。要求 Javascript 的选择当然是您自己的选择——尽管正如其他人所提到的，您可能需要关注可访问性问题。但是，您可能会发现使用 ASP.NET MVC 而不是 WebForms 开发对 JavaScript 不友好的网站更容易。

新的 AjaxHelper 扩展使得包含对大多数人来说依赖 AJAX 的代码几乎是微不足道的，但在客户端中没有 Javascript 的情况下工作。显然，对于没有它的人来说，体验会下降——更重要的是，如果你将 jQuery 插件用于选项卡/菜单、弹出窗口等——但它仍然可以使用。该框架在服务器端提供了一种非常简单的机制来确定请求是否为 AJAX 请求，因此您可以通过呈现新视图或适当地发回 JSON/HTML/XML 来适当地响应。

我知道我发现使用 MVC 编写可访问的网站比使用 WebForms 更容易。

# iphone - 用于与 TCP 套接字对话的 Cocoa-Touch 框架？

> ID：740258
> 
> 赞同：9
> 
> 时间：2009-04-11T15:02:44.883
> 
> 标签：iphone, objective-c, cocoa-touch

我在锁定到 TCP/IP 端口的服务器上运行了一个守护进程。我正在寻找当前是否有任何支持 iPhone/Cocoa-touch 的框架，这些框架提供了一个很好的 OO 包装器，用于通过 IP 套接字与守护程序对话。我需要能够使用命令以交互方式查询守护程序并检索回信息。

如果这样的任务没有任何 OO 包装器，那么下一个最佳选择是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-11T17:48:36.933

[http://code.google.com/p/cocoaasyncsocket/](http://code.google.com/p/cocoaasyncsocket/)

这就是你想要的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-13T13:53:31.460

Here is some sample code from the previously mentioned [AsyncSocket](http://code.google.com/p/cocoaasyncsocket/) code that I modified into a class called SocketCommunicationManager.

A few things to note:

*   Our messages are being delimited with newline characters (\n) so when reading data from the socket I had to make sure to use the right constant from the AsyncSocket class (LFData in our case). AsyncSocket also provides CRLFData, CRData, and ZeroData as predefined message delimiters.
*   I set up the SocketCommunicationManager to always wait for an incoming message after I received and acted on a previous one. To accomplish that I used the `(void)readDataToData:(NSData *)data withTimeout:(NSTimeInterval)timeout tag:(long)tag` method. This method will wait until data is written to the socket, read up until the specified delimiter, and then call the delegate method `(void)onSocket:(AsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag;`
*   The SocketCommunicationManager uses NSNotificationCenter to publish any messages received from the socket. These messages are named kNotification and the message is put into the userInfo dictionary using the kNotificationMessage key.
*   Everything read from the socket is wrapped in an NSData object, so you'll have to decode that data after it is received.

Here's the code:

```
#import <Foundation/Foundation.h>

extern NSString * const kNotification;
extern NSString * const kNotificationMessage;

@class AsyncSocket;

@interface SocketCommunicationManager : NSObject {
    AsyncSocket *socket;
    BOOL isRunning;
    NSNotificationCenter* notificationCenter;
}

@property (readwrite, assign) BOOL isRunning;

- (void)connectToHost:(NSString *)hostName onPort:(int)port;
- (void)sendMessage:(NSString *)message;
- (void)disconnect;

@end

#import "SocketCommunicationManager.h"
#import "AsyncSocket.h"

NSString * const kNotification = @"kNotification";
NSString * const kNotificationMessage = @"kNotificationMessage";

@implementation SocketCommunicationManager

@synthesize isRunning;

- (id) init {
    if (!(self = [super init]))
        return nil;

    socket = [[AsyncSocket alloc] initWithDelegate:self];
    [self setIsRunning:NO];
    notificationCenter = [NSNotificationCenter defaultCenter];

    return self;
}

- (void)connectToHost:(NSString *)hostName onPort:(int)port {
    if (![self isRunning]) {
        if (port < 0 || port > 65535)
            port = 0;

        NSError *error = nil;
        if (![socket connectToHost:hostName onPort:port error:&error]) {
            NSLog(@"Error connecting to server: %@", error);
            return;
        }

        [self setIsRunning:YES];
    } else {
        [socket disconnect];
        [self setIsRunning:false];
    }
}

- (void)disconnect {
    [socket disconnect];
}

- (void)dealloc {
    [super dealloc];
    [socket disconnect];
    [socket dealloc];
}

- (void)sendMessage:(NSString *)message {
    NSString *terminatedMessage = [message stringByAppendingString:@"\r\n"];
    NSData *terminatedMessageData = [terminatedMessage dataUsingEncoding:NSASCIIStringEncoding];
    [socket writeData:terminatedMessageData withTimeout:-1 tag:0];
}

#pragma mark AsyncSocket Delegate

- (void)onSocket:(AsyncSocket *)sock didConnectToHost:(NSString *)host port:(UInt16)port {
    NSLog(@"Connected to server %@:%hu", host, port);
    [sock readDataToData:[AsyncSocket LFData] withTimeout:-1 tag:0];
}

- (void)onSocket:(AsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag {
    NSData *truncatedData = [data subdataWithRange:NSMakeRange(0, [data length] - 1)];
    NSString *message = [[[NSString alloc] initWithData:truncatedData encoding:NSASCIIStringEncoding] autorelease];

    if (message)
        NSLog(@"%@", message);
    else
        NSLog(@"Error converting received data into UTF-8 String");

    NSDictionary *userInfo = [NSDictionary dictionaryWithObject:message forKey:kNotificationMessage];
    [notificationCenter postNotificationName:kNotification object:self userInfo:userInfo];

    [sock readDataToData:[AsyncSocket LFData] withTimeout:-1 tag:0];
}

- (void)onSocket:(AsyncSocket *)sock didWriteDataWithTag:(long)tag {
    [sock readDataToData:[AsyncSocket LFData] withTimeout:-1 tag:0];
}

- (void)onSocket:(AsyncSocket *)sock willDisconnectWithError:(NSError *)err {
    NSLog(@"Client Disconnected: %@:%hu", [sock connectedHost], [sock connectedPort]);
}

@end 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-11T17:42:44.920

粗略地说，在你拥有的堆栈上增加：

*   BSD 套接字
*   CFSocket
*   CFReadStream/CFWriteStream/NSInputStream/NSOutputStream
*   CFHTTP流
*   NSURL连接

听起来你想要 CFSocket，或者可能是 CFStream。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T15:36:55.923

您是否查看过 Cocoa-Touch[网络指南中的](http://developer.apple.com/iphone/library/documentation/CoreFoundation/Reference/CFSocketRef/Reference/reference.html)[BSD 套接字](http://developer.apple.com/iphone/library/documentation/CoreFoundation/Reference/CFSocketRef/Reference/reference.html)？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-11T18:43:06.103

正如 Genericrich 所指出的，Cocoa Async Socket 框架是要走的路。这已经存在了一段时间，并且得到了很好的使用。[http://code.google.com/p/cocoaasyncsocket/](http://code.google.com/p/cocoaasyncsocket/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T19:43:47.453

正如 Genericrich 所指出的，AsyncSocket 类非常适合处理套接字。 [http://code.google.com/p/cocoaasyncsocket/](http://code.google.com/p/cocoaasyncsocket/)

# dynamics-ax-2009 - 如何在动态 AX 中创建不合格的 catch 块？

> ID：740259
> 
> 赞同：1
> 
> 时间：2009-04-11T15:03:09.437
> 
> 标签：dynamics-ax-2009

如何在 Dynamics AX 中创建不合格的 catch 块？

这是 AX2009sp1 的开发帮助，但没有示例。所有有效的 catch 块都需要异常类型作为强制参数，例如：

```
catch(exception::error) 
{ 
   : 
} 
```

我错过了什么吗？兄弟，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T12:41:24.043

您应该保留不带参数的 catch 子句。

```
try
{
   //...      
}
catch
{
   //... 
} 
```

这是一个关于异常处理的优秀截屏：

[http://channel9.msdn.com/posts/mfp/Exception-handling-in-X/](http://channel9.msdn.com/posts/mfp/Exception-handling-in-X/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T16:16:36.453

“一种策略是让最后一个 catch 语句不指定异常类型”

[http://msdn.microsoft.com/en-us/library/aa893385.aspx](http://msdn.microsoft.com/en-us/library/aa893385.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T15:09:32.683

我不知道AX，但我可以提供一些建议；您可以尝试将异常参数全部省略（即`catch() {...}`，或为异常参数使用最常用的类型（即`object`或您的语言中的等效参数）。这至少在许多其他语言中是这样工作的。

# c++ - C程序中的C++ dll

> ID：740263
> 
> 赞同：4
> 
> 时间：2009-04-11T15:03:49.017
> 
> 标签：c++, c, dll

我想从**C++**代码创建一个 dll 库并在**C**程序中使用它。我只想导出一个函数：

```
GLboolean load_obj (const char *filename, GLuint &object_list); 
```

库中的头文件：

```
#ifndef __OBJ__H__
#define __OBJ__H__

#include <windows.h>  
#include <GL/gl.h>
#include <GL/glext.h>
#include <GL/glu.h>
#include <GL/glut.h>

#if defined DLL_EXPORT
#define DECLDIR __declspec(dllexport)
#else
#define DECLDIR __declspec(dllimport)
#endif

extern "C" GLboolean load_obj (const char *filename, GLuint &object_list);

#endif // __3DS__H__ 
```

在 .cpp （在库项目中）函数也被声明为：

```
extern "C" GLboolean load_obj (const char *filename, GLuint &object_list)
{
 code...
} 
```

文件 .lib 被添加到 VS 项目选项（链接器/输入/附加依赖项）中。.dll 位于 .exe 所在的文件夹中。当我编译 C 项目时 - 错误：

```
Error   1   error C2059: syntax error : 'string' 
```

它是关于头文件中的“外部“C””部分。

我试图将头文件更改为：

```
extern GLboolean load_obj (const char *filename, GLuint &object_list); 
```

然后

```
Error   1   error C2143: syntax error : missing ')' before '&'  
Error   2   error C2143: syntax error : missing '{' before '&'  
Error   3   error C2059: syntax error : '&' 
Error   4   error C2059: syntax error : ')' 
```

甚至当我将**&**更改为 * 时：

```
Error   6   error LNK2019: unresolved external symbol _load_obj referenced in function _main    main.obj 
```

我不知道为什么它是错误的。.lib .h 和 .dll 已正确添加。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-11T15:08:52.107

参数“ `GLuint &object_list`”表示“在此处传递对 GLuint 的引用”。C 没有引用。请改用指针。

```
// declaration
extern "C" GLboolean load_obj (const char *filename, GLuint *object_list);

// definition
GLboolean load_obj (const char *filename, GLuint *object_list)
{
    code...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-11T17:09:26.450

正如大卫指出的那样，C 没有引用。

此外，取出外部“C”。C 没有用，也不知道它。

如果您需要共享标头，请执行以下操作：

```
#ifdef __cplusplus
    extern "C" {
#endif

/* extern "C" stuff */

#ifdef __cplusplus
    }
#endif 
```

在 C 中，不会定义 __cplusplus。

# vim - windows下的vim编译

> ID：740265
> 
> 赞同：3
> 
> 时间：2009-04-11T15:04:55.237
> 
> 标签：vim, compilation

我对编译 Windows 以支持 Python25 很感兴趣，但是当我

```
make -f Make_ming.mak gvim.exe 
```

我得到以下（`_MAX_PATH undeclared`）：

```
gcc -c -Iproto -DWIN32 -DWINVER=0x0400 -D_WIN32_WINNT=0x0400 -DHAVE_PATHDEF -DFEAT_BIG -DHAVE_GETTEXT -DHAVE_LOCALE_H -DDYNAMIC_GETTEXT -DFEAT_CSCOPE -DFEAT_NETBEANS_INTG -DFEAT_GUI_W32 -DFEAT_CLIPBOARD -DFEAT_MBYTE -DFEAT_MBYTE_IME -DDYNAMIC_IME -DDYNAMIC_ICONV -pipe -w -march=i386 -墙 -DFEAT_PYTHON -I c:/Python25/include -DDYNAMIC_PYTHON -DYNAMIC_PYTHON_DLL=\"python25.dll\" -O3 -fomit-frame-pointer -freg-struct-return -s fileio.c -o gobj/fileio.o
fileio.c：在函数“buf_modname”中：
fileio.c:5877: 错误：_MAX_PATH' 未声明（在此函数中首次使用）
fileio.c:5877：错误：（每个未声明的标识符只报告一次
fileio.c:5877：错误：对于它出现的每个函数。）
fileio.c：在函数“vim_tempname”中：
fileio.c:6832: error: `_MAX_PATH' undeclared (第一次在这个函数中使用)
make: *** [gobj/fileio.o] 错误 1

```

有任何想法吗？我错过了什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T23:45:58.917

我自己不知道如何解决你的问题，但我按照这个视频教程做了你正在尝试的事情，它就像一个魅力：

[http://showmedo.com/videotutorials/video?name=1850010&fromSeriesID=185](http://showmedo.com/videotutorials/video?name=1850010&fromSeriesID=185)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T16:22:33.960

如果你想要 Vim 文本编辑器，为什么不使用 vim.org 等的[下载](http://www.vim.org/download.php#pc)版本（gvim、[Cream](http://cream.sourceforge.net/download.html)、[Portable Gvim](http://portablegvim.sourceforge.net/)）

如果您尝试为 Windows 构建 Python，为什么不使用来自[python.org](http://www.python.org/)的当前 2.6.1 或 3.0.1 ？

`_MAX_PATH`应该是`PATH_MAX`或者`_PATH_MAX`是通过`stdlib.h`/`limits.h`或`sys/param.h`在Linux下定义的。

你检查过任何配置日志吗？任何先前关于缺少包含或未定义值的编译器警告？搜索`PATH_MAX`和`PATH_MAX`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T16:35:50.837

仅仅是为了支持 Python 2.5 吗？

不是您问题的答案，而是简单的方法： 从 gooli.org*下载预编译的*vim.exe 和 gvim.exe [（](http://www.gooli.org/blog/gvim-72-with-python-2526-support-windows-binaries/)适用于 Python 2.5 和/或 2.6）

# sharepoint-2007 - 显式更改 MembershipProvider 的连接字符串

> ID：740271
> 
> 赞同：1
> 
> 时间：2009-04-11T15:08:38.737
> 
> 标签：sharepoint-2007, moss, asp.net-membership

我正在使用以下提供程序从 ADAM 查找用户。我希望能够根据用户类型动态更改连接字符串。我怎样才能做到这一点？

```
<add name="con1" connectionString="LDAP://con1.url" />
<add name="con2" connectionString="LDAP://con2.url" /> 
```

```
 <providers>   

<add name="ConnectionProvider" connectionStringName="con1" type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" attributeMapUsername="userPrincipalName" enableSearchMethods="true" />

  </providers> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T03:07:48.767

您可以使用 ConfigurationManager.GetSection() 方法（System.Configuration 命名空间）获取 .config 的特定部分。从这里，只需应用逻辑并选择所需的连接字符串。

# java - Hibernate/mysql 连接池

> ID：740275
> 
> 赞同：1
> 
> 时间：2009-04-11T15:09:25.023
> 
> 标签：java, mysql, hibernate

我们托管一个服务（在 jboss 上运行的 servlet），它每秒接收大约 5-6 个请求。每个请求都需要通过hibernate连接到mysql。我们的大多数请求都进行选择，每 5/6 个请求插入/更新一次。休眠 mysql 连接在 mysql 连接超时期限（8 小时）后超时。即使在请求 ping 我们的服务之后，每隔一小时，mysql 连接有时也会在一天左右后随机断开。我们希望hibernate在连接由于任何原因断开的情况下重新连接，并保持我们想要的连接数。

我们尝试了 C3P0，配置如下：

```
<property name=c3p0.acquire_increment>1</property>
<property name=c3p0.idle_test_period>3600</property> 
<property name=c3p0.max_statements>0</property> 
<property name=c3p0.min_size>1</property> 
<property name=c3p0.timeout>3605</property> 
<property name=hibernate.c3p0.preferredTestQuery>select 1;</property> 
```

休眠连接池大小设置为 1。

这使超时/断开连接问题消失了。但我们开始面临另一个问题。漫长的等待。通常我们的请求服务时间是 2-3ms 选择和 40-50ms 插入/更新。但是，使用上面的 C3P0 配置后，我们看到更新后完成的每个请求都需要一分钟以上，有时甚至需要 4-5 分钟！从我们的日志中，似乎随机选择请求会卡住，并且只有在收到并提供更新请求后才能完成。

如果我们删除 C3P0 配置，上述问题就会消失。有人可以建议我们可能做错了什么吗？

这是完整的休眠配置供参考：

```
<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE hibernate-configuration PUBLIC
          "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
    <session-factory>

        <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
        <property name="connection.url">jdbc:mysql://xxx.xxx.xxx</property>
        <property name="connection.username">xxx</property>
        <property name="connection.password">xxx</property>
        <property name="connection.pool_size">1</property> 
        <property name="dialect">org.hibernate.dialect.MySQLDialect</property>
        <property name="current_session_context_class">thread</property>
        <property name="hibernate.cache.use_query_cache">false</property>
        <property name="hibernate.cache.use_second_level_cache">false</property>
        <property name="show_sql">true</property>

        <!-- Transaction isolation 2 = READ_COMMITTED -->
        <property name="connection.isolation">2</property>
        <property name="connection.autocommit">true</property>

        <!-- configuration pool via c3p0-->
        <property name="c3p0.acquire_increment">1</property>
        <property name="c3p0.idle_test_period">3600</property> <!-- seconds -->
        <property name="c3p0.max_size">1</property>
        <property name="c3p0.max_statements">0</property>
        <property name="c3p0.min_size">1</property>
        <property name="c3p0.timeout">3605</property> <!-- seconds -->
        <property name="hibernate.c3p0.preferredTestQuery">select 1;</property>

    </session-factory>
</hibernate-configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T15:57:41.147

我建议放弃 C3P0 并使用 JBOSS 提供的 JNDI 命名服务和连接池。

确保您正确关闭连接并将它们返回到池中。连接、查询、关闭，所有这些都在尽可能小的范围内。八小时内不应有任何连接。

一些更多的链接可能是相关的：[http](http://www.hibernate.org/117.html) ://www.hibernate.org/117.html和[http://www.informit.com/articles/article.aspx?p=353736&seqNum=4](http://www.informit.com/articles/article.aspx?p=353736&seqNum=4)关于休眠和关闭连接，这引用 MySQL、Hibernate 和连接问题的 MySQL 错误：[http ://bugs.mysql.com/bug.php?id=10917](http://bugs.mysql.com/bug.php?id=10917)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T18:34:14.953

您的配置似乎有问题。所有配置参数都应该在 hibernate.c3p0 命名空间中，而不是 c3p0.*。

But that's probably not the problem. I think most likely your pool is only one connection big and you are experiencing resource contention issues somewhere. Most likely not releasing a connection where you should, or a deadlock on some data. Try setting maxPoolsize to something higher, like 2 and see if the problem is mitigated any. This would probably mean you're not properly returning connections.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:02:05.927

The JBoss Hibernate documentation specifically states to **not** use the Hibernate connection-pool manager for non-production systems (just like Hypersonic - I really don't know why they bother to ship known buggy components). As was previously commented, use the standard JBoss `<datasource>` setup and associated pool-manager (and configure as needed).

Where there is some misunderstanding is that the `open()` and `close()` methods are overridden by the connection manager. Even the `Connection` object isn't a direct connection to the database but rather a handle to the pool-manager.

The implementation upon getting a new connection (aka open) is to request a connection from the pool (which for efficiency is already opened and, if configured using the `<prepared-statement-cache-size>` property in the `datasource` definition, also has previous `PreparedStatement`s still bound to that `Connection`). This call is uber efficient.

When `close()` is called on the Connection (again, implemented by the pool-manager), the connection reference state is simply changed to 'available' versus closing the actual database connection. This is also uber efficient. Therefore it is recommended that the smallest possible scope of open/exec/close calls be made to maximize multi-thread use of available connections in the pool.

# php - 如何简化 PHP 中的表单处理？

> ID：740278
> 
> 赞同：8
> 
> 时间：2009-04-11T15:09:35.647
> 
> 标签：php, validation, forms

我已经成为一名 PHP 开发人员已经有一段时间了，但直到今天我还没有找到一种简单的处理方法（也就是规范化、清理、验证、填充和显示表单以及它各自的字段错误）。

我知道现在大多数 PHP 框架使这项工作变得更容易，但不知何故我不想将我的所有代码移植到这些框架之一，而且我不太明白表单验证是如何在 Django 中实现的（我知道，它是 Python，但我真的很喜欢他们的方法），所以我认为最好的方式是在这里发布我处理简单表单的方式，也许你们可以为我指明最佳方向。

```
<?php

// sample controller
class _sample extends framework
{
    // sample action
    function contact()
    {
        if ($this->Is->Post() === true)
        {
            $errors = array();

            if ($this->Is->Set($_POST['name']) === false)
            {
                $errors['name'] = 'Please fill in your name.';
            }

            if (($this->Is->Email($_POST['email']) === false) || ($this->Is->Set($_POST['email']) === false))
            {
                $errors['email'] = 'Please fill in your email address.';
            }

            if (($this->Is->Phone($_POST['contact']) === false) && ($this->Is->Mobile($_POST['contact']) === false))
            {
                $errors['contact'] = 'Please fill in your phone (or cell phone) number.';
            }

            if ($this->Is->Set($_POST['message']) === false)
            {
                $errors['message'] = 'Please type a message';
            }

            // no errors, it's valid!
            if (empty($errors) === true)
            {
                // do stuff and redirect to "success" / "thank you" page
            }

            // load the form view, and let it display the errors
            // automatically prefill fields with $_POST values
            else
            {
                $this->View('contact_form', $errors);
            }
        }

        // load the form view for the first time
        else
        {
            $this->View('contact_form');
        }
    }
}

?> 
```

正如你所看到的，这应该是一个简单的联系表格，但是它需要我的生命来验证它，我一直在研究一些设计模式（观察者，工厂），但我不确定是否以及以何种方式我应该实施它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-11T16:52:56.630

恕我直言，将表单视为单一概念的尝试是失败的。如果您的应用程序有任何类型的分层架构，那么表单很可能会跨越这些架构。表单具有应用程序逻辑（控制器层），它们具有可视化表示（视图层），它们具有状态（应用程序层模型），最后它们通常会调用某种事务脚本（模型层）。

我认为你最好放弃将“表单”作为一个实体的想法，而是将三个部分（输入处理、渲染和模型层）作为完全独立的事情来关注，这可能会（或可能不会）发生彼此密切相关。这有时被称为 MVC 模式，尽管这个术语现在负载非常大，它可能意味着很多东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T15:52:47.197

我知道这是你排除的东西，直到一年前我也和你一样，当我强迫自己学习像[Qcodo](http://qcodo.com)（php 框架）这样的晦涩难懂的东西时，你瞧，没有它我什么都做不了。从你的肩膀上卸下许多总是重复的负担真是太好了。为什么选择 Qcodo？当时我想学习最高级的，因为我已经在学习了，所以我寻找了 Qcodo 似乎提供的最广泛的功能集。今天我不知道哪个是最热门的，但对我来说 Qcodo 仍然满足我的所有需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T17:03:12.253

您可以为所有表单创建一个抽象基类，为字段类型创建一个类，以及一个静态类，仅用于验证各种类型的值（validateString、validateHtml、validateEmail、validateNumber、date 等，只是方法......）。定义您的表单，您将定义它将使用哪些字段对象，因此 Form->validate() 方法将调用 Field->validate() 并返回过滤后的值或错误消息。为字段指定默认错误消息，但在表单类中定义字段时提供覆盖它的选项。

哦，留下那个 $_POST 的东西。阅读帖子一次，将其传递给表单验证，然后处理过滤的字段值。

另一件事是，根据您的需求和应用程序的体系结构，有多种方法可以实现表单验证，当您有多种应用程序设计方法时，很难制作一个通用的表单验证器。选择一种工作方式并坚持下去（不管它是现成的框架还是您自己的代码），或者您编写的任何超级重复表单验证，在后面的项目中都没有意义。

还有一个：像 Django？好的！因此，开始在 Django 中编写 Python，您将真正改变完成工作的思维方式。

# asp.net - 使用 LINQ 检索相关集合值的数据绑定表达式

> ID：740285
> 
> 赞同：0
> 
> 时间：2009-04-11T15:12:49.367
> 
> 标签：asp.net, linq-to-sql, data-binding

我有一个绑定到返回客户集合的 LINQDataSource 控件的 GridView。

在我的 DataGrid 中，我需要显示客户的家庭电话号码（如果他们有的话）。客户的电话号码存储在一个单独的表中，外键指向客户表。

以下绑定表达式为我获取了客户的第一个电话号码：

```
<asp:TemplateField HeaderText="LastName" SortExpression="LastName">
   <ItemTemplate>
      <asp:Label ID="PhoneLabel" runat="server" Text='<%# Eval("Phones[0].PhoneNumber") %>'></asp:Label>
   </ItemTemplate>
</asp:TemplateField> 
```

我需要弄清楚如何专门获取家庭电话号码（根据电话类型过滤）并处理客户在数据库中没有家庭电话的情况。现在，如果客户没有任何电话号码，它会抛出超出范围的异常。

我尝试使用带有 lambda 表达式的 Where 运算符来过滤电话类型，但它不起作用：

```
<%# Eval("Phones.Where(p => p.PhoneTypeId == 2).PhoneNumber") %> 
```

非常感谢有关该主题的任何优秀文章的解决方案或链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T15:45:01.083

好吧，我不知道电话类型来自哪里，但我可能会使用代码中的方法来检索您想要的电话号码。

该方法应该是字符串类型，在这里您可以检查是否确实存在您提供的电话号码类型和客户的电话号码。

就像是：

```
public string GetPhoneNumber(int phoneTypeId, int customerId)
{
    string result = "";
    if (existsPhoneFor(phoneTypeId, customerId)
      result = GetPhoneFor(phoneTypeId, customerId);
    return result;
} 
```

并在 aspx 页面内：

```
<%= GetPhoneNumber(p.PhoneTypeId, c.CustomerId) %> 
```

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T12:25:30.197

我没有使用过 linqdatasource（总是通过 linq 代码），但我要做的第一件事是将表达式更改为：

```
Phones.Select(p=>p.PhoneNumber).FirstOrDefault(p => p.PhoneTypeId == 2) ") 
```

2件事：

*   Where 将为您提供一个列表，并且您对单个可选结果感兴趣，它是 FirstOrDefault 或 SingleOrDefault
*   如果你只使用 FirstOrDefault 然后 .PhoneNumber 直接使用，它会因为找不到电话时的空引用而失败

我对此不确定，但您可能必须更改为：

```
<%# ((IQueryable(Phone)) Eval("Phones")).Select... 
```

也就是说，它将导致每一行的往返。因此，请考虑更改选择，以便它抓住电话。在这种情况下，您只需绑定到检索到的字段。当然，您需要使用类似于上面的表达式，但在 select 内部:)

# python - 如何检查以下项目之一是否在列表中？

> ID：740287
> 
> 赞同：268
> 
> 时间：2009-04-11T15:13:07.730
> 
> 标签：python

我正在尝试找到一种简短的方法来查看列表中是否包含以下任何项目，但我的第一次尝试不起作用。除了编写一个函数来完成此操作之外，还有一种简单的方法来检查多个项目中的一个是否在列表中。

```
>>> a = [2,3,4]
>>> print (1 or 2) in a
False
>>> print (2 or 1) in a
True 
```

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2009-04-11T15:22:07.630

```
>>> L1 = [2,3,4]
>>> L2 = [1,2]
>>> [i for i in L1 if i in L2]
[2]

>>> S1 = set(L1)
>>> S2 = set(L2)
>>> S1.intersection(S2)
set([2]) 
```

空列表和空集都是 False，因此可以直接将值作为真值。

* * *

## 回答 #2

> 赞同：278
> 
> 时间：2009-04-11T16:30:38.977

啊，托拜厄斯你打败了我。我正在考虑[您的解决方案](https://stackoverflow.com/a/740359/4518341)的这种细微变化：

```
>>> a = [1,2,3,4]
>>> b = [2,7]
>>> any(x in a for x in b)
True 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-04-11T16:12:42.187

也许更懒一点：

```
a = [1,2,3,4]
b = [2,7]

print any((True for x in a if x in b)) 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-04-11T15:16:29.360

想想代码实际上是怎么说的！

```
>>> (1 or 2)
1
>>> (2 or 1)
2 
```

这应该可以解释了吧。:) Python 显然实现了“惰性或”，这不足为奇。它执行如下操作：

```
def or(x, y):
    if x: return x
    if y: return y
    return False 
```

在第一个例子中，`x == 1`和`y == 2`。在第二个例子中，反之亦然。这就是为什么它会根据它们的顺序返回不同的值。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2014-03-27T08:56:02.667

```
a = {2,3,4}
if {1,2} & a:
    pass 
```

代码高尔夫版本。如果这样做有意义，请考虑使用集合。我发现这比列表理解更具可读性。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-06-25T04:02:23.630

1 行没有列表理解。

```
>>> any(map(lambda each: each in [2,3,4], [1,2]))
True
>>> any(map(lambda each: each in [2,3,4], [1,5]))
False
>>> any(map(lambda each: each in [2,3,4], [2,4]))
True 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-04-11T15:24:02.803

我能想到的最好的：

```
any([True for e in (1, 2) if e in a]) 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2018-09-05T16:31:25.753

在 python 3 中，我们可以开始使用 unpack 星号。给定两个列表：

```
bool(len({*a} & {*b})) 
```

编辑：纳入alkanen的建议

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-01-21T03:07:07.587

当您认为“检查 a 是否在 b 中”时，请考虑哈希（在本例中为集合）。最快的方法是对要检查的列表进行哈希处理，然后检查其中的每个项目。

这就是 Joe Koberg 的回答很快的原因：检查集合交集非常快。

但是，当您没有大量数据时，制作集合可能会浪费时间。因此，您可以制作一组列表并检查每个项目：

```
tocheck = [1,2] # items to check
a = [2,3,4] # the list

a = set(a) # convert to set (O(len(a)))
print [i for i in tocheck if i in a] # check items (O(len(tocheck))) 
```

当您要检查的项目数量很少时，差异可以忽略不计。但是根据一个大列表检查很多数字......

测试：

```
from timeit import timeit

methods = ['''tocheck = [1,2] # items to check
a = [2,3,4] # the list
a = set(a) # convert to set (O(n))
[i for i in tocheck if i in a] # check items (O(m))''',

'''L1 = [2,3,4]
L2 = [1,2]
[i for i in L1 if i in L2]''',

'''S1 = set([2,3,4])
S2 = set([1,2])
S1.intersection(S2)''',

'''a = [1,2]
b = [2,3,4]
any(x in a for x in b)''']

for method in methods:
    print timeit(method, number=10000)

print

methods = ['''tocheck = range(200,300) # items to check
a = range(2, 10000) # the list
a = set(a) # convert to set (O(n))
[i for i in tocheck if i in a] # check items (O(m))''',

'''L1 = range(2, 10000)
L2 = range(200,300)
[i for i in L1 if i in L2]''',

'''S1 = set(range(2, 10000))
S2 = set(range(200,300))
S1.intersection(S2)''',

'''a = range(200,300)
b = range(2, 10000)
any(x in a for x in b)''']

for method in methods:
    print timeit(method, number=1000) 
```

速度：

```
M1: 0.0170331001282 # make one set
M2: 0.0164539813995 # list comprehension
M3: 0.0286040306091 # set intersection
M4: 0.0305438041687 # any

M1: 0.49850320816 # make one set
M2: 25.2735087872 # list comprehension
M3: 0.466138124466 # set intersection
M4: 0.668627977371 # any 
```

始终快速的方法是制作一组（列表），但交集在大型数据集上效果最好！

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-11T15:32:41.770

在某些情况下（例如唯一列表元素），可以使用集合操作。

```
>>> a=[2,3,4]
>>> set(a) - set([2,3]) != set(a)
True
>>> 
```

或者，使用[set.isdisjoint()](http://docs.python.org/library/stdtypes.html#set.isdisjoint)，

```
>>> not set(a).isdisjoint(set([2,3]))
True
>>> not set(a).isdisjoint(set([5,6]))
False
>>> 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-05-11T03:42:03.527

我收集了其他答案和评论中提到的几个解决方案，然后进行了速度测试。`not set(a).isdisjoint(b)`结果是最快的，结果是时也没有放慢多少`False`。

三个运行中的每一个都测试 和 的可能配置的小`a`样本`b`。时间以微秒为单位。

```
Any with generator and max
        2.093 1.997 7.879
Any with generator
        0.907 0.692 2.337
Any with list
        1.294 1.452 2.137
True in list
        1.219 1.348 2.148
Set with &
        1.364 1.749 1.412
Set intersection explcit set(b)
        1.424 1.787 1.517
Set intersection implicit set(b)
        0.964 1.298 0.976
Set isdisjoint explicit set(b)
        1.062 1.094 1.241
Set isdisjoint implicit set(b)
        0.622 0.621 0.753 
```

* * *

```
import timeit

def printtimes(t):
    print '{:.3f}'.format(t/10.0),

setup1 = 'a = range(10); b = range(9,15)'
setup2 = 'a = range(10); b = range(10)'
setup3 = 'a = range(10); b = range(10,20)'

print 'Any with generator and max\n\t',
printtimes(timeit.Timer('any(x in max(a,b,key=len) for x in min(b,a,key=len))',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('any(x in max(a,b,key=len) for x in min(b,a,key=len))',setup=setup2).timeit(10000000))
printtimes(timeit.Timer('any(x in max(a,b,key=len) for x in min(b,a,key=len))',setup=setup3).timeit(10000000))
print

print 'Any with generator\n\t',
printtimes(timeit.Timer('any(i in a for i in b)',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('any(i in a for i in b)',setup=setup2).timeit(10000000))
printtimes(timeit.Timer('any(i in a for i in b)',setup=setup3).timeit(10000000))
print

print 'Any with list\n\t',
printtimes(timeit.Timer('any([i in a for i in b])',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('any([i in a for i in b])',setup=setup2).timeit(10000000))
printtimes(timeit.Timer('any([i in a for i in b])',setup=setup3).timeit(10000000))
print

print 'True in list\n\t',
printtimes(timeit.Timer('True in [i in a for i in b]',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('True in [i in a for i in b]',setup=setup2).timeit(10000000))
printtimes(timeit.Timer('True in [i in a for i in b]',setup=setup3).timeit(10000000))
print

print 'Set with &\n\t',
printtimes(timeit.Timer('bool(set(a) & set(b))',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('bool(set(a) & set(b))',setup=setup2).timeit(10000000))
printtimes(timeit.Timer('bool(set(a) & set(b))',setup=setup3).timeit(10000000))
print

print 'Set intersection explcit set(b)\n\t',
printtimes(timeit.Timer('bool(set(a).intersection(set(b)))',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('bool(set(a).intersection(set(b)))',setup=setup2).timeit(10000000))
printtimes(timeit.Timer('bool(set(a).intersection(set(b)))',setup=setup3).timeit(10000000))
print

print 'Set intersection implicit set(b)\n\t',
printtimes(timeit.Timer('bool(set(a).intersection(b))',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('bool(set(a).intersection(b))',setup=setup2).timeit(10000000))
printtimes(timeit.Timer('bool(set(a).intersection(b))',setup=setup3).timeit(10000000))
print

print 'Set isdisjoint explicit set(b)\n\t',
printtimes(timeit.Timer('not set(a).isdisjoint(set(b))',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('not set(a).isdisjoint(set(b))',setup=setup2).timeit(10000000))
printtimes(timeit.Timer('not set(a).isdisjoint(set(b))',setup=setup3).timeit(10000000))
print

print 'Set isdisjoint implicit set(b)\n\t',
printtimes(timeit.Timer('not set(a).isdisjoint(b)',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('not set(a).isdisjoint(b)',setup=setup1).timeit(10000000))
printtimes(timeit.Timer('not set(a).isdisjoint(b)',setup=setup3).timeit(10000000))
print 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-11T15:26:36.777

这将在一行中完成。

```
>>> a=[2,3,4]
>>> b=[1,2]
>>> bool(sum(map(lambda x: x in b, a)))
True 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-06-28T20:38:18.107

我不得不说，我的情况可能不是你想要的，但它可能会为你的想法提供另一种选择。

我已经尝试了 set() 和 any() 方法，但速度仍然存在问题。所以我记得 Raymond Hettinger 说过，python 中的一切都是字典，只要有可能就使用 dict。所以这就是我尝试的。

我使用带 int 的 defaultdict 来表示否定结果，并使用第一个列表中的项目作为第二个列表的键（转换为 defaultdict）。因为您可以使用 dict 即时查找，所以您可以立即知道该项目是否存在于 defaultdict 中。我知道您并不总是可以更改第二个列表的数据结构，但如果您能够从一开始就这样做，那么它会快得多。您可能必须将 list2（较大的列表）转换为 defaultdict，其中 key 是您要从小列表中检查的潜在值，值是 1（命中）或 0（未命中，默认值）。

```
from collections import defaultdict
already_indexed = defaultdict(int)

def check_exist(small_list, default_list):
    for item in small_list:
        if default_list[item] == 1:
            return True
    return False

if check_exist(small_list, already_indexed):
    continue
else:
    for x in small_list:
        already_indexed[x] = 1 
```

* * *

## 回答 #14

> 赞同：-5
> 
> 时间：2015-05-11T13:58:00.460

简单的。

```
_new_list = []
for item in a:
    if item in b:
        _new_list.append(item)
    else:
        pass 
```

# sql-server - 在 vmware (Windows XP) 上安装 sql server 2000 时出错

> ID：740288
> 
> 赞同：1
> 
> 时间：2009-04-11T15:13:28.757
> 
> 标签：sql-server, sql-server-2000, vmware

安装程序崩溃并指示检查 c:\windows\sqlstp.log 以获取更多信息，以下是日志包含的内容：

```
Connecting to Server ...

driver={sql server};server=JJOHN-vm;UID=sa;PWD=;database=master

[Microsoft][ODBC SQL Server Driver][Shared Memory]General network error. Check your network documentation.

[Microsoft][ODBC SQL Server Driver][Shared Memory]ConnectionRead (WrapperRead()).

driver={sql server};server=JJOHN-vm;UID=sa;PWD=;database=master

[Microsoft][ODBC SQL Server Driver][Shared Memory]General network error. Check your network documentation.

[Microsoft][ODBC SQL Server Driver][Shared Memory]ConnectionRead (WrapperRead()).

driver={sql server};server=JJOHN-vm;UID=sa;PWD=;database=master

[Microsoft][ODBC SQL Server Driver][Shared Memory]General network error. Check your network documentation.

[Microsoft][ODBC SQL Server Driver][Shared Memory]ConnectionRead (WrapperRead()).

SQL Server configuration failed.

###############################################################################

15:57:07 Process Exit Code: (-1) 
15:57:11 Setup failed to configure the server.   Refer to the server error logs and C:\WINDOWS\sqlstp.log for more information.
15:57:11 Action CleanUpInstall:
15:57:11 C:\DOCUME~1\15876\LOCALS~1\Temp\SqlSetup\Bin\scm.exe  -Silent 1 -Action 4 -Service SQLSERVERAGENT
15:57:12 Process Exit Code: (1060) The specified service does not exist as an installed service.

15:57:12 C:\DOCUME~1\15876\LOCALS~1\Temp\SqlSetup\Bin\scm.exe  -Silent 1 -Action 4 -Service MSSQLSERVER
15:57:12 Process Exit Code: (0) 
15:57:12 StatsGenerate returned: 2
15:57:12 StatsGenerate (0x0,0x1,0xf000000,0x300,1033,303,0x0,0x1,0,0,0
15:57:12 StatsGenerate -1,15876)
15:57:12 Installation Failed. 
```

我尝试在仅主机、NAT 和桥接之间切换网络，完全断开网络，除此之外还尝试将 vm RAM 增加到 1gb。

似乎没有任何帮助。知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-17T11:52:08.747

好吧，经过长时间的休息后，我又开始尝试了...

事实证明，这是**HOSTNAME**的问题:) !!!

SQL Server 2000 不会安装在分配了混合大小写或小写主机名的主机上。我重命名了系统，它运行良好。

如果您不愿意重命名您的 comp，Microsoft 提供了一个修复程序来解决此问题：http: [//support.microsoft.com/kb/285100/en-us](http://support.microsoft.com/kb/285100/en-us)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T15:59:57.087

所以从日志中我们可以看到确实安装了 MSSQLSERVER 服务（而 SQLSERVERAGENT 不是无关紧要的）。安装程序尝试使用共享内存协议访问新安装的服务器并失败。我想知道为什么会发生这种情况。网络配置在这里不相关。

你有什么东西可以阻止共享内存的东西吗？可能是具有防泄漏检测功能的高级防火墙。

您是否提供了一些花哨的命令行键来不安装服务器的某些部分或在安装后不启动服务？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T16:02:42.710

如果您尝试通过 RDP 会话安装 SQL Server 2000，它总是会崩溃。如果您仍然在 VM 的控制台上安装它，它可能仍然是一个类似的问题。

# apache-flex - 如何在 Flex 列表中的最后一项之后添加按钮？

> ID：740292
> 
> 赞同：1
> 
> 时间：2009-04-11T15:17:15.783
> 
> 标签：apache-flex, itemrenderer

我在 Flex 中有一个 Horizo​​ntalList，其中包含一些数据和一个表示页面的 ItemRenderer。在列表中的最后一项（页面）之后，我想要一个按钮 - 一个加号来创建一个新页面。

我可以查看哪些数据来获得最后一个 ItemRenderer 的正确 x、y 位置？我得到的位置

```
this.listContent.listItems[this.listContent.listItems.length-1]; 
```

这给了我正确的 ItemRenderer instanceBut，但它的 x 和 y 已用于列表中 ItemRenderer 的索引位置。我想要相对于列表本身以像素为单位的东西，所以我可以在 UpdateDisplayList() 中放置一个按钮。

我有兴趣通过 UIComponent 覆盖而不是通过 ItemRenderer 本身来执行此操作，因为它似乎不应该存在于 dataProvider 中......它需要是 ItemRenderer 的一些奇怪的“lastItem”对象寻找，只是看起来很奇怪。另外，这对于一般列表来说是一个相当有用的功能。

那么，关于这种或其他方法的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T15:24:12.850

很难为最后一个对象获取实际的 itemRenderer，因为 itemRenderer 被重复使用，因此很难确定哪个总是最后一个。检查数据中的“lastItem”变量可能是实现这一点的最简单方法。

但是，您可以将 outerDocument 属性与内联 itemRenderer 一起使用。这使您可以访问列表。

```
<mx:List>
    <mx:itemRenderer>
        <mx:Component>
            <ns1:MyRenderer addLastButton="{outerDocument.myList.dataProvider.index == 10}"/>
        </mx:Component>
    </mx:itemRenderer>
...
</mx:List> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T18:23:33.227

使用[itemEditor](http://www.adobe.com/devnet/flex/quickstart/using_the_repeater/)可能有一种正确的方法，但我会尝试这样的事情：

1.  每次刷新数据时，都会向列表中添加一个额外的空对象。
2.  有一个 itemRenderer 覆盖设置的数据，如此处所示[，](http://www.adobe.com/devnet/flex/articles/itemrenderers_pt2_02.html)它检查对象是否为空，如果是，则将可绑定的布尔值 isAddable 设置为 true。
3.  此布尔值控制 textInput、标签和按钮的可见性和 includeInLayout 属性。
4.  让按钮在单击时调度一个事件，将新项目添加到列表中并进行一些验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-09T14:50:35.447

我认为您可以尝试向 dataProvider 添加一项（带有数据，例如“button”）并为列表创建自定义 itemRenderer，如果 data == “button”，它将其外观更改为 Button（可以通过状态实现）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-21T14:35:05.427

在列表上 - 添加一个事件 creationComplete - 并在其实现中 - 将另一个项目添加到列表中，例如使用某些字符串将其推迟到以前的项目。在您的项目渲染器标记中添加此属性：

```
currentState="{data.sname == '%your string%' ? 'last' : 'normal'}" 
```

而且，当然，添加两个状态：

```
<s:states><br/>
        <mx:State name="normal"/>
        <mx:State name="last"/>
    </s:states> 
```

之后，您可以操作渲染器，根据状态调整文本标签，例如：

```
<s:Label text.normal="{%whatever%}" text.last="this is the last item"/> 
```

希望能帮助到你！

# nhibernate - 是否可以在 NHibernate 中进行标准偏差？

> ID：740293
> 
> 赞同：1
> 
> 时间：2009-04-11T15:21:35.680
> 
> 标签：nhibernate, nhibernate-mapping

是否可以使用 NHibernate 计算标准偏差？我正在使用 Microsoft SQL Server 2005 方言。

我在任何地方都找不到这样的例子。

请帮忙。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T19:12:49.743

只是想让每个人都知道我是如何使用可能对其他人有帮助的代码来实现这一点的：

创建 SessionFactory 时，我只需将自定义 SQL 函数添加到配置对象：

**设置：**

```
var configuration = new Configuration();
configuration.AddSqlFunction("stdev", new StandardSQLFunction("stdev", HibernateUtil.Double));

SessionFactory = configuration.Configure().BuildSessionFactory(); 
```

**用法：**

然后在我的数据提供者中，我现在可以调用自定义函数：

```
ICriteria criteria = _session.CreateCriteria(typeof(ItemHistory));
criteria.SetProjection(Projections.SqlFunction("stdev", NHibernateUtil.Double, Projections.Property("Speed") ));
IList results = criteria.List(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T16:29:21.087

我对 NHibernate 不是很熟悉，但是使用 Java Hibernate，您可以轻松地对现有方言进行子类化以添加额外的功能。像这样的东西可能对你有用（这是 Java 版本）：

```
public class MyDialect extends SQLServerDialect
{
    public MyDialect()
    {
        super();

        // register extra functions (may need to specify parameter types)
        registerFunction( "stdev", new StandardSQLFunction( "stdev" ) );
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T08:15:27.303

[STDEV](http://msdn.microsoft.com/en-us/library/ms190474(SQL.90).aspx)是 SQL Server 的本机 SQL 函数...您可以通过本机查询吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T15:37:06.877

您可以在 HQL（休眠查询语言）中使用本机 SQL 查询，包括聚合函数。请参阅文档中的[第 12 章。](http://knol.google.com/k/fabio-maulo/nhibernate-chapter-12/1nr4enxv3dpeq/15#)

编辑添加：我只是自己阅读，不支持 STDEV。另一种可能可行的方法是创建一个包含计算的视图并映射视图而不是表。进一步的[谷歌搜索](http://www.google.com/search?q=hql+stdev)让我相信文档可能已经过时，或者 NHibernate 的扩展包括 STDEV。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-22T11:25:07.563

我已经通过这段代码以更标准的方式解决了：

```
sqrt((sum(value*value)/count(value)) - (avg(value) * avg(value))) 
```

换句话说，使用支持的其他聚合函数展开标准偏差公式：sum 和 count。

我已经检查了 mysql 中的公式“std()”，除了最低有效数字（误差小于 0.000000001D）外，它都有效。

# java - 如何在 Java 中将 Set 排序为列表？

> ID：740299
> 
> 赞同：174
> 
> 时间：2009-04-11T15:26:06.840
> 
> 标签：java, sorting, collections

在 Java 中，我有一个`Set`，我想把它变成一个 sorted `List`。包中是否有`java.util.Collections`可以为我执行此操作的方法？

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2009-04-11T16:06:02.767

[OP提供](https://stackoverflow.com/questions/740299/how-do-i-sort-a-set-in-java/740301#740301)的答案不是最好的。它效率低下，因为它创建了一个新的`List` *和*不必要的新数组。此外，由于泛型数组的类型安全问题，它会引发“未经检查”的警告。

相反，使用这样的东西：

```
public static
<T extends Comparable<? super T>> List<T> asSortedList(Collection<T> c) {
  List<T> list = new ArrayList<T>(c);
  java.util.Collections.sort(list);
  return list;
} 
```

这是一个使用示例：

```
Map<Integer, String> map = new HashMap<Integer, String>();
/* Add entries to the map. */
...
/* Now get a sorted list of the *values* in the map. */
Collection<String> unsorted = map.values();
List<String> sorted = Util.asSortedList(unsorted); 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-04-11T15:30:26.580

排序集：

```
return new TreeSet(setIWantSorted); 
```

或者：

```
return new ArrayList(new TreeSet(setIWantSorted)); 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2014-09-11T16:05:21.863

以下是使用 Java 8 的 Streams 的方法：

```
mySet.stream().sorted().collect(Collectors.toList()); 
```

或使用自定义比较器：

```
mySet.stream().sorted(myComparator).collect(Collectors.toList()); 
```

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2009-04-11T15:30:30.090

```
List myList = new ArrayList(collection);
Collections.sort(myList); 
```

......但是应该做的伎俩。在适用的情况下使用泛型添加风味。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-03-30T08:23:12.660

使用 Comparator 或 Comparable 接口来提供排序实现总是安全的（如果对象不是原始数据类型的 String 或 Wrapper 类）。作为比较器实现根据姓名对员工进行排序的示例

```
 List<Employees> empList = new LinkedList<Employees>(EmpSet);

    class EmployeeComparator implements Comparator<Employee> {

            public int compare(Employee e1, Employee e2) {
                return e1.getName().compareTo(e2.getName());
            }

        }

   Collections.sort(empList , new EmployeeComparator ()); 
```

当您需要对同一对象使用不同的排序算法时（比如雇员姓名、雇员工资等），比较器很有用。可以通过在所需对象中使用 Comparable 接口来实现单模式排序。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-11T15:26:44.950

没有单一的方法可以做到这一点。用这个：

```
@SuppressWarnings("unchecked")
public static <T extends Comparable> List<T> asSortedList(Collection<T> collection) {
  T[] array = collection.toArray(
    (T[])new Comparable[collection.size()]);
  Arrays.sort(array);
  return Arrays.asList(array);
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-06-11T05:51:24.633

您可以将 set 转换为`ArrayList`，您可以在其中对`ArrayList`using进行排序`Collections.sort(List)`。

这是代码：

```
keySet = (Set) map.keySet();
ArrayList list = new ArrayList(keySet);     
Collections.sort(list); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-10-07T15:57:03.423

```
TreeSet sortedset = new TreeSet();
sortedset.addAll(originalset);

list.addAll(sortedset); 
```

其中 originalset = 未排序的集合和 list = 要返回的列表

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-02-01T15:02:15.567

@Jeremy Stein 我想实现相同的代码。我也想将集合排序为列表，因此我没有使用 Set 将集合值转换为 List 并按它的一个变量对该列表进行排序。这段代码帮助了我，

```
set.stream().sorted(Comparator.comparing(ModelClassName::sortingVariableName)).collect(Collectors.toList()); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-17T17:50:15.607

我正在使用这段代码，我发现它比上面接受的答案更实用：

```
List<Thing> thingList = new ArrayList<>(thingSet);
thingList.sort((thing1, thing2) -> thing1.getName().compareToIgnoreCase(thing2.getName())); 
```

# jcl - 符号 JCL 混淆

> ID：740302
> 
> 赞同：4
> 
> 时间：2009-04-11T15:28:18.863
> 
> 标签：jcl

我对如何在 JCL 中为我在 COBOL 类中进行的分配创建符号变量感到有些困惑。

例如，我应该“为 PARM 选项指定一个符号参数，并将 TEST 和 APOST 指定为默认值。”

如何将“PARM”选项指定为符号参数？

编辑：原谅疏忽；似乎我忘了提及我正在运行的操作系统。我正在 z/OS 中编写这个 JCL 文件。

提前致谢！

编辑：

@avisser：

所以，你的意思是我可以称之为“&PARM='TEST,APOST'”，如果我想在使用另一个 JCL 语句运行这个 proc 时更改该参数，列出的参数可以从打电话给 JCL？

编辑：

@avisser：

是的，抱歉，我真的需要更具体一些……在我的 COBOL JCL 中，我调用了 COBOL 编译器 (IGYCRCTL)、链接编辑器 (HEWL) 和程序提取 (EXEC PGM=)。

编辑：

也许看看我的输出是什么会有所帮助。我真的很感谢到目前为止所有试图提供帮助的人。

输出：

------ JES2 工作统计 ------

```
 37 CARDS READ                                                                                                            

       61 SYSOUT PRINT RECORDS                                                                                                  

        0 SYSOUT PUNCH RECORDS                                                                                                  

        3 SYSOUT SPOOL KBYTES                                                                                                   

     0.00 MINUTES EXECUTION TIME 
```

！！JES 假脱机文件结束！1 //KC03CEFA JOB ,'MATT R',MSGCLASS=H,TYPRUN=SCAN JOB07731 //*
2 //STEP01 EXEC PGM=IGYCRCTL,®ION=248K,
// &PARM='TEST,APOST'
3 //STEPLIB DD DSN =IGY340.SIGYCOMP,DISP=SHR
/*
4 //SYSLIN DD &DSN=&&OBJSET,UNIT=DISK,SPACE=(TRK,(3,3)),
// &DISP=(NEW,PASS,DELETE)
5 //SYSPRINT DD SYSOUT=*
6 //SYSUT1 DD UNIT=DISK,SPACE=(CYL,(1,1))
7 //SYSUT2 DD UNIT=DISK,SPACE=(CYL,(1,1))
8 //SYSUT3 DD UNIT =DISK,SPACE=(CYL,(1,1))
9 //SYSUT4 DD UNIT=DISK,SPACE=(CYL,(1,1))
10 //SYSUT5 DD UNIT=DISK,SPACE=(CYL,(1) ,1))
11 //SYSUT6 DD UNIT=DISK,SPACE=(CYL,(1,1))
12 //SYSUT7 DD UNIT=DISK,SPACE=(CYL,(1,1))
//*
//*
13 //STEP02 EXEC PGM=HEWL,&COND=,&REAGION=2048K,
// &PARM=
14 //SYSLIB DD DSN=CEE.SCEELKED,DISP=SHR
15 //SYSLIN DD &DSN=&&OBJSET,&DISP=(OLD,DELETE)
16 //SYSLMOD DD DSN=&&TEMPLIB(PGM6),
// SPACE=(1024,(50,20,1)),UNIT=DISK,
// DISP=(NEW,CATLG,DELETE)
17 //SYSPRINT DD SYSOUT=*
18 //打印机 DD SYSOUT=*
19 //SYSUT1 DD UNIT=DISK,SPACE=(TRK,(10,10))
//*
//*
20 //STEP01 EXEC PGM=PGM6,&PARM=TERMTHDACT(DUMP)
21 //STEPLIB DD DSN=&&TEMPLIB,DISP=SHR
22 //CEEDUMP
23 //SYSUDUMP
24 //PRINTER DD SYSOUT=*
25 //PRODUCTS DD DSN= KC02322.CSCI465.SP09(DATA1),DISP=SHR
26 //SYSIN DD *
！！JES 假脱机文件结束！STMT 编号 MESSAGE 2 IEFC630I不知名KEYWORD＆REGION 2 IEFC630I不知名KEYWORD＆PARM 4 IEFC630I不知名KEYWORD＆DSN 4 IEFC630I不知名KEYWORD＆DISP 13 IEFC630I不知名KEYWORD＆COND 13 IEFC630I不知名KEYWORD＆REAGION 13 IEFC630I不知名KEYWORD＆PARM 15 IEFC630I不知名KEYWORD＆DSN 15 IEFC630I不知名KEYWORD＆DISP 20 IEFC630I不知名KEYWORD &PARM 22 IEFC605I 未识别的操作区域 23 IEFC605I 未识别的操作区域！JES 假脱机文件结束！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T16:35:14.583

符号参数是前面带有 & 符号的名称。在 JCL 语句中使用时，它们会在运行时转换为提供的值。创建它们的一种方法（在 z/OS 上）是使用

`// SET name = value`

宣言。如果您使用 PARM，您应该设计您的程序，以便它可以与 PARM 一起使用。也许任务是关于如何做到*这一点*（提示：链接部分）。还是 JCL 是您的 COBOL 类的一部分？

TEST 和 APOST 在我看来就像编译器指令。我不知道你是否可以在你的程序中指定它们，在我的工作场所，我们只在调用编译器时提供它们。

编辑：

好吧，这对我来说有点不寻常，因为我们倾向于在单独的 JCL 流中编译和运行我们的程序。但无论如何。

采取你的第二个陈述：

```
2 //STEP01 EXEC PGM=IGYCRCTL,&REGION=248K,
  // &PARM='TEST,APOST' 
```

REGION 和 PARM 是所谓的位置参数，它们是关键字，并不是真的要以符号名称的形式呈现，尽管您可以自由地这样做（这将解释“未识别的关键字”消息）。
常见用途（如果适用）是为此类参数的*操作数提供符号名称。*显然，您必须首先为它们定义一个值，例如：

```
 // SET OPTIONS='TEST,APOST'
  //STEP01 EXEC PGM=IGYCRCTL,REGION=248K,
  // PARM=&OPTIONS 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T14:01:41.113

好的，我进行了一些挖掘，并且在 avisser 给我的指导下，我能够弄清楚我必须做什么。因此，对于任何可能有这个问题（或类似问题）的人，以供将来参考，以下是我的发现：

第 1 步：使用您将使用的变量创建一个“PROC”。

前任。我想在我的 COBOL 编译器中使用具有“TEST”和“APOST”默认值的“PARM”变量，所以我写了如下内容：

```
//PROC1  PROC  CPARM='TEST,APOST', 
```

第 2 步：在您的实际 JCL 步骤中使用那些新定义的符号参数。“&”字符表明它后面的任何内容都是符号参数。

前任。我在 COBOL 编译步骤中使用了前面提到的“CPARM”：

```
//COB    EXEC  PGM=IGYCRCTL,REGION=&CREGION,  
//             PARM='&CPARM' 
```

第 3 步：在实际步骤之后用“PEND”语句结束“PROC”。

前任。在我列出了所有变量并列出了所有编译步骤（编译器名称、编译器所在的位置，以及在 PEND 语句之前可以看到的 SYSUT1-SYSUT7 语句）之后，放置您的 PEND 关键字：

```
//SYSUT7   DD UNIT=DISK,SPACE=(CYL,(1,1))  
//         PEND 
```

第 4 步：将任何额外的 JCL 步骤和/或代码添加到您的源文件中，然后您就可以离开了！

笔记：

- 在一个 JCL 文件中可以有多个 PROC 语句。我有三个：一个用于 COBOL 编译，一个用于链接编辑器，一个用于程序获取。我的 PROC 语句所在的文件中也有 COBOL 代码。

- 这发生在运行 z/OS 的 IBM 大型机上。

- 上面，可以看出我的“CPARM”变量设置为默认的“TEST，APOST”。默认情况下，只需将该字段留空（例如 CPARM=,），就可以使变量为空。

-您可能已经注意到，CPARM定义后，有一个逗号；这是因为我有更多的变量。请记住，您为任何给定 PROC 创建的最后一个符号参数后面应该没有任何内容（即没有逗号）。当然，您可以在之后放置注释行 (//*)、另一个 PROC 或实际代码，但最后一个符号参数在同一行上不应有任何内容。

# actionscript-3 - 如何修改此缓动功能以减少反弹？

> ID：740308
> 
> 赞同：3
> 
> 时间：2009-04-11T15:30:56.733
> 
> 标签：actionscript-3, animation

我正在尝试修改 Flash CS3 提供的`fl.motion.easing.bounce`函数，以使生成的动画反弹更少。我很欣赏'bounceless'有点含糊，但我希望能在理解该功能方面提供任何帮助。

谢谢。

```
 /**
 *  @param t Specifies the current time, between 0 and duration inclusive.
 *
 *  @param b Specifies the initial value of the animation property.
 *
 *  @param c Specifies the total change in the animation property.
 *
 *  @param d Specifies the duration of the motion.
 *
 *  @return The value of the interpolated property at the specified time.     
 */  
public static function easeOut(t:Number, b:Number,
                               c:Number, d:Number):Number
{
    if ((t /= d) < (1 / 2.75))
        return c * (7.5625 * t * t) + b;

    else if (t < (2 / 2.75))
        return c * (7.5625 * (t -= (1.5 / 2.75)) * t + 0.75) + b;

    else if (t < (2.5 / 2.75))
        return c * (7.5625 * (t -= (2.25 / 2.75)) * t + 0.9375) + b;

    else
        return c * (7.5625 * (t -= (2.625 / 2.75)) * t + 0.984375) + b;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T16:04:03.333

基本上，该函数根据 4 个因素返回新位置的插值值：动画的当前时间、正在动画的属性的初始值、要完成的动画的总变化以及动画的总持续时间。

你有一个检查不同的时间：如果动画仍然没有达到总持续时间的大约 36% (1 / 2.75)，应用第一个方程；如果介于 36% 和 72% 之间，则应用第二个；等等

每个方程都是取决于第一个树参数的函数，所以基本上你需要稍微调整它们。

我建议您使用硬编码的 7.5625（使其更大或更小以查看结果）直到您满意为止。

* * *

`7.5625`是，但经过`Math.pow(2.75, 2);`硬编码以节省处理时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T23:00:45.467

我知道这也不会给你一个明确的答案，但这些方程式是由 Robert Penner 在他的《[Programing Macromedia Flash MX](https://rads.stackoverflow.com/amzn/click/com/0072223561) 》一书中首次构思的。我知道这不是一个简单的答案，但在他的书中，他详细解释了这些功能是如何工作的。要真正了解，您可能想拿起一份副本并深入研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-19T06:09:53.500

尝试放大第一次触地时间，减少弹跳时间，我先做全距离1.4/2.7，然后1.4~2.1，这个范围是0.7，半范围是0.35,0.35*0.35=0.1225,1-0.1225 =0.8775，看起来不错，如果要降低弹跳范围，请尝试使用这个概念：减小两个时间点的范围。

```
 t /= d;
    if (t < 1.4 / 2.75) {
        return 3.858419 * t * t;
    }
    else if (t < 2.1 / 2.75) {
        t -= 1.75f / 2.75;
        return 7.5625 * t * t + 0.8775f;
    }
    else if (t < 2.5 / 2.75) {
        t -= 2.3f / 2.75;
        return 7.5625 * t * t + 0.96f;
    }
    t -= 2.625f / 2.75;
    return 7.5625 * t * t + 0.984375f; 
```

# iphone - 有谁知道网站如何生成 Apple App Store 更新的应用程序提要？

> ID：740310
> 
> 赞同：4
> 
> 时间：2009-04-11T15:33:04.000
> 
> 标签：iphone, rss, app-store

许多网站在 Apple iPhone App Store 上有更新和新应用程序的 RSS 源。但是，Apple 的 rss 提要生成器仅显示前 100 名免费/付费应用的提要。那么如何以与所有这些人相同的方式生成我自己的新/更新应用程序数据库呢？他们正在访问什么神奇的提要？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T09:39:34.190

Apple 有一个[用于 iTunes 的 RSS 生成器](http://itunes.apple.com/rss/generator/)。

> 提供下面要求的信息，然后单击生成以查看提要 URL。这些提要会自动更新以反映 iTunes 的热门排行榜和新内容，因此您将始终了解 iTunes Store 中的最新信息。

例如，前 10 名应用程序是`http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/ws/RSS/topfreeapplications/sf=143441/limit=10/xml`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2011-10-06T15:21:30.240

这看起来不错：[http](http://appstorefeeds.com/) ://appstorefeeds.com/ 。

它是一个完整的提要集合。

# php - 枚举mysql查询中使用的表？

> ID：740316
> 
> 赞同：2
> 
> 时间：2009-04-11T15:37:24.363
> 
> 标签：php, mysql, tags, enumerate

有没有办法枚举mysql查询中使用的表？

可以说我有疑问：

```
SELECT * FROM   db_people.people_facts pf
INNER JOIN db_system.connections sm ON sm.source_id = pf.object_id
INNER JOIN db_people.people p ON sm.target_id = p.object_id
ORDER BY pf.object_id DESC 
```

我想要返回数组：

```
$tables = array(
[0] => 'db_people.people_facts',
[1] => 'db_system.connections',
[2] => 'db_people.people',
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-11T17:01:58.763

是的，您可以获得有关作为查询结果一部分的表和列的信息。这称为**结果集元数据**。

MySQL 结果集元数据的唯一 PHP 解决方案是使用 MySQLi 扩展和[`mysqli_stmt::result_metadata()`](http://php.net/manual/en/mysqli-stmt.result-metadata.php)函数。

```
$stmt = $mysqli->prepare("SELECT * FROM   db_people.people_facts pf
  INNER JOIN db_system.connections sm ON sm.source_id = pf.object_id
  INNER JOIN db_people.people p ON sm.target_id = p.object_id
  ORDER BY pf.object_id DESC");

$meta = $stmt->result_metadata();

$field1 = $meta->fetch_field();

echo "Table for field " . $field1->name . " is " . $field1->table . "\n"; 
```

您必须通过遍历字段来自己构建查询中使用的不同表的数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T15:43:17.237

根据您使用它的目的，MySQL 的 EXPLAIN 可以为您解决问题：

[http://dev.mysql.com/doc/refman/5.0/en/explain.html](http://dev.mysql.com/doc/refman/5.0/en/explain.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-03T22:47:37.270

标记为好的解决方案将仅返回结果表。但是，如果您执行下一个查询，它将失败：

```
SELECT users.* FROM users, cats, dogs WHERE users.id = cats.user_id 
```

将**只返回用户**而不是猫和狗表。

最好的解决方案是找到一个好的解析器，另一个解决方案是使用 REGEX 和 EXPLAIN 查询（​​更多信息在下一个链接中）：

[在查询中获取 mysql 表](https://stackoverflow.com/questions/3397568/get-mysql-tables-in-a-query)

但我认为另一个好的解决方案是***列出所有表并在查询中搜索它们***，您可以缓存表列表。

**编辑**：在搜索表格时，最好使用 preg，例如：

```
// (`|'|"| )table_name(\1|$)
if(preg_match('/(`|\'|"| )table_name(\1|$)/i', $query))
    // found 
```

如果不是，它可能会返回误报，例如“table_name2”、“table_name3”... table_name 将返回 FOUND 两次。

# javascript - 生成渐变的片段的奇怪问题

> ID：740327
> 
> 赞同：1
> 
> 时间：2009-04-11T15:47:29.863
> 
> 标签：javascript, algorithm, gradient

我使用自己的库来做很多东西，最近我决定添加渐变功能，但我遇到了一个我似乎记得不久前也遇到过的问题，这就是我的渐变稍微偏离了附近的问题结束。首先，有问题的代码：

```
gradient = function(l, g)
 {
var r = [], s = [], f = g.length - 1;
for (var x = 0; x < g.length; x++)
    g[x] = (typeof(g[x]) == 'string' ? g[x] : g[x].join(','))._replace(['#', ' ', 'rgb(', ')'], ''),
    g[x] = (g[x].indexOf(',') != -1
        ? g[x].split(',')
        : g[x].chunk(2).map(function(_)
         {
            return _.fromBase('hex');
         }));
for (var x = 0; x < f; x++)
    s[x] = [(g[x][0] - g[x + 1][0]) / (l - 1) * f, (g[x][1] - g[x + 1][2]) / (l - 1) * f, (g[x][2] - g[x + 1][2]) / (l - 1) * f];
for (var x = 0; x < l; x++)
    r[x] = '', ([0, 1, 2]).map(function(_)
     {
        var c = Math.floor(x / (l / (g.length - 1)));
        r[x] += (g[c][_] - s[c][_] * (x - (l / (g.length - 1)) * c)).toBase('hex').pad('0', 2);
     });
return r;
 }; 
```

当然，我的图书馆：[http ://wimg.co.uk/HJ0X8B.js](http://wimg.co.uk/HJ0X8B.js)

在那里玩得开心！: ) 如果您认为您可能能够以任何方式提供帮助，我在渐变片段中使用的自定义函数是 _replace()、chunk()、map()、toBase() 和 fromBase()...正如您将能够在[此演示页面](http://howironique.myartsonline.com/grad_t.html)中看到的那样，一切都非常有效（至少在 Opera 和 Firefox 中）除了渐变在最后稍微偏离（悬停以显示十六进制值）。例如，调用`gradient(50, ['ffffff', 'ffff00', '00ff00'])`确实创建了一个长度为 50 的数组，其中包含逐渐从红色变为黄色然后变为石灰的十六进制颜色值，但是最后一种颜色并不完全是石灰（在这种情况下，它是 05ff00）；这意味着在数学而不是方法论中有些许偏差。

所以...有人愿意在丛林中跋涉，我觉得代码非常漂亮，可以帮助我找到解决方案吗？非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T18:07:44.157

```
gradient = function(l, g)
 {
var r = [], s = [], f = g.length - 1;
for (var x = 0; x < g.length; x++)
    g[x] = (typeof(g[x]) == 'string' ? g[x] : g[x].join(','))._replace(['#', ' ', 'rgb(', ')'], ''),
    g[x] = (g[x].indexOf(',') != -1
        ? g[x].split(',')
        : g[x].chunk(2).map(function(_)
         {
            return _.fromBase('hex');
         }));
for (var x = 0; x < f; x++)
    s[x] = [(g[x][0] - g[x + 1][0]) / (l - 1) * f, (g[x][1] - g[x + 1][1]) / (l - 1) * f, (g[x][2] - g[x + 1][2]) / (l - 1) * f];
for (var x = 0; x < l; x++)
    r[x] = '', ([0, 1, 2]).map(function(_)
     {
        var c = Math.floor(x / (l / (g.length - 1)));
        r[x] += (g[c][_] - s[c][_] * (x - ((l-1) / (g.length - 1)) * c)).toBase('hex').pad('0', 2);
     });
return r;
 }; 
```

在最后一个计算行上使用 (l-1) 而不是 l，因为您已经为 l-1 步而不是 l 准备了 s 数组。

顺便说一句，您的代码真的很难理解，请尝试编写更易于理解和标准的代码。并且写 for 循环而不是 [0, 1, 2].map(sth)。

# .net - 将 TAB 发送到子控制台（Windows）

> ID：740329
> 
> 赞同：2
> 
> 时间：2009-04-11T15:51:29.883
> 
> 标签：.net, console, tab-completion

我创建了一个子控制台应用程序

```
_process = new Process();
_process.StartInfo.FileName = @"cmd.exe";
_process.StartInfo.UseShellExecute = false;
_process.StartInfo.RedirectStandardInput = true;
_process.StartInfo.RedirectStandardOutput = true;
_process.StartInfo.CreateNoWindow = true;

_proccess.Start(); 
```

现在我可以去 c:\aaa

```
_process.StandardInput.Write("cd c:\\aaa\xD\xA"); 
```

但通常用户可以键入 c:\ + TAB + ENTER。我该怎么做？这不起作用：

```
_process.StandardInput.Write("cd c:\\\0x9\xD\xA"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-01T18:25:18.387

子进程的*标准输入*和它所附加的控制台之间存在根本区别。交互模式下的命令解释器期望与控制台*或管道/文件作为其标准输入进行对话**，*并且它会更改其行为以匹配它找到的那个。对于管道/文件，它只是简单地调用[`ReadFile()`](http://msdn.microsoft.com/en-gb/library/aa365467%28VS.85%29.aspx "读取文件功能")函数。但是，对于控制台，它通过 接收输入[`ReadConsoleInput()`](http://msdn.microsoft.com/en-gb/library/ms684961%28VS.85%29.aspx "ReadConsoleInput 函数")，其中非字母数字键可通过其虚拟键码识别。

有关示例，请参见[`ReadCommand()`](http://doxygen.reactos.org./da/d2c/base_2shell_2cmd_2cmd_8h_ab56d2b86e2487d35eab0eae73ba5afcb.html#ab56d2b86e2487d35eab0eae73ba5afcb "读取命令（）")ReactOS 中的函数。`CMD`

如果您将一个值为 9 的字节沿管道写入进程的标准输入，这就是它从对`ReadFile()`. 但它不会将其视为`Tab`按键，因为（对于初学者）它不是一个；它只是一个字节值 9 从管道中传下来。此外，命令解释器在交互模式下执行的命令行编辑仅在检测到标准输入是控制台时发生，而不是在它是管道或文件时发生。命令解释器使用`ReadConsoleInput()`，它不读取字节缓冲区，而是读取 ; 序列[`INPUT_RECORDs`](http://msdn.microsoft.com/en-gb/library/ms683499%28VS.85%29.aspx "INPUT_RECORD 结构")。因此，如果您希望命令解释器在其输入流中看到按键，您必须[`WriteConsoleInput()`](http://msdn.microsoft.com/en-gb/library/ms687403%28VS.85%29.aspx "写控制台输入函数")对该控制台处理适当`INPUT_RECORD`的模拟键。`Tab``Tab`

当然，既然您已经设置`StartInfo.RedirectStandardInput`为`true`，在幕后 .NET 已经将命令解释器进程的标准输入连接到管道；所以命令解释器只是调用`ReadFile()`，而不做任何交互式命令行编辑，就像它的标准输入是一个控制台一样。即使您可以找到并打开命令解释器进程控制台的句柄，并为它写一个`INPUT_RECORD`for`Tab`键，命令解释器仍在读取其标准输入的管道，并忽略其控制台。

如果您希望命令解释器像与控制台对话、命令行编辑等一样工作，您必须*使用标准输入作为控制台*生成进程，您必须（然后）获得其句柄您可以使用 模拟按键`WriteConsoleInput()`。这在 .NET 中相当困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-23T05:26:25.463

浸入 Windows API 怎么样？

```
using System.Runtime.InteropServices;
//...
[DllImport("user32.dll")]
private static extern IntPtr SendMessage(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);
private const int WM_CHAR = 0x0102;
private const int VK_TAB = 0x9;
private const int VK_RETURN = 0xD;
//...
SendMessage(_process.Handle, WM_CHAR, new IntPtr(VK_TAB), new IntPtr(0));
SendMessage(_process.Handle, WM_CHAR, new IntPtr(VK_RETURN), new IntPtr(0)); 
```

[但是，根据Kevin Montrose 在此处的回答](https://stackoverflow.com/questions/1220820/how-do-i-send-key-strokes-to-a-window-without-having-to-activate-it-using-windows/1230643#1230643)，这并不总是有效。

# c# - 如何使用 Invoke 访问表单属性，但在 C# 中使用对象参数？

> ID：740337
> 
> 赞同：0
> 
> 时间：2009-04-11T15:56:12.570
> 
> 标签：c#, oop, parameters, invoke

我无法最好地描述我的问题的标题，对不起。目前，我使用 Invoke 访问表单上的属性，它运行良好，但我对每个属性都有一个函数，这很不舒服。

```
 public static void EnableLogin(int enabled)
    {
        var form = Form.ActiveForm as FormMain;
        if (form != null)
            form.EnableLogin = enabled;
    }

    public static void EnableConfirm(int enabled)
    {
        var form = Form.ActiveForm as FormMain;
        if (form != null)
            form.EnableConfirm = enabled;
    }

    public static void EnableRetry(int enabled)
    {
        var form = Form.ActiveForm as FormMain;
        if (form != null)
            form.EnableRetry = enabled;
    }

    public static void EnableTABLogin(int enabled)
    {
        var form = Form.ActiveForm as FormMain;
        if (form != null)
            form.EnableTABLogin = enabled;
    } 
```

这些功能中的每一个看起来都是这样的

```
 public int EnableLogin
    {
        set
        {
            if (this.InvokeRequired)
            {
                this.Invoke((MethodInvoker)delegate
                {
                    if (value == 0)
                        this.btnLogin.Enabled = false;
                    else
                        this.btnLogin.Enabled = true;
                });
            }
            else
            {
                if (value == 0)
                    this.btnLogin.Enabled = false;
                else
                    this.btnLogin.Enabled = true;
            }
        }
    } 
```

我的问题是，我不能那样做吗

```
 public static void EnableObject(object name)
    {
        var form = Form.ActiveForm as FormMain;
        if (form != null)
            form.Enable + name = enabled;
    } 
```

绝对不是那样，我想不出更多的面向对象的东西，但是与其用相同的代码编写大量函数，我不能通过传递我想更改的对象来使用一个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T16:01:08.737

您可以创建一个方法，该方法接受一个描述要执行的操作的委托参数。然后你可以摆脱重复的代码。

下面是一个示例：我在表单上创建了一个名为 PerformAction 的公共方法。它需要一个 Action<MainForm> 委托作为参数；这个委托描述了应该采取的行动。

应该尽可能使用实例方法，但为了完整起见，我创建了一个从 Form.ActiveForm 获取 Form 实例的静态版本。

代码如下所示：

```
using System;
using System.Windows.Forms;

namespace WinFormTest
{
    public partial class MainForm : Form
    {
        public void PerformAction(Action<MainForm> action)
        {
            if (InvokeRequired)
                Invoke(action,this);
            else
                action(this);
        }

        public static void PerformActionOnMainForm(Action<MainForm> action)
        {
            var form = ActiveForm as MainForm;
            if ( form!= null)
                form.PerformAction(action);
        }
    }
} 
```

然后可以从另一个线程像这样使用：

```
 MainForm.PerformActionOnMainForm(form => form.Text = "My form");
    // The action can also be a code block or a method:
    MainForm.PerformActionOnMainForm(form =>
                                         {
                                             form.Width = 200;
                                             form.Height = 300;
                                             form.Left = 100;
                                             form.Top = 200;
                                         }); 
```

PerformAction 也可以是通用的，因此您可以在任何表单上使用它。那么签名将是：

```
public void PerformAction<T>(Action<T> action) 
    where T : Form 
    { 
        ... 
    } 
```

如果您有一个在表单之间共享的公共基类，那么这样声明它是有意义的。或者，您可以创建一个包含该方法的辅助类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T16:10:12.817

我问了一个[类似的问题](https://stackoverflow.com/questions/657037/why-the-overhead-for-multi-threaded-access-to-wpf-ui-controls)，但是对于 WPF，原理是一样的。修改 Jon skeet 为您的问题提供给我的答案，您可以使用以下内容：

```
public static void InvokeIfNecessary(Form form, MethodInvoker action)
{    
     if (form.InvokeRequired)    
     {        
          form.Invoke(DispatcherPriority.Normal, action);    
     }    
     else    
     {        
          action();    
     }
}

public static void EnableLogin(int enabled)    
{        
    var form = Form.ActiveForm as FormMain;        
    if (form != null)            
        InvokeIfNecessary(form, delegate { form.btnLogin.Enabled = (enabled != 0) });    
} 
```

编辑：从使用 form.Dispatcher 更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T17:30:36.183

您可以将重用的功能移动到两个单独的静态方法（一个扩展）中，这将大大简化您在静态助手和属性中拥有的内容。

```
public static class FormHelpers
{
  public static void InvokeOnActive<TForm>(Action<TForm> action)
    where TForm : Form
  {
    TForm activeForm = Form.ActiveForm as TForm;
    if (activeForm != null)
      activeForm.InvokeEx(f => { action(f); return f; });
  }
}

public static class ControlExtensions
{
  public static TResult InvokeEx<TControl, TResult>(this TControl control,
                                              Func<TControl, TResult> func)
    where TControl : Control
  {
    if (control.InvokeRequired)
      return (TResult)control.Invoke(func, control);
    else
      return func(control);
  }
} 
```

对于您的财产：

```
public int EnableLogin
{
  set { this.InvokeEx(f => f.btnLogin.Enabled = value == 0); }
} 
```

对于您的静态助手：

```
public static void EnableLogin(int enabled)
{
  FormHelpers.InvokeOnActive<FormMain>(f => f.EnableLogin = enabled);
} 
```

# c# - 在 ASP.NET 中创建文件夹并将图像上传到该文件夹 的最佳方法是什么？

> ID：740342
> 
> 赞同：3
> 
> 时间：2009-04-11T15:59:53.123
> 
> 标签：c#, asp.net, vb.net, image

关于我必须如何在我的根目录中创建一个文件夹说“pics”然后将文件上传控件中的图像上传到该“pics”文件夹中的任何代码示例？如果你不想给我所有的代码，我会很高兴有一个很好的链接也可以告诉我这将如何在 VB.NET 中完成（C# 也可以）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-11T16:09:00.950

Try/Catch 就在你身上 :)

```
public void EnsureDirectoriesExist()
        {

                // if the \pix directory doesn't exist - create it. 
                if (!System.IO.Directory.Exists(Server.MapPath(@"~/pix/")))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath(@"~/pix/"));
                }

        }

        protected void Button1_Click(object sender, EventArgs e)
        {

                if (FileUpload1.HasFile && Path.GetExtension(FileUpload1.FileName) == ".jpg")
                {
                    // create posted file
                    // make sure we have a place for the file in the directory structure
                    EnsureDirectoriesExist();
                    String filePath = Server.MapPath(@"~/pix/" + FileUpload1.FileName);
                    FileUpload1.SaveAs(filePath);

                }
                else
                {
                    lblMessage.Text = "Not a jpg file";
                }

        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T02:06:38.343

这就是我将如何做到这一点。

```
 protected void OnUpload_Click(object sender, EventArgs e)
    {
        var path = Server.MapPath("~/pics");
        var directory = new DirectoryInfo(path);

        if (directory.Exists == false)
        {
            directory.Create();
        }

        var file = Path.Combine(path, upload.FileName);

        upload.SaveAs(file);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-09T08:44:21.497

在文件夹内创建文件夹并上传文件

```
 DirectoryInfo info = new DirectoryInfo(Server.MapPath(string.Format("~/FolderName/") + txtNewmrNo.Text)); //Creating SubFolder inside the Folder with Name(which is provide by User).
    string directoryPath = info+"/".ToString();
    if (!info.Exists)  //Checking If Not Exist.
    {
        info.Create();
        HttpFileCollection hfc = Request.Files;
        for (int i = 0; i < hfc.Count; i++) //Checking how many files in File Upload control.
        {
            HttpPostedFile hpf = hfc[i];
            if (hpf.ContentLength > 0)
            {
                hpf.SaveAs(directoryPath + Path.GetFileName(hpf.FileName)); //Uploading Multiple Files into newly created Folder (One by One).
            }
        }
    }
    else
    {
        ClientScript.RegisterStartupScript(this.GetType(), "alert", "alert('This Folder already Created.');", true);
    } 
```

# visual-studio-2008 - 卸载 Visual Studion 2008 Express 需要卸载哪些程序？

> ID：740347
> 
> 赞同：1
> 
> 时间：2009-04-11T16:02:37.673
> 
> 标签：visual-studio-2008, uninstallation, addremoveprograms

我是一名新手工具用户，但需要为我正在学习的课程加载 VS 2008，我们只使用过一次。我没有在我的一次使用中注册该副本，现在 6 个月后需要将 VS 2005 用于另一堂课。我的问题 - 我需要卸载 2008 并安装 2005。我不确定要从“添加/删除程序”列表中卸载哪些程序。我需要具体的名字和顺序，这样我才能正确地做，而不是搞砸。

我知道很多人会说为什么不只使用 2008 - 好吧，我的笔记本电脑上确实有 2008，但它似乎没有教师在 2005 上使用的某些模板，例如“Windows 应用程序模板”。我是在 2008 年遗漏了什么，还是我不明白的其他名称或位置。

任何帮助是极大的赞赏。

谢谢，罗宾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T19:09:26.053

你真的不需要卸载任何东西。继续安装 Visual Studio 2005。它们并肩工作，没有任何问题。哎呀，我的工作站上有 4 个版本的 Visual Studio。

如果必须，您需要删除：

*   微软视觉工作室 2008 ...
*   微软文档资源管理器 2008
*   Visual Studio 2008 的 MSDN 库 [如果您安装了它]
*   Microsoft SQL Server (Express) [如果您安装了它]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T16:18:10.350

[您可以尝试按照此处](https://www.johncmurphy.com/category.aspx?cid=91)所述重新安装模板。

对于删除程序，请查看此页面：

[http://www.microsoft.com/express/support/uninstall/default.aspx](http://www.microsoft.com/express/support/uninstall/default.aspx)

它适用于预发布版本，但它具有程序列表以及您应该删除它们的顺序。

我希望这有帮助。

# c# - C# 数据结构问题（使用哪个集合？）

> ID：740349
> 
> 赞同：3
> 
> 时间：2009-04-11T16:03:41.210
> 
> 标签：c#, list, data-structures, sortedlist

我需要实现大量 Widget 对象，每个对象都包含一个唯一的文件路径字符串（“FilePath”）。我需要能够执行以下操作：

1.  给定文件路径，快速检索 Widget 对象
2.  在不创建新对象的情况下更改 Widget 的文件路径（多个其他对象可能包含对单个 Widget 的引用，并且跟踪它们会影响性能）
3.  给定一个 Widget 引用，确定它的文件路径

我首先想到的是使用文件路径作为键的通用 SortedList，但是为数千个对象复制路径会很快耗尽内存。我考虑从对象中删除路径并将其仅存储在键列表中，但这会使上述要求 3 难以实现。

我现在倾向于滚动我自己的从 List<> 派生的类，它以排序顺序添加 Widget 对象，并使用二进制搜索检索它们。要求 2 可以简单地通过从列表中删除一个对象、更改它的文件路径并将其添加回列表来完成。

但我对 C# 比较陌生，我想在这里与伟大的思想家核实一下，看看我是否遗漏了另一个明显的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-11T16:09:23.523

你不能用两本字典吗？

```
Dictionary<string, Widget> WidgetsByPath;
Dictionary<Widget, string> PathsByWidget; 
```

处理会产生更多开销（因为您需要在插入、修改或删除元素时更新两个字典），但您可能只会插入一次查找多次，因此应该足够了。

你甚至可以围绕它构建一个简单的类：

```
public class Widgets
{
  public Widget Add(string Path, Widget wdg)
  {
    // Chek it doesn't already exits and all...
    WidgetsByPath.Add(Path, wdg);
    PathsByWidget.Add(wdg, Path);
  }

  public void Delete(string Path)
  {
    Widget w = WidgetsByPath[Path];
    PathsByWidget.Delete(w);
    WidgetsByPath.Delete(Path);
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-11T16:07:41.250

“成千上万的物体”？你确定这个结构完全属于内存吗？对我来说，这听起来像是某种类型的持久存储的工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-11T17:19:18.613

“复制”字符串不会使用两倍的内存：由于字符串是 c# 中的不可变对象，您只需在字典中的每个条目存储另一个引用（即指针，4 或 8 个字节）：

```
Dictionary<string, Widget> dict = new Dictionary<string, Widget>();
Widget myWidget = GetSomeWidget();
dict.Add(myWidget.Name, myWidget); 
```

您将始终重用小部件属性中的字符串对象，因此只需继续使用 dict 并将路径作为属性存储在小部件内。

如果您不需要按排序顺序枚举小部件，请不要使用 SortedList，它会比 Dictionary 慢（O(n log n) 插入/删除/检索 vs. O(n) 平均时间）

更改小部件的路径将需要您将其从字典中删除并使用更改后的路径添加它，但这是一个平均恒定时间操作，因此它应该非常快。

顺便提一下：即使您必须花费 1 MB 的额外内存来获得更高的性能或使用更适合（且经过良好测试）的数据结构，我认为考虑到这些天其他应用程序正在使用的内存量（浪费？）......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T16:15:58.763

如果您最终使用自定义数据结构，我建议使用包含而不是派生。最好将必要的接口定义为新类的一部分，并将存储细节保留在内部。如果您改为从 List 派生，则强制正确使用该类会更加困难，而且如果您后来改变主意，则更难改变。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-11T16:37:15.623

我认为您只需要一个 Dictionary<Widget> 和一个适当的 Widget 类，其中包含对其他 Widget 的引用。使它成为一个自定义字典可能会有所帮助，这样您就可以简单地添加一个小部件并让它从小部件的 FilePath 属性派生密钥。

```
 public class WidgetDictionary : Dictionary<string,Widget>
 {
     ... provide suitable constructors ...

     public void Add( Widget widget )
     {
         if (widget != null && !this.ContainsKey( widget.FilePath ))
         {
             this.Add( widget.FilePath, widget );
         }
     }
 }

 public class Widget
 {
      public string FilePath { get; set; }

      private List<Widget> widgets = new List<Widget>();
      public IEnumerable<Widget> Widgets
      {
          get { return widgets; }
      }

      ...code to add/remove widgets from list...
 } 
```

然后要做 (1)，您只需按文件路径在小部件存储库中查找小部件。

```
 var repository = new WidgetDictionary();
 string filePath = ...
 var widget = repository[filePath]; 
```

要执行 (2)，您可以在更改其文件路径后删除小部件并将其重新添加到存储库。对其他小部件持有的小部件的引用仍然有效。

```
var widget = repository[filePath];
repository.Remove(filePath);
widget.FilePath = newFilePath;
repository.Add(widget);

 EDIT: this could probably be implemented as a method on the
 dictionary as well.

   public void UpdatePath( Widget widget, string newPath )
   {
       if (string.IsNullOrEmpty(newPath))
          throw new ArgumentNullException( "newPath" );

       var widget = this.ContainsKey(widget.FilePath)
                             ? this[widget.FilePath]
                             : null;

       if (widget != null)
       {           
           this.Remove(widget.FilePath);
       }
       widget.FilePath = newPath;
       this.Add( widget );
    } 
```

要做（3）只需引用该属性。

```
var filePath = widget.FilePath; 
```

如果您希望其他小部件在删除（处置）时自动删除它们对小部件的引用，您可能希望 Widget 类实现 IDisposable 并能够将事件处理程序添加到 dispose 事件，以便感兴趣的小部件可以注册一个方法，该方法将从他们的相关小部件集合中删除正在处理的小部件。请参阅[此 MSDN 部分](http://msdn.microsoft.com/en-us/library/edzehd2t.aspx)，了解如何设置和使用事件处理程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-07T02:24:45.273

您是否考虑过使用该[`Path`](http://msdn.microsoft.com/en-us/library/system.io.path_members%28v=VS.90%29.aspx)课程？在内部*，*路径是一个字符串，并且有一些很好的方法可以获取各种路径部分，例如`GetFullPath`,`GetFileName`等等。

# mysql - 重新排序/重置自动增量主键

> ID：740358
> 
> 赞同：144
> 
> 时间：2009-04-11T16:11:39.117
> 
> 标签：mysql, database

我有一个带有自动增量主键的 MySQL 表。我删除了表格中间的一些行。例如，现在我在 ID 列中有这样的内容：12、13、14、19、20。我删除了 15、16、17 和 18 行。

我想重新分配/重置/重新排序主键，以便我有连续性，即使 19 a 15、20 a 16 等等。

我该怎么做？

* * *

## 回答 #1

> 赞同：390
> 
> 时间：2011-03-25T20:21:41.937

即使这个问题似乎很老，也会为在这里搜索的人发布答案。

```
SET @count = 0;
UPDATE `users` SET `users`.`id` = @count:= @count + 1; 
```

如果该列在其他表中用作外键，请确保使用这些表中的外键关系`ON UPDATE CASCADE`而不是默认值。`ON UPDATE NO ACTION`

此外，为了重置`AUTO_INCREMENT`计数，您可以立即发出以下语句。

```
ALTER TABLE `users` AUTO_INCREMENT = 1; 
```

对于 MySQL，它会将值重置为`MAX(id) + 1`.

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2009-04-11T16:20:58.470

您可以删除主键列并重新创建它。然后应按顺序重新分配所有 ID。

然而，在大多数情况下，这可能是一个坏主意。如果您有其他表具有该表的外键，那么它肯定不起作用。

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2010-06-25T23:19:19.387

要重置我的用户表的 ID，我使用以下 SQL 查询。上面已经说过，这将破坏您与任何其他表可能存在的任何关系。

```
ALTER TABLE `users` DROP `id`;
ALTER TABLE `users` AUTO_INCREMENT = 1;
ALTER TABLE `users` ADD `id` int UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY FIRST; 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-10-12T05:31:35.807

您可以简单地使用此查询

```
alter table abc auto_increment = 1; 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2013-09-12T10:13:21.110

```
SET  @num := 0;

UPDATE your_table SET id = @num := (@num+1);

ALTER TABLE your_table AUTO_INCREMENT =1; 
```

我认为这会做到

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-05-04T14:03:37.913

或者，从 PhpMyAdmin 中删除“AutoIncrement”标志，保存，再次设置并保存。这将重置它。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-07-12T09:24:22.470

```
SELECT * from `user` ORDER BY `user_id`; 

SET @count = 0;

UPDATE `user`  SET `user_id` = @count:= @count + 1;

ALTER TABLE `user_id` AUTO_INCREMENT = 1; 
```

如果你想`order by`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-27T14:00:13.497

**在 phpmyadmin 中**

> 注意：如果您删除最后一行而不是中间行，这将起作用。

转到您的表-> 单击操作菜单-> 转到表选项-> 将 AUTO_INCREMENT 更改为您想要开始的位置。

你的表自动增量从那个没有开始。

尝试一下。 [![在此处输入图像描述](https://i.stack.imgur.com/sHv8f.jpg)](https://i.stack.imgur.com/sHv8f.jpg)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-08-13T07:43:36.920

这有效 - [https://stackoverflow.com/a/5437720/10219008](https://stackoverflow.com/a/5437720/10219008.....but) .....但是如果您遇到问题'错误代码：1265。第1行的列'id'的数据被截断'......然后运行以下。在更新查询上添加忽略。

```
SET @count = 0;
set sql_mode = 'STRICT_ALL_TABLES';
UPDATE IGNORE web_keyword SET id = @count := (@count+1); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-03-29T13:37:00.403

您可以删除该列的主键自动递增功能，然后每次更新该列时预先运行一个查询，该查询将计算表中的所有行，然后运行一个循环遍历该行计数，将每个值插入相应的行，最后运行一个查询，插入一个新行，该列的值是总行数加一。这将完美无缺，对于试图完成你的工作的人来说，这是最绝对的解决方案。这是您可以用于该功能的代码示例：

```
$table_row_count = mysql_result(mysql_query("SELECT COUNT(`field_1`) FROM `table`"), 0);
$viewsrowsdata = mysql_query("
    SELECT `rank`, `field1`, `field2`, `field3`, `field4`
        FROM (SELECT (@rank:=@rank+1) as `rank`, `field1`, `field2`, `field3`, `field4`
            FROM (SELECT * FROM `views`) a
            CROSS JOIN (SELECT @rank:=0) b
            ORDER BY rank ASC) c
");
while ($row = mysql_fetch_assoc($viewsrowsdata)) {
    $data[] = $row;
}
foreach ($data as $row) {
    $new_field_1 = (int)$row['rank'];
    $old_field_1 = (int)$row['field1'];
    mysql_query("UPDATE `table` SET `field_1` = $new_field_1 WHERE `field_1` = $old_field_1");
}
mysql_query("INSERT INTO `table` (`field1`, `field2`, `field3`, `field4`) VALUES ('$table_row_count' + 1, '$field_2_value', 'field_3_value', 'field_4_value')"); 
```

在这里，我创建了一个关联数组，我在选择查询中将查询附加到排名列上，它为每一行提供了一个从 1 开始的排名值。然后我遍历了关联数组。

另一种选择是获取行数，运行基本的选择查询，获取关联数组并以相同的方式对其进行迭代，但添加了一个在每次迭代中更新的变量。这不太灵活，但会完成同样的事情。

```
$table_row_count = mysql_result(mysql_query("SELECT COUNT(`field_1`) FROM `table`"), 0);
$viewsrowsdata = mysql_query("SELECT * FROM `table`");
$updated_key = 0;
while ($row = mysql_fetch_assoc($viewsrowsdata)) {
    $data[] = $row;
}
foreach ($data as $row) {
    $updated_key = $updated_key + 1;
    mysql_query("UPDATE `table` SET `field_1` = '$updated_key' WHERE `field_1` = '$row['field_1']'");
}
mysql_query("INSERT INTO `table` (`field1`, `field2`, `field3`, `field4`) VALUES ('$table_row_count' + 1, '$field_2_value', 'field_3_value', 'field_4_value')"); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-08-25T19:22:37.603

对于 InnoDB，执行此操作（这将从表中删除所有记录，首先创建一个 bakcup）：

```
SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS ;
SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION ;
SET NAMES utf8 ;
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 ;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 ;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' ;
SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 ;
/* ================================================= */

drop table tablename;
CREATE TABLE `tablename` (
   table structure here!

) ENGINE=InnoDB AUTO_INCREMENT=  ai number to reset  DEFAULT CHARSET= char set here;

/* ================================================= */
SET SQL_MODE=@OLD_SQL_MODE ;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS ;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS ;
SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT ;
SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS ;
SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION ;
SET SQL_NOTES=@OLD_SQL_NOTES ; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-06-04T06:24:56.040

我有同样的疑问，但无法对表格进行任何更改，我决定执行以下操作，因为我的 ID 没有超过变量 @count 中设置的最大数量：

```
SET @count = 40000000;
UPDATE `users` SET `users`.`id` = @count:= @count + 1;

SET @count = 0;
UPDATE `users` SET `users`.`id` = @count:= @count + 1;

ALTER TABLE `users` AUTO_INCREMENT = 1; 
```

该解决方案需要，但它是安全的并且是必要的，因为我的表拥有外键，并且数据在另一个表中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-01-09T18:36:53.223

最好的选择是更改列并删除 auto_increment 属性。然后发出另一个alter 语句并将auto_increment 放回该列。这会将计数重置为当前行的 max+1，从而保留从数据库中的其他表或该列的任何其他键使用返回到该表的外键引用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-03-29T08:47:09.277

我的意见是创建一个名为 row_order 的新列。然后重新排序该列。我不接受对主键的更改。例如，如果订单列是banner_position，我做了这样的事情，这是为了删除，更新，创建横幅位置列。调用此函数分别重新排序它们。

```
public function updatePositions(){
    $offers = Offer::select('banner_position')->orderBy('banner_position')->get();
    $offersCount = Offer::max('banner_position');
    $range = range(1, $offersCount);

    $existingBannerPositions = [];
    foreach($offers as $offer){
        $existingBannerPositions[] = $offer->banner_position;
    }
    sort($existingBannerPositions);
    foreach($existingBannerPositions as $key => $position){
        $numbersLessThanPosition = range(1,$position);
        $freshNumbersLessThanPosition = array_diff($numbersLessThanPosition, $existingBannerPositions);
        if(count($freshNumbersLessThanPosition)>0) {
            $existingBannerPositions[$key] = current($freshNumbersLessThanPosition);
            Offer::where('banner_position',$position)->update(array('banner_position'=> current($freshNumbersLessThanPosition)));
        }
    }
} 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2015-11-30T02:35:49.503

您也可以简单地避免使用数字 ID 作为主键。如果表格包含国家信息，您可以使用国家/地区代码作为主要 id，或者您可以使用永久链接，例如，如果它包含文章。

您也可以简单地使用随机值或 MD5 值。所有这些选项都有其自身的好处，特别是在 IT 方面。数字 ID 很容易枚举。

# asp.net - 为 ASP.net 子控件生成的 HTML 'name' 属性，而不是唯一的 'ID' 属性

> ID：740367
> 
> 赞同：1
> 
> 时间：2009-04-11T16:18:21.003
> 
> 标签：asp.net, custom-controls, custom-server-controls

为我的自定义 ASP.net 服务器控件生成的 HTML 代码为子控件生成 name 属性，而不是 id 属性。像这样的东西：

```
<span id="GridView2_ctl02_editdis">
    <input type="text" name="GridView2$ctl02$editdis$ctl00"/>
</span> 
```

自定义控件本身的 ID 显然是正确的。

对我来说更奇怪的是，*有时*确实会生成 ID （我不知道在什么条件下）。但是`FindControl()`具有该 ID 的 a 在服务器端返回 null。`FindControl()`使用 name 属性的值就可以了。

像这样的东西：

```
<span class="TextBox" id="GridView2_ctl02_editdis">
    <input type="text" id="GridView2_ctl02_editdis_ctl00" name="GridView2$ctl02$editdis$ctl00"/>
</span> 
```

对于上述情况，`FindControl("GridView2$ctl02$editdis$ctl00")`工作正常，`FindControl("GridView2_ctl02_editdis_ctl00")`没有。

如何确保一致且可预测的 ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T16:57:19.147

它们是一致的。

在内部，作为命名控件（即 GridView）的子控件，它们的完整 ID 是通过使用“$”附加其父控件的 ID 来构建的。如果是网格，则为 gridID$rowID$cellID$mycontrolID。这对于区分同一子控件（即 mycontrolID）的多个实例是必要的。为什么是“$”而不是“_”？我猜是因为很多人已经倾向于将他们的控件命名为“my_control_something”，而“$”符号和任何符号一样好。

因此，GridView2$ctl02$editdis$ctl00 是正确的 ID，这就是为什么它被用作 INPUT 等控件的名称。当回发发生时，框架需要能够将表​​单键与适当的控件相匹配。

我认为，与 ID 混淆的原因在于，您在 .aspx 中使用的 ID 和您在 HTML 中看到的 ID 是两个不同的东西。客户端 ID 就是这样。无论出于何种原因，当一个控件被呈现时（使用 ClientID 属性），所有的“$”都会被替换为“_”。我的猜测是这样做是为了使其对 javascript/css 友好。

现在，关于 FindControl("GridView2$ctl02$editdis$ctl00")... 你真的应该尽可能避免使用它。FindControl 是一个递归函数，它将“GridView2$ctl02$editdis$ctl00”分解为“GridView2”和“ctl02$editdis$ctl00”，找到 GridView2 并询问它是否有“ctl02$editdis$ctl00”作为子控件。对以 $ 分隔的每个部分重复该过程。

附带说明一下，每当您发现自己调用 Page.FindControl 以获得一些深埋的控制时，您需要检查模式并询问原因。例如，无论需要使用“GridView2$ctl02$editdis$ctl00”做什么，很可能也需要使用“GridView2$ctl02$editdis$ctl01”来完成。在这种情况下，它可能需要在 OnItemCreated 或 OnItemDataBound 上进行处理，您可以在其中访问“知道”有关“ctl00”的行。

# iphone - iPhone AdMob 广告

> ID：740370
> 
> 赞同：2
> 
> 时间：2009-04-11T16:19:00.863
> 
> 标签：iphone, admob

我有以下两个问题，我尝试用谷歌搜索这些问题，但没有找到任何运气。请帮我。

1.  我已将 AdMob 广告集成到我的 iphone 应用程序中。当点击 admob 视图时，safari 被打开，如果在加载广告时出现任何错误，它会显示一条错误消息，说“safari 无法打开页面，因为发生了太多重定向”在错误弹出窗口中有一个确定按钮，当单击确定按钮时，仅关闭错误弹出窗口并且控制不会返回到应用程序。我们如何让它回到应用程序中？

2.  如何为 adMob 广告添加自动关闭功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T12:13:57.497

(1) 一旦控制权转移到 safari，iPhone OS 就会开始关闭你的应用程序。控制权不会转移回您的应用程序 - 用户将需要关闭 safari 并重新启动您的应用程序。

在不关闭应用程序的情况下在 iPhone 应用程序中显示 Web 内容的唯一方法是将 Web 浏览器嵌入到应用程序中。但是，我希望您的广告网络坚持他们的广告在 safari 中打开，以确保内容不被篡改。

(2) 同样，一旦 safari 开始加载，就无法返回您的应用程序。我建议您专注于解决广告代码实施中的任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-18T16:16:20.310

我认为这将回答两个问题：

借助 AdMob，您可以控制将 ADS 传输到 Safari 的方式。因此，如果您**不**希望这种情况发生，您可以将以下方法添加到实现**AdMobDelegate**协议的类中：

```
- (BOOL)useEmbeddedWebView
{
    return YES;
} 
```

这样，AD 将显示在内部浏览器上，而不是启动 Safari 来执行此操作。

# php - 如何设计 MySQL 数据库

> ID：740374
> 
> 赞同：0
> 
> 时间：2009-04-11T16:22:34.707
> 
> 标签：php, mysql, database, database-design

我有一个名为“movie2person”的表，包含 3 列：movieID、personID 和角色。我使用这张表来连接“电影”表和“人”表之间......多对多关系......

我选择了movieID和personID都作为主键...问题是有时我需要为同一个movieID多次输入相同的personID，但我不能这样做，因为只允许使用相同movieID和personID的一种组合...

我该怎么做？？

谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T16:24:56.247

要么在主键中包含角色，要么向表中添加一个新的人工键并将这个新列用作主键，您不会在此表之外使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T16:47:28.347

根据您所做的一些评论，我认为您需要更多的规范化。创建一个角色表并相应地调整您的查找表

```
movie
+----+------------+
| id | title      |
+----+------------+
|  1 | Braveheart |
+----+------------+

person
+----+------------+
| id | name       |
+----+------------+
|  4 | Mel Gibson |
+----+------------+

role
+----+------------+
| id | title      |
+----+------------+
|  1 | Director   |
|  2 | Actor      |
+----+------------+

movie2person
+---------+----------+--------+
| movieID | personID | roleID |
+---------+----------+--------+
|       1 |        4 |      1 |
|       1 |        4 |      2 |
+---------+----------+--------+ 
```

使用此设置，您将在 movie2person 上拥有一个三列复合主键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T16:24:57.510

主键的意思是“这是该行的唯一标识符”。

如果您要插入许多具有相同值的行，那么这不是您的主键。

如果您打算为行插入精确的重复项，那么您根本没有主键，您应该永远放弃它。

但是，如果您计划为每个 (movieID, personID) 对插入不同的角色，那么您只需将角色添加到主键即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T16:25:40.097

男性所有三列作为主键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T16:46:43.073

我建议对您的设计进行一些更改：

1.  将表的名称从 Movie2Person 更改为 MoviePerson_xref。以这种格式命名并从表命名约定中排除数字通常是标准的。

2.  该表应该有自己的主键，称为movieperson_xrefID。

3.  然后，您可以保存电影 ID 和人员 ID 的所有组合。

# java - 使用 java.util.zip.ZipOutputStream 时 zip 文件中的目录

> ID：740375
> 
> 赞同：39
> 
> 时间：2009-04-11T16:24:25.937
> 
> 标签：java, directory, zip

假设我有一个文件 t.txt、一个目录 t 和另一个文件 t/t2.txt。如果我使用 linux zip 实用程序“zip -r t.zip t.txt t”，我会得到一个 zip 文件，其中包含以下条目（unzip -l t.zip）：

```
Archive:  t.zip
  Length     Date   Time    Name
 --------        ----      ----      ----
        9  04-11-09 09:11   t.txt
        0  04-11-09 09:12   t/
      15  04-11-09 09:12   t/t2.txt
 --------                           -------
       24                          3 files 
```

如果我尝试使用 java.util.zip.ZipOutputStream 复制该行为并为目录创建一个 zip 条目，java 会引发异常。它只能处理文件。我可以在 zip 文件中创建 at/t2.txt 条目并将使用 t2.txt 文件内容添加到其中，但我无法创建目录。这是为什么？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-04-11T16:29:59.120

`ZipOutputStream` *可以*`/`通过在文件夹名称后添加正斜杠来处理空目录。尝试（[来自](http://www.jguru.com/faq/viewquestion.jsp?EID=528882)）

```
public class Test {
    public static void main(String[] args) {
        try {
            FileOutputStream f = new FileOutputStream("test.zip");
            ZipOutputStream zip = new ZipOutputStream(new BufferedOutputStream(f));
            zip.putNextEntry(new ZipEntry("xml/"));
            zip.putNextEntry(new ZipEntry("xml/xml"));
            zip.close();
        } catch(Exception e) {
            System.out.println(e.getMessage());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-05-25T07:28:57.920

只需浏览 java.util.zip.ZipEntry 的源代码即可。如果 ZipEntry 的名称以“/”字符结尾，它会将其视为目录。只需在目录名称后加上“/”即可。

检查此示例以仅压缩空目录 [http://bethecoder.com/applications/tutorials/showTutorials.action?tutorialId=Java_ZipUtilities_ZipEmptyDirectory](http://bethecoder.com/applications/tutorials/showTutorials.action?tutorialId=Java_ZipUtilities_ZipEmptyDirectory)

祝你好运。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-06-24T19:33:16.430

Java程序到Zip（文件夹包含空的或完整的）

```
public class ZipUsingJavaUtil {
    /*
     * Zip function zip all files and folders
     */
    @Override
    @SuppressWarnings("finally")
    public boolean zipFiles(String srcFolder, String destZipFile) {
        boolean result = false;
        try {
            System.out.println("Program Start zipping the given files");
            /*
             * send to the zip procedure
             */
            zipFolder(srcFolder, destZipFile);
            result = true;
            System.out.println("Given files are successfully zipped");
        } catch (Exception e) {
            System.out.println("Some Errors happned during the zip process");
        } finally {
            return result;
        }
    }

    /*
     * zip the folders
     */
    private void zipFolder(String srcFolder, String destZipFile) throws Exception {
        ZipOutputStream zip = null;
        FileOutputStream fileWriter = null;
        /*
         * create the output stream to zip file result
         */
        fileWriter = new FileOutputStream(destZipFile);
        zip = new ZipOutputStream(fileWriter);
        /*
         * add the folder to the zip
         */
        addFolderToZip("", srcFolder, zip);
        /*
         * close the zip objects
         */
        zip.flush();
        zip.close();
    }

    /*
     * recursively add files to the zip files
     */
    private void addFileToZip(String path, String srcFile, ZipOutputStream zip, boolean flag) throws Exception {
        /*
         * create the file object for inputs
         */
        File folder = new File(srcFile);

        /*
         * if the folder is empty add empty folder to the Zip file
         */
        if (flag == true) {
            zip.putNextEntry(new ZipEntry(path + "/" + folder.getName() + "/"));
        } else { /*
                 * if the current name is directory, recursively traverse it
                 * to get the files
                 */
            if (folder.isDirectory()) {
                /*
                 * if folder is not empty
                 */
                addFolderToZip(path, srcFile, zip);
            } else {
                /*
                 * write the file to the output
                 */
                byte[] buf = new byte[1024];
                int len;
                FileInputStream in = new FileInputStream(srcFile);
                zip.putNextEntry(new ZipEntry(path + "/" + folder.getName()));
                while ((len = in.read(buf)) > 0) {
                    /*
                     * Write the Result
                     */
                    zip.write(buf, 0, len);
                }
            }
        }
    }

    /*
     * add folder to the zip file
     */
    private void addFolderToZip(String path, String srcFolder, ZipOutputStream zip) throws Exception {
        File folder = new File(srcFolder);

        /*
         * check the empty folder
         */
        if (folder.list().length == 0) {
            System.out.println(folder.getName());
            addFileToZip(path, srcFolder, zip, true);
        } else {
            /*
             * list the files in the folder
             */
            for (String fileName : folder.list()) {
                if (path.equals("")) {
                    addFileToZip(folder.getName(), srcFolder + "/" + fileName, zip, false);
                } else {
                    addFileToZip(path + "/" + folder.getName(), srcFolder + "/" + fileName, zip, false);
                }
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-11-17T12:09:52.760

就像其他人在这里说的添加空目录一样，在目录名称中添加“/”。注意不要添加 File.separator（等于“\”），它实际上是在 zip 中添加一个空文件。

我花了一段时间才明白我的错误是什么——希望我能节省一些时间......

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-06-12T08:14:33.090

您可以在文件夹名称的末尾添加“/”。只需使用以下命令：

```
zip.putNextEntry(new ZipEntry("xml/")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-03T07:24:13.933

字符串 dir = "E:\Infor\Marketing\JobLog\Cloud_MomBuild_NoMirror";

```
public void downloadAsZip() throws IOException {
    ByteArrayOutputStream byteOutputStream = new ByteArrayOutputStream();
    ZipOutputStream zipOutputStream = new ZipOutputStream(byteOutputStream);
    Path folderPath = Paths.get(dir);
    String folderName = "Output";
    for (File file : folderPath.toFile().listFiles()) {
        String path = folderName + "/" + file.getName();
        if (file.isDirectory()) {
            writeFolderToZip(zipOutputStream, file, path);
        } else {
            writeFileToZip(zipOutputStream, file, path);
        }
    }
}

public void writeFileToZip(ZipOutputStream zipOutputStream, File file, String path) throws IOException {
    zipOutputStream.putNextEntry(new ZipEntry(path));
    FileInputStream fileInputStream = new FileInputStream(file);
    IOUtils.copy(fileInputStream, zipOutputStream);
    fileInputStream.close();
    zipOutputStream.closeEntry();
}

public void writeFolderToZip(ZipOutputStream zipOutputStream, File dir, String path) throws IOException {
    for (File file : dir.listFiles()) {
        String dirPath = path + "/" + file.getName();
        if (file.isDirectory()) {
            writeFolderToZip(zipOutputStream, file, dirPath);
        } else {
            writeFileToZip(zipOutputStream, file, dirPath);
        }
    }
} 
```

# language-agnostic - 强化学习的良好实现？

> ID：740389
> 
> 赞同：25
> 
> 时间：2009-04-11T16:32:19.397
> 
> 标签：language-agnostic, artificial-intelligence, machine-learning, reinforcement-learning

对于一个 ai 类项目，我需要实现一个强化学习算法，它可以击败一个简单的俄罗斯方块游戏。游戏是用 Java 编写的，我们有源代码。我知道强化学习理论的基础知识，但想知道 SO 社区中是否有人亲身体验过这类事情。

1.  对于在俄罗斯方块游戏中实施强化学习，您推荐的阅读材料是什么？
2.  有没有什么好的开源项目可以完成类似的事情，值得一试？

编辑：越具体越好，但欢迎使用有关该主题的一般资源。

**跟进：**

认为如果我发布后续内容会很好。

这是我为任何未来的学生提供的解决方案（代码和文章）:)。

**[论文](http://dl.getdropbox.com/u/30163/AI.PAPER.DESIMONE.GOCHEV.doc)**/**[代码](http://dl.getdropbox.com/u/30163/tetris_done.tar.gz)**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-13T02:32:22.893

看看 2009 年[RL 竞赛](http://web.archive.org/web/20090501010345/http://2009.rl-competition.org/domains.php)。问题域之一是[俄罗斯方块游戏](https://code.google.com/p/rl-library/wiki/TetrisJava)。前一年也有俄罗斯方块问题。这是当年第五名决赛入围者的[52 页最终报告](https://dl.dropboxusercontent.com/s/j9d1t0jffck0tdm/SmartAgent%20-%20Creating%20Reinforcement%20Learning%20Tetris%20AI.pdf)，其中详细介绍了代理人的工作方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T17:05:00.067

[Heaton Research](http://www.heatonresearch.com/book/programming-neural-networks-java-2.html)电子书非常擅长解释神经网络概念（带有代码）。第 4 章专门介绍机器学习和网络的各种训练方法。有一个可下载的库和示例应用程序供您查看。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T17:08:52.117

这是一本关于这个主题的好书：

[机器学习和数据挖掘：](https://rads.stackoverflow.com/amzn/click/com/1904275214)
Igor Kononenko、Matjaz Kukar 的原理和算法简介（2007 年 6 月）

还可以看看这些开源项目：

*   [Maja 机器学习框架](http://sourceforge.net/projects/mmlf/)
*   [PIQLE](http://piqle.wiki.sourceforge.net/PIQLE)
*   [埃尔西](http://sourceforge.net/projects/elsy/)
*   [机器人入门手册](http://roboticsprimer.sourceforge.net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-25T06:21:51.893

[TD-Gammon](http://researchweb.watson.ibm.com/massive/tdl.html)、gnubackgammon 或任何其他类似项目在游戏中取得了巨大成功。

Sutton & Barto 的书《强化学习：简介》也有一些其他的[案例研究](http://www.cs.ualberta.ca/%7Esutton/book/ebook/node107.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-04-22T16:32:22.227

这个问题确实很老，但对于 2018 年阅读此问题的任何人，如果您对现有 RL 算法的可靠参考感兴趣，我强烈建议您使用 OpenAI Baselines。这些算法是由 OpenAI 的一群真正了解这些东西的员工实现的，并且已经过广泛的微调和调试。

公平地说，俄罗斯方块不需要这些，但现在我怀疑家庭作业问题可能涉及一些更复杂的环境。

[https://github.com/openai/baselines](https://github.com/openai/baselines)

更新：

2019年，我也推荐rlpyt：

[https://github.com/astooke/rlpyt](https://github.com/astooke/rlpyt)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-12T23:29:33.683

[这并不特定于强化学习，但斯坦福大学在 Youtube](http://www.youtube.com/watch?v=UzxYlbK2c7E)和 iTunes上有一系列关于机器学习的精彩讲座。

该链接指向第一个讲座，大约需要 30 分钟才能深入了解内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-02T13:19:11.523

[Burlap](http://burlap.cs.brown.edu/)是一个最新的 Java 库，它提供了许多常见强化学习算法以及一些环境和有用工具的实现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-12-11T15:34:14.100

我建议学习基于 Java 的 RL4J。我正在使用它，我很惊讶事情的顺利进行，你甚至可以在带有 Actor Critic 算法（称为 A3C）的强化学习算法中学习 LSTM 网络

这是链接： [https ://github.com/deeplearning4j/dl4j-examples/blob/master/rl4j-examples/](https://github.com/deeplearning4j/dl4j-examples/blob/master/rl4j-examples/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-02-06T16:14:38.410

我注意到这个问题已经过时了（已有 10 年历史了），并且现代 RL 框架和环境的集合在这里可能很有用。我为此创建了 GitHub 存储库，并打算定期更新它。

[https://github.com/TheMTank/RL-code-resources](https://github.com/TheMTank/RL-code-resources)

# xml - 与 DTD 和模式相关的问题：查找缺失的单词

> ID：740390
> 
> 赞同：0
> 
> 时间：2009-04-11T16:32:33.047
> 
> 标签：xml, schema, dtd

这个问题是测验的一部分。我已经完成了，但有些问题回答不正确。但是，老师不会上传这些问题的解决方案。你能帮我解决这些问题吗？我需要准确地知道答案才能开始复习期末考试

这个问题与 DTD 和模式有关：

1）识别缺失的单词。_____ 用作指向在名称和特殊类型内容之间建立关联的符号的指针。

选择的答案（不正确）：威刚

2) _____ 声明的语法示例是 <ATTLIST MEMO (CON|PUB) "PUB" >

选择的答案（不正确）：属性类型

3）识别缺失的单词。(1)_____ 实体也称为 (2)____ 实体。

选择的答案（不正确）：（1）已解析，（2）文本

4) 以下哪一项是 XML Schema 优于 DTD 的优点？

选择的答案（不正确）：使用 XML Schema 表达约束通常更简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T16:48:18.763

这是多项选择吗？其他选择是什么？

对于 1 和 2，我可以猜到：

1) NDATA (NDataDecl)

2) 属性列表

（什么样的考试需要你知道像记谱法这样可怕的老东西，嗯？呸！）

# drupal - 将漂亮的菜单移到标题下方

> ID：740394
> 
> 赞同：2
> 
> 时间：2009-04-11T16:35:34.317
> 
> 标签：drupal

我无法将漂亮的菜单（位于左上角）放到标题栏下方。（即，就在 Drupal 中的“**组织信息并让世界可以访问”这个词的上方）。**

[http://lh5.ggpht.com/_SDci0Pf3tzU/SeDF5T6fBAI/AAAAAAAArI/vEoQQPmC164/s400/site%20menu.jpg](http://picasaweb.google.com/lh/photo/BaViwySTq2lAuj-wAynBeA?feat=embedwebsite)

我试图将 Nice Menu 移动到`content`块中`admin/build/block`，但它随后将位于底部、`content`块下方和由 drupal 标志供电的上方。如果我把它移到`Header`上面的图像就是我观察到的。两者之间没有。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T16:49:41.240

我相信，您受到所使用的特定主题的限制。默认情况下，主题模板将任何添加的块放置在标头内的徽标上方和任何内容下方。

我的建议是选择不同的模板（可能是 Zen）或学习如何操作主题的模板以获得您想要的结果。

这本书非常适合学习如何主题化： [http ://www.amazon.com/Drupal-Themes-Create-powerful-styling/dp/1847195660/ref=pd_sim_b_2](https://rads.stackoverflow.com/amzn/click/com/1847195660)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T12:56:34.747

为了实现您的目标，您需要编辑主题模板文件themes/garland/page.tpl.php 并`<?php print $header; ?>`在之前移动`<?php print $breadcrumb; ?>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T07:46:58.697

正如 wrburgess 所说，这是一个主题问题：您正在使用的 Garland 没有提供将块内容放置在主要内容区域上方的机制。

Zen Classic（与 Zen 捆绑）等其他主题也可以。对于包括它的主题，这个区域通常被称为“内容顶部”。

# class - 版本相关时建模版本控制

> ID：740397
> 
> 赞同：1
> 
> 时间：2009-04-11T16:36:33.410
> 
> 标签：class, web-applications, versioning, modeling, class-diagram

我正在建模一个类图，我完全被这个问题所困扰：

我的新 Web 应用程序有“卡片”（关于主题的条目），用户可以修改，à là wiki。但与 wiki 不同的是，不同的卡片拥有不同的数据。与 wiki 不同的是，卡片与数据库中的其他卡片明确相关。让我向您展示我最初是如何使用一个虚拟示例设计它的：

```
/** Similar to strategy/bridge pattern */
class Card<T extends CardInfoVersion> is composed of T // container of versions
class CardInfoVersion // one version
class Painting extends CardInfoVersion 
class Museum extends CardInfoVersion is composed of Paintings 
```

优雅，干净，但**错误**。使用这种方法，**博物馆与绘画版本相关联，而不是与绘画本身相关联**。我想到的第一个解决方案是这个：

```
class Card<T extends CardInfoVersion> is composed of T
class CardInfoVersion
class Painting extends CardInfoVersion
class Museum extends CardInfoVersion is composed of Card<Painting> 
```

这种方法闻起来很臭。CardInfoVersion 下的类层次结构很大，因此 UML 模型将不可读，并且 Card 类将充满对 CardInfoVersion 子类的 ORM 引用。然后我想出了这个：

```
class Card is composed of proposedModifications: Set<Card>
class Painting extends Card
class Museum extends Card is composed of Paintings 
```

这也有气味。实际上，自从版本消失以来，这一切都搞砸了。它还要求管理员验证对卡片的提议修改。

我真的不知道如何解决这个问题。**请记住：如果 CardInfoVersion 子类不相互关联，原始设计就可以了。**

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T19:36:17.753

@Michael 有一个很好的观点。 *博物馆*是一个领域对象，*绘画*也是。听起来您正在使用“卡片”来收集各种人对绘画的评论。这表明*CardFile*是您要建模的内容。CardFile将是*Cards的**集合*。卡片具有对相关博物馆或绘画的引用。

这里有一些提示：

*   写出一些用户故事或用例。你过早陷入程序员思维；先想想你想做什么。如果你没有最喜欢的方式，那么使用这个模型：“某人”“做某事”“得到一些结果”。因此，例如，“我得到所有关于 Magritte 'Ceçin'es pas une pipe' 的卡片，以便找出哪个博物馆拥有它。”

*   为这些类编写一些“用户代码”。伪代码很好，但它确实有助于提出界面。

所以你可能会写：

```
cards := cardfile.getAllCards(ceciNesPas)
for each card in cards
do
    print card.getPainting().getMuseum()
od 
```

我根本不是发誓这是最好的方法，而是一个插图。

*   如果这里的“版本控制”是有许多卡片与同一张画相关联，那么现在你已经设置好了。如果卡片上的格式、方法、数据项随着时间而变化，那么您需要确定卡片的具体内容，并将其设为超类。然后，您可以使更高版本的 Cards 成为 Card 的新子类：保持不变的东西在超类中，不同的部分是子类的业务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T17:09:09.620

我会采取领域驱动的方法。您的用户会称它们为“卡片”吗？这似乎是一个技术问题，但您将技术问题（卡片）与领域问题（博物馆、绘画）混为一谈。

在不了解您的域和用户的情况下，很难猜测您的最终解决方案是什么。

也许是这样：

```
class Museum extends Content is composed of Paintings
class Painting extends Content

class Card is composed of Set<Content> 
```

这样，您就可以将域模型（博物馆、绘画）与视图模型（卡片）分开。我什至会更进一步，不使用继承（使用plain-old-java-object）路由，但我不知道你的确切实现。

如果您想了解有关这种设计风格的更多信息，[这个播客](http://www.altnetpodcast.com/episodes/15-domain-driven-design)很有帮助。

# linq - 修改 LINQ 查询的排序顺序

> ID：740398
> 
> 赞同：4
> 
> 时间：2009-04-11T16:36:35.297
> 
> 标签：linq

我希望以下 LINQ 查询根据 FirstName 进行排序，但 OrderBy 扩展方法似乎没有效果。

```
DataClassesDataContext dc = new DataClassesDataContext();

var query = from contact in dc.Contacts
            select contact;

query.OrderBy(c => c.FirstName); 
```

当我在初始查询定义中包含 orderby 时，一切正常，但我希望能够根据代码稍后的条件对其进行修改。

知道为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-11T16:41:55.347

尝试使用

```
query = query.OrderBy(c => c.FirstName); 
```

或者

```
var sortedQuery = query.OrderBy(c => c.FirstName); 
```

OrderBy 创建一个新序列。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-11T16:43:34.813

问题是 OrderBy 没有修改现有的查询。相反，它正在创建一个新查询，该查询对查询中的值进行排序。您需要捕获此结果

```
var sortedQuery = query.OrderBy(c => c.FirstName); 
```

几乎每一个 LINQ 运算符都是如此。实际上并不修改有问题的查询。相反，它们将查询结果过滤或投影到新的查询值中，并从方法中返回。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-11T17:07:43.537

除了@Mike Two 的回复，请记住，要进行多种排序，您需要在初始 OrderBy 之后使用 ThenBy 才能正常工作，否则您只需替换第一个排序即可。

```
var query = from contact in dc.Contacts
        select contact;

query = query.OrderBy(c => c.FirstName); 
query = query.ThenBy(c => c.LastName);

foreach (var contact in query)
{
  ...
} 
```

实际上，我的偏好是使用扩展方法将它们全部链接在一起，但*如果您需要将它们设置为 conditional ，显然这是行不通的*。

```
var query = dc.Contacts
              .OrderBy( c => c.FirstName )
              .ThenBy( c => c.LastName );

foreach (var contact in query)
{
   ...
} 
```

# java - 如何在 Tomcat JMX Beans 中隐藏数据源密码

> ID：740400
> 
> 赞同：4
> 
> 时间：2009-04-11T16:40:12.823
> 
> 标签：java, tomcat, jmx

Tomcat 通过 JMX 公开了大量有关其内部结构的信息。您可以查看数据源、连接器使用情况、线程池，应有尽有。

但是，它也暴露了 JDBC 数据源的密码（Catalina->DataSource->javax.sql.DataSource->...）。有什么办法可以隐藏这些信息不被发布？

我们已经找到了一种方法来通过修改包含在 Tomcat 发行版的 jar 文件中的 mbeans-descriptors.xml 文件来管理公开的 JMX 信息，但是，我们正在寻找一种方法来做到这一点而无需修改发行版。

那么，我们如何在 Tomcat 暴露的 JMX bean 中隐藏 JDBC 连接的密码字段呢？

问候， 比伦特·埃德米尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-09T13:26:51.053

只需将 JMX 级别的访问权限限制为已授权的人员即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-11T00:10:56.370

我们使用加密密码。密码在“那里”，但对临时用户不可用。

# xml - XSLT 和 XSL-FO 有什么区别？

> ID：740404
> 
> 赞同：44
> 
> 时间：2009-04-11T16:43:51.317
> 
> 标签：xml, xslt, xsl-fo

XSLT 和 XSL-FO 有什么区别？

我读过的每一个资源都把它们当作 1 来处理，或者至少非常紧密地联系在一起。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-11T17:04:31.847

我想知道这个问题的基础，因为我认为它很容易回答，但是一旦你来到这里：[http](http://www.w3.org/TR/xsl/) ://www.w3.org/TR/xsl/很明显它实际上是一个好问题 -因为页面上的第一件事就是这个声明：

> 该规范定义了可扩展样式表语言 (XSL) 的特性和语法，XSL 是一种用于表达样式表的语言。它由两部分组成：
> 
> 1.  一种用于转换 XML 文档 (XSLT) 的语言，以及
> 2.  用于指定格式化语义的 XML 词汇表。

然而，回到现实世界，XSLT（这也是大多数人认为 XSL 的意思）是一种将 XML 文档转换为其他东西的方法——其他东西通常不是另一个结构良好的文档，可能也被格式化为XML（尽管我使用 XSLT 将 XML 呈现为 csv 和纯（ish）文本）。

另一方面，XSL-FO 是关于格式化的——关于以相当严格的方式在一个页面或一系列页面上布置内容。它很有用，因为它允许您管理分布在多个页面上的内容，它相对简单地指定页面（或偶数页和奇数页）的格式，包括页眉、页脚、边框、列等，并使您的内容流入其中. 因此，人们会以 XML 格式加载数据，然后使用 XSLT 将该数据转换为由 XSL-FO 组成的文档，然后使用适当的工具（例如 PDF）进行渲染以进行打印或其他分发方式.

我的用例是获取一堆表格数据，将该数据导出为 XML，将其渲染为 XSL-FO，然后从那里转换为 PDF，然后再将其发送给打印机，打印机将所述 PDF 转换为 500 页的目录。在 XSL-FO 中指定需要页码、特定情况下的分页符、有一个目录和一个索引（每个都基于特定元素），并且呈现过程（到 PDF）处理填充页码全线。

希望你现在不那么困惑了..

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-08-30T17:20:25.367

除了首字母缩略词的相似性之外，这两种技术曾经是同一个 W3C 规范的一部分（草案形式）。后来决定将 XSL(XSL-fo) 和 XSLT 分成两个独立的规范。

[来自 W3Schools 的引述](http://www.w3schools.com/xslfo/xslfo_intro.asp)：

> XSL-FO 正式命名为 XSL
> 
> 为什么会出现这种混乱？XSL-FO 和 XSL 是一回事吗？
> 
> 是的，但我们会给你一个解释：
> 
> 样式化是关于转换和格式化信息。当万维网联盟 (W3C) 制定他们的第一个 XSL 工作草案时，它包含了用于转换和格式化 XML 文档的语言语法。
> 
> 后来，W3C 的工作组将原始草案拆分为单独的建议：
> 
> ```
> * XSLT, a language for transforming XML documents
> * XSL or XSL-FO, a language for formatting XML documents
> * XPath, a language for navigating in XML documents 
> ```

**年表的详细注释可以在 Dave Pawson 的主页上找到**： [http ://www.dpawson.co.uk/xsl/sect1/history.html](http://www.dpawson.co.uk/xsl/sect1/history.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-12-24T01:09:07.097

**[XSL](https://en.wikipedia.org/wiki/XSL)**是用于转换和呈现 XML 文档的语言家族

**XSLT** (XSL Transformations) : 是一种语言，用于将 XML 文档转换为**其他 XML**文档，或其他格式，例如网页的**HTML 、****纯文本**或**XSL Formatting Objects**，随后可以转换为其他格式，例如**PDF**、 PostScript和PNG。

**改造可以通过以下三种方式进行：**

1.  **参考：** [让浏览器做转换：](http://www.w3schools.com/xsl/el_processing-instruction.asp)使用`<xsl:processing-instruction>`
2.  **嵌入式：** [使用 JavaScript 的客户端转换。](http://www.w3schools.com/xsl/xsl_client.asp)
3.  **运行时：** [为了使 XML 数据可用于所有类型的浏览器，我们可以在 SERVER 上转换 XML 文档。](http://www.ictforu.com/index.php/programming/java/47-java-xslt)

**例如**：

[![在此处输入图像描述](https://i.stack.imgur.com/iUuqP.jpg)](https://i.stack.imgur.com/iUuqP.jpg) **XSL-FO**（XSL 格式化对象）：Web 浏览器不支持，因为它是为打印输出而设计的，而不是在线查看。（来自@Hobbes）
当前支持的输出格式包括 PDF、PCL、PS、AFP、TIFF、PNG、SVG、XML（区域树表示）、打印、AWT 和 TXT。主要输出目标是 PDF。[来源](https://xmlgraphics.apache.org/)

示例代码：

```
<fo:table-row height=".5cm">
            <fo:table-cell>
                <fo:block></fo:block>
            </fo:table-cell>
        </fo:table-row> 
```

流程图： [![在此处输入图像描述](https://i.stack.imgur.com/pGKcr.jpg)](https://i.stack.imgur.com/pGKcr.jpg)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-11T16:50:41.583

XSLT 用于转换，XSL（与 XSL-FO 相同）用于格式化。

[http://www.w3schools.com/xslfo/xslfo_intro.asp](http://www.w3schools.com/xslfo/xslfo_intro.asp)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-11T16:47:47.050

[维基百科的定义](http://en.wikipedia.org/wiki/XSL_Formatting_Objects)呢？

> XSL 格式化对象或 XSL-FO 是一种用于 XML 文档格式化的标记语言，最常用于生成 PDF。XSL-FO 是 XSL 的一部分，XSL 是一组 W3C 技术，专为 XML 数据的转换和格式化而设计。XSL 的其他部分是 XSLT 和 XPath。截至 2006 年 12 月 12 日，XSL-FO 的当前版本是 v1.1。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-24T14:13:14.830

[正如w3schools 教程网站](http://www.w3schools.com/xslfo/xslfo_intro.asp)（与 w3.org 无关）所说，这可能会让人很困惑

> XSL-FO 现在正式命名为 XSL

![在此处输入图像描述](https://i.stack.imgur.com/kQdyR.png)

这意味着 XSL-FO 和 XSL 是一回事，但它们不是！

XSL 基本上是将 XML 数据表示为 HTML 文档 XSL-FO 是关于文档本身的格式化。例如，如果您想将 XML 转换为 word 文档，您想添加页码、更改页边距或页面布局、添加页眉和页脚等。这些项目只能通过 XSL FO 标签来处理，XSLT 无法访问文档属性。在技​​术领域，您很可能会遇到 XML 数据以 word 或 PDF 文档呈现的场景。它需要页码、布局格式、页眉等。这些是文档中非常重要的部分。

另一个很大的区别是 XSL 和 XSL FO 有不同的引擎。XSL 无法呈现 XSL-FO 标记。这个问题讨论了 XSL FO 使用哪个引擎

[哪个是最好的商业 xsl fo 引擎？](https://stackoverflow.com/questions/2085448/which-is-the-best-commercial-xsl-fo-engine)

一个典型的 XSL Fo tempate 像这样

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">

<fo:layout-master-set>
  <fo:simple-page-master master-name="A4">
    <fo:region-body />
  </fo:simple-page-master>
</fo:layout-master-set>

<fo:page-sequence master-reference="A4">
  <fo:flow flow-name="xsl-region-body">
    <fo:block>Hello W3Schools</fo:block>
  </fo:flow>
</fo:page-sequence>

</fo:root> 
```

请注意，没有对 XML 数据的引用。这完全是关于格式化文档本身。在将 XML 数据转换为合法文档时，这是一个极其重要的元素。因为如果输出文档是 pdf 或 word，则需要寻呼机编号、文档编号、布局等。没有这些信息，很难实现页码或标题等。

出现混淆是因为该文档几乎肯定会包含 XSL 标记，因为我们将提取 XML 数据。但是，如果没有 XSL Fo 引擎，则不会呈现文档。

所以简而言之，它们是相似的并且可以一起工作，但它们不是一回事。它们由不同的引擎渲染。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-12-04T09:51:23.757

像许多其他事情一样，这取决于你的观点和你的历史。

XSLT 是一种语言（用 XML 编写）“用于将 XML 文档转换为其他 XML 文档。”尽管当前的 XSLT 3.0 CR ( [http://www.w3.org/TR/xslt-30/](http://www.w3.org/TR/xslt-30/) ) 将其更改为“a*主要*设计用于将 XML 文档转换为其他 XML 文档的语言。” （强调补充。）

XSL-FO 是“用于指定格式化语义的 XML 词汇表”。它在“可扩展样式表语言 (XSL) 版本 1.1”建议 ( [http://www.w3.org/TR/xsl11/](http://www.w3.org/TR/xsl11/) ) 中定义。格式化程序（例如来自 Antenna House）的格式化程序采用 FO 词汇表中的 XML 文档并生成样式化和分页输出。

历史的来源是，最初只有一个规范——可扩展样式表语言 (XSL)——定义了转换——将你的 XML 放入 FO XML 词汇表——和样式——将 FO 放入样式和样式中。分页形式。Dave Pawson ( [http://www.dpawson.co.uk/xsl/sect1/history.html](http://www.dpawson.co.uk/xsl/sect1/history.html) ) 的历史页面链接到 Mads Hansen 的答案有完整的细节，但在 XSL 成为推荐的过程中，转换部分被认为是普遍有用的，并被分解为“XSL 转换 (XSLT)”。将标记转换为标记并不是什么新鲜事，但是拥有一个具有多个（大部分）兼容实现的标准是一股新鲜空气。

XSLT 处理部分 XML 文档的方式也被普遍认为是有用的，它被分解为“XML 路径语言 (XPath)”，因此它可以被其他规范使用。（例如，XQuery 和 XLink 使用 XPath。）

其观点是，XSL 1.1 建议书仍然定义了转换加格式化的过程，但转换部分恰好在单独的文档中定义。见[http://www.w3.org/TR/xsl11/#d0e386](http://www.w3.org/TR/xsl11/#d0e386)

虽然官方 XSL 1.1 PoV 是 XSLT 和 XSL-FO 都是 XSL 的一部分，并且可能每个 FO 格式化程序都可以完成转换部分，但实际上，大多数人使用外部 XSLT 处理器将他们的 XML 转换为 FO 词汇表中的 XML，并且将该 FO XML 提供给他们的格式化程序。

历史与观点相遇的地方是 XSLT 1.0 ( [http://www.w3.org/TR/xslt](http://www.w3.org/TR/xslt) ) 将自己定义为 XSL 系统的一部分：

> XSLT 设计为用作 XSL 的一部分，XSL 是一种用于 XML 的样式表语言。除了 XSLT，XSL 还包括一个用于指定格式的 XML 词汇表。XSL 通过使用 XSLT 来描述如何将文档转换为另一个使用格式化词汇表的 XML 文档来指定 XML 文档的样式。

但这种观点在 XSLT 2.0 ( [http://www.w3.org/TR/xslt20/](http://www.w3.org/TR/xslt20/) ) 中不存在，并且在 XSLT 3.0 时早已不复存在。

观点的最后一部分是，当许多人说“XSL”时，他们的意思只是 XSLT，除了那些当他们说“XSL”时，他们的意思是 XSL-FO，而大多数人都忘记了他们的 FO 格式化程序可以同时做这两者。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-11T16:48:23.523

XSL-FO 代表可扩展样式表语言格式化对象，它是关于格式化的，现在被称为 XSL 以避免所有混淆。所以不要再担心 XSL-FO。

然而，XSLT 是关于转换 XML 的。所以非常清楚。XSL 是关于格式化的，而 XSLT 是关于转换的。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-11T16:47:16.350

XSLT 是一种模板格式，可用于生成各种文档，包括纯文本文档。

XSL-FO 表示使用 XSLT 生成 FO 文档。

# iphone - 系统是否总是会在布局更改时调用 UIView 的 layoutSubviews: 方法，以便我可以对布局的更改做出反应？

> ID：740406
> 
> 赞同：1
> 
> 时间：2009-04-11T16:46:24.260
> 
> 标签：iphone

示例：如果用户在使用应用程序的过程中接听电话，系统将退出应用程序。但是，如果用户在通话时返回应用程序，则状态栏将比平时高。那是表示他还在通话中。但是，这会导致布局问题。就像我理解的那样，系统然后会向我布局中每个 UIView 对象的 layoutSubviews 方法发送一条消息，对吗？系统调用的任何布局更改都会发生这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T13:35:41.020

几何体的基本更改不会触发此方法（请参阅 Apple 在 UIView 上的文档）。您可以尝试将视图的 contentMode 设置为 UIViewContentModeRedraw，这将导致系统在您的视图上调用 drawRect: 以进行所有几何更改（大概包括通话栏就位时）。您可能不想一直从 drawRect 调用 layoutSubviews:，因为完全重新创建复杂的视图层次结构会影响性能，但您至少可以根据传递的具体确定哪些子视图需要调整大小/重绘CGRect 和修改那些。

# java - 如何在 Swing 中捕获此异常？

> ID：740418
> 
> 赞同：10
> 
> 时间：2009-04-11T16:57:06.060
> 
> 标签：java, swing, exception

我有一个 Swing 应用程序，即使我拥有`try`/`block`中的所有内容，也没有捕获到异常。

```
public static void main(String[] args) {

    try {
        App app = new App();
        app.setVisible(true);

    } catch (Throwable e) {
       System.err.println("never printed");
    }
} 
```

我得到的只是这个堆栈跟踪：

```
Exception in thread "AWT-EventQueue-0" 
java.lang.ArrayIndexOutOfBoundsException: 
9 >= 9
at java.util.Vector.elementAt(Vector.java:427)
at javax.swing.table.DefaultTableModel.getValueAt(DefaultTableModel.java:633)
at javax.swing.JTable.getValueAt(JTable.java:2695)
at javax.swing.JTable.prepareRenderer(JTable.java:5712)
at javax.swing.plaf.basic.BasicTableUI.paintCell(BasicTableUI.java:2075)
at javax.swing.plaf.basic.BasicTableUI.paintCells(BasicTableUI.java:1977)
at javax.swing.plaf.basic.BasicTableUI.paint(BasicTableUI.java:1773)
at javax.swing.plaf.ComponentUI.update(ComponentUI.java:143)
at javax.swing.JComponent.paintComponent(JComponent.java:763)
at javax.swing.JComponent.paint(JComponent.java:1027)
at javax.swing.JComponent.paintChildren(JComponent.java:864)
at javax.swing.JComponent.paint(JComponent.java:1036)
at javax.swing.JViewport.paint(JViewport.java:747)
at javax.swing.JComponent.paintChildren(JComponent.java:864)
at javax.swing.JComponent.paint(JComponent.java:1036)
at javax.swing.JComponent.paintChildren(JComponent.java:864)
at javax.swing.JComponent.paint(JComponent.java:1036)
at javax.swing.JComponent.paintChildren(JComponent.java:864)
at javax.swing.JComponent.paint(JComponent.java:1036)
at javax.swing.JLayeredPane.paint(JLayeredPane.java:564)
at javax.swing.JComponent.paintChildren(JComponent.java:864)
at javax.swing.JComponent.paintToOffscreen(JComponent.java:5129)
at javax.swing.BufferStrategyPaintManager.paint
(BufferStrategyPaintManager.java:277)
at javax.swing.RepaintManager.paint(RepaintManager.java:1217)
at javax.swing.JComponent.paint(JComponent.java:1013)
at java.awt.GraphicsCallback$PaintCallback.run(GraphicsCallback.java:21)
at sun.awt.SunGraphicsCallback.runOneComponent(SunGraphicsCallback.java:60)
at sun.awt.SunGraphicsCallback.runComponents(SunGraphicsCallback.java:97)
at java.awt.Container.paint(Container.java:1780)
at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:814)
at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:714)
at javax.swing.RepaintManager.seqPaintDirtyRegions(RepaintManager.java:694)
at javax.swing.SystemEventQueueUtilities$ComponentWorkRequest.run
(SystemEventQueueUtilities.java:128)
at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:209)
at java.awt.EventQueue.dispatchEvent(EventQueue.java:597)
at java.awt.EventDispatchThread.pumpOneEventForFilters
(EventDispatchThread.java:269)
at java.awt.EventDispatchThread.pumpEventsForFilter
(EventDispatchThread.java:184)
at java.awt.EventDispatchThread.pumpEventsForHierarchy
(EventDispatchThread.java:174)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:169)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:161)
at java.awt.EventDispatchThread.run(EventDispatchThread.java:122) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-11T18:35:17.540

正如另一张海报所提到的，您的问题是在另一个线程中引发了异常，即事件调度线程。几个解决方案：

*   在发生异常的实际代码周围放置一个 try/catch：例如，如果它响应 ActionListener 处理的按钮单击，则将 try/catch 放在您的 actionPerformed() 方法中；
*   或者，将异常保留为未捕获的异常，并添加[未捕获的异常处理程序](http://www.javamex.com/tutorials/exceptions/exceptions_uncaught_handler.shtml)。例如：

```
 Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() {
      public void uncaughtException(Thread t, Throwable e) {
        // ... do something with exception here ...
      }
    }); 
```

附带说明一下，原则上您应该将 UI 启动代码放在[SwingUtilities.invokeLater()](http://www.javamex.com/tutorials/threads/invokelater.shtml)中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T17:08:20.167

Swing 在事件分派线程中运行事物。您正试图在主线程中捕获它。

请注意，swing 不是线程安全的，您也应该在事件调度线程中做事。

要捕获异常，您可以覆盖该堆栈跟踪中的某些方法，例如组件中的 paint 方法。

对我来说，这个异常确实看起来像是一个你应该修复的错误，而不是你应该通过捕捉来隐藏的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T22:49:02.330

像 ArrayIndexOutOfBoundsException 这样的运行时异常显示了程序员的错误。因此，修复它们可能会更好，而不是抓住并默默地咀嚼它。

只是对异常原因的疯狂猜测。一旦 JTable 开始在屏幕上绘制数据，就会同时从表模型的数据向量中删除行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T01:59:09.273

我知道，为了捕获从 EDT 内部抛出的异常，唯一合适的方法是：

*   编写自己的 EventQueue（我一般不会建议）
*   使用 Swing 内部属性“ `sun.awt.exception.handler`”（我使用它，它至少适用于所有 Sun JDK 1.4、1.5 和 1.6，至少适用于 IBM JDK 1.4 和 1.5；我没有；虽然没有在其他 JDK 上检查它）

您应该查看[此线程](https://appframework.dev.java.net/servlets/ReadMsg?list=users&msgNo=1113)，以更完整地了解解决方案及其优缺点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T20:19:47.087

如上所述，问题在于异常被抛出的地方——在事件调度线程上。

如果你想设置一个 try/catch 块来捕捉这个特定的问题，我会在 App 类的 paint 方法中加入一个。覆盖它并在那里的 try catch 块中调用 super.paint 。

如果您想要一种捕获未捕获异常的通用方法，请查看[Thread.setUncaughtExceptionHandler](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#setUncaughtExceptionHandler(java.lang.Thread.UncaughtExceptionHandler))。您使用异常处理程序调用该方法，您可以处理应用程序中未捕获的所有异常。

# c++ - 用于处理文件路径的 Qt 类

> ID：740423
> 
> 赞同：10
> 
> 时间：2009-04-11T17:00:18.253
> 
> 标签：c++, qt

> **可能重复：**
> [Qt 相当于 PathAppend？](https://stackoverflow.com/questions/13014145/qt-equivalent-of-pathappend)

Qt 中有处理文件路径的类吗？特别是我正在寻找类似.NET 的 Path.Combine 的东西。

我知道 boost::filesystem 中有一个，但我想知道 Qt 中是否有一个。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-11T17:30:56.570

有[QDir](http://doc.qt.io/qt-4.8/qdir.html)可能会有所帮助（请参阅`QDir::relativeFilePath`和`QDir::canonicalPath`其他）。

引用 QDir 文档：

> QDir 用于操作路径名、访问有关路径和文件的信息以及操作底层文件系统。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-15T17:27:53.613

另一个可能有用的类是`QFileInfo`.

来自 Qt 文档：

> QFileInfo 类提供与系统无关的文件信息。
> 
> QFileInfo 提供有关文件名和文件系统中的位置（路径）、其访问权限以及它是目录还是符号链接等信息。文件的大小和最后修改/读取时间也可用。QFileInfo 也可用于获取有关 Qt 资源的信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T17:47:57.543

QDir 提供对目录内容的访问并允许进行各种操作（例如 mkdir）。但不幸的是，没有用于路径组件操作的类。

# jquery - jQuery-UI 日期选择器：可拖动？

> ID：740434
> 
> 赞同：5
> 
> 时间：2009-04-11T17:05:07.727
> 
> 标签：jquery, jquery-ui, datepicker, draggable

（希望）简单的问题：

是否可以使 jQuery UI Datepicker 可拖动？如果是这样，有人可以给我一些示例代码吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-11T17:07:38.780

$(".ui-datepicker").draggable() 不起作用？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-11T17:33:27.987

顺序很重要。

```
$('#myCalendarInput').datepicker();
$('#ui-datepicker-div').draggable(); 
```

**编辑**：@JZ 提供的答案和我的答案之间存在细微差别。使用 JZ 的示例，页面上的任何日期选择器都是可拖动的，即使是内联的（与 DIV 而不是输入元素相关联）。我的代码只会使弹出日期选择器可拖动。datepicker 插件为所有弹出窗口创建一个单独的 DIV（名为 ui-datepicker-div），并将其重用于应用了 datepicker 的页面上的任何输入。对于内联 DIV 或 SPAN，它会在具有 .ui-datepicker 类但没有名称的 DIV/SPAN 内创建一个新的未命名日期选择器。在这种情况下，我的代码不会使日期选择器可拖动，可以说是正确的行为，但 JZ 会因为它将基于类进行匹配。

例子：

```
<script type="text/javascript">
$(document).ready(function() {
    $('#calendar').datepicker();
    $('#calendar2').datepicker();
    $('#calendar3').datepicker();
    $('#ui-datepicker-div').draggable();
});
</script>

<div>
Calendar: <input id="calendar" type="text" /><br />  <-- draggable
Calendar2: <input id="calendar2" type="text" /><br/> <-- draggable
Fixed calendar: <div id="calendar3"></div> <-- fixed
</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T13:52:10.227

您可以在 datepicker 中添加一个事件并使用它来使其可拖动。

```
//Add an event "onCreate"
$.datepicker._updateDatepicker_Old = $.datepicker._updateDatepicker;
$.datepicker._updateDatepicker = function(inst) {
    this._updateDatepicker_Old(inst);

    var onCreate = this._get(inst, 'onCreate');
    if (onCreate !== null) {
        onCreate(inst);
    }
}; 
```

After you call datepicker and implements the function onCreate to made it draggable.

```
$(function() {
    //Create datepicker
    $('#datepicker').datepicker({
        onCreate: function(inst) {
            $(inst.dpDiv).draggable();
        }
    });
});​ 
```

[Example jsfiddle](http://jsfiddle.net/Mouxon/Fp8VA/)

# c++ - 如何将此 VC++ 6 代码转换为 VC++ 2008？

> ID：740435
> 
> 赞同：2
> 
> 时间：2009-04-11T17:06:23.837
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-c++

请原谅我的 C++ 生锈得令人难以置信。但我正在尝试获取一些旧代码并在 Visual C++ 2008 下重新编译它。它最初是为 Visual C++ 6.0 编写的

我得到的错误是：

> 错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

好的，看起来很简单。但后来我看看有问题的代码行：

```
operator=(int i) {SetAsInt(i);}; 
```

它似乎声明了类型。那么我错过了什么？

**跟进：**

我接受了 Micheals 的建议并添加了函数（类）的返回类型，并添加了*return this；*到每个结束。然后我遇到了这个：

```
operator=(const CString& str); 
```

没有定义函数体......这究竟是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-11T17:09:20.477

您需要让该`operator=()`方法返回某些内容（如果诊断不是错误，它将假定 int ，因为错误消息有些令人困惑）。

通常它是对操作员正在处理的对象的引用，因此可以像在正常的赋值表达式中一样链接赋值。就像是：

```
// where T is the class for this operator= implementation

T& operator=( int i) {
     // ...
    return *this;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T17:14:57.513

正如迈克尔所说， operator= 需要一个返回类型，但这种类型可以是无效的：

```
class A {
   ...  
   void operator = ( int i ) {
      SetAsInt(i);
   }
}; 
```

尽管这意味着您将无法“菊花链”分配。

关于后续，可能是说禁止课堂作业：

```
class B {
    private:
        void operator =( const B & );    
}; 
```

将分配操作（通常是复制 ctor）设为私有然后不实现它们意味着不可能分配（或复制）类实例，这是大多数面向业务的类的理想行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-25T14:54:43.190

返回 ANYTHING 但 lval 通常是错误的，仅在非常特殊的情况下使用

当然返回一个 const 引用会排除赋值链（a=(b=c)），并且操作符的部分目的是使类表现得像内置类型

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T17:33:49.607

对于您的第二个问题，声明很可能被用来防止复制对象。

来自[Danny Kalev 的 C++ 参考指南](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=368)

> 问题：如何防止对象复制？
> 
> 答：将复制构造函数和赋值运算符声明为私有成员，而不定义它们。任何涉及直接或间接复制该类的语句都会导致编译错误。这种技术并不完全是优雅的形象，但在当代 C++ 中，没有其他方法可以廉价地阻止复制。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-11T17:35:10.977

关于您的编辑：这仅表示该函数已被声明，但未定义。编译器知道它存在，所以调用它是合法的。但它会产生链接器错误，除非编译器实际上能够在某处找到主体。

通常，您在头文件中定义函数，然后在 .cpp 文件中，您有类似

```
// Assuming the class it is a member of is called Foo
Foo& Foo::operator=(const CString& str) {
 ...
} 
```

这里唯一需要注意的是 Foo:: 前缀。因为这个定义在类定义本身之外，所以我们必须使用这个前缀来指定我们正在定义的 operator= 属于 Foo 类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-11T18:51:30.590

嗯，这是一个赋值运算符。它有助于定义如何将其他对象（相同类型和其他类型）分配给定义它的类的实例。

*正确*的语法是（假设你的类被称为“对象”）：

```
const Object& operator=(const Object& other)
{
  // copy members, one at a time.
  this->member1 = other.member1;
  return *this;
} 
```

注意返回类型是常量。这是为了避免语义不正确、语法正确的语句，例如：

```
Object A, B, C;

(A = B) = C; 
```

如果将返回类型定义为常量，则上面的代码将无法编译（足够合理，因为它真的很乱），而省略 const 将允许编译这种糟糕的代码，当然有人会扯头发试图弄清楚怎么了。

PS您可能需要考虑一下：如果您从返回类型中省略 const 并执行 (A = B) = C; 会发生什么？代码？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-11T21:06:46.287

关于后续问题，在这种情况下，返回类型可以是任何东西。然而，由于大多数赋值运算符返回对它们声明所在类的引用，因此最好只返回该引用，以免使读者感到困惑。

```
CString& operator=(const CString& str); 
```

据推测，这个函数是在`private`类的部分中声明的。这是使类的对象不可赋值的标准习惯用法。

# .net - 类似于 .NET Framework 2.0 的 MEF（托管扩展性框架）

> ID：740438
> 
> 赞同：2
> 
> 时间：2009-04-11T17:08:02.180
> 
> 标签：.net, plugins, mef

我在自己的项目中使用了 MEF，我非常喜欢它。这很简单，在弄清楚我们*笨拙*的API 模型之后，它就奏效了。

现在我需要为 .NET Framework 2.0 提供类似的东西。有没有类似的项目可以在 .NET Framework 2.0 下运行？

我只是想以一种简单的方式为我的项目添加插件支持。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-11T17:17:43.343

看看[Mono.Addins](http://mono-project.com/Mono.Addins) AFAIK 它建立在 .NET 2.0 上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T11:30:36.460

你可以试试[R.SAT](http://rsat.codeplex.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T17:10:43.470

我知道 SharpDevelop 有一个插件机制。也许您可以查看他们的源代码： http: [//www.icharpcode.net/OpenSource/SD/](http://www.icsharpcode.net/OpenSource/SD/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T17:29:54.000

我认为最接近的是 System.Addins 命名空间，但这是 3.5 的功能。它不需要与 2.0 不同的 CLR，但它确实需要在目标机器上安装 3.5 框架。

[http://www.codeplex.com/clraddins](http://www.codeplex.com/clraddins)

# perl - 为什么我的 Perl 函数不起作用？

> ID：740443
> 
> 赞同：4
> 
> 时间：2009-04-11T17:09:17.217
> 
> 标签：perl, function, pass-by-reference

我写的函数有问题...

```
sub TemplateReplace
{
    my($regex, $replacement, $text) = @_;
    $text =~ s/($regex)/($replacement)/gs;
}

my $text = "This is a test.";
TemplateReplace("test", "banana", $text); 
```

但它不起作用。我认为参数是在 Perl 中通过引用发送的。然后该行`my($regex, $replacement, $text) = @_;`会复制它们吗？我该如何解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-11T17:16:02.690

```
sub TemplateReplace
{
   my($regex, $replacement, $text) = @_;
   $text =~ s/($regex)/($replacement)/gs;
   return $text;
}

 my $text = "This is a test.";
 $text = TemplateReplace("test", "banana", $text); 
```

那里。那应该行得通。

是的，你的 my( ..) = @_ 确实复制了参数。所以如果你正在修改一个变量，你需要返回它，除非它是一个全局变量。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-11T17:30:40.333

`$text`您正在修改您传入的副本；这对原件没有影响。

```
#!/usr/bin/perl

use strict;
use warnings;

my $text = "This is a test.";

template_replace(qr/test/, "bannana", $text);

print "$text\n";

sub template_replace {
    my $regex       = shift;
    my $replacement = shift;
    $_[0] =~ s/$regex/$replacement/gs;
} 
```

上面的代码之所以有效，是因为 @_ 的元素是传入变量的别名。但[Adnan](https://stackoverflow.com/questions/740443/why-wont-my-perl-function-work/740455#740455)的答案是更常见的做法。修改传递给函数的参数是令人惊讶的行为，并且会使事情`template_replace(qr/foo/, "bar", "foo is foo")`不起作用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-11T17:29:42.457

制作数据副本的是子程序的“赋值”部分。

如果您直接修改 @_ 参数，它们将按您的预期工作。但是，它的可读性不是很高。:-)

```
use strict;
umask(0);
$|=1;
my $debug = 0;

my $text = "This is a test.";

print "Before 1: [$text]\n";
TemplateReplace("test", "banana", $text);
print "After 1: [$text]\n";

print "Before 2: [$text]\n";
TemplateReplace2("test", "banana", $text);
print "After 2: [$text]\n";

sub TemplateReplace
   {
   my ($regex, $replacement, $text) = @_;    

   $text =~ s/($regex)/($replacement)/gs;
   }

sub TemplateReplace2
   {
   $_[2] =~ s/$_[0]/$_[1]/gs;
   } 
```

返回：

```
Before 1: [This is a test.]
After 1: [This is a test.]
Before 2: [This is a test.]
After 2: [This is a banana.] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T19:01:15.770

这是有关如何执行此操作的变体，它与您的代码几乎相同，但略有不同。

```
use strict;
use warnings;

sub TemplateReplace {
    my($regex, $replacement, $text) = @_;
    $$text =~ s/($regex)/$replacement/gs;
}

my $text = "This  is a test."; 
TemplateReplace("test", "banana", \$text);
print $text; 
```

这种行为是*显式*的而不是*隐式*的。实际上，它的工作原理与[Chas 相同。Owens](https://stackoverflow.com/questions/740443/why-wont-my-perl-function-work/740485#740485)结果，但使用标量引用而不是依赖于理解数组的行为。

这将使任何阅读您的代码的人更清楚地知道函数“TemplateReplace”是*故意*修改 $text。

此外，它会告诉你用 squawking 错误地使用它：

```
在 replace.pl 第 9 行使用“严格引用”时，不能使用字符串（“这是一个测试。”）作为 SCALAR 引用。

```

如果你碰巧忘记了 \ 某处。

# http - 如何使用 IIS 在 HTTP 上传输多人游戏数据以最小化延迟？

> ID：740445
> 
> 赞同：4
> 
> 时间：2009-04-11T17:09:21.833
> 
> 标签：http, iis, latency

我想创建一个基于浏览器的网络游戏。为了确保它可以被尽可能多的人使用，我想将所有流量嵌入到标准 HTTP 包中。

假设我使用 IIS 作为后端，我应该如何编写代码以最大限度地减少延迟？

从使用内存中的共享状态的某种 ASP 应用程序（可能是 ASP.NET MVC）开始是否合理？还是我应该从一开始就计划编写自己的某种 IIS 插件？还是我应该放弃 IIS 并改为编写自定义服务器？

从每个客户端重复查询开始是否合理，比如每秒十次，或者我应该以某种方式使数据更像流（如果是这样的话）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T17:23:11.333

这可以正常工作，但您将不得不做一些不那么“传统”的事情。

要使这项工作正常进行，请不要执行单独的请求，保持请求打开，然后使用打开的连接传输数据。

你可以尝试使用像[Bayeux](http://svn.cometd.org/trunk/bayeux/bayeux.html)这样的协议，但这里没有规则。

[这是一个使用 COMET 的 ASP.NET 示例](http://neilmosafi.blogspot.com/2009/03/comet-bayeux-protocol-and-aspnet.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T17:20:45.690

设计一个每秒访问 Web 服务器 10 次的应用程序并不是一个好主意。Web 服务器设计用于较不频繁的客户端请求以及可能比您的游戏将使用的更大的处理时间和响应大小。这并不是说 Web 服务器无法应对，只是它不是有效的客户端-服务器匹配。

对于每秒需要多个数据包的任何类型的应用程序，您确实应该考虑比 HTTP 更轻的协议，后者相当冗长。例如，如果您的游戏需要发送 4 个字节来注册用户的战舰坐标，您实际上并不想传输额外的几百字节的 HTTP 标头。

我会推荐一种浏览器插件技术，比如 Flash 的 Silverlight。两者都支持 TCP 套接字连接。您需要编写自己的服务器以坐在 TCP 套接字的另一端。使用这种方法，您还可以将数据推送到客户端，而不必依赖 HTTP 所需的客户端轮询机制，例如 AJAX。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T17:24:23.483

标准 HTTP 消息将面临的一个问题是对标头数据的大小（以及缺乏控制）。

我参与了一个有数百万人玩的 Flash 游戏的设计。我们需要每隔几秒就与服务器进行一次通信，最终使用超轻量级的 JSON 消息来节省带宽并保持其快速运行。

JSON 消息大小：16 字节

HTTP 标头大小：200+ 字节

对于高流量、低延迟的要求，HTTP 并不是一个很好的协议。它是为更大、更不频繁的请求/响应模型而设计的，并且出于这个原因具有诸如[304 Not Modified 之类的状态代码。](http://www.checkupdown.com/status/E304.html)

您可能想要下拉到自定义 TCP/IP 实现。

# wcf - 配置 WCF 表单身份验证

> ID：740447
> 
> 赞同：5
> 
> 时间：2009-04-11T17:10:00.693
> 
> 标签：wcf, forms-authentication

在我的服务实施中，我有：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)]
```

在我的 .config 文件中，我有：

```
<serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
```

和：

```
  <system.web.extensions>
    <脚本>
      <网络服务>
        <authenticationService enabled="true" requireSSL = "false"/>
      </web服务>
    </脚本>
  </system.web.extensions>

```

和：

```
<authentication mode="Forms" />
```

在我的服务的“登录”方法中，我有：

```
FormsAuthentication.SetAuthCookie(request.UserName, false);
```

但是，当我检查时：

```
HttpContext.Current.User.Identity.Name
```

它是一个空字符串。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-28T09:24:49.973

尝试改用 ServiceContext.User.Identity。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T20:09:30.713

当您希望用户填写登录表单时，使用表单身份验证。

对于服务，最好使用不同的身份验证机制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-16T21:56:59.400

我假设您在后续请求中检查 Identity.Name ？

您的 web.config 中有元素吗？

您是否还确保从登录响应中捕获 cookie 并在后续请求中重新发送它？

# iphone - 如何对 UIApplicationDidReceiveMemoryWarningNotification 做出反应？

> ID：740454
> 
> 赞同：0
> 
> 时间：2009-04-11T17:15:54.643
> 
> 标签：iphone

当内存变低时，系统会发送 UIApplicationDidReceiveMemoryWarningNotification 通知。但我不明白......这不是我必须在我的 App Delegate 中实现的方法，对吧？我如何获得此通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T17:25:44.430

您将在您的应用委托中实现“applicationDidReceiveMemoryWarning:(UI Application *)application”。

这是一个警告通知，告诉您即将超出内存限制，此时，操作系统将终止您的应用程序进程 - 在 applicationDidReceiveMemoryWarning 您有机会释放并释放一些内存以防止操作系统杀死您的应用程序。

```
@interface MyApp: NSObject <UIApplicationDelegate>
{
}
@end
@implementation
-(void)applicationDidReceiveMemoryWarning:(UIApplication *)application {
  [[TextureMgr sharedTextureMgr] removeAllTextures];
}
@end 
```

这是该功能的标准“Cocos2D-iphone”实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T17:27:18.983

您的应用程序委托可以实现该`-applicationDidReceiveMemoryWarning:`方法。其他对象可以注册为 的观察者`UIApplicationDidReceiveMemoryWarningNotification`。请参阅文档中有关“管理内存使用”的部分，位于[http://developer.apple.com/iphone/library/documentation/Performance/Conceptual/ManagingMemory/Articles/MemoryAlloc.html#//apple_ref/doc/uid /20001881-SW1](http://developer.apple.com/iphone/library/documentation/Performance/Conceptual/ManagingMemory/Articles/MemoryAlloc.html#//apple_ref/doc/uid/20001881-SW1)

# jsp - 包含的页面组件中的 jsp useBean 范围

> ID：740459
> 
> 赞同：0
> 
> 时间：2009-04-11T17:19:09.563
> 
> 标签：jsp, scope, components

我正在创建一个站点，其中有许多页面组件引用页面中其他地方使用的对象。其中一些组件也用于其他页面，因此我希望使用包括而不是剪切和粘贴。

问题是如果我在页面的多个组件中有相同的“jsp:useBean”语句，编译器会给出错误“重复的局部变量”。

如何在 JSP 页面的多个组件中使用相同的对象，而文件中没有所有内容？

示例：在主（父）页面中：

```
<jsp:useBean id="fred" class="..." scope="request" />

<jsp:directive.include file="myWidget.jsp" /> 
```

包含的页面 myWidget.jsp 也需要使用“fred”对象：

```
<jsp:useBean id="fred" class="..." scope="request" /> 
```

但是，这会导致编译失败，并出现“重复的局部变量 'fred'”。

这基本上破坏了将页面分解为组件的想法；我不希望有数百行长的 JSP 文件，它们之间只是略有不同！

对于一个组件，在站点的每个页面上保持一致是绝对必要的，我已经使用 scriptlet 解决了这个问题：

```
<%
    { // for scope
        Object _o1 = request.getAttribute("fred");
        if (_o1 !=null && _o1 instanceof MyClass)
        {
            // use a deliberately obscure variable name to avoid conflict
            MyClass _myLocalFred1 = (MyClass) _o1; 

        }
    } // for scope
%> 
```

这行得通，但很难看；有几本书说“永远不要使用 scriptlet”，但 scriptlet 似乎是唯一可以控制变量范围的方法，而且我可以使用名称而不必担心它们在页面的其他地方使用。

如何在包含的文件中使用 jsp:useBean？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T01:20:46.900

我最终使用了 Struts 框架的“Tiles”部分。它提供了组件的隔离，因此它们不会污染彼此的命名空间。

# c# - 检查井字游戏的赢家？

> ID：740467
> 
> 赞同：5
> 
> 时间：2009-04-11T17:24:01.003
> 
> 标签：c#, if-statement

（在 2 人游戏中）查看井字游戏获胜的最佳方式是什么？现在我正在使用类似于以下内容的东西：

```
if (btnOne.Text == "X" && btnTwo.Text == "X" && btnThree.Text == "X")
{
    MessageBox.Show("X has won!", "X won!");
    return;
}
else
// I'm not going to write the rest but it's really just a bunch
// if statements. 
```

那么如何摆脱多重if呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-11T17:25:55.600

一些东西：

```
rowSum == 3 || columnSum == 3 || diagnolSum == 3 
```

.. ?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T18:24:06.087

如果将按钮存储在多维数组中，则可以编写一些扩展方法来获取行、列和对角线。

```
public static class MultiDimensionalArrayExtensions
{
  public static IEnumerable<T> Row<T>(this T[,] array, int row)
  {
    var columnLower = array.GetLowerBound(1);
    var columnUpper = array.GetUpperBound(1);

    for (int i = columnLower; i <= columnUpper; i++)
    {
      yield return array[row, i];
    }
  }

  public static IEnumerable<T> Column<T>(this T[,] array, int column)
  {
    var rowLower = array.GetLowerBound(0);
    var rowUpper = array.GetUpperBound(0);

    for (int i = rowLower; i <= rowUpper; i++)
    {
      yield return array[i, column];
    }
  }

  public static IEnumerable<T> Diagonal<T>(this T[,] array,
                                           DiagonalDirection direction)
  {
    var rowLower = array.GetLowerBound(0);
    var rowUpper = array.GetUpperBound(0);
    var columnLower = array.GetLowerBound(1);
    var columnUpper = array.GetUpperBound(1);

    for (int row = rowLower, column = columnLower;
         row <= rowUpper && column <= columnUpper;
         row++, column++)
   {
      int realColumn = column;
      if (direction == DiagonalDirection.DownLeft)
        realColumn = columnUpper - columnLower - column;

      yield return array[row, realColumn];
    }
  }

  public enum DiagonalDirection
  {
    DownRight,
    DownLeft
  }
} 
```

如果您使用`TableLayoutPanel`3 行和 3 列的 a，您可以轻松地以可编程方式创建按钮并将其存储到`Button[3, 3]`数组中。

```
Button[,] gameButtons = new Button[3, 3];

for (int row = 0; column <= 3; row++)
  for (int column = 0; column <= 3; column++)
  {
    Button button = new Button();
    // button...
    gameLayoutPanel.Items.Add(button);
    gameButtons[row, column] = button;
  } 
```

并检查获胜者：

```
string player = "X";
Func<Button, bool> playerWin = b => b.Value == player;
gameButtons.Row(0).All(playerWin) ||
// ...
gameButtons.Column(0).All(playerWin) ||
// ...
gameButtons.Diagonal(DiagonalDirection.DownRight).All(playerWin) ||
// ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T17:42:45.590

另一种简单的方法是将可获胜的位置保存为数组中的数据，并使用循环来检查所有可能的获胜条件，而不是使用多个 ifs 语句

```
// winnable positions
var winnables = new[] {
    "012",
    "345",
    "678",
    "036",
    "147",
    "258",
    "048",
    "246"
};

// extracted from btnOne Two Three....
var gameState = new[] { "X", "O", "X", "whatever" };

string winner = null;

// check each winnable positions
foreach (var position in winnables) {

    var pos1 = int.Parse(position[0].ToString());
    var pos2 = int.Parse(position[1].ToString());
    var pos3 = int.Parse(position[2].ToString());

    if (gameState[pos1] == gameState[pos2] &&
        gameState[pos2] == gameState[pos3])
        winner = gameState[pos1];

}

// do we have a winner?
if (!string.IsNullOrEmpty(winner))
    /* we've got a winner */ 
```

基本上，不要使用 btnOne btnTwo btnThree，使用适当的 Button 数组或以更易于访问的格式保存游戏状态的数组，这样会更容易计算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-22T00:21:15.190

我倾向于做这样的事情：

```
bool x_wins =
    Enumerable
        .Range(0, 3)
        .SelectMany(i => new Func<int, string>[] { x => array[i, x], x => array[x, i] })
        .Concat(new Func<int, string>[] { x => array[x, x], x => array[2 - x, x], })
        .Where(f => String.Concat(Enumerable.Range(0, 3).Select(x => f(x))) == "XXX")
        .Any(); 
```

# c# - 找不到xml路径错误

> ID：740469
> 
> 赞同：1
> 
> 时间：2009-04-11T17:24:25.153
> 
> 标签：c#, .net, asp.net, xml, linq

我什至觉得问这个问题有点愚蠢，但我坐了一个小时试图弄清楚如何解决这个问题。我目前正在制作一个使用 ASP.NET 和 XML 的项目，对于我的项目，我从 Visual Studio 创建了新网站，并试图将我的 XML 文件保存在 App_Data 中。

但是，当我尝试使用代码时：

```
var topic = from t in XElement.Load("App_Data/topics.xml").Elements("topics")
                    select new
                    {
                        topic_id = t.Attribute("id"),
                        topic_subject = t.Element("topicname"),
                        topic_short_body = t.Element("topicshortbody")
                    }; 
```

我收到一个错误：

```
Exception Details: System.IO.DirectoryNotFoundException: Could not find a part of the path 'c:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\App_Data\topics.xml'.

Source Error:

Line 23:     {
Line 24: 
Line 25:         var topic = from t in XElement.Load("App_Data/topics.xml").Elements("topics")
Line 26:                     select new
Line 27:                     {

Source File: d:\college\xml\xmlproject\Default.aspx.cs    Line: 25 
```

我绝对确定我的文件在 App_Data. 所以我的问题是有其他方法来指定路径，或者在我的情况下如何正确地指定路径？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T17:32:23.493

使用 Request.ApplicationPath

```
XElement.Load(Request.ApplicationPath + "/App_Data/topics.xml"); 
```

这将确保您尝试在正确的位置加载文件，默认情况下，该进程在生产服务器上的“c:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\”（调试 Web 服务器）中运行该路径很可能位于 C:\windows\system32\ 或 IIS 进程所在的任何位置。

在 ASP.NET 中处理文件时，始终使您的路径成为绝对路径。

您还可以使用 System.IO.Path.Combine(Request.ApplicationPath, "App_Data/topics.xml") 来确保您的字符串 concat 是“正确的”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T17:37:43.467

因为它可能对其他人有用。我发现的另一个解决方案

```
String xmlpath = Server.MapPath("App_Data/topics.xml"); 
```

# naming-conventions - 什么时候加入名字，什么时候不加入？

> ID：740470
> 
> 赞同：1
> 
> 时间：2009-04-11T17:25:03.573
> 
> 标签：naming-conventions

大多数语言都给出了通过下划线（python、C 等）或驼峰式（Java）分隔名称的不同单词的指南。然而，问题是何时将名称视为单独的。选项包括：

1) 每次出现英语词典中的单独单词时都执行此操作，例如 create_gui()、recv_msg()、createGui()、recvMsg() 等。

2) 使用一些直觉来决定何时执行此操作以及何时不执行此操作，例如 recvmsg() 是可以的，但最好有 create_gui() 。

这种直觉是什么？

这个问题看起来微不足道。但它提出了一个常见的问题，每次出现时每个实例至少需要 5 秒。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-11T17:27:38.733

我总是做你的选择 1，据我所知，所有现代框架都做。

想到的一件事就是将名称放在一起是标准 C 库。但无论如何，它的函数名称通常都很神秘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T16:56:08.943

作为一名 Objective-C 程序员，我可能有偏见，那里的事情往往很清楚，但我永远不会有像`recvMsg`. 它会是`receiveMessage`（并且第一个参数应该是 type `Message`；如果它是一个字符串，那么它应该是`receiveString`或者可能`receiveMessageString`取决于上下文）。当您以这种方式拼写时，我认为问题往往会消失。你永远不会说`receivemessage`。

我唯一缩写的时候是缩写比完整版本更清晰。`createGUI`很好，因为“GUI”（gooey）是我们用英语说的常用方式。`createGraphicalUserInterface`实际上更令人困惑，所以应该避免。

所以对于最初的问题，我认为#1 是最好的，但同时反对不明确的缩写。

One of the most foolish naming choices ever made in Unix was `creat()`, making a nonsense word to save one keystroke. Code is written once and read many times, so it should be biased towards ease of reading rather than writing.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T17:34:25.597

对我来说，这就是我自己，我更喜欢遵循该语言的任何常规，因此 Java 和 C++ 的 camelCase，C 和 SQL 的下划线。

但无论你做什么，在任何源文件或项目中都要保持一致。您的代码的读者会感谢您；看到一个与大多数其他标识符不一致的标识符会让读者停下来问“这个标识符有什么不同吗？这里有什么我应该注意的吗？”

或者换句话说，遵循最小惊喜原则。

编辑：这被降级了，为什么？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-11T17:53:02.400

只需遵循编码风格，通常可以很好地描述这些时刻。

例如：

```
ClassNamesInCamelNotaionWithFirstLetterCapitalized
classMethod()
classMember
CONSTANTS_IN_UPPERCASE_WITH_UNDERSCORE
local_variables_in_lowercase_with_underscores 
```

# c++ - 简单的 PDB 库

> ID：740476
> 
> 赞同：1
> 
> 时间：2009-04-11T17:27:35.847
> 
> 标签：c++, protein-database

我正在寻找一个简单的 C++ 库，用于从 pdb 文件中提取原子坐标。我遇到的大多数人都为我的简单需求做了太多，使它们变得不必要地复杂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T17:50:26.633

自从我使用任何东西来做到这一点已经有好*几年了，我只使用过 python 库。*（我实际上在罗格斯大学的 PDB 做过暑期工作）。

我认为您要使用的是用于 C++ 的 OEChem（那是睁大眼睛……也有一个 python 库）。

我记得的另一个 python 库是 pymmlib（Python Macromolecular Library）。它也可能适用于 C++，但我认为它是专有软件，因此您需要许可证。

我希望我记得更多......希望这会有所帮助。我认为不会有轻量级的解决方案，除非您想自己编写代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-06T15:13:42.387

ESBTL（简单结构生物学模板库）（[http://esbtl.sourceforge.net/](http://esbtl.sourceforge.net/)）是一个相当新的库，可能非常适合您的需求。它本身非常轻量级（仅标题），尽管它确实依赖于 Boost 库，这可能会或不会让您失望。

描述它的论文摘要可以在这里找到：（http://bioinformatics.oxfordjournals.org/content/26/8/1127.abstract）

# ocx - OCX 属性

> ID：740478
> 
> 赞同：0
> 
> 时间：2009-04-11T17:28:31.227
> 
> 标签：ocx

我有一个用于从扫描仪捕获图像的 OCX。我想使用标签在 Internet Explorer 7 中运行它。这个 OSX 没有指南或教程来了解如何使用它。我所需要的只是知道如何处理这个 OCX，这个 OCX 的属性是什么，例如，如果这个 OSX 完成扫描过程，它必须是一个指示完成扫描状态的标志，有没有办法知道这些标志和任何 OCX 的属性。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-29T09:45:42.930

我会在 Visual Studio 中打开 DLL 并检查该类的方法。我认为 javascript 的 properties 属性不适用于 OCX 组件。如果您没有 VS，则可能存在一些免费工具来检查 DLL。

# asp.net - HttpContext.Error 与 HttpContext.Server.GetLastError()

> ID：740482
> 
> 赞同：11
> 
> 时间：2009-04-11T17:30:00.647
> 
> 标签：asp.net

这两种获取当前 asp.net 请求异常的方法之间有什么实际区别吗？

MSDN 说 HttpContent.Error 返回第一个错误，而 GetLastError() 显然是最后一个错误，但我似乎无法分辨出使用上的任何区别。

错误记录的cannon方法是哪一种？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-11T17:36:29.257

它们是一样的：

[`HttpContext.Error`](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.error.aspx)返回第一个错误。

[`HttpContext.Server`](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.server.aspx)返回`HttpServerUtility`该类的一个实例，该实例为 提供了方便的包装器`HttpContext`，包括

[`HttpContext.Server.GetLastError()`](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.getlasterror.aspx)，返回`HttpContext.Error`（使用反射器验证）。

# asp.net - ASP.Net 的首选数据库连接

> ID：740483
> 
> 赞同：2
> 
> 时间：2009-04-11T17:30:31.830
> 
> 标签：asp.net, database

将 ASP.Net 网站连接到数据库的首选（最佳实践）方法是什么？我怀疑它是否像使用 Trusted-Connection 并授予 NT-Authority 帐户访问权限一样简单。

你们都做什么？假设全新安装 SQL Server (2008)，您如何配置对网站数据库的访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T17:41:35.907

我通常将 ASP.NET 应用程序池作为单独的帐户（不是`NT AUTHORITY\NETWORK SERVICE`）运行，并使用 Windows 身份验证来访问 SQL Server。这种方法的优点是不将密码存储在配置文件中。

脚步：

1.  创建一个用户帐户来运行您的 ASP.NET 应用程序。
2.  在 IIS 中创建一个应用程序池并在创建的帐户上运行它。
3.  将应用程序所需的 NTFS 权限分配给帐户。
4.  授予登录 SQL Server 的权限。
5.  为创建的登录分配适当的数据库角色。

这适用于许多应用程序。对于更复杂的安全环境，您可能需要更复杂的策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T18:02:32.907

我曾经使用受信任的连接，但最终觉得有时我最终不得不向用于连接/应用程序池的服务帐户授予太多权限。现在，我使用 SQL Server 帐户并设置应用程序以在 Application_Start 期间加密连接字符串（如果它们尚未加密）。事实上，我会加密任何可能包含用户凭据的部分。我使用 appSetting 来确定加密代码是否运行，因此我不在开发环境中加密我的设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T18:13:59.870

我也使用 SQL Server 帐户，只是发现它更易于执行和排除故障。

# objective-c - sqlite3_bind_xxxx, sqlite3_column_xxxx - 第一个参数

> ID：740502
> 
> 赞同：0
> 
> 时间：2009-04-11T17:38:03.217
> 
> 标签：objective-c, sqlite

我有以下声明：

```
SELECT title, price FROM table WHERE id=? 
```

我应该使用绑定 ID：

```
sqlite3_bind_int(myStmt, 0, current_id); 
```

还是我必须使用：

```
sqlite3_bind_int(myStmt, 1, current_id); 
```

我的问题是 - 第一个绑定参数应该是什么 - 0 或 1？

关于使用 sqlite3_column_xxxx 获取数据的相同问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T17:42:36.683

根据[文档](http://www.sqlite.org/c3ref/bind_blob.html)，“最左边的 SQL 参数的索引为 1。”</p>

但是，对于[`sqlite3_column_xxxx`](http://www.sqlite.org/c3ref/column_blob.html)，“结果集的最左侧列的索引为 0。”</p>

# database - Webapps：存储和搜索用户提交的文本块

> ID：740508
> 
> 赞同：1
> 
> 时间：2009-04-11T17:44:12.500
> 
> 标签：database, google-app-engine, web-applications, full-text-search

## 背景：

我正在构建一个包含用户提交内容的诗歌网站。我的问题的相关用户操作是用户可以：

*   一种。去 fancysitename.com/view 看看到目前为止所有的诗
*   湾。去 fancysitename.com/submit 提交你自己的诗。
*   C。前往 fancysitename.com/apoemid 查看您之前收藏的特定诗歌。
*   d。转到 fancysitename.com/search 输入要在所有诗歌中搜索的单词。

所有诗歌都作为文本字段存储在数据库中，并由诗歌 ID 引用。因此，步骤 c 中的“apoemid”将是元组的主键，我将在从 url 获取键后提取文本。

## 问题：

*   1.  这些诗只存在于数据库中。我的 webapp 实际上是 4 个 html 文件。这种方法会影响我的搜索引擎排名吗？
    2.  有没有一种更有效的方法来执行“d”而不是在数据库上执行 Select * 并手动解析服务器上的文本？每首诗最多 10 行长，所以我想使用像卢塞恩这样的全文搜索引擎可能会有点矫枉过正。

## 警告

我现在在谷歌应用引擎上运行它，所以我的数据库自定义选项非常有限。所以虽然我当然有兴趣了解理想的方法，但这是一个宠物项目，所以我的预算有限:(

谢谢！

编辑：显然我早上 7 点用谷歌搜索的不是很好。我已经在[这里](http://www.kimchy.org/searchable-google-appengine-with-compass/)找到了问题 2 的解决方案，所以请忽略问题 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T05:56:40.990

AppEngine 目前不支持全文索引，但他们确实有一个总比没有 SearchableModel 好。

SearchableModel 的一些细节可以在这里找到：

[http://groups.google.com/group/google-appengine/browse_thread/thread/f64eacbd31629668/8dac5499bd58a6b7?lnk=gst&q=searchablemodel](http://groups.google.com/group/google-appengine/browse_thread/thread/f64eacbd31629668/8dac5499bd58a6b7?lnk=gst&q=searchablemodel)

关于搜索引擎排名，是的，将所有诗歌都保存在数据存储中会影响您的排名。这通常通过使用站点地图来克服。这是一篇关于 StackOverflow 如何使用站点地图来帮助其搜索排名的文章。

[http://www.codinghorror.com/blog/archives/001174.html](http://www.codinghorror.com/blog/archives/001174.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T18:01:31.273

在大多数数据库引擎中，您都可以完成这种搜索。例如，MySQL 确实有全文搜索。我不确定应用引擎是如何工作的，但您始终可以使用存储过程进行此搜索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T11:33:06.250

您存储数据的位置不会影响您网站的排名，只会影响您提供数据的方式（在哪些 URL 上等）。任意搜索蜘蛛绝对没有办法告诉您存储数据的位置，也没有理由关心它。

无论文本的长度如何，如果要在字符串中进行搜索，都需要进行全文搜索。正如 Sam 指出的那样，SearchableModel 应该可以正常工作。

# objective-c - 确保方法只由主线程执行

> ID：740510
> 
> 赞同：2
> 
> 时间：2009-04-11T17:46:09.623
> 
> 标签：objective-c, multithreading

我有一个objective-c 类，我只想从主线程调用它的方法。

我可以通过向每个选择器添加类似的内容来实现这一点：

```
- (void) exampleSelector: (id) param {
    if (![NSThread isMainThread]) {
        [self peformSelectorOnMainThread:@selector(exampleSelector:) withObject:param waitUntilDone:YES];
        return;
    }
    // Do stuff it's not safe to do outside the main thread
} 
```

然而，将它添加到每个选择器似乎有点痛苦。有什么方法可以自动拦截对此类对象的所有调用，检查它所在的线程，如果它不是主线程，则使用 performSelectorOnMainThread？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T19:23:31.620

唔。我不确定是否可以这样做；我想不出办法。我倾向于做的是用代理替换对象。代理将负责将调用转发到正确线程中的对象。

```
@interface Forwarder : NSObject
{
    id recipient;
}

- (Forwarder *)initWithRecipient:(id)inRecipient;

@end

@implementation Forwarder

- (Forwarder *)initWithRecipient:(id)inRecipient {
    [inRecipient retain];
    recipient = inRecipient;
    return self;
}

- (void)dealloc {
    [recipient release];
    [super dealloc];
}

- (void)forwardInvocation:(NSInvocation *)anInvocation {
    if ([recipient respondsToSelector: [anInvocation selector]]) {
        if (![NSThread isMainThread]) {
            // Note: only works with methods that take one argument. Should add
            // error handling for other methods
            id argument;
            [invocation getArgument: &argument atIndex: 2];
            [recipient performSelectorOnMainThread: [anInvocation selector] withObject: argument waitUntilDone: YES];
        } else {
            [anInvocation invokeWithTarget:recipient];
        }
    } else {
        [super forwardInvocation:anInvocation];
    }
}

- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector {
    if ([recipient respondsToSelector: aSelector])
        return [recipient methodSignatureForSelector: aSelector];
    else
        return [super methodSignatureForSelector: aSelector];
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T09:13:17.033

也许相反，您应该限制方法的调用者不要从任意线程调用它。如果主线程在等待线程 B 的结果时被阻塞，并且线程 B 调用了您示例中的方法，那么您将遇到死锁。

# asp.net - 我如何从 javascript 调用 asp.net regExp 验证器？

> ID：740517
> 
> 赞同：0
> 
> 时间：2009-04-11T17:50:18.380
> 
> 标签：asp.net, validation, asp.net-2.0

我正在开发 asp.net 2.0。我正在使用 asp:RegularExpressionValidator 来检查有效的 url。如何从 javascript 函数调用检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T18:04:43.307

验证器将在您提交表单时第一次触发，然后在对文本框文本进行任何后续更改时再次触发。

您想在其他时间验证吗？您可以通过调用验证 JavaScript 中的所有控件

```
Page_ClientValidate() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T18:16:22.717

假设您已将属性 EnableClientScript 设置为 true，则 javascript 函数将自动触发。

# iphone - 如何在 iPhone 上发布共享加速器实例？

> ID：740519
> 
> 赞同：1
> 
> 时间：2009-04-11T17:50:30.487
> 
> 标签：iphone, memory-management, accelerometer

我创建了一个加速度计变量：

```
UIAccelerometer   *objAccelerometer; 
```

我与 sharedAccelerometer 实例相关联：

```
objAccelerometer = [UIAccelerometer sharedAccelerometer];
objAccelerometer.delegate = self; 
```

当我释放这个视图（加载不同的视图）时，加速度计实例会导致程序死掉。（如果我将其注释掉，我可以毫无问题地在视图之间切换）。

我在使用 NSTimer 时遇到了类似的问题，但是一旦我打电话：

```
[myTimer invalidate]; 
```

（在发布和切换视图之前）一切正常。

我应该如何正确释放委托或取消分配或释放加速度计？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T18:03:40.877

你不释放共享的加速度计——你从来没有保留它（也不应该）——它是一个单例。

加速度计有对*您的*对象的引用。为了释放它，只需将它的委托属性设置为 nil（因为它是一个属性，它将释放它对您的对象的引用）。

# javascript - 获取 Webkit executeSql 事务以返回值

> ID：740523
> 
> 赞同：6
> 
> 时间：2009-04-11T17:53:43.473
> 
> 标签：javascript, sqlite, webkit

如何让以下 JavaScript 返回`row`以便我可以在事务之外访问它？Apple 的所有示例代码似乎都在事务中将 HTML 写入浏览器，而不是将数据传回调用函数。

沿着：

```
function getData() {
  db.transaction(function(tx) {
    tx.executeSql("SELECT id FROM table LIMIT 1", [], function(tx, result) {
      row = result.rows.item(0);
    }, function(tx, error) {
    });
  });

  return row;
} 
```

这甚至可能吗？Webkit存储API可以设置为同步而不是异步执行吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-11T18:38:46.533

我认为您想在这里创建一个闭包，因为在您可以访问它们之前，值正在被垃圾收集/从作用域链中移走。传递`row`给闭包以供以后访问，或者传递给可以在该值仍在作用域内时处理该值的其他函数。

更多信息：[使用闭包](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Working_with_Closures)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T14:04:10.637

我意识到这是一个非常古老的问题，但我在搜索如何处理 JavaScript 异步 SQLite 调用时发现了它。这个问题和我的一样，我找到了一个更好的答案（扩展所选答案，使用闭包）

我的 getData 函数版本如下：

```
function get_option (option, get_option_callback){
    if (db === null){
       open_database();
    }
    db.transaction(function (tx) {
        tx.executeSql("SELECT rowid,* FROM app_settings WHERE option = ? ", [option],            
        function(tx, result){
            item = result.rows.item(0);
            get_option_callback(item.value);
            return;
         }
       }, sql_err);
   });
} 
```

然后调用我将使用的方法：

```
get_option("option name", function(val){
 // set the html element value here with val
 // or do whatever
 $('input[name="some_input"]').val(val);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T03:37:40.363

[我在http://wecreategames.com/blog/?p=219](http://wecreategames.com/blog/?p=219)写了一个关于这个和其他 SQL 事务的例子

您必须以异步方式执行 WebKit executeSql 调用。为了解决这个问题，你应该有你的：

```
function(tx, error) {
} 
```

执行某些操作来更新您的数据。就像是：

```
function(tx, results) {
   console.log("Results returned: "+results.rows.length);
   for (var i=0; i<results.rows.length; i++) {
      var row = results.rows.item(i);
      document.getElementById('latestUpdated').innerHTML = row;
   } 
} 
```

请注意，函数中的第二个变量不是错误，而是结果。

我放入了一个 for 循环以显示可能返回多个结果（但可能不是使用该 SQL 语句）——因此希望您能看到它的实用性。

# database - 数据库推荐

> ID：740525
> 
> 赞同：2
> 
> 时间：2009-04-11T17:54:23.287
> 
> 标签：database, sqlite

我正在编写一个 CAD（计算机辅助设计）应用程序。我需要用这个产品运送一个 3d 对象库。这些是仅由 3d 坐标组成的简单对象，并且不会超过大约 300 个。

我正在考虑为此目的使用关系数据库。但考虑到我的简单需求，我不想要任何复杂的东西。到目前为止，我倾向于 SQLite。它很小，在客户端进程中运行，据称速度很快。此外，我是一个穷人，它是免费的。

但在我承诺使用 SQLite 之前，我只想问问你的意见，考虑到我的要求，这是否是一个好的选择。在做出决定之前，我还应该尝试任何等效的替代方案吗？

**编辑**：

我之前没有提到我将发布的上述 CAD 对象不会是不可变的。我希望用户编辑它们（更改尺寸、颜色等）并保存回库。我还希望用户添加他们自己新创建的对象。请在您的回答中考虑这一点。

（感谢到目前为止的答案。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T17:58:39.267

真正要考虑的是你的程序对数据做了什么。关系数据库旨在处理数据集之间的复杂关系。但是，它们并非旨在执行复杂的计算。

此外，数据量和它的相对简单性向我表明，您可以简单地使用平面文件来存储坐标并在需要时将它们读入内存。通过这种方式，您可以设计数据结构，以更准确地反映您将如何使用这些数据，而不是如何存储它。

许多语言提供了一种将数据结构写入文件并再次将其读回的机制，称为[序列化](http://en.wikipedia.org/wiki/Serialization)。Python 的[pickle](http://docs.python.org/library/pickle.html)就是这样一个库，我相信您可以找到一个适合您使用的任何语言的库。基本上，只需按照程序使用它们的方式设计类或数据结构，并使用这些序列化库之一来填充该类或数据结构的实例。

**编辑：**结构可变的要求对我的回答并没有太大影响——我仍然认为序列化和反序列化是解决这个问题的最佳方法。用户需要能够修改和保存结构这一事实需要进行一些计划以确保文件完全正确地更新，但最终我认为你最终会花费更少的时间和精力来使用这种方法而不是尝试marshall SQLite 或其他嵌入式数据库为您完成这项工作。

数据库更好的唯一情况是，如果您有一个系统，其中多个用户正在与中央数据存储库进行交互和更新，并且对于这种情况，您将查看数据库服务器，如 MySQL、PostgreSQL 或SQL Server 兼具速度和并发性。

您还评论说您将使用 C# 作为您的语言。.NET[内置了](http://en.wikipedia.org/wiki/Serialization#.NET_Framework)对序列化的支持，所以你应该很[高兴](https://stackoverflow.com/questions/tagged/serialization+C%23)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T18:04:50.313

我建议您考虑使用[H2](http://www.h2database.com/html/performance.html)，它非常轻巧且快速。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T18:18:08.517

当您说您将拥有一个包含 300 个 3D 对象的库时，我假设您指的是代码的对象，而不是用户将创建的模型。

我读过[对象数据库](http://www.odbms.org/)非常适合帮助解决 CAD 问题，因为它们非常适合追踪复杂模型所特有的长参考链。也许像[db4o](http://www.db4o.com/?src=ODBMS-sidebar)这样的东西在您的上下文中会很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T17:57:36.787

您要运送多少件物品？您可以在 xml 文件中定义每个对象及其坐标吗？所以基本上为每个对象使用一个不同的 xml 文件？您可以将这些 xml 文件放在一个目录中。这可以是一个简单的结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T19:41:33.060

对于特定要求，即提供与应用程序一起提供的对象库，数据库系统可能不是正确的答案。

首先想到的是您可能希望文件是可更新的，即您需要能够在不更改应用程序其余部分的情况下将文件拖放到应用程序中并进行更新。

第二件事是您发送的数据是不可变的 - 为此目的，您不需要关系数据库的功能，只需能够以足够的效率访问特定模型。

为简单起见（有点），一个 XML 文件会做得很好，因为你有良好的结构。以此为基础，您可以选择对其进行压缩、加密、将其作为资源嵌入到程序集中（如果在 .NET 中播放）等等。

*显然，如果 SQLite 将其数据存储在每个数据库*的单个文件中，并且如果您有其他原因需要存储系统中的 db 功能，那么可以，但我想考虑 db 对应用程序的实用性整体第一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T18:29:21.657

我不会使用 SQL 数据库。您可以使用 XML 文件轻松描述每个 3D 对象。将此文件打包在一个目录中并打包（zip）所有。如果您需要轻松访问对象的元数据，您可以生成一个索引文件（仅带有名称或描述），因此并非所有对象都必须解析并加载到内存中（如果您有类似库管理器的东西，那就太好了）

有可用的快速简单的 SAX 解析器，您可以轻松编写 XML 编写器（或找到一些可用于此目的的免费代码）。

今天有许多类似的应用程序使用 XML。它易于解析/编写，易于阅读，压缩后不需要太多空间。

我使用过 Sqlite，它易于使用且易于与自己的对象集成。但我更喜欢像 Sqlite 这样的 SQL 数据库，用于需要一些好的搜索工具来处理大量数据记录的应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-11T20:27:45.040

SQL Server CE 是免费的，占用空间小（不运行服务），并且与 SQL Server 兼容

# flash - Flash/Actionscript 问题：MouseEvents 可以同时针对多个事物吗？

> ID：740526
> 
> 赞同：1
> 
> 时间：2009-04-11T17:54:34.707
> 
> 标签：flash, actionscript

我有一个覆盖整个舞台的特殊画布类，下面的图层上有一堆 Sprite 热点。如果我将热点放在与画布相同的图层上，如果我的鼠标位于其中一个热点内，画布不会注册 MOUSE_DOWN 事件，因为热点是针对的。但是，如果我将热点保留在下层，则画布会处理所有鼠标事件。有什么方法可以让 MouseEvents 的目标不止一件事，以便画布和热点都响应 MouseEvents？（画布是一个位图绘图类，热点应该在光标触摸或点击它们时触发。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T18:01:27.263

ActionScript 具有事件冒泡和事件捕获。这意味着您可以侦听从包含元素或子元素开始的事件。您只需要创建正确类型的事件侦听器。捕获开始在父元素处捕获事件，因为它沿着子元素链向下移动，直到到达触发事件的元素。事件冒泡开始监听子事件并向上移动到父事件。

的第三个参数`addEventListener`useCapture 确定您是要冒泡还是捕获。

听起来你想要事件冒泡，所以你想将 useCapture 设置为 false。事件侦听器将在子级和父级上触发。

[事件捕获和冒泡](http://www.adobe.com/devnet/actionscript/articles/event_handling_as3_03.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T20:07:40.167

apphacker 做对了。

还有两件事您可能会感兴趣：

[mouseChildren](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/DisplayObjectContainer.html#mouseChildren)属性和getObjectsUnderPoint [()](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/DisplayObjectContainer.html#getObjectsUnderPoint())方法

祝你好运

# sql-server - 在 SQL Server 2008 上使用 HQL 获取标记和标记计数

> ID：740531
> 
> 赞同：1
> 
> 时间：2009-04-11T17:57:09.613
> 
> 标签：sql-server, nhibernate, sql-server-2008, hql

我正在使用 SQL Server 2008 上的 NHibernate 在特定实体上实现标记。我现在拥有的结构是简化的，如下所示：

```
public class Entity {
    public Guid Id { get; set; }
}

public class Tag {
    public Guid Id { get; set; }
    public string Name { get; set; }
}

public class TagAssoc {
    public Tag LinkedTag { get; set; }
    public Entity LinkedEntity { get; set; }
    //User
    //Other properties
} 
```

没什么特别的：一个实体可以用同一个标签多次标记，因为该关联还包括有关标记该实体的用户和其他内容的数据。

现在，我正在尝试获取特定实体的标签列表，以及标签被应用的次数。在 HQL 中是这样的：

```
select tass.LinkedTag, count(tass.LinkedTag)
from TagAssoc as tass left outer join tass.LinkedTag as t
group by tass.LinkedTag 
```

这会生成以下 SQL 查询：

```
select tag1_.Id as Id0_, tag1_.Name as Name0_, tag1_.Id as x0_0_, count_big(tag1_.Id) as x1_0_
from BandTags tagassoc0_ left outer join Tags tag1_ on tagassoc0_.TagId=tag1_.Id
group by tag1_.Id 
```

这看起来是正确的，但在 SQL Server 2008 中不起作用，因为 Tag 的 Name 属性不包含在“group by”子句中。为了使其工作，我必须手动调整 group by 子句以包含 Tag 类的所有属性：

```
select tass.LinkedTag, count(tass.LinkedTag)
from TagAssoc as tass left outer join tass.LinkedTag as t
group by tass.LinkedTag.Id, tass.LinkedTag.Name 
```

但这取决于 Tag 类的属性，因此每次更改类时都必须更新。还有其他方法可以使第一个 HQL 查询工作吗？也许某些 HQL 语法会自动使“分组依据”属性显式？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T15:26:41.927

似乎没有任何方法可以让 NHibernate 按属性自动确定组。该文档甚至似乎在他们为聚合函数提供的示例 HQL 中暗示了这一点：

> select cat, count( elements(cat.Kittens) ) from Eg.Cat cat group by cat.Id, cat.Weight, ...

他们还明确指定了 Cat 的属性。

如果您想动态构建一个每次类更改时都不需要更新的查询，我认为您会遇到反射和 Criteria 接口。

```
ProjectionList list = Projections.ProjectionList();
foreach (PropertyInfo prop in typeof(Tag).GetProperties())
{
    list.Add(Projections.GroupProperty(prop.Name));
}
list.Add(Projections.Property("LinkedTag"));
list.Add(Projections.Count("LinkedTag"));

session.CreateCriteria(typeof(TagAssoc)).SetProjection(list).List(); 
```

我还没有尝试过，所以它可能有效，也可能无效，或者可能需要一些调整，但你明白了。您可能会认为 Tag 类不会发生足够的变化而不值得麻烦。

# javascript - 使用 Javascript 正则表达式检查有效的 url

> ID：740537
> 
> 赞同：4
> 
> 时间：2009-04-11T18:01:15.860
> 
> 标签：javascript, regex, validation, url

为了检查 javascript 中的有效 url，我应该使用什么表达式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-11T18:11:00.530

看看这个基于 RFC 1738 自动生成[的 URL 的完整正则表达式。](http://internet.ls-la.net/folklore/url-regexpr.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T18:07:34.377

不取决于您希望支票有多复杂。

这是一个超级复杂的：

```
^(?#Protocol)(?:(?:ht|f)tp(?:s?)\:\/\/|~/|/)?(?#Username:Password)(?:\w+:\w+@)?(?#Subdomains)(?:(?:[-\w]+\.)+(?#TopLevel Domains)(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum|travel|[a-z]{2}))(?#Port)(?::[\d]{1,5})?(?#Directories)(?:(?:(?:/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|/)+|\?|#)?(?#Query)(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?#Anchor)(?:#(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)?$ 
```

实际上，正则表达式在平台之间是安静可移植的。google 搜索中的大多数示例都可以在 Javascript 中使用，尽管可能会进行一些“风味”修改。

# web-services - 使用 Netbeans 的 Web 服务

> ID：740542
> 
> 赞同：0
> 
> 时间：2009-04-11T18:02:38.930
> 
> 标签：web-services, deployment, soap, netbeans

在使用 netbeans 完成 Web 服务并对其进行测试之后。我应该将什么上传到服务器以便我可以使用它？我一直在浏览教程，但没有（我发现的那些）说要上传什么。它们只是在您部署 Web 服务时完成 =/。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T18:19:25.253

对，您将其打包为 WAR 文件并将其部署到应用服务器。WAR 文件就是您所需要的。

您如何部署取决于您的情况和您的应用服务器。如果您使用的是 Tomcat，您可以将 WAR 放在 /webapps 目录中，也可以使用管理控制台进行部署。

如果您使用托管服务，则必须询问他们如何操作。

# file-upload - 数据列表编辑模式下的 FindControl

> ID：740544
> 
> 赞同：1
> 
> 时间：2009-04-11T18:03:44.183
> 
> 标签：file-upload, datalist, findcontrol, edititemtemplate

作为一个新的 .net/C# web 初学者，当我尝试使用 FindControl 时，我总是被绊倒。Blam-flat 在我的脸上。这是我当前的 FindControl 问题：

我有一个 .aspx 页面和表单，然后是 ajax updatePanel，里面有我的 DataList (DataList1)，它有一个 EditItemTemplate:：它具有以下内容：

```
<EditItemTemplate>
<asp:Label ID="thumbnailUploadLabel" runat="server" text="Upload a new thumbnail image:"/><br />
<asp:FileUpload ID="thumbnailImageUpload" runat="server" />
<asp:Button ID="thunbnailImageUploadButton" runat="server" Text="Upload Now" OnClick="thumbnailUpload"/><br />
</EditItemTemplate> 
```

在我后面的 C# 代码中，我有 fileUpload 对象的 OnClick 代码：

```
 protected void thumbnailUpload(object s, EventArgs e)

    {

    if (thumbnailImageUpload.HasFile)

      {

      //get name of the file & upload

          string imageName = thumbnailImageUpload.FileName;

          thumbnailImageUpload.SaveAs(MapPath("../../images/merch_sm/" + imageName));

          //let'em know that it worked (or didn't)
          thumbnailUploadLabel.Text = "Image " + imageName + "has been uploaded.";
         }
         else
         {
         thumbnailUploadLabel.Text = "Please choose a thumbnail image to upload.";
     } 
```

因此，我当然会为 FileUpload 和标签获得“对象引用未设置为对象的实例”。

在 OnClick 事件中处理它们之前，找到这些控件的正确语法是什么？

我使用 FindControl 的唯一方法是：

标签 thumbnailUploadLabel = DataList1.FindControl("thumbnailUploadLabel") 作为标签；

但这当然会引发“对象引用未设置为对象的实例”错误。很感谢任何形式的帮助。

（我还看到了应该使 FindControl 更容易使用的“递归”代码。哈！我对 C# 非常熟悉，以至于我什至不知道如何将它们合并到我的项目中。）

感谢大家看这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-14T06:22:13.713

我知道这已经很晚了，但我一直在寻找要回答的问题……您现在一定已经想通了，但仍然

如果您在代码中添加这些行

```
protected void thumbnailUpload(object sender, EventArgs e)
    {
        FileUpload thumbnailImageUpload =(FileUpload)DataList1.Items[DataList1.EditItemIndex].FindControl("thumbnailImageUpload");
        Label thumbnailUploadLabel = (Label)DataList1.Items[DataList1.EditItemIndex].FindControl("thumbnailUploadLabel");
        if (thumbnailImageUpload.HasFile)
        {

           //Your code here

        }
        else
        {
            thumbnailUploadLabel.Text = "Please choose a thumbnail image to upload.";
        }
    } 
```

这将为您正在编辑的行找到适当的控件...

还要将您的 Datalist 排除在更新面板之外，因为更新面板与 FileUpload 不兼容。如果你这样做，代码将运行，但它总是将**thumbnailImageUpload.HasFile**显示为**False。**

# c# - LockBits 性能关键代码

> ID：740555
> 
> 赞同：3
> 
> 时间：2009-04-11T18:10:31.220
> 
> 标签：c#, performance, image-processing, image-manipulation, unsafe

我有一个方法需要尽可能快，它使用不安全的内存指针，这是我第一次尝试这种类型的编码，所以我知道它可能会更快。

```
 /// <summary>
    /// Copies bitmapdata from one bitmap to another at a specified point on the output bitmapdata
    /// </summary>
    /// <param name="sourcebtmpdata">The sourcebitmap must be smaller that the destbitmap</param>
    /// <param name="destbtmpdata"></param>
    /// <param name="point">The point on the destination bitmap to draw at</param>
    private static unsafe void CopyBitmapToDest(BitmapData sourcebtmpdata, BitmapData destbtmpdata, Point point)
    {
        // calculate total number of rows to draw.
        var totalRow = Math.Min(
            destbtmpdata.Height - point.Y,
            sourcebtmpdata.Height);

        //loop through each row on the source bitmap and get mem pointers
        //to the source bitmap and dest bitmap
        for (int i = 0; i < totalRow; i++)
        {
            int destRow = point.Y + i;

            //get the pointer to the start of the current pixel "row" on the output image
            byte* destRowPtr = (byte*)destbtmpdata.Scan0 + (destRow * destbtmpdata.Stride);
            //get the pointer to the start of the FIRST pixel row on the source image
            byte* srcRowPtr = (byte*)sourcebtmpdata.Scan0 + (i * sourcebtmpdata.Stride);

            int pointX = point.X;
            //the rowSize is pre-computed before the loop to improve performance
            int rowSize = Math.Min(destbtmpdata.Width - pointX, sourcebtmpdata.Width);
            //for each row each set each pixel
            for (int j = 0; j < rowSize; j++)
            {
                int firstBlueByte = ((pointX + j)*3);

                int srcByte = j *3;
                destRowPtr[(firstBlueByte)] = srcRowPtr[srcByte];
                destRowPtr[(firstBlueByte) + 1] = srcRowPtr[srcByte + 1];
                destRowPtr[(firstBlueByte) + 2] = srcRowPtr[srcByte + 2];
            }

        }
    } 
```

那么有什么办法可以让这更快吗？暂时忽略待办事项，等我有一些基线性能测量后，我会修复它。

**更新：**对不起，应该提到我使用它而不是 Graphics.DrawImage 的原因是因为我实现了多线程，因此我不能使用 DrawImage。

**更新 2：**我仍然对性能不满意，而且我敢肯定还有更多毫秒的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T15:50:25.103

代码有一些根本性的错误，我不敢相信我直到现在才注意到。

```
byte* destRowPtr = (byte*)destbtmpdata.Scan0 + (destRow * destbtmpdata.Stride); 
```

这将获得一个指向目标行的指针，但它没有获得它正在复制到的列，在旧代码中是在 rowSize 循环内完成的。现在看起来像：

```
byte* destRowPtr = (byte*)destbtmpdata.Scan0 + (destRow * destbtmpdata.Stride) + pointX * 3; 
```

所以现在我们有了目标数据的正确指针。现在我们可以摆脱那个 for 循环了。使用来自[Vilx-](https://stackoverflow.com/questions/740555/lockbits-performance-critical-code/857480#857480)和[Rob](https://stackoverflow.com/questions/740555/lockbits-performance-critical-code/857932#857932)的建议，代码现在看起来像：

```
 private static unsafe void CopyBitmapToDestSuperFast(BitmapData sourcebtmpdata, BitmapData destbtmpdata, Point point)
    {
        //calculate total number of rows to copy.
        //using ternary operator instead of Math.Min, few ms faster
        int totalRows = (destbtmpdata.Height - point.Y < sourcebtmpdata.Height) ? destbtmpdata.Height - point.Y : sourcebtmpdata.Height;
        //calculate the width of the image to draw, this cuts off the image
        //if it goes past the width of the destination image
        int rowWidth = (destbtmpdata.Width - point.X < sourcebtmpdata.Width) ? destbtmpdata.Width - point.X : sourcebtmpdata.Width;

        //loop through each row on the source bitmap and get mem pointers
        //to the source bitmap and dest bitmap
        for (int i = 0; i < totalRows; i++)
        {
            int destRow = point.Y + i;

            //get the pointer to the start of the current pixel "row" and column on the output image
            byte* destRowPtr = (byte*)destbtmpdata.Scan0 + (destRow * destbtmpdata.Stride) + point.X * 3;

            //get the pointer to the start of the FIRST pixel row on the source image
            byte* srcRowPtr = (byte*)sourcebtmpdata.Scan0 + (i * sourcebtmpdata.Stride);

            //RtlMoveMemory function
            CopyMemory(new IntPtr(destRowPtr), new IntPtr(srcRowPtr), (uint)rowWidth * 3);

        }
    } 
```

将 500x500 图像复制到网格中的 5000x5000 图像 50 次耗时：00:00:07.9948993 秒。现在有了上面的更改，它需要 00:00:01.8714263 秒。好多了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T18:13:56.360

嗯...我不确定 .NET 位图数据格式是否与 Windows 的 GDI32 功能*完全*兼容...

但我学习的前几个 Win32 API 之一是 BitBlt：

```
BOOL BitBlt(
  HDC hdcDest, 
  int nXDest, 
  int nYDest, 
  int nWidth, 
  int nHeight, 
  HDC hdcSrc, 
  int nXSrc, 
  int nYSrc, 
  DWORD dwRop
); 
```

如果我没记错的话，这是复制数据的**最快方法。**

这是用于 C# 的 BitBlt PInvoke 签名和相关使用信息，对于任何使用 C# 中的高性能图形的人来说都是一本很好的读物：

*   [http://www.pinvoke.net/default.aspx/gdi32/BitBlt.html](http://www.pinvoke.net/default.aspx/gdi32/BitBlt.html)

绝对值得一看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T22:51:21.263

内部循环是您想要集中大量时间的地方（但是，请进行测量以确保）

```
for  (int j = 0; j < sourcebtmpdata.Width; j++)
{
    destRowPtr[(point.X + j) * 3] = srcRowPtr[j * 3];
    destRowPtr[((point.X + j) * 3) + 1] = srcRowPtr[(j * 3) + 1];
    destRowPtr[((point.X + j) * 3) + 2] = srcRowPtr[(j * 3) + 2];
} 
```

1.  摆脱乘法和数组索引（这是引擎盖下的乘法）并替换为您正在递增的指针。

2.  与 +1、+2 一样，增加一个指针。

3.  可能您的编译器不会继续计算 point.X（检查），而是创建一个局部变量以防万一。它不会在单次迭代中执行此操作，但可能会在每次迭代中执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T18:16:01.460

你可能想看看[Eigen](http://eigen.tuxfamily.org)。

它是一个 C++ 模板库，它使用*SSE（2 和更高版本）和 AltiVec 指令集，并优雅地回退到非矢量化代码*。

> 快速地。（见基准）。
> 表达式模板允许在适当的时候智能地删除临时变量并启用惰性求值——Eigen 会自动处理这一点并在大多数情况下也处理别名。
> 对 SSE（2 和更高版本）和 AltiVec 指令集执行显式矢量化，并优雅地回退到非矢量化代码。表达式模板允许对整个表达式全局执行这些优化。
> 使用固定大小的对象，可以避免动态内存分配，并且在有意义时展开循环。
> 对于大型矩阵，需要特别注意缓存友好性。

您可以在 C++ 中实现您的函数，然后从 C# 调用它

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T21:57:29.010

您并不总是需要使用指针来获得良好的速度。这应该在原始文件的几毫秒内：

```
 private static void CopyBitmapToDest(BitmapData sourcebtmpdata, BitmapData destbtmpdata, Point point)
    {
        byte[] src = new byte[sourcebtmpdata.Height * sourcebtmpdata.Width * 3];
        int maximum = src.Length;
        byte[] dest = new byte[maximum];
        Marshal.Copy(sourcebtmpdata.Scan0, src, 0, src.Length);
        int pointX = point.X * 3;
        int copyLength = destbtmpdata.Width*3 - pointX;
        int k = pointX + point.Y * sourcebtmpdata.Stride;
        int rowWidth = sourcebtmpdata.Stride;
        while (k<maximum)
        {
            Array.Copy(src,k,dest,k,copyLength);
            k += rowWidth;

        }
        Marshal.Copy(dest, 0, destbtmpdata.Scan0, dest.Length);
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T11:41:49.627

不幸的是，我没有时间编写完整的解决方案，但我会考虑使用平台**RtlMoveMemory()**函数来整体移动行，而不是逐字节移动。那应该快很多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-11T18:54:26.263

我认为可以提前计算步幅大小和行数限制。

我预先计算了所有乘法，得到以下代码：

```
private static unsafe void CopyBitmapToDest(BitmapData sourcebtmpdata, BitmapData destbtmpdata, Point point)
{
    //TODO: It is expected that the bitmap PixelFormat is Format24bppRgb but this could change in the future
    const int pixelSize = 3;

    // calculate total number of rows to draw.
    var totalRow = Math.Min(
        destbtmpdata.Height - point.Y,
        sourcebtmpdata.Height);

    var rowSize = Math.Min(
        (destbtmpdata.Width - point.X) * pixelSize,
        sourcebtmpdata.Width * pixelSize);

    // starting point of copy operation
    byte* srcPtr = (byte*)sourcebtmpdata.Scan0;
    byte* destPtr = (byte*)destbtmpdata.Scan0 + point.Y * destbtmpdata.Stride;

    // loop through each row
    for (int i = 0; i < totalRow; i++) {

        // draw the entire row
        for (int j = 0; j < rowSize; j++)
            destPtr[point.X + j] = srcPtr[j];

        // advance each pointer by 1 row
        destPtr += destbtmpdata.Stride;
        srcPtr += sourcebtmpdata.Stride;
    }

} 
```

还没有彻底测试它，但你应该能够让它工作。

我已经从循环中删除了乘法运算（改为预先计算）并删除了大多数分支，因此它应该会更快一些。

让我知道这是否有帮助:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-09T23:03:20.940

我正在查看您的 C# 代码，但我无法识别任何熟悉的内容。这一切看起来都像是一大堆 C++。顺便说一句，看起来 DirectX/XNA 需要成为你的新朋友。只是我的2美分。不要杀死信使。

如果你必须依赖 CPU 来做到这一点：我自己做了一些 24 位布局优化，我可以告诉你，内存访问速度应该是你的瓶颈。使用 SSE3 指令进行最快的字节访问。这意味着 C++ 和嵌入式汇编语言。在纯 C 中，您在大多数机器上会慢 30%。

请记住，现代 GPU 在此类操作中比 CPU 快得多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-11T14:44:44.050

我不确定这是否会带来额外的性能，但我在 Reflector 中看到了很多这种模式。

所以：

```
int srcByte = j *3;
destRowPtr[(firstBlueByte)] = srcRowPtr[srcByte];
destRowPtr[(firstBlueByte) + 1] = srcRowPtr[srcByte + 1];
destRowPtr[(firstBlueByte) + 2] = srcRowPtr[srcByte + 2]; 
```

变成：

```
*destRowPtr++ = *srcRowPtr++;
*destRowPtr++ = *srcRowPtr++;
*destRowPtr++ = *srcRowPtr++; 
```

可能需要更多的牙套。

如果宽度是固定的，您可以将整行展开成几百行。:)

**更新**

您也可以尝试使用更大的类型，例如 Int32 或 Int64 以获得更好的性能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-13T13:27:16.583

好吧，这将非常接近你可以从算法中得到多少毫秒的线，但是去掉对[Math.Min](http://msdn.microsoft.com/en-us/library/h5sbzt2y.aspx)的调用并用三元运算符代替它。

一般来说，调用库比自己做一些事情要花更长的时间，我做了一个简单的测试驱动程序来为[Math.Min 确认这一点。](http://msdn.microsoft.com/en-us/library/h5sbzt2y.aspx)

```
using System;
using System.Diagnostics;

namespace TestDriver
{
    class Program
    {
        static void Main(string[] args)
        {
            // Start the stopwatch
            if (Stopwatch.IsHighResolution)
            { Console.WriteLine("Using high resolution timer"); }
            else
            { Console.WriteLine("High resolution timer unavailable"); }
            // Test Math.Min for 10000 iterations
            Stopwatch sw = Stopwatch.StartNew();
            for (int ndx = 0; ndx < 10000; ndx++)
            {
                int result = Math.Min(ndx, 5000);
            }
            Console.WriteLine(sw.Elapsed.TotalMilliseconds.ToString("0.0000"));
            // Test trinary operator for 10000 iterations
            sw = Stopwatch.StartNew();
            for (int ndx = 0; ndx < 10000; ndx++)
            {
                int result = (ndx < 5000) ? ndx : 5000;
            }
            Console.WriteLine(sw.Elapsed.TotalMilliseconds.ToString("0.0000"));
            Console.ReadKey();
        }
    }
} 
```

在我的计算机上运行上述结果时，Intel T2400 @1.83GHz。另外，请注意，结果存在一些差异，但通常 trinay 算子快约 0.01 ms。这并不多，但在足够大的数据集上它会加起来。

> 使用高分辨率定时器
> 0.0539
> 0.0402

# ios - 我在哪里以及如何注册对象以接收通知？

> ID：740562
> 
> 赞同：5
> 
> 时间：2009-04-11T18:15:14.233
> 
> 标签：ios, cocoa-touch, nsnotifications

例如，当内存不足时，系统会发送`UIApplicationDidReceiveMemoryWarningNotification`通知。这就是苹果当时在其文档中所说的全部内容。但是这个通知是从哪里来的，它是发送到哪个方法的呢？或者我在哪里以及如何注册我收到的通知？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-11T18:36:41.967

从您希望接收通知的类的初始化代码中进行以下方法调用：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(handleMemoryWarning:) name: UIApplicationDidReceiveMemoryWarningNotification object:nil]; 
```

这假设您的类还实现了一个 handleMemoryWarning 方法，如下所示：

```
- (void) handleMemoryWarning:(NSNotification *)notification
{
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T18:44:44.820

使用应用程序委托和实现可选方法要简单得多

```
- (void)applicationDidReceiveMemoryWarning:(UIApplication *)application 
```

最常见的通知也可以转换为对委托的调用，通常是正式协议中的可选方法。您的委托可以是您喜欢的任何对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-11T18:28:30.037

它被发送到通知中心，所有通知都集中在这里。想要获得有关此通知的通知的对象通过告诉它想要获得通知的通知以及在引发通知时应该调用哪个方法来将自己注册到通知中心。

有关更多信息，您可以查看Cocoa和[NSNotification 类参考的](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSNotification_Class/Reference/Reference.html)[通知编程主题](http://developer.apple.com/documentation/Cocoa/Conceptual/Notifications/Introduction/introNotifications.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-22T21:11:20.807

请注意，您的选择器需要将通知作为参数。

如果您使用 @selector(handleMemoryWarning) 和 - (void) handleMemoryWarning { } 之类的东西，该对象将不会发送通知，您仍将保留所有内存。

我只是被这个咬了。

# scala - 将字符串匹配为 Seq[Char] 的模式

> ID：740563
> 
> 赞同：11
> 
> 时间：2009-04-11T18:15:28.477
> 
> 标签：scala, pattern-matching

在 Scala 中，可以通过将字符串视为 Seq[Char] 来基于字符串的单个字符来制定模式。

[A Tour of Scala](http://www.scala-lang.org/node/122 "斯卡拉之旅")中提到了此功能的一个示例

这是那里使用的示例代码：

```
object RegExpTest1 extends Application {
 def containsScala(x: String): Boolean = {
   val z: Seq[Char] = x
   z match {
      case Seq('s','c','a','l','a', rest @ _*) =>
                println("rest is "+rest)
                true
      case Seq(_*) =>
                false
   }
 } 
```

}

我遇到的问题是代码段的第三行：

```
val z: Seq[Char] = x 
```

为什么这种演员阵容是必要的？在所有情况下（包括模式匹配），字符串不应该表现得像 Seq[Char] 吗？但是，如果没有这种转换，代码片段将无法工作。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-12T00:01:04.153

问题和评论中确实存在对术语的滥用。这段代码没有演员表，尤其是“所以基本上，这是对 Java 互操作性的重大让步，牺牲了一些类型的健全性”在现实中没有根据。

Scala 演员表如下所示`x.asInstanceOf[Y]`：
你在上面看到的是一个作业：`val z: Seq[Char] = x`

此分配是合法的，因为存在从`String`to的隐式转换`Seq[Char]`。我再次强调，**这不是演员表**。强制转换是一个在运行时可能会失败的任意断言。隐式转换不可能失败。

依赖类型之间的隐式转换以及原始问题的答案的问题是，只有在原始值不进行类型检查时才会发生隐式转换。由于在字符串上匹配是完全合法的，因此不会发生转换，匹配就会失败。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-11T18:25:48.763

不是 100% 确定这是否正确，但我的直觉是，如果没有这种显式转换，您将与 进行模式匹配`java.lang.String`，这不是您想要的。

显式转换强制 Scala 编译器使用[`Predef.stringWrapper`](http://www.scala-lang.org/docu/files/api/scala/Predef%24object.html#stringWrapper%28scala.Predef.String%29)隐式转换；因此，随着[RichString](http://www.scala-lang.org/docu/files/api/scala/runtime/RichString.html) extends [`Seq[Char]`](http://www.scala-lang.org/docu/files/api/scala/Seq.html)，您可以进行模式匹配，就好像字符串是一个字符序列一样。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-11T21:05:26.900

我将回应 andri 所说的一切。为了互操作性，Scala 字符串是`java.lang.String`s。在中，有一个从to`Predef`的隐式转换，它实现了.`String``RichString``Seq[Char]`

编码模式匹配的一种可能更好的方法，不需要中间 val`z`来保存`Seq[Char]`：

```
def containsScala(x: String): Boolean = {
  (x: Seq[Char]) match {
    ...
  }
} 
```

# ruby-on-rails - 哪个 Web 开发框架最适合 Google App Engine？

> ID：740566
> 
> 赞同：10
> 
> 时间：2009-04-11T18:17:16.570
> 
> 标签：ruby-on-rails, google-app-engine, web-applications, web-frameworks, web2py

现在 Google 允许在 App Engine 上使用 Java，我想知道这对 App Engine 的 Web 框架选择有什么影响。

1.  我意识到 Google 提供了非常简单的 webapp 框架。
2.  可用于 App Engine 的 .96 版本的 django 具有限制性。
3.  据我所知，web2py 会消耗资源。
4.  Rails（现在可用）不能使用 ActiveRecord、ActiveResource、restclient、rmagick。

有什么我遗漏的 - 任何框架在 App Engine 上运行良好吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-11T19:54:03.810

实际上 web2py 非常轻量级，因为在 GAE 上约为 1.50，它缓存了所有字节码编译的模型/视图/控制器。

尽管如此，您需要考虑默认情况下具有基于数据存储的会话，与没有在 GAE 上工作的会话的框架相比，这可能会增加一些开销（至少默认情况下不会）。

与幼稚的 Google 数据存储 API 相比，web2py DAL 本身不会增加显着的开销。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T18:35:00.147

就个人而言，我发现 Python 更有趣。这就是我。然而，有几个忠实的 Java 开发人员会欣赏 GAE 中的 Java 支持。此外，支持 Java 是 Google 的一个不错的选择，因为它将允许 GAE 平台潜在地托管许多其他语言。现在期待所有基于 JVM 的语言都在 GAE 上运行显然还为时过早，但未来看起来很有希望。现在，我们可以通过查看[这个 GAE Java Group Page](http://groups.google.com/group/google-appengine-java/web/will-it-play-in-app-engine?pli=1)来了解哪些是有效的，哪些是无效的。

回到 Python，我认为小型 Web 应用程序可以很好地与内置的 webapp 框架配合使用。其他应用程序将从 Django 1.0 中受益更多。查看框架部分下的[GAE 文章](http://code.google.com/appengine/articles/)，了解有关此内容的一些好读物。在任何情况下，毫无疑问，您的任何选择都会受到限制，因为大多数 Web 框架在设计时都考虑到了关系数据库……而 datastore/bigtable 则不是。此外，出于安全原因，GAE 平台必须被沙盒化，这也在一定程度上限制了您。希望这可以帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T18:20:15.750

试试[春天](http://www.springframework.org)。它支持 JPA 和 JDO。

现在甚至还有一个适用于 Spring 的[Python 版本](http://springpython.webfactional.com/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-11T18:35:42.250

我不确切知道所有选项，但我可以立即告诉你一些事情......

*   Google Apps 建立在 / 使用 Django 之上。
*   Django 几乎是 Google Apps 欢呼和支持的对象，所以我希望它能够比其他人更好地与 Google Apps 集成。
*   Google Apps 内置了您***无法***规避（或不应）规避的限制。这些限制与任何特定框架无关，可以说是内置于应用程序的结构中。
*   我不会太担心框架的性能 - 尝试改进您的设计/结构，它肯定会获得更好的回报。
*   Google 最终将迁移到 Django 1.0 和更新版本，而且他们也在更新 Google Apps。
*   他们确实使用 memcache（或等效的），因此请考虑并使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-11T19:09:49.627

这真的取决于你想做什么。根据我的经验，在 Webob 上手工制作的东西对于 API 来说非常有用。但是对于需要模板/会话/复杂路由/缓存的成熟站点，django 很难被击败。

考虑到如果你是大型框架（如 django 1.0），第一个请求总是需要大约 3 秒才能将所有内容加载到内存中，并在该请求后保持 15 秒。

当您四处寻找框架时，请考虑到：

*   ORM 不适用于平台，所以基本上没关系。
*   快速模板（如 Cheetah）不会很快（甚至无法工作），因为它们不能使用 c 扩展。
*   缓存可能是使一切快速的最重要的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T18:25:54.193

如果您正在寻找 Python，那么[Django](http://www.djangoproject.com/)将是您最好的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-11T18:32:48.170

Struts 2 据称可以在 Google App Engine 上运行（至少在示例应用程序方面）。关注这个话题：

[http://www.nabble.com/Google-App-Engine-support--td22972179.html](http://www.nabble.com/Google-App-Engine-support--td22972179.html)

Sitemesh 在模板方面似乎存在一些问题，但如果您使用的是 JSP，您应该没问题。

作为 Web 应用程序框架，这是一个不错的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-11T18:53:00.337

如果你使用 Python，我推荐[web.py。](http://webpy.org/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-03T20:44:48.540

我使用**新框架** [GAE 框架](http://appengine-framework.googlecode.com)。这与 Django 类似，但适用于 AppEngine。

最好的祝福！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-16T11:50:34.713

对于 Python，使用[webapp2](http://webapp-improved.appspot.com)（与应用引擎捆绑在一起）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-02-07T11:27:57.257

如果你想构建大型应用程序并需要更灵活的框架，那么你可以看看[Pyramid Python Framework](http://www.pylonsproject.org/)。以前它被称为塔架。有很多优秀的公司使用这个框架。

# performance - 如何查找 RESTful 服务性能不佳的原因？

> ID：740574
> 
> 赞同：0
> 
> 时间：2009-04-11T18:24:12.387
> 
> 标签：performance, rest, benchmarking

我正在创建一个从手机接收一些数据并将其保存到数据库的服务。

手机每 250 毫秒发送一次数据。当我注意到数据存储的延迟正在增加时，我尝试运行 WireShark 并写入日志。

我注意到来自手机的网络请求正在毫无延迟地发出（使用 WireShark 检查），但在服务日志中，我注意到每隔一秒半或几乎两秒就会收到请求。

有谁知道问题出在哪里或测试和确定这种延迟原因的方法？

我正在使用 WCF (webHttpBinding) 创建一个服务，数据库是 MS SQL。顺便说一句，日志存储了http请求的时间以及将数据写入数据库的时间。如上所述，每 1.5 - 2 秒接收一次请求，之后需要 50 毫秒将数据存储到数据库中。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T18:27:28.527

阅读问题后我的第一个猜测是，也许您提交数据的速度如此之快，数据库服务器遇到了写争用锁（例如自动编号字段？）

如果您的数据库平台是 SQL Server，请查看[http://www.sql-server-performance.com/articles/per/lock_contention_nolock_rowlock_p1.aspx](http://www.sql-server-performance.com/articles/per/lock_contention_nolock_rowlock_p1.aspx)

无论如何，请发布有关系统整体架构的更多信息......哪些软件/平台用于哪些部分等......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T21:11:59.300

也许服务提供商对连接施加了一些限制？

如果您（用于测试）不写入数据库，而只是在服务器日志中记录页面命中并带有时间戳，会发生什么情况？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T21:15:14.737

检查您没有在 Web 服务上运行任何跟踪，这真的可以杀死 perf。

# c++ - C/C++ 中联合的大小

> ID：740577
> 
> 赞同：52
> 
> 时间：2009-04-11T18:27:19.087
> 
> 标签：c++, c, sizeof, unions

C/C++ 中联合的大小是多少？它是里面最大数据类型的大小吗？如果是这样，如果联合的较小数据类型之一处于活动状态，编译器如何计算如何移动堆栈指针？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-04-11T18:28:21.583

A`union`总是占用与最大成员一样多的空间。当前使用什么并不重要。

```
union {
  short x;
  int y;
  long long z;
} 
```

上面的一个实例`union`总是至少需要一个`long long`用于存储。

*旁注*：正如[Stefano](https://stackoverflow.com/questions/740577/sizeof-a-union-in-c-c/740653#740653)所指出的，任何类型 ( `union`, `struct`, `class`) 将占用的实际空间确实取决于其他问题，例如编译器的对齐。为简单起见，我没有进行此操作，因为我只是想告诉工会考虑了最大的项目。**重要的是要知道实际大小*确实*取决于对齐方式**。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-04-11T19:44:12.663

该标准回答了 C++ 标准第 9.5 节或 C99 标准第 6.5.2.3 节第 5 段（或 C11 标准第 6 段，或 C18 标准第 6.7.2.1 节第 16 段）中的所有问题：

> 在一个联合中，任何时候最多有一个数据成员处于活动状态，即任何时候最多可以有一个数据成员的值存储在一个联合中。[注意：为了简化联合的使用，做了一个特殊的保证：如果一个 POD 联合包含多个共享一个公共初始序列的 POD 结构（9.2），并且如果这个 POD 联合类型的对象包含以下之一POD-structs，允许检查任何 POD-struct 成员的公共初始序列；见 9.2。] 联合的大小足以包含其最大的数据成员。每个数据成员都被分配，就好像它是结构的唯一成员一样。

这意味着每个成员共享相同的内存区域。最多有一个活跃*的*成员，但你无法找出是哪一个。您必须自己将有关当前活动成员的信息存储在其他地方。除了联合之外存储这样一个标志（例如，具有一个整数作为类型标志和一个联合作为数据存储的结构）将为您提供所谓的“区分联合”：一个知道什么类型的联合它目前是“活跃的”。

一个常见的用途是在词法分析器中，您可以有不同的标记，但根据标记，您有不同的信息要存储（放入`line`每个结构中以显示常见的初始序列是什么）：

```
struct tokeni {
    int token; /* type tag */
    union {
        struct { int line; } noVal;
        struct { int line; int val; } intVal;
        struct { int line; struct string val; } stringVal;
    } data;
}; 
```

该标准允许您访问`line`每个成员，因为这是每个成员的共同初始顺序。

存在允许访问所有成员的编译器扩展，而不管当前存储了哪个成员的值。这允许在每个成员之间有效地重新解释具有不同类型的存储位。例如，以下可用于将浮点变量分解为 2 个无符号短裤：

```
union float_cast { unsigned short s[2]; float f; }; 
```

这在编写低级代码时非常方便。如果编译器不支持该扩展，但您还是这样做了，那么您编写的代码的结果未定义。因此，如果您使用该技巧，请确保您的编译器支持它。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-11T19:20:01.130

这取决于编译器和选项。

```
int main() {
  union {
    char all[13];
    int foo;
  } record;

printf("%d\n",sizeof(record.all));
printf("%d\n",sizeof(record.foo));
printf("%d\n",sizeof(record));

} 
```

这输出：

13 4 16

如果我没记错的话，这取决于编译器放入分配空间的对齐方式。因此，除非您使用某些特殊选项，否则编译器会将填充放入您的联合空间。

编辑：使用 gcc，您需要使用 pragma 指令

```
int main() {
#pragma pack(push, 1)
      union {
           char all[13];
           int foo;
      } record;
#pragma pack(pop)

      printf("%d\n",sizeof(record.all));
      printf("%d\n",sizeof(record.foo));
      printf("%d\n",sizeof(record));

} 
```

这输出

13 4 13

您也可以从反汇编中看到它（为了清楚起见，删除了一些 printf）

```
 0x00001fd2 <main+0>:    push   %ebp             |  0x00001fd2 <main+0>:    push   %ebp
  0x00001fd3 <main+1>:    mov    %esp,%ebp        |  0x00001fd3 <main+1>:    mov    %esp,%ebp
  0x00001fd5 <main+3>:    push   %ebx             |  0x00001fd5 <main+3>:    push   %ebx
  0x00001fd6 <main+4>:    sub    $0x24,%esp       |  0x00001fd6 <main+4>:    sub    $0x24,%esp
  0x00001fd9 <main+7>:    call   0x1fde <main+12> |  0x00001fd9 <main+7>:    call   0x1fde <main+12>
  0x00001fde <main+12>:   pop    %ebx             |  0x00001fde <main+12>:   pop    %ebx
  0x00001fdf <main+13>:   movl   $0xd,0x4(%esp)   |  0x00001fdf <main+13>:   movl   $0x10,0x4(%esp)                                         
  0x00001fe7 <main+21>:   lea    0x1d(%ebx),%eax  |  0x00001fe7 <main+21>:   lea    0x1d(%ebx),%eax
  0x00001fed <main+27>:   mov    %eax,(%esp)      |  0x00001fed <main+27>:   mov    %eax,(%esp)
  0x00001ff0 <main+30>:   call  0x3005 <printf>   |  0x00001ff0 <main+30>:   call   0x3005 <printf>
  0x00001ff5 <main+35>:   add    $0x24,%esp       |  0x00001ff5 <main+35>:   add    $0x24,%esp
  0x00001ff8 <main+38>:   pop    %ebx             |  0x00001ff8 <main+38>:   pop    %ebx
  0x00001ff9 <main+39>:   leave                   |  0x00001ff9 <main+39>:   leave
  0x00001ffa <main+40>:   ret                     |  0x00001ffa <main+40>:   ret 
```

唯一的区别在于 main+13，编译器在堆栈上分配 0xd 而不是 0x10

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-11T18:33:30.120

联合没有活动数据类型的概念。你可以自由地阅读和写作工会的任何“成员”：这取决于你来解释你得到什么。

因此，联合的大小始终是其最大数据类型的大小。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-11T18:33:40.430

大小将至少是最大的组成类型的大小。没有“活动”类型的概念。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-11T18:49:58.987

您真的应该将联合视为其中最大数据类型的容器，并结合转换的快捷方式。当您使用其中一个较小的成员时，未使用的空间仍然存在，但它只是保持未使用状态。

在 Unix 中，您经常看到它与 ioctl() 调用结合使用，所有 ioctl() 调用都将传递相同的结构，其中包含所有可能响应的联合。例如，这个例子来自 /usr/include/linux/if.h 并且这个结构在 ioctl() 中用于配置/查询以太网接口的状态，请求参数定义了联合的哪个部分实际在使用：

```
struct ifreq 
{
#define IFHWADDRLEN 6
    union
    {
        char    ifrn_name[IFNAMSIZ];        /* if name, e.g. "en0" */
    } ifr_ifrn;

    union {
        struct  sockaddr ifru_addr;
        struct  sockaddr ifru_dstaddr;
        struct  sockaddr ifru_broadaddr;
        struct  sockaddr ifru_netmask;
        struct  sockaddr ifru_hwaddr;
        short   ifru_flags;
        int ifru_ivalue;
        int ifru_mtu;
        struct  ifmap ifru_map;
        char    ifru_slave[IFNAMSIZ];   /* Just fits the size */
        char    ifru_newname[IFNAMSIZ];
        void *  ifru_data;
        struct  if_settings ifru_settings;
    } ifr_ifru;
}; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-12T12:23:08.293

> C/C++ 中联合的大小是多少？它是里面最大数据类型的大小吗？

**是**的，工会的规模是其最大成员的规模。

例如 ：

```
#include<stdio.h>

union un
{
    char c;
    int i;
    float f;
    double d;
};

int main()
{
    union un u1;
    printf("sizeof union u1 : %ld\n",sizeof(u1));
    return 0;
} 
```

**输出 ：**

```
sizeof union u1 : 8
sizeof double d : 8 
```

这里最大的成员是`double`。两者都有大小`8`。所以，正如`sizeof`正确地告诉你的那样，工会的规模确实是`8`.

> 如果联合的较小数据类型之一处于活动状态，编译器如何计算如何移动堆栈指针？

它由编译器在内部处理。假设我们正在访问联合的数据成员之一，那么我们无法访问其他数据成员，因为我们可以访问联合的单个数据成员，因为每个数据成员共享相同的内存。通过使用联合，我们可以节省大量宝贵的空间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-11T19:16:00.377

1.  最大成员的大小。

2.  这就是为什么联合通常在具有指示哪个是“活动”成员的标志的结构中有意义。

例子：

```
struct ONE_OF_MANY {
    enum FLAG { FLAG_SHORT, FLAG_INT, FLAG_LONG_LONG } flag;
    union { short x; int y; long long z; };
}; 
```

# winforms - 立即应用 DataGridViewComboBoxCell 选择更改

> ID：740581
> 
> 赞同：6
> 
> 时间：2009-04-11T18:29:09.443
> 
> 标签：winforms, datagridview, combobox

当我更改 DataGridViewComboBoxCell 中的值时，新值不会立即应用，直到该单元格离开焦点。

有没有办法立即应用新值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-13T23:13:38.073

如果您处理`EditingControlShowing`DataGridView 上的事件，则可以将事件处理程序附加到基础 ComboBox 的`SelectedIndexChanged`事件（或`SelectedValueChanged`，或任何其他 ComboBox 事件）。只要 ComboBox 值发生变化，它就会立即触发，您可以使用新值做任何您想做的事情。

[在DataGridViewComboBoxEditingControl 的 MSDN 文档中](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxeditingcontrol.aspx)有示例代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-22T03:10:49.607

[DataGridView.CommitEdit 方法](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.commitedit(VS.80).aspx)

这可能对你也有一些用处。处理 CurrentCellDirtyStateChanged 事件，检查 Dirty 并提交编辑。然后，您可以使用 CurrentCell 属性访问已选择的值（假设已验证）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T00:51:28.157

```
DataGridView1.EndEdit() 
```

忽略此文本，答案必须至少 30 个字符

# language-agnostic - 更多 TCP 和 POSIX 套接字 listen() 和 accept() 语义

> ID：740583
> 
> 赞同：3
> 
> 时间：2009-04-11T18:29:41.267
> 
> 标签：language-agnostic, sockets, network-programming, tcp

情况：服务器调用listen()（但不调用accept()！）。客户端向服务器发送一个 SYN。服务器获取 SYN，然后将 SYN/ACK 发送回客户端。但是，客户端现在挂起/死亡，因此它永远不会向服务器发送回 ACK。连接处于 SYN_SENT 状态。

现在另一个客户端发送一个 SYN，从服务器获取一个 SYN/ACK，然后发回一个 ACK​​。此连接现在处于 ESTABLISHED 状态。

现在服务器终于调用了accept()。怎么了？在出现某种超时之前，accept() 是否会阻塞第一个错误连接？它是否首先检查队列中是否有任何已建立的连接并返回这些连接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-11T19:11:51.743

好吧，您在这里描述的是多次执行时的典型 syn-flood 攻击 ( [http://en.wikipedia.org/wiki/SYN_flood )。](http://en.wikipedia.org/wiki/SYN_flood)

在查看示例时： http: [//lkml.indiana.edu/hypermail/linux/kernel/0307.0/1258.html](http://lkml.indiana.edu/hypermail/linux/kernel/0307.0/1258.html)有两个单独的队列，一个同步队列和一个已建立的队列。显然，第一个连接将保留在同步队列中（因为它处于 SYN_RCVD 状态），第二个连接将在已建立的队列中，accept() 将从中获取它。netstat 仍应显示处于 SYN_RCVD 状态的第一个。

**注意**：另见我的评论，客户端将处于 SYN_SENT 状态，服务器（我们正在讨论）将处于 SYN_RCVD 状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T20:09:59.543

您应该注意，在某些实现中，半开连接（处于 SYN_RCVD 状态的连接）甚至可能不会记录在服务器上。实现可以使用[SYN cookie](http://en.wikipedia.org/wiki/SYN_cookies)，其中它们将完成建立连接所需的所有信息编码为 SYN+ACK 数据包的序列号。当 ACK 包返回时，序列号递增，他们可以递减它并取回信息。这可以通过不在服务器上为这些半开连接分配任何资源来帮助防止 SYN 泛滥；因此无论客户端发送多少额外的 SYN 数据包，服务器都不会耗尽资源。

请注意，[SCTP](http://en.wikipedia.org/wiki/Stream_Control_Transmission_Protocol)实现了 4 次握手，协议中内置了 cookie，以防止 SYN 泛滥，同时允许将更多信息存储在 cookie 中，因此不必限制支持的协议功能，因为 cookie 的大小是太小（在 TCP 中，您只能获得 32 位的序列号来存储所有信息）。

因此，要回答您的问题，用户空间`accept()`只会看到完全建立的连接，并且没有半开连接的概念，这些连接纯粹是 TCP 堆栈的实现细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T19:22:11.267

您必须记住`listen()`, `accept()`, et al*不是*底层协议调试工具。从`accept`手册页：“接受 - 接受套接字上的连接”。不完整的连接不会被报告，也不应该被报告。应用程序无需担心套接字的设置和拆除、重传、片段重组或...

如果您正在编写一个网络应用程序，那么涵盖您*应该*关注的事情是绰绰有余的。如果您有一个正在运行的应用程序但正在尝试找出问题，那么请使用一个不错的网络调试工具、用于检查您的操作系统状态的工具等。不要尝试将其放入您的应用程序中。

如果您正在尝试*编写*调试工具，那么您无法通过使用应用程序级别的 TCP/IP 调用来完成您想要的工作。您需要至少降低一个级别。

# c# - HashPasswordForStoringInConfigFile() 的输出是什么格式，如何存储最好？

> ID：740584
> 
> 赞同：2
> 
> 时间：2009-04-11T18:29:41.673
> 
> 标签：c#, hash, types, passwords

我正在使用此函数为密码生成哈希，然后将其存储在数据库（SQL Server）中。

代码如下所示：

```
byte[] saltBytes = new byte[16];
new RNGCryptoServiceProvider ().GetBytes (saltBytes);
string salt = Convert.ToBase64String (saltBytes);
string saltedPasswordHash =
FormsAuthentication.HashPasswordForStoringInConfigFile (password + salt, FormsAuthPasswordFormat.SHA1.ToString ()); 
```

现在的问题是：HashPasswordForStoringInConfigFile () 的输出是什么格式 - 我将它存储为 char(length) 还是 nchar(length)？

或者是否有任何其他首选方式来存储哈希，也许不是作为字符串？

非常感谢任何输入和半相关的评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T18:34:18.977

SQL Server 支持旨在存储二进制数据的二进制列（`binary(len)`和）。`varbinary(len)`您可能要考虑使用它们。在这种情况下，您可以使用诸如`System.Security.Cryptography.SHA512Managed`直接的类，而不是`HashPasswordForStoringInConfigFile`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T18:52:35.987

由于您使用的是 C#，因此可能值得考虑使用 BCrypt 散列解决方案。它是由编写 OpenBSD 的人在 BCrypt 加密算法上设计的，是一个非常强大的算法。最好的部分是你不必担心盐（但它们就在那里），随着时间的推移，你可以使盐的产生变得困难。

[BCrypt.net - .NET 和 Mono 的强密码散列](http://derekslager.com/blog/posts/2007/10/bcrypt-dotnet-strong-password-hashing-for-dotnet-and-mono.ashx)

# regex - 如何从推文中提取用户名？

> ID：740590
> 
> 赞同：8
> 
> 时间：2009-04-11T18:33:56.187
> 
> 标签：regex, twitter

我有以下示例推文：

```
RT @user1: who are @thing and @user2? 
```

我只想拥有*user1*、*thing*和*user2*。

我可以使用什么正则表达式来提取这三个名称？

PS：用户名只能包含字母、数字和下划线。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-11T18:40:18.603

测试：

```
/@([a-z0-9_]+)/i 
```

* * *

在红宝石（irb）中：

```
>> "RT @user1: who are @thing and @user2?".scan(/@([a-z0-9_]+)/i)
=> [["user1"], ["thing"], ["user2"]] 
```

在 Python 中：

```
>>> import re
>>> re.findall("@([a-z0-9_]+)", "RT @user1: who are @thing and @user2?", re.I)
['user1', 'thing', 'user2'] 
```

在 PHP 中：

```
<?PHP
$matches = array();
preg_match_all(
    "/@([a-z0-9_]+)/i",
    "RT @user1: who are @thing and @user2?",
    $matches);

print_r($matches[1]);
?>

Array
(
    [0] => user1
    [1] => thing
    [2] => user2
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T10:23:44.077

尝试使用此正则表达式的迭代器（findall）：

```
(@[\w-]+) 
```

再见

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T05:08:45.260

```
/(?<!\w)@(\w+)/ 
```

以上涵盖了以下场景，该线程中的其他答案没有：

*   不应该是用户名的 @ 符号，例如“我的电子邮件是 test@example.com”
*   仍然允许在字符串开头的用户名，例如“@username lorem ipsum...”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-23T13:55:04.387

在您的项目中包含 twitter 文本库 [1] 以解决此文本问题是一个好主意。

```
twttr.txt.extractMentions("a very generic twitt with some @mention"); 
```

[1] [https://github.com/twitter/twitter-text-js](https://github.com/twitter/twitter-text-js)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T18:51:53.943

应该这样做（为方便起见，我使用了命名捕获）：

.+?@(?[a-zA-Z0-9_]+):[^@]+?@(?[^\s]+)[^@]+?@(?[a-zA-Z0- 9_]+)

# asp.net - 可序列化的类集合

> ID：740601
> 
> 赞同：0
> 
> 时间：2009-04-11T18:42:08.367
> 
> 标签：asp.net, vb.net

我有一个包含可以序列化的属性列表的类。但是，我需要其中一个属性来包含另一个类的集合以给我子类

示例 XML

```
<VideoOptions>
<property1>value1</property1>
<property2>value2</property2>
<property3>
    <item>
        <property1>value1</property1>
    </item>
    <item>
        <property1>value1</property1>
    </item>
</property3>
</VideoOptions> 
```

当我序列化主类时，我不确定如何实现这一点。

目前我使用这个命令来序列化我的类

```
Dim oXS As XmlSerializer = New XmlSerializer(GetType(VideoOptions))

        Dim strW As New StringWriter
        oXS.Serialize(strW, Me)
        VideoOptionsAsXML = strW.ToString 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T12:05:53.413

您只需要在 VideoOptions 类上有一个属性，它是 Property3 的集合

如下创建一个集合类。

```
Public Class Property3Collection
    Inherits CollectionBase

    Public Function Add(ByVal item As Property3Item) As Integer
        Return Me.List.Add(item)
    End Function

    Default Public ReadOnly Property Item(ByVal index As Integer) As Object
        Get
            Return CType(Me.List.Item(index), SingleItem)
        End Get
    End Property
End Class 
```

为您的项目开设课程

```
Public Class Property3Item
'Add in Item property
End Class 
```

建立你的 Property3Collection 类

```
Public Sub AddPropertyItem
   Dim newCol as New Property3Collection
   newCol.Add(New Property3Item)
End Sub 
```

将属性添加到您的 VideoOptions 类

```
 Public Property Property3() As Property3Collection
        Get

        End Get
        Set(ByVal Value As Property3)

        End Set
    End Property 
```

只要 Property3Item 有一个没有参数的构造函数（xml 序列化所需），Xmlserializer 类就会将其序列化和反序列化为您指定的格式而不会出现问题。

希望这可以帮助

# f# - F# 映射问题

> ID：740605
> 
> 赞同：2
> 
> 时间：2009-04-11T18:43:56.473
> 
> 标签：f#

我无法理解 F# 的 Map 类。我创建了一个简单、朴素的 lambda 演算评估函数，

```
type Name = string
type Term =
    |   Var of Name 
    |   Lit of int
    |   App of Term * Term
    |   Lam of Name * Term

let rec lookup(v, e) =
    match e with
    |   (v1, t)::tl         -> if v1 = v then t else lookup(v, tl)
    |   []                  -> failwith "unknown variable %s" v

let rec eval(x, e) = 
    match x with
    |   Var x               -> lookup(x, e)
    |   Lit x               -> Lit x
    |   App (Lam(v, f), t2) -> eval(f, ((v, t2)::e))
    |   _                   -> failwith "Invalid" 
```

对此的明显优化是将列表更改为 Map 所以我想出了，

```
let rec eval2(x, e: Map<Name,Term>) =
    match x with
    |   Var v               -> e.[v]
    |   Lit l               -> x
    |   App (Lam (v, f), t) -> eval2(f, e.Add(v, t))
    |   _                   -> failwith "Invalid term" 
```

给定值，

```
let ident = Lam ("x", Var "x")
let prog = App (ident, Lit 3) 
```

为什么，

```
let x = eval(prog, []) 
```

成功但是，

```
let x2 = eval2(prog, Map []) 
```

抛出未找到密钥的异常？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T18:56:03.060

我不会重现这种行为（使用 F# 1.9.6.2，它适用于我）：

```
#light

type Name = string
type Term =
    |   Var of Name
    |   Lit of int
    |   App of Term * Term
    |   Lam of Name * Term

let rec eval2(x, e: Map<Name,Term>) =
    match x with
    |   Var v               -> e.[v]
    |   Lit l               -> x
    |   App (Lam (v, f), t) -> eval2(f, e.Add(v, t))
    |   _                   -> failwith "Invalid term"

let ident = Lam ("x", Var "x")
let prog = App (ident, Lit 3)
let x2 = eval2(prog, Map [])
printfn "%A" x2   // Lit 3 
```

# java - 在 Java 中生成正弦波时背景中的噪声

> ID：740619
> 
> 赞同：5
> 
> 时间：2009-04-11T18:57:25.507
> 
> 标签：java, audio, javasound

当我运行以下代码时，我在后台得到了轻微的失真（听起来像嗡嗡声）。由于其微妙的性质，它让人相信字节转换存在某种混叠。

AudioFormat = PCM_SIGNED 44100.0 Hz，16 位，立体声，4 字节/帧，大端

**注意**：代码假设（现在）数据是大端的。

```
public static void playFreq(AudioFormat audioFormat, double frequency, SourceDataLine sourceDataLine)
{
    System.out.println(audioFormat);
    double sampleRate = audioFormat.getSampleRate();
    int sampleSizeInBytes = audioFormat.getSampleSizeInBits() / 8;
    int channels = audioFormat.getChannels();

    byte audioBuffer[] = new byte[(int)Math.pow(2.0, 19.0) * channels * sampleSizeInBytes];

    for ( int i = 0; i < audioBuffer.length; i+=sampleSizeInBytes*channels )
    {
        int wave = (int) (127.0 * Math.sin( 2.0 * Math.PI * frequency * i / (sampleRate * sampleSizeInBytes * channels) )  );

        //wave = (wave > 0 ? 127 : -127);

        if ( channels == 1 )
        {
            if ( sampleSizeInBytes == 1 )
            {
                audioBuffer[i] = (byte) (wave);
            }

            else if ( sampleSizeInBytes == 2 )
            {
                audioBuffer[i] = (byte) (wave);
                audioBuffer[i+1] = (byte)(wave >>> 8);
            }
        }

        else if ( channels == 2 )
        {
            if ( sampleSizeInBytes == 1 )
            {
                audioBuffer[i] = (byte) (wave);
                audioBuffer[i+1] = (byte) (wave);
            }

            else if ( sampleSizeInBytes == 2 )
            {
                audioBuffer[i] = (byte) (wave);
                audioBuffer[i+1] = (byte)(wave >>> 8);

                audioBuffer[i+2] = (byte) (wave);
                audioBuffer[i+3] = (byte)(wave >>> 8);
            }
        }
    }

    sourceDataLine.write(audioBuffer, 0, audioBuffer.length);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-11T19:45:50.117

您的评论说代码假定大端。

从技术上讲，您*实际上*是以小端方式输出的，但这似乎并不重要，因为幸运的是，您的最高有效字节始终为 0。

编辑：进一步解释 - 当您的值处于最大值 127 时，您应该编写 (0x00, 0x7f)，但代码的实际输出是 (0x7f, 0x00)，即 32512。这恰好是附近正确的*16 位*最大值 32767，但底部 8 位全为零。最好始终使用 32767 作为最大值，然后根据需要丢弃低 8 位。

这意味着即使您输出 16 位数据，有效分辨率也只有 8 位。这似乎是音质不足的原因。

我已经制作了您的代码版本，它只是将原始数据转储到文件中，并且看不到位移本身有任何其他问题。没有意外的符号变化或丢失位，但有与 8 位采样质量一致的嗡嗡声。

此外，如果您根据样本数计算波动方程，那么您的数学会更容易，然后分别担心字节偏移：

```
int samples = 2 << 19;
byte audioBuffer[] = new byte[samples * channels * sampleSizeInBytes];

for ( int i = 0, j = 0; i < samples; ++i )
{
    int wave = (int)(32767.0 * Math.sin(2.0 * Math.PI * frequency * i / sampleRate));
    byte msb = (byte)(wave >>> 8);
    byte lsb = (byte) wave;

    for (int c = 0; c < channels; ++c) {
        audioBuffer[j++] = msb;
        if (sampleSizeInBytes > 1) {
            audioBuffer[j++] = lsb;
        }
    }
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T19:22:07.427

我假设您重复调用此代码以播放长声音。

您正在生成的波浪是否有可能在写入之前没有完成一个完整的时期？

如果波在完成一个完整周期之前被“切断”，然后下一个波被写入输出，你肯定会听到一些奇怪的东西，我认为这可能是导致嗡嗡声的原因。

例如：

```
 /-------\              /-------\              /-------\
  -----/         \       -----/         \       -----/         \
                  \                      \                      \
                   \-----                 \-----                 \----- 
```

请注意此波各部分之间的脱节。这可能是引起嗡嗡声的原因。

# c# - 如何在各种不同条件下启用/禁用多个控件中的某些控件？

> ID：740620
> 
> 赞同：3
> 
> 时间：2009-04-11T18:58:06.517
> 
> 标签：c#, user-interface

如何在各种不同条件下启用/禁用多个控件中的某些控件？

假设有一个带有一些行的 GUI，每行代表一个人。还有一些按钮，代表一些动作，比如“站、坐、走、跳、吃、看电视、醒来、睡觉”，还有一些条件，比如如果有人坐着，他可以吃东西和看电视（即启用那些按钮）但不能跳（禁用它），如果有人站着他就不能睡觉，等等。

此外，状态变化不仅仅基于按钮点击。就像，他可能会在一段时间后自己醒来，或者说，在他吃完饭后。

似乎最天真的方法是编写`.Enabled = true/false;`n 个状态 X m 个按钮次的代码，并检查每个用户或非用户触发的状态更改。有没有更好/更快/更不容易出错的方法来做到这一点？

另外，这些东西叫什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T19:09:42.183

我会将`Enabled`属性绑定到类的`Can*`( `CanWalk`,`CanJump`等) 属性，实现`INotifyPropertyChanged`并在对象的状态更改时检查每个可能受影响的属性。

这种方法的优点是 Person 类和 UI 不需要相互了解任何信息。此外，实现`INotifyPropertyChanged`消除了每次状态更改后对类属性的多余轮询。

如果您不想使用复杂的数据绑定，您仍然可以监听`PropertyChanged`事件并手动更新 UI。

例如：

```
partial class Person : INotifyPropertyChanged
{
    bool _IsSleeping, _IsSitting;

    public bool IsSleeping 
    { 
        get { return _IsSleeping; } 
        set 
        {
            if(_IsSleeping != value)
            {
                _IsSleeping = value;
                OnIsSleepingChanged();
            }
        }
    }

    public bool IsSitting 
    { 
        get { return _IsSitting; } 
        set 
        {
            if(_IsSitting != value)
            {
                _IsSitting = value;
                OnIsSittingChanged();
            }
        }
    }

    protected virtual void OnIsSleepingChanged()
    {
        NotifyPropertyChanged("IsSleeping");
        CheckCanJumpChanged();
    }

    protected virtual void OnIsSittingChanged()
    {
        NotifyPropertyChanged("IsSitting");
        CheckCanJumpChanged();
    }

    bool CanJump_Old;
    public bool CanJump { get { return !(IsSleeping || IsSitting); } }

    void CheckCanJumpChanged()
    {
        if(CanJump != CanJump_Old)
        {
            CanJump_Old = CanJump;
            NotifyPropertyChanged("CanJump");
        }
    }

    //INotifyPropertyChanged helper method
    private void NotifyPropertyChanged(String prop)
    {
        var hand = PropertyChanged;
        if (hand != null)
            hand(this, new PropertyChangedEventArgs(prop));
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T19:11:33.537

这取决于您使用的是 WPF 还是 WinForms。

WPF 允许您对 Enabled 属性进行数据绑定，因此您可以声明性地说明何时应该启用它，并且只要触发正确的属性更改事件，它就会发生。

使用 WinForms，是的，设置`.Enabled`是要走的路。最简单的事情是编写一个方法，例如，根据您的规则`UpdateEnabled()`更新所有控件（如果跳跃，则 btnEat 应该被禁用），然后在状态更改时调用该方法。`Enabled`

由于并非所有状态更改都响应 GUI 事件，因此您可能需要一个模型对象来维护状态并在状态更改时触发事件。然后，只要该事件触发，您就可以调用您的`UpdateEnabled()`方法来根据新状态刷新 GUI。

如果您的需求很简单，这就是您需要做的一切。如果您的应用程序变得更复杂，您可能需要研究诸如 Model-View-Presenter 之类的模式——Presenter 将是基于当前状态知道哪些操作已启用和哪些操作已禁用的类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T19:11:50.073

您正在寻找的术语是[状态机](http://en.wikipedia.org/wiki/State_machine)。

您可以查看[SimpleStateMachine - C# 状态机库 - Boo 和 Rhino DSL](http://www.pnpguidance.net/post/simplestatemachinecsharpstatemachinelibraryboorhinodsl.aspx)。

# javascript - 在弹出区域外单击时弹出返回隐藏状态

> ID：740621
> 
> 赞同：0
> 
> 时间：2009-04-11T18:58:16.830
> 
> 标签：javascript, ajax, html

如果我有一个弹出窗口（使用 div），当有人单击 div 之外的任何位置时，如何让 div 返回隐藏状态？

即弹出窗口是可见的，然后有人在弹出窗口外点击，应该再次隐藏 div。

我怎样才能实现这个功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-11T19:05:49.790

一种流行的方法是使用叠加层。创建`div`弹出窗口时，还要`<div id="overlay">`在其下方创建一个占据整个屏幕的窗口：

```
div#overlay {
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
} 
```

或者，您可以使用此叠加层使所有其他内容变暗，例如`background: #000`和`opacity: 0.5`。

在您制作了 JavaScript 以在弹出窗口下方添加此叠加层后，为其添加一个点击侦听器。当用户单击覆盖时，您会知道他/她在您的弹出窗口之外单击了。

请注意，`position: fixed`这在旧版浏览器中不起作用。一种解决方法是，当叠加层可见时，将叠加层设置为`position: absolute`，然后临时添加`overflow: hidden`to`<body>`以防止用户向下滚动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T19:43:22.867

对我来说似乎更直接的另一种方法是：

```
$("body").click(function (event) {
    var outside = $(event.originalTarget).parents("#popup").length === 0;
    if (outside) {
        $("#popup").remove();
        $("body").unbind("click");
    }
}); 
```

简而言之， originalTarget 是实际点击的内容，然后脚本会检查 #popup 是否是它的祖先之一（`parents`在 jQuery 中调用）。如果不是，则点击在外部，我们删除弹出窗口。

# sql-server - 使用 SQL CLR 集成实现检查约束

> ID：740623
> 
> 赞同：0
> 
> 时间：2009-04-11T18:59:12.507
> 
> 标签：sql-server, exception-handling, constraints, clr

我正在实现“检查”约束，它只是为每个受约束的列调用一个 CLR 函数。

每个 CLR 函数都是一两行代码，它们尝试构造与该列关联的用户定义 C# 数据类的实例。例如，“Score”类有一个构造函数，它在构造失败时（即，当分数超出有效范围时）抛出有意义的错误消息。

**首先，您如何看待这种方法？** 对我来说，它将我的数据类型集中在 C# 中，使它们在我的应用程序中可用，同时还在数据库中强制执行相同的约束，因此它可以防止非程序员可能尝试在管理工作室中进行无效的手动编辑。到目前为止它运行良好，尽管更新程序集会导致约束被禁用，需要重新检查所有约束（这是完全合理的）。我`DBCC CHECKCONSTRAINTS WITH ALL_CONSTRAINTS`用来确保所有表中的数据对于启用和禁用约束仍然有效，并根据需要进行更正，直到没有错误为止。然后我通过 重新启用所有表的约束`ALTER TABLE [tablename] WITH CHECK CHECK CONSTRAINT ALL`。 **是否有一个 T-SQL 语句可以重新启用检查所有表上的所有检查约束，还是我必须逐个表重新启用它们？**

最后，对于检查约束中使用的 CLR 函数，我可以：

1.  在每个函数中包含一个 try/catch 以捕获数据构造错误，错误时返回 false，成功时返回 true，这样 CLR 就不会在数据库引擎中引发错误，或者...
2.  省略 try/catch，只需构造实例并返回 true，从而允许在数据库引擎中引发上述“有意义的”错误消息。

我更喜欢 2，因为我的函数更简单，没有错误代码，并且当使用管理工作室的人进行无效的列编辑时，他们会从 CLR 获得有意义的消息，`"Value for type X didn't match regular expression '^p[1-9]\d?$'"`而不是像“违反约束”这样的通用 SQL 错误。 **允许 CLR 错误通过 SQL Server 是否有任何严重的负面后果，或者它是否就像任何其他因违反约束而导致的插入/更新失败一样？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T19:47:02.173

> 例如，“Score”类有一个构造函数，它在构造失败时（即，当分数超出有效范围时）抛出有意义的错误消息。首先，您如何看待这种方法？

这让我有点担心，因为调用 ctor 需要分配内存，这是相对昂贵的。对于插入的每一行，您都在调用一个 ctor——*而且只是为了它的副作用。*

也昂贵的是例外。当您需要它们时它们很棒，但在这种情况下，您可以在 ctor 上下文中使用它们，而不是在检查上下文中使用它们。

通过将检查作为类静态或自由函数存在，重构可以降低这两种成本，然后检查约束和 ctor 都可以调用：

```
class Score {

  private:
   int score;

  public:
   static bool valid( int score ) { 
    return score > 0  ; 
   }

    Score( int s ) {
    if( ! valid( s ) ) { 
      throw InvalidParameter();
    }

    score = s;
   }
} 
```

检查约束调用 Score::valid()，不需要构造或异常。

当然，对于每一行，CLR 调用仍然会产生开销。这是否可以接受是您必须决定的事情。

> 是否有一个 T-SQL 语句可以重新启用检查所有表上的所有检查约束，还是我必须逐个表重新启用它们？

不，但您可以这样做来生成命令：

```
select 'ALTER TABLE ' || name || ' WITH CHECK CHECK CONSTRAINT ALL;'
 from sys.tables ; 
```

然后针对数据库运行结果集。

OP的评论：

> 我对所有数据类型使用名为 ConstrainedNumber 和 RegexConstrainedString 的基类。按照您的建议，我可以轻松地将这两个类的简单构造函数代码移动到单独的公共布尔 IsValueValid 方法中，并且可能会这样做。
> 
> CLR 开销（和内存分配）只会发生在插入和更新中。鉴于方法的简单性以及表更新发生的速率，我认为性能影响不会对我的系统产生任何影响。
> 
> 我仍然真的很想为他们将提供给管理工作室用户的信息提出例外。我喜欢 IsValueValid 方法，因为它给了我不抛出错误的“选项”。在使用我的数据类型的应用程序中，我仍然可以通过构造一个实例来获得异常:)

我不确定我是否同意抛出异常，但同样，“带回家的信息”是通过将问题分解为多个部分，您可以选择您愿意支付的部分，而无需支付您不支付的部分不使用。您不使用的 ctor，因为您只是调用它来获得副作用。所以我们分解了创建和检查。我们可以进一步分解投掷：

```
class Score {

  private:
   int score;

  public:
   static bool IsValid( int score ) { 
    return score > 0  ; 
   }

   static checkValid( int score ) {
    if( ! isValid( s ) ) { 
      throw InvalidParameter();
    }

    Score( int s ) {
    checkValid( s ) ;    
    score = s;
   }
} 
```

现在用户可以调用 ctor，获取检查和可能的异常和构造，调用 checkValid 并获取检查和异常，或者 isValid 只获取有效性，只为他需要的东西支付运行时成本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-12T05:20:33.417

一些澄清。这些数据类在基本类型之上设置了一层，限制数据使其有意义。

`RegexConstrainedString`实际上，它们位于和类之上`ConstrainedNumber<T>`，这就是我们正在讨论将构造函数的验证代码重构为单独的方法的地方。

重构验证代码的问题在于，验证所需的正则表达式仅存在于 的子类中`RegexConstrainedString`，因为每个子类都有不同的`Regex`. 这意味着验证数据仅可用于`RegexConstrainedString`的构造函数，而不是它的任何方法。因此，如果我排除验证代码，调用者将需要访问`Regex`.

```
public class Password: RegexConstrainedString
{
    internal static readonly Regex regex = CreateRegex_CS_SL_EC( @"^[\w!""#\$%&'\(\)\*\+,-\./:;<=>\?@\[\\\]\^_`{}~]{3,20}$" );

    public Password( string value ): base( value.TrimEnd(), regex ) {} //length enforced by regex, so no min/max values specified
    public Password( Password original ): base( original ) {}
    public static explicit operator Password( string value ) {return new Password( value );}
} 
```

因此，当从数据库读取值或读取用户输入时，Password 构造函数将其转发`Regex`给基类以处理验证。另一个技巧是它会自动修剪结束字符，以防数据库类型是 char 而不是 varchar，所以我不必记住这样做。无论如何，RegexConstrainedString 的主要构造函数如下所示：

```
protected RegexConstrainedString( string value, Regex subclasses_static_regex, int? min_length, int? max_length )
{
    _value      = (value ?? String.Empty);
    if (min_length != null)
        if (_value.Length < min_length)
            throw new Exception( "Value doesn't meet minimum length of " + min_length + " characters." );
    if (max_length != null)
        if (_value.Length > max_length)
            throw new Exception( "Value exceeds maximum length of " + max_length + " characters." );
    value_match = subclasses_static_regex.Match( _value ); //Match.Synchronized( subclasses_static_regex.Match( _value ) );
    if (!value_match.Success)
        throw new Exception( "Invalid value specified (" + _value + "). \nValue must match regex:" + subclasses_static_regex.ToString() );
} 
```

由于调用者需要访问子类的`Regex`，我认为我最好的选择是`IsValueValid`在子类中实现一个方法，它将数据转发到基类`IsValueValid`中的方法。`RegexConstrainedString`换句话说，我会将这一行添加到 Password 类中：

```
public static bool IsValueValid( string value ) {return IsValueValid( value.TrimEnd(), regex, min_length, max_length );} 
```

但是我不喜欢这样，因为我正在复制子类构造函数代码，必须记住再次修剪字符串并在必要时传递相同的最小/最大长度。这个要求将被强加于 RegexConstrainedString 的所有子类，这不是我想做的事情。像 Password 这样的数据类非常简单，因为 RegexConstrainedString 处理了大部分工作，实现了运算符、比较、克隆等。

此外，分解代码还有其他复杂性。验证涉及在实例中运行和存储正则表达式匹配，因为某些数据类型可能具有报告字符串特定元素的属性。例如，我的 SessionID 类包含像 TimeStamp 这样的属性，它从存储在数据类实例中的 Match 返回匹配的组。底线是这个静态方法是一个完全不同的上下文。由于它本质上与构造函数上下文不兼容，构造函数不能使用它，所以我最终会再次复制代码。

所以...**我可以通过复制验证代码并将其调整为静态上下文并对子类施加要求，或者我可以让事情变得更简单，只执行对象构造。分配的相对额外内存将是最小的，因为实例中只存储了一个字符串和匹配引用。无论如何，其他所有内容，例如 Match 和字符串本身仍将由验证生成，因此无法解决。** 我可以整天担心性能，但我的经验是*正确的*更重要的是，因为正确性通常会导致许多其他优化。例如，我不必担心流经我的应用程序的数据格式或大小不正确，因为只使用有意义的数据类型，这会强制验证从其他层进入应用程序的入口点，无论是数据库或用户界面。我 99% 的验证代码作为不再需要的工件被删除，我发现自己现在只检查空值。顺便说一句，已经到了这一点，我现在明白为什么包含空值是[十亿美元的错误](http://qconlondon.com/london-2009/presentation/Null+References:+The+Billion+Dollar+Mistake). 似乎是我唯一需要检查的东西了，即使它们在我的系统中基本上不存在。将这些数据类型作为字段的复杂对象不能用空值构造，但我必须在属性设置器中强制执行这一点，这很烦人，因为否则它们永远不需要验证代码......只有响应值变化而运行的代码.

更新：我模拟了CLR函数的双向调用，发现当所有数据都有效时，性能差异仅为每千次调用的几分之一毫秒，可以忽略不计。但是，当大约一半的密码无效时，在“实例化”版本中抛出异常，它会慢三个数量级，这相当于每 1000 次调用大约多 1 秒。差异的大小当然会成倍增加，因为对表中的多个列进行了多次 CLR 调用，但这对于我的项目来说是 3 到 5 倍。那么，我是否可以接受每 1000 次更新额外 3 到 5 秒，作为保持我的代码非常简单和干净的权衡？ **嗯，这取决于更新率。如果我的应用程序每秒获得 1000 次更新，那么 3 - 5 秒的延迟将是毁灭性的。另一方面，如果我每分钟或每小时获得 1000 次更新，那可能是完全可以接受的。** 在我的情况下，我现在可以告诉你它是完全可以接受的，所以我想我会使用实例化方法，并允许错误通过。当然，在这个测试中，我处理了 CLR 中的错​​误，而不是让 SQL Server 处理它们。将错误信息编组到 SQL Server，然后可能会返回到应用程序，这肯定会使事情变得更慢。我想我必须完全实现它才能获得真正的测试，但从这个初步测试来看，我很确定结果会是什么。

# c# - 将项目从 C# 迁移到 Java

> ID：740625
> 
> 赞同：11
> 
> 时间：2009-04-11T19:01:01.440
> 
> 标签：c#, java, porting, code-migration

随着办公室人员配置的一些变化，C# 专业知识水平急剧下降，现在有更多的 Java 开发人员。它已经到了高层正在考虑将用 C# 编写的现有 .NET 项目转移到 Java 世界的地步。

除了[**完全从头开始**](https://stackoverflow.com/questions/76622/rewrite-of-legacy-code)的明显问题之外，这家公司还有哪些可能的方法可以成功地将项目的开发从 .NET C# 迁移到 Java？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-11T19:36:32.340

以下是需要考虑的事项：

*   这是一个大项目吗？如果是，请尝试坚持使用 C#
*   这个中型项目是否包含组件？如果否，请尝试坚持使用 C#
*   这个小项目是不是只能部署在 Windows 上？如果是，请尝试坚持使用 C#
*   这是旧的源代码吗？如果是，请尝试坚持使用 C#
*   您是否使用 Windows 操作系统特定的 API？如果是，请尝试坚持使用 C#
*   您是否使用任何没有 Java 对应的第三方 API？如果是，请尝试坚持使用 C#
*   您是否在“深度”（数据绑定、用户控件等）中使用 .Net？如果是，请尝试坚持使用 C#
*   迁移时间比获得新的/转换的 C# 人员更容易接受吗？如果不是，请尝试使用 C#
*   如果您要使用会更改表示的 Java 框架，您认为最终用户不会接受更改吗？如果是，请尝试坚持使用 C#
*   检查广告

如果您决定转换：

*   去每个组件
*   每层走
*   有很多测试
*   检查是否有工具可以帮助（无论帮助可能很小）迁移

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-11T19:17:31.590

只是为了补充 Brian 和 Eric 的观点，我想说，在我看来，为 Java 开发人员学习 C# 应该很简单。它们在概念上是非常相似的语言，我建议培训您的 Java 开发人员以获得一些 C# 技能，这样您就不会被迫进行迁移过程的麻烦。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-12T00:27:25.620

我同意 Joel 的观点，即[完全重写几乎总是一个错误](http://www.joelonsoftware.com/articles/fog0000000069.html)。其他海报是正确的：C# 和 Java 非常相似，任何有能力的 Java 开发人员都应该能够在几周或几个月内胜任 C#。这并不是说他们将成为专家。这需要更长的时间，但只要您有一些可以指导该过程的 C# 开发人员，那么您应该没问题。

如果不了解您的应用程序的具体细节：大小、应用程序的类型、行业等，就很难评论这种转换是一个好主意还是坏主意。

对于这样的转换，我会非常谨慎，因为以我的拙见，[C# 现在是一种比 Java 更现代的语言](https://stackoverflow.com/questions/610199/the-art-of-programming-java-vs-c/610261#610261)，我作为一个已经是 Java 开发人员十多年的人（自 1.0.2 /1.1 天）。

这并不是说 Java 不好。它不是。Sun 确实有一片乌云笼罩着它，并且近年来表现出不愿或无法推动该平台向前发展。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-11T20:26:41.627

不管涉及哪种语言，这家公司的管理听起来很疯狂。除了一个微不足道的应用程序之外，从头开始重写整个代码库而不是仅仅雇用一个具有一定语言技能的人，这在经济上是如何明智的呢？这是一家有众所周知的问题的企业：多余的现金吗？！

现有代码开发了多长时间？如果它刚刚开始，我可以理解这一点。如果它已经发布并且有活跃用户，那么丢弃它是*没有意义的。*如果您将 C# 代码捐赠给具有正确技能的初创公司，请考虑一下他们对您的领先优势。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-11T20:54:52.370

在完成将 .NET 项目转换为 Java 之前，所有参与转换项目的 Java 开发人员都将学习 C#。因此，您不再需要将其转换为 Java（并且您可以丢弃在转换中生成的所有 Java 代码），因为现在您拥有一个可以同时使用 Java 和 C# 的开发团队。问题解决了。:D

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-11T19:04:50.607

如果有任何组件已经被隔离或其中任何一个使用面向服务的架构，您可以想象一次迁移一个组件（其中每个单独的组件都是重写）并且仍然让组件使用相同的组件相互通信可互操作的网络协议。可能取决于我们正在谈论的应用程序类型。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-11T19:10:33.133

确保你有**大量的测试**，因为这样的迁移会在你最不期望的地方咬你。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-11T19:16:50.983

您在生产中是否有更多 .Net 或更多 Java 应用程序。如果您已经对 .Net 服务器和应用程序进行了大量投资，为什么不要求 Java 开发人员中的志愿者迁移到 .Net？语言和语法非常相似，所以难的部分是学习框架，除非他们将所有时间都花在 UI 开发上，否则即使学习框架也不是那么难。

在我们的办公室里，我们有许多非常优秀的开发人员，他们根据需要在 Java 和 .Net 之间来回切换。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-11T19:48:23.667

为了向管理层证明，你总是需要谈论投资回报率和数字。向他们表明，如果您移动这些应用程序，这将花费大量时间和 QA 资源，并且如果由于某些其他项目或新开发的重要性而被取消优先级，则很容易退居二线。

当我向他们展示时间表、投资回报率、所涉及的工作、所涉及的资金等时，我取得了成功。

所以现在进入实际点，我确实认为 Java 开发人员将能够支持 C#，除非他们对 Microsoft 技术有一些基本的心理障碍。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-11T19:48:33.387

看看[Net2Java](https://net2java.dev.java.net/DNJGuide.html)，它可以帮助您将代码从 C# 转换为 Java。我怀疑它会是完美的，但它是一种从任务中消除大量苦差事的方法，让您摆脱不兼容的框架调用和语言特性的问题。

完成此操作后，您的任务就像任何其他大型迁移项目一样 - 测试、测试和再次测试。单元测试、系统集成测试，然后是最终用户测试。您应该已经拥有与原始应用程序一起使用的那些测试，除了单元测试之外，它们仍然是相关的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-12T23:53:54.600

如果决定这样做，您很可能会从混合方法中受益，您可以在同一个应用程序中基本上混合 C# 和 Java，因为它会将场景从瀑布转换变为逐步迁移。在这里，我知道两种可能性：

1) ikvm ( [http://www.ikvm.net/](http://www.ikvm.net/) )，它允许您在 .NET 运行时运行 Java 代码。这允许 Java 代码调用 C# 代码，反之亦然。然后您可以冻结 C# 代码开发，并在保留功能应用程序的同时将修改后的功能慢慢添加到 Java 部分。

2) Mainsoft ( [http://dev.mainsoft.com/Default.aspx?tabid=130](http://dev.mainsoft.com/Default.aspx?tabid=130) ) 允许您将 .NET 字节码编译成 Java 字节码。他们有一个免费的入门版本。我没有使用该产品的经验，但他们在我们只有 Java 的平台上做了大量广告。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-11T19:37:12.273

我不是 Java 专家，但根据我作为 C# 粉丝使用 Java 代码的经验，以下是一些可能令人头疼的问题：

*   泛型在 Java 和 C# 中的实现方式不同。
*   Java 和 C# 的装箱/拆箱行为不同
*   Java 类命名约定 + 大量 C# 生成的代码
*   根据移植的 Java/C# 代码的质量，字符串处理（即 Unicode/ASCII 问题）可能会出现问题。

就个人而言，我不认为从头开始写作是一个坏主意。因为你已经有了一个工作架构。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-11T20:17:22.023

我有点惊讶，甚至没有人提出拒绝移民的想法。

我不相信 C# 开发人员可以被迫切换到 Java（反之亦然），因为他被告知（好吧，如果他受到枪威胁，那么可能）。我需要花费大量时间、锻炼和热情来掌握至少一种技术堆栈。您不能一夜之间就开始使用新技术并期望提供相同的质量。

在被告知开始迁移之前，我个人不会打扰。那时我会告诉经理我是 .NET 人，不会仅仅因为他们决定改用另一种技术。

至于技术方面，不同的不是语言语法，而是库及其特性。当然，如果 .NET 3.5 的所有最新的花里胡哨的东西都已被广泛使用，那么语言差异将为您带来真正的挑战。

这当然是一种有趣的方式，只需决定将应用程序从 .NET 迁移到 Java。有人不知道所涉及的麻烦...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-12-14T00:09:40.367

可能你可以使用[jni4net - 开源网桥](http://jni4net.sf.net/)？或我知道的[其他选项列表。](http://jni4net.sourceforge.net/links.shtml)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-25T05:38:28.327

我意识到这是一个老问题，但对于其他走这条路的人，你可以试试这个开源 C# 到 Java 转换器：

[http://www.cs2j.com/](http://www.cs2j.com/)

# iphone - 如何播放特定频率和框架未找到 AudioUnit 问题的声音

> ID：740627
> 
> 赞同：1
> 
> 时间：2009-04-11T19:03:25.053
> 
> 标签：iphone

如何播放特定频率和框架未找到 AudioUnit question1 的声音。我想播放特定频率的声音。谁能告诉我应该为此目的使用哪个功能。

2.AudioUnit Framworks中无法使用iPhone SDK。编译时，出现如下错误。

Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/gcc-4.0-arch i386-isysroot/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.1.sdk -L/Users/gl/Desktop/BY /Apps/t5/build/Debug-iphonesimulator -F/Users/gl/Desktop/BY/Apps/t5/build/Debug-iphonesimulator-filelist/Users/gl/Desktop/BY/Apps/t5/build/t5\. build/Debug-iphonesimulator/t5.build/Objects-normal/i386/t5.LinkFileList-mmacosx-version-min = 10.5-framework Foundation-framework UIKit-framework CoreGraphics-framework AudioUnit-o / Users / gl / Desktop / BY / Apps/t5/build/Debug-iphonesimulator/t5.app/t5 ld：找不到框架AudioUnit collect2：ld返回1退出状态

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-30T12:09:43.810

即使我遇到同样的问题，也可以使用 AudioToolBox 而不是 AudioUnit。它通过使用audiotoolbox解决了。对于播放频率检查此代码“/Developer/Examples/CoreAudio/SimpleSDK/DefaultOutputUnit”和 [http://atastypixel.com/blog/2008/11/04/using-remoteio-audio-unit/](http://atastypixel.com/blog/2008/11/04/using-remoteio-audio-unit/)

我也在做同样的事情。希望对您有所帮助。

# python - SQLAlchemy 多对多孤儿删除

> ID：740630
> 
> 赞同：9
> 
> 时间：2009-04-11T19:07:17.683
> 
> 标签：python, sqlalchemy

我正在尝试使用 SQLAlchemy 来实现一个基本的用户组模型，其中用户可以有多个组，组可以有多个用户。

当一个组变为空时，我希望删除该组（以及与该组相关的其他内容。幸运的是，SQLAlchemy 的级联可以很好地处理这些更简单的情况）。

问题是 cascade='all, delete-orphan' 不完全符合我的要求；当组为空时，它不会删除组，而是在*任何*成员离开组时删除组。

向数据库添加触发器可以很好地在组变为空时删除组，但触发器似乎绕过了 SQLAlchemy 的级联处理，因此与组关联的内容不会被删除。

当所有成员都离开并将此删除级联到相关实体时，删除组的最佳方法是什么。

我知道我可以通过在我的代码中找到用户可以离开组的每个位置然后执行与触发器相同的操作来手动执行此操作但是，我担心我会错过代码中的位置（而且我懒惰的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-18T10:29:31.813

我通常处理此问题的方式是在您的用户或组上设置一个名为 leave_group 的函数。当您希望用户离开组时，您调用该函数，您可以在其中添加任何您想要的副作用。从长远来看，这使得添加越来越多的副作用变得更加容易。（例如，当您要检查是否允许某人离开组时）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T22:00:12.727

我想你想要`cascade='save, update, merge, expunge, refresh, delete-orphan'`。这将防止“删除”级联（您从“全部”获得）但保持“删除孤儿”，这是您正在寻找的，我认为（当没有更多父母时删除）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T18:15:16.487

大约 3 个月前我遇到了同样的问题，我有一个帖子/标签关系，想删除未使用的标签。我在 irc 上问过，SA 的作者告诉我不支持多对多关系的级联，这是有道理的，因为在多对多中没有“父级”。

但是扩展 SA 很容易，您可以使用[AttributeExtension](http://www.sqlalchemy.org/docs/05/reference/orm/interfaces.html)来检查从用户中删除组时是否为空并从那里删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T08:48:37.403

您可以发布您的表格和映射器设置的示例吗？可能更容易发现正在发生的事情。

不看代码很难说，但也许关系的方向有问题？

# c# - C# Regex Split - 方括号内的所有内容

> ID：740642
> 
> 赞同：40
> 
> 时间：2009-04-11T19:13:02.347
> 
> 标签：c#, regex, split

我目前正在尝试在 C#（最新的 .NET 和 Visual Studio 2008）中拆分字符串，以便检索方括号内的所有内容并丢弃剩余的文本。

例如：*“H1 受体拮抗剂 [HSA:3269] [PATH:hsa04080(3269)]”*

在这种情况下，我有兴趣将“ **HSA:3269** ”和“ **PATH:hsa04080(3269)** ”放入字符串数组中。

如何做到这一点？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-04-11T19:17:21.557

`Split`在这里帮不了你；你需要使用正则表达式：

```
// using System.Text.RegularExpressions;
// pattern = any number of arbitrary characters between square brackets.
var pattern = @"\[(.*?)\]";
var query = "H1-receptor antagonist [HSA:3269] [PATH:hsa04080(3269)]";
var matches = Regex.Matches(query, pattern);

foreach (Match m in matches) {
    Console.WriteLine(m.Groups[1]);
} 
```

产生你的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-07T15:38:30.563

试试这个

```
string mystr = "Hello my name is  {robert} and i live in  {florida}";

List<string> myvariables = new List<string>();
while (mystr.Contains("{"))
{
    myvariable.Add(mystr.Split('{', '}')[1]);
    mystr = mystr.Replace("{" + mystr.Split('{', '}')[1] + "}", "");
}; 
```

这样，我将拥有一个包含 robert 和 florida 的数组。

# php - 无法在 jQuery 中获取可拖动 div 的 ID（使用 jQuery UI）

> ID：740644
> 
> 赞同：1
> 
> 时间：2009-04-11T19:15:18.490
> 
> 标签：php, javascript, jquery, html

由于某种原因，下面的脚本无法使用 获取可拖动 div 的 id `attr('id')`，但它适用于页面上的其他静态元素。我对为什么这行不通感到非常困惑，如果有人对我有解决方案，我将不胜感激。

```
$(document).ready(function(){
    //$(".draggable").draggable();
    $(".draggable").draggable({ containment: '#container', scroll: false });
    $(".draggable").draggable({ stack: { group: '#container', min: 1 } });

    $("*", document.body).click(function (e) {
        var offset = $(this).offset();// get the offsets of the selected div
        e.stopPropagation();
        var theId = $(this).attr('id');// get the id of the selceted div
        $("#result").text(this.tagName + " id=" + theId + " (" + offset.left + "," + offset.top +")");
        $.post("http://localhost/index.php", "id=" + theId + "&x=" + offset.left + "&y=" + offset.top); //post x,y to php (and the id of the elemnt)
    });

    var req = function () {
        $.ajax({
            url: "out.php",
            cache: false,
            success: function(html){
                $("#stuff").empty().append(html);
                var css_attr = html.split(",");
                $('#1').css('left', css_attr[0] + 'px').css('top', css_attr[1] + 'px');
            },
            complete: function(){
                req();
            }
        });
    };
    req();
}); 
```

注意：此脚本依赖于以下 JavaScript 源。

*   jQuery.js
*   [http://jqueryui.com/latest/ui/ui.core.js](http://jqueryui.com/latest/ui/ui.core.js)
*   [http://jqueryui.com/latest/ui/ui.draggable.js](http://jqueryui.com/latest/ui/ui.draggable.js)
*   [http://jqueryui.com/latest/ui/ui.droppable.js](http://jqueryui.com/latest/ui/ui.droppable.js)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-12-17T11:06:28.177

目前，您正在将单击处理程序附加到DOM 中的*所有*元素`*`（非常*非常*糟糕，**不要这样做！**），包括那些可拖动对象中的 *任何子元素。*

您正在使用 正确地阻止事件冒泡[`.stopPropagation()`](http://api.jquery.com/event.stopPropagation/)，但它可能是您单击的 a 的子级，而不是可拖动的本身*。*`.draggable`你想要的实际上是监听`.draggable`元素本身，如下所示：

```
$(".draggable").click(function (e) {
    var offset = $(this).offset(), 
        theId = this.id;
    e.stopPropagation();
    $("#result").text(this.tagName + " id=" + theId + " (" + offset.left + "," + offset.top +")");
    $.post("http://localhost/index.php", { id: theId, x: offset.left, y: offset.top });
}); 
```

此处的其他更改`id`可以通过直接访问[`this.id`](https://developer.mozilla.org/en/DOM/element.id)，并且将对象传递[`$.post()`](http://api.jquery.com/jQuery.post/)给序列化更安全，就像我在上面所做的那样。

即使上述内容并不*完全*存在，您可能希望在*停止*拖动时发送位置，通过更改此：

```
$(".draggable").click(function (e) { 
```

对此：

```
$(".draggable").bind("dragstop", function (e) { 
```

...或在较新版本的 jQuery (1.4.2+) 中：

```
$(document.body).delegate(".draggable", "dragstop", function (e) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T14:30:24.430

这似乎很明显，但您确定您选择的所有元素实际上都有 ID。如果您包含所有内容（带有 *），那么某些元素可能没有 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T22:19:21.993

您的点击功能在测试页面上对我有用。出于好奇，如果将“e.stopPropogation()”行移动到点击函数的底部，它的行为会有所不同吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T00:16:08.470

小心使用 *，你知道，all 意味着 all，如果你有`<div><p><span><a></a></span></p></div>`它意味着动作被设置到每一个元素。我会指定应该受你的函数影响的类或标签，以确保你得到你想要被点击的东西。

尝试用你认为它的 ID 没有得到的对象替换你的代码，看看它是否有效..

# jquery - ajax加载选项卡后的回调

> ID：740652
> 
> 赞同：5
> 
> 时间：2009-04-11T19:18:38.450
> 
> 标签：jquery, jquery-ui, jquery-ui-tabs

如何将一些代码应用于 ajax 加载选项卡的内容？我尝试在加载的内容中使用 $(document).ready ，但这阻止了 css 样式的加载（不知道为什么）。

有回调函数吗？我应该以其他方式在加载的文档中使用 $(document).ready 和样式吗？

如果在加载的文档中使用 $(document).ready 很好，我是否还应该在其中包含对 jquery 及其插件的引用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-11T19:33:37.010

您是否尝试过[加载事件](http://jqueryui.com/demos/tabs/#event-load)？加载选项卡的内容时，应该称呼这一点。

通常，您不应将加载的元素视为新页面并调用 $(document).ready。这不是一个新页面，而是添加到 DOM 中的一些新元素。所有 ajax 方法都有一个回调方法，当数据成功加载时会被调用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T19:31:05.847

您使用什么代码通过 ajax 加载内容？如果您使用 jQuery 命令[`load`](http://docs.jquery.com/Ajax/load)或[`ajax`](http://docs.jquery.com/Ajax)然后我建议将您的代码放在回调函数中。例如，使用`load`

```
$('#myUITab').load('anotherPage.html', function() {

    // put the code you need to run when the load completes in here

}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-17T05:34:46.703

jQuery UI "Tabs" 提供回调方法。看看下面！

```
$( "#tabs" ).tabs({
    ajaxOptions: {
        error: function( xhr, status, index, anchor ) {
            $( anchor.hash ).html(
                "error occured while ajax loading.");
        },
        success: function( xhr, status ) {
            //alert("ajax success. ");    //your code
        }
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-06T13:54:12.277

另一种方法是使用 ajaxComplete：

```
$("#loading_comtainer").ajaxComplete(function( event,request, settings ){
   alert("ajaxCompleted");
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-07T15:52:55.317

您可以使用 tabsload 事件[http://jqueryui.com/demos/tabs/#event-load](http://jqueryui.com/demos/tabs/#event-load)

在下面的示例中查看它是如何工作的：

```
$('#nav_tabs').tabs({
    select: function(event, ui){
        var url = $.data(ui.tab, 'load.tabs');
        if (url == '?ak=/account/logout') { 
            //exclude the logout from using ajax
            location.href = url;
            return false;
        }
        return true;
    },
}).bind('tabsload',function(event, ui){
    alert('The tab is loaded. What now?');
}); 
```

# php - 我可以在不使用 javascript 的情况下获取 document.cookie 吗？在 PHP 中替代

> ID：740657
> 
> 赞同：1
> 
> 时间：2009-04-11T19:24:10.857
> 
> 标签：php, cookies

我正在做某事，但我不能在其中使用 JavaScript。

我想获取 cookie 但不使用 javascript。

但我想获得与 相同的输出`document.cookie`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-11T19:27:15.357

`$_COOKIE['cookie_name']`在 PHP 中使用。

[`$_COOKIE`](http://www.php.net/manual/en/reserved.variables.cookies.php)是一个包含所有 cookie 的数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T20:37:39.900

您无法获得与 document.cookie 中相同的输入，但您可以像 macaco 所说的那样从 $_COOKIE 直接访问它们

如果需要设置 cookie，可以使用 php 中的 setcookie() 方法

[http://www.php.net/setcookie](http://www.php.net/setcookie)

干杯

# c# - 对象初始化器和构造器有什么区别？

> ID：740658
> 
> 赞同：193
> 
> 时间：2009-04-11T19:24:12.353
> 
> 标签：c#, .net, constructor, object-initializer

两者之间有什么区别，什么时候使用“对象初始化器”而不是“构造器”，反之亦然？如果这很重要，我正在使用 C#。此外，对象初始值设定项方法是否特定于 C# 或 .NET？

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2009-04-11T19:42:34.897

对象初始化器是添加到 C# 3 中的东西，以便在您使用对象时简化对象的构造。

构造函数运行，给定 0 个或多个参数，用于在调用方法获取所创建对象的句柄*之前*创建和初始化对象。例如：

```
MyObject myObjectInstance = new MyObject(param1, param2); 
```

在这种情况下， 的构造函数`MyObject`将使用值`param1`和运行`param2`。这些都用于`MyObject`在内存中创建新的。创建的对象（使用这些参数设置）被返回，并设置为`myObjectInstance`.

通常，让构造函数需要完整设置对象所需的参数被认为是一种很好的做法，这样就不可能在无效状态下创建对象。

但是，通常可以设置“额外”属性，但不是必需的。这可以通过重载的构造函数来处理，但会导致有很多在大多数情况下不一定有用的构造函数。

这导致了对象初始化器 - 对象初始化器允许您在对象构造*之后*设置属性或字段，但*在*您可以使用它之前。例如：

```
MyObject myObjectInstance = new MyObject(param1, param2)
{
    MyProperty = someUsefulValue
}; 
```

这将与您执行此操作的行为大致相同：

```
MyObject myObjectInstance = new MyObject(param1, param2);
myObjectInstance.MyProperty = someUsefulValue; 
```

但是，在*多线程*环境中，对象初始化程序的原子性可能是有益的，因为它可以防止对象处于未完全初始化的状态（有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/12842511/2822719 "使用对象初始化器有什么好处吗？ - 最佳答案")） - 它可以为 null 或按您的意图进行初始化。

此外，对象初始化器更易于阅读（尤其是当您设置多个值时），因此它们为您提供与构造函数上的许多重载相同的好处，而无需使该类的 API 复杂化的许多重载。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-04-11T19:27:20.490

构造函数是在类型上定义的方法，它接受指定数量的参数，用于创建和初始化对象。

对象初始化程序是在构造函数之后在对象上运行的代码，可用于简洁地将对象上的任意数量的字段设置为指定值。这些字段的设置发生**在**调用构造函数之后。

如果构造函数充分设置了对象的初始状态，则可以在没有对象初始值设定项的帮助下使用构造函数。然而，对象初始值设定项必须与构造函数一起使用。该语法要求显式或隐式使用（VB.Net 和 C#）构造函数来创建初始对象。当构造函数没有充分初始化对象以供您使用并且一些简单的字段和/或属性集将使用时，您将使用对象初始化器。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2013-05-31T06:04:24.530

当你这样做

```
Person p = new Person { Name = "a", Age = 23 }; 
```

这就是对象初始化器本质上所做的：

```
Person tmp = new Person(); //creates temp object calling default constructor
tmp.Name = "a";
tmp.Age = 23;
p = tmp; 
```

现在这促进了这样[的](https://stackoverflow.com/a/16209150/661933)行为。了解对象初始化器的工作原理很重要。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-04-11T19:33:40.973

如果您必须在对象上设置属性才能使其正常工作，一种方法是只公开一个需要这些强制属性作为参数的构造函数。

在这种情况下，如果不指定这些必需属性，您将无法创建对象。对象初始化器无法强制执行类似的操作。

对象初始化器实际上只是缩短初始分配的“语法便利”。不错，但在功能上并不是很相关。

马克

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-11T19:32:50.927

构造函数是一种（可能）接受参数并返回类的新实例的方法。它可能包含初始化逻辑。下面你可以看到一个构造函数的例子。

```
 public class Foo
{
    private SomeClass s;
    public Foo(string s)
    {
       s = new SomeClass(s);
    }
} 
```

现在考虑以下示例：

```
 public class Foo
{
    public SomeClass s { get; set; }
    public Foo() {}
} 
```

您可以使用对象初始化程序获得与第一个示例相同的结果，假设您可以使用以下代码访问 SomeClass：

```
 new Foo() { s = new SomeClass(someString) } 
```

如您所见，对象初始化器允许您在执行构造的同时为公共字段和公共（可设置）属性指定值，这在构造函数不提供任何重载初始化某些字段时特别有用。但是请注意，对象初始化器只是语法糖，编译后与一系列赋值并没有真正的区别。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-10T09:39:22.790

对象初始化器可用于初始化一些小集合，这些集合可用于在初始程序创建阶段进行测试。代码示例如下：

```
 class Program
    {
        static void Main(string[] args)
        {
            List<OrderLine> ordersLines = new List<OrderLine>()
            {
                new OrderLine {Platform = "AmazonUK", OrderId = "200-2255555-3000012", ItemTitle = "Test product 1"},
                new OrderLine {Platform = "AmazonUK", OrderId = "200-2255555-3000013", ItemTitle = "Test product 2"},
                new OrderLine {Platform  = "AmazonUK", OrderId = "200-2255555-3000013", ItemTitle = "Test product 3"}
            };
        }
    }
    class OrderLine
    {
        public string Platform { get; set; }
        public string OrderId { get; set; }
        public string ItemTitle { get; set; }
    } 
```

这是问题所在。在上面的代码示例中没有包含任何构造函数并且它可以正常工作，但是如果某些带参数的构造函数将包含在 OrderLine 类中，例如：

```
public OrderLine(string platform, string orderId, string itemTitle)
{
   Platform = platform;
   OrderId = orderId;
   ItemTitle = itemTitle;
} 
```

编译器将显示错误 - 没有给出与所需形式参数相对应的参数……。可以通过在 OrderLine 类中包含不带参数的显式默认构造函数来修复它：

```
public OrderLine() {} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-10T09:01:17.340

对象初始值设定项在 LINQ 查询表达式中特别有用。查询表达式经常使用匿名类型，只能使用对象初始化器来初始化，如下面的代码示例所示：`

```
var orderLineReceiver = new { ReceiverName = "Name Surname", ReceiverAddress = "Some address" }; 
```

更多关于它 -[对象和集合初始化器](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/object-and-collection-initializers)

# scala - 为什么空字符串与 Seq.empty 不匹配？

> ID：740660
> 
> 赞同：2
> 
> 时间：2009-04-11T19:26:11.490
> 
> 标签：scala, pattern-matching, sequence

**编辑：这是很久以前在 Scala 2.8 及更高版本中修复的旧错误**

在围绕问题[Pattern 将 String 匹配为 Seq[Char] 的](https://stackoverflow.com/questions/740563/pattern-matching-a-string-as-seqchar)一些实验中，我遇到了另一个奇怪的匹配现象。考虑以下将字符串视为字符序列的代码：

```
def %%&#(input: String) : String =  {
    val uha : Seq[Char] = input
    uha match {
        case Seq() => "Empty"
        case Seq(first @ _, 'o', 'o')  => "Bar"
        case _ => "Oh" 
    }
} 
```

正确调用空字符串上的输入会`""`产生`"Empty"`.

但是，如果我将第一个匹配子句重写为

```
case Seq.empty => "Empty" 
```

的匹配`""`失败并匹配默认子句。

浏览 Scala 库源代码（在理想的世界中你不应该这样做:-)）我相信两者`Seq()`都会`Seq.empty`导致`RandomAccessSeq.empty`. 显然，这与上述现象不符，因为只`Seq()`匹配空字符串。

更新：经过进一步的实验，这个问题可以缩小到以下几点：

```
val list = List()
   >>> list2: List[Nothing] = List()
val emptySeq = Seq.empty
list == emptySeq
   >>> res1: Boolean = false 
```

这基本上意味着空`Seq`不会自动等于`Seq.empty`。因此，当与常量匹配时（而不是使用 starblue 建议的提取器），这种不等式会导致匹配失败。将空解释`String`为序列时也是如此。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-11T23:56:08.767

这似乎是库中的一个错误。你想提交错误还是我应该？

```
scala> Seq.empty  match {case Seq() => "yup"; case _ => "nope"}
res0: java.lang.String = yup

scala> Seq()  match {case Seq.empty => "yup"; case _ => "nope"}
res1: java.lang.String = yup

scala> ("" : Seq[Char]) match {case Seq() => "yup"; case _ => "nope"}    
res2: java.lang.String = yup

scala> ("" : Seq[Char]) match {case Seq.empty => "yup"; case _ => "nope"}
res3: java.lang.String = nope 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T20:16:40.837

在匹配中使用了 unapply 或 unapplySeq 函数，而不是您似乎相信的 apply。

# vim - 将隐藏缓冲区设置为“nobuflisted”

> ID：740673
> 
> 赞同：2
> 
> 时间：2009-04-11T19:37:03.447
> 
> 标签：vim

如何从 vim 脚本中将隐藏缓冲区设置为“nolisted”？
我试过：
`call setbufvar(2, 'buflisted', 1)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T22:12:08.643

您必须在 'buflisted' 中添加 & 符号以向 Vim 显示这是选项：

```
call setbufvar(2, '&buflisted', 1) 
```

# security - 内部信用卡处理的安全证书有多重要？

> ID：740679
> 
> 赞同：1
> 
> 时间：2009-04-11T19:40:21.283
> 
> 标签：security, https

在我工作的地方，我们在 Intranet 上有一个电子商务系统，用于处理客户的信用卡。目前，当我们使用 Authorize.net 向客户的信用卡收费时，我们不会通过安全连接将信用卡信息发送到 Authorize.net。相反，它超越了常规的 http。我想得到其他关于这有多严重/疏忽的意见。谢谢。

**编辑**：看起来我错了。我窥探了代码，看起来它正在处理[https://secure.authorize.net](https://secure.authorize.net)上的信用卡。但是，输入信用卡的网页并不安全。这与我最初描述的情况不同。对于那个很抱歉。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-11T19:44:05.003

这似乎非常疏忽。信用卡信息泄露太多，不允许这种行为发生。

即使处理是在您的 Intranet 内部处理的，而不是发送给第 3 方，我还是建议使用安全连接。您不希望任何人，甚至是内部的、未经授权的员工都可以访问它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T20:06:01.923

我很困惑。您如何向 Authorize.net 发送纯 HTTP 请求？他们的交易端点没有 HTTP 版本——如果允许这样做，他们将犯有刑事过失。

* * *

现在您已经进行了编辑，事情变得更加清晰了。是的，将 Intranet 页面设置为 HTTP 而不是 HTTPS*仍然*存在安全风险，但远低于您最初提出的问题（公共 Internet 的未加密传输）。

由于它是内部的，因此您不需要付费 SSL 证书（如果成本是避免 HTTPS 的原因——我想不出任何其他好的理由）——您应该能够使用自签名证书。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T20:07:22.717

这非常重要，您所做的事情可能会导致一些严重的问题。

这也违反了 PCI 标准，每个处理信用卡信息的公司都必须遵循 PCI 标准，因此您可能会遇到一些法律问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-11T20:02:43.993

这绝对是一场彻头彻尾的灾难。您应该立即（我的意思是立即）至少使用传输级别的安全性 (SSL/TLS)，如果 Authorize.net 可以为其设置，那么消息级别的安全性也是如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-11T20:07:43.700

我建议阅读 OWASP 指南： [http](http://www.owasp.org/index.php/Category:OWASP_Guide_Project) ://www.owasp.org/index.php/Category:OWASP_Guide_Project （免费下载）

第 53 页及以后.. 获得了一些重要信息。

我会说，你正在做的是严重的疏忽，需要尽快排序..

# c++ - ABC 虚拟 OStream 插入运算符

> ID：740700
> 
> 赞同：2
> 
> 时间：2009-04-11T20:02:19.360
> 
> 标签：c++, virtual

考虑以下代码段：

```
struct ObjectInterface
{
    virtual ~ObjectInterface() {}
    virtual void Print(std::ostream& target) const = 0;
};

struct Foo : ObjectInterface
{
    virtual void Print(std::ostream& target) const
    {
        target << "Foo";
    }
};

struct Bar : ObjectInterface
{
    virtual void Print(std::ostream& target) const
    {
        target << "Bar";
    }
}; 
```

有什么办法可以更改`Print`为`ObjectInterface`标准的“ `std::ostream& operator<<`”输出类型？我不能让它工作。

编辑：我基本上是想弄清楚我是否可以`friend`使用`virtual`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T20:14:08.817

您需要一个免费功能：

```
ostream & operator << ( ostream & os, const ObjectInterface & oi ) {
    oi.Print( os );
    return os;
} 
```

# vb.net - 有没有更好的方法从 SQL DataAdapter 填充通用列表？

> ID：740709
> 
> 赞同：-1
> 
> 时间：2009-04-11T20:08:02.857
> 
> 标签：vb.net, generics, data-binding, activerecord

我有一个使用 Active Record 进行数据检索的现有应用程序。它在 VB.NET 中（我第一次做 VB.NET；我通常在 C# 中工作）。我正在构建一个方法来返回一个`List(Of T)`对象。

当前模式使用 a`SQLDataAdapter`来填充数据表。我可以在填充数据表时将记录添加到`List(Of T)`，但必须有更好的方法来做到这一点。

有任何想法吗？我没有结婚 using `SQLDataAdapter`，如果有更好的方法可以避免它......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T20:40:32.293

因为你还没有任何回应...

我自己没有使用过 Active Record，所以我不知道这会在什么时候产生任何影响，但让我印象深刻的是，读入 a`DataTable` *和*a`List<T>`有点重复。

如何填充`List<T>`from a`SqlDataReader`代替？当您使用 浏览结果`Read()`时，从当前行创建一个新对象并将其添加到列表中。如果您需要为各种不同的类型执行此操作，我会编写一个通用方法来执行此操作，如下所示：

```
public static List<T> ToList<T>(this SqlDataReader reader,
    Func<SqlDataReader, T> rowConverter)
{
    List<T> ret = new List<T>();
    while (reader.Read())
    {
        ret.Add(rowConverter(reader));
    }
    return ret;
} 
```

然后，您可以使用 lambda 表达式或匿名方法来实现转换器。

或者，您可以使扩展方法以命令为目标，而不是`SqlDataReader`- 它可以处理调用`ExecuteReader`、转换每一行，然后处理阅读器。

（这是一个有点奇怪的签名，因为它`SqlDataReader`同时代表迭代器*和*当前行；只是 API 的一个怪癖。）

不过，我可能遗漏了更深层次的东西-如果这没有帮助，您能否解释原因，也许是作为问题编辑？

# c - 是否可以在不复制的情况下删除大文件的两端？

> ID：740710
> 
> 赞同：3
> 
> 时间：2009-04-11T20:08:59.623
> 
> 标签：c, windows, file, disk

我想知道是否有可能使用 Windows 和 c++ 获取一个大型视频文件（长度为几千兆字节）并“就地”删除它的前几百兆字节和最后几百兆字节。

将有用数据复制到新文件的传统方法通常需要 20 分钟以上看似不必要的复制。

有什么聪明的东西可以用磁盘在低级别完成以实现这一点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T20:23:34.580

当然，理论上是可以的。但是，如果您的文件系统是 NTFS，请准备好花*几个月的时间*来了解您需要更新的所有数据结构。（所有这些都是官方无证的顺便说一句。）

此外，您还需要

1.  以某种方式卸载卷并进行更改；或者
2.  了解如何编写内核文件系统驱动程序、从 MS 购买许可证、开发驱动程序并使用它来更改实时文件系统。

如果您的文件系统是 FAT32 之类的更简单的文件系统，这会更容易一些。但无论哪种方式：简而言之，这*可能*是可能的，但即使是这样，你的生命也会花费数年时间。我的建议：不要打扰。

相反，**看看你可以解决问题的其他方法**：例如，通过使用[avisynth](http://www.avisynth.org/)脚本来只提供来自你感兴趣的区域的帧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-11T20:17:52.520

您是否希望只是在目录条目中摆弄扇区地址？几乎无法想象这个计划会奏效。

首先，它要求您希望删除的数据量恰好是扇区大小。考虑到一开始可能有一些标题数据必须保留在那里，这不太可能。

即使它满足这些要求，也需要进行低级修改，Windows 会非常努力地阻止您这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T20:32:45.900

也许您的文件格式允许“跳过”字节，以便您可以简单地覆盖（即使用内存映射）必要的部分。当然，这仍然会不必要地占用大量磁盘空间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-11T01:54:31.903

Yes, you can do this, on NTFS.

The end you remove with `SetFileLength`.

The beginning, or any other large consecutive region of the file, you overwrite with zeros. You then [mark the file "sparse"](https://stackoverflow.com/questions/4011508/how-to-create-a-sparse-file-on-ntfs), which allows the file system to reclaim those clusters.

Note that this won't actually change the offset of the data relative to the beginning of the file, it only prevents the filesystem from wasting space storing unneeded data.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-11T20:41:47.953

Even if low level filesystem operations were easy, editing a video file is not simply a matter of deleting unwanted megabytes. You still do have to consider concepts such as compression, frames, audio and video muxing, media file containers, and many others...

Your best solution is to simply accept your idle twenty minutes.

# jquery - 使用 jquery，我可以获得特定元素的 X 和 Y 偏移量吗？

> ID：740712
> 
> 赞同：3
> 
> 时间：2009-04-11T20:11:51.897
> 
> 标签：jquery

使用 jquery，我可以获得特定元素的 X 和 Y 偏移量吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T20:15:35.317

相对于什么？它的父母？文件？

[CSS/position](http://docs.jquery.com/CSS/position)获取元素相对于其偏移父元素的顶部和左侧位置。

[CSS/offset](http://docs.jquery.com/CSS/offset)获取第一个匹配元素的当前偏移量，以像素为单位，相对于文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T20:14:25.663

请参阅[http://docs.jquery.com/CSS/offset](http://docs.jquery.com/CSS/offset)。

# python - Python中的动态过程

> ID：740717
> 
> 赞同：6
> 
> 时间：2009-04-11T20:15:47.377
> 
> 标签：python, multithreading, multiprocessing

我有一个关于 Python 多处理的问题。我正在尝试获取数据集，分成块，然后将这些块传递给同时运行的进程。我需要使用简单的计算来转换大型数据表（例如，电阻 -> 热敏电阻的温度）。

下面列出的代码几乎可以按预期工作，但它似乎没有产生任何新进程（或者如果一次只有一个）。

```
from multiprocessing import Process

class Worker(Process):
    # example data transform
    def process(self, x): return (x * 2) / 3

    def __init__(self, list):
        self.data = list
        self.result = map(self.process, self.data)
        super(Worker, self).__init__()

if __name__ == '__main__':
    start = datetime.datetime.now()
    dataset = range(10000) # null dataset
    processes = 3

    for i in range(processes):
        chunk = int(math.floor(len(dataset) / float(processes)))

        if i + 1 == processes:
            remainder = len(dataset) % processes
        else: remainder = 0

        tmp = dataset[i * chunk : (i + 1) * chunk + remainder]
        exec('worker'+str(i)+' = Worker(tmp)')
        exec('worker'+str(i)+'.start()')

    for i in range(processes):
        exec('worker'+str(i)+'.join()')
        # just a placeholder to make sure the initial values of the set are as expected
        exec('print worker'+str(i)+'.result[0]') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T20:53:34.027

您还没有覆盖该`run`方法。进程（或线程）有两种方法可以让它执行代码：

1.  创建进程指定目标
2.  子类化过程，覆盖`run`方法。

压倒`__init__`一切只是意味着您的流程已经装满无处可去。它应该被用来赋予它执行它需要执行的任务所需的属性，但它不应该指定要执行的任务。

在您的代码中，所有繁重的工作都在这一行中完成：

```
exec('worker'+str(i)+' = Worker(tmp)') 
```

这里什么也没做：

```
exec('worker'+str(i)+'.start()') 
```

所以检查结果`exec('print worker'+str(i)+'.result[0]')`应该会给你一些有意义的东西，但这只是因为你想要执行的代码*已经*执行了，但是在进程构建时，而不是在进程启动时。

试试这个：

```
class Worker(Process):
    # example data transform
    def process(self, x): return (x * 2) / 3

    def __init__(self, list):
        self.data = list
        self.result = []
        super(Worker, self).__init__()

    def run(self):
        self.result = map(self.process, self.data) 
```

编辑：

好吧...所以我只是根据我的穿线直觉在这里飞行，他们都错了。我们都对流程不了解的是，您不能直接共享变量。无论您传递给新进程以启动什么，都会被读取、复制并永远消失。除非您使用两种标准方法之一来共享数据：[队列和管道](http://docs.python.org/library/multiprocessing.html#exchanging-objects-between-processes)。我已经尝试了一些尝试让您的代码正常工作，但到目前为止还没有运气。我认为这会让你走上正确的轨道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T05:20:54.220

无需向每个进程发送块数，只需使用 get_nowait() 并处理最终的 Queue.Empty 异常。每个进程都会获得不同数量的 CPU 时间，这应该让它们都处于忙碌状态。

```
import multiprocessing, Queue

class Worker(multiprocessing.Process):
    def process(self, x): 
        for i in range(15):
            x += (float(i) / 2.6)
        return x

    def __init__(self, input, output):
        self.input = input
        self.output = output
        super(Worker, self).__init__()

    def run(self):
        try:
            while True:
                self.output.put(self.process(self.input.get_nowait()))
        except Queue.Empty:
            pass

if name == 'main':
    dataset = range(10)
    processes = multiprocessing.cpu_count()
    input = multiprocessing.Queue()
    output = multiprocessing.Queue()

    for obj in dataset:
        input.put(obj)
    for i in range(processes):
        Worker(input, output).start()

    for i in range(len(dataset)):
        print output.get() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T04:25:52.777

好的，所以看起来列表不是线程安全的，我已经开始使用队列（尽管它看起来要慢得多）。这段代码基本上完成了我想做的事情：

```
import math, multiprocessing

class Worker(multiprocessing.Process):
    def process(self, x): 
        for i in range(15):
            x += (float(i) / 2.6)
        return x

    def __init__(self, input, output, chunksize):
        self.input = input
        self.output = output
        self.chunksize = chunksize
        super(Worker, self).__init__()

    def run(self):
        for x in range(self.chunksize):
            self.output.put(self.process(self.input.get()))

if __name__ == '__main__':
    dataset = range(10)
    processes = multiprocessing.cpu_count()
    input = multiprocessing.Queue()
    output = multiprocessing.Queue()

    for obj in dataset:
        input.put(obj)

    for i in range(processes):
        chunk = int(math.floor(len(dataset) / float(processes)))
        if i + 1 == processes:
            remainder = len(dataset) % processes
        else: remainder = 0

        Worker(input, output, chunk + remainder).start()

    for i in range(len(dataset)):
        print output.get() 
```

# sql-server-2005 - 用于汇总 sql server 2005 中不同列中的值的查询

> ID：740724
> 
> 赞同：1
> 
> 时间：2009-04-11T20:21:10.623
> 
> 标签：sql-server-2005

我有列，即理论标记、实践标记、学生 ID、课程 ID 和主题 ID 我需要将列理论标记和实践标记中的值加起来才能获得汇总，我不知道如何添加列值尽管。我正在使用 sql server 2005

请帮忙

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-11T20:27:06.477

假设理论分数和实践分数是数字数据类型

```
SELECT
    student_id,
    course_id,
    subject_id,    
    SUM(theory_marks + practical_marks) AS overall_mark
FROM
    table
GROUP BY
    student_id, course_id, subject_id 
```

# php - 使用具有多个命名空间的 SimpleXML 解析 XML

> ID：740730
> 
> 赞同：15
> 
> 时间：2009-04-11T20:28:19.937
> 
> 标签：php, soap, namespaces, simplexml

我有这个丑陋的 XML，上面有很多命名空间，当我尝试用 simpleXML 加载它时，如果我指示第一个命名空间，我会得到一个 xml 对象，但是跟随带有其他命名空间的标签不会进入对象。

如何解析这个 XML？

```
<?xml version="1.0" encoding="UTF-8"?>
<soap-env:Envelope xmlns:soap-env="http://schemas.xmlsoap.org/soap/envelope/">
    <soap-env:Header>
        <eb:MessageHeader xmlns:eb="http://www.ebxml.org/namespaces/messageHeader" eb:version="1.0" soap-env:mustUnderstand="1">
            <eb:From>
                <eb:PartyId eb:type="URI">wscompany.com</eb:PartyId>
            </eb:From>
            <eb:To>
                <eb:PartyId eb:type="URI">mysite.com</eb:PartyId>
            </eb:To>
            <eb:CPAId>something</eb:CPAId>
            <eb:ConversationId>moredata.com</eb:ConversationId>
            <eb:Service eb:type="compXML">theservice</eb:Service>
            <eb:Action>theaction</eb:Action>
            <eb:MessageData>
                <eb:MessageId>a certain messageid</eb:MessageId>
                <eb:Timestamp>2009-04-11T18:43:58</eb:Timestamp>
                <eb:RefToMessageId>mid:areference</eb:RefToMessageId>
            </eb:MessageData>
        </eb:MessageHeader>
        <wsse:Security xmlns:wsse="http://schemas.xmlsoap.org/ws/2002/12/secext">
            <wsse:BinarySecurityToken valueType="String" EncodingType="wsse:Base64Binary">an impresive binary security toekn</wsse:BinarySecurityToken>
        </wsse:Security>
    </soap-env:Header>
    <soap-env:Body>
        <SessionCreateRS xmlns="http://www.opentravel.org/OTA/2002/11" version="1" status="Approved">
            <ConversationId>the goodbye token</ConversationId>
        </SessionCreateRS>
    </soap-env:Body>
</soap-env:Envelope> 
```

我试图用下面的代码解析它

```
<?php
$xml = simplexml_load_string($res,NULL,NULL,"http://schemas.xmlsoap.org/soap/envelope/");
?> 
```

但 $xml 对象将仅包含以下内容

```
SimpleXMLElement Object
(
    [Header] => SimpleXMLElement Object
        (
        )

    [Body] => SimpleXMLElement Object
        (
        )

) 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-11T21:18:52.530

我认为您需要使用 XPath 注册命名空间和访问权限。像下面这样的东西应该能让你继续前进（我没有能力测试这个）。

```
$xml = simplexml_load_string($res, NULL, NULL, "http://schemas.xmlsoap.org/soap/envelope/");
$xml->registerXPathNamespace('soap-env', 'http://schemas.xmlsoap.org/soap/envelope/');
$xml->registerXPathNamespace('eb', 'http://www.ebxml.org/namespaces/messageHeader');
$xml->registerXPathNamespace('wsse', 'http://schemas.xmlsoap.org/ws/2002/12/secext'); 
```

然后您可以执行以下操作：

```
foreach($xml->xpath('//eb:MessageHeader') as $header)
{
    var_export($header->xpath('//eb:CPAId')); // Should output 'something'.
} 
```

考虑一下，您可能不需要注册命名空间，因为它们已经存在于 XML 中。虽然不确定，但需要测试。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-12T19:32:40.680

1）不要`print_r`和朋友一起看什么是“在”一个SimpleXML对象。有关解释和替代方案，请参阅[https://github.com/IMSoP/simplexml_debug 。](https://github.com/IMSoP/simplexml_debug)

2) SimpleXML 中的命名空间支持由[`->children()`](http://uk.php.net/manual/en/simplexmlelement.children.php)and[`->attributes()`](http://uk.php.net/manual/en/simplexmlelement.attributes.php)方法提供。

例如，您可以像这样获取 From 节点的 PartyId：

```
$from_party = (string)$xml->children('soap-env', true)->Header->children('eb', true)->MessageHeader->From->PartyId; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T21:53:09.513

那是一个肥皂信封。您可能想使用一个肥皂客户端来抽象所有的 xml 解析。PHP[带有一个相当不错的soap 客户端](http://www.php.net/soap)，默认包含在内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-08T06:37:22.317

对于遇到此问题的其他人，我挠头试图返回正确的数据，尽管最佳答案非常接近，但我仍然需要一段时间才能找到答案。最终使用这个页面来帮助：[https ://www.w3schools.com/php/func_simplexml_registerxpathnamespace.asp](https://www.w3schools.com/php/func_simplexml_registerxpathnamespace.asp)

我相信 for 循环可以直接访问您需要的内容。IE

```
foreach($xml->xpath('//eb:CPAId') as $header)
{
    echo $header; // Should output 'something'.
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-10-21T06:56:46.723

试试这个

```
 $soap_url = 'http://path/wsdl/somefile.wsdl';
   $soap_client = new SoapClient($soap_url);

   var_dump($soap_client->__getFunctions()); 
```

有关更多详细信息[，请阅读此处](http://php.net/manual/en/soapclient.soapclient.php)

# ruby - 在 Ruby 中将键数组和值数组转换为哈希

> ID：740732
> 
> 赞同：20
> 
> 时间：2009-04-11T20:30:11.383
> 
> 标签：ruby, arrays, hash

我有两个这样的数组：

```
keys = ['a', 'b', 'c']
values = [1, 2, 3] 
```

Ruby 中是否有一种简单的方法可以将这些数组转换为以下哈希？

```
{ 'a' => 1, 'b' => 2, 'c' => 3 } 
```

这是我的做法，但我觉得应该有一个内置的方法来轻松地做到这一点。

```
def arrays2hash(keys, values)
  hash = {}
  0.upto(keys.length - 1) do |i|
      hash[keys[i]] = values[i]
  end
  hash
end 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-04-11T20:41:32.183

以下适用于 1.8.7：

```
keys = ["a", "b", "c"]
values = [1, 2, 3]
zipped = keys.zip(values)
=> [["a", 1], ["b", 2], ["c", 3]]
Hash[zipped]
=> {"a"=>1, "b"=>2, "c"=>3} 
```

这似乎不适用于旧版本的 Ruby (1.8.6)。以下应该是向后兼容的：

```
Hash[*keys.zip(values).flatten] 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-12T09:04:48.403

另一种方法是使用 each_with_index：

```
hash = {}
keys.each_with_index { |key, index| hash[key] = values[index] }

hash # => {"a"=>1, "b"=>2, "c"=>3} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-07-27T12:26:08.977

使用[`Array#transpose`](http://www.ruby-doc.org/core-2.1.2/Array.html#method-i-transpose)方法也可以做到这一点。如果您使用的是 Ruby 版本 >= **2.1**，您可以利用该方法[`Array#to_h`](http://www.ruby-doc.org/core-2.1.2/Array.html#method-i-to_h)，否则使用您的老朋友，[`Hash::[]`](http://www.ruby-doc.org/core-2.1.2/Hash.html#method-c-5B-5D)

```
keys = ['a', 'b', 'c']
values = [1, 2, 3]
[keys, values].transpose.to_h
# => {"a"=>1, "b"=>2, "c"=>3}
Hash[[keys, values].transpose]
# => {"a"=>1, "b"=>2, "c"=>3} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-13T08:21:21.703

试试这个，这样后一个`d`会覆盖前一个`c`

```
irb(main):001:0>  hash = Hash[[[1,2,3,3], ['a','b','c','d']].transpose]
=> {1=>"a", 2=>"b", 3=>"d"}
irb(main):002:0> 
```

# c++ - winavr中的帮助需要

> ID：740740
> 
> 赞同：0
> 
> 时间：2009-04-11T20:40:50.063
> 
> 标签：c++, embedded, avr, winavr, avrdude

我正在尝试通过串行端口将 ---.hex 文件发送到我的 siemens C55，但是在执行此操作时出现错误

> “make.exe”程序 avrdude -p atmega8 -P com2 -c stk200 -U flash:w:gsm_remote.hex avrdude: 端口名称“com2”既不是 lpt1/2/3 也不是有效数字 avrdude: 无法打开设备“ com2"

avrdude: 未能打开并口“com2”

make.exe: *** [程序] 错误 1

请指导我该怎么做源代码也可以在 [http://www.4shared.com/file/88235332/4b2370f8/080324-11.html获得](http://www.4shared.com/file/88235332/4b2370f8/080324-11.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T02:27:58.963

我不确定如何在 Windows 上设置 avrdude 端口（在文档中的某处进行了描述），但我认为你在这里犯了一个更大的错误。西门子 C55（手机，对吗？）不能在 atmega 上运行。它使用英飞凌 C16X（很可能），就像所有 5X/6X 系列的西门子手机一样。我认为这段代码不适用于西门子硬件。

此外，西门子 C55 不包括 stk200 接口 - 如果您需要闪光灯，请在[http://forum.gsmhosting.com/vbb/上查找更多信息](http://forum.gsmhosting.com/vbb/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T02:05:50.623

那么错误信息是

> avrdude: 未能打开并口“com2”

那么你有可以打开的COM2（串口）吗？如果是，它是否需要管理员权限并且您尝试以非管理员身份运行？

# c# - ASP.NET 中是否有一种自动方式来判断代码和标记中没有使用哪些资源？

> ID：740742
> 
> 赞同：0
> 
> 时间：2009-04-11T20:41:04.337
> 
> 标签：c#, asp.net, asp.net-mvc, resources

我相信我们中的很多人都面临过手动检查数百个字符串常量的挑战，以检查哪些是使用的，哪些不是（孤儿）。虽然我目前的项目中还没有那么多，但我仍然发现很难进行代码审查并手动检查删除的常量。

有什么办法可以自动化吗？也许VS中的一些秘密隐藏功能？

我有一个带有 VS 2008 的 ASP.NET MVC 项目。所以我想检查 .cs 和 .aspx 文件中对资源的所有可能引用。

我的猜测是这是不可能的。不过，也许有什么可以帮助我完成这项任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T13:36:27.733

此外，Resharper 是 VS IDE 的最佳工具，它可以为您完成所有这些以及许多其他选项。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T20:48:25.177

[Developer Express 的CodeRush](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)提供了各种孤立检查。他们刚刚发布了一个免费版本[——CodeRush Express——](http://www.devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/)尽管我不完全确定免费版本中有哪些功能。不过，保留这样的功能似乎是合理的。

这是一个非常强大的工具，所以无论如何我都会推荐它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T21:03:44.000

NDepend 支持搜索未使用的公共方法/属性等。此外，如果您打开解决方案范围的分析，Resharper 4.5 现在会突出显示所有未使用的非私有成员。

# html - IE6 居中内容错误

> ID：740748
> 
> 赞同：0
> 
> 时间：2009-04-11T20:46:46.943
> 
> 标签：html, internet-explorer-6, center

我在 div 中有一些居中的内容。它在 Firefox/Chrome 中显示良好。在 IE6 中，内容从 div 扩展到整个浏览器窗口。知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-24T15:35:59.633

## IE6 解决方法

要做的事情是让 text-align: center on a parent div eg body，这样你的内容 div 在 IE6 中居中。

然后在内容块上使用 margin: auto 以确保 div 在更好的浏览器中居中。

## CSS

```
body {
    text-align: center;
}

#content {
    width: 500px;
    margin-left:auto;
    margin-right:auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T20:49:33.007

确保在页面顶部有 doctype 定义。否则，IE6 将以怪异模式打开页面，这可能会搞砸各种东西......

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T20:51:52.423

<center> 标签已弃用。你应该这样做：

```
<div style="text-align:center; margin: 0 auto; width: 400px;">
</div> 
```

这样，您将拥有居中的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T20:55:53.630

我已经定义了文档类型，并以 CSS 为内容居中。

# xml - 如何将 XML 链接到 XSD？

> ID：740751
> 
> 赞同：23
> 
> 时间：2009-04-11T20:48:28.313
> 
> 标签：xml, xsd

一直在想，就像我们使用 -declaration 将 XML 绑定到 DTD 一样，我们如何使用 XSD 来做到这一点？

MSDN 示例：

```
<?xml version="1.0"?>
<Product ProductID="123" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="Product.xsd">
    <ProductName>Rugby jersey</ProductName>
</Product> 
```

是 xsi:NoNamespaceSchemaLocation 起作用吗？或者这只是另一个命名空间？

[编辑] 而且是

```
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
```

..line 只是为了给我们一个独特的 XML 命名空间，还是它还提供了有关模式所在位置的信息？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-11T21:01:17.237

尝试 **schemaLocation**。

```
<?xml version="1.0"?>

<note
xmlns="http://www.w3schools.com"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.w3schools.com note.xsd">
  <to>Tove</to>
  <from>Jani</from>
  <heading>Reminder</heading>
  <body>Don't forget me this weekend!</body>
</note> 
```

noNamespaceSchemaLocation 不同。请注意，对于 XML 文档的使用者来说，两者实际上都只是理论上的“提示”。我从来没有遇到过不遵循它们的 xml 处理器。毕竟，这是 W3C 的推荐。见[http://www.w3.org/TR/xmlschema-1/](http://www.w3.org/TR/xmlschema-1/)

但实际上，它*可能*会出错，就像[这里](http://lists.w3.org/Archives/Public/www-validator-cvs/2007Dec/0043.html)一样，但话又说回来，它被认为是一个错误是有原因的。

简而言之：我只是相信它，到目前为止没有任何伤害:-)

我不认为任何半体面的 xml 处理器现在可以忽略这个“提示”。

网址始终是唯一的，但在某些情况下，网址下会提供一些信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-11T20:53:19.067

xsi:noNamespaceSchemaLocation 和 xsi:schemaLocation 都向决定服从这些提示的 XML 处理器提供提示。但它们只是提示。它们不一定会导致您的文档根据架构进行验证。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T21:17:34.500

我通常只包含命名空间，并期望如果处理它的人愿意验证它，那么他们将获得架构并设置他们的处理环境，以便它可以找到 XSD。我在`xsi:schemaLocation`这些属性上取得的成功有限。大多数问题通常集中在查找 XSD 文件本身。一些处理器希望包含路径，如果 XSD 位于文件系统而不是 Web 服务器上，这会很有趣。

每个处理器似乎实现查找略有不同。有些使用单独的模式目录对象，有些则需要您单独加载和附加模式。除非您提供处理文档的代码，否则最好不要包含`xsi:schemaLocation`或`xsi:noNamespaceSchemaLocation`恕我直言。他们唯一能做的就是让正在处理您的文档的人将模式放置在同一位置，或者找到某种方法让他们选择的处理器忽略或解决位置规范。

作为旁注，我遇到的最大问题实际上是使用`SYSTEM`引用的声明指定的 DTD `"c:\somepath\doc.dtd"`。问题是我在 FreeBSD 机器上处理文档。我最终编写了自己的解析器来将 Windows 样式的路径映射到本地文件系统，因为我无法自己修改文档并且需要验证它们。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-11T21:30:07.090

这不是一个愚蠢的问题，但[约翰桑德斯说得对](https://stackoverflow.com/questions/740751/how-do-you-link-xml-to-a-xsd/740758#740758)。

> 就像我们使用 -decleration 将 XML 绑定到 DTD 一样，我们如何使用 XSD 来做到这一点？

Here is the essence of the problem - you can't. One of the problems with the DTD approach was that the document specified the validation mechanism and not the document consumer. Post-DTD, you can take an XML document and validate it with XSD or RELAX NG or some other mechanism - they are decoupled (in theory at least). Any XSD link is only a hint and is optional. [It is not possible to validate an arbitrary document](http://illegalargumentexception.blogspot.com/2009/02/java-finding-validation-mechanism-for.html).

# javascript - 如何替换 html textarea 中当前选定的文本？

> ID：740765
> 
> 赞同：15
> 
> 时间：2009-04-11T20:57:20.100
> 
> 标签：javascript, jquery, html

如何编辑 textarea 表单元素的选定文本？

编辑：就地编辑它，替换原始文本。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-11T21:42:47.417

这有效：

```
function replaceIt(txtarea, newtxt) {
  $(txtarea).val(
        $(txtarea).val().substring(0, txtarea.selectionStart)+
        newtxt+
        $(txtarea).val().substring(txtarea.selectionEnd)
   );  
}

$("button").on('click', function() {
  replaceIt($('textarea')[0], 'fun')
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<textarea>Hello world.</textarea>
<button>Replace with fun</button>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T19:55:20.613

我找到了这个：

```
function wrapText(elementID, openTag, closeTag) {
    var textArea = $('#' + elementID);
    var len = textArea.val().length;
    var start = textArea[0].selectionStart;
    var end = textArea[0].selectionEnd;
    var selectedText = textArea.val().substring(start, end);
    var replacement = openTag + selectedText + closeTag;
    textArea.val(textArea.val().substring(0, start) + replacement + textArea.val().substring(end, len));
}

$('button').on('click', function() {
  wrapText('test', '<b>', '</b>');
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<textarea id="test">This is a test</textarea>
<button>Surround with &lt;b&gt; tag</button>
```

但就个人而言，它不适用于内容可编辑的 div。

# sql - 有没有办法区分多个字段

> ID：740767
> 
> 赞同：1
> 
> 时间：2009-04-11T20:59:17.117
> 
> 标签：sql, crystal-reports, distinct

我需要一份包含办公室、日期和订单计数的报告。我需要每月的订单总数，但每天只有 1 个订单。

例如

> 西 2009 年 1 月 1 日 1 个订单
> 
> 西 2009 年 1 月 1 日 1 个订单
> 
> 西 2009 年 1 月 2 日 1 个订单

在我的报告中，我会看到

> 西 2009 年 1 月 1 日 1 个订单
> 
> 西 2009 年 1 月 2 日 1 个订单

我的总订单数为 2。

我知道，这对 SQL 来说真的很容易，但我没有访问权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-08T21:21:12.133

你只是在找这个吗？

```
SELECT DISTINCT Office, Date, OrderCount FROM YourTable 
```

这会重复您的结果，但数据集太小，无法确定这是否是您要完成的任务。使用 DISTINCT 子句将仅返回 Office、Date 和 OrderCount 的唯一组合——在这种情况下，每天/office 一行。

**更新**：啊 - 我没有阅读您没有 SQL 访问权限的部分。你还有两个选择：

1.  在 Crystal Reports 设计器的“数据库”菜单中，选中菜单底部的“选择不同记录”选项。
2.  直接编辑 SQL 查询 - 数据库菜单 -> 数据库专家 -> 在“当前连接”下，单击“添加新命令”并键入您的 SQL 命令。修改我上面提供的那个以满足您的需求，它应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T02:23:55.747

您可以创建三个组，一组用于办公室，一组用于日期，一组用于订单。然后将字段放在日组页脚并抑制其他部分。这将导致报告每天显示一个新部分，但每个订单仅显示一行。然后，您可以将运行总计添加到该部分。将运行总计设置为对您想要的字段求和，评估日期组的变化，然后在月份变化时重置（您需要为此设置一个公式来评估月份）。

这应该像您正在寻找的那样对报告进行分组和排序，并且将有一个运行总计，该总计将沿边运行，该总计将每月重置。希望这可以帮助。

# c# - 如何创建可插入的 ASP.Net 网站？

> ID：740768
> 
> 赞同：8
> 
> 时间：2009-04-11T21:00:38.113
> 
> 标签：c#, asp.net

创建一个能够为其开发插件的站点的最佳实践是什么？

就像你想创建一个博客模块，你希望用户或合作开发者添加插件来扩展这个模块的功能。

**更新：** 感谢超速答案，但我认为这对我来说太过分了。有没有更简单的解决方案，就像我看到的博客引擎插件创建系统一样，你只需要用 [Extension] 装饰类插件。

我是一个中核开发人员，所以我在考虑基类、继承、接口，你怎么看？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-11T21:26:50.217

**编辑**

我根据您的问题编辑完全重写了我的答案。

让我向您展示只需最少的步骤即可轻松实现插件架构。

**第 1 步：定义插件将实现的接口。**

```
namespace PluginInterface
{
    public interface IPlugin
    {
        string Name { get; }
        string Run(string input);
    }
} 
```

**第 2 步：创建一个实现 IPlugin 的插件。**

```
namespace PluginX
{
    using PluginInterface;

    public class Plugin : IPlugin
    {
        public string Name
        {
            get { return "Plugin X"; }
        }

        public string Run(string input)
        {
            return input;
        }
    }
} 
```

**第三步：运行插件。**

```
namespace PluginTest
{
    using System;
    using System.IO;
    using System.Runtime.Remoting;
    using PluginInterface;

    class Program
    {
        static void Main( string[] args )
        {
            string pluginFile = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "PluginX.dll");
            ObjectHandle handle = Activator.CreateInstanceFrom(pluginFile, "PluginX.Plugin");

            IPlugin plugin = handle.Unwrap() as IPlugin;

            string pluginName = plugin.Name;
            string pluginResult = plugin.Run("test string");          

        }
    }
} 
```

请记住，这只是插件架构的基本、最直接的示例。您还可以执行以下操作

*   创建一个插件主机以在它自己的内部运行您的插件`AppDomain`
*   选择接口、抽象类或属性来装饰你的插件
*   使用反射、接口、IL 发出的 thunk 或委托来完成后期绑定工作

如果您的设计如此要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T21:11:34.047

将技术和架构观点分开是很有价值的：

*   在代码级别[MEF](http://www.codeplex.com/MEF)（托管可扩展性框架）是一个好的开始。[这](http://www.pnpguidance.net/post/ManagedExtensibilityFrameworkTutorialMEF.aspx)是一个简单的例子。
*   任何其他 DI（依赖注入框架）都可以很好地工作（即 Unity）

很高兴在架构层面看到这个问题：

*   [p&p 的Web 客户端软件工厂](http://websf.codeplex.com/)。这里不仅有关于“如何创建复合 Web 应用程序？”的技术信息，还有架构信息。请参阅[示例。](http://www.pnpguidance.net/Category/WebClientSoftwareFactory.aspx). 有*模块化边界*包。
*   [春天框架](http://www.springframework.net/)。

如果您阅读并尝试其中一些框架，我认为这是一种快速有效的方法。如果你发现一些有趣的东西，ofcoz 会阅读源代码。

**编辑**

如果您正在寻找可扩展的博客引擎，请先尝试**[博客引擎](http://www.asp.net/Downloads/starter-kits/blog-engine/)**。它来自 ASP.NET 社区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T21:09:16.000

这听起来像是Microsoft[托管可扩展性框架的工作。](http://www.codeplex.com/MEF)它目前处于预览版本中，但它似乎比为此滚动您自己的框架更好。那里的网站上有关于如何使用它的指南的链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T16:59:01.490

如果您想看到一个真正的、开源的应用程序来实现这个架构，请查看[DotNetNuke](http://www.dnnsoftware.com/)。

# flash - 是否可以使用 Flash 将 [MovieClip] 图像上传到 imageshack？

> ID：740771
> 
> 赞同：1
> 
> 时间：2009-04-11T21:01:22.057
> 
> 标签：flash, actionscript-3, actionscript, image, upload

是否可以将 MovieClip 作为图像上传到图像主机，例如 imageshack 或 flickr？

如果可能的话。请指点。

谢谢你们

## 更新

即使这是可能的，宿主是否会要求图像物理存在于文件位置？

## 更新 2

我现在知道它是可能的。但是有人可以给我一个如何做到这一点的大纲吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T21:05:27.477

如果托管服务只允许图像格式，那么你不能。尽管 MovieClips 是一个 ActionScript 对象，但它仍然只是视频。您不能将它们作为另一种格式托管。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T01:24:01.723

是的，这是可能的。您可以将影片剪辑绘制到位图，然后发送位图。

我假设您不想将 swf 文件直接上传到服务，而是让 flash 应用程序发送图像。

编辑：

我想你应该在这里找到你需要的信息：http: [//henryjones.us/articles/using-the-as3-jpeg-encoder](http://henryjones.us/articles/using-the-as3-jpeg-encoder)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T20:02:46.667

如果你想上传一个movieclip的位图副本，你可以像Lillemanden所说的那样做，但是如果你想像Anthony Kanago所说的那样上传一个swf文件，这取决于托管服务。

一个非常奇怪且漫长的解决方法是在托管服务上创建一个movieclip的位图副本，并在您的服务器上保存一个xml或sql条目，该条目将保存动画的详细信息，如果有的话（补间，porperties，符号等）并将其链接到上传图片的网址，以便您可以提供“点击此处查看动画”链接。当用户单击 jpeg 时，您将重定向到一个 swf，该 swf 将根据最初单击的图像播放正确的 swf。

一个更“现实”的答案是使用 actionscript 将 swf 动画编码为 gif。这里有一个方便的库：

[http://www.bytearray.org/?p=93](http://www.bytearray.org/?p=93)

我试过了，它很容易使用。

# delphi - xxm分步安装教程够清楚吗？

> ID：740777
> 
> 赞同：0
> 
> 时间：2009-04-11T21:06:14.510
> 
> 标签：delphi, documentation, delphi-7

我知道[xxm 安装指南](http://xxm.sourceforge.net/install.html)需要阅读很多内容，并且不会像您看到它完成后那样让您快速轻松地启动和运行。

所以我在干净的 Windows 安装上[安装了 xxm](http://xxm.sourceforge.net/tutorial01/index.html)，并在每一步都制作了屏幕截图。我以前没有做过很多教程，甚至不知道从哪里开始制作带有画外音的演练视频……

够清楚吗？我该如何改进它？（首先想到的是我应该将屏幕设置为 800x600）

我应该使用如何在页面上包含片段或如何调试项目来扩展本教程，还是应该制作关于这些的新教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T21:49:14.983

对于了解快捷方式和速记符号（例如 virt-dir）的程序员或 IT 人员（已经有技术倾向），这非常好。虽然，查看该网站，它应该涵盖作为独立 HTTP 服务器运行，因为据称这是受支持的。

# asp.net - 框架 2.0 中的 Subsonic 2.2 和 EnterpriseLibrary 4.1

> ID：740779
> 
> 赞同：0
> 
> 时间：2009-04-11T21:07:30.280
> 
> 标签：asp.net, subsonic, frameworks, enterprise-library

嗨，我在我的项目中使用 subsonic 2.2 版，这个版本的 subsonic 使用 EnterpriseLibrary 4.1

但我使用 EnterpriseLibrary 3.1 因为我使用框架 2.0，版本 4.1 需要框架 3.5 或更高版本，问题是当我在 web 配置中使用 subsonic 时我有这个

什么时候加载失败，并显示这个

无法加载文件或程序集“Microsoft.Practices.EnterpriseLibrary.Data，Version=4.1.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

我该如何解决这个问题，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T21:16:37.090

Subsonic 2.2 仅支持 C# 3.0。使用以前版本的亚音速。

# css - 获取新可见的表格数据以不更改列宽

> ID：740784
> 
> 赞同：0
> 
> 时间：2009-04-11T21:11:18.150
> 
> 标签：css

我有一个表格，其中一列中的一些内容最初是隐藏的，但出现在悬停时。问题是悬停内容然后调整该列的宽度并扭曲表格。

如何在不设置表格布局的情况下将列设置为不调整自身大小：固定或设置宽度。

固定的表格布局会导致列以不自然的方式自行调整大小，仅使用第一行，这是不可接受的，因为不同行中内容长度的差异很大。

有没有办法让表格根据任何行的最长列调整宽度，然后在悬停时禁止调整大小。

如果相关，我正在使用 css hover 来隐藏我的节目。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T23:29:22.560

为什么不只更改悬停时的不透明度属性，而不是显示属性？因此，要显示内容，您可以将不透明度从 0 更改为 1，并将其从 1 更改为 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T21:31:35.713

使用“覆盖”列的 div 或 span 隐藏内容，而不是隐藏实际内容本身。

# c# - Bind() 不应该在 Page.PreRender 之前将子控件的值传递给 GridView 吗？

> ID：740787
> 
> 赞同：1
> 
> 时间：2009-04-11T21:14:19.873
> 
> 标签：c#, .net, asp.net, gridview, viewstate

> 对于 GridView、DetailsView 和 FormView 等控件，数据绑定表达式在控件的 PreRender 事件期间自动解析

但是数据源控制不会在 Page.PreRender 事件之前执行更新吗？意思是，在数据源控件更新数据源之前，不应该 Bind() 将子控件的值传递给 GridView（因此它们可以作为参数传递给数据源控件），因此在 Page.PreRender 事件之前？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-26T23:06:38.670

这有帮助吗？

[ASP.NET 页面生命周期概述](http://msdn.microsoft.com/en-us/library/ms178472.aspx#data_binding_events_for_databound_controls)

# php - 使用 CURL 检索电子邮件有哪些相关问题？

> ID：740791
> 
> 赞同：0
> 
> 时间：2009-04-11T21:17:07.543
> 
> 标签：php, architecture, curl, implementation

我希望添加到我们本地网络的一个新功能是能够使用 PHP 从免费电子邮件服务（例如 Gmail、Yahoo 和 Hotmail）检索电子邮件。有些服务我们可以付费，但我宁愿自己动手！

我发现谷歌只有一个 API，而其他的没有。**那么与我使用 CURL 检索电子邮件相关的问题是什么？**

我什至使用 CURL 和 PHP 实现了 GMail 部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T22:38:09.860

为此目的对他们的网站进行屏幕抓取几乎肯定违反了他们的服务条款。如果他们重新设计您的网站，您用来解析电子邮件内容等的脚本也可能会发生灾难性的故障。

Yahoo、Gmail 和 Hotmail 都支持[POP3](http://en.wikipedia.org/wiki/Post_Office_Protocol)，这是一种用于检索电子邮件的标准协议。为什么不使用它呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T22:48:23.657

当有人给你一个 API 时，他们向你保证“如果你运行代码 X，Y 将会发生。当你筛选抓取时，提供商没有这样的承诺，而且许多提供商在他们的服务条款中有明确禁止的项目屏幕抓取。从技术角度来看，这意味着他们的页面/应用程序可能会发生更改，这些更改会破坏您的屏幕抓取，提供商会意外或有意地枯萎。这就是 CAPTCHA 存在的原因。

此外，这些应用程序越来越多地使用越来越多的“AJAX”风格架构，这意味着您致力于逆向工程其应用程序的工作方式，以及跟上每个应用程序所做的更改。

最后，好吧，你做错了。电子邮件本身就是一组协议。大多数提供商都可以通过 POP3 和 IMAP 访问电子邮件。我会研究破解 PHP 代码以与 POP/IMAP 服务器交互，这些服务器就像 API 一样，是一组承诺的行为。您还有一个优势，即为一个提供者编写的代码可能会为另一个提供者工作（稍作调整）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T21:25:46.913

我假设您有理由不使用 pop 协议，这是检索电子邮件的受支持标准方式。按照您的意愿进行操作是不受支持的，也可能不在提供商的使用条款中。

但是，如果没有验证码解决方案妨碍您，这在技术上是可行的。您必须为每个提供者编写不同的应用程序。如果他们改变了一些东西，你将不得不采用你的应用程序。

为了使它与 curl 一起工作，请务必收集它们在所有页面中提供给您的所有 cookie，并在每个请求中返回它们。

如果出现任何问题（以及开发问题），您可以使用一些工具（例如 windows 上的 proxomitron）分析 http 请求和答案，并使 curl 请求看起来越来越像浏览器请求，直到您成功。最后，他们无法通过浏览器将您的 curl 请求与人工请求区分开来。除了我之前说的验证码。

另一件事是您的请求之间的间隔，您可能会因为经常请求或两个请求之间没有暂停（人类无法做到）而被阻止。如果您怀疑这一点，请尝试在请求之间插入随机修改的暂停。

我可以想象他们在开发过程中阻止了您的帐户或 IP，在这种情况下，有必要更改 IP 和/或您使用的帐户。

# c# - GridView 和加载回发数据阶段

> ID：740793
> 
> 赞同：0
> 
> 时间：2009-04-11T21:18:34.340
> 
> 标签：c#, asp.net, gridview, viewstate

第一季度

A) 在回发时，在页面的生命周期中，GridView 的行何时填充了用户发出回发之前的所有值？因此，GridView 在什么时候已经拥有了它在用户页面上显示的所有值？

我假设这与其他控件同时发生，即在*Load ViewState Data 阶段*？！

B) 输入*TextBox控件的文本用户在**Load Postback Data 阶段*后可用。*在加载回发数据阶段*之后，用户对 GridView 的字段所做的更改不应该也可用吗？

Q2 -在 GridView 的模板内定义 DropDownList 和在 GridView 外定义 DropDownlist 时，*SelectedIndexChanged*事件的处理方式有什么不同吗？意思是，在这两种情况下，事件是否在 Page 的生命周期中的同一点触发？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-12T12:08:49.833

请参阅msdn 中的[Control Execution Lifecycle](http://msdn.microsoft.com/en-us/library/aa719775(VS.71).aspx)以清除围绕控件生命周期的任何混淆。

A）没错，在加载视图状态期间。

B）是的，它们应该可用，这意味着它们在页面加载时可用。

Q2 在页面生命周期的同一点：是的，在发送回发更改通知期间。**警告：**以下情况可能会影响它：

*   开启自动回发。我认为在这种情况下，事件是在以下期间引发的：“处理回发事件”
*   将其更改到位，可能会影响它在舞台期间与其他事件相关的发生时间。

# javascript - 单击事件触发后，如何删除事件处理程序？

> ID：740794
> 
> 赞同：0
> 
> 时间：2009-04-11T21:18:35.447
> 
> 标签：javascript, jquery, html

我在我的页面上有一个`click`事件。`div`

`click`事件触发后，我想取消绑定该事件`div`。

我怎样才能做到这一点？我可以在`click`事件处理程序本身中取消绑定它吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-11T21:22:48.167

使用“[一](http://docs.jquery.com/Events/one#typedatafn)”功能：

```
$("#only_once").one("click", function() {
alert('this only happens once');
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T21:21:46.737

取自[此处](http://docs.jquery.com/Events/unbind)找到的 jQuery 文档：

```
 $("#unbind").click(function () {
      $("#theone").unbind('click', aClick)
                  .text("Does nothing...");
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T22:05:21.403

在纯 JavaScript 中：

```
var myDiv = document.getElementById("myDiv");

myDiv.addEventListener('click', clicked, false);

function clicked()
{
    // Process event here...

    myDiv.removeEventListener('click', clicked, false);
} 
```

史蒂夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T21:23:17.263

这里记录了 unbind 函数：

[http://docs.jquery.com/Events/unbind](http://docs.jquery.com/Events/unbind)

适合你的例子:)

# iphone - iPhone上的CoreGraphics，试图绘制一个“药丸”型椭圆

> ID：740796
> 
> 赞同：0
> 
> 时间：2009-04-11T21:19:46.663
> 
> 标签：iphone, objective-c, cocoa-touch, core-graphics

我正在尝试绘制一个药丸类型的椭圆，就像在 Apple 的邮件应用程序中一样，它显示收件箱中的电子邮件数量。知道为什么以下内容没有绘制吗？

```
- (void)drawRect:(CGRect)rect 
{ 
   CGContextRef context = UIGraphicsGetCurrentContext();

    CGFloat minX = CGRectGetMinX(rect);
    CGFloat minY = CGRectGetMinY(rect);
    CGFloat maxX = CGRectGetMaxX(rect);
    CGFloat maxY = CGRectGetMaxY(rect);

    CGFloat radius = 3.0; 
    CGContextBeginPath(context);
    CGContextMoveToPoint(context, (minX + maxX) / 2.0, minY);
    CGContextAddArcToPoint(context, minX, minY, minX, maxY, radius);
    CGContextAddArcToPoint(context, minX, maxY, maxX, maxY, radius);
    CGContextAddArcToPoint(context, maxX, maxY, maxX, minY, radius);
    CGContextAddArcToPoint(context, maxX, minY, minX, minY, radius);
    CGContextClosePath(context);

    CGContextDrawPath(context, kCGPathFill);
    CGContextFillPath(context);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T22:04:30.860

我想你忘记设置填充颜色了。

另外，请参阅[此问题](https://stackoverflow.com/questions/258375/are-there-any-standard-way-to-implement-the-blue-badge-in-iphone)以获取代码以完全满足您的要求。

# c# - c# wpf重叠控件不接收鼠标事件

> ID：740799
> 
> 赞同：6
> 
> 时间：2009-04-11T21:22:32.957
> 
> 标签：c#, wpf, controls, mouse, z-order

我正在构建一个画布控件。这个根画布有几个重叠的孩子（画布也是如此）。这样做是为了让每个孩子都可以处理自己的绘图，然后我可以使用任何孩子组合来组合最终结果以获得所需的行为。

就渲染而言，这非常有效。但是，这不适用于鼠标事件。鼠标事件的工作方式如下（以 previewmousemove 为例）：

1-如果根画布在鼠标下，则触发事件 2-检查所有子级，如果有一个在鼠标下，则触发事件并停止

因此，只有我添加的第一个孩子会收到鼠标移动事件。该事件不会传播到所有孩子，因为它们重叠。

为了克服这个问题，我尝试了以下操作： 1- 覆盖根画布中的鼠标事件 2- 对于每个事件，找到所有想要使用 VisualTreeHelper.HitTest 处理事件的子级 3- 对于返回有效命中测试结果的所有子级（即：在鼠标下并愿意处理事件（IsHitTestVisible == true）），???

这就是我卡住的地方，我不知何故需要将鼠标事件发送给所有孩子，并停止事件的正常流程以确保第一个孩子不会收到两次（通过事件中的handled = true）。

通过将 RaiseEvent 与传递给子级的相同事件一起使用，事情似乎可以正常工作，但不知何故它也会在父级（根画布）上引发事件。为了绕过这一点，我需要创建事件的副本并设置强制设置源，尽管它似乎更像是一种 hack 而不是解决方案。有没有合适的方法来做我想做的事情？代码示例如下。

```
 public class CustomCanvas : Canvas
    {
        private List<object> m_HitTestResults = new List<object>();

        public new event MouseEventHandler MouseMove;

        public CustomCanvas()
        {
            base.PreviewMouseMove += new MouseEventHandler(CustomCanvas_MouseMove);
        }

        private void CustomCanvas_MouseMove(object sender, MouseEventArgs e)
        {
// Hack here, why is the event raised on the parent as well???
            if (e.OriginalSource == this)
            {
                return;
            }

                Point pt = e.GetPosition((UIElement)sender);
                m_HitTestResults.Clear();

                VisualTreeHelper.HitTest(this,
                    new HitTestFilterCallback(OnHitTest),
                    new HitTestResultCallback(OnHitTest),
                    new PointHitTestParameters(pt));

                MouseEventArgs tmpe = new MouseEventArgs(e.MouseDevice, e.Timestamp, e.StylusDevice);
                tmpe.RoutedEvent = e.RoutedEvent;
                tmpe.Source = this;

                foreach (object hit in m_HitTestResults)
                {
                    UIElement element = hit as UIElement;
                    if (element != null)
                    {
 // This somehow raises the event on us as well as the element here, why???
                        element.RaiseEvent(tmpe);
                    }
                }

            var handlers = MouseMove;
            if (handlers != null)
            {
                handlers(sender, e);
            }

            e.Handled = true;
        }

        private HitTestFilterBehavior OnHitTest(DependencyObject o)
        {
            UIElement element = o as UIElement;
            if (element == this)
            {
                return HitTestFilterBehavior.ContinueSkipSelf;
            }
            else if (element != null && element.IsHitTestVisible && element != this)
            {
                return HitTestFilterBehavior.Continue;
            }
            return HitTestFilterBehavior.ContinueSkipSelfAndChildren;
        }

        private HitTestResultBehavior OnHitTest(HitTestResult result)
        {
            // Add the hit test result to the list that will be processed after the enumeration.
            m_HitTestResults.Add(result.VisualHit);
            // Set the behavior to return visuals at all z-order levels.
            return HitTestResultBehavior.Continue;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-05T19:03:20.507

我认为您应该使用预览事件，因为那些是从窗口到 Z-Order 中最高控制的 RoutingStrategy.Tunnel，而正常事件是 RoutingStrategy.Bubble。

在这个 RoutedEvents 中有一个属性 Handle 当它是真的系统将停止遍历可视化树，因为有人使用了这个事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-08T09:59:30.067

正如@GuerreroTook 所说，您应该使用 WPF 的 RoutedEvents 来解决这个问题（更多信息[在这里](http://msdn.microsoft.com/en-us/library/ms742806.aspx).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-26T16:40:28.557

我发现你的代码示例很有趣，所以我试了一下......但我必须做一个小的修改才能让它在我的东西中正常工作。

我必须更改 HitTestFilter 方法中的第二个“if”，如下所示：

```
if (element == null || element.IsHitTestVisible) 
```

如您所见，我在最后删除了无用的“元素！= this”（您已经在第一个“if”中测试了该条件）并在开头添加了“element == null”。

为什么？因为在过滤过程中的某个时刻，参数类型是 System.Windows.Media.ContainerVisual，它不从 UIElement 继承，因此元素将设置为 null 并返回 ContinueSkipSelfAndChildren。但我不想跳过孩子，因为我的 Canvas 包含在它的“Children”集合中，而我想要测试的 UIElements 包含在 Canvas 中。

# c# - 为什么 GridView 不能直接提取子控件的值？

> ID：740803
> 
> 赞同：0
> 
> 时间：2009-04-11T21:25:49.220
> 
> 标签：c#, asp.net, data-binding, gridview

> 在 GridView 控件模板中使用 Bind 使控件能够从模板中的子控件中提取值并将它们传递给数据源控件。数据源控制依次为数据库执行适当的命令。因此，Bind 函数在数据绑定控件的 EditItemTemplate 或 InsertItemTemplate 中使用。

为什么需要 Bind() 来提取值并将它们传递给 GridView。为什么 GridView 不能直接提取子控件的值？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-08T11:06:40.310

第一个不起作用，因为设置 datasource 属性只是告诉 gridview 这将是数据的来源。第二个设置数据源属性并专门指示gridview绑定到该源并获取数据......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-02T12:25:35.347

它说的只有这个

```
myGridView.DataSource = new string { "1", "2", "3", "4", "5" }; 
```

永远不会工作，但这个：

```
myGridView.DataSource = new string { "1", "2", "3", "4", "5" };
myGridView.DataBind(); 
```

将要

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T21:05:08.240

如果尚未分配值，您如何提取值？您必须如上所述使用 Bind 以便从 DB 中检索值，然后使用 ItemDataBound 事件和 findcontrol 然后提取它的值。

希望这可以帮助。

# c# - 在 asp .net 网站上跟踪用户和会话

> ID：740806
> 
> 赞同：0
> 
> 时间：2009-04-11T21:28:41.257
> 
> 标签：c#, asp.net

我正在寻找编写用户和会话跟踪工具。

我要做的是创建一个页面，让我查看哪些用户已登录以及该用户正在使用哪些会话数据。

这可能吗？还是我需要编写自定义会话提供程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T21:45:25.057

如果您使用 SQL Server 存储会话数据，它〜可能〜有可能挖掘到数据库......但这并不容易。

如果您真的想这样做，您可能需要为 Session 创建一个自定义类并将其存储在 Application 数据中。例如，您可能希望将 ASP.NET HttpContext.Current.Session.SessionId 与存储键/值对的 HybridDictionary 相关联。然后，您可以在应用程序级别监视数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T11:53:02.897

您可以在 global.asax 中使用此方法，不是吗？

```
void Session_Start(object sender, EventArgs e)
{
    // Insert session id into cache or DB or something
}

void Session_End(object sender, EventArgs e)
{
    // Remove session id from cache or DB or something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T21:41:49.837

不，您不能访问其他会话的数据。也许您可以记录会话变量并使用您的跟踪工具读取。

# asp.net - 如何使用 IIS Manager 7.0 为虚拟目录设置 ASP.NET 版本？

> ID：740810
> 
> 赞同：4
> 
> 时间：2009-04-11T21:33:00.997
> 
> 标签：asp.net, iis, iis-7

在旧版本的 IIS 管理器中，我只需右键单击 VD，点击属性，然后在 ASP.NET 选项卡中选择我想要运行的 ASP.NET 版本。有谁知道这是否仍然可能？我在我的 Vista 机器上运行 IIS 的 localhost 实例，我不习惯 IIS 7 附带的新 UI。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-11T21:37:25.997

您需要更改应用程序池 - ASP.NET 版本是在应用程序池级别设置的。

左键单击 IIS 管理器中的虚拟目录，然后在屏幕的最右侧单击“高级设置” 应用程序池位于列表顶部。

如果需要，您可以通过右键单击左侧窗格中的“应用程序池”图标并选择“添加应用程序池”来添加新的应用程序池

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-05-06T05:04:21.877

IIS7 在“网站”中有两个选项。在 IIS6 中，您将在 IIS7 中将子应用程序添加为“添加虚拟目录...”，这样做会迫使您保持与网站相同的 AppPool 和 .NET 框架版本。

但是，IIS7 现在有一个“添加应用程序...”选项，它允许您基本上执行 IIS6 允许的操作，以便您可以明确声明要在其中运行的 AppPool 并且它可以与父网站不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T21:37:07.323

在 IIS7 中，ASP.NET 版本在应用程序池中指定（然后由您的 Web 应用程序使用）。这里有对话框的截图：

[http://www.stolenbit.com/2008/10/select-aspnet-version-in-iis-7.html](http://www.stolenbit.com/2008/10/select-aspnet-version-in-iis-7.html)

# c# - 在 C# 中加密文件的最简单方法是什么？

> ID：740812
> 
> 赞同：3
> 
> 时间：2009-04-11T21:36:52.330
> 
> 标签：c#, encryption

事前：

我确实已经阅读了关于 SO 的其他主题，但我在其中找不到答案。
（其他是关于配置文件或技术列表）

因此，我的问题非常简单，虽然有点主观（我会事先标记它:-)）什么是*最简单*的方法..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-11T21:41:10.603

[File.Encrypt](http://msdn.microsoft.com/en-us/library/system.io.file.encrypt.aspx)非常简单——一次调用（带有一个参数）。

当然，这实际上取决于您想要加密的目的。File.Encrypt 加密到当前帐户，如果您要传递文件，这并没有多大用处。但是，鉴于您的规范 - 即加密文件的最简单方法 - 它必须是候选者！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-11T21:40:07.487

[C# 中的数据保护 API](http://msdn.microsoft.com/en-us/library/ms229741.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-11T21:45:57.783

不要仅仅因为你加密了配置文件就相信你有任何安全性。如果有人可以访问加密的配置文件以及包含密码的可执行文件，则很可能会解密您的配置文件。只是有点难。

假设您的配置文件包含数据库连接的密码，则可能会通过查看网络数据包来获取这些密码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-11T21:56:01.770

加密对于现代库来说是微不足道的：困难的部分是保护密钥。

因此，您需要查看要保护的内容以及要保护的威胁。

要加密文件以便只有当前用户可以在客户端工作站上看到它，File.Encrypt 是一个不错的选择，或者具有 CurrentUser 范围的 DPAPI。

对于单个服务器上的配置文件，使用 LocalMachine 范围的 DPAPI 是一个不错的选择。然后，您需要确保只有授权用户才能登录到服务器。在这里，您实际上是在将密钥管理委派给 Windows。

对于服务器场上的配置文件，您需要在服务器之间共享密钥。RsaProtectedConfigurationProvide 是一个不错的选择，但是您需要做更多的工作来确保所有服务器都可以访问相同的密钥，并保护它免受未经授权的访问（例如使用 DACL）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-11T22:08:50.040

我推荐[Enterprise Library](http://msdn.microsoft.com/en-us/library/dd203099.aspx)中的[Cryptography Application 块](http://msdn.microsoft.com/en-us/library/dd139964.aspx)。非常简单，非常灵活。

# html - 在 iframe 中打开链接

> ID：740816
> 
> 赞同：52
> 
> 时间：2009-04-11T21:38:41.267
> 
> 标签：html, iframe

我有一个带有框架的页面，以及框架下方的一些链接。

我希望链接在单击时打开框架中的页面。

我试过`<a href="" target="nameofframe">link1</a>`了，但没用？

**更新** 它的 iframe。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-04-11T21:42:33.080

假设 iFrame 的名称属性为“myIframe”：

```
<a href="http://www.google.com" target="myIframe">Link Text</a> 
```

您也可以使用 Javascript 来完成此操作。iFrame 有一个 src 属性，用于指定它显示的位置。因此，将链接的单击绑定到更改该 src 属性是一件简单的事情。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-04-11T21:43:02.037

尝试这个：

```
<iframe name="iframe1" src="target.html"></iframe>

<a href="link.html" target="iframe1">link</a> 
```

“目标”属性应在 iframe 中打开。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-09-16T15:31:42.847

使用属性名称。

在这里您可以找到解决方案（“使用 iframe 作为链接的目标”）： [http ://www.w3schools.com/html/html_iframe.asp](http://www.w3schools.com/html/html_iframe.asp)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-11T21:41:27.687

```
<a href="YOUR_URL" target="_YOUR_IFRAME_NAME">LINK NAME</a> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-14T08:01:42.770

因为链接的目标与 iframe 的名称匹配，所以链接将在 iframe 中打开。尝试这个：

```
<iframe src="http://stackoverflow.com/" name="iframe_a">
<p>Your browser does not support iframes.</p>
</iframe>

<a href="http://www.cnn.com" target="iframe_a">www.cnn.com</a> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-17T12:00:07.007

好吧，还有另一种方法！您可以使用按钮代替超链接。因此，当单击按钮时，“name_of_webpage”中指定的网页在名为“name_of_iframe”的目标框架中打开。这个对我有用！

```
<form method="post" action="name_of_webpage" target="name_of_iframe">
<input type="submit" value="any_name_you_want" />
</form>
<iframe name="name_of_iframe"></iframe> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-29T14:27:17.317

今天早上我在一个项目中遇到了这个问题。确保在 head 部分中指定基本标记。

它应该是这样的：

```
<head>
<base target="name_of_iframe">
</head> 
```

这样，当您单击页面上的链接时，默认情况下它将在 iframe 内打开。

希望有帮助。

# networking - 使用 TCP 的关闭行为（sock，SHUT_RD）

> ID：740817
> 
> 赞同：12
> 
> 时间：2009-04-11T21:39:21.170
> 
> 标签：networking, sockets, network-programming, tcp

使用 TCP 套接字时，有什么作用

```
shutdown(sock, SHUT_RD); 
```

实际上呢？它只是让所有`recv()`调用都返回错误代码吗？如果是这样，哪个错误代码？

它是否会导致底层 TCP 连接发送任何数据包？此时对方发送的任何数据会发生什么 - 它是否保留，并且连接的窗口大小不断缩小直到它变为 0，或者它只是被丢弃，并且窗口大小没有缩小？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-23T23:42:01.723

关闭套接字的读取端将导致任何阻塞`recv`（或类似）调用返回`0`（表示正常关闭）。我不知道当前在 IP 堆栈上传输的数据会发生什么。它肯定会忽略来自另一端的传输中的数据。它根本不会影响对该套接字的写入。

事实上，明智地使用`shutdown`是确保您在完成后立即清理的好方法。不使用 keepalive 的 HTTP 客户端可以在完成发送请求后立即关闭写入端，并且看到的服务器`Connection: closed`同样可以在完成接收请求后立即关闭读取端。这将导致任何进一步的错误活动立即显而易见，这在编写协议级代码时非常有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T22:27:06.377

查看 Linux 源代码，`shutdown(sock, SHUT_RD)`似乎不会导致套接字的任何状态更改。（显然，要设置`shutdown(sock, SHUT_WR)`原因。）`FIN`

我无法评论窗口大小的变化（或缺少）。不过你可以写个测试程序看看。只需让您`inetd`运行一个`chargen`服务，然后连接到它。:-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-10-26T09:08:23.363

shutdown(,SHUT_RD) 在 TCP 协议中没有任何对应物，因此当有人写入连接而对方表示它不会读取或当您在声明后尝试读取时，如何表现几乎取决于实现你不会的。

在稍低的级别上，记住 TCP 连接是一对流，对等方使用这些流发送数据，直到它们声明完成（由发送 FIN 的 SHUT_WR）。这两个流程是完全独立的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-21T06:26:09.487

我`shudown(sock,SHUT_RD)`在 Ubuntu 12.04 上进行测试。我发现当您调用时，`shutdown(sock,SHUT_RD)`如果 TCP 缓冲区中没有任何类型的数据（包括 FIN ....），则连续的读取调用将`return 0`（指示流结束）。但是如果有一些数据在关闭函数之前或之后到达，读取调用将正常处理，就好像没有调用关闭函数一样。似乎`shutdown(sock,SHUT_RD)`不会导致任何 TCP 状态更改为套接字

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-02-09T07:16:55.893

它有两种效果，其中一种是平台相关的。

1.  `recv()`将返回零，表示流结束。
2.  对等方对连接的任何进一步写入都将 (a) 被接收者 (BSD) 静默丢弃，(b) 被接收者缓冲并最终导致`send()`阻塞或返回 -1/ `EAGAIN/EWOULDBLOCK`(Linux)，或者 (c ) 导致接收方发送 RST (Windows)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-24T00:02:57.243

shutdown(sock, SHUT_RD) 导致套接字的任何写入器接收 sigpipe 信号。

使用 read 系统调用的任何进一步读取都将返回 -1 并将 errno 设置为 EINVAL。

使用 recv 将返回 -1 并设置 errno 以指示错误（可能是 ENOTCONN 或 ENOTSOCK）。

# asp.net-mvc - 创建强类型视图时，MVC.NET 中的“添加视图...”可以忽略属性吗？

> ID：740819
> 
> 赞同：1
> 
> 时间：2009-04-11T21:40:55.270
> 
> 标签：asp.net-mvc

创建强类型视图时，ASP.NET MVC 中的“添加视图...”向导能否忽略模型中的属性？我在向导中选择“创建”作为“查看内容”，并希望忽略模型中的某些属性。我想在原型制作时快速创建和删除视图，并且我不想手动编辑仅在下次更改模型时才会删除的视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T22:10:35.183

您可以为用于生成 MVC 视图代码的 Visual Studio 代码生成修改现有/添加新的 T4 模板。

来自[David Hayden](http://codebetter.com/blogs/david.hayden/archive/2009/01/29/overriding-global-t4-templates-in-asp-net-mvc-project-with-per-project-templates.aspx)和[microsoft MVC 团队的更多信息](http://blogs.msdn.com/webdevtools/archive/2009/01/29/t4-templates-a-quick-start-guide-for-asp-net-mvc-developers.aspx)

玩得开心 ：）

# python - python直接将字符串写入tarfile

> ID：740820
> 
> 赞同：39
> 
> 时间：2009-04-11T21:41:08.607
> 
> 标签：python, file, file-io, tar

有没有办法将字符串直接写入 tarfile？从[http://docs.python.org/library/tarfile.html](http://docs.python.org/library/tarfile.html)看起来只能添加已经写入文件系统的文件。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-11T21:48:26.313

我想说这是可能的，通过使用 TarInfo e TarFile.addfile 将 StringIO 作为文件对象传递。

非常粗糙，但有效

```
import tarfile
import StringIO

tar = tarfile.TarFile("test.tar","w")

string = StringIO.StringIO()
string.write("hello")
string.seek(0)
info = tarfile.TarInfo(name="foo")
info.size=len(string.buf)
tar.addfile(tarinfo=info, fileobj=string)

tar.close() 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-11T22:02:46.903

正如 Stefano 指出的那样，您可以使用`TarFile.addfile`and `StringIO`。

```
import tarfile, StringIO

data = 'hello, world!'

tarinfo = tarfile.TarInfo('test.txt')
tarinfo.size = len(data)

tar = tarfile.open('test.tar', 'a')
tar.addfile(tarinfo, StringIO.StringIO(data))
tar.close() 
```

您可能还想填写`tarinfo`（例如`mtime`，`uname`等）的其他字段。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-11-03T00:37:03.837

我发现这正在寻找如何在 Django 中提供刚刚在内存中创建的 .tgz 存档，可能其他人会发现我的代码很有用：

```
import tarfile
from io import BytesIO

def serve_file(request):
    out = BytesIO()
    tar = tarfile.open(mode = "w:gz", fileobj = out)
    data = 'lala'.encode('utf-8')
    file = BytesIO(data)
    info = tarfile.TarInfo(name="1.txt")
    info.size = len(data)
    tar.addfile(tarinfo=info, fileobj=file)
    tar.close()

    response = HttpResponse(out.getvalue(), content_type='application/tgz')
    response['Content-Disposition'] = 'attachment; filename=myfile.tgz'
    return response 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-10-09T15:26:25.107

Python 3 中的解决方案使用`io.BytesIO`. 请务必设置`TarInfo.size`为字节的长度，而不是字符串的长度。

给定一个字符串，最简单的解决方案是调用`.encode()`它来获取字节。在当今时代，您可能需要 UTF-8，但如果收件人希望使用特定的编码，例如 ASCII（即没有多字节字符），那么请改用它。

```
import io
import tarfile

data = 'hello\n'.encode('utf8')
info = tarfile.TarInfo(name='foo.txt')
info.size = len(data)

with tarfile.TarFile('test.tar', 'w') as tar:
    tar.addfile(info, io.BytesIO(data)) 
```

如果您真的需要一个可写的*字符串*缓冲区，类似于@Stefano Borini 对于 Python 2 接受的答案，那么解决方案是使用`io.TextIOWrapper`底层`io.BytesIO`缓冲区。

```
import io
import tarfile

textIO = io.TextIOWrapper(io.BytesIO(), encoding='utf8')
textIO.write('hello\n')
bytesIO = textIO.detach()
info = tarfile.TarInfo(name='foo.txt')
info.size = bytesIO.tell()

with tarfile.TarFile('test.tar', 'w') as tar:
    bytesIO.seek(0)
    tar.addfile(info, bytesIO) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-08-06T10:12:30.507

仅作记录：
StringIO 对象具有 .len 属性。
无需 seek(0) 并执行 len(foo.buf)
无需保留整个字符串以执行 len() 或上帝禁止，自己进行会计处理。

（也许在写 OP 的时候没有。）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-08-03T10:21:11.760

就我而言，我想从现有的 tar 文件中读取数据，将一些数据附加到内容中，然后将其写入新文件。就像是：

```
for ti in tar_in:
    buf_in = tar.extractfile(ti)
    buf_out = io.BytesIO()
    size = buf_out.write(buf_in.read())
    size += buf_out.write(other data)
    buf_out.seek(0)
    ti.size = size
    tar_out.addfile(ti, fileobj=buf_out) 
```

处理目录和链接需要额外的代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-11T22:04:37.007

您必须使用 TarInfo 对象和 addfile 方法而不是通常的 add 方法：

```
from StringIO import StringIO
from tarfile import open, TarInfo

s = "Hello World!"
ti = TarInfo("test.txt")
ti.size = len(s)

tf = open("testtar.tar", "w")
tf.addfile(ti, StringIO(s)) 
```

# iphone - UIView 自定义绘图的 Cocoa/Cocoa-touch 最佳实践

> ID：740823
> 
> 赞同：0
> 
> 时间：2009-04-11T21:41:48.700
> 
> 标签：iphone, cocoa, cocoa-touch, objective-c

我正在寻找有关以下最佳实践的见解：

我有一个 UITableView，我想在每个 UITableViewCell 中绘制一个自定义形状。诸如 Apple 邮件应用程序中的“药丸”形状椭圆之类的东西，描述了一个文件夹中有多少邮件。

最好的做法是什么？我应该继承 UIView，并将该类添加到我的 UITableView，然后使用 drawAtPoint:？

我不喜欢继承 UITableViewCell，而且我几乎可以肯定不需要它。否则我的细胞很常见。

你会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T21:51:27.647

我会在 Interface Builder 中设计我的单元格。我将比继承 UITableViewCell 类更容易，你会在[这里](http://www.cocoacast.com/?q=node/182)找到一个很棒的视频教程。而且，无需编码，您将有机会使用非常好的 GUI 工具设计自定义组件。

对于类似椭圆的绘图，您可以使用普通的 UIView 子类，您可以使用 Interface Builder 将其放置在您想要的任何位置。

# opengl - 使用 OpenGL 转换 3D 文本

> ID：740825
> 
> 赞同：1
> 
> 时间：2009-04-11T21:42:10.557
> 
> 标签：opengl, transformation

我目前正在学习本[教程](http://www.videotutorialsrock.com/opengl_tutorial/draw_text/home.php)：

我完全理解如何旋转/缩放/翻译该教程中的每个字符串。

但是有谁知道以用户可配置的方式剪切/变细/扭曲每个琴弦需要哪些步骤？

据我所知，这些不是 OpenGL 调用的一部分，所以通常如何对 3D 文本进行此类转换？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-11T22:12:58.360

您可以制作自己的转换矩阵。它们甚至不必“有意义”，你可以用你认为合适的任何奇怪的扭曲来填充它们。例如，剪切应该如下所示：

```
float shear[] = { 
   1, Ky, 0, 0, 
   Kx, 1, 0, 0,
    0, 0, 1, 0,
    0, 0, 0, 1 };
glMultMatrixf(shear); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T22:12:00.063

您需要操作模型视图矩阵。[这个](http://www.sjbaker.org/steve/omniv/matrices_can_be_your_friends.html)关于矩阵的页面可能有助于剪切、扭曲等。您[`glLoadMatrix`](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/loadmatrix.html)用来加载新值。对于旋转、缩放和变换，只需使用普通的 OpenGL 函数。

编辑：如果矩阵中已有值，则可以使用`glMultMatrix`. 但是，如果可能的话，我首先加载剪切等，然后在此之上应用其他东西。

# architecture - Web 应用程序与客户端交互？

> ID：740826
> 
> 赞同：1
> 
> 时间：2009-04-11T21:42:18.307
> 
> 标签：architecture, activex, cross-browser, npapi

我正在设计一个 Web 应用程序，其中包含一些需要传输到客户端（非浏览器）应用程序（即 Outlook）的信息。假设客户端应用程序具有某种 API，我需要 Web 应用程序触发客户端（基于用户单击链接）以获取信息并通过其 API 将其传输到客户端应用程序。

我的第一个想法是编写一个 ActiveX 控件，我可以将安全代码传递给该控件，然后使用该信息通过我创建的 Web 服务与 Web 应用程序对话，然后 ActiveX 控件可以将接口实现到客户端应用程序中（即展望）。根据我所阅读的内容，这对于 ActiveX 是可行的。

我的问题是 ActiveX 无法在 Mozilla 浏览器或 Chrome 中运行，这会带来真正的问题，因为我需要它是多平台的。我读过关于 NPAPI 的文章，它被认为是等效的本机技术。我还阅读了有关据称支持 ActiveX 的 Firefox 和 Chrome 插件，但它们不是本机的。我需要有原生的开箱即用支持，这样用户就不必做任何特别的事情，只需单击并运行。所以这是我的问题：

1) ActiveX 是我唯一的 IE 选择吗？

2) 我需要开发 ActiveX 和 NPAPI 来支持所有客户端吗？

3）有没有更好的方法来做到这一点，我不知道？我对其他技术持开放态度，因为重点是无缝的用户体验。

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T21:45:41.717

恐怕您可能的解决方案之一是为您希望此应用程序使用的每个浏览器开发一个插件，就像谷歌对齿轮所做的那样

但是，您始终可以尝试使用 java 小程序来解决问题，但我不知道浏览器安全策略是否允许您与诸如 Outlook 之类的应用程序对话，我相信它会

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T21:47:08.360

如果我正确理解您的要求，我认为任何事情都不会是无缝的。您需要将某种模块下载到可以访问其本地系统资源的客户端计算机上。任何体面的浏览器都会向用户抛出可怕的警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T22:26:16.503

根据您传输的信息类型，您可以让 Outlook 在下载时打开并处理它。例如，Outlook 通常设置为 .ics（Internet 日历）文件的默认应用程序。当我下载 .ics 文件时，Outlook 将启动，并将该文件作为日历条目打开。

因此，一个疯狂的想法是编写一个用户将安装在他们的系统上的小应用程序。该应用程序将注册为您的独特文件类型的默认程序。当您要传输信息时，只需将文件作为附件下载即可。您的程序将被调用来处理它。然后，您的程序可以使用 Outlook API 以您需要的任何方式将数据发送到 Outlook。

如果交互不适用于单个文件，您仍然可以使用虚拟文件。其目的是启动您的小型客户端程序并为其提供说明。然后，您的程序可以在一侧与您的 Web 服务进行通信，并在另一侧通过 Outlook API 进行通信。您可以在该环境中做任何您喜欢的事情，尤其是如果您还创建了 Outlook 加载项。

我还没有为几个版本做过 Outlook 编程。有可能使用 Outlook 2007 和 Visual Studio Tools for Office，您可以组合其中的一些部分。主要好处是您根本不需要担心浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-25T05:23:32.483

ActiveX 仅适用于 IE，但 NPAPI 适用于 Firebreath、Chrome 等。

您可以使用 FireBreath 项目，该项目提供了一个相对容易使用的抽象来创建单个插件接口，该接口将用作 ActiveX 控件或 NPAPI 控件。

项目主页在这里：[http ://www.firebreath.org](http://www.firebreath.org)

尽管没有正式发布，但它确实非常接近 1.0 仅 Windows 版本；这听起来像是你所关心的。

有关“快速入门”的信息，请查看此 wiki 页面：[http](http://www.firebreath.org/display/documentation/Creating+a+New+Plugin+Project) ://www.firebreath.org/display/documentation/Creating+a+New+Plugin+Project—— 有一个 python 脚本可以生成一个示例项目，你使用基本插件可能在 30 分钟内启动并运行。

Also, join the mailing list -- I'm the primary developer, and I assure you that we will answer queries promptly if you have problems getting started. =]

# c++ - 在 Windows 上使用 Emacs 编译 C++ 程序

> ID：740836
> 
> 赞同：9
> 
> 时间：2009-04-11T21:47:16.377
> 
> 标签：c++, emacs, gcc, ide

我已经使用 Emacs 进行基本的文本编辑已经有一段时间了，但截至今天，我正尝试将它用于 c++ 编译。在过去的几个小时里，我一直在寻找如何解决这个问题，但我一直在他们的技术上遇到障碍（我认为其中一些与过时的教程有关）。

基本上，我想做的就是能够通过“Mx compile”命令编译我在 Emacs 中编写的 C++ 程序。

到目前为止，我已经安装了 Cygwin 并下载了 gcc 的软件包。我尝试了在线教程提供的其他一些解决方案，但没有成功。

谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-11T22:30:52.530

安装编译器后。您可以使用以下代码段自定义编译命令

```
(add-hook 'c++-mode-hook
  (lambda ()
    (unless (file-exists-p "Makefile")
      (set (make-local-variable 'compile-command)
       (let ((file (file-name-nondirectory buffer-file-name)))
         (concat "g++ -g -O2 -Wall -o " 
             (file-name-sans-extension file)
             " " file)))))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T22:15:52.767

你可以试试[MinGW - “Minimalist GNU for Windows”。](http://www.mingw.org/) 我不记得如何配置 emacs 以从 Mx compile 调用自定义构建工具，但它应该是可能的。这是我刚刚遇到的一个链接，它可能是一个起点。

[http://www.cae.tntech.edu/help/programming/free-programming-tools-windows](http://www.cae.tntech.edu/help/programming/free-programming-tools-windows)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T22:18:05.057

按照 Emacs 文档的建议，为您的程序编写一个 Makefile 并使用“make -k”作为“Mx compile”。使用`make`（或类似的构建工具）通常比为 GCC 重新键入命令行更好，而不仅仅是 Emacs。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-12T06:44:47.723

该`M-x compile`命令调用 shell（例如 linux `bash`、 windows`cmd.exe`等）来运行该`make`命令。在 Windows 上，我认为 emacs 默认为`cmd.exe`shell（通过一个特殊的`C:/Program Files/Emacs/emacs/bin/cmdproxy.exe`可执行文件）。

如果您希望`M-x compile`使用不同的 shell（`bash`在您的情况下可能是 cygwin），那么您需要通过更改`shell-file-name`变量或使用`SHELL`环境变量来告诉 emacs。您还需要确保`make`通过更改`exec-path`变量（或使用`PATH`环境变量）找到 cygwin。

去做这个：

```
(setq shell-file-name "C:/cygwin/bin/bash.exe") 
(setq exec-path (cons "C:/cygwin/bin" exec-path)) 
```

您还可以查看[setup-cygwin.el](http://www.emacswiki.org/emacs/setup-cygwin.el)来设置它以及 cygwin 的其他一些东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T21:41:36.567

如果你在 Cygwin 中安装 Emacs 和 g++，它应该像 Linux 一样工作，也就是说你可以作为编译命令运行`M-x compile`和使用。`g++ myFile.cpp`如果您在 Windows 上使用“本机”Emacs，或者混合使用 Cygwin/MinGW/etc，事情会变得有点复杂（其他答案有解决方案），但归根结底是确保您的环境变量设置正确（例如 PATH、SHELL 等）。最终，如果你不能在命令行上运行它（无论是来自 Cygwin 或 MinGW 的 cmd.exe 或 /bin/bash），它在任何 Emacs 中都不会工作。

例如，我使用 Cygwin 的 SCons/g++ 和 MS Visual Studio 的 devenv.com 在 Emacs 中编译 C++。这当然需要安装 SCons 和 Visual Studio，但这是可能的。SCons 从 Cygwinports ( [http://sourceware.org/cygwinports/](http://sourceware.org/cygwinports/) ) 安装并在标准路径中的 /usr/bin 中结束，但 devenv.com 深埋在 Visual Studio 中；为了访问它，我将它的包含目录添加到我的 PATH（在我的 ~/.bash_profile 中）：

```
case $OS in
    Windows_NT)
        case "`uname -s`" in
            CYGWIN_NT*)
                PATH=${PATH}:"/cygdrive/c/Program Files (x86)/Microsoft Visual Studio 10.0/Common7/IDE/"
                ;;
            MINGW32_NT*)
                PATH=${PATH}:"/c/Program Files (x86)/Microsoft Visual Studio 10.0/Common7/IDE/"
                ;;
        esac
esac 
```

`scons`然后我构造一个or的编译命令`devenv.com -build "Release|Platform MySolution.sln`，事情就从那里顺利进行。您可以根据需要变得复杂（在我当前的项目中，我有构建和测试 shell 脚本，这些脚本调用`scons`和`devenv.com`；我倾向于避开批处理文件，因为 shell 更强大）。我唯一的抱怨是微软改变了错误的输出，因此从编译器输出自动跳转到代码行目前被破坏了（我需要考虑修复它）。

我假设您来自 Emacs 的“本机”构建，在这种情况下，您可能还会发现用于 Emacs 的[cygwin-mount](http://emacswiki.org/emacs/cygwin-mount.el)模块很有用。

# c# - 如何在 C# 中创建受密码保护的文件

> ID：740837
> 
> 赞同：6
> 
> 时间：2009-04-11T21:47:50.900
> 
> 标签：c#, passwords

有点补充，但与[这个](https://stackoverflow.com/questions/740812/whats-the-easiest-way-to-encrypt-a-file-in-c)问题不同。

如何创建受密码保护的文件？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-11T22:05:53.570

加密：

```
private const int SaltSize = 8;

public static void Encrypt( FileInfo targetFile, string password )
{
  var keyGenerator = new Rfc2898DeriveBytes( password, SaltSize );
  var rijndael = Rijndael.Create();

  // BlockSize, KeySize in bit --> divide by 8
  rijndael.IV = keyGenerator.GetBytes( rijndael.BlockSize / 8 );
  rijndael.Key = keyGenerator.GetBytes( rijndael.KeySize / 8 );

  using( var fileStream = targetFile.Create() )
  {
    // write random salt
    fileStream.Write( keyGenerator.Salt, 0, SaltSize );

    using( var cryptoStream = new CryptoStream( fileStream, rijndael.CreateEncryptor(), CryptoStreamMode.Write ) )
    {
      // write data
    }
  }
} 
```

并解密：

```
public static void Decrypt( FileInfo sourceFile, string password )
{
  // read salt
  var fileStream = sourceFile.OpenRead();
  var salt = new byte[SaltSize];
  fileStream.Read( salt, 0, SaltSize );

  // initialize algorithm with salt
  var keyGenerator = new Rfc2898DeriveBytes( password, salt );
  var rijndael = Rijndael.Create();
  rijndael.IV = keyGenerator.GetBytes( rijndael.BlockSize / 8 );
  rijndael.Key = keyGenerator.GetBytes( rijndael.KeySize / 8 );

  // decrypt
  using( var cryptoStream = new CryptoStream( fileStream, rijndael.CreateDecryptor(), CryptoStreamMode.Read ) )
  {
    // read data
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T21:55:58.807

使用 RijndaelManaged 类进行加密，使用 Rfc2898DeriveBytes 生成加密的密钥（和 IV）。

# python - Python 多处理：自定义进程池

> ID：740844
> 
> 赞同：7
> 
> 时间：2009-04-11T21:53:55.723
> 
> 标签：python, multiprocessing, pool

我将 Process 类子类化为我称为 EdgeRenderer 的类。我想使用`multiprocessing.Pool`，除了常规进程之外，我希望它们成为我的 EdgeRenderer 的实例。可能的？如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T14:24:46.590

从杰西诺勒：

> API 目前不支持它，但不会是一个糟糕的添加。本周我将考虑将其添加到 python2.7/2.6.3 3.1

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-12-01T18:50:06.840

这似乎有效：

```
import multiprocessing as mp

ctx = mp.get_context()  # get the default context

class MyProcess(ctx.Process):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        print("Hi, I'm custom a process")

ctx.Process = MyProcess  # override the context's Process

def worker(x):
    print(x**2)

p = ctx.Pool(4)
nums = range(10)
p.map(worker, nums) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T01:26:06.977

我在 API 中看不到任何钩子。您可能可以通过使用`initializer`和`initargs`参数来复制您想要的功能。或者，您可以将功能构建到用于映射的可调用对象中：

```
class EdgeRenderTask(object):
    def op1(self,*args):
        ...
    def op2(self,*args):
        ...
p = Pool(processes = 10)
e = EdgeRenderTask()
p.apply_async(e.op1,arg_list)
p.map(e.op2,arg_list) 
```

# javascript - 当字符数超过一定限制时，如何从文本框中删除字符？

> ID：740845
> 
> 赞同：3
> 
> 时间：2009-04-11T21:54:02.103
> 
> 标签：javascript, jquery

我想在 Javascript 中实现一个 140 个字符限制的文本框，以便在添加第 141 个字符时删除该字符。

我不想向超出限制的用户显示任何消息或警报。已经有一个counter.re。

这是我想做的一个例子：http: [//titletweets.com/category/games/michigan-state-vs-north-carolina/](http://titletweets.com/category/games/michigan-state-vs-north-carolina/)

我正在使用 jQuery，如果它已经具有此功能，请告诉我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-12T01:38:58.287

如果它是单行文本框，那么您可以使用该`maxlength`属性：

```
<input type="text" maxlength="140" /> 
```

还值得注意的是，无论您的解决方案如何，您*仍然需要在服务器端重复验证*。是否向用户报告他们的条目太长，或者您只是截断数据，这取决于您。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T17:04:09.240

斯堪的纳维亚的一家银行最近发生了一起诉讼，因为一位客户不小心将一堆钱转到了错误的账户，因为她在帐号中输入了太多的零。这使得生成的帐号无效，但她没有注意到，因为网络应用程序默默地删除了她多余的数字。所以她输入了类似的东西

```
1223300045 
```

但应该输入

```
122330045 
```

因此帐户

```
122330004 
```

收到了她的钱。 **这是一个主要的可用性缺陷。**

如果是文本区域，请查看 StackOverflow 自己的评论 UI。它会显示您的文本框中有多少文本，并且您有机会编辑您的文本，但真正甜蜜的部分是您可以输入任意数量的内容，然后编辑到有限的限制，让您确保可以说你喜欢的。如果您的文本框删除了用户的文本：

*   如果他们通过看键盘打字，他们可能不会注意到它的发生
*   他们必须先删除文本，然后才能添加新的、更简洁的措辞
*   他们会生气

因此，我的建议是让用户随心所欲地输入，但让他们知道何时超过限制，并让他们编辑。以下示例可以帮助您入门。您应该根据需要更改选择器以仅操作您需要的文本区域/文本输入。如果限制错误，不要忘记做适当的事情。这个样本设置了一个类；class 属性允许您更改文本区域（或其他）的颜色。您可能想要显示消息或其他内容。他们的关键是让用户继续打字。

```
function checkTALength(event) {
  var text = $(this).val();
  if(text.length > 140) {
    $(this).addClass('overlimit');
  } else {
    $(this).removeClass('overlimit');
  }
}
function checkSubmit(event) {
  if($('.overlimit', this).length > 0) { return false; }
}

$(document).ready(function() {   
  $('textarea').change(checkTALength);
  $('textarea').keyup(checkTALength);
  $('form').submit(checkSubmit);
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T22:05:06.397

假设文本区域的 id 是 theTextArea，这样的事情应该可以工作。

```
$("#theTextArea").keyup(function(event) {

    var text = $("#theTextArea").val();
    if (text.length > 140)
        $("#theTextArea").val(text.substring(0, 140));

}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-12T00:45:53.343

keyup 不会阻止可能超出限制的右键单击粘贴操作 - 您可能希望设置值 onchange 或 onblur 以及击键。

如果您从 keydown 处理事件，在按键之前，您可以避免闪烁的第 141 个字母。

或者，如果这是一个文本输入元素。设置最大长度

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-11T22:02:14.283

假设您使用的`textarea`是没有内置的`maxlength`，您可以分配一个`keyup`事件：

```
$('#tweet').keyup(function(){
  var s = $(this).text();
  if(s.length > 140)
    $(this).text(s.substring(0,140))
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-11T22:02:38.197

在我的头顶上：

```
 $('#myTextArea').keyup(function() {
        var text = $(this).text();
        if(text.length == 141) {
            $(this).text(text.substring(text.length - 2));
        }
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-13T01:34:42.140

```
$(document).ready(function() {
        var maxLimit = 140;
        $('#txtIdInput').keyup(function() {
        var length = $('#txtIdInput').val().length;
            if (length > maxLimit) {
                $("#txtIdInput").val($("#txtIdInput").val().substring(0, maxLimit));
            }
        });

    }); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-13T15:42:04.490

一个主题的变体：

```
$("#textarea").keyup(function(e) {
    var trim = this.value.substr( 0, 140 );  // "foo".substr(0, 140) == "foo"
    if ( this.value != trim ) {
      this.value = trim;
    }
}); 
```

# python - Python：了解“multiprocessing.Manager”的好地方？

> ID：740848
> 
> 赞同：47
> 
> 时间：2009-04-11T21:56:13.377
> 
> 标签：python, multiprocessing

我想学习使用`multiprocessing.Manager`。我查看了文档，但这对我来说还不够容易。任何人都知道一个好的教程或类似的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T22:41:04.737

[multiprocessing.Manager](http://docs.python.org/library/multiprocessing.html#multiprocessing-managers)的文档包含使用 Manager 和与 cals 关联的各种对象的大量示例：

> 管理器提供了一种方法来创建可以在不同进程之间共享的数据。管理器对象控制管理共享对象的服务器进程。其他进程可以使用代理访问共享对象。[等等]

管理器对象允许您创建在多个进程中共享的变量。你**到底**想达到什么目的？也许请求示例会有所帮助？

# javascript - 嵌入元素的加载事件

> ID：740860
> 
> 赞同：10
> 
> 时间：2009-04-11T22:08:19.527
> 
> 标签：javascript, dom-events

如果我为嵌入式对象做一个在线`onload`活动，那似乎可行，但我似乎无法让`load`活动通过`addEventListener`. 这是预期的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T01:02:39.887

可能，但它可能取决于浏览器。

windows、图像和 iframe 使用 addEventListener 和 attachEvent 定义它们的加载事件，但其他加载事件是特定于浏览器的。

例如，脚本或链接元素的加载不会在 IE 中附加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T02:09:02.863

总是可以这样设置：

```
document.getElementById("objectId").onload = function(){ ... } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-13T16:52:12.463

尝试

`$("embed").ready(function(){ ... });`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-03-23T05:03:41.567

jQuery 也许是最好的方法。

```
$("embed").load(function(){
   // enter code here
}) 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2018-03-13T03:59:15.390

jQuery`on/bind/load`不会为嵌入元素触发，`ready`使用 Chrome 时虽然有效但渲染后不触发，如果您想在渲染嵌入元素后收听舞台，您可能必须使用纯 js 来添加处理程序。

# mysql - Ruby on Rails：查找特定列中值最低的记录

> ID：740862
> 
> 赞同：8
> 
> 时间：2009-04-11T22:09:02.223
> 
> 标签：mysql, ruby-on-rails, ruby

我试图在数据库中找到其 datetime 列值最低的记录。简单来说，就是想找一个时间最早的记录。

我可以使用 minimum 来找到最小值，但这只会返回值本身，而不是整个记录。

我想我可以创建另一个查询，但我想知道是否有更有效的方法来执行此操作。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-11T22:42:43.687

这将起作用：

```
earliest = Model.first(:order => 'column asc') 
```

— 其中Model是模型类的名称，*column**是*日期时间列的名称。它将生成以下 SQL 语句：

```
SELECT * FROM `Model` ORDER BY column asc LIMIT 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T22:38:08.267

```
Table.first(:order => 'created_on') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-02T11:59:06.060

@Ravenstine 从 rails 3 开始，以下是正确的语法

```
earliest = Model.order('column asc').first 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T22:27:11.103

我不确定 RoR，但使用 SQL，您可以按日期时间字段对查询结果进行排序，并将结果数限制为 1。

SQL：

```
SELECT field1,field2,... FROM table ORDER BY datefield LIMIT 1; 
```

或者也许在 Ruby 中（虽然不确定）：

```
table.find(:all, :limit => 1, :order => 'datefield.asc') 
```

# regex - 为什么在 Vim 中 \%(\) 比 \(\) 快？

> ID：740870
> 
> 赞同：5
> 
> 时间：2009-04-11T22:14:31.397
> 
> 标签：regex, vim

我对文档感到困惑：

> `\%(\)`由转义括号括起来的模式。 `*/\%(\)* */\%(*` `*E53*` 就像`\(\)`，但不将其视为子表达式。这允许使用更多组，并且速度更快。

有人可以解释差异的原因吗？是因为回溯还是其他原因？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-11T22:18:59.733

“快一点”的评论是准确的，因为需要做的簿记要少一点，但重点是“一点点”而不是“更快”。基本上，通常情况下，`\(pattern\)`必须保留与之匹配的材料，以便您可以使用`\3`（用于适当的数字）在替换时引用它。该`%`符号意味着`vim`不必跟踪匹配 - 所以它做的工作少了一点。

* * *

@SimpleQuestions 问：

> “跟踪比赛”是什么意思？它如何影响速度？

您可以使用转义括号来“捕获”匹配模式的部分。例如，假设我们正在使用简单的 C 函数声明——没有指向函数的指针或其他括号源——那么我们可能有一个替代命令，如下所示：

```
s@\<\([a-zA-Z_][a-zA-Z_0-9]*\)(\([^)]*\))@xyz_\1(int nargs) /* \2 */@ 
```

给定一个输入行，例如：

```
int simple_function(int a, char *b, double c) 
```

输出将是：

```
int xyz_simple_function(int nargs) /* int a, char *b, double c */ 
```

（您为什么要这样做？我想我需要包装 C 函数`simple_function`，以便可以从使用不同接口约定的编译为 C 的语言调用它——准确地说，它基于 Informix 4GL . 我用它来举个例子——不是因为你真的需要知道为什么它是一个很好的改变。）

现在，在示例中，替换文本中的`\1`and`\2`指的是正则表达式的捕获部分 - 函数名称（以字母字符开头的字母数字序列 - 将下划线计数为“字母”）和函数参数列表（所有括号之间，但不包括括号）。

如果我`\%(....\)`在函数标识符周围使用了符号，那么`\1`将引用参数列表并且不会有`\2`. 因为`vim`不必跟踪正则表达式的两个捕获部分之一，与必须跟踪两个捕获部分相比，它要做的簿记工作要少得多。但是，正如我所说，差异很小。你可能永远无法在实践中测量它。这就是手册说“它允许更多组”的原因；如果您需要对正则表达式的某些部分进行分组但不需要再次引用它们，那么您可以使用更长的正则表达式。但是，当您记住（捕获）正则表达式的 9 个以上部分时，您的大脑通常会在旋转，并且您的手指无论如何都会出错 - 因此通常不值得付出努力。但我认为，这就是使用该`\%(...\)`符号的论据。它匹配 Perl (PCRE) 符号 '`(?:...)`' 用于非捕获正则表达式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-11T23:25:35.860

我在#Vim 中问过，另一个是否因为回溯而更快。用户 godlygeek 回答：

> 不，它更快，因为匹配的东西不需要被strdup'ed -*任何*不必要的工作对于语法文件来说都是一件坏事。

他继续：

> [速度]取决于字符串的大小。对于 3 个字符来说，这并不重要，对于 3000 个字符来说可能会。请记住，每次匹配时都需要进行 strdup'ed ......包括在回溯期间......这意味着在匹配单个正则表达式的过程中，即使是 3 个字符也可以 strdup'ed 1000 次。-- 语法文件在 $VIMRUNTIME/syntax

# java - Java中受保护的类结构？

> ID：740873
> 
> 赞同：6
> 
> 时间：2009-04-11T22:18:43.353
> 
> 标签：java, oop, class, inheritance

我想知道Java中是否有一种语言特性，其中超类的方法对于子类的成员是不可见的：

```
 public class Subclass extends protected Superclass 
```

或者其他的东西。我举个例子。

这是你的超类。

```
public class A{
    public String getA(){...}
    public String getB(){...}
    public String getC(){...}
    public void setA(String a){...}
    public void setB(String b){...}
    public void setC(String c){...}
} 
```

如果您想在保护 A 的某些方法的同时将 A 子类化，并且除非您覆盖它们，否则您不能更改方法中的访问修改器，那么您最终会得到类似这样的东西 -

```
public class B extends A{
    private String getA(){return super.getA();}
    private String getB(){return super.getB();}//These four methods have
    private void setA(String a){super.setA(a);}//to be redeclared.
    private void setB(String b){super.setB(b);}

    public String getC(){return super.getC();}//These two methods can be
    public void setC(String c){super.setC(c);}//removed.
    public String getD(){...}
    public void setD(String d){...}
} 
```

要么，要么您可以保留 A 的私有实例并具有以下内容：

```
public class B{

    private A obj;

    private String getA(){return obj.getA();}
    private String getB(){return obj.getB();}//These four methods can also
    private void setA(String a){obj.setA(a);}//be removed.
    private void setB(String b){obj.setB(b);}

    public String getC(){return obj.getC();}//These two methods are
    public void setC(String c){obj.setC(c);}//redeclared.
    public String getD(){...}
    public void setD(String d){...}
} 
```

你能有一些东西以一种你不必重新声明任何方法的方式来处理吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-11T22:22:00.117

与 C++ 中的情况不同，Java 中没有“非公共”继承。

继承创建子类型关系。B 的任何实例也是 A 的实例，并且应该响应相同的消息。如果 B 的实例显然没有响应 A 的实例响应的所有消息，那么无论如何继承都是不合适的。

您的最后一个解决方案（B 不从 A 继承）是合适的解决方案：您不创建子类型关系，只需使用一种类型（秘密）实现另一种。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T22:23:34.607

我不认为这是或不应该是可能的。

如果您使用继承使 B 扩展 A，您应该能够将 B 对象用作 A 对象。例如，这是可能的：

```
A obj = new B(); 
```

现在程序无法知道你不能调用 A 的一些公共方法。

如果没有继承，函数的重新定义是不可避免的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T22:22:26.557

除了在超类中将字段/方法设置为私有之外，我认为没有办法解决这个问题。

我认为您最好的选择是您的第二个选择，其中 B 类拥有对 A 类的私有引用。

# linux - 在 linux 系统上拥有高 pgfree/s 有什么意义？

> ID：740878
> 
> 赞同：2
> 
> 时间：2009-04-11T22:19:25.350
> 
> 标签：linux, performance, garbage-collection, system

我在 sar 中看到一个应用程序的高 pgfree/s 值。通常这是我应该关注的问题吗？如果是这样，通常是什么原因导致在 GC 上花费大量时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T02:01:13.450

这取决于您的机器正在做什么，这是否是一个问题。pgfree/s 是内核每秒放入空闲列表的页数。空闲列表是内核跟踪未分配内存的地方。因此，如果您正在进行大量内存分配/释放（例如通过创建和销毁大量进程），那么应该没问题。更多关于内存和空闲列表的信息可以在[这里](http://oreilly.com/catalog/spt2/chapter/ch04.html)找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T01:36:01.007

我能找到的关于**sar**的唯一可能对您的问题有所启发的内容来自[Redhat](http://www.redhat.com/docs/manuals/linux/RHL-9-Manual/admin-primer/s1-resource-rhlspec.html)。但是我看不到任何可能与垃圾收集有关的东西。

# c# - C#：如何从另一个类更改 form1 中标签的文本？

> ID：740890
> 
> 赞同：5
> 
> 时间：2009-04-11T22:28:50.350
> 
> 标签：c#, visual-studio-2008

我试图从一个类中更改标签的文本，但没有成功。

我所拥有的是我使用 get{} 和 set{} 更新类中的变量。我知道我需要在 set{} 中放置或执行某些操作以使其将更新值从类发送回 form1 类，以便它可以更新标签。

谁能告诉我我怎么能做到这一点？或者如果有一种方法可以从类中更新标签，那就更好了。

我希望这是有道理的，并提前感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-11T22:37:01.110

您可能需要考虑使用委托或事件并让您的类将事件返回到表单，这样您的类将不知道您的表单。

**例子**

```
class SomeClass
{
    public delegate void UpdateLabel(string value);

    public event UpdateLabel OnLabelUpdate;

    public void Process()
    {
        if (OnLabelUpdate != null)
        {
            OnLabelUpdate("hello");
        }
    }
}

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void UpdateLabelButton_Click(object sender, EventArgs e)
    {
        SomeClass updater = new SomeClass();
        updater.OnLabelUpdate += new SomeClass.UpdateLabel(updater_OnLabelUpdate);
        updater.Process();
    }

    void updater_OnLabelUpdate(string value)
    {
        this.LabelToUpdateLabel.Text = value;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T22:33:25.627

如果我理解你的问题，你有一个表单类，“form1”。正在显示该类的一个实例。那个表格上有一个标签。您正在另一个类中运行一个方法。您希望该方法更新 form1 上的标签。

如果这是正确的，那么这就像方法需要更改另一个类实例的属性的任何其他情况一样。您在其他类中的方法需要对表单实例的引用。当你调用你的方法时，而不是这样做：

```
OtherClass oc = new OtherClass();
oc.OtherMethod(); 
```

做这个：

```
OtherClass oc = new OtherClass();
oc.OtherMethod(this); 
```

改变Othermethod的定义：

```
public void Othermethod(form1 theForm) {
    theForm.TheLabel.Text = "New Text!";
} 
```

那么一切都应该是幸福的！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T22:36:01.173

由于您尚未发布代码，因此我无法说明为什么它不起作用。但是你想要的很容易做到。

```
public class FormA : Form
{
  // ...

  public string Label1Value
  {
    get { return this.label1.Text; }
    set { this.label1.Text = value; }
  }
  // ...
} 
```

您可以轻松地以任何其他形式或代码使用它（除非它在另一个线程中。）

```
public class FormB : Form
{
  private void Button1_Click(object sender, MouseEventArgs e)
  {
    formA.Label1Value = "FormB was clicked";
  }
} 
```

* * *

### 更新

如果你想使用 Davide 建议的事件，你可以这样做。

```
public class EULAEventArgs : EventArgs
{
  public string Signature { get; set; }
}

public class FormB : Form
{
  public event EventHandler<EULAEventArgs> EULAAccepted;
  protected virtual void OnEULAAccepted(EULAEventArgs e)
  {
    if (EULAAccepted != null)
      EULAAccepted(this, e);
  }

  public void Button1_Clicked(...)
  {
    OnEULAAccepted(new EULAEventArgs { Signature = "..." });
  }
}

public class FormA : Form
{
  public FormA()
  {
    // ...
    formB.EULAAccepted += EULAAccepted;
  }

  private void EULAAccepted(object sender, EULAEventArgs e)
  {
    this.label1.Text = String.Format("Thank you {0} for accepting the EULA.",
                                              e.Signature);
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T22:36:50.907

我不确定我是否理解你的问题，但我会尽力给出答案。您可以为包装 Label.Text 属性的 Form 类提供公共属性。然后，您可以从代码中的任何其他位置（包括其他类）使用此属性。

这回答了你的问题吗？如果不是，这可能是因为我不理解您的问题，请编辑并更具体。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T22:43:32.343

更新变量的 set{} 是否与表单在同一线程中运行？如果是这样，那么您可以执行 John Saunders 所说的操作，但是如果您需要从不同的线程更新表单上标签的 Text 属性，那么您将需要从 set 方法调用执行类似这样的操作：

```
theForm.TheLabel.Invoke(theForm.DelegateThatUpdatesLabel("New Text!")); 
```

# javascript - 如果我想在多种语言中保持一致，我应该使用双引号还是单引号来引用字符串？

> ID：740891
> 
> 赞同：4
> 
> 时间：2009-04-11T22:28:52.207
> 
> 标签：javascript, programming-languages, syntax

在 JavaScript 中，编写字符串时使用单引号还是双引号似乎并不重要。但是，某些编程语言对它们的处理方式不同。

在多种编程语言中，一种是否比另一种更可靠？使用一个而不是另一个有什么优点或缺点（除了撇号或引号在字符串中时）？

我想选择一个，然后能够在多种编程语言中使用它——它的含义相同（如果可能的话）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-11T22:36:02.517

在许多脚本和 shell 语言中，双引号和单引号之间存在显着差异。例如，在 Perl 和许多 Unix shell 中，当您使用双引号时，解释器将解析您的字符串并尝试对字符串中的任何变量进行任何替换。如果你使用单引号，解释器不会尝试对字符串做任何花哨的事情；它会将其视为普通文字。

在 C++ 或 Java 等其他语言中，双引号用于字符串，单引号用于单字符文字。

每种语言可能会以不同的方式处理引号。我认为在 Javascript 中使用哪一种可能并不重要，但最好对最佳实践进行一些研究，然后选择一种方法并保持一致。我见过一些例子，人们选择在 HTML 中使用双引号，在 Javascript 中使用单引号，但我不确定这是否是“标准”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-11T22:30:45.463

含义完全取决于您使用的语言，因此您想要的内容是不可能的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T23:26:58.527

就个人而言，我默认使用双引号；这与其说是“跨语言一致性”的问题，不如说是不必思考。

当我以任何语言键入字符串时，双引号在我熟悉的所有语言中都默认使用，但单引号不一定有效。

当然，如果您要以某种方式处理字符串（内联变量扩展、转义字符或其他），您需要考虑并使用适合您所使用语言的任何内容。

但是对于 90% 以上的情况，“它只是一个字符串，该死的”，双引号几乎无处不在——至少对于我使用的语言来说。我知道这是一件小事，但它仍然是我需要考虑的更少的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T22:31:48.283

通常我在 Javascript 中也使用双引号，因为在我通常编程的大多数语言中，字符串都是双引号的。例如，在 C/C++ 中，单引号代表单个字符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-11T22:34:53.407

在某些脚本语言（例如，shell、Perl、Ruby 和 PHP）中，单引号字符串不支持字符转义（除了在某些语言中转义引号和反斜杠字符）也不支持变量插值。双引号字符串支持两者。

Perl 中的示例：

```
my $name = 'Barney';
print "Hello, $name\n";   # "Hello, Barney" (followed by newline)
print 'Hello, $name\n';   # "Hello, $name\n" 
```

因此，如果您希望您的 JavaScript 与上述一致，您可能希望使用单引号字符串 --- 但是，JS 中的单引号字符串仍然支持字符转义，但在提到的其他语言中不支持多于。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-11T22:49:30.860

如果您打算使用多种语言，那么对一种或另一种过于熟悉可能会适得其反。我所做的大部分开发都是 C#（双引号字符串），但偶尔会切换回 Delphi 以获取 Win32 内容（单引号字符串）。我离开 Delphi 的时间越长，我犯的错误就越多。奇怪的是，当我同时使用*两种*语言时，它会更简单*一些*！

如前所述，如果你做了很多跨语言的事情，你将不得不同时处理这两个问题，所以最好不要担心。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-11T22:35:58.023

引号的含义非常依赖于语言。有些语言还允许您使用 `` `(backquotes) to mean something completely different from the regular`' `and`" ` 引号。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T06:45:04.460

在c中，双引号用于字符集。所以它用于字符串。单引号用于指定单个字符。如果字符串保留在单引号中，则为语法错误。

# sml - 如何自定义 SML/NJ 交互式循环？

> ID：740896
> 
> 赞同：3
> 
> 时间：2009-04-11T22:33:39.090
> 
> 标签：sml, smlnj

我是标准 ML 的新手，我正在尝试了解 SML/NJ 运行时环境。我想让它适应我的需要。具体来说，我想：

*   默认使用 IntInf
*   防止它将字符串和 IntInf 截断为 70 个字符。

这是我在 8 多个小时的阅读文档和实验中发现的。

我可以使用命令在 int 之上重载 IntInf

```
open IntInf; 
```

我可以使用变量 Control.Print.stringDepth 控制字符串中显示多少个字符。例如，这将让它在截断之前显示 1000 个字符：

```
Control.Print.stringDepth := 1000; 
```

我如何为 IntInf 值做同样的事情？我可以将深度设置为无限（即根本没有截断）吗？

打开 IntInf 是用 IntInf 重载 int 的最佳方法吗？

最后，如何让这一切在运行时自动加载，以便当我调用“sml”时它在我的默认环境中？

* * *

编辑：我后来发现有一个名为 Control.Print.intinfDepth 的选项可以设置为一个很大的数字（比如 999999）。不过，我不知道如何使它无限。

我的其他问题仍未得到解答。

* * *

编辑：我在 Kansas State 的一个班级遇到了这[组 SML/NJ 定制](http://people.cis.ksu.edu/~stough/sml/smlcus.sml)。为了显示我自己的横幅消息并避免显示“val it = true : bool”，我需要测试 SMLofNJ.exportML 的返回值。如果是真的，堆映像刚刚恢复（即启动），我可以显示一条消息。如果为 false，则只是保存了堆映像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T16:57:38.770

> 如何使这一切在运行时自动加载，以便当我调用“sml”时它在我的默认环境中？

您需要创建一个由脚本运行的*堆映像*`sml`，然后您可以符号链接到该堆映像。为了避免引导的复杂性，我通常给我的堆映像一个不同的名称；例如; `sml-nw`用于支持[noweb](http://www.cs.tufts.edu/~nr/noweb/)的 SML/NJ 。

创建堆映像所需的基本原语是`SMLofNJ.exportML`. 以下是你如何使用它：

1.  以您想要的方式设置所有内容，例如，`open IntInf`设置所有`Control.Print`变量。（您可以尝试设置 Control.Print `things to`valOf Int.maxInt`，这是最接近无穷大的东西。）

2.  通过 .创建一个新的堆映像`SMLofNJ.exportML "mysml"`。当您启动自定义版本时，您将在调用`exportML`. 阅读 [文档](http://www.smlnj.org/doc/SMLofNJ/pages/smlnj.html)。到处玩；有很多方法可以使用这个原语。

3.  将堆映像（可能`mysml.x86-linux`）复制到堆映像的安装目录（在我的安装中`/usr/lib/smlnj/bin/.heap`，但是您可以按照`sml`脚本中的线索确定）

4.  创建一个脚本`mysml`，它是脚本的符号链接`sml`。

在过去，这已经足够了，但我已经好几年没有使用 SML/NJ 了。我还在网上找到了一个[有点过时的例子](http://people.cis.ksu.edu/~stough/sml/smlcus.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T09:31:16.473

这有帮助吗？

[http://archives.devshed.com/forums/programming-132/big-integers-in-sml-nj-97t-316791.html](http://archives.devshed.com/forums/programming-132/big-integers-in-sml-nj-97t-316791.html)

不确定无限的问题。

# .net - 向 ItemControl 添加元素的成本有多大？

> ID：740897
> 
> 赞同：1
> 
> 时间：2009-04-11T22:34:34.347
> 
> 标签：.net, .net-3.5

我只是有一个一般的 .NET 查询：

假设我有一个大（内存大小）类

```
public class BigClass
{
...
} 
```

如果我将一个项目添加到 ItemControl，例如 ListBox 或 Datagrid 像这样

```
BigClass b = new BigClass();
ListBox1.Items.Add(b); 
```

做这样的事情的资源使用情况如何？是引用了添加的项目还是实例的副本（导致大量内存使用）？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T22:41:30.693

它将作为参考添加。.NET 对象没有隐式复制语义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T22:54:38.867

可以肯定的是，我只是做了一个快速而肮脏的测试， ListBox1.Items 不会复制，而是保留参考。

这是完整的代码：

```
public class A
{

    int a;

    public int A1
    {
        get { return a; }
        set { a = value; }
    }

}
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        A a = new A();
        a.A1 = 4;

        A b = new A();
        b.A1 = 4;

        listBox1.Items.Add(a);
        listBox1.Items.Add(b);

        A c = listBox1.Items[0] as A;
        A d = listBox1.Items[1] as A;

        if(a.Equals(c))
        {
            int k = 8; //program enter here so a is instance of c
        }

        if (a.Equals(d))
        {
            int k = 8; //program doesn't enter here meaning a is not instance of d
        }

    }
} 
```

# user-interface - 想要一种在 Java 之外具有强大 GUI 能力的新语言

> ID：740909
> 
> 赞同：5
> 
> 时间：2009-04-11T22:39:43.443
> 
> 标签：user-interface, programming-languages

我是编程新手。我正在学习计算机科学，而编程可能会成为我要追求的职业。下学期我们将有一个大型项目，我们将在其中编写图形用户界面 (GUI) 应用程序，并且我们可以选择自己的语言和平台。

我不得不说我对Java`Swing`和`AWT`Java 不太满意。我正在寻找一种新语言，它既能保持 Java 提供的易于编程的特性，又能轻松创建图形用户界面。欢迎为 Linux 和 Windows 提供语言/平台建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-11T22:41:46.857

C# 和 .NET 是一个不错的选择，特别是如果您想要一种很像 Java 的语言。

对于初学者，请下载[Visual Studio Express](http://www.microsoft.com/Express/)（免费），您将能够使用 C# 和 .NET 创建 Windows 应用程序。GUI 就像将控件拖到表单上一样容易创建。

[您还可以使用 C# 来协助在 Linux 平台上进行编程，并使用名为Mono](http://mono-project.com/Main_Page)的 .NET 开源端口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T22:50:26.943

请记住，Swing 并不是 Java GUI 开发的唯一选择。还有：

*   [JavaFX](http://javafx.com/)：这是针对稍微不同的市场（即 Flash），但可用于 GUI 开发；
*   [网豆平台](http://platform.netbeans.org/)；和
*   [Eclipse RCP](http://wiki.eclipse.org/index.php/Rich_Client_Platform)（“富客户端平台”）。

虽然 Swing 是迄今为止最受欢迎的。然而，它可能是最不现代的。

除此之外，您还有：

*   .Net：尽管如此，Mono 确实以 Windows 为中心；
*   [Python 有许多 GUI 工具包/库](http://www.python.org/doc/faq/gui/)；
*   [Qt](http://qt.nokia.com/)变得非常流行，特别是对于 C++ 和 Python；和
*   毫无疑问，还有很多其他人。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T22:42:21.457

我总是喜欢在 Delphi 中完成 GUI 的方式。但那是 Windows 的东西。C++ 和 Qt 适合你吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T22:41:18.323

你可能想看看 Groovy，它提供了一个很好的 java 动态包装器，它使 GUI 工作更容易一些，并且可以利用你现有的 java 知识。尽管即使使用 groovy，swing 也不是最容易使用的工具包。

有关使用 groovy 进行 GUI 开发的更多信息，请参阅[使用 Groovy 进行 GUI 编程](http://groovy.codehaus.org/GUI+Programming+with+Groovy)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-11T22:47:20.710

[JavaFX](http://www.sun.com/software/javafx/)是一种用于 Java GUI 开发的相对较新的技术。我没用过，但应该比Swing好很多。更好是指更容易使用和更强大。

如果您已经有 Java/Swing 方面的经验，可能值得一试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-11T23:08:56.010

虽然多年来我一直是一名专业的 Swing 程序员，但我会推荐一个 Web UI 框架，特别是如果你想专业地追求这一点。以下是我根据个人经验提出的建议：

我强烈建议您查看 Flex——如果您是学生，它是完全免费的（SDK 和 FlexBuilder Eclipse IDE）。您可以使用它通过 AIR 平台创建 Web UI 或桌面应用程序。

或者，我会查看 Google Web Toolkit。所有的开发都是用 Java 完成的，UI 组件生成 JavaScript 来进行 AJAX 风格的开发。我有很好的经验，但是 UI 组件的标准库有些有限。我发现 SmartGWT 是一个很好的补充，它可以轻松集成以提供更丰富的组件库。如果你走这条 HTML/JavaScript 的一般路线，还请查看 JQuery。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-11T22:41:32.223

[带有wxWidgets](http://www.wxwidgets.org/)的 C++ ！*咧嘴笑，鸭子，然后奔跑*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-11T22:42:46.820

您可能需要考虑 Tcl/Tk。人们对它的唯一负面评价是“它看起来很丑”。这部分是有争议的——这里还有另一个问题可以解决这个问题。大多数有 Tk 经验的人认为它几乎是最简单的 GUI 工具包。这部分也是值得商榷的，尽管我属于那种思想流派。我使用了一些 MFC，原始 X、Motif、Swing、Visual C 和一些鲜为人知的工具包，并且会选择 Tk 而不是那些心跳。

如果您不喜欢 Tcl，那么还有其他语言的 Tk 绑定，例如 Python 和 Ruby。有关 tk 的更多信息，您可能需要查看[TkDocs](http://www.tkdocs.com/)，它显示了 Tcl、Ruby 和 Perl 中的示例。它缺少 Python，因为 python 集成有点落后，尽管 python 2.7 很快就会跟上现代 Tk 的速度。

如果您正在寻找易学易用、跨平台的产品，IMO Tcl/Tk 是一个不错的选择。也没有其他语言具有更好的分发策略。如果您更关心视觉效果而不是功能或生产力，您可能想看看其他地方。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-11T22:55:40.347

有些[人](http://www.artima.com/weblogs/viewpost.jsp?thread=193593)似乎真的很喜欢[Flex](http://www.adobe.com/products/flex/)。

它的一个问题是您要么必须为开发环境支付现金，要么希望您可以在 30 天的试用期中完成您的项目。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-11T23:24:45.783

毫无疑问，**德尔福**。

为什么？因为如果您从未编写过 GUI，它将为您提供有关此类应用程序如何工作的非常深入的知识，而不会像其他语言 + IDE 那样复杂。

此外，由于它基于 Pascal，您将专注于 GUI 而不是语言本身，因为 (Object) Pascal 非常简单，我认为您将要学习的课程将重点关注这一点（GUI，而不是语言细节）。

另一个优点是 Delphi 有很多组件库，并且很容易自己构建组件（正如我所说，使用非常简单的语言），因此您可以使用手头的工具非常高效。

使用 Delphi，您也可以为 .NET 平台的 Windows 本机代码构建。

最后，您可以将 Delphi 作为初学者的工具来学习，并在您对此类应用程序的了解有所增长时继续前进。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-12T00:20:51.203

你可以看看[javaFx](http://javafx.com/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-11T00:16:50.120

[Shoes](http://shoooes.net)是一个用 Ruby 编写 GUI 应用程序的工具包。它可以跨平台工作。如果你有创意，你可以用它做一些非常复杂的事情——看看[the-shoebox.org](http://the-shoebox.org)。

# casting - 帮助：无法将对象 Dropdownllist 转换为 IConvertible

> ID：740913
> 
> 赞同：1
> 
> 时间：2009-04-11T22:41:25.950
> 
> 标签：casting

我在从 FIndControl 函数获取下拉列表的值时遇到问题。

这是我尝试使用的代码：

```
currentCategoryID = Convert.ToInt32(((DropDownList)r.FindControl("DDLCategories"))); 
```

数据库中 currentCategoryID 的值是一个“int”

当我执行上述代码时，我收到此错误消息：

**无法将“System.Web.UI.WebControls.DropDownList”类型的对象转换为“System.IConvertible”类型。**

使用相同的代码，我不得不使用此代码检索文本框值，一切正常

```
currentAddress = ((TextBox)r.FindControl("txtAddress")).Text; 
```

有人可以为我指出如何正确编写此代码的正确方向吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T22:48:41.143

您正在尝试将 DropDownList 本身转换为 Int32 而不是它的值。您应该在转换之前进一步深入控件以检索值。例如，

```
currentCategoryID = Convert.ToInt32(((DropDownList)r.FindControl("DDLCategories")).SelectedItem.Value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T22:48:35.730

您的第一个代码段试图将*DropDownList 控件本身*转换为 int。您需要做的是提取所选值或所选项目或其他任何内容，具体取决于您使用的 UI 框架：

```
object selectedId = ((DropDownList)(r.FindControl("...")).SelectedValue;
int currentCategoryId = Convert.ToInt32(selectedId); 
```

# .net - 水平自动调整 WinForms TreeView 控件大小的最佳方法？

> ID：740924
> 
> 赞同：3
> 
> 时间：2009-04-11T22:46:26.190
> 
> 标签：.net, winforms, treeview, autosize

我在 WinForms 中有一个树形视图控件，它填充了各种各样的数据库内容。我需要计算树视图控件的最小宽度（填充后），这样就不需要水平滚动条来查看内容。计算需要考虑树中最长文本的大小，但还需要考虑缩进级别、层次图形等。

我没有看到基于内容水平自动调整树视图控件的明显方法。有没有人找到实现这一目标的好方法？

提前致谢...

标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T22:58:50.557

尝试扫描列表，计算最大值：

```
text_width + indent_size * indent_level + image_width 
```

对列表的单次迭代应该可以很好地估计树视图的宽度。您可能想要迭代所有节点或仅迭代可见节点，具体取决于您的应用程序。

# wpf - 绑定 StringFormat 似乎无法正常工作

> ID：740925
> 
> 赞同：7
> 
> 时间：2009-04-11T22:46:41.680
> 
> 标签：wpf, binding

我有一个 DataGrid 和一个像这样的扩展器：

```
<StackPanel>
<my:DataGrid Name="dataGrid1" AutoGenerateColumns="False"  ItemsSource="{Binding}">...</my:DataGrid>
<Expander Header="{Binding ElementName=dataGrid1, Path=SelectedItem.Name, StringFormat=Details of {0}}">...</Expander>
</StackPanel> 
```

绑定很好，但由于某种原因，字符串格式不起作用。它总是只显示值 dataGrid1.SelectedItem.Name 我也尝试过：

```
StringFormat=Details of \{0\} 
```

这是行不通的。

我什至尝试将 Expander 的 HeaderStringFormat 属性设置为“{0} 的详细信息”，但这也没有对其进行格式化。

不过，我能够使这种解决方法起作用：

```
<Expander>
<Expander.Header>
<TextBox Text="{Binding ElementName=dataGrid1, Path=SelectedItem.Name, StringFormat=Details of {0}}"></TextBox>
</Expander.Header>
</Expander> 
```

有谁知道为什么 StringFormat 不适用于 Header 属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T14:26:04.160

根据[http://codingcontext.wordpress.com/2008/11/17/headerformatstring-and-contentformatstring/](http://codingcontext.wordpress.com/2008/11/17/headerformatstring-and-contentformatstring/)，看起来该`HeaderStringFormat`属性并不是要与字符串格式绑定一起使用，而是要指定要使用的格式当绑定到实现`IFormattable`.

鉴于此，我也无法让字符串格式直接在绑定表达式中工作，所以这可能只是一个错误。您应该尝试通知 Microsoft，也许他们会修复它。

使用您的解决方法，我建议使用 a`TextBlock`而不是 a `TextBox`，因为您可能不希望用户能够编辑`Expander`标题中的文本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-26T14:08:20.120

我也遇到了同样的问题，在阅读了一些文章之后，尝试了各种[ContentStringFormat](http://msdn.microsoft.com/ru-ru/library/system.windows.controls.contentcontrol.contentstringformat%28v=vs.110%29.aspx)和[HeaderStringFormat](http://msdn.microsoft.com/en-us/library/system.windows.controls.headeredcontentcontrol.headerstringformat.aspx)我刚刚决定做下一件事：

```
<Expander Grid.Row="1" Padding="4">
                <Expander.Header>
                <TextBlock Text="{Binding ElementName=cbCategory, Path=SelectedItem.CategoryName, StringFormat='FORMATTED &quot;{0}&quot;'}"/>
                </Expander.Header> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T23:10:03.510

它可能与 Header 是 Object 类型属性而不是 String 有关。将 String 值转换为 UI 控件可能会干扰格式设置。与 TextBox 不同，Label 也能正常工作吗？这应该会给您与您最初尝试做的相同的效果。

**更新**：还尝试查看[HeaderStringFormat](http://msdn.microsoft.com/en-us/library/system.windows.controls.headeredcontentcontrol.headerstringformat.aspx)属性。

# python - 可以使用 InstantDjango 而不是正常安装

> ID：740929
> 
> 赞同：3
> 
> 时间：2009-04-11T22:48:33.500
> 
> 标签：python, django, instant

是否可以仅使用 Instant Django 进行开发？我需要正常版本还是可以使用这个即时版本？有人用过吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-11T23:02:47.943

当然，可以使用 InstantDjango 进行开发。InstantDjango 使用 SQLite3，这是一个非常合理的关系数据库，适用于嵌入式或轻度/有时中度使用。django 的全部目的是 ORM 层为您提供数据库可移植性。

也就是说，我不会使用 InstantDjango 部署在一个半严肃的网络应用程序中。SQLite 只是不能像使用 MySQL/Postgres 的 Apache（等）那样扩展。在某些情况下，SQLite 处理数据类型的方式（或者更确切地说，掩盖数据类型）可能会导致随后使用 MySQL/Postgres 部署的 django 应用程序出现问题......如果您使用 SQLite 进行开发，请始终使用您的上线前的实际部署环境。

在过去的几天里，您在 SO 上提出了一些关于使用一个或另一个主要关系数据库包部署 Django 的问题（[Django-Instant Django 入门](https://stackoverflow.com/questions/738433/getting-started-with-django-instant-django)；[是我还是 Rails 和 Django 难以安装窗户？](https://stackoverflow.com/questions/719431/is-it-me-or-are-rails-and-django-difficult-to-install-on-windows)）。我怀疑你没有很多答案的原因，因此觉得有必要用不同的措辞继续问同一个问题，因为我们需要更具体的例子来说明你遇到的错误。

每天都有很多人在 Windows 和 *nix 系统上安装带有 MySQL、Postgres 和其他数据库的 Django。如果您向我们提供您尝试使用的非 SQLite 数据库的确切详细信息、安装方式、在 django 中如何配置该数据库的设置以及收到的错误消息，我们将有更好的机会帮助你。

如果根据您的答案仍然遇到问题，也许您可​​以求助于您认识的专业系统管理员和/或 DBA，向您展示安装和配置此类软件的技巧。

在那之前，一定要开始使用 InstantDjango 和 SQLite 进行开发。当您迁移到不同的关系数据库时，不必为了大量重写而丢弃它，并且将帮助您在框架上取得进步，该框架只能增强您理解如何在生产中部署它的知识。

# java - 如何使用 Java 对文本文件中的记录进行排序？

> ID：740936
> 
> 赞同：6
> 
> 时间：2009-04-11T22:53:38.543
> 
> 标签：java, file, sorting, text-files

txt文件中数据的一些修改。我已经尝试了建议的代码，但我没有成功地将它再次写入具有这种格式的 txt 文件中。我尝试了 collection.sort，但它以长行写入数据。

我的 txt 文件包含这些数据：

```
Monday
Jessica  Run      20mins
Alba     Walk     20mins
Amy      Jogging  40mins
Bobby    Run      10mins
Tuesday
Mess     Run      20mins
Alba     Walk     20mins
Christy  Jogging  40mins
Bobby    Run      10mins 
```

如何按升序对这些数据进行排序，并在排序后再次将其存储在 txt 文件中？

```
Monday
Alba     Walk     20mins
Amy      Jogging  40mins
Bobby    Run      10mins
Jessica  Run      20mins
Tuesday
Alba     Walk     20mins
Bobby    Run      10 mins
Christy  Jogging  40mins
Mess     Run      20mins
Jessica  Run      20mins 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-11T23:23:14.087

这是我想出的：

```
import java.io.*;
import java.util.*;

public class Sort {

    public static void main(String[] args) throws Exception {
        BufferedReader reader = new BufferedReader(new FileReader("fileToRead"));
        Map<String, String> map=new TreeMap<String, String>();
        String line="";
        while((line=reader.readLine())!=null){
            map.put(getField(line),line);
        }
        reader.close();
        FileWriter writer = new FileWriter("fileToWrite");
        for(String val : map.values()){
            writer.write(val);  
            writer.write('\n');
        }
        writer.close();
    }

    private static String getField(String line) {
        return line.split(" ")[0];//extract value you want to sort on
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-29T08:43:34.610

```
package com.myFiles;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.Collections;

public class FilesReaderWriter {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = null;
        PrintWriter outputStream = null;
        ArrayList<String> rows = new ArrayList<String>();

        try {
            reader  = new BufferedReader(new FileReader("Input.txt"));
            outputStream = new PrintWriter(new FileWriter("Output.txt"));

            String file;
            while ((file = reader .readLine()) != null) {
                rows.add(file);
            }
            Collections.sort(rows);
            String[] strArr= rows.toArray(new String[0]);
            for (String cur : strArr)
                outputStream.println(cur);
        } finally {
            if (reader  != null) {
                inputStream.close();
            }
            if (outputStream != null) {
                outputStream.close();
            }
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-11T23:37:01.527

这是一种非常懒惰的做法，因为您只对第一个单词进行排序：

```
 ArrayList<String> rows = new ArrayList<String>();
    BufferedReader reader = new BufferedReader(new FileReader("input.txt"));

    String s;
    while((s = reader.readLine())!=null)
        rows.add(s);

    Collections.sort(rows);

    FileWriter writer = new FileWriter("output.txt");
    for(String cur: rows)
        writer.write(cur+"\n");

    reader.close();
    writer.close(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-11T22:58:23.803

使用`sort`：

```
aaron@ares ~$ sort data.txt 
Alba     Walk     20mins
Amy      Jogging  40mins
Bobby    Run      10mins
Jessica  Run      20mins

aaron@ares ~$ sort data.txt > sorted.txt
aaron@ares ~$ cat sorted.txt
Alba     Walk     20mins
Amy      Jogging  40mins
Bobby    Run      10mins
Jessica  Run      20mins 
```

...或使用`python`：

```
aaron@ares ~$ python -c "import sys; print ''.join(sorted(sys.stdin))" < data.txt > sorted.txt
aaron@ares ~$ cat sorted.txt 
Alba     Walk     20mins
Amy      Jogging  40mins
Bobby    Run      10mins
Jessica  Run      20mins 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-11T23:02:36.650

有一个包含 3 个参数的类：名称、操作和长度。

打开您的文件进行阅读，逐字阅读，为每个人创建一个新的类实例并填充适当的值，然后将该实例插入某个集合。

通过编写自己的排序方法或（更好的选择）使用 Java 排序函数之一对集合进行排序。

打开另一个文件进行写入并以相同的方式编写您的排序集合。

如果以上动作无法翻译成代码，请购买《Core JAVA》这本书好好阅读，或者希望这里有人大方，给你一个完整的代码。:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-02T16:39:15.797

```
import java.io.*;
import java.util.*;

public class Sort1 {
    public static void main(String[] args) throws Exception {
        BufferedReader reader = new BufferedReader(new FileReader("fileToRead.txt"));
        Map<String, String> map=new TreeMap<String, String>();
        String line="";
        while((line=reader.readLine())!=null){
                map.put(getField(line),line);
        }
        reader.close();
        BufferedWriter writer = new BufferedWriter(new FileWriter("fileToWrite1.txt"));
        for(String val : map.values()){
                writer.write(val);      
                writer.newLine();
        }
        writer.close();
    }

    private static String getField(String line) {
        return line.split(" ")[0];//extract value you want to sort on
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-02-20T13:39:58.337

此解决方案使用 Java 8 Stream API。

考虑`Files.write`将`Stream<CharSequence>`其作为第二个参数，因此我们需要通过`map(Function.identity())`.

```
import java.io.IOException;
import java.nio.file.*;
import java.util.function.Function;
import java.util.stream.Stream;

public class FileSortWithStreams {

    public static void main(String[] args) throws IOException {
        Path initialFile = Paths.get("files/initial.txt");
        Path sortedFile = Paths.get("files/sorted.txt");

        Stream<CharSequence> sortedLines = Files.lines(initialFile).sorted().map(Function.identity());

        Files.write(sortedFile, sortedLines::iterator, StandardOpenOption.CREATE);
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-11T23:04:02.073

如果该文件中没有可怕的数据量，请尝试以下操作：

将其所有内容加载到

```
String s = <<file contents>>;

String[] strings = s.split(<<here comes lovely regex something like \w+\s\w+\s\w>>);

Arrays.sort(strings);

for (String str : strings) {
  write  str  to your output file;
} 
```

但我太累了，无法提出更明智的建议……

# c# - 从其他命名空间访问变量

> ID：740937
> 
> 赞同：8
> 
> 时间：2009-04-11T22:53:52.893
> 
> 标签：c#, variables, namespaces

我是 C# 的新手，一般来说我的问题是如何调用位于不同命名空间中的变量？如果我有这个代码

```
public void servicevalues(string _servicename)
{
  string servicename = _servicename;
  string query = string.Format("SELECT * FROM Win32_Service WHERE Name ='{0}'", servicename);
  ManagementObjectSearcher moquery = new ManagementObjectSearcher(query);
  ManagementObjectCollection queryCollection = moquery.Get();
  foreach (ManagementObject service in queryCollection)
  {
    string serviceId = Convert.ToString(service["DisplayName"]);
    bool serviceResult = Convert.ToBoolean(service["Started"]);
  } 
```

我正在传递服务名称，我将如何从不同的命名空间调用一个或多个变量值？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-11T23:02:22.080

通常，变量并不单独存在于命名空间中，它们存在于另一个可能位于另一个命名空间中的类中。如果您需要访问另一个类（在另一个命名空间中）中的变量，那么您的另一个类需要以某种方式公开该变量。通常的做法是为变量使用公共属性（如果您只需要访问该变量，则为静态）。

```
namespace My.Namespace
{
    public class MyClassA
    {
        public void MyMethod()
        {
            // Use value from MyOtherClass
            int myValue = My.Other.Namespace.MyOtherClass.MyInt;
        }
    }
}

namespace My.Other.Namespace
{
    public class MyOtherClass
    {
        private static int myInt;
        public static int MyInt
        {
            get {return myInt;}
            set {myInt = value;}
        }

        // Can also do this in C#3.0
        public static int MyOtherInt {get;set;}
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T23:10:14.400

要添加到 Andy 的答案，您还可以通过在 My.Namespace 声明上方添加以下内容来缩短对 MyInt 属性的调用：

```
using My.Other.Namespace 
```

如果您这样做，那么您对 ​​MyInt 属性的调用将如下所示：

```
int MyValue = MyOtherClass.MyInt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-27T06:22:56.737

作为侧节点，可以通过添加对`public`使用另一个程序集的成员的程序集的引用来完成。这就是招致我的原因。

# iphone - 开源 Cocoa/Cocoa-Touch POP3/SMTP 库？

> ID：740939
> 
> 赞同：25
> 
> 时间：2009-04-11T22:54:46.417
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, pop3

我正在寻找一个与 POP3/SMTP 服务器对话的示例应用程序。与其用 BSD 套接字和 CFNetwork 类型调用重新发明轮子，我很好奇目前是否有任何开源库已经处理了很多脏活？我试过谷歌搜索，但运气不佳。

也许我忽略了一些东西来简化这一点。

谢谢。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-06T22:02:24.417

[CocoaDev 上的 MessageFramework](http://www.cocoadev.com/index.pl?MessageFramework)列出了各种可能性，

[“从 Cocoa 发送电子邮件”](http://vafer.org/blog/20080604120118)还列出了几个框架，包括[Pantomime](http://www.collaboration-world.com/pantomime/)、[MailCore](http://www.libmailcore.com)和 EdMessage （这个[站点](http://www.mulle-kybernetik.com/software/EDFrameworks/)似乎已经关闭，但[github 上有一个镜像](http://github.com/tcurdt/edmessage/tree/master)，它也被修改为编译为 10.4，以及 10.5 -所以应该在iPhone上工作）

使用哑剧的示例代码（来自上面的博客文章）：

```
CWMessage *message = [[CWMessage alloc] init];

CWInternetAddress *address;

address = [[CWInternetAddress alloc] initWithString:@"from@gmail.com"];
[message setFrom:address];
[address release];

address = [[CWInternetAddress alloc] initWithString:@"to@somewhere.com"];
[address setType:PantomimeToRecipient];
[message addRecipient:address];
[address release];

[message setSubject:@"test"];

[message setContentType: @"text/plain"];
[message setContentTransferEncoding: PantomimeEncodingNone];
[message setCharset: @"us-ascii"];

[message setContent: [@"This is a simple content." dataUsingEncoding: NSASCIIStringEncoding]];

smtp = [[CWSMTP alloc] initWithName:@"smtp.gmail.com" port:465];
[smtp setDelegate: self];
[smtp setMessage: message];
[message release];

ssl = YES;
mechanism = @"PLAIN";

[smtp connectInBackgroundAndNotify]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-11T23:11:23.897

这是一个。我自己没试过，但你可以试一试......

[http://code.google.com/p/skpsmtpmessage/](http://code.google.com/p/skpsmtpmessage/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T21:10:22.567

您还可以查看 OmniGroup 的[开源框架](http://www.omnigroup.com/developer/)，尤其是 OmniNetworking 框架。您可能会考虑使用它们的其他框架中的许多其他很棒的组件。

# php - 睡眠时间是否计入执行时间限制？

> ID：740954
> 
> 赞同：59
> 
> 时间：2009-04-11T23:06:20.743
> 
> 标签：php, sleep, execution, max

`sleep()`关于PHP中的函数，我有两个问题：

1.  睡眠时间会影响我的 PHP 脚本的最大执行时间限制吗？有时，PHP 会显示消息“超出最大执行时间 30 秒”。如果我使用 会出现此消息`sleep(31)`吗？

2.  使用该功能是否有风险`sleep()`？是否会消耗大量 CPU 性能？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-04-11T23:09:30.253

您应该尝试一下，只要有一个休眠时间超过您的最大执行时间的脚本。

```
<?php
  sleep(ini_get('max_execution_time') + 10);
?> 
```

剧透：[在 Linux 下，睡眠时间被忽略，但在 Windows 下，它算作执行时间。](http://www.php.net/manual/en/function.set-time-limit.php#75557)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-11T23:13:07.467

它只影响脚本时间而不是像 sleep() 这样的系统调用。显然存在一个错误，其中包含 Windows sleep() 。最大执行时间是实时的，而不是 CPU 时间或类似的东西。但是，您可以更改它：

*   [php.ini 中的max_execution_time](http://au2.php.net/manual/en/info.configuration.php#ini.max-execution-time)指令。这是一个全局设置；
*   将[ini_set()](http://au2.php.net/ini_set)与上述指令一起使用。这将仅针对当前执行的脚本更改它，仅针对该执行；
*   [set_time_limit()](http://au2.php.net/set_time_limit)：也是本地更改。

至于最后两者的区别，我相信 max_execution_time 是一个固定的量。跑步：

```
ini_set('max_execution_time', 60); 
```

将脚本限制为 60 秒。如果您在 20 秒后致电：

```
set_time_limit(60); 
```

脚本现在将限制为 20 + 60 = 80 秒。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-11T23:15:03.530

在[PHP sleep() 页面](http://www.php.net/sleep)中，有这个用户提供的注释：

> 注意： set_time_limit() 函数和配置指令 max_execution_time 只影响脚本本身的执行时间。在确定脚本运行的最长时间时，不包括在脚本执行之外发生的活动所花费的任何时间，例如使用 system() 的系统调用、sleep() 函数、数据库查询等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T23:52:34.720

其他人已经介绍了 sleep() 和 PHP 脚本执行时间限制的基础知识，但是您还应该注意使用非常长的睡眠时间时的另一个风险。

通常，当浏览器向服务器发送请求但没有从服务器接收任何数据时，连接可能会超时。这个时间限制取决于浏览器的配置，但我读过 IE7 的默认值只有 30 秒，而[Firefox 的默认值是 115 秒——你可以通过](http://kb.mozillazine.org/Network.http.keep-alive.timeout)**about:config**在 Firefox 中检查自己的配置并过滤**network.http.keep-alive.timeout**（时间限制以秒为单位指定）。

编辑：我把 network.http.keep-alive.timeout 和 browser.urlbar.search.timeout 的单位搞混了。它确实以秒为单位，而不是十分之一秒。

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2009-04-11T23:10:59.047

a) 是的，它计入时间限制（因此 sleep(31) 将触发错误）

b) 它与消耗 CPU 性能相反——它让其他应用程序使用 CPU（当应用程序休眠时，该应用程序的 CPU 使用率将接近 0%）。除了从用户身上抽出时间之外，我真的想不出使用它的任何风险。

# java - Swing：为什么我的自定义组件不会重绘？

> ID：740956
> 
> 赞同：1
> 
> 时间：2009-04-11T23:07:46.683
> 
> 标签：java, user-interface, swing

Item 是一个简单的模型类。

ItemComponent 是一个 Item 的视图，它只在给定的位置绘制简单的矩形。一堆 ItemComponent 实例被放入添加到应用程序的 JFrame 的父组件中（现在只是一个简单的 shell）。

该视图有两种不同的显示样式。我想调整模型的一些属性，并可能改变状态（控制样式），然后调用 update() 重新绘制。

问题是，据我所知……paint() 只被调用一次。repaint() 似乎没有效果。

怎么了？

我不是 Swing 程序员，而是从示例中拼凑起来的，所以我希望这可能是一些我不明白的微不足道的事情。

```
public class ItemComponent extends JComponent implements ItemView {

    private static final Color COLOR_FILL_NORMAL = new Color(0x008080ff);
    private static final Color COLOR_FILL_TARGET = Color.LIGHT_GRAY;
    private static final Color COLOR_OUTLINE = new Color(0x00333333);

    Item item;
    RoundRectangle2D rect;
    State state = State.NORMAL;
    float alpha = 1.0f;

    public ItemComponent(Item item) {
        this.item = item;
        this.rect = new RoundRectangle2D.Double(0, 0, 0, 0, 5, 5);
        item.setView(this);
    }

    public void setState(State state) {
        this.state = state;
    }

    public void update() {
        System.out.println("ItemComponent.update");
        setLocation(item.getLeft(), 1);
        setSize(item.getWidth(), getParent().getHeight()-1);
        rect.setRoundRect(0, 0, getWidth()-1, getHeight()-1, 5, 5);

        repaint();
        //paintImmediately(getBounds());
    }

    @Override
    public void addNotify() {
        update();
    }

    @Override
    public void paint(Graphics g) {
        System.out.println("paint");

        Graphics2D g2 = (Graphics2D)g;

        g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, alpha));

        if (state == State.NORMAL) {
            System.out.println("draw normal");
            g2.setPaint(COLOR_FILL_NORMAL); // light blue
            g2.fill(rect);

            g2.setPaint(COLOR_OUTLINE);
            g2.draw(rect);
        }
        else if (state == State.TARGET) {
            System.out.println("draw target");
            g2.setPaint(COLOR_FILL_TARGET);
            g2.fill(rect);

            float[] dashPattern = { 8, 5 };
            g2.setStroke(new BasicStroke(2, BasicStroke.CAP_BUTT, BasicStroke.JOIN_MITER, 10, dashPattern, 0));
            g.setColor(COLOR_OUTLINE);
            g2.draw(rect);
        }
    }
} 
```

* * *

**提示：** 我追踪到 repaint() 并发现 isDisplayable() 正在检查的点，它返回 false。它确保 getPeer() != null。

所以我的组件没有对等？那是怎么回事？它被添加到一个容器中，该容器本身被添加到应用程序的其余部分。它被绘制一次，所以我知道它是可见的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T00:01:57.240

我向已经看过这个的人道歉。为了发布，我稍微删减了代码，无意中遗漏了一个关键部分：

```
@Override
public void addNotify() {
    update();
} 
```

添加后，我正在使用它进行一些设置。事实证明，你不覆盖它是非常关键的，或者至少你需要调用 super.addNotify()，否则一大堆重要的初始化不会发生。

将其更改为此可以解决问题：

```
@Override
public void addNotify() {
    super.addNotify();
    update();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T23:58:42.847

答案就[在这里](http://java.sun.com/products/jfc/tsc/articles/painting/index.html)。特别是关于[在 Swing 中绘画](http://java.sun.com/products/jfc/tsc/articles/painting/index.html#swing)的部分。我很困惑将渲染代码移动到 paintComponent() 并没有按照 Johannes Rössel 的建议工作。正如那里的文件所说..

> 绘画方法
> 
> 适用于 AWT 轻量级组件的规则也适用于 Swing 组件——例如，paint() 在渲染时被调用——除了 Swing 进一步将 paint() 调用分解为三个单独的方法，这些方法在以下顺序：
> 
> ```
> protected void paintComponent(Graphics g)
> protected void paintBorder(Graphics g)
> protected void paintChildren(Graphics g) 
> ```
> 
> Swing 程序应该覆盖paintComponent() 而不是覆盖paint()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T21:06:14.220

你会想打电话`repaint()`让你`JComponent`重新粉刷自己而不是更新。

而不是覆盖`paint( Graphics g )`，而是覆盖`paintComponent( Graphics g )`并放置您的自定义渲染代码。

确保调用`super.paintComponent( g )`被覆盖方法的第一行，因为会发生一些键初始化。

另外需要注意的是，根据要添加 ItemComponent 的容器的 LayoutManager，可能需要显式设置大小。我看到您正在尝试在 update() 方法中执行此操作。您应该只需要设置一次大小，最好将其放在构建组件并将其添加到容器的代码中。

对于您要执行的操作，只需要覆盖paintComponent()。您应该删除所有其他覆盖的方法。

`repaint()`从调用`setState()`。如果组件的大小取决于传入的状态，您可能想在`setSize()`之前调用`repaint()`.

希望有帮助。

# email - 电子邮件中对 UTF-8 的支持程度如何？

> ID：740957
> 
> 赞同：8
> 
> 时间：2009-04-11T23:08:12.377
> 
> 标签：email, utf-8

各种电子邮件客户端对 UTF-8 的支持程度如何？

我知道这在大约五年前是个问题——但这仍然是我们应该担心的事情吗？

我想知道是否应该在发送之前将字符串重新编码为其他编码。例如，俄语文本将存储为 UTF-8，但在发送电子邮件通知时，我可以将其即时重新编码为 ISO-8859-5。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-11T23:13:02.850

这是几乎所有电子邮件客户端的[比较](http://en.wikipedia.org/wiki/Comparison_of_email_clients#Features)，以及它是否支持 UTF-8

另外，维基百科说：

> Internet Mail Consortium (IMC) 建议所有电子邮件程序都能够使用 UTF-8 显示和创建邮件。

但如果需要，您也可以发送多种格式的电子邮件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-11T23:25:32.973

我发现 UTF-8 可能存在问题的唯一地方是日本，至少在几年前，许多网络邮件服务和较旧的移动设备仍然无法顺利应对它。有点难过，尤其是原生多字节编码（Shift-JIS、ISO-2022-JP 等）都非常糟糕。

其他具有多字节字符集的东亚国家也可能受到影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-31T15:50:36.240

今天，当将俄罗斯 UTF-8 文本重新编码为 ISO-8859-5 时，新的 UTF-8 俄罗斯卢布货币字符 U+20BD RUBLE SIGN 存在乱码的风险。ISO-8859-1（Latin1）中的欧元货币字符支持也存在同样的问题，我的意思是不支持。我发现这些文章对电子邮件中的国际字符支持非常有帮助 [http://kb.mailchimp.com/accounts/management/international-characters-in-mailchimp](http://kb.mailchimp.com/accounts/management/international-characters-in-mailchimp) [https://wordtothewise.com/2010/03/which-is -better-utf-8-or-iso/](https://wordtothewise.com/2010/03/which-is-better-utf-8-or-iso/)

这是代码页 ISO-8859-5 和俄罗斯卢布货币字符问题的 C# 代码示例：

```
using System;
using System.Text;

namespace ConsoleApplication4
{
class Program
{
    static void Main(string[] args)
    {
        string russian_text = "Русский текст co знаком валюты рубля ₽";

        Console.OutputEncoding = Encoding.UTF8;
        Console.WriteLine(russian_text);

        var encoded_bytes = Encoding.Convert(Encoding.UTF8, Encoding.GetEncoding("ISO-8859-5"), Encoding.UTF8.GetBytes(russian_text));

        Console.OutputEncoding = Encoding.GetEncoding("ISO-8859-5");
        Console.WriteLine(Encoding.GetEncoding("ISO-8859-5").GetString(encoded_bytes));
    }
} 
```

}

# c# - C# 泛型与 C++ 模板 - 需要澄清约束

> ID：740969
> 
> 赞同：11
> 
> 时间：2009-04-11T23:14:04.063
> 
> 标签：c#, c++, generics, templates

### 复制

> [C# 和 Java 中的泛型……和 C++ 中的模板有什么区别？](https://stackoverflow.com/questions/31693/what-are-the-differences-between-generics-in-c-and-java-and-templates-in-c)

* * *

大家好，

我是经验丰富的 C++ 程序员，但对 C# 很陌生。

这些约束和泛型是怎么回事？为什么它与在 C++ 中的工作方式不同，在 C++ 中，约束是隐式的，并且是从您对模板类所做的实例化派生的？

为什么微软不让它像在 C++ 中一样工作？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-12T01:20:42.807

好吧，总的来说，C++ 模板和 C# 泛型是*相似的——与**完全*不同的 Java 泛型相比，它们也有很大的不同。与 C# 一样，通过使用反射获得运行时支持，获取描述用于实例化泛型的类型的对象。C++ 没有反射，它对类型所做的一切都是在编译时完成的。

C# 泛型和 C++ 模板之间的最大区别确实是 C# 泛型是更好的类型检查。它们总是受到约束，因为它们不允许在定义泛型时未声明有效的操作。C# 的首席设计师提出了隐含约束会增加复杂性的原因。我不太熟悉C#，所以我不能在这里多说。我将讨论 C++ 中的问题以及它们将如何改进，这样人们就不会认为 C++ 的东西都是错的。

在 C++ 中，模板不受约束。如果您执行操作，则在模板定义时暗示该操作将在实例化时成功。C++ 编译器甚至不需要在语法上检查模板的有效性。如果它包含语法错误，则必须在实例化时诊断该错误。在此之前的任何诊断都是实施的纯粹好处。

这些隐含的约束在短期内对模板设计者来说很容易，因为他们不必关心在模板界面中说明有效操作。他们将负担放在模板的用户身上——因此用户必须确保他满足所有这些要求。通常情况下，用户尝试看似有效的操作但失败了，编译器会向用户提供数百行关于某些无效语法或未找到名称的错误消息。因为编译器一开始不知道具体违反了*什么*约束，它列出了错误位置周围的所有代码路径部分，甚至所有不重要的细节，用户将不得不爬过可怕的错误消息文本。

这是一个基本问题，可以通过在模板或泛型的接口处声明类型参数必须具有的属性来解决。据我所知，C# 可以约束参数以实现接口或继承基类。它在类型级别上解决了这个问题。

C++ 委员会早就看到需要解决这些问题，~~并且很快（可能在明年），C++ 也将有一种方法来说明这些明确的约束~~（*参见下面的时间机器注释*），如下例所示。

```
template<typename T> requires VariableType<T>
T f(T a, T b) {
    return a + b; 
} 
```

编译器此时会发出错误信号，因为所写的表达式未被要求标记为有效。这首先有助于模板的设计者编写更*正确*的代码，因为代码已经在某种程度上进行了类型检查（以及那里可能的情况）。程序员现在可以说明该要求：

```
template<typename T> requires VariableType<T> && HasPlus<T, T>
T f(T a, T b) {
    return a + b; 
} 
```

现在，它将编译。编译器通过看到`T`作为返回类型出现，自动暗示它`T`是可复制的，因为这种使用`T`出现在接口中，而不是在模板主体中。其他要求使用要求条款说明。现在，如果用户使用`op+`未定义的类型，他将收到相应的错误消息。

C++1x 将需求与类型分离。以上适用于原始类型以及类。从这个意义上说，它们更灵活，但也相当复杂。规定何时以及何时满足要求的规则很长......您可以使用新规则说以下内容：

```
template<typename T> requires MyCuteType<T>
void f(T t) { *t = 10; } 
```

然后，`f`用`int`! 这可以通过编写一个概念图来`MyCuteType<int>`教编译器如何取消引用 int 。它会在这样的循环中变得非常方便：

```
for_each(0, 100, doSomething()); 
```

由于程序员可以告诉编译器 int 如何满足 an 的概念`input iterator`，如果您只编写适当的概念图，您实际上可以在 C++1x 中编写这样的代码，这真的不是那么困难。

好的，这就够了。我希望我可以向您展示，限制模板并不是那么糟糕，但实际上*更好*，因为编译器现在知道模板中类型和对它们的操作之间的关系。而且我什至还没有写过，这是' 概念`axioms`中的另一件好事。`C++1x`请记住，*这是未来*的东西，它还没有出来，但大约会在 2010 年。然后我们将不得不等待一些编译器来实现这一切:)

* * *

# 来自“未来”的更新

C++0x 概念*没有*被接受到草案中，但在 2009 年底被否决。太糟糕了！但也许我们会在下一个 C++ 版本中再次看到它？让我们都充满希望！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-12T01:30:55.420

**C++ 模板：**编译器检查参数是否满足代码设置的约束。例如：

```
template <typename T, unsigned int dim>
class math_vector
{
    T elements[dim];

    math_vector<T,dim> operator+ (const math_vector<T,dim>& other) const
    {
        math_vector<T,dim> result;
        for (unsigned int i = 0; i < dim; ++i)
            result.elements[i] = elements[i] + other.elements[i];
    }
}

struct employee
{
    char name[100];
    int age;
    float salary;
}

math_vector<int, 3> int_vec; //legal
math_vector<float, 5> float_vec; //legal
math_vector<employee, 10> employee_vec; //illegal, operator+ not defined for employee 
```

在此示例中，您可以创建一个类，`operator+`为其定义并将其用作`math_vector`. 因此，当且仅当模板参数满足模板代码定义的约束时，模板参数才有效。这是非常灵活的，但会导致编译时间较长（每次实例化模板时都必须检查类型是否满足模板的约束）。

**C# 泛型：**不是检查每个特定实例化的有效性，这会导致更长的编译时间并且容易出错，而是明确声明泛型的参数必须实现特定的接口（一组方法、属性和运算符）。在泛型的代码中，您不能随意调用任何方法，只能调用该接口支持的方法。每次实例化泛型时，运行时不必检查参数是否满足一长串约束，而只需检查它是否实现了指定的接口。当然，这不太灵活，但也不太容易出错。例子：

```
class SortedList<T> where T : IComparable<T>
{
    void Add(T i) { /* ... */ }
}

class A : IComparable<A> { /* ... */ }

class B
{
    int CompareTo(B b) { /* ... */ }
    bool Equals(B b) { /* ... */ }
}

SortedList<A> sortedA; // legal
SortedList<B> sortedB; // illegal
// B implements the methods and properties defined in IComparable,
// however, B doesn't explicitly implement IComparable<B> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T23:19:06.593

我敢肯定，您很快就会得到更好的答案。到时候我会删掉这个。

不同之处在于 C++ 中的模板类似于宏。当模板被实例化时，代码被编译，如果违反了隐式约束，则会显示编译错误。这就是您可以进行模板特化的方式 - 模板基本上已经被特化扩展了，所以这就是使用的模板。

.NET（也在 VB.NET）中的泛型是运行时构造。他们是一种特殊的类型。约束是必要的，以确保在最终使用该类型时，该类型的任何实际使用都是有效的。

您实际上可以使用反射来查看泛型类型并找到用于实例化它的类型参数，或者查看泛型定义并查看每个类型参数的约束。在 C++ 中，这些信息在运行时就已经消失了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T23:20:44.250

C# 泛型与 C++ 完全不同。

在 C# 中，编译器基本上为所有对象类型编译一个类定义，并为每个值类型编译一个类定义。

在 C++ 中，每种类型都有自己的类定义。

这些约束仅适用于编译器，因此您可以从其他位置推断出东西。

我建议查看`Action<T>`,`Func<T, T>`和`Predicate<T>`代表以及相关的`IEnumerable`扩展方法。将 lambda 函数与这些函数一起使用，您将看到约束在做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-12T02:30:52.780

模板和泛型确实是不同的东西。泛型的目标之一是能够以跨库、跨语言的方式使用它们，这与 C++ 模板不同。它们是 CLR 概念，而不是语言概念（尽管它们显然需要语言支持）。

在 C++ 中，可以以“类固醇上的宏”的方式看到模板（请不要火焰，我知道模板不是宏），因为您可以将它们视为文本扩展，然后对其进行编译。这使他们能够使用模板参数上定义的任何内容（例如主要是运算符），因为使用它们的代码会施加约束。

在 .NET 中，由于泛型在运行时被解析（实例化），因此必须在定义级别施加约束，以便编译器可以确保它们的使用是有效的（这意味着您不能在泛型参数上使用运算符，因为您不能指示限制运算符的存在）。

正如我所说，泛型的主要目的是能够创建通用 dll 以供其他项目使用。这就是它们不同的原因。

# c# - UpdatePanels - 重新渲染外部控件？

> ID：740975
> 
> 赞同：3
> 
> 时间：2009-04-11T23:20:14.437
> 
> 标签：c#, .net, asp.net, updatepanel

我有一个相当复杂的 UI 页面，其中嵌套了几个 UpdatePanel。所有这些都设置为`UpdateMode = "Conditional"`

我在所有更新面板之外都有一个列表框。奇怪的是，当单击 UpdatePanel 中的任何按钮时，这些列表框上会出现闪烁。

我的理解是，如果模式是有条件的，这不应该发生。

关于从哪里开始故障排除的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T15:20:34.427

在父 UpdatePanel 上，将 ChildrenAsTriggers 属性设置为 False，并查看使用要更新的 UpdatePanel 的 Triggers 元素来明确指定触发器。

```
<asp:UpdatePanel ID="myUpdatePanel" runat="server" ChildrenAsTriggers="false" UpdateMode="Conditional">
        <ContentTemplate>

        </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="btnTrigger" />
        </Triggers>
    </asp:UpdatePanel> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T23:31:50.900

我不确定，但是当浏览器在其他 UpdatePanel 中重新渲染内容时，它可能会这样做。我想知道如果这种行为会停止，您是否将所有内容都放在“全局”UpdatePanel 中。

# iphone - How much of C++ is supported in Objective-C++

> ID：740989
> 
> 赞同：6
> 
> 时间：2009-04-11T23:40:02.130
> 
> 标签：iphone, objective-c, cocoa, boost, objective-c++

I want to make an iPhone app, but I am planning to make the framework in C++. Is it possible to use things like templates in Objective-C++. I guess really the question is, can I use boost?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-10-02T09:08:09.547

> Is it possible to use things like templates in Objective-C++.

Yes, but you need to take care how you mix types and interfaces between the pure C++ layers and the Objective-C++ code. Keep in mind the boundaries between layers, where you would need to convert types such as `std::string` to `NSString`, and so on.

For example, you could implement the core game engine in pure C++, and just implement your controllers and GUI code in Objective-C++. Then the Obj-C++ code is the glue between the pure C++ engine and Cocoa.

> I guess really the question is, can I use boost?

Given the iPhone OS is a subset of OS X that still provides a full POSIX layer, most Boost libraries *should* work just fine. It should be just like writing Darwin code.

There are a number of limitations in Objective-C++ to be aware of (taken directly from the [Objective-C 2.0 Reference Guide](http://developer.apple.com/mac/library/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocCPlusPlus.html#//apple_ref/doc/uid/TP30001163-CH10-SW1)):

*   you cannot use Objective-C syntax to call a C++ object
*   you cannot add constructors or destructors to an Objective-C object
*   you cannot use the keywords this and self interchangeably
*   the class hierarchies are separate; a C++ class cannot inherit from an Objective-C class, and an Objective-C class cannot inherit from a C++ class
*   an exception thrown in Objective-C code cannot be caught in C++ code and, conversely, an exception thrown in C++ code cannot be caught in Objective-C code.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-11T23:42:54.463

All of C++ is supported in Objective C++. It should be possible to use boost, but you might have to port some of the platform dependant things.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-20T06:22:47.817

It should be pointed out that you can't just do everything that you can do in C++ in Objective-C++. For example you can't call virtual functions on C++ objects from an Objective-C class. Once you call into a C/C++ function you can do whatever you want though.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-12T20:55:00.223

Objective C++ is a superset of C++. Everything that you can do in C/C++ can be done in Obj-C++. The "Objective" portion contains, among other things, a Smalltalk-esque messaging system and other additions to C++.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-01T12:58:29.920

C++ objects in Objective C will NOT necessarily act like in C++. For example constructors and destructors are not automatically called and (i think) that you can't implement virtual methods...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-16T21:26:24.667

Boost is useful but it is also a large overhead to add to a project.

Make sure you really need it before you go adding it.

For Regex support: [RegexLite](http://regexkit.sourceforge.net/).

For everything else: **Cocoa**.

# c# - 使用具有相同命名空间的两个 .NET 库

> ID：740991
> 
> 赞同：4
> 
> 时间：2009-04-11T23:41:14.997
> 
> 标签：c#, .net, vb.net, dll

我目前正在为一家公司维护一些旧代码。正如它所发生的那样，我正在修改的当前应用程序使用的是内部库的旧版本（我们称之为 Lib1.dll）。他们还有一个名为 Lib2.dll 的库的新版本，它在许多方面对以前的库进行了改进。

不幸的是，Lib2 不向后兼容 Lib1。更糟糕的是，它们都使用相同的命名空间 Product.Common。

如何在同一个项目中使用 Lib2 和 Lib1？现在，如果我添加对它们的引用，VS 会告诉我某些类是不明确的（这是有道理的，因为它们使用相同的命名空间）。

基本上，我需要类似的东西：

```
Imports Lib1:Product.Common.Class 
```

我正在使用 VB.NET 1.1。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-11T23:56:32.637

我找到了一个博客条目，其中包含 C# 中的解决方案，不确定 VB.NET 中的解决方案。

[外部别名演练](https://docs.microsoft.com/en-us/archive/blogs/ansonh/extern-alias-walkthrough) 和 [C# 2.0：在一个应用程序中使用同一 dll 的不同版本](https://docs.microsoft.com/en-us/archive/blogs/abhinaba/c-2-0-using-different-versions-of-the-same-dll-in-one-application)

* * *

### 编辑：

看来你运气不好。.NET 1.1 似乎没有解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T00:22:18.050

您可以添加另一个项目来“托管”您的一个 Lib 项目。基本上只需添加一个层以将命名空间嵌套更深一层，这样就不会再引起冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T23:47:27.570

如果 Lib2.dll 比 Lib1.dll 有所改进，为什么还需要 Lib1.dll？最好的办法是从您的项目中删除 Lib1.dll 并只使用 Lib2.dll。

如果没有，请尝试此链接，看看是否有帮助

[http://blogs.msdn.com/ansonh/archive/2006/09/27/774692.aspx](http://blogs.msdn.com/ansonh/archive/2006/09/27/774692.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T01:08:01.497

我认为乔尔的回答可能是最简单的方法。但另一个更极端的选择是通过 ildasm 运行程序，在命名空间上进行搜索替换，然后通过 ilasm 运行结果。

使用这种方法可能会遇到其他问题，例如签名，但它允许您“重命名”程序集中的命名空间。

# wxpython - 如何在 wxpython 中绘制透明框架

> ID：740993
> 
> 赞同：2
> 
> 时间：2009-04-11T23:43:14.930
> 
> 标签：wxpython, wxwidgets, transparent, shaped-window

**更新**我完全改写了这个问题

我想创建一个带圆角的窗口，它也是半透明的。

我设法通过调用该方法使框架半透明`SetTransparent( alpha )`，但是，我仍然不知道如何使窗口没有背景。

我试图获取窗口的设备上下文（dc）并将背景画笔设置为，`wx.TRANSPARENT_BRUSH`但这似乎没有任何效果。

[例如，我正在寻求一种与此类](http://www.launchy.net/images/amarok.png)似的效果，但我想在不使用位图的情况下进行（即没有任何外部媒体文件）。

**如何将背景设置为空？**

### 更新：

看来我想要的是所谓的“异形窗”。我正在进一步研究*，*但问题仍然是：如何在不使用任何外部媒体文件的情况下制作一个（即纯粹在代码中）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T16:05:16.423

令人惊讶的是没有人给出答案..

是的，正如 FogleBird 所说，它已经完成了`SetShape`，但问题是如何在不使用图像文件的情况下获得圆形矩形的形状。

我找到了一种方法，即创建一个空位图并使用内存 dc 在其上绘制一个圆角矩形

```
def GetRoundBitmap( w, h, radius ):
    maskColor = wx.Color(0,0,0)
    shownColor = wx.Color(5,5,5)
    b = wx.EmptyBitmap(w,h)
    dc = wx.MemoryDC()
    dc.SelectObject(b)    
    dc.SetBrush(wx.Brush(maskColor))
    dc.DrawRectangle(0,0,w,h)
    dc.SetBrush(wx.Brush(shownColor))
    dc.DrawRoundedRectangle(0,0,w,h,radius)
    dc.SelectObject(wx.NullBitmap)
    b.SetMaskColour(maskColor)
    return b

def GetRoundShape( w, h, r ):
    return wx.RegionFromBitmap( GetRoundBitmap(w,h,r) ) 
```

我发现的一个问题是形状是安静的别名。不完全是一个漂亮/花哨的窗口，但总比没有好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T02:31:15.493

您需要 SetShape 方法。

[http://docs.wxwidgets.org/stable/wx_wxtoplevelwindow.html#wxtoplevelwindowsetshape](http://docs.wxwidgets.org/stable/wx_wxtoplevelwindow.html#wxtoplevelwindowsetshape)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-09T08:24:18.253

查看 wxWidgets\samples\shape （在 wxWidget 中），它显示了一个起始形状的窗口。

# wpf - 使用 WPF 对象在另一个上“打孔”？

> ID：740994
> 
> 赞同：2
> 
> 时间：2009-04-11T23:44:14.317
> 
> 标签：wpf, xaml, bitmapeffect

我有一个椭圆，它只是一个圆。我的问题是我想从大圆圈的中间切出一个圆形孔，但似乎没有任何效果。我试过不透明蒙版，但没有任何效果。

更复杂的是，大圆圈有一个 DropShadowEffect。但是因为这个圆圈是略微透明的，所以你可以看到它后面有一个很大的阴影圆圈。这不是模型的样子，我想知道是否有办法让阴影只出现在圆的边缘周围，不管所说的圆有多透明。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T01:44:06.917

像这样的例子：

```
<Canvas>
<Path Stroke="Black">
  <Path.Data>
    <CombinedGeometry GeometryCombineMode="Exclude">
      <CombinedGeometry.Geometry1>
        <EllipseGeometry Center="100,100" RadiusX="100" RadiusY="100"></EllipseGeometry>
      </CombinedGeometry.Geometry1>
      <CombinedGeometry.Geometry2>
        <EllipseGeometry Center="100,100" RadiusX="80" RadiusY="80"></EllipseGeometry>
      </CombinedGeometry.Geometry2>
    </CombinedGeometry>
  </Path.Data>
</Path>
</Canvas> 
```

对于阴影：这也应该解决，因为生成的对象*实际上*是一个圆圈，其中有一个整体，而不仅仅是一个不透明度-“技巧”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T23:47:59.347

不使用 Ellipse，而是使用 Path，并使用 Exclude GeometryCombineMode 让 Path.Data 成为由两个椭圆组成的 CombinedGeometry。

# java - 如何以编程方式找到主执行类的完整路径

> ID：740999
> 
> 赞同：2
> 
> 时间：2009-04-11T23:50:43.383
> 
> 标签：java, classpath, classloader

我正在尝试以编程方式本地化属性文件，而不必将命令行上的完整路径名传递给我的程序。我想如果我可以找到主类的路径，我可以将我的属性文件放在同一目录或子目录中。

如果这不起作用，是否有其他方法可以找到属性文件的路径，而无需在命令行中传递它。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-12T00:01:40.767

如果预计文件相对于主类定位，您可以使用[`Class.getResource()`](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getResource(java.lang.String))or[`Class.getResourceAsStream()`](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String))如下：

```
class MainClass {
    public static void main( String[] args ) {
        URL props = MainClass.class.getResource( "foo.properties" );
        // ...
    }
} 
```

这些将分别返回 a`URL`或 an `InputStream`；有一个[`Properties.load()`](http://java.sun.com/javase/6/docs/api/java/util/Properties.html#load(java.io.InputStream))接受`InputStream`.

您可以在子目录等中指定相对于类的位置的路径，或者`getResource()`在另一个类上使用该方法来获取相对于该位置的文件。

如果要计算相对于当前工作目录的路径（不一定与主类的父级相同），则可以使用以下方法获取该路径：

```
String cwd = System.getProperty( "user.dir" ); 
```

文档中有可用系统属性的列表[`System.getProperties()`](http://java.sun.com/javase/6/docs/api/java/lang/System.html#getProperties())。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T09:20:28.723

您可以[使用 ClassLoader 来定位应用程序目录](http://illegalargumentexception.blogspot.com/2008/04/java-finding-application-directory.html)，但正如[Rob 所说](https://stackoverflow.com/questions/740999/how-can-i-programmatically-find-the-full-path-of-the-main-executing-class/741011#741011)，最好直接从类路径加载属性文件。****