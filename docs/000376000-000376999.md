# StackOverflow 问答 000376000-000376999

# algorithm - 子集和问题的这个变体更容易解决吗？

> ID：376003
> 
> 赞同：11
> 
> 时间：2008-12-17T20:57:20.303
> 
> 标签：algorithm, dynamic-programming, np-complete, subset-sum

我有一个与[子集和](http://en.wikipedia.org/wiki/Subset_sum_problem)问题有关的问题，我想知道这些差异是否使它更容易，即可以在合理的时间内解决。

给定一个值 V、一个集合大小 L 和一个数字序列 [1,N] S，S 中有多少个大小为 L 的子集总和小于 V？

这在三个方面不同于子集和问题：

1.  我关心有多少子集**小于**给定值，而不是有多少**相等**。
2.  子集大小是固定的。
3.  我关心**有多少**集合总和小于 V，而不仅仅是是否存在。

有没有合理有效的算法来解决这个问题？

编辑：显然，这可以使用组合生成算法在 O(N choose L) 中完成。我真正感兴趣的是可以显着加快速度的巧妙技巧。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-17T21:26:53.647

（决策版本）您的问题仍然是 NP 完全的。这个想法是，如果我们可以解决您的问题，那么（例如，对于每个子集大小）我们可以询问有多少集合总和小于 V，有多少集合总和小于 V-1，这两个数字的差将告诉我们是否是子集的总和正好为 V——因此我们可以解决子集和问题。[这不是一个完整的证明，因为它是[图灵归约](http://en.wikipedia.org/wiki/Turing_reduction)，而不是[多一归约](http://en.wikipedia.org/wiki/Many-one_reduction)。]

但是，有一个简单的**动态规划**解决方案可以在 O(nLV) 时间内运行。[这不能证明 P=NP 的原因是 V 可以是输入大小的指数：使用 n 位，您可以表示高达 2 ^n的值。但假设你的 V 不是指数的，这不是问题。]

让 num[v][k][i] 表示 S 的前 i 个元素的大小为 k 的子集的数量，它们总和为 v。您可以将它们计算为（对于每个 i）：

```
 num[0][0][i] = 1
    for v = 1 to V:
        for k = 1 to L:
            num[v][k][i] = num[v][k][i-1] + num[v-S[i]][k-1][i-1] 
```

其中 S[i] 是序列中的第 i 个元素。（总和为 v 的任何大小 k 集合要么不使用 S[i]，所以它被计入 num[v][k][i-1]，或者它使用 S[i]，这意味着其余的该子集有 k-1 个元素，仅使用序列中的前 i-1 个数字，并求和为 vS[i]。）最后，为每个小于 V 的 v 计数 num[v][L][|S|] ; 这就是你的答案。

此外，如果您仔细操作，您可以省略第三个下标（为每个 i 向下运行循环，等等）；我只是为了清楚起见才包括它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T21:13:11.223

我不准备提供证明，但这听起来可能适合动态编程方案：将大小为 2 的子集列表制成表格，将它们用于计算机大小为 3 的子集，等等，这样你只需要检查一个前景的小集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T21:04:13.147

想到的一种优化是：订购您的序列（如果不是这样的话）。从开头选择前 L-1 个项目，然后选择最后一个项目，使其成为可能的最大值（序列中的下一个最大值会给出一个太大的总和）。丢弃序列的其余部分，因为这些项目无论如何都不能成为有效子集的一部分。

在那之后，我想它又是完整的搜索。但话又说回来，也可能有其他优化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-16T22:32:19.570

子集和问题的动态规划解决方案生成一个包含该答案的表（即 V 乘 N 的布尔表，其中 V 是最大元素数，N 是满足约束；如果 <=N 个元素总和为 <=V，则每个布尔值都为真。因此，如果 N * V 对您来说不是太大，则存在可接受的快速算法。子集和解就是该表中元素数 <= N/2 的最高集合元素。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-13T15:47:33.583

如果它只是正整数，你可以*根据需要*做一个验证步骤；

取集合中 L-1 个最小整数的总和。*如果这是和 X，那么如果问题应该*有解决方案，则 nX 必须低于最大元素。想一想，你可以这样消除其他L...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T21:04:35.017

好吧，一方面，因为您指定 size=L 那么即使您想不出任何聪明的方法而只是使用蛮力，在最坏的情况下您将拥有（N选择L）单独的总和，所以它会更好一些比 n^^L （嗯，L+1，因为你会对每个子集求和）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T21:04:35.453

这听起来像是一个 n 选择 k 类别的问题。Skiena 的算法设计手册中介绍了生成 n 的 k 子集，并且该书建议按字典顺序（例如递归）枚举相关子集。然后对每个子集进行求和和比较。

如果您有一个排序集，您大概可以从解决方案空间中剪除不可能的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-15T12:31:20.640

也许动态规划公式适用于 FPTAS 的 PTAS。

# asp.net - asp.net 网站外部 bin 文件夹

> ID：376006
> 
> 赞同：1
> 
> 时间：2008-12-17T20:59:00.707
> 
> 标签：asp.net, iis-5

我可以将我的“bin”文件夹及其所有 .dll 文件放在比站点的 IIS 本地路径/web 根目录更高的级别吗？我需要将我的 dll 文件保存在我的项目之外的目录中，这是可能的，我尝试使用虚拟目录，但 .net 似乎忽略了它。

我可以为我的 bin 文件夹使用虚拟目录吗？

**重复：**此处提供的更多信息：[将 .net 代码添加到经典的 asp 网站，无法在 .dll 文件中引用命名空间](https://stackoverflow.com/questions/375887/adding-net-code-to-a-classic-asp-website-cant-reference-namespaces-in-dll-file)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T21:25:33.260

你不能。也许 GAC 会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T21:27:27.873

你可以。您需要修改应用程序的配置文件以探测该位置：

```
<runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <probing privatePath="MyCoolNewPath/bin" />
  </assemblyBinding>
</runtime> 
```

# algorithm - 什么算法计算集合中公共元素的频率？

> ID：376019
> 
> 赞同：1
> 
> 时间：2008-12-17T21:03:31.960
> 
> 标签：algorithm, complexity-theory

我想了解有助于识别重叠数据集之间的共性和差异的算法信息。

以stackoverflow的标签系统为例：

假设这个问题被赋予了 5 个标签。假设有 1000 个其他问题至少具有这些标签之一。在这 1000 个问题中，有多少问题具有我的原始帖子所没有的共同标签？

另一种更简单的描述方式是自动建议标记系统：

“您用 [5 个我选择的标签] 标记了您的问题。其他类似的问题用 [可能感兴趣的标签列表] 进行了标记。其中 [可能感兴趣的标签列表] 是经常出现的标签，这些标签不在我的原始清单。

如果可能的话，c# 中的代码示例:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T21:09:54.100

查看 Wager-Hamming 距离。这是在字符串上定义的汉明距离，即将一个字符串转换为另一个字符串所需的编辑操作数。

您还可以潜在地使用等价类的偏序并设置包含：当问题 A 和 B 具有完全相同的一组标签直到重新排序时，它们相等，设置并集、设置差异和设置交集，然后定义偏序< 和 > 比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T22:05:44.830

我不知道任何特定的算法或数据结构，但我可以建议一种基本的处理方法：

假设：每个条目有五个唯一的标签。

*   收集包含五个标签中任何一个的所有条目（无重复）。
*   对于列表中的每个条目，为每个标记使用关联数组（哈希表），并递增值。
*   对于数组中的每个条目，将标签名称附加到该数组的条目索引中。

在（草率的）伪代码中，使用两个循环（如果可能）：

```
for each entry
    if any tag in original_tags
        tag_list[tag]++
end

for next in tag_list
    tag_count[tag_list[next]] += next
end 
```

这应该会产生一个稀疏的连接标签名称数组（好吧，我没有包含分隔符，但嘿，它是伪代码:-)。保持最高数字，然后向后迭代以获得最佳建议。

（缓存要优化，但要注意更新）

保罗。

# javascript - 您可以在 Internet Explorer 上捕获这些单选按钮事件吗？

> ID：376021
> 
> 赞同：5
> 
> 时间：2008-12-17T21:04:01.633
> 
> 标签：javascript, jquery, html, internet-explorer

考虑这个示例代码：

```
<div class="containter" id="ControlGroupDiv">
  <input onbeforeupdate="alert('bingo 0'); return false;" onclick="alert('click 0');return false;" id="Radio1" type="radio" value="0" name="test" checked="checked" />  
  <input onbeforeupdate="alert('bingo 1'); return false;" onclick="alert('click 1');return false;"  id="Radio2" type="radio" value="1" name="test" />   
  <input onbeforeupdate="alert('bingo 2'); return false;" onclick="alert('click 2');return false;"  id="Radio3" type="radio" value="2" name="test" />   
  <input onbeforeupdate="alert('bingo 3'); return false;" onclick="alert('click 3');return false;"  id="Radio4" type="radio" value="3" name="test" />   
  <input onbeforeupdate="alert('bingo 4'); return false;" onclick="alert('click 4');return false;"  id="Radio5" type="radio" value="4" name="test" />   
  <input onbeforeupdate="alert('bingo 5'); return false;" onclick="alert('click 5');return false;"  id="Radio6" type="radio" value="5" name="test" />   
</div> 
```

在 FireFox 2 和 3 上，将`return false`单选按钮的 click 事件放在单选按钮上可防止其值和组中所有其他单选按钮的值发生变化。这有效地使其只读而不会禁用它并将其变为灰色。

在 Internet Explorer 上，如果选中了另一个单选按钮并且您单击了组中的另一个单选按钮，则选中的单选按钮会在单击事件触发您单击的单选按钮之前清除。但是，由于单击事件上的“返回 false”，您单击的那个没有被选中。

[根据 MSDN](http://msdn.microsoft.com/en-us/library/ms536913(VS.85).aspx)，[`onbeforeupdate`](http://msdn.microsoft.com/en-us/library/ms536908(VS.85).aspx)在单击事件触发之前，该事件会在控件组中的所有控件上触发，我认为这是清除另一个单选按钮的位置。但是，如果您尝试上面的代码，则不会从`onbeforeupdate`事件中显示任何警报 - 您只会收到点击事件警报。显然，该事件永远不会被触发，或者没有办法捕获它。

是否有任何事件可以捕获以阻止组中的其他单选按钮清除？

请注意，这是一个简化的示例，我们实际上是使用 jQuery 来设置事件处理程序并处理它。

**更新：**

如果将此事件添加到单选按钮之一：

```
onmousedown="alert('omd'); return false;" 
```

弹出警报框，您将其关闭，并且单击事件*永远不会触发*。所以我们认为我们已经弄清楚了，但不，它不可能那么容易。如果您删除警报并将其更改为：

```
onmousedown="return false;" 
```

它不起作用。另一个单选按钮将被清除，并且您单击的按钮上的单击事件会触发。`onbeforeupdate`仍然从不开火。

我们认为这可能是时机（这始终是一个理论，即使它很少是真的），所以我尝试了这个：

```
onmousedown="for (i=0; i<100000; i++) {;}; return false;" 
```

您单击，它会暂停一段时间，然后另一个单选按钮清除，然后单击事件触发。啊！

**更新：**

Internet Explorer 很烂。除非有人想出一个好主意，否则我们将放弃这种方法并使用复选框 jQuery 扩展，它确实可以满足我们的需求，但会给页面带来更重的客户端脚本负担，并且需要对 HTML 进行更多的重新编码，因为ASP.Net 服务器控件呈现和母版页名称修改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T21:28:55.873

是的，这是一个奇怪的错误。我确实想出了一个解决方法。我在这里使用了一些 Prototype 来处理类名。它适用于 IE 和 FF。您可以使用选择器而不是粗略的循环来缩短它。

```
<form name="f1">
<input type=radio onmouseover="recordMe()" onclick="clickCheck();return false" checked value="A" name="r1" id="radio1" />
<input type=radio onmouseover="recordMe()" onclick="clickCheck();return false" value="B" name="r1" id="radio2" />
</form>
<script type="text/javascript">
function recordMe() {
    for(var x=0;x<document.f1.r1.length;x++) {
        if(document.f1.r1[x].checked) {
            $(document.f1.r1[x].id).addClassName('radioChecked')
        }
    }
}
function clickCheck() {
    for(var x=0;x<document.f1.r1.length;x++) {
        if($(document.f1.r1[x].id).hasClassName('radioChecked')) {
            $(document.f1.r1[x].id).checked=true
        }
    }
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T18:50:23.173

我也有这个问题。我们目前实现了jquery，所以我用它来重新检查合适的。显然，您不需要 jquery 来设置复选框的属性。

```
function something(type){//type can be 1 or 0
     if(confirm("You will lose all unsaved changes. Continue?")){
     //Do stuff
          switch(type){
               case 1:
                break;
               case 0;
                break;
                default:
                //nothing;
                 break;
          }//!End of switch 
      }else{//They clicked canel
      //Reset checkboxes in IE
          if(type==1){$('#IDofCheckbox1').attr('checked', true);}
          else{$('#IDofCheckbox2').attr('checked', true);}
      }//!End of if they clicked cancel 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T22:11:18.597

你的目标是什么？如果您只想在发生更改时捕获，请在 onclick 事件上运行您的逻辑。（这将通过 onchange 解决 IE 的错误）

如果您尝试更改单选按钮的预期行为 - 我强烈建议您不要这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T20:19:03.123

这些方法都不起作用——我们最终使用了复选框 jQuery 插件，它用可移动的图像替换了复选框和单选按钮。这意味着我们可以控制禁用控件的视图。

PITA，但它有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-15T23:45:05.663

您可以将未选中的单选按钮设置为 ，而不是将`onclick`属性设置为。这会给您相同的效果，除了未选中的单选按钮将变灰。`return false``disabled`

# lisp - 在 Notepad++ 中编译 lisp/scheme

> ID：376022
> 
> 赞同：3
> 
> 时间：2008-12-17T21:04:02.053
> 
> 标签：lisp, scheme, notepad++

我现在非常喜欢 lisp，不幸的是我只能在 Windows 上编写代码。是否可以让 Notepad++ 负责解释我的脚本，并在编译器窗口中显示输出？

如果是，最好使用哪种解释器？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T23:28:08.410

我赞同查理的建议。获取 Emacs 和 SLIME。在 Windows 上，如果 SBCL 出现任何问题，我可能会得到 CLISP。另外，[Lispworks 个人版](http://www.lispworks.com/downloads/index.html)有一个很酷的 IDE，你可以试试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-17T21:06:42.970

我会考虑选择 NT EMACS。所有这些东西都是免费的，如果你觉得无聊，你可以随时运行 Mx psychoanalyze-pinhead。

如果你真的在做 Scheme，看看 Drscheme。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T00:15:38.640

和其他人一样，我建议将 Emacs 用于 Common Lisp。最简单的入门方法是[Lispbox](http://www.gigamonkeys.com/book/lispbox/)，它是 Emacs + Slime + 一些 Common Lisp 实现，功能齐全且已配置。

对于 Scheme，最简单的入门方法是[DrScheme](http://drscheme.org/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T23:36:44.007

只需安装 CLISP，打开命令窗口，转到源文件所在的文件夹并执行：

```
CLISP sourceFile 
```

您可以通过在记事本++ 中创建热键和批处理文件来简化此过程。
（您可能还需要一些东西来保持控制台窗口打开）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-20T00:39:01.567

几个星期以来，我一直非常愉快地使用 Clozure。如果它适用于 Windows，则值得一试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-29T01:30:49.657

如果你真的想使用 Notepad++，它的插件 SDK 可能值得一看。您可以编写一个使用 ECL 提供板载 Lisp REPL 的小型 Notepad++ 插件，并通过定义一组从 Lisp 到插件 SDK 的回调，您可以拥有 Notepad++ 的舒适性和 Emacs 的可脚本性。只是一个无聊的想法。

链接：

*   [ECL](http://ecls.sourceforge.net)：它的“ECLS”sourceforge 项目。
*   [记事本++插件开发](http://sourceforge.net/apps/mediawiki/notepad-plus/index.php?title=Plugin_Development_Quick_Start_Guide)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-18T21:58:51.647

我发现在 emacs 中启动和运行 slime（高级 lisp 交互模式 emacs）有点困难。你确实想要 slime，但是如果你还不知道 emacs，进入的门槛会有点高——或者即使你知道！

幸运的是，有一个更简单的方法。

只需下载[Lisp in a Box 即可](http://common-lisp.net/project/lispbox/)。这有点棘手，因为它们为您提供了一个操作系统和 lisp 实现表。我的建议是选择右下角的 Windows-CLISP 组合，版本[2.37——](http://common-lisp.net/pcl/windows/lispbox-0.7-clisp-2.37.zip)我发现 CLISP 是最容易使用的实现。

[Paul Graham 也使用 Clisp](http://www.paulgraham.com/lispfaq1.html)，这对我来说已经足够好了。

一旦你下载了 LispBox，就让它自动安装，然后点击**BAT FILE**文件来运行 slime。

祝你好运

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-29T07:40:38.243

您可以设置 Notepad++ 以使用 Clisp for Windows 运行您的代码。单击运行并键入。`clisp -i "$(FULL_CURRENT_PATH)"`然后点击保存。-i 是在执行后保持 clisp 窗口打开。

# google-maps - 可在需要登录的页面中使用的地图 API/图层

> ID：376035
> 
> 赞同：2
> 
> 时间：2008-12-17T21:07:42.157
> 
> 标签：google-maps, mapping, gis

我正在开发一个具有允许用户在地图上标记地点（事件、位置等）的功能的应用程序。我不允许使用基本的谷歌地图 api，因为它要求实现地图的页面公开可用。有谁知道可以在非公共页面上自由使用的具有丰富层（包括欧洲、亚洲等）的替代方案？

* * *

这个问题是错误的，但无论如何我都会留下它，以防其他人试图问它。问题是我误解了谷歌已经澄清的谷歌地图 API 上的 TOS。只要不向用户收费，您就可以在需要登录的页面中使用它。

也有开源和免费的替代方案，它们可能更灵活，但作为编程 API 更难，质量也更低。OpenLayers（OenstreetMaps 就是基于它）是最好的也是最流行的一种。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-23T17:34:50.457

你检查过[OpenStreetMap](http://www.openstreetmap.org/)吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T18:11:16.560

对于私人页面，您可能会发现许可一些适当的地图更具成本效益。对于有限的用户群来说可能不会那么昂贵。

你真的需要这样的地图吗？其他一些地理定位来源，如地名词典等。[这里](http://wiki.openstreetmap.org/wiki/Potential_Datasources)列出一些来源。

# algorithm - 混合声音的算法

> ID：376036
> 
> 赞同：65
> 
> 时间：2008-12-17T21:08:19.533
> 
> 标签：algorithm, audio

我有两个需要加在一起的原始声音流。出于这个问题的目的，我们可以假设它们具有相同的比特率和比特深度（比如 16 位采样，44.1khz 采样率）。

显然，如果我只是将它们加在一起，我的 16 位空间就会溢出和下溢。如果我将它们加在一起并除以 2，那么每个音量都会减半，这在声音上是不正确的——如果两个人在一个房间里说话，他们的声音不会变小一半，麦克风可以拾取他们两者都没有碰到限制器。

*   那么在我的软件混音器中添加这些声音的正确方法是什么？
*   我错了吗，正确的方法是将每个音量降低一半？
*   我是否需要添加压缩器/限制器或其他一些处理阶段来获得我想要的音量和混音效果？

-亚当

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-17T21:44:51.333

您应该将它们加在一起，但将结果剪辑到允许的范围以防止上溢/下溢。

如果发生削波，您**将**在音频中引入失真，但这是不可避免的。您可以使用剪辑代码“检测”这种情况并将其报告给用户/操作员（相当于混音器上的红色“剪辑”灯......）

你可以实现一个更“合适”的压缩器/限制器，但是在不知道你的确切应用的情况下，很难说它是否值得。

如果您正在进行大量音频处理，您可能希望将音频电平表示为浮点值，并且只在处理结束时返回 16 位空间。高端数字音频系统通常以这种方式工作。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-04-05T13:45:45.417

我更愿意评论两个排名靠前的回复之一，但由于我的名声微薄（我想），我不能。

“打勾”的答案：加在一起，剪辑是正确的，但如果你想避免剪辑，那就不行了。

链接的答案从 [0,1] 中两个正信号的可行巫毒算法开始，但随后应用一些非常错误的代数来推导有符号值和 8 位值的完全不正确的算法。该算法也不能扩展到三个或更多输入（信号的乘积将下降而总和增加）。

所以 - 将输入信号转换为浮点数，将它们缩放为 [0,1]（例如，一个有符号的 16 位值将变为
`float v = ( s + 32767.0 ) / 65536.0 (close enough...))`
然后对它们求和。

要缩放输入信号，您可能应该做一些实际的工作，而不是乘以或减去巫毒值。我建议保持一个运行平均音量，然后如果它开始漂移高（比如高于 0.25）或低（比如低于 0.01）开始应用基于音量的缩放值。这实质上变成了一个自动级别的实现，并且可以随任意数量的输入进行扩展。最重要的是，在大多数情况下，它根本不会干扰您的信号。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-05-05T08:40:46.987

[这里](http://www.vttoth.com/digimix.htm)有一篇关于混合的文章。我很想知道其他人对此有何看法。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-12-18T10:12:22.320

大多数音频混合应用程序将使用浮点数进行混合（32 位足以混合少量流）。将 16 位样本转换为范围为 -1.0 到 1.0 的浮点数，表示 16 位世界中的满量程。然后将样本相加 - 你现在有足够的空间。最后，如果您最终得到任何值超过满量程的样本，您可以衰减整个信号或使用硬限制（将值限制为 1.0）。

与将 16 位样本相加并让它们溢出相比，这将提供更好的声音效果。这是一个非常简单的代码示例，展示了如何将两个 16 位样本相加：

```
short sample1 = ...;
short sample2 = ...;
float samplef1 = sample1 / 32768.0f;
float samplef2 = sample2 / 32768.0f;
float mixed = samplef1 + sample2f;
// reduce the volume a bit:
mixed *= 0.8;
// hard clipping
if (mixed > 1.0f) mixed = 1.0f;
if (mixed < -1.0f) mixed = -1.0f;
short outputSample = (short)(mixed * 32768.0f) 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-17T22:21:23.317

“安静一半”并不完全正确。由于耳朵的对数响应，将样本分成两半会使其安静 6 分贝——当然很明显，但不是灾难性的。

您可能希望通过乘以 0.75 来妥协。这将使它安静 3 分贝，但会减少溢出的机会，并在它发生时减少失真。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-12-14T15:43:11.497

我不敢相信没有人知道正确的答案。每个人都足够接近，但仍然是一种纯粹的哲学。最接近的，即最好的是：(s1 + s2) -(s1 * s2)。这是一种很好的方法，尤其是对于 MCU。

所以，算法是这样的：

1.  找出您希望输出声音的音量。它可以是信号之一的平均值或最大值。
    `factor = average(s1)` 您假设两个信号都已经正常，**不会溢出 32767.0**
2.  用这个因子对两个信号进行归一化：
    `s1 = (s1/max(s1))*factor`
    `s2 = (s2/max(s2))*factor`
3.  将它们加在一起并使用相同的因子对结果进行归一化
    `output = ((s1+s2)/max(s1+s2))*factor`

请注意，在第 1 步之后，您实际上并不需要返回整数，您可以使用 -1.0 到 1.0 区间内的浮点数，并在最后使用先前选择的功率因数应用返回整数。我希望我现在没有弄错，因为我很着急。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-02-04T21:14:57.303

您还可以使用 y= 1.1x - 0.2x^3 之类的算法为曲线购买一些空间，并在顶部和底部设置一个上限。当播放器一起演奏多个音符（最多 6 个）时，我在[Hexaphone中使用了它。](http://hexaphone.com)

```
float waveshape_distort( float in ) {
  if(in <= -1.25f) {
    return -0.984375;
  } else if(in >= 1.25f) {
    return 0.984375;
  } else {    
    return 1.1f * in - 0.2f * in * in * in;
  }
} 
```

它不是防弹的 - 但可以让您达到 1.25 级，并将剪辑平滑到一个漂亮的曲线。产生谐波失真，这听起来比削波好，在某些情况下可能是理想的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-17T21:15:48.787

如果您需要正确执行此操作，我建议您查看开源软件混音器实现，至少在理论上是这样。

一些链接：

[大胆](http://audacity.sourceforge.net/?lang=en)

[GStreamer](http://gstreamer.freedesktop.org/)

实际上，您可能应该使用库。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-17T21:48:28.203

你把它们加在一起是对的。您始终可以扫描两个文件的总和以查找峰值点，如果它们达到某种阈值（或者如果它及其周围点的平均值达到阈值）则缩小整个文件

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-12-08T01:49:52.423

将样本转换为范围从 -1.0 到 +1.0 的浮点值，然后：

```
out = (s1 + s2) - (s1 * s2); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-17T21:17:24.977

我认为，只要流是不相关的，你就不应该担心太多，你应该能够通过剪辑来度过难关。如果您真的担心剪辑点的失真，那么软限制器可能会正常工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-06-27T08:26:05.907

> 将样本转换为范围从 -1.0 到 +1.0 的浮点值，然后：
> 
> 输出 = (s1 + s2) - (s1 * s2);

|s1 + s2| 时会引入严重失真 接近 1.0（至少当我在混合简单正弦波时尝试过）。我在几个地方阅读了这个建议，但在我看来，这是一种无用的方法。

当波“混合”时，物理上发生的事情是它们的振幅增加，就像这里的许多海报已经建议的那样。任何一个

*   剪辑（也会扭曲结果）或
*   将您的 16 位值汇总为 32 位数字，然后除以您的源数（这就是我的建议，因为这是我知道的唯一避免失真的方法）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-10-22T15:05:03.587

由于您的个人资料表明您在嵌入式系统中工作，因此我假设浮点运算并不总是一种选择。

```
> So what's the correct method to add these sounds together in my software mixer? 
```

如您所料，如果您不想丢失源的音量，添加和剪辑是正确的方法。对于样本`int16_t`，您需要求和`int32_t`，然后限制并转换回`int16_t`。

```
> Am I wrong and the correct method is to lower the volume of each by half? 
```

是的。音量减半有点主观，但您可以在这里看到，音量减半（响度）减少了大约 10 dB（将功率除以 10，或样本值除以 3.16）。但是您的意思显然是将*样本值*降低一半。这是一个 6 dB 的降低，一个明显的降低，但不如将音量减半（[那里](https://www.gcaudio.com/tips-tricks/the-relationship-of-voltage-loudness-power-and-decibels/ "电压_功率_响度")的响度表非常有用）。

通过这 6 dB 的降低，您将避免所有削波。但是当您想要更多输入通道时会发生什么？对于四个通道，您需要将输入值除以 4，即降低 12 dB，从而减少每个通道的响度的一半。

```
> Do I need to add a compressor/limiter or some other processing stage to 
get the volume and mixing effect I'm trying for? 
```

您想要混合，而不是剪辑，并且不损失输入信号的响度。这是不可能的，并非没有某种失真。

正如 Mark Ransom 所建议的，避免削波同时不损失每个通道多达 6 dB 的解决方案是在“添加和削波”和“平均”之间达到某个位置。

那是针对两个来源：添加，除以 1 和 2 之间的某个位置（将范围从 [-65536, 65534] 减小到更小的值），然后进行限制。

如果您经常使用此解决方案进行剪辑并且听起来太刺耳，那么您可能需要使用压缩器来软化限制拐点。这有点复杂，因为您需要使分频因子取决于输入功率。首先单独尝试限制器，只有在您对结果不满意时才考虑使用压缩器。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-03-10T16:08:07.890

我这样做过一次：我使用了浮点数（-1 和 1 之间的样本），并初始化了一个值为 1 的“autoGain”变量。然后我将所有样本加在一起（也可能超过 2 个）。然后我将输出信号与自动增益相乘。如果乘法前信号总和的绝对值高于 1，我将分配 1/这个总和值。这将有效地使自动增益小于 1，比方说 0.7，并且相当于一些操作员一旦看到整体声音变得太大，就迅速调低主音量。然后我会在一段可调的时间内添加到自动增益，直到它最终回到“1”（我们的操作员已经从震惊中恢复过来，并且正在慢慢提高音量:-)）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-08-20T14:54:23.687

```
// #include <algorithm>
// short ileft, nleft; ...
// short iright, nright; ...

// Mix
float hiL = ileft + nleft;
float hiR = iright + nright;

// Clipping
short left = std::max(-32768.0f, std::min(hiL, 32767.0f));
short right = std::max(-32768.0f, std::min(hiR, 32767.0f)); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-07-18T12:53:35.883

我做了以下事情：

```
MAX_VAL = Full 8 or 16 or whatever value
dst_val = your base audio sample
src_val = sample to add to base

Res = (((MAX_VAL - dst_val) * src_val) / MAX_VAL) + dst_val 
```

将 src 的左侧净空乘以 MAX_VAL 标准化目标值并相加。它永远不会剪辑，永远不会那么响亮，听起来绝对自然。

例子：

```
250.5882 = (((255 - 180) * 240) / 255) + 180 
```

这听起来不错:)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-09-12T22:11:45.000

我找到了一种添加样本的新方法，使样本永远不会超过给定范围。基本思想是将-1到1范围内的值转换为大约-Infinity到+Infinity之间的范围，将所有内容加在一起并反转初始转换。为此，我想出了以下公式：

![f(x)=-\frac{x}{|x|-1}](https://latex.codecogs.com/gif.latex?f%28x%29%3D-%5Cfrac%7Bx%7D%7B%7Cx%7C-1%7D)

![f'(x)=\frac{x}{|x|+1}](https://latex.codecogs.com/gif.latex?f'%28x%29%3D%5Cfrac%7Bx%7D%7B%7Cx%7C%2B1%7D)

![o=f'(\sum f(s))](https://latex.codecogs.com/gif.latex?o%3Df'%5Cleft%20%28%20%5Csum%20f%28s%29%20%5Cright%20%29)

我试过了，它确实有效，但是对于多个响亮的声音，产生的音频听起来比仅仅将样本加在一起并剪裁每个太大的值更糟糕。我使用以下代码对此进行了测试：

```
#include <math.h>
#include <stdio.h>
#include <float.h>
#include <stddef.h>
#include <stdint.h>
#include <string.h>
#include <stdbool.h>
#include <sndfile.h>

// fabs wasn't accurate enough
long double ldabs(long double x){
  return x < 0 ? -x : x;
}

// -Inf<input<+Inf, -1<=output<=+1
long double infiniteToFinite( long double sample ){
  // if the input value was too big, we'll just map it to -1 or 1
  if( isinf(sample) )
    return sample < 0 ? -1\. : 1.;
  long double ret = sample / ( ldabs(sample) + 1 );
  // Just in case of calculation errors
  if( isnan(ret) )
    ret = sample < 0 ? -1\. : 1.;
  if( ret < -1\. )
    ret = -1.;
  if( ret > 1\. )
    ret = 1.;
  return ret;
}

// -1<=input<=+1, -Inf<output<+Inf
long double finiteToInfinite( long double sample ){
  // if out of range, clamp to 1 or -1
  if( sample > 1\. )
    sample = 1.;
  if( sample < -1\. )
    sample = -1.;
  long double res = -( sample / ( ldabs(sample) - 1\. ) );
  // sample was too close to 1 or -1, return largest long double
  if( isinf(res) )
    return sample < 0 ? -LDBL_MAX : LDBL_MAX;
  return res;
}

// -1<input<1, -1<=output<=1 | Try to avoid input values too close to 1 or -1
long double addSamples( size_t count, long double sample[] ){
  long double sum = 0;
  while( count-- ){
    sum += finiteToInfinite( sample[count] );
    if( isinf(sum) )
      sum = sum < 0 ? -LDBL_MAX : LDBL_MAX;
  }
  return infiniteToFinite( sum );
}

#define BUFFER_LEN 256

int main( int argc, char* argv[] ){

  if( argc < 3 ){
    fprintf(stderr,"Usage: %s output.wav input1.wav [input2.wav...]\n",*argv);
    return 1;
  }

  {
    SNDFILE *outfile, *infiles[argc-2];
    SF_INFO sfinfo;
    SF_INFO sfinfo_tmp;

    memset( &sfinfo, 0, sizeof(sfinfo) );

    for( int i=0; i<argc-2; i++ ){
      memset( &sfinfo_tmp, 0, sizeof(sfinfo_tmp) );
      if(!( infiles[i] = sf_open( argv[i+2], SFM_READ, &sfinfo_tmp ) )){
        fprintf(stderr,"Could not open file: %s\n",argv[i+2]);
        puts(sf_strerror(0));
        goto cleanup;
      }
      printf("Sample rate %d, channel count %d\n",sfinfo_tmp.samplerate,sfinfo_tmp.channels);
      if( i ){
        if( sfinfo_tmp.samplerate != sfinfo.samplerate
         || sfinfo_tmp.channels != sfinfo.channels
        ){
          fprintf(stderr,"Mismatching sample rate or channel count\n");
          goto cleanup;
        }
      }else{
        sfinfo = sfinfo_tmp;
      }
      continue;
      cleanup: {
        while(i--)
          sf_close(infiles[i]);
        return 2;
      }
    }

    if(!( outfile = sf_open(argv[1], SFM_WRITE, &sfinfo) )){
      fprintf(stderr,"Could not open file: %s\n",argv[1]);
      puts(sf_strerror(0));
      for( int i=0; i<argc-2; i++ )
        sf_close(infiles[i]);
      return 3;
    }

    double inbuffer[argc-2][BUFFER_LEN];
    double outbuffer[BUFFER_LEN];

    size_t max_read;
    do {
      max_read = 0;
      memset(outbuffer,0,BUFFER_LEN*sizeof(double));
      for( int i=0; i<argc-2; i++ ){
        memset( inbuffer[i], 0, BUFFER_LEN*sizeof(double) );
        size_t read_count = sf_read_double( infiles[i], inbuffer[i], BUFFER_LEN );
        if( read_count > max_read )
          max_read = read_count;
      }
      long double insamples[argc-2];
      for( size_t j=0; j<max_read; j++ ){
        for( int i=0; i<argc-2; i++ )
          insamples[i] = inbuffer[i][j];
        outbuffer[j] = addSamples( argc-2, insamples );
      }
      sf_write_double( outfile, outbuffer, max_read );
    } while( max_read );

    sf_close(outfile);
    for( int i=0; i<argc-2; i++ )
      sf_close(infiles[i]);
  }

  return 0;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-10-15T05:44:50.987

谢谢大家分享你的想法，最近我也在做一些与混音相关的工作。我也在这个问题上做过实验，希望对你们有帮助:)。

请注意，我在 ios RemoteIO AudioUnit 中使用 8Khz 采样率和 16 位采样 (SInt16) 声音。

在我的实验中，我发现的最佳结果与所有这些答案不同，但基本是相同的（正如[罗迪](https://stackoverflow.com/users/1737/roddy)建议的那样）

“**您应该将它们加在一起，但将结果剪辑到允许的范围以防止上溢/下溢**”。

但是在没有溢出/下溢的情况下添加的最佳方法应该是什么？

**关键思想**：你有两个声波说A和B，合成的波C将两个波A和B的[叠加](http://en.wikipedia.org/wiki/Superposition)。有限位范围下的采样可能会导致它溢出。所以现在我们可以计算叠加波形的上行和下行的*最大限制交叉**。*现在我们将在叠加波形的上部减去*最大上行限制交叉并将**最小下行限制交叉*添加到叠加波形的下部。瞧……你完成了。

**脚步：**

1.  首先遍历您的数据循环一次以获得上限交叉的*最大值*和下限交叉的*最小值*。
2.  再次遍历音频数据，从音频数据的正数部分减去*最大值*，在音频数据的负数部分加上*最小值。*

以下代码将显示实现。

```
static unsigned long upSideDownValue = 0;
static unsigned long downSideUpValue = 0;
#define SINT16_MIN -32768
#define SINT16_MAX 32767
SInt16* mixTwoVoice (SInt16* RecordedVoiceData, SInt16* RealTimeData, SInt16 *OutputData, unsigned int dataLength){

unsigned long tempDownUpSideValue = 0;
unsigned long tempUpSideDownValue = 0;
//calibrate maker loop
for(unsigned int i=0;i<dataLength ; i++)
{
    SInt32 summedValue = RecordedVoiceData[i] + RealTimeData[i];

    if(SINT16_MIN < summedValue && summedValue < SINT16_MAX)
    {
        //the value is within range -- good boy
    }
    else
    {
       //nasty calibration needed
        unsigned long tempCalibrateValue;
        tempCalibrateValue = ABS(summedValue) - SINT16_MIN; // here an optimization comes ;)

        if(summedValue < 0)
        {
            //check the downside -- to calibrate
            if(tempDownUpSideValue < tempCalibrateValue)
                tempDownUpSideValue = tempCalibrateValue;
        }
        else
        {
            //check the upside ---- to calibrate
            if(tempUpSideDownValue < tempCalibrateValue)
                tempUpSideDownValue = tempCalibrateValue;
        }
    }
}

//here we need some function which will gradually set the value
downSideUpValue = tempUpSideDownValue;
upSideDownValue = tempUpSideDownValue;

//real mixer loop
for(unsigned int i=0;i<dataLength;i++)
{
    SInt32 summedValue = RecordedVoiceData[i] + RealTimeData[i];

    if(summedValue < 0)
    {
        OutputData[i] = summedValue + downSideUpValue;
    }
    else if(summedValue > 0)
    {
        OutputData[i] = summedValue - upSideDownValue;
    }
    else
    {
        OutputData[i] = summedValue;
    }
}

return OutputData;
} 
```

它对我来说很好，我后来打算逐渐改变*upSideDownValue*和*downSideUpValue*的值以获得更平滑的输出。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-12-06T09:28:16.947

这个问题很老，但这是IMO的有效方法。

1.  转换两个样本的功率。
2.  将两个样本都添加到电源中。
3.  规范化它。比如最大值不超过你的限制。
4.  转换回幅度。

您可以将前 2 步一起进行，但需要最大值和最小值才能在第 3 步和第 4 步的第二遍中进行标准化。

我希望它可以帮助某人。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-12-17T21:16:58.907

我会说只是将它们加在一起。如果您的 16 位 PCM 空间溢出，那么您使用的声音一开始就已经非常响亮，您应该对其进行衰减。如果这会导致它们自己太软，请寻找另一种增加整体音量输出的方法，例如操作系统设置或转动扬声器上的旋钮。

# com - 使用 IDL 定义纯基类

> ID：376039
> 
> 赞同：2
> 
> 时间：2008-12-17T21:09:47.627
> 
> 标签：com, idl, midl

当我在 IDL 中定义一个不从任何东西派生的接口时，MIDL 预编译器会发出警告（Visual C++ 2008）：
警告 MIDL2271：[object] 接口必须派生自另一个 [object] 接口，例如 IUnknown (...)

如果我从另一个不是从 IUnknown 派生的接口派生我的接口，MIDL 将失败：
错误 MIDL2257：只有 IUnknown 可以用作根接口（...）

现在，我的问题是：这是 COM 或 MIDL 预编译器的限制吗？

我最近一直在看D3D10的头文件，d3d10.h显然是使用IDL生成的（MIDL为此添加了注释）。并且所有接口都以一种或另一种方式派生自 IUnknown。

但是，外围头文件（d3d10shader.h、d3d10effect.h 等）包含手动定义的 COM 接口，其中一些会触发此处描述的警告或错误。我只能假设他们必须手动定义它们以避免这些限制。

我对吗？为什么 MIDL 会阻止纯接口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T10:36:05.887

不是从 IUnknown 派生的接口不是 COM。这是允许内存管理和接口发现的基本构建块。

可能存在不是从 IUnknown 派生的接口。但是那些不是COM，它们只是一个普通的指针。

# html - Firefox vs IE vs Chrome vs Safari

> ID：376040
> 
> 赞同：15
> 
> 时间：2008-12-17T21:09:48.453
> 
> 标签：html, css, layout, browser

目前我正在设计一个网站，我发现很难在所有浏览器上完美地显示该网站。

有什么规则、建议等可以遵循吗？

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-17T22:07:16.670

### 开发标准，然后添加例外

目前，最流行的最兼容浏览器是 Firefox，因此开发到 Firefox 是很自然的第一步。使用[W3C](http://www.w3c.org/)的验证器来确保您走上正轨。一旦你的页面大部分完成，验证它在 Safari 和 Chrome（也是高度兼容的浏览器，所以你不应该有太多麻烦）中仍然看起来不错，然后开始为 IE（6**和**7）修复它。相信我，它需要修复！在添加例外时，[QuirksMode](http://quirksmode.org/)之类的网站可以提供很大帮助。

### 始终使用 HTML 4.01 Strict DOCTYPE

这可能是这里比较有争议的观点之一，因为 XHTML 有很多支持者。不幸的是，以既兼容 IE 又兼容标准的方式提供 XHTML 文件是不可能的——IE 无法识别 XHTML MIME 类型，并且将它们作为`text/html`. 只有 HTML 4.01 Strict DOCTYPE 将所有浏览器置于（接近）标准模式，同时仍符合标准。有关更多信息，请查看[DOCTYPE 切换](http://www.webdevout.net/doctype-switching)。如果您绝对不能不编写格式良好的 XML 页面，请使用[XSL 转换](http://www.w3.org/TR/xslt/)将您的页面从您选择的 XML 风格转换为 HTML。

### 不要使用 CSS “hacks”

有时它们可​​能非常诱人，但黑客攻击是基于*浏览器错误的副作用*。因此，很难预测未来的浏览器将如何对它们做出反应。另一方面，条件注释是 IE 浏览器的有意功能，因此可以安全使用。事实上，它们是一种很好的方式，可以将特定于 IE 的（通常是非验证的）CSS 排除在有效样式表之外。

### 不要创建像素对齐的布局

试图让所有浏览器对齐，*精确到像素*是一种挫败感（而且通常是徒劳的）。尝试创建在被破坏时仍然看起来不错的布局，因为它更容易修复两个左侧边框之间的错位，而不是页面两侧的左侧和右侧！使用具有内置边框的背景图像应该是一个**很大**的警告标志！

### 不要对字体使用绝对大小

并非每个人都使用与您相同尺寸的显示器；而不是将脚注设置为`font-size: 10px;`，而是将其设置为`font-size: smaller;`或`font-size: 80%;`。这是一个很大的[可访问性](http://www.w3.org/TR/WCAG20/)问题。

### 不要依赖 CSS 属性的默认值

您永远不知道是否所有浏览器都使用相同的默认值。 [YUI 的“重置”样式表](http://developer.yahoo.com/yui/reset/)是一个很好的起点。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-17T21:15:03.343

让一个网站在所有浏览器和平台上看起来完全一样几乎是不可能的。第一个原因是字体在 Windows、Mac、Linux、Solaris 等上的呈现方式不同。

我们遵循一个新想法：网站不必在不同的浏览器和平台上看起来完全相同。你可以很容易地把它带到那里的 96-98%。其余的将花费你过多的努力来获得潜在的收益。

我们开始开发 Firefox。如果我们做对了，其余的浏览器就非常接近了。大多数时候，IE 是真正棘手的问题。我建议您告诉您的客户或您自己，IE 6 不再是真正的要求。

确保您从正确的开始，使用“重置”css 样式表，将所有浏览器输出放在共同点上。查看：http: [//developer.yahoo.com/yui/reset/](http://developer.yahoo.com/yui/reset/)

最后，为自己省去一些麻烦，并在 ExtJS 或 JQuery 或 Prototype 之类的 Javascript 库上进行标准化，这将隐藏浏览器的差异，让您专注于项目的代码。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-17T21:19:04.630

*   确保您的 XHTML 和 CSS 有效。
*   仅使用标准 Javascript。
*   在一种主要（非 IE）浏览器中进行测试：我的建议是 Firefox 或 Chrome。
*   您的网站现在应该在主要（非 IE）浏览器中看起来非常接近
*   测试dillo或lynx（或两者）之类的东西
*   最后，开始做一些技巧来让 IE 工作

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-17T22:05:07.890

查看[浏览器截图](http://browsershots.org)。它使用各种浏览器对您的站点进行屏幕截图，因此您可以直观地检查它。这有点慢，但对我有用。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-17T21:24:39.360

*这是我不久前给出的关于在浏览器中完善网站的答案（来自[这里](https://stackoverflow.com/questions/349612/simple-jquery-function-works-in-every-browser-but-firefox-what-am-i-missing#349691)）*

实际上，您在开发 Web 应用程序时需要使用的是：

*   火狐
*   IE
*   苹果浏览器
*   （Chrome 很快...）

我的意思是，您应该**在所有 3 个主要的 A 级浏览器上测试您网站的每一步**……因此，如果在此过程中出现问题，您将确切知道是什么导致了中断。

如果您不定期与浏览器一起检查您的页面是如何运行的，那么以后解决问题将变得更加困难。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-17T21:15:10.597

很多开发者喜欢从 FireFox 开始测试，然后转到 IE7。这样他们就拥有了最流行的浏览器。

我喜欢从 IE7 开始而不是去 FireFox，因为 Firefox 有这个 FireBug，它可以让我看到问题所在并进行更正。但我不得不说，我正在慢慢改变以使用 FireFox 拳头进行测试，因为它确实更尊重所有规则。（顺便说一句，FireBug 可以在 IE 的 Javascript 中使用，所以它很棒）。

当然，你应该看看谁是你的公众。如果它是公司内部使用的并且他们只使用 IE ......选择很简单。如果它更适合开发人员，那么您将拥有更多使用 FireFox 的用户......您可能需要首先根据您的受众进行测试。

但是，不要试图让它在所有浏览器上看起来都很完美，你会白白浪费时间。只需确保一切正常并且所有 javascript 操作都正确完成。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-17T21:17:08.207

我建议确定您的目标受众，然后确定他们使用的浏览器。完成此操作后，请在该浏览器中追求完美。现在，您可以做一些工作，让它看起来适合其他浏览器。

今天在所有浏览器中追求完美就像要求世界和平一样。

您可以采取的另一种方法是使用像 jQuery 这样的 Javascript 框架来减轻痛苦。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-17T21:15:30.143

不要试图让每个浏览器都像其他浏览器一样完美地显示它......只有你会知道！试着让它在每个浏览器上看起来都很好。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-17T21:16:14.870

*   你永远不会得到完美，去争取你能得到的最好的。

*   通常，最好的选择是使用适用于所有浏览器的 css 子集，而不是使用特定于浏览器的 hack。

*   对于 javascript，请务必使用 javascript 框架（[JQuery](http://jquery.com/) / [Prototype](http://www.prototypejs.org/) / [YUI](http://developer.yahoo.com/yui/) / [Ext](http://extjs.com/) / 等），并将其专门用于 dom 引用/操作。很难把这些东西做好，他们已经为你做了很多工作

*   很好的[参考网站](http://www.quirksmode.org/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-17T21:22:38.427

我发现使用更多的 CSS 而不是表格可以更容易地在所有浏览器上获得相同的效果。它仍然有点棘手，但表格布局逻辑更糟。谨慎使用表格。

哦，让事情变得“有弹性”总是一个问题。固定宽度/高度更容易。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-18T01:27:05.220

使用严格的文档类型。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

如果您使用的是 ASP.NET，那么您应该添加/更改这是您的 web.config。

```
<system.web>
    <xhtmlConformance mode="Strict"/> 
```

您还应该检查符合 css 的适配器。[http://www.asp.net/cssadapters/](http://www.asp.net/cssadapters/)

我花了几个小时让我的[网站](http://www.sharpdeck.net)在所有浏览器中显示相同，这似乎有效。最后一个建议。经常检查：在检查之前不要做太多，以确保所有浏览器显示相同。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-17T21:17:15.553

为 Firefox 开发。然后应用特定于 IE 的修复程序。希望它能在 Chrome 和 Safari 中正常显示。

原因是有一些修复可以让 IE '正常'工作，但没有很多修复可以让 Firefox 表现不佳。

哦，买一份[Transcending CSS](https://rads.stackoverflow.com/amzn/click/com/0321410971)。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-17T22:00:53.780

我的方法是为 firefox、opera 和其他非 Microsoft 浏览器编写代码。一旦它在其中工作，我在单独的样式表/js 文件中修补 IE 功能。

此外，我通常使用 JS 库和 CSS 框架。10 次中有 9 次我使用 Jquery 和 YUI Grids。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-18T02:49:00.343

使用 JS 库，例如 ExtJS。这将样式化的特定于浏览器的方面抽象出来。

只要清晰易读，在不同的浏览器中看起来不一样，这是错误的吗？

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-18T02:59:33.803

使用 CSSViewer Extension for firefox，它可以帮助您查看可以对代码进行的一些非常用户友好的修复。使用 CSS display:block 或 display:inline-block 属性，它们非常有用。边距、内边距、高度和宽度将是您的朋友，有时您需要指定这些值才能在许多浏览器上看到相同的内容。对于字体，我建议你阅读 yahoo yui fonts css 的东西。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-08-10T06:18:42.557

好的，最好的方法是使用库和预先编写的代码。例如：永远不要使用 JavaScript，而是使用 JQuery，因为它与所有浏览器兼容，而不是编写自己的主题，而是使用免费的 css 主题。

好吧，它对我有用，可以帮助我节省大量时间。因为在专业市场上，时间就是金钱。

谢谢。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-17T21:15:42.747

使用严格的文档类型、有效的 xhtml/html 和有效的 CSS 是很好的起点。另外，请确保使用 reset/undo.css。

尽管如此，还是会有捕获量，但很少

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-17T22:35:10.467

我首先在 FF 等中检查网站，然后“修复”该网站以在 IE 中看起来正常。大多数情况下，如果代码经过验证且干净简单，IE 只需要少量的小编辑。我对 IE 使用不同的样式表。我不建议使用 hacks。对于 javascript，只使用一个库。是的，browsershots 帮助很大。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-06-22T14:07:47.477

IE7 也不再是必需品。现在，它的安全性令人不安。IE8 应该支持其他浏览器所做的大部分工作，而它不支持的部分则无关紧要。体验会变差，但是如果你一开始用的是IE，反正你是没有品味的。

# wpf - 卡特曼的 Silverlight 教程

> ID：376045
> 
> 赞同：2
> 
> 时间：2008-12-17T21:13:03.143
> 
> 标签：wpf, silverlight, svg, vector-graphics

几个月前，我看到了 Eric Cartman（南方公园）的 Silverlight 教程。[它使用来自http://en.wikipedia.org/wiki/File:Eric.svg](http://en.wikipedia.org/wiki/File:Eric.svg)的矢量图像为他制作动画。但是，我似乎再也找不到那个教程了。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T21:27:09.823

是这个吗？-[在表达式设计中使用 SVG 资源](http://download.microsoft.com/download/5/5/0/550ed7a1-03fe-4542-9a14-140bfdbef2f0/TH_EX_Design_SVG.wmv)

# .net - .NET 中的部分受信任的程序集/应用程序/代码/等是什么？

> ID：376049
> 
> 赞同：21
> 
> 时间：2008-12-17T21:14:13.187
> 
> 标签：.net, assemblies, partial-trust

有人可以解释一下吗？我在互联网上找不到任何东西，所有内容都在谈论如何以某种方式进行，但没有确切说明它是什么。

此外，什么是完全受信任的程序集，它们之间有何不同？

我有一个 MS 认证考试，这是我唯一不明白的话题。

编辑：谢谢大家。现在我对 .NET 中的安全性有了更好的理解。我能够通过我的认证考试。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-17T21:28:44.187

.NET 实现了一种称为[代码访问安全性](http://msdn.microsoft.com/en-us/library/930b76w0(VS.71).aspx)的安全模型。非托管代码以启动应用程序的用户的特权和权限运行，即使代码碰巧来自恶意来源。

托管代码需要提供其来源的*证据*；有多种方法可以做到这一点（例如，使用某个密钥对代码进行签名，从某个 URL 下载代码，代码位于磁盘上的某个目录中，等等）。基于该证据，程序集被分组，并为其应用策略。策略可以授予代码组某些权限，主要涉及访问系统资源（执行 DNS 查找、打开网络连接、访问“隔离存储”、访问本地文件系统（全部或仅选择的目录）、访问注册表，访问网络共享等）。控制面板中有一个工具可让您定义此类策略。

当程序集尝试执行某些受限操作时，会进行权限检查。如果授予访问权限，则操作继续。如果检查失败，则抛出异常。检查通常涉及堆栈遍历（即该操作必须信任所有调用者），但也有例外。

作为一种特殊情况，可以将“完全信任”分配给程序集，授予所有权限。虽然我之前没有听说过“部分信任”这个词，但我认为它指的是拥有某些权利但不是完全信任的程序集。

请理解这只是一个概述 - 关于代码访问安全性还有很多要说的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-17T21:31:58.690

[完全信任程序集](http://blogs.msdn.com/eugene_bobukh/archive/2005/05/06/415217.aspx)具有一组不受限制的代码[访问安全](http://msdn.microsoft.com/en-us/library/930b76w0.aspx)权限，它允许代码访问所有资源类型并执行特权操作，仅受操作系统安全性约束。例如，如果用户 Bob 不能访问文件 Y，那么在 Bob 的用户空间中运行的完全信任程序集也不能。

[部分信任程序集](http://msdn.microsoft.com/en-us/library/ms364059(VS.80).aspx)意味着代码在不完全信任的情况下运行。.NET Framework 有几个预定义的[信任级别](http://codebetter.com/jeffreypalermo/2005/07/05/asp-net-trust-levels-demystified-level-300)，您可以直接使用或自定义这些级别以满足您的特定安全要求。例如，您可以通过拒绝 SQLClientPermission 来阻止程序集访问 SQL 数据库。

程序集的信任级别也可能因其来源而降低。例如，来自网络共享的代码（在旧版本的 .NET 中）的可信度低于来自本地计算机的代码，因此其执行特权操作的能力受到限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T21:41:29.437

也许一些背景会有所帮助。

想想浏览stackoverflow之类的东西。浏览器本身的代码可以在您的计算机上执行任何操作（例如删除文件），还有网站的 javascript 代码。除了漂亮的淡入淡出效果和其他一些显示魔法之外，javascript 代码对您的计算机无能为力。

.net 有能力在本地应用程序和远程应用程序之间提供这种区别。您可以编写将在本地计算机上运行并且能够对本地计算机执行任何操作的应用程序。此应用程序可以具有从 Internet 下载扩展 dll 的功能。这些扩展将能够进行计算和操作显示。但是它们里面的代码希望能够删除文件。因为它不被信任。

细节是错误的，但这就是想法（据我所知）。

# .net - 是否结束使用关闭打开的 SQL 连接

> ID：376068
> 
> 赞同：66
> 
> 时间：2008-12-17T21:18:00.327
> 
> 标签：.net, sql, sql-server, vb.net

如果我将 SQLConnection 包装在 Using 中，我应该关闭它还是使用结束处理它？

```
using cn as new system.data.sqlclient.sqlconnection()
    cn.open
    '{do a bunch of other stuff with commands and datareaders here}
    cn.close 'Do I need this?
end using 
```

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-12-17T21:19:16.580

在有问题的对象（在您的示例中）上退出 using 块调用 .Dispose() `cn`，对于 SqlConnection 将关闭连接和任何打开的资源。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-12-17T21:25:48.250

更准确地说，调用 Dispose 或 Close 会将底层物理连接标记为“未使用”——但不会真正关闭它。因此，尚未物理关闭的“未使用”连接可用于池化。因此 - 调用 Dispose 将返回到连接池的连接。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-02-28T17:08:05.377

根据 MSDN，您不需要 close 声明。

“以下示例创建一个 SqlConnection，打开它，显示它的一些属性。连接在 using 块结束时自动关闭。” -- [http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.close.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.close.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T21:33:36.003

虽然 SQL 的 Dispose 方法确实关闭了连接（最终根据 darin 的说法），但您应该将对 Close 的调用保留在那里。原因是您将依赖 Dispose 的底层实现来调用 close。对于我们这些使用非托管语言编程的人来说，看到没有关闭的打开就像看到没有删除的新。这对我来说是一种代码味道。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T21:27:12.537

using 只是尝试/最终的简写。这是您发布的内容的等效代码

```
Try
    SqlConnection cn as new system.data.sqlclient.sqlconnection()
    cn.open
    '{do a bunch of other stuff with commands and datareaders here}
    cn.close 'Do I need this?
Finally
    cn.Dispose()
End Try 
```

Dispose 应该负责所有资源清理，在连接的情况下它将关闭它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-04T17:09:00.850

“Using 块的行为类似于 Try...Finally 构造，其中 Try 块使用资源，Finally 块处理它们。因此，无论您如何退出块，Using 块都保证资源的处理。即使在未处理的异常情况下也是如此，但 StackOverflowException 除外。”
[https://msdn.microsoft.com/en-us/library/htd05whh.aspx](https://msdn.microsoft.com/en-us/library/htd05whh.aspx)

# .net - 创建文件夹，将文件写入服务器上的共享文件夹

> ID：376071
> 
> 赞同：0
> 
> 时间：2008-12-17T21:19:32.663
> 
> 标签：.net, security

我的 Windows 服务正在共享文件夹上创建目录，但出现错误：

```
at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
at System.IO.Directory.InternalCreateDirectory(String fullPath, String path,DirectorySecurity dirSecurity)
at System.IO.Directory.CreateDirectory(String path, DirectorySecurity directorySecurity)
at System.IO.Directory.CreateDirectory(String path)     at 
```

我引用共享文件夹，如：`\\255.255.255.255\myfolder.uploads\`

关于我必须做什么才能写入此文件夹的任何想法？该共享具有所有人和完全控制设置。

**更新**

我是否必须以某种方式冒充另一台服务器上的用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T21:30:30.223

这可能是几件事，具体取决于您的服务器运行的平台。作为一个完整的（假设是基于 Windows 的服务器）猜测交叉检查共享和文件夹是否具有授予相应用户帐户的写入权限。

仅提供共享权限可能行不通。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T21:24:22.030

对于 .net 上共享文件夹的安全性，您需要使用[".net Framework Configuration Tool"](http://msdn.microsoft.com/en-us/library/2bc0cxhc(VS.80).aspx)配置 .net 安全性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T21:50:08.577

尝试在您的用户下运行该服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-22T22:30:05.663

在 C# 中，我使用以下内容：

```
string DIR_CONTA = "\\\\192.168.0.X\\folder\\subfolder"; 
```

您还必须查看共享文件夹选项和安全选项卡

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-09T10:43:36.260

我认为您应该使用 NetworkService Account 显式运行服务：NetworkService Account
[上的 MSDN](http://msdn.microsoft.com/en-us/library/ms684272(VS.85).aspx)
它与您使用的 LocalSystem 帐户不同：
[LocalSystem Account 上的 MSDN](http://msdn.microsoft.com/en-us/library/ms684190(VS.85).aspx)

希望能帮助到你。

# unicode - 国际场景中的字体选择：多语言 vs unicode

> ID：376079
> 
> 赞同：1
> 
> 时间：2008-12-17T21:25:18.750
> 
> 标签：unicode, fonts, internationalization, multilingual

我有一个最终会显示多种语言的网站。我注意到 Web CSS 中使用的常见字体（例如：Arial、Verdana、Times New Roman、Tahoma）甚至更新的 Vista/Office 2007/VS2008 字体（Calibri、Cambria、Candara、Corbel 等）都明显更大（~350K ) 比您的平均水平（仅限美国？）TTF 字体（约 50k），因此这些字体包含常用语言（西班牙语、法语、德语等）使用的大多数/所有主要字符集。

我的问题是，有人会确认上面列出的这些字体对于主要（比如说前 8 种）口语的国际使用是可以接受的吗？如果是这样，那么我猜测 unicode 字体的唯一目的；这样的“Arial Unicode”（一个巨大的 22mb）只用于处理极其小众的对话、东方字形（中文、日文）和死语言？

我只是在寻找让他们的桌面应用程序/网络应用程序呈现多种语言并进行视觉确认的开发人员的一些确认，我已经在 99% 确定的垃圾箱中，但你知道他们对假设的看法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T00:35:12.033

我刚刚检查了 Calibri 和 Cambria 的字符集，并确认它们涵盖了欧洲（因此也包括美国）的所有主要语言。如果这让您感觉更舒服，我可以检查其他 ClearType 字体，但我怀疑覆盖范围是否有任何不同。

但是，正如已经强调的那样，您对字体的选择很大程度上取决于您所针对的确切语言集：通常，您可以确信任何商业字体至少涵盖西欧的所有语言（英语、法语、德语、意大利语、西班牙语、葡萄牙语等）。如果您想在其中添加波兰语、捷克语、斯洛伐克语等，则需要具有“中欧”覆盖范围的字体（通常在 Adob​​e 字体库中标记为 CE）。对于希腊语，您当然需要带有希腊字符的字体，对于俄语，您需要带有西里尔字符的字体（通常也包括乌克兰语、保加利亚语、塞尔维亚语等）。顺便说一句，ClearType 字体支持上述所有内容。

最后，没有什么比自己检查更好的了：如果您知道要支持的语言，您可以检查您打算使用的字体，并检查您要查找的字符。Michael 的 Everson [Alphabets of Europe](http://www.evertype.com/alphabets/)是一个很好的资源。必须通过所有单独的语言似乎很乏味，但为了做出明智的决定，您确实必须这样做。

如果您需要支持阿拉伯语或希伯来语、印度文字或东南亚文字或表意文字，那么图片就完全不同了，正如已经说过的那样，我怀疑任何一种字体都适合这里，除了非常尝试全面的稀有字体（顺便说一句，这是一种错觉）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T21:54:17.600

您的正确假设是，当仅限于网络安全字体时，并非所有字体都具有完整的 unicode 支持，因此选择范围会进一步缩小

> **Unicode 字体**在 Windows 平台上默认只有两种字体可用，Arial 和 Lucida Sans，提供了广泛的 Unicode 字符库。Verdana 中的一个错误（以及各种用户代理对它的不同处理）阻碍了它在需要组合字符时的可用性。

[维基百科：网络安全字体](http://en.wikipedia.org/wiki/Web-safe_fonts)， [网络安全字体可用性的比较](http://dustinbrewer.com/fonts-on-the-web-and-a-list-of-web-safe-fonts/)

我承认不知道这两种语言中的哪一种实际上最安全地应用于最常见的语言。

指定 lang 属性以及指定 UTF-8 编码使浏览器成功地用默认 OS 字体中的字形替换未知字符。

[关于这个的好文章在这里](http://wyw.dcweb.cn/lang_utf8.htm)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T15:32:50.037

非英语操作系统通常会将标准字体（如 Arial 或 Verdana）映射为适当的本地语言字体。例如，日语可能会将 Helvetica 映射到大阪，或将 Arial 映射到 MS Gothic，而中国操作系统会将 Arial 映射到 Simsun。因此，只要您使用常用字体（Arial 等），您就可以合理地确定客户端操作系统会选择合适的字体。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-24T06:34:35.257

我个人使用这个：[http](http://www.google.com/get/noto/) ://www.google.com/get/noto/ 它涵盖了大多数语言。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T22:10:19.207

如果您将您的要求限制为基于带有一些扩展的拉丁脚本的语言，那么您将有一个更大的选择，就好像您需要“广泛的 unicode 支持”一样。大多数专业、高质量的字体应该很容易支持这些。

一个很好的迹象是微软在他们的西方语言软件产品中使用了相同的基本字体。

在软件世界的另一端，有[DejaVu 字体](http://en.wikipedia.org/wiki/DejaVu_fonts)，它们为这些脚本提供了很好的覆盖范围，并广泛用于许多 Linux 发行版。

当您想要显示阿拉伯文字和更轻松的字符（以及较小的希腊和西里尔字符）时，字体的真正痛苦就开始了。

附带说明：如果所选字体无法呈现给定字形，则好的浏览器应该选择不同的字体。确保在你的 CSS 中提供一个通用的字体系列（可能除了更具体的字体选择之外），以帮助浏览器进行这种回退。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T22:50:38.377

如果您想知道哪些字体包含哪些 Unicode 字符，Windows Character Map 附件将显示字体的所有实现字符。

当然，您需要了解您所针对的语言以及他们使用的字符，这会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-10T21:51:46.720

我们的网站有几十个翻译和阿拉伯语文本，至少我们收到了很多对 Tahoma 的请求，因为它是唯一看起来可以接受的东西，并且也安装在旧版本的 Windows 上。

# jquery - 如何使用 jQuery 获取表格单元格值？

> ID：376081
> 
> 赞同：226
> 
> 时间：2008-12-17T21:25:38.953
> 
> 标签：jquery

我正在尝试研究如何使用 jQuery 获取每一行的表格单元格的值。

我的表如下所示：

```
<table id="mytable">
  <tr>
    <th>Customer Id</th>
    <th>Result</th>
  </tr>
  <tr>
    <td>123</td>
    <td></td>
  </tr>
  <tr>
    <td>456</td>
    <td></td>
  </tr>
  <tr>
    <td>789</td>
    <td></td>
  </tr>
</table> 
```

我基本上想遍历表，并获取`Customer Id`每一行的列值。

在下面的代码中，我发现我需要这样做才能让它遍历每一行，但我不确定如何获取行中第一个单元格的值。

```
$('#mytable tr').each(function() {
    var cutomerId = 
} 
```

* * *

## 回答 #1

> 赞同：327
> 
> 时间：2008-12-17T21:39:13.683

如果可以的话，可能值得在 TD 上使用包含客户 ID 的类属性，这样您就可以编写：

```
$('#mytable tr').each(function() {
    var customerId = $(this).find(".customerIDCell").html();    
 }); 
```

本质上，这与其他解决方案相同（可能是因为我复制粘贴了），但其优点是，如果您在列中移动，甚至不需要更改代码结构，甚至将客户 ID 放入`<span>`，前提是您保留了 class 属性。

顺便说一句，我认为你可以在一个选择器中做到这一点：

```
$('#mytable .customerIDCell').each(function() {
  alert($(this).html());
}); 
```

如果这让事情变得更容易。

* * *

## 回答 #2

> 赞同：149
> 
> 时间：2008-12-17T21:28:45.560

```
$('#mytable tr').each(function() {
    var customerId = $(this).find("td:first").html();    
}); 
```

您正在做的是遍历表中的所有 trs，在循环中的当前 tr 中找到第一个 td，并提取其内部 html。

要选择特定单元格，您可以使用索引引用它们：

```
$('#mytable tr').each(function() {
    var customerId = $(this).find("td").eq(2).html();    
}); 
```

在上面的代码中，我将检索**第三行**的值（索引从零开始，所以第一个单元格索引为 0）

* * *

以下是不使用 jQuery 的方法：

```
var table = document.getElementById('mytable'), 
    rows = table.getElementsByTagName('tr'),
    i, j, cells, customerId;

for (i = 0, j = rows.length; i < j; ++i) {
    cells = rows[i].getElementsByTagName('td');
    if (!cells.length) {
        continue;
    }
    customerId = cells[0].innerHTML;
} 
```

​</p>

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-12-17T21:34:32.430

一种不那么古怪的方法：

```
$('#mytable tr').each(function() {
    if (!this.rowIndex) return; // skip first row
    var customerId = this.cells[0].innerHTML;
}); 
```

这显然可以更改为使用非第一个单元格。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-17T21:28:04.907

```
$('#mytable tr').each(function() {
  // need this to skip the first row
  if ($(this).find("td:first").length > 0) {
    var cutomerId = $(this).find("td:first").html();
  }
}); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-01-28T22:08:28.460

试试这个，

```
$(document).ready(function(){
$(".items").delegate("tr.classname", "click", function(data){
            alert(data.target.innerHTML);//this will show the inner html
    alert($(this).find('td:eq(0)').html());//this will alert the value in the 1st column.
    });
}); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-04-11T17:35:43.997

这有效

```
$(document).ready(function() {
    for (var row = 0; row < 3; row++) {
        for (var col = 0; col < 3; col++) {
            $("#tbl").children().children()[row].children[col].innerHTML = "H!";
        }
    }
}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-02-28T10:36:56.337

试试这个 ：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
    <title>Untitled</title>

<script type="text/javascript"><!--

function getVal(e) {
    var targ;
    if (!e) var e = window.event;
    if (e.target) targ = e.target;
    else if (e.srcElement) targ = e.srcElement;
    if (targ.nodeType == 3) // defeat Safari bug
        targ = targ.parentNode;

    alert(targ.innerHTML);
}

onload = function() {
    var t = document.getElementById("main").getElementsByTagName("td");
    for ( var i = 0; i < t.length; i++ )
        t[i].onclick = getVal;
}

</script>

<body>

<table id="main"><tr>
    <td>1</td>
    <td>2</td>
    <td>3</td>
    <td>4</td>
</tr><tr>
    <td>5</td>
    <td>6</td>
    <td>7</td>
    <td>8</td>
</tr><tr>
    <td>9</td>
    <td>10</td>
    <td>11</td>
    <td>12</td>
</tr></table>

</body>
</html> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-07-21T06:22:27.917

```
$(document).ready(function() {
     var customerId
     $("#mytable td").click(function() {
     alert($(this).html());
     });
 }); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-01-10T20:13:39.407

一个工作示例：http: [//jsfiddle.net/0sgLbynd/](http://jsfiddle.net/0sgLbynd/)

```
<table>
<tr>
    <td>0</td>
    <td class="ms-vb2">1</td>
    <td class="ms-vb2">2</td>
    <td class="ms-vb2">3</td>
    <td class="ms-vb2">4</td>
    <td class="ms-vb2">5</td>
    <td class="ms-vb2">6</td>
</tr>
</table>

$(document).ready(function () {
//alert("sss");
$("td").each(function () {
    //alert($(this).html());
    $(this).html("aaaaaaa");
});
}); 
```

# ios - 带有有序键的 NSDictionary

> ID：376090
> 
> 赞同：82
> 
> 时间：2008-12-17T21:27:37.047
> 
> 标签：ios, objective-c, cocoa, nsdictionary

我有一个 NSDictionary（存储在 plist 中），我基本上将其用作关联数组（字符串作为键和值）。我想将键数组用作我的应用程序的一部分，但我希望它们按特定顺序排列（不是我可以编写算法将它们排序的顺序）。我总是可以存储一个单独的键数组，但这似乎有点笨拙，因为我总是必须更新字典的键以及数组的值，并确保它们始终对应。目前我只使用 [myDictionary allKeys]，但显然这会以任意、无保证的顺序返回它们。Objective-C 中是否有我缺少的数据结构？有人对如何更优雅地做到这一点有任何建议吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-17T22:19:55.613

拥有关联的 NSMutableArray 键的解决方案还不错。它避免了子类化 NSDictionary，如果你在编写访问器时很小心，保持同步应该不会太难。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-10-18T19:04:28.770

我的实际答案迟到了，但您可能有兴趣调查[CHOrderedDictionary](https://github.com/quinntaylor/CHDataStructures/blob/master/source/CHOrderedDictionary.h)。它是 NSMutableDictionary 的子类，它封装了另一种用于维护键顺序的结构。（它是[CHDataStructures.framework](https://github.com/quinntaylor/CHDataStructures)的一部分。）我发现它比单独管理字典和数组更方便。

披露：这是我编写的开源代码。只是希望它可能对面临这个问题的其他人有用。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-02-22T09:14:17.633

没有这样的内置方法可以从中获取。但是一个简单的逻辑对你有用。准备字典时，您可以在每个键前简单地添加一些数字文本。喜欢

```
NSDictionary *dict = [[NSDictionary alloc] initWithObjectsAndKeys:
                       @"01.Created",@"cre",
                       @"02.Being Assigned",@"bea",
                       @"03.Rejected",@"rej",
                       @"04.Assigned",@"ass",
                       @"05.Scheduled",@"sch",
                       @"06.En Route",@"inr",
                       @"07.On Job Site",@"ojs",
                       @"08.In Progress",@"inp",
                       @"09.On Hold",@"onh",
                       @"10.Completed",@"com",
                       @"11.Closed",@"clo",
                       @"12.Cancelled", @"can",
                       nil]; 
```

现在，如果您可以使用sortingArrayUsingSelector，同时按照您放置的顺序获取所有键。

```
NSArray *arr =  [[dict allKeys] sortedArrayUsingSelector:@selector(localizedStandardCompare:)]; 
```

在UIView中要显示key的地方，把前面的3个字符剪掉即可。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-18T04:40:22.163

如果你打算继承 NSDictionary 的子类，你至少需要实现这些方法：

*   NS词典
    *   `-count`
    *   `-objectForKey:`
    *   `-keyEnumerator`
*   NSMutableDictionary
    *   `-removeObjectForKey:`
    *   `-setObject:forKey:`
*   NSCopying/NSMutableCopying
    *   `-copyWithZone:`
    *   `-mutableCopyWithZone:`
*   NS编码
    *   `-encodeWithCoder:`
    *   `-initWithCoder:`
*   NSFastEnumeration *（用于 Leopard）*
    *   `-countByEnumeratingWithState:objects:count:`

做你想做的最简单的方法是创建一个 NSMutableDictionary 的子类，其中包含它自己操作的 NSMutableDictionary 和一个 NSMutableArray 来存储一组有序的键。

如果你永远不会编码你的对象，你可以想象跳过实现`-encodeWithCoder:`和`-initWithCoder:`

然后，上述 10 种方法中的所有方法实现都将直接通过托管字典或有序键数组。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-03-20T13:58:12.783

我的小补充：按数字键排序（对较小的代码使用速记符号）

```
// the resorted result array
NSMutableArray *result = [NSMutableArray new];
// the source dictionary - keys may be Ux timestamps (as integer, wrapped in NSNumber)
NSDictionary *dict =
@{
  @0: @"a",
  @3: @"d",
  @1: @"b",
  @2: @"c"
};

{// do the sorting to result
    NSArray *arr = [[dict allKeys] sortedArrayUsingSelector:@selector(compare:)];

    for (NSNumber *n in arr)
        [result addObject:dict[n]];
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-13T03:47:50.883

快速'n脏：

当您需要订购词典（此处称为“myDict”）时，请执行以下操作：

```
 NSArray *ordering = [NSArray arrayWithObjects: @"Thing",@"OtherThing",@"Last Thing",nil]; 
```

然后，当您需要订购字典时，创建一个索引：

```
 NSEnumerator *sectEnum = [ordering objectEnumerator];
    NSMutableArray *index = [[NSMutableArray alloc] init];
        id sKey;
        while((sKey = [sectEnum nextObject])) {
            if ([myDict objectForKey:sKey] != nil ) {
                [index addObject:sKey];
            }
        } 
```

现在，*index 对象将以正确的顺序包含适当的键。请注意，此解决方案并不要求所有密钥都必须存在，这是我们正在处理的通常情况......

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-09-06T14:15:09.597

NSDictionary 的有序子类的最小实现（基于[https://github.com/nicklockwood/OrderedDictionary](https://github.com/nicklockwood/OrderedDictionary)）。随意扩展您的需求：

## 斯威夫特 3 和 4

```
class MutableOrderedDictionary: NSDictionary {
    let _values: NSMutableArray = []
    let _keys: NSMutableOrderedSet = []

    override var count: Int {
        return _keys.count
    }
    override func keyEnumerator() -> NSEnumerator {
        return _keys.objectEnumerator()
    }
    override func object(forKey aKey: Any) -> Any? {
        let index = _keys.index(of: aKey)
        if index != NSNotFound {
            return _values[index]
        }
        return nil
    }
    func setObject(_ anObject: Any, forKey aKey: String) {
        let index = _keys.index(of: aKey)
        if index != NSNotFound {
            _values[index] = anObject
        } else {
            _keys.add(aKey)
            _values.add(anObject)
        }
    }
} 
```

### 用法

```
let normalDic = ["hello": "world", "foo": "bar"]
// initializing empty ordered dictionary
let orderedDic = MutableOrderedDictionary()
// copying normalDic in orderedDic after a sort
normalDic.sorted { $0.0.compare($1.0) == .orderedAscending }
         .forEach { orderedDic.setObject($0.value, forKey: $0.key) }
// from now, looping on orderedDic will be done in the alphabetical order of the keys
orderedDic.forEach { print($0) } 
```

## Objective-C

```
@interface MutableOrderedDictionary<__covariant KeyType, __covariant ObjectType> : NSDictionary<KeyType, ObjectType>
@end
@implementation MutableOrderedDictionary
{
    @protected
    NSMutableArray *_values;
    NSMutableOrderedSet *_keys;
}

- (instancetype)init
{
    if ((self = [super init]))
    {
        _values = NSMutableArray.new;
        _keys = NSMutableOrderedSet.new;
    }
    return self;
}

- (NSUInteger)count
{
    return _keys.count;
}

- (NSEnumerator *)keyEnumerator
{
    return _keys.objectEnumerator;
}

- (id)objectForKey:(id)key
{
    NSUInteger index = [_keys indexOfObject:key];
    if (index != NSNotFound)
    {
        return _values[index];
    }
    return nil;
}

- (void)setObject:(id)object forKey:(id)key
{
    NSUInteger index = [_keys indexOfObject:key];
    if (index != NSNotFound)
    {
        _values[index] = object;
    }
    else
    {
        [_keys addObject:key];
        [_values addObject:object];
    }
}
@end 
```

### 用法

```
NSDictionary *normalDic = @{@"hello": @"world", @"foo": @"bar"};
// initializing empty ordered dictionary
MutableOrderedDictionary *orderedDic = MutableOrderedDictionary.new;
// copying normalDic in orderedDic after a sort
for (id key in [normalDic.allKeys sortedArrayUsingSelector:@selector(compare:)]) {
    [orderedDic setObject:normalDic[key] forKey:key];
}
// from now, looping on orderedDic will be done in the alphabetical order of the keys
for (id key in orderedDic) {
    NSLog(@"%@:%@", key, orderedDic[key]);
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-10-19T12:25:28.977

**对于，斯威夫特 3**。请尝试以下方法

```
 //Sample Dictionary
        let dict: [String: String] = ["01.One": "One",
                                      "02.Two": "Two",
                                      "03.Three": "Three",
                                      "04.Four": "Four",
                                      "05.Five": "Five",
                                      "06.Six": "Six",
                                      "07.Seven": "Seven",
                                      "08.Eight": "Eight",
                                      "09.Nine": "Nine",
                                      "10.Ten": "Ten"
                                     ]

        //Print the all keys of dictionary
        print(dict.keys)

        //Sort the dictionary keys array in ascending order
        let sortedKeys = dict.keys.sorted { $0.localizedCaseInsensitiveCompare($1) == ComparisonResult.orderedAscending }

        //Print the ordered dictionary keys
        print(sortedKeys)

        //Get the first ordered key
        var firstSortedKeyOfDictionary = sortedKeys[0]

        // Get range of all characters past the first 3.
        let c = firstSortedKeyOfDictionary.characters
        let range = c.index(c.startIndex, offsetBy: 3)..<c.endIndex

        // Get the dictionary key by removing first 3 chars
        let firstKey = firstSortedKeyOfDictionary[range]

        //Print the first key
        print(firstKey) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-25T13:45:28.500

我不太喜欢 C++，但我发现自己越来越多地使用的一种解决方案是使用 Objective-C++ 和`std::map`标准模板库。它是一个字典，其键在插入时自动排序。无论是作为键还是作为值，标量类型或 Objective-C 对象都可以很好地工作。

如果您需要包含一个数组作为值，只需使用`std::vector`而不是`NSArray`.

一个警告是，您可能想要提供自己的`insert_or_assign`函数，除非您可以使用 C++17（请参阅[此答案](http://stackoverflow.com/a/31792377/126192)）。此外，您需要使用`typedef`您的类型来防止某些构建错误。一旦你弄清楚如何使用`std::map`，迭代器等，它就非常简单快速。

# java - 休眠列名问题

> ID：376093
> 
> 赞同：31
> 
> 时间：2008-12-17T21:28:30.007
> 
> 标签：java, hibernate, annotations

```
@Column(name="DateOfBirth")
private Date dateOfBirth; 
```

我特别需要上面的代码来创建一个名为“DateOfBirth”的列，而不是 Hibernate 给我一个名为 date_of_birth 的列。我怎样才能改变这个？有 web.xml 属性吗？我遇到了 DefaultNamingStrategy 和 ImprovementNamingStrategy，但不确定如何指定其中一个。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2017-06-13T17:24:53.243

试着把这个放进去

应用程序属性

```
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-12-17T22:38:22.893

仅供参考：插入下划线的原因可能是因为您使用的是[ImprovementNamingStrategy](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/cfg/ImprovedNamingStrategy.html)。它在您的[配置](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/cfg/Configuration.html#setNamingStrategy(org.hibernate.cfg.NamingStrategy))对象上设置。请参阅[此处](http://www.javalobby.org/java/forums/t19838.html)的示例...

如果您不想要下划线，则可以不设置命名策略，或将其设置为您之前发现的 DefaultNamingStrategy。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-17T22:26:54.447

这是一种可能的解决方法：如果您`dateofbirth`将其命名，则数据库中的列将被命名，但属性名称应该相同。

Hibernate 采用驼峰式格式来创建/读取数据库列。

我以前遇到过这个问题。我使用了一个遗留列，其中列名“employeename”、“employeeerole”、“departmentlocation”中没有空格。我讨厌它，因为我所有的 bean 属性都必须没有驼峰式。

如您所见，由“_”分隔的数据库列将用于正确的驼峰式命名法。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-07-30T18:43:52.767

在弹簧靴的情况下添加以下属性。

**spring.jpa.hibernate.naming.implicit-strategy=org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyJpaImpl spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl**

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-17T21:40:00.763

将 @Column 注释放在 getter 上：

```
@Column(name="DateOfBirth")
public Date getDateOfBirth() {
...
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-17T22:14:21.850

建议的解决方法是使用@Column(name="dateofbirth")，它适用于我的目的。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-10-15T16:36:40.943

改进的命名策略有方法 addUnderscores() 从 tableName() 和 columnName() 调用，您可以实现自己的命名策略类并根据您的选择覆盖这些

```
 public class MyOwnNamingStrategy extends ImprovedNamingStrategy {
        @Override
        public String tableName(String tableName) {
        //return addUnderscores(columnName); // skip this
        return columnName; // if you want column name variable name same
        //return changeAsYouWant(columnName); // as name sames
       }
   } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-17T22:02:17.647

您可以注释字段或 getter 方法，这没有区别。您可以发布完整的 hibernate.cfg.xml 或 persistence.xml 文件吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-17T21:32:45.833

我不是 100% 确定，但你不需要注释 get 方法而不是私有变量吗？

# java - 将 JVM/JRE 设置为自动使用 Windows 代理

> ID：376101
> 
> 赞同：35
> 
> 时间：2008-12-17T21:32:21.810
> 
> 标签：java, proxy, jvm

我确实看到了关于为 JVM 设置代理的问题，但我想问的是如何利用已经配置的代理（在 Windows 上）。

这是我的问题的演示：

> > 1.  转到您的控制面板-> Java 并设置代理地址。
> > 2.  运行以下简单的小程序代码（我使用的是 Eclipse IDE）：

```
import java.awt.Graphics;
import javax.swing.JApplet;
import java.util.*;

public class Stacklet extends JApplet {
    private String message;
    public void init(){
        Properties props = System.getProperties();
        message = props.getProperty("http.proxyHost", "NONE");      
        message = (message.length() == 0)? "NONE": message;
    }

    public void paint(Graphics g)
    {
        g.drawString(message, 20, 20);
    }
} 
```

与您在 Java 控制面板中放置的设置无关，Applet 会显示“NONE”。如果 Windows 代理设置（通常在 Internet Explorer 中设置）是我可以确定的，但在 Java 控制面板中执行额外的配置步骤仍然是可接受的解决方案，那么最好的办法是。

谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-19T17:58:09.927

可以使用[ProxySelector类检测代理，并通过使用](http://java.sun.com/j2se/1.5.0/docs/api/java/net/ProxySelector.html)[System 类的 setProperty 方法](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/System.html#setProperty(java.lang.String,%20java.lang.String))分配环境变量来分配系统代理：

```
System.setProperty("java.net.useSystemProxies", "true");
System.out.println("detecting proxies");
List l = null;
try {
    l = ProxySelector.getDefault().select(new URI("http://foo/bar"));
} 
catch (URISyntaxException e) {
    e.printStackTrace();
}
if (l != null) {
    for (Iterator iter = l.iterator(); iter.hasNext();) {
        java.net.Proxy proxy = (java.net.Proxy) iter.next();
        System.out.println("proxy type: " + proxy.type());

        InetSocketAddress addr = (InetSocketAddress) proxy.address();

        if (addr == null) {
            System.out.println("No Proxy");
        } else {
            System.out.println("proxy hostname: " + addr.getHostName());
            System.setProperty("http.proxyHost", addr.getHostName());
            System.out.println("proxy port: " + addr.getPort());
            System.setProperty("http.proxyPort", Integer.toString(addr.getPort()));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-12-10T14:53:04.927

这可能有点晚了，但我遇到了同样的问题。我修复它的方法是添加以下系统属性：

```
-Djava.net.useSystemProxies=true 
```

Now, note that this property is set only once at startup, so it can't change when you run your application. From [https://docs.oracle.com/javase/7/docs/api/java/net/doc-files/net-properties.html#Proxies](https://docs.oracle.com/javase/7/docs/api/java/net/doc-files/net-properties.html#Proxies):

> java.net.useSystemProxies (default: false) ... Note that this property is checked only once at startup.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-08-16T21:43:09.067

我在此处尝试使用建议的代码时发现了一个奇怪的行为。

看来，在设置了默认 ProxySelector 后，常规套接字代码（例如创建新套接字）不再起作用，因为它尝试使用 socks 服务器（不知道为什么会这样做，但对我来说确实如此） .

所以如果你在打电话的时候

```
Socket socket = new Socket(host, port); 
```

你收到这样的 SocketException：

```
java.net.SocketException: Malformed reply from SOCKS server
    at java.net.SocksSocketImpl.readSocksReply(Unknown Source)
    at java.net.SocksSocketImpl.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.<init>(Unknown Source)
    at java.net.Socket.<init>(Unknown Source) 
```

然后尝试将默认 ProxySelector 设置回 null：

```
ProxySelector.setDefault(null); 
```

对我来说，这导致了以下小型 Java 类，我现在使用它来简单地检索系统代理设置，而不会影响应用程序的 Sockets() 的进一步使用，同时正确配置系统以使用代理：

```
public class ProxyConfig {

  private static String host;
  private static int port;

  public static void init() {
    System.setProperty("java.net.useSystemProxies", "true");
    Proxy proxy = getProxy();
    if (proxy != null) {
      InetSocketAddress addr = (InetSocketAddress) proxy.address();
      host = addr.getHostName();
      port = addr.getPort();

      System.setProperty("java.net.useSystemProxies", "false");
      System.setProperty("http.proxyHost", host);
      System.setProperty("http.proxyPort", ""+port);

    }
    System.setProperty("java.net.useSystemProxies", "false");
  }

  public static String getHost() {
    return host;
  }

  public static int getPort() {
    return port;
  }

  private static Proxy getProxy() {
    List<Proxy> l = null;
    try {
      ProxySelector def = ProxySelector.getDefault();

      l = def.select(new URI("http://foo/bar"));
      ProxySelector.setDefault(null);
    } catch (Exception e) {
      e.printStackTrace();
    }
    if (l != null) {
      for (Iterator<Proxy> iter = l.iterator(); iter.hasNext();) {
        java.net.Proxy proxy = iter.next();
        return proxy;
      }
    }
    return null;
  }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-12-07T13:37:48.783

`java.net.URL.openStream()`是 的简写`java.net.URL.openConnection().getInputStream()`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-30T12:43:05.670

**更新：**您需要将系统属性**java.net.useSystemProxies**设置为**true**，我的下面的解决方案才能正常工作。

如果您用于`java.net.URL.openStream()`获取`InputStream`Web 资源内容，则会自动获取与 Internet Explorer 用于该 URL 的代理相同的代理。

无需转到 Java 控制面板或显示使用的代理。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-11-01T21:39:21.213

```
try{
    System.setProperty("java.net.useSystemProxies", "true");
    String prx = ProxySelector.getDefault().select(new URI("http://www.google.com")).get(0).address().toString();
    JOptionPane.showMessageDialog(null, prx);
} catch(Exception e){
    JOptionPane.showMessageDialog(null, "no proxy");
} 
```

# ios - 如何使用 Xcode 自动为 iPhone 应用程序构建源代码分发？

> ID：376103
> 
> 赞同：3
> 
> 时间：2008-12-17T21:32:56.783
> 
> 标签：ios, xcode, open-source, software-distribution

我正在寻找一个开源的 iPhone 应用程序，我有一些关于进行源代码分发的问题：

1.  如何使用 XCode 自动创建源存档（或磁盘映像）？我想要一些类似于构建目标的东西，它可以归档源（如果需要，首先清理目标，但如果不需要的话，那就太好了）。我还有一个带有 ruby​​ 脚本的外部 netbeans 项目，用于构建程序需要的 SQL 数据库（但如果需要，可以单独存档）。

2.  识别构成“源”的文件的最佳方法是什么？是否只是清洁所有目标后留下的任何东西？这种方法的任何警告（我不太相信 IDE 会清理他们似乎制造的所有垃圾——这是否可能包含任何它不应该包含的代码设计内容）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T05:47:12.230

您可以将运行脚本构建阶段添加到任何目标以对构建进行后处理。正确的方法通常是创建一个聚合目标，它首先构建您的构建产品目标，然后在输出上运行脚本。

很难识别所有“源”文件。它通常是 $(SRCROOT) 中的所有内容，但如果您的项目以 Root -> ( src ) ( projfiles ) 方式布局，则 $(SRCROOT) 将仅包含您的项目文件而不包含任何源。您可能必须将至少顶级项目布局的知识编码到脚本中，并在它发生变化时对其进行维护。

即使它是默认设置，如果您要归档源代码，您可能不希望将构建文件夹放在项目文件夹中，因为您经常会获取中间体、项目索引和其他临时文件。在项目的 Get Info 检查器的 General 窗格中，将 Build Products and Intermediates 目录设置为项目目录之外的某个公共位置。这将简化存档源的工作。

而且 Xcode 有一个内置的归档机制，叫做 Snapshots；您可能想要使用它，尽管自动化并不简单。但 Snapshots 确实了解您的所有来源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T03:45:28.033

将 SRCROOT 环境变量设置为您希望源存档的位置，cd 到项目目录，然后执行

```
xcodebuild installsrc build -configuration <configname> -target <targetname> 
```

“installsrc”构建操作将项目源复制到 ${SRCROOT}。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T18:21:44.673

好吧，到目前为止，我对此没有任何答案，所以我将从另一个方向着手，使用 make 和命令行。我将使用这个问题的答案：

[从命令行构建 Qt Xcode 项目](https://stackoverflow.com/questions/377992/building-xcode-projects-from-the-command-line)

...然后使用标准的“制作”方法来构建应用程序和源分发存档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T16:46:39.647

按照建议尝试调用以下脚本的聚合目标：

#!/bin/bash -x

cd "$BUILT_PRODUCTS_DIR"

APPFILE="$PROJECT_NAME.app"

IPAFILE="$PROJECT_NAME.ipa"

if [ "$BUILD_STYLE" = "分布" ]; 然后

```
rm -f "$APPFILE.zip" && zip -ry "$APPFILE.zip" "$APPFILE" && open . 
```

elif [ "$BUILD_STYLE" = "BetaTesting" ]; 然后

```
rm -rf "$IPAFILE" iTunesArtwork Payload && \
cp ../../Apple/iTunesArtwork . && \
mkdir Payload && cp -Rp "$APPFILE" Payload && \
zip -r "$IPAFILE" iTunesArtwork Payload && open . 
```

菲

呃，也许这是另一个问题的答案......

# iphone - iPhone上UIAlertView中的UITextField - 如何使其响应？

> ID：376104
> 
> 赞同：24
> 
> 时间：2008-12-17T21:33:32.540
> 
> 标签：iphone, cocoa-touch

我将 UITextField 放入 UIAlertView 并将其向上移动，这样键盘就不会用以下代码覆盖它：

```
[dialog setDelegate:self];
[dialog setTitle:@"Enter Name"];
[dialog addButtonWithTitle:@"Cancel"];
[dialog addButtonWithTitle:@"OK"];
UITextField * nameField = [[UITextField alloc] initWithFrame:CGRectMake(20.0, 45.0, 245.0, 25.0)];
[nameField setBackgroundColor:[UIColor whiteColor]];
[dialog addSubview:nameField];
CGAffineTransform moveUp = CGAffineTransformMakeTranslation(0.0, 100.0);
[dialog setTransform: moveUp];
[dialog show]; 
```

我还有以下代码来处理警报视图：

```
- (void) alertView:(UIAlertView *)alert clickedButtonAtIndex:(NSInteger)buttonIndex{    
    NSLog(@"%d", (int) buttonIndex);
    if (buttonIndex == 1) { // OK pushed
        NSLog([alert textField].text); // does not log anything
    } else {
        // Cancel pushed
}} 
```

我还有一个 UIAlertViewExtended.h 文件，其中包含：

```
@class UITextField, UILabel;

@interface UIAlertView(Extended)

-(UITextField *)textField;

@end 
```

我的问题是如何获取用户输入的文本以及如何关闭键盘？

谢谢，本

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-01-20T00:41:59.670

任何使用 ARC 支持 iOS 5.0 及更高版本的人，都可以设置这个直接的 alertViewStyle 属性：

```
-(void)showAlertWithTextField{
    UIAlertView* dialog = [[UIAlertView alloc] initWithTitle:@"Enter Name" message:@"" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"Add", nil];    
    [dialog setAlertViewStyle:UIAlertViewStylePlainTextInput];

    // Change keyboard type
    [[dialog textFieldAtIndex:0] setKeyboardType:UIKeyboardTypeNumberPad];
    [dialog show];
}

-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
    if (buttonIndex == 1)
        NSLog(@"%@",[[alertView textFieldAtIndex:0]text]);
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-12-18T00:30:14.633

对于那些可能关心的人，这里有一个可行的解决方案：

```
UIAlertView* dialog = [[UIAlertView alloc] init];
[dialog setDelegate:self];
[dialog setTitle:@"Enter Name"];
[dialog setMessage:@" "];
[dialog addButtonWithTitle:@"Cancel"];
[dialog addButtonWithTitle:@"OK"];

nameField = [[UITextField alloc] initWithFrame:CGRectMake(20.0, 45.0, 245.0, 25.0)];
[nameField setBackgroundColor:[UIColor whiteColor]];
[dialog addSubview:nameField];
CGAffineTransform moveUp = CGAffineTransformMakeTranslation(0.0, 100.0);
[dialog setTransform: moveUp];
[dialog show];
[dialog release];
[nameField release]; 
```

确保你已经创建了 UITextField * nameField; 在您的 .h 文件中，您可以通过执行以下操作获取用户输入的文本： inputText = [nameField text];

在 - (void) alertView:(UIAlertView *)alert clickedButtonAtIndex:(NSInteger)buttonIndex 方法中。

**重要提示：** 对于 iOS 4.0+，这`CGAffineTransform`是自动完成的，因此如果您只针对 4.0+，您可以忽略这一点。否则，您将需要检查您使用的操作系统并相应地处理它。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-09T05:49:58.407

值得一试

[http://junecloud.com/journal/code/displaying-a-password-or-text-entry-prompt-on-the-iphone.html?cmd=success#comment3870](http://junecloud.com/journal/code/displaying-a-password-or-text-entry-prompt-on-the-iphone.html)

获得完整而全面的解决方案。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-08T05:29:13.643

定位文本字段的一种简单方法是设置其标记，而不保留对其的显式引用：

```
nameField.tag = ALERTVIEW_NAMEFIELD; 
```

确保它不同于 0 和`UIView`您可能拥有的其他对象标签，包括父对话框！

然后在`alertView:clickedButtonAtIndex:`处理程序中，您可以通过以下方式检索您的文本字段：

```
UITextField *nameField = (UITextField *)[alertView viewWithTag:ALERTVIEW_NAMEFIELD]; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-12-11T19:58:38.217

找到更清晰的解决方案。检查此代码片段：[UIAlertView 提示中的用户名和密码 UITextFields](http://iphone-dev-tips.alterplay.com/2009/12/username-and-password-uitextfields-in.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-04-13T23:44:39.553

查看此实现： [https ://github.com/josecastillo/EGOTextFieldAlertView](https://github.com/josecastillo/EGOTextFieldAlertView)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-19T09:35:47.987

一个非常好的方法是，您可以使用 UITextFieldDelegate 的委托方法仅在激活键盘时向上移动对话框。见下文。

```
- (void)textFieldDidBeginEditing:(UITextField *)textField {
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5]; 
    [UIView setAnimationDelegate:self];

    CGAffineTransform moveUp = CGAffineTransformMakeTranslation(0.0, -20);
    [dialog setTransform: moveUp];

    [UIView commitAnimations];
}

- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5]; 
    [UIView setAnimationDelegate:self];

    CGAffineTransform moveDown = CGAffineTransformMakeTranslation(0.0, 0.0);
    [dialog setTransform: moveDown];

    [textField resignFirstResponder];

    return YES;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-18T11:42:22.567

这适用于 iOS5 和 ARC。

```
-(void)showAlert {
    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"New Album" 
        message:@"Enter a name for the album." 
        delegate:self 
        cancelButtonTitle:@"Cancel" 
        otherButtonTitles:@"Save", nil];
    alertView.alertViewStyle = UIAlertViewStylePlainTextInput;

    UITextField* textfield = [alertView textFieldAtIndex:0];
    textfield.placeholder = @"Title";

    [alertView show];
}

-(void)alertView:(UIAlertView *)alertView 
    didDismissWithButtonIndex:(NSInteger)buttonIndex 
{
    if (buttonIndex != 1) {
        NSLog(@"Cancel");
        return;
    }
    UITextField* textfield = [alertView textFieldAtIndex:0];
    NSLog(@"Save. text: %@", textfield.text);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-20T00:57:54.360

这实际上只是常规 UIAlertView 代码的 1 行。希望这可以帮助！

```
 UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"test" message:@"This is a alert with a textfield" delegate:self cancelButtonTitle:@"YAY" otherButtonTitles:nil];
    alert.alertViewStyle = UIAlertViewStylePlainTextInput;
    [alert show];
    [alert release]; 
```

仅在 iOS 5 或更高版本上运行

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-01T08:17:44.273

想对 iWasRobbed 的回答添加一个小调整：

**GenericAlertDialogs.m：**

```
+ (void)displayInputDialog:(NSString*)title delegate:(id<UIAlertViewDelegate>)delegate textFiled:(UITextField*)txtField
{
    UIAlertView* dialog = [[UIAlertView alloc] init];
    [dialog setDelegate:delegate];
    [dialog setTitle:title];
    [dialog setMessage:@" "];
    [dialog addButtonWithTitle:@"Cancel"];
    [dialog addButtonWithTitle:@"OK"];

    if(UIInterfaceOrientationIsPortrait([[UIApplication sharedApplication] statusBarOrientation]))
    {
        txtField.frame = CGRectMake(20.0, 45.0, 245.0, 25.0);
    }
    else 
    {
        txtField.frame = CGRectMake(20.0, 30.0, 245.0, 25.0);
    }

    [txtField becomeFirstResponder];
    [txtField setBackgroundColor:[UIColor whiteColor]];
    [dialog addSubview:txtField];
    [dialog show];   
} 
```

**其他一些 .m 文件（实现 UIAlertViewDelegate）**

```
 self->txtChangeName = [[UITextField alloc] init];
 [GenericAlertDialogs displayInputDialog:@"Some title...:" 
                                delegate:self 
                               textFiled:txtChangeName]; 
```

UIAlertViewDelegate 协议处理：

```
- (void) alertView:(UIAlertView *)alert clickedButtonAtIndex:(NSInteger)buttonIndex 
{
    if(buttonIndex == 1)
    {
        if([txtChangeName.text length] > 0)
        {
            self->userInput = [txtChangeName text];
         }
     }
     self->txtChangeName = nil;
} 
```

iOS 4+ 兼容。

# c# - 使用 Assembly.GetType("MyCompany.Class1.Class2") 返回 null

> ID：376105
> 
> 赞同：13
> 
> 时间：2008-12-17T21:33:33.960
> 
> 标签：c#, .net

我正在尝试使用 Assembly.GetType("MyCompany.Class1.Class2") 从字符串中动态获取类型。

```
Assembly.GetType("MyCompany.Class1"); 
```

按预期工作。

如果我在另一个类中嵌入一个类，例如：

```
namespace MyCompany
{
  public class Class1
  {
     //.....
     public class Class2
     {
        //.....
     }
  }
} 
```

并尝试获取类型 Class2

```
Assembly.GetType("MyCompany.Class1.Class2") 
```

将返回一个空值。

我正在使用 .NET Frameworks 3.5 SP1

有谁知道我做错了什么以及我能做些什么来解决这个问题？

提前致谢

Kevin D. Wolf 佛罗里达州坦帕市

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-17T21:38:31.703

您需要加号才能使用 Assembly.GeType 映射嵌套类。

```
 Assembly.GetType("MyCompany.Class1+Class2"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-17T21:41:16.300

我认为它被命名为 MyCompany.Class1+Class2。

如果我在类似的结构上运行此代码，这就是我所看到的：

```
Assembly assem = Assembly.GetExecutingAssembly();
Type[] types = assem.GetTypes(); 
```

示例类型以查看名称。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T21:41:17.643

您需要使用加号。类似“MyAssembly.Class1+NestedClass”的东西。

# python - 如何通过 python 源代码文件中的注释覆盖 vim 选项？

> ID：376111
> 
> 赞同：32
> 
> 时间：2008-12-17T21:37:46.057
> 
> 标签：python, vim

我想在评论部分的一个文件中设置一些 vim 选项。

例如，我想在一个文件中设置这个选项

```
set syntax=python 
```

该文件没有 .py 扩展名，我不想让我的 vim 安装将所有具有此扩展名的文件识别为 python 文件。

我知道这是可以做到的，因为我已经看到了，但是我对此的谷歌搜索尚未取得成果。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-12-17T22:02:51.607

你想要一个[模式行](http://vim.wikia.com/wiki/Modeline_magic)语法，例如

```
# vim: set syntax=python: 
```

有关更多详细信息，请参阅： Vim Wikia 的[Modelline 魔术](http://vim.wikia.com/wiki/Modeline_magic)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-17T22:13:05.330

我没有太多使用 vim，但我认为您想要的是在文件末尾添加如下行：

```
# vim: set syntax=python: 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-23T10:48:11.070

您可以通过在文件顶部或底部附近添加模式行来覆盖 Vim 选项，例如：

```
// vim: set syntax=python: 
```

或者：

```
/* vim: set syntax=python: */ 
```

或喜欢：

```
# vim: set syntax=python ts=4 : 
```

其他示例（来自[wikia](http://vim.wikia.com/wiki/Modeline_magic#Examples)）：

```
// vim: noai:ts=4:sw=4
   -or-
/* vim: noai:ts=4:sw=4
*/
   -or-
/* vim: set noai ts=4 sw=4: */
   -or-
/* vim: set fdm=expr fde=getline(v\:lnum)=~'{'?'>1'\:'1': */ 
```

这是我正在使用的示例（在文件的最后一行）：

```
# vim: set ts=2 sts=2 et sw=2 ft=python: 
```

几个亮点：

*   Vim 仅在`modeline`设置为`modeline`或正整数且您不是 root 时才执行模式行（某些操作系统，如 Debian、Ubuntu、Gentoo、OSX 等，出于安全原因默认禁用模式行），因此您需要添加`set modeline`到您的`~/.vimrc`文件 ( `:e $MYVIMRC`),
*   该行必须在前几行或最后几行，
*   开场评论之间的空格`vim:`是必需的，
*   vim 检查模式行的位置由`modelines`变量控制（参见 ：） `:help 'modelines'`，
*   ，`set`模式行在第一个冒号 ( `:`) 处结束，
*   "vim:" 以外的文本可以被识别为模式行。

有关的：

*   Vim wikia 中的[Modelline 魔法](http://vim.wikia.com/wiki/Modeline_magic)
*   SS 或 Google 的[Vim 模式线漏洞：](https://security.stackexchange.com/q/36001/11825) *vim 模式线漏洞*

# wpf - 为什么数据绑定的 ContextMenu 项目不隐藏？

> ID：376121
> 
> 赞同：3
> 
> 时间：2008-12-17T21:41:01.933
> 
> 标签：wpf, data-binding, contextmenu, menuitem

我不想使用数据绑定对象的某些属性在上下文菜单中隐藏/显示菜单项。但是我的菜单项并没有隐藏，它们的行为就好像它们的 Visibility 将设置为 Visibility.Hidden （不是 Visibility.Collapsed 实际上），这种行为的原因是什么？

这是一个例子：

XAML：

```
<Window x:Class="MenuTest.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="converter"/>
        <DataTemplate x:Key="template">            
            <MenuItem Visibility="{Binding Visible, Converter={StaticResource converter}}" Header="{Binding Title}" />
        </DataTemplate>
        <ContextMenu x:Key="menu" ItemTemplate="{StaticResource template}"/>                    
    </Window.Resources>
    <Grid>
        <Button VerticalAlignment="Center" HorizontalAlignment="Center" Click="OnClick">Button</Button>
    </Grid>
</Window> 
```

和后面的代码：

```
public partial class Window1 : Window
    {
        public ObservableCollection<Item> list = new ObservableCollection<Item>();
        public Window1()
        {
            InitializeComponent();
            list.Add(new Item() { Title = "First", Visible = true }); ;
            list.Add(new Item() { Title = "Second", Visible = false }); ;
            list.Add(new Item() { Title = "Third", Visible = false }); ;
            list.Add(new Item() { Title = "Fourth", Visible = true }); ;
        }

        private void OnClick(object sender, RoutedEventArgs e)
        {
            ContextMenu cm =  FindResource("menu") as ContextMenu;
            cm.PlacementTarget = e.OriginalSource as UIElement;
            cm.Placement = System.Windows.Controls.Primitives.PlacementMode.Left;
            cm.ItemsSource = list;
            cm.IsOpen = true;
        }
    }

    public class Item
    {
        public string Title { get; set; }
        public bool Visible { get; set; }
    } 
```

结果是包含四个项目的菜单（但中间有两个，标题中没有任何可见文本）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T22:19:29.453

这种行为是因为 ContextMenu 的 ItemTemplate 将应用于为该项目创建的 MenuItem 中的每个绑定项目*。*通过将 MenuItem 放入 DataTemplate，您可以创建一个嵌套的 MenuItem。即使你把里面的折叠起来，因为外面的仍然是可见的，所以它仍然有空间。

您可以通过删除 DataTemplate 中的嵌套 MenuItem 并将其替换为 TextBlock 并使用适用于 MenuItem 的样式来设置可见性来解决此问题：

```
<Window x:Class="MenuTest.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Window">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="converter"/>
        <DataTemplate x:Key="template">
            <TextBlock Text="{Binding Title}"/>
        </DataTemplate>
        <ContextMenu x:Key="menu" ItemTemplate="{StaticResource template}">
            <ContextMenu.Resources>
                <Style TargetType="{x:Type MenuItem}">
                    <Setter Property="Visibility" Value="{Binding Visible, Converter={StaticResource converter}}"/>
                </Style>
            </ContextMenu.Resources>
        </ContextMenu>
    </Window.Resources>
    <Grid>
        <Button HorizontalAlignment="Center" VerticalAlignment="Center" Click="OnClick">Button</Button>
    </Grid>
</Window> 
```

# macos - 在 Mac 上开发 Web 应用程序

> ID：376123
> 
> 赞同：5
> 
> 时间：2008-12-17T21:41:11.450
> 
> 标签：macos

如何在 Mac 上构建不是 RoR 或 PHP 的 Web 应用程序？可以使用 Objective-C 和 Cocoa 创建 Web 应用程序吗？我对这个主题完全陌生

- 哈内曼

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-17T21:55:33.120

Cocoa 真的不是一个 Web 应用程序框架，所以我不建议你走那条路。WebObjects（参见 KiwiBastard 的回答）曾经是用 Objective-C 编写的，但（我认为是从第 5 版开始）是用 Java 编写的。

因为 OS X 是一个 UNIX 操作系统，很多标准的 web 栈都会运行（其实大部分都是默认安装的）。所以你可以用 perl、python、C 或其他语言编写 CGI。您还可以使用与 OS X Server 或任何其他 Java Web 应用程序堆栈捆绑在一起的 JBoss（Java 应用程序服务器）。

我不确定你为什么反对 RoR 和 PHP，但你可能还想看看一些 Python Web 框架[1](http://turbogears.com)，例如[TurboGears](http://turbogears.com)、[Django](http://www.djangoproject.com)、[Zope](http://zope.org)等。

[1](http://turbogears.com) Python 2.5 也与 OS X 10.5 一起安装

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-17T21:45:52.297

“Apple”方式是使用[WebObjects](http://www.apple.com/webobjects/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-17T22:13:10.293

看看[Objective-J 和 Cappuccino](http://cappuccino.org/)，它基本上是 Cocoa for Web。您甚至可以使用界面生成器！（使用拖放构建您的 Web GUI）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T22:19:00.233

我必须推荐Grails：

[http://grails.org](http://grails.org)

如果您有使用可可的经验，那么：

[http://cappuccino.org/](http://cappuccino.org/)

否则，请坚持使用成熟的技术。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T00:54:06.583

如果您希望您的 Web 应用程序看起来像一个 Objective-C 和 Cocoa 应用程序，您可以查看[SproutCore](http://www.sproutcore.com/)。

这是一个 Javascript 框架，但很容易理解和使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T23:32:58.463

你的问题是使用 Rails 还是 Ruby？如果是前者，你可能想看看[Merb ，](http://merbivore.com/contribute.html)[这里](http://www.rubyinside.com/44-merb-resources-1318.html)有很多有趣的链接

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T23:26:15.527

我在 Squeak (Smalltalk) 上使用 Seaside。我每天将代码从 pc 传输到 mac 并再次传输回来，因为它是完全跨平台的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-10T07:45:25.600

我认为这就是问题所在——问一百个人，你就会得到一百个答案！在 PC 上，我使用 .NET 和 Visual Studio 进行开发，仅此而已。我也希望有一个苹果的等价物。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-10T07:53:58.080

认为这就是问题所在——问一百个人，你就会得到一百个答案！在我使用 .NET 和 Visual Studio 开发的 PC 上——仅此而已。我也希望有一个苹果的等价物。不是什么晦涩难懂的东西，你不能轻易地在市场上雇佣程序员（无论如何在英国）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-19T23:55:18.693

我将 eclipse 用于 java & php 项目。

# weblogic - WebLogic 集成和 Oracle Service Bus 之间的区别？

> ID：376127
> 
> 赞同：7
> 
> 时间：2008-12-17T21:41:38.420
> 
> 标签：weblogic, esb, system-integration

我对基于 Java 的技术的了解有限，出于业务强制的原因，我可能需要决定 WebLogic Integration (WLI) 还是 Oracle Service Bus (OSB) 是将少量独立系统集成在一起的更好选择。两种产品似乎都能够完成类似的任务，尽管在一种情况下 (WLI) 集成更多地是技术驱动的，而另一种 (OSB) 则更多地是业务流程驱动的。

假设没有成本，任何人都可以很好地描述何时选择使用一种产品与另一种产品吗？一种选择是否会涉及更多自定义 Java 编码与配置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T22:23:40.880

这要看情况。

OSB 将整合现有的 BEA 的 Aqualogic 服务总线。它只是一个服务总线。

WLI 将不再存在。现在它将成为 Oracle BPEL PM（Oracle BPEL 流程管理器执行引擎）的一部分

服务总线可用于集成 Web 服务“就绪”应用程序。如果您的小型应用程序已经可以部署为 web 服务，这将是正确的选择，那里没有什么可以协调的，您只需公开它们。

另一方面，WLI 用于协调服务之间的交互并创建一个新的。您将编写这些服务相互交互的方式。

如果您的应用程序非常面向“流程”（几乎不需要用户交互）并且您需要从中创建新服务，这将是您的选择（我认为应用程序无论如何都应该准备好 Web 服务）

如果您的应用程序更加面向用户，并且您将它们绑定在一起以创建新的流程（业务流程），那么正确的工具就是 Oracle BPM。使用该工具，您可以集成应用程序（可能尚未准备好 Web 服务）创建新的业务流程并将其公开为 Web 服务。

所以，这取决于你的需求。

使用 Oracle BPM 工具，您可以集成您的应用程序并将它们部署为 WS。

[*至于 Oracle BPM，如果您需要，我可以为您提供更多详细信息 :)*]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T17:26:05.840

我不同意奥斯卡对“WLI 不再存在”的评论

WLI 不会消失。它是 Oracle 集成平台的一部分。WLI 提供比 OSB 更紧密的集成，这仅适用于 Web 服务。在 ESB 之前，WLI 平台也被称为 WLI-ServiceBus。

使用 WLI，您可以创建流程（WLI 或 BPEL）并将它们公开为 Web 服务。您还可以让 WLI 执行类似 ESB 的功能，例如为路由、拆分、聚合和管道实现不同的模式。WLI 本来应该朝着 BPM 的方向发展，但 BEA 收购了 Fuego 并继续创建 BPM 平台，让 WLI 集成“Weblogic”产品套件，而不是使其成为面向业务的 Aqualogic 产品套件的一部分用户。Weblogic 面向开发人员。

OSB 支持创建上述模式，但更适合 Web 服务和 SOA。您可能必须使用 BPM 工具的表单编排。

如果您正在寻找面向性能的应用程序，WLI 会更强大。另一方面，如果您正在寻找基于 SOA 的集成，OSB 或 ALSB 应该就足够了。

在您的情况下，因为您希望集成少量应用程序 WLI 将是不错的选择。

阿尼尔·达特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T07:05:50.680

听起来 WLI 是一个不成熟的 BPM 和 ESB 工具。它还在其网站上被列为 Oracle SOA Stretegry 平台的一部分。既然它做了 ESB 和 BPM 工具应该做的事情，那么 WLI 的未来是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T17:00:27.900

WLI 对开发人员更友好，而不是对业务分析师友好。从 BPM 或 ESB 的角度来看 WLI 是错误的。它可以用于许多面向流程和面向消息的实现，不一定是 BPM。BPM 和 ESB 属于 SOA，但 WLI 不一定只能在 SOA 中工作。我相信它将继续作为一种工具来支持更底层的流程设计和集成工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-26T10:00:42.790

是的。它是正确的。您应该专注于 Aqualogic 服务总线。WLI 将在未来 5 到 10 年内消失。因为它不是甲骨文的战略产品。这是确认消息。

# .net - 有没有办法调试在发布模式下编译的已经运行的应用程序？

> ID：376128
> 
> 赞同：1
> 
> 时间：2008-12-17T21:42:25.067
> 
> 标签：.net, windows-services, debugging, release-mode

我有一个当前挂起但正在运行的 dotnet windows 服务。尽管缺少符号，是否有任何附加调试器？它已经在运行了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T21:56:23.447

忽略“无符号”警告。一旦你连接了一个本地调试器（我更喜欢 WinDbg 来处理这样的东西），然后加载 SoS 工具包：

```
.loadby sos mscorwks 
```

现在您可以使用该命令获取托管调用堆栈`!clrstack`，并希望它为您提供足够的信息来找出挂起。如果这对您不起作用，这里[有一个方便的备忘单和其他一些备忘单。](http://geekswithblogs.net/.netonmymind/archive/2006/03/14/72262.aspx)

这次不会帮助您，但是...养成为调试*和*发布模式构建打开符号文件生成的习惯。没有理由不这样做，在这种情况下，它会让你的生活更轻松。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T21:47:44.617

从 MS dev IDE Debug -> Processes -> Attach （选择一个进程后。）您可能必须单击“显示系统进程”框。虽然可能没有有用的信息......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T21:58:41.133

下面是示例代码、工具链接以及有关[如何调试挂起的 .NET 进程的](http://blogs.msdn.com/tess/pages/net-debugging-demos-information-and-setup-instructions.aspx)演示文稿。

您可能还想观看[此视频演示](http://channel9.msdn.com/posts/MSDNSweden/Vanliga-fel-som-grs-med-ASPNET-och-hur-du-hittar-dem-med-WinDbg/)，其中包含相同的工具和示例。尽管网页上有瑞典语文本，但视频是英文的。

# c# - RedirectToAction 错误？

> ID：376130
> 
> 赞同：3
> 
> 时间：2008-12-17T21:43:13.050
> 
> 标签：c#, asp.net-mvc, beta

我有以下代码：

控制器：

```
public ActionResult Step1()
{
        return View();
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Step1(FormCollection form)
{
        TempData["messageStatus"] = new Random().Next(1, 1000);
        return RedirectToAction("Step1");
} 
```

看法：

```
<%=TempData["messageStatus"]%> 
```

例如，在第一次查看时我得到**12345**，但是当我第二次请求时，我当然必须得到其他东西而不是**12345**，例如**54321**但不是，我得到相同的结果**12345**，你怎么解释？**RedirectToAction**缓存页面？

这意味着我必须将 Guid 放入我的 url 以解决缓存问题？你怎么看这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T22:33:57.333

我猜你遇到了缓存问题。重定向到操作不是问题。RedirectToAction 所做的只是向您的浏览器发出重定向响应，告诉它请求 Step01。然后您的浏览器向 Step01 发出请求。

在这种情况下，您的浏览器可能缓存了 Step01。因此，您需要在 STep01 中添加一个 Response 标头，指示它永远不应该被缓存。你可以这样做：

```
[OutputCache(Location = OutputCacheLocation.None)]
public ActionResult Step1()
{
        return View();
} 
```

或者，您可以通过传入任意值将随机查询字符串添加到重定向到操作调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T21:45:44.590

不要每次都新建一个新的 Random 对象。使用相同的。请记住，.Net Random 只是一个伪随机数生成器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T21:48:25.303

试试这个：

```
TempData["messageStatus"] = new Random(DateTime.Now.Millisecond).Next(1, 1000); 
```

# persistence - Spring Webflow 2.0 的实体管理器可以从子流状态提交吗？

> ID：376132
> 
> 赞同：0
> 
> 时间：2008-12-17T21:44:06.683
> 
> 标签：persistence, entity, spring-webflow-2

我和我的团队目前正在使用 Spring 2.5.6 和 Spring Webflow 2.0 (JDK 1.4.2) 启动一个项目。我们现在处于设计阶段，我想知道 Spring 的持久性上下文/实体管理器（我们将使用 Hibernate）是否可以从子流提交。

commit 属性仅在结束状态时可用。所以，如果我们有这样的流程：

```
<flow>
<persistence-context />
<!-- Do some things -->
<!-- Call a subflow.  This hopefully will commit stuff. -->
<subflow-state id="foo">
</subflow-state>
<!-- Do some more things -->
<end-state id="theEnd" commit="true" />
</flow>

<!-- The Subflow -->
<flow>
<persistence-context />
<!-- Do some things -->
<!-- Do some more things -->
<end-state id="theEnd" commit="true" />
</flow> 
```

我们希望子流程能够在父流程完全执行之前提交其步骤。希望它可以。

子流能够提交吗？还是 webflow 会禁止这样做，只让真正的父流使用其实体管理器/持久性上下文提交到数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T23:20:17.033

好的，所以，答案是肯定的和否定的。子流实际上分配了与其父级不同的持久性上下文，并且它可以使用该持久性上下文来提交，但如果使用的技术是 Hibernate，则必须在发出提交结束状态之前将对象附加到其会话。

# c# - 如何为 ASP.net/C# 应用程序配置文件值中的值添加与号

> ID：376135
> 
> 赞同：230
> 
> 时间：2008-12-17T21:45:28.413
> 
> 标签：c#, asp.net, web-config

我有一个 C# 程序，其配置文件中有值。我想要的是为一个 url 值存储与号，比如......

```
<appSettings>
  <add key="myurl" value="http://www.myurl.com?&cid=&sid="/>
</appSettings> 
```

但是我在构建我的网站时遇到了错误。& 号是不允许的。我尝试了各种形式的转义＆符号无济于事。有人知道这样做的正确形式吗？欢迎所有建议。

* * *

## 回答 #1

> 赞同：463
> 
> 时间：2008-12-17T21:46:33.700

使用“ `&amp;`”代替“&”。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-17T21:49:46.843

你试过这个吗？

```
<appSettings>  
  <add key="myurl" value="http://www.myurl.com?&amp;cid=&amp;sid="/>
<appSettings> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T21:49:35.380

我认为您应该能够使用 HTML 转义字符 (&)。它们可以在[http://www.theukwebdesigncompany.com/articles/entity-escape-characters.php找到](http://www.theukwebdesigncompany.com/articles/entity-escape-characters.php)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-05-28T16:07:34.377

尽管此处接受的答案在技术上是正确的，但根据评论，用户之间似乎存在一些混淆。在 .cshtml 文件中使用 ViewBag 时，您必须使用，`@Html.Raw`否则您的数据在被 ConfigurationManager 转义后，将再次重新转义。用于`Html.Raw()`防止这种情况发生。

# c++ - 在 C++ 程序中更改标准输出的值

> ID：376136
> 
> 赞同：3
> 
> 时间：2008-12-17T21:45:35.027
> 
> 标签：c++, c, stdout, filehandle

我有一个 Windows C++ 程序正在执行以下操作：

```
  文件* pf = ...;
  *标准输出= *pf；// stdout 在 stdio.h 中定义

```

我正在寻找有关更改标准输出文件句柄的值时会发生什么的解释。这只是重定向标准输出的一种方式吗？

-cr

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T21:49:41.183

是的，当您更改标准输出时，您实际上是在将其重定向到其他地方。但是，您不应该像**那样**直接分配给标准输出。如果你想重定向标准输出，你应该使用[`freopen()`](http://www.opengroup.org/onlinepubs/000095399/functions/freopen.html).

您永远不应该直接操作 FILE 对象 - 您应该将它们视为不透明类型，并且只能通过`<stdio>`库中的函数与它们交互。乔纳森列出了一些很好的理由。

来自 C99 标准，第 7.19.3 节，第 6 段：

> 用于控制流的 FILE 对象的地址可能很重要；FILE 对象的副本不需要代替原始对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-17T21:56:19.703

如果您`stdout`通过分配而不是使用指定的工具进行更改（在 C 中，`freopen()`正如 Adam Rosenfield 所说 - 并且通过扩展，在 C++ 中），那么您会让自己承担各种责任。

*   目前尚不清楚`cout`是否也会被重定向。
*   您可能会泄漏文件描述符（这可能无关紧要）。
*   您可能无法正确刷新原始标准输出 - 丢失信息。
*   您可能会泄漏与原始文件指针相关的内存（这同样可能无关紧要）。
*   如果有任何事情 close `pf`，那么您将对双重错误（崩溃）负责。

干净地完成工作要好得多。

（演示代码不一定是由供应商编码团队中最有经验的人编写或审查的。如果它看起来很可疑，那可能是因为它很可疑。）

# outlook - Outlook 2007 需要通过 HTTP 的密码。（交换 2007）

> ID：376139
> 
> 赞同：1
> 
> 时间：2008-12-17T21:46:10.330
> 
> 标签：outlook, exchange-server, outlook-2007, exchange-server-2007

我有一个配置了 ActiveSync 和 RPC over HTTP 的 Exchange 2007。

以下是有效的方法：

*   网络内部的 Outlook。
*   移动设备。
*   Outlook Web 访问。

唯一不起作用的是：

*   网络外的 Outlook。

每当有人在网络之外试图通过 Outlook 访问他们的电子邮件时，他们就会不断地收到用户名和密码提示。机器可以通过 HTTP 访问网络，因此防火墙配置似乎正确。该机器还具有正确的根证书。

我不确定这里发生了什么。任何提示将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T20:44:32.217

好的，找到了！

[http://support.microsoft.com/kb/927612](http://support.microsoft.com/kb/927612)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T21:51:42.753

我**认为** 这是预期的行为。在网络之外，您不再在域中，因此连接需要您在打开 Outlook 时进行身份验证才能连接到正确的邮件存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T21:52:30.957

你在用火狐吗？

在 Firefox 中转到 url：“about:config”页面

然后搜索键“network.ntlm.send-lm-response”并将其设置为true

这可能无济于事，但有时我的学校代理会在几秒钟内提示我输入数十次密码，而这个密钥会自动解决这个问题

# web-services - 通过 WebServices 从 Sharepoint 日历展开重复事件？

> ID：376142
> 
> 赞同：4
> 
> 时间：2008-12-17T21:46:39.410
> 
> 标签：web-services, sharepoint

是否可以使用通过 Lists.aspx 公开的 Web 服务从 Sharepoint 的日历中获取事件列表（扩展了重复事件）？

如果您使用 C# 或 VB，这显然是可能的，如此处所述[，](http://blogs.msdn.com/sharepoint/archive/2007/05/14/understanding-the-sharepoint-calendar-and-how-to-export-it-to-ical-format.aspx)使用如下代码段：

```
SPQuery query = new SPQuery();
query.ExpandRecurrence = true;
query.Query = "<Where><DateRangesOverlap><FieldRef Name=\"EventDate\" /><FieldRef Name=\"EndDate\" /><FieldRef Name=\"RecurrenceID\" /><Value Type=\"DateTime\"><Month /></Value></DateRangesOverlap></Where>"; 
```

我正在尝试通过 cURL 使用纯 XML 和这个查询来做同样的事情：

```
<GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">
<listName>{my guid goes here}</listName>
<query>
    <Query xmlns="">
    <Where>
    <DateRangesOverlap>
      <FieldRef Name="EventDate" />
      <FieldRef Name="EndDate" />
      <FieldRef Name="RecurrenceID" />
      <Value Type="DateTime"><Month/></Value>
   </DateRangesOverlap>
    </Where>
    </Query>
</query>
<queryOptions>
    <QueryOptions>
    <ExpandRecurrence>TRUE</ExpandRecurrence>
    </QueryOptions>
</queryOptions> 
```

这有点工作 - 它获取所有列表项，但不会扩展重复项。关键似乎是 ExpandRecurrence 属性。令人惊讶的是，除了几篇博客文章之外，谷歌似乎对此事没有太多要说的。在网上搜索时，我阅读了一些评论，指出 ExpandRecurrence 属性不起作用，但其他人说它工作正常，我读过的任何内容都没有让我印象深刻。

有没有人尝试过这个并让它在不使用 C# 或 VB 的情况下工作 - 只是直接的 XML？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-12-29T15:00:54.183

最后让它正常工作并返回 SharePoint 日历上的所有经常性事件。这是 Web 服务查询的 XML：

```
<GetListItems xmlns='http://schemas.microsoft.com/sharepoint/soap/'>
<listName>{your GUID goes here}</listName>
<query>
 <Query>
  <Where>
   <DateRangesOverlap>
    <FieldRef Name=\"EventDate\" />
    <FieldRef Name=\"EndDate\" />
    <FieldRef Name=\"RecurrenceID\" />
    <Value Type='DateTime'><Year/></Value>
   </DateRangesOverlap>
  </Where>
 </Query>
</query>
<queryOptions>
 <QueryOptions>
  <ExpandRecurrence>TRUE</ExpandRecurrence>
 </QueryOptions>
</queryOptions>
</GetListItems> 
```

关键不仅是将 ExpandRecurrence 选项设置为 true - 您还必须将 DateRangeOverlap 中的值包含为 Year。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-18T22:51:06.063

我想我有一个类似的问题，它只是返回列表中的项目，而不是实际扩展重复项目（即标记为每周一发生的项目仅显示为单个记录而不是多个记录）。

显然版本 12.0.0.6421 (2007 SP1)**不会**扩展项目，即使您通过 Web 服务 API 告诉它这样做也是如此。当我们应用最新的累积更新（2011 年 8 月）时，它按我们的预期工作（即它会在每个星期一返回多个预定条目）。

这是我应用 CU 后的代码：

```
 Query for ndQuery:
--------------------
<Where>
<DateRangesOverlap>
<FieldRef Name=""EventDate"" /><FieldRef Name=""EndDate"" /><FieldRef Name=""RecurrenceID"" />
<Value Type=""DateTime""><Month/></Value>
</DateRangesOverlap>
</Where>>
<OrderBy><FieldRef Name='ID' /></OrderBy>

query options for ndQueryOptions:
-----------------------------------------------
<IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns>
<DateInUtc>TRUE</DateInUtc>
<ViewAttributes Scope=\"Recursive\" />
<RecurrencePatternXMLVersion>v3</RecurrencePatternXMLVersion>
<ExpandRecurrence>True</ExpandRecurrence>
<CalendarDate>2011-10-16T00:00:00Z</CalendarDate>
<RecurrenceOrderBy>TRUE</RecurrenceOrderBy>
<ViewAttributes Scope=\"RecursiveAll\"/>

Web service call:
------------------------
XmlNode results = wsList.GetListItems("Events", String.Empty, ndQuery, ndViewFields, String.Empty, ndQueryOptions, "F43559AF-C643-4FF3-AAA3-77471A2D1979"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T07:43:28.020

我追踪这个问题的方法是使用 TcpTrace ( [http://www.pocketsoap.com](http://www.pocketsoap.com) ) 之类的东西来查看正在发送的 XML 数据包。然后是确保手工制作的 XML 数据包看起来相同的问题。我希望当您看到 XML 数据包时，区别应该很明显。然后你可以用答案更新这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-23T12:11:05.073

是的，您可以在共享点日历​​中拆分重复事件，并可以从列表中下载特定时间段。

我已经为此创建了一个自定义 dll。

[https://github.com/shafeeequalipt/Share-Point-Recurrance-event-splitter](https://github.com/shafeequealipt/Share-Point-Recurrance-event-splitter)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-06-04T13:08:03.940

不，是不可能的。您需要通过例如 SPQuery 对象来使用 SP 对象模型。但这意味着您必须直接在共享点服务器上运行该代码，而不是从客户端调用。

请看我的这篇文章；[http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/3c399768-c492-4d7e-8f6e-fa304ed03131](http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/3c399768-c492-4d7e-8f6e-fa304ed03131)

# php - Zend Framework 中没有模块的深度路由 - 如何？

> ID：376144
> 
> 赞同：0
> 
> 时间：2008-12-17T21:46:51.640
> 
> 标签：php, zend-framework, routing

我正在为 REST 服务编写一些路由。我的资源的一个 URI 看起来像这样

资源/用户/：id

我还想访问用户的各个属性，看起来像这样

资源/用户/：id/：属性

但是当我尝试定义后一条路线时，它不起作用。这是我定义路由的ini

```
routes.user.route = "resources/user/:id"
routes.user.defaults.controller = user
routes.user.defaults.action = get
routes.user.defaults.id = 0
routes.user.reqs.id = "\d+"

routes.user_attribute.route = "resources/user/:id/:attribute/"
routes.user_attribute.defaults.controller = user
routes.user_attribute.defaults.action = getAttribute
routes.user_attribute.defaults.id = 0
routes.user_attribute.defaults.attribute = ""
routes.user_attribute.reqs.id = "\d+"
routes.user_attribute.reqs.id = "reviews|lists" 
```

当我尝试在浏览器中访问 resources/user/4/reviews 时，我得到以下输出

```
An error occurred
Page not found
Exception information:

Message: Invalid controller specified (resources)
Stack trace:

#0 /usr/local/lib/ZendFramework/ZendFramework-1.7.1-minimal/library/Zend/Controller/Front.php(934): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#1 /home/baileyp/public_html/web/index.php(50): Zend_Controller_Front->dispatch()
#2 {main}

Request Parameters:

array(4) {
  ["controller"]=>
  string(9) "resources"
  ["action"]=>
  string(4) "user"
  [10]=>
  string(7) "reviews"
  ["module"]=>
  string(7) "default"
} 
```

因此，它显然没有正确处理我的第二条路线，因为控制器是“资源”而操作是“用户”。我在这里做错了什么？我发现 Zend 站点上没有任何示例可以说明如何实现这一点。

而且我不想使用模块来完成这项工作 - 避免创建文件夹等只是为了匹配 URI 是路由系统的全部目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T15:18:45.573

我不确定你是否同时定义这两个。根据我的经验，您尝试映射的第一条路线实际上会被第二条处理得很好（感谢您提供的默认值`attribute`）。

因此，这条路线：

```
foo.com/resources/user/:id/:attribute 
```

有了这个电话：

```
foo.com/resources/user/12345/ 
```

假设您的默认属性值：

```
foo.com/resources/user/12345// 
```

由于您的 Web 服务器可能会删除空白值（apache 将多个斜杠视为单个斜杠），我建议将属性默认为可以按名称调用的内容，它的功能类似于 index.html 文件中的文件夹：

```
foo.com/resources/user/12345/
foo.com/resources/user/12345/general/ (same result) 
```

我进行故障排除的最好运气是按顺序逐行注释掉路由默认值和要求。您最终会看到路线本身的“边缘”（因为它会回退到默认值，因为您提供的信息较少）。

另外，在您的示例中，请注意您定义了`id`两次要求：

```
 routes.user_attribute.reqs.id = "\d+"
 routes.user_attribute.reqs.id = "reviews|lists" 
```

将调整为：

```
 routes.user_attribute.reqs.id = "\d+"
 routes.user_attribute.reqs.attribute = "reviews|lists" 
```

也可能对您的结果产生影响。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T22:14:03.457

我认为您应该只更改规则的顺序……所以您首先将更具体的规则放在顶部，将更一般的规则放在底部！

```
routes.user_attribute.route = "resources/user/:id/:attribute/"
routes.user_attribute.defaults.controller = user 
routes.user_attribute.defaults.action = getAttribute
routes.user_attribute.defaults.id = 0
routes.user_attribute.defaults.attribute = ""
routes.user_attribute.reqs.id = "\d+"
routes.user_attribute.reqs.id = "reviews|lists"

routes.user.route = "resources/user/:id"
routes.user.defaults.controller = user
routes.user.defaults.action = get
routes.user.defaults.id = 0
routes.user.reqs.id = "\d+" 
```

我有一个类似的问题，它解决了我的问题！

# c++ - std::map + std::tr1::bind + 标准算法值得吗？

> ID：376154
> 
> 赞同：7
> 
> 时间：2008-12-17T21:50:57.607
> 
> 标签：c++, algorithm, stl, bind

[这是我昨天提出的问题](https://stackoverflow.com/questions/372695/is-there-a-standard-c-function-object-for-taking-apart-a-stdpair)的后续。我想到了 Scott Meyers 关于只写代码的警告。我喜欢原则上使用标准算法来访问 std::map 的键或值的想法，但所需的语法有点巴洛克式恕我直言。假设我想将地图的所有键转储到向量。鉴于以下声明，

```
typedef std::map<int, int> MyMap;
MyMap m;
std::vector<int> v; 
```

哪个代码更易于维护（即，可能更少混淆）？

选项1：

```
std::transform(m.begin(),
               m.end(),
               std::back_inserter(v),
               std::tr1::bind(&MyMap::value_type::first, _1)); 
```

选项#2：

```
for (MyMap::iterator i = m.begin(); i != m.end(); ++i)
{
    v.push_back(i->first);
} 
```

选项 1 是更标准的库式，但我必须在精神上分解它以了解发生了什么。选项 2 似乎更容易阅读，但代价是可能的运行时损失很小。我不会因为 CPU 时间而受到伤害，所以我倾向于选项 2。你们同意吗？我应该考虑第三种选择吗？

PS 在写这个问题的过程中，我得出的结论是（对于我的项目）读取 std::map 的键的最佳方法是将它们存储在一个侧面容器中并对其进行迭代。可维护性问题仍然存在。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T22:18:09.987

清晰总是胜过聪明。做你以后能读到的。

您并不是唯一一个认为标准代码有点迟钝的人。下一个 C++ 标准将引入[lambda 函数](http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions)，以便您可以使用标准算法编写更清晰的代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-17T22:18:46.537

第一个和第二个一样可读和可维护——*如果*你知道做什么的话`bind`。我一直在使用 Boost::Bind （基本上等同于`std::tr1::bind`）足够长的时间，所以我没有遇到任何问题。

一旦 TR1 成为官方标准的一部分，您可以放心地假设任何称职的 C++ 程序员都会理解它。在那之前，它可能会带来一些困难，但我总是考虑长期而不是短期。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T22:24:11.377

你忘了`using namespace std::tr1::placeholders`:P

老实说，对于像这样的简单算法，后面的代码可能更容易维护。但我实际上倾向于前者（尤其是当 C++1x 为我们提供 lambda 时！），因为它强调编程的函数式风格，我个人更喜欢使用循环的命令式风格。

这真的是不同的笔画；标准算法在复杂或通用时最有用，而这两者都不是。

下面是 lambda 的样子：

```
std::transform(m.begin(), m.end(), std::back_insterter(v),
               [](MyMap::value_type pair){ return pair.first; }
              ); 
```

实际上，还有另一种方法，我更喜欢它，但它的冗长：

```
using std::tr1::bind;
using std::tr1::placeholders::_1;
std::for_each(m.begin(), m.end(),
              bind(&std::vector<int>::push_back, v,
                   bind(&MyMap::value_type::first, _1)
                  )
             ); 
```

使用 lambdas（这可能是所有选项中最简洁和最明确的）：

```
std::for_each(m.begin(), m.end(),
              [&v](MyMap::value_type pair){v.push_back(pair.first);}
             ); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-17T21:58:21.273

我说去2）

为了提高性能，您可以`m.end()`跳出循环并在向量中保留空间。

等不及 C++0x 和基于范围的 for 循环了；这将使您的循环更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-18T00:55:24.537

选择选项 #1，请参阅 Scott Meyers，[Effective STL](https://rads.stackoverflow.com/amzn/click/com/0201749629) Item #43，第 181 页。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-18T15:39:36.343

当我昨天查看您的问题时，不是绑定（我经常使用）迫使我看两次才能理解代码，而是 map::value_type::first 我没有机会经常使用. 虽然我同意“清晰总是胜过聪明”，但在清晰之前需要熟悉，而且你不会熟悉你不使用的风格......

我还要说，虽然选项 2 在理解预期目的方面更清晰，但它更容易隐藏错误（选项 1 中的任何错误更有可能在编译时可见）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-23T23:28:14.020

我会选择选项＃3：

```
#include <boost/range/adaptor/map.hpp>
#include <boost/range/algorithm_ext/push_back.hpp>

boost::push_back(v, m | boost::adaptors::map_keys); 
```

这样做的好处是：

1.  更短

2.  使用命名函数来获取密钥

3.  （可能）更有效（因为`boost::push_back`可以调用`reserve()`）`v`

4.  并且不需要多余的`v.begin()`,`v.end()`对。

任何其他方式都是纯粹的疯狂。

# c# - MemoryStream.Read 不会将字节复制到缓冲区 - c#

> ID：376156
> 
> 赞同：18
> 
> 时间：2008-12-17T21:52:07.307
> 
> 标签：c#, image, buffer, memorystream

我真的不明白，它让我发疯。我有这 4 行：

```
Image img = Image.FromFile("F:\\Pulpit\\soa.bmp");
MemoryStream imageStream = new MemoryStream();
img.Save(imageStream, ImageFormat.Bmp);
byte[] contentBuffer = new byte[imageStream.Length];
imageStream.Read(contentBuffer, 0, contentBuffer.Length); 
```

调试时我可以看到 imageStream 中的字节值。在 imageStream.Read 之后我检查 contentBuffer 的内容，我只看到 255 个值。我不明白为什么会这样？这几行没有什么可做的！如果有人可以帮助我，将不胜感激！谢谢，阿格涅斯卡

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-12-17T21:57:22.087

尝试将 imageStream.Position 设置为 0。当您写入 MemoryStream 时，它会将位置移动到您刚刚写入的字节之后，因此如果您尝试读取，那里什么都没有。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-12-17T21:56:03.290

您需要重置文件指针。

```
imageStream.Seek( 0, SeekOrigin.Begin ); 
```

否则，您将从流的末尾读取。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-17T22:00:54.670

添加：

```
imageStream.Position = 0; 
```

就在之前：

```
imageStream.Read(contentBuffer, 0, contentBuffer.Length); 
```

读取指令中的 0 代表与内存流中当前位置的偏移量，而不是流的开始。加载流后，位置位于末尾。您需要将其重置为开头。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-17T22:04:12.137

```
Image img = Image.FromFile("F:\\Pulpit\\soa.bmp");
MemoryStream imageStream = new MemoryStream();
img.Save(imageStream, ImageFormat.Bmp);
byte[] contentBuffer = new byte[imageStream.Length];
imageStream.Position = 0;//Reset the position at the start
imageStream.Read(contentBuffer, 0, contentBuffer.Length); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-10-17T21:47:48.950

只需使用

```
imageStream.ToArray() 
```

它可以工作并且更容易。

# osgi - 什么是典型的 OSGi 生命周期？

> ID：376159
> 
> 赞同：0
> 
> 时间：2008-12-17T21:52:29.133
> 
> 标签：osgi, lifecycle

在开发和部署基于 OSGi 的系统时，我想深入了解工业中使用的生命周期。
我的主要关注点是部署阶段，在开发阶段创建版本并打包捆绑包之后。可能执行的具体测试程序和集成方法。
具有一些低级别详细信息的非常高级帐户将非常有帮助。
谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-27T21:19:49.827

OSGi 捆绑包可以在运行的 OSGi 引擎（无论是 Equinox、Felix、dmServer 等）中组装在一起。与其他代码一样，可能依赖于特定于平台的行为（例如仅在使用 c:\ 样式文件引用的 Windows 上工作的代码）、与 JNI 一起工作且仅对 x86 平台有效的代码等。在这些情况下，OSGi 不会帮助或阻碍软件测试。

它可以增加复杂性的地方在于运行包的纯粹组合爆炸。与 Java 应用程序不同，它可以非常愉快地在单个整体 CLASSPATH 上运行，您往往直到稍后才发现错误（例如，尝试加载 JDBC 驱动程序时的 ClassNotFoundException）。在这方面，OSGi 有助于确保您必须至少有必要的软件包导出包；但即便如此，一些包可能是可选的，因此最终会遇到同样的问题。

作为 OSGi 捆绑器，您确实需要测试：

*   这些包实际上都启动了吗，即在安装到您最喜欢的 OSGi 引擎之后， start *n*是否正常工作？如果您拥有所有依赖项，那么它应该从 INSTALLED 到 RESOLVED 再到 ACTIVE；如果它停留在 INSTALLED 中，则意味着它缺少一些依赖项
*   您的应用程序是否需要在 OSGi VM 启动时启动某些捆绑包（如声明式服务或远程服务）？
*   捆绑包之间是否存在起始顺序问题？它们都应该正常工作，但您可能想测试如果 Bundle A 在 Bundle B 之前启动会发生什么

这些是您在验证一组捆绑包以相互协作时必须查看的额外测试内容。理想情况下，您应该有可以运行的 OSGi VM 测试——这就是 Eclipse 的 JUnit 插件测试的运行方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T01:26:59.337

我建议阅读[dmServer 入门指南](http://static.springsource.com/projects/dm-server/1.0.x/getting-started/pdf)或查看[SpringSource.org dmServer 站点](http://www.springsource.org/dmserver)的其他信息。

入门指南介绍了一个名为*GreenPages*的小型 Web 应用程序，它是从一个框架项目结构分阶段构建的。最终实现是一个模块化的多捆绑应用程序。在此过程中，单元和集成测试在 Eclipse 以及独立 (Maven) 构建中进行了演示。

尽管 Eclipse 很大，而且是一个有用的示例，但我不认为它是典型的 OSGi 模块化系统，我也不知道对所采用的开发过程生命周期的解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T01:52:03.310

您可以学习 Eclipse，因为它是我所知道的最大的基于 OSGi 的系统之一。他们有很多文档讨论版本控制以及他们如何在 eclipse 平台中使用测试。

# python - 是否有用于编辑 msword doc 文件的 python 库？

> ID：376161
> 
> 赞同：6
> 
> 时间：2008-12-17T21:52:56.823
> 
> 标签：python, ms-word

> **可能重复：**
> [在 Python 中读/写 MS Word 文件](https://stackoverflow.com/questions/188444/reading-writing-ms-word-files-in-python)

我知道有一些库可以编辑 excel 文件，但是有什么可以在 python 中编辑 msword 97/2000/2003 .doc 文件吗？理想情况下，我想根据文本的内容对文本的格式进行一些小的更改。一个非常简单的例子是突出以大写字母开头的每个单词。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T22:10:32.170

为什么不考虑使用[python-uno](http://wiki.services.openoffice.org/wiki/Python)将文档加载到 OpenOffice 并使用 UNO 界面对其进行操作。我刚刚链接到的网站上有一些示例代码可以帮助您入门。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T22:08:33.420

如果平台独立性很重要，那么我建议通过 BASIC 或 Python 使用 OpenOffice API。OpenOffice 也可以在没有 GUI 的情况下以无头模式运行，因此您可以将其自动化用于批处理作业。这些链接可能会有所帮助：

*   [(BASIC) OpenOffice 中的文本文档](http://wiki.services.openoffice.org/wiki/Documentation/BASIC_Guide/Structure_of_Text_Documents)
*   [(Python) 示例](http://wiki.services.openoffice.org/wiki/PyUNO_samples)

它肯定比导入模块和进行字符串替换更复杂，但 OpenOffice 可能是最好的免费 .doc 阅读器，您可以使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T21:58:34.003

[PyWin32](http://python.net/crew/mhammond/win32/Downloads.html)库允许您从 Python 访问 COM 对象，包括所有各种 Office COM API。我不会声称它**易于**使用，但它确实有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T20:48:39.027

根据[这篇 SO 帖子](https://stackoverflow.com/questions/376221/programmatic-mail-merge-style-data-injection-into-existing-excel-spreadsheets)，我发现了使用[Apache POI的](http://poi.apache.org/)[jXLS](http://jxls.sourceforge.net/)。POI 有很多子组件，包括 HWPF：

> HWPF 是我们将 Microsoft Word 97 文件格式转换为纯 Java 的端口。它支持读取和有限的写入功能。请参阅 HWPF 项目页面了解更多信息。该组件处于开发的早期阶段。它已经可以读写简单的文件。

由于这是一个 Java 库，因此可以使用 Jython 编写脚本。我不知道写作能力有多好，但如果有帮助，请发表评论。

# dependency-injection - 在我的应用程序中开始使用 Castle Windsor 需要哪些程序集？

> ID：376164
> 
> 赞同：2
> 
> 时间：2008-12-17T21:53:52.640
> 
> 标签：dependency-injection, inversion-of-control, castle-windsor

我有一个关于如何开始使用 Castle Windsor 的非常基本的问题。我已经阅读了 IOC/DI 并想在现有的解决方案中尝试 Castle Windsor。我通常喜欢将任何外部程序集放在解决方案文件夹树中的 Lib 文件夹中，以便引用是相对的（我相信这是最佳实践）。

我需要将 Castle\Bin... 文件夹中的哪些程序集复制到我的 Lib 文件夹中？我需要为每个程序集添加显式引用还是只添加其中一些？

C:\dev\oss\Castle\Bin\net-2.0 文件夹中有 30 个程序集，C:\dev\oss\Castle\Bin\Dependencies 文件夹中有 18 个程序集。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T22:02:38.333

我认为这应该足以让你开始。

*   城堡核心
*   Castle.MicroKernel
*   温莎城堡

如果你想使用 log4net 进行日志记录，那么......

*   log4net
*   城堡.设施.记录
*   Castle.Services.Logging.Log4netIntegration

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T22:04:42.570

只有 Castle.Core、Castle.MicroKernel 和 Castle.Windsor 需要能够使用 Windsor。

# asp.net - DropDownList SelectedIndex 始终 = 1

> ID：376168
> 
> 赞同：2
> 
> 时间：2008-12-17T21:55:09.143
> 
> 标签：asp.net

我在页面中有一个下拉列表。所有列表项的值 =“0”。我关闭了视图状态。当页面回发时，无论列表中的选择如何，在 Page_load 事件中选择的索引始终 = 1。如果列表项的值不同，则 selectedIndex 具有正确的值。这是正常行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T21:59:20.710

是的。这些值用于指示回发时所选项目的内容。如果您的所有项目都具有相同的值，那么它会找到与该值匹配的第一个项目，因此 SelectedIndex = 1。

实践建议在 value 字段中使用 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T21:58:18.823

如果 dropdownlist 变成 HTML Select List，那么是的，浏览器提交每个选项的 value 属性，因此如果它们都相同，您将始终得到相同的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T21:58:36.140

嗯，差不多。selectedIndex 告诉您哪个选项具有回发的值。由于所有的值都是相同的，浏览器可以选择它喜欢的任何选项，这将是正确的。'interesting' 属性是值，而不是选项的文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T21:59:55.153

这是预期的行为。HTML SELECT 元素只发回值，而不是文本。如果所有 OPTION 具有相同的值，那么看起来每个选项都被选中，因此 ASP.Net 选择第一个。

如果不使用该值，则可以省略它，它将与文本相同。或者您可以显式设置与文本相同的值。另一种选择是使用列表项的索引作为值。但是除非您使用不同的值（如 HTML 中呈现的那样），否则下拉列表或多或少是无用的。

# visual-studio-2008 - Visual Studio 无法将报表部署到 MSRS

> ID：376170
> 
> 赞同：3
> 
> 时间：2008-12-17T21:55:42.357
> 
> 标签：visual-studio-2008, reporting-services

Visual Studio 无法在远程 MSRS 实例上部署报表或数据源。错误信息是

> 无法连接到远程服务器。

服务器已启动并正在运行，并且`TargetServerURL`项目的属性指向在浏览器中工作的正确 url。

我四处搜索，但发现了一些讨论同一问题的论坛主题，但没有一个有任何相关的解决方案。

我正在使用`VS2008`和`MSRS 2008`。

有没有人见过这个？任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T22:12:59.107

这发生在我几周前。

确保 TargetServerURL 是`http://server/ReportServer/`而不是`http://server/Reports/`

报告服务的 Web 服务部分（以编程方式发布/查看/编辑报告）和可视 UI 使用不同的 URL，您可以在其中进入并浏览文件夹等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-05T00:33:00.540

不错的渔获。就我而言，这是最后一个正斜杠丢失（`"http://server/ReportServer"`而不是`"http://server/ReportServer/`）。还要检查 SecureConnectionLevel 键（在 中找到`C:\Program Files\Microsoft SQL Server\MSRS10.MSSQLSERVER\Reporting Services\ReportServer\rsreportserver.config`）以查看值是否设置为`"0"`。

# vb.net - linqtosql 将不允许更新字段，因为它将它们转换为只读

> ID：376174
> 
> 赞同：1
> 
> 时间：2008-12-17T21:57:07.953
> 
> 标签：vb.net, linq, linq-to-sql

我在 linqtosql 中遇到 linq 更新问题

从下面的代码

```
Dim lqPatientTable As New lqHospitalDataContext
    Dim strPatientId As String
    strPatientId = Me.ucboPatientInfo.SelectedRow.Cells(5).Value

    Dim lqPatientName = (From lqp In lqPatientTable.Patients _
                             Where lqp.PatientID = strPatientId _
                             Select lqp.FirstName, lqp.LastName)
    For Each row In lqPatientName
        row.LastName = utxtPatientLastName.Text
        row.FirstName = utxtPatientFirstName.Text
    Next
    lqPatientTable.SubmitChanges() 
```

Visual Studio 告诉我 row.LastName 是只读的，我没有在任何地方进行该分配，我看不出问题出在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T03:01:57.183

当您只选择单个字段时，您正在动态创建一个匿名类型，它不再是 ORM 更改跟踪/更新机制的一部分。

您需要将选择部分更改为“选择 lqp”才能正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T22:02:21.203

您在“For Each”循环的第一行分配给 row.LastName。

您是否正在使用选项严格/显式打开或关闭？如果选项 strict 在该行上，则不应编译。

您看到这种情况的原因是，在为包含显式 Select 子句的查询创建匿名类型时，结果类型的所有属性都将是只读的。它与使用 Key 字段在匿名类型上声明所有属性具有相同的效果。例如

```
Dim x = New With { Key .Name ="foo" } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T22:03:46.287

当您为数据上下文创建 dbml 文件时，它是否将 LastName 属性创建为只读字段？打开 dbml 查找字段并检查属性以查看它是否设置为只读...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T22:05:12.617

两者的只读都设置为 false

Option Explicit 和 Option strict 也都关闭了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T22:16:33.653

这是实体框架比 Linq2Sql 更好的一件事（真的是唯一的一件事！）。您可以从不同的表中选择各种字段，但它仍然可以更新。使用 Linq2Sql，如果您从多个表中进行选择（即使在这里您不是，但是当您创建一个新的匿名类型时，它是相同的想法）它变成只读的。

# php - Zend 框架 - Zend_Form 装饰器问题

> ID：376188
> 
> 赞同：4
> 
> 时间：2008-12-17T22:00:02.813
> 
> 标签：php, zend-framework, zend-form

我有一个像这样扩展 Zend_Form 的类（简化）：

```
class Core_Form extends Zend_Form
{
    protected static $_elementDecorators = array(
        'ViewHelper',
        'Errors',
        array('Label'),
        array('HtmlTag', array('tag' => 'li')),
    );  

    public function loadDefaultDecorators()
    {
        $this->setElementDecorators(self::$_elementDecorators);
    }
} 
```

然后我使用该类来创建我的所有表单：

```
class ExampleForm extends Core_Form
{
    public function init()
    {
        // Example Field
        $example = new Zend_Form_Element_Hidden('example');
        $this->addElement($example);
    }
} 
```

*在我的一个观点中，我只*需要显示这一个字段（不需要 Zend_Form 生成的任何其他内容）。所以在我看来，我有这个：

```
<?php echo $this->exampleForm->example; ?> 
```

这工作正常，除了它生成这样的字段：

```
<li><input type="hidden" name="example" value=""></li> 
```

这显然是因为我将元素装饰器设置为包含 HtmlTag: tag => 'li'。

**我的问题是：如何禁用此元素的所有装饰器。我不需要隐藏输入元素的装饰器。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-18T11:21:53.833

设置它的最佳位置是公共函数 loadDefaultDecorators()

例如像这样：

```
class ExampleForm extends Core_Form
    {
        public function init()
        {
            //Example Field
            $example = new Zend_Form_Element_Hidden('example');
            $this->addElement($example);
        }

        public function loadDefaultDecorators()
        {
            $this->example->setDecorators(array('ViewHelper'));
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T23:54:31.367

将表单元素的装饰器重置为仅使用“ViewHelper”。例如：

```
<?php echo $this->exampleForm->example->setDecorators(array('ViewHelper')) ; ?> 
```

显然，视图不是执行此操作的理想位置，但您明白了。请注意，调用 setDecorator***s***() 会重置所有装饰器，而不是添加一个新装饰器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-28T17:10:36.070

如果您禁用隐藏元素上的 dd/dt 装饰器，您将获得无效的 XHTML，因为您将拥有一些在 dl 中不是有效项的内容。唯一的解决方案是在所有表单元素上禁用这些装饰器，而不仅仅是隐藏的元素，并且也在整个表单上禁用它们。为了保持一致性，您需要在所有表单中执行此操作。

恕我直言，这是采埃孚的错误设计决定。我的意思是，说输入的值是“术语”的“定义”在语义上是一个可爱的想法，但它并没有经过深思熟虑。

同样的问题：[Zend 框架：如何删除 Zend 表单隐藏元素上的装饰器？](https://stackoverflow.com/questions/481871/zend-framework-how-do-i-remove-the-decorators-on-a-zend-form-hidden-element)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-11T03:09:00.490

如果要以这种方式添加元素：

```
$this->addElement(
  'text',
  'a1',
  array('required' => true, 'validators' => array('Alpha'))
); 
```

您可以使用以下方法获取`dd/dt`每个元素的标签：

```
$this->setElementDecorators(array('ViewHelper')); 
```

或者如果您打算以其他方式添加元素：

```
$nombre1 = new Zend_Form_Element_Text(
          'n1', 
          array('id'=> 'Nombre1', 'validators' => array('Alpha') )
            );
//$nombre1->setDecorators(array('ViewHelper'));
$this->addElement($nombre1); 
```

您需要取消注释：

```
//$nombre1->setDecorators(array('ViewHelper')); 
```

为了禁用`dd/dt`标签。最后一种方法只是禁用当前元素，表单中的其他元素保持`<dd>` `<dt>`标签正常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-08T18:13:08.517

这就是我所做的：

```
class M_Form_Element_Hidden extends Zend_Form_Element_Hidden {
   public function init() {
      $this->setDisableLoadDefaultDecorators(true);
      $this->addDecorator('ViewHelper');
      $this->removeDecorator('DtDdWrapper');
      $this->removeDecorator('HtmlTag');
      $this->removeDecorator('Label');
      return parent::init();
   }
} 
```

然后在你的表格中，

```
$element = new M_Form_Element_Hidden('myElement');
$this->addElement($element); 
```

[来源](http://blog.montmere.com/2011/01/08/zend_form_element_hidden-not-really-hidden/)

# openoffice.org - 使用 python-uno 以编程方式启动多个幻灯片放映

> ID：376192
> 
> 赞同：0
> 
> 时间：2008-12-17T22:00:55.480
> 
> 标签：openoffice.org

我一直在使用 Python-uno 界面来启动 OpenOffice 并在基于 Linux 的布告栏系统上运行 PowerPoint 幻灯片放映。现在客户想要制作一个分屏并在屏幕上同时显示四个不同的幻灯片。

但是，每当我在 OpenOffice 的第二个实例中开始幻灯片放映时，第一个幻灯片放映就会冻结。

以前有没有人遇到过这个问题？有人解决了吗？

我在 Debian Linux 上运行 OpenOffice 2.4。我在不同的进程中运行两个完全独立的 OpenOffice 实例，但它们似乎仍然相互影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-12-15T03:23:04.767

我知道这是一个死帖，但我认为它对任何有这个问题的人都有用。

尝试去[这个论坛](http://www.oooforum.org/forum/viewtopic.phtml?t=1051)。您可以尝试使用 OpenOffice 宏并使用 python 函数访问它。这是宏代码：

```
Sub hello 

    dim xPresentation as object 
    set xPresentation = thiscomponent.getpresentation 
    xPresentation.setPropertyValue("IsEndless", true)  'loops around 
    xPresentation.start() 

End Sub 
```

对于 python 部分，我认为您需要使用 URL "macro:///MyLibrary/MyModule/MyFunction(/home/foo) 调用 /usr/bin/soffice (可能是 /usr/lib/libreoffice/program/soffice) /bar/MyImpressDoc.sxi"

# java - 在不使用调试参数启动 JVM 的情况下调试 java 应用程序

> ID：376201
> 
> 赞同：100
> 
> 时间：2008-12-17T22:02:56.880
> 
> 标签：java, debugging, jvm, jvm-arguments

通常要将调试器附加到正在运行的 jvm，您需要使用以下参数启动 jvm：

```
> java -Xdebug -Xrunjdwp:transport=dt_socket,address=1000,server=y,suspend=n 
```

现在如果我想调试一个没有在调试模式下启动的进程，我该怎么办？

当生产系统（即在没有调试参数的情况下启动）出现“随机”（我松散地使用该术语）错误时，就会出现这种情况。所以我无法使用适当的参数重新启动 jvm，因为没有人知道如何再次重现该错误。在这种情况下是否无法附加到JVM？

只是为了澄清不可能使用像 jdb 这样的工具来附加到已经运行的 JVM，除非它们是在调试模式下启动的

来自 JVM 手册页

> **使用 jdb 的另一种方法是将它附加到已经运行的 Java VM。要使用 jdb 调试的 VM 必须使用以下选项启动：**

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-12-17T22:27:09.000

您可以使用[jsadebugd](http://docs.oracle.com/javase/7/docs/technotes/tools/share/jsadebugd.html) ( [JDK](http://docs.oracle.com/javase/7/docs/technotes/tools/) ) 将调试服务器附加到进程（在 Windows 上可通过[Debugging Tools for Windows 获得](http://msdn.microsoft.com/en-US/windows/hardware/gg463009)）。它被标记为实验性的，因此您可能想先在测试机器上试用它。

用法：

```
jsadebugd <pid>
jdb -connect sun.jvm.hotspot.jdi.SADebugServerAttachingConnector:debugServerName=localhost 
```

可以使用 找到带有 arg 的连接器名称`jdb -listconnectors`。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2010-06-10T14:52:33.843

> 只是为了澄清不可能使用像 jdb 这样的工具来附加到已经运行的 JVM > > 除非它们是在调试模式下启动的

在苏联俄罗斯源读你

```
jdb -connect sun.jvm.hotspot.jdi.SAPIDAttachingConnector:pid=9426 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-17T22:51:13.570

[VisualVM](https://visualvm.github.io/)不是调试器，但您可以从中获取线程转储和堆转储，这对于诊断某些问题很有用。最有用的功能需要 JVM 5 或 6。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-10-08T01:07:33.133

使用 jstack（在死锁的情况下很有用）或[btrace](https://kenai.com/projects/btrace) VisualVM 插件也可以解决问题

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2008-12-17T22:29:40.790

您始终可以手动使用 jdb 和调试：P

# msmq - 连接到专用远程 MSMQ 队列

> ID：376208
> 
> 赞同：6
> 
> 时间：2008-12-17T22:05:53.037
> 
> 标签：msmq, spring.net

我正在尝试使用以下路径连接到远程私有 MSMQ 队列：

```
"FormatName:DIRECT=OS:remoteMachineName\Private$\MyQueue" 
```

我收到以下错误：

```
"The specified format name does not support the requested operation. For example, a direct queue format name cannot be deleted." 
```

我显然做错了什么。但是，这确实可以使用本地队列。

我正在使用 Spring.Net 的[Messaging](http://www.springframework.net/doc-latest/reference/html/msmq.html)。这是我的配置

```
<objects xmlns="http://www.springframework.net">
  <object id="myQueue" type="Spring.Messaging.Support.MessageQueueFactoryObject, Spring.Messaging">
    <property name="Path" value="FormatName:DIRECT=OS:remoteMachineName\Private$\MyQueue"/>
  </object>

  <object id="messageQueueTemplate" type="Spring.Messaging.Core.MessageQueueTemplate, Spring.Messaging">
    <property name="DefaultMessageQueueObjectName" value="myQueue"/>
  </object>

  <object id="messageGateway" type="My.MessageGateway, My.Assembly">
    <property name="MessageQueueTemplate" ref="messageQueueTemplate"/>
  </object>
</objects> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T22:22:28.480

这是一个事务队列吗？无法从事务队列远程读取。也许 spring 框架会尝试检查这是否是一个事务队列，这也是一个仅在本地队列上支持的操作。

推荐使用队列的原因是写入远程队列并从本地队列读取。在 msmq 4.0（vista 和 windows 2008）中支持远程事务读取（所以我听说过）。

您可以调试spring.net代码并在流程失败时查看确切代码吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T05:58:26.547

您的尝试是正确的，但是您必须为您的对象定义其他两个属性，指示您的队列是否是远程的并且是否是事务性的：

```
<object id="myQueue" 
        type="Spring.Messaging.Support.MessageQueueFactoryObject,Spring.Messaging">      
  <property name="Path" value="FormatName:DIRECT=OS:remoteMachineName\Private$\MyQueue"/>
  <property name="RemoteQueue" value="true"/>
  <property name="RemoteQueueIsTransactional" value="true"/>
</object> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-10-28T09:52:56.730

Microsoft 帮助文档指出专用队列仅在本地计算机上“可用”：

**公共**队列在整个消息队列网络中复制，并且可能被网络连接的所有站点访问。

**私有**队列不会在整个网络中发布。相反，它们仅在包含它们的本地计算机上***可用。***只有知道队列的完整路径名或标签的应用程序才能访问私有队列。

（来自： http: [//msdn.microsoft.com/en-us/library/19ww660c](http://msdn.microsoft.com/en-us/library/19ww660c(VS.71).aspx) (VS.71).aspx ）。

这实在是有点模棱两可！

Stack Overflow 上的另一篇文章引用了这篇文章：

[http://technet.microsoft.com/ja-jp/library/cc753440(WS.10).aspx](http://technet.microsoft.com/ja-jp/library/cc753440(WS.10).aspx)

其中对公共队列和私有队列有更有用的描述。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-05T09:13:14.177

首先映入我眼帘的是你的端点地址的大小写。至少在此线程或[此处](http://www.infosysblogs.com/microsoft/2007/05/msmq_receiving_messages_from_r.html)发布的所有其他示例都使用不同的大小写。其次，您没有转义字符串中的反斜杠。代替

```
"FormatName:DIRECT=OS:remoteMachineName\Private$\MyQueue" 
```

尝试

```
"FormatName:Direct=OS:remoteMachineName\\private$\\MyQueue" 
```

hth，埃里希

# java - Programmatic mail-merge style data injection into existing Excel spreadsheets?

> ID：376221
> 
> 赞同：4
> 
> 时间：2008-12-17T22:12:22.993
> 
> 标签：java, python, excel

I'd like to automate data entry into Excel spreadsheets. User data will exist on a web site, and when the user requests it, that data will need to be injected into an Excel spreadsheet. The complication is that the format of the Excel spreadsheet can vary significantly between users - it'll be user defined.

I've been thinking of this as a templating problem - the excel spreadsheet provides the template, and the task s to inject data into specific user defined cells within that template.

I've looked at xlwt and xlrd for python, as well as jexcelapi and POI-HSSF for Java. They seem like they could work, but given that I simply want to put values into certain cells, they seem like overkill. I'm also worried about re-writing the user's spreadsheet after processing; seems like an opportunity to introduce errors into the process.

Is there a way to tell excel to merge the data from one sheet into another? I'm thinking I could produce a simple spreadsheet that has only the data, and somehow get Excel to merge it into the user's existing spreadsheet.

Make sense? Better approaches?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T02:52:03.943

jXLS is maybe an option. You define an XLS file as a template and then you merge your data.

Quick overview [here](http://www.rgagnon.com/javadetails/java-0516.html)

[http://jxls.sourceforge.net/](http://jxls.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T23:08:58.637

WinHttpRequest ([http://msdn.microsoft.com/en-us/library/aa384045(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa384045(VS.85).aspx)) may suit, you can use the document and so forth. Here is a snippet from the link.

```
Dim HttpReq As Object

' Create the WinHTTPRequest ActiveX Object.'
Set HttpReq = New WinHttpRequest

' Open an HTTP connection.'
HttpReq.Open "GET", "http://microsoft.com", False

' Send the HTTP Request.'
HttpReq.Send

' Get all response text.'
Text1.Text = HttpReq.ResponseText 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T22:21:24.037

You might want to look into a third party library called [Aspose.Cells](http://www.aspose.com/categories/file-format-components/aspose.cells-for-.net-and-java/default.aspx). It is available for Java and .Net and allows very granular control of Excel documents. The great thing about this library is that it does not use automation (which could be disasterous in a multi-threaded environment like the web).

I have not personally used Apose.Cells, but I have used Aspose.Words (for .Net) to create mail merged Word documents that contained several thousand records and images, and it worked flawlessly.

# c# - 如何在用户控件中挂钩 TAB 键，以便焦点不会移动到其他控件？

> ID：376229
> 
> 赞同：1
> 
> 时间：2008-12-17T22:13:45.003
> 
> 标签：c#, .net, user-controls

我有一个用于占用整个表单的用户控件。我希望我的用户控件能够处理 TAB 按键并执行某些操作，而不是让 TAB 将焦点移动到表单上的另一个控件。我正在处理我的用户控件中的 KeyDown 事件，但是按下 TAB 键时它不会触发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T22:22:03.190

```
 protected override bool ProcessDialogKey(Keys keyData)
        {
            if (keyData != Keys.Tab)
            {
              return base.ProcessDialogKey(keyData);
            }
            return false;
        } 
```

# .net - 前向声明问题

> ID：376232
> 
> 赞同：1
> 
> 时间：2008-12-17T22:14:23.533
> 
> 标签：.net, c++, forward-declaration

我正在使用 C++ .NET 2.0

我有 2 个表格

第一个声明如下

```
#include "stdafx.h"
    namespace myNamespace{

      public ref class frmMain : public System::Windows::Forms::Form {
      /*... snip ...*/
      public void addNewRow(String^ text){ /*... snip... */  }
      public void launchSubForm() { SubForm^ sf = gcnew SubForm(this); sf->Show(); }

      };
    } 
```

第二个是这样的

```
#include stdafx.h
    namespace myNamespace{
      ref class frmMain;
      public ref class SubForm : public System::Windows::Forms::Form {
      frmMain^ myMain;
      SubForm ( frmMain^ pMain){
        myMain = pMain;
      }
      /*... snip ...*/
      public void exportRows(String^ text){ /*... snip... */  }
        myMain->addNewRow("myNewText");   <--- This line causes compile error
      };
    } 
```

在 stdafx.hi 中有

```
/*... snip... */
#include "SubForm.h"
#include "frmMain.h" 
```

现在问题来了！SubForm 中的行导致编译器告诉我“使用未定义类型 myNamespace::frmMain

我真的不知道为什么“ref class frmMain”不能解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T22:31:06.607

这是因为*这两*个头文件都包含“stdafx.h”，而stdafx.h在“frmMain.h”*之前*包含“SubForm.h ”。

因此，在“SubForm.h”中，编译器希望在定义 frmMain 之前定义 SubForm，从而导致错误。

解决此问题的正确方法是将类的所有代码保留在适当的源文件中，而*不是*在头文件中。如果您的头文件只是声明：

```
public void exportRows(String^ text);
```

那么你可以定义：

```
public void SubForm::exportRows(String^ text)
{
    /*... snip ...*/
    myMain->addNewRow("myNewText");
}
```

在 SubForm.cpp 中，一切都应该很顺利。

* * *

**编辑：**良好的面向对象设计涉及将接口与实现分离，而在 C++ 中实现这一点的最佳方法是将接口保存在头文件中，并将实现代码保存在相应的源文件中。

底线是你的头文件应该只包含*声明*。将这些视为您的类的接口。头文件仅显示您的类将实现的函数签名。另一方面，源文件包含所有*定义*，它们是您的类的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T22:53:13.067

在 C++ 中，如果您没有在指针上调用方法或对该类的引用，则只能前向声明一个类。任何时候尝试调用类指针或引用的方法时，都需要有可用的类定义。

删除不完整的类型是合法的，但非常危险。

请使用与 C++ 不同的标签，因为这不是 C++。

# .net - XmlSerializer 和 System.Drawing.Color 的最佳解决方案

> ID：376234
> 
> 赞同：20
> 
> 时间：2008-12-17T22:15:34.577
> 
> 标签：.net, xml-serialization

System.Drawing.Color 对象显然不会使用 XmlSerializer 进行序列化。xml序列化颜色的最佳方法是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-17T22:21:50.447

最简单的方法使用它的核心：

```
String HtmlColor = System.Drawing.ColorTranslator.ToHtml(MyColorInstance); 
```

它只会将任何颜色转换为 HTML 使用的标准十六进制字符串，使用以下命令可以轻松反序列化：

```
Color MyColor = System.Drawing.ColorTranslator.FromHtml(MyColorString); 
```

这样你就可以使用沼泽标准字符串......

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-18T00:32:14.303

最终工作版本：

```
Color clrGrid = Color.FromArgb(0, 0, 0);
[XmlIgnore]
public Color ClrGrid 
{
    get { return clrGrid; }
    set { clrGrid = value; }
}
[XmlElement("ClrGrid")]
public string ClrGridHtml
{
    get { return ColorTranslator.ToHtml(clrGrid); }
    set { ClrGrid = ColorTranslator.FromHtml(value); }
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-07-08T15:05:23.727

我们使用这个：

```
[Serializable]
public struct ColorEx
{
    private Color m_color;

    public ColorEx(Color color)
    {
        m_color = color;
    }

    [XmlIgnore]
    public Color Color
    { get { return m_color; } set { m_color = value; } }

    [XmlAttribute]
    public string ColorHtml
    { 
        get { return ColorTranslator.ToHtml(this.Color); } 
        set { this.Color = ColorTranslator.FromHtml(value); } }

    public static implicit operator Color(ColorEx colorEx)
    {
        return colorEx.Color;
    }

    public static implicit operator ColorEx(Color color)
    {
        return new ColorEx(color);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T22:26:07.270

您可以为 Color 编写一个简单的包装类，将 ARGB 值作为属性公开。您可以使用 from/to ARGB 转换转换为颜色或从颜色转换（请参阅[文档](http://msdn.microsoft.com/en-us/library/system.drawing.color_members.aspx)）。就像是：

```
[Serializable] 
public class ColorWrapper
{
   private Color color;

   public ColorWrapper (Color color)
   {  
      this.color = color;
   }

   public ColorWrapper()
   {
    // default constructor for serialization
   }

   public int Argb
   { 
       get
       {
           return color.ToARGB(); 
       }
       set 
       {
           color = Color.FromARGB();
       }
   }
} 
```

可能也想要一个颜色的访问器！

这样做的好处是，该类可以在您必须序列化颜色的所有地方使用。如果您想让 XML 可读（而不是任意 ARGB 整数），您可以使用 balabaster 描述的 to/from HTML 方法。

# performance - 数据库和 EF 性能问题？

> ID：376236
> 
> 赞同：0
> 
> 时间：2008-12-17T22:16:58.880
> 
> 标签：performance, entity-framework, database-design, select

我有一个基本的 sql 选择问题，多年来人们给了我不同的答案。假设我有几个表，每个表都设计有超过 40 列，并且可能会容纳十万行，我使用的是 SqlServer2005。

在加入这些表时，在 where 子句中，如果我有类似的东西

```
select * from t1, t2
where t1.UserID = 5 
and t1.SomeID = t2.SomeOtherID 
```

有人说你应该总是在前面设置常量“t1.UserID = 5”而不是在“t1.SomeID = t2.SomeOtherID”之后，这样可以提高选择性能。虽然其他人说没关系。

正确答案是什么？

另外，如果我使用 ADO.NET Entity Framework 来实现我的 DAL，那么对具有 40 多个列的表进行建模并执行 CRUD 操作是否会成为性能问题？

谢谢，

射线。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T22:46:00.100

一般来说，对于数据库优化，您应该首先编写概念上正确的 SQL，然后在分析表明有必要时调整性能。在进行内部联接时，最好使用 SQL-92，显式 INNER JOIN，而不是笛卡尔积。因此，我将从编写您的 SQL 开始，如下所示：

```
SELECT * 
FROM t1
  INNER JOIN t2
    ON t1.SomeID = t2.SomeOtherID
WHERE
  t1.UserID = 5 
```

INNER JOIN 的 ON 部分中的 t1.SomeID = t2.SomeOtherID，因为它表达了两个表之间的关系。进入 WHERE 子句的用户 ID，因为它是限制结果集的过滤器。以这种方式编写 SQL 可为数据库优化器提供更多信息，因为它表达了您对连接与过滤的意图。

现在，如果您在真实世界的数据库中使用此语法无法获得可接受的性能，那么请随意尝试移动位。但就像我说的，从概念上正确的东西开始。

关于您问题的第二部分，最明显的性能暗示是，当您选择实体集合时，实体框架需要恢复它正在实现的实体的所有属性。因此，如果您有 40 列，那么您将通过网络将这些数据拉回，如果您将它们具体化为实体。但是，可以编写返回只包含您需要的列的匿名类型的 LINQ 查询。但是，要执行完整的 CRUD，您将需要返回实体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T17:30:49.223

人们对此的看法会随着时间而改变，因为 RDBMS 查询优化随着时间的推移而发展，不同的 RDBMS 会有不同的方法。我不能代表所有系统，但在 2008 年这真的不太可能产生任何影响。如果您只对特定系统感兴趣，请使用 YMMV。

我可以告诉你，对于任何最新版本的 Oracle，它都没有区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T22:47:53.747

我知道这个答案有点陈词滥调，但我建议编写基准。开发一个控制台应用程序并自己进行测试。运行查询几百次，看看每种方式需要多长时间。

关于 SQL 查询性能和优化，有很多迷信。有些人做事认为它更快，但他们实际上并没有检查他们的事实。此外，EF 或 LinqToSql 工作和与数据库交互的方式可能会引入 SQL 中不明显的性能差异。

如果您正在优化代码，您可能还想使用像 RedGate ANTS 这样的分析器。它不是免费的，但它可以帮助您找到代码中的瓶颈。然后你可以在你的代码中找到更容易优化的地方。降低应用程序速度的并不总是您的数据库。或者有时你正在执行一个快速查询，但是当你实际上可以缓存结果时却做了很多次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T15:25:58.713

Firstly, construct the query using an explicit JOIN syntax, rather than the cartesian product. It probably won't make any difference performance-wise for any modern optimiser, but it does make the information on how the JOINs work more accessible for the programmers.

```
 SELECT Player.Name, Game.Date
 FROM Player
  INNER JOIN Game ON Game.WinnerPlayerID = Player.PlayerID
 WHERE Game.WinnerFrags > Game.TotalFrags/2
 ORDER BY Player.Name 
```

Which will give us all the players sorted by name who have take more frags in a game than all the other players in the game put together, and the dates of the games. Putting both the conditions are in the JOIN probably won't affect performance either, since the optimiser is likely do the filtering as part of the JOIN anyway. It does start to matter for LEFT JOINs though. Lets say we're looking for how many games the week's top ten players have ever won by the margin described above. Since it is possible that some of them have never one this spectacularly, we'll need LEFT JOIN.

```
 SELECT Player.WeekRank, Player.Name, COUNT(Game.*) AS WhitewashCount
 FROM Player
  LEFT JOIN Game ON Game.WinnerPlayerID = Player.PlayerID
 WHERE Player.WeekRank >= 10
  AND Game.WinnerFrags > Game.TotalFrags/2
 GROUP BY Player.WeekRank, Player.Name
 ORDER BY Player.WeekRank 
```

Well, not quite. The JOIN will return records for each game played by a player, or the player data and NULL game data if the player has played no games. These results will get filtered, during or after the JOIN depending on the optimiser's decision, based on the frag criteria. This will eliminate all the records that don't meet the frag criteria. So there will be no records to group for players who have never had such a spectacular win. Effectively creating an INNER JOIN .... FAIL.

```
 SELECT Player.WeekRank, Player.Name, COUNT(Game.*) AS WhitewashCount
 FROM Player
  LEFT JOIN Game ON Game.WinnerPlayerID = Player.PlayerID
   AND Game.WinnerFrags > Game.TotalFrags/2
 WHERE Player.WeekRank >= 10
 GROUP BY Player.WeekRank, Player.Name
 ORDER BY Player.WeekRank 
```

Once we move the frag criteria into the JOIN the query will behave correctly, returning records for all players in the week's top ten, irrespective of whether they've achieved a whitewash.

After all of that, the short answer is:

For INNER JOIN situations it probably doesn't make a to performance difference where you put the conditions. The queries are more readable if you separate the the join and filtering conditions though. And getting a condition in the wrong place can seriously mess up the results of a LEFT JOIN.

# html - 打印重复背景的任何解决方法？

> ID：376237
> 
> 赞同：1
> 
> 时间：2008-12-17T22:17:36.163
> 
> 标签：html, css

我们有一个 HTML 页面，它使用 div 和重复背景显示一堆漂亮的条形图。我们正在制作一份可以很好打印的报告，但这可能需要一些时间，因为我们没有适当的报告框架。作为一个临时解决方案，我们想让 HTML 版本可打印。div 的背景是唯一的问题，由于默认设置（由于工作站被锁定而无法启用），它们不会打印。

我[找到了一种](http://www.web-graphics.com/mtarchive/001703.php)打印背景图像的解决方法，但是当需要重复背景时这不起作用。

是否有任何其他解决方法可以提供帮助？我也一直在尝试在潜水中插入图像并拉伸它，但这会抛弃所有其他相对位置，并且证明很难修复。不过，我仍在调查此事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-17T22:22:37.590

如果您可以教育您的用户，在 IE 和 Firefox 的打印对话框中有一个选项，标签为“包含背景图像”或“打印背景图像”

这将包括重复的背景图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T22:34:22.730

我在绝对需要控制打印机输出的情况下使用[了这个](http://www.meadroid.com/scriptx/clientside.asp)ActiveX 组件（想想打印贴纸等）。

你想要的功能是：[printBackground](http://www.meadroid.com/scriptx/docs/printdoc.asp#printBackground)

然而，这并没有附带他们的免费许可证，但也许该许可证的成本超过了其他工作的实施时间。

缺点：仅限IE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T22:36:00.060

我无法加载链接，我可能没有正确理解问题，但是...

这与其说是一种解决方案，不如说是一种变通方法，但是您能否制作一个看起来只是重复的图像？或者至少是重复的（对于可变的浏览器和屏幕尺寸），但足够大以“适合”打印（这是一个更标准的尺寸）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T22:55:44.700

我能想到的最简单的方法是使用不同的打印样式表，使用适合打印在纸上的容器的标准化图像。

显示样式表将继续使用重复的图像，这不会影响性能，因为打印样式表中加载的完整图像仅在页面发送到打印机时才会加载。

...至少，这就是 HTML 规范所说的*应该*发生的事情。这是否真的是这样，我不能百分百确定。

# c# - 为什么全局声明的 DataTable 不保留其价值？

> ID：376239
> 
> 赞同：1
> 
> 时间：2008-12-17T22:17:50.720
> 
> 标签：c#, asp.net, gridview, datatable

我有一个带有gridview 的aspx 页面。在我的页面加载事件中，我加载了一个包含所有数据的数据表，如下所示：

```
HistoricalPricing historicalPricing = new HistoricalPricing();
DataTable dtHistoricalPricing = new DataTable();

protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            dtHistoricalPricing = historicalPricing.GetAuctionData();
        }
    } 
```

以上将数据加载到数据表中。我还有一个包含拍卖列表的列表框。当我点击拍卖时，我使用 DataView 上的 RowFilter 来显示一个带有所选数据的 Gridview，但 DataTable 似乎失去了它的价值，我不知道为什么。下面是代码：

```
protected void lstAuctions_SelectedIndexChanged(object sender, EventArgs e)
    {
        DataView dvPricing = new DataView(dtHistoricalPricing); // Loses Value
        dvPricing.RowFilter = "Auction = 1"; //Hard-Coded for Test
        gvPricing.DataSource = dvPricing.ToTable();
        gvPricing.DataBind();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T22:35:58.110

每次进行回发时，您都在处理页面类的新实例。这也意味着一个新的数据表对象。

如果您*真的*想在回发之间保留它（并确保您考虑到可能有 1000 人同时访问此 Web 服务器时的内存影响），那么您可以将数据表放在 Session、ViewState 或其他位置持续状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T22:24:23.263

我想我明白了，是不是因为当我单击 ListBox 时，它会进行回发，而我只在第一次加载页面时加载数据？如果这是正确的，我想我已经回答了我自己的问题。

在第一次加载页面加载后，我将数据表放入 Session 中，这似乎解决了我的问题。不确定这是否是最好的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T22:29:13.457

有点回答你自己的问题。您在每次页面加载时都创建一个对象的新实例，因此当列表框发布回发时，您的代码正在处理不同的对象。

您最好全局声明对象，然后在 !Postback 代码中实例化它，例如：

```
DataTable dtHistoricalPricing = null; 
```

...

```
if (!Page.IsPostBack)
{
   if (dtHistoricalPosting == null)
   {
       //shouldn't need to do a new dtHistoricalPricing as the method below is returning a new instance?
       dtHistoricalPricing = historicalPricing.GetAuctionData();
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T22:40:16.540

在 ASP.NET 中的请求之间保持值是很困难的。最可靠的方法是将它放在 ViewState 中，但这会将整个内容发送到客户端并返回，因此您不应该在那里放置太多数据。会话是一种替代方法，但是当用户在同一个会话中打开带有您的页面的多个窗口时，它可能会成为问题。然后还有应用程序状态和缓存，但它们在所有请求之间共享（无论用户是否）。另外，如果您有一个网络场，则其中的值对于每台服务器都是本地的。更重要的是，IIS 也可以在同一台机器上生成多个 ASP.NET 进程，并且它们每个都有自己的应用程序状态。静态变量也是如此。

# django - 每个具有“博客角色”的 Django 用户都有一个博客

> ID：376242
> 
> 赞同：0
> 
> 时间：2008-12-17T22:18:34.697
> 
> 标签：django, user-controls, blogs, restriction

在 Django 中将内容类型限制为用户的最佳方法是什么？

假设我希望所有具有用户角色“blogger”的用户都拥有自己的博客。

我创建了一个博客应用程序。如何限制它以使登录的用户只能在他的“自己的”博客中发帖，以及如何制作仅显示用户博客的视图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T02:34:14.930

首先，您的博客条目必须附加到用户，这样您就知道在谁的博客上显示，对吧？模型.py：

```
class BlogEntry(models.Model):
    user = models.ForeignKey(User, related_name='blog_entries')
    other_field_1 = ...
    other_field_2 = ... 
```

接下来，在ModelForm，forms.py中跳过它：

```
class BlogEntryModelForm(forms.ModelForm):
    class Meta:
        exclude = ('user',) 
```

然后，当用户想要发布条目时，您需要他已登录，views.py：

```
@login_required
def post_blog_entry(request):
    ....
    if request.method == 'POST':
       form = BlogEntryModelForm(request.POST)
       if form.is_valid():
          new_entry = form.save(commit=False)
          new_entry.user = request.user
          new_entry.save() 
```

当你想显示一些用户博客时，views.py：

```
def view_blog(request, blogger_name):
    user = get_object_or_404(User, username=blogger_name)
    entries = user.blog_entries.all() 
```

用户是 django.contrib.auth.models.User 如果用户无权创建博客，您可以在上面的视图中添加自定义角色检查以显示 404 页面或错误页面。

或者，您可以将 django.contrib.auth 中的 User 替换为您自己的 User 实现，但您还必须为其编写模型、身份验证和中间件......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-18T11:50:42.153

我没有尝试实现这一点，但我发现了另一个非常有效的灵魂。它很容易实现并且做了我想要的一切。

[看看这个...](http://www.djangosnippets.org/snippets/1054/)

# css - CSS 选择器样式

> ID：376248
> 
> 赞同：2
> 
> 时间：2008-12-17T22:19:53.600
> 
> 标签：css, css-selectors

简单的问题，可能反映了我对 CSS 的缺乏经验，但是......

创建样式表时，我喜欢明确指定“*”通配符，因此：

```
*.TitleText { 
```

而不仅仅是

```
.TitleText { 
```

我发现它提醒我 TitleText 应用于“任何”标签，并且可以被后续的 h1.TitleText 覆盖。也许我只是喜欢这个，因为很长一段时间以来我都没有正确理解整个 CSS 选择器的概念，当我意识到第二个（上图）只是第一个的简写时，很多东西都“点击”了。

我做的事情是不好的做法，好的做法，还是既不在这里也不在那里？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-17T22:23:22.707

我不知道它是好是坏，但几年来我一直在做 CSS 工作作为 Web 应用程序开发的一部分，而且我*从未*见过有人使用 * 字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-02-23T20:59:17.603

虽然两者在风格结果方面是相同的，但还有一些其他因素需要牢记。

# 使用`*`会增加文件大小

如果您不使用删除不需要的星号的 CSS 缩小器（去除不需要的数据，例如额外的空格），`*`则每次未指定标记时使用会导致文件中出现大量额外字符，这将导致加载时间更长（和更多的带宽使用）。虽然我不会浏览一个大文件并删除已经存在的星号（除非您真的有时间这样做并且喜欢可能导致您多年不会发现的错误的繁琐任务），但我建议不要包括不需要的星号在编写新样式并在编辑旧样式时删除不需要的星号时。

# 使用`*`会导致混乱

在不需要时使用`*`可能会导致混乱，尤其是当新人正在从事该项目并且没有处理在`*`不需要时出现时（这很常见）。

## 例子

```
/** 
 * This matches an element with the class `alert` within
 * any element within an `article` element
 */
article * .alert { /* ... */ } 
```

***对比***

```
/** 
 * This matches an element with the class `alert` within
 * an `article` element
 */
article *.alert { /* ... */ } 
```

如果项目中存在 100% 的一致性（并且所有参与项目的人员都知道该风格），那么第一个示例将永远不会发生（`article * *.alert`取而代之的是）。然而，这是一个理想的情况，并且很可能会在几代开发人员之后分崩离析（人们喜欢使用自己的风格）。因此，即使您有一致的风格，新员工也可能会进来并在短时间内以自己的风格编写，或者错误地阅读当前风格并生成与选择器不匹配的代码（反之亦然）。因此，我建议坚持我在项目和网站中看到最多（阅读：*独家）的标准：*

*如果不需要，请勿使用**星**号*。

快速浏览一些知名网站（例如 Facebook、Google、Yahoo 等）的来源会发现，除非必须（即使是非缩小样式），否则它们不会使用星号。[您还可以查看GitHub 上](http://www.github.com/)的一些开源项目。

# 结论

只有在绝对需要时才应使用星号（例如，`body * p`匹配具有除正文以外的父级的段落）。这不仅是不成文的标准（并且不太可能引起混淆），而且还减小了样式表的文件大小，从而提高了网站的加载速度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T22:38:28.493

就个人而言，我倾向于只在将规则应用于所有标签时使用 *。它在 *.class{} 的情况下是多余的，但在 .class *{} 的情况下很有用。

我在几个地方读到了 * 选择器会影响性能，但没有得到验证。除非我需要，否则我不会使用它，因为我通常更喜欢更明确一点，但这只是个人喜好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T22:52:26.280

它既不好也不坏，但它（完全）是多余的。

编辑：实际上，我认为这很糟糕，因为它可能会令人困惑（对于人类，而不是解析器）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T23:06:14.993

根据[CSS](http://www.w3.org/TR/CSS21/selector.html#universal-selector)规范：

> 5.3 通用选择器
> 
> 通用选择器，写成“*”，匹配任何元素类型的名称。它匹配文档树中的任何单个元素。
> 
> 如果通用选择器不是简单选择器的唯一组件，则可以省略“*”。例如：
> 
> *   `*[lang=fr]`并且`[lang=fr]`是等价的。
> *   `*.warning`并且`.warning`是等价的。
> *   `*#myid`并且`#myid`是等价的。

因此，.TitleText 和 *.TitleText 是等价的。任何实现都不太可能考虑 *.xxx 的性能，而 .xxx 则没有。

这归结为一个风格问题。而且由于其他答案提出的风格考虑似乎在很大程度上没有实际意义，我相信我会继续并继续明确指定 *.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T22:26:14.587

我认为这并不重要，但我在学习时看到的示例都没有使用这种通配符格式，所以我学会了不用星号。

此外，生成 CSS 的工具都不是这样做的，因此，如果您选择将 CSS 放入此类工具中，则使用星号可能会导致自动化工具清除您的格式。

只是为了与大多数其他 Web 开发人员保持一致，我可能会建议取消星号，这样您就不必与其他开发人员打交道，询问您为什么在此处放置星号。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T22:37:01.633

我认为 * 是隐含的，所以他们做同样的事情。

我不确定，但如果你这样做可能会导致一些问题：

```
span.style { color: red; }
*.style { color: blue; } 
```

* 样式可能会覆盖跨度样式。我可能是错的，因为 span.style 是一个更具体的选择器。

我觉得你这样做很有趣，尽管我完全明白为什么！您在 CSS 中使用 DOS 提示符/shell 语法。最后，您可能会以这种方式进一步思考它而感到困惑，因为在 Shell 中您正在查看文件扩展名，但在 CSS 中它实际上映射到一个类。

所以我的意思是，它适用于类选择器，但对于 ID 选择器来说有点失败。例如：

```
span#id { ... }
*#id { ... } 
```

...而且它不再像 Shell 语法。:) 就我个人而言，我不会像你那样做，因为它可能会让人困惑，但我认为你不会破坏任何东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-17T22:46:18.900

这将是多余的，假设 * 表示“世界上所有可能的事情”，没有 * 也意味着相同。我通常使用 *{margin:0; undo.css 中的 padding:0} 重置边距和填充，但从不作为伪选择器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-17T22:47:53.763

我从未见过有人像这样使用通配符，我怀疑它会被优先选择而不是仅仅指定类。其他修改样式的人可能会被迫继续使用该语法。那就是如果他们弄清楚为什么他们的课程不工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-17T22:54:41.613

*.class 将覆盖 span.class 即使 span.class 更重要。

我认为 *.class 没有实际用途，应该使用 !important 语句进行覆盖，并且只进行少量覆盖。

我使用 * 的唯一原因是删除所有填充和边距，实际上我总是这样做，这是我写下的第一个 css 语句:)。

还有相当多的基于“* html”的 css hack 在 IE6 及更低版本中不起作用。

我会将其标记为不良做法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-17T22:59:45.847

就 CSS 规范而言，您的两个示例具有相同的含义。但是，在实践中存在潜在的问题。我所看到的最大的问题是，某些浏览器可能会`*`在规则权重方面进行不当处理，因此可能会放弃优先级（尽管我不知道有任何浏览器会这样做——它只是不会让我吃惊）。它也被广泛认为，虽然我不能对你引用章节和诗句，但出于性能原因，类选择器应该始终包含特定的标签名称。应用带有标签名称 ( `span.foo`) 的类选择器显然比没有标签名称 ( ) 更快，并且应用不带标签名称 ( `#bar`) 的 ID 选择器比带有标签名称更快。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-12-17T23:07:08.780

编辑：这是指出很可能存在性能问题。有些人似乎认为我是某种在外面咆哮的人......

* * *

虽然我不确定，但我想警告一下！考虑以下标识符：

```
div#foo a.bar {} 
```

例如，我听说使用 css 的 jQuery 在上面的示例中会首先遍历 DOM 寻找 div，然后检查它们是否有 #foo 的 id，然后是 A 标记，最后查看它是否被归类为 .bar .

我对 * 的担心是浏览器可能会遍历 DOM 寻找所有标签，然后寻找 .bar，而不是本质上只是寻找 'bar' 的属性——这是对 DOM 的两次扫描，而不仅仅是一次。可能是一个非常小的差异，但如果你的语法在电波中出现，那就是我们需要安装更多的太阳能电池板。

# html - 拉伸和缩放 CSS 背景

> ID：376253
> 
> 赞同：672
> 
> 时间：2008-12-17T22:21:25.500
> 
> 标签：html, css

有没有办法让 CSS 中的背景拉伸或缩放以填充其容器？

* * *

## 回答 #1

> 赞同：574
> 
> 时间：2012-01-26T11:02:13.400

使用[CSS 3](http://en.wikipedia.org/wiki/Cascading_Style_Sheets#CSS_3)属性`background-size`：

```
#my_container {
    background-size: 100% auto; /* width and height, can be %, px or whatever. */
} 
```

自 2012 年以来，这可用于现代浏览器。

* * *

## 回答 #2

> 赞同：287
> 
> 时间：2010-12-21T02:11:29.783

对于现代浏览器，您可以使用以下方法完成此操作[`background-size`](https://developer.mozilla.org/en-US/docs/Web/CSS/background-size)：

```
body {
    background-image: url(bg.jpg);
    background-size: cover;
} 
```

`cover`意味着垂直或水平拉伸图像，使其永远不会平铺/重复。

这适用于 Safari 3（或更高版本）、Chrome、[Opera](http://en.wikipedia.org/wiki/Opera_%28web_browser%29) 10+、Firefox 3.6+ 和 Internet Explorer 9（或更高版本）。

要使其与较低版本的 Internet Explorer 一起使用，请尝试以下 CSS：

```
filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='.myBackground.jpg', sizingMethod='scale');
-ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='myBackground.jpg', sizingMethod='scale')"; 
```

* * *

## 回答 #3

> 赞同：175
> 
> 时间：2008-12-23T13:01:53.330

使用 CSS 缩放图像不太可能，但可以通过以下方式实现类似的效果。

使用此标记：

```
<div id="background">
    <img src="img.jpg" class="stretch" alt="" />
</div> 
```

使用以下 CSS：

```
#background {
    width: 100%; 
    height: 100%; 
    position: absolute; 
    left: 0px; 
    top: 0px; 
    z-index: 0;
}

.stretch {
    width:100%;
    height:100%;
} 
```

你应该完成了！

为了将图像缩放为“全出血”并保持纵横比，您可以这样做：

```
.stretch { min-width:100%; min-height:100%; width:auto; height:auto; } 
```

效果很好！但是，如果裁剪了一个维度，它将仅在图像的一侧裁剪，而不是在两侧（并居中）均匀裁剪。我已经在 Firefox、[Webkit](http://en.wikipedia.org/wiki/WebKit)和 Internet Explorer 8 中对其进行了测试。

* * *

## 回答 #4

> 赞同：161
> 
> 时间：2010-07-29T10:55:46.860

使用 CSS3 中的[background-size 属性：](http://www.w3.org/TR/2002/WD-css3-background-20020802/#background-size0)

```
.class {
     background-image: url(bg.gif);
     background-size: 100%;
} 
```

**编辑：** [Modernizr](http://www.modernizr.com/)支持[检测 background-size support](http://www.modernizr.com/docs/#features-css)。您可以使用编写的 JavaScript 变通方法，但您需要它并在没有支持时动态加载它。这将使代码保持可维护性，而无需对某些浏览器使用侵入性的 CSS hack。

就我个人而言，我使用一个脚本来使用 jQuery 来处理它，它是[imgsizer](http://unstoppablerobotninja.com/entry/fluid-images)的改编版。由于我现在所做的大多数设计都使用宽度 % 来实现跨设备的流畅布局，因此对其中一个循环有轻微的适应（考虑到并不总是 100% 的尺寸）：

```
for (var i = 0; i < images.length; i++) {
    var image = images[i],
        width = String(image.currentStyle.width);

    if (width.indexOf('%') == -1) {
        continue;
    }

    image.origWidth = image.offsetWidth;
    image.origHeight = image.offsetHeight;

    imgCache.push(image);
    c.ieAlpha(image);
    image.style.width = width;
} 
```

**编辑：** 您可能也对[jQuery CSS3 Finaliz[s]e](https://github.com/codler/jQuery-Css3-Finalize)感兴趣。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2010-11-02T11:25:48.073

试试文章*[background-size](https://developer.mozilla.org/en/CSS/background-size)*。如果您使用以下所有内容，它将在除 Internet Explorer 之外的大多数浏览器中运行。

```
.foo {
    background-image: url(bg-image.png);
    -moz-background-size: 100% 100%;
    -o-background-size: 100% 100%;
    -webkit-background-size: 100% 100%; 
    background-size: 100% 100%;
} 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2008-12-17T22:27:16.753

不是现在。它将在[CSS 3](http://www.w3.org/TR/2002/WD-css3-background-20020802/#background-size)中可用，但在大多数浏览器中实现它需要一些时间。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2014-05-13T15:06:22.863

```
.style1 {
        background: url(images/bg.jpg) no-repeat center center fixed;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
} 
```

工作于：

*   野生动物园 3+
*   铬随便+
*   浏览器 9+
*   Opera 10+（Opera 9.5 支持 background-size 但不支持关键字）
*   Firefox 3.6+（Firefox 4 支持非厂商前缀版本）

另外你可以试试这个 ie 解决方案

```
 filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='.myBackground.jpg', sizingMethod='scale');
    -ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='myBackground.jpg', sizingMethod='scale')";
    zoom:1; 
```

感谢 Chris Coyier 的这篇文章 [http://css-tricks.com/perfect-full-page-background-image/](http://css-tricks.com/perfect-full-page-background-image/)

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-12-17T22:25:47.973

~~一句话：没有。拉伸图像的唯一方法是使用`<img>`标签。你必须要有创造力。~~

在 2008 年写下答案时，这曾经是正确的。今天的现代浏览器支持`background-size`解决了这个问题。请注意 IE8 不支持它。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-12-17T22:28:52.053

定义“拉伸和缩放”...

如果您有位图格式，通常（从图形上讲）拉伸它并拉动它并不好。您可以使用可重复的模式来产生相同效果的错觉。例如，如果您有一个向页面底部变浅的渐变，那么您将使用一个像素宽且与容器高度相同的图形（或者最好更大以考虑缩放），然后将其平铺在页。同样，如果渐变穿过页面，它将比您的容器高 1 个像素且比您的容器宽，并沿页面向下重复。

通常，为了在容器增大或缩小时产生拉伸以填充容器的错觉，您可以使图像大于容器。任何重叠都不会显示在容器边界之外。

如果您想要一种依赖于带有弯曲边缘的盒子之类的效果，那么您会将盒子的左侧粘贴到容器的左侧，并有足够的重叠（在合理范围内），无论容器有多大，它都不会用完背景，然后您将带有弯曲边缘的盒子右侧的图像分层并将其放置在容器的右侧。因此，当容器缩小或增长时，弯曲的盒子效应似乎会随之缩小或增长——事实上并没有，但它给人一种正在发生的错觉。

至于真正使图像随容器缩小和增长，您需要使用一些分层技巧使图像看起来充当背景，并使用一些 javascript 来随容器调整其大小。目前没有使用 CSS 执行此操作的方法...

如果您使用矢量图形，恐怕您超出了我的专业领域。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-11-17T19:59:03.183

这就是我所做的。在拉伸课程中，我只是将高度更改为`auto`. 这样，您的背景图片始终具有与屏幕宽度相同的大小，并且高度始终具有正确的大小。

```
#background {
    width: 100%;
    height: 100%;
    position: absolute;
    margin-left: 0px;
    margin-top: 0px;
    z-index: 0;
}

.stretch {
    width:100%;
    height:auto;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-05-13T12:52:47.267

添加`background-attachment`一行：

```
#background {
    background-attachment:fixed;
    width: 100%; 
    height: 100%; 
    position: absolute; 
    margin-left: 0px; 
    margin-top: 0px; 
    z-index: 0;
}

.stretch {
    width:100%;
    height:auto;
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-12-10T17:51:56.900

我想指出，这相当于做：

```
html { width: 100%; height: 100%; }
body { width: 100%; height: 100%; /* Add background image or gradient to stretch here. */} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-11-01T17:32:35.343

另一个很好的解决方案是 Srobbin 的 Backstretch，它可以应用于页面上的正文或任何元素 - [http://srobbin.com/jquery-plugins/backstretch/](http://srobbin.com/jquery-plugins/backstretch/)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-03-09T14:58:46.133

试试这个

**[http://jsfiddle.net/5LZ55/4/](http://jsfiddle.net/5LZ55/4/)**

```
body
{ 
    background: url(http://p1.pichost.me/i/40/1639647.jpg) no-repeat fixed; 
    background-size: cover;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-09-11T00:22:17.667

SolidSmile 作弊的另一个技巧是通过设置宽度并使用 auto 作为高度来缩放（按比例调整大小）。

前任：

```
#background {
    width: 500px;
    height: auto;
    position: absolute; 
    left: 0px; 
    top: 0px; 
    z-index: 0;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-07-02T13:57:28.497

使用该**`border-image : yourimage`**属性设置图像并将其缩放到屏幕或窗口的整个边框。

# c# - 您可以在 C# 中获取堆栈上的变量列表吗？

> ID：376256
> 
> 赞同：3
> 
> 时间：2008-12-17T22:22:05.377
> 
> 标签：c#, variables, stack, diagnostics

所有，只是想知道是否有可能在 .NET/C# 中获取堆栈上的变量列表及其值？我正在为我的应用程序创建一个异常处理程序，除了标准堆栈跟踪之外，我还希望查看堆栈上任何变量的名称和值。知道这是否可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T22:23:38.820

是的，StackFrame 类可以帮助您。

[连锁](http://msdn.microsoft.com/en-us/library/system.diagnostics.stackframe.aspx)

沿着这些思路

```
var currentStackFrame = new StackFrame(1);
var props = currentStackFrame.GetMethod().GetParameters(); 
```

# php - WHM：将帐户移动到新服务器

> ID：376265
> 
> 赞同：2
> 
> 时间：2008-12-17T22:23:59.257
> 
> 标签：php, cpanel, whm

我有一个 WHM 帐户，用于在专用服务器上大小超过 50GB 的 PHP Web 应用程序，公司决定将其移至新服务器，我被分配了任务。

我想知道最好的方法是什么，内置WHM**复制帐户**功能，或者创建完整备份并将其还原到新服务器？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-20T03:43:10.637

我假设这些 50GB 主要是数据，对吗？所以我会首先创建应用程序脚本的备份并将它们部署在新站点中，并确保一切运行顺利。然后我认为使用复制帐户功能没有问题，因为服务器之间的数据传输通常比您上传它要快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-03T17:05:51.900

据我记得，帐户复制功能只是将您的帐户文件夹和其中的所有内容压缩起来，因此您不妨使用此方法，因为它可能与您手动执行的操作相同。

请确保在移动后检查一切正常。有时最好限制对新站点的访问，直到您对其进行检查。

# c - 在 C 中调用函数之前的参数评估顺序

> ID：376278
> 
> 赞同：73
> 
> 时间：2008-12-17T22:27:19.920
> 
> 标签：c, parameters, evaluation

在 C 中调用函数参数时，是否可以假定函数参数的评估顺序？根据下面的程序，我执行时似乎没有特定的顺序。

```
#include <stdio.h>

int main()
{
   int a[] = {1, 2, 3};
   int * pa; 

   pa = &a[0];
   printf("a[0] = %d\ta[1] = %d\ta[2] = %d\n",*(pa), *(pa++),*(++pa));
   /* Result: a[0] = 3  a[1] = 2    a[2] = 2 */

   pa = &a[0];
   printf("a[0] = %d\ta[1] = %d\ta[2] = %d\n",*(pa++),*(pa),*(++pa));
   /* Result: a[0] = 2  a[1] = 2     a[2] = 2 */

   pa = &a[0];
   printf("a[0] = %d\ta[1] = %d\ta[2] = %d\n",*(pa++),*(++pa), *(pa));
   /* a[0] = 2  a[1] = 2 a[2] = 1 */

} 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-12-17T22:31:20.083

不，函数参数不会按照 C 中定义的顺序进行评估。

请参阅 Martin York 对[C++ 程序员应该了解的所有常见未定义行为的回答？](https://stackoverflow.com/questions/367633/what-are-all-the-common-undefined-behaviour-that-c-programmer-should-know-about).

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-17T22:46:57.493

未指定函数参数的评估顺序，来自 C99 §6.5.2.2p10：

> 函数指示符、实际参数和实际参数中的子表达式的求值顺序未指定，但在实际调用之前有一个顺序点。

C89 中存在类似的措辞。

此外，您在`pa`不干预序列点的情况下进行多次修改，这会调用未定义的行为（逗号运算符引入了序列点，但分隔函数参数的逗号没有）。如果您在编译器上打开警告，它应该警告您：

```
$ gcc -Wall -W -ansi -pedantic test.c -o test
test.c: In function ‘main’:
test.c:9: warning: operation on ‘pa’ may be undefined
test.c:9: warning: operation on ‘pa’ may be undefined
test.c:13: warning: operation on ‘pa’ may be undefined
test.c:13: warning: operation on ‘pa’ may be undefined
test.c:17: warning: operation on ‘pa’ may be undefined
test.c:17: warning: operation on ‘pa’ may be undefined
test.c:20: warning: control reaches end of non-void function 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-06-15T12:36:28.180

只是补充一些经验。
以下代码：

```
int i=1;
printf("%d %d %d\n", i++, i++, i); 
```

结果是

`2 1 3`- 在 Linux.i686 上使用 g++ 4.2.1
`1 2 3`- 在 Linux.i686 上使用 SunStudio C++ 5.9
`2 1 3`- 在 SunOS.x86pc 上使用 g++ 4.2.1
`1 2 3`- 在 SunOS.x86pc 上使用 SunStudio C++ 5.9
`1 2 3`- 在 SunOS.sun4u 上使用 g++ 4.2.1
`1 2 3`- 使用SunOS.sun4u 上的 SunStudio C++ 5.9

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-08-15T03:04:24.883

> 在 C 中调用函数参数时，是否可以假定函数参数的评估顺序？

不，不能假设它是[未指定的行为](http://en.wikipedia.org/wiki/Unspecified_behavior)，[C99 标准草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)在段落`6.5`段落中`3`说：

> 运算符和操作数的分组由语法指示。74) 除稍后指定（对于函数调用 ()、&&、||、?: 和逗号运算符）外，**子表达式的求值顺序和中的顺序发生哪些副作用都未指定。**

它还说 except as specified as later and specific sites `function-call ()`，所以我们看到稍后在`6.5.2.2` *函数调用*段落中的标准草案中`10`说：

> **函数指示符、实际参数和实际参数中的子表达式的求值顺序是未指定的**，但在实际调用之前有一个序列点。

该程序还表现出[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)，因为您在[序列点](http://en.wikipedia.org/wiki/Sequence_point)`pa`之间进行了多次修改。从草案标准部分段落：`6.5``2`

> **在前一个和下一个序列点之间，对象的存储值最多只能**通过表达式的评估修改一次。此外，应仅读取先验值以确定要存储的值。

它引用了以下未定义的代码示例：

```
i = ++i + 1;
a[i++] = i; 
```

需要注意的是，尽管[逗号运算符](http://en.wikipedia.org/wiki/Comma_operator)确实引入了序列点，但函数调用中使用的逗号是分隔符而不是`comma operator`. 如果我们看一下`6.5.17` *逗号运算符*段落`2`说：

> 逗号运算符的左操作数被评估为 void 表达式；**在其评估之后有一个序列点。**

但段落`3`说：

> 示例 如语法所示，逗号运算符（如本小节所述）**不能出现在使用逗号分隔列表中的项目（例如函数的参数或初始化程序列表**）的上下文中。

`gcc`在不知道这一点的情况下，使用至少打开警告`-Wall`会提供类似于以下内容的消息：

```
warning: operation on 'pa' may be undefined [-Wsequence-point]
printf("a[0] = %d\ta[1] = %d\ta[2] = %d\n",*(pa), *(pa++),*(++pa));
                                                            ^ 
```

默认情况下`clang`会发出类似如下的警告信息：

```
warning: unsequenced modification and access to 'pa' [-Wunsequenced]
printf("a[0] = %d\ta[1] = %d\ta[2] = %d\n",*(pa), *(pa++),*(++pa));
                                            ~         ^ 
```

一般来说，了解如何以最有效的方式使用您的工具很重要，了解可用于警告的标志很重要，因为您可以[在此处](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)`gcc`找到该信息。一些有用的标志，从长远来看可以为你省去很多麻烦，并且对两者都是通用的。对于[理解 -fsanitize](http://clang.llvm.org/docs/UsersManual.html#controlling-code-generation)可能非常有帮助。例如，将在运行时捕获许多未定义行为的实例。`gcc``clang``-Wextra -Wconversion -pedantic``clang` `-fsanitize=undefined`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-28T08:53:58.240

正如其他人已经说过的，评估函数参数的顺序是未指定的，并且在评估它们之间没有顺序点。因为您`pa`在传递每个参数时随后进行了更改，所以您`pa`在两个序列点之间更改并读取了两次。这实际上是未定义的行为。我在 GCC 手册中找到了一个很好的解释，我认为这可能会有所帮助：

> C 和 C++ 标准定义了 C/C++ 程序中的表达式根据序列点计算的顺序，序列点表示程序部分执行之间的偏序：在序列点之前执行的部分和在序列点之后执行的部分它。这些发生在对完整表达式（不是更大表达式的一部分）的求值之后，在对 &&、||、? 的第一个操作数求值之后 : 或 ,（逗号）运算符，在调用函数之前（但在对其参数和表示被调用函数的表达式求值之后），以及在某些其他地方。除了由序列点规则表达的以外，没有指定表达式的子表达式的求值顺序。所有这些规则仅描述部分顺序而不是全顺序，因为例如，如果在一个表达式中调用两个函数且它们之间没有序列点，则不指定调用函数的顺序。然而，标准委员会已经裁定函数调用不重叠。
> 
> 未指定序列点之间对对象值的修改何时生效。行为依赖于此的程序具有未定义的行为；C 和 C++ 标准规定“在前一个和下一个序列点之间，对象的存储值最多只能通过表达式的评估修改一次。此外，应仅读取先验值以确定要存储的值。”。如果一个程序违反了这些规则，任何特定实现的结果都是完全不可预测的。
> 
> 具有未定义行为的代码示例有 a = a++;、a[n] = b[n++] 和 a[i++] = i;。此选项无法诊断一些更复杂的情况，并且可能偶尔会给出假阳性结果，但通常发现它在检测程序中的此类问题方面相当有效。
> 
> 该标准的措辞令人困惑，因此在微妙的情况下对序列点规则的确切含义存在一些争论。可以在 GCC 阅读页面[http://gcc.gnu.org/readings.html](http://gcc.gnu.org/readings.html)上找到该问题讨论的链接，包括建议的正式定义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-26T10:38:41.963

在表达式中多次修改变量是未定义的行为。所以你可能会在不同的编译器上得到不同的结果。所以避免多次修改一个变量。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-17T22:49:13.980

格兰特的答案是正确的，它是不确定的。

但，，，

通过您的示例，您的编译器似乎以从右到左的顺序进行评估（不出所料，参数被推入堆栈的顺序）。如果您可以进行其他测试以表明即使启用了优化也可以始终如一地维护顺序，并且如果您只坚持使用该编译器的一个版本，则可以安全地假设从右到左的顺序。

不过，这完全是不可移植的，而且是一件可怕的、可怕的事情。

# java - 等到tomcat完成启动

> ID：376279
> 
> 赞同：30
> 
> 时间：2008-12-17T22:27:48.623
> 
> 标签：java, linux, tomcat

我有一个脚本需要在 tomcat 完成启动并准备开始部署应用程序后运行。我正在使用`$TOMCAT_HOME/bin/startup.sh`which 立即返回。我怎样才能等到tomcat完成启动？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-12-17T22:37:46.123

可能有几种方法可以做到这一点。我们使用的技巧是：

```
#!/bin/bash

until [ "`curl --silent --show-error --connect-timeout 1 -I http://localhost:8080 | grep 'Coyote'`" != "" ];
do
  echo --- sleeping for 10 seconds
  sleep 10
done

echo Tomcat is ready! 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-01-03T11:34:59.400

以编程方式实施并不难。您可以实现 org.apache.catalina.LifecycleListener ，然后您将拥有

```
public void lifecycleEvent(LifecycleEvent lifecycleEvent) {
            if(lifecycleEvent.getType().equals(Lifecycle.START_EVENT))
            //do what you want
            }       
} 
```

在 web.xml 中：

```
<Context path="/examples" ...>
...
<Listener className="com.mycompany.mypackage.MyListener" ... >
...
</Context> 
```

请注意，在 6-9 个 Tomcat 之间，有些事情可能会有所不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-02T21:23:41.263

你还在寻找答案吗？这取决于您对开始的定义。如果您对启动的定义是“现在可以安全停止”，那么您可能需要验证端口 8005 是否正在侦听。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T22:31:02.020

取决于你完成的意思。你还想等什么？

例如，您可以有一个脚本反复访问一个 URL，直到它得到一个只有在应用程序正确初始化后才可用的理想结果。

你也可以有一个上下文监听器，它写出一个“我准备好了”文件，你可以用它来表示你的应用程序已经准备好了。（如果您这样做，请确保在启动您的应用容器之前该文件不存在）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-31T11:00:21.657

如果远程服务器的tomcat开始进行系统检查，我需要这个来测试jenkins。

`until [[ `ssh -o StrictHostKeyChecking=no root@${DEPLOY_HOST} 'netstat -tulpn | grep 8005'` != "" ]] ; do echo "waiting for tomcat"; sleep 6; done`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T22:32:42.407

没有简单的方法。就startup.sh和catalina.sh而言，tomcat完成后就在运行。尽管在内部，tomcat 仍在初始化和启动上下文。

知道您是否试图确定您的上下文是否已完成加载，或者您是否只是想要一个通用的“Tomcat 正在运行，尽管您的上下文可能没有完全加载......”，这将有所帮助。

如果是后者，您可以创建一个 Web 应用程序，该应用程序仅具有一个上下文侦听器，该侦听器将使用运行时执行脚本。如果您方便的话，您可以通过 web.xml 文件使 webapp 可配置，以接受指向要执行的脚本的参数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T22:41:01.127

就个人而言，我只会根据您的设置方式和您寻找的确切阶段来查看特定字符串的 catalinas 日志。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-01T12:07:05.957

我已经在 jenkins pipelinescript 和 tomcat 中使用以下代码完成了它。在我打电话之前

```
sudo /bin/systemctl restart tomcat 
```

并在我的 sudoers 文件中有一个 jenkins 用户的条目。

现在这里是oneliner：

```
until [ "$(curl -w '%{response_code}' --no-keepalive -o /dev/null --connect-timeout 1 -u USERNAME:PASSWORD http://localhost:8080/manager/text/list)" == "200" ]; do echo --- sleeping for 1 second; sleep 1; done 
```

更好的可读性：

```
until [ "$(curl -w '%{response_code}' --no-keepalive -o /dev/null --connect-timeout 1 -u USERNAME:PASSWORD http://localhost:8080/manager/text/list)" == "200" ];
do echo --- sleeping for 1 second;
sleep 1;
done 
```

# c++ - 从同一个项目构建 DLL 和静态库

> ID：376296
> 
> 赞同：27
> 
> 时间：2008-12-17T22:34:43.103
> 
> 标签：c++, winapi, visual-studio-2005, projects-and-solutions, vsprops

我有许多在 Visual Studio 2005 下编译的本机 C++ 库（Win32，没有 MFC），并在许多解决方案中使用。

我希望能够选择将它们编译和链接为静态库或 DLL，具体取决于我使用它们的特定解决方案的需要。

最好的方法是什么？我考虑过这些方法：

## 1.多个项目文件

*   示例：“foo_static.vcproj”与“foo_dll.vcproj”
*   优点：易于为新库生成，不需要太多手动 vcproj 修改。
*   缺点：两个地方的设置、文件列表等太容易不同步。

## 2.单个项目文件，多种配置

*   示例：“调试 | Win32”与“调试 DLL | Win32”等。
*   优点：文件列表更容易保持同步；编译选项更容易保持同步
*   缺点：我为 Win32 和智能设备目标构建，所以我已经有多种配置；我不想让我的组合爆炸变得更糟（“FooPhone 的静态库 | WinMobile 6”、“FooPhone 的动态库 | WinMobile 6”、“BarPda 的静态库 | WinMobile 6”等。
*   更糟糕的骗局：VS 2005 有一个坏习惯，即假设如果您为平台“Foo”定义了配置，那么您的解决方案中的所有其他平台确实需要它，并且随意插入所有配置/平台配置的排列受影响的 vcproj 文件，无论是否有效。（向 MS 提交的错误；作为 WONTFIX 关闭。）

## 3.单个项目文件，通过vsprops文件选择静态或动态

*   示例：将适当的 vcproj 片段存储在属性表文件中，然后在需要静态库时将“FooApp 静态库”属性表应用于配置/平台组合，并在需要 DLL 时应用“FooApp DLL”属性表。
*   优点：**这是我真正想做的！**
*   缺点：**这似乎不可能。** .vsprops 文件似乎无法覆盖在静态库和动态库之间切换的 .vcproj 属性（Configuration 元素的 ConfigurationType 属性）。Microsoft 为这些文件发布的架构仅列出 <Tool> 和 <UserMacro> 元素。

**编辑**：如果有人建议，我还尝试了#3 的更“聪明”版本，其中我定义了一个 .vsprops，其中包含一个名为“ModuleConfigurationType”的 UserMacro，其值为“2”（DLL）或“ 4"（静态库），并将 .vcproj 中的配置更改为具有`ConfigurationType="$(ModuleConfigurationType)"`. Visual Studio 无提示地删除该属性并将其替换为`ConfigurationType="1"`. 太有帮助了！

我错过了更好的解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-08T16:07:34.370

我可能遗漏了一些东西，但是为什么你不能定义没有文件的 DLL 项目，而只是让它链接另一个项目创建的 lib？而且，关于设置，您可以将它们分解到 vsprop 文件中......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-08-24T20:42:27.427

**有一种简单的方法可以在一个项目中同时创建静态库和 dll 库版本。**

创建您的 dll 项目。然后对其执行以下操作：

只需创建一个运行 lib 工具的 nmake makefile 或 .bat 文件。基本上，这就是：

```
lib /NOLOGO /OUT:<your_lib_pathname> @<<
<list_all_of_your_obj_paths_here>
<< 
```

然后，在您的项目中，添加一个 Post Build Event，该命令仅运行 .bat 文件（或 nmake 或 perl）。然后，您将始终同时获得一个 dll 和一个静态库。我将避免贬低 Visual Studio，因为它不允许该工具在 Linker 之前的项目中存在（在工具流中）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T22:42:13.527

我认为这样做的典型方式是上面的选择 2。这是我使用的，也是我看到许多图书馆和公司所做的。

如果您发现它对您不起作用，那么请务必使用其他东西。

祝你好运。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-18T09:07:36.540

我更喜欢2种配置方式。

通过项目属性窗口中的“所有配置”项设置所有常用设置。在它分离设置之后。它已经完成了。我们去编码吧。

还有一个非常好的功能叫做“批量构建”，它可以依次构建指定的配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T03:03:02.920

多个项目是最好的方式——这是我在无数项目中最广泛看到的配置。

也就是说，也可以通过从外部工具（如自定义 vbscript）动态修改您的 vcproj 文件来实现第三个选项，您可以从 make 文件中调用这些文件。您可以使用 shell 变量来控制工具的行为。

请注意，您仍应使用 Visual Studio 进行构建，makefile 仅应在需要制作 mods 时启动您的外部工具，然后执行实际的构建命令

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T16:28:14.510

由于问题阻止我们迁移到 VS2005 或更高版本，我使用 Visual Studio 6.0 (Still)。重建会导致严重的问题（一切都中断）......我们中的许多人都在考虑游说以结构化的方式向 GnuC++ 迁移，以最终让我们摆脱许可的 Visual Studio 产品并转向 Eclipse 和 Linux。

在 Unix/Linux 中，很容易为所有配置构建。所以我无法相信在 Visual Studio 中尝试完成相同的任务是多么耗费时间和生产力。到目前为止，对于 VS6.0，我发现只有两个单独的项目似乎是可行的。我还没有尝试过多重配置技术，但会看看它是否适用于较旧的 VS6.0。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-18T08:35:41.720

为什么不选择版本 1 并使用脚本或其他东西从第一组项目文件生成第二组项目文件。这样您就知道差异只是构建 dll 或静态库所需的部分。

# xml - 空字符串是有效的 XML 吗？

> ID：376306
> 
> 赞同：6
> 
> 时间：2008-12-17T22:38:21.537
> 
> 标签：xml, string

'' 是一段有效的 XML 吗？'' 可以从 MSSQL 插入 oracle xblob 列或 XML 列吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-17T22:45:42.130

不，[规范](http://www.w3.org/TR/REC-xml/#sec-well-formed)说格式良好的 XML 文档满足：

```
document ::=  prolog  element  Misc* 
```

在哪里

```
element ::= EmptyElemTag
              | STag content ETag 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-17T22:46:33.687

它不是 XML 文档 - 至少需要一个且最多一个根元素。（如果编码为 UTF-8 且版本为 1.0 - XML 推荐的生产 22，则 XML 声明是可选的）。它是一个有效的 XML*片段*——可以是空文本节点，也可以是空范围。

您必须在上下文中定义“XML 片段”的含义。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T22:48:45.743

它不是有效的 xml，但它可以插入到 SQL Server 2005 中的 XML 列中。显然，对于 SQL Server 2005，您需要将双引号换成单引号：

```
Insert Into MyTestTable(MyXmlColumn) Values(''); 
```

这很好用 - 我刚刚测试过它并且插入成功。

但 Oracle 不允许空 XML。该表达式`XMLType('')`将引发异常“ORA-19032: Expected XML tag , got no content”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T22:42:57.783

它不是有效的 xml。有效的 xml 需要具有编码类型和根节点的 xml 声明。Oracle 或 SQL Server 是否会接受它，您可以自己检查。

# c++ - 数据结构是否适合shared_ptr？

> ID：376335
> 
> 赞同：5
> 
> 时间：2008-12-17T22:47:35.527
> 
> 标签：c++, data-structures, shared-ptr, tr1

我正在用 C++ 实现二叉树。传统上，我有一个指向左的指针和一个指向右的指针，但手动内存管理通常以泪水告终。这让我想到了我的问题......

数据结构是否适合使用 shared_ptr？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-17T23:13:51.933

我认为这取决于您将在哪里使用它们。我假设您正在考虑做的事情是这样的：

```
template <class T>
class BinaryTreeNode 
{
    //public interface ignored for this example
    private:
        shared_ptr<BinaryTreeNode<T> > left;
        shared_ptr<BinaryTreeNode<T> > right;
        T data;
} 
```

*如果*您希望您的数据结构能够处理动态创建的节点，这将非常有意义。但是，由于这不是正常的设计，我认为这是不合适的。

我的回答是不，这不是使用 shared_ptr 的合适位置，因为 shared_ptr 的使用意味着对象实际上是共享的——但是，二叉树中的节点*从未*共享过。然而，正如 Martin York 所指出的，为什么要重新发明轮子——已经有一个智能指针类型可以做我们正在尝试做的事情——auto_ptr。所以用这样的东西：

```
template <class T>
class BinaryTreeNode 
{
    //public interface ignored for this example
    private:
        auto_ptr<BinaryTreeNode<T> > left;
        auto_ptr<BinaryTreeNode<T> > right;
        T data;
} 
```

如果有人问为什么 data 不是 shared_ptr，答案很简单——如果数据的副本对库的*客户端*有好处，他们会传入数据项，然后树节点会制作一个副本。如果*客户端*认为复制是一个坏主意，那么*客户端*代码可以传入一个 shared_ptr，树节点可以安全地复制它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T23:16:13.177

因为 left 和 right 不共享 boost::shared_ptr<> 可能不是正确的智能指针。

这将是尝试 std::auto_ptr<> 的好地方

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T22:53:39.477

是的，一点没错。

但如果你有一个循环数据结构，请小心。如果你有两个对象，它们都有一个共享的ptr，那么如果不手动清除共享的ptr，它们就永远不会被释放。在这种情况下可以使用弱 ptr。当然，这不是二叉树的担心。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T23:06:21.557

在每个对象都有一个所有者的情况下，手动编写内存管理并不是那么困难，因此可以删除它在其析构函数中拥有的内容。

鉴于根据定义，一棵树由节点组成，每个节点都有一个父节点，因此显然是其单一所有者的候选者，这真是一个快乐的时刻。恭喜！

我认为在您的情况下开发这样的解决方案非常值得*，并且还尝试了这种`shared_ptr`方法，将差异完全隐藏在相同的界面后面，因此您可以在两者之间切换，并将性能差异与一些实际实验进行比较。这是知道是否`shared_ptr`适合您的应用程序的唯一可靠方法。

（* 对我们来说，如果你告诉我们情况如何。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-07T08:59:57.000

切勿将 shared_ptr 用于数据结构的节点。如果在任何时候共享所有权，它可能会导致节点的销毁被暂停或延迟。这可能会导致以错误的顺序调用析构函数。在数据结构中，节点的构造函数包含与其他节点耦合的任何代码，而析构函数包含与其他节点分离的代码，这是一种很好的做法。以错误顺序调用的析构函数可能会破坏这种设计。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T22:54:09.553

shared_ptr 有一些额外的开销，特别是在空间要求方面，但如果您的元素是单独分配的，那么 shared_ptr 将是完美的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T12:31:05.297

你甚至需要指针吗？看来你可以使用`boost::optional<BinaryTreeNode<T> > left, right`.

# java - Java程序员应该知道哪些常见的未定义行为

> ID：376338
> 
> 赞同：21
> 
> 时间：2008-12-17T22:48:29.270
> 
> 标签：java, undefined

[与此](https://stackoverflow.com/questions/367633/what-are-all-the-common-undefined-behaviour-that-c-programmer-should-know-about)问题相同，但适用于 java

**更新** 根据一些人的评论和回应，很明显 Java 几乎没有未定义的行为。

所以我也想问一下什么行为*不明显。*请在回答时区分两者:)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-17T22:54:32.080

与线程有关的任何事情... :)

还：

*   覆盖方法并期望它们在版本之间以相同的方式使用
*   关于底层平台的假设（例如文件分隔符）
*   垃圾收集/终结的详细信息
*   关于类初始化的一些细节
*   Integer.valueOf（等）是否返回相同的对象
*   性能、延迟和内存使用

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-17T23:03:13.700

Java 中几乎没有未定义的行为，与 C/C++ 相比，它是一个定义更明确的平台。这样做的原因是 C/C++ 编译器旨在为非常不同的平台生成代码，因此被授予相当广泛的自由度，以防止过于严格的要求会迫使编译器为给定平台生成次优代码。

Java 通过以非常精确的方式定义几乎所有行为并只允许很小的自由度，从而牺牲了其中的一部分。这当然使平台更容易处理。

发生未定义行为的主要领域是多个线程的确切时间和调度（正如 Tom Hawtin 已经提到的）。

有几个地方的行为不明显，'虽然，所以它可能看起来未定义，但不是（Oscar Reyes 给出的字符串比较示例就是一个很好的例子）。

还有一些行为被定义为未定义的地方（例如，HashMap 中元素的顺序被定义为依赖于实现并且不需要是常量）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-18T14:53:54.140

我认为[Java(TM) Puzzlers: Traps, Pitfalls, and Corner Cases](https://rads.stackoverflow.com/amzn/click/com/032133678X)这本书非常有用，它解释了 Java 的许多隐藏点和未定义的行为。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T23:25:29.617

[序列化](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html)。它本身并不是未定义的（有一个确定性算法）。但是，对于不经意的观察者来说，什么会或不会导致 serialVersionUID 的变化根本不明显，从而挫败了您使用 RMI、JMS 和各种其他首字母缩略词的所有尝试。

因此，当您知道需要序列化对象时，[考虑您的选择](http://www.javapractices.com/topic/TopicAction.do?Id=45)通常是一个好主意。我特别喜欢“始终将其作为一个字段包含”技术：

```
private static final long serialVersionUID = 1L; 
```

*仅当您（开发人员）知道*您的代码发生了破坏兼容性的更改时，才更改该字段的值。不要让 JDK 为您做出决定......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-17T23:19:42.200

我不完全确定您所说的“未定义行为”是什么意思，但正如其他人所指出的那样，核心语言在平台、语言版本和 JVM 之间是非常可预测的。

然而，对于图形（Swing、AWT）来说，情况并非如此，它们往往是不可预测的，并且不一定可以在不同平台上重现。我从事基于图形密集型 Java 的可视化应用程序，我花了很多时间“一次编写，到处调试”。

此外，Object.clone() 存在一些重大问题，在大多数情况下不鼓励使用它。请参阅 Joshua Bloch 的“Effective Java”中的第 11 项以获得完整答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T22:56:50.530

## 定义明确但不明显：

平等的对象测试：

== 用于测试引用（这两个对象引用是否指向同一个对象）

而equals用于测试对象是否相等。

所以例如

```
new String("test") == new String("test") 
```

是假的，而

```
new String("test").equals( new String("test") ) 
```

是真的

字符串对象被实习，因此以下返回 true：

```
String a = "test";
String b = "test";

a == b  // returns true 
```

但是如果字符串是在其他地方创建的（例如来自数据库）

```
String a = "test";
String b = getFromDataBase(); // internally the remote returns "test"

a == b  // returns false. 
```

验证是假的。

我已经在带有脚本的 jsp 中看到了这种情况，而新程序员不明白为什么要验证

```
 <%if( param == "continue" ) { %> 
```

永远不会发生

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-17T22:57:33.573

我记得的一件事是关于 jvm 与 jni 的兼容性。我们有一个在 jdk1.4 上开发的应用程序，当将它安装在带有 ibm jvm 的机器上时（我相信是 jikes），jni 调用就吐了！不过那是在 2006 年。我认为这与作为语言的 java 关系不大，而与作为平台的 java 关系更大。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-18T14:29:51.083

添加[动态与静态绑定](https://stackoverflow.com/questions/321864/java-dynamic-binding-and-method-overriding#322234)以及如何将其应用于重载和覆盖的方法**并不明显**。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-18T15:10:37.820

不是未定义但意外的行为是双精度数在转换为整数时如何舍入。0.6d 总是向下舍入为 0；实际上 0.9d 也向下舍入为 0。但 0.99999999999999995 及更大的值将向上舍入为 1。

将 Math.random() 调用的结果转换为提防时，这只是一个有趣的行为。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-12-27T17:31:56.227

我知道有两种未定义的行为：

a) 重载带有参数的方法，该参数是重载方法中相同参数的子类。例如：

```
void doSomething(Object obj);
void doSomething(String str); 
```

无法知道在 doSomething("Hello world!") 中将调用哪个方法，因为两个签名都是有效的。此外，此行为可以从 VM 更改为 VM，甚至从执行更改为执行。

b) 在构造函数中调用同一类的非最终方法。如果在子类中重写此方法，则会发生未定义的行为。请注意，构造是从超类到子类的。如果子类方法使用一些本地子类属性，情况会变得特别糟糕。在 Oracle VM 的情况下，将构造本地属性，然后超类构造函数将完成其执行，当到达子类的构造函数时，将再次构造属性，覆盖先前定义的值。

# c# - 随机字符串生成 - 两个一个接一个产生相同的结果

> ID：376344
> 
> 赞同：2
> 
> 时间：2008-12-17T22:50:53.540
> 
> 标签：c#, string, random

我有一段简单的代码：

```
public string GenerateRandomString()
        {
            string randomString = string.Empty;
            Random r = new Random();
            for (int i = 0; i < length; i++)
                randomString += chars[r.Next(chars.Length)];

            return randomString;
        } 
```

如果我调用这个函数来生成两个字符串，一个接一个，它们是相同的......但是如果我通过生成字符串的两行进行调试 - 结果是不同的。有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T22:52:30.087

这种情况正在发生，因为调用彼此非常接近（在同一毫秒内），因此 Random 构造函数将为 Random 对象播种相同的值（默认情况下它使用日期和时间）。

所以，实际上有两种解决方案。

**1\. 提供您自己的种子值**，每次构造 Random 对象时该值都是唯一的。

**2\. 始终使用相同的 Random 对象**——只构造一次。

就个人而言，我会使用第二种方法。可以通过使 Random 对象静态或使其成为类的成员来完成。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-17T23:06:09.360

上面的答案是正确的。不过，我建议对您的代码进行以下更改：

1）我建议使用 StringBuilder 而不是一直附加到字符串。字符串是不可变的，因此每次添加时都会创建一个新字符串。如果您从未使用过 StringBuilder，请查看它。这对这类工作非常有用。

2）如果您将长度传递给方法本身，您可以使您的方法更容易重用。您可能也可以传入 chars 数组，但我已经忽略了它。

3) 每次使用相同的随机对象，如上所述。

```
public string GenerateRandomString(int length)
{
    StringBuilder randomString = new StringBuilder(length);

    for (int i = 0; i < length; i++)
        randomString.Append(chars[(int)(_RandomObj.Next(chars.Length))].ToString());

     return randomString.ToString();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T22:57:10.280

这是因为您同时创建了两个随机对象。这是给它相同的种子，所以你会得到相同的数字。

当您调试它时，在创建随机对象之间有时间，这允许它们获得不同的种子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T22:55:29.583

Random 的默认构造函数（您正在使用的构造函数）为生成器提供基于当前时间的值。如果在函数的第一次和第二次调用之间以毫秒为单位的时间没有变化，它将使用相同的随机种子。

我的建议是使用静态随机对象并且只初始化一次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-19T15:44:21.877

由于`Random`生成器与系统时钟相关联，因此您可能在该时间段内显示相同的结果。有几种方法可以纠正。如果您使用循环，请放置在循环的 `Random rnd = new Random();` 外部。

放置 `Random rnd = new Random();` 声明变量的行，并在整个程序中使用相同的变量（本示例为 rnd）。

这在大多数情况下都有效。

# java - Project Euler (P14)：递归问题

> ID：376346
> 
> 赞同：5
> 
> 时间：2008-12-17T22:51:53.957
> 
> 标签：java, recursion, stack-overflow, collatz

嗨，我正在做 Euler 项目中的 Collat​​z 序列问题（问题 14）。我的代码适用于低于 100000 的数字，但如果数字更大，则会出现堆栈溢出错误。

有没有办法可以重构代码以使用尾递归，或防止堆栈溢出。代码如下：

```
import java.util.*;

public class v4
{

   // use a HashMap to store computed number, and chain size 

   static HashMap<Integer, Integer> hm = new HashMap<Integer, Integer>();

   public static void main(String[] args)
   {

      hm.put(1, 1);

      final int CEILING_MAX=Integer.parseInt(args[0]);
      int len=1;
      int max_count=1;
      int max_seed=1;

      for(int i=2; i<CEILING_MAX; i++)
      {
          len = seqCount(i);

          if(len > max_count)
          {
             max_count = len;
             max_seed = i;
          }
      }
      System.out.println(max_seed+"\t"+max_count);
   }

   // find the size of the hailstone sequence for N

   public static int seqCount(int n)
   {

      if(hm.get(n) != null)
      {
         return hm.get(n);
      }

      if(n ==1)
      {
         return 1;
      }
      else
      {
         int length = 1 + seqCount(nextSeq(n));
         hm.put(n, length);
         return length;
      }
   }

   // Find the next element in the sequence

   public static int nextSeq(int n)
   {

      if(n%2 == 0)
      {
         return n/2;
      }
      else
      {
         return n*3+1;
      }
   }

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-17T23:13:22.060

您的问题不在于堆栈的大小（您已经记住了这些值），而在于

1.  序列中一些数字的大小，以及
2.  32 位整数的上限。

暗示：

```
public static int seqCount(int n)
{
   if(hm.get(n) != null) {
       return hm.get(n);
   }
   if (n < 1) {
      // this should never happen, right? ;)
   } ...
   ... 
```

这应该就足够了:)

PS你会在很多项目欧拉问题中遇到对BigNums的需求......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T22:29:45.847

如果您从**整数**更改为**长**整数，它将为您提供足够的空间来解决问题。这是我用来回答这个问题的代码：

```
 for(int i=1;i<=1000000;i+=2)
    {
        steps=1;
        int n=i;
        long current=i;
        while(current!=1)
        {
            if(current%2==0)
            {
                current=current/2;
            }else{
                current=(current*3)+1;
            }
            steps++;
        }
        if(steps>best)
        {
            best=steps;
            answer=n;
        }
    } 
```

暴力破解，运行大约需要 9 秒

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T23:25:36.307

旁注（似乎您实际上并不需要针对此问题进行尾调用优化）：尾调用优化在 Java 中不可用，据我所知，JVM 字节码甚至不支持它。这意味着任何深度递归都是不可能的，您必须重构它以使用其他循环构造。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T17:52:19.833

如果您正在计算 Collat​​z 序列的大小，最多为 1,000,000，您应该重新考虑使用***整数***类型。我建议使用***BigInteger***或可能的***long***。

这应该可以缓解遇到的问题，但请注意，根据您的 JVM，您可能仍然会用完堆空间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-26T13:12:50.080

我认为你需要这两个提示：

1.  不要使用 Integer，因为在某个起始数字处，序列会飞到一些大于 Integer.Max_VALUE 的数字，即 2147483647。请改用 Long。
2.  尽量不要使用递归来解决这个问题，即使有记忆。正如我之前提到的，一些数字会飞得很高并产生大量堆栈，这将导致堆栈溢出。尝试使用“常规”迭代，例如 do-while 或 for。当然，您仍然可以在“常规”循环中使用一些成分，例如记忆。

哦，我忘记了什么。可能由于算术溢出而发生堆栈溢出。由于您使用整数，因此当算术溢出发生时，Java 可能会将这些“飞行数字”“更改”为负数。正如在方法 seqCount(int) 中所见，您不检查不变量 n > 0。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-16T08:00:10.560

在这里你可以看看我对问题 14 的递归实现：

[http://chmu.bplaced.net/?p=265](http://chmu.bplaced.net/?p=265)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-17T05:49:50.357

您不仅可以使用递归解决此问题，还可以使用单个循环来解决此问题。如果你写 int会有**溢出。**因为它在 chaning 时会产生很长的时间，并且递归永远不会结束，因为永远不会等于 1，并且您可能会遇到**stackoverflow**错误

这是我的循环和递归解决方案：

```
public class Collatz {

    public int getChainLength(long i) {
        int count = 1;

        while (i != 1) {
            count++;

            if (i % 2 == 0) {
                i /= 2;
            } else {
                i = 3 * i + 1;
            }
        }

        return count;
    }

    public static int getChainLength(long i, int count) {
        if (i == 1) {
            return count;
        } else if (i % 2 == 0) {
            return getChainLength(i / 2, count + 1);
        } else {
            return getChainLength(3 * i + 1, count + 1);
        }
    }

    public int getLongestChain(int number) {
        int longestChain[] = { 0, 0 };

        for (int i = 1; i < number; i++) {
            int chain = getChainLength(i);

            if (longestChain[1] < chain) {
                longestChain[0] = i;
                longestChain[1] = chain;
            }
        }

        return longestChain[0];
    }

    /**
     * @param args
     */
    public static void main(String[] args) {
        System.out.println(new Collatz().getLongestChain(1000000));
    }
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-10-11T04:27:06.720

```
import java .util.*;
public class file 
  {
 public static void main(String [] args)
  {
   long largest=0;
   long number=0;
    for( long i=106239;i<1000000;i=i+2)
     {
      long k=1;
       long z=i;
      while(z!=1)
       {
        if(z%2==0)
        {
         k++;
         z=z/2;
        } else{
          k++;
          z=3*z+1;
           }
       }    
    if(k>largest)
      {
       number=i;
       largest=k;
       System.out.println(number+" "+largest);
      }
     }//for loop

   }//main
  } 
```

# asp.net - 在 ASP.NET MVC 表单上允许多个按钮的最佳方法是什么？

> ID：376352
> 
> 赞同：3
> 
> 时间：2008-12-17T22:54:21.097
> 
> 标签：asp.net, html, asp.net-mvc

我觉得我对这个太“网络表单”了，但我还是会问。我在 ASP.NET MVC 项目中有一个表单，上面有一些输入字段和两个按钮。一个按钮用于“过滤”其中一个列表框。另一个用于提交表单。我的观点是这样的：

```
<%using (Html.BeginForm())
  {%>
   <%=Html.TextBox("SearchItems") %>
   <input type="submit" name="Command" value="Find" />
   <%=Html.ListBox("SelectedItems", new MultiSelectList(model.AvailableItems,"Id", "Name", model.SelectedItems))%>
   //Some other form fields.
   <input type="submit" name="Command" value="Send" />
    <%} %> 
```

我的动作看起来像这样：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index([Bind(Prefix = "")]SendMessageRequest model)
    {
        if (model.Command == "Find")
            return SearchItems(model);
        if (model.Command == "Send")
            return Send(model);
        throw new Exception("Invalid command.");
    } 
```

这可行——控制器根据被点击的按钮选择正确的动作。但是，它并不理想，因为输入按钮的值也是显示的文本。如果我想翻译这个应用程序，那么操作就会中断。为了解决这个问题，我可以使用 <button> 元素，它允许文本和值不同。然而，这个应用程序是用于 Pocket IE 的，显然 Pocket IE 以不同的方式处理这些 - 它为 Command 提交*两个*值，这会破坏操作。

因为这是针对 Pocket IE 的，所以我对 JavaScript 的功能也很有限。Ajax 已经出局，但我可以从按钮的 onClick 中设置一个隐藏字段。

所以，我的问题是允许在 MVC 视图上使用多个按钮的单个表单的最佳方式是什么？或者，我应该以某种方式将我的观点分解为多种形式吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T23:28:26.473

我会建议使用 2 种不同操作的多种形式。我认为这也更可测试：

(c => c.Search(), FormMethod.Get); { %> 查找 (c => c.Send(), FormMethod.Post); { %> 发送

或类似的东西。然后在控制器中，您有 2 个相应的操作。这意味着责任被打破。使用 MVC，您可以拥有多个表单，这与 Webforms 不同。这样你就可以挣脱了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T23:04:44.633

不需要隐藏字段，您可以在按钮的单击事件上设置表单的操作。

javascript（在 jQuery 中）类似于：

```
$("#myForm").attr("action", "mvcaction");
$("#myForm").submit(); 
```

您可以将其包装在一个标准函数中，该函数接受一个参数，例如操作。我们将它用于菜单表单对象中的标准菜单项，它工作得很好。

编辑：不确定Pocket PC 是否完全处理JQuery，但如果不是，则应该可以在常规javascript 中执行上述操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-30T11:27:19.580

这是一篇很好的文章，描述了多个按钮表单的所有替代方案：[http ://weblogs.asp.net/dfindley/archive/2009/05/31/asp-net-mvc-multiple-buttons-in-the-same-表单.aspx](http://weblogs.asp.net/dfindley/archive/2009/05/31/asp-net-mvc-multiple-buttons-in-the-same-form.aspx)

我个人同意 Odd 的观点，jQuery onclick 动作似乎是最好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-07T13:31:45.963

我正在创建的应用程序需要进行大量的 ajax 处理，但是多表单问题也受到了影响。

我们使用 jQuery 库中的 $.post() 方法解决了这个问题。

```
$("#update").click(function() {
                $.post("/Register", { name: $("#firstName").val(),
                    surname: $("#surname").val(),
                    username: $("#email").val(),
                    accountName: $("#accountName").val(),
                    password: $("#password").val()
                },
                  function(data) {
                      alert(data);
                  });
            }); 
```

并且取消按钮返回的值更少。

```
$("#cancel").click(function() {
                $.post("/Cancel", { username: $("#email").val(),
                    password: $("#password").val()
                },
                  function(data) {
                      alert(data);
                  });
            }); 
```

好的，它依赖于启用的 javascript，但如果你要禁用 javascript，你最好不要使用互联网（和我的应用程序，因为它会在 js 上很重）。

# .net - 将 Winforms 控件数据绑定到可为空类型的最佳方法？

> ID：376361
> 
> 赞同：23
> 
> 时间：2008-12-17T22:55:54.933
> 
> 标签：.net, winforms, data-binding, nullable

我目前正在使用 winforms 数据绑定来连接数据编辑表单。我通过 CodeSmith 使用 netTiers 框架来生成我的数据对象。对于允许空值的数据库字段，它会创建可空类型。我发现使用 winforms 数据绑定控件不会正确绑定到可为空的类型。

我在网上看到了一些解决方案，建议人们创建新的文本框类来处理可以为空的类型，但这可能会很痛苦，不得不在我已经创建的表单上换掉文本框。

最初我认为使用扩展方法来做到这一点会很棒。基本上为文本框类创建一个扩展属性并绑定到它。从我有限的扩展方法经验和在线检查来看，您似乎无法进行扩展属性。据我所知，绑定必须通过属性，因为它需要能够获取或设置值，因此扩展方法不起作用。

我很想找到一种干净的方法来使用扩展方法之类的方法来改造这些表单，但是如果我必须创建新的文本框和组合框控件，我会这样做。

由于需要在 Windows 2000 上运行，我的项目目前仅限于 .Net 2.0。

有什么建议么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2010-08-19T17:53:45.027

在上面引用的文章的评论部分，其中一位海报提出了一个简单的解决方案。

而不是绑定：

```
textBox1.DataBindings.Add("Text", myClass, "MyTextProperty"); 
```

绑定：

```
textBox1.DataBindings.Add("Text", myClass, "MyTextProperty", true, DataSourceUpdateMode.OnPropertyChanged, string.Empty); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T04:29:41.470

我自己偶然发现了这个问题，这真是令人头疼。

绑定可空类型的有趣之处在于，DataGridView 可以毫无问题地处理它们——只是文本框会导致问题。

这非常讨厌 - 当您在文本框中有一个空值并且您似乎也无法离开它时，它甚至似乎阻止关闭表单。

所以，这不是一个很好的答案，但我的建议是尝试坚持使用 datagridviews 来处理表单上的可为空类型。

另一个建议是使用此处建议的“扩展器提供程序”，尽管我尚未对其进行测试：

编辑：现在已经下载了这个页面上的示例代码，它工作得很好。

[http://www.thejoyofcode.com/Databinding_and_Nullable_types_in_WinForms.NET.aspx](http://www.thejoyofcode.com/Databinding_and_Nullable_types_in_WinForms.NET.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T02:29:02.600

哦，讨厌......我只能想到几种方法来实现这一点，而且它们都不是我所说的理想。

*   第一个是为您的数据对象编写一个包装器，该包装器包含可空值，将所有可空值转换为空字符串。绑定到您的包装器对象。

*   第二个是确保数据库中的所有值都不为空......再次，不理想

*   您已经决定在这种情况下不可行的第三个是您创建一个自定义对象，该对象扩展文本框以添加可以绑定到可为空的属性。

*   我能想到的第四个最理想的方式似乎是不可能的。创建一个扩展属性，允许您扩展所有文本框对象并绑定到该对象 - 但目前看来扩展属性是不可能的。在这种情况下，这种类型的功能似乎在 .NET 框架中特别有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-27T13:12:47.730

来自[WinForms.NET 中的数据绑定和 Nullable 类型](http://www.thejoyofcode.com/Databinding_and_Nullable_types_in_WinForms.NET.aspx)

# 设想

*   您有一个具有 Nullable 属性的实体类型。
*   您有一个绑定到该属性的 TextBox。
*   当用户清除 TextBox 中的文本时，您希望将属性的值设置为 null。

# 问题

清除绑定到 Nullable 类型的 TextBox 时，数据绑定的结果根本不会成功。

# 解决方案

在本文中，我将展示如何使用 Extender Provider 来做到这一点。

只需将 Component 类添加到您的项目中，该类也实现了 IExtenderProvider 接口

```
[ProvideProperty("NullableBinding", typeof(TextBox))]  
public partial class NullableExtender : Component, IExtenderProvider 
```

ProviderProperty 属性表明，在将 NullableExtender 组件添加到您的 Form 或 UserControl 时，所有的 TextBox 都将具有一个名为 NullableBinding 的附加属性。在 VS.NET 设计器中它看起来像这样：

[![NullableBinding 属性](https://i.stack.imgur.com/N3zRW.png)](https://i.stack.imgur.com/N3zRW.png)

现在为这个属性实现一些功能：

```
private Dictionary<Control, Boolean> _nullables = new Dictionary<Control,bool>();

/// <summary>
/// This is the get part of the extender property.
/// It is actually a method because it takes the control.
/// </summary>
/// <param name="control"></param>
[DefaultValue(false),
Category("Data")]
public bool GetNullableBinding(Control control)
{
    bool nullableBinding = false;
    _nullables.TryGetValue(control, out nullableBinding);
    return nullableBinding;
}

/// <summary>
/// This is the set part of the extender property.
/// It is actually a method because it takes the control.
/// </summary>
/// <param name="control"></param>
/// <param name="nullable"></param>
public void SetNullableBinding(Control control, bool nullable)
{
    if (_nullables.ContainsKey(control))
        _nullables[control] = nullable;
    else
        _nullables.Add(control, nullable);
    if (nullable)
    {
        // Add a parse event handler.
        control.DataBindings["Text"].Parse += new ConvertEventHandler(NullableExtender_Parse);
    }
}

/// <summary>
/// When parsing, set the value to null if the value is empty.
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
private void NullableExtender_Parse(object sender, ConvertEventArgs e)
{
    if (e.Value.ToString().Length == 0)
    {
        e.Value = null;
    }
} 
```

实际完成上述技巧的代码是为数据绑定 Parse 事件添加事件处理程序。如果值为空字符串，则事件处理程序只需将值设置为 null，并且数据绑定成功。

该属性的默认值设置为 false，因为大多数属性不是 Nullable 类型，我建议不要将这些属性的 NullableBinding 设置为 true ... ;)

# asp.net - 在 Web 用户控件之间传递值 - DifferentQuestion

> ID：376366
> 
> 赞同：1
> 
> 时间：2008-12-17T22:56:59.517
> 
> 标签：asp.net, webusercontrols

我想在 Web 用户控件之间传递值，而不向放置用户控件的主页写入任何代码。我做了类似的事情，但在这样做之后，我需要双击来传递值。

我所做的例子：

***部门用户控制（代码隐藏）***

```
 protected void Page_Load(object sender, EventArgs e)
        {
            int productId = ProductUserControl.selectedProductId;
            ... doing some bind work with productId

        } 
```

***产品用户控制***

```
 public static int selectedProductId;
        protected void Page_Load(object sender, EventArgs e)
        {

        }
        protected void lvDepartments_ItemCommand(object sender, ListViewCommandEventArgs e)
        {
        if (e.CommandName == "selectDepartment")
           {
              selectedProductId = int.Parse(e.CommandArgument);
           }
        } 
```

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T23:08:03.987

在您的部门用户控件中，您试图在产品用户控件中设置 selectedProductId 之前获取它的值。这就是为什么在你回发两次之前你没有得到你期望的价值。

您需要在产品用户控件在 ItemCommand 事件中设置它之后获取它。也许将部门用户控制代码放在 Page_LoadCompleted... 虽然我不确定这是否会起作用。

另一种方法是让产品用户控件在部门用户控件中设置公共属性，而不是让部门用户控件尝试读取产品用户控件中的属性。

该问题似乎是页面生命周期问题。 [http://www.robincurry.org/blog/content/binary/o_aspNet_Page_LifeCycle.jpg](http://www.robincurry.org/blog/content/binary/o_aspNet_Page_LifeCycle.jpg)

我相信还有比这更好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-09T06:12:38.157

尝试使用委托来更干净地实现这一点，例如[这里](http://www.dotnetfunda.com/articles/article201.aspx)

# asp.net - ASP.NET 本地化单复数

> ID：376369
> 
> 赞同：19
> 
> 时间：2008-12-17T22:57:47.393
> 
> 标签：asp.net, localization

我是否可以使用 ASP.NET 资源/本地化以一种简单的方式翻译字符串以依赖于一个或另一个（英语语法），就像我在翻译中传递数字 1，它返回“你有一辆汽车”或 0、2 和更高，“你有 %n 辆车”？

或者我不得不在我的观点中使用逻辑来查看它是单数还是复数？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-12-23T22:29:22.747

杰森特鲁写道：

> 据我所知，没有一种语言需要比单数/复数更复杂的东西

这样的语言确实存在。例如，在我的母语波兰语中，有三种形式：1、2-4 和零和大于 4 的数字。然后当你达到 20 后，21、22-24 和 25+ 的形式又不同了（与数字 0-9 的语法形式相同）。是的，“你有 0 个东西”听起来很尴尬，因为你不太可能在现实生活中看到它。

### 作为本地化专家，以下是我的建议：

如果可能，请使用将数字放在末尾的形式：

```
a: Number of cars: %d 
```

这意味着名词“汽车”的形式不依赖于数字，并且 0 与任何其他数字一样自然。

如果以上不可接受，至少总是让一个完整的句子成为可翻译的资源。也就是说，使用

```
b: You have 1 car.    
c: You have %d cars. 
```

但**永远不要**将这些单元拆分成更小的片段，例如

```
d: You have
e: car(s) 
```

（然后在其他地方你有一个不可本地化的资源，例如`%s` `%d` `%s`）

不同的是，虽然我不能直接翻译（c），但由于名词的形式会改变，我*可以看到问题*，我可以在翻译中将句子改为形式（a）。

另一方面，当我面对 (d) 和 (e) 片段时，无法确保生成的句子符合语法。再说一遍：使用片段*可以保证*在某些语言中，翻译会从语法上笨拙到完全崩溃。

这适用于所有方面，而不仅仅是数字。例如，诸如此类的片段`%s was deleted`也是不可翻译的，因为动词的形式将取决于名词的性别，这在此处不可用。我可以为波兰语做的最好的事情相当于`Deleted: %s`，但只要`%s`占位符包含在可翻译资源中，我就可以做到。如果我只有“被删除”而对所指名词毫无头绪，我只能大声诅咒吓唬我的狗，最后我还是要产生垃圾语法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-08-25T01:36:06.210

我一直在开发一个库来协助应用程序的国际化。它被称为**[SmartFormat](http://github.com/scottrippey/SmartFormat)**，在 GitHub 上是开源的。

它包含许多语言的“语法数字”规则，这些规则根据语言环境确定正确的单数/复数形式。在翻译包含依赖于数量的单词的短语时，您可以指定多种形式，并且格式化程序会根据这些规则选择正确的形式。

例如：

```
var message = "There {0:is:are} {0} {0:item:items} remaining.";
var output = Smart.Format(culture, message, items.Count); 
```

它具有与 非常相似的语法`String.Format(...)`，但具有大量强大的功能，可以轻松创建自然且语法正确的消息。

它还处理可能的性别特定格式、列表等等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-23T19:30:13.967

moodforaday 写道:

这适用于所有方面，而不仅仅是数字。例如，诸如“%s was deleted”之类的片段也是不可翻译的，因为动词的形式将取决于名词的性别，这在此处不可用。我可以为波兰语做的最好的事情相当于“已删除：%s”，但我只能在可翻译资源中包含 %s 占位符时才能做到。如果我只有“被删除”而对所指名词毫无头绪，我只能大声诅咒吓唬我的狗，最后我还是要产生垃圾语法。

我想在这里说明的一点是，永远不要将名词作为参数。许多欧洲语言根据其性别修改名词，在德语的情况下，无论是主语、宾语还是间接宾语。只需使用单独的消息。代替“%s 已删除。”，为每种类型使用单独的翻译字符串：“事务已删除。” “用户已被删除。” 等等

这样，每个字符串都可以正确翻译。

可以在这里找到处理不同语言复数形式的解决方案： [http ://www.gnu.org/software/gettext/manual/html_node/Plural-forms.html](http://www.gnu.org/software/gettext/manual/html_node/Plural-forms.html)

虽然您不能在商业应用程序中使用上述软件（它包含在 GPL 中），但您可以使用相同的概念。它们的复数形式表达式与 .NET 中的 lambda 表达式完美匹配。覆盖大量语言的复数形式表达式数量有限。您可以将特定语言映射到 lambda 表达式，该表达式根据语言计算要使用的复数形式。然后，在 .NET resx 文件中查找适当的复数形式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T23:32:40.787

AFAIK，框架没有内置任何东西可以做到这一点..

这是该问题的一种通用解决方案的示例：

[http://dotnetperls.com/plural](http://dotnetperls.com/plural)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T04:41:22.630

没有内置任何东西，我们最终编写了这样的代码：另一个解决方案可以是：

> 在资源文件字符串中使用像 {CAR} 这样的占位符 为“car”的单数和复数词维护单独的资源条目： CAR_SINGULAR car
> CAR_PLURAL cars
> 
> 用这个逻辑开发一个类：

```
class MyResource
 {

    private List<string> literals = new List<string>();
    public MyResource() { literals.Add("{CAR}") }
    public static string GetLocalizedString(string key,bool isPlural)
    {
       string val = rm.GetString(key);
       if(isPlural)
       {
          val = ReplaceLiteralWithPlural(val);
       }
       else
       {
          val = ReplaceLiteralWithSingular(val);   
       }     
    }  
}

string ReplaceLiteralWithPlural(string val)
{
   StringBuilder text = new StringBuilder(val)
   foreach(string literal in literals)
   {
      text = text.Replace(literal,GetPluralKey(literal));
   }
}

string GetPluralKey(string literal)
{
  return literal + "_PLURAL";
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-18T11:43:32.727

这在 .NET 本机中仍然是不可能的。但这是一个众所周知的问题，已经被[gettext](https://www.gnu.org/software/gettext/)解决了。它具有对许多技术的本机支持，甚至包括 C# 支持。但看起来现在.NET 中有现代重新实现：[https ://github.com/VitaliiTsilnyk/NGettext](https://github.com/VitaliiTsilnyk/NGettext)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-12-18T04:59:17.353

逻辑不必在您的视图中，但它肯定不在 DotNet 框架的资源模型中。你的情况很简单，你可以为单数创建一个简单的格式字符串，为复数创建一个格式字符串。“你有 1 辆车。”/“你有 {0} 辆车。” 然后，您需要编写一个区分复数和单数情况的方法。

还有许多语言没有单数和复数之分，但这只是需要在资源字符串中进行一些重复。（编辑添加：性别和有时结尾会根据许多语言中的单位数量而变化，但这应该没问题，只要您区分单数和复数句子，而不仅仅是单词）。

微软大多放弃了语义巧妙的本地化，因为很难将诸如多元化之类的东西推广到 30 多种语言。这就是为什么您会在大多数翻译成多种语言的应用程序中看到如此无聊的数字量表示，例如“汽车：{0}”。这听起来很蹩脚，但令人惊讶的是，我上次检查时，在大多数情况下，可用性研究实际上并不支持冗长的自然语言呈现。

# iphone - 在 UITableViewCell 内编辑 UITextField 失败

> ID：376372
> 
> 赞同：26
> 
> 时间：2008-12-17T23:00:00.290
> 
> 标签：iphone, cocoa-touch

在我的应用程序中，我有`UITextField`一个`UITableViewCell`. 如果我在文本字段内单击并添加一些文本，我发现如果尝试移动插入点，它第一次可以工作，但在随后的尝试中会失败。我完全无法移动选择；没有“放大镜”出现。

更奇怪的是，在我重新启动应用程序之前，这个“设置”似乎是永久性的。它会影响`UITextFields`该屏幕上的所有内容，而不仅仅是我最初尝试编辑的那个。

如果您想亲自查看，请尝试 iPhone SDK 附带的“UICatalog”示例。单击“文本字段”，然后单击“编辑”并使用文本框。

我已经对此进行了很多挖掘，但谷歌很难找到它！我找到的最好的参考资料是在[Apple 的支持板](http://discussions.apple.com/thread.jspa?messageID=8280094)和[MacRumors formum 上](http://forums.macrumors.com/showthread.php?t=521818)（两者都参考了一个显然用于在 iPhone 2.0 上工作但不适用于现代版本的解决方案——我确实尝试过）。

我的感觉是这是操作系统中的一个错误，但我想我会把它扔给 SO 人群征求第二意见，看看是否有任何解决方法。有任何想法吗？

按照 benzado 的建议，我尝试使用 2.0、2.1 和 2.2 SDK 构建我的应用程序。我在所有版本中都有相同的行为。（实际上，在 2.2 中出现了一些相关但不一样的东西，但这可能是另一个问题！）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-22T13:08:45.733

我花了很多时间在这上面，但我最终认为我已经搞定了。

诀窍是表格需要是可编辑的（即，它的`editing`属性需要设置为`YES`）。好消息是您现在可以移动插入点。有时放大镜不会出现或跟随，但您的手势似乎总是有效。

这仍然是一个错误吗？也许。至少应该更新 Apple 的 SDK 文档。我已经向 Apple 提出了一个错误报告来涵盖这一点 (rdar://6462725)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:14:40.063

感谢这篇文章，我已经能够成功地让它在我的应用程序中正常工作。

不过要补充一点：

如果您将表格设置为可编辑，您可能会得到与预期不同的行为（缩进、编辑小部件、无披露指示符等）。这让我感到惊讶，但这里是如何最好地处理它：

在你的 UITableView 委托中，实现：

```
- (BOOL)tableView:(UITableView *)tableView shouldIndentWhileEditingRowAtIndexPath:(NSIndexPath *)indexPath
{
    return NO;
} 
```

然后，在您的 UITableViewCell 的实现中，将您的 UITableView 设置为仅在您实际编辑时才可编辑：

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
    ((UITableView *)[self superview]).editing = YES;
...
} 
```

并在编辑完成后禁用编辑：

```
- (void)textFieldDidEndEditing:(UITextField *)textField
{
...
    ((UITableView *)[self superview]).editing = YES;
} 
```

这将确保您的表格在您不编辑单元格时不处于编辑模式，从而使工作顺利进行。

谢谢！

Brian M. Criscuolo Mark/Space Inc.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T20:35:40.400

Brian M. Criscuolo 的答案是最接近的，但它仍然不太正确 - 在我使用 SDK2.2.1 时，我发现我必须执行以下操作：

在您的 UITableViewDelegate（通常是您的 UITableViewController）中添加以下两项：

```
- (BOOL)tableView:(UITableView *)tableView shouldIndentWhileEditingRowAtIndexPath:(NSIndexPath *)indexPath
{
    return NO;
} 
```

和：

```
- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath 
{
    return UITableViewCellEditingStyleNone;
} 
```

和：

```
- (void)viewDidLoad {
[super viewDidLoad];

    // do any other customisation here
self.uiTableView.editing = true;
} 
```

如果不放最上面的两个委托方法，上面会导致每行旁边的删除图标，以及每行的缩进。

正如 Brian 指出的那样，您不需要对文本字段代表做任何事情（除非您有多行并且您想要响应 didSelectRowAtIndexPath: 事件 - 在编辑模式下您似乎没有得到 - 那么您还需要按照他的建议做）。

顺便说一句 - 这似乎在 SDK3.0 中已修复（尽管我猜可能会发生变化）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T03:19:09.630

听起来确实像一个操作系统错误。我会尝试通过针对 2.0、2.1 和 2.2 SDK 运行 UICatalog 示例来重现它，以查看是否有任何变化。（如果您为 2.2 构建，但如果您为 2.1 构建，则会出现与表格单元格文本对齐相关的错误，无论设备上的操作系统版本如何。）

如果事实证明有所作为，[https://bugreport.apple.com/](https://bugreport.apple.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T09:24:39.173

我用我的应用程序尝试了这个，它似乎按预期工作。我每次都拿放大镜。我正在使用 2.1 SDK。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-20T08:15:40.577

实际上最好的方法似乎是在“viewDidLoad”中将表“editing”属性设置为true并将这些添加到表委托中

```
- (BOOL)tableView:(UITableView *)tableView shouldIndentWhileEditingRowAtIndexPath:(NSIndexPath *)indexPath
{
    return NO;
}

- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    return NO;
} 
```

您无需在文本字段委托中执行任何操作

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-27T02:42:52.907

在**iOS 12**或更高版本中，您可以在故事板中选择表格视图单元格，然后在属性检查器中启用**User Interaction Enabled 。**

# javascript - 使用 javascript 漂亮地打印 XML

> ID：376373
> 
> 赞同：149
> 
> 时间：2008-12-17T23:01:18.370
> 
> 标签：javascript, xml, xslt, pretty-print

我有一个字符串，它表示我想漂亮打印的非缩进 XML。例如：

```
<root><node/></root> 
```

应该变成：

```
<root>
  <node/>
</root> 
```

语法高亮不是必需的。为了解决这个问题，我首先将 XML 转换为添加回车符和空格，然后使用[*pre*](http://www.w3.org/TR/html401/struct/text.html#h-9.3.4)标记来输出 XML。为了添加新行和空格，我编写了以下函数：

```
function formatXml(xml) {
    var formatted = '';
    var reg = /(>)(<)(\/*)/g;
    xml = xml.replace(reg, '$1\r\n$2$3');
    var pad = 0;
    jQuery.each(xml.split('\r\n'), function(index, node) {
        var indent = 0;
        if (node.match( /.+<\/\w[^>]*>$/ )) {
            indent = 0;
        } else if (node.match( /^<\/\w/ )) {
            if (pad != 0) {
                pad -= 1;
            }
        } else if (node.match( /^<\w[^>]*[^\/]>.*$/ )) {
            indent = 1;
        } else {
            indent = 0;
        }

        var padding = '';
        for (var i = 0; i < pad; i++) {
            padding += '  ';
        }

        formatted += padding + node + '\r\n';
        pad += indent;
    });

    return formatted;
} 
```

然后我这样调用函数：

```
jQuery('pre.formatted-xml').text(formatXml('<root><node1/></root>')); 
```

这对我来说非常好，但是当我编写上一个函数时，我认为必须有更好的方法。所以我的问题是你知道给定一个 XML 字符串在 html 页面中漂亮地打印它的更好方法吗？欢迎任何可以完成这项工作的 javascript 框架和/或插件。我唯一的要求是这要在客户端完成。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-12-18T00:05:00.677

从问题的文本中，**我得到的印象是字符串结果是预期**的，而不是 HTML 格式的结果。

如果是这样，**实现此目的的最简单方法是使用[身份转换](http://www.w3.org/TR/xslt#copying)和[`<xsl:output indent="yes"/>`](http://www.w3.org/TR/xslt#section-XML-Output-Method)指令**处理 XML 文档：

```
<xsl:stylesheet 版本="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="node()|@*">
      <xsl:复制>
        <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:模板>
</xsl:样式表>

```

在提供的 XML 文档上应用此转换时：

```
<root><node/></root>

```

大多数 XSLT 处理器（.NET XslCompiledTransform、Saxon 6.5.4 和 Saxon 9.0.0.2、AltovaXML）产生想要的结果：

```
<根>
  <节点/>
</root>

```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2017-11-15T21:27:44.413

这可以使用本机 javascript 工具来完成，无需 3rd 方库，扩展 @Dimitre Novatchev 的答案：

```
var prettifyXml = function(sourceXml)
{
    var xmlDoc = new DOMParser().parseFromString(sourceXml, 'application/xml');
    var xsltDoc = new DOMParser().parseFromString([
        // describes how we want to modify the XML - indent everything
        '<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">',
        '  <xsl:strip-space elements="*"/>',
        '  <xsl:template match="para[content-style][not(text())]">', // change to just text() to strip space in text nodes
        '    <xsl:value-of select="normalize-space(.)"/>',
        '  </xsl:template>',
        '  <xsl:template match="node()|@*">',
        '    <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>',
        '  </xsl:template>',
        '  <xsl:output indent="yes"/>',
        '</xsl:stylesheet>',
    ].join('\n'), 'application/xml');

    var xsltProcessor = new XSLTProcessor();    
    xsltProcessor.importStylesheet(xsltDoc);
    var resultDoc = xsltProcessor.transformToDocument(xmlDoc);
    var resultXml = new XMLSerializer().serializeToString(resultDoc);
    return resultXml;
};

console.log(prettifyXml('<root><node/></root>')); 
```

输出：

```
<root>
  <node/>
</root> 
```

[JSFiddle](https://jsfiddle.net/klesun/sgeryvyu/369/)

请注意，正如@jat255 所指出的，[`<xsl:output indent="yes"/>`](https://developer.mozilla.org/en-US/docs/Web/XSLT/Element/output)firefox 不支持漂亮的打印。它似乎只适用于 chrome、opera 和其他基于 webkit 的浏览器。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2018-03-23T22:13:34.420

当我有类似的要求时找到了这个线程，但我将 OP 的代码简化如下：

```
function formatXml(xml, tab) { // tab = optional indent value, default is tab (\t)
    var formatted = '', indent= '';
    tab = tab || '\t';
    xml.split(/>\s*</).forEach(function(node) {
        if (node.match( /^\/\w/ )) indent = indent.substring(tab.length); // decrease indent by one 'tab'
        formatted += indent + '<' + node + '>\r\n';
        if (node.match( /^<?\w[^>]*[^\/]$/ )) indent += tab;              // increase indent
    });
    return formatted.substring(1, formatted.length-3);
} 
```

为我工作！

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2010-05-23T20:12:14.390

对 efnx clckclcks 的 javascript 函数稍作修改。我将格式从空格更改为制表符，但最重要的是我允许文本保留在一行：

```
var formatXml = this.formatXml = function (xml) {
        var reg = /(>)\s*(<)(\/*)/g; // updated Mar 30, 2015
        var wsexp = / *(.*) +\n/g;
        var contexp = /(<.+>)(.+\n)/g;
        xml = xml.replace(reg, '$1\n$2$3').replace(wsexp, '$1\n').replace(contexp, '$1\n$2');
        var pad = 0;
        var formatted = '';
        var lines = xml.split('\n');
        var indent = 0;
        var lastType = 'other';
        // 4 types of tags - single, closing, opening, other (text, doctype, comment) - 4*4 = 16 transitions 
        var transitions = {
            'single->single': 0,
            'single->closing': -1,
            'single->opening': 0,
            'single->other': 0,
            'closing->single': 0,
            'closing->closing': -1,
            'closing->opening': 0,
            'closing->other': 0,
            'opening->single': 1,
            'opening->closing': 0,
            'opening->opening': 1,
            'opening->other': 1,
            'other->single': 0,
            'other->closing': -1,
            'other->opening': 0,
            'other->other': 0
        };

        for (var i = 0; i < lines.length; i++) {
            var ln = lines[i];

            // Luca Viggiani 2017-07-03: handle optional <?xml ... ?> declaration
            if (ln.match(/\s*<\?xml/)) {
                formatted += ln + "\n";
                continue;
            }
            // ---

            var single = Boolean(ln.match(/<.+\/>/)); // is this line a single tag? ex. <br />
            var closing = Boolean(ln.match(/<\/.+>/)); // is this a closing tag? ex. </a>
            var opening = Boolean(ln.match(/<[^!].*>/)); // is this even a tag (that's not <!something>)
            var type = single ? 'single' : closing ? 'closing' : opening ? 'opening' : 'other';
            var fromTo = lastType + '->' + type;
            lastType = type;
            var padding = '';

            indent += transitions[fromTo];
            for (var j = 0; j < indent; j++) {
                padding += '\t';
            }
            if (fromTo == 'opening->closing')
                formatted = formatted.substr(0, formatted.length - 1) + ln + '\n'; // substr removes line break (\n) from prev loop
            else
                formatted += padding + ln + '\n';
        }

        return formatted;
    }; 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-07-29T14:53:53.543

Personnaly，我使​​用[google-code-prettify](https://github.com/google/code-prettify)这个函数：

```
prettyPrintOne('<root><node1><root>', 'xml') 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-03-24T17:18:08.940

或者，如果您只想使用另一个 js 函数来执行此操作，我已经修改了 Darin 的（很多）：

```
var formatXml = this.formatXml = function (xml) {
    var reg = /(>)(<)(\/*)/g;
    var wsexp = / *(.*) +\n/g;
    var contexp = /(<.+>)(.+\n)/g;
    xml = xml.replace(reg, '$1\n$2$3').replace(wsexp, '$1\n').replace(contexp, '$1\n$2');
    var pad = 0;
    var formatted = '';
    var lines = xml.split('\n');
    var indent = 0;
    var lastType = 'other';
    // 4 types of tags - single, closing, opening, other (text, doctype, comment) - 4*4 = 16 transitions 
    var transitions = {
        'single->single'    : 0,
        'single->closing'   : -1,
        'single->opening'   : 0,
        'single->other'     : 0,
        'closing->single'   : 0,
        'closing->closing'  : -1,
        'closing->opening'  : 0,
        'closing->other'    : 0,
        'opening->single'   : 1,
        'opening->closing'  : 0, 
        'opening->opening'  : 1,
        'opening->other'    : 1,
        'other->single'     : 0,
        'other->closing'    : -1,
        'other->opening'    : 0,
        'other->other'      : 0
    };

    for (var i=0; i < lines.length; i++) {
        var ln = lines[i];
        var single = Boolean(ln.match(/<.+\/>/)); // is this line a single tag? ex. <br />
        var closing = Boolean(ln.match(/<\/.+>/)); // is this a closing tag? ex. </a>
        var opening = Boolean(ln.match(/<[^!].*>/)); // is this even a tag (that's not <!something>)
        var type = single ? 'single' : closing ? 'closing' : opening ? 'opening' : 'other';
        var fromTo = lastType + '->' + type;
        lastType = type;
        var padding = '';

        indent += transitions[fromTo];
        for (var j = 0; j < indent; j++) {
            padding += '    ';
        }

        formatted += padding + ln + '\n';
    }

    return formatted;
}; 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-05-02T12:55:59.133

此处给出的所有 javascript 函数都不适用于在结束标记 '>' 和开始标记 '<' 之间具有未指定空格的 xml 文档。要修复它们，您只需要替换函数中的第一行

```
var reg = /(>)(<)(\/*)/g; 
```

经过

```
var reg = /(>)\s*(<)(\/*)/g; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-17T23:26:43.343

如何创建一个存根节点（document.createElement('div') - 或使用您的库等效项），用 xml 字符串填充它（通过 innerHTML）并为根元素/或存根元素调用简单的递归函数，以防万一没有根。该函数将为所有子节点调用自身。

然后，您可以一路高亮语法，确保标记格式正确（通过 innerHTML 附加时由浏览器自动完成）等。它不会有那么多代码，而且可能足够快。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-11-26T23:41:00.283

如果您正在寻找 JavaScript 解决方案，只需从[http://prettydiff.com/?m=beautify上的 Pretty Diff 工具获取代码](http://prettydiff.com/?m=beautify)

您也可以使用 s 参数向工具发送文件，例如： [http ://prettydiff.com/?m=beautify&s=https://stackoverflow.com/](http://prettydiff.com/?m=beautify&s=https://stackoverflow.com/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-07-15T04:22:13.447

您可以使用[xml-beautify获得格式精美的 xml](https://github.com/riversun/xml-beautify)

```
var prettyXmlText = new XmlBeautify().beautify(xmlText, 
                    {indent: "  ",useSelfClosingElement: true}); 
```

**indent**：缩进模式，如空格

**useSelfClosingElement** : true=>当为空元素时使用自闭合元素。

[JSFiddle](https://jsfiddle.net/zr9s5fLn/8/)

原创（之前）

```
<?xml version="1.0" encoding="utf-8"?><example version="2.0">
  <head><title>Original aTitle</title></head>
  <body info="none" ></body>
</example> 
```

美化（后）

```
<?xml version="1.0" encoding="utf-8"?>
<example version="2.0">
  <head>
    <title>Original aTitle</title>
  </head>
  <body info="none" />
</example> 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-04-13T18:40:57.617

对于当前的项目，我需要在没有额外库的情况下对 XML 进行美化和着色。以下自包含代码运行良好。

```
function formatXml(xml,colorize,indent) { 
  function esc(s){return s.replace(/[-\/&<> ]/g,function(c){         // Escape special chars
    return c==' '?'&nbsp;':'&#'+c.charCodeAt(0)+';';});}            
  var sm='<div class="xmt">',se='<div class="xel">',sd='<div class="xdt">',
      sa='<div class="xat">',tb='<div class="xtb">',tc='<div class="xtc">',
      ind=indent||'  ',sz='</div>',tz='</div>',re='',is='',ib,ob,at,i;
  if (!colorize) sm=se=sd=sa=sz='';   
  xml.match(/(?<=<).*(?=>)|$/s)[0].split(/>\s*</).forEach(function(nd){
    ob=('<'+nd+'>').match(/^(<[!?\/]?)(.*?)([?\/]?>)$/s);             // Split outer brackets
    ib=ob[2].match(/^(.*?)>(.*)<\/(.*)$/s)||['',ob[2],''];            // Split inner brackets 
    at=ib[1].match(/^--.*--$|=|('|").*?\1|[^\t\n\f \/>"'=]+/g)||['']; // Split attributes
    if (ob[1]=='</') is=is.substring(ind.length);                     // Decrease indent
    re+=tb+tc+esc(is)+tz+tc+sm+esc(ob[1])+sz+se+esc(at[0])+sz;
    for (i=1;i<at.length;i++) re+=(at[i]=="="?sm+"="+sz+sd+esc(at[++i]):sa+' '+at[i])+sz;
    re+=ib[2]?sm+esc('>')+sz+sd+esc(ib[2])+sz+sm+esc('</')+sz+se+ib[3]+sz:'';
    re+=sm+esc(ob[3])+sz+tz+tz;
    if (ob[1]+ob[3]+ib[2]=='<>') is+=ind;                             // Increase indent
  });
  return re;
} 
```

见[https://jsfiddle.net/dkb0La16/](https://jsfiddle.net/dkb0La16/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-10-27T17:57:17.807

```
Or just print out the special HTML characters?

Ex: <xmlstuff>&#10; &#09;<node />&#10;</xmlstuff>   

&#09;   Horizontal tab  
&#10;   Line feed 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-03-27T09:06:00.350

[XMLSpectrum](https://github.com/pgfearo/xmlspectrum)格式化 XML，支持属性缩进，还为 XML 和任何嵌入的 XPath 表达式进行语法高亮：

![XMLSpectrum 格式的 XML](https://i.stack.imgur.com/WULv5.png)

XMLSpectrum 是一个开源项目，使用 XSLT 2.0 编码 - 因此您可以使用 Saxon-HE（推荐）等处理器运行此服务器端或使用 Saxon-CE 运行客户端。

*XMLSpectrum 尚未针对在浏览器中运行进行优化 - 因此建议在服务器端运行。*

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-07-19T07:19:57.460

这是格式化xml的另一个函数

```
function formatXml(xml){
    var out = "";
    var tab = "    ";
    var indent = 0;
    var inClosingTag=false;
    var dent=function(no){
        out += "\n";
        for(var i=0; i < no; i++)
            out+=tab;
    }

    for (var i=0; i < xml.length; i++) {
        var c = xml.charAt(i);
        if(c=='<'){
            // handle </
            if(xml.charAt(i+1) == '/'){
                inClosingTag = true;
                dent(--indent);
            }
            out+=c;
        }else if(c=='>'){
            out+=c;
            // handle />
            if(xml.charAt(i-1) == '/'){
                out+="\n";
                //dent(--indent)
            }else{
              if(!inClosingTag)
                dent(++indent);
              else{
                out+="\n";
                inClosingTag=false;
              }
            }
        }else{
          out+=c;
        }
    }
    return out;
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-06-24T12:44:54.580

```
var formatXml = this.formatXml = function (xml) {
        var reg = /(>)(<)(\/*)/g;
        var wsexp = / *(.*) +\n/g;
        var contexp = /(<.+>)(.+\n)/g;
        xml = xml.replace(reg, '$1\n$2$3').replace(wsexp, '$1\n').replace(contexp, '$1\n$2');
        var pad = 0;
        var formatted = '';
        var lines = xml.split('\n');
        var indent = 0;
        var lastType = 'other'; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-08-04T18:06:57.197

xml 格式可以通过解析 xml，在 dom 树中添加或更改文本节点以进行缩进，然后将 DOM 序列化回 xml 来完成。

请检查[https://jsonbrowser.sourceforge.io/formatxml.js中的](https://jsonbrowser.sourceforge.io/formatxml.js)**formatxml**函数 您可以在 Xml 选项卡下的[https://jsonbrowser.sourceforge.io/中查看该函数的运行情况。](https://jsonbrowser.sourceforge.io/)

下面是简化的代码。 **formatxml.js**添加了错误检查、可选的注释删除、缩进作为参数并处理父节点之间的非空格文本。

```
const parser = new DOMParser();

const serializer = new XMLSerializer();

function formatXml(xml) {
  let xmlDoc = parser.parseFromString(xml, 'application/xml');
  let rootElement = xmlDoc.documentElement;
  indentChildren(xmlDoc, rootElement, "\n", "\n  ");
  xml = serializer.serializeToString(xmlDoc);
  return xml;
}

function indentChildren(xmlDoc, node, prevPrefix, prefix) {
  let children = node.childNodes;
  let i;
  let prevChild = null;
  let prevChildType = 1;
  let child = null;
  let childType;
  for (i = 0; i < children.length; i++) {
    child = children[i];
    childType = child.nodeType;
    if (childType != 3) {
      if (prevChildType == 3) {
        // Update prev text node with correct indent
        prevChild.nodeValue = prefix;
      } else {
        // Create and insert text node with correct indent
        let textNode = xmlDoc.createTextNode(prefix);
        node.insertBefore(textNode, child);
        i++;
      }
      if (childType == 1) {
        let isLeaf = child.childNodes.length == 0 || child.childNodes.length == 1 && child.childNodes[0].nodeType != 1;
        if (!isLeaf) {
          indentChildren(xmlDoc, child, prefix, prefix + "  ");
        }
      }
    }
    prevChild = child;
    prevChildType =childType;
  }
  if (child != null) {
    // Previous level indentation after last child
    if (childType == 3) {
      child.nodeValue = prevPrefix;
    } else {
      let textNode = xmlDoc.createTextNode(prevPrefix);
      node.append(textNode);
    }
  }
} 
```

参考：[https ://www.w3schools.com/XML/dom_intro.asp](https://www.w3schools.com/XML/dom_intro.asp)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-10-25T06:25:38.867

```
var reg = /(>)\s*(<)(\/*)/g;
xml = xml.replace(/\r|\n/g, ''); //deleting already existing whitespaces
xml = xml.replace(reg, '$1\r\n$2$3'); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-07-03T06:00:15.890

使用上述方法进行漂亮的打印，然后使用 jquery **text()**方法将其添加到任何 div 中。例如 div 的 id`xmldiv`然后使用：

`$("#xmldiv").text(formatXml(youXmlString));`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-07-05T14:03:52.327

您还可以使用 Saxon-JS 客户端：

```
<script src="SaxonJS/SaxonJS2.js"></script>

<script>
let myXML = `<root><node/></root>`;

SaxonJS.getResource({
   text: myXML.replace(`xml:space="preserve"`, ''),
   type: "xml"
}).then(doc => {
   const output = SaxonJS.serialize(doc, {method: "xml", indent: true, "omit-xml-declaration":true});
   console.log(output);
})
</script> 
```

[Saxon-JS 安装客户端](https://www.saxonica.com/saxon-js/documentation/index.html#!starting/installing)
[Saxon-JS 下载页面](https://www.saxonica.com/download/javascript.xml)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-11-04T07:50:47.657

这可能涉及将节点创建为对象，但您可以完全控制导出漂亮格式化的 xml。

以下将返回行的字符串数组，您可以使用新的行分隔符“\n”连接这些行。

```
/**
 * The child of an XML node can be raw text or another xml node.
 */
export type PossibleNode = XmlNode | string;

/**
 * Base XML Node type.
 */
export interface XmlNode {
  tag: string;
  attrs?: { [key: string]: string };
  children?: PossibleNode[];
}

/**
 * Exports the given XML node to a string array.
 * 
 * @param node XML Node
 * @param autoClose Auto close the tag
 * @param indent Indentation level
 * @returns String array
 */
export function xmlNodeToString(
  node: XmlNode,
  autoClose: boolean = true,
  indent: number = 0
): string[] {
  const indentStr = " ".repeat(indent);
  const sb: string[] = [];
  sb.push(`${indentStr}<${node.tag}`);
  if (node.attrs) {
    for (const key in node.attrs) {
      sb.push(`${indentStr} ${key}="${node.attrs[key]}"`);
    }
  }
  if (node.children) {
    if (node.children.length === 1 && typeof node.children[0] === "string") {
      sb[sb.length - 1] += ">" + node.children[0];
    } else {
      sb.push(`${indentStr}>`);
      for (const child of node.children) {
        if (typeof child === "string") {
          sb.push(`${indentStr}  ${child}`);
        } else {
          const lines = xmlNodeToString(child, autoClose, indent + 1);
          sb.push(...lines.map((line) => `${indentStr}  ${line}`));
        }
      }
    }
    if (autoClose) {
      if (node.children.length === 1 && typeof node.children[0] === "string") {
        sb[sb.length - 1] += `</${node.tag}>`;
      } else {
        sb.push(`${indentStr}</${node.tag}>`);
      }
    }
  } else {
    if (autoClose) {
      sb.push(`${indentStr}/>`);
    } else {
      sb.push(`${indentStr}>`);
    }
  }
  return sb;
} 
```

对要点的更新表示赞赏：[https ://gist.github.com/rodydavis/acd609560ab0416b60681fddabc43eee](https://gist.github.com/rodydavis/acd609560ab0416b60681fddabc43eee)

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2019-09-06T00:29:18.980

[XML-to-json](https://github.com/javadev/xml-to-json)库有方法`formatXml(xml).`我是项目的维护者。

```
var prettyXml = formatXml("<a><b/></a>");

// <a>
//   <b/>
// </a> 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2020-09-24T18:35:55.823

这是我的版本，可能对其他人有用，使用 String builder 看到有人拥有相同的代码。

```
 public String FormatXml(String xml, String tab)
    {
        var sb = new StringBuilder();
        int indent = 0;
        // find all elements
        foreach (string node in Regex.Split(xml,@">\s*<"))
        {
            // if at end, lower indent
            if (Regex.IsMatch(node, @"^\/\w")) indent--;
            sb.AppendLine(String.Format("{0}<{1}>", string.Concat(Enumerable.Repeat(tab, indent).ToArray()), node));
            // if at start, increase indent
            if (Regex.IsMatch(node, @"^<?\w[^>]*[^\/]$")) indent++;
        }
        // correct first < and last > from the output
        String result = sb.ToString().Substring(1);
        return result.Remove(result.Length - Environment.NewLine.Length-1);
    } 
```

# sql - LEFT JOIN 与多个 SELECT 语句

> ID：376375
> 
> 赞同：7
> 
> 时间：2008-12-17T23:02:16.450
> 
> 标签：sql

我正在研究别人的 PHP 代码，并一遍又一遍地看到这种模式：

（伪代码）

```
result = SELECT blah1, blah2, foreign_key FROM foo WHERE key=bar

if foreign_key > 0  
  other_result = SELECT something FROM foo2 WHERE key=foreign_key  
end 
```

如果另一个表中没有相关行，则代码需要分支，但是通过在单个 SELECT 语句中执行 LEFT JOIN 是否可以做得更好？我错过了一些性能优势吗？便携性问题？还是我只是在吹毛求疵？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T23:11:48.130

这绝对是错误的。你无缘无故地第二次越过电线。数据库在他们的问题空间中非常快。连接表就是其中之一，您会看到第二个查询的性能下降更多，然后是连接。除非您的表空间是数亿条记录，否则这不是一个好主意。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-18T00:14:54.477

没有足够的信息来真正回答这个问题。我研究过出于一个原因减少查询计数并出于另一个原因增加查询计数的应用程序，*这两者*都提高了性能。在同一个应用程序中！

对于表大小、数据库配置以及查询外部表的频率的某些组合，执行这两个查询可能比 LEFT JOIN 快得多。*但是经验和测试是唯一能告诉你的*。具有中等大表的 MySQL 似乎对此很敏感，IME。对一张表执行三个查询通常比一个查询联接三个查询要快得多。我已经看到了一个数量级的加速。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T23:06:15.037

我和你在一起 - 单个 SQL 会更好

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T23:10:19.130

将您的 SQL DBMS 视为一个 ISAM 文件系统，一次从一个表中进行选择是有危险的。将单个 SELECT 与外部连接一起使用可能会更简洁。另一方面，在应用程序代码中检测 null 并根据 null 与非 null 决定做什么也不是完全干净的。

单个语句的一个优点 - 您与服务器的往返次数更少 - 特别是如果每​​次需要其他结果时动态准备 SQL。

因此，平均而言，单个 SELECT 语句更好。它让优化器有事可做，也避免了它变得太无聊。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T23:11:00.317

在我看来，您所说的是相当有效的-为什么要在一次调用数据库时触发两次对数据库的调用-除非两个记录都作为对象独立需要（？）

当然，虽然在一次调用中从数据库中将其全部拉回并将字段分离到两个单独的对象中可能不是那么简单的代码明智，但这确实意味着您只依赖于数据库进行一次调用而不是二...

将其作为查询阅读会更好：

```
Select a.blah1, a.blah2, b.something From foo a Left Join foo2 b On a.foreign_key = b.key Where a.Key = bar; 
```

通过这种方式，您可以一次检查是否得到了结果，并让数据库在一个查询中完成所有繁重的工作，而不是两个......

是的，我觉得你说的好像是对的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-17T23:20:30.563

最可能的解释是开发人员根本不知道外连接是如何工作的。这很常见，即使在对自己的专业非常有经验的开发人员中也是如此。

还有一个广为流传的神话，即“使用连接的查询很慢”。如此多的开发人员不惜一切代价盲目地避免连接，甚至到了运行多个查询的极端情况，其中一个会更好。

避免连接的神话就像说我们应该避免在应用程序代码中编写循环，因为多次运行一行代码显然比运行一次要慢。更不用说每次迭代期间的“开销”`++i`和测试！`i<20`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-18T01:05:04.563

您完全正确，单一查询是要走的路。为了给所提供的其他答案增加一些价值，让我添加这个公理：“为工作使用正确的工具，数据库服务器应该处理查询工作，代码应该处理程序工作。”

这个概念背后的关键思想是，如果编译器/查询优化器知道整个问题域而不是其中的一半，他们可以做得更好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-17T23:17:51.393

考虑到在一个数据库命中中，您拥有所需的所有数据，而使用一条 SQL 语句将在 99% 的情况下获得更好的性能。不确定在这种情况下是否正在动态创建连接，但如果这样做很昂贵。即使重用现有连接的过程，DBMS 也没有得到优化查询的最佳方式，也没有真正利用关系。

出于性能原因，我能看到执行这样的调用的唯一方法是，如果外键检索的数据量很大，并且仅在某些情况下需要它。但是在您描述的示例中，如果它存在，它就会抓住它，所以情况并非如此，因此不会获得任何性能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-17T23:18:24.607

所有这一切的唯一“陷阱”是如果要使用的结果集包含很多连接，甚至是嵌套连接。

我现在有两个或三个实例，其中我继承的原始查询由一个包含大量连接的单个查询组成，并且 SQL 需要花费大量时间来准备语句。

我回到过程中，利用一些表变量（或临时表）并将查询分解为许多较小的单选择类型语句，并以这种方式构造最终结果集。

此更新极大地修复了响应时间，将其缩短到几秒钟，因为更容易执行大量简单的“单次拍摄”来检索必要的数据。

我在这里不是为了反对而反对，只是为了指出代码可能已被分解到如此细粒度的级别以解决类似的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-17T23:27:09.533

单个 SQL 查询将带来更高的性能，因为 SQL 服务器（有时不共享相同的位置）只需要处理一个请求，如果您要使用多个 SQL 查询，那么您会引入很多开销：

> 执行更多 CPU 指令，向服务器发送第二个查询，在服务器上创建第二个线程，在服务器上执行可能的更多 CPU 指令，销毁服务器上的第二个线程，发回第二个结果。

可能存在性能可能更好的特殊情况，但对于简单的事情，您无法通过做更多的工作来获得更好的性能。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-18T00:43:36.370

进行简单的两表连接通常是解决此问题域的最佳方法，但是根据表和索引的状态，在某些情况下执行两个选择语句可能会更好，但通常我没有直到我开始接近 3-5 个连接表，而不仅仅是 2 个，才遇到这个问题。

只需确保您在两个表上都覆盖了索引，以确保您没有扫描磁盘的所有记录，这是数据库获得的最大性能损失（以我有限的经验）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-18T01:23:24.230

您应该始终尽量减少对数据库的查询次数。您的示例仅适用于 1 个查询。这样，您以后将能够更轻松地缓存或同时处理更多请求，因为不是总是使用需要连接的 2-3 个查询，而是每次只有 1 个。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-11-06T08:52:33.647

有很多情况需要不同的解决方案，不可能一起解释。

Join 扫描表和循环以匹配第二个表中的第一个表记录。在许多情况下，简单的选择查询会更快，因为它只关心主键/唯一键（如果存在）在内部搜索数据。

# cvs - CVS 标签报告

> ID：376376
> 
> 赞同：2
> 
> 时间：2008-12-17T23:02:24.857
> 
> 标签：cvs, tags, report

我发现了这个问题：如何找出哪些 CVS 标签覆盖了哪些文件和路径？(3)

然而，结果完全不是我所期待的。我正在使用以下内容：

cvs -n -q 更新 -r ET30908

我正在寻找每个带有“ET30908”标签的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T20:00:02.970

我发现最简单的方法是检查项目。

```
cvs co -d tag-ET30908 -r ET30908 modulename 
```

这将在磁盘上创建一个名为“tag-ET30908”的目录，其中仅包含具有指定标签的那些文件。

您甚至可以保留此目录，然后再进行更新`cvs update`以查看发生了哪些标签更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T23:19:31.297

知道这一点的唯一方法是迭代所有文件，因为 CVS 是面向文件的，而不是面向变更集或快照的。没有输入所有标签的中心文件/位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T08:25:43.363

Hmm, what about:

```
cvs -q rlog -SR -rET30908 . 
```

Note the period character at the end. This essentially means to search the entire repository. You can of course also limit your search to a specific module instead.

Also note that the `-S` parameter is not supported by some older versions of CVS and CVSNT. Without it you would get an entry for every single file even if they don't match the given tag.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T20:02:55.493

我会与树的头部进行比较

```
cvs rdiff -s -r ET30908 -r HEAD modulename 
```

rdiff 允许您无需结帐即可查看

如果您想与您的版本进行比较，您可以标记您所在的空间，然后使用该标记执行 rdiff

# hardware - 终极家庭开发设置 - 带有瘦客户端笔记本电脑的大型台式机？可能的？

> ID：376377
> 
> 赞同：1
> 
> 时间：2008-12-17T23:02:28.897
> 
> 标签：hardware

我正在尝试找出最佳的低预算家庭办公室开发硬件设置。我的笔记本电脑老化了。

我的最新想法是，我想要一台功能强大的台式机与一台功能较弱的笔记本电脑搭配使用。这个想法是台式机可以完成繁重的工作，而笔记本电脑可以让我不受束缚地工作（当然，但在无线网络的范围内。）

这样的事情可能吗，还是我在做梦？

（我开发 .Net 应用程序 - 主要是 Asp.Net）

感谢您的想法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T23:25:00.617

您可以使用 RDP / 终端服务客户端或 VNC 来执行此操作。您还可以在强大的服务器上运行多个虚拟机（使其看起来像穷人的数据中心/一组功能较弱的服务器）。

另一个好处是您可以使用笔记本电脑作为浏览器客户端和桌面作为服务器进行一些测试 - 这有时会显示您在 localhost 上进行测试时看不到的问题（特别是如果您的网络在中间出现故障时） ）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T23:28:15.367

是的，这是有道理的，这将起作用。这是过去用于 unix 工作站（X 窗口）的类似模型（但不相同）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T23:47:29.243

我会保留您老化的笔记本电脑用于测试瘦客户端应用程序 - 谁在乎它是否老化运行 Internet Explorer 需要多少功率？

此时此刻，我的梦想开发系统看起来像这样：

*   几个不错的快速双核处理器
*   4 吉格的记忆
*   几个 Intel X25-M 180Gb 固态硬盘来运行我的应用程序。
*   3 x 19+" 高对比度显示器，我桌上的这 3 台显示器很糟糕。
*   人体工学键盘，我目前有我非常喜欢的人体工学键盘 4000
*   无线激光鼠标，我目前使用的是罗技 MX Revolution，我很喜欢
*   用于额外存储空间的 2Tb SATA 驱动器（以防万一）

当然，我家里没有这些，我和你一样有一台老化的笔记本电脑。我在工作的办公桌上放了一部分这个设置，我一直对其他零碎的东西垂涎三尺。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T23:55:10.413

您可以将桌面用作某种服务器，并让您的桌面和笔记本电脑都进行编译。

就像他们在工作室中渲染 3D CGI 电影一样，跨越计算机农场。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T23:30:47.607

这正是我当前的设置，并且运行良好。我仍然会买几台 20 英寸以上的显示器，因为笔记本电脑对于长时间使用可能会有些限制。

# asp.net - 托管用户视频

> ID：376380
> 
> 赞同：2
> 
> 时间：2008-12-17T23:03:39.800
> 
> 标签：asp.net, streaming, youtube, multimedia

我的客户希望网站访问者在他们的个人资料中嵌入视频。我们建议我们使用 YouTube 来获得快速且经济高效（免费）的解决方案。然而，他并不热衷于 YouTube 会控制对视频的访问，这是他服务的重要组成部分。YouTube 似乎不太可能突然拔掉插头，但这样做对他的生意来说是非常糟糕的。

有关替代解决方案或服务的任何建议或建议？许多网站确实以这种方式使用 YouTube。你觉得他的担心有道理吗？

这是一家小型企业，因此前期开发或服务成本很高。该网站使用 C# 和 SQL Server 2005 在 ASP.NET 3.5 中构建。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T23:33:30.787

看看[嘿！观看](http://heywatch.com)。

这是一个视频转换网络服务。它支持多种格式，转换后的视频可以存储在 FTP、Amazon S3 上……它还支持水印和许多其他选项。

而且一点都不贵。

我不建议您自己进行转换和存储。视频转换占用大量 CPU 和 RAM，存储占用大量磁盘空间和带宽。CPU 和 RAM 问题可以通过 Hey!Watch 解决，S3 的存储问题。

# .net - 是否有 Castle Windsor 文档的 PDF 版本？

> ID：376383
> 
> 赞同：2
> 
> 时间：2008-12-17T23:05:30.280
> 
> 标签：.net, castle-windsor, castle-activerecord

我在[这里](http://www.castleproject.org/container/documentation/v1rc3/index.html)找到的 Castle 项目组件的唯一文档是在线 HTML 文件的形式。有谁知道任何更离线友好或可打印的东西（例如PDF）。我有很长的火车通勤时间，我想在我的笔记本电脑上放一些东西。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T23:20:33.883

Decker，对于许多基于 Web 的资源，我想知道同样的事情（不仅针对 Castle Windsor）。离线使用。我想知道是否有一种工具可以通过抓取网页上的链接来创建 Web Arcive 文件 (MHT) 文件。我敢肯定，野外一定有一个……

更新：

我[用谷歌搜索](http://www.google.com/search?hl=en&rlz=1T4ADBS_enUS293US296&q=offline+web+to+MHT+tool)并找到 [了这个](http://www.internet-soft.com/extractor.htm)。当然应该在某个地方提供开源版本。让我知道你是否找到它:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T00:02:01.897

您可以使用 Wget 创建该站点的镜像以供离线浏览。

[http://wget.addictivecode.org/FrequentlyAskedQuestions](http://wget.addictivecode.org/FrequentlyAskedQuestions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T12:53:31.373

您可以直接从 Castle SVN 存储库下载它并在离线时浏览：

[http://www.castleproject.org/community/getinvolved.html](http://www.castleproject.org/community/getinvolved.html)

# javascript - 在 IE 和 VS2008 中使用断点调试 Javascript

> ID：376384
> 
> 赞同：8
> 
> 时间：2008-12-17T23:05:36.177
> 
> 标签：javascript, visual-studio-2008, breakpoints

我无法在带有 Javascript 的 Studio 中使用断点。如果我使用调试器，我可以调试；

在 VS.Net 2005问题中调试时，我已经看到这个[断点没有连接。](https://stackoverflow.com/questions/163133/breakpoint-not-hooked-up-when-debugging-in-vsnet-2005)我尝试了答案，但没有奏效。

查看“模块”窗口，V.Mvc.Jobtrakt.PDB 已正确加载，但它指向临时文件夹 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\dbc0c0c5\f64a99b3 \assembly\dl3\9de055b3\eb1303b1_9760c901\V.Mvc.Jobtrak.pdb：符号已加载。

我原以为它会指向： \JobTrak\Website\V.Mvc.Jobtrak\V.Mvc.Jobtrak\obj\Debug （这是在项目目录中）

但无论我关闭 VS 2008 的位置如何，然后吹走 temp 文件夹（如上所列）、bin 和 obj 文件夹。

打开VS 2008并进行了清理。我在 js 中设置了一个断点，它现在似乎可以工作（断点已填充）开始调试，它永远不会在断点处中断。查看断点，它现在是一个带有红点和警告指示的红色圆圈。将鼠标悬停在断点上会给我这个有用的信息：断点当前不会被命中。该位置无法映射到客户端脚本。请参阅 ASPX 断点映射的帮助。我没有被重定向，断点在函数中。等等等等，这应该可以工作。

所以我想知道是否有人有任何想法？有人可以在 VS2008 中设置断点并让它们工作吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-17T23:28:09.470

尝试在要中断的源中键入“调试器”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-17T23:22:58.280

确保您连接到正确的流程。例如，在 IE 中加载页面后，

1.  切换到 Visual Studio 并转到“调试”菜单。
2.  选择“附加到进程”
3.  在列表中找到 iexplore 并选择它。
4.  单击“选择...”按钮。
5.  在对话框中，选择“调试这些代码类型：”并**仅**选择“脚本”。
6.  点击“确定”
7.  点击“附加”

看看这是否有助于您调试 javascript。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-22T20:45:31.277

这也发生在我身上。断点在某些函数中停止工作。就我而言，问题是我`<%=..%>`在脚本中使用了。据我了解阅读 MSDN，发生这种情况是因为 Visual Studio`.ASPX`根据行内容将断点行从 映射到生成的 HTML，因此当您放置一个`<%=..>`生成的脚本时，生成的脚本将与`.ASPX`文件中的脚本不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T22:49:51.090

您不必将调试器放在 javascript 中。我发生了这种情况，原因是 try catch 块中的脚本在语法方面存在错误。一旦我修复了语法，断点就会再次正确映射。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-28T07:08:04.470

格雷格回答了这个问题，但只是为了增加一些回答的价值 -

将调试器放在 java 脚本代码中。

还要确保在 Internet Explorer > 工具 > Internet 选项 > 高级中启用了调试器

不应选中禁用调试的复选框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-16T17:15:26.407

就我而言，由于我正在使用

$.ajax({ 类型："GET",

而是 $.ajax({ type: "POST",...

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-07-08T10:09:15.627

只需在脚本中为每一行或任何行键入警报函数，如果未触发警报，则我们可以通过错误识别其所在的行

```
<script type="text/javascript">  
$(function() {
    //event handler to the checkbox selection change event
    $("input[type=checkbox]").change(function() {
        //variables to store the total price of selected rows
        //and to hold the reference to the current checkbox control
        var totalPrice = 0, ctlPrice;
        //iterate through all the rows of the gridview
        $('#Grid2 tr').each(function() {
        //if the checkbox in that rows is checked, add price to our total proce
            alert("Hi")
            if ($(this).find('input:checkbox').attr("checked")) {
                ctlPrice = $(this).find('[id$= lblPackAmount]');
                //since it is a currency column, we need to remove the $ sign and then convert it
                //to a number before adding it to the total
                totalPrice += parseFloat(ctlPrice.text().replace(/[^\d\.]/g, ''));
            }
        });
        //finally set the total price (rounded to 2 decimals) to the total paragraph control.
        //alert(totalPrice);
        $('#lblAmount').text(totalPrice);               
    });
});
</script> 
```

# iphone - iPhone警报对话框上弹出多个键盘？

> ID：376395
> 
> 赞同：4
> 
> 时间：2008-12-17T23:08:52.987
> 
> 标签：iphone

我正在设置一个带有文本字段的警报，以便玩家可以输入他们的名字以获得高分。游戏是横向模式，但是当我打电话显示警报时，警报会以纵向模式弹出，同时显示两个键盘，一个是横向的，一个是纵向模式的（这是横向的大小）。这是我用来设置警报对话框的代码：

```
 UIAlertView* dialog = [[[UIAlertView alloc] init] retain];
[dialog setDelegate:self];
[dialog setTitle:@"Enter Name"];
[dialog setMessage:@" "];
[dialog addButtonWithTitle:@"Cancel"];
[dialog addButtonWithTitle:@"OK"];
[dialog addTextFieldWithValue:@"name" label:@""];
CGAffineTransform moveUp = CGAffineTransformMakeTranslation(0.0, 100.0);
[dialog setTransform: moveUp];
[dialog show];
[dialog release]; 
```

如何使警报以横向显示并防止它显示两个键盘？

谢谢，本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T00:31:20.310

对于那些可能关心的人，这里有一个可行的解决方案，它在横向模式下可以正常工作：

```
UIAlertView* dialog = [[[UIAlertView alloc] init] retain];
[dialog setDelegate:self];
[dialog setTitle:@"Enter Name"];
[dialog setMessage:@" "];
[dialog addButtonWithTitle:@"Cancel"];
[dialog addButtonWithTitle:@"OK"];

nameField = [[UITextField alloc] initWithFrame:CGRectMake(20.0, 45.0, 245.0, 25.0)];
[nameField setBackgroundColor:[UIColor whiteColor]];
[dialog addSubview:nameField];
CGAffineTransform moveUp = CGAffineTransformMakeTranslation(0.0, 100.0);
[dialog setTransform: moveUp];
[dialog show];
[dialog release];
[nameField release]; 
```

确保你已经创建了 UITextField * nameField; 在您的 .h 文件中，您可以通过执行以下操作获取用户输入的文本： inputText = [nameField text];

在 - (void) alertView:(UIAlertView *)alert clickedButtonAtIndex:(NSInteger)buttonIndex 方法中。

# php - 跨子域和主机的 Cookie

> ID：376403
> 
> 赞同：16
> 
> 时间：2008-12-17T23:11:16.697
> 
> 标签：php, django, apache, iis, cookies

在我使用开发环境和语言组合编写的应用程序中，我需要从两个不同的子域访问一个 cookie，每个子域都在一个单独的主机上。

cookie 是`www.mydomain.com`使用后面的 PHP 代码设置的，我正在尝试从`distant.mydomain.com`单独的主机上访问它。

```
setcookie('token', base64_encode(serialize($token)), time()+10800, '/', '.mydomain.com'); 
```

我正在尝试`distant.mydomain.com`使用以下代码访问 cookie：

```
if (isset($_COOKIE['token'])) { /* do stuff */ } 
```

**问题：`distant.mydomain.com`没有找到cookie。** 刚才提到的`if`语句返回 false，即使 cookie 存在。

我已经验证了设置的 cookie 是用于`mydomain.com`（通过检查我的 Firefox cookie）。我想不出任何原因这不起作用。

使用相同的`setcookie`代码，我有一个专门在`www.mydomain.com`主机上运行的旧应用程序，并且该应用程序能够跨域访问 cookie。这让我怀疑问题与单独的主机有关。

以防以下任何信息相关：
-`www.mydomain.com`是 IIS 6.0
-`distant.mydomain.com`是 Apache 2.2.9
- 两台服务器都使用 PHP 5.2.x
- 两台服务器都在 Windows Server 2003 上运行

如果我可以提供任何进一步的信息以便更好地描述问题，请告诉我！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-18T02:45:23.627

为了任何阅读此问题的人的利益，原始帖子中包含的代码和信息完全正确并且可以正常工作。

问题是当你引入其他技术时。例如，**从那以后，我了解到通过 Python 模块发送 PHP 代码，一个允许 Django 提供 PHP 文件/内容的模块，极大地改变了脚本可访问的内容和不可访问的内容。**

这最终是在[Marc Novakowski](https://stackoverflow.com/users/27020/marc-novakowski)的建议下发现的，他建议发送`$_COOKIE`到日志以找出那里有什么。

我还检查了`$_SERVER`和`$_GET`。正是这种空虚感`$_GET`告诉我，我尝试使用的设置并不像我想象的那么简单。正是这种错误的理解导致在原始帖子中没有包含有关 Django 的信息。

道歉*并*感谢所有回答这个问题的人！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-03-14T03:20:02.450

在域中设置的 Cookie

`'.aaa.sub.domain.com'`

将与域中设置的同名 cookie 发生冲突

`'.sub.domain.com'`

和`'.some.stupidly.obscure.multi.sub.domain.com'`

这意味着（这需要一些时间来完成）如果您要在多个域中使用同名 cookie，则必须在主/基本域中设置一次（并且仅一次），在这种情况下为 '.域名.com'; 否则，生成的 cookie 将不确定地随机返回，有时是 .a.sub.domain.com 中设置的 cookie 'jasper'，有时是 .sub.domain.com 中设置的 cookie 'jasper'，有时是 cookie' jasper' 设置在 .bcddomain.com 中，有时 cookie 'jasper' 设置在 '.sub.domain.com' 中，有时 cookie 'jasper' 设置在 '.domain.com' 中

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T23:56:45.043

子域之一是否使用下划线？IE 在接受来自不遵循 URI RFC 的子域的 cookie 时遇到问题。

这是假设“distant”是一个占位符，而不是实际的子域名，当然您使用的是 IE。尽管 as 可以很好地影响更多的浏览器，但 Fireworks 却没有。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T00:38:06.117

我会尝试安装[Charles Proxy](http://www.charlesproxy.com/)并查看什么标头是 a）被发送到 Firefox 开始（设置 cookie）和 b）哪些标头正在从 Firefox 发送到第二个服务器。至少这样你可以缩小问题所在（浏览器或服务器）。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-12-17T23:59:13.103

来自 php.net 关于[setCookie -function](http://no2.php.net/setcookie)：

> cookie 可用的服务器上的路径。如果设置为“/”，cookie 将在整个域中可用。如果设置为 '/foo/'，则 cookie 将仅在 /foo/ 目录和 domain 的 /foo/bar/ 等所有子目录中可用。默认值是设置 cookie 的当前目录。
> 
> cookie 可用的域。要使 cookie 在 example.com 的所有子域上可用，您需要将其设置为“.example.com”。这 。不是必需的，但使其与更多浏览器兼容。将其设置为 www.example.com 将使 cookie 仅在 www 子域中可用。有关详细信息，请参阅 » 规范中的尾部匹配。

基本上：需要检查您的 4\. 和 5\. 参数：嗯，您的路径似乎没问题，但需要更改域：

今天，您将 cookie 阻止给除域 A 之外的所有其他人，但您希望它对域 A 和 B 都可用。这有点棘手，但可以解决。[在15 秒内](http://www.15seconds.com/issue/971108.htm)获得灵感；-)

# c# - 使用 System.Reflection 加载 ASP.NET 2.0 aspx 页面？

> ID：376404
> 
> 赞同：1
> 
> 时间：2008-12-17T23:11:33.030
> 
> 标签：c#, asp.net, reflection, system.reflection

我可以使用 System.Reflection 在另一个独立的 aspx 页面中加载独立的 aspx 页面吗？

我正在使用 ASP.NET 2.0 网站项目模型。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-18T01:07:16.790

尝试使用[BuildManager.CreateInstanceFromVirtualPath](http://msdn.microsoft.com/en-us/library/system.web.compilation.buildmanager.createinstancefromvirtualpath.aspx)。示例用法：

```
Page p = BuildManager.CreateInstanceFromVirtualPath("~/Default.aspx", typeof(Page)) 
```

这回答了这个特定的问题，尽管根据您的评论，我不确定这是否是您真正想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T00:03:42.143

不知道如何使用反射，这很可能，但您可以使用 HttpContext.Server.Execute() 将 aspx 或 asp 页面的输出捕获到字符串编写器。
我用它来渲染一些复杂的电子邮件模板，但不知道这是否正是你所追求的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T01:42:37.453

我实现了以下解决方案，这正是我想要做的：

```
using System.Reflection;
using System.Web.Compilation;

Page p = BuildManager.CreateInstanceFromVirtualPath("~/mypage.aspx", typeof(Page)) as Page;
MethodInfo MyMethod = p.GetType().GetMethod("MyMethod");
MyMethod.Invoke(p, null); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T20:51:37.477

如果您有一个从 UI.Page 继承的类作为您的页面代码，您可以使用这种方式： **将 CONTEXT 设置为您当前的 http 上下文**

```
Dim hndlr As IHttpHandler = PageParser.GetCompiledPageInstance("~/mypage.aspx", context.Server.MapPath("~/mypage.aspx"), CONTEXT)
Dim ipage As DerivedPage = DirectCast(hndlr, DerivedPage)
ipage.YourProperty= "Hello"
ipage.DoIt() 
```

所以你可以有强类型的值，如果你改变方法的符号，你会被警告。

# java - Java的“朋友”等价物？

> ID：376427
> 
> 赞同：25
> 
> 时间：2008-12-17T23:23:11.570
> 
> 标签：java, design-patterns, friend

这里有一点架构问题。

在 C++ 中，我们有“朋友”的概念，这样的朋友类可以访问私有成员。

所以，我正在开发一个 Java 应用程序并尝试遵守 MVC 架构。我有一个控制器类来管理“map_objects”之间的图形连接。我想通过使用这个控制器类来隐藏 DTO 'map_objects' 中实际设置这些连接的函数。

（即，即使控制器类实现了设置连接所需的功能，“用户”仍然可以直接访问 DTO 中的 setter/getter 函数来自行设置它们。）

在这方面是否有任何设计模式或提示？（或者我完全搞砸了？）

***重复*** [有没有办法在 Java 中模拟 C++ 的“朋友”概念？](https://stackoverflow.com/questions/182278/is-there-a-way-to-simulate-the-c-friend-concept-in-java)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-17T23:31:38.793

（不）幸运的是，Java 中没有直接的 C++ 朋友等价物。但是，[Java 访问级别修饰符](http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html)可以帮助您。特别是，私有或包私有（AKA 包保护，或“默认”）可能会有所帮助。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-17T23:52:21.560

您可能想要使用[接口隔离](http://en.wikipedia.org/wiki/Interface_segregation_principle)——也就是说，让类实现不同的接口，并且只将对适当（较小）接口的引用传递给不同的客户端。

# t4 - 如何使用 T4 和 Visual Studio 扩展部分类

> ID：376428
> 
> 赞同：1
> 
> 时间：2008-12-17T23:24:09.010
> 
> 标签：t4

我想使用 T4 为部分类生成属性。我遇到了一个配置问题，我的 .TT 文件与我要扩展的类文件在同一个项目中。因此，如果我必须将程序集包含在 .TT 文件中，它就会被锁定。我尝试在预构建中执行命令行，但问题是 VS 总是想用项目重新编译 .TT 文件。

我能想到的唯一解决方案是将 .tt 文件重命名为 .t4 ，然后使用带有 TextTransform -out 的预构建命令在项目目录中创建 .cs 文件。

谁能想到一种更清洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T15:09:10.137

假设锁定是由您的模板使用反射读取您需要扩展的部分类的元数据引起的，如果您使用 CodeModel，您可以解决锁定问题。此 API 由 Visual Studio 提供，允许您直接从源文件中获取元数据，而无需编译分部类或加载已编译的 DLL。以下是使用此方法的 T4 代码生成器示例：[http ://www.olegsych.com/2008/07/t4-template-for-generating-sql-view-from-csharp-enumeration](http://www.olegsych.com/2008/07/t4-template-for-generating-sql-view-from-csharp-enumeration/)

# vb.net - 你如何找到 For Each (VB.NET) 中的最后一个循环？

> ID：376437
> 
> 赞同：27
> 
> 时间：2008-12-17T23:26:36.790
> 
> 标签：vb.net, foreach, for-loop, each

如何确定我是否处于 VB.NET 中 For Each 语句的最后循环中？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2010-10-28T10:12:52.170

通常，您可以在其`For Each`上执行的集合实现[`IEnumerator`](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspx)接口。这个接口只有两个方法，`MoveNext`和`Reset`一个属性，`Current`。

基本上，当您`For Each`在集合上使用 a 时，它会调用该`MoveNext`函数并读取返回的值。如果返回值为`True`，则表示集合中有有效元素，并且元素通过`Current`属性返回。如果集合中没有更多元素，则`MoveNext`函数返回`False`并退出迭代。

从上面的解释中，很明显`For Each`不跟踪集合中的当前位置，因此**您的问题的答案是简短的*No***。

但是，如果您仍然想知道您是否在集合中的最后一个元素上，您可以尝试以下代码。它检查（使用 LINQ）当前项是否是最后一项。

```
For Each item in Collection
    If item Is Collection.Last Then
        'do something with your last item'
    End If
Next 
```

* * *

重要的是要知道调用[`Last()`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.last)集合**将枚举整个集合**。因此不建议调用`Last()`以下类型的集合：

*   流式集合
*   计算昂贵的集合
*   突变倾向高的集合

对于这样的集合，最好为集合获取一个枚举器（通过[`GetEnumerator()`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.ienumerable-1.getenumerator)函数），这样您就可以自己跟踪项目。下面是一个通过扩展方法实现的示例实现，该方法产生项目的索引，以及当前项目是集合中的第一项还是最后一项。

```
<Extension()>
Public Iterator Function EnumerateEx(Of T)(collection As IEnumerable(Of T))
    As IEnumerable(Of (value As T, index As Integer, isFirst As Boolean, isLast As Boolean))

    Using e = collection.GetEnumerator()
        Dim index = -1
        Dim toYield As T

        If e.MoveNext() Then
            index += 1
            toYield = e.Current
        End If

        While e.MoveNext()
            Yield (toYield, index, index = 0, False)
            index += 1
            toYield = e.Current
        End While

        Yield (toYield, index, index = 0, True)
    End Using
End Function 
```

这是一个示例用法：

```
Sub Main()
    Console.WriteLine("Index   Value   IsFirst   IsLast")
    Console.WriteLine("-----   -----   -------   ------")

    Dim fibonacci = {0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89}

    For Each i In fibonacci.EnumerateEx()
        Console.WriteLine(String.Join("   ", $"{i.index,5}",
                                             $"{i.value,5}",
                                             $"{i.isFirst,-7}",
                                             $"{i.isLast,-6}"))
    Next

    Console.ReadLine()
End Sub 
```

**输出**

```
索引值 IsFirst IsLast
----- ----- -------- ------
    0 0 真 假
    1 1 错误 错误
    2 1 错误 错误
    3 2 错误 错误
    4 3 错误 错误
    5 5 错误 错误
    6 8 错误 错误
    7 13 错误 错误
    8 21 错误 错误
    9 34 错误 错误
   10 55 错误 错误
   11 89 错误 正确
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-17T23:34:51.157

使用 For 循环而不是 ForEach 可能会更容易。但是，类似地，您可以在 ForEach 循环中保留一个计数器，看看它是否等于`yourCollection.Count - 1`，那么您就处于最后一次迭代中。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-17T23:41:04.967

使用 foreach，您无法知道这一点，直到为时已晚（即您脱离了循环）。

请注意，我假设您使用的东西只有一个 IEnumerable 接口。如果您有一个列表、数组等，那么请按照此处使用 .Count 或类似的其他答案来找出有多少项目，因此您可以跟踪您在集合中的位置。

但是，仅使用 IEnumerable/IEnumerator，如果您使用 foreach，则无法确定是否还有更多。

如果您需要知道这一点，请自己使用 IEnumerable，这就是 foreach 所做的。

以下解决方案适用于 C#，但应该很容易转换为 VB.NET：

```
List<Int32> nums = new List<Int32>();
nums.Add(1);
nums.Add(2);
nums.Add(3);

IEnumerator<Int32> enumerator = nums.GetEnumerator();
if (enumerator.MoveNext())
{
    // at least one value available
    while (true)
    {
        // make a copy of it
        Int32 current = enumerator.Current;

        // determine if it was the last value
        // if not, enumerator.Current is now the next value
        if (enumerator.MoveNext())
        {
            Console.Out.WriteLine("not last: " + current);
        }
        else
        {
            Console.Out.WriteLine("last: " + current);
            break;
        }
    }
}
enumerator.Dispose(); 
```

这将打印：

```
not last: 1
not last: 2
last: 3 
```

诀窍是获取当前值的副本，然后要求枚举器尝试移动到下一个值。如果失败，则您制作的副本确实是最后一个值，否则还有更多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T23:41:21.330

简短的回答：你不能

长答案： For Each 语句的语义中没有任何内容可以让您确定您是在运行第一次、最后一次还是任何特定的迭代。

For Each 内置于 IEnumerable 和 IEnumerable<> 接口中，其行为取决于您调用的实现。对于您正在迭代的集合以每次都以不同的顺序返回元素，这是有效的，尽管令人困惑。幸运的是， List<> 没有这样做。

如果您确实需要知道特定迭代是最后一个，您可以（提前）识别最后一个元素，然后在遇到该元素时采取不同的操作。

更容易检测第*一次*迭代（例如，通过布尔值），然后做一些不同的事情。

一个例子（C#，但 VB 类似）：

```
StringBuilder result = new StringBuilder();
bool firstTime = true;
foreach(string s in names)
{
    if (!firstTime)
    {
        result.Append(", ");
    }

    result.Append(s);
    firstTime = false;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-10T15:22:51.100

这是一个简单的事情，我不知道它是否在政治上正确，但它有效

```
for each item in listOfThings
   if(item = listOfThings.last)then 
       'you found the last loop
   end if
next 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T23:29:17.563

检查元素是否是容器的最后一个元素。

你为什么要这样做？
您可以在循环之后放置指令。（你在最后一个元素上执行）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-17T23:41:49.257

使用 For 循环而不是 ForEach 会更容易，但是您可以执行类似的操作

```
If item.Equals(itemCollection(itemCollection.Count)) Then
    ...
End If 
```

在您的 ForEach 循环内...假设对象已正确覆盖 Equals 方法。

这可能比仅使用 For 循环或在单独的变量中跟踪当前索引更耗费资源。

我不确定这是否是正确的语法，自从我使用 VB 以来已经很长时间了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-17T23:42:03.467

不能使用标准的“For Each”循环。“for Each”循环的目的是让您专注于数据而不是基础集合。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-27T21:25:57.703

我不断回到这篇文章，所以我决定坐下来思考这个问题，我想出了这个：

```
 For Each obj In myCollection
        Console.WriteLine("current object: {0}", obj.ToString)

        If Object.ReferenceEquals(obj, myCollection.Last()) Then
            Console.WriteLine("current object is the last object")
        End If
    Next 
```

如果您愿意，您甚至可以将`If...Then...End If`语句缩减为一行。我不确定`.Last()`每次迭代调用是否会对性能产生很大影响，但如果这会让你在晚上保持清醒，你总是可以将它分配给循环之外的变量。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-12-20T09:19:39.803

此代码示例可能会有所帮助

```
For Each item in Collection
  If ReferenceEquals(Collection.Item(Collection.Count - 1), item) Then
    'do something with your last item'
  End If
Next 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-17T23:36:34.257

如果您绑定到 IEnumerable。你必须在 foreach 循环内吗？如果不是，您可以在 foreach 循环之前声明一个变量。在循环期间设置它。然后，在循环之后使用它（如果它不为空）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-07-25T13:54:08.540

好吧，解决方法很少假设您正在使用 CheckBoxList

那么这个代码示例可能会有所帮助：

```
Dim count As Integer = 0
Dim totalListCount As Integer = CheckBoxList.Items.Count()
For Each li In CheckBoxList.Items
         count += 1
           // This is the Last Item
      If count = totalListCount THEN
          // DO Somthing.....
      END IF
NEXT 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-11-18T13:12:37.703

```
For Each xObj In xColl
    If xObj = xColl(xColl.Count) Then ...
Next 
```

# c - 在 C 中强制执行强类型检查（typedefs 的类型严格性）

> ID：376452
> 
> 赞同：39
> 
> 时间：2008-12-17T23:33:55.667
> 
> 标签：c, typedef, strong-typing, typechecking

有没有办法对相同类型的 typedef 强制执行显式转换？我必须处理 utf8，有时我对字符数和字节数的索引感到困惑。所以最好有一些 typedef：

```
typedef unsigned int char_idx_t;
typedef unsigned int byte_idx_t; 
```

此外，您需要在它们之间进行显式转换：

```
char_idx_t a = 0;
byte_idx_t b;

b = a; // compile warning
b = (byte_idx_t) a; // ok 
```

我知道 C 中不存在这样的功能，但也许您知道这样做的技巧或编译器扩展（首选 gcc）。

* * *

**编辑** 我仍然不太喜欢匈牙利符号。由于项目编码约定，我无法将它用于这个问题，但我现在在另一个类似的情况下使用它，其中类型也相同并且含义非常相似。我不得不承认：它有帮助。我永远不会去声明每个整数都以“i”开头，但就像 Joel 的重叠类型示例一样，它可以挽救生命。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-17T23:49:54.153

对于“句柄”类型（不透明指针），Microsoft 使用声明结构然后 typedef'ing 指向该结构的指针的技巧：

```
#define DECLARE_HANDLE(name) struct name##__ { int unused; }; \
                             typedef struct name##__ *name 
```

然后代替

```
typedef void* FOOHANDLE;
typedef void* BARHANDLE; 
```

他们是这样：

```
DECLARE_HANDLE(FOOHANDLE);
DECLARE_HANDLE(BARHANDLE); 
```

所以现在，这有效：

```
FOOHANDLE make_foo();
BARHANDLE make_bar();
void do_bar(BARHANDLE);

FOOHANDLE foo = make_foo();  /* ok */
BARHANDLE bar = foo;         /* won't work! */
do_bar(foo);                 /* won't work! */ 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-17T23:45:42.507

您可以执行以下操作：

```
typedef struct {
    unsigned int c_idx;
} char_idx;

typedef struct {
    unsigned int b_idx;
} byte_idx; 
```

然后你会看到你什么时候使用每个：

```
char_idx a;
byte_idx b;

b.b_idx = a.c_idx; 
```

现在更清楚的是它们是不同的类型，但仍然可以编译。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-10-23T16:05:20.933

您想要的称为“强类型定义”或“严格类型定义”。

一些编程语言 [Rust, D, Haskell, Ada, ...] 在语言级别对此提供了一些支持，而 C[++] 则没有。有人提议将其包含在名为“opaque typedef”的语言中，但未被接受。

不过，缺乏语言支持确实不是问题。只需将要别名的类型包装到一个新类中，该类恰好具有 1 个类型为 T 的数据成员。大部分重复可以通过模板和宏来分解。这种简单的技术与直接支持的编程语言一样方便。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-17T23:51:53.463

使用棉绒。请参阅[Splint:Types](http://www.splint.org/manual/html/sec4.html)和 [强类型检查](http://www.gimpel.com/html/strong.htm)。

> 强类型检查通常会发现编程错误。Splint 可以比典型的编译器 (4.1) 更严格、更灵活地检查原始 C 类型，并提供对布尔类型 (4.2) 的支持。此外，用户可以定义提供信息隐藏的抽象类型 (0)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-18T04:21:15.667

在 C 中，**编译器强制执行的**用户**定义类型之间的唯一区别是****structs**之间的区别。任何涉及不同结构的 typedef 都可以使用。您的主要设计问题是**不同的结构类型是否应该使用相同的成员名称？** 如果是这样，您可以使用宏和其他坏血病技巧来模拟一些多态代码。如果不是，你真的致力于两种不同的表现形式。例如，您是否希望能够

 ******```
#define INCREMENT(s, k) ((s).n += (k)) 
```

并`INCREMENT`在两者上`byte_idx`使用`char_idx`？然后以相同的方式命名这些字段。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-26T06:35:45.297

您询问了扩展程序。Jeff Foster 的[CQual](http://www.cs.umd.edu/~jfoster/cqual/)非常好，我认为它可以完成您想要的工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-10-24T17:36:09.940

使用 C++11，您可以使用枚举类，例如

```
enum class char_idx_t : unsigned int {};
enum class byte_idx_t : unsigned int {}; 
```

编译器将强制在两种类型之间进行显式转换；它就像一个薄包装类。不幸的是，您不会有运算符重载，例如，如果您想将两个 char_idx_t 添加在一起，则必须将它们强制转换为 unsigned int。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-17T23:36:57.690

如果您正在编写 C++，您可以创建两个具有不同名称的相同定义的类，它们是 unsigned int 的包装器。我不知道在 C 中做你想做的事的技巧。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-05-02T13:53:20.933

[使用BOOST_STRONG_TYPEDEF](http://www.boost.org/doc/libs/1_50_0/boost/strong_typedef.hpp)中定义的强 typedef

# asp.net - LINQ：无法在具有唯一索引的对象“dbo.tblOutstandingCompletions”中插入重复的键行

> ID：376454
> 
> 赞同：4
> 
> 时间：2008-12-17T23:35:47.910
> 
> 标签：asp.net, sql-server, linq

我有一个应用程序 (ASP.NET 3.5)，它允许用户在需要时重新运行特定进程。该过程将记录插入到 MS SQL 表中。如果记录已经存在，我在 Try / Catch 中插入并忽略捕获（标题中的错误将是有效的）。这使用 ADO 非常有效，但是在我使用 LINQ 之后，我注意到了一件有趣的事情。如果重新运行该过程，表中已经有记录，即使没有现有记录，任何新记录都将被拒绝并出现相同的错误。代码如下：

```
 Dim ins = New tblOutstandingCompletion
            With ins
                .ControlID = rec.ControlID
                .PersonID = rec.peopleID
                .RequiredDate = rec.NextDue
                .RiskNumber = 0
                .recordType = "PC"
                .TreatmentID = 0
            End With

            Try
                ldb.tblOutstandingCompletions.InsertOnSubmit(ins)
                ldb.SubmitChanges()
            Catch ex As Exception
                ' An attempt to load a duplicate record will fail
            End Try 
```

数据库的 DataContext 是在 Page Load 期间设置的。

我通过在每次插入之前重新定义 DataContext 解决了这个问题：

```
 ldb = New CaRMSDataContext(sessionHandler.connection.ToString)
        Dim ins = New tblOutstandingCompletion 
```

虽然我已经解决了这个问题，但我想知道是否有人可以解释它。如果没有重复记录，则没有 DataContext 重新定义应用程序可以完美运行。

问候詹姆斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T14:20:04.287

我在我的代码中看到了一个非常相似的问题，标识列不是自动递增的 int 列，而是默认值为 newguid() 的 GUID - 基本上 LINQ 不允许数据库创建 GUID，但插入 Guid .Empty 代替，第二次（或以后）尝试会（正确地）抛出此错误。

我最终确保在插入过程中自己生成了一个新的 GUID。更多细节可以在这里看到：http: [//www.doodle.co.uk/Blogs/2007/09/18/playing-with-linq-in-winforms.aspx](http://www.doodle.co.uk/Blogs/2007/09/18/playing-with-linq-in-winforms.aspx)

这允许我插入具有相同 DataContext 的多条记录。

另外，您是否尝试过多次调用 InsertOnSubmit（每条新记录一次）但只调用一次 SubmitChanges？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T03:13:21.590

听起来 DataContext 认为记录是第一次插入的，所以如果你不重新定义上下文，它会拒绝第二次插入，因为它“知道”记录已经存在。重新定义上下文会迫使它实际检查数据库以查看它是否存在，而实际上它不存在。那是 LINQ 试图保存到数据库的往返行程。正如你所做的那样创建一个新的上下文会强制它重置它“知道”的关于数据库的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-01T02:03:02.160

gfrizzle 似乎就在这里...

即使我刚刚运行存储过程来截断数据库上的表，我的代码也会因重复键错误而失败。就数据上下文所知，之前插入相同key的记录实际上是重复key，抛出异常。

我发现的唯一方法是：

```
 db = null;
        db = new NNetDataContext(); 
```

在执行先前的 InsertOnSubmit 请求的 SubmitChanges() 调用之后。似乎有点愚蠢，但这是除了重新设计代码之外对我有用的唯一方法。

# python - Python中的字符串连接与字符串替换

> ID：376461
> 
> 赞同：98
> 
> 时间：2008-12-17T23:39:39.930
> 
> 标签：python, string, string-concatenation

在 Python 中，我不知道何时何地使用字符串连接与字符串替换。由于字符串连接的性能有了很大的提升，这（变得越来越）是一种风格上的决定，而不是一个实际的决定吗？

举一个具体的例子，应该如何处理灵活 URI 的构造：

```
DOMAIN = 'http://stackoverflow.com'
QUESTIONS = '/questions'

def so_question_uri_sub(q_num):
    return "%s%s/%d" % (DOMAIN, QUESTIONS, q_num)

def so_question_uri_cat(q_num):
    return DOMAIN + QUESTIONS + '/' + str(q_num) 
```

编辑：还有关于加入字符串列表和使用命名替换的建议。这些是中心主题的变体，即，哪种方式是什么时候做的正确方式？感谢您的回复！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-12-18T00:07:44.600

根据我的机器，连接（显着）更快。但在风格上，如果性能不重要，我愿意付出替代的代价。好吧，如果我需要格式化，甚至不需要问这个问题......除了使用插值/模板之外别无选择。

```
>>> import timeit
>>> def so_q_sub(n):
...  return "%s%s/%d" % (DOMAIN, QUESTIONS, n)
...
>>> so_q_sub(1000)
'http://stackoverflow.com/questions/1000'
>>> def so_q_cat(n):
...  return DOMAIN + QUESTIONS + '/' + str(n)
...
>>> so_q_cat(1000)
'http://stackoverflow.com/questions/1000'
>>> t1 = timeit.Timer('so_q_sub(1000)','from __main__ import so_q_sub')
>>> t2 = timeit.Timer('so_q_cat(1000)','from __main__ import so_q_cat')
>>> t1.timeit(number=10000000)
12.166618871951641
>>> t2.timeit(number=10000000)
5.7813972166853773
>>> t1.timeit(number=1)
1.103492206766532e-05
>>> t2.timeit(number=1)
8.5206360154188587e-06

>>> def so_q_tmp(n):
...  return "{d}{q}/{n}".format(d=DOMAIN,q=QUESTIONS,n=n)
...
>>> so_q_tmp(1000)
'http://stackoverflow.com/questions/1000'
>>> t3= timeit.Timer('so_q_tmp(1000)','from __main__ import so_q_tmp')
>>> t3.timeit(number=10000000)
14.564135316080637

>>> def so_q_join(n):
...  return ''.join([DOMAIN,QUESTIONS,'/',str(n)])
...
>>> so_q_join(1000)
'http://stackoverflow.com/questions/1000'
>>> t4= timeit.Timer('so_q_join(1000)','from __main__ import so_q_join')
>>> t4.timeit(number=10000000)
9.4431309007150048 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-12-18T00:22:59.343

不要忘记命名替换：

```
def so_question_uri_namedsub(q_num):
    return "%(domain)s%(questions)s/%(q_num)d" % locals() 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-18T04:40:07.623

**小心在循环中连接字符串！** 字符串连接的成本与结果的长度成正比。循环将您直接带到 N 平方的土地。某些语言会优化与最近分配的字符串的连接，但指望编译器将您的二次算法优化为线性是有风险的。最好使用原语 ( `join`?)，它接受整个字符串列表，进行一次分配，然后一次性将它们连接起来。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-18T00:18:13.050

“由于字符串连接的性能有了很大的提升......”

如果性能很重要，很高兴知道这一点。

然而，我见过的性能问题从来没有归结为字符串操作。我通常遇到 I/O、排序和 O( *n* ² ) 操作成为瓶颈的麻烦。

在字符串操作成为性能限制器之前，我会坚持使用显而易见的东西。大多数情况下，当它是一行或更少时，它是替换，当它有意义时是连接，当它很大时是一个模板工具（如 Mako）。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-18T00:10:09.900

您想要连接/插值的内容以及您想要如何格式化结果应该会推动您的决定。

*   字符串插值允许您轻松添加格式。实际上，您的字符串插值版本与您的串联版本不同；`q_num`它实际上在参数之前添加了一个额外的正斜杠。要执行相同的操作，您必须`return DOMAIN + QUESTIONS + "/" + str(q_num)`在该示例中进行编写。

*   插值使格式化数字更容易；`"%d of %d (%2.2f%%)" % (current, total, total/current)`串联形式的可读性要低得多。

*   当您没有固定数量的要字符串化的项目时，连接很有用。

另外，要知道 Python 2.6 引入了一个新版本的字符串插值，称为[字符串模板](http://docs.python.org/dev/3.0/whatsnew/2.6.html#pep-3101)：

```
def so_question_uri_template(q_num):
    return "{domain}/{questions}/{num}".format(domain=DOMAIN,
                                               questions=QUESTIONS,
                                               num=q_num) 
```

字符串模板最终将取代 %-interpolation，但我认为这在很长一段时间内不会发生。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-05-13T03:27:35.843

出于好奇，我只是在测试不同字符串连接/替换方法的速度。关于这个主题的谷歌搜索把我带到了这里。我想我会发布我的测试结果，希望它可以帮助某人做出决定。

```
 import timeit
    def percent_():
            return "test %s, with number %s" % (1,2)

    def format_():
            return "test {}, with number {}".format(1,2)

    def format2_():
            return "test {1}, with number {0}".format(2,1)

    def concat_():
            return "test " + str(1) + ", with number " + str(2)

    def dotimers(func_list):
            # runs a single test for all functions in the list
            for func in func_list:
                    tmr = timeit.Timer(func)
                    res = tmr.timeit()
                    print "test " + func.func_name + ": " + str(res)

    def runtests(func_list, runs=5):
            # runs multiple tests for all functions in the list
            for i in range(runs):
                    print "----------- TEST #" + str(i + 1)
                    dotimers(func_list) 
```

...运行后`runtests((percent_, format_, format2_, concat_), runs=5)`，我发现 % 方法在这些小字符串上的速度大约是其他方法的两倍。concat 方法总是最慢的（几乎没有）。在方法中切换位置时存在非常微小的差异`format()`，但切换位置总是比常规格式方法慢至少 0.01。

测试结果样本：

```
 test concat_()  : 0.62  (0.61 to 0.63)
    test format_()  : 0.56  (consistently 0.56)
    test format2_() : 0.58  (0.57 to 0.59)
    test percent_() : 0.34  (0.33 to 0.35) 
```

我运行这些是因为我确实在我的脚本中使用了字符串连接，我想知道成本是多少。我以不同的顺序运行它们，以确保没有任何干扰，或者首先或最后获得更好的性能。附带说明一下，我在这些函数中加入了一些更长的字符串生成器，例如`"%s" + ("a" * 1024)`，常规 concat 的速度几乎是使用`format`and`%`方法的 3 倍（1.1 对 2.8）。我想这取决于字符串以及您要实现的目标。如果性能真的很重要，那么尝试不同的东西并测试它们可能会更好。我倾向于选择可读性而不是速度，除非速度成为问题，但这只是我。所以不喜欢我的复制/粘贴，我必须在所有内容上放置 8 个空格以使其看起来正确。我一般用4。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-18T01:04:35.500

请记住，如果您计划维护或调试您的代码，风格决策*是*实际的决策 :-) Knuth 有一句名言（可能引用 Hoare？）：“我们应该忘记小的效率，比如说大约 97% 的时间：过早的优化是万恶之源。”

只要你小心不要（比如说）将 O(n) 任务变成 O(n ² ) 任务，我会选择你认为最容易理解的那个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-17T23:56:12.457

我尽可能使用替代。如果我在说for循环中建立一个字符串，我只使用连接。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-08-20T03:56:37.653

实际上正确的做法是，在这种情况下（构建路径）是使用`os.path.join`. 不是字符串连接或插值

# asp.net - ASP.Net 资源文件

> ID：376468
> 
> 赞同：2
> 
> 时间：2008-12-17T23:44:46.393
> 
> 标签：asp.net, resources, selenium

我正在使用 selenium 在我们当前应用程序的 UI 上运行一些功能测试。

我想确保 Web 项目中资源文件中的字符串在正确的时间和地点显示。

简单（我认为）我所要做的就是引用 Web 应用程序的程序集，并断言从 UI 读取的文本 selenium 与相应资源文件中的测试相匹配。

问题是 ASP.Net 对资源文件进行了一些预编译处理并将它们编译成一个名为 App_GlobalResources 的程序集，该程序集不是由正常的构建过程创建的，因此功能测试失败，因为找不到要查找的 App_GlobalResources 程序集字符串从。

那么，有什么建议吗？我是否需要放弃 App_GlobalResources 方法并做一些我可以控制的手动操作？

您了解问题还是我需要提供更多信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T02:06:02.490

我的临时解决方案是使用 SVN:Externals 将 resx 文件的副本提取到测试项目中。

然后我可以通过

```
ResourceManager 资源 = new System.Resources.ResourceManager("My.Web.Namespace.resources.ImageUrls", Assembly.GetExecutingAssembly());

```

它很难看，因为我已经有了对 webproject 的引用（我现在可能可以删除它......）而且我不喜欢在项目之间混合源文件。感觉就像是自找麻烦，但除非有人提出更好的建议，否则必须这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:42:15.867

您是否考虑过将您的 GlobalResources 移动到一个单独的程序集中，然后从您的 Web 项目和测试项目中引用它？这在 VS 2008 中很容易做到，并且可以实现，但在 VS 2005 中有点困难。

我能够使用这种方法解决类似的问题。

# asp.net-mvc - maproute、querystings 和 mvc

> ID：376471
> 
> 赞同：0
> 
> 时间：2008-12-17T23:46:33.240
> 
> 标签：asp.net-mvc, model-view-controller, routing, query-string, maproute

我有两条路线：

```
routes.MapRoute(
            "FetchVenue",                                     
            "venue/fetchlike/{q}",                                     
            new { controller = "venue", action = "fetchlike" }      
        );

        routes.MapRoute(
            "venue",                                         
            "venue/{venueId}",                                 
            new { controller = "Venue", action = "Index" }   
); 
```

url /venue/fetchlike/test 被传递给正确的控制器 url /venue/fetchlike/?q=test 然而被传递给 index 动作。

我希望能够将数据作为查询字符串传递。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T18:57:44.750

实际上问题在于路线：

```
 routes.MapRoute( "FetchVenue", "venue/fetchlike/{q}",  new { controller = "venue", action = "fetchlike" }); 
```

实际上应该是：

```
 routes.MapRoute( "FetchVenue", "venue/fetchlike",  new { controller = "venue", action = "fetchlike" }); 
```

这意味着该网址将是：

/venue/fetchlike?q=test

正如上面 strelokstrelok 所建议的那样。

因此，在查询参数的情况下，您不要在路由中定义它们！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T23:49:24.590

就在我的脑海中，你的 URL 不应该是这样的`/venue/fetchlike?q=test`，而不是`/venue/fetchlike/?q=test`

# jsp - 抽象一个安全的.jsp 页面的功能？

> ID：376474
> 
> 赞同：0
> 
> 时间：2008-12-17T23:47:35.577
> 
> 标签：jsp

有一个网页可以让服务提供商检查客户的保险有效性。该页面包括一个用于输入客户保险号码的文本框、一个用于发送号码以供检查的按钮以及一个显示结果的框架。这是一个java服务器页面，它是https。正如您可能会说的那样，我对这些东西一无所知。我想做的是直接从我的程序中检查数字？有没有办法透明地做到这一点，而不必可能通过利用网页的源向用户显示网页？如果是这样，有人能指出我正确的方向吗谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T00:24:10.293

您需要做的是让您的程序向该 URL 发送一个 HTTPS POST 请求，然后您需要解析返回的 HTML，以提取您感兴趣的结果。

但是，大概服务提供商必须登录才能访问该页面。因此，您需要提供者的登录详细信息（例如提示用户输入），另外您还需要向服务器发送登录请求（可能是另一个 HTTP POST）。您还将捕获登录页面返回的结果（可能是 cookie），因此您可以正确设置下一个请求并将其与属于该服务提供商的会话相关联。如果他们当时正在使用该站点上的浏览器，这反过来可能会导致服务提供商被注销。

所以这可能是可能的，但充其量是非常不愉快的。

取决于您的编程环境的另一种解决方案可能是以编程方式驱动浏览器控件（可能显示在屏幕外）来执行相同的登录和表单发布，然后解析生成的 HTML。这仍然会很丑陋，但可以使您的代码不必假装成网络浏览器。

在您尝试任何这些之前，值得检查该站点是否具有可供程序访问的 Web 服务 API，或者他们是否愿意提供一个。

# asp.net - ASP.NET - 单个大型 Web 请求触发 System.OutOfMemoryException - 仍有大量可用内存

> ID：376475
> 
> 赞同：1
> 
> 时间：2008-12-17T23:49:01.800
> 
> 标签：asp.net, iis, memory-management, iis-6

环境：Windows 2003 Server（32位）；IIS6、ASP.NET 2.0 (3.5)；4Gb 内存；1 个工作进程

我们有一种情况，我们有一个非常大的 System.XmlDocument 被加载到内存中，然后它进入一个已编译的 XSL 转换。发生的情况是，当 Web 请求进入服务器时，服务器处于空闲状态，可用系统内存为 2500Mb。

随着 XML DOM 被填充，可用内存减少了大约 500Mb，此时我们会收到 System.OutOfMemoryException 事件。此时系统理论上应该仍有 2000Mb 的可用内存可用于服务请求（根据 Perfmon）。

我的相关问题是：

1）在堆栈中的哪个级别满足内存不足限制？操作系统？IIS？ASP.NET？工作进程？这是每个单独的 Web 请求限制吗？

2）这个限制可以在某处配置吗？

3) 为什么这个 Web 请求不能访问全部可用的系统内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T01:59:51.363

1）我会猜测工作进程，但这应该可以在 IIS 中配置为工作进程可以使用的内存限制。另一个因素是您的软件使用的位级别，例如 32 位的物理限制为 4 GB，因为这是总地址空间。

2) 可能但不要忘记，内存碎片可能比您想象的更快地耗尽内存，例如，如果有一个连续 1000 Mb 内存的内存请求，那么这可能不一定在当前记忆。

3）您是否检查过转储数据以查看抛出异常时内存中的内容？如果没有，有一些方法可以获取内存的快照以查看它的外观，因为这可能会为您提供更多关于正在发生的事情的线索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T04:19:45.480

3.  你正在一个进程中运行。一个进程只能访问 2 gigs 的内存。这个任务与这个进程中运行的所有其他东西共享内存，所以这段代码没有得到完整的 2 gig——即使它是可用的。操作系统上也有一个 3 gig 开关。我相信这是一个注册表设置。但是您必须搜索 MSDN 才能找到该信息。

但实际上，您需要以另一种方式执行此操作。可能通过切换到 SAX 样式的 xml 解析器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T23:59:06.740

我敢肯定这里有一些聪明的头脑可以回答你的具体问题，但你有没有问过自己是否有另一种方法可以做你想做的事？我的具体意思是您可能不想处理非常大的 XML 文档，但您可能更具体地希望将某些内容返回给客户端。您是否可以重写代码来完全避免这个 XML 文档，或者可能不会同时将其全部加载到内存中，并且仍然产生相同的最终结果？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T00:02:06.080

1）不知道。检查您的日志。
2) IIS 限制分配给网站/应用程序池的内存。检查您的设置。
3）服务器都是关于正常运行时间的；如果一个应用程序占用了其他人遭受的所有资源。这就是为什么像 IIS 这样的企业应用程序会限制内存以防止失控者破坏整个服务器。

# .net - 启用 Ajax 的 WCF 服务能否将 DataTable 作为 Sys.Data.DataTable 传回？

> ID：376477
> 
> 赞同：1
> 
> 时间：2008-12-17T23:49:46.993
> 
> 标签：.net, asp.net, wcf, asp.net-ajax

启用 Ajax 的 WCF 服务能否将 DataTable 作为 Sys.Data.DataTable 传回？像[这样](http://aspadvice.com/blogs/garbin/archive/2006/03/05/15591.aspx)，但在 WCF 中。

我的 OperationContract 看起来像：

```
 [OperationContract]
    public DataTable GetEmployees()
    {
        NorthwindService ns = new NorthwindService();
        return ns.GetEmployees();
    } 
```

通过 Firefox 错误控制台，我收到消息：
*错误：找不到元素
源文件：[http://localhost:4845/TestWcfAjax/SomeService.svc/GetEmployees](http://localhost:4845/TestWcfAjax/SomeService.svc/GetEmployees)*

如果我在浏览器中输入这个 URL（上面），我会得到：
*不允许的方法。*

我有另一种方法，它只返回一个可以通过 WCF/ASP.NET Ajax 工作的字符串。
想法？排除故障的想法？

**编辑/添加**代码后面的代码中没有代码：
代码不知道如何以可读方式将代码粘贴到此处
代码位于此处： http:
[//www.mirc.org/paste/92](http://www.mirc.org/paste/92)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T23:54:30.680

您会收到`Method not allowed`错误，因为 Web 服务调用的默认 HTTP 谓词是 POST，而当您在 Web 浏览器中键入 URL 时，谓词是 GET。使用 HTTP 调试器工具，例如 Fiddler 来模拟 POST 请求。还显示调用此服务的代码，以便我们看到问题所在。

PS。另外据我所知，我认为您不能只从 Web 服务调用返回 DataTable，您需要将它放在 DataSet 中，以便正确序列化。

> 好的，我认为 GET 动词是个问题。有什么方法可以允许 GET 请求进行故障排除？是否有客户端 Sys.Data.DataSet ？我已经安装了提琴手，我会试试的。– Bruno Tyndall（9 分钟前）[删除此评论]

不，没有客户端 DataSet 结构，您只会得到可以解析的 XML。要启用 GET 而不是 POST，请使用以下附加属性装饰您的操作：

```
[ WebInvoke( Method = "GET", BodyStyle = WebMessageBodyStyle.Bare,
  RequestFormat = WebMessageFormat.Xml,
  ResponseFormat = WebMessageFormat.Xml ) ] 
```

# c# - VMware VIX API 是否有 C# 包装器？

> ID：376479
> 
> 赞同：7
> 
> 时间：2008-12-17T23:50:06.307
> 
> 标签：c#, api, vmware, wrapper, vix

我在 Windows Vista x64 上使用 VMware Workstation 6.5。我想自动化一些虚拟机管理任务。我知道有一个可以直接使用的 COM API ( [http://www.vmware.com/support/developer/vix-api/ )。](http://www.vmware.com/support/developer/vix-api/)

此 COM API 是否有 C# 包装器？

谢谢，

阿尼

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-23T23:30:16.603

现在有一个很好的库来包装这个： http: [//www.codeproject.com/KB/library/VMWareTasks.aspx](http://www.codeproject.com/KB/library/VMWareTasks.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-15T12:45:13.327

VMWareTasks 是 VixCOM 的完整包装器：http: [//vmwaretasks.codeplex.com](http://vmwaretasks.codeplex.com)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T00:08:47.437

阿尼兹。

任何 COM DLL 都可以从 .NET 中使用。在 Visual Studio 中添加它作为参考将生成一个名为

“YourDll.Interop.dll”

这是一个 .NET -> COM 编组库，可以满足您的需求。

您也可以使用 tlbimp.exe 从命令行生成它

当然，您必须记住您正在调用 COM 组件，并记住在使用完它们时使用 .NET Marshaling API 来减少引用计数，否则会导致内存泄漏。

我已经将互操作实现包装在另一个库中，该库在其对象上实现 IDisposable，以便之前自动处理清理，但如果它是一个大型库，那么这可能不值得。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T23:52:40.527

如何在你的 VS.Net 中添加对这个 API 的引用并让 VS.Net 为你创建一个托管包装器？我不知道有任何“托管”API。让我知道你是否找到它:)

# c# - 更新数据库中网页的查看次数

> ID：376502
> 
> 赞同：3
> 
> 时间：2008-12-18T00:04:24.733
> 
> 标签：c#, .net, asp.net, asp.net-mvc

我有一个名为“Posts”的数据库表，它存储有关网站上文章提交的所有信息。有一个名为“Views”的列，每次查看特定帖子时都会增加一个值。

过程是这样的：

1.  从数据库中获取记录
2.  电流加一
3.  将更改保存到数据库。

很简单。我担心的是，如果多个人同时单击该链接，则更新将不准确。我应该如何处理这个？这应该只在存储过程中完成吗？

```
 /// <summary>
    /// Updates the view count of a post.
    /// </summary>
    /// <param name="postId">The Id of the post to update</param>
    public bool UpdateViewCount(int postId)
    {
        Repository repository = new Repository();
        Post p = repository.Posts.Where(p => p.Id == postId).SingleOrDefault();
        if (p != null)
        {
            p.Views++;
        }
        repository.SubmitChanges(System.Data.Linq.ConflictMode.ContinueOnConflict);
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T00:08:36.610

一口气完成：

```
UPDATE table SET views=views+1 WHERE myId=12; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T01:50:36.127

如果您的数据库上下文称为 _db，您可以使用它。

```
_db.ExecuteCommand("UPDATE posts SET views=views+1 WHERE id={0}", postId); 
```

如需进一步阅读，请在此处查看顾的帖子。

[http://weblogs.asp.net/scottgu/archive/2007/08/27/linq-to-sql-part-8-executing-custom-sql-expressions.aspx](http://weblogs.asp.net/scottgu/archive/2007/08/27/linq-to-sql-part-8-executing-custom-sql-expressions.aspx)

# vb6 - Microsoft 补丁 958369 MS08-070 破坏了我的 VB6 应用程序（类型不匹配 - 动态创建的控件）

> ID：376504
> 
> 赞同：6
> 
> 时间：2008-12-18T00:05:07.883
> 
> 标签：vb6, winsock

我们用上面列出的微软补丁升级了我们的机器，现在遇到了一些 winsock 控件的问题。在继续使用新的组件库时，我们面临两个问题：

*   我们正在使用 Form.Controls.Add(...) 动态创建 Winsock 控件。使用新的 dll，它给了我们一个运行时错误 731，说明我们需要添加许可证。

此问题已通过在添加控件之前添加一行 License.Add(PrgID of the control) 得到解决。

现在的问题是，当我们尝试将此控件设置为 mWinsock 类型的对象时，我们会收到运行时错误类型不匹配。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T13:48:07.780

请查看“Visual Basic 6.0 Service Pack 6 运行时扩展文件的累积更新汇总说明”。

[http://support.microsoft.com/kb/957924/](http://support.microsoft.com/kb/957924/)

此 2008 年 12 月 30 日更新应删除并替换有故障的 12 月 9 日安全更新。它似乎同时处理 926857 和 957924。

958369 似乎是针对同一错误更新（12 月 9 日）的 Visual FoxPro 知识库文章。VFP 使用许多 VB 控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T18:16:22.780

您可能需要将控件添加到工具箱中，以便 VB6 项目和窗体具有对其的正确引用。即使您在设计时实际上没有在表单上也需要这样做。

参考 VB 可能没有在运行时解析控件的方法和属性所需的所有信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T08:01:10.267

由于接口签名已更改，您必须从项目中删除组件引用，完全保存并关闭 VB6，注销旧控件，从补丁中注册新版本，重新打开项目并重新添加组件。如果您这样做你很可能会失去对没有安装补丁的机器的支持（或者你必须将它作为安装包的一部分安装）

当然，如果更容易，您始终可以将引用声明为“作为对象”，但您的性能会下降一点，并且您将失去对 WithEvents 的支持

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-02T19:58:06.683

在 VB6 中动态创建非内在控件时，我遇到了类似的问题。也许 Winsock 不再被认为是内在的。尝试将变量声明为 VBControlExtender 而不是 Winsock，如下所示：

```
Option Explicit
Dim WithEvents objExt As VBControlExtender

Private Sub LoadControl()
   Licenses.Add "MSWinsockLib.Winsock", "xydsfasfjewfe"
   Set objExt = Controls.Add("MSWinsockLib.Winsock", "myCtl")
End Sub

Private Sub extObj_ObjectEvent(Info As EventInfo)
   ' Program the events of the control using Select Case.
   Select Case Info.Name
     Case "DataArrival"
       ' Do stuff
   End Select
End Sub 
```

有关详细信息，请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa277578(VS.60).aspx)。

# openxml - Word 2007，Open XML - 嵌入图像

> ID：376506
> 
> 赞同：6
> 
> 时间：2008-12-18T00:07:30.827
> 
> 标签：openxml, wordprocessingml, drawingml

你知道什么基本信息必须`<w:p/>`在 *.docx 文档中的 document.xml 中包含一个段落 ( ) 来指定一个图像吗？我知道必须有：

```
<a:blip r:embed="rId4" /> 
```

指定关系 ID，但还有什么？在 Google 中很难找到它，并且尝试从准备好的文档中删除标签或阅读规范需要花费大量时间。

一个包含所有必需标签的示例将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T00:35:28.790

Word 对提供的输入 XML 相当挑剔。要嵌入图像，您必须提供相当多的信息。这是一个简单的例子：

文档.xml

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" 
            xmlns:v="urn:schemas-microsoft-com:vml" 
            xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" 
            xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
  <w:body>
    <w:p>
      <w:r>
        <w:drawing>
          <wp:inline distT="0" distB="0" distL="0" distR="0">
            <wp:extent cx="5943600" cy="3717290"/>
            <wp:docPr id="1" name="Picture 0" descr="vlcsnap-325726.png"/>
            <a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">
              <a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture">
                <pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">
                  <pic:nvPicPr>
                    <pic:cNvPr id="0" name="myImage.png"/>
                    <pic:cNvPicPr/>
                  </pic:nvPicPr>
                  <pic:blipFill>
                    <a:blip r:embed="rId4"/>
                    <a:stretch>
                      <a:fillRect/>
                    </a:stretch>
                  </pic:blipFill>
                  <pic:spPr>
                    <a:xfrm>
                      <a:off x="0" y="0"/>
                      <a:ext cx="5943600" cy="3717290"/>
                    </a:xfrm>
                    <a:prstGeom prst="rect">
                      <a:avLst/>
                    </a:prstGeom>
                  </pic:spPr>
                </pic:pic>
              </a:graphicData>
            </a:graphic>
          </wp:inline>
        </w:drawing>
      </w:r>
    </w:p>
  </w:body>
</w:document> 
```

文档.xml.rels

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  <!-- other relationships go here -->
  <Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="media/image1.png"/>
</Relationships> 
```

当然，必须将图像添加到包中的正确位置（media/image1.png）

由于这一切都相当复杂，我建议您使用 Microsoft 提供的[OpenXML SDK 2.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6E744E5-36E9-45F5-8D8C-331DF206E0D0)或其他库，例如[OpenXML4J](http://www.openxml4j.org/)。这些库，尤其是来自 Microsoft 的库，可以让您的工作轻松很多。

# ruby - 如何让 ruby 打印完整的回溯而不是截断的回溯？

> ID：376513
> 
> 赞同：196
> 
> 时间：2008-12-18T00:11:34.110
> 
> 标签：ruby, exception, stack-trace

当我得到异常时，它通常来自调用堆栈的深处。发生这种情况时，通常情况下，实际的违规代码行对我来说是隐藏的：

```
tmp.rb:7:in `t': undefined method `bar' for nil:NilClass (NoMethodError)
        from tmp.rb:10:in `s'
        from tmp.rb:13:in `r'
        from tmp.rb:16:in `q'
        from tmp.rb:19:in `p'
        from tmp.rb:22:in `o'
        from tmp.rb:25:in `n'
        from tmp.rb:28:in `m'
        from tmp.rb:31:in `l'
         ... 8 levels...
        from tmp.rb:58:in `c'
        from tmp.rb:61:in `b'
        from tmp.rb:64:in `a'
        from tmp.rb:67 
```

那个“...... 8个级别......”截断给我带来了很多麻烦。我在谷歌上搜索这个没有多大成功：我如何告诉 ruby​​ 我希望转储包含完整堆栈？

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2008-12-18T00:17:38.887

Exception#backtrace 包含整个堆栈：

```
def do_division_by_zero; 5 / 0; end
begin
  do_division_by_zero
rescue => exception
  puts exception.backtrace
  raise # always reraise
end 
```

（灵感来自 Peter Cooper 的[Ruby Inside](http://www.rubyinside.com/21-ruby-tricks-902.html)博客）

* * *

## 回答 #2

> 赞同：195
> 
> 时间：2011-10-11T09:52:03.067

如果你想要一个简单的单线，你也可以这样做：

```
puts caller 
```

* * *

## 回答 #3

> 赞同：106
> 
> 时间：2011-02-16T14:41:48.503

这会产生错误描述和干净整洁的缩进堆栈跟踪：

```
begin               
 # Some exception throwing code
rescue => e
  puts "Error during processing: #{$!}"
  puts "Backtrace:\n\t#{e.backtrace.join("\n\t")}"
end 
```

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2009-06-26T21:48:55.473

IRB 对这个可怕的“功能”有一个设置，您可以自定义它。

创建一个名为的文件`~/.irbrc`，其中包含以下行：

```
IRB.conf[:BACK_TRACE_LIMIT] = 100 
```

这将允许您`irb`至少在 中看到 100 个堆栈帧。我无法找到非交互式运行时的等效设置。

有关 IRB 自定义的详细信息可以在[Pickaxe 书中](http://www.rubycentral.com/book/irb.html)找到。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-02-07T19:22:33.547

调用堆栈的一个衬垫：

```
begin; Whatever.you.want; rescue => e; puts e.message; puts; puts e.backtrace; end 
```

没有所有宝石的调用堆栈的一个衬垫：

```
begin; Whatever.you.want; rescue => e; puts e.message; puts; puts e.backtrace.grep_v(/\/gems\//); end 
```

一个调用堆栈的衬垫，没有所有的宝石，并且相对于当前目录

```
begin; Whatever.you.want; rescue => e; puts e.message; puts; puts e.backtrace.grep_v(/\/gems\//).map { |l| l.gsub(`pwd`.strip + '/', '') }; end 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2016-02-24T11:48:43.187

这模仿了官方的 Ruby 跟踪，如果这对你很重要的话。

```
begin
  0/0  # or some other nonsense
rescue => e
  puts e.backtrace.join("\n\t")
       .sub("\n\t", ": #{e}#{e.class ? " (#{e.class})" : ''}\n\t")
end 
```

有趣的是，它没有正确处理“未处理的异常”，将其报告为“RuntimeError”，但位置是正确的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-03-31T20:24:44.633

我在尝试加载我的测试环境（通过 rake 测试或自动测试）时遇到了这些错误，而 IRB 的建议没有帮助。我最终将我的整个 test/test_helper.rb 包装在一个 begin/rescue 块中，然后解决了问题。

```
begin
  class ActiveSupport::TestCase
    #awesome stuff
  end
rescue => e
  puts e.backtrace
end 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-08-10T05:15:52.490

几乎每个人都回答了这个问题。我将任何 rails 异常打印到日志中的版本是：

```
begin
    some_statement
rescue => e
    puts "Exception Occurred #{e}. Message: #{e.message}. Backtrace:  \n #{e.backtrace.join("\n")}"
    Rails.logger.error "Exception Occurred #{e}. Message: #{e.message}. Backtrace:  \n #{e.backtrace.join("\n")}"
end 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-01-23T19:00:52.513

**[检查所有线程回溯以找出罪魁祸首]**
当您使用多个线程时，即使完全扩展的调用堆栈仍然可以隐藏实际的违规代码行！

示例：一个线程正在迭代 ruby​​ Hash，另一个线程正在尝试修改它。繁荣！例外！尝试修改“忙碌”哈希时获得的堆栈跟踪的问题在于，它向您显示函数链到您尝试修改哈希的位置，但它不显示当前谁在并行迭代它（谁拥有它）！这是通过打印所有当前正在运行的线程的堆栈跟踪来解决这个问题的方法。下面是你如何做到这一点：

```
# This solution was found in comment by @thedarkone on https://github.com/rails/rails/issues/24627
rescue Object => boom

    thread_count = 0
    Thread.list.each do |t|
      thread_count += 1
      err_msg += "--- thread #{thread_count} of total #{Thread.list.size} #{t.object_id} backtrace begin \n"
      # Lets see if we are able to pin down the culprit
      # by collecting backtrace for all existing threads:
      err_msg += t.backtrace.join("\n")
      err_msg += "\n---thread #{thread_count} of total #{Thread.list.size} #{t.object_id} backtrace end \n"
    end

    # and just print it somewhere you like:
    $stderr.puts(err_msg)

    raise # always reraise
end 
```

上面的代码片段即使仅用于教育目的也很有用，因为它可以向您显示（如 X 射线）您实际拥有的线程数（相对于您认为自己拥有的线程数 - 通常这两个是不同的数字；）

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-10-12T12:11:51.043

你也可以使用[backtrace](https://github.com/yegor256/backtrace) Ruby gem（我是作者）：

```
require 'backtrace'
begin
  # do something dangerous
rescue StandardError => e
  puts Backtrace.new(e)
end 
```

# pattern-matching - 以编程方式比较两行（股票模式匹配）

> ID：376516
> 
> 赞同：3
> 
> 时间：2008-12-18T00:15:10.700
> 
> 标签：pattern-matching, stocks

我想做的是采用某种股票模式（定义为一系列 x 和 y 坐标）并将其与历史股票价格进行比较。如果我在历史价格中发现任何与我定义的模式相似的东西，我想将其作为匹配项返回。

我不确定如何确定两条曲线的相似程度。我做了一些研究，你可以找到两条直线的相似性（使用线性回归），但我还没有找到比较两条曲线的好方法。

我现在最好的方法是从我正在查看的历史数据范围中获取几个高点和低点，找到线的斜率，然后将它们与我试图匹配的模式的斜率进行比较，看看它们是否'大致相同。

有更好的想法吗？我很想听听他们的声音！

**编辑：**感谢您的输入！我之前考虑过最小二乘法，但我不确定该去哪里。不过，在我收到输入之后，我认为首先计算每条线的最小二乘以稍微平滑数据，然后像 James 建议的那样缩放和拉伸模式应该可以得到我想要的东西。

我计划使用它来识别股票中的某些技术标志以确定买卖信号。已经有一些网站在某种程度上可以做到这一点[（例如 stockfetcher）](http://www.stockfetcher.com)，但我当然想自己尝试一下，看看是否可以做得更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T00:38:43.150

计算每个点上残差（y 差）的总最小二乘。这应该为您提供几何拟合的度量（它们看起来有多相似）。然后，您应该能够为“足够相似”设置一些容差。

见[http://en.wikipedia.org/wiki/Curve_fitting](http://en.wikipedia.org/wiki/Curve_fitting)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T02:34:30.857

数学不是我的强项，但是您也许可以使用[**Correlation**](http://en.wikipedia.org/wiki/Correlation)。

计算两个数据集之间的相关值，如果相关性大于某个值（0.8？），则认为这两个数据集*足够*相似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T00:27:23.063

一种想法可能是采用不同时间范围的移动平均线（每周、数月、数年；每周数月、数年等），并将它们与现在的移动平均线进行比较。

单个平均值也可以让您更轻松地进行比较。如果平均值中的连续项目采用某种标准化形式（例如从 0..1 考虑拆分等），您可以将向量中的连续元素相互比较一些范围`epsilon`，并获得比赛的潜力。

只是一个想法。

Mathworld ( [http://mathworld.wolfram.com/](http://mathworld.wolfram.com/) ) 也应该有一些曲线比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T00:30:50.983

问题之一是使用非线性函数的曲线拟合并不总是适用于您的某些模式，具体取决于它们的复杂程度。您可以使用二次或三次或其他多项式的阶数来获得更准确的结果，但它并非在所有情况下都有效，尤其是在数据随时间发生任何急剧变化的情况下。

老实说，我认为一个合理且相对简单的解决方案是“缩放”和“拉伸”您的模式，使其与历史数据出现在相同的范围内。您可以对 x 轴使用插值，对 y 轴使用乘法加偏移。之后，只需查看每个点的平方差的平均值，如果低于阈值，则可以认为它是匹配的。它需要进行一些调整才能获得可预测的结果，但我认为这是一种很好的方法，它应该允许您定义任何类型的模式，而无需依赖回归产生良好拟合的曲线。本质上它只是统计的应用。您还可以查看标准偏差或方差以获得更全面的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T00:33:39.917

或者看看衍生品？

理论上，股票价格运动通常被建模为带有漂移因子的布朗运动。（我知道的很少，但是看看[这里](http://en.wikipedia.org/wiki/Black-Scholes#Notation)）

如果你不介意我问，那可能是什么目的？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T21:11:06.130

最小二乘并不是你能做的最好的。使用 RANSAC 算法。它会处理这种数据，因为这种数据非常不可预测，而且经常是嘈杂的。

# sql - 如何在包含最大值的表中找到记录？

> ID：376518
> 
> 赞同：11
> 
> 时间：2008-12-18T00:17:07.360
> 
> 标签：sql, datetime, select, group-by, max

虽然这个问题看起来很简单，但它有点棘手。

我有一个包含以下列的表格：

```
table A:
  int ID
  float value
  datetime date
  varchar(50) group 
```

我想获取包含按“组”列分组的最大“日期”的记录的“ID”和“值”。诸如**“每个组的最新值是多少？”**

我可以获得每个组及其最大日期：

`SELECT group, MAX(date) FROM A GROUP BY group; -- I also need the "ID" and "value"`

但我想知道日期最高的记录的“ID”和值。

在 A 和结果之间进行 JOIN 可能是答案，但无法知道 MAX(date) 指的是哪条记录（以防“日期”重复）。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-18T00:25:22.723

您可以尝试使用子查询

```
从 A 中选择组、ID、值、日期，其中日期在
( 选择 MAX(date) 作为日期
  从一个
  一组一组）
按组排序

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T01:24:11.857

这正是分析函数的用途：

```
select group,
       id,
       value
from   (
       select group,
              id,
              value,
              date,
              max(date) over (partition by group) max_date_by_group
       from A
       )
where  date = max_date_by_group 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T03:17:44.203

如果日期是唯一的，那么您已经有了答案。如果日期不是唯一的，那么您需要一些其他的唯一性。如果没有自然密钥，您的 ID 与任何密钥一样好。只需在其上放一个 MAX（或 MIN，无论您喜欢哪个）：

```
SELECT *
FROM A
JOIN (
    --Dedupe any non unqiue dates by getting the max id for each group that has the max date
    SELECT Group, MAX(Id) as Id
    FROM A 
    JOIN (
        --Get max date for each group
        SELECT group, MAX(date) as Date 
        FROM A 
        GROUP BY group
    ) as MaxDate ON
        A.Group = MaxDate.Group
        AND A.Date = MaxDate.Date
    GROUP BY Group
) as MaxId ON
    A.Group = MaxId.Group
    AND A.Id= MaxId.Id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T00:26:38.090

只要 Date 列对于每个组都是唯一的，我认为这样的事情可能会起作用：

```
SELECT A.ID, A.Value
FROM A
  INNER JOIN (SELECT Group, MAX(Date) As MaxDate FROM A GROUP BY Group) B
    ON A.Group = B.Group AND A.Date = B.MaxDate 
```

# security - 类似调度的 CGI 方法

> ID：376519
> 
> 赞同：0
> 
> 时间：2008-12-18T00:17:37.607
> 
> 标签：security, redirect, permissions, operating-system, cgi

意见：我想禁止通过操作系统级别的 Web（Linux）直接调用某些脚本，这些脚本具有从菜单访问的功能。

我希望调用一个 authorize.pl 脚本来检查会话有效性、检查用户权限等。然后它将重定向到目标脚本。

这是否绕过权限？我可以限制对公共目标脚本的执行，但将目标脚本设置为可访问的组`authorize.pl`吗？这是否反映了当前的任何做法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-18T01:14:58.117

如果您计划重定向到与 authorize.pl 所属组无关的目标脚本，则这些脚本必须可由网络服务器用户执行。

为什么要在操作系统级别执行此操作？使用在每个脚本中进行检查的普通旧的基于会话的授权是标准做法。

与其调用 authorize.pl 并重定向到目标，不如创建一个名为 Authorization.pm 的模块并在每个脚本中使用它，首先调用一个验证函数。如果不存在正确的凭据，此函数将重定向到登录页面（或采取其他适当的操作）。

类似的东西

```
use Authorize qw{validate}; #Your module
use CGI::Session;
use strict;
use warnings;

my $sess = new CGI::Session();
validate($sess->param('user_token'));

#Unreachable code if session is empty or invalid

#Rest of the code ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T03:07:04.537

我们在考虑（1）我们可以预编译授权脚本以提高速度，（2）我们可以批发阻止具有数据库功能的脚本请求以提高安全性。但是我明白您的意思，必须将权限设置为用户执行才能使脚本与客户端通信：当通过授权客户端浏览器请求目标脚本将位置重定向打印给用户时。

# c# - 使用来自 LINQ to SQL 查询的数据填充 Excel

> ID：376524
> 
> 赞同：4
> 
> 时间：2008-12-18T00:18:33.237
> 
> 标签：c#, winforms, linq, excel, ole

我正在尝试使用 OLE 将 C# 中的 LINQ 查询中的一些数据发送到 Excel 速度表

我有一个这样的查询：

```
Var data = from d in db.{MyTable}
           where d.Name = "Test"
           select d; 
```

我的 Excel OLE 对象工作正常，我只是不知道如何用来自 LINQ 查询的数据填充 Excel 中的单元格。

PS：如果这有什么不同，我正在使用 Excel 2003。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T02:42:15.023

为每个 Excel 单元格发送单独的 OLE 命令非常慢，因此关键是创建一个对象数组，如下所示：

```
int noOfRows = data.Count - 1;
int noOfColumns = mydataclass.GetType().GetProperties().Count() - 1;
Object[noOfRows, noOfColumns] myArray; 
```

发送对象数组允许您发送混合数据类型，例如字符串、整数、日期等。但是，如果您知道数据都是文本，例如，您可以只发送字符串数组。

需要通过分配每个单独的值或使用反射来获取数据对象属性，从查询中填充数组。然后您可以像这样将数组发送到 Excel：

```
XLOLESheetobj.Range("A1","Z20").Value = myArray; 
```

您可以用列数 -> Char + 行数 -> 字符串替换 Z20。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T00:28:38.273

我假设您没有在 Web 场景中使用 OLE，因为它最终会失败。

如果您只需要原始数据，可以转储到制表符分隔的文本文件：

var lines = data.Select(d => d.Name + '\t' + d.AnotherProperty + ...);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T01:06:11.723

您最好的选择是使用 Excel XML 格式。我写了一篇关于如何实现这一目标的博客文章：[http ://www.aaron-powell.com/blog.aspx?id=1237](http://www.aaron-powell.com/blog.aspx?id=1237)

您的另一个选择是查看 Excel 的 LINQ 提供程序 - [http://www.codeplex.com/xlslinq](http://www.codeplex.com/xlslinq)。

# css - 如何制作纯 CSS 下拉列表（网站导航）

> ID：376536
> 
> 赞同：4
> 
> 时间：2008-12-18T00:25:27.327
> 
> 标签：css

试图制作一个运行良好的纯 css 下拉列表，但找不到任何好的资源。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T00:57:05.920

[A List Apart](http://www.alistapart.com)是一个很好的资源，这是他们的看法：[下拉菜单，水平样式](http://www.alistapart.com/articles/horizdropdowns/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T00:29:27.507

也许你可以在[http://css.maxdesign.com.au/index.htm](http://css.maxdesign.com.au/index.htm)找到你想要的东西。对不起，如果它不起作用（但有很多不同的列表......）！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T01:04:53.033

GRC 有一个可免费使用的[纯 CSS 菜单系统](http://www.grc.com/menudemo.htm)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T00:55:10.247

*   [pixelspread：CSS 下拉菜单](http://pixelspread.com/blog/289/css-drop-down-menu)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T01:29:46.417

Suckerfish的儿子是最好的之一

[http://www.htmldog.com/articles/suckerfish/dropdowns/](http://www.htmldog.com/articles/suckerfish/dropdowns/) [http://htmldog.com/articles/suckerfish/](http://htmldog.com/articles/suckerfish/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T00:57:52.003

我是[Free CSS Drop-Down Menu Framework](http://www.lwis.net/free-css-drop-down-menu/)的粉丝，虽然[这个](http://www.tjkdesign.com/articles/keyboard_friendly_dropdown_menu/default.asp)框架具有很好的可访问性（支持 tab 键来导航列表）

# networking - 我可以使用 WMI 来查找每个进程的网络使用情况吗？

> ID：376541
> 
> 赞同：6
> 
> 时间：2008-12-18T00:27:51.753
> 
> 标签：networking, wmi, io, disk

我想在某些 Windows 系统上使用 WMI 来轮询每个进程的网络使用情况。据我所知，Win32_PerfRawData_PerfProc_Process 中有许多 IO 实例，但它们用于网络、磁盘和设备的组合 IO。有没有办法打破它，以便我可以将网络和磁盘 IO 分开？

# mysql - Grails MySQL MaxPoolSize

> ID：376544
> 
> 赞同：6
> 
> 时间：2008-12-18T00:28:44.730
> 
> 标签：mysql, grails

使用mysql时如何增加Grails中的maxPoolSize？它似乎使用默认连接池只有 8 个连接。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T10:43:02.557

不幸的是，如果您想获得对它的更多控制，您将需要自己配置 dataSource spring bean。这可以通过在“grails-app/conf/spring/resources.groovy”中定义 bean 来完成

```
beans = {

   dataSource(org.apache.commons.dbcp.BasicDataSource) {
      driverClassName = "com.mysql.jdbc.Driver"
      username = "someuser"
      password = "s3cret"
      initialSize = 15
      maxActive = 50
      maxIdle = 15
   }

} 
```

它将覆盖在“grails-app/conf/DataSource.groovy”中配置的默认 Grails DataSource。

* * *

可能它也应该像这样利用 PropertyOverrideConfigurer（在 Config.groovy 中）覆盖默认 grails DataSource.groovy 配置的池大小属性：

```
beans = {
   dataSource.initialSize = 15
   dataSource.maxActive = 50
   dataSource.maxIdle = 15
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-04-01T06:09:30.833

对于 grails 1.2，您应该使用稍微不同的格式：

```
dataSource {
    pooled = true
    dbCreate = "update"
    url = "jdbc:mysql://localhost/yourDB"
    driverClassName = "com.mysql.jdbc.Driver"
    username = "yourUser"
    password = "yourPassword"
    properties {
        maxActive = 50
        maxIdle = 25
        minIdle = 5
        initialSize = 5
        minEvictableIdleTimeMillis = 60000
        timeBetweenEvictionRunsMillis = 60000
        maxWait = 10000     
    }   
} 
```

# svn - 如何使用 svn+ssh 协议签出 Subversion 存储库？

> ID：376551
> 
> 赞同：8
> 
> 时间：2008-12-18T00:31:51.243
> 
> 标签：svn, ssh

我正在尝试使用 svn+ssh 协议通过命令行（“svn co”命令）签出存储库。我需要以与当前用户不同的用户身份结帐。该命令`svn co svn+ssh://username@server/repo/`是有意义的，但是当它提示输入密码时，它永远不会接受它。

如何使用不同的用户通过 svn+ssh 签出存储库？

编辑以澄清一个问题，这是题外话：我正在尝试创建一个脚本来将网站更新到当前版本。这是脚本失败的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T00:46:24.273

您可能会将您的 SVN 用户名与您的帐户名混淆：仅当您在包含存储库的服务器上拥有真实帐户时才能使用 svn+ssh。是这样吗？您可以在该服务器上使用 ssh 登录吗？如果是这样，则可能是服务器上的配置问题。

另一方面，如果您的问题是您当前的用户名是（比如说）dave，而您的 SVN 用户名是 david，那么您不应该使用 svn+ssh；只需使用标准的 svn 协议，在提示输入密码时输入一次 Enter（SVN 将忽略它）。然后 SVN 会询问您的用户名：输入 david，然后在提示时输入密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T17:12:42.513

好吧，这是解决方案。

颠覆服务器多次要求输入密码。这对我来说似乎很愚蠢，但那是 SVN。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-14T15:12:16.913

尝试这个：

```
svn checkout svn+ssh://your.remote-server.com/home/svn/test 
```

# php - PHP - 我应该怎样称呼存储在我的 Page 类中的信息？

> ID：376557
> 
> 赞同：1
> 
> 时间：2008-12-18T00:37:40.780
> 
> 标签：php, oop

我有一个名为 Page 的类，它有一个当前调用的私有属性`_pageData`，它存储所有信息（如标题、内容、关键字等）。

但是，当我提到它时，这对我来说并不那么好`$this->_pageData`。我想想一个更好的名字，我想可能会有一个标准或“最佳实践”的名称/前缀/后缀来处理这些事情。我想到了“_assets”。

请问您过去使用过什么，一个明确的名称并没有让您走上正轨，向其中添加一些数据然后去“哦不，现在我的数组中有数据超出了变量名称的范围” . 这在我身上发生过几次，所以我想看看什么被证明是有效的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T00:49:12.567

```
class Page {
    public $title = '';
    public $keywords = array();
    public $content = '';
    // etc.
}

$page = new Page();
echo '<title>' . $page->title . '</title>';
echo $page->content; 
```

或者您可以使用访问器/get-set 等来保护您的数据，允许通过持久性对其进行修改，等等。这允许延迟初始化和延迟写入（不确定后者是否有合适的术语）。例子：

```
class Page {
    private $data = array('title' => '', 'keywords' => array(), 'content' => '');

    public __get($name) {
        if(isset($this->data[$name]))
            return $this->data[$name];

        /* You probably want to throw some sort of PHP error here. */
        return 'ERROR!';
    }
}

$page = new Page();
echo '<title>' . $page->title . '</title>';
echo $page->content; 
```

（有关详细信息，请参阅[PHP5 手册中的重载](http://php.net/manual/en/language.oop5.overloading.php)。）

请注意，您可以隐藏 $data 成员，甚至可以修改它们或添加新成员（例如，$page->contentHTML 可以将 markdown 转换为 HTML）。

对于 Page 类，使用名称`_pageData`是多余的。你已经知道它是一个页面，所以你在重复信息（$currentPage->_pageData vs. $currentPage->data）。

我还发现关联数组对于这类事情有点混乱，但如果你想要一个真正动态的系统，它们可能是必需的。无论如何，您可以实现您的模板系统以通过名称 ( ) 访问类成员`$member = 'title'; echo $page->$member; // echoes $page->title`，假设这是您想要的数组（而不是简单的数据库查询，您可以使用 list() ）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T00:48:47.967

这是非常具体的，我认为没有“标准”或“最佳实践”。随便叫它你认为最好的名字。在我自己的情况下，我会简单地称它为“数据”，因为 Page 是类，$this = Page，所以是 Page->Data。这对我来说就足够了。

我想不出更好的名字……也许因为你使用了 _ 前缀，这听起来很奇怪？我不喜欢使用那些前缀，特别是在 PHP 中，它没有多大意义，但这只是我。

# java - OpenID Java

> ID：376561
> 
> 赞同：34
> 
> 时间：2008-12-18T00:39:54.317
> 
> 标签：java, jsp, tomcat, openid

Java中有openID实现吗？我想在 tomcat 应用程序中使用它。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-18T00:41:17.060

[openid4java](https://github.com/jbufu/openid4java)库似乎是最受欢迎的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-18T03:13:55.723

我研究过的唯一一个是[OpenID4Java ，在](http://code.sxip.com/openid4java/)[http://wiki.openid.net/Libraries](http://wiki.openid.net/Libraries)上列出了更多选项。

我建议查看[TheServerSide.COM上的](http://www.theserverside.com)[Using OpenID](http://www.theserverside.com/tt/articles/article.tss?l=OpenID)以获得一些有价值的代码片段的良好介绍。

目前，我倾向于使用[mod_auth_openid](http://trac.butterfat.net/public/mod_auth_openid)在 Web 层实现身份验证和授权。但是仍然让我的应用程序成为那些不想知道他们正在使用 OpenID 的人的身份验证提供程序。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-12-14T22:41:30.827

我自己也一直在寻找这个。以下是我的发现：

*   OpenId4Java 不在 Google App Engine 上运行。它产生新线程
*   JOpenId 不做发现，我怀疑它是做 DH-1 或 DH-256 来建立关联。

我还没有找到可以在 GAE 上使用的通用 java openid 2.0 提供程序。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-23T08:42:06.070

[Spring Security](http://static.springsource.org/spring-security/site/index.html)也提供了一种 OpenID 身份验证方法

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-18T11:42:47.910

如果您不介意使用服务，可以使用[RPX](http://rpxnow.com)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-31T13:16:33.030

我目前在 Tomcat 的 Grails 应用程序中使用 Openid4Java，它运行良好。下载站点 code.sxip.com 上的（非常旧的）二进制文件存在一些问题，即它根本不适用于 Yahoo 或 myopenid.com 实现。如果您想使用它，您可以在 Google 组的项目中找到二进制文件，或者从 Subversion 存储库获取源代码并从那里构建它。这很简单，基本上只是你需要运行的一个 ant 脚本。

# asp-classic - 如何确定默认文档是否在传统 ASP 中提供？

> ID：376566
> 
> 赞同：2
> 
> 时间：2008-12-18T00:45:16.477
> 
> 标签：asp-classic, default-document

在一个名为 index.asp 的文件中，该文件在 IIS 中设置为目录的默认文档，我试图通过 .asp VBScript 确定页面是否被称为默认文档而不是直接按名称调用，即我是试图在服务器端区分这两种情况：

[http://someurl/](http://someurl/)

[http://someurl/index.asp](http://someurl/index.asp)

我知道如何在 ASP.NET 中执行此操作，但似乎没有相同的“服务器变量”。处理 URL 和脚本名称（PATH_INFO、SCRIPT_NAME、URL）的服务器变量都返回“index.asp”，而不管脚本被调用的方式。

谷歌搜索达不到这一点。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T01:24:24.603

服务器不会知道，但客户端会。在 JavaScript 中，您可以检查`location.href`，然后使用 Ajax 调用将该值传递回服务器，以获取所需的任何日志记录机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T02:18:28.003

与之前的答案类似，但创建一个新页面，将其命名为 homepage.asp，它具有 #INCLUDE FILE="index.asp" 或让它执行 index.asp 的 server.transfer 或 server.execute 将保存请求.ServerVariables 脚本名称在 homepage.asp 中作为请求对象，一旦它被传递到 ASP 中就不会更改脚本名称。然后你可以只测试这个值，你就不必依赖referrer或进行重定向。这仍然意味着您必须更改默认文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T01:01:41.230

这个怎么样...
创建一个新文件 IndexDefault.asp 并将其设置为默认文档
在 IndexDefault.asp 中使其重定向到 Index.asp
在 IndexDefault.asp 中检查 IndexDefault.asp 的引用者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T04:41:54.813

Diodeus 是正确的，客户端 JavaScript 似乎是检测 URL 的唯一方法。所有其他选项都需要将内容页面和默认文档页面区分为单独的文件。我真正想做的就是将这两个请求压缩为默认文档 URL（在直接请求 index.asp 的情况下重定向）。

为了满足这是一个单一的、插入式代码的要求，我最终使用了这个 JavaScript 块：

```
<script language="javascript" type="text/javascript">
var loc = window.location.href;
var re = /\/index.asp/i;
if (loc.search(re) != -1) {
    window.location.href = loc.replace (re,"/"); 
}
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-14T02:30:25.630

Request.ServerVariables("REQUEST_URI").item 将为您提供客户端请求的原始 url，包括查询字符串部分。

它在 Request.ServerVariables 集合中不可枚举，并且没有一致地记录在案，但它在 IIS 10 中对我有用。我在这里找到了它：[https ://docs.microsoft.com/en-us/iis/web-dev-reference /服务器变量](https://docs.microsoft.com/en-us/iis/web-dev-reference/server-variables)

# c# - 是否有在 Web 应用程序中访问业务逻辑服务的最佳实践？

> ID：376570
> 
> 赞同：4
> 
> 时间：2008-12-18T00:49:06.670
> 
> 标签：c#, .net, architecture, web-applications

是否有在 Web 应用程序中实例化/调用业务逻辑层服务的最佳实践？我有大量的服务，我不断地实例化它们，然后只为一个方法调用进行处理。

这些应该作为提供者实施吗？或者可能从单例访问？

示例代码：

```
void ShipProduct(){
  ProductService service = new ProductService();
  service.Ship(aProduct);
} 
```

显然它比这复杂得多，我只是不知道我是否在到处创建这些服务的新实例时做错了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T01:20:52.627

我会警惕单身人士。它经常在并不总是需要的地方被滥用。如果一次应该只有一个该类的实例，则应该只使用单例。在此示例中，仅当您想一次只执行一个 Ship() 操作时才使用单例。

我经常使用的一种模式是为类中的服务创建一个私有的只读字段，该字段可能如下所示：

```
public ShippingController
{
    private readonly ProductService productService;

    public ShippingController(ProductService service)
    {
         productService = service;
    }        

    void ShipProduct(Product aProduct)   
    {
        service.Ship(aProduct);
    }
} 
```

至少这样，您不受任何决定的约束，您可以创建一个在整个应用程序中使用的全局 ProductService，或者您可以创建一个新实例并将其传入，这样您就可以两全其美.

至于哪种方式更好，就看你的情况了。仔细考虑使用您的服务的确切要求是什么，并相应地实施。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T01:22:29.473

我总是发现最好在应用程序层之间进行松散耦合，因此我建议您在服务客户端代码 ( `ProductService`) 和调用它的代码之间引入某种程度的抽象。

在很多情况下（我不确定这是否是您的情况）任何给定的团队都可以以类似产品的方式访问应用程序的任何其他层。换句话说，另一个团队可能拥有业务层，并且可能会在您的层代码中引入重大更改。

我建议您创建一个服务客户端工厂来实例化客户端对象，并从您的工厂返回仅公开您选择的成员的自定义接口类型。这不仅为您提供了松散耦合，还为您提供了在中心位置配置和调整客户端对象的灵活性。

废话不多说，代码如下：

```
using System;

// this is your interface that will create the 
// loose coupling that you want
interface IProduct { void Ship(); }

// make sure you generate your proxy code with
// partial classes so you can then create your 
// own parial class to implement the interface
partial class ProductService : IProduct
{
    public void Ship()
    {
        // in here you would do validation
        // and other things and then call the
        // real ship method on the client
    }
}

static class Factory
{
    public static IProduct GetProduct()
    {
        // configure away...do 
        // whatever you need to do...

        return new ProductService() as IProduct;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T01:21:38.117

对于我会问的一个简单的网络应用程序，我会问这个问题：调用之间是否有任何给定的服务有状态（包括到数据库的连接对象等）？

*   是）每次调用都实例化
*   否）使用单例服务

如果服务在调用之间保持状态，那么它就不是线程安全的。如果它在调用之间没有保持任何状态，那么它就是。最终你必须考虑线程安全。单个服务是否适用于同时调用它的多个客户？

无论您以哪种方式实现它，我都会使用工厂模式来实现一定程度的多态性并将服务的实例化与实现分开。考虑以下伪 C# 代码：

```
public static class ServiceFactory
{
  public static T GetService<T>()
  {
    //either instantiate a new service 
    //or retrieve singleton service here base on type T
  }
} 
```

这使您可以在一个地方将任何服务更改为有状态或单例服务或从其中更改任何服务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-18T00:55:26.890

我实际上都做过。这取决于您要实现的目标。如果您想增加代码的简洁性，对您尝试调用的服务的单例/静态引用会有所帮助。

```
Services.ProductService.Ship(aProduct) 
```

但是，您必须记住，您放入单例中的任何不是自然单例的东西都会造成人为的瓶颈。如果您的服务的构建/处置不是资源密集型的（如果它仅包含业务逻辑则不会），我会继续做您正在做的事情。

此外，创建一个您真正不需要的架构会使代码更难遵循。这都是一个判断电话。

希望有帮助！

# xml - XML Schema：具有仅包含文本的属性的元素？

> ID：376582
> 
> 赞同：142
> 
> 时间：2008-12-18T00:59:26.260
> 
> 标签：xml, xsd

我很难找到这个。我如何在 XML 模式文件中为 XML 定义一个元素，如下所示：

```
<option value="test">sometext</option> 
```

我不知道如何定义一个类型`xs:string`且也具有属性的元素。

这是我到目前为止所得到的：

```
<xs:element name="option">
    <xs:complexType>
        <xs:attribute name="value" type="xs:string" />
    </xs:complexType>
</xs:element> 
```

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2008-12-18T02:18:29.983

尝试

```
 <xs:element name="option" type="AttrElement" />

  <xs:complexType name="AttrElement">
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="value" type="xs:string">
        </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType> 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-11-03T23:50:18.417

...或内联等效项：

```
<xs:element name="option">
  <xs:complexType>
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="value" type="xs:string" />
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
</xs:element> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-21T17:49:10.347

我知道它不一样，但它对我有用：

```
<xsd:element name="option">
    <xsd:complexType mixed="true">
        <xsd:attribute name="value" use="optional" type="xsd:string"/>
    </xsd:complexType>
</xsd:element> 
```

# lucene - 文件分数

> ID：376585
> 
> 赞同：0
> 
> 时间：2008-12-18T01:02:07.720
> 
> 标签：lucene

我正在尝试阅读 lucene 搜索结果的文档分数。

当我使用以下方法时，我通过 hits 对象获得一组文档分数： Hits hits = IndexSearcher.search(myQuery);

但是，如果我使用该方法： searcher.search(myQuery, hitsCollector);

我通过 hitCollector.hits 对象获得了一组完全不同的文档分数

我在这里错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T22:40:46.430

Hits 对象返回的分数是标准化的，即它们始终在 [0, 1] 范围内，最高分数接近或等于 1。给予 HitCollector 对象的分数是原始的，即未标准化。此外，Hits 对象中的文档列表按分数递减排序。HitCollector 对象以某种随机顺序获取文档分数对。

# sqlite - 同一个sqlite数据库的不同连接可以同时开始事务吗？

> ID：376589
> 
> 赞同：7
> 
> 时间：2008-12-18T01:02:52.430
> 
> 标签：sqlite, transactions

我遇到了一个关于 sqlite3 的奇怪问题。我使用 open() 方法获得了同一个数据库文件的不同连接。连接 1 开始一个事务，连接 2 开始另一个事务，即更新一个表的几条记录。然后连接 1 提交事务，然后连接 2 提交其事务。但是我发现连接2的更新命令实际上从来没有更新数据库中的记录。在此过程中没有抛出异常。我不知道为什么会出现问题。谁能给我解释一下原因？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-18T01:13:31.300

如果您阅读 SQLite 文档，您会看到它支持多个只读连接，您不能从多个连接写入数据库，因为它不是为此而设计的。

[http://www.sqlite.org/faq.html#q5](http://www.sqlite.org/faq.html#q5)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-18T01:21:34.297

除非您使用 BEGIN IMMEDIATE 来启动您的事务，否则您将面临不得不回滚并重试它们的风险。BEGIN 不做任何锁定；随后的 UPDATE 或 INSERT 获得锁，您需要检查结果代码以查看它们是否失败。[请参阅有关事务](http://www.sqlite.org/lang_transaction.html)的此页面和有关[锁定](http://www.sqlite.org/lockingv3.html)的此页面。

# ado.net - ADO.NET DataReader 是读取整行，还是只读取您“获取”的列？

> ID：376598
> 
> 赞同：2
> 
> 时间：2008-12-18T01:06:42.843
> 
> 标签：ado.net

如果我做这样的事情：

```
using (SqlCommand cmd = new SqlCommand("SELECT * FROM TBL"))
{
    using (SqlDataReader reader = cmd.ExecuteReader())
    {
        while (reader.Read())
        {
            string s = reader.GetString(7);
        }
    }
} 
```

Read() 调用是否将整行读取到内存中，或者 GetString(7) 调用是否意味着读取器只读取第 7 列中的数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T01:10:21.417

它在读取操作中读取整行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-20T08:03:46.103

读取操作读取整行。行的大小由您的 select 语句确定。所以，如果你有一千列并且只想要 4，你可以在你的选择中这样做。另一方面，如果第 1 列是 Y，则需要 5 列，如果是 N，则需要 8 列，那么您很不走运，单个`select * from table`.

无法完成的原因是对数据库的调用尽可能快地发回数据流（结果集），两者之间没有进一步的通信，即使有，也必须是在 UNSENT 行上，因为当前行已经发送和接收。要执行您所说的操作，需要在每列上进行双向通信，除非在真正特殊的情况下，否则会降低性能。即使在行的基础上这样做通常也是低效的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-21T06:42:39.213

我认为您正在寻找数据读取器的[ExecuteScalar](http://www.devguru.com/features/tutorials/AdoNet/AdoNet3.asp)方法，并且您想在 sql 命令中指定列。

# excel - 如何将 Trac 工单导出到 MS Excel，包括工单描述和格式？

> ID：376609
> 
> 赞同：7
> 
> 时间：2008-12-18T01:15:59.173
> 
> 标签：excel, export, trac

我需要能够将 Trac 票证从报告或自定义查询导出到 Excel，包括票证描述。问题是描述必须按照 wiki 语法定义的格式进行格式化，而不是显示原始文本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-30T09:37:49.803

您可以转到“查看工单”并选择“自定义查询”，然后选择所有要查看的列。不会有“描述”列，因为它可能是 wiki 格式，因此它只能作为“行”选项使用。但是您仍然可以手动编辑查询，并在其中添加：&col=description，因此您将拥有“未格式化”的描述作为表格列。

比选择下载为逗号分隔文本，然后在 Excel 中打开它;-)

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T09:48:49.690

我有同样的问题。我试过 ExcelExportPlugin，但它并不比以 CSV 格式导出好。特别是，它不格式化“描述”。

我有更好的运气保存整个 HTML 报告，隔离 html 表，并将其作为 html 文件导入 Excel：它很好地保留了所有格式。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-23T22:47:13.353

我在上面的 ANDreaT 提供的技术上取得了很好的成功。我要做的唯一补充就是强调您无法达到可以将“&col=description”添加到查询的地步是在您单击底部的“保存查询”按钮之后现有报告。

希望这可以节省您花费我的几分钟。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-27T18:52:44.493

不幸的是，似乎无法将工单导出到 MS Excel，包括工单描述的正确格式。这似乎是 Excel（单元格中的 HTML 格式）而不是 Trac 本身的限制。

# compiler-construction - 为什么解释的语言大多是鸭式的，而编译的语言有强类型？

> ID：376611
> 
> 赞同：46
> 
> 时间：2008-12-18T01:19:41.977
> 
> 标签：compiler-construction, programming-languages, interpreted-language

我只是不知道，这有什么技术原因吗？为弱类型的语言实现编译器是否更难？它是什么？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2008-12-18T03:23:11.650

**问题背后的前提有点狡猾**。解释语言大多是鸭式的，这是不正确的。编译语言大多具有强类型是不正确的。**类型系统是一种语言的**属性。 **编译与解释是*实现*的属性。**

例子：

*   编程语言 Scheme 是动态类型的（又名鸭子类型），它有许多解释实现，但也有一些优秀的本机代码编译器，包括 Larceny、Gambit 和 PLT Scheme（其中包括*解释*器和 JIT 编译器）无缝过渡）。

*   编程语言 Haskell 是静态类型的；两个最著名的实现是解释器 HUGS 和编译器[GHC](http://www.haskell.org/ghc)。在编译为本机代码 (yhc) 和解释 (Helium) 之间，还有其他几个值得尊敬的实现。

*   编程语言 Standard ML 是静态类型的，它有许多本机代码编译器，其中最好和最积极维护的编译器之一是[MLton](http://www.mlton.org/)，但最有用的实现之一是解释器 Moscow ML

*   编程语言 Objective Caml 是静态类型的。它只有一个实现（来自法国的 INRIA），但这个实现包括*解释*器和本机代码编译器。

*   编程语言 Pascal 是静态类型的，但它在 1970 年代开始流行，因为 UCSD 构建了基于 P 代码解释器的出色实现。在后来的几年中，可以使用精细的本机代码编译器，例如用于 370 系列计算机的 IBM Pascal/VS 编译器。

*   编程语言 C 是静态类型的，今天几乎所有的实现都是编译的，但在 1980 年代，我们这些有幸使用 Sabre C 的人正在使用解释器。

不过**，您的问题背后有一些道理**，因此您应该得到更深思熟虑的答案。事实是，**动态类型语言似乎确实与解释实现相关**。为什么会这样？

*   许多新语言是由实现定义的。构建解释器比构建编译器更容易。动态检查类型比静态检查更容易。而且，如果您正在编写解释器，则静态类型检查几乎没有性能优势。

*   除非您正在创建或调整一个非常灵活的多态类型系统，否则静态类型系统可能会妨碍程序员。但是，如果您正在编写解释器，一个原因可能是创建一个小型、轻量级的实现，它不会妨碍程序员。

*   在某些解释型语言中，**许多基本操作非常昂贵，以至于在运行时检查类型的额外开销并不重要。** PostScript 就是一个很好的例子：如果你要跑掉并立即栅格化 Bezier 曲线，你不会犹豫在这里或那里检查类型标签。

顺便提一下，请**注意术语“强”和“弱”类型**，因为它们没有普遍认可的技术含义。相比之下，**静态类型**意味着程序**在执行之前会被检查**，并且程序在启动之前可能会被拒绝。 **动态类型**意味着***在*****执行期间****检查*****值****的类型，并且类型不佳的操作可能会导致程序停止或以其他方式**在运行时发出错误信号。**. 静态类型的一个主要原因是排除可能有这种“动态类型错误”的程序。（这是编写解释器的人通常对静态类型不太感兴趣的另一个原因；执行在类型检查之后立即发生，因此保证的区别和性质不那么明显。）*

 ***强类型**一般意味着类型系统**没有漏洞**，而**弱类型**意味着类型系统可以被颠覆（使任何保证失效）。这些术语经常被错误地用于表示静态和动态类型。要看到区别，想想 C：该语言在编译时进行类型检查（静态类型），但有很多漏洞；您几乎可以将任何类型的值转换为相同大小的另一种类型——特别是，您可以自由地转换指针类型。Pascal 是一种旨在进行强类型化的语言，但众所周知的是有一个无法预料的漏洞：没有标签的变体记录。

随着时间的推移，强类型语言的实现经常会出现漏洞，通常使得运行时系统的一部分可以用高级语言实现。例如，Objective Caml 有一个被调用的函数`Obj.magic`，它具有简单地返回其参数的运行时效果，但在编译时它将任何类型的值转换为任何其他类型的值。我最喜欢的例子是 Modula-3，其设计者将他们的类型转换构造称为`LOOPHOLE`。

总之：

*   **静态与动态是*语言***。

*   **编译与解释是*实现***。

*   原则上**，这两个选择可以并且是正交**的，但是出于合理的技术原因，**动态类型经常与解释相关联**。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-18T01:32:05.443

您进行早期绑定（强类型）的原因是性能。使用早期绑定，您可以在编译时找到方法的位置，以便在运行时它已经知道它所在的位置。

但是，对于后期绑定，您必须去寻找一个看起来像客户端代码调用的方法的方法。当然，由于程序中有很多很多方法调用，这就是动态语言“慢”的原因。

但是可以肯定的是，您可以创建一种进行后期绑定的静态编译语言，这会否定静态编译的许多优点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-18T02:21:22.117

这很大程度上是因为编写和使用解释型语言的人更喜欢鸭式，而开发和使用编译型语言的人更喜欢强显式类型。（我认为对此的共识原因将是 90% 用于防止错误，10% 用于性能。）对于今天编写的大多数程序，速度差异将是微不足道的。Microsoft Word 已经在 p 代码（未编译）上运行了 - 什么 - 15 年了？

我能想到的最好的例子。经典的 Visual Basic (VB6/VBA/etc.) 相同的程序可以用 VB 编写，并以相同的结果和相当的速度运行，无论是编译还是解释。此外，您可以选择是否使用类型声明（实际上是变量声明）。大多数人更喜欢类型声明，通常是为了防止错误。我从来没有听说过或读过任何地方使用类型声明来提高速度。这至少可以追溯到硬件速度和容量的两个数量级。

谷歌最近受到了很多关注，因为他们为 javascript 开发了 JIT 编译器——这不需要对语言进行任何更改，也不需要程序员进行任何额外的考虑。在这种情况下，唯一的好处就是速度。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-18T01:31:42.357

因为编译语言需要在编译时考虑使用的内存量。

当你看到类似的东西时：

```
int a 
```

在 C++ 中，编译器会输出保留四个字节内存的代码，然后分配本地符号“a”以指向该内存。如果您有像 javascript 这样的无类型脚本语言，则解释器会在幕后分配所需的内存。你可以做：

```
var a = 10;  // a is probably a four byte int here
a = "hello world"; // now a is a 12 byte char array 
```

这两条线之间发生了很多事情。解释器删除 a 处的内存，为字符分配新缓冲区，然后分配 a var 指向该新内存。在强类型语言中，没有解释器可以为您管理，因此编译器必须编写考虑到类型的指令。

```
int a = 10; // we now have four bytes on the stack.
a = "hello world"; // wtf? we cant push 12 bytes into a four byte variable! Throw an error! 
```

所以编译器会停止编译该代码，这样 CPU 就不会盲目地将 12 个字节写入四字节缓冲区并造成痛苦。

编译器编写额外指令来处理类型的额外开销会显着降低语言速度，并消除 C++ 等语言的优势。

:)

-纳尔逊

**编辑回应评论**

我对Python不太了解，所以我不能说太多。但是松散的类型会大大减慢运行时间。解释器 (VM) 调用的每条指令都必须进行评估，并在必要时将 var 强制转换为预期的类型。如果你有：

```
mov a, 10
mov b, "34"
div a, b 
```

然后解释器必须确保 a 是一个变量和一个数字，然后它必须在处理指令之前将 b 强制转换为一个数字。为虚拟机执行的每条指令加上开销，你手上就会一团糟:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-18T02:36:22.990

使用静态类型而不是鸭子类型基本上有两个原因：

1.  静态错误检查。
2.  表现

如果你有一种解释语言，那么就没有编译时间来进行静态错误检查。有一个优势。此外，如果您已经拥有解释器的开销，那么该语言已经不会用于任何对性能至关重要的事情，因此性能参数变得无关紧要。这就解释了为什么静态类型的解释语言很少见。

反过来说，duck 类型可以在很大程度上在静态类型语言中进行模拟，而不会完全放弃静态类型的好处。这可以通过以下任何方式完成：

1.  模板。在这种情况下，如果您实例化模板的类型支持从模板中调用的所有方法，则您的代码可以编译并工作。否则它会给出编译时错误。这有点像编译时的鸭子类型。
2.  反射。您尝试按名称调用方法，它要么正常工作，要么引发异常。
3.  标记工会。这些基本上是其他类型的容器类，它们包含一些内存空间和一个描述当前包含的类型的字段。这些用于代数类型之类的东西。当一个方法被调用时，它要么工作要么抛出，这取决于当前包含的类型是否支持它。

这就解释了为什么很少有动态类型的编译语言。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-18T01:25:49.873

我猜测具有动态（鸭子）类型的语言采用惰性评估，这受到惰性程序员的青睐，而惰性程序员不喜欢编写编译器;-)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-18T01:33:14.990

弱类型的语言可以被编译，例如 Perl5 和 Lisp 的大多数版本都是编译语言。然而，编译的性能优势往往会丢失，因为语言运行时必须执行的大部分工作是确定动态变量在特定时间真正具有的类型。

以 Perl 中的以下代码为例：

```
$x=1;
$x="hello";
print $x; 
```

编译器显然很难确定 $x 在给定时间点真正具有的类型。在打印声明时，需要做一些工作来解决这个问题。在静态类型语言中，类型是完全已知的，因此可以提高运行时的性能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-18T02:47:31.860

某些语言旨在在非异常条件下完美运行，而牺牲了它们在异常条件下遇到的可怕性能，因此非常强大的类型。其他人只是为了平衡它与额外的处理。

有时，除了打字之外，还有更多的事情在发挥作用。以 ActionScript 为例。3.0 引入了更强大的类型，但 ECMAScript 再次允许您在运行时根据需要修改类，并且 ActionScript 支持动态类。非常简洁，但是他们说动态类不应该在“标准”构建中使用这一事实意味着当您需要安全使用它时，这是一个禁忌。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-18T01:30:48.460

一个推测：

在编译语言中，一个系统（编译器）可以看到执行强类型所需的所有代码。口译员通常一次只能看到一小部分程序，因此不能进行那种交叉检查。

但这并不是一个硬性规定——创建一种强类型的解释语言是很有可能的，但这会违背解释语言的那种“松散”的一般感觉。

# c# - C#：如何将 Combobox 之类的项目列表保存到 .NET 设置文件中？

> ID：376622
> 
> 赞同：5
> 
> 时间：2008-12-18T01:25:50.200
> 
> 标签：c#

C#：如何将 Combobox 之类的项目列表保存到 .NET 设置文件中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-18T05:05:12.160

设置设计器允许您使用的唯一集合类型是 System.Collections.ArrayList。如果您确实使用 ArrayList，则其所有元素的类型都必须是可序列化的（具有 [Serializable] 属性或实现 System.Runtime.Serialization.ISerializable。）

下面是一些代码，用于从设置中的 ArrayList（名为 cboCollection）获取数据到组合框并返回。

```
 private void Form1_Load(object sender, EventArgs e)
    {
        if (Settings.Default.cboCollection != null)
            this.comboBox1.Items.AddRange(Settings.Default.cboCollection.ToArray());
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        ArrayList arraylist = new ArrayList(this.comboBox1.Items);
        Settings.Default.cboCollection = arraylist;
        Settings.Default.Save();
    }

    //A button to add items to the ComboBox
    private int i;
    private void button1_Click(object sender, EventArgs e)
    {
        this.comboBox1.Items.Add(i++);
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T01:36:27.870

如果您在谈论应用程序用户设置，我将遍历组合框并将值保存在分隔字符串中：

```
StringBuilder sb = new StringBuilder();
foreach(var item in combo.Items){
  sb.Append(item.ToString() + ";");
}
Properties.Settings.MyListSetting = sb.ToString(); 
```

如果上面的代码不完美，请原谅，这只是一个例子。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T22:08:33.570

Windows 窗体对象不可序列化。因此，您不能将它们序列化并将它们存储在具有二进制格式化程序的文件中。您需要将组合框值手动存储在文件中。

```
string comboboxFileName = @"c:\workDir\settings.settings";

private void saveComboboxInFile (String comboboxFileName )
{
   //--------------------------------------------------------
   //- Store the combobox values in a file. 1 value = 1 line
   //--------------------------------------------------------
   try
    {
        using (StreamWriter comboboxsw = new StreamWriter(comboboxFileName))
        {
            foreach (var cfgitem in comboBox.Items)
            {
                comboboxsw.WriteLine(cfgitem);
            }
        } // End Using`
    }
    catch (Exception e)
    {
       //process exception
    }
}

private void reloadCombboxFromFile (string  comboboxFileName )
   {
    //-------------------------------------------------
    //- Read the values back into the combobox
    //------------------------------------------------- 
        try
        {
            using (StreamReader comboboxsr = new StreamReader(comboboxFileName))
            {
                 while (!comboboxsr.EndOfStream)
                 {
                      string itemread = comboboxsr.ReadLine();
                      comboBox.Items.Add(itemread);
                 }
            } // End Using
      }
      catch (DirectoryNotFoundException dnf)
      {
         // Exception Processing
      }
      catch (FileNotFoundException fnf)
      {
         // Exception Processing
      }
      catch (Exception e)
      {
         // Exception Processing
      }
   } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-11T21:25:06.730

您可以使用`System.Collections.Specialized.StringCollection`type 来保存 ComboBox 项。首先在设置设计器中创建这种类型的变量，例如 CboItems。

阅读项目：

```
if (Properties.Settings.Default.CboItems != null)
    comboBox1.Items.AddRange(Properties.Settings.Default.CboItems.Cast<string>().ToArray()); 
```

要保存项目：

```
var items = new System.Collections.Specialized.StringCollection();
items.AddRange(comboBox1.Items.Cast<string>().ToArray());
Properties.Settings.Default.CboItems = items;

Properties.Settings.Default.Save(); 
```

# php - PHP：打印未定义的变量而不发出警告

> ID：376623
> 
> 赞同：4
> 
> 时间：2008-12-18T01:26:52.303
> 
> 标签：php, variables, warnings, undefined

我只是想知道是否有一种快速的方法来回显未定义的变量而不会收到警告？（我可以更改错误报告级别，但我不想这样做。）到目前为止，我拥有的最小的是：

`isset($variable)?$variable:''`

我不喜欢这个有几个原因：

*   这有点“罗嗦”和复杂
*   `$variable`被重复
*   空白字符串的回声总是让我很恼火。
*   我的变量名可能会更长，例如`$arrayvar['parameter']`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-18T01:31:38.347

您可以使用[错误抑制运算符](http://www.php.net/operators.errorcontrol)@ 运行它。

```
echo @$variable; 
```

但是，最好不要忽略未设置的变量。未设置的变量可能表示脚本存在逻辑错误，最好确保在使用前设置所有变量。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-18T14:31:07.883

您可以使用从[此处](http://wiki.php.net/rfc/ifsetor)获取的 ifsetor() 示例：

```
function ifsetor(&$variable, $default = null) {
    if (isset($variable)) {
        $tmp = $variable;
    } else {
        $tmp = $default;
    }
    return $tmp;
} 
```

例如：

```
echo ifsetor($variable);
echo ifsetor($variable, 'default'); 
```

这不会生成通知，因为变量是通过引用传递的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T01:34:39.917

```
echo @$variable; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T00:52:37.567

这是[PHP 的一个长期存在的问题](https://stackoverflow.com/questions/282329/what-are-five-things-you-hate-about-your-favorite-language?answer=282574#282574)，他们打算`isset_or()`在 PHP 6 中使用（或类似的函数）修复它，希望该功能也能在 PHP 5.3 中使用。现在，您必须在问题中使用 isset()/ternary 示例，或者使用 @ 前缀来消除错误。恕我直言，**这是唯一可以证明在 PHP 中使用 @ 的情况。**

我不会担心使用`echo`空字符串的速度问题，将它包装在一个`if`子句中可能比仅仅回显空字符串更昂贵。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-03T10:29:39.887

您可以使用 ？？PHP 7 及更高版本的选择器。

```
echo $variable??'not defined'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-18T08:29:42.300

undefined 变量很常见，我建议你先用 null 初始化变量

```
$var = null; 
```

或禁用通知的错误报告：

```
error_reporting(E_ALL^E_NOTICE); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-19T00:16:09.247

使用@-operator 抑制错误会强制解释器更改错误级别，执行函数，然后改回错误级别。这会减少您的脚本运行时间。

构建这样的函数将消除至少 3 个原因：

```
function echoVar($var, $ret=NULL) {
    return isset($var)?$var:$ret;
}

echoVar($arrayvar['parameter']); 
```

但是为什么要回显未定义的变量呢？这听起来像没有很好的编码......

# php - PHP CLI 的优点？

> ID：376638
> 
> 赞同：5
> 
> 时间：2008-12-18T01:33:34.257
> 
> 标签：php, command-line, command-line-interface

PHP 的 CLI 与其他脚本语言/环境（如 VBScript 甚至 Windows 脚本）相比有哪些优势？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-18T02:06:56.997

一种用途是作为与 Web 应用程序相关的计划维护任务。您将能够使用 Web 应用程序中的库和功能。

我想另一个好处是，如果您熟悉 php web 开发，那么在 php 中编写一个快速的 cli 脚本可能是一种快速完成工作的快速方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-18T02:10:46.787

我们将 PHP CLI 用于 cron 任务，例如发送电子邮件、关闭旧线程和跨 Web 服务器发送电子邮件队列。您还可以将它用于一次性项目，例如将平面文本文件直接解析到数据库中。这不是您希望在网络上可见的东西。这些任务具有共享您为网站构建的库的优势，例如数据库访问和发送电子邮件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-30T14:57:15.037

我建议使用 Symfony 控制台组件[http://dev.umpirsky.com/building-cli-apps-with-symfony-console-component/](http://dev.umpirsky.com/building-cli-apps-with-symfony-console-component/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-22T12:24:48.820

最适合工作的脚本语言几乎总是你最了解的那种。因此，如果您比 VBScript 更了解 PHP，那将是您最大的优势。我已经编写了许多其他人可能会用 PERL、BASH 甚至 Python 编写的许多命令行实用程序和维护脚本，但我对这些语言的了解几乎不如我对 PHP 的了解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T02:27:43.943

首先想到的是一个 PHP 应用程序，您可以轻松地将它呈现为一个守护进程，并结合任务调度程序来不断进行某些更新，因为您不能/不想依赖用户活动来触发执行应用程序——但你真的**不需要**交互式 CLI 来处理这类事情，也就是说，你可以通过 CLI 以外的方式使用可用的任务调度工具，让它完成所有的脏活。

主要原因是[PEAR](http://pear.php.net/)，我认为这是 PHP 开始变得非常有趣的时候。这对于[symfony](http://www.symfony-project.org/)来说是必须的，但您确实可以看到它有助于使用您已经熟悉的语言自动化您的工作 - 无需学习 python、perl 等，而且 PEAR 脚本不必驻留在 cgi 中是一个优点存储库（一些共享主机非常严格）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T02:30:03.363

在其他条件相同的情况下，使用您最熟悉的语言。对于很多实用程序编程，其他一切都是平等的。

在大多数此类情况下，VBScript 或 Powerscript 可能至少同样适用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-22T15:59:14.760

将原本纯 Web 的项目扩展到命令行；

看看[drush](http://drupal.org/project/drush)如何扩展[drupal](http://drupal.org/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-22T22:55:46.213

PHP 是独立于操作系统的，它有一个非常完整的实用程序库。

# sql-server - powershell命令恢复远程数据库

> ID：376640
> 
> 赞同：1
> 
> 时间：2008-12-18T01:33:38.157
> 
> 标签：sql-server, powershell

有谁知道从本地文件恢复远程数据库的powershell命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T01:05:50.287

根据您的评论，没有特定于 PowerShell 的命令。您需要使用 New-PSDrive 将驱动器映射到服务器，使用 Copy-Item 将数据库复制到服务器，然后使用 SQL 2008 命令之一（共有 2 个）执行必要的 RESTORE数据库命令。SQL2008 没有提供比这更具体的东西，而且 SQL Server 产品本身无法从远程路径（嗯，可能是 UNC，但我假设您在客户端上）执行恢复操作会更容易将备份复制到服务器）。

# c# - 使用接口+抽象类的继承设计。好习惯？

> ID：376642
> 
> 赞同：12
> 
> 时间：2008-12-18T01:34:52.380
> 
> 标签：c#, oop, inheritance

我不太确定如何命名这个问题，但基本上我有一个这样的界面：

```
public interface IFoo
{
    string ToCMD();
} 
```

几个实现 IFoo 的抽象类，例如：

```
public abstract class Foo : IFoo
{
   public abstract string ToCMD();
}

public abstract class Bar : IFoo
{
    public abstract string ToCMD();
} 
```

然后是继承 Foo 和 Bar 的类：

```
public class FooClass1 : Foo
{
    public override string ToCMD()
    {return "Test";}
} ///there are about 10 foo classes.

public class BarClass : Bar
{
    public override string ToCMD()
    {return "BarClass";}
} ///about the same for bar classes. 
```

我这样做是为了当我有我的自定义列表时：

```
public class Store<T> : List<T>  where T : IFoo {} 
```

然后我可以限制其中的类型，但通过拥有接口，它仍然可以采用任何类型的 IFoo。

就像是：

```
Store<Foo> store = new Store<Foo>(); //Only Foo types will work.
store.Add(new FooClass1()); //Will compile.

Store<IFoo> store = new Store<IFoo>(); //All IFoo types will work.
store.Add(new FooClass1()); //Will compile.
store.Add(new BarClass()); //Will compile. 
```

我的问题是：这是解决这个问题的好方法吗？或者，还有更好的方法？

编辑：图片-> ![替代文字](https://i.stack.imgur.com/RqPPj.jpg)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T02:03:46.690

一般来说，对继承链的需求是值得怀疑的。

然而，将抽象基类与接口相结合的具体场景..我是这样看的：

如果你有一个这样的抽象基类，你也应该有一个对应的接口。如果您有接口，则仅在继承链合理的情况下使用抽象基类。

也就是说，如果我正在编写一个库并且这是我的 API/框架的一部分，我通常会包含一个可用作基类的“默认实现”。它将在可能的情况下以一种简单、通用的方式实现接口方法，并将其余部分留给继承者根据需要实现/覆盖。

不过，这只是库的一个便利功能，通过提供一个功能示例来帮助想要实现接口的人，该示例可能涵盖了他们已经需要实现的大部分内容。

简而言之，接口比基类更有价值，但基类可能会节省大量时间并减少接口实现的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T01:57:52.583

你需要接口；您可能需要也可能不需要抽象类。

一般来说，如果你可以在基类中提供一些有用的行为，那么就提供一个基类；如果基类本身不完整，则使其抽象（VB 用语中的 MustInherit）

否则，接口就足够了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T01:43:15.343

嗯，这就是 where 关键字的用途。您可能需要评估您的对象模型以确保您的继承深度是必要的。深层继承层次结构往往会使项目复杂化，通常是一个危险信号，但这取决于具体情况。

通常，您不需要抽象类来实现您正在讨论的列表功能，并且接口是指定类型限制的“首选”方法。如果您要封装通用功能，我只会使用您的类的抽象版本。

**简短的回答**：确保你不会让继承变得疯狂。

希望有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T01:43:47.450

您也可以只使用接口。没有理由使用抽象类。

```
public interface Foo : IFoo
{
}

 public interface  Bar : IFoo
{
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T01:44:16.763

我不太确定这是否是您正在寻找的，但也许您想要做的是将界面全部废弃并执行以下操作：

```
abstract class Base
{
    public abstract string ToCMD();
}

abstract class Foo : Base { }

abstract class Bar : Base { } 
```

希望您在`Foo`和`Bar`类中还有其他成员！这将允许您通过`Base`或仅使用普通的`List<Base>`.

# jquery - 使用 ASP.NET MVC 在 JS 文件中为 jQuery 设置 ajax url

> ID：376644
> 
> 赞同：22
> 
> 时间：2008-12-18T01:40:29.000
> 
> 标签：jquery, asp.net-mvc, ajax, url, routing

当前，当对 MVC 操作进行 Ajax 调用时，我的 javascript 在视图中，而不是在它自己的 JS 文件中。

然后很容易做到这一点：

```
var xhr = $.ajax({
     url: '<%= Url.Action("DisplayItem","Home") %>/' + el1.siblings("input:hidden").val(),
     data: { ajax: "Y" },
     cache: false,
     success: function(response) { displayMore(response, el1, xhr) }
}); 
```

...然后在 JS 中使用的 ajax 调用中包含 URL`Url.Action()`非常容易。如果没有对 URL 进行硬编码，我怎么能移动它自己的 JS 文件？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2011-04-18T07:22:58.960

我这样做的方式是生成 URL 服务器端并使用[HTML5 数据属性](http://ejohn.org/blog/html-5-data-attributes/)存储在生成的 HTML 中，例如：（Razor 语法）

```
<li class='customClass' data-url='@Url.Action("DisplayItems", "Home", new { id = Model.Id })'>...</li> 
```

然后你可以使用 jQuery attr() 函数来获取 url，例如：

```
$(".customClass").click(function () {
    $.ajax({
        url: $(this).attr("data-url"),
        success: function (data) {
            // do stuff
        }
    });
}); 
```

如果您生成 HTML 客户端以响应 AJAX 调用，则可以在 JSON 有效负载中包含相关 URL，并以相同方式填充*data-属性。*

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-07-16T07:14:48.273

这种方式充分利用了 MVC 路由，因此您可以充分利用 MVC 框架。受到 stusmith 回答的启发。

在这里，我`ApplicationController`对此 URL 有一个动态 javascript 操作：

```
 /application/js 
```

我在这里包含静态文件是因为我只想要一个主 javascript 文件来下载。如果需要，您可以选择只返回动态内容：

```
 /// <summary>
    /// Renders out javascript
    /// </summary>
    /// <returns></returns>
    [OutputCache(CacheProfile = "Script")]
    [ActionName("js")]
    public ContentResult RenderJavascript()
    {
        StringBuilder js = new StringBuilder();

        // load all my static javascript files                    
        js.AppendLine(IO.File.ReadAllText(Request.MapPath("~/Scripts/rr/cart.js")));
        js.AppendLine(";");

        // dynamic javascript for lookup tables
        js.AppendLine(GetLookupTables());
        js.AppendLine(";");

        return new ContentResult()
        {
            Content = js.ToString(),
            ContentType = "application/x-javascript"
        };
    } 
```

这是创建我们的查找表的辅助函数。只需为您要使用的每个 RouteUrl 添加一行。

```
 [NonAction]
    private string GetLookupTables() 
    {
        StringBuilder js = new StringBuilder();

        // list of keys that correspond to route URLS
        var urls = new[] {
            new { key = "updateCart", url = Url.RouteUrl("cart-route", new { action = "updatecart" }) },
            new { key = "removeItem", url = Url.RouteUrl("cart-route", new { action = "removeitem" }) }
        };

        // lookup table function
        js.AppendLine("// URL Lookuptable");
        js.AppendLine("$.url=function(url) {");
        js.AppendLine("var lookupTable = " + new JavaScriptSerializer().Serialize(urls.ToDictionary(x=>x.key, x=>x.url)) + ";");
        js.AppendLine("return lookupTable[url];");
        js.AppendLine("}");

        return js.ToString();
    } 
```

这会生成以下动态 javascript，它基本上只是从任意键到我的操作方法所需的 URL 的查找表：

```
// URL Lookuptable
$.url=function(url) {
var lookupTable = {"updateCart":"/rrmvc/store/cart/updatecart","removeItem":"/rrmvc/store/cart/removeitem"};
return lookupTable[url];
} 
```

在 cart.js 我可以有这样的功能。请注意，url 参数取自查找表：

```
 var RRStore = {};
 RRStore.updateCart = function(sku, qty) {

    $.ajax({

        type: "POST",
        url: $.url("updateCart"),
        data: "sku=" + sku + "&qty=" + qty,
        dataType: "json"

        // beforeSend: function (){},
        // success: function (){},
        // error: function (){},
        // complete: function (){},
    });

    return false; 
```

};

我可以从任何地方调用它：

```
 RRStore.updateCart(1001, 5); 
```

这似乎是我能想到的唯一方法，它可以让我以干净的方式使用路由。在 javascript 中动态创建 URL 很麻烦，而且很难测试。测试类型可以在这里的某个地方添加一个层，以方便测试。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-18T01:53:18.973

将 AJAX 调用包装在一个函数中，该函数将 URL（和任何其他数据）作为参数并返回响应。然后在您看来，调用函数而不是直接调用 AJAX 调用。

```
function doAjax( url, data, elem, callback )
{
    return $.ajax({
        url: url,
        data: { ajax: data },
        cache: false,
        success: function(response) { callback(response, elem, xhr); }
    });
}

...

<input type='button' value='Go get it' onclick='doAjax( <%= Url.Action ... 
```

我不确定这是否比在页面上而不是在 JS 文件中调用 Ajax 更好，除非您经常使用完全相同的模式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-15T04:49:46.363

使用模块模式。

```
 // separate js file
var PAGE_MODULE = (function () {
  var url = {},
      init = function(url) { ... },
      load = function() {
      $.ajax({
           url: url,
           ...
           });
      }

      return { init: init };
})(); 

```

```
 // calling init goes on the page itself
PAGE_MODULE.init(" %: Url.Action(...) %>"); 

```

一般来说，内联 onclick 处理程序不是好的 javascript，因为您使用的是全局函数。

```
onclick='doAjax(

```

我建议阅读[http://jqfundamentals.com/book/index.html#N20D82](http://jqfundamentals.com/book/index.html#N20D82)以更好地处理模块模式。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-31T12:44:33.000

这是另一种方式：

在您的母版页中，包括一个用于内联脚本的区域：

```
<head>
  ...
  <asp:ContentPlaceHolder runat="server" ID="_inlineScripts" />
  ...
</head> 
```

然后在 Page_Load 中，创建一个实用函数：

```
protected void Page_Load( object sender, EventArgs e )
{
  AddInlineScript( string.Format( "$.url=function(url){{return '{0}'+url;}}", GetBaseUri() ) );
  ...
}

private Uri GetBaseUri()
{
  var requestUrl = Request.Url.AbsoluteUri;
  var i = requestUrl.IndexOf( request.Path );

  return new Uri( requestUrl.Substring( 0, i ) );
}

private void AddInlineScript( string content )
{
  var script = new HtmlGenericControl( "script" );

  script.Attributes.Add( "type", "text/javascript" );
  script.InnerHtml = content;

  _inlineScripts.Controls.Add( script );
} 
```

现在你可以在你的 ajax 中使用这个函数：

```
$.ajax({
  url: $.url('path/to/my-handler'),
  ...
}); 
```

# c# - 关于同时处理对文件的写入和只读访问的问题

> ID：376649
> 
> 赞同：1
> 
> 时间：2008-12-18T01:43:42.037
> 
> 标签：c#

在 Web 应用程序中，是否有一种被广泛接受的方法来处理锁定的文件？

例如，用户对文件具有写入权限，那么让所有其他用户访问文件但只有只读权限的最佳方式是什么。

此外，如果该用户关闭文件并且所有句柄/资源都被处理掉，我该如何决定接下来谁可以拥有对该文件的完全写入权限？

这是假设 1 个用户具有完全写入访问权限，而 10 个用户具有只读访问权限。

还假设 Web 应用程序上有一个文件链接。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T06:23:06.513

我认为常见的方法是使用 ReaderWriterLock 保护资源（在您的情况下为文件）（3.5 中有 ReaderWriterLockSlim 具有更好的性能）。要更改状态（即写入/打开-关闭/删除），您必须获得一次只能授予一个线程的写入器锁，并且读取操作需要读取器锁，该锁可以在多个读取器之间共享。

# c# - ASP.NET MVC：从变量设置授权属性角色时出现问题，需要 const

> ID：376655
> 
> 赞同：15
> 
> 时间：2008-12-18T01:52:53.890
> 
> 标签：c#, asp.net-mvc, authorization

我在从变量设置授权属性角色值时遇到问题。错误消息说它需要一个 const 变量。当我创建一个 const 类型变量时，它工作正常，但我正在尝试从 Web.Config 文件或其他任何允许最终用户设置它的文件中加载值。我正在使用集成的 Windows 身份验证，因为这是一个仅限 Intranet 的应用程序。

有没有办法从控制器检查用户角色？我将在 if 语句中使用它而不是属性来进行身份验证。

```
[Authorize(Roles = Config.GMPUser)]
public ActionResult Index()
   {
      return View();
   } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-16T16:14:48.770

我有一个名为 StringResources 的类，它提供对静态字符串值的访问。我遇到了同样的障碍，并以下列方式解决了这个问题。我从 AuthorizeAttribute 类继承并为 AuthorizeCore 方法添加了方法覆盖。该方法的功能调用了 IsInRole() 并传入静态字符串属性。那成功了。唯一的问题是必须为每个角色（或以您的业务逻辑规定的任何方式组合角色）创建单独的类。

```
public class SystemAdministratorAuthorizationRequiredAttribute
        : AuthorizeAttribute
    {
        protected override bool AuthorizeCore(System.Security.Principal.IPrincipal user)
        {
            return
                user.IsInRole(
                StringResources.AdministrationViewsStrings.SystemAdministratorRoleName
                );
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T04:58:16.027

属性在编译时被烧毁，因此如前所述，您只能将它们与常量一起使用。您也不能更改属性，因为即使它似乎允许您，下次您将值取回时它也不会“粘住”。tvanfosson 的`User.InRole( "RoleName" )`可能是最好的选择（他有我的 +1）。

只是为了说明更新属性的问题：

```
class FooAttribute : Attribute
{
    public string Bar { get; set; }
}
static class Program
{
    [Foo(Bar="abc")]
    public static void Main()
    {
        MethodInfo method = typeof(Program).GetMethod("Main");
        var attrib = (FooAttribute) Attribute.GetCustomAttribute(method, typeof(FooAttribute));
        Console.WriteLine("Original: " + attrib.Bar);
        attrib.Bar = "def";
        Console.WriteLine("Updated: " + attrib.Bar);
        attrib = (FooAttribute)Attribute.GetCustomAttribute(method, typeof(FooAttribute));
        Console.WriteLine("Look again: " + attrib.Bar);
    }
} 
```

印刷：

```
Original: abc
Updated: def
Look again: abc 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T02:02:11.843

您可以`User.InRole( "RoleName" )`在控制器内使用。

**编辑：下面的代码将不起作用，因为 GetCustomAttributes() 显然返回每个属性的副本而不是对实际属性的引用。留下作为答案为其他答案提供上下文。**

至于在authorize属性中设置，我唯一的想法是在属性定义中将其设置为空字符串，然后在控制器的类型上使用反射来获取和修改与AuthorizeAttribute对应的CustomAttribute属性（即，对于您关心的每种方法，其类型为 AuthorizeAttribute)。您应该能够以这种方式将 Roles 属性设置为您的配置项。

```
var attributes = typeof(MyController).GetMethod("Index")
                                     .GetCustomAttributes(typeof(AuthorizeAttribute),
                                                          false)
                 as AuthorizeAttribute;

attributes[0].Roles = Config.GMPUser; 
```

我想您会在应用程序启动时在 Global.asax 文件中执行此操作，以便只需要执行一次。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-23T18:33:44.307

[像这样创建一个自定义属性（大卫·海登的博客](http://web.archive.org/web/20090514080517/http://davidhayden.com/blog/dave/archive/2009/04/09/CustomAuthorizationASPNETMVCFrameworkAuthorizeAttribute.aspx)提供的稍微修改的版本）：

```
public class MyCustomAuthorizeAttribute : AuthorizeAttribute
{
    public IAuthorizationService _authorizationService = new MyAuthorizationService();

    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
       return _authorizationService.Authorize(httpContext);
    }
} 
```

并像这样申请：

```
[MyCustomAuthorize]
public ActionResult Create()
{
    return View();
} 
```

现在您可以将所有自定义授权逻辑放入您自己的 MyAuthorizationService 类中。注意：在 davids 解决方案中，您可以使用提供的访问器设置内部 MyAuthorizationService。不确定您是否可以将新的 MyAuthorizationService() 传递给它。没试过。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-02T12:58:27.843

您可以像这样创建一个新的 Authorize 类：

```
[AttributeUsage(AttributeTargets.All, Inherited = true, AllowMultiple = true)]
public class AuthorizedGmp : AuthorizeAttribute
{
    public AuthorizedGmp()
    {
        Roles = Config.GMPUser;
    }
} 
```

# algorithm - 找到最小正值

> ID：376657
> 
> 赞同：8
> 
> 时间：2008-12-18T01:54:40.143
> 
> 标签：algorithm, delphi, optimization

从固定数量（在本例中为 3）的值中找到最小的非零正值或在没有正问题的情况下返回 0 的最佳算法是什么？

我的天真方法如下（在 Delphi 中，但可以随意使用任何你喜欢的方法），但我认为有一种更优雅的方法。

```
value1Temp := MaxInt;
value2Temp := MaxInt;
value3Temp := MaxInt;

if ( value1T > 0) then
  value1Temp := value1;
if ( value2 > 0) then
  value2Temp := value2;
if ( value3 > 0) then
  value3Temp  := value3;

Result := Min(value1Temp, Min(value2Temp, value3Temp));
if Result = MaxInt then
  Result := 0; 
```

**编辑：**如果没有正数，抱歉添加了所需的内容。我以为我以前有它，但一定错过了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T02:00:23.110

我会做一个小循环（这是在 C 中，我不是 Delphi 人）：

```
int maxPositiveValue(int *number, int listSize)
{
    int i, result = 0;

    for(i = 0; i < listSize; i++)
    {
        if(number[i] > 0 && (number[i] < result || result == 0))
            result = number[i];
    }

    return result;
} 
```

这段代码的优点是它可读性很强，可以很容易地缩放以处理任何长度的值列表。

**更新：我已经更改了代码以响应我在下面收到的评论。**

这个新代码稍微复杂一些，但它现在可以处理：

1.  列表不包含正整数的情况（返回 0）。
2.  列表包含一次或多次出现的 INT_MAX 的情况。
3.  任意长度的列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T13:58:25.500

下面的函数怎么样（当然是在 Delphi 中）：

```
function LowestPositiveInt(IntArr : array of Integer):Integer;
var
  iX : integer;
  bValid : boolean;
begin
  Result := MaxInt;
  bValid := False;
  for ix := 0 to High(IntArr) do
    if (IntArr[ix] > 0) then
      begin
        bValid := true;
        if (IntArr[iX] < Result) then
          Result := IntArr[ix];
      end;
  if not bValid then
    Result := 0;
end; 
```

然后像下面这样调用它：

```
ShowMessage(IntToStr( LowestPositiveInt([5,2,3,-1,12]) )); 
```

这应该返回 2。这种方法的优点是数组可以接受任意数量的项目，包括整数变量......所以使用上面的示例，您可以说：

```
Result := LowestPositiveInt( [ Value1, Value2, Value3 ] ); 
```

**编辑**更新以处理*LowestPosititiveInt( [ MaxInt, MaxInt, MaxInt ] )*场景。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T05:40:52.353

我会这样做：

> 结果：= MaxInt；
> 如果 value1 > 0 那么 Result := min(Result, value1);
> 如果 value2 > 0 那么 Result := min(Result, value2);
> 如果 value3 > 0 那么 Result := min(Result, value3);
> 如果 Result = MaxInt 则 Result := 0;

如果您希望它包含任意数量的问题，那么：

> 结果：= MaxInt；
> for I := 1 to N do
>    if value[I] > 0 then Result := min(Result, value[I]);
> 如果 Result = MaxInt 则 Result := 0;

如果您希望值数组从零开始，请将 for 循环更改为：0 到 N-1

我认为这段代码非常清楚地说明了正在做什么。

将“then”语句放在同一行会使代码在这个简单的情况下看起来更简洁，但如果您认为有必要，可以将“then”语句缩进下一行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-18T15:06:16.707

我不知道 Delphi，但这是 Ruby 中的一个快速解决方案（假设数字在列表中）

```
[1,2,42,-12].delete_if{|n| n <= 0 }.min || 0 
```

从算法上讲，您删除所有负数（或 0）元素，然后找到最小值。如果没有正元素，则`[].min`返回`nil`，因此最终`|| 0`给出请求的“0”作为答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-19T05:10:15.723

在 DELPHI - 如果您的域是整数，并且如果您可以将您的参数放入 longints，并且如果您可以避免传递最小整数（$80000000），那么这将为您提供您想要的结果而无需任何条件分支：

```
function cmMinInt( XX, YY, ZZ : longint ) : longint;
begin
   result := max(0,longint(
   min(longint((XX-1) xor $80000000),
   min(longint((YY-1) xor $80000000),
   longint((ZZ-1) xor $80000000)
   )) xor $80000000)+1);
end; 
```

该技术依赖于 longint 类型的可逆无损重新映射，以便我们感兴趣的范围——从 1 到 MAXINT 的整数——保持有序并占据最低值。简单地切换符号位几乎可以满足我们的需要，除了我们不希望 0 包含在较低范围内。首先减去 1（稍后再添加）可以解决此问题。此处使用的 xor 操作将两个操作数都扩展为 int64，这需要显式转换回 longint，以便 min 函数产生正确的结果。最后，如果操作数都是否定的，则最小值将在上限范围内找到，答案将为否定。在这种情况下，我们希望答案为 0，因此我们只需使用 max 函数对其进行裁剪。

下面是相同的数学分布在多个语句中，以便于阅读：

```
function cmMinInt( XX, YY, ZZ : longint ) : longint;
begin
   // swap ordinal coding for range MININT..0 with range 1..MAXINT
   XX := XX-1;             // move region division to between 0 and 1
   XX := XX xor $80000000; // swap regions, preserving ordering
   XX := longint(XX);      // cram back into signed 32-bit
   // similarly with YY and ZZ
   YY := longint((YY-1) xor $80000000);
   ZZ := longint((ZZ-1) xor $80000000);
   // find min of three recoded values
   result := min(XX,min(YY,ZZ));
   // swap ordering back again
   result := result xor $80000000;  // swap regions, preserving ordering
   result := result+1;              // move region division back home
   result := longint(result);       // cram back into signed 32-bit
   // if all three were neg, result at this point is neg -- clip to zero
   result := max(0,result);
end; 
```

-阿尔。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-18T02:03:35.227

我同意亚当的观点。如果您只需要容器中的最小自然数，那么在算法上您实际上不会比线性搜索更快。

他的代码应该运行得非常快，它很可能会在 x86 中转换为 CMOV，因此 for 循环中的 if 语句无论如何都不会花费那么多。

如果您最终想要按顺序排列所有非零数字，那么当然最好先排序，然后再拼接。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-18T14:12:01.073

如果您使用非固定数量的值，您想要的是一种[选择算法。](http://en.wikipedia.org/wiki/Selection_algorithm)

然而，如果你的代码只需要检查三个值，你应该避免循环和特定的算法，只关注微优化——特别是尽可能少的分支。

[在Hacker's Delight](http://www.hackersdelight.org/)第 4 章中有一些关于此的内容，您可以在其中将有符号整数类型转换为无符号整数以将分支数量减半。这是在以下 C 代码中的函数 minimum_v2() 中完成的：

```
#include <stdio.h>
#include <limits.h>

int smallest_v1(int a, int b, int c)
{
        int min = INT_MAX;

        min = a>0 && a<min ? a : min;
        min = b>0 && b<min ? b : min;
        min = c>0 && c<min ? c : min;
}

// See Hacker's Delight, chapter 4.
int smallest_v2(int a, int b, int c)
{
        int min = INT_MAX;

        if ( (unsigned) a < min ) min = a;
        if ( (unsigned) b < min ) min = b;
        if ( (unsigned) c < min ) min = c;

        return min;
}

int main()
{
        printf("min v1: %d\n", smallest_v1(-10, 7, 3));
        printf("min v2: %d\n", smallest_v1(-10, 7, 3));
} 
```

基本上，这本书说如果你想检查

```
1 <= i <= 10 
```

那么这与进行无符号比较相同

```
(unsigned)(i - 1) <= 9 
```

这本书也提供了一个证明。你得到的是代码中更好的分支预测。你应该制定一个测试程序并计时。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-18T21:20:44.860

您在寻找美学还是速度？

如果是后者，我想不出一种方法可以执行此测试足够多次以在应用程序中检测到：这没关系。

干杯

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-18T02:05:33.600

```
Result := Min(IfThen(Value1 > 0, Value1, MAXINT), 
              Min(IfThen(Value2 > 0, Value2, MAXINT),
                  IfThen(Value3 > 0, Value3, MAXINT))); 
```

根据问题，如果输入不是列表/数组，则循环将不起作用。

如果这三个都不是正数且非零，则从问题中不清楚该函数应该做什么。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-18T02:06:48.777

无论数组元素的类型是什么，这都有效

```
template <typename T>
T min_pos(T* a, int n)
{
    int i /* = 0 */ /* Edit: commented this out */;

    // Find the first positive element in the array
    for (i = 0; i < n; ++i)
        if (a[i] > 0)
            break;

    // If no positive element was found, return 0
    if (i == n)
        return 0;

    T res = a[i];

    // Search the rest of the array for an element
    // that is positive yet smaller than res
    for (++i; i < n; ++i)
    {
        if ((a[i] > 0) && (a[i] < res))
            res = a[i];
    }

    return res;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-18T02:07:46.370

这是 C#

```
public int GetSmallestPositive(IList<int> pValues)
{
    if(pValues == null)
    {
        throw new ArgumentNullException("pValues");
    }
    int _negNumCount = 0;
    int _smallest = int.MaxValue;
    for(int i = 0; i < pValues.Count; ++i)
    {
        if(pValues[i] < _smallest)
        {
            if(pValues[i] <= 0)
            {
                ++_negNumCount;
                continue;
            }
            _smallest = pValues[i];
            if(_smallest == 1)
            {
                return 1;
            }
        }
    }
    return (_negNumCount == pValues.Count) ? 0 : _smallest;
} 
```

在这种情况下，在您的示例中，我使用的是整数，因此 1 是最小的非零数。只要您将整数放入列表中，它就会适用于您想要的任意数量的值。

**编辑：**如果列表中满是负数，则修复为返回 0。如果 pValues 为空，则抛出异常。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-18T02:30:48.790

```
//return the smallest non-zero positive number, or null.
//relying on Min or Max is considered cheating.
public static int? smallestNonZeroPositiveNumberOfThree(
    int val1, int val2, int val3)
{
    //we have no guarantee that any of the 3 inputs will be positive
    int? result = null;
    if (val1 > 0) 
    {
        result = val1; 
        if (val2 > 0 && val2 < result) { result = val2; }
        if (val3 > 0 && val3 < result) { result = val3; }
    }
    else if (val2 > 0)
    {
        result = val2; 
        if (val3 > 0 && val3 < result) { result = val3; }
    }
    else if (val3 > 0)
    {
        result = val3; 
    }
    return result;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-18T02:30:56.963

一个涵盖所有基础的 c# 版本（我认为）：

```
public int GetMinimumPositiveValue(IEnumerable<int> values)
{
    int result = int.MaxValue;
    bool hasPositiveValue = false;

    foreach (int value in values)
    {
        if(value == 1) { return value; } 

        if(value > 0)
        {
            hasPositiveValue = true;

            if(value < result)
            {
                result = value;
            }
        }
    }

    return hasPositiveValue ? result : 0;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-18T03:02:04.530

这是我在考虑更多之后想出的

```
Result := 0;
if value1 > 0 then
  Result := value1;
if (value2 > 0) and ((Result = 0) or (value2 < Result)) then
  Result := value2;
if (value3 > 0) and ((Result = 0) or (value3 < Result)) then
  Result := value3; 
```

如果你有一个列表，那么更通用的算法会更好。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-18T07:17:18.663

这是问题帖子中解决方案的 C 版本，但修复了所有值都是 MaxInt 的情况......

```
int foo(int value1, int value2, int value3)
{
    int value1Temp, value2Temp, value3Temp, tempMax;
    value1Temp = max(value1, 0);
    value2Temp = max(value2, 0);
    value3Temp = max(value3, 0);
    tempMax = value1Temp | value2Temp | value3Temp;
    if (value1Temp == 0) { value1Temp = tempMax; }
    if (value2Temp == 0) { value2Temp = tempMax; }
    if (value3Temp == 0) { value3Temp = tempMax; }
    return min(value1Temp, min(value2Temp, value3Temp));
} 
```

也可以以无分支方式执行此操作，因为 min 和 max 可以实现为无分支操作：

```
int min(int x, int y)
{
    return y + ((x - y) & -(x < y));
}

int max(int x, int y)
{
    return x - ((x - y) & -(x < y));
}

int foo(int value1, int value2, int value3)
{
    int value1Temp, value2Temp, value3Temp, tempMax, mask;
    value1Temp = max(value1, 0);
    value2Temp = max(value2, 0);
    value3Temp = max(value3, 0);
    tempMax = value1Temp | value2Temp | value3Temp;
    mask = -(value1Temp > 0);
    value1Temp = (value1Temp & mask) | (tempMax & ~mask);
    mask = -(value2Temp > 0);
    value2Temp = (value2Temp & mask) | (tempMax & ~mask);
    mask = -(value3Temp > 0);
    value3Temp = (value3Temp & mask) | (tempMax & ~mask);
    return min(value1Temp, min(value2Temp, value3Temp));
} 
```

有关您为什么要这样做的更多背景信息，请参阅：[“如果”贵吗？](https://stackoverflow.com/questions/315306/is-if-expensive)和[Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html)。

**编辑：**破坏了我之前对无分支解决方案的尝试，但实际上并没有奏效。添加了一个新的无分支解决方案，它应该可以工作。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-18T07:54:23.643

对 Jason 的正确处理空集合和仅包含负值的集合的建议略有改进：

```
values.Min(r => r > 0 ? r : (int?)null) ?? 0 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-27T17:03:05.117

在 Haskell 中，像往常一样，最容易解决一般问题，然后声明一个特殊情况。

```
foo xs = let xs1 = filter (>0) xs in if null xs1 then 0 else minimum xs1

foo3 x1 x2 x3 = foo [x1, x2, x3] 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-06-24T06:06:32.250

很难相信 Delphi 仍然限制在 Min 函数中的两个值。:-(

在 Python 中，您可以设置一个函数来处理任意数量的参数，如下所示：

```
def PosMin(*numbers):
    try:
        return min(num for num in numbers if num > 0)
    except:
        return 0 
```

不幸的是，如果“min”函数最终没有值（例如空列表或在这种情况下没有数字> 0），则会引发异常，因此必须捕获异常。有一个关于 python 的下一个版本添加一个哨兵值的建议，看起来它会被接受。在这种情况下，代码将是

```
return min (num for num in numbers if num > 0, sentinel=0) 
```

无需异常处理。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-09-08T13:48:54.583

```
function MinPositive(const AIntegers: array of Integer): Integer;
var
  LoopI: Integer;
  LFirstPositivePos: Integer;
begin
  Result := 0;
  LFirstPositivePos := MaxInt;
  for LoopI := Low(AIntegers) to High(AIntegers) do
  begin
    if (AIntegers[LoopI] > 0) then
    begin
      Result := AIntegers[LoopI];
      LFirstPositivePos := LoopI;
      Break;
    end;
  end;

  for LoopI := LFirstPositivePos to High(AIntegers) do
  begin
    if (AIntegers[LoopI] > 0) and (AIntegers[LoopI] < Result) then
    begin
      Result := AIntegers[LoopI];
    end;
  end;
end;

function MinPositive3(const I1, I2, I3: Integer): Integer;
begin
  Result := MinPositive([I1, I2, I3]);
end; 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-12-18T02:05:41.070

*   遍历列表的值，丢弃它们直到找到一个正值，为其设置 min-value
*   浏览列表其余部分中的值
    *   如果 0 < current-value < min-value，则将 min-value 设置为 current-value
*   返回最小值

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2008-12-18T03:19:36.803

对于那些试图解决 C# 中的一般问题的人来说，我看到的代码行太多了。如果值是`IEnumerable<int>`那么

```
values.Select(v => (int?)v)
      .Where(v => v > 0)
      .Min() ?? 0; 
```

如果存在则返回最小的正值，`values`否则返回`0`。在这里，我正在利用序列为空`Enumerable.Min(IEnumerable<int?>)`时将返回的事实。`null`因此，我们过滤掉非正值，然后找到最小值。如果所有值都是非正的，我们会根据需要获得零，否则会找到正值的最小值。

# objective-c - 在 Mac 应用程序中连接到 Internet

> ID：376676
> 
> 赞同：0
> 
> 时间：2008-12-18T02:04:59.373
> 
> 标签：objective-c, macos, cocoa, webkit

我完成的最后一个 GUI 编程是使用 Visual Basic，其中包括 Winsock 和 Inet 等对象，以便轻松连接到 Internet 并从网页中检索源代码。

我刚开始接触 XCode，想知道是否有类似的组件。我看到库中有一个 Webkit 选项，但我不知道如何使用它。

任何帮助，将不胜感激。

* * *

我想尽可能地模拟浏览器（包括 cookie、标题等）。Webkit 方法是否比您刚刚给我的链接更好？抱歉，我在 OP 中没有更清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T04:59:24.013

Webkit 是正确的答案。这是 2003 年的教程，展示了如何使用 webkit 构建 Web 浏览器：

[http://cocoadevcentral.com/articles/000077.php](http://cocoadevcentral.com/articles/000077.php)

基本上，webkit 允许您在应用程序 UI 中嵌入 Web 浏览器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T21:05:12.143

Apple 在您要查看的文档中有两个指南，[URL 加载系统](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html)和[WebKit Objective-C 编程指南](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/DisplayWebContent/DisplayWebContent.html)。如果您想从幕后的 Web 服务器请求数据，您可能对前者最感兴趣，如果您想将 Web 浏览器控件实际放入您的应用程序中，您可能对后者最感兴趣。这两份文档都应该解释您将使用的类和一般过程，但如果您有任何问题，请告诉我。

许多核心 Cocoa 数据类型，如 NSString、NSDate，甚至 NSArray 和 NSDictionary 都有从像 Heng-Cheong Leong 提到的 URL 加载数据的方法，但它们抽象出所有低级的东西，如果您想处理 HTTP 标头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T03:36:47.737

NSString 类具有从网页中检索源的方法，例如 stringWithContentsOfURL:encoding:error:。

如需更多控制，请查看[http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html)文档中描述的类。

WebKit 更像是 MSIE ActiveX 控件。

# database-design - “查表”与否？

> ID：376677
> 
> 赞同：3
> 
> 时间：2008-12-18T02:05:11.540
> 
> 标签：database-design, normalization

我目前正在为一个项目设计一个数据库。现在我正在和自己争论是否必须创建一个查找表，例如“公民身份”数据，它只能包含固定值，如单身、已婚、分居、寡妇/鳏夫。我很确定将来不会添加其他值。我应该把这些放在一个单独的表上还是只是硬编码程序代码上的值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T02:09:47.663

对它们进行硬编码有什么好处？给定一个现代的 ORM 系统，从数据库中读取这些值并使用它们不是很容易吗？如果是这样，那么当缺点是：

*   如果要添加到列表中，则必须重新部署
*   如果要更改拼写，则必须重新部署
*   您可能想要的不仅仅是字符串（可能是 ref-id 或工具提示文本等）
*   如果您不存储 ref-id，则必须更改 1000 条记录才能更改存储的文本。

“我不认为他们会改变”与“他们不能改变”几乎不一样。如果他们*不能改变*，如真/假，那么很好。如果你不*认为*他们会改变，也不会改变那么多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T02:15:56.120

规范化说：查找表

常识说：查找表

"公民结合"的概念不是自然法，而是民法问题——而且可以改变。

如果您需要根据计划中的公民工会身份做某事，Andrew Kennan 的方法是一个很好的方法。否则单独查找表就足够了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T02:08:09.100

根据您的编程语言，将它们设为常量或枚举。没有理由将它们放入数据库中，因为正如您所说，它们可能不会改变。

如果进入数据库，下一步是什么？男/女？真假？:)

我主要使用Java，所有这些项目都作为枚举。我们的数据库是 MySQL，然后我们也将列类型创建为 enum。尼斯甚至匹配那里。

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T02:09:45.463

您的表中应该有一列 CivilStatus (int)，它是对包含所有可能的公民身份的 CivilStatuses 表的外键引用。

即使您不希望它改变，我仍然会从数据库中查询它。这将使其他事情在未来变得更容易，比如本地化/全球化。

然后，正如其他人所说，您可以在代码中包含枚举，以使映射更容易。然而，任何时候你向用户显示文本，它都必须来自数据库或资源文件——而不是直接来自代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T02:09:22.063

我倾向于两者都做 - 使用查找表来强制引用完整性并提供枚举以使代码可读。

不利的一面是，如果由于某种原因查找值确实发生了变化，您需要记住更新这两个位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T04:21:56.070

查找表。为什么？

1) 强制数据完整性。至少在列上放置一个检查约束。

2) 本地化

3）查询问题。有时数据库区分大小写。

```
Select * from People where MarriageStatus = "single" or is it "Single", or is it "SINGLE" 
```

嗯，我不知道我最好把 ToLower(MarriageStatus) = "single"。糟糕，我不知道在列周围包装函数会阻止它使用索引:)

除非这是一个预期寿命较短的小项目，否则可以省去一些麻烦并使用查找表。

# browser - 使用 Watir（或 WatiN 或类似）进行自动化测试：消除选择元素的歧义

> ID：376683
> 
> 赞同：0
> 
> 时间：2008-12-18T02:06:47.607
> 
> 标签：browser, automation, watin, watir, web-testing

**问题：**我正在寻找一种方法来运行测试，该测试能够消除在多个位置具有相同值的选择控件之间的歧义。

**例子：**

我正在尝试从选择控件中选择第三个“星期一”

```
ie.select_list( :id , 'choose-day' ).set( '-monday' ); 
```

选择控件在控件本身中有一种“大纲”格式：

```
alice
-monday
-tuesday
bob
-monday
-tuesday
charlie
-monday
-tuesday 
```

鉴于文本是相同的（而且我不知道选项值是什么提前），有没有办法对测试进行编码，以便 charlie 下的星期一是被选中的那个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T20:34:46.190

在 WatiN 中，您可以使用多个属性支持来匹配一个元素（我认为 Watir 中也有类似的东西）。

Option option = ie.SelectList("choose-day").Options(Find.ByText("-monday") && Find.ByIndex(2))

（索引从零开始，因此 2 将给出第三个匹配项（如果有））。

HTH, Jeroen van Menen 领导开发者 WatiN

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T05:15:36.540

看起来您可以使用 element_by_xpath 找到您想要的选项，如下所示：

```
//select/option[text()='charlie']/following::option[text()='-monday']

```

然后您可以检查该选项的 value 属性（不确定如何在 Watir 中执行此操作），然后使用以下命令选择它：

```
ie.select_list( :id , 'choose-day' ).select_value( whatever_the_value_was ); 
```

# c++ - 如何在 kdelib 上使用 KConfig 加载默认设置？

> ID：376698
> 
> 赞同：0
> 
> 时间：2008-12-18T02:10:46.630
> 
> 标签：c++, settings, kde, kdelibs, kconfig

我有一个关于 KConfig 使用的问题。我可以像这样在我的 .kde4/share/config/_appname_rc 配置文件中写入和读取设置

```
 KConfig basicconf;
 KConfigGroup conf = KConfigGroup(basicconf.group("Settings"));
 conf.writeEntry("filepath",QString("/path/"));
 basicconf.sync(); 
```

但我不明白如何在我第一次运行我的应用程序时使用“默认”配置文件来读取，或者如果应用程序设置需要重置。

我更喜欢不使用 KConfig XT，因为我的项目很小，而且带有 kcfgc* 文件的 KConfigXT 似乎过多。

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T16:20:48.367

首先，这个：

KConfigGroup conf = KConfigGroup(basicconf.group("Settings"));

至少恕我直言，可以更清楚地写成：

KConfigGroup conf(&basicconf, "设置");

另请注意，“General”是最常用的“通用”组名。无论如何...

您可以在应用程序中安装默认配置文件；将其安装到 $PREFIX/share/config/，这很容易在您的 CMakeLists.txt 文件中实现：

install(FILES <你的配置文件> DESTINATION ${CONFIG_INSTALL_DIR})

KConfig 处理从那里合并的所有魔力；你不必做任何事情。

至于 KConfigXT 太过分了，使用它有很多好处，包括自动化您的配置对话框，确保强制执行边界和合法值等。编写一个小文件，在 CMakeLists.txt 文件中弹出一个条目通常比用手免费做它给你的东西。[关于这方面的TechBase](http://techbase.kde.org/Development/Tutorials/Using_KConfig_XT)有一个很棒的教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T11:41:48.990

使用[KGlobal::config()](http://api.kde.org/4.x-api/kdelibs-apidocs/kdecore/html/namespaceKGlobal.html#f056d0c68c6a17389f084a8112d2d222)获取指向您的应用程序拥有的默认 KConfig 对象的指针。它自动引用 $KDEHOME/share/config 中的文件。

[KConfig XT](http://techbase.kde.org/Development/Tutorials/Using_KConfig_XT)是有意义的，因为

*   生成的 YourSettings 对象的 API 特定于您的应用程序；比 conf.writeEntry("filepath", path); 更容易理解 YourSettings::setFilePath(path) 的含义。
*   您的应用程序可能会增长；开始使用 KConfig XT 比 rip 和稍后替换它更容易。
*   默认值是在 .kcfg XML 中指定的，而不是在应用程序的几个地方硬编码，并且您有一个 setDefault() 方法来重置所有值。

# collections - 实体集合的 IList 与 IEnumerable

> ID：376708
> 
> 赞同：148
> 
> 时间：2008-12-18T02:17:34.010
> 
> 标签：collections, ienumerable, ilist

当我的域中有包含事物列表的实体时，它们应该公开为 ILists 还是 IEnumerables？例如 Order 有一堆 OrderLines。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2008-12-18T02:27:07.173

[`IEnumerable<T>`](https://msdn.microsoft.com/en-us/library/9eekhta0.aspx "MSDN 文档")表示您可以迭代的一系列项目（例如，使用 foreach），而[`IList<T>`](https://msdn.microsoft.com/en-us/library/5y536ey6.aspx "MSDN 文档")是您可以添加或从中删除的集合。

通常，您希望能够通过添加或删除 OrderLines 来修改 Order，因此您可能希望 Order.Lines 为`IList<OrderLine>`.

话虽如此，您应该做出一些框架设计决策。例如，是否可以将相同的 OrderLine 实例添加到两个不同的订单？可能不是。因此，鉴于您希望能够验证是否应将 OrderLine 添加到订单中，您可能确实希望将 Lines 属性显示为仅一个`IEnumerable<OrderLine>`，并提供可以处理的 Add(OrderLine) 和 Remove(OrderLine) 方法那个验证。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-09-14T04:19:18.343

大多数时候，我最终会选择 IList 而不是 IEnumerable，因为 IEnumerable 没有 Count 方法，并且您无法通过索引访问集合（尽管如果您使用 LINQ，则可以使用扩展方法解决此问题）。

# java - 关于java和flex集成的问题

> ID：376714
> 
> 赞同：1
> 
> 时间：2008-12-18T02:19:40.623
> 
> 标签：java, apache-flex

我有一个 flex 网络应用程序并希望将它与 Java 集成。

该应用程序将有一个非常小的数据库（2-3 个表），以及一些例行逻辑，例如发送邮件。

根据此链接（[http://learn.adobe.com/wiki/display/Flex/2b.+Code+Files](http://learn.adobe.com/wiki/display/Flex/2b.+Code+Files)），我还需要一个 .jsp 文件。我以为 Flex 只会对我的课程感兴趣？

此外，我的 java 方法将采用参数 - 如何将 flex .mxml 页面的文本框中的值传递给 java 方法？一个简单的例子真的会帮助我。

使用 httpservice 调用时，还有什么我需要知道的吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T02:56:27.537

查看 Blaze DS。设置它非常简单，这样您就可以从 Flex 调用 Java 类的方法。

[http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/](http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/)

基本上，您注册一个 RemoteObject，它引用您的 Flash Remoting 端点的 URL 并指定目标（通常是类名）。请参阅 WebOrb 文档以了解如何执行此操作。完成后，您可以像这样调用 RemoteObject：

var token : AsyncToken = emailService.sendEmail(subject, body); token.addResponder(responderImpl);

您创建 IResponder 接口的实现并将其注册到从 Flex 中的远程调用返回的“AsyncToken”。Flex 中对服务器的所有调用都是异步的，这就是为什么您注册一个响应者，然后调用结果或错误方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T07:01:49.180

另一种选择是使用 Ajax（即 JavaScript）作为 Flex 和服务器端 Java 之间的中介，以帮助保持视图层和业务层的良好分离。我已经成功地看到了这一点 - Flex 可以轻松调用 JavaScript，并且有许多经过验证的模式可以将您的 Java 对象/方法公开给 JavaScript 以进行 Ajax 样式调用（[DWR](http://directwebremoting.org/)是一个不错的选择）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-25T01:55:06.967

如果您使用 BlazeDS（这是您放入 Web 服务器的一个 servlet），您将能够在远程调用中传递 ActionScript 对象。这些将通过线路编组到 AMF，然后再编组到 Java 对象。您需要使用代码生成器工具来获取您的 Java 远程服务并创建相应的 ActionScript 类以在客户端上使用（用于发送参数然后接收结果）。

Flex 还支持 ala SOAP 样式的 Web 服务调用。效率低于 AMF，但如果交换的数据不多，则没什么大不了的。

当我急于做一些真正快速而肮脏的事情时，我只需执行一个 HttpService send() 调用，其中我已经编写了一个 HTTP POST（数据在 URL 中不可见，因为它在 GET 中是不可见的）。一个快速编写的 Java servlet 处理 POST 并以文本格式的名称/值对映射的形式接收数据。（HttpSerivce.send() 方法的异步行为类似于 AJAX XmlHttpRequest() 机制。）

它只是没有比做类似的事情更简单的了，但是名称/值对不像结构化数据那样灵活。有时您需要处理更复杂的结构化数据。因此，通过 BlazeDS 远程处理将 ActionScript 模型对象序列化为 AMF 对象图就可以实现了。

# sockets - 为什么我不应该在端口 80 上运行我的非 Web 服务器软件？

> ID：376717
> 
> 赞同：5
> 
> 时间：2008-12-18T02:22:07.763
> 
> 标签：sockets, tcp, client-server

考虑到世界上有这么多严苛的防火墙，我有什么理由不应该在端口 80 上运行服务器软件来保证最大可能的可访问性？似乎最常见的防火墙例外是允许端口 80 上的出站连接。我知道任何类型的数据包检查仍会阻止我的非 HTTP 流量，但如果是这种情况，我确信防火墙不会有任何无论如何，其他开放的传出端口。

如果服务器已经在端口 80 上有一个网络服务器，是否可以在端口 80 上使用某种虚拟主机（即同一台机器上的myDomain.com:80*和myApp.myDomain.com:80）？*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T02:38:30.677

如果您需要这样做，为什么不用 SOAP 接口或 HTTPHandler 封装您的网络通信代码呢？

然后你的数据包将符合 HTTP，你会通过防火墙，每个人都开心吗？

这比解决您从多用途端口 80 获得的所有安装和操作问题要容易得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T02:32:18.473

我可以想到两个原因：首先，如果您这样做是为了绕过公司防火墙，您将违反安全策略，其次，您将使用未注册协议的[保留端口](http://www.iana.org/assignments/port-numbers)这可能会给尝试与您的系统交互的客户（例如，谷歌）造成严重的混乱，并在他们这样做时给您的应用程序带来严重的麻烦。

**编辑**在 Unix 系统上，低编号端口需要特权帐户才能运行。这将是避免在该环境中执行此操作的另一个原因，因为您的应用程序可能需要比其他方式更高的权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T02:29:42.303

要回答您的第二个问题“是否可以使用某种虚拟主机侦听端口 80”：

是的，有，它称为虚拟主机，由大多数现代网络服务器处理。但是，来自您的应用程序的所有请求都必须从 HTTP 协议 1.1 开始，其中指定了主机。您的应用程序可能必须是 CGI 应用程序。但这可能不是你想要的。

另一种方法是让您的应用程序控制端口 80 并将所有 http 查询重定向到网络服务器。它很混乱，如果您的应用程序出现故障，网络服务器也会出现问题。

解决方案是在您的服务器上拥有多个 IP 地址（您可以在 nic 上绑定多个 IP 地址）。然后，您可以将地址 1 的 mydomain.com:80 绑定到 Web 服务器，并将地址 2 的 myapp.mydomain.com 绑定到应用程序，但它们仍然在同一台服务器上。

并回答您的第一个问题：“我有什么理由不应该在端口 80 上运行服务器软件”：是的，这是不好的做法。预计会从自动扫描中获得大量 http 查询。您可以选择使用正确的 http-header 来回答它们或忽略它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T02:32:28.600

无法为侦听端口 80 的其他域进行虚拟托管。只有一个进程可以侦听端口。虚拟主机基于 HTTP 标头发生在应用层。

您可能遇到的另一个问题是代理服务器。不是用户设置的那种，而是公司或 ISP 的自动代理。这些将无法理解您的应用程序的协议，并且可能会失败。

最后，如果您的应用程序在 Unix/Linux 变体上运行，则端口 80 将需要 root 权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T02:49:50.983

我承认通过让 ssh 服务器在家里的 80 端口上侦听并使用**ssh 隧道提供对其他服务器和服务的访问来**绕过严酷的防火墙。我赶紧补充说，我在管理防火墙的人的支持下做到了这一点——我们都同意这是解决手头问题的最佳方法。

我赶紧补充说，这种策略**使端口 80 无法用于其预期目的**，这对我来说很好，因为它无论如何都是我的个人工作站。如果您的域中只有一台机器，那将是一个问题。但是拥有一台我可以专用于从端口 80 提供 ssh 的机器**不会产生安装或操作问题**。我只是跑了`/etc/init.d/apache stop`，然后跑了一个`sshd`来监听端口 80。然后我很高兴在我需要这样做的几个月里去。

敲我个人工作站 80 端口的自动扫描仪可能会挂掉 :-)

# php - 使用正则表达式获取 HTML 标记的内部文本

> ID：376723
> 
> 赞同：0
> 
> 时间：2008-12-18T02:28:28.873
> 
> 标签：php, regex

我无法捕获这些数据：

```
 <tr>
                <td><span class="bodytext"><b>Contact:</b><b></b></span><span style='font-size:10.0pt;font-family:Verdana;
  mso-bidi-font-family:Arial'><b> </b> 
                      <span class="bodytext">John Doe</span> 
                     </span></td>
              </tr>
              <tr>
                <td><span class="bodytext">PO Box 2112</span></td>
              </tr>
              <tr>
                <td><span class="bodytext"></span></td>
              </tr>

              <!--*********************************************************

              -->
              <tr>
                <td><span class="bodytext"></span></td>
              </tr>

              <tr>
                <td><span class="bodytext">JOHAN</span> NSW 9700</td>
              </tr>
              <tr>
                <td><strong>Phone:</strong> 
                02 9999 9999
                    </td>
              </tr> 
```

基本上，我想在“联系人：”之后和“电话：”之前获取所有内容，减去 HTML；但是这两个名称可能并不总是存在，所以我需要真正抓住两个冒号 (:) 之间的所有内容，这些内容不在 HTML 标记内。的数量`<span class="bodytext">***data***</span>`实际上可能会有所不同，所以我需要某种循环来匹配这些。

我更喜欢使用正则表达式，因为我*可以*使用循环和字符串匹配来做到这一点。

另外，我想知道 PHP 正则表达式中不匹配组的语法。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T02:38:55.747

如果我理解正确，您只对 HTML 标记之间的文本感兴趣。要忽略 HTML 标签，只需先剥离它们：

```
$text = preg_replace('/<[^<>]+>/', '', $html); 
```

要获取“联系人：”和“电话：”之间的所有内容，请使用：

```
if (preg_match('/Contact:(.*?)Phone:/s', $text, $regs)) {
  $result = $regs[1];
} else {
  $result = "";
} 
```

要获取两个冒号之间的所有内容，请使用：

```
if (preg_match('/:([^:]*):/', $text, $regs)) {
  $result = $regs[1];
} else {
  $result = "";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T02:39:27.807

对这类问题的看似任意的堆栈溢出响应似乎是“天哪，不要使用正则表达式！改用[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)！！”。就我个人而言，我更喜欢不必为这样的小任务使用外部库，而正则表达式是一个不错的选择。

去除所有 HTML 标记的一种简单方法是使用此正则表达式，这是解决此问题的一种方法：

```
$text = preg_replace("/<.*?>/", "", $text); 
```

然后您可以使用任何您喜欢的方法来获取适当的文本内容。

不匹配的组是这样的：`(?:this won't match)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-05T13:33:27.223

听起来像[screenscraping](http://www.developertutorials.com/blog/php/easy-screen-scraping-in-php-simple-html-dom-library-simplehtmldom-398/)，或者你也可以在找到你想要的信息后使用[strip_tags() 。](http://us2.php.net/manual/en/function.strip-tags.php)

# xml - 在 XSLT 模板中求和总计的问题

> ID：376724
> 
> 赞同：2
> 
> 时间：2008-12-18T02:28:49.230
> 
> 标签：xml, xslt

我在尝试使用 XSLT 简单地对一些值求和时遇到问题。我在网上有一个模板，并根据我的需要对其进行了修改。（[链接文字](http://blog.davidkaspar.com/archives/2003/10/xslt-sum-of-products-from-multiple-nodes.php)）

无论我如何尝试，我都无法让模板对数字求和。我要么最终得到总“0”，要么得到我想要求和的数字的串联。如果有人可以看看并指出我哪里出错了，我将不胜感激。

谢谢

** 模板 **

```
print("<xsl:template match="Parts">
    <root>
        <xsl:variable name="tmpTotal">
            <total_amount>
                <xsl:for-each select="Part">
                    <item>
                        <xsl:value-of select="Duration"/>
                    </item>
                </xsl:for-each>
            </total_amount>
        </xsl:variable>
        <total>
            <xsl:variable name="myTotal" select="number(msxsl:node-set($tmpTotal))" /> <!--Shows up as 0-->
            <xsl:value-of select="sum(msxsl:node-set($myTotal)/total_amount/item)" />
            <!--<xsl:variable name="myTotal" select="msxsl:node-set($tmpTotal)" />--> <!-- Shows up as concatenation-->
            <!--<xsl:value-of select="msxsl:node-set($myTotal)" />--> 
        </total>
    </root>
</xsl:template>"); 
```

** XML **

```
print("<Parts>
<Part>
  <PartNum>0000-A123</PartNum> 
  <Rate>0</Rate> 
  <Rate0Decimal>0</Rate0Decimal> 
  <ProductRemovedNumber>...</ProductRemovedNumber> 
  <Qty>2</Qty> 
  <Resolution>False</Resolution> 
  <ReturnFA>False</ReturnFA> 
  <SerialNumber /> 
  <TickProblemCD>15</TickProblemCD> 
  <TicketNum>075020009000048</TicketNum> 
  <Total>0</Total> 
  <Total0Decimal>0</Total0Decimal> 
  <TotalDisplay>0</TotalDisplay> 
  <UserNumber>009</UserNumber> 
  </Part>
<Part>
  <Duration>2</Duration>
  <Total>0</Total> 
  <PartCost>0.00</PartCost> 
  <PartCost0Decimal>0</PartCost0Decimal> 
  <PerformedBy>TEST</PerformedBy> 
  <WorkDoneCode /> 
  <WorkDoneDesc /> 
  <ZoneBasedTravel>False</ZoneBasedTravel> 
  <PartNum>Travel</PartNum> 
  <PartDescr>---</PartDescr> 
  <Qty>2</Qty> 
  </Part>
<Part>
  <Duration>4</Duration> 
  <DurationRequired>True</DurationRequired> 
  <EndTime>12/4/2008 2:24 PM</EndTime> 
  <EndTimeOnly>12/4/2008</EndTimeOnly> 
  <FamilyName>NON-COMPLAINT</FamilyName> 
  <FOC>False</FOC> 
  <InvTxnGenerated /> 
  <LastUpdatedDate>12/4/2008 2:24 PM</LastUpdatedDate> 
  <Rate>0</Rate> 
  <Rate0Decimal>0</Rate0Decimal> 
  <RateType>Install</RateType> 
  <Total>0</Total> 
  <PartCost>0.00</PartCost> 
  <PartCost0Decimal>0</PartCost0Decimal> 
  <PerformedBy>TEST</PerformedBy> 
  <WorkDoneCode>17000</WorkDoneCode> 
  <WorkDoneDesc>De-Installation / Instrument Move</WorkDoneDesc> 
  <ZoneBasedTravel>False</ZoneBasedTravel> 
  <PartNum>Labor</PartNum> 
  <PartDescr>Install</PartDescr> 
  <Qty>4</Qty> 
  </Part>
<Part>
  <Duration>1</Duration> 
  <DurationRequired>True</DurationRequired> 
  <EndTime>12/4/2008 2:24 PM</EndTime> 
  <EndTimeOnly>12/4/2008</EndTimeOnly> 
  <FamilyName>NON-COMPLAINT</FamilyName> 
  <FOC>False</FOC> 
  <InvTxnGenerated /> 
  <LastUpdatedDate>12/4/2008 2:24 PM</LastUpdatedDate> 
  <Rate>0</Rate> 
  <Rate0Decimal>0</Rate0Decimal> 
  <RateType>TSB/ISA</RateType> 
  <Total>0</Total> 
  <PartCost>0.00</PartCost> 
  <PartCost0Decimal>0</PartCost0Decimal> 
  <PerformedBy>TEST</PerformedBy> 
  <WorkDoneCode>13000</WorkDoneCode> 
  <WorkDoneDesc>TSB / ISA - Installed</WorkDoneDesc> 
  <ZoneBasedTravel>False</ZoneBasedTravel> 
  <PartNum>Labor</PartNum> 
  <PartDescr>TSB/ISA</PartDescr> 
  <Qty>1</Qty> 
  </Part>
  </Parts>"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T02:48:02.717

您没有准确解释要求和的值。

**从提供的 XSLT 代码来看，您似乎想要所有“持续时间”元素的值的总和**。这可以使用以下简单的 XPath 表达式获得：

   **`sum(/*/*/Duration)`**

**下面是完整的 XSLT 转换**：

```
<xsl:stylesheet 版本="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:输出方法="文本"/>

    <xsl:模板匹配="/">
      <xsl:value-of select="sum(/*/*/Duration)"/>
    </xsl:模板>
</xsl:样式表>

```

**当此转换应用于提供的 XML 文档时**：

```
<零件>
    <部分>
        <零件编号>0000-A123</零件编号>
        <Rate>0</Rate>
        <Rate0Decimal>0</Rate0Decimal>
        <ProductRemovedNumber>...</ProductRemovedNumber>
        <数量>2</数量>
        <分辨率>错误</分辨率>
        <ReturnFA>假</ReturnFA>
        <序列号 />
        <TickProblemCD>15</TickProblemCD>
        <TicketNum>075020009000048</TicketNum>
        <总计>0</总计>
        <Total0Decimal>0</Total0Decimal>
        <TotalDisplay>0</TotalDisplay>
        <用户编号>009</用户编号>
    </部分>
    <部分>
        <时长>2</时长>
        <总计>0</总计>
        <零件成本>0.00</零件成本>
        <PartCost0Decimal>0</PartCost0Decimal>
        <PerformedBy>测试</PerformedBy>
        <工作完成代码 />
        <工作完成描述 />
        <ZoneBasedTravel>假</ZoneBasedTravel>
        <PartNum>旅行</PartNum>
        <PartDescr>---</PartDescr>
        <数量>2</数量>
    </部分>
    <部分>
        <时长>4</时长>
        <DurationRequired>真</DurationRequired>
        <EndTime>2008 年 12 月 4 日下午 2:24</EndTime>
        <EndTimeOnly>2008 年 12 月 4 日</EndTimeOnly>
        <FamilyName>非投诉</FamilyName>
        <FOC>错误</FOC>
        <InvTxnGenerated />
        <LastUpdatedDate>2008 年 12 月 4 日下午 2:24</LastUpdatedDate>
        <Rate>0</Rate>
        <Rate0Decimal>0</Rate0Decimal>
        <RateType>安装</RateType>
        <总计>0</总计>
        <零件成本>0.00</零件成本>
        <PartCost0Decimal>0</PartCost0Decimal>
        <PerformedBy>测试</PerformedBy>
        <WorkDoneCode>17000</WorkDoneCode>
        <WorkDoneDesc>拆卸/仪器移动</WorkDoneDesc>
        <ZoneBasedTravel>假</ZoneBasedTravel>
        <PartNum>劳动力</PartNum>
        <PartDescr>安装</PartDescr>
        <数量>4</数量>
    </部分>
    <部分>
        <时长>1</时长>
        <DurationRequired>真</DurationRequired>
        <EndTime>2008 年 12 月 4 日下午 2:24</EndTime>
        <EndTimeOnly>2008 年 12 月 4 日</EndTimeOnly>
        <FamilyName>非投诉</FamilyName>
        <FOC>错误</FOC>
        <InvTxnGenerated />
        <LastUpdatedDate>2008 年 12 月 4 日下午 2:24</LastUpdatedDate>
        <Rate>0</Rate>
        <Rate0Decimal>0</Rate0Decimal>
        <RateType>TSB/ISA</RateType>
        <总计>0</总计>
        <零件成本>0.00</零件成本>
        <PartCost0Decimal>0</PartCost0Decimal>
        <PerformedBy>测试</PerformedBy>
        <WorkDoneCode>13000</WorkDoneCode>
        <WorkDoneDesc>TSB / ISA - 已安装</WorkDoneDesc>
        <ZoneBasedTravel>假</ZoneBasedTravel>
        <PartNum>劳动力</PartNum>
        <PartDescr>TSB/ISA</PartDescr>
        <数量>1</数量>
    </部分>
</零件>

```

**产生了想要的结果**：

***7***

**编辑**：在评论中，OP解释说他正在寻找等于“劳工”`sum`的`Duration`所有`part`-s 。`PartNumber`

**下面的 XPath 表达式产生这个 sum**：

   **`sum(/*/*[PartNum='Labor']/Duration)`**

# css - Firefox 不会立即呈现样式表？

> ID：376725
> 
> 赞同：11
> 
> 时间：2008-12-18T02:28:56.017
> 
> 标签：css, firefox

我不确定这是设置问题还是 HTML 问题，但在我正在处理的页面布局上，Firefox 不会立即呈现样式表。这意味着大概半秒钟我可以看到未设置样式的页面，然后样式表启动并按照我的预期呈现。

我所有的样式表都在 head 标签中加载的外部 css 文件中。我在 Flock（它是 Firefox 变体）和 Google Chrome/IE 上都没有遇到这种情况。

知道如何避免它吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-18T02:30:51.397

尝试禁用萤火虫。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T02:32:16.493

Firebug 肯定会减慢页面渲染时间。残酷如此。

此外，在 Firefox 中安装 yslow： http: [//developer.yahoo.com/yslow/](http://developer.yahoo.com/yslow/)以确保您的页面得到充分优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T05:44:51.237

向我们展示页面！它有效吗？

您可能想搜索“flash of unstyled content”或“FOUC”，看看会出现什么，这是这种现象的常用短语。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T06:21:52.317

您没有提到平台，但如果在 Firefox 中启用了 IPv6，Visual Studio 内置 Web 服务器也会发生这种情况。请参阅[http://blog.codeville.net/2008/11/07/speeding-up-communication-between-firefox-and-visual-studios-built-in-web-server/](http://blog.codeville.net/2008/11/07/speeding-up-communication-between-firefox-and-visual-studios-built-in-web-server/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-03T20:25:44.517

就我而言，关闭 Firebug 并没有帮助。另一方面，我碰巧在我的css中使用了**@import**，当我删除它时**——FOUC**（无样式内容的Flash）消失了。这很奇怪，因为这种行为主要是指**IE** ( [http://www.bluerobot.com/web/css/fouc.asp/](http://www.bluerobot.com/web/css/fouc.asp/) )

# php - nginx 上的 Zend 框架

> ID：376732
> 
> 赞同：16
> 
> 时间：2008-12-18T02:31:24.560
> 
> 标签：php, zend-framework, mod-rewrite, nginx

我一直在开发的基于 Zend 框架的站点现在正在迁移到其生产服务器。这个服务器原来是 nginx（惊喜！）。由于它是在 Apache 上开发的并且依赖于 htaccess 文件，因此该站点自然无法正常工作。

我的问题是……有人有这方面的经验吗？关于如何将 htaccess 文件的功能转换为 nginx.conf 文件的任何想法？我正在研究这个，但希望有人已经有这方面的经验。谢谢！

编辑：这是当前的 htaccess：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ /index.php [NC,L] 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-12-17T12:32:24.173

```
server {

 listen   80; ## listen for ipv4
 listen   [::]:80 default ipv6only=on; ## listen for ipv6

 server_name  localhost;

 access_log  /var/log/nginx/localhost.access.log;
 error_log  /var/log/nginx/localhost.error.log;

 root   /var/www/localhost/public;

 try_files $uri @php_index;

 # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
 #
 location @php_index {
  fastcgi_pass   127.0.0.1:9000;
  fastcgi_param  SCRIPT_FILENAME /var/www/localhost/index.php;
  include fastcgi_params;
 }
} 
```

建议尽可能使用 try_files。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-20T09:38:43.287

我知道这是一个非常古老的线程，但无论如何它可能会对某些人有所帮助。

基本上它将任何 404 错误重定向到 index.php，但如果文件存在（类型文件），它将设置正确的根。

我是从头顶做的。它可能无法立即工作，您必须放置正确的路径和 fastcgi 配置。我还将所有内容都放回 index.php，因为它应该像 Zend_Framework 那样工作

```
error_page  404 = /index.php;

location / {
    if (-f $request_filename) {
        root   /var/www;
    }
}

location ~ \.php$ {
        fastcgi_pass   unix:/tmp/php.sock;
        fastcgi_index  index.php;

        fastcgi_param  SCRIPT_FILENAME     /var/www/index.php;
        include /etc/nginx/fastcgi_params;
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-18T02:37:08.950

我不知道转换 htaccess 文件的任何自动/系统方法，您可能必须手动进行。[Nginx wiki](http://wiki.nginx.org/Main)是 nginx 文档的最佳资源。

**编辑：** 我现在自己在 Nginx 上运行 Zend Framework，配置如下所示：

```
server {
  listen 80;
  server_name servername.com;

  root /var/www/zendapp/public;

  location / {
    index index.php;
  }

  # Deny access to sensitive files.
  location ~ (\.inc\.php|\.tpl|\.sql|\.tpl\.php|\.db)$ {
    deny all;
  }
  location ~ \.htaccess {
    deny all;
  }

  # Rewrite rule adapted from zendapp/public/.htaccess
  if (!-e $request_filename) {
    rewrite ^.*$ /index.php last;
  }

  # PHP scripts will be forwarded to fastcgi processess.
  # Remember that the `fastcgi_pass` directive must specify the same
  # port on which `spawn-fcgi` runs.
  location ~ \.php$ {
    include /etc/nginx/fastcgi_params;

    fastcgi_pass   127.0.0.1:9000;
    fastcgi_index  index.php;
  }

  location = /50x.html {
      root   /var/www/default;
  }
} 
```

如您所见，重写规则本身非常简单。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-04-17T12:20:50.267

这是“官方的”，简单且效果很好：

[http://wiki.nginx.org/Zend_Framework#Time_for_nginx](http://wiki.nginx.org/Zend_Framework#Time_for_nginx)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-10-26T15:24:10.503

对于可以提供帮助的登台服务器；）

```
 fastcgi_param APPLICATION_ENV staging; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-23T00:35:51.940

实际上我用一个像zend框架一样工作的drupal站点运行一个nginx：一个index.php作为引导程序

这是规则（未在 zend 框架上测试，仅在 drupal 上测试，但应该类似）

```
location / {
            if (!-e $request_filename) {
                    rewrite  ^/(.*)$  /index.php?q=$1  last;
                    break;
        }
    }

error_page  404              /index.php; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-12-06T21:31:17.713

如果您为您的项目使用一个子目录，例如[http://some.url/myproject/controller/](http://some.url/myproject/controller/)，那么您还需要将 setBaseUrl 添加到您的引导文件中。

```
<?php

class Bootstrap extends Zend_Application_Bootstrap_Bootstrap
{
    protected function _initSomeFancyName()
    {
        $this->bootstrap('frontController');
        $frontController = Zend_Controller_Front::getInstance();
        $frontController->setBaseUrl('/myproject'); // set the base url!
    }
} 
```

nginx 重写看起来像这样：

```
location /myproject/ {
  if (!-e $request_filename) {
    rewrite ^/myproject/(.*)$ /index.php?$1? last;
  }
} 
```

PS问号不是错字！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T02:20:24.047

如果可能的话，我建议他们在只能从 Nginx 机器访问的非标准端口上设置 Apache，并让 Nginx 代理到 Apache。

[Nginx 代理文档](http://wiki.nginx.org/NginxHttpProxyModule)

# linux - 迁移部署在 Linux VM 上的软件？

> ID：376733
> 
> 赞同：1
> 
> 时间：2008-12-18T02:31:32.737
> 
> 标签：linux, deployment, clone, virtual-machine

我有一些我创建的软件部署在 Linux VM 上。我想在第二个虚拟机上部署该软件的第二个副本。理想情况下，我只想克隆 VM 卷，启动第二个副本，更改 IP 地址，仅此而已。它还有其他东西，或者它真的就这么简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T02:39:41.440

对我来说听起来不错，只要您的虚拟机软件足够聪明，可以更改虚拟机的 MAC 地址（至少是 VMware）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T03:01:39.337

我之前在 VMWare Workstation 和 Player 中做过这个 - VMX 文件有一个 MAC 地址，你可以更改它，VMWare 会抱怨 VM 已经移动（我认为只在物理机之间移动），但你只需告诉它创建一个新的启动时，一切都会好起来的。

当然，您可能有不喜欢您这样做的应用程序（许可证合规管理器或任何在程序运行和检查之间存储 MAC 或 IP 地址以确保其没有更改的东西）。

此外，我将所有虚拟机都存储在它们自己的目录中，因此不会发生冲突。否则，您将不得不重命名文件并更改对 VMX 和其他配置中这些文件的引用。

我想你只需要吮吸它然后看看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T14:42:15.853

Linux VM 中的主机名必须更改。这是虚拟机内部唯一必须更改的内容。

# mysql - 将 Web 应用程序从开发阶段传递到生产阶段的最佳实践是什么？

> ID：376734
> 
> 赞同：0
> 
> 时间：2008-12-18T02:32:14.450
> 
> 标签：mysql, svn, build-automation, staging, backup-strategies

我们的开发环境有很多层，并且难以有效地复制甚至备份。基本上，文件系统（即 /usr/appdir/webapp...）还有其他应用程序服务于我们的 Web 应用程序，我们更新的那些应用程序从它们的存储库执行 svn 更新。

使用 Web 应用程序本身（作为用户）将影响文件系统和数据库。所以备份系统就是在同一时间点拥有文件系统和数据库（mysqldump）的副本。两者之一本身不会是完整的备份，因为应用程序本身是非常动态的。

当我们将 web 应用程序部署到登台以供我们的一位客户测试和输入数据时，我们的环境现在很难从我们的开发环境同步回来，甚至难以将其投入生产。由于我们会在开发中向客户提出更改请求，但客户自己会在分期中进行更改。

目前我们正在使用冻结期，我们要求客户对开发环境甚至直接对生产环境进行更改（在完全上线之前）。

我想知道他们是否是关于如何从开发-> 暂存-> 生产中传递有效流程的最佳实践？或者，如果您可能有一些指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-18T03:38:08.420

我通常不会对 QA/staging 环境进行任何更改。任何更改都会在开发环境中进行，然后推送到 QA/staging 和生产。通常，如果可以避免的话，我也不会在 QA/staging 中使用实时数据。如果我在 QA/staging 中有实时数据，我将使用 SQL Data Compare（来自 Red Gate）之类的东西来管理新数据从 QA/staging 环境到生产环境的迁移。

此外，我在源代码控制中为开发/质量保证/生产维护单独的配置。当更改影响所有配置时，必须记住在所有配置中进行更改有点痛苦，但是有足够的差异，这样做比在应用程序发布时更新 QA/生产配置更容易/安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T11:16:44.483

从它的声音来看，您的问题因应用程序的性质而变得复杂。

首先，您的应用程序是否区分作为应用程序一部分的文件和仅作为数据的文件？如果不是，除非您有非常令人信服的理由不这样做，否则这种性质的更改应该会使您的文件系统的版本控制更加简单——那么将应用程序部分置于版本控制之下是有意义的，而不是数据部分。

其次，我一直觉得让文件系统数据与数据库数据保持同步是一件很痛苦的事情。一种解决方案（可能是更广泛的重构）是使一个可以从另一个生成。您能否以某种方式将文件系统内容存储在链接到相关数据的数据库中，从而可以从脚本中填充文件系统？如果您的文件太大，在许多情况下，具有用于开发和测试目的的代表性文件就足够了。

或者，您可以有一个单独的数据存储库，它可以拍摄一组数据（数据库和文件系统）的有效快照，这些数据可以与您的应用程序代码分开存储和管理（尽管这种方法会带来其他问题...... )

如果这里的设计问题是不变的，我想不出比你的冻结期更好的主意。

# php - 给 PHP 对象类型参数一个默认值

> ID：376738
> 
> 赞同：3
> 
> 时间：2008-12-18T02:33:21.513
> 
> 标签：php, unit-testing, dependency-injection

我正在编写一个考虑到可测试性的 PHP 应用程序，所以我的类总是在他们的构造函数中询问他们依赖的“协作对象”，就依赖注入模式而言。

这样，我就可以在我的单元测试中传递模拟或测试实现。

不过，我想要实现的是能够实例化一个具有传递给其构造函数参数的空值的类，以触发一个回退机制，该机制为每个协作者实例化一个默认实现类。

因为对象类型的参数在 PHP 中不能被赋予默认值，所以我必须在构造函数中进行。以下代码是我当前使用的方法的示例：

```
class Engine
{
    private $loader;
    private $logger;

    public function __construct(ResourceLoader $loader = null, Logger $logger = null)
    {
        if ($loader == null) $loader = new DefaultResourceLoader;
        if ($logger == null) $logger = new DefaultLogger;

        $this->loader = $loader;
        $this->logger = $logger;
    }
} 
```

你觉得这怎么样 ？我应该改用 IoC 容器，还是有另一种方法可以为对象类型参数提供默认值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T07:07:26.733

当然，您最好使用 IoC/DIP 容器来完成这项工作。您上面的代码（if 语句）增加了类的耦合。客户端类（引擎）不应该关心实现加载器和记录器角色的内容。这是工厂或 DIP 容器的工作来了解这一点。通过将具体的类名放入您的代码中并将这些类绑定在一起，使您的代码不那么灵活（敏捷）、可重用性和可维护性降低。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-09T10:49:38.020

在这种情况下，您可以使用我的小型库[ValueResolver](https://github.com/LapaLabs/ValueResolver)，例如：

```
$logger = ValueResolver::resolve($logger, new DefaultLogger); 
```

并且不要忘记使用命名空间`use LapaLabs\ValueResolver\Resolver\ValueResolver;`

还有类型转换的能力，例如如果你的变量的值应该是`integer`，所以使用这个：

```
$id = ValueResolver::toInteger('6 apples', 1); // returns 6
$id = ValueResolver::toInteger('There are no apples', 1); // returns 1 (used default value) 
```

查看[文档](https://github.com/LapaLabs/ValueResolver)以获取更多示例

# scripting - 对您有很大帮助的小工具/脚本？

> ID：376751
> 
> 赞同：5
> 
> 时间：2008-12-18T02:40:20.970
> 
> 标签：scripting

在我的头上，特别是对于 C/Linux 开发人员：

*   [确认](http://petdance.com/ack/)
*   [git-bz](http://git.fishsoup.net/cgit/git-bz/plain/git-bz)
*   [颜色gcc](http://schlueters.de/colorgcc.html)
*   [颜色差异](http://colordiff.sourceforge.net/)
*   [moap](https://thomas.apestaart.org/moap/trac)和[prepare-ChangeLog](http://svn.gnome.org/svn/releng/trunk/tools/prepare-ChangeLog.pl)

是否有一些工具/脚本你不能没有，但你觉得其他人不知道这么多？

例如，我刚刚发现：

*   [cppcheck](http://cppcheck.wiki.sourceforge.net/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T03:25:31.987

在 Windows 或 Linux 上：

1.  grep，毫无疑问
2.  尾巴
3.  vim

在 Windows（和 Linux、Solaris）上，[XMLStarlet](http://xmlstar.sourceforge.net)

我知道 grep 和 tail 是众所周知的，但令我惊讶的是，当你使用其中任何一个时，有多少人认为它很神奇。与 Vim 相同。我几乎不是高级用户，但我可以在 MS Word 打开之前打开它并完成一个*小文档。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T03:36:49.093

我不经常使用它，但**最令人敬畏的工具**必须是[dot](http://www.graphviz.org/pdf/dotguide.pdf)，它是用于绘制有向图的工具，它是[AT&T 图形可视化](http://www.graphviz.org)套件的一部分。一个很好的示例输出是他们的[Unix 家族树](http://www.graphviz.org/Gallery/directed/unix.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T03:30:00.760

[Vim http://www.straw-dogs.co.uk/wp-content/vim_logo.png](http://www.straw-dogs.co.uk/wp-content/vim_logo.png)

[Vim，我最喜欢的编辑器](http://www.vim.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-18T03:30:35.440

*   堆栈溢出
*   谷歌

而我的另外两个最爱太大而不能被认为是小的：P

*   视觉工作室
*   互联网

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T03:44:00.263

它是一种语言而不是工具，但它**很小**而且还不为人所知：编程语言[Lua](http://www.lua.org/)。没有它我**活不下去**，它正在逐渐取代我的 sh、ksh、awk 和 perl 脚本……天才的标志之一：字符串搜索模式的转义字符与引用字符串的转义字符*不同。*不再试图理解大量的反斜杠！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-18T03:57:24.670

*   git 对我的工作流程产生了如此深远的影响，以至于我不想在没有它的情况下编写代码
*   firebug 是 Web 开发的必备工具
*   标准命令行实用程序/功能：grep、find、locate、tail、sed、awk、pushd、popd
*   自定义 TextMate 包片段，TextMate 的包编辑器非常棒，即使 TextMate 缺少一些重要的 vi 和 emacs 功能（如拆分缓冲区）
*   正则表达式 - 人们需要学习如何使用正则表达式，句号

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-18T07:50:35.900

我非常喜欢：

1.  [.Net 反射器](http://www.red-gate.com/products/reflector/)
2.  [Sysinternals（这里有一堆很酷的工具）](http://technet.microsoft.com/en-us/sysinternals/default.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-18T05:52:28.010

python 交互式解释器及其强大的变体[iPython](http://ipython.scipy.org/moin/)是提高我的编程效率的工具。

能够以任何您想要的交互方式即时试验新代码并检查对象、类和模块，这简直太棒了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-18T05:54:44.447

知道一个依赖于腻子吗？，我真的不知道没有它我会做什么

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-18T14:37:32.193

大多数已经在这里列出，所以我不会重复。这里有几个新的。

[LINQ 垫](http://www.linqpad.net/)

[反射器](http://www.red-gate.com/products/reflector/)

[便签 VS 加载项](http://code.msdn.microsoft.com/StickyNotes)

psValidation（我自己的验证类库，主要是 RegEx）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-18T03:44:45.660

```
- ANT
- Mylyn
- TortoiseSVN
- firebug (think console too!)
- TextMate 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-18T04:14:58.410

我最喜欢的是[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)，我将它用于未包含在 Visual Studio 项目中的所有内容，以及 Visual Studio 中的一个小宏，它将 ac# 变量声明转换为基本属性。两者都很简单，但是非常有用！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-18T05:57:59.667

在为 Web 编码时，我需要最多的工具，其他任何东西通常只是一个文本编辑器。

对于网络：

*   [Firefox 的 Web 开发者插件](https://addons.mozilla.org/en-US/firefox/addon/60)
*   [记事本++](http://notepad-plus.sourceforge.net/)
*   [小精灵](http://www.nattyware.com/pixie.html)
*   [MeasureIt Firefox 插件](https://addons.mozilla.org/en-US/firefox/addon/539)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-18T05:58:07.700

Vim 和[打印文件](http://www.lerup.com/printfile)。PrintFile 所做的只是打印文本和 PostScript 文件，我想要的任何方式（包括剪切和粘贴）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-18T14:41:15.320

已经列出，但我必须提到[TextMate](http://macromates.com/)。我每天都使用[Mercurial 或 Hg 。](http://selenic.com/wiki/Mercurial)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-18T14:45:05.967

萤火虫。比什么都重要。

# css - CSS 层次结构类和 ID

> ID：376758
> 
> 赞同：2
> 
> 时间：2008-12-18T02:46:33.627
> 
> 标签：css, class, hierarchy

我正在使用 XHTML、CSS 和 jQuery 构建菜单，但我的 CSS 遇到了问题。 [这](http://www.levijackson.net/test/menu.htm)是我的测试页面，[这](http://www.levijackson.net/test/menu_css.css)是我的 css。

我遇到的问题是我的 .subMenu 类继承了我的#menu 的属性，背景颜色和大小是相同的。我正在寻找一种将 .subMenu 保留为类的解决方案，以便我可以重复使用它。我通过将 .subMenu 更改为 ID 使其工作。奇怪的是，我使用 .subMenu 类在我的 jQuery 代码中编辑了一些属性，它改变了这些属性。

所以我想知道是否有人可以让我知道如何解决它，如果他们可以解释它是否是一个层次结构问题。

谢谢，列维

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T03:19:00.707

我认为问题在于 #menu > li a 会将样式应用于 li 标签内的所有链接，因此子菜单内的所有 li 标签也将具有此样式。在我看来，唯一的区别在于悬停时的背景和前景色，因此您可以通过将 #menu > li a 和 #menu > li a:hover 更改为 #menu > li > a 和 #menu > 来修复它li > a:悬停。这样，顶级菜单的样式将仅应用于直接位于 #menu 项之后的 li 标记之后的链接。子菜单样式可以保持不变。

# java - 遍历非空记录集时出现 Java NullPointerException

> ID：376762
> 
> 赞同：3
> 
> 时间：2008-12-18T02:48:10.877
> 
> 标签：java, jdbc, nullpointerexception, resultset

我在 Sybase ASE 上运行一个查询，该查询产生一个`ResultSet`然后我遍历并将内容写入文件。有时，这会抛出一个`NullPointerException`，说明`ResultSet`is `null`。但是，它会在打印出一两条记录后执行此操作。其他时候，使用相同的精确输入，我不会收到任何错误。

我一直无法始终如一地产生此错误。错误消息指向一行：

```
output.print(rs.getString(1)); 
```

由于某种原因，当查询需要更长的时间运行时，似乎会发生这种情况。迄今为止的记录集回报非常小（4 到 7 条记录）。有时我必须运行应用程序 3 或 4 次，然后错误就会停止，就好像查询正在“预热”一样。我手动运行了查询，似乎没有任何性能问题。

再次感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T03:15:37.077

您确定是 ResultSet 为空，而不是 rs.getString(1)？

这是一个典型的 Java 查询

```
preparedStatement.setLong(1, primaryKey);
ResultSet rs = preparedStatement.executeQuery();
while (rs.next())
{
  String foo = rs.getString(1);
  if (foo != null)
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T03:11:14.620

我希望你会做得很好，我的意思是在调用*rs.next()*之后。

根据规格。在任何情况下，ResultSet 对象都不应为*null 。*即使没有找到记录。发布代码片段和堆栈跟踪肯定会帮助我们为您提供更好的答案。

**编辑：** 因为，错误指向那条线。它可能在*null String 上调用**toString()*方法，导致 NullPointerException。但不确定，如果传递的参数是 String 类型，它不会发生在标准输出 (System.out.println()) 中。但是您正在使用*output.print()*，所以我对此不确定。它可能在幕后对传递的 String 参数调用*toString() 。*

 **** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T08:31:13.820

是什么类型的`output`？`output.print`方法处理吗`null`？

`rs.getObject(1)`在调用之前尝试检查是否为空`output.print(rs.getString(1))`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T13:44:35.163

我找到了解决这个问题的方法——数据库连接关闭得太早了。我没有意识到，一旦关闭数据库连接，记录指针就会最终为空——我认为结果集会在系统内存中。

解决方案是在 while(rs.next()) 循环终止后关闭连接。

再次感谢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T13:50:47.420

连接是否仍然有效？你在使用连接池吗？

查看是否可以为该 JDBC 驱动程序启用调试日志记录。

看看是否可以将驱动程序升级到新版本。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-12-18T04:04:48.193

尝试包装用于访问数据的东西，例如：

if(rs!=null && rs.next()) {

// 读取内容

}

如果仍然存在将建议检查 null 本身的读取值。

# facebook - Facebook 是否有一个不是弹出窗口的“分享”？

> ID：376763
> 
> 赞同：0
> 
> 时间：2008-12-18T02:48:11.000
> 
> 标签：facebook, popup, share

我想将“在 Facebook 上分享”添加到页面。使用此 URL 格式，我可以正常工作：

[http://www.facebook.com/sharer.php?u=my.url.here](http://www.facebook.com/sharer.php?u=my.url.here)

但问题是，它是专门为弹出窗口设计的，所以

*   页面在全浏览器大小下看起来很奇怪
*   按钮离田野很远
*   提交后，页面中有消息，例如“此窗口将很快关闭”

那么，是否有一个 Facebook URL 可以做同样的事情，但不是作为弹出窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T14:23:17.770

查看 Facebook 连接

[http://developers.facebook.com/connect.php](http://developers.facebook.com/connect.php)

有没有新的 JS API...

当你把所有东西都排好时，你想调用的方法是：

FB.Connect.showFeedDialog(bundle_id, post_data, null, null, FB.FeedStorySize.full, FB.RequireConnect.promptConnect, function (w) {alert('shared');});

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-01T01:34:27.350

facebook connect javascript SDK 已更改.. 它在这里[https://developers.facebook.com/docs/reference/javascript/](https://developers.facebook.com/docs/reference/javascript/)

谢谢

# java - IntelliJ Python 插件

> ID：376765
> 
> 赞同：3
> 
> 时间：2008-12-18T02:48:26.210
> 
> 标签：java, python, ide

几周以来，我一直在 Java 开发的日常工作中使用 IntelliJ IDEA。它给我留下了深刻的印象，我希望将它扩展到我修补的其他编程语言，从 Python 开始。我找到了这个插件，[pythonid](https://pythonid.dev.java.net/)。我想在继续之前我会在堆栈上寻找一些输入。首先，有没有人尝试过 pythonid 并对它有任何反馈（它的网站有点弱）？其次，是否还有其他适用于 IntelliJ IDEA 的 Python 插件可能更好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-02-18T22:00:23.513

Intellij Python IDE (PyCharm) 目前有一个 EAP：[这里](http://confluence.jetbrains.net/display/PYH/JetBrains+PyCharm+Preview)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T04:45:44.743

我之前尝试过 Pythonid，发现它非常有限。JetBrains有一个[新的 Python 插件](http://plugins.intellij.net/plugin/?id=631)，IDEA 的制作人，看起来很不错，虽然它还[很未完成](http://www.jetbrains.net/confluence/display/PYH/Release+Notes)。

# database - 在sqlite3中，插入事务中的选择可以成功吗？

> ID：376773
> 
> 赞同：12
> 
> 时间：2008-12-18T02:52:11.103
> 
> 标签：database, sqlite, transactions, acid

我开始一个事务，即将几条记录插入到一​​个表中。我可以在事务提交之前从数据库中选择最新插入的记录吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-18T03:03:27.680

是的。

在事务中，您的应用程序可以看到所有内容。

然而，没有其他交易看到变化的任何部分。

事务的重点是使一系列语句看起来像是对数据库的一次原子更改。

如果提交，则事务中的所有语句都已完成，其他人都可以看到效果。

如果您回滚，则事务中的任何语句都不会最终确定，并且数据库不会发生任何更改。

顺便说一句，并非所有语句都可以成为事务的一部分。DDL（例如创建和删除）将结束任何先前的事务。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-04-16T23:43:44.990

是的，在交易期间或之后，您可以使用 last_insert_rowid() 函数。

last_insert_rowid() 函数返回从调用该函数的数据库连接插入的最后一行的 ROWID。

换句话说：

```
SQLite version 3.6.23
Enter ".help" for instructions
Enter SQL statements terminated with a ";"

sqlite> create table T (C);
sqlite> insert into T values ('hello');
sqlite> select last_insert_rowid();
1
sqlite> BEGIN;
sqlite> insert into T values ('test 2');
sqlite> select last_insert_rowid();
2
sqlite> select rowid,* from T;
1|hello
2|test 2
sqlite> ROLLBACK;
sqlite> select last_insert_rowid();
2
sqlite> select rowid,* from T;
1|hello
sqlite> 
```

# asp.net - ASP.NET - 使用 jQuery 的 Ajax 请求

> ID：376780
> 
> 赞同：0
> 
> 时间：2008-12-18T02:56:58.597
> 
> 标签：asp.net, jquery, ajax, formview

我有这个文本框，它使用 jQuery 触发 ajax 请求：

```
<asp:TextBox ID="postcodeTextBox" runat="server" Text='<%# Bind("POSTAL_ZIP_CODE") %>'>

$(document).ready(PageLoad);

function PageLoad() {
    $(container + 'parentProjectTextBox').change(GetProjectName);
}

function GetProjectName() {
    var projectNumber = $(this).val();
    if (projectNumber == '') return;
    $(container + 'parentProjectPanel').block({ message: '<img src="../Resources/RadControls/Ajax/Skins/Default/loading7.gif" />' });
    $.ajax({
        type: 'POST',
        url: projectMasterWebServicesUrl + 'GetProjectName',
        data: "{'projectNumber':'" + projectNumber + "'}",
        contentType: 'application/json; charset=utf-8',
        dataType: 'json',
        success: GetProjectNameOnSuccess,
        error: GetProjectNameOnError
    });
} 
```

这个 ajax 请求获取一个列表来填充这个下拉列表：

```
 <asp:DropDownList ID="cityDropDownList" runat="server" OnDataBound="cityDropDownList_DataBound">
                            <asp:ListItem Text="...Select..." Value="0">
                            </asp:ListItem>
                        </asp:DropDownList> 
```

一切正常。我遇到的唯一问题是，当我更新我的 formView 以保存该记录时，我看不到设置为该下拉列表的值。当我在客户端填充这个下拉列表时，我假设 ASP.NET 失去了对它的跟踪......

有没有人有任何见解？

显然，当我打开/关闭该页面的 EnableEventValidation 属性时，有时会得到正确的值.....

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T03:02:04.220

您应该创建一个隐藏字段来存储该值。在您的 Javascript 中更新该 HiddenField，然后在服务器端读取它。此外，如果您有 EventValidation=true 并且您更改下拉列表中的项目，您将获得众所周知的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T04:12:12.797

这可能不是问题...但是您是否在 Page_Load 中检查 Page.IsPostBack？

我犯过这样的错误太多次了。

如果您正在从 Page_Load 加载该下拉控件，并且您没有检查是否 (!Page.IsPostback) 您将重新加载该控件。然后，当您从下拉列表中获取值时...该值消失了，因为您重新加载了下拉列表。

# delphi - Delphi 的 $WARN 编译器指令的标识符

> ID：376785
> 
> 赞同：50
> 
> 时间：2008-12-18T02:58:39.123
> 
> 标签：delphi, warnings

Delphi 有一个 $WARN 编译器指令，它允许有选择地启用或禁用特定的警告。Delphi 2009 帮助文件描述了语法：

```
{$WARN identifier ON|OFF} 
```

但它只列出了 6 个警告的标识符。

我想要一份所有警告标识符的完整列表。特别是，我想知道 Delphi 2009 中隐式字符串强制转换警告 W1057 和 W1058 的标识符。

我设法猜到了隐式 Ansi->Unicode casts (W1057) 的那个：

```
{$WARN IMPLICIT_STRING_CAST OFF} 
```

谷歌搜索发现我另一个：

```
{$WARN IMPLICIT_STRING_CAST_LOSS OFF} 
```

虽然这解决了我的迫切需求，但我仍然想知道警告标识符的完整列表。这样的事情应该记录在案。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-12-18T06:10:14.900

Darian 认为 DCCStrs.pas 列出了 Delphi 编译器使用的标识符的权利。我没有想到要搜索源代码，因为 Delphi 没有将源代码包含在其编译器中。

我已经从该文件中提取了提示和警告的标识符：

*   `{$WARN ASG_TO_TYPED_CONST OFF}`
*   `{$WARN BAD_GLOBAL_SYMBOL OFF}`
*   `{$WARN BOUNDS_ERROR OFF}`
*   `{$WARN CASE_LABEL_RANGE OFF}`
*   `{$WARN COMBINING_SIGNED_UNSIGNED OFF}`
*   `{$WARN COMPARING_SIGNED_UNSIGNED OFF}`
*   `{$WARN COMPARISON_FALSE OFF}`
*   `{$WARN COMPARISON_TRUE OFF}`
*   `{$WARN CONSTRUCTING_ABSTRACT OFF}`
*   `{$WARN CVT_ACHAR_TO_WCHAR OFF}`
*   `{$WARN CVT_NARROWING_STRING_LOST OFF}`
*   `{$WARN CVT_WCHAR_TO_ACHAR OFF}`
*   `{$WARN CVT_WIDENING_STRING_LOST OFF}`
*   `{$WARN DUPLICATE_CTOR_DTOR OFF}`
*   `{$WARN DUPLICATES_IGNORED OFF}`
*   `{$WARN EXPLICIT_STRING_CAST OFF}`
*   `{$WARN EXPLICIT_STRING_CAST_LOSS OFF}`
*   `{$WARN FILE_OPEN OFF}`
*   `{$WARN FILE_OPEN_UNITSRC OFF}`
*   `{$WARN FOR_LOOP_VAR_UNDEF OFF}`
*   `{$WARN FOR_LOOP_VAR_VARPAR OFF}`
*   `{$WARN FOR_VARIABLE OFF}`
*   `{$WARN GARBAGE OFF}`
*   `{$WARN HIDDEN_VIRTUAL OFF}`
*   `{$WARN HIDING_MEMBER OFF}`
*   `{$WARN HPPEMIT_IGNORED OFF}`
*   `{$WARN HRESULT_COMPAT OFF}`
*   `{$WARN IMAGEBASE_MULTIPLE OFF}`
*   `{$WARN IMPLICIT_IMPORT OFF}`
*   `{$WARN IMPLICIT_STRING_CAST OFF}`
*   `{$WARN IMPLICIT_STRING_CAST_LOSS OFF}`
*   `{$WARN IMPLICIT_VARIANTS OFF}`
*   `{$WARN INVALID_DIRECTIVE OFF}`
*   `{$WARN LOCAL_PINVOKE OFF}`
*   `{$WARN LOCALE_TO_UNICODE OFF}`
*   `{$WARN MESSAGE_DIRECTIVE OFF}`
*   `{$WARN NO_CFG_FILE_FOUND OFF}`
*   `{$WARN NO_RETVAL OFF}`
*   `{$WARN OPTION_TRUNCATED OFF}`
*   `{$WARN PACKAGE_NO_LINK OFF}`
*   `{$WARN PACKAGED_THREADVAR OFF}`
*   `{$WARN PRIVATE_PROPACCESSOR OFF}`
*   `{$WARN RLINK_WARNING OFF}`
*   `{$WARN STRING_CONST_TRUNCED OFF}`
*   `{$WARN SUSPICIOUS_TYPECAST OFF}`
*   `{$WARN SYMBOL_DEPRECATED OFF}`
*   `{$WARN SYMBOL_EXPERIMENTAL OFF}`
*   `{$WARN SYMBOL_LIBRARY OFF}`
*   `{$WARN SYMBOL_PLATFORM OFF}`
*   `{$WARN TYPED_CONST_VARPAR OFF}`
*   `{$WARN TYPEINFO_IMPLICITLY_ADDED OFF}`
*   `{$WARN UNICODE_TO_LOCALE OFF}`
*   `{$WARN UNIT_DEPRECATED OFF}`
*   `{$WARN UNIT_EXPERIMENTAL OFF}`
*   `{$WARN UNIT_INIT_SEQ OFF}`
*   `{$WARN UNIT_LIBRARY OFF}`
*   `{$WARN UNIT_NAME_MISMATCH OFF}`
*   `{$WARN UNIT_PLATFORM OFF}`
*   `{$WARN UNSAFE_CAST OFF}`
*   `{$WARN UNSAFE_CODE OFF}`
*   `{$WARN UNSAFE_TYPE OFF}`
*   `{$WARN UNSUPPORTED_CONSTRUCT OFF}`
*   `{$WARN USE_BEFORE_DEF OFF}`
*   `{$WARN WIDECHAR_REDUCED OFF}`
*   `{$WARN XML_CREF_NO_RESOLVE OFF}`
*   `{$WARN XML_EXPECTED_CHARACTER OFF}`
*   `{$WARN XML_INVALID_NAME OFF}`
*   `{$WARN XML_INVALID_NAME_START OFF}`
*   `{$WARN XML_NO_MATCHING_PARM OFF}`
*   `{$WARN XML_NO_PARM OFF}`
*   `{$WARN XML_UNKNOWN_ENTITY OFF}`
*   `{$WARN XML_WHITESPACE_NOT_ALLOWED OFF}`
*   `{$WARN ZERO_NIL_COMPAT OFF}`

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-18T05:05:55.543

我查看了帮助并没有看到完整的列表...所以查看代码，编译器警告常量都列在：CodeGear\RAD Studio\6.0\sources\toolsapi\DCCStrs.pas

搜索“Implicit_String_Cast_Loss”，你会看到常量 sIMPLICIT_STRING_CAST_LOSS = 'DCC_IMPLICIT_STRING_CAST_LOSS';

我会假设具有相应 X_true/_false/_error 定义的其余 DCC_xxx 字符串是您所追求的。

自 Delphi 7 以来，在线帮助一直不太好。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-12-19T00:14:21.047

Delphi 2009 文档中未提及的其他内容：

除了 ON 和 OFF 之外，$WARN 指令现在还有第三个选项 ERROR。所以你可以拥有：

```
{$WARN IMPLICIT_STRING_CAST OFF} to disable the warning
{$WARN IMPLICIT_STRING_CAST ON} to enable warning
{$WARN IMPLICIT_STRING_CAST ERROR} to turn the warning into an error 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-01-17T13:13:42.743

> 像这样的东西应该记录在案

截至今天，标识符及其编译器警告编号的完整列表列在以下文档中：

[http://docwiki.embarcadero.com/RADStudio/en/Warning_messages_(Delphi)](http://docwiki.embarcadero.com/RADStudio/en/Warning_messages_(Delphi))

**摘抄：**

> $WARN 指令中的标识符可以具有以下任何值：
> 
> ```
> | 警告 | 标识符 |
> |:-----------------:|:----------:|
> | SYMBOL_DEPRECATED | W1000 |
> | SYMBOL_LIBRARY | W1001 |
> | (...) | (...) |
> 
> ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-01T18:45:27.247

如果按*Ctrl+O*两次，它会将所有编译器指令添加到单元顶部，包括所有警告。找到你想要的并删除其余的。

# html - 什么是 VHTML？这个怎么运作？我在哪里可以找到有关它的信息？

> ID：376786
> 
> 赞同：2
> 
> 时间：2008-12-18T02:58:45.130
> 
> 标签：html, smalltalk

下面的代码会继续很多行，直到它以预期的 /veotherwise /vechoose 结尾。不久前，我开始在一家开发公司工作，他们使用这个名为 vhtml 的 html 版本。我在网上搜索过，但它为 vhtml 带来了不同的定义。我在 Joomla 中看到了一些关于 vhtml 的帖子，但它们看起来不像下面的代码。我期待获得有关如何理解该语言的指示。

它看起来与普通的 html 非常相似，甚至具有非常相似的命令，或者可能是 smalltalk。但我只能破译它。任何帮助将不胜感激。如果您想了解更多信息，请发表评论。

```
<vechoose>
  <vewhen criteria='isPortalEdit'>
    widget: practices-landing-page
  </vewhen>
  <veotherwise>
    <veinclude src='private/webportal/webtemplate-content.vhtml'>
      <vesection name='content-body'>

        <% // Determine portlet visibility %>
        <vecalc expression='isEmpty = false' output='none' />

        <vechoose>
          <vewhen criteria='isEmpty'>
            <veif criteria='portlet.ifEmptyDo == "Hide"'>
              <script>getTag( 'portlet_<%=portlet.order%>' ).style.display = "none";</script>
            </veif>
            <veif criteria='portlet.ifEmptyDo == "Show Message"'>
              <%#portlet.ifEmptyMessage%>
            </veif>
          </vewhen>
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-18T06:53:41.520

设法找到这个： http: [//vitrage.sibweb.ru/english/](http://vitrage.sibweb.ru/english/) 看起来它可能是一个名为 VITRAGE 的 Apache 模块。但是英文版的不多，所以我真的不确定它是否匹配。

在阅读您发布的代码示例时，它看起来像是一种 XML 样式的过程语言。您确定它在其他地方可用，或者可能是内部开发的东西吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T21:57:28.643

我认为这是一种将服务器端方面带入浏览器显示的内部语言。我一直找不到关于这种语言的文档，而且我认为 Vitrage 没有解释它。服务器使用 coyote 作为 web 浏览器，tomcat 作为 servlet 处理程序，java 作为后端。

任何新信息请发布。

# c# - 换行符在 C#/ASP.NET 1.1 代码中意外转义

> ID：376793
> 
> 赞同：1
> 
> 时间：2008-12-18T03:02:02.517
> 
> 标签：c#, asp.net

有人可以向我解释为什么我的代码：

```
string messageBody = "abc\n" + stringFromDatabaseProcedure; 
```

其中 valueFromDatabaseProcedure 不是 SQL 数据库中输入的值

```
'line1\nline2' 
```

结果字符串：

```
"abc\nline1\\nline2" 
```

这导致我有些摸不着头脑。

我正在使用 ASP.NET 1.1。

**澄清，**

我正在创建字符串，我需要在表单提交时进入电子邮件正文。我提到了 ASP.NET 1.1，因为在控制台应用程序中使用 .NET 2.0 并没有得到相同的结果。

我所做的只是添加字符串，当我查看 messageBody 字符串时，我可以看到它已经转义了值字符串。

**更新** 根本没有帮助我的是 Outlook 没有在文本电子邮件中正确显示 \n（除非您回复转发它）。在线邮件查看器（甚至是 Exchange 网络邮件）将 \n 显示为应有的新行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T04:04:12.127

我刚刚对测试 NorthwindDb 进行了快速测试，并在中间放入了一些带有 \n 的垃圾数据。然后我直接使用 ADO.NET 查询数据，你知道吗，它实际上会自动为你转义反斜杠。它与 n 无关，它只是看到反斜杠并为您转义。事实上，我也把它放到了 db: foo"bar 中，当它在 C# 中返回时它是 foo\"bar，它也为我逃脱了。我的意思是，它试图在 SQL 端保留数据，因此它正在逃避它认为需要逃避的东西。我还没有找到关闭它的设置，但如果我这样做了，我会告诉你...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T03:05:14.790

ASP.NET 将用于`<br />`进行换行符。 `\n`将与控制台应用程序或 Windows 窗体应用程序一起使用。您是否将其输出到网页？

**方法#1**

```
string value = "line1<br />line2";
string messageBody = "abc<br />" + value; 
```

如果这不起作用，请尝试：

```
string value = "line1<br>line2";
string messageBody = "abc<br>" + value; 
```

**方法#2**

使用[System.Environment.NewLine](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)：

```
 string value = "line1"+ System.Environment.NewLine + "line2";
 string messageBody = "abc" System.Environment.NewLine + value; 
```

保证其中一种方法有效。如果您要将字符串输出到网页（或电子邮件或表单提交），*则必须*使用我提到的一种方式。`\n`永远不会在那里工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T03:52:04.447

您需要设置一个监视并查看您的数据库结果字符串在何处被双重转义。

将两个字符串加在一起永远不会加倍转义字符串，因此它要么在此之前发生，要么在此之后发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T19:57:41.313

当我从数据库中取出字符串时，.NET 会自动转义它。但是，小 @ 符号附加到字符串中，我没有注意到。

因此，在 ide 中，我的“即将去度假”的眼睛*似乎无法逃脱。*

因此，当未转义的 \n 添加到字符串时（因为不再转义整个字符串），它将删除 @ 并显示转义字符串的数据库部分。

呸，一切都是错觉。

或许这个假期已经过时了。

感谢您的输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T22:17:22.107

如果存储在数据库中的实际字符串是（为强调而添加了空格）：“line 1 \ nline 2”，那么无论存储在那里的任何内容都可能存在错误。但是假设那是那里的确切字符串，那么“abc\nline1\nline2”字符串就是当您查看在
转义它的调试器中打印为“abc line1\nline2”的字符串时会发生的情况（这是一种方便，允许您从调试器中直接复制粘贴到代码中而不会出错）。

简短的回答：.NET 没有转义字符串，你的调试器是。将文字“\n”写入数据库的代码有一个错误。

# java - 在哪里初始化 java Properties 对象？

> ID：376798
> 
> 赞同：3
> 
> 时间：2008-12-18T03:03:12.187
> 
> 标签：java, properties

我继承了一个应用程序，它使用 java 属性文件来定义配置参数，例如数据库名称。

有一个名为 MyAppProps 的类，如下所示：

```
public class MyAppProps {

   protected static final String PROP_FILENAME = "myapp.properties";
   protected static Properties myAppProps = null;

   public static final String DATABASE_NAME = "database_name";
   public static final String DATABASE_USER = "database_user";
   // etc...

   protected static void init() throws MyAppException {
     try {
       Classloader loader = MyAppException.class.getClassLoader();
       InputStream is = loader.getResourceAsStream(PROP_FILENAME);
       myAppProps = new Properties();
       myAppProps.load(is);
     } catch (Exception e) {
       threw new MyAppException(e.getMessage());
     }
    }

    protected static String getProperty(String name) throws MyAppException {
      if (props==null) {
        throw new MyAppException("Properties was not initialized properly.");
      }
      return props.getProperty(name);
    }
  } 
```

其他需要获取属性值的类包含以下代码：

```
String dbname = MyAppProps.getProperty(MyAppProps.DATABASE_NAME); 
```

当然，在第一次调用 MyAppProps.getProperty 之前，MyAppProps 需要像这样初始化：

```
MyAppProps.init(); 
```

我不喜欢`init()`需要调用的事实。初始化不应该发生在静态初始化块或私有构造函数中吗？

除此之外，代码似乎还有其他问题，我不能完全确定它。属性实例通常包装在自定义类中吗？这里还有什么不对的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-18T04:01:14.660

如果我像这样制作自己的包装类；我总是更喜欢为值创建强类型的 getter，而不是通过静态最终变量公开所有内部工作。

```
private static final String DATABASE_NAME = "database_name"
private static final String DATABASE_USER = "database_user"
public String getDatabaseName(){
   return getProperty(MyAppProps.DATABASE_NAME);
}
public String getDatabaseUser(){
   return getProperty(MyAppProps.DATABASE_USER);
} 
```

静态初始化程序如下所示；

```
static {
   init();
} 
```

话虽这么说，我很容易说我不是静态初始化器的忠实粉丝。

您可以考虑研究依赖注入 (DI) 框架，例如 spring 或 guice，这些框架可以让您将适当的值直接注入到需要使用它们的地方，而不是通过附加类的间接访问。很多人发现使用这些框架可以减少对这种管道代码的关注——但只有在你完成了框架的学习曲线之后。（DI 框架学起来很快，但需要相当长的时间来掌握，所以这可能是一个比你真正想要的更大的锤子）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T04:20:41.830

使用静态初始化器的原因：

*   不能忘记叫它

使用 init() 函数的原因：

*   您可以将参数传递给它
*   更容易处理错误

我过去创建了属性包装器，效果很好。对于像示例这样的类，重要的是要确保属性是真正全局的，即单例确实有意义。考虑到这一点，自定义属性类可以具有类型安全的 getter。您还可以在自定义 getter 中做一些很酷的事情，例如变量扩展，例如：

```
myapp.data.path=${myapp.home}/data 
```

此外，在您的初始化程序中，您可以利用属性文件重载：

*   从类路径加载“myapp.properties”
*   使用属性覆盖构造函数从当前目录加载“myapp.user.properties”
*   最后，加载 System.getProperties() 作为最终覆盖

“用户”属性文件没有进入版本控制，这很好。它避免了人们自定义属性文件并意外使用硬编码路径检入的问题等。

美好时光。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T03:17:20.663

您可以使用静态块或构造函数。我唯一的建议是改用 ResourceBundle。这可能更适合您的要求。更多信息请点击以下链接。

**编辑：** [ResourceBundles 与属性](http://www.russellbeattie.com/notebook/1007850.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T06:42:03.147

静态方法和类的问题是您不能为测试替身覆盖它们。这使得单元测试更加困难。我将所有变量声明为最终变量并在构造函数中初始化。无论需要什么都作为参数传递给构造函数（依赖注入）。这样，您可以在单元测试期间用测试替身代替某些参数。

例如：

```
public class MyAppProps {

   protected static final String PROP_FILENAME = "myapp.properties";
   protected Properties props = null;

   public String DATABASE_NAME = "database_name";
   public String DATABASE_USER = "database_user";
   // etc...

   public MyAppProps(InputStream is) throws MyAppException {
     try {
       props = new Properties();
       props.load(is);
     } catch (Exception e) {
       threw new MyAppException(e.getMessage());
     }
    }

    public String getProperty(String name) {
      return props.getProperty(name);
    }
    // Need this function static so
    // client objects can load the
    // file before an instance of this class is created.
    public static String getFileName() {
      return PROP_FILENAME;
    }
} 
```

现在，从生产代码中调用它，如下所示：

```
String fileName = MyAppProps.getFileName();
Classloader loader = MyAppException.class.getClassLoader();
InputStream is = loader.getResourceAsStream(fileName);
MyAppProps p = new MyAppProps(is); 
```

依赖注入是指在构造函数参数中包含输入流。虽然这比仅使用静态类/单例更痛苦，但在进行单元测试时，事情变得从不可能到简单。

对于单元测试，它可能类似于：

```
@Test
public void testStuff() {
    // Setup
    InputStringTestDouble isTD = new InputStreamTestDouble();
    MyAppProps instance = new MyAppProps(isTD);

    // Exercise
    int actualNum = instance.getProperty("foo");

    // Verify
    int expectedNum = 42;
    assertEquals("MyAppProps didn't get the right number!", expectedNum, actualNum);
} 
```

依赖注入使得替换输入流的测试替身变得非常容易。现在，只需将您想要的任何东西加载到测试替身中，然后再将其提供给 MyAppProps 构造函数。通过这种方式，您可以非常轻松地测试属性是如何加载的。

# asp.net - 从类生成数据库结构的 ORM

> ID：376803
> 
> 赞同：3
> 
> 时间：2008-12-18T03:07:21.073
> 
> 标签：asp.net, orm

我看过 NHibernate 和 EntitySpaces，它们的工作方式似乎都不同。

在 EntitySpaces 中，您定义数据库表和表关系，并为您生成类。

在 NHibernate 中，您定义类并为您生成表关系。这就是我要找的。

是否有任何其他 ASP.NET ORM 可以从 NHibernate 等类生成表？有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-15T11:11:11.820

DataObjects.Net 也使用“代码优先”（Model first）的方法。请参阅[http://wiki.dataobjects.net/index.php?title=Features](http://wiki.dataobjects.net/index.php?title=Features)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T03:14:53.023

[Linq to SQL 可以使用dataContext.CreateDatabase()](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.createdatabase.aspx)方法从类创建数据库表结构和关系。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T21:40:33.050

Mindscape LightSpeed 提供了这种能力 - 完整方案往返的一部分。

希望这可以帮助

[http://www.mindscape.co.nz/blog/index.php/2008/06/17/schema-round-tripping-in-the-lightspeed-designer/](http://www.mindscape.co.nz/blog/index.php/2008/06/17/schema-round-tripping-in-the-lightspeed-designer/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T17:36:05.047

我更喜欢一种我可以完全控制的方法来生成我需要的东西。在 ORM 的情况下，我得到了与我的表匹配的类。我相信使用我自己的源自我的业务而不是底层数据存储的对象域是正确的方法。代表我的业务数据的类层次结构应该 100% 独立于数据存储。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-23T21:34:02.453

[LightSpeed](http://www.mindscape.co.nz/products/LightSpeed/)有一个非常好的 Visual Studio 设计器，它支持从数据库生成 .NET 实体类和从 .NET 实体更新数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T03:56:49.223

这是 NHibernate 所做的事情。

并且关于这个主题（那个 Draemon）开始了。我个人的观点是，除非性能是您绝对的第一要务，并且所有其他事情都必须受到影响才能实现这一点（例如，在为制造工厂编写软件时），否则您最好先处理域模型。

我的理由是：与对数据库本身进行编码相比，您对域进行编码所花费的时间要多得多——尤其是在使用 orm 时。所以要明智地度过这段时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T17:18:41.510

我在使用 Genome ORM 时取得了相当大的成功。它为你做了很多工作。您可以首先设计您的域模型，然后从中生成数据库脚本。除了这个基因组为你生成 DTO。它非常擅长这一点，并节省了开发人员的大量时间。

[http://www.genom-e.com](http://www.genom-e.com)

# haskell - 是否可以将此递归haskell 函数转换为地图调用？

> ID：376812
> 
> 赞同：7
> 
> 时间：2008-12-18T03:14:28.997
> 
> 标签：haskell, recursion

这是我的代码：

```
type HoraAtendimento = (String, Int, Int)

htmlHAtendimento :: [HoraAtendimento] -> Html
htmlHAtendimento [] = toHtml ""
htmlHAtendimento ((da,hia,hfa):[]) = toHtml da +++ "feira "
                                     +++
                                     show hia +++ "h - " +++ show hfa +++ "h"
htmlHAtendimento ((da,hia,hfa):r) = toHtml da +++ "feira "
                                    +++
                                    show hia +++ "h - " +++ show hfa +++ "h, "
                                    +++
                                    htmlHAtendimento r 
```

我正在寻找一种使用 map 函数并摆脱这个递归函数的方法。这可能吗？如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-18T03:48:09.633

看类型`map`。它是`(a -> b) -> [a] -> [b]`。这看起来不像你的类型，即 [a] -> b。那不是地图，那是折叠。

您要查看的高阶函数是`foldr`。参见[Hoogle](http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v%3Afoldr)。

就像是...

```
htmlHAtendimento :: [HoraAtendimento] -> Html
htmlHAtendimento [] = toHtml ""
htmlHAtendimento l = foldr1 (+++) $ intersperse ", " $ map f l
  where f (da, hia, hfa) = toHtml da
                           +++ "feira "
                           +++ show hia
                           +++ "h - "
                           +++ show hfa
                           +++ "h" 
```

我不知道这是否正确，但这是正确的方向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T03:55:07.933

你想折叠一个非空列表。这段代码可能会奏效：

```
type HoraAtendimento = (String, Int, Int)

htmlHAtendimento :: [HoraAtendimento] -> Html
htmlHAtendimento [] = toHtml ""
htmlHAtendimento l = foldl1 (+++) $ map convert l
  where convert (da,hia,hfa) = toHtml da +++ "feira " +++
                               show hia +++ "h - " +++ show hfa +++ "h" 
```

# chess - 一个字节的尾随/前导零计数

> ID：376840
> 
> 赞同：2
> 
> 时间：2008-12-18T03:33:56.837
> 
> 标签：chess, bitcount

我正在使用 Java，我正在编写一个国际象棋引擎。

我试图在一个字节中找到前 1 位的索引和最后 1 位的索引。

我目前在 Java 中使用 Long.numberOfTrailingZeros() （或类似的东西），并希望模拟该功能，除了字节。

会不会是这样的：

```
byte b = 0b011000101;
int firstOneBit = bitCount ((b & -b) - 1); 
```

如果是这样，我将如何相对有效地实现 bitCount。我不介意好的解释，请不要只给我代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T03:41:29.770

使用包含 256 个条目的查找表。创建它：

```
unsigned int bitcount ( unsigned int i ) {
unsigned int r = 0;
while ( i ) { r+=i&1; i>>=1; } /* bit shift is >>> in java afair */
return r; 
} 
```

这当然不需要很快，因为您最多可以执行 256 次来初始化您的表格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T04:30:10.327

正确的答案是大多数处理器都有一些特殊的指令来做这种事情（前导零、尾随零、1 的数量等）。x86 有 bsf/bsr，powerpc 有 clz，等等。希望 Integer.numberOfTrailingZeros 足够聪明来使用这些，但这可能是有机会在 Java 中使用这种特定于平台的函数的唯一方法（如果它甚至使用它们）。

[Aggregate Magic Algorithms](http://aggregate.org/MAGIC/)是另一个有一些解决这类问题的方法的地方，从显而易见的（查找表）到一些相当聪明的 SWAR 方法。但是我怀疑如果Java运行时对后者很聪明，它们都会输给 Integer(x).numberOfTrailingZeros() ；应该可以优化拳击并为 numberOfTrailingZeros 使用特定于平台的技术，如果两者都这样做，那将获胜。

只是为了完整起见，另一个出色的位敲击经典档案是旧的[MIT HAKMEM](http://home.pipeline.com/~hbaker1/hakmem/hacks.html)集合（如果您的 PDP-6/10 汇编程序技能生锈，还有一个半现代化的[C 版本）。](http://www.cl.cam.ac.uk/~am21/hakmemc.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-01T12:22:40.653

```
/* Count Leading Zeroes */

static uint8_t clzlut[256] = {
  8,7,6,6,5,5,5,5,
  4,4,4,4,4,4,4,4,
  3,3,3,3,3,3,3,3,
  3,3,3,3,3,3,3,3,
  2,2,2,2,2,2,2,2,
  2,2,2,2,2,2,2,2,
  2,2,2,2,2,2,2,2,
  2,2,2,2,2,2,2,2,
  1,1,1,1,1,1,1,1,
  1,1,1,1,1,1,1,1,
  1,1,1,1,1,1,1,1,
  1,1,1,1,1,1,1,1,
  1,1,1,1,1,1,1,1,
  1,1,1,1,1,1,1,1,
  1,1,1,1,1,1,1,1,
  1,1,1,1,1,1,1,1,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0
};

uint32_t clz(uint32_t val)
{
  uint32_t accum = 0;

  accum += clzlut[val >> 24];
  accum += (accum == 8 ) ? clzlut[(val >> 16) & 0xFF] : 0;
  accum += (accum == 16) ? clzlut[(val >>  8) & 0xFF] : 0;
  accum += (accum == 24) ? clzlut[ val        & 0xFF] : 0;

  return accum;     
} 
```

### 解释：

这是通过将每个字节排列的前导零的数量存储为查找表来实现的。您使用字节值来查找该值的前导零的计数。由于该示例针对 unsigned int 执行此操作，因此您移动并屏蔽了四个单独的字节，并相应地累积查找。一旦我们找到设置的位，三元语句用于停止累积。累加值为 8、16 或 24 意味着到目前为止没有找到设置位。

此外，一些架构对此有硬件支持（作为指令）。汇编助记符通常称为“CLZ”或“BSR”。它们分别是“Countleading Zeroes”和“Bit Scan Reverse”的缩写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T21:18:40.677

如果您认为这`Long.numberOfTrailingZeros`很快（即 JIT 编译/优化以在可用时使用单个 ASM 指令），那么您为什么不能简单地做这样的事情：

```
max(8,Long.numberOfTrailingZeros(val)) 
```

其中 val 是转换为 Long 的字节值。这也是假设它`max()`可用并再次优化以使用 asm select 或 max 指令。

理论上，在支持它的机器上，这些操作可以被 JIT 编译成两条汇编指令。

# delphi - Delphi 跨表单共享图像列表的问题

> ID：376844
> 
> 赞同：5
> 
> 时间：2008-12-18T03:35:48.863
> 
> 标签：delphi

多年来，我一直在 Delphi 的多个表单中共享图像列表。我在我的应用程序的主窗体上有一个 TImageList，然后我有其他具有组件的窗体，我在设计时将图像属性设置为主窗体（例如 MyMainForm.MyImageList）中的图像列表。

我遇到的问题是，在那些引用主表单上的图像列表的表单上，Images 属性会随机清除。

这似乎是最近才开始的，但我还不能确定确切的原因。我似乎无法找到随意重现问题的方法；它似乎只是随机发生的。我确实注意到它在打开表单时发生。

我最近在 Delphi 中所做的一件事是我启用了 Autosave Project 桌面和符号功能。所以现在当我打开这个项目时，它总是记得打开了哪些表单。因此，因为这个问题是在打开表单时发生的，并且因为它现在重新打开了上次打开项目时打开的所有表单，所以它发生得更频繁。

我们有几个开发人员在做这个项目，我们正在使用 SVN 进行版本控制。启用自动保存项目桌面和符号功能导致的一个问题是，当我们对项目进行 SNV 更新时，符号文件可能会变得无效（因为我们没有版本控制下的符号文件）。这只会导致来自 Delphi 的错误消息，但除此之外它似乎无害。我们只需重新编译项目并修复符号文件。

顺便说一句，我正在使用 Delphi 7。

如果您有任何问题或需要澄清，请发表评论，我会更新问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T00:39:43.600

多年前我遇到了同样的问题。从那时起，我就养成了将由多个表单共享的图像列表放入 TDataModule 的习惯。然后 Delphi 不会丢失链接。将非可视组件放在数据模块上还可以减少表单上的设计时间混乱。在运行时，TDataModule 在主窗体之前被实例化。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-18T03:41:18.320

当我遇到这种类型的行为时，总是因为我打开了“其他”表单而没有在 IDE 中打开主表单...... IDE 将尝试解析 MyMainForm.MyImageList 引用，失败并删除该引用.

我们通过在代码中手动分配图像列表（通常在 AfterConstruction 中）来解决这个问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-18T03:43:17.647

啊 - 并且“自动保存项目桌面”功能有时会以“反向”顺序打开文件（因此，表单） - 加剧了 IDE-doesn't-know-about-MyMainForm “功能”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-18T10:11:07.737

我把某种共享的东西放到数据模块而不是表单上。试试这种方式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T05:32:35.990

我做了一堆实验，得到了一些非常奇怪的结果。但是我确实进行了一些更改，因此我可以在不发生此问题的情况下处理我的项目。我不得不禁用自动保存功能（这可以防止可能引用主表单的辅助表单在主表单之前打开）。然后我必须确保删除项目的 .dsk 文件（项目桌面 AutoSave 文件）。所以现在当我打开项目时，它总是打开主窗体，所以我从来没有遇到过对主窗体的引用被清除的问题。但是，如果在打开项目后我关闭主窗体然后打开一个引用主窗体的窗体，我仍然会遇到问题。

此外，即使我可以在当前项目中禁用 AutoSave 的情况下重现它，我也无法重现在禁用 AutoSave 功能的全新项目中清除另一个表单的引用问题。我不知道为什么，但我觉得这不值得进一步调查。

以下是我在现有项目上进行的一些实验的数据。WORKS 表示对主窗体的引用很好。BUG 表示对主窗体的引用被清除。这是通过启用 AutoSave 完成的，并且总是在我关闭项目之前手动关闭所有表单。

* * *

1.  打开项目
2.  打开主窗体
3.  打开二级表格
4.  结果：工作

* * *

1.  打开项目
2.  打开二级表格
3.  结果：BUG

* * *

1.  打开项目
2.  打开主窗体
3.  关闭主窗体
4.  从二级开
5.  结果：BUG

* * *

1.  打开项目
2.  打开中学形式
3.  结果：BUG
4.  将辅助窗体上组件的图像属性设置为主窗体上的图像列表
5.  关闭二级表格
6.  打开二级表格
7.  结果：有效（“缓存”参考仅用于辅助形式；请参阅下面的“缓存”解释）

* * *

1.  打开项目
2.  打开魔法形式（参见下文了解什么是“魔法”形式的解释）
3.  结果：WORKS（“缓存”所有表单对主表单的任何引用；参见下文“缓存”解释）

* * *

其他有趣的发现：

*   当您打开表单并且图像列表没有显示时，.dfm 被修改，但是 delphi 并没有说文件被修改（例如，如果您关闭表单，它不会警告您未保存的更改）。只有在表单上按保存后，dfm 才会清除 imagelist 引用。
*   我注意到我的项目中有一些“神奇”的形式（因为没有更好的术语）。魔术表单在其 .dfm 中引用我项目的主表单，并且在您打开它们后它们不会丢失对主表单的引用，即使它们在任何其他表单之前打开也是如此。
*   这些神奇的表单会导致主表单中所有图像列表引用的“缓存”。一旦您打开这些表单之一，您就可以打开任何引用主表单的表单，并且在此项目会话期间它不会丢失它的引用（即使魔术表单随后关闭）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-18T09:36:42.860

项目中是否包含 mainform.pas？不仅作为 .pas 中某处的“使用 mainform.pas”，而且作为

```
 fMainForm in 'fMainForm.pas' {MainForm}, 
```

在您的应用程序**.dpr** 中。该注释*{MainForm}*对于 Delphi 是必需的 - 用于解析继承的表单和它们之间的链接。

# asp.net - 过期输出缓存 ASP.Net MVC

> ID：376851
> 
> 赞同：16
> 
> 时间：2008-12-18T03:40:29.837
> 
> 标签：asp.net, asp.net-mvc, caching, outputcache

我在我的 MVC 应用程序中使用标准的 outputcache 标记，效果很好，但我需要强制它在某些时候被转储。我如何实现这一目标？被缓存的页面是从一个非常简单的路由 {Controller}/{PageName} 构建的 - 所以大多数页面都是这样的：/Pages/About-Us

为了清楚起见，这是位于我的 .aspx 视图页面顶部的输出缓存标记：

```
<@ OutputCache Duration="100" VaryByParam="None" %> 
```

因此，在更新内容的同一控制器上的另一个操作中，我需要转储此缓存，甚至转储所有缓存 - 这是一个非常小的应用程序，因此转储所有缓存项目并不是什么大问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-28T01:05:52.950

小心使用“无”与“”。

*   如果您发送“”，则*不会*发送[Vary](http://www.w3.org/Protocols/HTTP/Issues/vary-header.html)的 HttpHeader 。
**   *如果您发送“无”，则发送*[Vary](http://www.w3.org/Protocols/HTTP/Issues/vary-header.html) 的 HttpHeader 。*

 **我使用[Fiddler](http://www.fiddle2.com/)来验证这种行为。

这似乎会影响浏览器是否返回服务器以检查最新版本（导致 304）。至少在 Chrome 中是这样。`Varies=""`如果您确定不想在文件过期之前更新文件，则可以使用它。

我建议`Varies=""`像在[这篇文章](https://stackoverflow.com/questions/486063/what-clever-things-have-you-done-with-an-asp-net-mvc-actionresult)中那样使用。对于我的 javascript 文件，我不希望浏览器返回并发出另一个 Http 请求，直到它过期。304 是不必要的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-18T03:58:19.300

`HttpResponse.RemoveOutputCacheItem()`可能是您要使用的方法。如果您可以确定动作缓存在什么名称下，则可以仅删除特定动作（尝试设置断点或将所有缓存项的名称转储到屏幕上）

否则，我将遍历整个输出缓存并清除每个项目。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-08-13T22:25:27.407

不知道 VaryByParam 的“无”和“”之间的区别，我使用了这个属性：

```
[OutputCache(Location=OutputCacheLocation.ServerAndClient, Duration=int.MaxValue, VaryByParam="none")] 
```

这段代码“修复”了这个`Vary: *`问题：

```
this.Response.Cache.SetOmitVaryStar(true); 
```

我在 ASP.NET 缓存测试中发现引用[了 VaryByParam 的错误](http://www.andypotts.com/Blog/CommentView,guid,05dcac0c-1d46-42ba-8d3c-b2eb5b36b45a.aspx)

> 设置为“Client”和“ServerAndClient”的 OutputCache 指令之间的区别在于“ServerAndClient”输出 Vary 字段。这会影响 IE，因为 IE 无论如何都会发送请求。使用 vary:* 标头可以禁用所有客户端缓存 ( [http://msdn2.microsoft.com/en-us/library/system.web.httpcachepolicy.setomitvarystar.aspx](http://msdn2.microsoft.com/en-us/library/system.web.httpcachepolicy.setomitvarystar.aspx) )。
> 
> 删除 vary:* 标头并因此允许客户端缓存的唯一方法是通过代码：

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T04:19:55.730

似乎输出缓存没有在 HttpContent.Cache 中放置任何内容，因为当我遍历它时，集合是空的：

```
For Each elem As DictionaryEntry In HttpContext.Cache
  HttpContext.Cache.Remove(elem.Key)
Next 
```

这是我的动作属性：

```
<OutputCache(Duration:=600, VaryByParam:="pagename")> _
Function Index(ByVal pagename As String) As ActionResult 
```

# c# - 使用 .NET winforms 应用程序安装 MYSQL

> ID：376867
> 
> 赞同：6
> 
> 时间：2008-12-18T03:52:12.480
> 
> 标签：c#, .net, mysql, installation

我有一个使用 MYSQL 的 C# 应用程序。我处于测试版发布点，需要一个包含我的应用程序以及 MYSQL 的安装包。所以基本上，我需要安装 MYSQL 并从我的 .NET 安装包中执行恢复。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T22:48:32.237

### Step 1: You're doing it wrong

You're attempting to install the mysql *server*. This should be your first clue that something is wrong. Most server apps are designed to be installed on servers, not on clients. The notable point in this is that server apps like to assume that they 'own' the server. This is a giant no-no for client apps.

### Step 2: Make a decision, now that we are properly informed

Now that we've established that we're doing it wrong, we need to choose what to do. We have 2 options:

1.  Switch away from MySQL to a 'client' database such as SQLite or SQL Server Compact Edition.
2.  Hack around the problems of installing the server app.

I personally would recommend switching to SQLite (or similar) as soon as possible. It's the "right thing" to do, and you won't have to be maintaining hacks for years to come.

### Step 3: You'll want to hack MySQL anyway because it probably seems easier.

You have been warned. Here are some of the things you will need to be aware of, and mitigate:

1.  MySQL wants to install into program files\mysql. If the user already has MySQL installed themselves. You'll break everything
    *   You'll need to tell your version of MySQL to install into a custom folder. I'd recommend it as a subfolder of your application
2.  MySQL wants to run as a service (and the service will likely be called 'mysql'). Again if the user already has mysql, you'll break everything.
    *   You'll need to run your service under a different name
3.  The MySQL server will likely want to write files to Program Files\etc.
    *   You'll need to change it's configuration so it writes to %APPDATA% and so on
4.  MySQL will assume it is always being run by the same user. If you have 2 users on the machine who want to use your program, you'll need to hack accordingly, by either running MySQL as a local service account (security flaws ahoy), or by installing a seperate mysql for each user.

So with all this in mind, I'd say your best bet is to [set up an xcopyable mysql](https://stackoverflow.com/questions/376867/mysql-installation-with-a-net-winforms-app#376895)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T04:16:20.903

我已经在另一个[问题上发布了答案](https://stackoverflow.com/questions/49378/deploy-mysql-server-db-with-net-application)

> 我们对此采取了不同的方法。我们通过在调用 MySQL 之前编写一个包装器来生成配置文件（以正确设置基本路径等），使 MySQL 可以进行 xcopy。然后我们使用标准设置安装了另一个服务。该服务将负责为我们启动 MySQL 和其他所需的后台程序（在我们的例子中为 Apache）。由于 MySQL 是由我们部署的，因此我们希望完全控制它。

因此，使用这种方法，您可以简单地将 MySQL 包与您的安装一起包含在内，而只需担心安装您自己的服务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T04:08:17.643

[这个问题与另一个问题](https://stackoverflow.com/questions/49378/deploy-mysql-server-db-with-net-application)非常相似。但是，答案并没有真正的帮助。

您可以[从 .Net 部署项目中的自定义操作运行可执行文件](http://www.simple-talk.com/dotnet/visual-studio/visual-studio-setup---projects-and-custom-actions/)，这就是我的建议。（查看标题“将可执行文件作为自定义操作调用”）

希望一切都可以通过命令行处理。如果没有，请尝试使用 Wise 或 InstallShield 之类的脚本安装程序，我认为他们对此类内容有更好的支持。

希望有帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T05:14:46.000

如果您正在使用或可以使用 NSIS，您应该阅读以下内容：[Silent MySQL Install](http://forums.mysql.com/read.php?11,143723,143723)

关于还原，您可以使用 MySQL 包含的工具之一编写脚本，或修改此旧[NSIS 脚本的一部分](http://nsis.sourceforge.net/MySQL_local_script_installer)

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-28T11:33:41.843

**@猎户座爱德华兹**

非常感谢您的步骤。我也有同样的疑问。事实上，我们只是拒绝了 SQLite，因为我们的独立应用程序需要一些过程和外键约束。但现在我觉得如果 SQLite 确实部署在客户端计算机上，它总是作为独立桌面应用程序的更好选择。

现在，我必须坚持使用 MySQL。所以我使用不同类型的脚本和机制来处理不同的可能情况。例如：

*   如果客户端机器没有预装 mysql，则有一个脚本可以完全安装服务器并创建数据库，这是我的应用程序所需的用户。
*   如果 mysql 预装在客户端机器上，我会向用户询问 mysql 的 root 用户名和密码，并从应用程序中设置数据库和用户。
*   第三，如果由于某种原因客户端机器之前有mysql服务器然后被卸载，因为mysql即使在卸载后也会跟踪以前的root密码，我运行mysql服务器的.msi，重置密码（手动执行一些步骤），最后在脚本中创建数据库实例（当然这些步骤需要由美国执行，而不是用户执行，因为这种情况非常罕见。）

这种方法可以吗？或者有更好、更合适的方法来做到这一点？

将来我想我会坚持使用**SQLite**！:-p

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-03T23:51:39.553

看看使用 Visual Studio 的包和部署工具。如果您本地连接（MySQL .NET 组件）而不是 ODBC 连接，它应该会自动引入 MySQL 依赖项。在任何情况下，它都允许您将其他软件添加到安装程序中，如果您需要它可以自动解包。我已经使用它来部署 C# 应用程序，使用您从 MySQL 网站下载的 MySQL 库和 CoreLab 的 MySQL 3rd 方库。

# javascript - Opera中的折叠选择

> ID：376874
> 
> 赞同：1
> 
> 时间：2008-12-18T03:58:15.947
> 
> 标签：javascript, selection, opera, offset

I am not able to get the selection object's start and end offsets in Opera (v9.50) when the selection is collapsed (ie just point and click instead of highlighting text). 这是我的简单测试代码，在 FF 和 Safari 中有效，但在 Opera 中无效。

```
<html>
<head>

<script type="text/javascript">
    function showSelection()
    {
        userSelection = window.getSelection();
        alert('Start: '+userSelection.anchorOffset+'\nEnd: '+userSelection.focusOffset);
    }   
</script>

</head>

<body>

    <div onmouseup="showSelection();">
        <p>Lorem ipsum dolor <strong>sit amet</strong></p>
    </div>

</body>
</html> 
```

当我选择一个文本时，它可以工作，但只是指向和单击总是将偏移量返回为 0。我错过了什么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T00:33:15.877

Opera does not seem to make a selection when you click. I don't know what you're trying to achieve, but if you for instance want to get the selected text, Opera also implements 'document.selection' (probably to support otherwise IE only scripts) so you can do things like "document.selection.createRange().text" (not very helpful, because when nothing is selected it will return an empty string).

I think you're out of luck with this one.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T04:29:39.053

我建议把这个放在 Opera 论坛上，肯定会有人（例如开发人员）可以给你一个明确的是或否。

[歌剧论坛](http://my.opera.com/community/forums/forum.dml?id=27)

# text - 在 ImageMagick 中使用堆栈选择性地模糊图像的一部分

> ID：376887
> 
> 赞同：3
> 
> 时间：2008-12-18T04:10:11.100
> 
> 标签：text, imagemagick, blur, annotate, stack

我正在尝试使用阴影将一些文本注释到基本图像上。我不喜欢使用 -shadow 选项得到的结果，所以我放下文本，将其模糊，然后再次将文本放置为白色，与阴影偏移几个像素。这是我正在使用的命令：

```
convert base_image.jpg \
        -font TT0590M_.ttf \
        -fill gray30 \
        -annotate +0+0 '' -gravity North \
        -annotate +72+32 'ABCDEFGHIJKLM' \
        -blur 0x4 \
        -fill white \
        -annotate +72+27 'ABCDEFGHIJKLM' \
        combined.png 
```

我的问题是 -blur 选项不仅模糊了第一层文本，而且还模糊了基础图像。我只希望第一层文本模糊，而不是基础图像。

我阅读了一些关于使用堆栈的内容，并尝试隔离第一层文本和`\( \)`围绕该部分使用的模糊命令，如下所示：

```
convert base_image.jpg \
        -font TT0590M_.ttf \
        -fill gray30 \
        -annotate +0+0 '' -gravity North \
        \( -annotate +72+32 'ABCDEFGHIJKLM' \
        -blur 0x4 \) \
        -fill white \
        -annotate +72+27 'ABCDEFGHIJKLM' \
        combined.png 
```

结果是一样的——文本阴影和底层基础图像都变得模糊了。恐怕我没有太多运气理解堆栈或我应该使用哪些其他命令来获得我想要的效果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T14:50:34.833

正如经常发生的那样，自从发布问题以来，我一直在努力解决这个问题，并且我已经设法自己解决了。

重要的变化是我从一个空白的透明画布开始，而不是从基础图像开始。在我得到正确的文本后，我将基本图像插入堆栈，交换堆栈中两个图像的顺序，然后用“屏幕”的组合类型将它们合成，将一个放在另一个之上。

另一个重要的注意事项：由于 IM 工作方式的特殊性，需要 -channel RGBA 以便模糊与文本层的透明度一起工作。[这个页面](http://www.imagemagick.org/Usage/convolve/#blur)解释了为什么这是必要的。

此外，在 Windows 系统上（.bat 文件而不是 shell 脚本），单引号需要是双引号，反斜杠“\”需要是插入符号“^”，否则一切都会崩溃。

下面的脚本是最终的工作结果（*nix 版本）：

```
convert  \
    -size 500x500 xc:transparent \
    -font TT0590M_.ttf \
    -annotate +0+0 '' -gravity North \
    -fill gray30 \
    -annotate +75+35 'ABCDEFGHIJKLMNOPQR\nABCDEFGHIJKLMNOPQR' \
    -channel RGBA \
    -blur 0x4 \
    -fill white \
    -annotate +72+30 'ABCDEFGHIJKLMNOPQR\nABCDEFGHIJKLMNOPQR' \
    -insert 0 base_image.jpg \
    -swap 0,1 \
    -composite -compose screen \
    combined.png 
```

# java - 从 2 个不同的 war 文件访问相同的 ehcache

> ID：376903
> 
> 赞同：5
> 
> 时间：2008-12-18T04:23:16.597
> 
> 标签：java, ehcache

我有 2 个不同的 webapps（打包成不同的 war 文件）需要通过缓存（ehcache）共享一些数据。我想和你一起测试这个想法，看看它是否有效。

我的想法是创建一个引导/访问 ehcache 并将其打包在 jar 中的服务。然后将该jar打包到两个war中：

*   WAR1：ehcache-service.jar
*   WAR2：ehcache-service.jar

ehcache 会在这样的配置下工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-18T13:24:13.730

您需要创建一个单独的 jar，其中包含您计划缓存的所有类（及其所有依赖项），然后将该 jar 以及 ehcache.jar 部署为库（取决于您使用的应用程序服务器）不同），在 Tomcat 6 的情况下，这意味着只需将 jar 复制到 lib 文件夹。

然后发生的事情是 ehcache 和您的域类将由所有 Web 应用程序共享的类加载器加载，因此实例将被缓存并在内存中访问。

你的领域类的依赖关系很重要，所以你应该看看这种方法在你的项目中是否可行。它还可能影响您重新启动 Web 应用程序的方式。

* * *

此外，您应该知道缓存和共享不是同一件事。缓存是一种优化。如果您将对象实例放入缓存，它可能会立即被驱逐，例如，缓存没有足够的存储空间或驱逐策略配置。因此，您可能必须回顾一下您计划使用 ecache 的一般方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T06:32:09.990

您的配置问题是每个战争都将使用单独的 ClassLoader 加载，并且您的 ehcache-service 将有两个实例 - 每个 Web 应用程序都有自己的服务副本。您可以将缓存服务实现为 Web 服务（例如）并从 war1 和 war2 中使用它。

# c# - 如何将上下文菜单添加到 ListBoxItem？

> ID：376910
> 
> 赞同：30
> 
> 时间：2008-12-18T04:32:14.257
> 
> 标签：c#, winforms, listbox, contextmenu

我有一个 ListBox，我想为列表中的每个项目添加一个上下文菜单。我已经看到了“解决方案”让右键单击选择一个项目并在空白处抑制上下文菜单，但是这个解决方案感觉很脏。

有谁知道更好的方法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-18T14:45:25.390

只是为了进一步详细说明 Frans 所说的内容......即使 ListBox 拥有 ContextMenuStrip，您仍然可以在菜单条打开时自定义菜单条中的项目。因此，根据列表框中的鼠标位置自定义其内容。

下面的示例基于鼠标右键单击选择列表框中的项目，然后根据用户右键单击的项目自定义上下文菜单条。这是一个简单的示例，但应该可以帮助您：将列表框添加到表单并添加以下代码：

```
#region Private Members
private ContextMenuStrip listboxContextMenu;
#endregion

private void Form1_Load( object sender, EventArgs e )
{
    //assign a contextmenustrip
    listboxContextMenu = new ContextMenuStrip();
    listboxContextMenu.Opening +=new CancelEventHandler(listboxContextMenu_Opening);
    listBox1.ContextMenuStrip = listboxContextMenu;

    //load a listbox
    for ( int i = 0; i < 100; i++ )
    {
        listBox1.Items.Add( "Item: " + i );
    }
}

private void listBox1_MouseDown( object sender, MouseEventArgs e )
{
    if ( e.Button == MouseButtons.Right )
    {
        //select the item under the mouse pointer
        listBox1.SelectedIndex = listBox1.IndexFromPoint( e.Location );
        if ( listBox1.SelectedIndex != -1)
        {
            listboxContextMenu.Show();   
        }                
    }
}

private void listboxContextMenu_Opening( object sender, CancelEventArgs e )
{
    //clear the menu and add custom items
    listboxContextMenu.Items.Clear();
    listboxContextMenu.Items.Add( string.Format( "Edit - {0}", listBox1.SelectedItem.ToString() ) );
} 
```

希望有所帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-16T07:19:39.770

这样菜单会在鼠标旁边弹出

```
private string _selectedMenuItem;
private readonly ContextMenuStrip collectionRoundMenuStrip;

public Form1()
{ 
    var toolStripMenuItem1 = new ToolStripMenuItem {Text = "Copy CR Name"};
    toolStripMenuItem1.Click += toolStripMenuItem1_Click;
    var toolStripMenuItem2 = new ToolStripMenuItem {Text = "Get information on CR"};
    toolStripMenuItem2.Click += toolStripMenuItem2_Click;
    collectionRoundMenuStrip = new ContextMenuStrip();
    collectionRoundMenuStrip.Items.AddRange(new ToolStripItem[] {toolStripMenuItem1, toolStripMenuItem2 });
    listBoxCollectionRounds.MouseDown += listBoxCollectionRounds_MouseDown;
}

private void toolStripMenuItem2_Click(object sender, EventArgs e)
{
    var info = GetInfoByName(_selectedMenuItem);
   MessageBox.Show(info.Name + Environment.NewLine + info.Date);
}

private void toolStripMenuItem1_Click(object sender, EventArgs e)
{
    Clipboard.SetText(_selectedMenuItem);
}

private void myListBox_MouseDown(object sender, MouseEventArgs e)
{
    if (e.Button != MouseButtons.Right) return;
    var index = myListBox.IndexFromPoint(e.Location);
    if (index != ListBox.NoMatches)
    {
        _selectedMenuItem = listBoxCollectionRounds.Items[index].ToString();
        collectionRoundMenuStrip.Show(Cursor.Position);
        collectionRoundMenuStrip.Visible = true;
    }
    else
    {
        collectionRoundMenuStrip.Visible = false;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-18T08:14:21.717

没有其他办法：上下文菜单不属于列表框中的项目，而是属于列表框本身。它类似于树视图控件，它也拥有上下文菜单而不是树节点。所以每当列表框中的一个项目被选中时，根据选中的项目设置列表框的上下文菜单。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-14T13:52:15.557

这是我的解决方案：

```
listBox_Usernames.ContextMenuStrip = contextMenuStripRemove;
listBox_Usernames.MouseUp += new MouseEventHandler(listBox_Usernames_MouseUp);

void listBox_Usernames_MouseUp(object sender, MouseEventArgs e)
{
    int index = listBox_Usernames.IndexFromPoint(e.Location);
    if (e.Button == System.Windows.Forms.MouseButtons.Right)
    {
        if (index != ListBox.NoMatches)
        {
            if (listBox_Usernames.SelectedIndex == index)
            {
                listBox_Usernames.ContextMenuStrip.Visible = true;
            }
            else
            {
                listBox_Usernames.ContextMenuStrip.Visible = false;
            }
        }
        else
        {
            listBox_Usernames.ContextMenuStrip.Visible = false;
        }
    }
    else
    {
        listBox_Usernames.ContextMenuStrip.Visible = false;
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-07T15:05:12.613

在 XAML 中它显示如下：

> ```
> <ListBox>
>     <ListBox.ContextMenu>
>         <ContextMenu>
>             <MenuItem Header="Add User..."/>
>             <MenuItem Header="Edit..."/>
>             <MenuItem Header="Disable"/>
>         </ContextMenu>
>     </ListBox.ContextMenu>
> </ListBox> 
> ```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-08-09T10:17:44.873

在一行代码中（更多用于绑定）：

```
var datasource = new BindingList<string>( new List<string>( new string[] { "item1" } ) );
listbox.DataSource = datasource ;
listbox.ContextMenu = new ContextMenu(
    new MenuItem[] { 
        new MenuItem("Delete", 
            new EventHandler( (s,ev) => 
            datasource.Remove(listbox.SelectedItem.ToString())
        )
    ) 
});

private void buttonAdd_Click(object sender, EventArgs e)
{
    datasource.Add( textBox.Text );
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-29T00:02:59.513

如果它只是启用或禁用上下文菜单项的问题，那么仅在启动上下文菜单而不是每次列表框选择更改时才这样做可能更有效：

```
myListBox.ContextMenu.Popup += new EventHandler(myContextPopupHandler);

private void myContextPopupHandler(Object sender, System.EventArgs e)
{
    if (SelectedItem != null)
    {
        ContextMenu.MenuItems[1].Enabled = true;
        ContextMenu.MenuItems[2].Enabled = true;
    }
    else
    {
        ContextMenu.MenuItems[1].Enabled = false;
        ContextMenu.MenuItems[2].Enabled = false;
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-19T12:36:43.260

**这个最好...**

```
using System.Windows.Forms;

ContextMenuStrip menu;

this.menu.Items.AddRange(new ToolStripItem[] { this.menuItem });
this.listBox.MouseUp += new MouseEventHandler(this.mouse_RightClick);

private void mouse_RightClick(object sender, MouseEventArgs e)
{
    int index = this.listBox.IndexFromPoint(e.Location);
    if (index != ListBox.NoMatches)
    {
        menu.Visible = true;
    }
    else
    {
        menu.Visible = false;
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-27T15:24:07.230

```
//Create and Initialize the contextMenuStrip component
contextMenuStrip_ListaAulas = new ContextMenuStrip();

//Adding an Item
contextMenuStrip_ListaAulas.Items.Add("Modificar");

//Binding the contextMenuStrip with the ListBox
listBox_Aulas.ContextMenuStrip = contextMenuStrip_ListaAulas;

//The solution below 
if (e.Button == System.Windows.Forms.MouseButtons.Right)
{
    //select the item under the mouse pointer
    listBox_Aulas.SelectedIndex = listBox_Aulas.IndexFromPoint(e.Location);

    //if the selected index is an item, binding the context MenuStrip with the listBox
    if (listBox_Aulas.SelectedIndex != -1)
    {
         listBox_Aulas.ContextMenuStrip = contextMenuStrip_ListaAulas;  
    }
    //else, untie the contextMenuStrip to the listBox 
    else
    {
         listBox_Aulas.ContextMenuStrip = null;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-13T09:06:48.310

我确实喜欢这个，这对我来说效果很好而且速度很快。

```
private void contextMenuStrip1_Opening(object sender, CancelEventArgs e)
    {
        if (Listbox.SelectedItem == null)
            e.Cancel = true;
    } 
```

# jquery - 使用 ASP.NET MVC 的 jQuery 选择器出现问题

> ID：376911
> 
> 赞同：0
> 
> 时间：2008-12-18T04:32:32.507
> 
> 标签：jquery, asp.net-mvc

我是 ASP.Net MVC 和 jQuery 的新手，我想做的是制作一个表单，根据 rockbandid 是否为空 guid，添加新的 RockBand 或更新现有的 RockBand。我认为现在是开始使用 jQuery 的好时机。所以第一步是制作一个乐队列表，并在它旁边放一个编辑链接。如果用户单击编辑链接，我想更改输入框和隐藏字段的值。下面的代码是第一步，尝试设置输入框的值（暂时使用固定字符串，但最终将是乐队名称）。但是，当我这样做时，我得到了一个需要对象的错误。（jQuery 包含在 Site.Master 上）

```
<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">
<script type="text/javascript">
    function fillinbandname(thebandname) {
        $('#bandname').val(thebandname);
    }
</script>
<ul>
<%foreach (DomainModel.RockBand rockband in ViewData.Model) %>
<%{ %>
<li><%=rockband.BandName %> <a href='javascript:fillinbandname("somesamplevalue");'>edit</a></li>
<%} %></ul>

<%Html.BeginForm("MakeOrUpdateRockBand", "Bands", FormMethod.Post); %>
<input type="text" id="bandname" name="bandname" maxlength="30" />
<input type="hidden" id="bandid" name="bandid" value="00000000-0000-0000-0000-000000000000" />
<input type="submit" value="Add New Band" />
<%Html.EndForm(); %>

</asp:Content> 
```

感觉就像我很接近......但我错过了一些基本的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T04:41:48.447

我将您的 HTML 和 JavaScript 复制到一个示例文件中；它对我有用。我唯一建议的是将您的锚点更改为以下内容：

```
<a href='#' onclick='fillinbandname("somesamplevalue"); return false;'>edit</a> 
```

此外，您不一定需要一个函数来执行此操作，您可以直接在 onclick 事件中使用 jQuery。不过，这取决于您的判断。

请确保您的 HTML 按预期生成，**并确保您为每个乐队名和乐队名生成唯一的 ID。** ID 在 HTML 文档中不能出现多次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T04:43:03.360

你的代码很好。您对 JQuery 的包含可能是错误的。顺便说一句，谷歌正在为 jQuery 和其他 API 提供免费托管。您可以尝试通过以下方式替换您的 jQuery 包含：

`<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>`

但无论如何......检查它是否指向正确的文件。

# php - PHP - 启动数据库类的最佳位置在哪里？

> ID：376915
> 
> 赞同：0
> 
> 时间：2008-12-18T04:34:34.423
> 
> 标签：php, oop

我最近将我的 Db 启动代码从我的 Page 类的 __construct 中取出，并在我启动 Page 类之后放置它。我从 Page 类中删除了它，因为我希望能够从任何地方（例如其他类）访问它。它在启动时还需要服务器、用户名、密码和数据库参数，我不希望每次都输入这些。

现在有没有办法从 Page 类下访问它？我尝试了一些方法，甚至是全局方法（有人告诉我这是一种糟糕的做事方式），但到目前为止无济于事。我对 OO 还很陌生，但我正在尽我所能地自学。

我应该把它变成一个静态类吗？这会影响我设置的 Db 的惰性连接器吗？

任何帮助将非常感激。

谢谢

**[编辑]**

类似问题：[用于数据库连接的全局或单例？](https://stackoverflow.com/questions/130878/global-or-singleton-for-database-connection)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T09:33:09.623

某种全局变量（是全局变量、单例或其他变体）是对您以前方法的改进，因此您走在正确的轨道上。不过一般来说，您应该尽量减少程序状态的范围（出于多种原因，我不会在这里讨论）。拥有一个全局变量与此原则相冲突。这个问题有不同的解决方案，但最强大且经常被忽视的方法是使用控制反转；您的类应该接收它，而不是获取依赖项。例如，假设您目前有这个

```
class EditUserController {
  function saveUser() {
    $db = Database::GetInstance();
    $db->execute("update users set ...", ...);
  }
} 
```

您可以将其更改为：

```
class EditUserController {
  function saveUser($db) {
    $db->execute("update users set ...", ...);
  }
} 
```

但是，在函数参数级别传递依赖关系可能有点笨拙，因此折衷方案可能是在每个对象级别传递它：

```
class EditUserController {
  protected $db;
  function __construct($db) {
    $this->db = $db;
  }
  function saveUser() {
    $this->db->execute("update users set ...", ...);
  }
} 
```

这是 OO 编程中相当常见的模式。除了比传入函数参数更实用之外，它还具有将构造（共享依赖项相互连接的地方）与运行时（使用它们的地方）分开的额外好处。这让很多事情变得更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T04:38:41.857

全局变量确实有用，这就是其中之一。除非您可能需要多个数据库连接（甚至仍然需要），否则我认为设置全局 $db 对象没有问题。

另一种方法是拥有一个静态“工厂”类，您可以使用它来获取对象。在 Joomla 1.5 中，您访问 DB 对象的方式是这样的：

```
$db =& JFactory::getDBO(); 
```

getDBO 函数检查是否已创建 DB 对象：如果已创建，则返回对它的引用，否则连接并初始化，然后返回它。

这同样适用于其他“可能成为全局”对象，例如当前的用户对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-13T21:57:29.957

创建单例方法是为了确保任何类只有一个实例。但是，由于人们将其用作快捷全球化的一种方式，因此它被称为懒惰和/或糟糕的编程。

# perl - Perl 中的标量上下文和列表上下文有什么区别？

> ID：376921
> 
> 赞同：5
> 
> 时间：2008-12-18T04:38:46.817
> 
> 标签：perl, list, scalar

Perl 中的标量和列表上下文有什么区别，这在其他语言（如 Java 或 Javascript）中是否有任何相似之处？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-18T04:44:35.993

Perl 中的各种运算符都是上下文相关的，并且在列表和标量上下文中产生不同的结果。

例如：

```
my(@array) = (1, 2, 4, 8, 16);
my($first) = @array;
my(@copy1) = @array;
my @copy2  = @array;
my $count  = @array;

print "array: @array\n";
print "first: $first\n";
print "copy1: @copy1\n";
print "copy2: @copy2\n";
print "count: $count\n"; 
```

输出：

```
array: 1 2 4 8 16
first: 1
copy1: 1 2 4 8 16
copy2: 1 2 4 8 16
count: 5 
```

现在：

*   `$first`包含 1（数组的第一个元素），因为 . 中的括号`my($first)`提供了一个数组上下文，但`$first`.
*   两者`@copy1`都`@copy2`包含`@array`,
*   并且`$count`包含 5 因为它是一个标量上下文，并且`@array`计算为标量上下文中数组中的元素数。

也可以构建更详细的示例（结果是读者的练习）：

```
my($item1, $item2, @rest) = @array;
my(@copy3, @copy4) = @array, @array; 
```

我所知道的其他语言中的列表和标量上下文没有直接的平行关系。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T16:10:51.850

标量上下文是您在寻找单个值时得到的。列表上下文是您在寻找多个值时得到的。最常见的区别之一是使用数组时：

```
@x = @array;  # copy an array
$x = @array;  # get the number of elements in an array 
```

其他运算符和函数也是上下文相关的：

```
$x   = 'abc' =~ /(\w+)/;  # $x = 1
($x) = 'abc' =~ /(\w+)/;  # $x = 'abc'
@x   = localtime();       # (seconds, minutes, hours...)
$x   = localtime();       # 'Thu Dec 18 10:02:17 2008' 
```

运算符（或函数）在给定上下文中的行为方式取决于运算符。没有关于事物应该如何表现的一般规则。

您可以使用该`wantarray`函数确定调用上下文，从而使您自己的子例程上下文敏感。`scalar`您可以使用关键字强制在标量上下文中计算表达式。

除了标量和列表上下文之外，您还将看到文档中提到的“void”（没有预期的返回值）和“boolean”（预期的真/假值）上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T04:43:50.690

这仅仅意味着将根据操作模式评估数据类型。例如，对标量的赋值意味着右侧将被评估为标量。

我认为理解上下文的最好方法是学习wantarray。所以想象一下 = 是一个实现wantarray的子​​程序：

```
sub = {
  return if ( ! defined wantarray ); # void: just return (doesn't make sense for =)
  return @_ if ( wantarray ); # list: return the array
  return $#_ + 1; # scalar: return the count of the @_
} 
```

[这篇文章](https://stackoverflow.com/questions/376921/what-is-the-difference-between-the-scalar-and-list-contexts-in-perl#376933)中的示例就像通过将右侧作为参数传递来调用上述子例程一样。

至于其他语言的相似之处，是的，我仍然认为几乎每种语言都支持类似的东西。多态性在所有 OO 语言中都是相似的。另一个例子，Java 在某些上下文中将对象转换为字符串。我用过的每一种无类型脚本语言都有类似的概念。

# perl - 在 Perl 应用程序中检测编译失败、缺少包等的最简单方法是什么？

> ID：376930
> 
> 赞同：3
> 
> 时间：2008-12-18T04:42:19.587
> 
> 标签：perl, module

我有一个别人写的 Perl 应用程序，我正试图让它在我的本地机器上运行。但是我在其中一个模块中不断收到错误，这似乎是基于某处缺少的模块。有什么好的工具或做法来追踪这件事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-18T05:33:05.520

如果您缺少模块，您将收到如下错误：

> 在@INC 中找不到Does/Not/Exist.pm（@INC 包含：/etc/perl /usr/local/lib/perl/5.10.0 /usr/local/share/perl/5.10.0 /usr/ lib/perl5 /usr/share/perl5 /usr/lib/perl/5.10 /usr/share/perl/5.10 /usr/local/lib/site_perl .)。

追踪 Perl 模块的最佳位置是[CPAN 搜索](http://search.cpan.org/)。您可以使用 CPAN shell 安装它们，可通过运行：

```
perl -MCPAN -e shell 
```

您也可以从您的 Perl 供应商/Linux 发行版中获得它们。

至于找到它们，我想到了两种方法：

1.  当您运行 perl Makefile.PL 时，它应该已经告诉您需要安装的所有模块。当然，这只是在编写该应用程序的人费心让它工作的情况下。

2.  在文件中搜索“use”和“require”指令。

# objective-c - 确定 iPhone 上沙盒允许的可用磁盘空间

> ID：376934
> 
> 赞同：4
> 
> 时间：2008-12-18T04:45:04.120
> 
> 标签：objective-c, cocoa-touch

我正在寻找一种方法来确定我的应用程序有多少可用磁盘空间。

我尝试将 NSFileManager 的 fileSystemAttributesAtPath 与 NSFileSystemFreeSize 一起使用，但这给了我 iPhone 上的总可用空间，而不是 Sandbox 对我的应用程序可用的空间。

我相信应用程序仅限于使用 2 Gig 的空间，并且需要显示仍有多少 2G 可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T05:46:20.643

您可以使用 statfs(2) 并检查 f_bavail 字段。这是当前非特权应用程序可用的空间量，因此它应该为您提供允许您的应用程序使用的修改空间。

[您可以在此处](http://developer.apple.com/iphone/library/documentation/System/Conceptual/ManPages_iPhoneOS/man2/statfs.2.html#//apple_ref/doc/man/2/statfs)查看 iPhone 版本的手册页。

# c# - C#、sp_executesql 和不正确的语法

> ID：376941
> 
> 赞同：5
> 
> 时间：2008-12-18T04:57:45.500
> 
> 标签：c#, sql-server, sql-server-2005, visual-studio-2005, sql-server-profiler

我正在调用下面的代码。

在*(IDataReader dr = cmd.ExecuteReader())* sql barfs 上，*“CompanyUpdate”附近的语法不正确。*

```
 using (SqlCommand cmd = new SqlCommand("CompanyUpdate"))
        {
            cmd.Parameters.Add("@CompanyID",SqlDbType.Int);
            cmd.Parameters.Add("@Description",SqlDbType.VarChar,50);
            cmd.Parameters["@CompanyID"].Value = companyid;
            cmd.Parameters["@Description"].Value = description;

            SqlConnection cn = new SqlConnection("Data Source=[datasource];Initial Catalog=dotNext;User ID=[user];Password=[password];Pooling=True;Application Name=dotNext");
            cn.Open();
            cmd.Connection = cn;
            using (IDataReader dr = cmd.ExecuteReader())
            {
                if (dr.Read())
                {
                    this.CompanyID = dr.GetInt32(0);
                }
            }
        } 
```

我查看了 sqlprofiler 并注意到以下内容：

```
exec sp_executesql N'CompanyUpdate',N'@CompanyID int,@Description varchar(50)',@CompanyID=56,@Description='APC' 
```

它用 sp_executesql 包装了我的命令。我所有其他的 sql 命令都只是执行没有问题。

所以我的问题有两个方面： 1\. 为什么使用 sp_executesql？2\. 我做错了什么？

详情：sql2005、c#、vs2005

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-18T05:04:35.953

我注意到您没有将 CommandType 设置为 StoredProcedure ...我不知道这是否是您的问题的原因：

```
cmd.CommandType = CommandType.StoredProcedure; 
```

我自己已经做过很多次了，我数不过来。

**下次抛出异常时触发记忆的提示：**

在运行应用程序时打开 SQL 查询探查器。每个命令执行时，都会显示生成的 SQL，并在服务器端运行。如果生成的 SQL 以您的查询开头，`sp_executesql`那么它将作为常规查询运行 - 即`cmd.CommandType = CommandType.Text`，如果它以 开头`exec`，那么它很可能作为存储过程运行。确保为您尝试运行的查询类型生成正确的 SQL。

# mfc - MFC中的CStringList

> ID：376948
> 
> 赞同：0
> 
> 时间：2008-12-18T05:04:10.260
> 
> 标签：mfc

我正在使用 2 个 CStringList 对象进行编码。每个都有自己的数据，例如一个有名字，另一个有音位，两者是同步的，即如果有一个音位，就有一个名字，反之亦然。

现在，我有 2 个组合框，在其中显示名称和相应的音素。名称组合框已排序，因此两者之间的同步需要折腾。因此，为了排序，我做了以下事情：

* * *

```
int aComboElementNo = myNameComboBox.GetCount();
if( aComboElementNo >= 1 )
{
    for( int aIndex = 0; aIndex < aComboElementNo; aIndex++ )
    {
        CString aTempStr;
        // Getting the string in the combobox
        myNameComboBox.GetLBText( aIndex, aTempStr );
        // Getting the position where the name is present in the list
        POSITION aPos = aNameList.Find( aTempStr );
       // setting the appropriate phoneno in the 2nd combobox
        myPhoneComboBox.AddString( aPhoneList.GetAt( aPos ) );
    }
} 
```

* * *

当我执行此操作时，我得到了 myPhoneComboBox 中的名称，而不是 phonenos。

现在我有 2 个 qns：

1.  当我访问电话列表时，我怎么会在名字列表中找到名字？这不是违规吗，因为我可以使用其他变量访问其他变量数据。

2.  如何对第二个列表进行排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T05:29:45.200

我希望你使用的是 CStringArray 而不是 CStringList。您需要使用 FindIndex 而不是 Find 因为 Find 将返回 OBJECT Pos 而不是索引计数....并且要使用数组简单地使用 [] 运算符来获取元素。如果您仍想使用 CStringList ，则通过 Iterator 在一个 List 中查找字符串的第一个匹配项的索引计数，并使用该 IndexCount 的 FindIndex 获取第二个列表的位置对象，以使用 GetAt 到第二个列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T22:40:53.840

为什么你有 2 个单独的列表？为什么不是一个 CTypedPtrArray 的结构同时包含名称和电话 nb？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-28T01:09:13.780

那是一种疯狂的，原谅我，愚蠢的寻找名字的方法。它假定名称是唯一的。上帝帮助我，我不得不处理这些事情，名称字段不应该被视为唯一的，它非常危险。问问我爸爸 Baash05 Sr.

我假设应用程序添加到组合框中时有一个 ID 或一些数据集。请在您的地图中使用它。我的猜测是程序员将数据设置为名称的 ID，或者指向包含名称的对象的指针。（人对象/业务对象/学生对象...）。

如果添加名字的代码没有增加区分乔治福尔曼和他任何孩子的方法，那么就向老板提出一个论点，说它的实现应该改变，因为上帝应该改变！

```
int aComboElementNo = myNameComboBox.GetCount();
for( int aIndex = 0; aIndex < aComboElementNo; aIndex++ )
{
    int nameLocal = myNameComboBox.GetItemData( aIndex);
    myPhoneComboBox.InsertString(aIndex, aPhoneList[namelocal] );
} 
```

# sql-server - 根据父信息更新列

> ID：376953
> 
> 赞同：2
> 
> 时间：2008-12-18T05:07:16.633
> 
> 标签：sql-server

我是 SQL Server 的初学者，我有一个关于如何最好地做到这一点的问题。

我有一个看起来像这样的表：

ID 父级
1 NULL 0
2 1 1
3 1 1
4 2 2
5 2 2
6 3 2
7 2 2
8 5 4
9 4 3
10 6 3
11 6 3

如您所见，所有条目都有一个父级和一个级别，并且数据库以树结构组织。有些条目的级别设置不正确，例如条目 ID #8。8 的父级为 5，ID 5 的级别为 2，因此级别 8 应为 3 而不是 4。我的表中有许多不正确的级别值，我不知道如何解决这个问题。到目前为止，我有这个：

UPDATE myTable
SET level=level-1
FROM myTable
WHERE ???;

我不确定如何填写 WHERE 部分，或者这是否是最好的方法。任何建议都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T05:27:12.617

这将向您显示有问题的行。

```
select
  a.id,
  a.level,
  b.level as parentlevel
from
  tablename a
  join tablename b on a.parent = b.id
where
  a.level <> b.level+1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T07:07:21.120

如果您使用的是 SQL Server 2005 或 SQL Server 2008，则可以使用递归 CTE（公用表表达式）。[在线图书文章](http://msdn.microsoft.com/en-us/library/ms186243.aspx)非常简单，但这里是您可以如何使用您的代码做到这一点。

-- 创建临时表并插入值

CREATE TABLE dbo.ctetest (childid int primary key not null, parentid int null, level int null);

插入到 dbo.ctetest (childid, parentid) SELECT 1, NULL;

INSERT INTO dbo.ctetest (childid, parentid) SELECT 2, 1;

插入到 dbo.ctetest (childid, parentid) SELECT 3, 1;

插入到 dbo.ctetest (childid, parentid) SELECT 4, 2;

插入到 dbo.ctetest (childid, parentid) SELECT 5, 2;

插入到 dbo.ctetest (childid, parentid) SELECT 6, 3;

插入到 dbo.ctetest (childid, parentid) SELECT 7, 2;

插入到 dbo.ctetest (childid, parentid) SELECT 8, 5;

插入到 dbo.ctetest (childid, parentid) SELECT 9, 4;

INSERT INTO dbo.ctetest (childid, parentid) SELECT 10, 6;

插入到 dbo.ctetest (childid, parentid) SELECT 11, 6;

-- 使用来自递归 CTE 的级别数据更新表

WITH recursivecte (childid, parentid, level)

作为

```
(SELECT childid
    , parentid
    , 'level' = 0
FROM dbo.ctetest
WHERE parentid IS NULL
UNION ALL
SELECT ct.childid
    , ct.parentid
    , 'level' = rc.level + 1
FROM dbo.ctetest ct
JOIN recursivecte rc
    ON ct.parentid = rc.childid) 
```

更新 ct

SET 级别 = rc.level

FROM dbo.ctetest ct

JOIN 递归函数

```
ON ct.childid = rc.childid; 
```

-- 验证结果

选择 *

来自 dbo.ctetest;

这是上述查询的输出：

子 ID 父 ID 级别

1 空 0

2 1 1

3 1 1

4 2 2

5 2 2

6 3 2

7 2 2

8 5 3

9 4 3

10 6 3

11 6 3

请注意，我使用 SQL Server 2008 测试了上述代码。我假设它可以在 SQL Server 2005 中工作，因为 CTE 是在 2005 年推出的。

# perl - Eclipse 有没有像样的 Perl 插件？

> ID：376954
> 
> 赞同：4
> 
> 时间：2008-12-18T05:08:21.780
> 
> 标签：perl, eclipse, epic

我正在使用 EPIC，但它似乎有一些缺点。Eclipse 还有其他 Perl 插件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-18T20:39:11.760

除了 EPIC 之外，似乎没有任何其他适用于 Perl 的 eclipse 插件。

关于有问题的行为，您是否检查过[为什么 EPIC eclipse 插件在“解释错误/警告”中没有显示任何信息？](https://stackoverflow.com/questions/373282)及其相关的[EPIC 用户指南](http://www.epic-ide.org/guide/ch05s02.php)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T07:06:09.930

一个新的插件是 Perlipse [http://www.eclipseplugincentral.com/Web_Links-index-req-viewlink-cid-1133.html](http://www.eclipseplugincentral.com/Web_Links-index-req-viewlink-cid-1133.html) 它远非完整的atm。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-22T01:29:06.060

对于那些在我之后找到这个的人，当使用引号导入不在 perl 路径中的模块时，...propagated 似乎出现在我面前。例如：

```
use base qw/ Class::DBI /; 
```

这在项目资源管理器和问题窗口中显示为错误，但在 perl 模块本身中没有。

# haskell - 这些值在这个 haskell 函数中来自哪里？

> ID：376959
> 
> 赞同：3
> 
> 时间：2008-12-18T05:17:31.807
> 
> 标签：haskell, map, lambda, tuples, fold

假设我有以下功能：

```
sumAll :: [(Int,Int)] -> Int
sumAll xs = foldr (+) 0 (map f xs)
  where f (x,y) = x+y 
```

的结果`sumAll [(1,1),(2,2),(3,3)]`将是`12`。

我不明白这些`(x,y)`值来自哪里。好吧，我知道它们来自`xs`变量，但我不明白如何。我的意思是，在没有 where 关键字的情况下直接执行上面的代码，它会是这样的：

```
sumAll xs = foldr (+) 0 (map (\(x,y) -> x+y) xs) 
```

而且我无法理解，在上面的代码中，`f`变量和`(x,y)`变量如何表示`(\(x,y) -> x+y)`lambda 表达式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T05:41:11.637

希望这会有所帮助。关键是`f`应用于列表的元素，它们是对的。

```
sumAll [(1,1),(2,2),(3,3)] 
      -- definition of sumAll
    = foldr (+) 0 (map f [(1,1),(2,2),(3,3)])
      -- application of map
    = foldr (+) 0 (f (1,1) : map f [(2,2),(3,3)])
      -- application of foldr
    = 0 + foldr (+) (f (1,1)) (map f [(2,2),(3,3)])
      -- application of map
    = 0 + foldr (+) (f (1,1)) (f (2,2) : map f [(3,3)])
      -- application of foldr
    = 0 + (f (1,1) + foldr (+) (f (2,2)) (map f [(3,3)]))
      -- application of f
    = 0 + (2 + foldr (+) (f (2,2)) (map f [(3,3)]))
      -- application of map
    = 0 + (2 + foldr (+) (f (2,2)) (f (3,3) : map f []))
      -- application of foldr
    = 0 + (2 + (f (2,2) + foldr (+) (f (3,3)) (map f [])))
      -- application of f
    = 0 + (2 + (4 + foldr (+) (f (3,3)) (map f [])))
      -- application of map
    = 0 + (2 + (4 + foldr (+) (f (3,3)) []))
      -- application of foldr
    = 0 + (2 + (4 + f (3,3)))
      -- application of f
    = 0 + (2 + (4 + 6))
    = 0 + (2 + 10)
    = 0 + 12
    = 12 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-18T05:31:08.067

在 Haskell 中，函数是一流的数据类型。

这意味着您可以像整数和字符串等其他类型的数据一样传递函数。

在上面的代码中，您将“f”声明为一个函数，它接受一个参数a（两个值的元组 (x,y)）并返回 (x + y) 的结果。

foldr 是另一个函数，它接受 3 个参数，一个二进制函数（在本例中为 +）一个起始值 (0) 和一个要迭代的值数组。

简而言之，“其中 f (x,y) = x + y”只是范围简写

```
sumAll :: [(Int,Int)] -> Int
sumAll xs = foldr (+) 0 (map myFunctionF xs)

myFunctionF :: (Int,Int) -> Int
myFunctionF (x,y) = x + y 
```

**编辑**：如果您不确定 foldr 的工作原理，请查看[Haskell Reference Zvon](http://www.zvon.org/other/haskell/Outputprelude/index.html) 下面是 foldl / map 的示例实现。

```
foldl :: (a -> b -> b) -> b -> [a] -> b
foldl _ x [] = x
foldl fx (y:ys) = foldl f (f y x) ys

map :: (a -> b) -> [a] -> [b]
map _ [] = []
map f (x:xs) = (f x) : (map f xs) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T22:15:08.783

不是答案，但我想我应该指出你的函数 f：

```
f (x, y) = x + y 
```

可以表示为

```
f = uncurry (+) 
```

# workflow-foundation - WOrflow Foundation 取消处理程序

> ID：376961
> 
> 赞同：0
> 
> 时间：2008-12-18T05:18:37.000
> 
> 标签：workflow-foundation

取消处理程序适用于复合活动，如 CAG、并行活动。

我需要知道取消处理程序中将取消哪些活动。

我的并行活动中有代码活动 在这种情况下，活动被重置

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-21T12:23:00.773

活动只能在执行时取消。因此，通过在 EnabledActivities 集合中搜索状态为 Executing 的集合，您可以看到哪些可以取消。

# php - 浏览器之外的灯箱

> ID：376963
> 
> 赞同：1
> 
> 时间：2008-12-18T05:19:34.783
> 
> 标签：php, javascript, web-applications, fullscreen, lightbox2

我正在开发一个新项目，一个 Web 应用程序，我需要让用户专注于特定任务。因此，我想消除所有其他“系统生成的噪音”，如浏览器菜单、按钮、地址栏、操作系统任务栏等。我见过像 Lightbox 这样的实现，但这种模式方法仅限于浏览器窗口的大小。

我想要做的是具有相同的效果，但延伸到浏览器之外，因此它覆盖了整个屏幕。好吧，至少这是我想要的效果。

该应用程序已经在开发中，它正在使用 PHP5、XHTML 和 Javascript/AJAX 进行开发。

请，如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T05:26:47.623

这可能会帮助您：

[http://www.programmersheaven.com/2/FAQ-JavaScript-Maximize-Browser-Window-To-Screen](http://www.programmersheaven.com/2/FAQ-JavaScript-Maximize-Browser-Window-To-Screen)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T06:04:26.863

不知道如果不使用闪光灯或银光之类的东西，是否可以按照您所描述的方式进行。

有充分的理由，远程 javascript 不能做某些事情，也不应该做。

另一件要考虑的事情是当人们拥有多个屏幕时会发生什么，你是否也会掩盖他们的内容？
请不要...当网站尝试调整浏览器窗口大小时让我（和许多其他人）发疯，更不用说尝试在浏览器 chrome 之外运行并掩盖我的任务栏。

让我们知道您在哪个浏览器中运行，如果我不能，我一定会削弱功能或卸载它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T05:25:41.887

Silverlight 具有全屏模式，您可以在浏览器中呈现第一页后设置该模式。

[http://weblogs.asp.net/scottgu/archive/2007/05/17/tip-trick-supporting-full-screen-mode-with-silverlight.aspx](http://weblogs.asp.net/scottgu/archive/2007/05/17/tip-trick-supporting-full-screen-mode-with-silverlight.aspx)

不知道这对您当前的堆栈是否有帮助：

> PHP5、XHTML 和 Javascript/AJAX

基思

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T11:37:17.580

好的，所以我一直在寻找其他选择，或者我可以做到这一点的替代方法。我发现的一种解决方案仅适用于 Firefox 2.0+ 或 IE6+，它是切换浏览器的全屏模式。甚至可能做一点专业的开源并仅支持 Firefox 并敦促用户获取该浏览器……但是，如果我告诉用户获取东西，为什么不告诉它去获取 Flash o Silverlight，对吗？ ?

我认为这是可能的、想要的和适合用户的之间的一条细线。我还没有找到执行此操作所需的内容。但我认为这是一个更可行的选择。

> 让我们知道您在哪个浏览器中运行，如果我不能，我一定会削弱功能或卸载它。

嗯WTF！？要继续，并假设这是一个很好的评论变坏了。虽然不是很有建设性。

# asp.net - 在 ASP.NET 中查看 LoadPostData 事件正在加载的数据

> ID：376965
> 
> 赞同：0
> 
> 时间：2008-12-18T05:20:24.143
> 
> 标签：asp.net

查看 LoadPostData 事件正在加载到 ASP.NET 中的控件的数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T06:01:25.463

其实很简单。传递给实现 IPostbackDataHandler 接口的每个控件的此方法的 NameValueCollection 是 Page.Request.Form 的内容。因此，您可以通过打开手表随时访问它`HttpContext.Current.Request.Form`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T05:40:38.610

呃...我建议将您的 IDE 环境设置为[调试 .net 框架](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)，并在 Control 的 LoadPostData() 方法上设置断点。这有点笨拙，但是如果您愿意遍历对 Control 类的递归调用（也许在方法上设置条件断点？），您将能够以这种方式获取数据。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-22T20:54:21.307

如果您想确定您正在查看进入特定控件的数据，您可以子类化其控件类型并在`IPostBackDataHandler.LoadPostData`.

例如，您有一个以编程方式添加的控件来收集用户所在的城市。改变：

```
Public City As Textbox 
```

到

```
Public City As BreakableLoadPostDataTextBox

Public Class BreakableLoadPostDataTextBox
  Inherits TextBox

  Protected Overrides Function LoadPostData( _
    ByVal postDataKey As String, _
    ByVal postCollection As System.Collections.Specialized.NameValueCollection) _
    As Boolean

    Return MyBase.LoadPostData(postDataKey, postCollection) ' Break here
  End Function
End Class 
```

`Return`在调用上设置断点。当执行中断时，您应该能够看到`postDataKey`用于从`postCollection`. 您当然可以通过 Trace 调用和诸如此类的方式将这种方法扩充到您心中的内容。

# c++ - 使用 iPhone ObjectiveC Apps 中的 C/C++ 静态库

> ID：376966
> 
> 赞同：29
> 
> 时间：2008-12-18T05:20:45.903
> 
> 标签：c++, c

是否有可能有一个 C 静态库 API，它在内部使用 C++ 并对库的用户隐藏它？

我编写了一个可移植的 C++ 库，我希望静态链接到 iPhone 应用程序。

我使用 Max OS X 'static library' 模板创建了一个 Xcode 项目，并复制了源代码，并使用 (extern "C") 编写了一个 C wapper（处理异常）。

我正在尝试在另一个 Cocoa iPhone 应用程序中使用生成的库（.a 文件）。

如果我在调用 ObjectiveC 文件上使用 (.mm) 扩展名并在库中的实现类上使用 (.cpp) ，那么一切都很好。

但是当我尝试将包装文件更改为 (.c) 扩展名时，即使所有包装函数文件都只是 C 函数，我也会在链接时得到未解析的符号。

只是因为 C++ 在库内部使用，是否意味着在外部它仍然必须被视为 C++ 程序。反正没有强制执行这种抽象吗？

**编辑：**感谢您的回复，

我一直在使用 extern "C"，我只是不确定调用项目中需要哪些配置。IE。如果调用投影需要知道它是否使用 C++ 或者可能是无知的并认为它是一个纯粹的 C 库。

看来我不能，我必须在我的 ObjectiveC 类上使用 (.mm) 文件。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-12-18T06:27:15.303

在评论中这样做太难了，所以我将快速向您展示您遇到的链接问题。当 Xcode 遇到文件时，它使用基于后缀的构建规则来决定使用哪个编译器。默认情况下，gcc 将文件链接到标准 C 库，但不链接到标准 C++ 库。存档文件（静态库）根本没有完成链接解析。它们基本上是*需要链接*的目标文件的存档。由于您的项目中没有 .mm 或 .cpp 文件，因此永远不会调用 g++ 并且您的文件永远不会链接到标准库。要更正此问题，只需将标准 C++ 库添加到 Xcode 项目中的其他链接器标志，或者只需将它们添加到预定义的其他标志选项 -l（例如 -lstdc++）。

这是一个快速演示：

stw.h：

```
#ifdef __cplusplus
extern "C"
#endif
void show_the_world(void); 
```

stw.cpp：

```
#include <iostream>
#include "stw.h"
using namespace std;

extern "C" void show_the_world() {
  cout << "Hello, world!\n";
} 
```

构建库：

```
$ g++ -c stw.cpp -o stw.cpp -O0 -g
$ ar rcs stw.a stw.o 
```

使用 C 应用程序中的库：

我的应用程序.c：

```
#include "stw.h"

int main() {
  show_the_world();
  return 0;
} 
```

构建 C 应用程序：

```
$ gcc -o myapp myapp.c stw.a -lstdc++ -g -O0
$ ./myapp
Hello, world!
$ 
```

如果您尝试在没有 -lstdc++ 的情况下进行编译，您将得到所有未解决的问题，因为 C 编译器完全不知道它应该链接到 C++ 运行时（为什么会这样，对吧！？！？）所以你必须添加这个手动。您拥有的另一个选择是更改项目的构建规则......而不是让 Xcode 使用 gcc 来构建 .c 和 .m 文件，告诉它使用 g++ 并且您的问题将得到解决。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T05:33:21.650

您应该声明您希望可见的功能`extern "C"`。它们的签名需要与 C 兼容，但内容不兼容（例如，您可以访问 C++ 对象，但不能直接传递它们；指针可以）。然后，这些符号将对任何 C 兼容环境可见。

编辑：并将其编译为 C++ 源文件，C 没有语言链接的概念。还有其他几个与语言链接有关的问题（例如，所有`extern "C"`同名的函数都是同一个函数，而不管命名空间如何）。

EDIT2：在标题中，您可以检查宏`__cplusplus`，并使用它分别为 C++ 和其他语言设置（因为 C++ 需要`extern "C"`声明，而其他语言可能会抱怨它们）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T05:47:56.863

基本上，当您使用 C++ 编译器编译 C 函数时，它会破坏函数名称并使用 C++ ABI。

当您使用 *.cpp 或 *.mm 扩展名时，您正在使用 C++ 编译器。

您想要做的是强制编译器生成具有 un-mangles 名称并使用 C ABI 的 C 函数。

您可以通过以下任一方式执行此操作：

*   用 C 编译器编译。
*   使用 C++ 编译器进行编译，但请确保在函数声明前加上 extern "C"

设置头文件以使 C 和 C++ 源文件中都包含同一个文件的一种常用方法是：

```
#ifndef HEADER_GUARD_1_H
#define HEADER_GUARD_1_H

#ifdef __cplusplus
extern "C" {
#endif

// Declare C function interface here.
int myFunc(int x,char*);

#ifdef __cplusplus
}
#endif

#endif 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-19T18:18:57.013

谢谢，这么好的讨论。

我所做的是：

1) 我使用 cocaotouch 静态库选项创建了一个静态库。在那我有 c/c++/obj-c 所有混合。但是，我的导出只是 obj-c 类。事实上，我使用 objc- 到 c 到 C++。

2）然后我在 X-code proj 中创建了 iphone 应用程序。我添加了其他链接标志我的库名称（ -lxyz ）//我的库名称是 libxyz.a 我添加了库搜索路径，标题搜索路径

3）然后我编译。我有错误。说操作员新，找不到操作员删除。

3）然后除了我的appdelegate，视图控制器，我添加了虚拟cpp（.h，.cpp）... atestdummy.h attestdummy.cpp

4）然后我再次构建......

就是这样。

所以 - 我之前提出的任何建议都对我有用。基本原因，除非您的应用程序看到带有 cpp 代码的 .cpp 文件 .mm 文件，否则链接将不会使用 g++。

谢谢大家。我已阅读上述内容并解决了我的问题。

你们很高兴分享。

# string - 将前导零的haskell Int转换为String

> ID：376968
> 
> 赞同：8
> 
> 时间：2008-12-18T05:22:04.950
> 
> 标签：string, haskell, int

假设我有一个 Int = 08 类型的变量，如何将其转换为保持前导零的字符串？

例如：

```
v :: Int
v = 08

show v 
```

输出：8

我希望输出为“08”。

这可能吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-18T05:30:46.057

使用`Text.Printf.printf`：

```
printf "%02d" v 
```

确保先导入`Text.Printf.printf`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-18T06:39:10.100

它的 8，而不是变量*v*中的 08 。是的，您将其分配为 08，但它收到 8。这就是*show*方法将其显示为 8 的原因。您可以使用[Mipadi 给出的解决方法](https://stackoverflow.com/a/376982/1477667)。

**编辑：**

测试的输出。

```
Prelude> Text.Printf.printf "%01d\n" 08
8
Prelude> Text.Printf.printf "%02d\n" 08
08
Prelude> Text.Printf.printf "%03d\n" 08
008 
```

另一个测试的输出。

```
Prelude> show 08
"8"
Prelude> show 008
"8"
Prelude> show 0008
"8" 
```

我希望你明白这一点。

**编辑：**

找到了另一种解决方法。试试这个，

```
"0" ++ show v 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T06:49:45.727

根据您的计划，您可能希望将“08”存储为字符串，并且仅在需要该值时才转换为 int。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-03T03:40:12.653

这种`printf`方式可能是最好的，但编写自己的函数很容易：

```
show2d :: Int -> String 
show2d n | length (show n) == 1 = "0" ++ (show n)
         | otherwise = show n 
```

工作如下：

```
Prelude> show2d 1
"01"
Prelude> show2d 10
"10"
Prelude> show2d 100
"100" 
```

# web-services - 开发团队是否有 Web 服务 (API) 标准或最佳实践？

> ID：376979
> 
> 赞同：6
> 
> 时间：2008-12-18T05:29:59.317
> 
> 标签：web-services

如果您要开始为您的 Web 应用程序开发 API。是否有任何类型的指南、最佳实践或标准来构建 Web 服务。我已经看到了有关此主题的一些讨论，我希望获得更多信息。

至少获得有关从何处获取信息的指示。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T19:59:29.470

关于“Web 服务”，存在着广泛的多样性和自由度。我发现明确说明我们正在谈论的内容很有用：

```
web = transported over HTTP(S)
service = remote procedure call (RPC) 
```

请注意，其中的 HTTP(S) 部分仅指定了传输介质，而不是内容。另请注意，这部分的 RPC 仅指定行为（本质上是远程调用带有返回结果的参数的命名函数）而不是内容。

出现的一个关键问题是你是否控制了沟通的双方。如果是这样，但特别是如果不是，您需要关注互操作性。

SOAP 是一种实现 Web 服务的标准，它指定使用特定格式的 XML 来处理请求和响应的内容。它非常繁重，并且在各种实现之间的互操作性方面仍然存在问题。

有很多自定义实现，其中大多数更轻量级，但您几乎肯定会遇到互操作性问题。

由于任何形式的内容都可能用于实现 Web 服务，因此我建议选择能够处理复杂内容（不同程度）、标准化、轻量级和健壮的内容。

我最近倾向于使用 JSON 作为内容格式。我建议您考虑相同，特别是如果您正在考虑实施 AJAX。

最良好的祝愿。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T21:54:11.990

[API 101](http://www.cincomsmalltalk.com/blog/blogView?showComments=true&entry=3258158706)

我粘贴此 URL 作为可能答案的近似值。由于我没有得到任何其他答案，我认为这是尽可能接近的。

我希望有更详细的最佳实践大纲，如果有人发现更好的东西，请告诉我将他们的答案标记为已接受。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-23T16:11:28.493

如果你能回答其中的一些问题，你可能会得到一个更令人满意的答案。

1.  将使用该服务的受众是谁？
2.  哪些类型的客户端技术将使用该服务
3.  您可以对它们施加什么假设/限制（平台、工具、技能组合）？
4.  您的 API 有多广泛——它将公开多少种方法？
5.  安全性是一个考虑因素 - 您需要有多安全？
6.  你需要支持交易吗？

# java - java中的对象类型比较除了instanceof运算符之外还有其他方法吗？

> ID：376988
> 
> 赞同：5
> 
> 时间：2008-12-18T05:34:26.157
> 
> 标签：java

我记得在一些 Java 书籍中读过除“instanceof”之外的任何运算符，用于比较两个对象之间的类型层次结构。

instanceof 是最常用和最常见的。我无法清楚地记得是否确实有另一种方法可以做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T05:41:31.197

您也可以，主要用于反射，使用`Class.isInstance`.

```
Class<?> stringClass = Class.forName("java.lang.String");
assert stringClass.isInstance("Some string"); 
```

显然，如果类的类型在编译时已知，那么`instanceof`仍然是最好的选择。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-18T06:29:42.630

就在这里。不是运算符，而是 Class 类的方法。

这里是： [isIntance(Object o)](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#isInstance(java.lang.Object))

从文档中引用：

> *...此方法是 Java 语言 instanceof 运算符的动态等效方法*

```
public class Some {
    public static void main( String [] args ) {
        if ( Some.class.isInstance( new SubClass() ) ) {
            System.out.println( "ieap" );
        } else { 
            System.out.println( "noup" );
        }
    }
}
class SubClass extends Some{} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T06:07:29.850

instanceof 操作是最好的选择，原因有两个：1）它处理子类型，所以如果你有一个子类/子类型的实例，你仍然会得到 true。2) 它处理 null，所以 null instanceof Class 将返回 false

如果你取一个对象的类，然后与另一个类进行比较，你就有可能取一个空对象的类，而且你不能直接获得子类型。

如果您使用表示类的对象，则可以使用反射操作，因为 instanceof 将引用它们自己的类 Class，而不是它们所代表的类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T07:00:41.320

```
if ( someClass.isAssignableFrom( obj.getClass() ) ) 
```

相当于

```
if ( obj instanceof Foo ) 
```

如果`instanceof`要检查的类在编译时已知，则使用，`isAssignableFrom`如果仅在运行时已知，则使用。

# apache - 为什么 Apache mod_rewrite 没有按预期运行

> ID：376998
> 
> 赞同：0
> 
> 时间：2008-12-18T05:43:00.947
> 
> 标签：apache, url, mod-rewrite, codeigniter

我想将使用原始 URL 请求的旧站点的 URL 重定向到我在 CodeIgniter 中实现的新站点。我只是想将它们重定向到我的索引页面。我还想在我的 URL 中去掉“index.php”，这样我的 URL 就可以像 example.com/this/that 一样简单。所以，这是`.htaccess`我创建的文件：

```
RewriteEngine on
Options FollowSymLinks

RewriteBase /

RewriteCond $1 ^assets
RewriteRule ^(.*)$ example/production/$1

RewriteCond %{QUERY_STRING} .+
RewriteRule ^(.*)$ index.php? [R=301]

RewriteCond $1  !^(index\.php|example|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 
```

还应该注意的是，我的 index.php 实际上是指向`example/production/index.php`.

现在，第一个规则按预期工作 - 我所有的样式和图像都显示得很好，这是我遇到问题的后两个规则。第二条规则基本上是销毁查询字符串并重定向到我的索引页面（外部）。所以，我在 Apache 手册中找到了这个：

> 注意：查询字符串
> 
> 模式不会与查询字符串匹配。相反，您必须使用带有 %{QUERY_STRING} 变量的 RewriteCond。但是，您可以在包含查询字符串部分的替换字符串中创建 URL。只需在替换字符串中使用问号，即可指示应将以下文本重新注入到查询字符串中。当您想删除现有的查询字符串时，只用问号结束替换字符串。要将新查询字符串与旧查询字符串组合，请使用 [QSA] 标志。

但是，当我尝试访问其中一个旧页面时，我没有重定向到我的索引页面，而是收到 404 page not found 错误。我已经通过将其设置为内部重定向找到了一种解决方法，但我真的希望它是外部的。

下一个问题，也是最让我困惑的一个问题是第三条规则。我希望这会做类似以下的事情。如果我输入：

```
http://example.com/this/thing 
```

我希望它重新路由到

```
http://example.com/index.php/this/thing 
```

不幸的是，这不起作用。相反，无论我输入什么，它总是路由到我的索引页面，就好像 URL 中没有其他内容一样（它只是转到`http://example.com/`）。

此外，如果我用以下内容替换该规则，我会更加困惑：

```
RewriteCond $1 !^(index\.php|example|robots\.txt)
RewriteRule ^(.*)$ index.php/this/thing 
```

如果我输入一个 URL，例如`http://example.com/other/thing`，那么它会`http://example.com/index.php/this/thing`按预期转到，但是如果我输入`http://example.com/this/thing`它会转到`http://example.com/`（我的索引页）。我无法从中做出正面或反面。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T10:22:04.657

> 嗯 - 这似乎也不起作用。问题是我的 URL 并没有真正要求文件名或目录。例如：example.com/index.php/this/thing 应该调用 'this' 控制器的 'thing' 方法。——史蒂文·奥克斯利

条件是：如果请求不是文件而不是目录，那么这是正确的，你应该做的是结合请求字符串的附加：

```
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T08:49:32.690

这应该可以解决您的 index.php 问题，它会简单地检测 robots.txt 是否可用：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```************