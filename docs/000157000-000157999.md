# StackOverflow 问答 000157000-000157999

# jsp - 使用 JSP 文档 (JSPX) 有条件地在元素上设置属性

> ID：157005
> 
> 赞同：20
> 
> 时间：2008-10-01T10:25:00.247
> 
> 标签：jsp, xhtml, webforms, jspx

在 HTML 表单中，可以通过在按钮上定义 "disabled" 属性来禁用按钮，其值为任意值：

```
<button name="btn1" disabled="disabled">Hello</button> 
```

如果要启用按钮，则该属性不应该存在，因为没有定义的值可以设置 disabled 属性以使按钮保持启用状态。

当我想在使用 JSP 文档 (jspx) 时启用/禁用按钮时，这会导致我出现问题。由于 JSP 文档必须是格式良好的 XML 文档，因此我看不到任何有条件地包含此属性的方式，因为以下内容是不合法的：

```
<button name="btn1" <%= (isDisabled) ? "disabled" : "" %/> >Hello</button> 
```

虽然我可以使用 JSTL if 标签复制标签两次以获得所需的效果，但在我的具体情况下，我在按钮上声明了超过 15 个属性（AJAX 的许多 javascript 事件处理程序属性），因此复制标签将使JSP 很乱。

如何在不牺牲 JSP 可读性的情况下解决这个问题？是否有任何自定义标签可以通过操作输出 DOM 向父级添加属性？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T09:11:39.537

我使用具有动态属性的自定义 JSP 标记。你像这样使用它：

```
<util:element elementName="button" name="btn1" disabled="$(isDisabled ? 'disabled' : '')"/> 
```

基本上，这个标签所做的是生成一个带有 elementName 的 XML 元素，并将所有存在的属性放在标签中，但会跳过空的属性。

标签本身很容易实现，我的实现只有 44 行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-23T09:09:40.623

@alex 使用三元运算符的绝佳解决方案。我添加了一些我的示例，感谢您，我只是更改了条件的结果，如果为 true，则写入属性，否则不写入任何内容

填充列表并选择使用的值，避免使用 c:if

```
<select id="selectLang" name="selectLang" >
<c:forEach var="language" items="${alLanguages}" >
    <option value="${language.id}" ${language.code == usedLanguage ? 'selected' : ''} >${language.description}</option>
</c:forEach> 
```

在开始时检查单选按钮以避免 c:if:

```
<input type="radio" id="id0" value="0" name="radio" ${modelVar == 0 ? 'checked' : ''} />
<input type="radio" id="id1" value="1" name="radio" ${modelVar == 1 ? 'checked' : ''} />
<input type="radio" id="id2" value="2" name="radio" ${modelVar == 2 ? 'checked' : ''} /> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-22T00:43:15.493

您可以使用该`<jsp:text>`标签通过有效的 XML 来解决此问题：

```
<jsp:text><![CDATA[<button name="btn1"]]></jsp:text>
    <c:if test="${isDisabled}"> disabled="disabled"</c:if>
    >
    Hello!
<jsp:text><![CDATA[</button>]]></jsp:text> 
```

这显然比其他一些解决方案更冗长。但它是**完全独立的**：不需要自定义标签。此外，它**可以轻松扩展**到您需要的任意数量的属性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-02-28T23:56:24.273

我想自上一篇文章以来已经过去了一段时间，但我遇到了与标签完全相同的问题`<select><option selected="selected">`，即动态声明选择了哪个选项。为了解决这个问题，我制作了一个自定义 tagx；[我在这里的另一个答案](https://stackoverflow.com/questions/1761479/how-to-output-option-selectedtrue-from-jspx/2353187#2353187)中发布了详细信息

我得出的结论是没有好的捷径；EL 和 JSP 表达式只能存在于 XML 元素属性中（以及正文内容中）。因此，您必须执行以下操作；

```
<c:choose>
    <c:when test="${isDisabled}"><button name="btn1" disabled="disabled">Hello</button></c:when>
    <c:otherwise><button name="btn1">Hello</button></c:otherwise>
</c:choose> 
```

使用 scriptlet 表示法不适用于 JSP 文档 (.jspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-15T11:10:46.007

阅读有关自动[jsp 到 jspx 转换器](http://diaryproducts.net/about/programming_languages/java/convert_jsp_pages_to_jsp_documents_jspx_with_jsp2x)的信息时，我遇到了`<jsp:element>`and`<jsp:attribute>`标签。如果我理解正确，你应该能够做类似的事情

```
<jsp:element name="button">
  <jsp:attribute name="someAttribute">value</jsp:attribute>
</jsp:element> 
```

并有jsp引擎输出

```
<button someAttribute="value"/> 
```

或类似的东西。上面页面中指出的唯一问题是，这似乎不适用于条件构造。转换器的作者解决了创建一些帮助标签的问题，你可以看看下载我猜的源代码。希望有帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-07-15T22:52:57.823

创建一个标签库 (.tagx) 然后使用 scriptlet 标签。

请参阅[http://code.google.com/p/jatl/wiki/JSPExample](http://code.google.com/p/jatl/wiki/JSPExample)

```
<?xml version="1.0" encoding="UTF-8" ?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.1">
<jsp:directive.page import="com.googlecode.jatl.Html"/>
<jsp:directive.page import="com.evocatus.product.data.AttributeValue"/>
<jsp:directive.page import="com.evocatus.domain.Product"/>

<jsp:scriptlet>
//<![CDATA[
    final Product p = (Product) request.getAttribute("product");
        new Html(out) {{
           for (AttributeValue v : p.summaryAttributeValues()) {
                   p();
                        strong().text(v.getLabel()).end();
                        text(": " + v.getValue());
                   endAll();
           }
        }};
//]]>
</jsp:scriptlet>

</jsp:root> 
```

是的，这是作弊......但它完成了工作。另外，您能否以这种方式对树结构进行非常讨厌的复杂递归。

我还在我的博客和 gist.github 上发布了另一个解决方案，它使用了一堆 tagx 库：[http ://adamgent.com/post/8083703288/conditionally-set-an-attribute-on-an-element-with-jspx](http://adamgent.com/post/8083703288/conditionally-set-an-attribute-on-an-element-with-jspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-04T05:46:28.377

<%= blah %> 语法不是 JSP 文档所需的合法 XML。您有 2 个选项：

1.  替换 <%= (isDisabled) ？"disabled" : "" %> with <jsp.expression>(isDisabled) ? “禁用”：“”</jsp.expression>
2.  使用 Core taglib 和 EL（确保将 isDisabled 放入页面范围），如下所示：

```
<c:选择>
  <c:when test="${isDisabled}">"禁用"</c:when>
  <c:otherwise>""</c:otherwise>
</c:选择>

```

希望有帮助:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-15T02:56:14.957

我一直在努力解决同样的问题。我尝试使用`<jsp:attribute name="disabled"/>`inside `<c:if>`，但编译器尝试将 disabled 属性附加到`c:if`失败的元素。但我发现这确实有效（`stripes:submit`是一个用于创建带状提交类型按钮的元素）：

```
<stripes:submit name="process" value="Hello">
   <jsp:attribute name="disabled">
       <c:if test="${x == 0}">disabled</disabled>
   </jsp:attribute>
</stripes:submit> 
```

如果正文仅包含空格，似乎`jsp:attribute`根本不会创建属性，因此您要么得到`disabled="disabled"`要么什么都没有。

这仅在您使用某种标记库生成按钮时才有效，并且标记元素必须支持 disabled 属性（将其传递给底层 HTML 元素）。您不能使用`jsp:attribute`将属性添加到原始 HTML 元素。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-11T17:56:20.447

我像[https://stackoverflow.com/a/207882/242042](https://stackoverflow.com/a/207882/242042)一样实现它并封装了[https://stackoverflow.com/a/775295/242042](https://stackoverflow.com/a/775295/242042)以便它可以作为标签重复使用。

```
<%@ tag
  display-name="element"
  pageEncoding="utf-8"
  description="similar to jsp:element with the capability of removing attributes that are blank, additional features depending on the key are documented in the tag."
  trimDirectiveWhitespaces="true"
  dynamic-attributes="attrs"
%>
<%@ attribute
  name="tag"
  description="Element tag name.  Used in place of `name` which is a common attribute in HTML"
  required="true"
%>
<%-- key ends with Key, use i18n --%>
<%-- key starts with x-bool- and value is true, add the key attribute, no value  --%>
<%-- key starts with x-nc- for no check and value is empty, add the key attribute, no value  --%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<jsp:text><![CDATA[<]]></jsp:text>
<c:out value="${tag} " />
<c:forEach var="attr" begin="0" items="${attrs}">
  <c:choose>
    <c:when test='${fn:endsWith(attr.key, "Key")}'>
      ${attr.key}=<fmt:message key="${attr.value}" />
    </c:when>
    <c:when test='${fn:startsWith(attr.key, "x-bool-") && attr.value == "true"}'>
      <c:out value="${fn:substringAfter(attr.key, 'x-bool-')}" />
    </c:when>
    <c:when test='${fn:startsWith(attr.key, "x-bool-") && attr.value != "true"}'>
    </c:when>
    <c:when test='${fn:startsWith(attr.key, "x-nc-")}'>
      <c:out value="${fn:substringAfter(attr.key, 'x-nc-')}" />="<c:out value='${attr.value}' />"
    </c:when>
    <c:when test='${not empty attr.value}'>
      <c:out value="${attr.key}" />="<c:out value='${attr.value}' />"
    </c:when>
  </c:choose>
  <c:out value=" " />
</c:forEach>
<jsp:doBody var="bodyText" />
<c:choose>
  <c:when test="${not empty fn:trim(bodyText)}">
    <jsp:text><![CDATA[>]]></jsp:text>
      ${bodyText}
    <jsp:text><![CDATA[<]]></jsp:text>
      <c:out value="/${tag}" />
    <jsp:text><![CDATA[>]]></jsp:text>
  </c:when>
  <c:otherwise>
    <jsp:text><![CDATA[/>]]></jsp:text>
  </c:otherwise>
</c:choose> 
```

要使用它，请将其放在 taglib tagdir 中。

```
<%@ taglib tagdir="/WEB-INF/tags" prefix="xyz"%>
...
<xyz:element tag="input"
  type="date"
  id="myDate"
  name="myDate"
  x-bool-required="true"
/> 
```

输出将呈现为

```
<input 
    name="myDate"
    id="myDate"
    type="date"
    required/> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-23T09:09:36.037

**使用纯**JSP 的正确方法是：

```
<jsp:element name="button">
  <jsp:attribute name="name">btn1</jsp:attribute>
  <jsp:attribute name="disabled" omit="${not isDisabled}">disabled</jsp:attribute>
  <jsp:body>Hello</jsp:body>
</jsp:element> 
```

关键是使用`omit`属性 on `<jsp:attribute>`- 如果表达式计算结果为，`true`则该属性根本不会被渲染。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-10-01T10:45:59.697

我并没有真正使用JSP（我回复过一次，然后在我理解“必须通过有效的XML”事情时将其删除）。我能想到的最干净的是：

```
<% if (isDisabled) { %>
  <button name="btn1" disabled="disabled">Hello</button>
<% } else { %>
  <button name="btn1">Hello</button>
<% } %> 
```

# .net - .NET Web 服务开发方法

> ID：157009
> 
> 赞同：3
> 
> 时间：2008-10-01T10:25:40.887
> 
> 标签：.net, web-services

我打算为我的应用程序编写一个 Web 服务 aka api，它是用 .Net 和 SQLServer 开发的。.Net 提供了一种通过创建 asmx 文件来创建 Web 服务的简单方法。但是我需要知道它可以设计得如何最好，或者在 .net 中创建 Web 服务的最佳实践是什么，或者一些好的文章的指针，因为这是我在 Web 服务编程方面的第一次体验。尽管 SF 有很多关于 API 最佳实践的参考（非常好），但我没有找到太多面向 .net webservices 的信息。

更新：在 dariom 的回复之后，我想提一下我在 .net 2.0 中做的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T10:47:06.653

记住所有最佳实践并不容易，但这是我的建议：

*   避免使用不易序列化或与 WS 标准不兼容的数据类型（因此您将无法使用不同的语言使用服务）。最值得注意的是 RecordSet 和其他仅限 MS 的引用类型。
*   请注意，静态 Web 服务（具有 [webmethod] 的静态方法）和非静态（成员函数）之间存在差异。这可能会影响您的性能和资源使用情况。
*   设计在 Intranet 中运行的 .NET Web 服务与为 Internet 设计的 Web 服务之间存在差异。第二个应该更简单，因为传输到网络上的 XML 数据应该小得多。
*   我猜 web 服务将部署在 IIS 服务器上。请注意，在 Intranet 和 Internet 上运行时，身份验证存在差异。您可能需要使用模拟服务才能执行特定任务。

我想还有更多，更好地寻找一些讨论这个的文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-26T23:10:02.377

我们首先从 XSD 模式（合同优先）开始开发 Web 服务。我们还使用 Thinktecture 的 WSCF [- Web Services Contract First](http://www.thinktecture.com/resourcearchive/tools-and-software/wscf) 工具来生成 Web 服务接口。在过去的 2 年里，它对我们非常有效。

他们还很好地介绍了如何使用那里的工具。 [http://www.thinktecture.com/resourcearchive/tools-and-software/wscf/wscf-walkthrough](http://www.thinktecture.com/resourcearchive/tools-and-software/wscf/wscf-walkthrough)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T23:09:52.607

这里有一本 .NET ASMX Web 服务的设计模式书：http: [//msdn.microsoft.com/en-us/library/ms978729.aspx](http://msdn.microsoft.com/en-us/library/ms978729.aspx)

它描述了以下设计模式：

实体聚合 流程集成 门户集成 数据集成 功能集成 面向服务的集成 演示集成 消息代理 消息总线 发布/订阅 管道和过滤器 网关

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T11:29:20.513

如果您使用的是 .NET 3.0 或更高版本，我鼓励您考虑使用 WCF 实现您的服务。

学习曲线更加陡峭，但您将从[WCF 提供的灵活性和功能中](http://msdn.microsoft.com/en-us/library/ms730214.aspx)受益。使用 WCF，您可以使您的服务与 ASMX 服务（常规 .NET Web 服务）兼容，以便其他应用程序和其他语言可以像使用常规 .NET Web 服务一样使用该服务。

有很多资源可以帮助您入门。尝试[MSDN](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)、[学习 WCF](https://rads.stackoverflow.com/amzn/click/com/0596101627)和[编程 WCF 服务](https://rads.stackoverflow.com/amzn/click/com/0596526997)。

# python - Emacs 和 Python

> ID：157018
> 
> 赞同：34
> 
> 时间：2008-10-01T10:29:22.717
> 
> 标签：python, emacs

我最近开始学习[Emacs](http://www.gnu.org/software/emacs/)。我浏览了教程，阅读了一些介绍性文章，到目前为止一切都很好。

现在我想将它用于 Python 开发。据我了解，Emacs 有两种独立的 Python 模式：python-mode.el，它是 Python 项目的一部分；和 python.el，它是 Emacs 22 的一部分。

我阅读了我能找到的所有信息，但其中大部分似乎都已经过时了，我仍然感到困惑。

问题：

1.  他们有什么区别？
2.  我应该安装和使用哪种模式？
3.  是否还有其他对 Python 开发至关重要的 Emacs 附加组件？

相关链接：

*   [EmacsEditor](http://wiki.python.org/moin/EmacsEditor) @ wiki.python.org
*   [PythonMode](http://www.emacswiki.org/cgi-bin/wiki/PythonMode) @emacswiki.org

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-01T10:47:59.617

如果您使用的是 GNU Emacs 21 或之前的版本，或者 XEmacs，请使用 python-mode.el。GNU Emacs 22 python.el 不适用于它们。在 GNU Emacs 22 上，python.el 确实有效，并且与 GNU Emacs 自己的符号解析和完成、ElDoc 等更好地结合。我自己使用 XEmacs，所以我不使用它，而且我听到人们抱怨它没有过去工作得不是很好，但是有一些更新可以解决一些问题（例如，在您链接的 emacswiki 页面上），您希望现在已经将一些更新集成到上游。如果我是 GNU Emacs 类型，我会使用 python.el，直到我找到不这样做的具体理由。

据我所知，python-mode.el 的最大问题是它不太理解三引号字符串。它将它们视为单引号，这意味着三引号字符串中的单引号将抛出语法突出显示：它会认为字符串已经结束。您可能还需要更改您的 auto-mode-alist 以为 .py 文件打开 python-mode；我不记得是否仍然如此，但我的 init.el 多年来一直在设置 auto-mode-alist。

至于其他插件，我认为没有什么是“必要的”。XEmacs 的 func-menu 有时很有用，它为您提供当前文件的小功能/类浏览器菜单。我不记得 GNU Emacs 是否有类似的东西。我有一个用于 reStructuredText 编辑的 rst 模式，因为它在某些项目中使用。绑定到您使用的任何 VC（如果有的话）可能对您有用，但对于其他大多数和易于下载的 .el 文件都有内置支持。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-01T17:52:18.380

[该站点](http://www.rwdev.eu/articles/emacspyeng)描述了如何在 Emacs 中完成 Python 代码。 [Ropemacs](http://rope.sourceforge.net/ropemacs.html)是一种让 Rope 在 emacs 中工作的方法。我没有丰富的经验，但它们值得研究。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-12-31T12:00:22.113

考虑到我有几个打开的缓冲区都被调用的次数`__init__.py`，我认为[uniquify](http://www.emacswiki.org/emacs/uniquify)库对于 python 开发至关重要。

Pyflakes 还有助于提高生产力。

# sql - iSeries SQL 过程 - 检查是否已经存在

> ID：157020
> 
> 赞同：3
> 
> 时间：2008-10-01T10:29:49.923
> 
> 标签：sql, ibm-midrange

如果它试图创建的任何程序已经存在，我有一个脚本会失败。如果此过程已创建，我如何检查/删除？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T11:52:36.997

我猜想是这样的：

```
IF EXISTS
(
    SELECT *
    FROM SYSPROCS
    WHERE SPECIFIC_SCHEMA = ???
      AND SPECIFIC_NAME = ???
      AND ROUTINE_SCHEMA = ???
      AND ROUTINE_NAME = ???
)
    DROP PROCEDURE ??? 
```

我不知道您是否真的需要 SPECIFIC_* 信息，并且我不知道如何处理您有两个具有相同名称但调用签名不同的过程的情况，但希望这能让您走上正确的轨道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T12:54:55.337

```
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[dbo].[Procedure_Name]') AND OBJECTPROPERTY(id,N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[Procedure_Name] 
```

我认为这会对你有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-23T11:22:47.480

`DROP PROCEDURE xxx ; CREATE PROCEDURE XXX . . . ;`

包括 a`DROP PROCEDURE`作为脚本中的第一条语句。如果您使用 RUNSQLSTM 运行，请使用 ERRLVL(20) 以允许 DROP 失败。如果您通过“运行 SQL 脚本”运行，请使用“在 DROP 上忽略“未找到对象”选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-12T03:55:33.443

您可以通过这种方式检查是否存在（注意 - 确保大小写）：

```
SELECT *                       
FROM QSYS2/PROCEDURES          
WHERE PROCNAME LIKE 'your-procedure-name'
AND   PROCSCHEMA = 'your-procedure-library' 
```

# .net - 在哪里可以找到 .NET Framework 类图？

> ID：157026
> 
> 赞同：9
> 
> 时间：2008-10-01T10:32:24.397
> 
> 标签：.net, class-diagram, hierarchy

我只需要一个框架结构的文件（图片、pdf或其他类型的打印文件）。在学习 .Net 框架时非常有用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-01T10:35:58.303

[.NET Framework 3.5 通用命名空间和类型海报](http://www.microsoft.com/downloads/details.aspx?FamilyID=7b645f3a-6d22-4548-a0d8-c2a27e1917f8&displaylang=en)

> 2007 年 11 月版 .NET
> Framework 3.5 通用命名空间和类型海报
> 
> 概述
> .NET Framework 3.5 通用命名空间和类型海报可下载为 XPS 或 PDF 格式。还有一个 XPS 格式文件，可打印超过 16 个字母或 A4 页，以便于打印。如果您选择此打印方法，则需要进行一些组装。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T10:41:40.443

如果您大胆且喜欢冒险，您可以使用[我在 CodeProject 上找到的工具](http://www.codeproject.com/KB/cs/AutoDiagrammer.aspx "代码项目文章")。将框架类发送给它，瞧，经过一番碾压、打磨和呻吟之后，你应该从中得到一个图表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-28T10:00:21.443

[检查这张海报](http://blogs.msdn.com/brada/archive/2008/10/29/net-framework-4-poster.aspx)，看看它是否有帮助。

[![替代文字](https://i.stack.imgur.com/Wv7nb.png)](https://i.stack.imgur.com/Wv7nb.png)
[（来源：[msdn.com](http://blogs.msdn.com/blogfiles/brada/WindowsLiveWriter/55ff37220b2c.NETFramework4Poster_67A1/PDC2008-NETFX4_thumb.png)）]

这是[深度缩放版本](http://brad_abrams.members.winisp.net/Projects/PDC2008/DotNet4Poster/DotNetFramework4PosterDeepZoom.htm)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T10:34:38.523

[http://download.microsoft.com/download/4/a/3/4a3c7c55-84ab-4588-84a4-f96424a7d82d/NET_35_Namespaces_Poster_JAN08.pdf](http://download.microsoft.com/download/4/a/3/4a3c7c55-84ab-4588-84a4-f96424a7d82d/NET_35_Namespaces_Poster_JAN08.pdf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-28T10:01:17.283

我现在正在看着我身后的一个（和其他几个），显然它带有 Visual C#/Studio。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-28T10:02:17.203

您没有指定 .NET Framework 的哪个版本，有点不清楚您是指每个类的映射还是所有类的映射。无论如何，这里是 .NET 3.5：

[http://download.microsoft.com/download/4/a/3/4a3c7c55-84ab-4588-84a4-f96424a7d82d/NET35_Namespaces_Poster_LORES.pdf](http://download.microsoft.com/download/4/a/3/4a3c7c55-84ab-4588-84a4-f96424a7d82d/NET35_Namespaces_Poster_LORES.pdf)

# ms-access - 在 MS Access 中解析文本

> ID：157034
> 
> 赞同：1
> 
> 时间：2008-10-01T10:35:51.347
> 
> 标签：ms-access, parsing

我有包含字符串的列。该列中的字符串如下所示：

第一串/第二串/第三串

我需要解析这个，所以我有两个值：

值 1：FirstString/SecondString 值 2：ThirdString

我实际上可以有更长的字符串，但我总是需要它像 [string1/string2/string3/...][stringN] 那样分开

我需要结束的是：

第 1 列：[string1/string2/string3/etc....] 第 2 列：[stringN]

我无论如何都找不到这样做的权限。有什么建议么？我需要正则表达式吗？如果是这样，有没有办法在查询设计器中做到这一点？

**更新**：这两个表达式都给我这个错误：“您输入的表达式包含无效的语法，或者您需要将文本数据括在引号中。”

```
expr1: Left( [Property] , InStrRev( [Property] , "/") - 1), Mid( [Property] , InStrRev( [Property] , "/") + 1)

expr1: mid( [Property] , 1, instr( [Property] , "/", -1)) , mid( [Property] , instr( [Property] , "/", -1)+1, length( [Property] )) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T11:07:44.560

在查询中，使用以下两个表达式作为列：

```
Left(col, InStrRev(col, "/") - 1), Mid(col, InStrRev(col, "/") + 1) 
```

col 是你的专栏。

如果在 VBA 中，请使用以下命令：

```
last_index= InStrRev(your_string, "/")

first_part= Left$(your_string, last_index - 1)
last_part= Mid$(your_string, last_index + 1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T10:40:02.957

中间（col，1，instr（col，“/”，-1）），中间（col，instr（col，“/”，-1）+1，长度（col））

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T19:40:57.303

您是否有机会修复底层数据结构以正确规范化，以便一开始就避免该问题？除了检索数据之外，还会出现整个主机或准确维护数据的问题，如果您不在单个字段中存储多个值，这一切都会得到改善。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T21:34:12.233

我知道您正在尝试在查询中执行此操作，因此 SQL 字符串函数可能是您最好的选择。

然而，值得一提的是，有一个可从 VBA 访问的正则表达式 COM 对象。只需在宏代码中添加对 Microsoft VBScript 正则表达式库的引用。

然后你可以做这样的事情

```
Dim szLine As String
Dim regex As New RegExp
Dim colregmatch As MatchCollection

With regex
    .MultiLine = False
    .Global = True
    .IgnoreCase = False
End With

szLine = "FirstString/SecondString/ThirdString"

regex.Pattern = "^(.*?\/.*?)/(.*?)$"
Set colregmatch = regex.Execute(szLine)

'FirstString/SecondString
Debug.Print colregmatch.Item(0).submatches.Item(0)
'ThirdString
Debug.Print colregmatch.Item(0).submatches.Item(1) 
```

# python - 在可迭代的东西中计算匹配元素的最pythonic方法

> ID：157039
> 
> 赞同：21
> 
> 时间：2008-10-01T10:37:20.267
> 
> 标签：python, list-comprehension

我有一个可迭代的条目，我想收集一些简单的统计数据，比如所有可被 2 整除的数字的计数和所有可被 3 整除的数字的计数。

我的第一个选择，虽然只遍历列表一次并避免列表扩展（并牢记[拆分循环](http://www.refactoring.com/catalog/splitLoop.html)重构），但看起来相当臃肿：

（备选案文 1）

```
r = xrange(1, 10)

twos = 0
threes = 0

for v in r:
  if v % 2 == 0:
    twos+=1
  if v % 3 == 0:
    threes+=1

print twos
print threes 
```

这看起来相当不错，但有将表达式扩展为列表的缺点：

（备选案文 2）

```
r = xrange(1, 10)

print len([1 for v in r if v % 2 == 0])
print len([1 for v in r if v % 3 == 0]) 
```

我真正想要的是像这样的函数：

（替代项 3）

```
def count(iterable):
  n = 0
  for i in iterable:
    n += 1
  return n

r = xrange(1, 10)

print count(1 for v in r if v % 2 == 0)
print count(1 for v in r if v % 3 == 0) 
```

但这看起来很像可以在没有函数的情况下完成的事情。最后的变体是这样的：

（替代项 4）

```
r = xrange(1, 10)

print sum(1 for v in r if v % 2 == 0)
print sum(1 for v in r if v % 3 == 0) 
```

虽然最小（在我的书中可能是最优雅的），但感觉它并不能很好地表达意图。

所以，我对你的问题是：

您最喜欢哪种选择来收集这些类型的统计数据？如果您有更好的选择，请随时提供您自己的替代方案。

为了消除下面的一些混淆：

*   实际上，我的过滤谓词比这个简单的测试更复杂。
*   我迭代的对象比数字更大更复杂
*   我的过滤器函数更加不同并且难以参数化为一个谓词

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-01T11:09:14.667

恕我直言，必须多次遍历列表并不优雅。

我可能会创建一个允许执行以下操作的函数：

```
twos, threes = countmatching(xrange(1,10),
                             lambda a: a % 2 == 0,
                             lambda a: a % 3 == 0) 
```

一个起点是这样的：

```
def countmatching(iterable, *predicates):
    v = [0] * len(predicates)
    for e in iterable:
        for i,p in enumerate(predicates):
            if p(e):
                v[i] += 1
    return tuple(v) 
```

顺便说一句，“itertools recipes”有一个很像你的 alt4 的方法。

```
def quantify(seq, pred=None):
    "Count how many times the predicate is true in the sequence"
    return sum(imap(pred, seq)) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-01T11:04:46.737

替代 4！但也许您应该将代码重构为一个函数，该函数接受一个包含可除数（二和三）的参数。然后你可以有一个更好的函数名。

```
def methodName(divNumber, r):
  return sum(1 for v in r if v % divNumber == 0)

print methodName(2, xrange(1, 10))
print methodName(3, xrange(1, 10)) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-01T10:51:36.457

您可以使用该[`filter`](http://docs.python.org/lib/built-in-funcs.html)功能。

它过滤一个列表（或严格来说是一个可迭代的），生成一个新列表，其中仅包含指定函数评估为真的项目。

```
r = xrange(1, 10)

def is_div_two(n):
    return n % 2 == 0

def is_div_three(n):
    return n % 3 == 0

print len(filter(is_div_two,r))
print len(filter(is_div_three,r)) 
```

这很好，因为它允许您将统计逻辑包含在函数中，并且其意图`filter`应该非常清楚。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-02T16:16:40.627

我会选择您的（替代 4）的一个小变体：

```
def count(predicate, list):
    print sum(1 for x in list if predicate(x))

r = xrange(1, 10)

count(lambda x: x % 2 == 0, r)
count(lambda x: x % 3 == 0, r)
# ... 
```

如果您想更改 count 的作用，请在一处更改其实现。

Note: since your predicates are complex, you'll probably want to define them in functions instead of lambdas. And so you'll probably want to put all this in a class rather than the global namespace.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T10:53:51.893

好吧，您可以做一个列表理解/表达式来获得一组带有该统计测试的元组，然后将其减少以获得总和。

```
 r=xrange(10)
s=( (v % 2 == 0, v % 3 == 0) for v in r )
def add_tuples(t1,t2):
     return tuple(x+y for x,y in zip(t1, t2))
sums=reduce(add_tuples, s, (0,0)) # (0,0) is starting amount

print sums[0] # sum of numbers divisible by 2
print sums[1] # sum of numbers divisible by 3 

```

使用生成器表达式等应该意味着您只会运行一次迭代器（除非 reduce 做任何奇怪的事情？）。基本上你会做地图/减少......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T16:47:13.433

真布尔值被强制为单位整数，而假布尔值被强制为零整数。因此，如果您乐于使用 scipy 或 numpy，请为序列的每个元素创建一个整数数组，每个数组包含每个测试的一个元素，并对数组求和。例如

```
>>> sum(scipy.array([c % 2 == 0, c % 3 == 0]) for c in xrange(10))
array([5, 4]) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T10:53:12.113

如果您只有数字，我肯定会查看[numpy数组而不是可迭代列表。](http://www.numpy.org/)几乎可以肯定，您可以在数组上使用一些简洁的算术来做您想做的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-01T10:56:46.770

不像您正在寻找的那样简洁，但更有效，它实际上适用于任何可迭代，而不仅仅是您可以循环多次的可迭代，并且您可以扩展要检查的内容而不会进一步复杂化：

```
r = xrange(1, 10)

counts = {
   2: 0,
   3: 0,
}

for v in r:
    for q in counts:
        if not v % q:
            counts[q] += 1
        # Or, more obscure:
        #counts[q] += not v % q

for q in counts:
    print "%s's: %s" % (q, counts[q]) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-01T11:26:34.873

```
from itertools import groupby
from collections import defaultdict

def multiples(v):
    return 2 if v%2==0 else 3 if v%3==0 else None
d = defaultdict(list)

for k, values in groupby(range(10), multiples):
    if k is not None:
        d[k].extend(values) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-01T13:32:41.733

这里的想法是使用归约来避免重复迭代。此外，如果内存对您来说是个问题，这不会创建任何额外的数据结构。您从带有计数器 ( `{'div2': 0, 'div3': 0}`) 的字典开始，并在迭代过程中递增它们。

```
def increment_stats(stats, n):
    if n % 2 == 0: stats['div2'] += 1
    if n % 3 == 0: stats['div3'] += 1
    return stats

r = xrange(1, 10)
stats = reduce(increment_stats, r, {'div2': 0, 'div3': 0})
print stats 
```

如果你想计算比除数更复杂的东西，使用更面向对象的方法（具有相同的优点）是合适的，封装统计数据提取的逻辑。

```
class Stats:

    def __init__(self, div2=0, div3=0):
        self.div2 = div2
        self.div3 = div3

    def increment(self, n):
        if n % 2 == 0: self.div2 += 1
        if n % 3 == 0: self.div3 += 1
        return self

    def __repr__(self):
        return 'Stats(%d, %d)' % (self.div2, self.div3)

r = xrange(1, 10)
stats = reduce(lambda stats, n: stats.increment(n), r, Stats())
print stats 
```

请指出任何错误。

@Henrik：我认为第一种方法的可维护性较差，因为您必须在一个地方控制字典的初始化并在另一个地方进行更新，并且必须使用字符串来引用每个统计信息（而不是具有属性）。而且我认为在这种情况下 OO 并不过分，因为您说谓词和对象在您的应用程序中会很复杂。事实上，如果谓词真的很简单，我什至不会费心使用字典，一个固定大小的列表就可以了。干杯:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-01T15:35:20.267

受上面 OO-stab 的启发，我也不得不尝试一个（尽管这对于我要解决的问题来说有点矫枉过正:)

```
class Stat(object):
  def update(self, n):
    raise NotImplementedError

  def get(self):
    raise NotImplementedError

class TwoStat(Stat):
  def __init__(self):
    self._twos = 0

  def update(self, n):
    if n % 2 == 0: self._twos += 1

  def get(self):
    return self._twos

class ThreeStat(Stat):
  def __init__(self):
    self._threes = 0

  def update(self, n):
    if n % 3 == 0: self._threes += 1

  def get(self):
    return self._threes

class StatCalculator(object):
  def __init__(self, stats):
    self._stats = stats

  def calculate(self, r):
    for v in r:
      for stat in self._stats:
        stat.update(v)
    return tuple(stat.get() for stat in self._stats)

s = StatCalculator([TwoStat(), ThreeStat()])

r = xrange(1, 10)
print s.calculate(r) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-01T16:59:00.037

Alt 3，因为它不使用与“命中”数成正比的内存。给定一个像 xrange(one_trillion) 这样的病态案例，许多其他提供的解决方案都会严重失败。

# .net - 在检查节点是否存在时，如何解决错误“表达式必须评估为节点集”？

> ID：157044
> 
> 赞同：15
> 
> 时间：2008-10-01T10:39:07.280
> 
> 标签：.net, xml, xpath

我正在尝试使用以下 .NET 代码检查节点是否存在：

```
xmlDocument.SelectSingleNode(
        String.Format("//ErrorTable/ProjectName/text()='{0}'", projectName)); 
```

这总是引发：

> XPathException：表达式必须计算为节点集。

为什么我会收到此错误，我该如何解决？谢谢你。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-01T11:24:40.417

给定的表达式计算为布尔值，而不是节点集。我假设您想检查 ProjectName 是否等于参数化文本。在这种情况下，您需要编写

```
//ErrorTable/ProjectName[text()='{0}'] 
```

这为您提供了与给定条件匹配的所有节点（节点集）的列表。此列表可能为空，在这种情况下，示例中的 C#-Expression 将返回 null。

作为事后的想法：您**可以**使用原始的 xpath 表达式，但不能使用 SelectSingleNode，而是使用 Evaluate，如下所示：

```
(bool)xmlDocument.CreateNavigator().Evaluate(String.Format("//ErrorTable/ProjectName/text()='{0}'", projectName)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T10:52:19.543

尝试：

```
Node node = xmlDocument.SelectSingleNode(String.Format("//ErrorTable/ProjectName = '{0}'", projectName));

if (node != null) {
    // and so on
} 
```

编辑：愚蠢的错误

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T11:13:11.177

XPath 表达式包含一个细微的错误。它应该是：

```
xmlDocument.SelectSingleNode(String.Format("//ErrorTable/ProjectName[text()='{0}']", projectName)); 
```

前面的表达式计算为布尔值，这解释了异常错误。谢谢您的帮助！

# .net - .NET 3.5 于 11/07 发布 .NET 3.0 于 11/06。为什么大多数人仍在使用 .NET 2.0？

> ID：157055
> 
> 赞同：12
> 
> 时间：2008-10-01T10:42:07.320
> 
> 标签：.net, .net-3.5, .net-2.0, .net-3.0

人们一直在开发自己的解决方案来解决以下问题：

*   用于远程信息交换的一致消息传递框架（webservices、rpc、...）
*   用于有限状态机和工作流等状态管理的 SDK
*   身份验证框架
*   以及更多。

**两年多来**，Microsoft 提供 .NET 3.0，其中包含一致且有据可查的所谓的工作流基础、通信、身份验证和构建 Web 应用程序的新方法。

然而，......人们仍在构建自己的框架，使用一致的对象关系映射来处理他们的数据库，拥有在运行时动态扩展类和方法的技术（例如，让客户能够自定义应用程序行为）。

一年**多来**，Microsoft 提供了 .NET 3.5，其中包括 LINQ，因此是一个很好的 ORM 和很好的方法来扩展您的代码，并且毕竟使编写代码更容易。

但是环顾四周……似乎大多数人仍在使用.NET 2.0。网站是用普通的 ASP.NET 创建的。桌面体验仍然是通过 CSS、JavaScript 和 HTML 的组合来实现的。可执行文件使用普通的旧 WinForms，工作流通过委托、事件、do/while 和 switch/case 实现。

没有太多讨论，我很高兴看到以下问题的具体原因：

在您看来：为什么人们不跳上 .NET 3.5 的火车？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-01T10:46:38.557

出于同样的原因，我知道仍然使用 Java 1.4 编写代码的 Java 开发人员——改变是昂贵的，而且对于那些在公司内部工作的人来说，完成它比使用新技术重要得多，这通常是毫无意义的。

对于很多内部工作来说，升级旧应用程序以在新环境中工作几乎没有理由。

此外，大型公司不喜欢出于各种稳定性问题而进行任何形式的更改，您仍然会发现他们做出在新解决方案中使用旧技术的决定仅仅是因为他们认为新技术不够稳定，对它了解得不够多，或者他们所依赖的软件没有足够的支持它。

而且，我从未使用过它，所以我不能说，但可能是 .NET 2 足以满足人们的需求，而 .NET 3.5 并没有提供足够的东西来保证学习/改变是参与其中，即使对于那些拥有更尖端技术的公司也是如此。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-01T10:56:40.420

1.  需要学习新东西，许多“只是一份工作”的 LOB 开发人员不会被打扰。
2.  遗留代码投资，可能不需要自定义系统，但它们可以工作，如果现有系统没有损坏，重新编码以使用基于框架的系统是浪费时间。
3.  开发软件成本。在 .net 3.x 中有效编码确实需要 VS2008。从 2005 年开始，将整个开发团队升级到该团队可能会花费很多。
4.  稳定。2.0 是 1.1 框架的演变。3.0 和 3.5 包括新的 v1 技术（您列出的那些）。开发人员希望看到技术在向经理证明其值得一试之前证明自己。与采用 Windows 一样，您可能会看到更多的人从 VS2005 转向 VS2010 和 .net 2.0 到 .net 4.0，因为这将包含 3.x 技术的 v2。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-01T10:47:29.803

因为它没有很好地支持网络托管公司。

我正在开发一个新的 Web 应用程序，但我的托管公司只提供 ASP.NET 2.0 支持。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-01T10:59:20.960

如果您想要 Windows 2000 支持，则必须使用 .NET 2.0。反正也没那么糟。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-01T11:18:22.430

我可以为我自己和我的公司说话。我们仍然不使用它。为什么？Well

**1** - 我们的大多数用户已经安装了 NET 2.0 框架。无需安装另一个框架。
**2** - 我们不会因为它是新事物而改变。它必须增加一些价值。
**3** - 真正还清变化意味着大量的工作。再次，它必须还清。
**4** - 就错误和新问题而言，现在判断它是否值得（一年还不够）还为时过早。不过，这似乎值得。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-01T10:59:31.477

.NET 3.0 包含对新项目非常有用的东西，但许多现有项目不想为了更新而采用这些东西——集成其中任何一个都需要大量的返工。

至于这个：

> 一年多来，Microsoft 提供 .NET 3.5

2007 年 11 月比一年前多多少？是的，.NET 3.5 很棒，我*喜欢*LINQ（尤其是 LINQ to Objects）和 C# 3.0 的好处——但改变总是要付出代价的。首先是推出 Visual Studio 2008 的成本。然后是针对 .NET 3.5（现在是 .NET 3.5SP1）重新测试所有内容的成本。然后是在所有服务器上部署 .NET 3.5 的成本，或者在所有客户端上需要 .NET 3.5 的成本。哦，更不用说实际学习以富有成效的方式使用所有新技术的成本了。

它会发生，但你不应该期望它*很快*。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-01T11:05:52.757

再补充一点[@SCdF](https://stackoverflow.com/users/1666/scdf)所说的，任何拥有大量 IT 员工的公司，而不是以开发人员为中心（即多数人），通常对新技术有很大的抵抗力。

从开发人员的角度来看，IT 部门往往落后，因为他们没有看到升级到新系统/硬件只是为了保持领先的商业价值。IT 忙于处理安全和维护（真实的或只是感知的），无法处理试图让他们升级到 .Net 3.5 的开发人员。

开发人员在与其他部门就业务价值进行沟通方面也是出了名的糟糕。当开发人员试图让 IT 或业务升级到 .Net 3.5 时，他们开始谈论自动化工作流和 XML 以及 Web 服务，而不是谈论美元和美分。

[微软的布赖恩·普林斯（ Brian Prince](http://www.brianhprince.com/)）有一个关于“软技能”的非常好的演示文稿，其中涵盖了其中的一些内容。如果你很好地问他，他可能会来你的公司并出席:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-01T11:20:34.203

我问以前雇主的经理为什么他还没有转换，答案是“我不想支持三个框架”，意思是 1.1、2.0、3.5。

我解释说，升级到 3.5 与从 1.1 切换到 2.0 不同（3.5 是 2.0 的扩展，使用不同的 dll (Core.dll)，而不是像 1.1 到 2.0 这样的更新 dll）。

我可以看到很多经理都在使用这种思路，所以你要让他们知道！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-01T10:52:00.557

2.0有效，对吧？我认为较新的东西很棒而且很酷，我喜欢了解最新的东西，但最终如果它有效，通常会决定坚持你所拥有的。我支持一家运行 DOS 6.2x 程序多年（直到 2004 年）的商店，我常常对此挠头。但归根结底，在这种情况下，没有令人信服的商业理由花任何钱继续前进。

我敢肯定还有其他原因。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-01T10:53:33.143

对于所有新项目，我尝试使用 3.5（或任何最新的框架）。但是所有的旧网站，为什么客户会在它运行时支付升级费用？

如果您想要 3.5 中的特定技术，则升级，但除非；不要修复没有损坏的东西..

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-09T15:07:51.020

我很想知道 2.0 在获得“大部分市场份额”之前出现了多长时间——我的意思是，1 年或 2 年对你我来说可能听起来很长，但你必须记住新语言必须被释放，然后人们必须对其进行培训，然后他们必须足够了解它以将其“出售”给管理层。此外，VS2005 对很多人来说已经“足够好”了，升级到 VS2008 以支持更新的语言版本是有成本的——不仅仅是金钱，还有时间。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-06T04:31:52.980

大多数人仍在使用 Windows XP 的原因相同！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-07-05T03:54:02.517

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-06T04:42:13.333

对于政府处理，3.5 框架尚未批准用于某些环境，因此您不得不使用 2.0 或 3.0。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-10T12:43:12.320

最大的挑战是证明业务升级的合理性，尤其是现在我们正处于全球经济低迷时期。

在 3.5 中必须有一个特定的优势或技术，你的项目（可能是绿地）绝对不能没有，来推动它。

我正试图在一家大公司为它整理一个案例，因此商业利益必须超过现状。在当前的环境下，“留住人才”也无济于事，尤其是在大量候选人不断增加的情况下。

# erlang - 在 Erlang 中替换元组中的键

> ID：157058
> 
> 赞同：7
> 
> 时间：2008-10-01T10:42:29.363
> 
> 标签：erlang, tuples

我有一个元组列表，例如。[{1,40},{2,45},{3,54}....{7,23}] 其中 1...7 是星期几（通过查找 calendar:day_of_the_week() 来计算）。所以现在我想将列表更改为 [{Mon,40},{Tue,45},{Wed,54}...{Sun,23}]。有没有比列表更简单的方法：keyreplace？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-06T08:03:22.703

...或使用不同的语法：

```
[{httpd_util:day(A), B} || {A,B} <- L] 
```

在哪里：

```
L = [{1,40},{2,45},{3,54}....{7,23}] 
```

该构造称为*[列表推导](http://www.erlang.org/doc/programming_examples/list_comprehensions.html#3)*，内容如下：

> “建立一个`{httpd_util:day(A),B}`元组列表，`{A,B}`从列表中取出`L`”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T11:02:03.310

简单的。使用 httpd 模块中的 map 和一个方便的工具。

```
lists:map(fun({A,B}) -> {httpd_util:day(A),B} end, [{1,40},{2,45},{3,54},{7,23}]). 
```

# xml - 在 javaDoc 中，在 XML 中表示属性的最佳方式是什么？

> ID：157070
> 
> 赞同：0
> 
> 时间：2008-10-01T10:47:10.973
> 
> 标签：xml, javadoc

当您将 javaDoc 注释添加到您的代码并概述您要传回的 XML 文档的结构时，表示属性的最佳方式是什么？对此有最佳做法吗？

我的 javaDoc 注释的一般结构是这样的：

```
/**
 * ...
 * 
 * @return XML document in the form:
 * 
 * <pre>
 * &lt;ROOT_ELEMENT&gt;
 *    &lt;AN_ELEMENT&gt;
 *    &lt;MULTIPLE_ELEMENTS&gt;*
 * &lt;/ROOT_ELEMENT&gt;
 * </pre>
 */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T11:00:23.267

不确定我清楚地理解你的问题。

我首选的解决方案是将模式 XSD 或 DTC 嵌入到返回参数的描述中。您的解决方案似乎导致了关于如何表示多个元素或其他内容的个人习语。使用 XSD 或 DTD 之类的标准可以让您拥有一种众所周知和公认的语言来描述 XML 文档的结构。

关于 JavaDoc 表示，如果您使用的是 Eclipse，您可以在 Save Actions 下指定以格式化您的文档。这样您就可以正常使用 > 和 < 编写代码，并看到它转换为转义的 HTML 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T10:12:57.787

最后，我只是选择了：

```
/**
 * ...
 * 
 * @return XML document in the form:
 * 
 * <pre>
 * &lt;ROOT_ELEMENT&gt;
 *    &lt;AN_ELEMENT attribute1 attribute2&gt;
 *    &lt;MULTIPLE_ELEMENTS&gt;*
 * &lt;/ROOT_ELEMENT&gt;
 * </pre>
 */ 
```

# c++ - 我在哪里可以获得 comdef.h？

> ID：157101
> 
> 赞同：2
> 
> 时间：2008-10-01T10:57:44.663
> 
> 标签：c++

我从互联网上下载了一些示例代码，但是当我编译它时遇到了一些麻烦。我的编译器告诉我：comdef.h：没有这样的文件或目录。

我在互联网上搜索了一下，但我找不到其他有同样问题的人，我不知道从哪里可以获得这个头文件。

我将代码块与 GNU GCC 编译器一起使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T11:04:50.683

该文件可用于 Visual Studio（不确定您是否必须安装 Platform SDK）。您可以从 Web 获得[comdef.h](http://doc.ddart.net/msdn/header/include/comdef.h.html)，但肯定会遇到一些麻烦，以便将其与您的源代码一起编译。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T11:15:00.097

正如其他海报所说，`comdef.h`带有Visual C++。它补充了 VC 特定的内置 COM 支持。既然您说您使用的是 GCC，您可能必须调整您的代码以使用“低级 COM”，因为 GCC 没有 VC 所具有的那种内置 COM 支持（具体来说，`#import`用于导入类型库到方便的包装类）。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-01T11:02:16.570

安装 Microsoft 平台 SDK 后，该文件应该可用。虽然不知道它与 GNU GCC 的工作情况如何。

[http://www.microsoft.com/msdownload/platformsdk/sdkupdate/](http://www.microsoft.com/msdownload/platformsdk/sdkupdate/)

# sql - 如何根据列的内容在 T-SQL 中输出布尔值？

> ID：157114
> 
> 赞同：55
> 
> 时间：2008-10-01T11:02:13.653
> 
> 标签：sql, sql-server-2000

我对不同表的列进行了抽象，并对它们进行了预过滤和预排序。有一列的内容我不关心，但我需要知道内容是否为空。因此，如果此指定列的值**不为 null**，则我的视图应将别名传递为“ *true ”，如果值为***null ，则应将别名传递为“** *false* ” 。

 *****如何使用 T-SQL 选择这样的布尔值？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-10-01T11:07:45.077

您必须为此使用**CASE**语句：

```
SELECT CASE WHEN columnName IS NULL THEN 'false' ELSE 'true' END FROM tableName; 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-06-17T11:55:06.403

或者你可以这样做：

```
 SELECT RealColumn, CAST(0 AS bit) AS FakeBitColumn FROM tblTable 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-02-05T02:41:28.230

如果您需要输出为布尔值

```
CAST(CASE WHEN colName IS NULL THEN 0  ELSE 1   END as BIT) aIsBooked 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-01T11:11:56.687

对于视图中的列，您可以使用类似

```
CASE WHEN ColumnName is not null THEN 'True' ELSE 'False' END 
```

或在声明中

```
SELECT 
s.ID,
s.[Name],
CASE WHEN s.AchievedDate is not null THEN 'True' ELSE 'False' END [IsAchieved]
FROM Schools s 
```

或用于以后的进一步处理，我会亲自使用

```
SELECT 
s.ID,
s.[Name],
CASE WHEN s.AchievedDate is not null THEN 1 ELSE 0 END [IsAchieved]
FROM Schools s 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-05-31T00:23:37.943

我有一个类似的问题，我希望视图根据实际列是否为空来返回布尔列类型。我创建了一个用户定义的函数，如下所示：

```
CREATE FUNCTION IsDatePopulated(@DateColumn as datetime)
RETURNS bit
AS
BEGIN
    DECLARE @ReturnBit bit;

    SELECT @ReturnBit = 
        CASE WHEN @DateColumn IS NULL 
            THEN 0 
            ELSE 1 
        END

    RETURN @ReturnBit
END 
```

然后我创建的视图返回一个位列，而不是一个整数。

```
CREATE VIEW testView
AS
    SELECT dbo.IsDatePopulated(DateDeleted) as [IsDeleted] 
    FROM Company 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-02-03T20:42:28.077

您要求布尔值，我们在 t-sql 中将其称为位。

其他答案要么给你一个 varchar 'true' 和 'false' 或 1 和 0。'true' 和 'false' 显然是 varchar，而不是布尔值。我相信 1 和 0 会被转换为整数，但肯定不是一点点。这可能看起来很挑剔，但类型很重要。

要获得实际的位值，您需要将输出显式转换为：

```
select case when tableName.columnName IS NULL then cast(0 as bit) else cast(1
as bit) END as ColumnLabel from tableName 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-07-17T16:09:14.090

我认为这比其他解决方案稍微简单一些：

SELECT Cast(ISNULL([column name], 0) AS BIT) AS IsWhatever

# python - Tkinter 应用程序中的日期更改通知 (win32)

> ID：157116
> 
> 赞同：1
> 
> 时间：2008-10-01T11:02:43.620
> 
> 标签：python, windows, events, tkinter

有谁知道是否可以（如果可以，如何）将事件（MS Windows 上的 Python + Tkinter）绑定到系统日期更改？

我知道我可以不时检查 .after 事件；我在问我是否可以在系统日期/时间更改时以某种方式触发事件，无论是自动（例如夏令时）还是手动。

MS Windows 将此类事件发送到应用程序，而 Tkinter 确实收到了它们；我知道，因为如果我有一个 .after 计时器等待并且我在计时器到期后设置日期/时间，计时器事件会立即触发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T22:21:02.930

> 我知道，因为如果我有一个 .after 计时器等待并且我在计时器到期后设置日期/时间，计时器事件会立即触发。

这可能只是意味着 Tkinter（或 Tk）正在轮询系统时钟作为事件循环的一部分，以确定何时运行计时器。

如果您使用的是 Windows，Mark Hammond 的书中指出，您可以使用 win32evtlogutil 模块来响应 Windows 事件日志中的更改。基本上它是这样工作的：

```
import win32evtlogutil
def onEvent(record):
  # Do something with the event log record
win32evtlogutil.FeedEventLogRecords(onEvent) 
```

但是您需要获取有关事件记录结构的文档（我不想输入整章，抱歉 :-)）。另外我不知道事件日志中是否出现日期更改。

但是，真的，只轮询系统时钟就这么糟糕吗？这似乎是最简单的，我认为它不会减慢你的速度。

（最后，评论：我不知道你的国家，但在新西兰，夏令时不涉及日期更改；只有时间更改（从凌晨 2 点到凌晨 3 点，反之亦然））

# asp.net - 在会话中找不到我刚刚放在那里的东西（但只是有时）

> ID：157117
> 
> 赞同：1
> 
> 时间：2008-10-01T11:03:08.487
> 
> 标签：asp.net, session

我们的服务器*偶尔*会出现一个奇怪的问题。它通常发生在我们的一个或多个 Web 应用程序升级时。调试问题让我走到了这一步……

在处理请求期间：

*   在 ASP.NET 应用程序中，我们将一个对象放入会话中
*   在稍后运行的代码（相同的请求）中，我们查找相同的会话值。**它是空的！**

所以看起来会话服务不起作用，对吧？该代码每天运行数百次，在开发环境或生产环境中从未失败，仅与升级 Web 服务器上的 Web 应用程序有关。

奇怪的是：我们也没有真正喜欢解决问题的适当方法。IIS 重置、ASP.NET 状态服务器停止/启动、web.config 编辑，甚至服务器重新启动都使用了所有 bin - 通常需要组合来修复它 + 加上大量的咒骂和拉扯。而且在大多数情况下，它不会立即修复，但可能在第三次 IIS 重置或其他任何情况*后*两三分钟。（所以它可能毕竟不是修复它的原因。）

我要疯了。任何想法可能是什么问题？是微软的bug吗？

更多信息：

*   我们在 .NET 2.0 下运行
*   我们正在使用 ASP.NET 状态服务
*   访问会话变量并返回 null 的代码位于 ASP.NET 应用程序引用的程序集中。它使用 HttpContect.Current 来获取会话

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T11:29:52.353

HttpContext.Items 仅在请求的生命周期内可用，而不是在整个会话期间可用，因此需要考虑。

要回答原来的问题，

1.  当您将项目添加到会话时，您可以在下一行成功检索它吗？

2.  它是特定于服务器的吗？即一台服务器可以看到会话中的值，但不能看到另一台服务器？

3.  尝试访问变量的 dll 是否存在平台目标差异，例如 .net 1.1 与 .net 2.0？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T11:09:11.780

您可以考虑不使用会话变量吗？

如果您需要同一会话中的数据，则可以使用 HttpContext.Items ，它比使用会话变量轻得多。

回答您的问题：当您第一次访问会话时，可能尚未创建会话。如果不存在，它将抛出异常。

检查

```
If Not IsNothing(Context.Session) Then
    'do something
end if 
```

# c# - 我可以用派生类型覆盖吗？

> ID：157119
> 
> 赞同：43
> 
> 时间：2008-10-01T11:03:24.400
> 
> 标签：c#, .net, inheritance, covariance

据我所知，在 C# 2.0 中无法执行以下操作

```
public class Father
{
    public virtual Father SomePropertyName
    {
        get
        {
            return this;
        }
    }
}

public class Child : Father
{
    public override Child SomePropertyName
    {
        get
        {
            return this;
        }
    }
} 
```

我通过在派生类中将属性创建为“新”来解决该问题，但这当然不是多态的。

```
public new Child SomePropertyName 
```

2.0有解决方案吗？3.5 中解决此问题的任何功能如何？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-01T11:08:06.760

可以重新声明（新建），但不能同时重新声明和覆盖（同名）。一种选择是使用受保护的方法来隐藏细节 - 这允许同时进行多态性和隐藏：

```
public class Father
{
    public Father SomePropertyName
    {
        get {
            return SomePropertyImpl();
        }
    }
    protected virtual Father SomePropertyImpl()
    {
        // base-class version
    }
}

public class Child : Father
{
    public new Child SomePropertyName
    {
        get
        { // since we know our local SomePropertyImpl actually returns a Child
            return (Child)SomePropertyImpl();
        }
    }
    protected override Father SomePropertyImpl()
    {
        // do something different, might return a Child
        // but typed as Father for the return
    }
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-01T11:59:46.323

由于类型安全问题，这在任何 .NET 语言中都是不可能的。在类型安全的语言中，您必须为返回值提供协变，为参数提供逆变。拿这个代码：

```
class B {
    S Get();
    Set(S);
}
class D : B {
    T Get();
    Set(T);
} 
```

对于这些`Get`方法，协方差意味着它`T`必须是`S`或派生自`S`. 否则，如果您对`D`存储在变量 typed 中的类型对象的引用`B`，当您调用时，`B.Get()`您将不会获得可表示为`S`back 的对象——这会破坏类型系统。

对于这些`Set`方法，逆变意味着`T`必须是`S`或`S`派生自的类型。否则，如果您对`D`存储在变量 typed 中的类型对象的引用`B`，当您调用`B.Set(X)`where `X`is of type`S`但不是 type`T`时，`D::Set(T)`将得到一个它不期望的类型的对象。

在 C# 中，有一个有意识的决定，即在重载属性时不允许更改类型，即使它们只有一个 getter/setter 对，因为否则它会产生非常不一致的行为（*“你的意思是，我可以在一个带有 getter，但不是一个同时带有 getter 和 setter 的？为什么不呢？！？“* - 匿名交替宇宙新手）。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-01T11:09:21.577

不，但您可以在 2 及更高版本中使用泛型：

```
public class MyClass<T> where T: Person
{
    public virtual T SomePropertyName
    {
        get
        {
            return  ...;
        }
    }
} 
```

那么父亲和孩子是同一类的通用版本

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-01T11:08:21.500

来自[维基百科](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)#C.23)：

> 在 C# 编程语言中，该语言的 2.0 版中添加了对委托的返回类型协变和参数逆变的支持。方法覆盖既不支持协变也不支持逆变。

但是，它没有明确说明属性的协方差。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2021-08-02T19:36:08.990

# 现代答案

从**C# 9**开始，[支持返回类型协变](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/covariant-returns)。这是从该链接复制的基本示例：

```
class Compilation ...
{
    public virtual Compilation WithOptions(Options options)...
}

class CSharpCompilation : Compilation
{
    public override CSharpCompilation WithOptions(Options options)...
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-01T11:18:15.377

您可以为父亲和孩子创建一个公共接口并返回该接口的类型。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-09T23:55:35.603

这是我能来的最接近的（到目前为止）：

```
public sealed class JustFather : Father<JustFather> {}

public class Father<T> where T : Father<T>
{ 
    public virtual T SomePropertyName
    { get { return (T) this; }
    }
}

public class Child : Father<Child>
{ 
    public override Child SomePropertyName
    { get { return  this; }
    }
} 
```

如果没有`JustFather`该类，您将无法实例化 a `Father<T>`，除非它是其他派生类型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-01T11:06:28.167

不，C# 不支持这个想法（它被称为“返回类型协方差”）。但是，您可以这样做：

```
public class FatherProp
{
}

public class ChildProp: FatherProp
{
}

public class Father
{
    public virtual FatherProp SomePropertyName
    {
        get
        {
            return new FatherProp();
        }
    }
}

public class Child : Father
{
    public override FatherProp SomePropertyName
    {
        get
        {
            // override to return a derived type instead
            return new ChildProp();
        }
    }
} 
```

即使用基类定义的契约，但返回派生类型。我制作了一个更详细的示例以使这一点更清楚 - 再次返回“this”不会改变任何事情。

可以（但很麻烦）测试返回的对象的实际类型（即“如果 someObject 是 ChildProp”），但最好在其上调用一个对其类型执行正确操作的虚拟方法。

基类虚方法（在本例中为虚拟属性）不仅有一个实现，而且还定义了一个约定：如果子类满足这个约定，它可以提供 SomePropertyName 的不同实现（即 SomePropertyName 返回一个类型为“父亲道具”）。返回从“FatherProp”派生的“ChildProp”类型的对象符合本合同。但是您不能更改“子”中的合同 - 该合同适用于“父亲”的所有后代。

如果您退后一步，看看您的更广泛的设计，您可能还想考虑 C# 工具包中的其他语言结构 - 泛型或接口。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-01T11:56:11.853

> 不，C# 不支持这个想法（它被称为“返回类型协方差”）。
> 
> 来自维基百科：
> 
> 在 C# 编程语言中，该语言的 2.0 版中添加了对委托的返回类型协变和参数逆变的支持。方法覆盖既不支持协变也不支持逆变。
> 
> 可以重新声明（新建），但不能同时重新声明和覆盖（同名）。一种选择是使用受保护的方法来隐藏细节 - 这允许同时进行多态性和隐藏：

最好的解决方案是使用泛型：

```
public class MyClass<T> where T: Person
{
   public virtual T SomePropertyNameA
   {        
      get { return  ...; }    
   }
}//Then the Father and Child are generic versions of the same class 
```

# java - 中止从 servlet 上传以限制文件大小

> ID：157132
> 
> 赞同：5
> 
> 时间：2008-10-01T11:07:21.863
> 
> 标签：java, http, servlets, upload

我想限制可以上传到应用程序的文件的大小。为此，我想在上传的文件大小超过限制时从服务器端中止上传过程。

有没有办法在不等待 HTTP 请求完成的情况下从服务器端中止上传过程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-31T22:34:40.083

对于 JavaEE 6 / Servlet 3.0，首选的方法是在您的 servlet 上使用[@MultipartConfig 注释](http://docs.oracle.com/javaee/6/tutorial/doc/gmhal.html)，如下所示：

```
@MultipartConfig(location="/tmp", fileSizeThreshold=1024*1024, 
    maxFileSize=1024*1024*5, maxRequestSize=1024*1024*5*5)
public class UploadFileServiceImpl extends HttpServlet ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T12:23:46.030

您可以执行以下操作（使用[Commons](http://commons.apache.org/fileupload/)库）：

```
 public class UploadFileServiceImpl extends HttpServlet
    {
        protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException
        {
            response.setContentType("text/plain");

            try
            {
                FileItem uploadItem = getFileItem(request);
                if (uploadItem == null)
                {
                        // ERROR
                }   

                // Add logic here
            }
            catch (Exception ex)
            {
                response.getWriter().write("Error: file upload failure: " + ex.getMessage());           
            }
        }

        private FileItem getFileItem(HttpServletRequest request) throws FileUploadException
        {
            DiskFileItemFactory factory = new DiskFileItemFactory();        

             // Add here your own limit         
             factory.setSizeThreshold(DiskFileItemFactory.DEFAULT_SIZE_THRESHOLD);

         ServletFileUpload upload = new ServletFileUpload(factory);

             // Add here your own limit
             upload.setSizeMax(DiskFileItemFactory.DEFAULT_SIZE_THRESHOLD);

            List<?> items = upload.parseRequest(request);
            Iterator<?> it = items.iterator();
            while (it.hasNext())
            {
                FileItem item = (FileItem) it.next();
                        // Search here for file item
                if (!item.isFormField() && 
                  // Check field name to get to file item  ... 
                {
                    return item;
                }
            }

            return null;
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T11:29:57.113

您可以尝试在 servlet 的 doPost() 方法中执行此操作

```
multi = new MultipartRequest(request, dirName, FILE_SIZE_LIMIT); 

if(submitButton.equals(multi.getParameter("Submit")))
{
    out.println("Files:");
    Enumeration files = multi.getFileNames();
    while (files.hasMoreElements()) {
    String name = (String)files.nextElement();
    String filename = multi.getFilesystemName(name);
    String type = multi.getContentType(name);
    File f = multi.getFile(name);
    if (f.length() > FILE_SIZE_LIMIT)
    {
        //show error message or
        //return;
        return;
    }
} 
```

这样您就不必等待完全处理您的 HttpRequest 并且可以将错误消息返回或显示回客户端。高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T16:23:22.960

您可以使用 apache commons fileupload 库，该库也允许限制文件大小。

[http://commons.apache.org/fileupload/](http://commons.apache.org/fileupload/)

# .net - Windows Vista下自定义DataGridView列不接受输入的小数分隔符

> ID：157144
> 
> 赞同：0
> 
> 时间：2008-10-01T11:10:11.107
> 
> 标签：.net, datagridview, windows-vista, controls, numericupdown

对于一个项目，我构建了一个包含 NumericUpDown 控件的自定义 DataGridView 列。它的实现类似于[微软的建议](http://msdn.microsoft.com/en-us/library/aa730881(VS.80).aspx)

该列在 Windows XP 下运行良好。它接受输入的数字和小数分隔符。在 Windows Vista 下，我有一个奇怪的问题，即控件只接受由数字小键盘输入的小数分隔符，而不接受来自键盘主块的小数分隔符。

我必须补充一点，我在 Windows Vista 下使用德语（瑞士）文化设置，并且激活了德语（瑞士）键盘布局。瑞士的小数分隔符是 .

有人对原因有想法，也许有解决方案？非常感谢你！

迈克尔

**编辑：** 我找到了解决问题的方法。

1.  稍微澄清一下情况。我使用的 NumericUpDown 控件实现了 IDataGridViewEditingControl 并继承自 NumericUpDown。由于 IDataGridViewEditingControl，我实现了 EditingControlWantsInputKey 方法。而在执行这个方法的过程中，我发现了我的错误或者出了什么问题。

2.  在该方法中，我检查了输入的键并决定控件是否必须处理它。但是对于小数点分隔符，我只期望*Keys.Decimal*。在我的特殊（错误）情况下，密钥无法匹配。缺少的是也寻找*Keys.OemPeriod*。这就是解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-01T11:18:53.193

您能否粘贴您的 OnKeyDown 和/或 OnKeyPress 代码？至少是相关的密钥过滤代码。这将更容易发现任何问题。

顺便说一句，我通常同时使用英式英语和巴西葡萄牙语键盘，所以我遇到了这些问题。那种迫使你成为本地化专家:)

**编辑**：哦，对不起，只是重新阅读并理解您正在使用库存 NumericUpDown 控件。你能指出我的列代码，以便我可以在这里尝试吗？可能没有为控件设置语言环境，您必须在某些时候手动设置。

# c# - 部分 .csproj 文件

> ID：157149
> 
> 赞同：16
> 
> 时间：2008-10-01T11:12:33.130
> 
> 标签：c#, csproj

是否可以将 .csproj 中的信息拆分到多个文件中？有点像该`partial class`功能的项目版本。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-01T11:23:34.693

您不能拥有多个主 csproj。但是因为 csproj 的底层布线是使用 msbuild 完成的，所以您可以简单地拥有多个相互导入的部分 csproj。解决方案文件将看到*派生*最多的csproj。

**项目1.csproj**

```
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    ....
</Project> 
```

**项目2.csproj**

```
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Import Project="project1.csproj" />
    ...
</Project> 
```

**project.csproj** - 这是解决方案文件引用的主要项目。

```
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Import Project="project2.csproj" />
    ...
</Project> 
```

底线是，使用 msbuild**导入**功能，您可以拥有部分 csproj 文件，其中每个文件都包含主项目（在我的示例中为 project.csproj）将使用的定义。

* * *

当您打开更改的解决方案或项目文件时，Visual Studio 将显示***项目*****对话框的安全警告。***选择选项**Load Project Normal**并按**OK**。稍后再次打开解决方案时，将不会显示警告，因为**通常加载项目**的配置存储在**suo**文件中。*

 ** * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-01T11:18:17.297

是的，您可以将信息拆分到多个文件中。您可以使用[Import Element (MSBuild)](http://msdn.microsoft.com/en-us/library/92x05xfs.aspx)。

请注意，如果您尝试打开包含其他项目文件的项目文件，Visual Studio 会给您带来[烦人的安全警告。](http://msdn.microsoft.com/en-us/library/ms228217.aspx)

来自 MSDN 的有用链接：

[如何：在多个项目文件中使用相同的目标](http://msdn.microsoft.com/en-us/library/ms171464.aspx)

请注意，外部文件按约定具有**.targets扩展名。**

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-01T11:15:17.740

好吧，您可以将多个项目组合成一个大型解决方案，但我认为这并不是您的想法，因为在这种情况下，每个项目都必须是一个完整的项目。

# multithreading - 术语“输入同步调用”是什么意思？

> ID：157157
> 
> 赞同：0
> 
> 时间：2008-10-01T11:15:56.630
> 
> 标签：multithreading, apartments

我在一篇关于多线程公寓的文章中找到了这一点，但找不到“输入同步调用”的定义。（文章位于[http://msdn.microsoft.com/en-us/library/ms693421(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms693421(VS.85).aspx)）

如文章中所用 - 多线程公寓无法进行输入同步调用

什么是“输入同步”调用？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T11:46:45.560

看看这篇文章[在这里](http://msdn.microsoft.com/en-us/library/ms693770(VS.85).aspx)。

> 输入同步调用 - 当进行输入同步调用时，被调用的对象必须在让出控制之前完成调用。这有助于确保焦点管理正常工作并且用户输入的数据得到适当处理。这些调用由 COM 通过 Windows SendMessage 函数进行，无需进入模式循环。在处理输入同步调用时，被调用的对象不得调用任何可能产生控制的函数或方法（包括同步方法）。

# linux - 当文本行出现在文件中时如何使用 Bash

> ID：157163
> 
> 赞同：4
> 
> 时间：2008-10-01T11:17:54.113
> 
> 标签：linux, bash, grep

我想在日志文件中出现特定文本后立即运行命令。我如何在 Bash 中做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-01T11:19:40.727

使用命令

```
tail -f file.log | grep --line-buffered "my pattern" | while read line
do
  echo $line
done 
```

是这里`--line-buffered`的关键，否则读取会失败。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-01T11:33:48.537

仅使用`tail`：

```
tail -f file.log | while read line; do if [[ $line == *text* ]]; then
    mycommand
fi; done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T11:31:24.253

即使没有 GNU grep，这也应该可以工作：

```
tail -f -n 0 logfile.out | nawk '/pattern/ {system("echo do something here")}' 
```

编辑：添加了“-n 0”，以便只匹配新出现的文本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T12:51:33.637

您还可以查看`inotail`，一个替代品，仅在您感兴趣的文件发生更改时才`tail -f`使用`inotify`框架唤醒。通常`tail -f`只是在轮询之间休眠很短的时间，这是一种有效但不是非常有效的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T19:13:18.480

我喜欢matli的回答。Bruno De Fraine 的回答也很好，因为它只使用 shell ccommands，而不是其他程序（如 awk）。它存在整行必须匹配魔术字符串的问题。从作为要求的一部分的问题中不清楚。

我会稍微修改一下以处理原始问题中的“尽快”子句

```
logfile_generator | tee logfile.out | nawk '/pattern/ {system("echo do something here")}' 
```

其中 logfile_generator 是首先生成日志文件的程序。一旦找到魔术字符串，此修改就会执行“某事”。

# asp-classic - 带有经典 ASP 的 Websphere

> ID：157167
> 
> 赞同：0
> 
> 时间：2008-10-01T11:18:21.633
> 
> 标签：asp-classic, websphere

为经典 ASP 网站创建 Websphere Portlet 是否可行（或可能）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T12:12:40.737

Websphere 是基于 Java 的，但您可以使用 IFRAME 或 Ajax 混合任何 Web 内容以在 ASP 页面中注入 HTML。

实际的？我不这么认为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-04T15:33:45.300

可能，但您仍然需要为 Java Portlet 和 IIS ASP 应用程序提供单独的托管环境，即使在 IFrame 中调用也是如此。

# svn - 如何在 Subversion 中设置共享工作副本

> ID：157178
> 
> 赞同：11
> 
> 时间：2008-10-01T11:25:06.127
> 
> 标签：svn

我使用 Subversion 还是很新的。

是否有可能在网络可用共享 (c:\svn\projects\website) 上有一个工作副本，每个人（在这种情况下为 3 个使用）都可以签出和提交文件？我们不需要构建服务器，因为它是一个 asp 站点，并且设计人员习惯于在保存文件时立即获得结果。我可以尝试向他们展示如何在他们的机器上进行本地设置，但如果我们可以在开发服务器上共享文件并且仍然能够在有人完成后提交，那将是理想的。

一个简单的解决方案是让我们所有人都使用相同的颠覆用户名，这至少可以让我将文件置于版本控制之下。

但是是否可以从 svn 存储库中签出一个文件夹，但仍然需要每个人使用他们的用户/密码登录才能提交？

编辑：我正在尝试采用我们当前的工作流程，即使用 Frontpage Extensions 或 FTP 编辑网站的 LIVE 版本。并把它移到更好的地方。在这种情况下，我设置为镜像实时服务器的开发服务器上的实时站点副本，删除首页扩展访问。然后设计师仍然可以有相同的即时满足效果，但我不必担心他们正在编辑实时文件。即使在颠覆中使用共享用户/密码仍然是版本控制。这可能并不理想，如果设计师实际上是程序员，我会尝试让他们完全参与进来，但事实并非如此。在这种情况下，这是我能做的最好的事情，避免了巨大的学习曲线和停工。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-01T11:34:37.727

以我的经验，它开箱即用就可以了。在我的公司，我们已经使用此设置多年，并且没有遇到任何问题（除了共享工作副本的明显问题）。

但是，如果您需要网站的“实时”版本，您应该考虑拥有单独的工作副本和一个触发器（钩子）来更新提交时的共享位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T11:31:02.087

您不能签出工作副本，**工作副本**是用于已签出代码的术语。如果您要求多个开发人员同时使用同一组工作文件，那么您正在严重破坏拥有版本控制系统的主要用途之一，即允许您的开发人员独立地进行更改不为其他人破坏东西。

也就是说，如果你真的想这样做，你可以。使用 Linux 服务器，方法是让您的每个用户运行不同的 ssh 用户代理（对于我们使用[Pagent](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)的 Windows 机器），每个用户具有不同的 ssh 身份。然后让 svn 服务器将来自不同身份的 ssh 隧道识别为来自不同用户。不幸的是，我不知道如何在 Windows 中进行设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T12:09:23.943

您需要使用 svnserve（SVN 附带的轻量级 SVN 服务器）或 apache mod。

有了它，您可以像这样[配置权限](http://svnbook.red-bean.com/en/1.0/ch06s03.html)：

```
[general]
password-db = userfile
realm = example realm

# anonymous users can only read the repository
anon-access = read

# authenticated users can both read and write
auth-access = write 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-09T15:24:22.823

我知道这是一个旧线程，但我发现它是因为我正在尝试做同样的事情。

我不认为这个问题可以通过颠覆来解决，尽管我已经多次尝试过，而且我认为这种需求是完全合法的。

对我们来说反复出现的用例是在应用程序之外维护的复杂配置文件。

一个很好的例子可能是 apache httpd.conf 文件。它们很复杂，我们想要跟踪文件的更改。我们不希望每个人都使用“root”，因为这样我们就无法追踪谁做了什么。

Mercurial 可以这样做：

[Mercurial 多个提交者](http://mercurial.selenic.com/wiki/MultipleCommitters)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T11:28:05.697

工作副本旨在让每个用户拥有自己的副本。并且存储库是共享的。只有签出 WC 的人才能从其中提交更改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T11:29:44.303

如果你不想要服务器，也许你可以看看 subversion 以外的东西，比如分布式 VCS（Bzr、git 和 mercurial 现在很流行），或者你应该看看 subversion 托管服务。

不建议共享单个工作副本。这确实违背了版本控制的目的。请不要那样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T11:35:31.030

您应该拥有自己的 SVN 存储库，每个用户（使用自己的用户名和密码访问 SVN 存储库）都应该检查自己的工作副本。

通过拥有不同的 PC 用户帐户并让人们签出自己的帐户，甚至通过共享一个 PC 用户帐户和让人们签出到不同的工作文件夹。我不认为这特别整洁或好，如果一家公司现在买不起每个开发人员的 PC，那么它几乎不值得为之工作！

我建议：

1.  每个员工在自己的 PC 上都有自己的工作副本。

2.  应该有一个 ANT 或 Maven 或类似的构建脚本，允许开发人员从他们的工作副本构建和部署到开发 Web 服务器上，这样他们就可以看到它是如何的。这可能很简单，例如“将文件复制到此共享位置”。

3.  由于每个员工都有自己的 SVN 用户名/密码，因此您可以查看谁进行了哪些更改，并在他们离开公司时将其锁定。

4.  这可能会创建一个设计师必须遵循的流程，而不是您当前的无政府状态，但是如果他们中的任何一个需要半天以上的时间来获取 SVN 以及如何运行构建脚本以部署到开发 Web 服务器，那么你有更大的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-01T12:24:55.047

我认为你在卖空你的团队。非开发*人员可以*轻松学习使用 SVN，尤其是像乌龟这样的东西。如果您要经历设置 SVN 的麻烦，那么只需给每个人一个单独的登录名，让他们在自己的本地工作副本上工作。进行快速而肮脏的 CruiseControl 自动化构建以从 SVN 中提取以创建登台站点内容。只需多做一点工作，结果就会好得多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-05-27T17:13:17.220

我知道这是一个老问题/wiki，但我想到的解决方案如下。

问题可以重述如下：我们如何才能使用真正的源代码控制系统（如 SVN），并且仍然允许非技术设计师享受他们已经了解和喜爱的相同的保存-预览-保存-预览周期?

要点：

*   为了实现 SVN 的全部好处，每个用户都需要有自己的工作副本。就是那样子。

*   如果您的应用程序中仍然有经典的 ASP（不是 .NET），那么像 Cassini 这样的轻量级本地服务器将无法完成这项工作。

*   用户最好不必安装或学习使用像（公认简单的）乌龟这样的 SVN 客户端。

我的做法：

*   在 SVN 中为每个用户创建一个分支

*   在每个客户端上，为您的开发服务器上的用户特定工作目录提供一个映射驱动器。他们将使用 FrontPage、Expression、SharePoint 设计器或其他任何工具在此处进行更改。

*   在开发服务器上的 IIS 中，使用特定于用户的主机标头创建特定于用户的网站（例如，`alice.www.mysite.com`或）。`bob.www.mysite.com`他们将通过此 URL 浏览站点以查看他们的更改。这也允许他们在将其合并到主干之前向其他人展示他们的更改。

*   使用 CruiseControl.NET，为每个用户的分支提供检查、更新、添加和提交更改的任务。弄清楚如何做到这一点，以便每个用户只能看到自己的任务。

*   使用 CruiseControl.NET，创建一个将他们的更改合并到主干的任务

*   使用 CruiseControl.NET，创建一个任务，该任务将使用合并的更改更新真实的开发站点 (dev.www.mysite.com)。该站点将显示每个人的工作组合，并充当登台和调试区域。如果您使用的是 WAP，您将希望此任务也触发构建。

听起来步骤很多，但实际上非常简单。创建分支、映射驱动器、设置新的 IIS 站点并让它们发疯。

在幕后，这与为他们提供本地 IIS 安装并让他们在必要时使用 SVN 提交更改完全一样，就像开发人员所做的那样。不同之处在于他们的工作副本在服务器上，IIS/Cassini 不必在他们的机器上，他们将使用 Web 界面来执行 SVN 操作，如提交、更新等。

祝你好运！

# php - PHP 开发 - 很多（新手）问题

> ID：157192
> 
> 赞同：4
> 
> 时间：2008-10-01T11:31:48.963
> 
> 标签：php, ide

我是一名工科学生，本学期我将参加数据库和信息系统课程。我需要使用 PHP/PGSQL 生成使用数据库的网站/应用程序。我的问题是：

*   你会推荐哪个 IDE？
*   有没有人对新开发人员有好的提示和建议？
*   开发这个项目会帮助我（很多）参与该主题的一些“学术”方面，例如实体/关联模型等。是否有任何好的工具来帮助构建我的工作？

谢谢！

编辑：一些注意事项：

*   我忘了问最后一件事，我尝试安装 BitNami 的 WAPP Stack。有谁知道它有多好和/或可靠吗？
*   我实际上在 Windows Vista Business 下工作（新笔记本电脑 :S ）。您会出于任何特定原因推荐在 Linux 下进行开发吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-01T11:42:22.917

这可能是您职业生涯中唯一一次可以完全自由地选择要使用的工具，因此要充分利用它。学习一些经典的工具，这些工具将伴随你很长的路要走。

因此，与其使用可能会在整个职业生涯中完成的 IDE，不如尝试使用 vim/emacs 之类的老式编辑器。这里的一个优点是 IDE 不会隐藏让您的项目工作的所有细节，知道完整的技术堆栈总是一个加分项。

对于您将使用的任何技术，在深入了解实现细节之前尝试获得一个良好的广阔视野，因此对于 PHP，我建议掌握 XHTML、CSS 和 Javascript，包括像 jQuery 这样的库；对象关系映射（看看 Ruby on Rails、CakePHP、Django 和 SQL Alchemy）和各种平台上的模型视图控制器框架。

对于 PGSQL，除了规范化之外，还要尝试深入研究 information_schema 和事务隔离级别以及它们何时有用。

同样重要的是了解 HTTP 协议如何在低级别工作，以及如何使用 HTTP 构建高度可扩展的网站。

与其依赖工具，我会说只是创建一个关于上述主题的阅读列表，这会自动构建你的思维过程来考虑这些问题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-01T12:45:40.957

*   你会推荐哪个 IDE？

任何支持远程调试的东西。如果您可以实际单步执行您的代码，您将节省自己的时间并更快地学习。令我惊讶的是，越来越多的人不使用好的 PHP 调试工具。工具就在那里，不使用它们是疯狂的。FWIW 我一直是[Activestate Komodo](https://www.activestate.com/)的忠实拥护者——很棒的产品。

*   有没有人对新开发人员有好的提示和建议？

    1.  得到测试感染。它将在未来对您有利，并迫使您正确思考设计问题。其实好处多，坏处少。

    2.  学习重构，让它成为你开发“节奏”的一部分。

    3.  与此相关的是：提前思考，但不要提前计划。请注意，您正在编写的内容可能需要在类层次结构中冒泡，以便更通用，但在您需要之前不要实际冒泡。

*   开发这个项目会帮助我（很多）参与该主题的一些“学术”方面，例如实体/关联模型等。是否有任何好的工具来帮助构建我的工作？

了解设计模式并应用您从中学到的经验。不要以“PHP4”方式编程。

*   我忘了问最后一件事，我尝试安装 BitNami 的 WAPP Stack。有谁知道它有多好和/或可靠吗？

不知道，但是如果您有时间，我会避免使用 WAMPP 之类的预构建堆栈。了解这些部分如何组合在一起很重要。然而，如果你在 Windows 上运行，你可能没有时间，你的精力可以更好地集中在编写好的代码上，而不是研究如何安装 PHP、PostgreSQL 和 Apache。

*   我实际上在 Windows Vista Business 下工作（新笔记本电脑 :S ）。您会出于任何特定原因推荐在 Linux 下进行开发吗？

是的，我会。假设您在 Linux 上进行部署（如果您在 Windows 上进行部署，我会问自己一些严肃的问题！），那么在相同的环境中进行开发是非常有用的。出于这个原因，我在 2005 年转行，这是我在开发方面所做的最有用的事情之一。但是，如果您是*nix 新手并且时间紧迫，可能会坚持您所知道的。如果您有时间尝试一下，您会发现使用一个优秀的现代 Linux 桌面发行版很容易启动和运行，并且开发工作将会顺利进行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-01T11:46:31.020

*   IDE：我推荐 PSPad，因为它具有出色的 FTP 功能和 PHP 语法高亮
*   提示：浏览 mysql 或您正在使用的任何数据库的 PHP 文档，PHP 文档是您学习它的最佳工具。
*   提示：保持数据简单，它总是对其他东西可变，例如，使用 unixtimestamp 存储时间，因为 php 具有强大的 date() 函数功能，可以将其转换为您想要的任何内容。

编辑以添加 linux vs windows 提示

*   我在 Windows 和 Linux 机器上都进行了开发，并且我在 Linux 和 Windows 上都有一个 PHP 服务器，对于我的开发类型（CMS 和那些 CMS 上的网站），我更喜欢在 Windows 上开发并在 Linux 上托管。这是由于 Linux 的稳定性和我可以在 Windows 上可靠使用的工具（主要是 Photoshop）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-01T11:38:01.320

我会推荐一个纯文本编辑器而不是 IDE。您应该使用带有语法突出显示的一种，例如 Notepad++。

尖端：

*   使用火狐
*   玩一些测试数据库。教授或学习数据库时犯的最大错误是只关注理论而没有实际数据。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-01T11:39:41.677

一个好的 PHP IDE 是[PDT](http://www.eclipse.org/pdt/)，一个 Eclipse 插件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T11:36:57.267

我的建议：

*   没有 IDE - 只是一个基本的语法高亮文本编辑器（我使用 jEdit）
*   了解 XSS 和 SQL 注入
*   PHP 下有很多很好的[框架可以提供帮助](http://www.phpframeworks.com/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-27T14:02:58.067

我向您推荐[netbeans](http://netbeans.com) .它是免费的。它适用于所有平台，主要适用于编辑 php、jsp、java、css、html，... 适用于 SVN、mercurial，此外，您可以轻松地将其与[kenai.com](http://kenai.com)集成...

它有助于 IntelliSense 类型的弹出。

相信我，我将它用于 php 开发，它是我能找到的最适合的 ide...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-01T11:36:31.090

*   IDE：[广达+](http://quanta.kdewebdev.org/)
*   提示：不要在模板语言（PHP）上使用模板库
*   提示：MVC 是设计和心态问题，而不是库

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-01T12:14:09.893

Windows 上最好的编辑器是 Notepad++ 和 Eclipse。两者都不错，但无法与 Kate 和 Quanta+ 相提并论。就这一点，我会放弃窗户。此外，在同一个系统上同时拥有开发环境和真实测试环境也很不错，即使大多数 OSS 都可以在 Windows 上使用，它们也始终是圆孔上的方钉。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-01T12:57:37.073

ide: vim + (firefox+firebug) 使用 ide 和 php，在大多数情况下，是矫枉过正

其他工具：pgadmin3 设计您的表，以便它们易于查询

如果你有一个额外的盒子，如果你想试试的话，我会把 linux 放在上面。Ubuntu 是一个很好的入门发行版，具有简单的 LAMP 设置过程。不过，我不会对那台 vista 笔记本电脑做任何事情，因为它可以让你在 IE 和 firefox 中进行测试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T00:36:55.450

你看过[Delphi for PHP](http://www.codegear.com/products/delphi/php) (< [http://www.codegear.com/products/delphi/php](http://www.codegear.com/products/delphi/php) >) 吗？

Microsoft 的 Joe Stagner 非常喜欢[用于 PHP 的 Delphi](http://www.codegear.com/products/delphi/php)。
他在这里说：[“[Delphi for PHP] 2.0 是真正的交易，我喜欢它！”](http://www.misfitgeek.com/Delphi+For+PHP+Version+20.aspx)

# java - 在 Java 中创建一个 .eml（电子邮件）文件

> ID：157195
> 
> 赞同：24
> 
> 时间：2008-10-01T11:33:11.660
> 
> 标签：java, email, outlook, eml

有人知道该怎么做吗？我得到了电子邮件的所有信息（正文、主题、发件人、收件人、抄送、密送），需要从中生成一个 .eml 文件。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-30T10:02:48.380

您可以使用以下代码创建 eml 文件。它适用于雷鸟，可能适用于其他电子邮件客户端：

```
public static void createMessage(String to, String from, String subject, String body, List<File> attachments) {
    try {
        Message message = new MimeMessage(Session.getInstance(System.getProperties()));
        message.setFrom(new InternetAddress(from));
        message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(to));
        message.setSubject(subject);
        // create the message part 
        MimeBodyPart content = new MimeBodyPart();
        // fill message
        content.setText(body);
        Multipart multipart = new MimeMultipart();
        multipart.addBodyPart(content);
        // add attachments
        for(File file : attachments) {
            MimeBodyPart attachment = new MimeBodyPart();
            DataSource source = new FileDataSource(file);
            attachment.setDataHandler(new DataHandler(source));
            attachment.setFileName(file.getName());
            multipart.addBodyPart(attachment);
        }
        // integration
        message.setContent(multipart);
        // store file
        message.writeTo(new FileOutputStream(new File("c:/mail.eml")));
    } catch (MessagingException ex) {
        Logger.getLogger(Mailkit.class.getName()).log(Level.SEVERE, null, ex);
    } catch (IOException ex) {
        Logger.getLogger(Mailkit.class.getName()).log(Level.SEVERE, null, ex);
    }
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-01T13:07:02.637

您可以构造[`javax.mail.Message`](https://javaee-spec.java.net/nonav/javadocs/javax/mail/internet/MimeMessage.html)对象（或者已经从邮件服务器构造了它），然后您可以使用[`writeTo()`](https://javaee-spec.java.net/nonav/javadocs/javax/mail/internet/MimeMessage.html#writeTo%28java.io.OutputStream%29)方法将其保存到文件中。有关更多信息，请参阅[JavaMail API](http://www.oracle.com/technetwork/java/javamail/index.html)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-01T11:48:49.593

EML 文件只是纯文本文件。标题与正文用空行分隔。标头如下所示：

```
From: "DR CLEMENT OKON" <drclement@nigerianspam.com>
To: "You" <you@yourdomain.com>
Subject: REQUEST FOR URGENT BUSINESS RELATIONSHIP 
Date: Tue, 30 Sep 2008 09:42:47 -0400 
```

有关更多信息，官方规范是[RFC 2822](http://www.faqs.org/rfcs/rfc2822.html)。它实际上并不像某些 RFC 那样难以阅读。

编辑：当我说“纯文本”时，我应该想一想。我真正的意思是纯 ASCII - 而不是 8 位“扩展 ASCII” - 最多字符 127。如果你想要超过 7 位，你需要某种编码，事情会变得复杂。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T11:50:05.020

查看一个典型的 EML 文件，它看起来像是发送到服务器的文本通信的原始转储。所以它是一个包含邮件标题和正文的文本文件。要在 EML 文件中以正确格式获取附件、不同视图等，您需要对正文及其部分进行 MIME 编码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-13T00:10:27.160

如果你想添加 HTML Stuff，你必须添加

```
content.setHeader("Content-Type", "text/html"); 
```

（正如马可苏拉所说）但也要改变

```
message.setContent(multipart); 
```

到

```
message.setContent(multipart,"text/html"); 
```

# java - 双重检查锁定文章

> ID：157198
> 
> 赞同：11
> 
> 时间：2008-10-01T11:34:04.810
> 
> 标签：java, synchronization, locking, double-checked-locking

我正在阅读[这篇](http://www.ibm.com/developerworks/java/library/j-dcl.html)关于“双重检查锁定”的文章，并且在文章的主题之外，我想知道为什么在文章的某些地方作者使用了下一个成语：

> 清单 7\. 尝试解决乱序写入问题
> 
> ```
> public static Singleton getInstance()  
> {
>     if (instance == null)
>     {
>         synchronized(Singleton.class) {      //1
>             Singleton inst = instance;         //2
>             if (inst == null)
>             {
>                 synchronized(Singleton.class) {  //3
>                     inst = new Singleton();        //4
>                 }
>                 instance = inst;                 //5
>             }
>         }
>     }
>     return instance;
> } 
> ```

我的问题是：有什么理由用同一个锁同步两次代码吗？这有什么目的吗？

提前谢谢了。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-01T11:41:26.570

锁定两次的目的是*为了*防止乱序写入。内存模型指定了可能发生重新排序的位置，部分是根据锁。锁确保在“instance = inst;”之后不会出现任何写入（包括单例构造函数中的任何写入）。线。

但是，要更深入地了解该主题，我建议您[阅读 Bill Pugh 的文章](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)。然后永远不要尝试它:)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-01T12:38:00.427

这篇文章指的是 5.0 之前的 Java 内存模型 (JMM)。在该模型下，将同步块强制写入主存储器。因此，这似乎是在尝试确保 Singleton 对象在对其的引用之前被推出。但是，它并不能很好地工作，因为对实例的写入可以向上移动到块中 - 蟑螂汽车旅馆。

但是，5.0 之前的模型从未正确实施。1.4 应该遵循 5.0 的模型。类是懒惰初始化的，所以你不妨写

```
public static final Singleton instance = new Singleton(); 
```

或者更好的是，不要使用单例，因为它们是邪恶的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-01T12:07:36.727

Jon Skeet 是对的：阅读[Bill Pugh 的](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)文章。汉斯使用的成语是*行不通的精确形式，不*应该使用。

这是不安全的：

```
private static Singleton instance;

public static Singleton getInstance() {
  if (instance == null) {
    synchronized(Singleton.class) {
      if (instance == null) {
        instance = new Singleton();
      }
    }
  }
  return instance;
} 
```

这也是不安全的：

```
public static Singleton getInstance()  
{
    if (instance == null)
    {
        synchronized(Singleton.class) {      //1
            Singleton inst = instance;         //2
            if (inst == null)
            {
                synchronized(Singleton.class) {  //3
                    inst = new Singleton();        //4
                }
                instance = inst;                 //5
            }
        }
    }
    return instance;
} 
```

永远不要这样做。

相反，同步整个方法：

```
 public static synchronized Singleton getInstance() {
      if (instance == null) {
        instance = new Singleton();
      }
      return instance;
    } 
```

除非您每秒无数次地检索此对象，否则实际上对性能的影响可以忽略不计。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-01T15:44:39.933

我在这里介绍了很多：

[http://tech.puredanger.com/2007/06/15/double-checked-locking/](http://tech.puredanger.com/2007/06/15/double-checked-locking/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T13:48:37.233

遵循[约翰斯基特](https://stackoverflow.com/users/22656/jon-skeet)建议：

> 然而，为了更深入地研究这个主题，我推荐 Bill Pugh 的文章。然后永远不要尝试它:)

这是第二个同步块的关键：

> 此代码将 Helper 对象的构造置于内部同步块中。这里的直观想法是在释放同步的点应该有一个内存屏障，这应该防止重新排序 Helper 对象的初始化和对字段助手的分配。

所以基本上，对于内部同步块，我们试图“欺骗”JMM 在同步块内创建实例，以强制 JMM 在同步块完成之前执行该分配。但这里的问题是 JMM 正在引导我们，并且正在将同步块之前的分配移动到同步块内，将我们的问题移回开始。

这是我从那些文章中了解到的，非常有趣，再次感谢您的回复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T11:51:20.120

好吧，但是文章说

> 由于内存模型的当前定义，清单 7 中的代码不起作用。Java 语言规范 (JLS) 要求不要将同步块中的代码移出同步块。但是，它并不是说不在同步块中的代码不能移动到同步块中。

而且似乎 JVM 对 ASM 中的“伪代码”进行了下一次转换：

> ```
> public static Singleton getInstance()
> {
>   if (instance == null)
>   {
>     synchronized(Singleton.class) {      //1
>       Singleton inst = instance;         //2
>       if (inst == null)
>       {
>         synchronized(Singleton.class) {  //3
>           //inst = new Singleton();      //4
>           instance = new Singleton();               
>         }
>         //instance = inst;               //5
>       }
>     }
>   }
>   return instance;
> } 
> ```

到目前为止，“instance=inst”之后的不写点还没有实现？

我现在将阅读这篇文章，感谢您的链接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T12:44:03.720

从 Java 5 开始，您可以通过声明 volatile 字段来进行双重检查锁定工作。

有关完整说明，请参阅[http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-01T13:22:48.307

关于这个成语，有一篇非常可取和澄清的文章：

[http://www.javaworld.com/javaworld/jw-02-2001/jw-0209-double.html?page=1](http://www.javaworld.com/javaworld/jw-02-2001/jw-0209-double.html?page=1)

另一方面，我认为 dhighwayman.myopenid 的意思是为什么作者将一个引用同一类的同步块 (synchronized(Singleton.class)) 放在另一个引用同一类的同步块中。它可能会在该块中创建一个新实例（Singleton inst = instance;）时发生，并且为了保证它是线程安全的，有必要编写另一个同步的。

否则，我看不出任何意义。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-27T16:52:43.673

[请参阅有关Java 内存模型](http://www.youtube.com/watch?v=1FX4zco0ziY)的 Google 技术讲座，以获得对 JMM 更精细点的非常好的介绍。由于这里缺少它，我还想指出 Jeremy Mansons 的博客['Java Concurrency'](http://jeremymanson.blogspot.com/)尤其是。关于[双重检查锁定](http://jeremymanson.blogspot.com/2008/05/double-checked-locking.html)的帖子（Java 世界中的任何人似乎都有关于此的文章 :)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-25T11:32:13.590

对于 Java 5 和更好的版本，实际上有一个双重检查变体，它比同步整个访问器更好。[双重检查锁定声明](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)中也提到了这一点：

```
class Foo {
    private volatile Helper helper = null;
    public Helper getHelper() {
        if (helper == null) {
            synchronized(this) {
                if (helper == null)
                    helper = new Helper();
            }
        }
        return helper;
    }
} 
```

这里的关键区别是在变量声明中使用了**volatile** - 否则它不起作用，而且它在 Java 1.4 或更低版本中也不起作用。

# php - 如何通过php发送带有图形的电子邮件

> ID：157208
> 
> 赞同：4
> 
> 时间：2008-10-01T11:39:36.527
> 
> 标签：php, email, attachment

我想发送包含图形元素的 HTML 电子邮件。我不知道要在这封电子邮件中附加图形。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-01T11:56:13.070

您可能不想手动进行内联附件，使用[PHPMailer](http://phpmailer.codeworxtech.com/)之类的库要容易得多，而且更不容易出错。
它可以附加内联图像，或者如果你给它一些 HTML 代码，它会自己附加图像并修改代码以显示它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-01T19:02:58.380

你可以试试[Swift Mailer](http://www.swiftmailer.org/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-01T11:51:22.723

我不会在这里用一个平庸的解释让你厌烦，所以让我链接到 Sitepoint 上的这个很棒的教程，它用简单的英语向我解释了它！-[高级电子邮件-php](http://www.sitepoint.com/article/advanced-email-php/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-02T03:40:22.380

简短的版本是您可能最好创建 HTML 格式的消息，并使用 php 邮件函数的 header 参数。

```
 $headers = "From: sender@example.com\n" .
    "MIME-Version: 1.0\n" .
    "Content-type: text/html; charset=iso-8859-1";
 mail(to@example.com, 'subject line', 'your message text <strong>with HTML in it</strong>', $headers); 
```

Jimmy 引用的 sitepoint.com 文章对您的选择进行了出色而完整的描述。

# c++ - 开源分形图

> ID：157211
> 
> 赞同：5
> 
> 时间：2008-10-01T11:40:46.027
> 
> 标签：c++, python, open-source, maps, fractals

我有兴趣创建一个使用分形地图以获得更真实的地理环境的游戏。但是，我发现的唯一分形映射程序仅适用于 Windows，例如[Fractal Mapper](http://www.nbos.com/products/mapper/mapper.htm)。不用说，它们也不是开源的。

是否有可用的开源分形图创建器，最好是 Python 或 C/C++？理想情况下，我想要一些可以“插入”程序的东西，而不是独立的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-01T11:48:36.880

[Fracplanet](http://www.bottlenose.demon.co.uk/share/fracplanet/)可能有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-01T12:01:33.120

基本地形生成包括创建高度图（图像）并使用像素颜色作为高度进行渲染。因此，您可能会发现图像或纹理生成代码很有用。这是一个[很好的教程](http://www.gameprogrammer.com/fractal.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T20:15:15.570

对于地形方面，请查看[libnoise](http://libnoise.sourceforge.net/)。它是[为 Debian 打包的](http://packages.debian.org/stable/libnoise-dev)，并且具有出色的文档，其中有一章介绍[地形生成](http://libnoise.sourceforge.net/tutorials/tutorial3.html)和示例 C++ 代码。

当然，“地图”不仅仅是在高度场上添加一些颜色（例如[Fracplanet](http://www.bottlenose.demon.co.uk/share/fracplanet/)添加河流和湖泊）。你从这些方法中得到的那种地形实际上并不那么现实。大陆通常不会从海岸上升到岩石腹地，因此模拟大陆漂移、造山和侵蚀过程可能会有所帮助（或者，[假装它](http://libnoise.sourceforge.net/tutorials/tutorial5.html)）。然后，如果您想要植被或生命形式的人工制品（例如道路和城镇）填充您的地图，您可能需要查看元胞自动机或其他“人造生命”工具。最后，[虚拟地形项目](http://www.vterrain.org/)非常值得浏览以获取更多链接和想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T17:53:43.443

我强烈建议购买一份

[纹理和建模：一种程序方法](https://rads.stackoverflow.com/amzn/click/com/1558608486)

我看到它现在是第三版（我只有第二版），但它包含了很多关于使用程序纹理的有用文章，包括几章关于它们在分形地形中的使用。它也从对噪声算法的广泛讨论开始 - 所以你拥有从基础开始的一切。作者包括 Musgrave、Perlin 和 Worley，所以你真的不能做得更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T14:29:12.717

如果您想要真正逼真的地理，您可以使用 NASA 的[SRTM](http://www2.jpl.nasa.gov/srtm/)数据集，或许还可以结合[OpenStreetMap](http://www.openstreetmap.org)功能。:-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-07T22:56:10.040

一个非常简单的实现是使用中点位移分形，[http](http://en.wikipedia.org/wiki/Diamond-square_algorithm) ://en.wikipedia.org/wiki/Diamond-square_algorithm ，或者更复杂的 Diamond-Squares 算法。 [http://www.gameprogrammer.com/fractal.html#diamond](http://www.gameprogrammer.com/fractal.html#diamond)

这些算法类似于 Photoshop 中的“差异云”。

# language-agnostic - 如何更好地支持支持部门？

> ID：157219
> 
> 赞同：6
> 
> 时间：2008-10-01T11:45:42.783
> 
> 标签：language-agnostic

怀着世界上最好的意愿，您（和我）编写的任何软件都会存在某种缺陷。

作为一名开发人员，我能做些什么来让支持部门（一线、三线和开发）更容易诊断、解决和修复用户遇到的问题。

### 笔记

*   我期待的答案主要是技术性的，但我希望存在其他答案。
*   “不要在你的软件中发布错误”是一个很好的答案，但我已经知道了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-01T11:49:13.960

*   尽可能详细地记录您正在执行的环境（可能在启动时）。

*   为异常提供有意义的名称和消息。它们可能只出现在堆栈跟踪中，但这仍然非常有用。

*   分配一些时间为支持团队编写工具。他们几乎肯定会有超出您的用户或开发人员的需求。

*   与支持团队坐半天，看看他们必须做什么样的事情。观察任何重复的任务——他们甚至可能不再有意识地注意到重复。

*   定期与支持团队会面——确保他们永远不会怨恨你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-01T11:46:02.143

技术特点：

*   在桌面应用程序的错误对话框中，包括一个可单击的按钮，用于打开和发送电子邮件，并附加堆栈跟踪和日志，包括系统属性。
*   在 webapp 的错误屏幕上，报告包含纳秒和错误代码、pid 等的时间戳，以便可以搜索服务器日志。
*   允许在运行时动态更改日志级别。必须重新启动服务器才能做到这一点很痛苦。
*   尽可能详细地记录您正在执行的环境（可能在启动时）。

非技术：

*   在您的文档中提供已知问题部分。如果这是一个网页，那么这对应于来自您的错误跟踪器的分类错误列表。
*   根据您的受众，为您的问题跟踪公开某种界面。
*   同样，根据受众，为用户提供一些论坛以相互帮助。
*   可用性在问题成为问题之前解决了问题。明智的、非可怕的错误消息通常允许用户找到他们自己问题的解决方案。

过程：

*   看你的日志。对于服务器端产品，定期查看日志将是一个很好的预警信号，可以预警即将发生的问题。当您认为前方有麻烦时，请确保支持人员知道。
*   留出时间为支持部门编写工具。这些可以作为开发人员的调试工具开始，成为应用程序内部状态的窗口以获得支持，甚至成为未来版本的强大工具。
*   让开发人员有一些时间与支持团队一起度过；在支持电话中听取客户的意见，外出现场等。确保不允许开发人员承诺任何事情。完成此操作后向开发人员汇报 - 那里可能有特色想法。
*   酌情提供用户培训。阻抗不匹配会导致用户感知软件的问题，而不是用户对软件的心理模型。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-01T13:00:02.310

如果至少有一部分应用程序在服务器上运行，请确保监视日志以查找错误。

当我们第一次实现每天的脚本来查找错误/异常/致命并通过电子邮件发送结果时，我很惊讶我们以前没有注意到有多少问题（大多是很小的）。

这在某种程度上会有所帮助，您可以在将问题报告给支持团队之前自己注意到一些问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-01T11:52:21.240

确保可以使用自动更新部署您的应用程序。支持小组的头疼之一是将客户升级到最新和最好的，以便他们可以利用错误修复、新功能等。如果升级过程是无缝的，则可以减轻支持小组的压力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T11:50:27.873

*   提供一种机制来捕获问题发生时用户在做什么，提供一种日志记录或跟踪功能，可以帮助您和您的同事提供数据（抛出了什么异常、堆栈跟踪、程序状态、用户一直在做什么等.) 以便您可以重新创建问题。

*   如果您尚未在产品开发中加入开发人员自动化测试，请考虑这样做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T11:50:31.650

类似于 jamesh 的答案的组合，我们为网络应用程序这样做

*   提供“报告错误”链接，以便用户即使在不生成错误屏幕时也可以报告错误。
*   该链接打开了一个小对话框，该对话框又通过 Ajax 提交给服务器上的处理器。
*   处理器将提交与正在报告的脚本及其 PID 相关联，以便我们可以找到正确的日志文件（我们通过 script/pid 组织我们的日志文件），然后将电子邮件发送到我们的错误跟踪系统。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-01T14:05:26.473

提供已知问题文档 对应用程序进行培训，以便他们知道它应该如何工作 提供他们将理解的简单简洁的日志行，或使用描述错误的相应文档创建错误代码

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-26T07:22:21.680

一些想法：

*   尽最大努力立即验证用户输入。
*   尽早并尽可能频繁地检查错误或异常。在问题发生之后，在它产生“弹跳”效果之前，更容易追踪和解决问题。
*   只要有可能，请描述如何*纠正*错误消息中的问题。用户对出了什么问题不感兴趣，只对如何继续工作感兴趣：

    > **不好：** vogon.c 中的浮点异常，第 42 行
    > **更好：**请输入大于 0 的美元金额。

*   如果您无法建议对问题进行更正，请在致电技术支持之前告诉用户该做什么（或*不做*什么），例如：“单击帮助->关于查找版本/许可证号”或“请将此错误消息留在屏幕上。”
*   与您的支持人员交谈。询问常见问题和烦恼。让*他们*回答这个问题！
*   如果您的网站包含支持部分，请在错误消息中提供超链接或 URL。
*   指出错误是由于暂时的还是永久性的，这样用户就会知道是否要重试。
*   在每条错误消息中输入您的手机号码，并表明您是开发者。

好的，最后一项可能不实用，但它不会鼓励更好的编码实践吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-19T11:41:03.730

有改善事物的心态。每当您修复某些问题时，请询问：

*   我怎样才能避免将来出现类似的问题？

然后尝试找到解决*该*问题的方法。

# .net - 包装 Log4net 时如何记录 MethodName？

> ID：157232
> 
> 赞同：34
> 
> 时间：2008-10-01T11:50:01.480
> 
> 标签：.net, logging, log4net

我已经将 Log4net 包装在一个静态包装器中并想要记录

```
loggingEvent.LocationInformation.MethodName
loggingEvent.LocationInformation.ClassName 
```

然而，我得到的只是我的包装器的名称。

如何使用 forwardingappender 和静态包装类（如

```
Logger.Debug("Logging to Debug");
Logger.Info("Logging to Info");
Logger.Warn("Logging to Warn");
Logger.Error(ex);
Logger.Fatal(ex); 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-08-15T19:19:34.630

`%M`和`%C`变量呢 ？[http://logging.apache.org/log4net/log4net-1.2.11/release/sdk/log4net.Layout.PatternLayout.html](http://logging.apache.org/log4net/log4net-1.2.11/release/sdk/log4net.Layout.PatternLayout.html)

用法，例如：

```
<layout type="log4net.Layout.PatternLayout">
  <conversionPattern value="%date [%thread] %-5level %logger [%M %C] - %message%newline" />
</layout> 
```

这不是你所追求的吗？

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-01T14:28:50.223

好吧，错误出现在我的附加程序中，但为了完整起见，我尽我所知包括答案：

您需要的 Facade 应该包装 ILogger 而不是 ILog

```
 public static class Logger
 {
    private readonly static Type ThisDeclaringType = typeof(Logger);
    private static readonly ILogger defaultLogger;

    static Logger()
    {
      defaultLogger =
        LoggerManager.GetLogger(Assembly.GetCallingAssembly(),"MyDefaultLoggger"); 
```

...

```
 public static void Info(string message)
    {
        if (defaultLogger.IsEnabledFor(infoLevel))
        {
            defaultLogger.Log(typeof(Logger), infoLevel, message, null);
        }
    } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-05-05T20:39:21.170

我会简单地使用类似的东西`%stacktrace{2}`作为转换模式。

输出示例：

> MyNamespace.ClassName.Method > Common.Log.Warning

where`MyNamespace.ClassName.Method`是调用我的包装器`Common.Log.Warning`的方法，并且是包装器类的方法。

转换模式可以在[这里](http://logging.apache.org/log4net/release/sdk/log4net.Layout.PatternLayout.html)找到。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-01T14:30:32.343

只需像这样声明您的日志变量...

```
private static readonly log4net.ILog log = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType); 
```

然后就可以正常使用了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-01-08T12:31:19.823

这篇文章帮助我弄清楚了如何编写自己的包装器，因此作为回报，我认为您可能会喜欢我的完整类来包装记录器，这似乎工作得很好，实际上只需要直接使用 ILog 的一半多一点时间！

所需要的只是在配置文件中设置日志记录的适当 xml 和

```
[assembly: log4net.Config.XmlConfigurator(Watch = true)] 
```

在您的 AssemblyInfo.cs 中，它应该很容易工作。

注意事项：我使用 Log4NetDash 的设置非常简单，因此被欺骗并将一些信息放在错误的字段中（例如，域字段中的堆栈跟踪），这仍然对我有用，因为我不在乎信息在哪里显示，但如果您在空闲时间正确设置内容，则可能需要解决此问题！

```
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Reflection;
using System.Threading;
using log4net;
using log4net.Core;

namespace Utility
{
    public class Logger
    {
        static Logger()
        {
            LogManager.GetLogger(typeof(Logger));
        }

        public static void Debug(string message, params object[] parameters)
        {
            Log(message, Level.Debug, null, parameters);
        }

        public static void Info(string message, params object[] parameters)
        {
            Log(message, Level.Info, null, parameters);
        }

        public static void Warn(string message, params object[] parameters)
        {
            Log(message, Level.Warn, null, parameters);
        }

        public static void Error(string message, params object[] parameters)
        {
            Error(message, null, parameters);
        }

        public static void Error(Exception exception)
        {
            if (exception==null)
                return;
            Error(exception.Message, exception);
        }

        public static void Error(string message, Exception exception, params object[] parameters)
        {
            string exceptionStack = "";

            if (exception != null)
            {
                exceptionStack = exception.GetType().Name + " : " + exception.Message + Environment.NewLine;
                Exception loopException = exception;
                while (loopException.InnerException != null)
                {
                    loopException = loopException.InnerException;
                    exceptionStack += loopException.GetType().Name + " : " + loopException.Message + Environment.NewLine;
                }
            }

            Log(message, Level.Error, exceptionStack, parameters);
        }

        private static void Log(string message, Level logLevel, string exceptionMessage, params object[] parameters)
        {
            BackgroundWorker worker = new BackgroundWorker();
            worker.DoWork += LogEvent;
            worker.RunWorkerAsync(new LogMessageSpec
                                      {
                                          ExceptionMessage = exceptionMessage,
                                          LogLevel = logLevel,
                                          Message = message,
                                          Parameters = parameters,
                                          Stack = new StackTrace(),
                                          LogTime = DateTime.Now
                                      });
        }

        private static void LogEvent(object sender, DoWorkEventArgs e)
        {
            try
            {
                LogMessageSpec messageSpec = (LogMessageSpec) e.Argument;

                StackFrame frame = messageSpec.Stack.GetFrame(2);
                MethodBase method = frame.GetMethod();
                Type reflectedType = method.ReflectedType;

                ILogger log = LoggerManager.GetLogger(reflectedType.Assembly, reflectedType);
                Level currenLoggingLevel = ((log4net.Repository.Hierarchy.Logger) log).Parent.Level;

                if (messageSpec.LogLevel<currenLoggingLevel)
                    return;

                messageSpec.Message = string.Format(messageSpec.Message, messageSpec.Parameters);
                string stackTrace = "";
                StackFrame[] frames = messageSpec.Stack.GetFrames();
                if (frames != null)
                {
                    foreach (StackFrame tempFrame in frames)
                    {

                        MethodBase tempMethod = tempFrame.GetMethod();
                        stackTrace += tempMethod.Name + Environment.NewLine;
                    }
                }
                string userName = Thread.CurrentPrincipal.Identity.Name;
                LoggingEventData evdat = new LoggingEventData
                                             {
                                                 Domain = stackTrace,
                                                 Identity = userName,
                                                 Level = messageSpec.LogLevel,
                                                 LocationInfo = new LocationInfo(reflectedType.FullName,
                                                                                 method.Name,
                                                                                 frame.GetFileName(),
                                                                                 frame.GetFileLineNumber().ToString()),
                                                 LoggerName = reflectedType.Name,
                                                 Message = messageSpec.Message,
                                                 TimeStamp = messageSpec.LogTime,
                                                 UserName = userName,
                                                 ExceptionString = messageSpec.ExceptionMessage
                                             };
                log.Log(new LoggingEvent(evdat));
            }
            catch (Exception)
            {}//don't throw exceptions on background thread especially about logging!
        }

        private class LogMessageSpec
        {
            public StackTrace Stack { get; set; }
            public string Message { get; set; }
            public Level LogLevel { get; set; }
            public string ExceptionMessage { get; set; }
            public object[] Parameters { get; set; }
            public DateTime LogTime { get; set; }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-06-11T06:49:32.263

C#4.5 功能调用者信息怎么样 - [http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.callermembernameattribute.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.callermembernameattribute.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-07-03T16:40:44.957

我为此实现了以下解决方案（.Net 框架 4.5+）：log4net 包装器方法（例如 Info、Warn、Error）可以使用 CallerMemberName 和 CallerFilePath 来获取日志所在的代码的类和方法名称叫。然后，您可以将这些聚合到自定义 log4net 属性中。

随意使用您的 log4net 自己的包装器实现，这里唯一重要的是：Info 和 Error 方法的签名，以及 GetLogger 方法的实现。

在调用 Logger.Info 或 Logger.Error 方法时，不应指定“memberName”和“sourceFilePath”参数，它们由 .Net 自动填充。

```
public static class Logger
{
    private class LogSingletonWrapper
    {
        public ILog Log { get; set; }
        public LogSingletonWrapper()
        {
            Log = LogManager.GetLogger(GetType());
        }
    }

    private static readonly Lazy<LogSingletonWrapper> _logger = new Lazy<LogSingletonWrapper>();

    public static void Info(string message, [CallerMemberName] string memberName = "", [CallerFilePath] string sourceFilePath = "") 
        => GetLogger(memberName, sourceFilePath).Info(message);

    public static void Error(string message,Exception ex, [CallerMemberName] string memberName = "", [CallerFilePath] string sourceFilePath = "") 
        => GetLogger(memberName, sourceFilePath).Error(message, ex);

    private static ILog GetLogger(string memberName, string sourceFilePath)
    {
        var classname = sourceFilePath.Split('\\').Last().Split('.').First();
        log4net.ThreadContext.Properties["Source"] = $"{classname}.{memberName.Replace(".", "")}";
        return _logger.Value.Log;
    }
} 
```

然后你可以在你的 .config 文件中使用这样的日志转换模式：

```
<conversionPattern value="[%level][%date][Thd%thread: %property{Source}][Message: %message]%newline" /> 
```

这将导致日志如下所示：

> [INFO][2019-07-03 16:42:00,936][Thd1: Application.Start][消息：应用程序正在启动...]
> 
> [错误][2019-07-03 16:42:44,145][Thd6: DataProcessor.ProcessDataBatch][消息：试图除以零。]

上述示例中调用了以下方法：Application 类的 Start 方法和 DataProcessor 类的 ProcessDataBatch 方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-01T11:58:01.617

我唯一能想到的（因为我目前不使用 log4net）是请求堆栈跟踪（新 StackTrace），然后返回一个框架以获取您需要的信息。但是，我不确定这对运行时性能的影响。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-16T22:18:53.567

我只会写更多克劳斯正确答案的代码

> 在包装类中

```
public static class Logger
{
   private static readonly ILogger DefaultLogger;

   static Logger()
   {
      defaultLogger = LoggerManager.GetLogger(Assembly.GetCallingAssembly(), "MyDefaultLoggger"); // MyDefaultLoggger is the name of Logger
   }

  public static void LogError(object message)
  {
      Level errorLevel = Level.Error;
      if (DefaultLogger.IsEnabledFor(errorLevel))
      {
          DefaultLogger.Log(typeof(Logger), errorLevel, message, null);
      }
  }

  public static void LogError(object message, Exception exception)
  {
      Level errorLevel = Level.Error;
      if (DefaultLogger.IsEnabledFor(errorLevel))
      {
          DefaultLogger.Log(typeof(Logger), errorLevel, message, exception);
      }
  } 
```

其余方法以此类推。

> 在 web.config 或 app.config **log4net.Layout.PatternLayout**中 ，您可以使用一些转换模式，例如：

```
%location %method %line

<layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%date{dd/MM/yyyy hh:mm:ss.fff tt} [%thread] %level %logger [%location %method %line] [%C %M] - %newline%message%newline%exception"/>
  </layout> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-06-05T15:29:51.657

单击[此处](https://github.com/shani11/Log4Net-with-Log4Net_Logging-nuget/tree/master/Log4NetLogging_Project)了解如何在 .NET Core 2.2 中实现 log4net

以下步骤取自上述链接，并分解了如何将 log4net 添加到 .NET Core 2.2 项目中。

首先，在 Package-Manager 控制台中运行以下命令：

```
Install-Package Log4Net_Logging -Version 1.0.0 
```

然后添加带有以下信息的 log4net.config（请编辑它以匹配您的设置）：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
  </configSections>
  <log4net>
    <appender name="FileAppender" type="log4net.Appender.FileAppender">
      <file value="logfile.log" />
      <appendToFile value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%d [%t] %-5p - %m%n" />
      </layout>
    </appender>
    <root>
      <!--LogLevel: OFF, FATAL, ERROR, WARN, INFO, DEBUG, ALL -->
      <level value="ALL" />
      <appender-ref ref="FileAppender" />
    </root>
  </log4net>
</configuration> 
```

然后，将以下代码添加到控制器中（这是一个示例，请在将其添加到控制器之前对其进行编辑）：

```
public ValuesController()
{
    LogFourNet.SetUp(Assembly.GetEntryAssembly(), "log4net.config");
}
// GET api/values
[HttpGet]
public ActionResult<IEnumerable<string>> Get()
{
    LogFourNet.Info(this, "This is Info logging");
    LogFourNet.Debug(this, "This is Debug logging");
    LogFourNet.Error(this, "This is Error logging");    
    return new string[] { "value1", "value2" };
} 
```

然后调用相关的控制器操作（使用上面的示例，`/Values/Get`使用 HTTP GET 调用），您将收到与以下内容匹配的输出：

> 2019-06-05 19:58:45,103 [9] INFO-[Log4NetLogging_Project.Controllers.ValuesController.Get:23] - 这是信息记录

# case-tools - 您使用哪些 CASE 工具？

> ID：157249
> 
> 赞同：2
> 
> 时间：2008-10-01T11:53:03.453
> 
> 标签：case-tools

您使用哪些计算机辅助软件工程工具，为什么？它们以何种方式提高您的工作效率或帮助您设计程序？或者，如果您不使用 CASE 工具，您的原因是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-01T12:34:09.953

我必须使用的最好的 CASE 工具是Sparx[的](http://www.sparxsystems.com.au/)[Enterprise Architect](http://www.sparxsystems.com.au/products/ea/index.html)。

与 Rose 相比，它重量轻（更容易购买，也更便宜），但功能非常强大。您可以制作出色的 UML 图或数据库模型或其他任何您想要的东西，但要以一种很好且有条理的方式。

它对细化过程的初始阶段有很大帮助，因为您可以创建领域模型，做一些初步的用例，将它们映射到需求，并以一种很好的方式向客户展示所有这些。它帮助我思考并用它重新设计我的设计，直到我足够满意以开始正确的文档。它也非常适合数据库模型，因为它可以非常巧妙地对大多数数据库进行逆向工程。

在我看来，它唯一（但相当严重）的缺点是它的文档生成器，说得委婉些，就是垃圾。除非您在模板上投入大量工作，否则几乎不可能从中获得正确的文档，然后就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T13:21:49.510

不使用任何。没钱给他们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T12:37:42.817

甲骨文设计师

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T12:00:48.410

我过去曾使用过 Rational Rose 和其他一些类似的软件包。大多数情况下，我将它们用于 UML 图表元素，并没有涉及更详细的功能，例如代码生成等。

我主要使用它们来帮助设计过程并阐明我自己的想法。我经常发现，在尝试为组件设计设计时，我最终需要写下/画出我想要发生的事情，这样我才能清楚地了解需要发生什么以及为什么发生。我发现在很多情况下，我最终尝试绘制的内容与 UML 中预定义的图表类型基本相同，例如用例图等，然后采用这种风格，变得更容易获得我的想法在纸上，因为我有一些框架可以工作。

因此，我主要将 CASE 工具用于他们的 UML/设计工具，以达到较高的、半抽象的水平。

# events - 将事件处理代码放入自己的方法中是一个好的设计吗？

> ID：157254
> 
> 赞同：2
> 
> 时间：2008-10-01T11:55:37.533
> 
> 标签：events

在您的 Windows 窗体上创建一个在单击时执行某些操作的按钮。

引发的点击事件通常绑定到一个方法，例如

> 受保护的无效Button1_Click（对象发送者，EventArgs e）{
> 
> }

我有时在其他人的代码中看到的是，按钮行为的实现不是放入 Button1_Click 方法中，而是放入从这里调用的自己的方法中，如下所示：

> 私人 DoStuff() { }
> 
> protected void Button1_Click(object sender, EventArgs e) { this.DoStuff(); }

尽管我在这里看到了优势（例如，如果在其他地方内部需要这段代码，它可以很容易地使用），但我想知道，**这是否是一个普遍的良好设计决策**？

所以问题是：将事件处理代码放入自己的方法中是否是一个普遍的好主意，如果是这样，这些方法的哪些命名约定被证明是最佳实践？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T11:59:57.993

如果出现以下情况，我会将事件处理代码放入单独的方法中：

*   该代码将由多个事件或从其他任何地方调用，或
*   代码实际上与 GUI 无关，更像是后端工作。

所有小的和仅与 GUI 相关的东西总是进入处理程序，有时即使它是从同一个事件中调用的（只要签名相同）。所以更像是，如果是通用动作，就使用单独的方法，如果方法与实际事件密切相关，则不要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T11:58:56.183

一个好的经验法则是查看该方法是在执行某些特定于 UI 的操作，还是实际执行通用操作。例如，臀部点击方法可以处理点击或提交表单。如果是前一种，可以将其留在 button_click 处理程序中，但后者应该有自己的方法。我要说的是，牢记[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T12:10:33.160

在这种情况下，我会保留 DoStuff() 方法，但通过以下方式订阅它：

```
button1.Click += delegate { DoStuff(); } 
```

诚然，这不会取悦那些在设计器中完成所有事件接线的人......但我个人觉得检查起来更简单。（我也讨厌自动生成的事件处理程序名称......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T12:01:03.387

直接的答案是肯定的。最好将任务封装到它自己的方法中，不仅是为了在其他地方重用，而且从 OOP 的角度来看，这样做是有意义的。在这种特殊情况下，单击按钮会启动一个进程调用 DoStuff。该按钮只是触发该过程。Button1_Click 是一个与 DoStuff 完全不同的任务。然而，DoStuff 不仅更具描述性，而且将您的按钮与正在完成的实际工作分离。

> 一个好的经验法则是查看该方法是在执行某些特定于 UI 的操作，还是实际执行通用操作。例如，臀部点击方法可以处理点击或提交表单。如果是前一种，可以将其留在 button_click 处理程序中，但后者应该有自己的方法。我要说的是，牢记单一责任原则。
> 
> 如果出现以下情况，我会将事件处理代码放入单独的方法中：
> 
> *   该代码将由多个事件或从其他任何地方调用，或
>     
>     
> *   代码实际上与 GUI 无关，更像是后端工作。
>     
>     
> 
> 所有小的和仅与 GUI 相关的东西总是进入处理程序，有时即使它是从同一个事件中调用的（只要签名相同）。所以更像是，如果是通用动作，就使用单独的方法，如果方法与实际事件密切相关，则不要。

# javascript - 在 JavaScript 中循环一组元素的最佳方式是什么？

> ID：157260
> 
> 赞同：62
> 
> 时间：2008-10-01T11:57:49.010
> 
> 标签：javascript, arrays, loops, elements

在过去和我目前的大多数项目中，我倾向于使用这样的 for 循环：

```
var elements = document.getElementsByTagName('div');
for (var i=0; i<elements.length; i++) {
    doSomething(elements[i]);
} 
```

我听说使用“反向while”循环更快，但我没有真正的方法来确认这一点：

```
var elements = document.getElementsByTagName('div'), 
    length = elements.length;

while(length--) {
    doSomething(elements[length]);
} 
```

在循环遍历 JavaScript 中的元素或任何数组时，什么被认为是最佳实践？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2011-01-06T21:57:28.350

这是我经常使用的一种很好的循环形式。您从 for 语句创建迭代变量，并且不需要检查长度属性，这在迭代 NodeList 时可能特别昂贵。但是，**您必须小心**，**如果数组中的任何值可能是 "falsy" ，则不能使用它**。在实践中，我只在迭代不包含空值的对象数组（如 NodeList）时使用它。但我喜欢它的语法糖。

```
var list = [{a:1,b:2}, {a:3,b:5}, {a:8,b:2}, {a:4,b:1}, {a:0,b:8}];

for (var i=0, item; item = list[i]; i++) {
  // Look no need to do list[i] in the body of the loop
  console.log("Looping: index ", i, "item" + item);
} 
```

请注意，这也可以用于向后循环。

```
var list = [{a:1,b:2}, {a:3,b:5}, {a:8,b:2}, {a:4,b:1}, {a:0,b:8}];

for (var i = list.length - 1, item; item = list[i]; i--) {
  console.log("Looping: index ", i, "item", item);
} 
```

**ES6 更新**

[`for...of`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)给你名字而不是索引，从[ES6开始可用](https://www.ecma-international.org/ecma-262/6.0/#sec-for-in-and-for-of-statements)

```
for (const item of list) {
    console.log("Looping: index ", "Sorry!!!", "item" + item);
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-01T12:23:51.197

请注意，在某些情况下，您*需要*以相反的顺序循环（但您也可以使用 i-- ）。

例如，有人想使用新`getElementsByClassName`函数循环给定类的元素并更改该类。他发现只有二分之一的元素被改变了（在FF3中）。
这是因为该函数返回一个活动的 NodeList，从而反映了 Dom 树中的变化。以相反的顺序遍历列表可以避免这个问题。

```
var menus = document.getElementsByClassName("style2");
for (var i = menus.length - 1; i >= 0; i--)
{
  menus[i].className = "style1";
} 
```

在增加索引进程中，当我们询问索引 1 时，FF 检查 Dom 并跳过第一个具有 style2 的项，即原始 Dom 的第 2 个，因此它返回第 3 个初始项！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-01T13:04:13.360

我喜欢这样做：

```
 var menu = document.getElementsByTagName('div');
for (var i = 0; menu[i]; i++) {
     ...
} 
```

每次迭代都不会调用数组的长度。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-01T11:59:52.500

冒着被骂的风险，我会得到一个像[jquery](http://jquery.com)或[原型](http://prototypejs.org)这样的 javascript 帮助程序库，它们将逻辑封装在很好的方法中 - 两者都有一个 .each 方法/迭代器来做到这一点 - 他们都努力使其跨浏览器兼容

编辑：这个答案发布于 2008 年。今天存在更好的结构。这种特殊情况可以用`.forEach`.

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-03-16T01:05:17.433

我之前遇到过与 document.getElementsByClassName() 非常相似的问题。我当时不知道节点列表是什么。

```
var elements = document.getElementsByTagName('div');
for (var i=0; i<elements.length; i++) {
    doSomething(elements[i]);
} 
```

我的问题是我希望元素是一个数组，但事实并非如此。返回的节点列表 Document.getElementsByTagName() 是可迭代的，但您不能在其上调用 array.prototype 方法。

但是，您*可以*使用如下节点列表元素填充数组：

```
var myElements = [];
for (var i=0; i<myNodeList.length; i++) {                               
    var element = myNodeList[i];
    myElements.push(element);
}; 
```

之后，您可以随意在数组元素上调用 .innerHTML 或 .style 或其他内容。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-01T12:08:28.300

我也建议使用简单的方法（亲吻！-）

-- 但是可以找到一些优化，即不要多次测试数组的长度：

```
var elements = document.getElementsByTagName('div');
for (var i=0, im=elements.length; im>i; i++) {
    doSomething(elements[i]);
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-01T12:00:24.090

我认为使用第一种形式可能是要走的路，因为它可能是迄今为止已知宇宙中最常见的循环结构，而且我不相信反向循环在现实中可以节省您的任何时间（仍在做增量/每次迭代的递减和比较）。

其他人可识别和可读的代码绝对是一件好事。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-02T10:22:23.663

另请参阅我对 Andrew Hedges 测试的评论...

我只是尝试运行一个测试来比较一个简单的迭代、我引入的优化和反向 do/while，其中数组中的元素在每个循环中都进行了测试。

唉，毫不奇怪，我测试的三个浏览器的结果非常不同，尽管优化后的简单迭代是最快的！-)

## 测试：

在实际测试之外构建一个包含 500,000 个元素的数组，每次迭代都会显示特定数组元素的值。

试运行 10 次。

## IE6：

结果：

简单：984,922,937,984,891,907,906,891,906,906

平均：923.40 毫秒。

优化：766,766,844,797,750,750,765,765,766,766

平均：773.50 毫秒。

反向do/while：3375,1328,1516,1344,1375,1406,1688,1344,1297,1265

平均：1593.80 毫秒。（注意一个特别尴尬的结果）

## 歌剧 9.52：

结果：

简单：344,343,344,359,343,359,344,359,359,359

平均：351.30 毫秒。

优化：281,297,297,297,297,281,281,297,281,281

平均：289.00 毫秒

反向执行/同时：391,407,391,391,500,407,407,406,406,406

平均：411.20 毫秒。

## 火狐 3.0.1：

结果：

简单：278,251,259,245,243,242,259,246,247,256

平均：252.60 毫秒。

优化：267,222,223,226,223,230,221,231,224,230

平均：229.70 毫秒。

反向do/while：414,381,389,383,388,389,381,387,400,379

平均：389.10 毫秒。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-01-04T07:53:26.370

**Juan Mendez**提供的循环形式非常有用且实用，我对其进行了一些更改，现在它也适用于 - false、null、零和空字符串。

```
var items = [
    true,
    false,
    null,
    0,
    ""
];

for(var i = 0, item; (item = items[i]) !== undefined; i++)
{
    console.log("Index: " + i + "; Value: " + item);
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-01T12:02:11.357

我知道你不想听到这个，但是：我认为在这种情况下最佳实践是最易读的。只要循环不是从这里到月球，性能增益就不够。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-03-12T19:55:03.180

我知道这个问题很老 - 但这是另一个非常简单的解决方案......

```
var elements = Array.from(document.querySelectorAll("div")); 
```

然后它可以像任何标准数组一样使用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-01T12:12:26.697

我更喜欢 for 循环，因为它更具可读性。从长度循环到 0 比从 0 循环到长度更有效。正如你所说，使用反向 while 循环比 foo 循环更有效。我不再有指向具有比较结果的页面的链接，但我记得不同浏览器的差异有所不同。对于某些浏览器，反向 while 循环的速度是原来的两倍。但是，如果您循环“小”数组，则没有区别。在您的示例中，元素的长度将是“小”

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-02T10:32:20.923

我认为你有两种选择。对于 dom 元素，如 jQuery 和类似框架，为您提供了一种很好的迭代方法。第二种方法是 for 循环。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2014-10-07T08:53:15.660

如果元素集是根节点的子节点，我喜欢使用[TreeWalker 。](https://developer.mozilla.org/en-US/docs/Web/API/TreeWalker)

# ssl - rapidSSL 和 geotrust 证书有什么区别？

> ID：157271
> 
> 赞同：47
> 
> 时间：2008-10-01T12:02:17.877
> 
> 标签：ssl, digital-certificate, certificate-authority

我想为销售服务的网站购买 128 位 SSL 证书。我检查了[http://www.rapidssl.com/ssl-certificate-products/ssl-certificate.htm](http://www.rapidssl.com/ssl-certificate-products/ssl-certificate.htm)和[http://www.geotrust.com/ssl/compare-ssl-certificates.html](http://www.geotrust.com/ssl/compare-ssl-certificates.html)。为什么 QuickSSL（Geotrust，249 美元）和 RapidSSL（rapidSSL，69 美元）的价格如此不同？这有什么特别的原因还是只是营销？

RapidSSL 说明如下：

> 然而，我们认为进行超过 50 次交易的网站将需要专业级 SSL 证书，因为该网站的客户期望来自高度可信和成熟的 SSL 提供商以及国际公认的知名 SSL 品牌的 SSL 的可能性增加。

（“专业级 SSL”是指 Geotrust 证书）

PS 用户真的会关注 SSL 颁发机构的品牌名称吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-01T12:40:09.673

SSL 证书颁发机构 (CA)/提供商的工作是验证您的组织身份，以便当客户访问您的网站时，他们不仅会获得安全挂锁，而且他们知道您作为完全限定主机名的身份是真实的，并且不是一些网络钓鱼诈骗。

诚然，大多数用户只看到挂锁表明与他们的银行网站、电子邮件等的安全连接。但是，如果任何 CA 被入侵，所有信任该 CA 的浏览器都会受到攻击，因为攻击者可以伪造一个*任何域*的证书，包括你的。*您选择的证书提供者与此无关。*我还没有听说这实际上发生了。随着无线热点变得越来越普遍，MITM 攻击现在很重要。

另一件事是浏览器兼容性。您会期望您新购买的证书与每个现代浏览器兼容。这是因为它们都加载了一个根 CA 证书列表，这些证书信任 SSL 证书颁发机构的选择列表。如果您从不在该列表中的 CA 购买，您的所有客户端浏览器都会收到安全警告，表明该站点的证书不受信任。只需仔细检查 RapidSSL、Geotrust 或任何与您一起使用的浏览器是否在您关心的所有浏览器列表中。（例如对于 Firefox，它位于工具/选项/高级/加密/查看证书/权限选项卡）

最后，只需获得最便宜的，即可为您提供所需的加密级别。它会完成工作。请咨询您的网络托管服务提供商。他们可能有折扣。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-02-21T05:28:00.213

澄清一下，两者都归 Geotrust(R) 所有。一个区别是 Geotrust 证书使用“Geotrust”根，而 RapidSSL 证书使用“Equifax”根，这将显示在“颁发者”证书信息中。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-09T11:35:56.047

我知道这已经有一个公认的答案，但还有另一个方面。

在欺诈方面，更昂贵的 SSL 证书通常有更好的保证。例如，成本较低的 SSL 证书可能涵盖价值 10,000 美元的欺诈行为，而成本较高的 SSL 证书可能涵盖价值 100,000 美元的欺诈行为。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-01T12:09:06.800

他们都做同样的工作，我猜只是品牌认知

老实说，我认为最终用户甚至不会注意到。只要他们看到小挂锁他们就会开心

附言。Godaddy 证书更便宜

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-11T09:23:01.673

[这对RapidSSL 常见](http://www.rapidssl.com/ssl-certificate-support/ssl-faq.htm)问题有很好的概述。

这将为您提供相同的[QuickSSL](http://www.geotrust.com/resources/product_pdfs/pdfs/DS_QSSL_0205s.pdf)。

这些证书的主要区别在于购买期间的验证量。两者的加密基本相同。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-29T09:16:02.787

至于上面提到的保证，据我了解，这是对“最终用户”的保证，以防证书颁发机构向欺诈者/域颁发证书。这不是对网站所有者的保证。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-08-20T15:45:52.107

游戏已经很晚了，但这里还有一个值得注意的细节——RapidSSL 不在 IE8 的受信任机构列表中。

# sql - 删除旧结果的 SQL 触发器

> ID：157272
> 
> 赞同：1
> 
> 时间：2008-10-01T12:03:12.460
> 
> 标签：sql, sqlite

我们有一个数据库，用于存储嵌入式设备的测试结果。有一个表，其中包含不同类型故障的列（详细信息不相关），以及一个主键“keynum”和一个列出故障数量的“NUM_FAILURES”列。我们存储通过和失败，因此通过在“NUM_FAILURES”中具有“0”。

为了防止数据库无限制地增长，我们希望保留最后 1000 个结果，以及最后 50 个超出 1000 个的失败。因此，最坏的情况是，表中可能有 1050 个条目。我试图找到最有效的 SQL 插入触发器来删除额外的条目。我会给出我目前的答案，但我想看看是否有人能想出更好的东西，因为 SQL 不是我经常做的事情。

如果相关，我们在非 Windows 平台上使用 SQLITE3。

**编辑：**澄清一下，我遇到问题的部分是删除，特别是与最近 50 次故障相关的部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T12:04:52.630

您想要删除这些条目的原因是为了保持数据库增长过大，而不是将其保持在某种特殊状态。为此，我真的不会使用触发器，而是设置一个作业以每隔一段时间运行清理表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T12:07:48.457

到目前为止，我最终使用了结合触发器的视图，但由于其他原因，我不确定它是否会起作用。

```
CREATE VIEW tablename_view AS SELECT keynum FROM tablename WHERE NUM_FAILURES!='0' 
    ORDER BY keynum DESC LIMIT 50;
CREATE TRIGGER tablename_trig
  AFTER INSERT ON tablename WHEN (((SELECT COUNT(*) FROM tablename) >= 1000) or
    ((SELECT COUNT(NUM_FAILURES) FROM tablename WHERE NUM_FAILURES!='0') >= 50))
  BEGIN
     DELETE FROM tablename WHERE ((((SELECT MAX(keynum) FROM ibit) - keynum) >= 1000)
  AND 
     ((NUM_FAILURES=='0') OR ((SELECT MIN(keynum) FROM tablename_view) > keynum)));
  END; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T12:19:58.863

我认为您可能使用了错误的数据结构。相反，我会创建两个表并预先填充一个 1000 行（成功）和另一个 50 行（失败）。在每个上放置一个主 ID。当您记录结果而不是插入新行时，找到输入的最后一个带时间戳的记录的 ID+1 值（如果表中 > max(id) 则循环回 0）并使用新值更新它。

这具有预先分配存储、不需要触发器和内部一致逻辑的优点。您还可以通过预先填充更多记录来非常简单地调整日志的大小，而不必更改程序逻辑。

您可以对此使用多种变体，但使用闭环结构而不是开放列表的想法似乎更接近问题域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T14:25:20.130

这个怎么样：

```
DELETE  
FROM  table 
WHERE ( id   > ( SELECT max(id) - 1000 FROM table ) 
        AND  num_failures   = 0 
      )
OR    id     > ( SELECT max(id) - 1050 FROM table ) 
```

如果性能是一个问题，最好定期删除，而不是每次插入。

# php - 如何从基于 Linux 的 Web 应用程序中进行 3270 屏幕抓取

> ID：157274
> 
> 赞同：8
> 
> 时间：2008-10-01T12:03:20.403
> 
> 标签：php, c, mainframe, 3270, hllapi

我有一个 LAMP (PHP) Web 应用程序，它需要与 IBM 3270 大型机上的程序交互（通过 Microsoft SNA 服务器）。我正在研究的一种解决方案是通过 3270 进行屏幕抓取。（我正在将现在与过去结合起来！）

许多年前，我编写了使用 HLLAPI 作为此类任务基础的 C 代码。

1.  HLLAPI 仍然是完成这项任务的最佳方式吗？
2.  如果是这样，我是否最好只编写一个 C 应用程序来承担必要的工作并从 php 执行（）这个 C 应用程序？
3.  是否有任何适用于 Linux 的开源 HLLAPI 提供程序？（过去我使用商业解决方案，例如 Cleo。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-02T04:11:29.390

我没有使用它，但也许看看[http://x3270.bgp.nu/](http://x3270.bgp.nu/)它说有一个版本：

> s3270 是用于编写屏幕抓取脚本的无显示版本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T12:20:53.160

我目前正在尝试做类似的事情，但使用命令行 Python 脚本。我打开一个到 s3270 的管道（在 Windows 上，exe 名称是 ws3270）以连接到服务器并发送所有命令。

仔细阅读脚本文档的那些部分：

[http://x3270.bgp.nu/wc3270-man.html#Actions](http://x3270.bgp.nu/wc3270-man.html#Actions)

[http://x3270.bgp.nu/x3270-script.html#Script-Specific-Actions](http://x3270.bgp.nu/x3270-script.html#Script-Specific-Actions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T03:55:39.067

虽然我没有使用 3270 的经验，但我认为查找和调用外部应用程序或库是您最好的选择。PHP 不是万能工具，入侵非 Web 通信协议最好留给 C 或 Java 等能够很好处理的语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T12:49:01.563

屏幕抓取 3270 应用程序是获取数据的一种完全有效的方式。许多这些应用程序多年来没有改变，在某些情况下甚至几十年。有时根本没有 API 或其他编程方式来获取必要的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-26T21:05:31.377

Nighthawk：你总是可以学习 CORBA，这个系统的怪物被设计为让 C 程序与远程 COBOL 系统或用 PL/I 或其他东西编写的随机东西对话。

但说真的，如果老应用没有 API，3270 屏幕抓取是可以的。3270 屏幕和 HTML 表单之间有很多相似之处（与字符模式终端不同）。

# css - 在 IE 和 Firefox 中编辑 CSS 和预览的工具

> ID：157277
> 
> 赞同：-2
> 
> 时间：2008-10-01T12:04:01.633
> 
> 标签：css, plugins

我正在寻找一个 VS2008 插件或其他允许我编辑 CSS 并预览 IE 和 Firefox 中的更改的工具。

我不是全职网页设计师，所以免费或开源是一个加号。
Visual Studio 集成是一大优势

到目前为止审查：

## CSSVista

优点：

*   自由
*   不错的预览

缺点：

*   编辑器不给力
*   不保存到本地文件
*   没有智能感知

## 萤火虫

优点：

*   自由
*   智能感知

缺点：

*   不保存到本地文件
*   只有火狐

## 主页

优点：

*   智能感知
*   保存到本地文件

缺点：

*   不是免费的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T16:41:12.497

[skybound stylizer](http://www.skybound.ca/stylizer/ "Skybound Stylizer") seems to be the app for you. allows for live editing, much like cssvista, but with way more powerful tools for editing.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T12:53:19.470

我用来获得该功能的是通过 Firefox 的 Web Developer Addon，您可以实时编辑 CSS。我不知道 VS 有这样的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T13:00:49.657

不是您真正要寻找的答案，但 Firefox 的 Firebug 具有 css-edit-preview。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-17T07:16:58.640

For Ie-----there is one tool Iedeveloper tool For Firefox----Firebug is enough..........Using these two,,,u can edit css and u can see the preview

# c# - .NET Winforms 应用程序中的报告

> ID：157287
> 
> 赞同：5
> 
> 时间：2008-10-01T12:08:48.970
> 
> 标签：c#, .net, winforms, report

我正在编写一个 Winforms 应用程序，并且一直在编写这些糟糕的 HTML 报告，其中设置了模板并使用 String.Replace 将变量放入模板中，然后将结果输出到 WebBrowser 控件。我真的不喜欢这个设置。

我希望能够将 ASP.NET 用于我的报告，但我的客户不希望必须在安装它的所有机器上运行 IIS，所以这不是一个真正的选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T12:13:28.193

你试过[reportviewer控件](http://www.gotreportviewer.com/)吗？您的客户会对精美的新报告感到满意。它是基于模板的，可以包含来自数据库或代码数据的数据，您可以使用参数、图像，结果可以导出到 Excel 或 PDF。

此外，该控件还具有一些基本功能，例如分页、缩放、打印、查找...

为什么需要 ASP.NET？我不明白，它可以带来什么不同。也许您可以更轻松地呈现 HTML，但它仍然不是“真正的”报告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T12:25:26.417

如前所述，将报表查看器与客户端报表一起使用。您可以像创建 sql 报告服务一样创建报告，但不需要 sql server（也不需要 asp.net）。另外，您可以完全控制它们（您如何呈现、如何收集数据、它们在哪个层中生成等）。您还可以导出为 PDF 和 Excel。

如果对客户端报告感兴趣，我推荐给大家看看这是一本很棒的书。它提供了很多很棒的信息以及许多不同的场景和使用客户端报告的方法。

[http://www.apress.com/book/view/9781590598542](http://www.apress.com/book/view/9781590598542)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T12:12:25.327

虽然我没有使用它，但我听到了很多关于[Telerik 报告](http://www.telerik.com/products/reporting/overview.aspx)的播客广告。可能值得一看。看起来相当甜美。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T12:16:00.997

您可以使用 Visual Studio 中包含的 Crystal Reports 版本并将输出保存为 .PDF 文件，该文件不会*太*笨拙而无法从浏览器中读取。（这就是我在上一份合同中所做的）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T12:51:27.713

为什么不使用 xsl 生成 html 报告？比进行字符串替换要好得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T12:28:22.667

您可能会研究[Cassini——](http://www.ultidev.com/products/Cassini/)一个免费的 ASP.NET Web 服务器组件，您可以将其直接嵌入到您的 WinForms 应用程序中。UltiDev 版本（链接）基于 Microsoft 在 .NET 1.0 中发布的代码，该代码也用于 Visual Studio 2005+ 开发 Web 服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T13:10:54.670

对于超越 VS 中仅数据集的报告查看器的高级报告解决方案，您应该考虑[Data Dynamics Reports](http://www.datadynamics.com/Products/DDRPT/Default.aspx)

它提供了 SSRS 中的所有内容，并添加了主报告、主题、日历数据区域、数据可视化（Databar、Sparkline、Iconset、ColorScale，...）、实现最大编程灵活性的完整对象模型、免版税最终用户报告设计器、条形码报表项、excel模板导出和数据合并等等。您可以从 Data Dynamics（现为 GrapeCity）下载试用版并使用少量报告进行试用，您不会失望的。

# java - Hibernate SessionFactoryBean 用于映射文件的多个位置

> ID：157294
> 
> 赞同：0
> 
> 时间：2008-10-01T12:11:49.663
> 
> 标签：java, hibernate, spring

我们有一个由多个子项目组成的项目。对于每个子项目，我们可能有一些休眠映射文件，但最终只有**一个实际的休眠会话**。这些子项目可以通过多种方式组合，其中一些相互依赖。我的问题是，实际上我想要一个 SessionFactoryBean 能够从 applicationContext(s) 收集这些映射/映射位置并进行自我配置。

有人写过这样的东西，还是我必须自己做（我设想有点像 SpringMVC 的 urlresolver 或 viewresolver 功能）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T11:56:54.793

另一种（更简单的）方法是将所有模型类收集在一个项目中。让您的所有其他项目依赖它并在那里创建您的 SessionFactory。这就是我设法解决相同问题的方法，并且效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T12:30:46.763

`LocalSessionFactoryBean`有一个 configLocations 属性。您注入配置位置列表，它会将它们收集在一起以进行单个会话工厂配置。

# python - 使用 Jython 运行的 Python 中的模板库（引擎）

> ID：157313
> 
> 赞同：1
> 
> 时间：2008-10-01T12:20:23.060
> 
> 标签：python, jython, template-engine

我正在搜索模板库或模板引擎以生成在 Jython 下运行的 HTML (XML)（Jython 2.5 Alpha 可以）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T12:37:24.470

你试过[Cheetah](http://www.cheetahtemplate.org/)吗，我没有在 Jython 下运行它的直接经验，但似乎有些人这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T01:35:51.477

Jinja 很酷，似乎可以在 Jython 上工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T02:50:53.313

使用 StringTemplate，有关原因的详细信息，请参阅[http://www.cs.usfca.edu/~parrt/papers/mvc.templates.pdf](http://www.cs.usfca.edu/~parrt/papers/mvc.templates.pdf)。没有比这更好的了，它同时支持 Java 和 Python（以及 .NET 等）。

# xml - Java ME 的最佳二进制/普通 XML 实现是什么？

> ID：157314
> 
> 赞同：0
> 
> 时间：2008-10-01T12:20:48.817
> 
> 标签：xml, java-me, mobile

在 Izb 关于[JavaME 的最佳二进制 XML 格式](https://stackoverflow.com/questions/8599/best-binary-xml-format-for-javame)的问题之后，我正在寻找类似二进制 XML 格式或纯 XML 的实现。我对这种实施的衡量标准，首先最重要的是：

1.  支持的手机。一个基本的[JTWI](http://jcp.org/en/jsr/detail?id=185)电话应该能够运行它。
2.  它应该是经过验证的或开源的，所以我可以对其进行验证。
3.  内存占用小。
4.  快速地。
5.  易于在服务器端使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T03:06:34.707

看看 kXML - [http://kxml.objectweb.org/](http://kxml.objectweb.org/)。它支持 WBXML 并且具有低内存占用，但它对错误不是很严格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-02T19:00:30.567

W3C 对二进制 XML 技术进行了广泛而开放的分析，其中包括 9 个月的基准测试，以确定哪些是最小、最快和最适合其[用例和要求](http://www.w3.org/TR/exi-measurements/)的。基于此分析，他们选择了一种格式[作为 Web 的单一标准](http://www.w3.org/TR/exi-evaluation/)。

他们选择的技术称为“高效 XML”，而不是另一位评论者所报告的 FastInfoset。W3C 发现 FastInfoset 的用例没有达到足够的紧凑性和通用性。[您可以在http://lists.w3.org/Archives/Public/public-exi/2009Dec/0001.html](http://lists.w3.org/Archives/Public/public-exi/2009Dec/0001.html)上的 W3C 的公共邮件列表中找到该决定的简短描述。[您可以从http://www.agiledelta.com/product_efxsdk.html 找到](http://www.agiledelta.com/product_efxsdk.html)适用于移动设备和服务器平台的 W3C EXI 标准的低占用空间、快速实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T02:55:19.393

您可以将[NanoXML 用于 J2ME](http://www.ericgiguere.com/nanoxml/index.html)。它运行良好，我在生产环境中从未遇到过任何问题。请注意，它是非验证的。

杨格

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T12:26:50.783

W3C 为 XML 定义了一种二进制编码，称为 Fast InfoSet，但它针对大容量 Web 服务而不是嵌入式设备进行了优化，我认为没有适合您的轻量和快速实现。

如果您想坚持使用纯 XML，并且需要 DOM 实现，那么请使用 XOM ( [http://xom.nu](http://xom.nu) )。它很容易成为占用空间最小的 DOM，而且速度非常快。

但是，如果您真的需要减少占用空间，那么您需要使用非 DOM API，如 SAX 或 STAX，但这是相当多的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T22:00:46.227

感谢所有回答的人，但这就是我最终所做的 -

[这里](http://developers.sun.com/mobility/midp/articles/parsingxml/)有一篇关于 Parsing XML in J2ME 的好文档。那里有一张桌子，上面有一些替代品。现在我选择使用 AXMLP 并将其用于 xml-push 解析。

# php - 使用 PHP 发送文件时可恢复下载？

> ID：157318
> 
> 赞同：109
> 
> 时间：2008-10-01T12:22:19.107
> 
> 标签：php, download, resume-download

我们使用 PHP 脚本来隧道文件下载，因为我们不想公开可下载文件的绝对路径：

```
header("Content-Type: $ctype");
header("Content-Length: " . filesize($file));
header("Content-Disposition: attachment; filename=\"$fileName\"");
readfile($file); 
```

不幸的是，我们注意到最终用户无法恢复通过此脚本传递的下载。

有没有办法通过这种基于 PHP 的解决方案来支持可恢复下载？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-10-01T12:56:45.140

您需要做的第一件事是`Accept-Ranges: bytes`在所有响应中发送标头，告诉客户端您支持部分内容。然后，如果`Range: bytes=x-y` 收到带有标头的请求（带有`x`和`y`是数字），则解析客户端请求的范围，照常打开文件，`x`提前查找字节并发送下一个`y`字节`x`。还将响应设置为`HTTP/1.0 206 Partial Content`。

在没有测试任何东西的情况下，这或多或少可以工作：

```
$filesize = filesize($file);

$offset = 0;
$length = $filesize;

if ( isset($_SERVER['HTTP_RANGE']) ) {
    // if the HTTP_RANGE header is set we're dealing with partial content

    $partialContent = true;

    // find the requested range
    // this might be too simplistic, apparently the client can request
    // multiple ranges, which can become pretty complex, so ignore it for now
    preg_match('/bytes=(\d+)-(\d+)?/', $_SERVER['HTTP_RANGE'], $matches);

    $offset = intval($matches[1]);
    $length = intval($matches[2]) - $offset;
} else {
    $partialContent = false;
}

$file = fopen($file, 'r');

// seek to the requested offset, this is 0 if it's not a partial content request
fseek($file, $offset);

$data = fread($file, $length);

fclose($file);

if ( $partialContent ) {
    // output the right headers for partial content

    header('HTTP/1.1 206 Partial Content');

    header('Content-Range: bytes ' . $offset . '-' . ($offset + $length) . '/' . $filesize);
}

// output the regular HTTP headers
header('Content-Type: ' . $ctype);
header('Content-Length: ' . $filesize);
header('Content-Disposition: attachment; filename="' . $fileName . '"');
header('Accept-Ranges: bytes');

// don't forget to send the data too
print($data); 
```

我可能错过了一些明显的东西，而且我肯定忽略了一些潜在的错误来源，但这应该是一个开始。

[这里有部分内容](http://tools.ietf.org/id/draft-ietf-http-range-retrieval-00.txt)的描述，我在[fread](http://se.php.net/manual/en/function.fread.php)的文档页面上找到了一些关于部分内容的信息。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2010-12-15T15:05:38.327

**编辑**2017/01 - 我在 PHP >=7.0 [https://github.com/DaveRandom/Resume中编写了一个库来执行此操作](https://github.com/DaveRandom/Resume)

**编辑**2016/02 - 将代码完全重写为一组模块化工具，这是一个示例用法，而不是单一功能。以下评论中提到的更正已被纳入。

* * *

一个经过测试的工作解决方案（很大程度上基于上面 Theo 的回答），它在一组几个独立的工具中处理可恢复的下载。此代码需要 PHP 5.4 或更高版本。

该解决方案仍然只能处理每个请求的一个范围，但在任何情况下使用我能想到的标准浏览器，这都不会造成问题。

```
<?php

/**
 * Get the value of a header in the current request context
 *
 * @param string $name Name of the header
 * @return string|null Returns null when the header was not sent or cannot be retrieved
 */
function get_request_header($name)
{
    $name = strtoupper($name);

    // IIS/Some Apache versions and configurations
    if (isset($_SERVER['HTTP_' . $name])) {
        return trim($_SERVER['HTTP_' . $name]);
    }

    // Various other SAPIs
    foreach (apache_request_headers() as $header_name => $value) {
        if (strtoupper($header_name) === $name) {
            return trim($value);
        }
    }

    return null;
}

class NonExistentFileException extends \RuntimeException {}
class UnreadableFileException extends \RuntimeException {}
class UnsatisfiableRangeException extends \RuntimeException {}
class InvalidRangeHeaderException extends \RuntimeException {}

class RangeHeader
{
    /**
     * The first byte in the file to send (0-indexed), a null value indicates the last
     * $end bytes
     *
     * @var int|null
     */
    private $firstByte;

    /**
     * The last byte in the file to send (0-indexed), a null value indicates $start to
     * EOF
     *
     * @var int|null
     */
    private $lastByte;

    /**
     * Create a new instance from a Range header string
     *
     * @param string $header
     * @return RangeHeader
     */
    public static function createFromHeaderString($header)
    {
        if ($header === null) {
            return null;
        }

        if (!preg_match('/^\s*(\S+)\s*(\d*)\s*-\s*(\d*)\s*(?:,|$)/', $header, $info)) {
            throw new InvalidRangeHeaderException('Invalid header format');
        } else if (strtolower($info[1]) !== 'bytes') {
            throw new InvalidRangeHeaderException('Unknown range unit: ' . $info[1]);
        }

        return new self(
            $info[2] === '' ? null : $info[2],
            $info[3] === '' ? null : $info[3]
        );
    }

    /**
     * @param int|null $firstByte
     * @param int|null $lastByte
     * @throws InvalidRangeHeaderException
     */
    public function __construct($firstByte, $lastByte)
    {
        $this->firstByte = $firstByte === null ? $firstByte : (int)$firstByte;
        $this->lastByte = $lastByte === null ? $lastByte : (int)$lastByte;

        if ($this->firstByte === null && $this->lastByte === null) {
            throw new InvalidRangeHeaderException(
                'Both start and end position specifiers empty'
            );
        } else if ($this->firstByte < 0 || $this->lastByte < 0) {
            throw new InvalidRangeHeaderException(
                'Position specifiers cannot be negative'
            );
        } else if ($this->lastByte !== null && $this->lastByte < $this->firstByte) {
            throw new InvalidRangeHeaderException(
                'Last byte cannot be less than first byte'
            );
        }
    }

    /**
     * Get the start position when this range is applied to a file of the specified size
     *
     * @param int $fileSize
     * @return int
     * @throws UnsatisfiableRangeException
     */
    public function getStartPosition($fileSize)
    {
        $size = (int)$fileSize;

        if ($this->firstByte === null) {
            return ($size - 1) - $this->lastByte;
        }

        if ($size <= $this->firstByte) {
            throw new UnsatisfiableRangeException(
                'Start position is after the end of the file'
            );
        }

        return $this->firstByte;
    }

    /**
     * Get the end position when this range is applied to a file of the specified size
     *
     * @param int $fileSize
     * @return int
     * @throws UnsatisfiableRangeException
     */
    public function getEndPosition($fileSize)
    {
        $size = (int)$fileSize;

        if ($this->lastByte === null) {
            return $size - 1;
        }

        if ($size <= $this->lastByte) {
            throw new UnsatisfiableRangeException(
                'End position is after the end of the file'
            );
        }

        return $this->lastByte;
    }

    /**
     * Get the length when this range is applied to a file of the specified size
     *
     * @param int $fileSize
     * @return int
     * @throws UnsatisfiableRangeException
     */
    public function getLength($fileSize)
    {
        $size = (int)$fileSize;

        return $this->getEndPosition($size) - $this->getStartPosition($size) + 1;
    }

    /**
     * Get a Content-Range header corresponding to this Range and the specified file
     * size
     *
     * @param int $fileSize
     * @return string
     */
    public function getContentRangeHeader($fileSize)
    {
        return 'bytes ' . $this->getStartPosition($fileSize) . '-'
             . $this->getEndPosition($fileSize) . '/' . $fileSize;
    }
}

class PartialFileServlet
{
    /**
     * The range header on which the data transmission will be based
     *
     * @var RangeHeader|null
     */
    private $range;

    /**
     * @param RangeHeader $range Range header on which the transmission will be based
     */
    public function __construct(RangeHeader $range = null)
    {
        $this->range = $range;
    }

    /**
     * Send part of the data in a seekable stream resource to the output buffer
     *
     * @param resource $fp Stream resource to read data from
     * @param int $start Position in the stream to start reading
     * @param int $length Number of bytes to read
     * @param int $chunkSize Maximum bytes to read from the file in a single operation
     */
    private function sendDataRange($fp, $start, $length, $chunkSize = 8192)
    {
        if ($start > 0) {
            fseek($fp, $start, SEEK_SET);
        }

        while ($length) {
            $read = ($length > $chunkSize) ? $chunkSize : $length;
            $length -= $read;
            echo fread($fp, $read);
        }
    }

    /**
     * Send the headers that are included regardless of whether a range was requested
     *
     * @param string $fileName
     * @param int $contentLength
     * @param string $contentType
     */
    private function sendDownloadHeaders($fileName, $contentLength, $contentType)
    {
        header('Content-Type: ' . $contentType);
        header('Content-Length: ' . $contentLength);
        header('Content-Disposition: attachment; filename="' . $fileName . '"');
        header('Accept-Ranges: bytes');
    }

    /**
     * Send data from a file based on the current Range header
     *
     * @param string $path Local file system path to serve
     * @param string $contentType MIME type of the data stream
     */
    public function sendFile($path, $contentType = 'application/octet-stream')
    {
        // Make sure the file exists and is a file, otherwise we are wasting our time
        $localPath = realpath($path);
        if ($localPath === false || !is_file($localPath)) {
            throw new NonExistentFileException(
                $path . ' does not exist or is not a file'
            );
        }

        // Make sure we can open the file for reading
        if (!$fp = fopen($localPath, 'r')) {
            throw new UnreadableFileException(
                'Failed to open ' . $localPath . ' for reading'
            );
        }

        $fileSize = filesize($localPath);

        if ($this->range == null) {
            // No range requested, just send the whole file
            header('HTTP/1.1 200 OK');
            $this->sendDownloadHeaders(basename($localPath), $fileSize, $contentType);

            fpassthru($fp);
        } else {
            // Send the request range
            header('HTTP/1.1 206 Partial Content');
            header('Content-Range: ' . $this->range->getContentRangeHeader($fileSize));
            $this->sendDownloadHeaders(
                basename($localPath),
                $this->range->getLength($fileSize),
                $contentType
            );

            $this->sendDataRange(
                $fp,
                $this->range->getStartPosition($fileSize),
                $this->range->getLength($fileSize)
            );
        }

        fclose($fp);
    }
} 
```

示例用法：

```
<?php

$path = '/local/path/to/file.ext';
$contentType = 'application/octet-stream';

// Avoid sending unexpected errors to the client - we should be serving a file,
// we don't want to corrupt the data we send
ini_set('display_errors', '0');

try {
    $rangeHeader = RangeHeader::createFromHeaderString(get_request_header('Range'));
    (new PartialFileServlet($rangeHeader))->sendFile($path, $contentType);
} catch (InvalidRangeHeaderException $e) {
    header("HTTP/1.1 400 Bad Request");
} catch (UnsatisfiableRangeException $e) {
    header("HTTP/1.1 416 Range Not Satisfiable");
} catch (NonExistentFileException $e) {
    header("HTTP/1.1 404 Not Found");
} catch (UnreadableFileException $e) {
    header("HTTP/1.1 500 Internal Server Error");
}

// It's usually a good idea to explicitly exit after sending a file to avoid sending any
// extra data on the end that might corrupt the file
exit; 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-01T12:34:11.357

是的。支持字节范围。请参阅[RFC 2616 第 14.35 节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)。

这基本上意味着您应该读取`Range`标题，并从指定的偏移量开始提供文件。

这意味着您不能使用 readfile()，因为它服务于整个文件。相反，首先使用[fopen()](http://nl3.php.net/manual/en/function.fopen.php)，然后[fseek()](http://nl3.php.net/manual/en/function.fseek.php)到正确的位置，然后使用[fpassthru()](http://nl3.php.net/manual/en/function.fpassthru.php)来提供文件。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-12-11T14:37:56.847

这工作 100% 超级检查我正在使用它，没有问题了。

```
 /* Function: download with resume/speed/stream options */

         /* List of File Types */
        function fileTypes($extension){
            $fileTypes['swf'] = 'application/x-shockwave-flash';
            $fileTypes['pdf'] = 'application/pdf';
            $fileTypes['exe'] = 'application/octet-stream';
            $fileTypes['zip'] = 'application/zip';
            $fileTypes['doc'] = 'application/msword';
            $fileTypes['xls'] = 'application/vnd.ms-excel';
            $fileTypes['ppt'] = 'application/vnd.ms-powerpoint';
            $fileTypes['gif'] = 'image/gif';
            $fileTypes['png'] = 'image/png';
            $fileTypes['jpeg'] = 'image/jpg';
            $fileTypes['jpg'] = 'image/jpg';
            $fileTypes['rar'] = 'application/rar';

            $fileTypes['ra'] = 'audio/x-pn-realaudio';
            $fileTypes['ram'] = 'audio/x-pn-realaudio';
            $fileTypes['ogg'] = 'audio/x-pn-realaudio';

            $fileTypes['wav'] = 'video/x-msvideo';
            $fileTypes['wmv'] = 'video/x-msvideo';
            $fileTypes['avi'] = 'video/x-msvideo';
            $fileTypes['asf'] = 'video/x-msvideo';
            $fileTypes['divx'] = 'video/x-msvideo';

            $fileTypes['mp3'] = 'audio/mpeg';
            $fileTypes['mp4'] = 'audio/mpeg';
            $fileTypes['mpeg'] = 'video/mpeg';
            $fileTypes['mpg'] = 'video/mpeg';
            $fileTypes['mpe'] = 'video/mpeg';
            $fileTypes['mov'] = 'video/quicktime';
            $fileTypes['swf'] = 'video/quicktime';
            $fileTypes['3gp'] = 'video/quicktime';
            $fileTypes['m4a'] = 'video/quicktime';
            $fileTypes['aac'] = 'video/quicktime';
            $fileTypes['m3u'] = 'video/quicktime';
            return $fileTypes[$extention];
        };

        /*
          Parameters: downloadFile(File Location, File Name,
          max speed, is streaming
          If streaming - videos will show as videos, images as images
          instead of download prompt
         */

        function downloadFile($fileLocation, $fileName, $maxSpeed = 100, $doStream = false) {
            if (connection_status() != 0)
                return(false);
        //    in some old versions this can be pereferable to get extention
        //    $extension = strtolower(end(explode('.', $fileName)));
            $extension = pathinfo($fileName, PATHINFO_EXTENSION);

            $contentType = fileTypes($extension);
            header("Cache-Control: public");
            header("Content-Transfer-Encoding: binary\n");
            header('Content-Type: $contentType');

            $contentDisposition = 'attachment';

            if ($doStream == true) {
                /* extensions to stream */
                $array_listen = array('mp3', 'm3u', 'm4a', 'mid', 'ogg', 'ra', 'ram', 'wm',
                    'wav', 'wma', 'aac', '3gp', 'avi', 'mov', 'mp4', 'mpeg', 'mpg', 'swf', 'wmv', 'divx', 'asf');
                if (in_array($extension, $array_listen)) {
                    $contentDisposition = 'inline';
                }
            }

            if (strstr($_SERVER['HTTP_USER_AGENT'], "MSIE")) {
                $fileName = preg_replace('/\./', '%2e', $fileName, substr_count($fileName, '.') - 1);
                header("Content-Disposition: $contentDisposition;
                    filename=\"$fileName\"");
            } else {
                header("Content-Disposition: $contentDisposition;
                    filename=\"$fileName\"");
            }

            header("Accept-Ranges: bytes");
            $range = 0;
            $size = filesize($fileLocation);

            if (isset($_SERVER['HTTP_RANGE'])) {
                list($a, $range) = explode("=", $_SERVER['HTTP_RANGE']);
                str_replace($range, "-", $range);
                $size2 = $size - 1;
                $new_length = $size - $range;
                header("HTTP/1.1 206 Partial Content");
                header("Content-Length: $new_length");
                header("Content-Range: bytes $range$size2/$size");
            } else {
                $size2 = $size - 1;
                header("Content-Range: bytes 0-$size2/$size");
                header("Content-Length: " . $size);
            }

            if ($size == 0) {
                die('Zero byte file! Aborting download');
            }
            set_magic_quotes_runtime(0);
            $fp = fopen("$fileLocation", "rb");

            fseek($fp, $range);

            while (!feof($fp) and ( connection_status() == 0)) {
                set_time_limit(0);
                print(fread($fp, 1024 * $maxSpeed));
                flush();
                ob_flush();
                sleep(1);
            }
            fclose($fp);

            return((connection_status() == 0) and ! connection_aborted());
        }

        /* Implementation */
        // downloadFile('path_to_file/1.mp3', '1.mp3', 1024, false); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-08-22T18:17:27.890

无需“滚动自己的”PHP 代码即可解决此问题的一个非常好的方法是使用 mod_xsendfile Apache 模块。然后在 PHP 中，您只需设置适当的标头。阿帕奇开始做它的事。

```
header("X-Sendfile: /path/to/file");
header("Content-Type: application/octet-stream");
header("Content-Disposition: attachment; file=\"filename\""); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-05-09T13:47:40.940

如果您愿意安装新的 PECL 模块，**使用 PHP 支持可恢复下载的最简单方法**是通过`http_send_file()`，像这样

```
<?php
http_send_content_disposition("document.pdf", true);
http_send_content_type("application/pdf");
http_throttle(0.1, 2048);
http_send_file("../report.pdf");
?> 
```

来源：[http ://www.php.net/manual/en/function.http-send-file.php](http://www.php.net/manual/en/function.http-send-file.php)

我们用它来提供数据库存储的内容，它就像一个魅力！

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-04-25T15:36:15.347

最佳答案有各种错误。

1.  主要错误：它不能正确处理 Range 标头。`bytes a-b`应该表示`[a, b]`代替`[a, b)`, 并且`bytes a-`不被处理。
2.  小错误：它不使用缓冲区来处理输出。这可能会消耗过多的内存并导致大文件的速度降低。

这是我修改后的代码：

```
// TODO: configurations here
$fileName = "File Name";
$file = "File Path";
$bufferSize = 2097152;

$filesize = filesize($file);
$offset = 0;
$length = $filesize;
if (isset($_SERVER['HTTP_RANGE'])) {
    // if the HTTP_RANGE header is set we're dealing with partial content
    // find the requested range
    // this might be too simplistic, apparently the client can request
    // multiple ranges, which can become pretty complex, so ignore it for now
    preg_match('/bytes=(\d+)-(\d+)?/', $_SERVER['HTTP_RANGE'], $matches);
    $offset = intval($matches[1]);
    $end = $matches[2] || $matches[2] === '0' ? intval($matches[2]) : $filesize - 1;
    $length = $end + 1 - $offset;
    // output the right headers for partial content
    header('HTTP/1.1 206 Partial Content');
    header("Content-Range: bytes $offset-$end/$filesize");
}
// output the regular HTTP headers
header('Content-Type: ' . mime_content_type($file));
header("Content-Length: $filesize");
header("Content-Disposition: attachment; filename=\"$fileName\"");
header('Accept-Ranges: bytes');

$file = fopen($file, 'r');
// seek to the requested offset, this is 0 if it's not a partial content request
fseek($file, $offset);
// don't forget to send the data too
ini_set('memory_limit', '-1');
while ($length >= $bufferSize)
{
    print(fread($file, $bufferSize));
    $length -= $bufferSize;
}
if ($length) print(fread($file, $length));
fclose($file); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-01T12:42:22.990

是的，您可以为此使用 Range 标头。您需要再向客户端提供 3 个标头才能完整下载：

```
header ("Accept-Ranges: bytes");
header ("Content-Length: " . $fileSize);
header ("Content-Range: bytes 0-" . $fileSize - 1 . "/" . $fileSize . ";"); 
```

对于中断的下载，您需要通过以下方式检查 Range 请求标头：

```
$headers = getAllHeaders ();
$range = substr ($headers['Range'], '6'); 
```

在这种情况下，不要忘记使用 206 状态码提供内容：

```
header ("HTTP/1.1 206 Partial content");
header ("Accept-Ranges: bytes");
header ("Content-Length: " . $remaining_length);
header ("Content-Range: bytes " . $start . "-" . $to . "/" . $fileSize . ";"); 
```

您将从请求标头中获取 $start 和 $to 变量，并使用 fseek() 查找文件中的正确位置。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-03-14T06:57:45.777

这对我来说效果很好：[https ://github.com/pomle/php-serveFilePartial](https://github.com/pomle/php-serveFilePartial)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-03-14T11:27:12.257

启用了小型作曲家的类，其工作方式与 pecl http_send_file 相同。这意味着支持可恢复下载和限制。[https://github.com/diversen/http-send-file](https://github.com/diversen/http-send-file)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-10-03T13:31:03.150

您可以在任何浏览器中使用以下代码来支持字节范围请求

```
 <?php
$file = 'YouTube360p.mp4';
$fileLoc = $file;
$filesize = filesize($file);
$offset = 0;
$fileLength = $filesize;
$length = $filesize - 1;

if ( isset($_SERVER['HTTP_RANGE']) ) {
    // if the HTTP_RANGE header is set we're dealing with partial content

    $partialContent = true;
    preg_match('/bytes=(\d+)-(\d+)?/', $_SERVER['HTTP_RANGE'], $matches);

    $offset = intval($matches[1]);
    $tempLength = intval($matches[2]) - 0;
    if($tempLength != 0)
    {
        $length = $tempLength;
    }
    $fileLength = ($length - $offset) + 1;
} else {
    $partialContent = false;
    $offset = $length;
}

$file = fopen($file, 'r');

// seek to the requested offset, this is 0 if it's not a partial content request
fseek($file, $offset);

$data = fread($file, $length);

fclose($file);

if ( $partialContent ) {
    // output the right headers for partial content
    header('HTTP/1.1 206 Partial Content');
}

// output the regular HTTP headers
header('Content-Type: ' . mime_content_type($fileLoc));
header('Content-Length: ' . $fileLength);
header('Content-Disposition: inline; filename="' . $file . '"');
header('Accept-Ranges: bytes');
header('Content-Range: bytes ' . $offset . '-' . $length . '/' . $filesize);

// don't forget to send the data too
print($data);
?> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-03-14T17:30:49.963

谢谢西奥！您的方法不适用于流式传输 divx，因为我发现 divx 播放器正在发送字节 = 9932800-之类的范围

但它向我展示了如何做到这一点，谢谢：D

```
if(isset($_SERVER['HTTP_RANGE']))
{
    file_put_contents('showrange.txt',$_SERVER['HTTP_RANGE']); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-01T12:35:43.867

在 HTTP 中恢复下载是通过`Range`标头完成的。如果请求包含`Range`标头，并且如果其他指示符（例如`If-Match`, `If-Unmodified-Since`）表明自下载开始后内容没有更改，则给出 206 响应代码（而不是 200），表明您要返回的字节范围在`Content-Range`标头中，然后在响应正文中提供该范围。

不过，我不知道如何在 PHP 中做到这一点。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-10T12:33:54.770

# linux - bash 脚本从 shell 运行，但不是从 cron 作业运行

> ID：157342
> 
> 赞同：8
> 
> 时间：2008-10-01T12:32:13.250
> 
> 标签：linux, bash, cron

cron 安装是 vixie-cron

`/etc/cron.daily/rmspam.cron`

```
#!/bin/bash
/usr/bin/rm /home/user/Maildir/.SPAM/cur/*; 
```

我有这个简单的 bash 脚本，我想将它添加到 cron 作业中（之前还包括垃圾邮件学习命令），但这部分总是以“找不到文件或目录”而失败，据我所知，当 metachar 没有被正确插入时作为 cron 作业运行。如果我从命令行执行脚本，它工作正常。

我想知道为什么这不起作用，当然还有一个可行的解决方案:)

谢谢

编辑#1 在我获得热门问题徽章时又回到了这个问题。我第一次这样做，

```
#!/bin/bash
find  /home/user/Maildir/.SPAM/cur/ -t file | xargs rm 
```

并且最近正在阅读 xargs 手册页并将其更改为

```
#!/bin/bash
find  /home/user/Maildir/.SPAM/cur/ -t file | xargs --no-run-if-empty rm 
```

短 xargs 选项是 -r

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-01T12:38:11.927

如果目录中没有文件，则不会扩展通配符，直接传递给命令。没有名为“*”的文件，然后命令失败并显示“找不到文件或目录”。试试这个：

```
if [ -f /home/user/Maildir/.SPAM/cur/* ]; then
    rm /home/user/Maildir/.SPAM/cur/*
fi 
```

或者只是对 rm 使用“-f”标志。此命令的另一个问题是当命令行的最大长度有太多垃圾邮件时会发生什么。这样的事情总体上可能更好：

```
find /home/user/Maildir/.SPAM/cur -type f -exec rm '{}' + 
```

如果您有一个旧的 find 一次只执行 rm 一个文件：

```
find /home/user/Maildir/.SPAM/cur -type f | xargs rm 
```

这处理了太多的文件以及没有文件。感谢 Charles Duffy 在 find 中指出 -exec 的 + 选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T12:33:48.487

您是否在 cronjob 中指定脚本的完整路径？

```
00 3 * * * /home/me/myscript.sh 
```

而不是

```
00 3 * * * myscript.sh 
```

* * *

另一方面，在我可以访问的所有 linux 机器上，它都是**/bin/rm 。**您是否仔细检查过它确实是您机器上的**/usr/bin/rm**？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T12:41:29.607

尝试添加

```
MAILTO=your@email.address 
```

到你的 cron 文件的顶部，你应该收到任何输入/错误邮件给你。

还可以考虑将命令添加为 cronjob

```
0 30 * * * /usr/bin/rm /home/user/Maildir/.SPAM/cur/* 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T12:42:52.163

尝试使用 force 选项，忘记添加 rm 命令的路径。我觉得应该不需要...

```
rm -f 
```

这将确保即使目录中没有文件，rm 命令也不会失败。如果这是 shell 脚本的一部分，那么 * 应该可以工作。在我看来，您可能有一个空目录...

我知道脚本的其余部分正在执行，对吧？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-18T12:19:56.670

真的`rm`位于`/usr/bin/`您的系统上吗？我一直认为`rm`应该居住在`/bin/`.

# math - 编程需要数学吗？

> ID：157354
> 
> 赞同：117
> 
> 时间：2008-10-01T12:35:37.517
> 
> 标签：math

在大学期间，我碰巧和一位朋友争论过高级数学是否对任何资深程序员都是必要的。他曾经激烈地反对这一点。他说，程序员只需要高中或大学一年级数学的基本数学知识，不多不少，几乎所有的编程任务都可以完成，甚至不需要高级数学。然而，他认为算法是程序员的基础和必备资产。

我的立场是，所有计算机科学的进步几乎都依赖于数学的进步，因此，全面的数学知识将极大地帮助程序员处理现实世界的挑战性问题。

我仍然无法确定论点的哪一方是正确的。您能根据自己的经验告诉我们您的立场吗？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2008-10-05T05:28:16.293

要回答您提出的问题，我不得不说：“不，编程不需要数学”。但是，正如其他人在此线程中所建议的那样，我相信理解数学与能够“以算法方式思考”之间存在相关性。也就是说，能够抽象地思考数量、过程、关系和证明。

我大约 9 岁时开始编程，如果说我在那个阶段学到了很多数学知识，那将是牵强附会。但是，通过一些努力，我能够理解变量、for 循环、goto 语句（请原谅我，我是 Vic 20 BASIC 并且我还没有阅读任何 Dijkstra）和基本坐标几何，以便将图形放在屏幕上.

我最终完成了纯数学的荣誉学位，辅修了计算机科学。虽然我主要专注于分析，但我也学习了相当多的离散数学、数论、逻辑和可计算性理论。除了能够将统计学、概率论、向量分析和线性代数的一些想法应用于编程之外，我学习的数学很少直接适用于我本科期间的编程以及我之后从事的商业和研究编程。

然而，我坚信数学所要求的形式化思维方法——仔细推理、寻找反例、建立公理基础、发现概念之间的联系——在我处理大型复杂的编程项目时提供了巨大的帮助。

考虑运动员为他们的运动训练的方式。例如，毫无疑问，足球运动员的大部分训练时间都花在了基本的足球技能上。然而，为了提高他们的整体健康，他们也可能会花时间在健身房骑自行车或划船机、做举重等。

学习数学可以比作重量训练或交叉训练，以提高你的精神力量和编程耐力。练习基本的编程技能是绝对必要的，但学习数学是一项令人难以置信的脑力锻炼，可以提高你的核心分析能力。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-10-01T12:40:00.640

虽然编程可能不需要高等数学（除非您正在编程高等数学能力），但编程和数学的思维过程非常相似。您从已知事物的基础（公理，先前已证明的理论）开始，并尝试到达新的地方。您不能跳过步骤。如果您确实跳过了步骤，那么您需要填写空白。这是一个批判性的思维过程，使两者非常相似。

此外，数学家和程序员都在抽象地进行批判性思考。现实世界的事物由对象和变量表示。从具体到抽象的能力也将这两个领域联系起来。

很有可能，如果你擅长其中一项，那么你很可能擅长另一项。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-10-01T12:37:59.227

计算机科学！=编程

好吧，说真的，我认识英语和心理学专业的好程序员和坏程序员，还有一些计算机科学专业的程序员。作为开发人员，我钦佩的一些非常有名的人没有 CS 背景。例如，Larry Wall(Perl) 是一位语言学家。另一方面，它有助于了解您正在处理的领域，因为这样您至少可以查看您的数据是否有意义并帮助您的客户/用户深入了解他们真正想要的内容。是的，存在计算复杂性、高效数据结构和程序正确性的问题。这是你在计算机科学中学到的东西，在几乎任何领域都知道它很有用，但这既不是必要的，也不是充分的。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2010-03-02T23:45:23.303

我想我会成为第一个说你**确实**需要数学的人。正如其他人所说，数学对于发展的某些方面并不是那么重要，但批判性思维和结构化分析的基础非常重要。

更重要的是，数学对于理解调度程序、优化、排序、协议管理和计算机的许多其他方面等许多基础知识非常重要。尽管计算级别涉及的数学并不复杂（主要是高中代数），但理论和应用可能相当复杂，因为通过微积分对数学有扎实的理解将大有裨益。

没有它你能过得去吗，绝对，你不应该让不那么透彻的数学知识阻碍你，但如果你有机会，或者我愿意尽可能多地学习数学，微积分，数值理论，线性代数、组合学、实际应用，所有这些在广泛的计算机科学中都有实际应用和理论应用。

我认识的人在围栏两边都非常成功（那些对数学没有特别关注的人，以及那些上物理或数学学校的人），但在这两个群体中，他们都喜欢数值问题，学习算法和数学理论.

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2008-10-01T12:40:38.410

我有数学学位，但我不记得在我的职业生涯中要求过一次数学。它在训练我的逻辑思维方面很有用，但我没有使用流体动力学、量子理论或马尔可夫链编写任何代码。（我怀疑最后一个是最有可能出现的。）

大多数业务线开发人员大部分时间都不需要高级数学。有时了解三角函数会有所帮助，当然能够理解足够的数学来实现数学描述的算法可能很重要——但除此之外呢？不。

不要忘记，大多数程序员并不是在推进计算机科学——他们是在构建应用程序。我不需要知道先进的工程技术来驾驶一辆现代汽车，尽管这辆车几乎肯定是*通过*先进的工程技术得到改进的。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-10-01T12:41:01.560

我认为拥有高级逻辑（离散）数学真的很有帮助。这与集合论一起。在处理常见的计算机程序时，这些学科可以提供很大帮助。然而，我在大学里学的很多其他数学都是微积分，据我所知，它的用途非常有限。由于 90%（或类似的）编程都是用非常简单的数学来开发商业应用程序，我想说的是，在大多数情况下，你只需很少的数学知识就可以过关。然而，对布尔代数、逻辑、离散数学和集合论的良好理解确实可以让你更上一层楼。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2008-10-01T12:45:58.413

这取决于你在做什么。如果您进行大量 3D 编程，那么 3D 几何知识当然是必要的，您不同意吗？;-) 如果您想创建新的图像格式（如 JPG）或新的音频格式（如 MP3），如果您无法理解余弦或傅立叶变换，您也会迷失方向，因为这些是大多数有损压缩所基于的基础. 如果您对数学非常了解，则可以更好地解决许多其他问题。

还有许多其他的编程任务你会发现不需要太多的数学。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2008-10-01T13:20:10.250

我会在这里反其道而行之，说“是”

我从土木工程转向编程（混凝土糟透了！）。我的数学背景包括通常的第一年的东西、第二年和第三年的微积分（Diff EQ、体积积分、级数、傅里叶和拉普拉斯变换）和数值分析课程。

我发现我的数学在计算机编程方面非常缺乏。我缺少离散数学和逻辑的整个领域，我只能依靠大量的教科书库、维基百科和 Wolfram 来生存。大多数高级算法都基于高级数学，如果不进行广泛的研究，我无法开发高级算法（基本上相当于半个课程的工作量。）我当然无法想出新算法，因为我只是不没有像巨人肩膀那样站立的数学基础。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2010-03-02T23:33:08.527

如果您发现该主题足以吸引人来发布此内容，请继续并开始学习。剩下的就自然而然了。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2008-10-01T12:48:38.373

是的，不需要高等数学——如果你是商业编程的话——现成的软件。

但是，在处理核心问题时，例如：

*   计算轨迹以控制机器人
*   创建类似 AI 的应用程序以支持不确定性和自动推理
*   玩 3-D 运动和图形

一些高等数学知识可能会派上用场。这不像是“不属于这个世界”的问题。

我必须创建一个软件来尝试“预测”办公室所需的纸张数量（而且只是为了找出近似值的最佳方法是地狱）。

但是，您必须小心，因为在使用高级事物时很容易迷路-我的一个朋友使用图灵来存储动态菜单的状态只是为了正确显示它-嗯...也许他的想象太过分了。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2008-10-01T12:43:12.367

什么类型的编程？

根据我的商业经验，我不需要高等数学，但这在很大程度上取决于你所在的领域。

计算机图形学需要大量的高等数学。许多学术计算机编程需要高等数学。

所以说擅长数学的人和擅长编程的人之间往往存在相关性。

我希望这个空洞的答案会有所帮助。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-10-01T12:42:14.537

在某些领域，开发人员需要数学，但在其他领域几乎没用。

如果您是一名游戏开发人员并且必须经常使用物理 - 对数学的理解至关重要。如果您正在使用高级视觉控件 - 如果没有几何图形，您将无能为力。如果您打算进行一些财务计算 - 掌握扎实的统计知识会非常有帮助。

另一方面，在过去的 5 年里，我只有 2 或 3 个项目需要任何数量的数学。其中只有 1 次 Google 搜索没有帮助。

归根结底，即使是财务计算也经常是您的客户为您做的事情，并为您提供要实施的公式。

因此，如果您从事“应用软件”业务，您可能永远不会使用您的数学学位。如果你在学术软件领域，数学是至关重要的。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2008-10-01T14:05:57.657

我同意克里斯。我也会说“是”。但这取决于您的市场，如上所述。如果您只是创建一些基本的“现成”应用程序或编写工具来帮助您的日常工作......那么数学就没有那么重要了。

工程定制软件解决方案需要大量的问题解决和批判性思维。当存在数学背景时，最肯定会增强的技能。我的计算机工程学位辅修了数学，我将所有以数学为导向的背景归功于我为什么会成为今天的我。

那是我的 2 美分，我可以从上面的阅读中看出很多人不会同意。我鼓励所有人考虑一下，我并不是说没有数学背景就不能拥有这些技能，我只是说这些技能是拥有这种背景的副作用，可以对软件产生积极影响。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2010-03-03T00:31:15.610

以我的经验，编程需要数学，你无法摆脱它。整个编程都是基于数学的。

问题不是黑白，而是更加丰富多彩。问题不是你是否需要数学，而是需要多少。更高水平的数学将为您提供更多工具，并为您打开不同的思路。

例如，如果您只知道加法和减法，您就可以编程。当需要乘法时，您将不得不执行很多加法。乘法简化了重复的加法。代数允许人们在将数学应用到程序中之前对其进行简化。线性代数提供了转换图像的工具。布尔代数提供了减少所有这些`if`语句的机制。

不要忘记数学、逻辑和哲学的兄弟姐妹。逻辑将帮助您有效地使用`case`or`switch`语句。哲学将帮助您理解编写您正在修改的代码的人的想法。

是的，你不需要太多的数学来编写程序。有些程序可能比其他程序需要更多的数学。与那些了解较少的人相比，更多的数学知识会让你更有优势。在这个时代，人们需要他们可以获得的一切优势来获得这些工作。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2011-02-25T18:23:20.423

我从事专业编程已经 8 年了，从 12 岁开始我就将其作为一种爱好。

数学不是必须的，逻辑才是。数学非常有用，说没有必要就像说杀人不需要枪，你可以用刀。嗯，这是真的，但是那把枪让它变得容易多了。

有几个最基本的要求，你应该已经满足了。您需要了解基本的代数表达式和符号，以及常见的计算机等价物。例如，你需要知道指数是什么（3到3位是27），常见的计算机表达式是3^3。代数的通用符号在语言之间确实会发生变化，但其中许多都使用某种统一的方法。其他人（看着你的 LISP）没有。您还需要知道操作的顺序。

你需要理解算法思想。首先这个，然后这个，产生这个计算中使用的。有可能你明白这一点，或者你不明白，如果你不明白，这是一个相当困难的障碍；我发现这是你“得到”的东西，而不是你可以学到的东西。相反，有些人不会“得到”艺术。他们不应该成为画家。此外，CS 课程中有些学生无法弄清楚为什么这不起作用：x = z + w；z = 3; y = 5; 不是他们不懂加法，而是他们没有掌握明确表达的要求。如果他们理解它，计算机也应该理解它，对吗？如果你看不出上面三行有什么问题，那就不要成为程序员。

最后，您需要知道您的编程领域中的任何数学。会计软件可以停留在基本代数上。如果您正在编程物理，则需要了解物理（粗略）和 3 维几何（欧几里得）中的数学。如果您正在编写架构软件，则需要了解三角学。

这比数学走得更远；无论您要编程的领域是什么，您都需要充分了解基础知识。如果您是编程语言分析软件，您需要了解概率、统计、语法理论（多语言）等。

通常，某些领域需要或可以受益于您认为无关的知识。例如，如果您正在编写音频软件，您实际上需要了解三角函数来处理波形。

幅度也会改变事物。如果您正在对包含 1000 个项目的财务数据集进行排序，这没什么大不了的。但是，如果是 1000 万条记录，您将从实际了解向量数学并深入了解二进制级别的排序（系统如何按字母顺序排序？它如何知道 'a' 小于 'b '？）

你会发现，作为一名程序员，你的一般知识库将会爆炸式增长，因为每个项目都需要在直接的编程领域之外进行更多的学习。如果你对自学很敏感或懒惰，并且不喜欢每周花 10 多个小时做基本上“家庭作业”的想法，那么不要成为一名程序员。

如果你喜欢思维练习，如果你喜欢学习，如果你可以在没有计算器的情况下思考抽象的事物，或者没有素描板的设计，如果你对生活和爱好有广泛的品味，如果你自我批评并且可以扔掉'最喜欢的想法，如果你喜欢完善事物，那就成为一名程序员。不要将这个决定建立在数学上，而是建立在逻辑思考和学习的能力上。这些才是重要的；数学只是副产品。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2008-10-01T12:40:25.353

当然这取决于你想成为什么样的程序员，或者更好的是你的雇主希望你成为什么样的程序员。我认为微积分和代数是必不可少的，统计和线性规划确实是你公文包里的好工具，也许分析（导数、积分、函数......）可以不用。但是如果你想知道事情是如何工作的（例如电子学，或一些非平凡的算法），“高级”数学是你最好不要没有任何地方的东西。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2008-10-01T12:41:04.867

我所做的大部分编程都涉及用于研究的物理模拟，包括电磁学、量子力学和结构力学等。由于问题域具有与之相关的高级数学，因此如果不使用高级数学，我将很难解决它们。

所以你的问题的答案是 - 这取决于你想要做什么。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2008-10-01T12:42:43.613

如果您要编写一门新的编程语言，高级数学知识至关重要。或者您需要编写自己的算法。

然而，对于大多数日常编程——从网站到保险处理应用程序——只**需要**基本的数学。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2008-10-01T12:57:21.287

具有扎实数学（不仅仅是算术）或逻辑背景的人将很好地应对算法、变量使用、条件推理和数据结构。

*   不是每个人都可以设计 UI。
*   不是每个人都能编写高效的代码。
*   不是每个人都能清楚地评论和记录。
*   不是每个人都能做一个好的算法

数学会帮助你达到一个点，但只能达到一个点。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2008-10-01T14:44:05.867

我不认为高级数学知识是优秀程序员的必要条件，但根据个人经验，我认为对高级数学掌握得更好的程序员也会成为更好的程序员。这可能仅仅是因为他们有更合乎逻辑的思维，或者由于他们解决数学问题的经验而更合乎逻辑的观点。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2008-10-01T17:38:53.683

数学的基本概念是遵循、设计、理解、实现和使用算法。如果你不能做数学，那是因为你不能做这些事情，如果你不能做这些事情，那么你就不能成为一个有效的程序员。

常见的编程任务可能不需要任何特定的数学知识（例如，除非您正在执行诸如 3D 图形或物理模拟之类的任务，否则您可能不需要矢量代数和微积分），但基本技能是相同的，并且缺乏能力在一个领域中将与在另一个领域中相应缺乏能力相匹配。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2011-01-01T19:06:33.467

数学是创建程序的工具箱。我推荐 Cormen's Introduction to Algorithms。它涉及更多“数学”的东西。

```
- Greatest lowest limit (managing resources) 
- Random variables (game programming)
- Topological sort (adjusting spreadsheets)
- Matrix operations (3d graphics)
- Number theory (encryption)
- Fast fourier transforms (networks) 
```

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2008-10-01T12:43:39.603

我不认为高等数学是成为一名优秀程序员的必要条件 - 一如既往，这取决于你在编码什么。

当然，如果您从事 3D 图形编程，您将需要矩阵之类的东西。作为商业软件的作者，您可能需要统计数学。

但是，作为一名近 10 年的专业程序员（以及另外 10 年的业余爱好者）“高等数学”并不是我经常需要的。在大约 99.8% 的情况下，它只是一些智能组合中的加、减、除和乘法——在大多数情况下，它与算法有关，而不是数学。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2008-10-01T12:44:27.400

对于大多数程序员来说，学习高等数学很重要，因为它可以让你的大脑按照逻辑思考，一步一步地从一件事到另一件事。

然而，很少有编程工作需要高中数学以外的任何东西。我曾经使用过线性代数。我从来没有用过微积分。我每天都使用代数。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2008-10-01T13:14:41.150

数学知识通常对程序员很有用，图形设计技能、解谜能力、职业道德和许多其他技能和特质也是如此。很少有程序员擅长程序员可能擅长的一切。我不同意任何形式的陈述“你不是一个真正的程序员，除非你可以{*在这里插入最喜欢的编程能力*}”。

但我会警惕不会做数学的程序员。比不会画画的人更是如此。

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2010-03-02T23:29:26.943

我认为这真的取决于你想要做什么，但恕我直言，CS 和 OS 理论在这里比数学更重要，你真的只需要它们所涉及的数学。

例如，在现代操作系统中的许多调度程序背后，有很多调度理论和优化的 CS 背景。这是一个需要一些数学运算的例子，虽然不是很复杂。

但老实说，对于大多数东西，你不需要数学。您需要的是学习以 2 和 16 为基础的思考能力，例如心理 OR/AND 的能力。例如，如果您有一个字节，并且在该字节内有两个 3 位字段和 2 个浪费位，那么当字节值类似于 11 时，知道哪些位在哪些字段中处于活动状态将使事情变得比必须使用稍快一些笔和纸。

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2010-03-02T23:34:38.437

我大约在进入代数预科课程的同时开始编程。所以我不会说数学有那么重要，尽管它可以帮助某些类型的编程，尤其是函数式编程。

我还没有学过离散数学，但是我看到了很多关于编程的理论知识，这些东西都是用本课教授的数学符号编写的。

此外，请确保您知道如何计算任何基数，尤其是基数 2、8 和 16。

此外，真正让我了解一些概念的课程是预编程课程。我们学会了联合、交叉和所有快乐的东西，它几乎与按位数学完全相似。我们非常深入地介绍了布尔逻辑。我认为最有用的是我们学会了如何减少复杂的布尔语句。这非常方便：

```
(x|y) & (x|z) & (x|foo) 
```

可以简化为

```
x | (y & z & foo) 
```

我以前不太了解。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2010-03-03T03:11:23.197

好吧，您产生了许多响应，不，我没有全部阅读。我在这个中间，不，你当然不需要数学才能成为一名程序员。linux 中的汇编程序与设备驱动程序并不比另一个复杂，也不需要数学。

无论如何，您都不需要为此参加或通过数学课。

我同意编程的问题解决思维方式与数学解决方案的思维方式非常相似，因此数学可能很容易。或者相反，如果数学很难，那么编程可能会很困难。不需要课程或学位或任何纸张或奖杯，当然可以开始学习。

现在，如果您无法在头脑中、在纸上或使用计算器快速将十六进制转换为二进制再转换为十进制，那么您将会遇到困难。如果您想进入网络和其他涉及时序的事情，内核驱动程序通常会但不必这样做。你会挣扎的。我知道一长串拥有数学学位和/或计算机科学和/或工程学位的人在速率计算、每秒比特数、每秒字节数、你需要多少内存等方面遇到困难。在某种程度上，它可能被认为是一些人拥有和其他人必须努力实现的某种诀窍。

我的底线是我相信意志力，如果你想学习这些东西，你可以并且愿意，就这么简单。你不需要上课或花很多钱，例如 linux 和 qemu 可以让你忙碌很长一段时间，不同的 asm 语言等，内核开发、嵌入式等的易崩溃环境。你不仅限于此，但我不相信如果你不想，你就必须逃跑并参加任何课程。如果你想肯定会参加一些ee课程，一些cs课程和一些数学课程..

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2011-01-03T23:18:51.527

你需要数学。编程只不过是数学。理论物理学的任何发现都不会成为实际（适用）的含义，除非它们用数学解决方案来解释。如果不能在计算机上解释，尤其是在编程语言上，这些都无法通过计算解决。因此，不同的语言旨在解决特定的问题。但是对于通用和广泛传播的编程语言，如 java、c、c++，我们的许多编程任务涉及重复（连续）解决相同问题，如从数据库、文本文件中提取值、将它们放在 Windows（桌面、Web）上、操作相同的值，有时从类似的设备访问一些数据（但给定不同的品牌名称，不同的端口和令人头疼的问题）等，不涉及单一方法，

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2008-10-01T12:43:25.237

IMO，您可能需要数学能力，而不必在该领域拥有太多知识。所以你需要擅长数学的东西和你需要擅长编程的东西是相似的。

但总的来说，我不记得上次在日常编程中使用任何高级数学是什么时候了，所以没有。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2008-10-01T15:02:50.127

编程要求你掌握或至少学习两门学科。编程本身以及您的程序所针对的领域。如果你是写会计软件，你需要学习会计，如果你是编程机器人运动学，那么你需要了解正向和反向运动学。帐户可能只需要基本的数学技能，其他领域需要其他类型的数学。

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2008-10-01T17:07:36.473

编程是计算机科学的工具。

在许多编程领域，数学处于次要地位。如果您不知道如何快速排序，请下载一个模块来为您完成。你不懂椭圆曲线，没问题，买个[AES](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)加密模块。

* * *

现在是计算机科学。是的，你需要更高水平的数学。毫无疑问。密码学、操作系统、编译器构造、机器学习、编程语言等等都需要某种形式的高等数学（微积分、离散、线性、复数）才能完全理解。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2008-10-01T12:39:31.237

不，不需要数学。毕业后什么都没做过，可能忘记了我掌握了什么小微积分。

把它想象成一辆汽车。您认为牵引力控制和 ABS 制动之类的东西背后有多少数学/物理？很多。你需要知道多少数学才能使用这些工具？没有任何。

编辑：要添加的一件事。工业在这里可能很重要。在研究公司工作的程序员，或者为那辆车编写嵌入式牵引力控制系统的程序员，可能比普通的商业工具程序员更需要数学。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2008-10-01T15:07:51.427

保持观点很重要。学习数学、高级数学、计算等非常适合思维过程，许多编程职位都期望并可能利用数学和数学概念。但是许多编程工作根本不使用数学。

计算机科学作为一门数学学科，当然需要大量的数学知识。但是很少有编程工作是comp sci的衍生品。CS是一门非常具体的学科。IT 学校现在将软件工程作为独立于 CS 的学科是有原因的。它们是非常不同的领域。

例如，Comp Sci 并没有让您为大多数 Web 应用程序的世界做好准备。并且软件工程不会让您为编译器设计和内核开发做好充分准备。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2008-10-01T18:16:07.277

远射不需要，但是...

举个简单的例子——如果不了解几何，你就不能用正方形和矩形做很多事情。（每个程序员都有/得到几何，所以这只是一个例子）。

没有三角学，有些事情很难做到。尝试在不了解三角学的情况下画一个模拟时钟——你可以做到，但你必须经历的过程本质上是重新发明三角学。

微积分很有趣。除非您设计游戏，否则您可能永远不需要它，但微积分会教您如何为更“真实世界”的事物建模。例如，如果您尝试模拟一棵树的倒下，要在拱门的每个点上获得正确的速度，您可能需要大量的数学运算。

另一方面，这只是一个准确的问题。你可以用微积分做的任何事情，你都可以用循环和近似来做。

除此之外，为了使事物更加逼真，您可能需要分形和更高级的数学。

如果您正在对网站和数据库进行编程，则几乎不需要代数 101。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2008-12-23T14:45:52.123

当我使用计算机解决固体力学和传热问题时，我使用了大量的数学知识。线性代数、数值方法等

由于我正在编写将信息从关系数据库传递到基于 Web 的用户界面的业务应用程序，因此我从未接触过任何这些知识。

我仍然会向任何人推荐更好的数学背景。

离散数学对开发人员非常有帮助；我没有接受过正规培训。

我认为“[编程集体智能](https://rads.stackoverflow.com/amzn/click/com/0596529325)”中列出的技术与我作为 ME 所做的事情相去甚远，可能会落入我现在正在做的商业应用程序中。Netflix 无疑从中取得了不错的成就。这种群体情报的东西似乎正在上升。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2008-12-23T14:59:21.457

回答这个问题：*没有。*

数学天赋和编程天赋：相关性强，几乎没有因果关系。

一个当然不是另一个的先决条件，并且提高你的数学技能不会让你成为一个更好的程序员，除非你在一个数学非常不可或缺的专业领域（3D 图形、统计编程等）进行编程.)

也就是说，数学背景当然不会受到伤害，并且在某些情况下会极大地帮助你。正如其他人所指出的那样，数学和编程所涉及的思维过程非常相似。如果你有一个天赋，你可能会发现你有另一个天赋。

如果我要向程序员推荐数学要求，那就是一些基本的统计数据。几乎所有的编程工作都需要某种形式的小报告。

当您开始做更多高级和/或有趣的事情时，对数学的需求确实会增加一点。游戏非常注重数学，因此您确实需要了解不同算法的成本的性能关键型应用程序。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2008-12-23T15:21:16.700

我将和你坐在篱笆上……有很多好的论据，支持和反对，而且大多数都同样有效。那么哪个是正确的答案？

两者……视情况而定。这不是“如果你不支持我们，你就是反对我们”的情况。

数学的许多方面确实使编程领域变得更加容易：几何、代数、三角函数、线性方程、二次方程、导数等。事实上，许多最高性能的“算法”都以数学原理为核心。

正如 Jon 所指出的，他拥有数学学位，但在编程世界中，他几乎不使用这些知识。我建议他确实比他可能认为的更多地使用数学，尽管是不自觉的……好吧，也许不是量子力学，而是更基本的原理。每次我们布置 GUI 时，我们都会使用数学原理以美观的方式进行设计，我们不会有意识地这样做 - 但我们确实这样做了。

在商业世界中，我们很少考虑我们在软件中使用的数学 - 在我们编写的软件的许多方面，它只是完成相同单调任务的标准算法，以帮助商业世界赶上技术可用的。

如果没有有意识地在我们的软件中使用数学，就很容易跳过整个职业生涯。但是，了解数学有助于简化编程的许多方面。

我认为这个问题真的可以归结为：“编程需要*高级*数学吗？” 当然，对于*这个*问题，答案是否定的……除非您要开始编写和/或破解加密算法（这是一个有趣的主题）或使用 Mil 指出的液压方程或流量控制系统（就像我过去一样）。但我要补充一点，虽然基本数学可能不是*必需*的，但它会让你的生活更轻松。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2009-01-30T21:45:25.440

我有数学学位，我不能说它对我有任何帮助。（我开发通用网络应用程序，没有任何科学性）。我喜欢与其他没有数学学位的开发人员一起工作，因为他们似乎跳出了我的“数学”框框思考并强迫我做同样的事情。

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2009-03-19T21:13:28.833

**必要的！=足够的**

拜托了伙计们！标题说“**必要**”，我认为这充其量是能够很好地编程的**充分条件。**就像他们有许多充分但非必要的条件：5 年经验、CS 学位或任何科学背景。

有些人甚至会争辩说，诗人或英语专业可以让你成为一名优秀的 API 设计师，或者艺术家可以擅长 UI/Web 编程。

但是这些显然不是保证，就像知道数学可能不会让你成为一个好的程序员一样，但你可以像其他人一样破解一些 C++ 或 F# ......

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2010-02-05T02:53:57.857

我的回答绝对不是。我曾经/现在（现在失业，感谢印度）担任计算机程序员 25 年以上。而且，在我的整个职业生涯中，我从未遇到过只需要基本数学技能的程序 LOGIC。除非您每天使用超出基本数学技能的数学，否则对高级数学的需求为零。在公司层面，任何复杂的数学都将被提交给静态学家或数学家，他们将为程序员提供必要的伪代码，并且双方将在最终产品的彻底测试中合作。最终，球在数学书呆子的球场上。在任何级别，除非您是数学家/静态学家/高级程序员，否则让程序员负责复杂的高级数学计算机程序的预期结果的想法是荒谬的，而且非常鲁莽。

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2010-03-02T23:57:57.500

根据我的经验，计算机科学学位的数学要求只是为了淘汰那些会失败的人。如果你不能通过微积分 I 和 II，你肯定不会通过关于编译器构造、数据库或操作系统理论的高级课程。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2010-03-03T00:07:51.130

我发现离散数学非常有用。我学过微积分，有时它可能也很有帮助，但我什么都不记得了。例如，我试图实现一个[DIS](http://en.wikipedia.org/wiki/Distributed_Interactive_Simulation)接口（它处理旋转速度和坐标变换之类的事情）。我花了一天的时间在城里开车寻找一本书来向我解释[四元数](http://en.wikipedia.org/wiki/Quaternion)（这是WWW之前的）。还有一段时间，我最终需要为一些工程师编写一个实现[n 线性插值](http://en.wikipedia.org/wiki/Interpolation#Linear_interpolation)的工具。如果你不知道这意味着什么，相信我我也不知道。幸运的是，那是*在*-WWW 之后。

我的建议是不要出汗。您可能会在一两个项目上受阻，但这些天并没有那么严重。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2010-03-03T00:28:12.850

作为一个大约 30 年前开始从事游戏工作的自学程序员，我肯定会说你需要尽可能多地获得数学知识。矩阵、四元数、光线追踪、粒子系统、物理引擎等东西确实需要良好的数学理解水平，我只希望我早点学会所有这些东西。

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2010-04-14T16:19:20.703

我是一名游戏程序员，与艺术家、游戏设计师、关卡设计师等一起工作。

团队中有*一个*懂数学的人是一个净加分，就像有一个玩各种游戏的人是一个加分，一个是我们目标受众的代表成员，一个经历过一些痛苦的作品的人，等等

通常，最了解数学的人是程序员（有时是游戏设计师），因为这些领域足够接近。但是，日复一日，游戏程序员除了 3D 几何和（有时）物理之外不需要太多数学。

在我学习的数学中，我发现统计数据最有用，尽管我有时会发现自己遗漏了一些概念。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2008-10-01T12:48:14.523

另请参见[编程 == 数学吗？](https://stackoverflow.com/questions/137550/is-programming-math)来自堆栈溢出。

虽然我认为编程不需要它，但我无法告诉你有多少次我能够使用[线性代数](http://en.wikipedia.org/wiki/Linear_algebra)概念来编写一个清晰而简短的解决方案来替换一个复杂的（有时是不正确的）解决方案。当任何图形或几何（甚至一些求解器）工作时，[矩阵](http://en.wikipedia.org/wiki/Matrix_(mathematics))知识以及如何使用它们也非常有用。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2008-10-01T12:49:10.667

有很多编程任务可以在没有高等数学背景的情况下完成。可以肯定地说，大多数可用的编程工作很少需要超过高中水平的数学。但是你不会编写软件，通过破解你的大学新生代数数学水平来帮助将航天飞机送入太空。因此，虽然高级数学通常对许多编程任务并不重要，但更困难的问题绝对需要它。学习数学还可以教授有价值的解决问题的技能，这些技能几乎可以在任何地方使用。我想你可以说大多数时候这不是必需的，但它肯定会在几乎所有时间都有帮助。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2008-10-01T13:03:37.870

对于您的通用 GUI 和 Web 应用程序，只需要基本的数学知识。

一生一次，您可能有一个奇怪的项目需要微积分或线性代数。

（如果您从事 3D 游戏编程或其他特定领域的编程，您可能每天都需要它）

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2008-10-01T14:24:14.197

在我看来，这个问题有一些好处。

正如 David Nehme 在此处发布的那样，计算机科学和编程是两个截然不同的学科。

我发现一个具有非常基本的高中和大学早期数学技能的程序员完全有可能成为一个称职的程序员。不过，对计算机科学专业的毕业生不太确定。

正如您正确指出的那样，算法创建过程与您处理数学的方式非常相关。即使这只是为了正确设计算法而必须完成的数学和分析过程类型的结果。

我也认为这在很大程度上取决于你在做什么，而不是取决于你的工作描述或技能。例如，如果编程和数学都是产生某种效果的工具，那么您肯定必须同时具备这两种能力（即：您正在为某种目的制作模型化程序）。虽然，如果编程是您活动的最终目标，那么很可能不需要数学。（即：您正在制作一个 Web 应用程序）

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2008-10-01T15:16:36.943

如果您在日常工作中需要高级数学作为程序员真的取决于您的任务。我需要他们。原因是我必须对管道系统进行水力计算，以便在管道系统建成之前对其进行代码评估。您永远不想因为压力不足或压力过大而站在坍塌的管道系统附近。;)

我想对于许多其他类型的“现实世界的模拟”，你也需要高等数学。

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2008-10-01T15:35:33.903

统计机器学习技术变得越来越重要。

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2008-10-01T16:21:48.050

[请参阅此较早的帖子](https://stackoverflow.com/questions/52176/what-are-the-core-mathematical-concepts-a-good-developer-should-know)

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2008-10-01T17:29:39.277

我觉得这个问题（我得到了很多）最好用一个类比来回答。

我们中的许多人举重。为什么？是因为我们正在为成为职业举重运动员的那一天做准备吗？我们会遇到举重作为工作要求吗？

当然不是。我们举重是因为它锻炼了我们的肌肉。它使我们保持健康和身材。一个健康的人会在其他方面表现更好：远足、建筑、跑步、睡眠等。

学习数学就像大脑的举重。它锻炼头脑并保持它的形状。你可能永远不会在你的职业生涯中使用微积分，但你的大脑会因此而变得更好。

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2008-10-01T17:43:53.437

商业编程：算术，一些代数

工程：数值分析

科学编程：天空是极限

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2008-10-01T20:54:01.733

在大学里你能学到的唯一有用的东西是理论的。

* * *

## 回答 #56

> 赞同：0
> 
> 时间：2008-10-01T22:24:58.130

数学既关乎技能本身，也关乎一种思维方式。甚至这也存在于几个层面。其他人指出，数学常见的分析和抽象技能对编程很有价值，这是一个层次。我还要争辩说，还有另一个级别包含从一个到另一个的精确类似物——例如关系数据库背后的集合论，这一切都被 SQL 语义所隐藏。

很多时候，“最好的”——我的意思是最高效和简洁的——解决方案是那些背后有一点数学的解决方案。如果您开始将面向数据的编程问题视为矩阵操作（很多都是这样），您通常可以从数学世界中找到新颖的解决方案。

显然，编程不需要成为数学专家，任何人都可以被教，但这是值得拥有的技能之一 - 并在新兵中寻找。

* * *

## 回答 #57

> 赞同：0
> 
> 时间：2008-10-01T23:24:12.153

在某些编程中，我认为数学是最有帮助的，但不是程序员。如果我不用我方便的花花公子计算器就可以加 2+2，我就很幸运了。

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2008-10-04T07:58:08.160

取决于编程任务。我会将“从数据库中获取数据并将其显示在网站上”风格的编程放在不太重要的一侧，然后放在另一侧的“视频游戏”（我在游戏中工作，我觉得我使用了一些随机的不同每天都有数学的味道，如果我知道更多，可能会使用更多）。

* * *

## 回答 #59

> 赞同：0
> 
> 时间：2008-11-13T08:17:50.107

这取决于你做什么：Web 开发、商业软件等。我认为对于这类东西，你不需要数学。

如果你想做计算机图形、音频/视频处理、人工智能、密码学等，那么你**需要**有数学背景，否则你根本做不到。

* * *

## 回答 #60

> 赞同：0
> 
> 时间：2008-12-23T13:41:19.333

想到两件事：

*   上下文是最重要的。如果您是游戏程序员或工程学科，那么数学可能对您的工作至关重要。我从事数据库和网络开发，因此高中水平的数学对我来说很好。
*   您很可能会重用他人预先构建的数学代码，而不是重新发明轮子，尤其是在加密和压缩等领域。（如果您在使用第三方物理工具或 3D 引擎进行游戏开发，这也可能适用。）在您的程序中使用久经考验的例程框架可以防止错误和潜在的安全漏洞——这绝对是一件好事。

* * *

## 回答 #61

> 赞同：0
> 
> 时间：2008-12-23T14:36:22.390

我认为某些数学是必不可少的。例如，每个软件工程师都应该知道并理解[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)和[O 表示法](http://en.wikipedia.org/wiki/O_notation)。

其他种类非常有用。在模拟中，我们经常需要做很多物理建模。如果你在做图形工作，你会经常发现自己需要编写坐标变换算法。在我 20 年的职业生涯中，我遇到过许多其他情况，我需要编写并求解联立的线性方程，以找出将哪些常数放入算法中。

* * *

## 回答 #62

> 赞同：0
> 
> 时间：2009-02-14T10:00:45.087

我承认我从来没有在编程中使用过任何高级数学，除了一些关于数学主题的宠物项目。

也就是说，我很喜欢与足够聪明的人一起工作，可以理解数学。掌握复杂和困难的东西有助于让你的大脑适应复杂和困难的编程问题。

* * *

## 回答 #63

> 赞同：0
> 
> 时间：2010-03-02T23:28:35.687

你不需要为编程学习数学。

但是学习数学可以训练你的思维纪律。因此，我认为数学对开发人员有好处。

* * *

## 回答 #64

> 赞同：0
> 
> 时间：2010-03-02T23:31:03.837

你不需要太多的数学。一些组合思维可以帮助您构建和减少快速执行的问题。能繁衍是好事。你是一名工程师，近似值很好。

* * *

## 回答 #65

> 赞同：0
> 
> 时间：2010-03-02T23:31:08.890

我认为对于您描述的任务，不需要太多的数学运算。但通常我认为对于真正的高级系统编程你：

*   根本不需要微积分
*   需要对计算机内部有很好的了解
*   需要大量的 CS 和操作系统理论
*   需要离散数学（包括算法和组合）

* * *

## 回答 #66

> 赞同：0
> 
> 时间：2010-03-02T23:32:15.720

不，你不需要知道任何数学（除了二进制/八进制/十六进制/十进制表示）来进行系统编程和类似的东西。

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2010-03-02T23:55:01.657

系统编程不是火箭科学:-) 恕我直言，任何**`good`**程序员都可以进行系统编程。然而，需要知道

*   算法（这需要很少的数学运算，但不会吓到优秀的程序员），
*   数据结构，以及
*   一些（不是全部）领域知识，例如操作系统、架构、编译器。

我认为最受追捧的品质是编写**精确**的代码和能力，如果需要，可以在上述任何项目中进行深入研究。

顺便说一句，这是我个人的理论，YMMV；我不认为自己是一个好的程序员！:-(

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2010-03-03T02:27:18.353

要做你想做的事，你不必知道数学，但你必须非常喜欢它。

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2010-03-03T11:28:21.463

在大学里，我们阅读了 Knuth、Graham 和 Patashnik 的《具体数学》一书。这是一本为计算机科学专业的学生选择主题的数学书。几年后，我再次检查这本书，发现我至少使用了书中的每个主题一次（斯特林数字除外）。

在大多数情况下，了解一些数学有助于以更少的工作、更优雅的方式解决问题或实现更快的解决方案。这也取决于您正在从事的工作类型。也就是说，当你专注于算法时，数学比专注于工程问题时更重要。

* * *

## 回答 #70

> 赞同：0
> 
> 时间：2010-11-09T19:11:02.253

我有两个数学学位。我希望我对数据库有更多的了解。

我的观点是，虽然能够找到多项式的根或能够证明 sqrt(2) 是无理数，但在抽象意义上是有用的，但不一定会让你成为更好的程序员。

* * *

## 回答 #71

> 赞同：0
> 
> 时间：2011-03-01T06:40:11.047

这是一个很好的答案，您不需要了解数学（我从不超出基本的操作顺序：PEMDAS 数学）哈哈，但我总能找到解决方案。SURE 早在 1970 年代的数学对于那些试图使用非常复杂的数学方程来有效地为 CPU 周期进行编程以避免循环等的程序员来说是极其重要的。

现在计算机功能强大，可以循环到 100 左右，以避免使用复杂的数学从长远来看不会真正损害您的程序，但是当然，您将作为观察者获得数学技能，甚至无需学习数学哈哈，这将提高您的高效编程能力.

让我们面对现实吧，你知道的数学越多，你就越有可能不仅更好地优化程序，而且由于这个疯狂的数学方程式，你会在不阅读那些声明这是不可能的文章的情况下理解什么是可能的和什么是不可能的。

学习数学可以帮助你在没有实际经验的情况下理解事物是如何运作的。（我基于我的生活）。

这是我的示例（一些压缩文章）。我一直在尝试，却不了解它背后的数学原理……至少从 700 开始？有缺陷/失败的尝试我现在​​知道更多可以做的事情（可能会再次失败），也知道 700 种有缺陷的看待它的方式。

如果我可能知道数学，我什至不会尝试那 700 次有缺陷的尝试，可能是因为我知道太多数学。但是我在不知道那么多数学的情况下选择的路径对我来说更有趣，更有教育意义。

但这只是我..我总是亲自动手..不是书虫；）

一些带来新的数学突破，另一些则带来更快更好优化的软件。

让这成为你们选择最适合自己的道路的一个教训，相信我两者都是有益的。

# bug-tracking - ClearQuest 表单上的非数据库字段

> ID：157357
> 
> 赞同：0
> 
> 时间：2008-10-01T12:36:13.630
> 
> 标签：bug-tracking, clearquest

有没有办法使用与数据库字段不对应的表单字段进行临时处理？

即我想补充：

*   临时字段**item1** , **item2**
*   数据库字段**总和**
*   **带有设置sum** = **item1** + **item2**的记录挂钩的按钮

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T23:04:25.227

据我所知，ClearQuest 根本不可能。我尝试做类似的事情，我们的 IBM 顾问告诉我，唯一的方法是为所有变量创建一个 DB 字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-09T16:26:58.573

您不能真正将数据附加到表单字段 - 这些是基础数据的表示，而不是脚本直接与之交互的东西。

将临时数据添加到基础记录（实体）本身听起来也不太可能。也许可以滥用 perl API 并将数据动态附加到实体对象，但我个人不会尝试，那么你很可能会在 CQ 的一时兴起时丢失数据 ;-)

然而，这并不意味着不可能有临时数据。在我看来，最好的方法是使用明确用于此目的的会话对象。

从帮助文件：

> IBM Rational ClearQuest 支持使用会话范围的变量来存储信息。创建会话范围的变量后，您可以使用可以访问 Session 对象的函数或子例程（包括挂钩）通过当前 Session 对象访问它们。当前会话结束时，与该会话对象关联的所有变量都将被删除。当用户注销或对 Session 对象的最终引用不复存在时，会话结束。

[在file:///C:/Program%20Files/Rational/ClearQuest/doc/help/cq_api/c_session_vars.htm](http://file:///C:/Program%20Files/Rational/ClearQuest/doc/help/cq_api/c_session_vars.htm)中有一些关于这个主题的有用文档（当然，假设默认安装在 Windows 机器上。）

将其中的代码示例翻译成您想要的，首先将您计算的数据存储在会话对象中：

```
$session->SetNameValue("item1", $value1);
$session->SetNameValue("item2", $value2); 
```

然后在您的计算挂钩中检索存储的值并设置该总计字段的值，如下所示：

```
my $item1 = GetNameValue("item1");
my $item2 = GetNameValue("item2");
my $sum = $item1 + $item2;

$entity->SetFieldValue("some_totals_record", $sum); 
```

当然适应口味;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-18T19:43:01.140

ClearQuest 模式设计者经常在他们的记录类型中包含“临时”字段。他们这样做是为了对钩子执行操作以生成另一个值。

例如，对于 Notes 字段，有一个“临时”Notes_entry 字段，用户可以在其中键入最新的注释，并且在保存记录时，该值将添加到 Notes_Log 字段。下次编辑记录时，Notes_entry 字段将被清除，以便用户可以键入新的 Notes_entry。

# python - Python 日志记录中的准确时间戳

> ID：157359
> 
> 赞同：12
> 
> 时间：2008-10-01T12:36:17.017
> 
> 标签：python, logging, timer, timestamp

我最近一直在构建一个错误记录应用程序，并且正在寻找一种准确地为传入数据加上时间戳的方法。当我准确地说时，我的意思是每个时间戳都应该相对于彼此准确（无需同步到原子钟或类似的东西）。

我一直在使用 datetime.now() 作为第一个刺，但这并不完美：

```
>>> for i in range(0,1000):
...     datetime.datetime.now()
...
datetime.datetime(2008, 10, 1, 13, 17, 27, 562000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 562000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 562000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 562000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 578000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 578000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 578000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 578000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 578000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 609000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 609000)
datetime.datetime(2008, 10, 1, 13, 17, 27, 609000)
etc. 
```

第一秒样本的时钟之间的变化如下所示：

```
uSecs    difference
562000  
578000  16000
609000  31000
625000  16000
640000  15000
656000  16000
687000  31000
703000  16000
718000  15000
750000  32000
765000  15000
781000  16000
796000  15000
828000  32000
843000  15000
859000  16000
890000  31000
906000  16000
921000  15000
937000  16000
968000  31000
984000  16000 
```

所以看起来计时器数据只在我的机器上每 ~15-32ms 更新一次。当我们开始分析数据时，问题就来了，因为按时间戳以外的东西排序，然后再次按时间戳排序可能会使数据处于错误的顺序（按时间顺序）。如果时间戳准确到任何对时间戳生成器的调用都会给出唯一的时间戳，那就太好了。

我一直在考虑一些涉及使用添加到起始日期时间的 time.clock() 调用的方法，但希望有一种解决方案可以在同一台机器上的线程间准确工作。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-01T12:54:25.957

time.clock() 仅测量 Windows 上的挂钟时间。在其他系统上， time.clock() 实际上测量 CPU 时间。在那些系统上 time.time() 更适合挂钟时间，它的分辨率与 Python 可以管理的一样高 - 与操作系统可以管理的一样高；通常使用 gettimeofday(3)（微秒分辨率）或 ftime(3)（毫秒分辨率）。其他操作系统限制实际上使实际分辨率比这高得多。datetime.datetime.now() 使用 time.time()，所以直接使用 time.time() 不会更好。

作为记录，如果我在循环中使用 datetime.datetime.now()，我会看到大约 1/10000 秒的分辨率。通过查看您的数据，您的分辨率比这要粗得多。我不确定 Python 本身是否可以做任何事情，尽管您可以通过其他方式说服操作系统做得更好。

我似乎记得在 Windows 上，time.clock() 实际上（稍微）比 time.time() 更准确，但它测量的是自第一次调用 time.clock() 以来的挂钟，所以你必须记住“初始化” '它首先。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-01T13:55:57.153

您不太可能获得足够细粒度的控制来完全消除重复时间戳的可能性 - 您需要的分辨率小于生成日期时间对象所需的时间。您可能会采取其他几种方法来处理它：

1.  处理它。让你的时间戳保持不唯一，但依靠 python 的排序来处理重新排序问题。*首先*按时间戳排序，然后其他内容将保留时间戳排序 - 您只需小心每次始终从时间戳排序列表开始，而不是在同一个列表上进行多次排序。

2.  附加您自己的值以强制执行唯一性。例如。包括一个递增的整数值作为键的一部分，或者仅当时间戳不同时才附加这样的值。例如。

以下将保证唯一的时间戳值：

```
 class TimeStamper(object):
        def __init__(self):
            self.lock = threading.Lock()
            self.prev = None
            self.count = 0

         def getTimestamp(self):
             with self.lock:
                 ts = str(datetime.now())
                 if ts == self.prev:
                     ts +='.%04d' % self.count
                     self.count += 1
                 else:
                     self.prev = ts
                     self.count = 1
             return ts 
```

对于多个进程（而不是线程），它变得有点棘手。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-01T23:23:33.357

感谢大家的贡献——它们都非常有用。布赖恩的回答似乎最接近我最终的回答（即处理它，但使用一种唯一标识符 - 见下文），所以我接受了他的回答。我设法将所有各种数据接收器合并到一个线程中，现在使用我的新**AccurrateTimeStamp**类完成时间戳。只要时间戳是使用时钟的第一件事，我所做的就可以工作。

正如 S.Lott 规定的那样，如果没有实时操作系统，它们永远不会是绝对完美的。我真的只想要一些能让我看到相对于每个传入数据块的东西，当收到东西时，我下面的内容会很好地工作。

再次感谢大家！

```
import time

class AccurateTimeStamp():
    """
    A simple class to provide a very accurate means of time stamping some data
    """

    # Do the class-wide initial time stamp to synchronise calls to 
    # time.clock() to a single time stamp
    initialTimeStamp = time.time()+ time.clock()

    def __init__(self):
        """
        Constructor for the AccurateTimeStamp class.
        This makes a stamp based on the current time which should be more 
        accurate than anything you can get out of time.time().
        NOTE: This time stamp will only work if nothing has called clock() in
        this instance of the Python interpreter.
        """
        # Get the time since the first of call to time.clock()
        offset = time.clock()

        # Get the current (accurate) time
        currentTime = AccurateTimeStamp.initialTimeStamp+offset

        # Split the time into whole seconds and the portion after the fraction 
        self.accurateSeconds = int(currentTime)
        self.accuratePastSecond = currentTime - self.accurateSeconds

def GetAccurateTimeStampString(timestamp):
    """
    Function to produce a timestamp of the form "13:48:01.87123" representing 
    the time stamp 'timestamp'
    """
    # Get a struct_time representing the number of whole seconds since the 
    # epoch that we can use to format the time stamp
    wholeSecondsInTimeStamp = time.localtime(timestamp.accurateSeconds)

    # Convert the whole seconds and whatever fraction of a second comes after
    # into a couple of strings 
    wholeSecondsString = time.strftime("%H:%M:%S", wholeSecondsInTimeStamp)
    fractionAfterSecondString = str(int(timestamp.accuratePastSecond*1000000))

    # Return our shiny new accurate time stamp   
    return wholeSecondsString+"."+fractionAfterSecondString

if __name__ == '__main__':
    for i in range(0,500):
        timestamp = AccurateTimeStamp()
        print GetAccurateTimeStampString(timestamp) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-01T14:24:59.453

“时间戳应该相互准确”

为什么是时间？为什么不是序列号？如果它是客户端-服务器应用程序的任何客户端，网络延迟会使时间戳变得随机。

您是否匹配了一些外部信息源？说另一个应用程序的日志？同样，如果有网络，那么这些时间不会太接近。

如果您必须在不同的应用程序之间进行匹配，请考虑传递 GUID，以便两个应用程序都记录 GUID 值。然后，您可以绝对确定它们匹配，无论时间差异如何。

如果您希望*相对*顺序完全正确，那么您的记录器按照收到的顺序为每条消息分配一个序列号就足够了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-01T13:44:13.593

这是一个关于 Python 计时精度的主题：

[Python - time.clock() vs. time.time() - accuracy?](https://stackoverflow.com/questions/85451/python-timeclock-vs-timetime-accuracy)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-03-05T09:46:44.900

自从这个问题被提出和回答以来的几年前，这个问题已经得到了解决，至少对于 Windows 上的 CPython。在 Win7 64bit 和 Windows Server 2008 R2 上使用下面的脚本，我得到了相同的结果：

*   `datetime.now()`提供 1ms 的分辨率和小于 1ms 的抖动
*   `time.clock()`提供优于 1us 的分辨率和远小于 1ms 的抖动

剧本：

```
import time
import datetime

t1_0 = time.clock()
t2_0 = datetime.datetime.now()

with open('output.csv', 'w') as f:
    for i in xrange(100000):
        t1 = time.clock()
        t2 = datetime.datetime.now()
        td1 = t1-t1_0
        td2 = (t2-t2_0).total_seconds()
        f.write('%.6f,%.6f\n' % (td1, td2)) 
```

结果可视化： ![在此处输入图像描述](https://i.stack.imgur.com/PHaYA.jpg)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T15:51:52.890

我要感谢 J. Cage 的最后一篇文章。

对于我的工作，跨流程和平台的事件“合理”时间安排是必不可少的。显然有很多地方会出现偏差（时钟漂移、上下文切换等），但是我认为这种准确的计时解决方案将有助于确保记录的时间戳足够准确以查看其他错误来源.

也就是说，[当 MicroSeconds Matter](http://www.ibm.com/developerworks/library/i-seconds/ "当微秒很重要")中解释了一些我想知道的细节。例如，我认为 time.clock() 最终会换行。我认为要让它在一个长期运行的过程中工作，你可能必须处理它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-09T01:59:53.100

如果您想要 Python 中的微秒*分辨率*（不准确）时间戳，在*Windows 中，*您可以使用 Windows 的 QPC 计时器，如我在此处的回答所示：[如何在 Python 中获取毫秒和微秒分辨率的时间戳](https://stackoverflow.com/questions/38319606/how-to-get-millisecond-and-microsecond-resolution-timestamps-in-python)。我还不确定如何在 Linux 中执行此操作，所以如果有人知道，请在上面的链接中发表评论或回答。

# winapi - 无边框任务栏项目：使用右键菜单 (VB6)

> ID：157375
> 
> 赞同：2
> 
> 时间：2008-10-01T12:39:49.940
> 
> 标签：winapi, vb6

即使`BorderStyle`设置为 0，也可以通过打开`ShowInTaskbar`属性或直接使用 windows api来强制窗口显示在任务栏上`SetWindowLong Me.hwnd, GWL_EXSTYLE, GetWindowLong(Me.hwnd, Win.GWL_EXSTYLE) Or Win.WS_EX_APPWINDOW`：但是，此类任务栏条目在其任务栏条目中缺少右键单击菜单。右键单击它们不会显示上下文菜单。有没有办法将标准或自定义处理程序附加到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T14:24:32.357

如果没有黑客，我想你会被困在这里，我很抱歉。当您设置 VB6 无边框属性时，您固有地禁用了控件菜单。控制菜单（通常通过右键单击窗口标题栏或左键单击左上角的图标激活）是在任务栏中右键单击窗口时显示的内容。

现在，如果您有心情破解，您可能能够以用户不知道差异的方式“模拟”行为。我从[usenet 上的这个消息线程中](http://www.codenewsgroups.net/group/microsoft.public.vb.general.discussion/topic7522.aspx)得到了这个想法。

基本上，听起来您可以使用两种形式破解它。一种形式立即最小化，并成为您在任务栏中的“存根”。另一种形式是您当前正在设计的形式（我们将其称为“主”形式）。存根表单是实际加载和显示主表单的内容。

存根表单不是无边界的，并且不能停用控制菜单。它位于屏幕外并以尽可能小的尺寸放置。您将响应其表单级事件，然后使用这些事件将适当的行为传达给无边界表单。

这是黑客的一般要点。如果我现在不在工作，我会创建一个简单的 VB6 项目，看看能否让它为您工作。

# sqlite - 如何确定 SQLite 索引是否唯一？（使用 SQL）

> ID：157392
> 
> 赞同：18
> 
> 时间：2008-10-01T12:42:09.903
> 
> 标签：sqlite

我想通过 SQL 查询找出索引是否是唯一的。我正在使用 SQLite 3。

我尝试了两种方法：

```
SELECT * FROM sqlite_master WHERE name = 'sqlite_autoindex_user_1' 
```

这将返回有关索引的信息（“type”、“name”、“tbl_name”、“rootpage”和“sql”）。请注意，SQLite 自动创建索引时，sql 列为空。

```
PRAGMA index_info(sqlite_autoindex_user_1); 
```

这将返回索引中的列（“seqno”、“cid”和“name”）。

还有其他建议吗？

**编辑：**上面的例子是一个自动生成的索引，但我的问题是关于索引的。例如，我可以使用“CREATE UNIQUE INDEX index1 ON visit (user, date)”创建一个索引。似乎没有 SQL 命令会显示我的新索引是否是唯一的。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-09-21T10:07:43.217

```
PRAGMA INDEX_LIST('table_name'); 
```

返回一个包含 3 列的表：

1.  `seq`索引的唯一数字 ID
2.  `name`索引名称
3.  `unique``UNIQUE`唯一性标志（如果索引为非零。）

**编辑**

从 SQLite 3.16.0 开始，您还可以使用表值杂注函数，其优点是您可以`JOIN`搜索特定的表和列。请参阅[@mike-scotty 的回答](https://stackoverflow.com/a/53629321/12048)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T07:11:49.790

由于没有人想出一个好的答案，我认为最好的解决方案是：

*   如果索引以“sqlite_autoindex”开头，则它是为单个 UNIQUE 列自动生成的索引
*   否则，在表 sqlite_master 的 sql 列中查找 UNIQUE 关键字，如下所示：

    SELECT * FROM sqlite_master WHERE type = 'index' AND sql LIKE '%UNIQUE%'

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T13:37:19.303

您可以以编程方式构建一个 select 语句来查看是否有任何元组指向多于一行。如果返回 foo、bar 和 baz 这三列，请创建以下查询

```
select count(*) from t
group by foo, bar, baz
having count(*) > 1 
```

如果返回任何行，则您的索引不是唯一的，因为不止一行映射到给定的元组。如果 sqlite3 支持派生表（我还没有需要，所以我不知道副手），你可以让它更简洁：

```
select count(*) from (
    select count(*) from t
    group by foo, bar, baz
    having count(*) > 1
) 
```

这将返回一个单行结果集，表示重复元组集的数量。如果为正，则您的索引不是唯一的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T22:50:30.913

你很接近：

1）如果索引以 开头`"sqlite_autoindex"`，则它是主键的自动生成索引。但是，这将在`sqlite_master`或`sqlite_temp_master`表中，具体取决于被索引的表是否是临时的。

2）您需要注意包含 substring 的表名和列`unique`，因此您要使用：

```
SELECT * FROM sqlite_master WHERE type = 'index' AND sql LIKE 'CREATE UNIQUE INDEX%' 
```

请参阅有关[创建索引的 sqlite 网站文档](http://sqlite.org/lang_createindex.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-05T09:45:05.077

从 sqlite 3.16.0 开始，您还可以使用编译指示函数：

```
SELECT distinct il.name
  FROM sqlite_master AS m,
       pragma_index_list(m.name) AS il,
       pragma_index_info(il.name) AS ii
 WHERE m.type='table' AND il.[unique] = 1; 
```

上面的语句将列出唯一索引的所有名称。

```
SELECT DISTINCT m.name as table_name, ii.name as column_name
  FROM sqlite_master AS m,
       pragma_index_list(m.name) AS il,
       pragma_index_info(il.name) AS ii
 WHERE m.type='table' AND il.[unique] = 1; 
```

如果列是唯一索引的一部分，上述语句将返回所有表及其列。

从[文档](https://www.sqlite.org/pragma.html)：

> 在 SQLite 版本 3.16.0 (2017-01-02) 中添加了 PRAGMA 功能的表值函数。SQLite 的早期版本无法使用此功能。

# python - Python 2.5 字典 2 键排序

> ID：157424
> 
> 赞同：15
> 
> 时间：2008-10-01T12:50:19.447
> 
> 标签：python

我有一个包含 200,000 个项目的字典（键是字符串，值是整数）。

打印按降序值然后升序键（即2键排序）排序的项目的最佳/最pythonic方法是什么？

```
 a={ 'keyC':1, 'keyB':2, 'keyA':1 }
b = a.items()
b.sort( key=lambda a:a[0])
b.sort( key=lambda a:a[1], reverse=True )
print b
>>>[('keyB', 2), ('keyA', 1), ('keyC', 1)] 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-01T12:56:01.383

您不能对字典进行排序。您必须对项目列表进行排序。

以前的版本是错误的。当你有一个数值时，很容易以相反的顺序排序。这些将做到这一点。但这并不普遍。这仅适用于该值是数字。

```
a = { 'key':1, 'another':2, 'key2':1 }

b= a.items()
b.sort( key=lambda a:(-a[1],a[0]) )
print b 
```

这是另一种选择，使用显式函数而不是 lambda 和 cmp 而不是 key 选项。

```
def valueKeyCmp( a, b ):
    return cmp( (-a[1], a[0]), (-b[1], b[0] ) )

b.sort( cmp= valueKeyCmp )
print b 
```

更通用的解决方案实际上是两种不同的类型

```
b.sort( key=lambda a:a[1], reverse=True )
b.sort( key=lambda a:a[0] )
print b 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-01T14:11:59.640

```
data = { 'keyC':1, 'keyB':2, 'keyA':1 }

for key, value in sorted(data.items(), key=lambda x: (-1*x[1], x[0])):
    print key, value 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T13:00:26.007

最pythonic的方法是更多地了解实际数据——特别是你可以拥有的最大值——然后这样做：

```
def sortkey((k, v)): 
    return (maxval - v, k)

items = thedict.items()
items.sort(key=sortkey) 
```

但除非您已经知道最大值，否则搜索最大值意味着在字典中循环额外的时间（使用`max(thedict.itervalues())`），这可能会很昂贵。或者，S.Lott 解决方案的 keyfunc 版本：

```
def sortkey((k, v)): 
    return (-v, k)

items = thedict.items()
items.sort(key=sortkey) 
```

不关心类型的替代方法是比较函数：

```
def sortcmp((ak, av), (bk, bv)):
    # compare values 'in reverse'  
    r = cmp(bv, av)
    if not r:
        # and then keys normally
        r = cmp(ak, bk)
    return r

items = thedict.items()
items.sort(cmp=sortcmp) 
```

这个解决方案实际上适用于您想要在同一个键中混合升序和降序排序的任何类型的键和值。如果您重视简洁，您可以将 sortcmp 编写为：

```
def sortcmp((ak, av), (bk, bv)):
    return cmp((bk, av), (ak, bv)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T13:08:50.387

你可以使用这样的东西：

```
dic = {'aaa':1, 'aab':3, 'aaf':3, 'aac':2, 'aad':2, 'aae':4}

def sort_compare(a, b):
    c = cmp(dic[b], dic[a])
    if c != 0:
        return c
    return cmp(a, b)

for k in sorted(dic.keys(), cmp=sort_compare):
    print k, dic[k] 
```

但是不知道它是多么pythonic :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T14:53:17.607

基于 Thomas Wouters 和 Ricardo Reyes 解决方案：

```
def combine(*cmps):
    """Sequence comparisons."""
    def comparator(a, b):
        for cmp in cmps:
            result = cmp(a, b):
            if result:
                return result
        return 0
    return comparator

def reverse(cmp):
    """Invert a comparison."""
    def comparator(a, b):
        return cmp(b, a)
    return comparator

def compare_nth(cmp, n):
    """Compare the n'th item from two sequences."""
    def comparator(a, b):
        return cmp(a[n], b[n])
    return comparator

rev_val_key_cmp = combine(
        # compare values, decreasing
        reverse(compare_nth(1, cmp)),

        # compare keys, increasing
        compare_nth(0, cmp)
    )

data = { 'keyC':1, 'keyB':2, 'keyA':1 }

for key, value in sorted(data.items(), cmp=rev_val_key_cmp):
    print key, value 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T04:43:43.673

```
>>> keys = sorted(a, key=lambda k: (-a[k], k)) 
```

或者

```
>>> keys = sorted(a)
>>> keys.sort(key=a.get, reverse=True) 
```

然后

```
print [(key, a[key]) for key in keys]
[('keyB', 2), ('keyA', 1), ('keyC', 1)] 
```

# svn - 使用 Perforce 而不是 Subversion 有什么好处？

> ID：157429
> 
> 赞同：66
> 
> 时间：2008-10-01T12:52:46.460
> 
> 标签：svn, perforce

我的团队已经使用 SVN 几年了。我们现在可以选择切换到 Perforce。

做出这样的转变有什么好处（和陷阱）？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-10-01T13:05:34.480

*   P4 在服务器上跟踪您的工作副本。这意味着
    1.  大型工作副本的处理速度要快得多。我曾经有一个大型 SVN 项目，一个简单的更新需要 15 分钟，因为它必须创建本地工作副本的树（数千个文件夹）。文件访问很慢。P4 将有关工作副本的信息存储在数据库中，因此任何操作都几乎是即时的。
    2.  如果你乱搞文件而不告诉服务器，你就有麻烦了！您不能只删除一个文件 - 您必须使用 P4 客户端删除一个文件，以便服务器知道。请注意，如果您在本地删除文件，则不会在后续更新时再次下载它，因为服务器认为您已经拥有它！当很多这样的事情发生并且我最终严重不同步时，我通常不得不清理我的本地副本并再次下载它，这可能很耗时。你*必须*小心这一点。
*   Explorer shell 扩展客户端（想想 TortoiseSVN）很糟糕并且完全无法使用。
*   有两个提供最佳功能的 GUI 客户端应用程序：P4Win 和 P4V，其中 P4V 更新且更易于使用，但功能并不丰富。
*   有 Visual Studio 和 Eclipse 插件，虽然没有很多高级特性，但效果相对较好。
*   一般来说，P4 提供的功能比 SVN 少得多，而且有时会让人感到困惑。
*   工作副本定义很好而且很灵活。我相信 P4 在这里优于 SVN：您可以为工作副本文件夹定义掩码并创建各种奇异的树，因此您只需将您想要的内容下载到您想要的确切位置，而无需手动进行多次结帐。当我在服务器上有千兆字节的东西并且只想要它的特定子集时，这非常方便。我在类似的情况下使用了 SVN，但麻烦得多。
*   P4 下的分支是……奇怪的。分支集和不同种类的分支以及令人困惑的 UI。不幸的是，我不记得有关此的太多细节。

除此之外，它非常标准。

我建议您保留 SVN，除非您处理庞大的代码库或讨厌 .svn 文件夹乱扔文件系统。SVN+TortoiseSVN 在大多数情况下要舒适得多。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-10-01T12:58:56.820

我目前在不同的项目中使用这两种方法。

*   perforce 分支机制更胜一筹。
*   perforce 冲突解决工具更好。
*   我真的很喜欢 perforce 强烈的变更列表概念。
*   Perforce 似乎更快。
*   设置和运行更容易。
*   我们的一些成员非常喜欢用于 perforce 的 MS Office 插件，我在 Mac 上，所以我无法使用它。

但

*   SVN 客户端更好，尤其是 eclipse 插件。
*   Perforce 更贵。

这些只是意见，所以也许这是一个糟糕的答案:)

如果我已经在使用其中一个，我将很难切换，因为两者似乎都没有比另一个提供真正显着的好处，但切换的中断可能很大。

更新：自从写这篇文章以来，我已经完全转向将 GIT 用于个人和商业目的。我会在任何一天通过 SVN 或 Perforce 选择它。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-01T13:33:44.693

你的团队评估过 Git 吗？它具有类似于 Perforce 中可用的功能，但是是免费的 (FOSS)。

与大型团队合作时，两者都是 SVN 的绝佳替代品。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-01T14:59:34.283

我在工作中使用 perforce，在家里使用 svn。

perforce GUI 非常好，但只有在你习惯了它之后。它肯定有一个学习曲线，当非程序员开始使用 perforce 时，通常需要一些时间才能获得概念。

乌龟很棒，它非常易于使用。我的律师妻子使用它颠覆了她所有的文件；）

分支很容易执行。事实上很容易，以至于人们没有太多理由分支。然后你整合，因​​为你分支了。它很容易成为你唯一要做的事情。

svn 被集成在更多的产品中。至少我使用的产品更多。这是一个很大的优势，因为如果您必须在开发环境之外使用任何一个，它们都会变得笨拙。

每隔一段时间，我们就会遇到 perforce 问题，它认为您的本地副本是最新的，但事实并非如此。然后你必须强制同步，然后如果它仍然不好，删除你的本地文件并重新同步。svn从来没有遇到过这样的问题。这实际上是一个大问题，因为您甚至不知道您正在处理旧副本。

另一件要考虑的事情是你为什么要改变。如果您有一个可以工作的系统，并且每个人都熟悉它并且对它感到满意，为什么要更换它呢？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-09T10:16:42.213

在 Perforce 网站上，他们有一篇比较两者的论文： [P4 vs SVN](http://www.perforce.com/sites/default/files/perforce_subversion.pdf)

显然，鉴于源代码，您必须意识到它强调了 Perforce 优于 SVN 的优势，但它仍然是一本有用的读物​​。您永远不会知道，其中一个好处很可能是您的团队在您自己的独特情况下可以从中受益的杀手锏。

我当然会推荐 Perforce，原因已经在其他答案中介绍过，但我无法与从未真正使用过的 SVN 进行比较。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-01T13:01:14.147

正确的分支和使分支成为命名空间的一部分是我在 Perforce 中看到的最大好处。合并很容易。我认为远离 Subversion 没有任何不利之处。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-12-20T05:29:52.810

Perforce 允许服务器拥有客户端。

Perforce 服务器可以**在客户端读取和写入任意文件，从而执行任意代码。**Perforce 配置都是服务器端的，因此服务器可以简单地将客户端计算机的整个硬盘视为存储库，并**对其进行任何操作。**

除非在 SELinux 沙箱中，否则永远不要运行 Perforce。

**记住：Perforce 客户端是服务器的傀儡。**您必须使用操作系统的安全功能来防止它做您不希望它做的事情。**始终将 Perforce 客户端视为敌对。**

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-01T13:08:35.567

我用SVN，不是很多，只是为了试一试。我使用 Perforce 大约三年。我以为很好。客户服务非常出色，非常快地解决了一个错误，原来只是我很愚蠢，他们甚至实现了我建议的一个功能。

其他一些开发人员，尤其是必须使用它的非开发人员发现学习使用它有点棘手，尤其是在定义客户端规范（服务器上的文件夹到本地文件夹的映射）时。

我发现它可以非常快速地进出文件，并且非常可靠。我认为与我共事过的大多数开发人员都非常喜欢它，一旦我们习惯了它。不过，在我们切换之前，我们一直在使用 Visual Source Safe，因此，几乎任何事情都比这更好。

缺点是要花钱。我相信 SVN 是一个非常好的系统，因为 SVN 是免费的，我认为你必须有一个令人信服的理由来切换，尤其是 Perforce 确实需要一段时间来学习。如果 SVN 为您完成这项工作，并且您对此没有任何抱怨，我建议您继续使用它，以备不时之需！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-01T13:20:57.970

我都用过，根据我的经验，如果你有一个大团队和/或代码库，Perforce 会很有意义；否则我会选择 SVN - 它更容易设置和维护。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-30T11:39:10.537

如果需要，您可以在 Perforce 中离线编辑内容。你的工作空间定义了文件是只读的还是可写的，所以你可以让它们都可写，破解然后让 Perforce 找出需要签入的内容。

最好让文件只读并检查您需要什么，以便其他人（和您自己）知道您已经/正在做什么。

更适合您的系统取决于您的要求，如果您没有要求，则 Perforce 获胜。

谁使用颠覆？小型非商业团队 廉价或小型商业团队

谁使用 Perforce？谷歌 索尼 三星 nVidia 赛门铁克

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-04-09T15:02:24.397

在最近的版本中，Perforce 具有[**搁置**更改](http://www.perforce.com/perforce/doc.current/manuals/cmdref/shelve.html)的新功能：

> 搁置是在 Perforce 服务器上临时存储正在进行的工作而不提交更改列表的过程。当您需要在同一组文件上执行多个开发任务（例如中断更高优先级的工作、跨多个平台进行测试）或在将工作提交到软件仓库之前共享文件以进行代码审查时，搁置非常有用。

这类似于 git 的分支模型，当您需要多任务处理时，它可以让您轻松地从一个本地分支切换到另一个分支。

AFAIK，Subversion 没有类似的功能。

[有关 Perforce 博客的更多信息](http://blog.perforce.com/blog/?p=1872)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-21T06:31:47.737

我记得，随着席位数量的增加，Perforce 许可的成本会下降。因此，每个座位并不完全是 900 美元。它也是一个基于服务器的许可证；您为使用它的人类开发人员总数付费，而不是为使用它的每个机器客户端付费。因此，如果您是一家有 200 人的商店，那么 200 席许可证让他们都可以使用 perforce，即使是在家中也是如此。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-01-13T21:39:18.940

在我看来，在 SVN 和 Perforce 之间进行选择的**原因#1是****cost**。

*小型*存储库：SVN 可以免费完成它的工作。

*大*存储库：使用 SVN 是致命的：http: [//yoawsconsult.blogspot.com/2009/05/whenwhy-you-cant-afford-to-use.html](http://yoawsconsult.blogspot.com/2009/05/whenwhy-you-cant-afford-to-use.html)。Perforce 可以做大型存储库，但您必须为此付费并了解它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-02-27T06:07:31.913

perforce 对子版本的一个缺点是 svn 中的导出命令。将某个版本的代码导出或下载到任何地方都更容易。您不需要为此创建工作区。但是在 perforce 中，您只能将版本化代码获取到您的工作区。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-03-19T09:20:42.133

根据我的实践：

*   Perforce 还设计用于存储巨大的 blob 文件（如软件发行版），svn 将其所有数据存储为文本。在svn中不可能有效地存储这样的二进制数据

*   Perforce 支持有用的东西，比如“搁置更改”。用户要求 perforce 在 perforce 服务器中像“补丁”一样存储更改。如果作者要求，其他用户可以查看更改。svn 不支持

*   svn 命令行格式更容易理解和记忆，更适合日常使用

*   svn是免费的

*   在“git”和“svn”中，您在从 repo 接收文件后直接通过编辑本地文件系统中的文件来编辑您的更改。实际上，处理文件的“正确”方法是将它们标记为您将要使用它们（p4 编辑）....理论上其他人可以查看它，实际上它不舒服

*   本地系统中的 Perforce 客户端工作区准备需要比 svn 更多的时间，因为需要进行额外的配置

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-03-29T13:05:06.417

能够通过 TortoiseSVN 从 exlorer 做所有事情感觉非常舒服！所以甚至安装了 P4 扩展。但它真的没有那么复杂！

另一方面，P4 客户端提供了对服务器存储库的可访问视图，因此无需完全签出即可工作。在仅使用 TSVN 的 SVN 时代，这总是感觉有点麻烦。

这么说我无法理解顶级海报评论：

> *   *Explorer shell 扩展客户端（想想 TortoiseSVN）很糟糕并且完全无法使用。*

对于 FOSS TortoiseSVN 来说简直太棒了！（即使图标的东西在每台机器上都有点讨厌和不同..）

使用 TortoiseSVN 你：

*   可以重新排列功能
    *   例如，将“获取锁定..”放在前面
*   实际上可以从资源管理器访问所有功能
*   在 shell 菜单中有图标
*   收到有关更新的通知

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2008-10-01T13:40:15.397

在我看来，使用*subversion*而不是 Perforce的主要好处是**能够离线编辑内容**并与您的同事同时进行。

如果数据基础设施松散结合（有离线时间），svn 摇滚。即使服务器无法访问，您也可以做很多事情。Perforce 本质上需要一个始终可用的服务器连接。

免责声明：我在 Perforce 上的信息很旧，在 2005-06 年使用了一段时间，然后完全切换到 svn

# c# - “/”应用程序中的服务器错误

> ID：157431
> 
> 赞同：1
> 
> 时间：2008-10-01T12:53:10.780
> 
> 标签：c#, asp.net, .net-2.0

我在 asp.net 2.0 中创建了一个 Web 应用程序。这在我的本地机器上运行良好。但是，当尝试在具有 Windows 2003 服务器的服务器上部署它时，我收到错误消息：

# “/”应用程序中的服务器错误。

* * *

## *解析器错误*

**说明：**解析服务此请求所需的资源时出错。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

**解析器错误消息：**文件“/MasterPage.master”不存在。

**源错误：**

```
Line 1:  <%@ Page Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" Title="LinkChecker Home " %>
Line 2:  <asp:Content ID="Content1" ContentPlaceHolderID="MainContent" Runat="Server">
Line 3: 
```

**源文件：** /LinkChecker/Default.aspx **行**：1

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-01T12:54:28.750

Web 服务器（大概是 IIS）上的文件夹是否标记为 ASP.NET 应用程序？如果不是，~/ 将指向下一个应用程序，或站点根目录。

它应该在 IIS/MMC 管理单元中有一个 cog 图标。还要确保它运行的是正确版本的 ASP.NET（通常是 v2.blah）。

在 IIS/MMC 视图中，找到您的项目所在的文件夹；右键点击; 特性。检查它是否有应用程序名称；如果没有，请单击创建。如果您希望它以不同于默认身份的身份运行，您可能还需要调整应用程序池。还要检查 ASP.NET 选项卡 - 例如，它可能是 2.0.50727。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T13:05:36.617

还有其他可能的问题可能导致上述错误消息，例如服务器上的权限问题。

[在此处](http://forums.asp.net/p/972609/1228020.aspx)查找也讨论此主题的线程。

# mysql - 问题加入mysql表中的最大值

> ID：157459
> 
> 赞同：3
> 
> 时间：2008-10-01T12:59:45.803
> 
> 标签：mysql, sql

我有一个产品表...

[替代文字 http://img357.imageshack.us/img357/6393/productscx5.gif](http://img357.imageshack.us/img357/6393/productscx5.gif)

和一个修订表，它应该跟踪产品信息的变化

[替代文字 http://img124.imageshack.us/img124/1139/revisionslz5.gif](http://img124.imageshack.us/img124/1139/revisionslz5.gif)

我尝试查询所有产品的数据库，以及它们的最新版本......

```
select
*
from `products` as `p`
left join `revisions` as `r` on `r`.`product_id` = `p`.`product_id`
group by `p`.`product_id`
order by `r`.`modified` desc 
```

但我总是得到第一次修订。我需要在**一次**选择中执行此操作（即没有子查询）。我可以在 mssql 中管理它，这在 mysql 中是否可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T20:45:34.810

这是我的做法：

```
SELECT p.*, r.*
FROM products AS p
  JOIN revisions AS r USING (product_id)
  LEFT OUTER JOIN revisions AS r2 
    ON (r.product_id = r2.product_id AND r.modified < r2.modified)
WHERE r2.revision_id IS NULL; 
```

换句话说：找到不存在具有相同 product_id 和更大修改值的其他修订的修订。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T13:03:51.847

历史记录表上的开始日期和结束日期将使这成为可能。（在插入新记录时，将最近的结束日期留空并在前一条记录上标记结束日期）

否则，您将不得不使用子查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T13:14:31.463

在 MySQL 中可以解析相同的查询。

为什么使用左连接而不是内部连接或右连接？

此外，如果您想以不同的方式解决此问题，您可以使用 MAX 功能。

# maven-2 - 我应该使用 FTP 服务器作为 Maven 主机吗？

> ID：157463
> 
> 赞同：11
> 
> 时间：2008-10-01T13:00:33.463
> 
> 标签：maven-2

我想为我们正在开发的框架及其依赖项托管一个 Maven 存储库。我可以使用 将我的工件部署到我的 FTP 主机`mvn deploy`，还是应该在能够部署工件之前手动部署和/或设置一些东西？我只能通过 FTP 访问我想在其上托管 Maven 存储库的服务器。

我要使用的在线存储库不是我自己托管的。正如我所说，我只有 FTP 访问权限，所以如果可能的话，我想将该 FTP 空间用作 Maven 存储库。当您完全控制主机时，所提到的工具似乎可以工作，或者至少不仅仅是 FTP 访问，因为您需要配置将放置存储库的本地目录。这可能吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-01T13:07:32.807

您可能想看看[Nexus，](http://nexus.sonatype.org/)一个 Maven 存储库管理器。我们已经将本地 Maven 存储库替换为基于 Nexus 的存储库，并且发现它非常有用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-01T13:27:45.237

多年来，我已经成功地将 Archiva 用作我的存储库……请参阅[http://archiva.apache.org/](http://archiva.apache.org/)。它易于管理，并允许您根据需要配置任意数量的存储库（SNAPSHOT、内部、外部等）。

根据书中“~~[使用 Maven 更好地构建](http://www.exist.com/better-build-maven)~~"，最常见的存储库类型是 HTTP，这一段描述了我认为你需要的内容：

> 本章将假设存储库从[http://localhost:8081/](http://localhost:8081/)运行，并且使用文件系统将工件部署到存储库。但是，可以在另一台服务器上使用任何支持的协议组合（包括 http、ftp、scp、sftp 等）的存储库。有关详细信息，请参阅第 3 章。

Maven 2 存储库只是一个特定的目录结构，因此一旦为 POM 的存储库和部署部分获得正确的传输和服务器规范，它应该对用户完全透明。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-30T13:42:54.077

您甚至可以[使用 Dropbox](https://code.google.com/p/peter-lavalle/wiki/MavenOnDropBox)。您只需要一个公共地址来访问使用 mvn deploy 生成的文件，以及[接受的答案](https://stackoverflow.com/a/157594/821780)中的任何协议。

我想有更多的服务可以以同样的方式工作，但我不确定[Dropbox 的替代品](http://alternativeto.net/software/dropbox/)可能使用的 URL 方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-21T11:51:56.777

[https://maven.apache.org/wagon/wagon-providers/wagon-ftp/](https://maven.apache.org/wagon/wagon-providers/wagon-ftp/)将告诉您可以使用 ftp 从现有存储库中读取，但不能创建新存储库。我不认为原则上是不可能的，但是没有人愿意编写所有繁琐的代码来通过 ftp 进行目录管理。

# sockets - VxWorks 中有哪些类型的套接字？

> ID：157468
> 
> 赞同：2
> 
> 时间：2008-10-01T13:01:39.683
> 
> 标签：sockets, vxworks

Vxworks 支持标准的 IP v4 和 IP v6 套接字，但套接字也用于其他目的。
还有哪些其他类型的插座可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T13:22:32.490

您可以使用的套接字类型取决于您在其中创建套接字的通信域。列出的套接字类型是：

```
SOCK_DGRAM 不可靠 未排序 可能重复的消息
SOCK_STREAM 可靠的有序非重复流
SOCK_SEQPACKET 可靠的有序非重复消息
SOCK_RDM 可靠未排序可能重复的消息

SOCK_RAW 协议/接口依赖，访问内部协议信息

```

VxWorks 还定义了以下通信域：

```
AF_INET IPv4
AF_INT6 IPv6
AF_ROUTE 路由
AF_LOCAL 本地进程间通信
AF_TIPC 透明进程间通信
AF_MOBILITY 移动 IPv6

```

以下是各种域支持的各种套接字的列表：

```
AF_INET SOCK_DGRAM、SOCK_STREAM、SOCK_RAW
AF_INT6 SOCK_DGRAM、SOCK_STREAM、SOCK_RAW
AF_ROUTE SOCK_RAW
AF_LOCAL SOCK_SEQPACKET
AF_TIPC SOCK_SEQPACKET、SOCK_RDM、SOCK_DGRAM、SOCK_STREAM
AF_MOBILITY 不知道

```

# java - 动态实例化一个类似于Java的Ruby类

> ID：157480
> 
> 赞同：24
> 
> 时间：2008-10-01T13:04:31.893
> 
> 标签：java, ruby

Java中的这一行如何翻译成Ruby：
String className = "java.util.Vector";
...
对象o = Class.forName(className).newInstance();

谢谢！

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-01T13:09:31.803

```
Object::const_get('String').new() 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-01T15:16:21.000

如果您使用的是 ActiveSupport（即 Rails），则添加了一个方法来`String`执行此操作：

```
"String".constantize.new 
```

# java - 有没有办法与 Java 1.3 建立 HTTPS 连接？

> ID：157491
> 
> 赞同：4
> 
> 时间：2008-10-01T13:08:01.790
> 
> 标签：java, https

我必须在旧的 1.3 JVM 上工作，并且被要求创建与另一台服务器的安全连接。不幸的是，HttpsURLConnection 只出现在 JVM 1.4 中。

是否有另一种方法来创建安全连接？有没有我可以添加这个功能的库？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-01T13:11:10.067

您需要安装 Java 安全套接字扩展 (JSSE)，这在过去是必需的，因为由于喜剧出口限制，Sun 不会将它与 JDK 一起提供。我查看了 Sun 的网站，但 JDK 1.3 的说明难以捉摸。请记住，JDK 1.3 现在已被 Sun 终止，因此他们可能不再有任何信息。

[http://hc.apache.org/httpclient-3.x/sslguide.html](http://hc.apache.org/httpclient-3.x/sslguide.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-02T02:39:13.167

查看[BouncyCastle](http://www.bouncycastle.org/java.html)实现。它一直工作到 Java 1.1 和 J2ME。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T13:18:41.330

如果 JSSE 不适合您（从@skaffman 的回答中，可能很难找到文档），您可能需要研究某种代理。您可以设置在同一台本地机器（或受信任的网络）上运行的守护程序，然后通过 HTTPS 将请求转发到最终端点。您可以使用更现代的 JVM 编写此代理服务器。然后，您的遗留系统将指向代理而不是真正的服务。

当然，如果碰巧您也可以控制最终端点，您也许可以将两台服务器都放在 VPN 上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T13:13:21.827

您也许可以使用[JSSE](http://java.sun.com/products/archive/jsse/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T15:00:32.050

[skaffman 链接到jakarta commons HttpClient](http://hc.apache.org/httpclient-3.x/sslguide.html)的 SSL 指南。HttpClient 是一个很好的处理 http 的库。

# mfc - 从单个文件打开多个文档

> ID：157492
> 
> 赞同：0
> 
> 时间：2008-10-01T13:08:32.007
> 
> 标签：mfc

当在 MFC 应用程序中打开单个文件时，我将如何创建多个文档？

我们有一个聚合文件格式，可以包含多个文档的信息。打开此文件时，我想为文件中的每条记录创建多个 CDocument。我们已经有一个扩展的 CDocManager，所以我猜这可以通过 OpenDocumentFile 中的一些逻辑来实现。问题是如何将有关“我记录 x of y”的信息从 CDocument 类备份到文档管理器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T14:10:52.483

如果您有多个存储不同信息的 CDocument 派生类型，则需要为每种类型提供单独的 CMultiDocTemplate，通常存储在 CApp 派生类中。当您调用 App.Initinstance 时，您使用类似的东西初始化每个模板

```
m_MyTempate1 = new CAtlasMDITemplate(IDR_RES_TYPE1,
         RUNTIME_CLASS(CDocumentType1),
    RUNTIME_CLASS(CChildFrameSplitter), 
    RUNTIME_CLASS(CViewType1)); 
```

当您打开您的基础文档时，您将创建和检索您的附加文档。您可以在很多地方执行此操作，序列化可能是最简单的，例如

```
void CDocumentType1::Serialize(CArchive& ar)
{
//
//  Do all the document type 1 serialisation
//

// Create second doc

CDocumentType2 *pDoc2 = theApp.m_MyTempate2->OpenDocumentFile(NULL);
pDoc2->Serialize(ar);

} 
```

不过，更传统的做法是拥有一个文档，其中包含用于访问聚合文档的不同部分的多个视图。

# asp.net - 通过 QueryString 传递对象

> ID：157504
> 
> 赞同：4
> 
> 时间：2008-10-01T13:11:00.333
> 
> 标签：asp.net, vb.net

我有对象 A，它又具有对象 B 类型的属性

```
Class A

property x as Object B

End Class 
```

在我的 ASP.NET 页面上，当我选择一个映射到 AI 类型对象的 gridview 项时，将对象序列化到 QueryString 上并将其传递到下一页。

但是，如果属性 x 实际上具有某些值，我会遇到问题，因为看起来我超过了 4k 的 QueryString 容量长度（尽管我认为对象没有那么大）

我已经考虑过以下方法来做到这一点

*   会话变量

**未使用的方法，因为我已经读过这是不好的做法。**

*   使用对象的唯一键并在下一页检索它。

**不使用的方法是对象不映射到表中的单个实例，它们由来自不同数据库的数据组成。**

所以我想我的问题是双重的

*   是否值得使用 GKZip 进一步压缩查询字符串（这可能吗？？）
*   人们会建议什么其他方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T00:04:36.430

如果在浏览器中显示下一页的 url 无关紧要，您可以使用 context.items 集合。

```
context.items.add("keyA", objectA)
server.transfer("nextPage.aspx") 
```

然后在下一页：

```
public sub page_load(...)
    dim objectA as A = ctype(context.items("keyA"), objectA)
    dim objectB as B = objectA.B
end sub 
```

使用它的一个原因是，如果您希望用户相信下一页确实是第一页的一部分。对他们来说，似乎只是发生了 PostBack。

此外，如果使用“下一页”的唯一方法是您首先来自“第一页”，那么您实际上并不需要使用这种方法的唯一键。上下文项集合的范围仅针对此特定请求。

我同意其他发帖者的观点，他们提到查询字符串上的序列化对象比使用会话状态更糟糕。如果您确实使用会话状态，请记住在使用后立即清除您使用的密钥。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T13:15:03.177

我不明白你为什么不使用会话状态但是......

选项 1：视图状态

选项 2：表单参数而不是查询字符串

但也要注意，当您序列化/反序列化时，您不会得到相同的对象。您将获得一个新对象，该对象使用已序列化的原始值进行初始化。你最终会得到两个对象。

编辑：您可以使用与会话状态相同的语法将值存储在视图状态中

ViewState["key"] = val;

该值必须是可序列化的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T13:27:52.977

虽然在会话中存储对象可能被认为是不好的做法，但它比通过序列化查询字符串传递它们要好很多光年。

回到经典的 asp，在会话中存储对象被认为是不好的做法，因为您创建了线程关联，并且您还通过添加其他 Web 服务器限制了扩展站点的能力。这不再是 asp.net 的问题（只要您使用外部状态服务器）。

避免会话变量还有其他原因，但在你的情况下，我认为这是要走的路。

另一种选择是将需要访问此对象的 2 个页面合并为一个页面，使用面板隐藏和显示所需的“子页面”并使用视图状态来存储对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-01T13:31:15.697

我不认为在查询字符串中传递它，或者将它存储在会话中，是一个好主意。

您需要以下其中一项：

a) 缓存层。像 Microsoft Velocity 这样的东西会起作用，但我怀疑你需要那种规模的东西。

b）将您需要的数据库中每个对象的键放在查询字符串中，并在下次检索它们。（例如 myurl.com/mypage.aspx?db1objectkey=123&db2objectkey=345&db3objectkey=456）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-10T01:50:48.077

使用会话状态似乎是最实用的方法，这正是它的设计目的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T13:27:42.913

缓存可能也不是这里的答案。正如 Telos 提到的，我不确定你为什么不考虑会话。

如果你有一个依赖于可用数据的页面，那么你只需在页面加载中抛出一个保护子句......

```
public void Page_Load()
{

    if(!IsPostBack)
    {   
        const string key = "FunkyObject";
        if(Session[key] == null)
            Response.Redirect("firstStep.aspx");

        var obj = (FunkyObject)Session[key];
        DoSomething(obj);
    }
} 
```

如果 session 完全不在问题范围内，那么您将不得不在另一个页面上重新实现该对象。只需在查询字符串中发送唯一标识符，以便您可以再次将其拉回。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-02T18:13:15.310

这是我所做的：

Page1.aspx - 添加我的对象实例的公共属性。添加一个按钮 (Button1)，并将 PostBackURL 属性设置为 ~/Page2.aspx

```
Private _RP as ReportParameters
Public ReadOnly Property ReportParams() as ReportParameters
  Get
    Return _RP
  End Get
End Property

Protected Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
  _RP = New ReportParameters       
  _RP.Name = "Report 1"
  _RP.Param = "42"    
End Sub 
```

现在，在第二页上，Page2.aspx 在第一个指令下的页面顶部的标记中添加以下内容：

```
<%@ PreviousPageType VirtualPath="~/Default.aspx" %> 
```

然后对于Page2.aspx后面代码中的Page_Load，添加如下

```
If Not Page.PreviousPage is Nothing Then
  Response.write (PreviousPage.ReportParams.Name & " " & PreviousPage.ReportParams.Param)
End If 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-12-20T01:46:16.310

会话并不总是可用的。例如，当 IE 上的 XSS（跨站点脚本）安全设置阻止存储第三方 cookie 时。如果您的站点是在 IFrame 中从不是您的 DNS 域的站点调用的，则默认情况下您的 cookie 将被阻止。没有 cookie = 没有会话。

另一个例子是您必须将控制权传递给另一个网站，该网站会将您的网站作为纯 URL 而不是帖子进行回调。在这种情况下，您必须将会话参数存储在查询字符串参数中，鉴于 4k 大小限制和 URL 编码，更不用说加密等，这很难做到。

问题是大多数内置序列化方法都非常冗长，因此必须求助于自己滚动的方法，可能使用反射。

不使用会话的另一个原因仅仅是为了提供更好的用户体验。会话在 N 分钟后和服务器重新启动时被清除。好的，在这种情况下，视图状态更可取，但有时无法使用表单。好的，可以依靠 JavaScript 进行回发，但同样，这并不总是可行的。

这些是我目前正在编码的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-06T00:29:08.810

面对类似的情况，我所做的是将 XML 序列化对象并将其作为查询字符串参数传递。这种方法的困难在于，尽管进行了编码，但接收表单会抛出异常，说“潜在危险的请求......”。我解决的方法是加密序列化对象，然后编码以将其作为查询字符串参数传递。这反过来又使查询字符串防篡改（奖金进入 HMAC 领域）！

FormA XML 序列化一个对象 > 加密序列化字符串 > 编码 > 作为查询字符串传递给 FormB FormB 解密查询参数值（因为 request.querystring 也解码） > 使用 XmlSerializer 将生成的 XML 字符串反序列化为对象。

我可以根据要求分享我的 VB.NET 代码到 howIdidit-at-applecart-dot-net

# c# - 在字典的键上使用锁定

> ID：157511
> 
> 赞同：8
> 
> 时间：2008-10-01T13:12:16.087
> 
> 标签：c#, dictionary, locking

我有一个`Dictionary<string, someobject>`.

编辑：有人向我指出，我的例子很糟糕。我的整个意图不是更新循环中的引用，而是根据不同的线程更新不同的值需要更新/获取数据。我将循环更改为方法。

我需要更新字典中的项目 - 一次一个键，我想知道在我的 Dictionary 对象的 .key 值上使用锁定是否有任何问题？

```
private static Dictionary<string, MatrixElement> matrixElements = new Dictionary<string, MatrixElement>();

//Pseudo-code

public static void UpdateValue(string key)
{
    KeyValuePair<string, MatrixElement> keyValuePair = matrixElements[key];
    lock (keyValuePair.Key)
    {
        keyValuePair.Value  = SomeMeanMethod();
    }
} 
```

这会在法庭上成立还是失败？我只希望字典中的每个值都被独立锁定，因此锁定（和更新）一个值不会锁定其他值。另外我知道锁定将持续很长时间 - 但数据在完全更新之前将无效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-01T13:23:17.357

锁定在代码锁定之外可访问的对象是一个很大的风险。如果任何其他代码（任何地方）曾经锁定该对象，您可能会陷入一些难以调试的死锁。另请注意，您锁定的是*对象*，而不是引用，所以如果我给你一本字典，我可能仍然持有对键的引用并锁定它们——导致我们锁定同一个对象。

*如果*您完全封装字典，并自己生成密钥（它们从未传入，那么您可能是安全的。

但是，请尝试遵守一条规则 - 尽可能将您锁定的对象的可见性限制为锁定代码本身。

这就是你看到这个的原因：

```
public class Something
{
  private readonly object lockObj = new object();

  public SomethingReentrant()
  {
    lock(lockObj)    // Line A
    {
      // ...
     }
   }
} 
```

而不是看到上面的 A 行替换为

```
 lock(this) 
```

这样，一个单独的对象被锁定，可见性受到限制。

**编辑** [Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)正确地观察到上面的 lockObj 应该是只读的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-01T13:18:31.470

不，这行不通。

原因是[字符串实习](http://en.wikipedia.org/wiki/String_intern_pool)。这意味着：

```
string a = "Something";
string b = "Something"; 
```

都是同一个对象！因此，您永远不应该锁定字符串，因为如果程序的其他部分（例如，同一对象的另一个实例）也想锁定相同的字符串，您可能会意外地在不需要它的地方创建锁定争用；甚至可能陷入僵局。

不过，请随意使用非字符串来执行此操作。为了清楚起见，我将始终创建一个单独的锁定对象作为个人习惯：

```
class Something
{
    bool threadSafeBool = true;
    object threadSafeBoolLock = new object(); // Always lock this to use threadSafeBool
} 
```

我建议你也这样做。为每个矩阵单元创建一个带有锁对象的字典。然后，在需要时锁定这些对象。

PS。更改您正在迭代的集合并不是很好。它甚至会抛出大多数集合类型的异常。尝试重构这个 - 例如迭代一个键列表，如果它总是不变的，而不是对。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-01T16:02:13.090

*注意：我假设在迭代期间修改集合时出现异常已经修复*

字典不是线程安全的集合，这意味着在没有外部同步的情况下从不同的线程修改和读取集合是**不安全**的。Hashtable 是（曾经？）线程安全的一个作者多读者场景，但 Dictionary 具有不同的内部数据结构并且不继承此保证。

这意味着当您从其他线程访问字典以进行读取或写入时，您无法修改字典，它只会破坏内部数据结构。锁定密钥并不能保护内部数据结构，因为当您修改该密钥时，有人可能会在另一个线程中读取您字典的不同密钥。即使你可以保证你所有的键都是相同的对象（比如关于字符串实习的说法），这并不能让你安全。例子：

1.  您锁定密钥并开始修改字典
2.  另一个线程尝试获取恰好落入与锁定的存储桶相同的存储桶的密钥的值。这不仅在两个对象的 hashcode 相同时出现，而且在 hashcode%tableSize 相同时更常见。
3.  两个线程都在访问同一个存储桶（具有相同 hashcode%tableSize 值的键的链接列表）

如果字典中没有这样的键，第一个线程将开始修改列表，第二个线程可能会读取不完整的状态。

如果这样的键已经存在，字典的实现细节仍然可以修改数据结构，例如将最近访问的键移动到列表的头部以便更快地检索。您不能依赖实施细节。

在很多情况下，您的字典都会损坏。因此，您必须拥有外部同步对象（或使用 Dictionary 本身，如果它不公开）并在整个操作期间锁定它。如果您在操作可能需要很长时间时需要更细粒度的锁，您可以复制需要更新的密钥，对其进行迭代，在单个密钥更新期间锁定整个字典（不要忘记验证密钥是否仍然存在）并将其释放到让其他线程运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T07:45:43.987

如果我没记错的话，最初的意图是锁定单个元素，而不是锁定整个字典（例如数据库中的表级锁定与行级锁定）

你不能像这里解释的那样锁定字典的键。

您可以做的是保留与实际字典相对应的锁定对象的内部字典。因此，当您想写入 YourDictionary[Key1] 时，您将首先锁定 InternalLocksDictionary[Key1] - 因此只有一个线程会写入 YourDictionary。

一个（不太干净）的例子可以在[这里找到](http://kenegozi.com/blog/2008/08/24/keylevel-locked-cache-real-life-implementation/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-14T11:11:27.520

刚刚遇到这个，并认为 id 分享了我几年前写的一些代码，我需要一个关键的字典

```
 using (var lockObject = new Lock(hashedCacheID))
 {
    var lockedKey = lockObject.GetLock();
    //now do something with the dictionary
 } 
```

锁类

```
class Lock : IDisposable
    {
        private static readonly Dictionary<string, string> Lockedkeys = new Dictionary<string, string>();

        private static readonly object CritialLock = new object();

        private readonly string _key;
        private bool _isLocked;

        public Lock(string key)
        {
            _key = key;

            lock (CritialLock)
            {
                //if the dictionary doesnt contain the key add it
                if (!Lockedkeys.ContainsKey(key))
                {
                    Lockedkeys.Add(key, String.Copy(key)); //enusre that the two objects have different references
                }
            }
        }

        public string GetLock()
        {
            var key = Lockedkeys[_key];

            if (!_isLocked)
            {
                Monitor.Enter(key);
            }
            _isLocked = true;

            return key;
        }

        public void Dispose()
        {
            var key = Lockedkeys[_key];

            if (_isLocked)
            {
                Monitor.Exit(key);
            }
            _isLocked = false;
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T13:24:58.037

在你的例子中，你不能做你想做的事！

你会得到一个**System.InvalidOperationException ，其中包含****Collection 已修改**的消息；**枚举操作可能无法执行。**

下面举个例子来证明：

```
using System.Collections.Generic;
using System;

public class Test
{
    private Int32 age = 42;

    static public void Main()
    {
       (new Test()).TestMethod();
    }

    public void TestMethod()
    {
        Dictionary<Int32, string> myDict = new Dictionary<Int32, string>();

        myDict[age] = age.ToString();

        foreach(KeyValuePair<Int32, string> pair in myDict)
        {
            Console.WriteLine("{0} : {1}", pair.Key, pair.Value);
            ++age;
            Console.WriteLine("{0} : {1}", pair.Key, pair.Value);
            myDict[pair.Key] = "new";
            Console.WriteLine("Changed!");
        }
    }   
} 
```

输出将是：

```
42 : 42
42 : 42

Unhandled Exception: System.InvalidOperationException: Collection was modified; enumeration operation may not execute.
   at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
   at System.Collections.Generic.Dictionary`2.Enumerator.MoveNext()
   at Test.TestMethod()
   at Test.Main() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T13:31:14.153

我可以在那里看到一些潜在的问题：

1.  字符串可以共享，因此您不一定知道还有谁可能出于其他原因锁定该密钥对象
2.  字符串可能*不会*共享：您可能锁定了一个值为“Key1”的字符串键，而其他一些代码可能有一个不同的字符串对象，该对象也包含字符“Key1”。对于字典来说，它们是相同的键，但就锁定而言，它们是不同的对象。
3.  该锁定不会阻止对值对象本身的更改，即`matrixElements[someKey].ChangeAllYourContents()`

# build - 在没有额外插件的情况下使用 Maven 1.x，有人如何构建可执行 jar？

> ID：157524
> 
> 赞同：0
> 
> 时间：2008-10-01T13:14:35.643
> 
> 标签：build, maven, executable-jar, maven-1

仅使用带有捆绑/标准插件的 Maven 1.x，构建可执行 Jar 需要什么配置？

答案应包括：

*   包括目标 Jar 中的依赖项
*   正确的类路径配置以使依赖项 jar 可访问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T14:28:14.390

那么最简单的方法是简单地将 maven.jar.mainclass 属性设置为您想要使用的主类。

至于设置清单类路径，您可以使用 maven.jar.manifest.classpath.add=true 让 maven 根据 project.xml 中描述的依赖关系自动更新类路径。

免责声明：自从我使用 Maven 1 以来已经有很长一段时间了，并且我没有对此进行任何测试，但是我很确定这将使您朝着正确的方向开始。有关更多信息，请查看[jar 插件文档](http://maven.apache.org/maven-1.x/plugins/jar/properties.html)。

# asp.net - 如何冻结 GridView 标题？

> ID：157528
> 
> 赞同：11
> 
> 时间：2008-10-01T13:15:13.210
> 
> 标签：asp.net, gridview, controls

如标题所示，有人知道如何在 ASP.NET 中冻结 GridView 标头吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T13:29:56.963

你可以在css中做到这一点

**Freeze Header：** 1\. 在样式表中定义类 .Freezing：

```
.Freezing
{
   position:relative ;
   top:expression(this.offsetParent.scrollTop);
   z-index: 10;
} 
```

2.Assign Datagrid Header的cssClass为Freezing

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T13:23:39.197

选项 (a) 购买一个 UI 包，其中包含一个内置此功能的增强型 GridView。

选项（b）自己动手 - 这并不简单。Dino Esposito[有一种方法](http://weblogs.asp.net/despos/archive/2003/12/12/43091.aspx)。

编辑：刚刚注意到 Dino 文章链接到 ASPnetPro 杂志网站上的仅限订阅者区域。

这是使用扩展器的[另一种方法。](http://weblogs.asp.net/dwahlin/archive/2007/07/31/freeze-asp-net-gridview-headers-by-creating-client-side-extenders.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-04T16:44:46.167

试试这个 ASP.NET 的开源项目。它扩展了 GridView 以提供固定的页眉、页脚和分页器以及可调整大小的列宽。在 IE 6/7/8、Firefox 3.0/3.5、Chrome 和 Safari 中运行良好。

[http://johnsobrepena.blogspot.com/2009/09/extending-aspnet-gridview-for-fixed.html](http://johnsobrepena.blogspot.com/2009/09/extending-aspnet-gridview-for-fixed.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-12T03:39:48.467

在 Asp.Net 2.0 / 3.5 中开发 Web 应用程序时，我也遇到了类似的问题。

美好的一天，我遇到了**IdeaSparks ASP.NET CoolControls**。它有助于显示修复列标题、页脚和分页器。

我个人使用它们，我真的很喜欢它！

[要检查控件，请单击此处：IdeaSparks ASP.NET CoolControls](http://ideasparks.codeplex.com/releases/view/40091)

希望这可以帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-24T13:15:21.200

我想我有这个解决方案。请看下面的javascript代码

```
<script type="text/javascript" language="javascript">
    var orgTop = 0;
    $(document).scroll(function () {
        var id = $("tr:.header").get(0);
        var offset = $(id).offset();
        var elPosition = $(id).position();
        var elWidth = $(id).width();
        var elHeight = $(id).height();
        if (orgTop == 0) {
            orgTop = elPosition.top;
        }
        if ($(window).scrollTop() <= orgTop) {
            id.style.position = 'relative';
            id.style.top = 'auto';
            id.style.width = 'auto';
            id.style.height = 'auto';
        }
        else {
            id.style.position = 'absolute';
            id.style.top = $(window).scrollTop() + 'px';
            id.style.width = elWidth + 'px';
            id.style.height = elHeight + 'px';

        }
    });
</script> 
```

`.header`Grid 标头的 css 类在哪里。

只需在页面上添加此脚本并替换`header`为您用于标题的 css 类名称。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-13T07:49:42.150

试试这个应该可以解决问题 [http://www.codeproject.com/KB/webforms/FreezePaneDatagrid.aspx](http://www.codeproject.com/KB/webforms/FreezePaneDatagrid.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-28T07:53:38.653

您可以尝试以下示例

[冻结 GridView 列](http://www.vbknowledgebase.com/?Id=91&Desc=Freeze-GridView-Columns-and-Headers-in-ASP.Net-CSS)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-30T06:27:24.303

```
 <script src="Scripts/jquery-1.7.1.js"></script>
        <script language="javascript" >
            $(document).ready(function () {
                var gridHeader = $('#<%=GridView1.ClientID%>').clone(true); // Here Clone Copy of Gridview with style
                $(gridHeader).find("tr:gt(0)").remove(); // Here remove all rows except first row (header row)
                $('#<%=GridView1.ClientID%> tr th').each(function (i) {
                    // Here Set Width of each th from gridview to new table(clone table) th 
                    $("th:nth-child(" + (i + 1) + ")", gridHeader).css('width', ($(this).width()).toString() + "px");
                });
                $("#GHead").append(gridHeader);
                $('#GHead').css('position', 'absolute');
                $('#GHead').css('top', $('#<%=GridView1.ClientID%>').offset().top);

            });
        </script>

            <h3>Scrollable Gridview with fixed header in ASP.NET</h3>
            <br />
            <div style="width:550px;">
                <div id="GHead"></div> 
                <%-- This GHead is added for Store Gridview Header  --%>
                <div style="height:300px; overflow:auto">
                    <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="false" 
                        CellPadding="5" HeaderStyle-BackColor="#f3f3f3">
                        <Columns>
                            <asp:BoundField HeaderText="ID" DataField="StateID" />
                            <asp:BoundField HeaderText="Country" DataField="Country" />
                            <asp:BoundField HeaderText="StateName" DataField="StateName" />
                        </Columns>
                    </asp:GridView>
                </div>
            </div> 
```

# search - 单数/复数搜索和词干提取

> ID：157530
> 
> 赞同：1
> 
> 时间：2008-10-01T13:16:00.710
> 
> 标签：search, stemming

我正在为单复数关键字搜索找到一个简单的解决方案。我听说过词干提取，但我不想使用它的所有功能，只有复数/单数转换。语言是荷兰语。以前看过[http://www.snowball.tartarus.org](http://www.snowball.tartarus.org)。有谁知道单数|复数相关搜索的简单解决方案？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T14:01:59.650

使用字典、停用词列表（您不想单数化的那些）以及语言规则。如果您不懂荷兰语，那么我无法帮助您，但会向您展示如何用西班牙语完成，例如：

*   复数以 s 结尾，如果不是，则完成
    *   如果以 s 结尾，
        *   检查它是否是一个动词或以 s 结尾的变位，如果它是一个，那么它就完成了（动词可以添加到停用词列表中）
        *   如果不是动词，去掉 s
        *   如果该词存在于字典中，则完成
        *   如果它没有删除前一个字母，并在字典中检查它。
        *   如果它仍然不存在，那是一个异常，您需要手动检查异常中的代码（我现在想不出任何异常，但它们总是存在 :)

当然，这不会直接翻译成荷兰语。

一般来说，词干分析器已经完成并提供了你需要的大部分东西，你为什么不想要它们呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T14:14:32.457

词干引起了很多用户的烦恼，所以如果我使用其中一个，除了单数/复数之外的所有功能都应该被禁用。所以要求是只使用复数/单数转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T09:05:49.770

答案是正确的，但值得一提的是，荷兰语有大量不规则动词。这使得词干处理更像是一个表查找问题，而不是一组单一的规则。

您需要访问语料库，您可以在此处找到荷兰语语料库：http: [//corpus1.mpi.nl/ds/imdi_browser/](http://corpus1.mpi.nl/ds/imdi_browser/)

# c# - 在哪里可以找到有关为 SQL Server Management Studio 创建插件的信息？

> ID：157546
> 
> 赞同：22
> 
> 时间：2008-10-01T13:20:18.407
> 
> 标签：c#, .net, sql-server, ssms

我读过虽然 SQL Server Management Studio 不支持插件，但可以这样做。

有没有人有关于如何使用 C# 的任何资源或建议？

目前为 Management Studio 提供插件的公司是 Red Gate： [http ://www.red-gate.com/products/SQL_Refactor/index.htm](http://www.red-gate.com/products/SQL_Refactor/index.htm)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-02T09:27:59.050

这是为 SQL Server Management Studio 创建插件的非常好的指南：http: [//blogs.microsoft.co.il/blogs/shair/archive/2008/07/28/how-to-create-sql-server-管理工作室-addin.aspx](http://blogs.microsoft.co.il/blogs/shair/archive/2008/07/28/how-to-create-sql-server-management-studio-addin.aspx)

基本上，它包括以下内容：

1.  创建具有特定设置的 Visual Studio 加载项。
2.  订阅 SSMS 特定事件
3.  代码

本文包含一个很好的示例，您可以使用它来跳过一些手动步骤。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2008-10-02T09:48:50.373

[这里列出](http://weblogs.sqlteam.com/mladenp/archive/2007/11/20/Free-SQL-Server-tools-that-might-make-your-life-a.aspx)了很多用于 sql server 的免费工具。在顶部，您有一个部分，其中包含有关 SSMS 加载项的内容。

您可能还想查看我制作的插件[SSMS 工具包。](http://www.ssmstoolspack.com/)它是免费的，但不是开源的。

# c# - 如何将 XmlNodeList 转换为 NodeSet 以在 XSLT 中使用？

> ID：157554
> 
> 赞同：2
> 
> 时间：2008-10-01T13:21:28.157
> 
> 标签：c#, xml, xslt

我有一个 XmlNodeList，我需要将其设置为一种格式，然后通过从 C# 扩展方法调用它，我可以在 XSLT 样式表中重新使用它。

任何人都可以帮忙吗？我读过它可能与使用 XPathNavigator 有关，但我仍然有点卡住。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-01T13:33:43.353

几年前我不得不自己解决这个问题。我管理它的唯一方法是创建一个 XML 片段，其中包含节点列表中的节点，然后传入片段的子节点。

```
XsltArgumentList arguments = new XsltArgumentList();
XmlNodeList nodelist;
XmlDocument nodesFrament = new XmlDocument();
XmlNode root = nodesFragment.CreateElement("root");
foreach (XmlNode node in nodeList)
{
    root.AppendChild(node);
}
nodesFragment.AppendChild(root);

arguments.AddParam("argumentname", string.Empty, nodesFragment.CreateNavigator().SelectChildren(XPathNodeType.All)); 
```

然后，您当然需要确保您的 XSLT 中有相应的参数。

请注意，您可能不需要额外的 XmlDocument。您可以在根 XmlNode 实例上调用 CreateNavigator() 并使用您现有的 XmlDocument 来创建元素（我前段时间编写了这段代码，从那时起我学到了更多 - 但我知道上面的代码有效，我没有尝试了任何替代方案）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T13:48:34.563

最后的注释是最有用的，我实际上已经将 XmlNodeList 转换为 XmlDocument，因此可以使用 Navigator 并将其创建为 XPathNodeIterator。

谢谢你的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-19T16:12:30.217

之前提供的答案没有成功。

使用 AppendChild() 将先前选择的 XmlNodeList 节点添加到新文档会导致尝试附加源自不同文档上下文的节点时出现异常。解决此问题的几个试验包括在列表中添加我的自定义默认命名空间选定节点绑定到。最后，我完全放弃了这种方法，并将选择节点的方式切换到 XmlNodeList 实例。

代替

```
myXmlNode.SelectNodes( xpath, nsmgr ) 
```

我正在使用

```
myXmlNode.CreateNavigator().Select( xpath, nsmgr ) 
```

获取 XPathNodeIterator 而不是 XmlNodeList。第二个代码生成的 XPathNodeIterator 现在作为参数值正确添加到 XsltArgumentsList。

# c# - 具有静态数据的 C# 函数

> ID：157557
> 
> 赞同：7
> 
> 时间：2008-10-01T13:21:44.317
> 
> 标签：c#, .net, vb.net

在 VB.Net 中，我可以将函数中的变量声明为静态，如下所示：

```
Function EncodeForXml(ByVal data As String) As String
    Static badAmpersand As Regex = new Regex("&(?![a-zA-Z]{2,6};|#[0-9]{2,4};)")

    data = badAmpersand.Replace(data, "&amp;")

    ''// more processing

    return data
End Function 
```

请注意，我需要使用关键字`Static`，而不是`Shared`，这是在 VB.Net 中表达这一点的正常方式。我怎样才能在 C# 中做到这一点？我找不到它的等价物。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-01T13:23:39.913

哈！在发布问题时，我找到了答案！我应该寻找有关 VB.Net 如何实现它的详细信息，而不是在谷歌上搜索 C#，并且输入问题对我来说很明显。在应用了这种洞察力之后，我发现了这个：
[http ://weblogs.asp.net/psteele/articles/7717.aspx](http://weblogs.asp.net/psteele/articles/7717.aspx)

那篇文章解释说，CLR 并不真正支持它，VB 编译器在方法的类中“在后台”创建了一个静态（共享）变量。要在 C# 中做同样的事情，我必须自己创建变量。

不仅如此，它还使用`Monitor`类来确保静态成员也是线程安全的。好的。

作为旁注：我希望很快在 C# 中看到这一点。我从 MS 观察到的一般策略是，它不喜欢 VB.Net 和 C# 在功能方面相差太远。如果一种语言具有另一种语言不支持的功能，它往往会成为下一个版本的语言团队的优先事项。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-01T13:43:43.593

我个人很高兴 C#*没有*这个。从逻辑上讲，方法没有状态：类型和实例有。C# 使逻辑模型更清晰，IMO。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-01T13:23:23.517

不幸的是，C# 中没有等价物。

您将需要使用类级别变量。

这是我希望 C# 拥有的为数不多的 VB 拥有的东西之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T14:00:44.333

您必须在类级别声明这一点：

```
private static readonly RegEx badAmpersand = new RegEx("..."); 
```

# .net - .Net 中的私有程序集是什么？

> ID：157579
> 
> 赞同：4
> 
> 时间：2008-10-01T13:24:55.150
> 
> 标签：.net, assemblies

我了解类级别及以下级别的访问修饰符，但为什么整个程序集是私有的？我假设默认情况下，程序集是公共的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-01T13:25:39.330

好吧，在程序集的上下文中，私有意味着程序集不能被包含在它所在目录之外的另一个应用程序引用。因此，对于它所用于的应用程序来说是私有的。

至于你关于默认公开的问题......如果我错了，有人纠正我，但没有公开。它将被共享。共享程序集显然可以被多个应用程序引用，并且必须驻留在 GAC 中。然后将适用 GAC 的所有规则。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T13:29:46.187

*私有**程序*集中的私有不是访问修饰符。这只是一个术语，用于特定于一个应用程序的程序集 - 即在此应用程序的目录中，而不是全局程序集缓存中的共享程序集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-26T18:14:46.073

Private assembly is an assembly which is particularly an assembly which can't be referred outside the application while a public or shared or we can say it Global can be easily referred outside an assembly.

# sql-server-2005 - 用于 SharePoint 的 SQL 2005 数据库分区

> ID：157587
> 
> 赞同：3
> 
> 时间：2008-10-01T13:26:28.017
> 
> 标签：sql-server-2005, sharepoint, partitioning

背景

我有一个用于 SharePoint 网站集的大型数据库。它是 130GB，并以每月 10GB 的速度增长。130GB 中的 100GB 在一个网站集中。30GB 是版本表。只有一个网站集 - 这是设计使然。

问题

我能否使用 SQL 2005 的数据分区功能（创建多个数据文件）对数据库 (SharePoint) 进行分区？是否可以对已创建的数据库进行分区？有人对 SharePoint 数据库进行了分区吗？我会遇到什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T14:42:12.640

您必须创建一个分区集并在该分区集上重建表。SQL2005 只能对单个列进行分区，因此您必须在 DB 中有一个列

*   行为相当可预测，因此您不会在每个分区中的数据量上出现很大偏差
*   IIRC 该列必须是数字或日期时间值
*   在实践中，如果它是单调递增的，那是最简单的——您可以创建一系列分区（自动或手动），系统将在到达范围定义时填充它们。

日期（也许是输入文档的日期）是理想的。但是，大表上可能有也可能没有有用的列。MS 技术支持将是这方面的最佳建议来源。

分区*应该*对应用程序透明（同样，您需要具有适当行为的列用作分区键）。

除非您有幸拥有一个在最常见的查询中也用作搜索谓词的分区键列，否则您可能不会从分区中获得太多的查询性能优势。运行良好的列的一个示例是数据仓库中的日期列。但是，您的 Sharepoint 应用程序可能不会大量使用这种排序查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T08:22:14.950

毛罗

有没有办法可以在 Sharepoint 级别对数据进行分段？

即，您可能有多个使用单个 (SQL) 内容数据库的“站点”。您可以将站点数据迁移到新的内容数据库，这将允许您减少该大型内容站点中的数据，然后缩小数据文件。

它还将帮助您管理明显的持续增长。

詹姆士。

# c# - 处理长时间运行的报告

> ID：157592
> 
> 赞同：9
> 
> 时间：2008-10-01T13:27:41.760
> 
> 标签：c#, asp.net, ajax, reporting

我正在使用带有 Sql Server 2000 数据库的 C# 编写的 ASP.net 应用程序。我们有几份 PDF 报告供客户用于满足他们的业务需求。问题是这些报告需要一段时间才能生成（> 3 分钟）。通常最终发生的情况是，当用户请求报告时，请求超时会在 Web 服务器有时间完成生成报告之前终止请求，因此用户永远没有机会下载文件。然后用户将刷新页面并重试，这将重新开始整个报告生成过程，但仍然会超时。（不，我们现在不缓存报告；这是我正在努力争取的……）。

你如何处理这些场景？我的脑海中有一个想法，它涉及发出异步请求以开始生成报告，然后使用一些 javascript 来定期检查状态。一旦状态表明报告已完成，然后对实际文件发出单独的请求。

有没有我没有看到的更简单的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-01T13:38:41.250

在这里使用文件系统可能是一个不错的选择。有一个立即返回报告 pdf 位置的 url 的请求。然后，您的服务器可以启动外部进程或向自身发送请求以执行报告。客户端可以在提供的 url 处轮询服务器（使用 http HEAD）以获取 PDF。如果您使 PDF 的文件名从报告参数派生，通过使用哈希或直接将参数放入名称中，您也将获得即时服务器端缓存。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-01T13:36:40.817

从处理的角度来看，我会考虑以某种方式使这份报告更加离线。

就像创建一个队列来放入报告请求，从那里处理报告，完成后，它可以向用户发送消息。

也许我什至会为队列处理创建一个单独的 Windows 服务。

**更新：**可以通过电子邮件发送给用户，或者他们可以有一个“报告”页面，在那里他们可以检查他们的报告状态并在准备好时下载它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T13:34:37.687

如何通过电子邮件将报告发送给用户。所有 asp 页面应该做的是发送生成报告的请求并返回一条消息，报告将在完成运行后通过电子邮件发送。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-01T13:38:29.580

您的用户可能不接受这种方法，但是：

当他们请求报告时（通过单击按钮或链接或其他方式），您可以在单独的线程上启动报告生成过程，并将用户重定向到显示“谢谢，您的报告将通过电子邮件发送到几分钟后给你”。

当线程完成生成报告后，您可以直接通过电子邮件发送 PDF（由于大小可能无法正常工作），或者将报告保存在服务器上并将链接通过电子邮件发送给用户。

或者，您可以进入 IIS 并将超时时间提高到 > 3 分钟。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-01T13:58:03.310

如果我遇到这个问题，我会做以下一些事情：

1-停止那些超时！他们完全是在浪费资源。（调出asp页面的超时值）

2-将所有数据库访问集中在一个点上，然后收集有关何时由谁运行的报告以及花费了多少时间的统计信息。调查为什么需要这么长时间，是因为报告的复杂性吗？数据范围？服务器负载？（实际上，您可以将其全部写在服务器上的 .csv 文件中，并定期将此文件导入 sql server 以供稍后分析）。

最终，如果您通过这个单一访问点，您将更容易“缓存”报告（例如，相同的查询相同的日期将返回先前生成的相同 PDF）

3-我知道这确实不是问题，但您是否尝试过深入研究这些查询以了解为什么它们运行时间如此之长？查询调整可能吗？

4- 报告准备就绪时的电子邮件/短信/屏幕消息似乎很棒......如果您的用户通常发送要生成的一批报告，则可能会在应用程序中构建一个指示“他们的”队列进展的小仪表板。一个小的 ajax 控件会定期刷新状态。提示：如果你使用了中央数据库访问，并且你有足够的信息知道什么时候为什么运行以及运行多长时间，你最终将能够粗略估计报告所需的时间跑步。

如果响应时间是关键任务，是否应该在一天中的几个小时内将某些用户限制在数据范围（例如日期范围）内？

祝你好运，如果您想获得更准确的提示，请发布有关您的场景的更多详细信息......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-01T14:34:13.893

查询调优可能是您最好的起点。虽然我不知道您正在生成报告，但该步骤不应该花费那么长时间。另一方面，性能不佳的查询绝对会影响您的性能。

根据您在查看查询时发现的内容，您可能需要添加一些索引，或者甚至可能设置一个表来以非规范化的方式存储报告的信息，以使其更快可用。然后可以每小时（通过 SQL Server 作业）刷新此非规范化表，或者以您的要求规定的任何频率（在合理范围内）刷新。

如果它是一个相对静态的报告，没有改变用户输入参数，那么缓存在当天早些时候运行的报告也是一个好主意，但是在不了解您的情况的情况下很难说更多。

对于这样的问题，您确实需要从数据库开始，除非您有理由怀疑您的报告生成代码是罪魁祸首。您可以使用各种创可贴，可能会在一段时间内有所帮助，但如果您的数据库是根本原因，那么这些解决方案将无法很好地扩展，并且您将来可能会遇到类似的问题（或更糟） .

# svn - 使用 cvs2svn 时，如何重命名符号以使分支和标记解析为相同的名称？

> ID：157599
> 
> 赞同：2
> 
> 时间：2008-10-01T13:28:04.270
> 
> 标签：svn, cvs, cvs2svn

我正在转换具有以下符号（以及其他符号）的 CVS 存储库：

`tcm-6.1.0-branch` -- 一个分支
`tcm-6.1.0` -- 一个标签

使用标准转换 cvs2svn 可以正确识别它们。但是，我想在转换过程中进行一些清理。具体来说，我想删除分支符号的冗余“-branch”部分，因为它将位于 svn 的“分支”目录中。我在项目的 symbol_transforms 中添加了以下内容：

```
RegexpSymbolTransform(r'(.*)-branch', r'\1') 
```

现在，每个文件都得到“错误：符号'tcm-6.1.0'在...中的多个定义”，因为`tcm-6.1.0`它既是分支又是标签。我有几个导致此问题的 CVS 符号对。

在我看来，由于源符号不同且目标目录不同，因此应该可以进行此操作。是否有我遗漏的东西，或者这仅仅是 cvs2svn 的一个缺点？

如何重命名这些符号以使它们保持独立并产生具有相同名称的分支和标签？

--

如果没有解决方法，我会尝试从转换规则中排除问题符号，然后手动移动它们，尽管我宁愿在转换时进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T17:48:19.183

cvs2svn 在 cvs 和 svn 之间做了很多神奇的事情。这就是为什么你不能“匹配”分支和标签的名称，因为这样 cvs2svn 将不知道哪个版本属于哪个目录。[我的建议是使用svnmucc 之](http://svn.collab.net/repos/svn/trunk/contrib/client-side/svnmucc/)类的工具在一次提交中重命名它们。所以你有一个单一的提交，然后一切都准备好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T12:59:34.160

`RegexpSymbolTransform`在解析存储库文件期间，操作级别太低。因此，如果您使用 a`SymbolTransform`为两个符号赋予相同的名称，它们将被视为一个且相同的符号。

可以在转换后重命名分支和标签，但这需要一个显式的 SVN 提交，该提交将永远保留在您的历史中，使历史探索变得更加复杂。

相反，您应该使用其原始名称转换分支，然后告诉 cvs2svn 将其存储到 SVN 路径 /branches/tcm-6.1.0。这样，符号将最终出现在具有所需名称的 SVN 分支的正确位置，但仍将被 cvs2svn 视为与名称相似的标记不同。

这可以使用`--symbol-hints=symbol-hints.txt`命令行选项或`SymbolHintsFileRule('symbol-hints.txt')`交易品种策略规则来完成，其中`symbol-hints.txt`是包含如下行的文件：

> . tcm-6.1.0-branch 分支 /branches/tcm-6.1.0 。

我能想到的这种方法的唯一缺点是一些自动生成的提交消息`cvs2svn`（例如，用于创建分支）会提到原始分支名称。

# sql-server - SQL 服务器的数据生成器？

> ID：157600
> 
> 赞同：44
> 
> 时间：2008-10-01T13:28:10.620
> 
> 标签：sql-server, generator, data-generation

我想收到有关 SQL Server 可用数据生成器的建议。如果发布回复，请提供您认为重要的任何功能。

我从未使用过这样的应用程序，所以我希望接受有关该主题的教育。谢谢你。

（我的目标是在每个表中填充 10,000 多条记录的数据库，以测试应用程序。）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-01T13:32:40.250

我过去使用过[数据生成器](http://www.generatedata.com/#generator)。可能值得一看。

### 第三方编辑

如果不注册，则只能生成 100 行。您可以在下面找到今天的界面示例（2016 年 10 月）

[![数据生成器示例](https://i.stack.imgur.com/iEJh6.png)](https://i.stack.imgur.com/iEJh6.png)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-01T13:40:04.287

这里已经问过类似的问题：[在数据库中创建测试数据](https://stackoverflow.com/questions/16317/creating-test-data-in-a-database)

[Red Gate SQL 数据生成器](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)在该领域做得很好。您可以自定义数据库的每个字段，并使用带有种子的随机数据。甚至可以使用 Regex 表达式创建特定模式。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-24T22:16:34.333

我推出了自己的数据生成器，可以生成符合正则表达式的随机数据。它变成了一个学习项目（正在开发中），可在[github 上](https://github.com/GoranSiska/rxrdg)找到。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-01T13:51:34.853

为了生成示例数据，我使用简单的 Python 应用程序。

注意事项：

1.  易于修改和配置。

2.  一组可重复的数据，可用于性能测试并获得一致的结果。

3.  遵循所有数据库参照完整性规则和约束。

4.  真实的数据。

前两个表示您要生成将加载数据的脚本文件。第三个更难。有多种方法可以发现数据库元数据和约束。一起看 3 和 4，您不需要简单的逆向工程——您需要可以控制的东西来产生实际值。

通常，您希望构建自己的实体模型，以便确保范围和键关系正确。

你可以通过三种方式做到这一点。

1.  生成可以手动加载的 CSV 数据文件。很好的可重复测试数据。

2.  生成可以运行的 SQL 脚本。很好的可重复数据，也是。

3.  使用 ODBC 连接将数据直接生成到数据库中。我其实不太喜欢这个，但你可能会。

这是写入 CSV 文件的数据生成器的精简单表版本。

```
import csv
import random

class SomeEntity( list ):
    titles = ( 'attr1', 'attr2' ) # ... for all columns
    def __init__( self ):
        self.append( random.randrange( 1, 10 ) )
        self.append( random.randrange( 100, 1000 ) )
        # ... for all columns

myData = [ SomeEntity() for i in range(10000) ]
aFile= open( 'tmp.csv', 'wb' )
dest= csv.writer( aFile )
dest.writerow( SomeEntity.titles )   
dest.writerows( myData )
aFile.close() 
```

对于多个实体，您必须计算出基数。您不想生成随机密钥，而是希望从其他实体中进行随机选择。因此，您可能让 ChildEntity 从 ParentEntity 中选择一个随机元素，以确保 FK-PK 关系是正确的。

使用`random.choice(someList)`并`random.shuffle(someList)`确保参照完整性。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-01T13:50:09.240

Visual Studio Team System Database Edition（又名 Data Dude）就是这样做的。

我还没有将它用于数据生成，但有 2 个功能听起来不错：

1.  为随机数据生成器设置您自己的种子值。这使您可以多次生成相同的随机数据。

2.  将向导指向“真实”数据库并让它生成看起来像真实数据的东西。

也许这些是其他地方的标准功能？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-03T15:09:01.713

我刚刚发现了一个：[Spawner](http://spawner.sourceforge.net/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-01T14:22:29.367

为此，我使用了一个名为[Datatect](http://www.datatect.com/)的工具。

我喜欢这个工具的一些事情：

1.  使用 ODBC，因此您可以将数据生成到任何 ODBC 数据源中。我已经将它用于 Oracle、SQL 和 MS Access 数据库、平面文件和 Excel 电子表格。
2.  可通过 VBScript 扩展。您可以在数据生成工作流程的各个部分编写挂钩以扩展该工具的功能。
3.  有参考意义。填充外键列时，从父表中提取有效键。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-15T19:35:21.670

这个是免费的：[http](http://www.sqldog.com) ://www.sqldog.com 包含几个功能，如：数据生成器、全文搜索、创建数据库文档、活动数据库连接

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-01T13:39:07.287

我以前用过这个

[http://sqlmanager.net/en/products/mssql/datagenerator](http://sqlmanager.net/en/products/mssql/datagenerator)

虽然它不是免费的。

Ref 完整性检查非常重要，否则如果没有关联相关数据，您的测试将无法进行。（在大多数情况下）

# svn - 使用 VisualSVN 服务器通过 http 获取特定修订

> ID：157603
> 
> 赞同：33
> 
> 时间：2008-10-01T13:29:00.290
> 
> 标签：svn, http, version-control, visualsvn, visualsvn-server

我正在使用 VisualSVN Server 来托管 SVN 存储库，对于一些自动化工作，我希望能够通过 http[s] 层获取特定版本。

我可以通过对服务器的 http[s] 请求（httpd？）简单地获得 HEAD 版本 - 但是是否有任何能力指定修订，也许作为查询字符串？我好像找不到...

除非我能帮上忙，否则我不想结帐，因为特定文件夹中有很多文件，我不想要全部 - 只需要一两个。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2010-06-21T12:59:10.603

迟到总比不到好; [https://entire/Path/To/Folder/file/?p=REV](https://entire/Path/To/Folder/file/?p=REV)

?p=Rev 指定版本

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-22T11:24:52.000

不知道，如果您已经找到了这个问题的答案，但是在 apache 上的常规 svn 服务器中，您可以通过以下方式获得特定的修订：

```
http://host/svn-name/!svn/bc/REVISION_NUMBER/path/to/file.ext 
```

*   主机和 REVISION_NUMBER 很明显
*   /path/to/file.ext 相对于 repo root

我从来没有使用过visualsvn，所以你的里程可能会有所不同。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-01T13:59:02.463

Subversion 不会公开记录它在内部使用来访问该信息的 Uris。（并且在记录的地方，明确指出这可以在未来的版本中改变）

要在网络上访问这些信息，您可以使用网络查看器（例如[websvn、](http://websvn.tigris.org)[viewvc](http://viewvc.org)）。

如果你想从你自己的程序中访问它，你也可以使用像 SharpSvn 这样的客户端绑定。

```
using (SvnClient client = new SvnClient())
using (FileStream fs = File.Create("c:\\temp\\file.txt"))
{
    // Perform svn cat http://svn.collab.net/svn/repos/trunk/COMMITTERS -r 23456 
    //                    > file.txt

    SvnCatArgs a = new SvnCatArgs();
    a.Revision = 23456;
    client.Cat(new Uri("http://svn.collab.net/svn/repos/trunk/COMMITTERS"), a, fs);
} 
```

[2008-12-31 更新：接下来的几个 Subversion 版本之一将开始记录可用于检索旧版本的公共 url。]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T12:24:29.110

这：

[在 Subversion 中使用 WebDAV](http://svn.apache.org/repos/asf/subversion/trunk/notes/http-and-webdav/webdav-usage.html)

应该有帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-02-22T11:54:47.747

VisualSVN Web 界面的[帮助页面](https://www.visualsvn.com/server/features/svn-web-interface/)建议使用格式如下之一的地址：

```
link to r1484 commit in the serf's project repository:
https://demo-server.visualsvn.com/!/#serf/commit/r1484/

link to the current content of the trunk/context.c file in the serf's project repository:
https://demo-server.visualsvn.com/!/#serf/view/head/trunk/context.c

link to the content of trunk/context.c file at revision r2222 in the serf's project repository:
https://demo-server.visualsvn.com/!/#serf/view/r2222/trunk/context.c 
```

关键似乎**是以 'r' 为前缀**的 repo 修订号。这里没有其他答案提到这一点，并且使用像这样格式化的地址，我能够从我们的 VisualSVN 服务器查看源文件的特定修订版。

# flash - 如何动态创建基于 Actionscript 2 MovieClip 的类

> ID：157628
> 
> 赞同：1
> 
> 时间：2008-10-01T13:35:33.723
> 
> 标签：flash, actionscript-2, dynamic-data

我创建了一个辅助方法，它允许在代码中使用基于 MovieClip 的类并调用构造函数。不幸的是，该解决方案并不完整，因为从未调用过 MovieClip 回调**onLoad() 。**

（链接到创建该方法的[Flashdevelop 线程。）](http://www.flashdevelop.org/community/viewtopic.php?f=13&t=458)

如何修改以下函数，以便正确调用**构造函数**和**onLoad() 。**

```
 //------------------------------------------------------------------------
    //  - Helper to create a strongly typed class that subclasses MovieClip.
    //  - You do not use "new" when calling as it is done internally.
    //  - The syntax requires the caller to cast to the specific type since 
    //    the return type is an object. (See example below).
    //
    //  classRef, Class to create 
    //  id,       Instance name
    //  ...,      (optional) Arguments to pass to MovieClip constructor
    //  RETURNS   Reference to the created object 
    //  
    //  e.g., var f:Foo = Foo( newClassMC(Foo, "foo1") );
    //
    public function newClassMC( classRef:Function, id:String ):Object 
    {
      var mc:MovieClip = this.createEmptyMovieClip(id, this.getNextHighestDepth()); 
      mc.__proto__ = classRef.prototype; 

      if (arguments.length > 2) 
      {
        // Duplicate only the arguments to be passed to the constructor of
        // the movie clip we are constructing.
        var a:Array = new Array(arguments.length - 2);
        for (var i:Number = 2; i < arguments.length; i++)
          a[Number(i) - 2] = arguments[Number(i)];

        classRef.apply(mc, a);
      }
      else
      {
        classRef.apply(mc);
      }

      return mc; 
    } 
```

我可能要创建的类的示例：

```
class Foo extends MovieClip 
```

以及我目前如何在代码中创建类的一些示例：

```
// The way I most commonly create one:
var f:Foo = Foo( newClassMC(Foo, "foo1") );

// Another example...
var obj:Object  = newClassMC(Foo, "foo2") );
var myFoo:Foo   = Foo( obj ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T22:42:42.947

我是否正确理解您想要创建一个带有类行为的空影片剪辑的实例，而不必在库中定义一个空剪辑元件？

如果是这种情况，您需要使用包技巧。这是我多年来在数百个项目中一直使用的基类（称为 View）：

```
import mx.events.EventDispatcher;

class com.tequila.common.View extends MovieClip
{
    private static var _symbolClass : Function = View;
    private static var _symbolPackage : String = "__Packages.com.tequila.common.View";

    public var dispatchEvent : Function;
    public var addEventListener : Function;
    public var removeEventListener : Function;

    private function View()
    {
        super();

        EventDispatcher.initialize( this );

        onEnterFrame = __$_init;
    }

    private function onInitialize() : Void
    {
            // called on the first frame. Event dispatchers are
            // ready and initialized at this point.
    }

    private function __$_init() : Void
    {
        delete onEnterFrame;

        onInitialize();
    }

    private static function createInstance(symbolClass, parent : View, instance : String, depth : Number, init : Object) : MovieClip
    {
        if( symbolClass._symbolPackage.indexOf("__Packages") >= 0 )
        {
            Object.registerClass(symbolClass._symbolPackage, symbolClass);
        }

        if( depth == undefined )
        {
            depth = parent.getNextHighestDepth();
        }

        if( instance == undefined )
        {
            instance = "__$_" + depth;
        }

        return( parent.attachMovie(symbolClass._symbolPackage, instance, depth, init) );
    }

    public static function create(parent : View, instance : String, depth : Number, init : Object) : View
    {
        return( View( createInstance(_symbolClass, parent, instance, depth, init) ) );
    }
} 
```

所以，使用这个类你所要做的就是继承它：

```
class Foo extends View
{
    private static var _symbolClass : Function = Foo;
    private static var _symbolPackage : String = "__Packages.Foo";

    private function Foo()
    {
       // constructor private
    }

    private function onInitialize() : Void
    {
            // implement this to add listeners etc.
    }

    public static function create(parent : View, instance : String, depth : Number, init : Object) : Foo
    {
        return( Foo( createInstance(_symbolClass, parent, instance, depth, init) ) );
    }
} 
```

您现在可以像这样创建 Foo 的实例；

```
var foo : Foo = Foo.create( this ); 
```

假设“this”是某种类型的 MovieClip 或 View。

如果您需要将其与库符号一起使用，则只需在 _symbolPackage 成员上省略 __Packages 前缀。

希望这可以帮助...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-29T20:56:14.703

如果要创建带有附加参数的 Foo 类的实例，可以扩展 create 方法。在我的实现中，我正在使用 objectIds 创建节点：

```
var node : Node = Node.create(1,_root ); 
```

Node 类如下所示：

```
class Node extends View {

private static var _symbolClass : Function = Node;
private static var _symbolPackage : String = "Node";

private var objectId : Number;

private function Node() {
   // constructor private
   trace("node created ");
}

private function onInitialize() : Void {
    //add listeners
}

public static function create(id_:Number, parent : MovieClip,  instance : String, depth : Number, init : Object) : Node {
    var node :Node = Node( createInstance(_symbolClass, parent, instance, depth, init) )
    node.setObjectId(id_);
    return(node);
}   

//=========================== GETTERS / SETTERS
function setObjectId(id_:Number) : Void {
    objectId = id_;
}
function getObjectId() : Number {
    return objectId;
}} 
```

请注意，objectId 在私有构造函数 Node() 中未定义，但在 onInitialize() 中定义。

# asp.net-mvc - MVC 用户控件 + ViewData

> ID：157629
> 
> 赞同：9
> 
> 时间：2008-10-01T13:35:34.360
> 
> 标签：asp.net-mvc, model-view-controller, user-controls, viewdata

嗨，我是 MVC 的新手，我一直在摸索如何构建将 ViewData 返回给他们的 MVC 用户控件，但没有运气。我希望有人会发布有关如何解决此问题的分步解决方案。如果您可以使您的解决方案非常详细，那将有很大帮助。

抱歉，我的问题如此离散，我想澄清一下，我最终尝试做的是将 id 传递给控制器​​ actionresult 方法，并希望直接从控制器本身将其呈现给用户控件。我不确定如何从这种方法开始，并且想知道这是否可能。在我看来，它基本上看起来像这样

```
public ActionResult RTest(int id){
RTestDataContext db = new RTestDataContext();
var table = db.GetTable<tRTest>();
var record = table.SingleOrDefault(m=> m.id = id);

return View("RTest", record);
} 
```

在我的用户控件中，我想渲染该记录的对象，这就是我的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-01T14:04:14.510

如果我理解您的问题，您正在尝试将 ViewData 传递给用户控件。用户控件本质上是一个局部视图，所以你可以这样做：

```
<% Html.RenderPartial("someUserControl.ascx", viewData); %> 
```

现在在您的用户控件中，ViewData 将是您传入的任何内容...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T14:11:57.753

好的——我们使用 Json 数据

在 aspx 页面中，我们有一个调用控制器的 ajax 调用。查找 ajax 调用的可用选项参数。

url：这会调用类中的函数。（显然）我们的类名是JobController，函数名是updateJob，它不带参数。url 从类名中删除 controllerPortion。例如，要调用 updateJob 函数，url 将是“/Job/UpdateJob/”。

```
var data = {x:1, y:2};
$.ajax({
data: data,
cache: false,
url: '/ClassName/functionName/parameter',
dataType: "json",
type: "post",
success: function(result) {
//do something
},
error: function(errorData) {
alert(errorData.responseText);
}
}
); 
```

在 JobController 类中：

```
public ActionResult UpdateJob(string id)
{
   string x_Value_from_ajax = Request.Form["x"];
   string y_Value_from_ajax = Request.Form["y"];
   return Json(dataContextClass.UpdateJob(x_Value_from_ajax, y_Value_from_ajax));
} 
```

我们有一个映射 ajax 调用的 Global.asax.cs 页面。

```
public class GlobalApplication : System.Web.HttpApplication
    {
        public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
routes.MapRoute("Default",                 // Route name
    "{controller}/{action}/{id}",     // URL with parameters
        new { controller = "EnterTime", action = "Index", id = "" }  // Parameter defaults  (EnterTime is our default controller class, index is our default function and it takes no parameters.)
    );
  }
} 
```

我希望这能让你有个好的开始。祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T14:03:51.267

我很确定只要您扩展 System.Web.Mvc.ViewUserControl 并将其传入，就可以在用户控件中访问视图数据。我有一段代码：

```
<%Html.RenderPartial("~/UserControls/CategoryChooser.ascx", ViewData);%> 
```

并且可以从我的 CategoryChooser ViewData 中访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T14:06:06.427

不确定我是否完全理解您的问题，但这是我对“如何将用户控件添加到您的 ASP.NET MVC 项目”的回答。

在 Visual Studio 2008 中，您可以选择添加项目。在左侧的类别中，您可以选择 Visual C# > Web > MVC。有一个选项 MVC View User Control。选择它，选择一个名称，选择所需的母版页，您就可以开始了。

# .net - 为 XML 编码文本数据的最佳方法

> ID：157646
> 
> 赞同：70
> 
> 时间：2008-10-01T13:39:56.503
> 
> 标签：.net, xml, encoding, .net-2.0

我一直在寻找 .Net 中的通用方法来编码用于 Xml 元素或属性的字符串，但当我没有立即找到时感到很惊讶。那么，在我走得太远之前，我会不会错过内置功能？

假设它真的不存在，我正在整理我自己的通用`EncodeForXml(string data)`方法，并且我正在考虑最好的方法来做到这一点。

我正在使用的提示整个事情的数据可能包含像 &、<、" 等坏字符。它有时还可能包含正确转义的实体：&、< 和 "，这意味着只使用CDATA 部分可能不是最好的主意。这似乎有点笨拙；我宁愿最终得到一个可以直接在 xml 中使用的漂亮字符串值。

我过去曾使用正则表达式来捕获错误的＆符号，我正在考虑在这种情况下以及第一步中使用它来捕获它们，然后对其他字符进行简单的替换。

那么，这是否可以在不使其过于复杂的情况下进一步优化，还有什么我遗漏的吗？：

```
Function EncodeForXml(ByVal data As String) As String
    Static badAmpersand As new Regex("&(?![a-zA-Z]{2,6};|#[0-9]{2,4};)")

    data = badAmpersand.Replace(data, "&amp;")

    return data.Replace("<", "&lt;").Replace("""", "&quot;").Replace(">", "gt;")
End Function 
```

*对不起所有 C# 的人——我真的不在乎我使用哪种语言，但我想让 Regex 成为静态的，你不能在 C# 中做到这一点而不在方法之外声明它，所以这将是 VB 。网*

最后，我们仍然在我工作的 .Net 2.0 上，但如果有人可以将最终产品转化为字符串类的扩展方法，那也很酷。

**更新**前几个响应表明.Net 确实有内置的方法来做到这一点。但是现在我已经开始了，我有点想完成我的 EncodeForXml() 方法只是为了好玩，所以我仍在寻找改进的想法。值得注意的是：应该编码为实体的更完整的字符列表（可能存储在列表/映射中），并且比对串行不可变字符串执行 .Replace() 获得更好的性能。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-04-08T22:27:03.947

根据您对输入的了解程度，您可能必须考虑到[并非所有 Unicode 字符都是有效的 XML 字符](http://www.w3.org/TR/xml11/#charsets)。

*Server.HtmlEncode*和*System.Security.SecurityElement.Escape*似乎都忽略了非法 XML 字符，而System.XML.XmlWriter.WriteString*在*遇到非法字符时会抛出*ArgumentException （除非您禁用该检查，在这种情况下它会忽略它们）。*[此处](http://weblogs.sqlteam.com/mladenp/archive/2008/10/21/Different-ways-how-to-escape-an-XML-string-in-C.aspx)提供了库函数的概述。

**编辑 2011/8/14：**看到至少有几个人在过去几年中咨询过这个答案，我决定完全重写原来的代码，它有很多问题，包括[可怕的错误处理 UTF-16](https://stackoverflow.com/questions/1049947/should-utf-16-be-considered-harmful)。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;

/// <summary>
/// Encodes data so that it can be safely embedded as text in XML documents.
/// </summary>
public class XmlTextEncoder : TextReader {
    public static string Encode(string s) {
        using (var stream = new StringReader(s))
        using (var encoder = new XmlTextEncoder(stream)) {
            return encoder.ReadToEnd();
        }
    }

    /// <param name="source">The data to be encoded in UTF-16 format.</param>
    /// <param name="filterIllegalChars">It is illegal to encode certain
    /// characters in XML. If true, silently omit these characters from the
    /// output; if false, throw an error when encountered.</param>
    public XmlTextEncoder(TextReader source, bool filterIllegalChars=true) {
        _source = source;
        _filterIllegalChars = filterIllegalChars;
    }

    readonly Queue<char> _buf = new Queue<char>();
    readonly bool _filterIllegalChars;
    readonly TextReader _source;

    public override int Peek() {
        PopulateBuffer();
        if (_buf.Count == 0) return -1;
        return _buf.Peek();
    }

    public override int Read() {
        PopulateBuffer();
        if (_buf.Count == 0) return -1;
        return _buf.Dequeue();
    }

    void PopulateBuffer() {
        const int endSentinel = -1;
        while (_buf.Count == 0 && _source.Peek() != endSentinel) {
            // Strings in .NET are assumed to be UTF-16 encoded [1].
            var c = (char) _source.Read();
            if (Entities.ContainsKey(c)) {
                // Encode all entities defined in the XML spec [2].
                foreach (var i in Entities[c]) _buf.Enqueue(i);
            } else if (!(0x0 <= c && c <= 0x8) &&
                       !new[] { 0xB, 0xC }.Contains(c) &&
                       !(0xE <= c && c <= 0x1F) &&
                       !(0x7F <= c && c <= 0x84) &&
                       !(0x86 <= c && c <= 0x9F) &&
                       !(0xD800 <= c && c <= 0xDFFF) &&
                       !new[] { 0xFFFE, 0xFFFF }.Contains(c)) {
                // Allow if the Unicode codepoint is legal in XML [3].
                _buf.Enqueue(c);
            } else if (char.IsHighSurrogate(c) &&
                       _source.Peek() != endSentinel &&
                       char.IsLowSurrogate((char) _source.Peek())) {
                // Allow well-formed surrogate pairs [1].
                _buf.Enqueue(c);
                _buf.Enqueue((char) _source.Read());
            } else if (!_filterIllegalChars) {
                // Note that we cannot encode illegal characters as entity
                // references due to the "Legal Character" constraint of
                // XML [4]. Nor are they allowed in CDATA sections [5].
                throw new ArgumentException(
                    String.Format("Illegal character: '{0:X}'", (int) c));
            }
        }
    }

    static readonly Dictionary<char,string> Entities =
        new Dictionary<char,string> {
            { '"', "&quot;" }, { '&', "&amp;"}, { '\'', "&apos;" },
            { '<', "&lt;" }, { '>', "&gt;" },
        };

    // References:
    // [1] http://en.wikipedia.org/wiki/UTF-16/UCS-2
    // [2] http://www.w3.org/TR/xml11/#sec-predefined-ent
    // [3] http://www.w3.org/TR/xml11/#charsets
    // [4] http://www.w3.org/TR/xml11/#sec-references
    // [5] http://www.w3.org/TR/xml11/#sec-cdata-sect
} 
```

单元测试和完整代码可以在[这里](https://github.com/mkropat/.NET-Snippets/blob/master/XmlTextEncoder.cs)找到。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-01T13:47:56.297

SecurityElement.Escape

记录[在这里](https://msdn.microsoft.com/en-us/library/system.security.securityelement.escape(v=vs.110).aspx)

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-01T13:45:39.737

过去，我使用 HttpUtility.HtmlEncode 为 xml 编码文本。它执行相同的任务，真的。我还没有遇到任何问题，但这并不是说我将来不会。顾名思义，它是为 HTML 而不是 XML 制作的。

您可能已经阅读过它，但[这里有一篇](http://msdn.microsoft.com/en-us/library/wkc3acws(VS.71).aspx)关于 xml 编码和解码的文章。

编辑：当然，如果您使用 xmlwriter 或新的 XElement 类之一，则此编码已为您完成。实际上，您可以只获取文本，将其放在新的 XElement 实例中，然后返回元素的字符串 (.tostring) 版本。我听说[SecurityElement.Escape](http://msdn.microsoft.com/en-us/library/system.security.securityelement.escape(VS.80).aspx)也将执行与您的实用程序方法相同的任务，但尚未阅读或使用它。

EDIT2：忽略我对 XElement 的评论，因为你还在 2.0

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-08-29T14:36:46.613

System.Web.dll 中Microsoft 的~~[AntiXss 库](http://www.codeplex.com/AntiXSS)~~ [AntiXssEncoder 类](https://msdn.microsoft.com/en-us/library/system.web.security.antixss.antixssencoder%28v=vs.110%29.aspx)具有以下方法：

```
AntiXss.XmlEncode(string s)
AntiXss.XmlAttributeEncode(string s) 
```

它也有 HTML：

```
AntiXss.HtmlEncode(string s)
AntiXss.HtmlAttributeEncode(string s) 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-02-22T01:31:04.620

~~在.net 3.5+~~

 ~~```
new XText("I <want> to & encode this for XML").ToString(); 
```~~ 

给你：

~~`I &lt;want&gt; to &amp; encode this for XML`~~

事实证明，这种方法没有编码一些它应该编码的东西（比如引号）。

`SecurityElement.Escape`（[workmad3 的回答](https://stackoverflow.com/a/157672/64334)）似乎在这方面做得更好，它包含在.net 的早期版本中。

如果您不介意 3rd 方代码并希望确保没有非法字符进入您的 XML，我会推荐[Michael Kropat 的答案](https://stackoverflow.com/a/732135/64334)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-01T13:48:26.623

`XmlTextWriter.WriteString()`逃跑。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-01T13:46:40.777

System.XML 为您处理编码，因此您不需要这样的方法。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-01T13:46:07.003

如果这是一个 ASP.NET 应用程序，为什么不使用 Server.HtmlEncode() ？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-07T20:30:20.440

在这种情况下，您可能会受益于使用 WriteCData 方法。

```
public override void WriteCData(string text)
    Member of System.Xml.XmlTextWriter

Summary:
Writes out a <![CDATA[...]]> block containing the specified text.

Parameters:
text: Text to place inside the CDATA block. 
```

一个简单的示例如下所示：

```
writer.WriteStartElement("name");
writer.WriteCData("<unsafe characters>");
writer.WriteFullEndElement(); 
```

结果如下所示：

```
<name><![CDATA[<unsafe characters>]]></name> 
```

在读取节点值时，XMLReader 会自动去除内部文本的 CData 部分，因此您不必担心它。唯一的问题是您必须将数据作为 innerText 值存储到 XML 节点。换句话说，您不能将 CData 内容插入到属性值中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-03-19T16:32:58.833

如果您认真对待处理**所有**无效字符（不仅仅是少数“html”字符），并且您可以访问，那么这是对*值数据*`System.Xml`进行正确 Xml 编码的最简单方法：

 *```
string theTextToEscape = "Something \x1d else \x1D <script>alert('123');</script>";
var x = new XmlDocument();
x.LoadXml("<r/>"); // simple, empty root element
x.DocumentElement.InnerText = theTextToEscape; // put in raw string
string escapedText = x.DocumentElement.InnerXml; // Returns:  Something &#x1D; else &#x1D; &lt;script&gt;alert('123');&lt;/script&gt;

// Repeat the last 2 lines to escape additional strings. 
```

重要的是要知道这`XmlConvert.EncodeName()`是不合适的，因为这是针对实体/标签名称，而不是值。当您需要 Html 编码时，使用它就像 Url 编码一样。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-11-18T06:25:37.867

杰出的！这就是我能说的。

这是更新代码的 VB 变体（不在类中，只是一个函数），它将清理并清理 xml

```
Function cXML(ByVal _buf As String) As String
    Dim textOut As New StringBuilder
    Dim c As Char
    If _buf.Trim Is Nothing OrElse _buf = String.Empty Then Return String.Empty
    For i As Integer = 0 To _buf.Length - 1
        c = _buf(i)
        If Entities.ContainsKey(c) Then
            textOut.Append(Entities.Item(c))
        ElseIf (AscW(c) = &H9 OrElse AscW(c) = &HA OrElse AscW(c) = &HD) OrElse ((AscW(c) >= &H20) AndAlso (AscW(c) <= &HD7FF)) _
            OrElse ((AscW(c) >= &HE000) AndAlso (AscW(c) <= &HFFFD)) OrElse ((AscW(c) >= &H10000) AndAlso (AscW(c) <= &H10FFFF)) Then
            textOut.Append(c)
        End If
    Next
    Return textOut.ToString

End Function

Shared ReadOnly Entities As New Dictionary(Of Char, String)() From {{""""c, "&quot;"}, {"&"c, "&amp;"}, {"'"c, "&apos;"}, {"<"c, "&lt;"}, {">"c, "&gt;"}} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-04-23T11:04:48.150

您可以使用内置类[XAttribute](https://msdn.microsoft.com/en-us/library/system.xml.linq.xattribute%28v=vs.110%29.aspx)，它会自动处理编码：

```
using System.Xml.Linq;

XDocument doc = new XDocument();

List<XAttribute> attributes = new List<XAttribute>();
attributes.Add(new XAttribute("key1", "val1&val11"));
attributes.Add(new XAttribute("key2", "val2"));

XElement elem = new XElement("test", attributes.ToArray());

doc.Add(elem);

string xmlStr = doc.ToString(); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-03-30T09:55:02.430

这是使用 XElements 的单行解决方案。我在一个非常小的工具中使用它。我不需要第二次，所以我保持这种方式。（它肮脏的道格）

```
StrVal = (<x a=<%= StrVal %>>END</x>).ToString().Replace("<x a=""", "").Replace(">END</x>", "") 
```

哦，它只适用于 VB 而不是 C#

# sharepoint - Sharepoint WebParts

> ID：157661
> 
> 赞同：5
> 
> 时间：2008-10-01T13:45:07.490
> 
> 标签：sharepoint, web-parts, webpart-connection

假设您有几个 webpart，一个作为控制器，还有几个从控制器获取信息并对其进行操作。使用 ASP 2.0 中引入的消费者/生产者接口来建模是相当容易的。

您如何能够以相反的方式添加交互，同时仍然保持上述内容？

一个简单的例子是：用户在执行搜索的 webpart A 中输入信息，结果将显示在 webpart B 上。Webpart C 允许您过滤应该触发 webpart A 重新提交查询的结果，从而更新结果为 B。

在 WSS 3.0 中似乎无法做到这一点，因为在任何时候都只允许在所有连接中使用 1 个接口。

这甚至有意义吗？:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T13:51:02.157

启用任意控制通信的快速而肮脏的解决方案是使用递归查找控制和事件。让控件按控件类型在控件树中搜索所需内容，然后订阅发布控件上公开的事件。

我以前曾使用该技巧使标准服务器控件在嵌入到来自不同供应商的 CMS 系统中时能够相互查找，从而完全避免使用特定的通信 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T21:00:27.910

我认为 webpart A 获取对 webpart B 的引用并调用公共/内部方法/属性或为公共/内部事件订阅处理程序没有任何问题。这样做时要提一点：EnsureChildControls。我亲眼目睹了一个 webpart 对 PreRender 运行清晰，而另一个 webpart 甚至没有运行 CreateChildControls。

从 webpart A，获取您对 webpart B 的引用（在这种情况下，webpart B 是日历类型），如下所示：

```
 private Calendar _calendarWP = null;
    public Calendar CalendarWP
    {
      get
      {
          if (_calendarWP != null)
              return _calendarWP;
          else
              foreach (System.Web.UI.WebControls.WebParts.WebPartZone zone in this.WebPartManager.Zones)
                  foreach (System.Web.UI.WebControls.WebParts.WebPart webpart in zone.WebParts)
                      if (webpart is Calendar)
                      {
                          _calendarWP = (Calendar)webpart;
                          _calendarWP.EnsureChildControls();
                          return _calendarWP;
                      }
          return null;
      }
    } 
```

现在您可以像这样获取一些新数据并更新日历：

```
 IEnumerable newData = SomeDataProvider.GetNewData(args);
        CalendarWP.someGridView.DataSource = newData;
        CalendarWP.someGridView.DataBind(); 
```

或者也许让 webpart A 将对自身的引用扔给 webpart B，以便它可以使用 webpart A 的公共/内部属性为自己获取数据：

```
CalendarWP.UseWPAToFetchData(this); 
```

# python - 对 PyObjC 应用程序进行采样/分析的最佳方法是什么？

> ID：157662
> 
> 赞同：6
> 
> 时间：2008-10-01T13:45:12.123
> 
> 标签：python, cocoa, macos, pyobjc

使用 Activity Monitor/Instruments/Shark 进行采样将显示堆栈跟踪，其中包含 Python 解释器的 C 函数。查看相应的 Python 符号名称会很有帮助。是否有一些 DTrace 魔法可以做到这一点？Python 的 cProfile 模块可用于分析 Python 调用的各个子树，但对于了解整个应用程序响应用户事件的情况并没有多大用处。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T03:33:35.510

答案是“dtrace”，但它不适用于足够旧的 Mac。

[http://tech.marshallfamily.com.au/archives/python-dtrace-on-os-x-leopard-part-1/](http://tech.marshallfamily.com.au/archives/python-dtrace-on-os-x-leopard-part-1/)

[http://tech.marshallfamily.com.au/archives/python-dtrace-on-os-x-leopard-part-2/](http://tech.marshallfamily.com.au/archives/python-dtrace-on-os-x-leopard-part-2/)

# http - “方法未实现”错误 - Firefox 3

> ID：157667
> 
> 赞同：4
> 
> 时间：2008-10-01T13:46:02.933
> 
> 标签：http

从 CMS 的用户那里得到零星的错误；Ajax 请求有时会导致来自服务器的“501 方法未实现”响应。不是所有的时间；通常有效。

应用程序已经稳定了几个月。用户似乎在使用 Firefox 3

有没有人看到这个错误或对可能的原因有任何想法？

谢谢

伊恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-01T14:53:22.693

您可能需要检查服务器的日志以查看导致问题的原因。例如，这些请求可能是乱码，例如，由于 HTTP 1.1 持久连接实现中的缺陷。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T21:04:05.423

尝试这个

1.  尝试清除您的 cookie 和缓存
2.  在 URL 栏中输入 about:config，Firefox 的配置设置列表
3.  找到“network.automatic-ntlm-auth.trusted-uris”的设置
4.  设置要使用 NTLM 的服务器名称的值。
5.  找到“network.negotiate-auth.trusted-uris”的设置
6.  设置要使用 NTLM 的服务器名称的值。
7.  network.automatic-ntlm-auth.allow-proxies = True
8.  重新启动 Firefox - 测试应用程序的 URL

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-20T07:09:33.960

由于您的应用未在与您的服务相同的域上运行，因此会出现此问题。您需要通过添加“Access-Control-Allow-Origin”标头来配置您的服务器以接受这些调用。

# matlab - 在 MATLAB 中，如何更改子图的背景颜色？

> ID：157685
> 
> 赞同：7
> 
> 时间：2008-10-01T13:51:11.407
> 
> 标签：matlab, plot, background-color

我正在尝试更改 MATLAB 图中单个子图的背景颜色。

由于 UI 允许，这显然是可行的，但我找不到自动化它的功能。

我研究过`whitebg`，但它改变了整个图形的配色方案，而不仅仅是当前的子图。

（顺便说一下，我使用的是 MATLAB 6.1 版）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-01T13:58:53.620

您可以使用 set 命令。

```
set(subplot(2,2,1),'Color','Red') 
```

这将在子图位置 2、2、1 中为您提供红色背景。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-05T02:20:36.310

我知道您提到您使用的是 MATLAB 6.1，但值得一提的是，在较新版本的 MATLAB 中，您可以在对[SUBPLOT](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/subplot.html)的初始调用中指定其他属性-值对参数，从而实现更紧凑的语法。下面在 2×2 布局的左上角创建一个带有红色背景的坐标区：

```
subplot(2,2,1,'Color','r'); 
```

我不确定在哪个版本的 MATLAB 中引入了这种语法，因为[回到版本 7 (R14) 的发行说明](http://www.mathworks.com/access/helpdesk/help/techdoc/rn/rn_intro.html)似乎没有提到它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T13:57:48.677

我已经好几年没有使用 Matlab 了，但我认为它很可能是在 subplot 声明之后调用的 whitebg 方法，类似于设置标题的方式。

```
subplot(3, 2, 4), hist(rand(50)), whitebg('y'); 
```

# c++ - 使用 ofstream 将文本写入文件末尾

> ID：157689
> 
> 赞同：3
> 
> 时间：2008-10-01T13:51:35.697
> 
> 标签：c++, ofstream

如何使用 ofstream 将文本写入文件末尾而不擦除其内容？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-01T13:52:46.333

`ios::app`您可以在打开文件时传递标志：

```
ofstream ofs("filename", ios::app); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T13:55:25.937

您想追加到文件中。创建 ofstream 时使用 ios::app 作为文件模式。

追加将自动寻找到文件的末尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T13:53:38.843

使用 ios::app 作为文件模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-28T18:51:56.837

该`seekp()`功能允许您任意设置文件指针的位置，用于打开文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-27T14:42:04.920

正如人们上面提到的那样，以以下方式打开文件就可以了：

`ofstream out("path_to_file",ios::app);`

如果您想默认将数据附加到文件中，它将起到作用。

但是，如果你想走到文件的末尾，在程序的中间，默认模式不是`ios::app`，你可以使用下面的语句：

`out.seekp(0,ios::end)` 这会将放置指针从文件末尾放置 0 个字节。[http://www.cplusplus.com/reference/ostream/ostream/seekp](http://www.cplusplus.com/reference/ostream/ostream/seekp)

确保使用正确的 seekp()，​​因为 seekp() 有 2 个重载。在这种情况下，首选具有 2 个参数的那个。

# mshtml - 使用 MSHTML 在 WebBrowser 控件中修改请求/响应流

> ID：157693
> 
> 赞同：2
> 
> 时间：2008-10-01T13:52:02.980
> 
> 标签：mshtml

我需要找到一种方法来获取 webbrowser winforms 控件内的请求/响应流，并看到它不是真正直观的。例如，我需要能够在用户单击提交按钮时修改发布数据。看起来您必须注册一些 MSHTML COM 事件才能这样做，但不确定我需要订阅哪些（以及如何订阅）。过去有没有人这样做过？例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T09:27:30.753

看看异步可插入协议（IInternetProtocol）：

[http://msdn.microsoft.com/en-us/library/aa767743(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa767743(VS.85).aspx)

还有一个 C# 中的解决方案，它在 IE 中将其中一些用于自己的协议：

[http://www.codeproject.com/KB/aspnet/AspxProtocol.aspx](http://www.codeproject.com/KB/aspnet/AspxProtocol.aspx)

# xml - 检查 OUTPUT 中的重复元素

> ID：157705
> 
> 赞同：4
> 
> 时间：2008-10-01T13:55:11.973
> 
> 标签：xml, xslt, xslt-1.0

我有一些 XML，例如，它看起来像这样：

```
<root>
    <field1>test</field1>
    <f2>t2</f2>
    <f2>t3</f2>
</root> 
```

我想用 XSLT 对其进行转换，但我想抑制输出中的第二个 f2 元素 - 如何在处理源中的第二个 f2 元素时检查我的模板内部是否已经存在输出中的 f2 元素？我的 XSLT 目前看起来像这样：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="no" omit-xml-declaration="yes" standalone="no" />
  <xsl:template match="/">
    <xsl:for-each select="./root">
      <output>
        <xsl:apply-templates />        
      </output>
    </xsl:for-each>
  </xsl:template>
  <xsl:template match="*" >
      <xsl:element name="{name(.)}">
        <xsl:value-of select="." />
      </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

我需要对模板中的 xsl:element 进行某种检查，但我不确定如何查询输出文档以查看该元素是否已经存在。

编辑：忘记了 pre 标签，现在应该可以看到代码了！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-01T15:12:33.987

这取决于您想要的系统范围。

即，您是否只关心同一个父级的子级元素，或同一级别的所有元素（如果您愿意，则为“表亲”）或文档中的任何元素...

在第一种情况下，您可以检查前面的兄弟轴以查看是否存在具有相同名称的任何其他元素。

```
<xsl:if test="count(preceding-sibling::node()[name()=name(current())])=0">
  ... do stuff in here.
</xsl:if> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T15:38:55.110

仅检查（并警告您重复），您可以在[此处找到示例](http://www.biglist.com/lists/lists.mulberrytech.com/xsl-list/archives/200807/msg00444.html)

类似于以下内容：

```
<xsl:for-each-group select="collection(...)//@id" group-by=".">
  <xsl:if test="count(current-group()) ne 1">
    <xsl:message>Id value <xsl:value-of select="current-grouping-key()"/> is 
       duplicated in files
       <xsl:value-of select="current-group()/document-uri(/)" separator=" and
    "/></xsl:message>
  </xsl:if>
 </xsl:for-each-group> 
```

修改为选择“根”元素内的所有节点。

至于删除重复的行，你有另一个[例子here](http://graflex.org/klotz/weblog/2005/02/xslt-duplicate-elimination.html)

那看起来像：

```
<xsl:stylesheet>
  <xsl:key name="xyz" match="record[x/y/z]" use="x/y/z" />
  <xsl:variable name="noxyzdups" select="/path/to/record[generate-id(.) = generate-id(key('xyz', x/y/z))]" />
...
  <xsl:template ... >
    <xsl:copy-of "exslt:node-set($noxyzdups)" />
  </xsl:template>
</xsl:stylesheet> 
```

x/y/z 是您希望唯一的 xpath 表达式。它可以是 concat(x,'-',@y,'-',z) 或任何你想要的。

现在我不确定这两个示例是否可以轻松适应您的情况，但我只想指出这两个来源，以防万一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T00:34:06.040

无法询问转换的输出。也无法跟踪转换的当前状态（即跟踪您在变量中发出的节点）。从根本上说，这不是 XSLT 的工作方式。无副作用的编程环境的成本之一是你不能做有副作用的事情。那好吧。

在您的情况下，实现此目的的一种方法是构建一个变量，其中包含所有源元素的列表，这些源元素可以转换为您只想发出一次的输出元素。然后对照此列表检查您正在转换的每个节点。如果它不在列表中，则发出它。如果它是列表中的第一项，则发出它。否则，不要。

# tdd - 单一开发人员应该使用 TDD 的一些原因是什么？

> ID：157717
> 
> 赞同：35
> 
> 时间：2008-10-01T13:57:11.237
> 
> 标签：tdd, methodology

我是一名经验丰富的合同程序员。我习惯于被客户雇佣，自己去做一个或另一种形式的软件项目，通常是白手起家。这意味着几乎每次都是白纸黑字。我可以引入我开发的库来快速入门，但它们始终是可选的。（并且取决于在合同中获得正确的 IP 条款）很多时候我可以指定甚至设计*硬件*平台......所以我们在这里谈论的是严肃的自由。

我可以看到为某些代码构建自动化测试的用途：具有不仅仅是琐碎功能的库、具有大量引用的核心功能等。基本上，随着一段代码的价值通过大量使用而上升，我可以看到它自动测试该代码会越来越有价值，这样我就知道我不会破坏它。

然而，*在我的情况下*，我发现很难合理化除此之外的任何事情。我会采用被证明有用的东西，但我不会盲目地遵循任何东西。

我发现我在“维护”中所做的许多事情实际上都是很小的设计更改。在这种情况下，测试不会为我节省任何东西，现在它们也必须改变。高度迭代、存根优先的设计方法对我来说非常有效。我看不到通过更广泛的测试实际上为自己节省了那么多时间。

爱好项目更难证明......它们通常是从周末到一个月的任何东西。边缘情况的错误很少有关系，这都是关于玩一些东西。

阅读诸如[this one](https://stackoverflow.com/questions/67898/tdd-and-productivity)之类的问题，投票最多的回复似乎是说，在该发布者的经验/意见中，如果您的人数少于5人，TDD实际上会浪费时间（即使假设具有一定水平的TDD能力/经验）。但是，这似乎涵盖了初始开发时间，而不是维护时间。目前尚不清楚 TDD 如何在项目的整个生命周期中叠加。

我认为 TDD 可能是朝着提高整个行业产品质量这一有价值目标迈出的重要一步。不过，理想主义本身不再能有效地激励我。

我*确实*认为 TDD 在大型团队或包含至少一个不可靠程序员的任何规模的团队中是一种好方法。那不是我的问题。

***为什么拥有良好记录的唯一开发人员会采用 TDD？***

我很想听听关于 TDD 的任何类型的指标（正式或非正式）......专注于单独的开发人员或非常小的团队。

如果做不到这一点，你个人经历的轶事也会很好。:)

请避免在没有经验的情况下发表意见来支持它。让我们不要把这变成一场意识形态战争。还有跳过更多就业选择的论点。 *这只是一个效率问题。*

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-01T14:07:05.207

> 我不会盲目地追随任何事情。

这才是正确的态度。我一直都在使用 TDD，但我并不像某些人那样严格遵守它。

支持 TDD 的最佳论据（在我看来）是，当您最终进入项目的重构和维护阶段时，您可以获得一组可以运行的测试。如果这是您使用 TDD 的唯一原因，那么您可以随时编写测试，而不是盲目地遵循方法论。

我使用 TDD 的另一个原因是编写测试让我提前考虑我的 API。在编写课程之前，我不得不考虑如何使用课程。让我的头脑进入这个高层次的项目对我有用。还有其他方法可以做到这一点，如果你找到了其他方法（有很多）来做同样的事情，那么我会说继续做对你有用的事情。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-01T14:00:21.650

我发现它在单飞时更有用。周围没有人可以提出想法，也没有人可以进行同行评审，你需要一些保证你的代码是可靠的。TDD/BDD 将为您提供这种保证。不过，TDD 有点相反。其他人可能完全不同意我所说的。

编辑：我可以补充一点，如果做得好，您实际上可以在编写测试的同时为您的软件生成规范。这是 BDD 的一个很大的副作用。如果您自己编写可靠的代码和规范，您可以让自己看起来像超级开发人员。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-12T17:03:56.940

好吧，轮到我了……我什至会自己做 TDD（对于非尖峰/实验/原型代码），因为

*   **三思而后**行：迫使我在开始编写代码之前思考我想要完成的工作。我想在这里完成什么......“如果我假设我已经拥有了这件作品......我希望它如何工作？” 鼓励对象的界面设计。
*   **更容易更改**：我可以放心地进行修改。“当我更改第 5 步时，我没有在第 1-10 步中破坏任何东西。” 回归测试是即时的
*   **更好的设计出现**：我发现更好的设计正在出现，而无需我在设计活动上投入精力。测试优先 + 重构导致松散耦合、使用最少方法的最少类.. 没有过度工程.. 没有 YAGNI 代码。这些类具有更好的公共接口、小方法并且更具可读性。这是一种禅宗的事情......你只有在“得到它”时才会注意到你得到了它。
*   **调试器不再是我的拐杖**：我知道我的程序做了什么......而无需花费数小时逐步完成我自己的代码。如今，如果我在调试器上花费超过 10 分钟.. 心理警报开始响起。
*   **帮助我按时回家**我注意到自 TDD 以来我的代码中的错误数量显着减少.. 即使断言类似于控制台跟踪而不是 xUnit 类型的 AT。
*   **生产力/流程**：它帮助我确定下一个离散的婴儿步骤，它将带我完成……让雪球滚滚。TDD 帮助我更快地进入节奏（或 XPers 所说的流程）。我在单位时间内完成了比以前更多的高质量工作。红绿重构循环变成了……一种永动机。
*   **我可以证明我的代码**只需按一下按钮即可工作
*   **熟能生巧，**我发现自己学习和发现龙的速度更快……有了更多的 TDD 时间。也许是不和谐......但我觉得即使我不先去测试，TDD 也让我成为了一个更好的程序员。发现重构机会已成为第二天性……

如果我想到任何更多，我会更新..这是我在最后 2 分钟的反思中想到的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-12T16:35:34.143

我也是一名合同程序员。这是我[喜欢单元测试的 12 个原因](http://ianfnelson.com/blog/why-unit-test/)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-01T14:27:18.217

我对 TDD 的最佳体验集中在[pyftpdlib](http://code.google.com/p/pyftpdlib/)项目上。大部分的开发都是由原作者完成的，我也做了一些小的贡献，但它本质上是一个单独的项目。该项目的测试套件非常全面，并测试了 FTPd 库的所有主要功能。在签入更改或发布版本之前，会检查所有测试，当添加新功能时，测试套件也会始终更新。

由于采用了这种方法，这是我从事过的唯一一个项目，在新版本发布后没有出现惊人的错误，签入的更改破坏了主要功能等。代码非常可靠，我在项目的生命周期中，很少有人打开错误报告给他留下了深刻的印象。我（和原作者）将这一成功很大程度上归功于全面的测试套件和随意测试每个主要代码路径的能力。

从逻辑的角度来看，您编写的任何代码都必须经过测试，如果没有 TDD，那么您将自己手动测试它。在 pyftpdlib 的另一面，按错误数量和主要问题频率计算的最差代码是仅由开发人员和 QA 手动测试新功能的代码。由于时间紧迫或落入裂缝，事情没有得到测试。旧的代码路径被遗忘，即使是最古老的稳定功能最终也会崩溃，主要版本最终会导致重要功能无法正常工作。等等。手动测试对于验证和测试的一些随机化至关重要，但根据我的经验，我会说同时拥有手动测试和精心构建的单元测试框架是必不可少的。在这两种方法之间，覆盖范围的差距更小，

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-01T14:01:19.387

您是否是唯一的开发人员并不重要。您必须从应用程序的角度考虑它。所有应用程序都需要正常工作，所有应用程序都需要维护，所有应用程序都需要减少错误。当然，在某些情况下，TDD 方法可能不适合您。这是截止日期很快临近并且没有时间执行单元测试的时候。

无论如何，TDD 不依赖于单人或团队环境。这取决于整个应用程序。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-01T14:06:26.907

我没有大量的经验，但我有过看到鲜明对比的测试方法的经验。

在一项工作中，没有自动化测试。“测试”包括在应用程序中四处寻找，尝试任何出现在你脑海中的东西，看看它是否坏了。不用说，完全损坏的代码很容易到达我们的生产服务器。

在我目前的工作中，有很多自动化测试和完整的 CI 系统。现在，当代码被破坏时，它立即显而易见。不仅如此，当我工作时，测试确实记录了我的代码中哪些功能正在运行，哪些还没有。它让我对能够添加新功能充满信心，因为我知道如果我破坏现有功能，它不会被忽视。

所以，对我来说，这不仅仅取决于团队的规模，而是取决于应用程序的规模。您可以跟踪应用程序的每个部分吗？每个要求？您需要运行每个测试以确保应用程序正常工作？如果您没有测试来证明，那么说应用程序正在“工作”是什么意思？

只是我的 0.02 美元。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-01T14:11:33.557

测试使您可以放心地重构，因为您不会破坏系统。首先编写测试允许测试定义系统的工作行为。任何未由测试定义的行为都被定义为副产品，并且在重构时允许更改。首先编写测试也可以推动设计朝着好的方向发展。为了支持可测试性，您发现您需要解耦类、使用接口并遵循良好的模式（例如控制反转）以使您的代码易于测试。如果您在之后编写测试，则无法确定您已经涵盖了测试中系统预期的所有行为。您还会发现，由于设计原因，有些东西很难测试——因为它很可能是在没有考虑测试的情况下开发的——并且很容易忽略或省略测试。

我通常独自工作，主要是做 TDD——在我不遵守实践或还没有找到适合我做 TDD 的好方法的情况下，例如使用 Web 界面.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-01T14:10:26.227

TDD 不是关于测试，而是关于编写代码。因此，它甚至为单个开发人员提供了很多好处。对于许多开发人员来说，编写更健壮的代码是一种思维转变。例如，您多久会想到“现在这段代码怎么会失败？” 在没有 TDD 的情况下编写代码之后？对于许多开发人员来说，这个问题的答案是否定的。对于 TDD 从业者来说，它会将思维方式转变为在对对象或字符串进行操作之前检查对象或字符串是否为空，因为您正在编写专门执行此操作的测试（破坏代码）。

另一个主要原因是变化。每当您与客户打交道时，他们似乎永远无法下定决心。唯一不变的就是变化。TDD 作为“安全网”有助于找到所有其他可能破坏的区域。即使在小型项目中，这也可以防止您在调试器中浪费宝贵的时间。

我可以继续说下去，但我认为说 TDD 更多的是关于编写代码而不是任何东西，这足以证明它作为单独的开发人员使用是合理的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-01T14:11:24.183

我倾向于同意您关于“一个开发人员”或“爱好”项目的 TDD 开销的观点的有效性，而不是证明这些费用是合理的。

但是，您必须考虑大多数最佳实践如果在很长一段时间内始终如一地应用，它们都是相关且有用的。

例如，从长远来看，TDD 可以节省您的测试/错误修复时间，而不是在您创建第一个单元测试后的 5 分钟内。

您是一名合同程序员，这意味着您将在当前项目完成后离开并切换到其他项目，很可能是在另一家公司。您当前的客户必须维护和支持您的应用程序。如果你不给支持团队留下一个好的框架来工作，他们就会被卡住。TDD 将有助于项目的可持续性。它将增加代码库的稳定性，因此经验较少的其他人将无法在尝试更改它时造成太大的损害。

这同样适用于爱好项目。你可能已经厌倦了，想把它传给别人。你可能会在商业上取得成功（想想 Craiglist），并且除了你之外还有 5 个人在工作。

对适当流程的投资总是有回报的，即使它只是获得了经验。但大多数时候你会感激当你开始一个新项目时你决定把它做好

做某事时必须考虑**其他人。**你必须提前思考，为**增长**做计划，为**可持续发展**做计划。

如果您不想这样做 - 坚持牛仔编码，这种方式要简单得多。

PS 同样的事情也适用于其他做法：

*   如果你不评论你的代码并且你有理想的记忆，你会没事的，但其他人阅读你的代码不会。
*   如果您不记录与客户的讨论，其他人将不会知道您做出的关键决定

等等无止境

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-01T14:11:39.580

如果没有一组合理的单元测试，我不再重构任何东西。

我不会先进行单元测试，然后再进行代码测试。我做 CALTAL -- Code A LIttle, Test A Little -- 开发。通常，代码先执行，但并非总是如此。

当我发现我必须重构时，我会确保我已经进行了足够的测试，然后我完全相信我不必保留整个旧架构变成新架构计划在我的脑海里。我只需要让测试再次通过。

我重构了重要的部分。让现有的测试套件通过。

然后我意识到我忘记了一些东西，我又回到了 CALTAL 开发新东西上。

然后我看到了我忘记删除的东西——但它们*真的*到处都没有使用吗？删除它们，看看测试中失败的地方。

就在昨天——通过一次大的重构——我意识到我仍然没有完全正确的设计。但是测试仍然必须通过，所以在我完成第一次重构之前，我可以自由地重构我的重构。（哇！）这一切都很好，因为我有一组测试来验证更改。

对于单飞 TDD 是我的副驾驶。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-12T20:01:18.500

TDD 让我更清楚地定义了我脑海中的问题。这有助于我专注于实现所需的功能，仅此而已。它还帮助我创建了一个更好的 API，因为我在编写代码本身之前正在编写一个“客户端”。我也可以重构而不必担心破坏任何东西。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-01T14:06:32.743

我将很快回答这个问题，希望你会开始看到一些推理，即使你仍然不同意。:)

如果你有幸参与了一个长期运行的项目，那么有时你会想要，例如，先编写数据层，然后可能是业务层，然后再向上移动。如果您的客户随后进行了需要对数据层进行返工的需求更改，则数据层上的一组单元测试将确保您的方法不会以不良方式失败（假设您更新测试以反映新需求）。但是，您也可能会从业务层调用数据层方法，并且可能在多个地方调用。

假设您对业务层中的一个方法进行了 3 次调用，但您只修改了 2 次。在第三种方法中，您可能仍会从数据层取回看似有效的数据，但可能会破坏您的一些假设几个月前编码。此级别（及更高级别）的单元测试应该旨在发现被破坏的假设，并且在失败时它们应该向您强调有一段代码需要重新访问。

我希望这个非常简单的示例足以让您更多地考虑 TDD，并且它可能会产生火花，让您考虑使用它。当然，如果您仍然没有看到重点，并且您对自己跟踪数千行代码的能力充满信心，那么我没有地方告诉您应该开始 TDD。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-01T14:10:47.303

首先编写测试的关键在于它强制执行您正在制定的需求和设计决策。当我修改代码时，我想确保这些代码仍然被强制执行，并且很容易“破坏”某些东西而不会出现编译器或运行时错误。

我有一个测试优先的方法，因为我想对我的代码有高度的信心。当然，测试必须是好的测试，否则它们不会强制执行任何操作。

我有一些相当大的代码库可供我使用，并且有很多不平凡的事情正在发生。很容易做出改变，当 X 不应该发生时，X 突然发生。我的测试多次使我免于犯可能被人类测试人员忽视的严重（但微妙的）错误。

当测试确实失败时，他们有机会查看它们和生产代码并确保它是正确的。有时设计更改和测试需要修改。有时我会写出通过 100 次测试中的 99 次的东西。没有通过的那 1 个测试就像一个同事审查我的代码（在某种意义上）以确保我仍在构建我应该构建的东西。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-01T14:11:49.813

我觉得作为一个项目的独立开发人员，尤其是一个更大的项目，你往往会被分散得很薄。
当突然检测到由于某种原因在预发布测试期间没有出现的几个关键错误时，您正处于大规模重构的中间。在这种情况下，您必须放下所有东西并修复它们，在花了两周时间撕掉头发之后，您终于可以恢复到以前所做的任何事情。
一周后，您的一位最大客户意识到他们绝对必须拥有这个酷炫的新闪亮功能，否则他们将不会订购他们应该在一个月前已经订购的 100 万个单位。
现在，三个月后，你甚至不记得你为什么开始重构，更不用说你重构的代码应该做什么了。感谢上帝，你在编写这些单元测试方面做得很好，因为至少它们告诉你重构后的代码仍在做它应该做的事情。
起泡，冲洗，重复。

..我过去 6 个月的生活故事。：-/

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-01T14:12:20.560

唯一的开发人员应该在他的项目上使用 TDD（跟踪记录无关紧要），因为最终这个项目可能会被传递给其他一些开发人员。或者可以引入更多的开发人员。

如果没有测试，新人将很难使用代码。他们会破坏东西。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-01T14:23:55.570

当您交付产品时，您的客户是否拥有源代码？如果您可以说服他们通过单元测试交付产品会增加价值，那么您就是在向上销售您的服务并交付更好的产品。从客户的角度来看，测试覆盖率不仅可以确保质量，还可以让未来的维护人员更容易地理解代码，因为测试将功能与 UI 隔离开来。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-01T14:36:38.210

我认为 TDD 作为一种方法论不仅仅是“在进行更改时进行测试”，因此它不依赖于团队，也不依赖于项目规模。这是关于在一个人开始真正考虑如何实现所指出的行为之前，注意一个人对一段代码/应用程序的期望。TDD 的主要关注点不仅是为编写的代码进行测试，而且编写更少的代码，因为您只需做使测试绿色的事情（并在以后重构）。

如果您像我一样发现很难考虑部分/整个应用程序的功能而不考虑如何实现它，我认为在您的代码之后编写您的测试并因此让代码“驱动”测试。

如果您的问题不是关于先测试 (TDD) 或后测试（良好的编码？），我认为测试应该是任何开发人员的标准做法，无论是单独还是在一个大团队中，他们创建的代码仍然在生产中超过三个月。根据我的经验，在这段时间之后，即使是原作者也必须认真思考这 20 行复杂、超级优化但文档很少的代码真正的作用。如果您进行了测试（涵盖了代码的所有路径），则无需思考-甚至几年后也不会考虑 ERR..​​.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-01T16:04:51.803

以下是一些模因和我的回答：

“TDD 让我思考它会如何失败，这让我成为了一个更好的程序员”

如果有足够的经验，那么高度关注故障模式自然应该成为您流程的一部分。

“应用程序需要正常工作”

这假设您能够绝对测试所有内容。在正确地覆盖所有可能的测试方面，你不会比一开始就正确地编写功能代码更好。“应用程序需要*更好*地工作”是一个更好的论点。我同意这一点，但它是理想主义的，而且还不够具体，无法像我希望的那样激励。指标/轶事在这里会很棒。

“非常适合我的 <library component X>”

我在问题中说我在这些情况下看到了价值，但感谢你的轶事。

“想想下一个开发者”

这可能是我最好的论据之一。但是，很可能下一个开发人员也不会实践 TDD，因此在这种情况下，这将是一种浪费，甚至可能是一种负担。后门传福音就是在那里。不过，我很确定 TDD 开发人员会真正喜欢它。

当你继承一个已弃用的必须做的方法时，你会有多少欣赏项目？RUP，有人吗？如果 TDD 没有大家想象的那么好，想想 TDD 对下一个开发人员意味着什么。

“重构要容易得多”

重构和其他任何技能一样，是一种技能，迭代开发当然需要这种技能。如果我认为新设计从长远来看会节省时间，我倾向于丢弃大量代码，而且感觉也会丢弃大量测试。哪个更有效率？我不知道。

...

我可能会向任何新来的人推荐某种程度的 TDD……但是对于那些已经在街区附近几次的人来说，我仍然无法获得好处。我可能会开始向库中添加自动化测试。这样做之后，我可能会看到通常这样做的更多价值。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-07-17T21:38:35.953

激发自身利益。

就我而言，唯一的开发者转化为小企业主。我已经编写了合理数量的库代码来（表面上）让我的生活更轻松。很多这些例程和类都不是火箭科学，所以我可以通过审查代码、一些现场测试和调试方法来确保它们正常工作（至少在大多数情况下）以确保它们的行为方式我认为他们会。蛮力，如果你愿意的话。生活很好。

随着时间的推移，这个库不断增长，并被用于不同客户的更多项目中。测试变得更加耗时。特别是在我（希望）修复错误并且（甚至更有希望）不破坏其他东西的情况下。这不仅适用于我的代码中的错误。我必须小心添加功能（客户不断要求更多“东西”）或确保代码在移动到新版本的编译器（Delphi！）、第三方代码、运行时环境或操作系统时仍然有效。

走极端，我可以花更多的时间审查旧代码，而不是处理新的（阅读：可计费的）项目。将其视为软件的休止角（未经测试的软件在倒下之前可以堆叠多高:)。

像 TDD 这样的技术为我提供了设计更周到、测试更彻底（在客户得到它们之前）并且需要更少维护的方法和类。

最终，它转化为更少的时间进行维护，更多的时间花在更有利可图、更有趣（几乎任何事情）和更重要（如家庭）的事情上。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2019-03-28T05:33:05.143

我们都是拥有良好记录的开发人员。毕竟，我们都在阅读 Stackoverflow。我们中的许多人都使用 TDD，也许这些人有很好的记录。我被录用是因为人们想要一个编写出色的测试自动化并且可以教给其他人的人。独自工作时，我在家里对我的编码项目进行 TDD，因为我发现如果我不这样做，我会花时间进行手动测试甚至调试，而谁需要它。（也许那些人只有良好的记录。我不知道。）

当谈到成为一名优秀的汽车司机时，每个人都认为自己是一名“好司机”。这是所有司机都有的认知偏差。程序员有自己的偏见。像 OP 这样的开发人员不做 TDD 的原因在这个[Agile Thoughts 播客系列](https://agilenoir.biz/en/agilethoughts/why-developers-dont-tdd-a-radio-drama/)中进行了介绍。播客存档还包含有关测试自动化概念的内容，例如[测试金字塔，以及关于什么是 TDD 以及为什么首先在](https://agilenoir.biz/en/agilethoughts/test-automation-pyramid-series/)[播客存档](https://agilenoir.biz/series/agile-thoughts/)中的第 9 集开始编写测试的介绍。

# .net - 诊断错误的 OutputPaths：“未为此项目设置 OutputPath 属性”（在 Web 部署项目的精彩世界中）

> ID：157728
> 
> 赞同：2
> 
> 时间：2008-10-01T14:00:18.017
> 
> 标签：.net, web-deployment-project, deployment-project

从错误开始：

> 错误 81 未为此项目设置 OutputPath 属性。请检查以确保您指定了有效的配置/平台组合。配置='暂存'平台='AnyCPU' C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Microsoft.Common.targets 490 9 crm_deploy

我们有一个带有 Web 部署项目的 VS 2005 构建的网站。在此 WDP 中有两种配置，暂存和生产。

在整个网站的.sln中，我们有两个同名的配置，用来触发相应的部署项目。

生产构建良好，但暂存返回上述错误。我尝试更新 .wdproj 和 .sln 以便 Staging 匹配生产；我尝试通过更新这两个相同的文件将所有设置从生产复制到新配置（StagingX）。

在每种情况下，生产仍然有效，但我创建的任何新配置都会产生上述错误。

我在整个项目中查找了 Production 这个词，并尝试搜索 Googlespace，但没有找到任何可以解释问题的东西。WDP 是巨大的偏头痛制造设备。有任何想法吗？谢谢！

* * *

（我会按要求添加文件）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T18:59:06.607

显然，没有 Staging 构建的单独库可以破坏它，即使解决方案的 Staging 配置设置为使用库的 Debug 构建？

那好吧...

# ajax - AJAX 框架

> ID：157737
> 
> 赞同：4
> 
> 时间：2008-10-01T14:02:05.203
> 
> 标签：ajax, struts, toolkit

您可以推荐哪种 Ajax 框架/工具包来构建使用 struts 的 Web 应用程序的 GUI？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T19:18:58.487

我会说您的 AJAX/javascript 库选择应该更少地取决于您的后端是如何实现的，而更多地取决于您的 UI 将是什么。

如果您的网站主要是带有一些 AJAX 的静态网页，那么最好使用更轻量级的 javascript 框架，例如[jquery](http://jquery.com)。但是，如果您正在创建一个更像 Web 应用程序的 UI，用户会长时间停留在一个页面上（想想 gmail、google 日历等），那么最好看一下[Dojo](http://dojotoolkit.org/)、[ExtJs](http://extjs.com)或[GWT](http://code.google.com/webtoolkit/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-08T00:54:39.490

我建议使用 JQuery 的[UI](http://jqueryui.com/)插件。

[jQuery](http://jquery.com/)，[原型](http://www.prototypejs.org/)，[雅虎！User Interface](http://developer.yahoo.com/yui/)、[MooTools](http://mootools.net/)、[dojo](http://dojotoolkit.org/)和[ExtJS](http://www.extjs.com/)将让您使用非常可靠的代码。我无法为自己担保的其他可能性：[QooxDoo](http://qooxdoo.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T02:33:16.860

已经提到过，但我再说一遍：jQuery。jQuery 的强大之处不仅在于能够进行简单的 AJAX 调用或出色的 UI 扩展库。在我看来，jQuery 最好的部分是如何轻松处理返回数据。jQuery 允许您像浏览 HTML 一样轻松浏览 XML。

例如，假设您返回一个 xml 请求：

（：从 MarkLogic 培训文件中借用了这个 XML 文档：）

```
<author name="Boynton">
  <book>
    <title>Barnyard Dance!</title>
    <year>1993</year>
  </book>
  <book>
    <title>Hippos Go Berserk!</title>
    <year>1996</year>
  </book>
</author> 
```

jQuery 可以使用这个简单的命令检索所有年份元素：

```
var years = $("year");

//Ok, lets act on each element instead

$("year").each(function(index, value){
   alert("Element " + index + " = " + value);
});

/* OUTPUT
   Element 0 = 1993
   Element 1 = 1996
/* 
```

尝试在普通的 Javascript 中执行此操作！

此外，jQuery 的设计方式非常漂亮。创始人鼓励通过在库的核心中添加创建扩展的能力来扩展框架（确保您始终可以只编辑 Javascript 文件，但是当框架发生关键更新时会发生什么）。

使用 jQuery 的另一个重要原因是它与其他 Javascript 框架的兼容性。默认情况下，Prototype 和 jQuery 都使用“$”符号来引用主库对象。只有 jQuery 添加了删除此引用的功能，因此它可以与 Prototype 共存。

jQuery 让 JavaScript 变得有趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T14:18:58.297

我会选择 ExtJS ( [http://extjs.com/](http://extjs.com/) )。它有一个非常好的组件和事件模型以及非常好的支持。这是最好的 AJAX ;)

您可以使用带有 JSON 响应的操作向 Ext 前端提供数据。您甚至不需要将客户端前端与服务器前端混合（通过 JSPX / 标签）。

有些人认为您必须开发与服务器前端分开的客户端前端作为 Ext 的一个缺点。我认为不是，因为我已经将使用 Ext 构建的 Web 应用程序从 java 后端切换到 .Net 后端，而无需更改一行客户端前端代码，无论是 HTML 还是 Javascript。

在您决定之前，请先查看 Ext 示例和文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T14:03:45.247

Struts 已经随[Dojo](http://dojotoolkit.org/)框架一起提供。您可以将应用程序主题设置为 ajax，然后就可以使用它了。

看看 struts.properties 文件中的 struts.ui.theme 属性！

[JavaWorld 上](http://www.javaworld.com/javaworld/jw-08-2007/jw-08-ajaxtables.html)的一篇好文章供您阅读

# vbscript - VBScript——使用错误处理

> ID：157747
> 
> 赞同：91
> 
> 时间：2008-10-01T14:04:32.217
> 
> 标签：vbscript, error-handling

我想使用 VBScript 来捕获错误并记录它们（即在错误“记录某些东西”时），然后恢复脚本的下一行。

例如，

```
出错时继续下一步
'执行步骤 1
'执行第 2 步
'执行第 3 步

```

当第 1 步发生错误时，我希望它记录该错误（或使用它执行其他自定义功能）然后在第 2 步恢复。这可能吗？我该如何实施？

编辑：我可以做这样的事情吗？

```
错误恢复 myErrCatch
'执行步骤 1
'执行第 2 步
'执行第 3 步

我的错误捕获：
'记录错误
继续下一步

```

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2008-10-01T14:11:01.407

VBScript 没有抛出或捕获异常的概念，但运行时提供了一个全局 Err 对象，该对象包含上次执行的操作的结果。您必须在每次操作后显式检查 Err.Number 属性是否非零。

```
On Error Resume Next

DoStep1

If Err.Number <> 0 Then
  WScript.Echo "Error in DoStep1: " & Err.Description
  Err.Clear
End If

DoStep2

If Err.Number <> 0 Then
  WScript.Echo "Error in DoStop2:" & Err.Description
  Err.Clear
End If

'If you no longer want to continue following an error after that block's completed,
'call this.
On Error Goto 0 
```

Visual Basic 和 Visual Basic for Applications (VBA) 支持“On Error Goto [label]”语法，但 VBScript 不支持此语言功能，因此您必须如上所述使用 On Error Resume Next。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-04-27T21:26:56.813

请注意，这`On Error Resume Next`不是全局设置的。您可以将代码的不安全部分例如放入一个函数中，如果发生错误，该函数将立即中断，并从包含先例`OERN`语句的 sub 调用此函数。

```
ErrCatch()

Sub ErrCatch()
    Dim Res, CurrentStep

    On Error Resume Next

    Res = UnSafeCode(20, CurrentStep)
    MsgBox "ErrStep " & CurrentStep & vbCrLf & Err.Description

End Sub

Function UnSafeCode(Arg, ErrStep)

    ErrStep = 1
    UnSafeCode = 1 / (Arg - 10)

    ErrStep = 2
    UnSafeCode = 1 / (Arg - 20)

    ErrStep = 3
    UnSafeCode = 1 / (Arg - 30)

    ErrStep = 0
End Function 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-06-24T09:48:53.650

您可以在外观函数中重新组合您的步骤函数调用：

```
sub facade()
    call step1()
    call step2()
    call step3()
    call step4()
    call step5()
end sub 
```

然后，让您的错误处理在调用外观的上层函数中：

```
sub main()
    On error resume next

    call facade()

    If Err.Number <> 0 Then
        ' MsgBox or whatever. You may want to display or log your error there
        msgbox Err.Description
        Err.Clear
    End If

    On Error Goto 0
end sub 
```

现在，让我们假设`step3()`引发了一个错误。由于`facade()`不处理错误（**没有** `On error resume next`in ） ，`facade()`错误将被返回`main()`并且不会被执行。`step4()``step5()`

您的错误处理现在在 1 个代码块中重构

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-07T21:08:11.797

我对 VBScript 非常陌生，所以这可能不被认为是最佳实践，或者可能有原因不应该以我还不知道的方式这样做，但这是我想出的修剪解决方案减少我的主代码块中的错误记录代码量。

```
Dim oConn, connStr
Set oConn = Server.CreateObject("ADODB.Connection")
connStr = "Provider=SQLOLEDB;Server=XX;UID=XX;PWD=XX;Databse=XX"

ON ERROR RESUME NEXT

oConn.Open connStr
If err.Number <> 0 Then : showError() : End If

Sub ShowError()

    'You could write the error details to the console...
    errDetail = "<script>" & _
    "console.log('Description: " & err.Description & "');" & _
    "console.log('Error number: " & err.Number & "');" & _
    "console.log('Error source: " & err.Source & "');" & _
    "</script>"

    Response.Write(errDetail)       

    '...you could display the error info directly in the page...
    Response.Write("Error Description: " & err.Description)
    Response.Write("Error Source: " & err.Source)
    Response.Write("Error Number: " & err.Number)

    '...or you could execute additional code when an error is thrown...
    'Insert error handling code here

    err.clear
End Sub 
```

# c# - Windows Vista 中的浏览器帮助程序对象 (BHO) 仅具有管理员权限？

> ID：157755
> 
> 赞同：4
> 
> 时间：2008-10-01T14:05:39.967
> 
> 标签：c#, .net, windows-vista, bho

对于一个大学项目，我编写了一个 Internet Explorer 浏览器帮助器对象来在浏览时处理 Web 文档信息。它在带有 IE6 和 IE7 的 Windows XP 上运行成功。

现在我遇到的问题是，在 Windows Vista 下，相同的 BHO 需要管理员权限才能运行。如果您以管理员身份启动 IE，浏览器和 BHO 会运行，但如果您以普通用户身份启动，则会崩溃。

BHO 当然是在系统上注册并在浏览器中激活的。

我该怎么做才能让具有非管理员权限的用户运行已注册和激活的 BHO？或者可能是其他原因，我完全想念它？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T05:01:39.437

不确定您的问题是否与安装程序中的自定义操作有关，但以下两个链接应该对您有所帮助。

*   考虑到 UAC 构建 BHO - [http://simonguest.com/blogs/smguest/archive/2006/11/19/Building-Browser-Helper-Objects-using-Managed-Code.aspx](http://simonguest.com/2006/11/20/building-browser-helper-objects-using-managed-code/)（略过一半向下）

*   使用 NoImpersonate 脚本 - [http://blogs.msdn.com/astebner/archive/2007/05/28/2958062.aspx](http://blogs.msdn.com/astebner/archive/2007/05/28/2958062.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T15:21:31.093

您应该使用调试器来确定插件崩溃的*原因。*您尝试写入受保护位置的机会很大，如果失败，您的代码将无法检查错误结果。

使用 Process Monitor 并观察 Access_Denied 返回通常很有帮助，但使用完整的调试器是正确的方法。

# cocoa - 如何以编程方式确定正在运行的 Mac OS X 版本？

> ID：157759
> 
> 赞同：14
> 
> 时间：2008-10-01T14:06:07.550
> 
> 标签：cocoa, macos, macos-carbon

我有一个程序需要在 Tiger 上的行为与在 Leopard 上的行为略有不同。有谁知道系统调用可以让我准确确定正在运行的 Mac OS XI 版本。我找到了一些宏定义来确定构建机器的操作系统，但没有什么能很好地确定正在运行的机器的操作系统。

谢谢，乔

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-01T14:13:32.430

[在这里看到这篇文章](http://cocoadevcentral.com/articles/000067.php)

但简而言之，如果您使用的是 carbon，请使用 Gestalt() 调用，如果您使用的是 cocoa，则有一个名为 NSAppKitVersionNumber 的常量，您可以简单地检查它。

*编辑*：对于 Mac OSX 10.8 及更高版本，不要再使用 Gestalt() 了。有关更多详细信息，请参阅此答案：[如何在 OS X 或 iOS 中确定运行时的操作系统版本（不使用格式塔）？](https://stackoverflow.com/questions/11072804/mac-os-x-10-8-replacement-for-gestalt-for-testing-os-version-at-runtime)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-01T21:52:39.410

你能检查一个功能的存在吗？例如：

```
if (NSClassFromString(@"NSKeyedArchiver") != Nil) 
```

或者

```
if ([arrayController respondsToSelector: @selector(selectedIndexes)]) 
```

那么你就知道操作系统做了你需要它做的事情，而不是苹果的产品营销团队给了它一个特定的数字;-)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-01T14:15:27.043

API 通过格式塔管理器。

请参阅 CocoaDev 站点中的“[确定操作系统版本](http://www.cocoadev.com/index.pl?DeterminingOSVersion)”。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-01T14:10:56.837

在终端：

```
system_profiler SPSoftwareDataType 
```

给出：

```
Software:

    System Software Overview:

      System Version: Mac OS X 10.5.5 (9F33)
      Kernel Version: Darwin 9.5.0
      Boot Volume: Main
      Boot Mode: Normal
      Computer Name: phoenix
      User Name: Douglas F Shearer (dougal)
      Time since boot: 2 days 16:55 
```

或者：

```
sw_vers 
```

给出：

```
ProductName:    Mac OS X
ProductVersion: 10.5.5
BuildVersion:   9F33 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-01T15:19:52.397

操作系统版本真的是您想要的吗？可能有更合适的东西要测试，例如特定框架的存在或版本号。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-28T08:07:56.077

在您的程序中，您可以使用格式塔。这是我用于程序获取操作系统版本的代码。

```
long version = 0;
OSStatus rc0 = Gestalt(gestaltSystemVersion, &version);
if((rc0 == 0) && (version >= 0x1039)) {      
    // will work with version 10.3.9
    // works best with version 10.4.9
    return; // version is good
}
if(rc0) {
    printf("gestalt rc=%i\n", (int)rc0);
} else {
    printf("gestalt version=%08x\n", version);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-21T21:29:15.710

`respondsToSelector:`几乎可以肯定比你维护一个给定版本做什么和不实现的表格更好。

偷懒。让运行时告诉您它是否可以做某事，并在您需要时回退到旧方法。您的代码将不那么脆弱，因为您不必维护自己的全局数据，其余代码必须不断检查。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-16T20:07:45.537

在命令行中运行它：

```
system_profiler SPSoftwareDataType | grep Mac 
```

# locale - 不同国家/地区的日期/时间格式

> ID：157761
> 
> 赞同：3
> 
> 时间：2008-10-01T14:06:22.807
> 
> 标签：locale

网络上有没有可以找到世界各个国家使用的日期和时间格式的资源？我正在检查 Windows 控制面板中列出的语言，但缺少一些国家/地区（例如非洲国家等）。

我在网上找到了一些语言环境表，但这些通常与 Windows 中的设置不同，所以我不知道要使用哪个版本。

谢谢你，彼得

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-01T14:26:35.847

[Common Locale Data Repository](http://unicode.org/cldr/)是一个很好的语言环境数据资源。您可以从该网站下载数据库的 xml 版本，其中包括日期时间格式、数字格式和许多其他特定于语言环境的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T14:10:08.617

此网页显示如何根据文化设置使用日期和时间：http:
[//msdn.microsoft.com/en-us/library/5hh873ya.aspx](http://msdn.microsoft.com/en-us/library/5hh873ya.aspx)

我假设您正在编程，所以这可能会帮助您根据环境设置创建日期时间。

至于使用 Windows 设置与研究设置，如果您正在为 Windows 制作东西，请使用 Windows 设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T14:13:07.343

[这个维基百科页面](http://en.wikipedia.org/wiki/Calendar_date#dd.2Fmm.2Fyyyy_or_dd.mm.yyyy_.28day.2C_month.2C_year.29)是我发现的最全面的页面，但它遇到的问题与您在控制面板中提到的问题大致相同。也许您可以通过使用您独立找到的任何信息更新它来提供帮助？

# css - 表格列格式

> ID：157770
> 
> 赞同：18
> 
> 时间：2008-10-01T14:08:49.243
> 
> 标签：css, css-tables, col

我正在尝试`<table/>`使用`<col/>`元素格式化列。我可以设置`background-color`,`width`等，但不能设置`font-weight`. 为什么它不起作用？

```
<table>
    <col style="font-weight:bold; background-color:#CCC;">
    <col>
    <tr>
        <td>1</td>
        <td>2</td>
    </tr>
    <tr>
        <td>3</td>
        <td>4</td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-01T21:29:22.210

据我所知，您只能在`<col>`元素上使用 CSS 格式化以下内容：

*   背景颜色
*   边界
*   宽度
*   能见度

此[页面](http://www.quirksmode.org/css/columns.html)有更多信息。

Herb 是对的 - 最好`<td>`直接设计 's 样式。我要做的是：

```
<style type="text/css">
   #mytable tr > td:first-child { color: red;} /* first column */
   #mytable tr > td:first-child + td { color: green;} /* second column */
   #mytable tr > td:first-child + td + td { color: blue;} /* third column */
   </style>
   </head>
   <body> 
   <table id="mytable">
    <tr>
      <td>text 1</td>
      <td>text 2</td>
      <td>text 3</td>
    </tr>
    <tr>
      <td>text 4</td>
      <td>text 5</td>
      <td>text 6</td>
    </tr>
    </table> 
```

但是，这在 IE 中不起作用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-01T14:56:58.037

您最好的选择是将您的样式直接应用于`<td>`标签。我从未使用过标签，但大多数浏览器允许您在and /级别`<col>`应用格式，但不能在中间级别应用。例如，如果您有`<table>``<td>``<th>`

```
<table>
    <tr class="Highlight">
        <td>One</td>
        <td>Two</td>
    </tr>
    <tr>
        <td>A</td>
        <td>B</td>
    </tr>
</table> 
```

那么这个 CSS 将不起作用

```
tr.Highlight { background:yellow } 
```

但这会

```
tr.Highlight td { background:yellow } 
```

另外：我假设您上面的代码仅用于演示目的，您实际上并不会内联应用样式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-13T16:02:29.370

你可能只需要这个：

```
tr td:first-child label {
    font-weight: bold;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T14:20:39.590

您是否尝试过通过 CSS 类应用样式？

以下似乎有效：

```
<style type="text/css"> 
  .xx {
  background: yellow;
  color: red;
  font-weight: bold;
  padding: 0 30px;
  text-align: right;
}

<table border="1">
  <col width="150" />
  <col width="50" class="xx" />
  <col width="80" />
<thead>
  <tr>
    <th>1</th>
    <th>2</th>
    <th>3</th>
    <th>4</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>1</td>
    <td>2</td>
    <td>3</td>
    <td>4</td>
    </tr>
</tbody>
</table> 
```

[col 元素的参考](http://reference.sitepoint.com/html/col)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-16T21:16:31.823

在我尝试设置表格样式时通读此内容，以使第一列为粗体文本，其他四列为普通文本。使用 col 标记似乎是可行的方法，但是虽然我可以使用 width 属性设置列的宽度，但 font-weight: bold 不起作用感谢您为我指明解决方案的方向。通过设置所有 td 元素的样式`td {font-weight: bold;}`，然后使用相邻的同级选择器来选择第 2-5 列并将它们的样式恢复为正常`td + td {font-weight: normal;}` Voila，一切都很好:)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-01T14:12:35.863

`col`标签必须在标签内`colgroup`，这可能与问题有关。

# c# - 如何使用 Visual Studio 2005 轻松地将 .Net Windows Form 应用程序转换为 Asp.net 应用程序？

> ID：157773
> 
> 赞同：1
> 
> 时间：2008-10-01T14:09:19.927
> 
> 标签：c#, asp.net, winforms

我在 .Net 中有一个非常基本的 Windows 窗体应用程序。所有代码都是 C#。我想把它变成一个 Asp.net 网络应用程序。我怎样才能轻松做到这一点？

我认为有一种简单的方法，因为我拖放到 Windows 窗体设计器上的控件与我拖放到 aspx 设计页面上的控件几乎相同。

注意：windows 窗体应用程序不会发出任何网络请求或任何东西......只是从本地机器读取一些文本文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T14:13:51.040

这里有两个大问题；首先——它们可能看起来一样，但它们的实现方式完全不同——所有的 UI 工作都需要重做，主要是从头开始。不过，您可能能够重用您实际的“执行”代码（即操作文件的逻辑）。

第二 - 定义“本地机器”。对于 ASP.NET 应用程序，这通常是服务器，这可能不是您想要的。你可以通过 javascript 在客户端做一些事情，但是沙盒安全模型会阻止你做很多文件 IO。

我建议也许看看 Silverlight，它介于两者之间 - 或者只是使用 ClickOnce 将现有的 winform exe 部署到远程客户端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T14:12:21.730

您可能会在通过 ASP.Net 从本地计算机读取文件时遇到问题：对于 ASP.Net 应用程序，本地计算机是 Web 服务器，而不是用户所在的计算机。

此外，它比您想象的要多得多。很可能在您的应用程序中的某个地方，您依赖于 Windows 窗体应用程序本质上是有状态的这一事实，并且在这方面迁移到 ASP.Net 将是一个粗鲁的觉醒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T14:12:00.093

界面将不得不改变，因为控件是不同的。如果您有支持的业务类和其他类似性质的项目，您可以将它们复制过来，但否则需要重新构建 UI。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T14:13:55.673

ASP.NET 和 Windows 窗体是 2 个完全不同的模型。是的，设计师是相似的，但是页面/表单的底层表示是不同的。主要区别在于 ASP.NET 是无状态的，因此您必须在操作之间调整存储数据的方法并将其推送到 Session 对象。

对于只有您会使用的本地应用程序，我的建议是坚持使用 Windows 窗体。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T14:14:30.617

这实际上取决于应用程序的设计方式。如果您在 Windows 窗体中拥有应用程序的所有“业务逻辑”，那么您将很难将其转换。如果逻辑在它自己的层中，它会容易得多。请意识到 Windows 和 Web 窗体之间存在很多差异；最大的问题之一是 Web 表单与用户断开连接，并且每次请求都会发送状态信息。Winforms当然功能更全。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T14:16:04.077

不幸的是，事情不会那么简单。您的 C# 代码和逻辑将很容易转移，但 WinForms UI 与 ASP.NET UI 完全不同。

如果您对可以使用与现有 C# 应用程序相同类型的非 HTML GUI 设计器设计的“Web 应用程序”感兴趣，请查看[Microsoft Silverlight](http://www.microsoft.com/SILVERLIGHT/)。它被设计为用于 Web 的新 Windows Presentation Foundation（WPF，WinForms 的继任者）的一个版本。

# javascript - 如何防止 Firefox XMLSerializer 大写节点

> ID：157781
> 
> 赞同：1
> 
> 时间：2008-10-01T14:10:32.017
> 
> 标签：javascript, firefox

我正在客户端用 JavaScript 创建一个 XML 文档，然后将其转换回字符串以发送到服务器。Mozilla 有一个方便的方法来完成此操作：`XMLSerializer().serializeToString()`，我正在使用它。但是，这种方法似乎有一个错误：它返回所有大写的节点名称和小写的所有属性名称（无论我用来创建节点的大小写如何）。

有什么办法可以规避这种行为并用我原来的大小写取回 XML 字符串？更一般地说，有什么方法可以在 Mozilla 中创建 XML 文档并将其返回为字符串，而不会覆盖您的大写？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T14:24:52.247

看起来您正在处理 HTML 文档。请尝试对 XML 文档进行操作。

`var oDocument = new DOMParser().parseFromString("<root />", "text/xml"); oDocument.documentElement.appendChild(oDocument.createElementNS("[http://myns](http://myns)", "x:test")); alert(new XMLSerializer().serializeToString(oDocument));`

或者

`var oDocument = document.implementation.createDocument("", "", null); oDocument.appendChild(oDocument.createElementNS("[http://myns](http://myns)", "x:test")); alert(new XMLSerializer().serializeToString(oDocument));`

问候

# .net - 如何在 LINQ 查询中使用 GROUP BY 获取 MAX 行？

> ID：157786
> 
> 赞同：101
> 
> 时间：2008-10-01T14:11:10.313
> 
> 标签：.net, linq, linq-to-sql

我正在寻找一种在 LINQ 中匹配以下 SQL 查询的方法。

```
Select max(uid) as uid, Serial_Number from Table Group BY Serial_Number 
```

真的在这方面寻求一些帮助。由于`Group By`语法，上述查询获取每个序列号的最大 uid。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-10-01T14:34:12.957

```
 using (DataContext dc = new DataContext())
        {
            var q = from t in dc.TableTests
                    group t by t.SerialNumber
                        into g
                        select new
                        {
                            SerialNumber = g.Key,
                            uid = (from t2 in g select t2.uid).Max()
                        };
        } 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2008-10-01T14:37:12.730

```
var q = from s in db.Serials
        group s by s.Serial_Number into g
        select new {Serial_Number = g.Key, MaxUid = g.Max(s => s.uid) } 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-08-21T17:48:23.713

在方法链形式中：

```
db.Serials.GroupBy(i => i.Serial_Number).Select(g => new
    {
        Serial_Number = g.Key,
        uid = g.Max(row => row.uid)
    }); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2010-07-24T12:24:28.263

我已经在 LinqPad 中检查了 DamienG 的答案。代替

```
g.Group.Max(s => s.uid) 
```

应该

```
g.Max(s => s.uid) 
```

谢谢！

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-02-24T12:50:42.247

如果您只需要这两个字段，答案是可以的，但是对于更复杂的对象，这种方法可能有用：

```
from x in db.Serials 
group x by x.Serial_Number into g 
orderby g.Key 
select g.OrderByDescending(z => z.uid)
.FirstOrDefault() 
```

...这将避免“选择新”

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-07-16T06:59:05.590

这可以使用 LINQ lamda 表达式中的 GroupBy 和 SelectMany 来完成

```
var groupByMax = list.GroupBy(x=>x.item1).SelectMany(y=>y.Where(z=>z.item2 == y.Max(i=>i.item2))); 
```

# wpf - WinForms 组件的 WPF 等效项是什么？

> ID：157795
> 
> 赞同：10
> 
> 时间：2008-10-01T14:12:18.080
> 
> 标签：wpf, winforms, components

Windows 窗体允许您开发组件，非可视元素，可以有一个设计器。内置组件包括 BackgroundWorker、Timer 和许多 ADO .NET 对象。这是一种为复杂对象提供简单配置的好方法，它支持设计人员辅助的数据绑定。

我一直在看WPF，似乎没有任何组件的概念。我是对的吗？是否有一些我错过的创建组件（或类似组件）的方法？

我接受了 Bob 的回答，因为经过大量研究后，我觉得花哨的 Adorners 可能是做到这一点的唯一方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-01T16:44:33.020

仅从我自己的观察来看，微软似乎正试图摆脱在 GUI 中使用组件和类似的东西。我认为 WPF 试图将 XAML 中的大部分内容限制为严格的 GUI 内容。我猜数据绑定将是唯一的例外。我知道我尝试将其他大部分内容保留在代码隐藏或单独的类或程序集中。

可能不是您想要的答案，但这是我的 0.02 美元。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-29T16:31:25.610

我也有同样的问题。类组件机制的优点是设计者可以将其添加到 Blend 中，使用属性编辑器在设计器中对其进行配置，并使用数据绑定。您如何看待下面的解决方案？有用。

```
public class TimerComponent : FrameworkElement
{
    public Timer Timer { get; protected set; }

    public TimerComponent()
    {
        if (!System.ComponentModel.DesignerProperties.GetIsInDesignMode(this))
        {
            Visibility = Visibility.Collapsed;
            Timer = new Timer(OnTimerTick, null, Timeout.Infinite, Timeout.Infinite);
        }
    }

    void OnTimerTick(object ignore)
    {
        Dispatcher.BeginInvoke(new Action(RaiseTickEvent));
    }

    #region DueTime Dependency Property

    public int DueTime
    {
        get { return (int)GetValue(DueTimeProperty); }
        set { SetValue(DueTimeProperty, value); }
    }

    public static readonly DependencyProperty DueTimeProperty =
        DependencyProperty.Register("DueTime", typeof(int), typeof(TimerComponent), new UIPropertyMetadata(new PropertyChangedCallback(OnDueTimeChanged)));

    static void OnDueTimeChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        var target = obj as TimerComponent;
        if (target.Timer != null)
        {
            var newDueTime = (int)e.NewValue;
            target.Timer.Change(newDueTime, target.Period);
        }
    }

    #endregion

    #region Period Dependency Property

    public int Period
    {
        get { return (int)GetValue(PeriodProperty); }
        set { SetValue(PeriodProperty, value); }
    }

    public static readonly DependencyProperty PeriodProperty =
        DependencyProperty.Register("Period", typeof(int), typeof(TimerComponent), new UIPropertyMetadata(new PropertyChangedCallback(OnPeriodChanged)));

    static void OnPeriodChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        var target = obj as TimerComponent;
        if (target.Timer != null)
        {
            var newPeriod = (int)e.NewValue;
            target.Timer.Change(target.DueTime, newPeriod);
        }
    }

    #endregion

    #region Tick Routed Event

    public static readonly RoutedEvent TickEvent = EventManager.RegisterRoutedEvent(
        "Tick", RoutingStrategy.Bubble, typeof(RoutedEventHandler), typeof(TimerComponent));

    public event RoutedEventHandler Tick
    {
        add { AddHandler(TickEvent, value); }
        remove { RemoveHandler(TickEvent, value); }
    }

    private void RaiseTickEvent()
    {
        RoutedEventArgs newEventArgs = new RoutedEventArgs(TimerComponent.TickEvent);
        RaiseEvent(newEventArgs);
    }

    #endregion
} 
```

并如下使用。

```
<StackPanel>
    <lib:TimerComponent Period="{Binding ElementName=textBox1, Path=Text}" Tick="OnTimerTick" />
    <TextBox x:Name="textBox1" Text="1000" />
    <Label x:Name="label1" />
</StackPanel> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T14:13:24.457

到目前为止，我认为唯一有意义的方法是使类的实例成为静态资源并从 XAML 配置它。这行得通，但如果有类似 WinForms 设计器组件托盘之类的东西可以容纳这些东西，那就太好了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T13:59:01.930

您可以将任何您喜欢的内容放入资源字典中，包括与 Wpf 没有任何关系的类。

以下 XAML 将字符串“Hello”直接添加到窗口中（实际字符串，而不是显示字符串的控件），您可以使用相同的方法放置任何内容 - 包括您自己编写的类到 XAML 文件中。

```
<Window  x:Class="MyApp.Window1"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    >
<Window.Resources>
    <sys:String x:Key="MyString">Hello</sys:String>
</Window.Resources>
</Window> 
```

# api - GB英语还是美国英语？

> ID：157807
> 
> 赞同：104
> 
> 时间：2008-10-01T14:14:44.097
> 
> 标签：api, naming-conventions, api-design

如果您有一个 API，并且您是英国开发人员，拥有高度国际化的受众，那么您的 API 应该是

```
setColour() 
```

或者

```
setColor() 
```

（以一个词为例。）

英国工程师通常对他们的“正确”拼写相当防御，但可以说美国拼写在国际市场上更“标准”。

我想问题是这有关系吗？其他语言环境的开发人员是否在为 GB 拼写而苦恼，还是通常很明显事物的含义？

应该都是美式英语吗？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-10-01T14:15:51.613

我倾向于使用美式英语，因为这已成为其他 API 的规范。例如，作为一名英语程序员，我对使用“颜色”没有任何问题。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-10-01T14:20:54.190

我不是母语人士。在写作中，我总是尝试使用`en-gb`. 然而，在编程中，我总是使用`en-us`英式英语而不是英式英语，原因与我不使用德语或法语作为标识符的原因大致相同。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-01T14:26:06.970

一般来说，我会成为 GB 拼写的坚持者，但我认为如果代码一致，代码会读起来更好，我发现：

```
Color lineColor = Color.Red; 
```

看起来比：

```
Color lineColour = Color.Red; 
```

我想最终这并不重要。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-01T14:16:47.163

取决于您在哪里看到大多数客户。我个人更喜欢在我的私人代码中使用 English-GB（例如 Colour），但我会使用 Color 来获取外部发布的应用程序/API/代码！

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-01T14:19:28.843

尽管我通常对正确拼写非常迂腐，但作为一名英国开发人员，我总是会使用美式“颜色”拼写。在我遇到的所有编程语言中，都是这样的，所以为了保持一致性，使用“颜色”很有意义。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-01T14:20:06.797

假设这是一个 Java 或 C# API，考虑到 IDE 中自动完成功能的普遍性，它可能并不重要。如果这是一种动态语言或现代 IDE 不是标准的语言，我会使用美国拼写。当然，我是美国人，因此显然有偏见，但似乎我从非英语母语的开发人员那里看到的大多数代码都使用美国拼写作为变量名等。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-01T15:56:28.953

作为一名英语程序员，我将 en-US 用于我的软件开发。美式英语在几乎所有其他 API 中都占主导地位，因此坚持一种拼写并消除歧义要容易得多。由于拼写本地化，寻找一种方法只是发现拼写偏离了一个字母是浪费时间。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-01T14:48:58.553

我会按照当前标准选择美国英语拼写。HTML 和 CSS 是具有拼写“颜色”的公认标准，其次，如果您正在使用像 .NET 这样的框架，那么您很可能已经在不同的名称空间中提供了颜色。

必须处理两个拼写的心理负担会阻碍而不是帮助开发人员。

```
Label myLabel.color = setColour(); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-01T14:18:50.187

我在使用非美式英语的 API 时遇到问题。只是因为拼写不同。我知道这些词是什么意思，但不同的拼写让我很吃惊。

我熟悉的大多数库和框架都使用美国拼写。当然，我是美国人，所以... 美式英语是我的母语。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-01T14:18:56.583

我得到了另一个样本：序列化和序列化。:)

就个人而言，我认为这并不重要。我参与过使用英式拼写国家的项目，他们使用英式拼写。它仍然是英语，由于 Intellisense，它并不重要。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-01T14:20:42.037

大多数开发文档（就像 MSDN）都是美式英语。

因此，如果您的目标是国际受众，最好保持主流并在您的 API 中使用美式英语。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-01T14:24:02.497

作为加拿大人，我经常遇到这种情况。我很难输入“颜色”，因为我的肌肉记忆一直在寻找“u”。

但是，我倾向于采用图书馆的语言。Java 有 Color 类，所以我使用颜色。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-01T14:35:12.847

如果可能的话，我会尝试寻找替代词。我会让 -ize 滑动。对于颜色，我可能会使用色调、墨水、前景/背景……

如果不是，作为一个英国人，我会使用 en-GB，因为我对我的国家和出身有一些自豪感。

然而，如果它是一个更大项目的一部分，尤其是一个国际项目，我会保持整个项目的一致性，而不是让一小部分使用一种语言变体，其余的使用另一种语言。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-01T14:37:58.253

我是这样的人之一，每次我被迫在设置文件等中使用美式英语时，心率和血压都会升高，因为该软件没有提供英式英语的选项，但这只是我 ：）

然而，我个人对此的看法是提供两种拼写，给它们 setColor() 和 setColour()，在其中一个中编写代码，然后让第二个传递参数。

通过这种方式，您可以让两个群体都感到高兴，因为您的智能感知会变得更长一些，但至少人们不会抱怨您使用“错误”的语言。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-01T15:01:08.120

我也将不得不支持美式英语，只是为了保持一致（正如其他人已经在这里指出的那样）。虽然我的母语是美式英语，但我曾与德国和瑞典的软件公司合作过软件项目，在这两种情况下，我的队友偶尔会忍不住在代码中使用德语或瑞典语文本——通常是为了评论，但有时也用于变量或方法名称。尽管我会说这些语言，但它确实让人眼花缭乱，并且让新的不会说语言的人进入项目变得更加困难。

大多数欧洲软件公司（至少与我合作过的公司）的行为方式相同——代码保持为英文，仅仅是因为如果有其他程序员加入，这会使代码更加国际友好。不过，内部文档通常倾向于用母语完成。

也就是说，这里的区别在于两种不同的英语方言，这并不像在同一个源代码文件中看到两种完全不同的语言那么极端。所以我会说，保留美式英语的 API，但如果它更适合你，你的评论用 GB 英语。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-01T15:06:15.687

我想说看看你的语言中的其他库是如何选择和遵循他们的约定的。

编程语言及其内置 API 的设计者做出了选择，无论用户是否是国际用户，他们都习惯于看到与该选择一致的拼写。您不是针对说其他语言的人，而是针对编程语言的用户。奇怪的是他们已经从内置的 API 中学习了很多外语单词，而且他们可能不知道美国英语和英国英语之间存在差异。不要通过切换池塘的两侧来混淆它们。

我主要使用 .NET 语言，而 .NET Framework 使用美国英语拼写。在这个平台上，我会坚持使用美国英语。我不知道在 GB 英语上有任何标准化的语言，但如果您的语言已经这样做了，那么一定要与该语言保持一致。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-01T15:45:00.633

我同意“去美国”剧团。我自己在写电子邮件等时更喜欢 en-GB，但美式英语几乎是所有编程界的标准。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-01T16:10:58.637

尽管世界各地都在说英式英语 - 我建议使用美式英语，就像其他人所说的那样主导市场。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-01T20:04:55.113

对我来说，用英国英语工作是很自然的事情，甚至不用考虑它。但是，如果您正在开发内部程序，这并不重要。如果您正在创建将公开使用的 API，并且您的受众是国际化的，那么为什么不同时实现这两者呢？

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-26T20:26:08.243

肯定是美国英语。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-26T20:31:02.540

首先，我在美国。在我目前的项目中，它总是“颜色”，但是，我们似乎无法选择拼写的词是“灰色”与“灰色”。

它实际上变得非常烦人。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-02-25T14:57:59.557

我的所有编程都使用 en-GB。我想这是由于英国小说的严重影响。

但是，是否不可能有两组不同的 API（一组用于 en-US，一组用于 en-GB）在内部调用相同的函数？不过，这可能会使头文件膨胀，所以可能取决于预处理器定义、条件编译？如果您使用的是 C++，则可以执行以下操作...

```
#ifdef ENGB
     typedef struct Colour
     {
      //blahblahblah
     };
     void SetColour(Colour c);
#else
    typedef struct Color
    {
      //blahblahblah
    };
    void SetColor(Color c);
#endif 
```

取决于客户端程序员是否定义 ENGB，如下所示

```
#define ENGB 
```

他可以在他喜欢的文化中使用 API。也许为了这样一个微不足道的目的而矫枉过正，但是，嘿，如果它看起来很重要，为什么不呢！:)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-06-26T14:33:50.577

标识符名称的语言选择与受众无关，而与开发框架或 API 的原始语言有关。

我不会很多语言，但我想不出一种使用美国英语以外的任何语言。

恕我直言，由于拼写不同而引入细微错误的危险太大了。

函数覆盖很容易变成伪重载。

由于拼写不同，配置文件可能会变得无效。

可能会出现使用多个类定义相同概念对象的情况，同时使用 en-US 和 en-GB。

因此，无论一段代码是纯粹供内部使用还是供外部使用，所使用的拼写必须始终与平台/框架/编译器/API 的原始语言相匹配。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-01T14:55:36.993

如果您的所有程序员都是英国人，请使用 en-gb。如果您的代码将被英国以外的程序员看到，那么 en-us 将是一个更好的选择。

一个小问题，我们依靠翻译服务将我们的文档复制成其他语言。我们发现使用 en-us 作为源时，我们得到了更好的翻译。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-01T19:35:09.723

你需要考虑你的听众。谁将使用该代码，他们希望看到什么？

我在一家在加拿大和美国均设有办事处的公司工作。在加拿大制作文档和代码时，我们使用加拿大拼写（非常类似于英式英语），而在美国使用美国拼写。

有些事情跨越国界，但拼写的差异很少成为问题。当美国人不知道加拿大英语和英国英语的不同拼写时，它实际上可以产生一些有趣的对话。有时他们可以接受，有时他们坚持将其更改为“正确”的拼写。这也会影响日期格式（加拿大的 dd/mm/yyyy 和美国的 mm/dd/yyyy）

当出现僵局时，我们通常使用美式拼写，因为加拿大人熟悉这两种变体。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-10-01T20:01:37.617

我听说选择美国而不是英国英语的主要原因是因为英国观众在面对美国拼写时意识到这是一个美国应用程序（或假设是这样），而面对英国拼写的美国观众认为'.. . 嘿，错了.. 是颜色而不是颜色'

但正如其他人所说，标准化。选择并坚持下去。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-10-01T20:06:14.563

我更喜欢美式英语。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2012-11-02T20:07:21.543

如果你回顾几百年，你会发现这种变化与美国毫无关系，就像许多人认为的那样。这些变化源于欧洲的影响，尤其是法国的影响。在此之前，英文单词“color”实际上拼写为“color”。

试图标准化将是徒劳的，因为一半的中国孩子正在学习前欧洲的影响和美国对英语的理解，而另一半正在接受今天的英语语言。

如果您认为语言是一个问题，那么您应该考虑重达 600 克的台湾公斤。我还没有弄清楚他们是如何管理那个的，但我希望他们永远不会被聘为飞机加油人员！

# ms-access - MS Access 中查询的字段默认值

> ID：157812
> 
> 赞同：2
> 
> 时间：2008-10-01T14:16:18.210
> 
> 标签：ms-access, events

我在 MS Access 中的表上有一个字段 tblMyTable.SomeID，我想在 tblUserPref.DefaultSomeID 中将默认值设置为用户首选项。看来我不能设置默认值以在 tblMyTable 的表定义中使用查询。我有一个表格，其中记录输入到 tblMyTable。我尝试在表单上设置字段的默认值，但似乎也不接受查询。所以，作为最后的手段，我试图用 VBA 来做。我可以在 VBA 中查询我想要的值，但我不知道要将代码附加到哪个事件。

每当在表单中打开新的空白记录时，我想在用户开始输入之前运行代码。我不想在打开或编辑现有记录时运行代码。但是，如果代码同时针对新的空白记录和现有记录运行，我可能可以围绕它编写代码。到目前为止，我在现场和表单本身上尝试过的所有事件都没有按照我的意愿运行。谁能建议我应该使用哪个事件，以及在哪个对象上？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T19:33:08.333

我不确定我是否理解了这个问题，但我认为您要求根据一些运行时信息（例如用户名）在从不同表中提取的字段中插入一个值。在这种情况下，您可以使用域查找函数 DLookup()，然后将要返回的字段的名称、要从中查找的表或查询的名称以及用于将结果限制为一行（我假设这取决于您可以在运行时收集的值）。然后可以将该 DLookup() 公式永久设置为表单控件上的默认值，并且在您创建真实记录之前不会导致表单被弄脏。

当然，我可能完全误解了您要执行的操作，因此这可能行不通，但是您似乎想在记录集中查找某些内容并将结果用作新记录的值，而 DLookup() 会让您无需任何编码就可以做到这一点（以及不会过早地弄脏记录的好处）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-02T05:01:25.853

我不知道您如何确定当前用户是谁，但我会假设您可以通过编程方式调用它。为了简单起见，我将在此示例中使用 Access 内置的“CurrentUser”方法。（需要用户级别的安全性，否则默认为“管理员”。）

在 VBA 模块中创建一个公共函数以返回当前用户的默认值：

```
Public Function InsertDefaultSomeID() As String

InsertDefaultSomeID = DLookup("DefaultSomeID", "tblUserPref", _
                              "UserID='" & CurrentUser & "'")

End Function 
```

在 tblUserPref 中，您需要一个 [UserID] 字段和一个 [DefaultSomeID] 字段。为当前用户定义默认值。

然后，在绑定到 tblMyTable 的表单上，打开 [SomeID] 字段的属性并将默认值属性设置为：

```
=InsertDefaultSomeID() 
```

保存您的表单，以具有已知默认值的用户身份登录，然后尝试插入新记录。您的默认值应自动填充。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T14:22:16.043

您可能希望将该代码放在表单本身的“插入前”事件中（表单上没有任何对象）。

更正：在您的用户开始输入数据之前，这实际上不会触发 - 因此您只需要确保您想要默认设置的字段位于第一个数据输入字段之后。

您还可以在“On Current”事件中检查新记录。

```
Private Sub Form_Current()
    If Me.NewRecord Then
        Me.f2 = "humbug"
    End If
End Sub 
```

这样做的缺点是新记录在您输入时会立即创建/标记为脏。因此，如果您漫不经心地遍历记录，您最终可能会运行结束并创建几个仅包含默认数据的额外记录 - 因此您将不得不做一些事情来捕获这种情况（例如，必填字段， ETC。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T17:30:17.760

你是对的。您不能将控件的默认值属性设置为编译时未知的值。该值将在运行时确定。所以解决方法是在窗体的当前事件期间设置控件的 value 属性，而不是 defaultvalue 属性。请注意，getUserID() 是一个公共函数，用于确定用户是谁。

```
Private Sub Form_Current()

    On Error GoTo Proc_Err

    Dim rs As DAO.Recordset
    Dim fOpenedRS As Boolean

    If Me.NewRecord = True Then
        Set rs = CurrentDb.OpenRecordset("SELECT DefaultSomeID " _
        & "FROM tblUserPref WHERE UserID = " & getUserID())
        fOpenedRS = True
        rs.MoveFirst
        Me!txtPref.Value = rs!DefaultSomeID
    End If

Proc_Exit:
    If fOpenedRS = True Then
        rs.Close
    End If

    Set rs = Nothing

    Exit Sub

Proc_Err:
    MsgBox Err.Number & vbCrLf & Err.Description
    Err.Clear
    Resume Proc_Exit
End Sub 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-02T10:24:00.180

他是建议的替代方法。当用户没有指定显式值时，而不是显式地插入默认值，而是将该值保留为缺失（我可能会在专用表中对此进行建模，并通过不插入一行来对缺失值进行建模，但我知道许多人并不反对在他们的表中有许多可以为空的列）。然后您可以替换*查询*中的缺失值。这在您的应用程序中可能有效也可能无效，正如我所说的另一种处理丢失数据的方法:)

# cocoa - 寻找 MacOS 线程网络示例代码

> ID：157827
> 
> 赞同：-1
> 
> 时间：2008-10-01T14:19:11.433
> 
> 标签：cocoa, multithreading, macos, networking, sample

我的代码需要在单独的 NSThread 中运行所有网络例程。我有一个库，我通过一个回调例程进行通信：

```
my thread code
    library
        my callback (networking)
    library
my thread code 
```

我的回调例程必须将一些数据发布到 HTTP 服务器（NSURLConnection），等待答案（启动 NSRunLoop？），然后返回到库。
然后库处理数据。在库返回到我的线程后，我可以向处理绘图和用户输入的主线程发布通知。

是否有任何示例代码涵盖如何在 NSThread 中使用 NSURLConnection？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T01:26:18.590

Kelvin's link is dead, here's a bit of code that does what you are asking for (meant to be run in a method called by [NSThread detachNewThreadSelector:toTarget:WithObject:]). Note that the connection basically starts working as soo as you enter the run loop, and that "terminateRunLoop" is meant to be a BOOL set to NO on start and set to YES when the connection finishes loading or has an error.

Why would you want to do this instead of a blocking synchronous request? One reason is that you may want to be able to cancel a long-running connection properly, even if you do not have a lot of them. Also I have seen the UI get hung up a bit if you start having a number of async requests going on in the main run loop.

```
NSURLConnection *connection = [[NSURLConnection connectionWithRequest:request delegate:self] retain];
NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];
while(!terminateRunLoop) 
{
    if ( ![[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode 
                                   beforeDate:[NSDate distantFuture]]) 
        {  break; }

        [pool drain];
    }
    [pool release];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T09:20:37.197

如果你需要阻塞直到你完成工作并且你已经在一个单独的线程上，你可以使用`+[NSURLConnection sendSynchronousRequest:returningResponse:error:]`. 不过这有点生硬，所以如果您需要更多控制权，您必须切换到`NSURLRequest`在当前`NSRunLoop`. 在这种情况下，一种方法可能是在完成时让您的委托标记，并允许运行循环处理事件，直到设置标记或超过超时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T23:01:09.260

NSURLConnection 可以通过其异步委托方法在后台线程（例如 NSThread 或 NSOperation）中同步使用。但是，它确实需要了解 NSRunLoop 的工作原理。

这里有一篇带有示例代码和解释的博客文章： [http ://stackq.com/blog/?p=56](http://stackq.com/blog/?p=56)

示例代码下载了一个图像，但我使用这个概念对 REST API 进行复杂的 POST 调用。

-开尔文

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T00:02:51.413

您使用线程的任何特殊原因？除非您打开*很多*连接，否则主线程上的 NSRunLoop 应该足够好。如果您需要做阻塞工作作为响应，那么请创建您的线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T00:48:10.250

要回答您的小问题“启动 NSRunLoop？”：

我不确定我是否理解，但听起来你是在说你上面的伪代码都是在辅助线程上执行的（即，不是主事件处理线程）。如果是这种情况，创建 NSRunLoop 可能没有任何意义，因为在等待 HTTP 服务器响应时，您无法做任何有用的工作。只是让线程阻塞。

# sql - SQL 语句中的不熟悉字符

> ID：157832
> 
> 赞同：3
> 
> 时间：2008-10-01T14:19:45.690
> 
> 标签：sql, sql-server, tsql, derived-table

我认为这是一个 SQL 新手问题，但这里有。

我有一个基于示例用户定义函数的 SQL 查询 (SQL Server 2005)：

```
SELECT 
    CASEID,
    GetNoteText(CASEID)
FROM 
( 
    SELECT 
        CASEID 
    FROM 
        ATTACHMENTS 
    GROUP BY 
        CASEID 
) i
GO 
```

UDF 效果很好（它连接相关表中多行的数据，如果这很重要的话）但我对 FROM 子句后面的“i”感到困惑。查询与 i 一起工作正常，但没有它就会失败。“我”的意义是什么？

编辑：正如乔尔在下面指出的，它不是关键字

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-01T14:21:14.157

在 FROM 子句中使用子查询时，需要为查询命名。由于名称对您来说并不重要，因此通常会选择简单的名称，例如“i”或“a”。但是你可以把任何你想要的名字放在那里——“i”本身没有任何意义，而且它当然不是关键字。

如果您有一个非常复杂的查询，您可能需要将您的子查询与其他查询或表连接起来。在这种情况下，名称变得更加重要，您应该选择更有意义的名称。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-01T14:32:12.620

i 命名（子查询），这是必需的，也是进一步连接所必需的。

当连接表之间存在冲突的列名时，您必须在外部查询中使用子查询名称为列添加前缀，例如：

```
SELECT 
    c.CASEID, c.CASE_NAME,
    a.COUNT AS ATTACHMENTSCOUNT, o.COUNT as OTHERCOUNT,
    dbo.GetNoteText(c.CASEID)
FROM CASES c
LEFT OUTER JOIN
( 
    SELECT 
        CASEID, COUNT(*) AS COUNT
    FROM 
        ATTACHMENTS 
    GROUP BY 
        CASEID 
) a
ON a.CASEID = c.CASEID
LEFT OUTER JOIN
(
    SELECT 
        CASEID, COUNT(*) AS COUNT
    FROM 
        OTHER
    GROUP BY 
        CASEID 
) o
ON o.CASEID = c.CASEID 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-01T14:22:27.430

“i”为您的 select 语句提供了一个有效的表名。它也可以写成（我想——我不是 MSSQLServer 人）“AS i”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T14:31:09.237

正如其他人所说，它是子查询的表名别名。

在子查询之外，您可以使用 i.CASEID 来引用子查询结果。

在这个例子中它不是太有用，但是当你有多个子查询时，它是一个非常重要的消歧工具。

虽然，我会选择一个更好的变量名。甚至“温度”也更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T14:48:58.040

i 命名您的子查询，以便如果您有一个包含大量子查询的复杂查询并且您需要访问字段，您可以以明确的方式这样做。

当您开始编写更长的查询时，最好给您的子查询提供更具描述性的名称，以防止您自己混淆，没有什么比因为您忘记了哪个 i.id 是正确的一个或正在从哪个表/查询 c.name 检索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T02:03:20.163

“派生表”是在 FROM 子句中使用子查询的技术术语。

SQL Server 联机丛书语法显示 table_alias 在这种情况下不是可选的；“table_alias”没有括在括号中，根据 Transact-SQL 语法约定，括号中的内容是可选的。关键字“AS”是可选的，因为它被括在括号中......

   *派生表 [ AS ] 表别名 [ ( 列别名 [ ,...n ] ) ]*

来自（Transact-SQL）：http:
[//msdn.microsoft.com/en-us/library/ms177634 (SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms177634(SQL.90).aspx)

Transact-SQL 语法约定： http:
[//msdn.microsoft.com/en-us/library/ms177563 (SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms177563(SQL.90).aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T10:42:02.430

要吸取的教训是考虑将继承您的代码的人。正如其他人所说，如果代码是这样编写的：

```
SELECT DT1.CASEID, GetNoteText(DT1.CASEID) 
FROM (
   SELECT CASEID 
   FROM ATTACHMENTS
   GROUP BY CASEID
) AS DT1 (CASEID); 
```

那么读者就会有更大的机会弄清楚它，甚至可能会看到暗示“派生表”的“DT1”。

# oracle - Oracle Enterprise Manager 占用了多少资源？

> ID：157845
> 
> 赞同：4
> 
> 时间：2008-10-01T14:21:47.730
> 
> 标签：oracle, performance, oracle-enterprise-manager

我正在使用基于 Oracle 数据库的医疗记录系统。我们的供应商刚刚告诉我们，当我们不使用 Oracle 的企业管理器服务时，我们需要关闭它，因为它使用了太多的系统资源。我知道我可以通过检查 Sysinternals Process Explorer 获得实际数字，但我希望有人可以根据他们的个人经验给我信息。

完成后我是否需要关闭 EM，还是他过于担心？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T14:27:52.007

我们也在测试和生产服务器上做同样的事情。我手头没有任何指标，但它确实显着改善了整体数据库响应

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-02T18:35:00.187

EM不应该那么具有侵入性。我发现使用默认安装（YMMV）每 30 秒需要大约 10% 的 cpu 不到 2 秒，当系统处于负载状态时，它甚至似乎都没有这样做。

当我在这里谈论 EM 时，我不是在谈论 oracle.exe 进程上的负载，而是来自 nmesrvc 以及它产生的 perl、cmd 和 emagent 进程。要查看它对数据库本身的影响，需要一点 Oracle 专家。

我发现进程资源管理器是一个很好的工具来帮助实时查看，因为它显示了来自服务父 nmesrvc 的进程层次结构。

坦率地说，如果您在停止 dbconsole 服务时确实看到了最终用户的差异，那么您的机器已经超出容量，您可能需要成长或淘汰。

如果您使用不同的工具来管理和监视 oracle 和其他应用程序进程，则不需要 dbconsole 进程一直运行。

要获得该领域的一些顶尖人士回答的有关 Oracle 的非常具体的问题，请查看 Oracle-L 邮件列表。响应时间惊人，而且答案的质量通常比您在其他地方找到的要好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T10:01:47.827

我发现仅运行 Oracle EM 可能会占用大量资源，具体取决于您要求它执行的操作。我发现我很少使用开箱即用的配置，通过删除我不需要的服务，我可以大大减少 EM 所需的资源量。

通常，我在单独的应用程序服务器上运行 EM，而不是在我的数据库服务器上。EM 的真正力量和价值在于运行/维护/监控多个数据库并在自己的服务器上安装 EM，这意味着我不必担心它会影响任何数据库。

EM 所做的一切，您都可以手动完成，如果只是管理一个数据库，我通常会走这条路。但是，这条路线确实需要一定程度的 DBA 知识。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T14:34:33.643

我立即想到的唯一一件事是企业管理器（适用于 Oracle 9 和 pre）是基于 Java 的。

我想这会给它带来一些失控的资源使用的可能性，但我从来没有在我在这里使用过的任何机器上看到任何证据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T14:36:12.157

Oracle 的 EM 允许您配置大部分开销。此开销包括轮询许多服务以在达到阈值时报告警报或提供性能图表。话虽如此，如果您配置了这些功能，那么为什么要运行它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T19:43:32.197

太牛了，我喜欢在 Linux 上运行 Oracle，并在初始安装后关闭 GUI（Oracle 的安装程序需要它）。

# java - 获取 requestDispatcher

> ID：157846
> 
> 赞同：0
> 
> 时间：2008-10-01T14:21:50.460
> 
> 标签：java, servlets

使用 servletContext 而不是请求以获得 requestDispatcher 有什么好处？

```
servletContext.getRequestDispatcher(dispatchPath) 
```

并使用

```
argRequest.getRequestDispatcher(dispatchPath) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-01T15:35:48.143

它在黑色和白色的 javadocs 中

[http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletRequest.html#getRequestDispatcher(java.lang.String)](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletRequest.html#getRequestDispatcher(java.lang.String))

> 该方法与 ServletContext.getRequestDispatcher(java.lang.String) 的区别在于该方法可以采用相对路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-09T18:12:37.650

调用`getRequestDispatcher`from`ServletContext`时，需要提供绝对路径，但对于`ServletRequest`对象，则需要提供相对路径。

# .net - CSS 布局、Vis Studio 2005 和 AJAX 选项卡容器

> ID：157850
> 
> 赞同：2
> 
> 时间：2008-10-01T14:22:17.417
> 
> 标签：.net, asp.net, css

在一个 C# Web 应用程序 VS 2005 中（我避免使用 2008 年，因为我发现 IDE 很难处理），我陷入了布局问题。

我正在从绝对定位转向 CSS 相对定位。

我想将屏幕分为四个块：顶部（页眉带）、左中（堆叠菜单）、右中（内容 - 这里是 AJAX 选项卡容器）和底部（页脚带），所有 4 个块都定位相对，但中间右侧（内容）块中的控件绝对相对于块的左上角定位。一个很好的附带好处是让 IDE 设计窗口显示所有控件，因为它们实际上会显示，但我怀疑这是可能的。IDE 将选项卡面板内的所有控件相对于设计窗口的左上角定位；一团糟。

目前，我的偏见是 CSS 适合相对定位块、艺术品、文本等，但不适用于需要排列大量标签、文本框、ddl、复选框等的输入表单。

无论如何，我的 CSS 还不能胜任这项任务 - 有没有人知道一篇很好的文章、书籍、博客等讨论了在 ASP.NET 中实现的 CSS，并且可能包括一个带有 AJAX 选项卡控件的示例? 任何帮助，将不胜感激。

非常感谢

迈克·托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T19:32:41.350

据我所知，没有什么特定于 ASP.NET，而且你是对的（至少在 2008 年）关于它不使用引用的样式表是正确的。

但是，这些可能对您有用：

[http://www.positioniseverything.net/](http://www.positioniseverything.net/) - 位置就是一切，一个优秀的 CSS 资源。

[http://www.alistapart.com/topics/code/css/](http://www.alistapart.com/topics/code/css/) - List Apart 的 CSS 部分，关于特定技术的建议。

本质上，你想要的是 4 个主要的 div：页眉、页脚、菜单、内容。根据需要定位每个 div，然后调整其子项的位置，大多数浏览器会将其视为“相对于我的父项的位置”（除非它是绝对的，IIRC）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T19:39:56.687

我很欣赏这可能不是您想要的全面答案，但它可能会有所帮助......

要使右侧块的内容相对于其左上角绝对定位，您只需为容器元素指定`position: relative;`样式。这将把那个元素变成一个包含块，导致所有绝对定位的子元素都被定位在它的边界上。这是一篇关于该主题的有用文章：[CSS 定位](http://www.brainjar.com/CSS/positioning/)。ASP.NET 控件的问题之一，尤其是您正在使用的 AJAX 控件工具包，是让它吐出有效的标记。最好使用能让您 100% 控制标记的控件，有时这意味着创建复杂`UserControl`的 s 或在文件中添加少量讨厌的脚本`aspx`。

关于让 IDE 正确呈现，甚至不用费心。我已经有近两年没有在 VS 中使用设计视图了，这是有充分理由的：它很烂，而且是基于 IE 的。任何 IDE 都不会像现场测试那样为您提供完整的渲染体验，所以我个人不会打扰。我知道较新的 MS 工具对此有更好的支持，尽管它仍然不像真正的浏览器那样完美和可靠（显然你想在这里使用 Firefox！）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T19:45:58.870

正如 Jeff 所说，关于 CSS 的实现方式，ASP.NET 并没有什么特别之处。至于使用 CSS 为表单设置样式，请阅读以下内容以提供一些想法：

*   [http://www.sitepoint.com/article/fancy-form-design-css/](http://www.sitepoint.com/article/fancy-form-design-css/)
*   [http://www.smashingmagazine.com/2006/11/11/css-based-forms-modern-solutions/](http://www.smashingmagazine.com/2006/11/11/css-based-forms-modern-solutions/)
*   [http://www.quirksmode.org/css/forms.html](http://www.quirksmode.org/css/forms.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T13:21:56.930

非常感谢所有答案 - 这里有很多要阅读的内容，但到目前为止我所经历的已经让我克服了当前的困境。我发现不使用 VS 2005 IDE 来排列有利于 Style Master 的块要容易得多，但在购买之前我仍在寻找其他 3rd 方工具。

非常感谢，迈克·托马斯

# java - 是否需要删除 Java 侦听器？（一般来说）

> ID：157856
> 
> 赞同：30
> 
> 时间：2008-10-01T14:22:59.490
> 
> 标签：java

想象一下这个示例 java 类：

```
class A {
    void addListener(Listener obj);
    void removeListener(Listener obj);
}

class B {
    private A a;
    B() {
        a = new A();
        a.addListener(new Listener() {
            void listen() {}
        }
 } 
```

是否需要在 B 中添加 finalize 方法来调用 a.removeListener？假设 A 实例也将与其他一些对象共享，并且将比 B 实例寿命更长。

我担心我可能会在这里创建垃圾收集器问题。最佳做法是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-01T14:31:21.980

参考图中有一个循环。A 引用 B 和 B 引用 A。垃圾收集器将检测循环并查看何时没有对 A 和 B 的外部引用，然后将两者都收集起来。

在这里尝试使用终结器是错误的。如果 B 被销毁，对 A 的引用也将被删除。

* * *

声明：“假设 A 实例也将与其他一些对象共享，并且将比 B 实例寿命更长。” 是错的。唯一会发生的方法是，如果侦听器被显式地从终结器以外的地方移除。如果对 A 的引用被传递，这将意味着对 B 的引用，并且 B 不会被垃圾收集，因为存在对 AB 循环的外部引用。

* * *

进一步更新：

如果您想打破循环并且不需要 B 显式删除侦听器，则可以使用 Wea​​kReference。像这样的东西：

```
class A {
    void addListener(Listener obj);
    void removeListener(Listener obj);
}

class B {
    private static class InnerListener implements Listener {
        private WeakReference m_owner;
        private WeakReference m_source;

        InnerListener(B owner, A source) {
            m_owner = new WeakReference(owner);
            m_source = new WeakReference(source);
        }

        void listen() {
            // Handling reentrancy on this function left as an excercise.
            B b = (B)m_owner.get();
            if (b == null) {
                if (m_source != null) {
                    A a = (A) m_source.get();
                    if (a != null) {
                        a.removeListener(this);
                        m_source = null;
                    }
                }

                return;
            }
            ...
        }
    }

    private A a;

    B() {
        a = new A();
        a.addListener(new InnerListener(this, a));
    }
} 
```

如果需要跨多个类，可以进一步概括。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-01T14:29:05.777

我对 GC 的理解是，在调用 removeListener 方法之前，A 类将保持对侦听器的引用，因此它不会成为 GC 清理的候选对象（因此不会调用 finalize）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-01T14:33:43.363

您必须来自 C++ 或人们实现析构函数的其他语言。在 Java 中你不会那样做。除非您真的知道自己在做什么，否则您不会覆盖 finalize。10 年来我从来没有这样做过，我仍然想不出一个很好的理由来要求我这样做。

回到您的问题，您的侦听器是一个具有自己生命周期的独立对象，并且将在所有其他引用它的对象将被收集或没有其他对象指向它时收集。这很好用。所以不，你不必重写 finalize。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-01T14:33:18.047

如果您已将 B 添加为 A 的侦听器，并且 A 的寿命比 B 长，则对 B 的 finalize 调用将永远不会被调用，因为 A 内部有一个 B 的实例，因此它永远不会被垃圾收集。您可以通过将 A 中的 B 引用存储为 WeakReference（在车库收集期间不被视为引用）来解决此问题，但是当您不再需要 B 时，最好从 A 中显式取消注册 B。

一般来说，Java 中建议不要在 Java 中使用 finalize 方法，因为您永远无法确定何时调用它，并且您不能使用它从另一个类中注销您自己。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-01T14:27:52.443

A 确实会通过匿名实例使 B 保持活力。

但是我不会覆盖 finalize 来解决这个问题，而是使用一个不会让 B 保持活动状态的静态内部类。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-01T14:42:03.233

在您的情况下，唯一的垃圾收集“问题”是实例`B`不会被垃圾收集，而`A`. 这就是垃圾收集在 Java/.NET 中的工作方式。现在，如果您不喜欢 的实例`B`没有更早地被垃圾收集这一事实，您需要问自己，您希望他们在什么时候停止监听来自 的事件`A`？一旦你得到答案，你就会知道如何修复设计。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-01T14:34:22.833

A 通过创建的匿名类型隐式使用的匿名实例持有对 B 的引用。这意味着在调用 removeListener 之前不会释放 B，因此不会调用 B 的 finalize。

当 A 被销毁时，它对 B 的匿名引用也将 B 被销毁，从而为 B 被释放开辟了道路。

但由于 B 持有对 A 的引用，这永远不会发生。这似乎是一个设计问题——如果 A 有一个调用监听器，为什么你需要 B 也持有对 A 的引用？如有必要，为什么不将发出呼叫的 A 传递给侦听器？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-01T14:40:56.980

A怎么能比B活得久？：

**B 和 A 的示例用法：**

```
public static main(args) {
    B myB = new B();
    myB = null;
} 
```

**我期望的行为：**

GC 将删除 myB 并且在 myB 实例中仅引用 A 实例，因此它也将被删除。与所有指定的听众一起？

**你是不是想说：**

```
class B {
    private A a;
    B(A a) {
        this.a = a;
        a.addListener(new Listener() {
            void listen() {}
        }
} 
```

**随着用法：**

```
public static main(args) {
    A myA = new A();
    B myB = new B(myA);
    myB = null;
} 
```

因为那时我真的很想知道那个匿名班级会发生什么......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-19T22:19:46.170

我刚刚发现了一个巨大的内存泄漏，所以我将调用创建泄漏的代码是*错误*的，而我的修复没有泄漏是*正确的*。

这是旧代码：（这是我见过的常见模式）

```
class Singleton {
    static Singleton getInstance() {...}
    void addListener(Listener listener) {...}
    void removeListener(Listener listener) {...}
}

class Leaky {
    Leaky() {
        // If the singleton changes the widget we need to know so register a listener
        Singleton singleton = Singleton.getInstance();
        singleton.addListener(new Listener() {
            void handleEvent() {
                doSomething();
            }
        });
    }
    void doSomething() {...}
}

// Elsewhere
while (1) {
    Leaky leaky = new Leaky();
    // ... do stuff
    // leaky falls out of scope
} 
```

显然，这很糟糕。许多 Leaky 正在被创建并且永远不会被垃圾收集，因为侦听器让它们保持活力。

这是我的替代方案，它修复了我的内存泄漏。这是有效的，因为我只关心对象存在时的事件侦听器。侦听器不应使对象保持活动状态。

```
class Singleton {
    static Singleton getInstance() {...}
    void addListener(Listener listener) {...}
    void removeListener(Listener listener) {...}
}

class NotLeaky {
    private NotLeakyListener listener;
    NotLeaky() {
        // If the singleton changes the widget we need to know so register a listener
        Singleton singleton = Singleton.getInstance();
        listener = new NotLeakyListener(this, singleton);
        singleton.addListener(listener);
    }
    void doSomething() {...}
    protected void finalize() {
        try {
            if (listener != null)
                listener.dispose();
        } finally {
            super.finalize();
        }
    }

    private static class NotLeakyListener implements Listener {
        private WeakReference<NotLeaky> ownerRef;
        private Singleton eventer;
        NotLeakyListener(NotLeaky owner, Singleton e) {
            ownerRef = new WeakReference<NotLeaky>(owner);
            eventer = e;
        }

        void dispose() {
            if (eventer != null) {
                eventer.removeListener(this);
                eventer = null;
            }
        }

        void handleEvent() {
            NotLeaky owner = ownerRef.get();
            if (owner == null) {
                dispose();
            } else {
                owner.doSomething();
            }
        }
    }
}

// Elsewhere
while (1) {
    NotLeaky notleaky = new NotLeaky();
    // ... do stuff
    // notleaky falls out of scope
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-01T14:27:36.687

当 B 被垃圾收集时，它应该允许 A 也被垃圾收集，因此也允许 A 中的任何引用。您不需要显式删除 A 中的引用。

但是，我不知道有关您的建议是否会使垃圾收集器更有效地运行以及何时值得费心的任何数据，但我有兴趣看到它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-01T14:35:46.230

A 确实会阻止 B 在您使用标准引用来存储您的听众时被垃圾收集。或者，当您维护侦听器列表而不是定义 new ArrayList<ListenerType>(); 你可以做类似 new ArrayList<WeakReference<ListenerType>>();

通过将对象包装在弱引用中，可以防止它延长对象的寿命。

当然，这只有在您编写包含侦听器的类时才有效

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-01T14:50:45.383

基于@Alexander 所说的将自己移除为听众的内容：

除非有一些令人信服的理由不这样做，否则我从同事那里学到的一件事是，与其创建一个匿名的内部侦听器并需要将其存储在一个变量中，不如让 B 实现侦听器，然后 B 可以删除自己当它需要时`a.removeListener(this)`

# version-control - 生命周期工具套件

> ID：157862
> 
> 赞同：5
> 
> 时间：2008-10-01T14:23:59.470
> 
> 标签：version-control, project-management, lifecycle, issue-tracking

我正在寻找替换我的开发团队目前使用的生命周期工具。我正在寻找的工具：

*   版本控制
*   缺陷/问题跟踪
*   需求跟踪
*   测试用例管理
*   （潜在）项目管理：项目状态、工时输入

我有一个新的强大服务器（Windows 2008 Server）来运行所有工具。我正在研究 COTS 和开源选项，但到目前为止还没有决定。

其他因素：

*   分布式团队（不同物理站点）
*   一些 Windows 开发，一些 Linux 开发
*   软件、固件、技术写作需要能够使用

关于可以协同工作的好套件的建议？
如果开源，在 Windows 2008 Server 上运行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-01T14:30:59.843

Svn/Trac 加上一些插件可能会让你大部分时间都免费。

如果您使用由 visualsvn 提供的版本（它们捆绑了 trac 和 subversion），它也是一个非常简单的设置。

[http://www.visualsvn.com/server/](http://www.visualsvn.com/server/) [http://trac.edgewall.org/](http://trac.edgewall.org/) [http://trac-hacks.org/](http://trac-hacks.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T19:43:30.053

看看 Atlassian 提供的工具- [http://www.atlassian.com/](http://www.atlassian.com/)我们使用了他们的一些产品 (Jira/Confluence)，它们很好地链接在一起。也不是很贵。

作为管理员/维基园丁，他们易于使用和管理，这有时可能是一个重要的被忽视的要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-18T11:23:36.260

版本控制系统最常见的选择是[Subversion](http://subversion.tigris.org/)。它有很好的工具支持，大多数工具都可以与 Subversion 一起使用。

您有一个分布式团队，因此您可以考虑使用分布式版本控制系统。例如[Mercurial](http://mercurial.selenic.com/)或[Git](http://git-scm.com/)。Mercurial 在 Windows 上有更好的支持。[与像Subversion](http://subversion.tigris.org/)这样的“传统”版本控制系统相比，工具支持有点缺乏。

以上都是开源的。

对于项目管理/问题跟踪/需求跟踪，有开源[Trac](http://trac.edgewall.org/)，它结合了问题跟踪器、项目管理软件和 wiki。Trac 与 Subversion、Git 和 Mercurial 一起工作。

Atlassian 提供用于问题跟踪/项目管理的商业[JIRA](http://www.atlassian.com/software/jira/)和用于 wiki 的[Confluence 。](http://www.atlassian.com/software/confluence/)Jira 至少与 Subversion 一起工作。

Fog Creek 拥有基于 Mercurial 的[Kiln](http://www.fogcreek.com/Kiln/)用于版本控制和[FogBugz](http://www.fogcreek.com/fogbugz/)用于问题跟踪/项目管理。既商用。两者都可以作为托管版本和在您自己的服务器上运行的版本。

我使用了 Trac，它可以工作，但您可以期待一些修补和配置，然后才能像您希望的那样工作。

# ruby-on-rails - Rails 测试挂起 - 如何在执行前打印测试名称？

> ID：157873
> 
> 赞同：29
> 
> 时间：2008-10-01T14:26:06.533
> 
> 标签：ruby-on-rails, ruby, testing

我在我们的 Rails 应用程序中有一个测试挂起，无法确定是哪一个（因为它挂起并且没有得到故障报告）。我发现这篇博客文章[http://bmorearty.wordpress.com/2008/06/18/find-tests-more-easily-in-your-testlog/](http://bmorearty.wordpress.com/2008/06/18/find-tests-more-easily-in-your-testlog/)添加了一个设置挂钩来打印测试名称但是当我尝试做同样的事情它给了我一个错误，说设置的参数数量错误（1 代表 0）。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2010-04-20T07:56:09.907

如果您使用 rake 运行测试，它将起作用：

```
rake test:units TESTOPTS="-v" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-01T15:35:20.843

测试名称的打印是 TestRunner 的责任。如果您从命令行运行测试，您可以指定 -v 选项，以打印出测试用例名称。

例子：

```
ruby test_Foo.rb -v
Loaded suite test_Foo
Started
test_blah(TestFoo): .
test_blee(TestFoo): .

Finished in 0.007 seconds.

2 tests, 15 assertions, 0 failures, 0 errors 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-01T16:43:07.670

这是我在 test_helper.rb 中使用的

```
class Test::Unit::TestCase
  # ...

  def setup_with_naming 
    unless @@named[self.class.name]
      puts "\n#{self.class.name} "
      @@named[self.class.name] = true
    end
    setup_without_naming
  end
  alias_method_chain :setup, :naming unless defined? @@aliased
  @@aliased = true  
end 
```

当您同时在多个文件上运行它时，@@aliased 变量可以防止它被重新别名；@@named 使名称不会在每次测试之前显示（就在第一次运行之前）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-01T14:55:00.723

博客文章中的定义是特定的（setup(&block) 方法在 context.rb 中的模块 Thoughtbot::Shoulda 中定义。应该让 TestCase 扩展该模块）。

纯 test::unit 的定义是

```
# File test/unit/testcase.rb, line 100
      def setup
      end 
```

你能做的是

```
def setup
  log_test
end  

private   

def log_test   
  if Rails::logger  
    # When I run tests in rake or autotest I see the same log message multiple times per test for some reason.   
    # This guard prevents that.   
  unless @already_logged_this_test  
    Rails::logger.info "\n\nStarting #{@method_name}\n#{'-' * (9 + @method_name.length)}\n"  
  end  
  @already_logged_this_test = true  
end 
```

* * *

编辑

如果你真的不想编辑你的文件，你可以冒险重新打开测试用例并扩展运行：

```
class Test::Unit::TestCase   
  alias :old_run :run
  def run 
    log_test
    old_run
  end
end 
```

这应该可以（虽然我没有红宝石来测试）

* * *

我放弃 ！（沮丧地）

我检查了代码，rails 实际上在幕后发挥了作用，这可能就是重新定义运行不起作用的原因。

事情是：魔术的一部分包括 ActiveSupport::CallBack 并为设置和拆卸创建回调。

意思是

```
class Test::Unit::TestCase
  setup :log_test  

  private   

  def log_test   
    if Rails::logger  
      # When I run tests in rake or autotest I see the same log message multiple times per test for some reason.   
      # This guard prevents that.   
      unless @already_logged_this_test  
        Rails::logger.info "\n\nStarting #{@method_name}\n#{'-' * (9 + @method_name.length)}\n"  
      end  
      @already_logged_this_test = true  
    end  
  end  
end 
```

绝对应该工作

并且实际上用它运行测试确实有效。我感到困惑的是，这是我尝试的第一件事，它失败了，你得到了同样的错误

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-30T16:50:01.260

如果其他人有同样的问题，但使用集成测试和无头 Web 服务器，以下 ruby​​ 代码将在运行之前打印出测试文件名

```
Dir["test/integration/**/*.rb"].each do |filename|
  if filename.include?("_test.rb")
    p filename
    system "xvfb-run rake test TEST=#{filename}"
  end
end 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-01T14:49:19.380

你用的是什么测试框架？测试/单元？

我会看一下 RSpec，它会为你的测试提供更多的上下文。您还可以获得一个漂亮的 HTML 报告，如下所示：

[RSpec 结果 http://myskitch.com/robbyrussell/rspec_results-20070801-233809.jpg](http://myskitch.com/robbyrussell/rspec_results-20070801-233809.jpg)

如果您有任何失败的测试，特定测试将显示为红色，并且它将扩展到测试失败的特定行，从而为您提供更多关于测试失败的原因以及您应该在哪里解决问题的可见性。

# code-generation - 关于编译器中代码生成的参考（中间表示、SSA、指令选择、寄存器分配等）？

> ID：157894
> 
> 赞同：0
> 
> 时间：2008-10-01T14:29:09.787
> 
> 标签：code-generation, compiler-construction, register-allocation

我有*ML 中的龙书和现代编译器实现*。我正在寻找有关编译器中代码生成的其他好的资源。你能推荐任何吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T14:46:04.147

我最喜欢的是 Robert Morgan 的“Building an Optimizing Compiler”。非常实用，涵盖了静态单一分配。

# ajax - ZK ajax 框架

> ID：157896
> 
> 赞同：2
> 
> 时间：2008-10-01T14:30:23.090
> 
> 标签：ajax, struts, zk

ZK 能否轻松集成到 struts Web 应用程序中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T13:25:23.533

也许你会发现它很有趣：

[http://www.zkoss.org/smalltalks/zk-sample/zk-sample.html](http://www.zkoss.org/smalltalks/zk-sample/zk-sample.html)

此外，你可以浏览一下你可以在[http://www.zkoss.org/](http://www.zkoss.org/)上找到的 zk 论坛，很容易找到一些关于它的讨论。希望它可以帮助

卢卡

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-19T22:39:29.587

从根本上说，struts 是一个整页的-post-find-action-update-full-page 框架。它是在上个世纪编写的，代表了上个世纪最成功的框架之一。你可以让 struts 与 zk 一起工作。然而，这需要将你使用 zk 的方式降级为上个世纪的东西。Zk 不是一个完整的页面后框架。要获得 zk 提供的所有生产力，您必须使用事件驱动的桌面编程模式进行编程。如果不看代码，很难解释这有多么不同。然而，它的生产力要高得多。这不是一蹴而就的——你必须忘记上个世纪通常是如何做事的，才能找到本世纪做事的更好方法。

要查看差异，请考虑探索此示例应用程序[http://java.dzone.com/articles/using-desktop-model-view](http://java.dzone.com/articles/using-desktop-model-view)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-09T13:48:20.610

更具体地说： [http ://docs.zkoss.org/wiki/ZK/How-Tos/Integrate-Other-Frameworks#Struts_.2B_Tiles_.2B_JSP_.28.2B_Spring.29](http://docs.zkoss.org/wiki/ZK/How-Tos/Integrate-Other-Frameworks#Struts_.2B_Tiles_.2B_JSP_.28.2B_Spring.29)

# asp.net - URL查询字符串操作的类？

> ID：157898
> 
> 赞同：1
> 
> 时间：2008-10-01T14:30:33.527
> 
> 标签：asp.net

我正在寻找一个经过良好测试的类，用于在 .NET 中操作 URL。具体来说，我希望能够添加/更新给定 url 的查询字符串值。

我在网上找到了各种可以做到这一点的类，但似乎没有一个是真正健壮且经过良好测试的。我在 .NET 框架中也找不到任何东西；Uri 类不允许我操作查询字符串中的参数。框架中有执行此操作的代码，但都标记为内部代码。

是否有一个很好的健壮类来处理 Urls 和 QueryStrings？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T14:43:08.583

一个简单的字符串字典不应该满足于此吗？一个普通的 ASP.NET 查询字符串只是由用 & 号分隔的键值对组成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T15:11:45.520

很久以前，我们使用[SecureQueryString 2.0](http://dotnetjunkies.com/Article/3ABCD244-CC7C-4CED-B64E-BCF05191CDAB.dcik)。因为它继承自 NameValuePair（如果我没记错的话），它提供了轻松添加、删除键值的能力。如果需要，它还提供对查询加密的支持。它还提供将 URL 转换为 NameValuePair 的能力，反之亦然。

# jsp - 如何将 <%= request.getContextPath() %> 添加到 jsp 页面内的所有相对 URL？

> ID：157905
> 
> 赞同：2
> 
> 时间：2008-10-01T14:31:36.817
> 
> 标签：jsp, url, tomcat

这个主题几乎说明了一切。如何自动修复 jsp 页面，以便将相对 URL 映射到上下文路径而不是服务器根目录？也就是说，例如

```
<link rel="stylesheet" type="text/css" href="/css/style.css" /> 
```

如何以将 css 映射到`my-server/my-context/css/style.css`而不是的方式进行设置`my-server/css/style.css`？除了将上述所有行更改为

```
<link rel="stylesheet" type="text/css" 
      href="<%= request.getContextPath() %>/css/style.css" /> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-01T14:32:50.980

查看[`<BASE HREF="">`](http://www.w3schools.com/TAGS/att_base_href.asp)标签。这是一个 HTML 标记，这意味着页面上的所有链接都应以您的基本 URL 开头。

例如，如果您指定`<BASE HREF="http://www.example.com/prefix">`然后拥有，`<a href="/link/1.html">`那么该链接实际上应该将您带到 /prefix/link/1.html。这也应该适用于`<LINK>`（样式表）标签。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2011-05-19T09:23:50.990

更好的方法是 HttpServletResponse.encodeURL() 它将构造适当的 url

# c# - 在 .net 异常中如何获取带有参数值的堆栈跟踪

> ID：157911
> 
> 赞同：40
> 
> 时间：2008-10-01T14:33:07.000
> 
> 标签：c#, .net, exception

我正在尝试在 .net (c#) 中添加一个未处理的异常处理程序，该处理程序应该对“用户”尽可能有帮助。最终用户大多是程序员，所以他们只需要提示他们操作错误的对象。

当应用程序崩溃时，我正在开发一个类似于 Windows XP 错误报告的窗口，但它会提供尽可能多的关于抛出异常的即时信息。

虽然堆栈跟踪使我（因为我有源代码）能够查明问题的根源，但用户没有它，因此他们在没有进一步信息的情况下迷失了方向。不用说，我必须花费大量时间来支持该工具。

有一些系统异常，例如 Dictionary 集合抛出的 KeyNotFoundException ，这真的让我很烦恼，因为它们没有在消息中包含未找到的键。我可以用大量的 try catch 块填充我的代码，但它相当激进并且需要维护更多的代码，更不用说最终必须本地化的大量字符串。

最后一个问题：有没有办法（在运行时）获取调用堆栈跟踪中每个函数的参数值？仅此一项就可以解决 90% 的支持电话。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-01T14:41:56.853

我不认为 System.Diagnostics.StackFrame 提供参数信息（除了方法签名）。

您可以通过 AOP 使用跟踪记录来检测麻烦的调用，甚至可以使用它的异常拦截功能有条件地记录，而不必乱扔代码。看看[http://www.postsharp.org/](http://www.postsharp.org/)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-01T16:04:52.397

同样，我没有找到任何东西可以在运行时自动派生参数。相反，我使用了 Visual Studio 加载项来生成显式打包参数的代码，如下所示：

```
public class ExceptionHandler
{
    public static bool HandleException(Exception ex, IList<Param> parameters)
    {
        /*
         * Log the exception
         * 
         * Return true to rethrow the original exception,
         * else false
         */
    }
}

public class Param
{
    public string Name { get; set; }
    public object Value { get; set; }
}

public class MyClass
{
    public void RenderSomeText(int lineNumber, string text, RenderingContext context)
    {
        try
        {
            /*
             * Do some work
             */
            throw new ApplicationException("Something bad happened");
        }
        catch (Exception ex)
        {
            if (ExceptionHandler.HandleException(
                    ex, 
                    new List<Param>
                    {
                        new Param { Name = "lineNumber", Value=lineNumber },
                        new Param { Name = "text", Value=text },
                        new Param { Name = "context", Value=context}
                    }))
            {
                throw;
            }
        }
    }
} 
```

编辑：或者，通过将 HandleException 的参数设置为 params 数组：

```
public static bool HandleException(Exception ex, params Param[] parameters)
{
   ...
}

...
if (ExceptionHandler.HandleException(
                    ex, 
                    new Param { Name = "lineNumber", Value=lineNumber },
                    new Param { Name = "text", Value=text },
                    new Param { Name = "context", Value=context}
                    ))
{
    throw;
}
... 
```

生成额外代码以将参数显式传递给异常处理程序有点麻烦，但使用插件至少可以自动化它。

自定义属性可用于注释您不希望加载项传递给异常处理程序的任何参数：

```
public UserToken RegisterUser( string userId, [NoLog] string password )
{
} 
```

第二次编辑：

请注意，我完全忘记了 AVICode：

[http://www.avicode.com/](http://www.avicode.com/)

他们使用呼叫拦截技术来提供正是这种信息，所以它必须是可能的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-01T14:48:35.277

不幸的是，除了实际附加到应用程序的调试工具外，您无法从调用堆栈中获取参数的实际值。但是，通过使用 System.Diagnostics 中的 StackTrace 和 StackFrame 对象，您可以遍历调用堆栈并读出所有调用的方法以及参数名称和类型。你会这样做：

```
System.Diagnostics.StackTrace callStack = new System.Diagnostics.StackTrace();
System.Diagnostics.StackFrame frame = null;
System.Reflection.MethodBase calledMethod = null;
System.Reflection.ParameterInfo [] passedParams = null;
for (int x = 0; x < callStack.FrameCount; x++)
{
    frame = callStack.GetFrame(x);
    calledMethod = frame.GetMethod();
    passedParams = calledMethod.GetParameters();
    foreach (System.Reflection.ParameterInfo param in passedParams)
        System.Console.WriteLine(param.ToString()); 
} 
```

如果您需要实际值，那么恐怕您将需要进行小型转储并对其进行分析。有关获取转储信息的信息，请参见：

[http://www.debuginfo.com/tools/clrdump.html](http://www.debuginfo.com/tools/clrdump.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-06-20T13:10:09.630

redgate 有一个软件工具，看起来很有前途。

[http://www.red-gate.com/products/dotnet-development/smartassembly/](http://www.red-gate.com/products/dotnet-development/smartassembly/)

目前，我们正在通过电子邮件收集客户的错误报告，有时我会遇到一些重要数据丢失的问题（主要是一些非常基本的变量，例如当前记录中的 id，以便我可以重现错误）。我还没有测试过这个工具，但据我了解，它可以从堆栈中收集参数值和局部变量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-01T14:53:57.370

如果您可以做您正在寻找的事情，那么您将击败 .NET 安全性的一个组成部分。

在这种情况下，最好的选择是附加到调试器或分析器（它们中的任何一个都可以访问这些值）。前者可以附加，后者需要在程序启动前激活。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T14:40:33.707

我不相信有一个内置的机制。检索堆栈跟踪的每一帧，同时允许您确定跟踪中的方法，只为您提供有关该方法的反射类型信息。无参数信息。我认为这就是为什么有些例外，特别是 ArgumentException 等。人。提供一种机制来指定异常中涉及的参数的值，因为没有简单的方法来获取它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-01T14:44:34.040

由于最终用户是开发人员，您可以为他们提供一个版本，该版本可以记录所有传递的键值/参数。并提供一个设施，以便他们可以打开/关闭日志记录。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-01T14:50:48.300

理论上可以通过利用可移植可执行文件 (PE) 文件格式来获取变量类型和偏移量来做你想做的事，但是几年前我遇到了一个 [文档] 墙试图这样做。祝你好运！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-01T14:37:25.990

我不知道这样的事情，但我自己也想要。我通常在抛出异常时自己做，但如果不是你抛出的，那么你可能会和我们其他人一起出局。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-01T14:43:13.060

我不知道获取调用堆栈跟踪中每个函数的参数值的方法，但一种解决方案是捕获特定异常（`KeyNotFoundException`在您的示例中）并将其重新抛出新异常。这允许您关联您希望的任何其他信息

例如：

```
Dim sKey as String = "some-key"
Dim sValue as String = String.Empty

Try
   sValue = Dictionary(sKey)
Catch KeyEx As KeyNotFoundException
   Throw New KeyNotFoundException("Class.Function() - Couldn't find [" & sKey & "]", KeyEx)
End Try 
```

我很欣赏你关于本地化错误字符串的声明，但如果你的听众“主要是程序员”，那么惯例已经在某种程度上规定了对英语的理解（正确或错误 - 但这是另一场辩论！）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-01T14:45:18.173

一旦你有异常，你感兴趣的两件事是 System.Diagnostics.StackTrace 和 System.Diagnostics.StackFrame

[这里](http://msdn.microsoft.com/en-us/library/ms173028.aspx)有一个 MSDN 示例

# unit-testing - 创建文件只是为了单元测试

> ID：157917
> 
> 赞同：4
> 
> 时间：2008-10-01T14:34:09.650
> 
> 标签：unit-testing

这可能是一个有趣的问题。我需要测试我是否可以成功上传和获取 PDF 文件。这适用于基于文本的文件，但我只想检查 PDF。为了运行这个单元测试，我需要一个 PDF 文件。有几个选项。我可以创建一个虚拟 PDF 文件并将其存储在某个文件夹中并读取该文件并将该文件保存到系统中。但是现在，我的单元测试依赖于 PDF 文件。因此，运行单元测试的任何人都必须拥有有点糟糕的 PDF 文件。

对我来说另一种方法是创建一个 PDF 文件。这没什么大不了的，因为我可以简单地创建一个扩展名为 .pdf 的虚拟文件，或者我什至可以使用一些 PDF 第三方工具来创建 PDF 文件。

另一种方法是将 PDF 文档嵌入为嵌入式资源，然后从程序集中提取该资源。

您认为处理此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-01T14:37:32.013

将包含测试的 PDF 文件保存在资源目录中。您的测试应该尽可能简单，而创建文件只是可能失败的另一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T14:36:32.313

我通常会在需要外部内容的附带测试中添加一个真实文件。这样您就可以使用真实文件进行测试，并且可以轻松地将其替换为不同类型的内容测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T14:39:46.563

我认为最好尽可能处理“真实”的对象。仅当处理测试数据集不可行时，引入“模拟”（在这种情况下它不是确切的术语）对象才有帮助。我不认为在你的版本控制系统中放置一个测试文件有什么大不了的，所以最好继续使用它而不是编写大量可能导致其他错误和测试的代码。

也使用非常接近预期平均文件的 PDF。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T14:57:28.783

将 pdf 文件（或具有 pdf 扩展名的虚拟文件）添加到资源中是可行的方法。您*应该*能够通过测试单元的相对路径（例如 ....\bla\foo.pdf）访问它。

并且不要仅仅为了测试您是否具有读取或写入权限而尝试创建有效的 pdf 文件。KISS[原则](http://en.wikipedia.org/wiki/KISS_principle)适用...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T14:44:03.480

我担心的是，如果我将文件放在不同的目录中。假设单元测试下的资源，那么我不需要文件的完整路径来访问它。我正在手动运行我的测试。此外，当我移动到另一台机器并将我的解决方案放在具有不同名称的文件夹中时，文件的路径就会变得混乱。

除非有某种方法可以从我的应用程序中访问项目的文件夹（应该有）。

# c# - 自定义 PowerShell 提示 - 相当于 CMD 的 $M$P$_$+$G?

> ID：157923
> 
> 赞同：2
> 
> 时间：2008-10-01T14:34:42.830
> 
> 标签：c#, powershell, command, prompt, customization

我已经开始“玩弄” PowerShell，并试图让它“表现”。

我想做的一件事是将 PROMPT 自定义为与 MS-Dos 上的 "$M$P$_$+$G" 所做的“相似”：

这些功能的快速概述：

**性格****| 说明**
**$m** 与当前驱动器号关联的远程名称，如果当前驱动器不是网络驱动器，则为空字符串。
**$p** 当前驱动器和路径
**$_** ENTER-LINEFEED
**$+** 零个或多个加号 (+) 字符取决于推送目录堆栈的深度，**每个**推送的级别一个字符
**$g** >（大于号）

所以最终的输出是这样的：

```
 \\spma1fp1\JARAVJ$ H:\temp
    ++> 
```

我已经能够将`$M`and`$_`功能（和一个漂亮的历史功能）添加到我的提示中，如下所示：

```
function prompt
{
   ## Get the history. Since the history may be either empty,
   ## a single item or an array, the @() syntax ensures
   ## that PowerShell treats it as an array
   $history = @(get-history)

   ## If there are any items in the history, find out the
   ## Id of the final one.
   ## PowerShell defaults the $lastId variable to '0' if this
   ## code doesn't execute.
   if($history.Count -gt 0)
   {
      $lastItem = $history[$history.Count - 1]
      $lastId = $lastItem.Id
   }

   ## The command that we're currently entering on the prompt
   ## will be next in the history. Because of that, we'll
   ## take the last history Id and add one to it.
   $nextCommand = $lastId + 1

   ## Get the current location
   $currentDirectory = get-location

   ## Set the Windows Title to  the current location
   $host.ui.RawUI.WindowTitle = "PS: " + $currentDirectory

   ## And create a prompt that shows the command number,
   ## and current location
   "PS:$nextCommand $currentDirectory
>"
} 
```

但其余的还不是我设法复制的东西......

非常感谢您肯定会提供的提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T14:46:54.610

这将为您提供 pushd 堆栈上的位置计数：

```
$(get-location -Stack).count 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T14:57:48.937

看看这是否符合您的要求：

```
function prompt
{
   ## Get the history. Since the history may be either empty,
   ## a single item or an array, the @() syntax ensures
   ## that PowerShell treats it as an array
   $history = @(get-history)

   ## If there are any items in the history, find out the
   ## Id of the final one.
   ## PowerShell defaults the $lastId variable to '0' if this
   ## code doesn't execute.
   if($history.Count -gt 0)
   {
      $lastItem = $history[$history.Count - 1]
      $lastId = $lastItem.Id
   }

   ## The command that we're currently entering on the prompt
   ## will be next in the history. Because of that, we'll
   ## take the last history Id and add one to it.
   $nextCommand = $lastId + 1

   ## Get the current location
   $currentDirectory = get-location

   ## Set the Windows Title to  the current location
   $host.ui.RawUI.WindowTitle = "PS: " + $currentDirectory

   ##pushd info
   $pushdCount = $(get-location -stack).count
   $pushPrompt = ""
   for ($i=0; $i -lt $pushdCount; $i++)
   {
       $pushPrompt += "+"
    }

   ## And create a prompt that shows the command number,
   ## and current location
   "PS:$nextCommand $currentDirectory `n$($pushPrompt)>"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T15:29:40.063

感谢 EBGReens 的回答，我的“提示”现在能够显示堆栈的深度：

```
 function prompt
 {
    ## Initialize vars
    $depth_string = ""

    ## Get the Stack -Pushd count
    $depth = (get-location -Stack).count

    ## Create a string that has $depth plus signs
    $depth_string = "+" * $depth

    ## Get the history. Since the history may be either empty,
    ## a single item or an array, the @() syntax ensures
    ## that PowerShell treats it as an array
    $history = @(get-history)

    ## If there are any items in the history, find out the
    ## Id of the final one.
    ## PowerShell defaults the $lastId variable to '0' if this
    ## code doesn't execute.
    if($history.Count -gt 0)
    {
       $lastItem = $history[$history.Count - 1]
       $lastId = $lastItem.Id
    }

    ## The command that we're currently entering on the prompt
    ## will be next in the history. Because of that, we'll
    ## take the last history Id and add one to it.
    $nextCommand = $lastId + 1

    ## Get the current location
    $currentDirectory = get-location

    ## Set the Windows Title to  the current location
    $host.ui.RawUI.WindowTitle = "PS: " + $currentDirectory

    ## And create a prompt that shows the command number,
    ## and current location
    "PS:$nextCommand $currentDirectory `n$($depth_string)>"
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T17:03:44.017

以下将为您提供相当于 $m 的值。

```
$mydrive = $pwd.Drive.Name + ":";
$networkShare = (gwmi -class "Win32_MappedLogicalDisk" -filter "DeviceID = '$mydrive'");

if ($networkShare -ne $null)
{
    $networkPath = $networkShare.ProviderName
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T17:12:39.410

感谢以下提示：

[在 PowerShell 中，如何确定当前驱动器是否为网络驱动器？](https://stackoverflow.com/questions/158359/in-powershell-how-can-i-determine-if-the-current-drive-is-a-networked-drive-or)
[在 PowerShell 中，如何确定驱动器的根目录（假设它是网络驱动器）](https://stackoverflow.com/questions/158520/in-powershell-how-can-i-determine-the-root-of-a-drive-supposing-its-a-networked)

我已经设法让它工作了。

我的完整个人资料是：

```
function prompt
{
   ## Initialize vars
   $depth_string = ""

   ## Get the Stack -Pushd count
   $depth = (get-location -Stack).count

   ## Create a string that has $depth plus signs
   $depth_string = "+" * $depth

   ## Get the history. Since the history may be either empty,
   ## a single item or an array, the @() syntax ensures
   ## that PowerShell treats it as an array
   $history = @(get-history)

   ## If there are any items in the history, find out the
   ## Id of the final one.
   ## PowerShell defaults the $lastId variable to '0' if this
   ## code doesn't execute.
   if($history.Count -gt 0)
   {
      $lastItem = $history[$history.Count - 1]
      $lastId = $lastItem.Id
   }

   ## The command that we're currently entering on the prompt
   ## will be next in the history. Because of that, we'll
   ## take the last history Id and add one to it.
   $nextCommand = $lastId + 1

   ## Get the current location
   $currentDirectory = get-location

   ## Set the Windows Title to  the current location
   $host.ui.RawUI.WindowTitle = "PS: " + $currentDirectory

        ## Get the current location's DRIVE LETTER
        $drive = (get-item ($currentDirectory)).root.name

        ## Make sure we're using a path that is not already UNC
        if ($drive.IndexOf(":") -ne "-1")
            {
                $root_dir = (get-wmiobject Win32_LogicalDisk | ? {$_.deviceid -eq $drive.Trim("\") } | % { $_.providername })+" "
          }
          else
          {
            $root_dir=""
          }

   ## And create a prompt that shows the command number,
   ## and current location
   "PS:$nextCommand $root_dir$currentDirectory `n$($depth_string)>"
} 
```

# linq - LINQ 的 ExecuteCommand 是否提供针对 SQL 注入攻击的保护？

> ID：157924
> 
> 赞同：16
> 
> 时间：2008-10-01T14:34:48.633
> 
> 标签：linq, linq-to-sql, sql-injection

我遇到了需要使用 LINQ 的 ExecuteCommand 方法来运行插入的情况。

类似的东西（为了这个问题而简化）：

```
object[] oParams = { Guid.NewGuid(), rec.WebMethodID };

TransLogDataContext.ExecuteCommand (
"INSERT INTO dbo.Transaction_Log (ID, WebMethodID) VALUES ({0}, {1})",
oParams); 
```

问题是这是否与参数化查询一样是 SQL 注入证明？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-01T14:38:59.327

做了一些研究，我发现了这个：

> 在我的简单测试中，看起来在 ExecuteQuery 和 ExecuteCommand 方法中传递的参数是根据提供的值自动进行 SQL 编码的。所以如果你传入一个带有'字符的字符串，它会自动SQL将它转义为''。我相信类似的策略用于其他数据类型，如 DateTimes、Decimals 等。

[http://weblogs.asp.net/scottgu/archive/2007/08/27/linq-to-sql-part-8-executing-custom-sql-expressions.aspx](http://weblogs.asp.net/scottgu/archive/2007/08/27/linq-to-sql-part-8-executing-custom-sql-expressions.aspx)
（您可以向下滚动找到它）

这对我来说似乎有点奇怪——大多数其他 .Net 工具都比“SQL 转义”更清楚；他们使用真实的查询参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T21:08:22.400

LINQ to SQL 使用带参数的*exec_sql*，这比连接到 ad-hoc 查询字符串要安全得多。它应该与使用 SqlCommand 及其 Paramaters 集合一样安全地对抗 SQL 注入（事实上，它可能是 LINQ to SQL 内部使用的）。*话又说回来，这*有多安全？

# c# - 实现线程安全字典的最佳方法是什么？

> ID：157933
> 
> 赞同：110
> 
> 时间：2008-10-01T14:36:52.420
> 
> 标签：c#, .net, thread-safety, collections

通过从 IDictionary 派生并定义私有 SyncRoot 对象，我能够在 C# 中实现线程安全字典：

```
public class SafeDictionary<TKey, TValue>: IDictionary<TKey, TValue>
{
    private readonly object syncRoot = new object();
    private Dictionary<TKey, TValue> d = new Dictionary<TKey, TValue>();

    public object SyncRoot
    {
        get { return syncRoot; }
    } 

    public void Add(TKey key, TValue value)
    {
        lock (syncRoot)
        {
            d.Add(key, value);
        }
    }

    // more IDictionary members...
} 
```

然后我在整个消费者（多个线程）中锁定这个 SyncRoot 对象：

例子：

```
lock (m_MySharedDictionary.SyncRoot)
{
    m_MySharedDictionary.Add(...);
} 
```

我能够让它工作，但这导致了一些丑陋的代码。我的问题是，是否有更好、更优雅的方式来实现线程安全字典？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2010-09-13T19:11:21.937

支持并发的 .NET 4.0 类名为[`ConcurrentDictionary`](http://msdn.microsoft.com/en-us/library/dd287191.aspx).

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2008-12-30T00:07:59.377

尝试在内部进行同步几乎肯定是不够的，因为它的抽象级别太低了。假设您使`Add`and`ContainsKey`操作单独成为线程安全的，如下所示：

```
public void Add(TKey key, TValue value)
{
    lock (this.syncRoot)
    {
        this.innerDictionary.Add(key, value);
    }
}

public bool ContainsKey(TKey key)
{
    lock (this.syncRoot)
    {
        return this.innerDictionary.ContainsKey(key);
    }
} 
```

那么当你从多个线程调用这个所谓的线程安全的代码时会发生什么？它总是可以正常工作吗？

```
if (!mySafeDictionary.ContainsKey(someKey))
{
    mySafeDictionary.Add(someKey, someValue);
} 
```

简单回答是不。在某些时候，该`Add`方法将抛出一个异常，指示该键已存在于字典中。你可能会问，这怎么可能是线程安全的字典？好吧，因为每个操作都是线程安全的，所以两个操作的组合不是，因为另一个线程可以在您调用`ContainsKey`and之间修改它`Add`。

这意味着要正确编写这种类型的场景，您需要在字典外加一个锁，*例如*

```
lock (mySafeDictionary)
{
    if (!mySafeDictionary.ContainsKey(someKey))
    {
        mySafeDictionary.Add(someKey, someValue);
    }
} 
```

但是现在，由于您必须编写外部锁定代码，因此您将内部和外部同步混为一谈，这总是会导致代码不清晰和死锁等问题。所以最终你可能会更好：

1.  使用正常`Dictionary<TKey, TValue>`并在外部同步，将复合操作包含在其上，或

2.  编写一个具有不同接口（即 not ）的新线程安全包装器，该接口`IDictionary<T>`组合诸如`AddIfNotContained`方法之类的操作，因此您永远不需要组合来自它的操作。

（我自己倾向于选择#1）

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2008-10-01T14:49:48.007

正如彼得所说，您可以将所有线程安全封装在类中。您需要小心您公开或添加的任何事件，确保它们在任何锁之外被调用。

```
public class SafeDictionary<TKey, TValue>: IDictionary<TKey, TValue>
{
    private readonly object syncRoot = new object();
    private Dictionary<TKey, TValue> d = new Dictionary<TKey, TValue>();

    public void Add(TKey key, TValue value)
    {
        lock (syncRoot)
        {
            d.Add(key, value);
        }
        OnItemAdded(EventArgs.Empty);
    }

    public event EventHandler ItemAdded;

    protected virtual void OnItemAdded(EventArgs e)
    {
        EventHandler handler = ItemAdded;
        if (handler != null)
            handler(this, e);
    }

    // more IDictionary members...
} 
```

**编辑：** MSDN 文档指出枚举本质上不是线程安全的。这可能是在类之外公开同步对象的原因之一。另一种方法是提供一些方法来对所有成员执行操作并锁定成员的枚举。这样做的问题是您不知道传递给该函数的操作是否调用了字典的某些成员（这将导致死锁）。公开同步对象允许消费者做出这些决定，并且不会隐藏类中的死锁。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-01T14:51:53.757

您不应该通过属性发布您的私有锁对象。锁定对象应该私下存在，其唯一目的是充当集合点。

如果使用标准锁证明性能很差，那么 Wintellect 的[Power Threading](http://www.wintellect.com/PowerThreading.aspx)锁集合会非常有用。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-01T15:13:32.597

您描述的实现方法存在几个问题。

1.  你永远不应该公开你的同步对象。这样做会向消费者敞开心扉，抓住物体并锁定它，然后你就完蛋了。
2.  您正在使用线程安全类实现非线程安全接口。恕我直言，这将使您付出代价

就个人而言，我发现实现线程安全类的最佳方法是通过不变性。它确实减少了线程安全可能遇到的问题数量。查看[Eric Lippert 的博客](https://docs.microsoft.com/en-gb/archive/blogs/ericlippert/immutability-in-c-part-nine-academic-plus-my-avl-tree-implementation)了解更多详情。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-01T14:42:32.220

您不需要锁定使用者对象中的 SyncRoot 属性。您在字典方法中拥有的锁就足够了。

**详细说明：** 最终发生的情况是您的字典被锁定的时间超过了必要的时间。

在您的情况下会发生以下情况：

假设线程 A在调用 m_mySharedDictionary.Add*之前获得了 SyncRoot 上的锁。*然后线程 B 尝试获取锁但被阻塞。事实上，所有其他线程都被阻塞了。允许线程 A 调用 Add 方法。在 Add 方法中的 lock 语句中，允许线程 A 再次获得锁，因为它已经拥有它。在方法内退出锁上下文，然后在方法外，线程 A 已释放所有锁，允许其他线程继续。

您可以简单地允许任何使用者调用 Add 方法，因为 SharedDictionary 类 Add 方法中的 lock 语句将具有相同的效果。此时，您有冗余锁定。如果您必须对需要保证连续发生的字典对象执行两个操作，则只能在字典方法之一之外锁定 SyncRoot。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-16T15:27:07.323

只是一个想法，为什么不重新创建字典？如果读取是大量写入，那么锁定将同步所有请求。

例子

```
 private static readonly object Lock = new object();
    private static Dictionary<string, string> _dict = new Dictionary<string, string>();

    private string Fetch(string key)
    {
        lock (Lock)
        {
            string returnValue;
            if (_dict.TryGetValue(key, out returnValue))
                return returnValue;

            returnValue = "find the new value";
            _dict = new Dictionary<string, string>(_dict) { { key, returnValue } };

            return returnValue;
        }
    }

    public string GetValue(key)
    {
        string returnValue;

        return _dict.TryGetValue(key, out returnValue)? returnValue : Fetch(key);
    } 
```

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2008-10-01T14:52:50.587

[集合和同步](http://msdn.microsoft.com/en-us/library/573ths2x(VS.80).aspx)

# python - 在 python 脚本中隐藏密码（仅限不安全的混淆）

> ID：157938
> 
> 赞同：159
> 
> 时间：2008-10-01T14:37:17.053
> 
> 标签：python, security

我有一个创建 ODBC 连接的 python 脚本。ODBC 连接是使用连接字符串生成的。在此连接字符串中，我必须包含此连接的用户名和密码。

是否有一种简单的方法可以在文件中隐藏此密码（只是在我编辑文件时没有人可以读取密码）？

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2008-10-01T14:43:51.030

[Base64 编码](https://docs.python.org/3/library/base64.html)在标准库中，可以阻止肩冲浪者：

```
>>> import base64
>>>  print(base64.b64encode("password".encode("utf-8")))
cGFzc3dvcmQ=
>>> print(base64.b64decode("cGFzc3dvcmQ=").decode("utf-8"))
password 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2014-04-02T19:45:46.540

这是一个简单的方法：

1.  创建一个 python 模块——我们称之为 peekaboo.py。
2.  在 peekaboo.py 中，包含密码和需要该密码的任何代码
3.  通过导入此模块（通过 python 命令行等）创建一个编译版本 - peekaboo.pyc。
4.  现在，删除 peekaboo.py。
5.  您现在可以仅依赖 peekaboo.pyc 愉快地导入 peekaboo。由于 peekaboo.pyc 是字节编译的，因此普通用户无法阅读。

这应该比 base64 解码更安全——尽管它容易受到 py_to_pyc 反编译器的攻击。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2008-10-01T15:34:13.267

当您需要为远程登录指定密码时，Douglas F Shearer's 是 Unix 中普遍认可的解决方案。
您添加一个**--password-from-file**选项来指定路径并从文件中读取纯文本。
然后，该文件可以位于受操作系统保护的用户自己的区域中。它还允许不同的用户自动选择自己的文件。

对于不允许脚本用户知道的密码 - 您可以使用提升权限运行脚本并拥有该 root/admin 用户拥有的密码文件。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2011-06-23T09:17:55.493

如果您在 Unix 系统上工作，请利用标准 Python 库中的 netrc 模块。它从一个单独的文本文件 (.netrc) 中读取密码，该文件的格式[在此处](http://www.mavetju.org/unix/netrc.php)描述。

这是一个小的用法示例：

```
import netrc

# Define which host in the .netrc file to use
HOST = 'mailcluster.loopia.se'

# Read from the .netrc file in your home directory
secrets = netrc.netrc()
username, account, password = secrets.authenticators( HOST )

print username, password 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-10-01T15:28:38.397

如何从脚本外部的文件中导入用户名和密码？这样即使有人掌握了脚本，他们也不会自动获得密码。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-10-01T16:09:40.543

最好的解决方案，假设用户不能在运行时给出用户名和密码，可能是一个单独的源文件，其中只包含导入到主代码中的用户名和密码的变量初始化。此文件仅在凭据更改时才需要编辑。否则，如果您只担心记忆力一般的肩冲浪者，base 64 编码可能是最简单的解决方案。ROT13 太容易手动解码，不区分大小写，在加密状态下保留了太多含义。在 python 脚本之外对您的密码和用户 ID 进行编码。让他在运行时进行脚本解码以供使用。

为自动化任务提供脚本凭据始终是一个冒险的提议。您的脚本应该有自己的凭据，并且它使用的帐户应该没有任何访问权限，除非是必需的。至少密码应该很长而且相当随机。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-10-01T22:26:09.280

base64 是满足您简单需求的方法。无需导入任何内容：

```
>>> 'your string'.encode('base64')
'eW91ciBzdHJpbmc=\n'
>>> _.decode('base64')
'your string' 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-04-03T01:40:40.733

对于**python3**的混淆使用`base64`是不同的：

```
import base64
base64.b64encode(b'PasswordStringAsStreamOfBytes') 
```

这导致

```
b'UGFzc3dvcmRTdHJpbmdBc1N0cmVhbU9mQnl0ZXM=' 
```

> 注意非正式的字符串表示，实际的字符串用引号引起来

并解码回原始字符串

```
base64.b64decode(b'UGFzc3dvcmRTdHJpbmdBc1N0cmVhbU9mQnl0ZXM=')
b'PasswordStringAsStreamOfBytes' 
```

要在需要字符串对象的情况下使用此结果，可以*翻译字节对象*

```
repr = base64.b64decode(b'UGFzc3dvcmRTdHJpbmdBc1N0cmVhbU9mQnl0ZXM=')
secret = repr.decode('utf-8')
print(secret) 
```

有关 python3 如何处理字节（和相应的字符串）的更多信息，请参阅[官方文档](https://docs.python.org/3/library/stdtypes.html#str)。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-07-02T01:27:20.133

我这样做的一种方法如下：

在 python 外壳：

```
>>> from cryptography.fernet import Fernet
>>> key = Fernet.generate_key()
>>> print(key)
b'B8XBLJDiroM3N2nCBuUlzPL06AmfV4XkPJ5OKsPZbC4='
>>> cipher = Fernet(key)
>>> password = "thepassword".encode('utf-8')
>>> token = cipher.encrypt(password)
>>> print(token)
b'gAAAAABe_TUP82q1zMR9SZw1LpawRLHjgNLdUOmW31RApwASzeo4qWSZ52ZBYpSrb1kUeXNFoX0tyhe7kWuudNs2Iy7vUwaY7Q==' 
```

然后，使用以下代码创建一个模块：

```
from cryptography.fernet import Fernet

# you store the key and the token
key = b'B8XBLJDiroM3N2nCBuUlzPL06AmfV4XkPJ5OKsPZbC4='
token = b'gAAAAABe_TUP82q1zMR9SZw1LpawRLHjgNLdUOmW31RApwASzeo4qWSZ52ZBYpSrb1kUeXNFoX0tyhe7kWuudNs2Iy7vUwaY7Q=='

# create a cipher and decrypt when you need your password
cipher = Fernet(key)

mypassword = cipher.decrypt(token).decode('utf-8') 
```

完成此操作后，您可以直接导入 mypassword，也可以根据需要导入令牌和密码进行解密。

显然，这种方法存在一些缺点。如果某人同时拥有令牌和密钥（就像他们拥有脚本一样），他们可以轻松解密。但是它确实会混淆，如果您编译代码（使用 Nuitka 之类的东西），至少您的密码不会在十六进制编辑器中显示为纯文本。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-01T16:19:00.973

这是一个很常见的问题。通常你能做的最好的就是

A）创建某种ceasar密码函数来编码/解码（只是不是rot13）或

B）首选方法是使用加密密钥，在您的程序范围内，对密码进行编码/解码。您可以在其中使用文件保护来保护访问密钥。

沿着这些思路，如果您的应用程序作为服务/守护程序（如网络服务器）运行，您可以将您的密钥放入受密码保护的密钥库中，并在服务启动过程中输入密码。管理员需要重新启动您的应用程序，但您将对您的配置密码有很好的保护。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-10-18T10:23:39.057

这是我的片段。您基本上将函数导入或复制到您的代码中。如果加密文件不存在，getCredentials 将创建它并返回一个字典，并且 updateCredential 将更新。

```
import os

def getCredentials():
    import base64

    splitter='<PC+,DFS/-SHQ.R'
    directory='C:\\PCT'

    if not os.path.exists(directory):
        os.makedirs(directory)

    try:
        with open(directory+'\\Credentials.txt', 'r') as file:
            cred = file.read()
            file.close()
    except:
        print('I could not file the credentials file. \nSo I dont keep asking you for your email and password everytime you run me, I will be saving an encrypted file at {}.\n'.format(directory))

        lanid = base64.b64encode(bytes(input('   LanID: '), encoding='utf-8')).decode('utf-8')  
        email = base64.b64encode(bytes(input('   eMail: '), encoding='utf-8')).decode('utf-8')
        password = base64.b64encode(bytes(input('   PassW: '), encoding='utf-8')).decode('utf-8')
        cred = lanid+splitter+email+splitter+password
        with open(directory+'\\Credentials.txt','w+') as file:
            file.write(cred)
            file.close()

    return {'lanid':base64.b64decode(bytes(cred.split(splitter)[0], encoding='utf-8')).decode('utf-8'),
            'email':base64.b64decode(bytes(cred.split(splitter)[1], encoding='utf-8')).decode('utf-8'),
            'password':base64.b64decode(bytes(cred.split(splitter)[2], encoding='utf-8')).decode('utf-8')}

def updateCredentials():
    import base64

    splitter='<PC+,DFS/-SHQ.R'
    directory='C:\\PCT'

    if not os.path.exists(directory):
        os.makedirs(directory)

    print('I will be saving an encrypted file at {}.\n'.format(directory))

    lanid = base64.b64encode(bytes(input('   LanID: '), encoding='utf-8')).decode('utf-8')  
    email = base64.b64encode(bytes(input('   eMail: '), encoding='utf-8')).decode('utf-8')
    password = base64.b64encode(bytes(input('   PassW: '), encoding='utf-8')).decode('utf-8')
    cred = lanid+splitter+email+splitter+password
    with open(directory+'\\Credentials.txt','w+') as file:
        file.write(cred)
        file.close()

cred = getCredentials()

updateCredentials() 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-01T15:22:32.000

您的操作系统可能提供了安全加密数据的设施。例如，在 Windows 上有 DPAPI（数据保护 API）。为什么不在您第一次运行时询问用户他们的凭据，然后将它们加密保存以供后续运行？

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-01T22:29:38.353

将配置信息放在加密的配置文件中。使用密钥在您的代码中查询此信息。将此密钥放在每个环境的单独文件中，并且不要将其与您的代码一起存储。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-05-30T19:24:20.870

更多的本土方法，而不是将身份验证/密码/用户名转换为加密的详细信息。**FTPLIB**只是一个例子。“ **pass.csv** ” 是 csv 文件名

将密码保存在 CSV 中，如下所示：

用户名

用户密码

（没有列标题）

读取 CSV 并将其保存到列表中。

使用列表元素作为身份验证详细信息。

完整的代码。

```
import os
import ftplib
import csv 
cred_detail = []
os.chdir("Folder where the csv file is stored")
for row in csv.reader(open("pass.csv","rb")):       
        cred_detail.append(row)
ftp = ftplib.FTP('server_name',cred_detail[0][0],cred_detail[1][0]) 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-06-28T10:03:26.220

你知道坑吗？

[https://pypi.python.org/pypi/pit](https://pypi.python.org/pypi/pit)（仅限 py2（0.3 版））

[https://github.com/yoshiori/pit](https://github.com/yoshiori/pit)（它将适用于 py3（当前版本 0.4））

测试.py

```
from pit import Pit

config = Pit.get('section-name', {'require': {
    'username': 'DEFAULT STRING',
    'password': 'DEFAULT STRING',
    }})
print(config) 
```

跑：

```
$ python test.py
{'password': 'my-password', 'username': 'my-name'} 
```

~/.pit/default.yml：

```
section-name:
  password: my-password
  username: my-name 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-11-11T16:37:02.393

如果在 Windows 上运行，您可以考虑使用 win32crypt 库。它允许运行脚本的用户存储和检索受保护的数据（密钥、密码），因此密码永远不会以明文或混淆格式存储在代码中。我不确定是否有其他平台的等效实现，因此严格使用 win32crypt 您的代码不可移植。

我相信该模块可以在这里获得：http: [//timgolden.me.uk/pywin32-docs/win32crypt.html](http://timgolden.me.uk/pywin32-docs/win32crypt.html)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-07-18T23:37:32.210

您还可以考虑将密码存储在脚本之外并在运行时提供它的可能性

例如弗雷德.py

```
import os
username = 'fred'
password = os.environ.get('PASSWORD', '')
print(username, password) 
```

可以像这样运行

```
$ PASSWORD=password123 python fred.py
fred password123 
```

`base64`通过使用（如上所述），在代码中使用不太明显的名称并进一步远离代码中的实际密码，可以实现额外的“通过默默无闻的安全性”层。

[如果代码在存储库中，则在其外部存储秘密](https://en.wikipedia.org/wiki/Trust_no_one_(Internet_security))通常很有用，因此可以将其添加到`~/.bashrc`（或存储库，或启动脚本，...）

```
export SURNAME=cGFzc3dvcmQxMjM= 
```

并更改`fred.py`为

```
import os
import base64
name = 'fred'
surname = base64.b64decode(os.environ.get('SURNAME', '')).decode('utf-8')
print(name, surname) 
```

然后重新登录并

```
$ python fred.py
fred password123 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-10-22T09:29:21.297

为什么没有一个简单的异或？

好处：

*   看起来像二进制数据
*   没有人可以在不知道密钥的情况下阅读它（即使它是单个字符）

我已经到了可以识别常见单词的简单 b64 字符串和 rot13 的程度。Xor 会使它变得更加困难。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-01T14:43:20.597

'Net 上有几个用 Python 编写的 ROT13 实用程序——只需 google 即可。ROT13 离线编码字符串，将其复制到源中，在传输点解码。

但这*确实是*弱保护...

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-10-29T16:14:57.667

这并不能准确回答您的问题，但它是相关的。我打算添加为评论，但不允许。我一直在处理同样的问题，我们决定将脚本公开给使用 Jenkins 的用户。这允许我们将 db 凭据存储在单独的文件中，该文件在服务器上被加密和保护，非管理员无法访问。它还为我们提供了一些创建 UI 和限制执行的捷径。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2020-05-25T12:20:57.453

```
import base64
print(base64.b64encode("password".encode("utf-8")))
print(base64.b64decode(b'cGFzc3dvcmQ='.decode("utf-8"))) 
```

# java - 从数组创建 ArrayList

> ID：157944
> 
> 赞同：3933
> 
> 时间：2008-10-01T14:38:32.667
> 
> 标签：java, arrays, arraylist, type-conversion

我有一个初始化为的数组：

```
Element[] array = {new Element(1), new Element(2), new Element(3)}; 
```

我想将此数组转换为[`ArrayList`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ArrayList.html)该类的对象。

```
ArrayList<Element> arraylist = ???; 
```

* * *

## 回答 #1

> 赞同：4937
> 
> 时间：2008-10-01T14:39:12.010

```
new ArrayList<>(Arrays.asList(array)); 
```

* * *

## 回答 #2

> 赞同：975
> 
> 时间：2008-10-01T15:39:06.903

鉴于：

```
Element[] array = new Element[] { new Element(1), new Element(2), new Element(3) }; 
```

最简单的答案是：

```
List<Element> list = Arrays.asList(array); 
```

这将正常工作。但有一些注意事项：

1.  从 asList 返回的列表具有**固定大小**。因此，如果您希望能够在代码的返回列表中添加或删除元素，您需要将其包装在一个新的`ArrayList`. 否则你会得到一个`UnsupportedOperationException`.
2.  从返回的列表`asList()`由原始数组支持。如果修改原始数组，列表也会被修改。这可能令人惊讶。

* * *

## 回答 #3

> 赞同：375
> 
> 时间：2012-11-16T17:16:41.463

*^(（旧线程，但只有 2 美分，因为没有提到番石榴或其他库和其他一些细节）)*

# 如果可以，请使用番石榴

值得指出的是 Guava 方式，它极大地简化了这些恶作剧：

## 用法

### 对于不可变列表

使用[`ImmutableList`](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/ImmutableList.java)类及其[`of()`](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/ImmutableList.java#L101)和[`copyOf()`](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/ImmutableList.java#L225)工厂方法^(（元素不能为空）)：

```
List<String> il = ImmutableList.of("string", "elements");  // from varargs
List<String> il = ImmutableList.copyOf(aStringArray);      // from array 
```

### 对于可变列表

使用[`Lists`](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/Lists.java)类及其[`newArrayList()`](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/Lists.java#L87)工厂方法：

```
List<String> l1 = Lists.newArrayList(anotherListOrCollection);    // from collection
List<String> l2 = Lists.newArrayList(aStringArray);               // from array
List<String> l3 = Lists.newArrayList("or", "string", "elements"); // from varargs 
```

另请注意其他类中其他数据结构的类似方法，例如[`Sets`](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/Sets.java).

## [为什么是番石榴？](http://code.google.com/p/guava-libraries/wiki/GuavaExplained)

主要的吸引力可能是减少由于类型安全泛型导致的混乱，因为使用 Guava[工厂方法](http://code.google.com/p/guava-libraries/wiki/CollectionUtilitiesExplained#Static_constructors)允许在大多数时间推断类型。然而，自从 Java 7 与新的菱形运算符一起出现以来，这个论点就不那么成立了。

但这不是唯一的原因（Java 7 还不是无处不在）：速记语法也非常方便，方法初始化器，如上所示，允许编写更具表现力的代码。您可以在一个 Guava 调用中执行当前 Java 集合需要 2 的操作。

* * *

# 如果你不能...

## 对于不可变列表

使用 JDK 的[`Arrays`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html)类及其[`asList()`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#asList%28T...%29)工厂方法，用[`Collections.unmodifiableList()`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#unmodifiableList%28java.util.List%29):

```
List<String> l1 = Collections.unmodifiableList(Arrays.asList(anArrayOfElements));
List<String> l2 = Collections.unmodifiableList(Arrays.asList("element1", "element2")); 
```

请注意，返回的类型为`asList()`a`List`使用具体`ArrayList`实现，但**它不是** `java.util.ArrayList`。它是一种内部类型，它模拟`ArrayList`但实际上直接引用传递的数组并使其“直写”（修改反映在数组中）。

它禁止通过`List`简单地扩展一个 API 的方法进行修改`AbstractList`（因此，不支持添加或删除元素），但是它允许调用`set()`覆盖元素。因此，这个列表并不是真正不可变的，对的调用`asList()`应该用`Collections.unmodifiableList()`.

如果您需要可变列表，请参阅下一步。

## 对于可变列表

与上面相同，但用实际包装`java.util.ArrayList`：

```
List<String> l1  = new ArrayList<String>(Arrays.asList(array));    // Java 1.5 to 1.6
List<String> l1b = new ArrayList<>(Arrays.asList(array));          // Java 1.7+
List<String> l2  = new ArrayList<String>(Arrays.asList("a", "b")); // Java 1.5 to 1.6
List<String> l2b = new ArrayList<>(Arrays.asList("a", "b"));       // Java 1.7+ 
```

* * *

# 出于教育目的：良好的手动方式

```
// for Java 1.5+
static <T> List<T> arrayToList(final T[] array) {
  final List<T> l = new ArrayList<T>(array.length);

  for (final T s : array) {
    l.add(s);
  }
  return (l);
}

// for Java < 1.5 (no generics, no compile-time type-safety, boo!)
static List arrayToList(final Object[] array) {
  final List l = new ArrayList(array.length);

  for (int i = 0; i < array.length; i++) {
    l.add(array[i]);
  }
  return (l);
} 
```

* * *

## 回答 #4

> 赞同：248
> 
> 时间：2011-06-22T11:30:23.463

由于这个问题已经很老了，令我惊讶的是，还没有人提出最简单的形式：

```
List<Element> arraylist = Arrays.asList(new Element(1), new Element(2), new Element(3)); 
```

从 Java 5 开始，`Arrays.asList()`采用 varargs 参数，您不必显式构造数组。

* * *

## 回答 #5

> 赞同：223
> 
> 时间：2008-10-01T14:40:46.607

```
new ArrayList<T>(Arrays.asList(myArray)); 
```

确保它`myArray`与`T`. 例如，如果您尝试`List<Integer>`从 的数组创建 a，您将收到编译器错误`int`。

* * *

## 回答 #6

> 赞同：111
> 
> 时间：2012-04-03T23:20:55.823

另一种方式（虽然在性能方面基本上等同于`new ArrayList(Arrays.asList(array))`解决方案：

```
Collections.addAll(arraylist, array); 
```

* * *

## 回答 #7

> 赞同：109
> 
> 时间：2016-04-17T16:58:35.317

# 爪哇 9

在[Java 9](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_9)中，您可以使用[`List.of`](https://docs.oracle.com/javase/9/docs/api/java/util/List.html#of-E-E-E-)静态工厂方法来创建`List`文字。类似于以下内容：

```
List<Element> elements = List.of(new Element(1), new Element(2), new Element(3)); 
```

这将返回一个包含三个元素的[***不可变列表。***](https://en.wikipedia.org/wiki/Immutable_object)如果您想要一个***可变***列表，请将该列表传递给`ArrayList`构造函数：

```
new ArrayList<>(List.of(// elements vararg)) 
```

* * *

### JEP 269：集合的便利工厂方法

[JEP 269为](http://openjdk.java.net/jeps/269)[Java Collections](https://en.wikipedia.org/wiki/Java_collections_framework) API提供了一些便利的工厂方法。这些不可变的静态工厂方法内置于 Java 9 及更高版本的 、 和 接口[`List`](https://docs.oracle.com/javase/9/docs/api/java/util/List.html)中[`Set`](https://docs.oracle.com/javase/9/docs/api/java/util/Set.html)。[`Map`](https://docs.oracle.com/javase/9/docs/api/java/util/Map.html)

* * *

## 回答 #8

> 赞同：90
> 
> 时间：2008-10-01T14:45:02.917

您可能只需要一个列表，而不是一个 ArrayList。在这种情况下，您可以这样做：

```
List<Element> arraylist = Arrays.asList(array); 
```

* * *

## 回答 #9

> 赞同：76
> 
> 时间：2014-11-25T20:48:36.917

另一个更新，即将于 2014 年结束，您也可以使用 Java 8：

```
ArrayList<Element> arrayList = Stream.of(myArray).collect(Collectors.toCollection(ArrayList::new)); 
```

一些字符将被保存，如果这可能只是一个`List`

```
List<Element> list = Stream.of(myArray).collect(Collectors.toList()); 
```

* * *

## 回答 #10

> 赞同：48
> 
> 时间：2014-01-18T13:01:42.113

如果您使用：

```
new ArrayList<T>(Arrays.asList(myArray)); 
```

您**可以**创建**并填写**两个列表！填充两次大列表正是您不想做的，因为`Object[]`每次需要扩展容量时它都会创建另一个数组。

幸运的是，JDK 的实现速度很快，而且`Arrays.asList(a[])`做得很好。它创建一种名为 Arrays.ArrayList 的 ArrayList，其中 Object[] 数据直接指向该数组。

```
// in Arrays
@SafeVarargs
public static <T> List<T> asList(T... a) {
    return new ArrayList<>(a);
}
//still in Arrays, creating a private unseen class
private static class ArrayList<E>

    private final E[] a;    
    ArrayList(E[] array) {
        a = array; // you point to the previous array
    }
    ....
} 
```

危险的一面是，**如果你改变了初始数组，你就改变了 List ！**你确定你想要那个吗？可能是可能不是。

如果没有，最容易理解的方法是这样做：

```
ArrayList<Element> list = new ArrayList<Element>(myArray.length); // you know the initial capacity
for (Element element : myArray) {
    list.add(element);
} 
```

或者如@glglgl 所说，您可以使用以下命令创建另一个独立的 ArrayList：

```
new ArrayList<T>(Arrays.asList(myArray)); 
```

我喜欢使用`Collections`,`Arrays`或 Guava。但如果它不合适，或者你没有感觉，那就写另一条不雅的行来代替。

* * *

## 回答 #11

> 赞同：41
> 
> 时间：2017-04-11T12:20:45.653

在`Java 9`您可以使用：

```
List<String> list = List.of("Hello", "World", "from", "Java");
List<Integer> list = List.of(1, 2, 3, 4, 5); 
```

* * *

## 回答 #12

> 赞同：36
> 
> 时间：2015-05-17T22:07:25.277

根据问题，使用 java 1.7 的答案是：

```
ArrayList<Element> arraylist = new ArrayList<Element>(Arrays.<Element>asList(array)); 
```

但是最好总是使用界面：

```
List<Element> arraylist = Arrays.<Element>asList(array); 
```

* * *

## 回答 #13

> 赞同：33
> 
> 时间：2014-01-07T06:04:45.857

```
// Guava
import com.google.common.collect.ListsLists
...
List<String> list = Lists.newArrayList(aStringArray); 
```

* * *

## 回答 #14

> 赞同：26
> 
> 时间：2016-12-23T12:31:28.400

从 Java 8 开始，有一种更简单的转换方法：

```
import java.util.List;    
import static java.util.stream.Collectors.toList;

public static <T> List<T> fromArray(T[] array) {
    return Arrays.stream(array).collect(toList());
} 
```

* * *

## 回答 #15

> 赞同：25
> 
> 时间：2016-05-02T08:40:44.647

您可以使用不同的方法进行转换

1.  `List<Element> list = Arrays.asList(array);`

2.  `List<Element> list = new ArrayList();
    Collections.addAll(list, array);`

3.  `Arraylist list = new Arraylist();
    list.addAll(Arrays.asList(array));`

有关更多详细信息，您可以参考[http://javarevisited.blogspot.in/2011/06/converting-array-to-arraylist-in-java.html](http://javarevisited.blogspot.in/2011/06/converting-array-to-arraylist-in-java.html)

* * *

## 回答 #16

> 赞同：24
> 
> 时间：2017-01-05T18:32:55.717

就像所有人说的那样

```
 new ArrayList<>(Arrays.asList("1","2","3","4")); 
```

创建数组的常见最新方法是**observableArrays**

**ObservableList：**允许侦听器在发生更改时跟踪更改的列表。

对于 Java SE，您可以尝试

```
FXCollections.observableArrayList(new Element(1), new Element(2), new Element(3)); 
```

这是根据[Oracle Docs](https://docs.oracle.com/javase/8/javafx/api/javafx/collections/FXCollections.html)

> observableArrayList() 创建一个由 arraylist 支持的新的空 observable 列表。observableArrayList(E... items) 创建一个新的可观察数组列表，其中添加了项目。

## **更新 Java 9**

在 Java 9 中也有一点简单：

```
List<String> list = List.of("element 1", "element 2", "element 3"); 
```

* * *

## 回答 #17

> 赞同：22
> 
> 时间：2016-02-06T08:56:21.030

您也可以使用 Java 8 中的流来实现。

```
 List<Element> elements = Arrays.stream(array).collect(Collectors.toList()); 
```

* * *

## 回答 #18

> 赞同：18
> 
> 时间：2016-03-30T06:48:14.027

1.  如果我们看到`Arrays.asList()`方法的定义，你会得到这样的：

    ```
     public static <T> List<T> asList(T... a) //varargs are of T type. 
    ```

    所以，你可以`arraylist`这样初始化：

    ```
     List<Element> arraylist = Arrays.asList(new Element(1), new Element(2), new Element(3)); 
    ```

    > **注意**：每个都`new Element(int args)`将被视为单个对象，并且可以作为`var-args`.

2.  这个问题也可能有另一个答案。
    如果您看到`java.util.Collections.addAll()`方法声明，您将得到如下信息：

    ```
    public static <T> boolean addAll(Collection<? super T> c, T... a); 
    ```

    因此，此代码也很有用

    ```
    Collections.addAll(arraylist, array); 
    ```

* * *

## 回答 #19

> 赞同：12
> 
> 时间：2015-12-16T20:32:39.263

另一种简单的方法是使用 for-each 循环将数组中的所有元素添加到新的 ArrayList 中。

```
ArrayList<Element> list = new ArrayList<>();

for(Element e : array)
    list.add(e); 
```

* * *

## 回答 #20

> 赞同：12
> 
> 时间：2017-07-10T02:21:29.697

如果数组是原始类型，则给定的答案将不起作用。但从 Java 8 开始，您可以使用：

```
int[] array = new int[5];
Arrays.stream(array).boxed().collect(Collectors.toList()); 
```

* * *

## 回答 #21

> 赞同：9
> 
> 时间：2017-04-07T18:45:50.753

即使这个问题有很多完美的书面答案，我也会添加我的输入。

说你有`Element[] array = { new Element(1), new Element(2), new Element(3) };`

可以通过以下方式创建新的 ArrayList

```
ArrayList<Element> arraylist_1 = new ArrayList<>(Arrays.asList(array));
ArrayList<Element> arraylist_2 = new ArrayList<>(
    Arrays.asList(new Element[] { new Element(1), new Element(2), new Element(3) }));

// Add through a collection
ArrayList<Element> arraylist_3 = new ArrayList<>();
Collections.addAll(arraylist_3, array); 
```

并且它们很好地支持 ArrayList 的所有操作

```
arraylist_1.add(new Element(4)); // or remove(): Success
arraylist_2.add(new Element(4)); // or remove(): Success
arraylist_3.add(new Element(4)); // or remove(): Success 
```

但以下操作仅返回 ArrayList 的 List 视图，而不是实际的 ArrayList。

```
// Returns a List view of array and not actual ArrayList
List<Element> listView_1 = (List<Element>) Arrays.asList(array);
List<Element> listView_2 = Arrays.asList(array);
List<Element> listView_3 = Arrays.asList(new Element(1), new Element(2), new Element(3)); 
```

因此，它们在尝试进行一些 ArrayList 操作时会出错

```
listView_1.add(new Element(4)); // Error
listView_2.add(new Element(4)); // Error
listView_3.add(new Element(4)); // Error 
```

更多关于数组[链接](https://stackoverflow.com/questions/43187083/benefits-of-creating-a-list-using-arrays-aslist)的列表表示。

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2017-05-03T08:38:28.200

最简单的方法是添加以下代码。久经考验。

```
String[] Array1={"one","two","three"};
ArrayList<String> s1= new ArrayList<String>(Arrays.asList(Array1)); 
```

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2017-06-07T12:14:25.317

您可以在 java 8 中执行以下操作

```
ArrayList<Element> list = (ArrayList<Element>)Arrays.stream(array).collect(Collectors.toList()); 
```

* * *

## 回答 #24

> 赞同：9
> 
> 时间：2017-06-20T08:33:05.757

> 另一个Java8解决方案*（我可能错过了大集合中的答案。如果是这样，我很抱歉）。*这会创建一个 ArrayList（与 List 相对），即可以删除元素

```
package package org.something.util;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

public class Junk {

    static <T> ArrayList<T>  arrToArrayList(T[] arr){
        return Arrays.asList(arr)
            .stream()
            .collect(Collectors.toCollection(ArrayList::new));
    }

    public static void main(String[] args) {
        String[] sArr = new String[]{"Hello", "cruel", "world"};
        List<String> ret = arrToArrayList(sArr);
        // Verify one can remove an item and print list to verify so
        ret.remove(1);
        ret.stream()
            .forEach(System.out::println);
    }
} 
```

输出是......
你好
世界

* * *

## 回答 #25

> 赞同：9
> 
> 时间：2017-07-04T07:22:33.683

我们可以轻松地将数组转换为`ArrayList`. 我们使用 Collection 接口的`addAll()`方法将内容从一个列表复制到另一个列表。

```
 Arraylist arr = new Arraylist();
 arr.addAll(Arrays.asList(asset)); 
```

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2018-12-03T11:32:10.090

使用以下代码将元素数组转换为 ArrayList。

```
Element[] array = {new Element(1), new Element(2), new Element(3)};

ArrayList<Element>elementArray=new ArrayList();
for(int i=0;i<array.length;i++) {
    elementArray.add(array[i]);
} 
```

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2019-09-07T20:36:28.793

**给定对象数组：**

```
Element[] array = {new Element(1), new Element(2), new Element(3) , new Element(2)}; 
```

**将数组转换为列表：**

```
 List<Element> list = Arrays.stream(array).collect(Collectors.toList()); 
```

**将数组转换为 ArrayList**

```
 ArrayList<Element> arrayList = Arrays.stream(array)
                                       .collect(Collectors.toCollection(ArrayList::new)); 
```

**将数组转换为链表**

```
 LinkedList<Element> linkedList = Arrays.stream(array)
                     .collect(Collectors.toCollection(LinkedList::new)); 
```

**打印清单：**

```
 list.forEach(element -> {
        System.out.println(element.i);
    }); 
```

**输出**

1

2

3

* * *

## 回答 #28

> 赞同：6
> 
> 时间：2017-07-25T06:03:11.847

每个人都已经为您的问题提供了足够好的答案。现在从所有建议中，您需要确定哪个适合您的要求。您需要了解两种类型的集合。一个是未修改的集合，另一个是允许您稍后修改对象的集合。

因此，在这里我将给出两个用例的简短示例。

*   不可变集合创建 :: 当你不想在创建后修改集合对象时

    `List<Element> elementList = Arrays.asList(array)`

*   可变集合创建 :: 当您可能希望在创建后修改已创建的集合对象时。

    `List<Element> elementList = new ArrayList<Element>(Arrays.asList(array));`

* * *

## 回答 #29

> 赞同：6
> 
> 时间：2019-05-19T11:20:27.540

Java 8 的 Arrays 类提供了一个 stream() 方法，该方法具有接受原始数组和对象数组的重载版本。

```
/**** Converting a Primitive 'int' Array to List ****/

int intArray[] = {1, 2, 3, 4, 5};

List<Integer> integerList1 = Arrays.stream(intArray).boxed().collect(Collectors.toList());

/**** 'IntStream.of' or 'Arrays.stream' Gives The Same Output ****/

List<Integer> integerList2 = IntStream.of(intArray).boxed().collect(Collectors.toList());

/**** Converting an 'Integer' Array to List ****/

Integer integerArray[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};

List<Integer> integerList3 = Arrays.stream(integerArray).collect(Collectors.toList()); 
```

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2019-12-04T07:59:42.910

下面的代码似乎是这样做的好方法。

```
new ArrayList<T>(Arrays.asList(myArray)); 
```

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2020-11-18T12:45:57.733

对于正常大小的数组，上面的答案很好。如果您有很大的数组并使用 java 8，您可以使用流来完成。

```
 Element[] array = {new Element(1), new Element(2), new Element(3)};
  List<Element> list = Arrays.stream(array).collect(Collectors.toList()); 
```

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2017-06-26T12:19:51.840

`ArrayList`您可以使用[Cactoos](http://www.cactoos.org)创建一个（我是开发人员之一）：

```
List<String> names = new StickyList<>(
  "Scott Fitzgerald", "Fyodor Dostoyevsky"
); 
```

不能保证该对象实际上是 class `ArrayList`。如果您需要该保证，请执行以下操作：

```
ArrayList<String> list = new ArrayList<>(
  new StickyList<>(
    "Scott Fitzgerald", "Fyodor Dostoyevsky"
  )
); 
```

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2019-08-02T05:50:11.953

*生成类型* `ArrayList<Element>`
(1) 的列表的 lambda 表达式，没有未经检查的强制转换
(2)，而不创建第二个列表（例如。`asList()`）

`ArrayList<Element> list = Stream.of( array ).collect( Collectors.toCollection( ArrayList::new ) );`

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2020-09-24T11:27:20.967

在java中主要有3种方法将**数组**转换为**arrayList**

1.  使用 Arrays.asList() 方法：将所需的数组传递给该方法并获取一个 List 对象并将其作为参数传递给 ArrayList 类的构造函数。

    ```
    List<String> list = Arrays.asList(array);                   
    System.out.println(list); 
    ```

2.  Collections.addAll() 方法 - 在使用此方法之前创建一个新列表，然后使用此方法将数组元素添加到现有列表中。

    ```
     List<String> list1 = new ArrayList<String>();
     Collections.addAll(list1, array);
     System.out.println(list1); 
    ```

3.  迭代方法 - 创建一个新列表。迭代数组并将每个元素添加到列表中。

    ```
     List<String> list2 = new ArrayList<String>();
     for(String text:array) {
         list2.add(text);
     }
     System.out.println(list2); 
    ```

你也可以参考[这个文件](https://www.tutorialspoint.com/Conversion-of-Array-To-ArrayList-in-Java)

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2020-10-21T04:24:37.477

您可以使用以下 3 种方式从 Array 创建 ArrayList。

```
 String[] array = {"a", "b", "c", "d", "e"};

  //Method 1
  List<String> list = Arrays.asList(array);          

  //Method 2
  List<String> list1 = new ArrayList<String>();
  Collections.addAll(list1, array);

  //Method 3
  List<String> list2 = new ArrayList<String>();
  for(String text:array) {
     list2.add(text);
  } 
```

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2020-11-17T03:39:28.670

还有另一种方法可用于将数组转换为 ArrayList。您可以遍历数组并将每个索引插入到 ArrayList 中，然后像在 ArrayList 中一样将其返回。

这如下所示。

```
public static void main(String[] args) {
        String[] array = {new String("David"), new String("John"), new String("Mike")};

        ArrayList<String> theArrayList = convertToArrayList(array);
    }

    private static ArrayList<String> convertToArrayList(String[] array) {
        ArrayList<String> convertedArray = new ArrayList<String>();

        for (String element : array) {
            convertedArray.add(element);
        }

        return convertedArray;
    } 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2020-07-06T08:13:56.623

嗨，你可以使用这个**`line of code`**，这是**最简单的方法**

```
 new ArrayList<>(Arrays.asList(myArray)); 
```

或者如果你使用 **`Java 9`**你也可以使用这个方法：

```
List<String> list = List.of("Hello", "Java"); 
List<Integer> list = List.of(1, 2, 3); 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2021-06-16T13:28:18.660

您还可以在调用**Arrays -interface 时使用****多态性**来声明**ArrayList**，如下所示：

 **`List<Element> arraylist = new ArrayList<Integer>(Arrays.asList(array));`

**例子：**

```
Integer[] array = {1};    // autoboxing
List<Integer> arraylist = new ArrayList<Integer>(Arrays.asList(array)); 
```

这应该像一个魅力。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2019-03-28T11:42:43.403

使用下面的代码

```
Element[] array = {new Element(1), new Element(2), new Element(3)};
ArrayList<Element> list = (ArrayList) Arrays.asList(array); 
```

# kernel - AMD PowerNow 状态更改操作的延迟是多少？

> ID：157947
> 
> 赞同：5
> 
> 时间：2008-10-01T14:39:03.320
> 
> 标签：kernel

在低延迟交易应用程序中，我们非常注意延迟问题。如果运行它的服务器更改 PowerNow 状态，我们的应用程序可能会遇到延迟增加的问题。

任何熟悉调用 PowerNow 更改的内核开发人员以及操作使用了多少处理器时间以及延迟/延迟特性是什么样的？

英特尔 SpeedStep 的相同信息会很有用，但我们实际使用的是 PowerNow。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T16:53:26.227

Linux 内核似乎假设完成 PowerNow 状态更改操作的上限为五分之一毫秒。

不过，我认为比状态更改本身的成本更大的担忧是，降低 CPU 频率会使您的应用程序运行速度变慢，从而增加整体延迟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T16:49:23.100

我怀疑它有任何延迟。PowerNow 只是降低核心频率和核心电压。我不知道它会在短时间内停止 CPU 这样做，然后在更改后恢复处理。AFAIK 更改是即时发生的，因此不会中断处理。

因此，更大的问题可能是您依赖于一定的速度（例如，您假设处理器每秒可以执行那么多操作），但是当核心频率降低时，它会表现得像一个更慢的 CPU（每秒的操作更少）和核心频率不会因为 CPU 不是 100% 空闲而跳到最大值。当 CPU 认为它需要比当前更多的处理能力时，它会再次跳起来。

在 Linux 上，如果您在其上运行带有 Windows 的 VMWare，PowerNow 可能会导致严重问题。Windows 无法正确更新内部时钟，因为它似乎没有检测到 PowerNow 有效（我猜是因为它在虚拟机中运行）并且 VMWare for Linux 也无法正确处理这种情况。因此，一旦 PowerNow 处于活动状态，Windows 时钟就会落后，并且 VMWare 会不时检测到这一点并再次更正时钟。到目前为止一切顺利，但是依赖于 Windows 时钟的应用程序会看到这种奇怪的跳跃并且表现得相当奇怪（例如，我知道的无线电流媒体软件会在 MP3 流中跳跃，并且每次重新同步时钟时都会跳过几毫秒）。

如果您的应用程序强烈依赖于稳定的程序流，您可能希望完全禁用 PowerNow 功能。使用互联网广播流软件，这是解决跳过问题的唯一方法。

# macos - 当我 ssh 到特定服务器时，如何使苹果终端窗口自动更改配色方案

> ID：157959
> 
> 赞同：51
> 
> 时间：2008-10-01T14:41:38.243
> 
> 标签：macos, terminal, osx-leopard

当我 ssh 进入远程生产服务器时，我希望我的终端窗口的配色方案更改为明亮而可怕的颜色，最好是红色，以警告我我正在触摸一个实时的可怕服务器。

如何让它自动检测到我在某处进行了 ssh，如果某处在特定列表中，请更改配色方案？

我想更新 Terminal.app 的方案，不知道如何在纯 linux/unix 环境中执行此操作

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-10-03T10:12:06.057

将以下脚本放入`~/bin/ssh`（确保之前在您的 PATH`~/bin/`中检查过）：`/usr/bin/`

```
#!/bin/sh

HOSTNAME=`echo $@ | sed s/.*@//`

set_bg () {
  osascript -e "tell application \"Terminal\" to set background color of window 1 to $1"
}

on_exit () {
  set_bg "{0, 0, 0, 50000}"
}
trap on_exit EXIT

case $HOSTNAME in
  production1|production2|production3) set_bg "{45000, 0, 0, 50000}" ;;
  *) set_bg "{0, 45000, 0, 50000}" ;;
esac

/usr/bin/ssh "$@" 
```

请记住通过运行使脚本可执行`chmod +x ~/bin/ssh`

上面的脚本从“username@host”行中提取主机名（假设您使用“ssh user@host”登录到远程主机）。

然后根据主机名设置红色背景（用于生产服务器）或绿色背景（用于所有其他服务器）。因此，您所有的 ssh 窗口都将带有彩色背景。

我在这里假设您的默认背景为黑色，因此当您从远程服务器注销时，脚本会将背景颜色恢复为黑色（请参阅“trap on_exit”）。

但请注意，此脚本不会跟踪从一台主机到另一台主机的 ssh 登录链。因此，如果您先登录到测试服务器，然后从它登录到生产环境，背景将是绿色的。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-09-11T12:47:33.753

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-12-29T15:09:57.780

另一种解决方案是在 ssh 配置文件中设置颜色限制：

在 ~/.ssh/config 里面

```
Host Server1
   HostName x.x.x.x
   User ubuntu
   IdentityFile ~/Desktop/keys/1.pem
   PermitLocalCommand yes
   LocalCommand osascript -e "tell application \"Terminal\" to set background color of window 1 to {27655, 0, 0, -16373}"

Host Server2
   HostName x.x.x.x
   User ubuntu
   IdentityFile ~/Desktop/keys/2.pem
   PermitLocalCommand yes
   LocalCommand osascript -e "tell application \"Terminal\" to set background color of window 1 to {37655, 0, 0, -16373}" 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-09-24T12:05:32.410

这是一个基于处理退出的几个现有答案的组合解决方案。如果您不想处理 16 位颜色值，还包括一些额外的内容。

这应该放在你的*~/.bash_profile*

```
# Convert 8 bit r,g,b,a (0-255) to 16 bit r,g,b,a (0-65535)
# to set terminal background.
# r, g, b, a values default to 255
set_bg () {
    r=${1:-255}
    g=${2:-255}
    b=${3:-255}
    a=${4:-255}

    r=$(($r * 256 + $r))
    g=$(($g * 256 + $g))
    b=$(($b * 256 + $b))
    a=$(($a * 256 + $a))

    osascript -e "tell application \"Terminal\" to set background color of window 1 to {$r, $g, $b, $a}"
}

# Set terminal background based on hex rgba values
# r,g,b,a default to FF
set_bg_from_hex() {
    r=${1:-FF}
    g=${2:-FF}
    b=${3:-FF}
    a=${4:-FF}

    set_bg $((16#$r)) $((16#$g)) $((16#$b)) $((16#$s))
}

# Wrapping ssh command with extra functionality
ssh() {
    # If prod server of interest, change bg color
    if ...some check for server list
    then
        set_bg_from_hex 6A 05 0C
    end

    # Call original ssh command
    if command ssh "$@"
    then
        # on exit change back to your default
        set_bg_from_hex 24 34 52
    fi
} 
```

*   set_bg - 采用 4（8 位）颜色值
*   set_bg_from_hex - 采用 4 个十六进制值。我使用的大多数颜色参考都是十六进制的，所以这对我来说更容易。实际解析 #RRGGBB 而不是 RR GG BB 可以更进一步，但它对我来说效果很好。
*   ssh - 使用您想要的任何自定义逻辑包装默认 ssh 命令。if 语句用于处理退出以重置背景颜色。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-09-14T11:42:58.827

结合答案[1](https://stackoverflow.com/a/166201/1024794)和[2](https://superuser.com/a/209920/195425)有以下内容：

[按照1](https://stackoverflow.com/a/166201/1024794)`~/bin/ssh`中的描述创建文件，其内容如下：

```
#!/bin/sh
# https://stackoverflow.com/a/39489571/1024794
log(){
  echo "$*" >> /tmp/ssh.log
}
HOSTNAME=`echo $@ | sed s/.*@//`
log HOSTNAME=$HOSTNAME
# to avoid changing color for commands like `ssh user@host "some bash script"`
# and to avoid changing color for `git push` command:
if [ $# -gt 3 ] || [[ "$HOSTNAME" = *"git-receive-pack"* ]]; then
  /usr/bin/ssh "$@"
  exit $? 
fi

set_bg () {
  if [ "$1" != "Basic" ]; then
    trap on_exit EXIT;
  fi
  osascript ~/Dropbox/macCommands/StyleTerm.scpt "$1"
}

on_exit () {
  set_bg Basic
}

case $HOSTNAME in
  "178.222.333.44 -p 2222") set_bg "Homebrew" ;;
  "178.222.333.44 -p 22") set_bg "Ocean" ;;
  "192.168.214.111") set_bg "Novel" ;;
  *) set_bg "Grass" ;;
esac

/usr/bin/ssh "$@" 
```

使其可执行：`chmod +x ~/bin/ssh`.

文件`~/Dropbox/macCommands/StyleTerm.scpt`有以下内容：

```
#https://superuser.com/a/209920/195425
on run argv
  tell application "Terminal" to set current settings of selected tab of front window to first settings set whose name is (item 1 of argv)
end run 
```

文字`Basic, Homebrew, Ocean, Novel, Grass`来自mac os终端设置`cmd``,`： [![终端型材](https://i.stack.imgur.com/YOhL7.png)](https://i.stack.imgur.com/YOhL7.png)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-01T14:44:45.147

您可以在 .bashrc 中设置 $PS1 变量。

```
red='\e[0;31m'
PS1="$\[${red}\]" 
```

编辑：为此打开终端。然后说

```
#touch .bashrc 
```

然后，您可以在 textEdit 或[TextWrangler](http://www.barebones.com/products/textwrangler/download.html)中打开 .bashrc并添加前面的命令。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-04-28T16:22:38.337

## 在服务器端设置终端颜色`/.bashrc`

我需要同样的东西，让我意识到我在一个暂存或生产服务器上，而不是在我的开发环境中，这很难说清楚，尤其是在 Ruby 控制台或其他东西中。

为此，我使用`setterm`服务器`~./bashrc`文件中的命令在连接时反转终端颜色，并在退出时恢复颜色。

### ~/.bashrc

```
# Inverts console colours so that we know that we are in a remote server. 
# This is very important to avoid running commands on the server by accident.
setterm --inversescreen on

# This ensures we restore the console colours after exiting.
function restore_screen_colours {
  setterm --inversescreen off
}
trap restore_screen_colours EXIT 
```

然后我把它放在所有服务器的`~/.bashrc`文件中，这样我就知道我的终端何时在远程服务器上。

另一个好处是，您的任何开发或 devops 团队都可以从中受益，而无需将其作为入职流程的一部分。

**效果很好。**

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-01T15:21:13.407

Xterm 兼容的 Unix 终端具有用于设置背景和前景色的标准转义序列。我不确定 Terminal.app 是否共享它们；它应该。

```
case $HOSTNAME in
    live1|live2|live3) echo -e '\e]11;1\a' ;;
    testing1|testing2) echo -e '\e]11;2\a' ;;
esac 
```

第二个数字指定所需的颜色。0=default, 1=red, 2=green 等等。所以这个片段，当放在一个共享的 .bashrc 中时，会给你实时服务器的红色背景和测试服务器的绿色背景。您还应该添加类似这样的内容以在您注销时重置背景。

```
on_exit () {
    echo -e '\e]11;0\a'
}
trap on_exit EXIT 
```

* * *

编辑：谷歌找到了一种[使用 AppleScript 设置背景颜色](http://www.athensexchange.com/blog/155)的方法。显然，这仅在与 Terminal.app 在同一台机器上运行时才有效。您可以使用几个包装函数来解决这个问题：

```
set_bg_color () {
    # color values are in '{R, G, B, A}' format, all 16-bit unsigned integers (0-65535)
    osascript -e "tell application \"Terminal\" to set background color of window 1 to $1"
}

sshl () {
    set_bg_color "{45000, 0, 0, 50000}"
    ssh "$@"
    set_bg_color "{0, 0, 0, 50000}"
} 
```

连接到实时服务器时，您需要记住运行 sshl 而不是 ssh。另一种选择是为 ssh 编写一个包装函数，该函数扫描其参数以查找已知的实时主机名并相应地设置背景。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-01T14:44:38.533

为什么不在通过 SSH 登录时更改 shell 提示？通常有特定的 shell 变量：**SSH_CLIENT**、**SSH_CONNECTION**、**SSH_TTY**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-13T23:36:52.613

您应该更改用户名和主机名称的颜色。

将以下行添加到您的`~/.bash_profile`文件中：

```
export PS1=" \[\033[34m\]\u@\h \[\033[33m\]\w\[\033[31m\]\[\033[00m\] $ " 
```

第一**部分**（紫色）是您要查找的内容。

**预览：** [![在此处输入图像描述](https://i.stack.imgur.com/a4enm.png)](https://i.stack.imgur.com/a4enm.png)

这是我喜欢的颜色。您可以通过更改作为 ANSI 颜色代码的`m`代码（例如）来自定义提示颜色的每个部分。`34m`

**ANSI 颜色代码列表：**

*   黑色：30m
*   红色：31m
*   绿色：32m
*   黄色：33m
*   蓝色：34m
*   紫色：35m
*   青色：36m
*   白色：37m

# sybase - Aqua Data Studio - 自动完成的快捷方式

> ID：157969
> 
> 赞同：1
> 
> 时间：2008-10-01T14:42:59.193
> 
> 标签：sybase

当 Aqua Data Studio 中显示自动完成列表框/下拉列表时，您必须按 Enter 键才能使当前突出显示的项目完成标识符。有没有办法我可以按 Tab 键来自动完成？这是 Visual Studio 的默认行为，我在 Aqua Data Studio 中找不到键盘快捷键编辑器。

如果 Home 和 End 键会转到行的开头或结尾而不是自动完成列表框的顶部或底部选项，那么如果自动完成列表框可见，那也很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-03T18:38:01.700

转到文件->选项->键映射。
选择您的活动键映射。
在 Keymap Settings 下，转到 General -> Query:Auto Complete 并选择它。
在快捷方式下，单击按钮编辑，您可以根据需要进行更改。

确保没有冲突。
![在此处输入图像描述](https://i.stack.imgur.com/TRtIs.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-21T20:05:22.260

查看“键绑定”/“热键”的首选项。***********