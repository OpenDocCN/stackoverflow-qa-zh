# StackOverflow 问答 11621000-11621999

# windows - Windows 上的 MonoDevelop gdb 调试器

> ID：11621010
> 
> 赞同：2
> 
> 时间：2012-07-23T21:44:21.217
> 
> 标签：windows, debugging, gdb, monodevelop, d

对不起我的英语不好。我开始学习 D 编程语言。唯一好的 IDE 是 MonoDevelop（mono-d 插件），但是我不明白如何在 Windows 上将 MonoDevelop 与 GDB（来自 MinGW）集成？

在 linux 上有方法：从 git 存储库下载并输入：./configure --select 在菜单中我们可以选择必要的组件（在这种情况下为 monodevelop-gdb-debugger）。

但我不知道，如何在 Windows 上构建 monodevelop 源代码。我不知道已经为此目的构建了插件。

我能做些什么？:(

# python - python 正则表达式否定前瞻断言

> ID：11621012
> 
> 赞同：0
> 
> 时间：2012-07-23T21:44:29.703
> 
> 标签：python, regex

我是一名 cs 新手，目前正在努力获得这样的 python 正则表达式模式：

```
it must contain "stop (at most 10 words inbetween) mail" and do not contain "mail stop". 
```

也就是说，

```
 "please stop the mail, and I want the mail stop" AND "please stop the mail stop" would be rejected. ("mail stop" pattern spotted)

  "please stop the mail" AND "please stop the mail, I want the mail to stop" both would be accepted.(only "stop ~ mail" pattern is seen, and no "mail stop") 
```

我目前拥有的是：

```
import re
pattern = re.compile("(?=(stop\s+(\w+\s+){0,10}mail[^\s]*))(?!mail\s+stop)")
print(pattern.search("please stop the mail, I want the mail to stop").group()) 
```

但不知何故，它不能按我想要的方式工作。

任何帮助，将不胜感激。

埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T01:03:10.657

假设您需要在匹配时返回整个输入字符串

```
>>> pattern = re.compile(".*stop\s+(\w+\s+){0,10}mail(?!(\s+stop|(.*mail stop))).*")
>>> print(pattern.search("please stop the mail, I want the mail to stop"))
<_sre.SRE_Match object at 0x15c43c0>
>>> print(pattern.search("please stop the mail stop"))
None
>>> print(pattern.search("please stop the mail, and I want the mail stop"))
None 
```

# android - 如何更改我的 KeyboardView 的充气机

> ID：11621014
> 
> 赞同：2
> 
> 时间：2012-07-23T21:44:43.817
> 
> 标签：android, ime, layout-inflater

我正在为 android 开发 IME。我可以选择为键盘设置主题。当我第二次尝试给keyboardView充气时出现问题，它不起作用

键盘视图 k = (KeyboardView) getLayoutInflater().inflate(R.layout.input1, null);

它只是在我重新运行应用程序时改变。

当我的 InputMethodeService 重新创建时，它似乎只是改变了，但我没有找到停止它并再次启动服务的方法。

请帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T03:45:35.680

我找到了解决我的问题的方法。

我真正的问题是多次膨胀同一个视图（ KeyboardView ）。

我试图将我的父视图从 KeyboardView 更改为 RelativeLayout，并且对于每个键盘视图主题，我删除所有父子视图，并添加新的键盘视图，并添加新的主题。

# python - Google Appengine 发送电子邮件：[错误] 未经授权的发件人

> ID：11621019
> 
> 赞同：13
> 
> 时间：2012-07-23T21:45:09.813
> 
> 标签：python, google-app-engine, email

我正在尝试在我的网站上使用谷歌应用引擎的邮件服务。每当我访问发送电子邮件的页面时，它都会显示一些错误。该错误表明我正在使用未经授权的发件人发送邮件。这是发送电子邮件的代码：

```
mail.send_mail(sender="myapp@appspot.gserviceaccount.com",
     to=input_dict["email"],
     subject="Mondays user activation",
     body=content) 
```

当我在本地（使用）试用该站点时，`dev_appserver.py`它不会显示错误，但不会发送电子邮件（注意：`--enable_sendmail`当我在本地尝试时，我必须添加该选项）。该错误仅在我发布网站时出现。

有人知道我做错了什么吗？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-23T22:06:40.007

myapp@appspot.gserviceaccount.com 是什么？您可能无法从该地址发送邮件。

> App Engine 应用程序可以代表应用程序的管理员以及拥有 Google 帐户的用户发送电子邮件。
> 
> 发件人的电子邮件地址，发件人地址。发件人地址必须是以下类型之一：
> 
> *   应用程序的注册管理员的地址。您可以使用管理控制台将管理员添加到应用程序。
>     
>     
> *   使用 Google 帐户登录的当前请求的用户地址。您可以使用用户 API 确定当前用户的电子邮件地址。用户的帐户必须是 Gmail 帐户，或者位于由 Google Apps 管理的域中。
>     
>     
> *   应用程序的任何有效电子邮件接收地址（例如 xxx@APP-ID.appspotmail.com）。
>     
>     
> *   域帐户的任何有效电子邮件接收地址，例如 support@example.com。域帐户是 Google 域之外的帐户，其电子邮件地址不以 @gmail.com 或 @APP-ID.appspotmail.com 结尾。

[https://developers.google.com/appengine/docs/python/mail/sendingmail](https://developers.google.com/appengine/docs/python/mail/sendingmail)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-01-21T19:13:24.273

首先按照这些步骤

[https://cloud.google.com/appengine/docs/python/mail/#who_can_send_mail](https://cloud.google.com/appengine/docs/python/mail/#who_can_send_mail)

然后您需要在云控制台中手动添加发件人电子邮件

[如何添加授权发件人](https://i.stack.imgur.com/XqHD1.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-05T23:00:23.013

您可能还必须将用于发送电子邮件的电子邮件地址添加到 App Engine 应用程序设置电子邮件 API 授权发件人。

请参阅[https://cloud.google.com/appengine/docs/python/mail/#Python_Sending_mail](https://cloud.google.com/appengine/docs/python/mail/#Python_Sending_mail)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-29T08:04:23.983

在此处将未经授权的电子邮件地址添加为管理员： [https ://console.developers.google.com/project/_/permissions/projectpermissions](https://console.developers.google.com/project/_/permissions/projectpermissions)

# apache - htaccess 重定向域和掩码 url

> ID：11621023
> 
> 赞同：2
> 
> 时间：2012-07-23T21:45:28.353
> 
> 标签：apache, .htaccess, redirect, dns, webserver

我想重定向一个域名： http: [//www.newdomain.com](http://www.newdomain.com)到[http://sub.maindomain.com](http://sub.maindomain.com)

我已将 .htaccess 编辑为：

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !sub.maindomain.com$ [NC]
RewriteRule ^(.*)$ http://sub.maindomain.com/$1 [L,R=301] 
```

它重定向但地址栏中的[http://sub.maindomain.com](http://sub.maindomain.com)可见。帮助！如何进行屏蔽以便[http://www.newdomain.com](http://www.newdomain.com)可见。谢谢

而且我还想创建一个子站点[http://sub.newdomain.com](http://sub.newdomain.com)。如何使用 .htaccess 来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:11:54.757

如果`www.newdomain.com`并且位于不同的主机上，则在浏览器的 URL 地址栏显示时获取要提供`sub.maindomain.com`的内容的唯一方法是*代表浏览器*从中获取内容。因为就浏览器而言，它正在查看 newdomain 上的内容。`sub.maindomain.com``www.newdomain.com``sub.maindomain.com`

 *您可以通过使用 apache 或脚本设置代理来做到这一点。使用 apache，您需要访问`www.newdomain.com`域的虚拟主机配置。您可以像这样设置它：

```
ProxyPassMatch ^(.*)$ http://sub.maindomain.com$1 
```

查看[mod_proxy 文档](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)以获取有关可以传递此指令的标志的更多信息，以调整超时和重试。

如果你想设置一个 php 脚本来代理，你需要将所有请求路由到这个 php 脚本，所以在你的`www.newdomain.com`文档根目录的 htaccess 文件中，添加（假设这个 php 脚本被调用`proxy.php`）：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/proxy.php
RewriteRule ^(.*)$ /proxy.php?url=$1 [L,QSA] 
```

然后在 中`proxy.php`，查找`url`查询字符串，加载该页面，并将其输出到浏览器。

尽管如果您可以将两个域都指向同一个主机，所有这一切都会容易得多。*

# javascript - 一旦 [ ] 被 < > 替换，文本将变为空白

> ID：11621025
> 
> 赞同：0
> 
> 时间：2012-07-23T21:45:55.853
> 
> 标签：javascript, jquery

我有以下代码

```
 $(document).ready(function () {
        $(".page").on('click', function () {
            $("#ctl00_MainContent_dfComments").html(function (i, val) {
                return val.replace(/\]/g, '>');
            });
        });

        $(".page").on('click', function () {
            $("#ctl00_MainContent_dfComments").text(function (i, val) {
                return val.replace(/\[/g, "<");
            });
        });

    }); 
```

[在整个文档 JQuery 中替换字符](https://stackoverflow.com/questions/11620038/replacing-characters-in-entire-document-jquery/11620269#comment15388479_11620269)的帮助下工作得非常好。但是，当插入 < 括号时，整个 div 变为空白。我可以用任何东西替换 [ ，但是只要我输入 < ，该 div 中的所有内容都会消失。知道会发生什么吗？

是的，这应该创建一个粗体（有点像 bb 解析器）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:03:59.757

您的第二个替换是使用`.text()`而不是`.html()`. 作为旁注，您还可以组合这两个事件处理程序。

```
$(document).ready(function () {
  $(".page").on('click', function () {
    $("#ctl00_MainContent_dfComments").html(function (i, val) {
      return val.replace(/\]/g, '>').replace(/\[/g, '<');
    });
  });
});​ 
```

这是在行动：http: [//jsfiddle.net/pbnDP/8/](http://jsfiddle.net/pbnDP/8/)

按下按钮使文本变为粗体。

主要帖子的评论中讨论了明显的安全问题。不要将它放在用户可以生成正在运行的内容的站点上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T21:49:11.300

看起来您可能没有以有效的 HTML 结束，并且呈现 html 的 DOM 正在为您处理任何无效的 HTML。

您的脚本存在一些问题 - 首先是它促进了危险的 html，您似乎没有对代码进行任何形式的理智或黑名单/白名单检查。

另一个问题是您手动命名 ASP.NET ID - 这很糟糕，因为它们可以更改。请改用 .ClientID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T21:49:23.567

```
 $(".page").on('click', function () {
        $("#ctl00_MainContent_dfComments").html(function (i, val) {
            return val.replace(/\[/g, "<");
        });
    }); 
```

.html 可能比文本效果更好，并且还使用类名或 clientid 来选择 John 在他的回答中建议的元素，这不好猜测浏览器会将 id 更改为什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T21:52:19.160

请再次检查您的 DOM，似乎浏览器检测到`<` `>`as html 标记或 html 无效。

**工作版本：http:** [//jsfiddle.net/pbnDP/](http://jsfiddle.net/pbnDP/)

我确实知道在包括 Ruby 在内的少数编程世界中，有一些东西叫做`html_safe`你可能想要与它一起使用。

希望能帮助到你。

# objective-c - 在运行时发现哪个类的实例变量被声明为 __weak

> ID：11621028
> 
> 赞同：8
> 
> 时间：2012-07-23T21:46:08.290
> 
> 标签：objective-c, cocoa-touch, cocoa, automatic-ref-counting

我正在编写一个工具，该工具将受益于知道声明了哪个类的实例变量`__weak`。

这些信息在运行时必须存在*于某个地方*，但是有没有办法访问它，记录在案或以其他方式？（它是一个工具，所以我不太关心它是否会因更新而中断）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T22:49:31.340

好的，这是一个示例实现，使用自定义对象实现，它会进行基本检查以查看 iVar 是否弱：

```
BOOL iVarIsWeak(Class cls, Ivar ivar)
{
    id classInstance = [cls new];

    // our custom base class properly tracks reference counting, no weird voodoo
    id refCounter = [CustomBaseClass new];

    object_setIvar(classInstance, ivar, refCounter);

    if ([refCounter refCount] == 2)
    {
        return NO;
    }

    return YES;
} 
```

上面的代码是在启用 ARC 的情况下使用的，而下面的自定义目标代码不是：

```
@interface CustomBaseClass : NSObject

+(id) new;
+(id) alloc;
-(id) init;

-(id) retain;
-(void) release;
-(id) autorelease;
-(void) dealloc;

-(id) description;

-(unsigned) refCount;

@end

// easy way to get sizeof
struct CustomBaseClassAsStruct {
    voidPtr isa;
    unsigned volatile refcount;
};

@implementation CustomBaseClass
{
    unsigned volatile  refcount;
}

+(id) new
{
    return [[self alloc] init];
}

+(id) alloc
{
    struct CustomBaseClassAsStruct *results =  malloc(sizeof(struct CustomBaseClassAsStruct));
    results->isa = self;
    results->refcount = 0;
    return (id) results;
}

-(id) init
{
    [self retain];

    return self;
}

-(id) retain
{
    ++refcount;

    return self;
}

-(void) release
{
    if (--refcount == 0)
        [self dealloc];
}

-(id) autorelease
{
    // sample implementation of autorelease
    dispatch_async(dispatch_get_current_queue(), ^{
        [self release];
    });

    return self;
}

-(unsigned) refCount
{
    return refcount;
}

-(void) dealloc
{
    free(self);

    // no call to [super dealloc], we are using custom memory-managment
}

@end 
```

这仅适用于弱 iVar。使用`unsafe_unretained`变量，它会给出误报，我对此的最佳猜测是因为`__weak`信息是在运行时保存的，而`unsafe_unretained`信息不是。

我希望这有帮助！

# php - PHP 重置 mysqli_result

> ID：11621029
> 
> 赞同：0
> 
> 时间：2012-07-23T21:46:08.473
> 
> 标签：php, mysqli, reset

这是我第一次发布到堆栈溢出，我希望有人可以帮助我找出我做错了什么。我有以下代码在重置 $row 数组时遇到问题。这是一个嵌套循环， $row 第一次工作，然后在其他循环上是空白的......有什么想法吗？

```
/**Setup local variables with passed data**/
$ing = $this->getVariable('ingredients');
$row = $this->getVariable('unitdrop');
$unit= $this->getVariable('unit');

/**Start Displaying data**/
if (!$ing) {print("No ing");}
else
{while ($i = $ing->fetch_array())
{
/**Display $ing Data**/
    if (!$row) {print("No data row");}
    else
    {while($p = $row->fetch_array())
        {
        /**Display $row Data**/
        } 
    }
reset($row); // <-- Does not reset $row to first record
} 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T21:51:40.093

`reset`重置一个数组。**$row**`mysqli`在您的情况下是类的对象。[请改用mysqli::data_seek](http://cz.php.net/manual/en/mysqli-stmt.data-seek.php)方法（请参阅链接中的示例）。`$row->data_seek(0);`我猜应该是。

# iphone - UIView 层次结构

> ID：11621033
> 
> 赞同：0
> 
> 时间：2012-07-23T21:46:15.867
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我只是好奇我是否有一个 webview，我想在它上面设置另一个自定义 uiview。

所以基本上我有一个窗口，我有两个视图：

|--视图1--| |--网络视图|

如何根据层次结构方式的窗口设置这些视图？所以一个视图并位于另一个视图之上？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T21:50:58.270

您可以在 webview 顶部添加 uiview。只需为 otherview 设置框架，然后添加它。

```
otherView.frame = CGRectMake(0, 430, webView.frame.size.width, 50);
[webview addSubview:otherview]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T21:50:28.343

从类中的`subviews`文档中`UIView`：“数组中子视图的顺序反映了它们在屏幕上的可见顺序，索引 0 处的视图是最后面的视图。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T22:00:02.957

您可以更改当前添加的 UIViews 的顺序，您可以使用一些方法以编程方式控制层次结构，例如：

*   添加子视图：
*   **将SubviewToFront：**
*   **发送子视图返回：**
*   removeFromSuperview
*   插入子视图：atIndex：
*   插入子视图：上方子视图：
*   插入子视图：下面子视图：
*   exchangeSubviewAtIndex:withSubviewAtIndex:
*   isDescendantOfView：

特别注意粗体的方法，似乎正是你要找的。[还可以在这里](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)查看苹果 UIView 文档。

拜拜！。

# javascript - 为已初始化的自定义 jQuery 插件的属性实例调用 clearInterval

> ID：11621034
> 
> 赞同：0
> 
> 时间：2012-07-23T21:46:25.663
> 
> 标签：javascript, jquery

我已经编写了许多 js 脚本和 jQuery 插件，所以这里有一个浓缩的伪代码场景来解决我的困境。

假设我们有一个编写良好的 jQuery 插件，定义了一个方法对象以传递给我们的插件。

```
// OUR HYPOTHETICAL jQUERY PLUGIN
(function($){

var methods = {
    init : function(options){
        var setup = $.extend({
            'speed' : 300,
            'msg' : 'blah'
        }, options)

        return this.each(function(){
            var animation = setInterval(function(){ ... },1000)
            ...
        })

    },
    stop : function(){
        window.clearInterval(animation); // DOES NOT WORK
    }
};

$.fn.somePlugin = function(method){
     // Method calling logic
        if ( methods[method] ) {
          return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof method === 'object' || ! method ) {
          return methods.init.apply( this, arguments );
        } else {
            $.error( 'Bad Method...' );
        }   
};

})(jQuery) 
```

让我们想象将这个插件实例化为一个 div`$('#someDiv').somePlugin();`

到目前为止一切正常，我可以打电话给... `$('#someDiv').somePlugin('stop');`

但是，**stop**方法的内部无法弄清楚如何访问在插件初始化期间创建的动画属性的实例。

关于如何获取与绑定到**#someDiv的插件关联的****动画**变量的特定实例的任何想法。

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T21:48:51.547

This is not working because the animation var is local. Use the animation (one array) var as a plugin property, so it will be local to the plugin instance. I think that using this approach you will achieve what you need.

One example:

**HTML:**

```
<button id="btnStart"/>Start</button>
<button id="btnStop"/>Stop</button> 
```

**JavaScript:**

```
var obj = {
    size: 5,
    animationsId: [],
    start: function() {
        for ( var i = 0; i < this.size; i++ ) {
            this.animationsId[i] = setInterval( function() {
                console.log( "aaa" );
            }, 500 );
        }
    },
    stop: function() {
        for ( var i = 0; i < this.size; i++ ) {
            clearInterval( this.animationsId[i] );
        }
    }
};

$( "#btnStart" ).click(function(){
    obj.start();
});

$( "#btnStop" ).click(function(){
    obj.stop();
}); 
```

jsFiddle: [http://jsfiddle.net/davidbuzatto/3fDHF/](http://jsfiddle.net/davidbuzatto/3fDHF/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T21:53:48.890

您可以将间隔标记存储在每个元素的数据中。例如...

```
var animation = setInterval(function(){ ... },1000)
$(this).data('somePlugin', {animationInterval: animation}); 
```

然后稍后您可以访问它以获取特定元素...

```
window.clearInterval($(this).data('somePlugin').animationInterval); 
```**

# ruby-on-rails - 抑制 IRB 输出？

> ID：11621037
> 
> 赞同：8
> 
> 时间：2012-07-23T21:46:40.080
> 
> 标签：ruby-on-rails, ruby, irb

> **可能重复：**
> [Rails 控制台，如何停止输出返回值？](https://stackoverflow.com/questions/10150541/rails-console-how-to-stop-output-of-return-value)

考虑 IRB 中的这个会话：

```
>> for a in 1..5 do
?>     puts a
>> end
1
2
3
4
5
=> 1..5
>> 
```

如何抑制输出`=> 1..5`？如果我在 Rails 控制台会话中执行此操作，这一点很重要：

```
for post in Post.find(:all) do
    if post.submit_time > Time.now
        puts "Corrupted post #{post.id} is from the future"
    end
end 
```

我不希望所有帖子最后都打印为数组。如何抑制该输出？

我确信还有其他方法可以做到这一点，比如`find_each`Ruby 脚本，但我更感兴趣的是在交互式会话中这样做。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-23T21:50:04.867

只需添加`nil`到命令的末尾。它不会杀死 irb 的响应线，但如果你有一些大物体，它会避免炸毁你的屏幕。

```
1.9.3p194 :036 > for a in 1..5 do; puts a; end; nil
1
2
3
4
5
 => nil 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-23T21:50:53.417

这是核心 IRB 功能。你输入一个表达式，它会打印它的值。在这种情况下，值为`1..5`。其他输出只是副作用。

但是，您可以“最小化”返回（和打印）的值。因此，您可以返回一些小的东西，而不是大量的胖 AR 模型。

尝试这样的事情：

```
% irb
1.9.3p194 :001 > for a in 1..5 do
1.9.3p194 :002 >     puts a
1.9.3p194 :003?>   end; nil
1
2
3
4
5
 => nil 
```

# c++ - 我应该如何在 C++ 的类方法中正确使用 __attribute__ ((format (printf, x, y)))？

> ID：11621043
> 
> 赞同：34
> 
> 时间：2012-07-23T21:46:55.423
> 
> 标签：c++, gcc, printf, string-formatting

我正在尝试为调试打印定义一个类方法，其行为类似于`printf`：

```
inline void debug(const char* fmt, ...) __attribute__ ((format (printf, 1, 2))) 
```

这抱怨：

```
error: format string argument not a string type 
```

想起一个类方法声明有一个隐式`this`参数，所以我把参数的位置改成了2、3：

```
inline void debug(const char* fmt, ...) __attribute__ ((format (printf, 2, 3))) 
```

现在它编译了，但看起来参数被移动了，好像`this`参数被视为参数列表的一部分。

如何判断`this`不是我要打印的字符串的一部分的函数？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-23T21:53:10.563

你已经做到了。 `this`是参数 1，所以通过说`format(printf, 2, 3)`您告诉编译器您没有打印`this`，您正在打印参数 2 ( `fmt`) 以及除此之外的其他参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-16T16:19:52.653

将静态成员视为与非成员相同。讨论给了我答案，但对于其他人来说值得注意：

*   非成员函数使用 1,2
*   **静态**成员函数使用 1,2
*   **非静态**成员函数将 'this' 视为 #1，因此需要 2,3

我发现这是因为我们有一些使用这样的日志帮助程序的进程，并且 4 个中的 1 个需要`__attribute__ (( format( printf, 2, 3 ) ))`与其他三个工作得很好`__attribute__ (( format(printf, 1, 2) ))`- 结果证明它是非静态的......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-09T02:11:18.870

由于它仅适用于 gcc，因此最好以这种方式定义它以避免其他编译器出错。

```
#ifdef __GNUC__
          __attribute__ (( format( printf, 2, 3 ) ))
#endif 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-01-15T01:16:25.497

[@Chris Dodd 是正确的](https://stackoverflow.com/a/11621112/4561887)。这是支持它的最新 gcc 文档（感谢[Foxit 阅读器](https://www.foxitsoftware.com/pdf-reader/)让我在 Linux 上标记 PDF）。特别注意下图中绿色标记的部分。

> 由于非静态 C++ 方法有一个隐含的 this 参数，因此在为 和 赋值时，此类方法的参数应该从2**开始**计算，而不是从 1 开始。`string-index``first-to-check`

**来源**：[https](https://gcc.gnu.org/onlinedocs/gcc-8.2.0/gcc/Common-Function-Attributes.html#Common-Function-Attributes) ://gcc.gnu.org/onlinedocs/gcc-8.2.0/gcc/Common-Function-Attributes.html#Common-Function-Attributes （参见标题为“格式（原型，字符串索引，第一-去检查）”）。

**图像**（尤其是绿色突出显示）：

[![在此处输入图像描述](../Images/92cc6a1d55b545c1643c7f221252e9cd.png)](https://i.stack.imgur.com/Je68i.png)

# android - 在另一个类中初始化视图

> ID：11621045
> 
> 赞同：1
> 
> 时间：2012-07-23T21:47:02.497
> 
> 标签：android, views, declaration

我无法在 Android 中初始化我的控件。在我的应用程序中，我将拥有可用或将在不同活动中使用的按钮，并且所有按钮都执行相同的功能，即导航到另一个活动。我想公开声明我的控件，这样我就不会在我的课程中重复声明它们。假设我想将下面的代码放入一个单独的类中，然后在需要初始化控件时调用该函数。

```
InitControls():

TextView text1;
Button button1;
text1 = (TextView)FindViewById(R.id.TextView1);
button1 = (Button)FindViewById(R.id.Button1);

text1.setText("Hello WOrld!"); 
```

如何将该代码放入一个函数中，然后像这样在我的活动中调用它？

```
InitControls(); //or something 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:33:39.413

将 InitControls 调用放在继承自 Activity 的基类中，然后在您的活动中扩展此类并在 onCreate? 中调用 InitControls？

# javascript - 提交折叠div并从div更改图像后的Ajax表单

> ID：11621046
> 
> 赞同：0
> 
> 时间：2012-07-23T21:47:05.183
> 
> 标签：javascript, jquery, forms

所以，我有一个带有背景图像（信封）的表格。提交后，我想留在同一页面上并折叠包含表单的部分 div 并仅显示一张带有谢谢 bla bla 的图像。如何做到这种平滑的折叠和替换？如果有人有一些想法或链接，我将不胜感激。

```
<script type="text/javascript"> 
    $(document).ready(function() { 
        $("#form1").submit(function(){
            $("#formplic").html("<img src='images/thanks.png'/>");
        });
    }); 
</script> 

<div id="formplic"><img src="images/form.png"/></div>

<form id="form1" action="send.php" onSubmit="return chkForm(this)" name="form1" method="post" >
    <textarea name="message" cols="4" rows="4"  id="message" value=""></textarea>
    <input type="text"  id="name" name="name" value="" />
    <input type="text"  id="email" name="email" value="" />    
    <input type="submit" value="" id="submit" />
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T21:49:50.533

一些褪色的东西怎么样？

```
$(document).ready(function() { 
    $("#form1").submit(function(){
        $("#formplic").fadeOut(1000, function() {
             $(this).html("<img src='images/thanks.png'/>").fadeIn(1000);
        });
    });
}); 
```

或滑动的东西？

```
$(document).ready(function() { 
    $("#form1").submit(function(){
        $("#formplic").slideUp(1000, function() {
             $(this).html("<img src='images/thanks.png'/>").slideDown(1000);
        });
    });
}); 
```

稍微搜索一下，这种事情应该很简单！

# c# - 将 log4net 文件路径设置为自定义路径

> ID：11621047
> 
> 赞同：0
> 
> 时间：2012-07-23T21:47:16.653
> 
> 标签：c#, asp.net, log4net

我需要将日志文件路径更改为自定义路径。

我有一个代码，它在 wwwroot 文件夹中生成文件。

```
 public static ILog logger = LogManager.GetLogger(MethodBase.GetCurrentMethod().DeclaringType);

    protected void Application_Start(object sender, EventArgs e)
    {
        log4net.Config.XmlConfigurator.Configure();

        FileAppender rootAppender = (FileAppender)((log4net.Repository.Hierarchy.Hierarchy)LogManager.GetRepository()).Root.Appenders[0];           
        string filename = rootAppender.File;
        Global.logger.Error("Log 4 net filename: " + filename);         
    } 
```

请有人帮我解决这个问题。

谢谢

这就是我的配置文件中的内容。

```
 <!-- Log file locaation -->
<param name='File' value='TS_GUI_Logs.coplog'/>
<param name='AppendToFile' value='true'/> 
```

我不想在配置中设置文件名。相反，我想从我的代码后面设置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T21:53:11.093

你检查过你的配置文件吗？此代码从配置文件中读取文件名。

如果您需要所有内容的自定义路径，请更改配置文件中的路径。（只要确保你知道你的代码中的所有消费者是谁。）如果你需要一个自定义路径来做一件事，你需要创建一个新的 FileAppender。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-15T06:37:14.393

你可以有这样的 log4net 配置：

```
<log4net debug="true">
  <appender name="LogFileAppender" type="log4net.Appender.FileAppender">
    <file type="log4net.Util.PatternString" value="%property{LogFileName}" /> 
```

应用程序启动代码将如下所示：

```
 log4net.GlobalContext.Properties["LogFileName"] = "C:\\aaaaa.log";
    log4net.Config.XmlConfigurator.Configure(); 
```

# shopify - 为商店开发照片处理功能

> ID：11621049
> 
> 赞同：1
> 
> 时间：2012-07-23T21:47:21.750
> 
> 标签：shopify

拥有 Shopify 网站的客户要求我开发功能，允许客户上传图像，然后可以在服务器级别调整大小和裁剪并放入 PDF 文件以供下载。

我们计划结合使用 PHP 脚本和库来开发此功能：

用于 PDF 生成的 GD 或 ImageMagick PHP 扩展 tcpdf 库

我的问题是，鉴于我们正在使用 PHP 开发，这样的东西是否可以直接集成到 Shopify 网站中，如果可以，实现这种集成的最佳方法是什么？

他们希望图像上传/裁剪功能成为网站的一个单独部分，并且不需要将其集成到用户界面中以查看产品——我希望这能简化一些事情。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T21:12:41.120

我不认为有什么能阻止你做到这一点。您可以构建一个 Shopify 应用程序，它可以是一个[应用程序代理](http://www.shopify.com/technology/4627062-application-proxies-the-new-hotness)，看起来像是无缝集成。它将处理图像的上传请求和裁剪/调整大小。

您可以处理数据的存储位置，或使用[Asset API](http://api.shopify.com/asset.html)。

如果需要，有一个[shopify.php 适配器](https://github.com/sandeepshetty/shopify.php)可以与 API 交互，但除非我误解了要求，否则似乎没有很多集成需要读取/写入 Shopify 数据。似乎只需要在网站上向用户呈现图像上传功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T21:19:39.440

关于如何集成它，您有几个选择。

最简单的方法是在“谢谢”页面上嵌入一个上传表单（指向您的服务器）。您可以访问那里的订单号和一些客户字段，以便将其与上传的图像相关联。查看 Shopify 常见问题页面，例如如何执行此操作：http: [//support.shopify.com/customer/portal/articles/236555-how-do-i-let-my-customers-upload-a-file-按他们的顺序-](http://support.shopify.com/customer/portal/articles/236555-how-do-i-let-my-customers-upload-a-file-with-their-order-)

另一种方法是将表单嵌入到购物车页面。不过，获取订单号有点棘手。您需要做的是通过将购物车令牌添加为表单中的隐藏字段来[跟踪它，并通过](http://wiki.shopify.com/Tracking_Carts)[订单通知 webhook](http://wiki.shopify.com/WebHooks)捕获它。考虑一下，您可能也可以跟踪 IP 地址。

一旦您弄清楚如何将订单与图像关联起来，您就可以在 Shopify 管理员订单页面中提供一个方便的链接，该链接会将它们发送到您的网站以裁剪图像等。这是在应用程序设置页面上配置的。

# apache - 在没有 ServerName 的默认虚拟主机上将 HTTP 重定向到 HTTPS

> ID：11621053
> 
> 赞同：80
> 
> 时间：2012-07-23T21:47:52.950
> 
> 标签：apache, http, redirect, https

在我的 apache 服务器上，我希望能够将所有传入的 http 请求重定向到等效的 https 请求。问题是我希望能够为我的默认虚拟主机执行此操作，而无需指定，`ServerName`并且重定向与请求 url 中出现的任何服务器名称一起工作。我希望这样的事情：

```
NameVirtualHost *:80
<VirtualHost *:80>
    RedirectPermanent / https://%{SERVER_NAME}/
    ...
</VirtualHost> 
```

这可能使用`Redirect`还是我必须求助于`Rewrite`？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2012-07-23T21:59:09.703

尝试将其添加到您的虚拟主机配置中：

```
RewriteEngine On
RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2015-01-16T03:30:04.797

两者都工作正常。但是根据[Apache 文档](http://httpd.apache.org/docs/2.4/rewrite/avoid.html)，您应该避免使用[`mod_rewrite`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)简单的重定向，[`Redirect`](https://httpd.apache.org/docs/current/mod/mod_alias.html#redirect)而是使用。因此，根据他们的说法，您最好这样做：

```
<VirtualHost *:80>
    ServerName www.example.com
    Redirect / https://www.example.com/
</VirtualHost>

<VirtualHost *:443>
    ServerName www.example.com
    # ... SSL configuration goes here
</VirtualHost> 
```

`/`之后的第一`Redirect`部分是 url，第二部分是应该重定向的位置。

您还可以使用它将 URL 重定向到子域： `Redirect /one/ http://one.example.com/`

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-07-28T14:11:49.297

这也是省略不需要的重定向的完整方法；）

这些规则旨在用于 .htaccess 文件，因为 *:80 VirtualHost 条目中的 RewriteRule 不需要任何条件。

```
RewriteEngine on
RewriteCond %{HTTPS} off [OR] 
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^/(.*) https://%{HTTP_HOST}/$1 [NC,R=301,L] 
```

**解释**：

```
RewriteEngine on 
```

==> 完全启用引擎

```
RewriteCond %{HTTPS} off [OR] 
```

==> 匹配**非 https**连接，或者（不设置 [OR] 会导致隐式 AND ！）

```
RewriteCond %{HTTP:X-Forwarded-Proto} !https 
```

**==> 在没有**https的情况下匹配转发连接（代理、负载均衡器等）

```
RewriteRule ^/(.*) https://%{HTTP_HOST}/$1 [NC,R=301,L] 
```

==> 如果两个条件之一匹配，则重写整个 URL，发送 301 让客户端“学习”（有些可以，有些不可以），最后一条规则是 L。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-26T17:07:37.520

我已经使用[mkcert](https://github.com/FiloSottile/mkcert/releases)创建了具有有效 HTTPS/SSL 证书的无限 *.dev.net 子域和本地主机（Windows 10 [XAMPP](https://www.apachefriends.org/download.html)和 Linux Debian 10 Apache2）

我使用 mkcert v1.4.0 在 Windows 上创建证书（以管理员身份执行 CMD）：

```
mkcert -install
mkcert localhost "*.dev.net" 
```

这将在 Windows 10 中创建此文件（我将首先在 Windows 10 XAMPP 中安装它）

```
localhost+1.pem
localhost+1-key.pem 
```

覆盖 XAMPP 默认证书：

```
copy "localhost+1.pem" C:\xampp\apache\conf\ssl.crt\server.crt
copy "localhost+1-key.pem"  C:\xampp\apache\conf\ssl.key\server.key 
```

现在，在 Apache2 for Debian 10 中，激活 SSL 和 vhost_alias

```
a2enmod vhosts_alias
a2enmod ssl
a2ensite default-ssl
systemctl restart apache2 
```

对于 vhost_alias 添加这个 Apache2 配置：

```
nano /etc/apache2/sites-available/999-vhosts_alias.conf 
```

有了这个内容：

```
<VirtualHost *:80>
   UseCanonicalName Off
   ServerAlias *.dev.net
   VirtualDocumentRoot "/var/www/html/%0/"
</VirtualHost> 
```

添加站点：

```
a2ensite 999-vhosts_alias 
```

通过 SSH 将证书复制到 /root/mkcert 并覆盖 Debian 证书：

```
systemctl stop apache2

mv /etc/ssl/certs/ssl-cert-snakeoil.pem /etc/ssl/certs/ssl-cert-snakeoil.pem.bak
mv /etc/ssl/private/ssl-cert-snakeoil.key /etc/ssl/private/ssl-cert-snakeoil.key.bak

cp "localhost+1.pem" /etc/ssl/certs/ssl-cert-snakeoil.pem
cp "localhost+1-key.pem" /etc/ssl/private/ssl-cert-snakeoil.key

chown root:ssl-cert /etc/ssl/private/ssl-cert-snakeoil.key
chmod 640 /etc/ssl/private/ssl-cert-snakeoil.key

systemctl start apache2 
```

编辑 SSL 配置

```
nano /etc/apache2/sites-enabled/default-ssl.conf 
```

在开始时使用以下内容编辑文件：

```
<IfModule mod_ssl.c>
    <VirtualHost *:443>

            UseCanonicalName Off
            ServerAlias *.dev.net
            ServerAdmin webmaster@localhost

            # DocumentRoot /var/www/html/
            VirtualDocumentRoot /var/www/html/%0/ 
```

...

上次重启：

```
systemctl restart apache2 
```

注意：不要忘记在 /var/www/html/ 中为您的子域创建文件夹

```
/var/www/html/subdomain1.dev.net
/var/www/html/subdomain2.dev.net
/var/www/html/subdomain3.dev.net 
```

# c# - 在linq select语句中使用func选择匿名类型的值

> ID：11621062
> 
> 赞同：2
> 
> 时间：2012-07-23T21:48:41.557
> 
> 标签：c#, linq, entity-framework

我有一个泛型类型类过滤器，它需要一些 lambda 表达式来从类型中选择值，以便该类可重用。该类在另一个通用类型类 Search 中使用，它将使用 Filter 选择最终将在下拉列表中使用的类型的不同项目。

我删除了这些不重要的代码。

```
public class Filter<T>
{
   public string Name;
   public Func<T, string> Key;
   public Func<T, string> Value;
}

public class Search<T>
{
   MyDBContext db = new MyDBContext();
   IQueryable<T> Model = db.Stuff.OrderBy(a => a.TermID);
   Filter filter = new Filter(
      Name: "Term",
      Value: a => a.TermID.ToString(),
      Key: a => a.Term.TermType.Name
   );

   var filterItems = Model
      .Select(a => new { Key = filter.Key(a), Value = filter.Value(a)})
      .OrderBy(t => t.Key)
      .Distinct()
      .ToArray();
} 
```

我收到运行时错误：`The LINQ expression node type 'Invoke' is not supported in LINQ to Entities.` 我尝试使用强类型而不是匿名类型，并`Expression<Func<T,string>>`在过滤器中使用。

经过数小时的搜索和尝试不同的事情，我不知道如何使这项工作。感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:53:05.677

您的问题可以更简单地表达，例如，它重现了它：

```
Func<SomeClass, int> x = t => t.ID;
var y = db.SomeClasses.Select(c => x(c)).ToArray(); 
```

它编译得很好，但在运行时会出现相同的错误，因为您正在调用已*编译*的函数。该部分“t => t.ID”是编译代码（至少对 IL），linq 无法读取它以将其转换为 SQL。它只能将表达式树转换为 SQL。上述情况的解决方案相当简单，我不确定这将如何转化为您的情况，但应该是可能的。

```
Expression<Func<SomeClass, int>> x = t => t.ID;
var y = db.SomeClasses.Select(x).ToArray(); 
```

还可以选择将函数调用移动到 linq 到对象中，这样就不需要将其转换为 sql（在客户端处理“AsEnumerable”之后的所有内容）。这使得可以在函数中放置的内容具有更大的灵活性，并将消除您遇到的错误类型。这也将消除调用 SqlFunctions 的需要（见下文）。缺点是从服务器返回的行可能比需要的多。

```
Func<SomeClass, int> x = t => t.ID;
var y = db.SomeClasses.AsEnumerable().Select(c => x(c)).ToArray(); 
```

您的最后一个问题是 EF 不喜欢 ToString 方法，您将需要使用相当糟糕的 SqlFunctions.StringConvert 。请参见此处：[实体框架中的 int 到字符串](https://stackoverflow.com/questions/4502842/int-to-string-in-entity-framework)

# css - Joomla 子菜单没有出现

> ID：11621073
> 
> 赞同：0
> 
> 时间：2012-07-23T21:49:39.420
> 
> 标签：css, drop-down-menu, joomla, joomla3.0

我花了一些时间遇到这个问题，所以我想我会分享解决方案。

使用 Joomla 的站点菜单创建器或其他插件来创建菜单，当我使用父项时，它们不会下拉或出现。

我已经使用 Chrome 的 Inspect 元素来查看链接是否也存在，但它没有，那为什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T21:49:39.420

这很容易解决，转到管理员主页，单击扩展 > 模块管理器 > 正确的菜单模块（它会在某处）

然后在该模块的选项屏幕上确保将“始终显示子菜单”选择为是 - 注意默认情况下它是关闭的！

# linux - Shell - Using an environment variable with ccrypt

> ID：11621075
> 
> 赞同：0
> 
> 时间：2012-07-23T21:49:43.293
> 
> 标签：linux, bash, shell

I am having problems using a program called ['ccrypt'](http://ccrypt.sourceforge.net/) which is used to encrypt files. The way in which I am using it is as follows:

```
ccrypt -e -E $cryptograph `find . -type f | sed -n -e '$i{p;q}'` 
```

where `-e` means that the program is running in encrypt mode. My problem is as follows:

The manual for the command says that `-E` is used to read the passphrase for the encryption from an environment variable using this syntax:

```
-E var 
```

and as such I have set it to be the passphrase I want as below:

```
cryptograph="Example_passphrase" 
```

However, when I run the code as shown above, an error message appears as follows:

> ccrypt: environment variable Example_passphrase does not exist.

Does anybody have any idea what I am doing wrong?

EDIT: Thanks for the answers, exporting the variable and removing the "$" worked but now I face a new problem:

```
"sed -n -e '$i{p;q}'" 
```

The shell says:

> ccrypt: {p;q}: No such file or directory

However, if I exchange $i for a number then the program works to an extent. What is the correct syntax for using the variable 'i' here?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:06:30.973

不要忘记导出环境变量（直到导出，它只是一个变量，而不是环境变量）。

```
export cryptograph="Example_passphrase"
ccrypt -e -E cryptograph `find . -type f | sed -n -e '$i{p;q}'` 
```

仅指定名称至关重要（否`$`）。否则，变量的值——密码本身——在命令行参数中并且对`ps`等可见。我们可以讨论环境是否安全（想想`/proc`文件系统），但它比包含密码本身要好几个步骤在命令行上。

* * *

从评论看来，您最好执行以下操作：

```
find . -type f -exec ccrypt -e -E cryptograph {} ';' 
```

这样做的一个主要优点是它回避了文件名中的空格和其他奇数字符的所有问题。如果该`ccrypt`命令接受多个文件，您可能可以将引号替换为`';'`（`+`不需要引号），并且单个命令将加密所有文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T21:51:14.117

Just use the name of the variable as the argument, not its value:

```
ccrypt -e -E cryptograph `...` 
```

# python - raw_input() won't show prompt until after input

> ID：11621082
> 
> 赞同：0
> 
> 时间：2012-07-23T21:50:06.210
> 
> 标签：python, python-2.7, raw-input

It actually goes further than the title suggests, if I have raw_input() anywhere in main, nothing will happen until the input has been entered by the user including any function calls or outputs that should occur before raw_input is called. Here's a very simple example of my code and what occurs when it's run.

```
def main():
    answer = raw_input('Continue?')
    print 'You said: ', answer 
```

When I run it: (nothing comes on screen)

(user input)

```
blah blah blah 
```

(Output):

```
Continue?You said: blah blah blah 
```

I apologize if this is some sort of absurdly simple fix, but I've searched quite a bit and not been able to find anything. I'm running Windows 7 64 bit with Python 2.7 if that has anything to do with it. Also, identical code works perfectly in the interpreter which is kind of weird. If you guys can figure this out, that would be great!

Thanks, Will

Edit: Just tried to work around by using `sys.stdin.readline()` but had the same issue.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:11:57.293

看起来这是一个缓冲问题。我通过输入'-u'命令解决了它。

# scala - Scala：导入对象 Foo._ 和 trait Bar 的简写

> ID：11621083
> 
> 赞同：7
> 
> 时间：2012-07-23T21:50:16.443
> 
> 标签：scala, object, import, traits

有一个反复出现的情况，我知道，但我想巩固以下内容：

```
import com.company.model.FooDAO
import com.company.model.FooForm._ 
```

变成类似的东西：

```
import com.company.model.{FooDAO, FooForm._} 
```

但是，上面的 1-liner 无法编译。

我管理过的最好的是：

```
import com.company.model.FooDAO, com.company.model.FooForm._ 
```

Scala 是 Scala，我认为上面的紧凑形式是可能的......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-23T22:01:00.103

你可以这样写：

```
import com.company.model.{FooDAO, FooForm}, FooForm._ 
```

# java - Data is not being inserted into HSQLDB database using Hibernate

> ID：11621086
> 
> 赞同：3
> 
> 时间：2012-07-23T21:50:31.167
> 
> 标签：java, database, hibernate, hsqldb

I took care of commiting transaction, but database remains empty after saving object. No errors, hibernate even shows SQL command of inserting. Everything is ok when I add `<property name="hibernate.connection.autocommit">true</property>` line to my hibernate config xml, but I heard that this is not a good practice. I'm using HSQLDB database.

Here's piece of my code that inserts data.

```
 Session session = HibernateUtil.getSessionFactory().getCurrentSession();
    session.beginTransaction();
    Client c = new Client();
    c.setImie("John");
    c.setNazwisko("Kennedy"); 
    session.save(c);
    session.getTransaction().commit();
    session.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:15:47.297

其中一些可以在某些情况下自动发生，但除非您配置为自动执行它们，否则您需要按以下顺序执行所有三个：

1.  `Session.save()`从 JVM 内部更新 Hibernate 的对象视图。
2.  `Session.flush()`通过发出 SQL 语句更新数据库的对象视图。
3.  `Session.getTransaction().commit()`提交数据库中的事务。

见[http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/Session.html#flush](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/Session.html#flush) ()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:36:51.757

在提交到数据库 ( ) 之前，您可能忘记使用**session.flush()**`session.getTransaction().commit()`将对象保存到数据库中。正如 Hibernate 参考本身所说：

> 强制此会话刷新。必须在工作单元结束时调用，在提交事务和关闭会话之前（取决于刷新模式，Transaction.commit() 调用此方法）。

并且：

> “刷新是将底层持久存储与内存中保存的持久状态同步的过程。”

**编辑：**

在阅读了一些关于 HSQLDB 的内容后，我看到了一些可能发生在你身上的事情：

1 - 因为 HSQLDB 默认不是**Durable**（'ACID' 中的 D），它不会立即将数据持久化到磁盘。我知道。没那么可爱。因此，当最后一个连接完成时，您必须“强制”写入您的更改，设置属性`shutdown=true`；从用户指南：

> 您可以使用 shutdown=true 连接属性来确保数据库在连接关闭后完全持久化。

2 - 要使您的更改立即写入磁盘，请使用该属性`hsqldb.write_delay=false`；

所以，你最终会在你的连接字符串中得到这样的东西：

```
;shutdown=true;hsqldb.write_delay=false; 
```

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T17:33:33.533

我的问题的解决方案在此线程[链接的问题下的第一条评论中进行了描述](https://stackoverflow.com/questions/8105618/entitymanager-does-not-write-to-database)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-30T20:15:26.260

通过代码进行更改时，有时添加`;shutdown=true`到您的连接字符串并没有帮助。

因此，每次您通过 HSQLDB 中的代码进行更改（插入、删除、更新等）时，只需从您的代码中手动运行查询“SHUTDOWN SCRIPT”。这将正确关闭 HSQLDB 并立即保存`.properties`和`.script`文件中的更改。

您的查询应如下所示：

```
SQLQuery query = session.createSQLQuery("SHUTDOWN SCRIPT"); 
```

# asp.net-mvc - 如何将通用列表传递给 Html.ActionLink(...)？

> ID：11621087
> 
> 赞同：4
> 
> 时间：2012-07-23T21:50:33.263
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我有一个表单，它使用属性为 multiple="multitple" 的控件。这允许用户在控件中选择多个项目。

使用 get 方法提交表单时，请求页面的 url 包含一个多个同名参数。每个选择的项目一个。例如，我可以得到这样的东西：

```
/logs?levels=DEBUG&levels=INFO&levels=FATAL 
```

在我的控制器中，操作正确接收 List 类型参数中的值，如下所示：

```
public ActionResult Index(List<String> levels)
{
   ...
} 
```

现在，出于某种原因，我需要创建一个指向此操作的链接，其中将包含多个级别参数的值。如何使用 Html.ActionLink 创建这样的链接？我这样试过：

```
@Html.ActionLink((p + 1).ToString(), "Index", new {
    levels = ViewBag.selectedLevels_AS_A_GENERIC_LIST_OF_STRINGS,
    itemsPerPage = ViewBag.itemsPerPage
}); 
```

它不起作用，因为列表没有以任何方式展开，而是在其上调用 .ToString() 并将结果插入到链接中。当然，我也无法创建具有多个名为“级别”的属性的对象。

如何创建一个 ActionLink，就像我使用的表单生成的一样？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T21:57:22.570

像这样的东西应该工作。

```
@Html.ActionLink((p + 1).ToString(), "Index", new RouteValueDictionary{
    {"levels[0]", selectedLevels_AS_A_GENERIC_LIST_OF_STRINGS[0]},
    {"levels[1]", selectedLevels_AS_A_GENERIC_LIST_OF_STRINGS[1]},
    {"itemsPerPage", ViewBag.itemsPerPage}
}); 
```

# android - 带有自定义 ArrayAdapter 的 ListView：工作正常，直到我需要更改项目数？

> ID：11621088
> 
> 赞同：1
> 
> 时间：2012-07-23T21:50:44.853
> 
> 标签：android, arrays, android-listview

我有一个用于管理 ListView 的自定义 ArrayAdapter：

```
public class FilesAdapter extends ArrayAdapter<PutioFileLayout> {

    Context context;
    int layoutResourceId;
    PutioFileLayout data[] = null;

    public FilesAdapter(Context context, int layoutResourceId, PutioFileLayout[] data) {
        super(context, layoutResourceId, data);
        this.layoutResourceId = layoutResourceId;
        this.context = context;
        this.data = data;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View row = convertView;
        FileHolder holder = null;

        if (row == null) {
            LayoutInflater inflater = ((Activity) context).getLayoutInflater();
            row = inflater.inflate(layoutResourceId, parent, false);

            holder = new FileHolder();
            holder.textName = (TextView) row.findViewById(R.id.text_fileName);
            holder.textDescription = (TextView) row.findViewById(R.id.text_fileDesc);
            holder.imgIcon = (ImageView) row.findViewById(R.id.img_fileIcon);

            row.setTag(holder);
        } else {
            holder = (FileHolder) row.getTag();
        }

        PutioFileLayout file = data[position];
        holder.textName.setText(file.name);
        holder.textDescription.setText(file.description);
        holder.imgIcon.setImageResource(file.icon);

        return row;
    }

    static class FileHolder {
        TextView textName;
        TextView textDescription;
        ImageView imgIcon;
    }
} 
```

在我的片段中，我在以下声明之前声明了这些`onCreate`：

```
private PutioFileLayout[] fileData;
private FilesAdapter adapter; 
```

然后，在 中`onCreate`，我用它初始化它，作为用户的占位符：

```
 fileData = new PutioFileLayout[] {
            new PutioFileLayout("Loading...", "Your files will appear shortly.", R.drawable.ic_launcher, false)
    }; 
```

我初始化我的适配器：

```
 adapter = new FilesAdapter(getSherlockActivity(), R.layout.file,
            fileData);
    listview.setAdapter(adapter); 
```

后来，在一些网络工作之后，我更新了适配器的数据。这就是我认为我可能会出错的地方。

```
PutioFileLayout[] files = blah blah, stuff. I've confirmed in debug that this array is correct and has the correct number of values.
adapter.data = files;
                adapter.notifyDataSetChanged(); 
```

所有这些的结果是 ListView 显示数组中的第一个项目，仅此而已。

如果我在初始化时添加第二个 Loading... 行或类似行，它会显示前两个。等等。

我错过了什么吗？这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:29:46.223

如果要更新`ArrayAdapter`使用`ArrayList`而不是`Array`. 因为如果您使用`Array`,`ArrayAdapter`将`List`在内部使用，无法更新。

重写你的构造函数

```
public FilesAdapter(Context context, int layoutResourceId, List<PutioFileLayout> list) {
    super(context, layoutResourceId, list);
    ...
} 
```

在`getView()`您通过调用`getItem(position)`.

初始化您的适配器使用`adapter = new FilesAdapter(getSherlockActivity(), R.layout.file, new ArrayList<PutioFileLayout>());`

并填充您的适配器使用`adapter.add(new PutioFileLayout(...));`

# box-api - BOX events api stopped working as of 23rd July 2012 10:00am PST?

> ID：11621090
> 
> 赞同：2
> 
> 时间：2012-07-23T21:50:57.863
> 
> 标签：box-api

We have noticed that as of 23rd July 2012 10:00am PST events api stopped working.

The call used to test this is:

```
curl https://api.box.com/2.0/events?steam_position=now -H "Authorization: BoxAuth api_key=key&auth_token=token 
```

then then output of the above is passed to the following command:

```
curl https://api.box.com/2.0/events?steam_position=32423423 -H "Authorization: BoxAuth api_key=key&auth_token=token 
```

We are getting following errors for all our accounts:

```
{"type":"error","status":500,
 "code":"internal_server_error",
 "help_url":"http:\/\/developers.box.com\/docs\/#errors", 
 "message": "Internal Server Error",
 "request_id":"1740663416500dc42663d5a"}) 
```

We tried with different accounts and api keys but seems thing do not work any more.

If there a way to check status of API?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:44:22.563

**更新：**问题已解决，端点应该照常工作。作为旁注，[https](https://api.box.com/2.0) ://api.box.com/2.0是 Box API v2 支持的端点——从[https://www.box.com/api/2.0](https://www.box.com/api/2.0)生成的错误不能保证以 JSON/ 格式进行格式化XML。

正如 500 错误所示，这似乎是我们这边的一个问题。我们目前正在调查，并会在问题解决后更新。

# reporting-services - 部署 Reporting Services 解决方案

> ID：11621095
> 
> 赞同：1
> 
> 时间：2012-07-23T21:51:17.343
> 
> 标签：reporting-services, ssrs-2008, sql-server-2012

我正在为客户编写 Reporting Services 解决方案。我正在我的开发环境中开发此解决方案，并且无权访问客户站点。我正在寻找一种方法来打包我的 Reporting Services 解决方案。我想要某种类型的安装程序部署包，它可以帮助他们在安装期间指定他们的生产数据源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:56:59.463

没有一个内置的。

1.  您需要创建一个 dll 项目并编写自定义安装程序操作。有关示例，请参阅[演练：创建自定义操作](http://msdn.microsoft.com/en-us/library/d9k65z2d%28v=vs.90%29.aspx)。
2.  您的 dll 将需要包含对 [http://SsrsServer.mydomain.tld/ReportServer/ReportService2005.asmx](http://SsrsServer.mydomain.tld/ReportServer/ReportService2005.asmx)的 Web 服务引用。请参阅[如何：添加对 Web 服务的引用](http://msdn.microsoft.com/en-us/library/bb628649%28v=vs.90%29.aspx)。
3.  您需要向安装程序添加一个自定义对话框，以询问报表服务器部署位置。有关如何创建和使用自定义对话框的示例，请参阅[演练：在安装时使用自定义操作创建数据库。](http://msdn.microsoft.com/en-us/library/49b92ztk%28v=vs.90%29.aspx)
4.  您需要一个自定义对话框来获取将部署报告的文件夹。
5.  您需要以编程方式更改 Web 服务引用的目标。
6.  您需要进行适当的 Web 服务调用来创建数据源。
7.  您需要进行适当的 Web 服务调用来创建报告。
8.  您需要将报表绑定到数据源。

您将需要的报告服务 Web 服务记录在[ReportingService2005 类](http://msdn.microsoft.com/en-us/library/reportservice2005.reportingservice2005.aspx)中。以下是操作的一些示例代码：

```
 /// <summary>
    /// Gets the reporting service SOAP client with the specified report server URL.
    /// </summary>
    /// <param name="reportServerUrl">The report server URL.</param>
    /// <returns>An instance of the reporting service SOAP client.</returns>
    internal static ReportingService2005SoapClient GetReportingService2005(Uri reportServerUrl)
    {
        EndpointAddress endPoint = new EndpointAddress(reportServerUrl);
        ReportService2005.ReportingService2005SoapClient soapClient = new ReportService2005.ReportingService2005SoapClient("ReportingService2005Soap", endPoint);
        soapClient.ClientCredentials.Windows.AllowedImpersonationLevel = System.Security.Principal.TokenImpersonationLevel.Impersonation;

        return soapClient;
    }

    /// <summary>
    /// Creates the data source.
    /// </summary>
    /// <param name="reportServerUri">The report server URI.</param>
    /// <param name="parentPath">The parent path.</param>
    /// <param name="itemName">Name of the item.</param>
    /// <param name="dataSourceDefinition">The data source definition.</param>
    internal static void CreateDataSource(Uri reportServerUri, string parentPath, string itemName, string description, DataSourceDefinition dataSourceDefinition)
    {
        using (ReportingService2005SoapClient reportingService = GetReportingService2005(reportServerUri))
        {
            ServerInfoHeader serverInfo = null;
            try
            {
                Property[] props = CreateDescriptionProperty(description);
                serverInfo = reportingService.CreateDataSource(null, itemName, parentPath, true, dataSourceDefinition, props);
            }
            catch (FaultException ex)
            {
                Trace.WriteLine(string.Format("CreateDataSource {0}/{1}: {2}", parentPath, itemName, ex.Message));
            }
        }
    }

    /// <summary>
    /// Creates the report.
    /// </summary>
    /// <param name="reportServerUri">The report server URI.</param>
    /// <param name="parentPath">The parent path.</param>
    /// <param name="itemName">Name of the item.</param>
    /// <param name="reportDefinition">The report definition.</param>
    internal static void CreateReport(Uri reportServerUri, string parentPath, string itemName, string description, byte[] reportDefinition)
    {
        Warning[] warnings;

        using (ReportingService2005SoapClient reportingService = GetReportingService2005(reportServerUri))
        {
            ServerInfoHeader serverInfo = null;
            try
            {
                Property[] props = CreateDescriptionProperty(description);
                serverInfo = reportingService.CreateReport(null, itemName, parentPath, true, reportDefinition, props, out warnings);
            }
            catch (FaultException ex)
            {
                Trace.WriteLine(string.Format("CreateReport {0}/{1}: {2}", parentPath, itemName, ex.Message));
            }
        }
    }

    /// <summary>
    /// Set the report or model data sources on the reporting server from the provided data source map entries.
    /// </summary>
    /// <param name="reportServerUri">The report server URI.</param>
    /// <param name="itemPath"></param>
    /// <param name="dataSourceMapEntries"></param>
    internal static void SetItemDataSourceMap(Uri reportServerUri, string itemPath, Dictionary<string, string> dataSourceMapEntries)
    {
        DataSource[] dataSources = (from dataSourceMapEntry in dataSourceMapEntries
                                    where !string.IsNullOrEmpty(dataSourceMapEntry.Value)
                                    select ConvertDataSourceMapEntry(dataSourceMapEntry)).ToArray();

        using (ReportingService2005SoapClient reportingService = GetReportingService2005(reportServerUri))
        {
            ServerInfoHeader serverInfo = null;
            try
            {
                serverInfo = reportingService.SetItemDataSources(null, itemPath, dataSources);
            }
            catch (FaultException ex)
            {
                Trace.WriteLine(string.Format("SetItemDataSourceMap {0} {1}", itemPath, ex.Message));
            }
        }
    }

    /// <summary>
    /// Convert a data source map entry into a report server data source object.
    /// </summary>
    /// <param name="dataSourceMapEntry"></param>
    /// <returns></returns>
    private static DataSource ConvertDataSourceMapEntry(KeyValuePair<string, string> dataSourceMapEntry)
    {
        DataSource dataSource = new DataSource();
        DataSourceReference dataSourceReference = new DataSourceReference();
        dataSource.Name = dataSourceMapEntry.Key;
        dataSourceReference.Reference = dataSourceMapEntry.Value;
        dataSource.Item = dataSourceReference;
        return dataSource;
    } 
```

# google-chrome-extension - chrome extension: append (push) JSON data into localStorage()

> ID：11621099
> 
> 赞同：0
> 
> 时间：2012-07-23T21:51:34.027
> 
> 标签：google-chrome-extension, local-storage

I have created my own method called pushLocalStorage() into my background.js to ease appending an object into an array of objects. It's purpose is to simply take data from the caller and if the key exists then push the data object onto the existing array stored in a previous iteration. If the key doesn't exist then create a new array indice.

The creation of the first object works fine. The second insertion successfully completed but insert the length of the array instead of the object. Finally the third and any subsequent inserts fail because the data is no longer an array but a string and my code verifies that the data is an array before inserting data. See example logging after the code:

Here's my code:

```
else if (request.method == 'pushLocalStorage')      
{
    var key; 
    var data;
    var stored;

    // if key isn't sent from caller, quit with error.
    if ( 'undefined' == typeof(request.key) )
    {
        sendResponse({success: 0,error: 'Key value was not sent from caller.'});
    }

    // if the key isn't a string type then quit with error.
    if ( 'string' != typeof(request.key) )
    {
        sendResponse({success: 0,error: 'Expected key passed from caller to be a ' + 
                                        'string but it was a(n) ' + typeof(request.key) + ' instead'});
    }

    // if data value isn't sent from caller, quit with error.
    if ( 'undefined' == typeof(request.data) )
    {
        sendResponse({success: 0,error: 'Data value was not sent from caller.'});
    }

    key    = request.key;
    data   = request.data;
    stored = localStorage.getItem(key); // attempt to retrieve existing store named by 'key'

    // Now if stored isn't null or undefined...
    if ( 'undefined' != typeof(stored) && stored != null )
    {
        // parse it back into a valid data structure from JSON
        stored = JSON.parse(stored);

        // if stored exists (should be an Array object)
        if ( stored.length )
        {
            // stored should be an array of objects so...
            for ( var i = 0 ; stored.length < i ; i++ )
            {
                // make sure not to push dupe tickets into the array. In this case, replace
                // the existing ticket with the new.
                if ( data.id === stored[i].id )
                {
                    stored[i] = data;

                    // save the data to localStorage (do not push but overwrite)
                    localStorage.setItem(key,JSON.stringify(stored));
                    test = JSON.parse(localStorage.getItem(key));
                    sendResponse({success: 1,data: test});
                    return;
                }
            }

            // save the stored object back to localStorage after pushing the new data to it.
            localStorage.setItem(key,stored.push(JSON.stringify(data)));
            test = JSON.parse(localStorage.getItem(key));
            sendResponse({success: 1,data: test});
        }
        else
        {
            console.log(' data would be: %o and stored was: %o', data,stored);
            sendResponse({success: 0, error: 'Attempt to coerce object into array not allowed.'});
        }
    }
    else
    {
        console.debug(' Creating new array to be stored.');
        stored = new Array(data);
        stored = JSON.stringify(stored);

        localStorage.setItem(key,stored);

        test = localStorage.getItem(key);
        test = JSON.parse(test);
        console.log('setItem.' + key + ',' + stored + '\nThe stored obj was: %o and the localStored.getItem after storage was: %o',test,localStorage.getItem(key));
        sendResponse({success: 1,data: test});
    }
} 
```

In the chrome console I get the following:

```
Object  
localstorage push! [Object]:  
Object
localstorage push! [Object]:
Object
localstorage push! [Object]:
Object
localstorage push! [Object]:
Object
localstorage push! 2:  
Object
localstorage push! [Object]: 
Object
localstorage push! 2:
Object
localstorage push failed: Attempt to coerce object into array not allowed. 
Object
localstorage push failed: Attempt to coerce object into array not allowed.
Object
localstorage push! [Object]:
Object
localstorage push! 2:
Object
localstorage push failed: Attempt to coerce object into array not allowed. 
```

So after trying several different methods of coding the functionality I desire, nothing seems to work. Am I barking up the wrong tree or am I just coding a poor implementation?

TIA

EDIT:

Fixed code in completion:

```
if (request.method == 'pushLocalStorage')       
{
    var key; 
    var data;
    var stored;

    // if key isn't sent from caller, quit with error.
    if ( 'undefined' == typeof(request.key) )
    {
        sendResponse({success: 0,error: 'Key value was not sent from caller.'});
    }

    // if the key isn't a string type then quit with error.
    if ( 'string' != typeof(request.key) )
    {
        sendResponse({success: 0,error: 'Expected key passed from caller to be a ' + 
                                        'string but it was a(n) ' + typeof(request.key) + ' instead'});
    }

    // if data value isn't sent from caller, quit with error.
    if ( 'undefined' == typeof(request.data) )
    {
        sendResponse({success: 0,error: 'Data value was not sent from caller.'});
    }

    key    = request.key;
    data   = request.data;
    stored = localStorage.getItem(key); // attempt to retrieve existing store named by 'key'

    // Now if stored isn't null or undefined...
    if ( 'undefined' != typeof(stored) && stored != null )
    {
        // parse it back into a valid data structure from JSON
        stored = JSON.parse(stored);

        // if stored exists (should be an Array object)
        if ( stored.length )
        {
            // stored should be an array of objects so...
            for ( var i = 0 ; i < stored.length ; i++ )
            {
                // make sure not to push dupe tickets into the array. In this case, replace
                // the existing ticket with the new.
                if ( data.id === stored[i].id )
                {
                    stored[i] = data;

                    // purge the item...
                    localStorage.removeItem(key);

                    // save the data to localStorage.
                    localStorage.setItem(key,JSON.stringify(stored));

                    data = JSON.parse(localStorage.getItem(key));
                    sendResponse({success: 1,data: data});
                    return;
                }
            }

            // save the stored object back to localStorage after pushing the new data to it.
            stored.push(data);
            localStorage.setItem(key,JSON.stringify(stored));
            data = JSON.parse(localStorage.getItem(key));
            sendResponse({success: 1,data: data});
        }
        else
        {
            sendResponse({success: 0, error: 'Attempt to coerce object into array not allowed.'});
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T01:08:53.667

好吧。弄清楚了。当我应该走动的时候，我却在走动：

错误的：

```
localStorage.setItem(key,stored.push(JSON.stringify(data))); 
```

正确的：

```
stored.push(data);
localStorage.setItem(key,JSON.stringify(stored));

test = JSON.parse(localStorage.getItem(key));
sendResponse({success: 1,data: test}); 
```

问题是我试图将一个字符串化的值推送到一个数组对象中。是的，不能那样做。一旦我解决了这个问题，一切都很好。

# jquery - jquery 遍历表并且仅在 2x TD 时才执行某些操作

> ID：11621102
> 
> 赞同：0
> 
> 时间：2012-07-23T21:51:40.907
> 
> 标签：jquery, expand

我在这里遇到了一个特殊的“问题”。Ti 满足来自客户的请求，我需要执行以下操作。遍历页面上的所有表。对于每个表，检查它是否正好有 2 个 TD。如果是这样，那么我需要进行“阅读更多”实施。

我在另一个页面上使用了它，我知道我想要折叠和展开的确切 div。

```
$(".more-block").each(function(){
    if ($(this).height() > adjustheight){
        id = this.id;
        id = id.split("_");
        $("#expand"+id[1]).toggle(function() {
                id = this.id;
                $(".more-block"+id).css('height', 'auto').css('overflow', 'visible');
                $('html, body').animate({scrollTop: $(document).height()}, 'slow');
                $("#"+id).attr('src',path+'/images/expand2.png');
                $(".frontpage_box").css('height', '');
            }, function() {
                id = this.id;
                $("#"+id).attr('src',path+'/images/expand.png');
                $(".more-block"+id).animate({height: adjustheight}, "slow", function(){
                    $(".more-block"+id).css('height', adjustheight).css('overflow', 'hidden');
                });         
        });
    };
});

$(".more-block").css('height', adjustheight).css('overflow', 'hidden'); 
```

有任何想法吗？当我运行 TD 时，我可以添加“more-less”和“more-lessexpand1”类（数字是增量）。这可能吗？我不知道如何运行表格，只有在找到两个 TD 时才这样做，并且只在第二个 TD 上执行最后一点。

哦，顺便说一句……重要的是它只有第二个 TD 折叠和扩展。左边的是不允许的。如果有人可以帮助我找到感兴趣的 TD，我也许可以解决最后一点。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T21:57:42.793

```
$('table').filter(function(
    return $('td', this).length==2;
)).find('td').last().addClass('more-less more-lessexpand1'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T21:54:37.830

> *“如果有人能帮我找到感兴趣的 TD，我也许能解决最后一点。”*

假设您没有嵌套表，这样的事情会找到感兴趣的表：

```
$("table").each(function() {
   var $tds = $(this).find("td");
   if ($tds.length != 2)
       return;
   // this is a table with exactly two cells, so do something
   // $tds.eq(0) will reference first td;
   // $tds.eq(1) will reference second td;
   // So to add the classes to the second cell...
   $tds.eq(1).addClass("more-less more-lessexpand1");
}); 
```

# .net - 如何使用 double 数组的资源制作 wpf 组合框？

> ID：11621105
> 
> 赞同：3
> 
> 时间：2012-07-23T21:52:14.510
> 
> 标签：.net, wpf, combobox, binding

我的 Window 有一个 double 数组作为字段：

```
double[] sizes = new double[] {1.0, 2.0, 3.0, 4.0}; 
```

还有一个组合框，我希望它具有确切的 Items 作为上面的数组。任何人都可以帮助我将这个数组绑定为组合框的资源的 xaml 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-23T22:01:24.643

我不知道您的代码是什么样的，但这是一个如何将数组绑定到`ComboBox`

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
<Grid>
    <ComboBox ItemsSource="{Binding Sizes}" />
</Grid>
</Window> 
```

后面的代码：

```
namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public double[] sizes = new double[] { 1.0, 2.0, 3.0, 4.0 };
        public double[] Sizes
        {
            get { return sizes; }
        }

        public MainWindow()
        {
            this.DataContext = this;   
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-07T22:11:20.507

除了@Nathan 的回答，我想补充一点，如果您想绑定到静态数据，`OneTime`出于性能原因，最好指定绑定模式：

```
<Grid>
    <ComboBox ItemsSource="{Binding Sizes, Mode=OneTime}" />
</Grid> 
```

[在此处](https://msdn.microsoft.com/en-us/library/system.windows.data.bindingmode%28v=vs.110%29.aspx)查看详细信息。

# data-modeling - 数据库结构查询

> ID：11621111
> 
> 赞同：0
> 
> 时间：2012-07-23T21:53:06.773
> 
> 标签：data-modeling

我正在开发具有以下标题的数据库：

地区 , 城市 , 郊区

每个标题将有大约 4000 行，所以我猜如果我使用单独的表而不是一个包含许多列的表会更好。

设置 Region id City id 和 Suburb id 的最佳方法是什么？当我想选择特定地区的信息时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:03:00.867

虽然有几种方法可以对这些表进行建模，但这里是一种设置方法：

```
Region
id int, -- PK
name varchar(50)

City
id int, -- PK
region_id int, -- FK
name varchar(50)

Suburb
id int, -- PK
city_id int, -- FK
name varchar(50) 
```

然后，如果您需要数据，则需要`JOIN`表格

```
SELECT r.name as RegionName
    , c.name as CityName
    , s.name as SuburbName
FROM Region r
INNER JOIN City c
    ON r.id = c.region_id
INNER JOIN Suburb s
    ON c.id = s.city_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:02:36.030

我假设城市是地区的一部分，郊区是城市的一部分。如果是这样，您可能需要更多表。

**您的区域**的一个表，其中包含所有信息以及列 ID（自动递增）。

**您的城市**的一张表，其中包含所有信息以及列 ID（自动递增）。

一张表用于您的**郊区**，其中包含所有信息以及列 ID（自动递增）。

然后，一张表格将您的城市与您的地区联系起来。一列是 ID（自动增量），一列是城市（城市表中的城市 ID 所在的位置），一列是区域（区域表中的区域 ID 所在的位置）。这让您知道哪些城市属于哪个地区。

接下来，一张表将您的郊区与您的城市联系起来。一列是 ID（自动增量），一列是区域（再次来自您的区域表），一列是郊区（来自您的郊区表）。这让您知道哪些郊区属于哪些城市。

通过此设置，您可以使用 INNER JOIN 来获取您的城市或郊区，并且您将拥有郊区的数据和更一般类别的数据。

希望这会有所帮助，我已经开发了很长时间的关系 Web 应用程序，并且发现我上述的方法非常有效。

# javascript - 将表格提交到两个不同的地方

> ID：11621116
> 
> 赞同：0
> 
> 时间：2012-07-23T21:53:22.273
> 
> 标签：javascript, jquery, paypal, formmail

我有一个在用户单击提交时调用的函数。

```
function submitForm() {
} 
```

我希望能够通过 FormMail.pl 将表单的内容发送到我的电子邮件地址，然后一旦发生这种情况，请执行默认操作，即发送到 paypal，因为这是一个订单。

如果在某处找到此代码但它不起作用

```
function submitForm() {
     var data = {};
    $("input").each(function() {
        var t = $(this);
        if (typeof t.attr("name") == "string" && typeof t.val() == "string") {
            data[t.attr("name")] = t.val();
        }
    })

    $.ajax({
        "type" : "POST",
        "url" : "cgi-bin/FormMail.pl",
        "data" : data,
        "dataType" : "json",
        "success" : function(data) {

            $(".submitLast").unbind("submit", onOrderFormSubmit)
                            .submit();

        },
        "error" : function(xhr, status) {
            console.log("failed to submit to FormMail (" + status + ")");
        }
    });

    return false;

} 
```

我也试过这个

```
function submitForm() {
    alert("begin");
        $.post( 'http://www.spirecreativegroup.com/cgi-bin/FormMail.pl', $('form').serialize(), function(data, textStatus) {
            //data is the result from the script
            alert(data);
        });

        //Send data to the other script
        $.post( 'https://www.sandbox.paypal.com/cgi-bin/webscr', $('form').serialize(), function(data, textStatus) {
            //data is the result from the script
            alert(data);
        });
} 
```

在我尝试的第二个代码中，我得到了开始警报，但就是这样。

我不是很有经验，但我会从你的建议中学习。我真的很感激一些帮助或正确方向的一点。

谢谢你，

巴特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:31:44.633

您可以做什么 - 您可以将表单提交到您的脚本，该脚本将发送电子邮件，然后将用户重定向到贝宝`header('Location: ' . $paypal_url)`

# php - 获取用户注册时间？

> ID：11621119
> 
> 赞同：2
> 
> 时间：2012-07-23T21:53:30.853
> 
> 标签：php, mysql, date

我正在开发一个 PHP 应用程序，它以 MySQL 数据库为中心，我希望自动记录用户的注册时间。

*   哪个会更好？使用 PHP 的日期函数或 MySQL 是否有当前时间戳选项（我认为有）。
*   如果 MySQL 更好（在准确性方面），那么我将如何实现它？表结构是什么？
*   如果 PHP 更好（在准确性方面），那么最直接的方法是什么？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T21:55:20.233

查看[MySQL DateTime](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_utc-date)参考。

我建议`UTC_TIMESTAMP()`在 MySQL 中使用，然后您将时区排除在外，并且非常准确。

```
mysql> SELECT UTC_TIMESTAMP(), UTC_TIMESTAMP() + 0;
    -> '2003-08-14 18:08:04', 20030814180804.000000 
```

如果将其用作字符串，则会返回日期格式，如果将其用作数字选择器，则会返回数值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T21:55:15.893

以下 MYSQL 代码将执行此操作：

```
INSERT INTO table_name (date_field) VALUE (now()) 
```

就准确性而言，MYSQL 将最接近插入时间，但 PHP 和 MYSQL 之间的差异是如此之小，以至于不会产生影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T21:56:30.153

您可以在插入记录时使用 MySQL 函数[UNIX_TIMESTAMP() 。](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_unix-timestamp)

PHP 和 MySQL 都将使用系统时钟中的时间，因此无论您使用哪个结果都应该是相同的。时间戳也以 UTC 格式存储，因此可以轻松切换到用户的时区。

IMO，您使用哪个（PHP 或 MySQL 时间）没有区别，但我个人会将注册时间`INT`作为时间戳存储在列中。

插入可能如下所示：

```
INSERT INTO `user`
(id, username, registrationTime)
VALUES
(NULL, 'rgbc', UNIX_TIMESTAMP()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T21:57:47.907

我会按顺序回答这些。

*   我总是推荐使用 MySQL 的 time 函数（即 NOW()），因为它可以使代码更简洁、更高效。尽管性能差异很小，但在 INSERT 查询中使用 NOW() 比使用 PHP 的 date() 函数设置变量然后在查询中稍后调用它更简单。

*   如果您寻求的是准确性，请为您的数据库使用 InnoDB 引擎。一个示例结构是：id (int auto_increment)、name (tinytext)、password (tinytext)、salt (tinytext)、registerd_date (DATETIME)。密码和盐列用于使用安全的散列密码（类似于 SHA512）。

*   在我看来，PHP 可能是最简单的。最直接的方法是做一个常规的注册表格，然后使用 NOW() 记录注册发生的日期和时间。

祝你好运，

大卫

# jquery - 跳跃的动画jquery

> ID：11621121
> 
> 赞同：0
> 
> 时间：2012-07-23T21:53:36.613
> 
> 标签：jquery, css, button, twitter-bootstrap

我目前正在处理这个删除按钮，但由于某种原因，jquery 动画在单击并悬停在按钮上时有点“跳跃”。我想知道这是什么原因造成的。。

[http://jsfiddle.net/myyn5/3/](http://jsfiddle.net/myyn5/3/)

[编辑]thanx 很多人，看看最终结果！： http: [//jsfiddle.net/myyn5/232/](http://jsfiddle.net/myyn5/232/) [/EDIT]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:23:21.863

问题在于 jQuery 调整按钮的大小。

在 jsfiddle 中使用您的代码后，我删除了`$fx.off`. 另外，关于 MrOBrians 的观点，我`.stop()`在执行任何动画之前添加了调用。

`$（函数（）{

```
$(".custom").on({
    click: function() {
        $("span").stop(true, true).show();
        $(this).animate({
            width: 90
        }, 700, function() {
            $("span").stop(true, true).animate({
                left: '18px',
                opacity: 1
            }, 500, 'swing');
            $(this).addClass("confirm");
            $(this).removeClass("custom");
        })
    },
    mouseleave: function() {
       $(this).removeClass("confirm");
        $("span").stop(true, true).animate({
            left: '-12px',
            opacity: 0
        }, 500, 'swing', function() {
            $(".custom").stop(true, true).animate({
                width: 18
            }, 500);
        });
        $(this).addClass("custom");
    }
}); 
```

});`

还对css进行了一些更改，因为我的第一个想法是按钮上缺少定义的宽度。

但是，即使按钮已经处于预期大小，我也无法在调整大小之前使按钮的宽度缩小。在将大小调整为 90 之前，它仍然想跳进去。如果光标定位在按钮上的某个点上，则会触发 mouseleave 事件，从而导致打嗝和意外的跳跃动画。

无论如何，我不确定这是否是带有按钮的 jquery 中的错误，或者是否有一些解决方法。但我必须做的是将按钮更改为 DIV，然后一切都开始变得很好。

`<p> <div class="btn btn-danger custom"> <i class="icon-trash icon-white"></i> <span>Delete</span> </div> </p>`

您仍然可以通过使用`$('#formID').submit();`或`$.ajax()`在您的点击功能中完成这项工作。

[http://jsfiddle.net/hAAwk/1/](http://jsfiddle.net/hAAwk/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:35:36.357

这是一个工作示例。[现场演示](http://jsfiddle.net/myyn5/67/)

```
$(function() {

    $(".custom").on({
        click: function() {
            event.preventDefault(); //  Show span
            if (!$(this).hasClass('confirm')) {
                $("span").show();
                $(this).stop().animate({
                    width: 90 + 'px',
                }, 700, function() {
                    $("span").animate({
                        left: '+=22',
                        opacity: 1
                    }, 500, 'swing');
                    $(this).addClass("confirm");
                    $(this).removeClass("custom");
                })
            } else {

                $(this).removeClass("confirm");
                $("span").stop().animate({
                    left: '-15px',
                    opacity: 0
                }, 500, 'swing', function() {
                    $(".custom").animate({
                        width: 36 + 'px'
                    }, 500);
                });
                $(this).addClass("custom");
            }
        }

    });
});​ 
```

# assembly - 68HCS12 上的装配秒表

> ID：11621122
> 
> 赞同：1
> 
> 时间：2012-07-23T21:53:38.250
> 
> 标签：assembly, codewarrior, 68hc12

嗨，我正在尝试在组装中制作秒表以在 Dragon 12 plus 板上运行，我已将其设置为按钮开始停止并重置时间，程序运行但速度不够快。我知道问题与延迟有关，但我不知道如何解决它。我认为我的中断例程太长，但我尝试实施的所有其他方法都不起作用，任何输入都会非常感激。好吧，这是我的代码，抱歉没有很好地注释

```
 XDEF      Entry       ; export 'Entry' symbol
      ABSENTRY  Entry       ; for absolute assembly: mark this as application entry point

      INCLUDE   'derivative.inc' 

      ROM       EQU     $0400
      DATA      EQU     $1000
      PROG      EQU     $2000
      RS        EQU     $01           ; Register Select pin for LCD module  
      EN        EQU     $02           ; Enable pin for LCD module

  ; Variable/Data Section

                ORG     DATA
      START     RMB     2
      DELAYC    FDB     1876
      CMD       FDB     $0000
      CNT       FDB     1000 
      CLOCKON   FCB     $00
      SECOND    FCB     $00
      TENTH     FCB     $00
      HUNDREDTH FCB     $00
      TMINUTE   FCB     $00
      THOUR     FCB     $00
      MINUTE    FCB     $00
      HOUR      FCB     $00
      TSECOND   FCB     $00

                ORG     PROG
      ; Insert your code following the label "Entry"          
      Entry:    SEI
                JSR     INIT 
      MAINLOOP: 
                WAI
                CLI
                BRA     MAINLOOP
      INTKEY:  
                SEI
                JSR     DELAY
                LDAB    PTH
                COMB
                CMPB    #$01
                BEQ     STARTCLOCK
                CMPB    #$02
                BEQ     STOPCLOCK
                CMPB    #$04
                BEQ     RESETCLOCK
                BRA     RESETIGNORE

      STARTCLOCK
                MOVB    #$80,TSCR1
                LDAA    #$01
                STAA    CLOCKON
                BRA     RESETIGNORE
      STOPCLOCK 
                MOVB    #$C0,TSCR1
                LDAA    #$00
                STAA    CLOCKON
                BRA     RESETIGNORE
      RESETCLOCK
                LDAA    CLOCKON
                CMPA    #$01
                BEQ     RESETIGNORE
                JSR     TIMERCLR
                LDAA    #$00
                STAA    HUNDREDTH    
                STAA    TENTH
                STAA    SECOND
                STAA    TSECOND
                STAA    MINUTE
                STAA    TMINUTE
                STAA    HOUR
                STAA    THOUR

      RESETIGNORE
                LDAA    #$FF
                STAA    PIFH
                CLI
                RTI             
      INCREMENTHUNDREDTH
                LDAB    CLOCKON
                CMPB    #$00
                LBEQ    RETURN
                LDAA    HUNDREDTH
                CMPA    #9
                BEQ     INCREMENTTENTH
                ADDA    #1
                STAA    HUNDREDTH
                LBRA    DISPLAYHUNDREDTH
      INCREMENTTENTH
                LDAA    #$00
                STAA    HUNDREDTH
                LDAA    TENTH
                CMPA    #9
                BEQ     INCREMENTSECOND
                ADDA    #1
                STAA    TENTH
                LBRA    DISPLAYTENTH         
      INCREMENTSECOND
                LDAA    #$00
                STAA    TENTH
                LDAA    SECOND
                CMPA    #9
                BEQ     INCREMENTTSECOND
                ADDA    #1
                STAA    SECOND         
                LBRA     DISPLAYSECOND
      INCREMENTTSECOND
                LDAA    #$00
                STAA    SECOND
                LDAA    TSECOND
                CMPA    #5
                BEQ     INCREMENTMINUTE
                ADDA    #1
                STAA    TSECOND
                LBRA     DISPLAYTSECOND  
      INCREMENTMINUTE
                LDAA    #$00
                STAA    TSECOND
                LDAA    MINUTE
                CMPA    #9
                BEQ     INCREMENTTMINUTE
                ADDA    #1
                STAA    MINUTE
                BRA     DISPLAYMINUTE
      INCREMENTTMINUTE 
                LDAA    #$00
                STAA    MINUTE
                LDAA    TMINUTE
                CMPA    #5
                BEQ     INCREMENTHOUR
                ADDA    #1
                STAA    TMINUTE
                BRA     DISPLAYTMINUTE
      INCREMENTHOUR
                LDAA    #$00
                STAA    TMINUTE
                LDAA    HOUR
                CMPA    #9
                BEQ     INCREMENTTHOUR
                ADDA    #1
                STAA    HOUR
                BRA     DISPLAYHOUR 
      INCREMENTTHOUR
                LDAA    #$00
                STAA    HOUR
                LDAA    THOUR
                ADDA    #1
                STAA    THOUR
                BRA     DISPLAYTHOUR 

      DISPLAYTHOUR
                LDAA    #$C0
                JSR     COM_WRT
                JSR     DELAY
                LDAA    THOUR
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
      DISPLAYHOUR
                LDAA    #$C1
                JSR     COM_WRT
                JSR     DELAY
                LDAA    HOUR
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
      DISPLAYTMINUTE
                LDAA    #$C3
                JSR     COM_WRT
                JSR     DELAY
                LDAA    TMINUTE
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
      DISPLAYMINUTE
                LDAA    #$C4
                JSR     COM_WRT
                JSR     DELAY
                LDAA    MINUTE
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
      DISPLAYTSECOND
                LDAA    #$C6
                JSR     COM_WRT
                JSR     DELAY
                LDAA    TSECOND
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
      DISPLAYSECOND
                LDAA    #$C7
                JSR     COM_WRT
                JSR     DELAY
                LDAA    SECOND
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
      DISPLAYTENTH
                LDAA    #$C9
                JSR     COM_WRT
                JSR     DELAY
                LDAA    TENTH
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
      DISPLAYHUNDREDTH
                LDAA    #$CA
                JSR     COM_WRT
                JSR     DELAY 
                LDAA    HUNDREDTH
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
      RETURN    
                RTI

      ; INITIALIZATION

      INIT 
                BSET    DDRB,#$FF     ; Set Port B to output
                BSET    DDRJ,#$02     ; Set Port J pin 1 to output
                BCLR    PTJ,#$02      ; Enable discrete LEDs
      ; Disable 7-Segment Display
                BSET    DDRP,#$0F     ; Set Port P pins 0-3 to output
                BSET    PTP, #$0F     ; Disable 7-Segment Display
      ; Pushbuttons/DSs
                BCLR    DDRH, #$00    ; Set Port H pins to input
                LDAA    #0          ;PTH as input   
            STAA    DDRH
            LDAA    #$FF        ;   
                STAA    PIEH   
       ; Set Port K to Output
                LDAA    #$FF
                STAA    DDRK                        
                JSR     CLEAR ; Clear LCD screen   
                BSET    TSCR2,#$0F
                BSET    TIE,#$80
                BSET    TIOS,#$80
                LDD     #$0753
                STD     TC7
                MOVB    #$CD,HPRIO
                BSR     TIMERCLR
                CLI
                RTS

      TIMERCLR
                LDAA    #$C0
                JSR     COM_WRT
                JSR     DELAY
                LDAA    THOUR
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
                LDAA    HOUR
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY 
                LDAA    #':'
                JSR     DATA_WRT
                JSR     DELAY
                LDAA    TMINUTE
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
                LDAA    MINUTE
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY 
                LDAA    #':'
                JSR     DATA_WRT
                JSR     DELAY
                LDAA    TSECOND
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
                LDAA    SECOND
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY 
                LDAA    #'.'
                JSR     DATA_WRT
                JSR     DELAY
                LDAA    TENTH
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY 
                LDAA    HUNDREDTH
                ADDA    #48
                JSR     DATA_WRT
                JSR     DELAY
                RTS
      ;---------------------------------------------------- 
      ; Clear LCD Subroutine   
      ;----------------------------------------------------
      ; This sequence of instructions initializes the LCD and
      ; sets the cursor to the beginning of the first line.
      ; It also will move the cursor to the right, one space,
      ; when writing a new character. Please note, characters
      ; don't wrap around.    
      CLEAR:    LDAA    #$33
                BSR     COM_WRT
                JSR     DELAY   
                LDAA    #$32
                BSR     COM_WRT
                JSR     DELAY
                LDAA    #$28
                BSR     COM_WRT
                JSR     DELAY
                LDAA    #$0C; WAS E, HOPEFULLY THIS HIDES CURSOR
                BSR     COM_WRT
                JSR     DELAY
                LDAA    #$01
                BSR     COM_WRT
                BSR     DELAY
                LDAA    #$06
                BSR     COM_WRT
                BSR     DELAY
                LDAA    #$80
                BSR     COM_WRT
                BSR     DELAY    
                RTS
      ;---------------------------------------------------- 
      ; Command Write Subroutine   
      ;---------------------------------------------------- 
      COM_WRT:
                STAA      CMD           ; Save curent command into CMD
                ; Write upper nibble only
                ANDA    #$F0          ; Get upper nibble only
                LSRA                  ; Shift right to align DB pins of LCD w/ Port K pins
                LSRA
                STAA    PORTK         ; Output to Port K
                BCLR    PORTK,RS      ; Set register select for an instruction <----
                BSET    PORTK,EN      ; Enable high
                NOP                   ; Delay 1 cycle
                NOP                   ; Delay 1 cycle
                NOP                   ; Delay 1 cycle
                BCLR    PORTK,EN      ; Enable low
                ; Write lower nibble only
                LDAA    CMD           ; Reload Reg A w/ CMD
                ANDA    #$0F          ; Get lower nibble only
                LSLA                  ; Shift left to align DB pins of LCD w/ Port K pins
                LSLA
                STAA    PORTK         ; Output to Port K
                BCLR    PORTK,RS      ; Set register select for an instruction <----
                BSET    PORTK,EN      ; Enable high
                NOP                   ; Delay 1 cycle
                NOP                   ; Delay 1 cycle
                NOP                   ; Delay 1 cycle
                BCLR    PORTK,EN      ; Enable low
                RTS
      ;---------------------------------------------------- 
      ; Data Write Subroutine   
      ;---------------------------------------------------- 
      DATA_WRT:
                STAA      CMD           ; Save curent command into CMD
                ; Write upper nibble only
                ANDA    #$F0          ; Get upper nibble only
                LSRA                  ; Shift right to align DB pins of LCD w/ Port K pins
                LSRA
                STAA    PORTK         ; Output to Port K
                BSET    PORTK,RS      ; Set register select for data <----
                BSET    PORTK,EN      ; Enable high
                NOP                   ; Delay 1 cycle
                NOP                   ; Delay 1 cycle
                NOP                   ; Delay 1 cycle
                BCLR    PORTK,EN      ; Enable low
                ; Write lower nibble only
                LDAA    CMD           ; Reload Reg A w/ CMD 
                ANDA    #$0F          ; Get lower nibble only
                LSLA                  ; Shift left to align DB pins of LCD w/ Port K pins
                LSLA
                STAA    PORTK         ; Output to Port K
                BSET    PORTK,RS      ; Set register select for data <----
                BSET    PORTK,EN      ; Enable high
                NOP                   ; Delay 1 cycle
                NOP                   ; Delay 1 cycle
                NOP                   ; Delay 1 cycle
                BCLR    PORTK,EN      ; Enable low
                RTS

      ; Delay Subroutine   

      DELAY:   
                LDY     #6000         ; 6000 x 4 = 24,000 cycles = 1ms
      LOOP_1MS: 
                LDX     #4           
      LOOP:     
                DEX
                BNE     LOOP             
                DEY                   ; This instruction takes 1 cycle
                BNE     LOOP_1MS      ; This instruction takes 3 cycles
                RTS
      ;INITILIZE INTERUPTS

               ORG      $3E7E
               FDB      Entry
               ORG      $3E4C
               FDB      INTKEY 
               ORG      $3E60
               FDB      INCREMENTHUNDREDTH 
```

# javascript - 用jquery在图像上隐藏/显示div？

> ID：11621126
> 
> 赞同：0
> 
> 时间：2012-07-23T21:54:06.580
> 
> 标签：javascript, jquery

单击图像时，我试图显示/隐藏 div。当我单击图像时，没有任何反应。我的代码有什么问题

```
<script type="text/javascript">
$('#close').click(function(){
    $('#main').show();
    $('#login').hide();
    });
</script>

<div style="float:right;"><a href="#">Close <img id="close" src="assets/close.png"></a></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T21:58:31.637

这可能是因为当你的脚本执行时，`close`图像还不存在。将您的设置包装在一个`$(document).ready`块中

轻微更新：在我自己的机器上的快速测试中，调用`.click(..)`图像标签没有做任何事情。我改变了它，所以`close`元素实际上是`<a>`，并且一切正常。

相关HTML：

```
 <a id="close" href="#">Close (image goes here)</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:18:35.553

```
<script type="text/javascript">
    $(function(){
        $('#close').live('click',function(){
            $('#main').show();
            $('#login').hide();
        });
    });
</script>

<div style="float:right;"><a id="close">Close <img src="assets/close.png" /></a></div> 
```

使用直播功能。另外，我会定位 a 标签，这样文本也会触发它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T21:57:33.710

首先，您不应该多次拥有相同的 ID。

然后：

```
 <script type="text/javascript">
    $('#image').click(function(){
        $('#close').toggle();
        });
    </script>

    <div id="close" style="float:right;"><a href="#">Close <img id="image" src="assets/close.png"></a></div> 
```

当然，这也会隐藏您的图像，因此您没有任何可点击的内容。但这是一个开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T22:05:33.777

在使用 id 与类名时，有一个非常好的经验法则。如果您要在模板中多次使用它，请将其设为一个类。在 main、login、header 或 footer 的情况下，Id 可以正常工作，但在这里我会使用一个类。

现在这不是导致您的问题的原因，但我想我会指出这一点。您的问题可能是因为选择器试图找到尚不存在的东西。你有2个选择

1.) 将您的脚本移动到页面底部
2.) 将您的代码包装在一个就绪函数中（仅在 dom 就绪后执行。

这是带有我的建议的更新代码示例

```
<!DOCTYPE HTML>
<html>
<head>
    <title>Click Handler</title>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script type="text/javascript">

        $(function(){
            $('.close').click(function(){
                $('#main').show();
                $('#login').hide();
            });
        })

    </script>

</head>
<body>

<div style="float:right;"><a href="#" class="close">Close <img src="assets/close.png" class="close"></a></div>

<div id="main" style="display:none;">Main</div>
<div id="login">Login</div>

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-28T14:56:45.977

jQuery live 已弃用，jQuery 文档指示使用 .on("click", function(){

});

[jQuery .live()](https://api.jquery.com/live/)

[jQuery .on()](https://api.jquery.com/on/)

# google-api - 如何更改代表 Google Calendar API 服务帐户发送的邮件的发件人电子邮件地址

> ID：11621134
> 
> 赞同：6
> 
> 时间：2012-07-23T21:54:42.340
> 
> 标签：google-api

我正在使用服务帐户访问 Google Calendar API。我的程序创建日历并与用户共享。目前，用户收到一封电子邮件（由 Google，而不是我发送），发件人非常冗长且难以阅读。

发件人看起来像`3928472398472-ehrufh3478fh3487fh387fh32f7h2d323d@developer.gserviceaccount.com`

消息如下所示：

`We are writing to let you know that 3928472398472-ehrufh3478fh3487fh387fh32f7h2d323d@developer.gserviceaccount.com has given you access to edit events on the Google Calendar called "NewCal".`

有没有办法为这些自动生成的电子邮件指定发件人电子邮件地址，以便我可以指定我的用户将识别和信任的名称？现在看起来，很容易假设这些是垃圾邮件，因此它们被忽略了。

谢谢你的帮助。

# mysql - 如何更新包含重复 ID 的表的第一行并使用 SQL 更新所有唯一 ID

> ID：11621139
> 
> 赞同：0
> 
> 时间：2012-07-23T21:55:03.147
> 
> 标签：mysql, sql

我有一个包含重复和唯一 ID 的表。我想在所有交易费用中添加 10 美分，在重复的第一行订单中添加 10 美分，例如：

```
What i start with:
order# Fee    
123    5    
123    4    
111    3
122    5

what I should get: 

order# Fee     
123    5.1    --duplicates
123    4.0    --should not have 10 cents. 
111    3.1
122    5.1 
```

我尝试使用下面的代码，但它会更新每个订单#

```
-- updates table adds 10 cents to the first order of each duplicate and every unique order
update ebaytemp
set [transaction fees] = [transaction fees] +.10
from (SELECT [order#] 
from ebaytemp
GROUP BY order#
HAVING COUNT(order#) > 1) as E 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:05:38.480

如果您有一个`datetime`or`timestamp`列来跟踪何时输入交易（您怎么能不呢？），您可以基于该列的“第一行”并使用：

```
UPDATE ebaytemp a
INNER JOIN
(
    SELECT ordernum, MIN(date_entered) AS minentered
    FROM ebaytemp
    GROUP BY ordernum
) b ON a.ordernum = b.ordernum AND a.date_entered = b.minentered
SET a.fee = a.fee + 0.10 
```

# perl - 使用数字而不是名称指定 Perl 信号处理程序

> ID：11621144
> 
> 赞同：5
> 
> 时间：2012-07-23T21:55:26.207
> 
> 标签：perl, signals, handler

我想在 Perl 中指定一个信号处理程序，但使用数字而不是名称。这可能以简洁的方式吗？杀戮缺乏对称性尤其突出。例如，而不是

```
$SIG{USR2} = \&myhandler; 
```

我想说

```
$SIG{12} = \&myhandler; 
```

我目前最好的方法是“使用 Config”并根据 perldoc perlipc 中的代码在 $Config{sig_name} 中四处寻找。这是冗长的，似乎不必要的复杂。

理由：我最近在两个案例中想要这个。

1：我是由一个错误的父进程启动的，他错误地设置了我关心忽略的信号，我只想将所有内容重置为默认值。例如[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679630](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679630) 目标将是一些简单而蛮力的东西，例如：

```
foreach my $i (1..32) { $SIG{$i} = 'DEFAULT'; } 
```

2：我正在编写一个薄的、尽可能不可见的包装脚本。如果我包装的程序带有信号退出，我想退出相同的信号。但是，我捕获了一些信号，所以我需要清除我自己的信号处理程序以确保我真正退出而不是进入我的信号处理程序。我的目标是写一些像这样的简短内容：

```
$ret = system("./other-program");
$SIG{$ret & 127} = 'DEFAULT';
kill $ret & 127, $$; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T01:33:34.520

第一个问题：

```
use Config qw( %Config );

my @sig_name_by_num;
@sig_name_by_num[ split(' ', $Config{sig_num}) ] = split(' ', $Config{sig_name});

$SIG{$sig_name_by_num[12]} = \&handler; 
```

* * *

第二个问题：

```
use Config qw( %Config );

$SIG{$_} = 'DEFAULT' for split ' ', $Config{sig_name}; 
```

-或者-

```
$SIG{$_} = 'DEFAULT' for keys %SIG; 
```

-或者-

```
$_ = 'DEFAULT' for values %SIG; 
```

* * *

第三个问题

```
use Config qw( %Config );

my @sig_name_by_num;
@sig_name_by_num[ split(' ', $Config{sig_num}) ] = split(' ', $Config{sig_name});

my $sig_num = $? & 0x7F;
$SIG{$sig_name_by_num[$sig_num]} = 'DEFAULT';
kill($sig_num => $$); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T23:01:58.210

If you just want to set all signals at once, you don't need to know their numbers:

```
$SIG{$_} = 'DEFAULT' for keys %SIG; 
```

Using `$Config{sig_name}/$Config{sig_num}` is the only portable way to map signal numbers to names, but a quick and dirty way that works on many Unix-y systems is

```
$sig_name = qx(kill -l $sig_num); 
```

(`$sig_name` will then have a trailing newline, so in practice you'd want to do something like

```
chomp($sig_name = qx(kill -l $sig_num));
($sig_name) = qx(kill -l $sig_num) =~ /(\S+)/; 
```

)

That's not necessarily any more concise than using `%Config`, though, unless you turned it into a function.

```
sub sig_no { chomp(my ($sig_no = qx(kill -l $_[0])); $sig_no }

$SIG{ sig_no($ret & 127) } = 'DEFAULT';
... 
```

# c# - 解析 .gz 站点地图

> ID：11621145
> 
> 赞同：0
> 
> 时间：2012-07-23T21:55:41.870
> 
> 标签：c#, xml, winforms, gzip, sitemap

我正在尝试解析包含站点地图列表的站点地图索引。

我成功解析了 sitemapindex.xml 并获得了 .gz 链接列表；但我想知道将它们打开为 xml 的最佳方式是什么？

```
 String sitemap = "http://www.site.com/siteindex.xml";
        XmlDocument xml = new XmlDocument();
        xml.Load(sitemap);
        XmlNamespaceManager manager = new XmlNamespaceManager(xml.NameTable);
        manager.AddNamespace("s", xml.DocumentElement.NamespaceURI); //Using xml's properties instead of hard-coded URI 
        XmlNodeList xnList = xml.SelectNodes("/s:sitemapindex/s:sitemap", manager);

        var parallelLoop1 = xnList.Count;
        Parallel.For(0, parallelLoop1, parOptions, index =>
        {
            String NAME = xnList[index]["loc"].InnerText;
            System.Net.HttpWebRequest req = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(NAME);
            req.Timeout = 1000 * 60 * 60; // milliseconds 
            System.Net.WebResponse res = req.GetResponse();
            Stream responseStream = res.GetResponseStream();
            XmlDocument xml2 = new XmlDocument();
            xml2.Load(responseStream); //this is the part where it fails- file is .gz, but xml expected
            responseStream.Close();
    ......... more code
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T17:09:43.433

这就是我解决它的方法，：

```
 GZipStream zip = new GZipStream(responseStream, CompressionMode.Decompress);
            XmlDocument xml2 = new XmlDocument();
            xml2.Load(zip); 
```

这是我的最终代码：

```
 String sitemap = "http://www.site.com/siteindex.xml"; 
    XmlDocument xml = new XmlDocument(); 
    xml.Load(sitemap); 
    XmlNamespaceManager manager = new XmlNamespaceManager(xml.NameTable); 
    manager.AddNamespace("s", xml.DocumentElement.NamespaceURI); //Using xml's properties instead of hard-coded URI  
    XmlNodeList xnList = xml.SelectNodes("/s:sitemapindex/s:sitemap", manager); 

    var parallelLoop1 = xnList.Count; 
    Parallel.For(0, parallelLoop1, parOptions, index => 
    { 
        String NAME = xnList[index]["loc"].InnerText; 
        System.Net.HttpWebRequest req = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(NAME); 
        req.Timeout = 1000 * 60 * 60; // milliseconds  
        System.Net.WebResponse res = req.GetResponse(); 
        Stream responseStream = res.GetResponseStream(); 
            GZipStream zip = new GZipStream(responseStream, CompressionMode.Decompress);
            XmlDocument xml2 = new XmlDocument();
            xml2.Load(zip);
        responseStream.Close(); 
......... more code 
    } 
```

# android - 在数据库 SQLite（对于 Android）中添加一个 txt 文件，如何？

> ID：11621148
> 
> 赞同：1
> 
> 时间：2012-07-23T21:55:50.263
> 
> 标签：android, file, sqlite

我是否应该将保存在手机sd卡中的txt文件放在Android的数据库SQLite中，但我不知道该怎么做，请帮助我，我写了几行代码来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:40:31.790

转换`File`为`byte[]`，然后将其作为`BLOB`数据添加到 sqlite 中。也许你应该将它们`Base64`转换为空间优化格式，你应该没问题。

正如你所看到的，实现这样的事情有多个步骤，所以我只是添加了一般概述。如果您遇到问题，请询问更多细节。

编辑：我将提供关键点的代码。

要将文件转换为 byte[]，请使用以下代码段：

```
InputStream is = new FileInputStream(file); // where file is the .txt you want to convert
ByteArrayOutputStream bos = new ByteArrayOutputStream();
byte[] b = new byte[1024];
while ((int bytesRead = is.read(b)) != -1) {
   bos.write(b, 0, bytesRead);
}
byte[] bytes = bos.toByteArray(); 
```

将 byte[] 转换为 base64 字符串：

```
String dataToSave = Base64.encodeToString(bytes, Base64.DEFAULT); 
```

或者

```
byte[] dataToSave = Base64.encode(bytes, Base64.DEFAULT); 
```

尽管您必须至少有 2.2 版才能支持 base 64 编码。

如果您选择了第一个实现，那么您的 sqlite 表中的任何 TEXT 字段就足够了，否则在您的表中创建一个列作为 BLOB。在创建`ContentValues`您要插入的内容时，添加`values.put(KEY, dataToSave);`.

获取数据：

做相反的操作：1）从 sqlite 获取数据，2）转换为 byte[]，3）转换为文件。

转换`byte[]`为`File`：

```
FileOutputStream out = new FileOutputStream(path); //file path as string
out.write(data); //data is the byte[]
out.flush();
out.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:40:23.017

如果文本文件包含数据行。例如

```
 <ISBN>, <Title>, <Author>, <Price> 
```

然后你应该把它作为表存储在 sqLite 中。为什么？因为 SQLite 无论如何都是一个文件数据库，一旦你在 SQLite 中存储为一个表，你就可以使用 SQLite 的强大功能以各种方式查询数据。添加删除行等。

按照此处的步骤，告诉我们您遇到的问题。 [http://www.vogella.com/articles/AndroidSQLite/article.html](http://www.vogella.com/articles/AndroidSQLite/article.html)

如果您只是想要一种简单的方法来保存文本的值，您应该将其读入字符串并使用 SharePreferences 保存字符串。

无论如何，第一步是从 SD 卡中读取文件。

# ios - 滚动过去的内容边界时，防止 UITableView 的部分标题做奇怪的事情吗？

> ID：11621149
> 
> 赞同：0
> 
> 时间：2012-07-23T21:55:59.280
> 
> 标签：ios, cocoa-touch, uitableview

让我详细说明“奇怪的东西”。我的应用程序有一个表格视图，里面有东西，就像大多数表格视图一样。屏幕顶部还有一个半透明的黑条，通过它滚动可以看到表格视图内容，就像 iPhone 照片应用程序一样。

所有这些都可以正常工作，除了当节标题视图滚动到顶部栏时，它会被向上推，并且下一个节标题会浮在顶部。上一节标题最终被向上推，在应有的位置留下一个小间隙。我想这是一直发生的事情，但它现在才可见，因为我正在显示内容区域之外的部分表格视图。

我知道这很难用语言来解释，所以这里有图片：

![](../Images/26fd6fbeeab506d788ee1028e76f6900.png)

到目前为止一切看起来都很好......

![](../Images/b483498997dd37546143f3ee5f7a26d2.png)

..突然，导航栏后面出现了一个巨大的白色缺口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T21:59:47.583

您可以将 tableview 边界设置为不隐藏在半透明栏下，例如：

```
tableView.frame = CGRectMake(0, 44, self.frame.size.width, self.frame.size.height-44); 
```

或者你可以让栏不透明，我想。

# android - iPhone 或 Android 应用程序，不适用于 Google 或 Apple Store

> ID：11621153
> 
> 赞同：0
> 
> 时间：2012-07-23T21:56:10.370
> 
> 标签：android, iphone, app-store, google-play

只是为更多设备编写应用程序并且不想上市 Google Play Store 或 Apple App Store 的人是做什么的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T21:58:47.267

对于 Android，您只需要 Android SDK、Eclipse 和 ADT 插件。您无需靠近 Play 商店/市场即可制作完整的 Android 应用程序。

至于iOS，我不知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T21:59:29.920

取决于你想要达到什么。一般来说，您主要受到使用这些替代商店的人数的限制，并且在某些情况下，实际安装它们要困难得多。

对于苹果：

*   您可以在[Cydia](http://cydia.saurik.com/)商店中发布越狱 iOS 设备

对于 Android，有许多替代市场，例如： http: [//www.howtogeek.com/106175/the-top-5-alternatives-to-the-android-market/](http://www.howtogeek.com/106175/the-top-5-alternatives-to-the-android-market/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T22:36:13.207

对于**Android**，只需编写应用程序并在您的企业[内部通过电子邮件](http://www.talkandroid.com/guides/beginner/install-apk-files-on-android/)[分发。`APK`](http://www.talkandroid.com/guides/beginner/install-apk-files-on-android/)至于**Apple**看起来你必须使用他们的[iOS Developer Enterprise Program](https://developer.apple.com/programs/ios/enterprise/)才能正确地做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T15:22:56.057

对于 android，您可以在 PlayMarket 或 Amazone 应用商店上发布您的应用。或者您可以使用 eclipse 创建您的 apk 文件并将其发布在互联网上的任何地方，对您自己没有任何利润（或通过添加赚钱）。

除非您只是在真实设备上测试您的应用程序（每月花费 99 美元，并且是完整开发者帐户的一部分），否则您无法在 iPhone 上获取 ios 应用程序而不是从 Apple Appstore 获取 ios 应用程序。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-23T22:02:22.647

那个人可以在模拟器或他自己的设备上运行他的应用程序。他还可以在其他人的设备上运行他的应用程序，添加他的设备并与他共享您的配置文件就足够了。但请注意：

> 重要提示：如果您将预发布的 Apple 软件提供给除员工、承包商和组织成员以外的任何注册为 Apple 开发者并且有明显需要了解或使用 Apple 软件的人，则您的 iOS 开发者计划会员资格可能会被终止代表您开发和测试应用程序。禁止未经授权分发 Apple 机密信息（包括预发布的 Apple 软件），这可能会使您承担民事和刑事责任。

# java - 有些 jar 文件通过双击运行，有些则没有

> ID：11621154
> 
> 赞同：2
> 
> 时间：2012-07-23T21:56:16.050
> 
> 标签：java, windows, eclipse, jar, swt

我开始使用 SWT (eclipse.org/swt)。将我的项目导出到可运行的 jar 仅通过命令行运行，即`java -jar filename.jar`. 但是，当我双击它时不起作用。但同时，我可以双击其他罐子，它们运行得非常好！
这个罐子有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-07-15T11:05:59.343

不要打扰 Windows 中的可运行 jar，而是使用 launch4j 创建一个 .exe 并运行它。如果您遇到问题，请单击launch4j 中的播放按钮运行.exe，因为launch4j 为您提供了一个控制台来显示错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:21:38.483

由于 .jar 文件包含许多 .class 文件，java 如何知道要运行哪个类？

答案是您需要一个名为 META-INF/MANIFEST.MF 的清单文件。将其放入 .jar 文件的根目录，然后添加如下一行：

```
 Main-Class: com.something.MyApp 
```

你只需要一条线。您还可以输入其他内容，例如应用程序版本、任何特殊的类路径（如果需要）等。检查您的 .jar 文件并查看该文件是否存在——如果不存在，则必须创建它。

您还可以使用 Eclipse Wizards 来帮助您创建 MANIFEST.MF 文件。只需右键单击您的项目，选择导出 | Jar 文件，然后按照向导页面进行操作。使用“下一步”而不是“完成”，因为选择主类的选项位于非必需页面之一上。

你说你的 MANIFEST.MF 有这样的行

```
 Rsrc-Main-Class: Main
    Main-Class: org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader 
```

这意味着当您执行 .jar 时。它在 Eclipse 提供的 JarRsrcLoader 类中查找 main() 方法。当您在运行 Eclipse 时运行 .jar 时，该类可能在您的路径中。但我认为如果你停止 Eclipse，它不会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-13T14:02:58.357

命令行使用的java和双击使用的java可能是2个不同版本的java。从命令行检查使用哪个版本：java -version。

对于双击时使用的 java，请使用 Windows SDK 工具 - 文件类型验证器。

一旦你有了它，你应该能够从命令行重现错误。那你可能有更多的输出。

# javascript - 访问当前正在执行的“请求”或“线程”，就好像它在 Node.js 中是全局的一样？

> ID：11621158
> 
> 赞同：2
> 
> 时间：2012-07-23T21:56:43.460
> 
> 标签：javascript, ruby-on-rails, node.js, global-variables, process

在 Rails 中，当前线程被大量用于存储全局变量（我知道，全局变量是邪恶的，但它们有时是必要的）。

```
Thread.current[:authlogic_scope] = scope 
```

以下是它使用的一些地方：

*   [active_record/scoping.rb#L18](https://github.com/rails/rails/blob/15bfaa3d13f84c689f9182c0be658ddde019e572/activerecord/lib/active_record/scoping.rb#L18)
*   [authlogic/session/activation.rb#L29](https://github.com/binarylogic/authlogic/blob/40c0e16d13329a9a1dc81a1598e5eaa38a7acc39/lib/authlogic/session/activation.rb#L29)

问题是，你能在 Node.js 中做类似的事情吗？具体来说，在一个快递应用程序中。

**保持对当前请求（或当前线程）的引用的最佳方法是什么？**

在 express 中，您将回调与请​​求/响应对象一起使用，以避免必须设置全局变量，这是有道理的：

```
var express = require('express');
var app = express.createServer();

app.get('/', function(request, response) {
  response.send('Hello World');
}); 
```

这个问题是关于构建用于缓存数据库记录的“身份映射”（范围为当前 HTTP 请求/当前用户）。在 Rails 中，他们可以通过保持身份映射范围为 来做到这一点`Thread.current`，因为一切都是同步的。有没有办法在 Node.js 中做到这一点？

一种方法是将`request`周围传递给每个函数。对于我的特殊情况，这太复杂了，如果可能的话，我想避免这种情况。

另一种方法是重新定义您将在自定义 javascript 函数中使用的所有变量，类似于您查看模板的方式（使用模板定义感觉像全局变量的变量）。但是对于我的特殊情况，这将比帮助更令人困惑。

第三种方法是将其设置为仅当前 HTTP 请求或当前线程可访问的某个全局变量。这在 Node.js 中可行吗？如果不是，还有什么其他方法可以完成同样的事情？

基本上，我希望能够做到

```
App.User.where({createdAt: {'>=': _(2).days().ago()}}).all() 
```

并让它在内部检查一些`process.CURRENT_REQUEST`范围为当前请求的node.js，`App.User`查询可以在其中存储它的结果（并且任何其他模型都可以存储它们的结果，因此如果再次请求它们，它不会命中数据库）。我还希望能够`currentUser`像 Authlogic 一样进行传递，因此每当创建记录时，例如，该`createdById`字段将被设置为`process.CURRENT_REQUEST.currentUser`自动（内部）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:01:48.933

你说的不是线程。JavaScript 是单线程的，所以 node 是单线程的。我并不是要挑剔，但是如果您使用他们学到的术语，人们会更好地理解您。“线程”和“进程”这两个词在操作系统级别已经过于繁重，最好避免使用它们，除非这真的是我们的意思。

在节点中传递整个请求对象是很常见的。

您尚未提供构建此身份映射的强大用例。你能详细说明吗？

如果您确实需要跟踪单个回调，则可以使用 guid-generator。当然，您必须将这些指南存储在某个地方，并且根据您的操作方式，您最终可能会造成扩展瓶颈。

啊..我现在看到您的编辑...您在哪里写“ App.User 查询可以存储其结果的位置（并且任何其他模型都可以存储其结果，因此如果再次请求它们，它不会命中数据库）。 " 你已经在一个非常高的水平上思考。这不是一个 node.js 问题，而是一个框架问题。我的意思是，node.js 是一个低级工具包，将自己作为高级框架推销。它基本上是一个带有线程池支持的事件循环的 javascript 混搭。顺便说一句，那将是操作系统线程。我认为您的问题的答案可能是，如果您希望避免对数据库造成额外的打击，您需要在对象中明确提供缓存。据我所知，节点中没有高级魔法。我知道这真的没有帮助，

回复：全局变量。只是不要这样做。朋友不要让他们的朋友写信给全球。:)

# python - 按整数索引 pandas 数据帧

> ID：11621165
> 
> 赞同：11
> 
> 时间：2012-07-23T21:57:01.793
> 
> 标签：python, pandas

我似乎找不到一种通过整数索引[索引](http://pandas.pydata.org/pandas-docs/stable/indexing.html)a的优雅方法。[`pandas.DataFrame`](http://pandas.pydata.org/pandas-docs/stable/dsintro.html)在下面的示例中，我想从`'A'`列的第一个元素中获取值“a”。

```
import pandas
df = pandas.DataFrame(
    {'A':['a','b', 'c'], 'B':['f', 'g', 'h']}, 
    index=[10,20,30]
    ) 
```

我希望`df['A'].ix[0]`两者`df['A'][10]`都会回来`'a'`。`df['A'][10]`确实返回，`'a'`但`df['A'].ix[0]`抛出一个`KeyError: 0`. 我能想到的`'a'`根据索引 0 获取值的唯一方法是使用以下方法。

```
df['A'][df['A'].index[0]] 
```

是否有更短的方法可以`'a'`使用 0 索引退出数据框？

**更新**

从 pandas 0.11 开始，还有另一种[按 integer 索引的](http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-integer)方法。

```
df.iloc[0] # integer based, gives the first row
df.loc[10] # label based, gives the row with label 10 
```

这[取代](http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecations)了该`irow`方法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-24T00:38:29.687

您收到错误，`df['A'].ix[0]`因为您的索引不是从 0 开始，而是从 10 开始。您可以使用以下任一方法获得所需的值

```
df['A'].ix[10]
df['A'].irow(0) 
```

第一次使用正确的索引。我怀疑第二个命令是您想要的，它通过行号而不是索引值查找值，并且从技术上讲，它只比`df['A'].ix[0]`工作时长两个字符。

或者，您可以重置索引，以便它们以您期望的方式响应`df['A'].ix[0]`：

```
df2=df.reset_index() 
```

这将保留您的旧索引（10、20 等），方法是将它们移动到 df2 数据框中名为“索引”的列中。然后`df2['A'].ix[0]`将返回'a'。如果要删除旧的基于 10 的索引，可以将标志`drop=True`插入 reset_index 函数的括号中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-25T12:54:18.327

在较新的 pandas 版本中，您还可以使用 df["A"].iat(0)。

# javascript - 将 4 个简短的 JavaScript 表单验证合并到一个脚本中

> ID：11621167
> 
> 赞同：-5
> 
> 时间：2012-07-23T21:57:15.193
> 
> 标签：javascript, validation

我不知道java，但这对于知道的人来说看起来很容易。我需要验证联系表单，并且我有这些验证脚本，但如果我输入此脚本的多个实例，它们不会运行，如果只使用其中一个实例，它们就可以正常工作。有人可以将这 4 个组合成一个验证脚本吗？

**验证名称字段**

```
<script type="text/javascript">
function validateForm()
{
var x=document.forms["myForm"]["name"].value;
if (x==null || x=="")
  {
  alert("Name must be filled out");
  return false;
  }
}
</script> 
```

**验证主题字段**

```
<script type="text/javascript">
function validateForm()
{
var x=document.forms["myForm"]["subject"].value;
if (x==null || x=="")
  {
  alert("Subject must be filled out");
  return false;
  }
}
</script> 
```

**验证消息字段**

```
<script type="text/javascript">
function validateForm()
{
var x=document.forms["myForm"]["message"].value;
if (x==null || x=="")
  {
  alert("Message must be filled out");
  return false;
  }
}
</script> 
```

**验证电子邮件字段**

```
<script type="text/javascript">
function validateForm()
{
var x=document.forms["myForm"]["email"].value;
var atpos=x.indexOf("@");
var dotpos=x.lastIndexOf(".");
if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length)
  {
  alert("Not a valid e-mail address");
  return false;
  }
}
</script> 
```

**以及您的典型联系表格**

```
<form name="myForm" method="POST" onsubmit="return validateForm()" >
<input type="text" name="name">
<input type="text" name="email">
<input type="text" name="subject">
<textarea name="message"></textarea>
<input type="submit" value="Send Message" name="submit">
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T08:33:50.960

This is how I got it work

```
<script type="text/javascript">
function validateForm()
{
var x=document.forms["myForm"]["name"].value;if (x==null || x==""){alert("Name must be filled out");return false}
var x=document.forms["myForm"]["email"].value;var atpos=x.indexOf("@");var dotpos=x.lastIndexOf(".");if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length){alert("Not a valid e-mail address");return false;}
var x=document.forms["myForm"]["subject"].value;if (x==null || x==""){alert("Subject must be filled out");return false}
var x=document.forms["myForm"]["message"].value;if (x==null || x==""){alert("Message must be filled out");return false}
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:11:27.193

Something like;

```
var validation = ["name","subject","message","email"];   
validation.forEach(
    x=document.forms["myForm"][this];
    if(this=="email"){
        var atpos=x.indexOf("@");
        var dotpos=x.lastIndexOf(".");
        if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length){
             alert("Not a valid e-mail address");
             return false;
        }
   }else{
        if (this==null || x==""){
            alert(this.toUpperCase()." must be filled out");
            return false;
        }
    }
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T02:11:41.877

您可以使用条件“if”使其在一个函数中工作，使用表单中的提交事件调用该函数，我认为它比您想象的最简单和容易，这是一个简单表单的示例：

```
<form action="insert.php" name="contact" onsubmit="return valida_frm(this)" method="post">

               <input name="personname" type="text"/>
               <input name="personemail" type="email"/>                  
               <textarea name="message"></textarea>
               <input type="submit" value="Send">

            </form> 
```

然后在“head”标签之间添加函数

```
<script language="javascript">
function valida_frm(form){
var alert="Error:\n";
if (form.personname.value == "") {alert+="Name can't be empty.\n";} 
if (form.personemail.value == "") {alert+="E-Mail can't be empty.\n";}
if (form.message.value == "") {alert+="Message can't be empty.\n";}
if (alert!="Error:\n"){
    alert(alert);   
    return false;
}else{
    return true;
}   
}
</script> 
```

您可以使用这种方式来验证输入值并将其发送到您的邮件程序。我希望这对你有帮助。

# c# - 匹配系统和向外扩展的架构

> ID：11621168
> 
> 赞同：2
> 
> 时间：2012-07-23T21:57:16.457
> 
> 标签：c#, asp.net, architecture, scalability

我有一个网站，用户选择某个标准来在该网站上找到另一个用户，然后网站将您与同样在寻找具有相同标准的人的其他人配对。有一个“未配对”用户集合（尚未配对），每次有人提出配对请求时，程序都会根据匹配条件检查集合中的下一个可用用户，并删除该用户如果匹配，则从“未配对”集合中提取，如果没有，则将用户添加到“未配对”集合中。

我的问题是，根据以下标准处理此类集合的最佳方法是什么？

*   匹配过程是实时的，所以我使用 SignalR 之类的东西来处理实时配对
*   如果系统关闭，则不需要保留该集合，因为系统已关闭，因此不会有用户“搜索”未配对的用户
*   如果我横向扩展服务器并拥有多个实例，它们都必须能够从同一个集合中拉出
*   如果 2 个用户同时请求处理并发（不知道我是否需要）

当我仔细考虑这个问题时出现的一些标准问题是：

*   我什至需要一个数据库，因为不断添加和删除用户

*   如果我确实需要某种存储，像 mongodb 这样的东西会是一个不错的选择吗？为什么？

*   如果我将集合存储在内存中，那么如果我向外扩展，那将无法跨不同的实例工作，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:24:37.977

*   您将需要处理并发问题 - 一旦您找到了要配对的用户，您将要锁定该用户，验证它仍然未配对，将它们配对，然后解锁。否则，当您第一次查看未配对的用户时，您会冒着风险，当您将他们配对时，他们已经被占用了。
*   目前尚不清楚配对会产生什么副作用 - 但似乎您并不真正关心过去的现在（即如果服务器出现故障 - 配对是无关紧要的）。这听起来像是一个内存操作，可能为了记录/分析的目的而持久化到数据库。
*   关于不同的实例，如果它在内存中，您仍然可以在服务器上执行它（map/reduce 公式可以在内存中工作，并且可能还有很多其他的）。您还可以构建您的解决方案，将您的用户存储在不同的服务器上，AN 在 server1 上，OZ 在 server2 上（如果这对您的数据有意义）。您还可以将配对所需的数据减少到最低限度，并拥有一台服务器（如您所愿）来处理配对，将配对后发生的任何事情都卸载到任何地方。

抱歉有点通用，对您的数据/用例没有更多了解

# html - 当我关闭浏览器窗口而不是简单地消失时，我的导航栏中的图像彼此下方。为什么？

> ID：11621177
> 
> 赞同：1
> 
> 时间：2012-07-23T21:57:52.327
> 
> 标签：html, css, uinavigationcontroller, navigation

我的 html 很简单：

```
<div class="navigation">
    <li><a id="button" href="#" <img src=""></a></li>
    <li><a id="button2"  href="#" <img src=""></a></li>
    <li><a id="button3"  href="#" <img src=""></a></li>
</div> 
```

我的CSS是：

```
.navigation {
margin-top:35px;
margin-left: -290px;
list-style-type: none;
}

.navigation li{
display: inline;
}

#button, #button2, #button3 {

-webkit-border-radius: 3px;
-moz-border-radius: 3px;
border-radius: 3px;
text-shadow: 1px 1px 0px rgba(0, 0, 0, 0.5);
padding: 30px;
float: left;
margin-left: 390px;
}

#button{
 background-image: url("../images/homebutton.png");
}
#button2 {
background-image: url("../images/gmailbutton.png");
background-repeat: no repeat;
}
#button3 {
background-image: url("../images/blogbutton.png");
} 
```

现在浏览器窗口打开时看起来很好，但是当我关闭窗口时，图像开始垂直堆叠，而不是在窗口翻转时消失。有任何想法吗？？？谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:02:05.797

假设您将`.navigation`元素更改为 a `ul`or `ol`（有效性很重要），那么您可以简单地添加：`white-space: nowrap;`强制元素全部出现在一行上，而不是包装（作为一个`inline`元素自然会，并且应该）：

```
.navigation {
    margin-top:35px;
    margin-left: -290px;
    list-style-type: none;
    white-space: nowrap;
} 
```

[JS Fiddle 概念验证](http://jsfiddle.net/davidThomas/M9YNw/)。

请注意更正`a`和`img`标签。

# javascript - 从 rallygrid 中获取选定的用户故事

> ID：11621181
> 
> 赞同：1
> 
> 时间：2012-07-23T21:58:32.163
> 
> 标签：javascript, rally

我正在使用以下代码：

```
launch: function() {
    Rally.data.ModelFactory.getModel({
        type: 'UserStory',
        success: function(model) {
            this.down('#gridContainer').add({
                xtype: 'rallygrid',
                model: model,
                columnCfgs: [
                    {
                        text: 'ID',
                        dataIndex: 'FormattedID',
                        width: 75
                    },
                    {
                        text: 'Name',
                        dataIndex: 'Name',
                        width: 500,
                        listeners: {
                            click: this._showTasks,
                            scope: this
                        }
                    }
                ]
            });
        },
        scope: this
    });
} 
```

当用户从网格中单击用户故事时会调用函数 _showTasks，但我无法获取他们单击的用户故事的 ID。如果我*console.log(this)我可以看到 ID 存储在一个名为**selected*的项目数组中，但我不确定该属性的路径。我还觉得可能有一种更简单的方法可以从网格中获取最近选择的用户故事？

最终目标是列出所选用户故事的所有子任务，或者在另一个拉力网格中，或者直接将它们打印到正文中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T12:18:27.943

而不是在列上注册点击处理程序，您应该能够在网格上注册选择处理程序：

```
{
    xtype: 'rallygrid',
    //...
    //more grid config
    //...
    listeners: {
        select: this._onSelect,
        scope: this
    }        
} 
```

然后在您的 onSelect 处理程序中，您有记录：

```
_onSelect: function(rowModel, record, rowIndex, options) {
    var id = record.get('ObjectID');
} 
```

# asp.net-mvc - 带有 EF5rc 模型的 MVC 在单独的项目中？

> ID：11621188
> 
> 赞同：0
> 
> 时间：2012-07-23T21:59:10.387
> 
> 标签：asp.net-mvc, entity-framework-5

我正在努力加快 EF5 和 MVC 的速度，所以请多多包涵。在 DB 优先环境中使用 EF 5rc 和 MVC4。

我想将 EF 代码放在一个单独的项目中，以便我可以使其可重用于其他项目。

我正在寻找的是如何将 EF 项目中的单独 DLL 用于 MVC 项目的模型部分的示例或示例。

我对如何在 RF 项目或 MVC 项目中创建上下文感到困惑？

任何其他提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T00:20:34.827

这是您需要做的：

1.  创建一个库项目来保存 EF 数据访问实现
2.  创建一个 MVC 4 项目
3.  使用 MVC 项目中的项目引用来引用 EF 项目
4.  在 MVC 项目中根据需要新建上下文

[这篇博客文章](http://blog.appharbor.com/2012/04/24/automatic-migrations-with-entity-framework-4-3)详细描述了如何进行此操作。还有一个[截屏视频](http://blog.appharbor.com/2012/05/18/screencast-automatic-migrations-with-entity-framework-4-3)。它使用 Code First，但只是为了支持 Database First 的东西而抽出那部分。

# ruby-on-rails - Rails Diffy Gem：如何使用 CSS

> ID：11621189
> 
> 赞同：6
> 
> 时间：2012-07-23T21:59:10.173
> 
> 标签：ruby-on-rails

我正在使用 diffy（[点击查看 github](https://github.com/samg/diffy)）。太棒了，但我不知道如何使用附带的 css 添加颜色。自述文件提到可以做到这一点，但我不确定如何利用他们的 css。

我很确定这是可能的，因为[这家伙谈论它](http://drasticcode.com/2010/11/26/the-easiest-way-to-diff-two-strings-in-ruby)。

以前有没有人使用过diffy的颜色？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-22T19:13:38.783

在您看来，请输入：

```
<style>
  <%= Diffy::CSS %>
</style> 
```

然后你可以复制

# java - @Inject + @Qualifier 与 @Inject 实现

> ID：11621190
> 
> 赞同：3
> 
> 时间：2012-07-23T21:59:19.360
> 
> 标签：java, cdi, inject, qualifiers

使用限定符和仅指定所需的确切实现类有什么不同？

这个问题复制自：[http ://docs.jboss.org/weld/reference/latest/en-US/html/injection.html](http://docs.jboss.org/weld/reference/latest/en-US/html/injection.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:06:35.420

一般来说，**Qualifiers 形成了**各方之间的脱钩层。这允许您更改一侧的实现而不更改另一侧。

```
However, I find it very rare to actually have more than one implementation class. 
```

这取决于用例。虽然您可能对业务逻辑的大多数“内部”类是正确的（会有一个`MailService`，而不是两个或三个），但通常有一些**beantypes 有多个 implementation**。

```
@Inject @LDAP
private AuthenticatorService 
```

对比

```
@Inject @FormBased
private AuthenticatorService 
```

**已经提到**了为不同的部署场景模拟/提供不同的bean 。****

 **此外，您几乎肯定会拥有类似这样的某种逻辑，其中限定符**讲述“故事的一部分”**并使代码可读且结构化：

```
@Inject @Authenticated
private User user; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:11:23.930

Functionally, they're the same. However, I find it very rare to actually have more than one implementation class. You'll find dependency injection to be much more useful when you're unit testing your classes. Dependency Injection allows you to easily inject a regular implementation instance during run-time. Then in your unit tests, when you're manually constructing your object to test, you can easily pass in a mock implementation.**

# javascript - 如何确保在特定 div 中至少选中一个复选框？

> ID：11621191
> 
> 赞同：2
> 
> 时间：2012-07-23T21:59:25.957
> 
> 标签：javascript, jquery

我有一个`<div class="answer" id="yesOptions">`并且我需要检查是否选中了此特定内容中的至少 1 个复选框。如果没有，我需要返回`alert('At least 1 checkbox must be checked from this div!');`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T22:03:24.790

怎么样

```
var checkedboxes = $('#yesOptions :checkbox:checked').length;

if (checkedboxes === 0){
    alert('At least 1 checkbox must be checked from this div!');
} 
```

**演示在** [http://jsfiddle.net/f8UhA/](http://jsfiddle.net/f8UhA/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:05:02.453

**工作演示** [http://jsfiddle.net/gvbX5/](http://jsfiddle.net/gvbX5/)

您可以使用分组，如下面的示例代码和上面的演示，希望它有助于事业。

好的链接：

[在 jQuery 1.7 中取消选中复选框的正确方法是什么？](https://stackoverflow.com/questions/9950123/what-is-the-proper-way-to-uncheck-a-checkbox-in-jquery-1-7)

[JQuery - 至少选中一个复选框](https://stackoverflow.com/questions/2941746/jquery-is-at-least-one-checkbox-checked)

**代码**

```
$('input').change(function() {
    if ($("[name=group1]:checked").length > 0){

    }else{
        alert('select atleast one checkbox');
    }
});

 if ($("[name=group1]:checked").length == 0)
        alert('select atleast one checkbox');

<input type="checkbox" name="group1" value="1"/>
<input type="checkbox" name="group1" value="2" />
<input type="checkbox" name="group1" value="3" />​
​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T22:13:12.697

You can actually just do:

```
if (!$("[type='checkbox']", "#yesOptions").is(':checked'))​ 
    alert('At least 1 checkbox must be checked from this div!');​ 
```

[FIDDLE1](http://jsfiddle.net/D6QUp/)

[FIDDLE2](http://jsfiddle.net/D6QUp/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T22:03:01.577

`$("input[type=checkbox]:checked", $("#yesOptions")).length`将为您提供在该 div 中选中的复选框的数量。

# magento - 通过 API 创建 Magento 优惠券

> ID：11621194
> 
> 赞同：3
> 
> 时间：2012-07-23T21:59:34.830
> 
> 标签：magento

有没有一种已知的方法可以通过 API 在 Magento 社区版中创建新的优惠券代码（购物车价格规则）？

我希望能够使用另一个 web 应用程序自动生成优惠券代码，并通过一些后端通信同时在 Magento 中创建它们。据我所知，默认 API 对此不提供支持。

有谁知道如何去做？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T16:55:11.273

这是我用来创建多个折扣代码的脚本。

```
require_once '../app/Mage.php';
Varien_Profiler::enable();
Mage::setIsDeveloperMode(true);
ini_set('display_errors', 1);

umask(0);
Mage::app();

$code = $code = generateUniqueId(10); //coupon code
$amount = 10;   // discount amount

generateRule( $code, $amount, 'label', date('Y-m-d'));

function generateRule($code, $amount, $label, $from_date = '', $to_date = '', $name = ''){

    $name = (empty($name))? $label : $name;
    $labels[0] = $label;//default store label

    $coupon = Mage::getModel('salesrule/rule');
    $coupon->setName($name)
    ->setDescription($name)
    ->setFromDate($from_date)
    ->setToDate($to_date)
    ->setCouponCode($code)
    ->setUsesPerCoupon(1)
    ->setUsesPerCustomer(1)
    ->setCustomerGroupIds(getAllCustomerGroups()) //an array of customer grou pids
    ->setIsActive(1)
    //serialized conditions.  the following examples are empty
    ->setConditionsSerialized('a:6:{s:4:"type";s:32:"salesrule/rule_condition_combine";s:9:"attribute";N;s:8:"operator";N;s:5:"value";s:1:"1";s:18:"is_value_processed";N;s:10:"aggregator";s:3:"all";}')
    ->setActionsSerialized('a:6:{s:4:"type";s:40:"salesrule/rule_condition_product_combine";s:9:"attribute";N;s:8:"operator";N;s:5:"value";s:1:"1";s:18:"is_value_processed";N;s:10:"aggregator";s:3:"all";}')
    ->setStopRulesProcessing(0)
    ->setIsAdvanced(1)
    ->setProductIds('')
    ->setSortOrder(0)
    ->setSimpleAction('cart_fixed')
    ->setDiscountAmount($amount)
    ->setDiscountQty(null)
    ->setDiscountStep('0')
    ->setSimpleFreeShipping('0')
    ->setApplyToShipping('0')
    ->setIsRss(0)
    ->setWebsiteIds(getAllWbsites())
    ->setCouponType(2)
    ->setStoreLabels($labels)
    ;
    $coupon->save();
}

function getAllCustomerGroups(){
    //get all customer groups
    $customerGroupsCollection = Mage::getModel('customer/group')->getCollection();
    $customerGroupsCollection->addFieldToFilter('customer_group_code',array('nlike'=>'%auto%'));
//    $customerGroupsCollection->load();
    $groups = array();
    foreach ($customerGroupsCollection as $group){
    $groups[] = $group->getId();
    }
    return $groups;
}

function getAllWbsites(){
    //get all wabsites
    $websites = Mage::getModel('core/website')->getCollection();
    $websiteIds = array();
    foreach ($websites as $website){
    $websiteIds[] = $website->getId();
    }
    return $websiteIds;
}

function generateUniqueId($length = null){
    $rndId = crypt(uniqid(rand(),1));
    $rndId = strip_tags(stripslashes($rndId));
    $rndId = str_replace(array(".", "$"),"",$rndId);
    $rndId = strrev(str_replace("/","",$rndId));
    if (!is_null($rndId)){
        return strtoupper(substr($rndId, 0, $length));
    }
    return strtoupper($rndId);
} 
```

该代码几乎记录在案。

[Magento API](http://www.magentocommerce.com/api/rest/introduction.html)不支持销售规则。

# html - 需要自动打印查询结果的列名

> ID：11621196
> 
> 赞同：1
> 
> 时间：2012-07-23T21:59:57.810
> 
> 标签：html, sql, asp-classic

```
strUserQuery = request.querystring("UserQuery")
strQueryToBeExecuted = "Select * from (" & strUserQuery & ") where rownum < 501" 
```

查询运行时如何自动打印表的标题？我尝试打印第一行，但查询结果中没有列名。

我也尝试过使用 desc （表名），但这也不起作用。如果有人可以指导我，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T08:31:07.627

您是否将数据放入记录集中？如果是这样，请尝试：

```
For Each field in recordset.fields
Response.write field.name & "<br />"
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:12:48.817

Are you pulling it into excel or just having a query.If you just having a query it shows up automatically. Or if you are doing it on code we just need data not the column names as it automatically takes it.

# php - 如何向 URL 添加标志？

> ID：11621198
> 
> 赞同：1
> 
> 时间：2012-07-23T22:00:21.787
> 
> 标签：php, string, concatenation, string-concatenation, flags

我正在建立一个网站，访问者会看到一个闪屏，他们将在其中为实际网站选择配色方案；根据他们的选择，实际网站将加载不同的样式表。我认为这可以通过将标志连接到 URL 来完成，然后在下一页上读取标记的 URL 以确定要加载的样式表（例如，要加载深色主题，URL 将变为`http://www.mywebsite.com/index-dark`；单击浅色主题链接会制作 URL `http://www.mywebsite.com/index-light`。问题是，我不知道如何在 URL 中添加标志，或者如何在不同的页面上读取这个标志。我试过用谷歌搜索这个问题，但发现的实用信息很少。如何这能做到吗？

编辑：我想避免使用两个单独的页面，因为我将有多个主题；这意味着基本上多次复制我的根目录中的每个 HTML 页面，占用空间。`$_GET`不过，我喜欢隐藏变量的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:18:28.223

没有更多信息，我只能给出一些一般性的建议。

所以我假设你正在用 PHP 构建一个页面，所以你可以有两个不同的 url 并使用 mod_rewrite 来转换`/index-dark`，`/index?style=dark`但这很糟糕。

您可能想要的是使用 cookie 或会话。基本上，您检查主题设置的[cookie](http://php.net/cookies)或[会话值](http://php.net/sessions)，然后在生成页面时选择适当的 CSS 文件。

这有几个优点：

*   不需要使用 url 重写，在最好的情况下容易出错
*   允许持久设置（如果您使用 cookie）并且不涉及复杂的 url。
*   允许添加更多主题而无需更改大量代码，只需将设置添加到主题选择器和新的 CSS 文件即可。

GET 变量通常只对随请求发送的特定数据有用，有点像 POST 变量主要用于表单和提交的数据。如果您想要持久设置，那么会话/cookie 是最佳选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:03:43.067

您提到的“标志”实际上可能是`$_GET`使用`mod_rewrite`. 您可以做的是编辑您的`.htaccess`文件以添加重写规则，例如更改`www.mywebsite.com/index.php?style=index-dark`为`www.mywebsite.com/index-dark`（不幸的是，我没有具体如何执行此操作的经验；我只知道可以完成）并让您的 PHP catch `$_GET['style']`。

# asp.net-mvc - 哪里是 Simple Injector 等效于 StructureMap 的 ObjectFactory

> ID：11621201
> 
> 赞同：7
> 
> 时间：2012-07-23T22:00:37.770
> 
> 标签：asp.net-mvc, asp.net-mvc-3, structuremap, simple-injector

我正在从 StructureMap 迁移到 ASP.NET MVC3 应用程序中的 Simple Injector。

我正在为控制器 DI 使用 MVC3 扩展，但在尝试替换 StructureMap 的静态方面时遇到了问题。我们有电话

```
StructureMap.ObjectFactory.GetInstance<Interface>() 
```

贯穿应用程序的不同层。看起来 Simple Injector 没有办法做到这一点。

我错过了什么吗？还是 Simple Injector 不适用于我的应用？

请提前告知和感谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-03T14:13:36.867

允许应用程序直接访问容器被认为是不好的做法。它是[Service Locator 反模式](https://freecontent.manning.com/the-service-locator-anti-pattern/)的一种形式。

因为这被认为是一件坏事，所以 Simple Injector 不包含任何类似 StructureMap 的东西`ObjectFactory.GetInstance`。事实上，StructureMap 的作者[正在考虑在 StructureMap 的未来版本中删除](https://groups.google.com/forum/#!topic/structuremap-users/S7nBib95zh0)API `ObjectFactory`。

但是，没有什么能阻止您将`SimpleInjector.Container`实例存储在静态字段中并让应用程序使用它：

```
// Service Locator implementation in low application layer.
public static class ObjectFactory
{
    private static SimpleInjector.Container container;

    public static void SetContainer(Container container)
    {
        ObjectFactory.container = container;
    }

    public static T GetInstance<T>() where T : class
    {
        return container.GetInstance<T>();
    }
} 
```

在组合根中：

```
public static void Initialize()
{
   var container = new Container();      

   InitializeContainer(container);

   DependencyResolver.SetResolver(
        new SimpleInjectorDependencyResolver(container));   

   // Set the service locator here
   ObjectFactory.SetContainer(container);
} 
```

因此，Simple Injector 并没有阻止您这样做的限制，但坦率地说，您已经见证了 Service Locator 是一件坏事的原因之一：您切换了容器，现在您必须更改应用程序代码。

也许现在最简单的方法是将容器保存在静态字段中（如上例所示），但请花时间理解为什么这种模式不好，并从这种模式重构为依赖注入（以及特别是构造函数注入）。

# ios - Twitter iOS Streaming API：没有收到数据

> ID：11621211
> 
> 赞同：2
> 
> 时间：2012-07-23T22:02:01.170
> 
> 标签：ios, twitter, nsurlconnectiondelegate

我正在尝试修改 Apple 使用 Twitter API 的示例代码，以便我可以使用流 API 过滤推文。我正在尝试实施针对此问题建议的方法：

[TWRequest 是否适用于 twitter 流 api？](https://stackoverflow.com/questions/8566742/does-twrequest-work-for-the-twitter-streaming-api)

我已经按照建议创建了签名的 NSURLRequest 和 NSURLConnection 对象，并为连接对象设置了委托。选择一个有效的 Twitter 帐户并用于对 url 进行签名。问题是代表 connection:didReceiveData: 方法永远不会被调用。

这是我的代码：

```
@implementation Twitter

-(id)init{
    if (self=[super init]) {
        NSLog(@"Twitter init");

        // Tell the notification centre to inform the app if the twitter account changes
        [[NSNotificationCenter defaultCenter] addObserver:self 
                                                 selector:@selector(twitterAccountChanged) 
                                                     name:ACAccountStoreDidChangeNotification object:nil];

        // Create an account store object.
        ACAccountStore *accountStore = [[ACAccountStore alloc] init];

        // Create an account type that ensures Twitter accounts are retrieved.
        ACAccountType *accountType = [accountStore accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

        // Request access from the user to use their Twitter accounts.
        [accountStore requestAccessToAccountsWithType:accountType withCompletionHandler:^(BOOL granted, NSError *error) {
            if(granted) {
                NSLog(@"Twitter: Access to twitter accounts granted");

                // Get the list of Twitter accounts.
                NSArray *accountsArray = [accountStore accountsWithAccountType:accountType];

                // Pick the twitter account to use
                if ([accountsArray count] > 0) {

                    // Grab the initial Twitter account to tweet from.
                    ACAccount *twitterAccount = [accountsArray objectAtIndex:0];

                    // This is for a status filter
                    NSURL *url=[NSURL URLWithString:@"https://stream.twitter.com/1/statuses/filter.json"];

                    // Create the parameters dictionary
                    NSDictionary *dictionary=[NSDictionary dictionaryWithObjectsAndKeys:@"twitter", @"track", nil];

                    // Create TWRequest object
                    TWRequest *req=[[TWRequest alloc] initWithURL:url parameters:dictionary requestMethod:TWRequestMethodPOST];

                    // Set the account
                    [req setAccount:twitterAccount];

                    // Get a signed URL request
                    NSURLRequest *signedRequest=[req signedURLRequest];

                    // Initate the connection
                    [NSURLConnection connectionWithRequest:signedRequest delegate:self];

                } else {
                    NSLog(@"Twitter: No twitter accounts to access");
                }

            } else {
                NSLog(@"Twitter: Access to twitter accounts denied");

            }
        }];

        return self;
    }
    return nil;
}

-(void)twitterAccountChanged{
    NSLog(@"Twitter twitterAccountChanged");
}

-(void) connection:(NSURLConnection *)connection didReceiveData:(NSData *)data{
    NSLog(@"data received");
} 
```

该程序的输出是：

```
2012-07-24 09:50:03.668 TwitterAPITest[36722:10403] Twitter init
2012-07-24 09:50:03.836 TwitterAPITest[36722:11d03] Twitter: Access to twitter accounts granted 
```

如您所见，一切似乎都正常，唯一的问题是委托方法从未被调用，我目前不知道为什么。

任何帮助将非常感激...

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:32:11.390

我花了一些时间来启动和运行它，所以我想我应该为其他人发布我的代码。在我的例子中，我试图让推文靠近某个位置，所以你会看到我使用了一个`locations`参数和一个我在范围内的位置结构。您可以将所需的任何参数添加到 params 字典中。

另请注意，这是最基本的操作，您需要做一些事情，例如通知用户未找到帐户并允许用户选择他们想要使用的 Twitter 帐户（如果存在多个帐户）。

快乐流媒体！

```
//First, we need to obtain the account instance for the user's Twitter account
ACAccountStore *store = [[ACAccountStore alloc] init];
ACAccountType *twitterAccountType = [store accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

//  Request permission from the user to access the available Twitter accounts
[store requestAccessToAccountsWithType:twitterAccountType
                 withCompletionHandler:^(BOOL granted, NSError *error) {
                     if (!granted) {
                         // The user rejected your request
                         NSLog(@"User rejected access to the account.");
                     }
                     else {
                         // Grab the available accounts
                         NSArray *twitterAccounts = [store accountsWithAccountType:twitterAccountType];
                         if ([twitterAccounts count] > 0) {
                             // Use the first account for simplicity
                             ACAccount *account = [twitterAccounts objectAtIndex:0];
                             NSMutableDictionary *params = [[NSMutableDictionary alloc] init];
                             [params setObject:@"1" forKey:@"include_entities"];
                             [params setObject:location forKey:@"locations"];
                             [params setObject:@"true" forKey:@"stall_warnings"];
                             //set any other criteria to track
                             //params setObject:@"words, to, track" forKey@"track"];

                             //  The endpoint that we wish to call
                             NSURL *url = [NSURL URLWithString:@"https://stream.twitter.com/1.1/statuses/filter.json"];

                             //  Build the request with our parameter
                             TWRequest *request = [[TWRequest alloc] initWithURL:url
                                                                      parameters:params
                                                                   requestMethod:TWRequestMethodPOST];

                             // Attach the account object to this request
                             [request setAccount:account];
                             NSURLRequest *signedReq = request.signedURLRequest;

                             // make the connection, ensuring that it is made on the main runloop
                             self.twitterConnection = [[NSURLConnection alloc] initWithRequest:signedReq delegate:self startImmediately: NO];
                             [self.twitterConnection scheduleInRunLoop:[NSRunLoop mainRunLoop]
                                                   forMode:NSDefaultRunLoopMode];
                             [self.twitterConnection start];

                         } // if ([twitterAccounts count] > 0)
                     } // if (granted) 
                 }]; 
```

# xaml - 在 Win 8 Metro 应用程序的 App.xaml 中定义应用程序栏

> ID：11621213
> 
> 赞同：0
> 
> 时间：2012-07-23T22:02:08.137
> 
> 标签：xaml, visual-c++, user-interface, windows-8, microsoft-metro

在我的应用程序中，应用程序栏、其按钮及其事件处理程序在我的应用程序的多个页面中是一致的。是否可以在 App.xaml.* 文件中定义和初始化应用程序栏，以便它被定义一次，而不是在我的应用程序的每个页面中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:36:31.613

是的，您可以在单个页面中托管应用栏，然后让该页面托管并管理其他页面的导航。微软的例子非常简单。

[分享应用栏](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/jj150604.aspx)

# python - 从 Python 中的另一个函数中调用一个函数

> ID：11621219
> 
> 赞同：6
> 
> 时间：2012-07-23T22:02:54.547
> 
> 标签：python, function

我开始学习 Python，但我的代码有问题，希望有人能提供帮助。我有两个函数，我想调用另一个函数。当我简单地尝试调用该函数时，它似乎被忽略了，所以我猜这是我如何调用它的问题。下面是我有问题的代码片段。

```
# Define the raw message function
def raw(msg):
    s.send(msg+'\r\n')

    # This is the part where I try to call the output function, but it
    # does not seem to work.
    output('msg', '[==>] '+msg)

    return

# Define the output and error function
def output(type, msg):
    if ((type == 'msg') & (debug == 1)) | (type != msg):
        print('['+strftime("%H:%M:%S", gmtime())+'] ['+type.upper()+'] '+msg)
    if type.lower() == 'fatal':
        sys.exit()
    return

# I will still need to call the output() function from outside a
# function as well. When I specified a static method for output(),
# calling output() outside a function (like below) didn't seem to work.
output('notice', 'Script started')

raw("NICK :PythonBot") 
```

已编辑。我实际上是在调用 raw() 函数，它就在代码片段的下方。:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-23T22:23:12.103

尝试像这样更简单的情况：

```
def func2(msg):
    return 'result of func2("' + func1(msg) + '")'

def func1(msg):
    return 'result of func1("' + msg + '")'

print func1('test')
print func2('test') 
```

它打印：

```
result of func1("test")
result of func2("result of func1("test")") 
```

请注意，函数定义的顺序是故意颠倒的。Python 中函数定义的顺序无关紧要。

你应该更好地说明什么对你不起作用。

# javascript - 使用 Backbone.js 处理浏览器历史记录

> ID：11621223
> 
> 赞同：2
> 
> 时间：2012-07-23T22:03:03.813
> 
> 标签：javascript, backbone.js, browser-history

我正在尝试使用 Backbone.js 来处理浏览器历史记录。我没有设置视图/模型，因为我不希望它处理这个问题，并且可能正因为如此，我没有让它正常工作。

此时我的页面正在更改网址。像：

```
domain.com/services
domain.com/products
domain.com/contact
domain.com/gallery
domain.com/gallery/photo1 
```

问题是：如果我尝试在 domain.com/gallery/photo1 重新加载页面。我收到错误**Uncaught SyntaxError: Unexpected token <**

只有一级永久链接的所有其他页面在重新加载时都能正常工作。我在 Backbone 上遗漏了什么吗？

我只是在使用 Backbone.Router 和 Backbone.history。

有没有关于如何使用backbone.js 建立网站的简单教程？只是历史的东西？

这是我的脚本：

```
var Router;
var myRouter;

$(document).ready(function(){
    Router = Backbone.Router.extend({
        initialize : function(options) {
            //
        },
        routes: {
            '' : 'home',
            '*actions' : 'pages'
        },
        home : function() {
            this.render('/');
        },
        pages : function(actions) {
            this.render(actions);
        },
        render : function(path) {
            var fullLine = '';
            path = (path === '/' || path === '')? '/' : path;
            console.log('path: ' + path);
        }
    });

    myRouter = new Router();

    Backbone.emulateHTTP = true;
    Backbone.emulateJSON = true;
    Backbone.history.start({pushState: true, root: "/backbone_teste/"});

    // MENU CLICK
    $('.menu').children('li').each(function(){
        $(this).click(function(){
            myRouter.navigate($(this).attr('data-id'), true, true);
        });
    });
}); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T19:21:20.027

问题解决了：

我刚刚在我的 index.php 文件的 head 部分添加了以下代码：

```
<base href="http://localhost/backbone_teste/" /> 
```

它有效。

无论如何，我想知道为什么会发生这种情况以及为什么 Backbone.js 文档没有提到这一点。

我在这个链接找到了解决方案：[HTML5 History / pushState URLs, .htaccess and You](http://www.josscrowcroft.com/2012/code/htaccess-for-html5-history-pushstate-url-routing/)

谢谢

# javascript - Backbone.js 视图可以有模型和集合吗？

> ID：11621224
> 
> 赞同：5
> 
> 时间：2012-07-23T22:03:05.063
> 
> 标签：javascript, backbone.js, backbone-relational, backbone-views

Backbone.js`View`可以有 a`Model`和 a`Collection`吗？

我问的原因是因为我正在使用一个视图，该视图包含一张地图，上面标有位置（使用传单库）。

是一组模型，其中`Collection`包含要在地图上绘制的坐标。

`Model`保存诸如地图边界和地图形状之类的东西。

不知道还有什么办法可以把这个拉下来......

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-23T22:18:42.110

是的，您可以简单地传递它：

```
new view({model: m, collection: c}); 
```

在视图中，您可以通过以下方式访问两者：

```
this.model
this.collection 
```

例如[jsfiddle](http://jsfiddle.net/delvarworld/P3Y9x/1/)

# google-maps-api-3 - 如果设置了地图的宽度和高度，Google Maps fitBounds 不会占用超过 10 个位置

> ID：11621227
> 
> 赞同：0
> 
> 时间：2012-07-23T22:03:11.297
> 
> 标签：google-maps-api-3

我有一张比宽高的地图。我注意到在某些情况下，fitBounds 方法无法正确调整缩放和中心以显示所有标记。

我已经设法在这个例子中隔离了这个问题：

[http://jsbin.com/welcome/2568](http://jsbin.com/welcome/2568)

在示例中，我首先尝试加载 23 个位置，您会注意到它放大了很远。我正在做的是：

```
//extending 23 positions doesn't really work
bounds = new google.maps.LatLngBounds ();
for (var i = 0; i < markerList.length; i++) {
    pos = new google.maps.LatLng (markerList[i]["Za"],markerList[i]["$a"])
    bounds.extend(pos);
}
window.map.fitBounds(bounds); 
```

5 秒后，我再次运行该基本脚本，但这次不是扩展 23，而是仅扩展边界 5 次。这次地图真的缩小了！

我注意到要重现此问题，我必须设置画布 div 的宽度和高度：

```
<div id="map_canvas" style="width:450px;height:600px;"></div> 
```

所以我想我的问题是：如何设置地图画布大小并成功 fitBounds() 25+ 个位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:40:10.073

我只是想发生的事情是我在地图配置中设置了 minZoom。

似乎如果 minZoom 低于 fitBounds() 显示所有位置所需的值，它就会默默地失败。

影响地图宽度的原因是，地图越薄，越要缩小才能显示整组位置，遇到minZoom的约束就会死掉。

我认为 5 个位置的子集会起作用的原因仅仅是因为它没有达到 minZoom。

为了解决这个问题，我删除了 minZoom 设置。

# php - 关于在php中调用每个表中有多少个类别

> ID：11621228
> 
> 赞同：1
> 
> 时间：2012-07-23T22:03:10.820
> 
> 标签：php, mysql

我正在用 php 创建一个学校类型的 CMS 系统以获得更多经验。我创建了一个 schedule.php 页面，其中列出了学校类别，例如：

会计 生物学 数学 计算机科学

我想在来自数据库的 Accounting(2) 类别旁边添加一个数字，因为有 2 个会计类。例如，计算机科学有 10 节课，所以应该是计算机科学（10）

我的代码只显示主题的名称，而不是教授的课程数量。

这是我的代码：

```
<?php

include('connect.php');

if(!isset($_GET['id']))
{
    ?>
    <table border="1" width="15%" height="137">
<tr>
    <td><?php

    //$query1 = mysql_query("SELECT * FROM categories ORDER BY category_name") or die(mysql_error());

    $query1 = mysql_query("SELECT CONCAT(a.category_name, ' (', COUNT(b.category_id), ')') AS category 
```

FROM categories a LEFT JOIN classes b ON a.id = b.category_id GROUP BY a.id, a.category_name") 或 die(mysql_error());

```
 while($row = mysql_fetch_object($query1))
    {
        print "<a href='schedule.php?id=" . $row->id .  "'>" . $row->category . "</a><br/>";
    } ?></td>
</tr> 
```

```
 <?php

}
//if you click on the subject
else if(isset($_GET['id']))
{
    $category = $_GET['id'];
    $sql = "SELECT * FROM classes WHERE category_id = " . $category;
    $query2 = mysql_query($sql) or die(mysql_error());

    while($row = mysql_fetch_object($query2))
    {
    ?>

    <center><h3><?php echo $row->class_name . '-' . $row->units; ?>  </h3></center>
    <table border ="0" wdith="100%">
    <tr>
    <td>
    <strong>Description: </strong>
    <?php echo $row->class_description; ?>
    </tr>
    </td>
    </table>
    <br/>
    <table border="1" width="44%">
<tr>
    <td width="60"><b>Ticket</b> </td>
    <td width="123"><b>Days</b></td>
    <td width="120"><b>Hours</b></td>
    <td width="64"><b>Room</b></td>
    <td><b>Instructor</b></td>
</tr>

    <tr>
    <td width="60"> <?php echo $row->ticket; ?> </td>
    <td width="123"><?php echo $row->days; ?></td>
    <td width="120"><?php echo $row->start_hours . $row->time_format . '-' . $row->end_hours . $row->time_format2 ;  ?> </td>
    <td width="64"> <?php echo $row->room_number; ?></td>
    <td><?php echo $row->instructor_name;  ?></td>
</tr> 
```

```
 }//end while

}//end else if 
```

?>

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:15:21.720

最好使用带有 join 和 group by 子句的查询。它可能看起来像这样：

```
SELECT 
    ca.*, 
    COUNT(cl.id) AS class_count 
FROM 
    categories ca 
    LEFT JOIN classes cl ON cl.category_id = ca.id 
GROUP BY ca.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:16:59.520

假设您的架构是这样的：

```
+---------------+     +--------------------+
| categories    |     | classes            |
+---------------+     +--------------------+
| ID            |     | id                 |
| category_name |     | category_id        |
| etc..         |     | etc...             |
+---------------+     +--------------------+ 
```

`classes.category_id`外键引用在哪里`categories.id`，有一个非常简单的解决方案：

```
SELECT a.ID, CONCAT(a.category_name, ' (', COUNT(b.category_id), ')') AS category
FROM categories a
LEFT JOIN classes b ON a.ID = b.category_id
GROUP BY a.ID, a.category_name 
```

这会将类的数量连接到每个类别。前任。

```
Biology (4)
Computer Science (10)
etc... 
```

您可以简单地`category`在 PHP 中引用查询的列。

```
while($row = mysql_fetch_object($query1))
{
    print "<a href='schedule.php?id=" . $row->ID .  "'>" . $row->category . "</a><br/>";
} 
```

# tsql - 使用 OleDb 查询 MS Access 列属性

> ID：11621229
> 
> 赞同：0
> 
> 时间：2012-07-23T22:03:15.327
> 
> 标签：tsql, ms-access, select, oledb, database-schema

我正在使用 OLE 和 C#.NET 来查询 MS Access 数据库的架构。具体来说，我需要找出特定列是否是“身份”列。对于 SQL Server，我可以使用：

```
select COLUMNPROPERTY(object_id('dbo.tablename'),'columnname','IsIdentity') 
```

...但是当我针对 Access 调用此 SQL 时，我收到带有以下消息的 OleDbException：

```
Undefined function 'COLUMNPROPERTY' in expression. 
```

搜索档案，似乎有办法用 DAO 做到这一点，但我需要使用 OLE。有人碰巧知道我如何用 OLE 做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:22:46.957

使用 GetSchema 方法也是如此。

```
using(OleDbConnection con = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;" + 
                                "Data Source=C:\temp\db.mdb;" + 
                                "Persist Security Info=False;")) 
{ 
    con.Open();
    var schema = con.GetSchema("Indexes");
    var col = schema.Select("TABLE_NAME = 'YourTableName' AND PRIMARY_KEY = True");
    Console.WriteLine(col[0]["COLUMN_NAME"].ToString());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:08:49.413

您可以从连接中获取架构，例如：

```
cn.GetOleDbSchemaTable(OleDbSchemaGuid.Indexes,
                        new Object[] { null, null, null, null, "Table1" }); 
```

是表 1 的索引。返回的字段之一是`PRIMARY_KEY`

请参阅 [http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbschemaguid.columns(v=vs.71](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbschemaguid.columns(v=vs.71) )

# c# - PagedDataSource 没有获取数据源

> ID：11621231
> 
> 赞同：0
> 
> 时间：2012-07-23T22:03:31.787
> 
> 标签：c#, datasource, icollection, entitycollection

我无法`PagedDataSource`使用 IEnumerated`EntityCollection`对象集合作为数据源。

接受集合作为数据源，`PagedDataSource`但是我不能使用诸如等的基本`CurrentPageIndex`属性`IsLastPage`。

我的应用程序因错误而中断`Cannot compute Count for a data source that does not implement ICollection.`

我试着做

`ICollection<Location> listlocations = Company.Locations;`

但没有成功。

我能做些什么？

代码片段

```
 protected void loadBuildings()
    {
        PagedDataSource pds = new PagedDataSource();
        pds.DataSource = Company.Locations;
        pds.AllowPaging = true;
        pds.PageSize = Convert.ToInt16(ddlPageSize.SelectedValue);
        pds.CurrentPageIndex = CurrentPage;
        lnkbtnNext.Enabled = !pds.IsLastPage;
        lnkbtnPrevious.Enabled = !pds.IsFirstPage;

        buildingsDataList.DataSource = pds;
        buildingsDataList.DataBind();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:15:09.867

我不得不使用该选项`AllowCustomPaging`并定义我自己的页面，因为`EntityCollection`不支持`ICollection`该类。

我添加了以下代码来定义我的页面/项目

```
 pds.VirtualCount = Company.Locations.Count();
    pds.PageSize = 3;
    pds.AllowCustomPaging = true; 
```

以及我的页面生成方法中的一些其他代码

`for (int i = 0; i < (pds.VirtualCount/pds.PageSize);i++)`

# c - C解析HTTP Chunked传输编码响应

> ID：11621232
> 
> 赞同：4
> 
> 时间：2012-07-23T22:03:37.887
> 
> 标签：c, http, chunked-encoding, transfer-encoding, http-chunked

我正在开发一个需要解析 Chunked-type HTTP 传输的客户端。我已经把头撞在墙上，试图找出以下错误，如果有人能够更快地发现我的错误，我将不胜感激。总结一下这个问题：似乎客户端没有收到所有的块，从而搞砸了其余的过程。提前致谢！

```
 while(cflag){
    pfile_chunk = malloc(CHUNK_SIZE+1);
    memset(pfile_chunk, 0, CHUNK_SIZE);
    cPtr = pfile_chunk;
    cPtr2 = NULL;
    k=0;
    while(*(cPtr-1) != '\n'){
        k++;
        recv(sock, cPtr, 1, 0);
        cPtr = pfile_chunk+k;
    }
    cPtr2 = strchr(pfile_chunk, '\r');
    *cPtr2 = '\0';
    sscanf(pfile_chunk, "%x", &l);
    if(l == 0)
        break;
    printf("\nServer wants to deliver %ld bytes.\n", l);
    pfile_chunk = realloc(pfile_chunk, l+1);
    memset(pfile_chunk, 0, l);
    recv(sock, pfile_chunk, l, 0);
    fputs(pfile_chunk, f);
    printf("GOT THIS, SIZE %ld:\n%s\n", strlen(pfile_chunk), pfile_chunk);
    //get next \r\n bytes.
    recv(sock, NULL, 2, 0);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T22:27:09.077

至少，您应该检查 的返回值，`recv`看看您是否获得了您期望获得的字节数。

在网络上肯定可以进行短读，因为系统调用将在您进行调用时返回套接字接收缓冲区中可用的任何内容。

实现一个循环，直到您读入整个块，或者将`MSG_WAITALL`标志传递给`recv`最后一个参数。但是，您仍然需要检查`recv`.

```
ssize_t r = recv(sock, pfile_chunk, l, MSG_WAITALL);
if (r < l) {
    /* check for errors ... */
} else {
    /* got the data */
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T18:46:50.580

看起来您对`while`循环中的检查的第一次取消引用将在数组开始之前访问，这可能不是所需的行为。希望该内存位置通常不包含`\n`. 那可能会搞砸你的`read`. 我希望它可能包含一些与您有关的信息`malloc`，这不太可能是`\n`，因此您可能永远不会从中看到问题。

另外，希望您可以相信套接字的另一端不会比`CHUNK_SIZE+1`他们给您的`\n`. 否则，它可能会出现段故障。不过，通常情况下，我希望发送者只发送 10 个或更少的 ASCII 数字字符和一个块头的 CRLF，但理论上他们可以发送一堆长的块扩展头字段。

除此之外，user315052 已经发现了一个更重要的问题，您应该告诉 recv 方法等待您请求的所有数据，或者检查它实际读取了多少数据。

# vb.net - 在 Visual Basic.Net 中为形状着色？

> ID：11621234
> 
> 赞同：0
> 
> 时间：2012-07-23T22:03:41.887
> 
> 标签：vb.net, visual-studio-2010, colors, fill, shapes

我有一组在 Visual Basic 中创建的需要着色的形状：

```
Public Class Form1

Private Sub btnDraw_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDraw.Click
    Dim formSurface As Graphics = Me.CreateGraphics 'creates surface

    Dim world As New Pen(Color.Black, 3)
    formSurface.DrawRectangle(world, 250, 50, 300, 300) 'world

    Dim roof As New Pen(Color.Black, 3)
    Dim roof1 As New Point(325, 200)
    Dim roof2 As New Point(475, 200)
    Dim roof3 As New Point(400, 100)
    Dim roof4 As New Point(400, 100)
    Dim curvePoints As Point() = {roof1, roof2, roof3, roof4}
    formSurface.DrawPolygon(roof, curvePoints) 'triangle roof

    Dim body As New Pen(Color.Black, 3)
    formSurface.DrawRectangle(body, 325, 200, 150, 150) 'square body

    Dim sun As New Pen(Color.Black, 3)
    formSurface.DrawEllipse(sun, 450, 75, 50, 50) 'sun

    Dim door As New Pen(Color.Black, 3)
    formSurface.DrawRectangle(door, 387, 300, 25, 50) 'door

End Sub 
```

结束类

一切正常；形状都是在我想要的地方生成的。（我正在尝试画一座房子）但是，我该如何给它们上色呢？另外，如果我这样做，颜色会重叠吗（我希望发生这种情况）？

我应该使用一些功能`image.fill`吗？我知道这是不对的，但我正在寻找类似的东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:19:26.427

您想使用 formSurface.FillPolygon、FillRectangle 和 FillEllipse 命令。您仍然可以使用“绘图”命令创建与填充颜色不同的轮廓。

“填充”命令需要画笔而不是钢笔。（笔画线，刷子填充空间。）最简单的刷子类型就像“Brushes.AliceBlue”。

# html - 自动刷新缓存的 html

> ID：11621242
> 
> 赞同：-1
> 
> 时间：2012-07-23T22:04:43.673
> 
> 标签：html, jsp

如何自动刷新缓存的 html。我加载一个 html 提交并做一些事情，然后关闭浏览器并打开加载缓存 html 但它不刷新的浏览器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:16:34.053

我*不太*确定你在做什么，但缓存的 HTML 页面是页面在某个时间点的快照。这意味着如果您正在通过刷新页面从网站管理员或类似的地方寻找更新，您最好访问实际页面，因为缓存页面不会随服务器的版本而改变。

# iphone - Apple iad 已加载但未显示，是否计入展示次数？

> ID：11621243
> 
> 赞同：0
> 
> 时间：2012-07-23T22:04:50.770
> 
> 标签：iphone, ios, ipad, iad

我注意到一些有趣的东西，似乎是在某些应用程序中显示 iad 的推荐方式。

在[Apple NavigationBanner 示例](https://developer.apple.com/library/ios/#samplecode/iAdSuite/Listings/NavigationBanner_NavigationBanner_AppDelegate_m.html#//apple_ref/doc/uid/DTS40010198-NavigationBanner_NavigationBanner_AppDelegate_m-DontLinkElementID_16)中，广告由 AppDelegate 下载，但（根据我的阅读）仅在用户单击表格中的某些内容并将 TextViewController 放在屏幕上时才会显示。

我在我的应用程序中使用了这种确切的行为，但我发现这可能很糟糕，加载但从不显示可能会导致对从未显示的广告进行支付。我不想不小心违反规则。

我担心这个是对的吗？或者，Apple 是否可能使用某种未知机制来跟踪屏幕上放置了哪些广告，而不是简单地下载来计算它们的展示次数？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:35:43.133

Apple 非常谨慎地确保广告仅在展示时才会被记入贷方。

在我们的一个游戏中，我们遇到了布局问题，有时会导致一个对象出现在 iAd 前面（实际上是一个非常小的对象 - 您仍然可以看到广告）。在这些情况下，iAd 框架会记录我们不会收到展示，因为广告被遮挡了。

# visual-c++ - C++/CLI 包含问题

> ID：11621244
> 
> 赞同：2
> 
> 时间：2012-07-23T22:04:52.597
> 
> 标签：visual-c++, visual-studio-2008, include, c++-cli

再次进行一些 C++/CLI 编码，然后遇到问题。如果重要的话，在 VS2008 中工作。

这是我正在尝试做的模拟。实际上 ClassA 是 GUI，ClassB 是 gui 需要与之交互的后端。我试图通过将它们传递给彼此来让它们相互访问，但我无法正确地将它们置于范围内以创建对另一个的引用。

[http://pastie.org/private/tnyxazwtyzv3luddz7seq](http://pastie.org/private/tnyxazwtyzv3luddz7seq)

如果您有任何意见，我将不胜感激。我今天大部分时间都在网上寻找，我目前已经非常接近这个解决方案，但我仍然遇到编译错误。这是我现在得到的：

```
Error   1   error C2653: 'NameSpaceB' : is not a class or namespace name    c:\users\andy\documents\visual studio 2008\projects\myhello\myhello\A.h 12  myhello
Error   2   error C2143: syntax error : missing ';' before '^'  c:\users\andy\documents\visual studio 2008\projects\myhello\myhello\A.h 12  myhello
Error   3   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int   c:\users\andy\documents\visual studio 2008\projects\myhello\myhello\A.h 12  myhello
Error   4   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int   c:\users\andy\documents\visual studio 2008\projects\myhello\myhello\A.h 12  myhello
Error   5   error C2653: 'NameSpaceA' : is not a class or namespace name    c:\users\andy\documents\visual studio 2008\projects\myhello\myhello\B.h 12  myhello
Error   6   error C2143: syntax error : missing ';' before '^'  c:\users\andy\documents\visual studio 2008\projects\myhello\myhello\B.h 12  myhello
Error   7   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int   c:\users\andy\documents\visual studio 2008\projects\myhello\myhello\B.h 12  myhello
Error   8   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int   c:\users\andy\documents\visual studio 2008\projects\myhello\myhello\B.h 12  myhello 
```

这与我在实际项目中遇到的错误相同，所以我知道我的配置很时髦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:16:59.537

```
/*B.h File Contents*/
#ifndef CLASSB_H
#define CLASSB_H
#include "A.h" 
```

取下`#include "A.h"`零件，你就变成了金色。由于 B 类不使用 A（至少在定义中），因此不需要包含。

# ldap - Plone ldap 添加安装问题

> ID：11621245
> 
> 赞同：1
> 
> 时间：2012-07-23T22:04:52.627
> 
> 标签：ldap, plone, buildout

我正在尝试让 ldap 身份验证在 Plone 4.2 版上工作。我已经在这个问题上敲了几个小时，但没有结果。我什至尝试过这些步骤：

1.  安装 python-ldap 2.6 (C:\Python26)
2.  使用安装程序安装 Plone 4.2 (D:\Plone)
3.  在 EGG 和 ZCML 部分中使用 plone.app.ldap 编辑 buildout.cfg
4.  在 D:\Plone\buildout-cache\eggs\ 中创建一个名为 python_ldap-2.3.12-py2.6.egg 的新文件夹
5.  复制 C:\Python26\lib\site-packages\python_ldap-2.3.12-py2.6.egg-info 到 D:\Plone\buildout-cache\eggs\python_ldap-2.3.12-py2.6.egg\ 和重命名为 EGG-INFO
6.  还将 C:\Python26\lib\site-packages\ 中的 ldap 文件夹复制到 D:\Plone\buildout-cache\eggs\python_ldap-2.3.12-py2.6.egg\
7.  还将文件 ldapurl.py 复制到 C:\Python26\lib\site-packages\ 到 D:\Plone\buildout-cache\eggs\python_ldap-2.3.12-py2.6.egg\
8.  下一个副本： 文件夹：C:\Python26\lib\site-packages\python_ldap-2.3.12-py2.6.egg-info 文件夹：C:\Python26\lib\site-packages\ldap 到 D:\Plone\python \Lib\站点包
9.  启动命令框并运行 bin\buildout
10.  启动 Plone，以管理员身份登录并转到额外产品部分。在这里您将找到 LDAP 产品。安装它并输入您的 LDAP 详细信息。

这些都没有真正帮助。当我尝试 bin/buildout 时，我收到以下消息：

```
Installing instance.
Getting distribution for 'dataflake.fakeldap'.
zip_safe flag not set; analyzing archive contents...

Installed /tmp/easy_install-oISsVG/dataflake.fakeldap-1.0/setuptools_git-0.4.2-py2.6.egg
Got dataflake.fakeldap 1.0.
Generated script '/usr/local/Plone/zinstance/bin/instance'.
Installing zopepy.
Generated interpreter '/usr/local/Plone/zinstance/bin/zopepy'.
Installing zopeskel.
Generated script '/usr/local/Plone/zinstance/bin/zopeskel'.
Generated script '/usr/local/Plone/zinstance/bin/paster'.
Updating backup.
Updating chown.
chown: Running 
echo Dummy references to force this to execute after referenced parts
echo /usr/local/Plone/zinstance/var/backups sudo -u plone
chmod 600 .installed.cfg
find /usr/local/Plone/zinstance/var -type d -exec chmod 700 {} \;
chmod 744 /usr/local/Plone/zinstance/bin/*
Dummy references to force this to execute after referenced parts
/usr/local/Plone/zinstance/var/backups sudo -u plone
Updating repozo.
Updating unifiedinstaller.
*************** PICKED VERSIONS ****************
[versions]
Products.LDAPMultiPlugins = 1.14
Products.LDAPUserFolder = 2.23
Products.PloneLDAP = 1.1
collective.sendaspdf = 2.6
dataflake.fakeldap = 1.0
jquery.pyproxy = 0.4.1
plone.app.ldap = 1.2.8

*************** /PICKED VERSIONS *************** 
```

当我尝试 bin/buildout 时，它说守护进程已启动并给出一个 id，但是当我尝试 localhost:8080 时，它说“问题加载页面”并且页面未加载。我尝试使用 bin/instance fg 来显示错误，并关注消息。

```
bin/instance fg
2012-07-24 08:53:18 INFO ZServer HTTP server started at Tue Jul 24 08:53:18 2012
        Hostname: 0.0.0.0
        Port: 8080
2012-07-24 08:53:18 INFO Zope Set effective user to "plone"
2012-07-24 08:53:19 WARNING SecurityInfo Conflicting security declarations for "setText"
2012-07-24 08:53:19 WARNING SecurityInfo Class "ATTopic" had conflicting security declarations
2012-07-24 08:53:19 ERROR Application Could not import Products.LDAPMultiPlugins
Traceback (most recent call last):
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/OFS/Application.py", line 606, in import_product
    product=__import__(pname, global_dict, global_dict, silly)
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPMultiPlugins-1.14-py2.6.egg/Products/LDAPMultiPlugins/__init__.py", line 22, in <module>
    from Products.LDAPMultiPlugins.LDAPMultiPlugin import addLDAPMultiPluginForm
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPMultiPlugins-1.14-py2.6.egg/Products/LDAPMultiPlugins/LDAPMultiPlugin.py", line 29, in <module>
    from Products.LDAPUserFolder import manage_addLDAPUserFolder
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPUserFolder-2.23-py2.6.egg/Products/LDAPUserFolder/__init__.py", line 20, in <module>
    from Products.LDAPUserFolder.LDAPUserFolder import LDAPUserFolder
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPUserFolder-2.23-py2.6.egg/Products/LDAPUserFolder/LDAPUserFolder.py", line 52, in <module>
    from Products.LDAPUserFolder.LDAPDelegate import filter_format
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPUserFolder-2.23-py2.6.egg/Products/LDAPUserFolder/LDAPDelegate.py", line 19, in <module>
    import ldap
  File "/usr/local/Plone/buildout-cache/eggs/python_ldap-2.3.12-py2.6.egg/ldap/__init__.py", line 22, in <module>
    from _ldap import *
ImportError: No module named _ldap
Traceback (most recent call last):
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/Zope2/Startup/run.py", line 76, in <module>
    run()
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/Zope2/Startup/run.py", line 22, in run
    starter.prepare()
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/Zope2/Startup/__init__.py", line 86, in prepare
    self.startZope()
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/Zope2/Startup/__init__.py", line 259, in startZope
    Zope2.startup()
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/Zope2/__init__.py", line 47, in startup
    _startup()
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/Zope2/App/startup.py", line 67, in startup
    OFS.Application.import_products()
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/OFS/Application.py", line 583, in import_products
    import_product(product_dir, product_name, raise_exc=debug_mode)
  File "/usr/local/Plone/buildout-cache/eggs/Zope2-2.13.15-py2.6.egg/OFS/Application.py", line 606, in import_product
    product=__import__(pname, global_dict, global_dict, silly)
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPMultiPlugins-1.14-py2.6.egg/Products/LDAPMultiPlugins/__init__.py", line 22, in <module>
    from Products.LDAPMultiPlugins.LDAPMultiPlugin import addLDAPMultiPluginForm
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPMultiPlugins-1.14-py2.6.egg/Products/LDAPMultiPlugins/LDAPMultiPlugin.py", line 29, in <module>
    from Products.LDAPUserFolder import manage_addLDAPUserFolder
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPUserFolder-2.23-py2.6.egg/Products/LDAPUserFolder/__init__.py", line 20, in <module>
    from Products.LDAPUserFolder.LDAPUserFolder import LDAPUserFolder
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPUserFolder-2.23-py2.6.egg/Products/LDAPUserFolder/LDAPUserFolder.py", line 52, in <module>
    from Products.LDAPUserFolder.LDAPDelegate import filter_format
  File "/usr/local/Plone/buildout-cache/eggs/Products.LDAPUserFolder-2.23-py2.6.egg/Products/LDAPUserFolder/LDAPDelegate.py", line 19, in <module>
    import ldap
  File "/usr/local/Plone/buildout-cache/eggs/python_ldap-2.3.12-py2.6.egg/ldap/__init__.py", line 22, in <module>
    from _ldap import *
ImportError: No module named _ldap 
```

我究竟做错了什么？帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T07:14:55.783

您的构建成功运行，那里没有问题。您选择的某些软件包没有固定，因此您的构建报告了它为您选择的版本。

您的服务器本身确实没有运行，因为您安装的 Python LDAP egg 似乎安装不正确。缺少库`buildout-cache/eggs/python_ldap-2.3.12-py2.6.egg/ldap/_ldap.so`文件。

删除整个鸡蛋 ( `rm -rf buildout-cache-eggs/python_ldap-2.3.12-py2.6.egg`) 确保您的系统上安装了 OpenLDAP 2.x 库和头文件（在 Ubuntu 和 Debian 上`libldap2-dev`应该足够了）。然后重新运行 buildout 以重新安装 egg。

或者，您可以尝试安装系统`python-ldap`包（删除鸡蛋），然后看看 buildout 是否会选择它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T08:08:14.490

您需要安装 2 个库：

```
sudo apt-get install libldap2-dev

sudo apt-get install libsasl2-dev 
```

希望这会有所帮助。

# sql - 旋转 SQL 表

> ID：11621251
> 
> 赞同：2
> 
> 时间：2012-07-23T22:05:25.563
> 
> 标签：sql, sql-server, tsql, pivot

我有一张如下表

```
Code        Attribute        Value
--------------------------------------
USA         Population       300M
USA         Language         US English
CANADA      Population       30M
USA         Capital          DC
CANADA      Language         CA English 
```

如何将表格旋转 90 度并制作如下**视图以在其上运行*****查询***和***sp***？

```
Code        Language        Population       Capital
------------------------------------------------------
USA         US English         300M              DC
CANADA      CA English          30M              NULL 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-23T22:09:55.523

您可以使用`PIVOT`（对于 SQL Server 2005+）：

```
SELECT *
FROM YourTable AS T
PIVOT (MIN(Value) FOR Attribute IN ([Language],[Population],[Capital]) AS PT 
```

对于所有版本的 SQL Server，您都可以使用：

```
SELECT  Code, 
        MIN(CASE WHEN Attribute = 'Language' THEN Value END) [Language],
        MIN(CASE WHEN Attribute = 'Population' THEN Value END) [Population],
        MIN(CASE WHEN Attribute = 'Capital' THEN Value END) [Capital]
FROM YourTable
GROUP BY Code 
```

# xamarin.ios - Monotouch SplitView 示例无法更改 ViewController

> ID：11621256
> 
> 赞同：1
> 
> 时间：2012-07-23T22:05:54.437
> 
> 标签：xamarin.ios

我正在尝试学习如何使用 UISplitViewController，并且我正在使用 Monotouch 提供的“SplitView”示例。我了解它是如何工作的以及在 Master 和 Detail 控制器之间进行通信的方式。

因此更改细节控制器不会很难吗？所以我做了一个很小的修改，它不起作用！我已阅读您必须使用 SetViewControllers 但这在 Monotouch 堆栈中不存在。我哪里错了？

除了以下几行之外，它与 Montouch 的示例完全相同：

```
public class MainSplitView : UISplitViewController
{       
    protected Screens.MasterView.MasterTableView masterView;
    protected Screens.DetailView.DetailViewScreen detailView;
    protected TestViewController testViewController; // *** Added this line

    public MainSplitView () : base()
    {
        // create our master and detail views
        masterView = new Screens.MasterView.MasterTableView ();
        detailView = new Screens.DetailView.DetailViewScreen ();

        masterView.RowClicked += (object sender, MasterView.MasterTableView.RowClickedEventArgs e) => 
        {
            detailView.Text = e.Item;

            testViewController = new TestViewController();  // *** Added this line
            ViewControllers[0] = masterView;         // *** Added this line
            ViewControllers[1] = testViewController; // *** Added this line
          // the UISplitViewController.SetViewControllers does not exist! ???
        };

         ViewControllers = new UIViewController[] { masterView, detailView };

     } 
```

非常感谢所有帮助！

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:45:27.727

准确设置`ViewControllers`您在其他地方的操作方式：

```
ViewControllers = new UIViewController[] { masterView, detailView }; 
```

只需这样做：

```
ViewControllers = new UIViewController[] { masterView, testViewController }; 
```

# iphone - iOS - plist 文件、nsuserdefaults 或文本数据文件

> ID：11621257
> 
> 赞同：1
> 
> 时间：2012-07-23T22:05:57.443
> 
> 标签：iphone, objective-c, ios, cocoa, ipad

我正在开发一个需要大量数据的移动应用程序。简而言之，数据将用于多种语言，并包含该语言可能出现的所有单词。该应用程序将仅以英语和很多单词开头。然后用户可以选择下载更多语言及其数据。

我正在尝试找出读取/保存/更新此数据的最佳方法。我是否应该先创建一个包含英语数据的 plist 文件，然后在用户下载新语言时继续添加更多数据？还是应该将所有数据保存在 nsuserdefaults 中？或者，我应该只包含一个包含所有数据的文本文件并即时解析它吗？

建议？

ps：我知道因为这是一个移动应用程序，所以必须考虑文件空间和解析时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:18:43.113

请在此处阅读我的答案：[https ://stackoverflow.com/a/7215501/832065](https://stackoverflow.com/a/7215501/832065)

如该答案所述，所有 NSUserDefaults 都存储在一个 plist 中。

plist 和 NSUserDefaults 基本相同，但是 NSUserDefaults 只能用于保存首选项而不是大量数据。所以不要使用 NSUserDefaults！

我会考虑将其保存在 plist (NSDictionary) 中。像这样，您可以在该文件中排序所有数据。只需将“单词”（我假设为 NSString）设置为对象，并将语言设置为键。

```
NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithContentsOfFile:filePath];
[dict setObject:words forKey:language];
[dict writeToFile:filePath atomically:YES]; 
```

阅读相同：

```
NSDictionary *dict = [NSDictionary dictionaryWithContentsOfFile:filePath];
NSString *words = [dict objectForKey:language]; 
```

**编辑：**

如果每个单词都分配给一个数字（您可以只使用 NSArray），则差别不大：

```
NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithContentsOfFile:filePath];
NSArray *words = [NSArray arrayWithObjects:allTheWords,nil];
[dict setObject:words forKey:language];
[dict writeToFile:filePath atomically:YES]; 
```

阅读相同：

```
NSDictionary *dict = [NSDictionary dictionaryWithContentsOfFile:filePath];
NSArray *words = [dict objectForKey:language];
NSString *word = [words objectAtIndex:numberAssignedToWord]; 
```

我希望这有帮助！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:42:15.827

我建议直接使用 SQL 数据库或 Core Data。如果您有大量数据，您不希望一直将这些数据完全加载到内存中。它也更容易处理数据的更新、更改或添加。

但是你的问题太笼统了，并没有说明你真正想要对数据做什么，数据有多大，以 KByte 或 MByte 为单位，很难给出任何好的答案。

将大量数据写入文本文件、用户默认值、plist 或类似的东西，似乎不是正确的选择。使用 Core Data 将是在 iOS 上执行此类操作的默认方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T23:52:22.527

我认为最简单的方法是处理 a 中的数据`NSMutableArray`并使用`NSUserDefaults`.

您可以在 a 中处理您的数据`NSMutableArray`，如下所示：

```
NSMutableArray *yourDataStuff = [[NSMutableArray alloc] init];
[yourDataStuff addObject:@"Your data 1"];
[yourDataStuff addObject:@"Your data 2"];
[yourDataStuff addObject:@"Your data 3, etc.."]; 
```

然后您可以使用 存储它`NSUserDefaults`，如下所示：

```
[[NSUserDefaults standardUserDefaults] setObject:yourDataStuff forKey:@"myData"]; 
```

并读取您的数据，如下所示：

```
yourDataStuff = [[NSUserDefaults standardUserDefaults] objectForKey:@"myData"]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T23:33:09.383

我认为您无法在 NSUserDefault 中保存大数据，并且您可能无法使用 plist 进行 IO，我已经这样做了，当您读取或保存时，您必须读取整个 .plist ，您可能会收到内存警告或崩溃. 您可以使用 C (fread,fwrite) 将数据写入 .txt ，并且您可以使用数据流进行读写。

# objective-c - 使 stringWithContentsOfURL 异步 - 安全吗？

> ID：11621269
> 
> 赞同：6
> 
> 时间：2012-07-23T22:07:25.057
> 
> 标签：objective-c, ios, asynchronous, thread-safety, http-request

我试图使 -[NSString stringWithContentsOfURL:encoding:error:] 异步，通过从后台线程异步运行它：

```
__block NSString *result;
dispatch_queue_t currentQueue = dispatch_get_current_queue();

void (^doneBlock)(void) = ^{
    printf("done! %s",[result UTF8String]);
};

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,
                                         (unsigned long)NULL), ^(void) {
    result = [NSString stringWithContentsOfURL:[NSURL URLWithString:@"http://www.google.com/"] encoding:NSUTF8StringEncoding error:nil];
    dispatch_sync(currentQueue, ^{
        doneBlock();
    });
}); 
```

它工作正常，最重要的是，它是异步的。

我的问题是这样做是否安全，或者是否存在任何线程问题等？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-23T22:41:01.943

那应该是安全的，但为什么要重新发明轮子呢？

```
NSURLRequest *req = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.google.com"]];
[NSURLConnection sendAsynchronousRequest:req queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
    NSString *result = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    // etc
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T15:35:01.637

您还可以使用：

```
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);

dispatch_async(queue, ^{
        NSError *error = nil;
        NSString *searchResultString = [NSString stringWithContentsOfURL:[NSURL URLWithString:searchURL]
                                                           encoding:NSUTF8StringEncoding
                                                              error:&error];
        if (error != nil) {
            completionBlock(term,nil,error);
        }
        else
        {
            // Parse the JSON Response
            NSData *jsonData = [searchResultString dataUsingEncoding:NSUTF8StringEncoding];
            NSDictionary *searchResultsDict = [NSJSONSerialization JSONObjectWithData:jsonData
                                                                              options:kNilOptions
                                                                                error:&error];
            if(error != nil)
            {
                completionBlock(term,nil,error);
            }
            else
            {

                //Other Work here
            }
        }
    }); 
```

但是，是的，它应该是安全的。我被告知使用 NSURLConnection 代替，因为错误调用等通过互联网通信时。我还在做这方面的研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-15T07:04:32.830

```
-(void)loadappdetails:(NSString*)appid {
    NSString* searchurl = [@"https://itunes.apple.com/lookup?id=" stringByAppendingString:appid];

    [self performSelectorInBackground:@selector(asyncload:) withObject:searchurl];

}
-(void)asyncload:(NSString*)searchurl {
    NSURL* url = [NSURL URLWithString:searchurl];
    NSError* error = nil;
    NSString* str = [NSString stringWithContentsOfURL:url encoding:NSUTF8StringEncoding error:&error];
    if (error != nil) {
        NSLog(@"Error: %@", error);
    }
    NSLog(@"str: %@", str);
} 
```

# php - 如何从 PHP 系统调用调用具有 gem 要求的 ruby 脚本

> ID：11621271
> 
> 赞同：1
> 
> 时间：2012-07-23T22:07:26.910
> 
> 标签：php, ruby, scripting

我有一个基于 PHP 的应用程序，需要调用一个用 Ruby 编写的自动化脚本。我不想用 PHP 重写 ruby​​ 脚本，它们也不需要共享变量。Ruby 脚本具有 gem 依赖项，当从`system()`. 如何让 ruby​​ 脚本从`system()`调用中查看依赖关系？

例子：

```
system('/usr/bin/ruby /www/myscript.rb') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:07:26.910

在`system()`调用中设置 GEM_HOME 变量

例子：

```
system('export GEM_HOME=/path/to/rubygems; /usr/bin/ruby /www/myscript.rb'); 
```

# regex - 前瞻与后瞻

> ID：11621273
> 
> 赞同：12
> 
> 时间：2012-07-23T20:49:54.523
> 
> 标签：regex, regex-lookarounds

我很难理解“向前看”和“向后看”的概念。例如，有一个字符串“aaaaaxbbbbb”。如果我们看“x”，向前看是否意味着将“x”看向“bbbbb”或“aaaaa”？我是说方向。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-23T23:41:05.600

如果正则表达式是`x(?=insert_regex_here)`一个（正）look*ahead*，它*向前看*，或者*向前看*，换句话说就是“bbbb”。它的意思是“找到一个*后面跟着* `insert_regex_here`”的x。

如果正则表达式是`(?<=insert_regex_here)x`（积极的）look*behind*，它*向后看*，或者*向后看*，换句话说，朝向“aaaa”。它的意思是“找到一个*前面有* `insert_regex_here`”的x。

您还可以使用否定的lookahead`x(?!insert_regex_here)`表示“后面`x` *没有*`insert_regex_here`”，以及否定的lookbehind`(?<!insert_regex_here)x`表示“x前面*没有*`insert_regex_here`”。

（以上`(?=`等`(?<!` 是 Perl 正则表达式语法 - 语法可能略有不同，具体取决于您的正则表达式风格）。

我建议您阅读乍得在评论中提供的链接。**它有例子。**

# javascript - 使用 javascript 替换文本中的随机 youtube 链接以嵌入代码

> ID：11621275
> 
> 赞同：1
> 
> 时间：2012-07-23T22:07:40.957
> 
> 标签：javascript, parsing, url, search, replace

我有一些 HTML 代码 - 例如：

```
<div>Text</div> 
http://www.youtube.com/watch?v=QZ2ekuCu4gM&feature=relmfu 
<div>Text</div> 
youtube.com/watch?v=adrJx864olE&feature=g-logo-xit
<div>Text</div>
<a href="#">LINK</a> 
```

我需要使用在该 URL 中嵌入视频的 iframe 自动替换任何 YouTube URL，如下所示：

```
<div>Text</div> 
<iframe width="560" height="315" 
src="http://www.youtube.com/embed/QZ2ekuCu4gM" frameborder="0" 
allowfullscreen></iframe>
<div>Text</div> 
<iframe width="560" height="315" 
src="http://www.youtube.com/embed/adrJx864olE" frameborder="0" 
allowfullscreen></iframe>
<div>Text</div>
<a href="#">LINK</a> 
```

如何在 HTML 代码中搜索来自 YouTube 的链接并使用 JavaScript 将其替换为等效的 iframe 代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T22:30:55.817

这是一种方法：

```
function linkYT(el) {
    if (!el) {
        return false;
    }
    else {
        var children = el.childNodes,
            text = [];
        for (var i=0, len=children.length; i<len; i++){
            var cur = children[i],
                nType = cur.nodeType,
                content = cur.nodeValue,
                url = 'http://www.youtube.com/embed/';
            if (nType == 3 && content.indexOf('youtube.com') > -1) {
                var embed = content.trim().match(/v=(\w+)/)[1],
                    iframe = document.createElement('iframe');
                iframe.src = url + embed;
                el.insertBefore(iframe, cur.nextSibling);
                cur.parentNode.removeChild(cur);
            }
        }
    }
}

var el = document.getElementById('content');
linkYT(el);​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/jKA53/)。

请注意，根本***没有***完整性检查，这种方法要求视频的标识符以`v=`非字母数字字符开头和结尾。

我只在 Opera 12 和 Chromium 19 中进行了测试和验证。

考虑另*一种*形式的 YouTube URL 格式：

```
function createIframe(embed, parent, after, url){
    if (!embed || !parent || !after) {
        return false;
    }
    else {
        url = url ? url : 'http://www.youtube.com/embed/';
        var iframe = document.createElement('iframe');
        iframe.src = url + embed;
        parent.insertBefore(iframe, after.nextSibling);
        parent.removeChild(after);
    }
}

function linkYT(el) {
    if (!el) {
        return false;
    }
    else {
        var children = el.childNodes,
            text = [];
        for (var i=0, len=children.length; i<len; i++){
            var cur = children[i],
                nType = cur.nodeType,
                content = cur.nodeValue,
                url = 'http://www.youtube.com/embed/';
            if (nType == 3) {
                if (content.indexOf('youtube.com') > -1) {
                    var embed = content.trim().match(/v=(\w+)/)[1];
                    createIframe(embed, el, cur);
                }
                else if (content.indexOf('youtu.be') > -1) {
                    var embed = content.trim().match(/be\/(\w+)/)[1];
                    createIframe(embed, el, cur);
                }
            }
        }
    }
}

var el = document.getElementById('content');
linkYT(el);​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/jKA53/3/)。

实际上这是相同的过程，只是正则表达式略有不同。

因为有两个地方`nodeType`必须找到等于`3` *和*两个地方`iframe`正在创建 s，所以我将两个`indexOf()`评估包装在 an 内`if`以测试`nodeType`和抽象`iframe`- 创建到一个单独的函数，这两者都简单避免不必要的重复。

参考：

*   [`childNodes`](https://developer.mozilla.org/en/childNodes).
*   [`createElement()`](https://developer.mozilla.org/en/DOM/document.createElement).
*   [`indexOf()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/indexOf).
*   [`insertBefore()`](https://developer.mozilla.org/En/DOM/Node.insertBefore).
*   [`nextSibling`](https://developer.mozilla.org/en/DOM/Node.nextSibling).
*   [`match()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/match).
*   [`nodeType`](https://developer.mozilla.org/en/DOM/Node.nodeType).
*   [`nodeValue`](https://developer.mozilla.org/en/DOM/Node.nodeValue).
*   [`parentNode`](https://developer.mozilla.org/en/parentNode).
*   [正则表达式](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。
*   [`removeChild()`](https://developer.mozilla.org/En/DOM/Node.removeChild).
*   [`trim()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/trim).

# visual-studio-2010 - VS2010 Professional - 仅在 Web 代码中调试非常慢

> ID：11621281
> 
> 赞同：0
> 
> 时间：2012-07-23T22:08:32.230
> 
> 标签：visual-studio-2010, debugging, visual-studio-2012

我有 VS2010 专业版，我最近开始在调试 MVC 网站时遇到问题。Controller 代码的调试非常慢，每个 F10 命令需要 20 秒才能移动到下一行。Javascript代码调试很快。我尝试了一个控制台应用程序和一个表单应用程序，调试很快。我还尝试创建一个空白的新 MVC 应用程序网站，但调试器速度变慢。我正在使用 IIS7.0。这最近开始发生，因为我最近安装了 VS2012 Ultimate RC。我想可能是这个原因，把当天安装的所有软件VS2012RC Ultimate都卸载了，调试器恢复正常。查看任务管理器 devenv.exe 使用了大约 1GB 的内存，而 w3wp.exe 也在消耗内存并增加到 800MB。有没有人最近安装了 VS2012 RC Ultimate 和 VS2012 Professional 并遇到了类似的问题？有谁知道这个问题的根本原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:15:16.510

尝试将 IntelliTrace 设置为仅在选项 -> IntelliTrace -> 常规中收集事件。这可能会加快调试速度。

# mongodb - jdoconfig.xml 中的 MongoDb ConnectionURL

> ID：11621284
> 
> 赞同：2
> 
> 时间：2012-07-23T22:09:03.187
> 
> 标签：mongodb, amazon-web-services, jdo, datanucleus, amazon-elastic-beanstalk

我已经在 AWS 上设置了一个 MongoDB 实例，并试图从另一个安装了我的 Web 应用程序的 AWS 实例连接到它。

以下是我的 jdoconfig.xml 文件的内容：

```
<jdoconfig xmlns="http://java.sun.com/xml/ns/jdo/jdoconfig"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://java.sun.com/xml/ns/jdo/jdoconfig http://java.sun.com/xml/ns/jdo/jdoconfig_3_0.xsd">

    <persistence-manager-factory name="MY-PMF">
        <property name="javax.jdo.PersistenceManagerFactoryClass"
            value="org.datanucleus.api.jdo.JDOPersistenceManagerFactory" />
        <property name="javax.jdo.option.ConnectionURL" value="mongodb://ec2-[...].eu-west-1.compute.amazonaws.com:27017/mydb" />
        <property name="javax.jdo.option.Mapping" value="mongodb" />
        <property name="javax.jdo.option.ConnectionUserName" value="myuser" />
        <property name="javax.jdo.option.ConnectionPassword" value="mypassword" />
        <property name="javax.jdo.option.Optimistic" value="false" />
        <property name="datanucleus.autoCreateSchema" value="true" />
    </persistence-manager-factory>
</jdoconfig> 
```

但是，Web 应用程序无法连接到 MongoDB 实例。以下是日志中的错误消息：

```
com.mongodb.MongoException$Network: can't call something : localhost/127.0.0.1:27017//ec2-[...].eu-west-1.compute.amazonaws.com:27017/mydb
    at com.mongodb.DBTCPConnector.call(DBTCPConnector.java:226)
    at com.mongodb.DBApiLayer$MyCollection.__find(DBApiLayer.java:313)
    at com.mongodb.DB.command(DB.java:174)
    at com.mongodb.DB.command(DB.java:158)
    at com.mongodb.DB.command(DB.java:198)
    at com.mongodb.DB.command(DB.java:144)
    at com.mongodb.DB._doauth(DB.java:555)
    at com.mongodb.DB.authenticate(DB.java:492)
    at org.datanucleus.store.mongodb.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:200)
    at org.datanucleus.store.mongodb.MongoDBStoreManager.addClasses(MongoDBStoreManager.java:127)
    at org.datanucleus.store.AbstractStoreManager.addClass(AbstractStoreManager.java:1137)
    at org.datanucleus.ObjectManagerImpl.newObjectId(ObjectManagerImpl.java:3310)
    at org.datanucleus.api.jdo.JDOPersistenceManager.newObjectIdInstance(JDOPersistenceManager.java:1627)
    at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1749)
    at com.myapp.server.auth.MyActionHandler.execute(MyActionHandler.java:67)
    at com.myapp.server.auth.MyActionHandler.execute(MyActionHandler.java:1)
    at com.gwtplatform.dispatch.server.AbstractDispatchImpl.doExecute(AbstractDispatchImpl.java:153)
    at com.gwtplatform.dispatch.server.AbstractDispatchImpl.execute(AbstractDispatchImpl.java:111)
    at com.gwtplatform.dispatch.server.AbstractDispatchServiceImpl.execute(AbstractDispatchServiceImpl.java:80)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:561)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
    at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:263)
    at com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:178)
    at com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:62)
    at com.google.inject.servlet.FilterDefinition.doFilter(FilterDefinition.java:168)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:58)
    at com.google.inject.servlet.FilterDefinition.doFilter(FilterDefinition.java:168)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:58)
    at com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:118)
    at com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:113)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:680)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:300)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)
Caused by: java.io.IOException: couldn't connect to [localhost/127.0.0.1:27017] bc:java.net.ConnectException: Connection refused
    at com.mongodb.DBPort._open(DBPort.java:222)
    at com.mongodb.DBPort.go(DBPort.java:111)
    at com.mongodb.DBPort.call(DBPort.java:78)
    at com.mongodb.DBTCPConnector.call(DBTCPConnector.java:217)
    ... 55 more 
```

看起来 ConnectionURL 不正确；DataNucleus JDO 实现正在尝试连接到 localhost 而不是我的数据库所在的实例。

**谁能告诉我正确的 ConnectionURL 应该是什么样子，或者如果您认为问题出在其他地方，请指出我的问题？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T07:14:34.567

你的意思是你没有正确指定connectionURL，根据 [http://www.datanucleus.org/products/accessplatform_3_1/mongodb/support.html](http://www.datanucleus.org/products/accessplatform_3_1/mongodb/support.html)

我希望像“mongodb:servername:/mydb”这样的东西……根据文档

# iphone - 按下超链接按钮后更改应用程序中的启动图像

> ID：11621285
> 
> 赞同：3
> 
> 时间：2012-07-23T22:09:03.043
> 
> 标签：iphone, xcode, image, hyperlink, launch

我用它从视图中转到 url：

```
-(IBAction)linkButtonPressed:(id)sender {
    [[UIApplication sharedApplication]openURL:[NSURL URLWithString:@"url"]];
} 
```

我已将启动图像添加到名为 default.png 和 default@2x.png 的项目中。

现在，如果从视图中输入超链接（切换到 safari），然后从后台运行中重新输入应用程序，然后像这样关闭：

```
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView deselectRowAtIndexPath:indexPath animated:TRUE];
    //The other cells here
    else if(indexPath.row==4) 
    {
    exit(0);
    }
} 
```

现在，启动图像被更改为按下链接按钮的视图的屏幕截图。如果我从 iphone 的主屏幕强制关闭应用程序（输入链接后），启动图像是黑色的。

如果我然后从另一个视图输入超链接并从 tableview 退出，则启动图像将更改为此视图的新屏幕截图等。

是什么原因造成的以及如何解决？

附言。使用 XCode 4 在 5.1.1 版本的 iPhone 设备上运行应用程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:19:06.193

这是因为当您进入 Safari 时，该应用程序处于后台状态。为防止这种情况发生，请关闭后台应用程序和快速应用程序切换，然后执行此操作。

[如何在 iOS 4 上禁用快速应用程序切换（多任务）？](https://stackoverflow.com/questions/4138368/how-to-disable-fast-application-switching-multitasking-on-ios-4)

# android - 是否可以使用 Eclipse 图形布局编辑器中的主题下拉菜单为 Android 活动设置主题？

> ID：11621287
> 
> 赞同：0
> 
> 时间：2012-07-23T22:09:06.130
> 
> 标签：android, eclipse

我知道如何在 Android 中为应用程序和/或活动设置主题，但我想知道是否可以使用 Eclipse 4.2、ADT 20.0.1 中的图形布局编辑器为活动更改主题。无论我将下拉菜单更改为什么，在我运行应用程序时始终使用来自 styles.xml 的 AppTheme 样式，尽管显示预览会根据我选择的内容发生变化。由于主题是在 AndroidManifest 中设置的，因此目前不可能吗？

![Eclipse 图形布局编辑器中的 Android 主题选择](../Images/e26d9913aae46ae55a53eee6e2e77659.png)

样式.xml：

```
<resources>
    <style name="AppTheme" parent="android:Theme.Light" />
</resources> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T22:13:50.953

The drop down box in the GUI is used to see what it looks like, if you want the theme changed then you have to edit the Android Manifest yourself

If you want to edit the theme using a drop down, in one of the tabs in the Android Manifest, I think its "Application" there is an option to change the theme and it has a list of themes.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:13:20.903

Yep, the theme must be set in the Manifest or in Java.

The drop-down on the layout editor is only there to help debug and test theme issues and whatnot, it doesn't have any effect on your actual app.

# watir - Java脚本下拉菜单访问Watir-web驱动

> ID：11621288
> 
> 赞同：0
> 
> 时间：2012-07-23T22:09:14.453
> 
> 标签：watir, watir-webdriver

我在尝试访问网站下拉菜单中的某些链接时遇到问题。当您将光标放在按钮上时，如第一张图片所示，菜单会下拉。下面是网页脚本的图片。我想要做的是单击下拉菜单中的搜索规范按钮。类似的代码会是这样的：

```
e.frame(:name => "content").frame(:name => "main").a(:index => 0).click.a(:index => 10).click 
```

但是，这不是有效的代码和平，我只是不知道正确的做法。

![在此处输入图像描述](../Images/8a18c006b60c9758dded9bc163165509.png)

![在此处输入图像描述](../Images/f785eea42d924a434ea575ad8aa356ee.png)

```
< e.frame(:name => "content").frame(:name => "main")
=> #<Watir::Frame:0x7f74b4d4 located=false selector={:name=>"main"}>
irb(main):064:0> my_frame.a(:text => 'Operations').click
Watir::Exception::UnknownObjectException: unable to locate element, using {:text
=>"Operations", :tag_name=>"a"}
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/watir-webdriver-0.6.1/lib/watir
-webdriver/elements/element.rb:365:in `assert_exists'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/watir-webdriver-0.6.1/lib/watir
-webdriver/elements/element.rb:95:in `click'
        from (irb):64
        from C:/Ruby193/bin/irb:12:in `<main>'
irb(main):065:0> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T02:34:41.687

下拉菜单似乎不在您发布的 HTML 部分中。它可能在 HTML 中更靠后。

您可以通过文本进行定位，而不是尝试通过索引进行定位，这很容易改变。尝试：

```
my_frame = e.frame(:name => "content").frame(:name => "main")
my_frame.a(:text => 'Operations').click
my_frame.a(:text => 'Search Specifications').click 
```

这假设“搜索规范”链接也与“操作”链接在同一框架中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:44:25.630

尝试这个：

```
myframe.a(:text, 'Operations').fire_event 'mouseover'
myframe.a(:text, 'Search Specifications').click 
```

不确定这是否完美，但想法是在选择下拉菜单后显示下拉菜单中的链接。玩弄其他元素。fire_event 方法是我所知道的使下拉菜单出现的最佳方法。

# python - Python 陷阱：简单赋值结束时的杂散逗号

> ID：11621289
> 
> 赞同：1
> 
> 时间：2012-07-23T22:09:16.180
> 
> 标签：python

我刚刚花了一天的大部分时间来寻找一个由赋值语句末尾的杂散逗号引起的错误。捕获异常的第三方回调库加剧了查找错误的难度，但这让我想知道为什么 Python (2.x) 不会引发语法错误而不是创建元组。考虑以下

```
>>> a = 1,
>>> a
(1,) 
```

如您所见，结尾的逗号创建了一个单例元组。这并不违反 Python 语法（请参阅[http://docs.python.org/reference/expressions.html#grammar-token-expression_list](http://docs.python.org/reference/expressions.html#grammar-token-expression_list)），但它肯定会导致一些意想不到的结果，例如

```
>>> a == 1,
(False,) 
```

对比

```
>>> (1,) == a
True 
```

虽然我现在明白发生了什么，但我对 Python 为什么允许这种语法而不是要求显式括号来创建元组感到困惑。**在某些情况下，这种行为是必要的，或者至少是有利的？** 在过去的 7 年里，我几乎只使用 Python 进行编程，而且我从来不需要以这种方式创建单例。在大多数方面，Python 是一种非常易读和明确的语言。这个特殊的“功能”似乎不是 Python 的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-23T23:16:28.397

这是 Python 的创建者 Guido van Rossum，[解释](http://python-history.blogspot.com/2009_02_01_archive.html)了这种语法是如何形成的：

> 向元组添加类似数组的接口的一个结果是，我必须想办法解决长度为 0 或 1 的元组的边缘情况。我从 ABC 中得到的规则之一是，每种数据类型在打印或转换为字符串，应由作为语言解析器的有效输入的表达式表示。因此，我需要为 0 和 1 长度的元组提供符号。同时我不想失去单元组和带括号的表达式之间的区别，所以我选择了一种丑陋但实用的方法，尾随的逗号会将表达式变成单元组和 "() " 将代表一个零元组。Python的元组语法通常不需要括号，这毫无价值，

另请参阅[TupleSyntax](http://wiki.python.org/moin/TupleSyntax)上的 PythonInfo Wiki ，尤其是“......定义元组的是逗号，而不是括号”。

虽然这种语法并不漂亮（Guido 说丑，但很实用），但我不认为这是一个陷阱。真正的问题是您的第三方库正在“捕获异常”，从而隐藏了有关您的错误的重要信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T22:16:55.930

有一个例子可以派上用场，交换两个值。当然，您可以在这里使用显式括号，但没有它们看起来会更好。

```
a, b = b, a 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-23T22:52:34.850

抱歉，我没有足够的代表发表评论，所以这将是它自己的答案。

这里有两个相关但不同的东西——元组解包和创建一个元组文字。

在 Mark Ransom 的回答中可以找到元组拆包。

虽然元组似乎是人们的绊脚石。它们不是用括号创建的，括号仅用于消歧。一个逗号定义了一个元组，`a,`一个带有一个元素的元组也是如此，因为，嗯，这就是一个元组，一个带有逗号的东西:)。（需要注意的是，对于空元组，而不是`,`看起来丑陋，我们会陷入困境`()`，这可能是人们似乎对此感到困难的根源。）

# visual-studio-2010 - 即使在我释放控制键后，如何修复 Visual Studio 2010 缩放滚动？

> ID：11621290
> 
> 赞同：6
> 
> 时间：2012-07-23T22:09:20.093
> 
> 标签：visual-studio-2010

我的 Visual Studio 2010 已进入一种状态，即普通使用鼠标滚轮（即未按下控制键）会导致文本大小增加或减小。

我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-23T22:09:20.093

Press the control key again and scroll on the page to recover from this state.

(This answer extracted from [my other question](https://stackoverflow.com/a/9010408/1512) because people seemed to be finding the answer useful there even though it's not relevant to the question being asked there.)

# android - eclipse中的android avd虚拟内存设置

> ID：11621292
> 
> 赞同：2
> 
> 时间：2012-07-23T22:09:28.960
> 
> 标签：android, eclipse, memory

我想增加我的`avd`. 我`Eclipse 3.7.2`用于开发，当我创建（或编辑）avd 时，我将“最大 VM 应用程序堆”设置为 64MB。如果我选择详细信息，它会确认这一点，如果我检查`config.ini`文件，我会看到“ `vm.heapSize=64`”是正确的。问题是在运行 avd 时这实际上并不正确。

在我的应用程序中，我运行“ `Runtime.getRuntime().maxMemory();`”，显示 24MB！！！！

同样地，

```
ActivityManager am = (ActivityManager) getSystemService(ACTIVITY_SERVICE);
int memoryClass = am.getMemoryClass(); 
```

显示 24MB

**更新：**我注意到在 hardware-qemu.ini 中的 "vm.heapSize=24" ？我将值更改为 64，但是当我启动 avd 时它又改回 24？

**更新：** totalMemory() 返回 ~15MB

**更新：** ADT 版本为 20.0.1

**更新：**我已经对此进行了一系列测试，使用许多不同的设置制作了许多不同的 AVD，我可以得出的结论是 AVD 或 Eclipse 有点错误，并且通常不反映您为 AVD 输入的设置值。请注意，我制作的 AVD 设备确实反映了 vm.heapSize=64。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:40:42.533

根据这个 Google Groups [question](https://groups.google.com/forum/?fromgroups#!topic/android-developers/aQzgLr0N6UE)和我对文档的解释，听起来这些值仅适用于您的应用程序，而不适用于整个模拟器。

我很想知道是否`totalMemory()`会返回 64m。这是[文档](http://developer.android.com/reference/java/lang/Runtime.html#totalMemory%28%29)。

**编辑：** getMemoryClass() 根据[文档](http://developer.android.com/reference/android/app/ActivityManager.html#getMemoryClass%28%29)：

> 返回当前设备的每个应用程序的近似内存类。

归结为我找不到任何编程方式来获取模拟器（设备）的堆大小。

**编辑2：**我认为您也可以在这里找到答案。- [Android 如何获得设备中的总内存 RAM？](https://stackoverflow.com/questions/3998713/android-how-do-you-get-total-memory-ram-in-the-device)

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T20:36:54.823

看起来 hardware.ini 优先于您的 skins 文件夹中的 config.ini （类似于platforms\android-8\skins\WVGA800，具体取决于您选择的默认分辨率）

# java - Read multiple lines from console and store it in array list in Java?

> ID：11621302
> 
> 赞同：0
> 
> 时间：2012-07-23T22:10:32.793
> 
> 标签：java, arraylist

Can anyone please help me with the code as how to read multiple lines from console and store it in array list? Example, my input from the console is:

```
12     abc      place1
13     xyz      place2 
```

and I need this data in ArrayList.

So far I tried this code:

```
Scanner scanner = new Scanner(System.in);
ArrayList informationList = new ArrayList<ArrayList>();
String information = "";
int blockSize = 0, count = 1;
System.out.println("Enter block size");
blockSize = scanner.nextInt();
System.out.println("Enter the Information ");
while (scanner.hasNext() && blockSize >= count) {
    scanner.useDelimiter("\t");
    information = scanner.nextLine();
    informationList.add(information);
    count++;
} 
```

Any help is greatly appreciated.

Input line from console is mix of string and integer

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:58:31.290

你有几个问题。

首先，您的 ArrayList 的初始化行是错误的。如果您想要一个对象列表以便同时保存整数和字符串，则需要放在`Object`尖括号内。此外，最好将泛型类型参数添加到变量定义中，而不仅仅是在对象实例化中。

接下来，您的计数变得混乱，因为您将其初始化为 1 而不是 0。我假设“块大小”实际上是指此处的行数。如果那是错误的，请发表评论。

接下来，您不想重置 Scanner 正在使用的分隔符，并且您当然不想在循环中执行此操作。默认情况下，扫描器将根据我认为您想要的任何空格分解令牌，因为您的数据由制表符和换行符分隔。

此外，您不需要在 while 条件下检查 hasNext() 。所有 next*() 方法都将阻塞等待输入，因此不需要调用 hasNext()。

最后，您并没有真正利用 Scanner 来做它最擅长的事情，即将令牌解析为您想要的任何类型。我在这里假设每个数据行都以一个整数开头，然后是两个字符串。如果是这种情况，只需调用 nextInt()，然后在循环内调用两次 next()，您将自动将所有数据解析为您需要的数据类型。

总而言之，这里是你的代码更新了我的所有建议以及其他一些让它运行的代码：

```
import java.util.ArrayList;
import java.util.Scanner;

public class Example {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        ArrayList<Object> list = new ArrayList<>();
        System.out.println("Enter block size");
        int blockSize = scanner.nextInt();
        System.out.println("Enter data rows:");
        int count = 0;
        while (count < blockSize) {
            list.add(scanner.nextInt());
            list.add(scanner.next());
            list.add(scanner.next());
            count++;
        }
        System.out.println("\nThe data you entered is:");
        System.out.println(list);
    }
} 
```

# wif - Getting ADFS claims from AD when user logs in via Azure ACS

> ID：11621307
> 
> 赞同：2
> 
> 时间：2012-07-23T22:10:44.777
> 
> 标签：wif, adfs2.0, adfs

Our chain goes:

ASP.NET app with WIF -> ADFS -> and maybe Azure ACS -> Facebook, Google etc.

We have users configured in AD with roles etc. These users can log-on to AD via ADFS and get their roles as per normal.

Optionally, they can log-on to one of the ACS providers and we have a use case that stores the ACS provider's unique ID in AD. If they use more than one provider, we have more than one mapping.

So we can map the user who log ins in via ACS to their "real" identity in AD.

What we are battling with is how to deliver the full set of claims to the users who login via ACS? Typically, you just get a name, email address and unique id.

Is there a claim rule that can search AD using the unique ID? This rule would have to establish which provider they used in order to use the correct unique ID in AD.

I guess we could query AD from the application but that means we have to add the code to all such applications?

We could probably do the conversion in a custom STS as well?

Any ideas, good links, articles etc?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:39:08.787

如果您的链条看起来像这样，您的场景可能会减少摩擦：

带有 WIF 的 ASP.NET 应用程序 -> Azure ACS ->（ADFS 或 Google 或 Facebook）

这是一个可行的选择吗？

当 ADFS 充当身份提供者而不是依赖方时，ACS 与 ADFS 的集成效果最好。此外，一方面 ADFS 很乐意与外部身份提供者联合以授予来自外部目录的用户访问权限，但我认为您不能让 ADFS 使用 ACS 颁发的令牌从其自己的本地 AD 目录中对用户进行身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T15:02:11.100

您可以通过使用 ACS 声明提供者信任中的声明规则语言在 ADFS 中创建自定义规则来实现此目的（有关一些语言文档，请参阅[此处](http://social.technet.microsoft.com/wiki/contents/articles/4792.understanding-claim-rule-language-in-ad-fs-2-0.aspx)和[此处](http://blogs.technet.com/b/askds/archive/2011/10/07/ad-fs-2-0-claims-rule-language-primer.aspx)）。

但是：我不确定您是否可以立即使用唯一 ID 搜索 AD，因为用于查询 AD 的参数类型未在声明规则语言中指定。规则模板使用 windows 帐户名称（布局：）`DOMAIN\USERNAME`进行搜索，因此我建议使用（自定义）属性存储而不是 AD 本身并将唯一 ID 映射到 windows 帐户名称。

假设您设置了属性存储，您可以创建自定义规则来设置 Windows 帐户名称声明，并使您能够使用 ADFS 的模板规则查询 AD。

自定义规则如下所示：

```
c:[Type == "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]
 => add(store = "YourAttributeStore", 
  types = ("http://schemas.microsoft.com/ws/2008/06/identity/claims/windowsaccountname"),
  query = "{0}", param = c.Value); 
```

要真正启用模板规则，您还需要在新生成的声明上设置颁发者，因为它们会检查它是否来自“AD AUTHORITY”。我不知道这是否是一种合法的方法，但我这样做是为了方便。这需要第二条规则，如下所示：

```
c:[Type == "http://schemas.microsoft.com/ws/2008/06/identity/claims/windowsaccountname"]
 => issue(Issuer = "AD AUTHORITY", OriginalIssuer = "AD AUTHORITY",
  Type = "http://schemas.microsoft.com/ws/2008/06/identity/claims/windowsaccountname",
  Value = c.Value); 
```

关于不同唯一 ID 提供者的区别，如何处理是您的选择。您可以为每个提供者创建一个自定义规则，让属性存储区做出区分或对您的属性存储区进行通用查询。声明规则语言的文档应该在这里为您提供帮助。

* * *

注意：这似乎是关于 ADFS/WIF/Claims based Identity 的书籍中经常避免的主题。这是我个人的解决方案，它可能不是最佳实践，这只是我想出的最方便的方法。如果有人知道这个特定主题的报道：请分享。

另请注意：ADFS 中的规则顺序很重要，在第一条规则中创建的声明在以下规则中可用，依此类推，这就是使这成为可能的原因。

编辑：一年前没有看到这个问题......希望这个答案对某人有所帮助。

# php - Extract common path from URI and Web Root

> ID：11621308
> 
> 赞同：2
> 
> 时间：2012-07-23T22:10:46.803
> 
> 标签：php, perl, url-routing

I have a self-built MVC fw with a router routing URLs such that the common `example.com/controller/action` is used. I'm running into issues when my application is deployed within a sub-directory such as

`example.com/my_app/controller/action/?var=value`

My router thinks `my_app` is the name of the controller now and `controller` is the method.

My current solution is to manually ask for any sub directory name in a config at install. I'd like to do this manually. See my question below and let me know if I'm going about solving this the wrong way and asking the wrong question.

My question: if I have two paths, how do I truncate the common pieces from the end of one and remove it from the end of the other.

A = /var/www/my_app/pub B = /my_app/pub/cntrl/actn

What's your quickest one liner to remove /my_app/pub from B and remain with /cntrl/actn? Basically looking for a perl-esque way of getting the common denominator like string.

Thanks for any input

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:20:58.817

```
my @physical_parts = split qr{/}, $physical_path;
my @logical_parts  = split qr{/}, $logical_path;

my @physical_suffix;
my @logical_prefix;
my $found = 0;
while (@physical_parts && @logical_parts) {
    unshift @physical_suffix, pop(@physical_parts);
    push @logical_prefix, shift(@logical_parts);

    if (@physical_suffix ~~ @logical_prefix) {
       $found = 1;
       last;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:21:28.473

我解决这个问题的方法是将此逻辑添加到[前端控制器](http://en.wikipedia.org/wiki/Front_Controller_pattern)（您的服务器将所有不存在的文件请求发送到的文件，通常是 index.php）。

```
$fontControllerPath = $_SERVER['SCRIPT_NAME'];
$frontControllerPathLength = strlen($fontControllerPath);

$frontControllerFileName = basename($fontControllerPath);
$frontControllerFileNameLength = strlen($frontControllerFileName);

$subdirectoryLength = $frontControllerPathLength - $frontControllerFileNameLength;

$url = substr($_SERVER['REQUEST_URI'], $subdirectoryLength - 1); 
```

[这是一个键盘演示](http://codepad.viper-7.com/dADZFT)。

这是做什么的？如果前端控制器位于（相对于 www 根目录）：`/subdir/myapp/`，那么它将[`$_SERVER['SCRIPT_NAME']`](http://php.net/manual/en/reserved.variables.server.php)是`/subdir/myapp/index.php`. 实际的请求 URI 包含在[`$_SERVER['REQUEST_URI']`](http://php.net/manual/en/reserved.variables.server.php). 例如，假设它是`/subdir/myapp/controller/action?extras=stuff`. 要删除子目录前缀，我们需要找到它的长度。[`basename()`](http://php.net/basename)这是通过从脚本名称相对于 www 根的长度中减去脚本名称的长度（从 检索）来找到的。

```
File that receives request: /subdir/myapp/index.php (length = 23)
Filename: index.php                                 (length = 9)
                                                                 -
-------------------------------------------------------------------
                                               14 chars to remove

/subdir/mpapp/controller/action?extras=stuff
              ^
              Cut off everything before here 
```

# facebook - 如何判断用户是否已登录并已接受我的应用程序

> ID：11621311
> 
> 赞同：0
> 
> 时间：2012-07-23T22:11:06.387
> 
> 标签：facebook, facebook-graph-api

我只是在用户页面上创建一个 facebook 标签。我正在使用 php facebook SDK，以及教程中的这个小片段（见下文）。我的问题是，如果用户登录 FB 并稍后返回我的页面 $user 找不到，他们必须再次连接。有没有办法知道他们已经登录并已授予我访问权限？

我希望这个问题有意义

```
$facebook = new Facebook(array(
    'appId'  => FB_APP_ID,
    'secret' => FB_APP_SECRET,
    'cookies' => 'true'
));
$user = $facebook->getUser();

if ($user) {
    $logoutUrl = $facebook->getLogoutUrl();
} else {
    $loginUrl = $facebook->getLoginUrl(array('scope' => 'publish_stream, manage_pages'));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:14:20.310

不，它不会在服务器端自动完成。要知道用户是谁 - 您需要让他们关注登录 url

或者

使用 JS SDK。在这种情况下，用户会自动登录，您只需要通过 JS 刷新页面（php sdk 附带了一个关于如何执行此操作的示例）

# google-app-engine - Is ndb async guaranteed to execute after application request has finished?

> ID：11621313
> 
> 赞同：8
> 
> 时间：2012-07-23T22:11:25.623
> 
> 标签：google-app-engine

I am using ndb to write a profiling model that logs some data per application request. Each request calls a ndb request by ndb.put_async to log the data, while the client do not care about the result. In essence, I do not want the application request to wait for saving statistics data for profiling.

However, I was confused about the explanation from the official documentation. If an application request has finished before the ndb request finishes, would the ndb request still be guaranteed to finish? The documentation indicates that

> if the request handler exists too early, the put might never happen

Under what criteria would this happen? Does this mean that regardless of whether a user care about the result, future.get_result needs to be called anyway just to make sure the ndb request is performed?

The original documentation ([https://developers.google.com/appengine/docs/python/ndb/async](https://developers.google.com/appengine/docs/python/ndb/async)) says:

> In this example, it's a little silly to call future.get_result: the application never uses the result from NDB. That code is just in there to make sure that the request handler doesn't exit before the NDB put finishes; if the request handler exits too early, the put might never happen. As a convenience, you can decorate the request handler with @ndb.toplevel. This tells the handler not to exit until its asynchronous requests have finished. This in turn lets you send off the request and not worry about the result.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T02:19:40.180

> 如果应用程序请求在 ndb 请求完成之前完成，是否仍能保证 ndb 请求完成？

不。

> 这是否意味着无论用户是否关心结果，都需要调用future.get_result 以确保执行ndb 请求？

基本上是的，但您可以使用 ndb.toplevel 装饰器为方便起见，这样您就不必显式地等待结果。也就是说，我认为这不是你想要的。

可能[任务队列](https://developers.google.com/appengine/docs/python/taskqueue/)是你想要的。请检查一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T19:50:16.383

感谢您的澄清。一般的 RPC（非 NDB）怎么样 - 例如，memcache.Client() 中的 incr_async()？撇开这是一个非常非常快的 RPC 调用不谈，是否保证 RPC 会完成？

即，下列哪项是正确的：

(a) 基础设施中有一些东西会在完成请求之前等待所有已知的 RPC

(b) 请求将完成，并且异步 RPC 也将完成，无论请求何时完成

(c) 机上 RPC 正式取消

(d) 别的东西？

# mysql - 如何删除 mySQL 重复条目

> ID：11621314
> 
> 赞同：2
> 
> 时间：2012-07-23T22:11:25.903
> 
> 标签：mysql, duplicates, sql-delete, duplicate-removal

我有一个带有重复条目的 mySQL 表（在某些情况下可能有多个重复项）。我有一个名为 id 的列，它可能包含重复的 id 和一个称为唯一 id 的列，顾名思义，它包含唯一的 id。使用以下 SQL 语句，我可以选择重复的行

```
SELECT id,
COUNT(id) AS NumOccurrences
FROM `TABLE 3`
GROUP BY id
HAVING ( COUNT(id) > 1 ) 
```

但是我如何删除它们（除其中一个之外的所有）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:29:04.463

```
DELETE t1 FROM test t1, test t2 WHERE t1.unique_id > t2.unique_id AND t1.id = t2.id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:35:03.300

您应该`UNIQUE INDEX`在唯一 id 字段上添加一个。这将防止更多重复项稍后潜入。

```
ALTER IGNORE `TABLE 3` ADD UNIQUE INDEX (`unique_id`); 
```

IGNORE 位将仅保留值为“unique_id”的第一行。您还应该避免在列名或表名中使用空格。它使编写 SQL 容易出错，因为您必须在名称周围使用刻度。

# asp.net - Sitecore 自定义路由（非 MVC）

> ID：11621322
> 
> 赞同：0
> 
> 时间：2012-07-23T22:12:04.493
> 
> 标签：asp.net, sitecore, sitecore6, asp.net-routing

我关注了这篇[文章](http://pentialized.dk/2008/11/11/sitecore-and-systemwebrouting/)和[这篇](https://stackoverflow.com/questions/1308226/sitecore-and-asp-net-mvc/1668051#1668051)文章，以测试为项目创建自定义路由条目。我试图在 global.asax 中注册一条类似这样的路线......

```
 void RegisterRoutes(RouteCollection routes)
    {
        routes.RouteExistingFiles = true;
        routes.MapPageRoute("about", "about/us", "~/About/Company", false);
    } 
```

但不幸的是，这会导致 404。我认为 asp.net 路由正在寻找一个物理页面“About/Company.aspx”，因为它更多是从 sitecore/content/site/ 渲染的页面/链接站点核心树中的关于/公司。您知道是否有办法将其重定向到呈现的站点核心 url/项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T09:04:10.200

使用路由来执行此操作可能不是最佳解决方案。

将 URL 映射到特定项目的最简单方法是设置别名。有关别名的更多信息，请参阅[Data Definition Cookbook](http://sdn.sitecore.net/upload/sitecore6/datadefinitioncookbook-a4.pdf)中的第 6.1 章。

如果您需要更多控制权，您可以创建一个自定义 ItemResolver，它可以位于 HttpRequestBegin 管道中的默认 ItemResolver 之后，并且可以运行您的自定义 URL/项目映射。

# sql - 计算日期差异的不匹配

> ID：11621323
> 
> 赞同：-1
> 
> 时间：2012-07-23T22:12:10.360
> 
> 标签：sql, join, hive

下面是表1中的数据

```
BUYER_ID   |   ITEM_ID         |    CREATED_TIME
-----------+-------------------+------------------------
1345653        110909316904         2012-07-09 21:29:06
1345653        151851771618         2012-07-09 19:57:33
1345653        221065796761         2012-07-09 19:31:48
1345653        400307563710         2012-07-09 18:57:33
1345653        310411560125         2012-07-09 16:09:49
1345653        120945302103         2012-07-09 13:40:23
1345653        261060982989         2012-07-09 09:02:21 
```

下面是表2中的数据

```
USER_ID   |   PRODUCT_ID           |    LAST_TIME
-----------+-------------------+----------------------
1345653       110909316904         2012-07-09 21:30:06
1345653       151851771618         2012-07-09 19:57:33
1345653       221065796761         2012-07-09 19:31:48
1345653       400307563710         2012-07-09 18:57:33 
```

**问题陈述：-**

我需要`Table2`比较`Table1`on`BUYER_ID`和`USER_ID`。`CREATED_TIME`如果和之间的差异`LAST_TIME`大于，我需要找到不匹配的计数`15 minutes`

因此，如果您查看上面的示例，则可以看到两个表中的第一行`ITEM_ID`and`PRODUCT_ID`相同但又不相同，`CREATED_TIME`并且`LAST_TIME`这两次之间的差异仅为 1 分钟。因此，如果差异大于 15 分钟，那么我想将它们显示为错误。所以预期的输出将是上述情况-

```
BUYER_ID    ERROR
1345653       1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:21:05.520

首先，找到所有匹配的买家：

```
select *
from table1 t1 join
     table2 t2
     on t1.buyer_id = t2.user_id and
        datediff(min, t1.created_time, t2.last_time) between -15 and 15 
```

使用它，现在找到不匹配的情况：

```
with matches as (
     select *
     from table1 t1 join
          table2 t2
          on t1.buyer_id = t2.user_id and
             datediff(min, t1.created_time, t2.last_time) between -15 and 15
    )
select *
from table1 t1 left outer join
     matches m
     on t1.buyer_id = m.user_id and
        t1.product_id = m.product_id and
        t1.created_time = m.created_time
where m.buyer_id is null 
```

# java - Java start program on user login (platform-wide)

> ID：11621329
> 
> 赞同：1
> 
> 时间：2012-07-23T22:12:38.830
> 
> 标签：java, cross-platform, startup, startupscript

Across linux, MAC, and Windows, is there any way to make a Java program startup on login? I know on windows their would just need to be a shortcut to the jar file in the user's startup folder. But for linux and MAC what should i do?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:21:54.657

没有在登录或引导时启动程序的跨平台方法，但您可以单独配置每个方法。

**Windows** - 将程序放在用户的启动文件夹中或使用计划任务，两者都在此处详细说明：[[说明]](http://www.sevenforums.com/tutorials/1401-startup-programs-change.html)

**Mac** - 通过系统偏好配置：[[说明]](http://www.apple.com/findouthow/mac/#appstartup)

**Linux** - 配置`~/.bashrc`为在登录时启动或用于`/etc/rc.d/rc.sysinit`在启动时启动。

# java - Java - 通过二维数组的路径中的最大总和

> ID：11621337
> 
> 赞同：9
> 
> 时间：2012-07-23T22:13:36.323
> 
> 标签：java, arrays, path, 2d, sum

基本上我有一个与此类似的问题：

有一个由 2D 方形阵列表示的草莓植物花园。每个植物（每个元素）都有许多草莓。您从阵列的左上角开始，您只能向右或向下移动。我需要设计一种递归方法来计算穿过花园的路径，然后输出哪一个产生的草莓最多。

我想我对非常简单的递归问题有所了解，但是这个问题已经超出了我的想象。我不确定从哪里开始或从哪里开始创建递归方法。

非常感谢与代码相关的任何帮助或帮助我理解此问题背后的概念。谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-23T23:00:08.913

就像 dasblinkenlight 所说，最有效的方法是使用记忆化或动态编程技术。我倾向于更喜欢动态编程，但我将在这里使用纯递归。

答案围绕着一个基本问题的答案：“如果我在我的领域的 r 行和 c 列的正方形中，我如何评估从左上角到这里的路径，以使草莓的数量最大化？ "

要实现的关键是只有两种方法可以进入 r 行和 c 列的绘图：要么我可以从上方使用 r-1 行和 c 列的绘图，要么我可以从侧面进入，使用 r 行和 c-1 列中的图。在那之后，你只需要确保你知道你的基本情况......这意味着，从根本上说，我的纯递归版本将类似于：

```
int[][] field;    
int max(int r, int c) {
    //Base case
    if (r == 0 && c == 0) {
        return field[r][c];
    }
    //Assuming a positive number of strawberries in each plot, otherwise this needs
    //to be negative infinity
    int maxTop = -1, maxLeft = -1;
    //We can't come from the top if we're in the top row
    if (r != 0) {
        maxTop = field[r-1][c];
    }
    //Similarly, we can't come from the left if we're in the left column
    if (c != 0) {
        maxLeft = field[r][c-1];
    }
    //Take whichever gives you more and return..
    return Math.max(maxTop, maxLeft) + field[r][c];
} 
```

调用 max(r-1, c-1) 来获得答案。请注意这里有很多低效率；通过使用动态编程（我将在下面提供）或记忆（已经定义），你会做得更好。不过要记住的是，DP 和记忆技术都是来自这里使用的递归原理的更有效的方法。

DP：

```
int maxValue(int[][] field) {
    int r = field.length;
    int c = field[0].length;
    int[][] maxValues = new int[r][c];
    for (int i = 0; i < r; i++) {
        for (int j = 0; j < c; j++) {
            if (i == 0 && j == 0) {
                maxValues[i][j] = field[i][j];
            } else if (i == 0) {
                maxValues[i][j] = maxValues[i][j-1] + field[i][j];
            } else if (j == 0) {
                maxValues[i][j] = maxValues[i-1][j] + field[i][j];
            } else {
                maxValues[i][j] = Math.max(maxValues[i][j-1], maxValues[i-1][j]) + field[i][j];
            }
        }
    }
    return maxValues[r-1][c-1];
} 
```

在这两种情况下，如果您想重新创建实际路径，只需保留一个与“我是从上方还是左侧来”相对应的 2D 布尔值表？如果最草莓路径来自上方，则设为 true，否则设为 false。这可以让您在计算后回溯补丁。

请注意，原则上这仍然是递归的：在每一步，我们都在回顾之前的结果。我们只是碰巧缓存了我们之前的结果，这样我们就不会浪费大量的工作，而且我们正在以一种智能的顺序攻击子问题，以便我们总能解决它们。有关动态编程的更多信息，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Dynamic_programming)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-23T22:21:15.297

您可以使用[memoization](http://en.wikipedia.org/wiki/Memoization)来做到这一点。这是类似 Java 的伪文档（`memo`, `R`, 和`C`被假定为可用于该`max`方法的实例变量）。

```
int R = 10, C = 20;
int memo[][] = new int[R][C];
for (int r=0 ; r != R ; r++)
    for (int c = 0 ; c != C ; c++)
        memo[r][c] = -1;
int res = max(0, 0, field);

int max(int r, int c, int[][] field) {
    if (memo[r][c] != -1) return memo[r][c];
    int down = 0; right = 0;
    if (r != R) down = max(r+1, c, field);
    if (c != C) right = max(r, c+1, field);
    return memo[r][c] = (field[r][c] + Math.max(down, right));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-15T22:37:15.530

您可以使用 DP 制表方法解决此问题，使用该方法您可以将空间从 O(m*n) 节省到 O(n)。使用 DP 记忆，您需要 m*n 矩阵来存储中间值。以下是我的 Python 代码。希望它可以提供帮助。

```
def max_path(field):
    dp = [sum(field[0][:i]) for i in range(1, len(field[0]) + 1)]
    for i in range(1, len(field)):
        for j in range(len(dp)):
            dp[j] = min(dp[j], dp[j - 1] if j > 0 else float('inf')) + field[i][j]
    return dp[-1] 
```

# android - Android ksoap2 sending complex object

> ID：11621338
> 
> 赞同：1
> 
> 时间：2012-07-23T22:13:36.910
> 
> 标签：android, serialization, soap, ksoap2, ksoap

I am trying to send a complex object through a soap service call in an android application. I am getting a quite weird error.

The class that I am trying to serialize and send (and the one that are included to it) is the following:

```
public class TSavedMessage extends BaseObject{
public static Class TSAVEDMESSAGE_CLASS = new TSavedMessage().getClass();
protected String sToken;
protected String dateDeferredDelivery;
protected int idDepartment;
protected boolean bDraft;
protected String txtRelationsType;
protected String txtRelatedIds;
protected int idForwardOf;
protected int idReplyOf;
protected String numPriority;
protected boolean bReadReceipt;
protected boolean bDeliveryReport;
protected String txtKeywords;
protected int numTimeOffset;
protected String txtTimeZone;
protected String txtSubject;
protected String txtBody;
protected TRecipient[] recipients;

public TSavedMessage() {
}

public TSavedMessage(String sToken, String dateDeferredDelivery, int idDepartment, boolean bDraft, String txtRelationsType, String txtRelatedIds, int idForwardOf, int idReplyOf, String numPriority, boolean bReadReceipt, boolean bDeliveryReport, String txtKeywords, int numTimeOffset, String txtTimeZone, String txtSubject, String txtBody, TRecipient[] recipients, int[] vesselRelations) {
    this.sToken = sToken;
    this.dateDeferredDelivery = dateDeferredDelivery;
    this.idDepartment = idDepartment;
    this.bDraft = bDraft;
    this.txtRelationsType = txtRelationsType;
    this.txtRelatedIds = txtRelatedIds;
    this.idForwardOf = idForwardOf;
    this.idReplyOf = idReplyOf;
    this.numPriority = numPriority;
    this.bReadReceipt = bReadReceipt;
    this.bDeliveryReport = bDeliveryReport;
    this.txtKeywords = txtKeywords;
    this.numTimeOffset = numTimeOffset;
    this.txtTimeZone = txtTimeZone;
    this.txtSubject = txtSubject;
    this.txtBody = txtBody;
    this.recipients = recipients;
}

public String getSToken() {
    return sToken;
}

public void setSToken(String sToken) {
    this.sToken = sToken;
}

public String getDateDeferredDelivery() {
    return dateDeferredDelivery;
}

public void setDateDeferredDelivery(String dateDeferredDelivery) {
    this.dateDeferredDelivery = dateDeferredDelivery;
}

public int getIdDepartment() {
    return idDepartment;
}

public void setIdDepartment(int idDepartment) {
    this.idDepartment = idDepartment;
}

public boolean isBDraft() {
    return bDraft;
}

public void setBDraft(boolean bDraft) {
    this.bDraft = bDraft;
}

public String getTxtRelationsType() {
    return txtRelationsType;
}

public void setTxtRelationsType(String txtRelationsType) {
    this.txtRelationsType = txtRelationsType;
}

public String getTxtRelatedIds() {
    return txtRelatedIds;
}

public void setTxtRelatedIds(String txtRelatedIds) {
    this.txtRelatedIds = txtRelatedIds;
}

public int getIdForwardOf() {
    return idForwardOf;
}

public void setIdForwardOf(int idForwardOf) {
    this.idForwardOf = idForwardOf;
}

public int getIdReplyOf() {
    return idReplyOf;
}

public void setIdReplyOf(int idReplyOf) {
    this.idReplyOf = idReplyOf;
}

public String getNumPriority() {
    return numPriority;
}

public void setNumPriority(String numPriority) {
    this.numPriority = numPriority;
}

public boolean isBReadReceipt() {
    return bReadReceipt;
}

public void setBReadReceipt(boolean bReadReceipt) {
    this.bReadReceipt = bReadReceipt;
}

public boolean isBDeliveryReport() {
    return bDeliveryReport;
}

public void setBDeliveryReport(boolean bDeliveryReport) {
    this.bDeliveryReport = bDeliveryReport;
}

public String getTxtKeywords() {
    return txtKeywords;
}

public void setTxtKeywords(String txtKeywords) {
    this.txtKeywords = txtKeywords;
}

public int getNumTimeOffset() {
    return numTimeOffset;
}

public void setNumTimeOffset(int numTimeOffset) {
    this.numTimeOffset = numTimeOffset;
}

public String getTxtTimeZone() {
    return txtTimeZone;
}

public void setTxtTimeZone(String txtTimeZone) {
    this.txtTimeZone = txtTimeZone;
}

public String getTxtSubject() {
    return txtSubject;
}

public void setTxtSubject(String txtSubject) {
    this.txtSubject = txtSubject;
}

public String getTxtBody() {
    return txtBody;
}

public void setTxtBody(String txtBody) {
    this.txtBody = txtBody;
}

public TRecipient[] getRecipients() {
    return recipients;
}

public void setRecipients(TRecipient[] recipients) {
    this.recipients = recipients;
}

public Object getProperty(int index) {
    switch (index) {
    case 0:
        return sToken;
    case 1: 
        return dateDeferredDelivery;
    case 2:
        Integer iDepartment = new Integer(idDepartment);
        return iDepartment;
    case 3:
        Boolean isDraft = new Boolean(bDraft);
        return isDraft;
    case 4:
        return txtRelationsType;
    case 5:
        return txtRelatedIds;
    case 6:
        Integer iForwardOf = new Integer(idForwardOf);
        return iForwardOf;
    case 7:
        Integer iReplyOf = new Integer(idReplyOf);
        return iReplyOf;
    case 8:
        return numPriority;
    case 9:
        Boolean isReadReceipt = new Boolean(bReadReceipt);
        return isReadReceipt;
    case 10:
        Boolean isDeliveryReport = new Boolean(bDeliveryReport);
        return isDeliveryReport;
    case 11:
        return txtKeywords;
    case 12:
        Integer iTimeOffset = new Integer(numTimeOffset);
        return iTimeOffset;
    case 14:
        return txtTimeZone;
    case 15:
        return txtSubject;
    case 16:
        return txtBody;
    case 17:
        return recipients; // complex type
    default:
        return null;
    }
}

public int getPropertyCount() {
    return 18;
}

public void getPropertyInfo(int index, Hashtable properties, PropertyInfo info) {
    switch (index) {
    case 0:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "sToken";
        break;
    case 1: 
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "dateDeferredDelivery";
        break;
    case 2:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "idDepartment";
        break;
    case 3:
        info.type = PropertyInfo.BOOLEAN_CLASS;
        info.name = "bDraft";
        break;
    case 4:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "txtRelationsType";
        break;
    case 5:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "txtRelatedIds";
        break;
    case 6:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "idForwardOf";
        break;
    case 7:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "idReplyOf";
        break;
    case 8:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "numPriority";
        break;
    case 9:
        info.type = PropertyInfo.BOOLEAN_CLASS;
        info.name = "bReadReceipt";
        break;
    case 10:
        info.type = PropertyInfo.BOOLEAN_CLASS;
        info.name = "bDeliveryReport";
        break;
    case 11:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "txtKeywords";
        break;
    case 12:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "numTimeOffset";
        break;
    case 14:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "txtTimeZone";
        break;
    case 15:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "txtSubject";
        break;
    case 16:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "txtBody";
        break;
    case 17:
        info.type = PropertyInfo.VECTOR_CLASS;
        info.name = "recipients"; // complex type
        break;
    default:
        break;
    }       
}

public void setProperty(int index, Object value) {
    switch (index) {
    case 0:
        sToken = value.toString();
        break;
    case 1: 
        dateDeferredDelivery = value.toString();
        break;
    case 2:
        idDepartment = Integer.parseInt(value.toString());
        break;
    case 3:
        if(value.toString().equalsIgnoreCase("false")) bDraft = false;
        else bDraft = true;
        break;
    case 4:
        txtRelationsType = value.toString();
        break;
    case 5:
        txtRelatedIds = value.toString();
        break;
    case 6:
        idForwardOf = Integer.parseInt(value.toString());
        break;
    case 7:
        idReplyOf = Integer.parseInt(value.toString());
        break;
    case 8:
        numPriority = value.toString();
        break;
    case 9:
        if(value.toString().equalsIgnoreCase("false")) bReadReceipt = false;
        else bReadReceipt = true;
        break;
    case 10:
        if(value.toString().equalsIgnoreCase("false")) bDeliveryReport = false;
        else bDeliveryReport = true;
        break;
    case 11:
        txtKeywords = value.toString();
        break;
    case 12:
        numTimeOffset = Integer.parseInt(value.toString());
        break;
    case 14:
        txtTimeZone = value.toString();
        break;
    case 15:
        txtSubject = value.toString();
        break;
    case 16:
        txtBody = value.toString();
        break;
    case 17:
        recipients = (TRecipient[]) value; // complex type
        break;
    default:
        break;
    }
} 
```

}

```
public class TRecipient extends BaseObject{
public static Class TRECIPIENT_CLASS = new TRecipient().getClass();
protected int idRecipient;
protected String txtRealAddress;
protected String Visibility;

public TRecipient() {
}

public TRecipient(int idRecipient, String txtRealAddress, String visibility) {
    this.idRecipient = idRecipient;
    this.txtRealAddress = txtRealAddress;
    this.Visibility = visibility;
}

public int getIdRecipient() {
    return idRecipient;
}

public void setIdRecipient(int idRecipient) {
    this.idRecipient = idRecipient;
}

public String getTxtRealAddress() {
    return txtRealAddress;
}

public void setTxtRealAddress(String txtRealAddress) {
    this.txtRealAddress = txtRealAddress;
}

public String getVisibility() {
    return Visibility;
}

public void setVisibility(String visibility) {
    this.Visibility = visibility;
}

public Object getProperty(int index) {
    switch (index) {
    case 0:
        Integer iRecipient = new Integer(idRecipient);
        return iRecipient;
    case 1: 
        return txtRealAddress;
    case 2:
        return Visibility;
    default:
        return null;
    }
}

public int getPropertyCount() {
    return 3;
}

public void getPropertyInfo(int index, Hashtable properties, PropertyInfo info) {
    switch (index) {
    case 0:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "idRecipient";
        break;
    case 1:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "txtRealAddress";
        break;
    case 2:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "Visibility";
        break;
    default:
        break;
    }
}

public void setProperty(int index, Object value) {
    switch (index) {
    case 0:
        idRecipient = Integer.parseInt(value.toString());
        break;
    case 1: 
        txtRealAddress = value.toString();
        break;
    case 2:
        Visibility = value.toString();
        break;
    default:
        break;
    }
} 
```

}

The method that sends the request is the following:

```
 TSavedMessage msgTemp = new TSavedMessage();
        msgTemp.setSToken(LoginActivity.sToken);
        DateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
        Date date = new Date();
        msgTemp.setDateDeferredDelivery(dateFormat.format(date));
        msgTemp.setIdDepartment(datasource.getDepartmentID(departmentString));
        msgTemp.setBDraft(false);
        msgTemp.setTxtRelationsType("");
        msgTemp.setTxtRelatedIds("");
        msgTemp.setIdForwardOf(params[1]);
        msgTemp.setIdReplyOf(params[2]);
        msgTemp.setNumPriority("Normal");
        msgTemp.setBReadReceipt(false);
        msgTemp.setBDeliveryReport(false);
        msgTemp.setTxtKeywords(keywords.getText().toString());
        msgTemp.setNumTimeOffset(0);
        msgTemp.setTxtTimeZone("0");
        msgTemp.setTxtSubject(subject.getText().toString());
        msgTemp.setTxtBody(body.getText().toString());
        TRecipient[] recarrayTemp = new TRecipient[1];
        recarrayTemp[0] = new TRecipient(0, "nickvoulgaris@hotmail.com", "To");
        msgTemp.setRecipients(recarrayTemp);

        SoapObject recipients = new SoapObject(LoginActivity.NAMESPACE, "Recipients");
        SoapObject recarray[] = new SoapObject[1];
        for (int i = 0; i < 1; i++){
            recarray[i] = new SoapObject(BaseObject.NAMESPACE, "TRecipient");
            recarray[i].addProperty("idRecipient", Integer.toString(0));
            recarray[i].addProperty("txtRealAddress", "nickvoulgaris@hotmail.com");
            recarray[i].addProperty("Visibility", "To");
            recipients.addProperty("TRecipient", recarray[i]);
        }

        SoapObject msg = new SoapObject(BaseObject.NAMESPACE, "MessageToSend");
        msg.addProperty("sToken", LoginActivity.sToken);
        msg.addProperty("dateDeferredDelivery", msgTemp.getDateDeferredDelivery());
        msg.addProperty("idDepartment", Integer.toString(msgTemp.getIdDepartment()));
        msg.addProperty("bDraft", "false");
        msg.addProperty("txtRelationsType", Integer.toString(0));
        msg.addProperty("txtRelatedIds", Integer.toString(0));
        msg.addProperty("idForwardOf", Integer.toString(0));
        msg.addProperty("idReplyOf", Integer.toString(0));
        msg.addProperty("numPriority", msgTemp.getNumPriority());
        msg.addProperty("bReadReceipt", "false");
        msg.addProperty("bDeliveryReport", "false");         
        msg.addProperty("txtKeywords", msgTemp.getTxtKeywords());
        msg.addProperty("numTimeOffset", msgTemp.getNumTimeOffset());
        msg.addProperty("txtTimeZone", msgTemp.getTxtTimeZone());
        msg.addProperty("txtSubject", msgTemp.getTxtSubject());
        msg.addProperty("txtBody", msgTemp.getTxtBody());
        msg.addProperty("Recipients", recipients);

        SoapObject rpc = new SoapObject(BaseObject.NAMESPACE, METHOD_NAME);       
        rpc.addProperty("sToken", LoginActivity.sToken);
        rpc.addProperty("MessageToSend", msg);

        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.bodyOut = rpc;
        envelope.dotNet = true;
        envelope.encodingStyle = SoapSerializationEnvelope.XSD;

        try {
            HttpTransportSE androidHttpTransport = new HttpTransportSE(LoginActivity.URL); 
            androidHttpTransport.debug = true;
            androidHttpTransport.setXmlVersionTag("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
            androidHttpTransport.call(SOAP_ACTION, envelope);
            System.out.println("=== " + envelope.getResponse().toString());                 
        }
        catch(XmlPullParserException e) {
            e.printStackTrace();
        }
        catch(IOException e) {
            e.printStackTrace();
        } 
```

Finally, the error that I'm getting is this one:

```
 SoapFault - faultcode: 'EConvertError' faultstring: '''0nickvoulgaris@hotmail.comTo'' is not a valid integer value' 
```

faultactor: 'null' detail: null

It is quite unfortunate that the error points me to nowhere. I cannot understand *why* is trying to pass these 3 fields as an Integer. Also what troubles me is the fact that there is a triple quote in the left hand side and a double one in the right hand side.

Any thoughts could prove extremely valuable. Thanks in advance.

Also, the soap object that this code generates and tries to send seems perfectly ok. It is the following:

```
MobSaveMessage{
sToken=MOB-2704FB8FFBC946469408A3BEE90CA163; 
MessageToSend=MessageToSend{
    sToken=MOB-2704FB8FFBC946469408A3BEE90CA163; 
    dateDeferredDelivery=2012/07/25 13:30:36; 
    idDepartment=18; 
    bDraft=false; 
    txtRelationsType=0; 
    txtRelatedIds=0; 
    idForwardOf=0; 
    idReplyOf=0; 
    numPriority=Normal; 
    bReadReceipt=false; 
    bDeliveryReport=false; 
    txtKeywords=key; 
    numTimeOffset=0; 
    txtTimeZone=0; 
    txtSubject=sub; 
    txtBody=mail;
    Recipients=Recipients{
        TRecipient=TRecipient{
            idRecipient=0; 
            txtRealAddress=nickvoulgaris@hotmail.com; 
            Visibility=To; 
        }; 
    }; 
}; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:16:01.083

毕竟，我们收到了与规范一起发送给我们的错误版本的 WSDL 文件。如果我给任何人带来麻烦，我真的很抱歉。真的不是我的错。我只是在回答，以防有人遇到问题。

# actionscript-3 - AS3 - 如何从单独的类访问对象实例

> ID：11621345
> 
> 赞同：0
> 
> 时间：2012-07-23T22:14:11.203
> 
> 标签：actionscript-3, flash, flash-cs5, flashdevelop

我有一个游戏引擎类，它在游戏加载时创建我的主角实例和游戏边框实例，如下所示：

```
public class Engine extends MovieClip
{
     var char:Char = new Char(stage);
     stage.addChildAt(char, 1);

     var border1:Border = new Border();
     stage.addChild(border1);

    } 
```

我想访问在我的 Char 类的 Engine 类中创建的变量border1。这可能吗，如果可以，我该怎么做？

我试过改变代码，所以border1是静态的，就像这样

```
static var border1:Border = new Border(); 
```

但后来我得到

```
error 1012: The static attribute may be used only on definitions inside a class. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:27:59.603

你可以通过几种方式做到这一点。

```
1\.  Create the border1 and char instances in reverse order and pass the border1 to the char instance to maintain a reference.

var border1:Border = new Border();
stage.addChild(border1);

var char:Char = new Char(stage, border1);
stage.addChildAt(char, 1);

// Char consructor

public function Char(target:DisplayObjectContainter, border:Border):void {
    ...
    this._border = border;
}

// Now you have a reference to the border1 instance within your char instance. 
```

您也可以在不将border1 实例传递给构造函数的情况下执行此操作，而只需添加一个设置此属性的方法。

```
public function setBorder(border:Border):void {
    this._border = border;
}

// OR

public function set border(border:Border):void {
    this._border = border;
} 
```

另一种选择是让 Engine 实例保持对边界的引用并允许通过 Engine 实例进行通信。例如，

```
public class Engine extends MovieClip {

    public var char:Char;
    public var border1:Border;

    public function Engine():void {
        char = new Char(stage);
        stage.addChildAt(char, 1);

        border1 = new Border();
        stage.addChild(border1);
    } 
```

现在，如果 char 实例有对引擎实例的引用，那么边界实例可以被`myEngineInstance.border1`.

或者您可以将边框实例设为静态。将其设为静态将允许 Char 实例内部的代码，例如：

```
Engine.border1.<whatever> 
```

# php - XERO-API is working on live server, but failing on test server

> ID：11621346
> 
> 赞同：0
> 
> 时间：2012-07-23T22:14:12.700
> 
> 标签：php, activecollab

Okay so the basically I'm building an application to connect to xero on the activecollab framework. And I'm testing the [xeroapi](https://github.com/XeroAPI/PHP-Xero) php script created by David Pitman. And I'm just trying to find out why my browser responds with `The connection to the server was reset while the page was loading.` (but doesn't generated any `liveheaders` nor does `firebug` pick anything up)...

[![thumb](../Images/5f3e8418b1df48aaad039c7f4610ea49.png)](http://iforce.co.nz/i/sj2er1dz.gy1.png)
[(source: [iforce.co.nz](http://iforce.co.nz/i/iq5bxw0r.5gz.png))]

Here is a snippet of code, that is being used. (*Everything has been setup prior using the XERO Api previewer and openssl.*)

```
 define('XERO_KEY','my-key-here'); //hidden for privacy reasons
    define('XERO_SECRET','my-key-here'); //hidden for privacy reasons
    define('XERO_PUBLIC_KEY_PATH', 'path/to/public.key');
    define('XERO_PRIVATE_KEY_PATH', 'path/to/privatekey.pem');

    $xero = new Xero(XERO_KEY, XERO_SECRET, XERO_PUBLIC_KEY_PATH, XERO_PRIVATE_KEY_PATH, 'xml' );  
    $organisation = $xero->organisation;  

    //echo the results back  
    if ( is_object($organisation) ) {  
    //use this to see the source code if the $format option is "xml"  
    echo htmlentities($organisation->asXML()) . "<hr />";  
    } else {  
    //use this to see the source code if the $format option is "json" or not specified  
    echo json_encode($organisation) . "<hr />";  
    } 
```

And my problem is... that the error_log (php) doesn't display any errors a part from a warning:

```
2012-07-23 21:59:42 Notice : Undefined index: port (at C:\xampp\htdocs\ac3\activecollab\3.1.10\modules\xero_invoice_manager\lib\xero\xero.class.php on 644 line) 
```

The code on xero.class.php line 644

```
/**
* parses the url and rebuilds it to be
* scheme://host/path
*/
public function get_normalized_http_url() {
$parts = parse_url($this->http_url);

$port = @$parts['port']; //this line says its undefined
$scheme = $parts['scheme'];
$host = $parts['host'];
$path = @$parts['path'];

$port or $port = ($scheme == 'https') ? '443' : '80';

if (($scheme == 'https' && $port != '443')
    || ($scheme == 'http' && $port != '80')) {
  $host = "$host:$port";
}
return "$scheme://$host$path";
} 
```

From investigating I've found on `print_r` the result of `$parts` in a `preformatted tag` is..

```
Array
(
    [scheme] => https
    [host] => api.xero.com
    [path] => /api.xro/2.0/Organisation
) 
```

The same information is used on a live server (for the past couple of months). but the xeroapi class is not working on the test server, does anyone have any advice as to why it isn't connecting? I'm running `XAMPP Control Panel` with apache on `port 80` and `PHP Version 5.3.8`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:24:44.197

我不确定你的端口问题。

但是，Xero API 需要 OAuth 设置，这可能是在 Xero 类中为您完成的。OAuth 的一部分内容是设置回调域，这需要您向 Xero 注册一个回调域。Xero 允许您使用注册域的子域，我假设 Xero 类使用请求信息来设置正确的域。

在 localhost 上，该域是 localhost，它不是子域。你可以注册 localhost，或者做我做过的事情（因为我无权访问 Application 帐户），并在你的 hosts 文件中设置一个特殊的本地子域。

因此，如果您使用`example.com`.，那么一个好的“本地”域是`local.example.com`. 希望有帮助。

# jquery - jquery图像悬停过渡/淡入淡出？

> ID：11621349
> 
> 赞同：-1
> 
> 时间：2012-07-23T22:14:27.833
> 
> 标签：jquery, html, css

我不太确定如何调用效果，因为我不明白您说 javascript 或 jquery 时的区别。我什么都做不了。

所以，我在 html/css 中制作一个菜单，我想在悬停菜单项时制作一个淡入淡出效果。我不确定这样的事情是否存在，但我发现了一些类似的例子，但不完全是我需要的。

[http://greg-j.com/static-content/hover-fade.html](http://greg-j.com/static-content/hover-fade.html)

[http://www.jacklmoore.com/blend](http://www.jacklmoore.com/blend)

在这两件事中都有我想要的效果，但是有些项目/按钮具有正常和悬停部分。

我所拥有的只是悬停状态:) 所以它基本上是一个作为菜单背景的图像和其他悬停状态的图像。

是否有机会仅使用一张用于（悬停）的图像来制作这种“出现/消失”的淡入淡出效果，或者必须有正常和悬停状态才能使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:29:57.167

查看 CSS3 过渡。

这是一些在悬停时淡化元素的 CSS。

```
.fade 
{
    opacity: 1;
    transition: opacity .25s ease-in-out;
    -moz-transition: opacity .25s ease-in-out;
    -webkit-transition: opacity .25s ease-in-out;
}

.fade:hover 
{
    opacity: 0.5;
} 
```

您只需要像这样为您的元素提供 .fade 类：

```
<p class="fade">This is my text element that will fade when you hover over it.</p> 
```

虽然它不一定是文本 - 它可以是按钮、图像等。

取自[http://bavotasan.com/2011/a-simple-fade-with-css3/](http://bavotasan.com/2011/a-simple-fade-with-css3/)

# php - PHP：获取网址后重定向

> ID：11621352
> 
> 赞同：0
> 
> 时间：2012-07-23T22:14:55.493
> 
> 标签：php, redirect, simple-html-dom

我需要“计算”一个 URL 并重定向到它。我有以下代码：

```
<?php

//Basic HTML parsing with PHP
    include("simple_html_dom.php");

    $htmlCode = file_get_html('http://example.net/example.html');

    foreach($htmlCode->find('div[class=frontPageImage]') as $element) {

        foreach($element->find('img') as $imagee)
            $imgurl = $imagee->src;
    }

header("'Location:".$imgurl."'");

?> 
```

首先在 $imgurl 中获取 url，然后重定向到该 url ......但它不起作用..

有什么想法或建议吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:17:30.533

```
header("'Location:".$imgurl."'"); 
```

应该是：

```
header("Location: " . $imgurl); 
```

我删除了单引号`'`，因为您的 HTTP 标头看起来像：

```
'Location: http://site.com/image.jpg' 
```

由于单引号，这是无效的。

您还循环并找到许多图像 URL，但仅重定向到最后一个。

# ruby-on-rails - 没有路线匹配 {:action=>“show”, :controller=>“users”}

> ID：11621353
> 
> 赞同：2
> 
> 时间：2012-07-23T22:15:12.437
> 
> 标签：ruby-on-rails, routing, controller

我跟着发生了，这是我的用户控制器

```
class UserController < ApplicationController

def new
     @user = User.new
end

def create
    @user = User.new(params[:user])
    if @user.save
        redirect_to user_session_path
    else
    redirect_to new_user_session_path
end

end

def show
    @user = User.find(params[:id])
    #redirect_to @user
end
end 
```

在我的 routes.rb 我有以下内容：

```
Estaciones::Application.routes.draw do
root :to => "static_pages#home"
match '/contact', :to=>'static_pages#contact'
match '/about', :to=>'static_pages#about'
devise_for :user
resources :user do
#resources :car
end 
```

当我在浏览器上运行它时，我得到了这个：

```
Routing Error

No route matches {:action=>"show", :controller=>"user"}
Try running rake routes for more information on available routes. 
```

不知道为什么会这样？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:25:28.070

您需要将`User`对象或至少将用户 ID 传递给`link_to`您正在创建单击的链接的方法。尝试类似的东西`<%= link_to user.name, user %>`

还要确保您的控制器名称正确，例如`UsersController`（复数）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T07:14:25.567

重命名两个文件：

`'user_controller.rb'`=>`'users_controller.rb'`

和顶部的常数：

`UserController`=>`UsersController`

文件名必须匹配常量，约定是模型是单数，控制器是复数（匹配表格）。

并尝试访问

`/users/1`

# c# - 如何自动点击“您要打开还是保存？”

> ID：11621356
> 
> 赞同：6
> 
> 时间：2012-07-23T22:15:28.693
> 
> 标签：c#, selenium

我想知道以下是否有 ac# 或 selenium 解决方案：

![在此处输入图像描述](../Images/61f765d9816757ab4a9e7bc6641f4e0a.png)

我正在使用 selenium 从网络服务器下载文件。

不幸的是，在 IE9 中没有办法禁用此弹出屏幕。

c# 中是否有用于单击“保存”按钮的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:21:00.093

**客户**

```
WebClient client = new WebClient();
byte[] file = client.DownloadData("http://domain.com/default.aspx");
File.WriteAllBytes("helloworld.txt", file); 
```

* * *

**服务器**

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        using (MemoryStream memory = new MemoryStream())
        using (StreamWriter writer = new StreamWriter(memory))
        {
            // The bytes written can be anything, does not have to be text
            writer.WriteLine("hello, world");
            writer.Flush();
            Response.BinaryWrite(memory.ToArray());
        }

        Response.AddHeader("Content-Disposition", "Attachment; filename=helloworld.txt");
        Response.AddHeader("Content-Type", "application/octet-stream");
        Response.End();
    }
} 
```

通过上面的例子可以看到，我不仅不知道文件的物理位置，而且还没有物理位置！这是我刚刚写入内存然后将原始字节写入响应的内容，但 WebClient.DownloadData() 仍然能够下载相同的字节。它不关心字节来自哪里。希望这可以帮助。

* * *

**附加信息：**

一些进一步的背景信息进一步解释了上述工作的原因。

浏览器的主要工作是发送 HTTP 请求并处理响应。幸运的是，他们为我们处理了很多繁重的工作。显示一个简单的网页包括向服务器发送 HTTP-GET 并在响应正文中接收返回的字节，将这些字节解码为文本，然后解析该文本以呈现 HTML 网页。它知道如何处理这样的响应，因为它有一个 Text/HTML 的 Content-Type 标头。虽然这是它大部分时间所做的事情，但浏览器也可以处理其他 MIME 类型，如果 Content-Type 是 text/plain 它将解码字节并仅显示它们而不尝试解析它。Text/XML 通常允许您折叠和展开 XML 节点等。同样，这完全取决于浏览器如何编程以处理该粒子 MIME 类型。

当您在浏览器中获得“另存为”对话框时，这只是浏览器处理带有 Content-Disposition: Attachment 标头的响应的方式。此标头告诉浏览器不要尝试呈现或显示内容，而是将其作为附件下载。

当您使用 WebClient / HttpWebRequest 类时，您实际上是在编写自己的微型浏览器，但是如何处理 MIME 类型 / HTTP 标头的实现完全取决于您。这可以让您保存 Content-Disposition 响应（或任何与此相关的响应）中的字节，而无需使用“打开”或“保存”对话框进行提示。

# c# - Linq to SQL 和 Linq to Entities 中的投影

> ID：11621358
> 
> 赞同：2
> 
> 时间：2012-07-23T22:15:40.513
> 
> 标签：c#, nhibernate, linq-to-sql, linq-to-entities

我正在尝试动态获取列。在 NHibernate 我可以这样做：

```
var list = _session.CreateCriteria(typeof(Person))
                   .SetProjection(Projections.ProjectionList()
                   .Add(Projections.Property("FirstName"))
                   .Add(Projections.Property("LastName"))
                   .Add(Projections.Property("Jersey"))
                   .Add(Projections.Property("FortyYard"))
                   .Add(Projections.Property("BenchReps"))
                   .Add(Projections.Property("VertJump"))
                   .Add(Projections.Property("ProShuttle"))
                   .Add(Projections.Property("LongJump"))
                   .Add(Projections.Property("PersonSchoolCollection"))
                    )
                   .SetResultTransformer(new NHibernate.Transform.AliasToBeanResultTransformer(typeof(Person)))
                   .List<Person>(); 
```

Linq 中的等价物是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T22:47:23.790

由于您还标记[了 linq-to-sql](/questions/tagged/linq-to-sql "显示标记为“linq-to-sql”的问题")和[linq-to-entities](/questions/tagged/linq-to-entities "显示标记为“linq-to-entities”的问题")，我假设您正在寻找 Linq-to-Sql 或实体框架中的等价物。`_session.Query<Person>()`如果被替换，这两个答案（到目前为止）将是这样的等价物`context.Persons`。（尽管 Darius 的回答会抛出一个异常，说您不能在实体查询中创建实体实例）。

但是除了可以[`Select`](http://msdn.microsoft.com/en-us/library/bb340054)用来创建临时投影之外， [AutoMapper](http://automapper.org/)的一项新功能使它变得更加容易。Automapper 是一种非常流行的工具，用于将类型列表映射（例如：项目）到另一个类型列表。但直到最近它的缺点是它只适用于内存列表，即投影不会传播到 SQL 查询中。所以它不能用来减少查询字段的数量（就像 NHibernate 预测一样）。

[在您的数据访问代码中停止使用 AutoMapper 中](http://www.devtrends.co.uk/blog/stop-using-automapper-in-your-data-access-code)描述了这个问题（标题说明了一切）。但它也提供了一个初步但出色的修复，后来被 Automapper 自己采用。

此功能使编写非常简洁的代码成为可能，例如：

```
var dtoList = context.Persons.Project().To<PersonDto>(); 
```

（在 Automapper 中注册 Person 和 PersonDto 之间的映射之后）。

现在 SQL 查询只包含用于 PersonDto 的字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T04:58:57.960

```
var list = from person in context.Persons
           select new Person()
           {
               FirstName = person.FirstName,
               LastName = person.LastName,
               Jersey = person.Jersey,
               FortyYard = person.FortyYard,
               BenchReps = person.BenchReps, 
               VertJump = person.VertJump,
               ProShuttle = person.ProShuttle,
               LongJump = person.LongJump,
               PersonSchoolCollection = person.PersonSchoolCollection
           }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T05:00:01.710

那不是可行吗：

```
 _session.Query<Person>()
         .Select(new {FirstName, LastName, Jersey, FortyYard})
         .ToList()
         .Select(x => new Person() { 
                       FirstName = x.FirstName,
                       LastName = x.LastName, 
                       Jersey = x.Jersey, 
                       FortyYard = x.FortyYard
                 }
          ); 
```

# javascript - 如果 View 具有某个类（backbone.js），则单击时触发功能

> ID：11621361
> 
> 赞同：4
> 
> 时间：2012-07-23T22:15:48.250
> 
> 标签：javascript, jquery, backbone.js, underscore.js

我有一个`div`由backbone.js 生成的视图。当用户单击 this时，将向 中添加`div`一个类并执行该函数。`active``div``addToSet`

**问题：**我希望在 View`div`具有 class时触发另一个函数`active`。但是，下面显示的我的尝试总是导致`addToSet`函数在单击时运行。

现在，我`'click': 'addToSet'`从`events`函数中删除，只留下`'click .active': 'removeFromSet'`. 点击`div`不会导致任何事情发生！这是因为事件处理程序不能选择`div`视图本身，只能选择其中的元素吗？

知道如何解决这个问题吗？谢谢！

**JS代码**

```
SetView = Backbone.View.extend({
    tagName: 'div',
    className: 'modal_addit_set',

    template: _.template( $('#tpl_modal_addit_set').html() ),

    events: {
        'click': 'addToSet',
        'click .active': 'removeFromSet'
    },

    initialize: function(opts) {
        this.post_id = opts.post_id;
    },

    render: function() {
        $(this.el).html( this.template( this.model.toJSON() ) );
        if(this.model.get('already_added'))
            $(this.el).addClass('active');
        return this;
    },

    addToSet: function() {
        $.post('api/add_to_set', {
            post_id: this.post_id,
            set_id: this.model.get('id'),
            user_id: $('#user_id').val()
        });
    },

    removeFromSet: function() {
        $.post('api/remove_from_set', {
            post_id: this.post_id,
            set_id: this.model.get('id')
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T22:46:07.913

您是否尝试过为您的一位事件代表使用[:not(.active)选择器？](http://api.jquery.com/not-selector/)这可能有助于区分这两种情况。

像这样的东西：

```
events: {
   'click :not(.active)' : callback1
   'click .active' : callback2
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T23:22:42.030

这些事件：

```
events: {
    'click': 'addToSet',
    'click .active': 'removeFromSet'
} 
```

不工作，你有点知道为什么。来自[精美手册](http://backbonejs.org/#View-delegateEvents)：

> 事件以`{"event selector": "callback"}`. `callback`可以是视图上方法的名称，也可以是直接的函数体。省略`selector`会导致事件绑定到视图的根元素 ( `this.el`)。

因此，您`'click': 'addToSet'`绑定`addToSet`到视图`el`本身的单击，但`'click .active': 'removeFromSet'`绑定`removeFromSet`到视图*内部*`.active`的元素。*`el`*

 *我认为最简单的解决方案是举办一个活动：

```
events: {
    'click': 'toggleInSet'
} 
```

进而：

```
toggleInSet: function() {
    if(this.$el.hasClass('active')) {
        $.post('api/remove_from_set', {
            post_id: this.post_id,
            set_id: this.model.get('id')
        });
    }
    else {
        $.post('api/add_to_set', {
            post_id: this.post_id,
            set_id: this.model.get('id'),
            user_id: $('#user_id').val()
        });
    }
} 
```

`toggleInSet`如果这更有意义，您可以使用实例变量而不是 CSS 类来控制分支。*

# powershell - 是否可以在 Powershell 中进行有条件的管道传输，即仅在满足条件时才执行管道的元素？

> ID：11621365
> 
> 赞同：15
> 
> 时间：2012-07-23T22:16:36.727
> 
> 标签：powershell, filter, conditional, pipe, pipeline

我想做这样的事情：

```
<statement> | <filter1> | <filter2> if <condition> | <filter3> | <filter4> | <filter5> 
```

<statement> 的结果通过 <filter1> 运行，然后它们仅在满足 <condition> 时运行通过 <filter2>，然后通过其余过滤器，无论是否应用 <filter2>。这相当于：

```
if (<condition>) {
  <statement> | <filter1> | <filter2> | <filter3> | <filter4> | <filter5>
} else {
  <statement> | <filter1> | <filter3> | <filter4> | <filter5>
} 
```

这在仅当调用某个开关时才将给定过滤器应用于结果集的函数中很有用。如果条件过滤器出现在长管道的早期，使用外部 if 块编写它会导致大量代码重复，尤其是在有多个条件过滤器的情况下。

这是一个例子。以下函数显示给定帐户在给定目录子树中的权限（例如`Show-AccountPerms \\SERVERX\Marketing DOMAIN\jdoe`，给出用户 DOMAIN\jdoe 在 \SERVERX\Marketing 下的目录树中的权限报告）。

```
function Show-AccountPerms {
    param (
        [parameter(mandatory = $true)]$rootdir,
        [parameter(mandatory = $true)]$account,
        [switch]$files,
        [switch]$inherited
    )
    gci -r $rootdir `
    |where {$_.psiscontainer} `
    |foreach {
        $dir = $_.fullname
        (get-acl $_.pspath).access `
        | where {$_.isinherited -eq 'False'} `
        |foreach {
            if ($_.identityreference -eq $account) {
                "{0,-25}{1,-35}{2}" -f $_.identityreference, $_.filesystemrights, $dir
            }
        }
    }
} 
```

默认情况下，它只显示显式权限（由`| where {$_.isinherited -eq 'False'}`过滤器强制执行），并且仅在目录上（由`|where {$_.psiscontainer}`过滤器强制执行）。

`|where {$_.psiscontainer}`但是，如果调用 -files 开关，我想忽略，如果调用 -inherited 开关，我想忽略`| where {$_.isinherited -eq 'False'}`。使用外部 if 块完成此操作将使代码翻两番，其中几乎 75% 将是重复。有没有办法让这些过滤器保持一致，但指示 powershell 只应用它们对应的开关是假的？

请注意，这只是一个*示例*，因此我对特定于此功能的任何解决方法不感兴趣。我正在寻找有关有条件管道的一般问题的答案，而不是如何完成此特定任务的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-23T22:50:10.153

您可以在过滤器中测试这两个条件，如果其中一个为真，则允许对象通过管道。如果您的“条件”在运算符的左侧，如果您不想测试您的过滤条件`-or`，请使其结果。`$true`

要使用您的示例：

```
| where {$_.psiscontainer} 
```

变成：

```
| where {$files -or $_.psiscontainer} 
```

和

```
| where {$_.isinherited -eq 'False'} 
```

变成

```
| where {$inherited -or $_.isinherited -eq 'False'} 
```

概括地说：

```
<statement> | <filter1> | <filter2> if <condition> | <filter3> | <filter4> | <filter5> 
```

变成：

```
<statement> | <filter1> | <-not condition -or filter2> | <filter3> | <filter4> | <filter5> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-24T03:56:33.780

对不起，我不是故意放弃这个问题。发布的答案不是我想要的，但我在发布后不久就想出了一个方法，并且很长时间没有回到该网站。由于尚未发布解决方案，这就是我想出的。当我问这个问题时，这并不是我的想法，也不是很漂亮，但显然这是唯一的方法：

```
<statement> | <filter1> | foreach {if (<condition>) {$_ | <filter2>} else {$_} | <filter3> | <filter4> | <filter5> 
```

因此，在示例中，该行

```
|where {$_.psiscontainer} ` 
```

将更改为

```
|foreach {if (-not $files) {$_ | where {$_.psiscontainer}} else {$_}} ` 
```

和

```
|where {$_.isinherited -eq 'False'} ` 
```

将更改为

```
|foreach {if (-not $inherited) {$_ | where {$_.isinherited -eq 'False'}} else {$_}} ` 
```

（是的，通常我会把它写成`|foreach {if ($files) {$_} else {$_ | where {$_.psiscontainer}}}`，`|foreach {if ($inherited) {$_} else {$_ | where {$_.isinherited -eq 'False'}}}`但为了清楚起见，我这样做了。）

我希望可能有更优雅的东西，它会评估过滤器前面的条件一次，以确定是执行还是跳过管道的一个阶段。像这样的东西：

```
<statement> | <filter1> | if (<condition>) {<filter2>} | <filter3> 
```

（ 的特殊情况`if`，不是通常的含义；可以使用不同的关键字），或者也许

```
<statement> | <filter1> | (<condition>) ? <filter2> | <filter3> 
```

`$_`在条件中将是无效的，除非它是在当前管道之外定义的，例如，如果管道包含在`switch`语句`$_`中，`<condition>`则将引用`switch`语句的`$_`.

我想我会向微软提出一个功能建议。这不仅会使代码更优雅，而且效率也会更高，因为如果它是内置功能，则`<condition>`可以对整个管道进行*一次评估，而不是在每次迭代中测试相同的独立条件。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-21T14:41:17.543

我*认为*您的意思类似于以下内容，这是我刚刚炮制的：

```
function Pipe-If([ScriptBlock]$decider, [ScriptBlock]$pipeElement)
{
    if (&$decider) {
        $pipeElement
    } else {
        {$input}
    }
}

@(1,2,3) | &(Pipe-If {$doDouble} {$input | % { $_ * 2} }) 
```

如果是 ，则结果为 2, 4, 6，如果`$doDouble`是`$true`，`$false`则结果为 1, 2, 3。

这里的关键是可以将任意管道元素 like`% { $_ * 2}`封装为 ScriptBlock as `{$input | % { $_ * 2 } }`，并且可以通过添加 . 将其转换回管道元素`&`。

我使用[https://devblogs.microsoft.com/powershell/diy-ternary-operator](https://devblogs.microsoft.com/powershell/diy-ternary-operator)获得灵感。

* * *

*重要的提示。* 不要使用这样的东西：

```
filter Incorrect-Pipe-If([ScriptBlock]$decider, [ScriptBlock]$pipeElement) {
    if (&$decider) {
        $_ | &$pipeElement
    } else {
        $_
    }
}

@(1,2,3) | Incorrect-Pipe-If {$doDouble} {$_ | % { $_ * 2} } 
```

这会导致`%`执行多次，对管道中的每个对象执行一次。 `Pipe-If`只正确执行`%`一次命令，并将整个对象流发送给它。

在上面的示例中，这不是问题。但是，如果命令是，`tee bla.txt`那么差异*很*重要。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-25T14:46:29.137

我认为这个问题的另一个答案误解了所问的内容。

解决方法在于：

`... | %{if($_ -match "Something"){DoSomethingWith $_ }else{$_}} | ...`

这将做的是将所有元素传递到下一个过滤器，除了那些匹配“Something”的元素，在这种情况下它会执行不同的逻辑。可以更改逻辑以使其传递管道元素的更改版本而不是函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-05T22:23:48.107

这类似于 Marnix Klooster 的答案，但使用起来更简单。这个公式相对于那个公式的优势在于要执行的代码的语法。它更接近普通的管道块。基本上你只需要在 {} （大括号）中包含你想要的任何东西。

请注意，与 Marnix 的脚本一样，这是一个阻塞函数。管道结果被收集到 $Input 中，函数本身只执行一次。只有 $pipeElement 代码会多次执行，并且只有在 -Execute 为真时才执行。

```
function Conditional_Block([bool]$Execute,[ScriptBlock]$PipeElement)
{
    if ($Execute) 
        {$ExecutionContext.InvokeCommand.NewScriptBlock("`$(`$Input|$PipeElement)").invoke()}
    else
        {$input}
} 
```

使用此功能不需要已经定义！你真的可以在你想要使用它的函数中定义它，并在你的函数完成时让它消失。

-execute 参数启用/禁用步骤执行。任何具有布尔结果的表达式都有效。例如 $(1 -eq 0) 就像 $false 一样工作。

```
@(1,2,3)|Conditional_Block $true  {?{$_ -le 2}}|%{"'$_'"}
@(1,2,3)|Conditional_Block $false {?{$_ -le 2}}|%{"'$_'"} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-15T01:26:02.660

另一种选择是使用全局首选项标志（类型`System.Management.Automation.ActionPreference`）来允许用户确定管道过滤器是否执行某些操作。

例如，`$progressPreference`可以设置为以下值：

*   默默地继续
*   停止
*   继续
*   查询
*   忽视

然后使用此首选项标志`Write-Progress`来确定所需的行为。

例如，如果您有一个管道过滤器`Show-Progress`，它计算项目并显示一个进度条，那么它只会在`$progressPreference`设置为时显示这个进度条`Continue`。

您可以在自己的管道过滤器中使用模拟构造。

# php - 检查其他数组中的关联数组？

> ID：11621371
> 
> 赞同：1
> 
> 时间：2012-07-23T22:17:16.100
> 
> 标签：php, multidimensional-array

我有两个数组`$A`，`$B`

```
$B = Array
(
    [0] => Array
        (
            [id_participant] => 94
            [full_name] => soeng makara
        )

    [1] => Array
        (
            [id_participant] => 95
            [full_name] => sok sao
        )

)

$A = Array
(
    [0] => Array
        (
            [id_participant] => 95
            [full_name] => sok sao
        )
) 
```

任何人都可以帮助我在这种情况下如何检查数组`$A`中的数组`$B`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T23:52:06.427

简单地：

```
if (in_array($A[0], $B))
{
  // in array
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T22:39:31.210

您想知道 $a 中的项目是否在 $b 中？

```
function checkIfInArray($a, $b)    
{
    foreach($b as $i)
        foreach($a as $x)
            if($x['id_participant'] == $i['id_participant']) return true; //Match found
    return false; //No Match was found
} 
```

# c# - SynchronizationContext.Current 在主 UI 线程上的 Continuation 中为 null

> ID：11621372
> 
> 赞同：21
> 
> 时间：2012-07-23T22:17:23.290
> 
> 标签：c#, winforms, task-parallel-library, synchronizationcontext

我一直在尝试在 Winforms 应用程序中追踪以下问题：在
主线程上运行`SynchronizationContext.Current`的任务延续（即`.ContinueWith`）中为空（我希望当前同步上下文为`System.Windows.Forms.WindowsFormsSynchronizationContext`）。

这是演示该问题的 Winforms 代码：

```
using System;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            TaskScheduler ts = TaskScheduler.FromCurrentSynchronizationContext(); // Get the UI task scheduler

            // This line is required to see the issue (Removing this causes the problem to go away), since it changes the codeflow in 
            // \SymbolCache\src\source\.NET\4\DEVDIV_TFS\Dev10\Releases\RTMRel\ndp\clr\src\BCL\System\Threading\ExecutionContext.cs\1305376\ExecutionContext.cs
            // at line 435
            System.Diagnostics.Trace.CorrelationManager.StartLogicalOperation("LogicalOperation");

            var task = Task.Factory.StartNew(() => { });
            var cont = task.ContinueWith(MyContinueWith, CancellationToken.None, TaskContinuationOptions.None, ts);

            System.Diagnostics.Trace.CorrelationManager.StopLogicalOperation();
        }

        void MyContinueWith(Task t)
        {
            if (SynchronizationContext.Current == null) // The current SynchronizationContext shouldn't be null here, but it is.
                MessageBox.Show("SynchronizationContext.Current is null");
        }
    }
} 
```

这对我来说是个问题，因为我尝试`BackgroundWorker`从延续中使用，BackgroundWorker 将使用当前的 SynchronizationContext 作为其事件`RunWorkerCompleted`和`ProgressChanged`. 由于当我启动 BackgroundWorker 时当前 SynchronizationContext 为空，因此事件不会按我的意愿在主 ui 线程上运行。

**我的问题：**
这是微软代码中的错误，还是我在某个地方犯了错误？

**附加信息：**

*   我正在使用 .Net 4.0（我还没有在 .NET 4.5 RC 上尝试过）
*   我可以在任何 x86/x64/Any CPU（在 x64 机器上）上的 Debug/Release 上重现这一点。
*   它始终如一地重现（如果有人无法重现它，我会很感兴趣）。
*   我有使用 BackgroundWorker 的遗留代码——所以我不能轻易改用不使用 BackgroundWorker
*   我已经确认代码在`MyContinueWith`主 ui 线程上运行。
*   我不确切知道为什么`StartLogicalOperation`调用会导致问题，这正是我在我的应用程序中缩小范围的原因。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-24T15:45:03.120

该问题已在 .NET 4.5 RC 中修复（刚刚测试过）。所以我认为这是.NET 4.0 中的一个错误。另外，我猜这些帖子引用了相同的问题：

*   [在 Windows 窗体应用程序中，主线程的 SynchronizationContext.Current 如何变为空？](https://stackoverflow.com/questions/4659257/how-can-synchronizationcontext-current-of-the-main-thread-become-null-in-a-windo?rq=1)
*   [http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/629d5524-c8db-466f-bc27-0ced11b441ba](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/629d5524-c8db-466f-bc27-0ced11b441ba)

那真不幸。现在我必须考虑解决方法。

**编辑：**
从调试到 .Net 源代码，我对问题何时重现有了更好的了解。以下是 ExecutionContext.cs 中的一些相关代码：

```
 internal static void Run(ExecutionContext executionContext, ContextCallback callback,  Object state, bool ignoreSyncCtx) 
        {
            // ... Some code excluded here ...

            ExecutionContext ec = Thread.CurrentThread.GetExecutionContextNoCreate();
            if ( (ec == null || ec.IsDefaultFTContext(ignoreSyncCtx)) &&
#if FEATURE_IMPERSONATION || FEATURE_COMPRESSEDSTACK
                SecurityContext.CurrentlyInDefaultFTSecurityContext(ec) && 
#endif // #if FEATURE_IMPERSONATION || FEATURE_COMPRESSEDSTACK
                executionContext.IsDefaultFTContext(ignoreSyncCtx)) 
            { 
                callback(state);
            } 
            else
            {
                if (executionContext == s_dummyDefaultEC)
                    executionContext = s_dummyDefaultEC.CreateCopy(); 
                RunInternal(executionContext, callback, state);
            } 
        } 
```

只有当我们进入调用 RunInternal 的“else”子句时，该问题才会重现。这是因为 RunInternal 最终替换了 ExecutionContext，它具有改变当前 SynchronizationContext 的效果：

```
 // Get the current SynchronizationContext on the current thread 
        public static SynchronizationContext Current 
        {
            get
            { 
                SynchronizationContext context = null;
                ExecutionContext ec = Thread.CurrentThread.GetExecutionContextNoCreate(); 
                if (ec != null) 
                {
                    context = ec.SynchronizationContext; 
                }

                // ... Some code excluded ...
                return context;
            }
        } 
```

因此，对于我的具体情况，这是因为 `executionContext.IsDefaultFTContext(ignoreSyncCtx)) 行返回 false。这是代码：

```
 internal bool IsDefaultFTContext(bool ignoreSyncCtx)
        { 
#if FEATURE_CAS_POLICY 
            if (_hostExecutionContext != null)
                return false; 
#endif // FEATURE_CAS_POLICY
#if FEATURE_SYNCHRONIZATIONCONTEXT
            if (!ignoreSyncCtx && _syncContext != null)
                return false; 
#endif // #if FEATURE_SYNCHRONIZATIONCONTEXT
#if FEATURE_IMPERSONATION || FEATURE_COMPRESSEDSTACK 
            if (_securityContext != null && !_securityContext.IsDefaultFTSecurityContext()) 
                return false;
#endif //#if FEATURE_IMPERSONATION || FEATURE_COMPRESSEDSTACK 
            if (_logicalCallContext != null && _logicalCallContext.HasInfo)
                return false;
            if (_illogicalCallContext != null && _illogicalCallContext.HasUserData)
                return false; 
            return true;
        } 
```

对我来说，那是因为是真的而返回假`_logicalCallContext.HasInfo`。这是代码：

```
public bool HasInfo
{ 
    [System.Security.SecurityCritical]  // auto-generated
    get
    {
        bool fInfo = false; 

        // Set the flag to true if there is either remoting data, or 
        // security data or user data 
        if(
            (m_RemotingData != null &&  m_RemotingData.HasInfo) || 
            (m_SecurityData != null &&  m_SecurityData.HasInfo) ||
            (m_HostContext != null) ||
            HasUserData
          ) 
        {
            fInfo = true; 
        } 

        return fInfo; 
    }
} 
```

对我来说，这返回了 true，因为 HasUserData 是 true。这是代码：

```
 internal bool HasUserData
    {
        get { return ((m_Datastore != null) && (m_Datastore.Count > 0));} 
    } 
```

对我来说，由于我调用了 m_DataStore`Diagnostics.Trace.CorrelationManager.StartLogicalOperation("LogicalOperation");`

总之，看起来有几种不同的方法可以让错误重现。希望这个例子能帮助其他人确定他们是否遇到了同样的错误。

# c# - 使用 SmtpClient，得到“目标机器主动拒绝”

> ID：11621373
> 
> 赞同：7
> 
> 时间：2012-07-23T22:17:28.597
> 
> 标签：c#, .net, smtpclient

我正在尝试将 System.Net.Mail 用于应用程序以发送电子邮件，但出现此异常：

> System.Net.Mail.SmtpException：发送邮件失败。---> System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: 无法建立连接，因为目标机器主动拒绝它 198.238.39.170:25

我正在使用的代码是：

```
string mailserver = "Scanmail.ofm.wa.lcl";
MailMessage msg = new MailMessage("albert@einstein.net", "snark@snarky.com", "Very subjective", "A message body!");
SmtpClient client = new SmtpClient(mailserver);
client.Send(msg); 
```

显然，上面的电子邮件地址是虚构的，但在实际代码中它使用了系统中的真实电子邮件地址。邮件服务器地址准确。

我很想我需要在那里放置某种安全凭证，但不确定在哪里 - 尽管@Andre_Calil 的建议表明这不是问题，并且可能配置邮件服务器以阻止我的开发机器连接。那么如何克服呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-23T22:55:06.470

因此，正如我们所说，您的服务器可能配置为拒绝来自每台机器的中继，这是推荐的安全设置。

在您的开发机器上，打开提示符 ( `command`) 并输入`telnet SMTP_SERVER_IP_ADDRESS 25`. 此命令将尝试在端口 25（默认 SMTP 端口）上建立基本套接字连接。如果成功，您仍然需要发现服务器是否需要身份验证。

但是，如果不成功，您将不得不暂停您的代码，直到您可以得到系统管理员的帮助。

要尝试的另一件事是从*应用服务器*重复相同的测试，因为 SMTP 服务器可能配置为`allow app_server`和`deny everybody_else`。

问候

# javascript - jquery在单击图像时放大和缩小

> ID：11621377
> 
> 赞同：0
> 
> 时间：2012-07-23T22:18:01.657
> 
> 标签：javascript, jquery

我有一个必须以下列方式运行的图像：当用户第一次单击它时，图像应该放大，再次单击图像时，它应该缩小。

请帮助弄清楚如何通过使用jquery单击图像来执行这两个操作？下面是我为放大图像而编写的代码。

```
$('.tab1').click(function()
       {
           $(".GraphHolder").hide("slow");
           $("#top-button-container").hide("slow");
           $(".print").append('<button type="button">PRINT</button>');
          $(this).animate({width: "70%"}, 'slow');
       }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:59:23.483

HTML：

```
<img id="pic" src="https://www.google.com//images/icons/product/chrome-48.png"> 
```

查询：

```
$(function(){
    $('#pic').toggle(
          function() { $(this).animate({width: "100%"}, 500)},
           function() { $(this).animate({width: "50px"}, 500); }
    );
}); 
```

示例：http: [//jsfiddle.net/K9ASw/32/](http://jsfiddle.net/K9ASw/32/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T22:22:36.910

您是否尝试过使用[toggleClass](http://jqueryui.com/demos/toggleClass/)？您可以使用可选的 [duration] 参数来指定您希望转换持续多长时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T22:36:24.443

如果真的旧的或蹩脚的浏览器不是问题，我会选择 CSS 过渡，更简单、更流畅。

[小提琴](http://jsfiddle.net/ZcDtL/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T12:15:40.350

```
 **here is the script**
   <script src="Script/jquery-1.7.1.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    $(document).ready(function () {
        $('#Img1, #Img2, #Img3').mouseover(function () {
            $(this).animate({ width: "122px", height: "110px" }, 100);
        });
        $('#Img1, #Img2, #Img3').mouseout(function () {
            $(this).animate({ width: "118px", height: "106px" }, 100);
        });
    });
  </script>

 **Aspx code**
<img src="Images/home.jpg" id="Img1" width="118" height="106" border="0">
<img src="Images/machine.jpg" id="Img2" width="118" height="106" border="0">
<img src="Images/title_Mixie.jpg" id="Img3" width="118" height="106" border="0"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T22:28:57.250

```
$(function () {
 $('.tab1').on('click', function()
   {
     if($(this).hasClass('zoomed')) {
       $(this).removeClass('zoomed')
       $(this).children('img').animate({width: "10%"}, 'slow');
     }
       $(this).addClass('zoomed')
       $(this).children('img').animate({width: "70%"}, 'slow');
     }
 });
}); 
```

我删除了所有与图像调整大小无关的代码。此外，如果您正在处理图像，则必须定位图像标签，而不是外部 div。如果图像作为背景图像应用到 .tab1 类，那么您就可以了。

# c# - 对象引用未设置为对象的实例（应用程序用户设置）

> ID：11621383
> 
> 赞同：1
> 
> 时间：2012-07-23T22:18:37.567
> 
> 标签：c#, .net, null, settings

在我的应用程序用户设置中，我有一个`StringDictionary`名为“网站”。带有消息“对象引用未设置为对象的实例”的 NullReferenceException。当它到达这条线时：`Properties.Settings.Default.websites.Add(nameBox.Text, urlBox.Text);`，但我不知道为什么。VS 调试器显示 nameBox.Text 和 urlBox.Text 是正确的值。

**编辑：**

我已经确定它默认为空，所以在 Form.Load 上，我添加了

```
if (Properties.Settings.Default.websites == null) {
            MessageBox.Show("property is null");
            Properties.Settings.Default.websites = new StringDictionary();
} 
```

但现在设置没有保存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:30:54.517

看起来您的 StringDictionary 网站范围设置为在运行时无法修改的应用程序。您将范围更改为用户，以便每个用户在运行时更改它

> **取自 MSDN**
> 
> [应用程序范围的设置](http://msdn.microsoft.com/en-us/library/a65txexh.aspx)可用于 Web 服务的 URL 或数据库连接字符串等信息。这些值与应用程序相关联。因此，用户无法在运行时更改它们。

**编辑：**要保存您必须使用的设置`Properties.Settings.Default.Save();`

# ios - Coredata多线程：如何过滤保存通知？

> ID：11621386
> 
> 赞同：0
> 
> 时间：2012-07-23T22:18:42.353
> 
> 标签：ios, multithreading, core-data, notifications

我有一个带有 coredata 和线程限制的 iOS 应用程序。我遵循苹果规则，我为每个线程创建了一个持久存储协调器和一个 managedObjectContext。

因为两个线程都可以修改数据，所以我添加了一个代码来合并上下文（在 NSManagedObjectContextDidSaveNotification 中）

到这里一切正常，但我只想在我正在查看的对象是最后一次合并时刷新我的 GUI……我可以在每个 NSManagedObjectContextDidSaveNotification 刷新我的 GUI 广告，但我有大约 15k 条记录和一次更新。我真的很关心性能。

# wpf - 同一项目中的用户控件

> ID：11621387
> 
> 赞同：0
> 
> 时间：2012-07-23T22:18:43.700
> 
> 标签：wpf, user-controls

我有一个带有 1 个窗口和 1 个自定义用户控件的简单 WPF 控件项目。我构建了项目，并且控件显示在工具箱上 - 很棒。我将控件的几个实例拖到窗口上，它按预期工作 - 再次很棒。它为“我的”添加了一个 xmlns，它引用了它自己的基本命名空间，并为控件添加了正确的引用——完美。

然后我尝试构建它，不是那么完美。它似乎正在寻找它自己的构建 dll，所以当它开始构建项目并删除 dll 时，它突然找不到命名空间引用，因此构建失败。然后 dll 丢失，因此设计者给出了错误。我可以删除对此命名空间的引用来修复错误，并且我可以成功重建，这将返回 dll，这意味着我可以将引用粘贴回没有错误...直到我尝试再次构建...

有没有办法做到这一点而不使每个控件都是自己的dll？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:23:27.667

不要在发布时进行重建？

设计器错误不会停止我的编译。但是设计者的错误在发布之前不会消失。

检查您的构建设置。

# entity-framework - Office 365 中的 SharePoint Online 与 SQL Azure 和实体框架

> ID：11621395
> 
> 赞同：0
> 
> 时间：2012-07-23T22:19:51.293
> 
> 标签：entity-framework, sharepoint, azure-sql-database, office365

我正在尝试构建一个 Web 部件以托管在 SharePoint Online（Office 365 的一部分）上。我想使用实体框架连接到 SQL Azure 中的数据库。这甚至可能吗？我尝试部署一种解决方案，但我收到非常无用的错误消息“Web Part Error: Sandboxed code execution request failed.”。

有人让这个组合起作用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:19:08.157

我发现这是不可能的。原因是沙盒中的权限受限，无法使用代理绕过它。在 Office 365 中从 SharePoint Online 访问 SQL Azure 的唯一方法是通过 Web 服务公开对驻留在 SQL Azure 中的实体的操作。我目前正在研究这种方法，一旦我有更多信息，我可以更新这个答案。

7/27 更新：使用提供 SQL Azure 数据的 Web 服务，我们可以将 SQL Azure 与 SharePoint 集成。SharePoint 中启用此集成的组件称为“Business Connectivity Services”。

更多信息可以在这里找到：http: [//blogs.msdn.com/b/donovanf/archive/2012/06/25/office-365-o365-business-connectivity-services-bcs-hands-on-lab-wiring- up-o365-bcs-to-a-windows-azure-service-for-office-2010-and-sharepoint-online-solutions.aspx](http://blogs.msdn.com/b/donovanf/archive/2012/06/25/office-365-o365-business-connectivity-services-bcs-hands-on-lab-wiring-up-o365-bcs-to-a-windows-azure-service-for-office-2010-and-sharepoint-online-solutions.aspx)

# visual-studio-2010 - 安装错误：System.IO.PathTooLongException mvvm-light

> ID：11621396
> 
> 赞同：1
> 
> 时间：2012-07-23T22:20:27.503
> 
> 标签：visual-studio-2010, templates, mvvm-light

尝试在 VS 2010 中安装 VSIX 模板时，我收到**安装错误：System.IO.PathTooLongException**。一旦它使用我的默认扩展文件夹并添加“\Laurent Bugnion (GalaSoft)\MVVM Light Toolkit Templates\4.0.23.0\ItemTemplates\Silverlight for Windows Phone\Mvvm\MvvmViewModelLocator.WP7.zip”，安装时间太长。有什么方法可以缩短路径或解决此问题。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T12:29:40.023

我在安装 Cosmopolitan 模板时遇到了同样的问题。

1.  将 .vsix 文件重命名为 .zip。
2.  打开它，有一个文件扩展名.vsixmanifest，在记事本或其他编辑器中打开它。
3.  找到节点`<Name>Some very long name of the extension</Name>`并使其变短`<Name>Short name</Name>`
4.  保存，关闭。将 .zip 重命名为 .vsix，现在它应该可以正常安装了。

# java - 需要帮助将我的 java 项目转换为在办公室工作

> ID：11621399
> 
> 赞同：3
> 
> 时间：2012-07-23T22:20:46.027
> 
> 标签：java, database, user-interface, deployment, installation

我创建了一个 Java 项目。现在我想把它以 .exe 或类似的形式提供给办公室，以允许他们在不安装任何 Java IDE 的情况下使用它。我该怎么办？我的项目包含一个数据库和 GUI。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T00:23:55.050

> 我该怎么办？我的项目包含一个数据库和 GUI。

部署应用程序。和使用[Java Web Start](https://stackoverflow.com/tags/java-web-start/info)的数据库。要安装 DB，有必要使用`ExtensionInstallerService`（参见[EIS 的演示](http://pscode.org/jws/api.html#eis)）。可以使用`PersistenceService`（[PS 的演示](http://pscode.org/jws/api.html#ps)）存储 DB 的配置。

另请参阅`deployJava.js`第一个链接页面中的参考。它旨在确保最终用户拥有运行应用程序所需的最低 Java。

# c# - 在 Windows 服务中使用 TAPI 语音

> ID：11621400
> 
> 赞同：2
> 
> 时间：2012-07-23T22:20:55.070
> 
> 标签：c#, windows, service, sapi, tapi

我购买了[AddTapi.NET](http://www.traysoft.com/addtapi_overview.htm)的许可证，以简化我在作为 Windows 服务运行的产品中使用 TAPI 的开发。我能够在 Windows GUI 和控制台应用程序中使用 TAPI，并将代码移植到我的 Windows 服务中。那时，我注意到使用语音 API（如 TapiCall.Speak 或 TapiCall.Play（wavefile））的代码没有在电话线上产生声音并且保持沉默。

之前有几个问题可能与我的问题有关。

[问题：从 Windows 服务通过调制解调器播放语音](https://stackoverflow.com/questions/3071160/playing-voice-over-modem-from-a-windows-service)表示使用语音时出现问题，该问题已通过在 Windows 服务中生成 GUI 线程来解决。我试图这样做，但未能在电话中听到演讲。

[问题：Windows 服务中的 Tapi 访问冲突](https://stackoverflow.com/questions/8298679/accessviolation-exception-with-tapi-and-windows-service)似乎表明服务中的 TAPI 存在初始问题，但使用 AddTapi 产品已解决。该票并未明确提及语音 API 的使用（SAPI）

我正在使用 Visual Studio 2010 和 .NET 4.0 在 C# 中编程。我正在尝试让它在 Windows 7 上运行。我收到了一封来自 AddTapi 的电子邮件，表明 Microsoft 更改了安全性以禁止使用 Win 2008 Server、Windows Vista 和 Windows 7 中的服务中的语音子系统。以上文章似乎表明 AddTapi 取得了一些成功，尽管它可能不在 Windows 7 上。

鉴于我正在使用的主要系统是 Windows 服务（和子进程），这似乎是让语音正常工作的最佳方法。如果我将 SAPI 代码放在控制台应用程序中，我希望在不需要用户主动登录到计算机的情况下对其进行管理。我的 TAPI 代码没有任何图形。我应该采取类似于[文章的方法：启动交互式进程](http://blogs.msdn.com/b/winsdk/archive/2009/07/14/launching-an-interactive-process-from-windows-service-in-windows-vista-and-later.aspx)并生成交互式进程吗？有没有在 Windows 服务中使用 TAPI 语音的成功案例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-22T22:05:50.973

我们在 AddTapi.NET 5.0 中解决了这个问题。5.0 版可以在 Windows 服务应用程序中使用语音 API（TapiCall.Speak 和 TapiCall.Play）。无需使用单独的进程，服务可以在默认的本地服务帐户下运行。

对于不使用 AddTapi.NET 的每个人来说，关键是使用 SAPI5 SpVoice 对象与自定义流对话。您无法在 Windows 服务中实例化 SpAudio 或 SpMMAudioOut 对象，因此您需要实现自己的流类并将 SpVoice 的输出设置为该流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T14:26:57.443

我有与您的项目相同的要求（使用 AddTapi.NET 的 Windows 服务中的 TAPI）。我也收到了同样的回复。我尝试了其他一些帖子，建议我在单独的线程中运行应用程序，因此我使用了整个解决方案并将其转换为 WPF 应用程序，该应用程序具有一个永远不会出现但所有 AddTapi 配置都发生在构造函数中的简单页面.

没有成功。

当从 WPF 应用程序运行时，应用程序可以正常运行，但是当 WPF 页面在启用 STAThread 的线程中实例化时，Play and Speak 仍然无法工作。我一直在寻找这个问题的答案，但除了其他人说真的没有解决方案（没有真正的解决方案）之外，什么都没有。

通过单独的进程运行我的应用程序根本不会削减它，并且由于在单独的线程中运行也不起作用，我将不得不考虑将此应用程序作为常规 Windows 应用程序运行（需要登录）。

希望我有一个解决方案，对不起。

# c# - 在 C# 程序集中嵌入 XML 文件 - 命令行

> ID：11621406
> 
> 赞同：1
> 
> 时间：2012-07-23T22:21:11.490
> 
> 标签：c#, compiler-construction, command-line

在 C# 可执行文件中嵌入 XML 文件的常用方法是简单地将其添加到 Visual Studio 中的项目中，然后将其“构建操作”属性更改为“嵌入资源”。

这在 Visual Studio 中效果很好，但是如何仅使用命令行来实现相同的结果呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:59:53.367

MSBuild 是更通用的工具，用于构建具有多个 .CS 文件的复杂项目。MSBuild 相当于在 Visual Studio 中构建 .CSProj 的命令行。

使用 MSBuild 构建解决方案：

*   启动“Visual Studio 命令提示符”（或运行设置环境 VS 变量的命令文件）
*   检查 msbuild 在 PATH 中是否正确：`msbuild /?"
*   指定 .Csproj 作为构建它的参数：`msbuild MyProject.csproj`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T00:23:12.120

原来解决方案是`/res`在编译时使用参数，语法如下：

```
/res:MyFile.xml,MyNamespace.MyFile.xml 
```

`MyFile.xml`源目录中的文件在哪里，`MyNamepace.MyFile.xml`是调用时使用的名称`GetManifestResourceStream()`。

# django - 在 django 中获取用户定义的 url

> ID：11621411
> 
> 赞同：0
> 
> 时间：2012-07-23T22:21:39.473
> 
> 标签：django, django-urls

我想为我的应用程序添加一种让用户创建自己的 url 的方式。所以，我的意思是，如果用户想访问他们的网页，他们可以访问[http://www.projectdomain.com/JimmyJohn](http://www.projectdomain.com/JimmyJohn)

在我的模型中，我有

```
class Person(models.Model):
    username = models.CharField(max_length=30)  #username = JimmyJohn
    .... 
```

`/`最好的方法是通过添加一个在in之后捕获所有内容的方法来做到这一点`urls.py`？或者有没有办法更紧密地将我的模型与`urls.py`?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T23:07:17.623

只需将 url 添加到您的主 urls.py 接受第一个字母参数（考虑在此之上添加您的应用程序的任何其他 url，并验证用户名，因此您的 url 不是有效的用户名）：

```
urlpatterns = patterns('',
    # ... other fixed urls before
    url(r'^(\w+)/$', 'website.views.user_page', name='user_page'),
) 
```

然后在您的视图中查询与给定用户名匹配的用户：

```
def user_page(request, username):
    user = get_object_or_404(User, username=username)
    return render(...) 
```

# java - 使用 Java 读取 X.509 证书

> ID：11621414
> 
> 赞同：9
> 
> 时间：2012-07-23T22:22:00.380
> 
> 标签：java, certificate, saml

我正在尝试使用 Java 读取从外部方收到的证书。代码抛出以下错误：

> java.lang.RuntimeException：java.security.cert.CertificateException：无法初始化，java.io.IOException：给 DerValue 构造函数的额外数据

编码：

```
FileInputStream ksfis = new FileInputStream(this.getCertificateFile());
ksbufin = new BufferedInputStream(ksfis);
certificate = (X509Certificate)
  CertificateFactory.getInstance("X.509").generateCertificate(ksbufin); 
```

为了确保问题不在代码中，我创建了一个自签名证书并将其与代码一起使用，它运行良好。我已经在系统密钥链中安装了这两个证书，它们都是有效的。我使用的是 Mac 和 Java 1.6。

知道为什么在加载外部方证书时会出现上述异常吗？您认为它在传输过程中损坏了吗？如果是这样，它不应该在本地系统上显示为有效，对吧？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-23T22:30:34.080

尝试使用 openssl 输入，然后导入结果：

```
openssl x509 -outform der -in certificate.pem -out certificate.der 
```

或者在轻量级 API 中使用 Java Bouncy Castle 功能：

[http://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/openssl/PEMReader.html](http://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/openssl/PEMReader.html)

您可以再次对结果进行编码，然后使用`"X509"` `CertificateBuilder`Java 中的 获取 JCE 定义的证书，例如

```
ByteArrayInputStream certStream  =  new ByteArrayInputStream(binaryCert);
CertificateFactory certFactory = CertificateFactory.getInstance("X.509");
X509Certificate cert = (X509Certificate) certFactory.generateCertificate(certStream); 
```

# jquery - jQuery 动画左。获取当前左侧位置

> ID：11621419
> 
> 赞同：1
> 
> 时间：2012-07-23T22:22:50.757
> 
> 标签：jquery, jquery-animate

我正在为 div 设置动画：

```
$('.twitterNav').click(function(){
        var maxLeft = $('#jsTwitter').width() - $('.tweet').width() -10;
        $('#jsTwitter').animate({
            left: $(this).attr('data-id')+'='+($('.tweet').width()+10),
          }, 100, function() {
            //alert($('#jsTwitter').attr('left'));
          });
    }) 
```

如何检索当前的左侧位置？

我以为我可以做到这一点，`$('#jsTwitter').attr('left')`但这只是返回“未定义”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:27:51.797

尝试使用 jQuery `offset()`：

```
$('#jsTwitter').offset().left 
```

[http://api.jquery.com/offset/](http://api.jquery.com/offset/)

或者直接从 中提取左边`css()`：

```
$('#jsTwitter').css('left'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T22:23:53.673

我知道了

```
$('#jsTwitter').css('left') 
```

# git - 发布后删除的所有暂存但未提交的文件： git reset --hard HEAD

> ID：11621424
> 
> 赞同：9
> 
> 时间：2012-07-23T22:23:14.623
> 
> 标签：git, filesystems

通常，您可以执行以下操作：

```
$ echo "Stanley, you must beware of the Drive bee" > file-a
$ echo "What's a Drive bee?" > file-b
$ git init .
$ git add file-b
$ git commit file-b -m "We don't know, but whatever error you make with it could be fatal."
$ git reset --hard HEAD
$ ls
file-a file-b 
```

我觉得我做了一件很糟糕的事情：

```
$ echo "What are you doing, you darn ?" > file-a
$ echo "Can't you see I'm trying to drive?" > file-
$ git init .
$ git add -A
$ git commit file- -m "Oh, my God! [It's] the Drive !"
$ git reset --hard HEAD
$ ls
file- 
```

结果：所有暂存但未提交的文件已删除 0_o

```
git reset --hard HEAD\^
fatal: ambiguous argument 'HEAD^': unknown revision or path not in the working tree. 
```

有什么办法可以恢复我刚刚删除的文件吗？换句话说，是否可以将 git 存储库恢复到`git add -A`发出命令之前（或何时）的状态？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-23T22:35:37.203

是的，你真的很幸运。您添加到 Git 索引中的内容以某种方式存在。事实上，当每个文件被添加到索引中时，Git 确实已经为每个文件创建了 blob 对象。索引本身只存储树对象。

所以是的，为您的暂存文件创建了 blob 对象。您丢失的只是树信息，即路径和文件名，但您可以恢复内容。

尝试运行`git fsck`，你应该得到一个悬空 blob 的列表：

```
Checking object directories: 100% (256/256), done.
dangling blob ac28af8d84fc71eb247ccf665c6d0f4bf1822520
dangling blob 2d152ff9f09cb08ebc495f453da63eddaa9e249f
dangling blob cd9567427762cd8066b4e802e5c170a31a026100 
```

然后，您可以通过执行来恢复内容`git cat-file -p ac28af8d`。例如，您可以将其通过管道传输到文件：

```
git cat-file -p ac28af8d > recovered-file 
```

对他们所有人都这样做，你就会让他们回来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-06T15:10:25.077

以下脚本将所有悬空 blob 从`git fsck`输出恢复到文件中：

```
i=0; for x in `git fsck | grep "dangling blob [0-9a-f]" | cut -d ' ' -f 3`; do git cat-file -p $x > /tmp/test${i}; i=$((i+1)) ; done 
```

如您所见，每个原始文件的输出都恢复为通用文件名 /tmp/test${i} ...我还没有找到恢复文件名的方法...我尝试过的命令是`git ls-tree`：

首先，我采取了可能的对象：

```
./.git/objects/37
./.git/objects/37/5187f5882593f7e52c8efef602d98f1f049c5d
./.git/objects/37/98be05fcbd7c79e08703aead800529b362332b 
```

然后，我试图做到这一点`ls-tree`，但它未能将其识别为有效对象。

```
/<myproj>/.git/objects/37 ]$ git ls-tree 5187f5882593f7e52c8efef602d98f1f049c5d 
fatal: Not a valid object name 5187f5882593f7e52c8efef602d98f1f049c5d 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-06T17:04:08.007

我真的很喜欢从这个[答案](https://stackoverflow.com/a/953573/3420557)到相关 Stack Overflow 问题的以下解决方案：

1.  用于`git log --diff-filter=D --summary`获取所有已删除文件和已删除文件的提交
2.  用于`git checkout $commit~1 filename`恢复已删除的文件。

它简洁直观。

# javascript - Javascript 模块模式：何时使用方法私有化？吸气剂/二传手？改进空间？

> ID：11621430
> 
> 赞同：1
> 
> 时间：2012-07-23T22:23:37.103
> 
> 标签：javascript, design-patterns, module

我正在使用看起来像这样的模式（伪示例）：

```
var FOO = (function(foo) {

    var foo = foo || {},
    setThis = 'someValue';

    //--------------------------------------------------------------------------
    //
    // Public methods:
    //
    //--------------------------------------------------------------------------

    foo.init = function(bar) {

        this.blah = [];

        // Constructor stuff here...

    };

    foo.doSomething = function(bar) {

        if (bar) {

            this.doSomethingElse();

            // Stuff here...

        }

    };

    foo.doSomethingElse = function() {

        // Stuff here...

    };

    //--------------------------------------------------------------------------
    //
    // Private methods:
    //
    //--------------------------------------------------------------------------

    foo._imPrivate = function() {

        // ... stuff here ...

        this.blah = xyz; // References this.

    };

    foo._morePrivate = function(el) {

        // No reference to this.

    };

    foo._otherPrivate = function(el) {

        // No reference to this.

    };

    return foo; // Expose the methods.

}(FOO || {})); 
```

像这样实例化：

```
window.onload = function() { FOO.init(stuff); } 
```

三个问题：

1.  如果我的“私有”方法不引用`this`，我是否应该将它们设为“标准”函数（`function _imPrivate() { ... }`例如）？**我问的原因：**我有一些引用的方法`this`，但我不想让它们公开访问；我还有一些不引用的“实用程序”方法`this`......引用的方法可以`this`是标准函数（在模块模式的上下文中）吗？
2.  有人可以提供一个示例来说明我将如何为`setThis`变量实现设置器吗？
3.  Do you see any room for improvements in the above code?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:50:46.627

The "private" methods aren't private at all, they're public. The OP doesn't seem to take any advantage of closures available from the use of an immediately invoked function expression (IIFE).

The value of a function's `this` is set by how you call a function, it isn't static (unless you use ES5 bind). It has nothing to do with "context" (at least not in the way context is used in ECMA-262, which is how the word should be used in the context of javascript).

Douglas Crockford's [Private Members in JavaScript](http://www.crockford.com/javascript/private.html) will help.

If you post a real example of what you are trying to do, you will likely get more help on how to exploit the module pattern in its implementation.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T22:27:09.457

1.

You can do `_imPrivate.call(this, arg1, arg2,...);`

And in this case `this` in the `_imPrivate` function will refer to the particular instance.

2.

```
var setThis = 'someValue';

foo.setter = function(value) {
    setThis = value;
}; 
```

# vim - Vim 宏：记录/变量化选定对象

> ID：11621436
> 
> 赞同：0
> 
> 时间：2012-07-23T22:24:22.337
> 
> 标签：vim, macros

给定代码，是否有某种 Vim 插件可以让我做这样的事情：

```
function something (arbitraryObject) {
  arbitraryObject.something = doesNotMatter;
} 
```

然后假设我只是选择`arbitraryObject`函数体中的单词，我想要一种简单的方法来编写一个宏，给定一个简短的组合键或命令模式命令，可以给我类似的东西：

```
function something (arbitraryObject) {
  arbitraryObject.something = doesNotMatter;
  console.log(arbitraryObject);
} 
```

或者...

```
function something (arbitraryObject) {
  arbitraryObject.something = doesNotMatter;
  window.arbitraryObject = arbitraryObject;
} 
```

请注意，我不是在问这个宏实际上是什么样子，我很好奇是否有内置工具或插件可以使创建这样的东西特别容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:38:09.450

我知道您不是在要求特定的宏，但是通过示例来学习这些类型的东西是最容易的。第一个（console.log）可以通过这个映射来实现：

```
:vmap <leader>il y<esc>oconsole.log(<c-r>");<esc> 
```

同样，第二个可能如下所示：

```
:vmap <leader>iw y<esc>owindow.<c-r>" = <c-r>";<esc> 
```

你能发现相似之处吗？`<leader>il`表示该命令绑定到领导键（通常`,`），`i`后跟`l`. 您可以通过`:help [key]`在 vim 中使用来检查以下命令的含义，但映射基本上是`y`ank（复制）选定的文本，输入一个新行（`Esc`, `o`），然后附加一些文本，后跟`Ctrl`+`r`和`"`，插入被抽出的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:57:16.490

一种选择是使用[snipMate.vim 之](https://github.com/msanders/snipmate.vim)类的东西，并为您的各种任务提供片段。例如，您可以创建这些片段：

```
snippet cons
  console.log(${1:variable});${2}
snippet wind
  window.${1:attribute} = $1${2} 
```

然后你可以做类似的事情`yocons<Tab><C-r>"<Tab>`，或者类似的事情`yowind<Tab><C-r>"<Tab>`。您也可以使用`yiw`而不是视觉选择。我喜欢这样的选项，因为这样您就可以轻松地使其仅适用于特定类型的文件类型（例如 javascript），并继续扩展您已经存在的片段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-02T09:00:42.753

```
nmap <Leader>l o<esc>pv^"xygv[ygvdiconsole.log(<esc>a"<esc>pa",<esc>"xpa);<esc> 
```

这是更好的选择，因为它在 vim-unpared 的帮助下引用字符串。只需 yank 文本，您需要记录并使用此密钥绑定。它转换

```
this.$el.find("input,select,textarea") 
```

到

```
console.log("this.$el.find(\"input,select,textarea\")",this.$el.find("input,select,textarea")); 
```

# c# - 反序列化不会传输我的布尔值

> ID：11621438
> 
> 赞同：2
> 
> 时间：2012-07-23T22:24:41.580
> 
> 标签：c#, sockets, serialization, binaryformatter

我正在尝试学习 C# 中的套接字，并决定创建一个多人游戏进行练习。虽然我在套接字发送方面已经取得了很大进展，但我遇到了一个奇怪的问题，即在从另一个客户端接收并反序列化我的类后，布尔值总是变为真。

问题出现在这里：

```
void OnDataReceived(object sender, ConnectionEventArgs e)
{
    Connection con = (Connection)e.SyncResult.AsyncState;
    Game.ScoreBoard[currentPlayer] = Serializer.ToScoreCard(con.buffer); //Here
    ...
} 
```

*Game.ScoreBoard[currentPlayer].Local*总是为真，我完全不确定问题出在哪里。其他值似乎工作正常。Connection 是一个包含 IP、套接字和管理连接等的类。缓冲区大小当前为 30 000，因为我尝试扩大它以确保这不是问题。

以下是课堂上的相关信息：

```
public ScoreCard(SerializationInfo info, StreamingContext context)
{
    name = (string)info.GetValue("Name", typeof(string));
    played = (bool[])info.GetValue("Played", typeof(bool[]));
    scores = (int[])info.GetValue("Scores", typeof(int[]));
    bonusScore = (int)info.GetValue("bonusScore", typeof(int));
    local = (bool)info.GetValue("Local", typeof(bool));
} 
```

和

```
public void GetObjectData(SerializationInfo info, StreamingContext context)
{
    info.AddValue("Scores", scores, typeof(int[]));
    info.AddValue("Played", played, typeof(bool[]));
    info.AddValue("Name", name, typeof(string));
    info.AddValue("bonusScore", bonusScore, typeof(int));
    info.AddValue("Local", local, typeof(bool));
} 
```

这是序列化程序类：

```
static class Serializer
{
    public static byte[] ToArray(object data)
    {
        MemoryStream stream = new MemoryStream();
        BinaryFormatter b = new BinaryFormatter();
        b.Serialize(stream, data);
        return stream.ToArray();
    }

    public static ScoreCard ToScoreCard(byte[] data)
    {
        ScoreCard sc;
        MemoryStream stream = new MemoryStream(data);
        BinaryFormatter b = new BinaryFormatter();
        sc = (ScoreCard)b.Deserialize(stream);
        return sc;
    }
} 
```

我不知道该怎么做，或者即使提供的信息足以让您解决我的问题。如有必要，我可以提供更多信息。我只是觉得奇怪的是，似乎只有那个布尔值无法正常工作。

**编辑：我发现了问题，*像往常一样*，这是一个简单的愚蠢错误。哦，好吧，我至少学会了制作自己的二进制格式化程序。多谢你们 ：）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:37:31.147

BinaryFormatter 的性能很糟糕。它序列化的每个对象都有大量开销，根据我的经验，一个格式化程序需要> 40秒来序列化二进制对象，而自定义二进制编写器可以在< 1秒内完成。

您可能要考虑这一点：

```
static class Serializer
{
    public static byte[] MakePacket(ScoreCard data)
    {
        MemoryStream stream = new MemoryStream();
        using (StreamWriter sw = new StreamWriter(stream)) {
            sw.Write(1); // This indicates "version one" of your data format - you can modify the code to support multiple versions by using this
            sw.Write(data.Name);
            sw.Write(data.scores.Length);
            foreach (int score in data.scores) {
                sw.Write(score);
            }
            sw.Write(data.played.Length);
            foreach (bool played in data.played) {
                sw.Write(played );
            }
            sw.Write(data.bonusScore);
            sw.Write(data.local);
        }
        return stream.ToArray();
    }

    public static ScoreCard ReadPacket(byte[] data)
    {
        ScoreCard sc = new ScoreCard();
        MemoryStream stream = new MemoryStream(data);
        using (StreamReader sr = new StreamReader(stream)) {
            int ver = sr.ReadInt32();
            switch (ver) {
                case 1:
                    sc.name = sr.ReadString();
                    sc.scores = new int[sr.ReadInt32()];
                    for (int i = 0; i < sc.scores.Length; i++) {
                        sc.scores[i] = sr.ReadInt32();
                    }
                    sc.played = new bool[sr.ReadInt32()];
                    for (int i = 0; i < sc.scores.Length; i++) {
                        sc.played [i] = sr.ReadBool();
                    }
                    sc.BonusScore = sr.ReadInt32();
                    sc.Local = sr.ReadBool();
                    break;
                default: 
                    throw new Exception("Unrecognized network protocol");
            }
        }
        return sc;
    }
} 
```

# linux - 在 Windows azure 中删除 linux vm 中的数据磁盘返 回错误

> ID：11621443
> 
> 赞同：0
> 
> 时间：2012-07-23T22:25:39.973
> 
> 标签：linux, azure

我在 windows azure 上的 linux vm 连接了一个 300 GB 的数据磁盘，当我尝试删除它时，我在门户中收到一个错误，说磁盘未连接。在 azure 门户中我仍然看到数据磁盘附加到 linux vm 但无法删除它。

有没有人看到同样的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:29:31.567

要从 Windows Azure VM 中删除数据磁盘，您需要按照给定的步骤操作：

1.  确定您的数据磁盘在特定 Windows Azure 存储名称和容器中的物理位置并保留它
2.  现在登录到您的 Windows Azure VM (Linux/Windows) 并卸载数据磁盘
3.  之后，您需要从 Windows Azure VM 配置中分离数据磁盘，这可以通过门户或使用 Powershell 命令完成
4.  从 Windows Azure VM 配置中分离数据磁盘后，数据磁盘仍列在 Virtual Machines -> Disks (Disk Type - Data Disk) 部分，因此请继续从列表中选择您的特定数据磁盘并将其删除。
5.  第 4 步将删除 VHD 租约，并且数据磁盘将不再列在 Virtual Machines -> Disks 部分中，但是 VHD 仍在 Windows Azure 存储中占用宝贵的空间，因此您需要将其删除以回收空间。
6.  要永久删除 VHD，请使用第 3 方 Azure 存储工具或任何其他方法访问 Windows Azure 存储（您在步骤 #1 中确定），然后永久删除 VHD。

请尝试上述步骤，这应该会从 Windows Azure VM 中删除您的数据磁盘。

# java - 通过 JNI 将 C++ 字符串发送到 Java

> ID：11621449
> 
> 赞同：20
> 
> 时间：2012-07-23T22:26:29.030
> 
> 标签：java, android, c++, android-ndk, java-native-interface

我正在开发一个正在构建 Android 应用程序的项目的 C++ 端。我需要将一些信息（通过字符串和字符串数组）传递给 Java 应用程序（通过 JNI）。我以前从未这样做过，而反向工作的人没有使用 C++ 的经验，并且承认他们无法真正提供帮助。

我确实找到了以下代码（从[这里](http://www.coderanch.com/t/326467/java/java/Returning-String-array-program-Java)）

```
 #include <jni.h>  
    #include "ArrayHandler.h"  

    JNIEXPORT jobjectArray JNICALL Java_ArrayHandler_returnArray (JNIEnv *env, jobject jobj){        
      jobjectArray ret;  
      int i;  
      char *message[5]= {"first","second","third","fourth","fifth"};  
      ret= (jobjectArray)env->NewObjectArray(5,env->FindClass("java/lang/String"),env->NewStringUTF(""));  

      for(i=0;i<5;i++) {  
        env->SetObjectArrayElement(ret,i,env->NewStringUTF(message[i]));  
      }  
      return(ret);  
    } 
```

但这对我来说毫无意义。大多数情况下，我不确定我应该如何将它合并到程序的 C++ 端，并且我无法准确理解它是如何工作的。`return(ret);`代码是否在执行该行时发送消息？还是在 for 循环中执行该行期间？

理想情况下，我希望将字符串/字符串数组“实时”发送出去，而不是在函数的末尾，这样我就不必合并新函数。

我找到的代码能满足我的需要吗（经过一些调整）？我正在寻找的东西是否可能？如果是这样，我该怎么做？

**编辑/更新：** 花了一天时间研究 JNI 和术语，我认为我未能正确传达我希望在这里实现的目标以及对@jogabonito 的回答/回复的评论。

话虽如此。我正在处理的代码是用于 IM 客户端，它需要将消息和状态更新推送到 Android java 应用程序（通过 JNI），以便 Android 应用程序不会轮询更新。我已经设法学习了如何设置用于调用请求信息的 java 代码的函数。但是，我不知道如何将新消息或存在信息（jabber 节字符串）推送到 java 代码。需要从 java 代码中获取信息（env、class、methodid 等）。

当调用函数的不是 java 代码，而是我的 c++ 代码时，这对我来说是没有意义的。任何解释/帮助将不胜感激。

```
#include <string.h>
#include <stdio.h>
#include <jni.h>

jstring Java_the_package_MainActivity_getJniString( JNIEnv* env, jobject obj){

    jstring jstr = (*env)->NewStringUTF(env, "This comes from jni.");
    jclass clazz = (*env)->FindClass(env, "com/inceptix/android/t3d/MainActivity");
    jmethodID messageMe = (*env)->GetMethodID(env, clazz, "messageMe", "(Ljava/lang/String;)Ljava/lang/String;");
    jobject result = (*env)->CallObjectMethod(env, obj, messageMe, jstr);

    const char* str = (*env)->GetStringUTFChars(env,(jstring) result, NULL); // should be released but what a heck, it's a tutorial :)
    printf("%s\n", str);

    return (*env)->NewStringUTF(env, str);
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-07-04T00:00:36.293

应@Sam 的要求，这是一种避免使用修改后的 UTF-8 的方法，因为我们不知道这样做是否安全。

NewStringUTF 从其修改后的 UTF-8 编码创建一个字符串。将它与用户数据一起使用是不正确的——它不太可能使用修改后的 UTF-8 进行编码。我们只能希望数据中的字符受到限制以保持兼容。相反，我们可以正确地转换它。

JNI 在其整个 API 中使用修改后的 UTF-8 字符串。我们可以使用已知兼容的字符串，尤其是 Java 标识符的文字（并非所有货币符号除外）。

下面是两个本地方法实现。第二个在大多数方面都更好。

对于此本机方法：

```
private static native String getJniString(); 
```

这是一个实现：

```
JNIEXPORT jstring JNICALL 
Java_the_Package_MainActivity_getJniString(JNIEnv *env, jclass)
{   
    std::string message = "Would you prefer €20 once "
                          "or ₹10 every day for a year?";

    int byteCount = message.length();
    jbyte* pNativeMessage = reinterpret_cast<const jbyte*>(message.c_str());
    jbyteArray bytes = env->NewByteArray(byteCount);
    env->SetByteArrayRegion(bytes, 0, byteCount, pNativeMessage);

    // find the Charset.forName method:
    //   javap -s java.nio.charset.Charset | egrep -A2 "forName"
    jclass charsetClass = env->FindClass("java/nio/charset/Charset");
    jmethodID forName = env->GetStaticMethodID(
      charsetClass, "forName", "(Ljava/lang/String;)Ljava/nio/charset/Charset;");
    jstring utf8 = env->NewStringUTF("UTF-8");
    jobject charset = env->CallStaticObjectMethod(charsetClass, forName, utf8);

    // find a String constructor that takes a Charset:
    //   javap -s java.lang.String | egrep -A2 "String\(.*charset"
    jclass stringClass = env->FindClass("java/lang/String");
    jmethodID ctor = env->GetMethodID(
       stringClass, "<init>", "([BLjava/nio/charset/Charset;)V");

    jstring jMessage = reinterpret_cast<jstring>(
      env->NewObject(stringClass, ctor, bytes, charset));

    return jMessage;
} 
```

JNI 很尴尬。因此，如果我们可以将原生字符串是“UTF-8”的知识转移到 Java 端，我们可以这样做：

```
private static String getJniString2()
{
    return new String(getJniStringBytes(), Charset.forName("UTF-8"));
}
private static native byte[] getJniStringBytes(); 
```

还有更简单的实现：

```
JNIEXPORT jbyteArray JNICALL Java_the_Package_MainActivity_getJniStringBytes(JNIEnv *env, jclass)
{   
    std::string message = "Would you prefer €20 once "
                          "or ₹10 every day for a year?";

    int byteCount = message.length();
    jbyte* pNativeMessage = reinterpret_cast<const jbyte*>(message.c_str());
    jbyteArray bytes = env->NewByteArray(byteCount);
    env->SetByteArrayRegion(bytes, 0, byteCount, pNativeMessage);

    return bytes;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T11:51:07.597

在您共享的函数中，在您的 c++ 代码中，您正在使用`NewObjectArray`. 然后在您的 for 循环中，您将创建一个字符串，`NewStringUTF`并将其存储在数组中的索引处`SetObjectArrayElement`。到目前为止，您的对象数组只有您的 c++ 代码知道，而您的 java 代码不知道。只有当您返回它时，您的 java 应用程序才能访问它。
我可以想到几种将字符串从 c++ 发送到 java 的方法，尽管它可能不是您想要的。

1.  将字符串数组传递给您的本机函数。在您的本机代码中，您可以使用访问每个元素`GetObjectArrayElement`并使用`SetObjectArrayElement`. 这可能毫无意义，因为您最终不得不调用我认为您不想要的函数。

2.  如果您已经在您的 java 代码中定义了一个字符串作为字段，则可以从您的本机使用`GetFieldID`and访问它`GetObjectField`，并且您可以使用`SetObjectField`. 我不知道您将如何向您的 java 代码发出该字段已更新的信号（如果您需要）

**编辑**
您编写的更新函数旨在从 java 层调用。线索是函数的名称`Java_the_package_MainActivity_getJniString`。要从本机上下文调用 java 代码，您将需要对java`env`和`obj`from java 的引用。看看[如何在 Android 上的 C 中加载我自己的 Java 类？](https://stackoverflow.com/questions/6838397/how-do-i-load-my-own-java-class-in-c-on-android)获得这个的方法。您可能还需要查看如何在 JNI 中使用全局引用

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-07T22:44:37.657

您可以将 c-string 转换为 jstring 并返回它。一个例子看起来是这样的：

```
JNIEXPORT jstring JNICALL Java_Class_Method(jstring data) 
{

    // jstring to char *
    const char *cStr = (*env)->GetStringUTFChars(env, data, NULL);

    // convert char * to jstring and return it
    return ((*env)->NewStringUTF(env, cStr));
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T22:38:29.780

通常使用 JNI，调用从 JVM 进入 C 代码。正常的范式是：

1.  Java 程序员使用声明为（无实现）`class`的几种方法制作 Java`native`
2.  Java 程序员编译的`class`with`javac`
3.  Java 程序员`javah`针对编译后的`.class`文件运行，这会产生一个`.h`头文件
4.  C程序员`#include`新的头文件并实现接口

我见过的唯一反向执行此操作的示例（C 代码启动与 Java 的联系）涉及让 C 代码实际创建一个 JVM。

为了回答您关于代码示例的问题，正在创建的 Java 字符串在代码执行结束时与 return 语句一起返回，从逻辑上讲，这是该执行线程的程序流返回到 JVM 的时候。

# php - 尝试获取用户数据时 LDAP 上的错误搜索过滤器

> ID：11621450
> 
> 赞同：7
> 
> 时间：2012-07-23T22:26:33.023
> 
> 标签：php, ldap, symfony-1.4, ldap-query

我刚开始使用 LDAP，所以如果我以完全错误的方式执行此操作，请告诉我。

我正在使用 bhLDAPAuthPlugin 插件使用 Symfony 1.4

我正在使用 LDAP 验证用户登录。但是，我想使用用户名查询 LDAP 表中的更多数据。所以我正在编写这个搜索功能来根据用户名过滤结果：

```
function user_values($username) {
if (!$username) {
    die ("Username is not there man!");
}

if (!$this->_conn) {
    die ("No Connection.");
}
if (!$this->_base_dn) {
    die ("No Base.");
}
$filter="samaccountname=".$username;

$attributes_ad = array("name");
$result = ldap_search($this->_conn, $this->_base_dn, $filter, $attributes_ad) 
or die ("Error in search query");
$entries = ldap_get_entries($this->_conn, $result);
    return($entries);
} 
```

我收到错误消息：

**警告：ldap_search(): Search: Bad search filter in /... 搜索查询错误**

当我运行查询时。

前三个“如果”只是为了确保我获得了正确的搜索参数。该条件在实际搜索中失败。

有什么建议么？

**更新**

用户名变量是 jtesting

在将其放入搜索参数之前，我从函数中提取了 $username。它实际上是（jtesting）。我将删除括号，看看是否可以解决问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T00:30:07.367

为了在过滤器的断言值中使用括号，必须对括号进行转义。断言值所在的搜索过滤器`samAccountName=(jtesting)`应编码为`samAccountName=\28jtesting\29`. 整个断言值可能包含在未转义的括号中，在这种情况下，过滤器变为`(samAccountName=\28jtesting\29)`.

### 更多信息

*   [LDAP：搜索过滤器](http://www.ldapguru.info/ldap/mastering-ldap-search-filters.html)
*   [搜索过滤器的字符串表示](https://www.rfc-editor.org/rfc/rfc4515#section-3)

# html - 如何与其他不可调整大小的框一起调整大小的文本区域？

> ID：11621453
> 
> 赞同：2
> 
> 时间：2012-07-23T22:27:06.980
> 
> 标签：html, css, textarea

我一直在尝试让我的代码正常工作。我试图让一个 textarea 占据整个页面，除了一些不调整大小的导航栏。我让它工作得很好，但是滚动条被部分挡住了，所以我必须让 textarea 占据开放空间，而不是使用填充来让它避开导航栏。

这是我的 HTML：

```
<body>
<div id="topbar"></div>
<div id="tabbar"></div>
<div id="sidebar"></div>
<textarea wrap="off" id="maintext" autofocus="autofocus"> </textarea>
</body> 
```

这是我的CSS：

```
#topbar{
position: fixed;
top: 0px;
right: -1px;
left: -1px;
border: 1px solid black;
height: 35px;
background: black;
z-index: 1;
}
#tabbar{
position: fixed;
right: -1px;
left: -1px;
height: 20px;
background: grey;
margin: 29px auto;
border: 1px solid grey;
z-index: 2;
}
#sidebar{
position: fixed;
height: 100%;
left: 0px;
width: 15px;
margin: 51px auto;
border: 1px solid lightgrey;
background: lightgrey;
z-index: 3;
}
#maintext{
position: fixed;
right: 0px;
bottom: 50px;
left: 0px;
top: 58px;
margin-left: 20px;
width: 100%;
height: 100%;
border: none;
outline: none;
resize: none;
padding-top: 5px;
padding-left: 0px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T00:00:41.997

## IE8+（首选）

这是一个粗略的示例，它`textarea`完全显示（即没有任何内容被剪辑）：http: [//jsfiddle.net/UvJAM/1/](http://jsfiddle.net/UvJAM/1/)

可以对其进行修改以完全按照您的意愿进行操作，但需要注意 using `box-sizing`，这在 IE7 及以下版本中不受支持。

我还在周围添加了一个包装器，`textarea`以便可以使用填充来管理顶部/底部偏移量。

```
<div id="textwrapper">
    <textarea wrap="off" id="maintext" autofocus="autofocus"></textarea>
</div> 
```

## IE7

[http://jsfiddle.net/UvJAM/4/](http://jsfiddle.net/UvJAM/4/)

这个模型不太灵活，因为它限制了 的样式`textarea`，即任何填充或边框都会破坏它。但是，它确实支持 IE7（至少在仿真模式下）。也适用于 IE9 和 Chrome。

重要的部分是使用 4 部分位置语句来实现 100% 的高度和宽度。

```
 top: 0;
  right: 0;
  bottom: 0;
  left: 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:37:15.940

`DIV``TextArea`在 CSS 样式方面，s比 s 灵活得多。也许您可以考虑使用`DIV`带有`contentEditable`属性的 a（参见此处：[https](https://developer.mozilla.org/en/HTML/Content_Editable) ://developer.mozilla.org/en/HTML/Content_Editable ）。它是一个 HTML5 标准，但在更旧的浏览器（IE6、FF3.5）中得到了惊人的良好支持，但很少使用。

但是，如果您确实想继续使用 a ，我认为`textarea`对您的 CSS 进行以下修改可以`#maintext`实现您想要的。您将宽度和高度设置为 100%，这实际上使文本区域与正文一样宽和高。所以当你定位它时，它实际上会溢出页面。

```
#maintext{
position: fixed;
right: 0px;
bottom: 0px;
left: 20px;
top: 58px;
border: none;
outline: none;
resize: none;
padding-top: 5px;
padding-left: 0px;
} 
```

有关此处的更多详细信息：http `contenteditable`: [//www.whatwg.org/specs/web-apps/current-work/multipage/editing.html#contenteditable](http://www.whatwg.org/specs/web-apps/current-work/multipage/editing.html#contenteditable)

# c - Scanf 将“垃圾”值分配给变量

> ID：11621456
> 
> 赞同：0
> 
> 时间：2012-07-23T22:27:13.110
> 
> 标签：c, scanf

我试图编写一个简单的 c 程序，用导数做一些事情，但这不是问题的重点：当我运行程序时，它要求我输入一堆浮点值，但我输入什么并不重要scanf 函数将始终为变量分配“垃圾”值，这是代码：

```
double a, b, c, d, x, h;
printf("Please enter the coefficient of X cubed: ");
scanf("%3f", &a);
printf("\nPlease enter the coefficient of X squared: ");
scanf("%3f", &b);
printf("\nPlease enter the coefficient of X: ");
scanf("%3f", &c);
printf("\nPlease enter the free coefficient: ");
scanf("%3f", &d);
printf("\nPlease enter x: ");
scanf("%3f", &x);
printf("\nPlease enter the offset: ");
scanf("%3f", &h);

printf("%.3f %.3f %.3f %.3f %.3f %.3f", a,b,c,d,x,h); 
```

我输入了 a、b、c、d、x 和 h 的值，但 printf 函数显示的值非常奇怪——与我输入的完全不同。

我用我想到的所有可能的方式搜索了它，但我似乎无法找到它发生的原因。

有人可以尝试弄清楚它为什么会发生吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T22:28:06.677

使用`lf`转换说明符来读取`double`值，而不是使用转换`f`说明符来读取`float`值。`fscanf`并且`fprintf`功能在这方面是不对称的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:29:19.717

您必须使用`%lf`或`%g`提取双打，而不是`%f`.

# drupal-7 - 学习 Drupal 7 并尝试理解主题和模板

> ID：11621457
> 
> 赞同：1
> 
> 时间：2012-07-23T22:27:23.267
> 
> 标签：drupal-7, themes

我是学习 Drupal 的新手，我希望有人可以向我解释一些事情。我试图弄清楚如何将某些页面更改为具有不同的模板设计，例如一页可以有两列布局，一页可以有三列布局，或者一页可以是画廊。

类似于来自模板怪物的这个模板。 [http://www.templatemonster.com/drupal-themes/39996.html](http://www.templatemonster.com/drupal-themes/39996.html)

到目前为止，我在教程方面所看到的只是安装和设置主题并在网站周围安排块，但没有关于更改模板的内容。

我已经习惯了 Wordpress 做所有事情的方式，只需在仪表板中单击一下，您就可以更改页面的模板设计。如果有人可以解释它们的不同之处以及它们的相似之处，那就太好了！

另外，如果他们是一本关于 Drupal 7 的好书，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T15:27:45.920

恭喜您开始了学习 Drupal 的旅程。在我看来，它是当今最好的 CMS。

当以具有站点管理的用户身份登录时，Drupal 模板在“外观”部分受到控制。在那里，您可以添加新主题或在站点上已安装的主题之间切换。

至于根据您浏览的页面显示不同页面布局的站点主题，作为一般规则，Drupal 对待您的主页与内部页面不同。使用[页面](http://drupal.org/project/pages)模块等模块，您可以控制站点特定页面的外观、布局和功能。

有许多关于 Drupal 7 的优秀书籍涵盖了基础和中级主题。我最喜欢的是David Ipswich 的[Drupal 7 Manual](https://rads.stackoverflow.com/amzn/click/com/B005LVN67W)。

祝你好运！

# python - 如何使用defaultdict在python中读取行？

> ID：11621465
> 
> 赞同：1
> 
> 时间：2012-07-23T22:28:10.050
> 
> 标签：python, dictionary

我有一个字典，可以搜索 ID 名称并在其后读取标记。但我想知道是否有办法读取并打印出包含该 ID 名称的整行。

这是我到目前为止所拥有的：

```
lookup = defaultdict(list)
wholelookup =defaultdict(list)
mydata = open('summaryfile.txt')

for line in csv.reader(mydata, delimiter='\t'):
    code = re.match('[a-z](\d+)[a-z]', line[-1], re.I)
    if code: 
        lookup[line[-2]].append(code.group(1))
        wholelookup[line[-2]].append(code.group(0)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:38:40.930

如果你有足够的内存，最简单的方法是简单地将这些行保存在另一个 defaultdict 中：

```
wholeline = defaultdict(list)
...
idname = line[-2]
wholeline[idname].append(line) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:49:58.453

您的代码调用`csv.reader()`将返回整行的解析版本。在我的测试中，这会返回一个值列表。如果此值列表适用于“整行”，那么您可以保存它。

您有一行在其中附加了一些名为`wholelookup`. 我认为您只想保存`line`在那里而不是`code.group(0)`. `code.group(0)`返回正则表达式匹配的所有内容，这与`line[-1]`.

所以也许把这一行放在你的代码中：

```
wholelookup[line[-2]].append(line) 
```

或者，也许您需要将这些值连接在一起`line`以创建一个字符串：

```
s = ' '.join(line)
wholelookup[line[-2]].append(s) 
```

如果您想要整行，而不是解析后的版本，请执行以下操作：

```
lookup = defaultdict(list)
wholelookup = defaultdict(list)
pat = re.compile('[a-z](\d+)[a-z]', re.I)

with open('summaryfile.txt') as mydata:
    for s_line in mydata:
        values = s_line.split('\t')
        code = re.match(pat, values[-1])
        if code: 
            lookup[values[-2]].append(code.group(1))
            wholelookup[values[-2]].append(s_line) 
```

此示例预编译模式以获得轻微的速度优势。

# python - 为什么我会得到：无效的语法

> ID：11621466
> 
> 赞同：0
> 
> 时间：2012-07-23T22:28:16.500
> 
> 标签：python

我在以下内容上收到无效语法：

```
rootdir = 'c://temp/test//files//'
for subdir, dirs, files in os.walk(rootdir):
    for file in files:
        fileParts = file.split('.')
        if len(fileParts) > 1:
            stripper = fileParts([len(fileParts)-2]
            print(stripper) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T22:29:16.847

```
stripper = fileParts([len(fileParts)-2]
                                       ^ 
```

缺少右括号`)`，应该是：

```
stripper = fileParts([len(fileParts)-2])
                                       ^ 
```

*旁白：您可能会发现*[os.path](http://docs.python.org/library/os.path.html)模块中的一些函数很有用，尤其是[os.path.split()](http://docs.python.org/library/os.path.html?highlight=splitext#os.path.split)和[os.path.splitext()](http://docs.python.org/library/os.path.html?highlight=splitext#os.path.splitext)。如果您以后需要将路径放在一起，[os.path.join()](http://docs.python.org/library/os.path.html?highlight=splitext#os.path.join)很好用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T01:21:47.210

错误出现在代码的第 6 行，正确版本如下：

```
stripper = fileParts([len(fileParts)-2] 
```

您需要一个语法检查编辑器或 IDE。

# javascript - 小书签中的字符串操作与控制台中的行为不同

> ID：11621474
> 
> 赞同：1
> 
> 时间：2012-07-23T22:29:16.163
> 
> 标签：javascript, regex, string, google-chrome, bookmarklet

在 Google Chrome 控制台中，这有效（它说弹出窗口被阻止，但现在不要介意）

```
open('http://www.bugmenot.com/view/'+(escape(location).replace(/^\w+%3a\/\//i,'').replace(/\/.*/i,''))); 
```

弹出窗口在`http://www.bugmenot.com/view/thesite.com`

现在，这不能用作书签：

```
javascript:open('http://www.bugmenot.com/view/'+(escape(location).replace(/^\w+%3a\/\//i,'').replace(/\/.*/i,''))); 
```

它不会打开完全相同的 URL，而是打开`http://www.bugmenot.com/view/http%3A`.

**为什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:39:42.803

试试这个：

```
javascript:open('http://www.bugmenot.com/view/'+(escape(location).replace(/^.*?\/\/([^\/]*).*$/i, "$1"))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:43:08.237

导致此问题的原因是在 URL 栏中或书签中`%3a`被解释为 a 。`:`

```
javascript:alert('%3a'); 
```

将被解释为

```
javascript:alert(':'); 
```

正则表达式上的这个值也会随之而来，相关的后果也会随之而来。

# standards - 在 URL 中使用重复参数

> ID：11621477
> 
> 赞同：18
> 
> 时间：2012-07-23T22:29:21.503
> 
> 标签：standards, url-parameters

我们正在内部构建 API，并且经常传递具有多个值的参数。

他们使用：mysite.com?id=1&id=2&id=3

而不是：mysite.com?id=1,2,3

我赞成第二种方法，但我很好奇第一种方法是否真的不正确？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-23T22:58:34.297

我不是 HTTP 专家，但据我了解，关于多个值的 URL 的查询部分没有明确的标准，通常取决于处理请求以解析查询字符串的 CGI。

[RFC 1738](http://www.ietf.org/rfc/rfc1738.txt)第 3.3 节提到 a`searchpart`并且它应该在之后，`?`但似乎没有详细说明它的格式。

> `http://<host>:<port>/<path>?<searchpart>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-26T22:02:11.667

我没有（费心）检查哪个 RFC 标准定义了它。（任何知道这一点的人请在评论中留下参考。）但实际上，`mysite.com?id=1&id=2&id=3`当表单包含重复字段（通常是复选框）时，浏览器的生成方式已经是这样了。在这个[w3schools 示例页面](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml_input_checked)中查看它的实际应用。因此，您使用的任何编程语言很有可能已经提供了一些帮助函数来解析这样的输入并可能返回一个列表。

当然，您可以采用您自己的方法，例如`mysite.com?id=1,2,3`，在这种特殊情况下这一点也不差。但是您需要实现自己的逻辑来生成和使用这种格式。现在您可能需要也可能不需要考虑自己处理一些极端情况，例如：如果输入格式不正确怎么办，例如`mysite.com?id=1,2,`？如果逗号本身也可以是有效输入，您是否需要发明另一个分隔符，例如`mysite.com?name=Doe,John|Doe,Jane`？您是否会达到将使用 json 字符串作为值的程度，例如`mysite.com?name=["John Doe", "Jane Doe"]`？等等等等。您的里程可能会有所不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-16T12:17:33.820

值得补充的是，在服务器上对 URL 中重复参数的不一致处理可能会导致漏洞，特别是[服务器端 HTTP 参数污染](https://www.owasp.org/index.php/Testing_for_HTTP_Parameter_pollution_(OTG-INPVAL-004)#Server-side_HPP)，有一个实际示例 -[客户端 Http 参数污染 - Yahoo! 经典邮件视频 Poc](http://blog.mindedsecurity.com/2009/05/client-side-http-parameter-pollution.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T13:34:12.463

在您的第一种方法中，您将获得一个查询字符串值数组，但在第二种方法中，您将获得一个查询字符串值字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-19T16:02:42.380

我想这取决于您使用的技术，它如何变得方便。我目前正站在同一个问题的前面，使用`currency=USD,CHF`或`currency=USD&currency=CHF`

我正在使用 Thymeleaf 并且使用第二个选项可以轻松工作，然后我可以请求类似：`${param.currency.contains(currency.value)}`. 当我尝试使用第一个选项时，它似乎需要像字符串一样的“数组”，所以我需要先拆分然后包含，这导致我的代码更加混乱。

只是我的 50 美分 :-)

# python - 确定一个 zip 文件中有多少个文件

> ID：11621481
> 
> 赞同：1
> 
> 时间：2012-07-23T22:29:47.797
> 
> 标签：python, zip, byte

我正在尝试通过读取每个字节来读取 zip 文件（在 python 2.7.2 中）。我能够通过本地文件头和数据。但是，我在尝试读取中央文件头时被卡住了。

这有很大帮助[http://en.wikipedia.org/wiki/File:ZIP-64_Internal_Layout.svg](http://en.wikipedia.org/wiki/File:ZIP-64_Internal_Layout.svg)

我不知道如何找出存档中有多少项目，因此我可以切换到格式化中央文件头，或者如何知道如何从格式化文件切换到中央文件头。

这就是我现在所拥有的——

```
import sys

def main(debug=0,arg_file=''):
    if debug==2:
        print "- Opening %s" % arg_file
    with open(arg_file) as archive: 
        if debug==2:
            print "- Reading %s" % arg_file

        bytes = archive.read()
        if debug==2:
            print "-------------Binary-------------"
            print bytes

        #Read file headers
        end = 0
        while end != bytes.__len__():
            print end
            end = process_sub_file(debug,end,bytes)

def process_sub_file(debug,startbytes, bytes): 
    header = bytes[startbytes + 0] + bytes[startbytes + 1] + bytes[startbytes + 2] + bytes[startbytes + 3]
    version = bytes[startbytes + 4] + bytes[startbytes + 5]
    flags = bytes[startbytes + 6] + bytes[startbytes + 7]
    comp_method = bytes[startbytes + 8] + bytes[startbytes + 9]
    mod_time = bytes[startbytes + 10] + bytes[startbytes + 11]
    mod_date = bytes[startbytes + 12] + bytes[startbytes + 13]
    crc = bytes[startbytes + 14] + bytes[startbytes + 15] + bytes[startbytes + 16] + bytes[startbytes + 17]
    comp_size_bytes = bytes[startbytes + 18] + bytes[startbytes + 19] + bytes[startbytes + 20] + bytes[startbytes + 21]
    comp_size = ord(comp_size_bytes[0]) + ord(comp_size_bytes[1]) + ord(comp_size_bytes[2]) + ord(comp_size_bytes[3])
    uncomp_size_bytes = bytes[startbytes + 22] + bytes[startbytes + 23] + bytes[startbytes + 24] + bytes[startbytes + 25]
    uncomp_size = ord(uncomp_size_bytes[0]) + ord(uncomp_size_bytes[1]) + ord(uncomp_size_bytes[2]) + ord(uncomp_size_bytes[3])
    name_len_bytes = bytes[startbytes + 26] + bytes[startbytes + 27]
    name_len = int(ord(name_len_bytes[0])+ord(name_len_bytes[1]))
    extra_len_bytes = bytes[startbytes + 28] + bytes[startbytes + 29]
    extra_len = int(ord(extra_len_bytes[0])+ord(extra_len_bytes[1]))
    file_name = ""
    for i in range(name_len):
        file_name = file_name + bytes[startbytes + 30 + i]
    extra_field = "" 
    for i in range(extra_len):
        file_name = file_name + bytes[startbytes + 30 + name_len + i]
    data = ""
    for i in range(comp_size):
        data = data + bytes[startbytes + 30 + name_len + extra_len + i]
    if debug>=1:
        print "-------------Header-------------"
        print "Header Signature: %s" % header
        print "Version: %s" % version
        print "Flags: %s" % flags
        print "Compression Method: %s" % comp_method
        print "Modification Time: %s" % (ord(mod_time[0]) + ord(mod_time[1]))
        print "Modification Date: %s" % (ord(mod_date[0]) + ord(mod_time[1]))
        print "CRC-32: %s" % crc
        print "Compressed Size: %s" % comp_size
        print "Uncompressed Size: %s" % uncomp_size
        print "File Name Length: %s" % name_len
        print "Extra Field Length: %s" % extra_len
        print "File Name: %s" % file_name
        print "Extra Field: %s" % extra_field
        print "Data:\n%s" % data
    return startbytes + 30 + name_len + extra_len + comp_size 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:35:13.413

您想在文件中向后搜索“中央目录结尾”块。它包含中央目录中的条目总数。

[在http://www.pkware.com/documents/casestudies/APPNOTE.TXT](http://www.pkware.com/documents/casestudies/APPNOTE.TXT)中搜索“中央目录记录结束：”

如果中央目录中的条目总数 = 0xffff，那么您必须搜索位于“中央目录结尾”块之前的“Zip64 中央目录结尾”块。在这种情况下，Zip64 块将包含 zip 文件的中央目录中的实际条目数。

“EofCD”块包含中央目录开头的偏移量，然后您可以转到该位置，开始遍历整个中央目录中的所有文件头块。

# java - Java：多态性和调用方法

> ID：11621489
> 
> 赞同：2
> 
> 时间：2012-07-23T22:30:44.790
> 
> 标签：java, oop

> **可能重复：**
> [为什么我们不能做 List<Parent> mylist = ArrayList<child>();](https://stackoverflow.com/questions/5763750/why-we-cant-do-listparent-mylist-arraylistchild)

我有一个关于多态性和调用方法的问题。

我的服务层签名是`public void saveRules(String paramOne, String paramTwo, List<RuleDTO> rules)`

我的`EvaluationRuleDTO extends from RuleDTO`

所以从我的控制器我尝试执行以下操作：

`service.saveRules(String paramOne, String paramTwo, List<EvaluationRuleDTO> rules)`.

但这是不允许的，因为它抱怨`List<EvaluationRuleDTO`> 规则不是`List<RuleDTO> rules`.

这对我来说没有多大意义。这是 Java 语言的弱点，还是我在这里缺少什么概念？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T22:33:26.330

这是因为多态性应用于 List 类型，而不是其泛型。

**编辑 1：**迈克尔发表了一条带有有用链接的评论。

**编辑2：**你可以做（​​从[为什么我们不能做 List<Parent> mylist = ArrayList<child>();](https://stackoverflow.com/questions/5763750/why-we-cant-do-listparent-mylist-arraylistchild)）：

```
List<? extends RuleDTO> list = yourEvaluationRuleDTOList; 
```

# ios - 自动抓取 Orbeon 表单的 iOS GPS 数据？

> ID：11621490
> 
> 赞同：0
> 
> 时间：2012-07-23T22:30:45.083
> 
> 标签：ios, orbeon

我对 Orbeon 有点陌生，我正试图弄清楚如何自动填充一些表单数据。例如，如何在获得许可的情况下从 iOS 表单查看器中获取纬度/经度信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:45:14.493

Orbeon 没有内置此功能。但是，如果您可以使用 JavaScript 做到这一点，那么您可以使用[JavaScript API](http://wiki.orbeon.com/forms/doc/developer-guide/xforms-javascript-integration)将其存储到隐藏的输入中。

# javascript - Tinyscrollbar - 禁用选择或突出显示

> ID：11621493
> 
> 赞同：3
> 
> 时间：2012-07-23T22:31:07.923
> 
> 标签：javascript, jquery, css, jquery-plugins, tinyscrollbar

我在我的网站上使用 JQuery Tinyscrollbar 插件。由于我的特殊要求，我做了一些小改动，使其同时使用垂直和水平滚动条。

但是，我遇到的问题是，如果用户使用滚动条滚动并且光标在滑动时没有悬停在“拇指”元素上，则背景内容会突出显示，类似于您单击并突出显示文本时看到的内容或元素。

我怎样才能防止这种情况发生。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-18T13:34:10.577

您需要将 .noSelect 类添加到您的 CSS

```
.noSelect { 
    user-select: none; 
    -o-user-select: none; 
    -moz-user-select: none; 
    -khtml-user-select: none; 
    -webkit-user-select: none; 
} 
```

当拖动 Tinyscrollbar 时，.noSelect 类被添加到页面的主体，然后在拖动完成后删除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T15:43:23.843

我们有另一个解决方案（我认为，它更容易）。
如果 tinyscrollbar 的**thumb** -div 不能被选中，那么在悬停的时候，下面或上面的任何其他部分也不会被选中。
所以我们将**noSelect** -class 添加到**thumb** -div，这对我们有用。
只有在 IE 上我们仍然有问题。我们将属性**unselectable="on"**添加到**thumb** -div 确实有效。

我们最终得到了这段代码：

HTML：

```
<div class="scrollbar">
  <div class="track">
    <div class="thumb noSelect" unselectable="on">
      <div class="end"></div>
    </div>
  </div>
</div> 
```

CSS：

```
.noSelect { 
  user-select: none; 
  -o-user-select: none; 
  -ms-user-select: none;
  -moz-user-select: none; 
  -khtml-user-select: none; 
  -webkit-user-select: none; 
  -webkit-touch-callout: none;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T22:50:13.197

对于现代浏览器，使用 CSS: 'user-select': 'none'; 在容器上。对于较旧的浏览器（例如 IE），请在 JavaScript 中使用“onselectstart”事件。

这个答案解决了 jQuery 插件的问题： [How to disable text selection using jQuery?](https://stackoverflow.com/questions/2700000/how-to-disable-text-selection-using-jquery)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T13:07:47.707

在 TinyScrollbar 插件中，找到这个函数：

```
function start(event) {
    ...
    ...
} 
```

添加`return false`

```
function start(event) {
    ...
    ...
    return false;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T01:22:10.980

我尝试了一些东西，它似乎工作。所以我会把它贴在这里，这样它可能对其他可能有问题的人有所帮助。请随时改进我的解决方案。

添加到 CSS

```
.unselectable {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
} 
```

然后将这些添加到一个在 document.ready 上调用的 js 文件中

```
function DisableSelection()
{   
    // Find all DIV elements
    $("body > div").each(function(){
        var context = $(this);
        context.addClass('unselectable');
        context.attr('unselectable','on'); // for IE < 10 and Opera
    });
} 
```

# php - 具有无限子类别的 PHP & Mysql 树导航菜单

> ID：11621494
> 
> 赞同：3
> 
> 时间：2012-07-23T22:31:08.247
> 
> 标签：php, mysql, arrays, recursion, tree

我正在寻找一种从 mysql 数据库中提取数据以创建无限子类别菜单的方法。菜单中有大约 1500 个类别，它们以下列格式存储到数据库表（菜单）中：

category_id , 类别标题 , parent_id

我想做 1 mysql 查询将所有数据放入一个数组中。

```
$menu_list =array();

$query = mysql_query("SELECT * FROM menu ORDER BY category_id ASC");

if(mysql_num_rows($query) != 0) {
        while($row = mysql_fetch_array($query)){
              $category_id = $row['category_id'];
              $title = $row['category_title'];
              $parent_id = $row[parent_id'];
              $menu_list[] = array($category_id,$title,$parent_id);
        }
} 
```

那是我目前用来将数据转换为数组的代码。

然后我需要遍历数组来建立一个菜单。

然后我将隐藏所有子类别并使用 jquery 扩展（我可以做到这一点没问题）

我遇到的问题是遍历数组并以正确的顺序显示数据。该菜单有无限的子类别，因此它可能需要一个递归函数来检索数据。我已经关注了这里的很多例子，但后来我迷失了如何显示数据..

我现在需要结束：

```
main item
  sub cat
  sub cat
      sub cat 
          sub cat 
main item
   sub cat
main item
main item
   sub cat
       sub cat
          sub cat
             sub cat
             sub cat

etc... 
```

每个类别都在自己的 div 中，然后我需要能够编辑每个类别（即标题名称和位置，如果需要）然后如果我更改子类别的位置，快速页面刷新将以新顺序重新加载菜单..

最终我想把它变成一个拖放，但这将在以后的日期。

我希望这已经足够解释了..

提前致谢..

* * *

所以问题又回来困扰我了......我的ajax调用另一个mysql选择的方法对于CMS部分来说是可以的，因为它只是不时使用。但是现在我们已经到了前端。每次查看页面时，都会使用大量 mysql 请求来拉取菜单的前 3 级。随着类别越来越大，这导致 1600 多个类别被多次提取，即使每天 1000 次访问也会导致每天超过 1000000 个 sql 请求。所以我想我肯定需要将类别拉到一个数组中，然后递归地遍历数组。

我已经查看了上面的解决方案，它们似乎在纸上有效，但在实践中却没有。

如果有人可以尝试给我另一种解决方案，将不胜感激..

只是回顾一下我的数据库：id，category_name，parent_id

我现在正在使用 PDO 和 mysql 并准备语句以增加安全性..

提前致谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T18:32:53.403

这是您需要的代码

category_id AS id ，类别标题 AS categori 和 parent_id AS Kid

```
function countsubcat($pid)
{

   $r=mysql_query("select count(kid) AS say from meskat where kid='$pid' limit 1");

   $rw=mysql_fetch_array($r);

   return $rw['say'];

}

function listmenu($pid = 0)
{

   $res = mysql_query("select id,kategori,kid from meskat where kid='$pid'");

   while($cat=mysql_fetch_array($res))

   {

     echo '<li>';

     print'<a href="#">'.$cat['kategori'].'</a>';

     if(countsubcat($cat['id'])>0)

     {

      print'<ul>';

         listmenu($cat['id']);

      print'</ul>';

     }
   echo '</li>';

   }

}

echo '<ul>';

listmenu(0); //starting from base category

echo '</ul>';` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:38:23.910

在 MySQL 中，这将需要许多查询，每个级别一个，至少一个。

1.  您获取所有顶级类别，将它们用作森林（一组树）的根节点。
2.  您获取属于其中任何一个子级的所有类别。
3.  将这些类别中的每一个作为子节点添加到父节点
4.  如果还有孩子，则进行第二步，否则停止。

你最终会得到一棵树，你首先深度遍历它以转换为一些（大概）html 表示（例如嵌套列表）。

您可以执行一些优化。如果您按父 ID 对子级别进行排序，那么您可以假设子级别是连续的，这意味着您不必进行尽可能多的查找来找到正确的父级，只需检查父级 ID 的变化。

如果您维护一个由 ID 索引的当前最低级别类别的列表，则可以加快林的创建速度。

如果您重叠第 2 步和第 4 步，那么您只执行 n+1 个查询（其中 n 是级别数），因此检查更多子级也是抓取下一级子级。

在内存方面，这将使用树所需的内存，加上最低级别的查找表和当前父 ID。

构建算法相当快，随着类别的数量线性缩放。

此方法还成功地避免了损坏的数据部分，因为它不会抓取具有循环（无根节点）的数据。

我还建议对子查询使用准备好的语句，因为 MySQL 将编译和缓存查询，它将通过仅通过网络发送新数据来加快操作。

如果您不理解某些概念，我建议您访问 Wikipedia，因为我已尝试对这些概念使用标准术语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T12:00:43.513

因此，在对不同解决方案进行了各种尝试之后，我实际上已经使用 jquery 和 ajax 加载来检索下一个级别。

我的主要类别都有 1 的父级 - 商店我对所有以 1 作为父级 ID 的类别进行 mysql 扫描。

这将显示主要类别。附加到每个主要类别，如果它们有任何子类别，我添加了一个文件夹图标。我还插入了一个带有该类别 id 的空白 div。

单击该文件夹时，它会对 php 脚本进行 ajax 调用，以查找具有该父级的所有类别。这些附加到 parents_id div。

这又添加了类别（使用 css 填充以指示子类别），如果它具有子类别，则再次添加一个文件夹符号以及另一个具有 category_id 的空白 div。

您可以根据客户的需要对尽可能多的类别和子类别继续执行此操作。

我更进一步，为类别/子类别添加了一个编辑图标，以便可以移动或更改类别。

如果您想要一些示例代码，请告诉我...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T00:01:28.847

**如果**您可以假设任何类别`category_id > parent_id`为真，则以下递归函数将菜单表示为多级数组并将其呈现为嵌套 HTML 列表将起作用：

```
$menu = array();

$query = mysql_query("SELECT category_id, category_title, parent_id FROM menu ORDER BY category_id ASC");
if(mysql_num_rows($query) != 0) {
        while($row = mysql_fetch_assoc($query)) {
            if(is_null($row['parent_id']))
                $menu['children'][] = $row;
            else
                add_to_menu(&$menu,$row);
        }
}

function add_to_menu($menu,$item) {
    if(isset($menu['children'])) {
        foreach($menu['children'] as &$child) {
            if($item['parent_id'] == $child['category_id']) {
                $child['children'][] = $item;
            } else {
                add_to_menu(&$child,$item);
            }
        }
    }
}

function render_menu($menu) {
    if(isset($menu['children'])) {
        echo '<ul>';
        foreach($menu['children'] as &$child) {
            echo "<li>";
            echo $child['category_id']." : ".$child['category_title'];
            if(isset($child['children'])) {
                render_menu(&$child);
            }
            echo "</li>";
        }
        echo '</ul>';
    }
}

render_menu($menu); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T00:10:07.553

你能改变表结构吗？在这种情况下，您可以查看[嵌套集模型](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)（链接包括描述和实现细节，向下滚动到*嵌套集模型*）。节点插入和删除变得更加复杂，但允许您在一次查询中检索整个树。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-13T11:58:57.740

实际上，您需要很少的代码来构建一棵树。您也只需要一个查询。这是我想出的（我使用 Drupal 的数据库，但它足够明确，可以理解）：

```
$items = db_select('menu_items', 'mi')
    ->fields('mi')
    ->orderBy('position')
    ->execute()
    ->fetchAllAssoc('id', PDO::FETCH_ASSOC);

// Example of result. The ID as key is important for this to work.
$items = array(
    3 => array('id' => 3, 'parent' => NULL, 'title' => 'Root', 'position' => 0),
    4 => array('id' => 4, 'parent' =>    3, 'title' => 'Sub',  'position' => 0),
    5 => array('id' => 5, 'parent' =>    4, 'title' => 'Sub sub', 'position' => 0),
    6 => array('id' => 6, 'parent' =>    4, 'title' => 'Sub sub', 'position' => 1),
);

// Create the nested structure. Note the & in front of $item.
foreach($items as &$item)
    if($item['parent'])
        $items[$item['parent']]['sub items'][$item['mid']] =& $item;

// Now remove the children from the root
foreach($items as $id => $item)
    if($item['parent']) // This is a child
        unset($items[$id]) 
```

此时，您只需要一个递归函数来显示菜单：

```
function print_menu($items) {
    echo '<ul>';
    foreach($items as $item) {
        echo '<li>';

        echo '<a href="#">' . $item['title'] . '</a>';
        if(!empty($item['sub items']))
                print_menu($item['sub items']);

        echo '</li>';
    }
    echo '</ul>';
} 
```

# hibernate - 如何获取 grails hibernate L2 缓存统计信息？

> ID：11621495
> 
> 赞同：2
> 
> 时间：2012-07-23T22:31:26.130
> 
> 标签：hibernate, grails, profiling, ehcache

grails hibernate L2 缓存统计 - net.sf.ehcache.Statistics

我将 ehcache 与我的 L2 缓存一起使用。

我想分析性能并从 net.sf.ehcache.Statistics 获取统计信息。没有任何成功，我一直在寻找一种从 Grails 或 Spring 访问 L2 缓存管理器的方法。

我很感激任何提示。

波纹管是使用的典型休眠设置

```
hibernate {

    cache.use_second_level_cache = true

    cache.use_query_cache = true

    cache.region.factory_class = 'net.sf.ehcache.hibernate.EhCacheRegionFactory'

    format_sql = true

    use_sql_comments = true
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T06:24:19.517

您可以`sessionFactory`通过将其注入您的服务来获取它，然后对其[启用统计信息](http://www.javalobby.org/java/forums/t19807.html)：

```
class My Service {

  def sessionFactory

  def myMethod() {
    // Enable stats
    Statistics stats = sessionFactory.getStatistics();
    stats.setStatisticsEnabled(true);

   // Do some querying and analyse the stats

  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:38:02.163

只需添加`generate_statistics=true`到您的休眠设置：

```
hibernate {
    ...
    generate_statistics=true
    ...
} 
```

# forms - 使用 mPDF 从 HTML 表单创建 PDF

> ID：11621499
> 
> 赞同：0
> 
> 时间：2012-07-23T22:32:09.547
> 
> 标签：forms, fpdf, html-encode, mpdf

我想使用 mpdf 创建我的 PDF 文件，因为我使用挪威字母，例如 ÆØÅ。PDF 文件上的信息主要由用户以 HTML 形式编写的文本组成。但是，我有一些问题。

使用此代码时：

```
$mpdf->WriteHTML('Text with ÆØÅ'); 
```

PDF 将显示特殊字符。

但是当使用这个时：

```
<?php
include('mpdf/mpdf.php');

$name = 'Name - <b>' . $_POST['name'] . '</b>';

$mpdf = new mPDF();

$mpdf->WriteHTML($name);

$mpdf->Output();
exit;

?> 
```

特殊字符不会显示。

HTML 表单如下所示：

```
<form action="hidden.php" method="POST">
    <p>Name:</p>
    <input type="text" name="name">

   <input type="submit" value="Send"><input type="reset" value="Clear">
</form> 
```

为什么用这种方法不显示特殊字符？我应该使用哪种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T12:47:37.680

由于将 POST 数据回显到网站上也不会显示字符，因此这显然不是 mpdf 的问题。当使用包含非 Ascii 字符的内容时，必须特别注意网站的字符编码。

从 mpdf-documentation 可以看出它支持 UTF-8 编码，因此您可能希望将其用于您的数据。以网站使用的相同编码接收 POST 数据。因此，如果网站是 latin-1，您需要调用**utf8_encode()**将 POST 数据转换为 unicode。如果网站已经使用 UTF-8，你应该没问题。

如果您没有在网站标题中设置特定的编码（您应该始终避免这种麻烦），编码可能取决于几个因素，例如服务器上的操作系统和配置或原始 php 源文件的编码事实证明，这受您自己的操作系统配置和编辑器选择的影响。

# java - 使 Jlabel(pictures) 在 Jframe 周围可拖动？

> ID：11621501
> 
> 赞同：2
> 
> 时间：2012-07-23T22:32:19.087
> 
> 标签：java, jframe, jlabel, imageicon

我将如何使标签（图片）“可拖动”。所以，基本上是为了让我可以点击 jlabel 图片，然后在 jframe 周围移动它并放下它。我四处寻找，但对我没有帮助，所以我想知道你们中是否有人知道如何使它工作？

```
package src;

import java.awt.Dimension;

import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JLabel;

/*
 * @Author - 0x29A
 * 
 * 
 */
public class Jframe {

    public static void main(final String args[]) {
        /*
         * @Images
         */
        final ImageIcon icon = new ImageIcon("Data/button.png");
        final JLabel label = new JLabel(icon);

        final ImageIcon icon1 = new ImageIcon("Data/button1.png");
        final JLabel label1 = new JLabel(icon1);

        final ImageIcon icon2 = new ImageIcon("Data/button2.png");
        final JLabel label2 = new JLabel(icon2);

        final ImageIcon icon3 = new ImageIcon("Data/button3.png");
        final JLabel label3 = new JLabel(icon3);

        final ImageIcon icon4 = new ImageIcon("Data/button4.png");
        final JLabel label4 = new JLabel(icon4);

        final ImageIcon icon5 = new ImageIcon("Data/button5.png");
        final JLabel label5 = new JLabel(icon5);

        final ImageIcon icon6 = new ImageIcon("Data/background.png");
        final JLabel label6 = new JLabel(icon6);

        /*
         * @Image Location
         */
        label.setBounds(282, 255, 96, 96);
        label1.setBounds(384, 255, 96, 96);
        label2.setBounds(282, 153, 96, 96);
        label3.setBounds(384, 153, 198, 96);
        label4.setBounds(181, 152, 96, 96);
        label5.setBounds(181, 255, 96, 96);
        label6.setBounds(0, 0, 765, 503);

        /*
         * @Frame
         */
        final JFrame frame = new JFrame("Test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setPreferredSize(new Dimension(765, 503));
        frame.setLayout(null);
        frame.add(label);
        frame.add(label1);
        frame.add(label2);
        frame.add(label3);
        frame.add(label4);
        frame.add(label5);
        frame.add(label6);
        frame.pack();
        frame.setResizable(false);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:44:00.397

它归结为许多要求。主要的“谁负责管理”。您可以实现它，以便每个标签负责它自己的布局管理或容器负责。

各有各的优点。我更喜欢容器管理的方法，因为它不会将您锁定在只能使用标签的范围内。

您需要熟悉[MouseMotionListener](http://docs.oracle.com/javase/7/docs/api/java/awt/event/MouseMotionListener.html)和[MouseListener](http://docs.oracle.com/javase/7/docs/api/java/awt/event/MouseListener.html)。

基本思想是监视何时发生单击（以及单击了什么）并使用单击点确定拖动鼠标时的偏移量。

## 更新

抱歉，我花了一些时间才找到，但我回答了一个可能有用的问题[Object on Image does not move when Image move](https://stackoverflow.com/questions/11494674/object-on-image-does-not-move-when-image-moves/11514537#comment15274390_11514537)。

它并不完全相同，但它包含可能有帮助的概念。

# jquery - jQuery 'POST' 授权

> ID：11621504
> 
> 赞同：1
> 
> 时间：2012-07-23T22:32:34.007
> 
> 标签：jquery, ajax, post, authorization

我使用 jquery-ajax 方法 POST 来发布授权标头，但 Firebug 显示错误“401 Unauthorized”标头作为该方法的参数。

我究竟做错了什么？我该怎么办？

```
jQuery(function(dat) {
dat.ajax({
  type: "POST",
  url: url,
  data: {
    Latlng: 'coordinates.coordinates',
    texts: 'text'
  },
  success: function(dat) {
    setMarkers(dat);
  },
  dataType: "json"
});
}); 
```

这是我忘记的 oAuth 方法（我不认为这有什么问题，因为我按照示例进行了操作。）

> var url = "https://stream.twitter.com/1/statuses/filter.json"; var accessor = { token: "token", tokenSecret: "token_secret", consumerKey: "consumer_key", consumerSecret: "consumer_secret" };
> 
> ```
> var message = {
>   action: url,
>   method: "POST",
>   parameters: {
>     track: 'nutella',
>     locations: '-180,-90,180,90'
>   }
> }; 
> ```
> 
> OAuth.completeRequest（消息，访问者）；
> OAuth.SignatureMethod.sign（消息，访问者）；网址 = 网址 + '?' + OAuth.formEncode(message.parameters);

我关闭了秘密数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T22:51:27.707

您必须发送一个额外的标题。我知道如果您尝试调用 google api，他们会要求标题为 Authorization 的标题。以下是您将如何通过 jQuery 做到这一点。

```
function setHeader(xhr) {

 xhr.setRequestHeader('Authorization', '12345');
 xhr.setRequestHeader('SomethingElse', 'abcdefg');

}

$.ajax({

        url: 'www.google.com',
    type: 'POST',
    datatype: 'json',
    success: function() { alert("Success"); },
    error: function() { alert('Failure!'); },
    beforeSend: setHeader

}); 
```

# php - 为什么我会收到“在非对象上调用成员函数 getFloorplan()”？

> ID：11621505
> 
> 赞同：0
> 
> 时间：2012-07-23T22:32:56.020
> 
> 标签：php, class, object

我的 php 页面中有以下代码：

```
 $fair           = Factory::new_fair_obj();
  $fairs          = $fair->getAllFairs();
  $fairs_ddl      = createFairDDL($fairs);
  $first_fair_id  = $fairs[0]['id'];
  $fair           = $fair->getFair($first_fair_id);  // <-- works till here
  $floorplan      = $fair->getFloorplan($first_fair_id);  // <-- This is where it breaks 
```

这是扩展 DAO 的业务类：

```
interface iFair {
  public function getAllFairs();
  public function getFair($id);
  public function getFloorplan($id);
}

class Fair extends FairDAO implements iFair {
  protected $db;

  function __construct(&$db) {
    $this->db = $db;
  }
  public function getAllFairs(){
    return parent::getAllFairs();
  }

  public function getFair($id){
    return parent::getFair($id);
  }

  public function getFloorplan($id){
    return parent::getFloorplan($id);
  }
} 
```

通话`getFair()`效果很好。但是调用`getFloorplan()`下一行是行不通的。

怎么来的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T22:37:00.727

将两行更改为：

```
$fair1           = $fair->getFair($first_fair_id);  // <-- works till here
$floorplan      = $fair->getFloorplan($first_fair_id);  // <-- This is where it breaks 
```

您将在变量 $fair 中获得 getFair() 的结果，该变量与对象的名称相同。所以它只是被覆盖了。

# android - 使用 HTC 通过彩信发送 jpg 图像

> ID：11621507
> 
> 赞同：1
> 
> 时间：2012-07-23T22:33:11.397
> 
> 标签：android, mms, htcsense

我正在尝试使用 HTC 设备（2.3.5，HTC Desire HD-Sense）通过彩信发送 jpg 图像，我正在使用以下代码段

```
File sendfilepath = new File("file://" + sendfile);
Uri urimms = Uri.fromFile(sendfilepath);

Intent sendIntent = new Intent("android.intent.action.SEND_MSG");
sendIntent.putExtra(Intent.EXTRA_STREAM, urimms);
sendIntent.setType("image/jpeg");
startActivity(sendIntent); 
```

它会打开消息应用程序，但不会附加图像。我不知道为什么？它显示吐司“无法加载消息”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T13:10:42.500

尝试这个

```
Intent sendIntent = new Intent(Intent.ACTION_SEND); 
        sendIntent.setClassName("com.android.mms", "com.android.mms.ui.ComposeMessageActivity");
        sendIntent.putExtra("sms_body", "some text"); 
        sendIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file:///sdcard/image_4.png"));
        sendIntent.setType("image/png");
        startActivity(sendIntent);; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:36:21.883

像这样的东西应该工作：

```
Intent intent = new Intent(Intent.ACTION_SENDTO, Uri.parse("mmsto:<number>");
intent.putExtra("address", <number>);
intent.putExtra(Intent.EXTRA_STREAM, urimms);
intent.setType("image/jpeg");
startActivity(intent); 
```

否则这些链接看起来有点过时，但您应该能够很好地翻译所有内容：

*   [带有图像和正文的 Android MMS Intent](https://stackoverflow.com/questions/10490329/android-mms-intent-with-with-image-and-body-text)
*   [http://androidforums.com/application-development/25988-send-image-action_send.html](http://androidforums.com/application-development/25988-send-image-action_send.html)

# .net - 为什么 SerialPort 类没有 RIHolding 属性？

> ID：11621509
> 
> 赞同：3
> 
> 时间：2012-07-23T22:33:22.507
> 
> 标签：.net, serial-port, api-design

简单的问题。.NET[`SerialPort`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport)类具有以下用于获取串行输入行的属性：

*   [`CDHolding`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.cdholding)- 获取端口的载波检测线的状态。
*   [`CtsHolding`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.ctsholding)- 获取 Clear-to-Send 行的状态。
*   [`DsrHolding`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.dsrholding)- 获取数据集就绪 (DSR) 信号的状态。

笔记`RIHolding`不见了。

此外，它还有[`PinChanged`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.pinchanged)活动。这提供了一个[`SerialPinChange`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialpinchange)枚举值，它具有以下成员，并且*确实包括*一个用于 Ring：

*   `CtsChanged`- 清除发送 (CTS) 信号已更改状态...
*   `DsrChanged`- 数据集就绪 (DSR) 信号已更改状态...
*   `CDChanged`- 载波检测 (CD) 信号已更改状态...
*   `Ring`- 检测到环形指示器。
*   `Break`- 在输入时检测到中断。

所以我的问题是，为什么没有`RIHolding`财产？

* * *

如果我们查看内部`SerialStream`类，我们会看到`CDHolding`、`CtsHolding`和`DsrHolding`都是通过调用 Win32[`GetCommModemStatus`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363258.aspx)函数实现的。他的`lpModemStat`输出值为以下之一：

*   **`MS_CTS_ON`** `0x0010`CTS（清除发送）信号打开。
*   **`MS_DSR_ON`** `0x0020`DSR（数据集就绪）信号打开。
*   **`MS_RING_ON`** `0x0040`振铃指示灯信号亮。
*   **`MS_RLSD_ON`** `0x0080`RLSD（接收线路信号检测）信号开启。*（这映射到`CDHolding`）*

所以，添加一个只查看第 6 位的属性似乎是微不足道的`RIHolding`。为什么这个被遗漏了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T05:00:04.553

由于振铃信号的节奏，它本质上是一个瞬态信号。如果它打开，那么它不会持续很长时间。例如，美国为 2 秒，英国为 400 毫秒。所以信号的状态意义不大，它取决于时间，更糟糕的是，当你真的很不幸时，你总是会观察到它。你最好在它打开时抓住它，因此 PinChanged 会报告它。

# c# - 全屏时 Kinect 语音识别未检测到

> ID：11621513
> 
> 赞同：2
> 
> 时间：2012-07-23T22:33:43.097
> 
> 标签：c#, fullscreen, speech-recognition, kinect, xna-4.0

这是一个奇怪的案例。我在 XNA 中将 Microsoft.Speech 与 Kinect 一起使用。除了我在一台显示器上全屏运行游戏外，一切都按预期工作。如果我不是全屏模式，或者我通过 HDMI 连接到另一台显示器并处于全屏模式，Kinect 可以毫无问题地检测和识别语音。但是，当我全屏运行游戏时，没有其他 HDMI 连接，甚至从未检测到语音，更不用说识别了。初始化过程中没有错误。总结一下：

*   窗口模式 - 按预期工作
*   全屏与第二个 HDMI 显示器连接 - 按预期工作
*   全屏无其他显示器连接 -**无语音检测**

*可能相关，可能不相关，如果我在插入另一台显示器的情况下全屏运行游戏（或任何游戏），则游戏无法渲染（在两台显示器上保持闪烁，就好像它试图反复进入和离开全屏一样) 但同样，在这种情况下，语音效果很好。*

有什么想法吗？像往常一样，所有人都受到赞赏。谢谢！

# php - 如何将 HTML 输入字段中的值插入 MySQL？

> ID：11621514
> 
> 赞同：1
> 
> 时间：2012-07-23T22:33:50.960
> 
> 标签：php, mysql, html, forms, date

如何将（在表单中）的值插入 MySQL 日期字段。我正在尝试这个：

```
<form  action="enviar.php" autocomplete="off" method="post"> 
    <label for="nacimiento" class="youpasswd" data-icon="p">
        Fecha de Nacimiento
    </label>
    <br>
    <input id="nacimiento" name="nacimiento"
           required type="datetime" placeholder="DD/MM/YYYY" />
</form> 
```

环境变量.php

```
$nacimiento= $_POST['nacimiento'];
mysql_query("INSERT INTO voluntarios(nacimiento) VALUES ('$nacimiento')");` 
```

这适用于所有其他字段，但不适用于日期字段；它是空的。我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T22:44:32.727

[即使将值从您的字段获取到服务器](https://stackoverflow.com/questions/11621514/how-can-i-insert-the-value-from-an-html-input-field-into-mysql/11621598#comment15389864_11621582)，您[似乎也遇到了问题`input`](https://stackoverflow.com/questions/11621514/how-can-i-insert-the-value-from-an-html-input-field-into-mysql/11621598#comment15389864_11621582)。这需要先解决。[调试](http://xdebug.org/)（[`var_dump`](http://php.net/manual/de/function.var-dump.php)）您的`$_POST`数据并检查发生了什么。如果您需要更多帮助，请[提供更多代码。](http://jsfiddle.net/WzuzR/1/)从您写的内容来看，我看不出为什么不应该发送该值。

获得日期字符串后，[将值转换为](http://php.net/manual/de/function.date.php)[MySQL 识别](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-literals.html)的字符串文字格式：

```
$mysqldate = date( 'Y-m-d H:i:s', $phpdate ); 
```

然后使用插入它[`mysqli_query`](http://php.net/manual/de/mysqli.query.php)：

```
mysqli_query(sprintf("INSERT INTO voluntarios(nacimiento) VALUES ('%s')"),
                      mysql_real_escape_string($mysqldate)); 
```

使用[PDO](http://www.php.net/manual/en/book.pdo.php)执行此操作：

```
$dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass);
$q = $dbh->prepare("INSERT INTO voluntarios(nacimiento) VALUE (:nacimiento)");
$q->bindParam(':nacimiento', $mysqldate, PDO::PARAM_STR);
$success = $q->execute(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T22:42:42.147

尝试回显`$_POST['nacimiento'];`，看看它是否有任何作用？您似乎也没有发布整个 SQL 查询，也许查询中有错误？

[编辑：您也可以尝试使用mysql_error](http://php.net/manual/en/function.mysql-error.php)查看错误

* * *

以下代码易受[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)

```
$nacimiento= $_POST['nacimiento'];
mysql_query("INSERT INTO voluntarios(nacimiento) VALUES ('$nacimiento')");` 
```

停止使用 mysql_* 函数，因为它们已被弃用。请改用[PHP 数据库对象 (PDO)](http://php.net/manual/en/book.pdo.php)，因为 PDO 允许参数绑定，从而保护您免受 sql 注入。

[您可以在此处](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)阅读有关使用 PDO的信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T22:45:29.200

MySQL 需要 YYYY-MM-DD 格式的日期文字，[如手册中所述](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-literals.html)。尽管它接受的内容非常宽松，但您提供的格式是不可接受的。

您可能可以摆脱一些字符串杂耍，但请帮自己一个忙，并且*做对*- 也就是说，使用[PDO 准备好的语句](http://www.php.net/manual/en/pdo.prepared-statements.php)。您不仅可以轻松地将日期解析和预检查推迟到 php，而且您的代码将更加安全和面向未来。

使用示例中的元素，代码将如下所示

```
$stmt = $dbh->prepare("INSERT INTO voluntarios(nacimiento) VALUES (:nacimiento)");
$stmt->bindParam(':nacimiento', $nacimiento);
// WARNING - strtotime strtotime expects '-' separators if you feed it dd-mm-yyyy
// you should modify that in your form.
$nacimiento = strtotime($_POST['nacimiento']);
$stmt->execute(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T23:06:48.887

您的问题可能是需要将日期格式化为 SQL 标准 (YYYY-MM-DD)。

如果你对 POST 中的内容相当有信心，那么你可以使用这个：

```
$formatted_date = date('Y-m-d',strtotime($_POST['nacimiento'])); 
```

如果要确保格式，则可以使用以下内容：

```
preg_match('#^(\d{1,2})/(\d{1,2})/(\d{4})$#', $_POST['nacimiento'], $matches);
if(count($matches))
{
    $formatted_date = $matches[3].'-'.str_pad($matches[1],2,0,STR_PAD_LEFT).'-'.str_pad($matches[2],2,0,STR_PAD_LEFT);
    // Use formatted date in query
}
else // handle error 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T22:41:20.023

用于`STR_TO_DATE`将文本转换为有效的日期格式：

```
STR_TO_DATE('12/15/2008', '%m/%d/%Y'); 
```

# javascript - jQuery在对话框中的表单上重置验证

> ID：11621518
> 
> 赞同：0
> 
> 时间：2012-07-23T22:35:06.670
> 
> 标签：javascript, jquery

我一直在努力在关闭时重置对话框窗口中的表单。我的表单正在使用 jQuery 验证，我尝试使用记录在案的 resetForm() 函数，但没有运气。

以下是关于我如何在用户点击“关闭”时尝试清除表单的两种尝试。两者都没有工作。

这是 jsFiddle：http: [//jsfiddle.net/FjT7T/6/](http://jsfiddle.net/FjT7T/6/)

```
$("#myDialog").dialog({
    autoOpen: false,
    close: function(event, ui) {
        // Attempt to reset the form using JQuery validates resetForm(), not working.
        var validator = $("#myForm").validate();
        validator.resetForm();
        // Attempt to reset the form and remove the error classes, not working either. 
        $(this).closest("form")[0].reset().removeClass("error");
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:44:02.757

你试过普通的javascript重置吗？

```
document.getElementById('myForm').reset(); 
```

甚至 jQuery，但使用表单的 id：

```
$("#myForm").reset(); 
```

并删除类，为什么注意使用`#id`

```
$("#myForm").removeClass("error"); 
```

# ios - Bar Button Item 仅在一个标签栏控制器导航栏中

> ID：11621519
> 
> 赞同：13
> 
> 时间：2012-07-23T22:35:12.490
> 
> 标签：ios, uitabbarcontroller, uibarbuttonitem

我有一个带有 4 个视图控制器的标签栏控制器，并且在导航控制器中有这个标签栏控制器。

我想为标签栏控制器的一个特定视图控制器显示 UIBarButtonItem。

我尝试使用以下

```
if (tabBarController.selectedViewController == customTourViewController)
    {
        [tabBarController.navigationItem setRightBarButtonItem:done];
    } 
```

但是按钮不显示。

如果我将每个视图控制器都放在导航控制器中，那么按钮只会显示该视图，但我最终会有 2 个导航栏。

有什么办法可以实现第一个解决方案吗？谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-24T04:32:25.957

In my individual view controllers for the individual tabs, I have the following in the one that needs the button:

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    UIBarButtonItem *rightButton = [[UIBarButtonItem alloc] initWithTitle:@"Done"
                                                                    style:UIBarButtonSystemItemDone target:nil action:nil];
    self.tabBarController.navigationItem.rightBarButtonItem = rightButton;
} 
```

And in the view controllers that don't need the button, I have:

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    self.tabBarController.navigationItem.rightBarButtonItem = nil;
} 
```

So, if it's not working for you, I'm not sure if it's your reference to `tabBarController` without the `self` designation (if I omit the `self` I get a compiler error). And where is this code because if it's in your tabBarController subclass, then you want `self.navigationItem.rightBarButtonItem`, right? Do you have your own ivar defined for that variable name? Or are you sure that `done` is defined properly (i.e. not `nil`)? Or are you sure this code is being called at all (perhaps set a breakpoint or insert a `NSLog` and make sure this code is being reached)?

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-11T18:01:38.093

或者，您可以在需要按钮的同一视图中实现 viewWillDisappear。

```
-(void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];        
    self.tabBarController.navigationItem.rightBarButtonItem = nil;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-16T22:52:22.780

上面接受的答案正是我所需要的，只是想将其转换为 Swift 以供将来使用。

我已将以下代码添加到需要栏按钮的视图控制器中（我为此示例创建了一个添加按钮）：

```
override func viewWillAppear(_ animated: Bool) {
    super.viewWillAppear(animated)

self.tabBarController?.navigationItem.rightBarButtonItem = UIBarButtonItem(barButtonSystemItem: .add, target: self, action: nil)
} 
```

在不需要此条形按钮的视图控制器中，只需添加以下代码

```
override func viewWillAppear(_ animated: Bool) {
    super.viewWillAppear(animated)

self.tabBarController?.navigationItem.rightBarButtonItem = nil
} 
```

您使用`viewWillAppear`Vice`viewDidAppear`是因为您希望每次用户转到指定的视图控制器时都会出现条形按钮。

简单的说，`viewDidAppear`运行时调用一次，`viewWillAppear`每次访问视图控制器时都会调用。

# android - 九个补丁图像显示点

> ID：11621522
> 
> 赞同：1
> 
> 时间：2012-07-23T22:35:24.020
> 
> 标签：android

我已经使用 android draw9patch 实用程序创建了几个 9-patch 图像，但我还没有制作一个可以工作的图像。在一张图像上，我在上边缘有 2 个点，在左边缘有 2 个点；“显示坏补丁”按钮显示没有坏补丁，右侧的样本看起来很好。但是，在应用程序中，图像的顶部和右侧显示黑色 9patch 点。

我们是否应该设置 backgroundColor 或 cachecolor 来隐藏图像视图中的点？

我的目标是谷歌地图 2.3.3。此 API 是否存在已知问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:50:07.907

当它们显示在手机上时，这些点就会消失。它们告诉 Android 系统可以拉伸图像的哪些部分而不会扭曲它的外观。如果您注意到 9patch 的格式是`.9.png`，那么在显示图像并删除点之前，Android 会进行预处理。我发现“显示坏补丁”很少会产生影响，即使它们被认为是“坏的”，它们也会按照我想要的方式工作。至少在我的经验中。只需将 9 个补丁添加到您的活动中并像往常一样引用它们

* * *

# 更新

* * *

等一等。您是否尝试使用 9patches 作为要在 中显示的图像`ImageView`？这不是 9patches 的用途。9patches 是按钮或其他 UI 元素的可拉伸图像（即，用于不同的屏幕尺寸），因此开发人员可以使用一张图像来拉伸和适应不同尺寸的按钮，而不是每种尺寸都使用一张。Android 以`ImageView`. 如果您使用 显示 9patches `ImageView`，Android 不会将黑点预处理为可重复的图像切片，它只是显示整个内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:53:55.317

你给文件的全名是什么？文件名必须以“.9.png”结尾才能正常工作。否则，它将被视为普通 png 文件，该文件将在图像边缘显示点和线。

# python - 如何在 App Engine (Python) Datastore 中获取当月的记录？

> ID：11621525
> 
> 赞同：2
> 
> 时间：2012-07-23T22:35:43.287
> 
> 标签：python, google-app-engine, datetime, google-cloud-datastore

给定以下实体：

```
class DateTest(db.Model):
    dateAdded = db.DateTimeProperty()
    #... 
```

从当月获取记录的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-23T23:01:45.507

There are a few ways you can do this. For example, using `Query`:

```
import datetime
from google.appengine.ext import db

q = db.Query(DateTest)

# This month
month = datetime.datetime.today().replace(day=1, hour=0, minute=0, second=0, microsecond=0)

q.filter('dateAdded >= ', month)
results = q.fetch(10) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:53:53.477

您可以尝试以下方法：

```
import datetime
now = datetime.datetime.now()

DateTest.gql("WHERE dateAdded.month:1", now.month) 
```

# c# - 我错过了什么模式

> ID：11621528
> 
> 赞同：0
> 
> 时间：2012-07-23T22:36:00.523
> 
> 标签：c#, .net, oop, design-patterns

我有以下界面

```
interface IConsoleHistory
{
    void Add(string entry);

    HistoryEntry GetNextEntry();

    HistoryEntry GetPreviousEntry();

    void ResetHistoryMarker();

    void Delete(HistoryEntry entry);

    void DeleteEntireHistory();
}

public class HistoryEntry
{
    public HistoryEntry(string value, int index, bool isCommand)
    {
        Value = value;
        Index = index;
        IsCommand = isCommand;
    }

    public string Value { get; private set; }

    public int Index { get; private set; }

    public bool IsCommand { get; private set; }
} 
```

基于此，我实现了一个 InMemoryHistory：

```
public class InMemoryHistory : IConsoleHistory
{
    protected List<string> History { get; private set; }
    private int _currentIndex;

    public InMemoryHistory() :this(new List<string>())
    {
    }

    protected InMemoryHistory(List<string> history)
    {
        History = history;
        _currentIndex = -1;
    }

    public virtual void Add(string entry)
    {
        History.Insert(0, entry);
    }

    public HistoryEntry GetNextEntry()
    {
        if (GetHighestIndex() > _currentIndex)
        {
            _currentIndex++;
            return ReturnAtIndex(_currentIndex);
        }

        return null;
    }

    private int GetHighestIndex()
    {
        return History.Count - 1;
    }

    private int GetLowestIndex()
    {
        return History.Count > 0 ? 0 : -1;
    }

    public HistoryEntry GetPreviousEntry()
    {
        if (_currentIndex > GetLowestIndex())
        {
            _currentIndex--;
            return ReturnAtIndex(_currentIndex);
        }
        _currentIndex = -1;
        return null;
    }

    private HistoryEntry ReturnAtIndex(int index)
    {
        return new HistoryEntry(History[index], index, false);
    }

    public void ResetHistoryMarker()
    {
        _currentIndex = -1;
    }

    public void Delete(HistoryEntry entry)
    {
        if (History.ElementAtOrDefault(entry.Index) != null)
        {
            History.RemoveAt(entry.Index);
        }
    }

    public void DeleteEntireHistory()
    {
        History.Clear();
    }
} 
```

现在我想要一个基于文件的历史记录。为了保持代码干燥，我想从 InMemoryHistory 继承，并在每次添加后保留整个 List。

```
public class FileBasedHistory : InMemoryHistory
{
    private readonly string _fileName;

    public FileBasedHistory():this("history.txt")
    {
    }

    public FileBasedHistory(string fileName) :base(GetHistoryFromFile(fileName))
    {
        _fileName = fileName;
    }

    public override void Add(string entry)
    {
        base.Add(entry);
        WriteToDisk();
    }

    private void WriteToDisk()
    {
        using(var textWriter = new StreamWriter(_fileName, false, Encoding.UTF8))
        {
            History.ForEach(textWriter.WriteLine);
        }
    }

    private static List<string> GetHistoryFromFile(string fileName)
    {
        if (!File.Exists(fileName))
            return new List<string>();

        return File
            .ReadAllLines(fileName)
            .ToList();
    }
} 
```

这就像一个魅力。困扰我的是我需要静态`GetHistoryFromFile`方法。这并不是什么大问题，但我想知道我是否错过了更适合这种情况的模式？

**更新**

正如基思已经建议的那样。这也是让我有点困扰的继承方法。继承应该始终是*is a*的问题。

你不能说：*“A FileBasedHistory **is a** InMemoryHistory”*

所以我想知道我是否应该尝试为此使用*StrategyPattern*。或者可能编写一个 AbstractConsole 来实现部分逻辑但为扩展留出空间。关于如何重构它的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:50:47.987

我觉得很奇怪您将列表作为构造函数传递。你根本不必那样做...

与其将您的 GetHistoryFromFile 视为创建新列表，不如将其视为加载到现有列表中的一种方法（这种方式也变得更普遍有用......因为它可以将多个文件加载到历史记录中）。

删除和清除也无法正常写入磁盘...

同样逐行写入磁盘可能会变得很慢......

此外，您的 InMemory 和基于文件的存储可能会遇到巧合耦合。这意味着虽然它们目前相似，但它们可能有分歧的机会。例如，如果您的基于磁盘的系统使用滚动历史文件和缓存历史。所以不要太依赖 InMemory 和 File 以保持在继承结构中，将它们分开可能更容易

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:38:38.213

我认为你已经做到了完美。`GetHistoryFromFile`仅适用于 a `FileBasedHistory`，因此它应该在那里是有道理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T23:39:28.543

你可以`Iterator`在这里使用。这三种方法仅用于迭代数据：

```
HistoryEntry GetNextEntry();
HistoryEntry GetPreviousEntry();
void ResetHistoryMarker(); 
```

这些方法用于管理数据：

```
void Add(string entry);
void Delete(HistoryEntry entry);
void DeleteEntireHistory(); 
```

我认为这是一项不同的职责，我将他们转移到不同的班级。

# ruby - 如果当前版本，跳过 .rvmrc 中的 RubyGems 安装

> ID：11621533
> 
> 赞同：0
> 
> 时间：2012-07-23T22:36:27.390
> 
> 标签：ruby, rubygems, rvm, rvmrc

我`.rvmrc`的文件内容如下：

```
rvm --install use 1.9.3@my_gemset && rvm rubygems 1.8.6 && gem list 
```

不幸的是，即使我当前的 ruby​​gems 版本是 1.8.6，这也会导致重新安装 ruby​​gems。这不是一个大问题，但每当我打开一个新选项卡或必须移出并移回应用程序目录时，这都是一个小麻烦。

如果 RubyGems 已经是指定版本，是否可以跳过安装？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T00:14:37.777

you would need to check rubygems version:

```
rvm --install --create use 1.9.3@my_gemset &&
{
  [[ "$(gem --version)" =~ 1.8.6 ]] || rvm rubygems 1.8.6
} &&
gem list 
```

# ruby-on-rails - Rails - 用时区解析时间的更好方法？

> ID：11621535
> 
> 赞同：1
> 
> 时间：2012-07-23T22:36:51.583
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, datetime, timezone

Time.parse 返回一个没有时区的 Time 对象。我想保留时区信息。有没有比下面的代码更好的方法来做到这一点？

```
def parse_with_timezone( string_input)
  /(.*)([+-]\d\d):?(\d\d)$/.match( string_input) do |match|
    tz = ActiveSupport::TimeZone[match[2].to_i.hours + match[3].to_i.minutes]
    tz.parse( match[1])
  end
end 
```

输入是这样的字符串“2012-12-25T00:00:00+09:00”。此函数输出一个 TimeWithZone 对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T21:23:18.420

您是否在寻找当前本地时区的特定时区？

```
# Current zone
1.9.3p194> Time.zone.parse('2012-12-25T00:00:00+09:00')
=> Mon, 24 Dec 2012 15:00:00 UTC +00:00 
```

控制台在上面设置为 UTC，但适用于您配置的任何内容

```
# Specific timezone 
1.9.3p194> Time.find_zone('Wellington').parse('2012-12-25T00:00:00+09:00')
=> Tue, 25 Dec 2012 04:00:00 NZDT +13:00 
```

我注意到您正在尝试通过 +9，例如

```
1.9.3p194> Time.zone = 'Tokyo'
=> "Tokyo" 
1.9.3p194> Time.zone.parse('2012-12-25T00:00:00+09:00')
=> Tue, 25 Dec 2012 00:00:00 JST +09:00 
```

给你正确的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:18:21.277

Rails 时区 API 怎么样：http: [//api.rubyonrails.org/classes/ActiveSupport/TimeZone.html](http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T04:17:13.230

我更喜欢使用[Chronic](http://chronic.rubyforge.org/)来满足我所有的日期/时间解析需求。

# python - Pylons 0.9.6 获取当前服务器名称

> ID：11621548
> 
> 赞同：0
> 
> 时间：2012-07-23T22:38:52.493
> 
> 标签：python, pylons, paster

在我的 Pylons 配置文件中，我有：

```
[server:main1]
port = 9090
...config here...

[server:main2]
port = 9091
...config here... 
```

使用以下方式运行：

```
paster serve --server-name=main1 ...(more stuff)...
paster serve --server-name=main2 ...(more stuff)... 
```

现在，使用 Haproxy 和 Stunnel，我将所有 http 请求都发送到 main1，所有 https 请求都发送到 main2。我希望我的一些控制器根据是否在 http 或 https 下被请求做出不同的反应，但 pylons.request.scheme 总是认为它在 http 下，即使它不是。

看到我总是知道 main2 始终是处理所有 https 请求的那个，控制器有没有办法确定它在哪个服务器名称下运行或它是什么 id？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T16:28:29.707

我只是通过更改工作流程来解决这个问题，而不必根据它所处的协议做出不同的反应。看起来没有办法将唯一的任意标识符传递给它可以读取的每个单独的进程。

# asp.net - ASP.NET Web API 发布后 ASP.NET MVC 框架的未来是什么

> ID：11621550
> 
> 赞同：6
> 
> 时间：2012-07-23T22:39:10.557
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api

我已经使用 asp.net MVC 大约 1.5 年了，很享受它的功能，并且已经部署了许多成功的 Web 应用程序，但我目前正在阅读有关 asp.net Web API 技术的信息。而且，我发现以下内容：

1.  我可以实现以前使用 MVC 实现的任何功能；使用新的 Web API 并采用更轻量级的方法。

2.  与 asp.net MVC 相比，使用 Web API 开发 Web 服务更容易。

那么，asp.net Web API 会在未来接管 asp.net MVC，还是每种技术都有自己的发展领域，或者我们应该考虑在同一个 Web 应用程序中同时使用它们？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-23T23:54:29.100

除了@jmoerdyk 的回答，我想指出一点：

关键是要了解每种技术的目标：

*   ### 网络 API。

    这将是用于创建 Web 服务的新 API，它是传统 XML 服务和 WCF 服务的替代方案，因此值得首先指出 WEB API 与其他 Web 服务框架之间的主要区别。

    Web API 和 WCF/ASMX 服务之间的主要区别在于**它不是基于 SOAP 它基于 HTTP**因此您可以利用所有 HTTP 功能，例如：

    *   它包含非常有意义和描述性的消息标头 - 标头建议消息正文的内容类型，标头解释如何缓存信息，如何保护信息等。
    *   使用动词来定义动作（POST、PUT、DELETE..）
    *   它包含一个可用于发送任何类型内容的正文
    *   它使用 URI 来标识信息路径（资源）和操作

    > 这就是 Web API（当时称为 WCF Web API）的主要目标：停止通过 WCF 的眼光看待 HTTP - 作为传递请求的传输协议。相反，它允许我们将其视为真正的应用程序级协议——一个丰富的、可互操作的、面向资源的协议。Web API 的目的是正确使用 URI、HTTP 标头和正文为 Web 以及希望将 HTTP 作为其协议和终生朋友的其他所有人创建 HTTP 服务。

    查看这篇文章了解更多信息： http: [//www.codeproject.com/Articles/341414/WCF-or-ASP-NET-Web-APIs-My-two-cents-on-the-subjec](http://www.codeproject.com/Articles/341414/WCF-or-ASP-NET-Web-APIs-My-two-cents-on-the-subjec)

    所以基本上 Web API 实际上可以与 WCF 或 XML 服务进行比较

    如果您想知道 WCF 会发生什么？

    > 所以事实是我们有太多的选择，因此也有太多的困惑。我们该怎么办？我们合并团队！（有点让我们想起了 LINQ-to-SQL 和实体框架、WCF 和 Ado.Net 数据服务以及其他此类示例的时代）。因此，WCF 团队和 ASP.NET 团队联手创建了一个专注于 Web 世界的 REST/超媒体/HTTP 服务领域的新框架，从而产生了 ASP.NET Web API。

*   ### MVC

    既然您知道 Web API 的目标是什么，那么应该更容易*说明*为什么 MVC 包含主要呈现视图的附加功能。

    你的担心是基于 WEB API**实际上是基于 MVC 的**，但是他们的目标是不同的

    > 另一方面，ASP.NET MVC 基础架构及其对 HTTP 请求和响应的优雅处理，以及对易于创建的控制器的支持似乎是创建这种新型服务的正确方法

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-23T22:57:31.883

不，他们并没有真正做同样的事情。

Web API 实际上仅用于生成 JSON、XML 或其他基于文本的响应，以实现基于 REST 的 API。MVC 也可以做到这一点，但新的 Web API 似乎使它更容易，尤其是自动内容类型协商。

MVC 所做的 Web API 不打算用于生成带有视图等的完整或部分 HTML 页面。

所以每个人在 ASP.Net 框架中都有自己的目的，不太可能超越另一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-23T23:59:55.727

WebAPI 和 MVC 是两个不同的东西，但它们都在同一个框架中工作。WebAPI 用于 RESTful 服务。MVC 用于网页。

您可以在 MVC 中创建 restful 服务，这比在 WebAPI 中做的工作要多得多。反过来是不正确的。您不能在 WebAPI 中创建网页。因此，您的问题从根本上是混乱的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-20T05:16:04.240

它们将被合并到新版本中，从技术上讲，两者的工作方式相似，但 API 没有附加视图，因此提供了更好的性能

# ios - 如何使用 GCDAsyncUdpSocket 通过 wifi 和蓝牙进行多播

> ID：11621553
> 
> 赞同：2
> 
> 时间：2012-07-23T22:39:15.093
> 
> 标签：ios, bluetooth, udp, multicast, gcdasyncsocket

我目前正在使用 GCDAsyncUdpSocket 在 iOS 设备之间通过 wifi 发送多播数据报。

代码很简单..

客户

```
self.socket = [[GCDAsyncUdpSocket alloc] initWithDelegate:self  delegateQueue:dispatch_get_main_queue()];

//omitted error checking
[self.socket bindToPort:12345 error:&err];
[self.socket joinMulticastGroup:@"224.0.1.1" error:&err];
[self.socket beginReceiving:&err]; 
```

服务器

```
self.multicastSocket = [[GCDAsyncUdpSocket alloc] initWithDelegate:self delegateQueue:dispatch_get_main_queue()];

NSData *d = [@"hello" dataUsingEncoding:NSUTF8StringEncoding];

[self.multicastSocket sendData:d toHost:@"224.0.1.1" port:12345 withTimeout:-1 tag:11]; 
```

这在 wifi 上运行良好。我如何使它也可以通过蓝牙工作？我用谷歌搜索了一堆，找不到任何东西......我需要创建两个单独的套接字吗？一个绑定wifi接口，一个绑定蓝牙接口？

编辑：或者我对一些基本的东西感到困惑？这一定是可能的。GameKit 的 GKSession 正是这样做的，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T19:48:54.433

我认为您缺少启用 BT over ip 协议的 BT 堆栈访问。此外，多播依赖网络设备（路由器）来管理这些组和注册。BT 需要 ZeroConf 网络的概念（也可以用于 wifi），但以点对点的方式进行管理。查看 Bonjour 或 Dnssd 以获得比 GameKit 更接近套接字级别的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T11:12:42.413

你很亲密。[您可以在此 StackOverflow 问题](https://stackoverflow.com/questions/3844189/bonjour-over-bluetooth-without-gamekit/8273661)中找到指向有用信息的指针，也可以使用包含此功能的库（例如[HHServices） 。](https://github.com/tolo/HHServices)

老实说，我尝试过这条路线，但运气不佳，但我希望这能为您指明正确的方向。[让我知道你是否知道了！](https://stackoverflow.com/questions/14477813/usage-example-to-connect-two-ios-devices-over-bluetooth-client-server-code)

# iphone - 2012 年秋季我应该瞄准哪个 iOS 版本

> ID：11621558
> 
> 赞同：4
> 
> 时间：2012-07-23T22:39:52.867
> 
> 标签：iphone, ios, xcode

嗨，我刚刚开始开发一个 iPhone 应用程序，我计划在 8 月的最后一周提交到应用程序商店。现在我正在使用 iOS 4.1，但我正在考虑使用 iOS 5，因为它支持 JSON，我该怎么办？使用 iOS 5 或 4，我的应用程序基本上是一个图片游戏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:45:05.747

现在大多数人都在使用 iOS 5。是否支持 iOS 4 仍然是您的决定（显然，这样做会使您的应用程序可供更大比例的人使用；您必须决定是否值得失去 iOS 5 的特定功能）。

如果 JSON 是唯一的决定因素，那么有很多与 iOS 4 兼容的 JSON 库，例如[SBJson](http://stig.github.com/json-framework/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T00:36:15.837

今年早些时候，当我做出类似决定时，我使用了[macrumors.com 3 月份](http://www.macrumors.com/2012/03/23/developer-sees-quick-adoption-of-ios-5-1-amongst-users/)的数据来帮助我确定我的用户可能来自哪里。

该链接上的图表显示 iOS 4 用户的份额相当稳定且缓慢下降。那也是4个月大。

还要认识到，如果你在卖应用程序，那些坚持使用 iOS 4 的人很可能是像我父母这样的人，他们有一台 iPad，从未升级过，不买应用程序，或者太穷，买不起升级到 iPad。更高档的手机，因此可能也很便宜。

无论如何，基于该站点的统计数据的粗略经验法则……此时您可能会放弃 1/6 到 1/10 之间的市场，而这部分将是最难的部分市场出售给。

你需要根据你需要付出多少努力来实现向后兼容，以及是否值得，来决定你需要多大的积极性，针对 iOS 4 用户可以获得多少回报。对我来说，我构建了一个能够在 iOS 4.2 上运行的新应用程序，但另一个似乎工作量太大，所以我坚持使用 iOS 5。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-23T22:51:05.927

如果没有什么能阻止您以 iOS 4 为目标，那就去做吧。与仅针对 iOS 5 相比，您将拥有更多的潜在客户。

尽管大多数人已经升级到 iOS 5，但仍然有相当数量的人在使用 iOS 4。

有关详细信息，请参阅[这些统计](http://david-smith.org/iosversionstats/)信息。该链接说它们每周更新一次。

此外，请确保始终使用最新的 SDK（如果需要，也可以使用 beta SDK）。您可以使用最新的 SDK 定位较旧的 iOS 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T22:46:50.750

编辑：您将 xcode 版本控制与 ios 版本混淆了。您可能应该升级到最新的 xcode。4.3.2 我相信吗？但这与 ios 4、5、6 不同。

我的原始答案中有哪些要针对的目标。

这是一种意见/您希望您的应用程序可访问性的问题。您支持的 ios 版本越低，能够访问您的应用程序的人就越多。话虽这么说，虽然我最近没有跨设备的用户细分，但即使是 iphone 3G 也可以安装 iOS 5，所以你应该很安全地使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T22:44:59.007

始终使用最新的 SDK。如果您拥有开发者计划会员资格，则可以使用预发布版本，但这会受到错误和其他您不想在发布应用程序中处理的问题的影响。所以我的建议是使用应用商店中的当前版本的 Xcode，并且可能使用预发布版本来熟悉即将到来的 iOS 6 更改和功能，但不适用于您的主要开发工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-23T23:21:14.170

对于新应用，我至少会使用 iOS 5。但是，如果您已经基本完成了针对 iOS 4.1 的开发，那么我不确定是否值得升级。无论您面向哪个 iOS 版本，您都应该始终使用最新版本的 Xcode，因为这将为您提供更好的优化、更准确的警告和更强大的静态分析器。

# ajax - 所见即所得的 AJAX 开发工具？

> ID：11621562
> 
> 赞同：0
> 
> 时间：2012-07-23T22:40:09.917
> 
> 标签：ajax, wysiwyg, devtools

我正在与一位经验丰富的系统程序员合作，但这是第一次进行网络编程。有什么好的工具可以促进诸如单击以对表中的列进行排序、拖放字段以重新排列表中的有序值以及其他 AJAX 功能等功能？我自己是过去的 Domino 开发人员，似乎 Domino 中的表单创建过程的一些开源等效项对他最有用。

有什么想法吗？我在正确的树上吠叫吗？树枝上有什么有用的产品吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:49:42.467

看看 Ebase Xi - 最新版本 V4.4 内置了基于 AJAX 的屏幕渲染。顺便说一句，Xi 是用于 wbe 开发的完整 RAD 平台。

# jsf - 富：编辑器标签在使用 RichFaces 4.2.0 嵌套在 JSF 中的 Rich:popupPanel 中时不起作用

> ID：11621565
> 
> 赞同：6
> 
> 时间：2012-07-23T22:40:12.970
> 
> 标签：jsf, richfaces

我正在尝试在rich:popupPanel 中使用rich:editor 来更新数据表中的博客文章。我正在使用 RichFaces 4.2.0。如果我将那个编辑器标签放在 popupPanel 之外，它就可以正常工作，只有当它在里面时。有人遇到过这个问题吗？

我的代码是这样的：

```
<h:form id="form">

        <rich:dataTable value="#{managePosts.allBlogPosts}" var="post" id="manage_posts_data_table" 
                        styleClass="manage_posts_table" rows="15">
            <f:facet name="noData">                 
               Nothing found
            </f:facet>
           ...
            <rich:column width="70px">
                <h:link outcome="userViewPost.jsf">
                    <f:param name="post_id" value="#{post.id}" />
                    <h:graphicImage library="images" name="posts/manage/view.png" />
                </h:link>                   
                <a4j:commandLink render="editGrid" execute="@this"
                    oncomplete="#{rich:component('editPane')}.show()">
                    <h:graphicImage library="images" name="posts/manage/update.png" />
                    <f:setPropertyActionListener target="#{managePosts.editedPost}" value="#{post}" />
                </a4j:commandLink>

            </rich:column>       
        </rich:dataTable>

        <rich:popupPanel header="#{msg.edit_selected_post}" id="editPane" width="685" height="600" modal="true">                    

                <h:outputLabel value="#{msg.title}: " styleClass="form_labels" />
                <h:inputText id="update_post_title" value="#{managePosts.editedPost.title}" required="true"
                    requiredMessage="#{msg.empty_field_err}" size="103">
                    <f:validateLength minimum="6" maximum="128"/>
                </h:inputText>

                <h:outputLabel value="" />
                <rich:message for="update_post_title" />
                <h:outputLabel value="" />

                <h:outputLabel value="#{msg.content}: " styleClass="form_labels" />
                <rich:editor id="editor" toolbar="custom" skin="kama" required="true" requiredMessage="#{msg.empty_field_err}"
                        value="#{managePosts.editedPost.content}" width="530" height="300">
                    <f:facet name="config">
                    toolbar_custom:
                        [
                            { name: 'document', items : [ 'NewPage','Preview' ] },
                            { name: 'clip#{managePosts.editedPost.title}board', items : [ 'Cut','Copy','Paste','PasteText','PasteFromWord','-','Undo','Redo' ] },
                            { name: 'editing', items : [ 'Find','Replace','-','SelectAll','-','Scayt' ] },
                            { name: 'insert', items : [ 'Image','Flash','Table','HorizontalRule','Smiley','SpecialChar','PageBreak','Iframe' ] }, '/',
                            { name: 'styles', items : [ 'Styles','Format' ] },
                            { name: 'basicstyles', items : [ 'Bold','Italic','Strike','-','RemoveFormat' ] },
                            { name: 'paragraph', items : [ 'NumberedList','BulletedList','-','Outdent','Indent','-','Blockquote' ] },
                            { name: 'links', items : [ 'Link','Unlink','Anchor' ] },
                            { name: 'tools', items : [ 'Maximize','-','About' ] }
                        ]
                    </f:facet>
                </rich:editor>

                <h:outputLabel value="" />
                <rich:message for="editor" />
                <h:outputLabel value="" />

            <a4j:commandButton value="Cancel" onclick="#{rich:component('editPane')}.hide(); return false;" />
        </rich:popupPanel>

    </h:form> 
```

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T12:29:25.790

这个Bug是众所周知的。

编辑器不在表单标签中。

[![问题](../Images/b8ef0fd4d972022c36be63ed50930046.png)](https://i.stack.imgur.com/wu490.png)
[（来源：[jboss.org](https://issues.jboss.org/secure/attachment/12347730/metamer-faces-components-richPopupPanel-formInsidePanel.png)）]

# wordpress - wordpress 模板页面不起作用

> ID：11621570
> 
> 赞同：0
> 
> 时间：2012-07-23T22:40:41.067
> 
> 标签：wordpress, templates

我正在尝试创建自己的主题，称为“音乐学院”。为此，我首先在 style.css 中添加了这些信息：

```
/*
Theme Name: Conservatoire
Theme URI: http://wordpress.org/
Description: Conservatoire
Author: Thoma Biguères
Version: 1.0
Tags: black, blue, white, two-columns, fixed-width, custom-header, custom-background,     threaded-comments, sticky-post, translation-ready, microformats, rtl-language-support, editor-style, custom-menu (optional)

License:
License URI:

General comments (optional).
*/ 
```

所以我认为这里没什么太棘手的。之后我添加了两个文件。一个 index.php ：

```
<?php
/**
* The main template file.
*
* @package WordPress
* @subpackage Conservatoire
*/

get_header(); ?>

<!-- Add your site or application content here -->    

<!-- JavaScript at the bottom for fast page loading: http://developer.yahoo.com/performance/rules.html#js_bottom -->

<!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.7.2.min.js"><\/script>')</script>

<!-- scripts concatenated and minified via build script -->
<script src="js/plugins.js"></script>
<script src="js/main.js"></script>
<!-- end scripts -->

<!-- Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID.
     mathiasbynens.be/notes/async-analytics-snippet -->
<script>
    var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
</body>
</html> 
```

直到这里一切正常。之后，我添加了一个 front-page.php，这是我的静态主页：

```
<?php
/**
* The template for displaying Front page.
*
* @package WordPress
* @subpackage Conservatoire
*/

get_header(); ?>

<?php
$page = get_page_by_title('Accueil');
?> 
```

一切都还好。现在事情很棘手。我正在尝试添加一个 category-{slug}.php 页面。所以我创建了一个对我来说很好的页面 category-membre.php ：

```
<?php
/**
* T he template for displaying Front page.
*
* @package WordPress
* @subpackage Conservatoire
*/

get_header(); ?>

<ul>
<?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>
<li class="cadre">
    <div class="imageCadre">
        <?php echo(get_image());?>
    </div>
    <h4><?php echo(get_the_title());?></h4>
    <p><?php echo(get('information_globales_petite_description'));?></p>
    <a href="" class="plusinfo">Lire la suite</a>

</li>
<?php endwhile; ?>
<!-- post navigation -->
<?php else: ?>
<!-- no posts found -->
<?php endif; ?>

</ul>
</body>
</html>
?> 
```

但是当我尝试进入“localhost/Site/category/membre”页面时，我发现自己在 404 页面上......

有人知道吗？

谢谢

编辑：我没有更改永久链接，因此类别库为空（我猜它是类别，不是吗？）

这是我的httaccess，但我删除了它，它仍然给我同样的错误：

新编辑：这是实际的 .htaccess

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /Sites/Association%20CNMP/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /Sites/Association%20CNMP/index.php [L]
</IfModule>

# END WordPress 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T20:48:36.573

嘿，谢谢你的一切，

我设法使永久链接起作用。我真的不知道你是怎么想的。我知道我必须将 apache 的 httdconfig 的 mod_rewrite 设置为 Ok（在 Launch mod_rewrite 之前擦除 #）。然后做一些事情。不过有一件事我不明白！

为什么我的实际 htaccess 看起来像这样：

```
# BEGIN WordPress
 <IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /Sites/AssociationCNMP/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /Sites/AssociationCNMP/index.php [L]
</IfModule>

# END WordPress 
```

但实际上是在使用 cat/membre 吗？我在 htaccess 文件中没有看到猫。那么他怎么知道他必须去另一个呢？

谢谢你的帮助

# python - 比较 2 个文件并根据条件打印

> ID：11621573
> 
> 赞同：0
> 
> 时间：2012-07-23T22:41:06.933
> 
> 标签：python, perl, awk

如果一直有人问这种问题，我很抱歉，但我在搜索时找不到。

我有两个文件 A 和 B。我需要创建一个文件 C，其中包含如下所示格式的差异：

档案一：

```
foo1   2.1  3
foo2   3.1  3
foo3   4.1  3
foo4   2.1  3
foo5   3.1  3 
```

文件 B：

```
foo1   2.0  2.9
foo2   2.1  3
foo4   2.1  3 
```

文件 C（输出）：LHS 包含来自文件 A 的值。RHS 包含来自文件 B 的值（或者如果 foo 不存在，则只是 xxxx 的值）

```
2.1  3  foo1   2.0  2.9
3.1  3  foo2   2.1  3
4.1  3  foo3   xxxxxxxx
2.1  3  foo4   2.1  3
3.1  3  foo5   xxxxxxxx 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:37:13.220

通读这两个文件并将数据存储在由文件的第一个 fcolumn 值作为键的散列中。

```
use strict;
use warnings;

my @files = qw/ FileA.txt  FileB.txt /;
my %data;

for my $i (0, 1) {

  open my $fh, '<', $files[$i] or die qq(Unable to open "$files[$i]": $!);

  while (<$fh>) {
    s/\s+$//;
    my ($key, $val) = split ' ', $_, 2;
    $data{$key}[$i] = $val;
  }
}

for my $key (sort keys %data) {
  printf "%s  %s   %s\n",
      map $_ // 'xxxxxxxx', $data{$key}[0], $key, $data{$key}[1];
} 
```

**输出**

```
2.1  3  foo1   2.0  2.9
3.1  3  foo2   2.1  3
4.1  3  foo3   xxxxxxxx
2.1  3  foo4   2.1  3
3.1  3  foo5   xxxxxxxx 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:10:21.477

一种使用方式`awk`。**将fileB**的第一个字段保存为哈希的键，将其余字段保存为其值，如果键存在，则比较**fileA**中的每一行，并打印`xxxxxxxx`或哈希的值。

运行下一个命令：

```
awk '
    BEGIN {
        OFS = "\t";
    }

    FNR == NR {
        b[ $1 ] = $2 "\t" $3;
        next;
    }

    FNR < NR {
        str = ($1 in b) ? b[ $1 ] : "xxxxxxxx";
        print $2, $3, $1, str;
    }
' fileB fileA 
```

具有以下输出（制表符分隔的字段）：

```
2.1     3       foo1    2.0     2.9
3.1     3       foo2    2.1     3
4.1     3       foo3    xxxxxxxx
2.1     3       foo4    2.1     3
3.1     3       foo5    xxxxxxxx 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T23:10:54.870

一种使用方式`awk`：

```
awk 'FNR==NR { array[$1]=$0; next; } { if ($1 in array) print $2, $3, array[$1]; else print $2, $3, $1, "xxxxxxxx"; }' fileB.txt fileA.txt 
```

分成多行：

```
FNR==NR {
    array[$1]=$0
    next
}

{
    if ($1 in array) {
        print $2, $3, array[$1]
    }
    else {
        print $2, $3, $1, "xxxxxxxx"
    }
} 
```

结果：

```
2.1 3 foo1   2.0  2.9
3.1 3 foo2   2.1  3
4.1 3 foo3 xxxxxxxx
2.1 3 foo4   2.1  3
3.1 3 foo5 xxxxxxxx 
```

# neo4j - 在 neo4j / gremlin 中可以进行此查询吗？

> ID：11621574
> 
> 赞同：2
> 
> 时间：2012-07-23T22:41:14.287
> 
> 标签：neo4j, graph-databases, gremlin

如果我有一个看起来像这样的图表：

```
N3->member_of->N1
N2->knows->N1
N3->likes->N2
N4->member_of->N1
N5->likes->N2 
```

有没有一种方法可以执行以下操作：

1.  如果从 N3 开始将返回 N2
2.  在 N4 开始的相同查询将返回 N2
3.  在 N5 开始的相同查询将返回 N2

（最好在 gremlin 中）

编辑：澄清：只要一级关系是“member_of”，我最多可以进行二级连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-12T09:40:56.960

很老的问题，但由于没有人想出 Gremlin 解决方案，这里是：

我拿了 Bobbys 的初始化脚本：

```
g = new TinkerGraph()
(1..5).each { g.addVertex(it) }
g.addEdge(g.v(3), g.v(1), "member_of") 
g.addEdge(g.v(2), g.v(1), "knows")
g.addEdge(g.v(3), g.v(2), "likes")
g.addEdge(g.v(5), g.v(2), "likes") 
g.addEdge(g.v(4), g.v(1), "member_of") 
```

这是您的 Gremlin 查询：

```
gremlin> g.v(3).copySplit(_().out('likes'), _().out('member_of').loop('start'){true}{true}.in('knows')).exhaustMerge().dedup()
==>v[2]
gremlin> g.v(4).copySplit(_().out('likes'), _().out('member_of').loop('start'){true}{true}.in('knows')).exhaustMerge().dedup()
==>v[2]
gremlin> g.v(5).copySplit(_().out('likes'), _().out('member_of').loop('start'){true}{true}.in('knows')).exhaustMerge().dedup()
==>v[2] 
```

干杯，丹尼尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:00:20.703

您是否想要返回一个节点（人？）的所有传入和传出关系，以及*一个*人所属的任何组的所有相关节点？那么“团体”通过“成员”来交换他们的关系？

如果是这样，并且假设不允许使用递归组，我提出了一个替代图表，可以更清楚地说明您的用例（据我所知）-> [http://console.neo4j.org/?id= wyr207](http://console.neo4j.org/?id=wyr207)

如果你跑

```
start n=node(5) match n-[?:knows|likes]-related, n-[?:member_of]->group-[:knows|likes]-other_related return related, other_related 
```

在图上，`related`将返回所有直接相关的节点，以及`other_related`从组返回的所有其他节点（如果该节点是组的成员）。将这些结合起来超出了我的 Cypher 能力，但它们将被重复删除 AFAIK（其中不`related`包含任何节点`other_related`）。

尝试在控制台链接中使用几个不同的节点 ID（N5 的节点 ID 为 1）进行查询，看看这是否是您的想法。添加关系方向等会很简单。

将其翻译为 Gremlin*有点*乏味（Cypher 中的模式匹配更自然），但如果方向正确，我会做 LMK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T07:50:19.307

不确定您的设置是否正确，尝试在这里进行：http: [//tinyurl.com/d2mjkj2](http://tinyurl.com/d2mjkj2) - 设置正确吗？

如果需要第一个关系类型，`member_of`则 N5 不应返回 N2。否则，您可以执行类似的操作

```
start s=node(3,4,5) match s-[r1:member_of]->()<-[r2*0..1]-end return s,end 
```

返回以`member_of`关系开头的模式，然后具有 0 或 1 个任何类型的关系。如果需要，请收紧，有关详细信息，请参阅[http://docs.neo4j.org/chunked/snapshot/query-match.html#match-variable-length-relationships](http://docs.neo4j.org/chunked/snapshot/query-match.html#match-variable-length-relationships)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T09:01:25.697

这就是它在密码中的样子：

```
1: start n=node(3) match n-[:LIKES]->m return m;
2: start n=node(4) match n-[:MEMBER_OF]-m-[]-k return k;  (will return n2,n3\. if you want n2 only match n-[:MEMBER_OF]-m-[:KNOWS]-k )
3: the same as 1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-25T21:01:15.843

首先使用[TinkerGraph在](http://github.com/tinkerpop/blueprints/wiki/TinkerGraph)[Gremlin Groovy shell](http://github.com/tinkerpop/gremlin/wiki/Getting-Started)中创建图形：

```
g = new TinkerGraph()
(1..5).each { g.addVertex(it) }
g.addEdge(g.v(3), g.v(1), "member_of") 
g.addEdge(g.v(2), g.v(1), "knows")
g.addEdge(g.v(3), g.v(2), "likes")
g.addEdge(g.v(5), g.v(2), "likes") 
g.addEdge(g.v(4), g.v(1), "member_of") 
```

听起来您想要一个从顶点 3、4 或 5 开始并返回顶点 2 的查询。下面的查询使用该算法：

*   获取顶点'x'
*   获取传入和传出的相邻顶点
*   再次循环，直到我们循环 3 次或找到一个 id 为“2”的顶点
*   通过获取管道的 next() 成员重复数据删除结果

```
gremlin> g.v(3).both.loop(1) {it.loops < 3}{it.object.id == "2"}.next()
==>v[2]
gremlin> g.v(4).both.loop(1) {it.loops < 3}{it.object.id == "2"}.next()
==>v[2]
gremlin> g.v(5).both.loop(1) {it.loops < 3}{it.object.id == "2"}.next()
==>v[2] 
```

您可能还会发现有关[路径模式](http://github.com/tinkerpop/gremlin/wiki/Path-Pattern)的 Gremlin 文档很有用。

# scheme - 列出方案中的差异。

> ID：11621576
> 
> 赞同：0
> 
> 时间：2012-07-23T22:41:51.053
> 
> 标签：scheme

谁能帮助我返回两个不同列表中的差异的代码，即 A 中的集合而不是 B 中的集合，例如 (set-difference '(1 2 4 5 6) '(4 5 6 2 8) 是 1 . 这是课堂上的实验室评估，我想知道它会完成。我知道它涉及线性时间方面，但我真的不知道如何在方案中实施。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:08:14.860

尝试这个：

```
(define (set-difference s1 s2)
  (cond ((null? s1)
         '())
        ((not (member (car s1) s2))
         (cons (car s1) (set-difference (cdr s1) s2)))
        (else
         (set-difference (cdr s1) s2)))) 
```

# wcf - 无法在 WCF 端点中获取元数据错误

> ID：11621577
> 
> 赞同：0
> 
> 时间：2012-07-23T22:42:01.830
> 
> 标签：wcf, wcf-data-services

我正在 VS 2012 中为 WCF 进行测试。它具有自定义 Http 绑定，并在端点中使用。但是它给出了一个错误，它在测试时找不到元数据`wcfclient.exe`

以下是我在`web.config`文件中制作的自定义代码。

```
<bindings>
      <basicHttpBinding>
        <binding name="MaxHttp" allowCookies="true"
                 maxReceivedMessageSize="20000000"
                 maxBufferSize="20000000" 
                 maxBufferPoolSize="20000000">
          <readerQuotas maxDepth="32"
               maxArrayLength="200000000"
               maxStringContentLength="200000000"/>

        </binding>
      </basicHttpBinding>
      <!---->
    </bindings>
    <services>
      <service name="AdventureW.Service.Database.AwService">
        <endpoint address="http://localhost:49551" binding="basicHttpBinding" bindingConfiguration="MaxHttp" contract="AdventureW.Service.Database.IWsService"/>
      </service>
    </services> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:10:33.817

将 MEX（元数据交换）端点添加到您的服务，添加允许 Http 获取的行为，并更新您的服务以使用该行为：

```
 <system.serviceModel>
    <bindings> 
      ... 
    </bindings> 

    <services>    
      <service name="AdventureW.Service.Database.AwService" behaviorConfiguration="ServiceBehavior">    
        <endpoint address="http://localhost:49551" binding="basicHttpBinding" bindingConfiguration="MaxHttp" contract="AdventureW.Service.Database.IWsService"/>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>    
    </services>  

    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehavior">
          <serviceMetadata httpGetEnabled="True" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

# c# - 创建数据库 - 如何找到默认数据目录？

> ID：11621578
> 
> 赞同：5
> 
> 时间：2012-07-23T22:42:05.963
> 
> 标签：c#, sql-server, create-table

我希望能够使用我在[这里](http://support.microsoft.com/kb/307283)找到的代码在我的 C# WinForm 应用程序中创建一个数据库。

但我需要找到一种方法来获取该特定 SQL Server 实例的默认数据目录。我想知道是否有一种简单的方法可以在各种版本的 SQL Server 上使用。

提前致谢。

* * *

## 编辑

我发现以下 Select 将返回远程服务器上的默认数据目录：

```
SELECT 
    SUBSTRING(physical_name, 1, CHARINDEX(N'master.mdf', LOWER(physical_name)) - 1)
FROM master.sys.master_files 
WHERE database_id = 1 
    AND file_id = 1 
```

此解决方案仅适用于 SQL Server 2005+。

**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-16T08:59:07.700

[这](https://stackoverflow.com/questions/1883071/how-do-i-find-the-data-directory-for-a-sql-server-instance/12756990#12756990)是 Alex Aza 提出的更好的解决方案。
解决方案是：

```
using (var connection = new SqlConnection("Data Source=.;Integrated Security=SSPI"))
{
    var serverConnection = new ServerConnection(connection);
    var server = new Server(serverConnection);
    var defaultDataPath = string.IsNullOrEmpty(server.Settings.DefaultFile) ? server.MasterDBPath : server.Settings.DefaultFile;
    var defaultLogPath = string.IsNullOrEmpty(server.Settings.DefaultLog) ? server.MasterDBLogPath : server.Settings.DefaultLog;
} 
```

它需要引用 Microsoft.SqlServer.Smo.dll 和 Microsoft.SqlServer.ConnectionInfo.dll。可以在文件夹 C:\Program Files\Microsoft SQL Server\110\SDK\Assemblies 中找到这些 dll。它们随 SQL 安装一起分发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T12:59:51.593

这适用于 SQL 2000+

```
SELECT SUBSTRING(filename, 1, CHARINDEX(N'master.mdf', LOWER(filename)) - 1)
FROM master.dbo.sysdatabases
WHERE name = 'master' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-16T09:14:07.063

也许这会帮助你：

```
DECLARE @regvalue varchar(100)

EXEC master.dbo.xp_regread @rootkey='HKEY_LOCAL_MACHINE',
        @key='SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL11.MSSQLServer\Setup',
        @value_name='SQLDataRoot',
        @value=@regvalue OUTPUT,
        @output = 'no_output'

SELECT @regvalue as DataAndLogFilePath 
```

此存储过程需要一个参数，其中声明 SQL 版本，即。`...\MSSQL.11.MSSQLSERVER\...`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T13:14:23.807

您可以在服务器属性 - 数据库设置 - 数据库默认位置找到它。如果需要，您可以使用 SQL Server Profiler 找出 sql 查询（这取决于服务器版本）。

# matlab - 重新排列相关数据的递归

> ID：11621579
> 
> 赞同：1
> 
> 时间：2012-07-23T22:42:15.623
> 
> 标签：matlab, recursion

我有一个结构，结果如下：

> ```
> result.me={dad,grandpa,half_sis}
> result.step_mom={half_sis}
> result.dad={me,grandpa,half_sis}
> result.half_sis={mom,me,dad,grandpa}
> result.grandpa={me,dad,half_sis} 
> ```

结果是一个单元格数组的结构，并显示每个元素的亲属（按血统）。我编写了以下函数，它采用相应的 class_name（me、mom 等）及其相应的单元格并返回所有亲属。例如， recur_getchildren(mom,{grandpa,me,sis},result) 应该返回 mom 的所有血缘亲属以及所有这些亲属的亲属（依此类推，直到没有人离开）：

> ans=half_sis，我，爸爸，爷爷，

所以即使妈妈和我、爸爸或爷爷没有血缘关系，他们仍然会被列出来。上面的例子是一个简化，对于我的问题，将会有更多的世代需要跟踪。我尝试执行以下操作，但它并不完全有效。我究竟做错了什么？有没有更简单的方法来做到这一点？

```
 function tot=recur_getchildren(class_name,each_cell,result)
%gets all the children for an element and all its descendants
global gresult

if(~isfield(gresult,class_name))

    gresult.(class_name)=1;

    w=size(each_cell,2);
    tot=struct(char(class_name),1); %include the class_name item as well
    %tot is a struct where all the keys indicate the progeny, and val is 0/1

    for m=1:w

        %the child must not have already been searched previously
        if(~isfield(gresult,each_cell{m}))

            gresult.(char(each_cell{m}))=1;
            tot.(char(each_cell{m}))=1;
            % copy all contents over to parent
            if(sum(~strcmp(each_cell,'')) && sum(isfield(result,char(each_cell{m}))))
                s=size(result.(char(each_cell{m})),2);
                %run iteratively over all the children of each member of
                %each_cell
                for j=1:s

                    %struct of all childs
                    %gresult.(each_cell{m})=1;
                    if(~isfield(gresult,char(result.(char(each_cell{m})){j})))
                        tot.(char(result.(char(each_cell{m})){j}))=1;
                        % tot_records.(char(result.(char(each_cell{m})){j}))=1

                        tot2=recur_getchildren(each_cell{m},result.(char(each_cell{m}))(j),result);

                        %check off this so that we dont search it again
                        gresult.(char(result.(char(each_cell{m})){j}))=1;
                          %keep looping to get all children

                        %loop through result struct
                        if(size(tot2,2)~=0)
                            fn=fieldnames(tot2);
                            for p=1:size(fn)
                                str=fn(p);
                                recur_getchildren(char(str),result.(char(str)),result)
                                gresult.(char(str))=1;
                            end
                        end
                    end

                end
            end

        end
    end
else
    tot=[];
end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:51:05.713

我认为这可以使用一些字符串评估和[设置操作](http://www.mathworks.com/help/techdoc/ref/f16-42340.html#f16-7121)来完成。

如果我们有

```
result = 

      me: {'dad'  'grandpa'  'half_sis'}
      step_mom: {'half_sis'}
     dad: {'me'  'grandpa'  'half_sis'}
half_sis: {'mom'  'me'  'dad'  'grandpa'}
 grandpa: {'me'  'dad'  'half_sis'} 
```

我们可以选择一个人并找到那个人的亲戚。

```
s = result.step_mom

s = 

    'half_sis' 
```

使用一些字符串操作，我们可以找到亲属的亲属，如下所示：

```
eval(char(strcat('result.',s)))

ans = 

    'mom'    'me'    'dad'    'grandpa' 
```

这给了我们一个函数的想法：

```
function children=recur_getchildren(result,person)

%Find all relatives of given person
s = eval(strcat('result.',person));

%Go through all relatives found in s
for i=1:size(s,2)
    children = union(s(i),eval(char(strcat('result.',s(i)))));
end

%remove orignal relative from other relatives
children=setdiff(children,person); 
```

让我们测试一下：

```
relatives=recur_getchildren(result,'mom')

relatives = 

    'dad'    'grandpa'    'half_sis'    'me' 
```

请注意，您需要将 step_mom 更改为 mom（反之亦然）才能在所有情况下工作。

编辑：让它递归。像这样的东西：

```
function [All_relatives,not_examined]=...
recur_getchildren(result,person,examined,All_relatives)

%Find all relatives of given person
s = eval(strcat('result.',person));

children = '';

%Go through all relatives found in s
for i=1:size(s,2)
    children = union(children,eval(char(strcat('result.',s(i)))));
end

%Save all found relatives
All_relatives = union(All_relatives,children);
All_relatives = union(All_relatives,s);

%Save all examined persons
examined = union(examined,s);
examined = union(examined,person);
not_examined = setdiff(All_relatives,examined);

count=0;
while length(not_examined)>0
    count=count+1;
    examined = union(examined,not_examined(count ));
    [new_relatives,not_examined] = recur_getchildren(result,char(not_examined(count)),examined,All_relatives);
    All_relatives = union(All_relatives,new_relatives);

end 
```

这很快就放在一起，但应该可以工作。*运行时将检查*和 * All_relatives * 输入作为空字符串。

```
children=recur_getchildren(result,'me','','') 
```

# asp.net - NHibernate 和 Sharp 架构 - 更改 NHibernate.config 后未刷新数据库连接

> ID：11621581
> 
> 赞同：0
> 
> 时间：2012-07-23T22:42:32.437
> 
> 标签：asp.net, web-services, nhibernate, sharp-architecture

我有一个在 ASP.NET 中实现的 Web 服务。

我在 Global.asax 事件处理程序中实例化我的 NHibernate 会话，如下所示：

```
 protected void Application_BeginRequest(object sender, EventArgs e)
    {
        NHibernateInitializer.Instance().InitializeNHibernateOnce(
        () => InitializeNHibernateSession());
    }

    private void InitializeNHibernateSession()
    {
        NHibernateSession.Init(
            webSessionStorage,
            new string[] { Server.MapPath("~/bin/DAL.Server.Data.dll") },
            new AutoPersistenceModelGenerator().Generate(),
            Server.MapPath("~/NHibernate.config"));
    } 
```

我的问题是，每当我需要更新 NHibernate.config 连接字符串以连接到不同的数据库（出于测试目的，在部署服务器上）时，NHibernate 仍然保持与先前连接的数据库的连接。

只有重新启动 IIS 才能解决此问题。有谁知道这是否是由于 IIS 中的缓存造成的？还是我错过了一些设置？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:56:05.937

nhibernate.config 文件中的更改不会强制重新启动 IIS 应用程序，这意味着它会继续使用相同的 ISessionFactory 和配置的 IOC 容器。

最好的方法是将 nhibernate 配置为使用存储在 web.config 文件中并按名称引用的连接字符串。

您可以做的另一件事是将 nhibernate 的配置移动到 web.config 文件中。然后 chagning 它将强制重新配置 nhibernate。

# ios - NSMutableArray insertObject:atIndex 导致崩溃

> ID：11621583
> 
> 赞同：0
> 
> 时间：2012-07-23T22:42:52.627
> 
> 标签：ios, ipad, nsmutablearray

我正在为 iPad 开发幻灯片创建应用程序，当我让用户重新排列幻灯片时遇到了一些麻烦。当调用 slideDropped 方法时，如果我只是删除幻灯片然后将其添加到幻灯片的末尾，那么一切正常。如果我说 5 张幻灯片的幻灯片 2 并将其移动到幻灯片 3，那么当我尝试循环播放`slideshow.slides`（这只是 a `NSMutableArray`）时，它会在新幻灯片上出现错误的访问错误而崩溃。

```
-(void)slideDropped:(Slide *)slide
{
    int destIndex = (int)(slide.frame.origin.x) / 152;
    destIndex = MIN(destIndex, slideshow.slides.count - 1);
    destIndex = MAX(0, destIndex);
    int sourceIndex = [slideshow.slides indexOfObject:slide];
    [slideshow removeSlideAtIndex:sourceIndex];
    if(destIndex >= slideshow.slides.count)
        [slideshow addSlide:slide];
    else
        [slideshow insertSlide:slide atIndex:destIndex];
    [self arrangeSlides];
}

-(void)arrangeSlides
{
    [scrSlideshow.subviews makeObjectsPerformSelector:@selector(removeFromSuperview)];
    int x = 0;
    NSLog(@"There are %i slides",slideshow.slides.count);
    for(Slide* slide in slideshow.slides)
    {
        NSLog(@"%@",slide);//crashes here on the new slide if I insert at a specific index rather than appending the slide to the end
        CGRect frame = CGRectMake(x++ * 152, 21, 150, 150);
        slide.frame = frame;
        [scrSlideshow addSubview:slide];
    }
    [scrSlideshow setContentSize:CGSizeMake(slideshow.slides.count * 152, 150)];
}

//in the Slideshow class

-(void)addSlide:(Slide *)slide
{
    [slides addObject:slide];
}

-(void)removeSlideAtIndex:(int)index
{
    [slides removeObjectAtIndex:index];
}

-(void)insertSlide:(Slide *)slide atIndex:(int)index
{
    [slides insertObject:slides atIndex:index];
} 
```

关于我可能做错了什么的任何想法？我怀疑我没有正确管理幻灯片，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:48:06.913

查看该代码的底部。你有`insertObject:slides`. 这应该只是“幻灯片”还是您打算让它成为复数？那可能是你的问题

# iphone - 实现 GCD 后 TableView 为空

> ID：11621584
> 
> 赞同：1
> 
> 时间：2012-07-23T22:42:58.587
> 
> 标签：iphone, xcode, ios5, grand-central-dispatch

我正在尝试在我的表格视图中加入盛大的中央调度。我有一个财产：`NSArray *topPlaces`

`topPlaces`is 是来自 Flickr 查询的字典数组。这需要一些时间来执行，所以我想把它放在一个单独的线程上。此表用于`topPlaces`填写表的每一行（注意：此表是应用程序加载时出现的第一个视图）。因为有几个方法调用了 getTopPlaces，所以如果 topPlaces 没有初始化，我会在 getTopPlaces 中进行延迟实例化。我的代码目前：

```
- (NSArray *)getTopPlaces
{

   if (!_topPlaces)
      {
        dispatch_queue_t downloadrQueue = dispatch_queue_create("lister downloader", NULL);
        dispatch_async(downloadrQueue, ^{
            _topPlaces = [FlickrFetcher topPlaces];

            dispatch_async(dispatch_get_main_queue(), ^{
                NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"_content" ascending:YES];

                NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];
                NSArray *flickrTopPlacesAlphabetic = [_topPlaces sortedArrayUsingDescriptors:sortDescriptors];

                _topPlaces = flickrTopPlacesAlphabetic;
            });
        });
        dispatch_release(downloadrQueue);
      }

   return _topPlaces;
} 
```

The main problem I'm trying to solve is that when a row is selected, it segues to a new table view. 但是当我选择一行时，它会冻结几秒钟，直到新表加载。我希望用户即使在选择行并准备继续时也能够滚动。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T01:13:50.587

您可能会发现此示例项目很有帮助：[https ://github.com/akosma/async-uitableview/](https://github.com/akosma/async-uitableview/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T08:55:27.023

为了像[@Jacob](https://stackoverflow.com/users/740597/jacob-jennings)建议的那样更有效地实现这一点，您可以执行以下操作（将 your_table_view_object 替换为实际对象的引用）：

```
- (void)updateTopPlaces
{

   if (!_topPlaces)
      {
        dispatch_queue_t downloadrQueue = dispatch_queue_create("lister downloader", NULL);
        dispatch_async(downloadrQueue, ^{
            _topPlaces = [FlickrFetcher topPlaces];

            NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"_content" ascending:YES];

            NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];
            NSArray *flickrTopPlacesAlphabetic = [_topPlaces sortedArrayUsingDescriptors:sortDescriptors];

            _topPlaces = flickrTopPlacesAlphabetic;
            dispatch_async(dispatch_get_main_queue(), ^{
                [your_table_view_object reloadData];
            });
        });
        dispatch_release(downloadrQueue);
      }
} 
```

为了完成他的建议，您将创建一个 dispatch_queue_t 类型的实例变量，并从此函数中删除调度队列的创建和释放。对于这方面的更具体的帮助，我们需要查看整个类的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T02:34:42.330

首先，以 get 开头的命名方法违反了[Apple 的编码准则](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CodingGuidelines/Articles/NamingMethods.html)。以 get 开头的命名方法很少见。

您的主要问题是您正在异步调度任务以填充 _topPlaces 并在异步调用填充它之前返回它。你可以用 dispatch_sync 替换它，但是你会失去在 GCD 后台队列上处理的任何性能增益。相反，试试这个：

1.  不要从此方法返回任何内容（void）
2.  将您的排序向上移动到 downloadrQueue 块中（无需跳回主线程 - 排序代价高昂）
3.  在您的主队列块中，在您的表视图上调用 reloadData
4.  在 cellForRowAtIndexPath 中，根据 topPlaces 填充表格

您的第二个问题是，当您应该坚持使用队列时，您正在创建和销毁队列。尝试将 downloadrQueue 存储为属性并在表的视图控制器的生命周期内保留它。

# java - Java时间到期列表/集？

> ID：11621585
> 
> 赞同：21
> 
> 时间：2012-07-23T22:43:12.873
> 
> 标签：java, list, set

我一直在寻找一个 Java 列表、集合或类似的东西，它们的条目在给定的时间段后过期，但我还没有找到。我找到了 Guava's [`CacheBuilder`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/cache/CacheBuilder.html)，这对我来说几乎是完美的，但它是一个地图而不是一个列表或集合。是否已经有这样的东西，或者如果我想使用它，我必须制作一个吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-15T20:45:36.003

要用于`CacheBuilder`获取过期列表，您可以将对象作为键放在地图中，将一些虚拟对象作为值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:16:49.820

由于 Java HashSet 实现在内部使用 HashMap，因此应该很容易复制/修改代码以便它使用 Guavas CacheBuilder。

```
public class HashSet<E>
    extends AbstractSet<E>
    implements Set<E>, Cloneable, java.io.Serializable
{
    static final long serialVersionUID = -5024744406713321676L;

    private transient HashMap<E,Object> map;
... 
```

换句话说，只需将 your 实现`SetWithExpiration`为`CacheBuilder`从键到键的映射。这不会比`HashSet`使用底层的 Java 实现损失更多的效率`HashMap`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-03T21:32:14.997

你可以装饰一个集合实现来做到这一点。像这样的东西：

```
public class ExpirableArrayList<E> extends ArrayList<E> {

    private final Date creation = new Date();

    private final long timeToLiveInMs;

    public ExpirableArrayList(long timeToLiveInMs, int initialCapacity) {
        super(initialCapacity);
        this.timeToLiveInMs = timeToLiveInMs;
    }

    public ExpirableArrayList(long timeToLiveInMs) {
        this.timeToLiveInMs = timeToLiveInMs;
    }

    public ExpirableArrayList(long timeToLiveInMs, Collection<? extends E> c) {
        super(c);
        this.timeToLiveInMs = timeToLiveInMs;
    }

    private void expire() {
        if (System.currentTimeMillis() - creation.getTime() > timeToLiveInMs) {
            clear();
        }
    }

    @Override
    public int size() {
        expire();
        return super.size();
    }

    @Override
    public boolean isEmpty() {
        expire();
        return super.isEmpty();
    }

    @Override
    public boolean contains(Object o) {
        expire();
        return super.contains(o);
    }

    @Override
    public Iterator<E> iterator() {
        expire();
        return super.iterator();
    }

    @Override
    public Object[] toArray() {
        expire();
        return super.toArray();
    }

    @Override
    public <T> T[] toArray(T[] a) {
        expire();
        return super.toArray(a);
    }

    @Override
    public boolean add(E e) {
        expire();
        return super.add(e);
    }

    @Override
    public boolean remove(Object o) {
        expire();
        return super.remove(o);
    }

    @Override
    public boolean containsAll(Collection<?> c) {
        expire();
        return super.contains(c);
    }

    @Override
    public boolean addAll(Collection<? extends E> c) {
        expire();
        return super.addAll(c);
    }

    @Override
    public boolean addAll(int index, Collection<? extends E> c) {
        expire();
        return super.addAll(index, c);
    }

    @Override
    public boolean removeAll(Collection<?> c) {
        expire();
        return super.removeAll(c);
    }

    @Override
    public boolean retainAll(Collection<?> c) {
        expire();
        return super.retainAll(c);
    }

    @Override
    public E get(int index) {
        expire();
        return super.get(index);
    }

    @Override
    public E set(int index, E element) {
        expire();
        return super.set(index, element);
    }

    @Override
    public E remove(int index) {
        expire();
        return super.remove(index);
    }

    @Override
    public int indexOf(Object o) {
        expire();
        return indexOf(o);
    }

    @Override
    public int lastIndexOf(Object o) {
        expire();
        return lastIndexOf(o);
    }

    @Override
    public ListIterator<E> listIterator() {
        expire();
        return listIterator();
    }

    @Override
    public ListIterator<E> listIterator(int index) {
        expire();
        return listIterator();
    }

    @Override
    public List<E> subList(int fromIndex, int toIndex) {
        expire();
        return subList(fromIndex, toIndex);
    }
} 
```

# highcharts - Highstock 图表 - 同一 x 轴上的日期和疯狂的工具提示

> ID：11621590
> 
> 赞同：0
> 
> 时间：2012-07-23T22:43:46.923
> 
> 标签：highcharts, jsfiddle, highstock

我正在使用 Highstock 图表（来自“仅点标记”演示：[http](http://www.highcharts.com/stock/demo/markers-only) ://www.highcharts.com/stock/demo/markers-only ），我注意到以下问题：

a) 我注意到相应的工具提示很疯狂

b）我注意到日期被绘制在左边缘，几乎隐藏了工具提示符号......

您可能想看看以下 jsfiddle：http: [//jsfiddle.net/xfJhq/1/](http://jsfiddle.net/xfJhq/1/)

我感谢您提供的任何线索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T12:39:37.873

既然你提到你有更多的数据要添加，这就是我要做的：

*注意*工具提示每个系列悬停读取一个点，因此它将最近的点返回到鼠标光标

```
 tooltip: {
            allowHTML: true,
            formatter: function() {
                console.log(this.points) ; 

            }
        }, 
```

以下对象是最近的点：

```
return [
        key: "SALKTU - LEVEL ZERO"
        percentage: undefined
        point: xa
        series: c
        total: undefined
        x: 1324512000000
        y: 91
        __proto__: Object ] 
```

[jsFiddle](http://jsfiddle.net/minagabriel/xfJhq/3/)

要解决这个问题，您需要多个`yAxis`

所以我会这样做

```
 yAxis: [{
            title: {
                text: 'OHLC'
            },
            height:100,
            lineWidth: 2
        }, {
            title: {
                text: 'Volume'
            },
            top: 200,
            height: 100,
            offset: 0,
            lineWidth: 2
        } , {
        title: {
                text: 'max'
            },
            top: 320,
            height: 100,
            offset: 0,
            lineWidth: 2

        } ,{
        title: {
                text: 'min'
            },
            top: 450,
            height: 100,
            offset: 0,
            lineWidth: 2

        } ,
               ],

        series: [{
            type: 'column',
            name: 'RBWQCR - LEVEL ONE',
            data :[[1324512000000 ,81]]
        }, {
            type: 'column',
            name: 'JPXZTO - LEVEL EIGHT',

            yAxis: 1,
            data:[[1324512000000 ,81]]
        }, {
            type: 'column',
            name: 'CXRCTO - LEVEL THREE',

            yAxis: 2,
            data: [[1324512000000 ,81]]
        }, {
            type: 'column',
            name: 'FLOPAP - LEVEL FOUR',

            yAxis:3,
            data :[[1324512000000 ,81]]
        }] 
```

当您传递所有数据时，[工作 jsFiddle您的图表看起来会更好](http://jsfiddle.net/minagabriel/tgx2w/)

如果您不喜欢将每个系列放在单独的系列中，请查看以下[示例](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/stock/demo/compare/#save)，这有点复杂但值得尝试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T09:50:16.117

因为您只有一个特定日期的数据。

添加`minPadding`到您的 x 轴将起作用。

检查更新的小提琴：http: [//jsfiddle.net/xfJhq/2/](http://jsfiddle.net/xfJhq/2/)

注意：我知道这`minPadding`不适用于缩放，我已经向 Highstock 论坛报告了同样的[问题。](http://highslide.com/forum/viewtopic.php?f=12&t=18261)

# css - CSS 选择器 # 模式——有什么意义吗？

> ID：11621591
> 
> 赞同：2
> 
> 时间：2012-07-23T22:43:48.263
> 
> 标签：css

在使用“不太好”的代码库处理 Web 项目时，我经常在 JS/CSS 选择器中看到这样的写法

```
div#myID 
```

这似乎是错误的......

[http://jsfiddle.net/bobber205/yeJRQ/](http://jsfiddle.net/bobber205/yeJRQ/)

上面的例子。这意味着，如果由于某种原因，您更改了 id 所属的标签，那么您可能有很多 css 需要更改......

人们这样做是怎么回事？它更快吗？速度提升值得吗？好好奇。:P

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T22:48:10.017

这是一个*非常*糟糕的做法。ID 选择器根据定义是唯一的。包含标签或类限定符只会添加需要评估的冗余信息。所以它根本没有速度改进 - 这是一个无用的减速。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T22:52:12.467

可能有一个用例。例如，如果您有`span#myID`内联元素或`div#myID`块元素（当然在不同的页面中）并且想要应用不同的样式。

但是正如@Zoltan Toth 注意到的那样，对于 CSS 选择器基础知识不够熟悉的人，通常会出现“将标记名称以防万一”的行为。

在 99% 的情况下，如果您选择带有 ID 的内容，您应该只使用 ID。它是独一无二的。

# forms - 上传前抓取带有 chrome 扩展名的文件

> ID：11621592
> 
> 赞同：1
> 
> 时间：2012-07-23T22:43:50.220
> 
> 标签：forms, file, file-upload, google-chrome-extension

使用我的 chrome 扩展程序，我想在文件上传到网站之前抓取一个文件（并可能更改它）。特别是来自文件输入。换句话说，如果我选择一个带有 input[type=file] 的文件，我希望我的 chrome 扩展程序中断任何提交并获取文件。然后我的扩展程序将它的魔力应用于文件，然后可以提交/上传文件。我该如何处理？

文件路径出现问题。如果我获取文件输入的值，由于 HTML5 标准和兼容性问题，它总是将实际路径更改为“C:\fakepath\”。那我该如何访问该文件？也许它暂时保存在某些 chrome 存储中？

编辑：好吧，我设法读取了在文件输入中选择的文件，如下所示：

```
var file;
$('input[type=file]').change(function(e){
    file = e.target.files[0];
    var reader = new FileReader();      
    reader.onload = function (event) {
        console.log(event.target.result);  //contains the file data
        //maybe change data and use filewriter  

    };      
    reader.readAsDataURL(file);
}; 
```

现在我想使用 FileWriter 写入 e.target.files[0]

我遵循了本教程： [http](http://www.html5rocks.com/en/tutorials/file/filesystem/) ://www.html5rocks.com/en/tutorials/file/filesystem/ 但我无法创建合适的 FileWriter。

没有必要写入磁盘上的原始文件 - 甚至可能不可能 - 但我需要更改用于在相应文件输入表单字段中上传的数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T10:14:45.097

没有为 Chrome 扩展定义的 API 来拦截请求的负载（[正在进行中](http://www.chromium.org/developers/design-documents/extensions/proposed-changes/apis-under-development/notifications-of-web-request-and-navigation#TOC-Accessing-request-and-response-bodi)）。

话虽如此，您可以使用[Content 脚本](http://code.google.com/chrome/extensions/content_scripts.html)添加一个事件侦听器，该事件侦听器：

1.  取消正常的表单提交。
2.  [`ArrayBuffer`](https://developer.mozilla.org/en/JavaScript_typed_arrays/ArrayBuffer)使用[`FileReader`](https://developer.mozilla.org/en/DOM/FileReader)API读取文件。
3.  将结果`ArrayBuffer`包装在[视图](https://developer.mozilla.org/en/JavaScript_typed_arrays/ArrayBufferView)中后进行修改。
4.  [`Blob`](https://developer.mozilla.org/en/DOM/Blob)从修改后的数据创建一个。
5.  通过创建[`FormData`](https://developer.mozilla.org/en/DOM/XMLHttpRequest/FormData)实例重构表单，然后使用该[`.append(name, value[, filename])`](https://developer.mozilla.org/en/DOM/XMLHttpRequest/FormData#append%28%29)方法。
    注意：在下面的示例中，我没有**包含**表单重构方法。我只包括了文件上传部分。重构表单有两种方法：

    1.  编写一个特定于您的表单的方法。
    2.  编写一个通用的表单解析方法，该方法处理无名/禁用/未检查/...元素。如果您想走这条路，请查看[W3 规范的表单提交算法](http://www.w3.org/TR/2011/WD-html5-20110525/association-of-controls-and-forms.html#form-submission-algorithm)。
6.  [使用`XMLHttpRequest`](https://developer.mozilla.org/es/XMLHttpRequest/Usar_XMLHttpRequest)提交数据。注意：如果您在 Chrome 扩展程序的上下文中运行此代码，请不要忘记[`permissions`在清单文件的部分中](http://code.google.com/chrome/extensions/manifest.html#permissions)明确将 URL 列入白名单。

下面是一个实现示例：

```
// Reference to the form:
var form = document.forms["uploadForm"];
form.addEventListener('submit', function(ev) {
    ev.preventDefault(); // Cancel submission

    var fileInput = form.querySelector('input[type="file"]');
    var file = fileInput.files[0];
    if (!file) return; // No file selected

    var fileReader = new FileReader();
    fileReader.onload = function() {
        var arraybuffer = fileReader.result;
        // To manipulate an arraybuffer, wrap it in a view:
        var view = new Uint8Array(arraybuffer);
        view[0] = 0; // For example, change the first byte to a NULL-byte

        // Create an object which is suitable for use with FormData
        var blob = new Blob([view], {type: file.type});

        // Now, the form reconstruction + upload part:
        var formData = new FormData();
        formData.append(fileInput.name, blob, file.name);
        // ... handle remainder of the form ...

        // Now, submit the form
        var xhr = new XMLHttpRequest();
        xhr.open('POST', form.action);
        xhr.onload = function() {
            // Do something. For example:
            alert(xhr.responseText);
        };
        xhr.onerror = function() {
            console.log(xhr); // Aw. Error. Log xhr object for debugging
        }
        xhr.send(formData);
    };
    fileReader.readAsArrayBuffer(file);
}); 
```

# android - 可以获取 Picasa 供稿，可以上传和下载 - 无法删除

> ID：11621593
> 
> 赞同：1
> 
> 时间：2012-07-23T22:43:51.643
> 
> 标签：android, gdata, picasa

我正在使用 Yaniv Inbar 的`GData`客户端从 Android 应用程序访问 Picasa 相册。我*通过身份验证*

```
AccountManager.getAuthToken(account, "lh2", null, activity, null, null); 
```

并可以获取用户和相册提要，以及下载和上传图片。我**不能**做的是`PicasaClient.executeDelete(Entry)`- 尽管使用与 getFeed 和上传/下载操作使用完全相同的身份验证，但它一直给我一个 403 错误。

我是否需要设置`client_id`和`client_secret`删除但不需要获取/放置？如果有，在哪里？ [向 OAuth2 服务进行身份验证](http://developer.android.com/training/id-auth/authenticate.html)显示

```
URL url = new URL("https://www.googleapis.com/tasks/v1/users/@me/lists?key=" + your_api_key);
URLConnection conn = (HttpURLConnection) url.openConnection();
conn.addRequestProperty("client_id", your client id);
conn.addRequestProperty("client_secret", your client secret);
conn.setRequestProperty("Authorization", "OAuth " + token); 
```

但我`URLConnection`在堆栈中看不到任何地方。我**猜**钩子会在某个地方

```
authToken = authBundle.getString(AccountManager.KEY_AUTHTOKEN);
ClientLogin.Response clientLogin = new ClientLogin.Response();
clientLogin.auth = authToken; 
```

...但在哪里并不完全清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:48:39.257

叹。这是 100% 医源性的。

我使用“编辑”链接创建了条目，例如

```
https://picasaweb.google.com/data/entry/api/user/%s/albumid/%s/photoid/%s 
```

但将其设置`etag`为`null`因为我在专辑提要中获得的 etags 似乎被截断了。

我一换

```
photoEntry.etag = null; 
```

和

```
photoEntry.etag = "*"; 
```

一切都好。

# php - php没有正确创建mysql列

> ID：11621595
> 
> 赞同：3
> 
> 时间：2012-07-23T22:44:10.457
> 
> 标签：php, mysql, codeigniter

我正在尝试`MySQL`使用`CodeIgniter`PHP 框架在 中动态创建表：

```
if($colname != ''){
            $str = "CREATE TABLE IF NOT EXISTS $colname (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), site_id INT NOT NULL, name BLOB NOT NULL)ENGINE=INNOBD;";
            $query = $this->db->query($str); 
```

当我从`MySQL`命令提示符执行它时，它完美地创建了表。但是，如果它通过 完成`CodeIgniter`，我会收到以下错误：

```
<body>
    <div id="container">
        <h1>A Database Error Occurred</h1>
        <p>Error Number: 1064</p><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''tc 11' (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), site_id INT NOT NULL, ' at line 1</p><p>CREATE TABLE IF NOT EXISTS 'tc 11' (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), site_id INT NOT NULL, name BLOB NOT NULL)ENGINE=INNOBD;</p> 
```

这里发生了什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:47:24.950

您使用引号`'`而不是反引号 ` ` 来包围您的表名。MySQL 使用[反引号来转义名称](https://stackoverflow.com/questions/261455/using-backticks-around-field-names)。

您应该更改`$colname`from的值

```
'tc 11' 
```

对此：

```
`tc 11` 
```

你可以这样做：

```
$colname = str_replace("'", "`", $colname); 
```

其他证实这一点的资源：

*   [MySQL的列名中的空格](https://stackoverflow.com/questions/6055505/blank-spaces-in-column-names-with-mysql)

（对代码块感到抱歉；所以在内联代码中存在反引号问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:47:18.310

那是因为您在 $colname 中传递了不正确的值

首先我假设`$colname`应该是`$tablename`，因为这是一个创建表的查询。

并且您的表名中似乎有一个空格，请显示您的 $colname 变量中的值。

应该没有空间，`TC_11`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T22:48:52.340

尝试：

```
"CREATE TABLE IF NOT EXISTS `".str_replace(' ','',$colname)."` (id... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T22:49:04.333

您的 sql 查询中存在错误。以下代码应该可以完成这项工作并使其更安全。

```
if(!empty($colname))
{
    $sql = "CREATE TABLE IF NOT EXISTS ? (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), site_id INT NOT NULL, name BLOB NOT NULL)ENGINE=INNOBD;";
    $query = $this->db->query($sql,array($colname));
} 
```

# c - 移动内存页面的方法比 mremap() 更快？

> ID：11621606
> 
> 赞同：20
> 
> 时间：2012-07-23T22:45:34.513
> 
> 标签：c, linux, memory, tlb

我一直在尝试使用 mremap()。我希望能够高速移动虚拟内存页面。至少比复制它们的速度更高。我对算法有一些想法，可以利用能够非常快速地移动内存页面。问题是下面的程序显示 mremap() 非常慢 - 至少在我的 i7 笔记本电脑上 - 与实际逐字节复制相同的内存页面相比。

测试源代码是如何工作的？mmap() 256 MB RAM，比 CPU 上的缓存大。迭代 200,000 次。在每次迭代中，使用特定的交换方法交换两个随机内存页。使用基于 mremap() 的页面交换方法运行一次。使用逐字节复制交换方法再次运行并计时。事实证明，mremap() 每秒只管理 71,577 次页面交换，而逐字节复制每秒管理高达 287,879 次页面交换。所以 mremap() 比逐字节复制慢 4 倍！

问题：

为什么 mremap() 这么慢？

是否有另一个可能更快的用户级或内核级可调用页面映射操作 API？

是否有另一个用户级或内核级可调用页面映射操作 API 允许在一次调用中重新映射多个非连续页面？

有没有支持这种事情的内核扩展？

```
#include <stdio.h>
#include <string.h>
#define __USE_GNU
#include <unistd.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <sys/errno.h>
#include <asm/ldt.h>
#include <asm/unistd.h>    

// gcc mremap.c && perl -MTime::HiRes -e '$t1=Time::HiRes::time;system(q[TEST_MREMAP=1 ./a.out]);$t2=Time::HiRes::time;printf qq[%u per second\n],(1/($t2-$t1))*200_000;'
// page size = 4096
// allocating 256 MB
// before 0x7f8e060bd000=0
// before 0x7f8e060be000=1
// before 0x7f8e160bd000
// after  0x7f8e060bd000=41
// after  0x7f8e060be000=228
// 71577 per second

// gcc mremap.c && perl -MTime::HiRes -e '$t1=Time::HiRes::time;system(q[TEST_COPY=1 ./a.out]);$t2=Time::HiRes::time;printf qq[%u per second\n],(1/($t2-$t1))*200_000;'
// page size = 4096
// allocating 256 MB
// before 0x7f1a9efa5000=0
// before 0x7f1a9efa6000=1
// before 0x7f1aaefa5000
// sizeof(i)=8
// after  0x7f1a9efa5000=41
// after  0x7f1a9efa6000=228
// 287879 per second

// gcc mremap.c && perl -MTime::HiRes -e '$t1=Time::HiRes::time;system(q[TEST_MEMCPY=1 ./a.out]);$t2=Time::HiRes::time;printf qq[%u per second\n],(1/($t2-$t1))*200_000;'
// page size = 4096
// allocating 256 MB
// before 0x7faf7c979000=0
// before 0x7faf7c97a000=1
// before 0x7faf8c979000
// sizeof(i)=8
// after  0x7faf7c979000=41
// after  0x7faf7c97a000=228
// 441911 per second

/*
 * Algorithm:
 * - Allocate 256 MB of memory
 * - loop 200,000 times
 *   - swap a random 4k block for a random 4k block
 * Run the test twice; once for swapping using page table, once for swapping using CPU copying!
 */

#define PAGES (1024*64)

int main() {
    int PAGE_SIZE = getpagesize();
    char* m = NULL;
    unsigned char* p[PAGES];
    void* t;

    printf("page size = %d\n", PAGE_SIZE);

    printf("allocating %u MB\n", PAGE_SIZE*PAGES / 1024 / 1024);
    m = (char*)mmap(0, PAGE_SIZE*(1+PAGES), PROT_READ | PROT_WRITE, MAP_SHARED  | MAP_ANONYMOUS, -1, 0);
    t = &m[PAGES*PAGE_SIZE];
    {
        unsigned long i;
        for (i=0; i<PAGES; i++) {
            p[i] = &m[i*PAGE_SIZE];
            memset(p[i], i & 255, PAGE_SIZE);
        }
    }

    printf("before %p=%u\n", p[0], p[0][0]);
    printf("before %p=%u\n", p[1], p[1][0]);
    printf("before %p\n", t);

    if (getenv("TEST_MREMAP")) {
        unsigned i;
        for (i=0; i<200001; i++) {
            unsigned p1 = random() % PAGES;
            unsigned p2 = random() % PAGES;
    //      mremap(void *old_address, size_t old_size, size_t new_size,int flags, /* void *new_address */);
            mremap(p[p2], PAGE_SIZE, PAGE_SIZE, MREMAP_FIXED | MREMAP_MAYMOVE, t    );
            mremap(p[p1], PAGE_SIZE, PAGE_SIZE, MREMAP_FIXED | MREMAP_MAYMOVE, p[p2]);
            mremap(t    , PAGE_SIZE, PAGE_SIZE, MREMAP_FIXED | MREMAP_MAYMOVE, p[p1]); // p3 no longer exists after this!
        } /* for() */
    }
    else if (getenv("TEST_MEMCPY")) {
        unsigned long * pu[PAGES];
        unsigned long   i;
        for (i=0; i<PAGES; i++) {
            pu[i] = (unsigned long *)p[i];
        }
        printf("sizeof(i)=%lu\n", sizeof(i));
        for (i=0; i<200001; i++) {
            unsigned p1 = random() % PAGES;
            unsigned p2 = random() % PAGES;
            unsigned long * pa = pu[p1];
            unsigned long * pb = pu[p2];
            unsigned char t[PAGE_SIZE];
            //memcpy(void *dest, const void *src, size_t n);
            memcpy(t , pb, PAGE_SIZE);
            memcpy(pb, pa, PAGE_SIZE);
            memcpy(pa, t , PAGE_SIZE);
        } /* for() */
    }
    else if (getenv("TEST_MODIFY_LDT")) {
        unsigned long * pu[PAGES];
        unsigned long   i;
        for (i=0; i<PAGES; i++) {
            pu[i] = (unsigned long *)p[i];
        }
        printf("sizeof(i)=%lu\n", sizeof(i));
        // int modify_ldt(int func, void *ptr, unsigned long bytecount);
        // 
        // modify_ldt(int func, void *ptr, unsigned long bytecount);
        // modify_ldt() reads or writes the local descriptor table (ldt) for a process. The ldt is a per-process memory management table used by the i386 processor. For more information on this table, see an Intel 386 processor handbook.
        // 
        // When func is 0, modify_ldt() reads the ldt into the memory pointed to by ptr. The number of bytes read is the smaller of bytecount and the actual size of the ldt.
        // 
        // When func is 1, modify_ldt() modifies one ldt entry. ptr points to a user_desc structure and bytecount must equal the size of this structure.
        // 
        // The user_desc structure is defined in <asm/ldt.h> as:
        // 
        // struct user_desc {
        //     unsigned int  entry_number;
        //     unsigned long base_addr;
        //     unsigned int  limit;
        //     unsigned int  seg_32bit:1;
        //     unsigned int  contents:2;
        //     unsigned int  read_exec_only:1;
        //     unsigned int  limit_in_pages:1;
        //     unsigned int  seg_not_present:1;
        //     unsigned int  useable:1;
        // };
        //
        // On success, modify_ldt() returns either the actual number of bytes read (for reading) or 0 (for writing). On failure, modify_ldt() returns -1 and sets errno to indicate the error.
        unsigned char ptr[20000];
        int result;
        result = modify_ldt(0, &ptr[0], sizeof(ptr)); printf("result=%d, errno=%u\n", result, errno);
        result = syscall(__NR_modify_ldt, 0, &ptr[0], sizeof(ptr)); printf("result=%d, errno=%u\n", result, errno);
        // todo: how to get these calls returning a non-zero value?
    }
    else {
        unsigned long * pu[PAGES];
        unsigned long   i;
        for (i=0; i<PAGES; i++) {
            pu[i] = (unsigned long *)p[i];
        }
        printf("sizeof(i)=%lu\n", sizeof(i));
        for (i=0; i<200001; i++) {
            unsigned long j;
            unsigned p1 = random() % PAGES;
            unsigned p2 = random() % PAGES;
            unsigned long * pa = pu[p1];
            unsigned long * pb = pu[p2];
            unsigned long t;
            for (j=0; j<(4096/8/8); j++) {
                t = *pa; *pa ++ = *pb; *pb ++ = t;
                t = *pa; *pa ++ = *pb; *pb ++ = t;
                t = *pa; *pa ++ = *pb; *pb ++ = t;
                t = *pa; *pa ++ = *pb; *pb ++ = t;
                t = *pa; *pa ++ = *pb; *pb ++ = t;
                t = *pa; *pa ++ = *pb; *pb ++ = t;
                t = *pa; *pa ++ = *pb; *pb ++ = t;
                t = *pa; *pa ++ = *pb; *pb ++ = t;
            }
        } /* for() */
    }

    printf("after  %p=%u\n", p[0], p[0][0]);
    printf("after  %p=%u\n", p[1], p[1][0]);
    return 0;
} 
```

更新：所以我们不需要质疑“往返内核空间”有多快，这是一个进一步的性能测试程序，它表明我们可以连续调用 getpid() 3 次，每秒 81,916,192 次i7 笔记本电脑：

```
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>

// gcc getpid.c && perl -MTime::HiRes -e '$t1=Time::HiRes::time;system(q[TEST_COPY=1 ./a.out]);$t2=Time::HiRes::time;printf qq[%u per second\n],(1/($t2-$t1))*100_000_000;'
// running_total=8545800085458
// 81916192 per second

/*
 * Algorithm:
 * - Call getpid() 100 million times.
 */

int main() {
    unsigned i;
    unsigned long running_total = 0;
    for (i=0; i<100000001; i++) {
        /*      123123123 */
        running_total += getpid();
        running_total += getpid();
        running_total += getpid();
    } /* for() */
    printf("running_total=%lu\n", running_total);
} 
```

更新 2：我添加了 WIP 代码来调用我发现的名为 modify_ldt() 的函数。手册页暗示页面操作可能是可能的。但是，无论我尝试什么，当我期望它返回读取的字节数时，该函数总是返回零。'man modify_ldt' 表示“成功时，modify_ldt() 返回读取的实际字节数（用于读取）或 0（用于写入）。失败时，modify_ldt() 返回 -1 并设置 errno 以指示错误。” 任何想法（a） modify_ldt() 是否可以替代 mremap() ？(b) 如何让 modify_ldt() 工作？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-24T20:27:06.567

似乎没有比 memcpy() 更快的用户级机制来重新排序内存页面。mremap() 慢得多，因此仅对重新调整先前使用 mmap() 分配的内存区域的大小有用。

但是我听到你说页表必须非常快！并且用户级每秒可以调用数百万次内核函数！以下参考资料有助于解释为什么 mremap() 如此缓慢：

[“An Introduction to Intel Memory Management”](http://static.ow.ly/docs/memory_Rt7.pdf)很好地介绍了内存页映射理论。

[“英特尔虚拟内存的关键概念”](http://code.google.com/p/eveos/wiki/VirtualMemory)更详细地展示了它是如何工作的，以防您打算编写自己的操作系统 :-)

[“在 Linux 内核中共享页表”](http://www.linuxinsight.com/files/ols2003/mccracken-reprint.pdf)展示了一些困难的 Linux 内存页映射架构决策及其对性能的影响。

一起查看所有三个引用，我们可以看到，到目前为止，内核架构师几乎没有努力以有效的方式将内存页面映射公开给用户空间。即使在内核中，页表的操作也必须使用最多三个锁来完成，这会很慢。

展望未来，由于页表本身由 4k 页组成，因此可以更改内核，以便特定页表页对于特定线程是唯一的，并且可以假定在运行期间具有无锁访问过程。这将有助于通过用户空间对特定页表页面进行非常有效的操作。但这超出了原始问题的范围。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-23T23:07:18.183

是什么让您认为`mremap`交换单个 4k 页面可能是有效的？至少，即使只是读取单个值（如 pid）并返回它，往返内核空间也会比移动 4k 数据成本更高。那是在我们到达重新映射内存的缓存失效/TLB 成本之前，我不太了解这个答案，但应该有一些严重的成本。

`mremap`基本上对一件事很有用`realloc`：*实现*由`mmap`. 总的来说，我的意思是可能至少 100k。

# java - 使用与 SQL 的多对多关系提供唯一性以用于 Java

> ID：11621607
> 
> 赞同：1
> 
> 时间：2012-07-23T22:45:34.483
> 
> 标签：java, sql, hibernate

我对一个问题有点困惑，想知道我是否遗漏了一些简单的东西。

我有三张桌子：

```
create table A (id serial primary key, name char(50));
create table B (id serial primary key, name char(50));
create table c (A int references A(id), B int references b(id)); 
```

并且我确保不重复使用 A & B 关系：

```
create index unique_a_b_in_c on c (A,B); 
```

然后我使用hibernate将这些文件逆向工程为Java对象。

到目前为止一切都很好，但现在我想做的是确保 A 的每个实例都有 B 记录的唯一组合。（例如，如果我在 B - B1 和 B2 中有 2 条记录，那么我的 A 记录只能有四个可能的值，即：无记录、B1 记录、B2 记录或 B1 和 B2 记录。 )

到目前为止，我最好的尝试是在 A 中创建一个唯一的哈希码，该哈希码基于属于该记录的类型 B 记录，然后覆盖 equals 函数以检查 A 的 B 记录集合的内容。如果对象相等，我会更新A记录，但如果A记录是新的，我可以保存它。

显然，这对于 equals 来说是一个繁重的过程，并且随着 B 的大小变大，检查匹配项时的处理时间也越来越长。

我目前的想法是放弃任何提供这种唯一性的尝试，并允许重复，尽管它们在我的问题的上下文中没有意义，因为 A 实际上是由组成它的 B 记录的组合定义的。

有没有人对如何解决这个问题有任何想法？

非常感谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:45:44.173

当您定义了“B”组时，构建一个 SELECT 语句来检查它是否已经定义为“A”应该是一件简单的事情。

```
SELECT A, count(*) as rows from c where B IN ( 'B1', 'B2' ... ) group by A 
```

如果 count(*) = IN 子句中的元素数，那么您找到了与 B 匹配的 A。该语句应该运行相对较快，尤其是在 B 被索引的情况下。

然而，它会随着 c 的增长而减慢。你可以尝试添加

```
HAVING count(*) = 2 (or whatever your count of the number of rows of B is) 
```

但是由于 HAVING 通常是在初始查询之后由优化器完成的，它可能不会加快速度，但如果匹配，它会给你*一行*，如果不匹配，它会给你一行。

# python - python读/写文件的文件列表

> ID：11621608
> 
> 赞同：0
> 
> 时间：2012-07-23T22:45:36.040
> 
> 标签：python, linux, file

在 python 2.7 中，我需要对文件列表执行相同的操作。

例如，#每个文件都是一个文件描述符 例如，fileX = open("someString", "a")

```
 fileList1 = [file1, file2, file3,file4,file5] 
 fileList2 = [file11, file21, file31,file41,file51] 
 allFilelist = [fileList1, fileList2] 
```

当我尝试在它们上面读/写一些字符串时，我得到：

```
 line = item.readline()
 IOError: [Errno 9] Bad file descriptor 
```

* * *

```
 # each file in allFilList is a file list 
 allFilList = [ifcxRpsFileNameL, ircxRpsFileNameL, transXRpsFileNameL, ifcxFileNameL, 
 ircxFileNameL, transXFileNameL]
 for eachFileList in allFilList :
    for item in eachFileList :
            #print item.read 
            line = item.readline()
            #for line in :
            print "the line read from ", item, " is " , line
            ll= line.strip("\n").split()
            if len(ll) == 0 :
                print "the file " , item , " is empty \n"
                exit  
            elif len(ll) != TOTAL_ITR :
                print "the len of the file " , item , " is not " , TOTAL_ITR , "\n"
                exit
            else:
                item.write("\n")
                lt = [float(num) for num in ll]
                item.write(min(lt))
                item.write(" ") 
                item.write(sum(lt)/len(lt))
                item.write(" ")
                item.write(max(lt))
                item.write(" ")
                item.write("\n")
                item.close()
                break 
```

针对此评论：

> 在您尝试读取项目并发布输出之前打印出项目

输出是：`<open file 'ND_ifxc_2010_RPS.dat', mode 'a' at 0x2ba38d1e9558>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T23:00:07.683

The problem that you have comes from the fact that the files you have open are opened with mode `'a'`, and therefore, not for reading. As a result, attempting to read from a file not open for reading gives you an error.

You are likely better off storing a list of filepaths, and doing this:

1.  open with `'r'` mode
2.  read lines
3.  based on your conditions, close them, reopen in `'a'` mode and write the required lines.

Hope this helps

# html - 使用 PHP 生成画布

> ID：11621609
> 
> 赞同：0
> 
> 时间：2012-07-23T22:45:50.677
> 
> 标签：html, canvas

我现在遇到的问题是试图让 PHP 制作一个用户可以自定义和保存的画布。这就是我的意思：我有一个创建云形状的画布，用户可以移动它等等。这一切都很好，花花公子。但是，这就是问题所在；我似乎无法从逻辑上弄清楚如何使用 PHP 添加他们输入的用户名并将其作为常规文本放在云中。我还希望能够让用户命名某种拼贴画，这将是画布的背景图像。此外，我如何才能让用户只能更改云上的大小、位置和图片，而观众也无法更改并将其集成到画布中？

我确信有一个简单的解决方案，当我发现它时我会感到非常愚蠢。但是，无论如何，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:49:06.403

在 PHP 中做这样的事情会有点困难。通过使用 PHP，您仍然可以通过 ajax 卸载到 javascript。

编辑：忽略上述。我什至不确定这是否可能，因为 PHP 是客户端，而 js（画布）是客户端）。但请阅读下文。

另一种方法是使用 node.js 或类似方法通过 javascript 与您的服务器通信（canvas 确实是 JS，所以为什么不坚持使用 JS）。

至于您的其他问题，一旦您可以成功与服务器对话，您就可以将该信息传递给客户端 - 例如用户/查看者是否有权查看/查看某些控件。

# entity-framework - 实体框架 - .Load() 的问题

> ID：11621611
> 
> 赞同：3
> 
> 时间：2012-07-23T22:46:09.473
> 
> 标签：entity-framework

我一直在关注这篇文章，[http://blogs.msdn.com/b/adonet/archive/2011/01/31/using-dbcontext-in-ef-feature-ctp5-part-6-loading-related-entities .aspx](http://blogs.msdn.com/b/adonet/archive/2011/01/31/using-dbcontext-in-ef-feature-ctp5-part-6-loading-related-entities.aspx)

特别是标题为“显式加载相关实体时应用过滤器”的部分。

我需要做类似的事情：

```
db.Configuration.LazyLoadingEnabled = false;
var class = db.Classes.Find(1);
db.Entry(class).Collection(c => c.Students).Query().Where(s => s.grade > 2.0).Load(); 
```

当我逐步完成并观看 SQL 分析器时，我看到了加载类的查询。然后我看到应该加载学生的查询，但是 class.Students 从未填充并保持为空。但是，如果我从 SQL 分析器复制学生查询并自己运行，则会返回相应的学生。似乎实体框架正在运行学生查询并返回正确的结果，但没有将它们附加到类对象。

有一些方法可以解决这个问题，但我想知道我是否错过了一步，或者我是否没有正确使用 .Load() 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T00:10:33.160

`Class`如果和之间的关系`Student`是**多对多**关系，那么您所看到的行为是预期的（尽管令人困惑，我承认）。首先，如果您阅读 Intellisense 关于该`Load`方法的说明...

> 枚举查询，以便对于服务器查询（例如 System.Data.Entity.DbSet、System.Data.Objects.ObjectSet、System.Data.Objects.ObjectQuery 等），查询结果**将加载到关联的系统中.Data.Entity.DbContext、System.Data.Objects.ObjectContext 或客户端上的其他缓存**。这相当于调用 ToList 然后丢弃列表，而无需实际创建列表的开销。

...它并没有说您运行查询的实体的导航集合被填充，只是结果被加载到上下文中。

**在您调用时填充一对多**关系的导航集合`Load`实际上并不是此方法的结果，而是称为**关系跨度或修复**的上下文的后续处理的结果，该处理不会发生对于多对多关系。

在这个问题和答案中有更多详细信息：[EF 4.1 loading filtered child collections not working for many-to-many](https://stackoverflow.com/questions/6141988/ef-4-1-loading-filtered-child-collections-not-working-for-many-to-many)

精髓是 - 对于多对多关系 - 您必须使用`ToList()`而不是直接填充导航集合`Load()`：

```
var class1 = db.Classes.Find(1);
class1.Students = db.Entry(class1).Collection(c => c.Students).Query()
    .Where(s => s.grade > 2.0).ToList(); 
```

这会将学生加载到上下文中*并同时*填充导航集合`class1`。

# jquery-ui - 使用日期时间选择器时将当前时间设置为最小日期

> ID：11621612
> 
> 赞同：1
> 
> 时间：2012-07-23T22:46:14.363
> 
> 标签：jquery-ui, datetimepicker

我是 javascript 和 jquery 的新手。我正在使用 Trent Richardson 的时间选择器[库](http://trentrichardson.com/examples/timepicker/)。我想将当前时间作为默认日期和 minDate。

```
$("#date").datetimepicker('option', 'setDate', (new Date())),
$("#date").datetimepicker({
    onSelect: function (selectedDateTime){
        $("#rundate").datetimepicker('option', 'minDate', (new Date()));
    }
}); 
```

这行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-11-30T16:15:23.517

当前库需要初始化实例才能工作 例如：.datetimepicker({...}) 或 datetimepicker()

```
$("#date").datetimepicker('option', 'setDate', (new Date()));
$("#rundate").datetimepicker(); //You need to init this before assign min date
$("#date").datetimepicker({
  onSelect: function(selectedDateTime) {
    $("#rundate").datetimepicker('option', 'minDate', (new Date()));
  }
}); 
```

有关更多详细信息，我将再次重构您的代码。

```
//Init steps      
$("#date").datetimepicker();
$("#rundate").datetimepicker();

//define variables steps
$("#date").datetimepicker('option', 'setDate', (new Date()));
$("#date").datetimepicker('option', 'onSelect', function(selectedDateTime) {
  $("#rundate").datetimepicker('option', 'minDate', (new Date()));
}); 
```

[你可以在这里](https://plnkr.co/edit/7XTv6XTp0sfZ9HYZpSwe?p=preview)尝试现场演示

# ember.js - emberjs 菜单更改内容

> ID：11621613
> 
> 赞同：0
> 
> 时间：2012-07-23T22:46:25.837
> 
> 标签：ember.js

我有菜单：

```
<ul>
<li><a>menu1</a></li>
<li><a>menu2</a></li>
<li><a>menu3</a></li>
</ul> 
```

我有内容：

```
<script type="text/x-handlebars" data-template-name="content1">text1</script>
<script type="text/x-handlebars" data-template-name="content2">text2</script>
<script type="text/x-handlebars" data-template-name="content3">text3</script> 
```

和网站：

```
...
header
menu
<div id="content">
<!-- there is a place for content from emberjs .appendTo() i guess should be used? -->
</div>
footer
... 
```

如果用户单击“menu1”：请参阅“content1”和“menu1”获取 css 类“menu-active”。If clck "menu2": see "content2" and "menu2" get css class "menu-active" 等

重要信息：“content2”也会在 emberjs 中生成数据。当然，当单击“menu1”和稍后的“menu2”时：效果 menu1 必须消失。

我很困惑如何核心地使用它。

对于菜单，我应该扩展类视图还是控制器？

我试过了：

```
<li>{{#view App.MenuView}}<a {{action "show" content="content1" }} >content1</a>{{/view}}</li> 
```

没有“li”等会更好吗？我想更好的方法是当 emberjs 生成

```
"<li><a>...</a></li>" 
```

所以我应该做类似的事情

```
{{... menu="menu1" content="content1"...}} 
```

我没有填写如何以正确的方式做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T15:57:37.547

我对这个问题的解决方案是使用 Ember.Router 来更改您看到的内容，并使用 Ember.ArrayController 来控制菜单本身：您需要具有两个出口的应用程序模板，一个用于菜单，一个用于内容：

```
<script type="text/x-handlebars" data-template-name="application">
<p>Click on menu item:</p>
{{outlet menu}}
{{outlet main}}
</script> 
```

菜单模板：

```
<script type="text/x-handlebars" data-template-name="menu-list">
<ul class='nav nav-list'>
{{#each controller}}
{{#if isActive}}
<li class="active">
{{else}}
<li>
{{/if}}
<a {{action changeRoute this.url}}>{{this.name}}</a>
</li>
{{/each}}
</ul>
</script> 
```

每个内容都由自己的视图控制：

```
App.IndexView = Ember.View.extend({
  templateName: 'index',
}); 
```

和模板：

```
<script type="text/x-handlebars" data-template-name="index">
<h1>Index Content</h1>
</script> 
```

当您单击菜单项时，您运行 changeRoute 方法来更改菜单和交换内容：

```
...
changeRoute: function(router,context) {
  router.transitionTo(context.context,context);
},
connectOutlets: function(router){
  var appContr = router.get('applicationController');
  var cname = router.get('currentState.name');
  appContr.connectOutlet('main',cname);
  appContr.connectOutlet('menu','menuList');
}
... 
```

我创建了单独的 ThinRoute 类：

```
...
App.ThinRoute = Ember.Route.extend({
... 
```

所以路线的定义非常简单：

```
...
root: Ember.Route.extend({
index: App.ThinRoute.extend({
  route: '/',
}),
dir: App.ThinRoute.extend({
  route: '/dir',
})
})
... 
```

请看一下示例：[jsfiddle](http://jsfiddle.net/musashimm/M7vKW/)。

# c# - 在 c# 中使用正则表达式提取部分文本

> ID：11621614
> 
> 赞同：1
> 
> 时间：2012-07-23T22:46:30.973
> 
> 标签：c#, java, regex

在 Java 中，我可以简单地使用 Regex 提取部分代码或文本，但在 C# 中，我不确定如何做到这一点。例如：

```
Pattern p = Pattern.compile("(.*?)b(.*?)d(.*?)", Pattern.DOTALL|Pattern.MULTILINE);
Matcher matcher = p.matcher("abcde");
System.out.println(matcher.group(1));   //c 
```

我在 C# 中找到了很多关于正则表达式的教程，但我发现没有办法做这样简单的事情。但它必须适用于各种类型和数量的文本、数字、符号等，以便我可以使用它来提取部分 HTML 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:19:12.283

首先。您在 java 中的代码不能按原样工作。

正确的代码（已测试）：

```
Pattern p = Pattern.compile("(.*?)b(.*?)d(.*?)", Pattern.DOTALL|Pattern.MULTILINE);
Matcher matcher = p.matcher("abcde");
if (matcher.find())  // Without this test: [Exception in thread "main" java.lang.IllegalStateException: No match found]
  System.out.println(matcher.group(2));   //c     <--2 instead of 1 
```

在 C# 中等效（已测试）：

```
Regex r = new Regex("(.*?)b(.*?)d(.*?)", RegexOptions.Singleline | RegexOptions.Multiline);
Match matcher = r.Match("abcde");
Console.WriteLine(matcher.Groups[2]);   //c 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:10:16.393

```
Regex rx = new Regex("(.*?)b(.*?)d(.*?)");
Match match = rx.Match("abcde");
string found = match.Value; 
```

# java - Thread.currentThread() 是否总是返回相同的实例？

> ID：11621615
> 
> 赞同：0
> 
> 时间：2012-07-23T22:46:34.150
> 
> 标签：java, multithreading, map

我可以`ConcurrentHashMap<Thread, object>`存储线程的数据并用于`Thread.currentThread()`检索它吗？我检查了 Java 源代码，发现它`currentThread()`是原生的并且`equals`没有被覆盖。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T22:49:46.723

你可以，但是有一个内置机制[ThreadLocal](http://docs.oracle.com/javase/7/docs/api/java/lang/ThreadLocal.html)就是为了这个目的。重新发明它的唯一原因是，如果您还需要从它们的“所有者”以外的某个线程访问这些值以操纵它们。

```
 ThreadLocal<Object> data = new ThreadLocal<Object>();

  public Object getData() {
      return this.data.get();
  }

  public void setData(Object data) {
      this.data.set(data);
  } 
```

请注意，每个线程的初始值为 null，但您可以提供默认值：

```
 ThreadLocal<Object> data = new ThreadLocal<Object>() {
      protected Object initialValue() { return "foo"; }
  }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:49:41.570

是的，你总是会得到相同的`Thread`对象，所以你可以这样做。

但是，与其自己制作这样的表，不如考虑使用该[`ThreadLocal`](http://docs.oracle.com/javase/6/docs/api/java/lang/ThreadLocal.html)功能，它本质上是做同样的事情，但具有特定的初始化语义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T22:52:14.053

您可以，但这种方法的问题是您正在创建对线程的硬引用，这意味着即使线程终止，它引用的对象也不会被 GC 收集。

# entity-framework - EF5 - 来自存储过程的多个记录集？

> ID：11621617
> 
> 赞同：0
> 
> 时间：2012-07-23T22:46:46.833
> 
> 标签：entity-framework

我能找到的关于使用多个记录集的最佳信息是[Walkthrough: Multiple Result Sets from Stored Procedure (June CTP)](http://blogs.msdn.com/b/adonet/archive/2011/06/30/walkthrough-multiple-result-sets-from-stored-procedure.aspx)。

但是，对于当前的 EF5 ( [RC1](http://blogs.msdn.com/b/adonet/archive/2012/05/15/ef5-release-candidate-available-on-nuget.aspx) )，对 EDMX 文件的建议编辑 - 添加元素等不起作用。XML 验证失败，设计器不会加载它。

[CodePlex](http://entityframework.codeplex.com/)上的源代码仍然包含名为“Customer With Recent Orders”的存储过程，但它没有在任何地方映射或使用！

我在 .NET 4.0 上使用 VS2010。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:48:00.283

原来我的 EDMX 设置为 2.0 版本，而且只有 3.0 版本才支持。这意味着它仅在 .NET 4.5 上运行时适用于 EF。

我想我还得再等一两个星期。

# sql - SQL累计值

> ID：11621618
> 
> 赞同：3
> 
> 时间：2012-07-23T22:46:49.730
> 
> 标签：sql, sql-server, sql-server-2008

我正在编写一个 SQLServer 2008 存储过程，它采用一个付款表并尝试根据相关表中描述的一组规则（基本上是一组存储桶）分配这些付款。然而，分配（将支付价值放入桶中）是目前让我头疼的原因。

假设表 Payments 包含要支付的值，而表 Buckets 就是关于应该在每个桶中放入多少，直到要支付的初始值用尽（达到 0）。

使用下表作为示例（实际用例有点做作，因为有一些复杂的标准可以选择适合每次付款的存储桶）：

```
PaymentId     Value                 BucketId       MaxAmount
--------------------------          --------------------------------
1             16.5                  1              5.5
2             7.0                   2              10
                                    3              8.3 
```

对于付款 1：5.5 单位（该桶的最大值）应放入桶 1，10 单位应放入桶 2（11.5 是桶 1 的剩余部分，但仍超过桶 2 的最大值）和 1 单位（16.5 - 5.5 - 10 ) 应放入存储桶 3。对所有付款重复此操作。

这很容易用任何命令式语言实现，甚至可能在带有 for/while 循环的 SQL 中实现，但我试图意识到是否有更好的方法（即使它是不可移植的并且特定于 SQLServer 2005+）。

我已经进行了一些研究（主要是递归 CTE），但没有什么真正出色的东西浮现在脑海中。我敢肯定有很多 StackOverflowers 使用 SQL-fu 从他们的头脑中回答这个问题，所以我想把它放在那里看看......

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T04:30:48.543

将您的存储桶表放入临时表中，然后有一个称为运行总计的额外列。这将具有此连接之前的运行总计，然后交叉连接支付和临时存储桶表，并指定支付 <= 运行总计在临时存储桶表中的条件。这应该可以解决您的问题。***感谢他，我使用 Mafu Josh 的 DDL 创建了以下查询***。我希望 OP 应该总是发布这些东西，让其他人的生活更轻松。

**看起来buckte表很小。但是如果它是非常大的表。然后使用带变量的更新来生成运行总计。这比下面的方法更有效。对我来说，听起来这个表或多或少是静态的表，因此您可以将运行总计作为表本身的一部分。**

```
 DECLARE @Buckets TABLE ( 
    BucketId INT, 
    MaxAmount DECIMAL(18,6) 
) 

INSERT INTO @Buckets VALUES (1, 5.5) 
INSERT INTO @Buckets VALUES (2, 10) 
INSERT INTO @Buckets VALUES (3, 8.3) 

DECLARE @Payments TABLE ( 
    PaymentId INT, 
    Value DECIMAL(18,6) 
) 

INSERT INTO @Payments VALUES (1,16.5) 
INSERT INTO @Payments VALUES (2,7.0) 
INSERT INTO @Payments VALUES (3,23.8) 

DECLARE @tempBuckets TABLE ( 
    BucketId INT, 
    MaxAmount DECIMAL(18,6) ,
    currentruntotal decimal(18,6)
) 
insert into @tempBuckets select bucketid,maxamount ,(select SUM(maxamount) from @Buckets bin where b.bucketid >=bin.bucketid)
--,isnull((select SUM(maxamount) from @Buckets bin where b.bucketid > bin.bucketid),0)
from @Buckets b

select * from @tempBuckets
select PaymentId,Value,BucketId,
case when p.Value >= tb.currentruntotal then tb.MaxAmount else p.Value - tb.currentruntotal + tb.MaxAmount end as bucketamount
from @Payments p inner join @tempBuckets tb on  (p.Value >= tb.currentruntotal or p.Value between tb.currentruntotal - tb.MaxAmount and tb.currentruntotal )
order by PaymentId
go 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T23:53:24.010

我不使用游标的尝试：

```
DECLARE @Buckets TABLE (
    BucketId INT,
    MaxAmount DECIMAL(18,6)
)

INSERT INTO @Buckets VALUES (1, 5.5)
INSERT INTO @Buckets VALUES (2, 10)
INSERT INTO @Buckets VALUES (3, 8.3)

DECLARE @Payments TABLE (
    PaymentId INT,
    Value DECIMAL(18,6)
)

INSERT INTO @Payments VALUES (1,16.5)
INSERT INTO @Payments VALUES (2,7.0)

SELECT
  P1.PaymentId
, P1.Value as TotalPayment
, B4.BucketId
, B4.MaxAmount
, CASE WHEN B3.BucketId = B4.BucketId THEN P1.Value - MaxAmountRunningTotalOfPreviousBuckets ELSE B4.MaxAmount END AS BucketPaymentAmount
FROM @Payments P1
INNER JOIN (
    SELECT
      B2.BucketId
    , B2.MaxAmount as BucketMaxAmount
    , SUM(B1.MaxAmount) - B2.MaxAmount as MaxAmountRunningTotalOfPreviousBuckets
    FROM @Buckets B1
    INNER JOIN @Buckets B2
      ON B1.BucketId <= B2.BucketId
    GROUP BY B2.BucketId, B2.MaxAmount
  ) AS B3
  ON P1.Value > B3.MaxAmountRunningTotalOfPreviousBuckets AND P1.Value <= (B3.MaxAmountRunningTotalOfPreviousBuckets + BucketMaxAmount)
INNER JOIN @Buckets B4
  ON B4.BucketId <= B3.BucketId
ORDER BY P1.PaymentId, B3.BucketId 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T07:20:02.373

这是适合您的递归 CTE 方法：

```
WITH BucketsRanked AS (
  SELECT *, rnk = ROW_NUMBER() OVER (ORDER BY BucketId) FROM Buckets
)
, PaymentsRanked AS (
  SELECT *, rnk = ROW_NUMBER() OVER (ORDER BY PaymentId) FROM Payments
)
, PaymentsDistributed AS (
  SELECT
    b.BucketId,
    p.PaymentId,
    Bucket        = b.MaxAmount,
    Payment       = p.Value,
    BucketRnk     = b.rnk,
    PaymentRnk    = p.rnk,
    BucketPayment = CASE
                      WHEN p.Value > b.MaxAmount
                      THEN b.MaxAmount
                      ELSE p.Value
                    END,
    CarryOver     = p.Value - b.MaxAmount
  FROM
    BucketsRanked b,
    PaymentsRanked p
  WHERE b.rnk = 1 AND p.rnk = 1
  UNION ALL
  SELECT
    b.BucketId,
    p.PaymentId,
    Bucket        = b.MaxAmount,
    Payment       = p.Value,
    BucketRnk     = b.rnk,
    PaymentRnk    = p.rnk,
    BucketPayment = CASE
                      WHEN x.PaymentValue > x.BucketValue
                      THEN x.BucketValue
                      ELSE x.PaymentValue
                    END,
    CarryOver     = x.PaymentValue - x.BucketValue
  FROM PaymentsDistributed d
    INNER JOIN BucketsRanked  b
      ON b.rnk = d.BucketRnk  + CASE SIGN(CarryOver) WHEN -1 THEN 0 ELSE 1 END
    INNER JOIN PaymentsRanked p
      ON p.rnk = d.PaymentRnk + CASE SIGN(CarryOver) WHEN +1 THEN 0 ELSE 1 END
    CROSS APPLY (
      SELECT
        CONVERT(
          decimal(18,6),
          CASE SIGN(CarryOver) WHEN -1 THEN -d.CarryOver ELSE b.MaxAmount END
        ),
        CONVERT(
          decimal(18,6),
          CASE SIGN(CarryOver) WHEN +1 THEN +d.CarryOver ELSE p.Value     END
        )
    ) x (BucketValue, PaymentValue)
)
SELECT
  BucketId,
  PaymentId,
  Bucket,
  Payment,
  BucketPayment
FROM PaymentsDistributed
; 
```

基本上，这个查询接受第一笔付款和第一个桶，找出哪个少并产生第一个`BucketPayment`项目。支付值和桶容量之间的差值会被记住，以便在下一次迭代中使用。

在下一次迭代中，差额（取决于其符号）被用作存储桶金额或付款。此外，根据差异的符号，查询要么从`Payments`表中获取下一笔付款，要么从`Buckets`. （但如果差值为 0，则查询实际上检索下一笔付款和下一个桶。）然后将与第一次迭代相同的逻辑应用于新的桶金额和付款值。

迭代一直持续到没有更多的桶或没有更多的付款为止。或者直到达到默认的 MAXRECURSION 值 100，在这种情况下，您可能需要追加

```
OPTION (MAXRECURSION *n*)
```

对于上述查询，其中*`n`*必须是最大为 32767 的非负整数，指定最大迭代次数（递归）。（请注意，`0`这实际上代表*无限*。）

[您可以在 SQL Fiddle](http://sqlfiddle.com/#!3/b1e6a/2)尝试此查询。

# python - 我可以让在 cmd 控制台中获取标志或变量的 py2exe 可执行吗

> ID：11621620
> 
> 赞同：0
> 
> 时间：2012-07-23T22:46:51.343
> 
> 标签：python, cmd

我想知道是否有一种方法可以制作一个 python 脚本，在转换为 exe 后，py2exe 可以在 cmd 控制台中使用标志或输入变量我解释自己，一些 .exe 在 cmd windows 中使用shell 带有这样的标志或变量：

```
myexe -v flagValue variable 
```

所以我的问题是我应该使用哪个模块，或者当使用 py2exe 生成时，我的 python 脚本应该如何处理这样的事情？也许还有添加 py2exeSetup.py 的选项？

如果有人知道如何获得这样一个脚本的回报，我也很乐意接受：D

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T00:50:55.947

任何你想让你的程序做的事情，它都可以在变成 Windows 可执行文件后做。要读取命令行参数，请使用`argparse`stdlib 模块，或者如果您必须使用 Pythons < 2.7 运行，`optparse`.

# sql-server - 从 varchar 列中删除前导“副本”字符串

> ID：11621621
> 
> 赞同：0
> 
> 时间：2012-07-23T22:47:09.970
> 
> 标签：sql-server, sql-server-2008

在我的表中，我想从`Title`列中删除前 7 个字符。

我有一个如下表，我想删除`'Copy of'`前缀：

```
Title
---------------------
Copy ofthis is tile1
Copy ofthis is another tile2 
```

我试过这个：

```
Update MyTable SET Title=(SELECT RIGHT(Title,LEN(Title)- 7) AS Title) 
  WHERE Title LIKE 'Copy of%' 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:51:26.783

你不需要子查询，通常你不需要检查长度来确定输出应该有多长。假设这不是`varchar(max)`，你可以这样做：

```
UPDATE dbo.MyTable
  SET Title = SUBSTRING(Title, 8, 8000)
  WHERE Title LIKE 'Copy of%'; 
```

或者你可以这样做：

```
UPDATE dbo.MyTable
  SET Title = STUFF(Title, 1, 7, '')
  WHERE Title LIKE 'Copy of%'; 
```

`LTRIM()`如果值是`'Copy of something'`并且您不想要前导空格，您可能还想使用：

```
UPDATE dbo.MyTable
  SET Title = LTRIM(STUFF(Title, 1, 7, ''))
  WHERE Title LIKE 'Copy of%'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:51:48.653

您需要 SUBSTRING 功能。

```
update mytable set value = substring  ( value, 8, len (value) )
where value like 'copy of%' 
```

# git - 包含实际存储库的 Git 存档？

> ID：11621623
> 
> 赞同：7
> 
> 时间：2012-07-23T22:47:21.837
> 
> 标签：git, git-archive

我需要创建我的 Git 项目的存档，忽略并遗漏由 指定的文件`.gitignore`，但包括实际的`.git`存储库文件夹。简单地运行`git archive master`会留下`.git`文件夹。

有没有办法让`git archive`包含`.git`文件夹但仍然忽略指定的文件`.gitignore`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-23T22:56:18.263

由于`git archive`只生成一个 tar 存档，因此您可以`tar`直接使用该文件。

```
$ git archive HEAD > tar.tar
$ tar -rf tar.tar .git 
```

tar 的`-r`选项将给定的文件附加到正在处理的档案中（在 之后指定`-f`）。检查 tar 的手册页以获取 tar 具有的令人生畏的功能列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T00:18:01.673

看起来像做类似的事情

```
# copy over all project files except for those ignored
git clone /path/to/repository /path/to/output 
# create a tar.gz archive of the project location
tar czvf projectExport.tar.gz /path/to/output
# remove the cloned directory
rm -fr /path/to/output 
```

完成工作。这不是世界上最漂亮的解决方案，但它看起来很有效。

# ruby - 在 Ruby 中加载一个输入文件，这是 Ruby 的一个轻微变体

> ID：11621626
> 
> 赞同：0
> 
> 时间：2012-07-23T22:47:36.610
> 
> 标签：ruby, input, metaprogramming, dsl

有没有一种方法可以将用户定义的 Ruby 输入文件加载到我的应用程序中，从而可以访问输入文件中定义的任何变量、方法和类？示例输入文件可能如下所示：

```
def my_callback(t)
    t ** 2
end
parameter_x = "10 bytes"
parameter_y = my_callback 
```

在我的应用程序中，我想做如下的事情：

```
input = load_input_file
puts input.parameter_x     # => "10 bytes"
puts input.parameter_y(2)  # => 4 
```

如果无法将输入文件加载到对象的命名空间中，那么下一个最好的方法是对变量进行本地访问（只要它们不是全局可见的）：

```
load_input_file
puts parameter_x     # => "10 bytes"
puts parameter_y(2)  # => 4 
```

这可能吗（无需手动解析输入文件）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:41:36.677

我认为这些是您的选择：

### 1.`module`环绕`input.rb`：

```
module Input
  CONST = 1
  def meth
   ...
end 
```

但是您的用户将需要添加：`module Input`并`end`围绕他们的代码。（要求不要太多，是吗？）

### 2\. 字符串化

根据您自己的建议：Strinigfy`input.rb`文件，用模块包装它，并将局部变量更改为 ivars，然后将其输出到`input_modified.rb`文件中：

在这种情况下，如果您告诉您的用户`@`在他们的变量声明之前添加一个会更容易。

```
require 'fileutils'
require 'tempfile'

inp = 'input.rb'
oup = 'input_modified.rb'
out = Tempfile.new('temp.txt')

File.open(inp, 'r') do |file|
  out.puts "module Input\n" + file.read.gsub("\n","\n\s") + "\nend"
end
FileUtils.mv out.path, oup 
```

# javascript - 测试变量是否为数组的最佳方法

> ID：11621632
> 
> 赞同：1
> 
> 时间：2012-07-23T22:48:12.667
> 
> 标签：javascript

> **可能重复：**
> [如何检测变量是否为数组](https://stackoverflow.com/questions/1058427/how-to-detect-if-a-variable-is-an-array)

当我需要测试变量是否为数组时（例如，函数中的输入参数可能是对象或数组），我通常使用这段代码

```
typeof(myVar) === 'object' && myVar.length !== undefined; 
```

这是正确的方法还是有更有效的方法，考虑到即使 `myVar instanceof Array` [更快](http://jsperf.com/js-array-test)，也应该避免由于`iframe`问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T22:54:42.217

[`Array.isArray`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/isArray)现在可以在[ECMAScript 5](http://es5.github.com/#x15.4.3.2)中使用，因此您可以将它与[旧浏览器的](http://kangax.github.com/es5-compat-table/)[polyfill](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/isArray)一起使用：

```
if(!Array.isArray) {
  Array.isArray = function (vArg) {
    return Object.prototype.toString.call(vArg) === "[object Array]";
  };
}

Array.isArray(myVar); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:50:49.937

“iframe 问题”可以简单地通过不为框架和数组使用相同的名称来避免。在我看来，这并不难。也就是说，我从来不需要断言某事是否是大批...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T22:50:53.537

如果您已经在代码中使用 jQuery，则可以使用 jQuery.isArray()。这是文档：

[http://api.jquery.com/jQuery.isArray/](http://api.jquery.com/jQuery.isArray/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T22:59:42.367

你可以试试—— Object.prototype.toString.call
一个例子——

```
var a = [1,2]
console.log(Object.prototype.toString.call(a)) 
```

这将返回 [object Array]
可以通过以下方式使用字符串切片方法进行检查

```
console.log(Object.prototype.toString.call(a).slice(8,-1)) <br /> 
```

返回“数组”

```
var a = [1,2]
console.log(Object.prototype.toString.call(a).slice(8,-1) == "Array") // true 
```

# bash - 迭代数组内容时如何显示名称中带有空格的文件

> ID：11621633
> 
> 赞同：0
> 
> 时间：2012-07-23T22:48:14.353
> 
> 标签：bash

我编写了一个简单的脚本来检查 zip 文件的内容与控制文件的内容。

它运行良好，但是当我收到其中包含空格的文件时，它会因错误而失败（实际上并不存在）。这是我的代码片段（`name`是为批量处理 ZIP 文件而创建的数组）。

```
echo "`date '+%m/%d/%y %T:'` List ZIP file contents."                                          
LIST_Array=(`/usr/bin/unzip -l $name | head -n -2|tail -n +4 | sort -r | awk '{print $4}'`)
LISTlen=${#LIST_Array[*]}
#iterate array to 1) build report and 2) look for control file
echo "`date '+%m/%d/%y %T:'` Iterate array to 1) build report and 2) look for control files."  
echo -e "`date '+%m/%d/%y %T:'` Files in ZIP file: $name\n"                                    >> $name.report.out
for (( i = 0 ; i < ${#LIST_Array[@]} ; i++ ))
do
    echo -e "${LIST_Array[$i]}"      >> $name.report.out
done 
```

ZIP 中的文件列表被捕获`$name.report.out`，然后与控制文件本身的内容进行比较。

如何正确显示带空格的文件？我虽然`echo -e`会有所帮助，但似乎没有效果。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:02:18.547

所以 zip 文件中有一些文件，其中一些文件的名称中有空格。在这种情况下，当您列出文件时， awk '{ print $4 }' 不会捕获整个文件名。`read`很好，因为它的最后一个参数捕获了该行的其余部分：

```
LIST_Array=()
while read length date time filename; do
    LIST_Array+=( "$filename" )
done < <(/usr/bin/unzip -qql "$name") 
```

# ajax - Ajax 第二次请求失败

> ID：11621635
> 
> 赞同：0
> 
> 时间：2012-07-23T22:48:22.133
> 
> 标签：ajax, asp.net-mvc-4

我想下一步更新一些 div 块->
我的更新视图：

```
 @Ajax.ActionLink("Show",
             "About",
             new AjaxOptions
             {
                 HttpMethod = "POST",
                 InsertionMode = InsertionMode.Replace,
                 UpdateTargetId = "updateMe"
             })
     <div id="updateMe"> </div> 
```

我的控制器：

```
 int count  = 0;

    public ActionResult Index()
    {
        return View();
    }

    [HttpPost]
    public ActionResult About()
    {

        if (Request.IsAjaxRequest())
        {   
            count++;
            ViewBag.count  = count;
            return PartialView();
        }
        return RedirectToAction("Index");
    } 
```

我的部分视图：

```
 <h1>Hellow from Partial View !  @ViewBag.count </h1> 
```

我也在 .config 文件中有这个

```
 <add key="UnobtrusiveJavaScriptEnabled" value="true" /> 
```

和引用的库：

```
<script src="@Url.Content("~/Scripts/jquery-1.6.2.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script> 
```

预期：第一次点击：
局部视图中的 Hellow！1

第二：
局部视图你好！2

有：从局部视图你好！1

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T15:39:21.717

每次请求都会再次初始化该类`Controller`，因此每次都会`count`重新初始化您的字段的值。你会想要“全球”拥有这个。一种方法是将其定义为`static`字段；但请注意，这可能会有一些意外行为（如[ASP.NET MVC 中的静态字段](https://stackoverflow.com/questions/5661202/static-field-in-asp-net-mvc)）。

# coding-style - 如何使用带有复合函数头的花括号样式？

> ID：11621636
> 
> 赞同：0
> 
> 时间：2012-07-23T22:48:21.887
> 
> 标签：coding-style, curly-braces

我正在尝试将自己调整为将大括号与它们所属的语句放在同一行的风格。通常它看起来不错：

```
void foo(){
    //code
} 
```

但是当函数头是复合的，并且在参数列表之后有代码时，它开始看起来有点令人不安：

```
void foo() throws Exception{
    //code
} 
```

当它变得很长你需要打破它时，它看起来很糟糕：

```
void foo(int arg1,boolean arg2) throws ThisException,
                                       ThatException,
                                       AnotherException{
    //code
} 
```

当然，复合函数头在他们自己的大括号样式中仍然看起来很优雅，但我想保持一致的编码风格。

同线风格的其他用户如何处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:08:54.067

你真的在寻找开口支架吗？我看到函数的名称并扫描右括号。左大括号只是样板

此外，有了空格，一切都会变得更好；）

```
void foo() throws Exception { 
```

# mysql - 距离+关键词搜索解决方案

> ID：11621637
> 
> 赞同：3
> 
> 时间：2012-07-23T22:48:30.890
> 
> 标签：mysql, search, text, properties, geolocation

对于房地产网站，我需要实现一种搜索机制，允许搜索文本和距离。*当纬度和经度记录在单独的列中时，在**MySQL*表
上进行距离计算很容易，但房子往往有**很多**属性。****`true/false`****

 ****我需要将所有这些字段存储在数据库中，因为它们需要是可编辑的，因此我打算使用一个简单的表，例如`| houseID | property |`在其中存储所有为真（设置）的属性。

这将使我免于制作一个包含数百列的可笑的宽表，但是搜索这个数据库并不是很可行。

我曾考虑`text`在每个房屋的主记录中添加一列类型，其中包含所有`true`属性的字段名。然后我会搜索`human`文本描述和那个文本列，但我觉得这仍然不是最好的方法。

我怎样才能以干净的方式解决这个问题？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:12:40.287

我会推荐存储数据的`Entity Attribute Value`or`EAV`模型。[http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)（这是 Wordpress 帖子和帖子元的工作方式）。

所以假设表格如下：

```
ENTITY_TABLE: (id,title,author,content,date_created,date_modified)
ATTRIBUTE_TABLE: (id, entity_id, akey, avalue) 
```

使用这样的查询：

```
SELECT e.*, 
    MAX( IF(m.akey= 'has_ac', m.avalue, 0) ) as 'has_ac', 
    MAX( IF(m.akey= 'has_garage', m.avalue, 0) ) as 'has_garage', 
    MAX( IF(m.akey= 'has_fridge', m.avalue, 0) ) as 'has_fridge', 
    MAX( IF(m.akey= 'latitude', m.avalue, 0) ) as 'latitude', 
    MAX( IF(m.akey= 'longitude', m.avalue, 0) ) as 'longitude'
FROM ENTITY_TABLE e
JOIN ATTRIBUTE_TABLE m ON e.id = m.entity_id
WHERE has_ac=1 
```

这将选择实体及其相关属性（has_ac、has_garage、has_fridge、纬度和经度），并要求所有选择的实体的 has_ac 等于 1（真）

现在是地理的东西：

```
SELECT e.*, 
    MAX( IF(m.akey= 'has_ac', m.avalue, 0) ) as 'has_ac', 
    MAX( IF(m.akey= 'has_garage', m.avalue, 0) ) as 'has_garage', 
    MAX( IF(m.akey= 'has_fridge', m.avalue, 0) ) as 'has_fridge', 
    MAX( IF(m.akey= 'latitude', m.avalue, 0) ) as 'latitude', 
    MAX( IF(m.akey= 'longitude', m.avalue, 0) ) as 'longitude',
    (
        3959 * 
        acos(
            cos( radians( MAX( IF(m.akey= 'latitude', m.avalue, 0) ) ) ) * 
            cos( radians( CUSTOMER_LAT ) ) * 
            cos( radians( CUSTOMER_LONG ) - radians( MAX( IF(m.akey= 'longitude', m.avalue, 0) ) ) ) + 
            sin( radians( MAX( IF(m.akey= 'latitude', m.avalue, 0) ) ) ) * 
            sin( radians( CUSTOMER_LAT ) ) 
        ) 
    ) AS distance
FROM ENTITY_TABLE e
JOIN ATTRIBUTE_TABLE m ON e.id = m.entity_id
WHERE has_ac=1
ORDER BY distance ASC 
```****

# oracle - 如何从 Java 类调用不带参数的过程作为表类型

> ID：11621638
> 
> 赞同：6
> 
> 时间：2012-07-23T22:48:33.887
> 
> 标签：oracle, jdbc, plsql, oracle11g

我想从 Java 代码调用`get_data_Q1`包中的这个过程并显示输出：`ult_pkg`

```
CREATE OR REPLACE PACKAGE  ult_pkg
AS
TYPE t_all_record is record (
    x_object_type_id        number,
    x_object_name           varchar2(100),
    x_object_id             varchar2(70),
    x_audit_timestamp       timestamp(6),
    x_payload               clob
);

--table type to hold table data after querying

type tt_all_tab is table of t_all_record index by binary_integer;

--declaration pocedures
procedure get_data_Q1(x_object_id in varchar2 , x_all_type out tt_all_tab );

end ult_pkg;

/

--body of 'ult_pkg'  package
create or replace package body ult_pkg 
AS

    --procedure taking 'object_id' as input parameter and gives out table of 't_all_record' type 
    procedure get_data_Q1(x_object_id in varchar2 , x_all_type out tt_all_tab )
    AS

        i number:=0;
    begin

    for r in 
        ( 
            SELECT
            O.object_type_id,O.object_name,O.object_id,A.audit_timestamp,P.payload
            FROM
            APPLICATION APP, EXCEPTIONS E,MASTER_AUDIT A,MODULE_TYPE M,OBJECT_TYPE O,PAYLOAD P 
            WHERE 
            ( A.MODULE_TYPE_ID = M.MODULE_TYPE_ID ) AND ( M.APPLICATION_ID = APP.APPLICATION_ID ) AND ( A.OBJECT_TYPE_ID = O.OBJECT_TYPE_ID ) AND ( O.OBJECT_ID = x_object_id )
        )
    -- loop to asign the data from cursor 'r' to carasponding table type columns
        loop

        x_all_type(i).x_object_type_id:=r.object_type_id;
        x_all_type(i).x_object_name:=r.object_name;
        x_all_type(i).x_object_id:=r.object_id;
        x_all_type(i).x_audit_timestamp:=r.audit_timestamp;
        x_all_type(i).x_payload:=r.payload;
        i:=i+1;
        end loop;

    end get_data_Q1;
end ult_pkg;
/ 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-24T12:19:17.457

这是不可能的，请参阅[Accessing PL/SQL Index-by Tables](http://docs.oracle.com/cd/B28359_01/java.111/b31224/oraint.htm#BABBGDFA)：

> Oracle JDBC 不支持将 RAW、DATE 和 PL/SQL RECORD 作为元素类型。

我可能会像这样使用自定义（全局，而不是包）对象类型：

```
CREATE TYPE t_all_record AS OBJECT (
  x_object_type_id        number,
    x_object_name           varchar2(100),
    x_object_id             varchar2(70),
    x_audit_timestamp       timestamp(6),
    x_payload               clob
)
/
CREATE TYPE t_all_records IS TABLE OF t_all_record
/ 
```

引用包中的类型表（t_all_records 而不是 tt_all_tab）并像这样填写

```
procedure get_data_Q1(x_object_id in varchar2 , x_all_type out t_all_records )
AS
begin
    SELECT t_all_record(O.object_type_id,O.object_name,O.object_id,A.audit_timestamp,P.payload)
    BULK COLLECT INTO x_all_type
    FROM APPLICATION APP, EXCEPTIONS E,MASTER_AUDIT A,MODULE_TYPE M,OBJECT_TYPE O,PAYLOAD P 
    WHERE ( A.MODULE_TYPE_ID = M.MODULE_TYPE_ID ) AND ( M.APPLICATION_ID = APP.APPLICATION_ID ) AND ( A.OBJECT_TYPE_ID = O.OBJECT_TYPE_ID ) AND ( O.OBJECT_ID = x_object_id )
end get_data_Q1; 
```

结果将可以从 java 中使用，如下所示：

```
package tests.jdbc;

import java.sql.Array;
import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSetMetaData;
import java.sql.Struct;
import java.sql.Types;

import oracle.sql.StructDescriptor;

public class OracleTableOfResult {
    public static void main(String...a) throws Exception {
        Class.forName("oracle.jdbc.OracleDriver");
        Connection connection = DriverManager.getConnection("jdbc:oracle:thin:<USER>/<PASS>@<DATABASEHOST>:1521:<SERVICE>");

        final String typeName = "T_ALL_RECORD";
        final String typeTableName = "T_ALL_RECORDS";

        // Get a description of your type (Oracle specific)
        final StructDescriptor structDescriptor = StructDescriptor.createDescriptor(typeName.toUpperCase(), connection);        
        final ResultSetMetaData metaData = structDescriptor.getMetaData();

        // Call the procedure (or whatever else) that returns the table of a custom type
        CallableStatement cs = connection.prepareCall("{call ult_pkg.get_data_Q1(?, ?)}");
        cs.setString(1, "the_id");
        // Result is an java.sql.Array...
        cs.registerOutParameter(2, Types.ARRAY, typeTableName);     
        cs.execute();

        // ...who's elements are java.sql.Structs
        Object[] data = (Object[]) ((Array) cs.getObject(2)).getArray();
        for(Object tmp : data) {
            Struct row = (Struct) tmp;
            // Attributes are index 1 based...
            int idx = 1;
            for(Object attribute : row.getAttributes()) {               
                System.out.println(metaData.getColumnName(idx) + " = " + attribute);                                            
                ++idx;
            }
            System.out.println("---");
        }
        cs.close();     
        connection.close();
    }
} 
```

但最后，当您可以在普通 sql 语句中使用查询作为准备好的语句时，是否值得付出努力是值得怀疑的……

# linux - 如何在shell脚本中扩展相对路径

> ID：11621639
> 
> 赞同：39
> 
> 时间：2012-07-23T22:48:36.613
> 
> 标签：linux, bash

我正在编写一个脚本来使用 bash 在 linux 2.6 上设置环境变量。所以脚本包含如下命令：

```
export SRC_DIR=..
export LIBPATH=${SRC_DIR}/lib 
```

问题是，当我尝试执行 echo $LIBPATH 时，它显示“../lib”，而不是将 SRC_DIR 扩展到完整路径。我真的希望脚本打印 /home/x/lib 之类的东西，而不是 ../lib。

更新脚本应该将 SRC_DIR 评估为从脚本位置向上的一个目录，而不是调用脚本的当前目录

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-07-23T23:01:34.263

### Change Directory in Subshell

There's a little trick you can use to get the absolute path from a relative path without changing the present working directory. The trick is to move to the relative path in a subshell, and then expand the working directory. For example:

```
export SRC_DIR=$(cd ..; pwd) 
```

### Relative Paths from Script Instead of Invocation Directory

To change to a relative path from a script's location, rather than the current working directory, you can use a [parameter expansion](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion) or the *dirname* utility. I prefer *dirname*, since it's a little more explicit. Here are both examples.

```
# Using /usr/bin/dirname.
export SRC_DIR=$(cd "$(dirname "$0")/.."; pwd)

# Using the "remove matching suffix pattern" parameter expansion.
export SRC_DIR=$(cd "${0%/*}/.."; pwd) 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-02-10T21:10:07.597

该`readlink`命令不仅能够解析符号链接，还能够规范化相对路径。请小心，因为您可能不希望在所有脚本中解析符号链接的行为。如果您不想解析符号链接，`pwd`那将是最好的；注意子shell的使用，所以cd命令不会影响主shell中的工作目录。

```
# The path you want to get information on... (for readability)
your_path=..

# Using /bin/readlink (resolves symlinks)
export SRC_DIR=$(readlink --canonicalize $your_path)

# Using /usr/bin/dirname (keeps symlinks)
export SRC_DIR=$(cd $your_path ; pwd) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-23T23:17:00.953

我通常使用

```
SCRIPT_DIR=$(readlink -f ${0%/*}) 
```

它应该返回脚本的完整路径，甚至可以解析所有的链接。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-05-23T10:38:28.127

挖掘这个旧线程以添加我发现效果很好的内容：

导出 SRC_DIR = `realpath ..`

在此处查看更多信息：

[http://man7.org/linux/man-pages/man3/realpath.3.html](http://man7.org/linux/man-pages/man3/realpath.3.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-09T06:49:39.043

当我这样做时，我像这样使用 echo：

```
export SRC_DIR=`echo $HOME/bin/` 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-23T22:51:49.200

改为这样做：

```
export SRC_DIR=`pwd`; 
```

**更新：**

由于您想要相对于文件系统上脚本位置的路径，请改用：

```
export SRC_DIR=`dirname $0` 
```

**更新2：**

您的脚本必须直接调用，而不是作为`bash /path/to/script.sh`or `source foo.sh`。添加[shebang 行](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)，添加执行权限并直接调用脚本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-17T14:00:47.797

为了保留错误代码：

```
function getPwd() {
    $(cd $1; [[ $? -ne 0 ]] && exit 1 || echo echo $PWD;)
    return $?
} 
```

# c# - 如何在具有特定字典值的列表中返回对象值

> ID：11621640
> 
> 赞同：0
> 
> 时间：2012-07-23T22:48:47.913
> 
> 标签：c#, dictionary

假设我有一个对象：

```
public class Person
{
   public IDictionary<string, string> RoleTypes { get; set; }
} 
```

其中角色类型以名称作为键，以描述作为值：

*   经理：做事的经理
*   CIO：谁知道他们在做什么
*   CEO：没有人知道他们在做什么。

所以现在我说了一个人员列表：

IE无数人；

我想以某种方式从该列表中找回作为 CEO 的人：

```
people.Single(x => x.RoleTypes.Contains("CEO")); 
```

好吧，这甚至没有编译。

有谁知道如何让它工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T22:50:47.207

您必须检查键（如果标题是字典的键）：

```
people.Single(x => x.RoleTypes.ContainsKey("CEO")); 
```

话虽如此，这种数据组织结构很奇怪——将标题和描述分开会更有意义，这样它们就不会在每个人中重复。用户可以只维护他们的标题列表，并且可以在其他地方查找该标题的描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:02:45.657

TryGetValue(key) 不这样做吗？

# c++ - 解析 XML 中 C/C++ 头文件中定义的嵌套结构/联合

> ID：11621641
> 
> 赞同：0
> 
> 时间：2012-07-23T22:48:51.060
> 
> 标签：c++, c, visual-c++

我有一个表示如下的结构：（示例）

```
struct struct3
{
   struct structchild4
   {  
      float child5;
   } child6;
   unsigned int child7;
}; 
```

我希望它在 XML 中表示如下：

```
<tag1= "struct3">
        <name>struct3</name>
        <input_type>byte</input_type>
        <method></method>
        <tag_ref = "structchild4">
            <name>child6</name>
        </tag_ref>
        <tag2= "child7">
            <name>child7</name>
            <len>4</len>
            <value> </value>
        </tag2>
    </tag1> 
```

我遵循的方法是将其转换为 gccXML 格式，然后使用 Visual C++ 对其进行解析。我使用 xerces-c DOM 解析器。

有人可以建议如何去做吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:35:53.267

更好的方法是反射，BoostLib 有一些可以使用。你做这样的事情：

```
for( Attribute::Iterator it = reflectiveObject.getAttributeList().begin();
     it != reflectiveObject.getAttributeList().end();
     ++it )
{
    XML.createNode( it.getAttributeName() );
} 
```

//然后方法相同。应该有一个上层迭代器递归遍历类型，如果类型具有子类或子结构，则标识 XML 并为它们运行相同的代码。

没有反射会更无聊，你应该为它创建 Formater 和 Parser，比如

```
if( dynamic_cast< DesirecClass* >( obj ) != NULL ){
    XML.createNode( typeid( obj ).name() );
}
// Hard Code (terrible treatment) for each attribute, etc... 
```

您还可以搜索一些解构方法。

# r - 在内核k-means（R中的kernlab包）中将新数据点分配给集群？

> ID：11621642
> 
> 赞同：13
> 
> 时间：2012-07-23T22:48:50.917
> 
> 标签：r, machine-learning, cluster-analysis, k-means, kernlab

`kkmeans`我对 R 包中的函数有疑问`kernlab`。我是这个包的新手，如果我在这里遗漏了一些明显的东西，请原谅我。

我想为一组集群中的一个集群分配一个新的数据点，这些集群是使用内核 k-means 和函数“kkmeans”创建的。使用常规聚类，可以通过计算新数据点和聚类质心之间的欧几里得距离来做到这一点，并选择质心最近的聚类。在内核 k-means 中，必须在特征空间中执行此操作。

以 kkmeans 描述中使用的示例为例：

```
data(iris)

sc <- kkmeans(as.matrix(iris[,-5]), centers=3) 
```

假设我在这里有一个新数据点，我想将其分配给上面在`sc`.

```
Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
     5.0         3.6          1.2         0.4 
```

关于如何做到这一点的任何提示？非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-01T05:47:49.930

Kernel K-means 使用 Kernel 函数来计算对象的相似度。在简单的 k-means 中，您循环遍历所有质心并选择最小化到给定数据点的距离（未使用度量）的质心。在核方法的情况下（默认核函数`kkmeans`是`radial basis function`），您只需遍历质心并选择**使核函数值最大化**（在 RBF 的情况下）或**最小化核诱导距离**（对于任何核）的一个。[此处](http://www.cs.utah.edu/~suresh/papers/kerneld/kerneld.pdf)提供了将内核转换为距离度量的详细说明- 通常由内核引起的距离`K`可以通过 计算`d^2(a,b) = K(a,a)+K(b,b)-2K(a,b)`，但是对于 RBF，`K(x,x)=1`对于所有情况`x`，您可以最大化`K(a,b)`而不是最小化整个`K(a,a)+K(b,b)-2K(a,b)`.

要从`kkmeans`对象获取内核函数，您可以使用`kernelf`函数

```
> data(iris)
> sc <- kkmeans(as.matrix(iris[,-5]), centers=3)
> K = kernelf(sc) 
```

所以对于你的例子

```
> c=centers(sc)
> x=c(5.0, 3.6, 1.2, 0.4)
> K(x,c[1,])
             [,1]
[1,] 1.303795e-11
> K(x,c[2,])
             [,1]
[1,] 8.038534e-06
> K(x,c[3,])
          [,1]
[1,] 0.8132268
> which.max( c( K(x,c[1,]), K(x,c[2,]), K(x,c[3,]) ) )
[1] 3 
```

`c[3,]=5.032692 3.401923 1.598077 0.3115385`在使用核函数的意义上，最接近的质心。

# ios - Iphone 电话号码格式基于区域设置

> ID：11621645
> 
> 赞同：1
> 
> 时间：2012-07-23T22:49:05.893
> 
> 标签：ios, objective-c, internationalization, string-formatting, phone-number

在我的应用程序中，我试图根据用户区域设置格式化电话号码。我面临的问题如下：

Viewcontroller.m 中的代码：

```
 NSString *contact = [_phone convertContact:myNumber withLocale:typeN];
   NSLog(@"Phone number %@ and number = %@",contact,myNumber);

   //Console output 2012-07-23 15:40:16.994 InternProj[7585:f803] value of en and      23443235434 
```

PhoneNumber.m 中的代码：

```
 - (NSString *) convertContact:(NSNumber *)aNumber withLocale:(NSString *)locale{

  NSString *localeString = locale ;
  NSLog(@"value of %@ and %@",localeString , aNumber);
  NSString *tempStr = [[NSString alloc] initWithString:@""];
  NSRange range;
  range.length = 3;
  range.location = 3;
   //Returns the phone number 2032225200 as 1(203)222-5200
  if([localeString compare:@"en"] == NSOrderedSame) {
    NSLog(@"Inside en");
    NSString *areaCode = [[aNumber stringValue] substringToIndex:3];
    NSString *phone1 = [[aNumber stringValue] substringWithRange:range];
    NSString *phone2 = [[aNumber stringValue] substringFromIndex:6];

    tempStr = [NSString stringWithFormat:@"1(%@)%@-%@", areaCode, phone1, phone2];
    NSLog(@"Value tempStr = %@",tempStr);
}
else {
    tempStr = [[aNumber stringValue] substringToIndex:3];
}

  return tempStr;
} 
```

我从 convertContact 方法得到一个 null 作为返回值。我尝试了所有的排列，但我没有得到我出错的地方。此外，如果有人有基于 Iphone 区域设置的电话号码格式信息，请分享。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T20:22:30.963

首先，iOS 不支持电话号码格式。开发人员必须编写自己的插件。还要提及您在方法中传递的 typeN 变量是什么。还要检查 aNumber 是否不为空。我很确定您在方法中传递的数字是 null 的原因。

# .net - 在 Couchbase 中获取存储桶项目数

> ID：11621646
> 
> 赞同：0
> 
> 时间：2012-07-23T22:49:13.637
> 
> 标签：.net, couchbase

我刚刚开始使用 .NET 客户端试验 Couchbase (v1.8)。我不知道如何获取我存储在默认存储桶中的项目的基本计数。

我的存储代码非常简单：

```
var client = new CouchbaseClient();
var session = new Session { SessionId = "session_1234" };
client.Store(StoreMode.Add, sessionId, session); 
```

但现在我只想计算我存储在沙发库存储桶中的所有会话数。我查看了 .NET API 文档，但似乎找不到这样做的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:54:04.473

目前，客户端不支持从存储桶中获取项目计数。我最近做了一些工作来启动一个基本的存储桶 API。我已经创建了一个添加项目计数的票 - [http://www.couchbase.com/issues/browse/NCBC-92](http://www.couchbase.com/issues/browse/NCBC-92)。

如果您对该计数的来源感兴趣，可以通过 HTTP API 获得它 - `http://127.0.0.1:8091/pools/default/buckets/default`<- 存储桶名称位于路径的末尾

如果您是 Couchbase Server 的新手，我建议您从 Couchbase Server 2.0 Developer Preview 4 - [http://www.couchbase.com/download](http://www.couchbase.com/download)开始。然后，您可以使用视图来计算会话文档。

有关 2.0 的更多信息，[请访问 http://www.couchbase.com/develop/net/next](http://www.couchbase.com/develop/net/next)。

- 约翰

# c# - 在 Linq 上需要 group by 和 distinct 的帮助

> ID：11621648
> 
> 赞同：0
> 
> 时间：2012-07-23T22:49:19.403
> 
> 标签：c#, linq, group-by

我正在尝试执行一个组，然后执行一个 distinct 来验证一组列是否仅映射到其他列。例如，在下面的数据集中

```
Brand   Product      Location      Customer      Demand
 Box       A         Chicago       Chicago        10
 Box       B         Chicago       Milwaukee      20
 Cart      C         Madison       Milwaukee      10
 Cart      D         Chicago       Milwaukee      15 
```

产品 A、B、C 有效。但 D 无效，因为存在以芝加哥为位置、密尔沃基为客户的产品 B。我正在尝试构建一个 LINQ 查询来获取异常记录并遇到一些麻烦。我很确定我的查询过于复杂。

```
var vDuplicateSupplierLitho = from p in vRecords
                              group p by new
                              {
                                  Location = p["Location"].Cast<string>(),
                                  Customer = p["Customer"].Cast<string>()
                              } into grp
                              select new
                              {
                                  Location = grp.Key.Location,
                                  Customer = grp.Key.Customer,
                                  Products = from a in grp
                                             group a by new { Product = a["Product"].Cast<string>() } into apngrp
                                             where apngrp.Count() > 1 && apngrp.Select(a => a["Product"]).Distinct().Count() > 1
                                                  from NonUniqueRecord in apngrp
                                                  select new
                                                  {
                                                      Product = apngrp.key.Product,
                                                      Location = g.key.Location,
                                                      Customer = g.key.Customer
                                                      Demand = NonUniqueRecord["Demand"]
                                                  }
                                              }; 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T22:55:20.513

```
new[] {
        new { Brand = "Box", Product = "A", Location = "Chicago", Customer = "Chicago", Demand = 10 },
        new { Brand = "Box", Product = "B", Location = "Chicago", Customer = "Milwaukee", Demand = 20 },
        new { Brand = "Cart", Product = "C", Location = "Madison", Customer = "Milwaukee", Demand = 10 },
        new { Brand = "Cart", Product = "D", Location = "Chicago", Customer = "Milwaukee", Demand = 15 },
        new { Brand = "Cart", Product = "C", Location = "Madison", Customer = "Milwaukee", Demand = 10 }
        }
    .GroupBy(o => new { o.Location, o.Customer })
    .Where(g => g.Select(o => o.Product).Distinct().Count() > 1)
    .SelectMany(g => g) 
```

...或者，在查询语法中...

```
from record in new[] {
        new { Brand = "Box", Product = "A", Location = "Chicago", Customer = "Chicago", Demand = 10 },
        new { Brand = "Box", Product = "B", Location = "Chicago", Customer = "Milwaukee", Demand = 20 },
        new { Brand = "Cart", Product = "C", Location = "Madison", Customer = "Milwaukee", Demand = 10 },
        new { Brand = "Cart", Product = "D", Location = "Chicago", Customer = "Milwaukee", Demand = 15 },
        new { Brand = "Cart", Product = "C", Location = "Madison", Customer = "Milwaukee", Demand = 10 }
        }
group record by new { record.Location, record.Customer } into grouping
where (from o in grouping select o.Product).Distinct().Count() > 1
from duplicate in grouping
select duplicate 
```

# jquery - 如何使用jQuery防止双击？

> ID：11621652
> 
> 赞同：65
> 
> 时间：2012-07-23T22:49:43.260
> 
> 标签：jquery, double-click

我有一个这样的按钮：

```
<input type="submit" id="submit" value="Save" /> 
```

在 jQuery 中，我使用以下内容，但它仍然允许双击：

```
<script type="text/javascript">

$(document).ready(function () {

    $("#submit").one('click', function (event) { 
```

关于如何防止双击的任何想法？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-07-23T22:53:48.747

jQuery 的[one()](http://api.jquery.com/one/)将为每个绑定的元素触发一次附加的事件处理程序，然后删除事件处理程序。

如果由于某种原因不符合要求，也可以在单击按钮后完全禁用该按钮。

```
$(document).ready(function () {
     $("#submit").one('click', function (event) {  
           event.preventDefault();
           //do something
           $(this).prop('disabled', true);
     });
}); 
```

应该注意的是，使用 ID可能会导致问题，因为它会使用对该元素的引用`submit`覆盖函数。`form.submit`

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2015-02-17T16:25:39.697

还有一种解决方案：

```
$('a').on('click', function(e){
    var $link = $(e.target);
    e.preventDefault();
    if(!$link.data('lockedAt') || +new Date() - $link.data('lockedAt') > 300) {
        doSomething();
    }
    $link.data('lockedAt', +new Date());
}); 
```

这里我们将最后一次点击的时间保存为数据属性，然后检查上一次点击是否超过 0.3 秒前。如果为假（小于 0.3 秒前），则更新最后一次点击时间，如果为真，则执行某些操作。

[jsbin](http://jsbin.com/ziyajawodi/2/edit?html,js,console,output)

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2016-04-22T13:02:52.233

我发现大多数解决方案都不适用于单击标签或 DIV 等元素（例如，使用 Kendo 控件时）。所以我做了这个简单的解决方案：

```
function isDoubleClicked(element) {
    //if already clicked return TRUE to indicate this click is not allowed
    if (element.data("isclicked")) return true;

    //mark as clicked for 1 second
    element.data("isclicked", true);
    setTimeout(function () {
        element.removeData("isclicked");
    }, 1000);

    //return FALSE to indicate this click was allowed
    return false;
} 
```

在您必须决定是否开始活动的地方使用它：

```
$('#button').on("click", function () {
    if (isDoubleClicked($(this))) return;

    ..continue...
}); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-01-28T22:18:15.203

我的解决方案：[https](https://gist.github.com/pangui/86b5e0610b53ddf28f94) ://gist.github.com/pangui/86b5e0610b53ddf28f94它可以防止双击但在 1 秒后接受更多的点击。希望能帮助到你。

这是代码：

```
jQuery.fn.preventDoubleClick = function() {
  $(this).on('click', function(e){
    var $el = $(this);
    if($el.data('clicked')){
      // Previously clicked, stop actions
      e.preventDefault();
      e.stopPropagation();
    }else{
      // Mark to ignore next click
      $el.data('clicked', true);
      // Unmark after 1 second
      window.setTimeout(function(){
        $el.removeData('clicked');
      }, 1000)
    }
  });
  return this;
}; 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-04-02T01:40:42.173

就我而言，jQuery one 有一些副作用（在 IE8 中），我最终使用了以下内容：

```
$(document).ready(function(){
  $("*").dblclick(function(e){
    e.preventDefault();
  });
}); 
```

效果很好，看起来更简单。在那里找到它：[http ://www.jquerybyexample.net/2013/01/disable-mouse-double-click-using-javascript-or-jquery.html](http://www.jquerybyexample.net/2013/01/disable-mouse-double-click-using-javascript-or-jquery.html)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-09-19T09:28:16.117

只需将此方法放在您的表单中，它就会一次处理双击或多次单击。一旦请求发送，它将不允许一次又一次地发送请求。

```
<script type="text/javascript">
    $(document).ready(function(){
            $("form").submit(function() {
                $(this).submit(function() {
                    return false;
                });
                return true;
            }); 
    }); 
</script> 
```

它肯定会帮助你。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-12-18T15:02:03.927

***“十分简单”***

```
$(function() {
     $('.targetClass').dblclick(false);
}); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-08-06T06:56:48.187

我有类似的问题。您可以使用 setTimeout() 来避免双击。

```
//some codes here above after the click then disable it 
```

// 还要检查这里是否有一个属性被禁用

// 如果 btn 标记中禁用了属性，则 // 返回。将其转换为 js。

```
$('#btn1').prop("disabled", true);

setTimeout(function(){
    $('#btn1').prop("disabled", false);
}, 300); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-12-13T09:42:50.190

我发现在现代浏览器上是旧的但有效的解决方案。适用于在双击时不切换类。

```
$('*').click(function(event) {
    if(!event.detail || event.detail==1){//activate on first click only to avoid hiding again on double clicks
        // Toggle classes and do functions here
        $(this).slideToggle();
    }
}); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-03-17T20:41:12.730

```
/*
Double click behaves as one single click

"It is inadvisable to bind handlers to both the click and dblclick events for the same element. The sequence of events triggered varies from browser to browser, with some receiving two click events before the dblclick and others only one. Double-click sensitivity (maximum time between clicks that is detected as a double click) can vary by operating system and browser, and is often user-configurable."

That way we have to check what is the event that is being executed at any sequence. 

   */
       var totalClicks = 1;

 $('#elementId').on('click dblclick', function (e) {

 if (e.type == "dblclick") {
    console.log("e.type1: " + e.type);
    return;
 } else if (e.type == "click") {

    if (totalClicks > 1) {
        console.log("e.type2: " + e.type);
        totalClicks = 1;
        return;
    } else {
        console.log("e.type3: " + e.type);
        ++totalClicks;
    }

    //execute the code you want to execute
}

}); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-22T08:22:39.243

@Kichrum 提供的解决方案几乎对我有用。我确实必须添加 e.stopImmediatePropagation() 以防止默认操作。这是我的代码：

```
$('a, button').on('click', function (e) {
    var $link = $(e.target);
    if (!$link.data('lockedAt')) {
        $link.data('lockedAt', +new Date());
    } else if (+new Date() - $link.data('lockedAt') > 500) {
        $link.data('lockedAt', +new Date());
    } else {
        e.preventDefault();
        e.stopPropagation();
        e.stopImmediatePropagation();
    }
}); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-08-13T15:04:44.097

这是我的第一篇文章，我非常缺乏经验，所以请放轻松，但我觉得我有一个有效的贡献，可能对某人有帮助......

有时您在重复点击之间需要一个非常大的时间窗口（例如，一个 mailto 链接，其中电子邮件应用程序需要几秒钟才能打开并且您不希望它重新触发），但您不想减慢用户在别处。我的解决方案是根据事件类型为链接使用类名，同时在其他地方保留双击功能......

```
var controlspeed = 0;

$(document).on('click','a',function (event) {
    eventtype = this.className;
    controlspeed ++;
    if (eventtype == "eg-class01") {
        speedlimit = 3000;
    } else if (eventtype == "eg-class02") { 
        speedlimit = 500; 
    } else { 
        speedlimit = 0; 
    } 
    setTimeout(function() {
        controlspeed = 0;
    },speedlimit);
    if (controlspeed > 1) {
        event.preventDefault();
        return;
    } else {

        (usual onclick code goes here)

    }
}); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-06-26T07:01:13.050

当加载具有相同表单的新页面时，您可以执行以下操作来禁用提交按钮：

```
$("#btnConfirm").bind("click", function (e) {
  $("#btnConfirm ").css("pointer-events", "none");
}); 
```

提交按钮可能如下所示：

```
<input
    type="submit"
    name="ACMS_POST_Form_Confirm"
    value="confirm"
    id="btnConfirm"
/> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-02-26T15:00:37.863

我有一个类似的问题，但禁用按钮并没有完全解决问题。单击按钮时还发生了一些其他操作，有时，按钮没有很快被禁用，当用户双击时，触发了 2 个事件。
我采用了 Pangui 的超时想法，并结合了这两种技术，禁用按钮并包括超时，以防万一。我创建了一个简单的 jQuery 插件：

```
var SINGLECLICK_CLICKED = 'singleClickClicked';
$.fn.singleClick = function () {
    var fncHandler; 
    var eventData;
    var fncSingleClick = function (ev) {
        var $this = $(this);
        if (($this.data(SINGLECLICK_CLICKED)) || ($this.prop('disabled'))) {
            ev.preventDefault();
            ev.stopPropagation();
        }
        else {
            $this.data(SINGLECLICK_CLICKED, true);
            window.setTimeout(function () {
                $this.removeData(SINGLECLICK_CLICKED);
            }, 1500);
            if ($.isFunction(fncHandler)) {
                fncHandler.apply(this, arguments);
            }
        }
    }

    switch (arguments.length) {
        case 0:
            return this.click();
        case 1:
            fncHandler = arguments[0];
            this.click(fncSingleClick);
            break;
        case 2: 
            eventData = arguments[0];
            fncHandler = arguments[1];
            this.click(eventData, fncSingleClick);
            break;
    }
    return this;
} 
```

然后像这样使用它：

```
$("#button1").singleClick(function () {
   $(this).prop('disabled', true);
   //...
   $(this).prop('disabled', false);
}) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-02-27T22:17:57.153

如果您真正想要的是避免多次提交表单，而不仅仅是防止双击，如果存在客户端验证（例如标记为必需的文本字段），则在按钮的单击事件上使用 jQuery one() 可能会出现问题。这是因为单击会触发客户端验证，如果验证失败，您将无法再次使用该按钮。为了避免这种情况，仍然可以直接在表单的提交事件上使用 one()。这是我为此找到的最干净的基于 jQuery 的解决方案：

```
<script type="text/javascript">
$("#my-signup-form").one("submit", function() {
    // Just disable the button.
    // There will be only one form submission.
    $("#my-signup-btn").prop("disabled", true);
});
</script> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-02-09T11:55:26.553

我能够通过以下方式有效地完成这项任务

1.  一旦调用按钮单击处理程序，就禁用按钮

2.  做需要做的必要操作。

3.  几秒钟后使用 SetTimeout 将 disabled 属性设置回 false

    ```
     $('#btn1).click(function(e){
     $('#btn1').prop("disabled", true);

     setTimeout(()=>{
     $('#btn1').prop("disabled", false);
     },2000) 
    ```

这应该可以解决问题。

# c++ - Python 3.2 PyRun_SimpleString - 它在哪里？

> ID：11621657
> 
> 赞同：3
> 
> 时间：2012-07-23T22:50:07.033
> 
> 标签：c++, python-3.x

我正在尝试将应用程序与 Python 的定制发行版一起发布（添加了模块和我自己的扩展）。

为了保持简单并且不会与潜在的现有安装发生冲突，我认为最好的方法是将 .\DLLS*.* 和 .\Lib*.* 树从 \Python32\ 与我的应用程序一起放在子目录 .\MyApp 下\Python\

我只直接调用了 3 个 Py* 函数：（代码是 C++ Builder...）

```
typedef void (__stdcall *PY_SETPYTHONHOME) (wchar_t *);
PY_SETPYTHONHOME Py_SetPythonHome;

typedef void (__stdcall *PY_INITIALIZE) ();
PY_INITIALIZE Py_Initialize;

typedef int (__stdcall *PYRUN_SIMPLESTRING) (const char *);
PYRUN_SIMPLESTRING PyRun_SimpleString;

HMODULE py_dll_hndle;
py_dll_hndle = ::LoadLibrary((ExtractFilePath(Application->ExeName) + "Python\\DLLS\\python3.dll").c_str());
ShowMessage(py_dll_hndle == NULL ? L"Bah" : L"Yay");     // Result: "Yay"

Py_SetPythonHome = (PY_SETPYTHONHOME) ::GetProcAddress(py_dll_hndle, "Py_SetPythonHome");
ShowMessage(Py_SetPythonHome == NULL ? L"Bah" : L"Yay");     // Result: "Yay"

Py_Initialize = (PY_INITIALIZE) ::GetProcAddress(py_dll_hndle, "Py_Initialize");
ShowMessage(Py_Initialize == NULL ? L"Bah" : L"Yay");     // Result: "Yay"

PyRun_SimpleString = (PYRUN_SIMPLESTRING) ::GetProcAddress(py_dll_hndle, "PyRun_SimpleString");
ShowMessage(GetLastError());     // Result: "127" (ERROR_PROC_NOT_FOUND)
ShowMessage(PyRun_SimpleString == NULL ? L"Bah" : L"Yay");     // Result: "Bah" 
```

PyRun_SimpleString 不存在？我一直在寻找使用[http://www.nirsoft.net/](http://www.nirsoft.net/) DLL 导出查看器...它不存在。我很困惑......它在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T09:23:18.590

有两个DLL的python3.dll和python32.dll。第一个是第二个的子集。python32.dll 只有一个副本 - 隐藏在我的 \Windows\SysWOW64\ 目录中，而 python3.dll 也在 c:\Python32\DLLs 目录中。

使用 python32.dll 而不是 python3.dll 解决了这个问题。

为什么会有部分重复仍然是一个谜......

# android - android中的上标布局

> ID：11621663
> 
> 赞同：0
> 
> 时间：2012-07-23T22:50:44.633
> 
> 标签：android, android-layout, superscript

我正在制作一个小部件布局，我需要显示`superscript`类型的东西![这](../Images/a6bf589b00af53e9aa994db3eae8d96a.png)，比如`PM`在这张图片中显示，我在想是否有任何工具可以像上标一样。将感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:54:20.030

您想使用[Html#fromHtml](http://developer.android.com/reference/android/text/Html.html#fromHtml%28java.lang.String%29)并使用[HTML <sup> 标签](http://www.tizag.com/htmlT/htmlsuperscript.php)。`TextView`如果你在java中设置文本，它会是什么样子：

```
textView.setText("3:36" + Html.fromHtml("<sup>PM</sup>")); 
```

更多信息可以在这个 SO Post 上找到：[Subscript and Superscript a String in Android](https://stackoverflow.com/questions/3543454/subscript-and-superscript-a-string-in-android)

# python - win32file.createFile "系统找不到指定路径"

> ID：11621671
> 
> 赞同：1
> 
> 时间：2012-07-23T22:51:06.237
> 
> 标签：python, file, winapi

我`win32file.CreateFile()`用来打开我在进程资源管理器中看到的“文件”。有问题的文件是（如 proc explorer 的句柄和 dll 视图中所示）：“\Device\ccSet_{}”

Q1。任何人都可以阐明什么是`\Device\<file name>`. 我相信这些显然不是存储在某处硬盘上的文件。除非我错了，他们是什么？

Q2。当我尝试按原样使用路径时`win32file.CreateFile()`，它给了我一个错误“系统找不到指定的路径或文件”。我哪里错了。

Q3。给定上述文件对象的地址（再次来自 proc explorer），我可以在不指定路径的情况下读取文件吗？

我正在使用的单行代码是：

```
>>> win32file.CreateFile("Device\<filename>",w
in32con.GENERIC_READ|win32con.GENERIC_WRITE,win32con.FILE_SHARE_READ|win32con.FI
LE_SHARE_WRITE,None,win32con.OPEN_EXISTING,0,0) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T23:19:42.717

1.  \Device\XXX 名称是内部 Windows NT 设备名称。
2.  前缀将`\\.\`访问 Win32 设备命名空间而不是 Win32 文件命名空间。例如，要打开 COM10，您需要使用`\\.\COM10`.
3.  该句柄仅在打开它的进程内有效。

# c# - c#如何从类中返回值？

> ID：11621672
> 
> 赞同：2
> 
> 时间：2012-07-23T22:51:08.503
> 
> 标签：c#, class, registry, return-value

我有课 ！

```
class Reg_v_no_string
{
    public static string key_place = "";
    public static string key = "";
    public static string value = "";
    public string reg_value(string key_place, string key)
    {
        string value = string.Empty;

            RegistryKey klase = Registry.CurrentUser;
            klase = klase.OpenSubKey(key_place);
            value = klase.GetValue(key).ToString();
            klase.Close();

        return value;
    }
} 
```

这将返回空白消息框。怎么能解决这个问题！？谢谢 ！

我怎样才能从这个类返回值？

我试过了

```
private void kryptonButton1_Click(object sender, EventArgs e)
    {
        Reg_v_no_string.key_place = @"Control Panel\Desktop";
        Reg_v_no_string.key_place = "WheelScrollLines";
        MessageBox.Show(Reg_v_no_string.value);

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T22:58:01.230

您需要实际调用该方法：

```
private void kryptonButton1_Click(object sender, EventArgs e) 
{ 
    var value = reg_value(@"Control Panel\Desktop", "WheelScrollLines");
    MessageBox.Show(value); 
} 
```

还要考虑对您的班级进行一些更改：

```
public static class Reg_v_no_string 
{ 
    public static string reg_value(string key_place, string key) 
    { 
        string value = string.Empty; 

         RegistryKey klase = Registry.CurrentUser; 
         // todo: add some error checking to make sure the key is opened, etc.
         klase = klase.OpenSubKey(key_place); 
         value = klase.GetValue(key).ToString(); 
         klase.Close(); 

        return value; 
    } 
} 
```

然后当你调用这个`static`类时，它是这样的：

```
// you don't need to `new` this class if it is static:
var value = Reg_v_no_string.reg_value(@"Control Panel\Desktop", "WheelScrollLines"); 
```

或者，保持它不是静态的：

```
public class Reg_v_no_string 
{ 
    public string reg_value(string key_place, string key) 
    { 
        string value = string.Empty; 

         RegistryKey klase = Registry.CurrentUser; 
         // todo: add some error checking to make sure the key is opened, etc.
         klase = klase.OpenSubKey(key_place); 
         value = klase.GetValue(key).ToString(); 
         klase.Close(); 

        return value; 
    } 
} 
```

然后像这样调用它：

```
Reg_v_no_string obj = new Reg_v_no_string ();
var value = reg_value(@"Control Panel\Desktop", "WheelScrollLines"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T22:54:25.943

没有调用`reg_value`.

结果，您将获得`value`字段的默认值（也在实例之间共享）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-16T06:30:48.697

`Reg_v_no_string.value`尚未设置。
您必须调用`reg_value(string key_place, string key)`将返回该值的函数。

# ruby-on-rails - 解释在 select 方法 rails 中使用哈希

> ID：11621673
> 
> 赞同：0
> 
> 时间：2012-07-23T22:51:23.413
> 
> 标签：ruby-on-rails, forms, select

我在模型中有一个定义了哈希的类。

```
{:"manager" => 1, :"staff" => 2}.freeze 
```

在我的形式部分。

```
 <li class="field">
    <%= f.label :position_type %><br />
    <%= f.select :position_type, @person.position_types, {:include_blank => true} %>
  </li> 
```

因此，当我按下`submit`show.html.erb 中的按钮时，我只能看到所选值的值，但看不到我想要的键。

**问：**如何调整它以使其显示`key`而不是`values`. 我知道这与`select`tag 而不是`hash`.

PS：

1.  我已经使用过`array`，它正在做我想做的事。

2.  `hash.invert`它确实在 show.html.erb 中显示，`keys`但在 new/edit.html.erb 中没有显示，因为尝试填写表单的用户无法记住要到达的键 => 值，所以这种方式并没有太大帮助键作为输出。

我只是好奇`select`在 Rails 中是如何获取 HTML`name`和`value`attirb 的。我假设由于**hash**已经`value`为每个关联`key`的 ，rails在提交表单时隐含地采用`key's` `value`as HTML属性。`value`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:37:59.417

根据文档[http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html) ，名称和 ID 必须位于嵌套数组中。要从您的地图创建它，您可以使用：

```
@person.position_types.map{|k,v| [k.to_s,v]} 
```

# iphone - Twitter API（从 ID 到屏幕名称）

> ID：11621677
> 
> 赞同：2
> 
> 时间：2012-07-23T22:51:31.403
> 
> 标签：iphone, objective-c, ios, twitter

我正在尝试将 Twitter 用户 ID（例如：77687121）转换为他们的用户名或屏幕名称（任何一个都可以），但我遇到了一个问题......

我尝试按照这个 SO 问题的指示，但是对于 Twitter api 以及 Objective c 本身来说，这让我很难理解：*http ://stackoverflow.com/questions/10020672/php-twitter-api-get-用户查找抓取屏幕名称来自 id*

我从该教程中编写了以下代码，我得到了这个......

```
- (void) turnFriendId: (NSString *)friID {
// Setup the URL, as you can see it's just Twitter's own API url scheme. In this case we want to receive it in JSON
NSLog(@"%@",friID);
NSURL *followingURL = [NSURL URLWithString:@"https://api.twitter.com/1/users/show.json"];
// Pass in the parameters (basically '.ids.json?screen_name=[screen_name]')
NSDictionary *parameters = [NSDictionary dictionaryWithObjectsAndKeys:friID, @"id_str", nil];
// Setup the request
TWRequest *twitterRequest = [[TWRequest alloc] initWithURL:followingURL
                                                parameters:parameters
                                             requestMethod:TWRequestMethodGET];
// This is important! Set the account for the request so we can do an authenticated request. Without this you cannot get the followers for private accounts and Twitter may also return an error if you're doing too many requests
[twitterRequest setAccount:theAccount];
// Perform the request for Twitter friends
[twitterRequest performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
    if (error) {
        // deal with any errors - keep in mind, though you may receive a valid response that contains an error, so you may want to look at the response and ensure no 'error:' key is present in the dictionary
    }
    NSError *jsonError = nil;
    // Convert the response into a dictionary
    NSDictionary *twitterGrabbedUserInfo = [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONWritingPrettyPrinted error:&jsonError];
    // Grab the Ids that Twitter returned and add them to the dictionary we created earlier
    NSLog(@"%@", [twitterGrabbedUserInfo objectForKey:@"name"]);
}];
} 
```

这种方法有时会给我一个错误，有时它会中断并显示一些汇编代码......下面是错误......**以及第一个 NSLOG(); 在方法的开始...**

```
2012-07-23 18:42:05.786 VideoPush[17625:3503] 1882208
2012-07-23 18:42:17.692 VideoPush[17625:3503] -[__NSCFType credentialForAccount:]: unrecognized selector sent to instance 0x1afeb0
2012-07-23 18:42:17.694 VideoPush[17625:3503] -[__NSCFType enabledDataclassesForAccount:]: unrecognized selector sent to instance 0x1afeb0
2012-07-23 18:42:17.696 VideoPush[17625:3503] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFType enabledDataclassesForAccount:]: unrecognized selector sent to instance 0x1afeb0'
*** First throw call stack:
(0x355e188f 0x37988259 0x355e4a9b 0x355e3915 0x3553e650 0x3055bfc3 0x3055b98b 0x35065d2f 0x355c1975 0x3553c1df 0x3554fb5f 0x35080b8b 0x35080b2b 0x3257dfdf 0x3257e88d 0x3257ea6b 0x3257eea5 0x355e3a83 0x3553e650 0x3055cf85 0x322047b1 0x32204e5d 0x31f1f 0x31d8d 0x32204f8b 0x3446ec59 0x34470d0f 0x34470b75 0x344717e7 0x3299edfb 0x3299ecd0)
terminate called throwing an exception(lldb) 
```

**这也是通过每个单独的 Twitter id（即使我有数千个）只是为了获取每个用户的屏幕名称的好方法。我知道 Twitter 有 API 限制...**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T00:18:34.107

运行`users/lookup`通话

```
http://api.twitter.com/1/users/lookup.json?user_id=77687121,43662011,6253282 
```

您可以用逗号分隔 ID 以拨打电话。

有关响应示例，请参见此处：

[https://snap.apigee.com/NHcXs4](https://snap.apigee.com/NHcXs4)

# asp.net-mvc - Controller.Session 和 HttpContext.Current.Session

> ID：11621682
> 
> 赞同：0
> 
> 时间：2012-07-23T22:51:55.897
> 
> 标签：asp.net-mvc

是`Controller.Session`和`HttpContext.Current.Session`相同的对象吗？问题是当我使用`HttpContext`一切正常时，会话数据在将值放入后几分钟内丢失了，`HttpContext.Current.Session`尽管`<sessionState timeout="9999" />`.
但是当我更改代码以使用时，`Controller.Session`一切似乎都很好。

# php - 使用 foreach 而不是 while 循环循环 mysql_fetch_assoc

> ID：11621686
> 
> 赞同：4
> 
> 时间：2012-07-23T22:52:27.580
> 
> 标签：php

我有一个mysql查询：

```
$result = mysql_query("my query"); 
```

有没有办法让这样的工作？

```
$results = mysql_fetch_assoc($result); // fetch the results 
```

并使用 foreach 而不是经典的 while 循环它们：

```
foreach($results as $result){
   $result1 = $result->result1;
   $result2 = $result->result2;
} 
```

泰

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T22:57:35.450

Foreach 是一种迭代数组和对象的构造。 `mysql_fetch_assoc`将返回一个数组，但每个数组将只有一行的数据。因此，您的 foreach 只会为您提供第一行中的列。

避免麻烦，不要一起使用 mysql_fetch_assoc 和 foreach 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-17T22:23:30.860

因为`mysql_fetch_assoc`一次只返回一行，所以使用它将 PHP 结果集转换为 PHP 数组。然后，在数组上使用 foreach。

例如：

```
while ($row = mysql_fetch_assoc($result)) { 
     $rows[] = $row; 
} 

foreach($rows as $row) {
    //Then do something for each row, for e.g.:
    if ($row['col_name'] == 'somevalue'){
        $arrList[] = $row['id'];
    }
} 
```

或者：

```
while ($row = mysql_fetch_assoc($result)) { 
     $rows[] = $row; 
} 

foreach($rows as $row) { 
     foreach($row as $field => $value) { 
          //do something with $field and $val 
     }
} 
```

或者：

```
while ($row = mysql_fetch_assoc($result)) { 
     $rows[] = $row; 
} 

for($i=0;$i<count($rows);$i++) { 
     //do something with $rows[$i]['field_name'] 
} 
```

来源：

[Devshed：PHP foreach/while mysql 结果？](http://forums.devshed.com/php-development-5/php-foreach-mysql-result-778824.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-02T13:33:19.883

不要使用 mysql（已弃用），而是使用 mysqli。

```
$res = $mysqli->query($sql);
$rows = $res->fetch_all(MYSQLI_ASSOC);
foreach ($rows as $id => $rowData) {
    //do something with $rowData
} 
```

# ios - 在应用启动时检测正确的方向

> ID：11621689
> 
> 赞同：2
> 
> 时间：2012-07-23T22:52:35.397
> 
> 标签：ios, ios5

我有一个带有 splitcontroller 的通用应用程序和一个从 detailcontroller 的 viewdidload 模态显示的模态（它的登录屏幕）

打开 ipad 版本时，我希望能够根据设备的初始方向以纵向或横向启动它。问题是它总是作为肖像启动（预期根据[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)）。

如果我将设备设置为纵向，然后如果是横向，则它可以工作。但是，如果我直接打开应用程序，它不会。

顺便说一句：我已经设置`return true`了`(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation`那个登录视图控制器

**更新：** 如果我从 viewDidAppear 而不是 viewDidLoad 执行 segue，模态的方向正常工作，但在模态之前看到 SplitController 一段时间，我该如何避免这种情况？

```
- (void)viewDidAppear:(BOOL)animated
{
    [self.splitViewController performSegueWithIdentifier:@"toModal" sender:self.splitViewController];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:58:35.657

您可以有条件地设置的方向`(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation`。像这样的东西并不漂亮，但它有效：

```
UIInterfaceOrientation orientation = [UIApplication sharedApplication].statusBarOrientation;

if(orientation == 0) //Default orientation 
    //UI is in Default (Portrait) -- this is really a just a failsafe. 
else if(orientation == UIInterfaceOrientationPortrait)
    //Do something if the orientation is in Portrait
else if(orientation == UIInterfaceOrientationLandscapeLeft)
    // Do something if Left
else if(orientation == UIInterfaceOrientationLandscapeRight)
    //Do something if right 
```

否则，这篇文章似乎与您正在尝试做的事情相当相关：

[为 iPad 横向启动应用程序](https://stackoverflow.com/questions/2947501/launching-application-in-landscape-orientation-for-ipad)

* * *

# 提案 2

* * *

您可以使用以下方法创建一个具有查找设备方向（即“deviceInfo”）的方法的类：

```
UIInterfaceOrientationIsPortrait([[UIApplication sharedApplication]statusBarOrientation]) 
```

和

```
UIInterfaceOrientationIsLandscape([[UIApplication sharedApplication]statusBarOrientation]) 
```

您还可以存储您想要的任何拉伸因子/尺寸/测量值。然后在`view`里面`-(id)initWithFrame:(CGRect)frame`你可以调用你的方法来检查方向（即`deviceInfo.isLandscape?`）。然后设置你`view`的`autoresizingMask`等于 `UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth`。然后，`-(void)layoutSubviews`设置`view.frame`等于您想要的任何尺寸：

```
CGRectMake(x-origin, y-origin, width, height); 
```

这是获取当前方向的参考：

[http://www.ddeville.me/2011/01/getting-the-interface-orientation-in-ios/](http://www.ddeville.me/2011/01/getting-the-interface-orientation-in-ios/)

更改视图框架的尺寸相对简单，可以在 Apple 的文档或一些简单的谷歌搜索中找到。

# java - 在 Java 中，谁能解释为什么这个对象为空？

> ID：11621690
> 
> 赞同：0
> 
> 时间：2012-07-23T22:52:38.483
> 
> 标签：java, exception, null

```
class Monitor {
  TheManager manager;
  Map<String, Subject> subjectMap;
  public Monitor() {
    TheManager manager = new TheManager();
    Map<String, Subject> subjectMap = new HashMap<String, Subject>();
  }

  public void addObject(String objName, Object obj) {
    if(objName == null) System.out.println("name null");
    if(obj == null) System.out.println("obj null");
    if(manager == null) System.out.println("manager null");
    manager.addObject(objName, obj);
  }
} 
```

我收到空指针异常，因为 manager 为空。我已经在代码的其他地方实例化了一个 Monitor 对象。当我尝试使用“addObject”方法时，它在打印“manager null”之前给了我NPE（因为它显然是）。

我觉得我在这里遗漏了一些非常基本的东西......有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T22:54:49.327

您的构造函数包含

```
TheManager manager = new TheManager(); 
```

代替

```
this.manager = new TheManager(); 
```

同样的游戏`subjectMap`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T22:54:50.670

您永远不会分配经理，即对象的字段。在您的构造函数中，您正在分配一个局部变量。该变量会影响您的领域。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T22:54:58.403

你定义`manager`了`subjectMap`两次。一次在构造函数中，一次在类中。当您在构造函数中分配它们时，它们在构造函数的范围内，而不是在类中。您需要删除构造函数中的声明。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T22:56:42.927

我无法用 Java 解释它，但我可以用英语：P

请注意，您有一个实例变量

```
TheManager manager; 
```

没有设置任何东西。然后在您的构造函数中创建一个*不同*的变量：

```
TheManager manager = new TheManager(); 
```

在构造函数的末尾超出范围。为了引用实例变量，而不是新的本地变量，请`TheManager`从构造函数的行首删除。

# java - Android EditText 问题 findviewbyId

> ID：11621694
> 
> 赞同：0
> 
> 时间：2012-07-23T22:53:00.150
> 
> 标签：java, android, eclipse, android-layout, android-widget

为少数编辑文本分配 id 会导致以下错误：

```
the error is in the parameters of findViewById token 
```

这是它所在的代码行

```
final EditText myEditField = (EditText) findViewById(R.id.percentText1); 
```

...这是 Xml 代码，再次对发布 java 的书呆子感到抱歉...

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/percentText1"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <Button
        android:id="@+id/enterButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="224dp"
        android:onClick="onEnterClick"
        android:text="Calculate Tip" />

    <EditText
        android:id="@+id/percentText"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="53dp"
        android:ems="10"
        android:singleLine="true"
        android:text="Percent" />

    <EditText
        android:id="@+id/percentage"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/percentText"
        android:layout_alignParentTop="true"
        android:ems="10"
        android:singleLine="true"
        android:text="Bill Amount" >

        <requestFocus />
    </EditText>

</RelativeLayout> 
```

...Java代码...我认为的错误是我不正确地给编辑文本一个id ...

```
package tip.calculator;

import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.view.Menu;
import android.view.MenuItem;
import android.support.v4.app.NavUtils;
import android.widget.CheckBox;
import android.widget.EditText;
import android.widget.TextView;
import tip.calculator.R;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        EditText myEditField = (EditText) findViewById(R.id.percentText); //error here 

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void onEnterClick(String args []){

        int percentage;
        int percentageInp;
        int billAmount;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:57:57.983

确保你的导入中没有这个

```
import android.R; 
```

Eclipse 有时会导入这个类，而应该是

```
import your.application.packagename.R; 
```

通常在我们`ctrl+shft+o`修复导入时会发生这种情况。当我们这样做时， Eclipse 会添加`R`该类。:)

**编辑：**

从你的新问题来看，有一个拼写错误。尝试将此行粘贴到 onCreate() 方法中：

```
EditText myEditField = (EditText) findViewById(R.id.percentText); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:22:59.837

改变

```
final EditText myEditField = (EditText) findViewById(R.id.percentText1); 
```

至

```
final EditText myEditField = (EditText) findViewById(R.id.percentText); 
```

percentText1 是 RelativeLayout 的 id，而不是 EditText 的 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-25T02:39:15.237

导入tip.calculator.R；<-这就是我认为的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T23:10:20.287

您需要了解的是，如果资源有任何问题，那么在任何地方都无济于事。那么检查资源文件夹中是否有任何错误？是否列出了任何问题？然后尝试找到其中一个按钮，将其他所有内容注释掉。在解决所有布局错误之前，您将找不到任何东西。然后只需确保您像这样声明 id

```
 android:id="@+id/myTextId" 
```

# c# - 如何更改特定 Sprites 纹理的颜色？

> ID：11621695
> 
> 赞同：0
> 
> 时间：2012-07-23T22:53:08.970
> 
> 标签：c#, colors, xna, sprite, textures

现在我在我的精灵类中使用了一个名为 SetTextureColour 的函数：

```
 public void SetTextureColour(Color Colour)
    {
        Color[] data = new Color[Texture.Width * Texture.Height];
        Texture.GetData(data);

        for (int i = 0; i < data.Length; i++)
        {
            if (data[i] == Color.White)
            {
                data[i] = Colour;
            }
        }
        Texture.SetData(data);
    } 
```

要将精灵纹理中每个白色像素的颜色更改为指定颜色，这可以正常工作，但我遇到的问题是它会更改共享该纹理的每个精灵的颜色，而不仅仅是单个精灵的颜色。有没有人有一个解决方案，这样我就可以只改变那个精灵纹理的像素，所以我可以使用为具有相同纹理的多个精灵指定不同颜色的函数。

提前致谢。

编辑：

根据建议，我尝试使用像素着色器来执行此操作，尽管在尝试这样做之前我从未使用过它们，但到目前为止，我已经按照建议进行了操作-

```
sampler TextureSampler : register(s0);
float3 key_color;
float3 new_color;

float4 ChangePixel(float4 color : COLOR0, float2 texCoord : TEXCOORD0) : COLOR0
{
  float4 newColor = tex2D(TextureSampler, texCoord);

  if (distance(key_color, color.rgb)<0.001f)
  {
     color.rgb = new_color;
  } 

  return newColor;
} 

technique PixelChange
{
    pass Pass0
    {
        PixelShader = compile ps_2_0 ChangePixel();
    }
} 
```

它是使用加载内容加载的，我还使用它设置了它的技术-

```
 Effect1.CurrentTechnique = Effect1.Techniques["PixelChange"]; 
```

然后我使用这两行设置值-

```
 Effect1.Parameters["key_color"].SetValue(Color.White.ToVector3());
        Effect1.Parameters["new_color"].SetValue(Color.Red.ToVector3()); 
```

但这似乎无济于事，有人可以帮助我吗？正如我所说，这是第一次使用着色器，所以我可以使用一些帮助。

最后一件事，在 spriteBatch.Begin 中使用了效果，所以这不是没有应用效果的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:40:42.350

您可以使用为您执行此操作的着色器...

```
sampler texture : register(s0);
float3 key_color = float3(1,1,1);
float3 new_color;

float4 pixel_shader_that_replaces_color(in float4 color:COLOR0, in float2 coords:TEXCOORDS) : COLOR0
{
      float4 color = tex2D(texture, coords);
      if (distance(key_color, color.rgb)<0.001f)
      {
         color.rgb = new_color;
      } 
      return color;
} 
```

在您的代码中，您必须加载新效果...并且对于您要绘制的每种颜色，请执行此操作...

```
 effect.SetValue("key_color", Color.White.ToVector3());
 effect.SetValue("new_color", yourcolor.ToVector3());
 spritebatch.Begin(-...., , ,, effect);
     // Inside this all your texture pixels with Color.White will be replaced to newColor
 spritebatch.End() 
```

你必须为你想要的每个 new_color 调用 sprite.Begin ......但我认为比设置纹理数据更好......

PD：我正在即时编写代码......它需要一些额外的工作......就像你可以[在股票样本](http://create.msdn.com/en-US/education/catalog/sample/stock_effects)中找到的顶点着色器，但这些是基础知识:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T23:10:16.277

感谢回答我问题的人和facepunch上的人的帮助，我有解决方案-

```
sampler TextureSampler : register(s0);
float3 key_color;
float3 new_color;

float4 ChangePixel(float4 color : COLOR0, float2 texCoord : TEXCOORD0) : COLOR0
  {
    float4 newColor = tex2D(TextureSampler, texCoord);

  if (distance(key_color, newColor.rgb)<0.001f)
  {
     newColor.rgb = new_color;
  } 

  return newColor * color;
} 

technique PixelChange
{
    pass Pass0
    {
       PixelShader = compile ps_2_0 ChangePixel();
   }
} 
```

要使用着色器，请使用 -

```
 Effect1.Parameters["key_color"].SetValue(Color.White.ToVector3());
        Effect1.Parameters["new_color"].SetValue(Color.Aqua.ToVector3()); 
```

关键颜色设置要搜索的颜色，新颜色是要替换的颜色，谢谢大家的帮助！

# slider - 相对于滑块值的路径位置未正确设置

> ID：11621696
> 
> 赞同：0
> 
> 时间：2012-07-23T22:53:25.100
> 
> 标签：slider, javafx, javafx-2, fxml

我正在尝试`Slider`在我的 JavaFX 应用程序中添加一个路径到一个组，该组也包含一个，以便让用户标记与该`Slider`值关联的对象的某些特征。但是，路径（在这种情况下是一条垂直线）没有被标记在完全正确的位置。对于较小的值，它在拇指之前，对于较大的值，它在拇指之后。

```
double pixelsPerValue = slider.getWidth() / (slider.getMax() - slider.getMin());
double leftAdjust = slider.getLayoutX();
double pathX = leftAdjust + (slider.getValue() * pixelsPerValue);
Path path = PathBuilder.create()
    .elements(
        new MoveTo(pathX, 0)
        , new LineTo(pathX, 25)
        )
    .stroke(Color.CYAN)
    .strokeWidth(3)
    .translateX(0)
    .translateY(27.0)
    .build(); 
```

注意两点：

1.  该组位于 BorderPane 底部的 HBox 中；
2.  Slider 的最大值由用户想要滚动的对象数量决定，例如 8,617、10,492、6,345 - 你懂的。

知道为什么会这样吗？我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T10:09:36.403

很少的笔记；

1.  您绘制的线的轻微滑动是由于滑块的边框和滑块线之间的左右边距。您可以通过更改`double margin`下面代码中的值来测试它。
2.  在显示阶段之前，您无法使用`slider.getWidth()`。请参阅下面代码中的“之前”和“之后”打印。相反，我使用了`slider.getPrefWidth()`. 当然，如果您在某些事件处理程序中使用 getWidth() 则没问题。
3.  使用绑定更容易控制和编码。在下面的代码中滑动拇指。

公共类 SliderDemo 扩展应用程序 {

```
 public static void main(String[] args) {
        launch(args);
    }

    @Override
    public void start(Stage primaryStage) {

        Slider slider = new Slider();
        slider.setStyle("-fx-border-color: green");
        slider.setLayoutX(60);
        slider.setLayoutY(50);
        slider.setMax(200);
        slider.setValue(180);
        slider.setMin(100);
        slider.setPrefWidth(390);

        double margin = 10; // left and right margins between the border and the slider line of the slider

        SimpleDoubleProperty pixelsPerValueProperty = //
                new SimpleDoubleProperty((slider.getPrefWidth() //
                - (2 * margin)) / (slider.getMax() - slider.getMin()));

        SimpleDoubleProperty pathXProperty = new SimpleDoubleProperty();
        pathXProperty.bind(slider.layoutXProperty()//
                .add(margin)//
                .add(pixelsPerValueProperty.multiply(slider.valueProperty().subtract(slider.getMin()))));

        MoveTo moveTo = new MoveTo(0, 0);
        moveTo.xProperty().bind(pathXProperty);
        LineTo lineTo = new LineTo(0, 25);
        lineTo.xProperty().bind(pathXProperty);

        Path path = PathBuilder.create().elements(
                moveTo, lineTo)//
                .stroke(Color.CYAN)//
                .strokeWidth(3)//
                .translateX(0)//
                .translateY(77.0)//
                .build();

        Group group = new Group(slider, path);
        primaryStage.setScene(new Scene(group, 700, 250));
        System.out.println("before slider.getWidth() = " + slider.getWidth());
        primaryStage.show();
        System.out.println("after slider.getWidth() = " + slider.getWidth());
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T19:57:15.603

```
private void addMarker() {

       double margin = 7; // left and right margins between the border and the slider line of the slider

        SimpleDoubleProperty pixelsPerValueProperty = new SimpleDoubleProperty( //
                (slider.getPrefWidth() - (2 * margin)) / (slider.getMax() - slider.getMin())); // need preferred width even though called from keystroke handler

        SimpleDoubleProperty pathXProperty = new SimpleDoubleProperty();
        pathXProperty.bind(slider.layoutXProperty()//
                .add(margin)//
                .add(pixelsPerValueProperty.multiply(slider.valueProperty().subtract(slider.getMin())))//
        );

        double currentValue = pathXProperty.doubleValue(); 
        MoveTo moveTo = new MoveTo(0, 0);
        moveTo.setX(currentValue);
        LineTo lineTo = new LineTo(0, 25);
        lineTo.setX(currentValue);

        Path myTick = PathBuilder.create()
            .elements(
                moveTo
                , lineTo
                )
            .stroke(Color.CYAN)
            .strokeWidth(3)
            .translateX(0)     // for path instantiated in FXML = 7.0
            .translateY(27.0)
            .managed(true)
            .build();

        pathGroup.getChildren().add(myTick);

} 
```

# regex - Python 在文本文件中查找和替换

> ID：11621697
> 
> 赞同：1
> 
> 时间：2012-07-23T22:53:26.127
> 
> 标签：regex, python-2.7, replace

您好，我无法让我的 Python 正常工作。我有以下格式的文本文件：

```
3|1|15382|25364||
3|2|15384|25364||
43|1|27444|27297|4849569|
43|2|27486|27297|4329265|
107|2|24940|684269||
115|1|24869|684269|| 
```

我当前的 Python 代码：

```
f1 = open('myFile.txt', 'r')
f2 = open('myFileOutput.txt', 'w')
for line in f1:
    f2.write(line.replace('|\n', ','))
f1.close()
f2.close() 
```

我当前的代码将创建一个如下所示的 myFileOutput.txt：

> 3|1|15382|25364|,3|2|15384|25364|,43|1|27444|27297|4849569,43|2|27486|27297|4329265,107|2|24940|684269|,115|1 |24869|684269||

我想要的是当两个 || 之间没有数据时 它应该保留第二个|。我当前的代码没有这样做。这是我希望它看起来像的示例：

> 3|1|15382|25364||,3|2|15384|25364||,43|1|27444|27297|4849569,43|2|27486|27297|4329265,107|2|24940|684269||, 115|1|24869|684269||

我使用的是 Python 2.7.3，这些文件的大小也可以达到 500MB。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:15:25.590

利用`f2.write(line.replace('|\n', ',').replace('|,', '||,'))`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-23T23:00:11.077

One easy way to do this would be to first replace "||\n" with "|||\n", so the new code would be

```
f1 = open('myFile.txt', 'r')
f2 = open('myFileOutput.txt', 'w')
for line in f1:
    line = line.replace('||\n', '|||\n')
    f2.write(line.replace('|\n', ','))
f1.close()
f2.close() 
```

# django - 从 repo 中删除 .pyc 文件时出现 Django 错误

> ID：11621711
> 
> 赞同：1
> 
> 时间：2012-07-23T22:54:41.557
> 
> 标签：django, git

几个小时以来，我一直在为此挠头。

我一直很高兴地在测试服务器上拉我的回购。该项目有很多提交。我想从我的 repo 中清除所有 .pyc 文件，所以在我的 master 中删除它们并将 *.pyc 添加到 .gitignore。那是对最后一次提交的唯一更改。

现在，当我拉到测试服务器时，Django 导入失败。但是，该模块在那里，除了 .pyc 删除之外没有其他更改。所以这个错误基本上是假的。

如果我重新添加 .pyc 文件，它会再次正常工作。

任何人都可以对此有所了解吗？

编辑：

这是回溯：

```
Traceback (most recent call last):
File "./manage.py", line 14, in <module>
  execute_manager(settings)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/core/management/__init__.py", line 438, in execute_manager
  utility.execute()
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/core/management/__init__.py", line 379, in execute
  self.fetch_command(subcommand).run_from_argv(self.argv)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/core/management/base.py", line 191, in run_from_argv
  self.execute(*args, **options.__dict__)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/core/management/base.py", line 209, in execute
  translation.activate('en-us')
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/utils/translation/__init__.py", line 100, in activate
  return _trans.activate(language)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/utils/translation/trans_real.py", line 202, in activate
  _active.value = translation(language)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/utils/translation/trans_real.py", line 185, in translation
  default_translation = _fetch(settings.LANGUAGE_CODE)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/utils/translation/trans_real.py", line 162, in _fetch
  app = import_module(appname)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
  __import__(name)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/contrib/admin/__init__.py", line 3, in <module>
  from django.contrib.admin.helpers import ACTION_CHECKBOX_NAME
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/contrib/admin/helpers.py", line 3, in <module>
  from django.contrib.admin.util import (flatten_fieldsets, lookup_field,
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/contrib/admin/util.py", line 1, in <module>
  from django.db import models
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/db/__init__.py", line 67, in <module>
  router = ConnectionRouter(settings.DATABASE_ROUTERS)
File "/home/galadarwin/.virtualenvs/datazone/lib/python2.7/site-packages/django/db/utils.py", line 114, in __init__
  raise ImproperlyConfigured('Error importing database router %s: "%s"' % (klass_name, e))
django.core.exceptions.ImproperlyConfigured: Error importing database router JournalRouter: "No module named journal.routers" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T12:35:55.940

事实证明，它`__init__.py`已经作为 .gitignore 中的一个参数出现了。所以我所有的模块都是在没有`__init__.py`. 虽然这些`__init__.pyc`文件仍然存在，但它们必须被用作“后备”（我没有意识到 python 这样做了），所以我的错误被混淆了。我的错，但我学到了一些很好的教训。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-02T10:37:04.653

要清理 Django .pyc 文件，请在终端中执行一个或所有命令：

```
$ python manage.py cleanup
$ pyclean .
$ find . -name "*.pyc" -exec rm -f {} \;
$ find . -name \*.pyc -delete
$ python manage.py clean_pyc 
```

# php - WordPress 管理员失败

> ID：11621712
> 
> 赞同：0
> 
> 时间：2012-07-23T22:54:45.343
> 
> 标签：php, wordpress, login

我正在尝试在[http://www.kzoomarketing.com/tascott/wp-login.php登录 wordpress 管理员](http://www.kzoomarketing.com/tascott/wp-login.php)

我收到这条消息：

```
Warning: Header may not contain more than a single header, new line detected. in /home/absbm/public_html/tascott/wp-login.php on line 361

Warning: Cannot modify header information - headers already sent by (output started at /home/absbm/public_html/tascott/wp-login.php:361) in /home/absbm/public_html/tascott/wp-login.php on line 363

Warning: Cannot modify header information - headers already sent by (output started at /home/absbm/public_html/tascott/wp-login.php:361) in /home/absbm/public_html/tascott/wp-includes/pluggable.php on line 669

Warning: Cannot modify header information - headers already sent by (output started at /home/absbm/public_html/tascott/wp-login.php:361) in /home/absbm/public_html/tascott/wp-includes/pluggable.php on line 670

Warning: Cannot modify header information - headers already sent by (output started at /home/absbm/public_html/tascott/wp-login.php:361) in /home/absbm/public_html/tascott/wp-includes/pluggable.php on line 671

Warning: Cannot modify header information - headers already sent by (output started at /home/absbm/public_html/tascott/wp-login.php:361) in /home/absbm/public_html/tascott/wp-includes/pluggable.php on line 673

Warning: Cannot modify header information - headers already sent by (output started at /home/absbm/public_html/tascott/wp-login.php:361) in /home/absbm/public_html/tascott/wp-includes/pluggable.php on line 866 
```

我删除了 login.php 末尾的空格，但仍然收到此错误。

我还查看了第 361 行，并将该文件与其他 wordpress 安装进行了比较，没有发现任何问题。

对此问题的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-25T18:12:21.013

我有同样的问题，我解决了这个问题：

[http://wordpress.org/support/topic/warning-header-may-not-contain-more-than-a-single-header-1](http://wordpress.org/support/topic/warning-header-may-not-contain-more-than-a-single-header-1)

joshfraz 发表于 4 年前

我也有这个问题。事实证明，我的 siteurl 选项末尾有一个额外的空间。一旦我删除了空间，它就可以正常工作。

因此，在您的 WP 数据库中，检查 wp_options > siturl 并删除值字段中的任何额外空格或换行符。

如果第一种方法不能解决您的问题，其他一些用户可能会遇到 utf8 BOM 代码问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T22:59:58.550

`<?php`当您的文件在and之前或之后包含空格时，通常会弹出此类错误`?>`。

如果您有插件或自定义的东西，请确保`<?php`. 通常`?>`可以完全省略以避免出现问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T23:00:23.473

You should not change your core files.

I suspect one of your plugin files causes the problem, try disabling them one by one, if you find the one remove the last ?> in the offending file.

There is also a plugin which goes by all your plugins and then deletes all whitespaces at the end.

# css - 访问相对于生成内容的子元素

> ID：11621714
> 
> 赞同：0
> 
> 时间：2012-07-23T22:54:49.433
> 
> 标签：css, css-selectors, pseudo-element

假设我有这样的 HTML：

```
<div class="foo">
    <div>Stuff</div>
</div> 
```

还有一些像这样的CSS：

```
.foo > div { display: none; }
.foo:after { /* rules */ } 
```

我希望能够做类似的事情

```
.foo:after:hover > div { display: block; } 
```

让用户将鼠标悬停在生成的内容元素上并显示 child `div`。有谁知道如何做到这一点？到目前为止，我的尝试都没有结果。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T08:26:44.757

这个问题似乎与[Can I target a :before or :after 伪元素与兄弟组合器相反？](https://stackoverflow.com/questions/7735267/can-i-target-an-after-pseudo-element-with-a-sibling-combinator/7748876#7748876)

在您的情况下，您不能将伪类应用于伪元素。这也意味着您不能选择仅在伪元素打开`:hover` *而不是其生成元素*时应用样式。相反，您只能根据其生成元素的伪类状态选择一个伪元素，并且仅当该生成元素是选择器的主题时。

此外，如前所述，伪元素不是 DOM 的一部分。因此，类似于在我对上述问题的回答（上述链接中的解释）中，您无法在同一生成元素中相对于真实子元素访问伪元素：

```
a[href^="http"] img ~ :after 
```

您不能选择相对于同一生成元素中的伪元素的真实元素：

```
.foo:after > div 
```

所以总结一下，以下选择器不起作用的原因：

```
.foo:after:hover > div 
```

是双重的：

1.  伪元素不能有伪类状态，使得`:after:hover`无效。

2.  这里选择器的主题不是`.foo`，而是`div`，所以`:after`不能应用于`.foo`。因此，在将伪元素应用于另一个选择器之后尝试选择一个真实元素作为选择器的主题是没有意义的。

如果您真的不能在 on 上显示您`div`的`.foo:hover`，而是在另一个子元素上显示，那么您在不使用 JavaScript 的情况下解决此问题的唯一方法是在该元素`.foo`之前*（*而`div`不是*之后*）创建另一个真正的元素：

```
<div class="foo">
    <div></div>
    <div>Stuff</div>
</div> 
```

这是因为[没有先前的兄弟选择器](https://stackoverflow.com/questions/1817792/css-previous-sibling-selector)；您可以使用的相邻兄弟选择器`:after >`仅用于选择*下一个*兄弟：

```
.foo > div:first-child + div { display: none; }
.foo > div:first-child { /* rules */ }
.foo > div:first-child:hover + div { display: block; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T22:58:06.137

您无法与生成的内容进行交互，因为它不存在于 DOM 中（可以*访问*，但至少到目前为止，它是只读的）；您唯一的选择是`:hover`自行使用`.foo`：

```
.foo:hover > div { } 
```

当然，您可以在以下位置对生成的内容进行不同的样式设置`:hover`：

```
.foo:hover::after { } 
```

但是，我怀疑，这可能不是你想做的任何部分。

另外，您的选择器写成：`.foo:after:hover > div`我认为，会尝试为`div`生成内容的子项设置样式；它不能有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T22:59:02.073

你很亲密。只需放弃 :after 部分。

[http://jsfiddle.net/QERPq/](http://jsfiddle.net/QERPq/)

更新： http: [//jsfiddle.net/QERPq/2/](http://jsfiddle.net/QERPq/2/) 基本上，这表示当您将鼠标悬停在该项目上时，选择下一个项目（* = catchall）并显示它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T23:22:40.350

试试这个解决方案：http: [//jsfiddle.net/QERPq/4/](http://jsfiddle.net/QERPq/4/)。

它可能是也可能不是你所追求的。

**HTML：**

```
<div class="foo">pre-hover stuff</div> 
```

**CSS：**

```
.foo > div {
    display: none;
    font-size: 200px;
}
.foo:after {
    content: '';
    display: block;
    position: absolute;
    left: 100px;
    top: 100px;
    width: 100px;
    height: 20px;
    background: yellow;
}
.foo:hover:after {
    display: block;
    content: 'Stuff';
    width: 40px;
    height: 40px;
    background: red;
} 
```

# wcf - 无法通过邮寄到达 WCF 休息端点

> ID：11621717
> 
> 赞同：1
> 
> 时间：2012-07-23T22:54:52.130
> 
> 标签：wcf, rest, soap, azure, unity-container

我正在尝试创建托管在 Azure Web 角色中的 WCF 服务。该服务必须能够通过肥皂和休息到达。

我一直在阅读一些文章，并且能够创建（或者至少我是这么认为的）具有所有规范的服务。

我想要做的是使用 SoapUI 项目使用我的休息端点，使用带有所有参数的查询字符串执行 POST，但是当我运行这个项目时，我得到的响应是：

> 服务器在处理请求时遇到错误。异常消息是“反序列化操作“CPlano”的请求消息正文时出错。OperationFormatter 无法反序列化消息中的任何信息，因为消息为空 (IsEmpty = true)。

这是我的 Web.Config 的一部分：

```
<bindings>
  <webHttpBinding>
    <binding name="webBinding" maxReceivedMessageSize ="50000000" maxBufferPoolSize="50000000">
      <readerQuotas maxDepth="500000000" maxArrayLength="500000000" maxBytesPerRead="500000000"
                    maxNameTableCharCount="500000000" maxStringContentLength="500000000"/>
      <security mode="None" />
    </binding>
  </webHttpBinding>
</bindings>
<behaviors>
  <endpointBehaviors>
    <behavior name="RestBehavior">
      <webHttp/>
    </behavior>
  </endpointBehaviors>
  <serviceBehaviors>
    <behavior name="ServiceBehavior">
      <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
      <serviceMetadata httpGetEnabled="true"/>
      <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
      <serviceDebug includeExceptionDetailInFaults="true"/>
    </behavior>
  </serviceBehaviors>
</behaviors>
<services>
  <service name="Namespace.CService" behaviorConfiguration="ServiceBehavior">
    <endpoint name="RESTEnpoint" contract="Namespace.ICService" binding="webHttpBinding" bindingConfiguration="webBinding" bindingNamespace="http://www.example.com/" address="rest" behaviorConfiguration="RestBehavior" />
    <endpoint name="SOAPEndpoint" contract="Namespace.ICService" binding="basicHttpBinding" bindingNamespace="http://www.example.com/" address=""></endpoint>
  </service>
</services> 
```

这也是我的服务接口声明：

```
[ServiceContract(Namespace = "http://www.example.com/")]
public interface ICService
{
    [OperationContract]
    [WebInvoke(UriTemplate = "/CPlano",
    BodyStyle = WebMessageBodyStyle.Wrapped,
    Method = "POST")]
    RespuestaCotizador CPlano(int idUsuario, string usuario, string pass, int modalidad, int servicio,
        int medicion, string paisDestino, int envio, decimal peso, decimal largo, decimal ancho, decimal alto);
} 
```

最后是我的响应类：

```
[DataContract(Namespace = "http://www.example.com/")]
public class RespuestaCotizador
{
    [DataMember]
    public bool HasError;
    [DataMember]
    public string ErrorMessageESP;
    [DataMember]
    public string ErrorMessageENG;
    [DataMember]
    public decimal PrecioCotizado;

    public RespuestaCotizador()
    {
        HasError = false;
        ErrorMessageESP = string.Empty;
        ErrorMessageENG = string.Empty;
        PrecioCotizado = 0;
    }
} 
```

我正在使用统一进行依赖注入，但这似乎无关紧要。

即使我在本地运行服务，我什至可以到达第一个断点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T11:58:25.720

您想使用 SOAP 还是 REST？如果要使用 SOAP，请使用其他绑定，例如 BasicHttpBinding。WebHttpBinding 通常用于 REST 服务。如果你想使用 REST，你可以创建一个类来封装像 idUsuario 和 usuario 这样的所有东西。将服务方法配置为接受单个参数：您的新类。然后在进行 POST 时，将序列化对象作为请求正文传递。此外，您不能使用 WCF 测试客户端来使用 REST 服务。它只支持 SOAP。但是，您可以使用 Fiddler。或者（建议用于新服务），使用 ASP.NET Web API 而不是 WCF 来构建 REST 服务。

# python - 这对我的简单 web 应用程序来说是否足够验证/清理？

> ID：11621724
> 
> 赞同：0
> 
> 时间：2012-07-23T22:55:50.710
> 
> 标签：python, web-applications, security

首先，我是 Web 开发的新手。我正在制作一个简单的 mod_wsgi webapp，它有两个文本字段来接受用户输入。

第一个输入 nnodes 必须是 0-30 之间的整数。

第二个输入，大小，必须是整数或介于 0-20 之间的浮点数。

到目前为止，这是我在脚本中的验证/清理。看到我稍后在脚本中如何使用输入重定向，我希望有人可以评论我是否容易受到任何重大恶意威胁的影响：

```
 nnodes = escape(nnodes)
    size = escape(size)

    if nnodes.isdigit() and int(nnodes) in range(31):
        pass
    elif nnodes=='':
        response_body=html % ' '
        status='200 OK'
        response_headers = [('Content-Type', 'text/html'),('Content-Length',str(len(response_body)))] 
        start_response(status, response_headers)
        return [response_body]
    else:
        response_body=html % 'Please enter the number of malignant nodes as a whole number between 0 and 30.'
        status='200 OK'
        response_headers = [('Content-Type', 'text/html'),('Content-Length',str(len(response_body)))] 
        start_response(status, response_headers)
        return [response_body]

###Validate that the tumorsize is a float between 0-25\. 
    try:
        size=='' or float(size)
        pass
    except:
        response_body=html % 'Please enter the tumor size as a number between 0 and 25.'
        status='200 OK'
        response_headers = [('Content-Type', 'text/html'),('Content-Length',str(len(response_body)))] 
        start_response(status, response_headers)
        return [response_body]

    if 0<=float(size)<=25:
        pass
    elif size=='':
        response_body=html % ' '
        status='200 OK'
        response_headers = [('Content-Type', 'text/html'),('Content-Length',str(len(response_body)))] 
        start_response(status, response_headers)
        return [response_body]
    else:
        response_body=html % 'Please enter the tumor size as a number between 0 and 25.'
        status='200 OK'
        response_headers = [('Content-Type', 'text/html'),('Content-Length',str(len(response_body)))] 
        start_response(status, response_headers)
        return [response_body]

###After the validation, I use input redirection to pass the input to an R script.  I know this is not optimal but I can't get the Rpy2 module to work on my server.  
###I also know that input redirection can open an app up to shell injection, but that is why I am asking you all if I've done sufficient validation and sanitization.

commandString="/home/usr/bin/R --no-save --quiet --slave --args " + str(nnodes) + " " + str(size) + " </home/usr/webapps/simple/htdocs/webcalc.R"
subprocess.call(commandString,shell=True) 
```

我感谢大家必须提供的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T00:10:39.817

“永远不要相信用户”就足够了。但是“永远不要相信程序员”是另一个有效的格言。即使您可能认为您的验证和清理程序是铁定的，也可能存在一个微妙的错误，可能允许恶意输入通过。安全总比后悔好。

我从手册页中找到了更多关于 R 解释器的信息。显然有一个 -f 参数可以让您指定输入文件。所以这整件事可以修复：

```
# Split out the filename for easier refactoring
r_script = '/home/usr/webapps/simple/htdocs/webcalc.R'
# We can give an iterable to subprocess.call()
command_args = ['/home/usr/bin/R', '-f', r_script, '--no-save', '--quiet', '--slave', '--args', str(nnodes),
    str(size)]
# And since we don't need shell features like '<', shell=True goes away!
subprocess.call(command_args) 
```

请注意，验证和清理输入仍然*非常重要。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:51:17.300

这段代码闻起来很糟糕。您对如何执行规则非常不清楚。您的代码完全缺乏抽象。

在执行安全性验证检查时，您**绝对**不应该使用 try/catch all 块。除非您捕获特定的异常类型，否则您不知道为什么操作可能会失败。对于所有用户数据，您应该能够检查类型、执行强制转换、检查值的范围而不会引发异常。此外，您应该使用单一方法来显示错误页面。

> 复杂性是安全的最大敌人。
> 
> ——布鲁斯·施奈尔

# c# - c# 将 System.Drawing.Graphics 保存到文件

> ID：11621726
> 
> 赞同：1
> 
> 时间：2012-07-23T22:55:58.683
> 
> 标签：c#, gdi+, picturebox

我有一个从图片框中获取的 System.Drawing.Graphics。

基本上我在存储到图片框中的背景图像上画了一些线条现在我希望保存一个包含背景图像的 png 并且所有内容都绘制在那里......

有没有办法做到这一点？提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T23:02:48.460

是的，在 PictureBox 的图像上使用[Image.Save 方法：](http://msdn.microsoft.com/en-us/library/system.drawing.image.save.aspx)

```
pictureBox.Image.Save(fullnameOfYourImage, System.Drawing.Imaging.ImageFormat.Png); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:04:18.843

如果您在 Paint 事件上绘制这些线条，那么您需要使用 BackgroundImage 创建一个 BitMap，并使用 Bitmap 的 Graphics 调用您的绘制函数，然后调用 Bitmap.Save()。

```
 Bitmap bmp = new Bitmap(MyPictureBox.BackgroundImage);
        var g = Graphics.FromImage(bmp);
        MyPictureBox.OnPaint(new System.Windows.Forms.PaintEventArgs(g, bmp.GetBounds()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T23:02:26.253

很确定您可以转换为位图并保存吗？

见这篇文章：

[将 System.Drawing.Graphics 保存为 png 或 bmp](https://stackoverflow.com/questions/2928845/saving-system-drawing-graphics-to-a-png-or-bmp)

# eclipse - 修改 MapEditor - uDig Eclipse RCP

> ID：11621729
> 
> 赞同：0
> 
> 时间：2012-07-23T22:56:09.950
> 
> 标签：eclipse, gis, rich-client-platform

我目前正在使用 uDig 进行一个研究项目。

我正在尝试使用 MapEditor 类来显示显示实时调度的交互式地图。

我遇到的当前问题与 MapEditor 类的打开-保存-关闭生命周期有关。每次用户启动程序时，我希望工作台中只有一个 MapEditor，但是，当应用程序打开时，程序也会显示旧的 MapEditor。除此之外，还有一些我希望能够禁用的其他功能。我希望用户能够在没有程序询问用户是否要保存地图的情况下关闭整个应用程序。我还想禁用编辑器“isDirty”时显示的星号。

经过一番搜索，我在折射论坛上找到了一个与我遇到的相同问题相关的帖子，但是发帖人从未透露他/她的最终解决方案（如果有的话）。

关于如何以最少侵入性的方式纠正这些问题的任何想法。

非常感谢您的宝贵时间！

# .net - Powershell HTTPS REST API GET/POST

> ID：11621733
> 
> 赞同：3
> 
> 时间：2012-07-23T22:56:38.560
> 
> 标签：.net, rest, powershell, https

我正在尝试测试一个非常简单的 powershell 脚本来从内部票务站点获取/发布数据。我遇到了一个似乎与所需 SSL 证书有关的问题。有人可以帮我理解我需要添加哪些代码才能完成这项工作吗？

谢谢

**返回错误**：使用“0”参数调用“GetResponse”的异常：“底层连接已关闭：无法为 SSL/TLS 安全通道建立信任关系。”

当前代码：

```
 $url = "https://username:password@IPADDRESS/ticket"
 $command = get-content jsonfile.json

 $bytes = [System.Text.Encoding]::ASCII.GetBytes($command)
 $web = [System.Net.WebRequest]::Create($url)
 $web.Method = "POST"
 $web.ContentLength = $bytes.Length
 $web.ContentType = "application/json"
 $stream = $web.GetRequestStream()
 $stream.Write($bytes,0,$bytes.Length)
 $stream.close()

 $reader = New-Object System.IO.Streamreader -ArgumentList
 $web.GetResponse().GetResponseStream()
 $reader.ReadToEnd()
 $reader.Close() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T23:28:25.360

我能够从Powershell v3 中引入的新[Invoke-RestMethod cmdlet 中获得所需的功能。](http://technet.microsoft.com/Library/hh849971.aspx)此方法允许您包含我做过但没有收到任何错误的证书。

# regex - 解析字符串末尾的多个单词 - 正则表达式

> ID：11621734
> 
> 赞同：1
> 
> 时间：2012-07-23T22:56:40.073
> 
> 标签：regex, python-2.7

基本上，我在日志中有一行，我已经从中解析了一些信息。我似乎无法弄清楚如何从行尾提取一大块文本。例如：

```
2012-06-25 16:19:42,777 [main]  INFO  ControllerServiceImpl.java (line 72) Starting controller service 
```

"**启动控制器服务**"

我已经使用正则表达式来取出日期和其他信息，但我正在寻找一种方法来取出括号后将行号关闭到字符串末尾的所有单词（粗体）

吨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:01:25.783

您可以通过积极的向后看来做到这一点？<=。图案：

```
(?<=\))(\s?\w)+$ 
```

如果你有不止一行，不要忘记添加标志 'm' - 多行标志。

# python - 如何判断一年是否为闰年？

> ID：11621740
> 
> 赞同：60
> 
> 时间：2012-07-23T22:57:19.990
> 
> 标签：python

我正在尝试制作一个简单的计算器来确定某一年是否是闰年。

根据定义，闰年可以被四整除，但不能被一百整除，除非它可以被四百整除。

这是我的代码：

```
def leapyr(n):
    if n%4==0 and n%100!=0:
        if n%400==0:
            print(n, "is a leap year.")
    elif n%4!=0:
        print(n, "is not a leap year.")
print(leapyr(1900)) 
```

当我在 Python IDLE 中尝试此操作时，模块返回`None`. 我很确定我应该得到`1900 is a leap year`.

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2012-07-24T00:40:47.063

使用[`calendar.isleap`](https://docs.python.org/3/library/calendar.html#calendar.isleap)：

```
import calendar
print(calendar.isleap(1900)) 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2015-06-08T16:10:51.847

作为一个单行函数：

```
def is_leap_year(year):
    """Determine whether a year is a leap year."""

    return year % 4 == 0 and (year % 100 != 0 or year % 400 == 0) 
```

它类似于[Mark's answer](https://stackoverflow.com/a/11622506/244297)，但在第一次测试时短路（注意括号）。

[`calendar.isleap`](https://docs.python.org/3/library/calendar.html#calendar.isleap)或者，您可以使用具有完全相同[实现](https://github.com/python/cpython/blob/3.9/Lib/calendar.py#L100)的标准库：

```
from calendar import isleap
print(isleap(1900))  # False 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-07-23T23:05:32.740

你在 n 上测试三个不同的东西：

```
n % 4
n % 100
n % 400 
```

对于 1900：

```
1900 % 4 == 0
1900 % 100 == 0
1900 % 400 == 300 
```

所以 1900 没有进入`if`子句，因为`1900 % 100 != 0`is`False`

但是 1900 也没有进入`else`子句，因为`1900 % 4 != 0`is also`False`

这意味着执行到了函数的末尾并且没有看到 return 语句，所以它返回`None`.

您的函数的这种重写应该有效，并且应该返回`False`或`True`根据您传递给它的年份编号。（请注意，与其他答案一样，您必须返回一些东西而不是打印它。）

```
def leapyr(n):
    if n % 400 == 0:
        return True
    if n % 100 == 0:
        return False
    if n % 4 == 0:
        return True
    return False
print leapyr(1900) 
```

（来自[维基百科](http://en.wikipedia.org/wiki/Leap_year)的算法）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-07-24T00:31:51.220

整个公式可以包含在一个表达式中：

```
def is_leap_year(year):
    return (year % 4 == 0 and year % 100 != 0) or year % 400 == 0

print n, " is a leap year" if is_leap_year(n) else " is not a leap year" 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-23T23:01:28.327

您的函数不返回任何内容，这就是为什么当您将它与`print`您得到的语句一起使用时`None`。所以要么像这样调用你的函数：

```
leapyr(1900) 
```

或修改您的函数以返回一个值（通过使用`return`语句），然后您的语句将打印该值`print`。

***注意*：这并没有解决您在闰年计算中可能遇到的任何问题，而是回答您的具体问题**，即*为什么*您`None`的函数调用与您的`print`.

*说明*：

关于上述内容的一些简短示例：

```
def add2(n1, n2):
    print 'the result is:', n1 + n2  # prints but uses no *return* statement

def add2_New(n1, n2):
    return n1 + n2    # returns the result to caller 
```

现在当我打电话给他们时：

```
print add2(10, 5) 
```

这给出了：

```
the result is: 15
None 
```

第一行来自*内部*的`print`语句。当**我**调用没有返回语句的函数时，来自打印语句，导致打印。顺便说一句，如果我只是 简单地使用（注意，***没有***声明）调用该函数：*`add2()``None``add2()`**`None``add2()` *`print`****

 ****```
add2() 
```

`the result is: 15`如果没有`None`（看起来像您正在尝试做的事情），我只会得到 print 语句的输出。

将此与以下内容进行比较：

```
print add2_New(10, 5) 
```

这使：

```
15 
```

在这种情况下，结果在函数中计算，`add2_New()`没有打印语句，然后返回给调用者，然后调用者依次打印。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-02-16T12:03:14.940

闰年可以被 4 整除，但世纪年（以 00 结尾的年份）除外。只有当世纪年能被 400 整除时，它才是闰年。例如，

```
if( (year % 4) == 0):
    if ( (year % 100 ) == 0):

        if ( (year % 400) == 0):

            print("{0} is a leap year".format(year))
        else:

            print("{0} is not a leap year".format(year))
    else:

        print("{0} is a leap year".format(year))

else:

    print("{0} is not a leap year".format(year)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-12T12:58:54.470

如果你不想`import calendar`应用`.isleap`方法，你可以试试这个：

```
def isleapyear(year):
    if year % 4 == 0 and (year % 100 != 0 or year % 400 == 0):
        return True
    return False 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-12T16:48:20.547

在公历中，使用三个条件来识别闰年：

*   年份可以被4整除，是闰年，除非：
    *   年份可以除以 100，它不是闰年，除非：
        *   年份也能被 400 整除。那么就是闰年。

这意味着在公历中，2000 年和 2400 年是闰年，而 1800、1900、2100、2200、2300 和 2500 年不是闰年。[来源](https://www.timeanddate.com/date/leapyear.html)

```
def is_leap(year):
    leap = False
    if year % 4 == 0:
        leap = True
        if year % 4 == 0 and year % 100 == 0:
            leap = False
            if year % 400 == 0:
                leap = True 
    return leap

year = int(input())
leap = is_leap(year)

if leap:
  print(f"{year} is a leap year")
else:
  print(f"{year} is not a leap year") 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-24T04:59:52.587

“单线”中的逻辑运行良好。从个人经验来看，对我有帮助的是将语句分配给变量（以它们的“真”形式），然后对结果使用逻辑运算符：

```
A = year % 4 == 0
B = year % 100 == 0
C = year % 400 == 0 
```

我在 B 语句中使用了 '==' 而不是 "!=" 并在计算中应用了 'not' 逻辑运算符：

```
leap = A and (not B or C) 
```

这对一组更大的条件很有用，并在编写一大堆 if 语句之前在适用的情况下简化布尔运算。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-05T19:03:02.727

另一种衬里：

`((((y % 4) + (int((y - (y % 100)) / y) * ((y % 400) / 100))) - 1) < 0)`

这是我为了好玩而拼凑起来的东西（？），它也与 C 1:1 兼容。

`(y % 4)`>>>它首先通过典型的 mod-4 检查检查年份是否为闰年。

`(int((y - (y % 100)) / y)`>>>然后计算能被 100 整除的年份。如果年份能被 100 整除，则结果为 1，否则结果为 0。

`((y % 400) / 100)))`>>>接下来，年份除以 400（然后是 100，如果不是，则返回 1、2 或 3。

这两个值

`(int(y - (y % 100)) / y)`

&

`((y % 400) / 100)))`

然后相乘。如果年份不能被 100 整除，则它始终等于 0，否则如果它可以被 100 整除，但不能被 400 整除，则结果为 1、2 或 3。如果它同时能被 100 和 400 整除，则将导致 0。

这个值被添加到`(y % 4)`，如果在考虑了边缘情况之后年份是闰年，它才会等于 0。

最后，从剩余的值中减去 1，如果年份是闰年则为 -​​1，否则为 0、1 或 2。使用小于运算符将此值与 0 进行比较。如果年份是闰年，这将导致 True（或 1，如果在 C 中使用），否则将返回 False（或 0，如果在 C 中使用）。

请注意：这段代码效率极低，难以理解，并且不利于任何试图遵循正确做法的代码。这是我的一个练习，看看我是否可以这样做，仅此而已。

此外，请注意 ZeroDivisionErrors 是输入年份等于 0 的结果，必须加以考虑。

例如，对 1000 次执行的非常基本的 timeit 比较表明，与使用简单 if 语句和取模运算符的等效代码块进行比较时，该单行代码比等效的 if 代码块慢大约 5 倍。

话虽如此，我确实觉得它非常有趣！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-31T18:43:34.450

缺少的部分是使用 return 语句：

```
def is_year_leap(year):
    if year % 100 == 0:
        if year %  400 == 0:
            return True
        else:
            return False

    elif year % 4 == 0:
        return True

    else:
        return False

x = is_year_leap(int(input('Enter any year: ')))
print(x) 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-11-29T04:24:43.847

从 1700 年到 1917 年，官方日历是儒略历。从那以后他们我们使用公历系统。从儒略历到公历的过渡发生在 1918 年，当时 1 月 31 日之后的第二天是 2 月 14 日。这意味着 1918 年的第 32 天，是 2 月 14 日。

在这两个日历系统中，二月是唯一一个天数可变的月份，闰年有 29 天，其他年份有 28 天。在儒略历中，闰年可以被 4 整除，而在格里高利历中，闰年是以下之一：

能被 400 整除。

能被 4 整除，不能被 100 整除。

所以闰年的程序是：

```
def leap_notleap(year):

    yr = ''
    if year <= 1917:
        if year % 4 == 0:
            yr = 'leap'
        else:
            yr = 'not leap'
    elif year >= 1919:
        if (year % 400 == 0) or (year % 4 == 0 and year % 100 != 0):
            yr = 'leap'
        else:
            yr = 'not leap'
    else:
        yr = 'none actually, since feb had only 14 days'

    return yr 
```****

# java - 如果传输的数据从不共享，那么使用 ESB 有什么好处？

> ID：11621741
> 
> 赞同：0
> 
> 时间：2012-07-23T22:57:24.597
> 
> 标签：java, performance, web-services, esb

一些供应商想向我们推销将 esb 用于我们需要从用户传输到另一台服务器的一些大文件的想法。让这些数据在管道上传输而它永远不会用于任何其他应用程序并且实际上一旦存储就真正被检索到有什么兴趣？它会降低性能，尤其是当文件大到数百 mb 时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T05:18:58.197

您没有提供太多关于此处继续的信息。您有哪些访问用户文件的选项？是通过 ssh/scp、HTTP GET（从用户拉取）还是通过 HTTP PUT/POST（从用户推送）上传？其他？

你的目标是什么？您将如何将文件推送到目标？[类似的问题集]。

这如何适合您的 API/Web 界面？您或您的客户/用户将如何与界面交互以实现文件传输？它是在计时器上“自动化”的吗？轮询？

如果您现在或将来需要灵活地回答这些问题，和/或您看到源、目标、路由、附加文件、其他类型的数据等方面的任何潜在增长 [即，您有“很多要管理的东西”] - 然后考虑 ESB。ESB 中的价值是（应该是！）抽象源、目标、传输/协议和/或自动传输的调度。

因此，在缺乏细节的情况下，建议一个 ESB 非常容易。Apache ServiceMix 是开放软件，如果您愿意的话。

不利的一面是 ESB 的部署和配置，Sooo....为了在临时环境中的一个平台上自动从 A 复制到 B 以达成一次性交易，仅仅编写一个不一定是“坏的”编写脚本并安排一个 cron 作业 [您确实记录了您的部署环境，对吗？] 并完成它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T08:48:02.767

由于（某些）ESB 具有 ftp 连接器/功能，因此传输如此大的文件并不是很大的性能缺陷（网络除外）。事实上，根据您的系统/业务需求，使用 ESB 来做精简工作可能是一个好主意。

# cocos2d-iphone - 制作用于 cocos2d 的自定义位图字体

> ID：11621742
> 
> 赞同：0
> 
> 时间：2012-07-23T22:57:28.153
> 
> 标签：cocos2d-iphone, custom-font, bitmap-fonts

我一直在寻找一种方法来创建我自己的自定义位图字体以在 cocos2d 中使用。我发现的所有工具都让你的字体基于现有的 ttf，但我希望能够在 Photoshop 中从头开始创建每个字母。

我希望能够创建具有以下细节的字体： ![在此处输入图像描述](../Images/e6efecb5ffb130f77125dbdc6fecb0bb.png)

（我从一个徽标生成器网站上得到它）

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-16T07:58:18.587

如果您想渲染详细的位图字体，请查看[Glyphite.com](https://www.glyphite.com)。它在您的浏览器中运行，并且可以导出高质量的位图字体，就像您问题中的字体一样。我能够非常快速地在网站上创建一个与您的示例非常接近的近似值：

![所需位图字体的近似值。](../Images/f1c5ea0d14195ade5d9ff946e6b0847e.png)

（披露：我为 Glyphite.com 工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T05:31:38.363

试用[Glyph Designer](http://www.71squared.com/en/glyphdesigner "http://www.71squared.com/en/glyphdesigner") - Mac 的位图字体编辑器

# java - 数组比arraylist 快吗？

> ID：11621750
> 
> 赞同：16
> 
> 时间：2012-07-23T22:58:17.893
> 
> 标签：java, arrays, performance, arraylist

我的直觉说数组比数组列表更快，因为数组列表是使用在填充/丢失元素时调整大小的数组实现的。

我只是想确认这是否属实，这意味着如果您知道要保存的元素数量，就没有理由使用数组列表。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-23T23:01:00.013

任何性能差异都可以忽略不计，[特别是如果您使用`initialCapacity`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/ArrayList.html#ArrayList%28int%29). 以使其最易读和可维护的任何方式编写您的代码，并尽量不要优化这样的东西，除非您通过测试确定您从中获得了显着的性能影响。

使用的潜在原因`ArrayList`：

*   有用的方法（`contains`等）
*   实现`Iterable`、`Collection`和`List`，因此可以在许多基于接口的 API 调用中使用。
*   即使您目前“知道”您的收藏大小永远不会改变，但生活对我们提出了意想不到的要求。当没有明显的优势可获时，为什么要将自己锁定在一种模式中？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-23T23:13:07.607

ArrayList 为您提供了许多原始数组所没有的功能。如果您知道元素的数量，则可以创建该大小的 ArrayList。

```
new ArrayList<String>(100); 
```

如果您担心 ArrayList 和数组之间的速度差异，那么您担心的是错误的事情。它极不可能成为代码中的瓶颈。如果是这样，几乎肯定有比更改为数组更好的答案。

不要屈服于过早的优化。它会对你的代码造成严重破坏。大多数事情都不重要，只有少数事情重要。你只能通过分析你的代码来找到那几件事。试图使每个部分都快是使整体快的一种非常无效的方法。保持干净、简单的设计更有效。这将为您在实际需要的一两个地方引入优化提供必要的接缝。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-23T23:04:33.583

`ArrayList`在简单的获取/设置中不能更快，但差异会非常小，在几乎任何现实情况下都可能不值得担心。

API 有一些你可能需要的`List`方法，即使你已经知道大小是固定的。`contains()`例如思考。即使您知道列表的大小是固定的，您也必须`ArrayList`在需要一个`Iterator`或 API的情况下使用 -- 再次。`List`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-23T23:29:52.083

正如其他人已经说过的，使用 ArrayList 除非性能基准表明它是一个瓶颈。

是的，由于访问器开销，存在性能差异，这通常不会显着。该一般规则的一个例外是，如果您将原始类型存储在 ArrayList 中。这将再次对性能造成重大影响，因为它将对象转换为对象和原始类型/从对象和原始类型转换。

```
// easier to work with but slow
ArrayList<Double> slowList;

// faster primitive data array
double[] fasterList; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-23T23:03:11.437

是的，数组要快得多。如果您运行数值算法，您会看到明显的加速。

但是，对于正常的应用程序而言，您不必担心它。这是因为无论如何，大部分运行时都花在做其他事情上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-23T23:02:56.033

您不应该过早优化您的代码，而应使用最适合您的代码的数据结构。正如您所说，经验法则可能是：

1.  我不知道元素的数量或者它正在改变很多=>列表（不要专注于实现）

2.  元素的数量是预先已知的 => 数组

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-23T23:03:04.253

如果您知道数组的大小，请确保它不会扩大或缩小。比使用数组。如果您不知道，数组列表更可取且稳定。对于性能，这是您唯一关心的问题吗？向前走..

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-11-28T10:14:15.423

数组比数组列表快得多。差异可能有数百个百分点，并且可能来自 JVM 优化。如果您将数组变量声明为 volatile，您将获得类似的性能。

# objective-c - 以编程方式推送模态视图控制器

> ID：11621754
> 
> 赞同：1
> 
> 时间：2012-07-23T22:58:33.850
> 
> 标签：objective-c, xcode, cocoa-touch, uiviewcontroller, modal-dialog

> **可能重复：**
> [如何使用情节提要在 4.2 Xcode 中创建自定义模态序列](https://stackoverflow.com/questions/8097398/how-to-create-custom-modal-segue-in-4-2-xcode-using-storyboard)

所以我有一个视图控制器，我想以模态方式推送到我当前的视图控制器上。这是我的故事板的屏幕截图，我试图加载的视图突出显示： ![在此处输入图像描述](../Images/59e984ec8afe9fc49cf4278e18554b6f.png)

所以我在当前视图和第二个导航控制器之间创建了一个 segue，我们称之为“警报”。因为我没有将 segue 绑定到任何类型的按钮，所以我只是尝试在以下 if 语句中以模态方式加载视图：

```
if([detector judgeSpeed:[ratio floatValue]])
{
    //push the new view here
} 
```

我该怎么做？我是否需要实现某种委托或 prepareForSegue 方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T23:17:17.197

您可以使用 segue，但这是另一种选择：

```
SomeViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"SomeIdentifier"];
[self.navigationController presentModalViewController:controller animated:YES] 
```

请记住在情节提要中设置视图控制器的标识符。

更多信息和示例项目[在这里](https://stackoverflow.com/a/8348527/1044642)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T23:01:04.613

**presentModalViewController**是 iOS 6 的代码，但我需要 iOS 9 的代码。有人可以帮忙吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T23:25:10.663

答案是关于[How to create custom modal segue in 4.2 Xcode using storyboard](https://stackoverflow.com/questions/8097398/how-to-create-custom-modal-segue-in-4-2-xcode-using-storyboard)应该有所帮助。

[TJ](https://stackoverflow.com/users/971518/t-j)的回答：

```
UIViewController *src = (UIViewController *) self.sourceViewController;
[UIView transitionWithView:src.navigationController.view duration:0.5
                   options:UIViewAnimationOptionTransitionFlipFromTop
                animations:^{
                    [src.navigationController popToViewController:[src.navigationController.viewControllers objectAtIndex:0] animated:NO];;
                }
                completion:NULL]; 
```

[蒂格罗](https://stackoverflow.com/users/997084/tiguero)的回答：

```
[self.sourceViewController presentModalViewController:self.destinationViewController animated:NO]; 
```

这些答案中的任何一个也应该回答这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T23:17:36.697

在情节提要中，通过从视图控制器本身 ctrl 拖动到新视图控制器，创建从演示视频捕获视图控制器到新视图控制器的 segue。您可以通过 ctrl 从 Demo Video Capture View Controller 下方黑色条中的黄色按钮拖动到新视图来执行此操作。当它询问哪种选择时`modal`。仍在情节提要中，单击 segue 并在右侧的身份导航器中将其标识为“警报”。现在转到您的 .m 文件并使用此实现...

```
if([detector judgeSpeed:[ratio floatValue]])
{
   [self performSegueWithIdentifier:@"alert" sender:self];
} 
```

# android - 遍历列表以查找权限

> ID：11621760
> 
> 赞同：1
> 
> 时间：2012-07-23T22:59:03.180
> 
> 标签：android, list, permissions, iteration, loops

我目前正在尝试遍历列表以从手机上所有已安装的应用程序中查找特定权限，有人可以告诉我遍历列表的正确方法吗？

```
public void getPermissions(Context context) {
    PackageManager packageManager = context.getPackageManager();
    final List<PackageInfo> apps = context.getPackageManager()
        .getInstalledPackages(PackageManager.GET_PERMISSIONS);

    for (PackageInfo pi : apps) {
        String[] permissions = pi.requestedPermissions;
        if (permissions != null) {
            for (String permission : permissions) {
                Log.d("TAG", permission);
                            if (permission.equals("android.permission.INTERNET")) {

                                String appname=pi.applicationInfo.loadLabel(packageManager).toString();
                                ImageView appicon;

                                appicon = pi.applicationInfo.setImageDrawable(packageManager);
                                Log.e("TAG", "Permission found for "+ appname);

                                internetArray.add(appname);
                            }
            }
        }
    } 
```

} //getPermissions 方法结束

编辑：我已经设法开始工作并在数组列表中显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:21:55.993

```
public void getPermissions(Context context) {
     PackageManager packageManager = context.getPackageManager();
     final List<PackageInfo> apps = context.getPackageManager()
         .getInstalledPackages(PackageManager.GET_PERMISSIONS);

     for (PackageInfo pi : apps) {
         String[] permissions = pi.requestedPermissions;
         if (permissions != null) {
             for (String permission : permissions) {
                 Log.d("TAG", permission);
                 if (permission.equals("android.permission.INTERNET")) {
                     // do something
                 }
             }
         }
     }
} 
```

# ios - iOS 如何让按钮运行另一个视图控制器的代码？

> ID：11621762
> 
> 赞同：1
> 
> 时间：2012-07-23T22:59:30.587
> 
> 标签：ios

我不知道如何从不同`View Controller`的 .

我创建了一个新项目，希望能快速响应作为它的作业，并且必须在今晚之前完成。

在我的项目中，我有两个`View Controller`名字；`viewcontroller1`和`viewcontroller2`，并将它们分配给两个不同的自定义类。

`Viewcontroller1`来到屏幕它有两个`UIButtons`，一个用于运行代码，另一个用于推送到`viewcontroller2`.

当用户单击第一个时`UIButton`，我希望该按钮运行下面的代码并将结果显示`UILabel`在我的`viewcontroller2`.

该代码使用创建随机数`arc4random`，然后在`UILabel`. 该代码适用于基于单页的应用程序，并在实现中使用。

所以基本上我想要的是，当我单击第一个时，`UIButton`我想`UILabel`在`viewcontroller2`.

```
-(IBAction)button; {
    int random_num;
    random_num = (arc4random() % 5 - 1) + 1;
    if (random_num == 1) { 
    label.text = @"hello1";    
    } 
    else if (random_num == 2) {
    label.text = @"hello2";
    }
    else if (random_num == 3) {
    label.text = @"hello3";
    }
    else if (random_num == 4) {
    label.text = @"hello4";
    }
} 
```

这`timelabel`是`UILabel`我的`viewcontroller2`。

能否请您在回答中详细说明。我是初学者，可能无法立即掌握这些概念。

**例子**

用户打开应用

显示 Viewcontroller1

用户按下`button 1`其中运行代码`label`的`viewcontroller2`

用户按`button 2`下去`viewcontroller`

`Viewcontroller2`出现并且其上的标签已被按钮更改

我知道这不是一件难事，但我做不到。

对于那些之前回答过我的人和那些将回答我的人，非常感谢你..

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:24:36.910

你可以使用协议

1）像这样在 viewcontroller1.h 中创建协议

```
@protocol ViewController1Delegate <NSObject>

- (void)dealWithButton1;

@end 
```

2) 添加delegate.in viewcontroller1.h

```
@interface viewcontroller1 : XXXXX
{
    id<ViewController1Delegate> delegate;
}
@property(nonatomic,assign) id<ViewController1Delegate> delegate;

@end 
```

3) 在 vi​​ewcontroller1.m 中添加了综合

```
@synthesize delegate; 
```

4）处理按钮发送者

```
-(IBAction)button
{
    [delegate dealWithButton1];
} 
```

5）处理viewcontroller2.h

```
@interface viewcontroller2 : XXXXX<ViewController1Delegate>
{
    viewcontroller1 *vc1 ;
} 
```

6) 在 vi​​ewcontroller2.m 中绑定委托

```
vc1.delegate = self; 
```

7）在viewcontroller2.m中实现委托

```
- (void)dealWithButton1
{
int random_num;
random_num = (arc4random() % 5 - 1) + 1;
if (random_num == 1)
{ 
    label.text = @"hello1";    
}
else if (random_num == 2)
    label.text = @"hello2";
else if (random_num == 3)
    label.text = @"hello3";
else if (random_num == 4)
    label.text = @"hello4";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:38:02.710

所以，首先我要明确一点，viewcontroller1 不可能出现在屏幕上。实际上 viewcontroller1 的视图出现在屏幕上。您在屏幕上只看到视图，它们属于/由视图控制器控制。

要正确回答您的问题，我们需要知道，您使用什么来更改视图？你使用导航控制器、标签栏控制器还是其他东西？

标签通常是用于呈现文本的 UI 元素，在 viewcontroller 的 viewDidLoad 方法中初始化。因此，在此之前设置文本无济于事。

如果您从 viewcontroller1 引用了 viewcontroller2，您可以创建一个属性来保存文本并在按下按钮后设置它。viewcontroller2 可以在标签上加载视图后呈现文本。所以你在 viewcontroller1 中的代码看起来像这样

```
-(IBAction)button; {
 ViewController2 *viewController2 = [[ViewController2 alloc] init];
 viewcontroller2.textToShow = ......;
 //show view of your viewcontroller2
 // e.g.
 [self.navigationController pushViewController:viewcontroller2 animated:YES];
 } 
```

还有你的 viewcontroller2 头文件（ViewController2.h）

```
 @property (nonatomic, strong) NSString *testToShow; 
```

你 viewController2 的实现文件（Viewcontroller2.m）

```
@synthesize textToShow;
-(void)viewDidLoad
 {
     UILabel *label = UILabel aloc initWithFrame:CGRectMake(0, 0, 200, 200);
     [self.view addSubview:label];
     label.text = self.textToShow;
 } 
```

# ios - 使 UIToolBar 和 UISearchBar 具有哑光黑色背景

> ID：11621766
> 
> 赞同：1
> 
> 时间：2012-07-23T23:00:00.333
> 
> 标签：ios, ios5, uikit, uitoolbar

我可以在不覆盖该`drawRect`方法的情况下执行此操作吗？

我尝试了以下方法：

```
UIImage *navBarImage = [[UIImage imageNamed:@"image_navbg.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(5, 5, 5, 5)];
[self.descriptionBar setBackgroundColor:[UIColor colorWithPatternImage:navBarImage]];
[self.bottomBar setBackgroundColor:[UIColor colorWithPatternImage:navBarImage]]; 
```

其中 image_navbg.png 是一个纯哑光黑色方块。我得到的结果仍然是黑灰色渐变。

设置这些也无济于事：

```
[self.descriptionBar setTranslucent:YES];
[self.bottomBar setTranslucent:YES]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T04:07:16.457

我想用导航控制器*内置*的工具栏做同样的事情。您使用以下方法显示它：

```
[self.navigationController setToolbarHidden:NO]; 
```

为了消除*这种*工具栏上的渐变（至少在 iOS 4 和更早版本中），我成功地使用了以下技术。首先，我将此添加到我的 appDelegate 标头中：

```
@interface MyToolbar : UIToolbar {}

- (void)drawRect:(CGRect)rect;

@end 
```

然后我将此添加到我的 appDelegate .m 文件中

```
@implementation MyToolbar

- (void)drawRect:(CGRect)rect {
    UIColor *colorTabBlack = [UIColor colorWithRed:0 green:0 blue:0 alpha:1];
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetFillColor(context, CGColorGetComponents( [colorTabBlack CGColor]));
    CGContextFillRect(context, rect);
}
@end 
```

然后在 IB 中，我将（现在可见的）工具栏的类切换为“MyToolbar”——我花了很长时间才弄清楚这一点，这就是我发布它的原因。希望它可以帮助别人！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T09:01:46.347

如果您的目标是 iOS 5，请为此使用[UIAppearance](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html) - 不要再覆盖`-drawRect:`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T15:19:18.617

我就是这样做的。对我来说效果很好。您可能必须在子视图中尝试不同的索引。

```
// Change color of searchbar
[[self.searchbar.subviews objectAtIndex:0] removeFromSuperview];
self.searchbar.backgroundColor = [UIColor blackColor];

// Change color of toolbar
[[self.toolbar.subviews objectAtIndex:0] removeFromSuperview];
self.toolbar.backgroundColor = [UIColor blackColor]; 
```

# php - PHP - 用于临时控制的会话

> ID：11621767
> 
> 赞同：4
> 
> 时间：2012-07-23T23:00:05.573
> 
> 标签：php

我对使用会话来完成我的计划感到有些困惑。未登录的用户访问我的网站并上传文件。该用户在其会话期间可以控制文件的所有权（使用 session_id() 设置）。但是，为了识别用户拥有控制权，会话 ID 被插入到数据库中，以使用该用户 ID 进行验证。这是好习惯吗？会话 ID 有多独特？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:07:59.713

会话 ID 保证在当前使用的 ID 空间中是唯一的。基本上，所有当前会话都有一个唯一的 id。

这确实意味着您不能仅依赖会话 ID 来处理会话（当您这样说时似乎很明显）。我建议做一些事情，比如散列当前时间，并使用它为文件提供一个唯一的 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:06:44.253

我会创建一个不同的唯一 ID，将其存储在会话和数据库中。一些框架和库出于安全目的在每个请求上重新生成会话 ID，因此假设它们在用户会话期间永远不会改变是不好的。使用会话 ID 唯一可以确定的是它肯定是唯一的。

# git - 如何让 git 接受自签名证书？

> ID：11621768
> 
> 赞同：835
> 
> 时间：2012-07-23T23:00:06.777
> 
> 标签：git, version-control, https, self-signed

使用 Git，有没有办法告诉它接受自签名证书？

我正在使用 https 服务器来托管 git 服务器，但现在证书是自签名的。

当我第一次尝试在那里创建存储库时：

```
git push origin master -f 
```

我得到错误：

```
error: Cannot access URL     
https://the server/git.aspx/PocketReferences/, return code 22

fatal: git-http-push failed 
```

* * *

## 回答 #1

> 赞同：1505
> 
> 时间：2012-07-23T23:28:17.183

### 永久接受特定证书

尝试`http.sslCAPath`或`http.sslCAInfo`。[Adam Spiers 的回答](https://stackoverflow.com/a/26785963/877115)给出了一些很好的例子。这是该问题的最安全的解决方案。

### 禁用单个 git 命令的 TLS/SSL 验证

尝试使用正确的配置变量传递`-c`给`git`，或使用[Flow 的答案](https://stackoverflow.com/a/19363404/194894)：

```
git -c http.sslVerify=false clone https://example.com/path/to/git 
```

### 禁用特定存储库的 SSL 验证

可以全局停用 ssl 验证。**强烈建议不要这样做，**但为了完整性而提及：

```
git config --global http.sslVerify false # Do NOT do this! 
```

* * *

中有很多 SSL 配置选项`git`。从手册页`git config`：

```
http.sslVerify
    Whether to verify the SSL certificate when fetching or pushing over HTTPS.
    Can be overridden by the GIT_SSL_NO_VERIFY environment variable.

http.sslCAInfo
    File containing the certificates to verify the peer with when fetching or pushing
    over HTTPS. Can be overridden by the GIT_SSL_CAINFO environment variable.

http.sslCAPath
    Path containing files with the CA certificates to verify the peer with when
    fetching or pushing over HTTPS.
    Can be overridden by the GIT_SSL_CAPATH environment variable. 
```

其他一些有用的 SSL 配置选项：

```
http.sslCert
    File containing the SSL certificate when fetching or pushing over HTTPS.
    Can be overridden by the GIT_SSL_CERT environment variable.

http.sslKey
    File containing the SSL private key when fetching or pushing over HTTPS.
    Can be overridden by the GIT_SSL_KEY environment variable.

http.sslCertPasswordProtected
    Enable git's password prompt for the SSL certificate. Otherwise OpenSSL will
    prompt the user, possibly many times, if the certificate or private key is encrypted.
    Can be overridden by the GIT_SSL_CERT_PASSWORD_PROTECTED environment variable. 
```

* * *

## 回答 #2

> 赞同：181
> 
> 时间：2013-10-14T15:11:19.333

您可以设置`GIT_SSL_NO_VERIFY`为`true`：

```
GIT_SSL_NO_VERIFY=true git clone https://example.com/path/to/git 
```

或者将 Git 配置为不在命令行上验证连接：

```
git -c http.sslVerify=false clone https://example.com/path/to/git 
```

请注意，如果您不验证 SSL/TLS 证书，那么**您很容易受到中间人攻击**。

* * *

## 回答 #3

> 赞同：164
> 
> 时间：2014-11-06T17:44:31.733

*我不是现有答案的[编辑：原始版本] 的*忠实粉丝，因为禁用安全检查应该是最后的手段，而不是提供的第一个解决方案。即使您在没有其他验证方法的情况下无法在第一次收到时信任自签名证书，但将证书用于后续`git`操作至少会使仅在您下载证书*后才会发生的攻击变得更加困难。*换句话说，如果您下载的证书*是*正版的，那么从那时起您就很好了。*相反，如果您只是禁用验证，那么您在任何时候*都对任何类型的中间人攻击持开放态度。

举一个具体的例子：著名的[`repo.or.cz`](http://repo.or.cz/)存储库提供[了一个自签名证书](http://repo.or.cz/h/rootcert.html)。我可以下载该文件，将其放在类似的位置`/etc/ssl/certs`，然后执行以下操作：

```
# Initial clone
GIT_SSL_CAINFO=/etc/ssl/certs/rorcz_root_cert.pem \
    git clone https://repo.or.cz/org-mode.git

# Ensure all future interactions with origin remote also work
cd org-mode
git config http.sslCAInfo /etc/ssl/certs/rorcz_root_cert.pem 
```

请注意，`git config`在此处使用 local（即不使用`--global`）意味着此自签名证书仅受此特定存储库的信任，这很好。它也比使用更好，`GIT_SSL_CAPATH`因为它消除了`git`通过可能受到损害的不同证书颁发机构进行验证的风险。

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2016-12-21T01:22:15.180

# Git 自签名证书配置

## tl;博士

> **永远不要禁用所有 SSL 验证！**
> 
> 这会造成不良的安全文化。不要成为那个人。

您所追求的配置键是：

*   [`http.sslverify`](https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpsslVerify)- 永远正确。见上注。

这些用于配置您信任的主机证书

*   [`http.sslCAPath`](https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpsslCAPath)
*   [`http.sslCAInfo`](https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpsslCAInfo)

这些用于配置您的证书以响应 SSL 挑战。

*   [`http.sslCert`](https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpsslCert)
*   [`http.sslCertPasswordProtected`](https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpsslCertPasswordProtected)

有选择地将上述设置应用于特定主机。

*   [`http.<url>.*`](https://git-scm.com/docs/git-config#Documentation/git-config.txt-httplturlgt)

# 全球`.gitconfig`自签名证书颁发机构

为了我自己和我的同事的缘故，我们如何设法让自签名证书在不禁用`sslVerify`. [编辑您`.gitconfig`](https://git-scm.com/docs/git-config)的使用`git config --global -e`添加这些：

```
# Specify the scheme and host as a 'context' that only these settings apply
# Must use Git v1.8.5+ for these contexts to work
[credential "https://your.domain.com"]
  username = user.name

  # Uncomment the credential helper that applies to your platform
  # Windows
  # helper = manager

  # OSX
  # helper = osxkeychain

  # Linux (in-memory credential helper)
  # helper = cache

  # Linux (permanent storage credential helper)
  # https://askubuntu.com/a/776335/491772

# Specify the scheme and host as a 'context' that only these settings apply 
# Must use Git v1.8.5+ for these contexts to work
[http "https://your.domain.com"]
  ##################################
  # Self Signed Server Certificate #
  ##################################

  # MUST be PEM format
  # Some situations require both the CAPath AND CAInfo 
  sslCAInfo = /path/to/selfCA/self-signed-certificate.crt
  sslCAPath = /path/to/selfCA/
  sslVerify = true

  ###########################################
  # Private Key and Certificate information #
  ###########################################

  # Must be PEM format and include BEGIN CERTIFICATE / END CERTIFICATE, 
  # not just the BEGIN PRIVATE KEY / END PRIVATE KEY for Git to recognise it.
  sslCert = /path/to/privatekey/myprivatecert.pem

  # Even if your PEM file is password protected, set this to false.
  # Setting this to true always asks for a password even if you don't have one.
  # When you do have a password, even with this set to false it will prompt anyhow. 
  sslCertPasswordProtected = 0 
```

参考：

*   [Git 凭证](https://git-scm.com/docs/gitcredentials)
*   [Git 凭证存储](https://git-scm.com/book/en/v2/Git-Tools-Credential-Storage)
*   [使用 Gnome Keyring 作为凭证​​存储](https://askubuntu.com/a/776335/491772)
*   [Git 配置 http.<url>.* 从 Git v1.8.5 开始支持](https://git-scm.com/docs/git-config/2.12.2#git-config-httplturlgt)

# `git clone`-ing时指定配置

如果您需要在每个 repo 的基础上应用它，文档会告诉您只`git config --local`在 repo 目录中运行。好吧，当您还没有在本地克隆 repo 时，这没有用，是吗？

您可以`global -> local`通过如上所述设置全局配置来做 hokey-pokey，然后在克隆后将这些设置复制到本地 repo 配置中......

或者您可以做的是在克隆后[指定配置命令应用于目标存储库。`git clone`](https://git-scm.com/docs/git-clone#git-clone---configltkeygtltvaluegt)

```
# Declare variables to make clone command less verbose     
OUR_CA_PATH=/path/to/selfCA/
OUR_CA_FILE=$OUR_CA_PATH/self-signed-certificate.crt
MY_PEM_FILE=/path/to/privatekey/myprivatecert.pem
SELF_SIGN_CONFIG="-c http.sslCAPath=$OUR_CA_PATH -c http.sslCAInfo=$OUR_CA_FILE -c http.sslVerify=1 -c http.sslCert=$MY_PEM_FILE -c http.sslCertPasswordProtected=0"

# With this environment variable defined it makes subsequent clones easier if you need to pull down multiple repos.
git clone $SELF_SIGN_CONFIG https://mygit.server.com/projects/myproject.git myproject/ 
```

# 一个班轮

编辑：请参阅[VonC](https://stackoverflow.com/users/6309/vonc)的[回答](https://stackoverflow.com/a/45663558/622276)，该回答指出了从 2.14.x/2.15 到这一行的特定 git 版本的绝对和相对路径的警告

```
git clone -c http.sslCAPath="/path/to/selfCA" -c http.sslCAInfo="/path/to/selfCA/self-signed-certificate.crt" -c http.sslVerify=1 -c http.sslCert="/path/to/privatekey/myprivatecert.pem" -c http.sslCertPasswordProtected=0 https://mygit.server.com/projects/myproject.git myproject/ 
```

# 中央操作系统`unable to load client key`

如果你在 CentOS 上尝试这个并且你的`.pem`文件给了你

```
unable to load client key: "-8178 (SEC_ERROR_BAD_KEY)" 
```

然后，您将需要有关如何使用 NSS 而不是 Open SSL 的[StackOverflow 答案。](https://stackoverflow.com/a/22501939)`curl`

你会想[从源代码](https://curl.haxx.se/docs/install.html)[重建`curl`](https://curl.haxx.se/docs/install.html)：

```
git clone http://github.com/curl/curl.git curl/
cd curl/
# Need these for ./buildconf
yum install autoconf automake libtool m4 nroff perl -y
#Need these for ./configure
yum install openssl-devel openldap-devel libssh2-devel -y

./buildconf
su # Switch to super user to install into /usr/bin/curl
./configure --with-openssl --with-ldap --with-libssh2 --prefix=/usr/
make
make install 
```

*重新启动计算机，因为 libcurl 仍作为共享库在内存中*

# Python、pip 和 conda

**相关**：[如何将自定义 CA 根证书添加到 Windows 中 pip 使用的 CA 存储？](https://stackoverflow.com/questions/39356413/how-to-add-a-custom-ca-root-certificate-to-the-ca-store-used-by-python-in-window/52961564#52961564)

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2018-03-27T14:30:11.027

此答案摘自Michael Kauffman 撰写的[这篇文章。](https://writeabout.net/2017/02/03/git-for-windows-with-tfs-and-ssl-behind-a-proxy/)

**将 Git for Windows 与企业 SSL 证书一起使用**

**问题**：

如果您拥有企业 SSL 证书并想从控制台或 VSCode 克隆您的存储库，则会收到以下错误：

*致命：无法访问'<a href="https://myserver/tfs/DefaultCollection/_git/Proj/" rel="noreferrer">https://myserver/tfs/DefaultCollection/_git/Proj/'：SSL 证书问题：无法获取本地颁发者证书*

**解决方案**：

1.  将根自签名证书导出到文件。您可以在浏览器中执行此操作。

2.  在您的 git 文件夹中找到“ca-bundle.crt”文件（当前版本 C:\Program Files\Git\usr\ssl\certs，但过去已更改）。将文件复制到您的用户配置文件。使用 VSCode 之类的文本编辑器打开它，然后将导出的证书的内容添加到文件末尾。

现在我们必须配置 git 以使用新文件：

`git config --global http.sslCAInfo C:/Users/<yourname>/ca-bundle.crt`

这会将以下条目添加到用户配置文件根目录中的 .gitconfig 文件中。

`[http] sslCAInfo = C:/Users/<yourname>/ca-bundle.crt`

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2020-02-17T12:00:17.127

将 http.sslVerify 设置为 false 不是一个好习惯。相反，我们可以使用 SSL 证书。

因此，构建代理将使用带有 SSL 证书和 PAT 的 https 进行身份验证。 [![在此处输入图像描述](../Images/fcc764925a36138b7dd13d40dd0399a5.png)](https://i.stack.imgur.com/UwOFc.png)

[![在此处输入图像描述](../Images/af1ec258ea29edb504f27d0547fe2e3f.png)](https://i.stack.imgur.com/L9cpG.png)

[![在此处输入图像描述](../Images/21a7839de2dcaa54f4ae500676f376d9.png)](https://i.stack.imgur.com/CBmPV.png)

复制 cer 文件的内容，包括-begin-和-end--。

构建代理上的 git bash => git config –global http.sslcainfo “C:/Program Files/Git/mingw64/ssl/certs/ca-bundle.crt” 转到此文件并附加 .cer 内容。

因此，构建代理可以访问 SSL 证书

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2014-12-19T22:40:44.807

我一直遇到这个问题，所以编写了一个脚本来从服务器下载自签名证书并将其安装到 ~/.gitcerts，然后更新 git-config 以指向这些证书。它存储在全局配置中，因此每个远程只需要运行一次。

[https://github.com/iwonbigbro/tools/blob/master/bin/git-remote-install-cert.sh](https://github.com/iwonbigbro/tools/blob/master/bin/git-remote-install-cert.sh)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2019-11-26T11:19:35.897

禁用特定存储库的 SSL 验证如果存储库完全在您的控制之下，您可以尝试：

```
 git config --global http.sslVerify false 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-03-05T12:52:20.920

在 Windows 上使用 64 位版本的 Git，只需将自签名 CA 证书添加到这些文件中：

*   C:\Program Files\Git\mingw64\ssl\certs\ca-bundle.crt
*   C:\Program Files\Git\mingw64\ssl\certs\ca-bundle.trust.crt

如果它只是一个服务器自签名证书，请将其添加到

*   C:\Program Files\Git\mingw64\ssl\cert.pem

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-08-13T18:25:42.147

当您使用 sslKey 或 sslCert 使用一个班轮时要小心，如[Josh Peak](https://stackoverflow.com/users/622276/josh-peak)的[回答](https://stackoverflow.com/a/41253757/6309)：

```
git clone -c http.sslCAPath="/path/to/selfCA" \
  -c http.sslCAInfo="/path/to/selfCA/self-signed-certificate.crt" \
  -c http.sslVerify=1 \
  -c http.sslCert="/path/to/privatekey/myprivatecert.pem" \
  -c http.sslCertPasswordProtected=0 \
https://mygit.server.com/projects/myproject.git myproject 
```

只有 Git 2.14.x/2.15（2015 年第三季度）能够`~username/mykey`正确解释路径（虽然它仍然可以解释绝对路径`/path/to/privatekey`）。

请参阅[Junio C Hamano ( ) 的](https://github.com/gitster)[提交 8d15496](https://github.com/git/git/commit/8d1549643e814d2f8f0de2991d69c1331c8181d7)（2017 年 7 月 20 日[）](https://github.com/gitster)。 帮助者：[查尔斯·贝利 (](https://github.com/hashpling) [)](https://github.com/hashpling)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 17b1e1d](https://github.com/git/git/commit/17b1e1d76c581cfbd4a83a38136b5efef0dc7aa4))^(中，2017 年 8 月 11 日）)[`gitster`](https://github.com/gitster)
[`hashpling`](https://github.com/hashpling)
^([`gitster`](https://github.com/gitster))

> ## `http.c`:`http.sslcert`并且`http.sslkey`都是路径名
> 
> 回到创建现代 http_options() 代码路径以解析 29508e1 处的各种 http.* 选项[（](https://github.com/git/git/commit/29508e1efb8d5a18f78ca0f9be45fdde49ef6b76) “隔离共享 HTTP 请求功能”，2005-11-18，Git 0.99.9k）时，后来更正了多个之间的交互[7059cd9](https://github.com/git/git/commit/7059cd99fc671f9594b61cee7d10d69704f3ebe2) (" : Fix config file parsing", 2009-03-09, Git 1.6.3-rc0) 中的配置文件`http_init()`，我们将配置变量如`http.sslkey`,解析`http.sslcert`为普通字符串，因为`git_config_pathname()`它理解“ `~[username]/`”前缀不存在。
> 
> 后来，我们将其中的一些（即`http.sslCAPath`和`http.sslCAInfo`）转换为使用该函数，并从一开始就添加了类似于`http.cookeyFile` `http.pinnedpubkey`使用该函数的变量。正因为如此，这些变量都理解“ `~[username]/`”前缀。
> 
> 让剩下的两个变量`http.sslcert`和`http.sslkey`，也知道约定，因为它们都是文件的明确路径名。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-06-24T10:26:53.230

在 Windows 上，这对我有用：

将您的自签名证书的内容添加到**ca-bundle**文件的末尾。包括**-----BEGIN CERTIFICATE-----**和**-----END CERTIFICATE-----**行

**ca-bundle**文件的位置通常是**C:\Program Files\Git\mingw64\ssl\certs**

然后，将**ca-bundle**文件的路径添加到全局 git 配置中。以下命令可以解决问题：`git config --global http.sslCAInfo "C:/Program Files/Git/mingw64/ssl/certs/ca-bundle.crt"`

备注：路径取决于你本地的ca-bundle文件路径！

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-05-19T12:03:45.903

检查您的防病毒和防火墙设置。

从一天到另一天，git 不再工作了。综上所述，我发现卡巴斯基在中间放了一个自签名的杀毒个人根证书。按照上面的说明，我没有设法让 Git 接受该证书。我放弃了。对我有用的是禁用扫描加密连接的功能。

1.  打开卡巴斯基
2.  设置 > 附加 > 网络 > 不扫描加密连接

在此之后，git 在启用 sslVerify 的情况下再次工作。

笔记。这对我来说仍然不满意，因为我想激活我的反病毒功能。在高级设置中，卡巴斯基会显示无法使用该功能的网站列表。Github 没有被列为其中之一。我会在卡巴斯基论坛上查看。似乎有一些主题，例如 [https://forum.kaspersky.com/index.php?/topic/395220-kis-interfering-with-git/&tab=comments#comment-2801211](https://forum.kaspersky.com/index.php?/topic/395220-kis-interfering-with-git/&tab=comments#comment-2801211)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2021-10-20T03:11:02.083

关于[`http.sslCAPath`](https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpsslCAPath)选项的说明：如果[OpenSSL c_rehash 命令](https://www.openssl.org/docs/man1.0.2/man1/c_rehash.html)已在包含证书文件的目录上运行，`git`则只会检测给定目录路径中的证书文件。该命令将为每个证书创建符号链接，其中链接的名称是哈希值。例如：`c_rehash`

```
$ cd /path/to/ssl/cert/directory

$ ls -al

  total 16
  drwxr-xr-x  3 user  staff    96 Oct 20 13:47 .
  drwxr-xr-x  4 user  staff   128 Oct 20 13:46 ..
  -rw-r--r--  1 user  staff  4832 Oct 20 13:47 google.pem

$ /usr/local/opt/openssl@1.1/bin/c_rehash ./

  Doing ./

$ ls -al

  total 16
  drwxr-xr-x  4 user  staff   128 Oct 20 13:58 .
  drwxr-xr-x  4 user  staff   128 Oct 20 13:46 ..
  lrwxr-xr-x  1 user  staff    10 Oct 20 13:58 f6dbf7a7.0 -> google.pem
  -rw-r--r--  1 user  staff  4832 Oct 20 13:47 google.pem 
```

请注意，该`c_rehash`命令已创建以下符号链接：`f6dbf7a7.0 -> google.pem`.

您也可以将以下命令替换为`c_rehash`实用程序，但请注意，以下命令将仅处理`*.pem`文件，而`c_rehash`实用程序将处理`.pem, .crt, .cer, or .crl`文件：

```
for file in *.pem; do ln -s $file `openssl x509 -hash -noout -in $file`.0; done 
```

如果您现在配置`http.sslCAPath`到包含上述符号链接的目录，`git`将获取证书文件：

```
# contents of /etc/gitconfig
[http]
        sslCAPath = /path/to/ssl/cert/directory/ 
```

您还可以`http.sslCAPath`使用环境变量进行配置：

```
export GIT_SSL_CAPATH=/path/to/ssl/cert/directory/ 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-08-06T09:29:52.137

我使用 Windows 机器，[这篇文章](https://mattferderer.com/fix-git-self-signed-certificate-in-certificate-chain-on-windows)帮助了我。基本上我在记事本中打开了 ca-bundle.crt 并在其中添加了链证书（全部）。这个问题通常发生在公司网络中，我们在系统和 git repo 之间有中间人。我们需要以 base 64 格式导出证书链中除叶子证书之外的所有证书，并将它们全部添加到 ca-bundle.crt 中，然后为这个修改后的 crt 文件配置 git。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-11-09T15:53:45.603

在**.gitconfig**文件中，您可以添加以下给定值以使自签名证书可接受

sslCAInfo = /home/XXXX/abc.crt

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-03-19T03:44:42.860

我的回答可能会迟到，但它对我有用。它可能会帮助某人。

我尝试了上述步骤，但并没有解决问题。

试试这个`git config --global http.sslVerify false`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-10-27T19:15:31.880

我这样做：

```
git init
git config --global http.sslVerify false
git clone https://myurl/myrepo.git 
```

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2021-02-23T04:24:24.723

它对我有用，只需运行以下命令

```
git config --global http.sslVerify false 
```

它将打开一个 git 凭据窗口，提供您的凭据。第一次只问

# javascript - JavaScript URL 搜索正则表达式

> ID：11621769
> 
> 赞同：0
> 
> 时间：2012-07-23T23:00:06.890
> 
> 标签：javascript, regex, url

我在 JavaScript 中替换正则表达式字符串时遇到了一个奇怪的问题。我有这个正则表达式来搜索可能包含多个 URL（例如评论或帖子）的字符串中的 URL：

`/(?:https?:\/\/|www\.)\S+/gi`

但是我遇到了一个问题，它只会匹配一个 URL……除非它不匹配。这是不稳定的，但通常它只会匹配一个 URL（不一定总是第一个）。取这个字符串：

```
"Test

http://google.com
http://google.com

http://google.com" 
```

它只会匹配第一个`http://google.com`实例。

最终目标是用链接替换 ​​URL：

```
str = str.replace(/(?:https?:\/\/|www\.)\S+/gi, '<a href="$&" target="_blank">$&</a>'); 
```

我正在使用它来更好地了解匹配的内容和不匹配的内容：

```
function getMatches(re, str) {
    var matches = [],
        match;

    while ((match = re.exec(str)) !== null) {
        matches.push(match[0]);
    }

    return matches;
} 
```

有人知道我在这里做错了什么吗？

**编辑：看起来我的数据发生了一些有趣的事情导致了这个问题。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:44:53.953

如果您只想要一个匹配列表，您可以尝试使用[`String.match`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/match)而不是`RegExp.exec`.

它可以简化`getMatches`为：

```
function getMatches(re, str) {
    var matches = str.match(re);
    return matches == null ? [] : matches;
} 
```

或者可能让你放弃它：

```
var matches = str.match(/(?:https?:\/\/|www\.)\S+/gi) || []; 
```

您可能还想查看[RegexPal 之](http://regexpal.com/)类的工具来快速测试模式，[例如您](http://regexpal.com/?flags=gi&regex=%28%3F%3Ahttps%3F%3A%5C%2F%5C%2F%7Cwww%5C.%29%5CS%2B&input=Test%0A%0Ahttp%3A%2F%2Fgoogle.com%0Ahttp%3A%2F%2Fgoogle.com%0A%0Ahttp%3A%2F%2Fgoogle.com)的 .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:10:36.907

尝试这个，

```
str.replace(/(https?\:\/\/[^\s]+)/gi, '<a href="$1" target="_blank">$1</a>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T23:05:07.223

工作正常：http: [//jsfiddle.net/pPR2A/](http://jsfiddle.net/pPR2A/)

# php - 数据库、字符编码、PDF 和 XML

> ID：11621770
> 
> 赞同：7
> 
> 时间：2012-07-23T23:00:07.190
> 
> 标签：php, mysql, xml, character-encoding

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:16:03.297

检测一个文件的编码是一个难题，UTF很容易，因为它开头有一个BOM，否则几乎不可能正确确定编码类型。

但是，如果 XML 格式正确，它应该嵌入编码，并且解析器应该很好地处理它。我看到您正在进行从 UTF-8 到 UTF-32 的转换，这根本没有帮助，因为它只是使字符串更大一点，但是它不会更改用于对字符进行编码的代码点。

因此，您应该能够向您的 XML 解析器询问文件的编码，然后在存储和/或处理之前将其从该编码更改为 UTF-8（或 32）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:16:15.423

如果我是你，我会做两件事之一。我要么只是将没有任何编码的东西存储在数据库中（作为一个 blob），因此数据库编码根本不会进入它。

您可以做的另一件事是根本不将信息存储在数据库中。只需将它存储在一个文件中（将文件命名为一些唯一的哈希值），然后在数据库中创建一个表来存储具有 xml.xml 的文件的位置。然后，您可以直接从文件中提供 xml。

# facebook - Difference between Website w Facebook Login and Mobile Web options

> ID：11621774
> 
> 赞同：0
> 
> 时间：2012-07-23T23:00:19.937
> 
> 标签：facebook

Can somebody tell me the difference between the `Website with Facebook Login` URL and the `Mobile Web` URL?

We own a domain that handles all of our delivery of digital gift cards `domain1.com`. I would like to have an entry point hosted on a separate domain, `domain2.com`, that is configured for my facebook app, which handles the landing page & facebook connect code. A backend service we have manages the actual posting to the facebook users wall. The problem I'm having is the link that's generated on the facebook users wall points to `domain1.com`, but was generated by an app from `domain2.com`, which throws an error from Facebook.

Ultimately the problem comes down to setting an app domain that derives from the Site URL or Mobile URL. So I googled `facebook app multiple domains` which lead to [this SO post](https://stackoverflow.com/a/7722584/585152), which has a comment about setting your 2nd domain as the Mobile URL, which then allows me to add both `domain1.com` and `domain2.com` to the App Domain setting in my FB app.

What I really want to know is - what impact will setting both of these values have on my app? I've tried testing it on my mobile device - both inside the FB app and in safari via facebook mobile, and neither of them had a problem. Is this a suitable workaround for my problem?

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T12:15:42.823

> 我遇到的问题是在 facebook 用户墙上生成的链接指向 domain1.com，但它是由 domain2.com 的应用程序生成的，这会从 Facebook 引发错误。

什么错误？

是否可能只是由于设置了您的应用设置而导致的错误，因此通过此应用发布的帖子只允许包含指向该应用域的链接？然后只需禁用该设置...</p>

# mysql - 从第一条和最后一条记录匹配条件中选择列

> ID：11621775
> 
> 赞同：0
> 
> 时间：2012-07-23T23:00:22.027
> 
> 标签：mysql, sql

在处理资产调度的应用程序中考虑下表：

```
date       group_id  free_spots
2011-01-01   1         0
2011-01-01   2         0
2011-01-08   1         1
2011-01-08   2         0
2011-01-15   1         1
2011-01-15   2         1
2011-01-22   1         2
2011-01-22   2         2
2011-01-29   1         1
2011-01-29   2         0
2011-02-05   1         0
2011-02-05   2         1
2011-02-12   1         0
2011-02-12   2         1
2011-02-19   1         0
2011-02-19   2         0 
```

使用不同表的相当昂贵的查询（~100ms）将这些信息放在一起。结果可以放入临时表中，也可以直接内联使用。

我想要的是找到提供位置的第一个日期（free_spots > 0）。然后在同一个记录中，我想要提供一个位置的最后一个日期。所有这些都由 group_id 分组。

为了说明，在给定的示例表中，我希望得到以下输出：

```
group_id  start_date  end_date
1         2011-01-08  2011-01-29
2         2011-01-15  2011-01-22
2         2011-02-05  2011-02-12 
```

现在，我已经想出了一个粗略的解决方案。使用给定的表我会：

*   获取前面*为 NULL 或 free_spots <= 0 （开始日期）的记录的所有记录
*   对于所有这些记录，获取第一个后继*，该后继 * 由 NULL 或 free_spots <= 0 的行所接
*   以某种方式在这里混合了 group_id 分组。

但是，这似乎是不可能的，因为我不能再次使用相同的子查询来查找后继或先前的记录。同样处理临时表。这些我不能多次打开和重复使用。

（ * 之前或之后是基于日期。对于每个组，日期是相等的、连续的并且均匀（但任意）间隔。通常是 7 或 14 天）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T00:01:40.543

它可能不是超级高效，但它适用于您的数据。（请注意，如果需要，我为日期范围添加了 WHERE 约束）：

```
SELECT group_id,MIN(`date`) AS start_date,
       (SELECT `date` FROM Slots s3 
        WHERE s3.group_id=t.group_id 
        AND s3.`date`<t.next_stop_date
        AND s3.free_spots > 0
        ORDER BY s3.`date`DESC
        LIMIT 1) as end_date
FROM 
  (SELECT s1.*, MIN(s2.`date`) AS next_stop_date 
   FROM 
     Slots s1 LEFT JOIN Slots s2 
       ON s2.`date` > s1.date AND s1.group_id=s2.group_ID AND s2.free_spots = 0
   WHERE s1.free_spots > 0 
   GROUP BY s1.group_id, s1.`date`
   ORDER BY s1.group_id ASC, s1.`date` ASC
  ) AS t
GROUP BY group_id, next_stop_date 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T00:03:36.847

我可以在 SQL Server 中编写它，并且知道它可以转换为 MySQL。首先我会给你 SQL Server 版本，然后在下面的翻译上给你一个提升。我会跳过这个问题，但起初并没有意识到它是针对 MySQL 的。

这允许日期之间任何长度的可变间隙。

```
WITH IDs AS (
   SELECT *, Row_Number() OVER (PARTITION BY GroupID ORDER BY AvailableDate) ID
   FROM Availability
), Data AS (
   SELECT
      GroupID,
      AvailableDate,
      ID - Dense_Rank() OVER (PARTITION BY GroupID ORDER BY ID) G
   FROM IDs
   WHERE FreeSpots > 0
)
SELECT
   GroupID,
   Min(AvailableDate) FromDate,
   Max(AvailableDate) ToDate
FROM Data
GROUP BY GroupID, G; 
```

这是设置脚本：

```
CREATE TABLE Availability (
   AvailableDate datetime,
   GroupID tinyint,
   FreeSpots tinyint
)
INSERT Availability
SELECT '20110101', 1, 0
UNION ALL SELECT '20110101', 2, 0
UNION ALL SELECT '20110108', 1, 1
UNION ALL SELECT '20110108', 2, 0
UNION ALL SELECT '20110115', 1, 1
UNION ALL SELECT '20110115', 2, 1
UNION ALL SELECT '20110122', 1, 2
UNION ALL SELECT '20110122', 2, 2
UNION ALL SELECT '20110129', 1, 1
UNION ALL SELECT '20110129', 2, 0
UNION ALL SELECT '20110205', 1, 0
UNION ALL SELECT '20110205', 2, 1
UNION ALL SELECT '20110212', 1, 0
UNION ALL SELECT '20110212', 2, 1
UNION ALL SELECT '20110219', 1, 0
UNION ALL SELECT '20110219', 2, 0 
```

**MySQL 翻译**

下面应该等价于我的第一个 CTE（Common Table Expression），模拟 Row_Number() 函数。稍作调整，您可以将其用作派生表，用于执行第二个 CTE 以模拟 Dense_Rank()，并且您有一个有效的查询！

```
SELECT
   GroupID,
   AvailableDate,
   FreeSpots,
   @rownum=CASE WHEN @grpset <> GroupID THEN 0 ELSE @rownum + 1 END AS rownum,
   @grpset=GroupID AS grpset
FROM
   (SELECT @grpset= -1) g,
   (SELECT @rownum:= -1) r,
   (SELECT *
    FROM Availability
    ORDER BY GroupID, AvailableDate
   ) a 
```

我一点也不知道 MySQL，所以我从网上的一个例子中抄袭。这*应该*可行，但我可能会让语法错误溜进来。如果此查询有效并且您需要更多帮助，请告诉我，我将尝试将其添加到 MySQL 的完整查询中。虽然如果@Quassnoi 出现，你很快就会拥有它！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T00:24:04.933

查询不是很好，但似乎有效：

```
SELECT *
FROM (

SELECT a.group_id, a.`date` AS
start_date , max( b.`date` ) AS
end_date
FROM test AS a
LEFT JOIN test AS b ON a.group_id = b.group_id
AND b.free_spots >0
AND a.date < b.date
WHERE a.free_spots >0
AND (

SELECT count( * )
FROM test AS c
WHERE c.group_id = a.group_id
AND c.date > a.date
AND c.date < b.date
AND free_spots =0
) =0
GROUP BY group_id,
start_date
) AS d
WHERE end_date IS NOT NULL
GROUP BY d.end_date
ORDER BY `d`.`group_id` ASC 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-23T23:24:56.047

我想不出一个超级简单的方法来做到这一点。这是我能想到的一种方式的草图（使用多个查询）

`create temporary table temp1 select group_id,min(date) as start_date from table1 where free_spots>0 group by group_id`

`alter table temp1 add column end_date datetime default null`

`create temporary table`温度2`select * from table1 where free_spots>0`

然后在一个 while 循环中（使用某种编程语言），我会执行以下操作，直到 temp2 为空。您应该在循环中的每个步骤将日期增加到第二天（称为 $curDate）：

`update temp2,temp1 set temp1.end_date=temp2.date where temp1.group_id=temp2.group_id and temp2.date='$curDate' and temp2.free_spots>0`

您可以在每次查询后检查是否更新了 0 行。如果是这样，你就完成了，你可以打破 while 循环。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-23T23:46:40.673

这适用于 sql server（如果我正确理解了您的问题）。它也应该在 mysql 上工作：

select a.group_id, a.min_date, b.max_date from (select s1.group_id, min(s1.date) min_date from spot s1 group by s1.group_id) 内部连接
​​(select group_id, max(date) max_date from spot group by group_id) b on a.group_id = b.group_id

# iphone - 如何正确设计多方向 iPad 应用程序

> ID：11621777
> 
> 赞同：15
> 
> 时间：2012-07-23T23:00:30.333
> 
> 标签：iphone, objective-c, ipad, interface-builder, orientation

现在设计多方向iPad应用程序的正确方法是什么？我已经阅读了很多 Apple 文档、网络资源和一些 SO Q&A。这是我的初步要求：

*   这必须适用于 iOS 5 及更高版本。无需创建与 iOS 早期版本的向后兼容性。
*   如果可能的话，我希望在不同的 NIB 文件中定义纵向和横向 UI。
*   `header.png`对于不同方向的相同 UI 元素，我的 NIB 文件将具有不同的图像（例如，我将拥有`header-landscape.png`UIImageView。
*   应用程序将有几个屏幕，我需要能够在每个屏幕上切换方向。

那我该怎么办？

*   每个屏幕创建一个 VC 并替换`willRotate`处理程序中的底层视图？
*   每个方向创建一个 VC？但是，您如何正确切换它们呢？
*   简单地重新排列元素是行不通的（我认为），因为我必须重新加载图像。
*   用代码写所有东西（我真的很讨厌这个想法）？

到目前为止，解决这个问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-27T09:08:34.327

我实际上认为这是一个非常复杂的主题，就像大多数架构问题一样。我不认为您应该尝试仅使用一种技术来解决问题。

为了不排挤此页面上的所有其他答案，[我在我的博客上发布了一篇完整的文章](http://www.enscand.com/roller/enscand/entry/designing_ios_apps_for_interface)和[一些示例代码的链接，也是](https://github.com/n8r0n/hello-ios-orientation)

## 概括

最好在 .xib 文件中表达您的 UI，尽管您允许自己偏离这一点的程度部分取决于*将来修改*您的应用程序的人员的技能组合。可能不仅仅是*程序员*！

### 首选选项

强烈建议使用一个 .xib 文件和一个子类来实现一个**逻辑**`UIViewController`视图。努力做到这一点。设置`autoresizesSubviews=YES`您的 XIB 的 root `view`，并适当地调整子视图`autoresizingMask`以适应屏幕尺寸/方向的变化可以有很长的路要走。

**但是，这并不总是足够的。** 如果您的布局需要横向调整，超出自动调整大小可以处理的范围，我使用两个主要选项。您应该选择哪一个取决于您的视图内容。

### 选项一

如果纵向与横向的布局差别不大，那么我建议保留一个 .xib，并在视图控制器中添加一些代码来调整旋转布局。

### 选项二

如果横向与纵向的差异非常显着，那么我建议为每个方向使用一个 .xib（具有严格的命名约定，例如`MyViewController.xib`and `MyViewController-landscape.xib`）。但是，两个 .xib 文件都应该将**File's Owner**连接到**同一个 View Controller**类！对我来说，这是关键。

如果您打算做任何事情，而不是首选替代方案，我建议创建一个可重用的`UIViewController`基类来自动执行此操作并保持一致。这比你一开始想象的要多，而且在每个`UIViewController`需要轮换处理的子类中继续这样做是很愚蠢的。

* * *

## 解决方案

我创建了这样一个基类，并将[其放在此处的示例项目中。](https://github.com/n8r0n/hello-ios-orientation) 您可以看到一个 Hello World 示例，说明我认为应该如何处理所有三种情况：

*   一个视图控制器和一个 .xib，仅自动调整大小（我的`FirstViewController`）
*   一个视图控制器和两个 .xib，在它们之间自动切换（我的`SecondViewController`）
*   一个视图控制器和一个 .xib，具有较小的旋转编程布局 ( `ThirdViewController`)

我使用的[RotatingViewController](https://github.com/n8r0n/hello-ios-orientation/blob/master/HelloOrientation/RotatingViewController.h)基类同样适用于 iPhone 应用程序。实际上，我有一个更复杂的版本来处理维护 iPad**和**iPhone、纵向**和**横向布局（用于通用应用程序）。

但是，这个问题只是关于 iPad 的，所以我把它删掉了，以便更容易理解。

[我的基类](https://github.com/n8r0n/hello-ios-orientation/blob/master/HelloOrientation/RotatingViewController.h)还有一个实用`imageNamed:`方法，可以帮助加载适合当前方向的图像（以**image-landscape.png**约定命名）。但是，我认为绝大多数时候[应该使用可拉伸的 UIImages 。](http://idevrecipes.com/2010/12/08/stretchable-images-and-buttons/)

我没有这样做，但是当设备方向改变时，`RotatingViewController`它也可以尝试遍历它的`subviews`树并更新对象的属性`image`。我没有做到这一点，但你可以。`UIButton``UIImageView`

这些建议的更多**理由可**[在我参考的博客文章中找到](http://www.enscand.com/roller/enscand/entry/designing_ios_apps_for_interface)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-25T00:42:58.037

因此，由于缺乏对这个问题的答案并且时间是一个问题，我最终做了以下事情：

*   使用 Interface Builder 为所有纵向屏幕创建 NIB 文件。将所有需要布局的控件绑定到插座。
*   使用 IB 也可以为横向创建 NIB 文件，但仅将其用作参考，以查看 UI 元素的框架在横向中的位置。
*   `willAutoRotate`添加了代码以在处理程序中将所有元素重新排列为横向并返回纵向。

这种方法让我可以灵活地在 IB 中创建大部分 UI。我仍然需要保留代码以将元素重新排列到不同的方向，但通常这只涉及`setFrame`标签、按钮等和`imageNamed`图像的方法。与直接在代码中创建所有 UI 相比，范围要小得多。

只要允许，我就会在这个问题上展开悬赏，因为我认为这个问题对于任何为 iPad/iPhone 创建通用和多方向应用程序的开发人员来说都非常重要和有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T17:07:38.570

我使用了 3 种不同的技术，其中一种我认为是处理多个方向的“正确”方法。

1.  不正确：创建了两个不同的 nib/xib。不是“坏的”，但是当你在 UIViewController 中不断地重构 UIView 时，处理上下文和状态是很痛苦的。
2.  不正确：使用一个笔尖并根据绝对坐标在旋转时重新定位它们。这是错误的做法。我一遍又一遍地看到这一点，但这是您可以完成处理多种查看模式的最糟糕的方式。这种情况的一个症状是具有设备方向意识的 UIView。完全没有必要。
3.  **正确**：使用视图内的元素的*autoresizingMask*将它们浮动到设备旋转的正确位置，调整使用 CGRect 框架无法以这种方式完成的操作。我只需要这样做一次就可以对齐某些东西。恕我直言，这是处理多个设备方向的“正确”方式。UIView 和任何子视图不需要知道旋转。您可以在每个屏幕上使用一个带有许多子视图的 VC，并保持简单。如果您的布局可以以这种方式设计，带有浮动元素，那么您就是金子，UI 是轻而易举的事。

只是我的两分钱。

编辑：iOS 6 引入了 AutoLayout，可以用来代替“支柱和弹簧” - [https://developer.apple.com/library/ios/documentation/userexperience/conceptual/AutolayoutPG/Introduction/Introduction.html](https://developer.apple.com/library/ios/documentation/userexperience/conceptual/AutolayoutPG/Introduction/Introduction.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T21:48:32.633

令我失望的是，Apple 没有为给定的视图控制器提供使用多个 XIB 文件（每个方向一个）的方法——这将是处理方向问题的一种很好的方法，因为自动调整很少能很好地处理方向（它只适用于非常简单的界面）。

您可以这样做：为纵向创建一个 XIB，并为 XIB 中的每个子视图分配一个唯一的标签属性。然后复制 XIB，重新做横向布局（所以现在你有两个 XIB，一个纵向和一个横向）。

当您的应用程序启动时，您首先从适合启动方向的任何 XIB 创建视图控制器。递归遍历所有子视图，并创建一个包含所有子视图帧的字典，由每个子视图的 tag 属性键控。

接下来，从另一个方向的 XIB 创建一个临时视图控制器，并执行相同的递归迭代，将标签键控的所有帧存储到第二个字典（每个字典匹配一个方向，并应相应命名）。然后处理第二个临时视图控制器。

在`layoutSubviews`（实际上是在 中`viewDidLayoutSubviews`，因为您正在处理视图控制器并且您可以执行 iOS 5+），您所要做的就是递归地遍历所有子视图，并为每个子视图分配适合的框架字典中的框架当前方向，基于子视图的标签属性。

这种技术将允许您保留视图控制器的状态，而无需在每次方向更改时重新加载它。它还允许您使用 IB 布局视图控制器，因此您不必编写一堆手动布局代码。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-07-23T23:29:53.043

为什么要在一个可以做所有事情的应用程序之后运行？当你设计一个应用程序时，你决定什么是它的最佳方向 - 横向或纵向 - 即使你的应用程序的设计需要反向（所有都是横向的，1-2 个控制器是纵向的，反之亦然），你将相应地制作笔尖。好吧，在某些情况下，您将需要一个控制器来支持所有方向，并且您会做到的。

但是试图让所有控制器都支持所有方向......好吧，我觉得这个想法有点奇怪。

以防万一您仍然想这样做，您已经列出了可能的解决方案，我喜欢最后一个选项。

# android - progressDialog 不显示

> ID：11621782
> 
> 赞同：-1
> 
> 时间：2012-07-23T23:01:05.473
> 
> 标签：android, android-mapview, handler, progressdialog, itemizedoverlay

我有一个地图视图，它显示了一些带有 ItemizedOverlay 的 pois。当我点击 POI 时，会开始一些工作，这需要几秒钟。在 onTap 方法中，我调用处理程序来显示对话框并隐藏它。

我调试代码并检查`case Util.SHOW_DIALOG:`处理程序的开关是否被正确调用，但对话框没有显示给用户.....

我的代码有什么问题？

这是我的 MyMapActivity 类的一部分，你可以看到我的 mapview 有一个处理程序：

```
public Handler dialogHandler;
private ProgressDialog progressDialog;

public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);             
.
.
.
/* handler para mostrar y ocultar el reloj de carga */ 
        dialogHandler = new Handler(){
            @Override
            public void handleMessage(Message msg) {
                super.handleMessage(msg);               
                switch( msg.what ){
                    case Util.SHOW_DIALOG:
                        progressDialog = ProgressDialog.show(MyMapActivity.this, "" , "Cargando...", false );
                        break;
                    case Util.HIDE_DIALOG:
                        if( progressDialog != null )
                            progressDialog.dismiss();
                        progressDialog = null;
                        break;              
                }
            }
        }; 
```

这是 ItemizedOverlay 类的一部分，`ItemizedOverlay`使用以下代码调用处理程序的 onTap 方法：

```
protected boolean onTap(int index) {
            try{
                OverlayItem item = (OverlayItem)this.mOverlays.get(index);      
                    map.dialogHandler.sendEmptyMessage(Util.SHOW_DIALOG);
.
.
//doing some work
.
.
map.dialogHandler.sendEmptyMessage(Util.HIDE_DIALOG); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:09:51.087

嗯……

“//做一些工作”是否涉及在与 onTap 上使用的线程相同的线程上工作？如果是这样，那就是 ui 线程，所以你已经向 ui 线程发送了 2 条消息——一条显示，一条隐藏，在它甚至可以处理它们之前，当它最终达到可以处理它们的点时，它同时处理他们，所以在很短的时间内（可能没有注意到）progressDialog 将被显示。

无论如何，使用另一个线程进行后台工作，或使用 asyncTask 。

如果您使用 asyncTask ，您可以在工作开始之前显示对话框，并在完成/取消时隐藏它。

# android - 使用 Scala 编写的库在 Android 应用上运行 Proguard

> ID：11621783
> 
> 赞同：1
> 
> 时间：2012-07-23T23:01:05.790
> 
> 标签：android, scala, proguard

我有一个将用 Java 编写的 android 项目，但将使用一些用 Scala 编写的库。

我正在使用 AndroidProguardScala 插件来构建一个最小的 Scala 库，但它似乎没有发现我项目中的 JAR 还需要包含一些 Scala API 的事实，导致应用程序在这些方法失败时失败叫。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T00:02:43.740

您只需要将它们专门包含在您的 proguard.cfg 文件中。只需表明您要保留这些包。这里的所有都是它的。

# android - Deformed pixels in Andengine

> ID：11621784
> 
> 赞同：0
> 
> 时间：2012-07-23T23:01:11.407
> 
> 标签：android, andengine

I am trying to make a 16 bit style RPG in android using andengine, but I am encountering a major hurdle: the pixels always seem deformed and out of proportion(not squares). This is an issue for text and sprites. Here are the links to the forums that have my issues [http://www.andengine.org/forums/post37364.html#p37364](http://www.andengine.org/forums/post37364.html#p37364) , [http://www.andengine.org/forums/post35921.html#p35921](http://www.andengine.org/forums/post35921.html#p35921) . I am using Nearest as the texture option for both the text and the sprites. My sprites are accessed via texture packer and my text is created using code similar to below

```
final ITexture mFontInfoTexture = new BitmapTextureAtlas(pContext.getTextureManager(), 256, 256, TextureOptions.NEAREST);

mFontInfo = FontFactory.createFromAsset(pContext.getFontManager(), mFontInfoTexture, pContext.getAssets() , "LongPixelFont.ttf", 18.0f, false, Color.BLACK);
mFontInfo.load(); 
```

I've tried scaling the sprite differently, changing the texture option to Linear, shifting the sprite position but nothing really works. Any insight would be greatly appreciated.

UPDATE 1:

This is the code I use that defines the resolution of the app.

```
 // Initializes the Engine and sets the height and width.
    MainActivity.mMainCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);
    //Sets the engine options
    EngineOptions engineOptions = new EngineOptions(true, ScreenOrientation.LANDSCAPE_FIXED, new RatioResolutionPolicy(CAMERA_WIDTH, CAMERA_HEIGHT), MainActivity.mMainCamera);
    //Forces the screen to go into landscape
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE); 
```

UPDATE 2:

It seems that the deformation is caused by scaling(for the sprites). I did not notice any deformation when scaling by an int, but when scaling by a fraction there was some deformation. The deformation became more noticeable when scaling by an odd decimal (ie 2.5). It also seems that there is a range where the pixels will look deformed. In my case anything less than 2x will look deformed, but any int above 2 looks fine.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:02:35.530

您是否考虑过变形可能是由您的比率分辨率策略引起的？如果游戏的纵横比与设备的纵横比不同，某些分辨率策略会拉伸 GL 表面以填满整个屏幕。这肯定会导致非方形像素。

在构建引擎时尝试使用 RatioResolutionPolicy 并查看您的像素现在是否不是方形的。您现在可能会在 yoru 游戏的两侧出现黑条，但如果发生这种情况，您现在就知道问题出在哪里了。

然后，您可以想出一种方法来获取应用程序的全屏大小，并使您的比率分辨率策略完美契合。

== 更新 ==

根据上述评论，您的问题可能与以下内容相同： [https ://gamedev.stackexchange.com/questions/19075/how-can-i-make-opengl-textures-scale-without-becoming-blurry](https://gamedev.stackexchange.com/questions/19075/how-can-i-make-opengl-textures-scale-without-becoming-blurry)

听起来您正在尝试控制 openGL 使用的缩放模式。不幸的是，我不知道在 Andengine 中哪里可以找到这些设置。还有人知道吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:21:39.777

尝试将 pAntiAlias 选项从 false 更改为 true。

```
mFontInfo = FontFactory.createFromAsset(pContext.getFontManager(), mFontInfoTexture, pContext.getAssets() , "LongPixelFont.ttf", 18.0f, true, Color.BLACK); 
```

它应该有助于文本。

# javascript - Scripting SVGs embedded as objects

> ID：11621787
> 
> 赞同：1
> 
> 时间：2012-07-23T23:01:30.597
> 
> 标签：javascript, jquery, object, svg, embedding

I have been reading that using the object tag to embed an SVG in a web page provides the most options for manipulation, including scripting and animation. But I can only get the code below to work if I include all of the svg code inline, versus embedding with the obj tag. Hopefully it is something siomple I am missing. Thanks in advance.

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>SVG Demo</title>
<link href="styles.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/jquery-1.7.1.js"></script>
</head>
<body>
<h1>SVG Demo</h1>
<p>Animating an SVG with Javascript</p>

<button id="grow">Grow</button>
<button id="shrink">Shrink</button>

<object id="logo" type="image/svg+xml" data="images/logo.svg" alt="logo svg">No support    for SVG</object>

<script type="text/javascript">
$(document).ready(function() {
        $("#grow").click(function() {
            $("#logo").animate({ top: "50", right: "50", width: "700px", height: "102px" }, 1000, "swing");
        });
$("#shrink").click(function() {
            $("#logo").animate({ top: "50", right: "50", width: "233px", height: "34px" }, 1000, "swing");
        });
    });
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:15:44.407

您的问题与 jQuery 有关：

如果您使用`$('#logo').css(...)`它将按预期调整大小：http: [//jsfiddle.net/aDMMX/3/](http://jsfiddle.net/aDMMX/3/)。（`animate(...)`不起作用：http: [//jsfiddle.net/aDMMX/2/](http://jsfiddle.net/aDMMX/2/)）。

`<img>`在作品中也嵌入 SVG ：http: [//jsfiddle.net/aDMMX/6/，http :](http://jsfiddle.net/aDMMX/7/) [//jsfiddle.net/aDMMX/7/](http://jsfiddle.net/aDMMX/6/)也是如此`<div style="background:..."/>`

所以……你选择了一个不起作用的解决方案。;-)

您应该使用其他选项之一，省略动画，或提交 jQuery 错误。

# java - 在 Logback 中以编程方式引用预先存在的附加程序的正确方法是什么？

> ID：11621797
> 
> 赞同：2
> 
> 时间：2012-07-23T23:02:40.127
> 
> 标签：java, logging, logback

我正在寻找正确的方法来引用已经存在的附加程序以动态更改其属性之一。[对于 Loggers，这里](https://stackoverflow.com/questions/3837801/how-to-change-root-logging-level-programmatically)有 LoggerFactory.getLogger 的回答，但是我应该如何处理 appenders？

我是否必须通过记录器才能获取附加程序？我看到了 AppenderFactory，但它看起来不像我需要的。这种方法在[这里](https://stackoverflow.com/questions/3803184/setting-logback-appender-path-programmatically)展示过，但它似乎在拐弯抹角。logback 配置的层次结构具有同一级别的记录器和附加器。由于这不是问题的重点，所以没有说什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T12:16:59.833

我认为 Appenders 只存在于记录器的上下文中。除了 SocketAppender 之外，AFAIK 未使用的附加程序（未附加到任何记录器的附加程序）也有资格进行垃圾收集。所以我认为调用 logger.getAppender() 来检索一个 appender 是有意义的（我不认为它在拐弯抹角）。

# ruby-on-rails - 你如何正确地将 jenkins 与 rails 项目集成？

> ID：11621803
> 
> 赞同：0
> 
> 时间：2012-07-23T23:03:20.143
> 
> 标签：ruby-on-rails, jenkins

我知道还有其他关于此的帖子，但我的设置有两个问题：

1.  当 jasmine-ci 抛出异常时，我的构建仍在通过而不是失败。
2.  这是最雄辩的方式吗（ssh 行 + rake 任务）？我觉得应该有一种更漂亮/更好的方式来集成 ruby​​+jenkins？

![耙子问题](../Images/f4448d3b9ebf607b8a124b2eb975edfd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:54:06.267

您需要的是[ci_reporter](https://github.com/nicksieger/ci_reporter) gem。

[http://lostechies.com/ryansvihla/2011/09/25/rail-3-1-ci-setup-with-jenkins-test-unit-simplecov-on-os-x-lion/](http://lostechies.com/ryansvihla/2011/09/25/rail-3-1-ci-setup-with-jenkins-test-unit-simplecov-on-os-x-lion/)

这个 gem wrap spec rake 任务并生成 Jenkins 可以理解的 xml 输出，如果测试未通过则报告失败。

我认为 Jenkins 对 Ruby 和 RVM 以及您的项目环境了解不多。这就是为什么您需要编写自定义 shell 任务、指定 Ruby 版本、database.yml 配置等。

祝 Jenkins 好运，但我等不及私人 Travis CI 发布了）

# css - 图像后跟一个内联 div，里面有两个块 div

> ID：11621805
> 
> 赞同：-2
> 
> 时间：2012-07-23T23:04:17.693
> 
> 标签：css

我已经阅读了很多关于这个问题的链接，但我不明白为什么下面的小提琴是这样的。我可能错过了一些观点，所以我提前道歉。这真的不是我的一天。

[在这里](http://jsfiddle.net/Chamster/v7eUN/2/)你有这个我声称不应该存在的换行符，因为两个外部 div 的样式都是“显示：内联”。为什么在内部 div（设置为样式“显示：块”）中会影响换行符？！

在我看来，外部 div 应该在一行上，而换行符应该出现**在**第二个 div 内。此外，第一个 div 不是必需的，因为 img 默认是内联的。

有什么解释吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:07:35.243

放入`<div style="display: inline">`第一个 div，它将起作用 - [http://jsfiddle.net/v7eUN/3/](http://jsfiddle.net/v7eUN/3/)

这是`<div style="inline">`- 只是辛苦一天后的一个错字，我猜？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:10:14.293

你打错了`style`for main `div`，你需要用`style="display: inline"`not `style="inline"`。

见这里：http: [//jsfiddle.net/v7eUN/4/](http://jsfiddle.net/v7eUN/4/)

# objective-c - 在 iOS 中将滑块与文本字段同步

> ID：11621810
> 
> 赞同：0
> 
> 时间：2012-07-23T23:04:53.910
> 
> 标签：objective-c, ios, uiviewcontroller, uislider, textfield

我对 iOS/objective-c 完全陌生，我被分配了一个项目来删除 iOS 应用程序中的一些错误并添加一些功能。

我目前正在尝试做的是同步一个滑块，该滑块代表一个新添加的文本字段的百分比，该文本字段可以与滑块一起进行微调。关键是两者本质上是同时同步的。例如，如果用户将滑块更改为 75.2%，则相同的值必须显示在文本字段中 - 反之亦然。

我为此做了很多谷歌搜索，但不幸的是找不到太多。管理一切的类*以某种方式*`.xib`与文件同步。很高兴知道如何将这两者同步在一起，并在 iOS Interface Builder 中设置属性/事件，从而以某种方式影响类。

那么，iPhone 开发的这两个方面是如何运作的呢？

我很感激你的时间。

# java - Java - 帮助将字符串转换为类对象

> ID：11621813
> 
> 赞同：1
> 
> 时间：2012-07-23T23:05:13.847
> 
> 标签：java, string, object

这是我想要得到的最终结果：

```
ItemStack block = new ItemStack(Block.dirt, 1); 
```

这就是我所拥有的

```
 String s = "Block.dirt";    
    ItemStack block = new ItemStack(    , 1); 
```

看起来有点不可能，但是有没有办法将字符串“Block.dirt”变成 Block.dirt？

我尝试了很多东西，有些人建议我使用 GroovyShell 和 Binding，但我做不到。

有没有办法从字符串中命名一个对象？

非常感谢任何帮助。谢谢你。

我可以举个例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:06:57.897

为什么你不能这样做？还是使用 MVEL 等评估引擎？

在任何情况下，您都可以拆分字符串，根据类名进行实例化，并使用反射调用方法。或者，在这种情况下，根据您提供的代码段调用静态方法。

在不知道您实际尝试过的方法无效的情况下，不知道还有什么方法可以提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:07:22.530

当然——人们总是这样做。例如，当他们打开一个 JDBC 连接对象时。

你想要“class.forName()”：

> [http://www.theserverside.com/news/1365412/Understanding-ClassforName-Java](http://www.theserverside.com/news/1365412/Understanding-ClassforName-Java)
> 
> 在 Java 中，动态加载通常是通过调用 java.lang.Class 类的 forName 方法来实现的

这是一篇关于“反思”的文章：

[http://java.sun.com/developer/technicalArticles/ALT/Reflection/](http://java.sun.com/developer/technicalArticles/ALT/Reflection/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T23:07:30.933

是的，您会想要使用[反射 API](http://docs.oracle.com/javase/tutorial/reflect/index.html)。

# c++ - 将 std::vector 作为输入/输出参考参数传递时丢失了一些数据

> ID：11621818
> 
> 赞同：2
> 
> 时间：2012-07-23T23:06:28.880
> 
> 标签：c++, parameter-passing, stdvector

我无法在我的函数之间传输向量中包含的一些数据。情况如下：

```
void generateObjects(std::vector<MyClass> &objects)
{
    objects.clear();
    //Fill objects vector
    std::vector<MyClass> p;

    //This 4-line pattern is repeated a number of times to generate all objects and store them in variable 'objects'
    p.clear();
    generateSomeOfTheObjects(p); //p is again passed by ref. in/out parameter
    for(uint j = 0; j < p.size(); p++){
        objects.push_back(p[j]);
    }

    //Print some members of the objects - works fine
    for(uint i = 0; i < objects.size(); i++){
        printf("%f ",objects[i].mymember->myElm);
    }
}

int main()
{
   std::vector<MyClass> objects;
   generateObjects(objects);
   //Print size of vector - size is correct it is the same as it is in generateObjects func
   printf("%lu\n",objects.size());
   //Again print members of the objects - some members are retained after the function call, some are lost. 
   //The one below doesn't work, mymember is a pointer to another object and its member myElm seems not initialized.
   for(uint i = 0; i < objects.size(); i++){
       printf("%f ",objects[i].mymember->myElm);
   }
   //Here I need to pass the objects to another read-only function
   ...
} 
```

我在互联网上搜索了类似的案例，实际上发现了很多，但我无法对我的代码应用相同的修复。我正在尝试访问由 MyClass 实例的成员（objects[i].mymember->myElm）指向的对象的成员，我在这里可能缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:26:59.950

错误可能在于`MyClass`. 我想说这个类包含一些用局部变量的地址初始化的指针，所以当你从一些函数返回时，指针指向一个被破坏的对象。

那将是*未定义的行为*，但它*可能会*偶然起作用。当您从第一个函数返回时，堆栈内存最终被覆盖并且您的数据丢失。

**更新：**感谢@chris 在下面的评论中的洞察力，最可能的原因是您`MyClass`没有复制构造函数，但它确实有一个指针成员。

像这样的东西：

```
class MyClass
{
public:
    Member *mymember;

    MyClass()
    {
        mymember = new Member;
    }
    ~MyClass()
    {
        delete mymember;
    }
}; 
```

现在，如果您使用编译器生成的默认复制构造函数（或复制运算符）会发生什么？

```
void foo()
{
    MyClass a;
    {
        MyClass b(a);
    }
    //a.mymember is no longer valid
} 
```

两者`a`和`b`共享同一个指针`mymember`，因此当其中一个被销毁时，将`mymember`被删除，另一个持有一个悬空指针。

这就是为什么我们有**三规则**。它指出：

> 每当您定义一个非默认析构函数时，您很可能还需要一个非默认复制构造函数和一个非默认复制操作符。

现在您必须决定是要共享所有权`mymember`还是要复制它。第一个最好使用智能指针 ( `shared_ptr`)，第二个最好使用深拷贝。

例如，深拷贝：

```
class MyClass
{
public:
    Member *mymember;

    MyClass()
    {
        mymember = new Member;
    }
    MyClass(const MyClass &c)
    {
        mymember = new Member(c.mymember);
    }
    MyClass &operator=(const MyClass &c)
    {
        if (this != &c) //be aware of self-copy
        {
            delete mymember;
            mymember = new Member(c.mymember);
        }
        return *this;
    }
    ~MyClass()
    {
        delete mymember;
    }
}; 
```

并使用共享指针：

```
class MyClass
{
public:
    std::shared_ptr<Member> mymember; //or boost::shared_ptr if old compiler

    MyClass()
        :mymember(new Member)
    {
    }
    //no custom-made destructor -> no rule of 3
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T23:32:11.333

也许与您的问题无关，但是：

```
void generateObjects(std::vector<MyClass> &objects)
{
  objects.clear();
  std::vector<MyClass> p;
  p.clear();

  generateSomeOfTheObjects(p);
  for(uint j = 0; j < p.size(); p++){
      objects.push_back(p[j]);
  }

  for(uint i = 0; i < objects.size(); i++){
      printf("%f ",objects[i].mymember->myElm);
  }
} 
```

与此相同：

```
void generateObjects(std::vector<MyClass> &objects)
{
  objects.clear();
  generateSomeOfTheObjects(objects);
  std::reverse(objects.begin(), objects.end()); 
  for(uint i = 0; i < objects.size(); i++) {
      printf("%f ",objects[i].mymember->myElm);
  }
} 
```

正如@rodrigo 提到的，您复制的问题是您没有使用复制构造函数进行深度复制。

# python - 如何将 2 个函数绑定到单个事件

> ID：11621833
> 
> 赞同：2
> 
> 时间：2012-07-23T23:08:07.630
> 
> 标签：python, wxpython

我有这个绑定“self.Bind（wx.EVT_LISTBOX，self.selLoadFile，listbox）”。我将如何添加另一个功能，我想这就是你所说的。像 self.selLoadFile 一样，我如何向同一个事件添加另一个函数？我正在制作一个音乐播放器，并希望文件在被选中后自动播放。self.selLoadFile 函数加载文件，如何将“self.Play”函数添加到同一个 evt？

提前致谢！！

对不起，我是编程新手。你能帮帮我吗？因此，如果我的功能在哪里：

```
def selLoadFile(self, event):
        my_selection = self.myListBox.GetStringSelection()
        file_path = os.path.join(os.getcwd(),"songs",my_selection)
        self.doLoadFile2(file_path)

def doLoadFile2(self, file_path):
    if not self.mc.Load(file_path):
        wx.MessageBox("Unable to load %s: Unsupported format?" % file_path, "ERROR", wx.ICON_ERROR | wx.OK)

    else:
        folder, filename = os.path.split(file_path)
        self.st_file.SetLabel('%s' % filename)
        self.mc.SetBestFittingSize()
        self.mc.Play()

def Play(self, event):
    self.mc.Play()
    self.playbackSlider.SetRange(0,self.mc.Length()) 
```

我如何将上述所有 3 个函数包含在一个函数中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T16:18:26.047

如果您想将一个小部件绑定到两个事件处理程序，那么只需执行此操作。只要您在处理程序代码的末尾调用[event.Skip() ，这将起作用。](http://wxpython.org/docs/api/wx.Event-class.html#Skip)如果没有这一行，事件将被第一个处理程序使用，并且不会被任何其他处理程序捕获。这是一个愚蠢的例子：

```
import wx

########################################################################
class MyPanel(wx.Panel):

    def __init__(self, parent):
        """Constructor"""
        wx.Panel.__init__(self, parent)
        btn = wx.Button(self, label="Press Me")
        btn.Bind(wx.EVT_BUTTON, self.HandlerOne)
        btn.Bind(wx.EVT_BUTTON, self.HandlerTwo)

    def HandlerOne(self, event):
        print "handler one fired!"
        event.Skip()

    def HandlerTwo(self, event):
        print "handler two fired!"
        event.Skip()

########################################################################
class MyFrame(wx.Frame):

    def __init__(self):
        """Constructor"""
        wx.Frame.__init__(self, None, title="Test")
        panel = MyPanel(self)
        self.Show()

if __name__ == "__main__":
    app = wx.App(False)
    frame = MyFrame()
    app.MainLoop() 
```

# uiviewcontroller - 有没有办法覆盖 popToRootViewControllerAnimated: 通过点击选项卡栏项调用？

> ID：11621835
> 
> 赞同：0
> 
> 时间：2012-07-23T23:08:17.820
> 
> 标签：uiviewcontroller, uinavigationcontroller, uitabbarcontroller, uitabbaritem

当用户点击已选择的同一标签栏项目时，我想覆盖 popToRootViewControllerAnimated: (当前：YES) 的动画。

当第一次点击标签栏项目时，我在标签栏项目根视图控制器的 viewWillAppear: 方法中检查用户是否已登录，如果没有，立即推送禁用动画的登录控制器。

```
controller.navigationItem.hidesBackButton = YES;
[self.navigationController pushViewController:controller animated:NO];
[controller release]; 
```

当用户登录成功后，我弹回根控制器，【动画是】没问题：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

但是，再次点击当前标签栏项目时的默认行为似乎会进行以下调用：

```
-[UITabBarController _tabBarItemClicked:] 
```

调用

```
-[UINavigationController popToRootViewControllerAnimated:] 
```

我不知道 YES 是否传递到最后一个，但根据观察假设是这样。如果用户没有登录但再次点击标签栏项目，看起来相同的 [登录] 控制器正在被推送/弹出动画，因为根控制器的 viewDidLoad 只是再次推送登录控制器. 在这种情况下，我希望动画为“否”。

为了增加我的问题，还有其他导航堆栈可以推送登录控制器，并且适合点击其标签栏项目以弹出到根控制器。我已经在登录控制器中实现了 UITabBarControllerDelegate 协议和 tabBarController:shouldSelectViewController: 以检查点击的栏项目根控制器是否相同，以及该控制器是否是我想要特殊情况的控制器的类，但它似乎不优雅。不仅如此，现在登录控制器还必须知道可以将其推送到导航堆栈的控制器的类。虽然我可以继续使用协议方法，但必须有更好的方法来做到这一点。

感谢您的意见和想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T02:44:43.697

我认为这个问题的最佳解决方案是在选择标签栏按钮时呈现模式视图控制器，然后返回 NO。从委托方法。

# c - 将数组复制到结构中

> ID：11621836
> 
> 赞同：2
> 
> 时间：2012-07-23T23:08:18.943
> 
> 标签：c, arrays, memory, structure, copying

我有一个 9 个字节的数组，我想将这些字节复制到一个结构中：

```
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

typedef struct _structure {
    char one[5];        /* 5 bytes */
    unsigned int two;   /* 4 bytes */
} structure;

int main(int argc, char **argv) {

    structure my_structure;

    char array[]    = {
        0x41, 0x42, 0x43, 0x44, 0x00,   /* ABCD\0 */
        0x00, 0xbc, 0x61, 0x4e          /* 12345678 (base 10) */
    };

    memcpy(&my_structure, array, sizeof(my_structure));

    printf("%s\n", my_structure.one);   /* OK, "ABCD" */
    printf("%d\n", my_structure.two);   /* it prints 1128415566 */

    return(0);
} 
```

结构的第一个元素`my_structure`,`one`被正确复制；但是，`my_structure.two`包含 1128415566 而我期望 12345678.`array`并且`my_structure`具有不同的大小，即使它们的大小相同，仍然会有问题`two`。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T01:59:23.593

有几个问题：

出于效率原因，编译器在边界上**对齐**变量，该边界等于处理器的寄存器大小。即在 32 位系统上，这将在 32 位（4 字节）边界上。此外，结构将具有“间隙”，以便结构成员可以在 32 位边界上对齐。换句话说：结构没有“**打包**”紧密。试试这个：

```
#include <stdio.h>

typedef struct
{
    char one[5];        /* 5 bytes */
    unsigned int two;   /* 4 bytes */
}
    structure;
structure my_structure;

char array[] = 
{
    0x41, 0x42, 0x43, 0x44, 0x00,   /* ABCD\0 */
    0x00, 0xbc, 0x61, 0x4e          /* 12345678 (base 10) */
};

int main(int argc, char **argv) 
{
    const int sizeStruct = sizeof(structure);
    printf("sizeof(structure) = %d bytes\n", sizeStruct);
    const int sizeArray = sizeof(array);
    printf("sizeof(array) = %d bytes\n", sizeArray);
    return 0;
} 
```

你应该看到不同的尺寸。

您可以使用#pragma 或属性指令覆盖此行为。使用 gcc，您可以使用属性更改结构定义。例如，更改上面的代码以添加“打包”属性（需要 gcc）：

```
typedef struct __attribute__((packed)) 
```

然后再次运行程序。现在大小应该是一样的。 **注意：**在某些处理器架构上，例如 ARMv4，32 位变量**必须**在 32 位边界上对齐，否则您的程序将无法运行（出现异常）。阅读“对齐”和“打包”编译指示或属性的编译器文档。

下一个问题是字节顺序。试试这个：

```
printf("0x%08X\n", 12345678); 
```

十六进制的 12345678 是 0x00BC614E。从您的示例和您获得的输出中，我可以看出您的平台是“小端”。在“小端”系统中，数字`0x00BC614E`存储为从最低有效字节开始的字节序列，例如`0x4E, 0x61, 0xBC, 0x00`. 所以改变你的数组定义：

```
char array[] = 
{
    0x41, 0x42, 0x43, 0x44, 0x00,   /* ABCD\0 */
    0x4E, 0x61, 0xBC, 0x00,         /* 12345678 (base 10) */
}; 
```

现在您的程序将打印 12345678。

另请注意，您应该使用 %u 打印无符号整数。

复制 char 字符串可能会引起许多蠕虫，尤其是当您必须允许使用不同的编码（例如 Unicode）时。至少，您需要确保您的复制目标缓冲区不会溢出。

修改后的代码：

```
#include <stdio.h>
#include <string.h>

typedef struct
{
    char one[5];        /* 5 bytes */
    unsigned int two;   /* 4 bytes */
}
    structure;

structure my_structure;

char array[] = 
{
    0x41, 0x42, 0x43, 0x44, 0x00,   /* ABCD\0 */
    0x4E, 0x61, 0xBC, 0x00,         /* 12345678 (base 10) */
};

int main() 
{
    // copy string as a byte array
    memcpy(&my_structure.one, &array[0], sizeof(my_structure.one));

    // copy uint
    my_structure.two = *((unsigned int *)(&array[5]));

    printf("%s\n", my_structure.one);
    printf("%u\n", my_structure.two);

    return 0;
} 
```

最后，依赖打包数据结构通常是个坏主意，因为这会使将代码移植到不同的平台变得困难。但是，有时您需要打包/解包协议数据包。在那些特殊情况下，使用每种数据类型的一对函数手动打包/解包每个项目通常是最好和最便携的。

我将把字节序问题留给另一个话题。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:21:31.333

正如 Mysticial 已经解释的那样，您所看到的是[结构对齐](http://en.wikipedia.org/wiki/Data_structure_alignment)的效果- 编译器将在其字大小的边界上对齐元素，即 4 字节边界上的 32 位代码，有效地在 char 之间留下 3 个字节的间隙[5] 和下一个元素。

如果您使用 gcc 或 Visual Studio，[`#pragma pack(1)`](http://gcc.gnu.org/onlinedocs/gcc/Structure_002dPacking-Pragmas.html)则允许您覆盖编译器默认使用的“首选”打包 - 在此示例中，您指示编译器在 1 字节边界上进行指示，即没有“孔”。这在嵌入式系统中通常很有用，可以将字节块映射到结构上。对于其他编译器，请参阅您的编译器手册。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T23:53:48.330

正如您的其他答案已经表明的那样，您看到了对齐问题。编译器倾向于根据您拥有的处理器类型沿长或四字边界对齐数据结构。这意味着如果您在结构中声明的内容不对齐，那么编译器会将对齐字节打包，并且您不应该看到它们。

顺便说一句，从前，整个世界都不是英特尔，而是英特尔。还有其他处理器，每个处理器都有自己独特的对齐要求，所以对齐是我们都处理的相当多的事情，尤其是在不同处理器系列之间移植引导 ROM 代码。

当遇到这样的问题时，我建议修改你的代码来做一个小实验，如下所示：

`structure * pStructure;`1）在您的代码中添加声明。

2）添加pStructure =（结构*）数组；` 在数组声明之后。

3）然后，在memcpy所在的那一行，设置一个断点。

当你命中断点时，输入打印或显示命令（gdb 使用 p）

```
p pStructure->one
(gdb) p pStructure->one
$4 = "ABCD" 
```

然后是以下

```
(gdb) p pStructure->two
$7 = 3486515278 
```

至于 4 字节数字，我相信您没有看到您期望的数字，因为您表示的是一个 ASCII 数字，一个字节数组，而不是 .two 的无符号整数类型。

除了值的数量，如果你使用结构指针访问数组中的数据，我相信会正确访问数据，因为在字节数组中间没有什么可以填充的。因此，您的数据是连续的，并且您的字段排列整齐。不存在对齐问题。

memcpy 只是复制字节，不会解释结构的字段或编译器可能为对齐结构所做的工作。

做这样的事情是我欣赏指针的唯一方法，尤其是在汇编语言中工作。

# javascript - Javascript 和 Css：高度不变

> ID：11621843
> 
> 赞同：1
> 
> 时间：2012-07-23T23:09:32.507
> 
> 标签：javascript, jquery, css

我正在使用 javascript 自定义滚动器，并且我也在交换该滚动器的内容，唯一的问题是当我切换不同的内容时，高度与原始 div 保持相同并且不会调整，我不知道为什么.

这是我的Javascript：

```
$(window).load(function(){
(function($) {
    $.fn.Fader = function() {
        this.each(function() {
            $('.clickme').bind('click', function(e) {
                e.preventDefault();
                $( "#mediaswap div" ).fadeOut();
                $( "#mediaswap div" + $(this).attr('name') ).fadeIn();
            })
        });
    }
})(jQuery);

$(function() {
    $('#mediaswap').Fader();
});
});//]]> 
```

安迪我的 CSS：

```
#media_scroll{position:absolute; margin:0; width:590px; height:334px;}
#media_scroll .customScrollBox{position:relative; height:100%; overflow:hidden;}
#media_scroll .customScrollBox .container{position:relative; width:565px; top:0; float:left;}
#media_scroll .customScrollBox .content{clear:both;}
#media_scroll .dragger_container{position:relative; background: url(images/assets/track-bkg.jpg) no-repeat; width:10px; height:324px; float:left; margin:10px 0 0 10px; cursor:pointer;}
#media_scroll .dragger{position:absolute; width:14px; height:22px; background: url(images/assets/dragger.gif) no-repeat; margin-left:-3px; text-align:center; overflow:hidden; cursor:pointer;}
#media_scroll .dragger_pressed{position:absolute; width:14px; height:22px; margin-left:-3px; overflow:hidden;} 
```

div“内容”是其中具有不同高度的不同div的div。

非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:40:33.673

尽管缺少代码，但还是会尝试一下：

`.content`只能将大小设置为 334px，因为您将其设置`height`为`#media_scroll`. 尝试使用或者`min-height: 334px;`看看`height: auto;`是否没有帮助。您也可以使用 jquery 来调整大小`#media_scroll`。

此外，发布代码，将其添加到[jsfiddle.net](http://jsfiddle.net)确实有助于我们解决您的问题。

另外，Tyrsuis 的观点是：

`$( "#mediaswap div" + $(this).attr('name') ).fadeIn();`

可能应该更像：

`$( "#mediaswap div " + $(this).attr('name') ).fadeIn();`

但请记住，如果`$(this).attr('name')`不会添加“。” 或 '#' 到选择器。所以你最终可能会尝试调用类似的东西：

> $("#mediaswap div 元素名")

代替：

```
$("#mediaswap div #elementName") 
```

# matlab - 循环遍历matlab文件夹中的文件

> ID：11621846
> 
> 赞同：63
> 
> 时间：2012-07-23T23:10:01.830
> 
> 标签：matlab, loops, file-io, csv

我有几天的日志文件需要在 matlab 中解析和查看。

日志文件如下所示：

```
LOG_20120509_120002_002.csv
(year)(month)(day)_(hour)(minute)(second)_(log part number) 
```

日志每小时增加一次，但有时秒数会减少一到两秒（每小时），这意味着我需要忽略他们所说的要做的事情`loadcsv`。

我还有另一个文件：

```
LOG_DATA_20120509_120002.csv 
```

其中包含整个小时的数据（不同的数据）。

总体目标是：

```
 loop through each day 
     loop through each hour
         read in LOG_DATA for whole hour
         loop through each segment
             read in LOG for each segment
                 compile a table of all the data 
```

我想问题是，如果它们不同，我如何忽略一天中的分钟？我怀疑这将是通过遍历文件夹中的所有文件，在这种情况下我该怎么做？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2012-07-23T23:15:56.230

遍历文件夹中的所有文件相对容易：

```
files = dir('*.csv');
for file = files'
    csv = load(file.name);
    % Do some stuff
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-25T05:22:15.823

首先，您必须指定您的路径，即您的`*.csv`文件所在的路径

```
path = 'f:\project\dataset' 
```

您可以根据您的系统进行更改。

然后，

使用`dir`功能：

```
files = dir (strcat(path,'\*.csv'))

L = length (files);

for i=1:L
   image{i}=csvread(strcat(path,'\',file(i).name));   
   % process the image in here
end 
```

`pwd`也可以使用。

# recursion - 计划，停止我的递归

> ID：11621852
> 
> 赞同：0
> 
> 时间：2012-07-23T23:10:30.447
> 
> 标签：recursion, scheme

该函数`firstnprimes`应该返回第一个`n`素数。参数是`n`素数的数量，`nlist`一个 2-m 整数的列表。和`slist`是解决方案列表，最初为空，每次调用 firstnprimes 时都会添加和重构。

它的工作原理是从列表中删除第一个数字，然后从`nlist`with中删除该数字的所有倍数`listminusnonprimes`；我知道这是有效的。问题是我无法控制这个动作，如果`slist`' 的长度等于你想要的素数数量，我会计算每次通过的次数，那么你就完成了。

代码：

```
(define firstnprimes
  (lambda (n nlist slist)
   (let ((slist (cons (car nlist) slist)))
    (if (zero? n)
        slist
        (firstnprimes (- n 1) (listMinusNonprimes (car nlist) (car nlist) nlist) slist)))))

(define listminusnonprimes
     (lambda (num d lst)
       (if (null? lst)
           '()
           (if (= d (car lst))
               (listminusnonprimes num (+ num d) (cdr lst))
               (cons (car lst) (listminusnonprimes num d (cdr lst))))))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T01:26:18.403

你的定义`listminusnonprimes`是错误的。想象一下调用`(listminusnonprimes 3 3 '(3 5 7 9 11 ...))`（因为这会在您删除所有倍数后发生`2`）。Now`3`被删除，递归调用`(listminusnonprimes 6 3 '(5 7 9 11 ...))`，但`6`不存在，所以调用什么也不做，结果是`(3 5 7 9 11 ...)`。

我建议使用 mod 操作来实现这个功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T04:18:22.540

你不需要`(let ((slist (cons (car nlist) slist)))`。此外，如图所示使用 append 而不是 cons

```
(define firstnprimes
  (lambda (n nlist slist)
    (if (zero? n)
        slist
        (firstnprimes (- n 1) (listminusnonprimes (car nlist) (car nlist) nlist) (append slist (list (car nlist))))))) 
```

所以，

```
(firstnprimes 2 '(2 4 7 9 21 36) '()) => '(2 7)
(firstnprimes 3 '(2 4 7 9 21 36) '()) => '(2 7 9) 
```

但是，您的实施存在很多问题。首先，列表必须按升序排列。此外，列表必须以素数开头。此外， 中的素数个数`nlist`必须小于或等于`n`。 `(firstnprimes 4 '(2 4 7 9 21 36) '()) => '(2 7 9 21)`这是错误的

这是您的概念的更好的实现。

```
(define firstnprimes
  (lambda (n nlist slist)
    (if (or (zero? n) (null? nlist))
        slist
        (firstnprimes (- n 1) (listminusnonprimes (car nlist) (car nlist) nlist) (append slist (list (car nlist)))))))

(define listminusnonprimes
     (lambda (num d lst)
       (if (null? lst)
           '()
           (if (< d (car lst))
               (listminusnonprimes num (+ num d) lst)
               (if (= d (car lst))
                   (listminusnonprimes num (+ num d) (cdr lst))
                   (cons (car lst) (listminusnonprimes num (+ num d) (cdr lst)))))))) 
```

现在，

```
(firstnprimes 2 '(2 4 7 9 21 36) '()) => '(2 7)
(firstnprimes 3 '(2 4 7 9 21 36) '()) => '(2 7 9)
(firstnprimes 4 '(2 4 7 9 21 36) '()) => '(2 7 9) 
```

但是第一个元素仍然必须是素数

# android - Android 上的哪个进程/库负责将触摸事件分派给应用程序？

> ID：11621857
> 
> 赞同：0
> 
> 时间：2012-07-23T23:10:58.760
> 
> 标签：android, events, touch, shared-libraries, static-libraries

Android 上的哪个进程/库负责将触摸事件分派给应用程序？我非常专注于挂钩，以至于我完全忘记了 Android 源是可用的。

更新/澄清：我想让我的代码拦截系统中所有应用程序的所有触摸事件，对它们进行自定义处理并转发给原始接收器。

更新 2：假设有根设备和应用程序仅供私人/内部使用，不用于大规模分发

原始的，糟糕的问题：[Android 相当于 iOS MobileSubstrate 风格的挂钩？](https://stackoverflow.com/questions/11620873/android-equivalent-of-ios-mobilesubstrate-style-hooking)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T01:28:09.053

> 我想让我的代码拦截系统中所有应用程序的所有触摸事件，对它们进行自定义处理并转发给原始接收器。

这在股票 android 上是不可能的（即使您的设备已植根）。如果您希望这样做，您必须构建您自己的操作系统版本以支持它。

# delphi - 将备忘录内容添加到数据库

> ID：11621858
> 
> 赞同：0
> 
> 时间：2012-07-23T23:10:59.590
> 
> 标签：delphi, delphi-xe2, delphi-xe

得到了一个 cxmemo1，我需要将其内容添加到数据库中。现在我只添加第一行：

```
ABSQuery1.Params.ParamByName('A2').VALUE := CXMEMO1.text; 
```

我知道我需要修改这条线，但是如何修改？我希望输入备忘录中的所有行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:21:42.007

该代码中没有任何内容可以防止将多行发布到数据库。因此，要么`cxMemo.Text`属性没有首先返回所有文本，要么数据库在第一个换行符处截断字段文本。

# ruby-on-rails - 在 s3 上设置 mp4 文件的内容类型

> ID：11621863
> 
> 赞同：7
> 
> 时间：2012-07-23T23:11:24.720
> 
> 标签：ruby-on-rails, amazon-s3, paperclip

我在回形针 gem 和 s3 存储的帮助下将用户上传的视频添加到我的 RoRs 网站。由于某种我无法弄清楚的原因，每当用户上传 mp4 文件时，s3 都会将该文件的内容类型设置为`application/mp4`而不是`video/mp4`.

请注意，我已经在初始化文件中注册了 mp4 mime 类型：

`Mime::Type.lookup_by_extension('mp4').to_s => "video/mp4"`

这是我的 Post 模型的相关部分：

```
 has_attached_file :video, 
                :storage => :s3,
                :s3_credentials => "#{Rails.root.to_s}/config/s3.yml",
                :path => "/video/:id/:filename"

  validates_attachment_content_type :video,
     :content_type => ['video/mp4'],
     :message => "Sorry, this site currently only supports MP4 video" 
```

我在回形针和/或 s3 设置中缺少什么。

**＃＃＃＃更新＃＃＃＃＃**

由于某些超出我对 Rails 的了解的原因，我对包含 mp4 的文件的默认 mime 类型如下：

```
 MIME::Types.type_for("my_video.mp4").to_s
 => "[application/mp4, audio/mp4, video/mp4, video/vnd.objectvideo]" 
```

因此，当回形针将 mp4 文件发送到 s3 时，它似乎将文件的 mime 类型识别为第一个默认值“application/mp4”。这就是为什么 s3 将文件标识为内容类型为“application/mp4”的原因。因为我想启用这些 mp4 文件的流式传输，所以我需要回形针来将文件识别为具有“video/mp4”的 mime 类型。

有没有办法修改回形针（可能在 before_post_process 过滤器中）以允许这样做，或者有没有办法通过 init 文件修改 rails 以将 mp4 文件标识为“video/mp4”。如果我可以做任何一个，哪种方式最好。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T19:06:14.067

原来我需要在模型中设置一个默认的 s3 标头 content_type。这对我来说不是最好的解决方案，因为在某些时候我可能会开始允许 mp4 以外的视频容器。但这让我转向下一个问题。

```
 has_attached_file :video, 
                :storage => :s3,
                :s3_credentials => "#{Rails.root.to_s}/config/s3.yml",
                :path => "/video/:id/:filename",
                :s3_headers =>  { "Content-Type" => "video/mp4" } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-12T16:56:05.840

我做了以下事情：

```
...
MIN_VIDEO_SIZE = 0.megabytes
MAX_VIDEO_SIZE = 2048.megabytes
VALID_VIDEO_CONTENT_TYPES = ["video/mp4", /\Avideo/] # Note: The regular expression /\Avideo/ will match anything that starts with "video"

has_attached_file :video, {
  url: BASE_URL,
  path: "video/:id_partition/:filename"
}

validates_attachment :video,
    size: { in: MIN_VIDEO_SIZE..MAX_VIDEO_SIZE }, 
    content_type: { content_type: VALID_VIDEO_CONTENT_TYPES }

before_validation :validate_video_content_type, on: :create

before_post_process :validate_video_content_type

def validate_video_content_type
  if video_content_type == "application/octet-stream"
    # Finds the first match and returns it. 
    # Alternatively you could use the ".select" method instead which would find all mime types that match any of the VALID_VIDEO_CONTENT_TYPES
    mime_type = MIME::Types.type_for(video_file_name).find do |type| 
      type.to_s.match Regexp.union(VALID_VIDEO_CONTENT_TYPES)
    end

    self.video_content_type = mime_type.to_s unless mime_type.blank?   
  end
end
... 
```

# php - OpenCart：下拉标题购物车信息的 div 在哪里？

> ID：11621864
> 
> 赞同：13
> 
> 时间：2012-07-23T23:11:29.583
> 
> 标签：php, drop-down-menu, shopping-cart, opencart

我正在尝试设置 OpenCart 的样式，但很难找到哪个 TPL 文件包含当您单击标题中的购物车图标时出现的 div（向下滑动的“迷你购物车” - 它允许您无需前往即可查看购物车中的内容到购物车页面）。

有谁知道我在哪里可以找到具有此 div 的 .tpl 文件（在默认结构模板中）？谢谢

![在此处输入图像描述](../Images/d3f7f3ad4ef4b14ddbcfd95bc3b34190.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-24T11:02:18.980

为什么人们不赞成你？

`#content`DIV 位于 DIV 内-`#cart`你应该搜索过这个。

打开**/catalog/view/theme/default/template/common/header.tpl**

购物车标题位于`echo`

```
<?php echo $cart; ?> 
```

查看代码视图**/catalog/view/theme/default/template/module/cart.tpl**（在 v1.5.3.1 版本中）

该部分位于**.mini-cart-info**类的顶部。下面的一些代码片段的示例：

```
<div id="cart">
  <div class="heading">
    <h4><?php echo $heading_title; ?></h4>
    <a><span id="cart-total"><?php echo $text_items; ?></span></a></div>
  <div class="content">
    <?php if ($products || $vouchers) { ?>
    <div class="mini-cart-info">
      <table>
        <?php foreach ($products as $product) { ?>
        <tr>
          <td class="image"><?php if ($product['thumb']) { ?>
            <a href="<?php echo $product['href']; ?>"><img src="<?php echo $product['thumb']; ?>" alt="<?php echo $product['name']; ?>" title="<?php echo $product['name']; ?>" /></a>
            <?php } ?></td>
          <td class="name"><a href="<?php echo $product['href']; ?>"><?php echo $product['name']; ?></a>
            <div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-12T11:54:35.810

我同意@TheBlackBenzKid。

1）可以通过以下路径找到查看文件

```
"catalog/view/theme/default/template/module/cart.tpl" . 
```

2）控制器文件可以在下面的路径中找到

```
"catalog/controller/module/cart.php" . 
```

下面的链接可以为您提供修改与标题下拉购物车相关的文件的位置。我已经给出了如何修改和创建另一个与以前类似的下拉菜单的说明。

请查看此链接“ [https://github.com/pantlavanya/copy-opencart-mini-cart](https://github.com/pantlavanya/copy-opencart-mini-cart) ”

# asp.net - 使用 WCF 客户端使用非 WCF 服务并传递客户端证书

> ID：11621870
> 
> 赞同：1
> 
> 时间：2012-07-23T23:12:10.460
> 
> 标签：asp.net, wcf, x509certificate

我有一个使用 WCF 客户端调用 Java Web 服务的 ASP.NET 应用程序。通信一直有效，直到需要证书。我更新了配置，但我在调用时收到错误。有没有人有很好的配置示例？证书存储在证书存储中。

不需要客户端证书时有效的配置：

```
<system.serviceModel>
    <bindings>
            <basicHttpBinding>
                <binding name="DocManagementSOAP" closeTimeout="00:01:00" openTimeout="00:01:00"
                    receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false"
                    bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                    maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                    messageEncoding="Mtom" textEncoding="utf-8" transferMode="Buffered"
                    useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                    <security mode="Transport">
                        <transport clientCredentialType="None" proxyCredentialType="None" realm="" />
                        <message clientCredentialType="UserName" algorithmSuite="Default" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="https://acme.com/services/docmanagement_V3" 
                      binding="basicHttpBinding"
                      bindingConfiguration="DocManagementSOAP"
                      contract="FileNetDmsServiceReference.docManagement" 
                      name="DocManagementSOAP" />
        </client>
    </system.serviceModel> 
```

我尝试设置以通过客户端证书失败的配置：

```
 <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="DocManagementSOAP" 
                         closeTimeout="00:01:00" 
                         openTimeout="00:01:00"
                         receiveTimeout="00:10:00" 
                         sendTimeout="00:01:00" 
                         allowCookies="false"
                         bypassProxyOnLocal="false" 
                         hostNameComparisonMode="StrongWildcard"
                         maxBufferSize="65536" 
                         maxBufferPoolSize="524288" 
                         maxReceivedMessageSize="65536"
                         messageEncoding="Mtom" 
                         textEncoding="utf-8" 
                         transferMode="Buffered"
                         useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                    <security mode="Transport">
                        <transport clientCredentialType="Certificate" proxyCredentialType="None" realm=""/>
                        <message clientCredentialType="Certificate" algorithmSuite="Default"/>
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="https://acme.com/services/docmanagement_V3"
                      binding="basicHttpBinding"
                      bindingConfiguration="DocManagementSOAP"
                      behaviorConfiguration="CertificateBehavior"
                      contract="ServiceReference.docManagement"
                      name="DocManagementSOAP">
                <identity>
                    <dns value="cert.acme.com" />
                </identity>
            </endpoint>     
        </client>
        <behaviors>
            <endpointBehaviors>
                <behavior name="CertificateBehavior">
                    <clientCredentials>
                        <clientCertificate x509FindType="FindBySubjectName" findValue="cert.acme.com" storeLocation="LocalMachine"/>
                        <serviceCertificate>
                            <authentication certificateValidationMode="PeerOrChainTrust"
                                            revocationMode="NoCheck"
                                            trustedStoreLocation="LocalMachine" />
                        </serviceCertificate>
                    </clientCredentials>
                </behavior>
            </endpointBehaviors>
        </behaviors>
    </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T18:18:46.177

在与 Microsoft 技术支持合作后，这个配置终于奏效了：

```
<system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="DocManagementSOAP" 
                         messageEncoding="Mtom" 
                         textEncoding="utf-8">
                    <security mode="Transport">
                        <transport clientCredentialType="Certificate" proxyCredentialType="None" realm="" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="https://acme.com/services/docmanagement_V3"
                      binding="basicHttpBinding"
                      behaviorConfiguration="cert"
                      bindingConfiguration="DocManagementSOAP"
                      contract="docManagement"
                      name="DocManagementSOAP" />
        </client>
        <behaviors>
            <endpointBehaviors>
                <behavior name="cert">
                    <clientCredentials>
                        <clientCertificate findValue="cert.acme.com"
                                           storeLocation="LocalMachine"
                                           storeName="My"
                                           x509FindType="FindBySubjectName"/>
                    </clientCredentials>
                </behavior>
            </endpointBehaviors>
        </behaviors>
    </system.serviceModel> 
```

注意：如果您的服务不支持 MTOM，请删除或更改 messageEncoding 属性。

# html - 将可浮动元素转换为 td 元素

> ID：11621873
> 
> 赞同：1
> 
> 时间：2012-07-23T23:12:28.243
> 
> 标签：html, css, css-float, html-table

我无法让这种风格发挥作用。看一下我的图：

![](../Images/a1116d51f4d483f0abe43185eb903ab8.png)

标记：

```
<h1Title</h1>
<table>
    <tr>
        <td>
            <dfn>help</dfn>
            <a href="link0.php">
            <span>text</span></a>
        </td>
        <td><a href="link1.html">
            <span>text</span></a>
        </td>
    </tr>
</table> 
```

我试图`<td>`通过将`<a>`元素用作块来使元素可点击。但是，我也需要在`<dfn>`里面放一个带有元素的小“标题” `<td>`。我可以使`<dfn>`对齐到右上角并*保持*`<a>`垂直文本相对于其容器对齐，而不会与它`<dfn>`存在时发生冲突。

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:30:00.653

我更改了您的标记位并添加了一些定位和填充以使您发布的图像接近：

**HTML**

```
<h1>Title</h1>
<table>
    <tr>
        <td>
            <span class="cellContainer">
                <dfn>help</dfn>
                <a href="link0.php">text</a>
            </span>
        </td>
        <td>
            <a href="link1.html">text</a>
        </td>
    </tr>
</table> 
```

**CSS**

```
td {
    border: 1px solid black;
}
.cellContainer {
    position: relative;
    display: inline-block;
    padding: 12px 0;
}
a {
    background: grey;
    padding: 12px 24px;
}
dfn {
    position: absolute;
    top: 0;
    right: 0;
} 
```

**[jsFiddle 演示](http://jsfiddle.net/LuwtM/3/)**

演示中的边框代表单元格边框。灰色背景是链接区域。

# javascript - 如何获取 facebook 登录按钮的范围信息？

> ID：11621874
> 
> 赞同：-1
> 
> 时间：2012-07-23T23:12:34.453
> 
> 标签：javascript, facebook, scope

我从这里创建了一个 facebook 登录按钮：http: [//developers.facebook.com/docs/reference/plugins/login/](http://developers.facebook.com/docs/reference/plugins/login/)

我有以下登录按钮：

```
 <div class="fb-login-button" scope="email" data-show-faces="true" data-max-rows="3">Login with Facebook</div> 
```

那么，当用户接受权限时，我怎样才能获得用户信息（在这种情况下是电子邮件）？（在客户端使用 javazcript）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:40:08.957

如同：

[使用 Javascript 获取用户的 Facebook UID，](https://stackoverflow.com/questions/5846752/facebook-get-users-facebook-uid-with-javascript) 但您需要更进一步，通过`email`在响应对象中查找来获取他们的电子邮件。

```
FB.api('/me', function(response) {
    var email = response.email;
}); 
```

但是，您的应用必须向您的用户请求此权限，请在此处查看有关权限的 Facebook 文档：[https ://developers.facebook.com/docs/authentication/permissions/](https://developers.facebook.com/docs/authentication/permissions/)

# asp.net - 我可以在一个共享点站点上使用多个母版页吗？

> ID：11621877
> 
> 赞同：4
> 
> 时间：2012-07-23T23:12:38.430
> 
> 标签：asp.net, sharepoint, master-pages

我被要求将主页修改为全新的设计，所有其他页面将保持完全相同。

谈到sharepoint，我有点绿。我已经创建了母版页，但是当我选择***设置为默认母版页***或***设置为客户***母版页时，它会针对整个网站进行更改。我只想更改主页。

此时我遇到的唯一选择似乎是***从页面布局中分离，***这并不理想，因为网站的其余部分可能会被推入这个新皮肤

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T12:19:50.753

正如 nigel 所说，以编程方式更改此特定页面的母版页是唯一的选择。

您可以为主页创建自定义页面布局，然后在 pre-init 上设置母版页，如下所示：

```
public class MyPageLayout:PublishingLayoutPage 
{ 
    protected override void OnPreInit(EventArgs e) 
    { 
        base.OnPreInit(e); 
        this.MasterPageFile = "~/_catalogs/masterpage/mynewmasterpage.master";                    
    } 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T07:45:50.920

SharePoint 发布页面继承自 Microsoft.SharePoint.Publishing.PublishingLayoutPage 类，该类以编程方式将母版页设置为网站定义的自定义母版页。除了通过自己的代码来实现之外，没有其他方法可以覆盖此行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-05T15:24:10.500

根据您的描述，听起来您需要一个新的页面布局而不是母版页。

母版页通常用于导航、页脚和类似的外部布局并影响所有页面。页面布局用于特定设计，当您创建新页面时，您可以将其用作模板、特定布局的起点并通常显示您的内容

# c# - 处理 ASP.NET 类中的东西

> ID：11621881
> 
> 赞同：0
> 
> 时间：2012-07-23T23:12:53.303
> 
> 标签：c#, .net, ado.net

我有一个使用 C# 类文件的站点，在文件的顶部，我有：

`JTSEntities database = new JTSEntities();`（一个 ADO.NET 的东西）。

我把它放在首位，因为我真的不想一遍又一遍地写同样的东西。

但它提出了一个问题......因为它在那里的顶部，它将如何被处理，以及当用户关闭页面时我如何处理（或我需要）如何处理它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T23:19:08.883

保留任何包装数据库连接的时间超过需要的时间是不好的做法。

最佳做法是在当前操作（例如填充初始值等）不再需要数据库连接时立即释放数据库连接，例如类似

```
using (JTSEntities database = new JTSEntities())
{
    // Use database
} 
```

如果它实现了 IDisposable。

如果由于某种原因您*必须*在页面期间保持其活动状态，请确保在页面关闭事件处理程序中调用适当的方法来释放资源（.Close()、.Dispose() 等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T23:17:38.553

`IDisposable`在此类中实现并在`Dispose()`方法内处理此对象。使用此类时，请确保在完成后调用 Dispose（最好使用`using`块）

除此之外，您无需担心。

```
public class MyClass : IDisposable
{
    protected JTSEntities database = new JTSEntities();

    public void Dispose() 
    {
        database.Dispose();
    }
}

// When calling this class

using(MyClass cls = new MyClass())
{
    // Do Stuff
}  // Dispose is automatically called here. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-23T23:20:50.460

好的，根据属性的类型，我们可以说它是一个`instance attribute`. 这意味着该属性**将具有与拥有它的对象相同的生命周期**，除非它的实例被传递给另一个对象。

如果它受到保护，则只有所有者对象及其子对象（即从此类继承的对象）才能访问它。如果你不将它作为引用参数传递，那么我们可以接受第一条语句：一旦对象被清理，它就会被 GC 清理。

如果您只是在常规的 web 表单页面生命周期中使用此对象，那么您不必担心处置它。页面生命周期将为您完成。

问候

# algorithm - 炭笔画过滤器的制作方法

> ID：11621883
> 
> 赞同：5
> 
> 时间：2012-07-23T23:13:05.593
> 
> 标签：algorithm, opencv, computer-vision, image-manipulation

我对某种木炭过滤器感兴趣，例如 photoshop[影印过滤器](https://guidebookgallery.org/apps/photoshop/photocopy)或便条纸。有人有纸或一些说明这个过滤器是如何工作的吗？

在最好的情况下，我想创建以下内容：

输入：

[![图片由 ImageShack.us 托管](../Images/7bb5ef6aec3db136e26cb4e4d2707f0d.png)](https://i.stack.imgur.com/uz1P1.jpg)

输出：

[![图片由 ImageShack.us 托管](../Images/cf5de5593134043a000c46553cb2790a.png)](https://i.stack.imgur.com/zmrxg.jpg)

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T01:43:25.710

我*认为*这是一个类似于全色锐化的过程。我可以通过以下方式在 gimp 中获得非常相似的图像：

*   转换为灰色
*   复制到两层
*   轻轻模糊一层
*   使用大半径 DOG 滤波器在另一层进行边缘检测
*   合成两层，玩一点透明度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T23:41:59.437

这样做是将彩色图片转换为 0-1 位图图片。他们通常使用一个阈值函数，该函数对某些值返回 1（白色），对其他一些值返回 0（黑色）。

一个简单的功能是将图像从彩色转换为灰度，然后选择一个灰色阴影，上面的一切都是白色的，下面的一切都是黑色的。您使用的实际阈值可以根据图片的亮度进行自适应（您希望一定百分比的像素为白色）。

它还可以根据图片内的上下文进行自适应（即黑暗区域可能仍然有一些白色像素以显示局部对比度）。房子后面的树并不是全黑的，因为过滤对该区域的平均黑暗很敏感。

另请注意，树中靠近光隙的区域有一组暗像素，因为它相对较暗。家的边缘，长凳也被突出显示。有**一个边缘检测**元件在起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T00:06:53.520

我不知道你举的例子是什么效果，但有很多类似的。正如 VSOverFlow 指出的那样，对图像进行阈值处理会产生与此非常相似的结果，尽管我认为这不是正在使用的。Open cv 有一个功能，它的文档可以在[这里](http://opencv.willowgarage.com/documentation/cpp/miscellaneous_image_transformations.html)找到。您可能还想研究[Otsu 的](http://en.wikipedia.org/wiki/Otsu%27s_method)阈值方法。

正如 VSOverFlow 指出的那样，还有一个边缘检测元素在起作用。您可能想要研究[Sobel](http://en.wikipedia.org/wiki/Sobel_operator)和[Prewitt](http://en.wikipedia.org/wiki/Prewitt_operator)过滤器。这些是 3 个简单的选项，它们将为您提供类似于您提供的图像的内容。也许您可以阈值 Prewitt 过滤器的结果？我不知道 Photoshop 如何实现其过滤器。如果这些选项中没有一个与您要查找的内容足够接近，我建议您在 Photoshop 中查找有关这些过滤器的具体实现的信息。

# c++ - 如何在 Windows 上为 NetBeans 和 gcc 添加库包含路径？

> ID：11621885
> 
> 赞同：8
> 
> 时间：2012-07-23T23:13:12.630
> 
> 标签：c++, c, windows, gcc, netbeans

如何在 Windows 上为 NetBeans 和 gcc 添加库包含路径？

使用：

*   NetBeans 7.1.2
*   明威 ( `mingw-get-inst-20120426.exe`)
*   gcc 4.7.0

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-23T23:13:12.630

例如，您想将目录添加`C:\Program Files (x86)\Example\1.0\include\`为包含路径。

一、设置代码辅助：

*   NetBeans > 工具 > 选项 > C/C++ > 代码帮助
    *   C 编译器 > 包含目录：
        *   `C:\Program Files (x86)\Example\1.0\include\shared`
        *   `C:\Program Files (x86)\Example\1.0\include\other`
        *   `C:\Program Files (x86)\Example\1.0\include`
        *   `C:\MinGW\lib\gcc\mingw32\4.7.0\include`
        *   `C:\MinGW\include`
        *   `C:\MinGW\lib\gcc\mingw32\4.7.0\include-fixed`
        *   ...
    *   C++ 编译器 > 包含目录：
        *   `C:\Program Files (x86)\Example\1.0\include\shared`
        *   `C:\Program Files (x86)\Example\1.0\include\other`
        *   `C:\Program Files (x86)\Example\1.0\include`
        *   `C:\MinGW\lib\gcc\mingw32\4.7.0\include\c++`
        *   `C:\MinGW\lib\gcc\mingw32\4.7.0\include\c++\mingw32`
        *   `C:\MinGW\lib\gcc\mingw32\4.7.0\include\c++\backward`
        *   `C:\MinGW\lib\gcc\mingw32\4.7.0\include`
        *   `C:\MinGW\include`
        *   `C:\MinGW\lib\gcc\mingw32\4.7.0\include-fixed`
        *   ...
    *   好的。

这些`C:\MinGW\...`目录只是示例。不要实际添加它们。NetBeans 应该已经自动检测并添加了 MinGW 目录。如果没有，请尝试重置设置：

*   NetBeans > 工具 > 选项 > C/C++
    *   代码协助
        *   C 编译器 > 重置设置
        *   C++ 编译器 > 重置设置
    *   构建工具
        *   恢复默认值

* * *

有关现有源的自动代码帮助的说明，请参阅：

*   C/C++ 项目快速入门教程：

    [http://netbeans.org/kb/docs/cnd/quickstart.html#makefileprojects](http://netbeans.org/kb/docs/cnd/quickstart.html#makefileprojects)

*   从现有代码创建项目时如何配置代码辅助：

    [http://netbeans.org/kb/docs/cnd/configuring-code-assistance.html](http://netbeans.org/kb/docs/cnd/configuring-code-assistance.html)

* * *

现在，配置项目选项：

*   右键单击项目>属性
    *   配置：<所有配置>
    *   建造
        *   C 编译器
            *   一般的
                *   包括目录：
                    *   `C:\Program Files (x86)\Example\1.0\include\shared`
                    *   `C:\Program Files (x86)\Example\1.0\include\other`
                    *   `C:\Program Files (x86)\Example\1.0\include`
            *   编译行
                *   附加选项：
                    *   `-std=c11 -g3 -pedantic -Wall -Wextra -O0`
        *   C++ 编译器
            *   一般的
                *   包括目录：
                    *   `C:\Program Files (x86)\Example\1.0\include\shared`
                    *   `C:\Program Files (x86)\Example\1.0\include\other`
                    *   `C:\Program Files (x86)\Example\1.0\include`
            *   编译行
                *   附加选项：
                    *   `-std=c++11 -g3 -pedantic -Wall -Wextra -O0`
    *   好的。

要默认为所有项目添加命令行选项，请参阅：

*   [GCC 的 NetBeans 设置](https://stackoverflow.com/questions/4114042/netbeans-settings-for-gcc/11643274#11643274)

路径中的任何空格都应自动转义。任何反斜杠都应自动替换为正斜杠。

例如，“附加选项”中的“所有选项”文本框如下所示：

```
-std=c11 -g3 -pedantic -Wall -Wextra -O0 -g -I/C/Program\ Files\ \(x86\)/Example/1.0/include/shared -I/C/Program\ Files\ \(x86\)/Example/1.0/include/other -I/C/Program\ Files\ \(x86\)/Example/1.0/include 
```

如果这不起作用，您可能必须修复路径并在附加选项中手动添加包含。例如，替换`/C/`为`C:/`。

```
-std=c11 -g3 -pedantic -Wall -Wextra -O0 -g -IC:/Program\ Files\ \(x86\)/Example/1.0/include/shared -IC:/Program\ Files\ \(x86\)/Example/1.0/include/other -IC:/Program\ Files\ \(x86\)/Example/1.0/include 
```

如果您使用的是 Cygwin `make`，并且如果您尝试在命令中使用冒号清理或重建项目，您可能会收到一条`*** multiple target patterns. Stop.`错误消息。根据[多目标模式的答案？](https://stackoverflow.com/questions/10614758/multiple-target-patterns/)并且[非常简单的应用程序因 Eclipse 的“多个目标模式”而失败，“](https://stackoverflow.com/questions/2401976/very-simple-application-fails-with-multiple-target-patterns-from-eclipse/)在路径中`make`看到并认为它是另一个目标定义，因此出现错误。”`:`

解决方法是每次在构建项目之前删除生成的`build`和文件夹。`dist`但是，这可能很烦人，因此您可以尝试使用 MinGW MSYS `make`（不要与不支持的 MinGW`make`混淆[）](http://netbeans.org/community/releases/68/cpp-setup-instructions.html#mingw)。

有关 MinGW 和 MSYS 配置说明，请参见：

*   为 C/C++/Fortran 配置 NetBeans IDE：

    [http://netbeans.org/community/releases/68/cpp-setup-instructions.html#mingw](http://netbeans.org/community/releases/68/cpp-setup-instructions.html#mingw)

要使用 MinGW 和 Unicode，您应该安装最新版本的 MinGW-w64。看：

*   [wWinmain、Unicode 和 Mingw](https://stackoverflow.com/questions/3571250/wwinmain-unicode-and-mingw/11706847#11706847)

# android - 控制在我的应用上投放哪些广告

> ID：11621888
> 
> 赞同：1
> 
> 时间：2012-07-23T23:13:29.060
> 
> 标签：android, admob, ads

全部 - 我想知道当我使用 AdMob 时是否有办法控制我的应用上的广告，或者我根本没有发言权。我关心的唯一原因是我不希望用户得出这样的结论，即当他们有射击游戏的广告时，我的应用会说暴力。谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:24:31.310

在 AdMob 站点和应用程序页面上查看应用程序附近的管理设置，您可以在此处选择要显示的广告类型以及按文本/URL 过滤

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:18:44.463

当然，您可以选择要展示的广告类型。AdMob 控制面板中提供了所有设置。

# java - java的fbx解析器/加载器存在吗？

> ID：11621890
> 
> 赞同：2
> 
> 时间：2012-07-23T23:13:47.327
> 
> 标签：java, parsing, model

我正在用java构建一个交互式程序，但我需要从一个对象中提取动画。是的，我可以通过为每个动画设置关键帧来做到这一点，但是文件数量（加上处理）加起来真的很快。

有没有一种类似于解析/加载**obj文件的解析/加载****fbx**文件的方法？

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T09:54:29.850

不是 java 实现，但这里是 Python 二进制 FBX 解析器（单个 python 脚本约 150 行），它很容易移植。

[http://github.com/ideasman42/pyfbx_i42](http://github.com/ideasman42/pyfbx_i42)

编辑，直接链接到源文件：

[http://github.com/ideasman42/pyfbx_i42/blob/master/pyfbx/parse_bin.py](http://github.com/ideasman42/pyfbx_i42/blob/master/pyfbx/parse_bin.py)**

# python - 函数调用在 C 中有效，但在 Python 中使用 OpenCV 使用 Python 访问 Prosilica GigE 相机时会出现段错误

> ID：11621893
> 
> 赞同：1
> 
> 时间：2012-07-23T23:14:13.083
> 
> 标签：python, c, opencv, camera, computer-vision

我尝试调试的一般问题是为什么 C 程序可以毫无问题地调用函数，但是当在 Python 中调用相同的函数时会导致段错误。

我正在尝试使用 modules/highgui/src/cap_pvapi.cpp 获取 Python OpenCV 绑定以访问 AVT GigE GC1360H 相机。我可以在 C 中完美地读取和显示来自相机的帧，但是当我尝试在 Python 中读取帧时，解释器会出现段错误。在 Python 中调用 VideoCapture.open(0) 成功将摄像头初始化为 Mono8 模式，并且观看 ifconfig 显示来自摄像头的数据。我可以使用我的 v4l 网络摄像头而不是 AVT 摄像头来运行相同的 Python 代码，并且效果很好。我在 Gentoo Linux 3.2.12 x64 上使用 OpenCV 2.3.1。这是我正在使用的 Python 代码，在 Python 2.7.2 上运行：

```
import cv2

if __name__ == '__main__':
    cv2.namedWindow("Cam", 1)
    capture = cv2.VideoCapture()
    capture.open(0) # This successfully opens the Camera and ifconfig
shows data being transferred
    while True:
        img = capture.read()[1] # This is where it segfaults

        cv2.imshow("Cam", img)
        if cv2.waitKey(10) == 27: break

    cv2.destroyWindow("Cam") 
```

我将 gdb 附加到 Python 解释器，并发现它在 OpenCV 源中的 CvCaptureCAM_PvAPI::grabFrame() 内调用 PvCaptureQueueFrame() 时出现段错误。这是输出：

```
alex@Wassenberg ~ $ gdb python GNU gdb (Gentoo 7.3.1 p2) 7.3.1 Copyright (C) 2011 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html> This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law.  Type "show copying" and "show warranty" for details. This GDB was configured as "x86_64-pc-linux-gnu". For bug reporting instructions, please see: <http://bugs.gentoo.org/>... Reading symbols from /usr/bin/python...(no debugging symbols found)...done. (gdb) run ./pyview.py Starting program: /usr/bin/python ./pyview.py process 8921 is executing new program: /usr/bin/python2.7 [Thread debugging using libthread_db enabled] [New Thread 0x7fffe3c10700 (LWP 8929)] [New Thread 0x7fffe340f700 (LWP 8930)] [New Thread 0x7fffe2c0e700 (LWP 8931)] [New Thread 0x7fffe240d700 (LWP 8932)] [Thread 0x7fffe240d700 (LWP 8932) exited] [New Thread 0x7fffe240d700 (LWP 8933)] [Thread 0x7fffe240d700 (LWP 8933) exited] [New Thread 0x7fffe240d700 (LWP 8940)] [Thread 0x7fffe240d700 (LWP 8940) exited] [New Thread 0x7fffe240d700 (LWP 8941)] [New Thread 0x7fffe1c0c700 (LWP 8942)] [New Thread 0x7fffe0eb9700 (LWP 8948)] [New Thread 0x7fffdbfff700 (LWP 8949)]

Program received signal SIGSEGV, Segmentation fault. 0x00007ffff007c8ea in PvCaptureQueueFrame () from /usr/local/lib/libPvAPI.so (gdb) bt
#0  0x00007ffff007c8ea in PvCaptureQueueFrame () from /usr/local/lib/libPvAPI.so
#1  0x00007ffff55dd123 in CvCaptureCAM_PvAPI::grabFrame() () from /usr/lib64/libopencv_highgui.so.2.3
#2  0x00007ffff55dde31 in cvGrabFrame () from /usr/lib64/libopencv_highgui.so.2.3
#3  0x00007ffff55dde4d in cv::VideoCapture::grab() () from /usr/lib64/libopencv_highgui.so.2.3
#4  0x00007ffff55ddaf2 in cv::VideoCapture::read(cv::Mat&) () from /usr/lib64/libopencv_highgui.so.2.3
#5  0x00007ffff6b355c5 in ?? () from /usr/lib64/python2.7/site-packages/cv2.so
#6  0x00007ffff7afdfdc in PyEval_EvalFrameEx () from /usr/lib64/libpython2.7.so.1.0
#7  0x00007ffff7aff88d in PyEval_EvalCodeEx () from /usr/lib64/libpython2.7.so.1.0
#8  0x00007ffff7aff9a2 in PyEval_EvalCode () from /usr/lib64/libpython2.7.so.1.0
#9  0x00007ffff7b19afc in ?? () from /usr/lib64/libpython2.7.so.1.0
#10 0x00007ffff7b1a930 in PyRun_FileExFlags () from /usr/lib64/libpython2.7.so.1.0
#11 0x00007ffff7b1b50f in PyRun_SimpleFileExFlags () from /usr/lib64/libpython2.7.so.1.0
#12 0x00007ffff7b2c823 in Py_Main () from /usr/lib64/libpython2.7.so.1.0
#13 0x00007ffff74902ad in __libc_start_main () from /lib64/libc.so.6
#14 0x00000000004008a9 in _start () (gdb) 
```

对此问题的任何见解将不胜感激。最终，这个问题归结为为什么 C 可以毫无问题地调用 grabFrame() 但 Python 段错误。我倾向于认为问题在于生成与 C 的 Python 绑定的方式，但我不熟悉 OpenCV 是如何做到这一点的。任何想法为什么 grabFrame() 和 PvCaptureQueueFrame() 在 C 中可以正常工作但在 Python 中不能正常工作？

以下是可以成功读取 AVT 摄像头的 C 程序供参考：

```
#include <opencv2/imgproc/imgproc_c.h>
#include "opencv2/highgui/highgui.hpp"
#include <stdio.h>

int main(int argc, char** argv)
{
      printf("Press ESC to exit\n");
      cvNamedWindow( "First Example of PVAPI Integrated", CV_WINDOW_AUTOSIZE );
      CvCapture* capture = cvCreateCameraCapture( CV_CAP_PVAPI );
      assert( capture != NULL );

      IplImage* frame;

      while(1)
      {
            frame = cvQueryFrame(capture);

            if(!frame) break;
            cvShowImage( "First Example of PVAPI Integrated", frame);
            char c = cvWaitKey(50);
            if( c == 27) break;
      }
      cvReleaseCapture( &capture );
      cvDestroyWindow( "First Example of PVAPI Integrated" );
} 
```

使用 gcc 4.5.3-r2 编译：

> gcc -I/usr/include/opencv -o main ./main.c -lopencv_core -lopencv_imgproc -lopencv_highgui -lopencv_ml -lopencv_video -lopencv_features2d -lopencv_calib3d -lopencv_objdetect -lopencv_contrib -lopencv_legacy -lopencv_flann

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:02:26.490

我解决了这个问题，C 代码和 Python 代码之间的唯一区别是传递给 cvCreateCameraCapture() 的参数（Python 中的 capture.open()）。将 0 传递给这个函数（就像我在 Python 中所做的那样）应该让它扫描 OpenCV 支持的任何视频设备，它确实做到了。传递 CV_CAP_PVAPI（就像我在 C 中所做的那样）应该将此搜索限制为仅 Prosilica 设备。虽然这些应该产生完全相同的结果（他们都找到了相同的相机），但当传入 0 时，相机没有被初始化并且还没有准备好接受队列中的 tPvFrames。将 800 传递给 capture.open() 可以解决问题，因为 800 是 CV_CAP_PVAPI 的值。

# windows-ce - 设备驱动程序未调用 Xxx_Init

> ID：11621894
> 
> 赞同：1
> 
> 时间：2012-07-23T23:14:27.107
> 
> 标签：windows-ce, driver

我刚开始开发驱动程序，并试图在启动时通过操作系统初始化设备驱动程序。该驱动程序适用于 Windows Embedded CE 6.0。

我一直试图让我的设备在初始化时通过串行端口向我的 PC 发送消息。

```
DWORD MYD_Init(LPCTSTR pContext, LPCVOID lpvBusContext)
{
    DWORD dwResult = 1;

    RETAILMSG(TRUE, (TEXT("MyDriver: Initializing!\n")));
    DEBUGMSG(TRUE, (TEXT("MyDriver: Initializing!\n")));

    return dwResult;
} //end MYD_Init 
```

DLLEntry 函数被调用：

```
BOOL DllEntry(HANDLE hDllHandle, DWORD dwReason, LPVOID lpreserved) 
{
    switch (dwReason) {

        case DLL_PROCESS_ATTACH:
            RETAILMSG(TRUE, (TEXT("MyDriver - Process Attached\n")));
            DEBUGMSG(TRUE, (TEXT("MyDriver - Process Attached\n")));
            break;

        case DLL_PROCESS_DETACH: 
            RETAILMSG(TRUE, (TEXT("MyDriver - Process Detached\n")));
            DEBUGMSG(TRUE, (TEXT("MyDriver - Process Detached\n")));
            break;

        .......

        default:
            break;
    } //end Switch

    return TRUE;

} //end DllEntry 
```

以下是串行端口日志中的几行：

```
FMD_Init: Blocks reserved for the bootloader/run-time image: 3124
I2C Driver: Intialization Started
MyDriver - Process AttachedMyDriver - Process DetachedTurn on clocks for Device block (in OTG_CTRL)
2589 CUSBFN::IsConfigurationSupportable
2593 CUSBFN::IsEndpointSupportable
2595 CUSBFN::IsEndpointSupportable 
```

第三行显示驱动程序已加载（我认为），但之后未调用 MYD_Init 。我不确定我错过了什么。可能是另一个文件中缺少参考。我的 .def 文件包括 EXPORTS 下的 MYD_Init。.reg 键位于内置路径中：[HKEY_LOCAL_MACHINE\Drivers\BuiltIn\MyDriver]。不确定是否还有其他人。

我想我真正的问题是我可能遗漏/忘记调用 MYD_Init 函数的可能是什么？

感谢你们提供的任何帮助来帮助我完成这项工作！

**编辑：**

我已经意识到 CreateFile 函数从未被调用，并且觉得这是我的问题的原因。我可以采取哪些步骤来确定该函数的放置位置，以便在 DllEntry 之前不调用 MYD_Init？

或者可能是 ActivateDevice/ActiveDeviceEx 函数？操作系统会自动为 [HKEY_LOCAL_MACHINE\Drivers\BuiltIn] 下列出的驱动程序调用这些，还是必须手动调用它们？

再次感谢您提供的任何见解！

**编辑2：**

以下是易于阅读的注册表设置：

```
[HKEY_LOCAL_MACHINE\Drivers\BuiltIn\MyDriver]
    "Prefix"="MYD"
    "Dll"="myDriver.dll"
    "Index"=dword:1
    "Flags"=dword:0 
```

**编辑3：**

这是尝试通过应用程序打开驱动程序后的输出：

```
USBFN: dwDeviceStatus: 0x11, m_fAttached: Attached
USBFN: dwDeviceStatus: 0x1, m_fAttached: Attached
MyDriver - Process Attached 
MyDriver - Process Detached 
COM_Open
COM_Open
IOCTL_SERIAL_SET_COMMTIMEOUTS (50,1,50,5,500)
IOCTL_SERIAL_SET_COMMTIMEOUTS (50,1,50,5,500)
IOCTL_SERIAL_SET_COMMTIMEOUTS (-1,0,0,2,500)
Testing Driver 
MyDriver - Process Attached 
MyDriver - Process Detached 
Driver Tested 
```

第 3 行和第 4 行是系统引导期间的加载尝试。最后四行是在运行加载驱动程序的应用程序时输出的。“Testing Driver”和“Driver Tested”分别放在应用程序的开头和结尾。

**编辑 4：垃圾箱输出**

```
Dump of file myDriver.dll

File Type: DLL

Section contains the following exports for myDriver.dll

    00000000 characteristics
    501012DA time date stamp Wed Jul 25 10:38:02 2012
        0.00 version
           1 ordinal base
           9 number of functions
           9 number of names

    ordinal hint RVA      name

          1    0 000013D4 DllEntry = DllEntry
          2    1 00001348 MYD_Close = MYD_Close
          3    2 0000130C MYD_Deinit = MYD_Deinit
          4    3 000013B8 MYD_IOControl = MYD_IOControl
          5    4 000012B8 MYD_Init = MYD_Init
          6    5 00001328 MYD_Open = MYD_Open
          7    6 00001364 MYD_Read = MYD_Read
          8    7 0000139C MYD_Seek = MYD_Seek
          9    8 00001380 MYD_Write = MYD_Write

Summary

        1000 .data
        1000 .pdata
        1000 .reloc
        1000 .text 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:48:31.340

`Xxx_Init`将在加载驱动程序时调用。它可以通过手动调用 ActivateDevice 来加载，或者通过在其中设置正确的注册表设置由 DeviceManager 自动加载`[HKLM\Drivers\BuiltIn]`（向我们展示您正在使用的密钥）。

`Xxx_Init`保证在之后调用，`DllEntry`因为`DllEntry`在操作系统加载 DLL 时调用，这必须在设备管理器加载它之前发生。

`CreateFile``Xxx_Open`在所有这些动作发生之后调用驱动程序中的方法。

所以事件的顺序是：

1.  操作系统加载 DLL，调用`DllEntry`
2.  设备管理器加载驱动程序（手动或自动），调用`Xxx_Init`
3.  App通过调用打开驱动`CreateFile`，使设备管理器调用`Xxx_Open`

列表中可能有一些电源管理部分可能属于 2.5，但它们是可选的，可能与您看到的问题无关。

通常，在首次测试驱动程序启动时，我将使用对测试应用程序的显式调用`ActivateDevice`/来自测试应用程序的显式调用。`DeactivateDevice`它使您无需每次都重新启动系统即可替换驱动程序 DLL。

所以给你的问题是：

1.  如果您从应用程序手动调用 ActivateDevice，会发生什么？
2.  您当前用于尝试让设备管理器加载驱动程序的注册表项是什么？

# xcode - 带有情节提要的自定义 UIControls

> ID：11621895
> 
> 赞同：0
> 
> 时间：2012-07-23T23:14:29.977
> 
> 标签：xcode, ios5, uicontrol

我很难弄清楚这一点。我有一个自定义 UIControl 类设置为保存 UIImage 和 UILabel，我的 UITableViewCell 类包含其中两个 UIControls（leftProduct 和 rightProduct）

```
@interface FeaturedProductControl : UIControl

@property (strong, nonatomic) IBOutlet UIImageView *featuredProductPhoto;
@property (strong, nonatomic) IBOutlet UILabel *featuredProductDescription;
@property (strong, nonatomic) Product *featuredProduct;

- (id)initWithProduct:(Product *)product;

@end

@interface FeaturedTableCell :  UITableViewCell

@property (strong, nonatomic) IBOutlet FeaturedProductControl *leftProduct;
@property (strong, nonatomic) IBOutlet FeaturedProductControl *rightProduct;

@end 
```

在 cellForRowAtIndexPath 期间使用 init 方法填充图像和标签，并且它们通过就好了。我有一个与情节提要中的 UIControls 关联的目标操作，但 productClicked: 方法似乎没有被调用。我尝试将其更改为以编程方式添加目标操作，但不走运。

但是，如果我在代码中添加 alloc/init，productClicked: 方法会正确触发，但不幸的是 UILabel 和 UIPhoto 现在在屏幕上显示为空。由于 UIControls 是在 Storyboard 中设计的，我认为我不应该自己进行 alloc 调用，但 TableViewController 似乎不喜欢它没有被调用。我尝试在 [[FeaturedTableCell alloc] init] 中调用 alloc，但没有效果。

cellForRowAtIndexPath 的内容：cellIdentifier = @"Featured Row";

```
FeaturedTableCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

if (cell == nil) 
{
    cell = [[FeaturedTableCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
}

FeaturedRow *featuredRowData = [self.productIndexModel objectAtIndexPath:indexPath];  // This contains the necessary products to fill the Row

Product *leftProduct = [featuredRowData.skuList objectAtIndex:0];

cell.leftProduct = [[FeaturedProductControl alloc] initWithProduct:leftProduct];  // Actions trigger, but no data
// cell.leftProduct = [cell.leftProduct initWithProduct:leftProduct];  // Data is filled in, but no action

// [cell.leftProduct addTarget:self action:@selector(productClicked:) forControlEvents:UIControlEventTouchUpInside];  // the storyboard mapping works without this line of code

if (featuredRowData.skuList.count > 1)
{
    Product *rightProduct = [featuredRowData.skuList objectAtIndex:1];

    cell.rightProduct = [cell.rightProduct initWithProduct:rightProduct];
//     cell.rightProduct = [[FeaturedProductControl alloc] initWithProduct:rightProduct];  // Yes, these two are reversed from the left side code above for testing
    [cell.rightProduct addTarget:self action:@selector(productClicked:) forControlEvents:UIControlEventTouchUpInside];

    cell.rightProduct.hidden = NO;  // right side column is hidden in case the number of products is odd
}
else 
{
    cell.rightProduct.hidden = YES;
}

[cell setNeedsLayout];

return cell; 
```

知道我做错了什么吗？我试图在情节提要中保留尽可能多的初始化和设置，所以我不想回去以编程方式编写整个 UIControl。

感谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T22:21:41.170

弄清楚了。在我的`initWithProduct`方法中，我包括

```
self = [super init]; 
```

我注释掉了这一行，Touch Up Inside 事件开始正常触发。

# c# - 返回方法列表

> ID：11621896
> 
> 赞同：1
> 
> 时间：2012-07-23T23:14:43.223
> 
> 标签：c#, asp.net

我正在寻找以下模式：

我有几种这样的方法：
1\. private bool CheckIfStringExist(string lookupString, ref string errorMessage)
2\. private bool NumbersAreEqual(int one, int two, ref string errorMessage)
...
（其中大约 15 个）。

我想要做的是按特定顺序运行它们，如果其中任何一个失败，则向用户输出错误消息。我还想向用户显示方法友好名称。

到目前为止，我想出了以下内容。

我创建了一个类来分别保存每个方法：

```
public class CheckingMethod
{
    public string name {get; set;}
    public Action method {get; set;}
    public bool success {get; set;}

    public CheckingMethod(string name, Action method)
    {
        this.name= name;
        this.method = method;
        this.success = false;
    }
} 
```

这允许我将所有方法存储在一个列表中......就像这样：

```
List<CheckingMethod> cms = new List<CheckingMethod>();
cms.Add(new CheckingMethod("Check if text exist", ()=>CheckIfStringExist(lookupString, ref errorMessage);
cms.Add(new CheckingMethod ("Check if numbers are equal", ()=>NumbersAreEqual(num1, num2, ref errorMessage); 
```

然后我可以像这样一一运行它们：

```
foreach (CheckingMethod cm in cms)
{
    cm.method()
} 
```

不幸的是，Action 只返回 void 类型，所以我无法判断我的方法返回的是 false 还是 true。此外，如果先前返回 false，我需要禁止运行下一个方法（但并非总是如此，只是在某些情况下）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T23:19:14.263

Action 只是一个委托，它被设计为在没有返回类型的情况下使用

但是您可以将`Action`委托更改为`Func`委托

```
public Func<bool> method {get; set;} 
```

> 此外，如果先前返回 false，我需要禁止运行下一个方法（但并非总是如此，只是在某些情况下）。

解决此问题的一种方法是：

1.  向您的类添加一个属性，以确定如果返回类型不为真，是否应运行下一个方法

    ```
    public bool RunNextMethodIfConditionFails {get; set;} 
    ```

2.  `foreach`在你的循环中检查这个属性：

    ```
    foreach (CheckingMethod cm in cms)
    {
        var res = cm.method();
        if (!res && !cm.RunNextMethodIfConditionFails)
        {
            // react to this case, throw an exception or exit the loop using break
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T23:18:47.183

使用`Func<bool>`而不是`Action`. `Func`适用于返回值的委托。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T23:19:55.313

使用接受返回类型的委托[`Func<T, TResult>`](http://msdn.microsoft.com/en-gb/library/bb549151.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T23:24:57.863

改用 Func

公共类 CheckingMethod { 公共字符串名称 {get; 设置；} 公共函数方法 {get; set;} public bool 成功 { get { return method(); }}

```
 public CheckingMethod(string name, Func<Bool> method) 
   { 
    this.name= name; 
    this.method = method; 
   } 
} 

List<CheckingMethod> cms = new List<CheckingMethod>();  
cms.Add(new CheckingMethod("Check if text exist", ()=>CheckIfStringExist(lookupString, ref errorMessage);  
cms.Add(new CheckingMethod ("Check if numbers are equal", ()=>NumbersAreEqual(num1, num2, ref errorMessage);

bool AllOK=true;
foreach (var cm in cms) {
  if (!cm.success) {
    AllOK=false;
    Debug.WriteLine("Failed on :" + cm.name);
    break; // this stops the for loop
  }
} 
```

AllOk 如果失败则为假。

# python - 如何在 python 中插入地理参考数据？

> ID：11621898
> 
> 赞同：9
> 
> 时间：2012-07-23T23:15:02.157
> 
> 标签：python, statistics, spatial-interpolation

我有许多具有每周分辨率的地理参考水文数据：

`Station name, Lat, Long, Week 1 average, Week 2 average ... Week 52 average`

不幸的是，我也有一些只有每月分辨率的数据：

`Station name, Lat, Long, January average, February average ... December average`

与其“重新发明轮子”，任何人都可以推荐一个最喜欢的模块、包或技术，以提供从月值中合理插值周值的方法吗？线性会很好，但如果我们可以使用坐标来改进基于附近站点的插值，那就太好了。

我用 python 标记了这篇文章，因为它是我最近一直在使用的语言（尽管不是它的统计函数）。如果答案是“使用类似的统计程序`r`”，那就这样吧，但我很好奇 python 有什么。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T01:25:06.613

我没有机会深入研究它，但是[`hpgl`](http://hpgl.aoizora.org/index.php?option=com_content&view=article&id=47&Itemid=56)（高性能地统计库）提供了许多克里金法（地理空间插值）方法：

**算法**

*   简单克里金法 (SK)
*   普通克里金法（OK）
*   指示克里金法 (IK)
*   局部变均值克里金法（LVM 克里金法）
*   简单的 CoKriging（马尔可夫模型 1 和 2）
*   顺序指标模拟 (SIS)
*   Corellogram 局部变化平均 SIS (CLVM SIS)
*   局部变均值 SIS (LVM SIS)
*   顺序高斯模拟 (SGS)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-30T15:37:35.897

如果您有兴趣将您的经验扩展到 R 中，那么有许多很好的、使用良好且文档化的软件包。我将从查看 Spatial Taskview 开始，它列出了哪些包可用于空间数据。其中一段涉及插值。我最熟悉 automap/gstat（我写了 automap），尤其是 gstat 是一个强大的地统计软件包，它支持多种方法。

[http://cran.r-project.org/web/views/Spatial.html](http://cran.r-project.org/web/views/Spatial.html)

可以通过多种方式集成 Python 和 R，例如使用系统调用或使用 Rpy 的内存链接。也可以看看：

[R 编程语言的 Python 接口](https://stackoverflow.com/questions/11716923/python-interface-for-r-programming-language/11718472#11718472)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T10:27:08.690

我正在考虑做同样的事情，我发现[这个克里金模块是由](http://www.ambhas.com/tools/html/krige_8py_source.html)[AMBHAS](http://www.ambhas.com/)的 Sat Kumar Tomer编写的。

似乎有产生变异函数和执行普通克里金的方法。

如果我使用它并做出进一步的发现，我会更新这个答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-01T00:03:37.770

自从我最初发布这个问题（在 2012 年！）以来，一个积极开发的 Python Kriging 模块已经发布[https://github.com/bsmurphy/PyKrige](https://github.com/bsmurphy/PyKrige)

还有这个较旧的选项： [https ://github.com/capaulson/pyKriging](https://github.com/capaulson/pyKriging)

# c++ - iOS项目中的cpp编译问题

> ID：11621902
> 
> 赞同：1
> 
> 时间：2012-07-23T23:15:28.417
> 
> 标签：c++, objective-c, ios

我在现有的 iOS 项目中添加了一些目标 C 文件和 c++ 文件。当我将 .mm 文件的 .h 文件导入具有相应 .m 文件的 .h 文件时，会出现各种错误。

当我将 .h 文件的 .m 文件更改为 .mm 导入新代码时，我会得到相同的先前错误，但新的 .mm 文件会出现新错误。

我不确定如何解决这个问题。

如果这有任何影响，我正在使用 ARC。

它抱怨命名空间（未知类型）、导入的 .mm 文件的未知名称问题、.mm 文件的 .h 文件中包含 :: 的语句的预期表达式错误。我没有得到的是这些文件在我从中复制它们的项目中正常工作。我只从项目中获取源代码。并在目录中添加了标题搜索路径。我还选择了创建对添加目录的引用选项。

由于某种原因，文件不在编译源部分中，当我尝试添加它们时，文件选择器树不包含我添加的这些源文件。添加的目录也是蓝色而不是黄色，但为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T00:02:05.273

如您所知，C++ 代码只能在 .mm 文件中使用。当编译器抱怨`namespace`是未知类型时，通常意味着在应该使用 Objective C++ 编译器时正在使用 Objective C 编译器。更简单地说：您有一个 .m 文件，它必须是 .mm。

一般来说，您可以选择两种选择。每次 Objective C 文件抱怨时，将其更改为 .mm。这是一个滑坡，通常会导致您的整个项目级联成一个巨大的 Objective C++ 球。另一种选择是隔离 C++，这样只有极少的 Objective C 文件需要 .mm 扩展名。

显然，后者是更好的选择。造成混淆的可能原因是#importing 一个头文件，其中包含来自应用程序其他地方的 C++ 代码，而实际上*并不*需要 C++。如果 C++ 是 Objective C 类的实现细节，您可以尝试通过利用类扩展将 C++ 保留在类的头文件之外。否则，您可以创建一个 Objective C 类，其唯一目的是将 C++ 包装在它自己的实现中，同时公开一个干净的头文件供其他类使用。

基本上，如果你能保持你的头文件干净，那么你就不必担心不小心将一些 C++ 间接地#importing 到一个毫无戒心的编译单元中。

# django - 为什么不应该在运行时更改 django 设置？

> ID：11621903
> 
> 赞同：9
> 
> 时间：2012-07-23T23:15:29.370
> 
> 标签：django, runtime, settings, edit

django 文档明确指出

> 您不应在运行时更改应用程序中的设置。

这是[该声明的链接](https://docs.djangoproject.com/en/dev/topics/settings/#altering-settings-at-runtime)

我的问题是，为什么会这样？我想在运行时动态添加应用程序，并在运行时添加数据库，这两者都涉及编辑设置。有人可以解释为什么在运行时不编辑设置，如果存在异常，它们是哪些设置以及为什么它们是异常的？我对如何实现我的目标不是很感兴趣，而是对不应该更改设置的原因感兴趣。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-23T23:30:39.947

如果您在运行时更改它们，大多数设置将不会被重新读取。因此 Django 将无法识别您所做的更改。

这是因为 Django 只是普通的 Python 代码。它不像监控您的代码的服务器 - 它只是您的代码的一部分。

在某些情况下，部分 Django 代码可能会响应设置的更改，因为它们可能会在每次发送邮件时执行“settings.DEFAULT_FROM_EMAIL”，例如。

但是，如果 Django 以任何方式处理设置，就像它必须为 INSTALLED_APPS 所做的那样，它不会注意到您更改了某些内容并重新进行处理。

哪些设置是安全的？好吧，文档说“没有一个是安全的”，因为它将来可能会改变。Django 可能会出于某种原因保存任何设置的副本，或者进行一些处理。

更改 INSTALLED_APPS 永远不会起作用，因为它会改变导入的模块。Django 根本无法绕过 Python 在这个级别的工作方式——它需要能够“取消导入”模块，这基本上是不可能的（唯一的方法是重新启动进程），还有其他与跨应用链接相关的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:08:49.703

如果您[深入了解](https://github.com/django/django/blob/master/django/conf/__init__.py)Django 公开以与项目的设置模块接口的设置对象，您会注意到没有什么可以阻止您在运行时动态更改设置。

但是，您应该意识到，该框架的架构是围绕请求-响应流构建的，其中许多全局状态在线程之间共享以进行内存优化，前提是应用程序在初始化期间仅配置一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T00:28:08.537

AFAIK 没有关于在运行时可以安全修改哪些设置的文档，但是有一张[公开票](https://code.djangoproject.com/ticket/14628)要求更清楚地记录它们。

# c# - 如何在 MonoMac 中制作仅托盘图标的 C# 应用程序（无停靠图标）？

> ID：11621909
> 
> 赞同：13
> 
> 时间：2012-07-23T23:15:59.823
> 
> 标签：c#, macos, mono, monomac

我正在尝试创建一个只有托盘图标而不出现在任务栏中的应用程序。（类似于 Dropbox）我需要创建应用程序的 Windows 和 Mac 版本，所以我尝试使用 MonoMac 创建 Mac 前端。

在 MonoMac 中创建仅托盘应用程序的最佳方法是什么？

我发现的所有资源都说要做两件事之一：

*   添加`<key>LSUIElement</key><string>1</string>`到`Info.plist`文件中。
*   将以下代码添加到类中的`FinishedLaunching`事件中`AppDelegate`：`NSApplication.SharedApplication.ActivationPolicy = NSApplicationActivationPolicy.Accessory;`

我已经尝试了这两者的所有组合，但似乎一旦我尝试实例化 C# `System.Timers.Timer`，图标就会*重新出现*在屏幕底部的 Dock 中。我是否遗漏了有关 OSX 如何处理后台应用程序的信息？

**我究竟做错了什么？有没有更好的方法来制作一个在 OSX 中具有上部托盘图标但没有底部停靠图标的后台应用程序？**

[（这与这个SO question](https://stackoverflow.com/questions/4414629/system-tray-only-no-dock-icon-application-using-c-sharp-mono-on-mac)非常相似，但这个问题是几年前提出的，从未得到完全回答，所以我希望那里可能有更完整的答案。）

* * *

这是我到目前为止的代码：

```
public partial class AppDelegate : NSApplicationDelegate
{
    MyServiceObject currentServiceObject;

    public AppDelegate () { }

    public override void FinishedLaunching (NSObject notification)
    {
        // Construct menu that will be displayed when tray icon is clicked
        var notifyMenu = new NSMenu();
        var exitMenuItem = new NSMenuItem("Quit My Application", 
            (a,b) => { System.Environment.Exit(0); }); // Just add 'Quit' command
        notifyMenu.AddItem(exitMenuItem);

        // Display tray icon in upper-right-hand corner of the screen
        var sItem = NSStatusBar.SystemStatusBar.CreateStatusItem(30);
        sItem.Menu = notifyMenu;
        sItem.Image = NSImage.FromStream(System.IO.File.OpenRead(
            NSBundle.MainBundle.ResourcePath + @"/notify-icon.icns"));
        sItem.HighlightMode = true;

        // Remove the system tray icon from upper-right hand corner of the screen
        // (works without adjusting the LSUIElement setting in Info.plist)
        NSApplication.SharedApplication.ActivationPolicy = 
            NSApplicationActivationPolicy.Accessory;

        // Start running the program -- If I comment out then no dock icon appears
        currentServiceObject = new MyServiceObject();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T23:21:54.863

我发现了问题，它根本与应用程序设置无关。显然，MacOS 不允许“代理应用程序”执行某些操作。一旦调用其中一种方法，应用程序就会强制出现在 Dock 中。使我的应用程序绊倒的代码是对以下内容的调用：

```
System.Windows.Forms.Cursor.Position.ToString() 
```

删除该行并用以下 MonoMac 方法替换它允许应用程序保持隐藏：

```
NSEvent.CurrentMouseLocation.ToString() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-29T06:37:35.400

我可以通过在 info.plist 文件中将“Application is agent (UIElement)”键的值设置为 1 来完成这项工作。即使它应该是一个 BOOL 值，MonoDevelop 也将它变成一个字符串，但将其设置为 1 似乎可行。您还可以为“图标文件”设置一个空字符串，但这不是必需的。

![信息列表](../Images/0bdd8dd0e641984f2ab22b49b7472c02.png)

# linux - 将物理地址映射到虚拟地址linux

> ID：11621911
> 
> 赞同：9
> 
> 时间：2012-07-23T23:16:07.480
> 
> 标签：linux, linux-kernel, kernel, driver, linux-device-driver

我正在研究一个小型嵌入式系统。当我的 linux 启动到用户空间时，我知道我的设备在物理内存中的位置。我想将它们映射到用户空间虚拟地址。目前，我正在通过内核模块进行操作。我使用 vmalloc/kmalloc（取决于大小），然后在返回的虚拟地址上使用 ioremap_page_range 来映射我的物理地址。我不认为这是正确的做法。首先我正在分配内存，然后我要求内核将该虚拟地址空间重新映射到一些不同的物理地址空间。（最初在 vmcall/kmalloc 中映射的物理->虚拟有点没用，因为我不关心那些物理页面。这绝对不好。）

取而代之的是一种将已知物理内存映射到用户空间进程的更好方法。（我知道除了我的用户空间进程之外，没有人会碰那个内存。）

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T06:45:43.050

您要做的是访问所谓的**IO memory**。我只能鼓励您阅读*Linux 设备驱动程序*(LDD) 书，更具体地说是第 9 章。

要“分配”这样一个区域，您需要调用

```
struct resource *request_mem_region(unsigned long start, unsigned long len, char *name) 
```

. 在您的驱动程序可以访问它之前，您必须为其分配一个虚拟地址，这是通过调用

```
void *ioremap(unsigned long phys_addr, unsigned long size) 
```

为确保您的驱动程序将在不同的架构/平台上工作，请务必对这些区域使用一些访问器函数（ioread8/16/32 或 iowrite8/16/32 及其所有变体）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T05:22:38.270

在内核模块中，[`remap_pfn_range()`](http://lxr.free-electrons.com/source/mm/memory.c#L2330)可用于将物理地址转换为虚拟地址。以下链接会有所帮助。

[remap_pfn_range 如何将内核内存重新映射到用户空间？](https://stackoverflow.com/questions/8788289/how-remap-pfn-range-remaps-kernel-memory-to-user-space)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-14T07:22:17.987

在 Kernel 模块中， remap_pfn_range() 可用于将物理地址转换为虚拟地址。当您没有实际设备时，您可以：1）创建一个虚拟设备，2）使用这些虚拟设备的 mmap 通过该进程的 remap_pfn_range 虚拟映射访问相同的内核内存。3）通常在专用环境中，您可能还希望固定这些物理页面，以免它们从您的进程中被带走。4）您还与不同的进程共享这些物理地址，但需要通过其他 IPC 机制独立处理同步，因为每个进程看起来是不同的地址。

# ruby-on-rails - 带参数的 RSpec 自定义匹配器

> ID：11621915
> 
> 赞同：1
> 
> 时间：2012-07-23T23:16:46.620
> 
> 标签：ruby-on-rails, rspec

我正在关注 Michael Hartl 的[Rails 教程 Ch.8 练习 2](http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec%3asign_in_out_exercises)，该教程要求通过定义 RSpec 自定义匹配器将测试与实现分离。

我的定义之一是

```
RSpec::Matchers.define :have_error_message do |message|
  match do |page|
    page.should have_selector('div.alert.alert-error', text: message)
  end
end 
```

所以我可以在 RSpec 中编写以下测试

```
it { should have_error_message('Invalid') } 
```

但是，在没有如下参数的情况下调用 have_error_message 也可以。

```
it { should_not have_error_message } 
```

为什么这不会给出错误（缺少参数）？自定义匹配器中的消息变量取什么值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T00:58:54.273

该参数默认为 nil，因此它会预期一个带有 nil 文本值的错误，例如：

```
page.should have_selector('div.alert.alert-error', text: nil) 
```

# java - Java中数组初始值设定项中带有尾随逗号的数组

> ID：11621917
> 
> 赞同：24
> 
> 时间：2012-07-23T23:16:49.600
> 
> 标签：java, arrays, multidimensional-array

数组初始化器可用于在编译时初始化数组。如下所示的带有尾随逗号的初始化程序编译得很好。

```
int a[][] = {{1,2,} ,{3,4,} , {5,6,},}; //Trailing commas cause no compiler error

for(int i=0;i<a.length;i++)
{
    for(int j=0;j<2;j++)
    {
        System.out.print(a[i][j]+"\t");
    }
    System.out.println();
} 
```

输出 ：

```
1        2        
3        4        
5        6 
```

* * *

与上面的讨论一样，一维数组也是合法的。

```
int[] b = {1, 2, 3, 4, 5, 6,}; //A trailing comma causes no compiler error

for(int i=0;i<b.length;i++)
{
    System.out.print(b[i]+"\t");
} 
```

输出 ：

```
1        2        3        4        5        6 
```

* * *

甚至以下是合法的语法并且编译得很好。

```
int c[][] = {{,} ,{,} , {,},}; 
```

编译器应该在逗号之后和之前期望一个常量值（或另一个初始化器）`,`。这是如何编译的？编译器是否只是忽略了这样的逗号或在这种情况下发生了其他事情？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-23T23:19:15.763

尾随逗号被忽略。从[Java规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.6)：

> 尾随逗号可能出现在数组初始值设定项中的最后一个表达式之后并被忽略。

# ruby-on-rails - 使用 Ruby Spreadsheet gem，有没有办法让单元格适应内容的大小

> ID：11621919
> 
> 赞同：5
> 
> 时间：2012-07-23T23:17:15.463
> 
> 标签：ruby-on-rails, excel, spreadsheet

如果我使用 Ruby Spreadsheet gem 将数据从 rails 应用程序导出到 excel，有没有办法让单元格的大小（宽度和高度）自动调整到内容的大小？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T23:02:42.427

```
def autofit(worksheet)
    (0...worksheet.column_count).each do |col|
        @high = 1
        row = 0
        worksheet.column(col).each do |cell|
            w = cell==nil || cell=='' ? 1 : cell.to_s.strip.split('').count+3
            ratio = worksheet.row(row).format(col).font.size/10
            w = (w*ratio).round
            if w > @high
                @high = w
            end
            row=row+1
        end
        worksheet.column(col).width = @high
    end
    (0...worksheet.row_count).each do |row|
        @high = 1
        col = 0
        worksheet.row(row).each do |cell|
            w = worksheet.row(row).format(col).font.size+4
            if w > @high
                @high = w
            end
            col=col+1
        end
        worksheet.row(row).height = @high
    end
end 
```

此方法将遍历工作表中的每一列，然后遍历列中的每个单元格，找到字符最多的单元格（+3 表示额外的空间）并根据该单元格进行调整。然后它对行做同样的事情。这个值适用于字体大小 10，但为了确保它对于较大的字体变得更大一点，它使用以下代码调整字体大小：

```
ratio = worksheet.row(row).format(col).font.size/10
w = (w*ratio).round 
```

..它并不完美，但可以完成工作。

**更新**以包括 KevinM 的方法。两者都对我有用，但凯文的看起来也更好。原来的第 6 行是：

单元格==无 || 单元格==''？w = 1 : w == cell.to_s.strip.split('').count+3

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-17T17:37:56.853

对于未来的读者，这里是上面 CCinkosky 代码的稍微“红宝石风格”的版本。（注意：我没有费心调整列高的大小，但这可以很容易地添加。）

```
def autofit(worksheet) 
  (0...worksheet.column_count).each do |col_idx| 
    column = worksheet.column(col_idx) 
    column.width = column.each_with_index.map do |cell, row| 
      chars = cell.present? ? cell.to_s.strip.split('').count + 3 : 1 
      ratio = worksheet.row(row).format(col_idx).font.size / 10 
      (chars * ratio).round 
    end.max 
  end 
end 
```

# java - 必须有 Java 运行时环境或 Java 开发工具包才能运行 eclipse

> ID：11621926
> 
> 赞同：0
> 
> 时间：2012-07-23T23:18:00.213
> 
> 标签：java, android, eclipse

> **可能重复：**
> [Eclipse - 没有 Java (JRE) / (JDK) … 没有虚拟机](https://stackoverflow.com/questions/2030434/eclipse-no-java-jre-jdk-no-virtual-machine)

我安装了 Android SDK，它提到我也应该下载 eclipse，但是当我下载并尝试运行 eclipse.exe 时，我收到一条消息，指出“Java 运行时环境或 Java 开发工具包必须可用才能运行蚀....”。我确实有 JDK，这是安装 Android SDK 的唯一方法。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T23:51:45.313

将计算机的 PATH（环境变量）设置为 JDK 的 bin 文件夹。方法如下：Windows 7-开始->控制面板->系统和安全->系统->高级系统设置（左侧面板）->高级->环境变量（底部）。在系统变量下找到 PATH。选择它并点击编辑。将其指向 jdk 的 bin。如果这不起作用，请尝试将 JAVA_HOME 变量添加到用户变量（点击 new 而不是输入 JAVA_HOME 作为名称，并且该值再次是 bin 文件夹）。希望应该这样做。当我刚开始时，我感觉到你的痛苦同样的事情发生在我身上。

# asp.net - 使用 AntiXss 4.2 代替 AntiXss 3 是否安全

> ID：11621934
> 
> 赞同：1
> 
> 时间：2012-07-23T23:19:13.483
> 
> 标签：asp.net, antixsslibrary

我想在我的新项目中使用新的 AntiXSS 4.2，但有人[讨论](http://wpl.codeplex.com/releases/view/80289)了它在编码和删除 html 元素时的错误和激进行为。所以我不知道该怎么办？

还在使用 3.0 版还是升级到 4.2.1 版？

我自己注意到的一件事是，在以前的版本中，当我将编码文本绑定到文本框时，它会正常显示文本，但在这个新版本中，会显示代码中的文本。我必须在绑定到文本框之前解码

任何想法或建议表示赞赏。

# cakephp - Cakephp 2.0 开始抱怨 mod_rewrite

> ID：11621937
> 
> 赞同：-1
> 
> 时间：2012-07-23T23:19:16.693
> 
> 标签：cakephp

我在 linode.com 上托管的 Ubuntu 10.04、Mysql、Apache2、PHP5 上运行 Cakephp 2.0。就在两天前，当我从我的主页 www.cross-town-traffic-software.com 中单击链接到 freecite 时，我收到了来自 Cakephp 的 mod_rewrite 消息。有时我不会。我检查了我的所有日​​志，但什么也没出现。我检查了可用站点和所有 .htaccess 文件，它们都是有序的，我该如何排除故障？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T10:38:47.813

```
sudo a2enmod rewrite

sudo gedit /etc/apache2/sites-enabled/000-default 
```

检查这些行并像我在这里所做的那样进行更改：

DocumentRoot /var/www/

Options FollowSymLinks
AllowOverride all

Options FollowSymLinks
AllowOverride all
Order allow,deny allow from all

保存文件并重新启动 apache：

```
sudo /etc/init.d/apache2 restart 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-07T22:46:03.287

这很简单！cake.generic.css 包含以下内容：

```
/** Elements **/
#url-rewriting-warning {
    display:none;
} 
```

因此，当您删除该文件时，将显示#url-rewriting-warning。

干杯，弗雷德里克

# ios - ios 通过使用 iCloud 来替代推送通知，例如“查找我的 iPhone”

> ID：11621938
> 
> 赞同：1
> 
> 时间：2012-07-23T23:19:31.503
> 
> 标签：ios, push-notification, icloud, background-process

我一直在查看“查找我的 iPhone”应用程序，它似乎正在使用 iCloud 并且没有推送通知来接收有关通知的 alertView。通过在后台运行某种机制并在收到通知后提醒用户。

我想知道的是这个应用程序是苹果为这个应用程序制作的一个特殊例外，所有其他应用程序都必须做推送通知吗？或者我可以制作一个在后台运行的应用程序，就像“查找我的 iPhone”应用程序一样，并通过 iCloud 进行通信。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T00:05:37.800

Apple 使用 iCloud 来查找我的 iPhone，是的，但我相信他们这样做的原因是将其绑定到您的 iCloud 帐户，这样如果您的手机被盗，您可以在 icloud.com 上登录您的帐户以尝试跟踪它。Find My iPhone 应用程序本身通过 ping GPS 位置、保存该位置并将其与 iCloud 同步来工作。然而，对于一般开发人员使用，没有直接的 API 用于通过 iCloud 进行通信，也不太可能存在。iCloud 的主要目的是同步和备份，由于 Apple 已经提供了 Push Notification 服务，因此此时将其放入 iCloud 是没有意义的。您想要 Apple 的 Push 不允许的哪些功能？

当您的应用程序处于前台时，您可以通过多种不同方式从外部源接收数据。但是，当您的应用程序被用户或系统内存看门狗终止时，推送通知是唯一真正的途径。所以在这个阶段，集成APNS是你最好的解决方案。有一些很棒的服务可以让 APNS 集成相对轻松，例如[Urban Airship](http://urbanairship.com/)。

# php - 将 PHP Array 数据发送到 html 表

> ID：11621945
> 
> 赞同：0
> 
> 时间：2012-07-23T23:20:43.297
> 
> 标签：php, html, xml

我不是 PHP 专业人士，在以 HTML 表格格式显示一些数组数据（从 XML 文件中提取）时，我真的很想得到一些帮助。

我的数组设置如下：

```
$strTodayIs = date('l F/n');
    foreach($xml->last7days->day AS $Daily) {
        //if (date('l F/n',(int)$Daily->starttime) != $strTodayIs) {
            $intAverageLastweek += (int)$Daily->avgresponse;
            $intDowntimeLast7 += (int)$Daily->totaldowntime;
            $intUptimeLast7 += (int)$Daily->totaluptime;
            array_push($arrLastWeek, array( "starttime" => $Daily->starttime,
                                            "response" => $Daily->avgresponse,
                                            "totalup" => $Daily->totaluptime,
                                            "totaldown" => $Daily->totaldowntime
                                           ));
        //}
    } 
```

我正在尝试使用`$arrLastWeek`数组中的数据在 HTML 表中显示一些简单百分比计算的结果。

我的最终目标是根据数组中数据的计算值显示每个单元格的背景颜色，例如 100 = 绿色，100 到 99.8 = 黄色，小于 99.8 = 红色。

同样，任何帮助甚至将我指向正确的方向都将不胜感激。

如果我遗漏了任何可以帮助我解决问题的重要信息，请告诉我？

问候，

伊莱

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:32:57.917

基本上你会做这样的事情：

```
<?php foreach($array as $line): ?>
<tr><td><?php echo $line['value']; ?></td><td><?php echo $line['value2']; ?></td></tr>
<?php endforeach; ?> 
```

您可以通过在 foreach 之前将 PHP 变量设置为零，然后在 foreach 中添加它们，然后将它们输出到某处来进行数学运算。

祝你好运

# actionscript-3 - 在 MXML 中，如何在 mx:Button 的标签属性中插入换行符？

> ID：11621952
> 
> 赞同：0
> 
> 时间：2012-07-23T23:21:43.073
> 
> 标签：actionscript-3, button, attributes, mxml

在其他 MXML 组件中，您可以执行诸如使用花括号嵌入脚本、使用“ ”以及在其文本和/或标签属性中的其他类似操作。显然 mx:Buttons 的标签属性被如此锁定，以至于其他组件的正常建议不起作用。我可以尝试只在 MXML 文件的主脚本中设置标签或其他东西，但如果可以避免，那就是草率的编程（在这种情况下，标签的值将保持不变）。有没有办法在 MXML 中的属性中设置换行符？

至于使用“ ”，这至少给了我一个换行符，但是该序列右侧的任何文本都消失了。这让我觉得可能有办法让它发挥作用，但到目前为止，我还没有找到这样的方法。

谢谢！

编辑：但有一件事：我不想做任何取决于特定画布或面板或按钮实际创建的任何事情或类似的事情。在这种情况下，延迟可能会导致用户看到标签更改。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-26T14:50:12.617

好吧，这基本上是这个问题的答案：

[Adobe Flex：按钮标签中的自动换行](https://stackoverflow.com/q/1654403/279112)（线程）

[https://stackoverflow.com/a/1654948/279112](https://stackoverflow.com/a/1654948/279112)（我指的是答案）

这里唯一的问题是，尽管在他的示例中换行符和自动换行都有效，但它们在协同工作方面并没有做得那么好。这对于我目前需要做的事情来说已经足够好了，所以我稍后会改进它。感谢 danii 和 Alex 最初回答了这个问题，也感谢 Christian Nunciato 提供了这种特殊形式的答案。

# javascript - 如何检测双击是否有要投放的广告？

> ID：11621957
> 
> 赞同：-1
> 
> 时间：2012-07-23T23:22:26.023
> 
> 标签：javascript, detect, double-click

我有一个包含 8 个双击 AD 块的页面，有时给定的 AD 参数没有可以通过双击提供的广告，有没有办法检测是否提供了广告并防止进一步的双击 js 加载？

```
{% for ad in 123|make_list %}
        <div id="ad_618_50_{{ad}}">
            <script type="text/javascript">
                    document.write("<script type='text/javascript' src='http://ad-apac.doubleclick.net/Nxxx6/adj/xxx_2011/platinum;tile=1;cp={{results.doubleclick_category_id}};lp={{results.doubleclick_region_id}};kw={{results.doubleclick_category_name}};pos=box{{ad}};sz=618x50,618x110;;ord=88xxx4590xxx98461023?'><\/script>");                        
                </script>
        </div>
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:40:35.430

好的，我已经实现了一个 hack，它使用 javascript 来检测是否通过双击脚本添加了 div，如果没有，则设置一个变量标志以禁止连续双击 js 加载

```
 {% for ad in 123|make_list %}
    <div id="ad_618_50_{{ad}}">
        <script type="text/javascript">
            if (typeof platinumAds === "undefined") {
                platinumAds = true;
            }
            if (platinumAds) {
                document.write("<script type='text/javascript' src='http://ad-apac.doubleclick.net/Nxxxx/adj/xxx.co.nz_2011/platinum;tile=1;cp={{results.doubleclick_category_id}};lp={{results.doubleclick_region_id}};kw={{results.doubleclick_category_name}};pos=box{{ad}};sz=618x50,618x110;;ord=xxx3014590xxx461023?'><\/script>");
                }
            </script>

        <script type="text/javascript">
            if (!$('#ad_618_50_{{ad}} > div').size()>0){
                platinumAds = false;
            }
        </script>
    </div>
    {% endfor %} 
```

# parsing - 多语言解析器生成器

> ID：11621960
> 
> 赞同：2
> 
> 时间：2012-07-23T23:22:40.950
> 
> 标签：parsing, parser-generator

是否有一个解析器生成器可以采用单一语法并在 c# 和 javascript 中创建解析器？

我尝试过使用 ANTLR，但我还没有将它放入 Visual Studio（乏善可陈/过时的文档和包）。

最终目标是我可以管理一个语法（对于 SQL 的子集；特别是 select 语句和一些特定于我的问题域的新关键字），但生成两个解析器 (c#/javascript)。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T08:42:27.033

> 是否有一个解析器生成器可以采用单一语法并在 c# 和 javascript 中创建解析器？

我唯一知道的是ANTLR。请注意，ANTLR 不会一次性生成基于 JavaScript 和 C# 的解析器。您将不得不（至少）更改语法中的一个选项并调用`org.antlr.Tool`以为您的其他目标语言生成解析器。

> 我尝试过使用 ANTLR，但我还没有将它放入 Visual Studio

然后不要使用 Visual Studio，而是使用您最喜欢的文本编辑器（并`org.antlr.Tool`从控制台使用）或 ANTLRWorks。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-17T19:26:20.820

有[canopy](http://canopy.jcoglan.com/)，它针对来自 PEG 的 javascript、ruby、java 和 python

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-09T09:03:21.197

[docopt](http://docopt.org/)允许您在一个字符串中描述您的帮助消息，该字符串尊重一些常见的约定，这就是所有命令、选项和参数的定义方式。

Docopt 有许多官方实现：python、bash、C#、rust、ruby、C++、Go、R、Julia、Nim、Hashkell、PHP、C、F#、CoffeeScript、Swift、Scala、D、Java、Clojure、Tcl、Lua

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-09T13:35:13.890

我的 AGL 解析器构建器是用 Kotlin common 编写的，因此它可以用于任何 Kotlin 目标（JVM、JavaScript、本机代码等）。

[https://medium.com/@dr.david.h.akehurst/a-kotlin-multi-platform-parser-usable-from-a-jvm-or-javascript-59e870832a79](https://medium.com/@dr.david.h.akehurst/a-kotlin-multi-platform-parser-usable-from-a-jvm-or-javascript-59e870832a79)

不幸的是，Kotlin 还没有以 .net 为目标......但也许它会在未来出现。

# asp.net - 在本地主机上部署重定向到错误的 URL

> ID：11621964
> 
> 赞同：2
> 
> 时间：2012-07-23T23:23:01.100
> 
> 标签：asp.net, deployment, iis-7, web-deployment

我有一个从 VS 2003 迁移的 VS 2010 应用程序。运行时它运行良好

```
http//localhost:51143/default.aspx 
```

要在本地主机上部署，我`Project->Properties->Web ->use Local IIS Web Server`将项目 URL 指定为
`http//localhost/TOrders>`，然后单击“ `Create Virtual Directory`”。

然后我打开 IIS7 管理器并检查是否创建了虚拟目录。

但是，当我运行应用程序时，它开始加载

```
http//localhost/TOrders/default.aspx 
```

但随后重定向到 Intranet 站点并加载

```
http//mytsystem/default.aspx 
```

反而。

我徒劳地试图解决这个问题。

# ant - 为什么我不能引用 ant 论点？

> ID：11621965
> 
> 赞同：1
> 
> 时间：2012-07-23T23:23:15.700
> 
> 标签：ant, arguments, quoting

我正在尝试运行一个 ant 目标，指定一个带空格的参数，但它不起作用（仅使用第一个单词）。我敢肯定我以前做过很多次，没有发生任何事故。

```
ant myTarget -Dmy.property="Three Word Argument" -d 
```

将在输出中产生一行，例如

设置 ro 项目属性：my.property -> 三

这是怎么回事。在我升级到 Ubuntu 12.04 后，它*似乎*已经“坏掉”了，但这听起来不像是我的罪魁祸首......

我正在运行 ant 1.7.1，上面的 ant 命令将提供足够的输出来解决这个问题......

我试过了

*   将蚂蚁更新为`#!/bin/bash`
*   使用`Three\ Word\ Property`和各种组合...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T01:31:12.413

找到它 - 我有一个旧别名，该别名更早地出现在形式为的路径上

```
#!/bin/bash
~/development/Ant/bin/ant $@ 
```

换`~/development/Ant/bin/ant "$@"`工作。

你为什么要问这个？因为在命令行上有多个蚂蚁，所以一直引用完整路径真的很乏味（并且`ANT_HOME`超级粘到真正破坏东西的地步）。

当然，符号链接也可以工作，这就是我替换上面的内容。

# api - 对 OAuth 感到困惑

> ID：11621969
> 
> 赞同：2
> 
> 时间：2012-07-23T23:24:03.027
> 
> 标签：api, authentication, oauth

叫我新手，叫我笨蛋，给这个话题打分。随心所欲，我只是来这里问一个问题，并希望**从中学到**一些东西。

所以我今天一直在为我的网站制作一个 API（很好地尝试），并且我在 Twitter、Foursquare、Tumblr 等最流行的网站 API 上注意到了这个“东西”，称为“OAuth”。根据我今天的研究，我了解到这基本上是一种为消费者提供令牌以访问来自提供者的受限数据的方式，具体取决于用户选择的内容，而无需用户交出密码和用户名。

但是**为什么**我必须使用 OAuth，为什么我不能给消费者密钥提供一个 API 而他们只是使用它呢？然后，我将查看用户是否允许访问该应用程序，并且他们必须授予该应用程序访问权限才能从他们的帐户中获取信息，例如照片。

让我感到困惑的是为什么 Tumblr API 会同时使用这两者。它在阅读博客详细信息时接缝，他们使用简单的**api 密钥**，但在博客上发布您需要**OAuth 签名**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T09:50:51.567

OAuth 是一种协议，有一些专家组定义的一组规范来定义如何共享数据。基本上你看到的只是OAuth机制的一部分，有很多的通信和握手机制来保证用户数据的安全，同时避免未经授权的数据访问。

OAuth 机制在 2 个级别退出

1.  三足认证
2.  两足认证

两者都有其积极和消极的一面，并且有一套程序需要注意安全性和数据完整性。

仅允许基于 access_token/consumer 密钥的访问实际上是一种非常薄弱的​​安全机制，并且很容易被任何碰巧访问您的消费者密钥的人入侵，而 OAuth 系统通过共享时间限制的 access_token 来确保。

有关详细信息，请参阅此线程[oauth-2-0-benefits-and-use-cases-why](https://stackoverflow.com/questions/7561631/oauth-2-0-benefits-and-use-cases-why)

# regex - Django urls.py 中的正则表达式

> ID：11621976
> 
> 赞同：1
> 
> 时间：2012-07-23T23:24:42.363
> 
> 标签：regex, django, django-urls

请帮助我修复 urls.py 人们建议这样，但它对我不起作用.....

```
#urls.py
  (r'^/user/(?P<username>)/subject/([\w|\W]+)/$', subject),

#template
 {% for subject in subjects %}
    <li><a href="/user/{{ user.username }}/subject/{{ subject.name }}">{{ subject.name }}</a> {{ del_form.delete }}</li>
 {% endfor %}

#error
PAGE NOT FOUND
Request URL:    http://127.0.0.1:8000/user/root/subject/Math%20140
....
....
^/user/(?P<username>)/subject/([\w|\W]+)/$ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-23T23:40:14.767

您的正则表达式中有错误。如果您对此不熟悉，则应该使用正则表达式生成器：

[http://ryanswanson.com/regexp/](http://ryanswanson.com/regexp/) (Perl)

[http://www.pyregex.com/](http://www.pyregex.com/) (Python)

我想你想要这样的东西：

```
^user/(?P<username>.+)/subject/([\w|\W]+)/ 
```

但是您可能希望将 '.+' 更改为更具限制性的内容：

```
^user/(?P<username>[^/]+)/subject/([\w|\W]+)/ 
```

另请注意，由于 Django 将初始 URL 提供给 URL 调度程序的方式，您可能不想要那个前导斜杠。

# mysql - MySQL UNION 还是创建中间表？

> ID：11621980
> 
> 赞同：1
> 
> 时间：2012-07-23T23:24:57.863
> 
> 标签：mysql, union

我有两个表（MySQL，InnoDB），它们彼此相同，包含一些分数信息。我想从这两者中创建一个排行榜。与表 2 相比，表 1 中的分数具有更多的重量 (^2)。

一种策略是使用 UNION 语句编写 SQL 查询并即时获取结果，另一种策略是创建另一个表并及时将两个表中的数据插入到该表中。（例如 Cron-Job）

我的问题是这个 UNION 查询会有多贵？

```
SELECT 
    username,
    specialId,
    SUM(correct) points,
    IFNULL((SUM(foracc) / SUM(completegames)), 0) accuracy
FROM
    ((SELECT 
        u.username,
        u.specialId,
        POW(p.correct, 2) as correct,
        p.correct as foracc, #to calcuate accuracy
        p.completegames
    FROM
        Table_01 p
    LEFT JOIN users u ON u.userid = p.userid
    WHERE
        p.year = 2012 AND p.type = 1) UNION (SELECT 
        u.username,
        u.specialId,
        p.correct,
        p.correct as foracc, #to calcuate accuracy
        p.completegames
    FROM
        Table_02 p
    LEFT JOIN users u ON u.userid = p.userid
    WHERE
        p.year = 2012 AND p.type = 1)) AS Table_aggregatedscore
GROUP BY 1
ORDER BY points DESC , acc DESC
LIMIT 10; 
```

Table_01 和 Table_02 都有超过 2000 万行。

PS。我没有时间/能力对这两件事进行基准测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:36:31.037

建立第二个表。加载数据后，在原始表上添加一个触发器，以便在任一原始表中创建新记录时插入到新表中，这样您就不必运行批处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T00:26:41.400

`UNION ALL`不检查唯一行，因此可以加快查询速度。

您还可以在子选择中移动一些聚合以减少中间数据量（以防您的聚合减少行数）。

或者，您可以`LEFT JOIN`（而不是`UNION`）将两个表都放入`users`并移入, 。`POW``SUM``(SUM(Table_02.correct) + SUM(POW(Table_01.correct, 2))) AS points`

# google-maps-api-3 - 更改 Fusiontable 的地图可视化缩放级别

> ID：11621983
> 
> 赞同：0
> 
> 时间：2012-07-23T23:25:20.047
> 
> 标签：google-maps-api-3, google-fusion-tables

当我将融合表可视化为地图类型时，美国县的边界在缩放级别 1-5 时似乎是小红点，并且从缩放级别 6 开始变成多边形。有没有办法可以摆脱红点但实际上显示无论用户选择什么缩放级别，多边形？

谢谢！

[我正在使用的融合表在这里](https://www.google.com/fusiontables/DataSource?docid=0IMZAFCwR-t7jZnVzaW9udGFibGVzOjIxMDIxNw)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T01:15:17.357

这是 FusionTables 的限制。我做了[这个例子](http://www.geocodezip.com/v3_GoogleEx_layer-kml_world_countries.html)，它使用 KmlLayer 来显示不显示多边形的缩放级别，但这似乎有点傻。

# sql - SQL：解析 JSON

> ID：11621985
> 
> 赞同：1
> 
> 时间：2012-07-23T23:25:56.000
> 
> 标签：sql, arrays, json, parsing

使用 SQL，我如何从下面的 JSON 中选择“conversion_event”的值？

```
{"str":[1,1342886173,100000627571405,"offsite_conversion.lead",{"action.type":"offsite_conversion","conversion_event":387756207950188,"tag":"lead"},["conversion_event"],[],{"amount":12623486},"1:11:1:0:0:1:0"]} 
```

这里有一些不寻常的东西，例如 JSON 中的 JSON 和方括号。假设所有值的长度因行而异，因此您不能按一组字符位置进行切片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:28:53.517

根据评论：

```
declare @astr varchar(max);
declare @start int;
declare @end int;
set @astr = '{"str":[1,1342886173,100000627571405,"offsite_conversion.lead",{"action.type":"offsite_conversion","conversion_event":387756207950188,"tag":"lead"},["conversion_event"],[],{"amount":12623486},"1:11:1:0:0:1:0"]}';

select @start =  charindex('"conversion_event":',@astr)
select @end = charindex(',"tag":',@astr)

select substring(@astr,@start,@end-@start); 
```

返回

```
"conversion_event":387756207950188 
```

添加

```
set @start = @start + 19; 
```

只得到号码。

* * *

```
SELECT substring('{"str":[1,1342886173,100000627571405,"offsite_conversion.lead",{"action.type":"offsite_conversion","conversion_event":387756207950188,"tag":"lead"},["conversion_event"],[],{"amount":12623486},"1:11:1:0:0:1:0"]}',
                  101,16); 
```

或者

```
select substring('{"str":[1,1342886173,100000627571405,"offsite_conversion.lead",{"action.type":"offsite_conversion","conversion_event":387756207950188,"tag":"lead"},["conversion_event"],[],{"amount":12623486},"1:11:1:0:0:1:0"]}',
                 151,16) 
```

* * *

好的，这是对象的结构：

```
{
  "str":[1,
         1173,
         10005,
         "offsite_conversion.lead",
         {"action.type":"offsite_conversion",
          "conversion_event":387756207950188,
          "tag":"lead"},
        ["conversion_event"],
        [],
        {"amount":14486},
        "1:11:1:0:0:1:0"
]} 
```

`str`具有数组属性的对象。

第5个元素有第2个属性转换事件

第 6 个元素是一个元素的数组，它是转换事件。

所以问题是……这个结构是一样的吗？你想要哪一个？

# c# - 将业务规则放在 ASP.NET Web 应用程序的位置，存储库模式

> ID：11621986
> 
> 赞同：3
> 
> 时间：2012-07-23T23:25:56.810
> 
> 标签：c#, repository, rules

试图确定将业务规则放置在我的应用程序的位置时，我有点困惑。

我正在使用 asp.net 常规 Web 表单（不是 mvc）开发一个 Web 应用程序，最重要的是我有一个类库，其中我有用于写入数据库的存储库模式。我在存储库模式中有一个“业务层”，而且我正在编写存储过程来影响表。

例如，我应该在哪里放置强制字段验证规则？

其他示例是将外币转换为美元（我有一个汇率表，目前我在 sprocs 中进行）。

您是否建议远离存储库的规则并在我的存储库业务层中构建所有内容？或者在什么情况下，您建议在 sprocs 中构建规则和验证？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T23:39:19.027

*如果您开发的小型应用程序不使用多个数据源或没有经过广泛单元测试的业务层，并且您不打算添加服务层（例如用于缓存），则此答案是合适的。请参阅评论中的反对意见。*

如果可以，我可以建议：

1.  完全删除存储库模式。你*真的*需要支持多个数据库吗？
2.  将业务逻辑保存在业务层中，而不是数据库中。好处在于规则的本地化。您的所有域都表示为一组条件、规则、策略等。它们都位于一个地方。如果您选择将它们存储在数据库中，那么在维护代码时会给自己带来额外的麻烦。

3.  对业务层中的代码进行单元测试很容易。我不确定是否可以对 SP 进行单元测试。

4.  SP 和存储库模式不能很好地结合在一起。

货币汇率每分每秒都会发生变化，为此您应该使用可靠的 Web 服务，您可以调用该服务并获得精确的值。

**概括：**

*   远离SP
*   远离存储库模式
*   直接使用 ORM 而不是存储库模式抽象
*   不要混合持久性和业务规则
*   在单独的（可重用）程序集中分离您的业务规则

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T04:04:56.600

*   您的存储库不应该有业务层。它的唯一目的应该是充当数据库的抽象。在其中，您可以管理存储/检索应用程序数据的方式。

*   将 SP 用于不经常更改的数据库操作。永远不要将您的业务逻辑放在 SP 中。业务逻辑有随时间变化的趋势。

*   您可以创建业务对象所在的域层。您的业​​务对象应该封装自己的验证逻辑。

*   除了您的业务/域对象之外，您可能还有实用程序类（例如 CurrencyManager 或 CurrencyHelper），它们实际上使用您的业务对象来根据数据验证业务逻辑。

*   最后尝试使您的域免受任何形式的表示/视图层参考。不要在视图层应用业务验证规则或在域层显示验证逻辑。

-希望这会有所启发。

# actionscript-3 - 关闭时是否可以不刷新共享对象？

> ID：11621990
> 
> 赞同：0
> 
> 时间：2012-07-23T23:26:30.617
> 
> 标签：actionscript-3, shared-objects

我在使用 sharedObject 刷新方法时遇到问题。关闭 swf 时是否可以不刷新新数据？我的 savegame 函数是唯一调用 flush 方法的函数，它还确定了哪个数组在 sharedObject 数据中的位置。

```
parentMC.sharedObject.data.moveSpdUpgrade = parentMC.upgrades.tempMoveSpdUpgrade;
parentMC.sharedObject.flush(); 
```

但是，当我修改 tempMoveSpdUpgrade 数组时，即使尚未调用刷新，它也会将新数据保存在 sharedObject 中。

```
tempMoveSpdUpgrade[0][2] = 1;
trace(parentMC.sharedObject.data.moveSpdUpgrade); 
```

此跟踪显示数据已更改，但我不明白，因为尚未调用刷新且 swf 尚未关闭。我想知道为什么在数组中所做的修改会自动更改 sharedObject 数据。

感谢您的帮助。

编辑：

```
public function saveGame(){  
    parentMC.sharedObject.data.money = parentMC.money;  
    parentMC.sharedObject.data.moveSpdUpgrade = parentMC.upgrades.tempMoveSpdUpgrade;  
    parentMC.sharedObject.flush();  
} 
```

就像我在 hackattack 的评论中所说的那样，当我不保存但 moveSpdUpgrade 数组被修改时，钱是正确的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:34:46.080

加载到内存中的 sharedObject 中的内容和保存到磁盘中的内容是分开的。您正在跟踪内存中的 sharedObject。在您刷新此 sharedObject 之前，它可能不会将其图像保存到磁盘。尝试创建一个新的 SharedObject 并跟踪它，它应该是不同的。

**编辑：**

我看到我之前告诉你要做的事情有错误（在评论下方）。我告诉过您使用 .concat 方法创建一个新的 moveSpdUpgrade 实例以放置在您的共享对象中。这不起作用的原因是 moveSpdUpgrade 是一个二维数组，我错过了这个细节。因此调用 .concat 创建了一个新实例，但新实例仍然充满了对数组的引用，并且它是您正在编辑的那些数组。所以为了解决这个问题，我们必须做一个 moveSpdUpgrade 的深拷贝。这是一个可以实现的功能

```
function array2DConcat(target : Array) : Array {
    var buff : Array = new Array(target.length);
    for(var i : int = 0;i < target.length;i++) }
        buff[i] = target[i].concat();
    }
    return buff;
} 
```

然后如果你改变你的方法

```
public function saveGame(){  
    parentMC.sharedObject.data.money = parentMC.money;  
    parentMC.sharedObject.data.moveSpdUpgrade = array2DConcat(parentMC.upgrades.tempMoveSpdUpgrade);  
    parentMC.sharedObject.flush();  
} 
```

希望这会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:43:58.903

我认为您在数组方面遇到了一些令人困惑的事情。发生的事情永远不会通过另一个函数保存任何数据，也不会与您的其余代码有关。

**简单的方法是如何尝试复制该共享对象的数组并不会创建两个单独的对象。相反，您总是在 sharedObject-array 上实时工作。**

```
package
{
  import flash.display.Sprite;

  public class arraytester extends Sprite
  {

    private var a:Array = new Array(1,2,3,4,5);
    private var b:Array = new Array("a","b","c","d","e","f");

    public function arraytester()
    {

    // Both arrays are different Objects
        trace(a); // 1,2,3,4,5
        trace (b); //a,b,c,d,e,f

    // Both arrays are pointing to the same Object
        a= b;
        trace(a); //a,b,c,d,e,f
        trace (b); //a,b,c,d,e,f

        b[1] = 2;
        trace(a); //a,2,c,d,e,f
        trace (b); //a,2,c,d,e,f

    // a is a copy of b while becoming a seperate Object
        a = b.concat();
        b[0]= 1;
        trace(a); //a,2,c,d,e,f
        trace (b); //1,2,c,d,e,f
    }
  }
} 
```

# python - 打开第二个 Python 控制台

> ID：11621991
> 
> 赞同：1
> 
> 时间：2012-07-23T23:26:40.397
> 
> 标签：python, console

有没有办法打开第二个 python 控制台并让新控制台运行，而原始控制台继续运行，当新控制台完成时，它以变量的形式将其数据发送回原始控制台？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-28T20:03:14.927

也许您应该研究多处理或多线程模块。这些可以帮助您从原始（父）程序中生成子进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T23:40:14.643

该`sub-process`模块可能是您正在寻找的。但是，问题是，您会在整个*程序*完成*后获得该过程的输出。*这意味着，如果您尝试运行的程序永远运行，您将无法看到输出，直到它退出（通过强制它或使用终止方法）。

 *如何将输出分配给变量的示例如下：

```
output,error=your_process.communicate() 
```

这的输出部分是您将使用的（基于您的问题）。但是，如果您运行它并且出现问题（不返回 0），则会出现错误。如果您不希望捕获错误，则可以简单地将其分配给`_`.

另请注意，如果您使用关键字参数，我建议使用该`shlex`库将您的字符串拆分为参数。（您可以只使用常规字符串，例如：`var="mypythonprogram.py argument1 argument2"`并使用`arguments=shlex.split(var)`，然后您可以将其提供给子流程的参数。

如果您不需要与程序交互，另一种选择*是*使用线程，关于它们的堆栈溢出有很多问题，以及官方和互联网上其他网站上的大量文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T23:31:00.670

阅读[Python 多处理](http://docs.python.org/library/multiprocessing.html)。它具有在进程之间交换对象的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T23:32:29.293

听起来您想做类似于多处理库提供的东西。如果没有更多信息，我所能做的就是将您指向文档。

例如：

[http://www.ibm.com/developerworks/aix/library/au-multiprocessing/](http://www.ibm.com/developerworks/aix/library/au-multiprocessing/) 或 [http://docs.python.org/library/multiprocessing.html](http://docs.python.org/library/multiprocessing.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-31T09:38:16.857

如果您在 Windows 上，您可以使用 win32console 模块为您的线程或子进程输出打开第二个控制台

这是一个示例代码：

```
import win32console
import multiprocessing

def subprocess(queue):
    win32console.FreeConsole() #Frees subprocess from using main console
    win32console.AllocConsole() #Creates new console and all input and output of subprocess goes to this new console
    while True:
        print(queue.get())
        #prints any output produced by main script passed to subprocess using queue

if __name__ == "__main__":
    queue = multiprocessing.Queue()
    multiprocessing.Process(target=subprocess, args=[queue]).start()
    while True:
        print("Hello World")
        queue.put("Hello to subprocess console")
        #sends above string to subprocess which prints it into its own console

        #and whatever else you want to do in ur main process 
```

您也可以使用线程来执行此操作。如果您想要队列功能，则必须使用队列模块，因为线程模块没有队列

这是[win32console 模块文档](http://timgolden.me.uk/pywin32-docs/win32console.html)*

# ruby-on-rails-3 - 自时间戳以来的时间

> ID：11621997
> 
> 赞同：0
> 
> 时间：2012-07-23T23:27:30.590
> 
> 标签：ruby-on-rails-3

我试图找出自`created_at`时间戳被放置在我的数据库中的一篇文章以来的时间量的最佳方法。我希望它在几分钟内，然后是几小时，然后是几天。

我不知道从哪里真正开始。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:30:45.270

Rails的`distance_of_time_in_words`助手在时间上有点“模糊”，所以我和一个朋友将它重新编写成一个名为的 gem [`dotiw`](https://github.com/radar/dotiw)，它可以提供你所追求的。