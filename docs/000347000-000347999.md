# StackOverflow 问答 000347000-000347999

# python - Questions for python->scheme conversion

> ID：347010
> 
> 赞同：4
> 
> 时间：2008-12-06T23:58:08.757
> 
> 标签：python, arrays, scheme

I currently am trying to write a Python program using scheme semantics so I can later translate it into Scheme without relying on a lot of Pythonic stuff.

I'm trying solve the sliding puzzle problem (where you have 9 slots and 8 tiles arranged in a square) using a*, depth first, and breadth first search algorithm. I did this ~11 years ago in some AI class in Lisp, but basically at the time I had no idea about lisp, I hated it with all my heart, and only in retrospect do I realize I was programming "C" in Lisp. The prof didn't help in this matter.

I have a python function which can swap two tiles easily:

```
def swap(p, (r1, c1), (r2, c2)):  
    # Swaps *any* two locations and returns new configuration  
    # Does not concern itself with zero location, etc  
    # Not sure how to do this functionally  
    p_p = p[:]  
    temp = p_p[r1][c1]  
    p_p[r1][c1] = p_p[r2][c2]  
    p_p[r2][c2] = temp  
    return p_p 
```

I'd like to turn this into something you might find in SICP, avoiding side effects, etc.

But this brings up a question. Everything I read in SICP is loops via recursion. I didn't see anything in accessing arrays/vectors/lists in constant time. I can imagine a loopish/recursive way to read an element, but I find it harder to imagine a way to create a new list with a certain element changed, without invoking side-effect producing things like set!, and without resorting to crazy if/then/else clauses concerning which element should be changed. This of course gets more confusing when considering a 2d array. In this case the solution with python is obvious because of its native support for multidimensional arrays.

In C/C++/Python/Matlab/Lua/anything else, accessing lists/arrays via the [i] syntax is easy, and directly translates to a hardware-oriented pointer lookup somewhere underneath. I don't understand how scheme does this, given the atomic operations defined in the SICP version of scheme, which all seem very loop-and-search oriented. How do the vector and list array access functions work to get constant time access? (I'm a total newbie here, so I'm not ever sure what functions I'd be talking about). Is there a C or Assembly library someplace which is secretly being accessed? Are there any inherent constant-time semantics in scheme which could be used for list/array/vector access, and which would allow me a guilt-free way of using that idiom in Python for the moment?

How would can I rewrite the above function in python using Schemish semantics? How would I rewrite the above function in Scheme?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T03:25:05.843

您发现您最初的问题是尝试在 Lisp 中编写 C 语义。尝试在python中编写方案语义不是在重复错误吗？我总是尝试将语言 X 作为一种范式来学习，就像一种语言一样，并以最 X-ish 的方式写作。

如果这是您知道将要迁移的业务应用程序，这可能是合理的，但否则我只会在计划中编写它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T00:56:32.760

I wrote an 8-puzzle solver in Lisp about a year ago. I just used a list of 3 lists, each sublist with 3 elements being the numbers. It's not constant time, but it is portable.

Anyways, if you are really interested in doing this functionally (Scheme doesn't require you to) what is easiest to do is to create some helper functions that will get a specific value given row/col and 'set' a value given row/col. Instead of modifying the original data structure, the set operation will construct the new state based on the old state.

Then you can write a swap operation based on these get and set operations. Here's what I wrote about a year ago in Common Lisp, but it's easily convertible to Scheme:

```
; getval
;
; This function takes a position (r . c) where and returns the corresponding
; number in the 8-puzzle state. For example, if you wanted (1 . 2) from
; ((1 2 3) (4 5 6) (7 8 9)), the value would be 6\. The r and c values begin
; at 0.
;
; parameters:  pos    The position to get
;              state  The 8-puzzle state
; returns:     The value at pos in state
(defun getval (pos state)
  (if (null state) 'no-value
      (if (= 0 (car pos))
      (if (= 0 (cdr pos))
          (caar state)
          (getval (cons (car pos) (- (cdr pos) 1)) (list (cdar state))))
      (getval (cons (- (car pos) 1) (cdr pos)) (cdr state)))))

; setval
;
; This function returns a state where the value at pos is replaced by val.
; Like getval, this function is zero-based. Accessing beyond the size of
; the state is undefined (and probably broken)
;
; parameters:  pos    Position to set
;              val    Value to set
;              state  State to modify
; returns:     New state where pos is val
(defun setval (pos val state)
  (if (null state) '()
      (if (= 0 (car pos))
      (if (= 0 (cdr pos))
          (cons (cons val (cdar state)) (cdr state))
          (let ((temp (setval (cons (car pos) (- (cdr pos) 1)) val
                  (cons (cdar state) (cdr state)))))
        (cons (cons (caar state) (car temp)) (cdr temp))))
      (cons (car state) (setval (cons (- (car pos) 1) (cdr pos)) val (cdr state))))))

; state-swap
;
; This function takes a state and two positions and returns a new state with
; the values in those two positions swapped.
;
; parameters:  state  State to swap within
;              a      Position to swap with b
;              b      Position to swap with a
; return:      State with a swapped with b
(defun state-swap (state a b)
  (let ((olda (getval a state)) (oldb (getval b state)))
    (setval a oldb (setval b olda state)))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T23:59:49.673

这是实现它的一种方法。使用将应用适当映射的函数重新创建列表。

```
def swap(p, (r1,c1), (r2,c2)):
    def getitem(r,c):
        if (r,c) == (r1,c1): return p[r2][c2]
        elif (r,c) == (r2,c2): return p[r1][c1]
        return p[r][c]
    return [ [getitem(r,c) for c in range(len(p[0]))] for r in range(len(p)) ] 
```

您甚至可以更进一步，使函数成为实际接口，其中每个交换仅返回一个函数，该函数在传递给下面的函数之前进行适当的转换。不是特别高效，而是一种相当简单的功能方法，它省去了讨厌的可变数据结构：

```
def swap(f, (r1,c1), (r2,c2)):
    def getitem(r,c):
        if (r,c) == (r1,c1): return f(r2,c2)
        elif (r,c) == (r2,c2): return f(r1,c1)
        return f(r,c)
   return getitem

l=[ [1,2,3], [4,5,6], [7,8,0]]
f=lambda r,c: l[r][c]    # Initial accessor function
f=swap(f, (2,1), (2,2))  # 8 right
f=swap(f, (1,1), (2,1))  # 5 down
print [[f(x,y) for y in range(3)] for x in range(3)]
# Gives: [[1, 2, 3], [4, 0, 6], [7, 5, 8]] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T07:40:26.610

酷，感谢lisp代码。我需要研究它以确保我得到它。

至于第一个答案，我第一次在 lisp 中“编写 c”，因为这是我知道如何编程的唯一方法，并且不知道为什么有人会使用 lisp。这一次，我一直在玩scheme，但想使用python，所以如果我被困在某些东西上，我可以“作弊”并使用pythonish，然后在等待usenet答案的同时继续问题的下一部分.

# c++ - 通过指针访问二维（或三维）数组

> ID：347031
> 
> 赞同：1
> 
> 时间：2008-12-07T00:25:25.893
> 
> 标签：c++, c, arrays, pointers

当你有这样的数组时：

```
int foo[3][2][2]; 
```

你做：

```
int *bar = &foo[0][0][0]; 
```

这是它的工作方式吗？

```
*bar == foo[0][0][0];
*(bar+1) == foo[0][0][1];
*(bar+2) == foo[0][1][0];
*(bar+3) == foo[0][1][1];
*(bar+4) == foo[1][0][0]; 
```

我不确定并且有一些代码取决于它是否有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T00:34:38.060

是的，这称为[row major ordering](http://en.wikipedia.org/wiki/Row-major_order)，这就是 C 使用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T00:32:40.217

在大多数系统上，是的。

# web-services - 将自定义对象传递给 Web 服务

> ID：347047
> 
> 赞同：2
> 
> 时间：2008-12-07T00:39:29.110
> 
> 标签：web-services

我正在使用 C#，我有 Windows 窗体和 Web 服务...

我有一个要发送到 Web 服务的自定义对象..

有时，该对象可能包含大量数据..

作为最佳性能，将自定义对象发送到 Web 服务的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T02:03:32.093

Web 服务旨在处理自定义对象，只要它们最终分解为某些标准类型。根据发送大量数据，有[MTOM](http://en.wikipedia.org/wiki/MTOM)和较旧的[DIME](http://msdn.microsoft.com/en-us/magazine/cc188797.aspx)。如果它在 LAN 内并针对其他 .NET 客户端，您可能需要研究非 Web 服务方式，如远程处理或纯 http。

请参阅[如何：启用 Web 服务以发送和接收大量数据](http://msdn.microsoft.com/en-us/library/aa528822.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T02:54:26.110

如果您正在/计划在网络中使用 WCF（而不是 Internet），WCF 上的命名管道既快速又简单。使用原始类型传递对象。字符串 xml（虽然很冗长）或轻量级二进制对象都可以。

如果它是 wsHttp 网络服务，请使用字符串，我想不出任何其他方式可以传递自定义对象，除非服务知道它。

# asp.net - 删除空格的 asp.net 发布

> ID：347048
> 
> 赞同：2
> 
> 时间：2008-12-07T00:41:42.693
> 
> 标签：asp.net, optimization, compression

显然，在 css、aspx 和 html 页面中包含空格在设计时是一个很大的优势。但是有没有办法（一种工具可以）清除所有文件中的所有空白，并可能以更优化的方式合并 javascript 和 css 文件。

我正在使用 asp.net 主题，因此有很多单独的 css 文件可以通过某种形式的自动组合来改进。我已经看到了一些 http 模块，但这并不是我想要的，我只想在已发布的项目上运行一些东西，然后再将其发送到服务器。

编辑：不幸的是，至少在 IIS 中压缩不是一个选项，我们目前在与第三方基于 Web 的学生管理系统相同的 IIS 服务器上运行它。它不喜欢压缩，而且 IIS 选项似乎不是每个应用程序池。我确实应用了 asp.net 压缩，但我的大部分额外数据似乎是 app_themes，我知道它会很好地压缩我只是不想手动单独压缩所有 css。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T03:56:28.760

一项关于从非典型网站 (Drupal)[中删除空白的效果的实证研究表明效果很小。](http://nadeausoftware.com/articles/2007/03/don_t_use_html_white_space_removal_speed_web_site)（网站还包含一些非 .net html 空白删除工具的链接）

通过积极管理视图状态大小和使用[Blowery 的 http 压缩](http://blowery.org/httpcompress/)模块，我在页面大小方面获得了神奇的改进。

另一种策略是进行缩小（将许多 css 文件合并为一个）。Telerik 有这样一个组件[RadStyleSheetManager](http://www.telerik.com/help/aspnet-ajax/radstylesheetmanager.html)，它只适用于嵌入到程序集中的样式表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-29T18:48:52.560

还有另一种方法 [http://omari-o.blogspot.com/2009/09/aspnet-white-space-cleaning-with-no.html](http://omari-o.blogspot.com/2009/09/aspnet-white-space-cleaning-with-no.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T18:36:52.883

我认为这从未包含在 .NET 中的原因之一是因为他们希望您在这些情况下打开服务器压缩。IMO 我不同意这一点——我认为至少 aspnet_compiler.exe 不能进行这种优化是一种耻辱。在未压缩的连接上，这将是一个巨大的性能提升。无论如何，您可以在 IIS 6 上启用压缩：

[http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d52ff289-94d3-4085-bc4e-24eb4f312e0e.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d52ff289-94d3-4085-bc4e-24eb4f312e0e.mspx?mfr=true)

在 IIS7 中这样做更容易、更灵活。我希望有人有比我更好的解决方案！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T04:26:50.960

[来自 Rolla 的 4 个人](http://aspnet.4guysfromrolla.com/articles/120308-1.aspx)刚刚发表了一篇关于删除空格的 http 模块的文章。您需要集成模式下的 IIS 7 才能使其适用于 css（或者可能是带有通配符映射的 IIS6）

它看起来更像是一个概念证明，但代码是免费的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-03T03:25:15.210

我找到了这个：

[http://msdn.microsoft.com/en-us/library/aa719805(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa719805(VS.71).aspx)

问候！

# google-app-engine - 您对将 GWT 与 Appengine 结合使用有什么意见吗？

> ID：347049
> 
> 赞同：0
> 
> 时间：2008-12-07T00:42:52.177
> 
> 标签：google-app-engine, gwt

我正在寻找使用 Google 的 Web Toolkit 和 Google AppEngine 构建的应用程序的提示、建议、建议或示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T17:03:22.720

由于 Google AppEngine 现在支持使用 GWT 的 Java 变得更加容易（即您可以使用 GWT RPC）。

看看这个[截屏视频](http://www.youtube.com/watch?v=Ezm7MJeMa9M)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T18:17:35.810

这是有关该主题的截屏视频：[将 Java (GWT) 与 Google App Engine 结合使用](http://www.thescreencast.com/2008/04/using-java-gwt-with-google-app-engine.html "将 Java (GWT) 与 Google App Engine 结合使用")

但由于 GAE 使用 Python + JavaScript 而不是 Java，因此功能似乎非常有限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:19:52.537

您能否详细说明为什么将 GWT 与 Java 版本的 GAE 一起使用一定是个好主意？

我并不反对它，似乎很明显 Java 将是要走的路，但只是想听听具体的原因。

回答我自己的问题：GWT 提供了一个称为“GWT RPC”的接口，它允许您直接与 Java Servlet 对话，因此在客户端和服务器之间提供了惊人的集成水平。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T22:08:44.830

GWT 和 GAE 问题的症结在于，在使用 GAE 时，您希望使用 JDO 来持久化您的对象，而由 nucleus（JDO 实现）完成的字节码操作使您的域对象不再使用“GWT-RPC”。

今天，最好的解决方案可能是目前处于早期阶段[的 Google App Engine 的 Gilead GWT 适配器。](http://noon.gilead.free.fr/gilead/index.php?page=adapter4appengine)

# asp.net-mvc - 如何处理从视图用户控件发布表单期间发生错误的情况？

> ID：347051
> 
> 赞同：2
> 
> 时间：2008-12-07T00:45:22.063
> 
> 标签：asp.net-mvc, viewusercontrol

我有一个可以发布表单的视图用户控件。此控件可用于多个视图。如果用户输入无效数据，我会向 ModelState 添加错误 - 就这么简单。问题是我不知道要返回哪个视图/操作结果，因为我不知道用户从哪里发布表单。好的，我可以得到 urlreferer - 但这对我来说看起来不太好。任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T02:36:15.927

将信息从您的父页面传递给控制器​​。

```
<% RenderPartial("MyUserControl", new MyUserControlViewData()
{
    // pass parent page info here for user control to redirect to such as
    Controller = "Home",
    Action = "Index"

   // or even better
   ParentPath = ((WebFormView)this.ViewContext.View).ViewPath
}); 
```

# php - 我从这里去哪里——关于编程？

> ID：347054
> 
> 赞同：3
> 
> 时间：2008-12-07T00:49:52.287
> 
> 标签：php, asp.net, python, linux

我似乎正处于 Linux 的永无止境的尾旋中，无论是否是 Windows，无论是否。网络编程或系统编程。Python 或 PHP。

我正在自学编程。但似乎我一直在纠结该走哪条路。不幸的是，被跟踪似乎总是很好的理由。你知道整个开源或专有的东西。最近我在一年后决定 Linux 只是不适合我，它主要源于我想在 Channel 9 等上观看视频，以及 Linux 的笨拙。所以这导致我，“我应该学习 ASP.NET，因为我更认为 Windows 是一个“必要的”邪恶。

我希望这是有道理的。我选择 Web 开发作为我学习编程的课程的原因是因为我实际上有一个任务要实现，而不是漫无目的地阅读参考书等。

有没有人对他们可能会做些什么来保持专注，而不是让每一个切线或想法陷入困境有什么建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-07T00:58:04.627

你只会有一段时间的第一语言。选择任何你感兴趣的方向，并遵循它。没有办法绕过介绍“从消防软管喝水”体验。

保持早期项目简单、切实。建立有用的东西，就会有动力。

网络/桌面/移动/等，一切都很好。当你不编码时，找到让你思考代码的那个，你就会知道你在朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T00:58:23.473

> > 我选择 Web 开发作为我学习编程的课程的原因是因为我实际上有一个任务要实现，而不是漫无目的地阅读参考书等。

这正是要遵循的过程。我认为我们大多数人都以同样的方式进入编程领域。找到一个问题并用任何合适的技术找出解决方案。继续寻找你感兴趣的问题，你会找到你自己的答案（这可能与我自己的答案不同）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T01:03:37.330

务实的程序员的建议之一是每年学习一门新语言。可能每次都完全不同（参见[Martin Fowler](http://martinfowler.com/bliki/OneLanguage.html)对此事的看法）。

回到你的细节，你选择了编程方式，因为你喜欢它（我希望:-)）；如果您对当前环境不满意，请去改变它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T01:09:04.090

不要太担心你要去的方向，只要确保：

a) 你正在享受它，并且正在理解你在做什么。例如，您不必一开始就理解多态性之类的概念，但您应该了解您正在做的事情的基础知识。只是在一段时间后无法将您的想法围绕在 Python 中的元组和字典上？那么它可能不适合你。当然，这是一个非常低级的示例，就好像您没有字典一样，那么一般都会有问题:-)

b) 你正在做你想要解决的事情，而不仅仅是因为你认为你需要学习这个。您使用了“Windows 是必要的邪恶”这句话不，它不是。许多公司（无论大小）都不使用 .NET 平台进行开发。您使用 Linux 的方法很有趣，因为您无法在其上实现您想要的东西，而您的结果是“它很笨拙”，这似乎有点尴尬。

无论哪种方式，这都与 Linux 与 Windows 无关，但我希望这会有所帮助。随波逐流，只要你在享受和学习，就不用担心你会走什么路！:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T02:13:31.107

我发现我的一些初级同事（至少是那些对 CS 非常热情的人）提出了类似的问题（有时我发现自己也在问这个问题，即使我现在已经 12 岁以上进入这个行业了）。我给他们（以及对我自己）的一个对我有帮助的建议是——

*   专注于已经分配给您的工作。作为该任务的一部分，请确保您不只是“完成工作”，还要确保您了解其背后的基本原理。如果您想成为一名优秀的程序员，您需要了解“事物如何工作”的基本原理。使用 API 进行矩阵乘法很容易，但如果你真的不知道什么是矩阵乘法以及如何手动进行，那你实际上就输了。因此，在您选择的 Web 编程领域中，请确保您超越表面。当您单击该按钮时，了解背后真正发生的事情。

*   作为“工作”的一部分，您通常可以弄清楚您的兴趣领域是什么。如果您对事物的实现方式更有热情，并不断弄清楚，那么您就是 IMO 系统专家。如果您更热衷于找出所有新工具和新功能，并且似乎热衷于将事物组合在一起以创建更新和更酷的输出，那么您就是应用程序程序员。两者都是以自己的方式有趣的领域，正如人们在上面建议的那样，意识到你喜欢什么，看看你是否能坚持下去。

*   我喜欢上面的建议之一。如果您仍然感到困惑，请尝试执行此“旋转”操作。几乎每个领域/领域都有很多范围，因此请保持轮换（但每次轮换都有适当的时间），直到找到您喜欢的。

祝一切顺利。

:-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T02:13:51.213

感谢周到的回复

无论如何，这似乎是我学习编程的另一个分心。我花了更多时间寻找升级包等的明显修复。大多数事情已经在起作用，可以这么说，花时间重新创建轮子似乎没有多大意义。相信我，对于追逐 Linux 作为可用桌面的真正替代品的梦想是否有意义，目前还没有定论。现在请记住，前 Windows 用户总是必须将他们在 Linux 上的体验与他们之前在尝试 Windows 之前的工作方式进行比较。

只是我的两分钱

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T02:22:41.837

这是一桩乱七八糟的生意。技术流失使每个人都忙碌，想要精通自己的手艺的工人可能会在新技术的海洋中不断忙碌。但是，最终所有这些技术都在某种程度上遵循相同的模式和实践。成为基础知识专家将大大有助于推动该行业的职业发展。Pragamatic [Programmer](https://rads.stackoverflow.com/amzn/click/com/020161622X)是一个经典的指导资源。

此外，您可以或应该做什么（Windows 与 Linux）可能很大程度上取决于地理。我关注我所在地区的就业市场。花一点时间找出企业正在寻找什么以及承包商在做什么，并根据这些信息选择要学习的技术。用户组、会议和代码营也是一个很好的来源。

如果这里真正的问题是您自己构建您的第一个 Web 应用程序并且发现您在第 9 频道上看到的内容更引人注目，那么也许您应该遵循您的直觉！顺便说一句，我想你会发现到处都是“笨拙”，还不如习惯它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-07T07:20:41.437

实际上，您需要做的就是确保您迈出小步并做您喜欢的事情。

我开始在一个小游戏上使用 Visual Basic 编程。不是最好的语言，但在当时对我来说是一个很好的起点。我的观点是，你不需要从一开始就选择最好的语言/操作系统/任何东西，只需迭代。这是编程方式。

顺便说一句，仅仅因为你使用 windows 作为你的操作系统并不意味着你必须做所有我使用 windows 的 .NET，然后有一个服务器用于我所有的 web 托管，我通过 SSH 进入。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-07T07:27:35.887

我自己有一段时间也有同样的问题。我已经厌倦了只是在 PHP 中，并希望能够做更多的事情。我最终选择了 C#，因为它不仅满足了“必要的邪恶”论点，而且允许我在 MS 领域做任何我想做的事情，并且是最接近另一种语言 (Java) 的语法。

考虑所有不同类型的项目，这让我敞开心扉，让我选择了这个方向。这两种语言都可用于 Web 开发、移动设备和桌面应用程序。

# security - Restricting JMX to localhost

> ID：347056
> 
> 赞同：5
> 
> 时间：2008-12-07T00:52:43.500
> 
> 标签：security, tomcat, ssh, jmx, tunnel

While there appears to some documentation on how to expose JMX through various firewall and tunneling schemes, I sort of want the opposite. I want to ensure that JMX is only accessible to local machine. Unfortunately it appears that the "out of the box" management options do not allow restricting the ports to a local interface and netstat shows them listening on any/all interfaces.

[http://java.sun.com/javase/6/docs/technotes/guides/management/agent.html#gdevf](http://java.sun.com/javase/6/docs/technotes/guides/management/agent.html#gdevf)

I have to admit I am bewildered by the layers of indirection in JMX, the RMI registry, connectors, adapters, etc.

I would like to just turn it on and then tunnel through SSH as opposed to exposing it to the world and then having to perform arduous and superfluous user management and security configuration. It would be nice to be able to use a built in RMI registry and not have to run an external one.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-31T14:03:05.620

如果您从本地主机访问，那么在这种情况下，可以执行 JConsole 和 JVisualVM 所做的事情，即使用 Attach API 来查找服务器的仅限本地地址（如果您使用 - Dcom.sun.management.jmxremote 但不是 -Dcom.sun.management.jmxremote.port=N) 并连接到它。在另一个答案中，Thraidh 说即使在这种情况下也打开了一个可远程访问的端口，这在早期版本中是正确的，但几年来一直没有。

Fredrik 的解决方案有效，但过于矫枉过正。您只需要定义一个 RMIServerSocketFactory，而不是一个 RMISocketFactory（它定义了客户端和服务器）。这消除了专门配置客户端的需要。[http://vafer.org/blog/20061010091658](http://vafer.org/blog/20061010091658)上的代码对我来说是正确的。

使用诸如 -Dcom.sun.management.jmxremote 之类的命令行属性构建的“开箱即用”管理只能在您需要开始使用 JMX API 本身进行编程之前带您到此为止。我们通常不愿意让开箱即用的管理演变成一个完整的并行 API，这就是为什么有这样的问题是无法解决的。[我们在这里](http://java.sun.com/javase/6/docs/technotes/guides/management/agent.html#gdfvv)解释如何从一个到另一个。

Éamonn McManus，JMX 规范负责人

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T22:59:15.927

答案有点晚了，但如果对您（或其他人）来说仍然是个问题，我认为这可以解决问题：

```
import java.io.IOException;
import java.lang.management.ManagementFactory;
import java.net.*;
import java.rmi.registry.LocateRegistry;
import java.rmi.server.RMISocketFactory;

import javax.management.MBeanServer;
import javax.management.remote.*;

public class LocalJMXPort {
    public static void main(String[] args) {
        try {
            int port = 12468;
            // Create an instance of our own socket factory (see below)
            RMISocketFactory factory = new LocalHostSocketFactory();

            // Set it as default
            RMISocketFactory.setSocketFactory(factory);

            // Create our registry
            LocateRegistry.createRegistry(port);

          // Get the MBeanServer and setup a JMXConnectorServer
            MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();
            JMXServiceURL url = new JMXServiceURL("service:jmx:rmi://127.0.0.1:"+port+"/jndi/rmi://127.0.0.1:"+port+"/jmxrmi");
            JMXConnectorServer rmiServer = JMXConnectorServerFactory.newJMXConnectorServer(url, null, mbs);
            rmiServer.start();

            // Say something
            System.out.println("Connect your jconsole to localhost:"+port+". Press a key to exit");

            // Wait for a key press
            int in = System.in.read();
            //Exit
            System.out.println("Exiting");
            System.exit(0);
        } catch(Exception ex) {
            ex.printStackTrace();
        }
    }

    static private class LocalHostSocketFactory extends RMISocketFactory {
        public ServerSocket createServerSocket(int port) throws IOException {
            ServerSocket ret = new ServerSocket();
            ret.bind(new InetSocketAddress("localhost", port));
            return ret;
        }

        public Socket createSocket(String host, int port) throws IOException {
            return new Socket(host, port);
        }
    }
} 
```

我只是把它放在一起，我可能做了一些非常愚蠢的事情，因为我唯一的目标是让它绑定到 localhost:port 而不是 *:port 并且这部分似乎有效。

如果有什么可以改进或只是愚蠢的，请随时发表评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T01:39:06.993

Can't help with the sun way of doing it. Even after jmx adapters started coming with the jdk (6 i think?) I kept using mx4j for the least-effort adapter setup. It is trivial to start up an mx4j http adapter on 127.0.0.1 or an internal-only interface. Then SOP was to ssh in with port forwards or use scripts with wget commands.

[http://mx4j.sourceforge.net/](http://mx4j.sourceforge.net/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T15:40:40.230

不幸的是，目前没有办法做到这一点。

根据 Sun 文档，一个单独的 -Dcom.sun.management.jmxremote 应该只打开一个本地端口，而 -Dcom.sun.management.jmxremote.port= 打开一个可远程访问的端口。

两种方式都会打开一个额外的随机端口，可以从远程访问。

我见过 -Dcom.sun.management.jmxremote.host=，但这似乎没有任何效果。

我得出的结论是没有办法，并使用本地防火墙来屏蔽服务器。

# macos - Suggestions other than an AppleScript OSAX to create a resource bound file

> ID：347062
> 
> 赞同：1
> 
> 时间：2008-12-07T00:57:20.447
> 
> 标签：macos, applescript, macos-carbon, rsrc

I need a create a specific type of file in OS X. It needs resources in a specific way. Currently, the only way I can find to do this is in AppleScript with an OSAX. This is slow, about 1 second round trip to run, since the OSAX must open, load, do it's job, and quit. I have explored doing it in C, but that would be a last resort, as there always seems to be issues building apps out to make them work across multiple machines.

I was thinking, perhaps perl, or ideally bash could pull it off, but I am not 100% sure. The specs of what I need to do are as follows:

*   Create a text file, formatted as an email message (RFC 822/RFC 2822 format).

*   Text files must have an 'STR ' resource ID 8192 with an email address (will be used as the SMTP MAIL FROM address) and an 'STR#' resource ID 8192 with the recipient addresses (will be used as the SMTP RCPT TO addresses).

*   The text file should have CRLF as the line endings, and a 'BODY' resource ID 8192 should be added.

*   The 'BODY' resource should contain a 4 byte value, '822 ' for an unspecified body type, '7BIT' for 7-bit data, '8BIT' for 8-bit data, and 'BINM' for binary data.

Of course, the text file creation parts are simple, but stuffing those 'STR ' resources in has me stumped.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T09:23:36.587

你看过 REALbasic 吗？这使得编写这样的东西比 C 容易得多。不过，您不会免费获得它。

否则，请详细说明您可以使用哪些语言。您说的是您正在分发的应用程序-该应用程序的工作是否只是突然创建此文件？

另外，我不理解您对 C 和“构建应用程序以使它们在多台机器上工作”的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T04:21:15.463

yes, Real Basic can do this. In a nutshell, I use an oddball email server, and in order for it to take an email from the command line, I have to build a text file in a certain way, then move it to a certain folder, and the email will be delivered. The developer seems to like the resource forks, and that probably will not change.

I can currently do this with an OSAX in applescript, at the expense of only 1 message per second being created. Real Basic is going to be about the same.

As for C, I wrote a small command line app once, my first app, all it did was read the first few bytes of a file, convert some endianess values around, and return a integer. I had issues distributing it, since it would need to be built out on each platform. That is my only experience with C.

Yes, this apps job would only be to create this file. I know php really well, perl enough to get by at least reading it and editing it. Basically, I have fiddled in scripting languages for the better part of 10 years.

I imagine using this script like this: ./sendemail -f me@example.com < path/to/rfc822/email.txt

Thanks for any pointers.

# usability - 如果有的话，你应该在什么时候使用“返回顶部”链接？

> ID：347067
> 
> 赞同：3
> 
> 时间：2008-12-07T00:59:28.540
> 
> 标签：usability

我见过许多网站设计经常包含“返回顶部”链接，我只是想知道何时（如果有的话）它们真的是合理的？哪些用例需要“返回顶部”链接，它们对可用性有什么影响？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-07T01:55:44.433

作为用户，我从不使用返回顶部链接，因为这是主页键的作用，但我认为它们是有用的，因为人们有时倾向于使用滚动条。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-07T01:02:46.583

我认为当页面顶部有目录并且内容不连续时它们会很有用 - 就像常见问题解答一样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-07T01:08:20.050

只要它们不太频繁，它们在长页面上很有用，尽管超过一定大小，将页面分成更小的部分页面可能会更好。以单页 HTML5 规范为例，为什么需要这样做（大约 1MB 的原始 HTML）。

我个人喜欢[Xfce 网站](http://www.xfce.org/)的做法 - 右下角的一个箭头图标留在屏幕上，不碍事。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-04-02T18:43:10.640

从可用性的角度来看，

> **“对于超过 4 个屏幕**的页面使用返回顶部按钮。对于相对较短的页面长度，返回顶部链接是多余的——人们可以简单地向后滚动而不需要过多的努力。”

有关[Back-to-Top Button Design Guidelines](https://www.nngroup.com/articles/back-to-top/)的更多信息，请参阅 Nielsen Norman Group 的这篇文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-07T02:55:17.793

它们对残疾读者更有用。想想一个有屏幕阅读器的盲人用户正在阅读一个大页面（例如常见问题解答）。他们想在部分之间跳转，但他们没有视觉方式来跳过内容，所以链接是必要的。这种结构很常见：

*   页面顶部 - 一个链接跳转到第一个“内容”部分（通过 CSS 对大多数浏览器隐藏）
*   目录（只是一个大的链接列表）
*   对于每个部分：
    *   内容
    *   “回到顶部”内容

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-07T05:09:58.223

许多人（包括我自己）因为他们的顺序浏览风格而永远不会点击“返回顶部”链接。这种类型的用户可能正在使用搜索引擎来研究一个主题，并且在他们的搜索结果中快速从一个站点转到另一个站点。他们浏览器的后退按钮是让他们回到站点列表的关键，单击“返回顶部”链接会将他们推离列表更远。该用户很快意识到即使在长页面上也不要使用此功能。

作为一名开发人员，我从不添加“返回顶部”链接，即使在常见问题解答页面上也是如此。我将我的长页面分成几个较短的页面来完全避免这种情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T01:03:36.457

我认为当页面上的第一件事是目录时，它很有用，每个链接都将用户带到这个相当长的页面的底部。常见的例子是一个常见问题页面，所有问题都在同一页面上。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-07T02:53:01.837

限制 超过两个 1024x768 窗口或内容列表、常见问题解答等的页面的返回页首链接。关键是要让它们不碍事，但要足够可见，以便用户可以看到和使用它们。Smashing Magazine 有一篇关于此功能/主题的非常好的文章：[http ://www.smashingmagazine.com/2008/11/27/short-story-about-top-links/](http://www.smashingmagazine.com/2008/11/27/short-story-about-top-links/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-07T03:53:02.107

我想说的是，它们很有用。但取决于网站，这将取决于它们的使用方式。

在这样的网站上，在每个帖子上都有“返回顶部”按钮并不是对屏幕空间的明智使用，而是仅在网站底部（可能就在回复框上方和最底部） ）。

如果帖子长度有点长（长度的 4 倍），那么我会考虑在回复标题中使用它们，这样用户就不必搜索它们。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-07T05:12:08.187

常见问题解答、大型列表、参考资料、章节

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-07T08:20:49.087

查看[交互设计模式库](http://www.welie.com/patterns/)，以更正式地处理“to-the-top” UI 元素：

[http://www.welie.com/patterns/showPattern.php?patternID=top](http://www.welie.com/patterns/showPattern.php?patternID=top)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-08T12:16:54.693

您应该始终在界面中提供面包屑。这些可以作为返回顶部。例如。

主页 -> 私人 -> 登录 -> 帐户

这些面包屑应该易于用户访问。

# .net - How to write Unit Tests for Web Applications and Controls

> ID：347078
> 
> 赞同：1
> 
> 时间：2008-12-07T01:14:27.230
> 
> 标签：.net, unit-testing, nunit

I am just learning about Unit Testing. I am using NUnit to build tests for a VB.NET project.

The project I'm working on is part of a framework which will be used by people who build ASP.NET websites. It includes a base class (which inherits `System.Web.HttpApplication`) that users of my framework will inherit their application class from.

The project also contains a number of composite controls.

I can't quite work out at the moment how you would go about writing tests for either the application base class or any of the composite controls.

In the case of the application base class, should the Unit Test project include a class which inherits from it and then test against that?

Any pointers would be appreciated!

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T20:17:02.883

正如您所说，我将通过创建一个子类并对其进行测试来间接测试应用程序基类。

对于控件，我会使用 Selenium：[http](http://selenium.seleniumhq.org/) ://selenium.seleniumhq.org/ 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T01:52:58.980

It's no longer maintained but there is [NUnitAsp](http://nunitasp.sourceforge.net/).

```
[Test] 
public void TestExample() 
{ 
   // First, instantiate "Tester" objects: 
   LabelTester label = new LabelTester("textLabel"); 
   LinkButtonTester link = new LinkButtonTester("linkButton"); 

   // Second, visit the page being tested: 
   Browser.GetPage("http://localhost/example/example.aspx"); 

   // Third, use tester objects to test the page: 
   Assert.AreEqual("Not clicked.", label.Text); 
   link.Click(); 
   Assert.AreEqual("Clicked once.", label.Text); 
   link.Click(); 
   Assert.AreEqual("Clicked twice.", label.Text); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T03:56:38.153

这只是部分答案。[这](http://docs.djangoproject.com/en/dev/topics/testing/#module-django.test.client)就是你在 Django 中做这种事情的方式。我想在 ASP.NET 中有类似的东西。为了测试客户端代码，有[jsUnit 之](https://github.com/pivotal/jsunit)类的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-08T15:21:48.213

我可以通过为我正在单元测试的 Web 控件创建一个存根并调用受保护的 RenderContents() 方法并验证 HTML 来做到这一点：

```
[Test]
public void ConditionQueryBuilderTest_RendersProperHtml()
{
    var sw = new StringWriter();
    var queryBuilder = new ConditionQueryBuilderStub
    {
        ID = "UnitTestbuilder",
        QueryBuilderURL = @"\SomeAspxPage\SomeWebMethod",
        ResetQueryBuilderURL = @"\SomeAspxPage\OnQueryBuilderReset",
        FilterValuesCollection = new Dictionary<int, string> { {15, "Some Condition"}}
    };
    queryBuilder.RenderAllContents(new HtmlTextWriter(sw)); // This is a method in my stub that exposes RenderContents()

    AppendLog(sw.ToString());

    Assert.AreEqual(ExpectedHtml, sw.ToString());
} 
```

# php - Should I use PHP or Perl for massaging my data and storing/retrieving it with MySQL?

> ID：347085
> 
> 赞同：3
> 
> 时间：2008-12-07T01:28:43.113
> 
> 标签：php, mysql, perl

I have a desktop app that needs to send data to a MySQL Server. The app will be for internal company use, but the MySQL is on a server at a hosting company.

The data will need to be massaged a bit before being inserted and standard simple insert, delete and update.

Which should I use PHP or Perl?

I use PHP now for a variety of database driven web pages, but my current task has no need to any web rendering. (I know PHP could do this without an web-rendering too)

I have used Perl in the past (maybe 4 years ago) for a data mining task and Oracle.

What I don't know: - Can Perl work with MySQL easily? - The Perl scripts would go in cgi-bin on the webserver, correct? - Security issues with either? - Best practice in Perl for connecting to MySQL to insert data? - Where can I store the Insert, Update, Delete MySQL user name and password so it is not stolen, etc?

What would you all choose?

Thoughts are appreciated

-Jason

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-07T03:15:17.860

Perl 的[DBI](http://search.cpan.org/~timb/DBI-1.607/DBI.pm)模块非常强大，可以通过使用绑定参数轻松避免 SQL 注入攻击。有关在 SQL 语句中使用占位符的详细信息，请参阅“perldoc DBI”。保护数据库的用户名/密码可以通过普通的 Unix 文件保护来完成，方法是将凭证放在一个读保护的文件中。

DBIx [::Class](http://search.cpan.org/dist/DBIx-Class/lib/DBIx/Class.pm)和[Class::DBI](http://search.cpan.org/dist/Class-DBI/lib/Class/DBI.pm)模块提供了一种将整个数据库和关系映射到 Perl 对象的方法。它使快速遍历数据库变得非常容易，一路生成安全代码，而无需编写一行 SQL。[Class::DBI 和 DBIx::Class 的比较](http://www.perlmonks.org/?node_id=557402)可以帮助您选择哪一个；与 Perl 一样，[有不止一种方法可以做到这一点](http://en.wikipedia.org/wiki/There_is_more_than_one_way_to_do_it)。如果您正在寻找一个完整的框架，[Rose](http://rosecode.org)库提供了[Rose::DB::Object](http://search.cpan.org/dist/Rose-DB-Object)来简化访问。

您可以从命令行或在 cgi-bin 目录中运行 Perl 脚本。

[感谢[draegtun](https://stackoverflow.com/users/12195/draegtun)对其他数据库包装类的建议]

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-07T01:30:18.447

Well both can work just fine with MySQL. It's really just a preference and level of comfortability. Since you say you do quite a bit with PHP, then that might be more productive for you.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T02:03:51.937

Perl's DBI is very similar to PHP's PDO or object-oriented mysqli, but if you've never used either now might be a good time to learn one...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-07T03:23:48.390

Perl，因为 DBI 更加成熟并且拥有更多的基础设施。但是如果你确定你会坚持使用 mysql，那么来自 PHP 的“普通”绑定已经过很好的测试，并且被大多数 PHP 数据库程序员使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-07T03:59:15.247

PHP 在命令行中运行良好。如果它是你所熟悉的，更重要的是公司所熟悉的（想想谁必须在你之后维护它）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-07T04:58:32.443

如果您熟悉使用 PHP 编写 Web 应用程序，那么您已经知道如何使用它编写控制台应用程序。

唯一的区别是您输出的是纯文本而不是 HTML，以及一些包含命令行参数的新超全局变量 $argc 和 $argv。

如果您使用 PDO 或 MySQLi 类，您可以使用参数化或准备好的查询。

在任何一种语言中使用数据库可能都一样容易，因此对于您的应用程序，您必须决定的主要事情是您觉得使用哪种语言处理数据更舒服？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-18T09:48:03.623

**Perl 可以轻松地与 MySQL 一起工作吗？**

是的，LAMP 曾经是 Linux、Apache、MySQL 和 Perl。业余爱好者改用 PHP :-P。更严重的是，过去几年 PHP 已经变得更好，但是 Perl 更加成熟，所以如果你可以在不影响交付期限的情况下这样做，请使用它。

**Perl 脚本会放在网络服务器上的 cgi-bin 中，对吗？**

只要您的网络服务器可以访问和执行脚本，它就可以进入您喜欢的任何目录。cgi-bin 目录的存在只是为了将静态页面与动态页面分开。简单地说，如果你的网络服务器可以从一个目录运行 PHP，它也应该能够从那里运行 Perl。

**两者都有安全问题？**

尽量不要编写易受 SQL Injection 攻击的 SQL；不要使用旧的 PHP函数，**而是**`mysql_`使用`PDO`或`mysqli_`函数。对于 PHP 和 PERL，使用绑定变量并检查所有输入。

**Perl 中连接 MySQL 以插入数据的最佳实践？**

使用[Perl DBI](http://dbi.perl.org/)库，它非常成熟，如果与绑定变量一起使用得当，就会限制执行 SQL 注入攻击的能力。

**我在哪里可以存储插入、更新、删除 MySQL 用户名和密码，以免被盗等？**

简单地说，你不能给出绝对的保证。创建具有程序运行所需的最低权限的 MySQL 用户。即用户不应该有权删除表、删除数据库等。您可以将与数据库相关的代码放在网络服务器可访问的目录之外，以防止随意下载关键文件。

# php - Is $_SERVER[REQUEST_METHOD] manipulable?

> ID：347088
> 
> 赞同：4
> 
> 时间：2008-12-07T01:31:16.853
> 
> 标签：php, security

In a PHP project I'm developing I have a couple of requests that can be either POST or GET. Currently, I'm using the $_SERVER[REQUEST_METHOD] value to determine, which request array to use. I know that $_REQUEST values can be manipulated with cookies, is the $_SERVER superglobal vulnerable to attacks?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-07T01:44:12.053

The $_SERVER superglobal is filled by PHP with data it gets from the web server.

So unless the attacker replaces the web server with his own, or manages an extremely lucky buffer overflow against the server, you are fine.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T02:00:42.177

REQUEST_METHOD isn't limited to POST and GET though - you also need to handle HEAD (IIRC PHP will terminate the script at the first sign of output when it sees that header) and (on unlikely setups) you might get a few WebDAV ones.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-11T08:33:02.090

旧线程，但由于投票最多的答案是错误的，并且安全性是一个重要问题，所以我们开始：不仅 REQUEST_METHOD，而且 $_SERVER 中的其他值也可能被污染。

参见例如[http://www.php.net/manual/en/reserved.variables.server.php#95672](http://www.php.net/manual/en/reserved.variables.server.php#95672) 和[http://shiflett.org/blog/2006/mar/server-name-versus-http-host](http://shiflett.org/blog/2006/mar/server-name-versus-http-host)

所以不要盲目相信他们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T02:23:56.077

$_REQUEST 在什么意义上可以被 cookie “操纵”？Cookie 会覆盖来自 POST 和 GET 的值，但*所有三个值*都由发出请求的客户端直接控制。

如果您希望 GET 和 POST 优先于 cookie，您可以在 php.ini 中设置变量 request_order：

request_order = CGP

（这让`post' priority over`get' over cookie）。你甚至可以完全省略 C。

# c# - 多行工具提示文本

> ID：347092
> 
> 赞同：25
> 
> 时间：2008-12-07T01:35:39.637
> 
> 标签：c#, winforms

我试图在多行上有一个工具提示。我该怎么做呢？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-07T02:02:47.943

将换行符（使用`Environment.NewLine`）放入实际的工具提示文本中。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-24T19:18:21.937

您也可以在设计器中输入换行符*（显然仅适用于静态文本）* ，方法是单击工具提示属性框附近的下拉箭头，然后在您想要换行符的位置按 Enter。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-09T20:09:42.847

仅供参考，在 C++ 中，可以直接在静态文本中添加“\n”标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-25T00:59:51.790

为了避免将特殊字符[转义](https://en.wikipedia.org/wiki/Escape_character)为换行符，最简单的方法是使用[String.Format()](https://docs.microsoft.com/en-us/dotnet/api/system.string.format)语法在一个或多个位置插入换行符。在这种情况下，最后一个参数 {3} *Environment.NewLine*被插入到两个位置。

```
tipText = String.Format("{0:HH:mm}{3}{1:0.00}{3}{2}", ADateTime, ADouble, AString, Environment.NewLine); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-08T11:42:28.423

1-首先你需要在你的**工具提示上设置****事件**：转到你的工具提示事件，双击**绘图**

 ****注意：即使您的控件不是**文本框**，但这也适用于所有控件，因为此选项只是一种**行为**。

- 让您的活动看起来像这样：

```
 private void tooltip1_Draw(object sender, DrawToolTipEventArgs e)
    {
        e.DrawBackground();
        e.DrawBorder();
        e.DrawText(TextFormatFlags.TextBoxControl);
    } 
```

2-返回工具提示属性并将“ **OwnerDraw** ”更改为**true**。

3-现在您可以从任何地方调用您的事件，您现在可以根据需要自定义**前景色**和**背景色**，这是一个简单的提示：在此示例中：我有一个名为：“ **tooltip1** ”的工具提示和名为：“ **textbox22** ”的文本框"

```
 private void textBox22_MouseHover(object sender, EventArgs e)
    {
        tooltip1.ForeColor = Color.lime;
        tooltip1.BackColor = Color.black;
        tooltip1.Show("Path to a file\nExample:\n--check \"C:\\SomeDirectory\\Somefile.exe\"\nNB:\nWe don't check for the validity", this.textBox22);
    } 
```

**您将看到一个带有多行**文本的 semiFullcustomize 工具提示，**“\n”**相当于“ **Environment.NewLine** ”，文本应该是黑色背景上的石灰文本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-27T14:43:20.407

把它`&#xD;&#xA;`放在你想换行的地方（在设计器中）。

# regex - Perl 替换运算符的作用是什么？

> ID：347093
> 
> 赞同：13
> 
> 时间：2008-12-07T01:38:14.233
> 
> 标签：regex, perl, substitution

多年来，我一直断断续续地使用 Perl 进行编程，尽管它只是偶尔作为我的主要语言。因为我经常几个月不写任何 perl，我非常依赖我的折耳骆驼书来提醒我如何做事。然而，当我一字不差地复制食谱时，这让我很困扰。这是最令人烦恼的问题之一：在第 3 版 Camel 的第 154 页上，有一个“modifying strings *en passant* ”的示例，内容如下：

```
($lotr = $hobbit) =~ s/Bilbo/Frodo/g; 
```

Q1）这里发生了什么？正则表达式到底是在什么基础上运行的？

Q2) 对于“从 $a 中获取字符串，使用正则表达式对其进行修改，将结果放入 $b”这样的基本操作，这种近乎神奇的语法是否必要？

Q3) 如何使用循环默认变量作为初始字符串来执行此操作？

提前向 Perl 的梦想家们道歉，对于他们来说，上面的内容看起来非常自然。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-07T02:11:01.453

嗯……`($lotr=$hobbit) =~ s/Bilbo/Frodo/g`是 Perl 的众多魔法之一。现在寻求一些答案。

Q1)`$lotr`被分配了包含在 中的值`$hobbit`。赋值后，我们可以忘记源变量。将其视为`($lotr = $hobbit)`自己的声明，就好像我们写过：

```
$lotr = $hobbit;
$lotr =~ s/Bilbo/Frodo/g; 
```

反而。正则表达式正在运行`$lotr`。

Q2）语法只是上面给出的片段的单行版本。将其视为“从 复制字符串`$a`，将其复制到`$b`，并`$b`使用正则表达式进行修改”，而不是“从 获取字符串`$a`，使用正则表达式对其进行修改，将结果放入`$b`”

Q3）我假设您的意思是“循环默认变量”的默认模式搜索空间？在这种情况下，只需使用`$_`而不是`$hobbit`：

```
while (<>) {
  chomp;
  ($lotr = $_) =~ s/Bilbo/Frodo/g;
  print "\$lotr = [$lotr]\n";
  print "\$_    = [$_]\n";
} 
```

有趣的`$_`是，这个操作并没有修改魔法变量。这就是您可以得出的结论，即赋值发生*在*正则表达式替换之前，并且替换不会以任何方式在默认模式空间上进行交互。

对于有经验的 Perl 程序员来说……我不知道有多少人会被 Perl 语法所迷惑，不管他们盯着它看了多久，当然除了 Schwartz 先生 ;)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-07T02:40:12.830

不同的语言对赋值运算符做不同的事情。在某些情况下，它是一个语句，而不是一个表达式，因此不能组合成一个更大的表达式。在某些情况下，它返回分配的值，但仅作为值（通常称为右值），而不是本身可以修改或分配的东西（左值）。这方面的一个例子是 C，您可以在其中编写：

```
 a = b = c;  # assign value of c to b and a 
```

但不是：

```
 ++(b = a);  # assign value of a to b, then increment b 
```

在某些情况下，分配的结果是分配给的左值。（在 Perl 中，这仅适用于标量赋值；列表赋值是一个更复杂的野兽。）所以你可以这样做 ++($b=$a) 或 ($b=$a) =~ s/a/b/ 或任何其他需要左值的操作，它将首先进行分配，然后进一步修改分配给的左值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T03:07:58.423

如果在 Q2 中您的意思是从 $a 中获取子字符串，您可能会发现这个习语很有用：

```
($b) = $a =~ /(substring-to-match)/;
$b =~ s/regex-on-susbtring/result-string/; 
```

还要注意 $a 和 $b 在 Perl 中不是普通变量，因为它们具有与排序函数相关的特殊范围规则。有关详细信息，请参阅“perldoc perlvar”。

# c++ - 如何获得专门的模板来使用成员函数的非专门版本？

> ID：347096
> 
> 赞同：3
> 
> 时间：2008-12-07T01:43:55.923
> 
> 标签：c++, templates, specialization

考虑以下代码：

```
template <int dim>
struct vec
{
    vec normalize();
};

template <>
struct vec<3>
{
    vec cross_product(const vec& second);
    vec normalize();
};

template <int dim>
vec<dim> vec<dim>::normalize()
{
    // code to normalize vector here
    return *this;
}

int main()
{
    vec<3> direction;
    direction.normalize();
} 
```

编译此代码会产生以下错误：

> 1>main.obj：错误 LNK2019：引用了未解析的外部符号“public：struct vec<3> __thiscall vec<3>::normalize(void)”(?normalize@?$vec@$02@@QAE?AU1@XZ)在函数 _main

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-07T01:59:10.247

你不能:)你想要的是专门化成员函数：

```
template <int dim>
struct vec
{
    // leave the function undefined for everything except dim==3
    vec cross_product(const vec& second);
    vec normalize();
};

template<>
vec<3> vec<3>::cross_product(const vec& second) {
    // ...
}

template <int dim>
vec<dim> vec<dim>::normalize()
{
    // code to normalize vector here
    return *this;
} 
```

另一个稍微复杂一点的解决方案是使用`boost::enable_if`：

```
template <int dim>
struct vec
{
    // function can't be called for dim != 3\. Error at compile-time
    template<int dim1>
    typename boost::enable_if_c< dim == dim1 && dim1 == 3, vec<dim1> >::type 
    cross_product(const vec<dim1>& second) {
        // ...
    }
    vec normalize();

    // delegate to the template version
    void without_params() {
        // delegate
        this->without_params<dim>();
    }

private:
    // function can't be called for dim != 3\. Error at compile-time
    template<int dim1>
    typename boost::enable_if_c< dim == dim1 && dim1 == 3 >::type 
    without_params() {
        // ...
    }   
};

template <int dim>
vec<dim> vec<dim>::normalize()
{
    // code to normalize vector here
    return *this;
} 
```

如果为任何 dim != 3 调用 cross_product，这将导致编译时错误。请注意，“技巧”仅适用于带参数的函数，因为只有这样才能自动推导出模板参数。对于没有参数的情况，我在`without_parameters`上面提供了一个函数:)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T01:51:19.043

您没有提供 vec<3>::normalize 的定义，因此链接器显然无法链接到它。

模板专业化的全部意义在于您可以提供每种方法的专用版本。除非在这种情况下您实际上并没有这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T01:52:36.653

据我所知，你不能称之为“通用”版本。

或者，您可以将类之外的通用实现定义为函数：

```
template <int dim>
struct vec
{
};

namespace impl {
    template <int dim>
    vec<dim> normalize(const vec<dim>& v)
    {
        // code to normalize vector here
        return v;
    }
}

template <>
struct vec<3>
{
    vec cross_product(const vec& second);
    vec normalize() { return impl::normalize(*this); }
};

int main()
{
    vec<3> direction;
    direction.normalize();
} 
```

# tfs - 从 2005 年到 2008 年的 TFS 迁移？

> ID：347102
> 
> 赞同：1
> 
> 时间：2008-12-07T01:51:47.093
> 
> 标签：tfs, tfs-migration

有人知道是否可以将单独的项目从 TFS 2005 服务器迁移到 TFS 2008 服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-02T14:47:26.460

一种“粗鲁但有效”的方法可能是进行全面升级，然后在新服务器上[删除](http://msdn.microsoft.com/en-us/library/ms181482.aspx)您不想要的团队项目。

也就是说 - 您应该能够使用CodePlex 上的[TFS 到 TFS 迁移实用程序来完成大部分您想要的事情（有一些限制）。](http://www.codeplex.com/tfstotfsmigration)你可能想通读讨论——有些人对分支有一些问题——你需要确保你的映射是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T03:42:54.623

我从 2005 年升级到 2008 年的 TFS 服务器，但从未将项目从一个迁移到另一个。我可以告诉你，我的 VS2008 服务器中有使用 VS2005 的项目，它可以正常工作。

# python - 如何在 Python unittest 框架中简洁地实现多个类似的单元测试？

> ID：347109
> 
> 赞同：15
> 
> 时间：2008-12-07T01:59:49.933
> 
> 标签：python, unit-testing

我正在为一系列共享许多不变量的函数实现单元测试。例如，使用两个矩阵调用该函数会生成一个已知形状的矩阵。

我想编写单元测试来测试该属性的整个函数系列，而不必为每个函数编写单独的测试用例（特别是因为以后可能会添加更多函数）。

一种方法是遍历这些函数的列表：

```
import unittest
import numpy

from somewhere import the_functions
from somewhere.else import TheClass

class Test_the_functions(unittest.TestCase):
  def setUp(self):
    self.matrix1 = numpy.ones((5,10))
    self.matrix2 = numpy.identity(5)

  def testOutputShape(unittest.TestCase):
     """Output of functions be of a certain shape"""
     for function in all_functions:
       output = function(self.matrix1, self.matrix2)
       fail_message = "%s produces output of the wrong shape" % str(function)
       self.assertEqual(self.matrix1.shape, output.shape, fail_message)

if __name__ == "__main__":
  unittest.main() 
```

[我从Dive Into Python](http://www.diveintopython.net/unit_testing/romantest.html)得到了这个想法。在那里，它不是正在测试的函数列表，而是已知输入-输出对的列表。这种方法的问题在于，如果列表中的任何元素未通过测试，则后面的元素不会得到测试。

我查看了子类 unittest.TestCase 并以某种方式提供了要测试的特定函数作为参数，但据我所知，这阻止了我们使用 unittest.main() 因为没有办法将参数传递给测试用例。

我还查看了通过使用带有 lamdba 的 setattr 将“testSomething”函数动态附加到测试用例，但测试用例无法识别它们。

我怎样才能重写它，以便扩展测试列表仍然微不足道，同时仍然确保每个测试都运行？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-07T14:07:12.927

这是我最喜欢的“相关测试系列”的方法。我喜欢表达共同特征的 TestCase 的显式子类。

```
class MyTestF1( unittest.TestCase ):
    theFunction= staticmethod( f1 )
    def setUp(self):
        self.matrix1 = numpy.ones((5,10))
        self.matrix2 = numpy.identity(5)
    def testOutputShape( self ):
        """Output of functions be of a certain shape"""
        output = self.theFunction(self.matrix1, self.matrix2)
        fail_message = "%s produces output of the wrong shape" % (self.theFunction.__name__,)
        self.assertEqual(self.matrix1.shape, output.shape, fail_message)

class TestF2( MyTestF1 ):
    """Includes ALL of TestF1 tests, plus a new test."""
    theFunction= staticmethod( f2 )
    def testUniqueFeature( self ):
         # blah blah blah
         pass

class TestF3( MyTestF1 ):
    """Includes ALL of TestF1 tests with no additional code."""
    theFunction= staticmethod( f3 ) 
```

添加一个函数，添加一个子类`MyTestF1`。MyTestF1 的每个子类都包含 MyTestF1 中的所有测试，没有任何类型的重复代码。

独特的功能以明显的方式处理。新方法被添加到子类中。

它完全兼容`unittest.main()`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-29T14:37:07.893

您不必在这里使用*元类*。一个简单的循环就可以了。看看下面的例子：

```
import unittest

class TestCase1(unittest.TestCase):
    def check_something(self, param1):
        self.assertTrue(param1)

def _add_test(name, param1):
    def test_method(self):
        self.check_something(param1)
    setattr(TestCase1, 'test_' + name, test_method)
    test_method.__name__ = 'test_' + name

for i in range(0, 3):
    _add_test(str(i), False) 
```

一旦*for*被执行，TestCase1 就有了三个测试方法，都被[鼻子](https://pypi.org/project/nose/)和[unittest](https://docs.python.org/3/library/unittest.html)所支持。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-07T03:17:47.700

您可以使用元类来动态插入测试。这对我来说很好：

```
import unittest

class UnderTest(object):

    def f1(self, i):
        return i + 1

    def f2(self, i):
        return i + 2

class TestMeta(type):

    def __new__(cls, name, bases, attrs):
        funcs = [t for t in dir(UnderTest) if t[0] == 'f']

        def doTest(t):
            def f(slf):
                ut=UnderTest()
                getattr(ut, t)(3)
            return f

        for f in funcs:
            attrs['test_gen_' + f] = doTest(f)
        return type.__new__(cls, name, bases, attrs)

class T(unittest.TestCase):

    __metaclass__ = TestMeta

    def testOne(self):
        self.assertTrue(True)

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-17T04:05:43.293

如果您已经在使用[鼻子](https://pypi.org/project/nose/)（并且您的一些评论建议您使用），只需使用[Test Generators](http://somethingaboutorange.com/mrl/projects/nose/#test-generators)，这是我遇到的实现参数测试的最直接方法：

例如：

```
from binary_search import search1 as search

def test_binary_search():
    data = (
        (-1, 3, []),
        (-1, 3, [1]),
        (0,  1, [1]),
        (0,  1, [1, 3, 5]),
        (1,  3, [1, 3, 5]),
        (2,  5, [1, 3, 5]),
        (-1, 0, [1, 3, 5]),
        (-1, 2, [1, 3, 5]),
        (-1, 4, [1, 3, 5]),
        (-1, 6, [1, 3, 5]),
        (0,  1, [1, 3, 5, 7]),
        (1,  3, [1, 3, 5, 7]),
        (2,  5, [1, 3, 5, 7]),
        (3,  7, [1, 3, 5, 7]),
        (-1, 0, [1, 3, 5, 7]),
        (-1, 2, [1, 3, 5, 7]),
        (-1, 4, [1, 3, 5, 7]),
        (-1, 6, [1, 3, 5, 7]),
        (-1, 8, [1, 3, 5, 7]),
    )

    for result, n, ns in data:
        yield check_binary_search, result, n, ns

def check_binary_search(expected, n, ns):
    actual = search(n, ns)
    assert expected == actual 
```

产生：

```
$ nosetests -d
...................
----------------------------------------------------------------------
Ran 19 tests in 0.009s

OK 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-05-17T17:51:22.747

您可以使用一些“数据驱动测试”包：

*   *[使用任何 Python 测试框架进行参数化测试](https://github.com/wolever/nose-parameterized)*
*   [*DDT*（数据驱动测试） - 示例用法](http://ddt.readthedocs.org/en/latest/example.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-24T02:59:01.340

上一个答案中的元类代码有问题[nose ，因为在其](https://pypi.org/project/nose/)*selector.py*文件中，nose 的 wantMethod正在查看给定的测试方法`__name__`，而不是属性 dict 键。

要使用带有nose 的元类定义的测试方法，方法名称和字典键必须相同，并且前缀可以被nose 检测到（即，带有'test_'）。

```
# Test class that uses a metaclass
class TCType(type):
    def __new__(cls, name, bases, dct):
        def generate_test_method():
            def test_method(self):
                pass
            return test_method

        dct['test_method'] = generate_test_method()
        return type.__new__(cls, name, bases, dct)

class TestMetaclassed(object):
    __metaclass__ = TCType

    def test_one(self):
        pass
    def test_two(self):
        pass 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T11:43:39.270

元类是一种选择。另一种选择是使用`TestSuite`：

```
import unittest
import numpy
import funcs

# get references to functions
# only the functions and if their names start with "matrixOp"
functions_to_test = [v for k,v in funcs.__dict__ if v.func_name.startswith('matrixOp')]

# suplly an optional setup function
def setUp(self):
    self.matrix1 = numpy.ones((5,10))
    self.matrix2 = numpy.identity(5)

# create tests from functions directly and store those TestCases in a TestSuite
test_suite = unittest.TestSuite([unittest.FunctionTestCase(f, setUp=setUp) for f in functions_to_test])

if __name__ == "__main__":
unittest.main() 
```

没有测试过。但它应该可以正常工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-17T07:42:46.577

我已经阅读了元类示例，我喜欢它，但它缺少两件事：

1.  如何用数据结构驱动它？
2.  如何确保测试函数编写正确？

我写了这个更完整的例子，它是数据驱动的，并且测试函数本身是经过单元测试的。

```
import unittest

TEST_DATA = (
    (0, 1),
    (1, 2),
    (2, 3),
    (3, 5), # This intentionally written to fail
)

class Foo(object):

  def f(self, n):
    return n + 1

class FooTestBase(object):
  """Base class, defines a function which performs assertions.

  It defines a value-driven check, which is written as a typical function, and
  can be tested.
  """

  def setUp(self):
    self.obj = Foo()

  def value_driven_test(self, number, expected):
    self.assertEquals(expected, self.obj.f(number))

class FooTestBaseTest(unittest.TestCase):
  """FooTestBase has a potentially complicated, data-driven function.

  It needs to be tested.
  """
  class FooTestExample(FooTestBase, unittest.TestCase):
    def runTest(self):
      return self.value_driven_test

  def test_value_driven_test_pass(self):
    test_base = self.FooTestExample()
    test_base.setUp()
    test_base.value_driven_test(1, 2)

  def test_value_driven_test_fail(self):
    test_base = self.FooTestExample()
    test_base.setUp()
    self.assertRaises(
        AssertionError,
        test_base.value_driven_test, 1, 3)

class DynamicTestMethodGenerator(type):
  """Class responsible for generating dynamic test functions.

  It only wraps parameters for specific calls of value_driven_test.  It could
  be called a form of currying.
  """

  def __new__(cls, name, bases, dct):
    def generate_test_method(number, expected):
      def test_method(self):
        self.value_driven_test(number, expected)
      return test_method
    for number, expected in TEST_DATA:
      method_name = "testNumbers_%s_and_%s" % (number, expected)
      dct[method_name] = generate_test_method(number, expected)
    return type.__new__(cls, name, bases, dct)

class FooUnitTest(FooTestBase, unittest.TestCase):
  """Combines generated and hand-written functions."""

  __metaclass__ = DynamicTestMethodGenerator

if __name__ == '__main__':
  unittest.main() 
```

在运行上面的例子时，如果代码中存在错误（或错误的测试数据），错误消息将包含函数名称，这应该有助于调试。

```
.....F
======================================================================
FAIL: testNumbers_3_and_5 (__main__.FooUnitTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dyn_unittest.py", line 65, in test_method
    self.value_driven_test(number, expected)
  File "dyn_unittest.py", line 30, in value_driven_test
    self.assertEquals(expected, self.obj.f(number))
AssertionError: 5 != 4

----------------------------------------------------------------------
Ran 6 tests in 0.002s

FAILED (failures=1) 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-16T23:13:24.213

> 这种方法的问题在于，如果列表中的任何元素未通过测试，则后面的元素不会得到测试。

如果您从这样的角度看待它，如果测试失败，这很关键并且您的整个包无效，那么其他元素不会得到测试也没关系，因为'嘿，你有一个错误修理'。

一旦该测试通过，其他测试将运行。

诚然，可以从其他测试失败的知识中获得信息，这有助于调试，但除此之外，假设任何测试失败都是整个应用程序失败。

# validation - 如何验证 ColdFusion 表单中的整数和范围？

> ID：347111
> 
> 赞同：4
> 
> 时间：2008-12-07T02:01:11.457
> 
> 标签：validation, forms, coldfusion, input

在 CF8 表单中，我使用如下标签：

```
<cfinput 
    type = "Text" 
    name = "Num" 
    value = "0" 
    validate = "range,integer" 
    range = "0,1000" 
    validateAt="onBlur,onSubmit" 
    required = "yes" 
    message = "Invalid Value" 
> 
```

当字段失去焦点（onBlur）时，输入仅针对 validate 参数中的第一个条件进行验证（当我交换订单时它会改变）。

这是自动生成的 html / JS 代码：

```
<input 
    name="Num" 
    id="Num"
    type="text" 
    value="0" 
    onblur="if( !_CF_hasValue(this, 'TEXT', false) 
    && 
    !_CF_checkrange(this.value,0.0,1000.0, true) 
    ||
    !_CF_checkinteger(this.value, true) )
    { _CF_onErrorAlert(new Array('Invalid Value')); }" 
/> 
```

OnSubmit 使用单独的自动生成的 JS 处理并且可以正常工作。

难道我做错了什么？CF8 不支持同时验证这两个条件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T09:09:54.977

查看此创建的 JavaScript，逻辑中存在错误。

目前，它是：

```
if (!has_value && !in_range || !is_integer) show_error() 
```

但我认为它真的应该是：

```
if (!has_value || !in_range || !is_integer) show_error() 
```

由于 JavaScript 会短路逻辑表达式并`&&`优先于`||`，因此如果其他两个返回，则原始表达式中的第三个检查永远不会执行`true`。

从它的外观来看，我会暂时说这是一个错误。您是否缺少任何 CF 补丁？也许这已经解决了？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T04:22:54.993

从生成的 JS 来看，它看起来肯定是在尝试同时满足这两个验证。如果它不起作用，您可能需要在 Firebug 中调试 JS 以查看到底发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T12:55:57.143

如果范围/整数验证不起作用，您可以使用正则表达式进行验证

```
^1?\d{1,3}$ 
```

这意味着“字符串的开头，可选的 1、1-3 位数字，字符串的结尾”。

未经测试，您的里程可能会有所不同。

# c++ - 将一个 int 附加到 char*

> ID：347132
> 
> 赞同：25
> 
> 时间：2008-12-07T02:30:54.987
> 
> 标签：c++, integer, char, append

您如何将整数附加到`char*`c++ 中的 a ？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-07T02:40:46.417

首先将 int 转换为`char*`using `sprintf()`：

```
char integer_string[32];
int integer = 1234;

sprintf(integer_string, "%d", integer); 
```

然后将其附加到您的其他 char*，请使用`strcat()`：

```
char other_string[64] = "Integer: "; // make sure you allocate enough space to append the other string

strcat(other_string, integer_string); // other_string now contains "Integer: 1234" 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-07T02:45:29.730

您也可以使用字符串流。

```
char *theString = "Some string";
int theInt = 5;
stringstream ss;
ss << theString << theInt; 
```

然后可以使用该字符串访问`ss.str();`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-07T02:50:26.460

就像是：

```
width = floor(log10(num))+1;
result = malloc(strlen(str)+len));
sprintf(result, "%s%*d", str, width, num); 
```

您可以通过使用系统上整数的最大长度来简化 len。

*编辑*哎呀 - 没有看到“++”。尽管如此，它仍然是一个替代方案。

# version-control - 存储库中的项目文件

> ID：347142
> 
> 赞同：4
> 
> 时间：2008-12-07T02:44:40.247
> 
> 标签：version-control

将项目文件（即源代码文件以外的文件）保存在版本控制存储库中是否常见做法？

另外，这些文件是否定期签入/签出？

我一直认为 SCC 存储库是“干净的”，只有源代码文件。

您如何管理存储库中的非源代码文件？

以 Visual Studio 解决方案为例。您是将整个解决方案的目录“签入”到 SCCS 还是只添加源代码文件？当需要构建解决方案时，是否需要检查整个解决方案呢？也许最好通过手动过程完成？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-07T02:50:44.667

我认为一般的经验法则是应该包括使项目编译和运行所需的最少数据量。这包括艺术（或其他基本数据文件）和任何构建脚本。对于 autotools 项目，这通常意味着 configure.ac。在 Visual Studio 项目中，它表示 Visual Studio 项目文件。但是您不会包含任何可以从其余部分自动生成的内容，例如“配置”脚本，如果 configure.ac 已经存在的话。

CVS 和 Subversion 都有用于添加二进制文件的标志（Subversion 会自动添加它），这对于图像和项目文件（无论如何都是二进制文件）非常有用。Subversion 还允许文件锁定，这对于不想破坏彼此作品的艺术家来说非常有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T03:12:13.623

可以从存储库中的其他文件生成的任何内容本身不应存储在存储库中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T02:55:14.827

您应该在存储库中保留构建项目所需的一切。

因此需要保留源代码，还需要保留帮助文件、文档、图形、许可证等内容。

最终产品不需要存储，因为它是从源头重建的。

此外，也不应存储带有密码和登录名的配置文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T03:27:08.523

是的你应该！您应该包含其他开发人员在 IDE 中快速设置项目所需的所有文件，包括您自己以在您碰巧弄乱本地项目配置时快速恢复项目。

我主要从事网络开发。有一些项目资源文件，例如 Photoshop .PSD 文件，用于开发，并以某种方式导出到其他文件中以投入生产。您可能希望将它们保存在单独的文件夹或存储库中。不主要关心这些文件的项目成员，无论如何很少有人更新和维护它们，他们可以选择忽略这些资源并且没有本地副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T02:54:59.977

通常，作为构建的一部分重新构建的任何内容都不会签入存储库。否则在提交生成的文件时会出现合并冲突，尤其是当它们是二进制文件或包含绝对路径时。

正如 Sydius 所提到的，大多数 SCM 工具都有将非源文件标记为二进制文件的方法。大多数现代工具会自动检测非纯文本文件，对于 CVS，它是：

```
cvs add -kb filenames 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T03:16:12.650

我最喜欢的项目之一是一个适用于 Windows、Mac OSX 和 Linux 的小型跨平台应用程序。我使用 wxWidgets 作为框架，在 Linux 上使用 Kdevelop，在 Mac OSX 上使用 XCode，在 Windows 上使用 Dev-Cpp 作为 IDE。每个 IDE 的项目文件都可以使用 CVS 和 SVN 完美管理。我将项目文件保存在 repo 中。每当我必须在任何目标平台上重建开发环境时，我所要做的就是安装 IDE 并检查最新的 CVS。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T03:27:49.973

您需要将已编译二进制文件的历史记录保存为单独的存档。如果您在服务器上进行更新并且它不起作用，则需要回滚。如果您从存档的二进制副本中执行此操作会更好。我认为有一些二进制版本控制的例程是个好主意。但它们不应该存储在 SVN 或类似的目录下。SCC 系统最有用的是，它们不是用于备份目的，而是用于回滚并跟踪存储文档中的更改集。这对二进制文件没有意义。

# database - 用于读取数据库模式的外部库或迷你语言？

> ID：347155
> 
> 赞同：2
> 
> 时间：2008-12-07T02:56:23.763
> 
> 标签：database, schema, mini-language

我正在考虑为我的妻子编写一个简单的数据库应用程序，但我对良好的编程实践很感兴趣，并且希望有一个人类可读的源代码来存储数据库模式。

只是，我不知道任何用于这项工作的工具，而且我不敢相信它们不存在——可能我只是不知道该问谷歌什么，但我没有找到它们。

那么，有哪些库或其他工具支持从纯文本文件中读取数据库模式。

* * *

对于 invenetix 的问题：我希望在构建时生成数据库创建代码，或者在版本中包含模式描述，并在运行时从描述中构建数据库。Draemon 的建议很好，但如果我能提供帮助，我不想被锁定在预先确定的 RDBMS 中。

或许我应该说我以前在编程项目中使用过数据库，但从未负责创建代码。

可能我在这一点上过度设计了这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T03:09:52.787

只需使用 SQL。SQL 不仅是一种查询语言，而且是一种 DDL（数据定义语言）。例如，如果您使用的是 mysql；您可以根据需要设计您的架构，运行 mysqldump 它将创建一个带有 DDL 语句的 SQL 文件。整理架构，然后您可以随时通过获取 SQL 文件来加载架构。就个人而言，我只是在文本编辑器中编写 SQL 模式并将其加载到 mysql 中。

这适用于 mysql、postgresql、oracle 和可能的任何其他数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T04:46:35.603

我想我现在明白了一点。

尽管市场上的每个 SQL 解决方案都应遵守某种程度的 ANSI SQL 标准合规性，但它们都将提供某种自定义数据类型，这些数据类型可能无法在另一个 SQL 服务器解决方案中共享/使用/识别。

例如，在 MySQL 4 中，您可以使用很多选择（DATE、DATETIME、TIME、YEAR 和 TIMESTAMP），而在 MS SQL 2000 中，您只有几个（DATETIME 或 SMALLDATETIME）。您必须确保最终生成的架构在您愿意支持的解决方案之间是通用的。

[MySQL 数据类型](http://dev.mysql.com/doc/refman/5.1/en/data-types.html)

[MS SQL 2000 数据类型](http://msdn.microsoft.com/en-us/library/aa258271.aspx)

这有帮助吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T05:26:41.917

SQLite 不会以文本格式保存其数据，但它可能会做你喜欢的事情。

它非常适合嵌入式数据库 - 没有服务器，没有设置，并且数据库位于可由您的应用程序管理的单个文件中。

[http://www.sqlite.org/](http://www.sqlite.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-05T17:05:50.633

您可能想查看[http://www.codesmithtools.com/](http://www.codesmithtools.com/)。该工具旨在读取数据库的架构并允许您基于该架构创建代码模板。它有一个用于访问模式数据的抽象库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T04:05:32.643

我还不能发表评论，但如果我理解这一点，您是否希望应用程序或库根据文本文件中提供的数据构建模式？

您能否提供一个您想要完成的示例工作流程？您遇到问题的步骤是哪一步？

# c# - 你将单元测试放在同一个项目还是另一个项目中？

> ID：347156
> 
> 赞同：155
> 
> 时间：2008-12-07T02:56:36.697
> 
> 标签：c#, unit-testing

您是为了方便将单元测试放在同一个项目中，还是将它们放在单独的程序集中？

如果您像我们一样将它们放在一个单独的组件中，我们最终会在解决方案中产生许多额外的项目。它非常适合在编码时进行单元测试，但是如何在没有所有这些额外程序集的情况下发布应用程序？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2008-12-07T09:00:25.463

单独的项目，但在同一个解决方案中。（我曾为测试和生产代码使用单独的解决方案开发产品——这太可怕了。你总是在两者之间切换。）

单独项目的原因如其他人所述。请注意，如果您使用的是数据驱动的测试，那么如果您将测试包含在生产程序集中，最终可能会出现相当大的膨胀。

如果您需要访问生产代码的内部成员，请使用[InternalsVisibleTo](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)。

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2008-12-07T03:20:26.947

在我看来，单元测试应该放在与生产代码不同的程序集中。以下是将单元测试放在与生产代码相同的一个或多个程序集中的一些缺点：

1.  单元测试随生产代码一起提供。产品代码附带的唯一内容是生产代码。
2.  单元测试会使程序集不必要地膨胀。
3.  单元测试会影响构建过程，例如自动化或连续构建。

我真的不知道有什么高手。拥有一个额外的项目（或 10 个）并不是一个骗局。

**编辑：有关构建和运输的更多信息**

我会进一步建议任何自动化构建过程将生产和单元测试放在不同的位置。理想情况下，单元测试构建过程仅在生产代码构建时运行，并将产品文件复制到单元测试目录中。这样做会导致实际位被分开以进行运输等。此外，此时在特定目录中的所有测试上运行自动化单元测试是相当简单的。

总而言之，以下是每日构建、测试和传送位和其他文件的总体思路：

1.  生产构建运行，将生产文件放入特定的“生产”目录。
    1.  仅构建生产项目。
    2.  将编译的位和其他文件复制到“生产”目录中。
    3.  将位和其他文件复制到发布候选目录，也就是圣诞节发布目录将是“Release20081225”。
2.  如果生产构建成功，则单元测试构建运行。
    1.  将生产代码复制到“测试”目录。
    2.  将单元测试构建到“测试”目录。
    3.  运行单元测试。
3.  向开发人员发送构建通知和单元测试结果。
4.  当一个候选版本（如 Release20081225）被接受时，发送这些位。

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2009-02-16T21:58:33.117

我不理解经常反对使用生产代码部署测试。我领导了一个小型微型公司的团队（从 14 人增加到 130 人）。我们有六个左右的 Java 应用程序，我们发现将测试部署到现场以在*特定的应用程序上执行它们非常有价值*表现出异常行为的机器。随机问题发生在现场，能够以零成本进行数千个单元测试是非常宝贵的，并且经常在几分钟内诊断出问题......包括安装问题、不稳定的 RAM 问题、特定于机器的问题、不稳定的网络问题，等等，等等。我认为在现场进行测试是非常有价值的。此外，随机问题会在随机时间弹出，很高兴让单元测试已经坐在那里等待立即执行。硬盘空间便宜。就像我们试图将数据和函数保持在一起（OO 设计）一样，我认为将代码和测试保持在一起（函数 + 验证函数的测试）具有根本价值。

我想将我的测试放在 C#/.NET/Visual Studio 2008 中的同一个项目中，但我还没有研究到足以实现它。

将 Foo.cs 与 FooTest.cs 放在同一个项目中的一大好处是，当一个类缺少同级测试时，开发人员会不断得到提醒！这鼓励了更好的测试驱动编码实践......漏洞更加明显。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2019-06-18T09:35:10.077

在 TypeScript 项目中花了一些时间之后，测试通常与他们正在测试的代码一起放在一个文件中，我越来越喜欢这种方法而不是将它们分开：

*   导航到测试文件会更快。
*   当您重命名被测试的类时，更容易记住重命名测试。
*   移动正在测试的类时更容易记住移动测试。
*   如果一个类缺少测试，那是很明显的。
*   您不需要管理两个重复的文件结构，一个用于测试，一个用于代码。

因此，当我最近开始一个新的 .NET Core 项目时，我想看看是否可以在 C# 项目中模仿这种结构，而无需在最终版本中发布测试或测试程序集。

到目前为止，将以下几行放入项目文件中似乎运行良好：

```
 <ItemGroup Condition="'$(Configuration)' == 'Release'">
    <Compile Remove="**\*.Tests.cs" />
  </ItemGroup>
  <ItemGroup Condition="'$(Configuration)' != 'Release'">
    <PackageReference Include="nunit" Version="3.11.0" />
    <PackageReference Include="NUnit3TestAdapter" Version="3.12.0" />
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="15.9.0" />
  </ItemGroup> 
```

以上确保了`Release`配置中所有命名的文件`*.Tests.cs`都被排除在编译之外，并且还删除了所需的单元测试包引用。

如果您仍然希望能够在它们的发布配置中对类进行单元测试，您可以创建一个新的配置，从`Release`名为`ReleaseContainingTests`.

* * *

**更新：**使用此技术一段时间后，我还发现在 VS Code 中自定义图标以使测试（和其他内容）在资源管理器窗格中更加突出：

[![VS 代码截图](https://i.stack.imgur.com/w6PgD.png)](https://i.stack.imgur.com/w6PgD.png)

为此，请使用 Material Icon Theme 扩展并将以下内容添加到您的 VS Code 首选项 JSON 中：

```
"material-icon-theme.files.associations": {
  "*.Tests.cs": "test-jsx",
  "*.Mocks.cs": "merlin",
  "*.Interface.cs": "Raml",
} 
```

* * *

**更新 2：**

如果您收到错误`Program has more than one entry point defined`，那么您可以按照[此处](https://andrewlock.net/fixing-the-error-program-has-more-than-one-entry-point-defined-for-console-apps-containing-xunit-tests/)的说明进行操作，这基本上是在项目文件`<GenerateProgramFile>false</GenerateProgramFile>`的`<PropertyGroup>`元素中添加`.csproj`，这将阻止测试框架添加自己的入口点。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2011-06-23T13:52:00.680

将单元测试与代码放在同一个项目中，以实现更好的封装。

您可以轻松地测试内部方法，这意味着您不会公开应该是内部的方法。

此外，让单元测试接近您正在编写的代码也非常好。当你编写一个方法时，你可以很容易地找到相应的单元测试，因为它在同一个项目中。当您构建一个包含 unitTests 的程序集时，unitTest 中的任何错误都会给您一个编译器错误，因此您必须使您的 unittest 保持最新，以便构建。在单独的项目中进行单元测试，可能会导致一些开发人员忘记构建单元测试项目，并暂时错过损坏的测试。

您可以使用编译标签 (IF #Debug) 从生产代码中删除单元测试。

自动集成测试（由 NUnit 制作）应该在一个单独的项目中，因为它们不属于任何单个项目。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-12-07T03:56:26.810

我的单元测试总是放在一个单独的项目中。事实上，对于我的解决方案中的每个项目，都有一个单独的测试项目与之配套。测试代码不是应用程序代码，不应与它混合。将它们保存在单独的项目中的一个优点——至少使用 TestDriven.Net——是我可以右键单击一个测试项目并运行该项目中的所有测试，一键测试整个应用程序代码库。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2014-08-01T08:54:58.837

如果使用[NUnit](http://nunit.org)框架，还有一个额外的理由将测试放在同一个项目中。考虑以下与单元测试混合的生产代码示例：

```
public static class Ext
{
     [TestCase(1.1, Result = 1)]
     [TestCase(0.9, Result = 1)]
     public static int ToRoundedInt(this double d)
     {
         return (int) Math.Round(d);
     }
} 
```

这里的单元测试用作被测试代码的文档和规范。我不知道如何实现这种自我记录的效果，测试位于一个单独的项目中。该函数的用户必须搜索测试才能看到那些测试用例，这是不太可能的。

**更新**：我知道`TestCase`属性的这种用法不是 NUnit 的开发人员有意的，但为什么不呢？

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-07T09:11:14.337

我在同一个项目和不同项目之间波动。

如果你发布一个库，发布测试代码和生产代码是一个问题，否则我发现它通常不是（尽管在你尝试之前有很强的心理障碍）。

当将测试放在同一个项目中时，我发现在测试和它们测试的代码之间切换更容易，并且更容易重构/移动它们。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-07T13:01:09.177

我把它们放在不同的项目中。作为我们的一般规则，程序集的名称反映了命名空间的名称。因此，如果有一个名为 Company.Product.Feature.sln 的项目，它就有一个 Company.Product.Feature.dll 的输出（程序集名称）。测试项目是 Company.Product.Feature.Tests.sln，产生 Company.Product.Feature.Tests.dll。

您最好将它们保存在一个解决方案中，并通过配置管理器控制输出。我们为每个主要分支（开发、集成、生产）都有一个命名配置，以代替使用默认的调试和发布。设置好配置后，您可以通过单击配置管理器中的“构建”复选框来包含或排除它们。（要获取配置管理器，请右键单击解决方案并转到配置管理器。）请注意，我发现 Visual Studio 中的 CM 有时有问题。有几次，我不得不进入项目和/或解决方案文件来清理它创建的目标。

此外，如果您使用的是 Team Build（并且我确信其他 .NET 构建工具是相同的），那么您可以将构建与命名配置相关联。这意味着，如果您不为“生产”构建构建单元测试，例如，构建项目也可以知道此设置并且不构建它们，因为它们被标记为这样。

此外，我们过去常常在构建机器上执行 XCopy。该脚本将忽略从部署中复制任何名为 *.Tests.Dll 的内容。这很简单，但很有效。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-05-21T17:22:31.403

我知道这是一个非常古老的问题，但我想补充一下我的经验，我最近将单元测试习惯从单独的项目更改为同一个项目。

为什么？

首先，我非常倾向于保持主项目文件夹结构与测试项目相同。因此，如果我有一个文件，`Providers > DataProvider > SqlDataProvider.cs`那么我将在我的单元测试项目中创建相同的结构，例如`Providers > DataProvider > SqlDataProvider.Tests.cs`

但是随着项目越来越大，一旦你将文件从一个文件夹移动到另一个文件夹，或者从一个项目移动到另一个，那么将它们与单元测试项目同步变得非常繁琐。

其次，从要测试的类导航到单元测试类并不总是很容易。这对 JavaScript 和 Python 来说更难。

最近，我开始练习，我创建的每个文件（例如`SqlDataProvider.cs`）我都在创建另一个带有 Test 后缀的文件，比如`SqlDataProvider.Tests.cs`

一开始它似乎会膨胀文件和库引用，但从长远来看，你会一眼就消除移动文件综合症，而且你会确保每个被测试的候选文件都有一个配对文件带`.Tests`后缀。它使您可以轻松跳入测试文件（因为它是并排的），而不是查看单独的项目。

您甚至可以编写业务规则来扫描项目并识别没有 .Tests 文件的类，并将它们报告给所有者。您还可以轻松地告诉您的测试运行程序以定位`.Tests`类。

特别是对于 Js 和 Python，您不需要从不同的路径导入引用，您可以简单地使用被测试目标文件的相同路径。

我使用这种做法有一段时间了，我认为对于项目的新手来说，在项目规模与可维护性和学习曲线之间进行权衡是非常合理的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-09-26T21:21:29.953

我会说让他们分开。

除了提到的其他原因之外，将代码和测试放在一起会扭曲测试覆盖率。当您报告单元测试覆盖率时 - 报告的覆盖率更高，因为在您运行单元测试时会覆盖测试。当您报告集成测试覆盖率时，报告的覆盖率较低，因为集成测试不会运行单元测试。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-11-06T16:49:52.667

我真的受到Robert Lopez的[Flood NN 库的单元测试框架的启发。](http://www.cimne.com/flood/)它为每个单元测试类使用不同的项目，并且有一个包含所有这些项目的解决方案，以及一个编译和运行所有测试的主项目。

整洁的事情也是项目的布局。源文件在一个文件夹中，但是 VS 项目的文件夹在下面。这允许您为不同的编译器创建不同的子文件夹。所有 VS 项目都附带代码，因此任何人都可以轻松运行任何或所有单元测试。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-11-11T20:40:32.050

正如其他人所回答的那样 -**将测试放在单独的项目中**

没有提到的一件事是，`nunit3-console.exe`除了文件之外，您实际上无法运行任何东西`.dll`。

如果您计划通过 TeamCity 运行测试，这将带来问题。

假设您有一个控制台应用程序项目。编译时，它会将可执行文件返回`.exe`到`bin`文件夹。

从`nunit3-console.exe`那里您将无法运行该控制台应用程序中定义的任何测试。

换句话说，控制台应用程序返回`exe`文件，类库返回`dll`文件。

我今天刚被这个咬了，很烂:(

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-07-01T15:26:18.710

我最近一直在 docker 中进行部署。当 Dockerfile 可以轻松复制 /src 目录并离开 /test 目录时，我看不到拥有单独项目的价值。但我是 dotnet 的新手，可能会遗漏一些东西。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-02-13T15:30:16.810

将单元测试代码运送到生产环境的另一个缺点是我们正在运送有关***如何***实际使用该代码的知识。这可能很糟糕，因为攻击者在成功反编译单元测试后将更容易理解业务逻辑。这可能真的很有害。例如，您的代码可能包含特殊逻辑来处理州和国家之间税收的特殊性。然后，这些知识很容易被攻击者窃取，他们有可能将其出售给同一地区的其他玩家……只需在生产中复制代码即可。根据我的经验，几乎没有 .NET 中的代码在生产中被正确混淆。有许多工具可以很容易地以非常易懂的形式反编译代码。

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2021-02-02T23:26:38.380

> 您是为了方便将单元测试放在同一个项目中，还是将它们放在单独的程序集中？

**不，永远，永远不要那样做**。您的组件的使用者无法将您的测试代码与您的生产代码分开，因此，他们不能将它用于任何重要的事情。

从具有安全意识的消费者的角度来看，组件中的每个公共符号都是客户产品的攻击面区域的一部分。他们为什么要使用包含*任何*非生产安全表面区域的组件？

**如果您认为在生产装配中包含单元测试是可以的，您会感到羞耻！**

如果您接受将此类组件包含在您的产品中，那么您会感到羞耻。

* * *

可以发布您的测试程序集吗？当然是这样，我认为这是最佳实践。它们可以为客户支持提供很大帮助，您的客户可能还希望将它们整合到他们自己的测试环境中。只是不要将您的测试位强加给您的客户。

# git - 我如何省略 和 在'git push'中？

> ID：347159
> 
> 赞同：5
> 
> 时间：2008-12-07T02:58:29.347
> 
> 标签：git

当我在 master 上时，我只需输入“git push”即可将提交推送到远程仓库。我希望当我在另一个分支上时可以这样做，而无需指定远程名称和分支名称。像那样：

现在： `git push origin experimental:origin/experimental`

需要：`git push`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-07T03:03:48.820

你应该编辑你的`.git/config`文件。应该已经设置了这样的东西：

```
[branch "master"]
    remote = origin
    merge = refs/heads/master 
```

只需复制组并根据您的需要进行编辑。例如，您可以：

```
[branch "master"]
    remote = origin
    merge = refs/heads/master
[branch "experimental"]
    remote = origin
    merge = refs/heads/experimental 
```

# mysql - 我应该删除还是禁用关系数据库中的一行？

> ID：347160
> 
> 赞同：31
> 
> 时间：2008-12-07T03:00:38.343
> 
> 标签：mysql, sql, oracle, relational

在一个全新的程序中，空间并不是什么大问题，是删除一行还是禁用一行更好，让我们说一个布尔值“禁用”并让程序忽略它？

例如，如果我想从程序中删除用户。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-07T03:07:33.260

这取决于。（但你已经猜到了，我敢肯定。）

在实践中，这里对正确用法的违反几乎总是朝着删除的方向发展。

删除的主要不良后果是，当父记录消失时，其他表中的相关记录的引用完整性丢失的频率。

用于保护删除的一条红鲱鱼（您已经通过忽略存储容量问题正确处理了它）预计它将在查询效率方面产生任何明显的差异。

在很多情况下，用户或软件问题导致某人需要点击“撤消”大按钮；如果你删除了，你就不走运了（至少没有得到特别的帮助，也没有激怒你宁愿善待的人。）

我通常使用的术语是“活跃”和“不活跃”。

* * *

还有几点需要考虑（Totophil）：

1.  删除某些数据库中的记录不会自动释放磁盘空间。
2.  清除您不再需要的任何敏感信息有助于避免安全风险。
3.  数据保护立法可能要求您的组织在某些情况下清除有关个人的任何可识别信息。立法因国家而异，一些指针：

    *   欧盟[http://ec.europa.eu/justice_home/fsj/privacy/law/index_en.htm](http://ec.europa.eu/justice_home/fsj/privacy/law/index_en.htm)
    *   英国[http://www.ico.gov.uk/what_we_cover/data_protection.aspx](http://www.ico.gov.uk/what_we_cover/data_protection.aspx)
    *   爱沙尼亚[http://www.riigiteataja.ee/ert/act.jsp?id=748829](http://www.riigiteataja.ee/ert/act.jsp?id=748829)
4.  另一方面，法律可能要求您保留某些信息。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-07T03:43:22.390

不删除将为所有未来的查询创建一类新的错误。不要忘记查询编写通常由高级用户（即非 IT 专业人员）和初级开发人员完成。因此，现在每个具有仅由 BIT 活动标志标记的无效数据的表都需要在 WHERE 子句中为从现在到永远的每个查询添加一个额外的 AND。这将帮助用户陷入失败的深渊，而不是成功的深渊。但是，我强烈建议您无论如何都实施这些标志系统，因为如果没有糟糕的设计，维护开发人员就无需修复它将产生的大量错误。

表中包含历史数据的价值有多大？如果业务具有前瞻性，那么表中的旧数据可能只是一种负担——它在创建约束时会导致问题（必须修改所有约束以排除您希望不存在的数据）。由于必须不断地重新识别“我们害怕删除但再也不想使用或更新的旧垃圾”以及我们关心的新内容，数据质量保证变得复杂。

是不是因为写错了才删？如果该行对应于现实生活中的实体，那么保留并设置“已蒸发”、“死亡”、“离开建筑物”标志可能会很有趣。如果您不小心插入了与现实生活中没有实体对应的行，则 DELETE 并不是一件坏事。从未存在的假想客户对保留在客户表中很重要吗？

最后，个性起着重要作用。人们也可以成为数据的打包者。如果 DBA 保留 30 年前的所有报纸并且不喜欢删除数据，那么也许他应该确保根据优点而不是无关的个人偏好来做出数据设计决策。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-12-07T03:57:31.083

在阅读了一本关于时间数据库设计的书后，我开始相信每条具有时间意义的记录都需要至少有 4 个时间戳列的理念。这四个是：创建，删除，开始，结束。创建和删除的时间戳是不言自明的。您的系统不应查看在 now() 之前已删除的记录。开始和结束列确定数据何时应用于您的系统。这是为了保留更改的历史记录。如果您需要更新记录，请将其结束时间设置为 now()，复制它，更新副本，并将副本的开始时间设置为 now()。这样，当您需要查看历史上某事的方式时，您可以让系统弄清楚。您还可以将开始设置为将来的某个时间点，以便在那时自动进行更改，或将结束设置为将来的时间以使其在那个时候自动消失。将创建/删除的时间戳设置为未来并没有什么意义......

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-12-07T05:36:13.363

如果您确实使用了已删除、可见、已激活等列，您可以通过使用视图来抽象出必须记住使用它的情况。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-07T03:48:40.180

这取决于您和您的要求（当存在记录时，有些事情会变得相当困难......不要）。

不过，我会说布尔值是一个糟糕的选择。使其成为可为空的时间戳。知道何时删除某些内容非常方便，尤其是当您删除太多并想要撤消部分删除时。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-07T03:08:19.543

这取决于。如果它被禁用，那么更容易取消删除/看到有人实际删除了记录（用于审计）。

您可能还有不删除记录的技术要求。例如，如果您想通过仅发送更改的记录来与另一个用户同步数据库，那么如果它被实际删除，您将无法做到这一点。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-07T03:36:40.657

你需要在功能需求中有它。如果没有明确说明，您将不得不自己弄清楚。

在大多数情况下，最好将这些记录存储在单独的表中。然后，您可以避免一个表引用另一个表的各种情况，并且您需要决定是否应该将第二个表中的记录也视为已删除。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-07T04:31:07.413

在您的表格中添加“已删除”列并标记行而不是删除它们会为您创建更多工作，而几乎没有（如果有的话）收益。现在，每次编写查询时，都必须记住包含“WHERE DELETED IS NOT NULL”（或其他）。

更好的方法是在需要删除数据时删除数据，并依靠定期备份过程来确保不会丢失任何数据。如果出于某种原因您需要将一些已删除的数据放在手边（可能是为了搜索），您最好将数据复制到为此目的创建的不同表中，然后删除原始数据。

多年来，我继承了许多数据库，不幸的是，这种标记记录而不是删除记录的策略非常普遍，并且（至少根据我的经验）总是会导致未来出现重大问题。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-08T09:11:24.927

如果您有时需要删除的数据，但不是很频繁：您可以**将记录移动到单独的数据库**/表中（例如`users`and `users_deleted`，或者更好`somedb.users`的 and `somedb_deleted.users`）。

这样，仍然可以通过查询访问数据（尽管它不会像普通查询那样简单），但它不会使原始数据库混乱，您也不必围绕它编写代码。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-07T05:29:36.030

除非您特别需要管理自己的删除，否则最好只删除行。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-08T10:35:40.607

我想指出，（在大多数国家/地区）存在出于法律原因无法删除记录的用例。当然取决于行业和数据。

[在这种情况下，我认为最佳实践指南是将“已删除”数据映射到表中，这将为您带来MatthewMartin 概述](https://stackoverflow.com/questions/347160/should-i-delete-or-disable-a-row-in-a-relational-database#answer-347195)的实际删除的好处，并且通过扩展，我发现这种模式通常比创建“活动”位标志更可取我的数据表。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-07T03:50:07.993

这应该由应用程序的需要来确定。我已经做到了两种方式。我有一些应用程序需要支持撤消，因为删除一行的成本——以及由此引起的级联删除——太昂贵了，不能拥有它。不过，通常情况下，我所做的应用程序要求用户确认删除，然后按照用户的要求进行操作。在某些情况下，出于隐私考虑，您必须删除数据。也就是说，如果用户请求删除，您需要真正删除它，而不仅仅是将其标记为非当前。在其他情况下（如与税务相关的交易），可能有理由将数据保持在非当前状态，直到法律不再要求。我有适合这两个类别的应用程序。

在您需要保留“存档”数据的情况下，可以使用各种策略。根据它是否需要立即可用，您可以将其推送到存档表，这些表要么被保留，要么被定期备份和清理。如果需要撤消，您可能希望将其保留在当前表中并通过设置标志来标记它。这实际上取决于您的架构的复杂性、应用程序的要求以及在某种程度上的个人偏好。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-06-05T15:02:29.920

我正在创建一个 CRUD，我面临同样的问题。

解决方案：CRUD 的 D 应该禁用而不是删除。

**问题：**

*   “每个”查询应该检查注册表是否被禁用（例如 flag=1）。更具体地说，曾经 select * 应该检查这一点。
*   默认情况下，每个插入都应该激活注册表（标志=1）。
*   更新不应更改标志。
*   Disable 是一个变相的更新，它标记了 flag=0。

**大问题**

*   垃圾收集器。存在三种策略：删除旧注册表，删除未引用的注册表或混合策略。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-05-08T14:59:23.897

我经常使用另外两种解决方案。我同意其他发布的人的观点，即这确实符合您的数据要求。

如果使用外键约束会导致引用完整性问题，您可以阻止用户删除记录（前提是您的 RDBMS 支持）。有几次我向最终用户提供了一条消息：“在解除 <parent object> 与它的关联之前，您无法删除此 <object>。” 只要您没有预料到与另一个或多个其他表存在大量关联，这就会起作用。

另一种方法是移动任何取消关联的记录以与未删除的记录相关联。例如，假设您有一门课程，其中关联了 10 个单独的上课时间。如果您删除课程，您可以允许用户决定是否删除所有 10 个课程，或者它们是否与新课程或现有课程相关联。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-07T03:07:15.083

这是一个判断电话，但我最终在我以前认为可以删除行的表上添加了“禁用”列。我会说大多数时候添加禁用列会更安全。然而，这对于 n:n 关系可能会变得棘手，所以这是需要考虑的事情。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-07T03:28:38.410

最好添加“已删除”列并让用户取消删除或清除已删除的项目。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-07-30T20:36:43.197

正如许多人已经说过的，应用程序的需求决定了你想要做什么。但对我来说，标记一行似乎没有为正确的事情使用正确的工具。从逻辑上讲，我们将删除视为 DELETE，因此，如果出于法律原因不允许删除，则首先不要将其删除。同时，我考虑了所有内部数据结构的保存和索引。更不用说可以为检索数据进行的所有优化，但添加该检查（在视图或查询中）会随着数据库的复杂性和实体之间的关系成指数地影响性能。

简而言之，将删除逻辑放在 UI 层，以防止用户出错，并将删除权限授予应该能够删除它的用户。使用定期备份来保存档案。如果您的应用程序绝对需要严格的审计历史记录，请在触发器中实现它并将审计放在异地数据库中，以避免生产中的所有流量、检查和废话。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-08T08:35:17.667

这取决于数据库的功能。它是*所有真理的源泉*吗？如果是，则禁用而不是删除，因为更容易从错误操作中恢复（即用户错误）。如果数据库来自某些上游数据源，则删除未使用的数据。上游系统可以完成任何娱乐/恢复。

# windows-mobile - 有没有办法通过无线方式更新 Windows Mobile 5 应用程序？

> ID：347176
> 
> 赞同：1
> 
> 时间：2008-12-07T03:18:47.090
> 
> 标签：windows-mobile

我希望能够通过无线方式向 windows mobile 5 设备推送应用程序更新，这可能吗？请注意，这只是一个应用程序，而不是 rom 更新。

它不必是严格的推动。让用户访问网页并下载 .cab 文件也很好。有没有人成功做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T03:24:40.103

如果“无线”是指无线网络，那么是的，我已经做到了。

起初我一步一步地给我的用户（关闭应用程序，打开 Internet Explorer，访问此页面，单击此链接等），但在我的应用程序的最新版本中，我提供了一个“更新”菜单项，它（之后提示）在退出程序之前开始下载/运行 cab 文件。下载 cab 文件所需的时间足以让 exe 停止运行，因此在尝试更新时进程在内存中没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T04:16:19.283

更新 Windows Mobile 应用程序的另一种简单方法是让应用程序调用 Web 服务并以字节数组的形式获取其自身的最新版本（最新的 EXE 文件）。正在运行的应用程序然后重命名自己（从“MyApp.exe”到“MyApp.old”），将字节数组保存为具有旧名称（“MyApp.exe”）的文件，通知用户然后关闭。当用户重新启动应用程序时，新版本启动并删除“MyApp.old”文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T16:38:21.577

对于版本管理，请考虑通过 Appcast 更新应用程序。请参阅此处了解更多信息：[http](http://connectedflow.com/appcasting/) ://connectedflow.com/appcasting/ 。这样，您只会在用户软件过期时拉下 CAB 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T08:38:15.740

如果一个商业应用程序是一个选项，并且如果你想使用多个 cab 文件运行更新（比如你的应用程序和 .NET 框架），你可以签出[链接文本](http://www.MobilePackager.com)，它是一个为 windows mobile 创建多 cab 安装的工具

# c++ - 崩溃转储的最佳标志

> ID：347187
> 
> 赞同：4
> 
> 时间：2008-12-07T03:33:34.953
> 
> 标签：c++, crash

我目前有一些代码会在我的应用程序崩溃时产生崩溃转储，但是我无法确定最好的标志是什么。

目前我使用全内存（MiniDumpWithFullMemory），但这会产生 32mg 的崩溃文件。我应该使用哪些标志来不使崩溃文件变大，但在使用它进行调试时给我最大的权力？

有关标志的更多信息，请访问： http: [//www.debuginfo.com/articles/effminidumps.html](http://www.debuginfo.com/articles/effminidumps.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T04:12:05.110

这并不总是如此笼统的答案。所需的标志将在一定程度上取决于您要完成的任务或您可能正在搜索的内容。

也许您遇到线程问题，MiniDumpWithThreadInfo 或 MiniDumpWithProcessThreadData 将是合适的。如果您的程序正在破坏其内存中的数据，那么 MiniDumpWithFullMemory 可能是您的选择。

从我自己的使用来看，拥有完整的内存并不总是很有用——我将从 PEB 或 TEB 结构中获得我需要的东西，或者只是从线程堆栈跟踪中获得我需要的东西。

此外，请查看您链接到的网站部分中列出的标志：http: [//www.debuginfo.com/articles/effminidumps2.html#strategies](http://www.debuginfo.com/articles/effminidumps2.html#strategies)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T03:41:54.267

Minidump 是高度可压缩的 - 我建议将其压缩以帮助调整大小

# c++ - 如何使用 Winsock 从数据报的 IP 标头中获取源 IP 地址？

> ID：347191
> 
> 赞同：1
> 
> 时间：2008-12-07T03:38:14.820
> 
> 标签：c++, windows, winsock

我有一个绑定（）到 INADDR_ANY 的端口。我正在成功接收数据报。收到后需要读取IP头来获取源IP地址。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T04:09:30.933

如果你使用标准的 recv 或 read 函数调用，我不相信你能得到它。recvfrom 调用如下：

```
int recvfrom(
  __in         SOCKET s,
  __out        char *buf,
  __in         int len,
  __in         int flags,
  __out        struct sockaddr *from,
  __inout_opt  int *fromlen
); 
```

包括一个结构（上面倒数第二个字段），它将接收源地址，您可以根据需要检查该源地址。

# apache-flex - 如何解决此错误“一个未知项目被声明为您的 MXML 文档的根。切换到源模式以更正它。”？

> ID：347196
> 
> 赞同：2
> 
> 时间：2008-12-07T03:45:37.877
> 
> 标签：apache-flex, maven-2, flexbuilder

我的 mxml 源代码中只有这个：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml"
            xmlns:comp="components.*"
            width="770" height="330">
    <mx:Label x="185.5" y="150" 
text="Placeholder for Future UI." fontSize="30" color="#93A8AD"/>

</mx:Canvas> 
```

当我尝试使用 flex builder 的设计模式时，我收到错误“一个未知的项目被声明为 MXML 文档的根。切换到源模式以更正它。” 有谁知道如何解决这个问题？

这里需要注意的一件事是，我最近升级到了 flash player 10 调试器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-12-30T19:52:59.913

我正在使用 MyEclipse for Spring Version: 8.6 和使用配置中心安装的 Flex Builder 3 插件。当我在工作区之间切换并安装/卸载 MyEclipse 和 Flex Builder 以找出安装它们的正确方法时破坏了 Flex 3 配置，我遇到了这个问题。我通过更正指向不存在文件夹的损坏的 Flex SDK 路径来解决此问题。

您可以通过查看 Flex->installed Flex SDKs->libraries path 来验证它，如果错误则将其修复为正确的路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T05:23:42.390

我已经解决了这个问题。问题是我用 maven 创建了我的多模块项目并将项目导入到 Eclipse。因此，默认情况下，eclipse 不会将 flex 项目识别为 flex 项目。我所做的是我删除了 flex 项目，并使用 'File -> New -> Flex Project' 选项重新创建它，然后问题就解决了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-17T16:21:04.840

Flex Builder 不是一个整体... Eclipse 和 maven 不能很好地结合在一起。它变得好多了。如何正确解决这个问题？在项目 .project 文件中删除所有与 flex builder 有任何关系的 buildSpec、Natures 和链接资源。这将从项目中删除任何弹性内容。然后在 Eclipse 中，确保它看起来不像一个 flex 项目，重新添加 flex 属性。（在项目上单击鼠标右键，您应该看到“Flex Project Nature”并选择“Add Flex Project Nature”这将解决 gui builder 问题。如果您使用 maven 构建您的 flex 项目，您将不得不更新更多设置. IE. 构建路径。你需要将它设置为 src/main/flex 然后更新你的 main. 您将了解其他真正重要的 flex builder 文件。.flexProperties 文件和 .actionScrioptProperties 文件。总有一天 eclipse:eclipse maven 插件将支持 flex builder :)

谢谢！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-06T20:40:13.760

在 Flex Builder 3 上，右键单击项目->属性->Flex 编译器，然后在“Flex SDK 版本”上选择“使用默认 SDK”（当前为 flex3）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-29T16:11:26.057

我在 Flash Builder v. 4.0.1 中遇到了同样的问题。构建 277662。提到的解决方案都没有任何帮助，但我找到了另一种解决方法（对我有用）。

我在 Flash builder 中安装了以下附加插件：

*   Sonatype 的 Maven 2.0 集成插件。
*   Eclipse J2EE 标准工具，版本：3.0.4.v200811190840-7U1959LJIHM6ogLbhvbrAnWtxuyM 构建 ID：20090212194735

我的项目是一个多模块 maven 项目，我们称它为“todolist”，带有一个使用 Flexmojos maven 插件构建的 todolist/todolist-ria 子项目。实际上它基于：[this reference application](http://svn.sonatype.org/flexmojos/trunk/flexmojos-touchstone/todolist/) 它使用 Flex 版本 4.1.0.16248。

在 Flash Builder 中导入 maven 项目后，添加 Flex Project Type 并将主源路径设置为 src/main/flex （右键单击项目 | 属性 | Flex 构建路径 | 主源文件夹：src/main/flex）我看到了在设计模式下打开任何 .mxml 文件时的错误消息。在源代码模式下，代码完成也不起作用。

解决方法：

1.  让 Flash Builder 创建一个全新的 Flex 项目，为您的项目选择合适的 Flex 版本（3 或 4）。确保该项目的位置在您的 Maven 项目之外。
2.  右键单击新项目 | 属性 | Flex 构建路径 | 源路径
3.  添加文件夹... | 浏览...
4.  选择您的弹性代码所在的文件夹（例如.../todolist/todolist-ria/src/main/flex）

Flash Builder 将在项目中添加指向源文件夹的链接（例如[源路径] flex）。

现在您可以在设计模式下打开此源文件夹中的任何 .mxml 文件，并且代码完成也可以在源模式下工作。

警告：到目前为止，我的项目中没有任何第三方 Flex 库（.swc 文件）的依赖项，所以我不确定这种解决方法在这种情况下是否仍然有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-22T11:34:24.453

检查您的项目属性是否正确。通过浏览文件夹并选择它们来找到 swc 文件，而不仅仅是输入正确的路径。

这对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T04:25:26.253

听起来它不喜欢“画布”元素。我从未使用过 Flex，但在 Visual Studio 中执行 WPF 应用程序的示例中，根据文件的使用方式，只有某些元素被排除在根元素之外。如果它是主 MXML 文件，它可能期待其他东西，比如“应用程序”元素。如果它以其他方式使用，例如数据文件或自定义控件，则无关紧要。

这是一个 MXML 文件的示例（向下滚动页面），其中文件的根元素在使用控件之前确实是一个“应用程序”元素......

[示例 MXML 文件](http://www.adobe.com/devnet/flex/articles/paradigm.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-11T16:32:38.843

只需将您的类型光标 (blik |) 放在 .mxml 文件的第一行，在您的代码之前：

|`<?xml...`

按回车键，然后退格键删除此回车键，项目会自动重新加载，一切正常。

# javascript - 您如何在 SOF 上的新帖子中执行没有“onclick”（如“Grippie”）的 Javascript 函数

> ID：347210
> 
> 赞同：3
> 
> 时间：2008-12-07T03:59:28.240
> 
> 标签：javascript, html, javascript-events, event-handling

您如何`onclick`在 SOF 上的新帖子中不使用“Grippie”之类的 Javascript 函数，例如`<div class="grippie" style="margin-right: 59px;"/`当您发布问题或答案时 Stack Overflow 上的 >？我得到了一个不错的 CSS 光标，它让我知道可移动的边缘，但是调整字段大小的 JavaScript 是如何发现我点击了“grippie”的？

**编辑：** 感谢您提供导致 jQuery 并描述处理程序的答案。我可以简单地使用确定何时单击元素的处理程序，例如：

```
addListener('myElement',performFunction();).onclick; 
```

或者这可能有效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T04:15:14.463

如果您使用 Firefox Web Developer 插件查看生成的源代码，您会看到它使用 @grepsedawk 提到的 TextAreaResizer 添加了一个“grippie”类的 DIV。此 DIV 具有背景的调整大小精灵，并附加了一个单击处理程序来执行调整大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T04:12:26.997

[http://plugins.jquery.com/project/TextAreaResizer](http://plugins.jquery.com/project/TextAreaResizer)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T14:36:57.670

我研究了一些我将概述的方法。将不胜感激有关哪个最好的进一步评论。目标是从生成的源中隐藏“onClick”侦听器。

```
document.getElementById('ID').addEventListener('click',function();,false);  
//Problems: Has to be terminated and false/true is something tricky I don't understand yet (please see link I post)

document.getElementById('ID').onclick = function();
//Problems: Cannot be terminated directly and heirachy issue where function including 'this' keyword applies to the child divs or something (please again see link I post)

//an iterartion of setInterval(checkFunction,interval);
//Problems: Very very slow and in most cases requires an onClick to check for a change anyway! 
```

因此，在我的研究结束时，这个网站因很好地解释了 Java 中的 eventListeners 如何有效地被钩住而脱颖而出：http: [//www.howtocreate.co.uk/tutorials/javascript/domevents](http://www.howtocreate.co.uk/tutorials/javascript/domevents)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T04:14:58.520

站点上使用的 JavaScript 侦听点击事件并查找与之交互的元素的 ID。如果元素 ID 是需要操作的预期对象之一，则脚本将忽略该事件或执行某些操作。

# iphone - 如何以编程方式暂停 NSTimer？

> ID：347219
> 
> 赞同：44
> 
> 时间：2008-12-07T04:12:28.587
> 
> 标签：iphone, objective-c, cocoa-touch

我正在使用 NSTimer 在基于 OpenGL 的 iPhone 应用程序中进行一些渲染。我有一个弹出并请求用户输入的模式对话框。当用户提供输入时，我想“暂停”，例如：

```
[myNSTimer pause]; 
```

我使用这种语法是因为我一直在做类似的事情：

```
[myNSTimer invalidate]; 
```

当我想让它停止时。

如何以编程方式暂停 NSTimer？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2011-07-20T16:32:45.763

只是想更新对[kapesoftware](https://stackoverflow.com/users/456090/kapesoftware)答案的小修复：

```
NSDate *pauseStart, *previousFireDate;

-(void) pauseTimer:(NSTimer *)timer { 

    pauseStart = [[NSDate dateWithTimeIntervalSinceNow:0] retain];

    previousFireDate = [[timer fireDate] retain];

    [timer setFireDate:[NSDate distantFuture]];
}

-(void) resumeTimer:(NSTimer *)timer {

    float pauseTime = -1*[pauseStart timeIntervalSinceNow];

    [timer setFireDate:[previousFireDate initWithTimeInterval:pauseTime sinceDate:previousFireDate]];

    [pauseStart release];

    [previousFireDate release];
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-07T04:17:39.373

从这里：

[http://discussions.apple.com/thread.jspa?threadID=1811475&tstart=75](http://discussions.apple.com/thread.jspa?threadID=1811475&tstart=75)

“您可以存储自计时器启动以来经过的时间量......当计时器启动时，将日期存储在 NSDate 变量中。然后当用户切换时......使用 NSDate 类中的方法 timeIntervalSinceNow 来存储多少时间已经过去...请注意，这将为 timeIntervalSinceNow 提供负值。当用户返回时，使用该值设置适当的计时器。

我认为没有办法暂停和重新启动计时器。我遇到了类似的情况。"

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-09-23T11:22:42.993

我实现这一点的方法是将 NSTimer 的触发日期存储在一个变量中，然后将触发日期设置为 INFINITY。

当我暂停时：

```
pauseStart = [[NSDate dateWithTimeIntervalSinceNow:0] retain];
previousFiringDate = [timer firingDate];
[timer setFiringDate:INFINITY] 
```

当我取消暂停时，我将计时器暂停的时间添加到上一个触发日期：

```
float pauseTime = -1*[pauseStart timeIntervalSinceNow];
[timer setFireDate:[previousFireDate initWithTimeInterval:pauseTime sinceDate:previousFireDate]]; 
```

这比担心使计时器失效和重新初始化要容易得多。我有很多计时器，所以我只是把它们都放在一个数组中，然后对它们都这样做。我对 NSTimer 进行了子类化，以保持 previousFiringDate 与该计时器相关联。

这也比使用 BOOL 来判断是否暂停要好，因此如果设置了 BOOL，则不会发生操作。这是因为如果在您暂停之前将要发生某些事情，那么在您取消暂停之后它就不会发生，因为它只是被跳过了。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-10T15:20:10.617

就我而言，我有一个变量“秒”和另一个“timerIsEnabled”。当我想暂停计时器时，只需将 timerIsEnabled 设为 false。由于 seconds 变量只有在 timerIsEnabled 为真时才会增加，所以我解决了我的问题。希望这可以帮助。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-05-16T16:57:45.037

我设法做到的最简单的方法是这样的：

```
-(void) timerToggle{
    if (theTimer == nil) {
        float theInterval = 1.0/30.0;
        theTimer = [NSTimer scheduledTimerWithTimeInterval:theInterval target:self selector:@selector(animateBall:) userInfo:nil repeats:YES];
    } else {
        [theTimer invalidate];
        theTimer = nil;
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-08-13T04:03:09.193

这是一个`NSTimer`允许暂停和恢复功能的类别。

标题：

```
#import <Foundation/Foundation.h>

@interface NSTimer (CVPausable)

- (void)pauseOrResume;
- (BOOL)isPaused;

@end 
```

执行：

```
#import "NSTimer+CVPausable.h"
#import <objc/runtime.h>

@interface NSTimer (CVPausablePrivate)

@property (nonatomic) NSNumber *timeDeltaNumber;

@end

@implementation NSTimer (CVPausablePrivate)

static void *AssociationKey;

- (NSNumber *)timeDeltaNumber
{
    return objc_getAssociatedObject(self, AssociationKey);
}

- (void)setTimeDeltaNumber:(NSNumber *)timeDeltaNumber
{
    objc_setAssociatedObject(self, AssociationKey, timeDeltaNumber, OBJC_ASSOCIATION_RETAIN);
}

@end

@implementation NSTimer (CVPausable)

- (void)pauseOrResume
{
    if ([self isPaused]) {
        self.fireDate = [[NSDate date] dateByAddingTimeInterval:[self.timeDeltaNumber doubleValue]];
        self.timeDeltaNumber = nil;
    }
    else {
        NSTimeInterval interval = [[self fireDate] timeIntervalSinceNow];
        self.timeDeltaNumber = @(interval);
        self.fireDate = [NSDate distantFuture];
    }
}

- (BOOL)isPaused
{
    return (self.timeDeltaNumber != nil);
}

@end 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-28T08:31:36.863

老问题，但我刚刚写了一个轻量级的实用程序类来完成 OP 正在寻找的东西。

[https://github.com/codeslaw/CSPausibleTimer](https://github.com/codeslaw/CSPausibleTimer)

也支持重复计时器。希望它派上用场！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-01-03T10:06:27.713

根据@Thiru 和@kapesoftware 的回答，我在NSTimer 上创建了一个Objective-C 类别，使用关联对象来暂停和恢复计时器。

```
#import <objc/runtime.h>

@interface NSTimer (PausableTimer)

@property (nonatomic, retain) NSDate *pausedDate;

@property (nonatomic, retain) NSDate *nextFireDate;

-(void)pause;

-(void)resume;

@end 
```

...

```
@implementation NSTimer (PausableTimer)

static char * kPausedDate = "pausedDate";
static char * kNextFireDate = "nextFireDate";

@dynamic pausedDate;
@dynamic nextFireDate;

-(void)pause {

  self.pausedDate = [NSDate date];

  self.nextFireDate = [self fireDate];

  [self setFireDate:[NSDate distantFuture]];
}

-(void)resume
{
  float pauseTime = -1*[self.pausedDate timeIntervalSinceNow];

  [self setFireDate:[self.nextFireDate initWithTimeInterval:pauseTime sinceDate:self.nextFireDate]];
}

- (void)setPausedDate:(NSDate *)pausedDate
{
  objc_setAssociatedObject(self, kPausedDate, pausedDate, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

- (NSDate *)pausedDate
{
  return objc_getAssociatedObject(self, kPausedDate);
}

- (void)setNextFireDate:(NSDate *)nextFireDate
{
  objc_setAssociatedObject(self, kNextFireDate, nextFireDate, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

- (NSDate *)nextFireDate
{
  return objc_getAssociatedObject(self, kNextFireDate);
} 
```

它使事情保持整洁，这意味着您不必创建实例变量或属性只是为了暂停和恢复您的计时器。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-06T13:11:39.433

随意重用我的类别`NSTimer`：

[https://github.com/keeshux/ios-components/tree/master/Components/Categories/NSTimer%2BPause](https://github.com/keeshux/ios-components/tree/master/Components/Categories/NSTimer%2BPause)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-03-15T07:08:07.070

如上所述，您不能暂停 NSTimer。所以要捕获的时间不应该依赖于 Timer firedate ，我建议。这是我最简单的解决方案：

创建计时器时初始化起始单位时间，如：

```
self.startDate=[NSDate date];
self.timeElapsedInterval=[[NSDate date] timeIntervalSinceDate:self.startDate];//This ``will be 0 //second at the start of the timer.``     

myTimer= [NSTimer scheduledTimerWithTimeInterval:1.0 target:self `selector:@selector(updateTimer) userInfo:nil repeats:YES]; 
```

` 现在在更新计时器方法中：

```
 NSTimeInterval unitTime=1;
-(void) updateTimer
 {
 if(self.timerPaused)
       {
           //Do nothing as timer is paused
       }
 else{
     self.timerElapsedInterval=timerElapsedInterval+unitInterval;
    //Then do your thing update the visual timer texfield or something.
    }

 } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-11-23T16:04:13.170

好吧，我发现这是实现暂停计时器的最佳方法。使用静态变量来切换暂停和恢复。在暂停时，使计时器无效并将其设置为 nil，并在恢复部分使用启动计时器的原始代码重置计时器。

以下代码适用于对暂停按钮单击的响应。

```
-(IBAction)Pause:(id)sender
{
    static BOOL *PauseToggle;
    if(!PauseToggle)
    {
        [timer invalidate];
        timer = nil;
        PauseToggle = (BOOL *) YES;
    }
    else
    {
        timer = [NSTimer scheduledTimerWithTimeInterval:0.04 target:self selector:@selector(HeliMove) userInfo:nil repeats:YES];
        PauseToggle = (BOOL *) NO;
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-01-22T12:57:43.437

下面的代码用于滚动视图，它会定期显示内容，并在完成时循环回到前面，但相同的逻辑可用于任何暂停/重启按钮。

计时器在加载时触发（initiateFeatureTimer），并暂停用户交互（将开始拖动方法），允许用户查看内容，只要她喜欢。当用户抬起手指（将结束拖动）时，featurePaused 布尔值被重置，但您也可以选择添加更多延迟。

这样，滚动条不会在手指抬起时立即移开，它对用户的反应更大。

```
//set vars, fire first method on load.
featureDelay = 8; //int
featureInt = featureDelay-1; //int
featurePaused = false; //boolean

-(void)initiateFeatureTimer {
    featureTimer = [NSTimer scheduledTimerWithTimeInterval:1.0f target:self selector:@selector(moveFeatureScroller) userInfo:nil repeats:true];
    [featureTimer fire];
}
 -(void)moveFeatureScroller {

    if (!featurePaused){ //check boolean
        featureInt++;

         if (featureInt == featureDelay){
             featureInt = 0; //reset the feature int

            /*//scroll logic
            int nextPage = (featurePage + 1) * w;
            if (featurePage == features.count-1){ nextPage = 0; }
            [featureScroller setContentOffset:CGPointMake(nextPage, 0)]; */          
         }
      }
}

-(void)scrollViewWillBeginDragging:(UIScrollView *)scrollView {
    featurePaused = true; //pause the timer
}
-(void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset {
    featurePaused = false; //restart the timer
    featureInt = -3; //if you want to add an additional delay
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-03-07T22:24:43.623

这是一个简单的快速暂停/播放计时器。

[https://github.com/AnthonyUccello/Swift-Pausable-Timer/blob/master/Timer.swift](https://github.com/AnthonyUccello/Swift-Pausable-Timer/blob/master/Timer.swift)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-04-11T13:14:47.217

如果您的火灾时间间隔是宽容的，您可以使用`CADisplayLink`代替`NSTimer`. 因为`CADisplayLink`支持`-pause`。

```
displayLink = [[CADisplayLink displayLinkWithTarget:self selector:@selector(fireMethod:)];
displayLink.frameInterval = approximateVaue;//CADisplayLink's frame rate is 60 fps.
    [displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];

//pause
[displayLink pause]; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-04T17:25:52.823

这是一个更现代的解决方案，包装计时器并在它停止时存储。

在实际的计时器触发回调中调用时，我还遇到了一个有趣的错误`pause`，这将导致计时器在表达式计算为零后不断触发`timer.fireDate.timeIntervalSinceNow`，我在暂停中添加了一个标志来明确避免这种情况

```
import Foundation

class PausableTimer {

    let timer: Timer
    var timeIntervalOnPause: TimeInterval?

    init(timeInterval interval: TimeInterval, repeats: Bool, block: @escaping (Timer) -> Void) {
        timer = Timer(timeInterval: interval, repeats: repeats, block: block)
    }

    func invalidate() {
        timer.invalidate()
    }

    var paused: Bool {
        timeIntervalOnPause != nil
    }

    func toggle() {
        if paused {
            resume()
        } else {
            pause(isFiringTimer: false)
        }
    }

    /// Pause the timer
    /// - Parameter isFiringTimer: pass in true if the timer is currently firing, in which case the resume time will not
    /// be relative to next fire date, but instead relative to the time interval. It's improtant that this be correct otherwise there maybe a near
    /// infinite loop firing of the `Timer`
    func pause(isFiringTimer: Bool) {
        guard timer.isValid else {
            return
        }
        timeIntervalOnPause = isFiringTimer || timer.fireDate.timeIntervalSinceReferenceDate == 0 ? timer.timeInterval : timer.fireDate.timeIntervalSinceNow
        timer.fireDate = .distantFuture
    }

    /// Resume the timer, if it was not paused has not effect, and causes assertion failure
    func resume() {
        guard timer.isValid else {
            return
        }
        guard let timeIntervalOnPause = timeIntervalOnPause else {
            assertionFailure("Resuming a timer that was never paused \(self) - \(self.timer)")
            return
        }
        let relativeFireDate = Date(timeIntervalSinceNow: timeIntervalOnPause)
        timer.fireDate = relativeFireDate
        self.timeIntervalOnPause = nil
    }

} 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2014-02-16T17:10:51.693

我也需要可暂停的 NSTimer。在阅读了这个线程和你的答案并意识到我唯一需要的是将计时器的 fireDate 设置为遥远的未来，然后回到现在，我使用 Pause 和 Resume 方法将类别设置为 NSTimer。所以我可以通过调用 [myTimer pause] 来简单地暂停计时器；并通过调用 [myTimer resume] 恢复；方法。在这里，希望它会帮助某人。

界面：

```
#import <Foundation/Foundation.h>

@interface NSTimer (Pausable)

-(void)pause;
-(void)resume;

@end 
```

执行：

```
#import "NSTimer+Pausable.h"

@implementation NSTimer (Pausable)

-(void)pause
{
    [self setFireDate:[NSDate dateWithTimeIntervalSinceNow:[NSDate distantFuture]]]; //set fireDate to far future
}

-(void)resume
{
    [self setFireDate:[NSDate date]];
}

@end 
```

# wpf - 如何为带有确定/取消按钮的数据绑定 WPF 对话框设计支持数据类型？

> ID：347226
> 
> 赞同：3
> 
> 时间：2008-12-07T04:25:56.987
> 
> 标签：wpf, linq-to-sql, data-binding, sql-server-ce

我在 Microsoft Sql CE 中创建了一个用于保存一些数据的表。我已经通过 SqlMetal 生成了一个 ORM，并将数据源拉到了我的 WPF 项目中。

我想创建一个简单的 WPF 表单，可用于通过 ORM 生成的类编辑表中的记录。我希望这个表单支持典型的 OK/Cancel 语义。我以我认为是典型的方式创建了表单，在各个字段上使用 TwoWay 数据绑定来绑定来自 ORM 的对象实例。例如，给定 ORM 中具有属性“TaskName”的对象，我在 WPF 表单中包含以下内容：

```
<Label Grid.Column="0" Grid.Row="0" >
    Name:
</Label>
<TextBox Name="txtName" Grid.Column="1" Grid.Row="0" 
         Text="{Binding TaskName, Mode=TwoWay}" AcceptsReturn="False"
         MaxLines="1" /> 
```

这与代码中的 DataContext 分配相结合：

```
var newRow = new OrmGeneratedClass();
// Populate default values on newRow, e.g.    
detailWindow.DataContext = newRow;
detailWindow.ShowDialog(); 
```

可以很好地创建新行。通过表单所做的所有更改都会立即反映在底层 OrmGeneratedClass 中。问题是，如果 OrmGeneratedClass 填充了以前保存的值，则无法立即支持取消更改。

**对于这种情况，什么是好的设计，或者在我到达这一点之前我设计错了吗？** 我是 WPF 和 Sql Server 数据源/ORM 集成方面的新手。（这是我用来学习这两种技术的个人项目。）

我有几个想法，并将它们放在答案中

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-07T04:35:18.650

Paul Stovell 有一篇关于为 IEditableObject 接口创建适配器的精彩文章，该接口允许您进行数据绑定并允许应用/恢复行为。

[http://www.paulstovell.com/blog/runtime-ui-binding-behavior-ieditableobject-adapter](http://www.paulstovell.com/blog/runtime-ui-binding-behavior-ieditableobject-adapter)

适配器环绕您的 ORM 对象并自动缓存更改，以便您可以应用更改或恢复到原始状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T04:32:35.880

一种可能的解决方案是从对话框中查找取消结果，并使用 ORM 对象的主键，在用户每次取消时从数据库中检索数据，以验证对象是否包含它在数据库中的值。这假定该值的最近确认值已存储在数据库中。（在这样简单的程序中，这可能是一个公平的假设。）

它可能看起来像这样（非编译）代码：

```
var existingRow = GetExistingRow(someConditionOrWhatever);
detailWindow.DataContext = existingRow;
if(!detailWindow.ShowDialog())
{
    existingRow = GetExistingRow(someConditionOrWhatever);
} 
```

不过，我不知道我是否喜欢这样往返于数据库。

# asp.net - 如何使用 ASP.NET HttpSession 使 ASP.NET 会话 cookie 过期？

> ID：347227
> 
> 赞同：4
> 
> 时间：2008-12-07T04:28:02.067
> 
> 标签：asp.net, session, httpcookie

我创建了一个 HttpCookie 以便跨子域共享数据：

```
HttpCookie cookie = new HttpCookie("sessionGUID");
cookie.Value = value;
cookie.Domain = ".example.com";

Response.Cookies.Set(cookie); 
```

我不小心假设它是一个“会话”cookie（不会过期），它会与我的 ASP.NET 会话一起过期。当然，对于浏览器来说，这是一个“浏览器会话”cookie，并没有链接到 ASP.NET 会话。

我想要做的是将这些“浏览器会话”cookie 与 ASP.NET 会话一起过期。

我想我只需要将 Expires 设置为与 ASP.NET 会话相同的值。我将如何以编程方式确定这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T04:55:27.800

如果他们只需要靠近，那么就像这样：

```
int expirationMinutes = Session.Timeout;
if (System.Web.HttpContext.Current.Response.Cookies["monster"]!=null)
{
    System.Web.HttpContext.Current.Response.Cookies["monster"].Expires =
                                 DateTime.Now.AddMinutes(expirationMinutes);
} 
```

会话计时器重置用户发布或获取的所有内容，因此由于代码正在服务器上执行，当前会话的剩余时间为 Session.Timeout，例如 20 分钟。

20 分钟后，cookie 将不被接受，您必须发布一个新的。

# java - Base64 编码字符串搜索

> ID：347235
> 
> 赞同：1
> 
> 时间：2008-12-07T04:43:20.867
> 
> 标签：java, search, base64, encode

我有 base64 编码的字符串。如何搜索此字符串以检查此字符串是否包含未编码的特定子字符串？我不想解码那个字符串然后搜索它。

我可以只编码那个特定的子字符串，然后使用编码的子字符串搜索编码的字符串吗？

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-07T05:53:12.817

最好的方法可能是只解码字符串。但是，如果确实有必要，可以即时执行此操作，而不是先进行完整解码，然后再进行搜索。您必须执行一次搜索，并且只解码您当前正在检查的那部分。这很可能仅在您确实不想（或不能）在内存中存储两次的非常非常大的字符串时才有用。

如果您搜索的字符串足够长，您还可以使用不同的填充（例如''，'x'和'xx'）对该字符串进行三次编码并搜索没有前4个和后4个字符的字符串（你不要'不想匹配填充）。当您找到匹配项时，您必须确保对齐与填充相对应，并验证您尚未匹配的部分（由于填充）也在适当的位置。当然，后者确实需要一些解码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T08:55:37.457

假设您知道所涉及的 base64 编码的确切形式，您可以对字符串进行编码，就好像它出现在三个偏移量中的每一个处一样（start%3 == 0、start%3 == 1、start%3 == 2）。您必须巧妙地处理字符串的开头和结尾，因为这些字符会受到周围数据的影响。然后，您可以只使用普通的 IndexOf 或其他任何东西来检查字符串的中间部分，然后更智能地检查开始和结束。

不过，就我个人而言，我不会遇到所有这些麻烦 - 正如其他建议所建议的那样，只需解码然后搜索即可。做对会容易*得多。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T04:48:45.100

Base64 可以通过不同的算法或实现采用几种不同的形式或含义。[即使查看Wikipedia](http://en.wikipedia.org/wiki/Base64#Example)上的示例，也可以看到字符的编码值可能会根据位置而变化。简短回答：不，您不能只对字符串进行编码并在较大的编码文本中进行搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-08T02:29:07.650

正如其他人所指出的，对子字符串进行编码并直接使用它进行搜索可能具有挑战性。但是，从子字符串创建正则表达式可以使它更容易一些。

举例来说，考虑确定 Base64 编码数据是否对应于 Windows 可执行文件的用例。一些恶意软件包含 Base64 编码的 EXE，它将在受感染的系统上执行，并且在进行恶意软件分析以检测这一点时很有用。`MZ`可以通过在数据的开头和`PE\x00\x00`之后的某个位置查找来识别 Windows 可执行文件。

Base64 通过将字节流解释为 6 位值来工作，默认情况下，这些值对应于字符`A`through `Z`、`a`through `z`、`0`through `9`、`+`和`\`。下图显示了这些映射：

[![Base64 字符映射](https://i.stack.imgur.com/QGM0rl.png)](https://i.stack.imgur.com/QGM0rl.png)

首先，首先将`MZ`其转换为等效的二进制（在这种情况下，我们可以假设字符集是 ASCII，因此`M`is`01001101`和`Z`is `01011010`）。将这 16 位分成 6 位组会产生：

```
010011 010101 1010xx
T      V      ??? 
```

由于 16 不能被 6 整除，因此最后两位取决于后面的数据`MZ`。但是，由于仅缺少两位，因此该字符只有四个可能的值：

```
101000: o
101001: p
101010: q
101011: r 
```

因此，要查找`MZ`Base64 编码文本块的开头，`^TV[o-r]`可以使用正则表达式。

寻找`PE\x00\x00`更具挑战性，因为我们不知道在它之前出现了多少个字符。根据 8 位集合如何划分为 6 位集合以形成 Base64 输出，需要考虑三种不同的情况：

*   零前字节：前字节中的任何位都不会影响第一个字符 ( `0 % 6 == 0`)
*   前一个字节：前一个字节的两位影响第一个字符（`8 % 6 == 2`；最后两位溢出）
*   前两个字节：前一个字节的四位影响第一个字符（`16 % 6 == 4`；最后四位溢出）
*   前面三个字节：前面字节中的任何位都不会影响第一个字符 ( `24 % 6 == 0`)
*   ... 等等

通过三个案例工作：

```
Zero-bit shift:
P        E        \x00     \x00
01010000 01000101 00000000 00000000
becomes:
010100 000100 010100 000000 000000 00xxxx
U      E      U      A      A      [A-P]

Two-bit shift:
???      P        E        \x00     \x00
xxxxxxxx 01010000 01000101 00000000 00000000
becomes:
xxxxxx xx0101 000001 010100 000000 000000 0000xx
       [FVl1] B      F      A      A      [A-D]

Four-bit shift:
???      ???      P        E        \x00     \x00
xxxxxxxx xxxxxxxx 01010000 01000101 00000000 00000000
becomes:
xxxxxx xxxxxx xxxx01             010000 010001 010000 000000 000000
              [BFJNRVZdhlptx159] Q      R      Q      A      A 
```

总之，您可以使用以下正则表达式来确定 Base64 编码的数据是否是 Windows 可执行文件：

```
^TV[o-r][A-Za-z0-9\+/]+(?:UEUAA[A-P]|[FVl1]BFAA[A-D]|[BFJNRVZdhlptx159]QRQAA) 
```

请注意，在有效的可执行文件中，DOS 标头和 PE 标头之间的空间可能受到限制，因此`[A-Za-z0-9\+/]+`可以用更小的界限代替。

Base64 字符表来自：[https ://en.wikipedia.org/wiki/Base64#Base64_table](https://en.wikipedia.org/wiki/Base64#Base64_table)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-07T04:49:42.570

您不能只搜索编码的子字符串。您的搜索字符串将根据其在原始字符串中出现的位置进行不同的编码。我认为您需要解码整个字符串，然后搜索您的子字符串。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2022-02-19T22:49:05.660

您可以将纯文本和 base64 字符串转换为它们的字节或十六进制表示。然后，您可以像搜索任何其他字符串一样搜索字节或十六进制。然后，您不必进行位移或类似的任何花哨的操作，因为一旦将字符串编码转换为字节，它们之间就没有区别了。

可以在此处找到 JavaScript 实现：[https](https://github.com/nanaknihal/js-search-plaintext-within-base64) ://github.com/nanaknihal/js-search-plaintext-within-base64 。

# sql - 将应用程序最终用户映射到数据库用户的每种方法的优势是什么？

> ID：347238
> 
> 赞同：6
> 
> 时间：2008-12-07T04:46:28.177
> 
> 标签：sql, database, oracle, security

将应用程序最终用户映射到数据库用户似乎有三种常用方法。

1.  **一对一映射：** 每个应用程序用户（bob、nancy 和 fred）也得到一个对应的数据库用户帐户（bob nancy 和 fred）。
2.  **N 到 M 映射：** 每个应用程序用户都映射到代表其角色的数据库用户。bob 和 nancy 映射到 'clerk' 数据库用户，而 fred 映射到 'manager' 数据库用户。
3.  **N 对 1 映射：** 每个应用程序用户都映射到单个数据库用户 (app_user)，并且身份仅在应用程序层进行管理。

似乎#3 是 Web 应用程序开发中最常见的。 **为什么没有更加强调其他两个选项？**

Oracle 鼓励使用其代理身份验证功能的 #2 等技术，原因如下：

**有限信任模型**- 控制中间层可以代表其连接的用户，以及中间层可以为用户承担的角色

**可扩展性**——通过支持轻量级用户会话并消除重新验证客户端的开销

**问责制**，通过将真实用户的身份保存到数据库，并启用代表真实用户采取的行动的审计

[Oracle 的代理身份验证文档](http://download.oracle.com/docs/cd/B28359_01/java.111/b31224/proxya.htm)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-07T09:57:21.870

除了更简单的管理之外，选项 3 在 Web 服务器上还有性能优势；这允许连接池 - 即可以连续重复使用少量物理数据库连接来为大量应用程序用户提供服务。这被称为“[受信任的子系统](http://msdn.microsoft.com/en-us/library/aa480587.aspx)”模型 - 即您的应用服务器验证外部调用者，但随后应用服务器本身用作向下调用的身份。这里最大的问题是，对于审计等，您需要不断告诉数据库谁进行了当前的更改（诸如`USER_NAME()`,`SUSER_SNAME()`不再有用之类的东西）——当然，这相对容易被欺骗。

如果网络服务器对每个用户使用安全性，这将是不可能的——因此您基本上必须禁用连接池。建立连接的行为（相对）昂贵，因此这将对性能产生重大影响。您不希望在请求之间保持（每个用户）连接，因为这会导致巨大的池和大量打开的连接（也很昂贵）。

它们之间的“每个角色”选项站点 - 但很少有角色真正相互排斥，这使得这很难实现。

对于直接与数据库对话的客户端应用程序，选项 1 维护起来最简单，因为您不需要向客户端分发任何特殊的帐户详细信息。池同样不是问题，因为客户端的机器仅充当 1 个用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T05:05:51.850

关于 2)，应用程序安全/权限需求通常比数据库安全层提供的粒度要细得多，除非您将大部分应用程序逻辑放入数据库中。一个简单的例子是，当两个用户可能需要更新订单表时，一个可能正在创建自己的订单，另一个可能是管理员用户正在编辑其他人的订单。他们都需要对表的插入/更新权限。您可以通过存储过程实现此限制，但这确实是一种解决方法 - 两个用户仍然需要更新表，因此需要一个具有这些权限的帐户。

我更喜欢为应用程序的所有最终用户使用相同的数据库帐户，并在数据库之外实现应用程序角色和权限。

显然，对于用户可以自己注册的网络应用来说，1) 是不切实际的。我有一个拥有 500,000 或更多用户的网站——我想要那么多数据库帐户吗？我不这么认为！

我采取了一种极简主义的方法（我相信很多人会对此提出异议），其中运行应用程序的 db 用户具有运行所需的最低权限，但仅此而已。这意味着 db 用户不能进行模式更改、删除表、恢复数据库等。

在开发过程中使用一个单独的帐户来修改架构，该帐户具有必要的权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T04:12:20.380

我想补充一点，方法 #1 需要创建应用程序用户的代码在可能会混淆权限的数据库帐户下运行。对我来说，这是不必要的风险。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T04:16:59.467

**N 到 1 映射**如此广泛使用的一些原因可能是因为，

1.  在传统的软件开发中，数据库被认为仅仅是一个存储库而不是超越。

2.  程序员将数据库视为一个黑匣子，访问权限被视为一次性活动。

3.  程序员乐于调试代码并解决问题，而不是担心数据库级别的安全角色定义和维护。

4.  在向管理员用户提供“用户/角色维护”屏幕的典型应用程序中，很容易使用 USER、SECURITY_ROLE、USER_SECURITY_ROLE 等表来维护应用程序用户信息，而不是在数据库本身中创建用户、安全条目.

5.  如果业务模型中没有明确定义的角色（双角色、可定制的访问权限等），很容易在应用程序级别而不是在数据库中实现安全性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-16T13:30:46.977

如果您处于应用程序面向 Internet 以及具有更多权限的内部用户的环境中，则选项 2 有一些话要说。

这样，您可以在数据库上以较低特权（就表访问而言）帐户运行面向 Internet 的应用程序服务器，并且内部用户可以访问具有额外访问权限的单独服务器。其优点是即使面向 Internet 的路由被完全破坏，它仍然没有权限来处理内部用户需要访问的表。

如果您的身份验证系统支持委派（例如 Windows 身份验证、Kerberos），选项 1 和 2 会很好地工作 - 因为那时应用程序服务器不需要保存或存储自己的凭据，它可以简单地模拟客户端。这实际上会比选项 3 好得多（因为如果服务器被入侵，攻击者只能使用当前连接用户的权限，他们无法访问整个数据库）。但是，您很少有能力使用此功能。

在通常的 Internet 设置中，3 是唯一现实的选择。

编辑：这些选项都不会阻止您对应用程序层中的业务逻辑进行进一步的访问控制，因此说这是选项 3 的优势是不正确的，正如一些答案所暗示的那样。在所有情况下，应用层仍然知道它的客户是谁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T04:51:46.980

对于大多数应用程序来说，一个似乎是最明智的。＃2对我来说似乎是错误的。在这种情况下，我会有组，用户可以加入一个组。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-07T04:49:35.270

因为数据库角色（按对象、CRUD 等）通常不适用于用户名，除非他们是数据库开发人员。AD 和数据库都有角色，但两者之间存在相同的不匹配。唯一可以防御的映射是管理员角色，但即使这样也很草率。

此问题是由“集成安全”一词引起的常见误解造成的，该术语实际上最终只意味着“单登录”（即用户验证），并且可能在 AD 中创建另一个角色和组群，以便 AD可以为管理员分配数据库安全的责任——通常不是他们训练有素的事情，尽管我确信也有例外。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-16T03:11:43.217

另请参阅[SQL Server/Windows 集成安全性是否适用于任何事情？](https://stackoverflow.com/questions/338535/is-sql-serverwindows-integrated-security-good-for-anything).

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-12-16T03:43:53.917

我不了解 Oracle，但在 SQL Server 中，您希望连接连接，而最好的方法是让单个用户连接。每个不同的用户使用不同的连接字符串，这可能会减慢速度，因为现有的连接不能被池化并重新用于不同的用户。

如果你正在做一个 N teir 应用程序，你的安全逻辑应该放在中间 teir。您不希望每次要检查某人是否具有某个区域的权限时都必须返回数据库。大多数应用程序中的权限通常比数据库安全提供的更具体。

# c# - C# 中的默认类可访问性

> ID：347242
> 
> 赞同：9
> 
> 时间：2008-12-07T04:48:47.797
> 
> 标签：c#, oop

默认情况下是一个类：

1.  私人的 ？
2.  内部的 ？
3.  密封 ？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-07T08:50:43.957

非嵌套类型的默认值是内部的。嵌套类型的默认值是私有的。在这两种情况下，默认值（对于类）都是未密封的。

所有成员的一般规则是，如果您不指定访问修饰符，它会尽可能地私有。唯一的例外是可以通过指定访问修饰符使一部分（即 getter 或 setter）比整体属性更私有的属性，例如

```
public string Foo { get; private set; } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-07T04:52:53.467

内部的

见：http: [//msdn.microsoft.com/en-us/library/ms173121.aspx](http://msdn.microsoft.com/en-us/library/ms173121.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T06:06:46.237

此外，默认情况下它是不密封的。我相信嵌套类默认是私有的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T04:53:11.673

> 没有嵌套到其他类型中的顶级类型只能具有内部或公共可访问性。这些类型的默认可访问性是**internal**。

[MSDN 上的可访问性级别 (C#)](http://msdn.microsoft.com/en-us/library/ba0a1yw2(VS.71).aspx)

# java - 如何在 Java 中以编程方式获取接口的所有实现的列表？

> ID：347248
> 
> 赞同：95
> 
> 时间：2008-12-07T04:52:55.917
> 
> 标签：java, interface

我可以用反射或类似的方法来做吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2015-05-25T21:27:39.390

找了一阵子，好像有不同的方法，总结一下：

1.  如果您不介意添加依赖项，则**[反射库非常受欢迎。](https://github.com/ronmamo/reflections)**它看起来像这样：

    ```
    Reflections reflections = new Reflections("firstdeveloper.examples.reflections");
    Set<Class<? extends Pet>> classes = reflections.getSubTypesOf(Pet.class); 
    ```

2.  **ServiceLoader**（根据埃里克森的回答），它看起来像这样：

    ```
    ServiceLoader<Pet> loader = ServiceLoader.load(Pet.class);
    for (Pet implClass : loader) {
        System.out.println(implClass.getClass().getSimpleName()); // prints Dog, Cat
    } 
    ```

    请注意，要使其正常工作，您需要将其定义`Pet`为 ServiceProviderInterface (SPI) 并声明其实现。您可以通过在其中创建一个`resources/META-INF/services`具有该名称的文件`examples.reflections.Pet`并声明其中的所有实现来`Pet`做到这一点

    ```
    examples.reflections.Dog
    examples.reflections.Cat 
    ```

3.  **包级注释**。这是一个例子：

    ```
    Package[] packages = Package.getPackages();
    for (Package p : packages) {
        MyPackageAnnotation annotation = p.getAnnotation(MyPackageAnnotation.class);
        if (annotation != null) {
            Class<?>[]  implementations = annotation.implementationsOfPet();
            for (Class<?> impl : implementations) {
                System.out.println(impl.getSimpleName());
            }
        }
    } 
    ```

    和注释定义：

    ```
    @Retention(RetentionPolicy.RUNTIME)
    @Target(ElementType.PACKAGE)
    public @interface MyPackageAnnotation {
        Class<?>[] implementationsOfPet() default {};
    } 
    ```

    并且您必须在该包内命名的文件中声明包级注释`package-info.java`。以下是示例内容：

    ```
    @MyPackageAnnotation(implementationsOfPet = {Dog.class, Cat.class})
    package examples.reflections; 
    ```

    请注意，只有当时 ClassLoader 已知的包才会通过调用`Package.getPackages()`.

此外，还有其他基于 URLClassLoader 的方法，这些方法将始终仅限于已加载的类，除非您进行基于目录的搜索。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-07T06:34:10.720

一般来说，这样做很昂贵。要使用反射，必须加载类。如果您想加载类路径上可用的每个类，这将花费时间和内存，因此不建议这样做。

如果你想避免这种情况，你需要实现你自己的类文件解析器，它可以更有效地运行，而不是反射。字节码工程库可能有助于这种方法。

[Service Provider 机制](http://docs.oracle.com/javase/tutorial/sound/SPI-intro.html)是枚举可插入服务实现的常规方法，并且随着 Java 9 中 Project Jigsaw（模块）的引入而变得更加成熟。[`ServiceLoader`](http://java.sun.com/javase/6/docs/api/java/util/ServiceLoader.html)在 Java 6 中使用，或在早期版本中实现您自己的。我在另一个答案中提供[了一个例子。](https://stackoverflow.com/questions/251336/is-something-similar-to-serviceloader-in-java-15#251691)

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-12-07T08:16:55.367

埃里克森说了什么，但如果你仍然想这样做，那么看看[Reflections](https://github.com/ronmamo/reflections)。从他们的页面：

> 使用反射，您可以查询元数据：
> 
> *   获取某种类型的所有子类型
> *   获取所有带有一些注释的类型
> *   获取所有带有一些注解的类型，包括注解参数匹配
> *   获取所有带有一些注释的方法

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2017-08-14T14:21:10.980

Spring 有一个非常简单的方法来实现这一点：

```
public interface ITask {
    void doStuff();
}

@Component
public class MyTask implements ITask {
   public void doStuff(){}
} 
```

然后您可以自动装配类型列表，`ITask`Spring 将使用所有实现填充它：

```
@Service
public class TaskService {

    @Autowired
    private List<ITask> tasks;
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-08-01T04:09:28.770

列出所有实现给定接口的类的最强大的机制目前是[ClassGraph](https://github.com/classgraph/classgraph/wiki/Code-examples)，因为它处理[最广泛的类路径规范机制](https://github.com/classgraph/classgraph/wiki/Classpath-Specification-Mechanisms)，包括新的 JPMS 模块系统。（我是作者。）

```
try (ScanResult scanResult = new ClassGraph().whitelistPackages("x.y.z")
        .enableClassInfo().scan()) {
    for (ClassInfo ci : scanResult.getClassesImplementing("x.y.z.SomeInterface")) {
        foundImplementingClass(ci);  // Do something with the ClassInfo object
    }
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-01-20T15:10:22.137

使用[ClassGraph](https://github.com/classgraph/classgraph/wiki/Code-examples#user-content-find-the-names-of-classes-that-implement-interface-comxyzwidget)非常简单：

用于查找以下实现的 Groovy 代码`my.package.MyInterface`：

```
@Grab('io.github.classgraph:classgraph:4.6.18')
import io.github.classgraph.*
new ClassGraph().enableClassInfo().scan().withCloseable { scanResult ->
    scanResult.getClassesImplementing('my.package.MyInterface').findAll{!it.abstract}*.name
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-07T15:40:00.120

埃里克森说的是最好的。这是一个相关的问答主题 - [http://www.velocityreviews.com/forums/t137693-find-all-implementing-classes-in-classpath.html](http://www.velocityreviews.com/forums/t137693-find-all-implementing-classes-in-classpath.html)

Apache BCEL 库允许您在不加载类的情况下读取它们。我相信它会更快，因为您应该能够跳过验证步骤。使用类加载器加载所有类的另一个问题是您将遭受巨大的内存影响以及无意中运行您可能不想执行的任何静态代码块。

Apache BCEL 库链接 - [http://jakarta.apache.org/bcel/](http://jakarta.apache.org/bcel/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-07T05:02:06.710

是的，第一步是确定您关心的“所有”类。如果您已经拥有此信息，则可以枚举它们中的每一个并使用 instanceof 来验证关系。相关文章在这里：[https ://web.archive.org/web/20100226233915/www.javaworld.com/javaworld/javatips/jw-javatip113.html](https://web.archive.org/web/20100226233915/www.javaworld.com/javaworld/javatips/jw-javatip113.html)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-12-14T15:42:02.803

@kaybee99 答案的新版本，但现在返回用户要求的内容：实现......

Spring 有一个非常简单的方法来实现这一点：

```
public interface ITask {
    void doStuff();
    default ITask getImplementation() {
       return this;
    }

}

@Component
public class MyTask implements ITask {
   public void doStuff(){}
} 
```

然后您可以自动装配类型列表，`ITask`Spring 将使用所有实现填充它：

```
@Service
public class TaskService {

    @Autowired(required = false)
    private List<ITask> tasks;

    if ( tasks != null)
    for (ITask<?> taskImpl: tasks) {
        taskImpl.doStuff();
    }   
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-07T06:20:58.487

此外，如果您正在编写 IDE 插件（您尝试做的事情相对常见），那么 IDE 通常会为您提供更有效的方法来访问用户代码当前状态的类层次结构。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-04-02T19:45:28.663

我遇到了同样的问题。我的解决方案是使用反射来检查 ObjectFactory 类中的所有方法，消除那些不是 createXXX() 方法返回我绑定的 POJO 实例之一的方法。这样发现的每个类都被添加到 Class[] 数组中，然后将其传递给 JAXBContext 实例化调用。这执行得很好，只需要加载无论如何都需要的 ObjectFactory 类。我只需要维护 ObjectFactory 类，该任务可以手动执行（在我的情况下，因为我从 POJO 开始并使用了 schemagen），或者可以根据需要由 xjc 生成。无论哪种方式，它都是高性能、简单且有效的。

# iphone - Cocoa Touch 中的音调生成

> ID：347250
> 
> 赞同：9
> 
> 时间：2008-12-07T04:53:46.103
> 
> 标签：iphone, objective-c, core-audio, signal-processing, piano

我需要产生一种可以操纵频率和波的音调。总体目标是创建一个基本的钢琴。有谁知道我怎么能做到这一点？

我的开发平台是 iPhone 2.x

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-08-08T22:16:02.193

钢琴很奇怪。罗伯特·穆格在 1980 年 3 月的《键盘杂志》上对此进行了报道。基频（最低频率部分）是一致的，但每个高次谐波都比应有的更亮（或“更锐利”或更高音调），而且数量越来越多。

二次到九次谐波比基频更响亮。第十到第二十的声音也差不多。

基本面在数量上膨胀然后下潜，然后又回来了。其他部分具有特有的上下形状。部分交换能量，因此整体体积如您所料。但这是一群交易能量的部分。我猜如果你得到了最低的几个，并且奇怪的不和谐传播正确，你会做得很好。

您可以在软件频谱分析仪中观看操作并了解您需要了解的内容。加法合成可能是我解决这个问题的方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-08T09:56:07.600

你总是可以从`sin`波浪开始。:-)

```
#include <cmath>

typedef double Sample;
typedef double Time;

class MonoNote {
protected:
    Time start, duration;
    virtual void internalRender(double now, Sample *mono) = 0;
public:
    MonoNote(Time s, Time d) : start(s), duration(d) {}
    virtual ~MonoNote() {}
    void render(double now, Sample *mono) {
        if (start <= now && now < start + duration) {
            internalRender(now, mono);
        }
    }
};

class MonoSinNote : public MonoNote {
    Time freq;
    Sample amplitude;
protected:
    void internalRender(double now, Sample *mono) {
        const double v = sin(2*M_PI*(now - start) * freq);
        *mono += amplitude*v;
    }
public:
    MonoSinNote(Time s, Time d, Time f, Sample a) : MonoNote(s, d), freq(f), amplitude(a) {}
    ~MonoSinNote() {}
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-28T07:03:51.637

查看 Mobilesynth...应用商店中的开源合成器：[http ://code.google.com/p/mobilesynth/](http://code.google.com/p/mobilesynth/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-07T15:08:23.333

查看[http://mda.smartelectronix.com/](http://mda.smartelectronix.com/)。它们是一系列开源 VST 插件。查看 Piano、ePiano 或 DX10 的源代码。它就像您将要找到的一样简单。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T10:22:18.777

[Apple 开发者论坛](https://devforums.apple.com/ "苹果开发者论坛")对此有一个主题（“*[音频合成](https://devforums.apple.com/thread/1497 "音频合成")*”），可能会提供一些见解。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-09T10:54:19.443

查看播放正弦波的 DefaultOutputUnit 示例代码。

/Developer/Examples/CoreAudio/SimpleSDK/DefaultOutputUnit

# linux - 记录终端命令

> ID：347254
> 
> 赞同：2
> 
> 时间：2008-12-07T04:58:02.647
> 
> 标签：linux, unix, logging, shell

有没有办法记录（/var/log）用户在 Unix shell 中执行的命令？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-07T05:22:55.390

假设您出于安全目的这样做，请查看流程记帐。您没有说您使用的是哪个 UNIX 变体，但对于 Linux，请查看[http://www.gnu.org/software/acct/](http://www.gnu.org/software/acct/)请注意，您将生成大量数据，因为进程记帐会写入关于每个命令都在系统范围内运行（它是一个内核特性）。您的发行版可能已经有实用程序；在 Debian 中检查 'acct' 包。

如果您只是想记录您所做的事情，以便稍后返回并查看它，脚本（如在另一个答案中）或屏幕（使用 -L）将提供更好的解决方案。但是，它们不适用于安全审计，因为绕过它们很简单：只需运行一个 shell 脚本。此外，行编辑会使文件一团糟。诅咒应用程序（比如文本编辑器）更糟糕。

此外，如果您强迫您的用户通过例如脚本，您可能会捕获信息（例如，电子邮件），您拦截这些信息可能是非法的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-07T10:11:54.353

进程记帐是要走的路，尽管它会占用大量磁盘空间。除非你有一个非常笨拙的盒子，否则我不会继续运行它，但它对于解决问题非常有用，因为它基本上跟踪每个进程，声称更简单的“ps 快照”工具无法匹配。

您基本上打开它，`accton /var/account/pacct`然后内核写入退出的**每个**进程的详细信息，包括：

*   进程名称（不幸的是，不是 args）。
*   开始时间。
*   经过的时间。
*   用户和系统 CPU 时间。
*   退出代码。
*   内存、I/O、故障和交换统计。
*   进程标识。
*   父进程 ID。

和其他一些事情。

你赤身裸体地关闭它，所以你们所有嘲笑 Windows 使用按钮关闭`accton`的人，哈哈！`Start`:-)

可以记录两种记录变体，v1 和 v3 - 确保您使用的是最新的流程会计软件和 v3 记录，因为它们包含更多有用的信息。/usr/include/linux/acct.h 文件显示了您可以从那里得到什么。

这些记录都是固定大小的（无论版本如何）并且易于处理。

我们最近刚刚为我们的性能监控软件完成了一个 Linux 代理——我想趁它还记忆犹新的时候把它记下来。

需要注意的一件事是 comp_t 字段——它们实际上是一种奇怪的指数/尾数类型，用于在 16 位中保存大范围的值——该算法非常简单，可以将其转换为 long：

```
comp_t ct = ?;
long val = (ct & 0x1fff) << (((ct >> 13) & 0x7) * 3); 
```

另一件事是某些值是时钟滴答，而不是秒，所以你必须除以返回的值`sysconf (_SC_CLK_TCK)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T05:18:13.823

我脑子里冒出一个愚蠢的想法：

`script`会将会话复制到文件中。您可以将它发送到正在由日志记录进程读取的命名管道——唯一的事情是，您将获得输出和命令。

# java - 如何在 Ant 中引用 Java Wireless Toolkit 存储根？

> ID：347269
> 
> 赞同：4
> 
> 时间：2008-12-07T05:14:00.820
> 
> 标签：java, ant, java-wireless-toolkit

我正在寻找一种在 Ant 构建文件中自动获取 Java Wireless Toolkit 存储根目录（JWT 存储移动设备模拟器文件系统的目录）的方法。

JWT 是否有存储该路径的属性文件或环境变量？

# c# - 如何以编程方式告诉 Windows 任务栏打开（或关闭）给定的工具栏？

> ID：347274
> 
> 赞同：3
> 
> 时间：2008-12-07T05:18:48.877
> 
> 标签：c#, installation, toolbar, taskbar, deskband

我写了一个在任务[栏](http://osirisdevelopment.com/BatteryBar)上运行的工具栏。不幸的是，安装后，用户必须手动启用它。有没有办法告诉资源管理器打开（或关闭）给定的工具栏？

我希望安装程序 NSIS 在安装完成后打开工具栏（我意识到需要一个插件）。

我还想知道是否可以为所有用户自动启用工具栏，例如在多个用户共享一台 PC 的公司环境中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-03T21:33:04.073

*   [此 CodeProject 注释通过模拟按键来实现](http://www.codeproject.com/KB/atl/rbdeskband.aspx?display=PrintAll&select=1659628#xx1659628xx)
*   Vista+ 具有执行此操作的 API，包括[ShowDeskBand](http://msdn.microsoft.com/en-us/library/bb774485(VS.85).aspx)和[HideDeskBand](http://msdn.microsoft.com/en-us/library/bb774482(VS.85).aspx)
*   编辑：此代码现在可以添加一个桌带对象（来自 Pinvoke.net，以及[这](http://social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/c1f93cbf-f5c5-41ec-a57c-c451bd18f444) [两个](http://social.msdn.microsoft.com/forums/en-US/ieextensiondevelopment/thread/edbfa343-d6aa-43fc-9155-c5f806a65481/)MSDN 论坛问题）：

    ```
    [ComImport]
    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    [Guid("4CF504B0-DE96-11D0-8B3F-00A0C911E8E5")]
    public interface IBandSite
    {
        [PreserveSig]
        uint AddBand([In, MarshalAs(UnmanagedType.IUnknown)] Object pUnkSite);
        [PreserveSig]
        void RemoveBand(uint dwBandID);
    }

    private uint AddDeskbandToTray(Guid Deskband)
    {
        Guid IUnknown = new Guid("{00000000-0000-0000-C000-000000000046}");
        Guid ITrayBand = new Guid("{F60AD0A0-E5E1-45cb-B51A-E15B9F8B2934}");   
        Type TrayBandSiteService = Type.GetTypeFromCLSID(ITrayBand, true);
        IBandSite BandSite = Activator.CreateInstance(TrayBandSiteService) as IBandSite;
        object DeskbandObject = CoCreateInstance(Deskband, null, CLSCTX.CLSCTX_INPROC_SERVER, IUnknown);
        return BandSite.AddBand(DeskbandObject);
    } 
    ```

并且，一个示例使用：

```
Guid address_toolbar_guid = new Guid("{01E04581-4EEE-11D0-BFE9-00AA005B4383}");
uint band_id = AddDeskbandToTray(address_toolbar_guid); 
```

对 RemoveBand 的类似调用也可以解决问题是有道理的，但到目前为止，我还不能让该代码工作。另一个问题：添加的桌带会在添加它的应用程序关闭时关闭。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T20:06:33.033

您可能想[查看这篇文章](http://blogs.msdn.com/oldnewthing/archive/2009/02/02/9388941.aspx)。看起来您只能在 Vista 中使用[ITrayDeskBand 接口](http://msdn.microsoft.com/en-us/library/bb774484%28VS.85%29.aspx)执行此操作（无论如何“官方”） 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T05:50:59.857

我现在找不到确切的 url，但我记得围绕 PDC2008 进行了一些讨论，基本上没有专门启用此功能，因此随机程序无法在未经用户同意的情况下填充任务栏。

这样做的副作用是很少有用户默认启用 WMP 桌面栏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T20:44:29.523

据我了解，任务栏的位置和值等存储在注册表中（忘记了确切的位置），因此如果您找到特定的注册表项，您可以获取它的位置并让您的安装程序在计算机上插入注册表项，以便启用任务栏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T20:45:40.817

不是您问题的真正答案，但请，请：不要**在**.NET 中编写 shell 扩展（并且任务栏是 shell 扩展）！

[这就是为什么](http://blogs.msdn.com/oldnewthing/archive/2006/12/18/1317290.aspx)。

基本上，您正在破坏其他应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-23T17:08:26.167

如果你检查得好，google toolband 存在，而 exe 正在运行（GoogleDesktop.exe），所以如果你坚持 google 或搜索栏的实例化方式，你应该再次检查 TrayBandSiteService 并制作一个支持 exe...

# mysql - 对非常大的数据集进行分页

> ID：347277
> 
> 赞同：3
> 
> 时间：2008-12-07T05:23:13.453
> 
> 标签：mysql, pagination

我在 MySQL 中有一个数据集，其中使用 limit 已经是一个昂贵的查询，并且查找结果的数量也很昂贵。因此，我想避免进行另一个查询来查找结果数。我不能使用 MYSQL_CALC_FOUND_ROWS 因为限制在子查询中：

```
SELECT * FROM items,
(
  SELECT
    item_id
  FROM
    (etc)
  WHERE
    some.field=<parameter>
  AND (etc)
  GROUP BY (something)
  ORDER BY (something_else) DESC
  LIMIT 15
) subset
WHERE item.id=subset.item_id 
```

我可以留下连接项并取消子查询，然后可以使用 MYSQL_CALC_FOUND_ROWS，但这非常非常慢。我已经尝试了所有索引优化，让我们假设它是不可能的。

现在这更像是一个设计问题......**当我不知道最后一页时，如何允许用户翻阅这些数据**？我只知道他们是否走得太远（例如：查询不返回任何结果）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-07T06:00:48.683

以下是 MySQL 大师 Baron Schwartz 的一篇文章的摘要：

[http://www.mysqlperformanceblog.com/2008/09/24/four-ways-to-optimize-paginated-displays/](http://www.mysqlperformanceblog.com/2008/09/24/four-ways-to-optimize-paginated-displays/)

## 优化分页显示的四种方法

1.  在第一个查询中，获取并缓存所有结果。

2.  不要显示所有结果。甚至谷歌也没有让你看到百万分之一的结果。

3.  不要显示总数或到其他页面的中间链接。仅显示“下一个”链接。

4.  估计有多少结果。同样，谷歌这样做了，没有人抱怨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T06:40:48.320

为了强调这一点，“多少”的概念无论如何都是非常短暂的。当答案到达用户手中时，它很容易出错。

# c# - ASP.NET 自定义 404 返回 200 OK 而不是 404 Not Found

> ID：347281
> 
> 赞同：82
> 
> 时间：2008-12-07T05:26:12.900
> 
> 标签：c#, asp.net, master-pages, http-status-code-404, custom-errors

在尝试为 Google 网站管理员工具设置我的网站后，我发现我的自定义 ASP.NET 404 页面没有返回 404 状态代码。它显示了正确的自定义页面并告诉浏览器一切正常。这被认为是软 404 或假 404。谷歌不喜欢这样。所以我找到了很多关于这个问题的文章，但我想要的解决方案似乎不起作用。

我想要工作的解决方案是将以下两行添加到自定义 404 页面的 Page_Load 方法后面的代码中。

```
Response.Status = "404 Not Found";
Response.StatusCode = 404; 
```

这行不通。页面仍然返回 200 OK。然而，我发现如果我将以下代码硬编码到设计代码中，它将正常工作。

```
<asp:Content ID="ContentMain" ContentPlaceHolderID="ContentPlaceHolderMaster" runat="server">

<%
    Response.Status = "404 Not Found";
    Response.StatusCode = 404;
%>

 ... Much more code ...

</asp:content> 
```

该页面正在使用母版页。我正在我的 web.config 中配置自定义错误页面。我真的更愿意使用选项后面的代码，但如果不将 hack 内联代码放入设计/布局中，我似乎无法使其工作。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-12-07T06:13:07.753

**解决方案：**

事实证明，问题在于母版页的使用。我通过在页面生命周期的后期设置状态码让它工作，显然母版页的渲染正在重置它，所以我覆盖了渲染方法并在渲染完成后设置它。

```
protected override void Render(HtmlTextWriter writer)
{
    base.Render(writer);
    Response.StatusCode = 404;
} 
```

可以做更多的工作来确定母版页设置状态的确切时间，但我将把它留给你。

* * *

**原帖：**

我能够让测试网络应用程序正常工作，它至少显示了自定义错误页面并返回了 404 状态代码。我不能告诉你你的应用出了什么问题，但我可以告诉你我做了什么：

1) 为自定义错误编辑 web.config：

> ```
> <customErrors mode="On">
>   <error statusCode="404" redirect="404.aspx"/>
> </customErrors> 
> ```

2）添加了404.aspx页面，设置状态码为404。

> ```
> public partial class _04 : System.Web.UI.Page
> {
>     protected void Page_Load(object sender, EventArgs e)
>     {
>         Response.StatusCode = 404;
>     }
> } 
> ```

就是这样，如果我转到任何由 Asp.Net 处理且不存在的页面扩展，我的提琴手日志清楚地显示 404，这是标题：

> ```
> HTTP/1.1 404 Not Found
> Server: Microsoft-IIS/5.1
> Date: Sun, 07 Dec 2008 06:04:13 GMT
> X-Powered-By: ASP.NET
> X-AspNet-Version: 2.0.50727
> Cache-Control: private
> Content-Type: text/html; charset=utf-8
> Content-Length: 533 
> ```

现在，如果我转到一个未经 Asp.Net 处理的页面，例如 htm 文件，则不会显示自定义页面，而是显示 IIS 配置的 404。

这是一篇文章，其中介绍了可能对您和您的问题有用的更多细节，我的测试确实重定向到新页面，因此所请求文件的 url 几乎丢失了（除了它在查询字符串中） .

[Google 404 和 .NET 自定义错误页面](https://stackoverflow.com/questions/152307/google-404-and-net-custom-error-pages)

**标头间谍响应：**

```
HTTP/1.1 404 Not Found
Date: Sun, 07 Dec 2008 06:21:20 GMT 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2010-06-22T23:28:31.643

我有一个类似的问题，我想将自定义页面显示为 404（即 ASPX），它在 localhost 上运行良好，但只要远程访问者连接，他们就会得到通用的 IIS 404。

解决方案是添加

```
Response.TrySkipIisCustomErrors = true; 
```

在更改 Response.StatusCode 之前。

通过 Rick Strahl 找到[http://www.west-wind.com/weblog/posts/745738.aspx](http://www.west-wind.com/weblog/posts/745738.aspx)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-09-22T00:06:05.943

尝试调用 Response.End() 跳过渲染...

```
Response.Status = "404 Not Found";
Response.StatusCode = 404;
Response.End();
return; 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-04-03T08:05:06.000

IIS 7 解决方案是将其添加到您的 web.config 文件中：

```
<system.webServer>
  <httpErrors existingResponse="Replace">
    <remove statusCode="500" subStatusCode="-1" />
    <remove statusCode="404" subStatusCode="-1" />
    <error statusCode="404" prefixLanguageFilePath="" path="404.htm" responseMode="File" />
    <error statusCode="500" prefixLanguageFilePath="" path="500.htm" responseMode="File" />
  </httpErrors>
</system.webServer> 
```

[http://forums.asp.net/t/1563128.aspx/1](http://forums.asp.net/t/1563128.aspx/1)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-08T01:54:36.883

经过大量测试和故障排除后，某些托管服务提供商似乎会干扰返回代码。我能够通过在内容中应用“hack”来解决这个问题。

```
<%
// This code is required for host that do special 404 handling...
Response.Status = "404 Not Found";
Response.StatusCode = 404;
%> 
```

这将允许页面无论如何返回正确的返回码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-20T17:32:55.207

通过使用 .NET 3.5 在 asp.net webforms 中使用以下设置，我能够解决此问题。

我实现的模式绕过了 web.config 中 .NET 的自定义重定向解决方案，因为我编写了自己的模式来处理标题中包含正确 HTTP 状态代码的所有场景。

首先，web.config 的 customErrors 部分如下所示：

```
<customErrors mode="RemoteOnly" defaultRedirect="~/error.htm" /> 
```

此设置可确保将 CustomErrors 模式设置为 on，这是我们稍后需要的设置，并为 error.htm 的 defaultRedirect 提供了一个 all-else-fails 选项。当我没有针对特定错误的处理程序时，这将派上用场，或者数据库连接中断。

其次，这是全局 asax 错误事件：

```
protected void Application_Error(object sender, EventArgs e)
    {
       HandleError();
    }

    private void HandleError()
    {
        var exception = Server.GetLastError();
        if (exception == null) return;

        var baseException = exception.GetBaseException();

        bool errorHandled = _applicationErrorHandler.HandleError(baseException);
        if (!errorHandled) return;

        var lastError = Server.GetLastError();
    if (null != lastError && HttpContext.Current.IsCustomErrorEnabled)
    {
        Elmah.ErrorSignal.FromCurrentContext().Raise(lastError.GetBaseException());
        Server.ClearError();
    }
    } 
```

此代码将处理错误的责任转交给另一个类。如果错误没有得到处理并且 CustomErrors 被打开，这意味着我们有一个案例，我们正在生产中并且不知何故没有处理错误。我们将在此处清除它以防止用户看到它，但将其登录到 Elmah 以便我们知道发生了什么。

applicationErrorHandler 类如下所示：

```
public bool HandleError(Exception exception)
        {
            if (exception == null) return false;

            var baseException = exception.GetBaseException();

            Elmah.ErrorSignal.FromCurrentContext().Raise(baseException);

            if (!HttpContext.Current.IsCustomErrorEnabled) return false;

            try
            {

                var behavior = _responseBehaviorFactory.GetBehavior(exception);
                if (behavior != null)
                {
                    behavior.ExecuteRedirect();
                    return true;
                }
            }
            catch (Exception ex)
            {
                Elmah.ErrorSignal.FromCurrentContext().Raise(ex);
            }
            return false;
        } 
```

此类本质上使用命令模式来为发出的错误类型定位适当的错误处理程序。在此级别使用 Exception.GetBaseException() 很重要，因为几乎每个错误都将包装在更高级别的异常中。例如，从任何 aspx 页面执行“throw new System.Exception()”将导致在此级别收到 HttpUnhandledException，而不是 System.Exception。

“工厂”代码很简单，如下所示：

```
public ResponseBehaviorFactory()
    {
        _behaviors = new Dictionary<Type, Func<IResponseBehavior>>
                        {
                            {typeof(StoreException), () => new Found302StoreResponseBehavior()},
                            {typeof(HttpUnhandledException), () => new HttpExceptionResponseBehavior()},
                            {typeof(HttpException), () => new HttpExceptionResponseBehavior()},
                            {typeof(Exception), () => new Found302DefaultResponseBehavior()}
                        };
    }

    public IResponseBehavior GetBehavior(Exception exception)
    {                                                                               
        if (exception == null) throw new ArgumentNullException("exception");

        Func<IResponseBehavior> behavior;
        bool tryGetValue = _behaviors.TryGetValue(exception.GetType(), out behavior);

        //default value here:
        if (!tryGetValue)
            _behaviors.TryGetValue(typeof(Exception), out behavior);

        if (behavior == null)
            Elmah.ErrorSignal.FromCurrentContext().Raise(
                new Exception(
                    "Danger! No Behavior defined for this Exception, therefore the user might have received a yellow screen of death!",
                    exception));
        return behavior();
    } 
```

最后，我有了一个可扩展的错误处理方案设置。在定义的每一个“行为”中，我都有一个错误类型的自定义实现。例如，将检查 Http 异常的状态代码并进行适当处理。404 状态代码将需要 Server.Transfer 而不是 Request.Redirect，以及在标头中写入的适当状态代码。

希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-27T08:54:36.867

您可以使用以下代码：

```
 Response.TrySkipIisCustomErrors = True
 Response.Status = "404 Not Found"
 Response.AddHeader("Location", "{your-path-to-your-404-page}") 
```

# ruby-on-rails - 有哪些文件可以在其中包含 OS X 终端的 PATH 声明？

> ID：347286
> 
> 赞同：6
> 
> 时间：2008-12-07T05:30:42.533
> 
> 标签：ruby-on-rails, macos, sysadmin

所以我在 OS X Leopard 上遇到了路径问题。似乎 OS X 正在添加我没有说明的其他路径，并且它扰乱了我的路径优先级。我只有一个`.bash_login`文件，我没有一个`.bashrc`或 .profile 文件。我的`.bash_login`文件是这样的：

```
export PATH="/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:$PATH" 
```

当我运行导出时，这是它返回的路径：

```
PATH="/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/opt/local/bin:/usr/local/git/bin" 
```

关于可以将 /usr/bin 放在那里以及如何获得`/usr/local/bin`更高优先级的任何想法。

我也为 Rails 标记了这个，因为这就是我现在正在做的事情......似乎 Mac 内置的 Ruby、Rails 和 Gems 优先于我安装的那个`/usr/local/bin`，也许你们是 Rubyists也可以提供帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-07T05:48:10.407

你有没有看过这两个目录：

```
/etc/paths.d/
/etc/manpaths.d 
```

在这些目录中的文件中定义的任何路径都会自动附加到 PATH 变量中——我主要使用这两个目录将第三方安装的应用程序放在 PATH 中。另外，请查看`path_helper`OS X 上的手册页。

**编辑**：查看 的内容`/etc/profile`，我可以看到它`path_helper`是首先执行的。手册页`path_helper`说，在读取`/etc/paths.d/`和`/etc/manpaths.d/`目录`path_helper`中的文件之前，读取并设置文件`/etc/paths`和`/etc/manpaths`. 一看就`/etc/paths`知道了：

```
$ cat /etc/paths
/usr/bin
/bin
/usr/sbin
/sbin
/usr/local/bin 
```

而且，我相信，这些占您在 PATH 中看到的内容的一半。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-07T05:41:51.373

您的更改似乎未应用。注意没有 /usr/local/mysql/bin

阅读 INVOCATION 上的 bash 手册页部分，.bash_login 仅在它是登录 shell 时才被读取——终端 shell 不是。您需要将其放入 ~/.bashrc 中。它将在登录和非登录 shell 中读取。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-14T10:44:18.980

您还可以将内容放入 ~/.MacOSX/Environment.plist，详见[https://web.archive.org/web/20150330034300/http://www.astro.washington.edu/users/rowen/AquaEnvVar。 html](https://web.archive.org/web/20150330034300/http://www.astro.washington.edu/users/rowen/AquaEnvVar.html)

这将使环境变量可用于所有应用程序，而不仅仅是那些通过终端 (bash) 会话启动的应用程序。

（现在似乎也有更好的建议）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T06:52:16.987

我还在 Apple 的支持论坛上看到了一篇有趣的文章：

[.bash_login 不再执行](http://discussions.apple.com/thread.jspa?messageID=7976259&tstart=0)

有了这些信息，我发现一个被忽略的空白 .bash_profile 文件正在加载 - 并杀死了我试图在我的路径中设置的所有信息。

所以我想看起来我们可以根据情况有几个“正确”的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-28T17:10:49.627

只需输入 .bashrc 或 .login 就可以了

# window - 无法按“X”或关闭窗口应用程序右上角的底部

> ID：347289
> 
> 赞同：2
> 
> 时间：2008-12-07T05:33:07.223
> 
> 标签：window, sdl

我正在试验 SDL Events，但遇到了问题。出于某种原因，我无法按窗口应用程序右上角的“X”或关闭底部。现在我不确定这是否与 SDL 编码有关，或者是窗口浏览器的问题。

有谁知道这是 SDL 问题还是 Window 问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-07T13:43:58.153

听起来您没有处理 SDL_QUIT 事件。轮询 SDL 事件队列后，您将需要处理 SDL_QUIT 事件以及其他键盘输入等。

# flash - adding alpha values to bilinear resizing algorithm

> ID：347294
> 
> 赞同：3
> 
> 时间：2008-12-07T05:51:27.890
> 
> 标签：flash, actionscript-3, image, resize, interpolation

So I'm trying to take a bilinear interpolation algorithm for resizing images and add in alpha values as well. I'm using Actionscript 3 to do this, but I don't really think the language is relevant.

The code I have below actually works really well, but edges around "erased" regions seem to get darker. Is there an easy way for it to not include what I can only assume is black (0x00000000) when it's finding its average?

Code:

```
x_ratio = theX - x;
y_ratio = theY - y;
x_opposite = 1 - x_ratio;
y_opposite = 1 - y_ratio;

a = getPixel32(x, y);
be =getPixel32(x + 1, y);
c = getPixel32(x, y + 1);
d = getPixel32(x + 1, y + 1);
alph    = (t(a)  * x_opposite  + t(be)   * x_ratio) * y_opposite + (t(c) * x_opposite  + t(d) * x_ratio) * y_ratio;
red     = (r(a)  * x_opposite  + r(be)   * x_ratio) * y_opposite + (r(c) * x_opposite  + r(d) * x_ratio) * y_ratio;
green   = (g(a)  * x_opposite  + g(be)   * x_ratio) * y_opposite + (g(c) * x_opposite  + g(d) * x_ratio) * y_ratio;
blue    = (b(a)  * x_opposite  + b(be)   * x_ratio) * y_opposite + (b(c) * x_opposite  + b(d) * x_ratio) * y_ratio; 
```

Image of the effect: [http://beta.shinyhammer.com/images/site/eraser_pixelborders.jpg](http://beta.shinyhammer.com/images/site/eraser_pixelborders.jpg)

**Posting code of solution!**

```
a = getPixel32(x, y);
be =getPixel32(x + 1, y);
c = getPixel32(x, y + 1);
d = getPixel32(x + 1, y + 1);
asum = (t(a) + t(be) + t(c) + t(d)) / 4;

alph    = (t(a)  * x_opposite  + t(be)   * x_ratio) * y_opposite + (t(c) * x_opposite  + t(d) * x_ratio) * y_ratio;
red     = ((r(a) * t(a) * x_opposite  + r(be) * t(be) * x_ratio) * y_opposite + (r(c) * t(c) * x_opposite  + r(d) * t(d) * x_ratio) * y_ratio);
red = (asum > 0) ? red / asum : 0;
green   = ((g(a) * t(a) * x_opposite  + g(be) * t(be) * x_ratio) * y_opposite + (g(c) * t(c) * x_opposite  + g(d) * t(d) * x_ratio) * y_ratio);
green = (asum > 0) ? green /  asum : 0;
blue    = ((b(a) * t(a) * x_opposite  + b(be) * t(be) * x_ratio) * y_opposite + (b(c) * t(c) * x_opposite  + b(d) * t(d) * x_ratio) * y_ratio);
blue = (asum > 0) ? blue / asum : 0; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-07T08:14:35.837

You need to multiply each of your r,g,b values by the corresponding alpha before working with them, then divide the values by the final alpha when you're done. It's easy to imagine the effect this will have when one of the pixels has an alpha of zero - each of the r,g,b values will be multiplied by zero, so it won't matter what their original values are at all! They won't contribute to the final result.

You'll need to add a check so that you never divide by zero, and make sure that roundoff error doesn't push your final values past the upper limit.

Often images will be stored in memory with the alpha already multiplied into the r,g,b values - this is called premultiplied alpha ([Wikipedia reference](http://en.wikipedia.org/wiki/Alpha_compositing)).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-07T10:24:01.490

This is one of those areas where the use of pre-multiplied alpha is a huge advantage. With pre-multiplied alpha, you can think of the RGB components of your image as having been pre-composited on black in advance.

This removes many of the troublesome effects associated with any kind of image processing on images with alpha, as well as giving a faster compositing algorithm.

For "non-pre-multiplied alpha", the familiar LIRP (linear interpolation) compositing algorithm is

```
d = Kf + (1-K)b 
```

... where K is the alpha of the foreground, f is the foreground value and b is the background.

For "pre-multiplied alpha", you use

```
d = f + (1-K)b 
```

... which removes one of the multiplies, which can make the process faster (and cheaper in hardware). The key paper to read is Porter and [Duff](http://en.wikipedia.org/wiki/Tom_Duff)'s - ["Compositing Digital Images"](http://portal.acm.org/citation.cfm?doid=800031.808606)

If you're using Windows, the Win32 [AlphaBlend](http://msdn.microsoft.com/en-us/library/ms532324(VS.85).aspx) function requires premultiplied alpha, so it's good to stay in the premultiplied domain whenever possible.

# c++ - OpenMPI：所有节点都作为节点 0 运行

> ID：347298
> 
> 赞同：7
> 
> 时间：2008-12-07T05:54:30.177
> 
> 标签：c++, linux, mpi

我有一个使用 openMPI 库在不同处理器之间传递消息的 c++ 程序。它是一个并行程序，它使用遗传算法为旅行商问题找到一个很好的解决方案。我正在尝试在我家的两台双处理器计算机上设置 MPI 环境，以便我可以运行它。一年前我第一次创建这个程序时，我能够在不是我设置的集群上正常运行它。我现在遇到的问题是，每当我运行它时，所有进程都说它们的等级为 0。如果我有 3 个节点，而不是节点 1、2 和 3，它们都是节点 0。如果有人知道发生了什么，我肯定会感谢一些帮助。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T02:30:50.367

我发现了问题所在。我安装了两个使用 mpirun 命令的软件包。我相信它是 openmpi 和 mpich 包。我删除了openmpi，它起作用了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T08:28:42.127

也许您的初始化是错误的，或者您在检查排名时遇到了一些错误。这应该是正确的方法：

```
MPI_Init(&argc, &argv);
MPI_Comm_size(MPI_COMM_WORLD, &size);
MPI_Comm_rank(MPI_COMM_WORLD, &rank);
printf("I am process %d of %d.\n", rank, size); 
```

但我认为你做对了，所以我同意 Harleqin，显示你使用的命令/脚本会很有帮助。

# database - 直接更新数据库中的值或删除 - 再次添加它们

> ID：347306
> 
> 赞同：1
> 
> 时间：2008-12-07T06:16:18.370
> 
> 标签：database

每当我们必须更新数据库时；我们首先从表中删除值，然后添加最新值。这可确保所有内容都正确更新。

这给系统增加了一点开销，但我们没有因此遇到任何性能问题。

这总是最好的做法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T06:20:09.313

不。

使用 UPDATE 语句。

此外，如果您担心完整性，请将其限定在事务中：

```
BEGIN TRAN T1

-- This update is part of T1
UPDATE Table1 SET Col1='New Value' WHERE Col2 = @Id;

-- Time to commit your changes. 
-- If for any reason something fails, 
-- everything gets rolled back
COMMIT TRAN T1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T06:21:24.007

不。

如果表已编入索引（大多数都已编入索引），但您**没有**运行常规的索引维护任务来重建（碎片整理）索引，则更可取的是更新。随着时间的推移，删除和重新创建行会导致碎片化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T06:24:29.383

否则一切都**没有**正确更新怎么办？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T06:24:18.527

我认为“数据库”是指 SQL 数据库。执行`delete`then的危险`insert`是，除非您对交易非常小心，否则它是非原子的。在删除行和插入新行之间的时间里，有人可能会滑过类似的行，导致`insert`在某些约束上失败。`update`正如 J. Holland 指出的那样，这也是一种浪费，因为存在。这一切都会一口气完成。将其单独放在自己的事务中可能是不必要的，因为更新是原子的。

如果您因为不确定该行是否已存在而执行 delete-then-insert，则某些数据库有一个`replace`语句，如果没有行将插入，如果有则更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T07:25:41.520

正如其他人所说，使用 UPDATE。

一个额外的原因：如果您在任何参照完整性约束上都有 CASCADE DELETE，则 DELETE 然后 INSERT 会丢失从属数据。如果您没有 CASCADE DELETE，那么您可能无法删除该记录，因为它仍然被其他表引用。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-08T14:14:38.653

删除插入是比更新成本更高的操作。

如果原因不明显，那是因为您必须存储要删除的完整行的撤消/重做信息，包括所有索引条目的修改以及删除导致的引用完整性违规检查，然后插入新的包含所有撤消/重做、索引条目、完整性检查等的行。新行也可能位于与删除不同的块中，因此现在您将（至少）物理 i/o 要求加倍。

还要考虑对触发器和日志记录的影响。当您可以授予更新权限时，您必须授予插入和删除权限。

我确信有一个常规的编程范式，例如“当我想为一个变量分配一个新值时，我总是先将它设置为零......”但我担心它不会传达完整的恐怖的情况。

# fortran - FORTRAN 问题

> ID：347311
> 
> 赞同：1
> 
> 时间：2008-12-07T06:19:37.787
> 
> 标签：fortran

在 Fortran 中需要帮助...

这是程序的主循环..

```
do iStep=0,nStep
    write(7,*)iStep

    !* Compute new temperature using FTCS scheme.
    do i=1,N
        if( istep==0) then  !only for t=0
            tt_new(i)=250
    write(7,*)tt_new(i)
        else
            if(i==1) then
                tt_new(i)=2*coeff*(tt(i+1)+35.494)-0.036*tt(i)
                write(7,*)tt(i)
            else 
                if(i==N) then
                    tt_new(i)=2*coeff*(tt(i-1)+35.494)-0.036*tt(i)
                    write(7,*)tt(i)
                else           
                    tt_new(i) = coeff*(tt(i+1) + tt(i-1)+33.333)+(1 - 2*coeff)*tt(i)
                    write (7,*) tt_new(i)
                end if
            end if
        end if     
    end do

    do i=1,N
        tt(i) = tt_new(i)     ! Reset temperature to new values
    enddo
end do 
```

这是输出....

```
0
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
2.5000000E+02
1
2.5000000E+02     <--
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.6666650E+02
2.5000000E+02   <-- 
```

如您所见...程序不计算第一个和最后一个节点的值...您能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T07:08:17.143

对于`i=1`and `i=N`，您正在打印`tt(i)`而不是`tt_new(i)`- 计算正在正确执行，但结果将无法正确显示。在这种情况下，使用调试器单步执行代码非常有帮助。

我还建议重组你的`if`陈述，但我不会走得太远[gimel](https://stackoverflow.com/questions/347311/fortran-problem#347331) - 我认为意图会更清楚

```
if (iStep == 0) then
    ! Perform actions for time 0
else
    ! Perform actions for time > 0
    if (i == 1) then
        ! Perform actions for first endpoint
    else if (i == N) then
        ! Perform actions for last endpoint
    else
        ! Perform actions for midsection
    end if
end if 
```

因为您有两种特殊情况 - 空间约束（如何以不同方式处理端点）和时间约束（如何处理初始条件）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T06:47:04.547

`IF ELSE`尝试以更易读的方式格式化你的内心：

```
if( istep==0) then  !only for t=0
    tt_new(i)=250
    write(7,*)tt_new(i)
else if(i==1) then
    tt_new(i)=2*coeff*(tt(i+1)+35.494)-0.036*tt(i)
    write(7,*)tt(i)
else if(i==N) then
    tt_new(i)=2*coeff*(tt(i-1)+35.494)-0.036*tt(i)
    write(7,*)tt(i)
else           
    tt_new(i) = coeff*(tt(i+1) + tt(i-1)+33.333)+(1 - 2*coeff)*tt(i)
    write (7,*) tt_new(i)

end if
end if //redundant
end if //redundant 
```

这样，您会看到只有一个`END IF`是必需的，因为前导`IF`（或`ELSE IF`）子句被匹配关闭`ELSE`。

（**编辑：**问题中的前 2 行代码显示正常 - 感谢 Jonathan Leffler。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-07T07:22:30.110

Tim Whitcomb 和 gimel 给出了很好的答案。不过，您应该更多地修改您的代码 - 因为不需要使用多个 write 语句（或空行或额外的 END IF 语句）。

```
if (istep==0) then  !only for t=0
    tt_new(i)=250
else if (i==1) then
    tt_new(i) = 2*coeff*(tt(i+1)+35.494)-0.036*tt(i)
else if (i==N) then
    tt_new(i) = 2*coeff*(tt(i-1)+35.494)-0.036*tt(i)
else           
    tt_new(i) = coeff*(tt(i+1) + tt(i-1)+33.333)+(1 - 2*coeff)*tt(i)
end if
write(7,*)tt_new(i) 
```

如果是我的代码，我也会更自由地使用行间距。

# algorithm - 需要有关如何使用霍夫曼代码对单词进行编码的帮助

> ID：347316
> 
> 赞同：3
> 
> 时间：2008-12-07T06:23:16.703
> 
> 标签：algorithm, encoding, compression, huffman-code

您如何使用霍夫曼代码（例如 NEED）对单词进行编码

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T07:06:09.923

霍夫曼编码基本上使用可变长度的位串来表示标记（通常是字符，但有几个例外）。令牌越常见，它的位长就越短，这（通常）在处理流时是动态的。

通常有两种特殊标记，ESCAPE 和 END-STREAM。

编码维护一个字典，它基本上是查找位序列以获取令牌。最初它只包含两个特殊标记。

ESCAPE 和 END_STREAM 的初始位序列可以是 0 和 1（这在开始时并不重要）。当编码器接收到一个不在字典中的字符时，它会输出 ESCAPE 和全长标记，然后根据所有标记的频率添加它并分配新的位序列。

所以你的'N'可能会导致输出流：

```
0 xxxxxxxx
| +- token code for N
+--- ESCAPE 
```

和新字典：

```
ESCAPE:00
END-STREAM:01
N:1 
```

那么你的'E'可能会导致输出流：

```
0 xxxxxxxx 0 yyyyyyyy
             +- token code for E 
```

和新字典：

```
ESCAPE:00
END-STREAM:01
N:10
E:11 
```

您的下一个 E 不会导致 ESCAPE 输出，因为它已经在字典中，因此您只需输出其代码 (11)。它将改变字典，因为 E 现在有更高的计数。这在我们的情况下无关紧要，因为所有字符都是两个二进制数字，但是在更复杂的示例中，“E”标记的位长度会缩短。

当 D 到达时，输出流变为：

```
0 xxxxxxxx 0 yyyyyyyy 11 0 zzzzzzzz
                      |    +- token code for D
                      +------ second E 
```

和新字典：

```
ESCAPE:00
END-STREAM:011
N:010
E:11
D:10 
```

因此，您可以看到，随着更多字符的输入，常见字符的位长度会减少，而不常见字符的位长度会增加，从而为您提供压缩。在这种情况下，N（或 D）得到一个 3 位数的代码，而 E 坚持使用 2 位数的代码，因为它们的数量更多。

美妙之处在于您不需要将字典与文件一起存储，因为 ESCAPE 部分也动态构建它以进行解压缩。

此外，因为直到最后都没有 END-STREAM 令牌，所以它的位长越来越大。ESCAPE 与此类似，虽然仍有许多新字符进入，但它的位长保持较短，但当没有新字符到来时，它会遭受与 END-STREAM 相同的命运。

（8 位 ASCII）输入流的最佳情况是一个只包含数百万个相同字符的文件。第一个字符需要 9 位，然后每个附加字符需要 1 位，然后流结束需要 2 位。该速度接近 8 比 1 的压缩率 (97.5%)。

最坏的情况是每个字符中的一个，每个字符花费 9 位加上流的结尾——这实际上将流扩展了 12.5%。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T06:33:58.443

我想你的意思是[霍夫曼编码](https://secure.wikimedia.org/wikipedia/en/wiki/Huffman_encoding)。这是一种无损压缩数据的算法。简而言之，您将最长和最重复的连续数据位替换为尽可能小的表示形式（这是大多数压缩的工作方式）。例如，一个 HTML 页面可能会将非常常见`<DIV`的二进制数分配给二进制数`01`，将每一个的 32 位减少`<DIV`到仅 2 位。

这是基本的想法。另一个技巧是如何选择数字，这样您就不需要使用固定大小或分隔符。这是使用[Huffman Tree](https://secure.wikimedia.org/wikipedia/en/wiki/Huffman_encoding#Basic_technique)完成的。阅读维基百科文章了解更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T06:56:34.200

看看[Huffman Coding with F#](http://blogs.msdn.com/lukeh/archive/2008/05/05/huffman-coding-with-f.aspx)，这是一篇介绍用 F# 编写的 Huffman 编码器/解码器的博客文章。它简短而清晰。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-22T19:38:07.143

看看我的 Huffman in C# 项目：[https ://github.com/kad0xf/HuffmanSharp](https://github.com/kad0xf/HuffmanSharp)

# gwt - 关于 GWT 和 GWT-Ext 中的延迟加载的信息

> ID：347319
> 
> 赞同：3
> 
> 时间：2008-12-07T06:28:00.950
> 
> 标签：gwt, gwt-ext

我在哪里可以找到有关 GWT 和 GWT-Ext 延迟加载的更多信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T07:42:39.257

快速谷歌搜索显示 GWT 团队的一篇[不错的博客条目](http://googlewebtoolkit.blogspot.com/2008/11/improving-performance-with-on-demand.html)。

关于 GWT-Ext，我不能说什么，但无论技术如何，相同的基本技术都可以工作。

GWT 未来版本的另一种可能性是“runAsync”。查看[GWT Web Toolkit Contributors 邮件列表](http://groups.google.com/group/Google-Web-Toolkit-Contributors)，其中有一些关于此主题的不同帖子，包括[这个](http://groups.google.com/group/Google-Web-Toolkit-Contributors/browse_thread/thread/eb9c8cf046cbaaf2)。基本上，这将让您将您的网络应用程序分成多个独立的“部分”，并按需下载它们。

# file - Groovy 中的安全文件下载

> ID：347325
> 
> 赞同：3
> 
> 时间：2008-12-07T06:36:32.667
> 
> 标签：file, groovy, download

我需要从安全的 Web 位置将文件放入我的应用程序的内存中。我有要捕获的文件的 URL，但似乎无法解决安全问题。以下是[Cookbook 示例页面](http://groovy.codehaus.org/Simple+file+download+from+URL)中的代码：

```
def download(address)
{
    def file = new FileOutputStream(address.tokenize("/")[-1])
    def out = new BufferedOutputStream(file)
    out << new URL(address).openStream()
    out.close()
} 
```

这是我的同一函数的“内存”版本，它应该返回文件内容的字节数组：

```
def downloadIntoMem(address)
{  // btw, how frickin powerful is Groovy to do this in 3 lines (or less)
        def out = new ByteArrayOutputStream()
        out << new URL(address).openStream()
        out.toByteArray()
} 
```

当我对不安全的 URL 尝试此操作时（选择您可以在网上找到的任何图像文件），它工作得很好。但是，如果我选择一个需要用户/密码的 URL，那就不行了。

好吧，在这方面做更多的工作。Authenticator 方法**似乎确实**有效，但是以一种迂回的方式。第一次访问该 URL 时，我收到一个 302 响应，其中包含登录服务器的位置。如果我使用 Authenticator 集访问该位置，那么我会得到另一个带有 Cookie 的 302，并且该位置设置回原始 URL。如果我然后访问原始文件，则下载会正确进行。

所以，我必须稍微模仿一下浏览器，但最终一切正常。

将此作为社区 wiki，以便其他人可以添加其他方法。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-02-28T01:48:08.947

如果 url 上的 creds 不起作用，您可以使用它。它适用于基本身份验证。

```
new File(localPath).withOutputStream { out ->
    def url = new URL(remoteUrl).openConnection()
    def remoteAuth = "Basic " + "${user}:${passwd}".bytes.encodeBase64()
    url.setRequestProperty("Authorization", remoteAuth);
    out << url.inputStream
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T08:52:24.997

根据服务器的身份验证类型，您可以将凭据放在 url 本身上：

```
def address = "http://admin:sekr1t@myhost.com"
def url = new URL(address)
assert "admin:sekr1t" == url.userInfo 
```

如果您没有通过代理，则您不想执行您所指的代理。它不适用。

# objective-c - 真的需要在程序退出时释放对象吗？

> ID：347338
> 
> 赞同：14
> 
> 时间：2008-12-07T07:02:09.197
> 
> 标签：objective-c, cocoa, cocoa-touch

是否需要在程序退出/关闭时释放对象？

换句话说，为了争论，你有一个关闭你的应用程序的按钮，但在你关闭之前你会显示一个图像，然后你关闭应用程序。

您是否需要在关闭应用程序之前释放该图像视图？程序退出时内存是否会自动释放，或者如果您不释放它，内存会以某种方式保持“活动”状态？

我知道你“应该”发布它，我的问题是关于它的技术方面，以及幕后发生的事情。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-07T07:21:59.143

这不是必需的。但是，如果你正在使用`valgrind`或类似的工具，你很快就会发现，让你所有的记忆悬而未决会让你陷入虚假警告。

在 Linux 方面，堆是使用`sbrk`系统调用增长的。这一次将整个处理器内存空间增加一个大块（因此只需要一个就可以为许多s`sbrk`提供足够的空间）。`malloc`当进程消失时，内核会回收所有由`sbrk`. 这就是你安全的原因。内核还将关闭该进程打开的所有文件描述符。

可能会出现一些问题。如果您的进程出现`fork`在不合时宜的时刻，任何打开的文件描述符都将被复制。我已经看到这表现为原始进程死亡后神秘地挂起的 TCP 连接，这很*讨厌*。此外，还有其他资源不是进程范围的，因此当进程终止时它们不会被回收。这包括共享内存段、临时文件、命名管道和 UNIX 套接字，可能还有许多其他 IPC 机制。

总之？记忆力很好。文件描述符通常很好。如果不清理，一些更深奥的 IPC 功能将被严重破坏。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-07T16:25:25.333

在 iPhone 上，你不需要，据我所知，你不能。收到 applicationWillTerminate: 您有几秒钟的时间来保存您的状态，然后操作系统会终止您的进程。构建一个示例应用程序并在其中一个 dealloc 方法中放置一个断点。他们永远不会受到打击。

这是一个关于它的巨大论点：[链接文本](http://www.cocoadev.com/index.pl?DeallocNotGettingCalled)

注意：Objective C dealloc 与 C++ Deconstructor 不同。在 Deconstructor 中，您可以关闭文件、句柄等。在 Objective C 中，dealloc 仅用于释放内存。您必须提前关闭其他资源，因为可能永远不会调用 dealloc。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T16:03:47.967

确实没有必要，但是如果您可能想回收一些源代码并在另一个程序中使用它，您可能会遇到内存泄漏。此外，永远不要认为操作系统没有任何错误。它可能会“忘记”释放一些资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-14T02:45:28.450

发布可以帮助您找到错误。动态内存问题通常在释放时触发（例如，您尝试释放无效对象）。始终发布可以帮助您识别否则很难找到的错误。

# c# - 数据绑定到数据绑定对象内的列表

> ID：347347
> 
> 赞同：2
> 
> 时间：2008-12-07T07:20:18.647
> 
> 标签：c#, wpf, data-binding

我是 WPF 和数据绑定的新手，所以希望我能用足够的细节来解释我遇到的问题以获得一些帮助。

我有一个对象列表，这些对象是绑定到窗口的数据。假设它是一个食谱列表。我设法让应用程序在列表框中显示每个配方的一些详细信息，并在各种文本框中显示所选配方的更多详细信息。我的问题是我在选择配方时，我在每个配方中都有一份成分的成分列表，但我无法解决如何弄清楚如何获取数据绑定到工作。

我的数据类看起来像：

```
public class Recipes : ObservableCollection<RecipeDetails>
{
}

public class RecipeDetails
{
    public string Name { get; set; }
    public string Description { get; set; }
    public List<RecipeIngredient> Ingredients;
}

public class RecipeIngredient
{
    public string IngredientName { get; set; }
}

public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        m_recipes = new Recipes();
        // m_recipes initialisation
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        DataContext = m_recipes;
    }

    private Recipes m_recipes;
} 
```

我的数据绑定尝试（在 XAML 中）看起来像：

```
<Window x:Class="RecipeWindow.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Recipe Window" Height="402.687" Width="532.674" Loaded="Window_Loaded">
    <Grid>
        <ListBox Margin="12,58.176,0,16.362" Name="recipeListBox" Width="209.07" IsSynchronizedWithCurrentItem="True" ItemsSource="{Binding}">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Name}" FontSize="14" Padding="5" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
        <StackPanel Margin="245.43,58.176,12,47.268" Name="detailsPanel">
            <TextBox Text="{Binding Name,UpdateSourceTrigger=PropertyChanged}" Width="140" />
            <TextBox Text="{Binding Description,UpdateSourceTrigger=PropertyChanged}" Width="140" />
            <ListBox Name="ingredientListBox" Width="209.07" ItemsSource="{Binding Ingredients}" Height="118.17">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding IngredientName}" Padding="5" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </StackPanel>
    </Grid>
</Window> 
```

但是当我尝试运行这段代码时，成分列表框总是空的。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T08:02:57.750

问题是因为您声明和初始化成分列表的方式，将其设为 ObservableCollection 并仅在构造函数中初始化成分集合，如下所示

```
 public class RecipeDetails
{
    public RecipeDetails()
    {
        _ingredients = new ObservableCollection<RecipeIngredient>();
    }

    public string Name { get; set; }
    public string Description { get; set; }

    private ObservableCollection<RecipeIngredient> _ingredients;

    private ObservableCollection<RecipeIngredient> Ingredients
    {
        get { return _ingredients; }
    }
} 
```

还有一点要添加到您的方法中，建议在此类上使用[INotifyPropertyChanged ，以便当您在 TextBox 中键入内容时可以轻松实现双向绑定。](http://msdn.microsoft.com/en-us/library/ms229614.aspx)

# .net - 一个开源项目，可以教授 .NET 的成员资格和角色管理

> ID：347356
> 
> 赞同：0
> 
> 时间：2008-12-07T07:37:26.927
> 
> 标签：.net, open-source, asp.net-membership

我想看一个基础项目来学习如何组织成员和角色管理。你能给我一些关于它的开源项目链接吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T08:42:48.497

如果您对`asp.net`用户成员资格示例感兴趣， [N2](http://n2cms.com/Features.aspx)有一个名为`User registration & Login parts`.

[N2](http://www.codeplex.com/n2)是一个开源的轻量级 CMS 框架。它的模块化和轻量级方法的一个好处是 CMS 可以集成到现有的 ASP.NET 解决方案和 ASP.NET MVC 中。

# c++ - 继承构造函数

> ID：347358
> 
> 赞同：277
> 
> 时间：2008-12-07T07:41:57.027
> 
> 标签：c++, inheritance, gcc, constructor

为什么这段代码：

```
class A
{
    public: 
        explicit A(int x) {}
};

class B: public A
{
};

int main(void)
{
    B *b = new B(5);
    delete b;
} 
```

导致这些错误：

```
main.cpp：在函数“int main()”中：
main.cpp:13：错误：没有匹配的函数调用'B::B(int)'
main.cpp:8：注意：候选人是：B::B()
main.cpp:8: 注意：B::B(const B&)

```

B不应该继承A的构造函数吗？

（这是使用 gcc）

* * *

## 回答 #1

> 赞同：518
> 
> 时间：2009-01-12T08:19:57.813

如果您的编译器支持 C++11 标准，则使用`using`（双关语）构造函数继承。有关更多信息，请参阅[Wikipedia C++11 文章](http://en.wikipedia.org/wiki/C%2B%2B11#Object_construction_improvement)。你写：

```
class A
{
    public: 
        explicit A(int x) {}
};

class B: public A
{
     using A::A;
}; 
```

这是全有或全无 - 你不能只继承一些构造函数，如果你写这个，你继承所有的。要仅继承选定的那些，您需要手动编写各个构造函数并根据需要从它们调用基本构造函数。

从历史上看，构造函数不能在 C++03 标准中继承。您需要通过自己调用基本实现来手动继承它们。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2008-12-07T07:48:09.277

构造函数不被继承。它们被子构造函数隐式或显式调用。

编译器创建一个默认构造函数（一个不带参数）和一个默认复制构造函数（一个带有引用相同类型的参数）。但是，如果您想要一个接受 int 的构造函数，则必须明确定义它。

```
class A
{
public: 
    explicit A(int x) {}
};

class B: public A
{
public:
    explicit B(int x) : A(x) { }
}; 
```

**更新**：在 C++11 中，可以继承构造函数。有关详细信息，请参阅 Suma 的答案。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-07T07:47:58.637

您必须在 B 中显式定义构造函数并显式调用父级的构造函数。

```
B(int x) : A(x) { } 
```

或者

```
B() : A(5) { } 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-05-09T14:58:30.940

这直接来自[Bjarne Stroustrup 的页面](http://www.stroustrup.com/C++11FAQ.html#inheriting)：

如果你这样选择，你仍然可以通过继承派生类中的构造函数来打自己的脚，在派生类中定义需要初始化的新成员变量：

```
struct B1 {
    B1(int) { }
};

struct D1 : B1 {
    using B1::B1; // implicitly declares D1(int)
    int x;
};

void test()
{
    D1 d(6);    // Oops: d.x is not initialized
    D1 e;       // error: D1 has no default constructor
} 
```

请注意，使用另一个很棒的 C++11 功能（成员初始化）：

```
 int x = 77; 
```

代替

```
int x; 
```

会解决问题

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-11-07T18:40:47.790

使用模板函数绑定所有构造函数怎么样？

```
template <class... T> Derived(T... t) : Base(t...) {} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-06-29T14:21:18.000

以下是我如何让派生类“继承”所有父类的构造函数。我发现这是最直接的方法，因为它只是将所有参数传递给父类的构造函数。

```
class Derived : public Parent {
public:
  template <typename... Args>
  Derived(Args&&... args) : Parent(std::forward<Args>(args)...) 
  {

  }
}; 
```

或者，如果您想要一个不错的宏：

```
#define PARENT_CONSTRUCTOR(DERIVED, PARENT)                    \
template<typename... Args>                                     \
DERIVED(Args&&... args) : PARENT(std::forward<Args>(args)...)

class Derived : public Parent
{
public:
  PARENT_CONSTRUCTOR(Derived, Parent)
  {
  }
}; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-20T07:48:08.123

正确的代码是

```
class A
{
    public: 
      explicit A(int x) {}
};

class B: public A
{
      public:

     B(int a):A(a){
          }
};

main()
{
    B *b = new B(5);
     delete b;
} 
```

错误是 b/c 类 B 没有参数构造函数，其次它应该有基类初始化程序来调用基类参数构造函数的构造函数

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-26T05:34:56.340

派生类继承了基类的所有成员（字段和方法），但派生类不能继承基类的构造函数，因为构造函数不是类的成员。不让派生类继承构造函数，只允许调用基类的构造函数

```
class A
{
    public: 
        explicit A(int x) {}
};

class B: public A
{
       B(int x):A(x);
};

int main(void)
{
    B *b = new B(5);
    delete b;
} 
```

# delphi - 如何找出 Delphi 中哪个程序引发了异常？

> ID：347365
> 
> 赞同：12
> 
> 时间：2008-12-07T07:51:08.897
> 
> 标签：delphi, exception-handling

我正在使用 Delphi TApplication.OnException 事件来捕获未处理的异常

这很好用，但没有提供有关异常发生位置的足够信息，即“灾难性故障”

如何找出导致错误发生的程序？

```
procedure TFrmMain.FormCreate(Sender: TObject);
begin
  Application.OnException := MyExceptionHandler;
end;

procedure TFrmMain.MyExceptionHandler(Sender : TObject; E : Exception );
begin
  LogException (E.Message);     
  Application.ShowException( E );
end; 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-07T08:27:02.897

您可以使用 exceptAddr 变量（系统单元）获取引发异常的内存地址。但是，如果您想要堆栈跟踪，您可以使用 3rdParty 工具 MadExcept、EurekaLog 或开源 JCLDebug（JCL 的一部分）之一。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-07T08:24:29.563

最简单和最快的方法是使用[JCL](http://jcl.sf.net/)异常和调试支持。安装 JCL 后，确保将调试符号插入二进制文件（项目 -> JCL 调试专家 -> 插入此二进制文件的 JDBG 数据 -> 启用）并向项目添加 JCL 异常对话框（文件 -> 新建.. . -> 对话框 -> 异常对话框）。

如果 JCL 安装程序未能将该对话框添加到对象存储库并且它没有出现（发生在我身上几次），请通过将 .pas 和 .dpr 文件从`jcl-install-dir\experts\debug\dialog`项目中复制并手动添加来手动添加它，或关闭Delphi，`%DELHPIDIR%\bin\delphi32.dro`在文本编辑器中编辑并添加类似的内容（当然调整路径：）

```
[P:\DELPHI11\EXTERNALIB\JCL\EXPERTS\DEBUG\DIALOG\EXCEPTDLG]
类型=表单模板
名称=异常对话框
页面=对话框
图标=P:\DELPHI11\EXTERNALIB\JCL\EXPERTS\DEBUG\DIALOG\EXCEPTDLG.ICO
描述=JCL 应用程序异常对话框
作者=绝地计划
默认主窗体=0
DefaultNewForm=0
祖先=

[P:\DELPHI11\EXTERNALIB\JCL\EXPERTS\DEBUG\DIALOG\EXCEPTDLGMAIL]
类型=表单模板
名称 = 带有发送的异常对话框
页面=对话框
图标=P:\DELPHI11\EXTERNALIB\JCL\EXPERTS\DEBUG\DIALOG\EXCEPTDLGMAIL.ICO
描述=JCL 应用程序异常对话框
作者=绝地计划
默认主窗体=0
DefaultNewForm=0
祖先=

```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-07T09:14:50.583

主要相关：[Delphi 中的异常处理](https://stackoverflow.com/questions/72562/exception-handling-in-delphi)。

# nhibernate - NHibernate - 如何使用 where 子句保存对象

> ID：347372
> 
> 赞同：0
> 
> 时间：2008-12-07T08:09:11.950
> 
> 标签：nhibernate, save, where

我不知道如何使用 where 子句保存对象。我需要它来防止保存日期范围与其他对象重叠的对象。

```
public class TaskEvent
{
    public DateTime StartDate {get;set;}
    public DateTime EndDate {get;set;}
} 
```

我想检查保存操作中标准的重叠，但我不知道如何。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T15:31:05.300

您需要在代码中找出需要保存的对象，然后保存这些对象。这是业务逻辑，不应该被推入持久化操作中。IMO，即使 NH 可以支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-18T16:04:38.783

您可以将 HQL 用于临时更新查询

```
session.CreateQuery("UPDATE TaskEvent SET ... WHERE ID = :ID and ...")
.SetInt32("ID", ID)
//.SetDateTime("", )
//.SetDateTime("", )
.ExecuteUpdate(); 
```

或者以一种更 NHibernate 的方式...获取所需的 TaskEvents（where 子句），更新它们的属性，并提交事务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-18T16:09:03.037

一种方法是重新确定您不想在代码中保存哪些 TaskEvent 对象并将它们从 ISession 中逐出，这样它们就不会被持久化。

# unit-testing - Microft Visual Studio 测试导致测试失败

> ID：347374
> 
> 赞同：0
> 
> 时间：2008-12-07T08:13:25.793
> 
> 标签：unit-testing, testing

在使用 nunit 很长一段时间后，我决定测试一下微软内置的测试框架。

在我的测试开始时，我通常会清理数据库以使其进入我可以依赖的测试状态。在我的测试设置中，我删除了所有数据并为我的测试插入新数据。

自从开始使用 MS 测试以来，我注意到我的测试间歇性地失败，因为数据重置是冲突的。就像我的测试都是同时运行的。

知道如何解决这个问题吗？是否可以选择强制每类测试一次运行一个？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T21:04:51.163

If you dont want to run all of your tests at one time use an Ordered Test and then right click and say run selection. If you put the test that deletes and rebuilds your tables/info first everything should work out just fine.

# asp.net - 在 ASP.NET 中，何时应该使用 Session.Clear() 而不是 Session.Abandon()？

> ID：347377
> 
> 赞同：120
> 
> 时间：2008-12-07T08:14:50.003
> 
> 标签：asp.net, .net, session, session-state

Session.Clear() 和 Session.Abandon() 都摆脱了会话变量。据我了解， Abandon() 结束当前会话，并导致创建一个新会话，从而导致 End 和 Start 事件触发。

在大多数情况下调用 Abandon() 似乎更可取，例如注销用户。有没有我会使用 Clear() 的场景？性能差异很大吗？

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2008-12-07T08:25:48.250

`Session.Abandon()` **销毁会话**并触发**Session_OnEnd 事件。**

`Session.Clear()`只是从对象**中删除所有值**（内容）。具有相同密钥的会话仍然存在。

因此，如果您使用`Session.Abandon()`，您将丢失该特定会话，并且用户将获得一个新的会话密钥。例如，您可以在用户注销时使用它。

如果`Session.Clear()`您希望用户保留在同一会话中（例如，如果您不希望用户重新登录）并重置所有会话特定数据，请使用 。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-10-21T13:12:59.107

仅在用户注销时使用 Session.Clear() 可能会造成安全漏洞。就 Web 服务器而言，会话仍然有效。然后，嗅探、获取会话 ID 并劫持该会话是一件相当简单的事情。

出于这个原因，在注销用户时，使用 Session.Abandon() 会更安全、更明智，这样会销毁会话并创建新会话（即使注销 UI 页面将是新会话的一部分，新会话中不会包含任何用户详细信息，并且劫持新会话将等同于进行新会话，因此它将是静音的）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-15T10:14:00.840

`Session.Abandon`如上所述破坏会话，因此您应该在注销某人时使用它。我认为一个很好的用途`Session.Clear`是用于电子商务网站上的购物篮。这样一来，购物篮就可以在不注销用户的情况下被清除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T14:34:08.927

我遇到了这个问题并尝试了两者，但不得不解决像“pageEditState”这样的废话，但不删除用户信息，以免我不得不再次查找它。

```
public static void RemoveEverythingButUserInfo()
{
    foreach (String o in HttpContext.Current.Session.Keys)
    {
        if (o != "UserInfoIDontWantToAskForAgain")
            keys.Add(o);
    }
} 
```

# unit-testing - 是否存在过度单元测试之类的事情？

> ID：347379
> 
> 赞同：17
> 
> 时间：2008-12-07T08:17:57.983
> 
> 标签：unit-testing, tdd

我对单元测试的概念并不陌生，但同时我也没有掌握它们。

最近，当我在使用 TDD 方法编写代码的同时编写单元测试时，我一直在思考的一个问题是：我应该测试到什么级别？

有时我想知道我是否过度使用单元测试。

开发人员应该在什么时候停止编写单元测试并完成实际工作？

在人们认为我反对使用 TDD 之前，我可能需要澄清这个问题......

我正在努力解决的是我的测试粒度......

*   当我的应用程序有配置文件时，我是否测试可以从文件中检索值？我倾向于是的……但是……
*   然后我是否为将出现的每个可能的配置值编写一个单元测试？即检查它们是否存在......并且可以解析为正确的类型......
*   当我的应用程序将错误写入日志时，我是否需要测试它是否能够写入日志？然后我是否需要编写测试来验证日志中是否确实有条目？

我希望能够使用我的单元测试来验证我的应用程序的行为......但我不太确定在哪里停止。是否可以编写太琐碎的测试？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-07T09:02:41.840

**[更新：]**在 TDD ByExample - Pg194 中找到了这个问题的简明答案。

> Phlip 提供的简单答案是：“编写测试，直到恐惧变成无聊为止。”

[/**更新**]

我认为当前普遍存在的问题是缺乏单元测试......而不是过度测试。我想我明白你的意思了。我不会把它称为过度的单元测试，而是......对你的工作重点不聪明。

所以回答你的问题..一些指导方针。

*   如果您**遵循 TDD**，您将永远不会拥有单元测试未涵盖的代码。因为您只编写（最少的）代码来通过失败的单元测试，仅此而已。推论：每个问题都应该通过单元测试来确定缺陷的位置。相同的缺陷不应导致数十个 UT 同时损坏
*   **不要测试不是你写的代码。**一个推论是：你不测试框架代码（比如从 app.config 文件中读取值）你只是假设它有效。你有多少次框架代码被破坏？接近于零。
*   如果有疑问，**请考虑失败的可能性，并将其与编写自动化测试用例的成本进行权衡**。包括为访问器/重复数据集测试编写测试用例。
*   **解决痛苦**。如果您发现您在某个领域定期遇到问题，请将其置于测试工具之下。而不是花时间为您知道非常可靠的领域编写冗余测试。例如，第三方/团队库在界面上不断中断.. 无法正常工作。嘲笑不会抓住它。如果您知道链接是有问题的孩子，请使用真正的合作者使用回归类型套件并运行一些健全性测试来验证链接。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-07T08:41:18.607

是的，确实可以编写过多的单元测试。例如，

*   测试 getter 和 setter。
*   测试基本语言功能是否有效。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-07T13:32:20.190

在实践中，问题不在于人们编写了太多测试，而在于他们不均匀地分布测试。有时您会看到刚接触单元测试的人为易于测试的事物编写了数百个测试，但随后他们在将任何测试放在最需要的地方之前就失去了动力。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-07T08:55:49.500

过度单元测试绝对是可能的，测试*功能*是一个很好的起点。但也不要忽视测试*错误处理*。当给定的输入不符合其先决条件时，您的单位应该做出明智的反应。如果您自己的代码对错误输入负责，那么断言失败是一个明智的响应。如果用户可能导致错误的输入，那么您将需要对异常或错误消息进行单元测试。

每个报告的错误都应该导致至少一个单元测试。

关于你的一些细节：我肯定会测试我的配置文件解析器，看看它可以解析每个预期类型的​​每个值。（我倾向于依赖[Lua](http://www.lua.org/)进行配置文件和解析，但这仍然让我需要做一些测试。）但我不会为配置文件中的每个条目编写单元测试。相反，我会编写一个表驱动的测试框架来描述每个可能的条目并从中*生成*测试。我可能会根据相同的描述生成文档。我什至可以生成解析器。

当您的应用程序将条目写入日志时，您正在转向集成测试。更好的方法是拥有一个单独的日志组件，如 syslog。然后您可以对记录器进行单元测试，将其放在架子上，然后重复使用。或者更好的是，重用 syslog。然后，一个简短的集成测试可以告诉您您的应用程序是否与 syslog 正确互操作。

一般来说，如果您发现自己编写了很多单元测试，可能是您的单元太大并且不够正交。

我希望这会有所帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-07T08:39:03.823

单元测试需要测试每一项功能、边缘情况，有时甚至是极端情况。

如果您在测试边缘和角落案例之后发现您正在做“中间”案例，那么这可能是过度的。

此外，根据您的环境，单元测试的编写可能非常耗时，或者非常脆弱。

测试确实需要持续维护，因此您编写的每个测试都可能在未来中断并需要修复（即使它没有检测到实际的错误） - 尝试以最少的测试数量进行足够的测试似乎是一个不错的目标（但不要只是将几个测试拼凑成一个 - 一次测试一件事）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-07T10:41:21.127

我相信一个好的测试会测试一些规范。任何测试不属于规范的东西的测试都是毫无价值的，因此应该被省略，例如测试方法只是实现单元的指定功能的手段。是否值得测试真正微不足道的功能（例如 getter 和 setter）也是值得怀疑的，尽管您永远不知道它们会微不足道多久。

根据规范进行测试的问题在于，许多人将测试用作规范，这是错误的，原因有很多——部分原因是它使您无法真正知道应该测试什么和不应该测试什么（另一个重要原因是测试是总是只测试一些例子，而规范应该总是为所有可能的输入和状态指定行为）。

如果您的单元有适当的规格（并且您应该），那么需要测试的内容应该是显而易见的，除此之外的任何内容都是多余的，因此是浪费的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-07T13:10:35.570

根据给出的一些答案，需要注意的一件事是，如果您发现需要编写大量单元测试来一遍又一遍地做同样的事情，请考虑重构相关代码的根本原因。

您是否需要为访问配置设置的任何地方编写测试？不会。如果您重构并为该功能创建一个入口点，则可以对其进行一次测试。我相信尽可能多地测试功能。但真正重要的是要意识到，如果你省略重构步骤，你的代码覆盖率将直线下降，因为你继续在整个代码库中使用“一次性”实现。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-07T08:27:07.450

是的，单元测试可以过度/极端

请记住，*只**需要**测试**功能***；其他一切都由此而来

所以不，您不必测试是否可以从配置文件中读取值，因为其中一个（或多个）功能将需要从配置文件中读取值 - 如果他们不这样做，那么您不需要不需要配置文件！

编辑：我想说的似乎有些混乱。我并不是说单元测试和功能测试是一回事——它们不是。根据[维基百科](http://en.wikipedia.org/wiki/Unit_testing)：“一个单元是应用程序中最小的可测试部分”，从逻辑上讲，这样的“单元”比大多数“功能”要小。

我的意思是，单元测试*是*极端的，而且很少有必要——除了超级关键软件（例如，生命可能受到威胁的实时控制系统）或预算和时间表没有限制的项目之外.

对于大多数软件来说，从实用的角度来看，测试功能就足够了。测试小于功能的单元不会受到伤害，并且可能会有所帮助，但是生产力与质量改进之间的权衡是值得商榷的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-07T08:53:13.187

在单元测试中，您将编写一个测试，表明可以从配置文件中读取项目。您将测试任何可能的怪癖，以便您拥有一组具有代表性的测试，例如，您能否读取空字符串、长字符串或带有转义字符的字符串，系统能否区分空字符串或缺失字符串。

完成该测试后，无需在每次其他班级使用您已经测试过的设施时重新检查该功能。否则，对于您测试的每个功能，您都必须重新测试它所依赖的每个操作系统功能。给定功能的测试只需要测试该功能的代码负责正确处理的内容。

有时，如果这很难判断，则表明需要重构以使问题更容易回答。如果您必须为不同的特性多次编写相同的测试，这可能表明这些特性在它们内部共享某些东西，可以移出到单个函数或类中，测试一次然后重用。

从广义上讲，这是一个经济学问题。假设你已经停止了不必要的重复测试，你能负担多少完成测试？由于可能发生的各种情况的组合，实际上不可能为任何重要的程序编写真正完整的测试，因此您必须进行调用。尽管最初发布时没有进行单元测试，但许多成功的产品已经风靡全球，其中包括一些有史以来最著名的桌面应用程序。他们不可靠，但足够好，如果他们在可靠性方面投入更多，那么他们的竞争对手就会击败他们，获得市场份额的第一名。（看看 Netscape，它以一种出了名的不可靠产品获得了第一名，然后当他们花时间以正确的方式做每一件事时完全消失了）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-07T09:16:24.747

这是很有可能的，但问题不在于有太多的测试——它是在测试你不关心的东西，或者在测试东西上投入太多，更少和更简单的测试就足够了。

我的指导原则是我在更改一段代码时的信心水平：如果它永远不会失败，我就不需要测试。如果它很简单，那么简单的理智就可以了。如果这很棘手，我会加快测试速度，直到我有信心做出改变。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-07T10:38:05.720

当您使用代码生成来生成非常明显的单元测试时，通常会出现过多的单元测试。然而，由于生成的单元测试并不会真正伤害任何人（并且不会对成本效益比产生负面影响），我建议将它们留在里面——它们可能会在你最不期望的时候派上用场。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-07T10:38:37.780

当然，一个人可以过度测试，就像一个人可以过度设计一样。

当您遵循测试驱动开发时，您应该对您的代码充满信心，并在您足够自信时停止。如有疑问，请添加新测试。

关于琐碎的测试，eXtreme Programming 对此的说法是“**测试所有可能破坏**的东西”。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-07T15:10:57.277

> 开发人员应该在什么时候停止编写单元测试并完成实际工作？

单元测试的重点——除了提供*设计*指导之外——是给你反馈你是否真的*完成*了工作。记住那句古老的格言：如果它不需要工作，我现在就完了。

在精益词汇中，测试是“必要的浪费”——它们没有提供任何直接价值。所以艺术就是只写那些提供间接价值的测试——通过帮助我们相信我们所生产的东西确实有效。

因此，关于编写什么测试的最终指南应该是您对生产代码的信心水平。这就是极限编程口号“测试所有可能破坏的东西”的来源——如果有东西可能破坏，我们需要一个测试作为我们的安全网，以便能够在未来快速行动，充满信心地重构。如果某些东西“不可能破坏”（正如人们常说的简单访问器），为它编写测试将完全是浪费。

当然，您有时会在评估中失败。您需要经验才能找到合适的平衡点。最重要的是，每当您收到针对您的代码的错误报告时，您应该考虑什么样的测试可以防止这个错误被广泛传播，并在未来防止类似的错误。然后将这种测试添加到您的代码“可能会中断”的测试集合中。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-07T16:56:35.643

如果两个测试用例将运行完全相同的代码，则无需单独测试它们。例如，对于您读取配置文件的示例，您只需要测试它是否能够正确读取每种类型的值（并且当被要求读取不存在或无效的值时它以正确的方式失败）。

如果您测试它是否正确读取了配置文件中的每个值，那么您正在测试配置文件，而不是代码。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-08T19:13:34.633

如果您发现自己将所有的调试时间都花在了测试例程上，那么您可能已经过火了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-08T19:33:29.617

TDD 方法论是关于*设计*的——拥有一套供以后使用的测试是一个相当受欢迎的副作用。测试驱动开发揭示了与“只是”事后才进行测试完全不同的代码。

因此，当您在 TDD 上下文中提问时：很容易过度设计“过度设计”的解决方案。当您将设计固定到不会滑动时停止。无需用螺栓固定、绑扎并用水泥覆盖。您需要设计足够灵活，以便在下一次重构期间进行更改。

我个人关于过度设计测试的故事是一个过度模拟的测试，其中某些类的实现或多或少地反映在对各个模拟对象的“期望”调用中。谈论拒绝适应变化的需求……

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-09T07:09:49.260

我认为[这条规则](http://www.lindsaar.net/2008/6/28/tip-27-spec-a-behaviour-not-an-implementation)也应该适用于 TDD 以防止过多的单元测试。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-10T16:15:08.767

为了确定我在程序上投入了多少测试工作，我根据要测试的内容定义了这个测试活动的标准：所有代码分支、所有功能、所有输入或输出域、所有功能。 ..

鉴于此，当我的标准完全涵盖时，我的测试工作就完成了。

我只需要知道某些目标是不可能达到的，例如所有程序路径或所有输入值。

# localization - 如何翻译 Struts 2 的验证消息？

> ID：347386
> 
> 赞同：0
> 
> 时间：2008-12-07T08:36:53.047
> 
> 标签：localization, internationalization, struts2

我想学习如何使用 Struts 2，并按照我找到的教程创建了一个简单的应用程序。

我创建了一个`<MyActionClass>-validation.xml`文件，我想知道如何将验证消息翻译成多种语言？

```
<field name="password">
    <field-validator type="requiredstring">
        <param name="trim">true</param>
        <message>You have to enter a password.</message> 
                 <!-- How can I localize this message? -->
    </field-validator>
</field> 
```

我可以从本地化的 .properties 文件中获取消息，还是必须使用其他类型的验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T19:24:48.213

好的，我自己发现了。您必须为该类创建一个 .properties 文件，然后您可以从以下位置更改代码：

```
<message>You have to enter a password.</message> 
```

到：

```
<message key="[message key from the properties file]" /> 
```

# visual-studio-2008 - Visual Studio 2008 C++ 问题

> ID：347390
> 
> 赞同：1
> 
> 时间：2008-12-07T08:43:40.477
> 
> 标签：visual-studio-2008, linker

我正在尝试编写一个程序来计算二次公式。当我运行它时，我收到 2 条错误消息：

```
错误 LNK2019：函数 ___tmainCRTStartup 中引用的未解析外部符号 _WinMain@16
致命错误 LNK1120：1 个未解决的外部问题
```

这是在我从...更改最后一行代码之后：

```
<< danswer1, danswer2 >>
```

至

```
<< danswer1 << "," << danswer2 <<
```

在进行该更改之前，我遇到了 2 个编译器错误：C2563 和 C2568。在朋友的电脑上，该程序运行良好。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T08:57:10.760

您的项目是 Win32 控制台应用程序还是 Win32 应用程序？如果您使用的是常规 main(int argc, char** argv)，请确保您的应用程序是控制台应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T09:04:20.183

您可以通过转到 Project **Properties**、**Configuration Properties**、**Linker**、**System** editor 更改为控制台应用程序。然后，您可以将您的**子系统**从 Windows 切换到控制台（反之亦然）。确保为您的调试和发布配置执行此操作。

# cocoa - 如何使用 Cocoa 的 Accessibility API 来检测窗口是否被置于前面？

> ID：347396
> 
> 赞同：15
> 
> 时间：2008-12-07T08:51:45.123
> 
> 标签：cocoa, accessibility-api

我正在使用辅助功能 API 来检测某个应用程序何时打开窗口、关闭窗口、何时移动或调整窗口大小，或者何时成为主窗口和/或焦点窗口。但是，客户端应用程序似乎将一个窗口移到了前面，而没有触发 Accessibility API 通知。

我的应用程序如何检测另一个应用程序何时将一个窗口置于前面而不使其成为关键？

我希望找到适用于 OS X 10.4 和 10.5 的解决方案

更多信息：我目前正在使用这些语句。当用户手动选择一个窗口将其置于前面时，它们可以正常工作。但是当应用程序本身将窗口带到前面时，它就不起作用了。

```
AXObserverAddNotification(observer, element, kAXMainWindowChangedNotification, 0);
AXObserverAddNotification(observer, element, kAXFocusedWindowChangedNotification, 0); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T02:53:45.770

我一直无法订阅当前窗口的变化，但你可以询问当前应用程序的辅助功能API，以及当前应用程序最前台的窗口。

假设您有一个名为 CurrentAppData 的类，其中包含以下数据：

```
@interface CurrentAppData : NSObject {
    NSString* _title;
    AXUIElementRef _systemWide;
    AXUIElementRef _app;
    AXUIElementRef _window;
} 
```

查找当前应用程序的代码如下所示：

```
-(void) updateCurrentApplication {
   // get the currently active application  
   _app = (AXUIElementRef)[CurrentAppData
                           valueOfExistingAttribute:kAXFocusedApplicationAttribute 
                                        ofUIElement:_systemWide];

   // Get the window that has focus for this application
   _window = (AXUIElementRef)[CurrentAppData 
                              valueOfExistingAttribute:kAXFocusedWindowAttribute 
                                           ofUIElement:_app];

   NSString* appName = [CurrentAppData descriptionOfValue:_window
                                             beingVerbose:TRUE];    

   [self setTitle:appName];
} 
```

在本例中，_systemWide 变量在类 init 函数中被初始化为： _system = AXUIElementCreateSystemWide();

类函数 valueOfExistingAttribute 如下所示：

```
// -------------------------------------------------------------------------------
//  valueOfExistingAttribute:attribute:element
//
//  Given a uiElement and its attribute, return the value of an accessibility
//  object's attribute.
// -------------------------------------------------------------------------------
+ (id)valueOfExistingAttribute:(CFStringRef)attribute ofUIElement:(AXUIElementRef)element
{
    id result = nil;
    NSArray *attrNames;

    if (AXUIElementCopyAttributeNames(element, (CFArrayRef *)&attrNames) == kAXErrorSuccess) 
    {
        if ( [attrNames indexOfObject:(NSString *)attribute] != NSNotFound
                &&
            AXUIElementCopyAttributeValue(element, attribute, (CFTypeRef *)&result) == kAXErrorSuccess
        ) 
        {
            [result autorelease];
        }
        [attrNames release];
    }
    return result;
} 
```

前面的函数取自 Apple [UIElementInspector](http://developer.apple.com/samplecode/UIElementInspector/index.html)示例，这也是学习 Accessibility API 的一个很好的资源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T03:52:55.813

在 Mac OS X 中，应用程序和窗口是完全独立的事物，应用程序包含窗口；它们与以前在 Microsoft Windows 中不同。您需要检测每个应用程序的激活和停用。

你可以通过观察 for`kAXApplicationActivatedNotification`和来做到这一点`kAXApplicationDeactivatedNotification`。这些通知的对象是被激活和停用的应用程序。您还需要检测应用程序的启动和退出；您可以使用 Process Manager 或 NSWorkspace 来执行此操作。这两个 API 都可以为您提供进程 ID，您可以使用它来创建 AXApplication 对象。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-02-16T11:17:54.553

查看开发人员文档中的[iChatStatusFromApplication](http://developer.apple.com/library/mac/#samplecode/iChatStatusFromApplication/Listings/ReadMe_txt.html)示例。这正是你需要的:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-14T23:45:54.513

[NSAccessibilityFocusedUIElementChangedNotification](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSAccessibility_Protocol/Reference/Reference.html#//apple_ref/doc/uid/20000945-DontLinkElementID_287)怎么样？

# css - IE 为每个 li 元素添加了额外的上边距

> ID：347404
> 
> 赞同：4
> 
> 时间：2008-12-07T08:58:27.950
> 
> 标签：css, internet-explorer

我目前正在我正在开发的网站上进行 IE 黑客攻击： [http ://www.timkjaerlange.com/wip/co2penhagen/](http://www.timkjaerlange.com/wip/co2penhagen/)

我遇到了这个无序列表的问题。IE 似乎为每个 li 元素添加了额外的上边距，使我的导航看起来像一段楼梯： [http ://dl.getdropbox.com/u/228089/ie-prob.jpg](http://dl.getdropbox.com/u/228089/ie-prob.jpg)

我正在使用条件注释来定位 IE。我试过：

```
ul#mainnav li { top-margin: 0;} 
```

但这无济于事。我希望 IE 有一个 Firebug 风格的插件，这样可以更容易地解决这些问题。

关于可能导致此问题的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-07T09:38:02.970

要获得您正在寻找的行为，请尝试“display：inline”而不是“float：left”。添加两者：

> ul#mainnav { 显示：内联 }
> 
> ul#mainnav li {显示：内联}

可以在[A List Apart](http://www.alistapart.com/articles/taminglists/)上找到有关自定义列表信息的重要资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T09:25:36.007

上边距不是 CSS 属性。你正在寻找margin-top

改变：

```
ul#mainnav li { top-margin: 0;} 
```

到：

```
ul#mainnav li { margin-top: 0;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T09:27:01.200

错误..对不起，如果这是一个愚蠢的问题，但这不应该是保证金吗？

也许您应该考虑定制一个精心设计的[reset.css](http://meyerweb.com/eric/tools/css/reset/)（或这个[）](http://developer.yahoo.com/yui/reset/)文件供您使用？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T09:37:34.687

你是对的。然而，margin-top 并不能解决问题

我使用 Eric Meyer 的 reset.css，它与我用于原型设计的 960gs 捆绑在一起。

# asp.net - 如何在 ASP.NET 3.5（不是 MVC）中使用 nhibernate

> ID：347426
> 
> 赞同：1
> 
> 时间：2008-12-07T09:26:55.067
> 
> 标签：asp.net, nhibernate, crud

与 NHibernate 2.0 和 ASP.NET 3.5 互操作的最佳方式是什么？如何轻松开发 CRUD 应用程序？

ObjectDataSource 是要走的路吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T10:25:19.023

[您可以在http://www.summerofnhibernate.com/](http://www.summerofnhibernate.com/)上观看截屏视频， 该视频 将解释如何设置 CRUD，并将阐明更高级的主题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T15:26:47.667

您可能会发现[Rhino Commons](http://ayende.com/wiki/Rhino+Commons.ashx)是一个不错的选择。它提供 Repository<T> 和 UnitOfWorkApplication。它们一起在 Web 应用程序的上下文中提供数据网关和会话管理。与[Castle.Service.Transaction](http://www.jroller.com/hammett/entry/the_joys_of_castle_services)一起使用以透明地处理事务。

# c# - C# Windows 窗体中的自定义控件鼠标事件问题

> ID：347439
> 
> 赞同：5
> 
> 时间：2008-12-07T10:04:42.853
> 
> 标签：c#, winforms, events

我有一个用于面板控件的 mouseenter 和 mouseleave 事件，当鼠标进入时会更改背景色，离开时会变回白色。

我在这个面板中也有 Label 控件，但是当鼠标进入 Label 控件时，面板的 mouseleave 事件会触发。

这是有道理的，但是当鼠标在其区域中时，如何保持面板的背景颜色相同，而内部的其他控件不会影响它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-09T22:17:04.670

您可以使用 GetChildAtPoint() 来确定鼠标是否在子控件上。

```
private void panel1_MouseLeave(object sender, EventArgs e)
{
    if (panel1.GetChildAtPoint(panel1.PointToClient(MousePosition)) == null)
    {
        panel1.BackColor = Color.Gray;
    }
} 
```

如果控件实际上不是子控件，您仍然可以使用 MousePosition 和 PointToScreen 来确定鼠标是否仍在控件的边界内。

```
private void panel1_MouseLeave(object sender, EventArgs e)
{
    Rectangle screenBounds = new Rectangle(this.PointToScreen(panel1.Location), panel1.Size);
    if (!screenBounds.Contains(MousePosition))
    {
        panel1.BackColor = Color.Gray;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T13:04:15.940

我找到了一个简单的解决方案。我只是在标签上将 enabled 属性设置为 false 就可以了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T10:58:29.673

为包含的控件添加事件意味着当您想向面板添加另一个控件时，您也必须为此进行相同的练习。

为父控件添加事件意味着一旦您想在其他地方使用面板，您必须对新父控件执行相同操作。并且当面板的需求发生变化时，你必须记住将处理从父控件的事件中取出。

所有这些都可能会变得更糟。

我倾向于在面板的鼠标离开事件中进行一些坐标检查，并且仅在鼠标确实超出面板范围时才重置面板颜色。

这样，您的面板处理代码仅保留在相关面板上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T10:44:01.077

您可以为标签添加一个 MouseEnter 事件，该事件也设置面板的背景颜色。标签不需要 MouseLeave 事件。

或者：

1.  为 Panel 设置 MouseEnter 事件以设置 Panel 的背景颜色。
2.  设置 Panel 的父控件（例如 Form）的 MouseEnter 事件来重置 Panel 的背景颜色。

* * *

如果您想在不接触父控件代码的情况下执行上述第 2 点（根据其他用户的评论），您可以在 Panel 的 ParentChanged 事件中执行以下操作：

```
 private void panel1_ParentChanged(object sender, EventArgs e)
    {
        Panel thisPanel = sender as Panel;

        if(thisPanel != null && thisPanel.Parent != null)
        {
            thisPanel.Parent.MouseEnter += delegate(object senderObj, EventArgs eArgs) { thisPanel.BackColor = SystemColors.Control; };
        }
    } 
```

# c++ - 从向量中擦除元素

> ID：347441
> 
> 赞同：115
> 
> 时间：2008-12-07T10:10:20.037
> 
> 标签：c++, vector, stl, erase

我想使用擦除方法从向量中清除一个元素。但这里的问题是，不能保证元素在向量中只出现一次。它可能出现多次，我需要清除所有这些。我的代码是这样的：

```
void erase(std::vector<int>& myNumbers_in, int number_in)
{
    std::vector<int>::iterator iter = myNumbers_in.begin();
    std::vector<int>::iterator endIter = myNumbers_in.end();
    for(; iter != endIter; ++iter)
    {
        if(*iter == number_in)
        {
            myNumbers_in.erase(iter);
        }
    }
}

int main(int argc, char* argv[])
{
    std::vector<int> myNmbers;
    for(int i = 0; i < 2; ++i)
    {
        myNmbers.push_back(i);
        myNmbers.push_back(i);
    }

    erase(myNmbers, 1);

    return 0;
} 
```

这段代码显然会崩溃，因为我在迭代它时更改了向量的结尾。实现这一目标的最佳方法是什么？即有没有办法做到这一点而无需多次迭代向量或创建一个向量的更多副本？

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2008-12-07T11:07:10.887

使用[删除/擦除习语](http://www.codeguru.com/forum/archive/index.php/t-231045.html)：

```
std::vector<int>& vec = myNumbers; // use shorter name
vec.erase(std::remove(vec.begin(), vec.end(), number_in), vec.end()); 
```

发生的情况是压缩与开头的`remove`要删除的值 ( ) 不同的元素，并将迭代器返回到该范围之后的第一个元素。然后删除这些元素（其值未指定）。`number_in``vector``erase`

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-12-07T10:22:53.987

调用擦除将使迭代器无效，您可以使用：

```
void erase(std::vector<int>& myNumbers_in, int number_in)
{
    std::vector<int>::iterator iter = myNumbers_in.begin();
    while (iter != myNumbers_in.end())
    {
        if (*iter == number_in)
        {
            iter = myNumbers_in.erase(iter);
        }
        else
        {
           ++iter;
        }
    }

} 
```

或者您可以将[std::remove_if](https://en.cppreference.com/w/cpp/algorithm/remove)与仿函数和 std::vector::erase 一起使用：

```
struct Eraser
{
    Eraser(int number_in) : number_in(number_in) {}
    int number_in;
    bool operator()(int i) const
    {
        return i == number_in;
    }
};

std::vector<int> myNumbers;
myNumbers.erase(std::remove_if(myNumbers.begin(), myNumbers.end(), Eraser(number_in)), myNumbers.end()); 
```

[在这种情况下，您可以使用std::remove](https://en.cppreference.com/w/cpp/algorithm/remove)，而不是编写自己的仿函数：

```
std::vector<int> myNumbers;
myNumbers.erase(std::remove(myNumbers.begin(), myNumbers.end(), number_in), myNumbers.end()); 
```

在 C++11 中，您可以使用 lambda 而不是仿函数：

```
std::vector<int> myNumbers;
myNumbers.erase(std::remove_if(myNumbers.begin(), myNumbers.end(), [number_in](int number){ return number == number_in; }), myNumbers.end()); 
```

在 C++17 中[std::experimental::erase](https://en.cppreference.com/w/cpp/experimental/vector/erase_if)和[std::experimental::erase_if](https://en.cppreference.com/w/cpp/experimental/vector/erase_if)也可用，在 C++20 中，它们（最终）重命名为[std::erase](https://en.cppreference.com/w/cpp/container/vector/erase2)和[std::erase_if](https://en.cppreference.com/w/cpp/container/vector/erase2)（*注意：在 Visual Studio 2019 您需要将您的 C++ 语言版本更改为最新的实验版本以获得支持*）：

```
std::vector<int> myNumbers;
std::erase_if(myNumbers, Eraser(number_in)); // or use lambda 
```

或者：

```
std::vector<int> myNumbers;
std::erase(myNumbers, number_in); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-07T11:44:23.013

1.  您可以使用索引访问进行迭代，

2.  为了避免 O(n^2) 复杂性，您可以使用两个索引，i - 当前测试索引，j - 存储下一项的索引，并在循环结束时使用新的向量大小。

代码：

```
void erase(std::vector<int>& v, int num)
{
  size_t j = 0;
  for (size_t i = 0; i < v.size(); ++i) {
    if (v[i] != num) v[j++] = v[i];
  }
  // trim vector to new size
  v.resize(j);
} 
```

在这种情况下，您没有使迭代器失效，复杂度为 O(n)，并且代码非常简洁，您不需要编写一些辅助类，尽管在某些情况下使用辅助类可以受益于更灵活的代码。

此代码不使用`erase`方法，但可以解决您的任务。

使用纯 stl 您可以通过以下方式执行此操作（这类似于 Motti 的答案）：

```
#include <algorithm>

void erase(std::vector<int>& v, int num) {
    vector<int>::iterator it = remove(v.begin(), v.end(), num);
    v.erase(it, v.end());
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-07T11:18:49.040

根据您这样做的原因，使用[std::set](http://www.sgi.com/tech/stl/set.html)可能比 std::vector 更好。

它允许每个元素只出现一次。如果您多次添加它，无论如何都只会删除一个实例。这将使擦除操作变得微不足道。擦除操作的时间复杂度也将低于向量，但是，在集合上添加元素的速度较慢，因此它可能没有太大优势。

如果您对元素被添加到向量中的次数或元素添加的顺序感兴趣，这当然不会起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2022-01-11T01:51:23.027

自**C++20**以来就有[std::erase 和 std::erase_if](https://en.cppreference.com/w/cpp/container/vector/erase2)，它们结合了 remove-erase 习语。

 **```
std::vector<int> nums;
...
std::erase(nums, targetNumber); 
```

或者

```
std::vector<int> nums;
...
std::erase_if(nums, [](int x) { return x % 2 == 0; }); 
```

# sql - SQL 语句帮助 - 选择表中记录最多的 CustomerID、OrderDate 列表

> ID：347449
> 
> 赞同：2
> 
> 时间：2008-12-07T10:27:12.670
> 
> 标签：sql, sql-server-2005

我将使用[AdventureWorks 数据库](http://www.codeplex.com/MSFTDBProdSamples/Release/ProjectReleases.aspx?ReleaseId=4004)来说明我的问题。

我需要为特定客户显示订单最多的 OrderDate 列表。

我最初的尝试如下：

```
SELECT CustomerID, OrderDate, COUNT(1) Cnt
FROM Sales.SalesOrderHeader
WHERE CustomerID = 11300
GROUP BY CustomerID, OrderDate
ORDER BY Cnt DESC 
```

这将为我们得到以下结果：

```
CustomerID    OrderDate             Cnt
-----------   ----------                ----
11300        2003-11-22 00:00:00.000     2
11300        2004-01-28 00:00:00.000     2
11300        2004-02-18 00:00:00.000     2
11300        2004-02-08 00:00:00.000     2
11300        2004-02-15 00:00:00.000     1
11300        2004-03-11 00:00:00.000     1
11300        2004-03-24 00:00:00.000     1
11300        2004-03-30 00:00:00.000     1
11300        2004-04-28 00:00:00.000     1
11300        2004-05-03 00:00:00.000     1
11300        2004-05-17 00:00:00.000     1
11300        2004-06-18 00:00:00.000     1
... 
```

不完全是我想要的，因为结果应该只显示 Cnt = 2 的所有记录，如下所示：

```
CustomerID    OrderDate             Cnt
-----------   ----------                ----
11300        2003-11-22 00:00:00.000     2
11300        2004-01-28 00:00:00.000     2
11300        2004-02-18 00:00:00.000     2
11300        2004-02-08 00:00:00.000     2 
```

我被困住了，因为我无法解决两个问题：

1) 一个客户可能有多个具有相同 Cnt 值的 OrderDate。这意味着我不能做像 TOP 1 这样的事情来获得想要的结果。
2）因为每个客户的订单数量可能不同，所以不能使用下面的SQL语句：

```
SELECT CustomerID, OrderDate, COUNT(1) Cnt
FROM Sales.SalesOrderHeader
WHERE CustomerID = 11300
GROUP BY CustomerID, OrderDate HAVING COUNT(1) > 1
ORDER BY Cnt DESC 
```

这将有助于为该客户获得正确的结果，但如果下一位客户在特定日期只有一个订单，则肯定是错误的。

因此，在这种情况下查询是不可能的，或者我以错误的方式处理查询。对此问题的任何想法表示赞赏。

此外，由于这将是存储过程中的查询，因此任何在 T-SQL 中解决此问题的想法都是可以接受的。

更新：感谢[Mehrdad](https://stackoverflow.com/questions/347449/sql-statement-help-select-list-of-customerid-orderdate-with-the-most-records-in#347460)，我被介绍到[Common Table Expressions](http://msdn.microsoft.com/en-us/library/ms190766(SQL.90).aspx)和 Life is Good®。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T10:43:23.340

您应该使用子句来完成任务：`TOP` *`n`* `WITH TIES`

```
SELECT TOP 1 WITH TIES CustomerID, OrderDate, COUNT(*) Cnt
FROM Sales.SalesOrderHeader
WHERE CustomerID = 11300
GROUP BY CustomerID, OrderDate
ORDER BY Cnt DESC 
```

或者，您可以使用*公用表表达式 (CTE)*来解决问题。此解决方案需要 SQL Server 2005 或更高版本：

```
WITH MyTable AS (SELECT CustomerID, OrderDate, COUNT(*) Cnt
                 FROM Sales.SalesOrderHeader
                 WHERE CustomerID = 11300
                 GROUP BY CustomerID, OrderDate)
SELECT CustomerID, OrderDate, Cnt
FROM MyTable
WHERE Cnt = (SELECT MAX(Cnt) FROM MyTable); 
```

如果您使用 CTE 方法，请确保前面的语句以分号结尾（如果它不是第一条语句）。它在 CTE 表达式之前是必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T10:37:40.837

我没有 AdventureWorks 的副本可以方便地进行测试，但是 WITH TIES 子句可以提供帮助吗？您可以执行以下操作：

```
SELECT TOP 1 WITH TIES CustomerID, OrderDate, COUNT(*) Cnt
...
ORDER BY COUNT(*) DESC 
```

...这应该为您提供与您的 ORDER BY 子句中的值匹配的所有行（计数）。

# c# - 正则表达式，数字？

> ID：347463
> 
> 赞同：0
> 
> 时间：2008-12-07T10:46:55.063
> 
> 标签：c#, regex

我编写了一个代码来翻译字符串以匹配从数组 0ne 到数组 2 的每个单词，并显示正确的结果。但是如何让编译器把字符串中的数字按原样打印出来，嗯嗯看我写的代码

* * *

```
class Program
    {
        public static string[] E = { "i", "go", "school", "to", "at" };
        public static string[] A = { "Je", "vais", "ecole", "a", "a" };

        public static string Translate(string s)
        {
            string str = "";
            Regex Expression = new Regex(@"[a-zA-Z]+");
            MatchCollection M = Expression.Matches(s);
            foreach (Match x in M)
                str = str + " " + TranslateWord(x.ToString());
            return str;
        }

public static string TranslateWord(string s)
        {
            for (int i = 0; i < E.Length; i++)
                if (s.ToLower() == E[i].ToLower())
                    return A[i];
            return "Undefined";
        } 
```

* * *

在这里我想输入整个字符串，代码应该用数字翻译它，现在我知道如何做这个词（通过拆分它们并翻译）但是数字呢）

```
 static void Main(string[] args)
        {
            string str = "I go to school at 8";
            Console.WriteLine(Translate(str));
        } 
```

怎么继续？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T10:52:30.667

将您的正则表达式更改为`[a-zA-Z0-9]+`

顺便说一句，你为什么不使用`String.Split`方法而不是正则表达式？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T14:50:13.073

当您真正开始在法语单词上输入重音并且想要拆分法语字符串时，此正则表达式会更好地工作：

```
\w+ 
```

在 .NET 中，\w 包括来自所有脚本的所有字母和数字，而不仅仅是英文 az 和 0-9。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T13:38:03.033

这里有一个提示：

```
public static void process (String s) {
    String [] tokens = s.split("\\s+");
    for (String token : tokens) {
        if (token.matches("[A-Za-z]+")) {
            System.out.println("  word: '" + token + "'");
        } else if (token.matches("[0-9]+")) {
            System.out.println("number: '" + token + "'");
        } else {
            System.out.println(" mixed: '" + token + "'");
        }
    }
} 
```

Wnen 调用例如 ...

```
process("My 23 dogs have 496 fleas."); 
```

...它产生以下内容：

```
 word: 'My'
number: '23'
  word: 'dogs'
  word: 'have'
number: '496'
 mixed: 'fleas.' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T14:53:07.483

如果您的正则表达式引擎支持它，我会使用 [:alnum:] （即 POSIX 类），这样可以实现更便携的正则表达式。像往常一样，请注意语言环境问题。

# sms - 通过 USSD 发送消息需要什么？

> ID：347465
> 
> 赞同：23
> 
> 时间：2008-12-07T10:52:26.283
> 
> 标签：sms, payment, ussd

我正在尝试开始使用**USSD**。我熟悉其他*形式的 SMS*。最终，我想将**USSD**用作实时支付平台的一部分。

谢谢。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-07T12:00:19.063

以下是您在进行 USSD 计划时希望找到答案的一些问题。

•。我们希望渠道如何运作？

对于初学者来说，USSD 就像面向连接的 SMS 通信，即 USSD 之于 SMS 就像 IM 之于电子邮件。通信的启动可以是 USSD-PUSH（移动终止和提供商发起）或 USSD-PULL（移动发起和提供商终止）。在您的情况下，我相信这可能是源自移动设备的 USSD 拉动，移动用户在其手机上拨打 USSD 短代码以访问该应用程序。

•。如果是 USSD-PULL……我们的短代码是什么？

每个应用程序都需要一个单独的短代码。USSD 短代码是类似于互联网世界中的网站地址的网站地址方案。我不确定您来自哪个国家/地区，但在印度，USSD 短代码归移动服务提供商所有，需要让服务提供商为您配置正确的短代码。

•。现在，什么是通信接口？

USSD 使用面向连接的 SMPP 工作。但是，USSD 网关（服务提供商拥有的中间件，可以将 USSD 消息中继到订阅者的手机和从订阅者的手机传出），如今能够充当他们的应用程序接口可以通过 HTTP 或 HTTPS 的桥梁。在这种情况下，我会认为您需要在移动运营商的网关和您的应用程序之间打开 HTTP 或 HTTPS 连接。从那时起，只需构建一个带有文本响应的 Web 应用程序！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-02T08:37:55.277

[Vumi](http://vumi.org)是为您运行 USSD 应用程序的免费开源服务器的名称。

实际上，您需要知道您希望 USSD 代码在哪个国家/地区工作，并与这些网络或已经与这些网络合作的人建立合作伙伴关系。例如，在南非，您可以使用[TruTeq](http://www.truteq.co.za)。或[Vodacom 消息](http://www.vodacommessaging.co.za)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-05T15:27:00.260

我刚刚发现[Mobicents](http://www.mobicents.org/index.html)有一个 ussd 网关和模拟器。您需要做的就是从他们的 SVN 中检查他们的源代码并“mvn clean install”文件。我还没试过。但我知道 mobicent 是一个可靠的程序。

*   这是他们[对 USSD 的介绍](http://www.mobicents.org/incubator/ussd/intro.html)
*   这是他们的[Google 群组](http://groups.google.com/group/mobicents-public)
*   关于如何[安装 ussd 网关的线程](http://groups.google.com/group/mobicents-public/browse_thread/thread/b72d676a42c7e852/291e90d99f7bad02?lnk=gst&q=ussd#291e90d99f7bad02)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-07T11:26:28.557

我只是用谷歌搜索并收集信息。

根据[非结构化补充服务数据 (USSD)](http://www.telecomspace.com/messaging-ussd.html)：

> 非结构化补充服务数据 (USSD) 允许通过 GSM 网络传输信息。与 SMS 相比，它在会话期间提供实时连接。USSD 消息的长度最多为 182 个字母数字字符。非结构化补充服务数据允许 MS 和移动运营商托管的应用程序之间的交互服务。这些消息由数字和#、* 键组成，允许用户轻松快速地从运营商处获取信息/访问服务。
> 
> USSD 消息易于形成且易于发送。用户可以直接输入 ussd 字符串并按 call 发送消息。典型的 USSD 消息以 * 开头，后跟数字，表示要执行的操作或参数。每组数字以 * 分隔，消息以 # 结束。USSD 网关反过来可以根据 USSD 命令与外部应用程序交互。这允许通过 USSD 访问许多增值服务。

*   USSD 适用于所有 II 期或更高版本的 GSM 手机。

但是，如果您[在诺基亚设备上编写 Java MIDlet，它就不起作用](http://discussion.forum.nokia.com/forum/showthread.php?t=145899)。

# sharepoint - 有什么方法可以更改 SharePoint 菜单中菜单项的索引？

> ID：347467
> 
> 赞同：0
> 
> 时间：2008-12-07T10:53:46.080
> 
> 标签：sharepoint, menu

当文档库上的“新建”菜单项展开时，默认似乎是列出该列表的文档模板，并将“新建文件夹”作为最后一个元素（如果“新建文件夹”尚未禁用）。我添加了一个新的自定义菜单项，但它显示在“新文件夹”之后，我希望它显示在索引 0 处，以便在用户单击“新建”而不是展开菜单时作为默认操作。

我试图删除所有文档模板并禁用“创建文件夹”菜单项，添加自定义菜单项，然后启用“创建文件夹”菜单，但随后在我的自定义菜单项之前插入“创建文件夹”...... .

有没有办法确保我的自定义菜单项保持在索引 0 或确保我的自定义菜单项是默认菜单项？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T11:17:35.720

我知道这样做的唯一方法是使用 JavaScript 通过操纵 DOM 来调整项目的顺序。

如果这是您会考虑的事情，那么我有一个实用程序可以提供帮助： http: [//www.codeplex.com/ShUIE/](http://www.codeplex/ShUIE)

您可以使用它来定义仅针对文档库的无效模式运行的自定义 JavaScript，然后插入一段 JavaScript（更容易使用 jQuery，因为它可用）在其中获取菜单并获取新菜单item 并将其添加到父级...这会将其移动到索引 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T23:03:44.973

好的，我确实找到了解决方法：禁用文件夹选项并确保启用“允许管理内容类型”选项。然后您可以从列表中删除任何现有的内容类型，现在自定义菜单项位于索引 0，但由于新菜单项不是内容类型，因此不会通过单击“新建”来触发，但现在可以:-)

# c# - foreach 或 Repeater - 哪个更好？

> ID：347472
> 
> 赞同：10
> 
> 时间：2008-12-07T10:59:08.657
> 
> 标签：c#, asp.net-mvc, loops

我正在使用 MVC 在 ASP.Net 中构建一个网站，并且需要列出一组结果。以下两项都按我的意愿工作，但我想知道哪个更快，更清洁和/或更好 - 或者是否完全有另一种选择更合适？

注意：`ViewData.Model`是类型`IEnumerable<Thing>`，我需要显示更多的属性`Name`- 我已经裁剪了这个例子的代码。

* * *

```
<% foreach (var thing in ViewData.Model)
   { %>
   <p><%= thing.Name %></p>
<% }; %> 
```

* * *

```
<% rptThings.DataSource = ViewData.Model;
   rptThings.DataBind(); %>
<asp:Repeater ID="rptThings" runat="server">
    <ItemTemplate>
    <p><%# DataBinder.Eval(Container.DataItem, "Name") %></p>
    </ItemTemplate>
</asp:Repeater> 
```

* * *

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-07T11:35:54.513

`foreach`是 ASP.NET MVC 的必经之路。为什么？我个人避免使用*任何*遗留`asp:xxx`控件 .. 因为它们可能具有 webforms 模型存在的臃肿。其次，`event delegates`你必须连接的所有东西呢？IMO，您开始混合和匹配架构，因此这可能会严重导致真正的意大利面条代码具有疯狂的维护和支持问题。（IMO：DataBinder.Eval == 非常邪恶 :( :( :( )

我使用的唯一`asp:xxx`控件是`mastpage / content control`（因为没有替代品）。

最后，`foreach`像许多人认为的那样，在 asp.net mvc 中做的不是意大利面条代码。我知道当我第一次看到最初的 mvc 演示时我做到了。如果有的话，它实际上使 UI 比以前更干净，imo .. 更易于维护。IMO，spagetti 代码是当你有很多`<% .. %>`做业务逻辑和 ui 逻辑和（gag）数据库访问时。请记住，这就是 peeps 在 asp.net*经典*的狂野西部所做的：P

## 概括

坚持`foreach`并避免使用任何网络表单控件——它很简单、非常有效并且非常有可能做到。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-07T11:02:02.990

`foreach`如果您不专门搞砸的话，肯定会更快。`Repeater`当然更干净，更巧妙地将 UI 和逻辑分开。有时你需要更多的条件（除了不同的偶数行和奇数行）来正确渲染你的东西，这是`foreach`唯一的选择。

我个人更喜欢`Repeater`正常情况和`foreach`更复杂的情况。

编辑：我说的是带有 WebControls 的普通 ASP.NET。对于 MVC 甚至大部分由代码生成的页面，我同意 foreach 更直接、更干净。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T11:40:02.803

我使用 Phil Haack 的扩展方法中继器。两全其美。[http://haacked.com/archive/2008/05/03/code-based-repeater-for-asp.net-mvc.aspx](http://haacked.com/archive/2008/05/03/code-based-repeater-for-asp.net-mvc.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T15:44:43.433

```
<p each="var item in ViewData.Model">${item.Name}</p> 
```

嗯，美味的[火花](http://dev.dejardin.org/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T15:13:49.033

这是[另一种选择](http://www.codeplex.com/MVCContrib/Wiki/View.aspx?title=Grid&referringTitle=Documentation)。我自己没有使用过这个，但看起来很有趣。

# python - 我可以使用 Python 来拦截 KDE 中的全局击键吗？

> ID：347475
> 
> 赞同：0
> 
> 时间：2008-12-07T11:03:17.480
> 
> 标签：python, kde

我想制作一个简单的应用程序，最好是在 Python 中，它将在 KDE 的后台运行，监听用户所做的所有击键，以便在按下特定组合键时应用程序进入前台。那可行吗？谁能指出我这样的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T04:50:24.377

一个快速的谷歌发现了这个：

[http://sourceforge.net/projects/pykeylogger/](http://sourceforge.net/projects/pykeylogger/)

您也许可以使用一些源代码。

# javascript - Internet Explorer 矩阵变换过滤器问题

> ID：347476
> 
> 赞同：1
> 
> 时间：2008-12-07T11:06:44.557
> 
> 标签：javascript, css, internet-explorer, filter

作为我的一个爱好项目，我正在为 jQuery 开发一个图像效果插件。它应该允许您对图像应用一些基本效果，并通过使用画布 HTML 元素或 Internet Explorer 过滤器来实现这一点，这些都是受支持的。

演示页面位于：http: [//sandbox.odyniec.net/imgfx-new/](http://sandbox.odyniec.net/imgfx-new/)。

我在使用矩阵变换过滤器 (DXImageTransform.Microsoft.Matrix) 实现的旋转效果时遇到问题。

如果我只是旋转图像，生成的图像看起来很好。但是，如果我在旋转之前对图像使用另一种效果，则旋转的图像会被破坏，即。它的一部分变成黑色或白色。您可以在演示页面上看到它。

例如，使用`Invert`按钮，然后`Rotate`旋转 20 度，您会注意到蓝色树应该在的位置出现黑色条纹。应用于图像的实际过滤器显示在页面底部。

我在这里遗漏了什么，或者这可能是浏览器错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-07T11:26:36.653

对我来说看起来像一个浏览器错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T15:15:00.400

您可以尝试将 css 缩放值设置为 1。如果这也不起作用。看来这确实是IE中的一个错误。

# internet-explorer - FF 和 IE 之间重新加载行为的差异

> ID：347482
> 
> 赞同：1
> 
> 时间：2008-12-07T11:23:42.383
> 
> 标签：internet-explorer, http, firefox, caching

在 Firefox 中，Reload 似乎会重新加载所有内容，而在 IE 上，Refresh 只会重新加载当前页面的 HTML 部分。在 IE 中，您需要按 Ctrl-F5 才能完全重新加载。

为什么会有这种差异，是否有一篇文章更彻底地解释了这种差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T11:34:22.223

Firefox 像所有现代浏览器一样使用缓存，因此它不会在刷新时加载所有内容。不同的浏览器引擎处理缓存的方式有所不同，但这主要取决于您发送的标头。

您应该查看 w3 关于[http 中缓存](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html)的页面以及[此缓存教程](http://www.mnot.net/cache_docs/)，以获取有关 Web 缓存如何工作的更多详细信息。此外，这篇关于[Firefox 和 IE 缓存](http://blog.httpwatch.com/2008/10/15/two-important-differences-between-firefox-and-ie-caching/)之间差异的文章也应该是相关的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T11:34:57.523

Ctrl-F5 在 IE 中重新加载，没有缓存。
F5 也应该重新加载图像，只要浏览器检测到它们已更改。

# sql-server - 这个表需要一个或两个唯一键索引吗？

> ID：347483
> 
> 赞同：0
> 
> 时间：2008-12-07T11:24:43.847
> 
> 标签：sql-server, indexing, openid, unique-key

我正在尝试创建一个只有 OpenId 注册的用户表，就像 StackOverflow 一样。

我存储在桌子上

*   OpenId 标识符（他们的登录名）
*   别名（向公众显示的显示名称）
*   其他一些 openId 的东西

所以...我想确保系统中只有一个用户具有 openId 标识符和一个别名。

当然，我可以随时更改我的别名。我也可以随时更改我的 openId 标识符。我需要确保这些是唯一的/只存在一次。

所以...我是为表创建两个唯一键索引，还是创建一个包含两个字段的唯一键索引？

干杯:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T11:28:46.790

制作两个唯一的密钥。否则，同一个 openid 可以关联多个用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T11:29:18.673

他们每个人一个。

如果您只创建一个包含两者的用户，那么您可以拥有 - 例如 - 两个具有相同别名的用户，只要他们有两个不同的 OpenID。

然而：

*   我建议您创建一个用户表和另一个 OpenID 表，以允许用户将多个 OpenID 与其帐户相关联。假设他们在 Yahoo 有一个 OpenID，在 MyOpenID 有另一个。如果 - 由于任何原因 - 雅虎决定关闭其 OpenID 服务，该人仍然可以使用他的 MyOpenID 登录名登录。好吧，只要他早先在他的帐户中注册了该ID。

# sql-server - 将 OpenId 字段保存到数据库 - 它们的类型/长度是多少？

> ID：347486
> 
> 赞同：5
> 
> 时间：2008-12-07T11:27:26.043
> 
> 标签：sql-server, openid

我想将一些 OpenId 字段保存到数据库表中，例如

*   OpenId 标识符
*   全名
*   别名
*   电子邮件
*   ETC..

有没有一个地方可以总结所有常见模式字段的数据类型和长度？我知道有自定义的（每个提供商）..但是常见的呢？

例如。电子邮件 -> nvarchar(250) .. 或其他东西。

干杯:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T04:47:23.243

从技术上讲，OpenID 标识符可以与合法 URL 一样长（实际上大约 2K），但我想说 150 个字符是一个很好的最大值。

顺便说一句，**确保**将声明标识符存储为主键（或等效的查找列），而不是用户提供的标识符或您可能在身份验证过程中看到的任何其他变体。此外，为了真正安全，您需要对 URL 的路径进行区分大小写的比较（您可以在主机区域不区分大小写）。由于区分大小写问题很复杂，我总是将主机规范化为小写，然后对整个字符串进行区分大小写的比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T11:31:33.617

对电子邮件使用常识。我从未见过超过 40-50 个字符的电子邮件地址。任何较长的地址都可能是垃圾邮件或虚假地址。

*编辑*：查看电子邮件 RFC，电子邮件地址的最大长度可能是 64（用户名）+ 1（'@' 字符）+ 255（域）。无论如何，我仍然会选择 100 或更少的最大长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T12:20:09.817

请参阅[OpenID 简单注册扩展 1.0](http://openid.net/specs/openid-simple-registration-extension-1_0.txt)：

> openid.sreg.email：[RFC2822] 第 3.4.1 节中指定的最终用户的电子邮件地址。

# c++ - 在 Xcode 中查看动态数组变量值

> ID：347493
> 
> 赞同：1
> 
> 时间：2008-12-07T11:34:49.320
> 
> 标签：c++, xcode

我有指向结构的指针的动态数组。

```
struct item {
    unsigned long code;     //1 - 2^32
    unsigned short date;    //0 - (13*365+4-31)+1
    unsigned char place;    //1 - 200
    unsigned short amount;  //0 - 10000
    unsigned short price;   //0 - 50000
};

count = getSizeFromSomewhere();

item ** x=new item * [count]; //real used array
item * y[10];  //just for example 
```

当我在 Xcode 中调试这段代码时，我能够观察到**y**数组的每个元素以及项目结构的相应值。但是在**x**数组中我什么都看不到，除了第一个元素（和相应的项目结构）。

有没有办法将 x 视为指针数组（就像我对**y**所做的那样）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T13:12:55.673

由于“x”的内存是在编译时动态分配的，编译器不知道数组的大小。但是 'y' 是在堆栈上分配的，它可以很容易地计算出它的大小。因此，您将无法看到“x”，因为您可以看到“y”。观察“x”的最简单方法是为 x[i] 添加一个观察，其中 i = 0..count-1

# python - 从一个小型 Python Web 框架中发出标头

> ID：347497
> 
> 赞同：3
> 
> 时间：2008-12-07T11:41:34.627
> 
> 标签：python, frameworks

我正在为 Python 编写一个 Web 框架，其目标是尽可能“小”（目前不到 100 行代码）。你可以[在 github 上查看当前代码](http://github.com/dbr/pyerweb/tree/master)

基本上，它被编写为尽可能简单易用。类似网站的示例“Hello World”：

```
from pyerweb import GET, runner

@GET("/")
def index():
    return "<strong>This</strong> would be the output HTML for the URL / "

@GET("/view/([0-9]+?)$")
def view_something(id):
    return "Viewing id %s" % (id) # URL /view/123 would output "Viewing id 123"

runner(url = "/", # url would be from a web server, in actual use
       output_helper = "html_tidy" # run returned HTML though "HTML tidy" 
```

基本上你有一个返回 HTML 的函数，GET 装饰器将它映射到一个 URL。

当`runner()`被调用时，检查每个装饰函数，如果 URL 正则表达式匹配请求 URL，则运行该函数，并将输出发送到浏览器。

现在，问题 - 输出标题。目前为了开发，我刚刚在`runner()`调用之前放了一行`print Content-type:text/html\n`- 这显然有点限制..

我的第一个想法是让函数返回一个字典，比如..

```
@GET("/")
def index():
    return {
        "html": "<html><body>...</body></html>",
        "headers": {"Location":"http://google.com"}
    } 
```

我真的不喜欢这样 - 必须返回一个带有特定命名键的 dict 并不像只返回一个字符串那么好..

我可以检查返回的数据是否是一个字典，如果是`returned_data['html']`作为输出，如果它是一个字符串，则没有要发送的自定义标头......但这意味着从没有标头开始（这将是一个巨大的情况大多数时候）到标题，您必须将返回函数更改`return my_html`为`return {'html':my_html}`也不是很优雅..

写完这篇文章后，我发现了“Sinatra”——一个类似使用的 Ruby 库，并查看了它如何处理标头：

```
get "/" do
    content_type 'text/css', :charset => 'utf-8'
end 
```

这似乎在 Python 中已经足够好了：

```
@GET("/")
def index():
    header("location", "http://google.com") 
```

为了实现这一点，我正在考虑更改函数的执行方式 - 而不是简单地使用返回值，我会更改`sys.stdout`为 StringIO，所以你可以这样做..

```
def index():
    print "<html>"
    print "<head><title>Something</title></head>"
    print "<body>...</body>"
    print "</html> 
```

..不必担心将一堆字符串连接在一起。这样做的结果是我可以有一个单独的标题流，所以上面的`header()`函数会写入这个..类似于：

```
def header(name, value):
    pyerweb.header_stream.write("%s: %s" % (name, value)) 
```

基本上，问题是，你将如何从这个网络框架中输出标题（主要是在*使用*方面，但在较小程度上是实现）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T13:43:28.403

查看[PEP 333](http://www.python.org/dev/peps/pep-0333/)以获得非常轻量级 Web 服务器的出色设计模式。如果你的服务器有这个确切的 API，你可以在很多其他产品的很多上下文中重用它。

PEP 333 (WSGI) 建议您不要直接返回页面，而是将 HTML 页面提供给“start_response”可调用对象，该对象使用适当的标头将 HTML 包装在适当的 HTTP 响应中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T12:53:39.020

您可以使用返回字典或字符串的想法，但添加一个新的装饰器，因此用户的“进化”将是：

简单的html：

```
@GET("/")
def index():
return "<html><body>...</body></html>" 
```

带有恒定的标题（每个标题一个 @HEADER，或者一个包含所有标题的字典）：

```
@GET("/")
@HEADER("Location","http://google.com")
def index():
return "<html><body>...</body></html>" 
```

带有复杂的，可能是计算的标题：

```
@GET("/")
def index():
return {
    "html": "<html><body>...</body></html>",
    "headers": {"Location":"http://google.com"}
} 
```

@HEADER() 装饰器将简单地更改返回值，因此“框架”代码将保持简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T12:04:44.657

您应该重新考虑返回[HTML](http://en.wikipedia.org/wiki/Html)标头是[HTTP](http://en.wikipedia.org/wiki/Http)的一部分的概念。如果您围绕 HTTP 流构建框架，则标头只是 HTML 有效负载之前的行。

来自上述链接的标题示例：

```
HTTP/1.1 200 OK
Date: Mon, 23 May 2005 22:38:34 GMT
Server: Apache/1.3.3.7 (Unix)  (Red-Hat/Linux)
Last-Modified: Wed, 08 Jan 2003 23:11:55 GMT
Etag: "3f80f-1b6-3e1cb03b"
Accept-Ranges: bytes
Content-Length: 438
Connection: close
Content-Type: text/html; charset=UTF-8 
```

有关 Python 示例，请参阅[`BaseHTTPRequestHandler.send_header(keyword, value`)](http://docs.python.org/library/basehttpserver.html#BaseHTTPServer.BaseHTTPRequestHandler.send_header)的实现。

# algorithm - 计算蛮力方法的操作次数

> ID：347501
> 
> 赞同：3
> 
> 时间：2008-12-07T11:47:36.313
> 
> 标签：algorithm, brute-force

我是一名大三学生，我有一门名为“算法设计与分析”的课程。课程很酷，但教练不是。我不了解蛮力以及如何计算操作次数以及如何计算时间复杂度（最差，最好，平均），我试图在网上搜索它，但每次我都以 big-o 结尾符号和我不想要的分而治之。如果你们中的任何人都可以从此链接下载讲师幻灯片，看看我在说什么......

[幻灯片](http://www.sy-stu.com/stu/PublicFiles/StdLibrary/L_15_Design_and_analysis_of_Algorithms_DA_Algorithms_04.ppt)

我真的需要你的帮助，我保证我会尽力而为

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-07T12:14:27.430

蛮力是一类“算法”（或简单地说是“做事方式”），你不会试图变得聪明，只是愚蠢的搜索。例如：如果你想在电话簿中查找电话号码，聪明的解决方案是观察所有条目都按姓氏排序，然后直接查找正确的字母等。蛮力的解决方案是阅读从一开始就查看电话簿，检查每个姓名，并在找到正确的姓名时停止。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T12:38:09.533

[观看本系列算法](http://www.catonmat.net/blog/category/introduction-to-algorithms/)的前几节课，您可能会有所收获。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T12:20:50.473

蛮力是测试特定问题的所有可能配置并测试其中一个是否与解决方案的属性匹配的任务。

考虑一个 4 位数的密码。如果丢失，您可以测试从 0000 到 9999 的所有可能代码以找到正确的代码。这是一种蛮力。

同样的东西可以用来解决一些计算机科学问题，例如 0/1 背包问题，小偷想找出偷什么。每个对象都有值 v[i] 和权重 w[i]。他或她想找出提供最大价值且重量小于“W”的组合。这个问题的一个可能的解决方案是考虑对象的所有组合并找到每个组合的值和权重，然后选择最优的组合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T13:57:15.037

> 我可以举一个关于选择排序和冒泡排序的示例如何计算时间复杂度以及如何计算操作以及旅行商问题是什么

选择排序算法[可从 Wikipedia 获得伪代码](http://en.wikipedia.org/wiki/Selection_sort)，[冒泡排序](http://en.wikipedia.org/wiki/Bubble_sort)也是如此。时间复杂度是通过算法运行直到得到正确答案[的次数来计算的。](http://www.daniweb.com/forums/thread13488.html)

[旅行商问题](http://en.wikipedia.org/wiki/Travelling_Salesman_problem)是计算机科学中的一个经典问题，它通过找出问题的答案来关联算法的执行时间。

以机智：

> 问题是：给定多个城市以及从任何城市到任何其他城市的旅行成本，在每个城市恰好访问一次然后返回起始城市的成本最低的往返路线是什么？

如果我尝试使用一种算法来暴力破解最佳路线，那么在任何比最简单路线更大的路线上都需要*很长时间。*这就是 Big(O) 的用武之地，它向我展示了我选择的每种算法将如何影响我需要多长时间才能得到答案。

我根据您为其他答案留下的评论发布了这个答案。就其价值而言，Big-O 表示法正是您想要的，它是您的算法执行所需时间的指标。

# c# - 为什么内部异常到达 ThreadException 处理程序而不是实际抛出的异常？

> ID：347502
> 
> 赞同：14
> 
> 时间：2008-12-07T11:55:19.263
> 
> 标签：c#, winforms, multithreading, exception-handling

`Application.ThreadException`在抛出异常并在事件处理程序中捕获它们时，我看到了一些奇怪的行为。

基本上下面示例中发生的事情是`DoWork`在`BackgroundWorker`. 事件`RunWorkerCompleted`处理程序以原始异常作为内部异常重新引发新异常。

为什么内部异常出现在`ThreadException`事件处理程序中而不是实际异常被抛出？如果我没有在`RunWorkerCompleted`事件处理程序中提供内部异常，则会显示正确的异常。

```
using System;
using System.Windows.Forms;
using System.ComponentModel;

namespace WierdExceptionApp
{
    class WierdExceptionForm : Form
    {
        BackgroundWorker worker = new BackgroundWorker();

        public WierdExceptionForm()
        {
            worker.DoWork += new DoWorkEventHandler(worker_DoWork);
            worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(worker_RunWorkerCompleted);
            worker.RunWorkerAsync();
        }

        void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            if (e.Error != null)
            {
                throw new Exception("worker_RunWorkerCompleted", e.Error);
            }
        }

        void worker_DoWork(object sender, DoWorkEventArgs e)
        {
            throw new Exception("worker_DoWork");
        }

        [STAThread]
        static void Main()
        {
            Application.ThreadException += new System.Threading.ThreadExceptionEventHandler(Application_ThreadException);
            Application.Run(new WierdExceptionForm());
        }

        static void Application_ThreadException(object sender, System.Threading.ThreadExceptionEventArgs e)
        {
            MessageBox.Show(e.Exception.Message);
        }
   }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-07T21:33:50.607

RunWorkerCompleted 事件由使 Control.Invoke() 工作的 WF 管道从 BGW 线程封送到 UI 线程。本质上，有一个由消息循环清空的委托队列。执行此操作的代码 Control.InvokeMarshaledCallbacks()，您将在调用堆栈上看到它，它有一个 catch (Exception) 子句来捕获未处理的异常。该子句调用 Application.OnThreadException，传递 Exception.GetBaseException() 的值。

嗯，这就解释了为什么你只看到内部异常。为什么这样做有点不清楚。可能会切掉 UI 线程中代码的堆栈帧，因为真正的异常来自后台线程，否则会非常混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T19:08:31.680

```
 if (e.Error != null)
        {
            throw new Exception("worker_RunWorkerCompleted", new Exception("Inner", new Exception("Inner inner")));
        } 
```

最后你会得到“内在的内在”。看来这是 Application_ThreadException 方法查看最内部异常的行为。

# rss - 提供 RSS 和 Atom 提要？我们两者都需要还是 RSS 赢了？

> ID：347504
> 
> 赞同：16
> 
> 时间：2008-12-07T11:58:32.080
> 
> 标签：rss, atom-feed

我想为我的网站提供一些 RSS 提要。是否值得提供 Atom 提要？还是 Atom 是更常见的饲料？有赢家吗？

顺便说一句，这与编程有关，因为我需要对我们将提供的提要进行编程（或使用一些开源代码等）。

## 更新

到目前为止，看起来有人说如果我只需要花时间支持一个 Atom 应该是要走的路吗？其他人同意这些想法（并希望得到一些统计数据的支持？？）

## 可能的解决方案

在网上寻找一些 RSS 架构细节时，我正在阅读[RSS Wiki 条目](http://en.wikipedia.org/wiki/RSS_(file_format))，他们说

> 截至 2007 年 1 月[更新]，来自 www.syndic8.com 的跟踪数据表明，当前使用的 RSS 的三个主要版本是 0.91、1.0 和 2.0。其中，RSS 0.91 占全球 RSS 使用量的 13%，RSS 2.0 占 67%，而 RSS 1.0 占 17%。 [22] 然而，这些数字不包括竞争对手网络提要格式 Atom 的使用。截至 2008 年 8 月[更新]，syndic8.com 网站总共索引了 546,069 个提要，其中 86,496 个是 Atom 的某些方言，438,102 个是 RSS 的某些方言。[23]

这表明 RSS 是 Atom 的主要格式。

所以我可能已经自己回答了这个问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-07T12:27:01.960

可以总结出[一些](http://en.wikipedia.org/wiki/Atom_%28standard%29#Atom_compared_to_RSS_2.0)差异：

*   在 Atom 中，可以指定内容（文本、html），甚至可以是 base64 编码形式的二进制文件（例如，音轨或视频）。
*   使用非常标准的 XML 日期格式 (rfc3339)。
*   处理不同语言的内容。
*   模块化

此外，Atom 文件格式是 Atom 发布协议的更大方案的一部分，它不仅可以用于读取，还可以用于写入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T23:21:08.410

RSS 有点混乱（请参阅[这篇较早的文章](http://www.xml.com/pub/a/2002/12/18/dive-into-xml.html)了解六年前的情况有多糟糕，并意识到那段时间并没有变得更好——***七个***不同的相互不兼容的版本！），所以如果你有一个选择，只想处理一个，你真的应该和Atom一起去......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T12:08:02.450

我不会说要么已经赢了，要么会赢。大多数读者都支持两者，因此没有真正推动一个人接管另一个人。

但是，提供两者可能只是浪费精力。随便选一个，你喜欢哪一个——从你的评论中，我猜是 RSS。

# mobile - 开发用于近场通信 (NFC) 的应用程序

> ID：347507
> 
> 赞同：0
> 
> 时间：2008-12-07T12:02:34.990
> 
> 标签：mobile, nfc

请指出我可以用来构建近场通信应用程序的工具包。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T14:10:37.430

您可以使用 Java 的[非接触式通信 API](http://java.sun.com/developer/technicalArticles/javame/nfc/#3)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-27T16:45:02.623

为了开始，您通常需要获得硬件。例如 NXP、ACS、Omnikey 等。然后您可以购买产品的 SDK（包括 omnikey），它们通常包含用于 JAVA、C 和/或 C# 的 SDK。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-05T12:08:20.147

我建议使用 Android 体验 NFC - 在此处获取 SDK：

[http://developer.android.com/sdk/installing.html](http://developer.android.com/sdk/installing.html)

现在 NFC 是无法使用模拟器模拟的功能。所以你需要购买一个实际的设备。SDK 演示也有一个 FakeTagsActivity，但我不推荐它，因为您可能会引入错误并仅验证您的代码是否基于您自己对 NFC 的假设而工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-10T12:41:02.150

Android 从 Android 2.3 开始支持 NFC

SDK中有一个demo工程

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T13:16:39.010

我创建了一个[NDEF eclipse 插件](http://code.google.com/p/nfc-eclipse-plugin/)，它允许您编写 NDEF 消息，并使用相应的（免费）Android（4.0）应用程序写入标签。

它基于[nfctools](https://github.com/grundid/nfctools)工具包，面向入门级开发人员。

我还添加了您可能感兴趣[的 Android NDEF 工具- 有助于在运行时处理 NDEF 消息。](http://code.google.com/p/ndef-tools-for-android/)

# javascript - “无法在层次结构中的指定点插入节点”

> ID：347510
> 
> 赞同：0
> 
> 时间：2008-12-07T12:07:40.767
> 
> 标签：javascript, exception, firebug

我正在做类似 JavaScript Scaffold 的事情。而且，下面的代码显示了表格。它对所有这些都正常工作，而不仅仅是我得到的一个表 - 在第三行处理的中心 - 我得到异常“节点无法插入层次结构中的指定点”。

```
 function table_one_view(table) {
        $.getJSON('<%= Url.Action("TableOneView", "Scaffold") %>', { table: table },
                function(out) {
                    var tl = tpl('.table-one-view');
                    ctr().empty().append(tl);

                    $.each(out.columns, function(i, n) {
                        tl.find('thead > tr').append(
                            tpl('.table-one-view-header').html(n.name)
                        );
                    });

                    for (var y = 0; y < out.rows.length; y++) {
                        var tl_row = tpl('.table-one-view-row');

                        for (var x = 0; x < out.rows[y].length; x++) {
                            //error is here
                            tl_row.append(tpl('.table-one-view-cell').html(out.rows[y][x] ? out.rows[y][x] : "&nbsp;"));
                        }

                        tl.find('tbody').append(tl_row);
                    }
                }
          );
    }

    function tpl(query) {
      var t = $('.template ' + query).clone(true).removeClass('in');
      t.find('.in').remove();
      return t; 
    }
    function ctr() { return $('.container.scaffold'); } 
```

很快，我可以给你链接，你可以在运行时测试并查看错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T12:45:23.467

我修复了这个，使用时

```
out.rows[y][x].toString() 
```

# javascript - 假“点击”激活 onclick 方法

> ID：347512
> 
> 赞同：57
> 
> 时间：2008-12-07T12:12:29.180
> 
> 标签：javascript, event-handling

我有一个带有**onclick**方法的元素。

我想在另一个函数中激活该方法（或：假点击此元素）。

这可能吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-12-07T12:18:29.433

一旦你选择了一个元素，你可以调用 click()

```
document.getElementById('link').click(); 
```

见：[https ://developer.mozilla.org/En/DOM/Element.click](https://developer.mozilla.org/En/DOM/Element.click)

我不记得这是否适用于 IE，但它应该。我附近没有windows机器。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-12-07T12:21:13.983

如果您使用的是 JQuery，您可以执行以下操作：

```
$('#elementid').click(); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-07T13:03:10.763

我可能会误解您的问题，但是，是的，**这是可能的。**我会这样做的方式是这样的：

```
var oElement = document.getElementById('elementId');   // get a reference to your element
oElement.onclick = clickHandler; // assign its click function a function reference

function clickHandler() {
    // this function will be called whenever the element is clicked
    // and can also be called from the context of other functions
} 
```

现在，只要单击此元素，`clickHandler`就会执行其中的代码。同样，您可以通过在其他函数的上下文中调用该函数来执行相同的代码（甚至分配`clickHandler`给处理由其他元素触发的事件）>

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-07T12:34:28.230

```
var clickEvent = new MouseEvent('click', {
  view: window,
  bubbles: true,
  cancelable: true
});
var element = document.getElementById('element-id'); 
var cancelled = !element.dispatchEvent(clickEvent);
if (cancelled) {
  // A handler called preventDefault.
  alert("cancelled");
} else {
  // None of the handlers called preventDefault.
  alert("not cancelled");
} 
```

[`element.dispatchEvent`](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent)所有主流浏览器都支持。[`simulateClick()`上面的示例基于 MDN](https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events)上的示例函数。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-11-23T10:20:30.120

如果您使用的是 jQuery，则需要使用该`.trigger`函数，因此它类似于：

```
element.trigger('click'); 
```

[http://api.jquery.com/trigger/](http://api.jquery.com/trigger/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-09-24T11:47:46.863

使用`javascript`你可以触发[`click()`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/click)，[`focus()`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus)就像下面的例子

```
document.addEventListener("click", function(e) {
  console.log("Clicked On : ",e.toElement);
},true);
document.addEventListener('focus',function(e){
  console.log("Focused On : ",e.srcElement);
},true);

document.querySelector("#button_1").click();
document.querySelector("#input_1").focus();
```

```
<input type="button" value="test-button" id="button_1">
<input type="text" value="value 1" id="input_1">
<input type="text" value="value 2" id="input_2">
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-07T12:38:54.790

这是一个完美的例子，说明你应该使用像 Prototype 或 JQuery 这样的 JavaScript 库来抽象出跨浏览器的差异。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-07T12:28:16.997

只需调用“onclick”！

这是一个示例html：

```
<div id="c" onclick="alert('hello')">Click me!</div>
<div onclick="document.getElementById('c').onclick()">Fake click the previous link!</div> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-07T12:29:32.283

对于 IE，有[fireEvent()](http://msdn.microsoft.com/lv-lv/library/ms536423(en-us,VS.85).aspx)方法。不知道这是否适用于其他浏览器。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-07T12:27:26.560

我没有使用过 jQuery，但是 IIRC，提到的第一个方法不会触发`onclick`处理程序。

`onclick`如果您不使用事件详细信息，我会直接调用关联的方法。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2010-08-16T21:42:46.333

您也可以尝试获取元素的 onclick 属性，然后将其传递给 eval。尽管对评估有很大的禁忌，但这应该可以工作。我在下面放了一个样本

```
eval(document.getElementById('elementId').getAttribute('onclick')); 
```

# asp.net-mvc - UpdateModel 前缀 - ASP.NET MVC

> ID：347524
> 
> 赞同：10
> 
> 时间：2008-12-07T12:27:05.813
> 
> 标签：asp.net-mvc

我遇到了麻烦`TryUpdateModel()`。我的表单字段以前缀命名，但我使用 - 作为分隔符，而不是默认点。

```
<input type="text" id="Record-Title" name="Record-Title" /> 
```

当我尝试更新模型时，它没有得到更新。如果我将 name 属性更改为`Record.Title`它可以完美地工作，但这不是我想要做的。

```
bool success = TryUpdateModel(record, "Record"); 
```

是否可以使用自定义分隔符？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-08T04:36:47.947

另一件需要注意的是，前缀是为了帮助反射找到要更新的正确字段。例如，如果我的 ViewData 有一个自定义类，例如：

```
public class Customer
{
    public string FirstName {get; set;}
    public string LastName {get; set;}
}

public class MyCustomViewData
{
    public Customer Customer {get; set;}
    public Address Address {get; set;}
    public string Comment {get; set;}
} 
```

我的页面上有一个文本框

```
<%= Html.TextBox("FirstName", ViewData.Model.Customer.FirstName) %> 
```

或者

```
<%= Html.TextBox("Customer.FirstName", ViewData.Model.Customer.FirstName) %> 
```

这是有效的

```
public ActionResult Save (Formcollection form)
{
    MyCustomViewData model = GetModel(); // get our model data

    TryUpdateModel(model, form); // works for name="Customer.FirstName" only
    TryUpdateModel(model.Customer, form) // works for name="FirstName" only
    TryUpdateModel(model.Customer, "Customer", form); // works for name="Customer.FirstName" only
    TryUpdateModel(model, "Customer", form) // do not work

    ..snip..
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T13:48:00.643

除非您实现自己的 ModelBinder。如果您查看[www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)上 DefaultModelBinder 的源代码，您会发现，当您指定前缀时，它通过连接前缀、句点和属性名称来构造名称。不幸的是，执行此操作的 DefaultModelBinder 上的方法是私有静态的，因此不能在派生类中被覆盖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-21T21:06:23.613

这是使用期间的错误决定。下划线会更好。

这意味着您必须单独定义所有 ID。

IE。文本框现在有 Html.TextBox("test.test", new{@id="test")

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-10-16T09:43:01.563

有理由不使用 . 作为 HTML bcs 中的 ID/名称，它不是标准的。例如，如果目标中有一个点，则会中断。

# .net - 通过 ASP.NET MVC 在母版页中使用脚本

> ID：347528
> 
> 赞同：69
> 
> 时间：2008-12-07T12:33:00.777
> 
> 标签：.net, asp.net, asp.net-mvc, scripting

我对 ASP.NET MVC 还很陌生，而且我在使用脚本时遇到了一些麻烦……特别是，我想在大多数页面中使用 jQuery，因此将它放在母版页中是有意义的。但是，如果我这样做（来自我的`~/Views/Shared/Site.Master`）：

```
<script src="../../Scripts/jquery-1.2.6.js" type="text/javascript"></script> 
```

然后这就是客户端所要做的——当然，这只有在我们当前的路线碰巧有正确的关卡数量时才有效。开始`~/Scripts/...`是行不通的。`/Scripts/...`仅当项目位于站点根目录（我不想假设）时，从开始才有效。

我有一种工作方法（我将在下面发布） - 但是：我错过了什么吗？

我宁愿不必涉及脚本管理器，因为这似乎破坏了 ASP.NET MVC 模型的简单性......还是我太担心了？

这是我可以让它工作的方式，它也适用于非平凡的虚拟 - 但它似乎过于复杂：

```
<script src="<%=Url.Content("~/Scripts/jquery-1.2.6.js")%>" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-12-07T13:21:41.413

我有一个 AppHelper 类，其中包含一些添加脚本引用的方法：

```
public static string ReferenceScript(string scriptFile)
{
    var filePath = VirtualPathUtility.ToAbsolute("~/Scripts/" + scriptFile);
    return "<script type=\"text/javascript\" src=\"" + filePath + "\"></script>";
} 
```

所以在您的母版页中，您可以使用：

```
<%= AppHelper.ReferenceScript("jquery-1.2.6.js") %> 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-07-02T04:36:27.407

我认为最简单的方法是使用以下方法，它适用于视图。

```
<script type="text/javascript" src="<%=ResolveUrl("~/Scripts/myscript.js") %>">

</script> 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-12-07T14:20:31.963

根据其他回复，可能是 Html 上的扩展方法（这对于 MVC 来说很常见），类似于 Eduardo 的回答：

```
 <%=Html.Script("~/Scripts/jquery-1.2.6.js")%> 
```

和：

```
public static string Script(this HtmlHelper html, string path)
{
    var filePath = VirtualPathUtility.ToAbsolute(path);
    return "<script type=\"text/javascript\" src=\"" + filePath + "\"></script>";
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-07T12:43:31.287

为什么不将您的母版页指向[Google 的 js 文件托管](http://googleajaxsearchapi.blogspot.com/2008/05/speed-up-access-to-your-favorite.html)？那么即使在部署方面（假设您的站点面向网络），您也可以滥用可能预缓存的 jquery 文件？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-07T13:37:39.850

我做了一些 OJ 提到的，我用这个方法创建了一个 GoogleHelper 类

```
public static string ReferenceGoogleAPI()
{
    var appSettings = new AppSettingsReader();
    string apiKey = appSettings.GetValue("GoogleApiKey", typeof(string)).ToString();
    return ReferenceGoogleAPI(apiKey);
}

public static string ReferenceGoogleAPI(string key)
{
    return "<script type=\"text/javascript\" src=\"http://www.google.com/jsapi?key=" + key + "\"></script>";
}

public static string ReferenceGoogleLibrary(string name, string version)
{
    return "<script type=\"text/javascript\">google.load(\"" + name + "\", \"" + version + "\");</script>";
} 
```

现在我正在添加额外的方法来获取一些 ClientLocation 数据；）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T10:19:34.873

在工作中，我们从后面的 ASP 代码中做这样的事情：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
  Const jQuery As String = "jQuery"

  With Me.Page.ClientScript
    If Not .IsClientScriptIncludeRegistered(jQuery) Then
      .RegisterClientScriptInclude(jQuery, VirtualPathUtility.ToAbsolute("~/Includes/jQuery-1.2.6.js"))
    End If
  End With
End Sub 
```

我不知道是否可以使用 ASP.NET MVC 做到这一点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-29T13:20:03.550

ResolveUrl 是 IMO 最优雅的解决方案。虽然真的很遗憾，但 CSS 的 URL 是由 runat=server 而不是脚本解析的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-14T18:59:19.130

您应该看看使用像 squish 这样的实用程序。它可以为你聚合和混淆你所有的 css 和 js 文件。或者，如果您只是通过使用 ForceDebug() 将其保持在调试状态，则可以使用它来生成脚本标签

[http://www.codethinked.com/squishit-the-friendly-aspnet-javascript-and-css-squisher](http://www.codethinked.com/squishit-the-friendly-aspnet-javascript-and-css-squisher)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-19T09:04:20.207

我只是使用斜杠（/）。例如：

```
<script src="/Script/jquery-1.4.1.js"></script> 
```

当“jquery-1.4.1.js”文件在根目录下时。而且效果很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-12T23:43:14.997

我们的应用程序是使用虚拟目录部署的，并且我们在此处提到的其他答案中遇到了一些问题（未正确解析路径）。一种行之有效的方法（不是唯一的方法）是使用这个：

```
<script src="<%=Request.ApplicationPath%>/Web/AppName/JavaScript/jquery-1.4.1.js"></script> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-31T21:27:50.137

您可以尝试使用 Razor 语法的 Url.Content 扩展方法

```
<script src="@Url.Content("~/Scripts/jquery.min.js")" type="text/javascript"></script> 
```

# workflow - 带有类库的工作流设计器支持

> ID：347529
> 
> 赞同：1
> 
> 时间：2008-12-07T12:33:22.570
> 
> 标签：workflow, workflow-foundation

我需要将工作流添加到现有解决方案中，该解决方案已经包含一个类库和一个网站。如果我将工作流添加到类库中，它们在逻辑上适合，我没有设计器支持。如果我在单独的项目中创建它们，我倾向于具有循环依赖关系，因为我的域对象运行工作流，而工作流需要我的域对象。

避免此问题的首选架构是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T15:49:26.290

如果我理解您的问题，如果您的类库中有对 WF 的设计器支持，那么您可以在那里添加工作流定义吗？

为此，您可以编辑相应的类库项目文件（C# 为 *.csproj）并添加以下行：

在第一个 PropertyGroup 中：

`<ProjectTypeGuids>{14822709-B5A1-4724-98CA-57A101D1B079};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>`

在文件的底部：

对于 VS2008：

`<Import Project="$(MSBuildExtensionsPath)\Microsoft\Windows Workflow Foundation\v3.5\Workflow.Targets" />`

对于 VS2005：

`<Import Project="$(MSBuildExtensionsPath)\Microsoft\Windows Workflow Foundation\v3.0\Workflow.Targets" />`

在 IDE 中重新加载项目后，您应该获得对 WF 的支持。

但正如 gbanfill 所提到的，您也可以以不同的方式组织您的程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T17:44:16.013

我解决该问题的方法是将域对象拆分为 POCO 程序集（称为域）和对 POCO 对象执行操作的方法程序集（称为操作）。这意味着所有其他程序集都可以包含域对象并以这种方式在它们之间传递数据。所以我的解决方案看起来像（任何程序集都可以包含列表中较低的程序集）

*   网站
*   工作流程
*   操作
*   领域

# unit-testing - 如何使用 MSTest 进行行测试？

> ID：347535
> 
> 赞同：42
> 
> 时间：2008-12-07T12:38:55.150
> 
> 标签：unit-testing, mstest, data-driven-tests, rowtest

我知道 MSTest 不支持`RowTest`和类似的测试。

`MSTests`用户做什么？`RowTest`没有支持怎么可能生活？

我已经看到`DataDriven`了测试功能，但听起来开销太大，是否有任何 3rd 方补丁或工具可以让我在 中进行`RowTest`类似的测试`MSTest`？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-07-30T08:48:41.713

```
[TestMethod]
Test1Row1
{
    Test1(1,4,5);
}

[TestMethod]
Test1Row2
{
    Test1(1,7,8);
}

private Test1(int i, int j, int k)
{
   //all code and assertions in here
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-10-23T08:43:46.013

我知道这是一个迟到的答案，但希望它可以帮助其他人。

我到处寻找一个优雅的解决方案，最后自己写了一个。我们在 20 多个具有数千个单元测试和数十万次迭代的项目中使用它。从来没有错过任何一个节拍。

[https://github.com/Thwaitesy/MSTestHacks](https://github.com/Thwaitesy/MSTestHacks)

**1)**安装[NuGet](https://www.nuget.org/packages/MSTestHacks/ "NuGet")包。

**2）**从TestBase继承你的测试类

```
public class UnitTest1 : TestBase
{ } 
```

**3)**创建返回 IEnumerable 的属性、字段或方法

```
public class UnitTest1 : TestBase
{
    private IEnumerable<int> Stuff
    {
        get
        {
            //This could do anything, get a dynamic list from anywhere....
            return new List<int> { 1, 2, 3 };
        }
    }
} 
```

**4)**将 MSTest DataSource 属性添加到您的测试方法中，指向上面的 IEnumerable 名称。这需要完全合格。

```
[DataSource("Namespace.UnitTest1.Stuff")]
public void TestMethod1()
{
    var number = this.TestContext.GetRuntimeDataSourceObject<int>();

    Assert.IsNotNull(number);
} 
```

**最终结果：** 3 次迭代，就像普通的 DataSource 一样 :)

```
using Microsoft.VisualStudio.TestTools.UnitTesting;
using MSTestHacks;

namespace Namespace
{
    public class UnitTest1 : TestBase
    {
        private IEnumerable<int> Stuff
        {
            get
            {
                //This could do anything, get a dynamic list from anywhere....
                return new List<int> { 1, 2, 3 };
            }
        }

        [DataSource("Namespace.UnitTest1.Stuff")]
        public void TestMethod1()
        {
            var number = this.TestContext.GetRuntimeDataSourceObject<int>();

            Assert.IsNotNull(number);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-14T08:56:38.690

我们在 VS2012 Update1 中添加了对 DataRow 的支持。[有关简要介绍，请参阅此博客](http://blogs.msdn.com/b/visualstudioalm/archive/2012/10/26/final-ctp-for-visual-studio-2012-update-1.aspx)

在 VS2012 Update1 中，此功能目前仅限于 Windows 商店应用程序。在以后的版本中，它不受此限制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-10T21:45:22.837

在我使用 MS Test 框架的团队中，我们开发了一种技术，该技术仅依赖匿名类型来保存一组测试数据，并使用 LINQ 循环并测试每一行。它不需要额外的类或框架，并且往往相当容易阅读和理解。它也比使用外部文件或连接数据库的数据驱动测试更容易实现。

例如，假设您有一个这样的扩展方法：

```
public static class Extensions
{
    /// <summary>
    /// Get the Qtr with optional offset to add or subtract quarters
    /// </summary>
    public static int GetQuarterNumber(this DateTime parmDate, int offset = 0)
    {
        return (int)Math.Ceiling(parmDate.AddMonths(offset * 3).Month / 3m);
    }
} 
```

您可以使用和组合到 LINQ 的匿名类型数组来编写如下测试：

```
[TestMethod]
public void MonthReturnsProperQuarterWithOffset()
{
    // Arrange
    var values = new[] {
        new { inputDate = new DateTime(2013, 1, 1), offset = 1, expectedQuarter = 2},
        new { inputDate = new DateTime(2013, 1, 1), offset = -1, expectedQuarter = 4},
        new { inputDate = new DateTime(2013, 4, 1), offset = 1, expectedQuarter = 3},
        new { inputDate = new DateTime(2013, 4, 1), offset = -1, expectedQuarter = 1},
        new { inputDate = new DateTime(2013, 7, 1), offset = 1, expectedQuarter = 4},
        new { inputDate = new DateTime(2013, 7, 1), offset = -1, expectedQuarter = 2},
        new { inputDate = new DateTime(2013, 10, 1), offset = 1, expectedQuarter = 1},
        new { inputDate = new DateTime(2013, 10, 1), offset = -1, expectedQuarter = 3}
        // Could add as many rows as you want, or extract to a private method that
        // builds the array of data
    }; 
    values.ToList().ForEach(val => 
    { 
        // Act 
        int actualQuarter = val.inputDate.GetQuarterNumber(val.offset); 
        // Assert 
        Assert.AreEqual(val.expectedQuarter, actualQuarter, 
            "Failed for inputDate={0}, offset={1} and expectedQuarter={2}.", val.inputDate, val.offset, val.expectedQuarter); 
        }); 
    }
} 
```

使用此技术时，使用包含 Assert 中的输入数据的格式化消息会很有帮助，以帮助您识别导致测试失败的行。

我已经在[AgileCoder.net](http://agilecoder.net/2015/01/08/data-driven-mstest/)上发布了有关此解决方案的博客，其中包含更多背景和详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-06T01:02:56.257

[博客http://blog.drorhelper.com/2011/09/enabling-parameterized-tests-in-mstest.html](http://blog.drorhelper.com/2011/09/enabling-parameterized-tests-in-mstest.html)中描述了使用 PostSharp 的类似于 DaTest（自 2008 年以来未更新）的解决方案

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-04T23:49:45.240

我已经通过使用不同数量的生成测试方法生成测试类代码解决了这个问题。您只需下载 2 个文件并将它们包含到您的项目中。
然后在测试代码中对具有所需行数的类进行子类化，并实现 2 个抽象方法：

```
[TestClass]
public class Ha_ha_ha_Test: MsTestRows.Rows.TestRows_42<string>
{
    public override void TestMethod(string dataRow, int rowNumber)
    {
        Console.WriteLine(dataRow);
        Assert.IsFalse(dataRow.Contains("3"));
    }

    public override string GetNextDataRow(int rowNumber)
    {
        return "data" + rowNumber;
    }
} 
```

**更多细节：**

[https://github.com/dzhariy/mstest-rows](https://github.com/dzhariy/mstest-rows)

# python - 将浮点数舍入到最接近的因子？

> ID：347538
> 
> 赞同：6
> 
> 时间：2008-12-07T12:45:15.933
> 
> 标签：python, algorithm, math

我有一个要解决的小数学问题

给定一个数字 x 和分辨率 y，我需要找到具有所需分辨率的下一个 x'。

例如

```
x = 1.002     y = 0.1   x'= 1.1

x = 0.348     y = 0.1   x'= 0.4

x = 0.50      y = 1     x'= 1

x = 0.32      y = 0.05     x'= 0.35 
```

在 Python 中有什么聪明的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-07T13:00:28.290

```
import math

def next_multiple(x, y):
    return math.ceil(x/y)*y

def try_it(x, y):
    print x, y, next_multiple(x, y)

for x, y in [
    (1.002, 0.1),
    (0.348, 0.1),
    (0.50, 1),
    (0.32, 0.05)
    ]:
    try_it(x, y) 
```

产生：

```
1.002 0.1 1.1
0.348 0.1 0.4
0.5 1 1.0
0.32 0.05 0.35 
```

我认为您的第一个示例输出是错误的，x' 的正确答案是 1.1，对吗？

# eclipse - eclipse 工作空间文件的文件格式

> ID：347546
> 
> 赞同：13
> 
> 时间：2008-12-07T12:53:50.253
> 
> 标签：eclipse, file, format, workspace

是否有关于 Eclipse 工作区文件（.location、x.tree、...）格式的（好的）文档？

我需要这个以编程方式为自动构建创建一个工作区。不幸的是，我必须从 .NET 程序中完成这项工作，所以我不能使用任何 Eclipse 类来完成这项工作！（我们使用 Eclipse + CDT 管理我们的 Linux C++ 项目）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T17:19:25.223

不完全是一个准确的答案，但我只想为您的问题指出以下来源：

*   [日食维基](http://wiki.eclipse.org/Workspace)，
*   [Eclipse 工作区团队博客](http://polishineclipse.blogspot.com/)
*   Eclipse[**平台邮件列表**](http://dev.eclipse.org/newslists/news.eclipse.platform/maillist.html)

可能在这三个链接之间，您会找到工作空间结构的实际文档（如果您这样做，请在此处发布答案；））

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T14:31:06.263

这不会是一个有用的答案。

如果可能的话，我会尝试诱使 Eclipse 为您生成工作区。否则，您将深入研究大量未记录的内部 API，并尝试重新实现文件系统，这实际上是另一个内部 API。

Eclipse 清楚地表明，当您使用内部 API 时，您只能靠自己，并且小心地说这些可能随时中断（例如，非常小的点发布）。

**编辑：您还可以在查看此**[问题](https://stackoverflow.com/questions/305787/how-can-i-build-an-eclipse-plugin-outside-of-eclipse)的建议时找到帮助。还有[buckminster](http://www.eclipse.org/buckminster/)，您可能会因为其他原因发现它也很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-30T13:35:03.787

根据您的构建系统的复杂程度，使用 Apache Ant 或 Nant 等专用构建系统可能会更简单。Ant 有一个 .NET 库，位于：[http](http://ant.apache.org/antlibs/dotnet/) ://ant.apache.org/antlibs/dotnet/ ，可能还有其他构建系统。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-11T16:31:16.757

这是一个很好的解决方案：

[http://eclipseone.wordpress.com/2010/01/25/checkout-multiple-projects-automatically-into-your-eclipse-workspace/](http://eclipseone.wordpress.com/2010/01/25/checkout-multiple-projects-automatically-into-your-eclipse-workspace/)

# bash - 用什么工具画文件树图

> ID：347551
> 
> 赞同：106
> 
> 时间：2008-12-07T13:01:18.037
> 
> 标签：bash, shell, filesystems, diagram

给定一个文件树 - 一个包含目录的目录等，你将如何编写脚本来创建文件树的图表作为我可以嵌入到文字处理器文档中的图形文件。我更喜欢矢量（SVG、EPS、EMF...）文件。该工具必须在 Windows 上运行，但最好是跨平台的。该工具可以是商业的，但最好是免费的。

2012 年 2 月 20 日更新。该问题与文档子项目有关。我必须解释文件（特别是资源和配置文件）所在的位置。我最终使用了 dos tree 命令。我在屏幕上都抓取了结果（对于短文件夹），对于较长的文件夹，我重定向到一个文本文件，然后我对其进行了编辑。例如，如果一个子文件夹包含 20 个类似类型的文件，这些文件对我所做的点来说并不重要，我只留下两个，并将其余的替换为一个 ... 行。然后我再次将文件打印到控制台并在屏幕上抓取它。在抓取屏幕之前，我必须将前景色修改为黑色，将背景色修改为白色，以便在打印的文档中看起来更好并节省墨水。

令人惊讶的是，没有更好的工具。如果我有时间，我会编写一个 Visio Extension 或者可能是一些生成 SVG 的命令行。SVG 不符合 HTML5 标准，甚至可以轻松包含在在线文档中。

2017 年 10 月 17 日更新。很抱歉，这个问题因不属于 SO 而被删除。所以我重新措辞了。我需要一个脚本——而不是所见即所得的工具。所以任何脚本语言或库都可以。所以这是一个代码编写问题，我相信属于 SO。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2008-12-07T13:32:13.637

从 MS-DOS`tree`命令复制和粘贴也可能对您有用。例子：

**树**

```
C:\Foobar>tree
C:.
├───FooScripts
├───barconfig
├───Baz
│   ├───BadBaz
│   └───Drop
... 
```

**树 /F**

```
C:\Foobar>tree
C:.
├───FooScripts
│    foo.sh
├───barconfig
│    bar.xml
├───Baz
│   ├───BadBaz
│   │    badbaz.xml
│   └───Drop
... 
```

**树 /A**

```
C:\Foobar>tree /A
C:.
+---FooScripts
+---barconfig
+---Baz
¦   +---BadBaz
¦   \---Drop
... 
```

**树 /F /A**

```
C:\Foobar>tree /A
C:.
+---FooScripts
¦    foo.sh
+---barconfig
¦    bar.xml
+---Baz
¦   +---BadBaz
¦   ¦    badbaz.xml
¦   \---Drop
... 
```

### 语法^([[来源](https://www.computerhope.com/treehlp.htm)])

`tree`[ `drive:`][ `path`] [ `/F`] [ `/A`]

> `drive:\path`— 驱动器和包含磁盘的目录，用于显示目录结构，而不列出文件。
> 
> `/F`— 包括每个目录中的所有文件。
> 
> `/A`— 用 ext characters 代替用于连接线的图形字符，而不是图形字符。`/a`与不支持图形字符的代码页一起使用，并将输出发送到不能正确解释图形字符的打印机。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-07T13:25:00.423

[Graphviz](http://www.graphviz.org/) - 来自网页：

> Graphviz 布局程序以简单的文本语言对图形进行描述，并以多种有用的格式制作图表，例如用于网页的图像和 SVG，用于包含在 PDF 或其他文档中的 Postscript；或显示在交互式图形浏览器中。（Graphviz 还支持 GXL，一种 XML 方言。）

这是我发现的用于创建各种框线图的最简单、最高效的工具。我拥有并使用 Visio 和 OmniGraffle，但总是有“再做一次调整”的诱惑。

编写代码来生成 Graphiz 使用的“点文件”格式也很容易，因此自动化图表生成也很容易实现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-07T13:23:44.233

为什么你不能在 Windows 文件系统上创建一个文件结构并用你想要的名称填充它，然后使用像 HyperSnap（或无处不在的 Alt-PrtScr）这样的屏幕抓取工具来捕获资源管理器窗口的一部分。

我在“演示”具有可折叠部分的互联网应用程序时这样做了，我只需要创建看起来像我想要的条目的文件。

HyperSnap 至少提供 JPG（可能是其他的，但我从来没有费心去调查）。

或者您可以从资源管理器中截取图标 +/- 并在 MS Word Draw 中使用它们来制作您的图片，但我一直无法让 MS Word Draw 正常运行。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-09T00:39:21.030

正如所承诺的，这是我的开罗版本。我用 Lua 编写了脚本，使用 lfs 来遍历目录。我喜欢这些小挑战，因为它们允许我探索我想挖掘很长一段时间的 API……
lfs 和 LuaCairo 都是跨平台的，所以它应该可以在其他系统上运行（在法语 WinXP Pro SP3 上测试）。

当我走在树上时，我制作了第一个版本的绘图文件名。优点：没有内存开销。不便之处：我必须事先指定图片尺寸，所以很可能会被截断。

所以我做了这个版本，首先遍历目录树，将其存储在 Lua 表中。然后，知道文件的数量，创建适合（至少垂直）的画布并绘制名称。
您可以轻松地在 PNG 渲染和 SVG 渲染之间切换。后者的问题：Cairo 在低级别生成它，绘制字母而不是使用 SVG 的文本功能。好吧，至少，即使在没有字体的系统上，它也能保证准确的渲染。但是文件更大......如果你在压缩它之后拥有一个 .svgz 文件，这并不是一个问题。
或者直接生成svg应该不会太难，我以前是用lua生成svg的。

```
-- LuaFileSystem <http://www.keplerproject.org/luafilesystem/>
require"lfs"
-- LuaCairo <http://www.dynaset.org/dogusanh/>
require"lcairo"
local CAIRO = cairo

local PI = math.pi
local TWO_PI = 2 * PI

--~ local dirToList = arg[1] or "C:/PrgCmdLine/Graphviz"
--~ local dirToList = arg[1] or "C:/PrgCmdLine/Tecgraf"
local dirToList = arg[1] or "C:/PrgCmdLine/tcc"
-- Ensure path ends with /
dirToList = string.gsub(dirToList, "([^/])$", "%1/")
print("Listing: " .. dirToList)
local fileNb = 0

--~ outputType = 'svg'
outputType = 'png'

-- dirToList must have a trailing slash
function ListDirectory(dirToList)
  local dirListing = {}
  for file in lfs.dir(dirToList) do
    if file ~= ".." and file ~= "." then
      local fileAttr = lfs.attributes(dirToList .. file)
      if fileAttr.mode == "directory" then
        dirListing[file] = ListDirectory(dirToList .. file .. '/')
      else
        dirListing[file] = ""
      end
      fileNb = fileNb + 1
    end
  end
  return dirListing
end

--dofile[[../Lua/DumpObject.lua]] -- My own dump routine
local dirListing = ListDirectory(dirToList)
--~ print("\n" .. DumpObject(dirListing))
print("Found " .. fileNb .. " files")

--~ os.exit()

-- Constants to change to adjust aspect
local initialOffsetX = 20
local offsetY = 50
local offsetIncrementX = 20
local offsetIncrementY = 12
local iconOffset = 10

local width = 800 -- Still arbitrary
local titleHeight = width/50
local height = offsetIncrementY * (fileNb + 1) + titleHeight
local outfile = "CairoDirTree." .. outputType

local ctxSurface
if outputType == 'svg' then
  ctxSurface = cairo.SvgSurface(outfile, width, height)
else
  ctxSurface = cairo.ImageSurface(CAIRO.FORMAT_RGB24, width, height)
end
local ctx = cairo.Context(ctxSurface)

-- Display a file name
-- file is the file name to display
-- offsetX is the indentation
function DisplayFile(file, bIsDir, offsetX)
  if bIsDir then
    ctx:save()
    ctx:select_font_face("Sans", CAIRO.FONT_SLANT_NORMAL, CAIRO.FONT_WEIGHT_BOLD)
    ctx:set_source_rgb(0.5, 0.0, 0.7)
  end

  -- Display file name
  ctx:move_to(offsetX, offsetY)
  ctx:show_text(file)

  if bIsDir then
    ctx:new_sub_path() -- Position independent of latest move_to
    -- Draw arc with absolute coordinates
    ctx:arc(offsetX - iconOffset, offsetY - offsetIncrementY/3, offsetIncrementY/3, 0, TWO_PI)
    -- Violet disk
    ctx:set_source_rgb(0.7, 0.0, 0.7)
    ctx:fill()
    ctx:restore() -- Restore original settings
  end

  -- Increment line offset
  offsetY = offsetY + offsetIncrementY
end

-- Erase background (white)
ctx:set_source_rgb(1.0, 1.0, 1.0)
ctx:paint()

--~ ctx:set_line_width(0.01)

-- Draw in dark blue
ctx:set_source_rgb(0.0, 0.0, 0.3)
ctx:select_font_face("Sans", CAIRO.FONT_SLANT_NORMAL, CAIRO.FONT_WEIGHT_BOLD)
ctx:set_font_size(titleHeight)
ctx:move_to(5, titleHeight)
-- Display title
ctx:show_text("Directory tree of " .. dirToList)

-- Select font for file names
ctx:select_font_face("Sans", CAIRO.FONT_SLANT_NORMAL, CAIRO.FONT_WEIGHT_NORMAL)
ctx:set_font_size(10)
offsetY = titleHeight * 2

-- Do the job
function DisplayDirectory(dirToList, offsetX)
  for k, v in pairs(dirToList) do
--~ print(k, v)
    if type(v) == "table" then
      -- Sub-directory
      DisplayFile(k, true, offsetX)
      DisplayDirectory(v, offsetX + offsetIncrementX)
    else
      DisplayFile(k, false, offsetX)
    end
  end
end

DisplayDirectory(dirListing, initialOffsetX)

if outputType == 'svg' then
    cairo.show_page(ctx)
else
  --cairo.surface_write_to_png(ctxSurface, outfile)
  ctxSurface:write_to_png(outfile)
end

ctx:destroy()
ctxSurface:destroy()

print("Found " .. fileNb .. " files") 
```

当然，您可以更改样式。我没有画连接线，我没有看到它是必要的。我以后可能会选择性地添加它们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-07T22:49:28.693

使用 Graphviz 的建议很好：您可以生成点文件，它会完成测量字符串、布局等的艰苦工作。此外，它可以以多种格式输出图形，包括矢量格式。

我在一个邮件列表中发现了一个 Perl 程序正是这样做的，但我就是找不到它！我复制了示例点文件并对其进行了研究，因为我不太了解这种声明性语法，我想了解更多。

问题：使用最新的 Graphviz，我在原始图表和我（手动）编写的图表中都有错误（或者更确切地说是警告，因为生成了最终图表）。一些搜索显示此错误是在旧版本中发现的，而在较新的版本中消失了。好像又回来了

我仍然提供文件，也许它可以成为某人的起点，或者它足以满足您的需求（当然，您仍然必须生成它）。

```
digraph tree
{
  rankdir=LR;

  DirTree [label="Directory Tree" shape=box]

  a_Foo_txt [shape=point]
  f_Foo_txt [label="Foo.txt", shape=none]
  a_Foo_txt -> f_Foo_txt

  a_Foo_Bar_html [shape=point]
  f_Foo_Bar_html [label="Foo Bar.html", shape=none]
  a_Foo_Bar_html -> f_Foo_Bar_html

  a_Bar_png [shape=point]
  f_Bar_png [label="Bar.png", shape=none]
  a_Bar_png -> f_Bar_png

  a_Some_Dir [shape=point]
  d_Some_Dir [label="Some Dir", shape=ellipse]
  a_Some_Dir -> d_Some_Dir

  a_VBE_C_reg [shape=point]
  f_VBE_C_reg [label="VBE_C.reg", shape=none]
  a_VBE_C_reg -> f_VBE_C_reg

  a_P_Folder [shape=point]
  d_P_Folder [label="P Folder", shape=ellipse]
  a_P_Folder -> d_P_Folder

  a_Processing_20081117_7z [shape=point]
  f_Processing_20081117_7z [label="Processing-20081117.7z", shape=none]
  a_Processing_20081117_7z -> f_Processing_20081117_7z

  a_UsefulBits_lua [shape=point]
  f_UsefulBits_lua [label="UsefulBits.lua", shape=none]
  a_UsefulBits_lua -> f_UsefulBits_lua

  a_Graphviz [shape=point]
  d_Graphviz [label="Graphviz", shape=ellipse]
  a_Graphviz -> d_Graphviz

  a_Tree_dot [shape=point]
  f_Tree_dot [label="Tree.dot", shape=none]
  a_Tree_dot -> f_Tree_dot

  {
    rank=same;
    DirTree -> a_Foo_txt -> a_Foo_Bar_html -> a_Bar_png -> a_Some_Dir -> a_Graphviz [arrowhead=none]
  }
  {
    rank=same;
    d_Some_Dir -> a_VBE_C_reg -> a_P_Folder -> a_UsefulBits_lua [arrowhead=none]
  }
  {
    rank=same;
    d_P_Folder -> a_Processing_20081117_7z [arrowhead=none]
  }
  {
    rank=same;
    d_Graphviz -> a_Tree_dot [arrowhead=none]
  }
}

> dot -Tpng Tree.dot -o Tree.png
Error: lost DirTree a_Foo_txt edge
Error: lost a_Foo_txt a_Foo_Bar_html edge
Error: lost a_Foo_Bar_html a_Bar_png edge
Error: lost a_Bar_png a_Some_Dir edge
Error: lost a_Some_Dir a_Graphviz edge
Error: lost d_Some_Dir a_VBE_C_reg edge
Error: lost a_VBE_C_reg a_P_Folder edge
Error: lost a_P_Folder a_UsefulBits_lua edge
Error: lost d_P_Folder a_Processing_20081117_7z edge
Error: lost d_Graphviz a_Tree_dot edge 
```

我会尝试另一个方向，使用 Cairo，它也可以导出多种格式。这是更多的工作（计算位置/偏移量），但结构很简单，不应该太难。

# javafx - javafx 1.0 对齐和布局

> ID：347553
> 
> 赞同：1
> 
> 时间：2008-12-07T13:02:01.623
> 
> 标签：javafx

在 JavaFX 1.0 版本中，我尝试在 HBox 中布局一些 SwingButton 实例，使它们与右侧对齐。网络上的很多教程（诚然是 1.0 之前的版本）都在讨论布局类（FlowPanel 等），而这些似乎不在这个版本中。完成这个看似简单的任务的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T10:40:37.617

免责声明：尚未对此进行测试，但同一教程的其他部分效果很好。

[http://java.sun.com/javafx/1/tutorials/ui/layout/index.html](http://java.sun.com/javafx/1/tutorials/ui/layout/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T21:45:17.107

布局 JavaFX 组件有两种更简单的方法。

一种是使用 JFXtras 包，它有一个类似于 Mig Layout 的布局系统（不要称它为管理器 :)）：

[http://code.google.com/p/jfxtras/](http://code.google.com/p/jfxtras/)

第二种选择是使用 ReportMill 中的 JFXBuilder 布局组件： [http ://www.reportmill.com/](http://www.reportmill.com/)

JFXBuilder 是第一个用于 JavaFX 的真正 WYSWIG 编码工具。

问候，马克

# visual-studio-2008 - Visual Studio 2008 + Windows Vista 上的嵌入式 Web 服务器

> ID：347558
> 
> 赞同：1
> 
> 时间：2008-12-07T13:09:19.177
> 
> 标签：visual-studio-2008, windows-vista

操作系统：Windows Vista Business SP1

IDE：Visual Studio 2008 SP1

问题：当我在 VS 2008 中创建一个新的 Web 应用程序并启动它时，VS 2008 的嵌入式 Web 服务器在一个端口（比如 50140）上启动。然后浏览器 (IE7) 会自动启动地址[http://localhost:50137/](http://localhost:50137/) ...，注意不同的端口号。显然，IE 请求的端口上没有任何内容。我应该怎么做才能让 IE 在与服务器启动相同的端口上启动？对于 Windowx XP，不会出现此问题...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T14:07:30.197

您可以在项目属性中检查 Web 启动选项。加载特定 URL 可能是硬编码的 - 可能来自以前的运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T14:05:43.337

我猜您的解决方案中有多个项目，其中一个必须是 Web 服务，另一个（在 IE 中）是 Web 应用程序。

# gcc - 可以安装 gcc，但 g++ 不起作用？

> ID：347564
> 
> 赞同：1
> 
> 时间：2008-12-07T13:19:48.203
> 
> 标签：gcc, autotools

我对简单的 C++ 程序有疑问...

我想安装一个程序，但总是出现“c++ 编译器无法创建可执行文件”之类的错误...

现在我尝试编译一个简单的“hello world”程序，但是如果我使用 ac 编译器编译一个 c++ 程序（“`cout' undeclared”......虽然我包含了 iostream），我会得到错误......

现在我不确定，如果 g++ 在我的机器上不起作用？

有谁知道如何解决这个问题？

非常感谢你提前......
克里斯

* * *

*添加*响应 Pax 的回答：

好吧，我认为，我的代码还可以，我可以在另一台机器上编译它，并且我使用命名空间 std...

所以，g++ 的配置不匹配或类似的东西是不可能的......？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T13:50:24.490

您是否尝试直接调用 g++？如果你运行：

```
g++ 
```

并且它没有安装，你应该得到通常的*无效命令*消息，但如果它已安装，你应该看到如下内容：

```
g++: no input files 
```

如果您看到，请尝试运行以下命令：

```
g++ -o output-file input-file 
```

用任何东西替换输出文件和输入文件。您可以指定多个输入源文件。

如果安装了 g++，那应该可以。通常你不需要配置任何东西。如果它不起作用，那么很可能它根本没有安装。

在基于 debian 的机器上，您应该能够简单地*apt-get install g++*在其他系统上应该同样容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T14:23:23.800

在运行 configure 时尝试诊断问题的最大帮助是查看 config.log。该文件中显示的最后一个错误是导致您看到的消息的原因。我见过很多配置输出错误的实例，但日志显示问题出在完全不同的组件上（例如，在检查库之前尝试使用它）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T20:35:21.207

除了调用“错误”编译器（使用 gcc 而不是 g++，参见 Dan 的回答）之外，正确构建 gcc 但错误构建 g++是**可能的，但不常见。**

也有可能您的系统仅带有 gcc，并且后来有人将 g++ 安装到了不同的目录中。如果是这样，可能是较新的 g++ 设置不正确。

尝试运行命令

```
which gcc
which c++ 
```

从命令行。如果 gcc 在 /usr/bin 中，而 g++ 在 /usr/local/bin 中，那么你可能会遇到这个问题。您还可以询问版本是否匹配：

```
gcc --version
g++ --version 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T02:22:15.020

“`cout' undeclared” 很可能意味着您的源代码中存在错误。

请向我们展示您的源代码，或者编译并运行它：

```
#include <iostream>
int main() { std::cout << "Hello" << std::endl; } 
```

如果上面的代码没有编译（使用例如`"g++ t.cc"`），显示*完整*的错误信息，并从`"g++ -v"`.

如果它确实编译并运行（这很可能），那么您的 g++ 没有任何问题，问题出在您的源代码上。您的源代码在不同的机器上编译这一事实*没有任何意义*——您的代码仍然可能被严重破坏。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-09-03T23:59:47.247

在您的机器上安装 build-essential 软件包，然后重试。这为我解决了同样的问题。

```
sudo apt-get install build-essential 
```

# graphics - 适用于 Windows Mobile 的最佳 2D 图形库是什么？

> ID：347571
> 
> 赞同：2
> 
> 时间：2008-12-07T13:28:08.060
> 
> 标签：graphics, windows-mobile, 2d, pocketpc

标题不言自明......我试图找到另一个类似的问题，但如果它存在，一定错过了。我正在寻找任何东西，从替换 GAPI 的核心库到 .net 包装器......它用于构建一个漂亮的 UI，因此不需要 3D......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T13:45:15.467

.NET 中的 System.Drawing 类比人们想象的要强大得多。唯一缺少的（这在 2D 图形中实际上非常重要）是读取和写入单个像素的能力。这在技术上使用 Bitmap 对象上的 GetPixel 和 SetPixel 方法是可行的，但这些方法的速度快得难以想象。

幸运的是，您可以通过在位图上调用 LockBits 然后直接访问位图的字节数据来实现一个超快速的替代方案。我用这个效果很好。事实上，我上周完全在 .NET 中创建了鱼眼镜头效果（根本没有库或 PInvoke 调用）。

这个 JPEG 有点糟糕，但它展示了仅使用 .NET 的可能性：

[替代文字 http://www.freeimagehosting.net/uploads/5fdd250b21.jpg](http://www.freeimagehosting.net/uploads/5fdd250b21.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T07:03:25.877

看看 WMGL [http://www.mobilityflow.com/products/wmgl/](http://www.mobilityflow.com/products/wmgl/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T19:33:11.570

IMO我建议以某种方式获取帧缓冲区并在可能的情况下直接绘制到它，或者使用D3DM或通过coredll.dll中的DrawGradient（）等API使用本机平台（GDI）提供的绘图服务，因为你在WM 你也许可以利用aygshell.dll 来绘制小部件。

这里有一些链接...

1)[使用点网的](http://msdn.microsoft.com/en-us/library/ms229655.aspx)
渐变填充 2)[直接使用渐变填充](http://msdn.microsoft.com/en-us/library/aa925212.aspx)
3)[其他原生 GDI 功能](http://msdn.microsoft.com/en-us/library/aa923590.aspx)

# iphone - 从“详细视图”返回后如何刷新表格视图？

> ID：347572
> 
> 赞同：15
> 
> 时间：2008-12-07T13:28:29.980
> 
> 标签：iphone, cocoa-touch

我是 iPhone 和 Apple 开发的新手，正在开发我的第一个应用程序。It simple with only a TableView and a "detail view" when an item in a table is selected.

我想要做的是根据我在“详细视图”中采取的一些操作来更改 TableView 中单元格的背景颜色。

当应用程序最初加载时，我在`-cellForRowAtIndexPath:`方法中自定义颜色，但是当用户从我的详细视图导航回来时，不会调用该函数，因此我的表格视图没有更新颜色。现在获得刷新的唯一方法是退出应用程序并重新启动它。（我用 NSUserDefaults 坚持他们的选择。）

显然，我希望当表格视图从详细视图返回时刷新，但我不知道如何获取对单元格的引用以及使用哪种方法来执行此操作。我假设它应该进入`-viewDidAppear`，因为这被称为视图显示的所有内容。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-07T16:30:17.927

使用`[tableView reloadData]`- 这将使 tableview 通过行运行并自行重建。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-07T13:56:52.153

你真的应该在`viewWillAppear:`.

此外，您可以使用其`visibleCells`方法获取表格视图的可见单元格。由于表格视图的工作方式，其他单元格根本不存在——滚动将触发委托方法并创建新单元格（或者如果您使用，则将现有单元格出列`dequeue...`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-20T18:09:17.153

我要补充一点，如果它在编辑视图中，然后保存存储在表中的一些修改信息，你应该有一个委托来检测数据何时实际保存，然后重新加载你的表视图。每次您的视图出现时都会触发 viewWillAppear。我认为您所追求的只是在更改数据后您想要刷新表格。

# python - 如何让鼻子发现动态生成的测试用例？

> ID：347574
> 
> 赞同：6
> 
> 时间：2008-12-07T13:30:45.013
> 
> 标签：python, unit-testing, nose

[这是我之前的问题](https://stackoverflow.com/questions/347109/how-do-i-concisely-implement-multiple-similar-unit-tests-in-the-python-unittest)的后续。

在上一个问题中，探索了在整个函数系列中实现基本相同的测试的方法，确保测试不会在第一个失败的函数处停止。

我首选的解决方案使用元类将测试动态插入到 unittest.TestCase 中。不幸的是，nose 没有选择这个，因为nose 静态扫描测​​试用例。

我如何才能发现并运行这样的 TestCase？请参阅[此处](https://stackoverflow.com/questions/347109/how-do-i-concisely-implement-multiple-similar-unit-tests-in-the-python-unittest#347175)以获取相关 TestCase 的示例。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T07:19:15.410

鼻子有一个“测试生成器”功能来处理这样的事情。您编写一个生成器函数，该函数生成您希望它运行的每个“测试用例”函数及其参数。按照您之前的示例，这可以在单独的测试中检查每个功能：

```
import unittest
import numpy

from somewhere import the_functions

def test_matrix_functions():
    for function in the_functions:
        yield check_matrix_function, function

def check_matrix_function(function)
    matrix1 = numpy.ones((5,10))
    matrix2 = numpy.identity(5)
    output = function(matrix1, matrix2)
    assert matrix1.shape == output.shape, \
           "%s produces output of the wrong shape" % str(function) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T08:00:07.497

Nose 不会静态扫描测​​试，因此您*可以*使用元类魔法来制作 Nose 找到的测试。

困难的部分是标准元类技术没有正确设置 func_name 属性，这是 Nose 在检查类上的方法是否是测试时所寻找的。

这是一个简单的元类。它查看 func dict 并为它找到的每个方法添加一个新方法，断言它找到的方法有一个文档字符串。这些新的合成方法被命名`"test_%d" %i`。

```
import new
from inspect import isfunction, getdoc

class Meta(type):
    def __new__(cls, name, bases, dct):

        newdct = dct.copy()
        for i, (k, v) in enumerate(filter(lambda e: isfunction(e[1]), dct.items())):
            def m(self, func):
                assert getdoc(func) is not None

            fname = 'test_%d' % i
            newdct[fname] = new.function(m.func_code, globals(), fname,
                (v,), m.func_closure)

        return super(Meta, cls).__new__(cls, 'Test_'+name, bases, newdct) 
```

现在，让我们创建一个使用这个元类的新类

```
class Foo(object):
    __metaclass__ = Meta

    def greeter(self):
        "sdf"
        print 'Hello World'

    def greeter_no_docstring(self):
        pass 
```

在运行时，`Foo`实际上将被命名，`Test_Foo`并将具有`greeter`、和作为其方法。当我在这个文件上运行时，输出如下：`greeter_no_docstring``test_1``test_2``nosetests`

```
$ nosetests -v test.py
test.Test_Foo.test_0 ... FAIL
test.Test_Foo.test_1 ... ok

======================================================================
FAIL: test.Test_Foo.test_0
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/EPD64.framework/Versions/7.3/lib/python2.7/site-packages/nose/case.py", line 197, in runTest
    self.test(*self.arg)
  File "/Users/rmcgibbo/Desktop/test.py", line 10, in m
    assert getdoc(func) is not None
AssertionError

----------------------------------------------------------------------
Ran 2 tests in 0.002s

FAILED (failures=1) 
```

这个元类并没有真正有用，但是如果你使用`Meta`不是作为一个适当的元类，而是作为一个更多的功能元类（即，将一个类作为参数并返回一个新类，一个被重命名的类，这样鼻子就会找到它），那么它*是*有用的。我已经使用这种方法来自动测试文档字符串是否符合 Numpy 标准，作为鼻子测试套件的一部分。

此外，我在使用 new.function 获得正确的闭包时遇到了很多麻烦，这就是为什么这段代码使用`m(self, func)`where `func`is made 作为默认参数的原因。在 上使用闭包会更自然`value`，但这似乎不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T14:54:30.443

您可以尝试使用 type() 生成测试用例类

```
class UnderTest_MixIn(object):

    def f1(self, i):
        return i + 1

    def f2(self, i):
        return i + 2

SomeDynamicTestcase = type(
    "SomeDynamicTestcase", 
    (UnderTest_MixIn, unittest.TestCase), 
    {"even_more_dynamic":"attributes .."}
)

# or even:

name = 'SomeDynamicTestcase'
globals()[name] = type(
    name, 
    (UnderTest_MixIn, unittest.TestCase), 
    {"even_more_dynamic":"attributes .."}
) 
```

这应该在鼻子尝试导入您的 test_module 时创建，以便它应该工作。

这种方法的优点是您可以动态地创建许多测试组合。

# c# - 如何检查计算机是否从 C# 响应

> ID：347575
> 
> 赞同：5
> 
> 时间：2008-12-07T13:31:11.020
> 
> 标签：c#, networking, netbios

检查计算机是否处于活动状态并做出响应（例如在 ping/NetBios 中）的最简单方法是什么？我想要一种可以限制时间的确定性方法。

一种解决方案是在单独的线程中简单地访问共享 (File.GetDirectories(@"\compname"))，如果花费的时间过长，则终止该线程。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-07T13:42:33.600

简单的！使用`System.Net.NetworkInformation`命名空间的 ping 功能！

[](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)[http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T14:16:11.770

要检查已知服务器上的特定 TCP 端口 ( `myPort`)，请使用以下代码段。您可以捕获`System.Net.Sockets.SocketException`异常以指示不可用的端口。

```
using System.Net;
using System.Net.Sockets;
...

IPHostEntry myHostEntry = Dns.GetHostByName("myserver");
IPEndPoint host = new IPEndPoint(myHostEntry.AddressList[0], myPort);

Socket s = new Socket(AddressFamily.InterNetwork,
    SocketType.Stream, ProtocolType.Tcp);
s.Connect(host); 
```

此外，专门的检查可以在套接字上尝试 IO 超时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T13:33:23.067

只要您想检查自己子网内的计算机，您就可以使用[ARP](http://en.wikipedia.org/wiki/Address_Resolution_Protocol)检查它。这是一个例子：

```
 //for sending an arp request (see pinvoke.net)
    [DllImport("iphlpapi.dll", ExactSpelling = true)]
    public static extern int SendARP(
                                        int DestIP, 
                                        int SrcIP, 
                                        byte[] pMacAddr, 
                                        ref uint PhyAddrLen);

    public bool IsComputerAlive(IPAddress host)
    {
        //can't check the own machine (assume it's alive)
        if (host.Equals(IPAddress.Loopback))
            return true;

        //Prepare the magic

        //this is only needed to pass a valid parameter
        byte[] macAddr = new byte[6];
        uint macAddrLen = (uint)macAddr.Length;

        //Let's check if it is alive by sending an arp request
        if (SendARP((int)host.Address, 0, macAddr, ref macAddrLen) == 0)
            return true; //Igor it's alive!

        return false;//Not alive
    } 
```

有关详细信息，请参阅[Pinvoke.net](http://www.pinvoke.net/default.aspx/iphlpapi.sendarp)。

# php - Eclipse Europa 的 Smarty 插件

> ID：347580
> 
> 赞同：2
> 
> 时间：2008-12-07T13:35:48.810
> 
> 标签：php, eclipse-plugin, smarty, eclipse-3.3

是否有任何用于创建 smarty 模板的好 Eclipse 插件？我在 Ubuntu 上使用带有 PDT 的 Europa（尽管我怀疑操作系统会对此有所作为）。

我找到[了 SmartyPDT](http://code.google.com/p/smartypdt/)，但它似乎没有正确安装，并且一些关于它的讨论似乎表明它适用于旧版本的 PDT。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T14:41:49.130

你可以在这里找到这个插件的更新版本： [http ://code.google.com/p/smartypdt/issues/detail?id=31](http://code.google.com/p/smartypdt/issues/detail?id=31)

但是我还没有在我的机器上安装它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T07:13:29.003

大约 2 年前，当我最后一次使用 PHPeclipse（你知道，Eclipse 的原始 PHP 工具）时，它包含一个 Smarty 编辑器，但它有点初级。我不再关注 PHPeclipse 开发了，所以它可能在此期间有所改进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-04T19:36:38.173

几个小时前我发布了同样的问题，但刚刚看到这篇文章。我想我会从这里链接我的问题，因为我们都没有答案（你的问题是 2 岁）。

在谷歌代码链接的 smartyPDT 插件仍然不是最新版本的最新版本。

[在 Eclipse PDT 中仍然需要聪明的语法高亮](https://stackoverflow.com/questions/2575142/i-need-smarty-syntax-highlighting-in-eclipse-pdt)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-06T08:55:38.333

关于集成 Eclipse Helios + PDT + Smarty 的精彩文章[http://www.ikravets.com/computers-life/programming/2010/09/27/eclipse-helios-pdt-smarty](http://www.ikravets.com/computers-life/programming/2010/09/27/eclipse-helios-pdt-smarty)（在此页面上使用英文翻译）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-03T08:31:04.597

答案发布在[链接到的问题](https://stackoverflow.com/questions/2575142/still-need-smarty-syntax-highlighting-in-eclipse-pdt-no-accepted-answer/2756884#2756884 "链接到此页面的问题，为方便起见，答案包括在下面")上：

> 我使用过 SmartyPDT 和 SSE*。
> 
> SmartyPDT 很挑剔，我花了一些时间才让它工作。不幸的是，在重新安装操作系统后，我的自定义 jar 不再起作用，所以我一直在使用 SSE。
> 
> 这是非常基本的，但总比没有好。
> 
> 它在 [bar54](http://www.bar54.de/smarty-eclipse.html "Eclipse 插件 SSE 的描述")用英文描述。
> 
> 从[谷歌的翻译版本](http://translate.google.com/translate?hl=en&sl=ja&tl=en&u=http%3A%2F%2Fhp.vector.co.jp%2Fauthors%2FVA000137%2Feclipse%2Fsmarty_editor%2Fsmarty_editor.html "谷歌翻译，没有Babelfish那么酷，也没有那么黏糊糊")下载。
> 
> *我想这就是它的名字，页面是日文的。

# delphi - 将 Delphi 集存储在数据集中的最佳方法是什么？

> ID：347592
> 
> 赞同：6
> 
> 时间：2008-12-07T13:45:49.133
> 
> 标签：delphi, set, dataset

标题基本概括了所有内容。我正在使用 TClientDataset 来存储对象数组，其中一个对象具有定义为一**组**枚举类型的成员。据我了解，Delphi 集是位域，其大小可以从 1 到 32 个字节不等，具体取决于它们包含的数据量，而 Delphi 没有定义 TSetField。我应该使用什么样的字段来加载这个值？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-07T14:02:08.930

您可以使用 TBytesField 或 TBlobField

ClientDataSet1MySet：TBytesField，大小=32

```
var
  MySet: set of Byte;
  Bytes: array of Byte;
begin
  MySet := [1, 2, 4, 8, 16];

  // Write
  Assert(ClientDataSet1MySet.DataSize >= SizeOf(MySet), 'Data field is too small');

  SetLength(Bytes, ClientDataSet1MySet.DataSize);
  Move(MySet, Bytes[0], SizeOf(MySet));
  ClientDataSet1.Edit;
  ClientDataSet1MySet.SetData(@Bytes[0]);
  ClientDataSet1.Post;

  // Read
  SetLength(Bytes, ClientDataSet1MySet.DataSize);
  if ClientDataSet1MySet.GetData(@Bytes[0]) then
    Move(Bytes[0], MySet, SizeOf(MySet))
  else
    MySet := []; // NULL
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T21:17:03.950

您可以将它们转换为字节，如下所示：

```
var
  States : TUpdateStatusSet; // Can be any set, I took this one from DB.pas unit
  SetAsAInteger: Integer;
  dbs: Pointer; // Here's the trick
begin
  States := [usModified, usInserted]; // Putting some content in that set
  dbs := @States;
  SetAsAInteger := PByte(dbs)^;
  //Once you got it, SetAsAInteger is just another ordinary integer variable.
  //Use it the way you like.
end; 
```

从任何地方恢复：

```
var
  MSG: string;
  Inserted, Modified: string;
  States: TUpdateStatusSet;
  MySet: Byte;

begin
  while not ClientDataSet.Eof do
  begin
    //That's the part that interest us
    //Convert that integer you stored in the database or whatever 
    //place to a Byte and, in the sequence, to your set type.
    iSet := Byte(ClientDatasetMyIntegerField);// Sets are one byte, so they
                                              //  fit on a byte variable  
    States := TUpdateStatusSet(iSet);
    //Conversion finished, below is just interface stuff

    if usInserted in States then
      Inserted := 'Yes';
    if usModified in States then
      Modified := 'Yes';
    MSG := Format('Register Num: %d. Inserted: %s. Modified:%s',
                  [ClientDataSet.RecNo, Inserted, Alterted]);
    ShowMessage( MSG );
    ClientDataset.Next;
  end;

end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-05T08:39:32.730

> > 基于安德烈亚斯的例子，但恕我直言，更加简单明了。

在 XE2 上测试

您可以使用 TBytesField 或 TBlobField

ClientDataSet1MySet：TBytesField，大小=32

1) 写作

```
var
  MySet: set of Byte;
  Bytes: TBytes;
begin
  MySet := [0];

  // Write
  Assert(ClientDataSet1Test.DataSize >= SizeOf(MySet), 'Data field is too small');

  SetLength(Bytes, ClientDataSet1Test.DataSize);
  Move(MySet, Bytes[0], SizeOf(MySet));
  ClientDataSet1.Edit;
  ClientDataSet1Test.AsBytes := Bytes;
  ClientDataSet1.Post;
end; 
```

2) 阅读

```
var
  MyResultSet: set of Byte;
begin
  Move(ClientDataSet1Test.AsBytes[0], MyResultSet, ClientDataSet1Test.DataSize);
end; 
```

# c# - 如何使用列表和关系对象测试 fluent-NHibernate 的 PersistenceSpecification.VerifyTheMappings？

> ID：347602
> 
> 赞同：9
> 
> 时间：2008-12-07T13:59:20.480
> 
> 标签：c#, .net, fluent-nhibernate, nunit

你将如何测试这个场景？

我刚刚开始研究 NHibernate 并在 TDD 上进行了我的第一次 bash。到目前为止，我真的很喜欢它，并且一直在使用 fluent-Nhibernate 来映射类。

但是，在 PersistenceSpecification 上使用 VerifyTheMappings 方法时，我似乎陷入了死胡同。

基本上我有两个类，Recipient 和 RecipientList。RecipientList 类具有到具有流畅“HasMany”关系的收件人的映射：

```
public class RecipientListMap : ClassMap<RecipientList>
{

    public RecipientListMap()
    {
        Id(x => x.ID);
        Map(x => x.ApplicationID);
        Map(x => x.Name);
        Map(x => x.IsDeleted);
        HasMany<Recipient>(x => x.Recipients).WithKeyColumn("RecipientListID").AsList().LazyLoad();
    }

} 
```

但是，当我在测试中使用以下代码时：

```
private IList<Recipient> _recipients = new List<Recipient>()
        {
            new Recipient { FirstName = "Joe", LastName = "Bloggs", Email = "joe@bloggs.com", IsDeleted = false },
            new Recipient { FirstName = "John", LastName = "Doe", Email = "john@doe.com", IsDeleted = false },
            new Recipient { FirstName = "Jane", LastName = "Smith", Email = "john@smith.com", IsDeleted = false }
        };

        [Test]
        public void Can_Add_RecipientList_To_Database()
        {
            new PersistenceSpecification<RecipientList>(Session)
                .CheckProperty(x => x.Name, "My List")
                .CheckProperty(x => x.Columns, "My columns")
                .CheckProperty(x => x.IsDeleted, false)
                .CheckProperty(x => x.ApplicationID, Guid.NewGuid())
                .CheckProperty(x => x.Recipients, _recipients)
                .VerifyTheMappings();
        } 
```

出现以下错误：

```
failed: System.ApplicationException : Expected 'System.Collections.Generic.List`1[Project.Data.Domains.Recipients.Recipient]' but got 'NHibernate.Collection.Generic.PersistentGenericBag`1[Project.Data.Domains.Recipients.Recipient]' for Property 'Recipients' 
```

我可以看到错误是因为我传入了一个列表，而返回的列表是一个 PersistentGenericBag，因此引发了错误。我不明白你是怎么想的，但如果你不能只传递一个 IList？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T00:30:32.607

好吧，我在 PeristenceSpecification 上使用了错误的方法。

我应该一直使用 CheckList 而不是 CheckProperty。

呸！

# language-agnostic - 应用程序框架——购买、构建还是同化？

> ID：347606
> 
> 赞同：3
> 
> 时间：2008-12-07T14:06:18.093
> 
> 标签：language-agnostic, cross-cutting-concerns, application-framework

我很好奇其他商店在基本应用程序框架方面做了什么？我将应用程序框架视为能够提供附加或扩展功能以提高由它构建的应用程序的质量。

有多种开箱即用的框架，例如 Spring（或 Spring.NET）等。我发现这些框架最大的问题是它们不是点菜的。基本上，它们有太多的功能，除非每个功能都是可用的最佳实现，否则您最终可能会使用多个框架的拼凑来完成这些任务 - 导致臃肿和混乱。在我看来，这适用于免费和商业系统。

当然，写作在很大程度上是在重新发明轮子。不过，我不认为它没有优点，因为它提供了最可定制的选项。但是，有些东西太大而无法开发，并且在这种情况下似乎实施得不好或根本没有实施，因为对承诺开发的前期成本犹豫不决。

有各种各样的开源项目也可以解决可能的应用程序框架的各个部分。这些可以被采用或吸收（显然取决于许可协议）以帮助构建来自不同来源的综合框架。

我们通过查看整个企业的应用程序中的一些更大的关注点来处理这种情况，并提出了一个有效的横切关注点和反复出现的实施问题的列表。最后，我们提出了部分开源、部分基于现有开源选项和部分定制开发的混合解决方案。

我们框架中的一些例子：

*   异常和事件日志提供程序。一种简单、统一的方法，每个应用程序都可以通过这种方法以相同的方式记录异常和事件，而代码工作量最少。开箱即用，它可以记录到 SQL Server、文本文件、事件查看器等。它还包含用于记录到其他源的扩展点。
*   变量赋值强制。一个泛型类，它基于对象类型公开扩展方法，使用受 JUnit 启发的语法。例如，要确定 myObject 是否不为空，我们可以做一个简单的 Enforce.That(myObject).IsNotNull(); 或通过执行简单的 Enforce.That(myObject).IsOfType(typeof(Hashtable)); 来确定它是否是特定类型 执行失败会引发适当的异常，既减少了代码量又提供了实现的一致性。
*   单元测试助手。一系列基于反射的类，可以自动测试类及其属性。（受 CodePlex 的[Automatic Class Tester](http://www.codeplex.com/classtester)启发）但从头开始编写。有助于为传统上难以测试或耗时的事物简化单元测试的创建。

我们还直接采用了其他一些功能。例如，我们将[PostSharp](http://postsharp.org)用于 AOP，[moq](http://code.google.com/p/moq)用于模拟，[autofaq](http://code.google.com/p/autofac/)用于 DI。

只是想知道其他人可能做了什么，以及您的框架解决了哪些问题，您没有找到您满意的工具？至于我们的经验，我们肯定会从新框架中获益，并对我们采取的方法感到满意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T14:58:48.877

我的简单建议是您使用适合您需求的框架。当然，为了做到这一点，你必须事先试验并知道你在寻找什么。即使框架提供的功能远远超出您的需要，这样做的成本是多少？对于一般问题，成本只是一个 jar 中的几个额外 Mbs，我认为这对于大多数项目来说是可以的。

最后，您应该选择一个能够正确完成工作的框架，以便您的重点是提供用户价值并简化开发人员的维护。当然，没有一个单一的框架可以解决每个人的问题，但是有一些框架可以达到他们的目标。这一切都取决于最好的妥协。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T16:57:08.170

我们的方法是将整个架构师团队（即“[技术架构师](https://stackoverflow.com/questions/212270#212362)”）用于：

*   要么调整现有的开源框架，在某些情况下将它们封装在内部 API 中，以便在需要时能够更改框架
*   或根据特定需求创建新框架，为多个项目找到多个团队。

无论采用何种方法，这些框架都需要有很好的文档记录（至少具有完整的[公共 API](https://stackoverflow.com/questions/61604)），并且需要很好地宣传它们的发布：
由于所有团队都将基于这些框架的工作，他们需要升级他们的框架版本尽快，以便建立自己的交付。

# c# - 存储 WPF 图像资源

> ID：347614
> 
> 赞同：439
> 
> 时间：2008-12-07T14:14:53.397
> 
> 标签：c#, .net, wpf, embedded-resource

对于需要 10 到 20 个小图标和图像用于说明目的的 WPF 应用程序，将这些作为嵌入式资源存储在程序集中是正确的方法吗？

如果是这样，我如何在 XAML 中指定 Image 控件应从嵌入式资源加载图像？

* * *

## 回答 #1

> 赞同：498
> 
> 时间：2009-03-03T16:02:33.630

如果您将在多个地方使用图像，那么值得将图像数据仅加载一次到内存中，然后在所有`Image`元素之间共享它。

为此，请[`BitmapSource`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapsource.aspx) 在某处创建一个资源：

```
<BitmapImage x:Key="MyImageSource" UriSource="../Media/Image.png" /> 
```

然后，在您的代码中，使用类似：

```
<Image Source="{StaticResource MyImageSource}" /> 
```

就我而言，我发现我必须将`Image.png`文件设置为具有构建操作，`Resource`而不仅仅是`Content`. 这会导致图像在您编译的程序集中携带。

* * *

## 回答 #2

> 赞同：195
> 
> 时间：2010-03-10T11:32:28.160

我发现使用图像、视频等的最佳做法是：

*   将您的文件**“构建操作”**更改为**“内容”**。请务必选中*Copy to build directory*。
    *   在解决方案资源管理器窗口的“右键单击”菜单中找到。
*   *图像源*格式如下：
    *   **"/ *«YourAssemblyName»* ;component/«YourPath»/ *«YourImage.png»* "**

### 例子

```
<Image Source="/WPFApplication;component/Images/Start.png" /> 
```

好处：

*   文件不会嵌入到程序集中。
    *   资源管理器将引发一些资源过多的内存溢出问题（在构建时）。
*   可以在程序集之间调用。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2011-02-13T16:49:45.760

有些人在询问是否在代码中执行此操作，但没有得到答案。

在花了很多时间搜索之后，我找到了一个非常简单的方法，但我没有找到示例，所以我在这里分享我的适用于图像的方法。（我的是.gif）

概括：

它返回 ImageSource“目的地”似乎喜欢的 BitmapFrame。

采用：

```
doGetImageSourceFromResource ("[YourAssemblyNameHere]", "[YourResourceNameHere]"); 
```

方法：

```
static internal ImageSource doGetImageSourceFromResource(string psAssemblyName, string psResourceName)
{
    Uri oUri = new Uri("pack://application:,,,/" +psAssemblyName +";component/" +psResourceName, UriKind.RelativeOrAbsolute);
    return BitmapFrame.Create(oUri);
} 
```

学习：

根据我的经验，包字符串不是问题，请检查您的流，特别是如果第一次读取它已将指针设置为文件末尾并且您需要在再次读取之前将其重新设置为零。

我希望这可以为您节省很多时间，我希望这件作品对我有用！

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2012-03-16T13:15:56.720

在代码中加载执行程序集中的资源，其中我的图像`Freq.png`位于文件夹中`Icons`并定义为`Resource`：

```
this.Icon = new BitmapImage(new Uri(@"pack://application:,,,/" 
    + Assembly.GetExecutingAssembly().GetName().Name 
    + ";component/" 
    + "Icons/Freq.png", UriKind.Absolute)); 
```

我还做了一个功能：

```
/// <summary>
/// Load a resource WPF-BitmapImage (png, bmp, ...) from embedded resource defined as 'Resource' not as 'Embedded resource'.
/// </summary>
/// <param name="pathInApplication">Path without starting slash</param>
/// <param name="assembly">Usually 'Assembly.GetExecutingAssembly()'. If not mentionned, I will use the calling assembly</param>
/// <returns></returns>
public static BitmapImage LoadBitmapFromResource(string pathInApplication, Assembly assembly = null)
{
    if (assembly == null)
    {
        assembly = Assembly.GetCallingAssembly();
    }

    if (pathInApplication[0] == '/')
    {
        pathInApplication = pathInApplication.Substring(1);
    }
    return new BitmapImage(new Uri(@"pack://application:,,,/" + assembly.GetName().Name + ";component/" + pathInApplication, UriKind.Absolute)); 
} 
```

用法（假设您将函数放在 ResourceHelper 类中）：

```
this.Icon = ResourceHelper.LoadBitmapFromResource("Icons/Freq.png"); 
```

**注意**：请参阅[WPF 中的 MSDN Pack URI](https://msdn.microsoft.com/en-us/library/aa970069(v=vs.100).aspx)：
`pack://application:,,,/ReferencedAssembly;component/Subfolder/ResourceFile.xaml`

* * *

## 回答 #5

> 赞同：45
> 
> 时间：2008-12-07T17:34:29.843

是的，这是正确的方法。

您可以仅使用路径在资源文件中使用图像：

```
<Image Source="..\Media\Image.png" /> 
```

您必须将映像文件的构建操作设置为“资源”。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-04-13T19:12:08.187

完整描述如何使用资源：*[WPF 应用程序资源、内容和数据文件](https://msdn.microsoft.com/en-us/library/aa970494(v=vs.100).aspx)*

以及如何引用它们，请阅读“Pack URIs in WPF”。

简而言之，甚至可以通过引用/引用程序集引用资源。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-08-23T09:16:51.013

1.  Visual Studio 2010 专业版 SP1。
2.  .NET Framework 4 客户端配置文件。
3.  在项目属性中添加为资源的 PNG 图像。
4.  资源文件夹中的新文件自动创建。
5.  将操作设置为资源。

这对我有用：

```
<BitmapImage x:Key="MyImageSource" UriSource="Resources/Image.png" /> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-07T23:52:15.977

如果您使用的是[Blend](https://en.wikipedia.org/wiki/Microsoft_Blend)，为了使其更加简单并且在获取*Source*属性的正确路径时不会遇到任何问题，只需将图像从“项目”面板拖放到设计器上。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-04-24T10:47:37.907

是的，这是正确的方法。您可以使用路径在资源文件中使用图像：

```
<StackPanel Orientation="Horizontal">
    <CheckBox  Content="{Binding Nname}" IsChecked="{Binding IsChecked}"/>
    <Image Source="E:\SWorking\SharePointSecurityApps\SharePointSecurityApps\SharePointSecurityApps.WPF\Images\sitepermission.png"/>
    <TextBlock Text="{Binding Path=Title}"></TextBlock>
</StackPanel> 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2015-01-08T23:04:35.847

以下工作并且要设置的图像是属性中的资源：

```
 var bitmapSource = Imaging.CreateBitmapSourceFromHBitmap(MyProject.Properties.Resources.myImage.GetHbitmap(),
                                      IntPtr.Zero,
                                      Int32Rect.Empty,
                                      BitmapSizeOptions.FromEmptyOptions());
    MyButton.Background = new ImageBrush(bitmapSource);
img_username.Source = bitmapSource; 
```

# xml - 如何在没有代码的情况下将字符串的内容写出到 XML...？

> ID：347617
> 
> 赞同：1
> 
> 时间：2008-12-07T14:17:00.210
> 
> 标签：xml, xml-serialization, xelement

我有一个带有尖括号的字符串，如下所示：

```
<element1>my text here</element1> 
```

当我将它写入控制台或我的 dataGridView 或其他任何地方时，该字符串实际上看起来像这样。但是，我正在尝试将其编写为 XML 文档的一部分。

一切都很好，除了在写入的 xml 文件中，上面显示为：

```
&lt;element1&gt;my text here&lt;/element1&gt; 
```

我怎样才能把它写成我的文字而不是代码？

谢谢！

-阿迪娜

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T14:48:20.257

如果要将其保留为字符串而不转义所有元素，请使用 CDATA 块：

```
<xml><![CDATA[<element1>my text here</element1>]]></xml> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T16:30:22.747

我不清楚您的目标：您希望最终的 XML 文件是什么样的？

如果您像下面这样输出它，那么 XML 解析器会将“<element1>”解释为结构的一部分，而不是内容。

```
<container><element1>my text here</element1></container> 
```

至于将您的 XML 编写为字符串，这是一个坏主意：转义是有原因的，除非您非常详细地了解 XML 规范，否则您几乎肯定会犯错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T19:31:34.193

> 当我将它写入控制台或我的 dataGridView 或其他任何地方时，该字符串实际上看起来像这样。

*您永远不应该直接操作 XML 文档的字符串值。*

关于软件开发，我没有做很多绝对的陈述，但那几乎总是正确的。如果您对 XML 没有深入的经验，这绝对是正确的。我猜想 XML 新手遇到的 25% 或更多的问题是由这个引起的。

如果将 XML 加载到 XmlDocument 中，找到包含它的元素并写出该元素的 InnerText 属性，则该字符串将正确显示。DOM 正确地将文本往返传入和传出 XML，对其进行编码，以便文本中的标记不会干扰 XML 的标记。你想要那个。

我观察到的另一件事：至少 90% 的情况下，使用 CDATA 的建议在技术上是正确的，但在其他所有方面都是错误的。使用 CDATA 是最后的手段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T14:32:39.523

这是以[HTML 编码格式](http://en.wikipedia.org/wiki/Character_encodings_in_HTML)编写的，因为您的应用程序必须认为它是内容而不是实际的 XML 元素，因此它会像内容一样对其进行转义。

您是否尝试过使用 XmlWriter 类？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-07T15:28:07.850

唔。

所以我想我已经决定不使用 XMLSerializer（我认为这是一种奇特的做事方式），而是构建所有元素的字符串并将它们写成普通的文本文件。这似乎有效并且足够简单。我还有其他一些独特/奇怪的东西，这种做法让这一切变得简单多了。:)

-阿迪娜

# linux - 我的所有 inode 都在哪里使用？

> ID：347620
> 
> 赞同：58
> 
> 时间：2008-12-07T14:19:24.167
> 
> 标签：linux, unix, posix, inode

我如何找出哪些目录负责咀嚼我的所有 inode？

最终根目录将负责最大数量的 inode，所以我不确定我想要什么样的答案..

基本上，我用完了可用的 inode，需要找到一个不需要的目录来剔除。

谢谢，很抱歉这个模糊的问题。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-01-21T16:37:22.310

如果您不想创建新文件（或者因为 inode 用完而无法创建文件），您可以运行以下查询：

```
for i in `find . -type d `; do echo `ls -a $i | wc -l` $i; done | sort -n 
```

正如内部人员在另一个答案中提到的那样，使用 find 的解决方案会更快，因为递归 ls 非常慢，请在下面查看该解决方案！（信用到期的信用！）

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-01-18T03:03:01.163

提供递归**ls**的方法非常慢。只是为了快速找到消耗我使用的大多数 inode 的父目录：

```
cd /partition_that_is_out_of_inodes
for i in *; do echo -e "$(find $i | wc -l)\t$i"; done | sort -n 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-12-07T14:29:49.433

所以基本上你正在寻找哪些目录有很多文件？这是第一次尝试：

```
find . -type d -print0 | xargs -0 -n1 count_files | sort -n 
```

其中“count_files”是一个shell脚本（感谢乔纳森）

```
echo $(ls -a "$1" | wc -l) $1 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2015-05-29T13:34:38.090

我使用以下方法来解决（在我的同事 James 的帮助下）我们有大量的 PHP 会话文件需要在一台机器上删除：

**1\. 我使用了多少个 inode？**

```
 root@polo:/# df -i
 Filesystem     Inodes  IUsed  IFree IUse% Mounted on
 /dev/xvda1     524288 427294  96994   81% /
 none           256054      2 256052    1% /sys/fs/cgroup
 udev           254757    404 254353    1% /dev
 tmpfs          256054    332 255722    1% /run
 none           256054      3 256051    1% /run/lock
 none           256054      1 256053    1% /run/shm
 none           256054      3 256051    1% /run/user 
```

**2\. 所有这些 inode 都在哪里？**

```
 root@polo:/# find / -xdev -printf '%h\n' | sort | uniq -c | sort -k 1 -n
 [...]
    1088 /usr/src/linux-headers-3.13.0-39/include/linux
    1375 /usr/src/linux-headers-3.13.0-29-generic/include/config
    1377 /usr/src/linux-headers-3.13.0-39-generic/include/config
    2727 /var/lib/dpkg/info
    2834 /usr/share/man/man3
  416811 /var/lib/php5/session
 root@polo:/# 
```

最后一行有很多 PHP 会话文件。

**3.如何删除所有这些文件？**

删除目录中所有超过 1440 分钟（24 小时）的文件：

```
root@polo:/var/lib/php5/session# find ./ -cmin +1440 | xargs rm
root@polo:/var/lib/php5/session# 
```

**4\. 有效果吗？**

```
 root@polo:~# find / -xdev -printf '%h\n' | sort | uniq -c | sort -k 1 -n
 [...]
    1088 /usr/src/linux-headers-3.13.0-39/include/linux
    1375 /usr/src/linux-headers-3.13.0-29-generic/include/config
    1377 /usr/src/linux-headers-3.13.0-39-generic/include/config
    2727 /var/lib/dpkg/info
    2834 /usr/share/man/man3
    2886 /var/lib/php5/session
 root@polo:~# df -i
 Filesystem     Inodes  IUsed  IFree IUse% Mounted on
 /dev/xvda1     524288 166420 357868   32% /
 none           256054      2 256052    1% /sys/fs/cgroup
 udev           254757    404 254353    1% /dev
 tmpfs          256054    332 255722    1% /run
 none           256054      3 256051    1% /run/lock
 none           256054      1 256053    1% /run/shm
 none           256054      3 256051    1% /run/user
 root@polo:~# 
```

幸运的是，我们收到了一封邮件通知我们的 inode 几乎用完了。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-01-08T00:24:07.773

这是我的看法。它与其他的并没有太大的不同，但输出很漂亮，我认为它比其他（目录和符号链接）计算更多的有效 inode。这会计算工作目录的每个子目录中的文件数；它将输出排序并格式化为两列；它打印一个总计（显示为“.”，工作目录）。这不会跟随符号链接，但会计算以点开头的文件和目录。这不包括设备节点和命名管道等特殊文件。如果您也想计算这些，只需删除“-type l -o -type d -o -type f”测试。因为这个命令被分成两个 find 命令，所以它不能正确区分安装在其他文件系统上的目录（-mount 选项不起作用）。例如，这应该真的忽略“/proc” 和“/sys”目录。您可以看到，在“/”中运行此命令时，包括“/proc”和“/sys”在内的总计数严重偏斜。

```
for ii in $(find . -maxdepth 1 -type d); do 
    echo -e "${ii}\t$(find "${ii}" -type l -o -type d -o -type f | wc -l)"
done | sort -n -k 2 | column -t 
```

例子：

```
# cd /
# for ii in $(find -maxdepth 1 -type d); do echo -e "${ii}\t$(find "${ii}" -type l -o -type d -o -type f | wc -l)"; done | sort -n -k 2 | column -t
./boot        1
./lost+found  1
./media       1
./mnt         1
./opt         1
./srv         1
./lib64       2
./tmp         5
./bin         107
./sbin        109
./home        146
./root        169
./dev         188
./run         226
./etc         1545
./var         3611
./sys         12421
./lib         17219
./proc        20824
./usr         56628
.             113207 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-07T15:51:11.237

这是一个简单的 Perl 脚本，可以做到这一点：

```
#!/usr/bin/perl -w

use strict;

sub count_inodes($);
sub count_inodes($)
{
  my $dir = shift;
  if (opendir(my $dh, $dir)) {
    my $count = 0;
    while (defined(my $file = readdir($dh))) {
      next if ($file eq '.' || $file eq '..');
      $count++;
      my $path = $dir . '/' . $file;
      count_inodes($path) if (-d $path);
    }
    closedir($dh);
    printf "%7d\t%s\n", $count, $dir;
  } else {
    warn "couldn't open $dir - $!\n";
  }
}

push(@ARGV, '.') unless (@ARGV);
while (@ARGV) {
  count_inodes(shift);
} 
```

如果您希望它像这样工作`du`（每个目录计数还包括子目录的递归计数），那么将递归函数更改为`return $count`，然后在递归点说：

```
$count += count_inodes($path) if (-d $path); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-03-16T20:16:06.917

一个*实际功能*的单线（GNU 查找，对于其他类型的查找，您需要自己的等价物`-xdev`才能保持在同一个 FS 上。）

`find / -xdev -type d | while read -r i; do printf "%d %s\n" $(ls -a "$i" | wc -l) "$i"; done | sort -nr | head -10`

显然，尾巴是可定制的。

与此处的许多其他建议一样，这只会以非递归方式向您显示每个目录中的条目数量。

附言

快速但不精确的单行（按目录节点大小检测）：

`find / -xdev -type d -size +100k`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-06-07T23:06:16.777

```
对于我在 dir.[01]
做
    find $i -printf "%i\n"|sort -u|wc -l|xargs echo $i --
完毕

```

目录 0 -- 27913
目录 1 -- 27913

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-06T14:23:36.797

只是想提一下，您也可以使用目录大小*间接*搜索，例如：

```
find /path -type d -size +500k 
```

如果您有很多大目录，则可以增加 500k。

请注意，此方法**不是**递归的。如果您在一个目录中有很多文件，这只会对您有所帮助，但如果文件均匀分布在其后代中，则不会。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-09-27T13:13:35.770

采用

```
ncdu -x <path> 
```

然后按 Shitf+c 按项目计数排序

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-11-02T02:10:18.570

perl 脚本很好，但要注意符号链接 - 仅当 -l filetest 返回 false 时才会递归，否则您充其量会过度计算，最坏的情况是无限期地递归（这可能 - 次要问题 - 调用撒旦的 1000 年统治）。

当有多个链接指向超过一小部分文件时，计算文件系统树中的 inode 的整个想法就会崩溃。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-03T22:59:24.860

请注意，当您最终找到某个邮件假脱机目录并想要删除其中的所有垃圾时，如果文件太多， rm * 将不起作用，您可以运行以下命令快速删除该目录中的所有内容：

*** 警告 ***这将在 rm 不起作用的情况下快速删除所有文件

```
find . -type f -delete 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-09-07T22:18:40.607

不幸的是，这不是 POSIX 解决方案，但是......这会计算当前目录下的文件。即使文件名包含换行符，这也应该有效。它使用 GNU awk。将 d 的值（从 2）更改为所需的最大分离路径深度。0 表示无限深度。在最深层的子目录中的文件被递归计算。

```
d=2; find . -mount -not -path . -print0 | gawk '
BEGIN{RS="\0";FS="/";SUBSEP="/";ORS="\0"}
{
    s="./"
    for(i=2;i!=d+1 && i<NF;i++){s=s $i "/"}
    ++n[s]
}
END{for(val in n){print n[val] "\t" val "\n"}}' d="$d" \
 | sort -gz -k 1,1 
```

与 Bash 4 相同；给出深度作为脚本的参数。根据我的经验，这要慢得多：

```
#!/bin/bash
d=$1
declare -A n

while IFS=/ read -d $'\0' -r -a a; do
  s="./"
  for ((i=2; i!=$((d+1)) && i<${#a[*]}; i++)); do
    s+="${a[$((i-1))]}/"
  done
  ((++n[\$s]))
done < <(find . -mount -not -path . -print0)

for j in "${!n[@]}"; do
    printf '%i\t%s\n\0' "${n[$j]}" "$j"
done | sort -gz -k 1,1 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-06-06T08:09:23.400

在搜索占用磁盘空间最多的文件夹时，我曾经`du`像这样从上到下工作：

```
du -hs /* 
```

这是列出每个顶级文件夹的文件消耗。之后，您可以通过扩展给定模式进入任一文件夹：

```
du -hs /var/* 
```

等等 ...

现在，当涉及到 inode 时，可以使用相同的工具，但参数略有不同：

```
du -s --inodes /* 
```

在同一文件夹中有一个缓存改进了此工具的后续调用，这在正常情况下是有益的。但是，当您用完 inode 时，我认为这会变成相反的情况。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-02-03T09:38:37.260

不需要复杂的 for/ls 结构。您可以通过以下方式获得 10 个最胖（就 inode 使用而言）目录：

`du --inodes --separate-dirs --one-file-system | sort -rh | head`

`--one-file-system`参数是可选的。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2014-10-11T00:09:10.267

此命令适用于极不可能的情况，即您的目录结构与我的相同：

`find / -type f | grep -oP '^/([^/]+/){3}' | sort | uniq -c | sort -n`

# sql - 如何将行转换为列

> ID：347624
> 
> 赞同：8
> 
> 时间：2008-12-07T14:21:52.273
> 
> 标签：sql, sql-server

我在查询 SQL Server 2005 数据库时遇到了一个简单的问题。我有名为客户和产品（1-> M）的表。一位客户拥有最多 2 种产品。而不是输出为

客户名称、产品名称 ...

我喜欢输出为

客户名称、产品 1 名称、产品 2 名称 ...

有人可以帮助我吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-07T15:23:51.727

正如其他人所说，您可以使用 PIVOT 和 UNPIVOT 运算符。不幸的是，PIVOT 和 UNPIVOT 的问题之一是您需要提前知道要旋转的值，或者使用动态 SQL。

听起来，在您的情况下，您将需要使用动态 SQL。要使此功能正常运行，您需要提取查询中使用的产品列表。如果您使用 AdventureWorks 数据库，您的代码将如下所示：

```
USE AdventureWorks;
GO

DECLARE @columns NVARCHAR(MAX);

SELECT x.ProductName
INTO #products
FROM (SELECT p.[Name] AS ProductName
    FROM Purchasing.Vendor AS v
    INNER JOIN Purchasing.PurchaseOrderHeader AS poh ON v.VendorID = poh.VendorID
    INNER JOIN Purchasing.PurchaseOrderDetail AS pod ON poh.PurchaseOrderID = pod.PurchaseOrderID
    INNER JOIN Production.Product AS p ON pod.ProductID = p.ProductID
    GROUP BY p.[Name]) AS x;

SELECT @columns = STUFF(
    (SELECT ', ' + QUOTENAME(ProductName, '[') AS [text()]
       FROM #products FOR XML PATH ('')
    ), 1, 1, '');

SELECT @columns; 
```

现在您有了列，您可以使用动态查询拉取您需要的所有内容：

```
DECLARE @sql NVARCHAR(MAX);

SET @sql = 'SELECT CustomerName, ' + @columns + '
FROM (
    // your query goes here
) AS source
PIVOT (SUM(order_count) FOR product_name IN (' + @columns + ') AS p';

EXEC sp_executesql @sql 
```

当然，如果您需要确保获得合适的值，您可能必须复制用于构建 @columns 的逻辑并创建一个 @coalesceColumns 变量，如果需要，该变量会将代码保存到 COALESCE(col_name, 0)你的查询中的那种东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-07T14:54:05.220

这里有两个关于枢轴的链接：

[http://www.tsqltutorials.com/pivot.php](http://www.tsqltutorials.com/pivot.php)

[http://www.simple-talk.com/sql/t-sql-programming/creating-cross-tab-queries-and-pivot-tables-in-sql/](http://www.simple-talk.com/sql/t-sql-programming/creating-cross-tab-queries-and-pivot-tables-in-sql/)

我用枢轴解决了我的问题；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T14:33:11.317

在sql2005中，有称为“PIVOT”和“UNPIVOT”的函数可以用来在行和列之间进行转换。

希望对您有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-08T01:16:42.343

正如其他人所提到的，SQL 2005 具有 PIVOT 功能，这可能是最适合一般用途的功能。但是，在某些情况下，您可以简单地执行类似的操作。

```
Select 
 Customer,
 Sum(Case When Product = 'Foo' Then 1 Else 0 End) Foo_Count,
 Sum(Case When Product = 'Bar' Then 1 Else 0 End) Bar_Count
From Customers_Products
Group By Customer 
```

# windows - Vista 上 XAMPP 服务器的最低规格

> ID：347625
> 
> 赞同：1
> 
> 时间：2008-12-07T14:21:58.203
> 
> 标签：windows, xampp

对于运行 Vista、IDE 和 Apache、MySQL 和 PHP 的 Windows 笔记本电脑，您推荐的最低配置是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T14:23:34.453

2 GB 内存奔腾酷睿 2 双核

就是这样

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T14:25:43.903

如果笔记本电脑运行 Vista（2GB 和不错的视频卡）运行良好，那么 XAMP 将不会有任何问题。对于开发，Apache、MySQL 和 PHP 将使用很少的 CPU 或内存。他们都非常有效率。

# python - mod_python.publisher 总是给出内容类型'text/plain'

> ID：347632
> 
> 赞同：0
> 
> 时间：2008-12-07T14:27:09.457
> 
> 标签：python, content-type, mod-python

我刚刚用 apache 设置了 mod python，我试图让一个简单的脚本工作，但是当我加载页面时，它会将我所有的 html 作为纯文本发布。我认为这是 mod_python.publisher 的问题，我也设置了它的处理程序。我搜索了它的源代码，找到了区分'text/plain'和'text/html'的行，它在我的脚本中搜索它输出的文件的最后一百个字符，所以我把它放进去，然后它仍然没有工作。我什至尝试注释掉一些代码，以便发布者将所有内容设置为“文本/html”，但当我刷新页面时它仍然做同样的事情。也许我设置了错误的东西。

这是我在 httpd.conf 中的配置

> <Directory "C:/Program Files/Apache Software Foundation/Apache2.2/htdocs">
> SetHandler mod_python
> PythonHandler mod_python.publisher
> PythonDebug On
> </Directory>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T16:15:26.787

您的配置看起来不错：我有一个工作的 mod_python.publisher 脚本，其设置基本相同。

其他一些想法：

*   当您尝试编辑发布者源代码时，您是否重新启动了 Web 服务器？它只在服务器首次启动时加载 Python 库一次。

*   Publisher 的自动检测会查找结束 HTML 标记：</html>。是你加的吗？（我在您的问题中看不到它，但是当您发布它时它可能只是被剥离了。）

*   如果没有其他方法，您始终可以显式设置内容类型。它的代码更多，但可以保证始终如一地工作。将请求中的 content_type 字段设置为“text/html”。

例如，如果您的脚本现在看起来像这样：

```
def index(req, an_arg='default'):
    return some_html 
```

它会变成：

```
def index(req, an_arg='default'):
    req.content_type = 'text/html'
    return some_html 
```

# c - 确定客户端绑定的 TCP 端口号

> ID：347636
> 
> 赞同：5
> 
> 时间：2008-12-07T14:32:36.480
> 
> 标签：c, linux, sockets, tcp

我创建了一个 TCP 套接字，而不用担心绑定到 [socket.sin_port = 0] 的端口号。但是以后如果我想打印客户端的端口号，我该怎么做？客户端 C 应用程序（在 Linux 上）创建了许多连接到服务器的客户端。为了调试问题，我捕获了 ethereal 上的流量。我想在出现问题时在日志中打印端口号，以便在 ethereal 上进行过滤变得容易。

任何帮助，将不胜感激。

-帕布

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-07T14:43:34.023

连接成功后，使用 getsockname() 调用获取套接字地址和端口。

编辑：正确的方法名称。有时我无法将一个简单的单词从一个窗口复制到另一个窗口！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T15:58:22.063

我相信达伦的意思是`getsockname()`。`connect()`如果您需要以编程方式确定客户端（调用方）的端口号，这就是您想要的。在服务器端（调用端`bind()`），您将使用`getpeername()`从连接的套接字获取相同的信息。

但是，如果您正在调试并且无法更改代码，那么您最终会使用 netstat 或 sockstat 实用程序，具体取决于操作系统。我不确定 Linux（甚至您的特定软件包）下有哪些实用程序可用，但我会从`man sockstat`. 如果已安装，您可以从任一侧运行它并查看哪些端点已分配给哪些进程。结合这个，`grep`你通常可以找出在 Ethereal 中过滤哪个地址。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T18:35:45.507

```
lsof -p <process id> | grep TCP 
```

# asp.net - ASP.NET 的 Excel 单元格格式

> ID：347642
> 
> 赞同：3
> 
> 时间：2008-12-07T14:36:58.093
> 
> 标签：asp.net, excel

我有个问题。例如，数据表列值之一是字符串值“001200”。当 Excel 文档创建时，该值变为“1200”。如何保持数据格式不变？我正在使用 ASP.NET 1.1。

代码的一部分是：

```
private void lnkExport_Click( object sender, System.EventArgs e ) 
{

Response.Clear();

Response.Buffer= true;

Response.ContentType = "application/vnd.ms-excel";

Response.AddHeader( "Content-Disposition", "attachment; filename=" + "CartsList.xls" );

Response.Charset = "iso-8859-8";

Response.Cache.SetCacheability( HttpCacheability.Public );

Response.ContentEncoding = System.Text.Encoding.UTF7;

this.EnableViewState = false;

System.IO.StringWriter oStringWriter = new System.IO.StringWriter();

System.Web.UI.HtmlTextWriter oHtmlTextWriter = new System.Web.UI.HtmlTextWriter( oStringWriter );

this.ClearControls( dtgCarts );

dtgCarts.RenderControl( oHtmlTextWriter );

Response.Write( oStringWriter.ToString() );

Response.End();

} 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T14:42:19.767

在开头添加一个撇号（单引号） - 这应该可以解决它。它强制 Excel 将单元格视为文本而不是数字。

编辑：为了清楚起见-撇号是Excel的内置功能，而不仅仅是我选择的随机字符。虽然似乎找不到它的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T14:41:10.770

您是否尝试过简单地重新格式化 Excel 中的单元格？可能只是 Excel 选择了不同的格式（整数而不是字符串）。

[这是一篇](http://steveorr.net/Articles/ExcelExport.aspx)来自 .Net 的关于 Excel 格式的文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-29T07:11:14.793

[这个链接](http://www.highoncoding.com/Articles/197_Extensive_Study_of_GridView_Export_to_Excel.aspx)有你问题的确切答案。本文使用与将 html 呈现为 excel 完全相同的技术。

诀窍是使用 excel css 属性

```
<style> .text { mso-number-format:\@; } </style> 
```

[编辑]
[一个类似问题的链接](http://www.houseoffusion.com/groups/cf-talk/message.cfm/messageid:298084)。（它在冷融合中，但可以使用 CSS 应用部分）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T14:44:57.580

导出到excel时，您可以在任何需要保留为数字的单引号之前添加吗？

```
'001200 
```

这应该将其保留为文本

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T15:00:02.430

我遇到了与您的问题类似的问题，但方向相反。

这是 Excel 2007 文件的扩展属性设置。
"扩展属性='Excel 12.0 Xml;HDR=YES;IMEX=1;'";

您可能还想使用您要使用的数据格式编写虚拟记录。在 Excel 中将某些内容声明为 Text 不一定会按照您想要的方式转换数据。

幕后有一些东西可以自动设置传输期间使用的数据类型。系统使用前 8 条记录来确定这一点。如果您需要字符串值，请使用任何文本缓冲列，如果您需要更长的时间，我认为您需要使用 512+ 个字符的文本来缓冲它。

顺便说一句 - 在发现系统秘密覆盖您以编程方式设置的内容之前，我尝试了上述大部分建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-16T09:34:29.670

在前面多加一行

> 响应。写（“
> 
> ```
> td { mso 数字格式：\@; }
> ```
> 
> ");

很简单

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-18T04:36:26.583

如果您可以更改单元格值并且它不是公式的一部分，请尝试将数字更改为字母，例如：**001200 --> OO12OO :)**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-18T04:45:33.993

几个月前我遇到了类似的问题，我放弃了 Excel... 我建议您使用**[Excel Jet Cell .NET 组件](http://www.devtriogroup.com/ExcelJetcell/Default.aspx)**。

它有一个免费版本，但有一些大小限制。查看[Excel C# 示例](http://www.devtriogroup.com/ExcelJetcell/Samples/Default.aspx)：

```
// Open template
string xlfile = @"d:\prj\HrePro.xlsx";
ExcelWorkbook Wbook = ExcelWorkbook.ReadXLSX(xlfile);
ExcelCellCollection Cells = Wbook.Worksheets.Add("Sheet1").Cells;

// Save values and excel file
Cells["b2"].Value = "001";
Cells["b2"].Style.StringFormat = DefinedFormats.Textual;

Wbook.WriteXLSX(@"d:\prj\HReport.xlsx"); 
```

# asp.net - 从 Datatable 迁移到 Linq 到 Sql

> ID：347643
> 
> 赞同：1
> 
> 时间：2008-12-07T14:39:28.510
> 
> 标签：asp.net, linq-to-sql, datatable

过去我使用动态 sql 和数据表从数据库中获取数据。

如 ：

```
Public shared function GetUsersByUsername(byval username as string) as datatable

dim strSQL as string="select * from

Users where Username= " & username

return dbClass.datatable(strSQL) 

end function 
```

我可以这样使用这些数据：

```
Dim Email as string = GetUsersByUsername("mavera").rows(0).items("email")` 
```

或者

```
datagrid1.datasource=GetUsersByUsername("mavera")

datagrid1.databind() 
```

现在，我想使用 linq to sql 来做到这一点。我可以用 linq 编写查询，但不能像数据表一样使用它。我的新用途应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T14:55:13.627

您应该完全摆脱 GetUsersByName()，因为您可以在一行中完成。*您*还必须更改获取用户电子邮件等信息的方式。因此 GetUsersByName() 将被重写为：

```
dc.Users.Where(Function(u) u.Username = username); 
```

并且您的电子邮件分配声明将写为：

```
Dim Email as string = users.First().Email; 
```

如果我的 VB 语法关闭，请原谅我。我再也不用它了...

# java - 如何从 Java 中的非连续日期数组中列出缺失的日期？

> ID：347656
> 
> 赞同：3
> 
> 时间：2008-12-07T14:57:48.333
> 
> 标签：java, datetime

我有一个按日期排序的数据表，用户可以通过提供开始和结束日期从中选择一组数据。数据本身是不连续的，因为我没有周末和公共假期的数据。

我希望能够在提取的数据集中列出我没有数据的所有日子。有没有一种简单的方法，在 Java 中，去：

1.  这是一个有序的日期数组。
2.  这是选定的开始日期。（数组中的第一个日期并不总是开始日期）
3.  这是选定的结束日期。（数组中的最后一个日期并不总是结束日期）
4.  返回没有数据的日期列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T15:40:14.330

您可以创建一个临时列表并根据需要对其进行 x 。

（不是真正的 Java。对不起，我对它的记忆很糟糕。）

```
dates = [...]; // list you have now;

// build list
unused = [];
for (Date i = startdate; i < enddate; i += day) {
    unused.push(i);
}

// remove used dates
for (int j = 0; j < dates.length; j += 1) {
    if (unused.indexOf((Date) dates[j]) > -1) { // time = 00:00:00
        unused.remove(unused.indexOf((Date) dates[j]));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T15:08:28.827

您应该能够创建一个提供此功能的过滤迭代器。也许让迭代器的方法接受子集合的开始和停止日期。至于迭代器的实际实现，一旦找到起始元素，我想不出比在整个集合上进行蛮力运行更优雅的事情了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T16:26:19.543

您可以创建开始日期和结束日期之间所有可能日期的列表，然后删除出现在给定数据列表中的日期（当大多数日期缺失时效果最好），或者您可以从一个空的日期列表开始并添加日期没有出现在给定数据中。

无论哪种方式，您基本上都会遍历开始日期和结束日期之间的日期范围，跟踪您在给定日期列表中的位置。您可以将其视为“类似合并”的操作，您可以并行遍历两个列表，处理出现在一个列表中但不在另一个列表中的记录。在伪代码中，空列表版本可能是：

```
# given   - array of given dates
# N       - number of dates in given array
# missing - array of dates missing

i = 0;    # Index into given date array
j = 0;    # Index into missing data array
for (current_date = start_date; current_date <= end_date; current_date++)
{
    while (given[i] < current_date && i < N)
        i++
    if (i >= N)
        break
    if (given[i] != current_date)
        missing[j++] = current_date
}
while (current_date < end_date)
{
    missing[j++] = current_date
    current_date++
} 
```

我假设日期类型以一天为单位进行量化；也就是说，`date + 1`（或`date++`）是后天`date`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T16:47:22.870

虽然已经给出的其他答案看起来相当简单和令人愉快并且有一些好主意（我特别同意 Nerdfest 的迭代器建议），但我想我还是会试一试并编写一个解决方案来展示我会怎么做对于第一次迭代，我相信下面的内容还有改进的余地。

我也可能对您的要求过于字面理解，但您知道如何根据自己的喜好调整代码。哦，对不起对象的可怕命名。此外，由于此示例使用 Calendar，请记住 Calendar.roll() 在某些情况下可能不会更新整个 Calendar 对象，因此这是一个潜在的错误。

```
protected List<Calendar> getDatesWithNoData(Calendar start, Calendar end,
        Calendar[] existingDates) throws ParseException {

    List<Calendar> missingData = new ArrayList<Calendar>();

    for(Calendar c=start ; c.compareTo(end)<=0 ; c.roll(Calendar.DAY_OF_MONTH, true) ) {

        if(!isInDataSet(c, existingDates)) {
            Calendar c2 = Calendar.getInstance();
            c2.setTimeInMillis(c.getTimeInMillis());

            missingData.add(c2);
        }
    }
    return missingData;
}

protected boolean isInDataSet(Calendar toSearch, Calendar[] dataSet) {
    for(Calendar l : dataSet) {
        if(toSearch.equals(l)) return true;
    }
    return false;
} 
```

# sql - Sql Server 中的 dd.mm.yyyy hh:mm 格式

> ID：347659
> 
> 赞同：2
> 
> 时间：2008-12-07T15:02:42.503
> 
> 标签：sql, sql-server

我查看了 SQL Server 日期格式代码，但在列表中找不到 dd.mm.yyyy hh:mm 格式。德语日期格式（代码为 4）适用于我，但它不包含 hh:mm。有人知道这种格式的代码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T15:16:48.637

假设您的列名为 [datefield]

```
CONVERT(varchar,[datefield],104)
     + ' '
     + SUBSTRING(CONVERT(varchar,[datefield],108),1,5) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-13T08:52:12.287

```
select CONVERT(varchar,getdate(),101)
     + ' ' + SUBSTRING(CONVERT(varchar,getdate(),108),1,5) + ' '
     + SUBSTRING(CONVERT(varchar,getdate(),109),25,2) 
```

*[您可以将 getdate() 更改为您尝试转换的日期字段。]

# asp.net-mvc - ASP.NET MVC 和 REST URI

> ID：347661
> 
> 赞同：6
> 
> 时间：2008-12-07T15:06:12.543
> 
> 标签：asp.net-mvc, rest

我将如何使用 ASP.NET MVC 的路由功能处理类似以下 uri 的内容：

```
http://localhost/users/{username}/bookmarks/ - GET
http://localhost/users/{username}/bookmark/{bookmarkid} - PUT 
```

其中列出了 {username} 中用户的书签。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T04:44:16.183

您可以在您的操作方法上使用 [AcceptVerbs] 属性

```
public class BookmarksController : Controller
{
    [AcceptVerbs(HttpVerbs.Get)]
    public void Bookmarks(string user)
    {

        //add your bookmark
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public void Bookmarks(string user, int? id)
    {

        //add your bookmark
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-07T16:09:16.487

首先你需要在 global.aspx 中创建一个新路由

```
routes.MapRoute("Bookmarks", "{controller}/{user}/{action}/{id}"); 
```

然后添加一个新动作

```
public class UsersController : Controller
{
    [AcceptVerbs("Post")]
    public void Bookmarks(string user, int? id)
    {

        //add your bookmark
    }
} 
```

# c - 如何在鞋子中使用嵌入式 c？（红宝石串行端口）

> ID：347664
> 
> 赞同：2
> 
> 时间：2008-12-07T15:08:42.833
> 
> 标签：c, ruby, shoes, embedded-language

是否可以使用类似的东西：

```
require 'serialport.o' 
```

带鞋？serialport.o 是编译为 ruby​​ 扩展的 c 代码。

当我尝试在鞋子中运行以下代码时，我看不到屏幕上的可见输出，并且鞋子在 OS X 上崩溃了。

谢谢

代码：

```
require "serialport.o"

port = "/dev/tty.usbserial-A1001O0o"

sp = SerialPort.new( port, 9600, 8, 1, SerialPort::NONE)

Shoes.app :width => 300, :height => 150, :margin => 10 do
  button "On" do
  sp.write( "1" )
  end
end

sp.close 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T15:52:41.577

您可能已经检查过这个，但是如果您不使用鞋子，同样的事情会起作用吗？例如：

```
require "serialport.o"

port = "/dev/tty.usbserial-A1001O0o"
sp = SerialPort.new( port, 9600, 8, 1, SerialPort::NONE)
sp.write( "1" )
sp.close 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T04:03:37.440

我有类似的问题，但它与winxp有关。

你可以这样试试吗？

```
内核::需要“serialport.o”

```

# c# - List.Add 似乎是重复条目。怎么了？

> ID：347675
> 
> 赞同：3
> 
> 时间：2008-12-07T15:25:08.950
> 
> 标签：c#, list

我有这样的课：

```
public class myClass
{
  public List<myOtherClass> anewlist = new List<myOtherClass>;

  public void addToList(myOtherClass tmp)
  {
    anewList.Add(tmp);
  }

} 
```

所以我调用了“addToList”一百次，每次都在列表中添加一个唯一的项目。我已经测试了我的项目以表明在我运行“addToList”方法之前，它们是独一无二的。我什至放了一条线来测试“tmp”以确保它是我所期望的。

但是，当我这样做时（假设 myClass 对象称为 tmpClass）：

```
int i = tmpClass.anewList.Count();
for (int j = 0; j<i; j++)
{
   //write out each member of the list based on index j...
} 
```

我得到了完全相同的项目，它是最后一个写入我列表的项目。就好像当我添加时，我正在用我添加的最后一项覆盖整个列表。

帮助？这是没有意义的。我也尝试过 List.Insert，我总是在末尾或索引 0 处插入。仍然没有骰子。是的，我是双重来源，我的索引是正确的，当我进行测试时，我正在对每个元素进行索引。

:)

更新：好的，我试过了，但仍然遇到同样的问题：

```
foreach(myOtherClass tmpC in tmpClass.anewList)
{    
    Console.WriteLine(tmpC.theStringInMyClass.ToString());
} 
```

仍然对于 100 个项目中的每一个，我得到了相同的字符串输出......我确定我在做一些完全愚蠢的事情，但我还不知道是什么。我仍然 100% 确定从一开始就传入了正确的字符串。

-阿迪娜

* * *

好的，我试过了，仍然遇到同样的问题：

```
foreach(myOtherClass tmpC in tmpClass.anewList)
{
    Console.WriteLine(tmpC.theStringInMyClass.ToString());
} 
```

仍然对于 100 个项目中的每一个，我得到了相同的字符串输出......我确定我在做一些完全愚蠢的事情，但我还不知道是什么。我仍然 100% 确定从一开始就传入了正确的字符串。

-阿迪娜

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-07T15:52:44.760

鉴于您的 addToList 方法的签名：

```
public void addToList(myOtherClass tmp)
  {
    anewList.Add(tmp);
  } 
```

是否有可能在该方法的使用者中，您实际上并没有创建一个新实例？

您说您正在调用 addToList 100 次。据推测，这是一个循环。在每次循环迭代中，您都需要创建一个“myOtherClass”的新实例，否则，您只会更新内存中的同一个对象。

例如，如果您执行以下操作，您将拥有同一对象的 100 个副本：

```
myOtherClass item = new myOtherClass();

for(int i=0; i < 100; i++)
{
  item.Property = i;
  addToList(item);
} 
```

但是，如果您的循环如下所示，它将正常工作：

```
myOtherClass item = null;
for(int i=0; i < 100; i++)
{
  item = new myOtherClass();
  item.Property = i;
  addToList(item);
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T15:42:12.860

在这种情况下，了解您如何验证每个项目以确保这些项目是唯一的可能会有所帮助。如果您可以显示您的类的 ToString() 方法，它可能会有所帮助：您可能将它基于每个对象之间实际上相同的东西。这可能有助于确定您是否真的每次都得到相同的对象，或者所考虑的部分是否真的不是唯一的。

此外，您应该尽可能使用`foreach`循环，而不是按索引访问。

最后，列表中的项目并不是普遍唯一的，而是对存在于别处的对象的引用。如果您尝试检查检索到的项目相对于外部对象是否唯一，那么您将失败。

我猜还有一件事：您可能希望访问`anewList`私有而不是`public`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T15:29:03.510

尝试使用 foreach 而不是按索引遍历列表。我怀疑问题出在您从示例中省略的代码中，而不是列表本身。

```
foreach (MyOtherClass item in tmpClass.anewList)
{
     Console.WriteLine( item );  // or whatever you use to write it
} 
```

**编辑**

您是否检查过调试器中的列表结构以确保实际添加了您的独特项目？此外，您可能希望使用`.Count`（属性）而不是`.Count()`（扩展方法）。扩展方法实际上可能会遍历列表以计算方法，而属性只是查找保存计数的私有变量的值。

@James 可能在这里有所作为。如果您只是更改已插入项目的属性并重新插入它，而不是每次都创建一个新对象，这将导致您看到的行为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T16:01:14.057

好吧，从我在这里读到的，我想你的问题可能是在列表中添加项目 - 你确定，你不是一次又一次地添加相同的引用吗？这可能是为什么您在列表中有 100 个“最后一项”的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T15:37:53.290

另请注意，当您使用确切的形式时：

```
 for (int j = 0; j < tmpClass.anewList.Count(); j++) 
```

C# 编译对循环进行了特殊优化。如果您与语法不同（例如，通过将 Count 属性从循环中拉出到单独的变量中，就像您在示例中所做的那样），编译会跳过该优化。

它不会影响显示的内容，但需要更长的时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T16:01:03.993

知道了！谢谢詹姆斯-

这是我做错的愚蠢的事情：

我有：

```
myClass tmpClass = new myClass();
myOtherClass anewitem = new myOtherClass();
string tst = "";

for (int i = 0; i < 100; i++) 
{
    tst += "blah";
    anewitem.theStirngInMyClass = tst;
    tmpClass.AddToList(anewitem);
} 
```

当我把它改成这样时：

```
myClass tmpClass = new myClass();
string tst = "";

for (int i = 0; i < 100; i++) 
{
    myOtherClass anewitem = new myOtherClass()
    tst += "blah";
    anewitem.theStringInMyClass = tst;
    tmpClass.AddToList(tst);
} 
```

一切都好。我得到它。:)

谢谢你们的帮助！

-阿迪娜

# iphone - iPhone TrustStore CA certificates

> ID：347690
> 
> 赞同：12
> 
> 时间：2008-12-07T15:42:36.277
> 
> 标签：iphone, certificate, x509

Does any of you have a clue how to alter the contents of `Security.framework/TrustStore.sqlite3`. It seems as if the iPhone uses it to store trusted CA certificates. I really want my iPod touch to trust my custom certificate. Beside that, does anyone of you know an app (win32) to edit sqlite3 database files (except sqliteman, this one always crashes for me).

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T00:47:39.763

If you have a webserver configured to serve up digital certificates with the correct mime-type then Safari on the iPhone will add them to the trust store.

mime-type for a CA certificate is "application/x-x509-ca-cert" (example [here](http://o-regan.org/oregan.org.cacert))

When safari downloads this certificate it will as the user if they want to trust it.

Once trusted it appears in the Settings | General | Profiles section as a Configuration Profile.

[alt text http://o-regan.org/cacert.png](http://o-regan.org/cacert.png)

The certificate is also inserted into the TrustStore.sqlite3 db. Verified that by doing a backup and extracting the DB with [iphone backup extractor](http://supercrazyawesome.com/).

I'm not sure if that now means that it is trusted for other purposes, say as an SSL root.

Hope this helps, I might investigate more if time permits.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-18T16:10:42.733

I can imagine that someone else will encounter this problem, therefore I'd like to answer how it works (Apple won't like to see that):

1st) The iPhoneOS trusts every CA certificate stored in /System/Library/Frameworks/Security.framework/TrustStore.sqlite3

2nd) Some fields in that database contain data which I did not understand, while other's meanings like "SHA1" are quite obvious.

3rd) There are two different TrustStore.sqlite3s on your iPod/iPhone. The second one is located at /private/var/Keychains/TrustStore.sqlite3\. The only difference between those is that Apple only trusts the contents of the one in Security.framework.

4th) The latter one is used to store user installed certificates (thanks, koregan), while the table layout is the same.

5th) Open your self-signed certificate using Mail or Safari and install it.

6th) Open /private/var/Keychains/TrustStore.sqlite3 using your favourite SQLite database manager and look for the row in tsettings whose "SHA1" BLOB contains the hash of your CA certificate.

7th) Extract the whole row and insert it into TrustStore.sqlite3's tsettings table.

8th) Make sure you copied the database back to the device, reboot it.

9th) By now it should totally trust those certificates which are signed by your custom CA.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-09T04:04:15.267

You can use [iPhone Configuration Utility](https://support.apple.com/apple-configurator) to install certificates.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T23:13:15.740

For the second part of your question, I've used the SQLite extension for Firefox to create and edit sqlite db files.

[addons.mozilla.org](https://addons.mozilla.org/en-US/firefox/addon/5817)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-12-17T22:01:40.547

To install your own CA certificate in iOS 13 (Simulator or Phone/Pad)

1.  Place your CA certificate on a website, make sure it has a .crt extension (like MyCA.crt).
2.  Go to Safari in the Simulator
3.  Download the certificate, choose Yes to Install the 'Profile' when prompted
4.  Go to settings in the Simulator General > Profile > [Your Certificate] and click install
5.  Go to settings in the Simulator General > Info > Trusted Certificates Find your certificate and toggle the switch to On.

Your CA is now trusted. In older versions of the simulator you could just drag your certificate on the simulator but that no longer seems to work.

Remember that Apple limits the validation duration of your certificates so don't make them valid for 10 years but choose a shorter time.

If you fail at the first step then this is probably because your webserver doesn't recognise the .crt extension. Common web servers like Apache should work fine.

*   @Apple: I would expect a setting in the developer options in the simulator to just accept insecure certificates but honestly for the first time in many years the process to install your own CA is easier (AFAIK) on iOS then Android 10!

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-07-12T09:05:22.323

Since iOS 11 the TrustStore is located at: `/System/Library/Security/Certificates.bundle` instead of the usual location: `/System/Library/Frameworks/Security.framework`

# emacs - XP上的Emacs，tramp，plink问题

> ID：347693
> 
> 赞同：6
> 
> 时间：2008-12-07T15:46:11.917
> 
> 标签：emacs, windows-xp, tramp, plink

目标机器正在运行 Ububtu 服务器 8.04。
这是流浪汉输出：

```
tramp: Opening connection for nungu@ip.ip.ip.ip using nil...<br>
tramp: Waiting for prompts from remote shell<br>
tramp: Waiting 60s for prompt from remote shell<br>
tramp: Sending password<br>
tramp: Found remote shell prompt.<br>
tramp: Initializing remote shell<br>
Loading time-date...done<br>
tramp: Waiting 30s for remote `/bin/sh' to come up...<br>
tramp: Setting up remote shell environment

apply: Couldn't `stty -inlcr -echo kill '^U'', see buffer `*tramp/plink nungu@ip.ip.ip.ip*' 
```

**编辑，详细缓冲区最后包含以下内容：**

```
# Waiting 30s for remote `/bin/sh' to come up...
exec env 'ENV=' 'PROMPT_COMMAND=' 'PS1=$ ' /bin/sh
$ exec env 'ENV=' 'PROMPT_COMMAND=' 'PS1=$ ' /bin/sh
$ 
# Setting up remote shell environment
$ stty -inlcr -echo kill '^U'
stty -inlcr -echo kill '^U'

$ $ $ [[Regexp `\(^[^#$%>
]*[#$%>] *\|^[^#$%>
]*[#$%>] *\(\[[0-9;]*[a-zA-Z] *\)*\)\'' not found in 30 secs]] 
```

命令：
`stty -inlcr -echo kill '^U'`
`-inclr`关闭“将换行符转换为回车”
`-echo` 关闭“回显输入字符”
`kill '^U'`设置'^U'以擦除当前行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T22:41:29.970

同样的问题; 和修复

工作：NTEmacs-22.1 - Tramp 版本：2.0.55

失败：NTEmacs-22.3.1 - Tramp 版本：2.0.58-pre

请参阅评论 - 2.0.* 版本均不适用于 emacs-22.3.1

升级到 tramp 2.1.14 - emacs 22/3/1 效果很好

建议您尝试从[Savannah](http://savannah.gnu.org/projects/tramp)升级。

注意：我没有正确配置，只是从 listp/net 中删除了现有的 tramp el 和 elc 文件；并从下载的 tar 中删除那些——你需要修改 trampver.el.in 来构建一个有意义的 lisp 文件——但这并不完全是火箭科学

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T23:10:55.280

*见缓冲区流浪汉/plink nugu@ip.ip.ip.ip'*

那么，缓冲区中有什么？

**编辑**感谢添加缓冲区输出。

“stty”命令正在尝试配置 TRAMP 将用来访问远程系统的终端。如果您直接通过 SSH 连接到系统并尝试运行该命令，会发生什么情况？（使用与 TRAMP 相同的参数...）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T16:48:41.587

我不知道您在谈论的技术，但是如果 Genehack 说您的“正则表达式不匹配”​​，那么您需要使用更简单的正则表达式进行测试，或者以其他方式简化您的解决方案，直到您弄清楚不工作的那块拼图。你知道，“它适用于这个简单的正则表达式，但不适用于这个更复杂的”或“它根本不是正则表达式，因为没有正则表达式有效”......

如果你愿意的话，对问题进行组件化、简化和括号化...

我意识到这是显而易见的一般建议，但现在是星期天早上......

# java - 在 Eclipse 中构建 Java 后如何自动导出 WAR？

> ID：347698
> 
> 赞同：10
> 
> 时间：2008-12-07T15:50:06.747
> 
> 标签：java, eclipse, deployment, war

我在 Eclipse 3.2 中有一个 J2EE 项目，在每次构建结束时，我想自动创建和部署一个 WAR 文件。目前我必须手动完成 5 或 6 次鼠标点击，自动化它会很好。

我知道我可以通过使用 ANT 的自定义构建脚本来做到这一点，但我希望有一个 Eclipse 本机解决方案。

我的 Eclipse 环境中安装了 J2EE 标准工具 (JST) 和 Web 标准工具 (WST) 插件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-07T18:27:02.093

如果您可以将它实现为 Ant 脚本，那么您可以让 Eclipse 在每次构建时自动调用该 Ant 脚本（并且在 Eclipse 环境中）。使用 Project->Properties->Builders->Add->Ant Builder。为该构建器提供自定义 Ant 脚本，它将在项目的“正常”构建器之后自动执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T16:42:33.550

只有两个选项：

*   或者您右键单击项目：运行-> 在服务器上运行。（您的项目需要是一个网络项目。）
*   或者您编写该 ant 脚本并使用 eclipse 来存储您的 ant 运行配置并重用该配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T14:41:45.873

使用最新的 Eclipse Java EE 版本，您可以定义服务器并将项目附加到这些服务器。

这将在项目更改时自动将您的项目部署到服务器。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-12-08T10:04:32.637

右键单击您的项目：Export -> Web -> WAR File 做你想做的事。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-12-09T21:35:08.733

考虑使用 netbeans，无需自己为大多数主要服务器（即 tomcat、was、weblogic、glassfish 和 jboss）编写 ant 就可以进行完整的 ear 和 war 部署。

我强烈推荐它，甚至超过 IBM 理性套件。

卡尔

# php - 需要从 PHP 数组中获取特定索引

> ID：347703
> 
> 赞同：1
> 
> 时间：2008-12-07T15:53:16.880
> 
> 标签：php, arrays

我在 PHP 中创建了一个数组，其中包含 bucnh 的 unix 时间戳。

我正在尝试创建一个函数，该函数将返回一个数组，其中包含该数组中 3 个最大数字的索引。

例如，如果最大的数字位于索引 3,5 和 8

如果最大的是 5，第二大的是 8，三者中最小的是 3，我想要一个按该顺序保存值 (5,8,3) 的数组。

坦率地说，我不知道如何解决这个问题。有人知道怎么做这个吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-07T16:00:39.330

您可以使用[asort](http://uk3.php.net/manual/en/function.asort.php)对数组进行排序并维护索引，然后使用[slice](http://uk3.php.net/manual/en/function.array-slice.php)和第四个参数，再次维护索引，获取您所追求的前 x 个元素，最后使用[array_keys](http://uk3.php.net/manual/en/function.array-keys.php)。

可能有一种更快的方法，但这只是为了表明有很多 PHP 数组函数可以帮助您实现所需的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T15:57:42.503

西蒙发布了简单且可能足够好的表演方法。

仅当您有一个非常大的数组时，另一个选项是扫描数组并跟踪您看到的三个最高值的索引。这是 O(n)，但是（特别是因为它是在解释的 PHP 代码中，而不是编译的内置函数），除了最大的数组之外，可能会更慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T16:04:49.820

在伪代码中：

```
function select(list[1..n], k)
     for i from 1 to k
         maxIndex = i
         maxValue = list[i]
         for j from i+1 to n
             if list[j] > maxValue
                 maxIndex = j
                 maxValue = list[j]
         swap list[i] and list[maxIndex]
     return list[k]

newarray[] = select(array, 1);
newarray[] = select(array, 2);
newarray[] = select(array, 3); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-07T17:19:18.407

在 PHP 代码中：

```
function threeLargest($array){
 krsort($array, "SORT_NUMERIC");
 $return[0] = $array[0];
 $return[1] = $array[1];
 $return[2] = $array[2];
 return $return;
} 
```

# .net - 单层上的可信子系统

> ID：347719
> 
> 赞同：1
> 
> 时间：2008-12-07T16:04:16.047
> 
> 标签：.net, architecture

想象一下使用分层架构设计的 .NET 应用程序。

将应用程序的所有层部署到同一台机器上时，是否可以使用类似于[受信任子系统模式的东西？](http://msdn.microsoft.com/en-us/library/aa480587.aspx)

默认情况下，这种设计是不安全的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T18:30:02.867

这取决于您如何使用系统以及如何部署层。

假设您有一台机器，其中 SQL Server 在一个用户帐户下运行，您的服务层在另一个服务帐户下，并且您的用户使用第三个帐户登录（当然没有管理员访问权限）。假设中间层帐户可以访问数据库，但没有用户帐户。在这种情况下，是的，这基本上是您对可信子系统模型的经典描述。

但是，如果您遇到最终用户帐户可以访问数据库和服务层的情况，那么您确实打破了这种模式并打开了一个漏洞。如果最终用户是管理员并且可以以某种方式篡改其中一个层，那么您就是在打破这种模式。如果用户可以物理访问机器并且可以篡改 IT，我什至认为你正在打破这种模式......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T18:14:07.657

如果所有层都部署在同一个过程中，那么我几乎可以根据定义说您没有使用受信任的子系统模型。

您可以（至少在理论上）将不同的层部署到同一台物理机器上，同时仍然使用受信任的子系统模型，但当然更难保证中间层的安全性。例如，您的中间层可能是在 IIS 下运行的受信任 Web 服务。

# ios - 如何将透视变换应用于 UIView？

> ID：347721
> 
> 赞同：199
> 
> 时间：2008-12-07T16:04:39.477
> 
> 标签：ios, cocoa-touch, uiview, core-animation, calayer

我正在寻找对 UIView 执行透视变换（例如在coverflow中看到的）

有谁知道这是否可能？

我已经使用`CALayer`并浏览了所有实用程序员 Core Animation 播客，但我仍然不清楚如何在 iPhone 上创建这种转换。

任何帮助、指针或示例代码片段将不胜感激！

* * *

## 回答 #1

> 赞同：332
> 
> 时间：2008-12-09T17:44:06.250

正如 Ben 所说，您需要使用`UIView's`图层，使用 a`CATransform3D`来执行`layer's` `rotation`. [如此处所述](http://watchingapple.com/2008/04/core-animation-3d-perspective/)，获得透视工作的技巧是直接访问(m34)的矩阵`cells`之一。`CATransform3D`矩阵数学从来都不是我的事，所以我无法确切解释为什么会这样，但确实如此。您需要将此值设置为初始变换的负分数，然后将图层旋转变换应用于该值。您还应该能够执行以下操作：

**Objective-C**

```
UIView *myView = [[self subviews] objectAtIndex:0];
CALayer *layer = myView.layer;
CATransform3D rotationAndPerspectiveTransform = CATransform3DIdentity;
rotationAndPerspectiveTransform.m34 = 1.0 / -500;
rotationAndPerspectiveTransform = CATransform3DRotate(rotationAndPerspectiveTransform, 45.0f * M_PI / 180.0f, 0.0f, 1.0f, 0.0f);
layer.transform = rotationAndPerspectiveTransform; 
```

**斯威夫特 5.0**

```
if let myView = self.subviews.first {
    let layer = myView.layer
    var rotationAndPerspectiveTransform = CATransform3DIdentity
    rotationAndPerspectiveTransform.m34 = 1.0 / -500
    rotationAndPerspectiveTransform = CATransform3DRotate(rotationAndPerspectiveTransform, 45.0 * .pi / 180.0, 0.0, 1.0, 0.0)
    layer.transform = rotationAndPerspectiveTransform
} 
```

它为每次旋转从头开始重建图层变换。

可以在[此处](http://www.sunsetlakesoftware.com/2008/10/22/3-d-rotation-without-trackball)`CALayers`找到一个完整的示例（带有代码） ，根据 Bill Dudney 的示例，我在其中实现了基于触摸的旋转和缩放。最新版本的程序，在页面的最底部，实现了这种透视操作。代码应该相当简单易读。

您在回复中引用的`sublayerTransform`是应用于您的子层的转换`UIView's` `CALayer`。如果您没有任何子图层，请不要担心。我在示例中使用 sublayerTransform 只是因为`CALayers`我正在旋转的一层中包含两个。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-07T17:43:09.590

您只能使用直接应用于 UIView 的变换属性的核心图形（Quartz，仅限 2D）变换。要在 Coverflow 中获得效果，您必须使用 CATransform3D，它应用于 3-D 空间，因此可以为您提供所需的透视图。您只能将 CATransform3D 应用于图层，而不是视图，因此您将不得不为此切换到图层。

查看 Xcode 附带的“CovertFlow”示例。它仅适用于 mac（即不适用于 iPhone），但很多概念都可以很好地转移。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-31T11:09:38.920

**斯威夫特 5.0**

```
func makeTransform(horizontalDegree: CGFloat, verticalDegree: CGFloat, maxVertical: CGFloat,rotateDegree: CGFloat, maxHorizontal: CGFloat) -> CATransform3D {
    var transform = CATransform3DIdentity

    transform.m34 = 1 / -500

    let xAnchor = (horizontalDegree / (2 * maxHorizontal)) + 0.5
    let yAnchor = (verticalDegree / (-2 * maxVertical)) + 0.5
    let anchor = CGPoint(x: xAnchor, y: yAnchor)

    setAnchorPoint(anchorPoint: anchor, forView: self.imgView)
    let hDegree  = (CGFloat(horizontalDegree) * .pi)  / 180
    let vDegree  = (CGFloat(verticalDegree) * .pi)  / 180
    let rDegree  = (CGFloat(rotateDegree) * .pi)  / 180
    transform = CATransform3DRotate(transform, vDegree , 1, 0, 0)
    transform = CATransform3DRotate(transform, hDegree , 0, 1, 0)
    transform = CATransform3DRotate(transform, rDegree , 0, 0, 1)

    return transform
}

func setAnchorPoint(anchorPoint: CGPoint, forView view: UIView) {
    var newPoint = CGPoint(x: view.bounds.size.width * anchorPoint.x, y: view.bounds.size.height * anchorPoint.y)
    var oldPoint = CGPoint(x: view.bounds.size.width * view.layer.anchorPoint.x, y: view.bounds.size.height * view.layer.anchorPoint.y)

    newPoint = newPoint.applying(view.transform)
    oldPoint = oldPoint.applying(view.transform)

    var position = view.layer.position
    position.x -= oldPoint.x
    position.x += newPoint.x

    position.y -= oldPoint.y
    position.y += newPoint.y

    print("Anchor: \(anchorPoint)")

    view.layer.position = position
    view.layer.anchorPoint = anchorPoint
} 
```

您只需要使用您的学位调用该函数。例如：

```
var transform = makeTransform(horizontalDegree: 20.0 , verticalDegree: 25.0, maxVertical: 25, rotateDegree: 20, maxHorizontal: 25)
imgView.layer.transform = transform 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-12-21T11:43:29.400

您可以使用 iCarousel SDK 获得准确的轮播效果。

通过使用奇妙且免费的 iCarousel 库，您可以在 iOS 上获得即时的 Cover Flow 效果。您可以从[https://github.com/nicklockwood/iCarousel](https://github.com/nicklockwood/iCarousel)下载它，并通过添加一个桥接头（它是用 Objective-C 编写的）相当容易地将它放入您的 Xcode 项目中。

如果您之前没有将 Objective-C 代码添加到 Swift 项目中，请按照以下步骤操作：

*   下载 iCarousel 并解压
*   进入您解压缩的文件夹，打开它的 iCarousel 子文件夹，然后选择 iCarousel.h 和 iCarousel.m 并将它们拖到您的项目导航中 - 这是 Xcode 中的左侧窗格。就在 Info.plist 下面就可以了。
*   选中“如果需要复制项目”，然后单击完成。
*   Xcode 将提示您消息“您想配置一个 Objective-C 桥接头吗？” 单击“创建桥接头” 您应该会在项目中看到一个名为 YourProjectName-Bridging-Header.h 的新文件。
*   将此行添加到文件中：#import "iCarousel.h"
*   将 iCarousel 添加到项目后，您就可以开始使用它了。
*   确保您符合 iCarouselDelegate 和 iCarouselDataSource 协议。

斯威夫特 3 示例代码：

```
 override func viewDidLoad() {
      super.viewDidLoad()
      let carousel = iCarousel(frame: CGRect(x: 0, y: 0, width: 300, height: 200))
      carousel.dataSource = self
      carousel.type = .coverFlow
      view.addSubview(carousel) 
    }

   func numberOfItems(in carousel: iCarousel) -> Int {
        return 10
    }

    func carousel(_ carousel: iCarousel, viewForItemAt index: Int, reusing view: UIView?) -> UIView {
        let imageView: UIImageView

        if view != nil {
            imageView = view as! UIImageView
        } else {
            imageView = UIImageView(frame: CGRect(x: 0, y: 0, width: 128, height: 128))
        }

        imageView.image = UIImage(named: "example")

        return imageView
    } 
```

# wpf - 如何在 WPF 页面或 UserControl 对象上捕获 KeyDown 事件？

> ID：347724
> 
> 赞同：44
> 
> 时间：2008-12-07T16:07:07.677
> 
> 标签：wpf, keydown

我有一个带有 UserControl 的页面。如果用户在我想要处理的页面上的任何位置按 Esc。

我认为这就像连接 PreviewKeyDown 事件、测试 Esc 键然后处理它一样简单。但是，当我在事件处理程序中放置断点时，我发现它永远不会被调用。我想也许 UserControl 可能会被击中，所以我在那里尝试了 PreviewKeyDown ......结果相同。

有谁知道在 Page 对象上测试 KeyDown 或 PreviewKeyDown 的正确位置？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-02-15T02:40:15.597

# 附加到窗口的事件

加载控件后，使用 附加到窗口的`KeyDown`事件（或任何事件）`Window.GetWindow(this)`，如下所示：

**XAML**

```
<UserControl Loaded="UserControl_Loaded">
</UserControl> 
```

**背后的代码**

```
private void UserControl_Loaded(object sender, RoutedEventArgs e) {
  var window = Window.GetWindow(this);
  window.KeyDown += HandleKeyPress;
}

private void HandleKeyPress(object sender, KeyEventArgs e) {
  //Do work
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-06-11T11:10:38.260

我曾经有过同样的问题。我有一个窗口，它承载一个框架，该框架加载/导航到各个页面，而这些页面又只包含 1 个包含正常控件/元素（标签、超链接等）的 UserControl。

我发现（当然经过几个小时的挫折！！！）是，如果您没有将注意力集中在上面提到的控件/元素之一上，则 PreviewKeyDown 事件不会在 UserControl 上触发（在 Frame 级别的某处停止）但是只要您将焦点（例如在 UserCotrol 的 Loaded 事件处理程序中调用 ctrl.Focus() ）放在其中一个控件上，就会发生魔术，它就会起作用，事件也会为 UserControl 触发。

当然，事后想一想，这很有意义，但我 100% 肯定这会让 10 个人中至少有 5 人感到惊讶:) 疯狂的小东西叫做 WPF ......

干杯！

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-12-07T16:26:32.647

我相信 PreviewKeyDown 事件是一个隧道路由事件，而不是冒泡事件。如果是这种情况，那么如果您的 Page 没有收到该事件，则 UserControl 也不应该是，因为它位于可视树中的 Page 下方。也许尝试在您的应用程序的顶层（也许是窗口？）处理它，看看它是否正在接收事件？

另一个可能有帮助的选择是[在 CodePlex 中使用诸如 Snoop](http://snoopwpf.codeplex.com/)之类的东西来确定事件的去向。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-12-09T16:09:15.543

在我的 UserControl 上将 Focusable 属性设置为 true 为我解决了这个问题。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-09-16T04:07:35.030

我提出了一种加强@Doc 提到的方法。

提到的以下代码@Doc 将起作用，因为 KeyDown 路由事件冒泡到最外层`Window`。一旦`Window`接收到从内部元素冒泡的 KeyDown 事件，`Window`就会触发注册到它的任何 KeyDown 事件处理程序，如下所示`HandleKeyPress`。

```
private void UserControl_Loaded(object sender, RoutedEventArgs e) {
  var window = Window.GetWindow(this);
  window.KeyDown += HandleKeyPress;
}

private void HandleKeyPress(object sender, KeyEventArgs e) {
  //Do work
} 
```

但这`+=`是有风险的，程序员更有可能忘记取消注册事件处理程序。然后会发生内存泄漏或一些错误。

这里我建议，

## YourWindow.xaml.cs

```
protected override void OnKeyDown(KeyEventArgs e)
{
    base.OnKeyDown(e);

    // You need to have a reference to YourUserControlViewModel in the class.
    YourUserControlViewModel.CallKeyDown(e);

    // Or, if you don't like ViewModel, hold your user-control in the class then
    YourUserControl.CallKeyDown(e);
} 
```

## YourUserControlViewModel.cs 或 YourUserControl.xaml.cs

```
public void CallKeyDown(KeyEventArgs e) {
  //Do your work
} 
```

无需在 xaml 中编码。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-03-09T13:13:47.430

什么对我有用：

仅在窗口**Loaded 事件**上监听 PreviewKeyDown 事件：

```
void GameScreen_Loaded(object sender, RoutedEventArgs e)
{
     this.PreviewKeyDown += GameScreen_PreviewKeyDown;
     this.Focusable = true;
     this.Focus();
}

void GameScreen_PreviewKeyDown(object sender, KeyEventArgs e)
{
     MessageBox.Show("it works!");   
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-10-10T21:23:20.260

从 WinForms 调用 WPF 窗口时，我遇到了类似的问题。KeyDown或*PreviewKeyDown*事件均未触发*。*

```
var wpfwindow = new ScreenBoardWPF.IzbiraProjekti();
    ElementHost.EnableModelessKeyboardInterop(wpfwindow);
    wpfwindow.Show(); 
```

但是，将窗口显示为**对话框**，它可以工作

```
var wpfwindow = new ScreenBoardWPF.IzbiraProjekti();
    ElementHost.EnableModelessKeyboardInterop(wpfwindow);
    wpfwindow.ShowDialog(); 
```

*PreviewKeyDown事件就像**Escape*和*箭头*键的魅力一样被触发。

```
void MainWindow_PreviewKeyDown(object sender, KeyEventArgs e)
        {
            switch (e.Key)
            {
                case Key.Escape:
                    this.Close();
                    break;
                case Key.Right:
                    page_forward();
                    break;
                case Key.Left:
                    page_backward();
                    break;
            }
        } 
```

希望这有效。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-07-24T11:06:36.043

您可以简单地使用该`Weindow_KeyDown`事件。

这是一个例子

```
private void Window_KeyDown(object sender, KeyEventArgs e)
        {
            // ... Test for F1 key.
            if (e.Key == Key.F1)
            {
                this.Title = "You pressed F1 key";
            }
        } 
```

不要忘记将`Weindow_KeyDown`属性添加到 Window 标签

```
<Window x:Class="WpfApplication25.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525"
        KeyDown="Window_KeyDown">
</Window> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-08-25T18:09:12.770

如果您不想附加到窗口的事件，请为您的用户控件或页面的可见更改添加一个事件：

```
IsVisibleChanged="Page_IsVisibleChanged" 
```

然后在后面的代码中：

```
private void Page_IsVisibleChanged(object sender, DependencyPropertyChangedEventArgs e)
        {
            if(this.Visibility == Visibility.Visible)
            {
                this.Focusable = true;
                this.Focus();
            }
        } 
```

现在，如果您按任意键，您的事件 KeyDown 将被触发。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-08-26T11:14:11.147

@Daniel 的解决方案的替代方案，不需要您为整个窗口添加事件处理程序，是执行以下操作：

```
public partial class MyControl : UserControl{

public MyControl()
{
   MouseEnter+= MouseEnterHandler;
   MouseLeave+= MouseLeaveHandler;
}

protected void MouseEnterHandler(object sender, MouseEventArgs e)
{
   var view = sender as MyControl;
   view.KeyDown += HandleKeyPress;
   view.KeyUp += HandleKeyReleased;
   view.Focus();
}

protected void MouseLeaveHandler(object sender, MouseEventArgs e)
{
   var view = sender as MyControl;
   view.KeyDown -= HandleKeyPress;
   view.KeyUp -= HandleKeyReleased;
}

protected void HandleKeyPress(object sender, KeyEventArgs e)
{
    // What happens on key pressed
}

protected void HandleKeyReleased(object sender, KeyEventArgs e)
{
    // What happens on key released
}

} 
```

这样，您可以在视图的不同部分拥有同一事件的不同句柄。句柄是本地的并且特定于控件，您无需将句柄添加到全局窗口。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-01-25T11:28:13.420

尝试使用 ElementHost.EnableModelessKeyboardInterop 启用您的窗口。就我而言，它在 Keydown 事件中捕获箭头键。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-07-29T07:40:29.547

我解决了这个问题，只是在视图中的一个按钮上调用 .Focus() 并确保窗口已完成所有元素的加载

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2016-01-03T00:16:51.113

这是经过测试并且绝对有效的。

```
 Private Sub textbox1_PreviewKeyDown(sender As Object, e As KeyEventArgs) Handles textbox1_input.PreviewKeyDown
        If (e.Key = Key.Down) Then
            MessageBox.Show("It works.")
        End If
    End Sub

'detect key state directly with something like this below
 Dim x As KeyStates = System.Windows.Input.Keyboard.GetKeyStates(Key.Down) 
```

PreviewKeyDown 是大多数人错过的。将 PreviewKeyDown 视为键盘事件的整体观察者，（但如果我没记错，则不会影响它们）并且 KeyDown 事件正在您当前所在的控件或类的范围内被监听。

# python - python中的高斯-勒让德算法

> ID：347734
> 
> 赞同：16
> 
> 时间：2008-12-07T16:15:40.250
> 
> 标签：python, algorithm, pi

我需要一些帮助来计算 Pi。我正在尝试编写一个将 Pi 计算为 X 位的 python 程序。我已经从 python 邮件列表中尝试了几个，它对我的​​使用来说很慢。我已阅读有关[Gauss-Legendre Algorithm](http://en.wikipedia.org/wiki/Gauss-Legendre_algorithm)的信息，并尝试将其移植到 Python 中但没有成功。

我正在阅读[Here](http://www.geocities.com/hjsmithh/Pi/Gauss_L.html)，我将不胜感激任何关于我哪里出错的意见！

它输出：0.163991276262

```
from __future__ import division
import math
def square(x):return x*x
a = 1
b = 1/math.sqrt(2)
t = 1/4
x = 1
for i in range(1000):
    y = a
    a = (a+b)/2
    b = math.sqrt(b*y)
    t = t - x * square((y-a))
    x = 2* x

pi = (square((a+b)))/4*t
print pi
raw_input() 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-07T16:29:55.790

1.  您忘记了括号`4*t`：

    ```
    pi = (a+b)**2 / (4*t) 
    ```

2.  您可以使用它`decimal`来执行更高精度的计算。

    ```
    #!/usr/bin/env python
    from __future__ import with_statement
    import decimal

    def pi_gauss_legendre():
        D = decimal.Decimal
        with decimal.localcontext() as ctx:
            ctx.prec += 2                
            a, b, t, p = 1, 1/D(2).sqrt(), 1/D(4), 1                
            pi = None
            while 1:
                an    = (a + b) / 2
                b     = (a * b).sqrt()
                t    -= p * (a - an) * (a - an)
                a, p  = an, 2*p
                piold = pi
                pi    = (a + b) * (a + b) / (4 * t)
                if pi == piold:  # equal within given precision
                    break
        return +pi

    decimal.getcontext().prec = 100
    print pi_gauss_legendre() 
    ```

输出：

```
3.141592653589793238462643383279502884197169399375105820974944592307816406286208\
    998628034825342117068 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T16:37:09.413

```
pi = (square((a+b)))/4*t 
```

应该

```
pi = (square((a+b)))/(4*t) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-07T16:38:24.790

1.  如果要将 PI 计算到 1000 位，则需要使用支持 1000 位精度的数据类型（例如[mxNumber](http://www.egenix.com/products/python/mxExperimental/mxNumber/)）
2.  您需要计算 a、b、t 和 x，直到 |ab| < 10**-digits，不迭代数字次。
3.  按照@JF 的建议计算平方和圆周率。

# c++ - 如何使用 eptlib 库从 Debian 包中获取文件列表？

> ID：347736
> 
> 赞同：0
> 
> 时间：2008-12-07T16:18:51.023
> 
> 标签：c++, debian, apt

简单的问题：我已经用 libept 加载了一个 Apt 包记录。有没有获取文件列表的方法？听起来应该像

```
 record.GetFileList(); 
```

它应该返回一个向量字符串，如输出

```
 dpkg -L packagename 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-08T21:45:56.510

libept 的主要开发人员（Petr Rockai）向我解释说，不幸的是，目前 libept 没有这样的方法。他们在 Adept 中所做的是：

```
QString flfilename = "/var/lib/dpkg/info/" + u8(t.package()) + ".list";
QFile flfile(flfilename);

QTextStream flInStream(&flfile);
while (!flInStream.atEnd()) {
   QString line = flInStream.readLine();
   // do stuff with line
}
flfile.close(); 
```

# c# - 构建不会在 asp.net mvc 的视图中捕获错误

> ID：347741
> 
> 赞同：9
> 
> 时间：2008-12-07T16:23:08.863
> 
> 标签：c#, asp.net, asp.net-mvc, debugging

为什么我们不会在 asp.net mvc 视图 f.eks 中收到关于内联代码错误的编译错误

```
<h1><%= ViewData.Model.Title.Tostrig() %></h1> 
```

上面的代码将构建得很好。webform 控件中的拼写错误会给你一个错误，所以我不明白为什么在 asp.net mvc 中不支持它

[编辑：幸运的是，asp.net mvc http://weblogs.asp.net/scottgu/archive/2008/12/19/asp-net-mvc-design-gallery-and](http://weblogs.asp.net/scottgu/archive/2008/12/19/asp-net-mvc-design-gallery-and-upcoming-view-improvements-with-the-asp-net-mvc-release-candidate.aspx)的第一个 RC 中似乎包含一个修复程序 [-upcoming-view-improvements-with-the-asp-net-mvc-release-candidate.aspx](http://weblogs.asp.net/scottgu/archive/2008/12/19/asp-net-mvc-design-gallery-and-upcoming-view-improvements-with-the-asp-net-mvc-release-candidate.aspx)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-07T16:34:54.033

ASP.NET 和 ASP.NET MVC 中的 ASPX 文件不是从 Visual Studio IDE 编译的。正如您所指出的，这通常是“误报”的原因。

我经常将[aspnet_compiler](http://msdn.microsoft.com/en-us/library/ms229863(VS.80).aspx)添加为构建后操作来查找这些错误。您将在构建过程中增加一些时间，但作为等待的交换，您应该能够更轻松地发现这些错误。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-07T17:56:55.693

根据 Jason 的回答，这条线应该适用于大多数项目：

```
 C:\Windows\Microsoft.NET\Framework\v2.0.50727\aspnet_compiler -v / -p "$(ProjectDir)\" 
```

或者对于 .NET 4 项目：

```
 C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_compiler -v / -p "$(ProjectDir)\" 
```

源 -[使用 aspnet_compiler 编译 aspx 模板](http://mikehadlow.blogspot.com/2008/05/compiling-aspx-templates-using.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-09-27T18:27:54.203

您需要做的就是在项目文件中将 MvcBuildViews 属性更改为 true。

例如

```
 <PropertyGroup>
    <TargetFrameworkVersion>v3.5</TargetFrameworkVersion>
    <MvcBuildViews>true</MvcBuildViews>
  </PropertyGroup> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T17:47:18.833

你可以看到

[http://odetocode.com/blogs/scott/archive/2006/10/17/8190.aspx](http://odetocode.com/blogs/scott/archive/2006/10/17/8190.aspx)

# c++ - IDebugControl::WaitForEvent 工作一次然后返回 E_HANDLE

> ID：347747
> 
> 赞同：0
> 
> 时间：2008-12-07T16:28:34.703
> 
> 标签：c++, winapi, com, dbgeng

我正在尝试制作一个使用[Debugger Engine API](http://msdn.microsoft.com/en-gb/library/cc265839.aspx)的小工具，但我的成功非常有限。

我可以获得我的[IDebugClient](http://msdn.microsoft.com/en-gb/library/cc265976.aspx)和[IDebugControl](http://msdn.microsoft.com/en-gb/library/cc266102.aspx)实例，然后我可以从那里附加到已经运行的用户进程中。然后我进入一个主循环，在其中调用[WaitForEvent](http://msdn.microsoft.com/en-gb/library/cc266039.aspx)、[OutputStackTrace](http://msdn.microsoft.com/en-gb/library/cc266034.aspx)、[SetExecutionStatus](http://msdn.microsoft.com/en-gb/library/cc266097.aspx) ( `DEBUG_STATUS_GO`) 并重复。本质上，这将是一个非常粗略的基于采样的分析器。

目前很好..

我的循环运行了一个完整的迭代，我可以看到正在显示堆栈跟踪，然后目标进程回到运行状态。

我遇到的问题是，在我的第二次迭代中，调用`WaitForEvent`返回`E_HANDLE`（“句柄无效”）。我在文档中看不到为什么应该返回这个错误。有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-20T23:44:51.800

问题原来是我正在针对旧版本的 SDK 进行编译、链接和运行。现在我已经将我的 SDK 升级到了最新版本（我认为是在线文档所引用的版本），我得到的行为至少与文档一致。

我仍然有问题，但不再是这个问题。

# javascript - Javascript / Flex 通信用例 [需要建议]

> ID：347765
> 
> 赞同：0
> 
> 时间：2008-12-07T16:43:33.923
> 
> 标签：javascript, jquery, ajax, apache-flex

我有一个带有 flex 组件的网页，该 flex 组件负责从用户输入创建图像。

图像准备好后，用户在 HTML 表单中输入更多信息，然后单击发送表单按钮。

单击此按钮时，javascript 会调用 flex 组件上的函数，该函数将图像数据作为 base64 编码字符串返回。

然后用 Jquery 我做一个 ajax POST 到 django 视图。图像数据在 ajax POST 的“数据”选项中编码为字符串。

一旦 django 视图回复，我要么使用 Javascript 调用重定向，要么突出显示任何可能的错误。

**这是我想要实现的最佳方式吗？** （一次将表单数据+图像发送到服务器）

*   某些形式在处理文件时具有多重编码部分，我应该尝试使用它吗？用阿贾克斯？如何 ？

谢谢，

格雷格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T20:42:12.583

作为替代方案，您可以让 Flex 将 base64 图像数据直接提交到服务器并处理结果。您可以使用 URLRequest 类轻松完成此操作。您可能想对此进行测试，看看它是否会影响客户端的性能；我的猜测是，通过 ExternalInterface 将这么多数据推送到 Javascript 可能会导致浏览器挂起一段时间。

最终，虽然听起来这个 Flex 应用程序只是整个页面中的一个小组件，所以保持 Flex 组件的职责尽可能小并通过 AJAX 来完成它可能是有意义的，就像你大概处理你的其余请求一样应用程序。

# asp.net-mvc - ASP.NET MVC URL 路由

> ID：347777
> 
> 赞同：2
> 
> 时间：2008-12-07T16:59:35.217
> 
> 标签：asp.net-mvc, rest, url-routing

我需要一个单独的控制器来处理以下内容吗？

[http://localhost/bookmarks](http://localhost/bookmarks) --> 书签控制器 [http://localhost/bookmark/](http://localhost/bookmark/) {bookmarkid} --> 书签控制器

有什么办法可以将它们组合成一个控制器吗？我想保持 uri 的相同，即书签单数表示获取单个书签。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T17:14:53.970

假设一个 C# 开发环境

全球.asax：

```
routes.MapRoute(
  "Bookmarks",
  "bookmarks",
  new { controller = "Bookmarks", action = "Bookmarks"}
);

routes.MapRoute(
  "Bookmark",
  "bookmark/{bookmarkid}",
  new { controller = "Bookmarks", action = "Bookmark" }
); 
```

书签控制器：

```
public ActionResult Bookmarks()
{
   //Get all bookmarks, I presume. :)
   return View();
}

public ActionResult Bookmark(string bookmarkid)
{
   //Do stuff with the bookmark id
   return View();
} 
```

使用此路由方案，[http://localhost/bookmarks](http://localhost/bookmarks)将点击 Bookmarks 控制器中的 Bookmarks 操作，而[http://localhost/bookmark/123456](http://localhost/bookmark/123456)将点击 Bookmarks 控制器中的 Bookmark 操作。

# javascript - 使用 jQuery 更改元素的 ID

> ID：347798
> 
> 赞同：333
> 
> 时间：2008-12-07T17:26:26.957
> 
> 标签：javascript, jquery

我需要使用 jQuery 更改元素的 ID。

显然这些不起作用：

```
jQuery(this).prev("li").attr("id")="newid"
jQuery(this).prev("li")="newid" 
```

我发现我可以使用以下代码实现它：

```
jQuery(this).prev("li")show(function() {
    this.id="newid";
}); 
```

但这对我来说似乎不对。一定有更好的方法，不是吗？另外，如果没有，我可以使用什么其他方法来代替显示/隐藏或其他效果？显然我不想每次都显示/隐藏或影响元素，只是为了更改它的 ID。

（是的，我是 jQuery 新手。）

**编辑**
在这种情况下我不能使用类，我必须使用 ID。

* * *

## 回答 #1

> 赞同：568
> 
> 时间：2008-12-07T17:39:25.650

您的语法不正确，您应该将值作为第二个参数传递：

```
jQuery(this).prev("li").attr("id","newId"); 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2014-08-25T20:28:27.053

A PREFERRED OPTION over`.attr`是这样使用`.prop`：

```
$(this).prev('li').prop('id', 'newId'); 
```

`.attr`检索元素的属性，同时`.prop`检索属性引用的属性（即您*实际*打算修改的属性）

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2008-12-07T17:40:17.850

你的意思是：

```
jQuery(this).prev("li").attr("id", "newID"); 
```

这会将 ID 设置为新 ID

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-25T19:46:27.153

我对这个结构做了类似的事情

```
$('li').each(function(){
  if(this.id){
    this.id = this.id+"something";
  }
}); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-05-26T14:35:02.157

```
$("#LeNomDeMaBaliseID").prop('id', 'LeNouveauNomDeMaBaliseID'); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-07T17:31:42.907

我不确定您的目标是什么，但使用 addClass 会更好吗？我的意思是，我认为对象 ID 应该是静态的并且特定于该对象。如果您只是想改变它在页面上的显示或类似的东西，我会将这些细节放在一个类中，然后将其添加到对象中，而不是尝试更改它的 ID。再一次，我说的是没有理解你的下划线目标。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-09-23T16:59:38.913

```
<script>
       $(document).ready(function () {
           $('select').attr("id", "newId"); //direct descendant of a
       });
</script> 
```

这可以用于所有目的。只需在您的正文结束标记之前添加，不要添加**Jquery.min.js**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-08T20:27:42.383

Eran 的回答很好，但我会补充。你需要观察任何不是内联到对象的交互性（也就是说，如果一个 onclick 事件调用一个函数，它仍然会），但是如果有一些 javascript 或 jQuery 事件处理附加到该 ID，它基本上会被放弃：

```
$("#myId").on("click", function() {}); 
```

如果现在将 ID 更改为 #myID123，根据我的经验，上面附加的功能将不再正常运行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-22T19:34:08.100

$('#id-you-want-to-change').attr('id', 'id-you-want-it-to-be');

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-12T09:20:00.507

我用了这个方法

```
 $('#Create').attr('id','Edit'); 
```

# html - 从 HTML 自动传输文件

> ID：347804
> 
> 赞同：0
> 
> 时间：2008-12-07T17:33:58.330
> 
> 标签：html, linux, scripting, file-transfer

我正在构建一个 Web 应用程序来指导我的用户完成应用程序的配置和安装。它动态构建一组配置文件，然后将它们与应用程序的安装程序一起发送到存档（.ZIP 文件）中。该网页是从 linux shell 脚本生成的（对不起），出于安全原因，我更喜欢直接从脚本发送文件，而不是作为链接，因此用户无法直接访问它。

过程如下：一旦用户输入了一些信息并生成了文件，我想显示一个带有说明的页面，然后自动开始下载，而不要求用户单击“下载此文件”链接：

```
#!/bin/bash
echo_header_and_instructions         # Standard HTML
<Magic HTML tag to start transfer>   # ??? What goes here???
command_to_stream_the_files          # Probably 'cat'
echo_end_tags                        # End the page. 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T17:46:14.827

我认为你真的不能那样做。
您可以通过以下标头强制文件下载，但据我所知，您不能混合使用 HTML 和文件下载。

标题：

```
内容类型：MIME/类型
内容处置：附件；文件名=“存档.zip”
内容长度：filesize_in_bytes

```

内容长度不是强制性的，但使用它将确保下载对话框可以显示还有多少文件要下载。

您可以做的一件事是使用 javascript 重新加载页面。因为该页面是文件下载，所以原始 HTML 页面将保留在原处：

```
<html>
<头部>
<title>这是包含信息的页面</title>
<script type="text/javascript">
window.onload = 函数（）{
 document.location = 'somefile.zip';
}
</脚本>
</head>
<正文>
下载文件时，此页面将保持可见<br>
</正文>
</html>

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T18:53:44.877

[我认为您可以通过使用元标记](http://en.wikipedia.org/wiki/Meta_refresh)进行刷新来使浏览器提示用户下载文件，但正如 Pim Jager 所说，我认为您不能通过一次传输来完成。您也许可以尝试执行以下操作：

```
<meta http-equiv="refresh" content="5;url=http://example.com/pathtodownload.zip" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T18:54:25.937

一位朋友提供了魔法：使用`<iframe>`标签创建一个“不可见”的框架，其中只包含要下载的文件：

```
<iframe id="file_download" width="0" height="0" scrolling="no" 
   frameborder="0" src=/cgi-bin/my/scripts/sendfiles?file=$filename.zip>
   You need a browser that supports frames.
</iframe>` 
```

# python - Python 中的 AKS Primes 算法

> ID：347811
> 
> 赞同：38
> 
> 时间：2008-12-07T17:41:10.407
> 
> 标签：python, algorithm, primes

几年前，证明[PRIMES 在P 中](http://www.cse.iitk.ac.in/~manindra/algebra/primality_v6.pdf)。是否有任何算法在 Python 中实现[其素性测试？](http://en.wikipedia.org/wiki/AKS_primality_test)我想用一个简单的生成器运行一些基准测试，并亲眼看看它有多快。我会自己实现它，但我对这篇论文的理解还不够。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-12-07T18:02:27.197

快速回答：不，AKS 测试不是测试素数的最快方法。有*很多*更快的素数检验，它们要么假设（广义）黎曼假设和/或随机化。（例如， [Miller-Rabin](http://en.wikipedia.org/wiki/Miller-Rabin_primality_test)实现起来快速且简单。）论文的真正突破是理论上的，证明存在用于测试素性的*确定性*多项式时间算法，而无需假设 GRH 或其他未经证实的猜想。

也就是说，如果您想理解和实施它，[Scott Aaronson 的短文](http://www.scottaaronson.com/writings/prime.pdf)可能会有所帮助。它没有详细介绍所有细节，但您可以从第 10 页（共 12 页）开始，它已经提供了足够的信息。:-) 这里还有一个[实现列表](http://fatphil.org/maths/AKS/#Implementations)（主要是 C++）。

此外，对于优化和改进（几个数量级），您可能需要查看[此报告](http://www.southerington.com/souther/projects/aks/RP-3_report.pdf)，或（较旧的）[Crandall 和 Papadopoulos 的报告](http://developer.apple.com/hardware/ve/pdf/aks3.pdf)，或（较旧的）[Daniel J Bernstein 的报告](http://cr.yp.to/papers/aks.pdf)。它们都有相当详细的伪代码，非常适合实现。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-07-29T22:10:04.630

我使用二项式展开简化，

```
from math import comb

def AKS(n):
    if (n ^ 1 == n + 1):        # check if it's even
        if n == 2:
            return True         
        return False
    for i in range(3,n//2):
        if comb(n,i)%n != 0:    # check if any coefficient isn't divisible by n
            return False
    return True 
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2015-04-23T21:04:51.520

是的，去rosettacode.org 上查看[AKS 测试素数](http://rosettacode.org/wiki/AKS_test_for_primes#Python)页面

```
def expand_x_1(p):
    ex = [1]
    for i in range(p):
        ex.append(ex[-1] * -(p-i) / (i+1))
    return ex[::-1]

def aks_test(p):
    if p < 2: return False
    ex = expand_x_1(p)
    ex[0] += 1
    return not any(mult % p for mult in ex[0:-1])
    print('# p: (x-1)^p for small p')
    for p in range(12):
        print('%3i: %s' % (p, ' '.join('%+i%s' % (e, ('x^%i' % n) if n else '')
                                   for n,e in enumerate(expand_x_1(p)))))

print('\n# small primes using the aks test')
print([p for p in range(101) if aks_test(p)]) 
```

输出是：

```
# p: (x-1)^p for small p
  0: +1
  1: -1 +1x^1
  2: +1 -2x^1 +1x^2
  3: -1 +3x^1 -3x^2 +1x^3
  4: +1 -4x^1 +6x^2 -4x^3 +1x^4
  5: -1 +5x^1 -10x^2 +10x^3 -5x^4 +1x^5
  6: +1 -6x^1 +15x^2 -20x^3 +15x^4 -6x^5 +1x^6
  7: -1 +7x^1 -21x^2 +35x^3 -35x^4 +21x^5 -7x^6 +1x^7
  8: +1 -8x^1 +28x^2 -56x^3 +70x^4 -56x^5 +28x^6 -8x^7 +1x^8
  9: -1 +9x^1 -36x^2 +84x^3 -126x^4 +126x^5 -84x^6 +36x^7 -9x^8 +1x^9
 10: +1 -10x^1 +45x^2 -120x^3 +210x^4 -252x^5 +210x^6 -120x^7 +45x^8 -10x^9 +1x^10
 11: -1 +11x^1 -55x^2 +165x^3 -330x^4 +462x^5 -462x^6 +330x^7 -165x^8 +55x^9 -11x^10 +1x^11

# small primes using the aks test
[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] 
```

# python - 如何测试 django 缓存？

> ID：347812
> 
> 赞同：17
> 
> 时间：2008-12-07T17:41:34.803
> 
> 标签：python, django, caching, django-cache

有没有办法**确保**页面来自生产服务器和开发服务器上的缓存？

该解决方案**不应**涉及缓存中间件，因为并非每个项目都使用它们。虽然解决方案本身可能**是**一个中间件。

仅检查数据是否过时并不是 IMO 一种非常安全的测试方法。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-08T02:33:16.777

我们做了很多组件缓存，但并非所有组件都同时更新。所以我们在一个普遍包含的上下文处理器中设置主机和时间戳值。在每个模板片段的顶部，我们坚持：

```
<!-- component_name {{host}} {{timestamp}} --> 
```

component_name 只是使查看源代码和搜索该字符串变得容易。

我们所有的对象详细页面视图都定义了一个上下文变量“page_object”，我们在 base.html 模板主文件的顶部有这个：

```
<!-- {{page_object.class_id}} @ {{timestamp}} --> 
```

class_id() 是我们所有主要内容类都使用的超类的方法。它只是：

```
def class_id(self):
    "%s.%s.%s" % (self.__class__._meta.app_label,
                    self.__class__.__name__, self.id) 
```

如果您加载一个页面并且任何时间戳都超过几秒，那么很有可能该组件已被缓存。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-04-06T08:32:14.690

Peter Rowells 的建议效果很好，但您不需要用于时间戳的自定义模板上下文处理器。您可以简单地使用模板标签：

```
 <!-- {% now "jS F Y H:i" %} --> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-07T21:06:49.150

模拟视图，点击页面，看看是否调用了模拟。如果不是，则使用缓存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-07T22:12:02.183

使用缓存的原因是为了提高性能。通过对您的服务器运行负载测试来测试性能。如果服务器的性能符合您的需求，那么一切就绪！

# c# - 使用 Moq 确定是否调用了方法

> ID：347818
> 
> 赞同：162
> 
> 时间：2008-12-07T17:47:09.427
> 
> 标签：c#, .net, unit-testing, mocking, moq

据我了解，如果我调用更高级别的方法，我可以测试是否会发生方法调用，即：

```
public abstract class SomeClass()
{    
    public void SomeMehod()
    {
        SomeOtherMethod();
    }

    internal abstract void SomeOtherMethod();
} 
```

我想测试一下，如果我打电话，`SomeMethod()`那么我希望`SomeOtherMethod()`会被调用。

我认为这种测试在模拟框架中可用吗？

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2008-12-07T18:49:13.060

您可以通过使用验证来查看您已模拟的某个方法是否已被调用，例如：

```
static void Main(string[] args)
{
        Mock<ITest> mock = new Mock<ITest>();

        ClassBeingTested testedClass = new ClassBeingTested();
        testedClass.WorkMethod(mock.Object);

        mock.Verify(m => m.MethodToCheckIfCalled());
}

class ClassBeingTested
{
    public void WorkMethod(ITest test)
    {
        //test.MethodToCheckIfCalled();
    }
}

public interface ITest
{
    void MethodToCheckIfCalled();
} 
```

如果该行被留下注释，它会在你调用验证时抛出一个 MockException。如果未注释，它将通过。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-02-23T22:35:56.737

不，模拟测试假定您正在使用某些可测试的设计模式，其中之一是注入。在您的情况下，您将进行测试`SomeClass.SomeMethod` ，并且`SomeOtherMethod`必须在另一个需要接口的实体中实现。

您的`Someclass`构造函数看起来像`New(ISomeOtherClass)`. 然后，您将模拟并对其调用`ISomeOtherClass`设置期望并验证期望。`SomeOtherMethod`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-17T07:26:06.117

尽管我同意[@Paul 的回答](https://stackoverflow.com/a/347907/3311799)是推荐的方式，但我只想添加一种由`moq`自我提供的替代方式。

因为`SomeClass`它`abstract`确实是可模拟的，但`public void SomeMehod()`不是。关键是找到模拟并以某种方式调用该方法的方法，然后使用`CallBase`将调用传播到`SomeOtherMethod()`. 这听起来像是一种 hack，但本质上很简单。如果建议的重构是不可能的，它可以用于这种情况。

```
// This class is used only for test and purpose is make SomeMethod mockable
public abstract class DummyClass : SomeClass
{
    public virtual void DummyMethod() => base.SomeMethod();
} 
```

然后您可以通过设置标志来设置`DummyMethod()`传播呼叫。`CallBase`

```
//Arrange
var mock = new Mock<DummyClass>();
mock.Setup(m => m.DummyMethod()).CallBase();

//Act
mock.Object.SomeMethod();

//Assert
mock.Verify(m => m.SomeOtherMethod(), Times.Once); 
```

# mysql - 大 MySQL 表

> ID：347837
> 
> 赞同：3
> 
> 时间：2008-12-07T17:58:41.323
> 
> 标签：mysql, caching

我正在解决一个需要缓存分页“搜索”结果的问题： [Paginating very large datasets](https://stackoverflow.com/questions/347277/paginating-very-large-datasets)

搜索工作如下：给定 item_id，我找到匹配的 item_ids 及其排名。

我愿意承认不向我的用户显示任何过去的结果，比如 500。在 500 之后，我会假设他们不会找到他们正在寻找的东西......结果按顺序排序无论如何匹配。所以我想缓存这 500 个结果，所以我只需要做一次繁重的查询，用户仍然可以对结果进行分页（最多 500 个）。

现在，假设我使用一个中间 MySQL 表作为我的缓存......也就是说，我将每个项目的前 500 个结果存储在一个“匹配”表中，如下所示：“item_id (INTEGER)、matched_item_id (INTEGER)、match_rank (真实的）”。现在搜索变得非常快：

```
SELECT item.* FROM item, matches 
    WHERE matches.item_id=<item in question>
    AND item.id=matches.matched_item_id 
    ORDER BY match_rank DESC
    LIMIT x,y 
```

如果结果早于 24 小时，我将没有问题将项目及其匹配项重新索引到此表中，因为客户要求它们。问题是，为 N 个项目存储 500 个结果（其中 N 约为 100,000 到 1,000,000），此表变得相当大...... 50,000,000 - 500,000,000 行。

MySQL可以处理这个吗？我应该注意什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T18:05:18.593

MySQL 可以处理这么多行，当你开始碰壁时，有几种技术可以扩展。[分区](http://dev.mysql.com/doc/refman/5.1/en/partitioning.html)和[复制](http://dev.mysql.com/doc/refman/5.1/en/replication.html)是此场景的主要解决方案。

[您还可以在我之前](https://stackoverflow.com/questions/189903/scaling-solutions-for-mysql-replication-clustering)在 stackoverflow上提出的问题中检查 MySQL 的其他扩展技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T18:15:02.350

同意楼上。要非常小心，避免在此处通过非规范化进行过早优化。

不要使用“SELECT *”。更多字段意味着更多磁盘读取。

确保您使用的是覆盖索引 - 即您可以从索引中获取所有请求的字段值，而无需转到数据表。仔细检查您是否正在读取记录数据。

测试，测试测试。

如果可能，使用只写表（即没有更新和删除），这样 mysql 就不会重用已删除的空间和重新填充索引。

确保索引字段尽可能短（但不能更短。）

编辑：我想到了更多的事情......

标准（也是最快的）MyISAM 表类型除了插入顺序（通过填充已删除的行进行修改）之外没有任何方法来维护任何顺序的记录 - 即没有聚集索引。但是，如果您基于对在同一页面中对关联记录进行分组很有用的索引定期复制/重建表，则可以伪造它。当然新记录不会符合要求，但 98% 的表效率优于默认值。

熟悉配置设置，尤其是缓存大小。事实上，为了简单起见，不要担心缓存大小以外的任何其他设置（并了解它们各自的含义）。

熟悉统计日志中的信息，因为它适用于配置缓存设置的有效性。

一直运行“慢查询日志”。它的开销很低，并且是所有补救措施的第一站。

这是不言而喻的，但不要在同一台服务器上运行除了数据库之外的任何东西。一个重要原因是能够仅为数据库优化资源。

在事情即将崩溃之前不要进行非规范化。

* * *

不可谈判的。

这条线以上的一切都是有问题的建议。永远不要在没有理解和测试的情况下接受任何建议。每个设计决策都有两个方面；并且 MySQL 在线建议在没有资格的情况下进行概括并且没有扩大收益和惩罚方面的平均水平低于平均水平。也质疑我在这里注意到的一切。了解您在做什么，为什么要这样做，以及您期望获得什么优势。衡量变化以查看预期是否发生。

永远，永远不要“尝试一些事情，看看会发生什么”。这样做就像调整具有多个化油器的汽车，但更糟。如果您的预期没有发生，请退出更改并找出答案，或者进行您确实了解的其他事情。睡眠是你的朋友；经过艰苦的测试，其中大部分将在一夜之间出现。

你永远不会明白这一切；你总是需要学习比你知道的更多的东西。总是问“为什么”和“你的证据是什么”。（通常有人读到的内容不适用于您的情况。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T18:10:02.343

MySQL可以处理它。真正的问题是：它能在合理的时间内处理它吗？这取决于您的查询。就像 Eran Galperin 在他的回答中所说，研究分区和复制以进行优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T18:24:15.157

正如其他人所说，MySQL 可以轻松扩展以适应非常大的数据集，并且通常它会处理大型数据集（几百万行）而无需开发人员/dba 的太多干预，除了一点点合理的索引和查询优化。[@doofledorer](https://stackoverflow.com/questions/347837/big-mysql-tables#347849)在避免过早优化方面是正确的。正如 37 Signals 的人所说，如果您的应用程序在跑道上取得了成功，并且您遇到了数据库问题 - 那么这是一个很好的地方。

然而，我会用我自己的一个来反驳这个问题——你真的需要使用 MySQL 作为你的缓存系统吗？有很多地方可以保存 500 个整数的列表，我的第一选择是会话中的服务器端。即使会话数据被写入磁盘，加载 500 个整数的数组也不会那么慢 - 并且有很多策略可以使用内存缓存（例如 MemCache）来进一步加快速度。

循环遍历您的会话存储数组并执行 10、20（或每页多个），沿着“select item.* where id = X”行的单个查询可能听起来很可怕 - 当然它会增加查询的物理数量，但是它会很快变亮，尤其是在加入了一些 MySQL 查询缓存的情况下。

编辑：Sam 的评论强调了我忘记的东西：如果您使用基于会话的方法，您将立即从会话基于状态的事实中受益。您不必担心清除过期数据 - 当会话结束时，噗，它就消失了。而且，如果您坚持使用基于磁盘的会话（我在这里假设 PHP 作为服务器端语言），那么请记住磁盘空间非常便宜。

归根结底，它成为易用性（在开发/维护方面）、可扩展性和性能之间的权衡。我只想说你应该记住，仅仅因为你正在处理数据库查询的结果，这并不意味着数据库是在所有情况下存储这些结果的最佳方法 - 保持开放的心态！

# flash - getUrl 不打开窗口 AS2

> ID：347847
> 
> 赞同：0
> 
> 时间：2008-12-07T18:12:05.133
> 
> 标签：flash, url, actionscript, actionscript-2

如何在不打开新窗口的情况下从 ActionScript 2 调用 URL？我试过“getUrl”和“LoadVars”的各种方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T19:11:21.817

```
var loader = new LoadVars();
loader.load("http://example.com/yourscript"); 
```

# php - 这个 MySQL 查询是最好的主意吗？

> ID：347851
> 
> 赞同：1
> 
> 时间：2008-12-07T18:15:48.417
> 
> 标签：php, mysql, optimization

我正在处理的项目有两种类型的帐户，“ `people`”和“ `companies`”。

我持有一个“ `users`”表，其中包含所有帐户和登录所需的基本信息（电子邮件、通行证等），以及另外两个表“ `user_profiles`”（普通人）和“ `company_profiles`”（公司），每个表都包含更具体的列类型，两个表都`users`通过“ `profile_user_id`”列链接到通用“ ”表。

但是，每当我想列出既可以是个人又可以是公司的用户时，我都会使用：

“ `select user_id, user_type, concat_ws('', concat_ws(' ', user_profiles.profile_first_name, user_profiles.profile_last_name), company_profiles.profile_company_name) as user_fullname`”。

当我列出这些用户时，我通过“”知道他们是个人还是公司`user_type`。

我的方法是否使用`concat_ws`了正确的（最佳）方法？我这样做而不是`select`-ing every`*_name`以避免返回不必要的列。

谢谢

编辑：上面的查询继续如下：`from users left join user_profiles on ... left join company_profiles on ...`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T18:22:33.257

```
select
 u.user_id, u.user_type, concat_ws(profile_first_name + profile_last_name) as full_name
from 
 users u, user_profiles up
where u.key = up.key
 and u.user_type = 'user'

union

select
 u.user_id, u.user_type, concat_ws(profile_first_name + profile_last_name) as full_name
from 
 users u, company_profiles cp
where u.key = cp.key
 and u.user_type = 'company' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T18:30:10.090

您已有的查询是否有效？您是否已经在使用这种方法时遇到了性能问题？

除非使用上述查询花费的时间比您预期的要长，或者导致调用此信息的软件出现问题，否则这可能是未成熟的优化。

不过需要注意的一点是，您第一次使用 CONCAT_WS 时没有分隔符，因此公司名称将与人名合并。

# php - Zend_Form：如何检查 2 个字段是否相同

> ID：347856
> 
> 赞同：7
> 
> 时间：2008-12-07T18:18:30.487
> 
> 标签：php, validation, zend-framework, zend-form

我创建了一个表单来将用户添加到数据库并使用户可用于登录。

现在我有两个密码字段（第二个用于验证第一个）。如何将这种验证的验证器添加到 zend_form？

这是我的两个密码字段的代码：

```
 $password = new Zend_Form_Element_Password('password', array(
        'validators'=> array(
            'Alnum',
            array('StringLength', array(6,20))
            ),
        'filters'   => array('StringTrim'),
        'label'     => 'Wachtwoord:'
        ));

    $password->addFilter(new Ivo_Filters_Sha1Filter());

    $password2 = new Zend_Form_Element_Password('password', array(
        'validators'=> array(
            'Alnum',
            array('StringLength', array(6,20))
            ),
        'filters'   => array('StringTrim'),
        'required'  => true,
        'label'     => 'Wachtwoord:'
        ));
    $password2->addFilter(new Ivo_Filters_Sha1Filter()); 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2010-09-23T20:41:03.200

当前版本的 Zend_Validate 内置了这个 - 虽然还有很多其他答案，但似乎都需要将值传递给`Zend_Validate_Identical`. 虽然有时可能需要这样做，但您现在可以传递另一个元素的名称。

从[`Zend_Validate`参考指南的部分](http://framework.zend.com/manual/en/zend.validate.set.html#zend.validate.set.identical)：

> Zend_Validate_Identical 也支持表单元素的比较。这可以通过使用元素的名称作为标记来完成。请参见以下示例：

```
$form->addElement('password', 'elementOne');
$form->addElement('password', 'elementTwo', array(
    'validators' => array(
        array('identical', false, array('token' => 'elementOne'))
    )
)); 
```

> 通过使用第一个元素中的元素名称作为第二个元素的标记，验证器验证第二个元素是否与第一个元素相等。如果您的用户没有输入两个相同的值，您将收到验证错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T06:37:33.223

当我在寻找相同的东西时，我发现这个工作良好的通用 Validator for Identical Fields。我现在找不到它，所以我只是发布代码......

```
<?php

class Zend_Validate_IdenticalField extends Zend_Validate_Abstract {
  const NOT_MATCH = 'notMatch';
  const MISSING_FIELD_NAME = 'missingFieldName';
  const INVALID_FIELD_NAME = 'invalidFieldName';

  /**
   * @var array
  */
  protected $_messageTemplates = array(
    self::MISSING_FIELD_NAME  =>
      'DEVELOPMENT ERROR: Field name to match against was not provided.',
    self::INVALID_FIELD_NAME  =>
      'DEVELOPMENT ERROR: The field "%fieldName%" was not provided to match against.',
    self::NOT_MATCH =>
      'Does not match %fieldTitle%.'
  );

  /**
   * @var array
  */
  protected $_messageVariables = array(
    'fieldName' => '_fieldName',
    'fieldTitle' => '_fieldTitle'
  );

  /**
   * Name of the field as it appear in the $context array.
   *
   * @var string
   */
  protected $_fieldName;

  /**
   * Title of the field to display in an error message.
   *
   * If evaluates to false then will be set to $this->_fieldName.
   *
   * @var string
  */
  protected $_fieldTitle;

  /**
   * Sets validator options
   *
   * @param  string $fieldName
   * @param  string $fieldTitle
   * @return void
  */
  public function __construct($fieldName, $fieldTitle = null) {
    $this->setFieldName($fieldName);
    $this->setFieldTitle($fieldTitle);
  }

  /**
   * Returns the field name.
   *
   * @return string
  */
  public function getFieldName() {
    return $this->_fieldName;
  }

  /**
   * Sets the field name.
   *
   * @param  string $fieldName
   * @return Zend_Validate_IdenticalField Provides a fluent interface
  */
  public function setFieldName($fieldName) {
    $this->_fieldName = $fieldName;
    return $this;
  }

  /**
   * Returns the field title.
   *
   * @return integer
  */
  public function getFieldTitle() {
    return $this->_fieldTitle;
  }

  /**
   * Sets the field title.
   *
   * @param  string:null $fieldTitle
   * @return Zend_Validate_IdenticalField Provides a fluent interface
  */
  public function setFieldTitle($fieldTitle = null) {
    $this->_fieldTitle = $fieldTitle ? $fieldTitle : $this->_fieldName;
    return $this;
  }

  /**
   * Defined by Zend_Validate_Interface
   *
   * Returns true if and only if a field name has been set, the field name is available in the
   * context, and the value of that field name matches the provided value.
   *
   * @param  string $value
   *
   * @return boolean 
  */ 
  public function isValid($value, $context = null) {
    $this->_setValue($value);
    $field = $this->getFieldName();

    if (empty($field)) {
      $this->_error(self::MISSING_FIELD_NAME);
      return false;
    } elseif (!isset($context[$field])) {
      $this->_error(self::INVALID_FIELD_NAME);
      return false;
    } elseif (is_array($context)) {
      if ($value == $context[$field]) {
        return true;
      }
    } elseif (is_string($context) && ($value == $context)) {
      return true;
    }
    $this->_error(self::NOT_MATCH);
    return false;
  }
}
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T06:09:09.833

这是我如何做到的:)

创建第一遍输入，然后创建第二遍输入，并使用来自先前密码输入的数据添加相同的验证器。

```
$password_2->addValidator('identical', false, $this->_request->getPost('password')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-14T20:55:25.903

您可以从验证器访问所有表单字段，也可以使用构造函数传递其他参数

```
class Example_Validator extends Zend_Validate_Abstract{

const NOT_IDENTICALL = 'not same';

private $testValue;    

public function __construct( $arg ) {
      $this->testValue = $arg;    
   }

protected $_messageTemplates = array(
    self::NOT_IDENTICALL => "Passwords aren't same"
);    

public function isValid( $value, $context = null )
{
    echo  $context['password']; 
    echo '<br>';
    echo $this->testValue;

    return true;
}
} 
```

调用这个验证器

```
$form = new Zend_Form();
$form->setAction('success');
$form->setMethod('post');   
$form->addElement('text', 'username');
$usernameElement = $form->getElement('username');
$form->addElement('password', 'password');
$passwordElement = $form->getElement('password');
$myValidator2 = new Example_Validator("Hello !");   
$passwordElement->addValidator($myValidator2, true);    
$form->addElement('submit', 'submit');  
$submitButton = $form->getElement('submit'); 
```

# .net - 我在哪里可以下载最新的 ngen.exe？

> ID：347857
> 
> 赞同：9
> 
> 时间：2008-12-07T18:20:13.027
> 
> 标签：.net, ngen

我正在使用 ngen.exe（.Net Native Image Generator）版本 2.0.50727.312。这是最新版本吗？如果没有，我在哪里可以下载最新版本？msdn 上的此[**页面**](http://msdn.microsoft.com/en-us/library/6t9t5wcf.aspx)似乎没有下载链接。如果重要的话，我需要用于 .Net Framework 3.5 的 ngen.exe。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-07T18:26:00.410

.NET 运行时本身已经升级，相当于 3.5 版本中的“服务包”。如果您在该机器上安装了 .NET 3.5，则您正在运行最新版本的 NGEN，即使版本号是 2.0.50727。查看这篇文章了解更多详情：

[http://www.danielmoth.com/Blog/2007/06/net-framework-35.html](http://www.danielmoth.com/Blog/2007/06/net-framework-35.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-22T21:39:55.180

ngen.exe 存放在框架安装路径中

C:\Windows\Microsoft.NET\Framework\v2.0.50727 或 C:\Windows\Microsoft.NET\Framework\v1.1.4322

[http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx)

# c# - 如何检测笔记本电脑电源线何时断开？

> ID：347862
> 
> 赞同：14
> 
> 时间：2008-12-07T18:24:59.723
> 
> 标签：c#, .net

无数次我的笔记本电脑在我的游戏中途关闭，因为我的电源线在我没有注意到的情况下断开了。

现在我想编写一个小 C# 程序来检测我的电源线何时断开，然后发出一声长长的系统哔声。我可以为此使用什么 API？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-07T18:44:19.327

这应该很容易使用[SystemInformation.PowerStatus](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.powerstatus.aspx)属性来实现。即使它存在于 Windows.Forms 中，它也应该完全可以从系统服务中使用。

有关也适用于 Compact Framework 的解决方案，请参阅[HOWTO：获取设备电源状态](http://msdn.microsoft.com/en-us/library/aa457088.aspx)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-07T18:47:01.117

[SystemEvents.PowerModeChanged](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.powermodechanged.aspx)。您将需要在处理程序中使用 GetSystemPowerStatus （请参阅其中一个答案中的链接）或 SystemInformation.PowerStatus （链接在另一个答案中）来检查发生了什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T18:28:48.767

这可能会因为与编程无关而关闭，但您可能需要检查 BIOS 设置。

我的联想笔记本电脑完全按照您的建议进行。我的 BIOS 中有一个设置，用于在电源状态更改时发出哔哔声。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-07T20:11:04.440

为了继续 BQ 的回答，Windows 中有一些电源设置可以在拔下电源线时更改。因为我有时会移除它，所以我没有更改机器上的电源设置，但是当电池接近 15% 时，屏幕亮度设置为最低水平，从而可以工作（并且可以使用 Fn-Home 键轻松更改）但非常明显，因此我及时将电缆插回去。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-28T06:48:12.690

这里有一个小解决方案：使用 C# windows 窗体应用程序，

```
PowerStatus powerStatus = SystemInformation.PowerStatus;

if (powerStatus.PowerLineStatus == PowerLineStatus.Online)
{
    MessageBox.Show("Running On Power", Convert.ToString(powerStatus.BatteryLifePercent * 100) + "%");
}
else
{
    MessageBox.Show("Running On Battery", Convert.ToString(powerStatus.BatteryLifePercent * 100) + "%");
} 
```

希望，你明白了，现在你可以以任何方式使用它............

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T18:29:22.290

这可能在很大程度上取决于您的确切操作系统。以下是 Windows XP 的一些调用，我相信您可以找到 Vista 的等价物：

[http://msdn.microsoft.com/en-us/library/ms704147(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms704147(VS.85).aspx "MSDN 链接")

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T18:38:35.097

想不出任何可以通过 .NET 框架直接访问的东西，但我知道英特尔拥有带有 .NET 库的移动平台 SDK，应该为您提供这些信息。AMD 可能在某个地方有一个对等的。

[英特尔移动平台 SDK](http://software.intel.com/en-us/articles/making-applications-aware-of-their-mobile-contexts-using-the-intel-mobile-platform-sdk)

# database - D2009 无法编译的 VCL 单元

> ID：347871
> 
> 赞同：0
> 
> 时间：2008-12-07T18:28:05.193
> 
> 标签：database, delphi, compiler-construction, delphi-2009

我在 Delphi 2009 的 TFields 实现中发现了一个错误，并编写了一个快速补丁。我将 DB.pas 复制到我的项目文件夹并将其添加到项目的文件列表中，但现在我无法编译它。当我转到代码中指定的位置时，前两个错误消息甚至没有任何意义。

当然，如果可以指望任何东西都能正确编译，那就是 CodeGear 的代码。他们已经设法编译它，生成 VCL 组件。那么我错过了什么？这是编译器的输出：

```
[DCC Error] DB.pas(2536): E2134 Type 'Pointer' has no type info
[DCC Error] DB.pas(10799): E2066 Missing operator or semicolon
[DCC Error] DB.pas(12933): E2217 Published field 'FCursor' not a class or interface type
[DCC Error] DB.pas(12934): E2217 Published field 'FTitle' not a class or interface type
[DCC Fatal Error] testing.dpr(23): F2063 Could not compile used unit '..\..\..\vclpatch\DB.pas' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-07T22:50:51.810

如果您在 DB.pas 单元的顶部添加以下行是否有帮助。

{$A8,B-,C+,D+,E-,F-,G+,H+,I+,J-,K-,L+,M-,N-,O+,P+,Q-,R-,S-, T-,U-,V+,W-,X+,Y+,Z1}

如果使用此行后它可以工作，那么您的项目选项与 CodeGear 用于编译 RTL/VCL 的设置不兼容。

顺便说一句：第 2536 行是仅包含文本“类型”的行。你改过文件吗？还是您缺少更新 1？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T12:45:51.977

我在使用 DB.pas 时遇到了同样的问题，但从未修改任何 VCL 单元。所以原因显然必须是我的项目。**将Emit 运行时类型信息**切换为**false**可以解决问题。

（项目选项：Delphi Compiler -> Compiling -> Code generation -> Emit runtime type information）

# cookies - 使用 cookie 而不将它们发送回服务器

> ID：347877
> 
> 赞同：5
> 
> 时间：2008-12-07T18:31:40.897
> 
> 标签：cookies, browser

我需要一种方法来存储一些对浏览器来说是全局的数据。如果我从我的应用程序中打开一个带有 URL 的新窗口，例如通过书签，我需要访问一些在另一个窗口中创建并且从未发送到服务器的数据。

据我所知，唯一对浏览器是全局的而不仅仅是一个窗口（如 window.name）是一个 cookie。我遇到的问题是，如果我设置了一个 cookie，那么 cookie 会随每个请求一起发送到服务器，但我不希望这些数据在线上。有什么方法可以设置一个cookie，只是将它纯粹用作存储一些数据的存储桶，而不是将该数据发送到服务器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T18:39:26.577

HTML 5 存储 API 看起来正是您想要的，但不幸的是，目前只有少数浏览器支持它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T18:45:21.290

您能否强制您的用户安装[Google Gears？](http://code.google.com/apis/gears)它是一个 javascript API，可让您存储本地信息 - 还可以让您在会话之间持续存在，这可能对您的应用程序有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T19:54:21.603

> 有什么方法可以设置一个cookie，只是将它纯粹用作存储一些数据的存储桶，而不是将该数据发送到服务器？

不。

您需要研究一个提供专用离线存储设施的插件，或者使用 HTML5 存储 API 并告诉每个人升级他们的浏览器

如果您决定采用插件路线，据我所知，您有 3 个选项：

1.  谷歌齿轮
2.  Flash - 它有一个离线存储工具 - 你可以编写一个小型 Flash 应用程序来使用这个工具来存储东西，然后通过 javascript 与它进行互操作。
3.  Silverlight 还具有离线存储功能 - 与闪存一样，您可以编写一个小应用程序来进行存储，然后通过 javascript 与它进行互操作。

我可能会先考虑使用闪存，因为每个人都已经拥有它。

如果您使用 silverlight，开发可能会容易得多。它没有被广泛安装，但它正在迅速传播。上次我听说* 30% 的浏览器都安装了它，这令人印象深刻。

不幸的是，谷歌齿轮将遥遥领先。人们将出于其他原因安装闪光灯和银灯，但没有人有装备。

*这是一个完全未经证实的引用，但似乎与我在不同人的计算机等上看到的相符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T18:36:20.187

为什么不直接使用 window.opener 读取父窗口中的字段？或者，如果您正在运行三个窗口 - 父级和两个子级，我认为您可能在暗示，然后从子级读取/写入父级中的隐藏字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T19:31:06.377

听起来您的应用程序在本地运行 100%，如果是这种情况，浏览器无论如何都不是正确的选择。Cookie 可以轻松删除。如果您的应用程序不是本地的，则网络服务器应该是提供信息的一个。Cookie 从来都不是存储敏感信息或应该保留更长时间的信息的正确方式。

# assembly - 如何屏蔽 ARM 程序集中的字节？

> ID：347889
> 
> 赞同：8
> 
> 时间：2008-12-07T18:38:15.283
> 
> 标签：assembly, arm

我有一个 32 位（十六进制）字 0xaabbccdd 并且必须交换 2\. 和 3\. 字节。最后它应该看起来像 0xaaccbbdd

我如何“屏蔽”第二个和第三个字节以首先将它们加载到寄存器 r1 和 r2 并交换它们。我也知道我必须使用 lsl 和 lsr 命令，但不知道如何开始。

对不起我的英语不好。希望有人能帮助我！

问候，塞巴斯蒂安

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-07-08T20:24:42.937

过去，我们过去常常严重依赖 EOR 来进行这种诡计。

您可以在 4 个周期内完成。

首先，我们需要这样一个事实：A ^ (A^B) = B

我们从 0xAABBCCDD 开始，我们想要 0xAACCBBDD。要到达那里，我们需要 0x00EEEE00^0xAABBCCDD，其中 EE = BB^CC。

现在，我们需要几个周期来构建 00EEEE00：

```
eor     r1,r0,r0,lsr #8
and     r1,r1,#0xFF00
orr     r1,r1,r1,lsl #8
eor     r0,r0,r1 
```

在 c 中：

```
t=x^(x>>8);
t=t&0xFF00;
t=t|(t<<8);
x^=t; 
```

在每一行之后，计算的结果是：开头为：AABBCCDD

```
eor  XXXXEEXX
and  0000EE00
orr  00EEEE00
eor  AACCBBDD 
```

这适用于任何 32 位 ARM 内核。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-07T20:12:41.503

这不是 ARM 汇编中的一项简单任务，因为您不能轻易使用 32 位常量。您必须分解所有屏蔽字节的操作，以便每个使用 8 位常量（这些常量也可以旋转）。

您可以使用 AND 指令屏蔽 byte2 和 3，然后再进行移位。在 ARM 汇编器中，大多数指令都可以免费进行一次移位，因此移位到位置并与其他位合并通常最终成为一条指令。

这是一些未经测试的代码，可以进行中间字节交换（ARMv4，不是拇指指令集）：

```
 .text

swap_v4:
        AND     R2, R0, #0x00ff0000     @ R2=0x00BB0000 get byte 2
        AND     R3, R0, #0x0000ff00     @ R3=0x0000CC00 get byte 1
        BIC     R0, R0, #0x00ff0000     @ R0=0xAA00CCDD clear byte 2
        BIC     R0, R0, #0x0000ff00     @ R0=0xAA0000DD clear byte 1
        ORR     R0, R2, LSR #8          @ R0=0xAA00BBDD merge and shift byte 2
        ORR     R0, R3, LSL #8          @ R0=0xAACCBBDD merge and shift byte 1
        B       LR 
```

将逐行翻译成以下 c 代码：

```
int swap (int R0)
{
  int R2,R3;
  R2 = R0 & 0x00ff0000;
  R3 = R0 & 0x0000ff00;
  R0 = R0 & 0xff00ffff;
  R0 = R0 & 0xffff00ff;
  R0 |= (R2>>8);
  R0 |= (R3<<8);
  return R0;
} 
```

你会看到 - 这么简单的任务有很多行。甚至 ARMv6 架构在这里也没有多大帮助。

* * *

编辑：ARMv6 版本（也未经测试，但两条指令更短）

```
swap_v6:
        @ bits in R0: aabbccdd
        ROR     R0, R0, #8              @ r0 = ddaabbcc
        REV     R1, R0                  @ r1 = ccbbaadd
        PKHTB   R0, R0, R1              @ r0 = ddaaccbb
        ROR     R0, R0, #24             @ r0 = aaccbbdd
        BX      LR 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T04:26:11.673

嗯，不知道发生了什么，它在我真正开始之前提交了我的答案。

起初我不认为我可以只用两个寄存器来做到这一点，但后来我决定我可以并且做到了。这些解决方案只有寄存器，没有内存（除了 ldr r0,= 您可以用四个指令替换）。如果你使用 memory 和 hmmm，两个寄存器你可以减少指令的数量，str、bic、bic、ldrb、orr lsl、ldrb、orr lsl。好的，我用更少的一条指令完成了它，但是你需要内存位置以及存储和加载成本周期，所以相同数量的内存和更多周期让我用内存来完成它。其他人可能有一些好的技巧。我认为一些较新的内核有一个字节序交换指令，这将使它更容易。

```
.globl midswap
midswap:
    mov r2,r0,lsl #8      ;@ r2 = BBCCDDAA
    mov r3,r0,lsr #8      ;@ r3 = DDAABBCC (this might drag a sign bit, dont care)
    and r2,r2,#0x00FF0000 ;@ r2 = 00CC0000
    and r3,r3,#0x0000FF00 ;@ r3 = 0000BB00
    bic r0,r0,#0x00FF0000 ;@ r0 = AA00CCDD
    bic r0,r0,#0x0000FF00 ;@ r0 = AA0000DD
    orr r0,r0,r2          ;@ r0 = AACC00DD
    orr r0,r0,r3          ;@ r0 = AACCBBDD
    bx lr ;@ or mov pc,lr for older arm cores

.globl tworegs
tworegs:
    mov r2,r0,ror #8       ;@ r2 = DDAABBCC
    bic r2,r2,#0xFF000000  ;@ r2 = 00AABBCC
    bic r2,r2,#0x00FF0000  ;@ r2 = 0000BBCC
    orr r2,r2,ror #16      ;@ r2 = BBCCBBCC
    bic r2,r2,#0xFF000000  ;@ r2 = 00CCBBCC
    bic r2,r2,#0x000000FF  ;@ r2 = 00CCBB00
    bic r0,r0,#0x00FF0000  ;@ r0 = AA00CCDD
    bic r0,r0,#0x0000FF00  ;@ r0 = AA0000DD
    orr r0,r0,r2           ;@ r0 = AACCBBDD
    bx lr

testfun:
    ldr r0,=0xAABBCCDD
    bl midswap 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-30T06:24:12.187

你能用 BFI 和 UBFX 吗？它们会让你的工作更轻松

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T16:39:28.360

您只需使用指针来交换两个字节

```
static union {
 BYTE   BBuf[4];
 WORD   WWBuf[2];
 DWORD  DWBuf;
}swap;

unsigned char *a;
unsigned char *b;
swap.DWBuf = 0xaabbccdd;

a = &swap.BBuf[1];
b = &swap.BBuf[2];

*a ^= *b;
*b ^= *a;
*a ^= *b; 
```

现在的结果是

```
swap.DWbuf == 0xaaccbbdd; 
```

# asp.net - 使用 xsp 在 Mono 中 GDI 所需的库

> ID：347895
> 
> 赞同：0
> 
> 时间：2008-12-07T18:41:27.010
> 
> 标签：asp.net, mono, gdi+

这是情况。我正在mono xsp 下运行的asp 页面上创建一些图形（使用GDI+）。这在我的开发环境中非常有用，因为我的开发环境在 GUI 下运行，但是当我尝试在无 GUI 的服务器上运行它时，它会失败（我假设由于 Gnome 运行所需的某些库未安装）。需要哪些库以及如何安装它们才能在无 GUI 安装的 Mono 下运行 GDI 代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T05:59:07.903

我相信您想要的库的名称是 libgdiplus，但我不确定它是否依赖于 X11。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T02:26:09.453

mono 的 System.Drawing 实现建立在 cairo 图形库之上。[请参阅此处](http://www.mono-project.com/Drawing)的单声道文档。

# c# - 如何在 FtpWebRequest 之前检查 FTP 上是否存在文件

> ID：347897
> 
> 赞同：68
> 
> 时间：2008-12-07T18:44:12.713
> 
> 标签：c#, .net, ftp, ftpwebrequest

我需要使用`FtpWebRequest`将文件放在 FTP 目录中。在上传之前，我首先想知道这个文件是否存在。

我应该使用什么方法或属性来检查这个文件是否存在？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2008-12-07T23:40:38.887

```
var request = (FtpWebRequest)WebRequest.Create
    ("ftp://ftp.domain.com/doesntexist.txt");
request.Credentials = new NetworkCredential("user", "pass");
request.Method = WebRequestMethods.Ftp.GetFileSize;

try
{
    FtpWebResponse response = (FtpWebResponse)request.GetResponse();
}
catch (WebException ex)
{
    FtpWebResponse response = (FtpWebResponse)ex.Response;
    if (response.StatusCode ==
        FtpStatusCode.ActionNotTakenFileUnavailable)
    {
        //Does not exist
    }
} 
```

作为一般规则，在你的代码中使用异常是一个坏主意，但是在这种情况下，我相信这是实用主义的胜利。目录上的调用列表可能比以这种方式使用异常效率低得多。

如果你不是，请注意这不是一个好习惯！

编辑：“它对我有用！”

这似乎适用于大多数 ftp 服务器，但不是全部。有些服务器需要在 SIZE 命令起作用之前发送“TYPE I”。有人会认为问题应该解决如下：

```
request.UseBinary = true; 
```

不幸的是，这是一个设计限制（大胖错误！），除非 FtpWebRequest 正在下载或上传文件，否则它不会发送“TYPE I”。[请参阅此处](http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/0c38814e-d8e3-49f3-8818-b5306cc100ce/)的讨论和 Microsoft 回复。

我建议改用以下 WebRequestMethod，这适用于我测试的所有服务器，即使是那些不会返回文件大小的服务器。

```
WebRequestMethods.Ftp.GetDateTimestamp 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-09-16T15:39:41.903

因为

```
request.Method = WebRequestMethods.Ftp.GetFileSize 
```

在某些情况下可能会失败（550：ASCII 模式下不允许 SIZE），您可以只检查时间戳。

```
reqFTP.Credentials = new NetworkCredential(inf.LogOn, inf.Password);
reqFTP.UseBinary = true;
reqFTP.Method = WebRequestMethods.Ftp.GetDateTimestamp; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-04-27T06:52:36.190

`FtpWebRequest`（也不是 .NET 中的任何其他类）没有任何显式方法来检查 FTP 服务器上的文件是否存在。您需要滥用类似`GetFileSize`or的请求`GetDateTimestamp`。

```
string url = "ftp://ftp.example.com/remote/path/file.txt";

WebRequest request = WebRequest.Create(url);
request.Credentials = new NetworkCredential("username", "password");
request.Method = WebRequestMethods.Ftp.GetFileSize;
try
{
    request.GetResponse();
    Console.WriteLine("Exists");
}
catch (WebException e)
{
    FtpWebResponse response = (FtpWebResponse)e.Response;
    if (response.StatusCode == FtpStatusCode.ActionNotTakenFileUnavailable)
    {
        Console.WriteLine("Does not exist");
    }
    else
    {
        Console.WriteLine("Error: " + e.Message);
    }
} 
```

* * *

如果您想要更直接的代码，请使用一些 3rd 方 FTP 库。

例如对于[WinSCP .NET 程序集](https://winscp.net/eng/docs/library)，您可以使用它的[`Session.FileExists`方法](https://winscp.net/eng/docs/library_session_fileexists)：

```
SessionOptions sessionOptions = new SessionOptions {
    Protocol = Protocol.Ftp,
    HostName = "ftp.example.com",
    UserName = "username",
    Password = "password",
};

Session session = new Session();
session.Open(sessionOptions);

if (session.FileExists("/remote/path/file.txt"))
{
    Console.WriteLine("Exists");
}
else
{
    Console.WriteLine("Does not exist");
} 
```

*（我是WinSCP的作者）*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-11T07:57:32.193

您可以使用`WebRequestMethods.Ftp.ListDirectory`来检查文件是否存在，不需要讨厌的 try catch 机制。

```
 private static bool ExistFile(string remoteAddress)
    {
        int pos = remoteAddress.LastIndexOf('/');
        string dirPath = remoteAddress.Substring(0, pos); // skip the filename only get the directory

        NetworkCredential credentials = new NetworkCredential(FtpUser, FtpPass);
        FtpWebRequest listRequest = (FtpWebRequest)WebRequest.Create(dirPath);
        listRequest.Method = WebRequestMethods.Ftp.ListDirectory;
        listRequest.Credentials = credentials;
        using (FtpWebResponse listResponse = (FtpWebResponse)listRequest.GetResponse())
        using (Stream listStream = listResponse.GetResponseStream())
        using (StreamReader listReader = new StreamReader(listStream))
        {
            string fileToTest = Path.GetFileName(remoteAddress);
            while (!listReader.EndOfStream)
            {
                string fileName = listReader.ReadLine();
                fileName = Path.GetFileName(fileName);
                if (fileToTest == fileName)
                {
                    return true;
                }

            }
        }
        return false;
    }

    static void Main(string[] args)
    {
        bool existFile = ExistFile("ftp://123.456.789.12/test/config.json");
    } 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-12-09T21:51:25.110

我使用 FTPStatusCode.FileActionOK 来检查文件是否存在......

然后，在“else”部分，返回 false。

# .net - 将 .net 1.1 解决方案转换为 .net 2.0 的陷阱

> ID：347905
> 
> 赞同：3
> 
> 时间：2008-12-07T18:46:54.097
> 
> 标签：.net, visual-studio, migration

在[这个问题](https://stackoverflow.com/questions/161368/pitfalls-for-converting-a-net-20-solution-to-net-35)中，superwiren 询问将 .net 2.0 解决方案转换为 .net 3.5 的陷阱。

.net 1.1 到 .net 2.0 怎么样？

2.0 是否完全向后兼容 1.1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-07T19:03:31.363

我认为这取决于您的代码，最好的选择是执行试运行，看看它会产生什么错误。我不认为 .NET 2.0 完全向后兼容，尽管他们声称是。

[常见的转换问题和解决方案](http://msdn.microsoft.com/en-us/library/aa479312.aspx#issue11)

[1.1 到 2.0 的兼容性](http://msdn.microsoft.com/en-us/library/ms994381.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T19:04:28.413

我已经处理了几个 ASP.NET 1.1 到 2.0 的转换（中型网站），我们发现 Visual Studio 转换向导让事情变得非常简单。我们没有遇到任何不兼容问题，我们真正改变的唯一事情是用新函数替换不推荐使用的 api 调用。我建议你试一试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T19:07:23.010

不它不是。2.0 中出现了大量的重大更改，但根据您的应用程序的编码方式，它可能根本不会受到影响。这是一个文档，其中包含从 1.1 到 2.0 的所有更改的链接...

[重大变化](http://msdn.microsoft.com/en-us/netframework/aa570326.aspx)

假设您没有在 2.0 中引入的应用程序中使用任何东西，那么向后兼容的可能性就更大。

[2.0 中的新功能](http://msdn.microsoft.com/en-us/library/t357fb32.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T21:46:56.493

我在代码中发现的唯一问题是在 asp.net 中有两个控件，它们被称为具有不同大小写的相同事物。这曾经在 1.1 中工作，但在 2.0 中崩溃

无论如何，这是一种代码气味，所以没有理由为此哭泣

# c# - 是否有用于包装多个 SCM 提供程序的 API 的 ac# 库？

> ID：347910
> 
> 赞同：5
> 
> 时间：2008-12-07T18:51:48.610
> 
> 标签：c#, version-control

我正在处理的项目需要访问用户源代码控制。为此，我们封装了 Perforce API 和 Subversion API（分别使用 P4.NET 和 SubversionSharp）。

我们希望根据用户要求尽可能多地支持，我已经尝试使用谷歌搜索现有的库，但没有运气。是否存在包装多个 SCM 应用程序的 C# 库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T19:13:37.037

您可以搜索 Microsoft Source Code Control Provider (MSSCCI)。我知道，Source Safe、Team Foundation Server、Subversion、Evolution（以及其他一些）源代码控制产品都实现了这个接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T21:08:54.120

MSSCCI 将帮助许多源代码控制产品从 Visual Studio 直接访问，但不一定可以从 .NET 代码中使用。据我所知，没有 .NET 库可以抽象对所有源代码控制产品的访问，甚至不止一个。

如果您可以将 MSSCCI 提供程序（可能您必须实现一些 C++ 标头）包装为 .NET 程序集，那将会很有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T20:16:55.833

您可以通过 DllImport/interop 调用 MSSCCI 吗？

事实上，编辑，是的......

```
[DllImport(@"C:\Program Files\Microsoft Visual Studio\Common\VSS\win32\SSSCC.DLL")] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T11:51:20.780

我建议不要使用 MSSCCI 作为抽象层，因为旧式 SCC api 完全仿照 VSS 推广的 checkout-checkin 原则。

大多数较新的源代码控制系统使用更新/合并原则和/或允许更新/合并和锁定的组合来模仿旧的行为。

如果您想使用 .Net 的 Subversion，您还应该查看新的[SharpSvn](http://sharpsvn.net)库，因为它在 .Net 风格的 api 中为您提供了所有 Subversion 功能。（如果您不喜欢，您不必考虑内存管理、apr 数组、函数指针等）。

在大多数情况下，它允许您使用大约 1/5 的旧绑定所需代码的 Subversion。

```
using(SvnClient client = new SvnClient())
{
   client.Update(@"C:\My\WorkingCopy");

   // Do something to your working copy
   File.AppendAllText(@"C:\My\WorkingCopy", "\nFile Change\n");

   SvnCommitArgs ca = new SvnCommitArgs();
   ca.LogMessage = "Line added";

   client.Commit(@"C:\My\WorkingCopy", ca);
} 
```

# javascript - 设置 iframe 源而不加载新内容

> ID：347917
> 
> 赞同：1
> 
> 时间：2008-12-07T18:58:17.113
> 
> 标签：javascript, iframe, src

有没有办法在 iframe 不生成 http 请求的情况下设置 iframe 的 src 属性？如果没有，有没有办法在发送请求之前格式化请求标头？

编辑：我只需要 src 来匹配 cookie 的路径，但我不希望将该 cookie 发送到服务器。请参阅我对这个问题的评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T19:00:17.000

不，没有办法做到这一点。

# javascript - 是否有支持 JavaScript 视图的 ASP.Net MVC 视图引擎？

> ID：347918
> 
> 赞同：4
> 
> 时间：2008-12-07T18:58:23.900
> 
> 标签：javascript, asp.net-mvc, viewengine

我想在 ASP.Net MVC 的服务器端生成一些 JavaScript。是否有支持此功能的视图引擎？理想情况下，我希望能够从以下网址获取 JavaScript：

```
http://myapp/controller/action.js 
```

我查看了 MonoRail 项目，他们似乎有这个功能，但是文档非常缺乏，我找不到任何 ASP.Net MVC 的端口。

**编辑：**这个想法是能够通过使用如下网址将页面呈现为标准 HTML：

```
http://myapp/controller/action 
```

并通过使用问题中的第一个 url 作为 js（特别是 ExtJS 组件）。控制器中只有一个动作，但有两个视图：一个用于 HTML，一个用于 JS。

**编辑 2：**我基本上想达到与CakePHP中的[路由器扩展解析/请求处理相同的结果。](http://www.pagebakers.nl/2007/06/05/using-json-in-cakephp-12/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T05:54:59.363

我想扩展这个想法，不仅允许 Javascript 视图，而且或多或少任何类型的文档。要使用它，您只需将 *.js url 的视图放在控制器视图文件夹的子文件夹中：

```
\Views
+-\MyController
  +-\js
  | +-Index.aspx <- This view will get rendered if you request /MyController/Index.js
  +-Index.aspx 
```

该类是任何类型的 ViewEngine 的装饰器，因此您可以将它与 NVelocity/WebForms/Whatever 一起使用：

```
public class TypeViewEngine<T> : IViewEngine where T : IViewEngine
{
    private readonly T baseEngine;
    public T BaseEngine
    {
        get { return baseEngine; }
    }

    public TypeViewEngine(T baseEngine)
    {
        this.baseEngine = baseEngine;
    }

    public void RegisterRoutes(RouteCollection routes)
    {
        routes.MapRoute(
            "TypeViewEngine",
            "{controller}/{action}.{type}",
            new {controller = "Home", action = "Index", type = "html"}
            );
    }

    public ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName)
    {
        var vars = controllerContext.RouteData.Values;
        if(vars["type"] != null && vars["type"].ToString() != "html")
        {
            viewName = string.Format("{0}/{1}", vars["type"], viewName);
        }
        return baseEngine.FindView(controllerContext, viewName, masterName);
    }

    public ViewEngineResult FindPartialView(ControllerContext controllerContext, string partialViewName)
    {
        return baseEngine.FindPartialView(controllerContext, partialViewName);
    }

    public void ReleaseView(ControllerContext controllerContext, IView view)
    {
        baseEngine.ReleaseView(controllerContext, view);
    }
} 
```

然后，在您的 Global.asax.cs 文件中：

```
protected void Application_Start()
{
    var ve = new TypeViewEngine<WebFormViewEngine>(new WebFormViewEngine());
    ve.RegisterRoutes(RouteTable.Routes);
    RegisterRoutes(RouteTable.Routes);

    ViewEngines.Engines.Clear();
    ViewEngines.Engines.Add(ve);
} 
```

感谢大家对此的帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T20:44:40.020

根据您的编辑，我将尝试使用新答案，假设您需要 ExtJS 的 json 数据。我刚刚在我正在构建的应用程序中对其进行了测试，它运行良好。首先你需要两条路线

```
{controller}/{action}.{format}

{controller}/{action} 
```

现在 Controller 类有一个 Json 方法来序列化你想要的任何对象，它是一个 JsonResult 所以你可以使用：

```
public ActionResult List(string format) {

    // logic here

    if (string.IsNullOrEmpty(format)) {
        return View();
    } else if (format == "js") {
        return Json(object_to_serialize);
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T19:56:30.553

2007 年 7 月的 ASP.NET Futures 版本具有新的托管 JScript（我找不到更新的）。我已经成功地解决了一些问题 - 但请注意，您可能会被迫做一些额外的工作，JScript 的 .ASPX 解析存在无法使用的错误。

[http://www.microsoft.com/downloads/details.aspx?FamilyId=A5189BCB-EF81-4C12-9733-E294D13A58E6&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=A5189BCB-EF81-4C12-9733-E294D13A58E6&displaylang=en)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T19:28:33.543

我不得不做一些非常相似的事情，我使用了[MVCContrib](http://www.codeplex.com/MVCContrib)的 nvelocity 视图引擎——从技术上讲，你可以使用默认的 aspx 视图引擎，但我发现 nvelocity 语法对于输出脚本要简单得多（如果你以前没有用过它——我花了大约 10 分钟才弄明白！）。

然后你只需要向路由表添加一个路由来处理将你的 .js url 定向到操作！

**编辑**

无法验证这一点，因为我手头没有视觉工作室，但对于路线，您可能会有这样的事情：

```
RouteTable.Routes.Add(new Route
{
   Url = "[controller]/[action].js",
   Defaults = new { controller="home", requestType="javascript" }, // Whatever...
   RouteHandler = typeof(MvcRouteHandler)
});

RouteTable.Routes.Add(new Route
{
   Url = "[controller]/[action]",
   Defaults = new { controller="home"}, // Whatever...
   RouteHandler = typeof(MvcRouteHandler)
}); 
```

以 .js 结尾的请求应该通过第一条路线 - 无扩展名的请求将通过第二条路线。

然后您的操作可能有一个 requestType 参数：

```
public ActionResult MyAction (RequestType requestType)
{
  if(requestType == RequestType.JavaScript)
  {
     ... new nvelocity view to render javascript
  }
  else
  {
     ... 
  }
} 
```

至于目录结构 - 你自己处理！不是因为我不想提供帮助，而是因为你可以灵活地做你想做的事！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-07T19:50:24.733

您不一定需要查看引擎，只需返回纯文本结果。

这是我用来在 javascript 对象中呈现一些用户文化设置的控制器 (MonoRail)：

```
[ControllerDetails("js")]
public class JavascriptController : Controller
{
    private ISessionContext sessionContext;

    public JavascriptController(ISessionContext sessionContext)
    {
        this.sessionContext = sessionContext;
    }

    public void CultureInfo()
    {
        var scriptformat = @"var cultureInfo = {0};";
        var json = Context.Services.JSONSerializer.Serialize(getJSONiZableCultureInfo(sessionContext.CurrentCulture));
        RenderText(String.Format(scriptformat, json));
    }

    object getJSONiZableCultureInfo(System.Globalization.CultureInfo  culture)
    {
        return new
                        {   // add more there
                            culture.NumberFormat
                        };
    }
} 
```

对于原始文本渲染会闻到的更复杂的事情，任何视图引擎都可以工作。

此外，您不必使用 .js 扩展名将 url 放入脚本标记中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T19:54:29.810

如果您只想基于 ViewData 生成 javascript，您可以创建自己的自定义结果。[这](http://blog.maartenballiauw.be/post/2008/05/13/ASPNET-MVC-custom-ActionResult.aspx)是一个例子。

# c++ - 1.#INF00、-1.#IND00 和 -1.#IND 是什么意思？

> ID：347920
> 
> 赞同：70
> 
> 时间：2008-12-07T19:00:04.693
> 
> 标签：c++, c

我正在使用浮点数处理一些 C 代码，当我尝试在屏幕上打印浮点数时，我得到 1.#INF00、-1.#IND00 和 -1.#IND。这些值是什么意思？

我相信 1.#INF00 意味着正无穷大，但是 -1.#IND00 和 -1.#IND 呢？我有时也看到这个值：1.$NaN 这不是一个数字，但是是什么导致了这些奇怪的值，这些值如何帮助我进行调试？

我正在使用[MinGW](http://en.wikipedia.org/wiki/MinGW)，我相信它使用[IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point)表示浮点数。

有人可以列出所有这些无效值及其含义吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-12-07T19:21:25.133

来自[C++ 中的 IEEE 浮点异常](http://www.johndcook.com/IEEE_exceptions_in_cpp.html)：

> 本页将回答以下问题。
> 
> *   我的程序刚刚打印出 1.#IND 或 1.#INF（在 Windows 上）或 nan 或 inf（在 Linux 上）。发生了什么？
> *   如何判断一个数字是否真的是一个数字而不是 NaN 或无穷大？
> *   如何在运行时找到有关各种 NaN 和无穷大的更多详细信息？
> *   你有任何示例代码来展示它是如何工作的吗？
> *   我在哪里可以了解更多信息？
> 
> 这些问题与浮点异常有关。如果您在期望数字的地方得到一些奇怪的非数字输出，那么您要么超出了浮点运算的有限限制，要么您要求了一些未定义的结果。为简单起见，我将坚持使用双浮点类型。类似的评论适用于浮点类型。
> 
> **调试 1.#IND、1.#INF、nan 和 inf**
> 
> 如果您的操作生成的正数大于双精度数，则该操作将在 Windows 上返回 1.#INF 或在 Linux 上返回 inf。同样，如果结果是负数太大而无法存储在双精度中，您的代码将返回 -1.#INF 或 -inf。正数除以零产生正无穷大，负数除以零产生负无穷大。本页末尾的示例代码将演示一些产生无穷大的操作。
> 
> 有些运算没有数学意义，例如取负数的平方根。（是的，这个操作在复数的上下文中是有意义的，但是双精度数表示一个实数，因此没有双精度数来表示结果。）对于负数的对数也是如此。sqrt(-1.0) 和 log(-1.0) 都将返回 NaN，即“非数字”的“数字”的通用术语。Windows 将 NaN 显示为 -1.#IND（“IND”表示“不确定”），而 Linux 显示 nan。其他会返回 NaN 的操作包括 0/0、0*∞ 和 ∞/∞。有关示例，请参见下面的示例代码。
> 
> 简而言之，如果您得到 1.#INF 或 inf，请查找溢出或除以零。如果得到 1.#IND 或 nan，寻找非法操作。也许你只是有一个错误。如果它更微妙并且您有一些难以计算的东西，请参阅避免上溢、下溢和精度损失。那篇文章给出了计算结果的技巧，如果直接计算，中间步骤会溢出。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-09-25T06:17:14.697

`-1.#IND00`对于任何想知道和之间区别的人`-1.#IND`（该问题专门提出，并且没有一个答案解决）：

**`-1.#IND00`**

这具体意味着一个非零数除以零，例如`3.14 / 0`（[来源](https://stackoverflow.com/a/33057379)）

**`-1.#IND`**（的同义词`NaN`）

这意味着以下四件事之一（参见[wiki](https://en.wikipedia.org/wiki/NaN#Operations_generating_NaN) from [source](https://stackoverflow.com/a/7476564)）：

1)`sqrt`或`log`负数

2) 两个变量都为 0 或无穷大的操作，例如`0 / 0`

3) 至少有一个变量已经存在的操作`NaN`，例如`NaN * 5`

4) 超出范围触发，例如`arcsin(2)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-10T00:12:33.287

对于那些在 .NET 环境中的人来说，以下可能是一种过滤非数字的便捷方法（此示例在 VB.NET 中，但在 C# 中可能类似）：

```
If Double.IsNaN(MyVariableName) Then
    MyVariableName = 0 ' Or whatever you want to do here to "correct" the situation
End If 
```

如果您尝试使用具有 NaN 值的变量，您将收到以下错误：

> 对于 Decimal，值太大或太小。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-07-11T16:43:52.137

您的问题“它们是什么”已经在上面得到了回答。

至于调试（您的第二个问题），以及在开发您想要检查特殊输入值的库时，您可能会发现以下函数在 Windows C++ 中很有用：

_isnan()、_isfinite() 和 _fpclass()

在 Linux/Unix 上，您应该会发现 isnan()、isfinite()、isnormal()、isinf()、fpclassify() 很有用（您可能需要使用编译器标志 -lm 与 libm 链接）。

# asp.net - 将 asp.net 会员资格与 sqlite 或其他提供商一起使用？

> ID：347945
> 
> 赞同：6
> 
> 时间：2008-12-07T19:28:28.847
> 
> 标签：asp.net, security, asp.net-membership

有没有人有任何使用[Sqlite](http://www.sqlite.org)和 ASP.NET 成员资格的例子？我正在构建一个小型“插入式”Web 应用程序，不想依赖 SQL 数据库来存储用户凭据等。Sqlite 似乎是一个不错的选择，我对它在[Elmah](http://code.google.com/p/elmah/)中的性能印象深刻；我也不介意使用 xml 作为数据存储。

另一方面，也许 asp.net 会员资格不是基本表单级别安全性的好选择？对于实施它的人来说，该应用程序不需要超过几个用户，目前我认为不需要角色。我对使用 asp.net 会员的想法是设置和运行简单；如果我不需要，为什么要建立一个安全类，对吧？

当然欢迎任何其他建议；感谢您的时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-21T12:34:52.867

看起来 Roger Martin 的项目 - [http://www.codeproject.com/KB/aspnet/SQLite-Providers.aspx](http://www.codeproject.com/KB/aspnet/SQLite-Providers.aspx) - 现在是 SQLite 连接的推荐。

这是 Peter Bromberg ( [http://twitter.com/peterbromberg/status/5031854389](http://twitter.com/peterbromberg/status/5031854389) ) 提出的建议，Google 上的下一个顶级资源是 Roger Martin 的上述资源，他建议作为获取提供者的地方 ( [http:// galleryserverpro.blogspot.com/2009/08/new-release-adds-support-for-flash.html#comments](http://galleryserverpro.blogspot.com/2009/08/new-release-adds-support-for-flash.html#comments)）。

鉴于它是如何成为半商业产品的一部分（作者正试图重新开始以全职工作的形式开展工作），看来这将保持最新。

编辑 1：有关 SQLite 已发布提供程序订购的更多信息：http: [//sqlite.phxsoftware.com/forums/p/75/397.aspx](http://sqlite.phxsoftware.com/forums/p/75/397.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-07T19:35:20.503

我也是 SQLlite 的忠实粉丝。我会说 asp.net 会员资格对于基本的东西来说已经足够了。

Eggheadcafe 的 Peter 有这篇关于 sqllite 的正确文章，请查看。 [文章](http://www.eggheadcafe.com/articles/20051119.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T19:33:19.977

要将成员资格提供程序与其他数据库一起使用，请查看[自定义成员资格提供程序](http://www.google.com/search?hl=en&q=asp.net+custom+membership+provider&btnG=Search)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-17T12:43:28.530

Roger Martin 的 SQLiteMembershipProvider 有一个新的更新源

nuget 包：[https](https://www.nuget.org/packages/SQLiteMembershipProvider)
://www.nuget.org/packages/SQLiteMembershipProvider 源代码：[https ://bitbucket.org/jkuemerle/sqlitemembershipprovider](https://bitbucket.org/jkuemerle/sqlitemembershipprovider)

# security - 你见过/使用过哪些现实生活中的默默无闻的安全例子？

> ID：347948
> 
> 赞同：8
> 
> 时间：2008-12-07T19:30:40.013
> 
> 标签：security

解释你如何改进它的奖励积分。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-07T20:44:56.603

默默无闻的现实生活安全？

前门的钥匙藏在附近的一块岩石下，或欢迎垫下，或高栏杆顶部。

这些都是通过默默无闻的安全实例，例如，任何人都可以抓住它，但大多数人如果不进行大量搜索就无法找到它。但是，专门的攻击者可以直接进入。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-07T19:51:54.167

有些人喜欢通过使用混淆来使他们的 javascript 难以阅读（并因此被破解）。谷歌是这种技术的用户之一。在最简单的层面上，他们将变量和方法名称更改为一个难以理解的字母。第一个变量命名为“a”，第二个变量命名为“b”，依此类推。它确实成功地使 javascript 非常难以阅读和遵循。它还为包含在 javascript 代码中的知识产权增加了一些保护，必须将其下载到用户的浏览器才能使用，从而使所有人都可以访问它。

除了使代码难以阅读之外，变量名称的缩短还减少了必须下载到用户浏览器的 javascript 代码的大小。从理论上讲，这可以减少网络流量。

[这](http://blogoscoped.com/archive/2008-02-08-n74.html)是一篇关于 Google 混淆的文章，[这里](http://www.google.com/Top/Computers/Programming/Languages/JavaScript/Tools/Obfuscators/)是可用工具的列表。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-07T20:05:45.840

在一个网站上，我做了一些合同工作，我注意到他们正在存储双重哈希密码。从记忆中，他们存储了类似的东西

```
$encrypted_password = md5( sha1( plaintext_password ) ); 
```

当我问到这样做的目的是什么时，我发现编写帐户创建/登录脚本的人一直在阅读有关字典攻击的内容。他认为没有人会想到创建一个字典，在其中使用 md5*和*sha1 对输入进行哈希处理。

我通过在他们的用户表中添加一个随机盐列来改进系统。不过，我留下了双重哈希。它不会*损害*系统的安全性，老实说，我认为对于不太了解安全性的人来说，想到这一点是非常聪明的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-07T19:40:00.197

见过：网站使用复杂的 url 来访问 ajax 组件，而不是实际使用密码保护它们，例如：

domain.com/3r809d8f09feefhjkdjfhjdf/delete.php?a=03809803983djfhkjsdfsadf

字符串保持不变，查询是随机的，旨在阻止攻击者。

改进：限制页面只能从某些 IP 地址访问。将身份验证字符串添加到作为访问时间的加盐哈希的查询中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-30T09:02:00.440

在一个更“现实生活”的例子中，我不知道这是不是故意的，但我喜欢我所在街区的门铃都没有名字，而且它们的数字似乎与公寓无关数字什么的。IE。605 号公寓拨打#25，404 号公寓拨打#13，依此类推。:)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-10T20:28:19.170

我们处理的一个供应商要求我们以[ROT-13](http://en.wikipedia.org/wiki/Rot13) “加密”格式在查询字符串中发布用户名和密码。不是开玩笑。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-07T19:41:48.243

人们将密码写在纸上，然后放在键盘下。

我通过使用他们的帐户登录他们的计算机并向小组发送了一封令人尴尬的电子邮件来解决了这个问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-04T15:56:40.757

通过默默无闻的安全是一种有效的策略。很多人已经关闭回复版本信息作为 ftp 和 apache 的最佳实践。蜜罐可以被认为是一种模糊的做法，因为攻击者不知道网络的布局并被卷入其中。我知道的一个高安全性站点通过五位字母数字短语（例如'0a3bg'）而不是使用逻辑用户名来分配他们的用户名。任何使闯入系统变得更加困难或花费更长的时间都是有效的措施。

仅通过默默无闻的安全性是不好的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-07T19:38:55.880

看到：phpMyAdmin 移入目录 _phpmyadmin

改进：不允许从公司网络外部访问。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-07T20:14:03.700

类似于@stech 的解决方案。

我们在 Web 上的应用程序中的一些管理页面会检查本地 IP 子网范围，否则会显示访问被拒绝。访问改进仅限于网络内部或通过 VPN 访问的用户。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-07T20:39:00.233

回到旧的 DBase/Clipper 时代，我为一个为他的朋友开发应用程序的人工作。这位朋友想要一些“秘密”可访问的程序或数据（我不记得），需要一个只有他知道的密码。

有人告诉我，解决方案是 Clipper 在 secret 目录中打开一个 DOS 提示符，在黑色背景颜色上显示黑色文本（一些 ANSI 控制字符可以做到这一点）。

用户必须输入密码，但这是 DOS 命令提示符的输入行，“密码”实际上是随后执行的批处理文件的名称。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-07T20:59:02.253

我曾经看到一个摄影网站，您可以在其中从照片缩略图图片 url 中删除一些字符以获得完整版本。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-07T21:28:33.193

许多专业摄影师网站使用 Javascript 来防止人们右键单击图像以“另存为...”。大多数这些网站也不做任何水印。

我曾经在禁用引荐标头的情况下进行冲浪......如果他们不知道您来自哪里，那么有多少网站会炸毁或完全拒绝您，这非常令人惊讶。

一个网站进行了一项民意调查，并使用 cookie 来防止您多次投票。您可以简单地删除该 cookie 并继续投票。您也可以使用 编写所有脚本`wget`。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-08T14:15:01.430

我一直看到的这个例子是在源代码中完成的，开发人员认为没有人会看到。尤其是嵌入在源代码中的加密密钥，您会经常看到这一点。很多时候甚至不是反编译代码的问题，他们可以直接使用库。

解决方案始终是教开发人员假设有人拥有源代码并且可以使用它来对付你。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-30T08:58:03.113

竭尽全力隐藏软件名称和版本号。

IE。将 Tomcat 服务器名称和版本更改为一些引号和随机数（如 666），更改常规 JavaScript 库（如 scriptaculous 和原型等）的名称和版本号。

在当前的项目中，我们正在使用 Google Web 工具包 (GWT)，这个鬼鬼祟祟的小东西将 Java 编译为 javascript（您几乎无法控制）并包含字符串“GWT”和版本号。当然是完全不可接受的，所以我们需要制作一个在 GWT 编译后运行的脚本，以删除所有这些引用（！）。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-12-30T09:38:25.730

/admin 没有密码。

是的，我看过，非常真实。

# c++ - 如何将 std::string 转换为 const char* 或 char*

> ID：347949
> 
> 赞同：1011
> 
> 时间：2008-12-07T19:30:56.800
> 
> 标签：c++, string, char, constants

如何将 a 转换`std::string`为 a`char*`或 a `const char*`？

* * *

## 回答 #1

> 赞同：1207
> 
> 时间：2008-12-07T19:35:43.763

如果您只想将 a 传递给[`std::string`](http://en.cppreference.com/w/cpp/string/basic_string)需要的函数，`const char*`则可以使用

```
std::string str;
const char * c = str.c_str(); 
```

如果你想得到一个可写的副本，比如`char *`，你可以这样做：

```
std::string str;
char * writable = new char[str.size() + 1];
std::copy(str.begin(), str.end(), writable);
writable[str.size()] = '\0'; // don't forget the terminating 0

// don't forget to free the string after finished using it
delete[] writable; 
```

**编辑**：请注意，上述内容不是异常安全的。如果`new`调用和`delete`调用之间有任何东西抛出，您将泄漏内存，因为没有任何东西会`delete`自动调用您。有两种直接的方法可以解决这个问题。

### boost::scoped_array

[`boost::scoped_array`](http://www.boost.org/doc/libs/release/libs/smart_ptr/scoped_array.htm)超出范围时将为您删除内存：

```
std::string str;
boost::scoped_array<char> writable(new char[str.size() + 1]);
std::copy(str.begin(), str.end(), writable.get());
writable[str.size()] = '\0'; // don't forget the terminating 0

// get the char* using writable.get()

// memory is automatically freed if the smart pointer goes 
// out of scope 
```

### 标准::向量

这是标准方式（不需要任何外部库）。您使用[`std::vector`](http://en.cppreference.com/w/cpp/container/vector)，它完全为您管理内存。

```
std::string str;
std::vector<char> writable(str.begin(), str.end());
writable.push_back('\0');

// get the char* using &writable[0] or &*writable.begin() 
```

* * *

## 回答 #2

> 赞同：216
> 
> 时间：2010-11-11T09:21:35.420

鉴于说...

```
std::string x = "hello"; 
```

## 从 `string` 获取 `char *` 或 `const char*`

**如何获取`x`在范围内有效且未进一步修改的字符指针**

**C++11**简化了事情；以下所有内容都可以访问相同的内部字符串缓冲区：

```
const char* p_c_str = x.c_str();
const char* p_data  = x.data();
char* p_writable_data = x.data(); // for non-const x from C++17 
const char* p_x0    = &x[0];

      char* p_x0_rw = &x[0];  // compiles iff x is not const... 
```

所有上述指针都将保存*相同的值*——缓冲区中第一个字符的地址。即使是空字符串也有“缓冲区中的第一个字符”，因为 C++11 保证在显式分配的字符串内容之后始终保留一个额外的 NUL/0 终止符（例如`std::string("this\0that", 9)`，将有一个缓冲区保存`"this\0that\0"`）。

鉴于上述任何指针：

```
char c = p[n];   // valid for n <= x.size()
                 // i.e. you can safely read the NUL at p[x.size()] 
```

仅适用于非`const`指针`p_writable_data`和 from `&x[0]`：

```
p_writable_data[n] = c;
p_x0_rw[n] = c;  // valid for n <= x.size() - 1
                 // i.e. don't overwrite the implementation maintained NUL 
```

在字符串的其他地方写入 NUL*不会*更改`string`'s `size()`; `string`'s 可以包含任意数量的 NUL - 它们没有被给予特殊处理`std::string`（在 C++03 中相同）。

在**C++03**中，事情要复杂得多（***突出显示***的关键差异）：

*   `x.data()`

    *   返回到***标准不要求以 NUL 结束***`const char*`的字符串的内部缓冲区（即，后面可能是未初始化或垃圾值，意外访问具有*未定义的行为*）。 *`['h', 'e', 'l', 'l', 'o']` **   `x.size()`字符可以安全阅读，即`x[0]`通过`x[x.size() - 1]`
        *   对于空字符串，您可以保证某些非 NULL 指针可以安全地添加到其中 0 （欢呼！），但您不应该取消引用该指针。** 

***   `&x[0]`

    *   ***对于空字符串，这具有未定义的行为***(21.3.4)
        *   例如，鉴于`f(const char* p, size_t n) { if (n == 0) return; ...whatever... }`您不能`f(&x[0], x.size());`在何时调用`x.empty()`- 只需使用`f(x.data(), ...)`.
    *   否则，按照`x.data()`但是：
        *   对于非`const` `x`this 产生一个非`const` `char*`指针；你可以覆盖字符串内容*   `x.c_str()`

    *   返回值`const char*`的 ASCIIZ（以 NUL 结尾）表示（即 ['h', 'e', 'l', 'l', 'o', '\0']）。
    *   尽管很少有实现选择这样做，但 C++03 标准的措辞是允许字符串实现自由地从潜在的非 NUL 终止缓冲区中创建一个***不同的 NUL 终止缓冲区*** *，*`x.data()`由和`&x[0]`
    *   `x.size()`+ 1 个字符可以安全阅读。
    *   即使对于空字符串 (['\0']) 也能保证安全。**

 **## 访问外部法律索引的后果

无论您以何种方式获得指针，您都不能从指针访问超出上述描述中保证的字符的内存。这样做的尝试具有*未定义的行为*，即使对于读取，应用程序崩溃和垃圾结果的可能性也非常大，此外还有大量数据、堆栈损坏和/或写入的安全漏洞。

## 这些指针什么时候失效？

如果您调用某个`string`修改或保留更多容量的成员函数，`string`则上述任何方法预先返回的任何指针值都是*无效*的。您可以再次使用这些方法来获取另一个指针。（规则与 s 中的迭代器相同`string`）。

另请参阅*如何在`x`离开范围或在*下面进一步修改后使字符指针有效......

## 那么，哪个*更好*用呢？

从 C++11 开始，`.c_str()`用于 ASCIIZ 数据和`.data()`“二进制”数据（下文进一步解释）。

在 C++03 中，`.c_str()`除非确定这`.data()`是足够的，否则使用，并且更喜欢它`.data()`，`&x[0]`因为它对空字符串是安全的......

*...尝试充分理解该程序以`data()`在适当时使用，否则您可能会犯其他错误...*

许多函数使用ASCII NUL '\0' 字符`.c_str()`作为标记值，​​表示相关和安全访问数据的结束。这适用于仅 C++ 的函数（如 say `fstream::fstream(const char* filename, ...)`）和与 C 共享的函数（如`strchr()`, 和`printf()`.

鉴于 C++03`.c_str()`对返回缓冲区的 ' 保证是 ' 的超集`.data()`，您始终可以安全地使用`.c_str()`，但人们有时不会这样做，因为：

*   using`.data()`与读取源代码的其他程序员沟通数据不是 ASCIIZ（相反，您正在使用字符串来存储数据块（有时甚至不是真正的文本）），或者您将其传递给另一个将其视为“二进制”数据块的函数。这可能是确保其他程序员的代码更改继续正确处理数据的关键洞察力。
*   仅限 C++03：您的`string`实现可能需要进行一些额外的内存分配和/或数据复制以准备 NUL 终止的缓冲区

作为进一步的提示，如果函数的参数需要 ( `const`)`char*`但不坚持获取`x.size()`，则该函数*可能*需要 ASCIIZ 输入，所以这`.c_str()`是一个不错的选择（函数需要知道文本以某种方式终止的位置，所以如果不是一个单独的参数，它只能是一个约定，如长度前缀或哨兵或一些固定的预期长度）。

## `x`即使在离开范围或进一步修改后如何使字符指针有效

您需要将的内容***复制***`string` `x`到外部的新内存区域`x`。这个外部缓冲区可能在许多地方，例如另一个`string`或字符数组变量，它可能具有也可能不具有与`x`处于不同范围内不同的生命周期（例如命名空间、全局、静态、堆、共享内存、内存映射文件） .

要将文本复制`std::string x`到一个独立的字符数组中：

```
// USING ANOTHER STRING - AUTO MEMORY MANAGEMENT, EXCEPTION SAFE
std::string old_x = x;
// - old_x will not be affected by subsequent modifications to x...
// - you can use `&old_x[0]` to get a writable char* to old_x's textual content
// - you can use resize() to reduce/expand the string
//   - resizing isn't possible from within a function passed only the char* address

std::string old_x = x.c_str(); // old_x will terminate early if x embeds NUL
// Copies ASCIIZ data but could be less efficient as it needs to scan memory to
// find the NUL terminator indicating string length before allocating that amount
// of memory to copy into, or more efficient if it ends up allocating/copying a
// lot less content.
// Example, x == "ab\0cd" -> old_x == "ab".

// USING A VECTOR OF CHAR - AUTO, EXCEPTION SAFE, HINTS AT BINARY CONTENT, GUARANTEED CONTIGUOUS EVEN IN C++03
std::vector<char> old_x(x.data(), x.data() + x.size());       // without the NUL
std::vector<char> old_x(x.c_str(), x.c_str() + x.size() + 1);  // with the NUL

// USING STACK WHERE MAXIMUM SIZE OF x IS KNOWN TO BE COMPILE-TIME CONSTANT "N"
// (a bit dangerous, as "known" things are sometimes wrong and often become wrong)
char y[N + 1];
strcpy(y, x.c_str());

// USING STACK WHERE UNEXPECTEDLY LONG x IS TRUNCATED (e.g. Hello\0->Hel\0)
char y[N + 1];
strncpy(y, x.c_str(), N);  // copy at most N, zero-padding if shorter
y[N] = '\0';               // ensure NUL terminated

// USING THE STACK TO HANDLE x OF UNKNOWN (BUT SANE) LENGTH
char* y = alloca(x.size() + 1);
strcpy(y, x.c_str());

// USING THE STACK TO HANDLE x OF UNKNOWN LENGTH (NON-STANDARD GCC EXTENSION)
char y[x.size() + 1];
strcpy(y, x.c_str());

// USING new/delete HEAP MEMORY, MANUAL DEALLOC, NO INHERENT EXCEPTION SAFETY
char* y = new char[x.size() + 1];
strcpy(y, x.c_str());
//     or as a one-liner: char* y = strcpy(new char[x.size() + 1], x.c_str());
// use y...
delete[] y; // make sure no break, return, throw or branching bypasses this

// USING new/delete HEAP MEMORY, SMART POINTER DEALLOCATION, EXCEPTION SAFE
// see boost shared_array usage in Johannes Schaub's answer

// USING malloc/free HEAP MEMORY, MANUAL DEALLOC, NO INHERENT EXCEPTION SAFETY
char* y = strdup(x.c_str());
// use y...
free(y); 
```

## 想要一个`char*`或`const char*`从一个生成的其他原因`string`

所以，上面你已经看到了如何获得一个 ( `const`) `char*`，以及如何制作一个独立于原始文本的副本`string`，但是你能用它*做*什么呢？一些随机的例子......

*   让“C”代码访问 C++`string`的文本，如`printf("x is '%s'", x.c_str());`
*   将 的文本复制`x`到函数调用者指定的缓冲区（例如`strncpy(callers_buffer, callers_buffer_size, x.c_str())`），或用于设备 I/O 的易失性内存（例如`for (const char* p = x.c_str(); *p; ++p) *p_device = *p;`）
*   将 的文本附加`x`到已经包含一些 ASCIIZ 文本的字符数组（例如`strcat(other_buffer, x.c_str())`） - 注意不要超出缓冲区（在许多情况下您可能需要使用`strncat`）
*   从函数返回 a`const char*`或`char*`从函数返回（可能出于历史原因 - 客户端使用您现有的 API - 或者出于 C 兼容性，您不想返回 a `std::string`，但确实想将您`string`的数据复制到某个地方以供调用者使用）
    *   `string`注意不要在指针指向的局部变量离开作用域后返回可能被调用者取消引用的指针
    *   一些具有为不同实现编译/链接的共享对象的项目`std::string`（例如 STLport 和编译器原生）可能会将数据作为 ASCIIZ 传递以避免冲突

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-12-07T19:31:50.387

使用`.c_str()`方法`const char *`。

您可以使用`&mystring[0]`来获取`char *`指针，但有几个陷阱：您不一定会获得以零结尾的字符串，并且您将无法更改字符串的大小。尤其要注意不要在字符串末尾添加字符，否则会导致缓冲区溢出（并可能崩溃）。

在 C++11 之前，不能保证所有字符都是同一个连续缓冲区的一部分，但实际上所有已知的实现都以`std::string`这种方式工作；请参阅[“&s[0]”是否指向 std::string 中的连续字符？](https://stackoverflow.com/questions/1986966/does-s0-point-to-contiguous-characters-in-a-stdstring).

请注意，许多`string`成员函数将重新分配内部缓冲区并使您可能保存的任何指针无效。最好立即使用它们然后丢弃。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2016-01-12T15:53:11.970

## C++17

**C++17**（即将推出的标准）更改了模板的概要，`basic_string`添加了一个非常量重载`data()`：

> `charT* data() noexcept;`
> 
> 返回： 一个指针 p，使得 p + i == &operator 对于 [0,size()] 中的每个 i。

* * *

### `CharT const *`从`std::basic_string<CharT>`

```
std::string const cstr = { "..." };
char const * p = cstr.data(); // or .c_str() 
```

### `CharT *`从`std::basic_string<CharT>`

```
std::string str = { "..." };
char * p = str.data(); 
```

## C++11

# `CharT const *`从`std::basic_string<CharT>`

```
std::string str = { "..." };
str.c_str(); 
```

# `CharT *`从`std::basic_string<CharT>`

从 C++11 开始，标准说：

> 1.  对象中的类字符`basic_string`对象应连续存储。也就是说，对于任何`basic_string`对象`s`，身份都应适用于的`&*(s.begin() + n) == &*s.begin() + n`所有值。`n``0 <= n < s.size()`
> 
> * * *
> 
> 2.  `const_reference operator[](size_type pos) const;`
>     `reference operator[](size_type pos);`
>     
>     
>     
>     返回：`*(begin() + pos)`if ，否则为value`pos < size()`类型对象的引用；不得修改参考值。`CharT``CharT()`
>     
>     
> 
> * * *
> 
> 3.  `const charT* c_str() const noexcept;`
>     `const charT* data() const noexcept;`
>     
>     
>     
>     返回： 一个指针 p 使得`p + i == &operator[](i)`对于每个`i`in `[0,size()]`。

有多种可能的方法来获取非常量字符指针。

### 1.使用C++11的连续存储

```
std::string foo{"text"};
auto p = &*foo.begin(); 
```

**临**

*   简单而简短
*   快速（不涉及复制的唯一方法）

**缺点**

*   Final`'\0'`不可更改/不一定是非常量内存的一部分。

### 2.使用`std::vector<CharT>`

```
std::string foo{"text"};
std::vector<char> fcv(foo.data(), foo.data()+foo.size()+1u);
auto p = fcv.data(); 
```

**临**

*   简单的
*   自动内存处理
*   动态的

**缺点**

*   需要字符串复制

### 3\. 使用`std::array<CharT, N>`if`N`是编译时间常数（并且足够小）

```
std::string foo{"text"};
std::array<char, 5u> fca;
std::copy(foo.data(), foo.data()+foo.size()+1u, fca.begin()); 
```

**临**

*   简单的
*   堆栈内存处理

**缺点**

*   静止的
*   需要字符串复制

### 4\. 带自动存储删除的原始内存分配

```
std::string foo{ "text" };
auto p = std::make_unique<char[]>(foo.size()+1u);
std::copy(foo.data(), foo.data() + foo.size() + 1u, &p[0]); 
```

**临**

*   内存占用小
*   自动删除
*   简单的

**缺点**

*   需要字符串复制
*   静态（动态使用需要更多代码）
*   特征少于向量或数组

### 5\. 手动处理的原始内存分配

```
std::string foo{ "text" };
char * p = nullptr;
try
{
  p = new char[foo.size() + 1u];
  std::copy(foo.data(), foo.data() + foo.size() + 1u, p);
  // handle stuff with p
  delete[] p;
}
catch (...)
{
  if (p) { delete[] p; }
  throw;
} 
```

**临**

*   最大“控制”

**骗局**

*   需要字符串复制
*   最大责任/对错误的敏感性
*   复杂的

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-03-29T13:32:16.967

我正在使用一个 API，它有很多`char*`作为输入的函数。

我创建了一个小班来面对这种问题，并且我已经实现了[RAII](https://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)成语。

```
class DeepString
{
        DeepString(const DeepString& other);
        DeepString& operator=(const DeepString& other);
        char* internal_; 

    public:
        explicit DeepString( const string& toCopy): 
            internal_(new char[toCopy.size()+1]) 
        {
            strcpy(internal_,toCopy.c_str());
        }
        ~DeepString() { delete[] internal_; }
        char* str() const { return internal_; }
        const char* c_str()  const { return internal_; }
}; 
```

您可以将其用作：

```
void aFunctionAPI(char* input);

//  other stuff

aFunctionAPI("Foo"); //this call is not safe. if the function modified the 
                     //literal string the program will crash
std::string myFoo("Foo");
aFunctionAPI(myFoo.c_str()); //this is not compiling
aFunctionAPI(const_cast<char*>(myFoo.c_str())); //this is not safe std::string 
                                                //implement reference counting and 
                                                //it may change the value of other
                                                //strings as well.
DeepString myDeepFoo(myFoo);
aFunctionAPI(myFoo.str()); //this is fine 
```

我之所以调用该类`DeepString`，是因为它正在创建`DeepString`现有字符串的深度且唯一的副本（不可复制）。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-05-12T08:18:16.850

看看这个：

```
string str1("stackoverflow");
const char * str2 = str1.c_str(); 
```

但是，请注意，这将返回一个`const char *`.

对于 a `char *`，用于`strcpy`将其复制到另一个`char`数组中。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-07-12T12:06:36.660

```
char* result = strcpy((char*)malloc(str.length()+1), str.c_str()); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-10-27T20:27:22.250

**现在从 c++ std 字符串转换为 C 样式字符串真的很容易。**

为此，我们有一个`string::copy`函数可以轻松地将 std 字符串转换为 C 风格的字符串。[参考](https://www.cplusplus.com/reference/string/string/copy/)

`string::copy`函数参数串行

1.  char 字符串指针
2.  字符串大小，将复制多少个字符
3.  位置，字符复制的开始位置

还有一点很重要，

此函数不会在操作结束时附加空字符。所以，我们需要手动放置。

代码考试如下 -

```
// char string
char chText[20];

// c++ string
string text =  "I am a Programmer";

// conversion from c++ string to char string
// this function does not append a null character at the end of operation
text.copy(chText, text.size(), 0);

// we need to put it manually
chText[text.size()] = '\0';

// below statement prints "I am a Programmer"
cout << chText << endl; 
```

反之亦然，**从 C 样式字符串转换为 C++ 标准字符串要容易得多**

我们可以通过三种方式将 C 样式字符串转换为 C++ 标准字符串

第一个是使用构造函数，

```
char chText[20] = "I am a Programmer";
// using constructor
string text(chText); 
```

第二个是使用`string::assign`方法

```
// char string
char chText[20] = "I am a Programmer";

// c++ string
string text;

// convertion from char string to c++ string
// using assign function
text.assign(chText); 
```

第三个是赋值运算符（=），其中字符串类使用运算符重载

```
// char string
char chText[20] = "I am a Programmer";

// c++ string
// convertion from char string to c++ string using assignment operator overloading
string text = chText; 
```

第三个也可以像下面这样写 -

```
// char string
char chText[20] = "I am a Programmer";

// c++ string
string text;

// convertion from char string to c++ string
text = chText; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-17T06:50:08.090

假设，字符串 str="stack";

1)**将字符串转换为字符***

```
 char* s_rw=&str[0]; 
```

上面的char*(即s_rw)是可读可写的，指向需要转换成char*的字符串的基地址

2)**将字符串转换为 const char** *

```
 const char* s_r=&str[0]; 
```

上面的const char*（即s_r）可读不可写，指向字符串的基地址。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2017-02-17T16:45:29.067

试试这个

```
std::string s(reinterpret_cast<const char *>(Data), Size); 
```

# c++ - 简单的匿名管道 - 您使用什么包装器模型？(WinAPI, C++)

> ID：347951
> 
> 赞同：1
> 
> 时间：2008-12-07T19:31:07.033
> 
> 标签：c++, winapi, oop, ipc, pipe

我在 Windows 中有两个正在运行的进程，每个进程都有一个到另一个进程的管道。

我想序列化一个复杂的类并将其从一个进程传输到另一个进程。我已经制定了序列化程序，并且我知道管道正在发送二进制流。我应该如何发送我的序列化数据？我正在使用 WinAPI 和 C++。

我应该开发自定义协议吗？如果是这样，它应该是这个特定类的通用还是唯一的？发送序列化类时可以保留虚拟表吗？

在这种情况下是否有常用的模型或设计模式？一些示例代码将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T19:42:55.950

您可能想查看[协议缓冲区](http://code.google.com/p/protobuf/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T20:05:18.633

这里是教程`boost::serialization`。我可以想象它可以很好地通过管道发送数据并在另一端反序列化：http: [//www.boost.org/doc/libs/1_37_0/libs/serialization/doc/tutorial.html](http://www.boost.org/doc/libs/1_37_0/libs/serialization/doc/tutorial.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T19:56:07.293

您可以使用 boost::asio::windows::stream_handle 像 io 一样组织 iostream，并异步执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T22:01:14.030

您不必担心 vtables，因为 boost serialize 会担心类型。您唯一需要做的就是确保任何类型都是序列化的，然后在反序列化时使用另一端的*EXACT SAME TYPE*。

# javascript - 如何编写脚本来捕获字符串作为输入并在 Firefox 文档中打开它们？

> ID：347954
> 
> 赞同：-1
> 
> 时间：2008-12-07T19:32:23.647
> 
> 标签：javascript, html, browser

如何编写脚本来捕获字符串作为输入并在 Firefox 文档中打开它们？每个链接将转到不同的窗口或选项卡。任何想法将不胜感激。

我只是希望能够获取一些链接并打开它们。例如，我有 50 个链接。复制和解析这 50 个链接需要很长时间，也需要大量工作。如果我可以编写一个脚本来读取这些链接并让计算机完成工作，那对我将非常有帮助。我只是不知道怎么写或者在哪里写，因为它听起来不太难（只是知道怎么写）。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T22:55:15.710

如果我猜对了，我想你可以做这样的事情。这将打开列出的四个 url，但它可能会被弹出窗口阻止程序阻止。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Documento sin t&iacute;tulo</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body>
<script>
<!--
    var dir = new Array();
    dir[0] = "http://www.creativecorner.cl/";
    dir[1] = "http://www.sourcing.cl/";
    dir[2] = "http://www.feeds.cl/";
    dir[3] = "http://www.neonomade.com/";
    for(i = 0 ; i < dir.length ; i++){
        window.open(dir[i],'autowindow' + i,'width=1024,height=768');
    }
-->
</script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T12:42:10.710

将此写入硬盘上的文件名“links.html”：

```
<html>
<head><title>Your links</title></head>
<body>
Your links:<br />
<a href="XXX">XXX</a><br />
</body>
</html> 
```

用一个链接替换两个“XXX”，每个链接发出一个“链接”（a）行。您应该能够在大多数文本编辑器中通过少量搜索'n'替换来做到这一点。完成后，保存文件并在浏览器中打开它。

另一种选择是查看浏览器的书签文件并复制格式。您通常可以忽略“上次访问”等内容。只需添加链接。

如果您想在 JavaScript 中执行此操作，则需要使用带有 textarea 的表单。创建一个包含表单、JavaScript、文本区域和结果的 div 的小型 HTML 文档。

添加一个按钮，该按钮调用一个 JavaScript 函数，该函数从 textarea 获取文本，将其拆分为行并将上面的 HTML（仅链接行）创建为字符串。现在将此字符串分配给`innerHTML`div 的属性以使链接可点击。

# php - 从 PHP 脚本调用 fcsh

> ID：347969
> 
> 赞同：0
> 
> 时间：2008-12-07T19:41:21.287
> 
> 标签：php, apache-flex, fcsh

我的问题是是否可以从 PHP 脚本中调用 Flex 的 fcsh。这是背景：

我已经创建了一个简单的过程，它通过将文本文件转换为 .mxml 文件并使用 mxmlc 编译器编译为 .swf 文件来创建一个简单的测验/教程。这在命令行中效果很好，但我想通过创建一个 Web 界面来简化这个过程。我最初尝试使用 PHP 的 exec() 函数没有奏效。我用来创建 .mxml 文件的 Python 脚本工作正常（使用 exec()），但我无法让 mxmlc 编译器工作。

在网上和这个网站上搜索后，我相信使用 fcsh（而不是 mxmlc）可能是要走的路。使用 fcsh 肯定会更快地编译 .mxml 文件（在第一次运行之后），而且我认为 fcsh 可以作为可以从 PHP 调用的服务启动。

另一方面，也许我以错误的方式接近这个问题。编写一个调用 fcsh 并避免使用 PHP 的 Flex 应用程序会更好吗？

**编辑：**使用 fcshctl 作为他在下面的回答中建议的 hasseg 效果很好。谢谢阿里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T21:42:04.100

从脚本中调用 fcsh 的问题在于它作为*交互式 shell*工作，而不是接受命令行参数、编译和返回退出状态。有不同的方法可以解决这个问题，我在我的[这篇博客文章中](http://hasseg.org/blog/?p=194)列出了这些方法，我主要讨论的是`fcshctl`（这是我自己的解决方案），但在文章的底部我还列出了其他类似的将 fcsh 集成到非标准构建工作流程中的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T21:26:44.383

php 中还有其他几种方法可以执行外部脚本。它们是 exec()、passthru()、system() 和反引号，即 1 键左侧的键。每一个都有不同的目的和回报机制。

您可能必须将执行可执行文件的命令放入脚本中，并通过这些函数之一调用该脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T15:14:45.660

有什么特殊原因不能`mxmlc`直接使用吗？看起来它会比调用更容易`fcsh`。只需在 XML 文件中指定所有编译器选项，就可以像`mxmlc -load-config path/to/config.xml`. 您可以在 中找到 XML 配置格式的示例`FLEX_HOME/frameworks/flex-config.xml`。

# language-agnostic - 如何让编程课程保持有趣？

> ID：347994
> 
> 赞同：9
> 
> 时间：2008-12-07T19:59:43.387
> 
> 标签：language-agnostic

我想，以下是每所学校或大学的标准问题：

教授编程是你的工作。不幸的是，有些学生是半专业人士并且有多年的经验，而有些学生甚至不知道基本概念，例如“类型变量”的概念。

据我所知，这会导致以下情况之一：

1.  编程是从它的基础开始的。有经验的学生感到厌烦并停止参观讲座。结果，他们甚至会错过他们不知道的东西。
2.  教师和教授声称他们需要基本知识（无论这意味着什么）。没有经验的学生不能听课，他们中的很多人会专注于不重要的东西（例如，理解复杂示例的每个细节，但不了解示例背后的概念）。他们中的一些人会放弃。
3.  大学发明了一种人工编程语言，为有经验的程序员和新手提供“平等机会”。大多数学生会对“无用的语言”感到沮丧。

是否有第四种解决方案，比上面的解决方案更好？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-07T20:06:59.190

IMO 这是一个基于学生安置的问题，而不是你作为老师应该有兴趣处理的问题。

如果该课程是对计算机编程的介绍，那么您确实需要从基础开始。如果你的教室里全是知道如何编程的专业人士，但他们没有表现出来，要么是你的课程描述有问题，要么是学校强迫他们把这门课作为先决条件，而不允许他们测试.

你的工作应该是在课程描述中描述你想教什么，然后教它。如果学生入学资格过高，那就是他们的问题。如果你的课程真的是为初学者准备的，我认为你真正需要避免的唯一事情就是试图让课程对初学者来说太高级。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-07T20:06:21.113

我认为保持它有趣的最好方法是沿着理论提出实用和有趣的练习。采用解决问题的方法很棒（有趣、有趣、令人兴奋的现实问题）。这要求教授本人有实践经验，使用新技术并且非常了解它们，而不仅仅是教授他几十年前学到的东西。

问题是，编程应该通过实践来学习。教师应专注于激励学生编写代码并尝试自己解决问题。这可以通过在课程开始时分配一个完整的逼真的项目并解决课堂项目中出现的子问题来完成。这样，学生就会知道为什么编程语言中存在某些特定功能以及它可能有用的地方。

不过只是一个想法。没试过！;)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-07T20:17:18.920

我最近参加了一门课程，其中的学生在编程方面有非常广泛的经验。他们仍然设法通过制定练习计划来保持课堂上经验丰富的程序员的兴趣，在该计划中，他们对练习的实际部分（编程部分）进行计时，并将结果发布在高分图表中。在每堂课结束时，教授都会对我们如何进一步改善我们的时代提出一些建议。众所周知，所有工程师都喜欢争夺此类榜单的第一名，所以我们不断出现，甚至学到了一两件新东西。那些没有经验的学生也成功地完成了这些练习，即使他们并不太在意自己的时间。

不知道您的课程是否可以实施此解决方案，但如果是，您应该真正考虑一下。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T12:54:29.063

我认为您可以做一些事情来帮助弥合高级学生和初学者之间的差距，并让每个人都对课程感兴趣并参与其中。

## 高级研讨会

如果可以安排（使用博士生等）举办一个可选的每周研讨会，任何人都可以参加，但针对更有经验的学生。每周设置一个代码任务/挑战，然后在研讨会上讨论问题的各种解决方案，并讨论不同选择背后的含义和理论。

这为更有经验的编码人员提供了一个有趣的挑战，因为他们有一些东西可以进入。它引发了一些辩论，可以帮助中级人员掌握有趣的概念，如果你让人们提出他们的解决方案，它会引入一种有益的开放式审查风格。它还可以帮助初学者，因为您不必在主要讲座系列中向他们展示真正先进的概念，只是为了让有经验的人感兴趣。

## 学生参与

有经验的人通常是有经验的，因为他们喜欢编码等，而且很多人喜欢分享他们的知识。使用它并帮助初学者和高级学生的一个非常好的方法是让更高级的学生参与教学。如果您开设的课程/实验室让学生完成练习，请尝试从更有经验的学生那里招募志愿者担任实验室的导师/主管。当初学者遇到困难时，他们可以通过解释细节或微妙之处等来提供帮助。

这真的可以帮助初学者，因为通常没有足够的工作人员可以让每个人都能够提出个人问题。它也可以真正使更高级的人受益，因为必须解释你“知道”的概念是在你自己的脑海中强化它们的好方法，甚至发现你对自己的知识有微妙的误解。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T13:06:00.303

不要假设超出您的需要；尽量选择没有太多知识包袱的编程环境。您可能认为 C“Hello world”程序很简单，但这需要了解源文件、编译、静态类型和块结构。对于初学者来说，没有简单的概念。相比之下，在 Python shell 中键入“print 'hello world'”可以避免它们。声明、复合类型、面向对象、指针、浮点、递归、模块化、线程、回调、模块化、网络、数据库等都是需要努力学习的主要概念。而且，没有它们，还有很多有趣的事情要做。您的目标应该是让小组中的每个人尽快进行编程练习。

混合能力教学难；如果可以的话，通过拆分组来流式传输它。也许发布一个基本概念测验，并为那些没有得到 100% 的人提供一个可选的基本概念部分。有些人认为他们是经验丰富的程序员，但误解了基本思想。

如果可用的课程时间太短，无法让人们尝试大量练习，那么我会在放弃实际工作之前放弃更高级的材料。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T20:10:36.877

在我参加的一门课程中，课程成绩的很大一部分来自一个期末项目，该项目提前宣布，额外的学分可用于各种附加组件和装饰。有足够经验的学生可以开始研究它，而他们的准备不足的兄弟正在学习基础知识。

但正如戴夫马克尔所说，部分原因在于让合适的学生进入你的班级：你真的想要一个一开始就非常匹配的队列。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T20:14:06.713

如果你有很多有经验的学生，或者这是一门高年级学生/研究生水平的课程，你应该专注于融入现有的生态系统。能够理解并融入现有项目，而不是总是从头开始工作，这是你可以给予这些学生的最重要的技能。

因此，编程任务应该来自现实世界的场景。例如，在开源项目中为他们分配任务。这也可以使它更有趣，尤其是当他们的工作可能成为现实世界项目的一部分时。

如果它真的是初学者，运气不好，你将不得不坚持基础，但如果学生是非CS专业的，你可以从他们自己的领域（例如，工程，化学等）创造问题

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-07T21:13:27.140

我想你可能是吐司。

在某个点之后，差异只是很大。初学者要花一整年的时间才能理解那些不会让更高级的人感到厌烦的东西。

然而，这显然取决于主题和设置。对于这些的某些组合，解决方案被教授到课程收费的水平。进的进退，没经验的退退。不要太担心，因为无论如何都不应该上课。另一方面，如果他们需要上课，那么阶梯上的某个人就搞砸了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-08T12:37:51.047

坐在椅子上看别人说话很无聊（即使你说得很好）。

如果你能有所成就，当你能操纵世界并获得成功时，事情就会很有趣。因此，尽可能多地添加实践练习，并确保他们能够及时完成，并且能够及时成功地完成。

没有什么比听到更令人沮丧的了：“好吧，很抱歉你没能完成它。你可以在这里找到解决方案。让我们复制它并假装它确实有效，然后继续前进。” 课程中的示例很简单，您面前的人都知道这一点。因此，如果他们甚至无法解决您为他们带来的简单示例，他们会怎么想？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-08T12:57:35.703

我一直认为最好通过实践来学习。在课程开始时，尤其是在讲座中教授语言语法非常无聊。要求您的学生自己完成一些工作或在实验室与助手一起完成一些工作要好得多。这使经验丰富的学生可以快速完成工作。

完成此操作后，您可以进行讲座，讨论一些问题的解决方案。为什么他们是好的，为什么他们是坏的。

如果你的课程结构也让学生总是在他们之前的工作基础上进行构建，那么这种方法尤其有效。第一周可以很简单，比如计算我的生日还有多少天。一个在数学上相对简单但有一些奇怪情况的问题。对于没有经验的人来说，这可能需要几个小时。特别是如果他们同时学习语法。但这给了他们一个简单的努力目标。

在此之后，您可以消费它。例如：采取持续数周的程序并添加允许它批量处理文件的功能。这教会了人们重组和重构的重要性，并且可以一周又一周地扩展。您甚至可能希望将前一周的优秀作品分发给那些落后的人使用。显然，您需要确保人们不会落后太多，但这是确保每个人都觉得他们有公平机会的好方法，即使他们前一周的工作不太好。做得好的人会结束

关键是要让你的讲座保持相对较高的水平，让人们自己学习语法，或者与实验室助理一起学习。您可以教他们思考问题的不同方式，但编写代码的实际行为更容易通过这样做来学习。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-12T20:58:22.570

有一次，我经历了一场日程安排的噩梦，最终在同一间教室里同时教授初级班和高级班。我所做的是将我的时间分配在两个级别之间，首先是在我与初学者一起工作时给高级组一个在课堂上做的作业，然后在我与高级组一起工作时给初学者一个作业。你可以做类似的事情（只有让小组自行选择他们想加入的小组）。为更高级的准备一些额外的材料，然后您就可以参加比赛了。

另一种策略是将所有内容都保持在初学者的水平，但为更高级的学生提供一些其他材料来获得额外的学分（甚至可以替代您要求初学者完成的一些简单任务）。在课堂之外或在课堂上在实验室进行实际工作时与他们单独讨论更高级的作业。

用大量真实世界的例子来保持讲座的趣味性也很有帮助。我倾向于尽可能少讲课，更多地通过课堂讨论和实践练习以及通过提出引导性问题来呈现材料。让他们找到回答您问题的信息（课堂参与是成绩的一部分）将使他们更加关注。

我还以一个课程项目结束每个学期，我只描述了他们为了获得 B 必须做的事情。A 将涉及做超出课堂之外的工作，包括在课堂上未涵盖的领域的工作。然后，更高级的学生可以通过寻找非常酷的新事物来真正发光，甚至初学者通常也会找到一种方法来做课程未涵盖的事情。令人惊讶的是，当他们不知道自己还需要做多少才能获得 A 时，他们会付出多少额外的努力。其他教师会对我得到的课程项目结束的质量感到惊讶，其中一些人开始了使用相同的方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-17T04:38:28.253

最好用一些人所说的“入门编程”来划分几个关注领域：

1) 个人计算机和现代计算概论。假设本课程的软件是在windows上运行的，可能有一些需要涵盖计算机的基础知识，例如什么是硬盘、键盘、鼠标、显示器、CPU、主板等。注意这与计算机无关。甚至可能是除了命名操作系统之外的一行代码。对于某些人来说，这对他们来说可能是新的，因此开设一门涵盖基础知识的课程可能很值得。在本课程中还将介绍使用鼠标及其所有各种按钮的方法，人们拥有的各种电缆和连接方式，驱动程序是什么，补丁是什么，网络的组成部分是什么，例如防火墙，路由器，负载平衡器等。这里的想法不是要了解如何完美地配置防火墙，

2) 编程原理。这将从执行一系列命令的步骤开始。诸如打印和执行数学运算之类的事情，例如从英制到公制的转换，可能是最复杂的例子，从各种不同的算法和对大 O 表示法的基本理解来看，排序可能是最复杂的例子。

3) 数据结构和高级编程简介。现在，让我们介绍关系数据库的概念以及数据库的一般工作原理以及具有实际应用程序的项目，例如让每个学生列出他们拥有的东西，如 DVD 或 CD，并将它们放入数据库模式中以有效地存储所有这个数据。此外，浮点运算的想法及其局限性，例如计算机不存储 pi 的整个值，而是在大多数情况下应该足够好的近似值。

4) 并行编程和操作系统简介。在这里，您将在构建操作系统和处理如何编写可以并发或并行运行的代码以及各种程序在不同情况下的效率方面进行一些深入的工作。

这就是我可以看到有人打破编程的方式，因此它不是一个人可以在一周内学习到足以通过决赛而不看其他任何东西的地方。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-17T04:51:03.670

我经常遇到这种情况，首先是学生方面，然后是教学方面。

大多数学校都强制开设这类课程及其课程。这很愚蠢，但这就是生活。如果您的学校确实允许，我建议如果学生通过早期筛选测试，则可以免考。不要坐在一个有很大一部分人感到无聊的班级里，这符合你的利益和新生的利益。即使在一个房间里有很多人开始使用他们的笔记本电脑也会损害话语权。每个人都必须参加测试并提交作业，但他们至少不必出现。

一旦你和新手一起工作，弄清楚他们是专业的还是非专业的。非专业人士会讨厌上 CS 课程，你必须尝试让他们平易近人。例如，使用物理、化学或数学中的示例，而不是构建交互式 gui 系统。

如果他们是CS专业的，他们最好该死的有兴趣:)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-17T16:59:14.200

我的观点是，教授示例程序对大多数人来说非常无聊。7位ascii输入的搜索、排序、分类、使用unix & make、打开文件、写文件……

这些都是*无聊*的问题。不管它们的重要性/有用性如何，这些都是工具。不幸的是，工具是入门课程中教授的，而不是问题。

但是您需要能够解决问题的工具。所以这是一种鸡蛋问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-04T07:15:28.207

学生可以想象自己在空闲时间做的代码的真实世界示例。我记得一位老师告诉我使用 const 值，这是某种东西的税。我只需要在两个地方使用该值。她问我是否需要改变它，我说它只在两个地方，我会手动改变它，我也无法想象政府会改变税率。

我想不出一个不复杂的例子，我会使用一个 const 所以我不会尝试教他们使用它，但是对于数组我会简单地编写一个猜谜游戏，然后当玩家赢得游戏时，它会回放所有的猜测向他们订购。没有数组没有简单的方法可以做到这一点，我可以看到跟踪某人的步骤/猜测是如何有用的（吹嘘一个人猜得有多快）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-10-01T17:06:49.430

第一天给出教学大纲（他们将学到什么）和所需的基本知识（你必须知道的事情，否则不要参加这门课）并坚持下去。在这些之后，你所能做的就是教好（解释清楚，回答问题，不时开一两个笑话等等）。关心谁来上课，现场是否无聊，学生是否在先决条件上撒谎，谁听，另一个 yada yada 超出您的控制范围。此外，您应该期望成年人成为成年人。如果学生逃课和高分考试，也许这对他们来说是最好的。如果他们逃课和炸弹测试，那么他们可能是在错误的地方。

我讨厌大学时教授有这种心态。现在作为一个工作的专业人士，我明白了。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-02-13T00:27:07.660

以体育或电影为中心的编程练习。********