# StackOverflow 问答 10853000-10853999

# css - 导航中的三角形边缘出现锯齿状

> ID：10853001
> 
> 赞同：0
> 
> 时间：2012-06-01T15:19:05.147
> 
> 标签：css, navigation, geometry

我正在构建这样的导航：http: [//jsfiddle.net/techydude/XZLDq/](http://jsfiddle.net/techydude/XZLDq/)

我得到了其他成员的帮助，帮助我弄清楚如何用倾斜的边缘构建导航，但是边缘看起来并不平滑。有谁知道拉直边缘的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:01:00.520

我用 css3 skew 修复了它。 [http://jsfiddle.net/XZLDq/5/](http://jsfiddle.net/XZLDq/5/)

你可以用伪元素修复第一个和最后一个，就像你做的那样。

# javascript - 我可以使用正则表达式删除列表项吗？

> ID：10853003
> 
> 赞同：1
> 
> 时间：2012-06-01T15:19:08.317
> 
> 标签：javascript, jquery

我正在构建一个选择列表，如下所示：

```
var releases = data.suites.split(':');
$.each(releases, function(i, val){
    if (val) {
        var info = val.split('-');
        $('#testList').append('<option value="'+info[0]+'">'+info[1]+'</option>');
    }
}); 
```

每个条目的值和文本都以特定文本开头。是否可以使用 jquery 和正则表达式从我的列表中删除与此文本匹配的所有项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:38:57.887

如果您只想阻止创建目标项目，`.indexOf`请在循环中使用。

如果 DOM 中存在要删除的元素，您可以根据属性值的开头进行 DOM 选择。

```
 // Cache DOM selection!!! ;-)
var testlist = $('#testList');

    // remove existing elements where the "name" starts with "some_text"
testlist.find('option[name^="some_text"]').remove();

var releases = data.suites.split(':');
$.each(releases, function(i, val) {

       // Prevent creation when the val starts with "some_text"
    if (val && val.indexOf("some_text") !== 0) {
        var info = val.split('-');
        testlist.append('<option value="'+info[0]+'">'+info[1]+'</option>');
    }
}); 
```

# mysql - 完全删除 MySQL 5.7

> ID：10853004
> 
> 赞同：122
> 
> 时间：2012-06-01T15:19:08.713
> 
> 标签：mysql, ubuntu

我正在尝试从我的 ubuntu 12.04 完全卸载 mysql。但不能。

我尝试了很多命令。但没有任何工作。任何人都可以在这里帮忙！

```
sudo apt-get remove mysql-server mysql-client mysql-common
sudo apt-get autoremove 
```

我无法理解该怎么做。我想删除有关 MySQL 的所有内容。每当我试图找到它时。我明白了。

我希望一切都被删除。mysql-server、mysql-client、mysql-libraries 甚至配置。

请帮我！！！

* * *

## 回答 #1

> 赞同：363
> 
> 时间：2013-04-23T20:34:19.597

首先，使用以下命令备份所需的数据库`mysqldump`

> 注意：如果您想稍后恢复，只需备份相关数据库，而不是整个数据库，因为整个数据库实际上可能是您需要清除并重新安装的原因）。

**总的来说，这样做：**

```
sudo service mysql stop  #or mysqld
sudo killall -9 mysql
sudo killall -9 mysqld
sudo apt-get remove --purge mysql-server mysql-client mysql-common
sudo apt-get autoremove
sudo apt-get autoclean
sudo deluser -f mysql
sudo rm -rf /var/lib/mysql
sudo apt-get purge mysql-server-core-5.7
sudo apt-get purge mysql-client-core-5.7
sudo rm -rf /var/log/mysql
sudo rm -rf /etc/mysql 
```

**以上所有命令都在单行中（只需复制和粘贴）**：

```
sudo service mysql stop && sudo killall -9 mysql && sudo killall -9 mysqld && sudo apt-get remove --purge mysql-server mysql-client mysql-common && sudo apt-get autoremove && sudo apt-get autoclean && sudo deluser mysql && sudo rm -rf /var/lib/mysql && sudo apt-get purge mysql-server-core-5.7 && sudo apt-get purge mysql-client-core-5.7 && sudo rm -rf /var/log/mysql && sudo rm -rf /etc/mysql 
```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2012-08-08T16:49:54.087

您需要删除 /var/lib/mysql 文件夹。此外，当您移除包裹时进行清除（有人告诉我这有帮助）。

`sudo apt-get remove --purge mysql-server mysql-client mysql-common`

`sudo rm -rf /var/lib/mysql`

我遇到了类似的问题。第二行解决了我的问题，让我可以从头开始设置 MySql。希望对你也有帮助！

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-10-10T13:06:25.597

在终端中运行这些命令：

```
sudo apt-get remove --purge mysql-server mysql-client mysql-common

sudo apt-get autoremove

sudo apt-get autoclean 
```

单独运行这些命令，因为每个命令都需要确认，如果作为一个块运行，当前运行的命令下面的命令将取消确认（导致命令不运行）。

请参考[如何卸载 Mysql？](https://askubuntu.com/questions/172514/how-do-i-uninstall-mysql)

# php - PHP 回显 $substr

> ID：10853009
> 
> 赞同：0
> 
> 时间：2012-06-01T15:19:23.737
> 
> 标签：php

我写了这段代码：

```
<?php $offset = 0;  ?>
<?php  $Counter = 0; ?>
<?php $IsRD = 1; ?>
<?php $temp = 0;  ?>
<?php $TmpString = $_helper->productAttribute($_product, nl2br($_product->getprojector_compatibility()) , 'projector_compatibility');?>

<?php echo "<table border=\"0\" align=\"center\">"; ?>
<?php echo "<tr><th><h1>Compatibility:</h1></th></tr>"; ?>

<?php  if(strpos(  $TmpString, ";") == 0){  
    $Counter++; 
    $IsRD++;
    echo "<tr><td>The #$Counter is at position - 0 </td>";
 } ?>

<?php 
while($offset = strpos( $TmpString, ";", $offset + 1)){     

    if ($IsRD == 3) {
        $Counter++;
        $IsRD++;    
        echo "<td>" , $substr($TmpString,$temp,$offset-$temp) , "</td></tr><tr>";
        $IsRD=1;
        $temp=$offset;
    }
    else {
        $IsRD++;
        $Counter++;
**line 171** echo "<td>", $substr($TmpString,$temp,$offset-$temp),"</td>";
        $temp=$offset;
    }   
 } ?>
<?php echo "</tr></table>";  ?> 
```

当我运行它时，我得到了这个错误：

> 致命错误：函数名称必须是第 171 行 /home/...../view.phtml 中的字符串

我错过了什么/做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:21:03.410

从 substr 中删除“$”。

```
echo "<td>", substr($TmpString,$temp,$offset-$temp),"</td>"; 
```

PHP 试图查找未设置为任何值的变量“$substr”的值并将其用作函数名。由于没有设置 $substr，它使用值空字符串 "" 作为函数名，并产生关于非法函数名的（无用的）错误消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:21:44.407

`$`您在该行中的名称之前有一个额外的`substr`需要删除。

当前版本指示 PHP 查看（假设的）变量的内容，该变量`$substr`预计包含一个字符串，并调用名称等于该字符串的函数（PHP 调用此[*变量函数*](http://php.net/manual/en/functions.variable-functions.php)）。

当然`$substr`，您的代码中没有变量，因此会出现错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:23:16.610

该行必须是

```
substr($TmpString,$temp,$offset-$temp) 
```

不是

```
$substr($TmpString,$temp,$offset-$temp) 
```

您在回显行中也有错误的代码，例如：

```
echo "<td>" , $substr($TmpString,$temp,$offset-$temp) , "</td></tr><tr>"; 
```

用点（字符串连接运算符）替换逗号并用美元符号（$）做我上面写的

```
echo "<td>" . substr($TmpString,$temp,$offset-$temp) . "</td></tr><tr>"; 
```

以及更好的可读性编码风格：

```
echo "<td>". substr($TmpString,$temp,$offset-$temp) ."</td></tr><tr>"; 
```

# c# - 从 DirectorySearcher 获取 6000 条记录中的 2000 条

> ID：10853011
> 
> 赞同：1
> 
> 时间：2012-06-01T15:19:28.613
> 
> 标签：c#, asp.net, active-directory, directoryentry

我有一个代码，它要么得到 1000，要么使用`DirectorySearcher`.

但我只想得到 6000 个结果中的 2000 个。

这是获得 6000 个结果的代码，而我只想要 2000 个结果

```
mySearcher.SizeLimit = 2000;
mySearcher.PageSize = 1000;

SearchResultCollection results = mySearcher.FindAll();

int totalUsers = results.Count; 
```

请帮忙。

谢谢

我的研究表明 PageSize = 0 只给出 1000 个结果，而 Pagesize = 1000 给出所有结果。

需要更多帮助才能完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:41:29.443

根据这篇文章：[DirectorySearcher.FindAll() - 应该有 PageSize=1000](http://geekswithblogs.net/mnf/archive/2005/12/20/63581.aspx)

`SizeLimit`*在这种情况下*无关紧要，因为正在使用服务器端默认值，默认值为 1000 个结果。我从来不需要这样的页面，但我想使用最小大小限制（在您的大小限制和服务器大小限制之间 - 刚刚在我自己的 AD 中测试过）。您`PageSize`确实在分页，但是它在后台进行分页并仅返回最终流，据我所知，这就是您获得所有结果的原因。

我相信您最简单的解决方案是在此之上使用 Linq 并执行`.Take(2000)`结果。这将以额外的带宽和服务器上的处理为代价获得您想要的结果。

如果您真的想对其进行排序，我想您将不得不将服务器的默认分页大小更新为更高（尽管出于管理原因我怀疑这是否可行）。

编辑：

以下是我粗略处理的方法（来自我的 LinqPad 的快速工作示例代码 - 另请注意，我实际上带来了一切，这与您可能希望通过将 for 循环排除在等式之外）：

```
using(DirectoryEntry de = new DirectoryEntry("LDAP://domain.local/dc=domain,dc=local", "user", "password"))
using(DirectorySearcher ds = new DirectorySearcher(de))
{
    ds.Filter="(&(objectCategory=user)(objectClass=user))";
    ds.PageSize= 1000;
    ds.PropertiesToLoad.Clear();
    ds.PropertiesToLoad.Add("objectGuid");

    var results = ds.FindAll();
    var searchResults = results.Cast<System.DirectoryServices.SearchResult>().ToArray();
    int myDesiredPageSize = 2000;

    var upns = new StringCollection();

    for(var step=0; step < Math.Ceiling((double)results.Count / myDesiredPageSize); step++)
    {
        Parallel.ForEach(searchResults.Skip(step*myDesiredPageSize).Take(myDesiredPageSize), result => {
        using(var entry = result.GetDirectoryEntry())
        {
            entry.RefreshCache(new[]{ "userPrincipalName" });

            if(entry.Properties.Contains("userPrincipalName"))
                upns.Add(entry.Properties["userPrincipalName"][0] as string);
        }
        });
    }

    upns.Count.Dump();
} 
```

这在我的测试场景中通过我的局域网连接在大约 3 秒内返回大约 1400 个结果。由于我们正在并行查询更高的数字，因此不应线性扩展。此外，您可能希望在某种程度上包含并行化，因为这会无情地打击 AD :)

在我的正常操作中，我使用带有`WhenChanged`AD 对象属性的缓存来将我的实际查询减少到仅更改的对象，而不是一遍又一遍地加载相同的东西，这只会在第一次被击中，随后的结果是几分之一秒。采用这种方法，您可以完全取消分页，只需在启动时加载您的属性，然后如果可以选择仅提取更改的条目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:34:20.533

该物业似乎有[一些](http://geekswithblogs.net/mnf/archive/2005/12/20/63581.aspx)奇怪的[行为](https://groups.google.com/group/microsoft.public.adsi.general/browse_frm/thread/6f6beffdb4860ef9/dfe85fbdbedac088?pli=1#dfe85fbdbedac088)`PageSize`。
请设置为`0`，这样行吗？

顺便说一句：
[c# Active Directory Services findAll() 只返回 1000 个条目](https://stackoverflow.com/questions/3488394/c-sharp-active-directory-services-findall-returns-only-1000-entries)

[我可以从 Asp.Net 中的 DirectorySearcher 获得超过 1000 条记录吗？](https://stackoverflow.com/questions/90652/can-i-get-more-than-1000-records-from-a-directorysearcher-in-asp-net)

# c# - Windows Mobile App 查询 SQL 数据库但参数无法正常工作

> ID：10853014
> 
> 赞同：0
> 
> 时间：2012-06-01T15:19:33.433
> 
> 标签：c#, sql, tsql, windows-mobile

我有一个使用 MSFT 同步框架并正在查询 sql 数据库的 Windows Mobile 应用程序。

这是代码：

```
private void buttonStart_Click(object sender, EventArgs e)
        {
            using (SqlCeConnection conn = new SqlCeConnection(
          ("Data Source=" + (Path.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().GetName().CodeBase), "Barcode.sdf") + ";Max Database Size=2047"))))
            {

                // Connect to the local database 
                conn.Open();
                using (SqlCeCommand cmd = conn.CreateCommand())
                {
                    SqlCeParameter param = new SqlCeParameter();
                    param.ParameterName = "@Barcode";
                    param.DbType = DbType.String;
                    param.Value = textBarcode.Text.Trim();

                    // SELECT rows
                    cmd.CommandText = "SELECT Location, Reading FROM Main WHERE Barcode LIKE @Barcode";
                    cmd.Parameters.Add(param);

                    DataTable data = new DataTable();

                    using (SqlCeDataReader reader = cmd.ExecuteReader())
                    {

                        data.Load(reader);
                        this.dataGrid1.DataSource = data;

                    }

                }
            }
        } 
```

这是表格： ![桌子](../Images/2cf2794518cb34c10b917a8d18e0e1f4.png)

因此，当我将查询更改为此：

```
 cmd.CommandText = "SELECT Location, Reading FROM Main WHERE Barcode LIKE 'NGM0001'"; 
```

它返回正确的结果。但是当 NGM0001 在 textBarcode 中并输入时，不会返回任何结果。让我相信这一定是参数的问题。我有相同的代码段在另一个解决方案中工作，所以我不确定出了什么问题。

此外，所有 db 字段都是 nvarchar(50) 类型。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:26:58.280

上面的代码是正确的。我重新编译并再次测试了该应用程序，它工作正常。我不确定是什么问题。

# python - 在 Python 的循环中创建多个变量/字符串

> ID：10853016
> 
> 赞同：2
> 
> 时间：2012-06-01T15:19:45.430
> 
> 标签：python, string, loops

我正在尝试创建一个看起来像这样的程序：

```
 self.b1 = Checkbutton(self, variable=self.b1v, text="1.")
          self.b1.grid()
          self.b2v = IntVar()
          self.b2 = Checkbutton(self, variable=self.b2v, text="2.")
          self.b2.grid()
          self.b3v = IntVar()
          self.b3 = Checkbutton(self, variable=self.b3v, text="3.")
          self.b3.grid()
          self.b4v = IntVar() 
```

嗯，有点像那样，只是...... 30+次。必须有更好的方法来做到这一点。但是，我不知道如何循环执行此操作。我想它看起来像这样：

```
 while i <= 32:
                 n = "self.b" + str(i) + "v = IntVar() \n"
                 n += "self.b" + str(i) + " = Checkbutton(self, variable=self.b" + str(i) + "v) \n"
                 n += "self.b" + str(i) + ".grid()\n"
                 exec(n) 
```

...或类似的东西...但这会引发错误：

```
 Traceback (most recent call last):
  File "/Users/jonahswersey/Documents/toggle flags.py", line 126, in <module>
    app = Application()
  File "/Users/jonahswersey/Documents/toggle flags.py", line 93, in __init__
    self.createWidgets()
  File "/Users/jonahswersey/Documents/toggle flags.py", line 117, in createWidgets
    exec(m)
  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/lib-tk/Tkinter.py", line 2337, in __init__
    Widget.__init__(self, master, 'checkbutton', cnf, kw)
  File "/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/lib-tk/Tkinter.py", line 1923, in __init__
    BaseWidget._setup(self, master, cnf)
  File "/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/lib-tk/Tkinter.py", line 1903, in _setup
    if cnf.has_key('name'):
AttributeError: IntVar instance has no attribute 'has_key' 
```

...而只是手动输入它们不会。有人对我有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T15:25:59.447

像这样的东西？

```
num_buttons = 3
self.b_vars = [IntVar() for i in range(num_buttons)]
self.b = [CheckButton(self, variable=self.b_vars[i], text="%d." % (i + 1)) for i in range(num_buttons)]
for button in self.b:
    button.grid() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:24:58.017

你正在寻找[`setattr()`](http://docs.python.org/library/functions.html#setattr).

# eclipse - 如何在 Eclipse 插件中确定 Java 源文件的绝对文件路径？

> ID：10853018
> 
> 赞同：5
> 
> 时间：2012-06-01T15:19:51.710
> 
> 标签：eclipse, eclipse-plugin

在我的自定义 Eclipse 插件中，我将 Java 类的完全限定类名作为字符串，并且想知道它的实际文件路径。事实上，我想知道它所在的源文件夹的名称。

该类可以来自工作区中的任何 Java 项目。源文件夹名称是任意的。

我使用 Eclipse 3.6。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T03:20:57.730

您将不得不使用搜索引擎 API。见`org.eclipse.jdt.core.search.SearchEngine`。

您可以看到可以调用各种静态函数，每个函数都有自己的选项。您将需要创建一个适当的`org.eclipse.jdt.core.search.SearchPattern`，然后将其与范围（工作区）和请求者（收集所有结果的东西）一起传递给搜索引擎。

通常，您会得到一堆东西，比如`IType`s，它们是用于访问 Java 模型中的类型的公共 API。您可以调用`IType.getResource().getLocation()`以获取任何类型的文件系统位置。getResource 方法可能返回 null，因此您需要检查它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T17:11:09.910

您将需要使用[JDT API 的东西](http://help.eclipse.org/indigo/topic/org.eclipse.jdt.doc.isv/guide/jdt_int_model.htm)来访问`IResource`Java 类。从那里您可以使用 Resource API 来获取包含的文件夹以及您需要的任何其他内容。

# ios - 如何将按钮添加到 iPad 弹出框内的工具栏？

> ID：10853038
> 
> 赞同：1
> 
> 时间：2012-06-01T15:21:04.567
> 
> 标签：ios, sdk, uibarbuttonitem, uitoolbar, popover

希望这里有人已经征服了这个，因为它让我发疯。我的应用程序包含一个用于输入和编辑信息的弹出框。我今天了解到，可以在弹出框的底部显示一个工具栏，这很棒——除了我一辈子都无法在所述工具栏上显示任何按钮。这是我们开始的地方：

```
UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController: editorViewer];
//*** This makes the toolbar visible
[navigationController setToolbarHidden:NO animated:NO];
//*** Create a 'trash' button
UIBarButtonItem *trashButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemTrash target: nil action: @selector(deleteItem)]; 
//*** Create an array of buttons
NSArray *buttons = [NSArray arrayWithObjects: trashButton, nil]; 
```

我尝试了以下每种方法来添加按钮，但均未成功：

```
navigationController.toolbar.items = buttons; 
```

和

```
[navigationController setToolbarItems: buttons] 
```

和

```
[navigationController.toolbar setItems: buttons animated: NO]; 
```

我有一个非常小的工具栏，没有按钮。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:46:17.053

当您在导航控制器上设置工具栏隐藏状态时，工具栏项目取自导航控制器的顶视图控制器的 toolbarItems 属性。

在你的情况下

```
editorView.toolbarItems = buttons; 
```

或者

```
[editorView setToolbarItems:buttons]; 
```

尽管

```
[navigationController setToolbarHidden:NO animated:NO]; 
```

保持原样。

# php - php / js - 页面卸载时如何删除文件？

> ID：10853041
> 
> 赞同：1
> 
> 时间：2012-06-01T15:21:11.153
> 
> 标签：php, javascript, ajax, onbeforeunload

我在这里有一个问题，我不确定它是否可能，但我想在用户离开页面时删除一个文件......我目前有一个 php 脚本（*见下文*），它处理文件的删除，但是我不知道页面卸载时如何运行它？

```
<?php
include 'js/db/db.php';
$film = $_GET['film'];
$movie = $_GET['org_film'];
$user = $_COOKIE['user'];
$filename = "movies/".$user."/".$film.".mp4";
if (file_exists($filename)) {
    unlink($filename);
    header('location: storage.php');
}
else{
    $filename = "movies/".$user."/".$film.".m4v";
    if (file_exists($filename)) {
        unlink($filename);
        header('location: storage.php');
    }
    else{
        echo " file doesn't Exist"; 
    }
}
?> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:28:12.093

您的主脚本/应用程序必须跟踪每个服务器请求存储在数据库中的用户活动。

每 x 分钟运行一次由 cron 作业安排的 php 脚本，向 DB 询问最后的用户活动（日期/时间）。在 y 分钟无活动后删除文件。

只是一个想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:31:17.747

From your code it looks like you're creating a temporary file so that you can deliver a video to a specific user for a specific amount of time. This is a highly inefficient approach. You'd be better off:

1.  Using your database to track which users have access to which videos, and how how long
2.  On a request to the video page, assert that the user has the right to access that file and, if the assertion passes, generate a *signed url* which is valid only for a short period of time and which may be used in the video page to deliver your movie.

A signed URL would look something like:

```
http://path.to/your/movie.m4v?timestamp=2309583240&signature=234p9345u234234092wjdfl 
```

Where timestamp is the current UNIX timestamp and signature is a SHA1 hash of the timestamp and some secret known only to your application.

Amazon S3 supports this feature - you could also store the movie files on Amazon S3 with limited read privileges, and use one of the many popular S3 libraries to generate time-limited signed URLs for your users.

This would obviate the need to shift large files around the disk, and thereby greatly increase performance. It would also scale better as the maximum concurrent viewers would no longer by tied to disk size.

# ios - 使用分享工具包在 Facebook 上分享图片

> ID：10853047
> 
> 赞同：0
> 
> 时间：2012-06-01T15:21:26.567
> 
> 标签：ios, xcode, sharekit

就像标题一样，我只是按照这个网站的步骤操作：

[http://labs.grupow.com/blog/2012/03/05/sharekit-2-dot-0](http://labs.grupow.com/blog/2012/03/05/sharekit-2-dot-0)

并且运行应用程序没有任何错误，但是关于按显示操作表的共享按钮的结果，存在一些问题。

第一次按下“Facebook”后，进入授权页面，在右上角，有一个“登录”按钮。当第二次时，它只显示“还好”。我知道这是正常的，没有任何问题。但是，主要问题是，我无法在 Facebook 墙上分享我的图像。还有文字。我想知道解决这个问题的方法。

（我英语不好..）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T21:07:21.890

很可能您没有正确配置 Facebook 的单点登录 (SSO) 回调。

从 sharekit 的[install wiki](https://github.com/ShareKit/ShareKit/wiki/Installing-sharekit)执行第 7 步。

# android - Activity 的后台线程和配置更改

> ID：10853049
> 
> 赞同：1
> 
> 时间：2012-06-01T15:21:34.147
> 
> 标签：android, multithreading, configuration, android-activity, orientation

我在 Stack Overflow 上看到了一些关于使用 Activity.onRetainNonConfigurationInstance() 来维护由 Activity 的一个实例启动的后台线程并将其传递给 Activity 的下一个实例的讨论，例如，当手机的方向发生变化时从纵向到横向。

讨论并没有具体说明包裹在从 onRetainNonConfigurationInstance() 返回的 Object 中的线程可以做什么。

例如： 1\. 有没有办法使用这种技术真正保持后台线程运行？2.当之前的Activity实例消失时，你是否需要以某种方式暂停线程，然后在新实例中重新启动它？

谁能提供一个简短的例子？

任何细节将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:26:32.050

您可以退回任何您想要的东西`onRetainNonConfigurationInstance()`。如果你有一个 Thread 想要从 Activity 的一个实例传递到另一个实例，你可以直接返回它，或者将它放在另一个你从中返回的对象中`onRetainNonConfigurationInstance()`。您无需暂停线程或以任何方式与其交互。它只是继续运行，好像什么都没发生一样。

您唯一需要关心的是线程如何与活动交互（如果有的话）。如果线程将回调 Activity（以指示进度或类似的东西），那么您需要以某种方式为线程提供对新 Activity 的引用，因为旧的 Activity 将失效。

你想在你的后台线程中做什么？

**编辑（添加有关线程/活动的更多详细信息）：**

线程有自己的生命周期，它们与活动完全断开。如果您在 Activity 中创建一个 Thread 并启动它，无论您的 Activity 做什么，它都会运行到完成。唯一会显式停止线程的是 Android 决定终止您的进程（如果您的进程不包含活动的活动，它可能会这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:32:19.467

线程将继续运行。有关可以使用此操作的示例，您可以查看 android [Ignition](https://github.com/kaeppler/ignition)项目及其`IgnitedAsyncTask`（和相关示例）。

这个想法是你将`AsyncTask`在你的某个地方维护对你的线程（通常是一个）的引用`Activity`，并且偶尔你的线程（再次，特别是如果它是一个`AsyncTask`）将需要一个对 a 的引用`Context`，以便在结束时执行某种 UI 更新其后台任务。您需要确保您的线程引用的`Context`（以及从它派生的任何东西——如 a`TextView`等）是非空的，否则它将崩溃。

您可以使用`getLastNonConfigurationInstance()`设置`Activity`对线程的引用，然后在线程上调用 setter 来设置其`Context`引用（以避免任何相关的空指针崩溃）。

# r - R 是否存在依赖于系统的功能？

> ID：10853050
> 
> 赞同：6
> 
> 时间：2012-06-01T15:21:38.227
> 
> 标签：r, interop, operating-system

我的同事希望确保我们在 R 中的工作是独立于平台的，特别是代码可以在 Linux、Mac 和 Windows 上运行，并且在一个系统上创建的文件可以在其他系统上运行。

由于这个问题以前在我的小组中出现过，我希望得到一个一般性的答案，这将使我更容易自信地向我的合作者保证不会有问题。[例如，除了“因为（主题专家）](https://stackoverflow.com/users/143305/dirk-eddelbuettel)这么说”之外，还有其他参考资料会有所帮助。

1.  一般来说，有没有办法知道 R 的任何特性是否是特定于平台的（我可以假设这将在函数的帮助中说明）？
2.  是否有我可以确信将独立于平台的包或功能？
3.  我应该警惕哪些类型的包或功能？

我之前问过两个关于 R 创建的文件的跨平台可读性的问题：[与 HDF5 或 netCDF 相比，使用 .Rdata 文件有哪些缺点？](https://stackoverflow.com/q/7838027/199217)和[R 对象是否使用“转储”可读的跨平台转储？](https://stackoverflow.com/q/10840741/199217)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:26:15.937

除了卡尔的回答之外，确保您的工作独立于平台的*明显*方法是在所有平台上进行*测试。*

这正是 CRAN 对其 3800 多个软件包所做的事情，您可以在[此处](http://cran.r-project.org/web/checks/check_summary.html)访问日志。

简而言之，R 真的很努力地独立于平台，并且大部分都成功了。要对您的代码执行此操作，您应该避免使用引入依赖关系的 API 或工具。看看抽象类`system.file(package="boot")`和它们使用的函数——您可以轻松抽象文件系统“根”，并且已经处理了分隔符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:21:43.550

检查 cran.r-project.org 以获取软件包列表。每个包都有一个页面，它会告诉您它是否通过了针对不同操作系统的测试。此外，正如您所建议的，帮助文件非常明确地说明了操作系统的依赖关系。对于那些在 Windows 中工作的可怜人来说，R 足够“聪明”，可以将路径名中的“/”转换为“\”。一般来说，图形访问是最有可能具有平台依赖性的领域。显然，如果您的系统缺少 {X11, ImageMagick, ..} 您无论如何都会被卡住。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T16:51:19.493

Besides Carl's and Dirk's comments, you should understand that any package that requires compilation from source (as do many (all?) packages that are on Omegahat, Rforge or r-forge) will need to be done on a machine that has the proper C and Fortran libraries. Some interesting packages depend on GTK+ and Tcl/Tk, and there may be a need to make sure you can get the right versions. The [http://r.research.att.com/](http://r.research.att.com/) page that Simon Urbanek maintains is a useful resource for keeping up with supporting resources for Macs.

# java - spring jdbctemplate：设置值中的空指针异常

> ID：10853053
> 
> 赞同：0
> 
> 时间：2012-06-01T15:21:39.870
> 
> 标签：java, spring, nullpointerexception, jdbctemplate

我的错误

```
 java.lang.NullPointerException.
 MyDAO$2.setValues
    org.springframework.jdbc.core.JdbcTemplate$2.doInPreparedStatement(JdbcTemplate.java:680)
    org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:454)
    org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:676)
    org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:738)

net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:149)
org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:694)
org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:122)
org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)
org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:144)
org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:639) 
```

我的代码是

```
 this.jdbcTemplate.update(SOME_SQL_UPDATE, new PreparedStatementSetter() {
                    public void setValues(PreparedStatement ps) throws SQLException {
                        ps.setBoolean(1, myObj.isVal1());
                        ps.setString(2, myObj.getVal2().toString());
                    }
                });

public class myObj {
    private boolean val1;
    private Enum val2;
} 
```

我的布尔值 db 列是 number(1,0)，我设置的字符串列是 varchar。

注意：我使用的是 spring 1.2，目前正在升级到 spring 3。

有什么问题？

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:26:49.107

你确定`myObj`不为空吗？看起来它可能是该语句中唯一可以为空的对象。您能否对方法内的对象进行简单的空检查以确认？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:26:14.893

在您的班级中，和`myObj`的值永远不会被初始化。`val1``val2`

# ios - 在 iOS 上使用 admob 跟踪方法是否安全？

> ID：10853060
> 
> 赞同：1
> 
> 时间：2012-06-01T15:22:29.600
> 
> 标签：ios, app-store, admob, analytics, uuid

我想以某种方式知道用户何时从 admob 按下广告，并知道从应用商店下载的应用是否来自对广告的点击。

在有关此链接的 admob 文档中：http: [//support.google.com/admob/bin/answer.py ?hl=en&topic=1623717&answer=1704628](http://support.google.com/admob/bin/answer.py?hl=en&topic=1623717&answer=1704628)

它说这可能违反苹果关于收集 UUID 的裁决，是否有任何方法可以使用？或者是否有机会被苹果拒绝使用它们？

是否有任何方法可以跟踪从应用商店下载的点击？

# .net - 是否可以在具有 SOAP 对象的服务上使用多态性？

> ID：10853061
> 
> 赞同：4
> 
> 时间：2012-06-01T15:22:31.670
> 
> 标签：.net, wcf, serialization, polymorphism

我在 WCF 服务中创建了一些数据类，以在服务和客户端之间来回传输数据。因此，这些“对象”用 [ServiceContract] 和 [DataMember] 装饰，因此暴露给客户端，以便我可以实例化一个，填充它并将其发送到服务。现在，我注意到我可以在服务中使用多态性，但是我在客户端和服务之间没有那么幸运。例如

在服务中，有一个名为 Ticket 的类和一个从 Ticket 派生的名为 MOCTicket 的类。还有一种方法接受 Ticket 作为参数。通常，我应该能够向该方法发送一个 MOCTicket 对象，并且它会正常工作，因为它派生自 Ticket，并且我可以在服务中执行此操作。但是，如果我在 CLIENT 端实例化 MOCTicket 对象并尝试将其发送到接受 Ticket 的服务方法，则会引发错误。我猜这是一个序列化问题。

我只是对我可以从这些数据类中获得的那种行为感到困惑。你得到一些但没有其他的。就像我不能序列化行为/方法或构造函数一样，但我可以序列化延迟加载的属性（或者看起来如此）。无论如何，如果有人可以帮助我实现我上面描述的或者如果有可能的话。任何关于这些“对象”的额外说明也将不胜感激。我用谷歌搜索试图找到答案，但找不到任何写得足够清楚来回答这个问题的东西。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:25:49.620

您是否尝试过传递接口并使用 ServiceKnownType 属性，而不是向/从服务传递类？

有关示例，请参见[链接。](https://stackoverflow.com/questions/310160/passing-interface-in-a-wcf-service)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:26:00.453

我想我找到了我要找的东西，至少在这个阶段。通过向服务方法添加额外的装饰，我可以告诉序列化程序期望什么类型：

```
[ServiceContract]
public interface IService1
{
    [OperationContract]
    [ServiceKnownType(typeof(SvcBaseTicket))]
    [ServiceKnownType(typeof(SvcMOCTicket))]
    bool DoStuff(SvcBaseTicket user);
} 
```

然后像这样调用将起作用：

```
using(var client = new MyClient())
{
   var ticket = new SvcMOCTicket();
   if(client.DoStuff(ticket))
   {
      //do things
   }
} 
```

我进行了测试以确保返回“基类”类型的服务类实际上是变相的派生类，并且返回了所有附加属性，并且确实如此。以及一个名为“ExtensionData”的新属性。奇妙吧。

# selenium - 异常“SocketError”getaddrinfo：提供节点名或服务名，或未知

> ID：10853063
> 
> 赞同：1
> 
> 时间：2012-06-01T15:22:50.027
> 
> 标签：selenium, watir, watir-webdriver

升级到 selenium-webdriver gem 2.22.1 后，我开始收到此错误。

b = Watir::Browser.new :firefox

基本上没有启动浏览器（OSX 10.6.8, ruby​​ 1.8.7），并且 ruby​​ 调试模式显示以下输出。

/Library/Ruby/Gems/1.8/gems/selenium-webdriver-2.22.1/lib/selenium/webdriver/common/platform.rb:153 的异常“SocketError”-getaddrinfo：提供节点名或服务名，或未知

我经历了此处报告的类似问题并尝试了解决方案，例如确保 /etc/hosts 中存在 localhost 条目并且端口未被任何其他进程使用等。

让我知道需要更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T14:29:16.930

显然[这是一个错误](http://code.google.com/p/selenium/issues/detail?id=4020)，现在已在 selenium-webdriver 2.22.2 中修复

# sharepoint - 在 C# 中创建 Sharepoint 2010 Webpart 页面

> ID：10853067
> 
> 赞同：1
> 
> 时间：2012-06-01T15:23:01.030
> 
> 标签：sharepoint, publishing, sharepointfoundation2010, webpartpage

我想以编程方式为 Sharepoint 2010 创建一个 Webpart 页面（.aspx 文件）。我已经找到了这个代码片段：

```
public static PublishingPage CreatePage(string fileName, string title)
  {
     PublishingWeb pWeb = PublishingWeb.GetPublishingWeb(Web);
     PageLayout[] layouts = pWeb.GetAvailablePageLayouts();
     PageLayout layout = layouts[0];
     foreach (PageLayout p in layouts)
     {

        if (p.Name.Equals("BlankWebPartPage.aspx"))
        {
           layout = p;
           break;
        }
     }
     try
     {
        PublishingPage newPage = pWeb.GetPublishingPages().Add(fileName, layout);
        newPage.Title = title;
        newPage.Update();
        return newPage;
     }
     catch (Exception)
     {
           return null;
     }
  } 
```

但我的问题是 SharePoint Foundation Server 没有发布部分，但我必须在 SharePoint Foundation Server 上运行它。是否可以在没有 PublishingWeb 的情况下创建 Webpart 页面？

打招呼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T17:44:48.917

发布基础结构是仅在 SharePoint Server Standard 或 Enterprise 中可用的功能之一。它不包含在 SharePoint Foundation 2010 中。它也不包含在 Windows SharePoint Servives (WSS) 中。发布始终需要购买的产品版本。

# sql - Coldfusion Query of Query missing results from date BETWEEN 子句

> ID：10853068
> 
> 赞同：1
> 
> 时间：2012-06-01T15:23:01.677
> 
> 标签：sql, date, coldfusion, between

我有一个来自查询的查询，称为 AllPosts 的查询。

AllPosts 有两个结果：

```
Row 1| ID: 2   PublishedDate: 2012-05-30 16:47:00.0
Row 2| ID: 3   PublishedDate: 2012-05-31 15:50:00.0 
```

当我对名为 FilterPosts 的 AllPosts 进行查询时，使用

```
WHERE PublishedDate BETWEEN '2012-05-01 00:00:00' AND '2012-05-31 23:59:00' 
```

（请注意，实际查询是为这些值执行 cfqueryparam cf_sql_date）

我希望 FilterPosts 与 AllPosts 具有相同的行，但我只得到 ID 2。如果我将 ID 2 的发布日期更改为`2012-05-30 23:59:50.0`，FilterPosts 会返回正确的结果。

我也试过

```
WHERE PublishedDate >= '2012-05-01 00:00:00'   
AND   PublishedDate <= '2012-05-31 23:59:00' 
```

5 月 31 日有一些特别奇怪的地方。

我在这里拔头发！谢谢！

我尝试从头开始构建原始查询，奇怪的是，结果相同！

```
<cfset test = queryNew("Name,PublishedDate", "VarChar, Time" )>
<cfset queryAddRow(test)>    
<cfset querySetCell(test,"PublishedDate","2012-05-30 16:47:00.0")>     
<cfset querySetCell(test,"Name","First Entry")>    
<cfset queryAddRow(test)>    
<cfset querySetCell(test,"PublishedDate","2012-05-31 15:47:00.0")>    
<cfset querySetCell(test,"Name","Second Entry")>    

<cfset StartDate = CreateDate(2012, 5, 1)>

<cfquery name="filter" dbtype="query">    
    SELECT Name, PublishedDate    
    FROM    test
WHERE    1=1
AND PublishedDate >= <cfqueryparam value="#StartDate#" cfsqltype="cf_sql_date">
AND PublishedDate <= <cfqueryparam value="#DateAdd( 'n', -1, DateAdd('m', 1, StartDate) )#" cfsqltype="cf_sql_date">
 </cfquery> 
```

Filter 的结果只有“FirstEntry”，而不是两者都应该。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:28:21.813

你没有说你使用的是哪个数据库，但如果是 ODBC 或 MSSQL，我通常会这样做：

```
WHERE PublishedDate >= '2012-05-01'
AND PublishedDate < '2012-06-01' 
```

基本上，您将一天添加到要包含的结束日期并使用小于运算符。省略时间可以防止内部构造日期的方式出现任何异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:54:19.867

奇怪的是，它与 cfqueryparam 有关。我一直在使用 CreateDate() 创建我的开始/结束日期，如下所示：

```
<cfset StartDate = CreateDate(2012,5, 1)> 
```

我在我的 SQL WHERE 查询中使用它，如下所示：

```
WHERE PublishedDate >=  <cfqueryparam value="#StartDate#" cfsqltype="cf_sql_date"> 
```

它是`cf_sql_date`。应该是`cf_sql_timestamp`日期将其限制为 5-31，因此当天晚些时候在 5-31 发布的任何内容都被省略了。时间在减少。

感谢大家的意见。

修复遗留代码摇滚！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:32:46.767

尝试通过`timepart`从日期时间中删除来进行比较。所以你`between`应该看起来像

```
WHERE PublishedDate BETWEEN '2012-05-01' AND '2012-05-31' 
```

# php - PHP JQuery 和 Jeditable

> ID：10853069
> 
> 赞同：0
> 
> 时间：2012-06-01T15:23:04.400
> 
> 标签：php, jquery, mysql, jeditable

只是一个关于我遇到的这个问题的快速问题。我正在使用 jeditable 来编辑页面上的某些字段。这是完美的工作。现在我想实现一些数据检查。我有我的 php 代码来检查输入的数据，如果它正确，它会更新该数据库，如果不是，它将返回错误。我遇到的问题是我希望它吐出错误来告诉他们，但是当他们再次单击该字段进行编辑时，它会在该字段中显示错误，直到页面刷新。我想要它做的是在错误发生后单击该字段时在该字段中具有相同的数据，而不必刷新页面然后再次单击该字段进行编辑。也许有一种方法可以返回错误并将其传递到该字段上方的某种工具提示中？当然 jeditable 的工作方式是 div 围绕该字段然后我有一些 js 调用我的 update.php 文件，这会解析 jeditable 传递给它的内容并返回一个 $value 以进行错误检查，默认情况下它是否很好简单地在 php "return $value;" 的底部 将其保存在数据库中后放回他的字段。

希望有人能理解我在这里提出的问题，并且我们将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:42:00.653

讨厌当我这样做时，在这里发布然后自己找出答案......但至少如果有人遇到同样的问题，他们会看到它。我发现了 jeditable onsubmit 功能...我在编辑字段时使用工具提示在悬停时显示，因此这会将工具提示设置为错误并且不提交数据，除非它是有效的 mac。

```
 function isMAC(value) {
            teststr = value;
            regex=/^([0-9a-f]{2}([:-]|$)){6}$|([0-9a-f]{4}([.]|$)){3}$/i;
            if (regex.test(teststr)){
                    return true;
            }
            else {
                    return false;
            }
    }

    $(".edit_mac").editable("edit_mac.php", {
            onsubmit: function(settings, data) {
                    var input = $(data).find('input');
                    var value = input.val();
                if (isMAC(value)) {
                            return true;
                } else {
                            //display your message
                            $("#tooltip").html("Bad MAC Address...");
                            return false;
                    }
            },
          indicator : "Saving...",
          submitdata: { _method: "put" },
          submit : 'Save',
          cssclass : "editable",
          type : "text"
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:44:44.660

最简单的方法可能是进行一些客户端验证。现在，您正在通过在提交表单时签入 PHP 来进行服务器端验证。你在检查什么？没有代码很难给你一个客户端验证的好例子。

**基本字段检查：**

```
var check_field = $("#field").val();
if (!check_field) { alert("Error message"); } else 
{ 
   // submit POST or whatever 
} 
```

**编辑**

由于 MAC 地址验证算法已经写在服务器端，我推荐一个单独的 ajax POST 请求，调用 checker 函数。获取该请求的结果（真，假）并在客户端检查它。如果为真，请继续更新调用。

例子：

```
$("#form").submit(function() {
var mac = $("#macfield").val();
if (!mac) { alert("MAC address can't be empty!"); } else 
{ 
   $.POST("checkmacaddress.php", {macval: mac}).success(function(a){
       //assuming a comes back as a bool
       if (!a) { alert("Invalid MAC!"); } else
       {
          // if the checker returned true, update the record
          $.POST("update.php" ...);
       }
   });
} }); 
```

这不包括 checkmacaddress.php 但如果您手头已有该功能，您应该能够处理它。

# php - 在不使用 javascript sdk 的情况下添加 facebook 评论框

> ID：10853070
> 
> 赞同：0
> 
> 时间：2012-06-01T15:23:04.390
> 
> 标签：php, facebook, facebook-comments

我在我的网站上使用 facebook 评论框 我在该页面上有一个无限加载页面（使用 ajax 和 jquery 创建） 当更多使用无限滚动评论框加载的帖子不起作用时，评论框仅显示在第一页上的帖子上.

我认为这是因为 javascript sdk。

有没有办法在不使用 javascript sdk 的情况下向网站添加评论框？通过使用 iframe 之类的？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:35:11.640

[社交插件 - 评论框](http://developers.facebook.com/docs/reference/plugins/comments/)不再支持 iframe，因此您必须使用 HTML5 或 FBML 路由，它们都需要 Facebook 的Javascript [SDK](http://developers.facebook.com/docs/reference/javascript/)。

我认为[FB.XFBML.parse](http://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/)是您正在寻找的。

> 此函数动态解析和呈现文档中的 XFBML 标记。如果您通过 ajax 从服务器发送 XFBML 并希望在客户端呈现它，则可以使用此方法。XFBML 使您能够将 FBML 合并到您的网站和 IFrame 应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:39:18.657

如果是滚动问题，试试这个：

```
window.fbAsyncInit = function() {
    FB.Canvas.setAutoGrow();
}
// Do things that will sometimes call sizeChangeCallback()
function sizeChangeCallback() {
    FB.Canvas.setSize({ width: 520, height: 1400 });
} 
```

# linux - JVM 中的交换性

> ID：10853074
> 
> 赞同：1
> 
> 时间：2012-06-01T15:23:17.130
> 
> 标签：linux, apache, tomcat, jvm, jvm-crash

上周我偶然发现了一些有趣的问题，我注意到我们的一个生产服务器，它运行 Tomcat 上的Apache [HTTP](https://en.wikipedia.org/wiki/Apache_Tomcat)[服务器](https://en.wikipedia.org/wiki/Apache_HTTP_Server)，停止，报告 HTTP 中断。

在进一步调查这个问题时，它似乎是由于 JVM 导致内存页面被快速换出。这导致交换空间被完全填充，从而在下次将页面移动到交换时导致内存问题。

进一步调查，我们的一些 Linux 发行版似乎有一个 JVM 交换因子默认设置为 60%。根据一些研究，对于具有高流量的 Web 服务来说，这似乎具有很高的价值。我们的交换空间设置为 2 GB。

交换详情如下：

```
 Filename                                Type            Size    Used    Priority
 /dev/sda3                               partition       2096472 1261420 -1

 From /proc/meminfo
 SwapCached:     944668 kB 
```

我们的JVM属性如下：

-Xmx6g -Xms4g -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:PermSize=512M -XX:MaxPermSize=1024M -XX:NewSize=2g -XX:MaxNewSize=2g -XX:ParallelGCThreads=8

服务器运行 12 GB RAM。

Swappiness 不适合 JVM 的[GC](https://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29)进程。因此，我尝试将 swappiness 降低到 0，但这并没有改变任何东西。我们仍然看到整个交换空间被消耗并导致 OutOfMemory 错误的情况。

如何调整 JVM 性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T13:12:17.830

[交换因素](http://kerneltrap.org/node/3000)实际上是 Linux 中的系统范围设置，而不是特定于 JVM 。

我对某些应用程序的个人经验是，它们需要关闭交换才能正常工作。虽然我不能确定您的应用程序是否属于此类别，但我看到尽管有足够的可用 RAM 可用，但应用程序被换出。正如您所指出的，GC 和交换不能很好地混合。交换性只是对操作系统的一个指示，因此它对交换出多少的影响可能会更大或更小，具体取决于具体情况。我的建议是尝试完全关闭交换。

为此，您需要是 root 或具有`sudo`访问权限。注释掉描述 swap in 的行`/etc/fstab`，这将防止重新启动后打开 swap。然后，为了关闭当前服务器运行的交换，运行`swapoff -a`. 如果需要将交换中的数据拉回 RAM，这可能需要几分钟。然后，检查输出的最后一行`free`以确保可用交换的总大小为 0。在此之后，观察您的应用程序以确定关闭交换是否解决了您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T17:37:28.723

如果您的物理 RAM 为 12 GB，并且您的堆设置为仅 6 GB（最大），那么您有足够的 RAM。该服务器是否专用于 Tomcat 实例？

查看详细的 GC 日志文件，了解一段时间内的内存使用情况。检查您的访问日志文件以确认访问请求是否随时间增加。

# c++ - 向量 析构函数

> ID：10853076
> 
> 赞同：2
> 
> 时间：2012-06-01T15:23:23.237
> 
> 标签：c++, memory-management, vector

我有一个定义如下的类：

```
Class A
{
public:
    int num;
    A *parent;
    vector<A *> children;
    ...

    // constructor without parameters
    A(void)
    {
        this->num = 3;
        this->parent = 0;
        for (int i=0;i<num;++i)
            children.push_back(new A(this,num-1));
    }

    // constructor with parameters
    A(A *a,int n)
    {
        this->num = n;
        this->children->parent = a;
        for (int i=0;i<num;++i)
            this->children.push_back(new A(this,this->num-1));
    }
}; 
```

现在，构造函数工作正常。析构函数有一些问题。目前，析构函数定义为：

```
A::~A(void)
{
    if (this->parent!=0) this->parent = 0;
    for (int i=0;i<(int)children.size();++i)
        this->children[i]->~A();
    vector <A *> ().swap(this->children);
} 
```

但是每次我调试它时，它都会中断：

```
void deallocate(pointer _Ptr, size_type)
    {    // deallocate object at _Ptr, ignore size
    ::operator delete(_Ptr);
    } 
```

看起来我无法删除 this->children 向量中的指针，有什么方法可以成功解构类吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:28:17.900

你的析构函数应该是：

```
A::~A(void)
{
    for (size_t i=0; i < children.size(); ++i)
        delete children[i];
} 
```

您可能还应该研究复制构造函数。否则，这样的代码将失败：

```
{
    A foo;
    B bar = foo;
} 
```

因为您将两次删除相同的指针。

这两个帖子之一可以帮助您理解：[1](https://stackoverflow.com/questions/3740471/c-copy-constructor-pointer-object)和[2](https://stackoverflow.com/questions/781760/how-to-define-a-copy-constructor-with-pointers-in-it)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:27:39.777

在 A 的析构函数中，不应显式调用子项的析构函数，而只需删除向量的元素。这应该足以满足您的目的：

```
A::~A(void)
{
    for (size_t i=0; i<children.size(); ++i)delete children[i];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T19:10:51.317

您的带参数的构造函数中有一个错字错误 -`this->children->parent`不会编译，因为`children`它不是指针也没有`vector`成员`parent`。我怀疑你打算`this->parent`改用。

您的析构函数直接调用每个子对象的析构函数，这将销毁子对象但不会释放其内存。您使用运算符分配子对象`new`，因此您需要使用`delete`运算符来调用析构函数并正确释放内存。

在旁注中，您的`num`成员是多余的。您可以在需要的`children.size()`地方使用`num`。

试试这个：

```
class A 
{ 
private:
  static const int default_num = 3;

public: 
    A *parent; 
    vector<A *> children; 
    ... 

    // default constructor
    A() 
    { 
        parent = 0; 
        for (int i = 0; i < default_num; ++i) 
            children.push_back(new A(this, default_num-1)); 
    } 

    // constructor with parameters 
    A(A *a, int n) 
    { 
        parent = a; 
        for (int i = 0; i < n; ++i) 
            children.push_back(new A(this, n-1)); 
    } 

    ~A()  
    {  
        parent = 0;  

        for (vector<A *>::size_type i = 0; i < children.size(); ++i)  
            delete children[i];  
        /*
        alternatively:
        for (vector<A *>::iterator i = children.begin(); i != children.end(); ++i)  
            delete *i;  
        */

        children.clear(); // optional, will be handled when vector is implicitally destructed
    }  
}; 
```

# android - Android目标SDK版本和手机

> ID：10853080
> 
> 赞同：1
> 
> 时间：2012-06-01T15:23:28.510
> 
> 标签：android, sdk, build-target

所以我前段时间写了一个Android应用程序，我正在尝试更新它。我想在代码部分中构建，如果他们使用的手机低于 3.0，则以一种方式做某事，否则以另一种方式做。

我的构建目标在 project.properties 文件中设置为 11，但它似乎仍然可以在 < 3.0 的 Android 版本上运行？这是正常的吗？我会在某个时候看到一些崩溃吗？一切似乎都在工作...我的 minSDKVersion 是 8，但是当我在 Android 2.3.3 上使用 Android 3.0 代码运行此应用程序时会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:26:12.943

它通常可以在 API 级别 8 的平台上正常运行，因为这就是您的`minSdkVersion`. 但是，如果您尝试调用在 11 级或更高级别引入的任何 API，它将在早期（11 之前）平台上崩溃。为避免这种情况，您应该在调用任何此类方法之前在运行时检查操作系统版本。有关如何执行此操作的建议，请参阅以[编程方式检索 Android API 版本。](https://stackoverflow.com/questions/3423754/retrieving-android-api-version-programmatically)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:35:18.157

在进行此类开发时，通常最好从较低的 API 开始工作。每次完成 API 的工作版本时，请确保它在升级到下一个级别之前编译没有错误。如果你的 targetSdkVersion 和你的 minSdkVersion 不同，清单会警告你；但是，这主要是为了确保您小心不要从更高的 API 调用方法。一个有用的解决方法可能是：

```
 private static int getApiLevel() {
            return Integer.parseInt(android.os.Build.VERSION.SDK);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T15:44:17.207

我想我有一个愚蠢的时刻。如果我将 minSDK 设置为 8，那么任何比 8 更新的都可以正常工作。如果我将构建目标设置为 11，然后在 SDK 早于 11 的手机上运行任何高于 8 的代码之前进行检查，那么这应该涵盖所有基础。

当我弄乱 targetSDK 和 minSDK 时，我有点困惑

感谢您的评论。

# ruby-on-rails - Taps gem 很慢

> ID：10853085
> 
> 赞同：0
> 
> 时间：2012-06-01T15:23:46.213
> 
> 标签：ruby-on-rails, postgresql, heroku, taps

我目前正在使用 Taps 从 Heroku 将一个 postgree 数据库导入我的机器。

数据库大约 5MB，有大约 20k 个对象。

到目前为止，大约需要 15 分钟。

知道为什么要花这么长时间，有什么办法可以加快速度吗？我无法想象当数据库增长 100 万个对象并且我需要做一些移动时以这种方式工作。

```
messages:      100% |==========================================| Time: 00:11:07 
```

（那是一张只有 14k 个对象的表）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:01:59.867

如果您有（免费）pgbackups 插件并且您不介意恢复转储的额外步骤，那么下载备份可能会快很多。

[https://devcenter.heroku.com/articles/pgbackups](https://devcenter.heroku.com/articles/pgbackups)

# java - JMock - 几个不同参数的调用

> ID：10853087
> 
> 赞同：6
> 
> 时间：2012-06-01T15:23:58.390
> 
> 标签：java, unit-testing, jmock

我要测试的方法是调用具有不同参数的模拟方法：

```
public void methodToTest(){
   getMock().doSomething(1);
   getMock().doSomething(2);
   getMock().doSomething(3);
} 
```

在我的单元测试中，我想知道，methodToTest 是否真的使用这些参数调用这些方法。这是我写的代码：

```
@Test
public void myMockTest(){
    oneOf(mock).doSomething(1);
    oneOf(mock).doSomething(2);
    oneOf(mock).doSomething(3);
} 
```

在 (2) 我得到一个“意外调用” - 好像它无法区分不同的参数。所以我试过那个：

```
exactly(3).of(mock).doSomething(with(Matchers.anyOf(same(1), same(2), same(3)))); 
```

但这也没有达到我的预期。

最后，这个工作：

```
exactly(3).of(mock).doSomething(with(any(Integer.class))); 
```

所以我知道，我的方法被**任何**整数调用了 3 次。有什么办法可以确保这**正是**我通过的论点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T13:16:30.033

您是否用检查块围绕期望？

```
context.checking(new Expectations() {{
  oneOf(mock).doSomething(1);
  oneOf(mock).doSomething(2);
  oneOf(mock).doSomething(3);
}}); 
```

另外，您是否知道 jmock 不强制执行序列，除非您明确这样做？

# jquery - 存储 jQuery $.get 函数将数据返回到类全局变量

> ID：10853094
> 
> 赞同：0
> 
> 时间：2012-06-01T15:24:28.390
> 
> 标签：jquery, json, class, variables

如何让 jQuery $.get 将 json 数据检索存储到类变量行业或产品中？

如果您查看从 $.get 调用到 php 文件返回的数据，那么它确实返回了一个 json 数组，是的，我可以使用这些信息，但对我来说更重要的是存储在全局变量中返回的内容班级简介。

```
Profile=new Profile("kazie.php");
Profile.getProfile(0123, 'Kayla', 'kayla@email.com');

var Profile = function(php_file){
    this.php_file=php_file;
    this.serial;
    this.industry;
    this.product;
    //Also need to access scope as well 
};

Profile.prototype={

    getProfile:function(serial, name, email){

        $.get(this.php_file,{action: "retrieve_profile", serial: serial, name: name, email: email},
            function (data){ //Return a json array of our new profile
                    //Data is an array of properties. array("industry"=>"Retail");
                   //I need to assign these properties to my global variables for
                    //***How to I get data["industry"] to store in Profile.industry?**

                }, "json"
            );

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:43:20.110

尝试这个：

```
...
function (data){
          Profile.prototype.industry = data.industry
     }, "json"
);
... 
```

这应该将行业存储到您的类的原型中。如果您不想将其存储到原型中（这将使其在所有实例中都可用），那么您只需将其存储在您需要的实例中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:34:30.280

[.getJSON](http://api.jquery.com/jQuery.getJSON/)函数的文档将为您提供有关如何处理返回的 JSON 的一些想法（请注意，您不需要切换到此函数，它们是等效的，因为您指定了“json”，.getJSON 是方便的方法）。它比我解释得更好。

# c# - 未找到存储过程、字段或属性的问题？

> ID：10853104
> 
> 赞同：0
> 
> 时间：2012-06-01T15:24:59.200
> 
> 标签：c#, sql, gridview, boundfield

我正在尝试内部连接`asp_Users`和`asp_Membership`表，以便我可以从我拥有的a中检索该`CreateDate`字段。`asp_Membership``BoundField``GridView`

我尝试了以下对我来说似乎有意义的方法，但它不断抛出错误：

`A field or property with the name 'CreateDate' was not found on the selected data source.`

```
 ALTER PROCEDURE [dbo].[stp_Customer_Fetch_Paged]
    (
        @sortExpression nvarchar(100),
        @startRowIndex int,
        @maximumRows int
    )
    AS
    BEGIN
        -- SET NOCOUNT ON added to prevent extra result sets from
        -- interfering with SELECT statements.
        SET NOCOUNT ON;

        -- Make sure a @sortExpression is specified
        IF LEN(@sortExpression) = 0 
            SET @sortExpression = 'aspnet_Users.UserId'

        -- Issue query
        DECLARE @sql nvarchar(4000)
        SET @sql = '
        SELECT userid, username, first_name, last_name, town,postcode, rowrank FROM (
    SELECT     aspnet_Users.UserId, aspnet_Membership.UserId as MembershipID, aspnet_Membership.CreateDate, aspnet_Users.UserName, Customer.title, Customer.first_name, Customer.last_name, Customer.telephone, 
                          Customer.dpa_consent, Customer.billing_address_id, Address.friendly_name, Address.address_line_1, Address.address_line_2, 
                          Address.address_line_3, Address.town, Address.postcode, ROW_NUMBER() OVER (ORDER BY ' + @sortExpression + ' ) AS RowRank
    FROM  Customer INNER JOIN
                          aspnet_Users ON Customer.userid = aspnet_Users.UserId 
                          INNER JOIN
                          Address ON Customer.billing_address_id = Address.address_id AND Customer.userid = Address.user_id
                          INNER JOIN
                          aspnet_Membership ON
                          aspnet_Membership.UserId = aspnet_Users.UserId

        ) AS ProductsWithRowNumbers
        WHERE RowRank > ' + CONVERT(nvarchar(10), @startRowIndex) + 
        ' AND RowRank <= (' + CONVERT(nvarchar(10), @startRowIndex)+ ' +  ' +
        CONVERT(nvarchar(10), @maximumRows) + ')'

        print @sql

        -- Execute the SQL query
        EXEC sp_executesql @sql

    END 
```

尽管我在存储过程中选择了它。我对 SQL 很陌生，所以它可能是我忽略的一些简单的东西？任何帮助是极大的赞赏。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:30:20.080

您的最外层`SELECT`子句不包括该列：

```
SELECT userid, username, first_name, last_name, town,postcode, rowrank 
```

需要是

```
SELECT userid, username, first_name, last_name, town,postcode, CreateDate, rowrank 
```

# c# - 格式化文本框以仅接受数字和空格以及加号

> ID：10853106
> 
> 赞同：1
> 
> 时间：2012-06-01T15:25:13.167
> 
> 标签：c#, .net, winforms

我正在尝试制作一个`text-box`只接受数字、空格和加号的。

目前我`KeyPressEvent`在`textbox`

```
if (!char.IsDigit(e.KeyChar) && !char.IsControl(e.KeyChar) &&!char.IsWhiteSpace(e.KeyChar))
    {
                e.Handled = true;
    } 
```

我也想接受这个`+`标志

**更新**

我确实处理了，`!char.IsSymbol(e.KeyChar)`但它也会接受这个`=`标志`+`

任何帮助！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:45:33.437

对于“输入期间”控制和验证控制，您可以进行类似的操作。

但是你的文本框中会有很多东西（1+++ +2 34+），这并不意味着很多......

```
textBox.KeyDown += (sender, e) =>
                               {
                                   if (!(
                                       //"+
                                       e.KeyCode == Keys.Add || 
                                       //numeric
                                       (e.KeyCode >= Keys.NumPad0 && e.KeyCode <= Keys.NumPad9) || 
                                       //space
                                       e.KeyCode == Keys.Space))
                                   {
                                       e.Handled = true;
                                   }
                               };
textBox.Validating += (sender, eventArgs) =>
                                  {
                                      var regex = new Regex(@"[^0-9\+ ]+");
                                      textBox.Text = regex.Replace(textBox.Text, string.Empty);
                                  }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:23:34.790

添加

`var reg = new Regex(@"^\+?(\d[\d-. ]+)?(\([\d-. ]+\))?[\d-. ]+\d$");`

作为正则表达式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:41:33.770

严格来说你可以追加

```
 && !e.KeyChar == '+' 
```

符合您的标准，它应该就键盘输入而言可以工作，但如果目标是只允许数字输入，.net 控件库还包含一个可以解决问题的 NumericUpDown 控件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-15T16:10:18.273

这对我来说很好：

```
if (!(char.IsLetter(e.KeyChar) && (!char.IsControl(e.KeyChar) 
    && !char.IsDigit(e.KeyChar) && !(e.KeyChar == '.'))
{
    e.Handled = true;
} 
```

我添加了 char.IsControl，因为它允许您在类型错误的情况下使用 Backspace。

# css - XPages 中的浮动工具栏/操作栏/按钮栏？

> ID：10853111
> 
> 赞同：1
> 
> 时间：2012-06-01T15:25:34.843
> 
> 标签：css, xpages, xpages-extlib

有没有人有一个类似于 Lotus Notes 客户端中的操作栏的 xXages 浮动工具栏？

我希望工具栏在浏览器滚动时保持在浏览器的顶部。

扩展页面工具栏看起来很不错，但首先它只处理客户端代码，而且它似乎没有浮动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T17:53:54.570

浮动是您可以使用 CSS 和以下内容执行的操作：

```
position: fixed;
top: 0; 
```

对于 XPages 扩展库 xe:toolbar 控件，您需要在自定义样式表中使用覆盖以下样式类：

```
.tundra .dijitToolbar {
  position: fixed;
  top: 0;
} 
```

然后你有一个浮动工具栏，当用户滚动时它会停留在窗口的顶部。

xe:toolbar 也执行服务器端代码，因为它使用 TreeNodes 和 onItemClick 事件，您可以在其中添加服务器端代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:30:48.587

谢谢已经想出了几乎相同的答案。这是一个CC。

```
<xp:view xmlns:xp="http://www.ibm.com/xsp/core">

<xp:this.resources>
    <xp:styleSheet href="/PNC001.css"></xp:styleSheet>
</xp:this.resources>
<xp:panel id="toolbar" styleClass="PNCToolBar">

    <xp:callback facetName="ButtonBar" id="callback1"></xp:callback>
</xp:panel> 
```

CSS

```
.PNCToolBar {
position:fixed;
top:0px;
left:0px;
width:100%;
height:46px;
color:#fff;
background:#F2F2F2;
padding-top:6.0px;
padding-left:15.0px
 } 
```

# actionscript-3 - 与 ActionScript 3 相关

> ID：10853116
> 
> 赞同：0
> 
> 时间：2012-06-01T15:25:54.097
> 
> 标签：actionscript-3

我正在使用 AS3 创建拖放游戏。这是我用来进行拖放的代码。游戏将为用户提供提示，用户必须将三个选项中的特定答案拖到正确位置。此编码将允许用户选择所有三个选项。我想要做的是限制用户选择多个选项。有人可以帮我弄这个吗？

```
var myArray:Array = [apple, grapes, gava];
var matchImage:Array = [imgApple, imgGrapes, imgGuava];
var posArray:Array = [ {x:55.3, y:55.6}, {x:100.45, y:100.6}, {x:300.5, y:250.7} ];
var currentClip:MovieClip;
var Xpos:Number;
var Ypos:Number;

for(var i:int = 0; i < wordArray.length; i++) {
    myArray[i].buttonMode = true;
    myArray[i].addEventListener(MouseEvent.MOUSE_DOWN, item_onMouseDown);
}

function item_onMouseDown(event:MouseEvent):void {
    currentClip = MovieClip(event.currentTarget);
    Xpos = currentClip.x;
    Ypos = currentClip.y;
    addChild(currentClip); 
    currentClip.startDrag();
    stage.addEventListener(MouseEvent.MOUSE_UP, stage_onMouseUp);
}

function stage_onMouseUp(event:MouseEvent):void {
    stage.removeEventListener(MouseEvent.MOUSE_UP, stage_onMouseUp);
    currentClip.stopDrag();
    var index:int = myArray.indexOf(thisClip);
    var equalClip:MovieClip = MovieClip(matchImage[index]);
    if(matchImage.hitTestPoint(thisClip.x, thisClip.y, true)) {
        currentClip.x = posArray[index].x;
        currentClip.y = posArray[index].y;
        currentClip.removeEventListener(MouseEvent.MOUSE_DOWN, item_onMouseDown);
        currentClip.buttonMode = false;
    } 
    else
    {    
    currentClip.x = startXposition;
        currentClip.y = startYposition;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:42:46.240

一旦在任何剪辑上检测到 MouseEvent.MOUSE_DOWN，您应该删除其他剪辑上的侦听器，这将防止它们被拖动。

完成拖动后，您可以将它们添加回来以允许用户再次开始拖动。

# android - 我可以让按钮显示为已禁用并仍然监听点击吗？

> ID：10853117
> 
> 赞同：13
> 
> 时间：2012-06-01T15:25:58.653
> 
> 标签：android

我想将一个按钮变灰，使其对用户显示为禁用，但仍会监听点击，以便我可以向用户显示一条消息，解释为什么该按钮不适用。

我想确保 Android API 是一个配置适当的标准禁用外观的 API，而不是手动将按钮颜色设置为灰色等。最好的方法是什么？

相关：[Android - 收听禁用的按钮](https://stackoverflow.com/questions/9016015/android-listen-to-a-disabled-button)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-02T07:10:45.550

这是自定义按钮，当禁用它时会显示触摸事件，它肯定会工作，并经过测试。专为您设计

```
public class MyObservableButton extends Button
{
public MyObservableButton(Context context, AttributeSet attrs)
{
    super(context, attrs);
}

private IOnClickWhenEnabledListner mListner;

public void setOnClickWhenEnabledListener(IOnClickWhenEnabledListner listener) {
    mListner = listener;
}

private interface IOnClickWhenEnabledListner {
    public void onClickWhenEnabled();
}

@Override
public boolean onTouchEvent(MotionEvent event)
{       
    if (event.getAction() == MotionEvent.ACTION_DOWN) {
        if (!isEnabled() && mListner != null) {
            mListner.onClickWhenEnabled();
        }
    }

    return super.onTouchEvent(event);
}

} 
```

从我作为 android 开发人员的角度来看，这是完成您想要的事情的正确方法。

扩展所有android的视图没有问题，并在xml文件上使用它们，而不是源..

祝你好运

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-01T15:36:30.310

您还可以手动将 Button 的背景设置为禁用的默认背景。但是保持按钮启用并以正常方式处理点击事件

像这样的事情应该这样做：

```
mBtn.setBackgroundResource(android.R.drawable.btn_default_normal_disabled); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:30:18.000

我不是 Android 专家，所以可能有更好的方法，但是禁用按钮并覆盖将捕获事件的透明视图呢？

您可以让视图始终位于按钮下方，因此您只需要更改 z-index 或在需要时动态创建它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-01T05:25:31.067

如果您的按钮位于通过`backgroundTint`而不是控制颜色的较新类型上，那么`background`您应该这样做：

```
if (enabled) {
    ViewCompat.setBackgroundTintList(btn, getResources().getColorStateList(R.color.button_states)); // either use a single color, or a state_list color resource
} else {
    ViewCompat.setBackgroundTintList(btn, ColorStateList.valueOf(Color.GRAY));
}
// make sure we're always clickable
btn.setEnabled(true);
btn.setClickable(true); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-06-01T15:38:17.823

由于按钮扩展了文本视图。您可以使用 textview 中的方法，例如 .setTextColor() 或 .setBackgroundColor() 。

现在对于显示，您有 2 个选项：

*   AlertDialog - 显示警报，但除非指定，否则不会自行关闭。
*   Toast - 在给定时间内显示文本并自动关闭。

任你选。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-06-01T15:37:13.127

您还可以将`Button`' 的样式设置为灰显（对于按下和未按下状态），然后`setOnClickListener()`像往常一样，但让`onClick()`方法给出它不可点击的消息。

# image-processing - 使用 VIPS 命令行将图像切割成图块

> ID：10853119
> 
> 赞同：4
> 
> 时间：2012-06-01T15:26:00.137
> 
> 标签：image-processing, imagemagick

我有一个大的 Tiff 图像，我想将它切成 512x512 的图块并写入磁盘。

在过去，我像这样使用 ImageMagick：

```
convert -crop 512x512 +repage image_in.tif image_out_%d.tif 
```

但是最近这一直不起作用，进程内存不足等。

VIPS中是否有类似的命令？我知道有一个 CLI，但我在文档中找不到示例或有用的解释，我仍在尝试找出 nip2 GUI 的东西。任何帮助表示赞赏。:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-08T11:38:12.870

[libvips](https://libvips.org)有一个操作员可以很快地为您完成这项工作。尝试：

```
$ vips dzsave wtc.tif outdir --depth one --tile-size 512 --overlap 0 --suffix .tif 
```

那是 DeepZoom 作家制作深度 1 的 tif 瓷砖金字塔。查找`outdir_files/0`输出图块。文档中有一[章](https://libvips.org/API/current/Making-image-pyramids.md.html)讨论如何使用 dzsave。

对我来说，它比 IM 快得多：

```
$ time convert -crop 512x512 +repage huge.tif x/image_out_%d.tif
real    0m5.623s
user    0m2.060s
sys     0m2.148s
$ time vips dzsave huge.tif x --depth one --tile-size 512 --overlap 0 --suffix .tif
real    0m1.643s
user    0m1.668s
sys     0m1.000s 
```

`huge.tif`10,000 x 10,000 像素的未压缩 RGB 图像在哪里。此外，它只会在少量内存中处理任何大小的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T09:44:34.463

我遇到了同样的问题。似乎 VIPS 没有像上面的 imagemagick 那样的内置命令，但是您可以使用一些脚本（Python 代码片段）来做到这一点：

```
for x in xrange(0, tiles_per_row):
    xoffset = x * tile_size
    for y in xrange(0, tiles_per_row):
        yoffset = y * tile_size
        filename = "%d_%d_%d.png" % (zoom, x, y)
        command = "vips im_extract_area %s %s %d %d %d %d" % (base_image_name, filename,  xoffset, yoffset, tile_size, tile_size)
        os.system(command) 
```

但是，您不会获得与 imagemagick 裁剪相同的速度......

# django - 以编程方式设置 Django 管理员权限

> ID：10853123
> 
> 赞同：10
> 
> 时间：2012-06-01T15:26:21.783
> 
> 标签：django, django-admin

我正在开发的 Django 站点可以让用户注册一个帐户。为了给他们提供一些编辑功能，我使用了内置的 Django admin。但是，我遇到了一个问题：用户注册后，他们在 Django 管理员中没有任何权限，甚至没有查看权限。因此我的问题是：我如何在代码中为相关模型的用户分配管理员权限，就像在管理员中编辑用户时我可以在“用户权限”部分手动分配它们一样？我已经尝试过[通常](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.has_add_permission) `has_xxx_permissions()`使用自定义`ModelAdmin`类，但这没有用。所以我的猜测是我忽略了一些明显的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T15:34:05.760

[https://docs.djangoproject.com/en/dev/topics/auth/default/#permissions-and-authorization](https://docs.djangoproject.com/en/dev/topics/auth/default/#permissions-and-authorization)

```
new_user.user_permissions.add(permission1, permission2, etc...) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-01T15:50:54.940

出于您的目的，将所有新用户分配到特定组，然后为该组提供用户所需的所有权限可能会更加容易和有效。该组的任何成员也将继承这些权限。

您可以在管理员中创建组并为其分配权限。然后，您只需将以下内容添加到您的注册码中。

```
try:
    group = Group.objects.get(name='The User Group')
except Group.DoesNotExist:
    # group should exist, but this is just for safety's sake, it case the improbable should happen
    pass
else:
    user.groups.add(group) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-02T15:58:37.137

[dgel](https://stackoverflow.com/users/473232/dgel)的回答为我指明了为我找到可行解决方案的方向。从本质上讲，他似乎在暗示的是：

1.  检索要为其设置权限的模型的[ContentType 。](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#django.contrib.contenttypes.models.ContentType)在这种情况下，内容类型是一个包含[有关 Django 模型的信息](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/)的对象。
2.  使用[.](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.models.models.Permission) _ `Permission.objects.get()`_ 这里唯一的困难是找出`codename`参数，对于管理员权限，该参数由操作（“添加”、“更改”或“删除”）、下划线和模型名称组成。因此，如果您有一个名为的模型`Foo`并且您想为其创建所有权限，您将需要 3 个权限，每个权限都包含`Foo`模型的内容类型以及代码名称`add_foo`、`change_foo`和`delete_foo`。
3.  使用 分配这些权限`user.user_permissions.add(permission)`。

前往 dgel 的[代码](https://stackoverflow.com/questions/10131271/invalid-literal-error-when-adding-a-user-permission-to-a-django-user-object/10131510#10131510) [示例](https://stackoverflow.com/questions/10252332/how-to-add-permissions-in-django-to-models-and-test-it-using-the-shell/10252613#10252613)答案。查看`manage.py dumpdata auth`现有 Django 数据库的身份验证应用程序 ( ) 的数据转储也让我对权限的内部工作有了深入的了解。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-01-10T16:16:14.927

自从我在 Google 上找到这个问题后，我会准确地回答你的问题。我将通过组展示我在 Django 1.9 中所做的事情，然后向用户展示如何做到这一点。

从 django.contrib.auth.models 导入组，权限组，__ = Group.objects.get_or_create(name='my_group')

```
permissions = Permission.objects.all()
for p in permissions:
    group.permissions.add(p)
group.save() 
```

很容易适应用户：

```
from django.contrib.auth.models import Permission
permissions = Permission.objects.all()
for p in permissions:
    youruser.user_permissions.add(p)
youruser.save() 
```

我更喜欢组，因为您将来可能会添加权限并且可以只添加到组而不是重新执行所有用户。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-05T16:12:01.067

从 Django 1.6 开始：

每个用户都有一个多对多的`user_permissions`权限字段 - 您可以为此添加权限：

```
your_user.user_permissions.add(permission) 
```

v1.6 文档：

*   [Django.contrib.auth API](https://docs.djangoproject.com/en/1.6/ref/contrib/auth/#django.contrib.auth.models.User.user_permissions)（显示用户、组和权限对象）
*   [验证默认权限](https://docs.djangoproject.com/en/1.6/ref/contrib/auth/#django.contrib.auth.models.User.user_permissions)（显示如何清除、添加、删除）

# php - PHP代码在IE8中不起作用

> ID：10853126
> 
> 赞同：0
> 
> 时间：2012-06-01T15:26:34.350
> 
> 标签：php, forms, internet-explorer

我有一个莫名其妙的 IE8 PHP 问题。下面的代码在 chrome 和 FF 中运行良好，但在 IE8 中运行良好。表单正在提交，如果没有选择搜索词或​​复选框，则会显示错误，如果两个 db 搜索都失败，则会显示 No Actors 和 No Movies found 回声。但是，如果其中一个搜索成功，则不会显示任何内容，甚至演员/电影也没有找到让我难过的回声。

这是代码：

```
<?php
if($_POST[submitbutton]){
    $search = trim(mysql_real_escape_string($_POST[search]));

    if(!$search){
        echo "Please enter a search term!";
    }else if(!$_POST['checkbox']){
        echo "Please select at least one database to search!";
    }else{
        //search names
        if(in_array("actors", $_POST['checkbox'])){
            $query = mysql_query("SELECT name_id, realname, mainalias FROM names WHERE realname LIKE '%$search%' OR mainalias LIKE '%$search%'");

            if(mysql_num_rows($query)==0){
                echo "<h2>No Actors by that name found!</h2>", "<p>";
            }else{
                echo "<h2>Actors Found:</h2>";
                while ($record = mysql_fetch_assoc($query)){
                    $realname = $record['realname'];
                    $name_id = $record['name_id'];
                    echo "<a href='index.php?page=name&id=$name_id'>", $realname, "</a><hr>";
                }
            }
        }

        //search titles
        if(in_array("movies", $_POST['checkbox'])){
            $query = mysql_query("SELECT title_id, title FROM titles WHERE title LIKE '%$search%'");

            if(mysql_num_rows($query)==0){
                echo "<h2>No Movies by that name found!</h2>", "<p>";
            }else{
                echo "<h2>Movies Found:</h2>";
                while ($record = mysql_fetch_assoc($query)){
                    $title = $record['title'];
                    $title_id = $record['title_id'];
                    echo "<a href='index.php?page=title&amp;id=$title_id'>", $title, "</a><br>";

                echo "<hr>";
                }
            }
        }
    }
} //end post submitbutton
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T17:16:15.910

```
<?php
if(isset($_POST['submitbutton'], $_POST['search'])){ //use isset for check exists vars
    $search = trim(mysql_real_escape_string($_POST['search'])); // ['POST vars']

    if(!$search){
        echo "Please enter a search term!";
    }else if(!isset($_POST['checkbox'])){
        echo "Please select at least one database to search!";
    }else{
        //search names
        if(in_array("actors", $_POST['checkbox'])){
            $query = mysql_query("SELECT name_id, realname, mainalias FROM names WHERE realname LIKE '%$search%' OR mainalias LIKE '%$search%'");

            if(mysql_num_rows($query)==0){
                echo "<h2>No Actors by that name found!</h2>", "<p>";
            }else{
                echo "<h2>Actors Found:</h2>";
                while ($record = mysql_fetch_assoc($query)){
                    $realname = $record['realname'];
                    $name_id = $record['name_id'];
                    echo "<a href='index.php?page=name&id=$name_id'>", $realname, "</a><hr>";
                }
            }
        }

        //search titles
        if(in_array("movies", $_POST['checkbox'])){
            $query = mysql_query("SELECT title_id, title FROM titles WHERE title LIKE '%$search%'");

            if(mysql_num_rows($query)==0){
                echo "<h2>No Movies by that name found!</h2>", "<p>";
            }else{
                echo "<h2>Movies Found:</h2>";
                while ($record = mysql_fetch_assoc($query)){
                    $title = $record['title'];
                    $title_id = $record['title_id'];
                    echo "<a href='index.php?page=title&amp;id=$title_id'>", $title, "</a><br>";

                echo "<hr>";
                }
            }
        }
    }
} //end post submitbutton
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:32:37.280

应该

```
$search = trim(mysql_real_escape_string($_POST[search])); 
```

是

```
$search = trim(mysql_real_escape_string($_POST['search'])); 
```

我不知道这是否与你的问题有关，但它跳到我身上。

# xpages - 从 xPages 视图面板在新选项卡中打开文档？

> ID：10853134
> 
> 赞同：2
> 
> 时间：2012-06-01T15:27:18.460
> 
> 标签：xpages

单击视图面板中的链接时，有什么方法可以在新的浏览器选项卡中打开文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:54:29.683

“目标”是视图面板组件的属性之一。如果您指定“_blank”（如 Ferry 建议的那样）作为该属性的值，它应该将其应用于每一行的链接。但请记住，您最终将受制于最终用户的浏览器设置。一个用户可能会得到一个新选项卡，另一个用户可能会得到一个全新的窗口，而另一个用户可能什么也得不到，因为该链接被视为弹出窗口并被阻止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-04T02:43:02.717

你有两个选择。一种是蒂姆解释的方式。另一个，您可以将视图列值计算为链接。在那里您可以使用 _new 或 _blank 属性。

简单地说，View Column 可以作为 HTML 给出。在那里，您可以使用 html href 标记计算页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T17:44:07.877

这只是一个浏览器设置。您只需将 target="_blank" 放在链接中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-04T13:15:00.060

在尝试了这个之后，我出于多种原因决定不使用它，但想发布下面的过程来实现它。

在视图列显示选项卡上选择计算值并输入如下公式：

```
 var _row:NotesXspViewEntry = viewEntry; 

 var _unid = _row.getUniversalID(); 

 return "<a href='0/" + _unid + "?OpenDocument'  TARGET='_new'>" +  _row.getColumnValue("RequestNum") + "</a>" 
```

在显示选项卡上选择 HTML。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-24T03:06:31.007

只需添加另一个选项即可。如果将列显示设置为“隐藏”，则可以在列中放置标准链接控件。例如，如果所需的列链接文本是“名字”列，它将打开一个新选项卡到“Person.xsp”页面

```
<xp:viewColumn columnName="firstName" id="vcFirstNameCol" displayAs="hidden">

    <xp:viewColumnHeader value="First Name" id="vchFirstName"></xp:viewColumnHeader>

    <xp:link escape="true" text="#{javascript: rowData.getColumnValue('firstName');}" id="link1" value="Person.xsp"
            target="_blank">
        <xp:this.parameters>
            <xp:parameter name="documentId" value="#{javascript:rowData.getUniversalID();}"></xp:parameter>
            <xp:parameter name="action" value="openDocument"></xp:parameter>
        </xp:this.parameters>
    </xp:link>

</xp:viewColumn> 
```

# javascript - jQuery 显示/隐藏 cookie 按钮

> ID：10853136
> 
> 赞同：0
> 
> 时间：2012-06-01T15:27:26.810
> 
> 标签：javascript, jquery

我正在寻找一个基于 cookie 的简单 jQuery 显示/隐藏脚本。如果有人能给我一个脚本，那就太好了。

以下是我要实现的目标的指南。

*   如果未设置 cookie
    *   将所有具有 admin 类的 div 设置为可见
    *   显示隐藏链接
*   如果设置了 cookie
    *   用管理类隐藏 div
    *   显示显示链接

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:31:31.073

[通过使用jquery-cookie 插件，](https://github.com/carhartl/jquery-cookie)您可以轻松地使用基于 cookie 值的 if/then 语句。像这样：

```
$.cookie("foo") 
```

# iphone - 如何在两个字符串之间添加 UILabel

> ID：10853137
> 
> 赞同：0
> 
> 时间：2012-06-01T15:27:30.167
> 
> 标签：iphone, ios, ios5, nsstring, nsrange

我有这段代码可以在 UITextview 中显示一些文本。我只想在这些字符串之间添加一个 UILabel。我正在以这种格式获取文本，1 这是第一个文本 2 这是第二个文本 3 这是第三个文本，我想要在数字字符和文本之间添加或附加 UILabel。我显示文本的代码是

```
 NSMutableString *combined = [NSMutableString string];

    for(NSUInteger idx = 0; idx < [delegatee.allSelectedVerseEnglish count]; idx++) {
        [combined appendFormat:@"   %d %@", 
         idx + 1, 
         [delegatee.allSelectedVerseEnglish objectAtIndex:idx]];

    }
    NSNumberFormatter * f = [[NSNumberFormatter alloc] init]; 
    NSNumber * n = [f numberFromString:combined]; 
    NSLog(@"N: %@", n);
       maintextview.text =combined; 
```

组合是上面格式中的文本，maintextview 是 UITextview。

我也得到了两个句子之间的字符串范围

```
- (void)textViewDidEndEditing:(UITextView *)textView
{
    if (textView == maintextview) {

    mainpopupview.frame =CGRectMake(0, 0, 768, 1004)    ;
    [self.view addSubview:mainpopupview];

    NSRange selectedRange = [textView selectedRange];
    NSString *backString = [maintextview.text substringToIndex:selectedRange.location];
    NSRange backRange = [backString rangeOfString:@"   " options:NSBackwardsSearch];
    NSRange backRangee = [backString rangeOfString:@"   " options:NSBackwardsSearch];
    int  myRangeLenght = backRangee.location - backRange.location;
    NSRange myStringRange = NSMakeRange (backRange.location, myRangeLenght);
    NSString *forwardString  = [maintextview.text substringFromIndex:backRange.location];
    NSLog(@"%@",[[forwardString componentsSeparatedByString:@"   "] objectAtIndex:1]);
    NSLog (@"%@",  [maintextview.text substringWithRange:myStringRange]);

    NSString * myStringTxt = [[forwardString componentsSeparatedByString:@"   "] objectAtIndex:1];
    NSLog(@"1 %@", myStringTxt);

    //  maintextview.textColor = [UIColor yellowColor];

    NSRange myStringRangee = [maintextview.text rangeOfString:myStringTxt];
    [maintextview select:self];
    maintextview.selectedRange = myStringRangee; 
```

有什么办法可以做到这一点。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T17:40:20.450

我不知道你在这里需要什么用户交互，但如果你只是为用户显示文本，但你可以用 a 替换你[`UITextView`](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITextView_Class/Reference/UITextView.html)的[`UIWebView`](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIWebView_Class/Reference/Reference.html)（通过 加载静态文本[`loadHTMLString:baseURL:`](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIWebView_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006950-CH3-SW10)，使用 html 标记设置文本的颜色）？我参考了 UITextView 文档：

> 此类不支持文本的多种样式。您指定的字体、颜色和文本对齐属性始终适用于文本视图的全部内容。要在您的应用程序中显示更复杂的样式，您需要使用 UIWebView 对象并使用 HTML 呈现您的内容。

如果您确实需要使用单独的 UI 控件（比仅使用 UIWebView 复杂得多）来执行此操作，则不要在文本中“插入” UILabel，而是您可能对文本有一个控件直到点颜色变化，另一个控件用于不同颜色的文本或你有什么，另一个控件用于其余文本。它会很快变得毛茸茸（除非它像网格一样布局，即使这样与 UIWebView 相比也很麻烦）。

# c# - 为什么我不能在 C# 中将隐式运算符从基类写入派生类？

> ID：10853141
> 
> 赞同：6
> 
> 时间：2012-06-01T15:27:36.453
> 
> 标签：c#, operators

```
public class Derived : BaseClass
{
    public Derived(string name) : base(name) {}

    public static implicit operator BaseClass(Derived derived)
    {
        return new BaseClass(derived.ColorHex);
    }

    public static implicit operator Derived(BaseClass baseclass)
    {
        return new Derived(baseclass.name);
    }
} 
```

这行不通。为什么不允许？
我*可能*会编写必要的逻辑以使其有意义，尤其是在从基础转换为派生逻辑时。

编辑：更改了问题的标题

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T15:29:14.293

因为已经存在从`Derived`to的隐式转换`BaseClass`，反之则没有任何意义。

关于后者：如果您的`Base`对象旨在隐式转换为`Derived`- 为什么它们`Derived`首先不是对象？

[标准](http://www.ecma-international.org/publications/standards/Ecma-334.htm)中的强制性报价：

> ## 6.1.6 隐式引用转换
> 
> 隐式引用转换是：
> 
> *   [...]
> *   从任何类类型 S 到任何类类型 T，只要 S 派生自 T。

众所周知，这表示存在隐式转换`Derived`=> 。`Base`

> ## 6.2.4 显式引用转换
> 
> 显式参考转换是：
> 
> *   [...]
> *   从任何类类型 S 到任何类类型 T，只要 S 是 T 的基类。
> *   [...]

这表示已经有一个显式转换`Base`=> `Derived`（这允许您在运行时尝试向下转换）。

> ## 6.4.1 允许的用户定义转换
> 
> C# 只允许声明某些用户定义的转换。**特别是，不可能重新定义已经存在的隐式或显式转换。**

这就是说，由于语言已经定义了两个感兴趣的转换，因此您无法重新定义它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:29:43.763

因为它会扰乱多态性的语义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T17:38:34.367

有一个一般规则，将对象转换为自己的类型的结果是原始对象。如果类型的存储位置`BaseType`包含 的实例`DerivedType`，则从原始类型转换为`DerivedType`应该告诉编译器使用`DerivedType`的成员，但实际上不应该对对象“做”任何事情。如果允许自定义基到派生的转换运算符，则有必要：（1）有一个转换为实例的自身类型操作有时会产生一个新对象，有时不会，或者（2）有一个派生类型存储在基本类型存储位置的对象的行为与基本类型或不相关类型的对象大不相同，没有清晰可见的类型检查代码可以做到这一点。虽然有时人们可能想要一个方法，给定一个基类型参数，它可能会返回一个新的派生类型对象，或者——如果给定派生类型的一个实例，只需不加修改地返回它，通常最好有这样一个“看起来”像方法而不是类型转换的东西。

顺便说一句，在一种情况下，编译器可以允许在“基本类型”和“派生类型”之间进行用户定义的类型转换，而不会出现上述歧义：当其中一种类型是结构时。尽管 C# 假装值类型继承自`ValueType`，但每个值类型定义实际上都定义了两件事：一个派生自`ValueType`，以及存储位置的集合，它不是一个对象，也不是从任何东西派生的。C# 定义了从后者类型到前者的隐式转换运算符，以及从前者到后者的显式转换运算符。由于堆对象和存储位置集合之间的转换永远不会保留引用，因此允许在这种上下文中使用用户定义的转换运算符不会导致继承语义混乱。这种转换的唯一困难是使用它们的值类型要么不能作为泛型类型使用，要么如果作为泛型类型传递将失去它们的特殊行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T15:39:09.973

要进行综合，您已经可以将 Derived 对象转换为 BaseClass 对象，而无需编写任何代码：

```
BaseClass baseClass = new BaseClass("");
Derived derived = new Derived("");

baseClass = (BaseClass)derived; 
```

但是您不能将转换从 Derived 重写为 BaseClass。

对于其他演员，从 BaseClass 到 Derived，它没有多大意义。

总之，只有当 2 个类之间没有继承关系时，您才能重新定义强制转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-20T19:38:45.707

我需要能够从基对象创建派生对象，以便捕获基类没有的附加信息。出于我的目的，构造一个包含从基础对象复制的所有字段的派生对象是可以接受的。我使用 AutoMapper 让我的生活更轻松：

```
class AnnotatedAlert : Alert
{
    public string Color;

    // I don't know why C# doesn't allow user defined conversions from a base class
    // so I am creating a conversion constructor instead
    public AnnotatedAlert(Alert from)
    {
        AutoMapper.Mapper.Map(from, this);
    }

    static AnnotatedAlert()
    {
        AutoMapper.Mapper.CreateMap<Alert, AnnotatedAlert>();
    }
}; 
```

# ios - 应用程序进入前台后 SpeakHere 录音机崩溃

> ID：10853146
> 
> 赞同：5
> 
> 时间：2012-06-01T15:27:41.633
> 
> 标签：ios, audio-recording, background-foreground

我基于 Apple 的 SpeakHere 音频应用程序示例编写了一个小型录音机/播放器以在我的 iPad 上使用。当用户要求显示记录器时，会打开一个 UIView 并显示记录/停止按钮和仪表。

当我从头开始加载应用程序时，我可以随时录制、停止录制、再次录制。停止录制后，我将应用程序置于后台，例如阅读我的邮件。再次将录音机置于前台时，无法录制任何声音。我在日志中收到一条错误消息，仪表不显示任何数据，也没有创建声音文件。我注意到 SpeakHere 示例应用程序在 iPhone 和 iPad 上的行为相同。唯一的解决方案是退出并重新启动应用程序。

为了解决这个问题，我决定在用户​​使用完记录器后释放视图控制器。我为记录视图控制器禁用了 ARC，并编写了它的 dealloc 方法。在这个控制器的 viewDidDisappear 中，我放了一个*[self dealloc]*调用。

但是程序崩溃了，发送一个*[RecorderViewController childViewControllersCount]: 消息发送到 deallocated instance*。我想这样的自我释放是不允许的......

我需要找到解决方案，要么...

1.  找到一种在应用程序进入后台时正确管理音频会话的方法（因为录制停止，我不明白为什么会出现这样的问题）。

2.  或者在视图关闭时正确释放记录器视图控制器，以确保在任何时候必须出现视图时，它会从控制器的 XIB 文件中再次加载。

**[更新]**在查看 aurioTouch 应用程序的代码（Apple 开发网站的另一个音频示例）后，我在我的应用程序委托中使用了以下代码：

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    AudioSessionSetActive(true);

} 
```

它可以在我的应用程序或 SpeakHere 应用程序中工作......花了几个小时寻找解决方法，它是一行代码！

# java - Java 和 Tomcat - CodeCache 已满。编译器已被禁用

> ID：10853147
> 
> 赞同：14
> 
> 时间：2012-06-01T15:27:43.317
> 
> 标签：java, tomcat, compiler-construction, code-caching

**我的情况**

*   我开发了一个用于文档分析的 Web 服务
*   此网络服务读取 txt 和 pdf 文档
*   为了阅读 pdf 文件，我正在使用我的大学顾问开发的 java 库
*   我正在使用 Java 7
*   我目前正在将它部署在 Tomcat v7.0 上
*   如果我从我的应用程序生成一个war文件并将其托管在我电脑上的本地tomcat上，或者如果我通过eclipse ee在tomcat上启动我的应用程序，则读取pdf文件没有问题

**我的问题**

*   我已经为自己设置了一个小服务器（不是最好的硬件，双核 cpu，4g 内存），安装了 tomcat，java 和其他对我来说似乎必要的东西。
*   当我现在使用 tomcat 管理器在服务器 tomcat 上部署战争文件时，一切正常，直到我尝试让应用程序读取 pdf 文件。
*   在应用程序读取了几页后，我收到一个错误，即 CodeCache 已满，因此编译已被禁用。

**pdf 导入期间的示例错误输出**

此日志显示了如何导入 pdf 以及在某些时候开始出现错误消息。我已将错误消息标记为粗体。

...

2012 年 5 月 31 日上午 11:15:40 infovis.structure.pdf.PDFImport process INFO：Processing Page 13

2012 年 5 月 31 日上午 11:15:40 infovis.structure.pdf.PDFImport process INFO：Processing Page 14

2012 年 5 月 31 日上午 11:15:41 infovis.structure.pdf.PDFImport process INFO：处理第 15 页

**`Java HotSpot(TM) 64-Bit Server VM warning: CodeCache is full. Compiler has been disabled. Java HotSpot(TM) 64-Bit Server VM warning: Try increasing the code cache size using -XX:ReservedCodeCacheSize= Code Cache [0x00007fa43437e000, 0x00007fa4347fe000, 0x00007fa43737e000) total_blobs=1858 nmethods=1318 adapters=490 free_code_cache=44631Kb largest_free_block=45618688 Java HotSpot(TM) 64-Bit Server VM warning: CodeCache is full. Compiler has been disabled. Java HotSpot(TM) 64-Bit Server VM warning: Try increasing the code cache size using -XX:ReservedCodeCacheSize= Code Cache [0x00007fa43437e000, 0x00007fa4347fe000, 0x00007fa43737e000) total_blobs=1859 nmethods=1318 adapters=490 free_code_cache=44631Kb largest_free_block=45618688`**

2012 年 5 月 31 日上午 11:16:19 infovis.structure.pdf.PDFImport process INFO：处理第 16 页

2012 年 5 月 31 日上午 11:16:20 infovis.structure.pdf.PDFImport process INFO：Processing Page 17

**`Java HotSpot(TM) 64-Bit Server VM warning: CodeCache is full. Compiler has been disabled. Java HotSpot(TM) 64-Bit Server VM warning: Try increasing the code cache size using -XX:ReservedCodeCacheSize= Code Cache [0x00007fa43437e000, 0x00007fa4347fe000, 0x00007fa43737e000) total_blobs=1860 nmethods=1318 adapters=490 free_code_cache=44630Kb largest_free_block=45618688 May 31, 2012 11:17:07 AM infovis.structure.pdf.PDFImport process INFO: Processing Page 18 Java HotSpot(TM) 64-Bit Server VM warning: CodeCache is full. Compiler has been disabled. Java HotSpot(TM) 64-Bit Server VM warning: Try increasing the code cache size using -XX:ReservedCodeCacheSize= Code Cache [0x00007fa43437e000, 0x00007fa4347fe000, 0x00007fa43737e000) total_blobs=1861 nmethods=1318 adapters=490 free_code_cache=44633Kb largest_free_block=45618688`**

等等...

**到目前为止我尝试过的**

我试图在我的服务器上更改 tomcat 配置中的缓存大小（我不是使用 linux shell 的最佳人选）。我尝试增加 CodeCache 大小以及其他缓存的大小，但问题仍然存在。我已经检查了我的代码是否存在泄漏，但还没有发现任何泄漏（请记住，如果我通过 eclipse 启动它，我不会收到此消息，因此这可能表明存在 tomcat(?) 配置问题）。我还尝试设置参数“UseCodeCacheFlushing”，当它变满时应该强制清空代码缓存，但不知何故它不会影响应用程序故障。

**我的tomcat服务器配置**

我读过默认 CodeCache 大小是 32MB 或 64MB，当它是 64 位应用程序时。我尝试保留512mb（也许我在配置中做错了什么？）但问题当然又发生了。

> 您可以在此处将 JVM 启动参数传递给 Java。如果未设置，默认选项将为：-Djava.awt.headless=true -Xmx128m -XX:+UseConcMarkSweepGC
> 
> 使用“-XX:+UseConcMarkSweepGC”启用 CMS 垃圾收集器（提高响应时间）。如果您使用该选项并在只有一个 CPU 芯片且包含一个或两个内核的机器上运行 Tomcat，您还应该添加“-XX:+CMSIncrementalMode”选项。 **JAVA_OPTS="-Djava.awt.headless=true -Xmx3g -Xms2g -XX:+UseCodeCacheFlushing -XX:+UseG1GC -XX:MaxPermSize=512m -XX:ReservedCodeCacheSize=512m"**

**我对此的看法**

在我研究的过程中，我发现了一些注释，CodeCache 相关问题可能表明内存泄漏问题，当出现编程失败时，其结果是垃圾收集器无法清空缓存。这**可能**是可能的，遗憾的是我没有阅读 pdf 的库的源代码。但另一方面，我在本地 tomcat（四核，4x 3.0ghz，也是 4g ram）上的台式电脑上阅读 650 页 pdf 时没有问题，这让我感到困惑。

难道这只是一个tomcat问题，如果我使用另一台服务器进行部署，比如glassfish，就可以解决吗？

任何人都可以帮助我或提供任何想法或建议吗？也许我做错了一些配置？我在使用 tomcat 或其他服务器方面没有那么经验，所以非常欢迎任何帮助。

非常感谢您的每一个回答，并认为您正在与我分享。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T13:09:20.787

尝试另一个 JVM，如 JRockit，你不应该有这个问题。如果它是 Tomcat - 尝试查看它是否在其日志中记录了有关泄漏的信息 - 它通常是针对类加载器问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T12:49:52.820

我的解决方案是从 Tomcat 切换到 Glassfish 作为应用程序服务器来部署我的应用程序。

在那次切换之后，我再也没有体验过这种 CodeCache 行为。

为了确保这个问题得到解决，我还观察了我的服务器上运行的 java-vm（使用带有远程的 jconsole）。我再也没有看到任何可疑的行为。

# git - 我怎么知道是否有人拉了我的本地 git 提交？

> ID：10853157
> 
> 赞同：1
> 
> 时间：2012-06-01T15:28:44.850
> 
> 标签：git

我正在使用 svn-ish git 工作流程。我和几个开发人员都通过一个中央官方存储库进行通信。

另一位开发人员正在做一些彻底的改变，但他必须做更多的测试才能推送到官方 repo。我想从事这个项目，但我的改变应该基于他所做的事情，而不是几天后处理一大堆合并冲突。

我对此的看法是他应该提交他的更改，我应该从他的存储库中提取。这样，他就可以推迟大推，而我可以开始使用他的代码库。

我开始担心......我喜欢能够安全地重新设置我尚未共享的提交。但是，如果人们被允许从我身边拉开，`rebase` *那*会安全吗？

**问题：** git 存储库是否知道已从中提取了哪些提交？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:40:12.730

我不确定 git 存储库是否会跟踪已拉取的内容，但我认为在这种情况下，最好的选择是让其他开发人员在中央存储库上创建一个分支，然后将他的更改推送到该分支。这样，你们两个都可以保留在推动之前安全地变基的能力，并且你可以在他走的时候从他的树枝上拉出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:03:43.147

如果您的存储库位于另一台机器上，以便使用 ssh 访问、访问，那么您在系统日志中有连接信息，仅此而已。

# python - Python 代理服务器 + HTTP 分析器

> ID：10853158
> 
> 赞同：2
> 
> 时间：2012-06-01T15:28:47.460
> 
> 标签：python, http, proxy, analyzer

我是 Python 和一般服务器的新手，如果有人指出我正确的方向，我将不胜感激。我曾尝试在 Google 上搜索，但无法找到适合我需要的内容。

我想让一个 Python 服务器监控通过它的流量。我期待某些 URL。如果通过特定的 GET 请求，我希望能够解析和记录参数。如果通过 JSON 发送，我想从中读取和提取数据。执行此操作的步骤是什么？

# java - 示例项目以了解有关 Java 集合的更多信息

> ID：10853159
> 
> 赞同：1
> 
> 时间：2012-06-01T15:28:52.320
> 
> 标签：java, collections

有人可以建议一个示例项目[任何任务/项目/编码活动]，我可以在其中广泛使用 Java 集合和核心 java 吗？目的只是让我更熟悉集合框架。我对此有基本到中级的知识。在这里问，因为我没有耐心做 Java 教程中的所有练习。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:31:59.947

很简单，编写代码来管理内存学生数据库。提供选项 - 添加/删除/修改学生。- 比较学生， - 排序按名称排序的学生列表，按 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:30:11.517

在排序数组、反转列表、队列管理等方面实现几个或多个经典算法。

# asp.net - SQL Server 停顿十分钟

> ID：10853168
> 
> 赞同：2
> 
> 时间：2012-06-01T15:29:26.033
> 
> 标签：asp.net, sql, sql-server, asp.net-mvc, tsql

我管理一个包含多个在线交易的 ASP.NET MVC 3 网站。在网站上，客户可以下订单、支付账单，而供应商可以向客户收费。所有这些都可以同时发生，所以我有信号量来确保线程安全。

我注意到的是，大约每周一次，网站会停顿十分钟。我的第一个问题是信号量中的死锁，但是在放置信号量日志并分析结果后，似乎没有死锁。此外，网站会在十分钟后自行恢复。

在调查时，我注意到整个网站变得没有响应，而不仅仅是使用信号量的部分。他们都使用数据库强硬。这就是为什么我的主要嫌疑人是数据库。

奇怪的是，每一次，网站都会冻结十分钟，几乎到秒。SQL Server 是否可以进行定期维护或任何可以解释这种延迟的事情？如果没有，您知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:04:32.407

ASP.NET 挂起可能有多种原因。通常，当您遇到 SQL 未挂起的问题时，您会遇到连接或命令超时。

你好多了

*   获取 Windows的调试[工具](http://msdn.microsoft.com/en-us/windows/hardware/gg463009.aspx)
*   使用 AdPlus 获取内存转储 ( `adplus -hang -pn processname.exe`) 或 DebugDiag 并设置转储规则
*   使用 WinDbg（或用于 4.0 框架的 VS 2010）（在设置符号缓存之后）并开始使用 `!threads`或`!dumpheap -stat`检查线程和堆对象来检查正在发生的事情。

请注意调试生产问题非常困难，WinDbg 不是一个友好的工具，但猜测和查看日志更是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:36:05.273

您的问题的答案似乎是“是”。环境中正在发生的事情正在锁定。

您是否运行过 sp_who2 以查看它停止时正在运行的内容？

如果这样做不方便，则设置一个作业，每五分钟将 sp_who2 输出转储到一个表中。当它停止时，您可以看到正在运行的内容并从那里开始工作。

我遇到了类似的问题，主数据库似乎被锁定了。因此，重命名数据库不起作用。幸运的是，这不是在实时交易环境中，所以等待五分钟再试一次就可以了。

# c# - Linq Expression to generic - 如何

> ID：10853170
> 
> 赞同：1
> 
> 时间：2012-06-01T15:29:31.907
> 
> 标签：c#, .net, linq, lambda

我想将其转换为泛型类型：

```
using System.Linq.Expression
using System.Collections.Generic

public IQueryable<T> AllIncluding(
                          params Expression<Func<T, object>>[] includeProperties)
{
    IQueryable<T> query = All;
    foreach (var includeProperty in includeProperties)
    {
        // query = query.Include(includeProperty);
    }
    return query;
} 
```

但这似乎不起作用，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:46:33.217

该`Include`方法仅在 上可用，`DbQuery<T>`因此您必须使用直接转换或`as`操作数将查询转换为它，或使用方法[DbExtensions.Include](http://msdn.microsoft.com/en-us/library/gg671236.aspx)：

```
public IQueryable<T> AllIncluding(
    params Expression<Func<T, object>>[] includeProperties)
{
    IQueryable<T> query = All as DbQuery<T>;
    if (query == null)
    {
       return All;
    }

    foreach (var includeProperty in includeProperties)
    {
        // query = query.Include(includeProperty);
    }
    return query;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:39:11.647

添加一个使用 for `System.Data.Entity`;

Entity Framework 4.1 包括强类型版本：http `Include`: [//msdn.microsoft.com/en-us/library/gg671236 (VS.103).aspx](http://msdn.microsoft.com/en-us/library/gg671236(VS.103).aspx)

这是一种扩展方法。

# sql - 语法定义中使用的特殊符号

> ID：10853171
> 
> 赞同：1
> 
> 时间：2012-06-01T15:29:42.660
> 
> 标签：sql, syntax

我总是看到 sql 子句的语法定义如下：

[http://msdn.microsoft.com/en-us/library/ms174123.aspx](http://msdn.microsoft.com/en-us/library/ms174123.aspx)

```
ALTER TABLE table_name
ALTER COLUMN column_name 
   {
    type_name[({precision[.scale]})][NULL|NOT NULL]
   {DROP DEFAULT 
   | SET DEFAULT constant_expression 
   | IDENTITY [ ( seed , increment ) ]
   } 
| ADD 
   { < column_definition > | < table_constraint > } [ ,...n ] 
| DROP 
   { [ CONSTRAINT ] constraint_name 
   | COLUMN column }
] }
< column_definition > ::= 
   { column_name data_type } 
   [ [ DEFAULT constant_expression ] 
      | IDENTITY [ ( seed , increment ) ] 
   ] 
   [ROWGUIDCOL]
   [ < column_constraint > ] [ ...n ] ]
< column_constraint > ::= 
   [ NULL | NOT NULL ] 
   [ CONSTRAINT constraint_name ] 
   { 
      | { PRIMARY KEY | UNIQUE } 
      | REFERENCES ref_table [ (ref_column) ] 
      [ ON DELETE { CASCADE | NO ACTION | SET DEFAULT |SET NULL } ] 
      [ ON UPDATE { CASCADE | NO ACTION | SET DEFAULT |SET NULL } ]
   }
< table_constraint > ::= 
   [ CONSTRAINT constraint_name ] 
   { [ { PRIMARY KEY | UNIQUE } 
      { ( column [ ,...n ] ) } 
      | FOREIGN KEY 
        ( column [ ,...n ] )
        REFERENCES ref_table [ (ref_column [ ,...n ] ) ] 
      [ ON DELETE { CASCADE | NO ACTION | SET DEFAULT |SET NULL } ] 
      [ ON UPDATE { CASCADE | NO ACTION | SET DEFAULT |SET NULL } ] 
   } 
```

我知道像“|”这样的符号的基本含义，但是我在哪里可以得到所有这些符号的完整解释，比如“{”、“[”等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:32:13.843

它被称为 Backus Naur 形式，或者更具体地说是 Extended Backus Naur 形式，这意味着更易于人类阅读且不那么正式。

[http://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form](http://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form)彻底检查了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:32:06.867

*   管道的意思是“或”
*   卷曲意味着“块可以重复”
*   方块表示“条款是可选的”
*   Parens 是真正的 SQL

# gcc - 我如何得到 gcc -s 的解释？

> ID：10853175
> 
> 赞同：8
> 
> 时间：2012-06-01T15:29:52.770
> 
> 标签：gcc

我通过搜索引擎得到了“gcc -s”的含义。这意味着在链接时剥离符号。

但是如何使用“man gcc”或“gcc --help”获取这些信息？好像没有相关信息：

```
root@desktop:~# gcc --help
Usage: gcc [options] file...
Options:
  -pass-exit-codes         Exit with highest error code from a phase
  --help                   Display this information
  --target-help            Display target specific command line options
  --help={target|optimizers|warnings|params|[^]{joined|separate|undocumented}}[,...]
                           Display specific types of command line options
  (Use '-v --help' to display command line options of sub-processes)
  --version                Display compiler version information
  -dumpspecs               Display all of the built in spec strings
  -dumpversion             Display the version of the compiler
  -dumpmachine             Display the compiler's target processor
  -print-search-dirs       Display the directories in the compiler's search path
  -print-libgcc-file-name  Display the name of the compiler's companion library
  -print-file-name=<lib>   Display the full path to library <lib>
  -print-prog-name=<prog>  Display the full path to compiler component <prog>
  -print-multi-directory   Display the root directory for versions of libgcc
  -print-multi-lib         Display the mapping between command line options and
                           multiple library search directories
  -print-multi-os-directory Display the relative path to OS libraries
  -print-sysroot           Display the target libraries directory
  -print-sysroot-headers-suffix Display the sysroot suffix used to find headers
  -Wa,<options>            Pass comma-separated <options> on to the assembler
  -Wp,<options>            Pass comma-separated <options> on to the preprocessor
  -Wl,<options>            Pass comma-separated <options> on to the linker
  -Xassembler <arg>        Pass <arg> on to the assembler
  -Xpreprocessor <arg>     Pass <arg> on to the preprocessor
  -Xlinker <arg>           Pass <arg> on to the linker
  -combine                 Pass multiple source files to compiler at once
  -save-temps              Do not delete intermediate files
  -pipe                    Use pipes rather than intermediate files
  -time                    Time the execution of each subprocess
  -specs=<file>            Override built-in specs with the contents of <file>
  -std=<standard>          Assume that the input sources are for <standard>
  --sysroot=<directory>    Use <directory> as the root directory for headers
                           and libraries
  -B <directory>           Add <directory> to the compiler's search paths
  -b <machine>             Run gcc for target <machine>, if installed
  -V <version>             Run gcc version number <version>, if installed
  -v                       Display the programs invoked by the compiler
  -###                     Like -v but options quoted and commands not executed
  -E                       Preprocess only; do not compile, assemble or link
  -S                       Compile only; do not assemble or link
  -c                       Compile and assemble, but do not link
  -o <file>                Place the output into <file>
  -x <language>            Specify the language of the following input files
                           Permissible languages include: c c++ assembler none
                           'none' means revert to the default behavior of
                           guessing the language based on the file's extension 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T15:32:35.573

来自`man gcc`：

```
 -s  Remove all symbol table and relocation information from the
       executable. 
```

我通过在手册页中搜索“ `-s`”（注意前导和尾随空格）找到了这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:38:57.660

`man gcc`仅列出更多使用和有用的选项。其余文档可以在[gcc 在线网页上找到](http://gcc.gnu.org/onlinedocs/gcc/)

来自： http: [//gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options)

> -s 从可执行文件中删除所有符号表和重定位信息。

# java - 如何在我的自定义组件中使用 IncludeHandler？

> ID：10853177
> 
> 赞同：2
> 
> 时间：2012-06-01T15:30:00.590
> 
> 标签：java, jsf-2, include, facelets, custom-component

有问题： [ui:include JSF tag 后面的类](https://stackoverflow.com/questions/10789373/the-class-behind-uiinclude-jsf-tag/10789414#10789414) 我发现需要使用 IncludeHandler 才能使用

```
<ui:include> 
```

以编程方式。但是，构造函数需要一个“配置”参数，我不知道如何设置它。
请举例说明如何使用 IncludeHandler 进行简单的包含，例如

```
<ui:include src="include.xhtml" /> 
```

我的 jsf 组件目前是以编程方式构建的，但我想包含一些写为“.xhtml”的部分。所以最后一个网页设计师只是有一个像这样的组件

```
<fg:generator></fg:generator> 
```

和一些“.xhtml”文件来玩弄样式。如果有比 IncludeHandler 更好的方法（仍然需要使用 Java），请告诉我:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:16:36.133

如果您的唯一目的是以`<ui:include>`编程方式使用，那么您应该[`FaceletContext#includeFacelet()`](http://docs.oracle.com/javaee/6/api/javax/faces/view/facelets/FaceletContext.html#includeFacelet%28javax.faces.component.UIComponent,%20java.lang.String%29)改为使用。假设您在自定义组件中：

```
FacesContext facesContext = FacesContext.getCurrentInstance();
FaceletContext faceletContext = (FaceletContext) facesContext.getAttributes().get(FaceletContext.FACELET_CONTEXT_KEY);
faceletContext.includeFacelet(this, "include.xhtml"); // this is your current UIComponent. 
```

这是另一个演示通过命令按钮动态包含的启动示例：

```
<h:form>
    <h:commandButton value="include" action="#{bean.include}" />
</h:form>
<h:panelGroup id="include" /> 
```

和

```
public void include() throws IOException {
    FacesContext facesContext = FacesContext.getCurrentInstance();
    FaceletContext faceletContext = (FaceletContext) facesContext.getAttributes().get(FaceletContext.FACELET_CONTEXT_KEY);
    faceletContext.includeFacelet(facesContext.getViewRoot().findComponent("foo"), "include.xhtml");
} 
```

# iphone - 为什么 AdWhirl 在获取时不显示广告？

> ID：10853178
> 
> 赞同：1
> 
> 时间：2012-06-01T15:30:05.683
> 
> 标签：iphone, xcode, cocos2d-iphone, iad, adwhirl

按照 Ray Wenderlich 教程，我已经合并了最新的 AdWhirl 文件夹，删除了我不使用的适配器，使用 iAd 设置了一个帐户，上传了一些房屋横幅，配置了 AdWhirl 交付并在我的 Cocos2d 中实现了检索/显示代码应用程序。我的日志显示广告已成功检索，但未出现在屏幕上。我在想它们要么显示在屏幕外（无人区），要么隐藏在 CCLayer 后面。非常感谢有关如何测试/解决此问题的任何建议。如果有帮助，它只是一个横向的方向。

更新：对于 Cocos2d 2.0 版本的用户来说，RW 教程已经过时了……解决方法见下文

这是我的 AdWhirl 代码：

图书馆.h

```
#import "AdWhirlView.h"
#import "AdWhirlDelegateProtocol.h"
#import "RootViewController.h"
@interface Library : CCLayer <AdWhirlDelegate>{ 
```

这是教程所说的，但已经过时了

```
//RootViewController *viewController; 
```

这是需要的

```
UINavigationController *viewController

AdWhirlView *adWhirlView;
enum GameStatePP _state; }
@property(nonatomic,retain) AdWhirlView *adWhirlView; 
@property(nonatomic) enum GameStatePP state; 
```

图书馆.mm

```
@implementation Library
@synthesize state = _state, adWhirlView; 
```

在初始化

```
self.state = kGameStatePlaying; 
```

然后是 AdWhirl 方法

```
- (void)adWhirlWillPresentFullScreenModal {
if (self.state == kGameStatePlaying) {
[[CCDirector sharedDirector] pause];} }

- (void)adWhirlDidDismissFullScreenModal {
if (self.state == kGameStatePaused)
    return;
else {
    self.state = kGameStatePlaying;
    [[CCDirector sharedDirector] resume]; }}

- (NSString *)adWhirlApplicationKey {
return @"myadWhirlKeyGoesHere"; }

- (UIViewController *)viewControllerForPresentingModalView {
return viewController;}

-(void)adjustAdSize {
[UIView beginAnimations:@"AdResize" context:nil];
[UIView setAnimationDuration:0.2];
CGSize adSize = [adWhirlView actualAdSize];
CGRect newFrame = adWhirlView.frame;
newFrame.size.height = adSize.height;
CGSize winSize = [CCDirector sharedDirector].winSize;
    newFrame.size.width = winSize.width;
newFrame.origin.x = (self.adWhirlView.bounds.size.width - adSize.width)/2;
    newFrame.origin.y = (winSize.height - adSize.height);
adWhirlView.frame = newFrame;
[UIView commitAnimations]; }

- (void)adWhirlDidReceiveAd:(AdWhirlView *)adWhirlVieww {
[adWhirlView rotateToOrientation:UIInterfaceOrientationLandscapeRight];
[self adjustAdSize];
NSLog(@"Library - adWhirlDidReceiveAd");
NSLog(@"%@",[adWhirlView mostRecentNetworkName]); }

-(void)adWhirlDidFailToReceiveAd:(AdWhirlView *)adWhirlVieww usingBackup:(BOOL)yesOrNo {
NSLog(@"Library - adWhirlDidFailToReceiveAd");
NSLog(@"%@",[adWhirlView mostRecentNetworkName]); }

-(void)onEnter { 
```

这是教程所说的，对于 Cocos2d 2.0 版本的用户来说是错误的

```
//viewController = [(AppDelegate *)[[UIApplication sharedApplication] delegate] viewController]; 
```

这是正确的方法

```
viewController = [(AppDelegate *)[[UIApplication sharedApplication] delegate] navController];

self.adWhirlView = [AdWhirlView requestAdWhirlViewWithDelegate:self];
self.adWhirlView.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin|UIViewAutoresizingFlexibleRightMargin;
[adWhirlView updateAdWhirlConfig];
CGSize adSize = [adWhirlView actualAdSize];
CGSize winSize = [CCDirector sharedDirector].winSize;
self.adWhirlView.frame = CGRectMake((winSize.width/2)-(adSize.width/2),winSize.height-adSize.height,winSize.width,adSize.height);
self.adWhirlView.clipsToBounds = YES;
[viewController.view addSubview:adWhirlView];
[viewController.view bringSubviewToFront:adWhirlView];
[super onEnter]; }

-(void)onExit {
if (adWhirlView) {
    [adWhirlView removeFromSuperview];
    [adWhirlView replaceBannerViewWith:nil];
    [adWhirlView ignoreNewAdRequests];
    [adWhirlView setDelegate:nil];
    self.adWhirlView = nil;
}
[super onExit]; }

- (void) dealloc {
self.adWhirlView.delegate = nil;
self.adWhirlView = nil; } 
```

在我的 AppDelegate.h

错误的：

```
//RootViewController *viewController; 
//UIViewController *viewController; 
```

没错，在 2.0 Cocos2d 模板中提供了所以不需要添加，只需要使用即可：

```
UINavigationController *navController_; 
```

所以这些是不需要的

```
//@property (nonatomic, retain) RootViewController *viewController;
//@property (nonatomic, retain) UIViewController *viewController; 
```

AppDelegate.mm

```
@synthesize window=window_, navController=navController_, director=director_; 
```

不需要，因为我们将使用 navController 代替：

```
//viewController = viewController_; 
```

DidFinishLaunchingWithOptions（所有对 viewController 的引用都被注释掉了）

```
//viewController = [[UIViewController alloc] initWithNibName:nil bundle:nil];
//viewController.wantsFullScreenLayout = YES;
CCGLView *glView = [CCGLView viewWithFrame:[window_ bounds]
    pixelFormat:kEAGLColorFormatRGB565
            depthFormat:0
            preserveBackbuffer:NO
            sharegroup:nil   
            multiSampling:NO 
            numberOfSamples:0];
director_ = (CCDirectorIOS*) [CCDirector sharedDirector];
director_.wantsFullScreenLayout = YES;
[director_ setDisplayStats:NO];
[director_ setAnimationInterval:1.0/60];
[director_ setDelegate:self];
[director_ setProjection:kCCDirectorProjection2D];
[director_ setView:glView];
if( ! [director_ enableRetinaDisplay:YES] )CCLOG(@"Retina Display Not supported");
navController_ = [[UINavigationController alloc] initWithRootViewController:director_];
navController_.navigationBarHidden = YES; 
```

这是重要的行，设置 navController

```
[window_ addSubview:navController_.view];
[glView setMultipleTouchEnabled:YES];
//[viewController_ setView:glView];
//[window_ addSubview:viewController_.view];
[window_ makeKeyAndVisible];
[CCTexture2D setDefaultAlphaPixelFormat:kCCTexture2DPixelFormat_RGBA8888];
[CCFileUtils setiPadSuffix:@"-ipad"];
[CCFileUtils setRetinaDisplaySuffix:@"-hd"];
[CCTexture2D PVRImagesHavePremultipliedAlpha:YES];
[director_ pushScene: [TitleScene scene]]; 
return YES; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T13:40:16.850

如果您仍然遇到此问题，请使用下面的代码。

你以前是

```
[viewController.view addSubview:adWhirlView];<br>
[viewController.view bringSubviewToFront:adWhirlView]; 
```

我的建议是

```
[[CCDirector sharedDirector].view addSubview:adWhirlView];<br>
[[CCDirector sharedDirector].view bringSubviewToFront:adWhirlView]; 
```

也许，在那之后你可以看到广告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T21:04:44.983

您可以使用以下行指定 viewController：

```
viewController = [(AppDelegate *)[[UIApplication sharedApplication] delegate] viewController]; 
```

你确定你的 appDelegate 正在设置它的 viewController 属性吗？换句话说，是`viewController`零吗？我会检查的。

# ios - 通过 UIA 脚本访问 iOS 用户偏好以实现 UI 自动化

> ID：10853180
> 
> 赞同：2
> 
> 时间：2012-06-01T15:30:06.023
> 
> 标签：ios, ui-automation, xcode-instruments

我一直在尝试为我的 iOS 应用程序实现 UI 测试脚本。在测试用例中，我遇到了设置用户偏好的问题。到目前为止，我找不到更改或读取这些用户偏好值的方法。

这些是我到目前为止所学到的：

*   setPreferencesValueForKey 和 preferencesValueForKey 不能通过使用 Root.plist 中的标识符作为搜索键来工作。它将返回空值。但是，我可以通过 UIA 脚本添加这些值，模拟器似乎会记住它们，但它自己的应用程序不会注意到这些变化。
*   在 Setting.bundle 中尝试了 ON 和 OFF 的设置值，但没有帮助。

我的环境：

*   我正在使用 4.3.2 Xcode 版本，其中嵌入了仪器。
*   Mac OS X 10.7.3
*   iPhone 5.1 模拟器

有什么想法吗？提前感谢您的所有建议、评论和解决方案 =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T03:44:33.813

方法描述仅适用于无法在 iOS 模拟器上运行的 iOS 设备上。所以我只是使用实际设备来运行测试脚本！这就是我的解决方案！

# jquery - 替代 pjax/djax 和 ajaxy

> ID：10853183
> 
> 赞同：4
> 
> 时间：2012-06-01T15:30:14.410
> 
> 标签：jquery, ajax, drupal

我正在评估 jQuery 插件，以便在各处使用 AJAX 制作 Drupal 7 站点。我一直在使用[ajaxy](https://github.com/balupton/jquery-ajaxy)。但它似乎并没有得到非常积极的维护。

我发现的两种可能的解决方案是[pjax](https://github.com/defunkt/jquery-pjax)和[djax](https://github.com/beezee/djax)。你对这些插件有什么体验？

您还知道哪些其他插件具有类似的功能？非常重要的特性是 SEO 友好性（最好使用 pushState，因此不使用散列。散列用作不支持的浏览器的后备。）。而且还必须非常灵活，因为它必须与 Drupal 的 HTML 结构配合使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:20:25.147

Drupal 提供了它自己的[AJAX 框架](http://api.drupal.org/api/drupal/includes!ajax.inc/group/ajax/7)，[可以很容易地用于*ajaxify*链接](http://www.computerminds.co.uk/drupal-code/make-link-use-ajax-drupal-7-its-easy)。您无需编写任何 JavaScript 代码，因为[已经提供了](http://api.drupal.org/api/drupal/includes!ajax.inc/group/ajax_commands/7)[许多*AJAX 命令*](http://api.drupal.org/api/drupal/includes!ajax.inc/group/ajax_commands/7)。该解决方案是 SEO 友好的。链接在其路径中输出一个元素，然后在框架使用时`nojs`替换为。`ajax`

有关 API 用法，请参阅[AJAX 示例](http://api.drupal.org/api/examples/ajax_example!ajax_example.module/group/ajax_example/7)、[AJAX 优雅降级](http://api.drupal.org/api/examples/ajax_example!ajax_example_graceful_degradation.inc/group/ajax_degradation_example/7)和[AJAX 命令](http://api.drupal.org/api/examples/ajax_example!ajax_example_advanced.inc/7)示例模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-21T01:21:18.163

使用 pjax，它易于实现且对 SEO 友好。对于不受支持的浏览器，主要是 IE 10 以下，它只是回退到默认浏览器行为（您无需任何工作）。

我已经在少数项目中成功使用了 pjax，并计划在更多项目中使用它。

[您可以在此处](https://github.com/defunkt/jquery-pjax)找到有关 pjax 的更多信息。

既然您提到了您使用 Drupal，您可能会发现[这篇文章](https://www.drupal.org/project/pjax)很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T18:38:48.110

因为您使用的是 PHP 和 jQuery，所以最好的选择是**我的项目**phery [http://phery-php-ajax.net](http://phery-php-ajax.net)，它得到了积极的维护，并且在过去的 2 年里我一直在改进它。

通过使用视图，您可以在单独的 ajax 视图中分割您的站点，或者通过 AJAX 使用完整的页面内容。它是 SEO 友好的，并且由于它使用事件委托，所有新元素都已经 ajaxified。它不强制使用历史 API 或哈希事件，您可以决定最适合您的功能。

为您的网站加载完整的 AJAX 内容将是（当然只有容器，不包括菜单、页脚等）

```
 var ever_pushed = false; // needed for chrome

    phery.view({
        '#container': {
            'exclude': ['/blog'], // exclude wordpress from it
            'beforeSend': function(){
                $('body,html').scrollTop(0); // go to the top
            },
            'render': function(html, data, passdata){
                var $this = $(this);
                nav_items.removeClass('current').filter('.' + data.controller).addClass('current'); // update the menu
                document.title = data.title; // set the document title

                /* Good browsers get history API */
                if (typeof passdata['popstate'] === 'undefined') {
                    window.history.pushState(data, data.title, data.url);
                    ever_pushed = true;
                }

                _gaq.push(["_trackPageview"]); // Google analytics

                $('#content')
                .find('>div')
                .animate({'opacity':0}, 375) // fadeout
                .promise()
                .done(function(){
                    $body.removeClass().addClass(data.body_class);
                    $this.html('').html(html);
                    on_reload(); // restart events that need to be bound on new elements
                    cufonize(true); //apply cufon
                    $('#content').find('>div').animate({'opacity':1}, 375); // fadein
                });
            }
        }
    });

    $(window).bind('popstate', function(e){
        if (!ever_pushed) {
            return;
        }
        phery.view('#container').navigate_to(document.location.toString(), null, {'popstate':true}); // back and forward history buttons
    }); 
```

相同代码的较小版本将是：

```
$(function(){
    var ever_pushed = false;
    phery.view({
        '#container': {
            'afterHtml': function(html, data, passdata){
                /* Good browsers get history API */
                if (typeof passdata['popstate'] === 'undefined') {
                    window.history.pushState(data, data.title, data.url);
                    ever_pushed = true;
                }

            }
        }
    });

    $(window).bind('popstate', function(e){
        if (!ever_pushed) {
            return;
        }
        phery.view('#container').navigate_to(document.location.toString(), null, {'popstate':true}); // back and forward history buttons
    });
}); 
```

在您的 PHP 方面，它将是：

```
function render_view($data, $params, $phery){
   return PheryResponse::factory()->render_view(views_get_view('all_projects')->execute_display('Block', array()));
}
//...
public function render($reset = FALSE){
   Phery::instance()->views(array(
     '#container' => array($this, 'render_view')
   ))->process();
}
//... 
```

# mysql - JSF 从多个表中检索数据

> ID：10853185
> 
> 赞同：0
> 
> 时间：2012-06-01T15:30:16.297
> 
> 标签：mysql, hibernate, jsf

我正在尝试在 jsf 页面上显示来自多个表的数据。该页面与支持 bean 绑定。现在，有很多方法可以做到这一点。

方法一：我可以使用实体对象获取hibernate生成的实体对象上的整个table_row。方法 2：我可以创建 POJO（值 bean）来保存数据并自己在 HQL 中编写查询。

注意：数据来自多个表。

有人提出第一种方法，有人提出第二种。现在的问题是， **当我需要特定表的特定列时，为什么我要从数据库中检索一整行，但另一方面又想到了实体的用途是什么？**

我希望我能很好地解释我的问题。请指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:42:48.630

就个人而言，我会使用第二种方法。只需让支持 bean 调用 DAO 方法来填充在 bean 中创建的 POJO 实例。如果不需要很多数据。这样您就可以只查询您需要的数据，但是如果您曾经想过将来会使用其他一些数据，那么您已经有后端编码以在实体类中检索它，而使用 pojo 您将不得不更改DAO、POJO 和 JSF。

# c# - 如何正确使用 TcpClient ReadTimeout

> ID：10853186
> 
> 赞同：26
> 
> 时间：2012-06-01T15:30:16.393
> 
> 标签：c#, .net, tcpclient

在花费了比看起来更合理的时间来找到这个简单问题的答案之后，我想我会把我的结果留在这里，这样其他人就不必跳过我刚刚遵循的所有箍和错误的路径。

问题是，如果您使用 TcpClient ReadTimeout 属性并且您的读取操作实际上超时，Microsoft 决定关闭套接字。我所知道的任何其他套接字实现都没有做到这一点，这不是预期的、不可取的，而且除了程序员的懒惰之外，没有任何正当理由认为应该是这种情况。但这正是微软选择做的事情。

无论如何，我发现的所有解决方法，包括在这个站点上，都有各种方式来进行某种形式的繁忙轮询，有些甚至涉及启动另一个线程来执行简单的读取调用。很抱歉，我的 CPU 有比坐在那里忙着投票更好的事情，尤其是在许多套接字打开的情况下，所以这对我来说不是一个选择。毕竟，这不是 1990 年代初期，繁忙的投票只是你做事的方式。如今，我们有一种称为操作系统的东西，它使用中断非常有效地处理这些类型的事情。

无论如何，在另一个切线搜索中，我偶然发现了这篇旧博客文章：

[http://blogs.msdn.com/b/mflasko/archive/2006/02/20/535655.aspx](http://blogs.msdn.com/b/mflasko/archive/2006/02/20/535655.aspx)

MSDN 博客 > Mike Flasko 的博客 > 处理读取网络数据时的超时

告诉您如何正确处理读取超时的解决方案的关键要点是：

> 在这一点上，人们可能会想捕捉异常，然后在同一个 NetworkStream 上重新发出读取。此策略可能导致意外错误。最好的办法是现在将 NetworkStream（套接字）视为处于不稳定状态。这是因为当底层堆栈超时时，底层 I/O 读取被取消。如果数据同时进来，数据就会丢失，导致数据流损坏。

和解决方案：

> 更好的方法是捕获异常，关闭套接字或 TCPClient 并在必要时重新连接。

虽然我仍然认为这会给 API 的用户带来不必要的负担，但至少它是我在试图找出半正确套接字 ReadTimeout 的数十个站点中能够找到的最合适的解决方案。

我希望这个问题/评论可以节省我找到的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-14T16:40:43.800

您正在寻找的是 Poll 或 Select 方法，这些方法允许您在不关闭底层连接的情况下等待超时数据：

[http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.poll%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.poll%28v=vs.110%29.aspx) [http://msdn.microsoft.com/en-us/library /system.net.sockets.socket.select%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.select%28v=vs.110%29.aspx)

# c# - 使用三元语法将参数设置为 DBNull.Value 会出错？

> ID：10853191
> 
> 赞同：21
> 
> 时间：2012-06-01T15:30:36.610
> 
> 标签：c#, .net, enterprise-library, conditional-operator

我有以下代码来设置一个参数，该参数将在 INSERT 语句中用于设置 SQL Server 数据库中的 VARCHAR 列。我的值对象（名为 ilo）有一个名为 Description 的属性，该属性被初始化为 String.Empty，然后设置为从 XML 读取的某个值，或者如果该 XML 元素为空，它就保持为 String.Empty。

所以在插入数据库时​​，如果属性仍然设置为 String.Empty，我想让它插入一个空值。

```
database.AddInParameter(cmd, "@description", DbType.String, 
                           (ilo.Description.Equals(string.Empty)) ?
                            DBNull.Value :
                            ilo.Description); 
```

所以基本上我是说，如果 ilo.Description 等于 string.empty，则将参数设置为 DBNull.Value，否则将其设置为 ilo.Description。

这会在 Visual Studio 中出现以下错误...

错误 141 条件表达式的类型无法确定，因为 'System.DBNull' 和 'string' 之间没有隐式转换

为什么？

奇怪的是，我可以毫无错误地执行以下操作，这应该与使用上面的内联条件语法完全相同！？！

```
if(ilo.Description.Equals(string.Empty))
{
    database.AddInParameter(cmd, "@description", DbType.String, DBNull.Value);
}
else
{
    database.AddInParameter(cmd, "@description", DbType.String, ilo.Description);
} 
```

我搜索了其他帖子，找到了下面的帖子，但它并没有真正回答我的问题。

[EntLib 将“空”值绑定到参数的方法](https://stackoverflow.com/questions/1252677/entlib-way-to-bind-null-value-to-parameter)

我对 WHY 更感兴趣，因为显而易见的解决方法是只使用 if/else 语句而不是内联（三元）语法？

在这个链接上有一个答案，但我想要一个更好的解释，因为这对我来说似乎是废话，这不起作用；我会称之为错误！

[http://msdn.microsoft.com/en-us/library/ty67wk28.aspx](http://msdn.microsoft.com/en-us/library/ty67wk28.aspx)

编辑：2021 年 3 月 30 日，我写这个问题已经 9 年了。最后，从 C# 9 开始，此问题已得到修复。三元表达式现在支持混合类型，只要它们可以被隐式转换。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-06-01T15:41:12.063

这是人们在使用条件运算符时收到的常见错误。要修复它，只需将一个或两个结果转换为一个通用的基本类型。

```
ilo.Description.Equals(string.Empty) 
     ? (object)DBNull.Value 
     : ilo.Description 
```

您看到的错误消息中揭示了该问题。

> 无法确定条件表达式的类型，因为 'System.DBNull' 和 'string' 之间没有隐式转换

字符串不是 DBNull，DBNull 也不是字符串。因此，编译器无法确定表达式的类型。通过使用转换为通用基本类型（在本例中`object`为使用您的代码行也期望作为 DbParameter 参数的内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-10T14:36:58.087

这是我在另一个线程中发现的，它对我很有用：

```
yourVariable ?? (object)DBNull.Value 
```

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T16:03:49.557

安东尼确实是正确的，所以他应该得到正确的答案，但是这里有一个扩展方法，因为我很无聊......

```
 public static object NullCheck(this string self)
    {
        return (string.IsNullOrEmpty(self)) ? (object)DBNull.Value : self;
    } 
```

在您的场景中使用：

```
database.AddInParameter(cmd, "@description", DbType.String, 
                           ilo.Description.NullCheck()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T15:41:28.127

您会收到编译错误，因为三元表达式的两个部分必须属于同一类型。对于这种特殊情况，最简单的解决方法是将两者都转换为一个对象：

```
database.AddInParameter(cmd, "@description", DbType.String, 
                           (ilo.Description.Equals(string.Empty)) ?
                            (object) DBNull.Value :
                            (object) ilo.Description); 
```

# neural-network - 在 C++ 中使用 MATLAB 生成的神经网络

> ID：10853192
> 
> 赞同：4
> 
> 时间：2012-06-01T15:30:37.900
> 
> 标签：neural-network, matlab, matlab-deployment

我用 MATLAB 生成了一个网络。我可以通过以下命令在 MATLAB 中查看此网络的输入结果：

```
sim(net, 0.01) 
```

我想用 MATLAB 生成的“net”在 C++ 中完成这项工作。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T13:07:00.163

如果您可以生成网络的 Simulink 模型，那么您可以将网络导出为 C 语言（如*[将神经网络导出为 C++](http://compgroups.net/comp.soft-sys.matlab/exporting-neural-network-to-c++/408091)*），这很简单。但我不认为这种方法可以很好地将神经网络用于其他程序。

对我来说，更好的解决方案是使用神经网络公式（如*[尝试自己在 MATLAB 中模拟神经网络](https://stackoverflow.com/questions/11739684/try-to-simulate-a-neural-network-in-matlab-by-myself)*）并使用从 MATLAB 中经过训练的网络导出的网络权重用于您自己的程序中，因为它很容易和清洁。

# css - LESS CSS - ID 和背景参数

> ID：10853193
> 
> 赞同：1
> 
> 时间：2012-06-01T15:30:38.443
> 
> 标签：css, less

而不是在我的 .less 文件中重复这个 CSS。有人知道如何为以下内容创建 LESS 函数吗？

```
li  #prize-1 span {
                background: url('@{imagesUrl}/1.png') no-repeat;
                width: 874px;
                height: 188px;
            }   
li  #prize-2 span {
                background: url('@{imagesUrl}/2.png') no-repeat;
                width: 874px;
                height: 188px;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:37:08.550

会不会是这样的

```
.definition (@image: nameOfImageDefault) {
  background: url('@{imagesUrl}/@{image}') no-repeat;
  width: 874px;
  height: 188px;
}

li  #prize-1 span {
    .definition(nameOfImage);
        }   
li  #prize-2 span {
    .definition(nameOfImage);
} 
```

我对LESS不太熟悉，所以我认为这可行

编辑：

我在他们的主页上关注这个例子

```
.rounded-corners (@radius: 5px) {
  border-radius: @radius;
  -webkit-border-radius: @radius;
  -moz-border-radius: @radius;
}

#header {
  .rounded-corners;
}
#footer {
  .rounded-corners(10px);
} 
```

还有哪个部分没有工作？背景图片？也许尝试以名称作为变量来获取整个图像路径

# search - 使用 umbraco 4.7 和中等信任度检查网站搜索

> ID：10853196
> 
> 赞同：0
> 
> 时间：2012-06-01T15:31:01.083
> 
> 标签：search, umbraco, medium-trust

我正在尝试使用 umbraco 检查进行网站搜索。它在开发机器上工作正常，但是，在共享主机上，索引没有被构建。共享主机使用中等信任。我试过做这里提到的步骤：http: [//our.umbraco.org/wiki/install-and-setup/medium-trust-with-umbraco-45plus](http://our.umbraco.org/wiki/install-and-setup/medium-trust-with-umbraco-45plus)，但我不能使用第一步：

```
<trust level="Medium" originUrl=".*" /> 
```

它给出了这个错误：

```
This configuration section cannot be used at this path.  This happens when the site administrator has locked access to this section using <location allowOverride="false"> from an inherited configuration file. 
```

**我可以在中等信任的共享主机环境中使用 umbraco 检查吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T19:02:03.207

您需要添加一个：

要求权限=“假”

到配置部分声明：

```
<section name="Examine" type="Examine.Config.ExamineSettings, Examine" requirePermission="false"/>   
<section name="ExamineLuceneIndexSets" type="Examine.LuceneEngine.Config.IndexSets, Examine" requirePermission="false" /> 
```

# javascript - 这是可丢弃的坏习惯吗？

> ID：10853198
> 
> 赞同：2
> 
> 时间：2012-06-01T15:31:03.687
> 
> 标签：javascript, jquery

每当用户按下 div 按钮时，我都想注册一个 droppable。我正在设置一个闭包
`add.droppable({})`，`var toDrop`然后调用`toDrop`如下方法，这是一个不好的做法吗？

例如，`toDrop.addClass("newColors");`我应该使用类似的东西而不是

```
this.addClass("newColors") 
```

这是完整的片段：

```
$("#myDiv").on('click' , '.colors' , function() { 
    var add = $(this).parent();
        var toDrop = add.droppable({
            drop: function(event, ui) {
            toDrop.addClass("newColors");
            toDrop.attr("portletName", parameter);
        }
    });  
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:38:39.413

除非您想`tpDrop`在放置处理程序之外使用该变量，否则建议使用`this`关键字而不是创建代表可放置元素的闭包。

所以你应该使用`$(this).addClass("newColors");`

您可以使用 jQuery 链接功能。

`$(this).addClass("newColors").attr("portletName", parameter);`

# java - 使用输入循环创建动态对象

> ID：10853199
> 
> 赞同：0
> 
> 时间：2012-06-01T15:31:05.613
> 
> 标签：java, arrays, loops

我已经成功完成，程序没有问题，一切正常，除了它没有显示这本书的最高和最低价格。但是，我不想要这样的程序。

目前，该程序由包含书名的预定义数组组成，也就是说，每当用户输入一本书的输入时，程序都会显示书名和书的价格。所以，我在想一些不同的东西，那就是没有在数组中预先存储书名和价格。

无论用户键入的书名是什么，该书名都将与价格一起存储为数组。循环3次，即在输入1次书名和价格后，会再次提示用户输入书名，最后会显示总书本和价格以及最高最低价格。书，用户购买。

谁能帮我这个？请在下面查看我的编码：

```
import java.util.Scanner;
public class BookStore {
    public static void main(String args[]){
        Scanner input = new Scanner(System.in);
        String[] books = {"Introduction To Java","Artificial Intlegence","Web Programming","Introduction To Database","English Speech","Introduction To C#"};

        double[] prices ={100,50,25,45,60,90}; 

        System.out.println("Welcome to SAJID's Book Shop");
        System.out.println();
        System.out.println("Please select the the book and write the number of the book :");
        System.out.println();
        System.out.println("1.Introduction To Java");
        System.out.println("2.Artificial Intlegence");
        System.out.println("3.Web Programming");
        System.out.println("4.Introduction To Database");
        System.out.println("5.English Speech");
        System.out.println("6.Introduction To C#");
        System.out.println();

        System.out.println("Total Number Of Books "+books.length);
        int totalBook;
        totalBook = books.length;

        double totalPrice=0;    
        int i=0;            
        while(i<=5){
            totalPrice+=prices[i];
            i++;
        }

        System.out.println("Total Price:$" + totalPrice);

        int bookTitle;
        System.out.print("Enter book Number: ");
        bookTitle = input.nextInt();

        if(bookTitle == 0){
            System.out.println("Book name: "+books[0]);
            System.out.print("Book price:$"+prices[0]);
            }

        if(bookTitle == 1){

            System.out.println("Book name: "+books[1]);
            System.out.print("Book price:$"+prices[1]);
        }
        if(bookTitle == 2){

            System.out.println("Book name: "+ books[2]);
            System.out.print("Book price:$"+prices[2]);
        }
        if(bookTitle == 3){

            System.out.println("Book name: "+books[3]);
            System.out.print("Book price:$"+prices[3]);
        }
        if(bookTitle == 4){

            System.out.println("Book name: "+books[4]);
            System.out.print("Book price:$"+prices[4]);
        }
        if(bookTitle == 5){

            System.out.println("Book name: "+books[5]);
            System.out.print("Book price:$"+prices[5]);
        }

        /*double min=0;
        for(i=0;i<books.length-1;i++){

            if(books[i] =< books[i++]){
                min=books[i];
                minBook = i;
            }*/
        }

        //System.out.print("Cheapest book: " + min);
    }       
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:12:19.327

因为您使用的是动态输入，所以您最终可以得到任意数量的书籍，这就是您不应再使用数组的原因。它们的大小不能轻易改变，所以我建议你改为[ArrayList](http://www.java-samples.com/showtutorial.php?tutorialid=234)。

此外，由于您的书籍和价格数组密切相关，您可能希望创建自己的 Book 对象来存储此信息。例如：

```
public class Book {
    String title;
    double price;
    public Book(String title, double price) {
        this.title = title;
        this.price = price;
    }
    public String getTitle() {
        return title;
    }
    public void setTitle(String title) {
        this.title = title;
    }
    public double getPrice() {
        return price;
    }
    public void setPrice(double price) {
        this.price = price;
    }
} 
```

为了使整个事情动态化，你基本上需要重写你的大部分代码，我已经在下面完成了。我不确定我是否在这里做了家庭作业，但如果是，我强烈建议您通读整个代码以了解它的作用。

```
Scanner input = new Scanner(System.in);
List<Book> books = new ArrayList<Book>();
boolean done = false;

System.out.println("Welcome to SAJID's Book Shop\n");
// Now the user can input some books.
String title;
double price;
while (!done) {
    System.out.println("Enter a book title (nothing to stop): ");
    title = input.nextLine();
    if (title.isEmpty()) {
        // User didn't enter a title, stop this loop.
        done = true;
    }
    else {
        System.out.println("Enter a price: ");
        price = input.nextDouble();
        // Because nextDouble() only reads the next number and doesn't finish the entire line, we have to manually go to the next line.
        input.nextLine(); 
        // Create a new book and add it to our shop.
        Book newBook = new Book(title, price);
        books.add(newBook);
    }
}

System.out.println("The following books are for sale:");
for (int i = 0; i < books.size(); i++) {
    // Remember that the first book in our list is number 0, not 1, so we add 1 to i.
    System.out.println((i + 1) + ". - " + books.get(i).title);
}
System.out.println("Total Number Of Books "+ books.size());

// Now buy some books.
List<Book> purchasedBooks = new ArrayList<Book>();
done = false;
String line;
int bookNumber;
while (!done) {
    System.out.println("Enter the number of a book you'd like to buy (0 to stop): ");
    bookNumber = input.nextInt();
    input.nextLine();
    if (bookNumber == 0) {
        // We stop if the user enters 0.
        done = true;
    }
    else {
        // Remember that the first book in our list is number 0, not 1.
        purchasedBooks.add(books.get(bookNumber - 1));
    }
}

System.out.println("You're buying these books:");
double totalPrice = 0;
for (int i = 0; i < purchasedBooks.size(); i++) {
    // Remember that the first book in our list is number 0, not 1, so we add 1 to i.
    System.out.println((i + 1) + ". - " + purchasedBooks.get(i).price + " - " + purchasedBooks.get(i).title);
    totalPrice += purchasedBooks.get(i).price;
}
System.out.println("Total Number Of Books Bought: " + purchasedBooks.size());
System.out.println("Total Price: " + totalPrice);

// Find the cheapest and the most expensive book.
Book minBook = purchasedBooks.get(0);
Book maxBook = purchasedBooks.get(0);
// Iterate over our books using a foreach loop.
for (Book book : purchasedBooks) {
    if (book.price < minBook.price) {
        minBook = book;
    }
    else if (book.price > maxBook.price) {
        maxBook = book;
    }
}
System.out.println("Cheapest Book: " + minBook.title + " (" + minBook.price + ")");
System.out.println("Most Expensive Book: " + maxBook.title + " (" + maxBook.price + ")"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:41:03.617

我完全有可能误解了您的要求，在这种情况下，请忽略以下所有内容。

目前，您正在将当前迭代的书与下一本书进行比较，并在 for 循环中添加 i 两次。尝试这个：

```
double min = prices[i];
int minBook = 0;
for(int i = 1; i < books.length; i++) {
    if(prices[i] < min) {
        min = prices[i];
        minBook = i;
    }
}
System.out.print("Cheapest book: " + books[minBook]); 
```

您可以对最大值执行类似的操作：

```
double max = prices[i];
int maxBook = 0;
for(int i = 1; i < books.length; i++) {
    if(prices[i] > max) {
        max = prices[i];
        maxBook = i;
    }
}

System.out.print("Cheapest book: " + books[maxBook]); 
```

当然，这假设您的书籍列表不为空。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:12:10.757

我发布的有点晚，但你去吧。我摆脱了所有的 if 语句并使用了一个开关，对您的价格数组进行了排序并更改了一些循环。**编辑**哎呀！我搞砸了。你想要最便宜的书，而不是我所做的最便宜的书价。

```
 Scanner input = new Scanner(System.in);
    String[] books = {"Introduction To Java","Artificial Intlegence","Web Programming","Introduction To Database","English Speech","Introduction To C#"};

    double[] prices ={100,50,25,45,60,90};

    System.out.println("Welcome to SAJID's Book Shop");
    System.out.println();
    System.out.println("Please select the the book and write the number of the book :");
    System.out.println();
    System.out.println("1.Introduction To Java");
    System.out.println("2.Artificial Intlegence");
    System.out.println("3.Web Programming");
    System.out.println("4.Introduction To Database");
    System.out.println("5.English Speech");
    System.out.println("6.Introduction To C#");
    System.out.println();

    System.out.println("Total Number Of Books "+books.length); 

    double totalPrice=0;
    for(int i = 0; i<=5; i++){
        totalPrice+=prices[i];
    }

    System.out.println("Total Price:$" + totalPrice);

    System.out.print("Enter book Number: ");

    int bookTitle = input.nextInt();
    switch(bookTitle){
      case 1:
        System.out.println("Book name: "+books[0]);
        System.out.println("Book price:$"+prices[0]);
        break;
      case 2:
        System.out.println("Book name: "+books[1]);
        System.out.println("Book price:$"+prices[1]);
        break;
      case 3:
        System.out.println("Book name: "+ books[2]);
        System.out.println("Book price:$"+prices[2]);
        break;
      case 4:
        System.out.println("Book name: "+books[3]);
        System.out.println("Book price:$"+prices[3]);
        break;
      case 5:
        System.out.println("Book name: "+books[4]);
        System.out.println("Book price:$"+prices[4]);
        break;
      default:// since there are only 5 books use #6 as default
        System.out.println("Book name: "+books[5]);
        System.out.println("Book price:$"+prices[5]);
        break;
  }

    // assuming the prices array holds the price of each individual book
    // sort the prices array
    java.util.Arrays.sort(prices);
    System.out.println("Cheapest book: " + prices[0]);
    System.exit(0); 
```

}

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T15:36:22.417

这可能不是您的问题（我还没有真正理解），但这对于评论来说太长了。您可以通过以下方式替换所有 ifs 开始：

```
if(bookTitle >= 0 && bookTitle <= 5){
    System.out.println("Book name: "+books[bookTitle]);
    System.out.print("Book price:$"+prices[bookTitle]);
} 
```

# java - Android按属性排序arraylist

> ID：10853205
> 
> 赞同：67
> 
> 时间：2012-06-01T15:31:26.433
> 
> 标签：java, android, sorting, arraylist

我想`ArrayList`按属性排序。这是我的代码...

```
public class FishDB{

    public static Object Fish;
    public ArrayList<Fish> list = new ArrayList<Fish>();

    public class Fish{
        String name;
        int length;
        String LatinName;
        //etc. 

        public Vis (String name) {
            this.name = name;
        }
    }

    public FishDB() {
        Fish fish;

        fish = new Fish("Shark");
        fish.length = 200;
        fish.LatinName = "Carcharodon Carcharias";

        fish = new Fish("Rainbow Trout");
        fish.length = 80;
        fish.LatinName = "Oncorhynchus Mykiss";

        //etc.
        }
    }
} 
```

现在我想`ArrayList`按一个属性对它进行排序，例如`latinname`在另一个活动中。但我不知道该怎么做。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2012-06-01T15:34:32.117

您需要实现 a `Comparator`，例如：

```
public class FishNameComparator implements Comparator<Fish>
{
    public int compare(Fish left, Fish right) {
        return left.name.compareTo(right.name);
    }
} 
```

然后像这样排序：

```
Collections.sort(fishes, new FishNameComparator()); 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2014-11-20T04:56:29.367

您可以通过以下代码简单地做到这一点：

```
Collections.sort(list, new Comparator<Fish>() {
    public int compare(Fish o1, Fish o2) {
        return o1.name.compareTo(o2.name);
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-02-06T09:26:32.737

*科特林代码*

```
list.sortWith(Comparator { o1, o2 -> o1.name!!.compareTo(o2.name!!) }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-30T19:45:53.450

如何实现相同的目标有多种选择。最简单的解决方案是利用 Java 8 特性：

```
Collections.sort(Fish, (t1, t2) -> t1.name().compareTo(t2.name())); 
```

# java - 重写 Enum#toString 不可取？

> ID：10853206
> 
> 赞同：9
> 
> 时间：2012-06-01T15:31:29.050
> 
> 标签：java, enums

我刚刚注意到[`Enum#toString`javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Enum.html#toString%28%29)状态（强调我的）：

> 返回声明中包含的此枚举常量的名称。**此方法可能会被覆盖，尽管它通常不是**必需的或**不可取的**。当存在更“程序员友好”的字符串形式时，枚举类型应覆盖此方法。

默认情况下，`toString()`返回[`name()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Enum.html#name%28%29)相同的东西，所以即使`toString`被覆盖，仍然可以通过`name()`方法访问枚举的名称。

有谁知道为什么`Enum#toString`不希望覆盖？

编辑：作为参考，`name()`'s javadoc（重点与原文相同）：

> 返回此枚举常量的名称，与其枚举声明中的声明完全相同。**大多数程序员应该优先使用 toString() 方法而不是这个方法，因为 toString 方法可能会返回一个对用户更友好的名称**。此方法主要设计用于正确性取决于获取确切名称的特殊情况，该名称不会因版本而异。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:35:25.600

使用枚举，您有一组特定的常量值。当`toString`为该枚举调用方法时，通常会期望返回名称，因此覆盖该`toString`方法会返回一些意想不到的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:44:11.167

如果您的枚举比它们的名称更复杂，例如，如果它们包含私有字段，则`toSting()`可以覆盖以打印这些并给出对枚举字段的更好解释，而不仅仅是其名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:14:53.900

我认为这里的“理想”一词的含义存在一些混淆。javadoc 基本上说了两次同样的事情：枚举通常不需要覆盖 toString() ，因此这样做没有用（可取）。

所以回答你的问题：如果：A）你知道你永远不必显示枚举名称的字符串表示，或者 B）默认字符串表示足以识别枚举，则不希望覆盖 toString( **)**是否需要这样做。

# rest - 如何为机器和人类使用一个 REST API？

> ID：10853207
> 
> 赞同：2
> 
> 时间：2012-06-01T15:31:29.480
> 
> 标签：rest, hateoas

我对使用 REST API 构建 Web 服务很感兴趣。我一直在阅读有关 HATEOAS 的文章，许多示例通过将其与人类在网上冲浪时的行为进行比较来解释该概念。这让我在想，为什么不以人类和机器都可以轻松使用的方式构建 REST API？

例如，我有一个小部件的内部模型，该小部件具有部件号、价格等属性。当机器请求小部件列表时，我可以返回一个 JSON 表示。

```
{
    widgets: [
        {
            id: 1,
            part_number: "FOO123",
            price: 100,
            url: "/widget/1"
        },
        {
            id: 2,
            part_number: "FOO456",
            price: 150,
            url: "/widget/2"
        },
        {
            id: 3,
            part_number: "FOO789",
            price: 200,
            url: "/widget/3"
        },
        ...
    ]
} 
```

当一个人通过他/她的网络浏览器请求相同的列表时，似乎我应该能够采用相同的内部模型并对其应用不同的视图来生成 HTML 响应。（当然，我会用其他页面元素来装饰 HTML 响应，例如页眉、页脚等）

这是一个明智的设计吗？为什么或者为什么不？是否有任何流行的网站实际上正在这样做？

我看到的最大缺点是用户没有明显的方法来删除资源。在我的用例中，我不会让用户修改或删除资源，所以这不会破坏交易，但一般来说，你会如何处理呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T15:49:16.337

@mehaase

首先，我建议使用一种已注册的 JSON 超媒体格式：

*   集合+JSON：[http ://amundsen.com/media-types/collection/format/](http://amundsen.com/media-types/collection/format/)
*   Collection.next+JSON： [http ://code.ge/media-types/collection-next-json/](http://code.ge/media-types/collection-next-json/)
*   HAL - 超文本应用语言： [http ://stateless.co/hal_specification.html](http://stateless.co/hal_specification.html)

它们都为创建具有语义链接关系的链接提供了显式语义。

例如，使用 Collection(.next)+JSON 你可以像这样表达你的小部件：

```
{"collection": {
  "version": 1.0,

  "items": [{
    "href": "/widget/1",

    "data": [{
      "name": "id",
      "value": 1,
      "prompt": "ID"
    }, {
      "name": "part_number",
      "value": "FOO123",
      "prompt": "Part number"
    }, {
      "name": "price",
      "value": 100,
      "prompt": "Price"
    }],

    "links": [{
      "rel": "self",
      "href": "http://...",
    }, {
      "rel": "edit",
      "href": "http://..."
    }]

  }]
}} 
```

这为您提供了几个优势：

*   您不需要重新发明轮子来指定链接
*   您可以自由使用所有已注册的链接关系类型： [http ://www.iana.org/assignments/link-relations/link-relations.xml](http://www.iana.org/assignments/link-relations/link-relations.xml)
*   根据您的数据结构，您可以轻松使用上述格式的集合/项目语义
*   如果需要，您也可以描述输入表单

正如您从示例中看到的，它有足够的信息用于转换为 HTML（或其他格式）。

> 我看到的最大缺点是用户没有明显的方法来删除资源。在我的用例中，我不会让用户修改或删除资源，所以这不会破坏交易，但一般来说，你会如何处理呢？

对于这个阅读“编辑”链接关系规范，它意味着可以删除资源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T17:05:56.533

您可以做几件事，但第一个前提是现代“通用”网络浏览器确实是糟糕的 REST 客户端。

如果你的大部分交互都是由 JavaScript 保护和管理的，如果你编写一个“富客户端”，可以说你更多地依赖于 JS 生成的请求，而不是简单的链接、表单和后退按钮，那么它可能会更好REST 客户端。

如果您被表单和链接的通用浏览器体验所困扰，您可以通过重载 POST 来解决缺少其他 HTTP 动词的问题。你失去了中介机构的一些保证。DELETE 是幂等的，POST 不是，这会产生影响，但它不是毁灭性的，你只需要解决它。你可以用 POST 做幂等的事情，但中间人不会“知道”它们是，所以他们不能假设它是幂等的。

如果你最终不得不去“POST uber alles”，你要么将你的机器客户端限制在相同的 api 上，要么提供并行服务——那些被 POST 愚蠢的客户端使用的服务，以及其他对他们可用的全色域的服务。 .

也就是说，如果您选择基于 XML 的超媒体格式，那么您可以将 XSL 转换添加到 XML 有效负载中。浏览器将在有效负载上运行 XSL，创建一个你喜欢的漂亮页面（页眉、页脚、足够的 JS 来窒息马等），而机器将忽略它的这方面并只关注给定的数据。

在这方面为您提供“两全其美”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:45:30.050

您始终可以构建一个 REST API，然后围绕它构建您自己的人性化 Web 应用程序。这是一种常见的做法，因为您拥有开箱即用的功能和可供开发人员使用的可扩展系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-02T14:30:25.553

只需使用带有 RDFa 的 HTML 就可以做到这一点。所以人类可以阅读 HTML，机器可以阅读 RDFa 注释。您需要一个像 hydra 这样的 REST 词汇来注释链接，并需要其他词汇，比如 schema.org 来注释内容。

为不同类型的客户端使用不同媒体类型的另一种选择，例如用于人类的 HTML 和用于机器的 JSON-LD。

# java - 使用 Java 发送邮件时出错

> ID：10853209
> 
> 赞同：3
> 
> 时间：2012-06-01T15:31:31.360
> 
> 标签：java, sendmail, jakarta-mail, javax.activation

我的代码是：

```
// File Name SendEmail.java

import java.util.*;
import javax.mail.*;
import javax.mail.internet.*;
import javax.activation.*;

public class SendEmail
{
   public static void main(String [] args)
   {

      // Recipient's email ID needs to be mentioned.
      String to = "toEmail@gmail.com";

      // Sender's email ID needs to be mentioned
      String from = "fromEmail@gmail.com";

      // Assuming you are sending email from localhost
      String host = "localhost";

      // Get system properties
      Properties properties = System.getProperties();

      // Setup mail server
      properties.setProperty("mail.smtp.host", host);

      // Get the default Session object.
      Session session = Session.getDefaultInstance(properties);

      try{
         // Create a default MimeMessage object.
         MimeMessage message = new MimeMessage(session);

         // Set From: header field of the header.
         message.setFrom(new InternetAddress(from));

         // Set To: header field of the header.
         message.addRecipient(Message.RecipientType.TO,
                                  new InternetAddress(to));

         // Set Subject: header field
         message.setSubject("This is the Subject Line!");

         // Now set the actual message
         message.setText("This is actual message");

         // Send message
         Transport.send(message);
         System.out.println("Sent message successfully....");
      }catch (MessagingException mex) {
         mex.printStackTrace();
      }
   }
} 
```

昨晚我的程序运行正常；我可以从任何地址向任何其他地址发送电子邮件，但现在发生了此错误：

```
javax.mail.SendFailedException: Sending failed;
  nested exception is:
    class javax.mail.MessagingException: Could not connect to SMTP host: localhost, port: 25;
  nested exception is:
    java.net.ConnectException: Connection refused
    at javax.mail.Transport.send0(Transport.java:218)
    at javax.mail.Transport.send(Transport.java:80)
    at SendEmail.main(SendEmail.java:49) 
```

第 49 行是：

```
Transport.send(message); 
```

谁能帮我解决这个错误？

我的操作系统是：Linux,Fedora 16 -kernel: 3.3.7

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:36:02.373

> *无法连接到 SMTP 主机：localhost，端口：25；*

SMTP 必须未在您的系统上运行或为您作为用户禁用。请咨询您的系统管理员并为您启用它。

要检查 SMTP 是否在您的 Linux 系统上运行，请尝试以下命令：

1.  要简单地验证 Sendmail 是否正在运行，请尝试：`netstat -an | grep 25`
2.  使用 telnet 连接 smtp 服务器`telnet <yourhost-or-ipnumber> 25`
    的25 端口：*Connecting To localhost...Could not open connection to the host, on port 25: Connect failed*。
    湾。如果您或您的 ip 被阻止，您会看到如下错误消息：
    *220-localhost ESMTP Exim 4.63 #1 Fri, 01 Jun 2012 19:35:30 +0530
    220-我们不授权使用此系统传输未经请求的和/或批量电子邮件。*
3.  `echo -e "quit" | nc localhost 25`
    *localhost.localdomain [127.0.0.1] 25 (?) : 连接被拒绝*
4.  在 shell 提示符下[发送邮件。](http://linux.about.com/od/commands/l/blcmdl1_Mail.htm)
5.  而且，可能更多……

您应该检查`sendmail`守护程序是否已启动并且始终可用。

如果您有权访问任何其他 SMTP 服务器，请尝试使用其 SMTP 主机名发送邮件，以检查您的代码片段是否正常工作。
例子 ：`String host = "smtp.gmail.com";`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:06:48.427

这是因为我的 SendMail 服务停止工作。

启用它：在 shell 中尝试这个命令（以 root 身份）。

```
service sendmail start 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-03T11:22:56.323

你在正确的方式..只需更改属性设置和会话语句.我的 java 邮件工作正常...

```
final String username = "abc@gmail.com";
            final String password = "****";

            Properties props = new Properties();
            props.put("mail.smtp.auth", "true");
            props.put("mail.smtp.starttls.enable", "true");
            props.put("mail.smtp.host", "smtp.gmail.com");
            props.put("mail.smtp.port", "587");

            Session session = Session.getInstance(props, new javax.mail.Authenticator() {
                protected PasswordAuthentication getPasswordAuthentication() {
                    return new PasswordAuthentication(username, password);
                }
            }); 
```

# java - Java GUI 中的命令行界面

> ID：10853210
> 
> 赞同：0
> 
> 时间：2012-06-01T15:31:32.390
> 
> 标签：java, swing, user-interface, command-line

我想在 Java GUI 窗口中实现命令行界面。有没有这样做的好方法或我可以使用的现有项目/示例？

我的应用程序在 GUI 中可视化了一个图形，我想输入口头命令来编辑它，而不是为每个可能的命令开发一个点击式界面。它类似于普通的命令行，但我会有一个自定义解析器来分析输入的命令字符串。

*   您可以编写命令并按回车键，然后将字符串发送到侦听器以进行解析和执行。
*   显示以前命令的可滚动历史记录。
*   解析后我可能想在屏幕上打印一些东西（这将进入历史区域）。
*   也许是命令行样式的前缀 (">")。
*   能够在提交（回车）之前编辑当前命令（退格）。无法删除历史记录中的前缀或以前的命令。
*   向上和向下键将允许导航和重复以前的命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:30:28.070

你有[Groovy 控制台](http://groovy.codehaus.org/Groovy+Console)。请参阅*嵌入控制台*以了解您的应用程序摆动部分。

# design-patterns - 什么是复杂动画的好抽象？

> ID：10853211
> 
> 赞同：27
> 
> 时间：2012-06-01T15:31:32.530
> 
> 标签：design-patterns, animation, user-interface, language-agnostic, abstraction

您如何设计和实现复杂的 UI 交互动画？

（我不是在谈论特定的语言和库，如 jQuery 或 UIKit，除非它们迫使你以特定的方式思考*管理*相互依赖的动画，我对此很感兴趣。）

考虑一个看似“简单”的任务，例如设计和编程 iOS 主屏幕。

![iOS 主屏幕](../Images/3aa0de48c72b711229051564ec5b9abe.png)

然而，**隐藏的复杂性是惊人的**。
关于界面，我注意到了一些事情：

*   当您几乎不触摸图标时，它的不透明度会发生变化，但大小变化会延迟。
*   如果您在其他两个应用程序之间拖动一个应用程序，则在所有应用程序重新排列以移动可用空间之前会有明显的延迟。因此，如果您只是继续在屏幕上移动应用程序，那么在您安顿下来之前什么都不会发生。
*   重新排列是逐行发生的，首先是你悬停在的那一行，它会触发链中的下一行，到之前空闲空间所在的那一行。
*   如果您删除了一个应用程序，它将在现在可用的空间中删除，而不仅仅是您删除它的位置。
*   如果您将一个应用程序悬停在另一个应用程序上，则会出现径向灯，闪烁两次，然后才会创建一个组。
*   如果组在空闲空间的右侧创建，然后被丢弃，它将在丢弃时向左动画以占用空闲空间。

我敢肯定这里还有**更多我没有注意到的复杂性**。

## 连续动画与离散动作

粗略概括，对于同一接口上下文中的每一对，`(animation, user_action)`您需要确定**如果`user_action`在`animation`已经运行时发生*了***什么。

在大多数情况下，您可以

*   取消动画；
*   随时随地更改动画；
*   忽略动作；
*   将动作排队到动画完成时。

但是在动画过程中可能会有几个动作，你必须决定要丢弃哪些动作，要排队，以及是在动画结束时执行所有排队的动作，还是只执行最后一个动作。

如果动画结束时有东西排队，并且动画发生了变化，你需要决定排队的动作是否仍然有意义，或者需要被删除。

如果这听起来太理论化，请**考虑一个真实世界的示例**：您如何处理用户向下拖动应用程序，等待重新排列开始，然后立即将应用程序向上拖动并释放它？您如何确保动画在所有可能的情况下都流畅且可信？

## 适合工作的工具

我发现自己甚至无法将一半的可能场景记在脑海中。随着 UI 表现力的增加，**可能的状态数量开始严重违反 7±2 规则**。

因此，我的问题如下：

> **你如何驯服动画设计和实现的复杂性？**

我对找到思考问题的有效方法以及解决问题的方法都很感兴趣。

例如，**事件和观察者被证明是大多数 UI 的非常有效的抽象**。
但是你能设计和实现一个依赖事件作为主要抽象的类似 iOS 的拖放屏幕吗？

代码必须有多复杂才能准确表示 UI 的所有可能状态？当某个布尔变量为真到将其设置为假的函数时，它是否会是一个事件处理程序添加另一个事件处理程序，除非另一个事件处理程序在它之前运行？

“你没听说过上课吗？” 你可能想知道。为什么，我有，但是这些课程想要分享的状态太多了。

总而言之，我正在寻找与**语言无关**（尽管可能受语言或框架启发）的技术，用于管理按顺序或同时发生的**复杂的相互依赖、可取消的动画，并****描述它们对用户操作**的反应。

（考虑到我*不必*自己编写动画——也就是说，我确实可以访问像 jQuery 或 Core Animation 这样的框架，这些框架可以满足`animate(styles, callback)`我的需求，而且我可以`cancel`做到。）

如果数据结构、设计模式、DSL 有助于解决问题，它们都是好的。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-01T19:26:54.383

在所描述的问题中，有一个*系统状态*的隐含概念。动画是有状态的，因此它们的任何组合都是有状态的，甚至可以说更是如此。

考虑状态和动作的一种方法是[有限状态机](https://en.wikipedia.org/wiki/Finite-state_machine)。

阅读 [这篇](https://www.ibm.com/developerworks/library/wa-finitemach1/)解释如何应用 FSM 在 JavaScript 中实现自定义工具提示的文章：

![在此处输入图像描述](../Images/414d7b7fbe795d6110899ab5a360e47b.png)

这个例子可能看起来有点令人费解，但确实说明了这一点：有限状态机迫使您思考**哪些状态是可能的，它们之间的哪些转换是有效的，何时应该触发它们以及一旦它们应该执行什么代码**。

因为 IBM 的文章禁止使用其[代码示例](https://www.ibm.com/developerworks/library/wa-finitemach1/test_files/FadingTooltip.js.html)，所以我建议您也阅读[Ben Nadel 的一篇文章，该文章](https://www.bennadel.com/blog/2242-treating-user-interface-ui-widgets-like-finite-state-machines.htm)使用 FSM 实现下拉菜单小部件。

本写道：

> 我已经看到有限状态机可以处理大型复杂任务并将其分解为更小、更易于管理的状态的方式。我什至尝试将这种心态应用于[JavaScript 中的绑定和解除绑定事件处理程序](https://www.bennadel.com/blog/2233-using-state-change-to-bind-and-unbind-event-handlers-vs-handler-branching.htm)。但是，现在我越来越熟悉状态机，尤其是状态转换，我想尝试将这种思维方式应用到有凝聚力的用户界面 (UI) 小部件上。

这是他的代码的一个稍微精简的版本：

```
var inDefault = {
    description: "I am the state in which only the menu header appears.",
    setup: function() {
       dom.menu.mouseenter(inHover.gotoState);
    },    
    teardown: function() {
         dom.menu.unbind("mouseenter");
    }
};

var inHover = {
    description: "I am the state in which the user has moused-over the header of the menu, but the menu has now shown yet.",
    setup: function() {
        dom.menu.addClass("menuInHover");
        dom.menu.mouseleave(inDefault.gotoState);
        dom.header.click(
            function(event) {
                event.preventDefault();
                gotoState(inActive); 
            }
       );    
    },
    teardown: function() {
        dom.menu.removeClass("menuInHover");
        dom.menu.unbind("mouseleave");
        dom.header.unbind("click"); 
    }    
};

var inActive = {
     description: "I am the state in which the user has clicked on the menu and the menu items have been shown. At this point, menu items can be clicked for fun and profit.",

    setup: function() {
        dom.menu.addClass("menuInActive");
        dom.stage.mousedown(
            function(event) {
                var target = $(event.target);
                if (!target.closest("div.menu").length) {
                    gotoState(inDefault); 
                } 
            }
       );
       dom.header.click(
            function(event) {
                event.preventDefault();
                 gotoState(inHover);

            }
       );
       dom.items.delegate(
            "li.item",
            "click",
            function(event) {
                console.log(
                    "Clicked:",
                    $.trim($(this).text())
               );

            }
       );
    },    
    teardown: function() {
        dom.menu.removeClass("menuInActive"); 
        dom.stage.unbind("mousedown", inDefault.gotoState);
        dom.header.unbind("click"); 
        dom.items.undelegate("li.item", "click");
    }
}; 
```

请注意，**事件处理程序在进入状态时是绑定的，而在离开此状态时是未绑定的。**

FSM 解决这个问题的最大优势是它们**使状态显式化**。

虽然每个动画都可能对包含系统的状态有所贡献，但您的系统永远不会同时处于两种状态或根本没有状态，并且调试变得几乎是微不足道的，因为您总是可以看到系统（或每个子系统）处于什么状态，鉴于您的状态设计是有道理的。

此外，通过强制您明确设计状态，使用 FSM 排除了您不考虑状态/动作的特定组合的可能性。没有“未定义的行为”，因为每个转换都是明确的，并且是 FSM 设计的一部分。

* * *

[如果您已经阅读到这里，您可能会对Additive Animations](https://web.archive.org/web/20190121150953/http://ronnqvi.st:80/multiple-animations)（[另一个介绍](http://iosoteric.com/additive-animations-animatewithduration-in-ios-8/)）感兴趣。它们现在是 iOS 8 中的默认设置，并且已经被[Kevin Doughty](https://kxdx.org)提倡了好几年了。

这是一种不同的方法，在保持系统状态的同时，您允许多个（甚至相反的）动画同时处于活动状态。这会给你带来[疯狂的结果](https://www.youtube.com/watch?v=u1RStgv0_CU)，但这是一个有趣的概念。

主要思想是避免将动画定义为从绝对值 A 到绝对值 B 的东西，而是将动画定义为相对于它们的最终值（每个动画从 -Delta 到 0）。这允许您通过对每个时间点的相对值求和来无缝组合多个动画，并避免由反转或取消引起的尖峰：

[![附加动画](../Images/aae202b02fe367f6bbb872ab161b43c0.png)](https://i.stack.imgur.com/KS0eD.gif)
[（来源：[ronnqvi.st](http://ronnqvi.st/images/additive-interaction.gif)）]

对于附加动画的准系统框架无关示例，请查看[alexkuz 的附加动画](https://github.com/alexkuz/additive-animation)模块（[演示](https://alexkuz.github.io/additive-animation/)）。

* * *

如果你读到这里，你一定对动画很感兴趣！目前，我对[react-state-stream](https://github.com/chenglou/react-state-stream)方法很感兴趣。它建议将动画表达为状态的惰性序列。这开辟了许多可能性，例如表达无限动画，从动画中逐渐添加和删除变换等等。

如果你想看一篇关于动画的文章，我建议是程楼**[的动画思考。](https://gist.github.com/chenglou/40b75d820123a9ed53d8)**

# ajax - 带模板的舞者 AJAX 路线

> ID：10853218
> 
> 赞同：0
> 
> 时间：2012-06-01T15:32:02.133
> 
> 标签：ajax, perl, dancer

我正在尝试在这样的 AJAX 路由中显示模板：

```
ajax '/login' => sub {
    my $user     = params->{uname};
    my $password = params->{upass};
    my $db_inst  = WebApp::Persistency::SQLiteDB->instance();

    if ($db_inst->is_user_registered($user,$password) == 1) {
        template "main_page";
    } else {
        return { res => 'Wrong' }; 
    }
}; 
```

用户确实验证了，但模板从未显示。当我从不同的路线（非ajax）使用模板时，它可以工作。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:47:39.513

AJAX 不会重新加载整个页面。如果不重新加载页面，如何使用模板？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-05T22:18:53.567

渲染的模板可以返回到 AJAX 请求并注入到页面中。

# android - FrameLayout 滑动菜单

> ID：10853219
> 
> 赞同：1
> 
> 时间：2012-06-01T15:32:03.747
> 
> 标签：android, layout

我正在开发一个使用 a 的 Android 应用程序`framelayout`，其中有两个视图膨胀：

*   上视图包含应用程序的主要功能；
*   下视图包含一个使用“下拉刷新”功能实现的可刷新列表。

上视图向右移动，以便您可以看到包含列表的下视图，但是当我开始执行下拉刷新操作时，上视图会返回到左侧，覆盖包含列表的下视图。列表会刷新，但我不希望上部视图以这种方式运行，覆盖下部视图。
我想知道是否有办法冻结上视图，直到用户执行其他操作（单击按钮）将其返回到下视图。

```
 LayoutInflater inflater = LayoutInflater.from(this);
    final FrameLayout main = new FrameLayout(this);

    menu = inflater.inflate(R.layout.offerlist, null);
    app = inflater.inflate(R.layout.main, null);

    main.addView(menu);
    main.addView(app);
    setContentView(main);

    Display display = (Display) ((WindowManager) getSystemService(Context.WINDOW_SERVICE))
            .getDefaultDisplay();
    final int width = display.getWidth();
    final float wDip = TypedValue.applyDimension(
            TypedValue.COMPLEX_UNIT_DIP, 70, this.getResources()
                    .getDisplayMetrics());
            ...

            app.startAnimation(hide);
            menuw = (int) (width - wDip);
    app.offsetLeftAndRight(-menuw); 
```

先感谢您。

# php - Zend Lucene：致命错误，最长执行时间

> ID：10853220
> 
> 赞同：0
> 
> 时间：2012-06-01T15:32:04.900
> 
> 标签：php, zend-framework, lucene

我已经为我的网站编写了一个基本的索引脚本，它似乎正在工作......有点。它通过了大约 3/4 需要索引的页面，然后给出了这个错误：

> 致命错误：/Zend/Search/Lucene/Analysis/Analyzer.php 第 166 行中的最大执行时间超过 0 秒

它似乎每次都挂在不同的位置。一分钟后我运行它并得到了这个：

> 致命错误：在第 349 行的 /Zend/Search/Lucene/Storage/Directory/Filesystem.php 中超过了 0 秒的最大执行时间

这是脚本：

```
foreach($all_items as $item) {
    $doc = new Zend_Search_Lucene_Document();

    $doc->addField(Zend_Search_Lucene_Field::Text('title', $item['pagetitle']));

    $doc->addField(Zend_Search_Lucene_Field::Text('url', $item['url']));

    $doc->addField(Zend_Search_Lucene_Field::Text('country', $item['country']));

    // Add document to the index
    $index->addDocument($doc);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:42:12.807

也许您的任务很耗时？然后增加时间限制[set_time_limit](http://php.net/manual/en/function.set-time-limit.php)：

```
 set_time_limit(0); //no time limit
 set_time_limit(500) //500 sec limit 
```

尝试增加[max_execution_time](http://www.php.net/manual/en/info.configuration.php#ini.max-input-time)

```
 ini_set('max_execution_time', 5000); 
```

还有[max_input_time](http://www.php.net/manual/en/info.configuration.php#ini.max-input-time)

```
 ini_set('max_input_time', 5000); 
```

如果它仍然不起作用，您将需要跟踪永久执行的部分

# php - 发布数据库查询的返回值

> ID：10853228
> 
> 赞同：0
> 
> 时间：2012-06-01T15:32:23.967
> 
> 标签：php, mysql, database, mysqli

我试图弄清楚如何获得要发布的返回值。我的代码如下

```
 <?php

$mysqli = new mysqli("localhost","user","password","db");

$lname=$_POST['lname'];

$query= "SELECT * FROM contacts WHERE lname = '".$lname."'";
$result = $mysqli->query($query);     
if (!$result) {
  printf("Query failed: %s\n", $mysqli->error);
  exit;
}      

return $result;
?> 
```

我对 php 很陌生，但是我正在做的是获取一个发布到 php 文件的名称，然后它进入数据库，找到所有输入了姓氏的值，然后我希望它返回这些值，然后打印它们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:36:04.243

见[mysqli_result::fetch_assoc](http://us2.php.net/manual/en/mysqli-result.fetch-assoc.php)

```
<?php

$mysqli = new mysqli("localhost","user","password","db");

$lname=$_POST['lname'];

$query= "SELECT * FROM contacts WHERE lname = '".$lname."'";
$result = $mysqli->query($query);     
if (!$result) {
  printf("Query failed: %s\n", $mysqli->error);
  exit;
}      
while ($contact = $result->fetch_assoc()) {
    echo $contact['name']."<br>\n";
}
?> 
```

# c# - 派生类的泛型参数中的“This”类型

> ID：10853229
> 
> 赞同：3
> 
> 时间：2012-06-01T15:32:25.297
> 
> 标签：c#, generics

有没有办法在类型参数中指定参数是对象实例的类型？

例如，为了说明，我有：

```
public abstract class Model
{
    public int Prop1 { get; set; }
} 
```

对于我的示例，我想要一个方法来返回`Model`传入的属性（显然这是一个愚蠢的方法，但它明白了重点）。我可以使它作为扩展方法工作：

```
public static class Extensions
{
    public static U Property<T, U>(this T model, Expression<Func<T, U>> property) where T : Model
    {
        return property.Compile().Invoke(model);
    }
} 
```

这样我就可以拥有

```
public class DerivedModel : Model
{
    public string Prop2 { get; set; }
} 
```

做

```
var myString = new DerivedModel().Property(a => a.Prop2); 
```

这个方法看起来应该是`Model`类的一部分，看起来像：

```
public T Property<T>(Expression<Func<ThisDerivedInstanceOfModel, T>> property)
{
    return property.Compile().Invoke(this);
} 
```

以便`Property()`对扩展方法所做的相同调用可以在`Model`.

我意识到这有点奇怪，可能根本不是 C# 的一个特性，而且变通方法扩展方法工作得很好——但如果可能的话，我更愿意把它作为一个实例方法，因为对我来说似乎“更好”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:36:06.630

> 有没有办法在类型参数中指定参数是对象实例的类型？

没有。对不起。有时我可以看到它很有用，但这不是您可以做的。我过去也遇到过类似的问题:(

# javascript - favicon 在投资组合网站上消失

> ID：10853231
> 
> 赞同：2
> 
> 时间：2012-06-01T15:32:32.247
> 
> 标签：javascript, jquery, url, favicon, portfolio

我的网站上的图标有点问题。它适用于每个网站，但网站图标会在包含投资组合的页面上消失。

这是一个可过滤的投资组合，所以我认为域可能存在问题，因为当网站加载时，url 会在末尾获得一个名为 #all 的 id（以显示所有投资组合项目）。

我对每一次帮助感到高兴。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:24:39.843

好的，我检查了您的网站并尝试停用 javascript，然后网站图标出现了。所以，我的假设是哈希（#all）以某种方式弄乱了网站图标，也许它与您使用的基本标签有关，因为我从来没有遇到过网站图标的任何问题。

我的解决方案是尝试为您的 favicon 使用绝对路径：[http](http://example.com/images/favicon.ico) ://example.com/images/favicon.ico而不是使用基本标记。

我希望它能起作用，因为我不能肯定地说，我通常不使用基本标签。

**使用评论中的2个链接的解决方案**

```
$(window).bind('hashchange', function() {
  var link = $('link[rel=shortcut icon]').remove().attr("href");
  $('<link href="'+ link +'" rel="shortcut icon" />').appendTo('head');
}); 
```

# c# - 如何修复错误“名称：不允许指定名称：_destroy”？

> ID：10853232
> 
> 赞同：3
> 
> 时间：2012-06-01T15:32:34.183
> 
> 标签：c#, asp.net-mvc, entity-framework

我看过类似的问题，建议我应该使用 column 属性来更改列的名称，但我已经这样做了，但我仍然得到错误。这是我的模型类：

```
public class Task
{
    public int TaskID { get; set; }
    public string TaskDescription { get; set; }
    public bool IsDone { get; set; }

    [Column("Active")]
    public bool _destroy { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T17:20:34.493

问题是实体框架不允许实体属性名称以下划线字符开头（在其他字符类中）。使用 Reflector，我能够追踪用于验证属性名称的正则表达式，如下所示：

```
@"[\p{Ll}\p{Lu}\p{Lt}\p{Lo}\p{Lm}\p{Nl}][\p{Ll}\p{Lu}\p{Lt}\p{Lo}\p{Lm}\p{Nl}\p{Mn}\p{Mc}\p{Nd}\p{Pc}\p{Cf}]{0,}" 
```

这意味着实体属性名称只能以取自以下 Unicode 字符类的字符开头：

Ll, Lu, Lt, Lo, Lm, Nl

属性名称中的其余字符可能包括这些类以及以下内容：

Mn、Mc、Nd、Pc、Cf

下划线字符 (U+005F) 在 Pc 类中。您可以通过将_destroy 属性重命名为destroy 来消除错误。[您可以在此处](http://www.fileformat.info/info/unicode/category/index.htm)找到字符类参考。

# javascript - 如何通过 javascript 对象文字的变量值分配多个键

> ID：10853235
> 
> 赞同：0
> 
> 时间：2012-06-01T15:32:41.173
> 
> 标签：javascript

我想知道是否有可能拥有像多维数组这样的对象？我想要的是这样的：

```
lines[first][first first]= "value key key"        

    lines          =       {};
    key            =       "first";
    key_key        =       "first first";
    lines[key]     =       "value key ";
    lines[key][key_key]=   "value key key "

    console.log(lines); 
```

输出：无法将未定义转换为对象

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:36:56.897

`lines[key]`是一个字符串值。它应该是一个对象。像这样：

```
lines              = {};
key                = "first";
key_key            = "first first";
lines[key]         = {};
lines[key][key_key]= "value key key ";
//=> lines.first['first first'] now is 'value key key' 
```

**或者**

```
lines              = {};
key                = "first";
key_key            = "first first";
lines[key]         = new String("value key ");
lines[key][key_key]= "value key key ";
//=> lines.first['first first'] still is 'value key key', 
//   but now it's a custom property of a String Object 
```

# java - 可序列化如何工作？

> ID：10853238
> 
> 赞同：3
> 
> 时间：2012-06-01T15:32:55.557
> 
> 标签：java, serializable

这个问题不是关于如何*使用* `Serializable`的，我已经知道了。但是，我想知道实现如何`Serializable`引发以下警告：

`The serializable class MyClass does not declare a static final serialVersionUID field of type long`

假设我想编写一个类似的接口`Serializable`，我将如何“警告”实现我的接口的程序员声明一个变量？我试过查看源代码，`Serializable.java`但找不到任何会导致这种行为的东西。这甚至可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:34:24.040

我认为使用注释和注释处理器可以更好地实现您正在寻找的行为。编译器警告您不要声明的事实`serialVersionUID`是由编译器级别的不同机制处理的（因此，程序员无法做到）；它更多的是由序列化 API 强制执行的编码约定，而不是实现`Serializable`接口的结果。

事实上，[在这里](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/io/Serializable.java)您可以检查源代码，[`Serializable`](http://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html)并且如您所见，强制编译器警告并没有什么特别之处：

```
/* comments removed for brevity */
package java.io;
public interface Serializable {
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T15:35:18.597

不，我认为仅使用 Java 是不可能的（也许有一些注释？不确定）。

事实是这个`Serializable`接口不是一个普通的Java接口而是一个标记元素，它被用作一个*接口*但它是一个特殊的东西，所以它由编译器以自己的方式处理（因为它的含义表达了一种功能，就像接口，默认情况下不会在代码中透明地实现）。

# matlab - 使用重叠保存的缓冲块卷积

> ID：10853239
> 
> 赞同：0
> 
> 时间：2012-06-01T15:33:05.633
> 
> 标签：matlab, filtering, signal-processing, fft, convolution

所以，我目前正在matlab中实现块卷积的重叠保存方法，并且在这样做时遇到了一些麻烦。

我的实现是使用缓冲输入来实时处理向量中的输入数据。输入被馈送到我的重叠保存类的实例，一旦缓冲区已满，输入超过预定义的块长度（大于过滤器长度），输入将按块处理（块长度的大小）使用标准的重叠保存算法，直到缓冲区中的数据长度小于块长度。然后它坐下来等待更多数据进入并重复该过程。

现在一切似乎都工作正常，但问题是在所有输入都传递给类之后刷新缓冲区。当调用 flush 方法时，缓冲区中的数据总是少于块大小，并且我在处理剩余数据时遇到了麻烦。

还应该值得注意的是，类在处理普通数据后，会将输入的最后 N-1 个（其中 N 是过滤器长度）数据点保留在缓冲区中，以维护算法的“重叠”部分用于后续数据或最后的冲洗。

我想我的问题是在调用 flush() 时应该如何处理缓冲区中的剩余数据？我尝试简单地进行零填充并将其与过滤器进行卷积，但这会产生垃圾输出......有什么建议吗？

注意：flush 的输出应该附加到处理普通数据块的输出中，并且这个新的输出应该与 matlab 中的 conv(input, filter) 的输出相匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:39:30.587

这是一个非常笼统的问题，所以我将给出一个非常笼统的答案。冲洗的概念意味着您的输入已经结束。当您决定在输入信号完成后您希望处理器如何运行时，您可以对其进行编码。Zeros 是一种常见的方法，所以我只能怀疑您对零填充的尝试（我认为这是正确的答案）还有其他一些缺陷。或者你的信号可能只是在一个峰值处结束，而零填充引入了一个急剧的转变。在这种情况下，重复最后一个值可能是比零填充更好的解决方案。

# python - 如何查看 mercurial 文件上下文的更改？

> ID：10853240
> 
> 赞同：2
> 
> 时间：2012-06-01T15:33:08.123
> 
> 标签：python, api, mercurial

我目前正在尝试编写一个脚本，该脚本将在任务描述中给定特定 # 的情况下找到所有已更改的文件，并且我已经让脚本为此工作。但现在我试图按文件是否被添加、修改或删除来排序。我查看了[Mercurial API](http://mercurial.selenic.com/wiki/MercurialApi)，但找不到任何可以做我想做的事。

我的代码当前使用`repo[revnum].description()`并解析它以查找哪些包含`#`，如果它们包含，则将文件上下文添加到列表中。这工作正常，我可以打印文件列表，但我找不到一种方法来查看每个上下文做了什么。任何人都可以在这里帮助我，或者向我指出一些更好的文档吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:43:02.923

您需要使用 Mercurial API 吗？通过使用的输出可以做你需要的事情`hg log`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:01:49.647

我最终使用了类似于 Tim 所说的东西，尽管我仍然使用 API。我从 mercurial 导入命令，然后调用 commands.status(repo.ui, repo, change=revnum)

我使用 repo.ui.pushbuffer() 和 repo.ui.popbuffer() 捕获了它的输出，格式为

```
A file_path1
R file_path2
R file_path3
A file_path4
M file_path5 
```

我解析了这个输入并将其分类为添加、删除、修改等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:00:42.413

一般来说，您应该避免直接使用 Mercurial API 编写脚本。最好编写脚本以使用 CLI 或什至使用[`hglib`](http://mercurial.selenic.com/wiki/PythonHglib). 如[MercurialApi wiki](http://mercurial.selenic.com/wiki/MercurialApi)所述：

> 对于绝大多数第三方代码，最好的方法是使用 Mercurial 已发布、文档化且稳定的 API：命令行界面。

话虽如此，如果您确实需要使用 API，您可以使用[`repo.status()`](http://www.selenic.com/hg/file/f694ab54b660/mercurial/localrepo.py#l1334)来查找您询问的信息：

```
modified, added, removed, deleted, unknown, ignored, clean = repo.status(revnum-1, revnum) 
```

# .htaccess - htaccess 将 https 添加到 url，除了 1 个目录

> ID：10853242
> 
> 赞同：0
> 
> 时间：2012-06-01T15:33:27.787
> 
> 标签：.htaccess, mod-rewrite, https

```
#ADD HTTPS TO URL
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^domain\.com$ [NC]
RewriteCond %{REQUEST_URI} !^/hd/209$
RewriteRule ^(.*)$ https://domain.com/$1 [L,R=301] 
```

我正在尝试为网站上的所有页面强制使用 ssl，除了 /hd/209

我已经尝试了上面的代码，但它仍然强制 /hd/209 到 ssl

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:57:08.623

清除浏览器缓存并重新启动它。

然后用这个替换你的代码：

```
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com$ [NC]
RewriteRule (?!^hd/209)^(.*)$ https://domain.com/$1 [L,NC,R=301] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:36:16.513

我将为文件夹添加重定向

重定向 301 /文件夹/ [https://domain.com/carpinteria-aluminio-mallorca/](https://domain.com/carpinteria-aluminio-mallorca/)

# c# - ObjectDataSource 中用于分页的令牌

> ID：10853245
> 
> 赞同：0
> 
> 时间：2012-06-01T15:33:42.527
> 
> 标签：c#, asp.net, paging, objectdatasource

我有一个 ObjectDataSource，它针对使用令牌进行分页的系统运行查询。

在第一次调用时，假设要获得前 10 个结果，我从服务器取回这个令牌，我应该在后续调用中再次使用它，例如从 11 到 20 获得结果。

有没有办法可以将 ObjectDataSource 配置为使用这样的令牌？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T21:09:14.657

例如，如果您的 ObjectDataSource 定义如下：

```
<asp:objectdatasource
      id="ObjectDataSource1"
      runat="server"
      SelectMethod="GetData"
      TypeName="Company.DataManager" /> 
```

然后，您可以定义 Company.DataManager 类型及其 GetData 方法，以便第一次接收令牌，存储它，然后将其（以某种参数的形式）传递给您从中查询数据的系统。

# apache - 在 Apache 中定义本地站点 - 使用 80 以外的端口

> ID：10853267
> 
> 赞同：1
> 
> 时间：2012-06-01T15:35:33.913
> 
> 标签：apache, virtualhost, httpd.conf, virtual-hosts

我想知道是否有人可以帮助我使用 Apache 定义一个新的本地 VirtualHost。

目标是拥有一个只能从本地网络查看的站点（隐藏在防火墙后面）。现在我已经安装了 Webmin，它在 transaction:10000 上运行。我试图让另一个站点在事务：7000 上运行。

以下不起作用：

DocumentRoot /var/path

有一个更好的方法吗？我是 Apache 的新手，并试图解决这个问题。

摘要：需要本地 /var/path 目录才能在 80 以外的端口上运行，仅用于本地访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:09:33.413

我假设您不知道 Apache 虚拟主机代码。我将向您展示如何使用它。如果这对您没有帮助，请不要犹豫，回复我。
您必须将代码放在您的 HTTPD.CONF 中，该代码可以在 conf 文件夹中找到。如果您的文件名为 wwwroot，只需更改下面代码中的名称，但不要更改文件夹的名称！！！

```
NameVirtualHost 111.22.33.44
<VirtualHost *:7000>
ServerName www.domain.tld
ServerPath /domain
DocumentRoot /htdocs/domain
</VirtualHost> 
```

这是什么意思？这意味着对任何以“/domain”开头的 URI 的请求都将从虚拟主机 www.domain.tld 提供。这意味着所有客户端都可以作为 domain.tld/domain/ 访问页面，尽管发送 Host: 标头的客户端也可以作为 domain.tld/ 访问它。

为了完成这项工作，请在您的主要虚拟主机页面上放置一个指向[http://www.domain.tld/domain/](http://www.domain.tld/domain/)的链接。然后，在虚拟主机的页面中，确保使用纯粹的相对链接（例如，“file.html”或“../icons/image.gif”）或包含前缀 /domain/ 的链接（例如，“http: //www.domain.tld/domain/misc/file.html”或“/domain/misc/file.html”）。

因此，所有域都将指向您的 IP 地址，并且基于域名，如果它是“www.domain.tld”，它将带您到文件夹“/htdocs/domain”或“/wwwroot/domain”

编辑：

```
<Directory "/var/path/">
 Order Deny,Allow
 Deny from all
 Allow from 127.0.0.1
</Directory> 
```

这允许仅从 localhost 访问“/var/path/”文件夹，这是在您的计算机上配置 Apache 的位置！

祝你好运！！！

# configuration - 由于“没有启动的应用程序”，播放规范与配置中断

> ID：10853269
> 
> 赞同：11
> 
> 时间：2012-06-01T15:35:39.563
> 
> 标签：configuration, playframework-2.0, specs2

我将一些字符串外部化到 HOCON，在`application.conf`. 我正在访问这样的配置值：

```
import play.api.Play.current
import play.api.Play.configuration

configuration.getString("foo.bar").get() 
```

尽可能早地，在丢失密钥的情况下快速失败，就像文档说的那样。

现在我的一些依赖于*配置*对象的测试失败了，堆栈跟踪指出：

`Caused by: java.lang.RuntimeException: There is no started application`

我认为这与配置有关？我怎样才能解决这个问题？（测试是[specs2](http://etorreborre.github.com/specs2/)）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T21:44:24.780

你有`FakeApplication`跑步吗？如文档中所述：[http](http://www.playframework.com/documentation/2.0/JavaTest) ://www.playframework.com/documentation/2.0/JavaTest在运行测试/测试方法之前？

来自 Wiki 的示例：

```
@Test
public void findById() {
   running(fakeApplication(), new Runnable() {
      public void run() {
        Computer macintosh = Computer.find.byId(21l);
        assertThat(macintosh.name).isEqualTo("Macintosh");
        assertThat(formatted(macintosh.introduced)).isEqualTo("1984-01-24");
       }
   });
} 
```

如果这不能解决您的问题，也许从 Stacktrace 提供更多信息会有所帮助。

`playframework`编辑：请仔细标记您的问题，提及AND是没有意义的`playframework-2.0`

# jquery - 使用 Mobile JQuery 打开另一个数据角色时如何折叠数据角色？

> ID：10853273
> 
> 赞同：2
> 
> 时间：2012-06-01T15:36:05.123
> 
> 标签：jquery, mobile

我使用 Mobile JQuery 创建一个站点，我有下面的代码，但是当我可以打开所有可折叠菜单时，但我想要它，以便当我打开另一个菜单时，前一个菜单会关闭。这是我到目前为止的代码

```
<div data-role="collapsible" data-collapsed="true">
    <h3>My Data</h3>
    <ul data-role="listview" data-inset="true">
        <li><a href="#aberdeen" data-transition="pop">Liverpool</a></li>
        <li><a href="#aberdeen" data-transition="pop">Manchester</a></li>
        <li><a href="#aberdeen" data-transition="pop">Sheffield</a></li>
    </ul>
</div>

<div data-role="collapsible" data-collapsed="true">
    <h3>More Data</h3>
    <ul data-role="listview" data-inset="true">
        <li><a href="#aberdeen" data-transition="pop">York</a></li>
        <li><a href="#aberdeen" data-transition="pop">London</a></li>
        <li><a href="#aberdeen" data-transition="pop">Newcastle</a></li>
    </ul>
</div> 
```

# javascript - drawImage(HTML5CanvasElement) Firefox 内存指数增加

> ID：10853278
> 
> 赞同：1
> 
> 时间：2012-06-01T15:36:09.273
> 
> 标签：javascript, html, canvas, drawimage

我正在尝试使用 JavaScript drawImage 在 Firefox 中从缓冲区画布绘制到另一个画布；我使用相当大的画布每帧多次调用绘图。我的内存使用在 Firefox 中飙升，但在 Chrome 中几乎没有达到峰值。我很好奇这种行为的原因，以及是否有一种解决方法可以在不再需要绘制图像后释放所使用的内存（我假设）。

我需要使用 globalCompositeOperation = 'source-in' 进行渲染，这就是我使用这种方法的原因。

这是基本思想：

```
var canvas = document.createElement('canvas');
var ctx = canvas.getContext('2d');
//set height and width of canvas to browser window

var dummyCanvas = document.createElement('canvas');
var dummyctx = dummyCanvas.getContext('2d');
dummyCanvas.width = canvas.width;
dummyCanvas.height = canvas.height;

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    //draw some stuff on normal canvas

    dummyCtx.clearRect(0, 0, canvas.width, canvas.height);

    //draw a polygon on buffer canvas
    dummyctx.globalCompositeOperation = 'source-in';
    //draw another polygon on buffer canvas

    ctx.drawImage(dummyctx.canvas, 0, 0);

    //draw some more stuff on normal canvas
} 
```

这个内存问题只是 Firefox 中的一个错误吗？难道我做错了什么？有什么解决方法吗？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:23:49.233

当我绘制多个图像时，我注意到图像以某种方式在画布中相互堆叠。也许它会帮助清理画布，然后再次抽空：

```
context.clearRect(0, 0, canvas.width, canvas.height);
var w = canvas.width;
canvas.width = 1;
canvas.width = w; 
```

我从我不久前做的图像调整中得到了这个：http: [//boxed.hu/articles/html5-client-side-image-resize/](http://boxed.hu/articles/html5-client-side-image-resize/)

但是，这只是一个提示 - 所以让我知道它是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T16:51:56.577

[我在 IE 上增加了内存使用的jquery.rotate](http://code.google.com/p/jqueryrotate/)插件存在内存泄漏问题，发现虽然绘图占用了内存，但问题是原始图像被操纵图像替换时。显然，这些图像只是在记忆中堆积起来。该行是：

```
p.parentNode.replaceChild(canvas, p); 
```

所以我改用jQuery函数replaceWith()，旋转几张图片后内存停止堆积：

```
$(p).replaceWith(canvas); 
```

查看 replaceWith 函数，它实际上移除了对象（可能最终使用了 removeChild 和 appendChild）并将新对象附加到 DOM。我的猜测是浏览器实现 replaceChild() 的方式有所不同。

# c++ - std::string 析构函数中的奇怪错误

> ID：10853279
> 
> 赞同：0
> 
> 时间：2012-06-01T15:36:15.820
> 
> 标签：c++, debugging, stdstring, application-verifier

我在 Application Verifier 下运行了我的应用程序，它在我的应用程序关闭时向我显示了以下问题：

```
VERIFIER STOP 00000210: pid 0x6D0: Critical section not initialized. 

    005C9148 : Critical section address.
    00000000 : Critical section debug info address.
    00000000 : Not used.
    00000000 : Not used. 
```

堆栈跟踪：

```
myapp!_Mtxlock+0xf [f:\dd\vctools\crt_bld\self_x86\crt\src\xmtx.c @ 45]
myapp!std::_Lockit::_Lockit+0x2d [f:\dd\vctools\crt_bld\self_x86\crt\src\xlock.cpp @ 64]
myapp!std::_Container_base12::_Orphan_all+0x2f [c:\program files (x86)\microsoft visual studio 10.0\vc\include\xutility @ 200]
myapp!std::_String_val<wchar_t,std::allocator<wchar_t> >::~_String_val<wchar_t,std::allocator<wchar_t> >+0x57 [c:\program files (x86)\microsoft visual studio 10.0\vc\include\xstring @ 479]
myapp!std::basic_string<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t> >::~basic_string<wchar_t,std::char_traits<wchar_t>,std::allocator<wchar_t> >+0x4f [c:\program files (x86)\microsoft visual studio 10.0\vc\include\xstring @ 755]
myapp!MyClass::~MyClass+0x42
myapp!MyOtherClass::~MyOtherClass+0x5f
myapp!MyOtherClass::`scalar deleting destructor'+0x16
myapp!MyComInterfaceImplementation::Release+0x54
mscorwks!DllRegisterServerInternal+0x213f6
mscorwks!DllRegisterServerInternal+0x214ac
mscorwks!DllRegisterServerInternal+0x21510
mscorwks!StrongNameErrorInfo+0x6565
mscorwks!StrongNameErrorInfo+0x632c
mscorwks!StrongNameErrorInfo+0x64ad
mscorwks!LogHelp_LogAssert+0x4ee01
mscorwks!LogHelp_LogAssert+0x4f269
mscorwks!LogHelp_LogAssert+0x4f334
mscorwks!CorDllMain+0x1ca6
mscorwks!CorDllMain+0x230e
mscorwks!CreateApplicationContext+0xe551
mscorwks!DllRegisterServerInternal+0x2eacd
vfbasics+0x1602c
kernel32!GetModuleHandleA+0xdf 
```

注意 std::basic_string 的析构函数出了点问题。这可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:41:33.360

你`MyClass`可能在运行时已经被销毁了一次，它在关机时再次被销毁，标记了一个稍微虚假的错误消息。

# mysql - MySQL 中两个表的总体唯一计数

> ID：10853280
> 
> 赞同：0
> 
> 时间：2012-06-01T15:36:15.577
> 
> 标签：mysql, count

我有两个表，都有一个我想要计算的 device_id 列。出于演示的目的，架构如下所示：

```
Table 1: 'id', 'save_val', 'device_id_major'
Table 2: 'id', 'save_val', 'location', 'device_id_team' 
```

表 1 可能有许多相同的“ `device_id_major`”。

我基本上想从两个表中获取唯一的 device_id，然后从该结果集中获取唯一 device_id 的计数（相同的 device_id 可以出现在两个表中）。

这可能在一个查询中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:39:52.387

```
select distinct aa.device_id, count(*) 
from(select distinct device_id from table1
union all
select distinct device_id from table2) as aa
group by device_id
order by device_id 
```

或类似...由于我手头没有架构，我无法完全验证它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:57:02.310

```
SELECT count(DISTINCT aa.id) 
FROM (SELECT DISTINCT major_id AS id FROM `major` 
UNION ALL
SELECT DISTINCT team_id AS id FROM `team`) 
AS aa 
```

这似乎可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:38:35.523

您可以使用获取两个表的 UNION 的查询，然后选择唯一值。

# ruby-on-rails - Ruby on Rails with Haml - 如何从 erb 切换

> ID：10853283
> 
> 赞同：5
> 
> 时间：2012-06-01T15:36:19.277
> 
> 标签：ruby-on-rails, ruby, haml

我正在从 erb 文件切换到 HAML。我将haml gem 添加到我的系统中。我创建了 app/views/layouts/application.html.haml 文件。我应该删除 application.html.erb 文件吗？

此外，还有 /public/index.html 文件被呈现为默认页面。我想制作自己的默认 index.html.haml 页面。我在哪里放置它以及如何让系统呈现该文件而不是默认索引文件？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:42:18.063

是的，您可以删除已转换为 HAML 的任何视图的 ERB 版本。

至于您的其他问题，请删除 public/index/html 文件。接下来，您可能想要添加一个 PagesController 并在其中有一个动作，如索引和一个相应的视图，并将您的“主页”内容放在那里。

然后在您的路线文件中，添加：

```
root :to => "pages#index" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T15:43:57.587

您可以使用此脚本自动转换和删除所有 erb 文件

```
for i in `find app/views -name '*.erb'` ; do html2haml -e $i ${i%erb}haml ; rm $i ; done 
```

只需删除公用文件夹中的 index.html

# ios - iOS：如何定义公共方法？

> ID：10853285
> 
> 赞同：10
> 
> 时间：2012-06-01T15:36:23.650
> 
> 标签：ios, methods, public

如何在每个视图控制器类中定义可以从任何地方调用的方法？

我有一个方法可以为我带来一个 json 文件，并且我希望它可以重用，因为我的应用程序上有几个 json 调用。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T15:59:46.907

您可以通过类别添加它：

**编辑**

创建一个新的 .h .m 文件对并在 .h 文件中：

```
@interface UIViewController(JSON)
-(void) bringJSON;
-(void) fetchData:(NSData*) data;

@ end 
```

然后在 .m 文件中：

```
@implementation UIViewController(JSON)

-(void) bringJSON {

dispatch_async(dispatch_get_global_queue( DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

[NSData dataWithContentsOfURL:yourURL];

[self performSelectorOnMainThread:@selector(fetchData:)
withObject:data waitUntilDone:YES];

});

}

-(void) fetchData:(NSData*) data {

//parse - update etc.

}

@end 
```

我只是假设您将返回一个 NSArray，您可以将任何方法放在那里并扩展所有 UIViewControllers。方法 bringJSON 将可用于所有 UIViewControllers 及其子类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T15:40:10.593

我相信您正在考虑使用“+”符号定义的静态方法。

```
+ (String) yourFunctionName:(NSInteger)someValue ..... 
```

然后你可以先用类名在任何地方调用它：

```
[YourClassName yourFunctionName:5]; 
```

如果您需要一个函数来访问需要实例化的对象，那么您将需要执行单例模式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-23T14:28:46.750

在方法的返回类型之前使用 + 号。

例如：

```
 + (void) Name: (NSString  *) str{

 } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T15:43:56.593

我加了第一个答案，因为它是一种创建（本质上）另一个对象的方法，该对象的方法可以从包含该对象的任何文件中调用。

还要记住，objective-c 也只是 C。您可以包含 .c 文件，这些文件仅包含也可以调用的 ANSI-C 例程。

# ruby - 使用 delete_if 从两个数组中删除元素的最佳方法

> ID：10853287
> 
> 赞同：0
> 
> 时间：2012-06-01T15:36:39.220
> 
> 标签：ruby, arrays

我想知道这是否可以改进。

我有两个数组：链接和archived_releases。 `links`包含可能出现在`archived_releases`条目的 :url 键中的字符串。

这没有用：

```
links.delete_if { |link|
  archived_releases.count > archived_releases.delete_if{ |release| release[:url] == link }.count
} 
```

所以我想出了这个：

```
links.delete_if { |link|
  archived_releases.count > archived_releases.delete_if{ |release| release[:url] == link }.count
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:39:43.033

我会首先提取`archived_releases`您想要快速比较的条目，然后您可以使用快速`include?`检查。就像是：

```
urls = archived_releases.collect { |ar| ar[:url] }
links.delete_if { |link| urls.include?(link) } 
```

# python - 龙卷风中的单元测试

> ID：10853288
> 
> 赞同：14
> 
> 时间：2012-06-01T15:36:41.053
> 
> 标签：python, unit-testing, tornado

我正在使用 mongodb 作为后端在 tornado.web 中构建一个简单的 Web 应用程序。90% 的服务器端代码库存在于一组 RequestHandlers 中，90% 的数据对象是 json。因此，测试处理程序的基本用例是：

```
"Given Request Y and DB in state X,
 verify that handler method Z returns json object J" 
```

如何设置这种测试？

我发现了一些关于该主题的博客文章和讨论线程，但它们主要集中在设置异步。我找不到任何关于设置正确类型的数据库状态或 GET/POST 请求参数的内容。

*   [http://emptysquare.net/blog/tornado-unittesting-eventually-correct/](http://emptysquare.net/blog/tornado-unittesting-eventually-correct/)
*   [http://www.tornadoweb.org/documentation/testing.html](http://www.tornadoweb.org/documentation/testing.html)
*   [https://groups.google.com/group/python-tornado/browse_thread/thread/867cfb2665ea10a9/319555e619fe6c5c](https://groups.google.com/group/python-tornado/browse_thread/thread/867cfb2665ea10a9/319555e619fe6c5c)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T14:16:59.593

我通常会模拟输入并仅测试输出。这是一个使用这个模拟库的人为示例 - [http://www.voidspace.org.uk/python/mock/](http://www.voidspace.org.uk/python/mock/)。您必须模拟出正确的 mongodb 查询函数。我不确定你在用什么。

```
from mock import Mock, patch
import json

@patch('my_tornado_server.mongo_db_connection.query')
def test_a_random_handler_returns_some_json(self, mock_mongo_query):

    request = Mock()
    # Set any other attributes on the request that you need
    mock_mongo_query.return_value = ['pink', 'orange', 'purple']

    application = Mock()
    handler = RandomHandler(application, request)
    handler.write = Mock()

    handler.get('some_arg')

    self.assertEqual(handler.write.call_args_list, json.dumps({'some': 'data'})) 
```

# macos - 在 OS-X 上最大化并行 http 请求

> ID：10853294
> 
> 赞同：1
> 
> 时间：2012-06-01T15:37:07.927
> 
> 标签：macos, unix

我必须尽可能快地抓取数千个不同的网站。我的应用程序在单个进程上运行，我能够每秒获取 10 个 url。虽然如果我将它分叉到 10 个工作进程，我可以达到 64 个请求/秒。

为什么会这样？为什么我在单个进程上被限制为 10 个请求/秒，并且必须产生工人以达到 64 个请求/秒

*   我没有达到最大套接字/主机限制：所有 url 都来自唯一主机。
*   我没有达到最大文件描述符限制（AFAIK）：我的 ulimit -n 是 2560，并且 lsof 显示我的抓取工具从不使用超过 20 个文件描述符。
*   我在 sysctl.conf 中增加了 kern.maxfiles、kern.maxfilesperproc、kern.ipc.somaxconn 和 kern.ipc.maxsockets 的设置，然后重新启动。没有效果。
*   尝试增加 ulimit -n。没变。

有什么我不知道的限制吗？

# html - 对齐图像和文本内联

> ID：10853297
> 
> 赞同：1
> 
> 时间：2012-06-01T15:37:17.643
> 
> 标签：html, css

html代码：

```
<ul>
    <li><a href=#>Upload</a></li>
    <li><a href=#>christin Bayes</a></li>
    <li><img src="image/john.jpg" height="30" width="30"></li>  
    <li><a href=#>SignOut</a></li>
</ul> 
```

CSS：

```
ul li
{
    margin-left: 15px;
    display: inline;
    list-style: none;
} 
```

我希望列表项（上传、名称、注销）像在 facebook 中一样对齐中间。请建议我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:48:03.507

试试这个：[演示](http://jsfiddle.net/JellyBelly/BkZHA/1/)

**HMTL**：

```
<ul class="MenuBar">
    <li><a href=#>Upload</a></li>
    <li><a href=#>christin Bayes</a></li>
    <li><img src="image/john.jpg" height="30" width="30" /></li>   
    <li><a href=#>SignOut</a></li>
</ul>​ 
```

**CSS**：

```
.MenuBar
{
    padding: 0px;
    border: 1px solid #036;
    font-size: 8pt;
    height: 30px;
}

.MenuBar li
{
    display: inline;
    padding-left: 15px;
    list-style:none;
    height: 30px;
}

.MenuBar li img 
{
    vertical-align:middle;
} 
```

​ 显然你可以选择去掉边框只是为了测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:05:09.363

尝试这个。可能对您有帮助：

```
ul{   
    background: red;
    height: 30px;
}
ul li{
    margin-left:15px;
    display: table-cell;
    list-style: none;
    vertical-align: middle;
    width: 90px;
    text-align: center;
} 
```

[jsfiddle](http://jsfiddle.net/JCWSU/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:44:18.403

```
img {
    vertical-align:middle;
}
​ 
```

# php - 如何为 opencart 模块添加多语言支持

> ID：10853298
> 
> 赞同：0
> 
> 时间：2012-06-01T15:37:38.447
> 
> 标签：php, module, opencart, multilingual

我非常擅长创建自己的 vqmod，它让我可以根据自己的喜好自定义购物车。我现在正处于我想开始在我的国家支持另一种官方语言的阶段。

我已经搜索和搜索，并且看起来像是 opencart 扩展商店中的一些模块，但仍然无法完全掌握它。我在支持论坛中找不到任何帖子来解释如何实现这一目标。我有一个模块可以在产品页面上创建一个新选项卡。在这个选项卡上，我使用 ckeditor 来格式化文本并且一切正常。

我已经看到它在你进入一个模块来定制它的地方完成，你可以看到额外的按钮来添加不同语言的文本。只是找不到任何使用它的免费模块，这样我就可以通过使其工作来混淆我的方式。

谁能帮我将多语言添加到我的自定义 opencart 模块中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:57:04.887

我可以通过查看另一个带有语言文件的 mod 来弄清楚。

# c# - 在 C# 中，事件是否保留对回调方法所在的整个类的引用？

> ID：10853300
> 
> 赞同：1
> 
> 时间：2012-06-01T15:37:51.707
> 
> 标签：c#, .net, memory, memory-management, memory-leaks

我有一个具有 ConcurrentDictionary 作为私有成员的类。此类还定义了委托/回调方法。基类将此方法注册为外部事件的回调。这是只有一次。

我正在运行 ANT 内存分析器，我看到从数百个 ConcurrentDictionary 属性实例引用的 MyObj 实例有 1000 个。这些的 GC 根是事件回调。

这似乎导致内存在应用程序运行时显着增加。大约 5 分钟左右后，大部分内存被回收，但我担心应用程序可能会遇到问题，因为它会迅速膨胀在 GC 开始之前这么久。

这是怎么回事，我该如何解决？

这是注册处理程序的基本调用的片段

```
protected abstract void DataReceivedEventHandler(DataChangedEvent evt);

public virtual void RegisterForChanges(ICollection<MemoryTable> tables)
{
    foreach (MemoryTable table in tables)
    {
        _subscribedTables.Add(table);
        table.RegisterEventListener(new DataChangedCallBack(this.DataReceivedEventHandler));

    }
} 
```

这是在上述基类的子类中实现的处理程序：

```
private ConcurrentDictionary<string, DataRecord> _cachedRecords;

protected override void DataReceivedEventHandler(DataChangedEvent evt)
{
    DataRecord record = evt.Record as DataRecord;
    string key = record.Key;
    if (string.IsNullOrEmpty(key)) { return; }

    if (_cachedRecords.ContainsKey(key))
    {
        _cachedRecords[key] = record;

        DateTime updateTime = record.UpdateTime;
        TimeSpan delta = updateTime - _lastNotifyTime;
        if (delta.TotalMilliseconds > _notificationFrequency)
        {
            PublishData(updateTime);
        }
    }
} 
```

publishData 方法发布 prism 事件

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:44:26.877

**这是怎么回事**

是的，事件是代表的列表，它有两个相关字段：`target`和`method`。除非你引用的是静态方法，否则`target`就是对类的引用。并且是告诉事件调用哪个方法`method`的反射。`MemberInfo`

**如何排除故障**

考虑在方法中放置一个断点`add_EventName`。（如果您没有显式的 add_EventName 和 remove_EventName，则必须使用此显式代码重新定义您的事件）。

```
 private event EventHandler eventName;
  public event EventHandler EventName
  {
     add { eventName += value; } // Breakpoint here
     remove { eventName -= value; }
  } 
```

这将帮助您找到它被订阅这么多次的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:05:05.650

委托包含对对象的强引用以及对该对象调用什么方法的指示。因此，持有对委托的强引用的活动对象将保持委托将对其进行操作的对象（以及该对象持有强引用的任何对象）。

有时人们会希望注册一个回调或事件，以便为其他对象的利益而对一个对象进行操作，但回调或事件不应该仅仅为了它自己而使对象保持活动状态。例如，一个对象可能希望记录某个长期存在的对象引发特定事件的次数，从而创建一个附加到该事件的“事件计数器”对象的实例。只要长寿命对象持有计数器对象的事件订阅，该计数器对象将保持活动状态，并且每次引发事件时计数器都会递增。当然，如果曾经看过计数器的每个人都已不复存在，那么无论是计数器，还是增加它所需的努力，都不会起到任何有用的作用。

如果有一个回调，希望在未来某个确定的时间点被触发，但只有当一些实时引用（在回调本身之外）存在于它所操作的对象时，回调才会起到有用的作用，它可能将回调注册到转发对象很有用，如果这样做有意义，该对象又会将调用转发到主对象。实现这一点的最简单方法是让转发对象持有一个`WeakReference`. 当转发对象收到呼叫时，它会`Target`从`WeakReference`. 如果它不为空，它会将检索到的目标转换为主对象的类型并在其上调用适当的方法。如果主对象在回调执行之前不再存在，则`WeakReference.Target`属性将为空，转发对象的回调将简单地静默返回。

`Target`一些进一步的注意事项：（1）将 的 设置为委托并调用它可能很诱人`WeakReference`，但这种方法只有在真正的目标对象本身持有对该委托的引用时才有效；否则，即使它的目标不是，委托本身也将有资格进行垃圾收集；`WeakReference`(2) 将转换为接口并让主对象实现该接口可能会有所帮助。这将允许一个转发对象类与许多其他类一起使用。如果一个类可能想要附加到许多弱事件，使用通用接口可能会有所帮助：

```
接口 IDispatchAction<DummyType,ParamType>
{
  无效法（ParamType 参考参数）；
}

```

这将允许主对象公开许多`IDispatchAction`操作（例如，如果一个类实现了`IDispatchAction<foo,int>.Act`and `IDispatchAction<bar,int>.Act`，则将该类的引用转换为这些接口之一并调用`Act`它会调用适当的方法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:43:31.237

一次引发外部事件后，取消订阅您的类（SomeClass.SomeEvent -= MyEventHandler），或者您可以查看使用 Wea​​kReferences

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T16:52:06.850

您是否有可能一遍又一遍地重新订阅表格？我看到这个：

```
foreach (MemoryTable table in tables)
{
    _subscribedTables.Add(table);
    table.RegisterEventListener(new DataChangedCallBack(this.DataReceivedEventHandler));
} 
```

我希望看到一个检查以确保表没有被重新订阅：

```
foreach (MemoryTable table in tables)
{
    if (!_subscribedTables.Contains(table)) {
        _subscribedTables.Add(table);
        table.RegisterEventListener(new DataChangedCallBack(this.DataReceivedEventHandler));
    }
} 
```

编辑：鉴于问题开头的评论，我相当有信心问题（如果你可以称之为问题）就在这里：

```
if (_cachedRecords.ContainsKey(key))
{
    _cachedRecords[key] = record; 
```

您在这里所说的是，如果记录的键已存在于 中`cachedRecords`，则将值替换为（可能）新行实例。这可能是因为某些后台进程导致行的数据发生更改，您需要将这些新值传播到 UI。

我的猜测是 MemoryTable 类正在为这些更改创建一个*新*的 DataRecord 实例，并将该新实例沿事件链发送到我们在此处看到的处理程序。如果事件被触发了数千次，那么你当然会在内存中拥有数千次。垃圾收集器通常可以很好地清理这些东西，但您可能需要考虑就地更新以避免收集这些实例时发生的大量 GC。

您不应该*做*的是尝试控制（甚至预测）GC 何时运行。只要确保在 GC 收集后，多余的对象都消失了（换句话说，确保它们没有被泄漏），你会没事的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-16T06:45:26.163

如果我们希望对象定义的回调方法不留在内存中，我们必须将此方法定义为静态。

# c# - 保存和加载图像 SQLite C#

> ID：10853301
> 
> 赞同：16
> 
> 时间：2012-06-01T15:37:51.693
> 
> 标签：c#, image, sqlite, compact-framework

我正在尝试使用带有 CF 的 WinForm 上的应用程序使用 SQLite 保存和加载图像。我找到了一种将图像保存到数据库中的方法，但我不知道它是否正确，因为我找不到加载存储在数据库中的图像的方法。

我有一个将图像转换为 Base64 的代码：

```
public void ImageToBase64(Image image, System.Drawing.Imaging.ImageFormat format){
        using (MemoryStream ms = new MemoryStream()){
            // Convert Image to byte[]
            image.Save(ms, format);
            byte[] imageBytes = ms.ToArray();

            // Convert byte[] to Base64 String
            string base64String = Convert.ToBase64String(imageBytes);
            SaveImage(base64String);
        }
    } 
```

这是我将图像保存到数据库中的代码：

```
void SaveImage(string pic){
        string query = "insert into Table (Photo) values (@pic);"; 
        string conString = @" Data Source = \Program Files\Users.s3db ";            
        SQLiteConnection con = new SQLiteConnection(conString); 
        SQLiteCommand cmd = new SQLiteCommand(query, con);
        cmd.Parameters.Add("@pic",DbType.String);
        con.Open(); 
        try{
            cmd.ExecuteNonQuery();
        }
        catch (Exception exc1){
            MessageBox.Show(exc1.Message);
        }
        con.Close();
    } 
```

我有一个与 ImageToBase64 相反的代码，但首先我需要从数据库加载图像。有什么想法吗？

**编辑**我正在尝试按照查理的建议使用 blob 来保存图像。我试过这段代码：

```
Image photo = new Bitmap(@"\Photos\Image20120601_1.jpeg");
SaveImage(photo);

void SaveImage(Image pic){
string conString = @" Data Source = \Program Files\Users.s3db ";            
SQLiteConnection con = new SQLiteConnection(conString);
SQLiteCommand cmd = con.CreateCommand();
cmd.CommandText = String.Format("INSERT INTO Table (Photo) VALUES (@0);");
SQLiteParameter param = new SQLiteParameter("@0", System.Data.DbType.Binary);
param.Value = pic;
cmd.Parameters.Add(param);
con.Open(); 
try{
    cmd.ExecuteNonQuery();
}
catch (Exception exc1){
    MessageBox.Show(exc1.Message);
}
con.Close();} 
```

但是当我*ExcecuteNonQuery()它捕获**InvalidCastException*错误。

有什么建议吗？

**解决方案**此代码将图像保存到数据库中，然后加载图像以将其显示在图片框中：

```
namespace ImagenSQLite
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            Image photo = new Bitmap(@"\Photos\Image20120601_1.jpeg");
            byte[] pic = ImageToByte(photo, System.Drawing.Imaging.ImageFormat.Jpeg);
            SaveImage(pic);
            LoadImage();
        }

        public byte[] ImageToByte(Image image, System.Drawing.Imaging.ImageFormat format){
            using (MemoryStream ms = new MemoryStream())
            {
                // Convert Image to byte[]
                image.Save(ms, format);
                byte[] imageBytes = ms.ToArray();
                return imageBytes;
            }
        }
        //public Image Base64ToImage(string base64String)
         public Image ByteToImage(byte[] imageBytes)
        {
            // Convert byte[] to Image
            MemoryStream ms = new MemoryStream(imageBytes, 0, imageBytes.Length);
            ms.Write(imageBytes, 0, imageBytes.Length);
            Image image = new Bitmap(ms);
            return image;
        }
        /***************** SQLite **************************/
        void SaveImage(byte[] imagen){
            string conStringDatosUsuarios = @" Data Source = \Program Files\GPS___CAM\Data\DatosUsuarios.s3db ";            
            SQLiteConnection con = new SQLiteConnection(conStringDatosUsuarios); 
            SQLiteCommand cmd = con.CreateCommand();
            cmd.CommandText = String.Format("INSERT INTO Empleados (Foto) VALUES (@0);");
            SQLiteParameter param = new SQLiteParameter("@0", System.Data.DbType.Binary);
            param.Value = imagen;
            cmd.Parameters.Add(param);
            con.Open();

            try
            {
                cmd.ExecuteNonQuery();
            }
            catch (Exception exc1)
            {
                MessageBox.Show(exc1.Message);
            }
            con.Close();
        }
        void LoadImage(){
            string query = "SELECT Photo FROM Table WHERE ID='5';";
            string conString = @" Data Source = \Program Files\Users.s3db ";
            SQLiteConnection con = new SQLiteConnection(conString); 
            SQLiteCommand cmd = new SQLiteCommand(query, con);            
            con.Open();
            try
            {
                IDataReader rdr = cmd.ExecuteReader();
                try
                {
                    while (rdr.Read())
                    {
                        byte[] a = (System.Byte[])rdr[0];
                        pictureBox1.Image = ByteToImage(a);
                    }
                }
                catch (Exception exc) { MessageBox.Show(exc.Message); }
            }
            catch (Exception ex) { MessageBox.Show(ex.Message); }
            con.Close();
        }       
    }
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T15:55:03.140

要从数据库加载图像，您可以使用 SQL`select`语句来取回数据，就像您处理任何其他类型的数据一样。base64 编码的图像以字符串形式存储在 SQLite 数据库中。因此，您将其作为字符串检索，就像您在数据库中存储任何其他字符串（例如，您的姓名）一样。

```
string LoadImage() {
    string query = "select Photo from Table;"; 
    string conString = @" Data Source = \Program Files\Users.s3db ";            
    SQLiteConnection con = new SQLiteConnection(conString); 
    SQLiteCommand cmd = new SQLiteCommand(query, con);
    string base64EncodedImage = null;
    con.Open(); 
    try {
        IDataReader reader = cmd.ExecuteReader();
        reader.Read(); // advance the data reader to the first row
        base64EncodedImage = (string) reader["Photo"];
        reader.Close();
    }
    catch (Exception ex) {
        MessageBox.Show(ex.Message);
    }
    con.Close();
    return base64EncodedImage;
} 
```

与您的保存代码一样，我加载图像的示例代码仅使用一张保存到表中的图像。要加载和保存多个图像，您需要在表中插入一个 ID 字段，然后`where`在 SQL`select`语句中使用子句。

* * *

我不确定我个人是否会将图像存储为 base64 编码的字符串。图像的字符串表示将比二进制表示大得多。[SQLite 支持 BLOB 数据类型](http://www.sqlite.org/datatype3.html)，所以我会考虑使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-08T22:34:34.453

这是 VB.net 中的示例代码：

```
Imports System.IO
Imports System.Data.SQLite

Public Class Form1

    'Image BLOB Functions:'
    Private Function BlobToImage(ByVal blob)
        Dim mStream As New System.IO.MemoryStream
        Dim pData() As Byte = DirectCast(blob, Byte())
        mStream.Write(pData, 0, Convert.ToInt32(pData.Length))
        Dim bm As Bitmap = New Bitmap(mStream, False)
        mStream.Dispose()
        Return bm
    End Function

    'USE THIS FUNCTION TO CREATE A BLOB FROM AN IMAGE FILE'
   Public Overloads Function ImageToBlob(ByVal id As String, ByVal filePath As String)
        Dim fs As FileStream = New FileStream(filePath, FileMode.Open, FileAccess.Read)
        Dim br As BinaryReader = New BinaryReader(fs)
        Dim bm() As Byte = br.ReadBytes(fs.Length)
        br.Close()
        fs.Close()
        'Create Parm'
        Dim photo() As Byte = bm
        Dim SQLparm As New SQLiteParameter("@image", photo)
        SQLparm.DbType = DbType.Binary
        SQLparm.Value = photo
        Return SQLparm
    End Function

    'USE THIS FUNCTION TO CREATE A BLOB FROM AN IMAGE VARIABLE IN MEMORY'
    Public Overloads Function ImageToBlob(ByVal id As String, ByVal image As Image)
        Dim ms As New MemoryStream
        image.Save(ms, System.Drawing.Imaging.ImageFormat.Png)
        'Create Parm'
        Dim photo() As Byte = ms.ToArray()
        Dim SQLparm As New SQLiteParameter("@image", photo)
        SQLparm.DbType = DbType.Binary
        SQLparm.Value = photo
        Return SQLparm
    End Function

    'USE THIS SUB TO CREATE A DB AND TABLE'
    Private Sub btnCreateDB_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim SQLconnect As New SQLiteConnection()
        Dim SQLcommand As New SQLiteCommand
        SQLconnect.ConnectionString = "Data Source = " & Application.StartupPath & "\imgdb.sqlite3;"
        SQLconnect.Open()
        SQLcommand = SQLconnect.CreateCommand
        'SQL Query to Create Table'
        SQLcommand.CommandText = "CREATE TABLE foo(id INTEGER PRIMARY KEY AUTOINCREMENT, title TEXT, description TEXT, image BLOB);"
        SQLcommand.ExecuteNonQuery()
        SQLcommand.Dispose()
        SQLconnect.Close()
    End Sub

    'USE THIS SUB TO INSERT IMAGE INTO SQLITE DB.  IT GETS AN id INTEGER FROM 
    Textbox1'
    Private Sub btnInsertImage_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim d As New OpenFileDialog
        d.Filter = "image (*.png)|*.png|(*.jpg)|*.jpg|All files|*.*"

        If d.ShowDialog() = DialogResult.OK Then
            Dim myimage As Bitmap = Clipboard.GetImage()

            Dim SQLconnect As New SQLite.SQLiteConnection()
            Dim SQLcommand As New SQLiteCommand
            SQLconnect.ConnectionString = "Data Source = " & Application.StartupPath & "\imgdb.sqlite3;"
            SQLconnect.Open()
            SQLcommand = SQLconnect.CreateCommand
            'Insert Image, DO NOT single-quote @image'
            SQLcommand.CommandText = "INSERT INTO foo (id,image) VALUES('" + TextBox1.Text + "', @image)"
            'Define @image'
            SQLcommand.Parameters.Add(ImageToBlob("@image", myimage))
            SQLcommand.ExecuteNonQuery()
            SQLcommand.Dispose()
            SQLconnect.Close()
            MessageBox.Show("Pic Inserted")
        End If
    End Sub

    'USE THIS SUB TO GET THE BLOB FROM THE DB AND CONVERT IT BACK TO AN IMAGE'
    Private Sub btnGetImageFromDB_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim SQLconnect As New SQLite.SQLiteConnection()
        Dim SQLcommand As New SQLiteCommand
        SQLconnect.ConnectionString = "Data Source = " & Application.StartupPath & "\imgdb.sqlite3;"
        SQLconnect.Open()
        SQLcommand = SQLconnect.CreateCommand
        SQLcommand.CommandText = "SELECT image FROM foo WHERE id = '" + TextBox1.Text + "'"
        Dim SQLreader As SQLiteDataReader = SQLcommand.ExecuteReader()
        Dim myimage As Bitmap 
        While SQLreader.Read
            myimage = BlobToImage(SQLreader("image"))
            PictureBox1.Image = Nothing
            PictureBox1.Image = myimage
        End While
        SQLcommand.Dispose()
        SQLconnect.Close()

    End Sub 
```

# html - CSS :hover 在元素指向之前影响元素

> ID：10853302
> 
> 赞同：1
> 
> 时间：2012-06-01T15:37:56.507
> 
> 标签：html, css

我有以下 HTML 结构：

```
<ul class="container">
    <li>
        <a href="#" class="option"></a>
        <ul class="submenu">
            <li><a href="#">Item A</a></li>
            <li><a href="#">Item B</a></li>
         </ul>
     </li>
</ul> 
```

当鼠标悬停在“子菜单”上时，是否可以使用 CSS 更改“选项”的背景位置？

我看到了[CSS Referente](http://www.w3schools.com/cssref/css_selectors.asp)，我尝试使用“>”、“+”和“~”，但它不起作用。我不知道是我使用不正确还是不可能。

有人可以帮我吗？

**编辑 1**

这是不起作用的CSS：

```
a.option~ul.submenu:hover {
    background-position:0 -48px;
} 
```

根据[CSS Referente](http://www.w3schools.com/cssref/css_selectors.asp)，在我的例子中，“~”选择每个前面有“a”元素的“ul”元素，但不适用于我的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:55:38.580

如果您可以将“选项”放在 UL 之后，那么它将起作用：

```
<ul class="container">
    <li>
        <ul class="submenu">
            <li><a href="#">Item A</a></li>
            <li><a href="#">Item B</a></li>
         </ul>
        <a href="#" class="option"></a>
     </li>
</ul> 
```

这个CSS：

```
.submenu:hover + .option {
    background-position: -20px -20px;
} 
```

用简单的英文写成：当悬停在 .submenu 上时，更改 .submenu 之后立即出现的 .option 的背景位置。希望有帮助。

```
.submenu:hover ~ .option {
    background-position: -20px -20px;
} 
```

这与“+”选择器相同，除了 .option 不必*紧跟*在 .submenu 后面。例如，“+”**不适**用于以下标记，但“~”**可以**使用。

```
<ul class="container">
    <li>
        <ul class="submenu">
            <li><a href="#">Item A</a></li>
            <li><a href="#">Item B</a></li>
        </ul>
        <span>Some other element</span>
        <a href="#" class="option"></a>
     </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:51:56.193

接近您想要的 html 结构的唯一方法是`:hover`在`li`. 就像是：

```
.container > li:hover > .option {
    background-position: 0 0;
} 
```

看看这个不会改变的[小提琴](http://jsfiddle.net/tXEhy/2/)`background-position`，但是`color`。当悬停`.submenu`在 parent 上时也会有一个悬停`li`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:47:32.587

我认为这是不可能的，因为 .option 不是子菜单的子菜单

# java - 如何停止执行服务内的长时间执行任务（例如无限循环）执行

> ID：10853305
> 
> 赞同：2
> 
> 时间：2012-06-01T15:38:12.980
> 
> 标签：java, multithreading

下面是一个示例程序。如果我取消注释 Thread.sleep 它工作正常。但是可能有一些需要，我们不确定在 Call 方法中编写的代码需要多少时间，可能是无限的时间。或者，可能是一个糟糕的程序，其中 Call 方法中的数据库连接逻辑需要更多时间，我们需要终止。

您能否告诉我，如果我评论 thread.sleep 以及如何在不编写 Thread.interrupted 条件的情况下杀死和停止它，为什么下面的代码不起作用。（假设我没有权限在 Call 方法中写入任何逻辑）

```
import java.util.concurrent.ExecutionException;
import java.util.concurrent.Future;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

public class stopThreadTest {

    public static void main(String[] args) {

        java.util.concurrent.ExecutorService executor = null;
        Future a1 = null;

        try {
            executor = java.util.concurrent.Executors.newFixedThreadPool(4);
            a1 = executor.submit(new java.util.concurrent.Callable() {
                public String call() throws Exception {
                    int i = 0;
                    while (true) {
                        //Thread.sleep(100);
                        // System.out.println("hello");
                        if (i > 10)
                            break;
                    }
                    return null;
                }
            });

            // Wait until all threads are finish
            /*
             * while (!executor.isTerminated()) { }
             */
            System.out.println("Calling PartialOrFullSuccessCheck");

            try {
                boolean isThreadError = (a1 != null) ? ((a1.get(2,
                        TimeUnit.SECONDS) == null) ? false : true) : false;

            } catch (TimeoutException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();

                // interrupts the worker thread if necessary
                System.out
                        .println("Cancelled" + a1.isDone() + a1.isCancelled());
                a1.cancel(true);

                System.out.println("encountered problem while doing some work");
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();

                // interrupts the worker thread if necessary
                System.out
                        .println("Cancelled" + a1.isDone() + a1.isCancelled());
                a1.cancel(true);
            } catch (ExecutionException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();

                // interrupts the worker thread if necessary
                System.out
                        .println("Cancelled" + a1.isDone() + a1.isCancelled());
                a1.cancel(true);
            }

        } finally {
            System.out.println("ShutDown Executor");
            executor.shutdown();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T23:31:11.907

如果没有线程的合作，就没有安全的方法来停止线程。线程允许其他线程通过被中断、定期检查某个共享变量的值或两者兼而有之来停止它们。除此之外，唯一安全的做法是关闭 JVM（整个进程）。这个帖子很详细：

[你如何杀死Java中的线程？](https://stackoverflow.com/questions/671049/how-do-you-kill-a-thread-in-java)

# php - 检查输入文本字段中的值与 JSON 数组的值

> ID：10853307
> 
> 赞同：2
> 
> 时间：2012-06-01T15:38:19.877
> 
> 标签：php, javascript, jquery, arrays, json

**问题：**

我有一个部分工作的函数，由于某种原因，它被值 100 卡住了。所有其他值都可以正常工作。该函数将输入字段的值与 JSON 数组中的对应值进行比较。

**设想：**

例如，您先选择 3，然后选择 1，然后选择 1，您最终将得到值 12。如果您在输入字段中输入 100，然后继续前进，则会出现错误，如 addClass() 所示。100 不小于 12 并且不应允许 addClass() 添加错误。这里的错误在哪里？

**HTML 代码：**

```
<div id="ref" class="control-group">
    <label class="control-label">Number of references:</label>

    <div class="controls">
        <div class="input-prepend">
            <input class="input-small" id="references" name="references" type="text">
        </div>
    </div>
</div> 
```

**该数组由 PHP 生成，并通过 json_encode() 转换为 JavaScript，如下所示：**

```
var numbers = <?php echo json_encode($numbers); ?>; 
```

**数组：**

```
{
    "1":{
        "1":{
            "1":"36",
            "2":"63"
        },
        "2":{
            "1":"54",
            "2":"63"
        }
    },
    "2":{
        "1":{
            "1":"60",
            "2":"105"
        },
        "2":{
            "1":"90",
            "2":"105"
        }
    },
    "3":{
        "1":{
            "1":"12",
            "2":"21"
        },
        "2":{
            "1":"18",
            "2":"24"
        }
    }
} 
```

**jQuery代码：**

```
<script type="text/javascript">
    $(document).ready(function()
    {           
        $('#references').change(function() 
        {
            var choice1 = $('input[name=level]:checked').val();

            if (choice1 == '1') 
            {
                var choice2 = $('input[name=authors]:checked').val();
            } 
            else 
            {
                var choice2 = $('input[name=credits]:checked').val();
            }

            var number = numbers[3][choice1][choice2];

            if ($(this).val() < number) 
            {
                $('#ref').addClass('error');
            } 
            else 
            {
                $('#ref').removeClass('error');
            }
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:42:13.390

您正在那里进行字符串比较。在字符串比较`"100" < "12" = true`中。尝试进行如下数字比较，

```
if (parseInt($(this).val(), 10) < parseInt(number, 10)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:46:50.100

现在，您所有的数字都是字符串......所以javascript引擎不会将您的数字视为真实数字。

尝试将 parseInt() 包裹在您希望为数字的任何内容上：

```
<script type="text/javascript">
    $(document).ready(function()
    {           
        $('#references').change(function() 
        {
            var choice1 = $('input[name=level]:checked').val();

            if (choice1 == '1') 
            {
                var choice2 = $('input[name=authors]:checked').val();
            } 
            else 
            {
                var choice2 = $('input[name=credits]:checked').val();
            }

            var number = parseInt( numbers[3][choice1][choice2], 10);

            if (parseInt( $(this).val(), 10) < number) 
            {
                $('#ref').addClass('error');
            } 
            else 
            {
                $('#ref').removeClass('error');
            }
        });
    });
</script> 
```

# android - android中直接相机上的字符识别？

> ID：10853308
> 
> 赞同：1
> 
> 时间：2012-06-01T15:38:20.280
> 
> 标签：android, ocr

我只是想知道，

由于条形码扫描仪在 Android 中工作。是否有可能在android中制作基于ocr的应用程序，它只能在旅途中识别字符..

意味着当我在应用程序中启动我的相机时，它应该开始工作而不是拍照然后识别......

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:42:58.820

您可以使用适用于 Android 的 OpenCV。[对于动态识别，您可以在此处](http://code.google.com/p/zxing/)查看 BarCodeScanner 如何实现它

[OpenCV4Android](http://code.opencv.org/projects/opencv/wiki/OpenCV4Android)

# plot - 如何在matplotlib中将图形缩小到以英寸为单位的特定尺寸

> ID：10853309
> 
> 赞同：5
> 
> 时间：2012-06-01T15:38:21.840
> 
> 标签：plot, matplotlib

假设我在 matplotlib 中准备了一个 PDF 图形，假设我已将图形的原始尺寸指定为 10x10 英寸。是否有可能产生基本相同的图形，但缩小到 7x7 英寸（以便所有字体/磅值等都适当缩小）？

我知道我可以在矢量图形编辑器中打开我的 10x10 文件并执行重新缩放，但我很感兴趣是否有一些简单的开关可以直接从 matplotlib 执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T22:22:59.950

使用`set_size_inches`，像这样：

```
import matplotlib.pyplot as plt

fig=plt.figure()
ax=fig.add_subplot(111)

fig.set_size_inches([10,10])
ax.plot([1,3,2],[2,2,2],'ro-')
plt.savefig('10x10.png')

fig.set_size_inches([4,4])
plt.savefig('4x4.png') 
```

# .net - 如何使类属性的行为类似于 RadioButton 上的 Checked 属性？

> ID：10853310
> 
> 赞同：1
> 
> 时间：2012-06-01T15:38:23.283
> 
> 标签：.net, vb.net

我有一个非常简单的类，它包含一些公共属性——ID、文本、颜色等和一个名为“SelectedItem”的布尔值。就像`Checked`RadioButtons 上的属性一样，只有一个项目可以将其`SelectedItem`属性设置为`True`特定组内。注意：将有几个单独的组（列表），每个组只能有一个带有`SelectedItem = True`.

我的第一个想法是，我可能只需要处理班级以外的所有内容，在选择其他项目时为特定列表中的所有其他项目`SelectedItem`设置。`False`但这对我来说似乎相当不雅。所以我一直在努力思考如何*在*课堂上做到这一点。例如：我是否可以有一个名为“GroupName”的私有字符串属性 - 在`New`添加类的新实例时在子中设置 - 然后使用私有共享方法将每个项目的`SelectedItem`属性设置为`False`，*前提*是项目具有相同`GroupName`作为新选择的项目？我会尝试这样做，但我不知道如何从该类中枚举该类的每个实例，或者这是否可能。是吗？还是有另一种（更好的）方法来实现我的目标？

* * *

**编辑**

感谢所有的建议和意见，他们都非常感谢。

根据 Tim 和 Cyborgx37 的评论，我决定听从他们的建议并使用 CollectionBase 作为项目管理器类。这是我到目前为止所拥有的精简版：

```
Public Class ResourceItem
    Public ID As Integer
    Public Text As String
    Public SelectedItem As Boolean
End Class

Public Class ResourceItemsManager
    Inherits System.Collections.CollectionBase

    Public Sub Add(ByVal iID As Integer, ByVal sText As String)
        Dim newResItem As New ResourceItem
        With newResItem
            .ID = iID
            .Text = sText
        End With
        List.Add(newResItem)
    End Sub

    Default Public ReadOnly Property Item(ByVal Index As Integer) As ResourceItem
        Get
            If Index < Count And Index >= 0 Then
                Return CType(List.Item(Index), ResourceItem)
            Else
                Return Nothing
            End If
        End Get
    End Property

    Public Sub ClearAll()
        List.Clear()
    End Sub

    Public Sub SelectItem(ByVal Index As Integer)
        If Index < Count And Index >= 0 Then
            For i As Integer = 0 To List.Count - 1
                List.Item(i).SelectedItem = i = Index
            Next
        Else
            'Exception code here
        End If
    End Sub
End Class 
```

可以看出：我没有实例化一个 new`ResourceItem`并将其作为参数传递给管理器的`Add`过程，而是简单地传递了新项目的详细信息，并且该过程正在从中创建项目。我不知道这是个好主意还是坏主意-请告知-但我已经这样做了，因为我不知道如何使 SelectedItem 属性只能由经理写入，所以我想避免直接访问可以将其`SelectedItem`属性设置为的对象，`True`而无需取消选择同一组中的所有其他项目。当然，仍然有可能将变量设置为经理的列表项之一并从那里进行设置，所以我仍然想知道如果可能的话，我该如何防止这种情况发生。

* * *

**更新**
最后我没有使用上面的代码，而是决定使用 Cyborgx37 的解决方案——尽管有关于最佳实践的警告，这似乎对我来说效果很好。我还意识到我需要在另一个可以选择多个项目的场景中使用同一个类*，*因此很容易向管理器添加一个布尔属性来启用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:31:19.937

这是一个非常简单的解决方案。它并不遵循所有最佳实践（例如，在 ItemManager 中公开 Items 集合可能是一个坏主意），但它展示了中央管理器的想法以及与管理器交互的各个项目中的属性。

```
Module Module1

Sub Main()

    Dim l_itemManager As New ItemsManager()

    Dim l_item1 As New Item(l_itemManager) With {.Description = "Item 1"}
    Dim l_item2 As New Item(l_itemManager) With {.Description = "Item 2"}
    Dim l_item3 As New Item(l_itemManager) With {.Description = "Item 3"}
    Dim l_item4 As New Item(l_itemManager) With {.Description = "Item 4"}

    l_itemManager.SelectedItem = l_item1

    Console.WriteLine("Item 1 = " & If(l_item1.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 2 = " & If(l_item2.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 3 = " & If(l_item3.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 4 = " & If(l_item4.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("")

    l_itemManager.SelectedItem = l_item2

    Console.WriteLine("Item 1 = " & If(l_item1.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 2 = " & If(l_item2.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 3 = " & If(l_item3.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 4 = " & If(l_item4.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("")

    l_item3.IsSelected = True

    Console.WriteLine("Item 1 = " & If(l_item1.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 2 = " & If(l_item2.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 3 = " & If(l_item3.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("Item 4 = " & If(l_item4.IsSelected, "Selected", "Unselected"))
    Console.WriteLine("")

    Console.WriteLine("Press any key...")
    Console.ReadKey(True)

End Sub

Class ItemsManager

    Public Event SelectedItemChanged As EventHandler

    Public Items As New List(Of Item)

    Private _item As Item
    Public Property SelectedItem() As Item
        Get
            Return _item
        End Get
        Set(ByVal value As Item)
            _item = value
            RaiseEvent SelectedItemChanged(sender:=Me, e:=EventArgs.Empty)
        End Set
    End Property

End Class

Class Item

    Public Event IsSelectedChanged As EventHandler

    Private WithEvents _manager As ItemsManager
    Public ReadOnly Property Manager() As ItemsManager
        Get
            Return _manager
        End Get
    End Property

    Private _description As String
    Public Property Description() As String
        Get
            Return _description
        End Get
        Set(ByVal value As String)
            _description = value
        End Set
    End Property

    Public Property IsSelected() As Boolean
        Get
            Return Me.Manager.SelectedItem Is Me
        End Get
        Set(ByVal value As Boolean)
            If value Then
                Me.Manager.SelectedItem = Me
            Else
                Me.Manager.SelectedItem = Nothing
            End If
        End Set
    End Property

    Public Sub New(ByVal manager As ItemsManager)
        _manager = manager
        Me.Manager.Items.Add(Me)
    End Sub

    Private Sub _manager_SelectedItemChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles _manager.SelectedItemChanged
        RaiseEvent IsSelectedChanged(sender:=Me, e:=EventArgs.Empty)
    End Sub

End Class

End Module 
```

编辑：

虽然不完全符合最佳实践，但此代码将起作用。最佳实践高度依赖于上下文，因此在不了解应用程序细节的情况下很难说出“正确”的方法是什么。也就是说，管理器和子类的一般概念（子类调用管理器以获取它们的状态）应该在几乎所有情况下都有效。

我同意@TimSchmelter，CollectionBase 会给你最大的权力。但是你可能不需要那么多的力量来达到你的目的。而且你最终仍然不得不使用类似于我发布的代码 - 孩子们会向父母询问他们的状态。

注意：我纠正了上面代码中的一个小错误。将选定项目设置为未选定将不会导致任何事情发生。我已更改此行为以使 SelectedItem 为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:07:47.427

您可以将集合传递给 ctor 中的类并在那里迭代列表。

```
 List<People> peoples = new List<people>();
   peoples.add(new People("Group1", peoples));
   peoples.add(new People("Group1", peoples));
   peoples.add(new People("Group1", peoples));

   Public Class People, iNotifyPropertyChanged
   {
      private List<People> peoples;
      private bool isChecked = false;

      public book IsChecked 
      { 
          get { return isChecked; }
          set 
          {
              if(isChecked = value) return;
              isChecked = value;
              if (isChecked)
              {
                  foreach (person p in peoples)
                  {
                      if (p.Ischecked && p != this)  p.Uncheck();
                  }
              }
          }
      }
      public void Uncheck
      {
          isChecked = false;
          NotifyPropertyChanged("IsChecked");
      }

      public People(string group, List<People> _peoples { peoples = _peoples; };
   } 
```

# windows - 基于 Windows Unix 的客户端

> ID：10853314
> 
> 赞同：-1
> 
> 时间：2012-06-01T15:38:42.883
> 
> 标签：windows, unix, client, cygwin

是否有可用于 Windows 的便携式或轻量级 unix 基本客户端？虽然我知道使用 cygwin 可以为本地机器执行基于 unix 的计算和命令，但我希望（如果有的话）拥有一个可以通过存储媒体随身携带的轻量级客户端。有没有类似的东西可用于 Windows？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:51:37.247

如果我正确理解了这个问题，您需要一小组可以在 Windows 上执行的 UN*X 实用程序，比 cygwin 更轻量级。

[UnxUtils](http://unxutils.sourceforge.net/)就是这样。它是一组从 GNU 源代码移植到 Windows 的命令，打包为 .exe。唯一的依赖项是 ms CRT。只复制您需要的程序。

[MSYS](http://www.mingw.org/wiki/MSYS)与此类似，并且可能是最新的，并且被打包为安装程序。

由于您可能会使用 DOS shell，因此自然会有一些特性。特别是`find`命令令人沮丧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:47:00.133

将一些驱动器号分配给闪存驱动器（比如 U:），然后将[MinGW](http://www.mingw.org/)和[MSYS](http://www.mingw.org/wiki/MSYS)安装到它（安装程序：http: [//sourceforge.net/news/](http://sourceforge.net/news/?group_id=2435&id=307402) ?group_id=2435&id=307402 ）。修改两台机器上的 PATH 环境变量以指向`bin`MinGW 和 MSYS 目录中的目录。即使`PATH`特定机器上缺少条目（因为您的闪存驱动器未插入），Windows 也会跳过它们。

# razor - 波浪线路径在 MVC 4 中不起作用

> ID：10853316
> 
> 赞同：9
> 
> 时间：2012-06-01T15:38:57.520
> 
> 标签：razor, asp.net-mvc-4

据[我了解](http://www.davidhayden.me/blog/asp.net-mvc-4-the-new-tilde-slash-feature-in-razor-2)，一个普通的“~/foo”路径应该像 MVC 4 中的 @Url.Content("~/") 一样工作。但是，我正在尝试这样做并获得许多损坏的路径——输出 HTML 时，波浪号仍然存在。

因此，例如，我在 /Views/Shared/_Layout.cshtml 中有这个路径：

```
<link href="~/Content/Site.css" rel="stylesheet" type="text/css" /> 
```

交付的 HTML 如下所示：

```
<link href="~/Content/Site.css" rel="stylesheet" type="text/css" /> 
```

我很确定我也将它作为 MVC 4 项目运行。以下内容在 web.config 中：

```
<compilation debug="true" targetFramework="4.0">
  <assemblies>
    <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.Helpers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
  </assemblies>
</compilation> 
```

...在这一点上，我不确定接下来要寻找什么。有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-07-25T10:49:32.837

这可能是[Razor V2 中的一个错误](http://aspnetwebstack.codeplex.com/workitem/933)的结果，其中 HTML 注释中的撇号/单引号会破坏`~`路径的解析。

解决方法是使用 Razor 注释而不是 HTML 注释。即，替换`<!-- Here's your comment-->`为`@* Here's your comment *@`.

抱歉，这是一个长镜头，因为我不知道您是否有 HTML 评论，更不用说包含单引号的评论了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-01T15:58:57.243

我的猜测是您仍在运行 Razor 1（`MvcWebRazorHostFactory`<4.0）。

验证**Views**文件夹中的 web.config 如下所示...

```
 <configSections>
    <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
      <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
    </sectionGroup>
  </configSections>

  <system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
      </namespaces>
    </pages>
  </system.web.webPages.razor> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-01-27T20:07:34.260

当我将一些示例代码剪切并粘贴到视图中时，我遇到了这个问题。原来我的波浪号类型错误！

```
@{
Layout = "∼/Views/_BasicLayout.cshtml";
} 
```

对比

```
@{
Layout = "~/Views/_BasicLayout.cshtml";
} 
```

微妙的不同 - 草皮找到

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-01T16:15:38.967

[在这里](http://www.microsoft.com/en-us/download/details.aspx?id=29935)使用独立安装程序重新安装 MVC 4 (RC)为我解决了这个问题。我仍然不明白是什么导致了问题，但我可以忍受。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-31T11:17:37.053

对我来说，问题只与 SVG 图像类型有关。通过将以下内容添加到项目的 web.config 文件（*不是*视图使用的 web.config，MVC4）来解决它。

```
<configuration>
   <system.webServer>
      <staticContent>
         <mimeMap fileExtension=".svg" mimeType="image/svg+xml" />
      </staticContent>
   </system.webServer>
</configuration> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-09T19:21:43.047

对于 MVC 5 和 Razor 3，对我来说，问题原来是在 img 标签之前（很久以前！）的 html 元素中出现了一个额外的引号字符：

```
<div class="foo""> <!-- note the extra quote character here ugh -->
...
</div>
...
<img src="~/images/an-image.png" /> 
```

上述问题导致 razor 忽略波浪号 (~)，将其按原样/未转换提供给浏览器。花了我很长时间才找到问题，我最终通过将 img 标签移动到文件顶部并发现它在那里工作正常，然后采用分而治之的方法来缩小 *.cshtml 中的位置文件停止工作。

我希望这篇文章可以节省一些时间！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-05T10:34:53.033

问题是关于`href=`而不是哪些`< tag >`
示例：

```
< img src="@Url.Content("Images/someImage.jpg")"/>
< a href="@Url.Content("Home/About")" >click here< /a> 
```

可以嵌套`@`在其他内部`@section {}`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-06T08:52:29.240

为我解决这个问题的是关闭 Meleze.web HTML Minification。

# python - Python Selenium 2 API 并等待 DOM 准备好/元素可见

> ID：10853328
> 
> 赞同：0
> 
> 时间：2012-06-01T15:39:41.707
> 
> 标签：python, selenium

我想等到 DOM 稳定并构建页面，直到我尝试执行 Selenium WebDriver click() 方法。

由于 Selenium 2 似乎不再存在股票 wait_for() 方法。Selenium 和 Python 2 的“等待 15 秒或直到元素可点击”样式行为的最佳实践是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-05T08:36:50.180

您正在寻找的是明确等待。Selenium 文档进一步解释了[显式等待](http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp#explicit-waits)的工作原理。

您可以在此处找到不同类型的[预期条件](http://selenium.googlecode.com/svn/trunk/docs/api/py/webdriver_support/selenium.webdriver.support.expected_conditions.html?highlight=expected_conditions#selenium.webdriver.support.expected_conditions)。您可能最感兴趣的条件是称为“visibility_of”的条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:48:29.630

这是在 ruby​​ 中，我相信它也可以在 Python 中完成

```
@wait = Selenium::WebDriver::Wait.new(:timeout => 30)
#You can define as many as you want with various times
@wait_less = Selenium::WebDriver::Wait.new(:timeout => 15)
#and then
@wait.until { @driver.find_element(:id, "Submit") }
@driver.find_element(:id, "Submit").click 
```

注意 - 你可以等待任何事情。其他例子

```
@wait.until {@driver.window_handles.size > 1} 
```

或者

```
@wait_less.until {@driver.find_element(:tag_name => "body").text.include?("Some text")} 
```

# ruby-on-rails-3 - 通过 save 方法持久化的模型不会出现在 sqlite3 数据库中。为什么？

> ID：10853334
> 
> 赞同：0
> 
> 时间：2012-06-01T15:40:05.950
> 
> 标签：ruby-on-rails-3, sqlite

我是 RoR 的新手，可能会错过一些东西。你能告诉我有什么问题吗？

**单元测试中的测试方法**

测试“创建”做

```
prices = [12,14,16]
    prices.each {|p| 
        course = Course.new(:name => "j2ee", :price => p)
        course.save!
        puts course.persisted?
    }
#Course.where({:price => 12...17}).all.each do |c|
Course.find_by_price(12) do |c|
    puts c.price
end 
```

结尾

**运行测试的命令行输出**

# 运行测试：

真的
真的
真的
12
..

像预期的那样。

**但是为什么 db 表不包含行？**
sqlite3 test.sqlite3
sqlite> 从课程中选择计数（*）；
0

这是定义。正确的数据库。如果我使用夹具数据，它会正确插入，直到下一次测试可用。非常感谢！干杯抢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T14:02:21.567

您的问题没有指定您正在使用什么测试框架，但一般来说，测试框架会自行清理，这是礼貌的做法。

您确实说过它适用于固定装置，因此您无需担心。但是，如果您想手动验证持久性是否正常工作，请打开控制台并输入您的测试。

```
prompt$ rails c
> Course.new(:name => "j2ee", :price => 12).save!
> Course.all 
```

控制台打印所有课程。请注意，如果您使用的是 bundler（应该是），您可能需要使用“bundle exec rails c”启动控制台。

# widget - 带有寻呼机问题的果园投影小部件

> ID：10853335
> 
> 赞同：1
> 
> 时间：2012-06-01T15:40:07.580
> 
> 标签：widget, orchardcms, projection

我正在开发一个使用 Orchard CMS 制作的网站。我在带有自定义查询的页面上放置了一个投影小部件，它工作得很好，但是如果该页面上有一个寻呼机并且我点击另一个页面（不是第一个页面），投影小部件就会变成空的。所以它只在寻呼机的第一页上显示结果。

这是果园的虫子还是我做错了什么？有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T23:26:40.497

您需要在该小部件上配置分页器以使用不同的分页参数。

# reporting-services - 在 SSRS 字段中重用表达式

> ID：10853337
> 
> 赞同：1
> 
> 时间：2012-06-01T15:40:11.213
> 
> 标签：reporting-services

我正在 SSRS 中写报告。我有一个包含一些相当长的表达式的报告，尽管计算是简单的加法、减法和 mults 和 div。有没有办法捕获表达式的结果以用于另一个字段的计算，而不必重复整个原始计算？我已经在底层视图中进行了部分计算。是否可以做类似于引用“Field.xxx.Value”的事情？我现在使用的是 2008 R2，但很快就会迁移到 Sql Server 2012。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T08:38:04.933

假设您要重用的复杂表达式的结果位于名为“amt3”的文本框中。然后你可以用它来给它着色：

```
=iif(ReportItems("amt3").Value  < 0, "Red", "Green") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:43:56.453

您是要重复计算还是使用计算值？

如果要重复计算，可以使用嵌入代码。只需编写一些接受您想要的任何参数并输出结果的 VB。

# ruby-on-rails - Active_Admin 路由问题

> ID：10853342
> 
> 赞同：0
> 
> 时间：2012-06-01T15:40:48.313
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, activeadmin, before-filter

我已经在我的应用程序中安装了 Active_Admin gem，但我的应用程序上有一个过滤器，因此您可以访问的唯一页面是登录页面。当我尝试访问 active_admin 页面时，它会将我路由到我的应用程序的登录页面，而不是我的管理员登录页面。当我登录我的应用程序时，我可以访问 active_admin 登录页面。我的问题是我会将我的 skip_before_filter 语句放在这个 gem 中的什么位置？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:48:56.523

您可以将跳过过滤器放在您的应用程序控制器中。这可能在 lib/my_active_admin.rb 中。然后在 ApplicationControllers 定义之前要求 applications_controller 中的“my_active_admin”。

```
module ActiveAdmin
  class ResourceController < BaseController
    before_filter :my_filter

    protected

    def my_filter
      <logic here>
    end
  end
end 
```

# list - 如何创建字典映射字符串到给定列表和元组的集合？

> ID：10853348
> 
> 赞同：1
> 
> 时间：2012-06-01T15:41:02.727
> 
> 标签：list, dictionary, tuples, python

我正在尝试从列表和元组的元组创建字典，如下图所示。我必须将元组反向映射到列表并创建一组非无列名。

非常感谢有关实现解决方案（所需字典）的 pythonic 方式的任何建议。

**MySQL 表“状态日志”：**

```
Name NY   TX   NJ
Amy  1    None 1
Kat  None 1    1
Leo  None None 1 
```

**蟒蛇代码：**

```
## Fetching data from MySQL table
#cursor.execute("select * from statelog")
#mydataset = cursor.fetchall()
## Fetching column names for mapping
#state_cols = [fieldname[0] for fieldname in cursor.description]

state_cols = ['Name', 'NY', 'TX', 'NJ']
mydataset = (('Amy', '1', None, '1'), ('Kat', None, '1', '1'), ('Leo', None, None, '1'))

temp = [zip(state_cols, each) for each in mydataset]

# Looks like I can't do a tuple comprehension for the following snippet : finallist = ((eachone[1], eachone[0]) for each in temp for eachone in each if eachone[1] if eachone[0] == 'Name')
for each in temp:
    for eachone in each:
        if eachone[1]:
            if eachone[0] == 'Name':
                k = eachone[1]
            print k, eachone[0]

print '''How do I get a dictionary in this format'''            
print '''name_state = {"Amy": set(["NY", "NJ"]),
                "Kat": set(["TX", "NJ"]),
                "Leo": set(["NJ"])}''' 
```

**到目前为止的输出：**

```
Amy Name
Amy NY
Amy NJ
Kat Name
Kat TX
Kat NJ
Leo Name
Leo NJ 
```

**所需的字典：**

```
name_state = {"Amy": set(["NY", "NJ"]),
              "Kat": set(["TX", "NJ"]),
              "Leo": set(["NJ"])} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:50:08.653

看起来像[defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)的另一份工作！

所以让我们创建我们的默认字典

```
name_state = collections.defaultdict(set) 
```

我们现在有一个字典，其中包含所有默认值，我们现在可以做这样的事情

```
name_state['Amy'].add('NY') 
```

继续前进，您只需要遍历您的对象并为每个名称添加正确的状态。享受

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:50:41.377

您可以将其作为字典理解（Python 2.7+）：

```
from itertools import compress
name_state = {data[0]: set(compress(state_cols[1:], data[1:])) for data in mydataset} 
```

或作为生成器表达式：

```
name_state = dict((data[0], set(compress(state_cols[1:], data[1:]))) for data in mydataset) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:51:02.007

老实说，我想说你的问题是你的代码变得太麻烦了。抵制“单衬”它的诱惑，创造一个功能。一切都会变得更容易！

```
mydataset = (
        ('Amy', '1', None, '1'),
        ('Kat', None, '1', '1'),
        ('Leo', None, None, '1')
)

def states(cols, data):
    """
    This function receives one of the tuples with data and returns a pair
    where the first element is the name from the tuple, and the second
    element is a set with all matched states. Well, at least *I* think
    it is more readable :)
    """
    name = data[0]
    states = set(state for state, value in zip(cols, data) if value == '1')
    return name, states

pairs = (states(state_cols, data) for data in mydataset)
# Since dicts can receive an iterator which yields pairs where the first one
# will become a key and the second one will become the value, I just pass
# a list with all pairs to the dict constructor.
print dict(pairs) 
```

结果是：

```
{'Amy': set(['NY', 'NJ']), 'Leo': set(['NJ']), 'Kat': set(['NJ', 'TX'])} 
```

# hibernate - 如何将作为函数执行结果的属性添加到数据对象

> ID：10853350
> 
> 赞同：0
> 
> 时间：2012-06-01T15:41:04.007
> 
> 标签：hibernate, jpa, annotations

例如，我在数据库中有一个表和一个获取表 id 并返回一些数字的函数（我使用 Oracle 语法，但我相信 RDMS 在这种情况下并不重要），

```
CREATE TABLE test1( test1_id INT NOT NULL PRIMARY KEY,
val VARCHAR(50));
CREATE FUNCTION getNum (id IN test1.test1_id%type) RETURN NUMBER IS .... 
```

在我的休眠数据对象类中，我想添加一个保存函数执行结果的属性。使用注释的正确方法是什么？

```
@javax.persistence.Table(name = "test1", schema = "test", catalog = "")
@Entity
public class Test1Entity
{
      private int test1Id;
      @Column(name = "test1_id", nullable = false, insertable = true, 
      updatable = true, length = 22, precision = 0)
      @Id
      //get/set
      ...

      // is it possible to use annotations, 
      // so it will call a function to populate this field ?
      private BigDecimal test_num; 
} 
```

我正在考虑创建命名本机查询，例如`SELECT a.test1_id, a.val, getNum(a.test1_id) as test_num FROM test1 a WHERE a.test1_id = :param_test1_id`，但这意味着我不能`Session.get`用于从 DB 读取对象。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T22:31:32.237

用这个：

```
@Formula( "getNum(test1_id)" )
private BigDecimal test_num; 
```

# google-app-engine - 如何在 GAE 中更新数据存储

> ID：10853355
> 
> 赞同：0
> 
> 时间：2012-06-01T15:41:17.537
> 
> 标签：google-app-engine, google-cloud-datastore, python-2.7

这是我存储用户的模型：

```
class User(db.Model):
    username = db.StringProperty(required = True)
    password = db.TextProperty(required = True)
    email = db.TextProperty(required = True) 
```

假设这个用户注册了，我把数据放到数据存储区

```
u = Post(username = joey, password = encrypt(password), email=joey@friends.com)
u.put()
u = Post(username = chandler, password = encrypt(password), email=chandler@friends.com)
u.put()
u = Post(username = ross, password = encrypt(password), email=ross@friends.com)
u.put() 
```

如果用户点击忘记密码或更改密码。如何使用用户名或电子邮件作为密钥获取记录并在那里更新新的加密密码？

我尝试了以下方法：

```
u = User.all().filter('username=', 'joey').fetch(10)
      for r in u: #assuming I get only one record.
        r.password = encrypt(password)
        r.put() 
```

它是数据存储区中的另一条新记录。现在我有**joey**的两条记录。

也尝试过，使用 GqlQuery 获取用户记录并尝试更新记录。它抛出“列表没有定义 put() 方法”的错误

请不要将我链接到文档，这让我很头疼。

TL;DR：如何使用用户定义的数据作为键来更新 GAE 中的数据存储。

编辑：修复代码错字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:58:39.187

您收到错误“列表没有定义 put() 方法”的原因是因为 GqlQuery 返回一个列表。您还应该确保用户名是唯一的。试试下面：

```
users = db.GqlQuery("select * from User where username=:1", username).fetch(1)
    if len(users) == 0:
        err = "not user with name " + username
    else:
        user = users[0]
        # change password for user
        ... 
```

# javascript - 如何使用 jQuery 的标签 for 属性中的子字符串获取标签元素的值？

> ID：10853360
> 
> 赞同：3
> 
> 时间：2012-06-01T15:41:35.793
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery（或 javascript）获取标签元素的值。我唯一的搜索词是标签元素的 for 属性的子字符串。在下面显示的示例代码中，这将是“Okuku”。

```
<label class="required" for="Nigeria-Osun-Okuku">The Township of Okuku</label> 
```

剧本：

```
$("label[for='Nigeria-Osun-Okuku']").text(); 
```

会回来

> 奥久乡

但我没有完整的 'for' 值： Nigeria-Osun-Okuku**但它的最后一个子字符串： 'Okuku'**。

如何编写脚本来搜索、匹配和***返回：Okuku 乡***？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:43:30.533

您可以使用[`attribute-contains`](http://api.jquery.com/attribute-contains-selector/)选择器：

```
$("label[for*='Okuku']").text(); 
```

请注意，这将获取与该子字符串匹配的所有元素。

演示：http: [//jsfiddle.net/sYdN4/](http://jsfiddle.net/sYdN4/)

如果您*确定*在值的末尾找到此子字符串，则可以使用 ends-with 选择器：

```
$("label[for$='Okuku']").text(); 
```

这将返回其`for`属性*以子字符串结尾*的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:44:10.393

使用属性包含选择器[*=](http://api.jquery.com/attribute-contains-selector/)

```
$("label[for*='Okuku']").text(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:44:50.753

根据线路

**但它的最后一个子字符串：'Okuku'**

```
$("label[for$='Okuku']").text(); 
```

**[示例锻炼](http://jsfiddle.net/thecodeparadox/QStkd/100/)**

阅读[**$=**](http://api.jquery.com/attribute-ends-with-selector/)选择器。

# wordpress - 将 WordPress 博客集成到 MVC3 网站中

> ID：10853362
> 
> 赞同：0
> 
> 时间：2012-06-01T15:41:39.887
> 
> 标签：wordpress, blogs

我有一个用 MVC3 构建的网站。

我想集成一个 wordpress 博客，这样用户仍然可以使用它进入博客，但会显示在 MVC 网站上。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:43:47.027

如果您将 WP`/blog`放在您的 Web 根目录中的文件夹中，则 WP 应该可以正常且独立地运行。只需确保您的服务器配置为不将实际文件和目录重写到您的框架，这是大多数时间的默认设置。

# objective-c - 使用自定义对象对 NSArray 进行排序

> ID：10853363
> 
> 赞同：8
> 
> 时间：2012-06-01T15:41:44.093
> 
> 标签：objective-c, ios, sorting, nssortdescriptor

在我的 Xcode 项目中，我有以下类：

**地址**

```
@interface LDAddress : NSObject{
    NSString *street;
    NSString *zip;
    NSString *city;
    float latitude;
    float longitude;
}

@property (nonatomic, retain) NSString *street;
@property (nonatomic, retain) NSString *zip;
@property (nonatomic, retain) NSString *city;
@property (readwrite, assign, nonatomic) float latitude;
@property (readwrite, assign, nonatomic) float longitude;

@end 
```

**地点**

```
@interface LDLocation : NSObject{
    int locationId;
    NSString *name;
    LDAddress *address;
}
@property (readwrite, assign, nonatomic) int locationId;
@property (nonatomic, retain) LDAddress *address;
@property (nonatomic, retain) NSString *name;

@end 
```

在 UITableViewController 的一个子类中，有一个 NSArray 包含很多未排序的 LDLocations 对象。现在，我想根据LDAddress的属性*城市对 NSArray 的对象进行升序排序。*

如何使用 NSSortDescriptor 对数组进行排序？我尝试了以下操作，但是在对数组进行排序时应用程序会转储。

```
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"Address.city" ascending:YES];
[_locations sortedArrayUsingDescriptors:@[sortDescriptor]]; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-01T15:47:02.470

尝试将第一个键设为小写。

```
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"address.city" ascending:YES]; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-01T15:49:26.243

您还可以使用块对数组进行排序：

```
 NSArray *sortedLocations = [_locations sortedArrayUsingComparator: ^(LDAddress *a1, LDAddress *a2) {
        return [a1.city compare:a2.city];
    }]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-01T10:28:01.977

这将允许使用多种类型进行排序。就像我们需要根据时间对电影进行排序，如果时间相等，则需要按名称排序。

```
NSArray *sortedArray = [childrenArray sortedArrayUsingComparator:^NSComparisonResult(id a, id b) {
        NSNumber *first = [NSNumber numberWithLong:[(Movie*)a timeInMillis]];
        NSNumber *second = [NSNumber numberWithLong:[(Movie*)b timeInMillis]];
        NSComparisonResult result =  [first compare:second];
        if(result == NSOrderedSame){
            result = [((NSString*)[(Movie*)a name] ) compare:((NSString*)[(Movie*)b name])];
        }
        return  result;
    }]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-18T06:54:54.177

```
-(NSArray*)sortedWidgetList:(NSArray*)widgetList
{
    NSSortDescriptor *firstDescriptor = [[NSSortDescriptor alloc] initWithKey:@"itemNum" ascending:YES];

    NSArray *sortDescriptors = [NSArray arrayWithObjects:firstDescriptor, nil];

    NSArray *sortedArray = [widgetList sortedArrayUsingDescriptors:sortDescriptors];

    return sortedArray;
} 
```

# objective-c - stringByReplacingOccurrence 不替换字符串

> ID：10853364
> 
> 赞同：2
> 
> 时间：2012-06-01T15:41:45.057
> 
> 标签：objective-c, ios, parsing, nsfilemanager

我需要在我的应用程序中解析 FILE URL，并将 %20 替换为 SPACE。我正在使用 stringByReplacingOccurance：

```
NSString *strippedContent = [finalFilePath stringByReplacingOccurrencesOfString:@"%20" withString:@" "]; 
```

但是当我在 NSLog 中显示 strippedContent 时，所有 %20 字符串仍然存在。这是我希望解析的文件名示例：

```
.../Documents/Inbox/Test%20Doc%20From%20Another%20App.txt 
```

当 NSFileManager 中包含 %20 时，似乎找不到该文档。文件路径正在通过“打开方式...”对话框从另一个应用程序传递。有什么方法可以使用 stringByReplacingOccurrence 或在导入 URL 时删除 %20？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T15:49:43.630

`NSString`提供了一种执行您需要的转换的方法：

```
NSString *strippedContent = [finalFilePath stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:53:12.033

是的，您应该使用：

```
NSString * strippedContent = [finalFilePath stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

# drupal - 术语中具有特殊字符的 Drupal 分类法

> ID：10853369
> 
> 赞同：2
> 
> 时间：2012-06-01T15:42:19.513
> 
> 标签：drupal, taxonomy, drupal-taxonomy

我将数据从外部源同步到我的 Drupal 安装。当我向新创建的节点添加分类术语关系时遇到问题。

我正在同步汽车，如果制造商名称（代码中的 $name）不在词汇表中，它将被添加到其中。如果它已经存在，则将 tid 附加到节点。

这与法拉利或大众汽车等术语完美搭配。但是还有梅赛德斯-奔驰。由于某种原因，EntityFieldQuery 似乎无法从词汇表中找到它，因为此代码在循环运行时会一遍又一遍地创建梅赛德斯-奔驰术语。

我想问题是单词之间的破折号。我希望看到 EntityFieldQuery 后面的 SQL 子句，但是当我运行它时，我没有设置完整的 drupal，因此没有加载像 Devel 这样的模块。而且我不知道如何检查SQL。

我非常感谢有关如何调试或如何解决此问题的建议。每个链接都表示赞赏。

这是我的代码：

```
$query = new EntityFieldQuery();
$result = $query
    ->entityCondition('entity_type', 'taxonomy_term')
    ->propertyCondition('name', $name) // $name = manufacturer, like "Ferrari"
    ->propertyCondition('vid', 2)
    ->execute();

if(!empty($result))
{
    $tmp = array_pop($result['taxonomy_term']);
    $node->field_brand[LANGUAGE_NONE][0]['tid'] = $tmp->tid;
}
else
{
    $term = new stdClass();
    $term->vid = 2;
    $term->name = $name
    taxonomy_term_save($term);
    $node->field_brand[LANGUAGE_NONE][0]['tid'] = $term->tid;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T09:38:09.127

有一种方法可以对 taxonomy_get_term_by_name() 做同样的事情，但我想这不是首选方式，并且所解释的解决方案应该适合这个。

我认为我们在这里看到了 Drupal 错误。但是对于其他尝试这样做的人，这是解决方案：

```
$test = taxonomy_get_term_by_name($name);
// It should be full of unique names, so no need to go through all of them
if(!empty($test))
{
    $tmp = array_pop($test);
    $node->field_brand[LANGUAGE_NONE][0]['tid'] = $tmp->tid;
}
else
{
    $term = new stdClass();
    $term->vid = 2;
    $term->name = $name;
    taxonomy_term_save($term);
    $node->field_brand[LANGUAGE_NONE][0]['tid'] = $term->tid;
} 
```

# c - 使用 fgets 随机读取非常大的文件似乎使 Windows 缓存达到了极限

> ID：10853371
> 
> 赞同：1
> 
> 时间：2012-06-01T15:42:28.810
> 
> 标签：c, windows, caching, 64-bit, large-files

我已经为 Windows 7 - 64bit 编写了一个 C/C++ 程序，它适用于非常大的文件。在最后一步中，它从输入文件 (10GB+) 中读取行并将它们写入输出文件。对输入文件的访问是随机的，写入是顺序的。编辑：这种方法的主要原因是减少 RAM 的使用。

我在阅读部分基本上是这样的：（对不起，很短，可能有问题）

```
void seekAndGetLine(char* line, size_t lineSize, off64_t pos, FILE* filePointer){
  fseeko64(filePointer, pos, ios_base::beg);
  fgets(line, lineSize, filePointer);
} 
```

通常这段代码很好，不是说很快，但在一些非常特殊的情况下它会变得很慢。该行为似乎不是确定性的，因为性能下降发生在文件其他部分的不同机器上，甚至根本没有发生。甚至到目前为止，程序完全停止读取，而没有磁盘操作。

另一个症状似乎是使用过的 RAM。我的进程保持它的 RAM 稳定，但系统使用的 RAM 有时会变得非常大。在使用了一些 RAM 工具后，我发现 Windows 映射文件会增长到几 GB。这种行为似乎也取决于硬件，因为它发生在进程不同部分的不同机器上。

据我所知，SSD上不存在这个问题，所以它肯定与HDD的响应时间有关。

我的猜测是 Windows 缓存变得“奇怪”。只要缓存起作用，程序就会很快。但是当缓存出错时，行为要么进入“停止读取”，要么进入“增加缓存大小”，有时甚至两者兼而有之。由于我不是 Windows 缓存算法的专家，我很乐意听到解释。此外，有什么方法可以让 Windows 脱离 C/C++ 来操作/停止/强制缓存。

由于我现在正在寻找这个问题一段时间，我已经尝试了一些技巧，但没有成功：

*   文件指针 = fopen（文件名，“rbR”）；//只是填充缓存直到RAM已满
*   读/写的大量缓冲，以阻止两者相互进入

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:56:30.007

对于任何缓存算法来说，真正随机访问一个巨大的文件是最坏的情况。最好尽可能多地关闭缓存*。*

有多个级别的缓存：

*   CRT 库（因为您使用的是 f 函数）
*   操作系统和文件系统
*   可能在驱动器本身上

如果您通过 CRT 中的 f 函数将您的 I/O 调用替换为 Windows API 中的类似函数（例如，CreateFile、ReadFile 等），您可以消除 CRT 缓存，这可能弊大于利。您还可以警告操作系统您将进行随机访问，这会影响其缓存策略。请参阅类似[`FILE_FLAG_RANDOM_ACCESS`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)和可能的选项[`FILE_FLAG_NO_BUFFERING`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)。

您需要进行实验和测量。

您可能还必须重新考虑您的算法是如何工作的。搜索真的是随机的吗？您能否重新排序它们，也许是分批，以便它们有序？您可以一次限制对文件相对较小区域的访问吗？你能把大文件分解成更小的文件，然后一次处理一个吗？您是否检查过驱动器和特定文件的碎片级别？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T17:38:23.550

根据您的应用程序的整体情况，您可能会采取不同的方法 - 可能是这样的：

1.  决定您需要输入文件中的哪些行并将行号存储在列表中
2.  对行号列表进行排序
3.  按顺序读取输入文件一次，然后取出您需要的行（更好的是，寻找下一行并抓住它，特别是当有很大的差距时）
4.  如果您抓取的行列表足够小，您可以将它们存储在内存中以便在输出之前重新排序，否则，将它们粘贴在一个较小的临时文件中，并使用该文件作为当前算法的输入，以重新排序最终输出的行

这绝对是一种更复杂的方法，但它对您的缓存子系统会更友好，因此可能会表现得更好。

# java - 取edittext的值并在其中输入小数点

> ID：10853374
> 
> 赞同：0
> 
> 时间：2012-06-01T15:42:43.367
> 
> 标签：java, android

所有-我正在开发一个应用程序，用户可以在其中输入账单费用小费率。我知道如何获取 edittext 字段的值并对它们进行必要的数学运算，但是在小费率字段中，我必须在输入的数字前添加一个小数点。因此，如果用户输入“2”，它会在 java 代码中显示为“.2”。有没有办法做到这一点？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:47:46.687

简单的 -

如果您想要字符之间的点，只需将其除以 10^（长度）。因此，如果输入的字符串是 2，则除以 10。如果是 22，则除以 100。

其他选择是 -

```
 String value = editText.getText().toString();
if(!value.contains(".")) //Better if you check the value doesn't already have a decimal
    value = "."+value; //This is the string with . in the front
    float tip = Float.parseFloat(value); //Use it for calculations. 
```

# jquery - 在 jsTree 中添加 rel 标记/禁用链接

> ID：10853378
> 
> 赞同：1
> 
> 时间：2012-06-01T15:42:48.990
> 
> 标签：jquery, jstree

我正在尝试将 rel 标记添加到所有 jsTree 为空的 rel 标记。我已经设法让它在 jsFiddle 中工作，但是当尝试将相同的代码应用于整个树时，它不起作用（也就是说，rel 标签仍然是空白/空的）。我从我的树中抓取了生成的源代码作为这个例子，这就是为什么我对代码不起作用感到困惑。

这是工作的 jsFiddle 版本：[在此处查看](http://jsfiddle.net/FL9XG/)。

另外，如果 rel='disabled'，是否有可能删除或禁用 a href 以禁用链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T16:23:19.270

对于那些好奇的人，我做了几件事——

1.  我在数据库中将所有链接更新为我想要禁用的特定类型（即文件夹）。空白的 rel 标签也有效。如果您无法访问数据库，我还尝试了以下适用于 .bind("before.jstree") 的代码：

    ```
    $('li[rel=""]').attr('rel','disabled'); 
    ```

2.  我对 jsTree 实例应用了绑定。以下代码是我使用的，

    ```
    .bind("before.jstree", function (e, data) {
     $('ul li[rel="file"] > a').each(function() {
      $(this).contents().unwrap();
     });
    }) 
    ```

这将展开具有 rel="file" 的链接（满足[使节点不可点击的需要](https://stackoverflow.com/questions/10844160/making-node-types-unclickable-in-jstree)。您可以将 rel 标记设置为您想要展开的任何其他内容。

编辑：我也让它变得更简单，只需禁用单击和双击，如下所示：

```
 .bind("before.jstree", function (e, data) {
    $('ul li[rel="file"] > a').each(function() {
      $(this).click(false);
      $(this).dblclick(false);
     });
    }) 
```

我希望这有帮助！

# ios - 如何实现像“选择 Wi-Fi 网络”警报这样的弹出窗口

> ID：10853383
> 
> 赞同：0
> 
> 时间：2012-06-01T15:43:07.500
> 
> 标签：ios, user-interface, popup, overlay, uialertview

在 iOS 中，会不时显示一个弹出窗口，要求用户加入 Wi-Fi 网络。

![选择 Wi-Fi 网络](../Images/7e51baff5469d5f384a3d377a4f452be.png)

我想用自定义内容实现一个类似的弹出窗口

*   标题
*   TableView 具有不同数量的条目（如果太多，则带有滚动条）
*   取消按钮
*   弹出现有视图（弹出窗口小于视图）

*   怎样才能达到这样的效果？我想 UIAlertView 可能是一个很好的起点。但是，UIAlertView 不支持子类化

    > UIAlertView 类旨在按原样使用，不支持子类化。此类的视图层次结构是私有的，不得修改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:44:36.617

不与系统 UIAlertView。您必须编写自己的代码，或使用开源组件。

这可能是一个起点/示例：[BlockAlertsAnd-ActionSheets](https://github.com/gpambrozio/BlockAlertsAnd-ActionSheets)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:45:59.540

看看这个，这正是你需要的东西：[github 示例项目](https://github.com/blommegard/SBTableAlert)

# android - 如何在 Intellij Idea 10.5 中创建 Google API 项目？

> ID：10853384
> 
> 赞同：2
> 
> 时间：2012-06-01T15:43:13.183
> 
> 标签：android, intellij-idea, arduino

您好，感谢您的关注！

## 背景

我正在尝试遵循这个[Android ADK (w/Arduino) 教程](http://allaboutee.com/2011/12/31/arduino-adk-board-blink-an-led-with-your-phone-code-and-explanation/)。

我使用 Intellij Idea 10.5 作为 IDE（不是 Eclipse）。

之前在Idea中设置了Android依赖，新建一个Android项目没有问题；但是，根据[上述教程](http://allaboutee.com/2011/12/31/arduino-adk-board-blink-an-led-with-your-phone-code-and-explanation/)，我似乎需要使用 Google API SDK 而不是 Android SDK 来创建项目。

[这是 Android Open Accessory Page 的链接](http://developer.android.com/guide/topics/usb/adk.html)。

## 问题

如何使用 Google API 设置 Idea，以便创建这种类型的新项目？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T02:07:27.310

When you create new Android SDK in IDEA, it allows to select **Google APIs** SDK if it's present. If you don't have it, run `SDK Manager` and install it. Basically, there are 2 versions of SDK for most platforms, standard and with Google APIs.

![Create New Android SDK](../Images/d8f1851136647849b35b2026faef8ed4.png)

# sql - 如何获取多个相关列之一

> ID：10853391
> 
> 赞同：0
> 
> 时间：2012-06-01T15:43:42.257
> 
> 标签：sql

我有一个注释表，其中存储有关客户、工作和产品表的注释。
客户、工作和产品表具有“名称”和“ID”(GUID) 列。
我想在一个查询中获取注释及其相关对象名称。（如果我的注释与客户相关，则相关对象名称将为`customername`，依此类推。）

是否可以通过单个查询来做到这一点？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T08:44:07.793

```
select
    notes.id,
    notes.content as content,
    coalesce(customers.name, jobs.name, products.name) as name,
    customers.id as customer_id,
    jobs.id as job_id,
    products.id as product_id
from notes
    left outer join customers on notes.relatedobjid = customers.id
    left outer join jobs      on notes.relatedobjid = jobs.id
    left outer join products  on notes.relatedobjid = products.id
; 
```

用 DAO / 显示代码中的一些逻辑包装它（python，因为它相当容易阅读）：

```
for row in query.list():
    if row["customer_id"] is not None:
        display_type = "customer name"
    elif row["job_id"] is not None:
        display_type = "job name"
    elif row["product_id"] is not None:
        display_type = "product name"
    display_note(display_type, row["name"], row["content"]) 
```

额外的列和显示逻辑可能是必要的，也可能不是必要的，这取决于您对“客户名称”这个想法的依附程度。我个人可能会保留它。如果你有一个，我认为你可能会将很多这种逻辑改组到你的对象关系映射中。这可能是也可能不是一个热门的想法，具体取决于您在笔记表中有多少行。

# xcode4 - 选择文件夹引用的目的地

> ID：10853397
> 
> 赞同：0
> 
> 时间：2012-06-01T15:44:05.470
> 
> 标签：xcode4

我认为这应该是一个关于 Xcode 4 的简单问题，我有一个特定的文件夹引用，我想自定义它被复制到包的位置，我该如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:41:07.900

将 Copy Files 构建阶段添加到目标。将您的文件夹添加到构建阶段。

要在 Xcode 4 中添加 Copy Files 构建阶段，请从项目导航器中选择项目以打开项目编辑器。从编辑器的左侧选择您的目标。单击编辑器顶部的 Build Phases 构建。单击编辑器底部的 Add Build Phase 按钮​​，然后选择 Add Copy Files。

# c# - GetWindowText() 抛出错误并且未被 try/catch 捕获

> ID：10853398
> 
> 赞同：4
> 
> 时间：2012-06-01T15:44:08.237
> 
> 标签：c#, exception-handling, try-catch, user32

当我为 GetWindowText 运行下面的代码时，我收到以下错误作为内部异常抛出：

{“试图读取或写入受保护的内存。这通常表明其他内存已损坏。”}

```
 [DllImport("user32.dll", EntryPoint = "GetWindowTextLength", SetLastError = true)]
    internal static extern int GetWindowTextLength(IntPtr hwnd);

    [DllImport("user32.dll", EntryPoint = "GetWindowText", SetLastError = true)]
    internal static extern int GetWindowText(IntPtr hwnd, ref StringBuilder wndTxt, int MaxCount);

try{
      int strLength = NativeMethods.GetWindowTextLength(wndHandle);
      var wndStr = new StringBuilder(strLength);
      GetWindowText(wndHandle, ref wndStr, wndStr.Capacity);
   }
    catch(Exception e){ LogError(e) } 
```

我有两个问题：

1.  为什么错误没有被 try catch 捕获？

2.  知道如何在程序遇到此类错误时阻止程序崩溃，而不是使用 try/catch

干杯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T16:02:59.073

1.

有一些异常是无法捕获的。一种类型是 StackOverflow 或 OutOfMemory，因为实际上没有内存可以分配给处理程序运行。另一种类型是通过 Windows 操作系统交付给 CLR。这种机制称为结构化异常处理。这类异常可能非常糟糕，因为 CLR 无法确定其自身的内部状态是否一致，有时称为损坏状态异常。在 .Net 4 中，托管代码默认不处理这些异常。

上述消息来自 AccessViolationException，这是一种损坏状态异常。发生这种情况是因为您正在调用一个写入缓冲区末尾的非托管方法。请参阅[这篇](http://msdn.microsoft.com/en-us/magazine/dd419661.aspx)关于可能处理这些异常的文章。

2.

[这里](http://www.pinvoke.net/default.aspx/user32.getwindowtext)的示例代码有效吗？您需要确保非托管代码不会写入超过`StringBuilder`' 缓冲区的末尾。

```
public static string GetText(IntPtr hWnd)
{
    // Allocate correct string length first
    int length       = GetWindowTextLength(hWnd);
    StringBuilder sb = new StringBuilder(length + 1);
    GetWindowText(hWnd, sb, sb.Capacity);
    return sb.ToString();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:58:49.733

由于您提供给 GetWindowText 的参数，调用这些外部方法可能会导致问题。我认为您应该尝试以下方法：

```
try{
    int strLength = NativeMethods.GetWindowTextLength(wndHandle);
    var wndStr = new StringBuilder(strLength + 1);
    GetWindowText(wndHandle, wndStr, wndStr.Capacity);
   }
catch(Exception e){ LogError(e) } 
```

# windows-phone-7 - 如何在 WP7 中暂停和恢复视频录制

> ID：10853405
> 
> 赞同：0
> 
> 时间：2012-06-01T15:44:28.440
> 
> 标签：windows-phone-7

我是 WP7 编程的新手，

[http://msdn.microsoft.com/en-us/library/hh394041(v=vs.92).aspx](http://msdn.microsoft.com/en-us/library/hh394041(v=vs.92).aspx)

这对我来说很好，但我正在寻找暂停和恢复功能......

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:12:49.793

从您发布的链接：

```
// Pause video playback.
private void PausePlayback_Click(object sender, EventArgs e)
{
    // Avoid duplicate taps.
    PausePlayback.IsEnabled = false;

    // If mediaElement exists, pause playback.
    if (VideoPlayer != null)
    {
        VideoPlayer.Pause();
    }

    // Set the button state and the message.
    UpdateUI(ButtonState.Paused, "Playback paused.");
} 
```

# mysql - 兰德在高桌

> ID：10853406
> 
> 赞同：2
> 
> 时间：2012-06-01T15:44:32.740
> 
> 标签：mysql, sql

想象一个具有非常高行数（例如 3 亿行）的 sql 表。

每行都有一个文本字段，我想随机检索 10 行。

问题是使用

```
select key from the_table where enabled=1 order by rand() limit 10 
```

计算 rand 值并按该值对所有行进行排序是非常高的负载。

有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:50:54.417

我会测试（时间）可能的解决方案，以验证它们确实像您怀疑的那样慢。

如果您的主键是顺序的或可预测的，也许您可​​以从代码中或作为过程的一部分生成 10 个随机键，然后`SELECT`按键生成 10 条记录。

例如，如果您的键是连续的数字 ID，那么您将在and和使用`RAND`之间生成 10 个数字`Min(ID)``Max(ID)``WHERE Id in (rand1, rand2, rand3 ...)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:49:23.620

如果您可以在 SQL 之外生成密钥（即使需要使用 15-20 来获得启用的 10 个），那么您可以跳过 order() 这几乎可以肯定是要加载的问题

SELECT 键 WHERE 键 [x,y,z....]

其中 x,y,z 是在外部随机生成的。

更好的是，您可以创建一个已启用键的表，随机排序并以 10 个为一组进行翻页。您需要偶尔更新它，并且会在空间上有所损失，但这可能没什么大不了的。

有更复杂的解决方案，但这会让你感动。

# .net - 为什么 winform 不会在运行时更新其宽度和高度？

> ID：10853411
> 
> 赞同：1
> 
> 时间：2012-06-01T15:44:52.530
> 
> 标签：.net, winforms, drawing, runtime, delphi-prism

我不太确定如何准确地表达这个问题，但是在我解释了问题所在之后你就会明白了。

我有一个 winform，我可以在上面绘制矩形、椭圆形、线条等形状，就像下面的 winform 一样。之后，我将这些形状保存到二进制文件中。

![在此处输入图像描述](../Images/52a9dc08db6932c1ddfc6b591500ba30.png)

但是，如果您注意到当我的程序启动并打开保存的形状时，出于某种奇怪的原因，winform 会保持其设计时宽度和高度以显示形状看起来被切掉的形状，即使 winform 有大量的油漆区域以完全绘制所有形状。

此外，如果我重新加载 winform，它会使用当前的宽度和高度来绘制形状。因此，winform 看起来也像我所期望的那样，如下所示。

![在此处输入图像描述](../Images/623bf9de099cdb869becd4a9453502a0.png)

我错过了什么或需要做什么？因此，winform 将在运行时始终更新为其当前的宽度和高度。

**更新：**

这是绘制矩形的代码。矩形是我的程序设计中的一个类的对象。因此，每个对象都有自己的绘制方法。因此，在绘制事件中，列表中的所有对象都调用 draw 方法，如下所示。

```
method ViewFrmpas.ViewFrmpas_Paint(sender: System.Object; e: System.Windows.Forms.PaintEventArgs);
begin
     myObjects.Draw;
end; 
```

这是我在winform上绘制矩形的实际绘制方法。

```
method TMakerRect.Draw;
var
  outpoints:Array of point;
  inpoints:Array of point;
  r,fr:Rectangle;
  midx,midy:integer;
  theBrush1:HatchBrush;
  theBrush2:SolidBrush;
begin
  r := bounds;
  fr := bounds;

  if (theBrushStyle = HatchStyle.Wave) then
     theBrush1 := new HatchBrush(theBrushStyle,Color.Transparent,color.Transparent)
  else if (theBrushStyle = HatchStyle.ZigZag) then
     thebrush2 := new SolidBrush(FillColor)
  else
     theBrush1 := new HatchBrush(theBrushStyle,FillColor,color.Transparent);

  if (thePen.DashStyle = DashStyle.Custom) then
    thepen.Color := Color.Transparent;

  outpoints := new point[5];
  inpoints := new point[4];
  with r do
  begin
    midx := ((right - left) div 2) + left;
    midy := ((bottom - top) div 2) + top;
    inpoints[0].x := left; inpoints[0].y := top;
    inpoints[1].x := right; inpoints[1].y := top;
    inpoints[2].x := right; inpoints[2].y := bottom;
    inpoints[3].x := left; inpoints[3].y := bottom;
  end;

  if Active then
  begin
    Fill(var fr);
    with fr do
    begin
      outpoints[0].x := r.Left; outpoints[0].y := r.Top;
      outpoints[1].x := left; outpoints[1].y := top;
      outpoints[2].x := right; outpoints[2].y := top;
      outpoints[3].x := right; outpoints[3].y := bottom;
      outpoints[4].x := left; outpoints[4].y := bottom;
    end;

    Scale(var inpoints,4,midx,midy);
    Rotate( var inpoints,4,midx,midy);
    Translate(var inpoints,4);

    Scale(var outpoints,5,midx,midy);
    Rotate( var outpoints,5,midx,midy);
    Translate(var outpoints,5);

    if Visible then
    begin    
        if theBrushStyle = HatchStyle.ZigZag then
            g.FillPolygon(theBrush2,inpoints)
        else 
            g.FillPolygon(thebrush1,inpoints);

      g.DrawPolygon(thepen,outpoints);
    end;
  end
  else
  begin
      outpoints[0].x := r.Left; outpoints[0].y := r.Top;
      outpoints[1].x := r.left; outpoints[1].y := r.top;
      outpoints[2].x := r.right; outpoints[2].y := r.top;
      outpoints[3].x := r.right; outpoints[3].y := r.bottom;
      outpoints[4].x := r.left; outpoints[4].y := r.bottom;

    if theBrushStyle = HatchStyle.ZigZag then
        g.FillPolygon(thebrush2,inpoints)
    else
        g.FillPolygon(theBrush1,inpoints);

    g.DrawPolygon(thepen,outpoints);
  end;
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T13:06:26.633

```
 g.FillPolygon(theBrush2,inpoints) 
```

`g`变量从天而降，不知从何而来。但是从结果来看，你可能犯了过早初始化它的错误，可能是使用了 CreateGraphics()。这不能正常工作，Graphics 对象将从窗口的设备上下文中初始化，该上下文表示您创建窗口时的窗口大小。调整窗口大小不能再更改 Graphics.ClipBounds。

您必须使用在 Paint 事件处理程序中传递的 e.Graphics 对象。只需将它作为参数传递给 Draw()。不仅要确保剪辑边界正确，使双缓冲正常工作也非常重要。

# python - 可以告诉 pexpect 忽略模式或信号吗？

> ID：10853412
> 
> 赞同：1
> 
> 时间：2012-06-01T15:44:52.887
> 
> 标签：python, regex, pexpect

我正在尝试编写一个 python 脚本来访问多个 Cisco 网络设备。遗憾的是，这些设备的设置不一样，有些设备的横幅出现在奇怪的地方。这些横幅可能具有与提示可能具有的某些相同内容的模式。

例如，一旦我登录，我希望得到一个提示`'hostname#'`，所以我基本上使用 a`pexpect('#')` 我可能必须处理某些其他提示，例如`'hostname>'`as well so `pexpect('>')`works。我真的会有一个可能的提示列表，加上一个超时并采取相应的行动。

这很好，除非横幅出现在中间某处。例如，登录后可能会出现一个横幅，上面写着 `## Welcome ##`并且在提示之前就在那里。我相信如果我可以告诉 pexpect 忽略正则表达式`#.*\r`我会很好，但我不确定这是可能的。是否可以让 pexpect 忽略一个字符串，或者有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:24:56.257

[我在BBS 时代](https://en.wikipedia.org/wiki/Bulletin_board_system)使用的一个解决方案是查找提示，然后在我收到提示后立即查找换行符或超时一两秒的空格。如果第二次等待超时，那意味着我*真的*在等待提示。由于`pexpect`使用正则表达式，您实际上可以检查是否在提示后一秒钟内收到*任何字符。*

```
def wait_for_prompt(session, prompt, timeout=1):
    gotprompt = 0
    while not gotprompt:
        session.expect(prompt, timeout=None)
        gotprompt = session.expect([".", pexpect.TIMEOUT], timeout=timeout)

child = pexpect.spawn("ssh ...")
wait_for_prompt(child, "[#>] ?") 
```

我以前从未真正使用过这个库，所以这可能需要一些调整，但这是我在 80 年代成功使用的一种方法。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T17:15:53.757

Python pexpect 模块等待*匹配*的输入。您实际上不能忽略输入，除非创建不匹配模棱两可或不需要的输入的正则表达式。但是，pexpect 也可以处理[正则表达式列表，而不是创建一个非常复杂的正则表达式](http://www.noah.org/wiki/pexpect#Lists_if_patterns)。然后锚定这些正则表达式以减少歧义。

例如，您可以通过将匹配锚定到行的开头或结尾并尽可能精确地区分命令提示符和横幅：

```
users = ['fred', 'ginger']
user_prompt = '^(?:%s)@.*?\$ $' % '|'.join(users)
child.expect (['hostname# $', 'hostname> $', user_prompt]) 
```

他们的关键是了解你想要匹配的输入，用锚构建一个明确的正则表达式，然后在你发现不匹配时更新你的表达式——希望不会太频繁，因为你没有创建过度贪婪的模式首先。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:10:43.673

一旦 expect 找到了匹配项，它就会在流程实例上设置 'before'、'after' 和 'match' 属性。您可以使用这些来编写一些逻辑。

或者，您可以制作一个更好的正则表达式，只匹配您想要的提示。甚至 r'>$|#$' 也可能会做你想做的事，因为它只会匹配行尾的那些字符。

# ios - 在 UITableViewController 中禁用自动滚动

> ID：10853414
> 
> 赞同：0
> 
> 时间：2012-06-01T15:44:54.027
> 
> 标签：ios, cocoa-touch, uitableview

我正在使用 UITableViewController 和集成在单元格中的 UITextField 作为附件视图。问题是如果用户尝试编辑 Cell（带有 UITextField），它会在 TableView 内自动滚动到可见区域。如何禁用此行为？

我试过用

`self.tableView.scrollEnabled = NO;`

但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:31:40.303

我会这样做的方式（刚刚经过粗略测试）：

创建一个`CGPoint`实例变量来保存 contentOffset。

在`textFieldShouldBeginEditing:`或`textFieldDidBeginEditing:`将`CGPoint`实例变量设置为`UITableView`的 contentOffset。

`scrollViewDidScroll:`检查用户是否在拖动。如果是，则将`UITableView`'s contentOffset 设置为`CGPoint`实例变量。

# asp.net-mvc-3 - 循环 RenderPartials 和在 Partial 中循环之间是否存在性能差异？

> ID：10853415
> 
> 赞同：0
> 
> 时间：2012-06-01T15:45:01.547
> 
> 标签：asp.net-mvc-3, razor

**其中哪一项表现更好：**

> 在父页面上：
> 
> ```
> foreach(var m in model)
> {
>    @Html.RenderPartial("PartialPage", m);
> } 
> ```
> 
> 在部分：
> 
> ```
> <h2>@m.thang</h2> 
> ```

**或者**

> 在父页面上：
> 
> ```
> @Html.RenderPartial("PartialPage", model); 
> ```
> 
> 在部分：
> 
> ```
> foreach(var m in model)
> {
>  <h2>@m.thang</h2>
> } 
> ```

出于某种我不知道的原因，我的直觉告诉我第二个版本会更好，但我没有这个依据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:52:22.547

第一个会慢一点，因为您有定位局部视图的开销。我认为差异不会很明显。

组织你的视图时要考虑到维护和重用——你更有可能为单个项目或多个项目重用视图？

此外，使用显示/编辑器[模板](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html)，如果您有单个项目的模板，您仍然可以渲染集合，MVC 将为每个模型调用您的模板。无需手动循环。

# php - 如何使硬编码的 HTML 条目像在 CMS 的 UI 中输入一样保存？

> ID：10853421
> 
> 赞同：1
> 
> 时间：2012-06-01T15:45:25.670
> 
> 标签：php, javascript, language-agnostic, scanf, content-management-system

我怀疑我是否使用了正确的词汇（或标签）来解释我在寻找什么，但请耐心等待：

最终，我的页面的一部分将有一个部分，其中列表项和表格数据（`<td>`）可以由登录用户输入/更改。假设这是其中之一`<li>`：

```
<!--template-->
<li><a title=""href=""><span></span></a></li> 
```

到目前为止，我的理解是，如果这些条目是由某个地方的 UI（à la Wordpress）生成的，则这些条目需要（？）在成为生成的页面之前写入数据库。我意识到的另一件事是这些 CMS 的用户不会自动“获取”生成页面的副本作为源代码。

我想知道的是，我是否可以在记事本中对生成的记录/列表进行 HTML 更改（我可能会弄乱页面的其他部分）并以某种方式让站点检测/记录是否有任何更改，就好像它们是通过 UI 输入的一样？

*   让 PHP 代码创建生成页面的文件
*   扫描该页面以查找某些模式/模板
*   将在模板中找到的值添加到数据库中，重复

什么语言/方法可以扫描文本并根据其发现创建数据库条目，就像我描述的那样？我刚刚发现`sscanf()`，但还不知道如何使用它。我意识到不仅使用 CMS 是愚蠢的，而且它的自我引用和文本扫描质量也让我感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T20:36:33.440

在我看来，您可以使用 php 脚本处理程序实现 jQuery“就地编辑”插件。我正是这样做的，他们的插件完成了所有繁重的工作，您所要做的就是提供原始 HTML 以及有关表格结构的各种线索。

[看到这个 SO q/a](https://stackoverflow.com/questions/708801/whats-the-best-edit-in-place-plugin-for-jquery) ...我用它来生成显示订单的页面。通过就地编辑，我可以下订单（点击编辑）。在代码中，将所有内容放在一个 foreach 循环中，然后 jQuery 通过属性将元素链接到数据库，例如`<tr id="<? echo $database_ID ?>">`将行与记录联系起来，每个元素都`<td>`可能将数据库的列名作为 ID 或类名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T05:19:33.173

让我先说这个答案几乎可以肯定是一个坏主意，只与 PHP 无关，并且产生的问题至少与它解决的问题一样多。特别是安全漏洞非常可怕。但最近我在一个政府网站上看到了一个 HTML 表单，它重新激发了我对“横向思维”的幽默感，所以就叫我潘多拉吧。

从理论上讲，您可以使用一些 Javascript 和跨域 <form> 帖子来实现类似的功能。简而言之，您将：

1.  创建一个 HTML 模板，其中包含您需要的所有表格、列表和其他结构，以及一个包含隐藏输入和提交按钮的 <form>。当用户最初请求特定记录时，该模板将由服务器应用程序填充数据。

2.  为模板创建一个脚本，解析表和列表的值（例如，使用 DOM 方法），将它们序列化（例如，转换为 JSON 字符串），并将表单隐藏输入的值设置为序列化数据。

3.  将表单的`action`属性设置为旨在反序列化表单数据并将其保存到数据库的 PHP 脚本。还要在提交按钮上分配一个事件处理程序，在表单发布之前执行序列化程序脚本。

现在，这里的诀窍在于用户序列。用户请求一些记录，服务器在填充的模板中返回这些记录。通常，用户可以使用模板提供的任何 CMS 样式字段，但[expiredninja](https://stackoverflow.com/users/487113/expiredninja)会保存页面的 HTML 源，更改指定的表格和列表，在浏览器中打开修改后的 HTML 文件，然后单击提交。脚本序列化数据，客户端将表单发布到服务器，服务器反序列化并保存数据。

我请求 StackOverflow 社区不要因为这个答案的荒谬而否决这个答案。在我的辩护中，我认为答案中的 DOM 观察部分与所有那些[拖放式购物车](http://designbeep.com/2012/06/02/excellent-jquery-drag-and-drop-shopping-cart-tutorials-and-plugins/)背后的想法并没有太大的不同，当 Ajax 首次起飞时，这些购物车本应彻底改变电子商务用户体验。但是关于跨域表单帖子的部分是我的可信度的一个瑕疵，我会自愿这么多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:54:56.623

这不是语言的问题。您需要一个[内容管理系统](http://en.wikipedia.org/wiki/Web_content_management_system)。

# html - 如何使用条件分支对复杂的多页表单进行建模？

> ID：10853422
> 
> 赞同：10
> 
> 时间：2012-06-01T15:45:28.607
> 
> 标签：html, forms

我突然想到，我的大部分工作实际上只是一遍又一遍地构建相同的东西。

这些基本上是复杂的多页表格，例如抵押贷款申请、保险等。

是否有此类事情的通用/使用良好的模型？我不在乎使用什么语言/技术。理想情况下，我认为 XML / 语言中立。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T07:23:46.803

我个人使用[Django](https://www.djangoproject.com/)来构建我的表单。我已经完成了复杂的多步骤表单，其中步骤是有条件的，通过使用`django.contrib.formtools.FormWizard`和使用工厂函数来为这样的步骤创建 Form 类：

```
class SomeWizard(FormWizard): 
    def process_step(self, request, form, step):
        if form.is_valid() and step == 0:
            #compute step 2
            Step2 = second_step_factory(form)
            self.form_list[1] = Step2 
```

并在实例化 Wizard 对象时使用占位符进行步骤：

```
def some_form_view(request):
    Step1 = first_step_factory(request)
    placeholder = second_step_factory()
    return SomeWizard([Step1, placeholder])(request) 
```

在 Django 1.4 中，FormWizard 已被不同的实现所[取代](https://docs.djangoproject.com/en/1.4/releases/1.4/#new-form-wizard)，我还没有看过。

如果您想要一个语言中立的、更具声明性的选项，您可以查看[XForms](https://en.wikipedia.org/wiki/XForms)。浏览器支持似乎有点被放弃了，但是有[XSLT 可以将您的 XForms 转换为 HTML](http://www.agencexml.com/xsltforms.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T08:24:27.770

您也可以使用[http://www.springsource.org/spring-web-flow](http://www.springsource.org/spring-web-flow)：

> Spring Web Flow 是一个 Spring MVC 扩展，允许实现 Web 应用程序的“流”。流封装了引导用户执行某些业务任务的一系列步骤。它跨越多个 HTTP 请求，具有状态，处理事务数据，可重用，并且本质上可能是动态的和长期运行的。

它也完美地集成在 Groovy & [Grails](http://grails.org) ( [Webflow Doc](http://grails.org/doc/latest/guide/theWebLayer.html#webflow) ) 中。Groovy 是 Java 的类似脚本的扩展，而 Grails 是使用 Spring、Hibernate 等其他东西的 web 框架......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T07:44:17.367

我不会尝试保持语言中立。专注于像 CFML 或 PHP 这样能很好地完成这类事情的语言。例如。

```
<input type="radio" name="type" value='mortgage' onmouseup='updateForm(this)'> Mortgage
<input type="radio" name="type" value='loan' onmouseup='updateForm(this)'> Loan

<cfif form.type eq 'loan'>
  <input name="income" type="text">
</cfif> 
```

一个非常简单的例子。您还可以使用基于登录详细信息、数据库值、以前的表单等的逻辑。CFML 还提供高级表单标签（例如[cfinput](http://livedocs.adobe.com/coldfusion/8/Tags_i_07.html)），可以为您处理动态表单的一些杂乱细节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T10:36:17.837

**PFBC** （PHP Form Builder Class）项目的开发考虑了以下目标：

*   通过面向对象的 PHP 结构促进表单的快速开发。
*   在构建表单时消除编写 html 和验证的繁琐/重复工作。使用一致/经过测试的实用程序导致的人为错误。

示例代码将是：

```
<?php
//PFBC 2.x PHP 5 >= 5.3
session_start();
include($_SERVER["DOCUMENT_ROOT"] . "/PFBC/Form.php");
$form = new PFBC\Form("GettingStarted", 300);
$form->addElement(new PFBC\Element\Textbox("My Textbox:", "MyTextbox"));
$form->addElement(new PFBC\Element\Select("My Select:", "MySelect", array(
   "Option #1",
   "Option #2",
   "Option #3"
)));
$form->addElement(new PFBC\Element\Button);
$form->render();

//PFBC 2.x PHP 5
session_start();
include($_SERVER["DOCUMENT_ROOT"] . "/PFBC/Form.php");
$form = new Form("GettingStarted", 300);
$form->addElement(new Element_Textbox("My Textbox:", "MyTextbox"));
$form->addElement(new Element_Select("My Select:", "MySelect", array(
   "Option #1",
   "Option #2",
   "Option #3"
)));
$form->addElement(new Element_Button);
$form->render();
?> 
```

查看[PHP 表单生成器类项目](http://code.google.com/p/php-form-builder-class/)。希望这可以帮助... ：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-18T08:07:00.197

好吧，如果您不介意使用哪种语言，并且对学习[ROR](http://rubyonrails.org)感兴趣，那么这里有一个不错的[复杂表单教程](http://railscasts.com/episodes/346-wizard-forms-with-wicked)，尽管您需要熟悉该框架才能使这项工作

也许[这个答案](https://stackoverflow.com/questions/2074707/creating-multi-step-forms)会帮助您找到一种更简单的面向 jquery 的方法，可能有点旧

也可以看看[这个 jQuery 多步骤表单教程](http://webexpedition18.com/articles/how-to-create-a-multi-step-signup-form-with-css3-and-jquery/)，但它看起来像是我稍后会在午休期间阅读的，因为我有兴趣自己做这个

那里也肯定有一个防白痴插件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-20T08:31:29.807

我确实假设您正在使用某种数据库来形成数据。你要做的是在第一页填写一些数据，提交表单获取第二页，依此类推。

**选项 1** - 使用 PHP Yii 框架。它有一些很好的内置 CRUD（表单）生成支持，它可以自动生成简单的表单。您需要做的是自定义操作以在下一个表单（第二页）上重定向您并在最终表单上保存所有数据。它还具有良好的基于​​ ajax 的验证。
您需要做的就是将您的应用程序连接到数据库，选择一个表生成模型，然后生成 CRUD。到此为止，这是一个 5-10 分钟的任务。然后，您需要自定义表单定义验证场景并修改已定义的操作以支持更改。
你可以试试他们的[示例应用 Yii Blog](http://www.yiiframework.com/demos/blog/index.php/)。它可以详细解释这个过程。

**选项 2** - 使用 JavaScript。根据您的要求构建简单的 html 表单。然后在提交每个页面时调用一个 JavaScript（提交按钮的 onClick 事件）来验证表单并将表单数据存储在 JSON/XML 对象中。您可以对其进行序列化或将其保存在会话中。在提交最终页面时，将整个 JSON/XML 数据（包括最终页面上的数据）发送到您的表单处理脚本/动作标记中的 URL。

# operating-system - 基本 NASM 引导程序

> ID：10853425
> 
> 赞同：2
> 
> 时间：2012-06-01T15:45:35.003
> 
> 标签：operating-system, nasm, boot, bootstrapping, mbr

我最近一直在研究操作系统、引导过程和 NASM。在旅途中，我遇到了一段有用的引导代码，我部分理解并通过虚拟软盘进行了测试。我的基本问题是我不明白的这些行中的一些做什么。我已经评论了我认为这些线条的作用，任何更正或确认将不胜感激。

```
; This is NASM

        BITS 16                 ; 16 bits!

start:                          ; Entry point
        mov ax, 07C0h           ; Move the starting address (after this bootloader) into 'ax'
        add ax, 288             ; Leave 288 bytes before the stack beginning for some reason
        mov ss, ax              ; Show 'stack segment' where our stack starts
        mov sp, 4096            ; Tell 'stack pointer'  that our stack is 4K in size

        mov ax, 07C0h           ; Use 'ax' as temporary variable for setting 'ds'
        mov ds, ax              ; Set data segment to where we're loaded

        mov si, text_string     ; Put string position into SI (the reg used for this!)
        call print_string       ; Call our string-printing routine

        jmp $                   ; Jump here - infinite loop!

        text_string db 'This is my cool new OS!', 0 ; Our null terminated string
                                                    ; For some reason declared after use

print_string:                   ; Routine: output string in SI to screen
        mov ah, 0Eh             ; I don't know what this does..
                                ; Continue on to 'repeat'
.repeat:
        lodsb                   ; Get character from DS:SI into AL
        cmp al, 0               ; If end of text_string
        je .done                ; We're done here
        int 10h                 ; Otherwise, print the character (What 10h means)
        jmp .repeat             ; And repeat

.done:
        ret

        times 510-($-$$) db 0   ; Pad remainder of boot sector with 0s
        dw 0xAA55               ; The standard PC 'magic word' boot signature 
```

谢谢，

乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:44:08.710

你的评论在很大程度上是正确的。

> `mov ah,0Eh`

这将为 BIOS 中断调用设置一个参数：

> `int 10h`

有关更多详细信息，请参见[此处](http://en.wikipedia.org/wiki/BIOS_interrupt_call)，但本质上，对 10h 的调用需要一个操作 in`ah`和操作 in 的数据`al`。

段寄存器不能直接加载，只能从寄存器加载，因此`ax`用作“临时变量”。

添加到基本堆栈指针的 288 个字节实际上根本不是字节。加载到段寄存器中的地址实际上是指向 16 字节块的指针，因此要将数字转换为其实际地址，请将其左移 4 位。这意味着地址 07C0h 实际上是指 7C00h，这是放置引导加载程序代码的位置。288 是十六进制的 120h，因此堆栈的实际位置实际上是 7C00h + 1200h = 8E00h。

此外，您可以使用“show”和“tell”之类的词，这很好，但最好通过设置`ss`而`sp`不是报告它的位置来定义堆栈......我希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:57:02.237

```
 mov ah, 0Eh             ; I don't know what this does.. 
```

加载`0eh`到`ah`设置`int 10h`功能[Teletype output](http://en.wikipedia.org/wiki/INT_10H)，它将字符打印`al`到屏幕上。

然后，您的`.repeat`循环将从`text_string`into加载每个字符`al`并调用`int 10h`.

# http-status-code-301 - SEO - 获取被搜索引擎索引的 301 页面

> ID：10853426
> 
> 赞同：3
> 
> 时间：2012-06-01T15:45:45.380
> 
> 标签：http-status-code-301, seo

我有一个网站（比如**site1.com**），它 301 重定向到另一个网站上的另一个页面（比如**http://site2.com/some/dirty/url**）。

**site1.com 上的典型代码：**

```
<?php 
    header("HTTP/1.1 301"); header("refresh:0;url=http://site2.com/some/dirty/url");
?><html>
    <head>
        <title>
            Site 1 - heading.
        </title>
        <meta name="description" content="some description" />
    </head>
    <body />
</html> 
```

通常，搜索引擎从不索引**site1.com**，即使有外部链接，例如：

```
<a href="http://site1.com/">Click Here</a> 
```

但这被认为是指向**http://site2.com/some/dirty/url**的外部链接，因此**http://site2.com/some/dirty/url**是 seo'd。

**尽管http://site2.com/some/dirty/url**被索引不是问题，但我想如何让**site1.com**被索引（只是标题、元描述和 URL） 。这真的有可能还是我必须忘记？

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:42:30.850

301 重定向告诉搜索引擎和任何其他尊重 HTTP 状态代码的用户代理`http://site.com`不再存在并已移动到新位置。这意味着他们现在考虑`http://site.com`to be的新位置并关联所有内容，包括要关联的`http://site2.com/some/dirty/url`所有链接。所以基本上不存在了，无论你指向它有多少链接，它都不会改变任何东西，因为它们现在将与. 这是有道理的，因为 301 HTTP 状态确实表明页面已永久移动。如果该页面没有永久移动，则说明您使用了错误的 HTTP 状态代码。`http://site.com``http://site2.com/some/dirty/url``http://site.com``http://site2.com/some/dirty/url`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T15:05:43.990

是的，它可以被编入索引......但它需要在您的两个网站 (http://site.com) 和 (http://site2.com/some/dirty/url) 上进行更好的页面工作) ......

例如，我最近在相同的条件下工作，网站 url 是“http://www.top-alliance.de”，它重定向到“http://www.top-alliance.com”，这两个网站都被索引搜索引擎最近在 2012 年 6 月 4 日之前。发生这种情况是因为我对两个页面都做了更好的页面工作......

所以结论是你的两个网站都需要更好的页面工作，所以它肯定会被搜索引擎索引。

感谢和问候

尼廷·巴特纳格尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-26T15:18:19.650

要在您的 WordPress 中轻松创建重定向，另一种选择是简单的 301 重定向插件。安装并激活插件后，在仪表板的“设置”区域添加一个新菜单。

这个插件真的没什么好担心的。301 重定向配置窗口显示了两个简单的字段。一个标记为请求，另一个标记为目的地。这基本上是旧的永久链接结构和新的永久链接结构的来源。您只需要在这些字段中在您的域名后添加信息。

在上面的示例中，请求字段是月份和名称 Permilix 的 WordPress 设置，而目标字段是帖子名称 Permalink 结构的 WordPress 设置。添加这两个字段后，保存更改。它会要求任何搜索引擎流量返回旧链接。**

# javascript - 在 JavaScript 中，当一次声明多个变量时，只使用一个 var 语句对内存有好处吗？

> ID：10853428
> 
> 赞同：2
> 
> 时间：2012-06-01T15:45:52.547
> 
> 标签：javascript, variables

例如，

```
//pattern one
function Foo() {

    var hello
        , world
        , how = []
        , are
        , you = 'you';
}

//pattern two 
function Foo() {

    var hello;
    var world;
    var how = [];
    var are;
    var you = 'you';
} 
```

与模式 2 相比，使用模式 1 会更节省内存吗？一个比另一个有其他好处吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:47:01.687

不，它们完全一样。有些人更喜欢在函数顶部进行所有变量声明，因为这是由于提升而有效地进行的地方。JSLint 还可以选择要求单个`var`语句 ( `onevar`)，但我真的觉得没有必要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:47:04.380

不，这只是代码可读性的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:50:08.397

内存分配是在内部使用不同的内存位置（存储方面）完成的，因此与单个声明或多个声明一起使用确实没有区别。

# java - 如何在动态壁纸列表中获取我的动态壁纸图标

> ID：10853431
> 
> 赞同：0
> 
> 时间：2012-06-01T15:46:08.427
> 
> 标签：java, android, android-layout, live-wallpaper

如何在动态壁纸列表中获取我的动态壁纸图标。

我正在开发动态壁纸。运行应用程序后，我在选择动态壁纸时看不到图标。请看下面的图片

我可以看到文字花高清壁纸，但看不到图标。

感谢您提前提供帮助

![在此处输入图像描述](../Images/565fb30592afe9253b5152e0bccfefe4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T11:38:29.040

我认为您在清单文件中缺少图标属性

```
 <application 
      android:label="@string/app_name" 
      android:icon="@drawable/icon"> 
```

或者可能正在使用（hdpi-mdpi-ldpi）drawble 资源文件夹图像不存在或更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:49:00.143

在 xml 中的壁纸元素上使用 android:thumbnail 属性，如下所示：

```
android:thumbnail="@drawable/thumb" 
```

# java - 当不使用数组时，是否有任何理由从零而不是一来初始化循环的迭代？

> ID：10853434
> 
> 赞同：2
> 
> 时间：2012-06-01T15:46:20.610
> 
> 标签：java, loops, for-loop, initialization

我是说

```
for (int i=1; i<7; i++) 
```

当它纯粹是为了迭代次数时更具可读性

```
for (int i=0; i<6; i++) 
```

但在某种程度上，另一种方法已成为标准。

你怎么看？这是不好的做法还是气馁？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:47:30.010

我认为这仅仅是因为数组几乎总是从 0 开始，所以当设计师创建其他具有集合的非数组对象时，他们也倾向于使它们也从 0 开始。0-based 只是一个标准，所以坚持它只是维护者的一致性和易用性。

另外，对我来说，

`for(int i = 0; i < 6; i++) {`

更具可读性，因为我知道当 1 个循环完成时，计数 ( `i`) 将为 1。从 1 开始，在第一个循环之后，计数为`i = 2`. 这让我有点失望。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:50:14.213

习俗。零索引在历史上如此普遍和普遍，除非有特定的理由不这样做，否则这是程序员期望看到的。如果他们看到从 1 开始索引的循环，他们通常不会认为“啊，这更容易阅读”，他们会认为“哦，最好弄清楚为什么我们从这里开始。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:58:49.583

我会争辩说

```
for (int i=1; i<7; i++) 
```

比阅读更难

```
for (int i=0; i<6; i++) 
```

因为它是`6`迭代。您需要从第一个循环中减去`1`以`7`找出答案。

这两个选项通常是 start at`0`并`<`用作您的条件，或者 start at`1`并`<=`用作您的条件，如下所示：

```
for (int i=1; i<=6; i++) 
```

请注意，某些语言（例如 MATLAB）会索引从 1 开始的所有内容。

通常发生的是语言中的所有循环都遵循其最基本/广泛使用的自然索引结构的索引约定。在 Java 中，数组的索引为`0`，并且因为从基于 0 的索引切换到基于 1 的索引并返回很痛苦，所以一切都变成了 0 索引。

为了比较，在 MATLAB 中，数组和矩阵是 1 索引的，因此所有循环通常也是 1 索引的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T17:44:14.440

它可以追溯到 c 指针时代（我的 c 生锈了，请原谅我）。以下是c中的数组声明

```
int arr[10] = { ... }; 
```

实际上，“arr”变量实际上是“int *”类型（但如上所述声明它可以让编译器在超出范围时强制自动清理，而不是带有 malloc 的 int *），它指向一个有足够连续空间容纳 10 个 int 值的内存位置。然后访问数组：

```
int element = arr[index]; 
```

访问中真正发生的事情是：

```
int element = * (arr + index*sizeof(int)); 
```

它获取指针，向指针添加足够的字节以指向您感兴趣的元素的内存位置（括号中的部分），然后取消引用它以获取值（*）。

因此，对于数组中的第一个元素，您的索引为 0，因为指针已经指向第一个元素，因此您无需向内存位置添加任何内容。

将索引视为“我必须向指针添加多少个插槽才能找到我想要的内容”。

# java - Converting a JPA object to XML / JAXB

> ID：10853436
> 
> 赞同：1
> 
> 时间：2012-06-01T15:46:25.437
> 
> 标签：java, xml, spring, hibernate, jaxb

I would like to convert data from a table to an XML file. The data is in the following format

```
 Continent   Country     County      Town
    --------------------------------------------------------------
    Africa      Kenya       South       Mombasa
    Africa      Egypt       South       Cairo
    Europe      England     North       Birmingham
    Asia        Japan       South       Tokyo 
```

The resultant XML document that will be produced is similar to the one shown below:

```
<continents>
    <continent name="Africa">
        <countries>
            <country>
                <countryName>Kenya</countryName>
                <county>South</county>
                <town>Mombasa</town>
            </country>
            <country>
                <countryName>Egypt</countryName>
                <county>South</county>
                <town>Cairo</town>
            </country>
        </countries>
    </continent>
    <continent name="Europe">
        <countries>
            <country>
                <countryName>England</countryName>
                <county>North</county>
                <town>Birminghan</town>
            </country>
        </countries>
    </continent>
    <continent name="Asia">
        <countries>
            <country>
                <countryName>Japan</countryName>
                <county>South</county>
                <town>Tokyo</town>
            </country>
        </countries>
    </continent>    
</continents> 
```

What i am planning to do is read the data from the database into a JPA object. This returns a list of the following object

```
@Entity
@Indexed
@Table(name="TOWN")
public class Town {

    protected String continent;
    protected String country;
    protected String county;
    protected String town;

    @Id 
    @Column(name="CONTINENT")
    public String getContinent() {
        return continent;
    }

    public void setContinent(String continent) {
        this.continent = continent;
    }

    @Column(name="COUNTRY")
    public String getCountry() {
        return country;
    }

    public void setCountry(String country) {
        this.country = country;
    }

    @Column(name="COUNTY")
    public String getCounty() {
        return county;
    }

    public void setCounty(String county) {
        this.county = county;
    }

    @Column(name="TOWN")
    public String getTown() {
        return town;
    }
    public void setTown(String town) {
        this.town = town;
    }   
} 
```

When i run the call to retrieve the rows from the database, i will get the list in the following format:

```
List<Town> towns = entityManager.getAllTowns(); 
```

To be able to generate the XML file, i have to iterate the list and process each of the "Town" object. I can use DOM but i feel that there will be lots of for loops and if statements to be able to generate the XML document. Is it possible to generate the XML document without having to iterate through the list to build the xml file shown above?

I have converted a JPA object to Jaxb but this was a flat relationship with a one to one mapping (i.e. no child or inner elements in the XML structure). I dont understand how to do the child elements and the conditional rules that would be required for the sample xml file.

I am using JPA/Hibernate with Spring 3\. Is it possible to generate the sample xml file or do i need to do it manually (Using for loops and if statements) because of the format of the XML file?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:20:05.453

Take a look at [Dozer](http://dozer.sourceforge.net/). Let's say you have one JPA entity class and one JAXB class. Dozer is a framework for making mapping between two such beans. You will however need to specify which attribute should be mapped where.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:27:58.070

I've generally found it easier to go the other way from what you're doing. That is, generate the JAXB objects using XJC, and then use an orm.xml file to do the JPA mapping to the database. You can customize the generated Java objects using standard XJC plugins and JAXB configuration files.

This approach has the advantage of maintaining only one set of Java classes (maybe with some supplemental child classes of the JAXB model), and it also has a tendency to promote a more stable XML contract.

For some reason, people have a tendency to look down upon using a separate XML file for ORM. There are cases, though, where it makes sense, and I believe that this is one of those cases.

# c# - 何时使用 FindAncestor？

> ID：10853438
> 
> 赞同：0
> 
> 时间：2012-06-01T15:46:35.697
> 
> 标签：c#, .net, wpf, c#-4.0

在下图中，为什么需要 FindAncestor，为什么 AncestorType 不是 UserControl？

如果 UserControl 在 StackPanel 中，那么 AncestorType 会是 StackPanel 吗？

换句话说，父控件与绑定到 viewmodel.Message 有什么关系？为什么绑定中需要所有其他 xaml？

![WPF 绑定](../Images/6298845d32474520cf91bea7fe14784d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:58:44.810

它不需要指定 AncestorType=UserControl，因为这是默认上下文。如果省略“RelativeSource”参数，它将绑定到本地 DataContext。

在这种情况下，UserControl 和它所在的 Window 必须具有不同的 DataContext。由于 UserControl 在设计时通常不知道其父级的名称，因此您至少通常可以假设它只会位于单个窗口中，并使用所示的 RelativeSource 创建到窗口的 DataContext 的绑定。

这可能很常见，因为在应用程序中，Window 可能有一个 DataContext 用于有关整个应用程序的信息，但当前的 UserControl 可能专注于特定的数据片段（例如 Employee）。在这种情况下，所有默认绑定都指向 Employee，但 UserControl 可能也希望绑定到父 DataContext 中的某些内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:02:14.597

为什么需要 FindAncestor？
这里FindAncestor用于访问Window对象以获取Window对象的DataContext。

为什么 AncestorType 不是 UserControl？
因为UserControl对象的DataContext可能和Window对象的DataContext不一样。
通常它是相同的，但您可以重新定义它。

如果 UserControl 在 StackPanel 中，那么 AncestorType 会是 StackPanel 吗？
如果 StackPanel 本身在您的窗口中，则否。
不要忘记你的目标是包含你想要的 DataContext 的图形对象的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:54:06.570

在这种情况下，开发人员只知道具有他们正在寻找的数据上下文的对象是一个窗口。例如，如果在堆栈面板上设置了数据上下文，并且您想要从该数据上下文中获取某些内容，那么您将使用 AncestorType = Window。由于有两个数据上下文，并且用户希望将某些内容绑定到外部，因此使用了 FindAncestor。

# c# - C# 中的动态绑定

> ID：10853440
> 
> 赞同：10
> 
> 时间：2012-06-01T15:46:44.060
> 
> 标签：c#, dynamic-binding

```
class A 
 {
   public virtual void WhoAreYou() { Console.WriteLine("I am an A"); }
 }
class B : A
{
  public override void WhoAreYou() { Console.WriteLine("I am a B"); }
}
class C : B
{
 public new virtual void WhoAreYou() { Console.WriteLine("I am a C"); }
}
class D : C 
{
  public override void WhoAreYou() { Console.WriteLine("I am a D"); }
}

C c = new D();
c.WhoAreYou();// "I am a D"
A a = new D();
a.WhoAreYou();// "I am a B" !!!! 
```

内部如何分配引用，**引用A包含B的引用？** 任何人都可以解释发生了什么事吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T16:00:26.433

在 class`C`中，该方法`WhoAreYou()`不会覆盖基类方法，因为它是使用关键字定义的，`new`该关键字添加了一个具有*相同*名称的*新*方法，该方法*隐藏*了基类方法。这就是为什么：

 **```
C c = new D();
c.WhoAreYou();// "I am a D" 
```

调用重写的方法，其中重写其用关键字`D`定义的基类方法。`new`

但是，当目标类型为 时`A`，则：

```
A a = new D();
a.WhoAreYou();// "I am a B" !!!! 
```

调用被覆盖的方法`B`，因为您正在调用其方法被覆盖`a`的类型的方法。`A``B`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T16:00:13.100

您的 C 类 WhoAreYou() 方法是“新的”，因此对 B 隐藏了该方法。这意味着 D 类中的覆盖是覆盖 C 的方法而不是 B 的（覆盖 A）。

因为你有一个 A 的引用，所以它的 WhoAreYou() 函数的层次结构最底层是 B 类中的那个。

[http://msdn.microsoft.com/en-us/library/435f1dw2.aspx](http://msdn.microsoft.com/en-us/library/435f1dw2.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:24:22.810

意思是，C的

```
public new virtual void WhoAreYou(){} 
```

打破虚方法链。

当您通过引用 A 调用 D 的方法 WhoAreYou() 时。虚拟性开始工作，但在 C 处中断。**

# iphone - 目标 c：我每次都必须重新输入所有代码吗？

> ID：10853441
> 
> 赞同：0
> 
> 时间：2012-06-01T15:46:44.940
> 
> 标签：iphone, objective-c, ios, xcode

我正在制作一个基于服务器的应用程序。每次我向数据库发出请求时，我都必须输入所有服务器连接代码。是否有可能以某种方式重用它？在 php 中，您通常有一个名为 dbConnect.php（或类似的文件）的文件，您可以在每次想要连接时调用该文件。

例如，我想替换它，我一直使用它：

```
- (void)doSomething
{
__block ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL: url]; 
__weak ASIHTTPRequest *request_b = request;
[request setDelegate: self]; 
[request addRequestHeader:@"Content-Type" value:@"text/html; charset=utf-8;"];
[request setDefaultResponseEncoding:NSUTF8StringEncoding]; 
[request setTimeOutSeconds: 10.0f]; 
[request setCachePolicy: ASIDoNotWriteToCacheCachePolicy | ASIDoNotReadFromCacheCachePolicy]; 

 //Set the variables here

    [request startAsynchronous];
} 
```

...类似于：

```
 - (void)doSomething
    { 
         LoadServerCode;  //This loads all the server code as above

         //Set variables 

         [request startAsynchronous];

    } 
```

提前致谢

编辑：

澄清一点。假设我有一些我经常使用的方法，例如以特殊方式创建 UILabel 或 UIView ... 不必子类化并最终得到一堆类，而是有一个类称为MyConstructionMethods 什么的……所以如果我想在应用程序的一些不同的地方创建一个标签，我可以输入：

```
MyGreenLabel; //Done, the label is created and added to the view 
```

... 代替：

```
 UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 320, 10)]; 
    label.backgroundColor = [UIColor greenColor]; 
    [self.view addSubview: label]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:52:04.870

希望您将所有连接类与其余代码隔离开来，那么为什么您不能只创建一个方法来创建您的请求设置您的变量并返回请求以让您启动异步......即使您不保留你的连接东西被隔离了你仍然可以有一些类的静态方法有这个方法......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:53:34.930

你可以实现你的自定义 ASIHTTPRequest 类：

```
@interface YourRequest : ASIFormDataRequest
@end

@implementation YourRequest  

- (id)initWithURL:(NSURL *)newURL {
  self = [super initWithURL: newURL];

  if (self) {
      [self addRequestHeader:@"Content-Type" value:@"text/html; charset=utf-8;"];
      [self setDefaultResponseEncoding:NSUTF8StringEncoding]; 
      [self setTimeOutSeconds: 10.0f]; 
      [self setCachePolicy: ASIDoNotWriteToCacheCachePolicy | ASIDoNotReadFromCacheCachePolicy]; 
    }
  }

  return self;
}
@end 
```

并创建对象：

```
 - (void)doSomething { 
     __block YourRequest *request = [YourRequest requestWithURL: url]; 
     __weak ASIHTTPRequest *request_b = request;
     [request setDelegate : self];
     //Set variables 

     [request startAsynchronous];

 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T15:52:26.707

如果您需要在同一个实现文件中多次重用该设置代码，请考虑使用[Extract Method](http://www.refactoring.com/catalog/extractMethod.html)重构以创建返回正确配置的请求对象的实用程序方法。

如果您需要在许多地方执行此类操作，请考虑子类化`ASIFormDataRequest`，以便您可以更简洁地创建请求对象，并按照您最常设置的属性配置它们。或者，您可以使用静态方法创建某种请求工厂类来生成请求对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T15:52:45.900

您可以在头文件中声明方法，这些方法在使用您的类时可用。所以你可以在你的.h文件中声明doSomthing，然后在你的.m文件中实现该方法，当你想“doSomthing”时，`[className doSomthing]` 如果你想显示更多代码，我可能会给你一个更好的例子

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-01T21:05:59.790

您是否尝试过使用宏？

在您的 .h 文件中：

```
#define LoadServerCode() \
__block ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url]; \
__weak ASIHTTPRequest *request_b = request; \
[request setDelegate: self]; \
[request addRequestHeader:@"Content-Type" value:@"text/html; charset=utf-8;"]; \
[request setDefaultResponseEncoding:NSUTF8StringEncoding]; \
[request setTimeOutSeconds: 10.0f]; \
[request setCachePolicy: ASIDoNotWriteToCacheCachePolicy | ASIDoNotReadFromCacheCachePolicy]; 
```

然后，在您的实现中：

```
-(void)doSomething {
    LoadServerCode();

    //Set variables

    [request startAsynchronous];
} 
```

# java - 实体类和记录锁定

> ID：10853442
> 
> 赞同：3
> 
> 时间：2012-06-01T15:46:45.837
> 
> 标签：java, locking, entity, entitymanager

我正在查看 EntityManager API，并试图了解我将执行记录锁定的顺序。基本上，当用户决定编辑记录时，我的代码是：

```
entityManager.getTransaction().begin();
r = entityManager.find(Route.class, r.getPrimaryKey());
r.setRoute(txtRoute.getText());
entityManager.persist(r);
entityManager.getTransaction().commit(); 
```

根据我的反复试验，看来我需要 `WWEntityManager.entityManager.lock(r, LockModeType.PESSIMISTIC_READ);`在`.begin()`.

我自然认为我会`WWEntityManager.entityManager.lock(r, LockModeType.NONE);`在提交后使用，但它给了我这个：

```
Exception Description: No transaction is currently active 
```

我还没有尝试将它放在提交之前，但这不会破坏锁定记录的目的，因为我的目标是避免在 50 个用户尝试一次提交更改的情况下冲突记录？

非常感谢任何有关如何在编辑期间锁定记录的帮助！

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:26:03.510

在事务内部执行锁定非常有意义。锁在事务结束时自动释放（提交/回滚）。在事务之外（在 JPA 的上下文中）锁定没有意义，因为释放锁与事务结束有关。此外，在执行更改并提交事务后锁定也没有太大意义。

可能是您使用悲观锁定的目的不是它们的真正用途。如果我的假设是错误的，那么您可以忽略答案的结尾。当您的事务在实体（行）上持有悲观读锁时，可以保证以下内容：

*   无脏读：其他事务看不到您对锁定行执行的操作的结果。
*   可重复读取：没有来自其他事务的修改
*   如果您的事务修改了锁定的实体，则 PESSIMISTIC_READ 将升级为 PESSIMISTIC_WRITE 或者如果无法升级锁定，则事务将失败。

下面粗略地描述在事务开始时获得锁定的场景：

```
entityManager.getTransaction().begin();
r = entityManager.find(Route.class, r.getPrimaryKey(), 
      LockModeType.PESSIMISTIC_READ);
//from this moment on we can safely read r again expect no changes
r.setRoute(txtRoute.getText());
entityManager.persist(r);
//When changes are flushed to database, provider must convert lock to 
//PESSIMISTIC_WRITE, which can fail if concurrent update
entityManager.getTransaction().commit(); 
```

通常，数据库没有单独支持悲观读取，因此您实际上是从 PESSIMISTIC_READ 开始锁定行。仅当预期不会更改锁定行时，使用 PESSIMISTIC_READ 才有意义。如果上述更改总是进行，那么从一开始就使用 PESSIMISTIC_WRITE 是合理的，因为它可以避免并发更新的风险。

在许多情况下，使用乐观而不是悲观锁定也是有意义的。可以从以下位置找到关于在锁定策略之间进行选择的好示例和一些评论：[Java Persistence 2.0 中的锁定和并发](https://blogs.oracle.com/enterprisetechtips/entry/locking_and_concurrency_in_java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T14:49:15.230

伟大的工作试图安全地写入锁定您的更改数据。:) 但你可能会走火入魔/做很长的路要走。

*   首先是一个小问题。不需要调用persist()。对于更新，只需修改 find() 返回的实体的属性。entityManager 自动知道更改并在提交期间将它们写入数据库。仅当您创建新对象并将其首次写入数据库时​​才需要持久化（或将新子对象添加到父关系并通过 cascade=PERSIST 级联持久化）。

*   大多数应用程序通过具有自己的单独事务和单独的持久上下文的不同线程对相同数据的“冲突”并发更新的可能性很低。如果这对您来说是正确的，并且您希望最大限度地提高可伸缩性，那么请使用乐观的写入锁，而不是悲观的读取或写入锁。绝大多数 Web 应用程序都是这种情况。它提供完全相同的数据完整性、更好的性能/可扩展性，但您必须（不经常）处理 OptimisticLockException。

*   乐观写锁定是自动内置的，只需在数据库和实体中具有一个短/整数/长/时间戳属性并在实体中使用@Version对其进行注释，在这种情况下您不需要调用 entityManager.lock()

如果您对上述内容感到满意，并向您的实体添加了 @Version 属性，您的代码将是：

```
try {
   entityManager.getTransaction().begin();
   r = entityManager.find(Route.class, r.getPrimaryKey());
   r.setRoute(txtRoute.getText());
   entityManager.getTransaction().commit();
} catch (OptimisticLockException e) {
   // Logging and (maybe) some error handling here.
   // In your case you are lucky - you could simply rerun the whole method.
   // Although often automatic recovery is difficult and possibly dangerous/undesirable
   // in which case we need to report the error back to the user for manual recovery 
} 
```

即根本没有显式锁定- 实体管理器自动处理它。

如果您非常需要避免并发数据更新“冲突”，并且很高兴您的代码具有有限的可伸缩性，那么通过悲观的写锁定序列化数据访问：

```
try {
   entityManager.getTransaction().begin();
   r = entityManager.find(Route.class, r.getPrimaryKey(), LockModeType.PESSIMISTIC_WRITE);
   r.setRoute(txtRoute.getText());
   entityManager.getTransaction().commit();
} catch (PessimisticLockException e) {
   // log & rethrow
} 
```

在这两种情况下，成功提交或具有自动回滚的异常意味着执行的任何锁定都将自动清除。

干杯。

# jquery - Jquery Modal Popup 在 IE 中不起作用

> ID：10853453
> 
> 赞同：0
> 
> 时间：2012-06-01T15:47:10.600
> 
> 标签：jquery, modal-dialog

这是我一直在使用的 jquery-ui 模态代码：

```
//jQuery form dialog modal popup and submit
$(function() {
$("#facilitiesForm").validate();

$("#facilityForm").dialog({
    autoOpen: false,
    height: 470,
    width: 650,
    modal: true,
    buttons: {
       "Send To The Facilities Manager": function() {
            $("#facilitiesForm").submit();
        },
        "Cancel": function() {
            $( this ).dialog( "close" );
        },
    },
    close: function() {
        allFields.val( "" ).removeClass( "ui-state-error" );
    }
});

$("#helpForm").validate();

$("#helpdeskForm").dialog({
    autoOpen: false,
    height: 570,
    width: 650,
    modal: true,
    buttons: {
       "Send To The Helpdesk": function() {
            $("#helpForm").submit();
        },
        "Cancel": function() {
            $( this ).dialog( "close" );
        },
    },
    close: function() {
        allFields.val( "" ).removeClass( "ui-state-error" );
    }
});

$("#adminForm").validate();

$("#adminTasksForm").dialog({
    autoOpen: false,
    height: 470,
    width: 650,
    modal: true,
    buttons: {
       "Send To The Admin": function() {
            $("#adminForm").submit();
        },
        "Cancel": function() {
            $( this ).dialog( "close" );
        },
    },
    close: function() {
        allFields.val( "" ).removeClass( "ui-state-error" );
    }
});

$("#contactFacilityManager")
    //.button()
    .click(function() {
        $( "#facilityForm" ).dialog( "open" );
    });

$("#contactHelpdesk")
    //.button()
    .click(function() {
        $( "#helpdeskForm" ).dialog( "open" );
    });

$("#contactAdminTasks")
    //.button()
    .click(function() {
        $( "#adminTasksForm" ).dialog( "open" );
    });

}); 
```

我刚开始注意到一个错误，弹出框在 IE 中不起作用。我得到的错误是：

```
Webpage error details

Message: Expected identifier, string or number
Line: 16
Char: 6
Code: 0
URI: http://newintranet/js/script.js 
```

任何想法为什么这在 IE 上不起作用（在 Chrome 和 FF 上运行良好）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:49:23.497

在第 16 行，“取消”函数的右大括号和`buttons`对象的右大括号之间有一个额外的逗号。

实际上，您在第 36 行和第 56 行又犯了两次同样的错误。每次都在指定对话框按钮的末尾。

IE 将此视为语法错误，而其他浏览器则更为宽松（毕竟，逗号后的空语句不会有任何效果）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T15:49:46.757

因为在 IE 中，它会在下面的代码中抛出语法错误。删除多余的逗号它会正常工作。

```
buttons: {
       "Send To The Helpdesk": function() {
            $("#helpForm").submit();
        },
        "Cancel": function() {
            $( this ).dialog( "close" );
        }, //extra comma here
    } 
```

# configuration - HBaseConfiguration 不读取我在 ${HBASE_HOME}/conf/hbase-site.xml 中设置的值

> ID：10853455
> 
> 赞同：2
> 
> 时间：2012-06-01T15:47:24.980
> 
> 标签：configuration, hadoop, hbase

${HBASE_HOME}/conf/hbase-site.xml 有下一个值：

```
<property>
  <name>hbase.zookeeper.quorum</name>
  <value>hd1</value>
</property> 
```

在“/etc/hosts”中设置了“hd1”主机名，ping 正常...

使用这个简单的 Java 程序：

```
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;

public class TestConfigurator {

    /**
     * @param args
     */
    public static void main(String[] args) {
        Configuration conf = HBaseConfiguration.create();
        System.out.println("HBase quorum: " + conf.get("hbase.zookeeper.quorum", "localhost"));
    }
} 
```

我得到“本地主机”。HBase 设置为分布式模式，有一个主服务器和 2 个区域服务器......并且所有 conf 文件都已同步，我多次重新启动所有服务器。

有什么我错过的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T15:53:10.250

要么`${HBASE_HOME}/conf/hbase-site.xml`不在类路径中，要么被其他人覆盖`conf-site.xml`（很可能`conf-site.xml`与 HBase jar 捆绑在一起）

要修复它，您可以将带有自定义设置的 HBase conf 目录添加到类路径中，然后使用该类路径调用您的程序。例如，

`java -cp <earlier classpath>:<your custom conf location> <your program>`

# php - PHP：检测数组中的特定元素序列

> ID：10853457
> 
> 赞同：3
> 
> 时间：2012-06-01T15:47:27.460
> 
> 标签：php, arrays, sequence

如何检测数组中是否存在特定的元素序列？例如，如果我有阵列和针

```
$needle = array(1,1);
$haystack1 = array(0,1,0,0,0,1,1,0,1,0);
$haystack2 = array(0,0,0,0,1,0,1,0,0,1); 
```

如何检测 $needle 子集是否存在于例如 $haystack1 中？此方法应为 $haystack1 返回 TRUE，为 $haystack2 返回 FALSE。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T15:49:46.647

加入阵列，并检查针的 strpos。

```
if ( strpos( join($haystack1), join($needle) ) >= 0 ) {
    echo "Items found";
} 
```

演示：[http ://codepad.org/F13DLWOI](http://codepad.org/F13DLWOI)

**警告**

这不适用于 haystack 数组中的对象或数组等复杂项目。此方法最适用于数字和字符串等项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T16:02:53.670

**对于没有数组元素是任何其他元素的前缀的特定情况**（当两者都转换为字符串时），那么已经发布的答案将可以正常工作并且可能非常快。

这是一种在一般情况下可以正常工作的方法：

```
function subarray_exists(array $needle, array $haystack) {
    if (count($needle) > count($haystack)) {
        return false;
    }

    $needle = array_values($needle);
    $iterations = count($haystack) - count($needle) + 1;
    for ($i = 0; $i < $iterations; ++$i) {
        if (array_slice($haystack, $i, count($needle)) == $needle) {
            return true;
        }
    }

    return false;
} 
```

[**看到它在行动**](http://ideone.com/Cp58w)。

*免责声明：有一些方法可以编写这个函数，我希望当您搜索巨大的干草堆时，它会使其执行得更快，但对于第一种方法来说，简单是好的。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T15:49:54.323

如果它们始终是单个数字/字符，那么您可以将所有元素转换为字符串、加入 by`''`并使用正则表达式或字符串函数进行搜索。

# html - 当li元素为圆形时，如何使锚标记的文本出现在中心

> ID：10853466
> 
> 赞同：0
> 
> 时间：2012-06-01T15:48:01.380
> 
> 标签：html, css

我正在尝试制作一个水平导航菜单，我的菜单项（li）元素是圆形的，这里是[演示](http://jsfiddle.net/Az8cG/)，我的问题是链接的文本出现在顶部，如何让它出现在中心，这可能吗，请让我知道，欢迎任何建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:51:31.507

只有块项目可以使用边距和填充。锚标签是内联元素。您需要强制它们成为 CSS 中的块元素：

```
#menu ul li a
{
    text-decoration:none;
    display:block;
    padding:30px 0 0 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T17:03:58.693

我刚玩过你的小提琴。我所做的只是让“li”显示：inline-block 并将 li:hover 更改为 #menu li:hover。

```
#menu ul li
{
    float:left;
    display:inline-block;
    padding:40px 30px;
    background-color:slategray;
    margin:0 20px 0 0;
    height:17px;
   -webkit-border-radius:50px;
}
#menu li:hover
{
   -webkit-box-shadow:0 0 50px 12px #69CDF5;
  background:#cb2326;  
} 
```

请在此处查看小提琴：http: [//jsfiddle.net/Az8cG/15/](http://jsfiddle.net/Az8cG/15/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:06:16.443

要回答您针对 Diodeus 发布的第二个问题：

如果你想使用纯 css3 悬停效果，你需要使用 :hover 选择器来做类似的事情：

```
#menu ul li a:hover {
   background-color: #000000;
   } 
```

为了获得更好的效果，请使用您可以在此处看到的 CSS3 过渡属性：

[http://www.w3schools.com/css3/css3_transitions.asp](http://www.w3schools.com/css3/css3_transitions.asp)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T16:09:38.113

与其搞乱垂直对齐，不如将 line-height 设置为等于圆的高度/宽度。

您没有采用红色背景的问题是它声明的选择器的特异性：`li:hover`不足以克服`#menu ul li`.

请参阅此处：http: [//jsfiddle.net/Az8cG/11/](http://jsfiddle.net/Az8cG/11/)两个修复程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-01T15:58:12.580

如果文本超过 2 行，您可以使用它来将其保持在中间：

```
#menu ul li a
{
    display:table-cell;
    vertical-align:middle;
    height:85px;
    width:35px;
} 
```

你的第二个问题的答案：

```
#menu ul li:hover
{
    background:red;
} 
```

# java - 找不到java小程序html转换器

> ID：10853469
> 
> 赞同：1
> 
> 时间：2012-06-01T15:48:09.503
> 
> 标签：java, html, applet

我在很多地方（例如sun/oracle 站点、参考书）看到在jdk 的bin 文件夹中提到了一个html 转换器，它应该生成对各种浏览器友好的html。但是我似乎找不到它，并且我已经检查了具有不同版本 jdk 的多台机器。

有谁知道我在哪里可以找到它？它是否由于某种原因被弃用了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:18:39.713

> ..应该生成对各种浏览器友好的html。

HTMLConverter 生成的不是 HTML。*根据任何*W3C HTML 规范，它都是无效的。很好摆脱它。

今天最好的选择是使用[小程序信息](https://stackoverflow.com/tags/applet/info)`deployJava.js`中的as 链接。[页](https://stackoverflow.com/tags/applet/info)。这是 Sun 在 Oracle 收购之前推荐的脚本，而 Oracle 一直坚持下去。

# ios - 那么 ARC 和在 viewDidUnload 上发布属性/子视图有什么关系

> ID：10853479
> 
> 赞同：1
> 
> 时间：2012-06-01T15:48:53.933
> 
> 标签：ios, automatic-ref-counting, xcode4.3, objective-c-2.0

我仍在学习 iOS 开发，并且一直在使用各种教程和书籍。有些是 ARC 之前的，有些是 ARC 的。

在某些情况下，我们被教导在 viewDidUnload 上释放 ViewController 的所有属性和子视图，但在某些情况下，我被告知不再需要这样做。

有人能给出肯定的答案吗？在 iOS 5+ 中，是否必须完成整个操作：

```
-(void)viewDidUnload
{
  [super viewDidUnload];
  self.photoViewCell = nil;
  self.photoImageView = nil;
  self.firstNameTextField = nil;
  self.lastNameTextField = nil;
} 
```

... 或不？如果是这样，这仅适用于 UIView 的后代属性还是适用于 ViewController 的所有属性？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T15:58:37.847

所以每个视图都有多个所有者。当“所有者计数”（通常称为 retainCount）达到 0 时，该对象将被销毁。

在 iOS 5 中，我们现在有弱引用，这本质上意味着“不拥有这个对象”。

在 iOS 5 之前，在我们的头文件中，你会看到

```
IBOutlet UILabel *myLabel; 
```

这个标签被添加到 XIB 文件的视图中。在这种情况下，myLabel 有 2 个所有者：它是超级视图（XIB 文件中的视图）和视图控制器（通过拥有 IBOutlet）。当 viewDidUnload get 被调用时，视图控制器的视图已经被释放，因此它对 myLabel 的所有权消失了。所以此时 myLabel 只有 1 个所有者，即视图控制器。所以我们需要在 viewDidLoad 中释放它以确保它没有任何所有者并因此被销毁。

在 iOS 5 中，您会经常看到这种情况

```
__weak IBOutlet UILabel *myLabel 
```

这就是说我们不希望视图控制器成为 myLabel 的所有者。所以唯一的所有者是视图控制器的视图。所以当 viewDidUnload get 被调用时，视图控制器的视图已经被释放，因此它对 myLabel 的所有权也被释放了。在这种情况下，myLabel 现在没有所有者并且它的内存被释放。不需要 self.myLabel = nil; 那里。

因此，对于 iOS 5，建议将所有 IBOutlets 设为弱引用。有了这个，你甚至不需要实现 viewDidUnload，因为所有的内存都已经为你处理好了。

但即使您使用的是 iOS 5，如果您的 IBOutlets 不是弱引用，您将需要 viewDidUnload 中的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:00:44.403

viewDidUnload 与自动或其他保留计数无关。当由于内存压力而卸载视图时将调用此方法，这意味着您还应该 nil（并释放，非 ARC）您持有强引用的视图元素。不这样做可能意味着您的应用程序在内存压力下没有释放足够的内存，这可能导致它被操作系统关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:18:38.453

如果您的应用程序值得，您可以使用 viewDidUnload 来管理内存。

但不要做

```
myInstanceVariable = nil; 
```

您失去了对变量值所在的内存位置的引用。

= nil 不会释放内存。不过，您的对象必须被释放。因此使用了retainCount 和retain/release。

如果您在 viewDidUnload 中将对象归零，则无法在 dealloc 中释放！注意力！！！

如果你知道你做了什么，你可以在 viewDidUnload 中释放和归零你的对象。

## 弧：

使用ARC，你不能手动释放，即使我认为你不能这样做。ARC 负责这一点。只需尽可能多地使用 @properties 和 (weak/strong) 属性，让 getter 和 setter 为您完成工作。您也可以在 .m 文件中声明 @properties（如在类扩展中）。

简单的规则：对你想要拥有的对象强，对对象弱，你不想在保留周期中迷失并持有所有权。ARC 在几乎所有情况下都会完成其余的工作。例如，对代表使用弱。

nil 对象，在你确定的地方，你不会向他们发送消息，否则不要。

# php - 自定义字段元数据未显示在我的小部件中

> ID：10853490
> 
> 赞同：0
> 
> 时间：2012-06-01T15:49:30.597
> 
> 标签：php, wordpress, metadata, widget, custom-post-type

感谢本网站上其他人的帮助，我现在的进度条在页面上运行良好。

但是每次我尝试获取相同的源代码并将其保存为小部件时，它都会将我的两个自定义字段（目标和完成）中的数据返回为零。由于 Target 和 complete 相同，因此它会在小部件中显示所有已完成的任务。

这是小部件中的“相关”代码片段，如果需要，我可以发布完整的源代码：

```
$challenge_widget_query = new WP_query( array( 'post_type' => 'challenges', 'posts_per_page' => 3 ) );

while ($challenge_widget_query->have_posts()) : $challenge_widget_query->the_post(); 

    echo "<li><a href='".get_permalink()."'>".get_the_title()."</a>";

$target = (int) get_post_meta($post->ID, 'target', true);             
$complete = (int) get_post_meta($post->ID, 'complete', true);       
$percentage = $complete / $target;
$percentage = round($percentage * 100);
$whatsleft = 100-$percentage;
if($whatsleft < 0) $whatsleft=0;

echo "<table width='250' border='0' cellpadding='0' cellspacing='0'><tr>";

if($complete === $target) 
{echo "<td><img src='http://www.smokeyvstheworld.com/wp-content/uploads/2012/05/completed.gif' style='width:200px;height:24px;'></td>";}
elseif($complete == "0")
{echo "<td><img src='http://www.smokeyvstheworld.com/wp-content/uploads/2012/05/pending.gif' style='width:200px;height:24px;'></td>";}
else
{echo "<td width=". $percentage ."%><img src='http://www.smokeyvstheworld.com/wp-content/themes/spectre/images/brown/grnbar.jpg' style='width:100%;height:12px;'></td><td width=". $whatsleft ."%><img src='http://www.smokeyvstheworld.com/wp-content/themes/spectre/images/brown/grybar.jpg' style='width:100%;height:12px;'></td>";}

echo "</tr><tr><td colspan='2'><div align='right'>". $complete ." of ". $target ." completed</div></td>
  </tr></table></li>";

endwhile;
echo "</ul>"; 
```

我页面上的相同源代码工作正常......我不知所措

您可以在以下页面和小部件中看到此功能：http: [//smokeyvstheworld.com/challenges](http://smokeyvstheworld.com/challenges)

它似乎在某一时刻切断了回声中的内容。我想我没有格式化它以显示好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T05:29:29.383

尝试这样做以找出实际问题所在。

```
print "get_post_meta({$post->ID}, 'target', true)<br />";
print get_post_meta($post->ID, 'target', true); 
```

这应该给你类似的东西

```
get_post_meta(12, 'target', true);
12000 
```

如果 12 中没有出现数字，则表示您没有添加

```
global $post; 
```

在顶部，所以它不知道 $post->ID 是什么。

如果没有出现“12000”或其他数字，则该帖子的“目标”元键实际上并未存储。您可以通过查看**wp_postmeta**表中的数据库来检查它。

祝你好运！

# python - 简单的递归二进制转换器错误

> ID：10853492
> 
> 赞同：0
> 
> 时间：2012-06-01T15:49:31.610
> 
> 标签：python, recursion, binary

```
def dec2binr(n):
    if n == 1:
        return '1' 
    else: return (str(n%2)+dec2binr(n//2))[::-1] 
```

没有 [::-1] 它返回反转的正确二进制数。[::-1] 在这种情况下不起作用 - 对于 n=40 Ii 得到：

```
011000 
```

当我期望

```
101000 
```

没有 [::-1] 我得到

```
000101 
```

这是相反的，但正确的。为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:52:43.697

您需要反转附加字符串的方式。

```
return dec2binr(n//2) + str(n%2) 
```

问题是，`n%2`将读取最低有效位，但您将其附加到字符串的左侧，这是最重要的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T15:51:55.023

之所以会发生这种情况，是因为您*在每次 return*时反转，将位弄乱了。从递归返回时不反转，或者仅在返回最终结果时反转（提示：辅助函数）。

# excel - Excel 中带有 VBA 的不明确子名称

> ID：10853494
> 
> 赞同：0
> 
> 时间：2012-06-01T15:49:39.050
> 
> 标签：excel, vba, ambiguous

这个子名称有什么问题，它给我一个模棱两可的名称检测错误？

```
Public Property Get G_EtoW_Pad()
    G_EtoW_Pad = EtoW_Pad
End Property 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:54:23.017

因为 G_EtoW_Pad 已经在别处声明

# javascript - 简单的 CSS 渐变检测

> ID：10853507
> 
> 赞同：3
> 
> 时间：2012-06-01T15:50:28.597
> 
> 标签：javascript, jquery

所以我需要检测用户的浏览器是否支持 CSS 渐变，仅此而已。我会使用 Modernizr，但即使只包括梯度检测，与自己做相比也会很浪费。

据我了解，这将是如何去做；

1.  创建未添加到 DOM 的元素
2.  使用所有供应商前缀设置`background-image`为`linear-gradient`
3.  阅读`background-image`并检查`gradient`，看看它是否仍然存在

但我无法弄清楚 Modernizr 的来源，他们在这方面所做的核心是什么？所以我可以自己做。[http://modernizr.com/download/#-cssgradients-prefixes](http://modernizr.com/download/#-cssgradients-prefixes)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-02T00:40:47.433

只是添加我使用的确切代码，以供参考。这里是：

```
var mElem = document.createElement('modern'),
    mStyle = mElem.style;

mStyle.backgroundImage = "linear-gradient(left top, #9f9, white)";
mStyle.backgroundImage = "-o-linear-gradient(left top, #9f9, white)";
mStyle.backgroundImage = "-moz-linear-gradient(left top, #9f9, white)";
mStyle.backgroundImage = "-webkit-linear-gradient(left top, #9f9, white)";
mStyle.backgroundImage = "-ms-linear-gradient(left top, #9f9, white)";
mStyle.backgroundImage = "-webkit-gradient(linear, left top, right bottom, from(#9f9), to(white))";

if (mStyle.backgroundImage.indexOf("gradient") == -1) alert("Gradients are not available. Get a better browser and try again."); 
```

它的工作方式与 Modernizr 的实现完全相同，但我只是手动写出了各种渐变，而不是自动完成。对于这么小的特征检测，没有必要自动完成。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T15:57:35.707

他们的测试非常基础，您可以提取它：

```
 function supports_gradients() {
    /**
     * For CSS Gradients syntax, please see:
     * webkit.org/blog/175/introducing-css-gradients/
     * developer.mozilla.org/en/CSS/-moz-linear-gradient
     * developer.mozilla.org/en/CSS/-moz-radial-gradient
     * dev.w3.org/csswg/css3-images/#gradients-
     */

    var str1 = 'background-image:',
        str2 = 'gradient(linear,left top,right bottom,from(#9f9),to(white));',
        str3 = 'linear-gradient(left top,#9f9, white);';

    setCss(
         // legacy webkit syntax (FIXME: remove when syntax not in use anymore)
          (str1 + '-webkit- '.split(' ').join(str2 + str1)
         // standard syntax             // trailing 'background-image:'
          + prefixes.join(str3 + str1)).slice(0, -str1.length)
    );

    return contains(mStyle.backgroundImage, 'gradient');
}; 
```

为此，您还必须提取`contains()`，`setCss()`除非您有自己的这些方法版本（例如，来自 jQuery）。

# asp.net-mvc - MVC3 (Razor) 将模型数据从视图传递到控制器

> ID：10853508
> 
> 赞同：3
> 
> 时间：2012-06-01T15:50:35.507
> 
> 标签：asp.net-mvc, list, razor

我需要知道是否有办法将视图（Razor 引擎）的模型（或其一部分，即其后的搜索查询）数据传递给控制器​​。

为了更好地解释我必须做什么，这是感兴趣的代码：

看法：

```
@model IEnumerable<MvcMovie.Models.Movie>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

...
@foreach (var item in Model) { ...}
...

@Html.ActionLink("Search", "SearchIndex")
@Html.ActionLink("Create Document", "createDoc"/*, new { id = Model.ToList() }*/) 
```

我想通过

```
@model IEnumerable<MvcMovie.Models.Movie> 
```

在第一行（= foreach 指令中使用的模型）向控制器“createDoc”创建与视图动态绑定的报表文档。

我尝试了一切：我尝试使用 ViewData (VIEW: ViewData["data"]=Model , CONTROLLER List movies= ViewData["data"])，我同样尝试了 TempData，我尝试将模型作为 routeValues 传递给ActionLink（如您所见：new{ id= Model.toList() }），但没有任何效果。

甚至有可能做我想做的事吗？

谁能帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:54:34.680

你的模型不应该是`IEnumerable<MvcMovie.Models.Movie>` 它应该是一个类，比如说`SearchMovieModel`，`IEnumerable<MvcMovie.Models.Movie> Movies`它的属性之一。

如果你想要一个搜索模型，这样的东西是合适的：

```
public class SearchMovieModel{
    public IEnumerable<MvcMovie.Models.Movie> Movies {get;set;}
    public string SearchString {get;set;}
} 
```

您在视图和控制器中引用此模型及其属性。

我想我应该在控制器中添加解析这个的方法。

在第一次调用视图时，模型不存在。您需要在控制器中创建它：

```
public ActionResult Search(){
    var model = new SearchMovieModel();
    //you also need to instantiate the null objects unless you do that in the model's constructor
    model.Movies = new List<Movie>();
    return View(model);
} 
```

要将 POST 数据“重新转换”回模型，您需要指定模型和方法：

```
[HttpPost]
public ActionResult Search(SearchMovieModel model){
    if (ModelState.IsValid){
        //populate your IEnumerable<Movie> here.
        return View(model);
    }
    // the complex collection will not be parsed back into the model.  You will need to repopulate it.
    model.Movies = new List<Movie>();
    return View(model);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:19:52.010

我认为那知道你想要什么......但是这段代码

```
@Html.ActionLink("Create Document", "createDoc", new { id = Model.ToList() }) 
```

你的html是..

```
<a href="/test/createDoc?id=System.Collections.Generic.List%601%5BMvcMovie.Models.Movie%5D">Create Document</a> 
```

那是因为是呈现类型而不是数据

解决方案

1.  定义过滤器模型以再次进行搜索（[jeremy-holovacs](https://stackoverflow.com/users/610217/jeremy-holovacs)和我的推荐）为什么再次向服务器询问相同的数据？因为如果有人分享那个链接......你可以想象结果是什么，甚至注入你的应用程序将生成的假数据

2.  将数据序列化为 json，例如将其转发到控制器

# c# - 当按钮按下应用程序时播放声音

> ID：10853512
> 
> 赞同：0
> 
> 时间：2012-06-01T15:50:48.363
> 
> 标签：c#, wpf, xaml

我有一个应该在触摸屏上使用的 WPF 应用程序。我被要求在屏幕上按下按钮时播放整个应用程序的声音。我的想法是创建一个样式来做到这一点，在我的应用程序中包含资源字典。它工作得很好。但是，这种风格在一个单独的 DLL 中，我希望我的主应用程序更改声音文件的路径（下面的 BoutonClickSound Url）。但我找不到办法做到这一点。我尝试了一些丑陋的事情，例如：

```
 System.Windows.Application.Current.Resources.MergedDictionaries[0]["BoutonClickSound"] = new Uri(m_MainVM.ButClickSoundPath);
System.Windows.Application.Current.Resources.MergedDictionaries[0].MergedDictionaries[0]["BoutonClickSound"] = new Uri(m_MainVM.ButClickSoundPath); 
```

但他们似乎都没有工作......

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:primitives="clr-namespace:System.Windows.Controls.Primitives;assembly=PresentationFramework"
                xmlns:sys="clr-namespace:System;assembly=System">

<sys:Uri x:Key="BoutonClickSound">c:\buttonclick.wav</sys:Uri>

<Style TargetType="{x:Type FrameworkElement}"  x:Key="SoundButton">
    <Style.Triggers>
        <EventTrigger RoutedEvent="PreviewMouseDown">
            <SoundPlayerAction x:Name="SoundPlayer" Source="{DynamicResource BoutonClickSound}" />
        </EventTrigger>
    </Style.Triggers>
</Style>

<Style TargetType="{x:Type primitives:Selector}"  x:Key="SoundSelectionChange">
    <Style.Triggers>
        <EventTrigger RoutedEvent="SelectionChanged">
            <SoundPlayerAction x:Name="SoundPlayer" Source="{DynamicResource BoutonClickSound}" />
        </EventTrigger>
    </Style.Triggers>
</Style> 
```

知道怎么做吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:08:52.223

只需声明一个具有相同键的本地资源。

如果您希望它在您的应用程序中全局使用，您可以在从库中包含MergedDictionary**后将其添加到 MergedDictionary。**

像这样添加另一个条目：

```
<sys:Uri x:Key="BoutonClickSound">c:\differentfile.wav</sys:Uri> 
```

它应该使您的样式改为使用该文件。

**编辑：**

要在代码隐藏中设置资源，首先必须将其添加到本地资源字典中：

```
Resources.Add("BoutonClickSound", new Uri("your uri here")); 
```

添加后，如果以后要更改，不能重新添加，必须修改：

```
Resources["BoutonClickSound"] = new Uri("your uri here"); 
```

# sql-server-2005 - EF 4.3 DB 第一个模型不导入关联

> ID：10853518
> 
> 赞同：0
> 
> 时间：2012-06-01T15:50:58.380
> 
> 标签：sql-server-2005, sql-server-2008-r2, entity-framework-4.3

我们将数据库从 SQL 2005 实例移动到新的 SQL 2008r2 服务器。我们将应用程序中的连接字符串更改为指向新数据库，甚至修改了 2005 年到 2008 年的 ProviderManifestToken。一切正常，直到我们尝试将数据库中的实体添加到现有的 edmx 模型中。我正在使用“从数据库更新模型”向导将表添加到 edmx 图中。这些表将出现在图表中，但只有一些表具有它们的关联和/或外键导入。如果我切换连接字符串以指向旧的 2005 sql 实例，则所有内容都正确导入并且存在关联。如有必要，我很乐意提供更多详细信息。我根本找不到这种模式。是什么赋予了？

更新：我创建了一个新项目，添加了一个 edmx，将其指向 2008r2 数据库实例，选择了我知道有关联但设计器未能获取关联的表。我需要在 SQL 服务器上安装什么东西才能让 EF 工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-04T13:41:50.153

它现在正在工作。从 web.config 中删除连接字符串，然后使用“从数据库更新模型”并通过“添加新连接”对话框指向新服务器上的数据库似乎可以使其正常运行。如果这停止工作，我会回帖。

更新：原来我有两个问题。第二个是我们数据库中的一张表在同一列上有两个几乎相同的冗余索引；一个聚集的 PK 索引和一个唯一的非聚集索引。因此，每当我创建指向该表的外键时，数据库都会选择唯一的非聚集索引来强制执行约束（为什么？我不知道）。但是实体框架不喜欢它，不会创建甚至识别外键关联。我不得不删除额外的非聚集索引并重新创建所有外键，以便它们指向聚集索引。完成后，我从数据库中更新了我的模型，并且所有关联都存在。

这是我用来检查我的外键使用了哪些索引的 SQL 查询： 有问题的 FK`SELECT * FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS C ORDER BY CONSTRAINT_NAME` 的`UNIQUE_CONSTRAINT_NAME`列应该指向一个集群 PK 才能工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:03:45.997

您是如何将数据库移至 2008 Server 的？听起来部分或全部关系/约束没有迁移。这可以解释为什么当您指向 2008 数据库时关联没有出现。

# javascript - JS 在第一次访问时重定向到启动页面？

> ID：10853523
> 
> 赞同：2
> 
> 时间：2012-06-01T15:51:24.220
> 
> 标签：javascript, redirect, cookies

我正在尝试修改一些代码，以在用户第一次访问时将其引导至“创建帐户”挤压页面。我想我已经接近了，但我需要一点帮助。关于我哪里出错的任何建议？

```
<script type="text/javascript">
$(document).ready(function() {
    // check cookie
    var visited = $.cookie("visited")

    if (visited == null) {
        window.location = "content/content-article.asp?ArticleID=4998"
        $.cookie('visited', 'yes'); 
        alert($.cookie("visited"));         
    }

    // set cookie
    $.cookie('visited', 'yes', { expires: 10,000, path: '/' });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:17:17.037

好的 - 我一直在挖掘并找到了一个不同的脚本。这是以防其他人尝试做同样的事情：

```
<script type="text/javascript">
function redirect(){
var thecookie = readCookie('doRedirect');
if(!thecookie){window.location = 'http://yournetwork.com/splash';
}}function createCookie(name,value,days){if (days){var date = new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires = "; expires="+date.toGMTString();}else var expires = "";document.cookie = name+"="+value+expires+"; path=/";}function readCookie(name){var nameEQ = name + "=";var ca = document.cookie.split(';');for(var i=0;i < ca.length;i++){var c = ca[i];while (c.charAt(0)==' ') c = c.substring(1,c.length);if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);}return null;}window.onload = function(){redirect();createCookie('doRedirect','true','999');} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:59:55.003

试试这个：

```
$(document).ready(function() {
    // check cookie
    var visited = $.cookie("visited")

    // set cookie
    $.cookie('visited', 'yes', { expires: 10,000, path: '/' });

    if (visited == null) {
        $.cookie('visited', 'yes'); 
        alert($.cookie("visited"));         
        window.location = "content/content-article.asp?ArticleID=4998"
    }
}); 
```

执行代码后将位置更改为另一个站点

# objective-c - 使“完成”按钮在 TextField 键盘上工作

> ID：10853524
> 
> 赞同：1
> 
> 时间：2012-06-01T15:51:26.403
> 
> 标签：objective-c, ios, user-interface

添加文本字段时，键盘会正确打开，但是我无法让完成按钮正常工作。我知道您还有其他类似的帖子，但是无论出于何种原因，它们似乎对我不起作用。

当我说“不工作”时，我的意思是键盘没有关闭。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:57:18.600

添加这个并告诉我：

```
- (BOOL)textFieldShouldReturn:(UITextField*)aTextField
{
    [aTextField resignFirstResponder];
    return YES;
} 
```

请记住将 viewController 添加为文本字段的委托

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:04:42.450

我相信这就是你要找的。它是一个 UITextFieldDelegate 回调，只要在键盘上使用 Done/Return 按钮，就会调用它。

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    [textField resignFirstResponder];
    return YES;
} 
```

您需要在界面中使用委托

```
@interface Class : UIViewController <UITextFieldDelegate> 
```

如果您的文本字段位于使用 FormSheet 样式的 ModalViewController 中，您也需要它。

```
- (BOOL)disablesAutomaticKeyboardDismissal
{
    return NO;
} 
```

# arrays - 如何访问 JSON 对象值

> ID：10853526
> 
> 赞同：0
> 
> 时间：2012-06-01T15:51:31.063
> 
> 标签：arrays, json, perl, object

我有这个`print STDERR Dumper $data`： 我想访问**Dough**我该怎么做？ 我试过但有语法错误。
`$VAR1 = '{
"url_date":null,
"footer":null,"id":"18",
"authors":[
{"initials":"B.","last_name":"Best","has":0,"id":12},
{"initials":"D.","last_name":"Dough","has":1,"id":10},
{"initials":"F.","last_name":"Fuss","has":0,"id":15,}
],
"url_headline":null,
"headline":"test"}';`
 **`print STDERR Dumper $data.authors[1].last_name`**

 **第二次尝试
`use JSON::XS qw( decode_json );
my $coder = JSON::XS->new->utf8->pretty->allow_nonref;
my $p = $coder->decode ($.data);`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:16:11.767

你有一个字符串。字符串包含的是有效的 JSON 和有效的 YAML。您需要解析 JSON，最好的方法是使用现有的解析器，例如[JSON::XS](http://search.cpan.org/perldoc?JSON%3a%3aXS)。

```
use JSON::XS qw( decode_json );
my $data = decode_json($data_json);
$data->{authors}[1]{last_name} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:11:31.490

最好的方法是首先使用[`JSON`](http://p3rl.org/JSON)模块将字符串解码为 Perl 哈希引用，然后使用常规 Perl 的哈希访问语法`$data->{"authors"}[1]{"last_name"}`。**

# objective-c - 锁定一个对象不被多个线程访问 - Objective-C

> ID：10853529
> 
> 赞同：37
> 
> 时间：2012-06-01T15:51:37.620
> 
> 标签：objective-c, ios, multithreading

我对 Objective-C 中的线程安全有疑问。我已经阅读了其他几个答案，一些Apple文档，但对此仍有一些疑问，所以我想问我自己的问题。

我的问题是**三个方面**：

假设我有一个数组，`NSMutableArray *myAwesomeArray;`

**折叠 1：**

如果我弄错了，现在纠正我，但据我了解，使用`@synchronized(myAwesomeArray){...}`将阻止两个线程访问同一个代码块。所以，基本上，如果我有类似的东西：

```
-(void)doSomething {
    @synchronized(myAwesomeArray) {
        //some read/write operation on myAwesomeArray
    }
} 
```

那么，如果两个线程同时访问**同****一个**方法，那么该代码块将是线程安全的。我猜我已经正确理解了这部分。

 ****折叠 2：**

`myAwesomeArray`如果被多个线程从不同的方法访问，我该怎么办？如果我有类似的东西：

```
- (void)readFromArrayAccessedByThreadOne {
    //thread 1 reads from myAwesomeArray
}

- (void)writeToArrayAccessedByThreadTwo {
    //thread 2 writes to myAwesomeArray
} 
```

现在，这两种方法都由两个不同的线程同时访问。我如何确保`myAwesomeArray`不会有问题？我是否使用 NSLock 或 NSRecursiveLock 之类的东西？

**折叠 3：**

现在，在上述两种情况下，`myAwesomeArray`内存中是一个 iVar。如果我有一个数据库文件，我并不总是保存在内存中怎么办。`databaseManagerInstance`每当我想执行数据库操作时，我都会创建一个，并在完成后释放它。因此，基本上，不同的类可以访问数据库。每个类都创建自己的实例`DatabaseManger`，但基本上，它们都使用相同的单个数据库文件。在这种情况下，如何确保数据不会因竞争条件而损坏？

这将帮助我理清一些基本面。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-01T16:17:06.453

**折叠 1** 通常你对做什么的理解`@synchronized`是正确的。但是，从技术上讲，它不会使任何代码“线程安全”。它可以防止不同的线程同时获取相同的锁，但是您需要确保在执行关键部分时始终使用相同的同步令牌。如果你不这样做，你仍然会发现自己处于两个线程同时执行临界区的情况。[检查文档](http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/Multithreading/ThreadSafety/ThreadSafety.html#//apple_ref/doc/uid/10000057i-CH8-SW3)。

**折叠 2** 大多数人可能会建议您使用 NSRecursiveLock。如果我是你，我会使用 GCD。[这是一个很棒的文档，展示了如何从线程编程迁移到 GCD 编程](http://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/ThreadMigration/ThreadMigration.html#//apple_ref/doc/uid/TP40008091-CH105-SW3)，我认为这种解决问题的方法比基于 NSLock 的方法要好得多。简而言之，您创建一个串行队列并将您的任务分派到该队列中。这样可以确保您的关键部分是按顺序处理的，因此在任何给定时间只执行一个关键部分。

**折叠 3** 这与*折叠 2*相同，只是更具体。数据库是一种资源，在许多方面它与数组或任何其他东西相同。[如果您想在数据库编程上下文中查看基于 GCD 的方法，请查看 fmdb implementation](https://github.com/ccgus/fmdb)。它完全符合我在*Fold2*中的描述。

*作为Fold 3*的旁注，我不认为每次要使用数据库时都实例化*DatabaseManager然后释放它是正确的方法。*我认为您应该创建一个单一的数据库连接并通过您的应用程序会话保留它。这样更容易管理它。同样，fmdb 是一个很好的例子，说明了如何实现这一点。

**编辑** 如果不想使用 GCD，那么是的，您将需要使用某种锁定机制，是的，`NSRecursiveLock`如果您在方法中使用递归，将防止死锁，所以这是一个不错的选择（它被 使用`@synchronized`）。但是，可能有一个问题。如果许多线程可能会等待相同的资源并且它们获得访问的顺序是相关的，那么`NSRecursiveLock`是不够的。您仍然可以使用 来处理这种情况`NSCondition`，但相信我，在这种情况下使用 GCD 会节省大量时间。如果线程的顺序不相关，则使用锁是安全的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-06-17T23:27:30.050

与**Swift 3** in [WWDC 2016 Session Session 720 Concurrent Programming With GCD in Swift 3](https://developer.apple.com/videos/play/wwdc2016/720/)一样，您应该使用`queue`

```
class MyObject {
  private let internalState: Int
  private let internalQueue: DispatchQueue

  var state: Int {
    get {
      return internalQueue.sync { internalState }
    }

    set (newValue) {
      internalQueue.sync { internalState = newValue }
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:06:34.080

子类 NSMutableArray 为访问器（读取和写入）方法提供锁定。就像是：

```
@interface MySafeMutableArray : NSMutableArray { NSRecursiveLock *lock; } @end

@implementation MySafeMutableArray

- (void)addObject:(id)obj {
  [self.lock lock];
  [super addObject: obj];
  [self.lock unlock];
}

// ...
@end 
```

这种方法将锁定封装为数组的一部分。用户不需要更改他们的调用（但可能需要注意，如果访问时间紧迫，他们可能会阻止/等待访问）。这种方法的一个显着优势是，如果您决定不使用锁，您可以重新实现 MySafeMutableArray 以使用调度队列 - 或任何最适合您的特定问题的方法。例如，您可以将 addObject 实现为：

```
- (void)addObject:(id)obj {
    dispatch_sync (self.queue, ^{ [super addObject: obj] });
} 
```

注意：如果使用锁，你肯定需要 NSRecursiveLock，而不是 NSLock，因为你不知道 addObject 的 Objective-C 实现等本身是递归的。**

# oop - 抑制面向对象语言中的方法返回

> ID：10853530
> 
> 赞同：0
> 
> 时间：2012-06-01T15:51:42.360
> 
> 标签：oop, syntax, constructor, syntactic-sugar

我将首先说这绝不是一个主要问题，更多的是我在编程语言设计方面没有真正听说过的事情，我想知道是否有人有任何有趣的解决方案。

问题的症结在于此。有时在面向对象的语言中，我希望能够通过其中一种方法修改对象，但**返回对象本身**而不是该方法返回的内容。

举一个java例子：

```
class MyClass{
    public MyClass(List<Integer> list){
        //do constructor stuff
    }

    public MyClass(Integer i){
        //what I would like to be able to do
        this((new LinkedList<Integer>).add(i));
    }
} 
```

我无法在第二个构造函数中创建临时列表，因为 this() 必须是第一行。显然有很多方法可以通过改变实现来做到这一点，比如创建一个返回对象的 add() 方法，使其成为构造对象的函数的责任以生成列表等。

但是，考虑到很多时候您不能/不想修改或创建子类（对于 LinkedList），并且您可能不想混淆调用代码，能够修改并返回样式中的对象的 ++x 可能真的很有用。类似于 `this(#(new LinkedList).add(i)`表示您要反对的东西，而不是方法返回。有谁知道允许这是一些简洁的句法方式的语言？如果没有，这会有用吗，还是我在这里遗漏了一些基本的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:34:51.093

这不行吗？

```
public class MyClass{
    public MyClass(List<Integer> list){
        //do constructor stuff
    }

    public static MyClass create(Integer i) {
        List<Integer> list = new new LinkedList<Integer>();
        list.add(i);
        MyClass myClass = new MyClass(list);
        return myClass;
    }
} 
```

这是一种常见的设计模式，称为[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:10:59.087

我认为解决这个问题的最干净的方法是从构造函数中调用一个初始化方法。

类 MyClass { public MyClass(List list){ init(list); }

```
public MyClass(Integer i){
    LinkedList<Integer> list = new LinkedList<Integer>();
    list.add(i);
    init(list);
}

protected init(List<Integer> list)
{
    // do init stuff here
} 
```

}

# android - 在 Android 中检查空电子邮件字符串时出错

> ID：10853534
> 
> 赞同：1
> 
> 时间：2012-06-01T15:51:48.067
> 
> 标签：android, string, validation

我有一个包含两个 EditText 框、一个电子邮件和一个纯文本的活动。在允许用户继续之前，我想检查邮箱是否为空，并且是否与电子邮件模式匹配。模式匹配器部分有效，但空字符串部分无效。

我在用户输入数据时进行验证，然后根据电子邮件是否正确将两个按钮设置为可点击或不可点击。但是，如果该框为空，则它允许用户在不应该按下按钮时按下该按钮。当框中有文本时，它只让用户在匹配电子邮件模式时按下按钮是正确的。

我的文字修改后的方法：

```
 public void afterTextChanged(Editable s) {
            // TODO Auto-generated method stub
            String enteredEmail = email.getText().toString();

            if (validateEmail(enteredEmail) == true) {
                image1.setImageResource(R.drawable.greentick);
                play.setClickable(true);
                play.setFocusable(true);
                existingUser.setClickable(true);
                existingUser.setFocusable(true);
            }

            else {
                System.out.println("Invalid");
                image1.setImageResource(R.drawable.redcross);
                play.setClickable(false);
                play.setFocusable(false);
                existingUser.setClickable(false);
                existingUser.setFocusable(false);
            }
        } 
```

还有我的 validateEmail() 方法：

```
public boolean validateEmail(String email) {

    boolean validated = false;
    if (android.util.Patterns.EMAIL_ADDRESS.matcher(email).matches() && (! email.equals("")) ) {
        validated = true;           
    }

    else {
        validated = false;
    }   
    return validated;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:02:25.277

`TextChanged`如果用户没有输入任何内容，则不会触发，因为文本没有更改...您应该默认禁用该按钮。

您是否尝试过调试，因为这应该向您显示事件没有触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:56:09.427

这就是我验证电子邮件字段（正则表达式）的方式：

```
private Boolean validateEmail(String email)
{
    return email.matches("^[-!#$%&'*+/0-9=?A-Z^_a-z{|}~](\\.?[-!#$%&'*+/0-9=?A-Z^_a-z{|}~])*@[a-zA-Z](-?[a-zA-Z0-9])*(\\.[a-zA-Z](-?[a-zA-Z0-9])*)+$");
} 
```

仅供参考：我不记得了，你可能需要 org.apache.commons.lang3.stringutils

# coldfusion - cfhttp 通过安全连接

> ID：10853535
> 
> 赞同：0
> 
> 时间：2012-06-01T15:51:53.813
> 
> 标签：coldfusion, coldfusion-8

我在使用 cfhttp 通过安全连接连接到 Web 服务时遇到问题。我不久前将证书安装到服务器密钥库，一切正常。今天早上它已经停止工作了。证书还有一年的时间，所以它没有过期。我没有对服务器进行任何更改。我检查了 cacerts 文件以确保证书仍在商店中并且在那里。任何人都知道可能发生了什么导致这种情况？

我发现了问题。我最近调用的服务更改了他们的内部 IP 地址。这改变了对我来说看起来像相同证书但实际上不同的证书。保存并安装了证书，我们又开始营业了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:58:59.147

有几个原因可能会导致您的问题。不幸的是，除了“停止工作”之外，没有更多关于正在发生的事情（错误消息、转储等）的细节，我们无法真正帮助您。请提供 CFTTP 范围的转储，包括状态代码和消息。如果是证书问题，我希望看到“peer not authenticated”响应消息。否则，可能是路由（防火墙）有问题，或者目标服务器可能已启动 HTTP 压缩，这需要额外的解决方法才能通过 CFTTP 访问。

在看到错误是什么后，我们将能够缩小范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T17:53:49.390

在这种情况下，我总是做的第一件事是自己登录服务器桌面并检查分辨率、跃点、IP 地址等。

例如，如果另一端的服务器有一个新的 IP 地址，他们将更新 DNS - 但 CF 可能在时间过去或实例重新启动之前无法获得该新 IP。它的寿命很长（可以调整，但默认情况下很长）。

或者，您的内部 DNS 服务器可能会失败。或者，如果服务器是本地的（在同一网络内）但 DNS 设置不正确，那么当您需要“内部”地址时，您可能会获得“外部”地址。

HTTP 压缩（由 user1431209 提到）也是检查的好东西 - 也检查中间证书。这就是我得到的 ：）

# struts - Struts Form bean在提交时不重置表单字段

> ID：10853541
> 
> 赞同：0
> 
> 时间：2012-06-01T15:52:08.053
> 
> 标签：struts, struts-1

如何防止表单 bean 字段在提交验证时被重置。这里的问题是，这个表单域不是 jsp 上的输入域。它显示为像这样的普通html文本..

```
 <div class="label">
          <fmt:message bundle="${labels}" key="gender" />
 </div>
 <div class="data">
         <bean:write property="gender" name="infoForm"/>
 </div> 
```

发生的事情是，当我单击提交按钮时，如果有任何验证错误，所有其他输入字段都会再次填充，但没有显示这个性别字段。

我的猜测是，由于此处的性别属性不是输入字段，因此在验证之前或之后重置表单时，不会填充性别值。我对么？如果是这样，我该怎么做才能不重置这一特定字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:25:47.273

如果此信息来自前一页中的表单（例如，如果您正在实现一个向导，其中一个大表单被拆分为多个页面），那么您可以使用表单隐藏字段来存储信息并重新提交它随后的每一个表格。

如果这只是来自服务器的信息（例如，来自数据库，或从其他输入字段计算），那么您应该简单地再次从数据库中获取信息（或重新计算）并将其再次放入表单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:58:46.797

为了解决这个问题，我添加了一个具有相同参数的隐藏表单字段......

```
 <html:hidden property="gender" name="infoForm"/> 
```

在验证中重置后保留字段值...

# jquery - 在 Rails 3 会话中，如何保存 jquery 状态？

> ID：10853542
> 
> 赞同：0
> 
> 时间：2012-06-01T15:52:09.240
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, forms

我有一个使用此 railscast 创建的多步骤表单（向导）：[http:](http://railscasts.com/episodes/217-multistep-forms) //railscasts.com/episodes/217-multistep-forms 。

会话用于记住表单中输入的所有信息。在一个表单页面上，我有一个包含 3 个选项的选择框，每个选项在页面上显示不同的表单字段。选项有：“零售和办公室”（零售和办公室字段均显示）、“仅办公室”（仅显示办公室字段）、“仅零售”（仅显示零售字段）。

我使用 jquery 根据在选择框中选择的选项来显示和隐藏这些字段。所以这就是我遇到的问题。例如，假设我从选择框中选择了“仅限零售”。办公区域消失，只显示零售区域。我在字段中输入信息，然后继续下一步。但是，当我点击后退按钮返回此步骤进行编辑时，会显示办公室和零售字段。选择框中的“仅限零售”选项保持不变，我输入的信息仍然存在，但两个字段都显示了。

我假设问题出在 jquery 上，而不是 rails 会话。这与cookie有关吗？我该如何纠正？

**应用程序.js**

```
$(document).ready(function() {

$("#spaces").change(function(){
if ($("#spaces").val()=="Retail only") {$("#office_field").hide(); $("#retail_field").show(); }
if ($("#spaces").val()=="Office only") {$("#office_field").show(); $("#retail_field").hide(); }
if ($("#spaces").val()=="Retail and Office") {$("#office_field").show(); $("#retail_field").show(); }

}); 
```

**uploads_controller.rb**

```
class UploadsController < ApplicationController
  def index
    @uploads = Upload.all
  end

  def show
    @upload = Upload.find(params[:id])
  end

  def new
    session[:upload_params] ||= {}
    @upload = Upload.new(session[:upload_params])
    @upload.current_step = session[:upload_step]
  end

  def create
    session[:upload_params].deep_merge!(params[:upload]) if params[:upload]
    @upload = Upload.new(session[:upload_params])
    @upload.current_step = session[:upload_step]
    if @upload.valid?
        if params[:back_button]
        @upload.previous_step
    elsif @upload.last_step?
        @upload.save if @upload.all_valid?
        else
        @upload.next_step
        end
        session[:upload_step] = @upload.current_step
    end
    if @upload.new_record?
        render "new"
    else
        session[:upload_step] = session[:upload_params] = nil
        flash[:notice] = "Upload saved"
        redirect_to @upload
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:00:03.313

在您的 application.js 中，您只有一个“更改”事件侦听器。您需要的是触发您的代码以显示/隐藏特定输入仅绑定到#spaces 的“更改”事件。

```
if ($("#spaces").val()=="Retail only") {$("#office_field").hide(); $("#retail_field").show(); }
if ($("#spaces").val()=="Office only") {$("#office_field").show(); $("#retail_field").hide(); }
if ($("#spaces").val()=="Retail and Office") {$("#office_field").show(); $("#retail_field").show(); } 
```

基本上，您需要将此代码移动到一个函数中，并在页面加载和#spaces“更改”时调用此函数：

```
$(document).ready(function() {

  function retail_office_fields() {
    if ($("#spaces").val()=="Retail only") {$("#office_field").hide(); $("#retail_field").show(); }
    if ($("#spaces").val()=="Office only") {$("#office_field").show(); $("#retail_field").hide(); }
    if ($("#spaces").val()=="Retail and Office") {$("#office_field").show(); $("#retail_field").show(); }
  }

  retail_office_fields();

  $("#spaces").change(retail_office_fields);
}); 
```

它与会话无关。

# javascript - jQuery $.each 变量作用域

> ID：10853547
> 
> 赞同：7
> 
> 时间：2012-06-01T15:52:31.690
> 
> 标签：javascript, jquery

**jQuery**`$.each`中的循环存在范围问题。如何在函数中获取全局变量以在循环中设置或至少从中传递一些东西？

 **```
var some_function = function() {

    // false by default
    var something = false;

    $.each(array, function(key, val) { 
       if (val == 'something')
       {
         // even if one item evaluates true I need to check outside of the loop
         something = true;
       }
    });

    if (something == true)
    {
       // do something else, but always false
    }
} 
```

因为我需要评估数组中的所有项目，**如果只有一个是** `true`，那么在`$.each`.

**更新**

```
$(document).ready(function () {
    something(); 
    $(':radio').trigger('change');
)}; 
```

好的，这是实际的代码。它在底部发出**“假”**警报，然后两次发出**“你好”**警报，就好像它的顺序相反。

```
var something = function() {   

        var q_radios = {
            'radio1'        : 'radio1_selector', 
            'radio2'        : 'radio2_selector',  
        };
        var show_me = false;

        $.each(q_radios, function(name, q_selector) {  
            $('input:radio[name=' + q_selector + ']').change(function() {  
                    show_me = true; 
                    alert('hello'); 
            }); 
        });   

        if (show_me == true)
        {
            alert('yes');
        }
        else
        {
            alert('false');
        }

}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:58:25.380

或多或少，正是您现在所拥有的……您只需将数据传递给函数（通过让它接受一个参数）。看[一个活生生的例子](http://jsfiddle.net/Hf3A8/2/)。

```
var some_function = function(array) { 

    // false by default
    var something = false;
    $.each(array, function(key, val) {
        if (val == 'something') {
            something = true;
        }
    });

    if (something == true) {
        alert("There was a something");
    } else {
        alert("There wasn't a something");
    }
};

some_function([1,2,3]);
some_function([1,"something",3]);
​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:02:19.167

我推荐原生数组迭代方法：

```
var something = array.some(function ( val ) {
   return val === 'something';
}); 
```

在这里，`something`如果`true`至少一个数组元素具有值，则为`'something'`。**

# c# - 使用 Request.Form[0] 时表单值被截断

> ID：10853549
> 
> 赞同：0
> 
> 时间：2012-06-01T15:52:35.407
> 
> 标签：c#, asp.net, httprequest

我在 .NET Web 应用程序中有一个 JSON RPC 处理程序，并向其发布了一个 GWT 表单，其中一个文本框具有以下值：

*你如何定义你今天的压力水平（1=最小，10=最大）？*

当我将表单发布到服务器时，FireBug 显示 JSON 字符串已被截断为：

*最少，10=最多）？*

但是，当我在服务器的 RPC 处理程序中放置一个断点并查看 HttpRequest.Form 属性时，它仍然具有完整的字符串。但是，一旦我尝试通过 request.Form[0] 访问名称-值对，我就会得到截断的字符串，显然我的 JSON 编码器无法解码该字符串。任何想法为什么？编辑：这是方法：

```
 public override string GetMethodName(HttpRequest request) {
        if (RpcUtils.IsGet(request)) {
            if (request.PathInfo.Length == 0) {
                return null;
            }
            string functionName = request.PathInfo.Substring(1);
            return functionName;
        } else if (RpcUtils.IsPost(request)) {
            if (request.PathInfo.Length > 0) {
                // Not really a proper JSON-RPC request, but handle it anyway
                string functionName = request.PathInfo.Substring(1);
                return functionName;
            } else {
                // Real JSON-RPC request
                var jsonRpc = (Dictionary<string, object>)this.Decode(request.Form[0]);
                string functionName = (string)jsonRpc["method"];
                return functionName;
            }
        } else {
            return null;
        }
    } 
```

问题出在：

**var jsonRpc = (字典)this.Decode(request.Form[0]);**

# c++ - 是否有可以在控制台中设置颜色的 winapi 调用，如“color xx”命令？

> ID：10853558
> 
> 赞同：0
> 
> 时间：2012-06-01T15:52:57.067
> 
> 标签：c++, winapi, colors, console

例如，我知道我可以这样做`system("color 1E")`，但我很好奇是否有一个 api 调用可以做到这一点，因为这些更快，我需要像`color`这样为所有控制台着色。我知道的只有 api 调用，`SetConsoleTextAttribute()`但这只是为使用后编写的文本着色。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T17:38:17.703

我调试了 cmd.exe（在 Windows 7 上），这是“颜色”命令的作用：

```
HANDLE hConsole = GetStdHandle(STD_OUTPUT_HANDLE);
CONSOLE_SCREEN_BUFFER_INFO csBufferInfo;
GetConsoleScreenBufferInfo(hConsole, &csBufferInfo);
DWORD dwLength = csBufferInfo.dwSize.X * csBufferInfo.dwSize.Y;
COORD dwOrigin = { 0 };
DWORD dwWritten = 0;
FillConsoleOutputAttribute(hConsole, wAttribute, dwLength, dwOrigin, &dwWritten);
SetConsoleTextAttribute(hConsole, wAttribute); 
```

在哪里`wAttribute`保存你想要的颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:08:33.410

[WriteConsoleOutputAttribute](http://msdn.microsoft.com/en-us/library/ms687407%28v=VS.85%29.aspx)可用于将字符属性写入屏幕缓冲区中的连续单元格。这将更改屏幕缓冲区中每个单元格的属性，而无需修改现有文本。

```
#include <windows.h>

int main(int argc, char* argv[])
{
        CONSOLE_SCREEN_BUFFER_INFO sb;
        HANDLE h = GetStdHandle(STD_OUTPUT_HANDLE);
        WORD attr = BACKGROUND_RED | BACKGROUND_GREEN | BACKGROUND_BLUE;
        COORD c = {0};
        int row, col;
        GetConsoleScreenBufferInfo(h, &sb);

        for(row = 0; row < sb.dwSize.Y; row++)
        {
                c.Y = row;
                for(col = 0; col < sb.dwSize.X; col++)
                {
                        c.X = col;
                        WriteConsoleOutputAttribute(h, &attr, 1, c, NULL);
                }
        }
} 
```

请注意，您还需要使用`SetConsoleTextAttribute()`，因为编写的新文本仍将使用旧属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:07:09.660

我从多个来源编译了这个答案。基本思想在

[http://www.cplusplus.com/forum/beginner/5830/](http://www.cplusplus.com/forum/beginner/5830/)。

但是，他们使用 system("cls")。

S，我尝试用这里提到的技术替换 system("cls") 。[http://support.microsoft.com/kb/99261](http://support.microsoft.com/kb/99261)

结果是你所期望的。

它看起来不漂亮。但是，我认为这是一个答案。祝你好运。

# jquery - jquery - 如何替换表列值

> ID：10853561
> 
> 赞同：1
> 
> 时间：2012-06-01T15:53:07.293
> 
> 标签：jquery, jquery-ui

我是一个 jQuery 新手。我有下表 -

```
<table summary="This table lists all values in storage."> 
         <caption>Values in storage</caption>
         <tbody> 
         <tr> 
           <th scope="row">JetBlue 983</th> 
           <td>Boston (BOS)</td> 
           <td>New York (JFK)</td> 
         </tr> 
         <tr> 
           <th scope="row">JetBlue 354</th> 
           <td>San Francisco (SFO)</td> 
           <td>Los Angeles (LAX)</td> 
         </tr> 
       <tr> 
           <th scope="row">JetBlue 465</th> 
           <td>New York (JFK)</td> 
           <td>Portland (PDX)</td> 
         </tr> 
         </tbody> 
       </table> 
```

现在，我想在每次加载页面的该部分时使用 jquery 读取本地存储并填充第二列中的值。最简单的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:00:39.317

您可以使用以下方式执行此操作

我假设您将 json 编码数据保存到 LocalStorage

```
$(function{
  var data  = JSON.parse(localStorage.getItem('ITEM_KEY'));
  // data is an object now
  // find 2nd columns and populate
  $('tr td:nth-child(2)').each(function(i){

    $(this).text(data[i]);
   });
}) 
```

假设您要插入从 localStorage 中找到的相同数据。并且数据数组中的元素数与列数相同。

参考：[$.each](http://api.jquery.com/jQuery.each/)和[:nth-child 选择器](http://api.jquery.com/nth-child-selector/)

# nutch - 为 Nutch 编写插件（索引）

> ID：10853564
> 
> 赞同：-1
> 
> 时间：2012-06-01T15:53:24.543
> 
> 标签：nutch

我正在为 nutch 编写一个插件，它解析文本并根据文本创建一个新字段。为此，我正在编写的插件实现了 IndexingFilter。我正在按照[此处](http://florianhartl.com/nutch-plugin-tutorial.html)的教程进行操作（类似于 nutch wiki 中的教程）。我完全按照提到的那样进行操作，并且能够成功构建插件。但是我没有看到正在添加的新索引。好吧，我是初学者，所以我不确定我是否在寻找正确的地方。

我使用命令进行了正常爬行

```
bin/nutch crawl urls -dir crawl -depth 3 -topN 5 
```

然后我使用命令检查了 crawldb 和分段

```
bin/nutch readdb crawl/crawldb/ -dump crawlContent
bin/nutch readseg -dump crawl/segments/* segmentAllContent 
```

我没有看到这里添加的新字段。我做对了吗？或者有什么我需要运行的命令。提前致谢。

代码：

我复制了 urlmeta 插件的目录结构并进行了一些更改。

插件.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
   <plugin id="myPlugin" name="Add Field to Index"
      version="1.0.0" provider-name="your name">

    <runtime>
       <library name="myPlugin.jar">
     <export name="*"/>
       </library>
    </runtime>

    <extension id="org.apache.nutch.indexer.myPlugin"
       name="Add Field to Index"
       point="org.apache.nutch.indexer.IndexingFilter">
      <implementation id="myPlugin"
        class="org.apache.nutch.indexer.AddField"/>
    </extension>
  </plugin> 
```

构建.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
  <project name="myPlugin" default="jar">
     <import file="../build-plugin.xml"/>
  </project> 
```

其他代码与提到的链接相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-03T15:20:11.543

检查 nutch-default.xml 中 plugin.includes 的值是否包含 myPlugin，如下所示：

myPlugin|protocol-http|urlfilter-regex|parse-(text|html|js)|index-basic|query-(basic|site|url)|summary-basic|scoring-opic|urlnormalizer-(pass|regex|basic )

PS：如果您有解决方案，您可以并且应该回答您自己的问题，只需在此之后添加一些评论。

# php - SQL 查询将一列的数据拆分为多列

> ID：10853565
> 
> 赞同：0
> 
> 时间：2012-06-01T15:53:25.007
> 
> 标签：php, mysql, sql

我正在尝试使用 HTML 表构建一个 PHP 页面，该表将填充此查询的结果。请注意，我想要拆分为多个列的值最初都在同一列中......“lastvalue”这使得难以编写将输出我想要的结果的“ONE”查询。

表布局：

```
name                                    | key_                  |  lastvalue
Active Calls per T1 SL5/DI1             | activeChannels[33]    |   1
Active Calls per T1 SL5/DI2             | activeChannels[34]    |   1
Active Calls per T1 SL5/DI3             | activeChannels[35]    |   2
Active Calls per T1 SL5/DI4             | activeChannels[36]    |   1
Active Calls per T1 SL5/DI5             | activeChannels[37]    |   2
Active Calls per T1 SL5/DI6             | activeChannels[38]    |   1
Active Calls per T1 SL5/DI7             | activeChannels[39]    |   0
Active Calls per T1 SL5/DI8             | activeChannels[40]    |   0
Active Calls per T1 SL6/DI1             | activeChannels[41]    |   0
Active Calls per T1 SL6/DI2             | activeChannels[42]    |   0
Active Calls per T1 SL6/DI3             | activeChannels[43]    |   0
Active Calls per T1 SL6/DI4             | activeChannels[44]    |   0
Active Calls per T1 SL6/DI5             | activeChannels[45]    |   0
Active Calls per T1 SL6/DI6             | activeChannels[46]    |   0
Active Calls per T1 SL6/DI7             | activeChannels[47]    |   0
Active Calls per T1 SL6/DI8             | activeChannels[48]    |   0
Active Calls per T1 SL7/DI1             | activeChannels[49]    |   23
Active Calls per T1 SL7/DI2             | activeChannels[50]    |   1
Active Calls per T1 SL7/DI3             | activeChannels[51]    |   0
Active Calls per T1 SL7/DI4             | activeChannels[52]    |   9
Active Calls per T1 SL7/DI5             | activeChannels[53]    |   0
Active Calls per T1 SL7/DI6             | activeChannels[54]    |   2
Active Calls per T1 SL7/DI7             | activeChannels[55]    |   0
Active Calls per T1 SL7/DI8             | activeChannels[56]    |   0
Active Calls per T1 SL8/DI1             | activeChannels[57]    |   0
Active Calls per T1 SL8/DI2             | activeChannels[58]    |   0
Active Calls per T1 SL8/DI3             | activeChannels[59]    |   0
Active Calls per T1 SL8/DI4             | activeChannels[60]    |   0
Active Calls per T1 SL8/DI5             | activeChannels[61]    |   0
Active Calls per T1 SL8/DI6             | activeChannels[62]    |   0
Active Calls per T1 SL8/DI7             | activeChannels[63]    |   0
Active Calls per T1 SL8/DI8             | activeChannels[64]    |   0
Active Calls per T1 Totals:             | activeChannels[999    |   42
DS1 Datalink layer Status (L2) SL5/DI1  | statusLayer2[33]      |  Active
DS1 Datalink layer Status (L2) SL5/DI2  | statusLayer2[34]      |  Active
DS1 Datalink layer Status (L2) SL5/DI3  | statusLayer2[35]      |  Active
DS1 Datalink layer Status (L2) SL5/DI4  | statusLayer2[36]      |  Active
DS1 Datalink layer Status (L2) SL5/DI5  | statusLayer2[37]      |  Active
DS1 Datalink layer Status (L2) SL5/DI6  | statusLayer2[38]      |  Active
DS1 Datalink layer Status (L2) SL5/DI7  | statusLayer2[39]      |  Active
DS1 Datalink layer Status (L2) SL5/DI8  | statusLayer2[40]      |  Active
DS1 Datalink layer Status (L2) SL6/DI1  | statusLayer2[41]      |  Active
DS1 Datalink layer Status (L2) SL6/DI2  | statusLayer2[42]      |  Awaiting Establishment
DS1 Datalink layer Status (L2) SL6/DI3  | statusLayer2[43]      |  Active
DS1 Datalink layer Status (L2) SL6/DI4  | statusLayer2[44]      |  Active
DS1 Datalink layer Status (L2) SL6/DI5  | statusLayer2[45]      |  Active
DS1 Datalink layer Status (L2) SL6/DI6  | statusLayer2[46]      |  Active
DS1 Datalink layer Status (L2) SL6/DI7  | statusLayer2[47]      |  Active
DS1 Datalink layer Status (L2) SL6/DI8  | statusLayer2[48]      |  Active
DS1 Datalink layer Status (L2) SL7/DI1  | statusLayer2[49]      |  Active
DS1 Datalink layer Status (L2) SL7/DI2  | statusLayer2[50]      |  Active
DS1 Datalink layer Status (L2) SL7/DI3  | statusLayer2[51]      |  Active
DS1 Datalink layer Status (L2) SL7/DI4  | statusLayer2[52]      |  Active
DS1 Datalink layer Status (L2) SL7/DI5  | statusLayer2[53]      |  Awaiting Establishment
DS1 Datalink layer Status (L2) SL7/DI6  | statusLayer2[54]      |  Active
DS1 Datalink layer Status (L2) SL7/DI7  | statusLayer2[55]      |  Active
DS1 Datalink layer Status (L2) SL7/DI8  | statusLayer2[56]      |  Active
DS1 Datalink layer Status (L2) SL8/DI1  | statusLayer2[57]      |  Active
DS1 Datalink layer Status (L2) SL8/DI2  | statusLayer2[58]      |  Active
DS1 Datalink layer Status (L2) SL8/DI3  | statusLayer2[59]      |  Active
DS1 Datalink layer Status (L2) SL8/DI4  | statusLayer2[60]      |  Active
DS1 Datalink layer Status (L2) SL8/DI5  | statusLayer2[61]      |  Active
DS1 Datalink layer Status (L2) SL8/DI6  | statusLayer2[62]      |  Active
DS1 Datalink layer Status (L2) SL8/DI7  | statusLayer2[63]      |  Active
DS1 Datalink layer Status (L2) SL8/DI8  | statusLayer2[64]      |  Active
DS1 Datalink layer Status (L2) Totals:  | statusLayer2[999]     |  30 Active
DS1 Physical layer Status (L1) SL5/DI1  | statusLayer1[33]      |  Active
DS1 Physical layer Status (L1) SL5/DI2  | statusLayer1[34]      |  Active
DS1 Physical layer Status (L1) SL5/DI3  | statusLayer1[35]      |  Active
DS1 Physical layer Status (L1) SL5/DI4  | statusLayer1[36]      |  Active
DS1 Physical layer Status (L1) SL5/DI5  | statusLayer1[37]      |  Active
DS1 Physical layer Status (L1) SL5/DI6  | statusLayer1[38]      |  Active
DS1 Physical layer Status (L1) SL5/DI7  | statusLayer1[39]      |  Active
DS1 Physical layer Status (L1) SL5/DI8  | statusLayer1[40]      |  Active
DS1 Physical layer Status (L1) SL6/DI1  | statusLayer1[41]      |  Active
DS1 Physical layer Status (L1) SL6/DI2  | statusLayer1[42]      |  Lost Framing
DS1 Physical layer Status (L1) SL6/DI3  | statusLayer1[43]      |  Active
DS1 Physical layer Status (L1) SL6/DI4  | statusLayer1[44]      |  Active
DS1 Physical layer Status (L1) SL6/DI5  | statusLayer1[45]      |  Active
DS1 Physical layer Status (L1) SL6/DI6  | statusLayer1[46]      |  Active
DS1 Physical layer Status (L1) SL6/DI7  | statusLayer1[47]      |  Active
DS1 Physical layer Status (L1) SL6/DI8  | statusLayer1[48]      |  Active
DS1 Physical layer Status (L1) SL7/DI1  | statusLayer1[49]      |  Active
DS1 Physical layer Status (L1) SL7/DI2  | statusLayer1[50]      |  Active
DS1 Physical layer Status (L1) SL7/DI3  | statusLayer1[51]      |  Active
DS1 Physical layer Status (L1) SL7/DI4  | statusLayer1[52]      |  Active
DS1 Physical layer Status (L1) SL7/DI5  | statusLayer1[53]      |  Lost Framing
DS1 Physical layer Status (L1) SL7/DI6  | statusLayer1[54]      |  Active
DS1 Physical layer Status (L1) SL7/DI7  | statusLayer1[55]      |  Active
DS1 Physical layer Status (L1) SL7/DI8  | statusLayer1[56]      |  Active
DS1 Physical layer Status (L1) SL8/DI1  | statusLayer1[57]      |  Active
DS1 Physical layer Status (L1) SL8/DI2  | statusLayer1[58]      |  Active
DS1 Physical layer Status (L1) SL8/DI3  | statusLayer1[59]      |  Active
DS1 Physical layer Status (L1) SL8/DI4  | statusLayer1[60]      |  Active
DS1 Physical layer Status (L1) SL8/DI5  | statusLayer1[61]      |  Active
DS1 Physical layer Status (L1) SL8/DI6  | statusLayer1[62]      |  Active
DS1 Physical layer Status (L1) SL8/DI7  | statusLayer1[63]      |  Active
DS1 Physical layer Status (L1) SL8/DI8  | statusLayer1[64]      |  Active
DS1 Physical layer Status (L1) Totals:  | statusLayer1[999]     |  30 Active
Framing Errors per T1 SL5/DI1           | frameErrors[33]       |   22
Framing Errors per T1 SL5/DI2           | frameErrors[34]       |   62
Framing Errors per T1 SL5/DI3           | frameErrors[35]       |   64
Framing Errors per T1 SL5/DI4           | frameErrors[36]       |   66
Framing Errors per T1 SL5/DI5           | frameErrors[37]       |   57
Framing Errors per T1 SL5/DI6           | frameErrors[38]       |   59
Framing Errors per T1 SL5/DI7           | frameErrors[39]       |   66
Framing Errors per T1 SL5/DI8           | frameErrors[40]       |   64
Framing Errors per T1 SL6/DI1           | frameErrors[41]       |   68
Framing Errors per T1 SL6/DI2           | frameErrors[42]       |   68
Framing Errors per T1 SL6/DI3           | frameErrors[43]       |   65
Framing Errors per T1 SL6/DI4           | frameErrors[44]       |   75
Framing Errors per T1 SL6/DI5           | frameErrors[45]       |   64
Framing Errors per T1 SL6/DI6           | frameErrors[46]       |   69
Framing Errors per T1 SL6/DI7           | frameErrors[47]       |   68
Framing Errors per T1 SL6/DI8           | frameErrors[48]       |   58
Framing Errors per T1 SL7/DI1           | frameErrors[49]       |   194
Framing Errors per T1 SL7/DI2           | frameErrors[50]       |   196
Framing Errors per T1 SL7/DI3           | frameErrors[51]       |   185
Framing Errors per T1 SL7/DI4           | frameErrors[52]       |   180
Framing Errors per T1 SL7/DI5           | frameErrors[53]       |   0
Framing Errors per T1 SL7/DI6           | frameErrors[54]       |   199
Framing Errors per T1 SL7/DI7           | frameErrors[55]       |   59
Framing Errors per T1 SL7/DI8           | frameErrors[56]       |   66
Framing Errors per T1 SL8/DI1           | frameErrors[57]       |   28
Framing Errors per T1 SL8/DI2           | frameErrors[58]       |   47
Framing Errors per T1 SL8/DI3           | frameErrors[59]       |   43
Framing Errors per T1 SL8/DI4           | frameErrors[60]       |   41
Framing Errors per T1 SL8/DI5           | frameErrors[61]       |   48
Framing Errors per T1 SL8/DI6           | frameErrors[62]       |   42
Framing Errors per T1 SL8/DI7           | frameErrors[63]       |   47
Framing Errors per T1 SL8/DI8           | frameErrors[64]       |   45
Framing Errors per T1 Totals:           | frameErrors[999]      |  2415 
```

这是我想要的结果：

```
port        | layer1        |   layer2                  | freaming_errors   | active_calls
T1 SL5/DI1  | Active        |   Active                  | 22                | 1
T1 SL5/DI2  | Active        |   Active                  | 62                | 1
T1 SL5/DI3  | Active        |   Active                  | 64                | 2
T1 SL5/DI4  | Active        |   Active                  | 66                | 1
T1 SL5/DI5  | Active        |   Active                  | 57                | 2
T1 SL5/DI6  | Active        |   Active                  | 59                | 1
T1 SL5/DI7  | Active        |   Active                  | 66                | 0
T1 SL5/DI8  | Active        |   Active                  | 64                | 0
T1 SL6/DI1  | Active        |   Active                  | 68                | 0
T1 SL6/DI2  | Lost Framing  |   Awaiting Establishment  | 68                | 0
T1 SL6/DI3  | Active        |   Active                  | 65                | 0
T1 SL6/DI4  | Active        |   Active                  | 75                | 0
T1 SL6/DI5  | Active        |   Active                  | 64                | 0
T1 SL6/DI6  | Active        |   Active                  | 69                | 0
T1 SL6/DI7  | Active        |   Active                  | 68                | 0
T1 SL6/DI8  | Active        |   Active                  | 58                | 0
T1 SL7/DI1  | Active        |   Active                  | 194               | 23
T1 SL7/DI2  | Active        |   Active                  | 196               | 1
T1 SL7/DI3  | Active        |   Active                  | 185               | 0
T1 SL7/DI4  | Active        |   Active                  | 180               | 9
T1 SL7/DI5  | Lost Framing  |   Awaiting Establishment  | 0                 | 0
T1 SL7/DI6  | Active        |   Active                  | 199               | 2
T1 SL7/DI7  | Active        |   Active                  | 59                | 0
T1 SL7/DI8  | Active        |   Active                  | 66                | 0
T1 SL8/DI1  | Active        |   Active                  | 28                | 0
T1 SL8/DI2  | Active        |   Active                  | 47                | 0
T1 SL8/DI3  | Active        |   Active                  | 43                | 0
T1 SL8/DI4  | Active        |   Active                  | 41                | 0
T1 SL8/DI5  | Active        |   Active                  | 48                | 0
T1 SL8/DI6  | Active        |   Active                  | 42                | 0
T1 SL8/DI7  | Active        |   Active                  | 47                | 0
T1 SL8/DI8  | Active        |   Active                  | 45                | 0
T1 Totals:  | 30 Active     |   30 Active               | 2415              | 42 
```

有什么想法吗？......谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:00:05.910

您将不得不使用 MYSQL 中的`SUBSTR`和`LOCATE`函数的复杂组合。

详情`SUBSTR` [请点击这里](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substr)。

详情`LOCATE` [请点击这里](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_locate)。

# c++ - 普通数组上的 std::lower_bound 和 std::find

> ID：10853569
> 
> 赞同：17
> 
> 时间：2012-06-01T15:53:39.663
> 
> 标签：c++, algorithm, stl, find, lower-bound

我喜欢`std::algorithm`尽可能在普通数组上使用。现在我有2个疑问；假设我想使用`std::lower_bound`如果我作为参数提供的值没有找到会发生什么？

```
int a[] = {1,2,3,4,5,6};
int* f = std::lower_bound(a,a+6,20); 
```

打印 *f 时的结果是 20。

如果我使用`std::find`.

```
int a[] = {1,2,3,4,5,6};
int* f = std::find(a,a+6,20); 
```

打印 *f 时的结果是 20。

1.  当找不到返回值时，是否总是返回值是原始参数？
2.  在性能方面表现`std::lower_bound`更好，`std::find`因为它实现了二进制搜索算法。如果数组很大，比如最多 10 个元素，std::find 性能会更好吗？在幕后 std::lower_bound 调用 std::advance 和 std::distance ..也许我也可以节省这些调用？

非常感谢

AFG

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-01T15:56:20.390

> 我得到的结果是 20。（后来编辑为：打印 *f 时得到的结果是 20。）

不，你得到的结果是`a+6`. 取消引用调用未定义的行为。它可能会打印 20，可能会打印“Shirley MacLaine”，或者可能会炸毁您的汽车。

> 当找不到返回值时，是否总是返回值是原始参数？

在您的情况下，返回值将始终是*第二个*参数，因为 20 大于数组中的任何其他值。如果未找到该值，但小于某个现有值，则返回值指向下一个较大的项。

从[cppreference.com](http://en.cppreference.com/w/cpp/algorithm/lower_bound)， std::lower_bound 的返回值是“指向不小于 的第一个元素的迭代器`value`，或者`last`如果没有找到这样的元素。”

> 在性能方面...

测量它。这里没有其他建议可以与您的实际经验证据相提并论。

> 在幕后 std::lower_bound 调用 std::advance 和 std::distance ..也许我也可以节省这些调用？

几乎可以肯定不是。在您的情况下，这些调用几乎肯定会针对单个（或很少）指令进行优化。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-01T16:07:24.923

`lower_bound`和返回的迭代器之间有一个显着差异`find`。如果`lower_bound`没有找到该项目，它将返回应该插入该项目以保留排序顺序的迭代器。如果`find`没有找到该项目，它将返回结束迭代器（即第二个参数`find`）。在您的示例中，因为您试图在数组末尾找到一些东西，所以两者都返回相同的迭代器 - 但这完全是巧合。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-01T15:57:50.707

在您的示例中，您不能取消引用`f`，因为它等于`a+6`. 无论如何，你有，所以你在 UB 领域，但我想值 20 恰好在 array 之后立即在堆栈上`a`。

确实，对于足够小的数组，线性搜索可能比二分搜索更快。10 是“小”，不是“大”。如果您有一个程序对小数组进行大量搜索，您可以对每个数组进行计时并查看。

基本上应该没有开销`std::advance`和`std::distance`- 任何能胜任的 C++ 编译器都会内联所有内容，它们将变成指针加法和减法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-06-04T04:59:33.563

您可以使用以下实现

int a[] = {1,2,3,4,5,6};

int f = lower_bound(a,a+6,20)-a;

现在，如果数组中存在 20，它将返回数组 a 中元素的索引（使用基于 0 的索引）。如果数组中不存在 20，它将返回 6，即数组的长度。

在最坏的情况下，要搜索的项目出现在第 (n-1) 个索引处[当 n 是数组的大小时]。那么 f 将是 n-1。

仅当正在搜索的项目不存在于数组中时， f 才会为 n 或等于数组的大小。

希望它能回答你的问题。

# c# - DirectoryServices.AccountManagement.UserPrincipal.SetPassword("BLahBlahBlah")

> ID：10853573
> 
> 赞同：0
> 
> 时间：2012-06-01T15:53:56.773
> 
> 标签：c#, active-directory, account-management

有人可以帮我解决这个问题吗？我让这段代码在 xp 32 位上运行良好，但在 xp 64 位上“user.SetPassword”（不是 .Save()）会引发异常：

> “调用的目标已抛出异常。”
> 
> {“拒绝访问（HRESULT 异常：0x80070005 (E_ACCESSDENIED)）”}

编码：

```
 UserPrincipal user = UserPrincipal.FindByIdentity
          (new PrincipalContext(ContextType.Domain, Domain, "MYADMINUSER", "MYADMINPASSWORD"), IdentityType.SamAccountName, Account);
        user.SetPassword("BlahBlahBlah");
        user.Save(); 
```

两个客户端都在同一个域中，并且两种情况下的目标都是同一个用户。“MYADMINUSER”可以登录两个客户端，并使用 ADUC 修改目标用户。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:01:46.747

这很可能与 32 位或 64 位无关。这可能是用户帐户控制阻止操作的问题。您可以尝试右键单击您的应用程序并选择以管理员身份运行以进行检查。

请参阅[第 6 步：创建和嵌入应用程序清单 (UAC)](http://msdn.microsoft.com/en-us/library/bb756929.aspx)，了解如何将清单添加到您的应用程序，该清单可用于使其自行请求必要的权限提升。

# windows - 从 Excel xlsx 文件中提取简单字符串的快速方法

> ID：10853574
> 
> 赞同：0
> 
> 时间：2012-06-01T15:53:58.283
> 
> 标签：windows, file, excel, xlsx, vba

在我工作的地方，我需要从中提取信息的数百个 xlsx 文件（使用 Office 2010 Starter 创建）。这只是一次性的工作，所以问题是哪种方式最快。现有工具？编程解决方案？

信息只是字符串，格式无关紧要。这些文件包含客户数据。每位客户一份文件。在你问之前，是的，这是一个愚蠢的系统——我们正在放弃它。因为我们现在要迁移到一个新系统，所以我们需要将现有的客户数据导出为一个 CSV 文件，该文件可以导入到新系统中。

如果我要编写一个计算机程序来执行此操作，我需要能够访问每个文件中的第一个工作表，并且能够读取任何给定单元格（A1、C5 等）的内容。就是这样。

由于 xlsx 文件只是一些压缩的 XML 文件，因此一种方法是编写解压缩和解析 XML 文件的代码。这听起来像是一个非常耗时的解决方案，所以如果存在免费库，我宁愿使用它。

在这里可能有用的语言中，我最擅长 C++ 和 C，但也做过一些 C#、VB6 和 VB.NET，以及一点点 Python。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T20:44:20.907

如果尚未将所有 Excel 文件放在一个文件夹中，请按照以下步骤操作：

1.  打开一个空白工作簿
2.  打开 VBA 编辑器`Alt`+`F11`
3.  添加模块：插入 --> 模块
4.  将以下代码添加到模块中（将目录字符串更改为指向要转换的 Excel 文件所在的目录）
5.  逐步检查几个文件以确保它正在执行您期望的操作
6.  `F5`在所有文件上运行
7.  告别旧系统

**代码：**

```
 Option Explicit

    Sub ExportAllToCSV()
        Dim Directory As String
        Dim i As Long
        Dim file As String
        Directory = "C:\workbooks\"
        i = 1

        Application.DisplayAlerts = False
        Application.ScreenUpdating = False

        ' Get the first file
        file = Dir(Directory, vbReadOnly + vbHidden + vbSystem)

        Do While file <> ""
            If Right(file, 4) = "xlsx" Then ' change to right(file ,3) = "xls" if you have xls files instead of xlsx
                Workbooks.Open Filename:=file
                ActiveWorkbook.SaveAs Filename:="C:\workbooks\file" & i & ".csv", FileFormat _
                            :=xlCSV, CreateBackup:=False
                ActiveWorkbook.Close
                i = i + 1
            End If

            ' Get the next file
            file = Dir()
        Loop

        Application.DisplayAlerts = True
        Application.ScreenUpdating = True
    End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:20:59.910

我建议使用[Excel 互操作 API](http://msdn.microsoft.com/en-us/library/ms262200)。如何使用 API 的示例在[这里](http://social.msdn.microsoft.com/Forums/eu/csharpgeneral/thread/6264b659-f366-4c29-817b-d51b738212f5)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T21:14:44.497

由于您提到可以使用 C#，因此有一个出色的 Excel 2007+ 文件库[EPPlus](http://epplus.codeplex.com/)。以下是一些帮助您入门的示例：

```
 ExcelPackage ep = new ExcelPackage(new FileInfo("excelfile.xlsx"));
  // take the first sheet 
  // or you could get the Worksheet with name : ep.Workbook.Worksheets["Sheet1"]
  ExcelWorksheet ws = ep.Workbook.Worksheets[0];

  // now you can get data
  // cell data from row 3, column 2 (first row or column is 1 not 0)
  string data = ws.Cells[3, 2].Value.ToString();
  // from A5 cell
  string data1 = ws.Cells["A5"].Value.ToString();

  // you can find out how many rows are there 
  int maxRow = ws.Dimension.End.Row; 
```

# javascript - 闭包编译器的正则表达式类型

> ID：10853582
> 
> 赞同：9
> 
> 时间：2012-06-01T15:54:23.173
> 
> 标签：javascript, regex, types, google-closure-compiler, jsdoc

我目前正在向个人 javascript 模块添加类型注释，但我目前在尝试输入以正则表达式作为参数的函数时遇到困难，但以下尝试均无效：

```
/** @type {function(RegExp)} */
/** @type {function(regex)} */ 
```

我只得到：

```
WARNING - Bad type annotation. Unknown type regexp 
```

我应该在声明中使用什么类型？谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-01T18:06:54.723

该`RegExp`对象在 extern [es3.js中为](https://github.com/google/closure-compiler/blob/master/externs/es3.js)[闭包编译器](https://developers.google.com/closure/compiler/)注解。这是一个接受对象的示例函数。`RegExp`

```
/**
 * @param {RegExp} regex A regular expression object.
 * @param {string} text Text to match.
 * @return {string} The first match in text.
 */
var firstMatch = function(regex, text) {
  var match = regex.exec(text);
  return match[1];
};

var text = 'Where art thou?';
var regex = new RegExp('^\\W*(\\w+)\\b', 'g');
var firstWord = firstMatch(regex, text);
alert(firstWord); // displays "Where" 
```

使用 注释的相同函数**`@type`**：

```
/** @type {function(RegExp, string): string} */
var firstMatch = function(regex, text) {
  var match = regex.exec(text);
  return match[1];
}; 
```

# 默认外部

Closure Compiler 包含[默认](https://github.com/google/closure-compiler/tree/master/externs)的 extern ，例如 es3.js、es5.js 和 es6.js。 **这些外部文件通常不需要明确指定**，除非设置了以下标志：

**[闭包编译器应用程序](https://developers.google.com/closure/compiler/docs/gettingstarted_app)**：`--use_only_custom_externs=true`

**[闭包编译器服务 UI](https://developers.google.com/closure/compiler/docs/gettingstarted_ui)**：`@exclude_default_externs true`

**[闭包编译器服务 API](https://developers.google.com/closure/compiler/docs/gettingstarted_api)**：`exclude_default_externs=true`

# 额外的外部人员

[contrib/externs](https://github.com/google/closure-compiler/tree/master/contrib/externs)下还有其他可用的externs ，默认情况下不包括在内。这些外部可以用`--externs`标志指定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:08:00.163

根据[GCC 的类型列表，](https://developers.google.com/closure/compiler/docs/js-for-compiler#types) JSDoc 中没有单独的正则表达式类型，并且正则表达式本身具有“对象”类型。`@typedef`如果你想让你的注释更具可读性和意义，你可以使用别名“regexp”到“object”。如果实际添加了这种类型，它还将允许在未来快速适应 - 您只需要删除或更改别名。

# php - 丢失 PHP 会话

> ID：10853583
> 
> 赞同：4
> 
> 时间：2012-06-01T15:54:26.397
> 
> 标签：php, codeigniter, session

我有一个广泛使用会话的 codeigniter 应用程序，特别是使用数据库会话。

几周前，我们有一个用户报告了一个问题，即应用程序不断失去他的会话 - 他会尝试执行一个操作，会话将丢失，他将被迫再次登录。最后我们发现这是因为他在使用无线宽带，而他一切换到固定线路，他的问题就完全消失了。

今天，我们有另一个用户报告了同样的问题——他是一个（据说速度很快的）无线宽带连接，并且他不断失去他的会话。

我什至不知道从哪里开始...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:50:37.877

我最终发现这是由于 CI 框架中的一个错误：[https ://github.com/EllisLab/CodeIgniter/issues/154](https://github.com/EllisLab/CodeIgniter/issues/154)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:41:37.690

我有一些关于从哪里开始的建议:)

1.  [http://codeigniter.com/user_guide/libraries/sessions.html](http://codeigniter.com/user_guide/libraries/sessions.html)

    既然你说***广泛使用会话***，那么..

    > 注意：Cookie 只能保存 4KB 的数据，所以请注意不要超出容量。

2.  `application/config/config.php`会话配置：

    ```
    $config['sess_expiration']      = 900;   // Inactive for too long?
    $config['sess_expire_on_close'] = FALSE; // Close his browser?
    $config['sess_match_ip']        = FALSE; // IP renew accidentally or what? 
    ```

希望这会有所帮助=)

# jquery - 带有 phonegap 的 Jquery-mobile 在 Android 4.0 上没有获取 cookie

> ID：10853585
> 
> 赞同：1
> 
> 时间：2012-06-01T15:54:38.900
> 
> 标签：jquery, android, cookies, jquery-mobile, cordova

我有一个适用于 Android 的 phonegap 应用程序，其中有一个登录页面，代码如下：

```
<h3>Log In</h3>
            <input id="username" type="email" name="login" value="" placeholder="User" style="background: white;"/>
            <input class="wrapped_input login_password" id="password" type="password" value="" name="password" placeholder="Password" style="background: white;"/>

            <div data-role="fieldcontain">
                <fieldset data-role="controlgroup">
                        <input type="checkbox" name="remember" id="remember" />
                        <label for="remember">Remember Password</label>
                        <input type="checkbox" name="mantener" id="mantener" disabled="disabled" />
                        <label for="keepIn">Keep me in</label>
                </fieldset>
            </div>

            <div class="cta_button_wrapper">
                <a href="javascript:login();" data-role="button" rel="external" data-transition="slide" data-theme="e" >Log</a>
            </div> 
```

在 login() 函数中，我对服务进行 Ajax 调用并成功：

```
if($('#remember').is(':checked')) 
            {
                setCookie("coreMobileLoginRemember", "true", 100);

                setCookie("coreMobileLoginUser",user,100);
                setCookie("coreMobileLoginHash",password,100);

                if($('#mantener').is(':checked'))
                    setCookie("coreMobileLoginKeep", "true", 100);
                else
                    deleteCookie("coreMobileLoginKeep");
            }
            else
            {
                deleteCookie("coreMobileLoginRemember");
                deleteCookie("coreMobileLoginUser");
                deleteCookie("coreMobileLoginHash");
                deleteCookie("coreMobileLoginKeep");
            } 
```

在 Android 2.2 中它运行良好，但在 Android 4.0.3 中，该应用程序不记得用户，我猜这是关于 cookie 的问题，但我不知道它是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:36:33.597

我通过使用 localStorage 而不是 cookie 解决了这个问题。如果有人对此有实际答案，请发布，我会接受。

# sql - 数据库链接名称的变量

> ID：10853586
> 
> 赞同：1
> 
> 时间：2012-06-01T15:54:43.577
> 
> 标签：sql, database, variable-assignment, oracle-apex, database-link

我想做 `v$session@remotedatabase`远程数据库是 dblink 地址的变量的地方。那可能吗？

我正在使用 Apex 4 并尝试在所有数据库上获取临时空间。

当前查询

```
select 'Total temp space available in :Database is '||sum(bytes)/1024/1024 ||' mb' from v$tempfile@:Database 
```

yields`ORA-01729: database link name expected`因为变量没有正确解析？

我对 SQL 很陌生，对不起

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:20:06.050

您需要使用动态 SQL 才能使数据库链接可变。在 PL/SQL 中，这看起来像

```
DECLARE
  l_sql_stmt varchar2(1000);
  l_tmp_space varchar2(1000);
  l_database  varchar2(100) := <<db link name>>;
BEGIN
  l_sql_stmt := 'select ''Total temp space available in ' ||l_database  || ' is '' || sum(bytes)/1024/1024 ||'' mb'' from v$tempfile@' || l_database;
  dbms_output.put_line( l_sql_stmt );
  EXECUTE IMMEDIATE l_sql_stmt
    INTO l_tmp_space;
  dbms_output.put_line( l_tmp_space );
END; 
```

基本上，您需要构造一个包含 SQL 语句的字符串，然后执行该动态生成的字符串（当 SQL 语句本身正在构建一个字符串时，这会更复杂，就像您在这里一样 - 这使得找出哪些单引号要转义有点挑战）。

但是，根据您在 APEX 中尝试执行的操作，您可能需要一些不同的东西。例如，如果您尝试基于此创建报告，则可以从 SQL 语句或返回 SQL 语句的函数填充常规（非交互式）报告。如果这就是你想要做的，你会想要类似的东西

```
DECLARE
  l_sql_stmt varchar2(1000);
  l_tmp_space varchar2(1000);
  l_database  varchar2(100) := <<db link name>>;
BEGIN
  l_sql_stmt := 'select ''Total temp space available in ' ||l_database  || ' is '' || sum(bytes)/1024/1024 ||'' mb'' from v$tempfile@' || l_database;
  dbms_output.put_line( l_sql_stmt );
  RETURN l_sql_stmt;
END; 
```

# ios - 你如何自定义 UIKit 对象的外观？

> ID：10853588
> 
> 赞同：1
> 
> 时间：2012-06-01T15:54:48.143
> 
> 标签：ios, cocoa-touch, uikit

我知道在一些 UIKit 项目（如 tintColor）中有一些属性可供您使用，但是否可以对这些项目进行子类化以使您的应用程序看起来具有某种特定方式。我之所以问，是因为我知道 UIKit 中的类以及 Apple 提供的其他框架应该是高度优化的，我不想失去这种性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:04:51.240

在 iOS 5 中，Apple 添加了自定义 UIControls 的功能。请参阅此[http://www.raywenderlich.com/4344/user-interface-customization-in-ios-5](http://www.raywenderlich.com/4344/user-interface-customization-in-ios-5)

# c# - System.Collections.ObjectModel.Collection 的“Add”方法如何 工作？

> ID：10853589
> 
> 赞同：0
> 
> 时间：2012-06-01T15:54:49.703
> 
> 标签：c#, .net, c#-4.0

**背景：**我正在尝试创建自己的“向量”类来帮助对数组进行数学计算。我正在重载算术运算符 ( + - * / ) 以实现我想要的功能。起初，我在我的类中使用了一个私有数组，然后实现了`IEnumerable<T>`接口。后来想到了继承`List<T>`类，但是看了几篇文章，明白应该`Collection<T>`改用。请注意，用数据填充我的“矢量”对象时，*性能非常重要。*

**问题：**该方法如何`Collection<T>.Add()`工作？`List<T>.Add()` [文档](http://msdn.microsoft.com/en-us/library/3wcytfd1.aspx)很清楚：

> 如果 Count 已经等于 Capacity，则通过自动重新分配内部数组来增加 List 的容量，并且在添加新元素之前将现有元素复制到新数组中。

但是，`Collection<T>.Add()` [文档](http://msdn.microsoft.com/en-us/library/ms132404.aspx)根本没有说明它是如何工作的。当我用作`List<T>`我的基类时，我可以访问该属性，并且可以在使用该方法`Capacity`之前指定大小。`Add()`但是，`Collection<T>`没有`Capacity`属性——这就是我问这个问题的原因。我再次重申：性能非常重要。

由于性能是一个问题，也许我应该回到使用私有数组并实现`IEnumerable<T>`接口。你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:09:43.137

A`Collection<T>`是`IList<T>`. 的默认构造函数`Collection<T>`只使用一个 new `List<T>`，因此`Add`行为将与`List<T>`假设您使用默认构造函数相同。

> 但是， Collection.Add() 文档完全没有说明它是如何工作的

那是因为`Add`行为依赖于`IList`在构造函数中传递的底层。

> 但是，Collection 没有容量属性

同样，因为这将取决于 Collection 包装的内容。它包装了*界面* `IList<T>`。接口没有容量的概念。*可能*有一个`IList<T>`没有已知容量的实现，比如数据库中的记录。

如果您需要容量等这些实现细节，那么只需使用`List<T>`. `Collection<T>`没有任何性能优势，`List<T>`因为它无论如何都在使用它。如果性能对您很重要，那么您可能希望找到一个已经解决了这个问题的库，而不是自己动手。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:22:27.053

没有关于实现的细节，但是文档中有 Add 的性能特征：

[`List<T>.Add`](http://msdn.microsoft.com/en-us/library/3wcytfd1)

> 如果 Count 小于 Capacity，则此方法是 O(1) 操作。如果需要增加容量以容纳新元素，则此方法变为 O(n) 操作，其中 n 为 Count。

[`Collection<T>.Add`](http://msdn.microsoft.com/en-us/library/ms132404.aspx)（截至 2012 年 6 月 1 日）

> 此方法是 O(1) 操作。

请注意，`Collection<T>.Add`对于至少作为包装器创建的集合`List<T>`或使用实现为 Collection() 的 Collection 的默认构造函数创建的集合看起来不正确： this(new List()) 正如@vcsjones 指出的那样。看起来像文档中的错误。

通过测量（这是解决性能问题的正确方法）或嗅探源头应该很容易验证......

旁注：您将无法使用单个数组击败 List 的 Add 性能（因为它正是 List 所做的），您需要使用更复杂的东西（如数组块列表）从 Add 获得 O(1)和项目[]。

# java - 时间戳格式加 17 小时

> ID：10853594
> 
> 赞同：0
> 
> 时间：2012-06-01T15:55:03.370
> 
> 标签：java, time, timestamp

**问题**是`SimpleDateFormat`似乎在实际时间戳上增加了 17 小时。

这应该是非常简单的事情。我不确定我做错了什么。我有一种方法可以将很长的纳秒转换为格式化的时间戳。它增加了17个小时。这是我的[SSCCE](http://www.sscce.org)

```
package playground;

import java.sql.Timestamp;
import java.text.SimpleDateFormat;
import java.util.concurrent.TimeUnit;

/**
*
* @author kentcdodds
*/
public class NanosecondsToString {

  public static void main(String[] args) {
    long nanoseconds = 234236402;
    Timestamp ts = new Timestamp(TimeUnit.MILLISECONDS.convert(nanoseconds, TimeUnit.NANOSECONDS));
    SimpleDateFormat format = new SimpleDateFormat("HH:mm:ss:SSS");
    String formatted = format.format(ts);
    System.out.println(formatted);
  }
} 
```

输出：`17:00:00:234`

我在山区标准时间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:01:33.740

您必须将时区设置为`UTC`.

```
public static void main(String[] args) throws IOException {
              long nanoseconds = 234236402;
              Timestamp ts = new Timestamp(TimeUnit.MILLISECONDS.convert(nanoseconds, TimeUnit.NANOSECONDS));
              SimpleDateFormat format = new SimpleDateFormat("HH:mm:ss:SSS");
              format.setTimeZone(TimeZone.getTimeZone("UTC"));
              String formatted = format.format(ts);
              System.out.println(formatted);
    } 
```

`SimpleDateFormat`默认情况下，会将时间戳转换为您当前时区的时间。所以有必要告诉它假设它是UTC。否则，您可以使用[jodatime 的间隔类](http://joda-time.sourceforge.net/apidocs/org/joda/time/Interval.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T15:58:28.763

你的机器在哪个时区？是否可能进行时区转换？

如果是这样，使用 Java TimeZone 类可能会有所帮助：[http ://docs.oracle.com/javase/1.4.2/docs/api/java/util/TimeZone.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/TimeZone.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:02:54.713

在使用 SimpleDateFormat 进行格式化时，您正在将持续时间隐式转换为日期。要半安全地格式化该日期，请在 GMT 时区进行格式化，无需 DST。遇到 +24 小时持续时间时，这仍然会出现问题。

更好的解决方案是编写一个 Duration 类和一个 SimpleDurationFormat 类。这很痛苦，但你只需要这样做一次。替代方案也存在，比如吸纳 JodaTime，它明确支持持续时间（尽管我从来没有格式化过）。

# c++ - linux 上的 gcc 使用哪个线程库来实现 OpenMP？

> ID：10853597
> 
> 赞同：2
> 
> 时间：2012-06-01T15:55:25.527
> 
> 标签：c++, c, linux, gcc, openmp

它是否使用 pthreads 或其他一些线程 API？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T16:04:27.817

是的，Linux 上的 gcc 使用 pthreads。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:16:07.703

这取决于你用什么编译 GCC，标准的 linux 实现带有用于 OpenMP 的 posix 线程，`gcc -v`在终端上输入

这是我笔记本电脑的输出，感兴趣的部分以粗体显示

```
[n@N-pc-t61 ~]$ gcc -v
Using built-in specs.
COLLECT_GCC=/usr/bin/gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/i686-redhat-linux/4.6.3/lto-wrapper
Target: i686-redhat-linux
Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-ppl --with-cloog --with-tune=generic --with-arch=i686 --build=i686-redhat-linux
**Thread model: posix** 
```

这是 gcc 网站上所有可用的选项

```
--enable-threads=lib
    Specify that lib is the thread support library. This affects the Objective-C compiler and runtime library, and exception handling for other languages like C++ and Java. The possibilities for lib are:

    aix
        AIX thread support.
    dce
        DCE thread support.
    lynx
        LynxOS thread support.
    mipssde
        MIPS SDE thread support.
    no
        This is an alias for `single'.
    posix
        Generic POSIX/Unix98 thread support.
    rtems
        RTEMS thread support.
    single
        Disable thread support, should work for all platforms.
    tpf
        TPF thread support.
    vxworks
        VxWorks thread support.
    win32
        Microsoft Win32 API thread support. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:05:53.417

一个 OpenMP 运行时库是 OdinMP 编译器所针对的 Balder 库。该库和编译器完全支持 OpenMP 2.0，包括嵌套并行。Balder 库采用模块化设计，并具有多个子库。一个这样的子库是一个名为 Balder Threads 的高效可移植线程库

# objective-c - 如何设置 NSTabView 的背景颜色？

> ID：10853598
> 
> 赞同：4
> 
> 时间：2012-06-01T15:55:35.327
> 
> 标签：objective-c, tabview

```
[tabView setBackgroundColor:[NSColor colorWithCalibratedRed:0.227f green:0.251f blue:0.337 alpha:0.8]; 
```

上面的代码不起作用:(

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:38:20.303

NSTabView 没有`setBackgroundColor`方法，所以我认为您不能按原样使用它。解决它的方法之一是继承 NSTabView 和覆盖`drawRect`方法。在 github 上检查此版本的自定义选项卡控件 - [https://github.com/ciaran/psmtabbarcontrol](https://github.com/ciaran/psmtabbarcontrol)

# mysql - 在 MySQL 中插入具有唯一 ID 冲突的旧数据

> ID：10853602
> 
> 赞同：1
> 
> 时间：2012-06-01T15:55:57.783
> 
> 标签：mysql, database, primary-key

我正在开发一个最近升级的中型网站。在那次升级期间，数据库的部分没有被转移。现在新网站已经上线一个多月了，我的老板希望把缺失的部分重新整合进去。

我需要传输几组具有唯一自动分配的主键 ID 的表。生产数据库中已经有冲突的键，所以我不能只插入我所有的行。

我想只为旧数据中的所有主键添加一个基数（可能是 10000）。这将确保与新数据库中已有的内容没有冲突，但我不确定 MySQL 将如何反应。我也一直想知道是否有更好和/或标准的方法来实现这一点。

插入数据的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T18:24:23.320

正如对我的问题的评论中提到的，迁移脚本是要走的路。这可以是您的数据库平台的实际迁移脚本，也可以是您选择的语言的脚本，该脚本从 1 个数据库读取并将数据添加到第 2 个数据库。

像我在问题中描述的那样添加“基数”是一个坏主意，并且可能在将来的传输过程中导致错误。

我最终手动解决了冲突的 ID，这实际上是由于以前的开发人员试图在早期迁移期间为所有 ID 添加一个基数，而不是将错误的重复数据引入数据库。

# php - WWW外部文件的路径

> ID：10853603
> 
> 赞同：0
> 
> 时间：2012-06-01T15:56:08.500
> 
> 标签：php, lamp

[https://stackoverflow.com/a/10743881/1303216](https://stackoverflow.com/a/10743881/1303216)

我目前正在解决这个问题。我复制并粘贴了代码，并一直在努力让它工作。在我的服务器的 webroot 上有一个名为 secretfolder 的文件夹。在 public_html 中有一个 PHP 文件，其中包含用于获取我隐藏的 PDF（复制代码）的脚本。问题是，文件不断损坏，当我在记事本中查看它们时，我得到了

```
failed to open stream: No such file or directory in <b>/home/user/public_html/herp.php 
```

如何让它指向 public_html 之外。我不完全理解相对文件路径，所以一些帮助会很棒。

我在标准灯上

**简短的问题**

Public_html 中的 PHP 文件需要指向直接位于 webroot 上的 /secretfolder 的相对文件路径是什么？

旁注，我不只是尝试 $file = '/path/to/file/outside/www/secret.pdf'; 但我需要知道实际使用中应该是什么。

# 更新

我使用的文件路径是 /secretfolder/Pay%20Stub%20View.pdf

%20（空格）由于某种原因破坏了它。它现在工作正常。我觉得有点傻。谁能解释为什么会这样？我所知道的是它确实如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:03:26.107

**简短的回答**

我不知道你的文件系统的布局。但是 PHP/Apache 可以访问很多（假设正确的文件权限）。我倾向于使用相对路径，因为您可以轻松地从开发环境转移到生产/测试环境而无需麻烦。

**更长的答案**

`/home/user/public_html/herp.php`服务器上有文件吗？

要回答另一个问题，相对路径使用`..`目录表示法。这意味着子目录 - 下面的分支。只需将文件系统视为一棵树。叶子是文件。各种分支是目录。要到达保存当前目录/分支的目录/分支 - 使用`..`符号。

如果您愿意，您甚至可以到达后备箱！希望有帮助。

# .net - 如何将此 app.config WCF 客户端配置转换为代码？

> ID：10853606
> 
> 赞同：3
> 
> 时间：2012-06-01T15:56:20.647
> 
> 标签：.net, soap, app-config, wcf-client, ws-security

我已经获得了以下 app.config 条目，但是我希望在我的应用程序中将此作为代码，以便更好地理解 WCF。

哪里有转换器，或者有人可以提供代码。谢谢。

```
 <system.serviceModel>
    <client>
      <endpoint name="QA" address="https://subdomain1.theirdomain.com/5067/Sample1"
      behaviorConfiguration="WSSecBehavior" binding="customBinding"
      bindingConfiguration="Soap11_Secure"
      contract="star.starTransportPortTypes" />
      <endpoint name="PROD" address="https://subdomain1.theirdomain.com/5067/Sample1"
      behaviorConfiguration="WSSecBehavior" binding="customBinding"
      bindingConfiguration="Soap11_Secure"
      contract="star.starTransportPortTypes" />
    </client>
    <bindings>
      <customBinding>
        <binding name="Soap11_Secure">
          <textMessageEncoding messageVersion="Soap11" />
          <security defaultAlgorithmSuite="Basic128Rsa15"
          allowSerializedSigningTokenOnReply="true"
          authenticationMode="MutualCertificate"
          messageProtectionOrder="SignBeforeEncrypt"
          messageSecurityVersion="WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
          </security>
          <httpsTransport maxBufferSize="5000000"
          maxReceivedMessageSize="5000000" />
        </binding>
      </customBinding>
    </bindings>
    <behaviors>
      <endpointBehaviors>
        <behavior name="WSSecBehavior">
          <clientCredentials>
            <clientCertificate storeLocation="CurrentUser"
            storeName="My" x509FindType="FindBySubjectName"
            findValue="*.mydomain.org.uk" />
            <serviceCertificate>
              <!-- you my have to add this if your client cannot check revocations -->
              <authentication revocationMode="NoCheck" />
              <scopedCertificates>
                <add targetUri="https://subdomain1.theirdomain.com/Sample1"
                storeName="AddressBook"
                x509FindType="FindBySubjectName"
                findValue="subdomain1.theirdomain.com" />
              </scopedCertificates>
            </serviceCertificate>
          </clientCredentials>
        </behavior>
      </endpointBehaviors>
    </behaviors>
  </system.serviceModel> 
```

到目前为止，我有这个：

```
 Dim asbe As New Channels.AsymmetricSecurityBindingElement

    asbe.MessageSecurityVersion = MessageSecurityVersion.WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10
    asbe.DefaultAlgorithmSuite = Security.SecurityAlgorithmSuite.Basic128Rsa15  'By default, AES-128 is used as the encryption algorithm.
    asbe.AllowSerializedSigningTokenOnReply = True
    asbe.InitiatorTokenParameters = New ServiceModel.Security.Tokens.X509SecurityTokenParameters
    asbe.RecipientTokenParameters = New ServiceModel.Security.Tokens.X509SecurityTokenParameters
    asbe.MessageProtectionOrder = Security.MessageProtectionOrder.SignBeforeEncrypt

    'Add the elements to the custom binding
    Dim myBinding As New CustomBinding

    'element order is important - see http://msdn.microsoft.com/en-us/library/ms733893(v=vs.90).aspx

    'Protocol Binding Elements (security)
    myBinding.Elements.Add(asbe)

    'Encoding Binding Element  
    myBinding.Elements.Add(New TextMessageEncodingBindingElement(MessageVersion.Soap11, System.Text.Encoding.UTF8))

    'Transport Binding Element
    Dim httpsBindingElement As New HttpsTransportBindingElement()
    httpsBindingElement.MaxBufferSize = 5000000
    httpsBindingElement.MaxReceivedMessageSize = 5000000

    myBinding.Elements.Add(httpsBindingElement)

    Dim epi As EndpointIdentity = EndpointIdentity.CreateDnsIdentity("subdomain.theirdomain.com")

    Dim epuri As Uri = New Uri("https://subsomain1.theirdomain.com/5067/ProcessRepairOrder")
    Dim ea As New EndpointAddress(epuri, epi, New AddressHeaderCollection)

    ' Create the client. 
    Dim starClientProxy As New wcfStarServiceProxy.starTransportPortTypesClient(myBinding, ea)

    ' Specify a certificate to use for authenticating the client.

    starClientProxy.ClientCredentials.ClientCertificate.SetCertificate(StoreLocation.CurrentUser, StoreName.My, X509FindType.FindBySubjectName, "*.mydomain.org.uk")
    starClientProxy.ClientCredentials.ServiceCertificate.SetDefaultCertificate(StoreLocation.CurrentUser, StoreName.AddressBook, X509FindType.FindBySubjectName, "subdomain.theirdomain.com")

    ' Begin using the client.

    Dim response As wcfStarServiceProxy.AcknowledgeRepairOrderPayload = starClientProxy.ProcessMessage(payload) 
```

我不确定我还需要做什么。我找不到如何在 AsymmetricSecurityBindingElement 上设置 authenticationMode="MutualCertificate"。

另外，是否有任何工具可以在代码和配置之间进行转换并再次返回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:54:17.983

这有效：

```
Dim asbe As New Channels.AsymmetricSecurityBindingElement

asbe.MessageSecurityVersion = MessageSecurityVersion.WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10

asbe.DefaultAlgorithmSuite = Security.SecurityAlgorithmSuite.Basic128Rsa15  'By default, AES-128 is used as the encryption algorithm.

asbe.AllowSerializedSigningTokenOnReply = True

asbe.InitiatorTokenParameters = New ServiceModel.Security.Tokens.X509SecurityTokenParameters
asbe.RecipientTokenParameters = New ServiceModel.Security.Tokens.X509SecurityTokenParameters

asbe.MessageProtectionOrder = Security.MessageProtectionOrder.SignBeforeEncrypt

asbe.SetKeyDerivation(False)

'Add the elements to the custom binding
Dim myBinding As New CustomBinding

'element order is important - see http://msdn.microsoft.com/en-us/library/ms733893(v=vs.90).aspx

'Protocol Binding Elements (security)
myBinding.Elements.Add(asbe)

'Encoding Binding Element  
myBinding.Elements.Add(New TextMessageEncodingBindingElement(MessageVersion.Soap11, System.Text.Encoding.UTF8))

'Transport Binding Element
Dim httpsBindingElement As New HttpsTransportBindingElement()
'httpsBindingElement.RequireClientCertificate = True
httpsBindingElement.MaxBufferSize = 5000000
httpsBindingElement.MaxReceivedMessageSize = 5000000

myBinding.Elements.Add(httpsBindingElement)

Dim ea As New EndpointAddress("https://subdomain.theirdomain.com/5067/ProcessRepairOrder")

' Create the client. 
Dim starClientProxy As New VHC.Server.FordWarehouse2.ServiceReference1.starTransportPortTypesClient(myBinding, ea)

' Specify a certificate to use for authenticating the client.

starClientProxy.ClientCredentials.ClientCertificate.SetCertificate(StoreLocation.CurrentUser, StoreName.My, X509FindType.FindBySubjectName, "*.mydomain.org.uk")

starClientProxy.ClientCredentials.ServiceCertificate.SetDefaultCertificate(StoreLocation.CurrentUser, StoreName.AddressBook, X509FindType.FindBySubjectName, "subdomain.theirdomain.com")

' Begin using the client.
Dim response As VHC.Server.FordWarehouse2.ServiceReference1.AcknowledgeRepairOrderPayload = starClientProxy.ProcessMessage(payload) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T17:10:46.787

不要直接创建 AsymmetricSecurityBindingElement。而是使用这样的东西：

```
SecurityBindingElement.CreateMutualCertificateBindingElement 
```

# iphone - 在 iOS 中将参与者添加到事件

> ID：10853610
> 
> 赞同：6
> 
> 时间：2012-06-01T15:56:38.710
> 
> 标签：iphone, ios, eventkit, ekeventkit, ekevent

在 EKParticipant 类参考中，“将参加者发送到 EKEvent 对象以获取 EKParticipant 对象的数组。”好的，购买如何将参加者发送到 EKEvent 对象？

有人给出示例代码吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-04T10:39:00.180

[iOS参考](https://developer.apple.com/library/ios/documentation/EventKit/Reference/EKParticipantClassRef/Reference/Reference.html#//apple_ref/doc/uid/TP40009568-CH1-DontLinkElementID_1)说明如下：

> 您不直接创建 EKParticipant 对象。将与会者发送到 EKEvent 对象以获取 EKParticipant 对象数组。

不幸的是，该`attendees`属性是只读的，并且这些`EKParticipant`' 的存在方式从参考中被省略了。它使我相信*创建新参与者的唯一方法是使用`EKEventEditViewController`*（来自`EventKitUI`框架）。

非常不满意，我知道，所以请让其他人有更好的答案！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-16T03:21:11.933

WeekCal 可以合法地做到这一点（通过 API 合同）的唯一方法是与 iCloud 服务器对话以添加参与者，然后将参与者同步回设备。我很想看到它正在触及 iOS 事件商店的证据......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T22:47:03.753

使用此版本的 EventKit，您将始终无法创建与会者，因为 Apple 尚未公开相关 API。

但是你可以使用class-dump输出EventKit的头文件来查看所有的接口，甚至包括私有的，并一一试用。

我见过一个名为 Week Cal 的应用程序可以将参与者添加到 iOS 活动商店，它是一个 Appstore 销售应用程序，不需要越狱。所以我相信有一种方法可以将参与者添加到当前 iOS 的活动商店中，并且不会被 Apple 拒绝。

# android - 带有片段的 ViewPager - onPause()、onResume()？

> ID：10853611
> 
> 赞同：56
> 
> 时间：2012-06-01T15:56:46.207
> 
> 标签：android, android-viewpager, onresume, onpause

`ViewPager`与片段一起使用时，在选项卡之间移动时不会调用我们的`onPause`,`onResume`方法。当我们变得可见或被隐藏时，有什么方法可以在片段中找出？

不幸的是，我在 , 中有逻辑`onResume`，`onPause`例如向位置服务注册，在切换选项卡时永远不会停止，因为`onPause`在退出整个应用程序之前永远不会被调用。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-02T07:41:44.187

ViewPager 带有[`OnPageChangeListener`](http://developer.android.com/reference/android/support/v4/view/ViewPager.OnPageChangeListener.html)界面。通过为先前和当前显示的页面设置一些标志，您可以模拟这种行为。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-26T02:48:38.057

考虑到以前的解决方案不是很清楚，以下是我如何解决它，感谢 Phix 的提示：

在 OnPageChange() 回调中：

```
 Fragment old_fragment = getActiveFragment(old_position);
    Fragment new_fragment = getActiveFragment(new_position);
    old_f.setUserVisibleHint(false);
    old_f.onPause();
    new_f.setUserVisibleHint(true);
    new_f.onResume(); 
```

然后在 onResume() 中：

```
 if (getUserVisibleHint())
        /* resume code */ 
```

在 onPause() 中：

```
 if (!getUserVisibleHint())
        /* pause code */ 
```

这是 getActiveFragment 代码，避免搜索它：

```
 return fragmentManager.findFragmentByTag("android:switcher:" + viewPagerId + ":" + position); 
```

注意：Fragment 有一个 isVisible() 方法，但它似乎不是很一致，因此使用了 UserVisibleHint。

编辑：用私有标志替换 UserVisibleHint 。工作得更好！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-01-24T03:42:39.050

如果您使用的是 Android 支持库 (rev 11)，您可以使用`getUserVisibleHint`或覆盖[`setUserVisibleHint`()](https://developer.android.com/reference/android/support/v4/app/Fragment.html#setUserVisibleHint(boolean))来捕获可见和隐藏的更改。看这个[帖子](https://stackoverflow.com/questions/10024739/how-to-determine-when-fragment-becomes-visible-in-viewpager)。

```
@Override
public void setUserVisibleHint(boolean isVisibleToUser) {
    super.setUserVisibleHint(isVisibleToUser);
    if (isVisibleToUser) {
        // do something when visible.
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-06-11T13:43:16.323

当前版本的`ViewPager`库允许开箱即用地启用所需的行为，只需将`FragmentPagerAdapter.BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT`其作为[第二个参数](https://developer.android.com/reference/androidx/fragment/app/FragmentPagerAdapter#FragmentPagerAdapter(androidx.fragment.app.FragmentManager,%20int))传递给[FragmentPagerAdapter](https://developer.android.com/reference/androidx/fragment/app/FragmentPagerAdapter)。

还可以考虑使用[ViewPager2](https://developer.android.com/reference/androidx/viewpager2/widget/ViewPager2?hl=en)来替换`ViewPager`. `ViewPager2`调用`onPause()`，`onResume()`默认情况下，不需要配置。

有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/57888432/4858777)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-07T13:43:26.877

**解决方案1：**

`SparseArray`在您`ViewPagers`的 ' 适配器中定义 a ，如下所示。在这个数组中，我们将保存片段的实例。

```
SparseArray<Fragment> registeredFragments = new SparseArray<>(); 
```

还有`Override`你的适配器`instantiateItem`方法。

```
@Override
public Object instantiateItem(ViewGroup container, int position) {
    Fragment fragment = (Fragment) super.instantiateItem(container, position);
    registeredFragments.put(position, fragment);
    return fragment;
} 
```

还有`Override` `destroyItem`你的方法`ViewPagers`

```
@Override
public void destroyItem(ViewGroup container, int position, Object object) {
    registeredFragments.remove(position);
    super.destroyItem(container, position, object);
} 
```

并定义一个新方法来获取您的`ViewPager` `Fragments`实例。

```
public Fragment getRegisteredFragment(int position) {
    return registeredFragments.get(position);
} 
```

现在您可以使用`ViewPager's` `OnPageChangeListener`. 这是一个有关如何实现 viewpager 的示例`onPageChangeListener`：

定义一个整数来保持当前位置：

```
int currentPos;

yourViewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {
            @Override
            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {
                // Empty method
            }

            @Override
            public void onPageSelected(int position) {
                  // This is paused fragment.
                  final Fragment pausedFragment = yourAdapter.getRegisteredFragment(currentPos);

                  // update current position value
                  currentPos = position;

                  // This is resumed fragment
                  final Fragment resumedFragment = yourAdapter.getRegisteredFragment(currentPos);
            }

            @Override
            public void onPageScrollStateChanged(int state) {
                // Empty method
            }
        }); 
```

最后为了恢复实例状态更新您当前的位置以保持更新用户离开的位置`ViewPager`

```
currentPos = yourViewPager.getCurrentItem(); 
```

**解决方案2：**

对于另一种解决方案，您可以找到您`ViewPager` `Fragments`的 by `Tag`。您可以使用以下命令生成标签：

```
@NonNull
public static String generateViewPagerFragmentTag(int viewPagerId, int position) {
        final StringBuilder tagBuilder = new StringBuilder();
        tagBuilder.append("android:switcher:");
        tagBuilder.append(viewPagerId);
        tagBuilder.append(":");
        tagBuilder.append(position);
        return tagBuilder.toString();
    } 
```

并找到你的`Fragment`：

```
final Fragment yourFragment = getSupportFragmentManager().findFragmentByTag(generateViewPagerFragmentTag(R.id.your_viewpager, currentPos)); 
```

**编辑：**

几年前，当我在寻找获取当前项目的解决方案时，我在s 中`ViewPager`尝试过，发现它不可靠。我不确定它现在是否可靠，但我仍然避免使用。`userVisibleHint``Fragment`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-06T10:43:15.230

您可以使用以下方法`Fragment`

```
public void setUserVisibleHint(boolean isVisibleToUser){

} 
```

时`isVisibleToUser == true`，显示片段

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-10-18T15:16:24.547

经过一番研究，我找到了完美的解决方案。

当你初始化你的适配器时，这样做： -

```
 import static androidx.fragment.app.FragmentPagerAdapter.BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT;

//(i am using androidx but if you have not yet migrated yet you can use appcompat)

    adapter = new FeedTabsPagerAdapter(getSupportFragmentManager(), BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT); 
```

添加此行后，您将完美地获得 onResume() 和 onPause 回调。如果我的代码解决了这个问题，请将其标记为正确的解决方案。干杯！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2022-01-19T13:18:32.537

使用 Viewpager2 最新版本，它只会在您滚动到该片段时调用 onResume()，就像 Vp1 之前为 +1 下一个片段调用它一样。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-17T12:16:49.683

聚会有点晚了，但是在我当前的应用程序中，我已将 Viewpager 的 OffScreenPageLimit 设置为 1，这意味着片段不会被缓存，并且每次视图更改时都会重新加载当前片段

[https://developer.android.com/reference/android/support/v4/view/ViewPager.html#getOffscreenPageLimit()](https://developer.android.com/reference/android/support/v4/view/ViewPager.html#getOffscreenPageLimit())

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-18T20:11:44.050

[为savepopulation](https://stackoverflow.com/users/1559852/savepopulation)的答案中的方法提供更多定义：

```
yourPager.setOnPageChangeListener(new GridViewPager.OnPageChangeListener() {
        @Override
        public void onPageScrolled(int row, int column, float rowOffset, float columnOffset, int rowOffsetPixels, int columnOffsetPixels) {

        }

        @Override
        public void onPageSelected(int row, int column) {
            // When on page selected if position is not specific for you
            // you can find your fragment or you can switch position.
        }

        @Override
        public void onPageScrollStateChanged(int state) {

        }
    }); 
```

# php - 在 PHP 中使用 in_array()

> ID：10853612
> 
> 赞同：0
> 
> 时间：2012-06-01T15:56:46.513
> 
> 标签：php, codeigniter

我正在尝试使用 Codeigniter 根据数据库值显示菜单并为我的用户授予用户权限。但它不起作用，可能是视图文件中的问题。我有下表。

表名：module_permission

```
 id   user_id   delete     add    edit
   1       1        0         1      1 
```

我的控制器：

```
$this->load->model('mod_module_permission');
$data['permit']= $this->mod_module_permission->permission($user_id); 
```

我的模型：

```
 $this->db->select('*');
    $this->db->from('module_permission');
    $this->db->where('user_id', $user_id);                                          
    $getData = $this->db->get('');
    if($getData->num_rows() > 0)
    return $getData->result_array();
    else
return null; 
```

我的观点 ：

```
 if ( in_array(add=>'1',$permit)) {echo "YES";} else {echo "NO";} 
```

您能否告诉我视图文件中的哪些更改可以解决问题？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:59:55.940

显然，问题在于 in_array() 函数的使用

检查 in_array() 手册：

```
bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] ) 
```

第一个参数应该是字符串或其他，第二个参数是一个正在搜索的数组。

此外，在您错误地尝试定义数组的第一个参数中，数组结构块应类似于：

```
array('key'=> 'value') 
```

（字符串在冒号中）

尝试这个：

```
echo $tmp = ($permit == '1') ?  "YES" : "NO"; 
```

或者

```
$arr = array('key'=>'1');
echo $tmp = (in_array($permit, $arr)) ?  "YES" : "NO"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:00:31.503

您使用`in_array()`不正确。它`in_array($needle, $haystack)`是`$needle`某种类型的单个变量。您应该尝试`in_array('1', $permit)`（如果`$permit`实际上是一个数组）。

当然，上述答案仅适用`in_array()`于您的问题的适当解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T17:55:43.900

我认为您可以使用以下方法：

```
 <?php foreach ($permit as $rows){ 
    if ($rows['add']==1) {echo "YES";} else {echo "NO";}
} ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T21:20:00.587

看着你的问题。您似乎不确定 result_array() 返回什么。在您的情况下，它将返回以下内容：

```
array (
    array (
        "id" => 1,
        "user_id" => 1,
        "delete" => 1,
        "add" => 1,
        "edit" => 1
    )
) 
```

因此，当您尝试执行 in_array() 时，您正在查看最外面的数组，并且您的 if 语句永远不会通过。但是，解决您的问题的简单方法是更改​​您的模型并从以下位置更新此行：

```
return $getData->result_array(); 
```

至

```
return $getData->result_array()->row(); 
```

然后在您的视图中更改此行：

```
if ( in_array(add=>'1',$permit)) {echo "YES";} else {echo "NO";} 
```

至

```
if ($permit->add == 1) {echo "YES";} else {echo "NO";} 
```

这只是使用您的代码获得所需结果的一种方式。

# ipad - UITableView backgroundColor在iPad上总是灰色，Monotouch的解决方案

> ID：10853613
> 
> 赞同：1
> 
> 时间：2012-06-01T15:56:46.417
> 
> 标签：ipad, uitableview, xamarin.ios, monotouch.dialog

除了我在 Monotouch 而不是 Objective-C 中工作之外，我在[这个问题](https://stackoverflow.com/questions/2688007/uitableview-backgroundcolor-always-gray-on-ipad)中描述了同样的问题。我也在使用 Monotouch-Dialog 而不是 Interface Builder。

所以，总结一下这个问题，在*iPad*上，分组 UITableView 的背景总是灰色的，而在 iPhone 上，它显示标准的条纹背景。*当应用程序在iPad*上运行时，我希望获得相同的条纹背景。

我在 ViewDidLoad 覆盖方法中尝试了以下操作（基于我链接的问题中发布的答案），但它不起作用：

```
public class SyncDialog : DialogViewController
{
    public override void ViewDidLoad ()
    {
        this.TableView.BackgroundView = new UIView();
        base.ViewDidLoad ();
    }
} 
```

有谁知道如何让*iPad*上*Monotouch.Dialog* *DialogViewController的背景与**iPhone*上显示的一致？

 **更新：

我还尝试将tableview的*BackgroundColor更改为**UIColor.Clear*作为指示相同问题的另一个答案。所以我补充说：

this.TableView.BackgroundColor = UIColor.Clear;

但这也无济于事。我还尝试将*this.TableView.BackgroundView*设置为*null*而不是实例化另一个 UIView 对象。但是通过这两个更改，我只得到了黑色背景。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T01:49:14.770

您引用的示例还表明您需要将 TableView.BackgroundColor 设置为 UIColor.Clear**

# java - 从给定的 INSTANCE 动态创建扩展匿名类（在运行时覆盖实例中的方法）

> ID：10853621
> 
> 赞同：1
> 
> 时间：2012-06-01T15:58:01.800
> 
> 标签：java, class, inheritance, instance, anonymous

有没有办法在给定另一个实例的情况下动态创建扩展的匿名实例？会是这样的，我认为这会很棒。

```
File myFile = new File("notes.txt");

new FileWrapper extends myFile(){ //instance!!!
   @Override public boolean equals(File in){ return false;}
}; 
```

这就像复制对象实例并在特定方法中重写逻辑如果不是实现它的最佳方法是什么？

注意：我知道如果 myFile 是类名而不是实例，则该示例是有效的，但是我应该做一些事情来保存实例变量和内部信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:01:40.207

不，Java 中没有这样的功能。您将不得不依赖将调用转发到原始实例的代理对象，但它想要“覆盖”的调用除外。

请注意，如果您希望代理对象与原始对象具有相同的*类型*，则需要使用接口，因为如果代理对象将扩展原始类型，您最终会得到两个实例（如果它是完成工作的包装对象）。

**进一步阅读：**

*   [代理模式](http://en.wikipedia.org/wiki/Proxy_pattern)
*   [委托模式](http://en.wikipedia.org/wiki/Delegation_pattern)
*   [装饰图案](http://en.wikipedia.org/wiki/Decorator_pattern)

^(（是的，我同意如果有很多委托方法会变得一团糟......）)

# http - 关于字符集，使用#form# 和#getHttpRequestData()# 有什么区别？

> ID：10853622
> 
> 赞同：3
> 
> 时间：2012-06-01T15:58:04.030
> 
> 标签：http, coldfusion, localhost

我有一个coldfusion页面，uni.cfm：

```
<cfprocessingdirective pageencoding="utf-8">
<cfscript>

<cfdump var="#form.a#" label="form">
<cfdump var="#getHttpRequestData().content#" label="form2"> 
```

发送以下 HTTP 请求会在返回的 html 中首先生成字符串`"???"`，然后是字符串`"a=ΠΣΩ"`。

```
POST http://localhost:8080/uni/unicode.cfm HTTP/1.1
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
User-Agent: unicli
Host: localhost:8080
Content-Length: 8
Pragma: no-cache

a=ΠΣΩ 
```

为什么 #form.a# 不能正确处理二进制字符串，而 getHttpRequestData() 可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:57:48.470

让发件人将内容类型更改为`multipart/form-data`没有 url 编码就像一个魅力：

```
POST *URL* HTTP/1.1
Content-Type: multipart/form-data; boundary=AaB03x
Content-Length: 145

--AaB03x
Content-Disposition: form-data; name="a"

ΠΣΩ
--AaB03x-- 
```

然后能够使用#form.a# 并获得正确的字符串！

# javascript - 如何使用 javascript 获取 html 元素的 x、y 位置

> ID：10853625
> 
> 赞同：8
> 
> 时间：2012-06-01T15:58:19.047
> 
> 标签：javascript, html, dom, getelementbyid

我在我的 html 文档中有几个具有某些 css 类的 div 元素，并且想要获取这些元素的 x、y 位置，在此先感谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-01T16:00:26.353

使用`getBoundingClientRect`： [http ://ejohn.org/blog/getboundingclientrect-is-awesome/](http://ejohn.org/blog/getboundingclientrect-is-awesome/)

例如：

```
var div = document.getElementById("yourDiv");
var rect = div.getBoundingClientRect();
alert("Coordinates: " + rect.left + "px, " + rect.top + "px"); 
```

请记住，它`getBoundingClientRect`给出了*相对于当前视口*的坐标，这意味着如果你想知道相对于 的坐标`document.body`，你必须添加水平和垂直滚动量（`document.documentElement.scrollLeft`或者`document.body.scrollLeft`对于 Firefox，`.scrollTop`当然是）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:08:13.737

如果我理解，你想这样做[http://www.quirksmode.org/js/findpos.html](http://www.quirksmode.org/js/findpos.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:11:15.727

下面的示例展示了如何检索 HTML 元素的 ClientRect

```
# first tag link of this page
document.getElementsByClassName('post-taglist')[0].children[0].getClientRects()[0]
# question div
document.getElementById('question').getClientRects()[0] 
```

有了它，您可以访问右、上、高、宽、左和下属性。

# php - 如何将javascript变量放入php echo

> ID：10853630
> 
> 赞同：2
> 
> 时间：2012-06-01T15:58:39.227
> 
> 标签：php, javascript

我想将 JavaScript 变量添加到 php echo

```
arr[i]='<?php echo $winner[javascript variable]; ?>'; 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T16:00:37.517

你不能。

1.  PHP 在服务器上运行并输出一些文本。
2.  文本被发送到浏览器
3.  浏览器将文本解释为 HTML / JavaScript / 等

执行 JavaScript 时，PHP 已完成运行。

如果你想传回数据，你需要发出一个**新**的HTTP 请求并从头开​​始运行一个 PHP 脚本。

# matlab - 在 Matlab 图中更新图像对象的快速方法

> ID：10853633
> 
> 赞同：5
> 
> 时间：2012-06-01T15:58:46.790
> 
> 标签：matlab, image-processing

我需要在 Matlab 图中尽快显示更新的图像。每个图像都经过处理然后显示。但是，彩色图像的显示速度非常慢。例如，当我运行以下代码时

```
videoObj = VideoReader('sample.avi');
nFrames = videoObj.NumberOfFrames;
h = videoObj.Height;
w = videoObj.Width;
mov(1:nFrames) = struct('cdata', zeros(h, w, 3, 'uint8'), 'colormap', []);
for k = 1 : nFrames
    mov(k).cdata = read(interObj, k);
end

tic
for i=1:nFrames
    frame = mov(i).cdata;
    image(frame);
    drawnow;
end
secPerFrame = toc/nFrames 
```

`secPerFrame = 0.012`更新每一帧需要几秒钟。其中每一帧是一个 640x480 像素的 RGB 图像。因此，如果我想以每秒 30 帧的速度处理视频流，`0.033 - 0.012 = 0.021`在减去与图像显示相关的开销后，这将“仅”留下几秒钟用于实际图像处理。

有没有更快的方法来更新 Matlab 中的图像对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:17:05.723

如果所有图像的大小相同，则可以使用该`image`命令一次，然后更新`CData`坐标区的属性。

```
videoObj = VideoReader('sample.avi');
nFrames = videoObj.NumberOfFrames;
mov(1:nFrames) = ...
    struct('cdata', zeros(vidHeight, vidWidth, 3, 'uint8'), 'colormap', []);
for k = 1 : nFrames
    mov(k).cdata = read(interObj, k);
end

tic
    image(mov(1).cdata);
    imageHandle = get(gca,'Children');
for i=1:number
    frame = mov(i).cdata;
    set(imageHandle ,'CData',frame);
    drawnow;
end
secPerFrame = toc/number 
```

这仍然会很慢，因为 Matlab 图形没有针对显示视频进行优化。如果应用程序允许进行预处理，则将其作为电影文件保存到磁盘，并调用外部程序进行显示。

# flash - 如何在 Flash 中正确加载精灵表？

> ID：10853635
> 
> 赞同：0
> 
> 时间：2012-06-01T15:58:49.670
> 
> 标签：flash, actionscript-2, sprite-sheet

作为 Flash 的普通用户，您知道您可以将图像导出到移动剪辑，逐帧执行，但这不是非常“优化”的方式，在 C++ 中，我现在无法与之交谈的朋友已经阅读了spritesheet 并通过它进行动作和一切，并且由于 AS2 基本上是 C++，因此类似的代码会发生这种情况，但我没有设法找到它。

我想要的是从像这样的精灵表中导入相同大小的图像：http: [//j.imagehost.org/0829/WoodyGX_0.jpg](http://j.imagehost.org/0829/WoodyGX_0.jpg)

它们都是相同大小的图像放在一起形成精灵表，所以有这个“算法”可以读取每个图像并将其标记为动作使用，但因为我不知道我在问能告诉我的人可能的算法或将这张纸、每张图像的图像读入我的电影剪辑的方法。

现在谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:11:46.643

我忍不住想引用你的话：

> AS2 基本上是 C++

只是因为我喜欢。

反正。是的，你可以做到，但 AS2 的工具集相当有限，所以会很困难。首先，您需要使用`BitmapData.draw()`方法创建一个包含您加载的 spritesheet 的所有像素的 bitmapdata 对象。

接下来，您可以选择做`BitmapData.copyPixels()`或`BimtapData.draw()`（同样，您可以从另一个位图数据中绘制，只使用它的一部分 - 您需要查看要传递矩形和矩阵的参数，告诉它哪一部分完全复制。

最后，要绘制它，您将使用`MovieClip.beginBitmapFill(bitmapdata)`, 并绘制边界以填充您已有的位图数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T16:19:34.787

要扩展他的不可发音的答案，您需要使用[MovieClipLoader](http://help.adobe.com/en_US/AS2LCR/Flash_10.0/00001383.html#411260)加载您的精神表。然后，您需要创建一个 BitmapData 并从您加载到的 MovieClip 中[绘制像素。](http://help.adobe.com/en_US/AS2LCR/Flash_10.0/00000786.html)然后，您可以直接使用它作为源来绘制或将[像素复制](http://help.adobe.com/en_US/AS2LCR/Flash_10.0/00000784.html#152508)到作为您的角色的 BitmapData，每次都计算您想要的姿势，或者您可以创建许多不同的 BitmapData 实例并为每个实例绘制一个姿势。然后你迭代，每次都将一个较小位图的所有像素绘制到你的角色上。

# c# - 如何在C#中将数组转换为一定大小的数组列表

> ID：10853637
> 
> 赞同：0
> 
> 时间：2012-06-01T15:58:50.760
> 
> 标签：c#, arrays, list

如何在 C# 中将数组转换为一定大小的数组列表？

例如：

```
 byte[] incoming = {1,2,3,4};
 List<byte[]> chunks = new List<byte[]>; 
```

我想要得到的是这样的东西，得到一些大小的块，下面我用了 2。

```
 chunks[0] = {1,2};
 chunks[1] = {3,4}; 
```

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T16:04:45.533

这个辅助方法应该让事情变得更容易：

```
public static byte[] Partial(byte[] source, int start, int length)
{
    byte[] b = new byte[length];
    Array.Copy(source, start, b, 0, length);
    return b;
} 
```

从那里，您可以执行以下操作：

```
for (int index = 0; index < incoming.Length; index += 2)
{
    List.Add(Partial(incoming, index, 2));
} 
```

# encryption - 为什么我不能使用 OpenSSL 加密？

> ID：10853639
> 
> 赞同：3
> 
> 时间：2012-06-01T15:58:53.953
> 
> 标签：encryption, openssl, rsa

我在创建公钥/私钥对并使用它来加密文件时遇到问题。

首先我生成私钥：

```
openssl genrsa -out private.pem 2048 
```

然后我提取公钥：

```
openssl rsa -in private.pem -out public.pem -outform PEM -pubout 
```

这样我就可以加密我的文件：

```
openssl rsautl -encrypt -inkey public.pem -in myfile.txt -out file.ssl 
```

但后来有人告诉我：

```
Loading 'screen' into random state - done
unable to load Private Key
7064:error:0906D06C:PEM routines:PEM_read_bio:no start line:pem_lib.c:696:
    Expecting: ANY PRIVATE KEY 
```

我不明白...为什么要尝试加载*私钥*？如何使用公钥加密文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T20:03:21.927

您忘记指定它是公钥，需要[显式](http://www.openssl.org/docs/apps/pkeyutl.html)完成。这有效（我正在使用`pkeyutl`，不推荐使用特定的“utl”）：

```
openssl pkeyutl -encrypt -in myfile.txt -pubin -inkey public.pem -out file.ssl 
```

您必须小心放置`-pubin`- 如果在`-inkey public.pem`example 之后指定它，您将再次收到与以前相同的错误。是的，我知道。

# ruby-on-rails - ajax请求上的Ruby on Rails错误500

> ID：10853640
> 
> 赞同：1
> 
> 时间：2012-06-01T15:58:54.210
> 
> 标签：ruby-on-rails, jquery, error-handling

在应用程序启动时，我想用随机数据生成 10 个人。当我这样做时，我希望能够按类别异步过滤它们。这是代码：

型号代码：

```
class Person   
   attr_accessor :name, :text, :category, :timeStamp
end 
```

控制器代码：

```
class PersonController < ApplicationController

  def index
    @persons = []
    @categories = ["history", "science", "religion"]
    10.times do
      person = Person.new
      person.name = [*('A'..'Z')].sample(8).join
      person.text = [*('A'..'Z')].sample(64).join
      person.category =  @categories.sample   
      person.timeStamp = Time.at(rand * Time.now.to_i)
      @persons.append(person)
    end
  end  

  def loadPersonsByCategory    
    @filteredPersons = @persons.where(:category => params[:category])
    render :json => @filteredPersons
  end
end 
```

查看代码：

```
 <div id="personsTitle">Persons details</div>
    <div id="gridFilter">
        <label class="personText">Show persons from</label>
        <select id="filterCategory">
            <option selected="selected">All</option>
            <% @categories.each do |category| %>
                <option value="<%= category %>"><%= category %></option>
            <% end %>
        </select>
        <label class="personText">categories</label>        
    </div>
    <div id="personsGrid">
        <div class="gridRow gridHeader">        
            <div class="gridItem"><label class="personText">Name</label></div>
            <div class="gridItem"><label class="personText">Person's text</label></div>
            <div class="gridItem"><label class="personText">Category</label></div>
            <div class="gridItem"><label class="personText">Time stamp</label></div>
        </div>  
        <div id="gridBody"> 
            <% @persons.each do |person| %>
            <div class="gridRow">       
                <div class="gridItem"><label class="personText"><%= person.name %></label></div>
                <div class="gridItem"><label class="personText"><%= person.text %></label></div>
                <div class="gridItem"><label class="personText"><%= person.category %></label></div>
                <div class="gridItem"><label class="personText"><%= person.timeStamp %></label></div>
            </div>      
            <% end %>
        </div>  
        <div class="gridRow gridFooter">        
            <div class="gridItem"><label class="personText">First</label></div> 
            <div class="gridItem"><label class="personText"><</label></div> 
            <div class="gridItem"><label class="personText">1</label></div> 
            <div class="gridItem"><label class="personText">2</label></div> 
            <div class="gridItem"><label class="personText">3</label></div> 
            <div class="gridItem"><label class="personText">></label></div>     
            <div class="gridItem"><label class="personText">Last</label></div> 
```

JavaScript 代码：

```
$(function(){
    $('#filterCategory').on('change', FilterCategories);
});

function FilterCategories(){
    $.ajax(
        {
            type: "POST",
            url: "/person/loadPersonsByCategory",
            data: { category: $(this).val() },  
            contentType: "application/json; charset=utf-8",
            dataType: "json",             
            success: function (result) {
                var persons = [];               
                for (var i = result.length; i--; ) {
                    persons.push('<div class="gridRow">' +
                                        '<div class="gridItem"><label class="personText">' + result[i].name + '</label></div>' +
                                        '<div class="gridItem"><label class="personText">' + result[i].text + '</label></div>' +
                                        '<div class="gridItem"><label class="personText">' + result[i].category + '</label></div>' +
                                        '<div class="gridItem"><label class="personText">' + result[i].timeStamp + '</label></div>' +
                                '</div>');                                                        

                }

                $('<div/>', { 'class': 'filterResult', html: persons.join('')}).appendTo('#gridBody');
            },
             error:function (xhr, ajaxOptions, thrownError){
                    alert(xhr.status);
                    alert(thrownError);
            }    
        });
} 
```

在我尝试使用 ajax 过滤人员之前，一切都很好。我收到 500 内部服务器错误。什么可能导致此错误？非常感谢！

Plus 服务器错误日志

```
Started POST "/Person/loadPersonsByCategory" for 127.0.0.1 at 2012-06-01 19:09:07 +0200
Processing by PersonController#loadPersonsByCategory as JSON
  Parameters: {"category"=>"religion"}
Completed 500 Internal Server Error in 1ms

NoMethodError (undefined method `where' for nil:NilClass):
  app/controllers/person_controller.rb:17:in `loadPersonsByCategory' 
```

路线.rb：

```
 TestAssignment::Application.routes.draw do
      get "person/index"

  match "/Person/loadPersonsByCategory", :controller => "person", :action => "loadPersonsByCategory"

      # The priority is based upon order of creation:
      # first created -> highest priority.

      # Sample of regular route:
      #   match 'products/:id' => 'catalog#view'
      # Keep in mind you can assign values other than :controller and :action

      # Sample of named route:
      #   match 'products/:id/purchase' => 'catalog#purchase', :as => :purchase
      # This route can be invoked with purchase_url(:id => product.id)

      # Sample resource route (maps HTTP verbs to controller actions automatically):
      #   resources :products

      # Sample resource route with options:
      #   resources :products do
      #     member do
      #       get 'short'
      #       post 'toggle'
      #     end
      #
      #     collection do
      #       get 'sold'
      #     end
      #   end

      # Sample resource route with sub-resources:
      #   resources :products do
      #     resources :comments, :sales
      #     resource :seller
      #   end

      # Sample resource route with more complex sub-resources
      #   resources :products do
      #     resources :comments
      #     resources :sales do
      #       get 'recent', :on => :collection
      #     end
      #   end

      # Sample resource route within a namespace:
      #   namespace :admin do
      #     # Directs /admin/products/* to Admin::ProductsController
      #     # (app/controllers/admin/products_controller.rb)
      #     resources :products
      #   end

      # You can have the root of your site routed with "root"
      # just remember to delete public/index.html.
      root :to => 'person#index'

      # See how all your routes lay out with "rake routes"

      # This is a legacy wild controller route that's not recommended for RESTful applications.
      # Note: This route will make all actions in every controller accessible via GET requests.
      # match ':controller(/:action(/:id))(.:format)'
    end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:22:11.793

删除此行

```
contentType: "application/json; charset=utf-8", 
```

您发布标准的 application/x-www-form-urlencoded 数据，但告诉 Rails 期待 JSON 编码的数据。它尝试解码数据并在此步骤中失败。

# amazon-ec2 - 从弹性负载均衡器中删除上传的证书

> ID：10853642
> 
> 赞同：30
> 
> 时间：2012-06-01T15:59:04.747
> 
> 标签：amazon-ec2, amazon-web-services, ssl-certificate, amazon-elb

我一直在测试和试验，以了解如何准确地将 SSL 证书上传到 AWS 的 Elastic Load Balancer（找出不同密钥和证书编码的问题）。

因此，我在那里有相当多的测试证书，我使用错误的信息、缺少的证书链或只是伪造的数据生成了这些证书。

据我所知，无法删除这些证书，甚至无法更新/替换缺少某些信息的证书。AWS 关于“更新证书”的说明（[http://docs.amazonwebservices.com/ElasticLoadBalancing/latest/DeveloperGuide/US_UpdatingLoadBalancerSSL.html](http://docs.amazonwebservices.com/ElasticLoadBalancing/latest/DeveloperGuide/US_UpdatingLoadBalancerSSL.html)）实际上只是向您展示了如何更改负载均衡器侦听器以使用不同的证书那里或者你也可以上传！（这正是我最终在那里获得这么多证书的原因）。

有人可以告诉我我错了，有办法删除它们吗？：D（最好还有如何做到这一点）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-02-12T16:24:32.787

您可以使用以下命令删除 ELB 关联证书

```
 aws iam delete-server-certificate --server-certificate-name certificate_object_name 
```

您可以拥有的这些证书的数量是有限制的 [10]。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-04T22:46:53.653

编辑：七年后，命令发生了一些变化：

`aws iam delete-server-certificate --server-certificate-name <cert-name>`

您可以使用以下方式获取证书名称：

`aws iam list-server-certificates`

* * *

您可以使用命令行工具`iam-servercertdel`来执行此操作。不过，您需要先获取路径：

```
iam-servercertlistbypath 
```

一旦你有了它，你可以删除它：

```
iam-servercertdel arn:aws:iam::10494620000:server-certificate/my-company-cert 
```

然而，chantheman 是正确的，因为 AWS 服务有时可能会不稳定，因此重新创建 ELB 有时会更好。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-01T16:45:25.603

这是不可能的。您必须删除 ELB 并创建一个新的。

请参阅： [https ://forums.aws.amazon.com/thread.jspa?threadID=57632](https://forums.aws.amazon.com/thread.jspa?threadID=57632)

可以从 IAM 中删除它们，但它们并不总是从 ELB 中正确删除，ELB 可以继续使用旧的。我肯定会说最安全的方法是创建一个新的 ELB 并删除旧的

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-07T08:28:41.390

使用 amazon API 工具发出以下命令：

```
iam-servercertdel -s SERVERCERTNAME 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-04T19:39:01.803

这不可能通过 Amazon 控制台，而是通过 API 调用。[http://docs.amazonwebservices.com/IAM/latest/APIReference/API_DeleteServerCertificate.html](http://docs.amazonwebservices.com/IAM/latest/APIReference/API_DeleteServerCertificate.html)您可能没有注意到这一点，因为它们在 IAM 下，而不是 EC2 下。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-13T06:15:15.833

您的第一步应该是停止在负载均衡器中使用证书。要么将所有侦听器交换到另一个证书，要么根本不使用证书。@SDillard 在他的回答中建议您应该等待几分钟，然后再继续删除证书。

您可以在 AWS Powershell 控制台中使用以下命令删除证书（有关如何使用其他工具执行此操作的详细信息，请参阅其他答案）。安装[适用于 .Net 的 AWS 开发工具包](http://aws.amazon.com/sdkfornet/)以获取控制台。

```
Remove-IAMServerCertificate <CertificateName> 
```

请注意，`<CertificateName>`不应是**完整**的资源标识符，如下所示。证书名称是最后一段。

arn:aws:iam::297826370175:服务器证书/

要获取所有证书的列表，可以使用以下命令。

```
Get-IAMServerCertificates 
```

现在，当您返回负载均衡器（在 AWS 管理控制台中）中侦听器的 SSL 证书配置时，您应该不会再在下拉框中看到您删除的证书。

如果由于某种原因，这不起作用，那么您也可以尝试重新创建负载均衡器（删除现有的并创建一个新的）。但请注意，这可能意味着您需要进行一些与 DNS 相关的更改，因为新的负载均衡器将具有不同的 DNS 名称。您的 CName 记录可能需要更改。

**更新：**自从我第一次发布这个答案以来，API 似乎发生了一些变化。我只是能够删除当前由侦听器使用的证书。尽管在侦听器中，证书列中显示“无效证书”，但当我浏览该站点时，旧证书继续被退回-不确定这是否只是暂时的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-11T06:34:24.173

如果 ELB 上未使用证书，请使用其他答案中提到的 IAM 工具。如果是，那么您不应将其从 IAM 中删除，而应为 ELB 设置新的、正确的证书，然后使用 IAM 工具删除未使用的证书。我还建议您在更改证书后等待几分钟，然后再删除旧证书，因为正确的证书可能需要一些时间才能传播；只需挖掘 ELB DNS 名称并点击每个 IP 地址以确保它返回新证书即可。

此外，最新版本的 AWS 控制台确实支持更新现有负载均衡器上的证书，但您仍然必须使用 IAM 工具来删除不需要的证书。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-18T00:41:23.697

据我所知（至少使用 Boto3）

*   您可以向侦听器添加新证书，但不能作为默认证书（isDefault 属性被拒绝）
*   您不能删除现有的“默认”证书，而它是默认证书
*   您不能修改哪个证书是默认证书
*   SSL 侦听器可能没有证书（您不能删除所有证书并添加新的默认证书）。

因此，剩下的唯一选择是删除负载均衡器或删除侦听器（嘿嘿！）。因为监听器可能会附加很多路由信息，这是一个 PITA。所以，我推荐的是：

*   上传证书
*   检索引用旧 SSL 的侦听器的状态
*   记下他们的规则
*   删除那些听众
*   仅更改其 CertificateArn 即可重新创建它们（指向您的新证书。

像这样的东西：

```
 import boto3

   def fixRule(rule): 
            """Copy a rule so that it can be submitted as a new rule"""
            rule = rule.copy()
            if rule["IsDefault"]:
                # The default rule is set at create_listener
                return None

            def fix_condition(c):
                c = c.copy()
                del c["Values"]
                return c
            rule["Conditions"] = [fix_condition(c) for c in rule.get("Conditions",())]
            # del rule["Priority"]
            del rule["RuleArn"]
            del rule["IsDefault"]
            # rule["Priority"] = rule["Priority"]
            try:
                rule["Priority"] = int(rule["Priority"])
            except:
                del rule["Priority"]
            return rule

   acmClient = session.client('acm')
   response = acmClient.import_certificate(
                Certificate=certificate,
                PrivateKey=privatekey,
                CertificateChain=chain
            )
   current_ssl_arn = response[ 'CertificateArn']

   session.client('resourcegroupstaggingapi').tag_resources(
                ResourceARNList=[
                    current_ssl_arn
                ],
                Tags={ ... whaterver }
                }
            )

   # Replace each SSL listener with one that has a new certificate.
   lbClient = session.client('elbv2')
   listeners = lbClient.describe_listeners(LoadBalancerArn=self.lb_arn["Listeners"]

   # Make existing listeners use the certificate
   # Delete exisiting listeners with SSL certificates
   # Create a new one with the same parameters and rules as the old one.
   for l in listeners:
            oldListenerArn = l["ListenerArn"]

            # Only deal with SSL listeners
            if l.get("SslPolicy")==None: continue

            _listener_certs = l.get("Certificates",())
            _listener_cert_arns = set(c['CertificateArn'] for c in _listener_certs)

            # Great! already up-to-date
            if current_ssl_arn in _listener_cert_arns: continue

            # Backup the rules
            oldRules = lbClient.describe_rules(ListenerArn=oldListenerArn)['Rules']

            # Recreate the listener with the new certificate
            print("Replacing listener")
            _ = lbClient.delete_listener(ListenerArn = oldListenerArn)

            l = l.copy()
            del l["ListenerArn"]
            l["Certificates"] = [{"CertificateArn":current_ssl_arn}]
            newListener = lbClient.create_listener(**l)["Listeners"][0]
            newListenerArn = newListener["ListenerArn"]

            print("Replacing listener .. copying ({}) rules ".format(len(oldRules)))
            for rule in oldRules:
                rule = fixRule(rule)
                if rule is None: continue
                _ = lbClient.create_rule(
                    ListenerArn=newListenerArn,
                    **rule)
            print("Replacing listener .. OK") 
```

它并不理想，因为如果出现任何问题，就会出现停机时间。虽然我认为这是亚马逊提供的工具中最好的。

# c# - 为什么 RichTextBox 的 Font.Size 属性在设计时是可编辑的，但在编译时是只读的？

> ID：10853645
> 
> 赞同：-2
> 
> 时间：2012-06-01T15:59:27.917
> 
> 标签：c#, winforms, fonts, richtextbox, font-size

这段代码：

```
private void comboBoxFontSize_SelectedIndexChanged(object sender, EventArgs e) {
    rtbResults.Font.Size = Convert.ToInt32(comboBoxFontSize.SelectedItem);
} 
```

...生成此错误消息：*“无法将属性或索引器‘System.Drawing.Font.Size’分配给——它是只读的”*

## 更新

在尝试了建议的修复后，我在运行时得到了这个：

System.FormatException 未处理 Message=输入字符串的格式不正确。Source=mscorlib StackTrace：在 System.Number.StringToNumber(String str, ...

好的，我明白了：我使用的是 Convert.ToInt32() 但组合框中的第一个值是“8.25” - 这显然不是一个 int。

所以我尝试了 Convert.ToDouble() 并且无法编译。

然后我在智能感知提示中看到*“调用此方法*总是抛出 'System.InvalidCastException'”*

*   以及 Convert.ToSingle()

那么我必须将我的组合框值从 8.25 更改为 8 吗？8.25 是默认值...？？？

## 再次更新

我在周末读到（在 Petzold 的 WP7 书中，我认为）8.25 对应于 11。所以我认为这里提到的 8.25 是像素，对应于 11 的字体大小，现在更有意义（尽管仍然过于误导/混淆）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T16:03:54.770

因为字体是不可变的......

[为什么字体不可变？](https://stackoverflow.com/questions/1561126/why-is-font-immutable)

利用

```
rtbResults.Font = new Font(rtbResults.Font.FontFamily, Convert.ToInt32(comboBoxFontSize.SelectedItem), 
rtbResults.Font.Style) 
```

或您需要的另一个 Font 构造函数。

# regex - 我将如何制作这个正则表达式？

> ID：10853648
> 
> 赞同：1
> 
> 时间：2012-06-01T15:59:45.403
> 
> 标签：regex

我想匹配这些字符串中的“e”：

> e
> 
> 前任
> 
> 前任
> 
> 电子版

但是，我不想匹配其中任何一个中的“ex”或破折号。

我在正则表达式中想要的是它必须只匹配上述所有字符串中的 e 而不是这些：

> X
> 
> x-ex
> 
> 前任

这可能真的很容易，但我在正则表达式制作方面做得并不好。

我试过`e[^x]`了，但这与字符串“e”不匹配，并且在“ex-ex”、“ex”和“e-ex”中匹配了“e-”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:02:56.093

**尝试这个**

```
(?i)\be\b 
```

**解释**

```
"
(?i)    # Match the remainder of the regex with the options: case insensitive (i)
\b      # Assert position at a word boundary
e       # Match the character “e” literally
\b      # Assert position at a word boundary
" 
```

# jquery - 在 Jquery Ajax 调用中使用带冒号的 JSON 数据

> ID：10853650
> 
> 赞同：0
> 
> 时间：2012-06-01T15:59:47.407
> 
> 标签：jquery, ajax, json

我有如下所示的 json，尽管这只是它的开始，而不是全部。

```
{"ns1:AmplifyResponse":{"AmplifyReturn":{"Topics":{"Domains":null,"TopTopics":[{"Topic":{"Name":"loo","Value":5.00}," 
```

我正在执行此 jquery ajax 调用来获取它，再次对其进行修剪：

```
 $.ajax ({
    type: "POST",
    url: 'ajax/openampcheck.php',
    dataType: 'json',
    async: true,
    data: {"inputtext": inputmaintext},
    success: function(msg){
$('#oaresult').html(msg.ns1:AmplifyResponse.AmplifyReturn.Topics.TopTopics[1].Topic.Name);
.... 
```

在 Chrome 控制台中，这给了我一个错误... Uncaught SyntaxError: Unexpected token 。对于最后一行，这似乎与这里的冒号有关...

```
ns1:AmplifyResponse 
```

如果我用引号括起来，即

`$('#oaresult').html(msg."ns1:AmplifyResponse".AmplifyReturn.Topics.TopTopics[1].Topic.Name)`;

然后我得到这个错误：

```
Uncaught SyntaxError: Unexpected identifier 
```

我应该如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:01:38.547

```
$('#oaresult').html(
              msg["ns1:AmplifyResponse"] // you have to use object["prop"] here
              .AmplifyReturn
              .Topics
              .TopTopics[1]
              .Topic.Name); 
```

或者

```
$('#oaresult').html(msg["ns1:AmplifyResponse"]["AmplifyReturn"]["Topics"]["TopTopics"][1].["Topic"]["Name'}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:01:45.940

尝试：

```
$('#oaresult').html(msg["ns1:AmplifyResponse"].AmplifyReturn.Topics.TopTopics[1].Topic.Name); 
```

# php - PHP：提供特定于“媒体查询报告的屏幕宽度”的内容

> ID：10853652
> 
> 赞同：2
> 
> 时间：2012-06-01T15:59:52.720
> 
> 标签：php, html, mobile, tablet, responsive-design

# 前提

在一个网站上工作，该网站根据正在查看的设备提供内容。该网站基本上有两个版本：

1.  PC & 平板电脑版
2.  手机版

“PC 和平板电脑版”提供更高质量的图像和不同的站点导航方法（想象一下没有缩放的谷歌地图）。

移动版本将此“地图”限制为垂直滚动。

两个版本的元`viewport`设置为`width=device-width, initial-scale=1.0, user-scalable=no`.

# 问题

有些平板电脑*报告*的设备分辨率非常差。示例：三星 Galaxy Tab 7" 在媒体查询中报告设备宽度为 663 像素。而“PC 和平板电脑版本”要求最小宽度为 960 像素。

它真的只是一部大手机。

仅媒体查询不足以适应网站。该网站需要固定宽度，因为它像大自然的地图。

解决方案是为这些平板电脑提供“手机版”。但这需要在服务器端完成。

我正在使用的自动取款机[`PHP Mobile Detect`](http://code.google.com/p/php-mobile-detect/)。可以手动将“大手机平板电脑”添加到“手机”列表中。痛苦，我在任何地方都找不到平板电脑的“css报告”屏幕分辨率列表。

有没有这样的清单？或者甚至有一个维护的 php 库让我在服务器端查询屏幕大小（基于报告的 UserAgent）？

我还可以检查客户端的屏幕大小，如有必要，更正并覆盖服务器的选择。但我想避免这种情况。

PS：是的。我知道这不是响应式设计的政治正确方式，我别无选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:21:37.263

以下是一些维护移动设备列表的 Web 服务：

*   [51度](http://51degrees.com/Products/Device-Detection)
*   [WURFL](http://wurfl.sourceforge.net/)
*   [检测权](http://detectright.com/)
*   [设备图集](https://deviceatlas.com/device-data/user-agent-tester)
*   [手机检测](http://www.handsetdetection.com/)

和一些指导方针：

*   [Web 内容转换代理指南 1.0](http://www.w3.org/TR/ct-guidelines/)

**参考**

*   [用户代理检测库](https://wiki.mozilla.org/Compatibility/UADetectionLibraries)

# c# - 增强 WPF 网格视图中特定列的显示

> ID：10853659
> 
> 赞同：8
> 
> 时间：2012-06-01T16:00:07.353
> 
> 标签：c#, wpf, wpfdatagrid

我目前正在编写的 WPF 应用程序中有一些用户管理功能，并希望使其对最终用户更直观

我希望能够提供某种方法来轻松编辑给定用户所属的角色列表。目前网格由于绑定到一个`List<ApplicationUser>`

`ApplicationUser`是我自己的类定义为：

```
public class ApplicationUser
{
        public Guid? UserId { get; set; }
        public string GivenName { get; set; }
        public string Surname { get; set; }
        public string EmailAddress { get; set; }
        public string UserPhone { get; set; }
        public string NtLoginName { get; set; }
        public List<Role> ApplicationRoles { get; set; }
} 
```

可以看出，用户所在的角色保存在`List<Role>`. `Role`是我自己的类定义为：

```
public class Role
{
   public Guid RoleId;
   public string RoleName;
   public string RoleDescription;
} 
```

下面的模型代表当前状态，我只是将角色作为列表获取，并通过使用转换器将角色显示为网格视图中的换行符分隔字符串

![网格视图的当前状态](../Images/f59155824524bcd196814d39e194f527.png)

然而，这是我想要实现的，以便更轻松地切换和启用各个组的成员资格。

![所需的网格视图状态](../Images/1ba5192f021a65d3d767ce5c2ddf22aa.png)

现在我想了想，我可能不得不更改 Role 的定义以包含一个 IsMember 属性，以方便绑定复选框，但如果有人有更好的方法，我也会欢迎。我可以更改 sproc 中的 JOIN 类型，这样我就可以通过有关特定用户的查询来获取所有角色，并相应地填充 IsMember 属性。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T19:01:41.057

这是我为帮助您入门而编写的一小段代码。我假设您可以在创建应用程序用户时水合类的`IsMember`属性。`Role`我采取了最简单的方法，即在所有用户中拥有所有角色（`enum flags`本来是最好的，但考虑到您的数据，我不确定这是一个没有管道的选项）。我使用最少的列来传达这个想法。如果您`INotifyPropertyChanged`至少在角色上实现，则可以连接到通知并将其保留回数据库中，当前端的复选框更改时。

* * *

**主要考试**

```
<DataGrid DataContext="{StaticResource ResourceKey=AllUsers}" ItemsSource="{Binding}" AutoGenerateColumns="False">
        <DataGrid.Columns>
        <DataGridTextColumn Binding="{Binding GivenName}" />
        <DataGridTextColumn Binding="{Binding Surname}" />
        <DataGridTemplateColumn>
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <ItemsControl ItemsSource="{Binding ApplicationRoles}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <CheckBox Content="{Binding RoleName}" IsChecked="{Binding IsMember, Mode=TwoWay}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
    </DataGrid.Columns>
</DataGrid> 
```

* * *

**数据Xaml**

```
<x:Array x:Key="AllUsers" Type="Sample:ApplicationUser">
    <Sample:ApplicationUser GivenName="Andrew" Surname="Fuller">
        <Sample:ApplicationUser.ApplicationRoles>
            <Sample:Role RoleName="Administrators" IsMember="True"/>
            <Sample:Role RoleName="Shift Analysts"/>
            <Sample:Role RoleName="Shift Managers" IsMember="True"/>
        </Sample:ApplicationUser.ApplicationRoles>
    </Sample:ApplicationUser>
    <Sample:ApplicationUser GivenName="Anne" Surname="Dodsworth">
        <Sample:ApplicationUser.ApplicationRoles>
            <Sample:Role RoleName="Administrators"/>
            <Sample:Role RoleName="Shift Analysts" IsMember="True"/>
            <Sample:Role RoleName="Shift Managers" IsMember="True"/>
        </Sample:ApplicationUser.ApplicationRoles>
    </Sample:ApplicationUser>
</x:Array> 
```

* * *

**类定义**

```
public class ApplicationUser
{
    public Guid? UserId { get; set; }
    public string GivenName { get; set; }
    public string Surname { get; set; }
    public string EmailAddress { get; set; }
    public string UserPhone { get; set; }
    public string NtLoginName { get; set; }
    public List<Role> ApplicationRoles { get; set; }

    public ApplicationUser()
    {
        ApplicationRoles = new List<Role>();
    }
}

public class Role
{
    public Guid RoleId { get; set; }
    public string RoleName { get; set; }
    public string RoleDescription { get; set; }

    public bool IsMember { get; set; }
} 
```

* * *

**结果**

![截屏](../Images/023830d33dab0327841c4cdad77533bb.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T07:30:27.643

如果 Roles 列始终显示相同的角色列表，您可以使用从 CheckBox 和 TextBlock 构建的 ItemTemplate 轻松地将 ListView 绑定到所有角色的列表。
然后，您可以轻松地将 CheckBox 的 IsChecked 属性绑定到用户角色，并使用如果角色在用户角色列表中则返回 True 的转换器。

# extjs - 从 RowEditing 组件（在本例中为组合框）获取 RowEditing 或 Grid

> ID：10853666
> 
> 赞同：0
> 
> 时间：2012-06-01T16:00:38.700
> 
> 标签：extjs, extjs4

我正在为组合框构建一个“修复”，因为当您打开行编辑器时，它会在文本框中显示值字段而不是显示字段。但是，要做到这一点，我必须在发送到服务器之前更改组合框的值。为此，我的想法是挂钩到行编辑插件的 beforeedit 事件。

最大的问题是我无法找到一种方法来访问我正在编辑行的网格，或者直接使用行编辑插件。

我唯一能找到的是组合框所在的形式，`combobox.up('form')`我可以挂钩这些事件，但我认为它们不会“足够早”发生。但是，我找不到从表单中获取行编辑插件的方法：\

关于如何解决这个问题的任何想法？

**编辑1：**

根据 sha 的要求，这是显示为图像的问题：

[http://dl.dropbox.com/u/762638/Files/Images/Screenshots/show_combobox_extjs_problem/part_1.png](http://dl.dropbox.com/u/762638/Files/Images/Screenshots/show_combobox_extjs_problem/part_1.png)

[http://dl.dropbox.com/u/762638/Files/Images/Screenshots/show_combobox_extjs_problem/part_2.png](http://dl.dropbox.com/u/762638/Files/Images/Screenshots/show_combobox_extjs_problem/part_2.png)

[http://dl.dropbox.com/u/762638/Files/Images/Screenshots/show_combobox_extjs_problem/part_3.png](http://dl.dropbox.com/u/762638/Files/Images/Screenshots/show_combobox_extjs_problem/part_3.png)

在这里您可以找到组合框代码：

```
Ext.define('Fdd.form.field.XComboBox', {
  extend: 'Ext.form.field.ComboBox',
  alias: 'widget.xcombobox',

  displayField: 'display',
  queryMode: 'local',
  valueField: 'value',
  //forceSelection: true,

  /**
   *
   * @property {Ext.form.Panel} parentForm
   * Contains a reference to the combobox form, used internally
   *
   * @readonly
   */
  parentForm: null,
  /**
   *
   * @property {Boolean} hasChanged
   * `true` if the combobox has changed its value since last show/hide cycle
   */
  hasChanged: false,

  statics: {
    xcomboboxRenderer: function(xcombobox) {
      return function(value, metaData, record, rowIndex) {
        if (value === null)
          return '';
        return xcombobox.store.getById(value.toString()).get('display');
      }
    }
  },

  initComponent: function() {
    var me                  = this;
    var xComboBoxStoreClass = 'Fdd.data.XComboBoxStore';
    var xComboBoxStoreKey   = Ext.getClassName(me);

    // FIXME: Fix default value to be display and not value field
    // Create the combo store if not exists
    me.createComboStoreIfNotExists = function() {
      // If store is not set, we can't do anything
      if (!me.store)
        return false;

      // If the store is an array, we break the functionality and return to a normal combobox
      // because XComboBox is to avoid problems with stores
      if (Ext.isArray(me.store))
        return false;

      // We need the object for the parent store, to avoid missing references
      var parentStore = null;
      if (Ext.isString(me.store))
        parentStore = Ext.getStore(me.store)
      else
        parentStore = me.store;

      // If the store doesn't have the updatedAt variable, we don't enable functionalities
      // because that is a requirement
      if (!Ext.isDefined(parentStore.updatedAt))
        return false;

      // If parent store is of type XComboBoxStore, it means that we already have created a combo store
      if (Ext.getClassName(parentStore) == xComboBoxStoreClass)
        return false;

      var comboStore = Fdd.NamespaceKeyedStoreManager.lookup(xComboBoxStoreKey, parentStore.storeId);
      if (!comboStore) {
        comboStore = Ext.create(xComboBoxStoreClass, parentStore);
        Fdd.NamespaceKeyedStoreManager.register(xComboBoxStoreKey, parentStore.storeId, comboStore);
      }
      me.store = comboStore;

      //me.on('afterrender', function(obj, eOpts) {
      //  obj.setValue(1);
      //});

      return comboStore;
    }

    // Load data if required
    me.loadUpdatedData = function() {
      me.createComboStoreIfNotExists();
      if (me.store)
        Fdd.NamespaceKeyedStoreManager.lookup(xComboBoxStoreKey, me.store.parentStore.storeId).loadIfNotUpdated();
    };

    // Load data if required
    me.loadUpdatedData();

    // Fires loadUpdatedData every time trigger is pressed
    me.on('expand', function(obj) {
      obj.loadUpdatedData();
    });

    // TODO: Building a fix for the problem combobox input field shows the value field instead of the display field
    me.on('boxready', function(obj) {
      obj.parentForm = obj.up('form');
      console.log(obj.parentForm);
      obj.mon(obj.parentForm, 'edit', function(editor) {
        console.log("beforeaction");
        console.log(e.originalValue);
        console.log(obj);
        if (!obj.hasChanged)
          obj.setValue(obj.originalValue);
      });
      obj.mon(obj.parentForm, 'show', function() {
        /*console.log("move:");
        console.log(obj.getValue());
        console.log(obj.inputEl.dom.value);*/
        obj.hasChanged = false;

        if (obj.parentForm) {
          if (obj.getValue() === null)
            obj.inputEl.dom.value = "";
          else
            obj.inputEl.dom.value = obj.store.getById(obj.getValue().toString()).get('display');
        }
      });
    });
    me.on('change', function(obj) {
      obj.hasChanged = true;
    });

    // Call parent initializator
    me.callParent(arguments);
  }
}); 
```

我们所说的代码是从 TODO 开始的。

我建议忽略前面的部分，因为它用于创建存储副本以避免过滤和缓冲存储。

**编辑2：**

我试图通过这个问题解决的问题似乎与我试图解决的问题（以不同的方式解决）没有直接关系，因此可以关闭问题。

不管怎么说，还是要谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:12:17.483

标准 Combobox 控件中没有错误。我在项目的很多地方都使用它，没有任何问题。

确保您在编辑器组合框、网格组合框和存储本身中具有匹配的 valueFields 类型。

# string - delphi中如何将字符串中的一个字符转换为char

> ID：10853675
> 
> 赞同：6
> 
> 时间：2012-06-01T16:01:18.133
> 
> 标签：string, delphi, char, delphi-xe2, case

我有一个字符串，我想从中提取一个需要在`Case`语句中使用的字符。事情是`Case`唯一需要`Char`值而不是字符串值。那么如何将单个字符串字符转换为字符呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T16:04:53.690

将字符串用作字符数组（从 1 开始），并使用要在`case`语句中使用的字符的索引。例如，如果您想使用第一个字符：

```
case MyString[1] Of
// ...
end; 
```

注意，请确保在使用下标之前检查字符串是否至少具有该长度，否则您将遇到访问冲突。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-06-18T20:22:59.837

由于 delphi 成为跨平台的，我将使用`TStringHelper`class out of unit使用基于 0 的字符串访问`System.SysUtils`：

```
case MyString.Chars(0) Of
// ...
end; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-03T08:56:01.833

自从在[移动平台](http://docwiki.embarcadero.com/RADStudio/Seattle/en/Zero-based_strings_(Delphi))`string`上变成 0-based 之后，还有一种从单字符串中获取 char 的始终安全的方法。

```
myString[Low(myString)] 
```

# rgraph - 当我重新加载页面并单击页面正文时，RGraph 重新加载上一个图表

> ID：10853678
> 
> 赞同：6
> 
> 时间：2012-06-01T16:01:22.953
> 
> 标签：rgraph

我用它来清除图表：

```
for (var i=0; i< document.getElementsByTagName('canvas').length; i++) {
RGraph.Clear(document.getElementsByTagName('canvas')[i]);
} 
```

当我重新加载页面时，上一个出现并且新图表放置在最后一个之上，新标签放置在最后一个之上

我用甜甜圈和饼图

谢谢！！！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T18:34:57.397

您需要清除跟踪对象的 ObjectRegistry。你可以这样做：

```
RGraph.ObjectRegistry.Clear(); 
```

或者，您可以使用以下命令清除与特定画布标签相关的对象：

```
RGraph.ObjectRegistry.Clear(myCanvas); 
```

或者，您可以使用以下方法删除特定对象：

```
RGraph.ObjectRegistry.Remove(myObject); 
```

您可以在 API 文档页面上阅读有关 ObjectRegistry 的更多信息：

[https://www.rgraph.net/canvas/api.html#objectregistry](https://www.rgraph.net/canvas/api.html#objectregistry)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-31T00:48:23.807

您也可以使用 RGraph.Clear(document.getElementById("The Id of your element"));

# soap - SOAP 信封尺寸

> ID：10853679
> 
> 赞同：0
> 
> 时间：2012-06-01T16:01:33.987
> 
> 标签：soap, envelope

我会先问这个问题，然后给出一些背景知识： **有谁知道计算 SOAP 信封大小是否包括标题，或者只是标签之外的内容？**

Content-Length 包括标题信息，但我不能假设 Content-Length = Envelope Size。SOAP 规范似乎没有解决信封大小，我开始担心它是一种“由实施者决定”的事情。

任何答案或线索都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-21T06:29:57.497

如果您正在检查它是否超过最大大小，您可以这样做：

```
 if (maxMessageSize > 0) {
            FixedByteArrayOutputStream fbaos = new FixedByteArrayOutputStream(maxMessageSize);
            try {

            } catch (XMLStreamException e) {
                handleException("Error in checking the message size", e, synCtx);
            } catch (SynapseException syne) {
                synLog.traceOrDebug("Message size exceeds the upper bound for caching, request will not be cached");
                return;
            } finally {
                try {
                    fbaos.close();
                } catch (IOException e) {
                    handleException("Error occurred while closing the FixedByteArrayOutputStream ", e, synCtx);
                }
            }
        } 
```

不过，这不是最有效的方法。所以我在[这里问了](https://stackoverflow.com/q/45229700/3599535)

# java - 从 Java 中读取 xsl 转换变量

> ID：10853685
> 
> 赞同：0
> 
> 时间：2012-06-01T16:01:56.337
> 
> 标签：java, xml, xslt

我知道我可以将参数从 Java 传递到 xsl 转换，但是在转换完成后如何读取变量/参数？

例如，我有一个这样的 xml 文档：

```
<author>
  <name>Barry Bonds</name>
  <books>
    <book>Hitting Home Runs</book>
    <book>Cheating at Baseball</book>
    <book>Nobody Likes Cooperstown Anyway</book>
  <books>
<author> 
```

在单个转换中，我希望能够转换 name 元素并将其存储为变量，还可以转换 book 元素并将它们存储为第二个变量。然后我想在转换后从 Java 代码中访问这两个变量。

这是可能的，如果是这样，它是如何完成的？

感谢迈克尔凯的回答，我现在有了一个解决方案。对于遇到此问题的其他人，这里有一个单元测试显示它是如何工作的：

```
import net.sf.saxon.*;
import org.junit.Test;

import javax.xml.transform.Result;
import javax.xml.transform.Source;
import javax.xml.transform.TransformerException;
import javax.xml.transform.stream.StreamResult;
import java.io.ByteArrayOutputStream;
import java.io.UnsupportedEncodingException;
import java.util.HashMap;
import java.util.Map;

import static org.junit.Assert.assertEquals;

public class SimpleTransform {
    @Test
    public void splitOutput() throws TransformerException, UnsupportedEncodingException {
        final Map<String, StreamResult> results = new HashMap<String, StreamResult>();
        results.put("test1", new StreamResult(new ByteArrayOutputStream()));
        results.put("test2", new StreamResult(new ByteArrayOutputStream()));
        results.put("test3", new StreamResult(new ByteArrayOutputStream()));

        TransformerFactoryImpl factory = new TransformerFactoryImpl();
        Source source = new StandardURIResolver(new Configuration()).resolve("transform.xslt", null);
        Controller xsl = (Controller) factory.newTransformer(source);
        xsl.setOutputURIResolver(new OutputURIResolver() {
            @Override
            public Result resolve(String s, String s1) throws TransformerException {
                return results.get(s);
            }

            @Override
            public void close(Result result) throws TransformerException {
            }
        });
        Source xsd = (Source) Transform.loadDocuments("input.xml", false, null, false);
        StreamResult standardResult = new StreamResult(new ByteArrayOutputStream());
        xsl.transform(xsd, standardResult);

        for (Map.Entry<String, StreamResult> stringStreamResultEntry : results.entrySet()) {
            System.out.println(stringStreamResultEntry.getKey() + ": " + ((ByteArrayOutputStream)stringStreamResultEntry.getValue().getOutputStream()).toString("UTF-8"));
        }

        assertEquals("<html>\n   <body>test1</body>\n</html>", ((ByteArrayOutputStream) results.get("test1").getOutputStream()).toString("UTF-8"));
        assertEquals("<html>\n   <body>test2</body>\n</html>", ((ByteArrayOutputStream) results.get("test2").getOutputStream()).toString("UTF-8"));
        assertEquals("<html>\n   <body>test3</body>\n</html>", ((ByteArrayOutputStream) results.get("test3").getOutputStream()).toString("UTF-8"));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:38:53.877

切换到 XSLT 2.0（实际上在您的情况下这意味着 Saxon），并使用 xsl:result-document 指令生成每个输出。您可以通过向 Saxon 注册一个 OutputURIResolver 来将结果文档传递回您的 Java 应用程序 - 一个简单的类，在创建每个结果文档时都会收到通知。

# objective-c - 无法返回 NSMutableArray 值

> ID：10853686
> 
> 赞同：0
> 
> 时间：2012-06-01T16:01:58.710
> 
> 标签：objective-c, ios, methods

谁能告诉我为什么我不能在那里返回 NSMutableArray：

```
-(NSMutableArray)makeServiceRequest:(UIViewController *)sender
{
     NSMutableString *urlString= [NSString stringWithFormat:@"http://www.servicedata/%@", _searchValue];

     dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        NSData* data = [NSData dataWithContentsOfURL:
                        [NSURL URLWithString: urlString]];

        NSError* error;

        NSMutableArray *json = [NSJSONSerialization JSONObjectWithData:data
                                                               options:kNilOptions
                                                                 error:&error];

        dispatch_async(dispatch_get_main_queue(), ^(){
            NSLog(@"json arrived");
            return json;
        });
    });
} 
```

我已经在头文件中很好地声明了它。有没有办法把它变成一个类方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:04:10.820

`json`是一段`(NSMutableArray *)`时间你的函数返回`(NSMutableArray)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T16:04:43.630

你不能这样做，你调度块相当于创建另一个线程并让它离开，当你的块执行方法 makeServiceRequest 已经执行并且不再在范围内时，你需要做什么通知调用者他们的请求是通过协议或通知完成的......流程就像

*   调用者调用方法
*   方法执行，在不同的线程上启动块并返回
*   来电者继续他的事业
*   最终该块被执行，为了返回调用者，我们需要使用协议或通知（还有其他方法，但这两种是最好的 imo）

如果您想了解 NSNotifications，请查看[此问题](https://stackoverflow.com/questions/2191594/how-to-send-and-receive-message-through-nsnotificationcenter-in-objective-c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:06:24.223

该 return 语句位于块内。将块视为其自身的某种功能。块具有参数和返回类型，就像函数或方法一样。dispatch_async 不接受任何参数，也没有返回类型，因此它不希望您尝试在该块内返回。

此外，该块可能会在下一个运行循环中运行。在代码运行时，您将退出 makeServiceRequest: 方法，并且该方法不会返回任何内容。我猜该代码中有一个警告，上面写着“控制到达非无效函数的结尾”。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-01T16:04:38.373

就像[Anila](https://stackoverflow.com/users/814194/anila)解释的那样，你错过了一个 *. 要了解这意味着什么，您应该阅读有关 Objective-C 内容的一些“入门”。例如 Apple 的 Objective-C 入门教程：[Learning Objective-C: A Primer](http://developer.apple.com/library/mac/#referencelibrary/GettingStarted/Learning_Objective-C_A_Primer/_index.html)

> 反正有办法把它变成一个类方法吗？

并回答你第二个问题，如果我没猜错的话：你必须把开头的破折号改成加号。这相当于 Java 中的关键字“static”：

```
+ (NSMutableArray*)makeServiceRequest:(UIViewController *)sender 
```

# python - setup.py 中的 2to3 未转换测试？

> ID：10853688
> 
> 赞同：7
> 
> 时间：2012-06-01T16:02:02.303
> 
> 标签：python, unit-testing, python-3.x, setup.py, python-2to3

我有一个需要同时支持 Python 2 和 3 的 setup.py。

该代码当前可以运行并且可以在 Python 2.x 中安装

如果我将该`use_2to3 = True`子句添加到我的 setup.py，那么该模块可以*安装*在 Python 3 中，但是，执行以下操作：

```
python setup.py test 
```

导致失败，因为其中一个测试使用 StringIO 类，并且 Python 3 中的导入行出错（当前`from StringIO import StringIO`是 ，在 Python3 中应该是`from io import StringIO`

我认为，一旦添加了 use_2to3 关键字，所有测试（包括单元测试）都会在测试之前由 2to3 处理。

我错过了什么？如果有帮助，我的 setup.py 的大部分内容如下所示：

```
from setuptools import setup

setup(
    name='myproject',
    version='1.0',
    description='My Cool project',
    classifiers = [
        'Programming Language :: Python',
        'Programming Language :: Python :: 3',
    ],

    py_modules=['mymodule'],
    test_suite='test_mymodule',
    zip_safe=False,
    use_2to3 = True,
) 
```

编辑：我觉得好像 2to3 没有在 a 上运行的原因`python setup.py test`是它爆炸了，堆栈跟踪的底部显示：

```
File "/home/aparkin/temp/mymodule/test_mymodule.py", line 18, in <module>
    from StringIO import StringIO 
```

但是，如果我在 test_mymodule.py 上运行 2to3，那么该导入行应该已经改写为：

```
from io import StringIO 
```

并且（在最坏的情况下）测试应该单独失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T15:20:58.023

为了使分发通过 2to3 拾取您的模块并运行，它必须在 py_modules 中列出。所以将其更改为：

```
py_modules=['mymodule', 'test_mymodule'], 
```

不幸的是，在安装项目时安装 test_mymodule 会产生副作用，这可能是您不想要的。对于这样的情况，我通常会将项目转换为带有 mymodule.tests 子包的包。这样，测试可以“可安装”，而不会增加额外的混乱。

# jquery - jquery国际化/全球化

> ID：10853689
> 
> 赞同：1
> 
> 时间：2012-06-01T16:02:05.767
> 
> 标签：jquery, localization, internationalization

我正在考虑使用[http://code.google.com/p/jquery-i18n-properties/](http://code.google.com/p/jquery-i18n-properties/)为我的 javascript 代码中的术语提供本地化功能。我无法理解提供的文档。如果我有英文术语“open”和“close”并且还想使用法语“ouvrir”和“fermer” - 是否有一个很好的例子来说明我将如何使用这个插件？我没有运气找到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:18:56.000

您可以随时[联系开发人员](http://codingwithcoffee.com/)或查看[演示页面](http://codingwithcoffee.com/files/trunk/index.html)。

您似乎为您希望支持的每种语言（[pt](http://codingwithcoffee.com/files/trunk/bundle/Messages_pt.properties)，[pt_PT ）](http://codingwithcoffee.com/files/trunk/bundle/Messages_pt_PT.properties)[构建了一个地图。](http://codingwithcoffee.com/files/trunk/bundle/Messages.properties)调用要加载的捆绑包的触发器（*或使用浏览器语言 (* )。`loadBundles('pt_PT');`*`jQuery.i18n.browserLang()`*

您只需要查看演示页面的源代码即可了解更多详细信息。

# iphone - 无法使用 AVAudioRecorder 永久保存音频

> ID：10853700
> 
> 赞同：0
> 
> 时间：2012-06-01T16:02:56.563
> 
> 标签：iphone, objective-c, ios, avaudioplayer, avaudiorecorder

我正在制作的应用程序有几个视图，每个视图都有一个记录、停止和播放按钮。这个想法是用户可以为每个视图录制到不同的声音文件。

我可以在每个视图上录制和播放声音，但是当我离开视图然后导航回来时，声音就消失了。

很抱歉在下面包含这么多代码，但这是我需要深入了解的内容。

**代表.h**

```
#import <UIKit/UIKit.h>
#import <AudioToolbox/AudioServices.h>
#import <AVFoundation/AVFoundation.h>

@interface humptyDumptyAppDelegate : UIResponder <UIApplicationDelegate>

{
    NSArray *dirPaths;
    NSString *docsDir;
    NSString *soundFilePathPage1;                               
    NSString *soundFilePathPage2;
    NSString *soundFilePathPage3;
    NSString *soundFilePathPage4;
    NSString *soundFilePathPage5;
    NSString *soundFilePathPage6;

}

@property (strong, nonatomic) UIWindow *window;
@property (strong, nonatomic) AVAudioRecorder *audioRecorder;
@property (strong, nonatomic) AVAudioPlayer *audioPlayer;

//example getter and setter functions
- (NSArray*) getDirPaths;
- (void) setDirPaths:(NSArray*)myDirPath;
- (NSString*) getDocsDir;
- (NSString*) soundFilePathForPageNumber:(int)pageNumber;

@end 
```

**代表.m**

```
#import "humptyDumptyAppDelegate.h"

@implementation humptyDumptyAppDelegate

@synthesize window = _window;
@synthesize audioPlayer;
@synthesize audioRecorder;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    docsDir = [dirPaths objectAtIndex:0];

    soundFilePathPage1 = [docsDir
                          stringByAppendingPathComponent:@"audiopage1.caf"];
    soundFilePathPage2 = [docsDir
                          stringByAppendingPathComponent:@"page2.caf"];
    soundFilePathPage3 = [docsDir
                          stringByAppendingPathComponent:@"page3.caf"];
    soundFilePathPage4 = [docsDir
                          stringByAppendingPathComponent:@"page4.caf"];
    soundFilePathPage5 = [docsDir
                          stringByAppendingPathComponent:@"page5.caf"];
    soundFilePathPage6 = [docsDir
                          stringByAppendingPathComponent:@"page6.caf"];
    return YES;

}
//getter function
- (NSArray*) getDirPaths{    
    return dirPaths;
}
//setter function
- (void) setDirPaths:(NSArray*)myDirPath{
    dirPaths = myDirPath;
}
// get docs directory
-(NSString*) getDocsDir{
    return docsDir;
}
// get sound file for page, passing the page number as an argument
-(NSString*) soundFilePathForPageNumber:(int)pageNumber{
    switch (pageNumber) {
        case 1:
            return soundFilePathPage1;
            break;
        case 2:
            return soundFilePathPage2;
            break;
        case 3:
            return soundFilePathPage3;
            break;
        case 4:
            return soundFilePathPage4;
            break;
        case 5:
            return soundFilePathPage5;
            break;
        case 6:
            return soundFilePathPage6;
            break;
    }
    return nil;
} 
```

**page1.m**

```
//this is called in viewDidLoad
-(void) prepareForAudioRecording
{
    btnPlay.enabled = NO;
    btnStop.enabled = NO;

    int page = 1;
    NSString *audioFilePath = [appDelegate soundFilePathForPageNumber:page]; 
    NSURL *soundFileURL = [NSURL fileURLWithPath:audioFilePath];
    NSError *error;
    NSDictionary *recordSettings = [NSDictionary 
                                    dictionaryWithObjectsAndKeys:
                                    [NSNumber numberWithInt:AVAudioQualityMin],
                                    AVEncoderAudioQualityKey,
                                    [NSNumber numberWithInt:16], 
                                    AVEncoderBitRateKey,
                                    [NSNumber numberWithInt: 2], 
                                    AVNumberOfChannelsKey,
                                    [NSNumber numberWithFloat:44100.0], 
                                    AVSampleRateKey,
                                    nil];
    appDelegate.audioRecorder = [[AVAudioRecorder alloc]
                     initWithURL:soundFileURL
                     settings:recordSettings
                     error:&error];

    if (error)
    {
        NSLog(@"error: %@", [error localizedDescription]);

    } else {
        [appDelegate.audioRecorder prepareToRecord];
    }
}

- (IBAction)recordAudio:(id)sender {
    if (!appDelegate.audioRecorder.recording)
    {
        btnPlay.enabled = NO;
        btnStop.enabled = YES;
        [appDelegate.audioRecorder record];

    }
}

- (IBAction)stopAudio:(id)sender {
    btnStop.enabled = NO;
    btnPlay.enabled = YES;
    btnRecord.enabled = YES;

    if (appDelegate.audioRecorder.recording)
    {
        [appDelegate.audioRecorder stop];
        [self audioRecorderDidFinishRecording:appDelegate.audioRecorder successfully:YES];
    } else if (appDelegate.audioPlayer.playing) {
        [appDelegate.audioPlayer stop];

    }
}

-(void)audioRecorderDidFinishRecording:(AVAudioRecorder *)recorder successfully:(BOOL)flag
{
    if (flag == YES){
        NSLog(@"finished recording");
        [appDelegate.audioPlayer.data writeToFile:[appDelegate soundFilePathForPageNumber:1] atomically:YES];
    }
} 
```

就像我说的，我很抱歉包含的代码量，但我不确定问题出在哪里。我在`writeToFile`方法中调用`audioRecorderDidFinishRecording:`方法。我不知道这是否正确，但我觉得这不是问题的根源。

请帮忙！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:14:33.350

此代码保存到音频文件

将文件复制到文档目录怎么样

```
BOOL success;
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSError *error;
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *writableDBPath = [documentsDirectory stringByAppendingPathComponent:@" sound.caf"];
    success = [fileManager fileExistsAtPath:writableDBPath];

    if (!success){
        // The writable database does not exist, so copy the default to the appropriate location.
        NSString *defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"sound.caf"];
        success = [fileManager copyItemAtPath:defaultDBPath toPath:writableDBPath error:&error];

        NSError *attributesError;
        NSDictionary *fileAttributes = [[NSFileManager defaultManager] attributesOfItemAtPath:writableDBPath error:&attributesError];

        NSNumber *fileSizeNumber = [fileAttributes objectForKey:NSFileSize];
        long long fileSize = [fileSizeNumber longLongValue];
        NSLog(@"file size: %lld",fileSize);

        if (!success) {
            NSLog(@"Failed to create writable database file with message: %@", [error localizedDescription]);
        }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T17:59:51.097

事实证明，问题在于，在我的一个页面中，我的页面`prepareForAudioRecording`自动`viewDidAppear`覆盖了保存的音频。把它移到`viewDidLoad`做的伎俩

# xslt - 使用 XSL 获取 XML 文档中属性的值

> ID：10853701
> 
> 赞同：0
> 
> 时间：2012-06-01T16:02:56.423
> 
> 标签：xslt, xpath, docbook-5

我试图在我的 XSL 转换过程中获得价值`iWantToGetThis.jpg`并将其放入。`<img>`这就是我的 xml 结构：

```
<article>
    <info>
        <mediaobject>
            <imageobject>
                <imagedata fileref='iWantToGetThis.jpg'> 
```

以下是我为 XSL 提出的建议：

```
<xsl:template name="user.header.content">
    <xsl:stylesheet xmlns:d='http://docbook.org/ns/docbook'>
        <img><xsl:attribute name="src">../icons/<xsl:value-of select='ancestor-or-self::d:article/info/mediaobject/imageobject/imagedata/@fileref' /></xsl:attribute></img>
    </xsl:stylesheet>
</xsl:template> 
```

图像被添加到输出中，但 src 属性设置为“../icons/”，所以我假设它没有`fileref`在 XML 中找到该属性。这对我来说看起来完全有效，所以我不确定我错过了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:35:10.550

我不知道你怎么能得到任何东西，因为它看起来不像一个有效的 XSLT 文档（我希望错误“Keyword xsl:stylesheet may not contain img.”）。

但是，您可能只是显示代码的一部分。如果是这种情况，您的问题可能是您只为**文章**元素指定了命名空间，而您确实需要为 xpath 中的所有元素指定它。尝试这个

```
<xsl:value-of 
   select="ancestor-or-self::d:article/d:info/d:mediaobject/d:imageobject/d:imagedata/@fileref"/> 
```

另一个可能的问题可能是因为您使用 'ancestor-or-self' xpath 轴来查找属性。仅当您当前的上下文已经在**文章**元素或其后代之一上时，这才有效。

作为旁注，您可以在此处使用属性值模板来简化代码

```
<img src="../icons/{ancestor-or-self::d:article/d:info/d:mediaobject/d:imageobject/d:imagedata/@fileref}" /> 
```

# google-maps - Google Maps api v3 自动完成结果中的奇怪字符

> ID：10853706
> 
> 赞同：2
> 
> 时间：2012-06-01T16:03:34.767
> 
> 标签：google-maps, google-maps-api-3

自动完成在结果中返回某些地址的未知字符，[这里](https://stackoverflow.com/questions/9910417/google-map-api-autocomplete-japanese)也描述了这个问题，但没有任何答案。我正在对此进行调查，不幸的是没有找到任何可行的示例。要重现，请转到[https://developers.google.com/maps/documentation/javascript/examples/places-autocomplete](https://developers.google.com/maps/documentation/javascript/examples/places-autocomplete)并输入例如“Dobra trefa”，你会得到这个*“Dobrá trefa, Koněvova, ジシュコフ,布拉格-布拉格 3，捷克共和国”* - 即一些日文/中文符号（不确定）。我在 Google Maps 上尝试过相同的名称，它运行得非常完美，但看起来 Google Maps 仍在使用 api v2，所以这并没有真正的帮助。我真的坚持这一点，尝试了以下方法：

1.) 将 charset="UTF-8" 添加到脚本标签
2.) 添加到 <head> <meta content="text/html;charset=UTF-8" http-equiv="content-type"> 到强制页面编码
3.) 将 language=en 添加到 Google Maps API 的 javascript URI
4.) 检查在我输入自动完成时发送到服务器的内容
5.) 检查 Google Maps
的工作方式 6.) 谷歌搜索类似的问题
7.) 寻找可行的解决方案

没有任何结果。

我究竟做错了什么？它可以与机器/浏览器/配置连接吗？

PS没有在这里发布我的代码，因为它只是谷歌官方开发网站自动完成示例的副本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T21:26:26.137

转载。我认为这是一个错误，您应该在问题跟踪器中报告：[http](http://code.google.com/p/gmaps-api-issues/issues/list?can=2&q=autocomplete) ://code.google.com/p/gmaps-api-issues/issues/list?can=2&q=autocomplete （请检查没有现有问题与此相关：如果您找到一个，请加注星标而不是添加另一个）。

正如其他答案所指出的，奇怪的字符是日语。您可能希望在错误报告中引用这两个问题（以及任何相关地址）。

# regex - 匹配所有内容，但不是 url 的一部分

> ID：10853707
> 
> 赞同：0
> 
> 时间：2012-06-01T16:03:38.647
> 
> 标签：regex, url, regex-negation

我正在尝试制作一个正则表达式来匹配任何结尾，除了`ClaroArgentina` 所以，这不应该匹配：`https://twitter.com/#!/ClaroArgentina` 但这应该是一个匹配：`https://twitter.com/#!/asdasd`

我试图让它与它一起工作，但它没有给我结果：

```
https\://twitter\.com/(^ClaroArgentina) 
```

我试图在该正则表达式中存档的是匹配所有内容，但不匹配 ClaroArgentina。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:06:37.990

在大多数语言中，您都可以使用[否定前瞻。](http://www.regular-expressions.info/lookaround.html)

```
http\://twitter\.com/#!/(?!ClaroArgentina)$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:12:34.447

你必须只使用正则表达式吗？最简单的方法是使用 String.EndsWith。

# silverlight - 生产部署中间歇性 Arg_ArgumentException 的原因？

> ID：10853710
> 
> 赞同：2
> 
> 时间：2012-06-01T16:03:44.547
> 
> 标签：silverlight, exception, silverlight-5.0

我们最近刚刚向我们的生产网络服务器部署了一个受信任的、浏览器内的 Silverlight 5 应用程序。App.xaml.cs UnhandledException 处理程序捕获的 ArgumentException 相当频繁。到目前为止，我们一直无法确定异常的来源。

在调试器下运行时我们没有看到异常（我在 Debug->Exceptions...下明确启用了捕获异常）。一些用户非常频繁地看到此错误，而另一些用户则从未看到此错误。这似乎不是一个致命错误，因为用户只需从我们显示的 ErrorWindow 中单击 OK 按钮，一切正常。

为了停止惹恼用户，我为 ArgumentException 类型添加了一个处理程序，并将其标记为已处理并继续。但是，我仍在记录错误，并且真的很想确定实际来源，以便我可以解决问题。只是忽略异常似乎不是一个长期的解决方案。

堆栈跟踪如下，对于所有 ArgumentExceptions 都是相同的。

关于如何更好地排除故障并确定此异常原因的任何想法？

谢谢，

蒂姆

```
Unhandled Exception: [Arg_ArgumentException] 
Arguments: 
Debugging resource strings are unavailable. Often the key and arguments provide sufficient information to diagnose the problem. See http://go.microsoft.com/fwlink/?linkid=106663&Version=5.0.10411.00&File=mscorlib.dll&Key=Arg_ArgumentException :    
   at MS.Internal.XcpImports.CheckHResult(UInt32 hr) 
   at MS.Internal.XcpImports.SetValue(IManagedPeerBase obj, DependencyProperty property, Double d) 
   at MS.Internal.XcpImports.SetValue(IManagedPeerBase doh, DependencyProperty property, Object obj) 
   at System.Windows.DependencyObject.SetObjectValueToCore(DependencyProperty dp, Object value) 
   at System.Windows.DependencyObject.SetEffectiveValue(DependencyProperty property, EffectiveValueEntry& newEntry, Object newValue) 
   at System.Windows.DependencyObject.UpdateEffectiveValue(DependencyProperty property, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, ValueOperation operation) 
   at System.Windows.DependencyObject.RefreshExpression(DependencyProperty dp) 
   at System.Windows.Data.BindingExpression.SendDataToTarget() 
   at System.Windows.Data.BindingExpression.SourceAcquired() 
   at System.Windows.Data.BindingExpression.PerformTargetLoaded() 
   at System.Windows.Data.BindingExpression.TargetLoaded(Object o, RoutedEventArgs e) 
   at MS.Internal.CoreInvokeHandler.InvokeEventHandler(UInt32 typeIndex, Delegate handlerDelegate, Object sender, Object args) 
   at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex 
```

# android - 如何在 Android 中对 GridView 实现放大/缩小效果

> ID：10853718
> 
> 赞同：2
> 
> 时间：2012-06-01T16:04:17.147
> 
> 标签：android, user-experience, zooming

在创建图像和文本时，在 UI 中开发放大/缩小功能是很常见的，因为它有许多主要与可访问性相关的应用程序。在我的情况下，我想创建一种类似于 gridview 的自定义视图类型，但不同之处在于数据不是滚动而是在前后方向上传递，所以在我的情况下，它与用户更相关-体验胜于可访问性。在[本](http://www.youtube.com/watch?v=x4fr5wX57jg)视频中，更好地恢复/定义了所描述的“行为”。我想创建一个具有这种效果的gridview，其中以前的项目可以从“屏幕外”带到屏幕，下一个项目可以从“deep-screen”带到屏幕，并且gridview本身是静态的关于卷轴。可能吗？目前，我**onScrollStateChanged**和默认缩放实现通过大小缩放数据（这是一个非常苛刻的解决方案）。提前致谢！

# java - 可以将命令行作为单个字符串执行的 java.lang.Runtime.exec() 的替代方案？

> ID：10853719
> 
> 赞同：0
> 
> 时间：2012-06-01T16:04:27.140
> 
> 标签：java, runtime, runtime.exec

我正在调用[java.lang.Runtime.exec(...)](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html#exec)但这似乎接受命令行作为数组，我想使用单个字符串。

如何使用单个字符串做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:09:17.717

从链接的 Javadocs：

> `envp`- 字符串数组，其中每个元素都有格式*为 name=value*的环境变量设置，或者`null`子进程是否应该继承当前进程的环境。

所以只要传入`null`第二个参数，环境就会被继承。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:16:56.703

如果您传递`null`第二个参数，则将继承当前环境。

如果要修改当前环境，可以这样构建它`System.getEnv()`：

```
private static String[] getEnv() {
    Map<String, String> env = System.getenv();
    String[] envp = new String[env.size()];
    int i = 0;
    for (Map.Entry<String, String> e : env.entrySet()) {
        envp[i++] = e.getKey() + "=" + e.getValue();
    }
    return envp;
} 
```

**更新**

您可以检查您的Java路径`System.out.println(System.getenv("PATH"));`

如果路径没问题，然后尝试

```
String[] commands = new String[] { "bash", "-c", "python foo/bar.py" };
Runtime.getRuntime().exec(commands, null, new File("/workingDir")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:09:42.580

从文档中：

> `envp`- 字符串数组，其中每个元素都具有格式*name* = *value*的环境变量设置，或者`null`子进程是否应该继承当前进程的环境。

听起来您想通过`null`该论点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T09:25:08.400

目前没有办法使用命令行作为单个字符串调用系统命令并且能够指定当前目录。

似乎 Java API 缺少这个基本功能:)

解决方法是使用数组版本而不是字符串。

# sql - MS Access/MS SQL 查询

> ID：10853722
> 
> 赞同：2
> 
> 时间：2012-06-01T16:04:32.670
> 
> 标签：sql, sql-server, ms-access

如果可能的话，我正在尝试将两个查询合并为一个，这就是我想做的。

1.  从名为 FDetail 的表中选择所有内容 (*)
2.  其中 TransactionDate 介于 01/01/2007 和 01/01/2015 之间
3.  并且其中 ComNum=1090084785010
4.  并获取 RecID（RecID 是列的名称）= 32375 以及 RecID=11174 <-- 即使它不是上面指定的 ComNum 但必须在指定日期之间的整个记录
5.  并跳过 RecID=24425 的记录

我尝试过这样的事情，但这是错误的：

```
SELECT * FROM FDetail 
WHERE TransactionDate >= #01/01/2007#
AND TransactionDate <= #01/01/2015#
AND ComNum=1090084785010
AND RecID=32375 
AND RecID=11174 
AND NOT RecID=24425
ORDER BY ASC 
```

现在我会从两个查询中做到这一点？

```
Query 1:
SELECT * FROM FDetail 
WHERE ComNum=1090084785010
AND TransactionDate >= #01/01/2007#
AND TransactionDate <= #01/01/2015#
ORDER BY ASC 

Query 2:
SELECT * FROM FDetail 
WHERE TransactionDate >= #01/01/2007#
AND TransactionDate <= #01/01/2015#
AND RecID=32375
AND RecID=11174 
AND NOT RecID=24425
ORDER BY ASC 
```

这适用于 MS Access 数据库，但我也想知道如何在 MS SQL 中执行此操作，（除非唯一的区别是日期的 #）

一如既往，非常感谢您为我提供的任何帮助。我非常感谢这个社区和你们所有努力帮助他人的伟大人物。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:10:44.283

```
SELECT * FROM FDetail 
WHERE 
    TransactionDate >= #01/01/2007#
AND TransactionDate <= #01/01/2015#
AND (
        (ComNum=1090084785010 AND RecID <> 24425)
    OR  (RecID=32375 OR RecID=11174)
    )
ORDER BY ASC 
```

希望它有帮助，rgds。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:16:36.580

听起来你想要这样的东西（在 Access 中）：

```
SELECT * FROM FDetail  
WHERE TransactionDate >= #01/01/2007# 
AND TransactionDate <= #01/01/2015# 
AND (ComNum=1090084785010 OR RecID=32375 OR RecID=11174)
AND RecID<>24425 
ORDER BY ASC 
```

我不确定 SQL Server 会有什么不同。

这在逻辑上等同于@Sebas 接受的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:12:21.177

除了**#**你必须写`AND RecID <> 24425`而不是`AND NOT RecID=24425`在 MySQL 中。这是为了你的知识。

但是，您可以编写`(RecID=32375 OR RecID=11174)`并跳过该`NOT`部分。

所以查询将是 -

```
SELECT * FROM FDetail  
WHERE TransactionDate >= #01/01/2007# 
AND TransactionDate <= #01/01/2015# 
AND (ComNum=1090084785010 OR RecID=32375 OR RecID=11174)
AND RecID<>24425 
ORDER BY ASC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T16:45:50.583

```
SELECT * FROM FDetail
WHERE ComNum=1090084785010
AND TransactionDate >= #01/01/2007#
AND TransactionDate <= #01/01/2015#

UNION

SELECT * FROM FDetail 
WHERE TransactionDate >= #01/01/2007#
AND TransactionDate <= #01/01/2015#
AND RecID=32375
AND RecID=11174 
AND NOT RecID=24425
ORDER BY ASC 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-06T14:25:58.723

试试这个：

```
 SELECT * FROM FDetail
    WHERE (TransactionDate BETWEEN '01/01/2007' AND '01/01/2015')
    AND ( RecID IN (32375, 11174)
        OR (ComNum=1090084785010 AND RecID != 24425)
        ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-07T01:08:39.860

尝试以下操作：
SELECT * FROM FDetail
WHERE TransactionDate >= #01/01/2007# AND TransactionDate <= #01/01/2015#)
AND (ComNum=1090084785010 OR (RecID=32375 AND RecID=11174 AND NOT RecID=24425 ))
由 ASC 订购；

您可以通过对日期范围使用“BETWEEN”运算符并在 RecID 列表中使用“IN”运算符来清除此问题，但我根据您使用的内容发布了答案。

在长比较中使用括号总是有帮助的，即使它不是必需的。

# android - 我如何将第 4 个导航窗口转到第一个窗口（钛 iphone 和 android）？

> ID：10853723
> 
> 赞同：0
> 
> 时间：2012-06-01T16:04:34.463
> 
> 标签：android, iphone, titanium

我想逐个浏览窗口 4 次，最后我想进入 1 个窗口，然后我如何进入第一个窗口。我如何将第 4 个导航窗口转到第一个窗口

```
 var tabGroup        = Titanium.UI.createTabGroup();

var win1            = Titanium.UI.createWindow({

    backgroundColor : '#fff',
    navBarHidden    : true,
    orientationModes: [
        Titanium.UI.PORTRAIT,
    ]
});

var tab1            = Titanium.UI.createTab({
    title           : 'Menu',
    window      :  win1,
});
var btn         =Ti.UI.createButton({
    title           :"click",
    height      : "100",
    width       : "100",
});
win1.add(btn);
btn.addEventListener('click',function(){
    var win2            = Titanium.UI.createWindow({
        url     : "win2.js"
        backgroundColor : '#fff',
        navBarHidden    : true,
        orientationModes: [
            Titanium.UI.PORTRAIT,
        ]
    });

Ti.UI.currentTab.open(win2);

});

tabGroup.addTab(tab1);
tabGroup.open() 
```

win2.js

```
var curwin = Ti.UI.currentWindow;
var btn         =Ti.UI.createButton({
    title           :"click",
    height      : "100",
    width       : "100",
});
curwin.add(btn);
btn.addEventListener('click',function(){
    var win3            = Titanium.UI.createWindow({
        url     : "win3.js"
        backgroundColor : '#fff',
        navBarHidden    : true,
        orientationModes: [
            Titanium.UI.PORTRAIT,
        ]
    });

Ti.UI.currentTab.open(win3);
}); 
```

win3.js

```
var curwin = Ti.UI.currentWindow;
var btn         =Ti.UI.createButton({
    title           :"click",
    height      : "100",
    width       : "100",
});
curwin.add(btn);
btn.addEventListener('click',function(){
    var win4            = Titanium.UI.createWindow({
        url     : "win4.js"
        backgroundColor : '#fff',
        navBarHidden    : true,
        orientationModes: [
            Titanium.UI.PORTRAIT,
        ]
    });

Ti.UI.currentTab.open(win4);
}); 
```

win4.js

```
var curwin = Ti.UI.currentWindow;
var btn         =Ti.UI.createButton({
    title           :"click",
    height      : "100",
    width       : "100",
});
curwin.add(btn);
btn.addEventListener('click',function(){
// Here I want to back First Window  how i can perform this iphone or android both
}); 
```

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T19:29:53.427

在[Forging Titanium Episode 2](http://developer.appcelerator.com/blog/2011/08/forging-titanium-episode-2-a-cross-platform-navigation-controller.html)中，他们开发了一个跨平台导航控制器，在返回第一个窗口时，他们将打开的每个窗口存储在一个数组中，然后循环遍历该数组并关闭存储在其中的所有窗口。下面的一段代码来自他们的这个想法。

```
//go back to the initial window of the NavigationController
exports.NavigationController.prototype.home = function() {
    //store a copy of all the current windows on the stack
    var windows = this.windowStack.concat([]);
    for(var i = 1, l = windows.length; i < l; i++) {
        (this.navGroup) ? this.navGroup.close(windows[i]) : windows[i].close();
    }
    this.windowStack = [this.windowStack[0]]; //reset stack
}; 
```

# asp.net - System.Web.Providers -> Microsoft.AspNet.Providers？

> ID：10853725
> 
> 赞同：5
> 
> 时间：2012-06-01T16:04:36.840
> 
> 标签：asp.net, nuget

[Microsoft ASP.NET Universal Providers 1.1与](http://nuget.org/packages/Microsoft.AspNet.Providers)[System.Web.Providers 1.2](http://nuget.org/packages/System.Web.Providers/1.2)昨天一起发布。在后面的 nuget 页面上指出：`Legacy package, System.Web.Providers is now included in the 'Microsoft.AspNet.Providers' package.`

这只是名称更改还是更有趣/更重要的事情？如果我引用了1.1 和1.0 ，我应该删除`System.Web.Providers`1.2 包引用吗？`Microsoft.AspNet.Providers``Microsoft.AspNet.Providers.Core`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T19:50:16.387

当您引用“旧版包，System.Web.Providers 现在包含在 'Microsoft.AspNet.Providers' 包中”时，您已经成功了。您可以删除 System.Web.Providers 并只使用其他两个包。

[我阅读了Scott Hanselman](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx "斯科特·汉塞尔曼 (Scott Hanselman) 发布")的原始帖子，并将其与“新”Microsoft.AspNet.Providers 1.1 的描述进行了比较。他们都说这个提供程序包是相同的，只是它支持 SQL Azure 和 SQL Compact 版本。

# php - jQuery、php、mysql 在 Firefox 中不起作用

> ID：10853727
> 
> 赞同：-2
> 
> 时间：2012-06-01T16:04:40.850
> 
> 标签：php, jquery, mysql, html, firefox

此代码在数据库中找到一个 scu 并在您键入时显示它。它适用于除 Firefox 之外的所有浏览器（chrome、IE、opera）。如果有人能明白为什么我会非常感激帮助。

```
<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'></script>
<script src="chData_test.js"></script>

</head>
<body>
<form name="testForm">
<input type="text" name="scu" id="scu"><input type="button" id="theButton">
</form>
<div id="output"></div>
</body>

$(document).ready(function() {
  $('#theButton').click(get);
  $('#scu').keyup(get);
  function get() {
    $.post('data.php', {scu:testForm.scu.value}, function(output) {
      $('#output').text(output).show();
    });
  }
});

<?php
mysql_connect("***.000webhost.com", "a9414387_***", "****");
$scu = mysql_real_escape_string($_POST['scu']);

if ($scu==NULL) {
echo "No entry scu found";
}
else {
$description = mysql_query("SELECT description FROM a9414387_***.inventory WHERE id LIKE '$scu%'");
$description_num_rows = mysql_num_rows($description);
if ($description_num_rows==0) {
echo "scu not found in database";
}
else {
$description = mysql_result($description, 0);
echo "You have selected the $description";
}
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:11:42.107

使用 true 代替 "testForm.scu.value" -> "$('#scu').val()"，例如：

```
function get() {
  var postdata = $('#scu').val();
    $.post('data.php', {scu:postdata}, function(output) {
      $('#output').text(output).show();
    });
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:21:11.323

在引用它之前尝试定义“函数获取”。

```
$(document).ready(function() {
  function get() {
    $.post('data.php', {scu:testForm.scu.value}, function(output) {
      $('#output').text(output).show();
    });
  }
  $('#theButton').click(get);
  $('#scu').keyup(get);
}); 
```

# php - PHP_AUTH_USER 和 LDAP

> ID：10853738
> 
> 赞同：1
> 
> 时间：2012-06-01T16:05:14.547
> 
> 标签：php, authentication, header, active-directory, ldap

我正在尝试通过带有 Active Directory 的 LDAP 对 PHP webapp 的用户进行身份验证。

```
<?php
    $ldapconfig['host'] = 'ldapserv.xx.uni.edu';
    $ldapconfig['port'] = 389;
    $ldapconfig['basedn'] = 'dc=xx, dc=uni, dc=edu';
    $ldapconfig['authrealm'] = 'Secure Area';

    function ldap_authenticate() {
        global $ldapconfig;
        global $PHP_AUTH_USER;
        global $PHP_AUTH_PW;

        if ($PHP_AUTH_USER != "" && $PHP_AUTH_PW != "") {       
            $ds=@ldap_connect($ldapconfig['host'],$ldapconfig['port']) or exit ("Error connecting to LDAP server.");

            //Settings for AD
            ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);
            ldap_set_option($ds, LDAP_OPT_REFERRALS, 0);

            $r = @ldap_search( $ds, $ldapconfig['basedn'], 'uid=' . $PHP_AUTH_USER);
            if ($r) {
                $result = @ldap_get_entries( $ds, $r);
                if ($result[0]) {
                    if (@ldap_bind( $ds, 'uni\\' . $PHP_AUTH_USER, $PHP_AUTH_PW) ) {

                        return $result[0];
                    }
                }
            }
        }
        header('WWW-Authenticate: Basic realm="'.$ldapconfig['authrealm'].'"');
        header('HTTP/1.0 401 Unauthorized');
        return NULL;
    }

    if (($result = ldap_authenticate()) == NULL) {
        echo('Authorization Failed <br />');
        exit(0);
    }
    echo('Authorization success');
    print_r($result);

?> 
```

此代码只是不断提示用户输入用户名/密码，除非他们单击取消。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T10:21:26.313

最近的 PHP 版本默认不再提供 $PHP_AUTH_USER 和 $PHP_AUTH_PW 变量，因此您的脚本甚至永远不会进行 LDAP 检查。删除最后两个“全局”行，并在任何地方用 $_SERVER['PHP_AUTH_USER'] 和 $_SERVER['PHP_AUTH_PW'] 替换这些变量。

如果这没有帮助，请删除 @ 字符以查看是否有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:30:49.460

我能够使用`session_register`（以及更简单的代码）进行登录身份验证

```
<?php

if (isset($_POST['submitted'])) { 

    $username =$_POST['username'];
    $password=$_POST['password'];

    $ldap = ldap_connect("ldapserv.xx.uni.edu", 389) or exit ("Error connecting to LDAP server.");

    //Settings for AD
    ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);
    ldap_set_option($ds, LDAP_OPT_REFERRALS, 0);

    if($bind = ldap_bind($ldap, 'uni\\'.$username, $password)) {
        //Log them in!
        session_register("username");
        session_register("password");
        header("Location: https://" . $_SERVER['HTTP_HOST'] . substr($_SERVER['REQUEST_URI'], 0, -9) . "index.php" );
        exit;

    } else {

        echo('Invalid username or password.<br /><br />');
    }
}
?> 
```

# iphone - 动画到 CAKeyframeAnimation 的一个特定关键帧值

> ID：10853739
> 
> 赞同：0
> 
> 时间：2012-06-01T16:05:14.640
> 
> 标签：iphone, objective-c, ios, cakeyframeanimation

我的 CAKeyframeAnimation 中有四个位置是贝塞尔路径的一部分，并且我的动画在路径上运行良好。但现在我需要将动画精灵移动到关键帧位置值的一个特定值。我怎么能意识到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:42:52.830

从 CAKeyframeAnimation 的 keyTimes、values 和可能的 timingFunctions 数组中提取相关值，然后从中创建一个 CABasicAnimation。

# .net - 是否应该注入基础设施依赖项？

> ID：10853740
> 
> 赞同：4
> 
> 时间：2012-06-01T16:05:16.157
> 
> 标签：.net, inversion-of-control

对于记录器、安全性、配置等基础设施项目，这些东西应该真正注入到需要它们的每个类中，还是应该注入到服务定位器中，然后这些类可以使用服务定位器来解决依赖关系（或一些其他机制）？

所有类都有 10 个参数 ctor 来通过 DI 满足依赖关系，这看起来真的很荒谬。它是一种代码气味 IMO。我能理解诸如存储库或服务代理/连接器之类的东西，但不能理解日志。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:26:11.660

有几个选择。

1.  使用属性注入并在 ctor 中设置默认值。例如

    ```
    class foo 
    {
        public ILogger Logger {get;set;}

        public foo()
        {
           Logger = NullLogger.Instance;
        }
    } 
    ```

2.  使用 AOP 类型的方法。使用动态代理，您可以使用日志记录语句包装公共调用，但日志记录实际上从未注入到组件本身中。有关此方法的更多想法，请参阅`Castle.DynamicProxy`或自定义 .Net 属性。

那么问题来了，为什么要向组件中注入如此多的基础设施问题？您所描述的被认为是横切关注点，通常这是通过一些 AOP（面向方面​​的编程）来处理的，因此核心系统中没有很多重复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-04T14:09:40.960

这完全取决于您在基础设施和其余代码之间划清界限的位置。你认为数据库连接是基础设施吗？我不。

属性注入是一种代码味道，因为它隐藏了依赖关系，并且在构造函数完成时没有正确初始化类。只用它来解决循环依赖。

对于非常具体的记录情况，我确实使用单例来获取记录器。

> 通常我会同意你对 AOP 的看法，但我不是运行时 AOP 框架的粉丝，而且团队不了解 AOP 概念。他们几乎不了解 IoC 概念

您可能会发现我的[IoC 介绍](http://www.codeproject.com/Articles/386164/Get-injected-into-the-world-of-inverted-dependenci)很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T19:18:47.943

关于日志记录 - 只需使用 NLog（或您最喜欢的记录器）并完成它。除非您处于一个非常奇怪的场景中，否则没有理由抽象和/或注入您的记录器。

关于配置 - 只有少数类应该是配置的消费者，所以这不应该导致构造函数膨胀。有关配置和 DI 的详细讨论，另请参阅[此问题](https://stackoverflow.com/q/7288859/644812)。

关于安全性 - 同样，我认为只有少数类应该是安全依赖项的消费者。如果许多类都与安全有关，您可能需要重新审视您的设计。

一般来说 - 如果一个类有太多的构造函数参数，可能是因为它做的太多了，不管依赖项是否是基础设施。

# indexing - 阻止谷歌从网站索引某些页面

> ID：10853742
> 
> 赞同：0
> 
> 时间：2012-06-01T16:05:17.340
> 
> 标签：indexing, robots.txt

我在一个站点上有很多 404 错误的问题。我发现这些错误正在发生，因为谷歌试图找到不再存在的页面。现在我需要告诉谷歌不要再索引这些页面了。

我在网上找到了一些关于使用 robots.txt 文件的解决方案。但这不是我建立的网站。我只需要修复这些错误。问题是，这些页面已生成。它们实际上并不以那种形式存在。所以我不能在php代码中添加任何东西。而且我不太确定如何将它们添加到robot.txt。

当我只是写： ***用户代理：* noindex：/objekten/anzeigen/haus_antea/5-0000001575***

并点击网站管理员工具中的测试按钮

我从 Googlebot 得到这个： ***允许检测为目录；特定文件可能有不同的限制***

我不知道那是什么意思。

我是这种东西的新手，所以请尽可能简单地写下你的答案。

抱歉英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:25:13.237

我认为 Google 会自动从其索引中删除此类返回 404 错误的页面。Google 不会在结果中显示这些页面。所以你不需要关心这个。

只要确保这些页面没有从其他页面链接。如果是这样，Google 可能会不时尝试将它们编入索引。在这种情况下，您应该返回 301 错误（永久移动）并重定向到正确的 url。Google 将遵循 301 错误并改用重定向的 url。

仅当您要删除搜索结果中已经存在的页面时，才需要使用 Robots.txt。但我认为错误代码为 404 的页面无论如何都不会显示在那里。

# java - 执行的java代码的日志行号

> ID：10853747
> 
> 赞同：13
> 
> 时间：2012-06-01T16:05:32.060
> 
> 标签：java, php, code-coverage

我正在编写 PHP Web 应用程序的一部分（将在高中错误发现比赛中使用），用户必须在给定的 Java 程序中找到错误。作为其中的一部分，当 Java 程序执行时，我们希望突出显示 Java 程序源代码已执行的行。为此，我们只需要已执行的源代码的行号，即代码路径（或者称为代码覆盖率？）。我们将使用行号突出显示源文件中的行。

我们将使用 PHP 的 shell-exec() 来执行 Java 程序和获取代码路径的工具（无论是什么）。获取代码路径行号的最简单方法是什么？

非常感谢！

这是一张描述我们想要的图片

![在此处输入图像描述](../Images/87bc75d7c89b15046ef7c3c4a3214cf7.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:20:47.810

PHP 会解释代码，这意味着每次运行程序时它都会在源代码上运行。这样做的好处是在读取代码时会爆炸（这使得行号打印变得微不足道）；但是，它在其他方面通常很昂贵，因为您无法进行深度优化（或进行任何运行前错误检查）。

[Java 将其代码编译成称为“字节码”的 JVM 汇编语言。](http://docs.oracle.com/javase/specs/jvms/se5.0/html/ClassFile.doc.html) 这意味着正在运行的程序通常无法访问（甚至使用）源代码。也就是说，有技巧。已编译的 Java 类具有添加“额外数据”的能力，其中一个“额外数据元素”是[行号表，它是一个索引，允许运行程序集的人](http://docs.oracle.com/javase/specs/jvms/se5.0/html/ClassFile.doc.html#22856)*在编译器记录时*“查找”行号.

这通常可以正常工作，考虑到：编译器通常不会标记每条指令，源代码可能不可用，优化可能会使某些内部代码块无法以有助于指向输入代码文本的方式运行。

代码覆盖率工具如何“解决”这个问题，因为它们通常会在代码中（在程序集级别）插入大量命令，这些命令有效地充当日志语句，以允许工具确定实际遵循的代码路径. 然后通过行号表尽可能地将其映射回来，然后用于突出显示原始源文件中的行。

如果您想要分辨率更高的东西（可以处理行的哪一部分被执行的东西），那么您需要更深入地挖掘。最终，您甚至可以考虑编写自己的编译器（或编译器扩展）来存储您自己的自定义行号表，从而克服当前解决方案的缺点。

抛出异常（正如 Shiven 提到的）和解析行号之类的技巧确实有效；但是，它们会通过奇怪的异常处理来污染您的代码，这些异常处理确实*不是*异常的，只是为了“获取行号”。由于代码混乱和异常的运行时性能通常较差，我倾向于避免使用此类解决方案（但它们确实有效）。

无论如何，希望这能让您了解为什么它并不总是以与 PHP 完全相同的方式工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:27:43.330

看看 Cobertura。它计算覆盖率和类似的东西，如果它还没有这样做，那么将收集到的行号添加到它应该相对容易。有一个非常骇人听闻的尝试来做到这一点，但这太慢了，你可能无法在生产中使用它[https://bitbucket.org/jowu/myriapod/wiki/Home](https://bitbucket.org/jowu/myriapod/wiki/Home)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T10:32:47.313

尝试参考这个链接[JVMDI](http://jvmdicover.sourceforge.net/)

您可以尝试访问程序计数器的值，然后将其映射到 lineNumberTable 。或者我认为 JVMDI 有一种方法可以访问执行代码的行号。我不确定后者，请参阅上面的链接，希望对您有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T16:11:52.917

如果使用 -g 选项编译程序，执行 printStackTrace()，捕获跟踪输出并从那里提取行号，则可以获得行号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T16:28:42.397

我从来没有做过或见过这样的事情，但这似乎是一个有趣的问题。我的想法是使用[java 调试器 (jdb)](http://docs.oracle.com/javase/1.3/docs/tooldocs/solaris/jdb.html)来运行代码，而不仅仅是`java`命令。

您可以逐行（通过`step`jdb 中的命令）逐步执行代码，并且每次执行一行时都会吐出其行号。这需要 PHP 方面的一点帮助（它必须解析行号并执行下一步命令），但行号就在那里。这是一个非常基本的 java 程序的示例输出。

**Java (TestClass.java)**

```
public class TestClass {
   public static void main(String[] args) {
      System.out.println("foo");
      System.out.println("bar");
   }
} 
```

**jdb（运行后的jdb TestClass `javac TestClass.java`）**

```
Initializing jdb ...
> stop at TestClass:3
Deferring breakpoint TestClass:3.
It will be set after the class is loaded.
> run
run TestClass
Set uncaught java.lang.Throwable
Set deferred uncaught java.lang.Throwable
> 
VM Started: Set deferred breakpoint TestClass:3

Breakpoint hit: "thread=main", TestClass.main(), line=3 bci=0
3          System.out.println("foo");

main[1] step
> foo

Step completed: "thread=main", TestClass.main(), line=4 bci=8
4          System.out.println("bar");

main[1] step
> bar

Step completed: "thread=main", TestClass.main(), line=5 bci=16
5        }

main[1] step
> 
The application exited 
```

# html - 上标与 2011 年展望不一致

> ID：10853748
> 
> 赞同：-1
> 
> 时间：2012-06-01T16:05:47.637
> 
> 标签：html, css, outlook

> **可能重复：**
> [用 html 电子邮件中的上标去除空格](https://stackoverflow.com/questions/10852086/getting-rid-of-space-with-the-superscript-in-html-emails)

现在这个问题已经有一段时间了。

谁能修复在outlook 2011中留下很大空间的上标？

代码是

```
<sup style="line-height:0; font-size:0.8em;">&reg;</sup> 
```

这是这个客户端 OUTlook 2011 所特有的，在其余部分上运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T13:45:26.733

我通过增加`line-height`包含段落的`<p>`

# git - 合并和还原后的Git合并

> ID：10853755
> 
> 赞同：1
> 
> 时间：2012-06-01T16:06:25.923
> 
> 标签：git, merge

一点背景：

代码库主分支

代码库的 dev 分支

两者都在进行中（我知道，但我刚开始这个项目，所以我不怪）

在某一时刻，dev 被错误地合并回 master，然后几次提交之后所有这些更改都被还原（手动，看起来像）

现在，我需要真正将 dev 合并回 master ，但是所有意外合并然后恢复的更改当然都丢失了。

除了在合并后手动进行更改之外，我不太确定在这里做什么。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:15:01.473

我会建议一个[交互式 rebase](http://git-scm.com/book/en/Git-Tools-Rewriting-History#Reordering-Commits)。删除恢复更改的提交并修复任何合并冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T17:18:27.373

git 的美妙之处在于它的灵活性以及实际删除某些内容的难度。

这是处理它的一种方法：

```
git checkout master
git log (make note of all commits on master that you want which were done after the incorrect merge)
git reset --hard <commit before dev was merged in in error>
git cherry-pick <id's of commits previously identified>
git merge develop (to do the desired merge) 
```

正如另一个答案中提到的，交互式变基也是一种选择。您可以使用它来删除引入错误合并的提交和恢复它的提交。

请注意，您将重写历史记录，因此您必须使用 --force 推送到共享存储库并让其他开发人员知道，以便他们可以重新克隆或将更改拉入新分支等。确保在进行这些更改之前与团队协调很重要。

# android - 什么定义了两台计算机（或电话和计算机）之间的“直接通信”？用于 UDP（或 TCP）通信？

> ID：10853758
> 
> 赞同：0
> 
> 时间：2012-06-01T16:06:37.297
> 
> 标签：android, tcp, wifi, android-wifi

我想编写一个程序来无线访问我笔记本电脑上的 Android 手机摄像头，所以我的手机就像一个无线网络摄像头。我想在 Java 中实现 UDP（或 TCP）协议，以便在我的笔记本电脑和手机之间进行通信。

我正在考虑在我的笔记本电脑中创建一个 ad-hoc 无线网络并首先将我的手机连接到它，然后编写代码在我的笔记本电脑上创建一个服务器套接字，并在我的手机上创建一个客户端套接字。我知道这段代码适用于服务器和客户端之间的“直接通信”。但是这种自组织网络通信的方法会算作“直接通信”吗？如果没有，我该怎么做才能实现这一目标？

谢谢你，首先阅读我的整个问题，如果你能帮我回答这个问题，非常感谢

:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T07:52:37.173

首先：不要专注于自组织网络。在大多数情况下，具有基础设施模式接入点的 WiFi 将可用。如果在路上，所有最新版本的 Android 都能够充当无线接入点。

因此，让我们假设两个设备都连接到同一个网络并且能够相互访问（使用 IP 协议）——换句话说，它们能够`ping`相互访问。您必须解决的下一个问题是：两个应用程序如何找到彼此？Bonjour/Zeroconf 可能是一个解决方案（请参阅[除 JMDNS 之外还有其他用于 bonjour/zeroconf 的 Java 库吗？](https://stackoverflow.com/questions/1233204)）。

下一个问题是：你想使用什么协议？你提到了 TCP 和 UDP。在大多数情况下，UDP 将用于传输视频数据，因为您具有较低的延迟并且视频编解码器可以容忍丢失的数据包。

使用此信息，您可以创建一个`ServerSocket`并且（从客户端）知道在哪里连接到它。

# html - 如何使html表中的td（单元格）扩展为一行以适合一行？

> ID：10853763
> 
> 赞同：7
> 
> 时间：2012-06-01T16:06:58.850
> 
> 标签：html, html-table, tablerow

在某些 html 单元格 (td) 中，文本被换行，因为列的大小小于单元格上文本的大小。我不希望文本被换行，我希望列宽扩大，这样就不会发生换行！

我怎样才能做到这一点？

最后一点，我只能使用 html 代码，没有 css :(

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-01T16:11:01.957

令人困惑的问题，但我认为您可能正在寻找 colspan="x" 属性。

```
<table>
   <tr>
      <td>1</td>
      <td>2</td>
   </tr>
   <tr>
      <td colspan="2">fills both columns</td>
   </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-01T16:20:17.047

既然你不能使用 CSS，那么：

```
<td nowrap="nowrap"> 
```

我更喜欢在 TD (white-space:nowrap) 上使用 CSS，因为不支持 TD 元素上的 nowrap 属性 HTML 4.01 Strict / XHTML 1.0 Strict。

这是一个显示效果的快速**[jsFiddle 示例](http://jsfiddle.net/j08691/y4K8B/)**。取出属性，就可以看出区别了。

# .net - 在sharpsvn中读取文件的内容

> ID：10853772
> 
> 赞同：6
> 
> 时间：2012-06-01T16:07:53.993
> 
> 标签：.net, sharpsvn

我正在尝试使用 sharpsvn 读取 .csproj 文件的内容，但我似乎总是得到一个空文件。

这是我的代码：

```
MemoryStream myOut = new MemoryStream();       
svnClient.Write(path, myOut))
return myOut.GetLibsFromCsproj();

private static string GetLibsFromCsproj(this MemoryStream csjpros)
{
    TextReader tr = new StreamReader(csjpros);
    XElement projectNode = XElement.Load(tr);
    XNamespace msbuild = "http://schemas.microsoft.com/developer/msbuild/2003";
    var referenceNodes = projectNode.Descendants(msbuild + "ItemGroup").Descendants(msbuild + "Reference").ToString();
    return referenceNodes;
} 
```

当我的代码到达时`XElement.Load(tr);`，它会抛出一个错误，指出缺少根元素。它把我们的那`myOut`是空的。

难道我做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T20:22:28.427

你还记得`MemoryStream`在写入后将背面重置为开头吗？`return`尝试在语句之前添加这一行：

```
myOut.Seek(0, SeekOrigin.Begin); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T20:09:40.067

也许这会有所帮助：

[如何使用 c# 使用 sharpsvn 客户端读取文件的每个修订版](https://stackoverflow.com/a/1861968/863502)

# sql - 这个日期比较条件是否可以在 SQL 中使用？

> ID：10853774
> 
> 赞同：8
> 
> 时间：2012-06-01T16:08:01.093
> 
> 标签：sql, sql-server, database-performance

这种情况是可悲的吗？

```
AND  DATEDIFF(month,p.PlayerStatusLastTransitionDate,@now) BETWEEN 1 AND 7) 
```

我的经验法则是左侧的函数使条件不可分割。但在某些地方我读过 BETWEEN 子句是可分割的。 **那么有人确定吗？**

以供参考：

*   [是什么让 SQL 语句可搜索？](https://stackoverflow.com/questions/799584/what-makes-a-sql-statement-sargable)
*   [http://en.wikipedia.org/wiki/Sargable](http://en.wikipedia.org/wiki/Sargable)

注意：如果有任何大师在这里结束，请更新 Sargable Wikipedia 页面。我更新了一点，但我相信它可以改进更多:)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-01T16:24:58.873

使用 AdventureWorks，如果我们查看这两个等效查询：

```
SELECT OrderDate FROM Sales.SalesOrderHeader
WHERE DATEDIFF(month,OrderDate,GETDATE()) BETWEEN 1 AND 7;

SELECT OrderDate FROM Sales.SalesOrderHeader
WHERE OrderDate >= DATEADD(MONTH, -7, GETDATE())
  AND OrderDate <= DATEADD(MONTH, -1, GETDATE()); 
```

在这两种情况下，我们都会看到聚集索引扫描：

![在此处输入图像描述](../Images/6eb9499a38f827c3213a47f43db8973d.png)

但请注意仅在后一个查询中推荐/缺失的索引，因为它是唯一可以从中受益的：

![在此处输入图像描述](../Images/2068d9a5d514c4860a109bbdc7116c60.png)

如果我们向 OrderDate 列添加索引，则再次运行查询：

```
CREATE INDEX dt ON Sales.SalesOrderHeader(OrderDate);
GO

SELECT OrderDate FROM Sales.SalesOrderHeader
WHERE DATEDIFF(month,OrderDate,GETDATE()) BETWEEN 1 AND 7;

SELECT OrderDate FROM Sales.SalesOrderHeader
WHERE OrderDate >= DATEADD(MONTH, -7, GETDATE())
  AND OrderDate <= DATEADD(MONTH, -1, GETDATE()); 
```

我们看到了很大的不同——后者使用了一个 seek：

![在此处输入图像描述](../Images/97a3c6fdd1a12a3052fc59c782b68f4f.png)

![在此处输入图像描述](../Images/96264f5b8c22b5026e49ea50b1614c01.png)

还要注意您的查询版本的估计值是如何偏离的。这在大型数据集上绝对是灾难性的。

在极少数情况下，应用于列的函数或其他表达式将是 sargable。我知道的一种情况是`CONVERT(DATE, datetime_column)`——但是那个特定的优化没有记录在案，我还是建议远离它。不仅因为您暗示对列使用函数/表达式是可以的（并非在所有其他情况下），而且还因为[它可能导致浪费读取和灾难性估计](https://dba.stackexchange.com/questions/34047/cast-to-date-is-sargable-but-is-it-a-good-idea)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-01T16:19:56.673

如果这是可耻的，我会感到非常惊讶。一种选择可能是将其重写为：

```
WHERE p.PlayerStatusLastTransitionDate >= DATEADD(month,1,CAST(@now AS DATE))
AND   p.PlayerStatusLastTransitionDate <= DATEADD(month,7,CAST(@now AS DATE)) 
```

我相信这将是可悲的（即使它不那么漂亮）。

# java - 有没有一种简单的方法可以在不使用一些额外库的情况下在 Java 中解析 JSON？

> ID：10853779
> 
> 赞同：6
> 
> 时间：2012-06-01T16:08:19.383
> 
> 标签：java, javascript, json, parsing, servlets

我对 JavaScript 和 JSON 真的很陌生。我正在编写一个需要将 JSON 解析为 Java 对象的 Java servlet，但诀窍是我不能使用外部库，例如 json-simple 或 gson。

所以我已经将 JavaScript 文件的内容保存在一个名为“contents”的字符串中......

```
contents = "myVar = " + contents + ";";

BufferedWriter bWriter = new BufferedWriter(new OutputStreamWriter(response.getOutputStream(), "UTF-8"));
ScriptEngineManager manager = new ScriptEngineManager();
ScriptEngine engine = manager.getEngineByName("JavaScript");
Object returnVal = engine.eval(contents);            
NativeObject a = (sun.org.mozilla.javascript.internal.NativeObject) engine.get("myVar");

Object[] ids = a.getAllIds();

for (Object id : ids) {
    String newId = (String) id;
    bWriter.write("\n" + newId);
} 
```

这将正确打印出我的对象的各种属性的所有名称。问题是，我不知道从这里做什么。我尝试了各种不同的 NativeObject 方法都无济于事。

一定有一些非常明显的东西我错过了。谁能帮我吗？

谢谢。

# sql-server - 为什么我无法在 SQL Server 2008 中将 NULL 插入到可为空的 DATE 列中？

> ID：10853782
> 
> 赞同：2
> 
> 时间：2012-06-01T16:08:36.057
> 
> 标签：sql-server, sql-server-2008

我正在使用 SQL Server 2008r2。

我有一个表，其列定义为：

```
TheDate date null 
```

当我尝试在此列中插入 NULL 值时，我收到错误消息：“**操作数类型冲突：int 与日期不兼容**”。

如果我将数据类型更改为日期时间，它工作正常。

为什么这不适用于日期数据类型？

谢谢。

编辑：拉马克是对的：

我的插入语句使用 select 语句作为源，源表是使用“select into”临时表语句创建的，显然，由于该表是动态定义的，因此该列被分配了“int”数据类型插入了空值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T16:10:44.657

你不只是插入一个`NULL`，你正在插入一个`NULL`数据类型`INT`。改为插入：`CAST(NULL AS DATE)`

# c# - RavenDb 中的映射减少，更新 1

> ID：10853783
> 
> 赞同：1
> 
> 时间：2012-06-01T16:08:39.407
> 
> 标签：c#, mapreduce, ravendb

**更新 1**，按照 Ayende 的回答

这是我第一次进入 RavenDb 并进行试验，我写了一个小 map/reduce，但不幸的是结果是空的？

我在 RavenDb 中加载了大约 160 万份文档

一份文件：

```
public class Tick
{
    public DateTime Time;
    public decimal Ask;
    public decimal Bid;
    public double AskVolume;
    public double BidVolume;
} 
```

并希望在特定时间段内获得最低和最高询价。

按时间收集的定义为：

```
var ticks = session.Query<Tick>().Where(x => x.Time > new DateTime(2012, 4, 23) && x.Time < new DateTime(2012, 4, 24, 00, 0, 0)).ToList(); 
```

这给了我 90280 份文件，到目前为止一切都很好。

但是然后地图/减少：

```
Map = rows => from row in rows 
                          select new
                          {
                              Max = row.Bid,
                              Min = row.Bid, 
                              Time = row.Time,
                              Count = 1
                          };

Reduce = results => from result in results
                                group result by new{ result.MaxBid, result.Count} into g
                                select new
                                {
                                    Max = g.Key.MaxBid,
                                    Min = g.Min(x => x.MaxBid),
                                    Time = g.Key.Time,
                                    Count = g.Sum(x => x.Count)

                                }; 
```

...

```
private class TickAggregationResult
{
    public decimal MaxBid { get; set; }
        public decimal MinBid { get; set; }
        public int Count { get; set; }

    } 
```

然后我创建索引并尝试查询它：

```
Raven.Client.Indexes.IndexCreation.CreateIndexes(typeof(TickAggregation).Assembly, documentStore);

        var session = documentStore.OpenSession();

        var g1 = session.Query<TickAggregationResult>(typeof(TickAggregation).Name);

        var group = session.Query<Tick, TickAggregation>()
                         .Where(x => x.Time > new DateTime(2012, 4, 23) && 
                                     x.Time < new DateTime(2012, 4, 24, 00, 0, 0)
                                  )
            .Customize(x => x.WaitForNonStaleResults())
                                           .AsProjection<TickAggregationResult>(); 
```

但是该组只是空的:(

如您所见，我尝试了两种不同的查询，我不确定它们之间的区别，有人可以解释一下吗？

**现在我得到一个错误：** ![在此处输入图像描述](../Images/8c37e2a59e11b5fa6f01d716cf4b88c6.png)

该组仍然是空的:(

让我解释一下我要在纯 sql 中完成的工作：

```
select min(Ask), count(*) as TickCount from Ticks 
where Time between '2012-04-23' and '2012-04-24) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:42:50.383

不幸的是，Map/Reduce 不能那样工作。好吧，至少它的 Reduce 部分没有。为了减少您的设置，您必须预先定义特定的时间范围来分组，例如 - 每天、每周、每月等。如果您每天减少，您可以获得每天的最小/最大/计数。

有一种方法可以得到你想要的，但它有一些性能方面的考虑。基本上，您根本不减少，而是按时间索引，然后在转换结果时进行聚合。这类似于您运行第一个查询以过滤然后在客户端代码中聚合。唯一的好处是聚合是在服务器端完成的，因此您不必将所有数据传输到客户端。

这里的性能问题是您要过滤到多大的时间范围，或者更准确地说，您的过滤范围内会有多少项目？如果它比较小，您可以使用这种方法。如果它太大，您将在服务器检查结果集时等待。

下面是一个示例程序来说明这种技术：

```
using System;
using System.Linq;
using Raven.Client.Document;
using Raven.Client.Indexes;
using Raven.Client.Linq;

namespace ConsoleApplication1
{
  public class Tick
  {
    public string Id { get; set; }
    public DateTime Time { get; set; }
    public decimal Bid { get; set; }
  }

  /// <summary>
  /// This index is a true map/reduce, but its totals are for all time.
  /// You can't filter it by time range.
  /// </summary>
  class Ticks_Aggregate : AbstractIndexCreationTask<Tick, Ticks_Aggregate.Result>
  {
    public class Result
    {
      public decimal Min { get; set; }
      public decimal Max { get; set; }
      public int Count { get; set; }
    }

    public Ticks_Aggregate()
    {
      Map = ticks => from tick in ticks
               select new
                    {
                      Min = tick.Bid,
                      Max = tick.Bid,
                      Count = 1
                    };

      Reduce = results => from result in results
                group result by 0
                  into g
                  select new
                         {
                           Min = g.Min(x => x.Min),
                           Max = g.Max(x => x.Max),
                           Count = g.Sum(x => x.Count)
                         };
    }
  }

  /// <summary>
  /// This index can be filtered by time range, but it does not reduce anything
  /// so it will not be performant if there are many items inside the filter.
  /// </summary>
  class Ticks_ByTime : AbstractIndexCreationTask<Tick>
  {
    public class Result
    {
      public decimal Min { get; set; }
      public decimal Max { get; set; }
      public int Count { get; set; }
    }

    public Ticks_ByTime()
    {
      Map = ticks => from tick in ticks
               select new {tick.Time};

      TransformResults = (database, ticks) =>
                 from tick in ticks
                 group tick by 0
                 into g
                 select new
                      {
                        Min = g.Min(x => x.Bid),
                        Max = g.Max(x => x.Bid),
                        Count = g.Count()
                      };
    }
  }

  class Program
  {
    private static void Main()
    {
      var documentStore = new DocumentStore { Url = "http://localhost:8080" };
      documentStore.Initialize();
      IndexCreation.CreateIndexes(typeof(Program).Assembly, documentStore);

      var today = DateTime.Today;
      var rnd = new Random();

      using (var session = documentStore.OpenSession())
      {
        // Generate 100 random ticks
        for (var i = 0; i < 100; i++)
        {
          var tick = new Tick { Time = today.AddMinutes(i), Bid = rnd.Next(100, 1000) / 100m };
          session.Store(tick);
        }

        session.SaveChanges();
      }

      using (var session = documentStore.OpenSession())
      {
        // Query items with a filter.  This will create a dynamic index.
        var fromTime = today.AddMinutes(20);
        var toTime = today.AddMinutes(80);
        var ticks = session.Query<Tick>()
          .Where(x => x.Time >= fromTime && x.Time <= toTime)
          .OrderBy(x => x.Time);

        // Ouput the results of the above query
        foreach (var tick in ticks)
          Console.WriteLine("{0} {1}", tick.Time, tick.Bid);

        // Get the aggregates for all time
        var total = session.Query<Tick, Ticks_Aggregate>()
          .As<Ticks_Aggregate.Result>()
          .Single();
        Console.WriteLine();
        Console.WriteLine("Totals");
        Console.WriteLine("Min: {0}", total.Min);
        Console.WriteLine("Max: {0}", total.Max);
        Console.WriteLine("Count: {0}", total.Count);

        // Get the aggregates with a filter
        var filtered = session.Query<Tick, Ticks_ByTime>()
          .Where(x => x.Time >= fromTime && x.Time <= toTime)
          .As<Ticks_ByTime.Result>()
          .Take(1024)  // max you can take at once
          .ToList()    // required!
          .Single();
        Console.WriteLine();
        Console.WriteLine("Filtered");
        Console.WriteLine("Min: {0}", filtered.Min);
        Console.WriteLine("Max: {0}", filtered.Max);
        Console.WriteLine("Count: {0}", filtered.Count);
      }

      Console.ReadLine();
    }
  }
} 
```

我可以设想一个解决方案来解决在时间上聚合具有潜在大范围的过滤器的问题。reduce 必须将事物分解为不同级别的越来越小的时间单位。这个代码有点复杂，但我正在为自己的目的工作。完成后，我将在 www.ravendb.net 的知识库中发布。

* * *

**更新**

我在玩这个多一点，并在最后一个查询中注意到两件事。

1.  您必须`ToList()`在调用 single 之前执行 a 才能获得完整的结果集。
2.  即使这在服务器上运行，您在结果范围内可以拥有的最大值是 1024，并且您必须指定 a `Take(1024)`，否则您将获得默认值 128 max。由于它在服务器上运行，我没想到会这样。但我猜是因为您通常不会在 TransformResults 部分进行聚合。

我已经为此更新了代码。然而，除非你能保证范围足够小，否则我会等待我所说的更好的全图/减少。我在做这个工作。:)

# scala - 我可以使用 monad 转换器来简化这个组合吗？

> ID：10853788
> 
> 赞同：6
> 
> 时间：2012-06-01T16:08:46.357
> 
> 标签：scala, functional-programming, scalaz, monad-transformers, kleisli

假设我有

```
type VS[A] = Validation[String, A]

val v: VS[Option[A]]
val f: A => VS[B] 
```

我想得到类型的结果，`VS[Option[B]]`但如果`v`是 a `Success(None)`，结果也应该是 a `Success(None)`。这是一个例子：

```
scala> val v: VS[Option[String]] = some("4.5").success
v: VS[Option[String]] = Success(Some(4.5))

scala> val f = (s : String) => (try { s.toInt.success } catch { case x => x.getMessage.fail }): VS[Int]
f: String => VS[Int] = <function1> 
```

然后：

```
scala> import Validation.Monad._
import Validation.Monad._

scala> (v map2 f map (_.sequence)).join
res4: scalaz.Validation[String,Option[Int]] = Failure(For input string: "4.5") 
```

成功案例是：

```
scala> val v: VS[Option[String]]= some("5").success
v: VS[Option[String]] = Success(Some(5))

scala> (v map2 f map (_.sequence)).join //UGLY composition
res7: scalaz.Validation[String,Option[Int]] = Success(Some(5)) 
```

空壳是：

```
scala> val v: VS[Option[String]]= none[String].success
v: VS[Option[String]] = Success(None)

scala> (v map2 f map (_.sequence)).join
res6: scalaz.Validation[String,Option[Int]] = Success(None) 
```

有没有“更好”的方式来做到这一点（可能涉及 kleisli 组合或单子变换器）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T14:52:02.330

monad 转换`OptionT`器完全符合您的要求，它的`flatMapF`方法使使用变得干净利落。

我将使用 Scalaz 7 的析取类型 ( `\/`) 而不是`Validation`在此示例中，因为后者不是 Scalaz 7 中的 monad，但原理是相同的。

```
import scalaz._, std.option._, syntax.id._, syntax.monad._

type DS[+A] = String \/ A
type ODS[A] = OptionT[DS, A]

def f(s: String) = try s.toInt.right catch { case e => e.getMessage.left } 
```

现在我们可以编写以下内容：

```
scala> val v = OptionT(some("4.5").point[DS])
v: scalaz.OptionT[DS,java.lang.String] = OptionT(\/-(Some(4.5)))

scala> (v flatMapF f).run
res0: DS[Option[Int]] = -\/(For input string: "4.5") 
```

或等效地：

```
scala> ("4.5".point[ODS] flatMapF f).run
res1: DS[Option[Int]] = -\/(For input string: "4.5") 
```

或者成功案例：

```
scala> ("4".point[ODS] flatMapF f).run
res2: DS[Option[Int]] = \/-(Some(4)) 
```

或者空壳：

```
scala> (OptionT(none.point[DS]) flatMapF f).run
res3: DS[Option[Int]] = \/-(None) 
```

如预期的。

# java - 如何从文本文件中连续读取数据 - Java

> ID：10853792
> 
> 赞同：0
> 
> 时间：2012-06-01T16:09:18.073
> 
> 标签：java, file, jtextarea, bufferedreader, bufferedwriter

我一直在尝试将数据从命令提示符写入 JTextArea，但它不想为我工作，所以我尝试将数据写入文本文件。到目前为止它写了一行然后停止，所以我需要不断地从文本文件中读取，直到我停止它。这是我的代码：`

```
try {
        File consoleLog = new File("tempConsole.txt");    
        Process p = Runtime.getRuntime().exec("cmd /c minecraft.lnk");
        //writes the text from the console to tempConsole.txt
        BufferedReader input = new BufferedReader (new InputStreamReader(p.getInputStream()));
        BufferedWriter consoleOutputWriter = new BufferedWriter(new FileWriter("tempConsole.txt"));
        consoleOutputWriter.write("" + input);
        consoleOutputWriter.newLine();
        //reads the tempConsole.txt
        BufferedReader consoleOutputReader = new BufferedReader (new FileReader("tempConsole.txt"));
        //writes the tempConsole.txt to the on-sceen JTextArea.
        String outputFromTemp = consoleOutputReader.readLine(); 
        console.setText(outputFromTemp);
        consoleOutputWriter.close();
    } catch (Exception ex) {` 
```

感谢您的帮助，我一直在搜索我的大脑和互联网几个小时，但没有运气：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:20:06.587

```
BufferedReader in = new BufferedReader(new FileReader(fileName))

String line2;
while ((line2 = in.readLine()) != null) {
//do something
} 
```

# .net - SwitchCurrent Config“读取注册表值时出错”

> ID：10853793
> 
> 赞同：1
> 
> 时间：2012-06-01T16:09:20.033
> 
> 标签：.net, registry

我正在尝试使用我团队其他成员成功使用的应用程序。

我已经添加了注册表项，它们正是它们应该在的位置。

失败的代码是对 SQL 数据库中表的简单身份验证，并且注册表项包含用户名/密码/服务器 ip。

代码失败

```
SwitchCurrent.Config.GetProvider(String dsn) 
```

异常消息：

```
"Error reading registry values for connection string in PGandE - ..Config" 
```

堆栈跟踪：

```
 at SwitchCurrent.Config.GetProvider(String dsn)
   at ...Linq.Shared.SharedDataContext..ctor(String dsn) in C:\Users\Mike Gaughan\Code\...\...\...\Shared\SharedDataContext.cs:line 68
   at ..Rest.Security.AuthProvider.Validate(TokenRequest tokenRequest, Employee& employee) in C:\Users\Mike Gaughan\Code\...\...\Security\AuthProvider.cs:line 26 
```

我已确保将密钥的所有权限授予用户。

我正在通过 Mac OS 在 VM Fusion 上运行我的 Windows 开发环境，但我认为这不是问题，因为其他一切都运行良好。

我知道我对这个问题的描述很糟糕，但我真的没有得到太多信息，也不确定是否有人在黑暗中刺伤我可以尝试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T15:29:30.890

明显的解决方案。

我得到的注册表项缺少一些必需的值。

# javascript - 如何使用虚拟键盘在 Opera Mobile 中为简单表单触发 onsubmit() 事件？

> ID：10853803
> 
> 赞同：0
> 
> 时间：2012-06-01T16:10:04.377
> 
> 标签：javascript, html, forms, onsubmit, opera-mobile

我有一个小型应用程序，它通常有一个可见的文本输入，按 Enter 会触发 JavaScript 方法，而不会触发正常的表单提交。这是一个非常简单的测试用例：

```
<form onsubmit="document.write('form submitted!');return false">
    <input type="text">
    <input type="submit" style="display:none">
</form> 
```

在桌面浏览器上，这可以按预期工作 - 您输入文本，按 Enter，然后脚本就会执行。

但是，在 Opera Mobile 上，专注于文本输入会带来一个虚拟键盘；如果您输入文本并触摸“完成”，文本将传输到输入字段，但不会提交表单。也没有“进入”

我希望该应用程序在浏览器和设备上的行为方式相同，而不是让提交按钮仅在 Opera Mobile 中可见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:42:38.013

将`name`attr 添加到文本输入字段，Opera 将按预期提交表单（它将在虚拟键盘上显示“Go”而不是“Done”）。

```
<input name="whatever" type="text" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:14:55.327

你必须：

*   给你的表格一个 id
*   在opera mobile下捕捉“done”事件，恐怕我不知道它的名字
*   获取带有 id 的表单并在事件中调用其`submit()`方法。`done`

关于这次活动，我发现了一些信息：

Opera 开发者网站：

> Opera Presto 完全支持 DOM 2 事件，无一例外。

[http://www.opera.com/docs/specs/presto2.11/dom2/events/](http://www.opera.com/docs/specs/presto2.11/dom2/events/)

w3c：

> 6.1.2.4 虚拟键盘和和弦键盘
> 
> 虚拟键盘是基于软件的按键组，有多种不同的排列方式，常见于触摸屏设备；它们通常是模态的，能够在不同的动态键组之间切换，例如字母键、数字键或符号键。由于缺乏物理限制，这些键盘可以显示最广泛的字符，包括表情符号和其他符号，并且可能具有未由 Unicode [Unicode] 或本规范中定义的键值集表示的键。然而，为了便于创作和与现有内容的兼容性，虚拟键盘应尽可能产生正常范围的键盘事件和值。

[http://www.w3.org/TR/DOM-Level-3-Events/](http://www.w3.org/TR/DOM-Level-3-Events/)

与 webkit 技术不同，它基本上没有说明特定的触摸事件。因此，您必须抓住按键/上/下，解析 keyCode/which 属性，与“DONE”（一些警报会给您一个好的）比较，然后调用该`form.submit();`方法。

rgds。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T08:54:01.980

在 Opera Mobile 中似乎真的没有办法捕捉到“完成”按键：

*   它不会触发**keydown/keypress**，因此没有要捕获的键码
*   既不**模糊/**焦点丢失（即使在点击“完成”后焦点仍留在现场）
*   **使用每种键类型更改/输入**火（所以这是“完成”之前的方式）
*   **提交**事件也永远不会触发

在我看来，唯一的解决方案是真正**为“Opera Mobile”浏览器显示“提交”按钮**。

# java - ace:datatable 中的“first”属性如何工作？

> ID：10853806
> 
> 赞同：1
> 
> 时间：2012-06-01T16:10:09.120
> 
> 标签：java, jsf, pagination, icefaces-3, ace-datatable

我们试图通过某种同步分页将 3 个表放在同一页面中。由于 ace:datatable 中的“分页器”属性对于每个表都是独立的，因此我们使用一些 commandLinks 来实现向前和向后移动的功能。

我们已经尝试在表中使用 de“page”属性，将它们全部链接到 backing-bean 中的一个属性，该属性通过 commandLink 的 action 方法递增或递​​减。但是这个“page”属性只有在“paginator”属性设置为true时才有效。而且因为我们不想显示分页器本身（带有编号的页面、按钮和其他所有内容），我们不能使用这个属性。

我们也尝试过使用 ace:datatable 的“first”属性，并再次将此属性绑定到 backing-bean。但它没有做任何事情：当我们改变这个属性的值时，表格保持在填充它们的列表的相同位置。

我们正在使用个性化的 ArrayList 填充表（其中是与数据库中的表匹配的类）。并且只有在表格中启用分页器并使用“页面”属性时才能正常工作。

我们也使用了 Datamodel 对象，但没有积极的结果。

那么，ace:datatable 的“第一”属性有什么用？（请不要告诉我这个属性的 API 定义，我已经读过很多遍了；））。一位同事说，当他使用 ice:datatable 而不是 ACE 时，他成功了。

有谁知道实现这种情况的更好解决方案（3个具有相同分页的数据表，所以当您单击“前进”时，它们都移动到同一个位置）？

提前致谢。

**更新**：我通过 IceSoft 论坛收到了回复。nils.lundquist 说：

> 此问题的原因似乎是 ace:dataTable 派生自的库中的一些遗留分页代码。它无法识别为我们功能的一部分，所以我已经纠正了这个问题，假设测试顺利，修复将出现在我们即将发布的版本中（也包括测试版）。
> 
> 请注意，当启用组件控制的分页时， first 仍然没有效果，我已经调整了 TLD 以反映这一点。当分页被禁用时，First 现在将实际工作。

参考本周发布的iceFaces 3.1.0 beta02。

如果有人知道解决这种情况的更好方法（3 个带有分页链接的数据表），我们将不胜感激。

TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-16T08:58:46.813

通过升级到 IceFaces 3.1.0 解决

# android - SDK 级别 15 ApiDemos/OS/Sensors 在 Nexus S 上模糊了图像，但在模拟器上没有

> ID：10853807
> 
> 赞同：1
> 
> 时间：2012-06-01T16:10:10.790
> 
> 标签：android, android-emulator, android-sensors, android-4.0-ice-cream-sandwich, nexus-s

通常，ApiDemos/OS/Sensors 应用程序会显示三个表示当前方向的圆圈。当应用程序使用 SDK 级别 15 构建并在运行 OS 4.0.4 的 Nexus-S 上运行时，为什么这三个 Canvas 绘制的圆圈会变得模糊？我检查了 Nexus-S 的“设置/开发人员选项”，唯一检查的开发人员选项是“USB 调试”。我尝试切换“强制 GPU 渲染”开发人员选项，但模糊仍然存在。我还查看了使用 SDK 级别 15 构建的 ApiDemos/Graphics 应用程序中的 Canvas 绘图，并发现那里没有模糊问题。使用 SDK 级别 15 构建的 ApiDemos/OS/Sensors 应用程序中的这种模糊是否也发生在其他手机型号上？

下面，第一个截图是运行SDK level 15（OS 4.0.4）构建的ApiDemos的模拟器，第二个是运行SDK level 15构建的ApiDemos的Nexus-S，第三个是运行SDK level构建的ApiDemos的Nexus-S 10 (0S 2.3.3)。

![在此处输入图像描述](../Images/03bb64556f454a8cb50a4a0df527a83e.png)

![在此处输入图像描述](../Images/8e0ad5628ccc733a95edfc564a496521.png)

![在此处输入图像描述](../Images/ff4e3a4d393503c0a545ad9b3c029baa.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T04:27:11.307

在使用 SDK 级别 15 构建并在 Nexus S 上运行的 ApiDemos/OS/Sensors 中不需要的模糊行为已由 RichardC 在此 Google Groups android 开发人员线程中确认并解决：[https ://groups.google.com/forum/?hl=en&fromgroups #!topic/android-developers/2DT6JaPszR0](https://groups.google.com/forum/?hl=en&fromgroups#!topic/android-developers/2DT6JaPszR0)

简而言之，硬件加速器没有正确处理 ApiDemos/OS/Sensors 应用程序的绘图缓冲区复杂性（这可能会增加传感器数据显示速率）。RichardC 提供了两种解决方案：降低应用程序的绘图缓冲区复杂性，或者在清单中禁用 ApiDemos/OS/Sensors 应用程序的硬件加速。（我选择了前者，它并没有减慢传感器数据的显示速度。）

# android - drawBitmap 出了点问题 - 使用源和目标矩形

> ID：10853808
> 
> 赞同：1
> 
> 时间：2012-06-01T16:10:12.333
> 
> 标签：android

我有一个游戏，在其中一个关卡中，羊会被地雷炸毁。爆炸动画是通过在一个 512x515 png 文件中包含一个 4x4 爆炸图像数组的 png 来控制的……见下文。

![在此处输入图像描述](../Images/5baf6f85b4ed4c59a98efe4a4c7ee9ca.png)

然后我使用以下代码为爆炸设置动画：

```
 exp_bitmap_number_to_draw = (int)(time_since_death / 100);

            if (exp_bitmap_number_to_draw < 16)
            {
                explosion_dst_rect.left = b2sx(sheep_x[i]) - sheep_radius * 5;
                explosion_dst_rect.right = b2sx(sheep_x[i]) + sheep_radius * 5;

                explosion_dst_rect.bottom = b2sy(sheep_y[i]) + sheep_radius * 5;
                explosion_dst_rect.top = b2sy(sheep_y[i]) - sheep_radius * 5;

                explosion_src_rect.left = 128 * (exp_bitmap_number_to_draw % 4);
                explosion_src_rect.top = 128 * (exp_bitmap_number_to_draw / 4);

                explosion_src_rect.right = explosion_src_rect.left + 128;
                explosion_src_rect.bottom = explosion_src_rect.top + 128;

                canvas.drawBitmap(explosion_bitmap, explosion_src_rect, explosion_dst_rect, null);
            } 
```

其中explosion_src_rect 是一个Rect，explosion_dst_rect 是一个RectF。b2sx() 和 b2sy() 是从“运动场”上绵羊的绝对坐标转换为屏幕坐标的函数——它只是添加了一个偏移量。

该代码在我尝试过的几部手机上都能完美运行，包括 nexus S 和 Galaxy S II。但刚才有朋友在三星galaxy tab 8.9上试了代码，发现爆炸显得很傻。他给我发了这个部分截屏：

![在此处输入图像描述](../Images/33bf1a50491688ad21ff3706e5cd5c26.png)

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T17:12:46.337

如果资源在正确的密度下不可用，系统会加载默认资源并根据需要放大或缩小它们以匹配当前屏幕的密度。在某些情况下，您可能不希望 Android 预缩放资源。避免预缩放的最简单方法是将资源放在具有`nodpi`配置限定符的资源目录中。例如： `res/drawable-nodpi/icon.png`。所以你必须把你的位图放到``res/drawable-nodpi/`文件夹中。看看：http: [//developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T17:23:45.617

您的目标矩形的宽度，而不是您所说的爆炸框架之一的大小，被设置为画布/ 4的宽度。手机通常具有相似的大小，但较大的平板电脑具有更大的屏幕尺寸 - 正如文档中所说：

> 绘制指定的位图，自动缩放/平移以填充目标矩形 [...] 此函数忽略与位图关联的密度。这是因为源和目标矩形坐标空间具有各自的密度，因此必须已经应用了适当的缩放因子。

因此，未缩放到画布大小的位图是从 src Rect 开始绘制的，但会扩展到 src 的边界之外，因为它被告知填充 DST，而忽略了两个位置的密度。

至于解决方案，我不确定，确切地说 - 将各种尺寸的图像放在你的`/res`. 根据您加载位图的方式，您可能能够使位图缩放，但是您在位图上的固定宽度转换必须变得更加动态。

希望以某种方式有所帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T17:29:42.880

我有同样的问题，我在这里问过，我的答案是像这样加载我的位图，而不是正常的方式：

getResources().openRawResource(imageId)

# facebook - django-facebook 和更新 oauth 令牌

> ID：10853809
> 
> 赞同：1
> 
> 时间：2012-06-01T16:10:29.710
> 
> 标签：facebook, oauth, django-facebook

我在应用程序上使用[django-facebook 。](https://github.com/tschellenbach/Django-facebook)用户可以从应用程序发布开放图形操作，但自从离开offline_access 后，我遇到了过期的oauth 令牌问题。

我想在没有服务器端阻塞调用的情况下检查令牌有效性（并在必要时对其进行更新）。

我的第一个想法是从 javascript 库中提取当前的 access_token，然后在他们点击页面时保存到数据库中——但这会用 2 小时的时间覆盖长期的；不是很好。

更像 Facebook 在[他们的博客文章](https://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)中描述的东西可能会起作用，但是，我希望它是非阻塞的。此外，如果用户当前已登录应用程序，我不想只为更新令牌而向他们显示对话框。

django-facebook docs 注意到版本 4 支持“过期令牌的自动重新身份验证”，但我似乎没有在应用程序中触发它。

关于如何使用 django-facebook 自动实现这一点的具体细节会很棒，或者，这里有关标准/最佳实践的一些建议和指导会非常有帮助。谢谢！

（在这里为任何天真道歉，我是一名偶尔的 FB 开发人员，经常发现我落后于 Facebook API 的更改。）

# asp.net-mvc-4 - 表单发布时，MVC在模型中提交多个对象

> ID：10853823
> 
> 赞同：1
> 
> 时间：2012-06-01T16:11:49.920
> 
> 标签：asp.net-mvc-4, model-binding

我面临一个问题，当我有一个复杂的模型时，如果我提交表单，它不会给我所有模型属性的所有值，在下面的示例中，我没有取回 gridModel 属性：

**模型**

```
public class InventoryModel {
    public GridModel GridModel { get; set; }
    public Int32 UserKey { get; set; }
}

public class GridModel {
    public String GridId { get; set; }
    public String GridName { get; set; }
    public List<String> columns { get; set; }
} 
```

**控制器**

```
public ActionResult Index(){
    InventoryModel model = new InventoryModel();

    model.UserKey= 20014;
    model.GridModel = new GridModel();
    model.GridModel.GridId = "jqgInventory";
    model.GridModel.GridName = "Inventory Grid";
    return View(model);
}

 [HttpPost]
 public ActionResult Index(InventoryModel model){
    Int32 userId = model.UserKey; // This has a value
    String gridId = model.GridModel.GridId;  // This doesn't have a value
    String gridName= model.GridModel.GridName; // This doesn't have a value
} 
```

**看法**

```
@model InventoryModel
@using (Html.BeginForm()) {
    @Html.TextBoxFor(m => m.UserKey, new { @class = "w200" })
    @Html.TextBoxFor(m => m.GridModel.GridId , new { @class = "w200" })
    @Html.TextBoxFor(m => m.GridModel.GridName, new { @class = "w200" })

    <input type="submit" value="Submit" />
} 
```

任何建议都将不胜感激。

谢谢，阿拉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T21:39:01.133

您可以改为使用 ViewModel 而不是实际的模型。这将是一个更扁平的类，专门为视图反映数据。

```
public class InventoryViewModel{
    Int32 UserKey {get; set; }
    public String GridId { get; set; }
    public String GridName { get; set; }        
} 
```

如有必要，您的控制器可以将您的模型映射到您的 ViewModel

# mysql - MySQL 5.5 创建事件给出语法错误

> ID：10853826
> 
> 赞同：0
> 
> 时间：2012-06-01T16:11:56.257
> 
> 标签：mysql, mysql-event

我在创建 EVENT 时遇到问题。

我有一个'articoli'表。有一个 articoli.titolo 字段 varchar (255)，当我尝试创建这样的事件时：

```
CREATE EVENT inser_value
ON SCHEDULE every 1 day
DO INSERT INTO articoli (titolo) VALUES ('my_value'); 
```

这是mysqlerror的输出

> ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法以在第 1 行使用 near 'EVENT inser_value ON SCHEDULE 每 1 天 DO INSERT INTO articoli (titolo) VALUE'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T16:20:43.600

如果您的 MySQL 版本不支持 Event 模块，或者它没有启动，则会出现此错误。

请检查这两个。

本文讨论[如何配置 MySQL 事件调度程序](http://dev.mysql.com/doc/refman/5.1/en/events-configuration.html)。

**启动 MySQL 的事件调度器**

MySQL 事件由一个特殊的事件调度线程执行。默认情况下它是禁用的，因此使用以下 MySQL 命令可以确定它是否正在运行：

```
SHOW PROCESSLIST; 
```

如果调度程序正在运行，将至少显示两行，其中一行将其用户字段设置为`event_scheduler`。如果只返回一行，则调度程序被禁用并且事件不会运行。

`--event-scheduler=ON`您可以确保调度程序在使用命令行选项或`setting event_scheduler=ON`MySQL 配置文件（Windows 上的 my.cnf 或 my.ini）启动 MySQL 时启动。

或者，您可以从 MySQL 命令行启动调度程序：

```
SET GLOBAL event_scheduler = ON; 
```

* * *

# puppet - puppet chown/chmod 批量针对目录下的文件

> ID：10853831
> 
> 赞同：4
> 
> 时间：2012-06-01T16:12:23.650
> 
> 标签：puppet

在 puppet 中，您可以通过执行以下操作 chown/chmod 单个文件：

```
file {
    '/var/log/mylog/test.log':
    ensure  => 'present',
    mode    => '0644',
    owner    => 'me';
} 
```

关于这个的两个问题：

1.  ensure=>'present' 将确保 '/var/log/mylog/test.log' 存在，如果不存在则创建它。如果文件存在，如果文件不存在，有什么办法可以让它执行操作，不要费心创建/删除它，只需忽略它并继续。

2.  假设我在 /var/log/mylog/ 下有 3 个文件，我想批量对它们进行 chown/chmod，而不是在我的 puppet 代码中有 3 个文件资源部分。我可以做类似下面的事情吗（因为，下面的代码不存在，它现在在我的梦想中^_^）：

    ```
    files {
        '/var/log/mylog/*.log':
        ensure  => 'present',
        mode    => '0644',
        owner    => 'me';
    } 
    ```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T08:44:24.313

1.  如果您想指定在文件存在、文件不存在等情况下采取给定的操作。您目前别无选择（据我所知），只能使用`exec`带有`creates`+ `onlyif`或`unless`指令的资源。例如，您可以使用（请参阅[参考文档](http://docs.puppetlabs.com/references/stable/type.html#exec)）

    ```
     exec { "touch /var/log/mylog/test.log":
        path    => "/usr/bin:/usr/sbin:/bin",
        user    => "${yourmodule::params::user}",
        group   => "${yourmodule::params::group}",
        creates => "/var/log/mylog/test.log", 
        unless  => "test -f /var/log/mylog/test.log"
     }

     file { '/var/log/mylog/test.log':
        ensure  => 'present',
        mode    => "${${yourmodule::params::mode}",
        owner   => "${yourmodule::params::user}",
        group   => "${yourmodule::params::group}",
        require => Exec["touch /var/log/mylog/test.log"]    
     } 
    ```

2.  不，同样，您必须使用`exec`资源。

# perl - 当我在同一个哈希上循环时，在 Perl 中从哈希引用中删除一个键是否安全？为什么？

> ID：10853835
> 
> 赞同：11
> 
> 时间：2012-06-01T16:12:34.180
> 
> 标签：perl, hash, key

我基本上想这样做：

```
foreach my $key (keys $hash_ref) {

    Do stuff with my $key and $hash_ref

    # Delete the key from the hash
    delete $hash_ref->{$key};
} 
```

安全吗？为什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-01T16:19:31.343

您不是在遍历散列，而是在`keys`开始循环之前遍历返回的键列表。请记住，

```
for my $key (keys %$hash_ref) {
   ...
} 
```

大致相同

```
my @anon = keys %$hash_ref;
for my $key (@anon) {
   ...
} 
```

从哈希中删除不会导致任何问题。

* * *

[`each`](http://perldoc.perl.org/functions/each.html)，另一方面，确实迭代了一个哈希。每次调用它时，`each`都会返回一个不同的元素。`delete`然而，它对当前元素仍然是安全的！

```
# Also safe
while (my ($key) = each(%$hash_ref)) {
   ...
   delete $hash_ref->{$key};
   ...
} 
```

> 如果您在迭代散列时添加或删除它的元素，条目可能会被跳过或重复——所以不要这样做。例外：删除 each() 最近返回的项目总是安全的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T16:14:14.457

这是安全的，因为`keys %hash`在开始迭代之前提供了整个列表一次。`foreach`然后继续在这个预先生成的列表上工作，不管你在实际哈希中改变了什么。

但是它会占用您的记忆，因为您会保留整个列表，直到完成为止。

# dns - 如何在更新注册商记录之前测试新的域名服务器？

> ID：10853837
> 
> 赞同：18
> 
> 时间：2012-06-01T16:12:43.103
> 
> 标签：dns, nameservers, amazon-route53

我在新的 DNS 提供商处配置了一组 DNS 记录。配置很复杂，有负载平衡、SSL 等，有些事情可能会出错。

我想在注册商处更改命名空间记录之前测试此配置。

*   有没有办法在本地为我的机器提供域的新名称服务器？
*   有什么工具可以帮助解决这个问题吗？

*请注意：我不想只更新 A 记录（例如 in `/etc/hosts`） - 我想专门检查名称服务器是否返回 A 和 CNAME 记录。*

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-01T16:50:27.063

如果您在 *nix 系统上，您应该可以使用`nslookup`或`dig`。使用这两个命令，您可以指定要查询的服务器。只需使用您的新名称服务器作为服务器。使用`dig`，查询看起来像

```
dig @<your-nameserver> <hostname-to-look-up> 
```

因此，如果您想查询 google 的公共 dns 服务器并询问有关地址 www.google.com 的信息，您可以使用

```
dig @8.8.8.8 www.google.com 
```

其中，除其他外，它会告诉您 www.google.com 是 www.l.google.com 的别名——然后会为您提供该名称的一堆 IP 地址（A 记录）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-13T13:40:58.990

对于 Windows 和我的远程 Linux（CentOS）服务器，我使用`nslookup`在两个平台上都可以使用的工具：

```
nslookup new-sub.domain.com 8.8.8.8
// and for more details:
nslookup -debug new-sub.domain.com 8.8.8.8 
```

# c# - 重新执行的巨大差异

> ID：10853839
> 
> 赞同：0
> 
> 时间：2012-06-01T16:12:44.337
> 
> 标签：c#, runtime

我编写了一个小 C# 应用程序，它索引一本书并在索引上执行布尔文本检索算法。文章末尾的课程展示了两者的实现，构建索引并在其上执行算法。

代码通过 GUI 按钮以下列方式调用：

```
 private void Execute_Click(object sender, EventArgs e)
    {
        Stopwatch s;
        String output = "-----------------------\r\n";

        String sr = algoChoice.SelectedItem != null ? algoChoice.SelectedItem.ToString() : "";

        switch(sr){
            case "Naive search":
                output += "Naive search\r\n";
                algo = NaiveSearch.GetInstance();
                break;
            case "Boolean retrieval":
                output += "boolean retrieval\r\n";
                algo = BooleanRetrieval.GetInstance();
                break;
            default:
                outputTextbox.Text = outputTextbox.Text + "Choose retrieval-algorithm!\r\n";
                return;
        }
        output += algo.BuildIndex("../../DocumentCollection/PilzFuehrer.txt") + "\r\n";

        postIndexMemory = GC.GetTotalMemory(true);

        s = Stopwatch.StartNew();
        output += algo.Start("../../DocumentCollection/PilzFuehrer.txt", new String[] { "Pilz", "blau", "giftig", "Pilze" });
        s.Stop();

        postQueryMemory = GC.GetTotalMemory(true);
        output +=  "\r\nTime elapsed:" + s.ElapsedTicks/(double)Stopwatch.Frequency + "\r\n";

        outputTextbox.Text = output + outputTextbox.Text;
    } 
```

Start(...) 的第一次执行运行大约 700µs，每次重新运行只需要 <10µs。该应用程序使用 Visual Studio 2010 和默认的“调试”构建配置进行编译。

我进行了很多实验以找到原因，包括分析和不同的实现，但效果始终保持不变。

如果有人能给我一些新的想法，我会尝试什么，甚至是解释，我会很高兴。

```
 class BooleanRetrieval:RetrievalAlgorithm
    {
        protected static RetrievalAlgorithm theInstance;

        List<String> documentCollection;
        Dictionary<String, BitArray> index;

        private BooleanRetrieval()
            : base("BooleanRetrieval")
        {

        }

        public override String BuildIndex(string filepath)
        {
            documentCollection = new List<string>();
            index = new Dictionary<string, BitArray>();

            documentCollection.Add(filepath);

            for(int i=0; i<documentCollection.Count; ++i)
            {
                StreamReader input = new StreamReader(documentCollection[i]);

                var text = Regex.Split(input.ReadToEnd(), @"\W+").Distinct().ToArray();

                foreach (String wordToIndex in text)
                {
                    if (!index.ContainsKey(wordToIndex))
                    {
                        index.Add(wordToIndex, new BitArray(documentCollection.Count, false));
                    }

                    index[wordToIndex][i] = true;
                }
            }

            return "Index " + index.Keys.Count + "words.";            
        }

        public override String Start(String filepath, String[] search)
        {
            BitArray tempDecision = new BitArray(documentCollection.Count, true);

            List<String> res = new List<string>();

            foreach(String searchWord in search)
            {

                if (!index.ContainsKey(searchWord))
                    return "No documents found!";

                tempDecision.And(index[searchWord]);
            }

            for (int i = 0; i < tempDecision.Count; ++i )
            {
                if (tempDecision[i] == true)
                {
                    res.Add(documentCollection[i]);
                }
            }

            return res.Count>0 ? res[0]: "Empty!";
        }

        public static RetrievalAlgorithm GetInstance()
        {
            Contract.Ensures(Contract.Result<RetrievalAlgorithm>() != null, "result is null.");
            if (theInstance == null)
                theInstance = new BooleanRetrieval();

            theInstance.Executions++;
            return theInstance;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:41:41.313

.Net 应用程序的冷/热启动通常受 JIT 时间和加载程序集的磁盘访问时间的影响。

对于执行大量磁盘 IO 的应用程序，如果数据足够小以适合内存缓存，则由于缓存内容（也适用于程序集加载），第一次访问磁盘上的数据将比重新运行相同的数据慢得多为磁盘。

*   任务的首次运行将受到程序集和数据的磁盘 IO 以及 JIT 时间的影响。
*   第二次运行相同任务而无需重新启动应用程序 - 只需从操作系统内存缓存中读取数据。
*   第二次运行应用程序 - 再次从 OS 内存缓存和 JIT 读取程序集。

# nhibernate - Fluent NHibernate 一对多映射

> ID：10853841
> 
> 赞同：8
> 
> 时间：2012-06-01T16:12:54.047
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping, fluent-nhibernate-mapping

我有以下两个课程：

**广告**

```
public virtual int Id { get; set;
public virtual IList<AdvertImage> AdvertImages { get; set; } 
```

**广告图片**

```
public virtual int Id { get; set; }
public virtual string Filename { get; set;
public virtual Advert Advert { get; set; } 
```

在数据库中，我的 AdvertImages 表具有 FK 'AdvertId'，它与具有 'Id' PK 的 Adverts 表相关。

这是一对多映射，因为一个广告可以有许多图像。

我的 Fluent NHibernate 映射（为简洁而编辑）是：

**广告地图**

```
Id(x => x.Id)
  .GeneratedBy.Identity();
...
HasMany(x => x.AdvertImages)
  .KeyColumn("AdvertId")
  .Inverse();
...
Table("Adverts"); 
```

**广告图像地图**

```
Id(x => x.Id)
  .GeneratedBy.Identity();
...
References(x => x.Advert)
  .Column("AdvertId");
...
Table("AdvertImages"); 
```

我正在`Advert`代码中创建一个新实例，然后`AdvertImages`用`List<AdvertImage>`.

当我将我的`Advert`对象持久化到数据库时，我希望将 AdvertImages 插入到他们的 AdvertImages 表中，但是由于这两个表之间的关系，我需要先插入 Advert，以便生成 PK Id ，然后可以将其插入 AdvertImages 表中。（当我创建 AdvertImage 列表时，我正在填充 Filename 属性，但显然在那个阶段没有新的 AdvertId，因此希望在将广告持久保存到数据库时填充它）。

我尝试过使用不同的 Inverse() 和 Cascade 设置，但还没有成功。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T18:19:38.520

您需要将`Advert`映射更改为级联：

```
Id(x => x.Id)
  .GeneratedBy.Identity();

HasMany(x => x.AdvertImages)
  .KeyColumn("AdvertId")
  .Inverse()
  .Cascade.AllDeleteOrphan();

Table("Adverts"); 
```

然后你应该能够做这样的事情来持久化一个`Advert`对象和它的孩子`AdvertImage`。

```
Advert newAdvert = new Advert();
AdvertImage newImage = new AdvertImage();
newImage.Advert = newAdvert;
newAdvert.AdvertImages.Add(newImage);

using(NHibernate.ISession session = SessionFactory.GetCurrentSession())
{
    using (NHibernate.ITransaction tran = session.BeginTransaction())
    {
        session.Save(newAdvert);
        tran.Commit();
    }
} 
```

我的实体通常包含双向一对多关系的 Add 和 Remove 方法，如下所示：

```
public class Advert
{
    public virtual IList<AdvertImage> AdvertImages { get; set; }

    public virtual void AddImage(AdvertImage newImage)
    {
        newImage.Advert = this;
        AdvertImages.Add(newImage);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-21T14:36:21.477

我遇到过同样的问题。我花了一段时间尝试所有不同类型的映射。然后我发现我的映射很好，实际上我需要将会话包装在事务中并在 session.SaveOrUpdate() 方法之后使用 Commit() 方法。

```
using(var session = sessionFactory.OpenSession()) 
using(var tx = session.BeginTransaction()) 
{ 
// execute code that uses the session 
tx.Commit(); 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:52:11.770

对我有用的通常是将外键列设置为允许 DB 中的空值 - 这将是您的 AdvertId 列，但我不确定这是否适用于您的情况，因为您使用的是身份。NHibernate 所做的是用一个查询插入所有内容，然后将子表外键列更新为父表的正确 id。也许它也适用于你的情况。

这里有一些类似的问题可能会有所帮助：[Cascade insert on one-to-many with fluent NHibernate](https://stackoverflow.com/questions/3763824/cascade-insert-on-one-to-many-with-fluent-nhibernate)

# wpf - 绑定值更改时突出显示 WPF DataGrid 中的单元格

> ID：10853845
> 
> 赞同：14
> 
> 时间：2012-06-01T16:13:08.410
> 
> 标签：wpf, mvvm, datagrid, storyboard

我有一个 DataGrid，它的数据每 15 秒由后台进程刷新一次。如果任何数据发生变化，我想运行一个动画，以黄色突出显示具有更改值的单元格，然后淡化回白色。我通过执行以下操作使其工作：

我在 Binding.TargetUpdated 上创建了带有事件触发器的样式

```
<Style x:Key="ChangedCellStyle" TargetType="DataGridCell">
    <Style.Triggers>
        <EventTrigger RoutedEvent="Binding.TargetUpdated">
            <BeginStoryboard>
                <Storyboard>
                    <ColorAnimation Duration="00:00:15"
                        Storyboard.TargetProperty=
                            "(DataGridCell.Background).(SolidColorBrush.Color)" 
                        From="Yellow" To="Transparent" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Style.Triggers>
</Style> 
```

然后将其应用于我想在值更改时突出显示的列

```
<DataGridTextColumn Header="Status" 
    Binding="{Binding Path=Status, NotifyOnTargetUpdated=True}" 
    CellStyle="{StaticResource ChangedCellStyle}" /> 
```

如果数据库中状态字段的值发生更改，则单元格会像我想要的那样以黄色突出显示。但是，有几个问题。

首先，当最初加载数据网格时，整个列以黄色突出显示。这是有道理的，因为所有值都是第一次加载，因此您会期望 TargetUpdated 触发。我确信有某种方法可以阻止这种情况，但这是一个相对次要的问题。

真正的问题是，如果以任何方式对网格进行排序或过滤，整个列都会以黄色突出显示。我想我不明白为什么排序会导致 TargetUpdated 触发，因为数据没有改变，只是它的显示方式。

所以我的问题是（1）如何在初始加载和排序/过滤时停止这种行为，以及（2）我是否走在正确的轨道上，这甚至是一个好方法吗？我应该提到这是 MVVM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:50:49.030

我对第 (1) 点的想法是在代码中处理这个问题。一种方法是处理 DataGridTextColumn 的 TargetUpdated 事件，并对旧值与新值进行额外检查，并仅在值不同时应用样式，也许另一种方法是创建和删除绑定以编程方式基于代码中的不同事件（如初始加载、刷新等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-07T14:34:20.847

我建议对视图模型中的每个道具使用 OnPropertyChanged 并更新相关的 UIElement（启动动画或其他），这样您的问题将得到解决（加载、排序、过滤等），用户也可以看到哪个单元格发生了变化！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-02T09:59:57.463

因为`TargetUpdated`是真正唯一的基于 UI 更新的事件。更新如何发生并不重要。在对所有剩余物`DataGridCells`进行排序时，仅根据排序结果更改其中的数据，因此`TargetUpdated`会提高。因此我们必须依赖于 WPF 应用程序的数据层。为了实现这一点`DataGridCell`，如果在数据层发生更新，我已经重置了基于变量的绑定，这种跟踪。

***XAML：***

```
<Window.Resources>
    <Style x:Key="ChangedCellStyle" TargetType="DataGridCell">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="DataGridCell">
                    <ControlTemplate.Triggers>
                        <EventTrigger RoutedEvent="Binding.TargetUpdated">
                            <BeginStoryboard>
                                <Storyboard>
                                    <ColorAnimation Duration="00:00:04" Storyboard.TargetName="myTxt"
                                        Storyboard.TargetProperty="(DataGridCell.Background).(SolidColorBrush.Color)" 
                                        From="Red" To="Transparent" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>                           
                    </ControlTemplate.Triggers>

                    <TextBox HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent"
                             Name="myTxt" >
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=TemplatedParent},Path=DataContext.SourceUpdating}" Value="True">
                                        <Setter Property="Text" Value="{Binding RelativeSource={RelativeSource Mode=TemplatedParent},Path=Content.Text,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True}" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=TemplatedParent},Path=DataContext.SourceUpdating}" Value="False">
                                        <Setter Property="Text" Value="{Binding RelativeSource={RelativeSource Mode=TemplatedParent},Path=Content.Text}" />                                            
                                    </DataTrigger>                                       
                                </Style.Triggers>                                    
                            </Style>
                        </TextBox.Style>
                    </TextBox>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources>

<StackPanel Orientation="Vertical">
    <DataGrid ItemsSource="{Binding list}" CellStyle="{StaticResource ChangedCellStyle}" AutoGenerateColumns="False"
              Name="myGrid"  >
        <DataGrid.Columns>
            <DataGridTextColumn Header="Name" Binding="{Binding Name}" />
            <DataGridTextColumn Header="ID" Binding="{Binding Id}" />
        </DataGrid.Columns>
    </DataGrid>
    <Button Content="Change Values" Click="Button_Click" />
</StackPanel> 
```

***后面的代码（Window的DataContext对象）：***

```
 public MainWindow()
    {
        list = new ObservableCollection<MyClass>();
        list.Add(new MyClass() { Id = 1, Name = "aa" });
        list.Add(new MyClass() { Id = 2, Name = "bb" });
        list.Add(new MyClass() { Id = 3, Name = "cc" });
        list.Add(new MyClass() { Id = 4, Name = "dd" });
        list.Add(new MyClass() { Id = 5, Name = "ee" });
        list.Add(new MyClass() { Id = 6, Name = "ff" });   
        InitializeComponent();
    }

    private ObservableCollection<MyClass> _list;
    public ObservableCollection<MyClass> list
    {
        get{ return _list; }
        set{   
            _list = value;
            updateProperty("list");
        }
    }

    Random r = new Random(0);
    private void Button_Click(object sender, RoutedEventArgs e)
    {

        int id = (int)r.Next(6);
        list[id].Id += 1;
        int name = (int)r.Next(6);
        list[name].Name = "update " + r.Next(20000);
    } 
```

***模型类：*** `SourceUpdating`属性设置为 true（将绑定设置为`TargetUpdate`通过 a`DataTrigger`）当任何通知正在进行时`MyClass`in`updateProperty()`方法并且在更新被通知到之后`UI`，`SourceUpdating`设置为 false（然后将绑定重置为不`TargetUpdate`通过 a`DataTrigger`） .

```
public class MyClass : INotifyPropertyChanged
{
    private string name;
    public string Name
    {
        get { return name; }
        set { 
            name = value;updateProperty("Name");
        }
    }

    private int id;
    public int Id
    {
        get { return id; }
        set 
        { 
            id = value;updateProperty("Id");
        }
    }

    //the vaiable must set to ture when update in this calss is ion progress
    private bool sourceUpdating;
    public bool SourceUpdating
    {
        get { return sourceUpdating; }
        set 
        { 
            sourceUpdating = value;updateProperty("SourceUpdating");
        }
    }        

    public event PropertyChangedEventHandler PropertyChanged;
    public void updateProperty(string name)
    {
        if (name == "SourceUpdating")
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(name));
            }
        }
        else
        {
            SourceUpdating = true;               
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(name));
            }               
           SourceUpdating = false;                
        }
    }

} 
```

***输出：***

**两个同时更新/按钮被点击一次：**

[![更新1](../Images/20b92a8d13a3d1851e0c0f4a91f2538e.png)](https://i.stack.imgur.com/iisMx.jpg)

**许多同时更新/按钮被多次点击：**

[![更新2](../Images/7715329c7d7e2773e5d0779001204251.png)](https://i.stack.imgur.com/F2Hqy.jpg)

> ***所以更新后，当排序或过滤发生时，绑定知道它不必调用`TargetUpdated` 事件。仅当源集合的更新正在进行时，绑定才会重置以调用`TargetUpdated`事件。初始着色问题也由此得到处理。***

然而，由于逻辑仍然存在某种形式，因为对于编辑器`TextBox`，逻辑基于更复杂的数据类型和 UI 逻辑，代码将变得更复杂，初始绑定重置整行动画，因为`TargetUpdated`为一行的所有单元格设置.

# c++ - 如何获取字符串中特定元素的地址

> ID：10853849
> 
> 赞同：0
> 
> 时间：2012-06-01T16:13:27.050
> 
> 标签：c++, c, string

`char a[]="helloworld";`

我想得到'l'的地址？

`(a+2)`或`&a[2]`给出*lloworld*。并添加其他＆符号显示错误。

那么如何获取'l'的地址呢？

如果不可能，请解释一下？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T16:14:51.043

`a + 2`是数组中第三个元素的地址，也就是第一个的地址`l`。

在这个表达式中，`a`类型为 的`char[11]`，被隐式转换为指向其初始元素的指针，产生一个类型为 的指针，添加`char*`到该指针中`2`，给出数组第三个元素的地址。

`&a[2]`给出相同的结果。 `a[2]`等价于`*(a + 2)`，所以完整的表达式等价于`&*(a + 2)`。和`&`相互`*`抵消，留下`a + 2`，同上。

在你的程序中如何解释这个地址是另一回事。您可以将其用作“指向单个`char`对象的指针”，在这种情况下，它只是指向第一个`l`. 但是，您也可以将其解释为“指向包含在数组中的 C 字符串的指针，该指针从指向的 开始`char`，在这种情况下您会得到`"lloworld"`。这取决于您在获得该指针后如何使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T16:20:04.317

两者都是正确的，但如果你想输出它，你必须：

*   对于 C：使用适当的格式字符串（对于 C）： `printf("address: %p\n", &a[2]);`

*   对于 C++：通过强制转换为 a 来避免 cout 的字符串解释`void*`： `cout << "address: " << static_cast<void*>(&a[2]) << endl;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:16:09.480

我想你想要[`strchr`](http://www.cplusplus.com/reference/clibrary/cstring/strchr/)：

```
char *lAddress = strchr(a, 'l'); 
```

这将指向`l`. 您可以`printf`使用`%p`描述符打印它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T16:16:31.760

[`strchr`](http://en.cppreference.com/w/c/string/byte/strchr)将返回一个指针，指向（*地址*）字符串中给定字符的第一次出现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T16:18:16.767

你是什​​么意思它放弃了'lloworld'。如果将它用作 C 字符串，它仍然会以 null 结尾。只是在句子中进一步开始。

# sql - 坚持用户选择的最佳方式是什么？

> ID：10853850
> 
> 赞同：3
> 
> 时间：2012-06-01T16:13:35.023
> 
> 标签：sql, performance, persistence, user-input, maintainability

在我的应用程序中，我想在用户第一次访问屏幕时通过某种对话框提示用户一项新功能。并且在随后的访问中不会显示此对话框。

显而易见的解决方案是使用 cookie 或将其保存在数据库中。

但我担心： - 随着时间的推移，代码中的所有检查都会导致代码混乱 - 使用数据库解决方案 - 它会带来性能问题。

而且，如果用户清除了他的 cookie（例如），我不希望他们看到过去两年的每一个新功能更新（随着时间的推移，一个屏幕可以有多个新功能）。

有没有一种愚蠢/简单的方法来处理这个问题？推特和脸书在宣传他们的新功能时是如何做到这一点的？

我的环境是 MSSQL、ASP MVC，如果确实重要的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:54:46.187

两者都使用 - cookie 作为缓存技术 - 首先检查 cookie。如果它不包含标志 - 然后询问数据库。

此外，您可以在登录时初始化该 cookie。每个用户会话一次 DB 调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T20:10:54.627

由于您有用户登录，我假设您也有某种类型的服务器端会话。您可以将用户首选项存储在数据库中，并在登录时将它们缓存在会话中，避免每次请求都访问数据库。只要您出于身份验证目的信任您的会话，您当然可以出于用户偏好而信任它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T16:17:56.150

就个人而言，我会针对用户记录使用数据库标志。

就像你说的，cookie 可能会被破坏并导致烦人的重复提醒。

如果你做得对，我认为你不需要担心“混乱的代码”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T16:17:57.250

我们将它存储在 XML 中。然后您可以使用序列化来快速保存/加载设置。我们将 XML 存储在 SQL 中（MS SQL 具有支持 XML 的功能）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T16:18:49.053

那么代码中的检查与您存储数据的位置无关，这是一个不同的问题。

至于你的问题，我想说的是使用数据库，出于速度+轻松的原因。

# php - 使用 PHP 选择特定的 Tumblr XML 值

> ID：10853851
> 
> 赞同：2
> 
> 时间：2012-06-01T16:14:01.357
> 
> 标签：php, xml, tumblr

我的目标是使用他们提供的 XML 将 Tumblr 帖子嵌入到网站中。问题是 Tumblr 会为您发布的每张图片保存 6 种不同尺寸。我下面的代码将获得第一张图片，但它恰好太大。如果所有照片都具有相同的标签，我如何从 XML 中选择一张较小尺寸的照片`<photo-url>`？

→ 这是我正在使用的 Tumblr 中的 XML：[Tumblr XML](http://kthornbloom.tumblr.com/api/read?type=photo)。

→ 到目前为止，这是我的 PHP 代码：

```
<?php
$request_url = "http://kthornbloom.tumblr.com/api/read?type=photo";
$xml = simplexml_load_file($request_url);
$title = $xml->posts->post->{'photo-caption'};
$photo = $xml->posts->post->{'photo-url'};
echo '<h1>'.$title.'</h1>';
echo '<img src="'.$photo.'"/>"'; 
echo "…";
echo "</br><a target=frame2 href='".$link."'>Read More</a>"; 
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:50:10.503

该函数接受一个和`getPhoto`的数组。它返回(1) 最接近且 (2) 小于或等于 的照片。您可以调整该功能以满足您的需求。需要注意的重要事项是：`$photos``$desiredWidth``max-width``$desiredWidth`

*   `$xml->posts->post->{'photo-url'}`是一个数组。
*   `$photo['max-width']`访问标签`max-width`上的属性。`<photo>`

我曾经`echo '<pre>'; print_r($xml->posts->post); echo '</pre>';`发现`$xml->posts->post->{'photo-url'}`是一个数组。

我`$photo['max-width']`在[`SimpleXMLElement`](http://us3.php.net/manual/en/simplexmlelement.count.php).

```
function getPhoto($photos, $desiredWidth) {
    $currentPhoto = NULL;
    $currentDelta = PHP_INT_MAX;
    foreach ($photos as $photo) {
        $delta = abs($desiredWidth - $photo['max-width']);
        if ($photo['max-width'] <= $desiredWidth && $delta < $currentDelta) {
            $currentPhoto = $photo;
            $currentDelta = $delta;
        }
    }
    return $currentPhoto;
}

$request_url = "http://kthornbloom.tumblr.com/api/read?type=photo";
$xml = simplexml_load_file($request_url);

foreach ($xml->posts->post as $post) {
    echo '<h1>'.$post->{'photo-caption'}.'</h1>';
    echo '<img src="'.getPhoto($post->{'photo-url'}, 450).'"/>"'; 
    echo "...";
    echo "</br><a target=frame2 href='".$post['url']."'>Read More</a>"; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:26:44.353

要获得照片`max-width="100"`：

```
$xml = simplexml_load_file('tumblr.xml');

echo '<h1>'.$xml->posts->post->{'photo-caption'}.'</h1>';

foreach($xml->posts->post->{'photo-url'} as $url) {
    if ($url->attributes() == '100')
        echo '<img src="'.$url.'" />';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:18:43.890

也许是这样：

```
$doc = simplexml_load_file(
  'http://kthornbloom.tumblr.com/api/read?type=photo'
);

foreach ($doc->posts->post as $post) {
  foreach ($post->{'photo-url'} as $photo_url) {
    echo $photo_url;
    echo "\n";
  }
} 
```

# objective-c - 到同一主机的最大并发 NSURLConnection 数？

> ID：10853852
> 
> 赞同：8
> 
> 时间：2012-06-01T16:14:04.813
> 
> 标签：objective-c, macos, cocoa, nsurlconnection

我在 OS X 应用程序中遇到了一个问题，该应用程序使用 NSURLConnection 创建到同一主机的多个持久连接。我为不同的房间创建了一个单独的连接，并且在房间打开以使用流式 API 的整个过程中保持连接。打开许多房间时，它会停止正常工作。

我创建了一个单独的示例应用程序，它创建了 10 个连接，它似乎只允许 6 个连接工作，而其他连接则在排队。有谁知道是否有办法覆盖这个限制？我在任何地方都找不到它的记录。我发现的唯一解决方法是它似乎是每个主机名，因此使用“localhost”和“127.0.0.1”进行测试允许每个主机有 6 个连接。我在这里上传了一个带有客户端和服务器的示例项目 - [http://cl.ly/1x3K0D1F072V3U2T0C0I](http://cl.ly/1x3K0D1F072V3U2T0C0I)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T17:49:39.957

我为似乎相同但在 iOS 上的问题提交了 Radar。我发现一次打开的连接不能超过 5 个。连接不必指向同一个域。之后的任何事情都会排队。因此，如果您有 5 个连接打开到一个极慢的端点，则任何其他连接都不会通过。

雷达： http://openradar.appspot.com/radar?id= [2542401](http://openradar.appspot.com/radar?id=2542401)

苹果回复：

> 这是我们的 NSURLConnection 连接缓存的效果。这是预期的。我们希望使用新的 API 来解决这种类型的配置。

我问他们是否可以给我更多信息（它会有所不同吗？连接类型会影响它吗？）他们说：

> 不幸的是，我们无法提供有关连接限制行为的详细信息。
> 
> 一般的用户代理（Chrome、Firefox、Safari）每个主机名使用六个同时的 TCP 连接，可能是一次性的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-21T10:52:58.267

你可以通过使用 CFNetwork API (CFHTTPMessage) 来打破这个限制。

这是 CFNetwork 编程指南。 [https://developer.apple.com/library/mac/documentation/Networking/Conceptual/CFNetwork/Introduction/Introduction.html#//apple_ref/doc/uid/TP30001132](https://developer.apple.com/library/mac/documentation/Networking/Conceptual/CFNetwork/Introduction/Introduction.html#//apple_ref/doc/uid/TP30001132)

顺便说一句，如果您决定使用 CFNetwork，则需要绕过代理并进行身份验证。

希望这能有所帮助！

# jquery - 我可以在 jquery.data() 调用中使用 $(this) 吗？

> ID：10853858
> 
> 赞同：0
> 
> 时间：2012-06-01T16:14:25.283
> 
> 标签：jquery, jquery-selectors

我想将元素的默认值存储在该元素的`jQuery.data()`集合中。既然我做不到...

```
$("#myElement").data('defaultValue', $(this).html()); 
```

...因为`$(this)`没有给我参考`#myElement`，最有效的方法是什么？我试图避免像这样两次选择元素：

```
$("#myElement").data('defaultValue', $("#myElement").html()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:17:02.400

除了将 jQuery 对象保存在临时变量中之外，没有其他*明智的方法：*

```
var $element = $("#myElement");
$element.data('defaultValue', $element.html()); 
```

一种替代方式，只是一种表达方式，但恕我直言，情况要糟糕得多：

```
$("#myElement").each(function() { $(this).data('defaultValue', $(this).html()); }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:18:18.023

嗯。

你可以尝试破解它：

```
$("#myElement").each(function(){$(this).data('defaultValue', $(this).html());}); 
```

# 丑陋

或者喜欢其他帖子：

```
var $element = $("#myElement");
$element.data('defaultValue', $element.html()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:16:52.420

```
var el = $("#myElement");
el.data('defaultValue', el.html()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T16:17:33.397

```
var myElement = $("#myElement");
myElement.data('defaultValue', myElement.html()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T16:18:04.753

如果您是性能狂，您可以通过保存对#myElement 的引用来节省纳秒：

```
var $myElement = $("#myElement");
$myElement.data('defaultValue', $myElement.html()); 
```

# dojo - 自定义 Dojo 构建的字符串问题

> ID：10853861
> 
> 赞同：3
> 
> 时间：2012-06-01T16:14:47.433
> 
> 标签：dojo, dojo-build

试图弄清楚为什么我似乎无法在我的 dojo 构建中实习字符串。我的图层文件已正确创建，但与每个单独的 dijit 关联的代码未正确实习。

这是构建输出的一部分，说明了它失败的地方：

> ```
> release:  Interning strings for : ../../release/fwijits5.31.2012/content/fwijits/optionalDijits/commenting.js
> release:      ../../release/fwijits5.31.2012/content/fwijits/optionalDijits/templates/commenting.htm
> release:  Optimizing (shrinksafe, stripConsole=normal) file: ../../release/fwijits5.31.2012/content/fwijits/optionalDijits/commenting.js
> release:  Could not strip comments for file: ../../release/fwijits5.31.2012/content/fwijits/optionalDijits/commenting.js, 
> ```
> 
> 错误：内部错误：非法字符

看起来优化失败了，因为模板没有正确添加到 js 文件中。这是 html 被实习后 js 的样子。您无法从输出中看出，但在 javascript 的末尾添加了一堆特殊字符。

```
if(!dojo._hasResource["fwijits.optionalDijits.commenting"]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource["fwijits.optionalDijits.commenting"] = true;
dojo.provide("fwijits.optionalDijits.commenting");

dojo.require("dijit._Widget");
dojo.require("dijit._Templated");

dojo.require("dijit.layout.ContentPane");
dojo.require("dijit.layout.TabContainer");

//The main widget that gets returned to the browser
dojo.declare("fwijits.optionalDijits.commenting", [dijit.layout.ContentPane, dijit._Templated], {

  widgetsInTemplate: true,
  _earlyTemplatedStartup: true,
  templateString: dojo.cache("fwijits.optionalDijits", "templates/commenting.htm"),
  basePath: dojo.moduleUrl("fwijits.optionalDijits"),

  //This function contains all configurable parameters
  constructor: function(params){
    params = params ||{};
    this.inherited(arguments);
  },

  //This functions run on a "startup" call
  startup: function(){
    var _this = this;

    this.inherited(arguments);
  },

  _addPointComment:function(){
    console.debug("button clicked");
  }

});

} 
```

htm 文件非常简单，所以我认为这不是我问题的根源。

```
<div dojoAttachPoint="containerNode">
  <div dojoattachpoint="_outerDiv">
    <div dojoattachpoint="_addPoint" dojotype="dijit.form.Button" dojoattachevent="onClick:_addPointComment"><b>Add Comment</b></div>
  </div>
</div> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T02:57:49.067

哪个版本的道场？构建系统中存在不以 HTML 或 HTM 结尾的实习字符串的错误，尽管我从未尝试过使用 HTM 来确定。

可能值得一试。我知道这已在 1.7 中修复并向后移植到 1.8。

[https://bugs.dojotoolkit.org/ticket/15867](https://bugs.dojotoolkit.org/ticket/15867)

# objective-c - 你可以通过dismissModalViewControllerAnimated返回数据：还是你需要一个segue来回程？

> ID：10853868
> 
> 赞同：1
> 
> 时间：2012-06-01T16:15:04.927
> 
> 标签：objective-c, ios, ios5, storyboard, segue

我有一个`ViewController`，它有一个`UIButton`执行以下操作：

```
- (IBAction)buttonClicked:(id)sender 
{
    NSLog(@"Button clicked, lets move to next controller to do stuff");
    [self performSegueWithIdentifier:@"toNextController" sender:nil];
} 
```

这只是转移到我的下一个`ViewController`，到目前为止没有什么了不起的。

在第二个 ViewController 中，我会做一些我的应用程序逻辑，然后返回。

```
- (IBAction)backButtonPressed:(id)sender 
{
    NSLog(@"Back button clicked, lets just drop out of here...");
    [self dismissModalViewControllerAnimated:YES];
}

- (IBAction)saveButtonPressed:(id)sender 
{
    NSLog(@"save button clicked, lets send some data back");

    [self performSegueWithIdentifier:@"backToMain" sender:nil];
}

-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{    
    if ([segue.identifier isEqualToString:@"backToMain"])
    {
        NSLog(@"Preparing segue for backToMain");

        // Obtain handles on the current and destination controllers
        MainController * startingViewController;
        SecondController * destinationController;

        startingViewController = (MainController * ) segue.sourceViewController;
        destinationController = (SecondController * ) segue.destinationViewController;

        // set data on the main controller
        startingViewController.myString = @"SomeDummyString";
    }
} 
```

到目前为止，我尝试做的是创建第二个链接回主控制器的转场，在执行转场之前，抓住它的句柄并设置数据。我不确定这是否是返回的最佳方式。

**问题：**

是否有可能在执行 a 时返回数据`[self dismissModalViewControllerAnimated:YES];`，或者您是否需要为回程实施 segue？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:32:50.777

你可以做类似的事情

```
[destinationController setSomeData:@"Sending Something Back"]; 
```

这将在加载之前在您的destinationController 中设置一个@property。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:47:47.263

看看这个：[10841897](https://stackoverflow.com/questions/10841653/create-a-modal-view-with-navigation-bar-and-back-button/10841897#10841897)

它描述了使用委托和协议来回发送信息。它可以稍微改变以满足您的需求，只需创建一个`savedWithData:`将字典或您想要的任何数据发送回第一个视图控制器的方法，而不仅仅是`done`链接中描述的泛型。

# android - 加载内置应用程序后选项卡消失

> ID：10853870
> 
> 赞同：2
> 
> 时间：2012-06-01T16:15:12.727
> 
> 标签：android, android-tabs

我真的迷路了。

我有一个使用 3 个 XML 文件的应用程序，每个 xml 文件用于每个选项卡（我的应用程序有 3 个选项卡），效果很好。在其中一个选项卡下有一个按钮，当我单击它时，它意味着从联系人应用程序中获取姓名和号码并将其打印在该选项卡的屏幕上，这是通过连接到数据库并获取姓名和从联系人应用程序中选择后的号码。他们都工作正常。

但总是在处理和获取数据并在 tb3 下设置 textview 值之后，主要的 3 个选项卡消失了，并且所有 3 个不同的 XML 文件都组合在一起。有人知道为什么吗？

有谁知道该怎么做？任何教程？

有人建议使用*Fragmentmanager*，但我不知道如何使用它？

拜托，请有人帮我解决这个问题。

这是显示选项卡的主要活动的代码：

```
public class MainActivity extends TabActivity {

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Resources res = getResources(); // Resource object to get Drawables
    TabHost tabHost = getTabHost();  // The activity TabHost
    Button addbutton = (Button) findViewById(R.id.addButton);

    tabHost.addTab(tabHost.newTabSpec("tab1").setIndicator("tab1",
            res.getDrawable(R.drawable.tab1)).setContent(R.id.tab1Layout));

    tabHost.addTab(tabHost.newTabSpec("tab2").setIndicator("tab2",
            res.getDrawable(R.drawable.tab2)).setContent(R.id.tab2Layout));

    tabHost.addTab(tabHost.newTabSpec("tab3").setIndicator("tab3",
            res.getDrawable(R.drawable.tab3)).setContent(R.id.tab3));

    tabHost.setCurrentTab(2);

    addbutton .setOnClickListener(new View.OnClickListener() { 
        public void onClick(View v) { 

        Intent intent = new Intent(MyActivity.this,ContactsDemo.class); 

        MainActivity.this.startActivityForResult(intent,1); 

        } 

        }); 

} 
```

}

这假设打开 myActivity，然后返回 MainAcitiviy。但是在它加载另一个活动之后，所有三个选项卡都消失了，所有三个 xml 文件都合并了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T12:39:14.533

鉴于您的信息，我只能假设它`addButton`在`Button`您的一个选项卡上，并且您想返回到原始选项卡或其他两个选项卡之一。我已经构建了一个类似的应用程序，我认为您必须将`startActivityForResult()`-call 放在其中一个选项卡活动中，因为您提到 tb3 这将是一个好的开始。当我执行`startActivity()`or `startActivityForResult()`-call 并且此新活动已关闭或用户点击后退按钮时，我将回到我的选项卡上，并且选项卡功能区可见。

希望这可以帮助。

# wcf - 带有 WebInvokeBodyStyle 包装的 WCF POST 服务未按预期工作

> ID：10853873
> 
> 赞同：0
> 
> 时间：2012-06-01T16:15:29.990
> 
> 标签：wcf, rest, post, httpwebrequest, http-post

我创建了一个具有以下提到的签名的 WCF POST 服务。这在 IIS 中成功托管，我可以在服务的帮助页面中看到它：

```
[OperationContract]
    [WebInvoke(BodyStyle = WebMessageBodyStyle.Wrapped,
        RequestFormat = WebMessageFormat.Xml,
        ResponseFormat = WebMessageFormat.Xml,
        Method = "POST",
        UriTemplate = "TestMethod/{lang}/{str}/{selectedstring}/")]
    string TestMethod(string lang, string str, string selectedstring, string mylist, int testval); 
```

在服务的帮助页面上，该方法正确显示为

```
TestMethod/{lang}/{str}/{selectedstring}/ || POST || Service at http://localhost:86/MyRestService.svc/TestMethod/{LANG}/{STR}/{SELECTEDSTRING}/ 
```

我正在尝试使用带有以下提到选项的提琴手来调用此服务（基于对博客的一些查找）：

方法：发布

URL - 'http://servername:86/MyRestService.svc/TestMethod/en-us/str1/qad11/'

请求。标头：用户代理：提琴手主机：服务器名称：86 内容类型：应用程序/xml

请求正文：

```
<TestMethod xmlns="http://tempuri.org/"><mylist>string val</mylist><testval>3</testval></TestMethod> 
```

但是，它总是给我一个 HTTP 结果代码 411（需要长度），当我尝试从我的 .net 测试存根调用服务时出现同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T16:14:41.297

Fiddler 应该计算`Content-Length`为您命名的 HTTP 标头（至少它适用于 v2.3.9.3）检查*请求*的原始选项卡中的类似内容：`Content-Length: nnn`其中 nnn 是请求正文的字符串长度。如果没有，那么您需要自己添加它。此外，您可以尝试像[POSTMan chrome 插件这样的](https://github.com/a85/POSTMan-Chrome-Extension/wiki)浏览器插件来创建您的请求。

# cordova - 有没有人有使用 stackmob 作为 phonegap 应用程序后端的经验？

> ID：10853877
> 
> 赞同：3
> 
> 时间：2012-06-01T16:15:39.600
> 
> 标签：cordova, stackmob

您建议将什么用作 phonegap 应用程序的后端，只需要允许登录、保存一些用户数据和发送通知？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T14:25:14.163

我是 StackMob 的平台传播者。

你可以在 PhoneGap 上运行。我们很快就会在安全性方面为其建立官方支持，但在准备中，JS SDK 已经更新为这样做，利用 PhoneGap 的浏览器允许跨域 ajax 调用这一事实。把它放在你的 StackMob.init 中：

StackMob.init({ ... fullURL: true, ... });

它应该工作！我们还没有正式记录它，以便在不久的将来将它与 OAuth 2.0 支持捆绑在一起。

上述步骤假设您已经链接了您的 GitHub 帐户，因此启用了我们的代理服务器。当我们正式支持 PhoneGap 时，我们将更新一个不需要 GitHub 的入门流程。

# android - 在 Android 中启动手机启动活动

> ID：10853879
> 
> 赞同：3
> 
> 时间：2012-06-01T16:15:49.800
> 
> 标签：android, android-activity, startup, boot

我想在手机启动时自动启动我的应用程序。我在清单文件中声明了一个 BroadcastReceiver。

```
<receiver android:name=".Autostart">  
<intent-filter>  
    <action android:name="android.intent.action.BOOT_COMPLETED" />  
</intent-filter> 
```

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" /> 
```

我为接收器制作了一个java文件。

自动启动.java

```
public class Autostart extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {
    if ("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())) {  

    Intent pushIntent = new Intent(context, MushTouchActivity.class); 
    pushIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    context.startActivity(pushIntent);
    }
} 
```

}

但是，当我打开手机时，应用程序没有启动。谁能告诉我我在这里想念什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T16:17:40.183

试试你的 if 语句：

```
 if (intent.getAction().equals(Intent.ACTION_BOOT_COMPLETED)){

        Intent i = new Intent(context, MushTouchActivity.class);
        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

        context.startActivity(i);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T16:49:30.847

如果您使用的是 Android 3.1 或更高版本：

确保您至少手动启动了一次应用程序（例如，通过从应用程序抽屉打开它）。否则，您的应用会被系统标记为已停止：

> 应用程序在首次安装但尚未启动时处于停止状态

停止的应用程序不会收到任何广播意图，包括`BOOT_COMPLETED`.

*请参阅[安卓 3.1。平台 - 在已停止的应用程序上启动控件以](http://developer.android.com/sdk/android-3.1.html)获取更多信息。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-15T09:09:32.273

最好的答案是显示一个通知并要求用户从该通知启动应用程序，并在通知中为该活动使用挂起的意图。

# html - 如何从 HTML 中的链接中删除下划线？

> ID：10853881
> 
> 赞同：144
> 
> 时间：2012-06-01T16:15:54.333
> 
> 标签：html

在我的页面中，我放置了一些我不想要任何行的链接，那么，如何使用 HTML 将其删除？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2012-06-01T16:19:29.167

[内联](http://www.w3schools.com/cssref/pr_text_text-decoration.asp)版本：

```
<a href="http://yoursite.com/" style="text-decoration:none">yoursite</a> 
```

但是请记住，您通常[应该](https://stackoverflow.com/questions/12013532/inline-style-tags-vs-inline-css-properties)[将](https://stackoverflow.com/questions/3142710/inline-styles-vs-classes)网站的内容（即[HTML](http://www.w3schools.com/html/html_styles.asp)）与演示文稿（即[CSS](http://www.w3schools.com/css/css_intro.asp)）分开。因此，您通常应该[避免使用内联样式](https://stackoverflow.com/questions/2612483/whats-so-bad-about-in-line-css)。

请参阅[John 的答案以查看使用](https://stackoverflow.com/a/10853894/1321680)[CSS](https://stackoverflow.com/questions/2041388/how-to-remove-the-underline-for-anchorslinks)的等效答案。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-06-01T16:16:39.607

这将从所有链接中删除所有下划线：

```
a {text-decoration: none; } 
```

如果您有要应用它的特定链接，请给它们一个类名，例如`nounderline`并执行以下操作：

```
a.nounderline {text-decoration: none; } 
```

这将仅适用于这些链接，而其他所有链接不受影响。

此代码属于`<head>`您的文档或样式表中：

```
<head>
    <style type="text/css">
        a.nounderline {text-decoration: none; }
    </style>
</head> 
```

在体内：

```
<a href="#" class="nounderline">Link</a> 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-02-09T13:08:12.373

如果鼠标指针位于锚点上方，我建议使用 :hover 来避免下划线

```
a:hover {
   text-decoration:none;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-01T16:18:24.417

1.  将此添加到您的外部样式表（**首选**）：

    ```
    a {text-decoration:none;} 
    ```

2.  或者将其添加到`<head>`您的 HTML 文档中：

    ```
    <style type="text/css">
     a {text-decoration:none;}
    </style> 
    ```

3.  或者将其添加到`a`元素本身（*不推荐*）：

    ```
    <!-- Add [ style="text-decoration:none;"] -->
    <a href="http://example.com" style="text-decoration:none;">Text</a> 
    ```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-12-11T17:27:10.837

其他答案都提到了文字装饰。有时您使用 Wordpress 主题或其他人的 CSS，其中链接由其他方法加下划线，因此 text-decoration: none 不会关闭下划线。

Border 和 box-shadow 是我知道的另外两种为链接添加下划线的方法。要关闭这些：

```
border: none; 
```

和

```
box-shadow: none; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-01T16:21:32.993

**以下不是最佳实践，但有时可以证明是有用的**

最好使用 John Conde 提供的解决方案，但有时，使用外部 CSS 是不可能的。因此，您可以将以下内容添加到您的 HTML 标记中：

```
<a style="text-decoration:none;">My Link</a> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-05-15T12:52:54.380

上述所有代码都对我不起作用。当我深入研究这个问题时，我意识到它不起作用，因为我将样式放在了 href 之后。当我将样式放在 href 之前时，它按预期工作。

```
<a style="text-decoration:none" href="http://yoursite.com/">yoursite</a> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-19T09:20:57.593

```
<style="text-decoration: none"> 
```

上面的代码就足够了。只需将其粘贴到您要从中删除下划线的链接中。

# c++ - 在 Makefile 中解决依赖关系的常用方法是什么？

> ID：10853887
> 
> 赞同：4
> 
> 时间：2012-06-01T16:16:13.343
> 
> 标签：c++, c, makefile

我已经看到很多方法被用来解决 Makefile 中的依赖关系，例如 using`gcc -MM`和`sed`commond，或者使用`include`指令（加上一点 Perl 魔法），or `qmake`, or `automake`, or`info make`等​​。

面对如此多的选择，我很困惑我应该选择哪一个。那么，我想知道现在解决 Makefile 中依赖项的常用方法是什么？解决这个问题的最佳方法是什么？

PS：C/CPP项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:57:59.753

通常，如果您只关心支持 GNU make 和 gcc 的系统（例如所有 linux 变体和当今大多数类似 unix 的系统），您只需使用 gcc 的各种`-M`标志来生成依赖项，然后`-include`在 Makefile 中生成依赖项。[这个问题](https://stackoverflow.com/questions/10694403/gnu-make-why-this-complex-syntax-to-generate-dependencies)有一些很好的信息——通常不需要使用 sed 或任何更复杂的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:30:49.017

如果您只需要支持许多 Linux 发行版（正如您在评论中指出的那样），那么我会推荐该`automake/autoconf`套件。

该答案假设您只是一般性地询问，并且您还不知道在进行过程中必须解决哪些具体问题。

**编辑**：

GNU make 可以单独处理您自己项目中的依赖项生成。

`autoconf`处理对第三方库、工具或系统功能的可选或替代依赖项。 `automake`提供了一些[宏](http://sunsite.ualberta.ca/Documentation/Gnu/automake-1.5/html_node/automake_88.html)，即使您在`autoconf`没有`automake`.

从完全开始的一个附带好处`automake`是，您的 makefile 的行为将完全可预测（在约定和可移植性方面），而且投入较少。

因此，我的谦虚建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T17:58:06.127

有几种方法可以为 C/C++ 项目生成兼容的依赖项：

*   `gcc -M`，它有多种风格，在准确性方面有点“黄金标准”，因为它使用实际的编译器来生成依赖关系，还有谁会`#include`比编译器本身更了解如何处理语句？
*   [`makedepend`](http://en.wikipedia.org/wiki/Makedepend)，通常不鼓励使用编译器生成的依赖项。
*   [`fastdep`](http://freecode.com/projects/fastdep)，另一个第三方依赖生成器，声称比`gcc -M`.
*   [ElectricAccelerator有一个名为](http://www.electric-cloud.com/products/electricaccelerator-dev.php)*autodep*的内置功能，它使用构建中调​​用的命令的文件系统使用活动来生成依赖关系信息。autodep 相对于其他替代方案的优势在于它非常快速且完全独立于工具和编程语言——而其他都与 C/C++ 相关联或需要使用特定的编译器，autodep 可与所有类型的构建工具一起使用。

不久前，我对其中几个选项进行了[性能比较。](http://www.electric-cloud.com/blog/2008/12/15/automatic-dependency-management-with-electricaccelerator/)

免责声明：我是 ElectricAccelerator 的架构师和首席开发人员。

# java - 类的每个方法的观察者

> ID：10853889
> 
> 赞同：1
> 
> 时间：2012-06-01T16:16:24.793
> 
> 标签：java, observer-pattern

我想为java中的每个方法保留观察者，即如果调用任何方法，我应该得到通知。或者如果任何成员变量被更新，我应该得到通知。有没有什么java框架可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T16:17:18.047

你应该看看[AspectJ](http://www.eclipse.org/aspectj/)。该框架允许您为方法调用和字段更新添加挂钩。

# zsh - 在指定文件夹中运行 zsh 脚本

> ID：10853897
> 
> 赞同：5
> 
> 时间：2012-06-01T16:16:51.277
> 
> 标签：zsh

如何在指定文件夹中运行 zsh 脚本？如何指定一个文件夹来运行一个脚本：

```
zsh script_name.sh 
```

文件说：“-s 强制 shell 从标准输入读取命令。如果 -s 标志不存在并且给出了参数，则第一个参数被视为要执行的脚本的路径名。” 但它不起作用。

`zsh -c ~/path1/ script1.sh`(2 个参数) 和有什么区别`zsh -c ~/path1/script1.sh`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T23:18:16.363

*您应该只打开一个子shell，从 zsh或 bash*执行以下命令（包括括号）：

```
(cd ~/path1 && source script1.sh) 
```

注意：如果您的脚本是为 zsh 编写的，请改为命名`script1.zsh`，因为 zsh 语法与旧 sh 的语法不兼容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T16:26:22.123

这应该有效：

```
zsh -c "cd ~/path1 && ./script_name.sh" 
```

# wpf - 异步计算字体大小

> ID：10853906
> 
> 赞同：0
> 
> 时间：2012-06-01T16:17:29.077
> 
> 标签：wpf, fonts, textblock

我使用 WPF。我的应用程序有一些文本块，里面有可更改的文本。每个都有 200 的宽度和 150 的高度。问题是我有 7 个这样的文本块，我希望它们具有相同的字体大小。文本必须自动调整。我知道这可以自动调整它们。但是当一个句子里面有一个句子而另一个只有两个词时，字体大小就会如此不同......我需要异步重新计算大小（例如创建一些像 OnTextChange 这样的事件）。块内的文本动态变化。如何写一个函数？我想传递 3 个参数：文本、字体（字体系列 + 字体样式）和文本块大小，并返回适合的字体大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:25:20.297

确定合适字体大小的最佳方法是测量任意大小的文本，然后乘以它的大小与区域大小的比率。

例如，如果你测量文本并且它是它所在容器大小的一半，你可以将它乘以 2，它应该会填满容器。您想选择要使用的宽度或高度比的最小值。

在 WPF 中，FormattedText 类进行文本测量。

```
public double GetFontSize(string text, Size availableSize, Typeface typeFace)
{
    FormattedText formtxt = new FormattedText(text, CultureInfo.CurrentCulture, FlowDirection.LeftToRight, typeFace, 10, Brushes.Black);

    double ratio = Math.Min(availableSize.Width / formtxt.Width, availableSize.Height / formtxt.Height);

    return 10 * ratio;
} 
```

每当您更改 TextBlocks 的文本时，您都将使用此函数，如下所示：

```
txtBlock.FontSize = GetFontSize(txt.Text, new Size(txt.ActualWidth, txt.ActualHeight), new Typeface(txt.FontFamily, txt.FontStyle, txt.FontWeight, txt.FontStretch)); 
```

**编辑：**

出于实用性的目的，您可能希望能够使文本在此预定义的边界矩形中垂直居中。一个很好的方法是将 TextBlock 包装在另一个对象中，例如 Border 元素。通过这种方式，您可以告诉 TextBlock 在边框的中心对齐，并且可以自动调整大小以适合其内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T17:32:57.497

行。工作正常。但我还有另一个问题。我在 MainWindow.cs 中写了 2 个方法：

```
 private void fitFontSize()
    {
        propertiesList.Clear();

        TextUtils.FontProperty fontProps = new TextUtils.FontProperty();
        foreach (TextBlock tb in findVisualChildren<TextBlock>(statusOptionsGrid))
        {
            fontProps.Text = tb.Text;
            fontProps.Size = new Size(tb.ActualWidth, tb.ActualHeight);
            fontProps.FontFamily = tb.FontFamily;
            fontProps.FontStyle = tb.FontStyle;
            fontProps.FontWeight = tb.FontWeight;
            fontProps.FontStretch = tb.FontStretch;
            propertiesList.Add(fontProps);
        }

        MessageBox.Show(TextUtils.recalculateFontSize(propertiesList) + "");
    }

    public IEnumerable<T> findVisualChildren<T>(DependencyObject depObj) where T : DependencyObject
    {
        if (depObj != null)
        {
            for (int i = 0; i < VisualTreeHelper.GetChildrenCount(depObj); i++)
            {
                DependencyObject child = VisualTreeHelper.GetChild(depObj, i);
                if (child != null && child is T)
                {
                    yield return (T)child;
                }

                foreach (T childOfChild in findVisualChildren<T>(child))
                {
                    yield return childOfChild;
                }
            }
        }
    } 
```

之后，我创建了一个用于文本处理的新类。这是代码：

```
public class TextUtils
{
    public class FontProperty
    {
        public FontFamily FontFamily { get; set; }
        public FontStyle FontStyle { get; set; }
        public FontWeight FontWeight { get; set; }
        public FontStretch FontStretch { get; set; }
        public string Text { get; set; }
        public Size Size { get; set; }

        public Typeface getTypeFace()
        {
            return new Typeface(FontFamily, FontStyle, FontWeight, FontStretch);
        }
    }

    public static double recalculateFontSize(List<FontProperty> propertiesList)
    {
        List<double> fontSizes = new List<double>();
        foreach (FontProperty fp in propertiesList)
        {
            fontSizes.Add(getFontSizeForControl(fp));
        }

        return fontSizes.Min<double>();
    }

    private static double getFontSizeForControl(FontProperty fp)
    {
        string text = fp.Text;
        Size availableSize = fp.Size;
        Typeface typeFace = fp.getTypeFace();

        FormattedText formtxt = new FormattedText(text, CultureInfo.CurrentCulture, FlowDirection.LeftToRight, typeFace, 10, Brushes.Black);
        double ratio = Math.Min(availableSize.Width / formtxt.Width, availableSize.Height / formtxt.Height);

        return 10 * ratio;
    }
} 
```

代码看起来很糟糕，但我稍后会更正它......

行。现在我想创建一个新的计时器，它每秒检查一次字体大小。当我尝试在其中使用 fitFontSize() 方法时，我得到消息：“调用线程无法访问此对象，因为不同的线程拥有它。” 如何做到这一点以避免这样的问题？我尝试（只是尝试）创建调用此方法的新线程。但是 findVisualChildren<>() 方法也有同样的问题——它在 fitFontSize() 中调用。我没有任何想法如何解决我的问题...

# php - 这个 php/mysql 代码是什么意思。连接、LIKE 和连接

> ID：10853915
> 
> 赞同：-3
> 
> 时间：2012-06-01T16:18:04.013
> 
> 标签：php, mysql, sql-like, concat

```
$num = "1";
$result = mysql_query("SELECT * FROM perp_users WHERE concat(activate) LIKE '$num'"); 
```

只需要一个简单的解释

我知道它从从表中选择的 sql 中检索结果，然后我会感到困惑。

请解释谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T16:21:27.350

此代码段从表中提取所有列`perp_users`，其中列`activate`类似于“1”；

大概可以改写为：

```
SELECT *
FROM perp_users
WHERE activate = '$num'; 
```

[`CONCAT()`](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_concat)将列连接成一个结果，但由于您只在一列上使用它，因此没有必要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:24:52.217

在这种用法中，`concat(activate)`与 相同`activate`。该[`concat()`函数](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_concat)连接字符串，通常与多个参数一起使用，例如

```
...  concat (str1, str2, str3, str4, str5) ... 
```

[`LIKE`运算符](http://dev.mysql.com/doc/refman/5.1/en/string-comparison-functions.html#operator_like)进行字符串比较，这比直接`=`;更轻松。它还允许使用简单的通配符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:28:34.250

[LIKE 运算符用于搜索列中的指定模式。](http://www.w3schools.com/sql/sql_like.asp)它最常与通配符一起使用。

`concat`是连接，或连接两列的结果。在这种情况下，它什么也没做，因为它只发送了一列。通常它会发送多个参数来一起联系，即。`concat (col1, col2, col3)`.

完整查询是从表`perp_users`中选择`activate`与模式匹配的所有列`$num`。在这种情况下，`concat()`和`LIKE`都是不必要的。

# c# - Ioc 中繁忙的构造函数——它们是代码异味吗？

> ID：10853920
> 
> 赞同：3
> 
> 时间：2012-06-01T16:18:23.660
> 
> 标签：c#, .net, design-patterns, constructor, inversion-of-control

我最终得到了一个看起来像这样的构造函数，同时试图得到一个我可以轻松测试的对象。

```
 public UserProvider(
            IFactory<IContainer> containerFactory,
            IRepositoryFactory<IUserRepository> userRepositoryFactory,
            IFactory<IRoleProvider> roleProviderFactory,
            IFactory<IAuthenticationProvider> authenticationProviderFactory,
            IFactory<IEmailAdapter> emailAdapterFactory,
            IFactory<IGuidAdapter> guidAdapterFactory,
            IRepositoryFactory<IVehicleRepository> vehicleRepositoryFactory,
            IRepositoryFactory<IUserVehicleRepository> userVehicleRepositoryFactory,
            IFactory<IDateTimeAdapter> dateTimeAdapterFactory) 
```

这是对象将拥有的所有依赖项，也是我拥有的最繁忙的构造函数。但是，如果有人看到这个，它真的会引起很大的 wtf 吗？

我的目标是最终得到易于测试的逻辑。虽然它需要大量的模拟，但验证我的逻辑当然很容易。但是我担心我可能会得到太多的好东西。

我很好奇这对于大多数实施 ioc 的人来说是否正常。

我可以做一些简化——比如我真的不需要为几个适配器传递工厂，因为我可以直接传递适配器，因为它没有内部状态。但我真的是在询问参数的数量。

或者更重要的是，我正在寻找我不会过火的保证；）

但是我开始得到这样的印象，即 UserProvider 类应该被分解一下——但后来我得到了更多的管道，这就是导致这种担忧的原因。

我想一个子问题是，如果我有这些顾虑，我是否应该考虑使用服务定位器模式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T16:30:00.123

当使用 DI 和 SRP 的构造函数注入违规变得非常明显。这确实是一件好事，而不是 DI/IOC 的错。如果您不使用构造函数注入，则该类将具有相同的依赖项，只是不那么可见。

您可以在具体示例中做的是将一些相关的依赖项隐藏在外观后面。例如 IVehicleRepository 和 IUserVehicleRepository 可以隐藏在 IVehicle 外观后面。将 IUserRepository、IRoleProvider 和 IAuthenticationProvider 放在外观后面可能也很有意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T16:46:03.460

在我看来，构造函数有很多参数。以下是我将如何处理此问题以获得良好的可测试性并减少“代码异味”。

1.  无需传入工厂来创建类的实例，只需传入类本身即可。这会自动将您的依赖关系减半，因为 UserProvider 不会关心创建它需要的任何对象（并在必要时随后处理它们）它只会使用给它的东西而不是使用它需要创建对象的工厂它需要的实例。
2.  从构造函数中移除你的适配器，然后在 UserProvider 中创建这些接口的实例。例如，考虑一下您需要多久更改一次格式化 guid 的方式。只要您的适配器没有很多依赖项，这仍然是可测试的。

我要说的是在可测试性和实用性之间取得良好的平衡。在实现 Ioc 时，请尝试确定您过去在可测试性方面遇到的问题，以及您在维护和更改代码时遇到的问题，因为依赖项太多。那是您将看到最大好处的地方。

# .net - 为什么在我向窗体添加控件后 Visual C++ 设计器无法工作？

> ID：10853922
> 
> 赞同：2
> 
> 时间：2012-06-01T16:18:25.887
> 
> 标签：.net, winforms, visual-studio-2008, visual-c++

我想在面板中打开双缓冲，但我们可以`DoubleBuffered`打开属性的唯一方法是创建一个继承自的新类`System::Windows::Form::Panel`，如下所示：

```
#include "stdafx.h"

public ref class CPPIConfig: public System::Windows::Forms::Panel
{
public: CPPIConfig()
        {
            this->DoubleBuffered = true;
        }
}; 
```

我们的表格现在看起来像这样：

```
#pragma once
#using <system.drawing.dll>
#include "CPPIConfig.h"

[...]

public ref class C3_User_Interface : public System::Windows::Forms::Form
    {
      [...]
      public: CPPIConfig^ pPPI;
      [...]
    }

void InitializeComponent(void)
    {
        [...]
        this->pPPI = (gcnew CPPIConfig());
        [...]
    }
[...] 
```

它构建并运行，没问题。但是，当我现在尝试在设计模式下查看表单时，出现以下错误：

> **C++ CodeDOM 解析器错误：行：144，列：15 --- 未知类型“CPPIConfig”。**请确保引用了包含此类型的程序集。如果此类型是您的开发项目的一部分，请确保该项目已成功构建。

我的问题：

1.  为什么设计模式不起作用，即使代码构建并运行？我已经尝试了几个干净的构建，但这看起来不是问题。
2.  有没有一种方法可以`DoubleBuffered`在`true`不使用此方法的情况下进行设置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T20:58:29.963

这里最大的问题实际上源于我对托管代码和非托管代码的混合。我去[MSDN 阅读更多关于它](http://social.msdn.microsoft.com/Forums/en-US/xnagamestudioexpress/thread/effcca73-b4f2-4a74-91e3-cb92d2008a29)的信息，但结果是：**Visual Studio 无法`CPPIConfig`在此上下文中处理我的类，因为它是非托管/本机代码。**

从为[类似问题](https://stackoverflow.com/questions/4256037/is-it-possible-to-reference-a-user-control-in-the-same-windowsforms-project)提供的答案中：

> Windows 窗体设计器无法反映混合模式 EXE。确保使用 /clr:pure 编译或将任何需要设计时支持的类（例如表单上的组件和控件）移动到类库项目中。

[正如此 MSDN 页面所指出的](http://msdn.microsoft.com/en-us/library/y0114hz2%28v=vs.80%29.aspx)，反射是设计视图用于在 IDE 中呈现表单的内容。简而言之，这就是反射：

> 反射允许在运行时检查已知的数据类型。反射允许枚举给定程序集中的数据类型，并且可以发现给定类或值类型的成员。无论该类型在编译时是否已知或引用，这都是正确的。这使得反射成为开发和代码管理工具的有用功能。

啊。这开始有意义了。

据我所知，有两种方法可以解决这个问题。

**`/clr:pure`在您的项目属性中使用。**这会更改项目的公共语言运行时支持。从[这个 MSDN 页面：](http://msdn.microsoft.com/en-us/library/85344whh%28v=vs.80%29.aspx)

> 纯程序集（使用 /clr:pure 编译）可以包含本机和托管数据类型，但只能包含托管函数。与混合程序集一样，纯程序集允许通过 P/Invoke 与本机 DLL 进行互操作（请参阅在 C++ 中使用显式 PInvoke（DllImport 属性）），但 C++ 互操作功能不可用。此外，纯程序集无法导出可从本机函数调用的函数，因为纯程序集中的入口点使用 __clrcall 调用约定。

**创建一个类库项目。**正如另一个答案所建议的那样，如果我将文件移动到类库项目并以这种方式引用它，我不会看到这个问题。据我了解，它将`CPPIConfig`生成托管代码。

最终，结构限制使这些选项都不可行，并且为了时间的利益，我们决定暂时放弃面板上的双缓冲。哦，好吧，至少我对这个环境有了更多的了解！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-16T15:34:59.613

尝试将控件初始化移动到suspendlayout下方。这允许设计者正确呈现而不会出现 CodeDOM 解析错误。

原来是这样的

```
#pragma region Windows Form Designer generated code
/// <summary>
/// Required method for Designer support - do not modify
/// the contents of this method with the code editor.
/// </summary>
void InitializeComponent(void)
{
    this->lblMessage = (gcnew System::Windows::Forms::Label());
    this->SuspendLayout();
    // lblMessage
    this->lblMessage->Location = System::Drawing::Point(12, 230);
    //.....
} 
```

新格式

```
#pragma region Windows Form Designer generated code
/// <summary>
/// Required method for Designer support - do not modify
/// the contents of this method with the code editor.
/// </summary>
void InitializeComponent(void)
{
    this->SuspendLayout();
    // lblMessage
    this->lblMessage = (gcnew System::Windows::Forms::Label());
    this->lblMessage->Location = System::Drawing::Point(12, 230);
    //.....
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:30:39.653

如果你用谷歌搜索你的错误信息，你会发现很多命中：

```
C++ CodeDOM parser error:  Unknown type 'CPPIConfig' 
```

*   [http://connect.microsoft.com/VisualStudio/feedback/details/362608/designer-fails-to-load-a-valid-form-mess-up-with-dependencies-assemblies-unknown-type-during-onmethodpopulatestatements](http://connect.microsoft.com/VisualStudio/feedback/details/362608/designer-fails-to-load-a-valid-form-mess-up-with-dependencies-assemblies-unknown-type-during-onmethodpopulatestatements)

*   [是否可以在同一个 Windows::Forms 项目中引用用户控件？](https://stackoverflow.com/questions/4256037/is-it-possible-to-reference-a-user-control-in-the-same-windowsforms-project)

*   [http://social.msdn.microsoft.com/Forums/en/winformsdesigner/thread/b22d22fd-e746-450e-b783-f6e0cdfe7665](http://social.msdn.microsoft.com/Forums/en/winformsdesigner/thread/b22d22fd-e746-450e-b783-f6e0cdfe7665)

*   [http://connect.microsoft.com/VisualStudio/feedback/details/108994/visual-studio-net-designer-internal-error-form-wont-load-or-display](http://connect.microsoft.com/VisualStudio/feedback/details/108994/visual-studio-net-designer-internal-error-form-wont-load-or-display)

如果有任何帮助，请回帖！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-26T00:28:20.037

我也有一个从 Panel 继承的类。就我而言，我已将此工具箱项放置在其自己的 C# 项目中，并具有自己的命名空间。由于未知的原因，设计者在第一次实现时工作，然后在我尝试在第二个文件中使用继承的类后中断。

为了修复它，我更改了 C# 项目的命名空间以匹配使用项目的命名空间，并在设计器代码中明确指定它：

`Project1::InheritedPanel^`

而不是简单地

`InheritedPanel^`

# windows - 使用 Perl 在 Windows 中输入和读取文件时出现问题

> ID：10853923
> 
> 赞同：1
> 
> 时间：2012-06-01T16:18:31.203
> 
> 标签：windows, perl, file, input, io

我正在尝试读取与 Perl 脚本位于同一目录中的文件作为输入，并使用 Perl 在 Windows 中读取该文件。

代码：

```
$inputFile =  getcwd . "/" . <STDIN>;
open (FILE, chomp($inputFile)) or die "Cannot open $inputFile: $!\n";   
@lines = <FILE>;
print "@lines\n"; 
```

我得到的错误是：

```
C:/Documents and Settings/username/workspace/test.pl  No such file or directory 
```

即使该文件确实以该确切目录中的确切形式存在。我还尝试将“文档和设置”放在引号中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T16:22:51.260

from 的返回值`chomp`不是 chomped 值。排除`chomp`之前的因素`open`，你应该没问题。

顺便说一句，这`getcwd`是不必要的；当前目录的概念意味着在没有完整路径的情况下查找的位置。

# jquery - Jquery .hasClass 问题

> ID：10853924
> 
> 赞同：0
> 
> 时间：2012-06-01T16:18:37.663
> 
> 标签：jquery

如果一个类有一个特定的类名，我需要运行一个脚本。

我使用超大插件，如果 Slide-0 是 activeslide 并且如果它不是 activeslide 我不希望它运行脚本，我想运行这个 javascript。

我使用的js代码如下。如果没有 If 语句，它可以正常工作，但如果使用 If 语句，它就不起作用。

任何帮助是极大的赞赏。

```
<script type="text/javascript">
    if ($("#supersized .slide-0").hasClass('activeslide'))
{$(function() {
            var $tf_bg              = $('#tf_bg'),
                $tf_bg_images       = $tf_bg.find('img'),
                $tf_bg_img          = $tf_bg_images.eq(0),
                $tf_thumbs          = $('#tf_thumbs'),
                total               = $tf_bg_images.length,
                current             = 0,
                $tf_content_wrapper = $('#tf_content_wrapper'),
                $down           = $('#down'),

                $tf_loading         = $('#tf_loading');

            //preload the images                
            $tf_bg_images.preload({
                onComplete  : function(){
                    $tf_loading.hide();
                    init();
                }
            });

            //shows the first image and initializes events
            function init(){
                //get dimentions for the image, based on the windows size
                var dim = getImageDim($tf_bg_img);
                //set the returned values and show the image
                $tf_bg_img.css({
                    width   : dim.width,
                    height  : dim.height,
                    left    : dim.left,
                    top     : dim.top
                }).fadeIn();

                //resizing the window resizes the $tf_bg_img
            $(window).bind('resize',function(){
                var dim = getImageDim($tf_bg_img);
                $tf_bg_img.css({
                    width   : dim.width,
                    height  : dim.height,
                    left    : dim.left,
                    top     : dim.top
                });
            });

                //click the arrow down, scrolls down
                $down.bind('click',function(){
                    if($tf_bg_img.is(':animated'))
                        return false;
                        scroll('tb');
                });

            }

            //show next / prev image
            function scroll(dir){
                //if dir is "tb" (top -> bottom) increment current, 
                //else if "bt" decrement it
                current = (dir == 'tb')?current + 1:current - 1;

                //we want a circular slideshow, 
                //so we need to check the limits of current
                if(current == total) current = 0;
                else if(current < 0) current = total - 1;

                //we get the next image
                var $tf_bg_img_next = $tf_bg_images.eq(current),
                    //its dimentions
                    dim             = getImageDim($tf_bg_img_next),
                    //the top should be one that makes the image out of the viewport
                    //the image should be positioned up or down depending on the direction
                        top = (dir == 'tb')?$(window).height() + 'px':-parseFloat(dim.height,10) + 'px';

                //set the returned values and show the next image   
                    $tf_bg_img_next.css({
                        width   : dim.width,
                        height  : dim.height,
                        left    : dim.left,
                        top     : top
                    }).show();

                //now slide it to the viewport
                    $tf_bg_img_next.stop().animate({
                        top     : dim.top
                    },1000);

                //we want the old image to slide in the same direction, out of the viewport
                    var slideTo = (dir == 'tb')?-$tf_bg_img.height() + 'px':$(window).height() + 'px';
                    $tf_bg_img.stop().animate({
                        top     : slideTo
                    },1000,function(){
                    //hide it
                        $(this).hide();
                    //the $tf_bg_img is now the shown image
                        $tf_bg_img  = $tf_bg_img_next;
                    //show the description for the new image
                        $tf_content_wrapper.children()
                                           .eq(current)
                                           .show();
            });
                //hide the current description  
                    $tf_content_wrapper.children(':visible')
                                       .hide()

            }

            //animate the image to fit in the viewport
            function resize($img){
                var w_w = $(window).width(),
                    w_h = $(window).height(),
                    i_w = $img.width(),
                    i_h = $img.height(),
                    r_i = i_h / i_w,
                    new_w,new_h;

                if(i_w > i_h){
                    new_w   = w_w;
                    new_h   = w_w * r_i;

                    if(new_h > w_h){
                        new_h   = w_h;
                        new_w   = w_h / r_i;
                    }
                }   
                else{
                    new_h   = w_w * r_i;
                    new_w   = w_w;
                }

                $img.animate({
                    width   : new_w + 'px',
                    height  : new_h + 'px',
                    top     : '0px',
                    left    : '0px'
                },350);
            }

            //get dimentions of the image, 
            //in order to make it full size and centered
            function getImageDim($img){
                var w_w = $(window).width(),
                    w_h = $(window).height(),
                    r_w = w_h / w_w,
                    i_w = $img.width(),
                    i_h = $img.height(),
                    r_i = i_h / i_w,
                    new_w,new_h,
                    new_left,new_top;

                if(r_w > r_i){
                    new_h   = w_h;
                    new_w   = w_h / r_i;
                }
                else{
                    new_h   = w_w * r_i;
                    new_w   = w_w;
                }

                return {
                    width   : new_w + 'px',
                    height  : new_h + 'px',
                    left    : (w_w - new_w) / 2 + 'px',
                    top     : (w_h - new_h) / 2 + 'px'
                };
                }

        });

}   
 </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:30:35.433

很可能在 if 语句的时候，jQuery 还没有准备好。试着把它放在 ready 函数中`$(function(){ if... })`

# entity-framework - 如何让一个实体从另一个基础实体继承并使用 TPC 和 EF 4.2 映射到 db？

> ID：10853932
> 
> 赞同：0
> 
> 时间：2012-06-01T16:18:58.357
> 
> 标签：entity-framework, inheritance, entity-framework-4, table-per-type, entity-framework-4.2

假设我有一个 Activity 的实体模型聚合，如下所示：

```
public class Activity : Entity
{
    public int PersonId { get; set; }
    public virtual Person Person { get; set; }
    public int Number { get; set; }
    public string Title { get; set; }
    public string Content { get; set; }
    public virtual ICollection<ActivityTag> Tags { get; set; }
}

public class ActivityTag : Entity
{
    public int ActivityPersonId { get; set; }
    public int ActivityNumber { get; set; }
    public virtual Activity Activity { get; set; }
    public int Number { get; set; }
    public string Text { get; set; }
} 
```

忘记 Activity 和 Person 之间的关系，但请注意 Activity 和 ActivityTag 之间的 1..* 关系。流畅的映射看起来或多或少像这样：

```
public class ActivityOrm : EntityTypeConfiguration<Activity>
{
    public ActivityOrm()
    {
        ToTable("Activity", "Activities");
        HasKey(p => new { p.PersonId, p.Number });
        HasRequired(d => d.Person)
            .WithMany()
            .HasForeignKey(d => d.PersonId)
            .WillCascadeOnDelete(true);
        HasMany(p => p.Tags)
            .WithRequired(d => d.Activity)
            .HasForeignKey(d => new { d.ActivityPersonId, d.ActivityNumber })
            .WillCascadeOnDelete(true);
        Property(p => p.Content).HasColumnType("ntext");
    }
}

public class ActivityTagOrm : EntityTypeConfiguration<ActivityTag>
{
    public ActivityTagOrm()
    {
        ToTable("ActivityTag", "Activities");
        HasKey(p => new { p.ActivityPersonId, p.ActivityNumber, p.Number });
        Property(p => p.Text).IsRequired().HasMaxLength(500);
    }
} 
```

鉴于此，我想为`Activity`实体引入一个新的集合属性：

```
public ICollection<DraftedTag> DraftedTags { get; set; } 
```

该`DraftedTag`实体应具有与`ActivityTag`. 唯一应该不同的是它映射到的表。我尝试创建一个从 ActivityTag 派生的类，如下所示：

```
public class DraftedTag : ActivityTag
{
}

public class DraftedTagOrm : EntityTypeConfiguration<DraftedTag>
{
    public DraftedTagOrm()
    {
        Map(m =>
        {
            m.MapInheritedProperties();
            m.ToTable("DraftedTag", "Activities");
        });
        HasKey(p => new { p.ActivityPersonId, p.ActivityNumber, p.Number });

    }
} 
```

DraftedTagOrm 已添加到 modelBuilder.Configurations 集合中，但甚至没有将外键关联添加到 Activity，我得到以下异常：

> 属性“ActivityPersonId”不是“DraftedTag”类型的声明属性。使用 Ignore 方法或 NotMappedAttribute 数据注释验证该属性是否已从模型中显式排除。确保它是有效的原始属性。

当我将 ActivityTag 类和 ActivityTagOrm 构造函数中的代码完全复制到各自的 DraftTag 类/配置构造函数中时，它会按预期工作——我得到两个具有相同架构但名称不同的不同表。但是，每次我想对 ActivityTag 类进行更改时，我都必须在 DraftTag 类中进行相应的更改。

是否可以通过让 DraftTag 扩展 ActivityTag 来使此代码干燥？如果是这样，DraftTag 的 EntityTypeConfiguration 会是什么样子？

# html - 使用 Rails 进行敏捷 Web 开发示例在文本上显示图像

> ID：10853933
> 
> 赞同：0
> 
> 时间：2012-06-01T16:19:02.820
> 
> 标签：html, css, ruby-on-rails

我正在读一本书（*Agile Web Development With Rails*），我在第 96 页遇到了问题。

我完全坚持书中的代码，但我明白了。

> [![渲染输出](../Images/5c3a55269c0d23206b787ee763087252.png)](https://i.stack.imgur.com/gpWXy.png)

我知道解决此问题的另一种方法是使用表格，但我想先知道是否有其他解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:39:44.987

使图像高于文本的是您的 CSS规则`position: absolute;`。`img`查看[帮助](http://www.w3schools.com/Css/css_positioning.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:57:02.640

我会使用 div 来组织这些评论。第一个容纳图像和评论的 div。容纳图像的第二个 div。第三个是评论。

的HTML：

```
<div class="comment-container">

  <div class="comment-img">
    <!whatever code you use to pull images from the database>
  </div><!ENDcomment-img>

  <div class="comment-field">
    <!whatever code you use to pull comment content from the database>
  </div><!ENDcomment-field>

</div><!ENDcomment-container> 
```

CSS：

```
 .comment-container{
     padding: 5px; 
     border-bottom: 1px dashed #009fe4; 
     margin: 2px 0 5px 0;
  }

 .comment-img{
     float: left;
     width: 80px;
     height: auto;
  }

 .comment-field{
     width: 700px;
     height: auto;
     padding: 0 0 0 10px;
  } 
```

我希望这会有所帮助。

@subm0ral

# jquery - 在这个用于在悬停时切换类的 Jquery 脚本中，如何为重复实例简化它

> ID：10853934
> 
> 赞同：0
> 
> 时间：2012-06-01T16:19:04.167
> 
> 标签：jquery

我需要为页面上的多个元素复制此功能，我可以通过重复该功能并更改类名来实现它，但是有没有更简单的方法来组合多个实例或更改类名？在样式表中，当链接滚动时，我会为每个图像的标题设置动画。

功能：

```
 $("a.link1").hover(function() {
  $(".img1, .img1over").toggleClass("img1 img1over");
});
$("a.link2").hover(function() {
  $(".img2, .img2over").toggleClass("img2 img2over");
}); 
```

的HTML：

```
<div id="nav">
<ul>
<li><a href="#" class="link1">link1</a></li>
<li><a href="#" class="link2">link2</a></li>

</ul>
</div>

            <div class="main">
                <div class="grid img1">
                    <img src="1.jpg" />
                    <div class="mask">
                        <h2>title</h2>
                    </div>
                    </div>

                    <div class="grid img2">
                    <img src="1.jpg" />
                    <div class="mask">
                        <h2>title</h2>
                    </div>
                    </div>

        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:35:30.370

首先，您需要一个用于所有链接的通用类来简化您的代码。

的HTML

```
<div id="nav">
<ul>
    <li><a href="#" class="link" id="link1">link1</a></li>
    <li><a href="#" class="link" id="link2">link2</a></li>
</ul>
</div>
<div class="main">
                <div class="grid img1">
                    <img src="1.jpg" />
                    <div class="mask">
                        <h2>title</h2>
                    </div>
                    </div>

                    <div class="grid img2">
                    <img src="1.jpg" />
                    <div class="mask">
                        <h2>title</h2>
                    </div>
                 </div>
 </div> 
```

功能

```
$('.link').hover(function() {
    var id = $(this)[0].id.substring(4);
    $(".img"+id).toggleClass("img"+id+" img"+id+"over");
}); 
```

现在您可以使用链接类和 id link+number 来创建任意数量的链接，它们将引用相应的 img+number。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:31:43.990

如果您使某些类/ID组合对应，那么您可以编写一次：

```
<a href="#" id="link1" class="hover-link">yep</a>
....
<div id="link1-container">
...
<img src="" class="link-image" />
...
</div> 

$('.hover-link').hover(function(e){
   var $this = $(this),
       baseId = $this.attr('id'),
       $img = $('#'+baseId+'-container .link-image');

       if($img.length > 0) {
          $img.toggleClass('the-class-name');
       }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:33:28.723

我可能会这样：

```
$("#nav a").hover(function() {
    var num = $(this).attr('class').replace('link', '');
    // OR
    // var num = parseInt($(this).attr('class'), 10);

    $(".img" + num).toggleClass("img" + num + "over");
});​ 
```

我知道您也在切换`img`课程，但我建议您改写您的 css。您也可以关闭父级的索引，`<li/>`而不是清除类名

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T16:53:25.003

这确实是一个奇怪的案例，但如果你想坚持你的 HTML 和这样做的方式 - 我会为此制作一个简单的插件。

[http://jsfiddle.net/hkdobrev/8NS89/1/](http://jsfiddle.net/hkdobrev/8NS89/1/)

```
$.fn.toggleHoverClass = function( selector1, selector2 ){
    return this.hover(function(){
        var index = $( this ).parent().index() + 1,
            class1 = selector1 + index,
            class2 = class1 + selector2;
        $( '.' + class1 + ', .' + class2 ).toggleClass(class1 + ' ' + class2);
    });
};

$(function(){
    $( '#nav' ).find( 'a.link' ).toggleHoverClass( 'img', 'over' );
}); 
```

​如果有任何问题，请在评论中提问：）

# git - 改变分支基地

> ID：10853935
> 
> 赞同：233
> 
> 时间：2012-06-01T16:19:10.307
> 
> 标签：git

我有一棵这样的树：

```
(commit 1) - master
                \-- (commit 2) - (commit 3) - demo
                                                \-- (commit 4) - (commit 5) - PRO 
```

我必须将 PRO 分支移到 master

```
(commit 1) - master
                |-- (commit 2) - (commit 3) - demo
                \-- (commit 4) - (commit 5) - PRO 
```

我已经尝试了`git rebase master`来自 PRO 分支，但没有任何反应。

**澄清**一下：我在 master 工作，然后我不得不做一个产品演示（`git checkout -b demo`和一些提交）。然后，我错误地从演示（`git checkout -b PRO`和一些提交）创建了另一个分支，现在我需要将 PRO 分支移动到 master 并保持 demo 完好无损。最后，demo 和 PRO 都会挂在 master 上。

* * *

## 回答 #1

> 赞同：472
> 
> 时间：2012-06-01T16:20:25.790

假设`newBase`您要将提交移到的`oldBase`分支是您分支的旧基础，您可以使用[`--onto`](https://git-scm.com/docs/git-rebase#git-rebase---ontoltnewbasegt)它：

```
git rebase --onto newBase oldBase feature/branch 
```

鉴于您的情况：

```
git checkout PRO # Just to be clear which branch to be on.
git rebase --onto master demo PRO 
```

基本上，您从 after`demo`到包括的所有提交`PRO`，并将它们重新定位到`master`提交。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2018-03-08T20:16:53.557

我会尽量做到通用。首先，确保您在所需的分支上：

```
git checkout current-branch 
```

然后使用以下命令（`new-base-branch`您想成为新基地的分支在哪里，并且`current-base-branch`是您当前基地的分支。）

```
git rebase --onto new-base-branch current-base-branch 
```

**如果你没有冲突，那就太好了——你已经完成了。如果您这样做（在大多数情况下），请继续阅读。**

可能会出现冲突，您必须手动解决它们。Git 现在尝试在您的`current-branch`,`current-base-branch`和`new-base-branch`. 大致上这就是 git 在内部的工作方式：

1.  Git 将首先`current-base-branch`在`new-base-branch`. 可能会有冲突；您必须手动解决。完成后，您通常会执行`git add .`and `git rebase --continue`。它将`temp-commit-hash`为此创建一个新的临时提交。

2.  在此之后，Git 现在将`current-branch`在`temp-commit-hash`. 可能会有进一步的冲突，您将不得不再次手动解决它们。完成后，您再次使用`git add .`and继续`git rebase --continue`，之后您成功地重新定位`current-branch`在`new-base-branch`.

* * *

**注意：**如果你开始搞砸了，那么你可以`git rebase --abort`在 rebase 过程中的任何时候做，然后回到起点。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2017-09-28T04:41:05.343

签出到`PRO`分支，复制此分支的最旧 ( *commit4* ) 和最新 ( *commit5* ) 提交哈希并粘贴到其他位置：

```
$ git checkout PRO
$ git log            # see the commit history
# copy the oldest & latest commit-hash 
```

删除`PRO`分支（为安全起见保留备份）。从以下位置创建并签出新`PRO`分支`master`：

```
$ git branch PRO.bac    # create a new branch PRO.bac = PRO as backup

$ git checkout master
$ git branch -D PRO     # delete the local PRO branch
$ git checkout -b PRO   # create and checkout to a new 'PRO' branch from 'master' 
```

将（*cherry-pick*）Previous 分支的提交范围`PRO`带入新`PRO`分支：

```
$ git cherry-pick commit4^..commit5   # cherry-pick range of commits
# note the '^' after commit4 
```

现在，如果一切正常，则强制 (-f) 推送到`remote PRO`分支并删除本地`PRO.bac`分支：

```
$ git log                  # check the commit history

$ git push -f origin HEAD  # replace the remote PRO by local PRO branch history
# git branch -D PRO.bac    # delete local PRO.bac branch 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-25T20:55:26.203

我使用 reset 和 stash 的方法略有不同，可以避免删除和重新创建分支以及消除切换分支的需要：

```
$ git checkout PRO
$ git reset commit4 # This will set PROs HEAD to be at commit 4, and leave the modified commit 5 files in ur working index
$ git stash save -m "Commit message"
$ git reset commit3
$ git stash save -m "Commit message"
$ git reset master --hard
$ git stash pop
$ git stash pop
$ git push --force # force if its already been push remotely 
```

通过在逐个提交的基础上重置分支，您基本上只是一次倒回该分支历史提交。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-07T12:43:18.297

我知道这个问题已经很老了，但如果它对某人有帮助，请分享。

我的情况相同，我从不同的基础分支提出 PR，并且更改基础分支和变基显示 200 多个文件冲突。

即使解决它也显示了我不想要的旧提交。所以我所做的是

1.  从本地删除分支
2.  创建具有相同名称的新分支，确保这次选择正确的基础分支
3.  Cherry-pick commit id 如果你有的话

最后在命令下运行

```
git push origin +branchName:branchName 
```

在上面，您也可以`-f`使用`+`. 上面的命令使我的分支处于一种状态，而不会影响我的拉取请求。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2021-11-12T17:32:30.090

```
git branch --set-upstream-to another_branch 
```

# sql - 合并SQL中的两行以适合一列字段

> ID：10853937
> 
> 赞同：0
> 
> 时间：2012-06-01T16:19:28.653
> 
> 标签：sql

我在一张桌子上有 2 行

```
Device_ID    Other_ID
========     ========
633          1
232          2
242          2 
```

我需要以下结果：

```
Device_ID    Other_ID
========     ========
633          1
232          2 
```

这如何在 SQL 中完成？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:20:34.800

```
SELECT min(Device_ID) AS Device_ID, Other_ID
FROM   tbl
GROUP  BY Other_ID
ORDER  BY Other_ID; 
```

# ruby-on-rails - Hartl 第 5 章。第 5.27 节

> ID：10853943
> 
> 赞同：0
> 
> 时间：2012-06-01T16:19:47.210
> 
> 标签：ruby-on-rails, rspec

我目前正在通过 Hartl 工作。在第 5 章中，我将清单 5.27（如下）中的 Hartl 代码添加到我的 spec/requests/static_pages_spec.rb

```
require 'spec_helper'

describe "Static pages" do

subject { page }

describe "Home page" do
before { visit root_path }

it { should have_selector('h1',    text: 'Sample App') }
it { should have_selector('title', text: full_title('')) }
it { should_not have_selector 'title', text: '| Home' }
end

describe "Help page" do
before { visit help_path }

it { should have_selector('h1',    text: 'Help') }
it { should have_selector('title', text: full_title('Help')) }
end

describe "About page" do
before { visit about_path }

it { should have_selector('h1',    text: 'About') }
it { should have_selector('title', text: full_title('About Us')) }
end

describe "Contact page" do
before { visit contact_path }

it { should have_selector('h1',    text: 'Contact') }
it { should have_selector('title', text: full_title('Contact')) }
end
end 
```

当我运行 $ bundle exec rspec spec/requests/static_pages_spec.rb 测试时，终端返回此错误：

```
Failures:

1) Static pages Home page 
 Failure/Error: it { should have_selector('title', text: full_title('')) }
 NoMethodError:
   undefined method `full_title' for #<RSpec::Core::ExampleGroup::Nested_1::Nested_1:0x007fb4b44504c8>
 # ./spec/requests/static_pages_spec.rb:11:in `block (3 levels) in <top (required)>'

2) Static pages Help page 
 Failure/Error: it { should have_selector('title', text: full_title('Help')) }
 NoMethodError:
   undefined method `full_title' for #<RSpec::Core::ExampleGroup::Nested_1::Nested_2:0x007fb4b46a9008>
 # ./spec/requests/static_pages_spec.rb:19:in `block (3 levels) in <top (required)>'

3) Static pages About page 
 Failure/Error: it { should have_selector('title', text: full_title('About Us')) }
 NoMethodError:
   undefined method `full_title' for #<RSpec::Core::ExampleGroup::Nested_1::Nested_3:0x007fb4b4430290>
 # ./spec/requests/static_pages_spec.rb:26:in `block (3 levels) in <top (required)>'

4) Static pages Contact page 
 Failure/Error: it { should have_selector('title', text: full_title('Contact')) }
 NoMethodError:
   undefined method `full_title' for #<RSpec::Core::ExampleGroup::Nested_1::Nested_4:0x007fb4b40e57e8>
 # ./spec/requests/static_pages_spec.rb:33:in `block (3 levels) in <top (required)>'

Finished in 0.21306 seconds
9 examples, 4 failures

Failed examples:

rspec ./spec/requests/static_pages_spec.rb:11 # Static pages Home page 
rspec ./spec/requests/static_pages_spec.rb:19 # Static pages Help page 
rspec ./spec/requests/static_pages_spec.rb:26 # Static pages About page 
rspec ./spec/requests/static_pages_spec.rb:33 # Static pages Contact page 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-25T06:08:27.220

您好，我还关注了 Michael 的 Rails 3.2 版本教程并得到了同样的错误......试试你当前版本的水豚

我将**:text**更改为**:content**并让它工作，所以它看起来像这样：

```
it { should have_selector('title', content: full_title('')) } 
```

希望有帮助，加油！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:43:14.470

你的 spec_helper.rb 文件中有这一行吗？

```
Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f} 
```

你有一个看起来像这样的 spec/support/utilities.rb 文件吗？

```
include ApplicationHelper

def sign_in(user)
  visit signin_path
  fill_in "Email",    with: user.email
  fill_in "Password", with: user.password
  click_button "Sign in"
  # Sign in when not using Capybara as well.
  cookies[:remember_token] = user.remember_token
end 
```

你有一个看起来像这样的 app/helpers/application_helper.rb 文件吗？

```
module ApplicationHelper

  # Returns the full title on a per-page basis.
  def full_title(page_title)
    base_title = "Ruby on Rails Tutorial Sample App"
    if page_title.empty?
      base_title
    else
      "#{base_title} | #{page_title}"
    end
  end
end 
```

如果是这样，我认为您的错误应该消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T19:57:20.043

第 5 章的练习内容为

> "通过为原始辅助方法编写测试来**消除对**清单 5.26 中 full_title 测试帮助器的需要，如清单 5.37 所示。（您必须同时创建 spec/helpers 目录和`application_helper_spec.rb`文件。）然后将其包含到测试中使用清单 5.38 中的代码。”

[http://ruby.railstutorial.org/chapters/filling-in-the-layout.html#sec-layout_exercises](http://ruby.railstutorial.org/chapters/filling-in-the-layout.html#sec-layout_exercises)

这是否意味着我只需要“包含 ApplicationHelper”我的`utilites.rb`文件，因为`spec/helpers/application_helper_spec.rb`现在包含

```
require 'spec_helper'

describe ApplicationHelper do

  describe "full_title" do
    it "should include the page title" do
      full_title("foo").should =~ /foo/
    end 
```

进行此设置后，我在运行 RSpec 测试时仍然遇到错误。他们唯一能让我通过的方法是`full_title`在`utilites.rb`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-16T15:49:01.050

考虑到这篇文章已经有两年了，我想你已经明白了。不过，尝试添加

```
RSpec.configure do |config|
...
config.include ApplicationHelper
...
end 
```

在 spec\requests\spec_helper.rb 中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-06T00:58:40.433

当前格式应如下所示，以便您的测试通过：

```
it { should have_title(full_title('Help')) }

it { should have_title(full_title('About')) }

it { should have_title(full_title('Contact')) } 
```

# freemarker - freemarker中的正则表达式检查字符串中的第一个字符是否为小写

> ID：10853946
> 
> 赞同：-1
> 
> 时间：2012-06-01T16:19:58.287
> 
> 标签：freemarker

我正在使用 freemarker 生成一个 Java 类。我坚持将字符串的第一个字符转换为小写。

以下是我尝试过的，但没有运气:(

```
 <#function methodName attName > 
      <#if attName?length &gt; 1 >
        <#if  attrName(0)?matches([a-z])>
          <#return attName>
       </#if>  
      </#if>
    </#function> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:21:19.550

尝试 uncap_first：

```
${"Test"?uncap_first} yields test 
```

# javascript - 具有多个颜色区域的 Google Chart Gauge

> ID：10853954
> 
> 赞同：3
> 
> 时间：2012-06-01T16:20:24.160
> 
> 标签：javascript, google-visualization, gauge

我正在使用**Google Charts API**创建仪表图。它是一个非常简单有效的 API，可以即时创建图表。

这是该图表的文档

[https://google-developers.appspot.com/chart/interactive/docs/gallery/gauge](https://google-developers.appspot.com/chart/interactive/docs/gallery/gauge)

现在，我需要自定义这个图表的一点点，而不是添加一个绿色区域。例如，我需要一个从 0 到 10、一个从 20 到 30、另一个从 40 到 50 的绿色区域，但这似乎不可能。

这是传递给**draw()**方法以设置绿色区域的选项

```
var options = {          
greenFrom: 0, greenTo: 10          
}; 
```

我试图将数组作为选项传递，但它显然不起作用。这是我尝试过的。

```
var options = {          
greenFrom: [0, 20, 40], greenTo: [10, 30, 50]
}; 
```

有没有人遇到同样的问题？

需要任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T16:51:42.160

您可以这样做，只需覆盖红色和黄色区域的颜色即可。如果你也想要这些，那么你就不走运了。

```
var options = {
   greenFrom: 0,
   greenTo: 10,
   greenColor: "#00ff00",
   redFrom: 20,
   redTo: 30,
   redColor: "#00ff00",
   yellowFrom: 40,
   yellowTo: 50,
   yellowColor: "#00ff00"
} 
```

# gitorious - 在 gitorious 中，是否可以将存储库移动到不同的项目？

> ID：10853957
> 
> 赞同：3
> 
> 时间：2012-06-01T16:20:27.443
> 
> 标签：gitorious

我们有一堆小项目，它们在 Gitorious 中有一个存储库。这些存储库中的大多数都是真正相关的。如果在原创中加入了远见，这些都将在同一个项目下创建。

既然所有这些蔓延，有没有办法保持存储库（或至少它们的历史）完整，但将它们分组到一个新项目下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T08:13:02.013

gitorious 中没有这样的移动选项。我知道的唯一方法是在目标项目中创建一个新的存储库，然后将代码推送到这个存储库。之后，您可以删除存储库。注意：移动存储库将更新关联的 URL。这将需要将新 URL 与任何本地克隆进行协调。

# .net - WPF DataGrid 获取所有 SelectedRows

> ID：10853963
> 
> 赞同：2
> 
> 时间：2012-06-01T16:20:46.160
> 
> 标签：.net, wpf, datagrid, rows, selected

我的这个项目必须使用免费的 WPF DataGrid（我认为 Infragistics 库很糟糕，我在此之后将其收回）。

看起来 DataGrid 没有干净的 MVVM 友好方式来获取 selectedRows 列表？

我可以绑定数据，`SelectedItem="{Binding SelectedSourceFile}"`但这仅显示第一个选定的行。需要能够获取所有选定的行。

有什么提示可以通过 MVVM 干净地做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:36:38.247

您可以使用我为此类情况创建的解决方法，它允许您`OneWayToSource`为只读依赖项属性执行绑定。我称之为`PushBinding`。

我在这里发表了一篇关于它的博客文章：[OneWayToSource Binding for ReadOnly Dependency Property](http://meleak.wordpress.com/2011/08/28/onewaytosource-binding-for-readonly-dependency-property/)

要绑定`SelectedItems`，你可以这样做

```
<DataGrid ItemsSource="{Binding ...}">
    <pb:PushBindingManager.PushBindings>
        <pb:PushBinding TargetProperty="SelectedItems" Path="MySelectedItems"/>
    </pb:PushBindingManager.PushBindings>
</DataGrid> 
```

以及 ViewModel 中的属性

```
public IList MySelectedItems
{
    get;
    set;
} 
```

如果您有兴趣，可以使用`PushBinding`此处下载演示项目：[PushBindingInStyleDemo.zip](http://dl.dropbox.com/u/39657172/Blog/PushBindingInStyleDemo.zip)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:41:36.073

这里有[一篇博客文章](http://blog.functionalfun.net/2009/02/how-to-databind-to-selecteditems.html)描述了如何对 SelectedItems 属性进行双向绑定。该示例使用一个 ListBox，但应该与 DataGrid 一样工作，因为它们都派生自 MultiSelector。

博客文章有可下载的示例代码。

# unix - Unix脚本替换多个文件中的字符串并以另一个名称保存

> ID：10853967
> 
> 赞同：2
> 
> 时间：2012-06-01T16:20:54.993
> 
> 标签：unix, batch-file, sed, replace

我正在尝试构建一个使用“sed”执行以下操作的脚本：

*   在当前目录及其下的所有目录中搜索以 .config 结尾的文件（即：test.js.config）。
*   用另一个字符串替换一个字符串（即：{TEST} -> 50）
*   将结果保存在末尾没有 .config 的新文件中（例如：test.js）
*   删除原来的.config文件（即：test.js.config）

如果它能够使用另一个具有“要搜索的字符串”和“要替换的字符串”的文件，那就太好了，比如字典：

> {测试} = 50
> 
> {FIRST_NAME} = 亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:26:05.983

您可以将一堆 sed`s///`命令放在一个文件中：

```
$ cat change.sed 
s/{TEST}/50/g
s/{FIRST_NAME}/Alex/g 
```

如果您有以下配置输入： $ cat test.js.config alert({TEST}) alert({FIRST_NAME})

结果将是：

```
$ sed -f change.sed test.js.config > test.js
$ cat test.js
alert(50)
alert(Alex) 
```

语法不是很好，但也不可怕:)

OTOH，如果您真的想在替换文件中使用括号语法...

```
$ cat test.js.config 
alert({TEST})
alert({FIRST_NAME}) 
```

...以及替换文件中的键值对...

```
$ cat change.txt 
TEST=50
FIRST_NAME=Alex 
```

...您可以编写一个 sed 命令来更改 sed 替换中的键值对...

```
$ sed 's#\(.*\)=\(.*\)#s/{\1}/\2/g#' change.txt
s/{TEST}/50/g
s/{FIRST_NAME}/Alex/g 
```

...并在实际替换中使用此命令：

```
$ sed "$(sed 's#\(.*\)=\(.*\)#s/{\1}/\2/g#' change.txt)" test.js.config > test.js
$ cat test.js
alert(50)
alert(Alex) 
```

# c# - 返回 IEnumerable 的 Linfu 动态代理和接口方法 I am using Linfu to generate a proxy object for an interface. Everything works fine except when calling a method that returns an IEnumerable I get an error something lik 问问题 问问题 2012-06-01T16:21:02.910 477 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I am using Linfu to generate a proxy object for an interface. Everything works fine except when calling a method that returns an IEnumerable I get an error something like this: Unable to cast object of type '< IEnumerableRpcCall >d__2' to type 'System.Collections.Generic.IEnumerable`1[System.String]'. FYI: IEnumerableRpcCall is the name of the method inside the interceptor code that does yield return object rather than return object. It seems the problem is that linfu is returning a pointer to the method rather than an IEnumerable. Has anyone found a workaround for this? The problem seems to be related to casting up from IEnumerable< object > to IEnumerable< string > (or whatever type). I solved it by wrapping my enumerator logic inside a custom class that implements IEnumerable<t>: public class MyEnumerator <t>: IEnumerable<t>, IEnumerable { // custom logic here } and then in my interceptor code I use reflection to instantiate the correct generic type as specified in the InvocationInfo object: private class MyLinfuInterceptor : IInterceptor { public object Intercept(InvocationInfo info) { MethodInfo methodBeingRequested = info.TargetMethod; // enumerable return type if (methodBeingRequested.ReturnType.IsGenericType && methodBeingRequested.ReturnType.GetGenericTypeDefinition() == typeof(IEnumerable<>) && methodBeingRequested.ReturnType.GetGenericArguments().Length == 1) { Type constructedEnumerator = typeof(MyEnumerator<>).MakeGenericType(methodBeingRequested.ReturnType.GetGenericArguments()); var result = Activator.CreateInstance(constructedEnumerator); return result; } // code to handle other return types here... } } And now the proxy object for my interface no longer throws an invalid cast exception when I make method calls that return IEnumerable<> (more on writing LinFu Dynamic Proxy interceptors here) c#interfaceienumerablelinfu-dynamicproxy 4 1 回答 1 This answer is useful 0 问题似乎与从IEnumerable< object >to IEnumerable< string >（或任何类型）转换有关。我通过将枚举器逻辑包装在实现的自定义类中来解决它IEnumerable<t>： public class MyEnumerator <t>: IEnumerable<t>, IEnumerable { // custom logic here } 然后在我的拦截器代码中，我使用反射来实例化 InvocationInfo 对象中指定的正确泛型类型： private class MyLinfuInterceptor : IInterceptor { public object Intercept(InvocationInfo info) { MethodInfo methodBeingRequested = info.TargetMethod; // enumerable return type if (methodBeingRequested.ReturnType.IsGenericType && methodBeingRequested.ReturnType.GetGenericTypeDefinition() == typeof(IEnumerable<>) && methodBeingRequested.ReturnType.GetGenericArguments().Length == 1) { Type constructedEnumerator = typeof(MyEnumerator<>).MakeGenericType(methodBeingRequested.ReturnType.GetGenericArguments()); var result = Activator.CreateInstance(constructedEnumerator); return result; } // code to handle other return types here... } } 现在，当我进行返回的方法调用时，我的接口的代理对象不再抛出无效的强制转换异常IEnumerable<> （更多关于在这里编写 LinFu 动态代理拦截器） 于 2012-06-04T11:40:01.250 回答 Related 4 regex - 正则表达式：如何在单词之间找到破折号 1 python - 动态检测分部未来进口 1 c++ - 有没有办法在容器中存储不同的函数指针类型 2 sql - sqlite查询命令查找所有以大写字母开头的条目 2 php - 需要关闭会话的数据库连接 1 bluetooth - 无法加载 chan_mobile 星号 1 imagemagick - 无法使用 Paperclip / ImageMagick 修剪图像 1 api - 如何在foursquare中获取特定用户的最后一次签到？ 1 c# - 如何在 Excel 自动化中获得“列跨度”效果 3 string - 如何将字符串列表转换为方案中的一个字符串？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10853969
> 
> 赞同：0
> 
> 时间：
> 
> 标签：c#, interface, ienumerable, linfu-dynamicproxy

I am using Linfu to generate a proxy object for an interface. Everything works fine except when calling a method that returns an `IEnumerable<object>` I get an error something like this:

> Unable to cast object of type '< IEnumerableRpcCall >d__2' to type 'System.Collections.Generic.IEnumerable`1[System.String]'.

FYI: `IEnumerableRpcCall` is the name of the method inside the interceptor code that does `yield return object` rather than `return object`.

It seems the problem is that linfu is returning a pointer to the method rather than an `IEnumerable`. Has anyone found a workaround for this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T11:40:01.250

问题似乎与从`IEnumerable< object >`to `IEnumerable< string >`（或任何类型）转换有关。我通过将枚举器逻辑包装在实现的自定义类中来解决它`IEnumerable<T>`：

```
 public class MyEnumerator<T> : IEnumerable<T>, IEnumerable
  {
        // custom logic here
  } 
```

然后在我的拦截器代码中，我使用反射来实例化 InvocationInfo 对象中指定的正确泛型类型：

```
 private class MyLinfuInterceptor : IInterceptor
  {
      public object Intercept(InvocationInfo info)
      {
            MethodInfo methodBeingRequested = info.TargetMethod;
            // enumerable return type
            if (methodBeingRequested.ReturnType.IsGenericType
               && methodBeingRequested.ReturnType.GetGenericTypeDefinition() == typeof(IEnumerable<>)
               && methodBeingRequested.ReturnType.GetGenericArguments().Length == 1)
            {
               Type constructedEnumerator = typeof(MyEnumerator<>).MakeGenericType(methodBeingRequested.ReturnType.GetGenericArguments());
               var result = Activator.CreateInstance(constructedEnumerator);

               return result;
            }

            // code to handle other return types here...
       }
   } 
```

现在，当我进行返回的方法调用时，我的接口的代理对象不再抛出无效的强制转换异常`IEnumerable<>`

（[更多关于在这里编写 LinFu 动态代理拦截器](http://www.codeproject.com/Articles/20884/Introducing-the-LinFu-Framework-Part-I-LinFu-Dynam)）</t></t></t></t></t></t>

# java - JAXB 对象工厂不包含 JAXBElement 创建方法

> ID：10853972
> 
> 赞同：3
> 
> 时间：2012-06-01T16:21:25.393
> 
> 标签：java, jakarta-ee, jaxb

我有一个名为 MYClass 的类，其代码如下

```
package com.rest;

public class MyClass {

    private String var;

    public String getVar() {
        return var;
    }

    public void setVar(String var) {
        this.var = var;
    }
} 
```

我已经使用 schemagen ../src/com/rest/MyClass.java Generated Schema 创建了它的模式：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<xs:schema version="1.0" xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:complexType name="myClass">
    <xs:sequence>
      <xs:element name="var" type="xs:string" minOccurs="0"/>
    </xs:sequence>
  </xs:complexType>
</xs:schema> 
```

然后，我使用模式创建了 JAXB 工件

```
xjc -d <my_source_dir>\ -p com.rest.generated <my_generated_schema>.xsd 
```

生成的工件代码如下

对象工厂：

```
//
// This file was generated by the JavaTM Architecture for XML Binding(JAXB) Reference Implementation, vJAXB 2.1.10 in JDK 6 
// See <a href="http://java.sun.com/xml/jaxb">http://java.sun.com/xml/jaxb</a> 
// Any modifications to this file will be lost upon recompilation of the source schema. 
// Generated on: 2012.06.01 at 08:56:31 PM PKT 
//

package com.rest.generated;

import javax.xml.bind.annotation.XmlRegistry;

/**
 * This object contains factory methods for each 
 * Java content interface and Java element interface 
 * generated in the com.rest.generated package. 
 * <p>An ObjectFactory allows you to programatically 
 * construct new instances of the Java representation 
 * for XML content. The Java representation of XML 
 * content can consist of schema derived interfaces 
 * and classes representing the binding of schema 
 * type definitions, element declarations and model 
 * groups.  Factory methods for each of these are 
 * provided in this class.
 * 
 */
@XmlRegistry
public class ObjectFactory {

    /**
     * Create a new ObjectFactory that can be used to create new instances of schema derived classes for package: com.rest.generated
     * 
     */
    public ObjectFactory() {
    }

    /**
     * Create an instance of {@link MyClass }
     * 
     */
    public MyClass createMyClass() {
        return new MyClass();
    }

} 
```

而 MyClass.java 是

```
//
// This file was generated by the JavaTM Architecture for XML Binding(JAXB) Reference Implementation, vJAXB 2.1.10 in JDK 6 
// See <a href="http://java.sun.com/xml/jaxb">http://java.sun.com/xml/jaxb</a> 
// Any modifications to this file will be lost upon recompilation of the source schema. 
// Generated on: 2012.06.01 at 08:56:31 PM PKT 
//

package com.rest.generated;

import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlType;

/**
 * <p>Java class for myClass complex type.
 * 
 * <p>The following schema fragment specifies the expected content contained within this class.
 * 
 * <pre>
 * &lt;complexType name="myClass">
 *   &lt;complexContent>
 *     &lt;restriction base="{http://www.w3.org/2001/XMLSchema}anyType">
 *       &lt;sequence>
 *         &lt;element name="var" type="{http://www.w3.org/2001/XMLSchema}string" minOccurs="0"/>
 *       &lt;/sequence>
 *     &lt;/restriction>
 *   &lt;/complexContent>
 * &lt;/complexType>
 * </pre>
 * 
 * 
 */
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "myClass", propOrder = {
    "var"
})
public class MyClass {

    protected String var;

    /**
     * Gets the value of the var property.
     * 
     * @return
     *     possible object is
     *     {@link String }
     *     
     */
    public String getVar() {
        return var;
    }

    /**
     * Sets the value of the var property.
     * 
     * @param value
     *     allowed object is
     *     {@link String }
     *     
     */
    public void setVar(String value) {
        this.var = value;
    }

} 
```

**问题：找不到创建 JAXBElement 的方法。我应该怎么做才能得到那个方法**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:11:09.887

这也经常导致以下异常

```
org.jboss.resteasy.plugins.providers.jaxb.JAXBMarshalException: The method createclass <package name here>.<class name here>() was not found in the object Factory!
    at org.jboss.resteasy.plugins.providers.jaxb.JAXBXmlTypeProvider.wrapInJAXBElement(JAXBXmlTypeProvider.java:175)
    at org.jboss.resteasy.plugins.providers.jaxb.JAXBXmlTypeProvider.writeTo(JAXBXmlTypeProvider.java:74)
    at org.jboss.resteasy.core.interception.MessageBodyWriterContextImpl.proceed(MessageBodyWriterContextImpl.java:117) 
```

问题在于您的架构，将其更改为具有外部标记。然后，这将生成其中包含 @XmlRootElement 注释的代码。

像这样更改架构：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<xs:schema version="1.0" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="myClass">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="var" type="xs:string" minOccurs="0"/>
    </xs:sequence>
  </xs:complexType>
  </xs:element>
</xs:schema> 
```

然后运行在这个新模式上创建 JAXB 工件的 xjc 步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T16:35:45.093

XJC 只会在必要时将字段创建为 JAXBElements，并且仅当映射需要一些无法以“正常”JavaBean 语义表示的元信息时才真正需要。

一个必要的例子是当一个字段是可空的并且 minOccurs=0 时。如果您定义这样的元素，您将获得一个 JAXBElement 作为字段类型而不是目标类型。这样您就可以区分“无”和“未提供”，这大概是您需要做的（否则您不会在模式中以这种方式定义它）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:42:02.143

如果要创建 MyClass 的实例。

```
MyClass mc = ObjectFactory.createMyClass() 
```

如果你想从你的类创建 XML，你使用一个编组器，如果你想从一个 XML 文件创建一个 MyClass 的对象，你使用一个解组器。[JEE5 文档](http://docs.oracle.com/javaee/5/tutorial/doc/bnazg.html)

# web - 如何将两个文档与单词匹配进行比较

> ID：10853981
> 
> 赞同：0
> 
> 时间：2012-06-01T16:22:06.180
> 
> 标签：web, comparison, document

我的简历是 doc 格式的。现在我也有另一种文档格式的职位描述。

有什么办法，我可以比较雇主用于简历扫描的文档以找到匹配的候选人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:24:42.490

我不太确定他们是如何做到的，但是您始终可以保存简历的文本版本，然后只需编写一个脚本即可通过正则表达式提取关键词（“不是停用词”或您明确给出的一些列表）。

# php - 返回 facebook 连接的消息，以告知用户何时点击跳过而不是允许

> ID：10853982
> 
> 赞同：0
> 
> 时间：2012-06-01T16:22:06.310
> 
> 标签：php, facebook

我将 facebook 登录放在我的网站上。当用户在询问“我的网站也希望获得许可”时单击“允许”时，一切正常。但是当用户点击“跳过”时，我需要知道这一点并将他们登录到我的网站上，而不是发布到他们的墙上。我怎样才能通过 facebook api 找到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T17:13:07.840

只需检查用户/权限连接，[https://developers.facebook.com/tools/explorer/?method=GET&path=me%2Fpermissions](https://developers.facebook.com/tools/explorer/?method=GET&path=me%2Fpermissions)

另请参阅：[使用新的 facebook javascript sdk 检查扩展权限](https://stackoverflow.com/questions/3388367/check-for-extended-permissions-with-new-facebook-javascript-sdk)

# c++ - 在 C++ 中以编程方式获取系统启动时间（Windows）

> ID：10853985
> 
> 赞同：14
> 
> 时间：2012-06-01T16:22:22.507
> 
> 标签：c++, c, windows

很简单，问题是如何使用 c/c++ 在 windows 中获得系统启动时间。

搜索这个并没有给我任何答案，我只找到了一种非常hacky的方法，它正在读取文件时间戳（不用说，我中途放弃了阅读）。

我发现的另一种方法实际上是读取 Windows 诊断记录的事件？据说这是最后一次启动时间。

有谁知道如何做到这一点（希望没有太多丑陋的黑客）？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-01T16:26:10.197

[`GetTickCount64`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724411(v=vs.85).aspx)“检索自系统启动以来经过的毫秒数。”

一旦您知道系统运行了多长时间，只需从当前时间中减去此持续时间即可确定系统何时启动。例如，使用 C++11 chrono 库（Visual C++ 2012 支持）：

```
auto uptime = std::chrono::milliseconds(GetTickCount64());
auto boot_time = std::chrono::system_clock::now() - uptime; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-01T16:49:15.727

您还可以使用[WMI](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394582%28v=vs.85%29.aspx)获取准确的启动时间。WMI 不适合胆小的人，但它会为您提供所需的东西。

有问题的信息是关于该[`Win32_OperatingSystem`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394239%28v=vs.85%29.aspx)属性下的对象的`LastBootUpTime`。[您可以使用WMI Tools](http://www.microsoft.com/en-us/download/details.aspx?id=24045)检查其他属性。

![WMI Explorer 显示属性实例](../Images/a4230f7ebb9b4f72ccc4ad6736db4f0f.png)

**编辑：** 如果您愿意，也可以从命令行获取此信息。

```
wmic OS Get LastBootUpTime 
```

作为 C# 中的示例，它看起来如下所示（[使用 C++ 相当冗长](http://msdn.microsoft.com/en-us/library/windows/desktop/aa390423%28v=vs.85%29.aspx)）：

```
static void Main(string[] args)
{      
    // Create a query for OS objects
    SelectQuery query = new SelectQuery("Win32_OperatingSystem", "Status=\"OK\"");

    // Initialize an object searcher with this query
    ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);

    string dtString;
    // Get the resulting collection and loop through it
    foreach (ManagementObject envVar in searcher.Get())
        dtString = envVar["LastBootUpTime"].ToString();
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-06-10T00:52:19.217

“系统”对象上的“系统启动时间”性能计数器是另一个来源。[它可以使用PDH Helper 方法](https://docs.microsoft.com/en-us/windows/win32/perfctrs/using-the-pdh-functions-to-consume-counter-data)以编程方式使用。但是，它对睡眠/休眠周期并不健壮，因此可能并不比`GetTickCount()`/好多少`GetTickCount64()`。

读取计数器返回一个 64 位`FILETIME`值，即自 Windows Epoch (1601-01-01 00:00:00 UTC) 以来的 100-NS 滴答数。您还可以通过读取 WMI 表来查看计数器返回的值，该表公开了用于计算此值的原始值。（使用 COM 以编程方式读取，或从 wmic 获取命令行：）

```
wmic path Win32_PerfRawData_PerfOS_System  get systemuptime 
```

该查询为我生成 132558992761256000，[对应于 UTC 时间 2021 年 1 月 23 日星期六 6:14:36 PM](https://www.epochconverter.com/ldap)。

您可以使用`PerfFormattedData`等效项来获取浮点秒数，或者从命令行中读取该秒数或`wmic`在 PowerShell 中查询计数器：

```
Get-Counter -Counter '\system\system up time' 
```

这将返回 427.0152 秒的正常运行时间。

我还实现了其他 3 个答案中的每一个，并有一些观察结果可以帮助那些试图选择一种方法的人。

**当前时间的使用`GetTickCount64`和减去**

*   最快的方法，时钟为 0.112 毫秒。
*   在其参数的 100 ns 分辨率下不会产生唯一/一致的值，因为它取决于时钟滴答。返回值都在 1/64 秒之内。
*   需要 Vista 或更新版本。如果您的应用程序/库必须支持较旧的 Windows 版本，XP 的 32 位计数器会在约 49 天后翻转并且不能用于此方法

**使用 WMI 查询`LastBootUpTime`字段`Win32_OperatingSystem`**

*   使用 COM 需要 84 毫秒，使用`wmic`命令行需要 202 毫秒。
*   生成一致的值作为`CIM_DATETIME`字符串
*   WMI 类需要 Vista 或更高版本。

**读取事件日志**

*   最慢的方法，耗时 229 ms
*   以秒为单位生成一致的值（Unix 时间）
*   适用于 Windows 2000 或更新版本。
*   [正如Jonathan Gilbert](https://stackoverflow.com/users/166815/jonathan-gilbert)在评论中指出的那样，不保证会产生结果。

**这些方法还产生了不同的时间戳：**

*   正常运行时间：1558758098843 = 2019-05-25 04:21:38 UTC（有时：37）
*   WMI：20190524222528.665400-420 = 2019-05-25 05:25:28 UTC
*   事件日志：1558693023 = 2019-05-24 10:17:03 UTC

**结论：**

事件日志方法与旧的 Windows 版本兼容，在 unix 时间产生一致的时间戳，不受睡眠/休眠周期的影响，但也是最慢的。鉴于这不太可能在循环中运行，这可能是可接受的性能影响。但是，使用这种方法仍然需要处理事件日志达到容量并删除旧消息的情况，可能使用其他选项之一作为备份。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-01-18T18:02:33.947

C++ Boost[曾经使用 WMI `LastBootUpTime`，但在 1.54 版中切换到检查系统事件日志，显然是有充分理由的：](https://www.boost.org/users/history/version_1_54_0.html)

> **ABI 中断**：更改了 Windows 中的 bootstamp 功能，以使用 EventLog 服务启动时间作为系统启动时间。以前`LastBootupTime`从 WMI 使用的时间同步和休眠不稳定，在实践中无法使用。如果您确实需要`BOOST_INTERPROCESS_BOOTSTAMP_IS_LASTBOOTUPTIME`从命令行或 detail/workaround.hpp 获取 Boost 1.54 之前的行为定义。

查看 boost/interprocess/detail/win32_api.hpp，在第 2201 行附近，该函数的`inline bool get_last_bootup_time(std::string &stamp)`实现作为示例。（如果您想匹配行号，我正在查看版本 1.60。）

以防 Boost 以某种方式死去，而我将您指向 Boost 并没有帮助（是的，对），您需要的功能主要是`ReadEventLogA`要查找的事件 ID（根据 Boost 评论“事件日志已启动”）显然`6005`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-07-23T10:11:37.067

我没有玩过这么多，但我个人认为最好的方法可能是查询“系统”进程的开始时间。在 Windows 上，内核在启动时为自己的目的分配一个进程（令人惊讶的是，快速的谷歌搜索并不能轻易地发现它的实际目的是什么，尽管我确信信息就在那里）。此进程在任务管理器中简称为“系统”，并且在当前 Windows 版本上始终具有 PID 4（显然 NT 4 和 Windows 2000 可能已使用 PID 8）。只要系统正在运行，这个进程就永远不会退出，并且在我的测试中，就其元数据而言，它的行为就像一个成熟的进程。从我的测试来看，即使是非提升用户也可以打开 PID 4 的句柄，请求`PROCESS_QUERY_LIMITED_INFORMATION`，`GetProcessTimes`，它将`lpCreationTime`使用进程启动时间的 UTC 时间戳填充 。据我所知，在系统进程运行之前，Windows 没有任何有意义的运行方式，所以这个时间戳几乎就是 Windows 启动的时间。

```
#include <iostream>
#include <iomanip>

#include <windows.h>

using namespace std;

int main()
{
    unique_ptr<remove_pointer<HANDLE>::type, decltype(&::CloseHandle)> hProcess(
        ::OpenProcess(
            PROCESS_QUERY_LIMITED_INFORMATION,
            FALSE, // bInheritHandle
            4), // dwProcessId
        ::CloseHandle);

    FILETIME creationTimeStamp, exitTimeStamp, kernelTimeUsed, userTimeUsed;
    FILETIME creationTimeStampLocal;
    SYSTEMTIME creationTimeStampSystem;

    if (::GetProcessTimes(hProcess.get(), &creationTimeStamp, &exitTimeStamp, &kernelTimeUsed, &userTimeUsed)
     && ::FileTimeToLocalFileTime(&creationTimeStamp, &creationTimeStampLocal)
     && ::FileTimeToSystemTime(&creationTimeStampLocal, &creationTimeStampSystem))
    {
        __int64 ticks =
            ((__int64)creationTimeStampLocal.dwHighDateTime) << 32 |
            creationTimeStampLocal.dwLowDateTime;

        wios saved(NULL);

        saved.copyfmt(wcout);

        wcout << setfill(L'0')
            << setw(4)
            << creationTimeStampSystem.wYear << L'-'
            << setw(2)
            << creationTimeStampSystem.wMonth << L'-'
            << creationTimeStampSystem.wDay
            << L' '
            << creationTimeStampSystem.wHour << L':'
            << creationTimeStampSystem.wMinute << L':'
            << creationTimeStampSystem.wSecond << L'.'
            << setw(7)
            << (ticks % 10000000)
            << endl;

        wcout.copyfmt(saved);
    }
} 
```

我当前启动的比较：

*   `system_clock::now() - milliseconds(GetTickCount64())`：

> 2020-07-18 17:36:41.3284297
> 2020-07-18 17:36:41.3209437
> 2020-07-18 17:36:41.3134106
> 2020-07-18 17:36:41.3225148 2020-07-18
> 453:17.
> 
> （结果因调用而异，因为`system_clock::now()`并且`::GetTickCount64()`不会在完全相同的时间运行并且没有相同的精度）

*   `wmic OS Get LastBootUpTime`

> 2020-07-18 17:36:41.512344

*   事件簿

> 没有结果，因为此时我的系统上不存在事件日志条目（最早的事件是从 7 月 23 日开始）

*   `GetProcessTimes`在 PID 4 上：

> 2020-07-18 17:36:48.0424863

这与其他方法有几秒钟的不同，但我想不出它本身有什么*问题，因为如果系统进程还没有运行，**系统是否真的启动了*？

# mysql - 两个带有计数的 select 语句 - 非常慢

> ID：10853986
> 
> 赞同：1
> 
> 时间：2012-06-01T16:22:25.047
> 
> 标签：mysql, sql

我试图获取会话日志表中的所有条目，其中会话有超过 10 个条目（即 session_id 的计数大于 10）。我现在有两个选择语句：

```
select * from log_metrics where session_id in 
( select session_id from log_metrics 
  group by session_id having count(*) > 10
) 
```

log_metrics 表相当大，大约。7,700,000 行。内部选择需要 12.88 秒并找到 178,000 个会话 ID。整个查询并没有像这样编写完成，但是当添加`limit 10`到外部选择的末尾时，它在 18 秒内`limit 100`完成，在 3 分 35 秒内完成。我尝试将限制添加到内部选择，但出现以下错误：

> 错误 1235 (42000): 这个版本的 MySQL 还不支持 'LIMIT & IN/ALL/ANY/SOME 子查询'

有没有办法重写这个查询来加快速度？我只需要从返回的 log_metrics 中获取大约 5,000 行，而不是会话 ID 的总数 178,000。

感谢您提供的任何帮助。我是 mysql 的新手，所以请原谅任何礼仪错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:44:52.333

```
select * 
from log_metrics a
inner join (select session_id from log_metrics group by session_id having count(*) > 10) b
on a.session_id = b.session_id 
```

这是一个 SQL 小提琴：[http ://sqlfiddle.com/#!2/7bed6/3](http://sqlfiddle.com/#!2/7bed6/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:43:40.227

我不知道这是否可行（我不知道您拥有什么版本的 mySQL，而且无论如何我都没有实例），但是会根据需要使用`JOIN`作品吗？

```
SELECT *
FROM log_metrics a
JOIN (SELECT session_id
      FROM log_metrics
      GROUP BY session_id
      HAVING COUNT(session_id) > 10
      LIMIT 5000) b
ON b.session_id = a.session_id 
```

您没有提到这一点，但对于未来的提问者，他需要内部查询中的语句的原因*是*`LIMIT`因为他想要（最多）5000秒，而不是日志中的总行数（可能返回 50,000 行或更多行） .*`session_id`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:27:01.473

尝试切换到`EXISTS`检查而不是`IN`子句：

```
select * from log_metrics a where EXISTS 
( select b.session_id from log_metrics b
  where a.session_id = b.session_id
  group by b.session_id having count(*) > 10
) 
```*

# python - 我可以使用哪个 django 包来构建 REST API？

> ID：10853991
> 
> 赞同：0
> 
> 时间：2012-06-01T16:22:42.977
> 
> 标签：python, django, rest

我可以使用哪个 Django 包来构建 REST API？以前我用过活塞，但似乎日子变了，人们不推荐活塞。还有其他解决方案可以帮助我吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T16:26:05.350

美味的馅饼很好：[http ://tastypieapi.org/](http://tastypieapi.org/)

但是，您可能会发现仅手动编写视图更容易。我发现使用它没有什么优势。

# facebook - 如何扩展 FB 的内置开放图形动作类型，观看？

> ID：10853993
> 
> 赞同：0
> 
> 时间：2012-06-01T16:22:55.283
> 
> 标签：facebook, facebook-opengraph, object-type

我想使用开放图来“观看实时体育比赛”。内置观看动作类型似乎只支持电视剧、电影和视频，不支持游戏匹配。

谁能告诉我如何扩展内置的手表动作类型？如果可能，请告诉我如何扩展内置对象类型？

内置游戏匹配对象类型需要疮和玩家。但实际上，直到游戏结束你才能知道盒子得分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:57:55.183

Open Graph 目前不支持扩展操作 - 相反，请尝试创建自定义观看操作和游戏（或比赛）对象。

# c# - 当组（或递归的子组）包含 ForeignSecurityPrincipal 时，GroupPrincipal.GetMembers 失败

> ID：10853995
> 
> 赞同：14
> 
> 时间：2012-06-01T16:23:02.347
> 
> 标签：c#, active-directory, directoryservices

**对于遇到同样问题的人来说，这与其说是一个问题，不如说是信息。**

出现以下错误：

```
System.DirectoryServices.AccountManagement.PrincipalOperationException: An error (87) occurred while enumerating the groups. The group's SID could not be resolved. 
at System.DirectoryServices.AccountManagement.SidList.TranslateSids(String target, IntPtr&#91;&#93; pSids) 
at System.DirectoryServices.AccountManagement.SidList.ctor(List`1 sidListByteFormat, String target, NetCred credentials) 
at System.DirectoryServices.AccountManagement.ADDNLinkedAttrSet.TranslateForeignMembers() 
```

当运行以下代码并且组或子组包含 ForeignSecurityPrincipal 时：

```
private static void GetUsersFromGroup()
{
    var groupDistinguishedName = "CN=IIS_IUSRS,CN=Builtin,DC=Domain,DC=com";
    //NB: Exception thrown during iteration of members rather than call to GetMembers.    
    using (PrincipalContext ctx = new PrincipalContext(ContextType.Domain, "Domain", "Username", "Password"))
    {
        using (GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(ctx, IdentityType.DistinguishedName, groupDistinguishedName))
        {                    
            using (var searchResults = groupPrincipal.GetMembers(true))//Occurs when false also.
            {
                foreach (UserPrincipal item in searchResults.OfType())
                {
                    Console.WriteLine("Found user: {0}", item.SamAccountName)
                }
            }
        }
    }
} 
```

***我向 Microsoft 拨打了支持电话，他们已确认这是一个问题。内部提出了一个错误，但尚未确认是否会修复此错误。***

Microsoft 建议使用以下解决方法代码，但由于对 UserPrincipal.FindByIdentity 的重复调用，它在具有大量用户的组上表现不佳。

```
class Program
{
    //"CN=IIS_IUSRS,CN=Builtin,DC=dev-sp-sandbox,DC=local"; //TODO MODIFY THIS LINE ACCORDING TO YOUR DC CONFIGURATION

    static void Main(string[] args)
    {
        if (args.Length != 1)
        {
            Console.WriteLine("Usage: ListGroupMembers \"group's DistinguishedName\"");
            Console.WriteLine("Example: ListGroupMembers \"CN=IIS_IUSRS,CN=Builtin,DC=MyDomain,DC=local\"");
            return;
        }

        string groupDistinguishedName = args[0];

        PrincipalContext ctx = new PrincipalContext(ContextType.Domain, "dev-sp-dc", "Administrator", "Corp123!");
        List<UserPrincipal> users = new List<UserPrincipal>();
        listGroupMembers(groupDistinguishedName, ctx, users);

        foreach (UserPrincipal u in users)
        {
            Console.WriteLine(u.DistinguishedName);
        }
    }

    //Recursively list the group's members which are not Foreign Security Principals
    private static void listGroupMembers(string groupDistinguishedName, PrincipalContext ctx, List<UserPrincipal> users)
    {
        DirectoryEntry group = new DirectoryEntry("LDAP://" + groupDistinguishedName);
        foreach (string dn in group.Properties["member"])
        {

            DirectoryEntry gpMemberEntry = new DirectoryEntry("LDAP://" + dn);
            System.DirectoryServices.PropertyCollection userProps = gpMemberEntry.Properties;

            object[] objCls = (userProps["objectClass"].Value) as object[];

            if (objCls.Contains("group"))
                listGroupMembers(userProps["distinguishedName"].Value as string, ctx, users);

            if (!objCls.Contains("foreignSecurityPrincipal"))
            {                    
                UserPrincipal u = UserPrincipal.FindByIdentity(ctx, IdentityType.DistinguishedName, dn);
                if(u!=null)  // u==null for any other types except users
                    users.Add(u);
            }
        }                 
    }
} 
```

可以修改上述代码以查找导致组问题的外部安全主体。

**Microsoft 提供了有关外国安全主体的以下信息：**

这是 AD 中的一类对象，它代表来自外部源的安全主体（因此是另一个林/域或下面的“特殊”帐户之一）。该类记录在这里：http: [//msdn.microsoft.com/en-us/library/cc221858](http://msdn.microsoft.com/en-us/library/cc221858(v=PROT.10).aspx) (v=PROT.10).aspx 容器记录在这里：http: [//msdn.microsoft.com/en -us/library/cc200915(v=PROT.10).aspx](http://msdn.microsoft.com/en-us/library/cc200915(v=PROT.10).aspx) FSP 不是 AD 中的真实对象，而是指向位于不同的受信任域/林中的对象的占位符（指针）。它也可以是“特殊身份”之一，这是一堆众所周知的帐户，它们也被归类为 FSP，因为它们的 SID 与域 SID 不同。例如，此处记录的匿名、经过身份验证的用户、批处理和其他几个帐户： [http://technet.microsoft.com/en-us/library/cc779144(v=WS.10).aspx](http://technet.microsoft.com/en-us/library/cc779144(v=WS.10).aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-26T01:46:49.770

当然这是一个旧线程，但可能会对某人有所帮助。我使用下面的代码块来解决问题。Principal 类公开了一个名为 StructuralObjectClass 的属性，它告诉您该主体的 AD 类是什么。我用它来确定对象是否是用户。GetMembers(true) 递归搜索相关 groupPrincipal 中的所有嵌套成员。

希望这可以帮助某人。

```
 List<UserPrincipal> members = new List<UserPrincipal>();
    foreach (var principal in groupPrincipal.GetMembers(true))
    {
        var type = principal.StructuralObjectClass;
        if (type.Contains("user"))
            members.Add((UserPrincipal)principal);
    } 
```

谢谢，R

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-08T18:42:26.833

作为替代方案，您可以使用此代码获取成员：

```
var pth = "LDAP://ex.invalid/CN=grpName,OU=Groups,OU=whatever,DC=ex,DC=invalid";
var dirEntry = new DirectoryEntry(pth);
var members = dirEntry.Invoke("Members"); //COM object
foreach (var member in (IEnumerable)members) {
    var userEntry = new DirectoryEntry(member); //member is COM object
    var sid = new SecurityIdentifier((byte[]) userEntry.InvokeGet("objectSid"), 0);
    var typ = typeof(System.Security.Principal.NTAccount);
    var account = (NTAccount)sid.Translate(typ);
    Console.WriteLine(account.Value);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T17:49:16.383

帐户管理库有许多令人痛心的缺陷，这只是众多缺陷中的另一个......

您可以做的一件稍微加快速度的事情是调整您的 LDAP 查询，以便它同时检查组成员资格和对象类型作为查询的一部分，而不是在循环中。老实说，我怀疑它会产生很大的不同。

查询的大部分灵感来自 [How to write LDAP query to test if user is a group?](https://stackoverflow.com/questions/1032351/how-to-write-ldap-query-to-test-if-user-is-member-of-a-group) .

询问： `(&(!objectClass=foreignSecurityPrincipal)(memberof=CN=YourGroup,OU=Users,DC=YourDomain,DC=com))`

注意：这是一个未经测试的查询...

如果有一种方法可以在 AccountManagement 中运行 LDAP 查询（我的另一个抱怨），那么这将结束您的麻烦，因为您可以运行查询并让 AccountManagement 从那里获取它，但是这个选项不存在......

根据个人经验，如果您坚持使用 AccountManagement，我看不到任何其他选择。您可以做的是转储 AccountManagement 并仅使用 DirectoryServices。在幕后，所有 AccountManagement 所做的就是包装 DirectoryEntry 对象，您可以编写一些帮助类来做类似的事情。

# c# - 不应该的正则表达式匹配括号

> ID：10853996
> 
> 赞同：2
> 
> 时间：2012-06-01T16:23:06.273
> 
> 标签：c#, javascript, regex, tags

输入：

> "a[href*=\"测试\"]"

我正在尝试从以下 jQuery 选择器中匹配标签名称：

```
Regex r = new Regex("^[A-z]+");
string tagName = r.Match("a[href*=\"test\"]").Value; 
```

问题是它收集了左括号，而不仅仅是 A 到 z：

> tagName = "a[href"

如果表达式中没有指定括号，它为什么要收集括号？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T16:25:32.747

这是因为这个

```
[A-z] 
```

创建从 ASCII 'A' 到 ASCII 'z' 的字符范围。Z和a之间还有字母以外的字符，其中之一就是`[`字符。改用：

```
[A-Za-z] 
```

匹配范围 from`A-Z` *和*范围 from `a-z`，但不匹配它们之间的字符。您可以查看[ASCII 表](http://www.asciitable.com/)以了解具体信息，但总结是字符（按其数字 ASCII 顺序）如下所示：

```
A, B, ..., Y, Z, [, \, ], ^, _, `, a, b, c, ..., z 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-01T16:27:29.057

你应该尝试像 regexpal 这样的工具来测试这样的东西。这是您的示例：

[http://regexpal.com/?flags=g®ex=](http://regexpal.com/?flags=g&regex=) ^%5BA-z%5D%2B&input=a%5Bhref*%3D%5C%22test%5C%22%5D

对我来说奇怪的是小写的“z”——出于某种原因，它允许括号通过。

试试这个：

```
^[^\[]+ 
```

[http://regexpal.com/?flags=g®ex=](http://regexpal.com/?flags=g&regex=) ^%5B^%5C%5B%5D%2B&input=a%5Bhref*%3D%5C%22test%5C%22%5D