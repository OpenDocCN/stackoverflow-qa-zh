# StackOverflow 问答 11039000-11039999

# sharepoint-2010 - SharePoint 工作流错误：“无法将输入查找数据转换为请求的类型”但仅在创建新项目时

> ID：11039005
> 
> 赞同：3
> 
> 时间：2012-06-14T18:17:43.737
> 
> 标签：sharepoint-2010, sharepoint-designer, lookup, sharepoint-workflow

仅供参考，我知道如何正确设置查找的更新，并且 99% 的肯定我已经正确地做到了这一点。

我知道这一点是因为当我将工作流程设置为在更改项目时自动启动时，它会完美运行。但是，当我简单地更改此设置以便它在创建新项目时自动启动时，它会取消工作流，并且我得到“强制失败：无法将输入查找数据转换为请求的类型”。如果这两个选项都被选中，那么它在创建时会失败，但只需单击项目属性上的编辑，然后“保存”即可使其工作。

工作流程在文档库上，工作方式如下；

上传后，用户从编辑属性表单的下拉列表中选择工作任务查找，然后保存项目（将其添加到文档库）。假设工作流然后查看选定的工作任务查找，并提取工作任务项具有的帐户和有效日期类型查找 ID，并将文档的相同字段设置为相同的值。

如果有帮助，这是工作流程的代码；

```
If Current Item: Parent Task is not empty
If Current Item: Sub Task is not empty
    Log Both are empty to workflow history list
    Then Set Account to Work Tasks:Account
    The Log Set Account to workflow history list
    Then Set Effective Date and Type to WorkTasks: Effective Date and Type
    The Log Set EffDateType to the workflow history list 
```

这一切都是一步完成的。我还添加了额外的步骤来测试帐户和生效日期类型字段是否已正确设置，如果没有再次设置。但是每次我在更改时运行工作流并且它工作时，它总是根据第一步（上面发布）正确设置这些字段，并将额外的检查日志记录到不需要它们的历史记录中。

例如，Integer for Tasks:Account 的查找设置为如下工作；

```
Date Source: Work Tasks (a list)
Field from Source: Account (a lookup)
Return Field as: Lookup ID (as Integer)

Find the List Item
Field: Title (from the Work Tasks list)
Value: Current Item: Parent Task (Which is a look up of the "Title" 
Field from Work Tasks List, and is set to return the Value as a LookUp Value (As Text)) 
```

生效日期和类型设置几乎相同。

所以有人有任何见解吗？我尝试将其作为模拟步骤运行，设置工作流程暂停（1 分钟），更改查找类型以防我一开始就搞砸了，但最终上述工作流程确实有效，但只有当我将其设置为“**自动开始更改（编辑）项目**“，而不是像我需要做的那样“**自动开始创建新项目”。**

哦，是的，仅供参考，我在文档库表单的工作任务和子任务字段上使用 SPServices CascadingDropDown，但老实说，我不相信这与我的问题有任何关系。

**更新：**

我与另一位开发人员交谈过，他认为这是由于工作流程发生得太快的问题，在项目为自己创建 ID 之前，它需要执行查找。他让我在我的工作流程代码的最顶部（在 If 条件之上）添加另一个“暂停工作流程”并将其设置为 1 分钟。

然后它正常工作。

缺点是我们希望标签尽可能接近项目创建。因为图书馆的视图依赖于基于帐户和生效日期和类型的分组。更令人沮丧的是，微软的暂停工作流程只允许 1 分钟或更长时间，然后用于此的计时器经常关闭，导致暂停时间更长。到目前为止，每项测试目前都显示最少 2 分钟的暂停时间。

即时填充文件的一种可能的替代解决方案是使用 Javascript 和 SPServices 对任务列表进行查找以提取帐户和生效日期类型字段然后填充，但我的 Javascript 不是很强大，我需要帮助这个。如果有人有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-01T14:05:04.223

（在问题编辑中回答。转换为社区 wiki 答案。请参阅[没有答案的问题，但问题在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 经过进一步测试，我不知道它是否是该物品的ID。我将工作流程的开始更改为等到项目中的字段更改。我将它设置为等到 ID 字段不为 0（因为您不能设置为 null），但它仍然不起作用。

```
 6/14/2012 4:13 PM Comment System Account Waiting on ID ​ 
 6/14/2012 4:13 PM Comment System Account Waiting complete on ID ​ 
 6/14/2012 4:13 PM Error System Account Coercion Failed: Unable to transform the input lookup data into the requested type. 
```

> 我也尝试过其他字段，比如文档 ID 值不为空，它会等待，记录它完成等待，然后失败。
> 
> **更新**此问题与父任务字段有关。我已经解决了这个问题，而不必等待一段时间，方法是将上面的更改设置为等到父任务字段不为空。然后它很好地完成了工作流程。
> 
> 有人知道为什么会有延迟吗？我已经解决了它，但仍然不完全理解它需要这么长时间。

主要故障已解决（因此得到了答案），关于延迟原因的剩余一点可能是一个讨论点，或者对于 SO 来说不够具体。可以在此处编辑任何进一步的说明。

# git - 回滚推送的变基

> ID：11039007
> 
> 赞同：2
> 
> 时间：2012-06-14T18:17:48.853
> 
> 标签：git, rollback, rebase

在尝试重新定位到 master 之后，我在我的分支上弄得一团糟。

在我的提交历史中，我进行了相当多的重构（重命名和移动），以及删除类。而且我不应该推送到远程存储库。（我知道，从那以后我就在踢自己）。

然而，该做的就做完了。现在，由于 rebase 重写了历史记录和提交（？）（通过 rebase 期间的冲突解决），我无法重置为更早的提交 HEAD~2 重新开始，所有提交都被重写并且提交错误。

我可以从 git 获取 HEAD~2 的快照，我有没有办法将快照合并（重新设置）回我的分支，回滚更改并重新开始？

先谢谢了！</p>

大卫

更新，从我们内部的 git 网页，我可以看到之前的提交：

```
commit  6f577850231fed07eebdacd3bc5862f84356d803
tree    8be1d60056697bc1b8d7284c4e85a6d1738ac3e2    tree | snapshot
parent  1ca61d4dd69b7be649906834d44bb7fec390153d    commit | diff 
```

我可以通过单击“快照”链接在 gz 中下载快照。但是，当我尝试这样做时：

```
git checkout -b newBranch 6f577850231fed07eebdacd3bc5862f84356d803 
```

我有：

```
fatal: reference is not a tree: 6f577850231fed07eebdacd3bc5862f84356d803 
```

如果我运行：

```
git checkout -b --force newBranch 6f577850231fed07eebdacd3bc5862f84356d803 
```

我有：

```
fatal: git checkout: updating paths is incompatible with switching branches. 
```

我猜这个提交只存在于远程存储库中？那我怎样才能在git中签出呢？

解决方案：这个 SO 答案是我的问题的解决方案：[Undoing a git rebase](https://stackoverflow.com/questions/134882/undoing-a-git-rebase)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:58:31.487

```
fatal: reference is not a tree: 6f577850231fed07eebdacd3bc5862f84356d803 
```

[OP David Zhao](https://stackoverflow.com/users/145888/david-zhao)发现不完整的 rebase 或无效的 HEAD 引用也可能触发该消息：“
Undoing [a git rebase](https://stackoverflow.com/questions/134882/undoing-a-git-rebase) ”

即，`git reset --hard HEAD@{x}`' `x`' 是在 中找到的 HEAD 引用`git reflog`。

* * *

最初的答案：子模块也会发生这种情况（这里不是这种情况）

参见“ [Git submodule head 'reference is not a tree' 错误](https://stackoverflow.com/questions/2155887/git-submodule-head-reference-is-not-a-tree-error)”：

> 有人做了一个超级项目提交，它引用了子模块 sub 中未发布的提交。

所以，如果你有子模块，你需要确保父 repo 和子模块是同步的，并获取父 repo（更新它们在你的 gitweb 页面中显示的历史）到你的*本地*repo，然后才能开始结帐任何提交.
如果该提交来自子模块，请先转到该子模块目录，然后再进行签出。

从那里，您可以将该分支合并回您已推送的分支（例如，' `master`'），创建一个*新*提交（因此无需重写历史记录），选择“ [git 命令中描述的方法之一来制作一个像另一个分支一样](https://stackoverflow.com/questions/4911794/git-command-for-making-one-branch-like-another/4912267#4912267)“。

# ruby-on-rails - 从控制器中更新类属性

> ID：11039011
> 
> 赞同：0
> 
> 时间：2012-06-14T18:18:07.353
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, controller

所以我有一系列项目，我正在迭代并单独抓取每个项目。我想更新一些项目属性的值。我曾这样尝试过：

```
 if @request.status = 'Approved'
    session[:item_ids].each do |item_id|
    item = Item.where(:id => item_id)
    item.checked_out = item.requested
    item.quantity = item.quantity - item.checked_out
    item.requested = 1
  end 
```

不幸的是，这不起作用并且一直在抛出错误：

```
undefined method `requested' for #<ActiveRecord::Relation:0x007fd01e6ae2a8> 
```

请求绝对是项目类的一个属性，所以我不知道为什么我不能更新这些值。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:21:11.033

`where`返回一个类似集合的关系对象，而不是`Item`对象。

试试这个：

```
item = Item.where(:id => item_id).first 
```

*我实际上很惊讶它没有更早地失败。*

# javascript - 如何实现页面内弹出登录对话框

> ID：11039013
> 
> 赞同：0
> 
> 时间：2012-06-14T18:18:09.370
> 
> 标签：javascript, jquery, html

我想设计一个网页登录，当单击登录按钮时，登录框会在同一页面上弹出（而不是在新窗口中），而页面本身会“禁用”。

我被困在如何开始实施这一点。我想知道这是否可以使用jquery来完成？任何建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:18:45.653

是的，您可以使用 jquery ui 对话框

[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

像那样 ：

```
 $( "#oneDiv" ).dialog({
        height: 140,
        modal: true
    }); 
```

你是 oneDiv 需要在`display:none;`，你把任何你想要的东西放进去

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:21:41.737

当然，你有很多选择。如果您对 jQuery UI 库没问题，只需使用他们的[对话框小部件](http://jqueryui.com/demos/dialog/#modal)并将 modal 选项设置为 true。

还有一些轻量级的选项，比如[jqModal](http://dev.iceburg.net/jquery/jqModal/)

# objective-c - 运行目标 C 代码时出现奇怪的错误

> ID：11039014
> 
> 赞同：0
> 
> 时间：2012-06-14T18:18:12.347
> 
> 标签：objective-c, compiler-errors

我的项目没有明显的错误，但是当我尝试运行它时出现以下错误

```
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_ConcreteScreen", referenced from:
      objc-class-ref in ViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我在 ViewController.m 中使用我的 ContactScreen 类

我尝试了@class ContactScree 和#import`"ContactScreen.h"`

在我的 ViewController 中，我使用它，因为`[ContactScreen myMethod];` 当我注释掉这一行时它工作正常，但现在它给出编译时错误:(昨天它工作正常

这是我的代码

```
#import "ViewController.h"

#import "ConcreteScreen.h"
@interface ViewController ()

@end

@implementation ViewController

-(IBAction)btnContactPress:(id)sender{
   NSLog(@"Contact Screen");

    ConcreteScreen *coontact = [[ConcreteScreen alloc]init];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:30:41.653

你很困惑`ConcreteScreen`，`ContactScreen`编译器告诉你它不知道`ConcreteScreen`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:26:14.593

确保您的 .m 文件包含在项目中。可以创建它，使用标题和所有内容，但它不会进入构建。它也需要在目标中。

# python - 当新文件添加到其文件夹或一天中的某个时间时，如何自动运行 python 文件？

> ID：11039016
> 
> 赞同：0
> 
> 时间：2012-06-14T18:18:14.717
> 
> 标签：python, file, directory

我的 python 程序需要一个统计文件并在上面做一些事情。它每天都会获得一个新的统计文件，所以我需要程序在添加新文件时自动运行。

或者它可以每天在同一时间运行。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:51:57.307

有很多可能性：

视窗：

*   使用任务计划程序以给定的时间间隔每天运行脚本。
*   使用[看门狗](http://pypi.python.org/pypi/watchdog)库监视新文件的目录并在创建新文件后立即处理它。这需要你的 python 脚本循环运行（或守护它）

Linux：

*   使用 crond 以给定的时间间隔运行脚本
*   还可以使用 watchdog 或[pyinotify](https://github.com/seb-m/pyinotify)来监视目录中的新文件...

# perl - 错误 411 长度需要，没有 POST

> ID：11039020
> 
> 赞同：1
> 
> 时间：2012-06-14T18:18:20.647
> 
> 标签：perl, soap, soaplite

下面是我在 .PL 文件中使用的代码，我觉得我创建的 ENV 可能是这里的问题，但如果我把它拿出来，我会收到证书错误。我想知道是否有任何解决 411 Length required 错误的方法。我发现人们在谈论 POST 方法，但是我没有使用 POST，感谢您的帮助。我今天陷入了 perl，我正在尽我最大的努力来获得与 Web 服务的连接。

```
#!perl -w

use SOAP::Lite;
$ENV{PERL_LWP_SSL_VERIFY_HOSTNAME}=0;

use Data::Dumper;
print Dumper(SOAP::Lite
-> proxy('mywebsite')
-> GetTicket()
-> result); 
```

这是新的有效代码，但我收到了 Authfail 错误，这是我将要处理的下一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:57:13.383

Darch 是正确的，这是我的功能齐全的工作代码，供任何未来用户查看。

```
use strict;
use warnings;

# use ../ as lib location
use File::Basename;
use FindBin qw($RealBin);
use lib dirname($RealBin);

use SOAP::Lite;
use Data::Dumper;

$ENV{PERL_LWP_SSL_VERIFY_HOSTNAME}=0;

my $URL = 'myURL';

my $NameSpace = 'myNameSpace';

# this is operation to execute, it could be TicketCreate, TicketUpdate, TicketGet, TicketSearch
# or SessionCreate. and they must to be defined in the web service.
my $Operation = 'GetTicket';

# this variable is used to store all the parameters to be included on a request in XML format, each
# operation has a determined set of mandatory and non mandatory parameters to work correctly, please
# check OTRS Admin Manual in order to get the complete list.
my $XMLData = '
<UserLogin>myUser</UserLogin>
<Password>myPassword</Password>
    <TicketID>1</TicketID>

';

# ---

# create a SOAP::Lite data structure from the provided XML data structure.
my $SOAPData = SOAP::Data
->type( 'xml' => $XMLData );

my $SOAPObject = SOAP::Lite
->uri($NameSpace)
->proxy($URL)
->$Operation($SOAPData);

# check for a fault in the soap code.
if ( $SOAPObject->fault ) {
print $SOAPObject->faultcode, " ", $SOAPObject->faultstring, "\n";
}

# otherwise print the results.
else {

# get the XML response part from the SOAP message.
my $XMLResponse = $SOAPObject->context()->transport()->proxy()->http_response()->content();

# deserialize response (convert it into a perl structure).
my $Deserialized = eval {
    SOAP::Deserializer->deserialize($XMLResponse);
};

# remove all the headers and other not needed parts of the SOAP message.
my $Body = $Deserialized->body();

# just output relevant data and no the operation name key (like TicketCreateResponse).
for my $ResponseKey ( keys %{$Body} ) {
    print Dumper( $Body->{$ResponseKey} );
}
} 
```

# ruby-on-rails - 在 Rails 中为域逻辑使用回调的优缺点

> ID：11039023
> 
> 赞同：22
> 
> 时间：2012-06-14T18:18:25.217
> 
> 标签：ruby-on-rails, mongoid

您认为将回调用于域逻辑的优缺点是什么？（我说的是 Rails 和/或 Ruby 项目的上下文。）

为了开始讨论，我想提一下[Mongoid 页面关于回调](http://mongoid.org/en/mongoid/docs/callbacks.html)的这句话：

> 对域逻辑使用回调是一种糟糕的设计实践，并且可能导致在链中的回调停止执行时难以调试的意外错误。我们建议仅将它们用于横切关注点，例如排队后台作业。

我很想听听这一说法背后的论点或辩护。它是否仅适用于 Mongo 支持的应用程序？还是打算跨数据库技术应用？

似乎[The Ruby on Rails Guide to ActiveRecord Validations and Callbacks](http://guides.rubyonrails.org/active_record_validations_callbacks.html#callbacks-overview)可能不同意，至少在关系数据库方面是这样。举个例子：

```
class Order < ActiveRecord::Base
  before_save :normalize_card_number, :if => :paid_with_card?
end 
```

在我看来，这是实现域逻辑的简单回调的完美示例。它似乎又快又有效。如果我接受 Mongoid 的建议，这个逻辑会去哪里呢？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-19T23:48:02.937

我真的很喜欢为小班使用回调。我发现它使一个类非常易读，例如

```
before_save :ensure_values_are_calculated_correctly
before_save :down_case_titles
before_save :update_cache 
```

立即清楚发生了什么。

我什至觉得这可以测试；我可以测试方法本身是否有效，并且可以分别测试每个回调。

我坚信类中的回调应该*只*用于属于该类的方面。如果您想在保存时触发事件，例如，如果对象处于某种状态时发送邮件，或者记录，我会使用[Observer](http://api.rubyonrails.org/v3.2.0/classes/ActiveRecord/Observer.html)。这尊重单一责任原则。

## 回调

### 回调的优点：

*   一切都在一个地方，所以这很容易
*   非常易读的代码

### 回调的缺点：

*   由于一切都在一个地方，因此很容易打破单一责任原则
*   可以上重课
*   如果一个回调失败会发生什么？它仍然遵循链条吗？提示：确保你的回调永远不会失败，否则将模型的状态设置为无效。

## 观察员

### 观察者的优势

*   非常干净的代码，你可以为同一个类创建多个观察者，每个观察者做不同的事情
*   观察者的执行不耦合

### 观察者的劣势

*   起初，行为的触发方式可能很奇怪（看看观察者！）

## 结论

简而言之：

*   对简单的模型相关的东西（计算值、默认值、验证）使用回调
*   使用观察者进行更多的跨领域行为（例如发送邮件、传播状态……）

和往常一样：所有建议都必须持保留态度。但根据我的经验，观察者的扩展性非常好（而且鲜为人知）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-18T20:22:07.833

**编辑：我在这里结合了一些人的建议的答案。**

## 概括

基于一些阅读和思考，我得出了一些我认为的（暂定）陈述：

1.  正如所写的那样，“对域逻辑使用回调是一种糟糕的设计实践”这句话是错误的。它夸大了这一点。回调可以是域逻辑的好地方，使用得当。问题不应该是*域*模型逻辑是否应该进入回调，而是*什么样的域逻辑*有意义。

2.  “对域逻辑使用回调......可能会导致在链停止执行中的回调时难以调试的意外错误”这一说法是正确的。

3.  是的，回调可能会导致影响其他对象的连锁反应。就无法测试的程度而言，这是一个问题。

4.  是的，您应该能够测试您的业务逻辑，而无需将对象保存到数据库中。

5.  如果一个对象的回调对于您的感受而言过于臃肿，则可以考虑其他设计，包括 (a) 观察者或 (b) 辅助类。这些可以干净地处理多对象操作。

6.  “仅将 [回调] 用于跨领域问题，例如排队后台作业”的建议很有趣，但被夸大了。（我回顾了[横切关注点](http://en.wikipedia.org/wiki/Cross-cutting_concern)，看看我是否可能忽略了某些东西。）

我还想分享我对我读过的关于这个问题的博客文章的一些反应：

## 对“ActiveRecord 的回调毁了我的生活”的反应

Mathias Meyer 2010 年的帖子[ActiveRecord 的回调毁了我的生活](http://www.paperplanes.de/2010/5/7/activerecord_callbacks_ruined_my_life.html)，提供了一种观点。他写：

> 每当我开始向 Rails 应用程序中的模型添加验证和回调时 [...] 就感觉不对劲。感觉就像我添加了不应该存在的代码，这使一切变得更加复杂，并将显式代码转换为隐式代码。

我发现最后一个声明“将显式代码转换为隐式代码”是一个不公平的期望。我们在这里谈论的是*Rails*，对吧？！如此多的附加值是关于 Rails “神奇”地做事，例如，开发人员不必明确地做这件事。享受 Rails 的成果却批评隐式代码不是很奇怪吗？

> 仅根据对象的持久性状态运行的代码。

我同意这听起来令人讨厌。

> 难以测试的代码，因为您需要保存一个对象来测试部分业务逻辑。

是的，这使测试变得缓慢而困难。

所以，总而言之，我认为 Mathias 火上浇油，但我并不觉得所有这些都令人信服。

## 对“疯狂、异端和令人敬畏：我编写 Rails 应用程序的方式”的反应

在 James Golick 2010 年的帖子[Crazy, Heretical, and Awesome: The Way I Write Rails Apps](http://jamesgolick.com/2010/3/14/crazy-heretical-and-awesome-the-way-i-write-rails-apps.html)中，他写道：

> 此外，将所有业务逻辑耦合到持久性对象可能会产生奇怪的副作用。在我们的应用程序中，当创建某些内容时，after_create 回调会在日志中生成一个条目，用于生成活动提要。如果我想在不记录的情况下创建一个对象——比如说，在控制台中？我不能。保存和记录是永远结合的。

后来，他找到了它的根源：

> 解决方案实际上非常简单。对这个问题的简单解释是我们违反了单一职责原则。因此，我们将使用标准的面向对象技术来分离模型逻辑的关注点。

我非常感谢他通过告诉您何时适用和何时不适用来缓和他的建议：

> 事实是，在一个简单的应用程序中，肥胖的持久性对象可能永远不会受到伤害。当事情变得比 CRUD 操作更复杂一点时，这些事情开始堆积起来并成为痛点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T18:30:43.180

这个问题就在这里（[忽略 rspec 中的验证失败](https://stackoverflow.com/questions/11038929/ignore-the-validation-failures-in-rspec)）是不将逻辑放在回调中的一个很好的理由：可测试性。

随着时间的推移，您的代码*可能*`unless Rails.test?`会产生许多依赖项，您开始添加到您的方法中。

我建议只在回调中保留格式化逻辑`before_validation`，并将涉及多个类的内容移到服务对象中。

因此，在您的情况下，我会将 normalize_card_number 移至 before_validation，然后您可以验证卡号是否已标准化。

但是，如果您需要在某处创建 PaymentProfile，我会在另一个服务工作流对象中执行此操作：

```
class CreatesCustomer
  def create(new_customer_object)
    return new_customer_object unless new_customer_object.valid?
    ActiveRecord::Base.transaction do
      new_customer_object.save!
      PaymentProfile.create!(new_customer_object)
    end
    new_customer_object
  end
end 
```

然后，您可以轻松测试某些条件，例如它是否无效、保存是否未发生或支付网关是否引发异常。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-18T11:07:23.530

Avdi Grimm 在他的书[Object On Rails](http://objectsonrails.com/)中有一些很好的例子。

你会在[这里](http://objectsonrails.com/#sec-13-3)和[这里](http://objectsonrails.com/#ID-31ff03d6-2838-4b44-b8fb-d4d4cbbc680e)找到为什么他不选择回调选项，以及如何通过覆盖相应的 ActiveRecord 方法来摆脱它。

在你的情况下，你最终会得到类似的东西：

```
class Order < ActiveRecord::Base

  def save(*)
    normalize_card_number if paid_with_card?
    super
  end

  private

  def normalize_card_number
    #do something and assign self.card_number = "XXX"
  end
end 
```

[在您评论“这仍然是回调”之后更新]

当我们谈到域逻辑的回调时，我理解`ActiveRecord`回调，如果您认为 Mongoid 引用者的引用指向其他内容，请纠正我，如果在某处我没有找到“回调设计”。

我认为`ActiveRecord`回调在大多数（整个？）部分只不过是我之前的示例可以摆脱的语法糖。

首先，我同意这个回调方法隐藏了它们背后的逻辑：对于不熟悉的人来说`ActiveRecord`，他必须学习它才能理解代码，使用上面的版本，它很容易理解和测试。

`ActiveRecord`对于回调他的“常见用法”或它们可以产生的“脱钩感觉”，这可能是最糟糕的。回调版本一开始可能看起来不错，但随着您将添加更多回调，将更难以理解您的代码（它们以什么顺序加载，哪个可能会停止执行流程等）并对其进行测试（您的域逻辑与`ActiveRecord`持久性逻辑相结合）。

当我阅读下面的示例时，我对这段代码感到难过，它很臭。我相信如果你在做 TDD/BDD，你可能不会得到这个代码，如果你忘记了`ActiveRecord`，我想你会简单地编写`card_number=`方法。我希望这个例子足够好，不要直接选择回调选项，先考虑设计。

关于 MongoId 的引用，我想知道为什么他们建议不要将回调用于域逻辑，而是将其用于排队后台作业。我认为排队后台作业可能是域逻辑的一部分，并且有时可能会比回调更好地设计（比方说观察者）。

最后，从面向对象编程设计的角度来看，关于如何使用 Rail 使用 / 实现 ActiveRecord 存在一些批评，这个[答案](https://softwareengineering.stackexchange.com/questions/119352/does-the-activerecord-pattern-follow-encourage-the-solid-design-principles/119354#119354)包含关于它的很好的信息，你会更容易找到。您可能还想检查 datamapper[设计模式](http://martinfowler.com/eaaCatalog/dataMapper.html)/ [ruby 实现项目](http://datamapper.org/)，它可以替代 ActiveRecord（但要好多少）并且没有他的弱点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-19T12:26:33.230

在我看来，使用回调的最佳方案是触发它的方法与回调本身中执行的内容无关。例如，一个好的`before_save :do_something`不应该执行与**保存**相关的代码。这更像是**观察者**应该如何工作。

人们倾向于只使用回调来干燥他们的代码。这还不错，但会导致代码复杂且难以维护，因为`save`如果您没有*注意到*回调被调用，读取该方法并不能告诉您它所做的一切。我认为显式代码很重要（尤其是在 Ruby 和 Rails 中，发生了如此多的魔法）。

**与保存**相关的所有内容都应该在`save`方法中。**例如，如果回调是为了确保用户经过身份验证，这与save**无关，那么这是一个很好的回调场景。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-22T18:09:17.520

我不认为答案太复杂。

**如果您打算构建具有确定性行为的系统，则处理与数据相关的事情（例如规范化）的回调是可以的，处理业务逻辑的回调（例如发送确认电子邮件）则不行**。

OOP 以紧急行为作为最佳实践[¹](http://www.artima.com/articles/dci_vision.html)得到了普及，根据我的经验，Rails 似乎同意这一点。许多人，[包括引入 MVC 的那个人](http://www.artima.com/articles/dci_vision.html)，认为这会给运行时行为是确定性且提前众所周知的应用程序带来不必要的痛苦。

如果您同意 OO 紧急行为的做法，那么将行为耦合到数据对象图的活动记录模式就没什么大不了的。如果（像我一样）你看到/感受到理解、调试和修改这些紧急系统的痛苦，你会想尽一切可能使行为更具确定性。

现在，如何设计具有松散耦合和确定性行为的适当平衡的 OO 系统？如果你知道答案，写一本书，我会买的！[DCI](http://www.artima.com/articles/dci_vision.html)、[领域驱动设计](http://en.wikipedia.org/wiki/Domain-driven_design)，以及更普遍的[GoF 模式](https://rads.stackoverflow.com/amzn/click/com/0201633612)是一个开始:-)

* * *

1.  [http://www.artima.com/articles/dci_vision.html](http://www.artima.com/articles/dci_vision.html)，“我们哪里出错了？”。不是主要来源，但与我对野外假设的一般理解和主观经验一致。

# c++ - g++：错误：“pow”没有依赖于模板参数的参数，因此“pow”的声明必须可用[-fpermissive]

> ID：11039029
> 
> 赞同：2
> 
> 时间：2012-06-14T18:19:01.860
> 
> 标签：c++, templates, casting, g++, type-conversion

此代码在 Windows 上的 Visual Studio 2010 上正确编译，但在 Linux g++ 上出现此错误。谁能解释一下如何解决这个问题？

```
int bits;
T scale;
std::vector<U> TwoPowers;
U cropper;

template <typename T, typename U>
ConvertToBits<T,U>::ConvertToBits(int bits, T scale)
{
    this->bits = bits;
    this->scale = scale;
    for(long i = 0; i < 64; i++)
    {
        TwoPowers.push_back(static_cast<U>(pow(2.,i))); //error appears here
    }
    cropper = 0;
    for(int i = 0; i < bits; i++)
    {
        cropper += TwoPowers[i];
    }
} 
```

错误信息：

错误：“pow”没有依赖于模板参数的参数，因此“pow”的声明必须可用[-fpermissive]

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:24:07.943

您需要`#include <cmath>`并在数学库中链接`-lm`（在某些系统上）。

# php - 文件更改时刷新页面上的 PHP 文件

> ID：11039031
> 
> 赞同：1
> 
> 时间：2012-06-14T18:19:18.850
> 
> 标签：php

我制作了一个非常成功的 PHP 聊天框，可以将聊天内容保存到文本文件中。我几乎完成了它，除了当用户#1 发送消息时我必须为用户#2 拥有它。我研究过 AJAX，但我没有使用任何 JavaScript，所以我认为很难将它放入我的脚本中。在出现新消息（文件已更新）之前，我不希望刷新页面或 iframe 或任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:30:07.113

如果您负担得起使用 HTML5，那么**HTML5 - WebSockets**是您项目的前进方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:24:35.320

PHP 是一种服务器端语言。您将需要使用 javascript 或类似工具从 PHP 脚本之外的浏览器进行交互。

在您的 PHP 脚本中，如果您向 User2 回显以下内容，则会导致其浏览器刷新当前页面：

```
<script>window.location.reload();</script> 
```

或者您可以执行以下操作以每隔 60 秒刷新一次页面：

```
<script>setTimeout( window.location.reload()", 60*1000 );</script> 
```

# jquery - ebay api jquery 回调时未捕获的引用错误

> ID：11039033
> 
> 赞同：1
> 
> 时间：2012-06-14T18:19:21.657
> 
> 标签：jquery, reference, callback, ebay-api

我正在开发一个简单的 eBay jQuery 插件。它成功地拨打了电话。它返回一个结果。但是，当它尝试查找我的回调函数时，我得到“未捕获的 ReferenceError：_cb_findItemsByKeywords 未定义”。

```
 (function( $ ){

    $.fn.ebay_jQuery = function( options  ) {
        var settings = $.extend({
            rootURL : "http://svcs.ebay.com/services/search/FindingService/v1",
            operationName : "findItemsByKeywords",
            serviceVersion : "1.0.0",
            securityAppName : "myApp",
            globalID : "EBAY-US",
            responseFormat : "JSON",
            callback : "_cb_findItemsByKeywords",
            keywords : "religious%20book",
            entriesPerPage : "20"
        }, options);
        var html = [];
        // Parse the response and build an HTML table to display search results
        var _cb_findItemsByKeywords = function(root) {
            var items = root.findItemsByKeywordsResponse[0].searchResult[0].item || [];

            for (var i = 0; i < items.length; ++i) {
                var item     = items[i];
                var title    = item.title;
                var pic      = item.galleryURL;
                var viewitem = item.viewItemURL;

                if (null != title && null != viewitem) {
                    html.push('<div class="box item-box" style="position: absolute; opacity: 1; top: 0px; left: 240px; ">'+
                        '<div class="item">'+
                        '<div>'+
                        '<div class="goods-pic">'+
                        '<a href="' + viewitem + '" target="_blank">' +
                        '<img src="' + pic + '" border="0">'+
                        '</a>'+
                        '</div>'+
                        '<p class="item-title" style="margin-top: 10px;">'+
                        '<a href="' + viewitem + '" target="_blank">' + title + '</a>'+
                        '</p>'+
                        '<p class="item-price-fee clearfix"><span class="sale-price"> $38.5</span>&nbsp;&nbsp;/&nbsp;&nbsp; <span class="blue">0 bids</span></p>'+
                        '<p class="clearfix"><span class="blue pull-left" style="color: #538dc2;">0 mins left</span></p>'+
                        '<p><span class="blue">Buy it now ($52.5)</span></p>'+
                        '<p><span class="pull-right">Portland, TN</span></p>'+
                        '</div>'+
                        '</div>'+
                        '</div>');
                }
            }
        }

        var constructRequest = function(){
                // Construct the request
                url = settings.rootURL;
                url += "?OPERATION-NAME="+settings.operationName;
                url += "&SERVICE-VERSION="+settings.serviceVersion;
                url += "&SECURITY-APPNAME="+settings.securityAppName;
                url += "&GLOBAL-ID="+settings.globalID;
                url += "&RESPONSE-DATA-FORMAT="+settings.responseFormat;
                url += "&callback=_cb_findItemsByKeywords";
                url += "&REST-PAYLOAD";
                url += "&keywords="+settings.keywords;
                url += "&paginationInput.entriesPerPage="+settings.entriesPerPage;
                //url += urlfilter;

                return url;
            }
            var submitRequest = function(){
                var url = constructRequest();
                // Submit the request
                s=document.createElement('script'); // create script element
                s.src= url;
                document.body.appendChild(s);
            }

          // End _cb_findItemsByKeywords() function

        return this.each(function() {

            submitRequest();
            $(this).append(html);
        });
    };
})( jQuery );

<html>
<head>
    <title>eBay Search Results</title>
    <script type="text/javascript" src="/js/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="/js/ebay_jQuery.js"></script>
    <script>
        $(document).ready(function(){
            $('#results').ebay_jQuery();
        });
    </script>
</head>
<body>
<div id="main-content">
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span12">
                <div class="item-container clearfix" id="item-container" style="position: relative; height: 1204px; ">

                    <div id="results"></div>

                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T16:19:53.207

您可以将 ebay 调用包装在 jquery ajax 调用中，响应会自动链接到方法 _cb_findItemsByKeywords 并填充根变量。

有一个示例页面：

```
<html>
<head>
<title>eBay Search Results</title>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<style type="text/css">body { font-family: arial,sans-serif;} </style>

    <script type="text/javascript">
     $(document).ready(function() {

        $("#ebay").click(function(e){

          var url = "http://svcs.ebay.com/services/search/FindingService/v1?SECURITY-APPNAME=Reddeneg-2a4d-4b23-8d37-defc1bbb868f&OPERATION-NAME=findItemsByKeywords&SERVICE-VERSION=1.0.0&RESPONSE-DATA-FORMAT=JSON&callback=_cb_findItemsByKeywords&REST-PAYLOAD&keywords=termo&paginationInput.entriesPerPage=30";

          $.ajax({
            url: url,
            dataType: "script"
            });

        });

     });

    function _cb_findItemsByKeywords(root) {
      var items = root.findItemsByKeywordsResponse[0].searchResult[0].item || [];
      var html = [];
      html.push('<table width="100%" border="0" cellspacing="0" cellpadding="3"><tbody>');

      for (var i = 0; i < items.length; ++i)   {
        var item     = items[i];
        var title    = item.title;
        var pic      = item.galleryURL;
        var viewitem = item.viewItemURL;

        if (null != title && null != viewitem) {
          html.push('<tr><td>' + '<img src="' + pic + '" border="0">' + '</td>' +
            '<td><a href="' + viewitem + '" target="_blank">' + title + '</a></td></tr>');
        }
      }
      html.push('</tbody></table>');
      document.getElementById("results").innerHTML = html.join("");
    }

    </script>

</head>
<body>
<h1>eBay Search</h1>

<a id="ebay" href="#"> run Ebay Query</a>

<div id="results"></div>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T22:30:38.023

[alejo](https://stackoverflow.com/users/1341534/alejo)提供的答案实际上是有效的，但是我会对其进行一些修改。jQuery ajax 调用支持 dataType: 'jsonp'，增加了 'callback=?' 默认到 url，并允许您将回调函数定义为 ajax 调用的成功属性。您还可以使用 data 属性来传递查询参数

```
<html>
<head>
<title>eBay Search Results</title>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<style type="text/css">body { font-family: arial,sans-serif;} </style>
<script type="text/javascript">
 $(document).ready(function() {
    $("#ebay").click(function(e){
      var url = "http://svcs.ebay.com/services/search/FindingService/v1?SECURITY-APPNAME=Reddeneg-2a4d-4b23-8d37-defc1bbb868f&OPERATION-NAME=findItemsByKeywords&SERVICE-VERSION=1.0.0&RESPONSE-DATA-FORMAT=JSON&REST-PAYLOAD&paginationInput.entriesPerPage=30";
      $.ajax({
        url: url,
        dataType: "jsonp",
        data: {keywords: 'thermo'},
        success: function(root){
            var items = root.findItemsByKeywordsResponse[0].searchResult[0].item || [];
            var html = [];
            html.push('<table width="100%" border="0" cellspacing="0" cellpadding="3"><tbody>');

            for (var i = 0; i < items.length; ++i)   {
                var item     = items[i];
                var title    = item.title;
                var pic      = item.galleryURL;
                var viewitem = item.viewItemURL;

                if (null != title && null != viewitem) {
                    html.push('<tr><td>' + '<img src="' + pic + '" border="0">' + '</td>' +
                    '<td><a href="' + viewitem + '" target="_blank">' + title + '</a></td></tr>');
                }
            }
            html.push('</tbody></table>');
            document.getElementById("results").innerHTML = html.join("");
        }
        });
    });
 });
    </script>
</head>
<body>
<h1>eBay Search</h1>
<a id="ebay" href="#"> run Ebay Query</a>
<div id="results"></div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:03:52.183

您的回调函数未在全局范围内定义，因此调用脚本无法访问它。

您需要给每个回调方法一个唯一的名称并将其添加到窗口中。

```
var uniqueName = "_cb_" + $.now();
window[uniqueName] = function (root) {
    /* your stuff */

    window[uniqueName] = null;
} 
```

然后将该唯一名称作为该脚本所需的回调 fn 传递给 ebay api。

# java - Webdriver 闪存按钮

> ID：11039035
> 
> 赞同：1
> 
> 时间：2012-06-14T18:19:23.467
> 
> 标签：java, flash, testing, selenium, webdriver

我的页面中有一个闪光按钮：

`<object type="application/x-shockwave-flash" data="/stc/uploader.swf" width="150" height="28" id="publishComponentFlash" style="visibility: visible; "><param name="bgcolor" value="#ffffff"><param name="allowscriptaccess" value="always"></object>`

我正在尝试在此按钮中使用 Webdriver（函数 click()），但它不起作用。

`WebElement btnSearch = driver.findElement(By.id("publishComponentFlash")); btnSearch.click();`

谁来帮帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:38:26.403

Selenium Web 驱动程序不支持/不与 Flash 一起使用。

# php - PHP将路径放入数组

> ID：11039041
> 
> 赞同：1
> 
> 时间：2012-06-14T18:19:52.377
> 
> 标签：php

我正在尝试使用文件路径填充数组。

```
<?php
session_start(session_id());
$galleryID = $_SESSION['newGalleryId'];
    $path_pages = '../../../../data/gallery/' . $galleryID . '/images/album/';
?>

<?php
class UploadHandler
{
    protected $options;

    function __construct($options=null) {
        $this->options = array(
            'script_url' => $this->getFullUrl().'/',
            'upload_dir' => $path_pages,
            'upload_url' => $path_pages,
            'param_name' => 'files'
}
?> 
```

我正在使用 jQuery-file-upload 将文件上传到目录。如果我在其中硬编码 $galleryID 可以正常工作，但是当我尝试插入 $variable 时它不起作用。任何想法为什么 $galleryID 会引起我的问​​题。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:21:39.910

尝试：

```
<?php
session_start();
$galleryID = $_SESSION['newGalleryId'];
$path_pages = '../../../../data/gallery/' . $galleryID . '/images/album/';
?> 
```

听起来 $_SESSION 没有开始。添加 session_start 将实例化会话并希望拉出您的变量。

**更新**

你应该像这样设置你的选项：

```
<?php
session_start(session_id());
$galleryID = $_SESSION['newGalleryId'];
    $path_pages = '../../../../data/gallery/' . $galleryID . '/images/album/';

$options = array(
            'upload_dir' => $path_pages,
            'upload_url' => $path_pages,
            'param_name' => 'files');

$upload = new UploadHelper($options);
?>

<?php
class UploadHandler
{
    protected $options;

    function __construct($options=null) {
        $this->options = array(
            'script_url' => $this->getFullUrl().'/'
             );
}
?> 
```

您的 $path_pages 对 UploadHelper 类没有任何可见性。由于类可以处理构造函数中的选项，因此在实例化类时传递选项。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-14T18:27:05.770

由于它是一个非常不完整的示例，我只能猜测：您可能不得不参考`$path_pages`使用 ether`global $path_pages;`或`$GLOBALS['path_pages']`.

# sql-server-2008 - MSSQL 2008 Express 的数据库调优顾问

> ID：11039042
> 
> 赞同：0
> 
> 时间：2012-06-14T18:19:52.503
> 
> 标签：sql-server-2008, sql-server-express, database-performance, database-tuning

有什么方法可以使用 Tuning Advisor for SQL Express？Express 是否有某种调优工具？对于那些不是 DBA 但仍想提高网站性能的人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:26:51.740

我不知道有任何免费版本的 DTA。我建议确定运行缓慢的查询，然后回到 SO，并提出有关如何提高性能的具体问题。

DTA 可能非常有用，但请注意不要成为您 100% 依赖的拐杖。如果您在这里发布一些具体问题，我怀疑您会很快掌握一些基本的性能调整概念。

# mdx - 使用 MDX 获得第一个成员

> ID：11039049
> 
> 赞同：0
> 
> 时间：2012-06-14T18:20:16.983
> 
> 标签：mdx, member

我想获取产品的到期日期，但是，产品可能有多个到期日期

```
产品编号 | 到期 | 数量
    1 2012 财年 1000
    2 2012 财年 1000
    2 2014 财年 1000
    3 2013 财年 1000
    3 2015 财年 1000
```

正如您所看到的，一个产品有多个日期，但是，我只想要第一个 ExpDate。

这是我到目前为止的查询

```
SELECT NON EMTPY
([Product].[ProductID].[ProductID].MEMBERS *
[Primary Expiration Date].[Primary Expiration Year].[Primary Expiration Year].MEMBERS) on ROWS,
NON EMTPY ([Measures].[Qty]) on columns
FROM Sales_Market
WHERE(
{[Primary Expiration Date].[Primary Expiration Date Hierarchy].[Primary Expiration Quarter].&[FY12-Q4], 
[Primary Expiration Date].[Primary Expiration Date Hierarchy].[Primary Expiration Year].&[FY13], 
[Primary Expiration Date].[Primary Expiration Date Hierarchy].[Primary Expiration Year].&[FY14], 
[Primary Expiration Date].[Primary Expiration Date Hierarchy].[Primary Expiration Year].&[FY15]}) 
```

有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T11:19:32.293

你可以试试这个查询：

```
SELECT NON EMTPY
Generate([Product].[ProductID].[ProductID].MEMBERS, Subset(NonEmpty({[Product].CurrentMember} * [Primary Expiration Date].[Primary Expiration Year].[Primary Expiration Year].MEMBERS), 0, 1)) on ROWS,
NON EMTPY ([Measures].[Qty]) on columns
FROM Sales_Market
WHERE(
{[Primary Expiration Date].[Primary Expiration Date Hierarchy].[Primary Expiration Quarter].&[FY12-Q4], 
[Primary Expiration Date].[Primary Expiration Date Hierarchy].[Primary Expiration Year].&[FY13], 
[Primary Expiration Date].[Primary Expiration Date Hierarchy].[Primary Expiration Year].&[FY14], 
[Primary Expiration Date].[Primary Expiration Date Hierarchy].[Primary Expiration Year].&[FY15]}) 
```

如有必要，您可以添加一个度量作为 NonEmpty 的第二个参数。

# linux - Bash/unix 排序“YYYY-[N]NN”

> ID：11039050
> 
> 赞同：1
> 
> 时间：2012-06-14T18:20:17.510
> 
> 标签：linux, bash, unix

我有一个这样的清单-

`2009-96 2010-100 2010-101 2010-97 2010-98 2010-99 2009-99a 2011-102`

如何按正确的顺序对数字进行排序，以便在年份不同时按前 4 位（年份）排序，否则按后面的数字排序`-`？

我想要的正确输出是 -

`2009-96 2009-99a 2010-97 2010-98 2010-99 2010-100 2010-101 2011-102`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:39:59.737

这取决于您的 版本`sort`，因为命令行选项可能不同，但在我的系统上`sort -t - -k 1,1n -k 2,2n <filename>`可以使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T18:36:42.337

使用 GNU 排序（Linux 上的标准）：

```
sort -t'-' -n 
```

`sort``\n`对行进行排序，因此请使用`tr`@dimba 的答案中所示的方式来回转换空格分隔符。

# html - Flash 视频因未知原因未显示

> ID：11039054
> 
> 赞同：0
> 
> 时间：2012-06-14T18:20:37.413
> 
> 标签：html, flash, browser

我创建了一个 Flash“介绍”（ponicawater.com）。在我的电脑和我姐姐的电脑上，它运行良好，但我收到了一些来自人们的消息，试图加载网站不成功。他们中的一些人在左上角看到一个小 Flash 播放器图标，其他人只看到第一帧，但它处于非活动状态。发生这种情况的原因可能是什么以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:11:16.650

当您将鼠标悬停在它们上方时，我看到 4 个水瓶向上移动。

我认为任何试图解决这个问题的人都需要更多细节。

这发生在什么浏览器和操作系统上？他们是否安装了当前版本的 Flash Player？我怀疑他们可能使用过时的 Flash Player。

# grails - 在选择（下拉菜单）中为布尔值设置 Grails 值

> ID：11039057
> 
> 赞同：4
> 
> 时间：2012-06-14T18:20:44.560
> 
> 标签：grails, groovy

我正在使用 Grails 框架。在我的用户控制器中，我有一个名为“活动”的布尔字段，它控制是否允许用户登录。登录操作会在用户登录时检查此值。

我的域名：

```
class User {
  Boolean active
} 
```

我的观点（edit.gsp）：

```
<g:select id="active" name="active" from="${[1,0]}" value="${userInstance?.active}" /> 
```

该值正确保存到数据库中，但我希望帐户状态下拉菜单显示“已启用”或“已禁用”，而不是像现在那样显示“1”或“0”。

它还应该在加载编辑页面时显示当前值。目前，它始终显示“1”的值，即使用户在数据库中具有“0”的值。

这似乎很容易，但我无法找到任何人在 GSP 中设置其下拉值的示例，而且到目前为止我没有尝试过任何工作。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-14T19:24:57.733

[我在文档中](http://grails.org/doc/latest/ref/Tags/select.html)看到了两种解决方案。

一个是给我们`keys`标签的参数：

```
<g:select id="active" name="active" from="${['Enabled','Disabled']}" keys="${[1,0]}" value="${userInstance?.active}" /> 
```

这提供了不同的键列表与值列表。

* * *

另一种解决方案是使用`optionKey`and/or`optionValue`参数，但这将要求列表包含对象或可用于查找值的类似内容：

在`src/groovy/BooleanSelectOption.groovy`：

```
class BooleanSelectOption {
    String name
    String value
    private BooleanSelectOption(name, value) {
        this.name = name
        this.value = value
    }
    private static List _list;
    public static List getList() {
        if(!BooleanSelectOption._list) {
            BooleanSelectOption._list = [new BooleanSelectOption('Enabled',1), new BooleanSelectOption('Disabled',2)]
        }
        BooleanSelectOption._list
    }
    public String toString() { name }
} 
```

在您看来：

```
<g:select id="active" name="active" from="${BooleanSelectOption.list}" optionKey="value" value="${userInstance?.active}" /> 
```

现在标签正在根据列表中项目的 bean 属性查找键。此外，`enum`也可能在这里工作。

* * *

显然，第一种技术对于短列表来说更简洁，但我想在更复杂的情况下展示这两种选择。我也没有测试第二个例子。

还有一点需要注意：您可能会发现这些键`0`并`1`没有真正起作用，因为`Disabled`如果值为 . 则不会被选中（根据我的经验）`false`。我不知道你是否可以使用`true`and `false`，但你应该测试以确保你得到你期望的东西。

* * *

实际上还有第三种选择，可能是最强大的解决方案，也在文档中：

使用该`valueMessagePrefix`参数允许从 i18n 消息中查找显示的值。

在`grails-app/i18n/messages.groovy`：

```
boolean.select.0=Disabled
boolean.select.1=Enabled 
```

在您看来：

```
<g:select id="active" name="active" from="${[1,0]}" value="${userInstance?.active}" valueMessagePrefix="boolean.select" /> 
```

如果您需要，这还有一个额外的好处，即允许您为不同的语言使用不同的标签。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-14T19:25:55.023

您可以为键和值使用`optionKey`和`optionValue`使用对象属性或映射值。尝试这样的事情：

```
<g:select name="active" optionKey="key" optionValue="value"
 from="${[[key: 1, value: 'Enabled'],[key: 0, value: 'Disabled']]}"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T14:06:03.550

就像这种情况下的替代方案一样，当出现比任务保证更多的处理时，记住你可以回退到普通的旧 html。例如

```
<select name="active">
 <option value="0" ${!active ? 'selected' : ''}>Disabled</option>
 <option value="1" ${active ? 'selected' : ''}>Enabled</option>
</select> 
```

# javascript - 按钮点击不会触发

> ID：11039060
> 
> 赞同：1
> 
> 时间：2012-06-14T18:21:05.760
> 
> 标签：javascript, asp.net

```
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Button ID="Button1" runat="server" Text="Button" />
        <div id="div1">Click here</div>
    </div>
    </form>

    <script type="text/javascript">
        var $ = function(e) { return document.getElementById(e); };
        var pageDefault = {
            btn1: $('Button1'),

            testfx: function() {
                alert('test');
            },

            init: function() {
                this.btn1.onclick = function() {
                    this.testfx();
                    return false;
                }
            }
        }
        pageDefault.init();
    </script>
</body> 
```

为什么button1点击事件不会触发？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:23:54.183

您可能需要使用`$('<%= Button1.ClientID %>')`而不是`$('Button1')`. 有关更多详细信息，请参阅[本文](http://weblogs.asp.net/asptest/archive/2009/01/06/asp-net-4-0-clientid-overview.aspx)。

其他答案中提到的另一个问题是事件处理程序指的`this`是`window`. 要解决这个问题，您可以通过以下方式重写您的处理程序：

```
this.btn1.onclick = function() {
    pageDefault.testfx();
    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:23:57.630

`this`在该部分代码中不在同一范围内。

试试这个

```
init: function() {
that = this // create's a that variable which refers to the current scope
this.btn1.onclick = function() {
    that.testfx(); // this now points to the scope of pageDefault
    // Same as doing pageDefault.testfx();
    return false;
} 
```

[演示](http://jsfiddle.net/rhkct/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:26:13.823

因为`this`in `this.testfx();` 不是`pageDefault.testfx()`is`Button1.testfx()`

它应该是

```
this.btn1.onclick = function() {
    pageDefault.testfx();
    return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T18:29:35.570

我认为因为 btn1 是一个 jquery 对象。所以使用这个 instade：

```
init: function() {
                this.btn1.click(function() {
                    this.testfx();
                    return false;
                });
            } 
```

# c++ - Python C头文件解析和反向初始化

> ID：11039063
> 
> 赞同：3
> 
> 时间：2012-06-14T18:21:11.267
> 
> 标签：c++, python, c, parsing, header

我对使用 Python 以递归方式解析 C 头文件（仅结构和变量声明）感兴趣。

这是我正在寻找的一个例子。假设如下：

```
typedef struct
{
   double value[3];
} vector3;

typedef struct
{
       unsigned int variable_a[4][2];
       vector3 variable_b[5];
} my_example; 
```

此外，假设有一个包含初始化值的文件，例如：

```
ANCHOR_STRUCT(my_example) = 
{
    // variable_a
    { {1,2}, {3, 4}, {5,6} ,{7,8}   },

    // variable_b
    { {1.0,2.0,3.0}, {4.0,5.0,6.0}, {7.0,8.0,9.0}, {10.0,11.0,12.0}, {13.0,14.0,15.0}  }
} 
```

我希望能够解析这两个文件并能够生成报告，例如：

```
OUTPUT:
my_example.variable_a[0][0]   = 1
my_example.variable_a[0][1]   = 2
my_example.variable_a[1][0]   = 3
my_example.variable_a[1][1]   = 4
my_example.variable_a[2][0]   = 5
my_example.variable_a[2][1]   = 6
my_example.variable_a[3][0]   = 7
my_example.variable_a[3][1]   = 8

my_example.variable_b[0].value[0] = 1
my_example.variable_b[0].value[1] = 2
my_example.variable_b[0].value[2] = 3
my_example.variable_b[1].value[0] = 4
my_example.variable_b[1].value[1] = 5
my_example.variable_b[1].value[2] = 6
my_example.variable_b[2].value[0] = 7
my_example.variable_b[2].value[1] = 8
my_example.variable_b[2].value[2] = 9
my_example.variable_b[3].value[0] = 10
my_example.variable_b[3].value[1] = 11
my_example.variable_b[3].value[2] = 12
my_example.variable_b[4].value[0] = 13
my_example.variable_b[4].value[1] = 14
my_example.variable_b[4].value[2] = 15 
```

我希望能够在不运行代码的情况下报告这一点（仅通过解析）。是否存在可以解析和打印此信息的 Python 工具。我还想打印出数据类型。

解析初始化文件中的“{”和“,”和“}”并能够将其与结构的变量和子项进行匹配似乎有点复杂。将值与正确的代号匹配似乎很困难，因为顺序非常重要。我还假设父/子/孙变量需要递归。

谢谢，内德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:34:43.457

除非您将自己限制为简单的数据类型，否则这将变得非常复杂。例如，您想处理嵌套类等任意数据类型吗？

您说您不想运行 c 源代码，但是您在这里尝试做的是构建自己的 c 解释器！你确定要重新发明轮子吗？如果是...

您需要做的第一件事是解析文件。您可以使用解析器+词典分析器，例如[PLY](http://www.dabeaz.com/ply/)。一旦你有了解析树，你就可以分析你的变量是什么以及它们的预期值是什么。

# c# - 请解释为什么我能够在 Excel VSTO 中实例化“应用程序”接口

> ID：11039064
> 
> 赞同：19
> 
> 时间：2012-06-14T18:21:20.773
> 
> 标签：c#, excel, vsto

我的应用程序中有以下 C# 代码，它工作得很好。它启动一个新的 Excel 实例。

```
private readonly Microsoft.Office.Interop.Excel.Application _application;
_application = new Microsoft.Office.Interop.Excel.Application();
_application.Visible = true; 
```

我最近才注意到[Application](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.application.aspx)是一种接口类型。到底发生了什么，怎么可能？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-14T19:17:54.543

[`CoClass`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.coclassattribute.aspx)如果接口用标识实现它们的具体类（以及 a[`ComImport`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comimportattribute.aspx)和 a ）的属性修饰，编译器允许您实例化接口[`Guid`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.guidattribute.aspx)。当您实例化接口时，您实际上将在幕后实例化这个具体的类。

此“功能”旨在用作 COM 导入类型的管道。请注意 Outlook[`Application`](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.application.aspx)接口是如何由名为 的具体类支持的[`ApplicationClass`](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.applicationclass.aspx)：

```
[GuidAttribute("00063001-0000-0000-C000-000000000046")]
[CoClassAttribute(typeof(ApplicationClass))]
public interface Application : _Application, ApplicationEvents_11_Event 
```

在大多数情况下，您不应该*将*这些属性应用于您自己的接口。但是，为了演示，我们可以证明编译器*将*允许您利用这种可能性在代码中实例化接口。考虑以下简单示例（GUID 是随机的）：

```
[ComImport]
[Guid("175EB158-B655-11E1-B477-02566188709B")]
[CoClass(typeof(Foo))]
interface IFoo
{
    string Bar();
}

class Foo : IFoo
{
    public string Bar()
    {
        return "Hello world"; 
    }
} 
```

使用上述声明，您可以创建自己的`IFoo`接口实例：

```
IFoo a = new IFoo();
Console.WriteLine(a.Bar());
// Output: "Hello world" 
```

**编辑**：虽然[jonnyGold](https://stackoverflow.com/questions/11039064/please-explain-why-i-am-able-to-instantiate-the-application-interface-in-excel/11039870#comment14438702_11039870)正确地指出 Excel[`Application`](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.application.aspx)实例没有在 MSDN 上装饰`CoClass`，但这似乎是 MSDN 的遗漏。来自程序集的反编译签名`Microsoft.Office.Interop.Excel`是：

```
[CoClass(typeof(ApplicationClass)), Guid("000208D5-0000-0000-C000-000000000046")]
[ComImport]
public interface Application : _Application, AppEvents_Event 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-14T18:55:11.717

因为[MSDN](http://msdn.microsoft.com/en-us/library/ms247302%28v=office.11%29.aspx)是这么说的：

> 例如，以下代码使用 Excel Microsoft.Office.Interop.Excel.Application 接口。在运行时，它使用 Application 类来实例化 Excel Application 对象并打开工作表。

# c# - 在 web.config 中存储复杂对象

> ID：11039065
> 
> 赞同：0
> 
> 时间：2012-06-14T18:21:21.130
> 
> 标签：c#, .net, web-config, inversion-of-control

我基本上想从全局设置存储库的地方获取 IDIctionary。我们基本上使用 IOC，我把它放在那里，但由于某些原因，它必须移到 web.config。我浏览了一些文章，最近我得到的是：

> [http://brijbhushan.net/2011/04/21/how-to-store-custom-objects-in-web-config/](http://brijbhushan.net/2011/04/21/how-to-store-custom-objects-in-web-config/)

这篇文章再次谈到以编程方式存储它。我只想要一些简单的东西，程序员可以在设计时来存储或更改我的字典，仅此而已。关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:29:05.217

web.config 文件并不是存储和反序列化对象的好地方。为此，我建议使用 XAML 文件。这更合适，由 MS 自己完成。您可以在此处获取更多信息[http://blogs.microsoft.co.il/blogs/bursteg/archive/2009/05/18/xaml-in-net-4-0-serialization-and-deserialization-using-xamlservices。 .aspx](http://blogs.microsoft.co.il/blogs/bursteg/archive/2009/05/18/xaml-in-net-4-0-serialization-and-deserialization-using-xamlservices.aspx) _

# javascript - servlet pdf 在 chrome 中作为文本出现

> ID：11039068
> 
> 赞同：0
> 
> 时间：2012-06-14T18:21:27.137
> 
> 标签：javascript, pdf, servlets

所以我有一个 servlet，其 URL 类似于 blah.do?params=xyz

在servlet中我的代码类似于

```
ServletOutputStream out = response.getOutputStream();
request.setAttribute("Content-Type","application/pdf");
request.setAttribute("Content-Disposition","attachment;filename=test.pdf");
byte[] bytes = SystemServer.getFileContents(fileId).getBytes();      
request.setAttribute("Content-Length","" + bytes.length);
out.write(bytes, 0, bytes.length);
out.flush(); 
```

我用

```
window.open(url,"my file","someparams"); 
```

但是chrome正在以纯文本形式打开窗口，并且查看源代码确认输出的所有内容都是

```
%PDF-1.4 %áéëÓ 2 0 obj  ..... all contents....%%EOF 
```

那么我怎样才能强迫它以pdf格式出现

奇怪的是我使用相同的代码将图像返回到浏览器并且它工作正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:26:00.767

您需要在响应对象而不是请求上设置这些属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:30:02.580

您正在将几件事设置为请求属性，这些属性实际上应该在响应中设置。

```
response.setContentType("application/pdf");
response.setContentLength(bytes.length);
response.addHeader("Content-Disposition","attachment;filename=test.pdf"); 
```

# javascript - 给定一个长列表，我如何随机选择 x 个元素？

> ID：11039074
> 
> 赞同：-2
> 
> 时间：2012-06-14T18:21:38.273
> 
> 标签：javascript, jquery, random, jquery-selectors

标记：

```
<ul>
<li>Bla</li>
<li>Ble</li>

...

<li>zla</li>
</ul> 
```

让我们假设它的列表真的很长，我怎么能随机选择 x 个项目？

-编辑-

不完全重复，我正在尝试选择 x 个项目；

```
something like:
var i = 0;
$("li:random").each(function(){
    i++; if(i==50) break;
}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:28:42.090

以下是如何使用 javascript[随机](http://www.w3schools.com/jsref/jsref_random.asp)函数获取此信息的快速示例：

```
$(function() {
    var randomItemsNum = 3;
    var totalItems = $('#mylist > li').length;

    for (var index = 0; index < randomItemsNum; index++) {
        var randomIndex = Math.floor((Math.random() * totalItems) + 1);
        var item = $('#mylist > li:nth-child(' + randomIndex + ')');
        if (item.hasClass('selected')) {
            index--;
            continue;
        }
        else {
            item.addClass('selected');
        }
    }
}); 
```

它将选定的 CSS 类添加到 3 个随机列表项。在此处查看工作演示 - [http://jsfiddle.net/Pharaon/PPW9J/1/](http://jsfiddle.net/Pharaon/PPW9J/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:41:17.260

```
function selectRandomFromList($list, num){
    var $children = $list.children(),
        len = $children.length,
        a = [],
        o = {},
        r,
        $items = $([]);

    if (!len) { return $items; }
    if (num >= len) { return $children; }

    // Build an array of unique indices
    while (a.length < num) {
        r = Math.floor(Math.random() * len);
        if (!o.hasOwnProperty(r)) {
            o[r] = 1;
            a.push(r);
        }
    }

    // grab the items
    while (num--) {
        $items = $items.add($children.eq(a.pop()));
    }

    return $items;
} 
```

示例用法：

```
selectRandomFromList($('ul'), 3); 
```

演示：

[http://jsfiddle.net/lbstr/d8JgP/](http://jsfiddle.net/lbstr/d8JgP/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:24:57.457

1.  在 1 和列表长度之间选择一个随机数 (r)。
2.  选择 el# % r == 0 的所有元素。

完毕。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T18:25:52.973

我认为你可以摆脱做这样的事情：

```
 var list_length = $("ul li").length;
var x; //Assign amount of items
for(var i = 0; i <= x; i++) {
   Math.floor((Math.random()*list_length));
   //Select stuff in here
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T18:26:59.670

这样做： -

```
randomList = 8;

randomElements = jQuery("li").get().sort(function(){ 
  return Math.round(Math.random())-0.5
}).slice(0,randomList);

$(randomElements).addClass("activeLI");​ 
```

## CSS

```
.activeLI {
    color: red;
}​ 
```

将 randomList 数字**8**更改为**50**或任何数字。

请参阅**[现场演示](http://jsfiddle.net/SivaCharan/qQJXg/2/)**

*从 jQuery 复制[：选择随机元素](https://stackoverflow.com/a/1764629/500725)这个答案。*

# android - 无法从 Android 上创建的 ZIP 存档中提取文件（特定于设备/操作系统）

> ID：11039079
> 
> 赞同：4
> 
> 时间：2012-06-14T18:22:08.927
> 
> 标签：android, zip, 7zip

我正在使用如下代码在 Android 上创建档案：

```
 OutputStream os = new FileOutputStream(zipFile);
    ZipOutputStream zos = new ZipOutputStream(new BufferedOutputStream(os));
    try 
    {
        zos.setLevel(8);
        byte[] buffer = new byte[32768];
        for (VFile src : toPack)            
        {
            ZipEntry entry = new ZipEntry(src.name);
            zos.putNextEntry(entry);
            src.pushToStream(zos, buffer);
            src.close();
            zos.closeEntry();
        }
    }
    finally 
    {
        zos.close();
    } 
```

我发现只有一种压缩方法可用 - `DEFLATED`（只有`STORED`另一种可用）。这意味着存档始终使用一种方法进行压缩。

如果我在 Android 2.3.4 上运行此代码 - 我可以使用 7Zip 在 Windows 中解压缩文件；如果我在 Android 3（或三星 Galaxy Tab；不确定谁做错了）上运行它 - 7Zip 显示存档列表，但无法解压缩文件说*Unsupported compression method*。同时 7Zip 将*Deflate*显示为文件的压缩方法，这意味着它可以正确处理它。

有没有人有这个问题？

谢谢。

UDP：找到另一个[有类似问题的主题](https://stackoverflow.com/questions/10070387/how-can-i-zip-a-text-using-gzipoutputstream-that-is-compatible-with-net-zip-alg)（虽然可能不一样）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T19:39:26.630

@user1269737 的回答是正确的；几乎。但它只适用于单文件档案。下面是解析整个档案的代码。

```
/**
* Replace wrong local file header byte
* http://sourceforge.net/tracker/?func=detail&aid=3477810&group_id=14481&atid=114481
* Applies to Android API 9-13
* @param zip file
* @throws IOException
*/
private static void fixInvalidZipFile(File zip) throws IOException 
{
    RandomAccessFile r = new RandomAccessFile(zip, "rw");
    try
    {
        long eocd_offset = findEOCDRecord(r);

        if (eocd_offset > 0)
        {
            r.seek(eocd_offset + 16);  // offset of first CDE in EOCD               
            long cde_offset = readInt(r);  // read offset of first Central Directory Entry
            long lfh_offset = 0;
            long fskip, dskip;

            while (true)
            {
                r.seek(cde_offset);
                if (readInt(r) != CDE_SIGNATURE)  // got off sync!
                    return;

                r.seek(cde_offset + 20);  // compressed file size offset                
                fskip = readInt(r);

                // fix the header
                //
                r.seek(lfh_offset + 7);
                short localFlagsHi = r.readByte();  // hi-order byte of local header flags (general purpose)
                r.seek(cde_offset + 9);
                short realFlagsHi = r.readByte();  // hi-order byte of central directory flags (general purpose)
                if (localFlagsHi != realFlagsHi)
                { // in latest versions this bug is fixed, so we're checking is bug exists.
                    r.seek(lfh_offset + 7);
                    r.write(realFlagsHi);
                }

                //  calculate offset of next Central Directory Entry
                //
                r.seek(cde_offset + 28);  // offset of variable CDE parts length in CDE
                dskip = 46;  // length of fixed CDE part
                dskip += readShort(r);  // file name
                dskip += readShort(r);  // extra field
                dskip += readShort(r);  // file comment

                cde_offset += dskip;
                if (cde_offset >= eocd_offset)  // finished!
                    break;              

                // calculate offset of next Local File Header
                //
                r.seek(lfh_offset + 26);  // offset of variable LFH parts length in LFH
                fskip += readShort(r);  // file name
                fskip += readShort(r);  // extra field
                fskip += 30;  // length of fixed LFH part
                fskip += 16;  // length of Data Descriptor (written after file data)

                lfh_offset += fskip;
            }
        }
    }
    finally
    {
        r.close();
    }
}

//http://www.pkware.com/documents/casestudies/APPNOTE.TXT
private static final int LFH_SIGNATURE = 0x04034b50;
private static final int DD_SIGNATURE = 0x08074b50;
private static final int CDE_SIGNATURE = 0x02014b50;
private static final int EOCD_SIGNATURE = 0x06054b50;

/** Find an offset of End Of Central Directory record in file */
private static long findEOCDRecord(RandomAccessFile f) throws IOException
{
    long result = f.length() - 22; // 22 is minimal EOCD record length
    while (result > 0)
    {
        f.seek(result);

        if (readInt(f) == EOCD_SIGNATURE) return result;

        result--;
    }
    return -1;
}

/** Read a 4-byte integer from file converting endianness. */
private static int readInt(RandomAccessFile f) throws IOException
{
    int result = 0;
    result |= f.read();
    result |= (f.read() << 8);
    result |= (f.read() << 16);
    result |= (f.read() << 24);
    return result;
}

/** Read a 2-byte integer from file converting endianness. */
private static short readShort(RandomAccessFile f) throws IOException
{
    short result = 0;
    result |= f.read();
    result |= (f.read() << 8);
    return result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T10:06:37.123

需要更新。它修复了单文件压缩包。您必须在 zip 文件 { 0, 0x08, 0x08, 0x08, 0 } 中查看以下序列并将其替换为 { 0, 0x08, 0x00, 0x08, 0 }

```
/**
* Replace wrong byte http://sourceforge.net/tracker/?func=detail&aid=3477810&group_id=14481&atid=114481
* @param zip file
* @throws IOException
*/

private static void replaceWrongZipByte(File zip) throws IOException {
    RandomAccessFile  r = new RandomAccessFile(zip, "rw");
    int flag = Integer.parseInt("00001000", 2); //wrong byte
    r.seek(7);
    int realFlags = r.read();
    if( (realFlags & flag) > 0) { // in latest versions this bug is fixed, so we're checking is bug exists.
        r.seek(7);
        flag = (~flag & 0xff);
        // removing only wrong bit, other bits remains the same.
        r.write(realFlags & flag);
    }
    r.close();
} 
```

更新版本：

以下代码删除 ZIP 中的所有错误字节。KMPMatch.java 在谷歌很容易找到

```
public static void replaceWrongBytesInZip(File zip) throws IOException {
    byte find[] = new byte[] { 0, 0x08, 0x08, 0x08, 0 };
    int index;
    while( (index = indexOfBytesInFile(zip,find)) != -1) {
        replaceWrongZipByte(zip, index + 2);
    }
}

private static int indexOfBytesInFile(File file,byte find[]) throws IOException {
    byte fileContent[] = new byte[(int) file.length()];
    FileInputStream fin = new FileInputStream(file);
    fin.read(fileContent);
    fin.close();
    return KMPMatch.indexOf(fileContent, find);
}

/**
 * Replace wrong byte http://sourceforge.net/tracker/?func=detail&aid=3477810&group_id=14481&atid=114481
 * @param zip file
 * @throws IOException
 */
private static void replaceWrongZipByte(File zip, int wrongByteIndex) throws IOException {
    RandomAccessFile  r = new RandomAccessFile(zip, "rw");
    int flag = Integer.parseInt("00001000", 2);
    r.seek(wrongByteIndex);
    int realFlags = r.read();
    if( (realFlags & flag) > 0) { // in latest versions this bug is fixed, so we're checking is bug exists.
        r.seek(wrongByteIndex);
        flag = (~flag & 0xff);
        // removing only wrong bit, other bits remains the same.
        r.write(realFlags & flag);
    }
    r.close();
} 
```

# c# - C# 错误：非静态字段需要对象引用

> ID：11039080
> 
> 赞同：-1
> 
> 时间：2012-06-14T18:22:15.853
> 
> 标签：c#, multithreading, visual-studio-2010, static

我有一个小的 Windows 窗体程序，它使用来自字符串的 console.beep 播放音乐。我在一个新线程“t”中设置了字符串播放位（基本上是一个 for 循环，逐个字符地遍历字符串并播放适当的音符）。当您点击“播放”按钮时，线程启动并且按钮变为“停止”按钮。如果你现在在播放音乐时点击这个“停止”按钮，它将停止并且按钮变回播放（通过调用“完成”方法。我的问题是我希望在新线程中运行的循环也调用当循环已经运行并且歌曲结束时的“完成”方法。但是如果我在循环之后放置完成（），我会得到“非静态字段需要对象引用”错误。如果我更改“完成”

这是您按下按钮时的代码...

```
//This is the method for when the "start" button is clicked
public void button1_Click(object sender, EventArgs e) 
    {
        if (music == null) { return; }

        if (button1.Text == "Play")
        {
            // it makes a new thread which calls my "parse" method which 
            // interprets the music and then calls "playnote" to play it.
            Thread t = new Thread(parse); 
            t.Start();
            button1.Text = "Stop";
        }
        else 
        {
            finished();
        }
    }

    public void finished()
    {
        stop = true;
        button1.Text = "Play";
    } 
```

有什么建议么？

提前非常感谢！

编辑：谢谢大家！！我真的没有时间弄清楚后台工作人员 atm 所以我现在只有单独的开始和停止按钮！:p

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:31:56.127

[我认为使用 BackgroundWorker 线程](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)会更好地完成。这样您就可以在事件中调用该`finished()`方法。`RunWorkerCompleted`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:31:54.223

parse() 方法是静态的吗？似乎您试图在不提供实例的情况下从静态方法调用 finished()，这就是为什么您会收到“非静态字段需要对象引用”错误的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:38:19.520

您需要做的是确保创建的线程可以访问创建它的对象（即“this”，在“button1_Click()”方法的范围内）。为此，您可以调用 t.Start(this) 而不是 t.Start()。这样做时，您将向线程传递能够调用“finished()”方法的对象。接下来，您需要确保“parse”方法采用 Object 类型的参数。这样做时，当您调用“t.Start(this)”时，“parse”方法将接收“this”作为参数。需要进行简单的强制转换才能转换为适当的类型。现在，当您希望歌曲在线程中停止时，只需在 cast 参数上调用“finish()”方法即可。所以你的代码应该是这样的：

public void parse(object o) { MyClass c = o as MyClass; // 用你的类名替换 MyClass

```
[...] // play music here

c.finished();  // call finished when you are done 
```

}

public void button1_Click(object sender, EventArgs e) { [...]

线程 t = 新线程（解析）；t.开始（这个）；// 而不是 t.Start()

[...] }

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T18:42:12.720

### 静态与成员方法

1.  要么你有一个成员（非静态）方法，你调用它

```
obj.SomeMethod(); 
```

2.  或者你有一个静态方法，你用

```
ClassName.SomeMethod(); 
```

除非在定义类本身内部调用它。然后可以简单地调用它

```
SomeMethod(); 
```

在这两种情况下。

* * *

### 穿线

唯一允许与 UI 交互的线程（例如 with `button1.Text`）是 UI 线程本身。UI 线程是代码正常运行的主线程。

请参阅[如何从 C# 中的另一个线程更新 GUI？](https://stackoverflow.com/q/661561/880990)用于与来自另一个线程的表单进行交互。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T18:51:36.480

你需要做的是在主线程上引发一个事件来调用你完成的方法。首先在表单类中声明事件和委托。

```
public delegate void CallFinishedEventHandler();
public event CallFinishedEventHandler CallFinished; 
```

然后创建一个事件处理程序，该处理程序将在引发事件时调用，并在调用完成的方法时调用。

```
void Form1_CallFinished()
{
  Finished();
} 
```

然后在您的表单构造函数中将您的事件处理程序连接到您的事件。

```
public Form1()
{
    CallFinished += Form1_CallFinished;
} 
```

最后，在您的音乐播放代码中，当您想要调用完成的方法（在 UI 线程上）时，调用您的事件，以便在 UI 线程上触发它。

```
this.Invoke(CallFinished); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-21T23:15:46.747

这很简单，创建一个全局线程，然后在你想要的地方访问它。

```
Thread t;
    public void button1_Click(object sender, EventArgs e) 
        {
            if (music == null) { return; }

            if (button1.Text == "Play")
            {
                // it makes a new thread which calls my "parse" method which 
                // interprets the music and then calls "playnote" to play it.
                t = new Thread(parse); 
                t.Start();
                button1.Text = "Stop";
            }
            else 
            {
                finished();
            }
        }

        public void finished()
        {
            stop = true;
            button1.Text = "Play";
        } 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2012-06-14T18:33:19.530

要调用完成，请创建表单类的实例，然后调用该方法。

```
Form1 frm1 = new Form1();
frm1.finished(); 
```

# wpf - 我可以绕过 WPF 字体缓存的使用吗？

> ID：11039081
> 
> 赞同：2
> 
> 时间：2012-06-14T18:22:22.880
> 
> 标签：wpf, fonts

我们正在开发 WPF/C# 应用程序并且遇到损坏字体缓存的问题。我们的许多用户都有旧的视频驱动程序，这些驱动程序在字体缓存方面特别有问题。我们已与个人用户合作升级驱动程序，这通常可以解决问题，但只有在用户遇到导致我们的软件无法使用的问题（这看起来像是我们的错误，而不是微软的错误）后，我们才会注意到问题。

目前，我们的应用程序中仅使用 2 种字体。 ***我可以告诉 WPF 完全绕过字体缓存***以防止我们的用户在运行我们的软件时出现这些问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:39:18.230

您可能要考虑不要让拥有正确驱动程序的用户为没有正确驱动程序的用户受苦。

也许您可以在设置中添加警告。

也就是说，您可以[停止缓存服务](https://stackoverflow.com/questions/4999756/what-is-the-use-of-wpffontcache-service-in-wpf-wpffontcache-v0400-exe-taking-10)（它是一项服务），但您需要成为管理员才能停止服务。

您可能还看看[清除字体缓存](https://stackoverflow.com/questions/7006436/systemfontfamilies-error-when-binding-to-combobox/7709424#7709424)

或者你可以看看[延迟加载字体](https://stackoverflow.com/questions/1745696/rendering-and-loading-fonts-into-the-fontcache-on-a-background-thread)是否会有所帮助。

# javascript - Drupal 7 Field API：如何以编程方式发送表单元素的#ajax属性中指定的AJAX请求？

> ID：11039088
> 
> 赞同：2
> 
> 时间：2012-06-14T18:23:23.903
> 
> 标签：javascript, ajax, drupal-7

我正在使用 Drupal 7 字段 API 通过 AJAX 重新加载我的部分表单。我有一个可以拨打电话的按钮，但我想删除它并以编程方式拨打电话作为对特定事件的响应。这是我的 AJAX 按钮代码：

```
$form['documents']['reload_document_list_button'] = array(
  '#type' => 'button',
  '#value' => 'Обновить список документов',
  '#ajax' => array(
    'callback' => 'reload_document_list',
    'wrapper' => 'document-list',
    'method' => 'replace',
  ),
); 
```

（有关详细信息，请参阅[http://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7#ajax](http://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7#ajax)。）有没有办法做到这一点？

PS我知道我可以设置按钮使其不可见并触发“点击”事件，但我正在寻找一种更简洁的方法来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T13:32:58.727

我认为有两种方法可以做到这一点：

首先，`#ajax`您可能已经阅读过的属性接受`event`密钥。对于按钮元素，默认情况下，此事件为`mousedown`. （您可以[在此处查看](http://api.drupal.org/api/drupal/includes!ajax.inc/function/ajax_pre_render_element/7)）您可以将其更改为自定义事件，例如`customEvent`从您的 Javascript 代码中触发此自定义事件`jQuery('#button-id').trigger('customEvent');`。

或者，您可以丢弃该`#ajax`属性本身。设置一个 AJAX 端点（使用`hook_menu`）并设置`reload_document_list`为它的回调。添加自定义 Javascript 以发出请求并处理响应。您可以查看使用`#ajax`from时 Drupal 发送 AJAX 请求的方式，`misc/ajax.js`并在需要时将其用作参考。

# sql - SQL查询优先考虑某个列值

> ID：11039090
> 
> 赞同：0
> 
> 时间：2012-06-14T18:23:32.860
> 
> 标签：sql

我有一个看起来像这样的表 EMP：

```
Name  DeptID  
A     1000

B     1000

C     1000

D     3000

E     6000 
```

该表有数千条记录，具有唯一名称和 DeptID 1000,3000,6000。

我需要从表中获取 2000 行，我目前正在使用以下查询

```
select * from EMP where rownum<2001; 
```

现在，我有一个要求，即需要对 DeptID=1000 的记录进行优先排序，以便查询返回 DeptID=1000 的最大可能记录。因此，如果 DeptID=1000 的记录数 >2000，则在查询响应中仅返回 DeptID=1000 记录。并且，如果 DeptID=1000 的记录数 <2000，假设为 500，则查询必须确保返回所有这 500 条记录，而其他 1500 条可以是 ID!=100 的记录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:31:49.387

免责声明：您没有指定您使用的 RDMS，所以我在 T-SQL 中为 MS SQL Server 编写了这个。

我采用了这个想法，因为如果需要您碰巧有一个更重要的特定部门 ID，我可以看到这样一种情况，在您获得该部门的所有记录后，您应该去另一个，然后是另一个，随意命令。这很好让你做到这一点：

```
DECLARE @DeptOrdering TABLE
(
    DeptId INT,
    SortOrder INT
)

INSERT @DeptOrdering (DeptId, SortOrder)
VALUES
    (1000, 10)
    , (6000, 20)
    , (3000, 30)

SELECT TOP 2000
    E.*
FROM EMP AS E
INNER JOIN @DeptOrdering Ordering
    ON Ordering.DeptId = E.DeptId
ORDER BY Ordering.SortOrder --, Other columns 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:26:55.537

```
Select top 2000 * 
from EMP 
Order by DeptID 
```

如果您使用的是 mysql 而不是 tsql，那么`top`您将`limit`在最后使用而不是 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:27:27.653

根据您的描述，我认为您需要从 EMP 表中选择前 2000 条记录，首先选择 DeptID=1000 记录。

此方法创建一个结果表，该表最多可容纳 4000 条记录，前 2000 条包含 DeptID=1000 条记录（如果有 2000 条或更多）。

```
IF OBJECT_ID ('EMPResults', 'U') IS NOT NULL
DROP TABLE EMPResults;
GO

(SELECT TOP 2000 * INTO EMPResults FROM EMP WHERE DeptID = 1000)
UNION
(SELECT TOP 2000 * FROM EMP WHERE DeptID <> 1000);
GO

SELECT TOP 2000 *
FROM EMPResults;
GO 
```

# google-chrome-extension - 谷歌浏览器扩展奇怪的渲染

> ID：11039092
> 
> 赞同：3
> 
> 时间：2012-06-14T18:23:35.273
> 
> 标签：google-chrome-extension, rendering

当我的 Google Chrome 随机开始以这种方式呈现弹出窗口时，我正在玩一些 Chrome 扩展、测试东西、更改示例等：

![带有弹出窗口的每个 Google Chrome 扩展程序的奇怪渲染](../Images/ffa37e946378bcfa218b41c2a9903719.png)

为什么？任何人都可以帮助我吗？

[更新]

我不知道为什么，但现在一切正常，我真的没有做任何事情来修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T07:07:31.453

从滚动条的长度来看，以及在 HackerNews 上打开该选项卡，我会说渲染器混乱出现在可想象的场景区域。:P

反正。如果您没有从开发频道运行 Chrome，并且您确信您使用的是最新的稳定版本，您可以执行以下操作：

1.  禁用所有其他扩展并逐一启用它们；其中之一可能具有与您的视频卡驱动程序不兼容的 GL 相关功能
2.  在您的扩展文件夹中搜索`.dll`文件，谁知道哪个可能会尝试做什么
3.  以管理员身份运行 Chrome；留意您可能已安装的任何其他软件。他们可以拦截和重新定位屏幕周围的窗口，但在管理员模式下，他们可能只是被禁止
4.  最后，禁用您的显卡驱动程序`devmgmt.msc`（不推荐，仅用于调试目的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T12:15:20.580

我不知道为什么，但现在一切正常，我真的没有做任何事情来修复它。

# regex - 正则表达式查找和替换重复项

> ID：11039094
> 
> 赞同：0
> 
> 时间：2012-06-14T18:23:37.833
> 
> 标签：regex, replace, repeat

我有一堆文本文件，其中包含重复的 P(m,n) 项，其中 m 和 n 是逐渐增加的数字。如何使用正则表达式查找和替换重复出现的术语[最好使用 Funduc 的 Studio Pro 或 Windows 7 上的 Notepad ++]？

这是一个例子。我想要以下文字：

> P(1,1) aaa P(1,1) bbb P(1,2) bbbbb P(1,3) ccccc P(2,1) ddddd P(2,2) kkk P(2,2) jjj P (2,2) lll P(2,3) rrr ....

变成：

> P(1,1) aaa bbb P(1,2) bbbbb P(1,3) ccccc P(2,1) ddddd P(2,2) kkk jjj lll P(2,3) rrr ....

请注意，只剩下第一个新的 P(m,n) 项，并且重复的项被替换为空格。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:35:50.620

由于您只想保留第一个实例，因此 .NET 的 RightToLeft 选项在这里派上用场。

这是我想出的：

```
(?<=\1.+)(\bP\(\d+,\d+\)\s?) 
```

[http://regexhero.net/tester/?id=0b5257ff-f048-45da-b7b5-39e86d69d46b](http://regexhero.net/tester/?id=0b5257ff-f048-45da-b7b5-39e86d69d46b)

请注意，这仅适用于带有 RegexOptions.RightToLeft 的 .NET（如上面的 Regex Hero 示例中）。

因此，实现这项工作的关键部分`(?<=\1.+)`是积极的向后追溯，它查找在正则表达式的后半部分定义的组 #1 的实例。然后你只需用空字符串替换匹配项。

* * *

要替换一堆文件中的文本，请使用[Regex Hero Grep](http://regexhero.net/grep/)实用程序。

# php - 如何检查上传的文件类型是pdf

> ID：11039095
> 
> 赞同：13
> 
> 时间：2012-06-14T18:23:39.633
> 
> 标签：php, html, pdf

> **可能重复：**
> [如何在 PHP 中检查上传文件的文件类型？](https://stackoverflow.com/questions/310714/how-to-check-file-types-of-uploaded-files-in-php)

我的网站上有上传功能，只允许上传 PDF。如何检查上传的文件是否仅为 PDF？就像`getimagesize()`可以验证图像文件一样。有什么方法可以检查文件是PDF吗？我的代码如下：

```
$whitelist = array(".pdf");

foreach ($whitelist as $item) {
    if (preg_match("/$item\$/i", $_FILES['uploadfile']['name'])) {

    }
    else {
        redirect_to("index.php");
    }
}

$uploaddir = 'uploads/';

$uploadfile = mysql_prep($uploaddir . basename($_FILES['uploadfile']['name']));

if (move_uploaded_file($_FILES['uploadfile']['tmp_name'], $uploadfile)) {
    echo "succussfully uploaded";
} 
```

功能`redirect_to`和`mysql_prep`由我定义。但是可以使用标头更改 mime 类型。那么有什么方法可以检查文件是否为原始pdf？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-14T18:31:03.150

您可以使用 PHP 的[File Info Functions](http://www.php.net/manual/en/function.finfo-file.php)检查文件的 MIME 类型。如果它以“application/pdf”类型返回，那么它应该是 PDF。

文件信息函数是在 PHP 5.3 中添加的，但在此之前，您可以使用[mime_content_type](http://www.php.net/manual/en/function.mime-content-type.php)函数。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-14T18:34:55.127

```
mime_content_type('file.ext'); 
```

[mime_content_type()](http://php.net/manual/en/function.mime-content-type.php)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-14T18:33:49.197

通过打开文件并读取数据的前几个字节来查找 PDF[幻数。](http://en.wikipedia.org/wiki/File_format#Magic_number)大多数文件都有特定的格式，PDF 文件以[%PDF](http://en.wikipedia.org/wiki/Portable_Document_Format)开头。

您可以检查文件的前 5 个字符，如果它们等于“%PDF-”，则它*可能*是一个真正的 PDF（但是，这并不能明确证明它是一个 PDF 文件，因为任何文件都可以以这 5 个字符开头）。正确 PDF 文件中接下来的 4 个字符包含版本号（即 1.2）。

# android - 当应用程序的缓存被删除时，Android 是否会向应用程序发送通知？

> ID：11039099
> 
> 赞同：1
> 
> 时间：2012-06-14T18:24:07.393
> 
> 标签：android, caching, notifications, android-notifications

在Android中，当应用程序的缓存被删除并且应用程序正在运行时，操作系统是否会向应用程序发送通知？

随着应用程序的运行，可以将其置于后台，进入设置菜单，管理应用程序并清除缓存，然后返回正在运行的应用程序。了解它以刷新与缓存状态相关的任何变量可能很重要。

如果没有发送通知，我想我将别无选择，只能在每次应用程序进入前台时检查缓存的一致性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:38:20.783

我认为它不会向您的应用程序发送通知。

但是，如果缓存被清除，那么检查 onResume() 函数将非常简单。只需检查它是否有任何文件。如果其中没有文件，则说明您的缓存已被清除。您可以通过在您的应用程序启动时创建一个文件来双重验证这一点，您可以在 onResume() 中检查是否存在。

# mysql - SPRING ROO：（MVC）Java堆空间->延迟加载不起作用

> ID：11039101
> 
> 赞同：0
> 
> 时间：2012-06-14T18:24:24.057
> 
> 标签：mysql, hibernate, lazy-loading, heap-memory, spring-roo

（首先..对不起我的英语..）

所以我一直在做一个**spring roo**项目。我正在从一个有30个表的**mysql数据库做逆向工程。**问题是它抛出了**“java.lang.OutOfMemoryError: Java heap space”错误** ，因为**延迟加载不起作用**，正如我在调试日志中看到的那样

我什至在表格中没有很多行.. 我的意思是我的表格中没有一个超过 15 行..

我已经尝试添加

```
@OneToMany(mappedBy = "unidadId", fetch = FetchType.LAZY)
private Set<Area> areas;
@Fetch(FetchMode.SELECT)

public Set<com.springroo.gqr.dominio.Area> getAreas() {
    return areas;
}

@ManyToOne (fetch = FetchType.LAZY) //which does exactly the oposite: EAGER :S and it makes it even slooooooower..
@JoinColumn(name = "unidad_id", referencedColumnName = "id", nullable = false)
private Unidad unidadId; 
```

所以我把它改成

```
@ManyToOne (optional=false)
@JoinColumn(name = "unidad_id", referencedColumnName = "id", nullable = false)
private Unidad unidadId; 
```

我也试过

```
@LazyCollection(LazyCollectionOption.EXTRA) 
```

和

```
@LazyCollection(LazyCollectionOption.TRUE) 
```

我试图通过将 default-lazy 设置为 true 来更改我的持久性文件 - .. 但是.. 什么都没有 :(

看起来无论我做什么，休眠都不会更改为延迟加载，所以我想知道我必须在哪里设置延迟加载，或者我错过了什么..

有谁能够帮我..？

这是我的 ROO 脚本

```
project --topLevelPackage com.springroo.GQR
jpa setup --provider HIBERNATE --database MYSQL --databaseName bd_gqr --userName root --password ******
database reverse engineer --schema bd_gqr --package ~.dominio
web mvc setup
web flow 
web mvc all --package ~.web
web mvc language --code es
security setup
perform tests
perform eclipse 
```

这些是我的课：公共课区{

```
@ManyToOne(optional = false)
@JoinColumn(name = "unidad_id", referencedColumnName = "id", nullable = false)
private Unidad unidadId;

@OneToMany(mappedBy = "areaId", fetch = FetchType.LAZY)
@Fetch(FetchMode.SELECT)
private Set<Empleado> empleadoes;

@OneToMany(mappedBy = "areaId", fetch = FetchType.LAZY)
@Fetch(FetchMode.SELECT)
private Set<Queja> quejas;

@Column(name = "nombre", length = 45, unique = true)
@NotNull
private String nombre;

public String getNombre() {
    return nombre;
}

public void setNombre(String nombre) {
    this.nombre = nombre;
}
public Unidad AgetUnidadId() {
    return unidadId;
}

public void setUnidadId(Unidad unidadId) {
    this.unidadId = unidadId;
}

public Set<com.springroo.gqr.dominio.Empleado> getEmpleadoes() {
    return empleadoes;
}

public void setEmpleadoes(Set<com.springroo.gqr.dominio.Empleado> empleadoes) {
    this.empleadoes = empleadoes;
}

public Set<com.springroo.gqr.dominio.Queja> getQuejas() {
    return quejas;
}

public void setQuejas(Set<com.springroo.gqr.dominio.Queja> quejas) {
    this.quejas = quejas;
} 
```

}

```
public class Unidad {

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
@Column(name = "id")
private Integer id;

public Integer getId() {
    return this.id;
}

public void setId(Integer id) {
    this.id = id;
}

@OneToMany(mappedBy = "unidadId", fetch = FetchType.LAZY)
private Set<Area> areas;

@Fetch(FetchMode.SELECT)
public Set<com.springroo.gqr.dominio.Area> getAreas() {
    return areas;
}

public void setAreas(Set<com.springroo.gqr.dominio.Area> areas) {
    this.areas = areas;
}
} 
```

这些是我的表定义：

```
 <table name="area">
    <column name="id" primaryKey="true" required="true" scale="0" size="10" type="4,INT"/>
    <column name="unidad_id" primaryKey="false" required="true" scale="0" size="10" type="4,INT"/>
    <column name="nombre" primaryKey="false" required="true" scale="0" size="45" type="12,VARCHAR"/>
    <foreign-key foreignTable="unidad" name="fk_area_unidad1" onDelete="cascade" onUpdate="cascade">
        <option key="exported" value="false"/>
        <reference foreign="id" local="unidad_id"/>
    </foreign-key>
    <foreign-key foreignTable="empleado" name="fk_empleado_area1" onDelete="cascade" onUpdate="cascade">
        <option key="exported" value="true"/>
        <reference foreign="area_id" local="id"/>
    </foreign-key>
    <foreign-key foreignTable="queja" name="fk_quejas_areas1" onDelete="cascade" onUpdate="cascade">
        <option key="exported" value="true"/>
        <reference foreign="area_id" local="id"/>
    </foreign-key>
    <unique name="PRIMARY">
        <unique-column name="id"/>
    </unique>
    <unique name="nombre_UNIQUE">
        <unique-column name="nombre"/>
    </unique>
    <index name="fk_area_unidad1">
        <index-column name="unidad_id"/>
    </index>
</table>

    <table name="unidad">
    <column name="id" primaryKey="true" required="true" scale="0" size="10" type="4,INT"/>
    <column name="clues" primaryKey="false" required="true" scale="0" size="25" type="12,VARCHAR"/>
    <column name="nombre" primaryKey="false" required="true" scale="0" size="100" type="12,VARCHAR"/>
    <foreign-key foreignTable="area" name="fk_area_unidad1" onDelete="cascade" onUpdate="cascade">
        <option key="exported" value="true"/>
        <reference foreign="unidad_id" local="id"/>
    </foreign-key>
    <unique name="PRIMARY">
        <unique-column name="id"/>
    </unique>
    <unique name="nombre_UNIQUE">
        <unique-column name="nombre"/>
    </unique>
    <unique name="clues_UNIQUE">
        <unique-column name="clues"/>
    </unique>
</table> 
```

调试日志的一部分：

```
Hibernate: select quejas0_.area_id as area3_4_2_, quejas0_.id as id2_, quejas0_.id as id18_1_, quejas0_.area_id as area3_18_1_, quejas0_.folio as folio18_1_, quejas0_.medio_id as medio4_18_1_, quejas0_.tramite_id as tramite5_18_1_, medioqueja1_.id as id13_0_, medioqueja1_.medio as medio13_0_ from queja quejas0_ inner join medio_queja medioqueja1_ on quejas0_.medio_id=medioqueja1_.id where quejas0_.area_id=? 
```

**所以问题是......在哪里以及如何告诉 roo/hibernate 不要加载不必要的表**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T09:32:53.773

我也有问题。我有 1 个表只使用 MySQL。数据包含 500k 行。

使用 Spring Roo，按照教程运行所有脚本以设置逆向工程和所有内容。服务器运行时。去`localhost:8080`，它运行正常。但是点击`List All`，java堆空间！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T21:34:23.680

```
import javax.persistence.FetchType
@ManyToOne (fetch = FetchType.LAZY) 
```

我不确定为什么这对你不起作用，我刚刚使用它，它确实使它延迟加载。在哪里修改生成的 .aj 文件，因为如果是这样，Roo 将在下一次扫描时重新生成它；如果是这样，您需要将其推送到 .java 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T04:05:29.353

你能分享 Roo 脚本和表 Unidad 和 Area 的定义吗？

抱歉，但我没有足够的时间看一看，但是看代码我发现您正在使用 Hibernate 注释：Fetch with FetchMode.SELECT。做什么的？

一般来说，依赖引擎并不是一个好主意。此外，也许它正在创造一些不受欢迎的行为。

乍一看，JPA 注释 Fetch.LAZY 似乎足以满足您的目标。

# java - Hibernate 更新查询：如何设置默认值？

> ID：11039105
> 
> 赞同：0
> 
> 时间：2012-06-14T18:24:43.940
> 
> 标签：java, hibernate, hql

我有两个实体类

```
class User { 
    Integer userId;
    String userName;
    UserType userType;
} 
```

和

```
class UserType {
    Integer typeId;
    String type;
    Set<User> userList;
} 
```

如何通过 HQL 更新查询`new UserType()`在所有`user.userType`位置进行设置？`user.userType=null`

我是冬眠新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:46:16.800

您可以执行以下操作：

```
UserType userType = /* code to get already persisted userType */;

Query query = session.createQuery("update User u set u.userType = :newType where u.userType is null");
query.setParameter("newType", userType);
int result = query.executeUpdate(); 
```

# jquery - jQuery UI - 弹跳 - div 从左到右跳跃

> ID：11039106
> 
> 赞同：4
> 
> 时间：2012-06-14T18:24:53.293
> 
> 标签：jquery, html, jquery-ui

我的网站有问题，我在其中使用带有 jQ​​uery UI 的 jQuery，在登录框上创建弹跳效果。

但是，我对带有登录框的 div 有问题，因为它在屏幕左侧弹跳，当它应该在中间弹跳时，当它完成弹跳时它也会跳进去。

我创建了一个 JSFiddle 来演示它：http: [//jsfiddle.net/prooi/GqyfX/](http://jsfiddle.net/prooi/GqyfX/)

如果你能看一下，并告诉我它为什么会这样，那就太棒了。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T19:00:17.120

在容器中插入另一个 div 并在其上应用 jquery 代码，即

```
<div id="container">
  <div id="nested"> 
     <!-- Your Existing Html Markup -->
  </div>
</div> 
```

**并在嵌套**div上应用 jquery 代码，即

```
$(document).ready(function() {
  $("#nested").effect('bounce', 250);
}); 
```

问题将得到解决:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:54:22.173

你需要在你的 javascript 中添加这个：

```
 $('#container').css('margin-left', $('#container').width()- $('#container').width()/2); 
```

并删除css 中的`left:auto;`和`margin:auto;``#container`

这是小提琴：http: [//jsfiddle.net/GqyfX/2/](http://jsfiddle.net/GqyfX/2/)

在小提琴中，由于示例的大小，它并不是那么好，但是在您的网站上尝试一下

# security - Jboss通过身份验证关闭

> ID：11039108
> 
> 赞同：1
> 
> 时间：2012-06-14T18:24:57.210
> 
> 标签：security, jboss5.x, shutdown

我使用 jboss-5.0.1.GA，我想限制对 shutdown.sh 的访问

在 jmx-console-users.properties 中，我有

```
admin=<password> 
```

在 jmx-invoker-service.xml 中，我取消了拦截器的注释

```
 <descriptors>
           <interceptors>
              <!-- Uncomment to require authenticated users-->
              <interceptor code="org.jboss.jmx.connector.invoker.AuthenticationInterceptor"
                 securityDomain="java:/jaas/jmx-console"/>

              <!-- Interceptor that deals with non-serializable results -->
              <interceptor code="org.jboss.jmx.connector.invoker.SerializableInterceptor"
                 policyClass="StripModelMBeanInfoPolicy"/>
           </interceptors>
        </descriptors> 
```

我试过命令

```
../jboss-5.0.1.GA/bin/shutdown.sh -u admin -p <password> 
```

我得到以下异常：

```
Exception in thread "main" java.lang.SecurityException: Failed to authenticate principal==admin, securityDomain=jmx-console
    at org.jboss.jmx.connector.invoker.AuthenticationInterceptor.invoke(AuthenticationInterceptor.java:88)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:90)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:668)
    at org.jboss.invocation.jrmp.server.JRMPProxyFactory.invoke(JRMPProxyFactory.java:180)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:157)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:96)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:668) ...... 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-22T17:15:55.613

我知道这是一年半前的帖子，但我在研究相同问题时发现这是第一次搜索。对于遇到此问题的任何人，这是由于 JBoss 5 附带的 init 脚本不正确。请参考 bugzilla 链接[https://bugzilla.redhat.com/show_bug.cgi?id=777710](https://bugzilla.redhat.com/show_bug.cgi?id=777710)，其中包含文件 EAP_43_jboss_init_redhat.sh向进程抛出 SIGTERM 信号，而不是调用 JBoss 关闭命令。以供参考，以防 bugzilla 链接不可用，这里也发布了 init 脚本。

```
#!/bin/sh
#
# $Id: jboss_init_redhat.sh 71029 2008-03-19 21:58:46Z dbhole $
#
# JBoss Control Script
#
# To use this script run it as root - it will switch to the specified user
#
# Here is a little (and extremely primitive) startup/shutdown script
# for RedHat systems. It assumes that JBoss lives in /usr/local/jboss,
# it's run by user 'jboss' and JDK binaries are in /usr/local/jdk/bin.
# All this can be changed in the script itself. 
#
# Either modify this script for your requirements or just ensure that
# the following variables are set correctly before calling the script.

#define where jboss is - this is the directory containing directories log, bin, conf etc
JBOSS_HOME=${JBOSS_HOME:-"/usr/local/jboss"}

#define the user under which jboss will run, or use 'RUNASIS' to run as the current user
JBOSS_USER=${JBOSS_USER:-"jboss"}

#make sure java is in your path
JAVAPTH=${JAVAPTH:-"/usr/local/jdk/bin"}

#configuration to use, usually one of 'minimal', 'default', 'all', 'production'
JBOSS_CONF=${JBOSS_CONF:-"production"}

#if JBOSS_HOST specified, use -b to bind jboss services to that address
JBOSS_BIND_ADDR=${JBOSS_HOST:+"-b $JBOSS_HOST"}

#define the script to use to start jboss
JBOSSSH=${JBOSSSH:-"$JBOSS_HOME/bin/run.sh -c $JBOSS_CONF $JBOSS_BIND_ADDR"}

if [ "$JBOSS_USER" = "RUNASIS" ]; then
  SUBIT=""
else
  SUBIT="su - $JBOSS_USER -c "
fi

if [ -n "$JBOSS_CONSOLE" -a ! -d "$JBOSS_CONSOLE" ]; then
  # ensure the file exists
  touch $JBOSS_CONSOLE
  if [ ! -z "$SUBIT" ]; then
    chown $JBOSS_USER $JBOSS_CONSOLE
  fi 
fi

if [ -n "$JBOSS_CONSOLE" -a ! -f "$JBOSS_CONSOLE" ]; then
  echo "WARNING: location for saving console log invalid: $JBOSS_CONSOLE"
  echo "WARNING: ignoring it and using /dev/null"
  JBOSS_CONSOLE="/dev/null"
fi

#define what will be done with the console log
JBOSS_CONSOLE=${JBOSS_CONSOLE:-"/dev/null"}

JBOSS_CMD_START="cd $JBOSS_HOME/bin; $JBOSSSH"

if [ -z "`echo $PATH | grep $JAVAPTH`" ]; then
  export PATH=$PATH:$JAVAPTH
fi

if [ ! -d "$JBOSS_HOME" ]; then
  echo JBOSS_HOME does not exist as a valid directory : $JBOSS_HOME
  exit 1
fi

echo JBOSS_CMD_START = $JBOSS_CMD_START

function procrunning() {
   procid=0
   JBOSSSCRIPT=$(echo $JBOSSSH | awk '{print $1}' | sed 's/\//\\\//g')
   for procid in `/sbin/pidof -x "$JBOSSSCRIPT"`; do
       ps -fp $procid | grep "${JBOSSSH% *}" > /dev/null && pid=$procid
   done
}

stop() {
    pid=0
    procrunning
    if [ $pid = '0' ]; then
        echo -n -e "\nNo JBossas is currently running\n"
        exit 1
    fi

    RETVAL=1

    # If process is still running

    # First, try to kill it nicely
    for id in `ps --ppid $pid | awk '{print $1}' | grep -v "^PID$"`; do
       if [ -z "$SUBIT" ]; then
           kill -15 $id
       else
           $SUBIT "kill -15 $id"
       fi
    done

    sleep=0
    while [ $sleep -lt 120 -a $RETVAL -eq 1 ]; do
        echo -n -e "\nwaiting for processes to stop";
        sleep 10
        sleep=`expr $sleep + 10`
        pid=0
        procrunning
        if [ $pid == '0' ]; then
            RETVAL=0
        fi
    done

    # Still not dead... kill it

    count=0
    pid=0
    procrunning

    if [ $RETVAL != 0 ] ; then
        echo -e "\nTimeout: Shutdown command was sent, but process is still running with PID $pid"
        exit 1
    fi

    echo
    exit 0
}

case "$1" in
start)
    cd $JBOSS_HOME/bin
    if [ -z "$SUBIT" ]; then
        eval $JBOSS_CMD_START >${JBOSS_CONSOLE} 2>&1 &
    else
        $SUBIT "$JBOSS_CMD_START >${JBOSS_CONSOLE} 2>&1 &" 
    fi
    ;;
stop)
    stop
    ;;
restart)
    $0 stop
    $0 start
    ;;
*)
    echo "usage: $0 (start|stop|restart|help)"
esac 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T21:21:44.420

我解决了这个问题：

执行命令时：

```
../jboss-5.0.1.GA/bin/shutdown.sh -u admin -p <password> 
```

它在 jmx-invoker-service.xml 中查找“securityDomain”并转到 login-config.xml 以查找匹配项。 `securityDomain="java:/jaas/jmx-console"/`

login-config.xml 配置如下所示：

```
<application-policy name="jmx-console">
<authentication>
  <login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule"
    flag="required">
    <module-option name="usersProperties">props/jmx-console-users.properties</module-option>
    <module-option name="rolesProperties">props/jmx-console-roles.properties</module-option>
    <module-option name="hashAlgorithm">MD5</module-option> 
    <module-option name="hashEncoding">base64</module-option>        
  </login-module>
</authentication> 
```

然后它去 jmx-console-users.properties 找到定义的用户名和密码。

```
admin=fGoYCzaJagqMAnh+6vsOTA== 
```

属性文件中的密码使用 MD5 加密（明文为“password1”）。

诀窍是我必须使用明文的命令：

喜欢：`../jboss-5.0.1.GA/bin/shutdown.sh -u admin -p password1` 但我把这个命令放在一个带有 encrpt 密码的脚本中

```
../jboss-5.0.1.GA/bin/shutdown.sh -u admin -p fGoYCzaJagqMAnh+6vsOTA== 
```

还有两个问题：

1.有没有办法使用加密密码关机？我不想在我的脚本中使用明文密码。2\. MD5以外的加密算法有哪些选择？有没有比MD5强的算法？任何人都可以在这方面提供帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-10T11:47:57.740

echo -n [密码] | openssl dgst -md5 -binary | openssl base64

运行上述脚本以使用 md5 获取加密密码。把它放在 jmx-console-users.properties 和 stopServer.sh

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T20:49:27.940

来自[http://docs.oracle.com/javase/1.4.2/docs/guide/security/CryptoSpec.html#AppA](http://docs.oracle.com/javase/1.4.2/docs/guide/security/CryptoSpec.html#AppA)

```
Message Digest Algorithms
The algorithm names in this section can be specified when generating an instance of MessageDigest. 

MD2: The MD2 message digest algorithm as defined in RFC 1319\. 

MD5: The MD5 message digest algorithm as defined in RFC 1321\. 

SHA-1: The Secure Hash Algorithm, as defined in Secure Hash Standard, 
       NIST FIPS 180-1\. 

SHA-256, SHA-384, and SHA-512: New hash algorithms for which the draft Federal
Information Processing Standard 180-2, Secure Hash Standard (SHS) is now available.
SHA-256 is a 256-bit hash function intended to provide 128 bits of security against
collision attacks, while SHA-512 is a 512-bit hash function intended to provide 256
bits of security. A 384-bit hash may be obtained by truncating the SHA-512 output. 
```

# java - 同时读取 2 个文件，没有更多的性能

> ID：11039110
> 
> 赞同：0
> 
> 时间：2012-06-14T18:24:58.457
> 
> 标签：java, multithreading, futuretask

我试图同时读取文件并返回行数

```
ExecutorService executor = Executors.newFixedThreadPool(2);
FutureTask<Integer> futureOne = new FutureTask<Integer>(new Calcul1());
FutureTask<Integer> futureTwo = new FutureTask<Integer>(new Calcul2());
executor.execute(futureOne);
executor.execute(futureTwo);
while (!(futureOne.isDone() && futureTwo.isDone())) {

}

System.out.println(futureOne.get() + futureTwo.get());
executor.shutdown(); 
```

这工作得很好，但我发现如果我读取文件 1 和文件 2 之后会更快......所以我没有得到 futureTash 的任何性能提升

为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:42:33.993

自旋循环完全浪费了一个核心——这就是线程间信号的用途。如果您只有一个带有两个文件的磁盘，则根本不会有太多的加速，实际上它很可能是负面的。如果您在不同的磁盘上有文件（尤其是具有高延迟连接的网络磁盘），则会有很大的性能提升。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T18:42:54.563

我怀疑您的应用程序完全受 IO 限制。当您在一个线程中读取单个文件时，您会看到更好的性能，因为您是按顺序访问文件。当您启动两个线程时，您正在读取两个不同的文件，这实际上导致磁盘在两个文件之间来回寻找。如果我们谈论的是旋转盘片类型的磁盘，那么寻道时间是 IO 的重要组成部分。

# imagemagick - 使用 ImageMagick 将优化的 gif 转换为单帧

> ID：11039111
> 
> 赞同：11
> 
> 时间：2012-06-14T18:25:02.543
> 
> 标签：imagemagick, gif

我有一些我想使用的创意共享 gif，但我需要它们作为单帧。但是，对 gif 进行了优化，所以当我通过

```
convert the.gif frames/%02d.tga 
```

有些图像只是不合适的片段，而且比原始图像小得多。

那么有没有办法在查看器中查看单个帧时渲染它们？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-18T22:30:37.383

您可能想在[`-coalesce`](http://www.imagemagick.org/script/command-line-options.php?#coalesce)命令中添加一个选项：`convert -coalesce the.gif frames/%02d.tga`

# three.js - Three.js：将较小的对象放在较大球体的随机位置上

> ID：11039113
> 
> 赞同：0
> 
> 时间：2012-06-14T18:25:08.177
> 
> 标签：three.js

在 Three.js（使用 JavaScript/WebGL）中，给定一个更大的球体——半径为 200——我如何在这个球体的随机外部位置上放置一些较小的对象（在我的例子中是球体）？例如，想象球体是一个世界，在这个世界的地面上有一些小球体位于随机位置。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T07:51:43.540

我制作了一个 GeometryUtils 方法来获取网格上的随机点，你可以使用它：

[https://github.com/mrdoob/three.js/blob/master/src/extras/GeometryUtils.js#L304](https://github.com/mrdoob/three.js/blob/master/src/extras/GeometryUtils.js#L304)

```
var points = THREE.GeometryUtils.randomPointsInGeometry( geometry, nPoints ); 
```

它比特定于球体的解决方案更复杂，但它会为您提供始终位于真实网格上的点（与完美几何球体上的点相反，例如，如果您处理行星大小的网格，可能会关闭）。

直接在网格上获得更精确点的另一种选择是在更大的球体上生成随机点，然后将它们投射到球体中心。

虽然如果您不太关心精度，简单的几何方法就足够了。

BTW mrdoob 的方法很好，但它应该有一个额外的步骤来拒绝长度 > 1 的向量（请参阅超立方体拒绝方法）。

[http://local.wasp.uwa.edu.au/~pbourke/geometry/spherepoints/](http://local.wasp.uwa.edu.au/~pbourke/geometry/spherepoints/)

[给定球体上的随机点](https://stackoverflow.com/questions/5531827/random-point-on-a-given-sphere)

另请参阅此处了解如何在球体上生成随机点的其他方法：

[http://www.math.niu.edu/~rusin/known-math/96/sph.rand](http://www.math.niu.edu/~rusin/known-math/96/sph.rand)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-14T18:36:46.590

如果它只是一个领域，我会这样做：

```
sphere.position.x = Math.random() * 2 - 1;
sphere.position.y = Math.random() * 2 - 1;
sphere.position.z = Math.random() * 2 - 1;
sphere.position.normalize();
sphere.position.multiplyScalar( 200 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:30:20.217

只是想到了一种解决方案，尽管可能不是最好的：从较大的正方形中获取随机顶点，并将较小的对象放置在这些点上。喜欢：

```
var max = this.sphere.geometry.vertices.length;
for (var i = 0; i < max; i++) {
    if ( Misc.getChance(5) ) {
        var vertex = this.sphere.geometry.vertices[i];
        var sphere = new THREE.Mesh(geometry, material);
        sphere.position.set(vertex.x, vertex.y, vertex.z);
        scene.add(sphere);
    }
} 
```

将对象放在一个组中，然后缩放该组，会将它们移动到高于地面的位置：

```
spheresGroup.scale.x = spheresGroup.scale.y = spheresGroup.scale.z = 1.05; 
```

可能不是一个很好的解决方案。

# ios - 如何在uitableview中显示和隐藏数组

> ID：11039115
> 
> 赞同：0
> 
> 时间：2012-06-14T18:25:12.543
> 
> 标签：ios, xcode, arrays, uitableview, hide

我试图`Array`像这样加载我的 s，但它只是先加载，`Array`而其他的则不显示。

```
 - (void)viewDidLoad {
    [super viewDidLoad];

    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);
    NSString *path = [[documentPaths lastObject] stringByAppendingPathComponent:@"test.plist"];

    NSDictionary *myDict = [NSDictionary dictionaryWithContentsOfFile:path];

    if ([[NSUserDefaults standardUserDefaults] boolForKey:@"blackKey"])
    {
        NSArray *black = [myDict objectForKey:@"Black"];
        self.tableData = [black copy];
    }
    else if ([[NSUserDefaults standardUserDefaults] boolForKey:@"greenKey"])
    {
        NSArray *green = [myDict objectForKey:@"Green"];
        self.tableData = [green copy];
    }
    else if ([[NSUserDefaults standardUserDefaults] boolForKey:@"purpleKey"])
    {
        NSArray *purple = [myDict objectForKey:@"Purple"];
        self.tableData = [purple copy];
    }
    else if ([[NSUserDefaults standardUserDefaults] boolForKey:@"orangeKey"])
    {
    NSArray *orange = [myDict objectForKey:@"Orange"];
        self.tableData = [orange copy];
    }
    else if ([[NSUserDefaults standardUserDefaults] boolForKey:@"blueKey"])
    {
        NSArray *blue = [myDict objectForKey:@"Blue"];
        self.tableData = [blue copy];
    }
    else if ([[NSUserDefaults standardUserDefaults] boolForKey:@"redKey"])
    {
        NSArray *red = [myDict objectForKey:@"Red"];
        self.tableData = [red copy];
    }
    else if ([[NSUserDefaults standardUserDefaults] boolForKey:@"darkblueKey"])
    {
        NSArray *darkblue = [myDict objectForKey:@"Darkblue"];
        self.tableData = [darkblue copy];
    }
    else if ([[NSUserDefaults standardUserDefaults] boolForKey:@"yellowKey"])
    {
        NSArray *yellow = [myDict objectForKey:@"Yellow"];
        self.tableData = [yellow copy];
    }

    } 
```

1.  我做错了什么？

2.  另外，我想将数组标题显示为部分标题，怎么做？

3.  有没有办法限制每个部分的行数（我的数组）？

**编辑**

```
// Customize the number of rows in the table view.
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [tableData count];
}

// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    NSDictionary *dict = [tableData objectAtIndex:indexPath.row];
    cell.textLabel.text = [NSString stringWithFormat:@"%@ - %@", [dict objectForKey:@"Name"], [dict objectForKey:@"Address"]];

    return cell;
} 
```

**编辑2**

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
    [sectionsTitle objectForKey:[sectionTitle objectAtIndex:indexPath.section]];
} 
```

使用未声明的标识符“indexPath”；你的意思是“NSIndexPath”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:30:35.357

由于您要将它们划分为部分，因此您的 tableData 应该是`NSMutableDictionary` 而且您还需要保存字典的键数组 像这样

```
NSMutableDictionary *resultDic = [[NSMutableDictionary alloc] init];
NSMutableArray *resultArray = [[NSMutableArray alloc] init];
NSDictionary *myDict = [NSDictionary dictionaryWithContentsOfFile:path];
if ([[NSUserDefaults standardUserDefaults] boolForKey:@"blackKey"])
{
    NSArray *black = [myDict objectForKey:@"Black"];

    //Add the key here
    [resultArray addObject:@"Black"];
    //Add the key and value
    [resultDic setValue:black forKey:@"Black"];
}
else if ([[NSUserDefaults standardUserDefaults] boolForKey:@"greenKey"])
{
    NSArray *green = [myDict objectForKey:@"Green"];

    //Add the key here
    [resultArray addObject:@"Green"];
    //Add the key and value
    [resultDic setValue:black forKey:@"Green"];
}
//Repeat for all the elements
....
//Then after you finished all the tests and additions

//Assign the result array to your tableData
self.tableData = resultDic;
self.sectionsTitle = resultArray; 
```

现在使用`sectionsTitle`and`tableData`来填充表格对于表格中的任何部分，您可以从中获取其标题`[sectionsTitle objectAtIndex:sectionIndex];` 要获取部分中的所有元素，请使用`[sectionsTitle objectForKey:[sectionTitle objectAtIndex:sectionIndex]];`

# dialog - 添加页面选项卡对话框：限制用户一次只能选择一页

> ID：11039119
> 
> 赞同：0
> 
> 时间：2012-06-14T18:25:25.680
> 
> 标签：dialog, facebook-javascript-sdk

我正在使用“添加到页面”对话框：

[http://developers.facebook.com/docs/reference/dialogs/add_to_page/](http://developers.facebook.com/docs/reference/dialogs/add_to_page/)

但是我希望用户一次只做一个页面，所以我可以轻松地引导他们完成每个页面的应用程序自定义向导，而不会让他们感到困惑。

有没有办法将对话框更改为仅单选页面而不是多选？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-25T23:04:20.323

这个问题的答案是：不，没有办法用对话来做到这一点。Facebook 添加页面对话框总是返回用户添加到的页面数组，并且没有选项可以让它只请求一个页面。

另一种选择是编写我们自己的添加页面对话框，但这需要用户的 manage_pages 扩展权限，这在我们的例子中会吓跑他们。

我最终在项目中解决问题的方法是使用添加页面对话框并接受一系列答案。它将这个数组存储到一个会话中，并一次引导用户浏览我们的自定义向导一页，允许他们在完成第一页后自定义第二页。

所以流程是这样的：

1) 向他们展示 Facebook 提供的对话框。我们添加了一些文本，告诉用户对对话框的期望。

2) 保存 tabs_added 信息。

3) 对于添加的每个选项卡，在我们的系统中为该页面创建一个帐户，显示有关该页面的一些信息并要求用户提供有关该页面的其他自定义信息。

4）每一个完成后，转到第3步。

这并不是我们想要的，而且大多数用户只使用了一页，但它确实有效。

# jquery - 逐张显示图片

> ID：11039125
> 
> 赞同：1
> 
> 时间：2012-06-14T18:25:42.463
> 
> 标签：jquery

我正在尝试逐张展示图片。我发现这里的这个线程[需要一些想法来只显示一些像素并将剩余的像素变灰](https://stackoverflow.com/questions/5957789/need-ideas-to-only-display-some-pixels-and-gray-out-the-remaining-pixels)，mVChr 给出了一个很好的答案。这几乎是我要找的，但我想让显露的部分更大，所以完全看到图像需要更少的时间。我必须在代码中适应什么？有人能帮帮我吗？非常感谢您的努力

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:31:43.010

你需要改变两件事。

首先是灰色框的大小。这是用这个完成的

```
htmlFrag += '<div id="'+id+'" class="pix" ' +
            'style="width:3px;height:3px;position:absolute;' +
            'left:'+j+'px;top:'+i+'px;"></div>'; 
```

变成这样

```
htmlFrag += '<div id="'+id+'" class="pix" ' +
            'style="width:10px;height:10px;position:absolute;' +
            'left:'+j+'px;top:'+i+'px;"></div>'; 
```

然后您需要更改将框放入匹配的 for 循环

```
for (var i = 0, len = $('#i').height(); i < len; i += 3) {
    for (var j = 0, len = $('#i').width(); j < len; j += 3) { 
```

变成

```
for (var i = 0, len = $('#i').height(); i < len; i += 10) {
    for (var j = 0, len = $('#i').width(); j < len; j += 10) { 
```

[这是示例！](http://jsfiddle.net/W7Xse/41/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T23:09:32.350

[这是 corsiKa](http://jsfiddle.net/vfHSM/5/)的一个分支，其中包含一些 mod，其中最重要的是删除像素的方式，允许指定时间段。

也避免了像素具有 id 的需要，因此 HTML 更简单。

# c - 我认为将混合类型参数作为指针传递给函数

> ID：11039136
> 
> 赞同：1
> 
> 时间：2012-06-14T18:26:18.190
> 
> 标签：c, function, pointers, struct

这是我第一次在这里发帖。请原谅我的经验不足；我只是在学习。

我正在尝试实现 GSL 寻根方法，它需要将因变量和参数结构传递给函数。

这是传递给函数的参数结构（它在 .h 文件中）：

```
struct SumForces_params
{
double curvature;
struct panel panels[1000];
int lenPanels;
}; 
```

这是我定义参数实例的地方：

```
struct SumForces_params params = {0.0000001, {panels[1000]}, lenPanels}; 
```

这是功能：

```
double SumForces(double NAloc, void *params)
{
struct SumForces_params *p = (struct SumForces_params *) params;
double curvature = p->curvature; //works fine
int lenPanels = p->lenPanels; //works fine

struct panel panels = p->panels[1000];
//~ printf("panel 421 location = %g\n", panels[421].Yloc); 
//~ Above line gives this error: SumForces.c:54: error: subscripted value is neither
//~ array nor pointer

double yloc = 0;
yloc = p->panels[421].Yloc;
printf("panel 421 location = %g\n", yloc);
} 
```

总的来说，这给了我预期的输出：

```
printf("Main Panel 421 loc = %g\n",panels[421].Yloc); 
```

但是从函数代码中可以看出，struct panel panel = p->panels[1000]; 不起作用，第二次尝试（最后三行）的输出返回零。有人看到我做错了什么吗？

这是我对结构面板的定义：

```
struct panel
{
   double strain[136];
   double stress[136];
   double AE[136];
   double Ys;
   double E;
   double Yloc;
   double Area;
   gsl_interp_accel *acc_stress;
   gsl_spline *spline_stress;
   gsl_interp_accel *acc_AE;
   gsl_spline *spline_AE;
}; 
```

在这里，我将面板定义为 1000 个面板结构的数组：

```
struct panel panels[1000]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:32:10.060

```
struct panel panels = p->panels[1000]; 
```

`p->panel`是一个`1000`元素数组。`999`自从您在 开始索引后，最后一个元素具有索引`0`。所以，这个特定的行调用了 UB。你可能想要：

```
struct panel panels = p->panels[ 999 ]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T21:09:16.607

编译器可能以错误的方式理解您的语法（不是您所期望的），并且没有对此发出警告：

```
struct SumForces_params params = {0.0000001, {panels[1000]}, lenPanels}; 
```

我从您的问题中猜想您想将有关面板的数据复制到`params`. 正确的做法是这样的：

```
 struct SumForces_params params =
    {
        0.0000001,
        {}, // C doesn't have syntax for "put panels here"
        lenPanels
    };
    memcpy(params.panels, panels, sizeof(params.panels)); 
```

# gis - QGIS 在 Ubuntu Precise 上缺少 libjvm.so

> ID：11039137
> 
> 赞同：1
> 
> 时间：2012-06-14T18:26:18.843
> 
> 标签：gis, openjdk, java-7, ubuntu-12.04, qgis

我通过[ppa:ubuntugis/ubuntugis-unstable](https://launchpad.net/~ubuntugis/+archive/ubuntugis-unstable?field.series_filter=precise)安装了 QGIS 。我的 Ubuntu 12.04 带有 OpenJDK 1.7.0。当我从命令行启动 qgis 时，会返回以下错误消息。

> /usr/bin/qgis.bin：加载共享库时出错：libjvm.so：无法打开共享对象文件：没有这样的文件或目录

由于我期望 Oracle Java 有依赖关系，因此[我按照这些说明安装了 JDK 1.7.0](http://www.liberiangeek.net/2012/04/install-oracle-java-jdk-7-in-ubuntu-12-04-precise-pangolin/)。但是，错误消息仍然存在。

但是，可以在硬盘上找到该文件三次（无符号链接）。

```
$ locate libjvm.so
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/cacao/libjvm.so
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/jamvm/libjvm.so
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so 
```

你建议做什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T15:15:10.577

尝试更新您的软件包。该软件包有一个不应该存在`libgdal1-1.9.0-2ppa4`的侥幸依赖关系。`libjvm.so`我对`libgdal1-1.9.1-2~precise3`来自 ubuntugis-unstable PPA 的版本没有任何问题。

# c++ - 没有明显原因的 C++ 数据更改

> ID：11039138
> 
> 赞同：1
> 
> 时间：2012-06-14T18:26:21.107
> 
> 标签：c++

我有以下方法：

```
void Polygon::expand() {
    int newSize = max * 2;
    printArray(array, current);
    Point* newArray = new Point[newSize];
    printArray(array, current);
    for (int i = 0; i <= current; i++) {
            newArray[i] = array[i];
    }
    delete[] this->array;
    array = newArray;
    max = newSize;
} 
```

`printArray`用于调试，也很简单：

```
void printArray(Point* array, int size) {
    cout << "array\n==========" << endl;
    for (int i=0; i<=size; i++) {
            cout << array[i] << ": " << array[i].getX() << ", " << array[i].getY() << endl;
    }
} 
```

该方法试图扩展数组，它是 type 的类成员`Point*`。奇怪的是我在运行时得到的打印：

> 数组
> ==========
> (0,0): 0, 0
> (1,1): 1, 1
> (2,2): 2, 2
> (3,3): 3, 3
> 数组
> == ========
> (0,0): 0, 0
> (1,1): 1, 1
> (2,2): 2, 2
> (3,5.58294e-322): 3, 5.58294e-322

由于某种原因`Point`，数组中的最后一个发生了变化，即使我在打印之间没有碰过它！关于什么会导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T18:28:18.940

当您从`0`（如在 C 和 C++ 中）开始索引时，您会在比`size`. 所以，做：

```
for (int i=0; i<size; i++) // not <= 
```

这是一个典型的一对一错误（并且您正在调用 UB）。

# ruby-on-rails - 运行 rails new 时出错。铁路问题？

> ID：11039144
> 
> 赞同：0
> 
> 时间：2012-06-14T18:26:35.680
> 
> 标签：ruby-on-rails, ruby, rubygems

我正在关注 Ruby on Rails 教程，我在第 2 章。当我输入命令时

```
rails new demo_app 
```

这个错误溢出了。我试过寻找解决方案，但没有一个答案匹配。我尝试卸载/重新安装 railties 和 rails 但仍然遇到相同的错误。

```
 run  bundle install
Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.
6/lib/rails/generators/app_base.rb:254:in ``': No such file or directory - ""Z:/
Program Files/RailsInstaller/Ruby1.9.3/bin/ruby.exe"" -rubygems "Z:/Program File
s/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/bundler-1.0.22/bin/bundle" i
nstall (Errno::ENOENT)
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
railties-3.2.6/lib/rails/generators/app_base.rb:254:in `bundle_command'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
railties-3.2.6/lib/rails/generators/app_base.rb:258:in `run_bundle'
        from (eval):1:in `run_bundle'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
thor-0.15.2/lib/thor/task.rb:27:in `run'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
thor-0.15.2/lib/thor/invocation.rb:120:in `invoke_task'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
thor-0.15.2/lib/thor/invocation.rb:126:in `block in invoke_all'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
thor-0.15.2/lib/thor/invocation.rb:126:in `each'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
thor-0.15.2/lib/thor/invocation.rb:126:in `map'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
thor-0.15.2/lib/thor/invocation.rb:126:in `invoke_all'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
thor-0.15.2/lib/thor/group.rb:238:in `dispatch'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
thor-0.15.2/lib/thor/base.rb:408:in `start'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
railties-3.2.6/lib/rails/commands/application.rb:38:in `<top (required)>'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/
rubygems/custom_require.rb:55:in `require'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/
rubygems/custom_require.rb:55:in `require'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
railties-3.2.6/lib/rails/cli.rb:15:in `<top (required)>'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/
rubygems/custom_require.rb:55:in `require'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/
rubygems/custom_require.rb:55:in `require'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/
railties-3.2.6/bin/rails:7:in `<top (required)>'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/bin/rails:19:in `load'
        from Z:/Program Files/RailsInstaller/Ruby1.9.3/bin/rails:19:in `<main>' 
```

有什么建议么？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T03:28:42.723

不是答案，而是解决方案。

所以我放弃并卸载了railsinstaller并重新安装在Z：\目录中。“Program Files”中的空白导致的问题太多了，不止这一个。（尽管我在 RoR 教程中使用的基本教程应用程序似乎没有任何问题。）

在此之后，捆绑安装命令运行良好。我确信还有另一种方法可以引导空间，但我不知道怎么做，而且我认为这不值得麻烦。

我希望这可以帮助别人。我还评论了一些与空间问题相关的答案，所以如果你有其他问题，我的历史可能会有所帮助。

# mysql - 使用 mysql 按数据导入日期在现有数据集中按日期查找唯一/新值

> ID：11039145
> 
> 赞同：2
> 
> 时间：2012-06-14T18:26:35.710
> 
> 标签：mysql, sql, subquery, unique, date-range

我们的 mysql 数据库处理化学化合物的仓储和季度更新。我们有兴趣在最近的季度上传中找到独特的化合物 - 所以以前从未见过的化合物 (ChemID)。

我已经使用在挖掘类似问题/解决方案时发现的日期范围尝试了下面的一些代码，但无法让它适用于我的应用程序。这是我的尝试 1，它返回 NULL 或变化超时（使用 ChemCaseReports 中的 13M 行）。

请注意，真正的*最新* `ImportDate`（日期时间类型）是“2012-06-12 05:58:16”。

**尝试1：**

```
SELECT DISTINCT ChemID
FROM Chem_CaseReports a 
WHERE a.ImportDate = '2012-06-12 05:58:16'
AND NOT EXISTS
(
 SELECT * FROM Chem_CaseReports b 
 WHERE a.ChemID = b.ChemID
 AND b.ImportDate <= '2012-06-12 05:58:16'
) 
```

子查询中的 * 是否有必要避免 ChemID.a 和 .b 之间的歧义？我是否需要添加一个 GROUP BY 或 HAVING 子句，或者最初在我的初始选择中提供一个聚合参数，如 GROUP_CONCAT。

我有数学学习障碍，所以问题可能就像我的日期时间翻转 gt、eq 或 lt 符号一样简单。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:30:22.340

乍一看，您需要更改的`<=`只是`<`

**基本原理**

您的原始`NOT EXISTS`使用`<=` *包括*您需要保留的所有记录。

**然后声明变成**

```
SELECT DISTINCT ChemID
FROM Chem_CaseReports a 
WHERE a.ImportDate = '2012-06-12 05:58:16'
AND NOT EXISTS
(
 SELECT * FROM Chem_CaseReports b 
 WHERE a.ChemID = b.ChemID
 AND b.ImportDate < '2012-06-12 05:58:16'
) 
```

# asp.net - IIS Web.Config 301 重定向查询字符串参数 (?)

> ID：11039158
> 
> 赞同：5
> 
> 时间：2012-06-14T18:27:16.700
> 
> 标签：asp.net, iis, web-config

```
 <rule name="blog" stopProcessing="true">
      <match url="en/blog.aspx?Id=9" />
      <action type="Redirect" url="http://www.mynewurl.com" redirectType="Permanent" />
    </rule> 
```

我可以重定向“en/blog.aspx”，但无法仅重定向“en/blog.aspx?Id=9”。

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-14T18:34:03.313

终于找到了解决办法：

/en/blog.aspx?Id=9 将重定向到[http://www.newurl.com](http://www.newurl.com)。

```
 <rule name="blog" stopProcessing="true">
      <match url="en/blog.aspx$" />
      <conditions>  
        <add input="{QUERY_STRING}" pattern="Id=9" />  
    </conditions>  
      <action type="Redirect" url="http://www.newurl.com" redirectType="Permanent" />
    </rule> 
```

在这里找到解决方案：[301 redirect not working in IIS 7](https://stackoverflow.com/questions/8833259/301-redirect-not-working-in-iis-7)

# azure - 如何将文件夹上传到 Blob 存储？

> ID：11039159
> 
> 赞同：21
> 
> 时间：2012-06-14T18:27:20.360
> 
> 标签：azure, azure-storage, azure-blob-storage, azure-worker-roles

我有一个辅助角色，用于从 Blob Storage OnStart 中提取数据。目前我正在通过上传 test.txt 文件然后将其下载到本地目录来对此进行测试。这工作正常。

我现在想将一个文件夹上传到 blob 存储。此文件夹包含批处理脚本以及批处理脚本调用的几个可执行文件。

完成此操作的推荐方法是什么？我认为压缩文件夹并上传 *.zip 文件会很容易......但是，一旦我在本地下载它以供工作人员处理，我将如何在没有任何第三方库的情况下解压缩它？

如果有更好的选择，我愿意接受任何建议。感谢您在这里的帮助 - 随着我的发展，这个社区对我来说是一个巨大的帮助:)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2020-04-07T16:26:12.730

您可以使用`upload-batch`：

```
az storage blob upload-batch --destination ContainerName --account-name YourAccountName --destination-path DirectoryInBlob --source /path/to/your/data 
```

这会将在源目录中找到的所有文件复制到 blob 存储中的目标目录。

必须指定SAS 令牌（通过`--sas-token`）或帐户密钥。

还可以与服务主体顺利合作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-11-20T18:46:24.750

使用 az login 登录到 azure cli

1.  上传文件使用 `az storage blob upload additional-params`

2.  要上传文件夹，请使用 `az storage blob upload-batch additional-params`

请参阅[此处](https://docs.microsoft.com/en-us/cli/azure/storage/blob?view=azure-cli-latest#az-storage-blob-upload-batch)以获取完整的命令

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-14T20:04:21.437

您可以采用两种方法：单文件（例如 zip）或多文件（每个文件都在自己的 blob 中）。这是我的看法，然后是关于解压缩的说明：

**单个 zip 文件**

这是维护一组文件（如 apache 安装）或一组静态资源的一种非常简单的方法。从 blob 下载到本地存储非常简单。而且，一个 zip 文件可以处理任何级别的嵌套目录。

缺点：要更新单个文件，您需要创建一个新的 zip；无法简单地上传一项修改后的资产。

**单个斑点**

当您需要快速更新单个文件而不用担心其他文件时，单独的 blob 非常有用。此外，您可以直接链接到这些 blob，无论是公共的还是（使用共享访问签名）私有的，也可以在网页中嵌入链接等。请查看我的答案[，](https://stackoverflow.com/a/11015058/272109)以及 @Sandrino 的示例。哦，如果您打算通过 CDN 公开 blob，则它们需要位于单独的 blob 中。

缺点：没有到嵌套目录的绝对映射。Blob 存储按 account\container\blob 排列。虽然您*可以*模拟嵌套文件夹，但您需要做一些工作来映射单个文件。要下载单个 blob，您需要获取容器并调用`ListBlobs()`以枚举单个 blob 名称。

**如何解压**

Eclipse 项目提供了一个简单易用的 vbs 脚本。从 Visual Studio 项目（或实际上任何脚本），我会考虑下载类似[7zip](http://7-zip.org/)的东西，它是免费且易于安装的。然后只需将 zip 从 blob 存储下载到本地存储（在正确的文件夹中），并将其传递给 7zip。

我希望这为您提供足够的指导以做出正确的决定。如果是*我*并且我正在存储一个构建（如 tomcat），我会将整个目录结构保存在一个 zip 中。这让我确信我没有通过只修改一个文件来破坏某些东西。而且...我可以使用多个拉链（在单独的 blob 中）轻松地保留 tomcat 版本的运行历史。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-05-16T17:45:24.520

随着 AZCOPY 工具的发布，您可以在一行中完成此操作。详情[在这里](https://docs.microsoft.com/en-us/azure/storage/storage-use-azcopy)。

```
Cd "C:\Program Files (x86)\Microsoft SDKs\Azure\AzCopy"

.\AzCopy /Source:C:\Users\folderName\ `
/Dest:https://storageAccountName.blob.core.windows.net/storageContainerName `
/DestKey:yourStorageAccountKey /S 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-01-30T09:46:09.050

您可以使用 Azure 存储资源管理器[https://azure.microsoft.com/en-us/features/storage-explorer/](https://azure.microsoft.com/en-us/features/storage-explorer/)上传文件夹。它在后台使用 azcopy，但很高兴有一个用户界面。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-14T12:17:50.643

使用[Azure 存储资源管理器](https://azure.microsoft.com/en-us/features/storage-explorer/)。安装后您必须登录，然后您可以选择您的 Blob 并像正常上传过程一样上传文件夹。

我遇到了同样的问题，试图通过上传压缩文件夹来解决问题，但在 Azure 中没有解压缩文件夹的选项。

# c++ - 在 QThread 中运行长时间操作并向主线程发送信号仍然会冻结 UI

> ID：11039160
> 
> 赞同：0
> 
> 时间：2012-06-14T18:27:22.893
> 
> 标签：c++, multithreading, qt, user-interface, qthread

这就是我所拥有的：

```
void MyThread::run() {
  int progress = 0;
  while (1) {
    // do something
    progres++;
    emit(progressChanged(progress));
  }
}

// mainwindow
auto t = new MyTread();
connect(t, SIGNAL(progressChanged(int)), this, SLOT(onProgressChanged(int)));
t->start();

void MaiWindow::onProgressChanged(int) {
  this->progressBar->setValue(progressBar->value() + 1);
} 
```

它起作用了，线程中的工作完成了，进度条一直上升到 100%。

**但是**用户界面完全冻结/滞后。拖动带有进度条的窗口会导致 5 秒延迟。我尝试使用较低的线程优先级 - 没有结果。

也许我在这里需要一个互斥锁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T21:27:22.703

不要发出太多 progressChanged 信号。信号很快，但如果您每秒设置数百或数千次进度条值，则 UI 将冻结。将进度条更改保持在最低限度，每秒 5-10 次更改就足够了。

# ruby-on-rails - Chef：从 git 子文件夹部署 rails

> ID：11039172
> 
> 赞同：3
> 
> 时间：2012-06-14T18:28:35.427
> 
> 标签：ruby-on-rails, deployment, chef-infra, subdirectory

我正在使用 Chef 部署 Rails 服务器。我将代码存储在 git 存储库中，但它不是存储库中的唯一项目，它位于子文件夹中

```
回购/
 项目文件/
 更多项目文件/
 轨道应用程序/

```

Chef 的部署似乎很棒，但它不允许我从子文件夹进行部署（至少在本机上） 有没有一种聪明的方法可以做到这一点，或者我是否坚持使用“执行”来自己运行 rake 任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T19:25:08.583

决定将整个项目签出到一个文件夹中，并使用符号链接链接到我们需要的文件夹中。

如果需要，我们可以使用 Git 内置的“部分签出”东西，但我们必须通过*execute*而不是*deploy*发出命令。如果项目需要，我们将进一步调查，但目前可行。太糟糕了，厨师的*部署*没有那个功能。

# java - 根据最大字符限制优化 BigDecimal 格式

> ID：11039174
> 
> 赞同：1
> 
> 时间：2012-06-14T18:28:42.393
> 
> 标签：java, bigdecimal

我想将 BigDecimal 值转换为不超过一定数量字符的字符串，必要时切换到科学记数法。我怎样才能做到这一点？

换句话说，我如何编写`formatDecimal(BigDecimal number, int maxChars)`能够通过以下测试的函数：

```
 final int maxChars = 6;

    assertEquals(
            "0.3333",
            formatDecimal(new BigDecimal(0.3333333333333), maxChars)
            );

    assertEquals(
            "1.6E+6", 
            formatDecimal(new BigDecimal(1555555), maxChars)
            );

    assertEquals(
            "1.6E-5", 
            formatDecimal(new BigDecimal(0.0000155), maxChars)
            );

    assertEquals(
            "1234.6", 
            formatDecimal(new BigDecimal(1234.56789), maxChars)
            );

    assertEquals(
            "123", 
            formatDecimal(new BigDecimal(123), maxChars)
            );

    assertEquals(
            "0", 
            formatDecimal(new BigDecimal(0), maxChars)
            ); 
```

在我的应用程序中，`maxChars`实际上并不需要成为参数——它将在编译时固定（到 18），因此使用例如的解决方案`DecimalFormat("#.####")`可以工作，只要可以正确管理到科学记数法的切换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T22:43:01.030

```
public static String formatDecimal(BigDecimal bd, int maxChars)
{
 String convert = bd.toString();
 String result=" ";
 char[] cArray = convert.toCharArray();
 int decPos = -1;
 int chrsBefore = 0;
 int chrsAfter = 0;
 int zeroesAfter = 0;
 int currentPos = 0;
 boolean zeroStreakAlive = true;

 if (cArray.length>maxChars){
    for (char c : cArray){
        if (c=='.')
            decPos = currentPos;
        else if (decPos == -1)
            chrsBefore++;
        else if (zeroStreakAlive && c=='0'){
            zeroesAfter++;
            chrsAfter++;   
        }
        else
            chrsAfter++;
        currentPos++;
    }

    if (chrsBefore>maxChars)
        result = cArray[0] + "." + cArray[1] + "E+" + (chrsBefore-1);
    else if (zeroesAfter >= maxChars-2)
        result = cArray[zeroesAfter+2] + "." + cArray[zeroesAfter+3] + "E-" + (chrsAfter-2);
    else 
        //your logic here probably using DecimalFormat for a normally rounded number to 6 places(including decimal point if one exists).
 }
 return result;
}
} 
```

这就是我想出的。它并不是包罗万象的，因为有很多案例需要解决。我不确切知道您希望它们如何发挥作用，因此我无法全部完成，但是您应该能够获得想法并以此为起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:53:02.330

如果您只想限制小数位数，一个简单的解决方案是

```
public static String formatDecimal(BigDecimal b, int max) {
    return b.setScale(max, RoundingMode.HALF_EVEN).stripTrailingZeros().toEngineeringString();
} 
```

现在，您还想根据整数部分中的数字来限制小数位数。我认为使用 DecimalFormat 和 MessageFormat 类可以更好地发挥作用，这是我可以提供的，它通过了测试用例，但我不认为它**那么**健壮。您可以尝试创建一个更好的算法来处理所有不同的情况。

```
public static String formatDecimal(BigDecimal b, int max) {
    // trivial case
    String bs = b.stripTrailingZeros().toPlainString();
    if (bs.length() <= max) {
        return bs;
    }
    // determine the max integer = 1.0Emax
    String maxInteger = "1" + StringUtils.repeat("0", max - 1);
    // determine the min fraction = 1.0E-max
    String minFraction = "0." + StringUtils.repeat("0", max - 2) + "1";
    // get the integer part
    String integerPart = String.valueOf(b.intValue());
    // make the pattern like ###.### with the correct repetition
    String pattern = StringUtils.repeat("#", max - integerPart.length()) + "." + StringUtils.repeat("#", max - 1 - integerPart.length());
    // play with Message format, using a choice to determine when to use the exponential format
    MessageFormat fmt = new MessageFormat( //
            "{0,choice," + minFraction + "<{0,number,'0.#E0'}|0.1#{0,number,'" + pattern + "'}|" + maxInteger + "<{0,number,'0.#E0'}}" //
    );
    // time to format the number
    return fmt.format(new Object[] {b});
} 
```

另一个使用 if/else 的解决方案可以像这样开始：

```
public static String formatDecimal(BigDecimal b, int max) {
    // trivial case
    if (b.toPlainString().length() <= max)
        return b.toPlainString();
    else {
        // between 0 and 1, or superior than 1*10^max, better use the exponential notation
        if ((b.compareTo(BigDecimal.ZERO) > 0 && b.compareTo(new BigDecimal("0.01")) < 0) //
                || (b.compareTo(new BigDecimal("1" + StringUtils.repeat("0", max - 1))) > 0)) {
            return new DecimalFormat("#.#E0").format(b);
        } else { // set Scale for fraction, better keep integer part safe
            String sb = b.toPlainString();
            return b.setScale(max - sb.indexOf(".") - 1, RoundingMode.HALF_EVEN).stripTrailingZeros().toPlainString();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T09:01:25.433

我在这里用一种简单的蛮力方法回答我自己的问题，这让我比以前发布的那些方法更不紧张——我希望有一种我不知道的经过充分测试的现有方法。

不幸的是，我的解决方案不能很好地处理问题中的第三个测试，但我决定我可以忍受我的应用程序。事实上，我有 18 个字符可以玩，测试中 6 个字符的限制只是为了让测试更清晰。使用 18 个字符，尽管有前导零，我仍将获得足够的精度，直到 BigDecimal.toString() 在 10^-6 处切换到科学记数法。

此外，这种方法效率低下，但这对我的应用程序来说也不是问题。

```
public static String formatDecimal(BigDecimal number, int maxChars) {
    String s;
    int precision = maxChars;
    do {
        s = number
                .round(new MathContext(precision, RoundingMode.HALF_EVEN))
                .stripTrailingZeros()
                .toString();
        --precision;
    } while (s.length() > maxChars && precision > 0);
    return s;
} 
```

# ruby-on-rails - 获取 ActiveRecord 对象属性的数据库类型

> ID：11039175
> 
> 赞同：1
> 
> 时间：2012-06-14T18:28:43.807
> 
> 标签：ruby-on-rails, ruby-on-rails-3

假设我在 schema.rb 中有这个：

```
create_table "products" do |t|
 t.string   "name",                                           
 t.text     "description"
end 
```

我想要一种方法来找出产品属性的数据库类型是什么。

就像是：`Product.column_type(:name) => "string"`

这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T18:35:26.970

```
Product.columns_hash['name'].type # => :string 
```

注意使用字符串而不是符号。

**关于替代方案：sql_type**

它将逻辑 Rails 类型映射到特定于 DB 的数据类型。对于*一般用途的东西*，我不建议使用它：您的生产数据库引擎将返回与`sql_type`您的开发数据库中相同列的值不同的值（尽管它们都是使用相同的迁移文件创建的）。布尔字段示例：

```
# SQLite mapping:
:boolean => { :name => "boolean" }
# MySQL mapping:
:boolean => { :name => "tinyint", :limit => 1 } 
```

正如您在迁移中指定的那样，在这两种情况下使用`type`都会给您。`:boolean`

# javascript - 从 Rally 构建的 extjs 组合框中，如何获取子 ChangeSets 记录上的字段？

> ID：11039176
> 
> 赞同：3
> 
> 时间：2012-06-14T18:28:45.490
> 
> 标签：javascript, extjs, rally

使用 SDK 2，我创建了一个组合框，让我可以选择构建。我有一个监听器想要对 ChangeSets 数组做一些事情，但该数组只返回属性信息（ref 等）。在过去，我可以在父母身上获取我想要的字段，也可以在孩子身上看到它们。那么，我如何让 ChangeSets 提供修订版呢？

下面是组合框的定义：

```
this.down('#buildSelector').add({
        xtype: 'rallycombobox',
        displayField: 'Number',
        listeners: {
            scope: this,
            select: function(combo, records, eOpts){
                this._buildResults(combo.getRecord().data);//Build
            },
            ready: function(combo, records, eOpts){
                this._buildResults(combo.getRecord().data);//Build
            }
        },
        width: 280,   
        storeConfig: {
            autoLoad: true,
            model: 'Build',
            pagesize: 20, //# of builds displayed in drop down
             sorters: [{
                        property: 'CreationDate',
                        direction: 'DESC'
                      }],

            listeners: {
                load: function(store, records, successful){
                        console.log("dropdown records", records);
                    }
                }
            }
    }); 
```

那个控制台日志给了我这样的东西

```
dropdown records 
  Array[200]
    [0 … 13]
      0: Ext.Class.newClass
        data: Object
        BuildDefinition: Object
        Changesets: Array[2]
          0: Object
            _rallyAPIMajor: "1"
            _rallyAPIMinor: "31"
            _ref: "https://audemo.rallydev.com/slm/webservice/1.31/changeset/1260800.js"
            _refObjectName: "BuildHealthReportRepo:1000"
            _type: "Changeset"
            __proto__: Object
          1: Object 
```

ETC...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T19:11:16.780

您可以通过将带有字段名称数组的 fetch 属性添加到您的 storeConfig 对象来完成此操作。如果您只想获取 Build Number、Changesets 和 Revisions，则属性定义可能如下所示：

```
storeConfig: {
        fetch: ['Number', 'Changesets', 'Revision'],
        autoLoad: true,
        model: 'Build',
        pagesize: 20, //# of builds displayed in drop down
        sorters: [{
                    property: 'CreationDate',
                    direction: 'DESC'
                  }],

        listeners: {
            load: function(store, records, successful){
                console.log("dropdown records", records);
            }
        }
} 
```

# keyboard - 键盘在 oracle vm 虚拟框中不起作用

> ID：11039177
> 
> 赞同：45
> 
> 时间：2012-06-14T18:28:55.020
> 
> 标签：keyboard, virtualbox

我正在我的 Windows 7 系统上安装上述 vm。在安装过程中尝试在 vm 上安装 linux 时，在我按一次 enter 并开始安装后，键盘在 vm 中停止工作，因此我无法完成安装（要求输入 root 密码和其他东西）。

我试图用谷歌搜索并找到解决方案，但各种故障排除提示没有帮助。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2014-02-08T23:15:42.490

关闭虚拟机并将显示模块下的“视频内存”更改为 128 MB。在我的，我忘了增加它，它只有 12 MB，但在增加到 128 MB 之后。有效！

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2018-02-25T20:14:34.460

对我来说，当我按照以下步骤操作时它起作用了：

1.  设置
2.  用户界面
3.  输入下拉菜单
4.  取消选中并再次选中键盘复选框
5.  点击确定

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2020-05-21T22:10:20.700

我有同样的问题，我可以在右键单击文本框然后单击“插入表情符号”后输入

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2019-03-09T17:16:57.643

我是这样解决的：

1.  为您的 VirtualBox 版本安装正确的扩展包
2.  在 VM 中启用 USB 3
3.  关闭所有 VirtualBox 实例
4.  打开外壳并运行

    `VBoxManage setextradata "$NAME" VBoxInternal2/EfiGraphicsResolution X`

    `$NAME`VM 的名称在哪里。

[资源](https://techsprobe.com/macos-mojave/#Fix_Mouse_Keyboard_Error)

PS：源是 Windows，但我在 Ubuntu 上，它也可以

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2019-03-12T17:55:43.157

我在作为主机的 MacO 和作为来宾安装 Ubuntu 上也遇到了这种问题。我认为增加 VM 的可用 RAM 可以解决问题（我一开始只有 1GB，我将其设置为 4GB）。

希望这可以帮助

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-08-06T16:37:39.750

我浪费了很多时间来解决这个问题。我的鼠标和键盘都不起作用，我正在 Linux 上的虚拟 Box 上安装 MacOS Mojave。您只需要从他们的官方网站安装Virtual Box Extension pack->双击并安装它->然后从设置->USB->选择USB-3。重新启动操作系统，这应该是它。有关更多信息，请遵循这个不错的文档： http: [//www.professionaltutorial.com/install-macos-mojave-virtualbox-windows/](http://www.professionaltutorial.com/install-macos-mojave-virtualbox-windows/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-02-08T07:24:01.367

对于 2020 年来到这里并首次安装 Virtual Box 的任何人。如果您将 Windows 10 作为主机系统，则必须禁用所有 Hyper-V 内容。问题可能不是键盘和鼠标不起作用，而是这可能是问题。系统运行非常缓慢，然后停止而不会崩溃。

参考 Virtual Box 支持 [https://forums.virtualbox.org/viewtopic.php?f=1&t=93800](https://forums.virtualbox.org/viewtopic.php?f=1&t=93800)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-29T05:28:58.480

（我使用 Windows 10 作为主机，使用 Ubuntu 作为来宾）我是这样解决的：

1.  下载了旧版本的 VirtualBox（我的键盘在 VB 6.1.12 中无法使用，在阅读了一些帖子后我下载了 VB 6.1.10）

2.  将内存大小（Ram）增加到 2048 MB（默认大小为 1024 MB）

3.  键盘好用！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-05T18:32:23.740

我在 Ubuntu 的各种版本（Ubuntu 是主机系统）上经历过这种情况 - 修复方法是禁用主机上的屏幕保护程序/锁定。希望这对你有用！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-14T14:14:55.047

我尝试了以上所有方法均无济于事。主机已经运行了很长时间并且运行了多个虚拟机。所以我重新启动了主机并重新启动了 VirtualBox。之后键盘正常工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-03-13T06:27:46.717

在 Windows 10 笔记本电脑中。

增加视频内存对我不起作用。增加系统 RAM 工作。

并将我的指点设备更改为多点触控输入。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-08-26T05:40:52.400

您可以检查指针设备的选择。您可能选择了错误的指针设备

# translation - 有没有多种语言的免费在线词典 API (json/xml) 可供选择？

> ID：11039178
> 
> 赞同：80
> 
> 时间：2012-06-14T18:28:57.940
> 
> 标签：translation

是否有任何免费的字典 API 不需要 API 密钥，并允许您在多种源语言和目标语言之间进行选择（尽可能多的，至少是英语、德语、西班牙语、法语......）？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-09T08:38:35.660

你可以试试[http://glosbe.com/a-api](http://glosbe.com/a-api)，它很大——几乎涵盖了所有语言。它允许您访问 JSON/JSONP/XML 格式的数据。为没有密钥的用户设置了一些限制，但您可以通过在客户端使用 JSONP 来克服它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-07-19T16:54:44.230

我认为[维基词典](http://www.wiktionary.org/)（最初建立维基百科的人的字典）很适合这个法案。

**维基词典的 API 文档**：[http ://en.wiktionary.org/w/api.php](http://en.wiktionary.org/w/api.php)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-06-14T19:50:01.673

大多数 API 提供商都需要注册以防止拒绝服务攻击和其他滥用行为。话虽如此，我确实遇到了一个无需注册即可使用的产品：

[Aonaware](http://services.aonaware.com/DictService/) - 此 Web 服务允许您从 dict.org 服务访问字典定义。

# algorithm - 在最后一分钟计算活跃用户的最快/最简单的方法是什么？

> ID：11039180
> 
> 赞同：16
> 
> 时间：2012-06-14T18:28:59.600
> 
> 标签：algorithm, data-structures, time-series

您为 Zynga 工作，并且想要计算不同游戏的当前活跃玩家数量。您的 Web 服务器处理来自许多不同游戏的 ping，并且每个用户都有一个唯一的 GUID。必须能够一次查询一个游戏的活跃用户数。活跃用户是那些在最后一分钟得到 ping 的用户。

日志行连续进入 Web 服务器：

```
10.1.12.13 - - "http://zynga.com/ping?guid=<guid>&game=<gameID>" - 
```

计算活跃用户的最快/最简单的方法是什么？请用一些代码建议一个 45 分钟的答案。

* * *

我的版本

```
// web server interface, every time ping comes in count() will be called
// void count(String gameId, String guid)
// int getNumberActivePlayers(String gameId)

struct Record{
  String gameID;
  String guid;
};

class PingStorage{
private:
  max_heap<long, Record> storage;
public:
  //    O(log(n))
  //  n = total number of elements in storage
  void count(String gameId, String guid){
    long currentTimeStamp = getUnixTimeStamp();
    Record rec ;
    rec.gameId = gameId;
    rec.guid = guid;
    storage.add(currentTimeStamp, rec);
  }
  //N = numner of records in last ,minutes in storage
  //O(N)
  int getNumberActivePlayers(String gameId){
    map<String, Set<string> > game2user;
    long tillTimeStamp = getUnixTimeStampNow() - 60;
    while(true){
      pair<long, Record> rec = storage.getMax(); //O(1)
      if(rec.first <= tillTimeStamp) break;  
      Set<String> temp = game2user[rec.gameid]; //O(1)
      temp.add(rec.userid); //O(log(N)) - O(1)
    }
    return game2user[gameID].size();
  }
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T20:43:40.277

假设这是一个实时解决方案，您可以在 O(1) 中处理 ping 请求，在 O(1) 中生成当前玩家统计信息，并通过牺牲一些准确性来使用 O(num_player) 空间。关键是离散时间。

**概述**

基本思想是将离散的时间间隔表示为对象，并在这些对象中存储以下属性：在此时间间隔内 ping 过但此后未 ping 过的不同玩家的数量。要查询活跃用户数，请计算构成最后一分钟的最后 x 个时间间隔的加权和。

**细节**

首先，选择一个可接受的时间分辨率。在本例中，我选择 15 秒间隔。

维护五个 PingInterval 数据结构来表示其中的五个间隔（跨越比 1 分钟多 1 个间隔）。PingInterval 包含一个属性：计数器。这些 PingInterval 保存在 PingMonitor 中。每次玩家 ping 时，更新 PingMonitor 中的地图，将每个玩家映射到当前时间间隔。当您执行此映射时，请执行以下步骤，以维护 PingIntervals 内的计数（根据我在概述部分中描述的特征）。

*   如果玩家已经映射到一个区间并且它是当前区间，则什么也不做。
*   否则，如果玩家被映射到不是当前区间的区间，
    *   减少旧间隔的计数，
    *   增加当前间隔的计数，
    *   并将该玩家映射到该间隔。
*   否则，如果玩家根本没有映射到某个区间，
    *   增加当前间隔的计数，
    *   将播放器映射到当前间隔。

（如果表示当前时间的 PingInterval 尚不存在，请将最早的 PingInterval 设置为 null，以线程安全的方式创建新的 PingInterval，然后照常继续。）

当要查询活跃用户数时，计算最后五个区间时间间隔的时间加权和。例如，如果您只进入当前时间间隔 5 秒（意味着该时间间隔的下 10 秒尚未发生），则计算此值：2/3 * 最旧时间间隔 + 4 个最新时间间隔的总和。

**其他想法**

五个区间非常保守；我们可以大大增加这个数字以获得更高的准确性（可能每秒一个），它仍然可以为我们节省大量资金。重要的是，我们的时代现在是离散的间隔。这意味着当我们去统计活跃用户的数量时，我们不必查看每个单独的时间（等于用户数量）；相反，我们可以查看我们预定义的 x 个时间箱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T19:07:46.710

我的方法是使用一个双端队列（在本文的其余部分中称为队列），所有 GUID 都被推送到观察到的位置，即按年龄排序。此外，我将使用包含指向队列中存在的任何 GUID 条目的指针的哈希图。

当一个新的 GUID 被推送到队列时，旧的条目（如果有的话）将在 hashmap 中查找，从队列中删除，并将新的条目分配给 hashmap。

随着时间的推移，队列中所有超过年龄阈值的条目都将被弹出（并从哈希图中删除）。

队列的长度（也就是活跃用户的数量）可以作为一个单独的变量来跟踪，以避免每次查询都在队列中跳跃。

要支持多个游戏，只需为每个游戏 ID 添加这样的结构。

复杂性：O(1) 观察的插入/删除（给定一个完美的散列，即没有冲突），O(1) 查询，O(n) 空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:12:18.027

*编辑：我认为这个问题不是要获得“现在*有多少用户活跃”这个问题的实时答案，而是要获得历史值——下午 3:25 有多少用户活跃。我将旧解决方案保留在新解决方案之下：

所以，你想知道现在有多少用户是活跃的，每场比赛都要排队。每当您看到新的日志条目时，找出它属于哪个游戏，并将其添加到游戏队列中。每次添加后，清理队列开头的旧条目（清理时所有超过 1 分钟的条目）。

当询问游戏中的活跃用户数量时，对游戏队列进行相同的清理，并返回队列的深度。

保持将游戏映射到队列的哈希值，您得到一个 O(N) 操作，其中 N 是日志中的行数 - 每行最多处理两次 - 一次用于添加它，一次用于删除它。您还可以在每次添加和查找时进行额外的比较（当确定队列条目*不够*老时），但这是常数时间乘以 N。所以总共 O(N)。

之前对另一个问题的回答：看到没有那么多分钟（每天 1440 分钟），我会为每个游戏创建一个向量，每分钟都有一个插槽。

查看日志文件，为每一行获取时间，将其四舍五入到最接近的分钟，并将 1 添加到数组中的相应插槽。完成后，您将确切知道每分钟每个游戏有多少活跃用户。

复杂度 - O(N)，其中 N 是日志文件中的行数。

要支持多个游戏，只需使用哈希将游戏名称映射到其向量即可。

现在，这假设您只检查整个分钟边界（1:00:00、1:01:00 等）的活动用户。无论如何，这可能是您需要做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T16:06:54.210

这将是我的答案序列：

1.  何必？最简单的方法是按分钟计算有多少用户处于活动状态。知道这些还不够吗？
2.  如果您真的关心最新信息，让我们按秒计算（如 Cheeken 所述）。这将精确到几分之一秒。
3.  好的，如果实时准确性是“必要的”，并且您想就数据结构采访我，让我们使用按上次活动时间评分的一堆客户（如尤达大师所述）。
4.  如果需要实时准确性，并且我们要在生产中执行此操作，那么让我们使用数据结构服务器 Redis。我们维护一组按上次活动时间评分的分类客户[。](http://redis.io/commands#sorted_set)`zcount`我们可以使用该命令查询在最后一分钟或最后一小时内有多少客户处于活动状态。这是有用且可靠的。

# iphone - 保持 iPhone 横向旋转？

> ID：11039182
> 
> 赞同：0
> 
> 时间：2012-06-14T18:29:02.493
> 
> 标签：iphone, xcode, rotation

我正在制作一个仅处于横向模式的应用程序，但我发现当我旋转设备时，应用程序会自动旋转到该方向。我在项目摘要中指定我只想要“Landscape Left”，然后在我放置的每个视图控制器中

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
 {
 return UIInterfaceOrientationLandscapeLeft; 
 } 
```

虽然当我单击向右或向左旋转时应用程序以横向启动，但模拟器会按原样进入纵向，但随后应用程序也会自动旋转。即使设备旋转，如何让应用程序保持横向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:35:15.483

除了你所做的，而不是你的`shouldAutorotateToInterfaceOrientation`功能，使用以下

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationLandscapeLeft);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:47:05.417

我想你误解了`shouldAutorotateToInterfaceOrientation:`它的用途。它**不是**问你*“你支持什么方向？”* ，它**在**问你*“你支持这个界面方向吗？”* . 所以你的答案应该是`YES`or `NO`。

每次它决定改变方向之前都会问你这个问题，所以你可以改变主意，有时支持它，有时不支持（如果你真的想要的话）。

例如，要支持所有方向：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
} 
```

...仅支持横向：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return((interfaceOrientation == UIInterfaceOrientationLandscapeLeft) ||
        (interfaceOrientation == UIInterfaceOrientationLandscapeRight));
} 
```

...仅支持横向左（如您所愿）：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return(interfaceOrientation == UIInterfaceOrientationLandscapeLeft);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-14T18:33:57.727

在您的 info.plist 中，您需要为 设置密钥`UISupportedInterfaceOrientations`，如下所示：

![在此处输入图像描述](../Images/7af0ebac41ef67e9ab17470fa373c359.png)

除了您的`shouldAutorotateToInterfaceOrientation:`方法之外，此限制是我的应用程序仅在横向模式下运行。如果您支持横向左/右。您的方法应如下所示：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
return  (interfaceOrientation == UIInterfaceOrientationLandscapeLeft || interfaceOrientation == UIInterfaceOrientationLandscapeRight);
} 
```

# cakephp - 如何让 Paginator->numbers() 显示 1

> ID：11039184
> 
> 赞同：0
> 
> 时间：2012-06-14T18:29:03.267
> 
> 标签：cakephp, hyperlink, navigation, numbers, paginator

我不确定这是否像我想的那么简单，但是当我的表只有一个页面时，我想让分页器显示 1。

我在想有可能做这样的事情：

```
<p> <?php echo $this->Paginator->prev('« Previous', null, null, array('class' => 'disabled')); ?>;
    <?php if(1 >= $this->Paginator->numbers())
                echo 1;
            else
                echo $this->Paginator->numbers();   ?>
    <?php echo $this->Paginator->next('Next »', null, null, array('class' => 'disabled')); ?>; </p> 
```

但后来我意识到 paginator->numbers() 以 1|2|3 等形式返回链接。

目前分页器将显示：

```
<<Previous Next>> 
```

当表格中只有一页但有 2 页或更多页时，它会显示

```
<<Previous 1|2 Next>> 
```

我想让它始终显示一个数字，包括 1 用于单个页表。

任何帮助都会很棒。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T23:36:04.553

您可以做的是创建一个名为的元素`pagination.ctp`并将以下内容放入其中：

```
<p>
<?php
    echo $this->Paginator->prev('« Previous', null, null, array('class' => 'disabled'));
    $numbers = $this->Paginator->numbers();
    if (empty($numbers)) {
        $numbers = 1; // or any markup you need
    }
    echo $numbers;
    echo $this->Paginator->next('Next »', null, null, array('class' => 'disabled')); ?>
</p> 
```

然后，每当您需要：

```
<?php echo $this->element('pagination'); ?> 
```

# haskell - 如何生成用于 Data.VectorSpace 的多态“单位标量”

> ID：11039185
> 
> 赞同：3
> 
> 时间：2012-06-14T18:29:04.913
> 
> 标签：haskell, algebra, type-families

所以我正在使用[Data.VectorSpace](http://hackage.haskell.org/packages/archive/vector-space/0.8.1/doc/html/Data-VectorSpace.html)并且我正在尝试扩展[force-layout](http://hackage.haskell.org/package/force-layout-0.1.0.1)。

现在我想产生一个多态的'1'-标量。也就是说，如果将标量与向量相乘，则无论该向量的类型（参数）如何，都会产生相同的向量。可能吗？有没有有用的解决方法？

这是一个更具体的代码示例（它从我在[这里](https://stackoverflow.com/questions/10935985/making-vectorspace-scalar-instance-of-eq)使用的代码继续）：

```
data Particle v = Particle { _pos   :: Point v
                           , _vel   :: v
                           , _force :: v
                           , _mass  :: Scalar v
                           }
-- .. standalone Show and Eq omitted 
initParticle :: AdditiveGroup v => Point v -> Particle v
initParticle p = Particle p zeroV zeroV unitScalar

unitScalar = undefined

-- Should always be true:
testInit :: Point (Double,Double) -> Bool
testInit p = ((_mass (initParticle p)) == 1::Double) 
```

如何在上面定义“unitScalar”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T19:36:37.860

您定义的上下文是不可能的；既然你说那`v`是一个`AdditiveGroup`，那就是它的全部，因此没有其他属性可以归因于`v`。

您当然可以定义其他定义单位值的类：

```
{-# LANGUAGE FlexibleContexts #-}
module Main (main) where

import Data.VectorSpace 
```

如果我们想在数学上严格，我们可能会做以下事情；但是，这在 Haskell 中会产生不良后果，因为只能为一种类型定义一个 Monoid，因此下面的解决方案可能更好。

```
-- BAD SOLUTION! (Arguably)
import Data.Monoid

instance Monoid Double where
  mempty = 1
  mappend = (*) 
```

相反，我们定义了一个general `MultiplicativeGroup`，它也是乘法的幺半群。

```
class MultiplicativeGroup a where
  unit :: a
  multiply :: a -> a -> a
  reciprocal :: a -> a

instance MultiplicativeGroup Double where
  unit = 1
  multiply = (*)
  reciprocal = (1 /) 
```

现在我们可以实现工作示例：

```
data Particle v =
  Particle -- Removed Point for this example since I don't have its definition
  { _vel :: v
  , _force :: v
  , _mass :: Scalar v
  }

-- We need VectorSpace because there needs to be a Scalar type associated with v
-- Also, this context requires you to use FlexibleContexts, which should be
-- harmless
initParticle :: (VectorSpace v, MultiplicativeGroup (Scalar v))
             => Particle v
initParticle = Particle zeroV zeroV unit

-- Works as expected:
main :: IO ()
main = print $ ((_mass (initParticle :: Particle Double)) == (1::Double)) 
```

顺便说一句，您当然可以替换`MultiplicativeGroup`with`Num`和替换`unit`with `1`，但这会给您带来比您想要的更多的功能。

**PS。**你应该看看优秀的[`algebra`包](http://hackage.haskell.org/package/algebra)，它为你做这种事情更严格。在它之上实施力求解器不会太难。

# javascript - Fresh Handlebars install 在第一次运行时产生 ReferenceError

> ID：11039188
> 
> 赞同：1
> 
> 时间：2012-06-14T18:29:12.103
> 
> 标签：javascript, node.js

我正在尝试使用 Handlebars，并得到一个不知疲倦的错误。尝试了本地安装和全局安装。

```
$ sudo npm install -g handlebars
$ handlebars
/usr/local/lib/node_modules/handlebars/lib/handlebars/base.js:8
Handlebars.VERSION = "1.0.beta.5";
^
ReferenceError: Handlebars is not defined
    at /usr/local/lib/node_modules/handlebars/lib/handlebars/base.js:8:1
    at Object.<anonymous> (/usr/local/lib/node_modules/handlebars/lib/handlebars/base.js:100:1)
    at Module._compile (module.js:446:26)
    at Object..js (module.js:464:10)
    at Module.load (module.js:353:31)
    at Function._load (module.js:311:12)
    at Module.require (module.js:359:17)
    at require (module.js:375:17)
    at Object.<anonymous> (/usr/local/lib/node_modules/handlebars/lib/handlebars.js:1:80)
    at Module._compile (module.js:446:26) 
```

其他一些有用的信息：

```
$ node --version
v0.6.19
$ npm --version
1.1.24 
```

我还尝试编辑文件 handlebars/base.js。我将第一行更改为阅读

```
Handlebars = this.Handlebars = {} 
```

这暂时消除了我收到的第一个错误。但是随后弹出了一个错误：

```
$ handlebars
module.js:337
    throw new Error("Cannot find module '" + request + "'");
          ^
Error: Cannot find module './parser'
    at Function._resolveFilename (module.js:337:11)
    at Function._load (module.js:279:25)
    at Module.require (module.js:359:17)
    at require (module.js:375:17)
    at Object.<anonymous> (/usr/local/lib/node_modules/handlebars/lib/handlebars/compiler/base.js:1:80)
    at Module._compile (module.js:446:26)
    at Object..js (module.js:464:10)
    at Module.load (module.js:353:31)
    at Function._load (module.js:311:12)
    at Module.require (module.js:359:17) 
```

是否还有其他人在安装 Handlebars 时遇到问题，或者有关于如何启动和运行安装的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:47:28.803

您是尝试使用命令行把手还是尝试导入模块把手？

第一个将要求您在安装包时使用 -g 参数。后者将要求您安装不带 -g 参数的车把。-g 参数仅用于在您的 shell 中创建命令/程序的包。

因此，如果您使用命令行编译一些文件，您可以：

```
npm install -g handlebars 
```

壳

```
$ handlebars # should output all the command line options. 
```

如果您想在您的模块之一中使用它，您可以：

```
npm install handlebars 
```

文件.js

```
var Handlebars = require('handlebars');
console.log(handlebars); // should output all the methods. 
```

# java - 如何使用 JGAP 设置具有非重复等位基因的染色体？

> ID：11039189
> 
> 赞同：0
> 
> 时间：2012-06-14T18:29:14.070
> 
> 标签：java, unique, jgap

我正在为我的代码使用 JGAP，我想像这样评估染色体：

```
Evaluation 0: 

 1 2 3 4 5 6 7 8 9

Evaluation 1: 

 3 5 2 1 4 6 7 8 9 
```

到目前为止，我得到的染色体具有重复的等位基因，如下所示：

```
Evaluation 1:

 3 3 5 6 7 8 9 9 1 
```

我可以使用任何配置来获得具有非重复等位基因的染色体吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-17T19:40:35.447

我假设您正在谈论生成 GA 的初始种群，您应该做的是创建多个随机顺序的某个值列表。

有很多方法可以做到这一点，这里有两种可能性：

1.  创建一个包含所有可能值的数组，将其打乱，将其复制到新染色体，重复...（您可以为每个可能值分配一个随机实值，然后按随机值对值进行排序）。
2.  将所有值放在一个列表中，从列表中选择一个随机项目，将其删除并将其添加到染色体中，直到列表中没有更多值，重复...

# php - cookie设置的PHP头部修改解决方案

> ID：11039192
> 
> 赞同：-5
> 
> 时间：2012-06-14T18:29:35.333
> 
> 标签：php, cookies, header

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

我正在为我的本地数据库使用 phpmyadmin，并使用 3 个 php 页面来操作管理员面板，以便能够查看、编辑和删除工作线索。这是 adminpanel.php 页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/About.dwt" codeOutsideHTMLIsLocked="false" -->
    <head>
        <!-- InstanceBeginEditable name="doctitle" -->
            <title>.: Nokee Kwe - Admin Panel :.</title>
        <!-- InstanceEndEditable -->
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" type="text/css" media="screen" href="layout.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="style.css" />
         <script type="text/javascript">
//<![CDATA[
    if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1)
    document.write('<link rel=\"stylesheet\" type=\"text/css\" href=\"stylechr.css\" />');
    else if (navigator.userAgent.toLowerCase().indexOf('opera') > -1)
    document.write('<link rel=\"stylesheet\" type=\"text/css\" href=\"styleopr.css\" />');
    else
    document.write('<link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\" />');
//]]>
    </script>
    <!--[if lte IE 8]>
    <link rel="stylesheet" type="text/css" href="ie.css" />
<![endif]-->
<!--[if IE 9]>
    <link rel="stylesheet" type="text/css" href="ie9.css" />
<![endif]--> 
<script type="text/javascript" src="jquery-1.7.2.js"></script>
<style type="text/css">
form
{
    margin: 0 auto;
}
</style>
</head>
<body>
<div class="wrapper">
    <div class="header" id="ieHead">
                <div class="splashTop">
<!--[if lte IE 8]>
                    <img src="images/eagle.png" alt="eagle" />
                    <![endif]-->
<!--[if IE 9]>
                    <img src="images/eagle.png" alt="eagle" />
                    <![endif]-->
                        <div class="splashFAX" id="ieFax">Telephone: (519) 667-7088 • Facsimile: (519) 667-4872</div>
                        <div class="splashADDRESS" id="ieAddress">104-1069 Wellington Road South • London, Ontario • N6E 2H6</div>
                       <br/>
                       <span class="splashShare">
                        <span class="facebook"><script type="text/javascript">
//<![CDATA[
(function() {
    document.write('<fb:like href="www.facebook.com/NokeeKwe?sk=info" layout="button_count" show_faces="" width="50" action="like" font="tahoma" colorscheme="light"></fb:like>');
    var s = document.createElement('SCRIPT'), s1 = document.getElementsByTagName('SCRIPT')[0];
    s.type = 'text/javascript';
    s.async = true;
    s.src = 'http://connect.facebook.net/en_US/all.js#xfbml=1';
    s1.parentNode.insertBefore(s, s1);
})();
//]]>
</script>
                        </span><span class="twitter"><script type="text/javascript">
//<![CDATA[
(function() {
    document.write('<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="NokeeKwe">Tweet</a>');
    var s = document.createElement('SCRIPT'), s1 = document.getElementsByTagName('SCRIPT')[0];
    s.type = 'text/javascript';
    s.async = true;

    s.src = 'http://platform.twitter.com/widgets.js';
    s1.parentNode.insertBefore(s, s1);
})();
//]]>
</script></span>
                    </span>
                    </div>
                <div id="splashMain">
<object type="application/x-shockwave-flash" 
data="wheelNew.swf" 
width="400" height="350" style="float: right; position: absolute; margin: -10px 0 0 425px;" id="flashWheel">
<param name="movie" value="wheelNew.swf" />
<param name="quality" value="high"/>
<param name="wmode" value="transparent"/>
</object>
        <p class="title" id="em">About<br /> Nokee Kwe</p>
                                <p class="subtitle" id="emSub">Serving both Aboriginal<br/> and non-Aboriginal populations since 1978.</p>

                       </div>
                       <div id="navOuter">
                            <div id="nav">
                                <a href="about.html" target="_self"><span class="buttonNav" id="aboutBtn">About Us</span></a>
                                <a href="career.html" target="_self"><span class="buttonNav" id="cdBtn">Career Directions</span></a>
                                <a href="nlcentre.html" target="_self"><span class="buttonNav" id="nlcBtn">Native Education Centre</span></a>
                                <a href="index.html" target="_self"><span class="buttonNav" id="homeBtn">Home</span></a>
                            </div>
                       </div>
            </div>
<div class="wideBox">
<form action="AdminPanel.php" method="get">
    <p><button name="jobLead" value="addJob">+</button><button name="jobLead" value="viewJobs">&</button></p>
    </form>
    <?php
    if (isset($_GET['jobLead']))
    {
            switch($_GET['jobLead'])
            {
                case 'addJob':
                    echo "<META HTTP-EQUIV='Refresh' Content='0; URL=addJob.php'>";
                    break;
                case 'viewJobs':
                    echo "<META HTTP-EQUIV='Refresh' Content='0; URL=viewJobs.php'>";
                    break;
                default:

                    break;

            }
    }
    ?></div>
<div class="push"></div>
</div>
<div class="footer">
            <table width="900" border="0" cellspacing="0" cellpadding="0" class="footer-Links">
                <tr>
                    <td height="20" colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td width="120" height="80" align="left" valign="middle" style="padding-left:40px;">
                        <a href="board.html">Board</a><br />
                        <a href="sponsors.html">Sponsors</a><br/>
                        <a href="funders.html">Funders</a><br/>
                        <a href="partners.html">Partners</a>
                    </td>
                    <td width="120" height="80" align="left" valign="middle">
                        <a href="history.html">History</a><br />
                        <a href="vision.html">Vision</a><br />
                        <a href="mission.html">Mission</a>
                    </td>
                    <td width="200" height="80" align="left" valign="middle">
                    <a href="contact.html">Contact Nokee Kwe</a><br/>
                        <a href="career.html">Career Directions</a><br />
                        <a href="nlcentre.html">Native Education Centre</a>
                    </td>
                    <td height="100">
                        <a href="index.html"><img src="images/bottom/nokeekwe_logo.png" alt="" width="350" height="80" border="0"/></a>
                    </td>
                </tr>
            </table>
        </div>
                <!-- Website Tracking Scripts -->
                <script type="text/javascript">
                    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
                    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
                </script>
                <script src="A%20CSS%20Sticky%20Footer_files/ga.js" type="text/javascript"></script>
                <script type="text/javascript">
                    var pageTracker = _gat._getTracker("UA-271290-1");
                    pageTracker._initData();
                    pageTracker._trackPageview();
                </script>

</body>
</html> 
```

当您转到 viewJobs.php 时：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/About.dwt" codeOutsideHTMLIsLocked="false" -->
    <head>
        <!-- InstanceBeginEditable name="doctitle" -->
            <title>.: Nokee Kwe - Admin Panel :.</title>
        <!-- InstanceEndEditable -->
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" type="text/css" media="screen" href="layout.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="style.css" />
         <script type="text/javascript">
//<![CDATA[
    if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1)
    document.write('<link rel=\"stylesheet\" type=\"text/css\" href=\"stylechr.css\" />');
    else if (navigator.userAgent.toLowerCase().indexOf('opera') > -1)
    document.write('<link rel=\"stylesheet\" type=\"text/css\" href=\"styleopr.css\" />');
    else
    document.write('<link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\" />');
//]]>
    </script>
    <!--[if lte IE 8]>
    <link rel="stylesheet" type="text/css" href="ie.css" />
<![endif]-->
<!--[if IE 9]>
    <link rel="stylesheet" type="text/css" href="ie9.css" />
<![endif]--> 
<script type="text/javascript" src="jquery-1.7.2.js"></script>
<style type="text/css">
form
{
    margin: 0 auto;
}
</style>
</head>
<body>
<div class="wrapper">
    <div class="header" id="ieHead">
                <div class="splashTop">
<!--[if lte IE 8]>
                    <img src="images/eagle.png" alt="eagle" />
                    <![endif]-->
<!--[if IE 9]>
                    <img src="images/eagle.png" alt="eagle" />
                    <![endif]-->
                        <div class="splashFAX" id="ieFax">Telephone: (519) 667-7088 • Facsimile: (519) 667-4872</div>
                        <div class="splashADDRESS" id="ieAddress">104-1069 Wellington Road South • London, Ontario • N6E 2H6</div>
                       <br/>
                       <span class="splashShare">
                        <span class="facebook"><script type="text/javascript">
//<![CDATA[
(function() {
    document.write('<fb:like href="www.facebook.com/NokeeKwe?sk=info" layout="button_count" show_faces="" width="50" action="like" font="tahoma" colorscheme="light"></fb:like>');
    var s = document.createElement('SCRIPT'), s1 = document.getElementsByTagName('SCRIPT')[0];
    s.type = 'text/javascript';
    s.async = true;
    s.src = 'http://connect.facebook.net/en_US/all.js#xfbml=1';
    s1.parentNode.insertBefore(s, s1);
})();
//]]>
</script>
                        </span><span class="twitter"><script type="text/javascript">
//<![CDATA[
(function() {
    document.write('<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="NokeeKwe">Tweet</a>');
    var s = document.createElement('SCRIPT'), s1 = document.getElementsByTagName('SCRIPT')[0];
    s.type = 'text/javascript';
    s.async = true;

    s.src = 'http://platform.twitter.com/widgets.js';
    s1.parentNode.insertBefore(s, s1);
})();
//]]>
</script></span>
                    </span>
                    </div>
                <div id="splashMain">
<object type="application/x-shockwave-flash" 
data="wheelNew.swf" 
width="400" height="350" style="float: right; position: absolute; margin: -10px 0 0 425px;" id="flashWheel">
<param name="movie" value="wheelNew.swf" />
<param name="quality" value="high"/>
<param name="wmode" value="transparent"/>
</object>
        <p class="title" id="em">About<br /> Nokee Kwe</p>
                                <p class="subtitle" id="emSub">Serving both Aboriginal<br/> and non-Aboriginal populations since 1978.</p>

                       </div>
                       <div id="navOuter">
                            <div id="nav">
                                <a href="about.html" target="_self"><span class="buttonNav" id="aboutBtn">About Us</span></a>
                                <a href="career.html" target="_self"><span class="buttonNav" id="cdBtn">Career Directions</span></a>
                                <a href="nlcentre.html" target="_self"><span class="buttonNav" id="nlcBtn">Native Education Centre</span></a>
                                <a href="index.html" target="_self"><span class="buttonNav" id="homeBtn">Home</span></a>
                            </div>
                       </div>
            </div>
<div class="wideBox">
<?php
        $jobID = 0;
        $rows = 0;
        $errors = 0;
        $DBConnect = @mysql_connect("localhost", "root");

        if($DBConnect === FALSE)
        {
            echo "<p>Unable to connect to the database server. " .
            "Error code " . mysql_errno() . ": " .
            mysql_error() . "</p>\n";
            $errors++;
        }
        else
        {
            $DBName = "nokeekwe";
            $result = @mysql_select_db($DBName, $DBConnect);

            if($result === FALSE)
            {
                echo "<p>Unable to select the database. " .
                "Error code " . mysql_errno($DBConnect) . ": " .
                mysql_error($DBConnect) . "</p>\n";
                $errors++;
            }
        }
        if($DBConnect !== FALSE)
        {
            $jobID = 0;
            $errors = 0;
            $title = "";
            $desc = "";
            $req = "";
            $employer = "";
            $phone = "";
            $fax = "";
            $email = "";
            $address = "";
            $TableName = "tbljobs";
            $SQLstring = "SELECT * FROM tbljobs";
            $QueryResult = @mysql_query($SQLstring, $DBConnect);

            while(($Row = mysql_fetch_row($QueryResult)) !== FALSE)
            {
                $jobID = $Row[0];
                setcookie("jobID", $jobID);
                echo "<table>\n";
                echo "<tr><td>Job ID #: $Row[0]</td></tr>\n";
                echo "<tr><td>Job Title: $Row[1]</td></tr>\n";
                echo "<tr><td>Job Description: $Row[2]</td></tr>\n";
                echo "<tr><td>Job Requirements: $Row[3]</td></tr>\n";
                echo "<tr><td>Employer: $Row[4]</td></tr>\n";
                echo "<tr><td>Phone: <br /> $Row[5]</td></tr>\n";
                echo "<tr><td>Fax: <br /> $Row[6]</td></tr>\n";
                echo "<tr><td>Email: <br /> $Row[7]</td></tr>\n";
                echo "<tr><td>Address: <br /> $Row[8]</td></tr>\n";
                echo "<form action='editJobs.php' method='request'><button name='func' value='edit'>Edit</button><button name='func' value='delete'>Delete</button></form></tr>\n";
                echo "</table>\n";;

            }   
        }
        $rows =  mysql_num_rows($QueryResult);
        if($rows == 0)
        {
            echo "no jobs to show\n";
        }
        mysql_close($DBConnect);
?>
</div>
<div class="push"></div>
</div>
<div class="footer">
            <table width="900" border="0" cellspacing="0" cellpadding="0" class="footer-Links">
                <tr>
                    <td height="20" colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td width="120" height="80" align="left" valign="middle" style="padding-left:40px;">
                        <a href="board.html">Board</a><br />
                        <a href="sponsors.html">Sponsors</a><br/>
                        <a href="funders.html">Funders</a><br/>
                        <a href="partners.html">Partners</a>
                    </td>
                    <td width="120" height="80" align="left" valign="middle">
                        <a href="history.html">History</a><br />
                        <a href="vision.html">Vision</a><br />
                        <a href="mission.html">Mission</a>
                    </td>
                    <td width="200" height="80" align="left" valign="middle">
                    <a href="contact.html">Contact Nokee Kwe</a><br/>
                        <a href="career.html">Career Directions</a><br />
                        <a href="nlcentre.html">Native Education Centre</a>
                    </td>
                    <td height="100">
                        <a href="index.html"><img src="images/bottom/nokeekwe_logo.png" alt="" width="350" height="80" border="0"/></a>
                    </td>
                </tr>
            </table>
        </div>
                <!-- Website Tracking Scripts -->
                <script type="text/javascript">
                    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
                    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
                </script>
                <script src="A%20CSS%20Sticky%20Footer_files/ga.js" type="text/javascript"></script>
                <script type="text/javascript">
                    var pageTracker = _gat._getTracker("UA-271290-1");
                    pageTracker._initData();
                    pageTracker._trackPageview();
                </script>

</body>
</html> 
```

您会在 viewJobs.php 页面的顶部看到此错误：

警告：无法修改标头信息 - 标头已由第 143 行 C:\xampp\htdocs\NokeeKweSite\viewJobs.php 中的（输出从 C:\xampp\htdocs\NokeeKweSite\viewJobs.php:98 开始）发送

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:40:53.080

我没有阅读你所有的代码，但你可以缓冲你的输出：

```
ob_start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:41:53.707

你不能做

```
 setcookie("jobID", $jobID); 
```

在数据已经被推送到浏览器之后。

您正在尝试在 mysql_fetch 循环中设置 cookie。

不要呼应表格，但要..

```
<?php
    $jobID = 0;
    $rows = 0;
    $errors = 0;
    $DBConnect = @mysql_connect("localhost", "root");

    if($DBConnect === FALSE)
    {
        $str = "<p>Unable to connect to the database server. " .
        "Error code " . mysql_errno() . ": " .
        mysql_error() . "</p>\n";
        $errors++;
    }
    else
    {
        $DBName = "nokeekwe";
        $result = @mysql_select_db($DBName, $DBConnect);

        if($result === FALSE)
        {
            $str = "<p>Unable to select the database. " .
            "Error code " . mysql_errno($DBConnect) . ": " .
            mysql_error($DBConnect) . "</p>\n";
            $errors++;
        }
    }
    if($DBConnect !== FALSE)
    {
        $jobID = 0;
        $errors = 0;
        $title = "";
        $desc = "";
        $req = "";
        $employer = "";
        $phone = "";
        $fax = "";
        $email = "";
        $address = "";
        $TableName = "tbljobs";
        $SQLstring = "SELECT * FROM tbljobs";
        $QueryResult = @mysql_query($SQLstring, $DBConnect);

        while(($Row = mysql_fetch_row($QueryResult)) !== FALSE)
        {
            $jobID = $Row[0];
            setcookie("jobID", $jobID);
            $str .= "<table>\n";
            $str .= "<tr><td>Job ID #: $Row[0]</td></tr>\n";
            $str .= "<tr><td>Job Title: $Row[1]</td></tr>\n";
            $str .= "<tr><td>Job Description: $Row[2]</td></tr>\n";
            $str .= "<tr><td>Job Requirements: $Row[3]</td></tr>\n";
            $str .="<tr><td>Employer: $Row[4]</td></tr>\n";
            $str .="<tr><td>Phone: <br /> $Row[5]</td></tr>\n";
            $str .="<tr><td>Fax: <br /> $Row[6]</td></tr>\n";
            $str .="<tr><td>Email: <br /> $Row[7]</td></tr>\n";
            $str .="<tr><td>Address: <br /> $Row[8]</td></tr>\n";
            $str .="<form action='editJobs.php' method='request'><button name='func' value='edit'>Edit</button><button name='func' value='delete'>Delete</button></form></tr>\n";
            $str .="</table>\n";;

        }   
    }
    $rows =  mysql_num_rows($QueryResult);
    if($rows == 0)
    {
        $str .="no jobs to show\n";
    }
    mysql_close($DBConnect);
?> 
```

将该位移动到页面的最顶部。

后，

```
<div class="wideBox"> 
```

添加：

```
<?=$str;?> 
```

这将防止在您设置 cookie 之前将信息发送到浏览器。

此外，您设置的 cookie 在 MySQL 循环中并不是一个好主意。如果您返回多行，您所做的就是将其设置为返回的最后一行的值。

# java - Java ORM 建议

> ID：11039196
> 
> 赞同：1
> 
> 时间：2012-06-14T18:29:51.693
> 
> 标签：java, orm

我是一名长期的前端开发人员，需要用 Java 做一些后端工作。我熟悉 CF 和 .Net 中的数据库访问技术，但在 Java 方面没有太多经验。我正在构建一个必须由我自己或经验不足的开发人员支持的应用程序。

是否有一个相当简单的设置和易于理解的 Java 数据库访问系统？我觉得 Hibernate 对我的团队来说太过分了，但是直接使用 JDBC 会让我重新发明轮子。

在此先感谢，罗伯特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T20:45:39.947

JPA/Hibernate 有许多更易于使用的替代方案。因为我是作者，所以我偏爱[sormula 。](http://www.sormula.org)您有几个使用 sormula 的选项，包括[零配置](http://www.sormula.org/zero-config/)、[基于 DAO](http://www.sormula.org/example1dao/)、[活动记录](http://www.sormula.org/activerecord/)或[自定义](http://www.sormula.org/example3a/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-17T19:14:41.617

试试 ActiveJDBC：http: [//javalite.io/activejdbc](http://javalite.io/activejdbc)。它是 Java 中的高性能轻量级 ActiveRecord 实现。随附您需要的一切（可能还有更多）。快速示例：

```
CREATE TABLE people (
  id  int(11) NOT NULL auto_increment PRIMARY KEY,
  first_name VARCHAR(56) NOT NULL,
  last_name VARCHAR(56)); 
```

对应型号：

```
public class Person extends Model {} 
```

询问：

```
List<Person> marks = Person.where("name = ?", "Mark"); 
```

节省：

```
Person p = new Person();
p.set("first_name", "John", "last_name", "Doe").saveIt(); 
```

还有更多内容，请查看：http: [//javalite.io/documentation](http://javalite.io/documentation)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:59:22.293

尝试不同的东西，看看 JDO。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T19:45:23.947

正如 Daniel 所建议的那样，我个人在许多项目中都使用了 MyBatis，它很棒。简单来说，MyBatis 是把你的 SQL 查询的结果表映射到 Java 对象上，所以你还是需要写很多 SQL。

在我看来，如果你的数据库模式不能很好地符合面向对象的设计，MyBatis 会很棒。我从事的一个项目有遗留数据库模式，需要我编写递归 SQL 来检索数据，而 MyBatis 在这方面工作得非常好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T20:40:22.353

> 是否有一个相当简单的设置和易于理解的 Java 数据库访问系统？

我的[ORMLite 包](http://ormlite.com/)旨在满足这些特定要求——在 JDBC 之上的一个简单层。您可以使用注释或以编程方式配置数据库实体。在尝试保持 KISS 的同时支持一些中级 ORM 功能。

样本实体：

```
@DatabaseTable(tableName = "accounts")
public class Account {
    @DatabaseField(id = true)
    private String name;
    ... 
```

示例用法：

```
// this uses h2 but you can change it to match your database
ConnectionSource connectionSource =
       new JdbcConnectionSource("jdbc:h2:mem:account");
Dao<Account,String> accountDao =
       DaoManager.createDao(connectionSource, Account.class);
// create new table
TableUtils.createTable(connectionSource, Account.class);
// persist an instance of Account
Account account = new Account("Jim Smith");
accountDao.create(account); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-20T20:05:32.927

您可以尝试基于域对象的键值架构的[Ujorm框架。](http://ujorm.org/)主要特点：

*   java 编译器发现数据库查询中的大部分语法错误
*   无需XML配置即可通过java源代码轻松配置ORM模型
*   可选支持延迟加载或关系的一请求数据加载
*   数据库表、列和索引可以在运行时根据 Java 元模型可选地更新
*   没有代理或二进制修改的业务对象
*   非常轻量级的框架，在运行时没有库依赖
*   很棒的演出

示例代码：

```
 Criterion<Item> crn1, crn2, criterion;  
 crn1 = Item.ID.whereGe(1L);  
 crn2 = Item.ORDER.add(NOTE).whereEq("My order");  
 criterion = crn1.and(crn2);  

 Session session = ormHandler.createSession();  
 for (Item item : session.createQuery(criterion)) {  
    Date created = item.getOrder().getDate();  
    System.out.println( item + " : " + created );  
 }
 session.close(); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-06-14T19:09:13.893

为 MyBatis +1。如果您想完全控制您使用的 SQL，这是一个不错的选择。

# c++ - 位图边界矩形算法 C++

> ID：11039197
> 
> 赞同：0
> 
> 时间：2012-06-14T18:29:54.903
> 
> 标签：c++, algorithm, colors, bitmap, pixel

我目前将位图像素数据存储在一个字符数组中。我想知道根据图像的边界框裁剪图像的最有效算法是什么。

我在下面提供了一个相对准确的示例来说明我想要实现的目标。基于基本“像素颜色”。

[边界框示例](http://imageshack.us/photo/my-images/88/22617808.jpg)

![边界框示例](../Images/e87261036ad21d15fa4659de5c7547ab.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T20:21:32.073

蛮力很好，但你可以更好地使用加速`StretchBlt`来计算水平和垂直投影。

获取位图，将其绘制到一个 1 像素高的全宽矩形上。

获取位图，将其绘制到一个 1 像素宽的全高矩形上。

两者都必须处理整个图像，但将使用高度并行的 GPU 加速渲染来完成。

从这些计算界限。

好的，如果整列的平均值恰好是背景颜色，则结果可能会出现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:39:59.617

好吧，对于具有已知输入格式的如此简单的东西（即，图像中只有一个与背景之间具有高对比度的圆圈），您可以很容易地暴力破解它。只需遍历图像数据并寻找这些对比度差异。保存最顶部、最左侧、最右侧和最底部的位置，您就完成了。

如果图像不是这样简单的格式，那么您将需要更高级的东西，例如 [斑点检测算法](http://en.wikipedia.org/wiki/Blob_detection)。

编辑：仅供参考，前段时间我写了这个蛮力算法来做一些非常相似的事情。它远非完美且没有高度优化，尽管它很简单并且方法应该清晰。我将在这里发布整个内容（不要太苛刻地评价我；我是几年前在自学 C# 时写的）。该算法使用强度阈值来查找圆（与对比度相反，我的输入非常明确）。

```
/// <summary>
/// Locates the spot of light on the image and returns an AnalysisResults object.
/// </summary>        
unsafe private Rectangle AnalyzeImage( )
{
    // function assumes 24bpp RGB format
    Bitmap image = m_originalImage;
    if ( image.PixelFormat != PixelFormat.Format24bppRgb )
    {
        throw new ArgumentException( "Image format must be 24bpp RGB" );
    }

    // using the GDI+ GetPixel method is too slow for a 
    // 1280x1024 image, so get directly at the image buffer instead.                    
    GraphicsUnit unit = GraphicsUnit.Pixel;
    imageRect = Rectangle.Truncate( image.GetBounds( ref unit ) );                

    BitmapData data = image.LockBits( imageRect, ImageLockMode.ReadWrite, image.PixelFormat );

    int intensityThreshold = IntensityThreshold;
    // initialize 'top' to -1 so that we can check if it has been set before setting it.
    // once a valid value for 'top' is found we don't need to set it again.
    int top = -1;

    // search for the left point starting at a high value so that we can simply
    // pull it towards the left as we find pixels inside of the spot.
    int left = imageRect.Right;
    int bottom = 0;
    int right = 0;

    // locate the circle in the image by finding pixels with average
    // intesity values above the threshold and then performing
    // some edge checks to set the top, left, right, and bottom values.
    int height = imageRect.Height + imageRect.Y;
    int width = imageRect.Width + imageRect.X;
    byte* pSrc = ( byte* ) data.Scan0;

    int rowOffset = 1;            
    for ( int y = imageRect.Y ; y < height ; ++y, ++rowOffset )
    {
        for ( int x = imageRect.X ; x < width ; ++x )
        {
            // windows stores images in memory in reverse byte order ( BGR )
            byte b = *pSrc++;
            byte g = *pSrc++;
            byte r = *pSrc++;                    

            // get the average intensity and see if it is above the threshold
            int intensity = GetIntensity( r, g, b );
            if ( intensity > intensityThreshold )
            {
                if ( !StrayPixel( pSrc, data, intensityThreshold ) )
                {
                    // found a point in the circle
                    if ( top == -1 ) top = y;
                    if ( x < left ) left = x;
                    if ( y > bottom ) bottom = y;
                    if ( x > right ) right = x;
                }
            }                    
        }

        // next row
        pSrc = ( ( byte* ) data.Scan0 ) + ( rowOffset * data.Stride );
    }

    image.UnlockBits( data );            

    // bounding rectangle of our spot
    return Rectangle.FromLTRB( left, top, right, bottom );
}                   

/// <summary>
/// Returns true if the pixel at (x,y) is surrounded in four 
/// directions by pixels that are below the specified intesity threshold.
/// This method only checks the first pixel above, below, left, and right
/// of the location currently pointed to by 'pSrc'.
/// </summary>        
private unsafe bool StrayPixel( byte* pSrc, BitmapData data, int intensityThreshold )
{
    // this method uses raw pointers instead of GetPixel because
    // the original image is locked and this is the only way to get at the data.

    // if we have a pixel with a relatively high saturation 
    // value we can safely assume that it is a camera artifact.
    if ( Color.FromArgb( pSrc[ 2 ], pSrc[ 1 ], *pSrc ).GetSaturation( ) > MAX_PIXEL_SAT )
    {
        return true;
    }

    byte* pAbove = pSrc - data.Stride;
    int above = GetIntensity( pAbove[ 2 ], pAbove[ 1 ], *pAbove );

    byte* pRight = pSrc + 3;
    int right = GetIntensity( pRight[ 2 ], pRight[ 1 ], *pRight );

    byte* pBelow = pSrc + data.Stride;
    int below = GetIntensity( pBelow[ 2 ], pBelow[ 1 ], *pBelow );

    byte* pLeft = pSrc - 3;
    int left = GetIntensity( pLeft[ 2 ], pLeft[ 1 ], *pLeft );

    // if all of the surrounding pixels are below the threshold we have found a stray
    return above < intensityThreshold &&
           right < intensityThreshold &&
           below < intensityThreshold &&
           left  < intensityThreshold;
}

/// <summary>
/// Returns the average of ( r, g, b )
/// </summary>  
private int GetIntensity( byte r, byte g, byte b )
{
    return GetIntensity( Color.FromArgb( r, g, b ) );
}

/// <summary>
/// Returns the average of ( c.r, c.g, c.b )
/// </summary>
private int GetIntensity( Color c )
{
    return ( c.R + c.G + c.B ) / 3;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:53:22.767

晚上好游戏！谢谢！快速编写了一些 C# 代码来执行此蛮力：

```
public class Dimensions
{
    public int left = 0;
    public int right = 0;
    public int top = 0;
    public int bottom = 0;
}

public class ImageDetection
{
    private const int xSize = 2000;
    private const int ySize = 2000;

    private const int xMin = 1800;
    private const int yMin = 1800;
    private const int defaultPixelColor = 0;

    public void GetArray(out char[,] arr)
    {
        arr = new char[xSize, ySize];
        Random rand = new Random();

        for (int i=0; i<xSize; ++i)
        {
            for (int j=0; j<ySize; ++j)
            {
                var d = rand.NextDouble();

                if (d < 0.5)
                {
                    arr[i, j] = Convert.ToChar(defaultPixelColor);
                }
                else
                {
                    int theInt = Convert.ToInt32(255 * d);
                    arr[i, j] = Convert.ToChar(theInt);
                }
            }
        }

        // cut top
        for (int k = 0; k < (xSize - xMin); k++)
        {
            for (int l = 0; l < ySize; l++)
            {
                arr[k, l] = Convert.ToChar(defaultPixelColor);
            }
        }

        // cut bottom
        for (int k = xMin; k < xSize; k++)
        {
            for (int l = 0; l < ySize; l++)
            {
                arr[k, l] = Convert.ToChar(defaultPixelColor);
            }
        }

        // cut left
        for (int k = 0; k < xSize; k++)
        {
            for (int l = 0; l < (ySize - xMin); l++)
            {
                arr[k, l] = Convert.ToChar(defaultPixelColor);
            }
        }

        // cut right 
        for (int k = 0; k < xSize; k++)
        {
            for (int l = xMin; l < ySize; l++)
            {
                arr[k, l] = Convert.ToChar(defaultPixelColor);
            }
        }

    }

    public void WriteArr(ref char[,] arr)
    {
        char[] line = new char[xSize];

        // all lines
        for (int i=0; i<ySize; ++i)
        {
            // build one line
            for (int j = 0; j < xSize; ++j)
            {
                char curChar = arr[i, j];

                if (curChar == '\0')
                {
                    line[j] = '.';
                }
                else
                {
                    line[j] = curChar;
                }
            }

            string s = new string(line);
            s += "\r\n";
            //FileIO.WriteFileText
            System.IO.File.AppendAllText("Matrix.txt", s);
         }
    }

    public void DetectSize(ref char[,] arr, out Dimensions dim)
    {
        dim = new Dimensions();

        dim.left = xSize;
        dim.top = ySize;
        dim.right = 0;
        dim.bottom = 0;

        for (int i = 0; i < xSize; ++i)
        {
            for (int j = 0; j < ySize; ++j)
            {
                if (!arr[i, j].Equals(Convert.ToChar(defaultPixelColor)))
                {
                    if (i < dim.left)
                    {
                        dim.left = i;
                    }

                    if (j < dim.top)
                    {
                        dim.top = j;
                    }

                    if (i > dim.right)
                    {
                        dim.right = i;
                    }

                    if (j > dim.bottom)
                    {
                        dim.bottom = j;
                    }
                }
            }
        }
    }
} 
```

# android - android 动态壁纸不显示，虽然它已安装

> ID：11039199
> 
> 赞同：0
> 
> 时间：2012-06-14T18:30:06.417
> 
> 标签：android, live-wallpaper

我开始在 android 上制作我的第一个动态壁纸，主要是使用这个： [http](http://www.vogella.com/articles/AndroidLiveWallpaper/article.html) ://www.vogella.com/articles/AndroidLiveWallpaper/article.html 。问题是壁纸没有显示在您可以选择壁纸的屏幕中。

我从 Eclipse 中启动了壁纸，卸载重新安装了导出的壁纸，但它既不适用于我的智能手机，也不适用于模拟器。

清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="de.zdev.wallpaper.cpubeat"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="10" />
<uses-feature android:name="android.software.live_wallpaper" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >

<service 
    android:name="de.zdev.wallpaper.CPUBeatService"
    android:label="@string/app_name"
    android:permission="android.permission.BIND_WALLPAPER" >

    <intent-filter>
        <action android:name="android.service.wallpaper.WallpaperService" />
    </intent-filter>

    <meta-data
        android:name="android.service.wallpaper"
        android:resource="@xml/wallpaper" />

</service>

</application> 
```

“wallpaper.xml”（我认为问题不在这里）：

```
<?xml version="1.0" encoding="utf-8"?>
<Wallpaper
xmlns:android="http://schemas.android.com/apk/res/android"
android:thumbnail="@drawable/ic_launcher"
android:description="@string/description" /> 
```

最后是我的“CPUBeatService.java”：

```
package de.zdev.wallpaper.cpubeat;

import android.graphics.Canvas;
import android.graphics.Color;
import android.os.Handler;
import android.service.wallpaper.WallpaperService;
import android.service.wallpaper.WallpaperService.Engine;
import android.view.SurfaceHolder;

public class CPUBeatService extends WallpaperService {
    @Override
    public Engine onCreateEngine(){
        return new CPUBeatEngine();
    }

    private class CPUBeatEngine extends Engine{

        private final Handler handler = new Handler();
        private boolean visible = true;
        private int width, height;
        private final Runnable drawRunnable = new Runnable(){
            public void run(){
                doDraw();
            }
        };

        public CPUBeatEngine(){
            handler.post(drawRunnable);
        }

        private void draw(Canvas c){
            c.drawColor(Color.GREEN);
        }

        @Override
        public void onVisibilityChanged(boolean v){
            visible = v;
            if(visible) handler.post(drawRunnable);
            else handler.removeCallbacks(drawRunnable);
        }

        @Override
        public void onSurfaceDestroyed(SurfaceHolder holder){
            super.onSurfaceDestroyed(holder);
            visible = false;
            handler.removeCallbacks(drawRunnable);
        }

        @Override
        public void onSurfaceChanged(SurfaceHolder holder, int format, int w, int h){
            super.onSurfaceChanged(holder, format, w, h);
            width = w;
            height = h;
        }

        private void doDraw(){
            SurfaceHolder holder = getSurfaceHolder();
            Canvas c = null;
            try {
                c = holder.lockCanvas();
                if (c != null) {
                    //do the real drawing now
                    draw(c);
                }
            } finally {
                if (c != null)
                    holder.unlockCanvasAndPost(c);
            }
            handler.removeCallbacks(drawRunnable);
            if (visible) {
                handler.postDelayed(drawRunnable, 5000);
            }
        }

    }
} 
```

感谢任何能提供帮助的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-19T18:11:33.917

好吧，几个月后，我决定再做一次。我发现了错误……至少我是这么认为的。Wallpaper.xml 不正确，这是正确的：

```
<?xml version="1.0" encoding="utf-8"?>
<wallpaper
xmlns:android="http://schemas.android.com/apk/res/android"
android:thumbnail="@drawable/ic_launcher"
android:description="@string/description" /> 
```

注意：`<wallpaper`是小写的！我认为这就是问题所在。:)

# php - 检索为主要创建的以进行编辑

> ID：11039200
> 
> 赞同：0
> 
> 时间：2012-06-14T18:30:06.567
> 
> 标签：php, sql, forms, web, updating

在我的网络应用程序上，人们可以创建我所说的案例。在后端提交时，会将其保存到 MSSQL DB 表中。在他们点击保存后，它将在数据库中创建新条目，我需要的是能够检索身份行（自动增量），这是我的主键，以便我可以将其保存在会话（PHP）中用户再次点击保存（更新）。

我的问题，我知道这是一种常见的做法，这样做的常见方式是什么，所以我正在考虑使用 SQL SCOPE_IDENTITY 但正在阅读这里的常见错误：

[http://blog.sqlauthority.com/2009/03/24/sql-server-2008-scope_identity-bug-with-multi-processor-parallel-plan-and-solution/](http://blog.sqlauthority.com/2009/03/24/sql-server-2008-scope_identity-bug-with-multi-processor-parallel-plan-and-solution/)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:46:10.270

删除主列上的标识并创建您自己的自定义标识生成器函数

```
create function NextCustomerNumber() 
returns char(5) 
as 
begin 
    declare @lastval char(5) 
    set @lastval = (select max(myidentity) from mytable) 
    if @lastval is null set @lastval = 'C0001' 
    declare @i int 
    set @i = right(@lastval,4) + 1 
    return 'C' + right('000' + convert(varchar(10),@i),4) 
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:35:19.867

如果我正确理解你的问题。我认为这会有所帮助。

[http://php.net/manual/en/function.mysql-insert-id.php](http://php.net/manual/en/function.mysql-insert-id.php)

# python - django动态拉链内部服务器错误

> ID：11039209
> 
> 赞同：1
> 
> 时间：2012-06-14T18:30:46.130
> 
> 标签：python, django, zipfile

我启用了调试，但它没有显示任何内容。我看到的只是“500 内部服务器错误。我在这个脚本中做错了什么？

Python

```
import zipfile
from zipfile import ZipFile
import cStringIO as StringIO
from django.http import HttpResponse
from django.core.servers.basehttp import FileWrapper

def zipit (request):
  files = ['/home/dbs/public_html/download/codex/video.html', '/home/dbs/public_html/download/audio/audio.html']
  buffer= StringIO.StringIO()
  z= zipfile.ZipFile( buffer, "w" )
  [z.write(f) for f in files]
  z.close()
  response = HttpResponse(FileWrapper(z), content_type='application/zip')
  response['Content-Disposition'] = 'attachment; filename=z.zip'
  return HttpResponse(response, mimetype="application/x-zip-compressed") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:51:57.180

试试这个：

```
import zipfile
from zipfile import ZipFile
import cStringIO as StringIO
from django.http import HttpResponse
from django.core.servers.basehttp import FileWrapper
import os

def zipit (request):
    files = ['/home/dbs/public_html/download/codex/video.html', '/home/dbs/public_html/download/audio/audio.html']
    buffer = StringIO.StringIO()
    z = zipfile.ZipFile(buffer, "w")
    [z.write(f, os.path.join('codex', os.path.basename(f))) for f in files]
    z.close()
    buffer.seek(0)
    response = HttpResponse(buffer.read())
    response['Content-Disposition'] = 'attachment; filename=z.zip'
    response['Content-Type'] = 'application/x-zip'
    return response 
```

但请尽量不要让 django 返回它从未为此设计的二进制文件，您的 http 服务器应该处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-01T16:38:50.357

上述解决方法有效，但缺点是将整个 zip 加载到内存中并且没有利用文件系统。如果您正在创建一个大型存档，这可能会给您的应用程序带来严重的内存负担。这是一种类似的方法，可让您利用文件系统：

```
# imports omitted
def zipfileview(request):
    fd, fpath = tempfile.mkstemp()
    os.close(fd) # don't leave dangling file descriptors around...
    with zipfile.ZipFile(fpath, "w") as zip:

        # write files to zip here

        # when done send response from file
        response = HttpResponse(FileWrapper(open(fpath, 'rb')), mimetype="application/zip")
        response["Content-Disposition"] = "attachment; filename=myzip.zip"
        return response 
```

# javascript - 为什么这个字符串不会逃逸？

> ID：11039212
> 
> 赞同：1
> 
> 时间：2012-06-14T18:30:59.547
> 
> 标签：javascript, python, html, escaping, web2py

我们我有一些带有 onSubmit 的 html：

```
<form id="login_box" onSubmit="alert('{{=T('Thank you for contacting us! We have received your email and will contact you shortly.')}}'); this.submit(); this.reset(); return false;"> 
```

问题是，无论我做什么，它都不会逃脱嵌套的引号。我试过了：

```
<form id="login_box" onSubmit="alert('{{=T(\'Thank you for contacting us! We have received your email and will contact you shortly.\')}}'); this.submit(); this.reset(); return false;">

<form id="login_box" onSubmit="alert(\"{{=T('Thank you for contacting us! We have received your email and will contact you shortly.')}}\"); this.submit(); this.reset(); return false;">

<form id="login_box" onSubmit=\"alert(\\"{{=T('Thank you for contacting us! We have received your email and will contact you shortly.')}}\\"); this.submit(); this.reset(); return false;\"> 
```

以及我能想到的任何其他组合，即使我知道它不起作用。我没有尝试转义嵌套引号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:57:48.333

我认为您在 python 中使用了 twig 或任何类似的模板系统。

如果要翻译`{{=T('message to translate')}}`，只需将该字符串放入自定义属性中。

## 例子：

```
<form id="login_box" msg="{{=T('Thank you for contacting us! We have received your email and will contact you shortly.')}}" onSubmit="alert(this.getAttribute('msg')); this.submit(); this.reset(); return false;"> 
```

[这个例子](http://jsfiddle.net/JPm93/2/)

:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T19:01:38.590

假设这是在 web2py 模板中，您的原始代码：

```
onSubmit="alert('{{=T('Thank you for contacting us! We have received your email and will contact you shortly.')}}'); this.submit(); this.reset(); return false;" 
```

生成以下 HTML：

```
onSubmit="alert('Thank you for contacting us! We have received your email and will contact you shortly.'); this.submit(); this.reset(); return false;" 
```

据我所知，它在浏览器中运行良好。但是，如果您想转义警报中的那些单引号，您可以执行以下操作：

```
onSubmit="alert({{="'%s'" % T('Thank you for contacting us! We have received your email and will contact you shortly.')}}); this.submit(); this.reset(); return false;" 
```

这将生成以下 HTML：

```
onSubmit="alert(&#x27;Thank you for contacting us! We have received your email and will contact you shortly.&#x27;); this.submit(); this.reset(); return false;" 
```

这也应该在浏览器中工作。

分隔符内的所有内容`{{ }}`都是 Python 代码，将在服务器上执行并在写入响应之前转义。分隔符之外的所有内容都`{{ }}`将按原样包含在响应中（即，web2py 不进行转义）。在您的原始代码中，警报中的单引号位于 web2py 模板分隔符之外，因此它们不会被 web2py 转义，而是按原样交付。这在 web2py 书的[这一部分](http://web2py.com/books/default/chapter/29/5#The-views)有进一步的解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:36:59.573

在 HTML 属性中，某些字符 (`"`和`&`) 必须编码为 HTML 实体。在 javascript 字符串中，字符串分隔符（例如`'`）必须使用反斜杠进行转义。这意味着您的第一个应该可以工作。

```
<form id="login_box" onSubmit="alert('{{=T(\'Thank you for contacting us! We have received your email and will contact you shortly.\')}}'); this.submit(); this.reset(); return false;"> 
```

`{{=T('Thank you for contacting us! We have received your email and will contact you shortly.')}}`当您单击它时，这应该会发出警报。假设这是你想要的？

**编辑：**

```
{{=T('Thank you for contacting us! We have received your email and will contact you shortly.')}} 
```

将返回一个字符串，所以

```
<form id="login_box" onSubmit="alert('{{=T('Thank you for contacting us! We have received your email and will contact you shortly.')}}'); this.submit(); this.reset(); return false;"> 
```

会变成

```
<form id="login_box" onSubmit="alert('Thank you for contacting us! We have received your email and will contact you shortly.'); this.submit(); this.reset(); return false;"> 
```

在呈现的 HTML 中。这是对的。但是，您需要转义任何反斜杠，然后 html 实体对 T 函数的输出进行编码（按该顺序）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T19:24:01.953

对返回的值进行 HTML 编码，然后将其编码为 JSON。

# sql - SQL 中的 case 语句

> ID：11039214
> 
> 赞同：0
> 
> 时间：2012-06-14T18:31:09.710
> 
> 标签：sql

您好，我是 SQL 新手，我想使用 Case 语句。

我目前有这个 SQL 语句

```
update tblAccount set FullName = rtrim(isnull(FirstName,''));
update tblAccount set FullName = FullName + ' ' + rtrim(MI)
where substring(reverse(MI),1,1)='.';
update tblAccount set FullName = FullName + ' ' + rtrim(MI) + '.'
where substring(reverse(MI),1,1)!='.'
and MI is not null and len(rtrim(MI)) = 1;
update tblAccount set FullName = FullName + ' ' + rtrim(MI) 
where len(rtrim(MI)) >= 2;
update tblAccount set FullName = FullName + ' ' + LastName;
update tblAccount set FullName = FullName + ', ' + Suffix 
where Suffix is not null
and len(rtrim(Suffix)) > 0; 
```

我想把它转换成更小更易读的东西，有人告诉我 Case 语句可能会有所帮助，但我很熟悉它，我想知道是否有人能够帮助将它转换成更易读的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:41:34.767

它*可以*写成一个语句，但是因为你的代码重新修改了同一列，你必须嵌套和组合函数调用，这将是一个绝对巨大的语句，因此远不如你当前的代码可读。

此外，执行顺序很重要，因此维护和调试单个语句会更加困难。

保持原状。你所拥有的是好的。

关于性能，我可以说代码的维护和清晰度每次都超过性能（只要性能是“可接受的”）。

也就是说，您当前的调用每个都需要全表扫描，而单个语句只需要一个。但是，根据表的大小，在第一次扫描后，表可能会缓存在内存中，并且单个语句可能非常复杂，以至于它实际上比您当前的代码慢。

您必须对其进行测试，但除非出现问题，否则您不应该考虑性能 - 不要过早优化您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:05:48.110

我会像这样重写它，只是在性能上稍微升级，但我认为它的可读性更高，就像@Bohemian 所说的那样。

```
--MIDDLE NAME?
    update tblAccount 
    set FullName = 
                    case when  substring(reverse(MI),1,1)='.' THEN --  FIRST + SECOND UPDATE
                        rtrim(isnull(FirstName,'')) + ' ' + rtrim(MI)
                    case when substring(reverse(MI),1,1)!='.' and MI is not null and len(rtrim(MI)) = 1 THEN --FIRST AND THIRD UPDATE
                        rtrim(isnull(FirstName,'')) + ' ' + rtrim(MI) + '.'
                    else  -- FIRST UPDATE
                         rtrim(isnull(FirstName,''));
                    end 

    GO      
    -- LASTNAME     
    update tblAccount 
    set FullName = case when len(rtrim(MI)) >= 2 THEN
                        (FullName + ' ' + rtrim(MI)) + ' ' + LastName
                    else
                        FullName + ' ' + LastName;
                    END
    GO

    -- SUFFIX
    update tblAccount 
    set FullName = FullName + ', ' + Suffix 
    where Suffix is not null
    and len(rtrim(Suffix)) > 0; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:47:32.237

一般形式是

```
CASE WHEN <condition> THEN <value> ELSE <somethingElse> END 
```

在哪里`WHEN <condition> THEN <value>`可以重复并且`ELSE <somethingElse>`是可选的

case 语句可以用作控制结构，如在存储过程或脚本中，或内联，如`SELECT`.

您的更新语句等效于：

```
UPDATE tblAccount SET FullName = 
    rtrim(isnull(FirstName,''))
    + CASE 
        WHEN substring(reverse(MI),1,1)='.' THEN ' ' + RTRIM(MI)  
            + CASE WHEN where len(rtrim(MI)) >= 2 THEN RTRIM(MI) END
        WHEN MI is not null and len(rtrim(MI)) = 1 THEN rtrim(MI) + '.'
            + CASE WHEN where len(rtrim(MI)) >= 2 THEN RTRIM(MI) END
        ELSE
            + CASE WHEN where len(rtrim(MI)) >= 2 THEN RTRIM(MI) END
    END
    + ' ' + LastName
    + CASE 
        WHEN Suffix IS NOT NULL AND len(rtrim(Suffix)) > 0 THEN ', '+Suffix 
    END 
```

您有 6 次更新，nrs 1、5 和 6 很简单，它们几乎被复制到上面的一个语句中。2 的记录更新不会被 3 触及，并且 4 可以（根据您的代码，数据可能证明并非如此）与 2、3 或两者都不发生，因此 4 的重复。

* * *

当然，我完全不同意你的陈述很好的论点。如果您需要的是一次更新，那就是一次更新。也不要因为接受不回答而屈服于压力。

玩得开心！

在你学习的时候也看看 COALESCE() 。

# python - 寻找一种将 JSON 转换为 CSV 的 DSL

> ID：11039215
> 
> 赞同：1
> 
> 时间：2012-06-14T18:31:12.027
> 
> 标签：python, transform, dsl

我需要将分层数据（AVRO 数据，归结为 JSON）转换为表格数据（csv）。由于 AVRO 有严格的模式，我基本上知道 JSON 将采用什么形式，但我必须为许多不同的模式执行此操作，所以我正在寻找一种一致的、声明性的方式来表达我需要进行的转换。例如，如果我的传入数据看起来像这样……</p>

```
{
    "customers": [
        {
            "addresses": [
                {
                    "city": "Los Angeles", 
                    "country": "USA", 
                    "county": null, 
                    "postalCode": "90064", 
                    "stateOrProvince": "California", 
                    "street1": "11832 W. Pico Blvd.", 
                    "street2": "", 
                    "street3": "", 
                    "street4": "", 
                    "tags": [
                        "BILLING"
                    ]
                }
            ], 
            "company": "", 
            "dateCreated": "2009-04-24T11:42:31+00:00", 
            "dateOfBirth": null, 
            "doNotCall": null, 
            "email": {
                "emailAddress": "general@magentocommerce.com"
            }, 
            "emailOptOut": null, 
            "fullName": {
                "firstName": "Test", 
                "lastName": "General", 
                "middleName": "", 
                "prefix": "", 
                "suffix": ""
            }, 
            "gender": null, 
            "id": {
                "Id": "2", 
                "namespace": "1000020016"
            }, 
            "lastModified": "2009-05-08T23:33:06+00:00", 
            "primaryPhone": {
                "number": "866.4.VARIEN", 
                "type": "UNKNOWN"
            }, 
            "sourceIds": null
        }
    ], 
    "totalItemsFound": 3
} 
```

…我可能需要为每个客户输出一行，如下所示：

```
MERCHANT ID|NUM CUSTOMERS|ID|FIRST NAME|LAST NAME|EMAIL|PHONE|STREET|CITY|STATE|ZIP|COUNTRY|EMAIL PREFERENCE
some.merch|3|1000020016-2|Test|General|general@magentocommerce.com|866.4.VARIEN|11832 W. Pico Blvd.|Los Angeles|California|90064|USA|N 
```

我需要能够表达以下内容：

1.  从给定键中获取所有值作为数组：*所有出生日期*
2.  在每一行重复一个值：*totalItemsFound，在每一行重复*
3.  在来自静态数据的每一行中重复一个静态值我已经知道*商家渠道永远不会改变*
4.  还有一个棘手的问题：任意操纵传入的数据以产生所需的输出：
    *   *将客户的 id 转换为 namespace-id*
    *   *反转 null/boolean 值并将其更改为 y/n，如 emailOptOut 到 EMAIL PREFERENCE*
    *   *（重新）格式化日期或货币*
    *   ETC

我从[jsonpath](http://goessner.net/articles/JsonPath/)开始，但这只能解决上面的#1。我一直在慢慢地在 jsonpath 周围添加一种语言来服务 2 和 3，但是对于 4，我真的没有一个好的答案（除了 eval。，我真的很讨厌这样做）。我查看了[JSON/T](https://stackoverflow.com/questions/1618038)，但找不到它的 python 库。我什至认真考虑过编写一个中间件来将 JSON 转换为 XML，以便我可以使用 XSLT，但我希望 S/O 的某个人在我绝望之前有更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:29:42.217

为什么不尝试进行功能分解，这与以下内容不同：

```
w = csv.writer(...)
for r in records: 
    l = {}
    for field in fields:
        f_ = rename(field)
        v_ = transform(field, r.get(field, default(field)))
        l[f_] = v_
    w.write(l) 
```

where`rename`将旧字段名称映射到新字段名称，并`transform`根据字段的转换集转换字段的值，并`default`返回要分配给该字段的值。

因此，您只需要定义字段列表和函数：`rename`、`transform`和`default`.

对于您给出的示例：

```
def rename(field):
    t = {'emailOptOut':'EMAIL PREFERENCE'}
    return t.get(field, field)

def transform(field, data):
    t = {'emailOptOut': bool}
    return t.get(field, lambda a: a)(data)

def default(field)
    t = {'MERCHANT ID':11039215}
    return t.get(field, None) 
```

# sorting - 合并两个大小为 n 和 m 的排序数组的时间复杂度

> ID：11039217
> 
> 赞同：10
> 
> 时间：2012-06-14T18:31:19.327
> 
> 标签：sorting, complexity-theory

我只是想知道合并两个大小为 n 和 m 的排序数组的时间复杂度是多少，因为**n 总是大于 m**。

我正在考虑使用归并排序，我假设在这种情况下会消耗 O(log n+m)。

我不太擅长大哦之类的。请建议我这个问题的时间复杂度，如果有解决问题的优化方法，请告诉我。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-08T14:41:45.613

合并两个排序列表的时间绝对不是 O(m log n)。它是 O(n+m)。

代码看起来像这样：

```
allocate c with length n+m
i = 1
j = 1
while i < n or j < m
  if i = n
    copy rest of b into c 
    break    
  if j = m
    copy rest of a into c
    break
  if a[i] < b[j]
    copy a[i] into c
    i=i+1
    continue
  if b[j] < a[i]
    copy b[j] into c
    j=j+1
    continue 
```

现在，如果我们没有足够的内存来分配 c，这可以修改为仍然是 O(n+m) 时间，因为大多数硬件（例如 RAM 和硬盘）都允许块操作。当我们需要将单个项目插入到数组的中间时，将块的尾部移到一个上以腾出空间是一个单一的操作。如果您使用的硬件不允许这样做，那么每次插入可能需要 O(n)，这将是 O(n+mn) 复杂度。由于我们只需要将较小数组的元素插入到较大数组中，因此当较大数组中的元素已经在正确的位置时，我们永远不需要移动较大数组的片段。因此，n 保持不变，增加了 m 位的复杂度。当所有长度为 m 的数组 b 正确地放置在长度为 n 的数组 a 前面时，这是最坏的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-08-31T00:08:56.577

只是自己经历了这个问题，Big O 不是`O(m+n)`，它实际上只是`O(n)`。

这就是伪代码中的原因：（**注意：**我编写此代码来处理**m > n**或**m == n**的情况）

```
Merging sorted arrays A and B into C.
let ints 'i' and 'j' and 'k' = 0

while(i < A.length && j < B.length){
    if(A[i] < B[j]){
        C[k] = A[i]
        i++
    } else {
        C[k] = B[j]
        j++
    }
    k++
}

// Copies rest of A into C if A.len > B.len
while(i < A.length){ 
    C[k] = A[i]
    k++
    i++
}

// Copies rest of B into C if A.len < B.len
while(j < B.length){ 
    C[k] = B[j]
    k++
    j++
}
return C 
```

现在我们只知道长度为**n**的数组大于长度为**m**的数组。这意味着长度为**m**的数组中的每个元素都有可能大于长度为**n**的数组中的每个元素，即使**n > m**（例如`A[2,3,4,5,6]`and `B[7,8,9]`），我们也不知道，这没关系。第一个循环将迭代直到`i`或`j`等于它们各自数组的长度，然后只有接下来的两个 while 循环中的一个将运行，直到 A 或 B 的其余部分添加到 C。

所以可以看出你是如何结束的`O(m+n)`，但是，Big O 通常处理*最坏情况的运行时*，因此我们知道我们将迭代长度为**n**的数组的次数比**m**多，而不管数组中元素的构成如何，所以**m**总是小于**n**。所以我们去掉**m**来得到`O(n)`。

这是因为**n**可以等于*infinity*，因此，既然这是一种可能性，那么我们知道**m**永远不可能是*infinity*，并且根据定义**必须小于 infinity**，因此进一步定义**具有小于 n 的常数值**（因为它在某个点停止增长到无穷大，因为只有**n**可以是无限的）。由于我们在确定 Big O 运行时时删除了常量，所以我们得到`O(n)`.

显然我迟到了几年，哈哈，但我希望这能为将来可能遇到这种情况的其他人扫清空气:)

* * *

## 回答 #3

> 赞同：-13
> 
> 时间：2012-06-14T18:48:14.147

**注意力！此答案包含错误**

存在更有效的算法，并在另一个答案中提出。

* * *

复杂度为 O(m log n)。

让长数组被称为`a`短数组，`b`那么你描述的算法可以写成

```
 for each x in b
      insert x into a 
```

循环有 m 次迭代。每次插入排序数组都是 O(log n) 操作。因此总体复杂度为 O (m log n)。

由于`b`已排序，上述算法可以更高效

```
 for q from 1 to m
      if q == 1 then insert b[q] into a
      else 
         insert b[q] into a starting from the position of b[q-1] 
```

这可以提供更好的渐近复杂度吗？并不真地。

假设 中的元素`b`沿 均匀分布`a`。然后每次插入都会进行`O(log (n/m))`，整体复杂性将是`O(m log(n/m) )`. 如果存在一个`k>1`不依赖于`n`或`m`这样的常数，`n > k * m`那么`O(log(n/m)) = O(log(n))`我们得到与上面相同的渐近复杂度。

# jquery - 谷歌分析邮件跟踪

> ID：11039218
> 
> 赞同：1
> 
> 时间：2012-06-14T18:31:19.843
> 
> 标签：jquery, google-analytics

我一直在使用这个 google 分析代码来跟踪 mailto 链接，但它根本不起作用。我觉得这很简单（一个支架在某处或某处丢失），但我已经尝试了几件事，但无法弄清楚。有什么建议么？

```
<script type="text/javascript">

$(document).ready(function(){

    $('a').mouseup(function(){
        href = $(this).attr('href');
        if (href !== null) {            
            href_lower = href.toLowerCase();
            if(href_lower.substr(-3) == "pdf" || href_lower.substr(-3) == "xls" || href_lower.substr(-3) == "doc" ||
               href_lower.substr(-3) == "mp3" || href_lower.substr(-3) == "mp4" || href_lower.substr(-3) == "flv" ||
               href_lower.substr(-3) == "txt" || href_lower.substr(-3) == "csv" || href_lower.substr(-3) == "zip") {
                _gaq.push(['_trackEvent', 'Downloads', href_lower.substr(-3), href]);
            }
        }
        else if (href_lower.substr(0, 4) == "http") {
            var domain = document.domain.replace("www.",'');
                if(href_lower.indexOf(domain) == -1){
                    href = href.replace("http://",'');
                    href = href.replace("https://",'');
                    _gaq.push(['_trackEvent', 'Outbound Traffic', href]);
                }  else if (href && href.match(/^mailto\:/i)) {
                    jQuery(this).click(function() {
                    var mailLink = href.replace(/^mailto\:/i, '');
                    _gaq.push(['_trackEvent', 'Email', 'Click', mailLink]);
                    });
                }
            }
        }
    )
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:38:58.320

您正在寻找以“http”开头的链接的 else-if 中的“mailto:” *。*整个 if-else-if 应该用 "mailto:" 重写为 "first class" 条件，而不是 "http:" 的子条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:53:21.580

这部分代码

```
else if (href_lower.substr(0, 4) == "http") 
```

只有当这为真时，mailto 条件才有机会运行，但当它为真时，mailto 条件将始终为假，因为 mailto 语法不以“http”开头

```
<a href="mailto:someone@example.com">Send email</a> 
```

我想你可能可以做类似的事情

```
if(href !== null) { // ....}
else {
    if(href_lower.indexOf('mailto:') !== -1) { // mailto code }
    else { other than mailto code }
} 
```

# linux - Shell 脚本中的定时异步任务

> ID：11039219
> 
> 赞同：1
> 
> 时间：2012-06-14T18:31:20.273
> 
> 标签：linux, bash, shell, unix

基本上我正在尝试编写一个脚本来对我的服务器进行压力测试并确保命令正在运行。我的脚本没有按预期工作。下面是脚本。基本上，脚本正在执行的命令不会异步运行，也不会将它们的输出写入结果文件。有什么建议么？

```
#Script to load test the swift command on a linux box

numOfTests=100
echo "Starting Swift Load Tester ($numOfTests iterations)"

mkdir /srv/www/htdocs/audiotest/stress_test
mkdir /srv/www/htdocs/audiotest/half_sec_test
mkdir /srv/www/htdocs/audiotest/sec_test

echo "This is the prompt text" > /srv/www/htdocs/audiotest/prompt.txt

echo "Beginning Stress Test..."

#Clear results text file
echo "" > results.txt

for((i=0; i < numOfTests; i++))
do
    (time /opt/swift/bin/swift -n Allison-8kHz -o /srv/www/htdocs/audiotest/stress_test/$i.wav -f /srv/www/htdocs/audiotest/prompt.txt &) >> results.txt 2>&1
done

echo "Done"
echo "Beginning 1/2 second interval test..."

for((i=0; i< numOfTests; i++))
do
    (time /opt/swift/bin/swift -n Allison-8kHz -o /srv/www/htdocs/audiotest/half_sec_test/$i.wav -f /srv/www/htdocs/audiotest/prompt.txt &) >> results.txt 2>&1
    sleep .5
done

echo "Done"
echo "Beginning 1 second interval test..."

for((i=0; i< numOfTests; i++))
do
    (time /opt/swift/bin/swift -n Allison-8kHz -o /srv/www/htdocs/audiotest/sec_test/$i.wav -f /srv/www/htdocs/audiotest/prompt.txt &) >> results.txt 2>&1
    sleep 1
done

echo "Done"

echo "Load Testing Completed" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:51:12.610

当您`>`用作重定向运算符时，它会覆盖文件。因此，最后运行的测试将是您看到的唯一输出。改为使用`>>`。并将`time`其输出写入 stderr，因此如果您想查看这些结果，您还需要重定向 stderr。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:44:52.657

使用子shell并重定向stderr，看看它是否适合你。

(time myCommand [args] &) > results.txt 2>&1

# ruby-on-rails-3 - 在不持续刷新的情况下更新rails中的页面

> ID：11039220
> 
> 赞同：2
> 
> 时间：2012-06-14T18:31:20.473
> 
> 标签：ruby-on-rails-3, model-view-controller, jquery

我想用我编写的网络抓取脚本中的信息更新 Rails 中的 erb.html 页面，但我不希望每次进入新信息时都必须刷​​新页面。

我不知道将后台脚本放在哪里，rails 将如何调用它等等。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T00:01:47.910

在构造方面有多种方法可以实现您想要的结果，但最终您将使用 Javascript 和 AJAX 调用，因为没有其他方法可以使用抓取的数据更新页面上的内容。

下面是我如何使用 AJAX 和屏幕抓取来实现 RoR：

**应用程序.js**

在我们的应用程序 JS 文件中，我们监听一个字段何时更改（用户输入一个 web url 或某种数据），然后我们对我们的爬虫进行 AJAX 调用（稍后在 Routes.rb 中设置的 url）和我们的数据以 JSON 格式返回（当调用 AJAX 的成功触发器时），我们循环并在两个字段中显示抓取的数据，这些字段以与我们的 JSON 键值对的键类似的格式命名。

```
$('#item_url').live('change', function() {          
     $.ajax({
            url: "/scrape/siteandnum", 
            data: {item_url: document.getElementById('item_url').value},             
            dataType: 'json', 
            success: function(data) {                                                               
                    $.each(data, function(key, value) {                        
                        document.forms['new_qued_item'].elements['qued_item_' + key].value = value
                    });         
                }
            });
}); 
```

**qued_items_controller.rb**

在我们的控制器中，我们有一个方法是 Ruby 抓取代码。它接收 item_url 的参数（从 AJAX 调用的数据传入）——在本例中，它接收 eBay 拍卖 URL 并为我们提供 eBay 站点域和商品编号。

```
def scrape_site_and_num
    url = params[:item_url] 
    itemnumber = url.match(/\d{12}/)[0].to_i 
    site = url.match(/ebay.(co.uk|com|de|fr|it|ca)/)[0]

    render :json => {'itemnumber' => itemnumber, 'site' => site}
end 
```

**路线.rb**

当然，我们必须有一个路由，以便 AJAX 调用知道从哪里访问我们的抓取方法。

```
 get "scrape/siteandnum/" => "qued_items#scrape_site_and_num" 
```

所以你有它。使用此方法可以输入任何类型的数据，并且“幕后”Ruby 方法将处理用户输入并返回一些屏幕抓取的数据，而无需重新加载页面！

# python - python: urlopen&threading 不必要的慢？有更快的方法吗？

> ID：11039224
> 
> 赞同：0
> 
> 时间：2012-06-14T18:31:31.507
> 
> 标签：python, multithreading, performance, http, io

我正在编写一个客户端，它一次加载和解析许多页面并将数据从它们发送到服务器。如果我一次只运行一个页面处理器，事情就会顺利进行：

```
********** Round-trip (with 0 sends/0 loads) for (+0/.0/-0) was total 1.98s (1.60s load html, 0.24s parse, 0.00s on queue, 0.14s to process) **********
********** Round-trip (with 0 sends/0 loads) for (+0/.0/-0) was total 1.87s (1.59s load html, 0.25s parse, 0.00s on queue, 0.03s to process) **********
********** Round-trip (with 0 sends/0 loads) for (+0/.0/-0) was total 2.79s (1.78s load html, 0.28s parse, 0.00s on queue, 0.72s to process) **********
********** Round-trip (with 0 sends/1 loads) for (+0/.0/-0) was total 2.18s (1.70s load html, 0.34s parse, 0.00s on queue, 0.15s to process) **********
********** Round-trip (with 0 sends/1 loads) for (+0/.0/-0) was total 1.91s (1.47s load html, 0.21s parse, 0.00s on queue, 0.23s to process) **********
********** Round-trip (with 0 sends/1 loads) for (+0/.0/-0) was total 1.84s (1.59s load html, 0.22s parse, 0.00s on queue, 0.03s to process) **********
********** Round-trip (with 0 sends/0 loads) for (+0/.0/-0) was total 1.90s (1.67s load html, 0.21s parse, 0.00s on queue, 0.02s to process) ********** 
```

但是，由于同时运行约 20 个（每个都在自己的线程中），HTTP 流量变得非常慢：

```
********** Round-trip (with 2 sends/7 loads) for (+0/.0/-0) was total 23.37s (16.39s load html, 0.30s parse, 0.00s on queue, 6.67s to process) **********
********** Round-trip (with 2 sends/5 loads) for (+0/.0/-0) was total 20.99s (14.00s load html, 1.99s parse, 0.00s on queue, 5.00s to process) **********
********** Round-trip (with 4 sends/4 loads) for (+0/.0/-0) was total 17.89s (9.17s load html, 0.30s parse, 0.12s on queue, 8.31s to process) **********
********** Round-trip (with 3 sends/5 loads) for (+0/.0/-0) was total 26.22s (15.34s load html, 1.63s parse, 0.01s on queue, 9.24s to process) ********** 
```

该`load html`位是读取我正在处理的网页的 HTML 所需的时间（`resp = self.mech.open(url)`到`resp.read(); resp.close()`）。该`to process`位是从该客户端到处理它的服务器进行往返所需的时间（`fp = urllib2.urlopen(...); fp.read(); fp.close()`）。该`X sends/Y loads`位是同时发送到服务器并从我正在处理的网页加载的数量，这些网页在向服务器发出请求时正在运行。

我最关心的是那个`to process`位。服务器上的实际处理只需要`0.2s`左右。只发送了**400 个字节**，所以这不是占用太多带宽的问题。有趣的是，如果我运行一个打开 5 个线程并重复执行此操作的程序（同时进行所有这些同时发送/加载的解析）`to process`，它的运行速度非常快：

```
1 took 0.04s
1 took 1.41s in total
0 took 0.03s
0 took 1.43s in total
4 took 0.33s
2 took 0.49s
2 took 0.08s
2 took 0.01s
2 took 1.74s in total
3 took 0.62s
4 took 0.40s
3 took 0.31s
4 took 0.33s
3 took 0.05s
3 took 2.18s in total
4 took 0.07s
4 took 2.22s in total 
```

`to process`这个独立程序中的每个只需要`0.01s`to `0.50s`，远远少于成熟版本中的 6-10 秒，并且它使用的发送线程并没有减少（它使用 5 个，并且成熟版本的上限为5）。

也就是说，当完整版本正在运行时，运行一个单独的版本发送这些相同`(+0/.0/-0)`的请求，每个请求 400 字节，`0.31`每个请求只需要 s。所以，它不像我正在运行的机器被窃听......似乎其他线程中的多个同时加载正在减慢应该快速的速度（实际上是快速的，在另一个运行的程序中同一台机器）在其他线程中发送。

发送是用 完成的`urllib2.urlopen`，而读取是用 mechanize 完成的（最终使用 fork `urllib2.urlopen`）。

有没有办法让完整的程序像这个迷你独立版本一样快速运行，至少在他们发送相同的东西时？我正在考虑编写另一个程序，它只接收通过命名管道或其他东西发送的内容，以便发送在另一个进程中完成，但这似乎很愚蠢，不知何故。欢迎大家提出意见。

任何有关如何更快地同时加载多个页面的建议（因此时间看起来更像 1-3 秒而不是 10-20 秒）也将受到欢迎。

* * *

编辑：附加说明：我依赖 mechanize 的 cookie 处理功能，因此理想情况下，任何答案都将提供一种处理该问题的方法，以及......

* * *

编辑：我用不同的配置进行了相同的设置，其中只打开一页，一次将大约 10-20 个内容添加到队列中。那些像刀穿过黄油一样被加工，例如，这是添加一大堆的结尾：

```
********** Round-trip (with 4 sends/0 loads) for (+0/.0/-0) was total 1.17s (1.14s wait, 0.04s to process) **********
********** Round-trip (with 4 sends/0 loads) for (+0/.0/-0) was total 1.19s (1.16s wait, 0.03s to process) **********
********** Round-trip (with 4 sends/0 loads) for (+0/.0/-0) was total 1.26s (0.80s wait, 0.46s to process) **********
********** Round-trip (with 4 sends/0 loads) for (+0/.0/-0) was total 1.35s (0.77s wait, 0.58s to process) **********
********** Round-trip (with 4 sends/0 loads) for (+2/.4/-0) was total 1.44s (0.24s wait, 1.20s to process) ********** 
```

（我添加了`wait`时间，即信息在发送之前在队列中停留的时间。）请注意，它与`to process`独立程序一样快。该问题仅体现在不断阅读和解析网页的问题上。（请注意，解析本身会占用大量 CPU）。

* * *

编辑：一些初步测试表明我应该为每个网页加载使用单独的过程......一旦启动并运行，将发布更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:25:02.393

可能是全局解释器锁 (GIL)。您是否尝试过使用多处理模块（主要是线程的替代品，IIRC）？

另请参阅[Python 代码性能随线程而降低](https://stackoverflow.com/questions/6821477/python-code-performance-decreases-with-threading?rq=1)

# django - 如何在 Django 中处理会话过期以进行 API 调用？

> ID：11039227
> 
> 赞同：0
> 
> 时间：2012-06-14T18:31:39.437
> 
> 标签：django, api, authentication

我有一个用 Django 1.3 构建的 Web 应用程序。我们还提供了 API 函数，这些函数返回 json，供移动应用程序使用。现在，对于身份验证，我们在视图中使用 login_required 装饰器。但是，对于 API，这不起作用，因为它返回 HTML（重定向到登录页面）并且移动设备有自己的登录屏幕。我们想要返回要求用户登录的 json 响应。

我们如何实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:52:12.283

您可以编写自己的装饰器。[请参阅https://github.com/django/django/blob/master/django/contrib/auth/decorators.py](https://github.com/django/django/blob/master/django/contrib/auth/decorators.py)的 login_required 代码。

您应该将 redirect_to_login 替换为代码以返回 json 错误消息。

# templates - NodeJS - EJS 模板引擎中的内部动态模板

> ID：11039233
> 
> 赞同：0
> 
> 时间：2012-06-14T18:31:55.793
> 
> 标签：templates, node.js, ejs

我想为菜单标题创建一个内部动态模板。我想为我的内部菜单模板发送当前页面的参数，位于主页模板中，并且根据 url，它应该显示不同的菜单项处于活动状态。我该怎么做？谢谢

**更新**我知道这一点：

```
<html>
  <head></head>
  <body>
    Blah blah blah
    <%- partial('menu') %>    
  </body>
</html> 
```

但我不知道如何将参数发送到内部模板

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T11:21:50.197

ejs 没有部分，但 Express 有：[http ://expressjs.com/guide.html#view-partials](http://expressjs.com/guide.html#view-partials)

一个使用 Express 和 EJS 的简单示例：

应用程序.js

```
var express = require('express'),
    app     = express.createServer();

app.configure(function() {
  app.set('view engine', 'ejs');
  app.use(express.methodOverride());
  app.use(express.bodyParser());
});

app.get('*', function(req, res, next) {
  res.render('list', { items: ['foo', 'bar', 'baz'], layout: false });
});

app.listen('9000'); 
```

意见/list.ejs

```
<ul>
    <%- partial('item', items) %>
</ul> 
```

意见/item.ejs

```
<li><%= item %></li> 
```

警告：Express 3.x 将不再包含部分，因此它只取决于模板渲染引擎来执行此操作。

# php - 输入标签后 7 天的日期

> ID：11039235
> 
> 赞同：0
> 
> 时间：2012-06-14T18:32:05.533
> 
> 标签：php, javascript, html, forms

我怎样才能给一个`<input>`标签一个值，以便在一周后始终设置？

我有今天的日期是

```
<script>
   document.getElementById('v_doc_fechaemision').value = (new Date()).format("yy/m/dd");
</script>

<input type="hidden" id="v_doc_fechaemision" name="v_doc_fechaemision"> 
```

如果我将其设置为 +7 天会怎样？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:33:56.987

试试这个代码

```
var days = 7;
var date = new Date();
var res = date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
alert(res); 
```

你也可以试试这个

```
var date = new Date();
date.setDate(date.getDate() + 7);

var dateMsg = date.getDate() + '/' + (date.getMonth()+1) + '/' + date.getFullYear();
alert(dateMsg); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T18:34:53.080

查看[http://www.php.net/manual/en/function.strtotime.php](http://www.php.net/manual/en/function.strtotime.php)

```
<?php echo strtotime("+1 week")?> 
```

或者

```
<?php echo strtotime("+7 days")?> 
```

因此，对于您的代码，您将执行以下操作：

```
<input type="hidden" id="v_doc_fechaemision" name="v_doc_fechaemision" value="<?php echo strtotime("+1 week"); ?>"> 
```

如果您需要`v_doc_fechaemision`比另一个输入中的值提前 7 天，则需要编写一些 AJAX 来更新该值。

# sql - sql join语句中表的顺序有什么意义吗

> ID：11039236
> 
> 赞同：14
> 
> 时间：2012-06-14T18:32:05.567
> 
> 标签：sql, database, oracle

sql join语句中表的顺序有什么意义吗？例如

```
SELECT dept_name, emp_name 
FROM   Employee 
INNER JOIN Department ON Employee.dept_id = Department.dept_id 
```

和

```
SELECT dept_name, emp_name 
FROM Department 
INNER JOIN Employee  ON Employee.dept_id = Department.dept_id 
```

表格的顺序是否有任何性能优势？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-14T18:36:03.037

不，没有。

大多数（如果不是全部）DBMS 使用基于成本的优化器。您指定语句的顺序不会影响执行速度。

[Oracle SQL 基于成本的优化](http://www.dba-oracle.com/art_otn_cbo.htm)

> Oracle 的基于成本的 SQL 优化器 (CBO) 是 Oracle 的一个极其复杂的组件，它控制着每个 Oracle 查询的执行。CBO 已经发展成为世界上最复杂的软件组件之一，它具有评估任何 SQL 语句并为该语句生成“最佳”执行计划的挑战性工作。

您的两个语句都将生成**相同的执行计划**，因此具有相同的性能特征。请注意，费用将基于可用的统计数据。更新的统计信息对于优化器能够生成最有效的执行计划非常重要。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-14T21:33:09.693

一般来说，不，这无关紧要。优化器应该能够找出连接表的最有效顺序，而不管它们在查询中出现的顺序如何。

但是，表的顺序可能会影响查询计划。如果您有一个简单的两个表连接，则通常不会出现这种情况，但是随着查询中表数量的增加，可能的连接数量会以 O(n!) 的速度增长。很快，优化器就不可能考虑所有可能的连接顺序，因此它必须使用各种启发式方法来修剪树。这反过来会导致优化器选择不同的驱动表，如果该表在 SQL 语句中首先列出，而不是当该表是查询中的第十个表时。Jonathan Lewis 有一篇不错的博客文章，展示[了查询中的订单表如何影响查询计划](http://jonathanlewis.wordpress.com/2006/11/03/table-order/). 如果您想格外小心，首先列出驾驶表是合理的做法——它不会很频繁地帮助，但偶尔可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T18:37:29.037

优化器将检查所有可能的连接顺序排列并采用具有最低成本值的排列。这意味着优化自身——准备语句——成为复杂语句的瓶颈。要加入的表越多，要检查的执行计划变体就越多——从数学上讲：n！（阶乘）。

来源：[http ://use-the-index-luke.com/sql/join](http://use-the-index-luke.com/sql/join)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T18:37:08.030

不会。优化器会找出最佳连接路径，或者至少它认为是最佳连接路径。在不寻常的情况下，有时它没有所需的所有信息，但 99% 的情况下它会正确处理。它还将在内部以其他方式重写 SQL 语句。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-14T18:48:39.567

正如其他回答者所说，不。
但想想你是否可以用左连接替换一些内连接。在大多数查询中，这对性能有好处

# java - 增加堆大小

> ID：11039237
> 
> 赞同：2
> 
> 时间：2012-06-14T18:32:08.830
> 
> 标签：java, scala, memory, garbage-collection, heap-memory

我已经阅读了 stackoverflow 中的各种帖子，并且试图弄清楚如何增加我的 JVM 的堆大小。我知道该命令`-vmargs -Xms256m -Xmx4096m`会增加堆大小。但它不起作用，或者我不知道如何使用该命令。我读到我应该转到 JVM 文件夹并键入此命令，但我无法在我的虚拟机中找到 Java。

我还读到我可以通过更改 eclipse.ini 文件中的值来做到这一点，但我无法在我的文件中找到与 heapsize 相关的任何内容。我可以做一个 grep java 并发现我的堆大小是 324m。

有人可以指导我在哪里以及如何增加堆大小吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T18:51:03.980

这取决于您尝试启动的应用程序。

如果您使用**java**可执行文件从命令行运行 java 代码，那么您可以简单地将这些参数作为参数传递给 java 可执行文件。

```
java -Xms256m -Xmx2096m <main class> 
```

如果您想增加 Eclipse 的 JVM 内存，则可以通过在文件末尾附加以下行来更新 eclipse.ini。

```
-Xms256m
-Xmx4906m 
```

对于任何使用 JVM 的软件（如 tomcat、weblogic 等），您需要按照他们的文档来设置 JVM 参数。通常，他们会提供启动脚本，您可以在其中选择设置 JVM 参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-14T21:27:27.217

如果您使用的是 Scala，则按照标签的建议，您使用`-J`作为必须传递给 Java 的参数的前缀。像这样：

```
scala -J-Xms256m -J-Xmx4096m 
```

这将以 256 MB 的初始内存和 4 GB 的最大内存运行解释器。

和可以使用相同的`scalac`东西`fsc`。

现在，如果你`java`用来运行东西，你只需直接传递它们：

```
java -Xms256m -Xmx4096m <some other stuff> 
```

如果您正在使用其他东西，请说出您使用的是什么，否则我们无法帮助您。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T18:49:26.043

你可以试试这个：

```
java -Xms64m -Xmx256m HelloWorld 
```

HelloWorld 被您的应用程序替换，其他参数根据您的喜好定制！

来源：http: [//viralpatel.net/blogs/jvm-java-increase-heap-size-setting-heap-size-jvm-heap/](http://viralpatel.net/blogs/jvm-java-increase-heap-size-setting-heap-size-jvm-heap/)

# symfony - 使用 EC2 部署 Symfony2 - 最佳实践

> ID：11039244
> 
> 赞同：3
> 
> 时间：2012-06-14T18:32:32.647
> 
> 标签：symfony, amazon-web-services

我想将 2 个 Symfony2 项目部署到 EC2 服务器上。此外，我正在考虑使用 scalr.net、ylastic.com 或 Rightscale 之类的服务来管理我的实例，在需要时对其进行扩展并对其进行监控。

我的问题基本上是：

1.) 你有什么建议。现在，我正在专用的 ubuntu 服务器上运行整个应用程序，但我已经到了需要获得可扩展能力和速度的地步——这实际上是我想迁移到 ec2 的主要原因（而且我还有很多S3)。

2.) 有没有推荐的对 Symfony2 有益的 AMI？我见过像[https://aws.amazon.com/marketplace](https://aws.amazon.com/marketplace)这样的服务，它们会为您提供预安装的图像，但会向您收费。不确定这是否有好处，因为我认为我也可以设置自己的服务器。

3.) 如果我使用 Ec2，最好将所有 Web 数据放到一个 ebs 卷上并使用 amazon 数据库作为数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:03:16.870

*以下是一些非常基本的想法，在开始处理您可能并不真正需要的事情之前，您应该仔细考虑所有事情。*

1.) 首先你应该看看你的应用程序消耗最多的资源。您需要大量内存、CPU、磁盘 I/O 吗？取决于您可以决定要利用哪些亚马逊网络服务。

例如，一个简单的场景是一个 ELB 与一个 Auto Scaling 组相结合，该组处理 EC2 实例，由一个 RDS 实例支持，该实例提供一个专用数据库。

2.) 您可以使用 BitNami 预配置的[LAMP](http://bitnami.org/stack/lampstack#cloudImage)，然后对其进行自定义。之后，创建您自己的 AMI 并将其用于您的 Auto Scaling 组（一种非常基本的方法）。另一方面，您可以从一个干净的 Linux 发行版开始并自己设置所有内容（手动或通过[Chef](http://wiki.opscode.com/display/chef/Home)自动设置）。根据您的应用程序将收到多少更新，您应该考虑将其托管在 github 上，以使您的服务器在启动时始终拉取它的最新副本。

3.) 取决于第 1 点。) ... 最简单的方法肯定是使用 RDS，因为 EBS 卷的磁盘 I/O 很差，您必须在 Raid 0 中运行它们才能获得数据库所需的磁盘 I/O服务器要拥有。

# ruby-on-rails - 有约束的 Rails 路线

> ID：11039245
> 
> 赞同：1
> 
> 时间：2012-06-14T18:32:40.140
> 
> 标签：ruby-on-rails, routes

我正在尝试捕获 UTF-8 URL。通常，使用约束效果很好。对于 URL：`/international-delight-iced-coffee/`路由有效：

```
match ":post_name", :constraints => { :post_name => /.+/}} 
```

一切都很好。它失败的地方是我需要使用高级约束：

```
match ":post_name", :constraints => Post.new

# inside Post.rb
self.matches?(request)
  puts ">>>> Arrived at matches!"
  Post.find_by_name(request.path_parameters[:post_name])
end 
```

`self.matches`永远不会被调用。知道如何使约束捕获吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:03:41.723

您是否需要想要匹配的控制器/动作（下面带有`to`参数）。

我有这样的事情：

```
match "/:vanity", to: 'vanity#routing', constraints: RoutingConstraint.new 
```

我的`RoutingConstraint#matches?`方法*受到*了打击。

我用你的 UTF-8 url 试过这个，它似乎工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-25T09:07:28.913

您的`.matches?`方法是一个类方法，但您`Post.new`作为约束传递。要么替换`Post.new`为`Post`，要么`self.`从方法定义中删除。

# arrays - 将查询数组传递给 codeigniter 视图

> ID：11039248
> 
> 赞同：0
> 
> 时间：2012-06-14T18:32:53.977
> 
> 标签：arrays, codeigniter

我在将数组传递给查看时面临问题。这是我的控制器代码..

```
function mobile_view_post($a)
    {
        log_message('debug',__FILE__.', '.__LINE__.', '.__CLASS__.'/'.__METHOD__.'/'.__FUNCTION__.'');
        $this->load->model('Mmobiles');
        data['message']=$this->Mmobiles->mobile_view_post($a);
        $this->load->view('mobile_view_post',$data);
        log_message('debug',__FILE__.', '.__LINE__.', '.__CLASS__.'/'.__METHOD__.'/'.__FUNCTION__.'');

    } 
```

模型代码返回超过 5 行..

```
function mobile_view_post($a)
    {
        log_message('debug',__FILE__.', '.__LINE__.', '.__CLASS__.'/'.__METHOD__.'/'.__FUNCTION__.'');
        //$output=false;
        $this->db->select('c1,c2,c3,c4');
        $this->db->from('ci_posts');
        $this->db->where('mobile_number',$a);
        $q=$this->db->get();
        $this->db->last_query();
        log_message('debug','******query '.$this->db->last_query().'  ********');
        if($q->num_rows()>=1)
        {

            return $q->row_array();
        }
        else
        {
            return 'No Reports';
        }

    } // end mobile_view_post 
```

但是这段代码不起作用。下面的行在控制器中给了我错误

```
 data['message']=$this->Mmobiles->mobile_view_post($a); 
```

查看代码：

```
<?php
print_r($message);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:19:23.827

改变

```
data['message']=$this->Mmobiles->mobile_view_post($a); 
```

至

```
$data['message']=$this->Mmobiles->mobile_view_post($a); 
```

并且错误消息在 index.php 中定义 - 确保您在“开发”环境中运行以查看错误。

# image - 卡罗弗雷德塞尔消失

> ID：11039249
> 
> 赞同：1
> 
> 时间：2012-06-14T18:33:02.603
> 
> 标签：image, wordpress, jquery-plugins, customization, caroufredsel

我正在使用 carouFredSel ( [http://caroufredsel.frebsite.nl/](http://caroufredsel.frebsite.nl/) ) 创建一个图像轮播，它已启动并正在工作 - 我的代码如下所示：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript" src="<?php bloginfo('template_directory'); ?>/js/jquery.carouFredSel-5.6.1.js"></script>

<script type="text/javascript">
        $(document).ready(function() {
            $(".carousel").carouFredSel ({
                align: "center",
                auto: false,
                circular: true,
                infinite: true,
                next: ".next",
                prev: ".prev",
                scroll: 1,
                width: 1072,
            });
        });
    </script> 
```

我只有一个小问题——希望如此。我正在使用的网站是[http://ellenandjosh.com/](http://ellenandjosh.com/)您可以在首页上看到 carouFredSel。

但是，如果您尝试单击上一个按钮，则轮播会消失。如果我已经按下下一个按钮，它会很好，但是当我直接按下前一个按钮时，就会发生这种情况。我期待它向我展示最后一张图片。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T23:19:41.573

以下是您修复它的方法：

在您的 CSS 中添加：

```
.carousel-thumbnail {height: 222px !important} 
```

问题是，一旦您单击返回，轮播就会感到困惑，并看到一个空列表将高度设置为 0px，并且元素消失了。

对于您的脚本，大小似乎有问题，因此请更改

```
 $(document).ready(function() { 
```

至

```
$(window).ready(function() { 
```

根据这里的提示：http: [//caroufredsel.frebsite.nl/support/tips-and-tricks.php](http://caroufredsel.frebsite.nl/support/tips-and-tricks.php)

它应该可以工作，但我只能使用 firebug 进行测试。

顺便说一句：您的脚本在字典中有尾随逗号，请将其删除，以便它可以在 IE 上运行 :)

# javascript - 使用 post 命令创建 KnockoutJS ViewModel 以填充 ViewModel

> ID：11039250
> 
> 赞同：0
> 
> 时间：2012-06-14T18:33:07.170
> 
> 标签：javascript, knockout.js, knockout-mapping-plugin

我正在尝试将来自服务器的模型通过 json 绑定到我在客户端上创建的视图模型，然后使用 Knockout.js 绑定它以显示数据。我有以下代码

```
function tireRunDataViewModel() {
        var self = this;

        self.load = function() {
            $.jQuery.post('./GetTireRunModel', { outingID: '@Model' }, function (result) {
                self.data = ko.mapping.fromJS(result);
            } , "json");
        };

        self.load();
    }

var viewModel = new tireRunDataViewModel();
ko.applyBindings(viewModel); 
```

在完成 ko.applyBindings 之前似乎没有设置 self.data 。为什么会这样？我可以做些什么来确保在完成 applyBindings 之前填写 self.data？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:40:58.620

调用`$.jQuery.post`是异步的，所以回调在完成之前不会执行，也就是 after`ko.applyBindings`被调用。

几个选项：

*   你可以打电话给`ko.applyBindings`你的回调。如果您的应用程序没有比这更复杂，那么可以选择在 AJAX 调用完成后应用绑定。

*   您可以将其创建`self.data`为可观察对象，然后在回调中更新它，例如：`self.data(ko.mapping.fromJS(result));`。然后在您的 UI 中，您可以在依赖于的 UI 周围使用`with`绑定，以便在准备好之前不会渲染它。`data``data`

快速模拟它：http: [//jsfiddle.net/rniemeyer/Wf8E8/](http://jsfiddle.net/rniemeyer/Wf8E8/)

# c++ - 使用 Qt 连接到本地数据库

> ID：11039252
> 
> 赞同：1
> 
> 时间：2012-06-14T18:33:18.523
> 
> 标签：c++, mysql, database, qt

我在 localhost:3306 上运行了一个本地数据库，我使用 MySQL Workbench 访问它。这很好用，我可以创建更改，做我想做的任何事情。我有两个模式，“test”和“test2”。

我想通过 Qt 连接到它。这是我的代码：

```
QSqlDatabase m_db = QSqlDatabase::addDatabase("QPSQL"); 
m_db.setHostName("localhost");
m_db.setDatabaseName("test");
m_db.setPort(3306);
m_db.setUserName("root");
m_db.setPassword("MyAwesomePasswordThatIsUnHackableAndNotMyBirthdayAtAll...");
bool ok = m_db.open(); 
```

我按照这里找到的示例[QSqlDataBase 类参考](http://qt-project.org/doc/qt-4.8/qsqldatabase.html)

并且 m_db.open() 总是返回 false。我不太确定我必须将什么传递给 addDataBase() 或 setDataBaseName。谢谢您的帮助！

编辑：如果我使用 addDatabase("QMYSQL") 错误是“未加载驱动程序”我在 Windows 7 上，使用 Qt 4.8.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:16:30.650

没有安装 MySQL 预编译插件。你必须自己编译它。或者您也可以使用 ODBC 网关连接您的 MySQL 数据库，因为 QODBC 插件已安装或可以轻松编译（无需 MySQL 开发库）。

# java - 验证是否使用任何参数调用方法

> ID：11039255
> 
> 赞同：1
> 
> 时间：2012-06-14T18:33:37.153
> 
> 标签：java, unit-testing, mocking, mockito

我的管理器类中有一个简单的更新方法，我需要验证是否触发了事件。

```
public void editUser(User user) {
       entityManager.merge(user);
       entityManager.flush();
       updateEvent.fire(new UserEvent(user));
} 
```

通常我会通过 verify 方法来做到这一点，但在这种情况下 event.fire() 是用 UserEvent 的新实例作为其参数调用的。

```
verify(event).fire(new UserEvent(user)); 
```

这将失败，因为在管理器中使用不同的 UserEvent 实例触发了事件。有没有办法验证这个方法调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:38:02.720

[最简单的方法是使用`any(Class<T>)`](http://docs.mockito.googlecode.com/hg/latest/org/mockito/Matchers.html#any%28java.lang.Class%29)：

```
verify(event).fire(any(UserEvent.class)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T12:27:23.793

如果`UserEvent`（并取决于实施`User`）实施`equals(...)`，那么它应该可以工作。

# flash - 当我将 .DAE 文件从 blender 2.5 导入到 Papervision 3D 2.1 时什么也不显示，为什么？

> ID：11039256
> 
> 赞同：0
> 
> 时间：2012-06-14T18:33:39.123
> 
> 标签：flash, 3d, blender, papervision3d

我在搅拌机（2.5）中创建了一个立方体并应用了材料和纹理。但是当我将该模型导入 Papervision 3d (2.1) 时，我什么也看不到 - 只是一个空白屏幕。另一方面，如果我使用任何其他 .dae 模型（例如，我指的是 Papervision3D Essentials 书籍，所以我使用了这些示例），那么我可以看到该模型。有什么问题？为什么我从搅拌机导出的模型不起作用？

这是我的脚本：

```
package {

    import flash.events.Event;

    import org.papervision3d.events.FileLoadEvent;
    import org.papervision3d.events.InteractiveScene3DEvent;
    import org.papervision3d.materials.BitmapMaterial;
    import org.papervision3d.materials.ColorMaterial;
    import org.papervision3d.materials.utils.MaterialsList;
    import org.papervision3d.objects.DisplayObject3D;
    import org.papervision3d.objects.parsers.DAE;
    import org.papervision3d.view.BasicView;
    import org.papervision3d.objects.parsers.Collada;

    public class modelTest extends BasicView
    {
        private var model:DisplayObject3D;
        private var distance:Number = 1000;
        private var speed:Number = 0.2;
        private var rangeX:Number = 0.02;
        private var rangeY:Number = 0.02;
        private var rangeZ:Number = 0.05;
        private var targetRotationX:Number = 0;

        public function modelTest()
        {   
            stage.frameRate = 40;

            init();
            startRendering();
        }

        private function init():void
        {
            model = new DAE();
            DAE(model).load("assets/cube.dae");
            scene.addChild(model);

            viewport.interactive = true;
            model.addEventListener(FileLoadEvent.LOAD_COMPLETE, modelLoaded);
        }

        private function modelLoaded(e:FileLoadEvent):void
        {
            trace("Used materials by this model: " + model.materials);
            true).addEventListener(InteractiveScene3DEvent.OBJECT_CLICK, click);
        }

        override protected function onRenderTick(e:Event=null):void
        {   
            super.onRenderTick();
        }
    }
} 
```

这是输出：

```
INFO: Papervision3D 2.1 rev920 (August 11th, 2009)

INFO: Viewport autoScaleToStage : Papervision has changed the Stage scale mode. 
INFO: DisplayObject3D: COLLADA_Scene 
INFO: DisplayObject3D: Cube 
INFO: DisplayObject3D: Lamp 
INFO: DisplayObject3D: Camera 
Used materials by this model: Material_001-material 
```

搅拌机文件：http: [//imageedit.netai.net/cube.blend](http://imageedit.netai.net/cube.blend)

DAE 文件：http: [//imageedit.netai.net/cube.dae](http://imageedit.netai.net/cube.dae)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T15:22:07.347

PV3D 尚未保持最新状态，如果您希望利用 Stage3D（用于 3d 场景的 Flash GPU 加速），您将需要尝试 Away3D 或其他一些引擎。

话虽这么说，我已经有一段时间没有接触 PV3D 的东西了，但我记得我必须非常具体地说明我的 Collada 几何是如何编写的——Papervision3D 中的解析器只读取规范的一个子集（如果它试图阅读完整的规范，解析器将是巨大的 - 为什么 Away3d 不支持它的部分原因）

搜索“Collada blender export for Papervision”会在网上看到一些有用的帖子，例如：

[http://osflash.org/pipermail/papervision3d_osflash.org/2007-February/001726.html](http://osflash.org/pipermail/papervision3d_osflash.org/2007-February/001726.html)

告诉我们您的 Collada 导出必须有三角形。

或者，您可以深入研究 Collada Parser 并找出它在寻找什么——您会看到加载器只在寻找三角形，并且只在 XML 中的特定位置。

# c++ - 在 C++ for 循环中使用向量时出现堆错误？

> ID：11039260
> 
> 赞同：1
> 
> 时间：2012-06-14T18:33:54.723
> 
> 标签：c++, memory, memory-management

在 for 循环中声明和使用向量是否存在任何已知的堆损坏问题？例如这样做：

```
for(int i = 0; i < N; ++i) {
   std::vector<int> vec;
   for(int j = 0; j < 3; ++j) {
      vec.push_back(0); //-Initialize
   }
   ...
   ...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:34:55.827

不，这很好，但是可以使用相同的效果获得

```
std::vector<int> vec(3,0) 
```

而不是第二个循环。

# jquery - Cufoncanvas 替换样式

> ID：11039266
> 
> 赞同：0
> 
> 时间：2012-06-14T18:34:27.080
> 
> 标签：jquery, css, internet-explorer-8, cufon

如何在 IE8 中更改 cufoncanvas css

```
<cufoncanvas style="left: 0px; top: 1px; height: 27px;" cufid="215"> 
```

我试过`$(document)`：

```
$(document).ready(function()  {
    $("cufoncanvas").css({
      top: '10px'
    });
});
cufon.refresh(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:47:53.657

设法通过删除来修复它`$(document).ready(function()`

以便

```
$("cufoncanvas").css({

      top: '10px'
    }); 
```

# java - 小程序 jwindow 始终设置在顶部 JNLP

> ID：11039277
> 
> 赞同：0
> 
> 时间：2012-06-14T18:34:58.297
> 
> 标签：java, browser, applet, awt, jwindow

在启动通过浏览器创建 JWindow 的小程序时，java 控制台会抛出以下 AccessControlException：

访问被拒绝 java.awt.AWTPermission "setWindowAlwaysOnTop"

我希望 JFrame 始终位于顶部，在策略文件中授予权限以及使用特权代码，但它不能解决问题。我应该怎么做？

```
import java.applet.Applet;
import java.awt.Color;
import java.awt.Font;
import java.security.AccessController;
import java.security.PrivilegedAction;

import javax.swing.JButton;
import javax.swing.JFrame;

public class appletJFrame extends Applet
{

public void start()
{
    //create a frame
    final JFrame frame = new JFrame("FrameDemo");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true); 

    //add a button
    JButton doneButton = new JButton("demo");
    doneButton.setFont(new Font("Calibri", doneButton.getFont().getStyle(), doneButton.getFont().getSize()));
    doneButton.setBackground(new Color(53,168,51));

    frame.getContentPane().add(doneButton);

    AccessController.doPrivileged(
            new PrivilegedAction<Object>() 
            {
                   public Object run()
                   {
                       frame.setAlwaysOnTop(true);//gives an error for this
                       return null;
                   }
            }

          );

}

} 
```

这是我用来启动应用程序的 JNLP 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<jnlp spec="1.0+" href="Launcher.jnlp">

<information>
    <title>xyz</title>
    <vendor>xyz</vendor>
</information>

<resources>
    <!-- Application Resources -->
    <j2se version="1.6+"
          href="http://java.sun.com/products/autodl/j2se"/>
    <jar href="MyJar.jar"
        main="true" />      //can be resolved
    <jar href="jna.jar" />     //cannot be resolved(used as imports in main class)
    <jar href="platform.jar" />    //cannot be resolved(used as imports in main class)
    <jar href="xuggle-xuggler.jar" />    //cannot be resolved(used as imports in main class)
    <jar href="xuggle-xuggler-test.jar" />    //cannot be resolved(used as imports in main class)

</resources>

<application-desc
     name="Example"
     main-class=
       "Launch"
     width="300"
     height="300">
</application-desc>

<security>
 <all-permissions/>
</security>

<offline-allowed />

<update check="background"/>

</jnlp> 
```

除了 MyJar.Jar 中的类，我得到所有类的无类定义 excwption。

# javascript - 无法在 javascript 数组中播放音频文件

> ID：11039280
> 
> 赞同：0
> 
> 时间：2012-06-14T18:35:07.853
> 
> 标签：javascript

我正在尝试创建一个按钮，单击该按钮会播放音频文件，然后再次单击该按钮会播放数组中的下一个文件。我让它播放，但是当我第二次点击它时，它会播放第一个文件和第二个文件。当我第三次按下它时，它会播放第一，第二和第三。似乎我需要重置某些内容或其他内容以清除页面的前两个轨道。这是我所拥有的：

```
 <!DOCTYPE HTML>
    <html>
    <head>
    </head>
    <body>

    <script language="javascript" type="text/javascript">

        audio = new Array('audio1.mp3','audio2.mp3','audio3.mp3');
        index = 0;

        function playSound() {
        if(index<3){
        document.getElementById("start").innerHTML=document.getElementById("start").innerHTML +
        "<embed src=\""+audio[index]+"\" hidden=\"true\" autostart=\"true\" loop=\"false\" />";
        index++;
        }
        else{ index = 0;
        document.getElementById("start").innerHTML=document.getElementById("start").innerHTML +
        "<embed src=\""+audio[index]+"\" hidden=\"true\" autostart=\"true\" loop=\"false\" />";
        index++;
        }

    }

     </script>

                <button id="start" type = "button" onclick="playSound();">Start</button>

    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:38:32.757

你不断地添加越来越多的`<embed>`元素，从不删除任何一个。

与其将它们附加到按钮上，不如将它们附加到容器中，然后在添加另一个容器之前将其删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:41:44.797

```
function playSound() {
    if(index>=3){
         index = 0;
    }
    document.getElementById("sound").innerHTML=
    "<embed src=\""+audio[index]+"\" hidden=\"true\" autostart=\"true\" loop=\"false\" />";
    index++;
} 
```

并添加一个 div（您也可以使用 css 将其隐藏），我认为这比将 html 添加到按钮更好。

```
<button id="start" type = "button" onclick="playSound();">Start</button>
<div id="sound" style="display:none"></div> 
```

# javascript - 基于表单元素的选定值动态更改表单字段标签的技术

> ID：11039281
> 
> 赞同：0
> 
> 时间：2012-06-14T18:35:11.323
> 
> 标签：javascript, html, forms

我有一个相对简单的 HTML / JavaScript 表单。比如这样：

```
<form method='POST' action='someurl'>
    <label for='field1'>Your name</label>
    <input id='field1' name='field1' type='text' />

    <label for='field2'>Status</label>
    <select id='field2' name='field2'>
        <option>-select one-</option>
        <option value='Employee'>Employee</option>
        <option value='Retiree'>Retiree</option>
    </select>

    <label for='field3'>City you work in</label>
    <input id='field3' name='field3' type='text' />
</form> 
```

我需要做的是根据 field2 中的选定值更改 field3 标签内的文本。因此，当 field2 选择了“员工”时，field3 标签显示“您工作的城市”，但是当 field2 选择了“退休人员”时，field3 的标签应该是“您居住的城市”。

我所做的一种解决方案是在 field3 标签内有多个标签，然后使用一些 JavaScript 我可以切换标签内的哪些标签正在显示，如下所示：

```
// Form as above
<label for='field3'>
    <span id='field3EmployeeLabel' style='display:none;'>City you work in</span>
    <span id='field3RetireeLabel' style='display:none;'>City where you live</span>
</label>
<input id='field3' name='field3' type='text' />

function updateLabel() {
    if($('#field2').val()=='Employee') {
        $('#field3RetireeLabel').hide();
        $('#field3EmployeeLabel').show();
    } 
    else if($('#field2').val()=='Retiree') {
        $('#field3EmployeeLabel').hide();
        $('#field3RetireeLabel').show();
    }
    else {
        $('#field3RetireeLabel').hide();
        $('#field3EmployeeLabel').show();       
    }
} 
```

我不喜欢这个的主要原因是这一切都必须手动编码，而这只是一个简单的例子，如果field2中有7或8个不同的选项怎么办？另外，如果我必须组合多个表单字段值来确定要显示哪个标签怎么办？

HTML 中是否有此类事情的设计模式或最佳实践？其他人是如何处理他们表格上的这种要求的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:43:54.237

创建一个值到标签的映射以显示[http://jsfiddle.net/mendesjuan/VBVtE/3/](http://jsfiddle.net/mendesjuan/VBVtE/3/)当您添加新选项时，只需将它们添加到标签映射。

**JS**

```
$('#field2').change(function() {
    var labels = {
        'Employee' : 'City you work in',
        'Retiree' : 'City you live in',
        '-select one-': 'Default value'
    }      
    $("label[for='field3']").html(labels[$(this).val()]);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:43:22.513

我可能会像这样解决它（当然是在一个孤立的范围内）：

```
var labelEl = $( "label[ for='field3' ]" ),
    labels  = { Employee : "City in which you work",
                Retiree  : "City where you live"
              }
;

$('#field2').change( function() {
  // choose the correct label (default to the Employee label)
  var newLabel = labels[ $(this).val() ] || labels.Employee;

  labelEl.text( newLabel ); // change the label text
} ); 
```

该函数显然可以简化为单行，避免创建`newLabel`，但为了便于阅读，我将其保留原样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:43:20.047

好吧，我建议如下：

```
<label id="label3" for="field3">
  <span id="label3_Employee">City you work in</span>
  <span id="label3_Retiree">City you live in</span>
</label>
<script type="text/javascript">
  function updateLabel() {
    $('label#label3 span').hide();
    $('label#label3 span#label3_' + $('#field2').val()).show();
  }
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T20:09:47.797

@Juan 和 @Jordan 的答案的组合怎么样：（两者都很棒，谢谢！）

```
$('#field2').change(function() {
    var labels = {
        'Employee' : 'City you work in',
        'Retiree' : 'City you live in',
        'default': 'Default value'
    }      
    $("label[for='field3']").html(labels[$(this).val()] || labels['default']);
}); 
```

这允许该字段具有默认值，而无需在标签列表中专门指定每个可能的选项，我需要指定的只是与默认值不同的情况。

# ruby-on-rails - 如何将 AuthLogic 配置为仅对某些用户（管理员）超时会话？

> ID：11039283
> 
> 赞同：0
> 
> 时间：2012-06-14T18:35:18.697
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, authlogic

我们有一个业务需求，即某些用户在一段时间不活动后会自动退出我们的应用程序。允许其他用户保持登录状态并且不应超时。我们使用 AuthLogic 和 Rails 3 进行会话管理。

我怎样才能让某些用户的 AuthLogic 会话超时，而其他用户则不能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:35:19.507

用户必须有一个 last_request_at 列，然后将其添加到 UserSessions 模型中。您可以在陈旧的情况下执行您喜欢的任何检查吗？此处超时仅发生在管理员身上。

```
logout_on_timeout true

def stale?
  user.present? && user.admin? && super
end 
```

# python - 如何有不同的py文件来处理不同的路由？

> ID：11039287
> 
> 赞同：3
> 
> 时间：2012-06-14T18:35:20.307
> 
> 标签：python, python-2.7, flask, webapp2

我已经学习 python 有一段时间了，最​​近我决定开始学习 web 开发方面的东西。我有使用 PHP 和 PHP 框架以及 ruby​​ 的经验，其中：

*   路由在（单个）文件中定义，然后在该文件中，每个路由都分配给一个模型（py 文件），该模型将唯一地处理与该路由匹配的传入请求。

如何使用**flask** AND **webapp2**实现这一目标？

我完整阅读了文档和教程，但这让我很困惑。我只想要一个文件，其中设置了所有路由以及应该如何处理它们，然后每个路由请求都由它自己的模型（python 文件）处理。

所有示例都指向单文件应用程序。

非常感谢，真的。请教，亲切，简单的方式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T22:37:30.077

Webapp2 实际上开箱即用地提供了这一点 -`WSGIApplication`类实例`Router`在其`router`属性中提供了一个实例，可用于集中式 URL 映射[，如文档中所示](http://webapp-improved.appspot.com/guide/app.html#router)。

Flask 没有，但这实际上以最基本的形式记录在[Patterns for Flask: Lazy Loading](http://flask.pocoo.org/docs/patterns/lazyloading/)中。使用`LazyView`它定义的类，您可以构建一个系统来提供中央 URL 映射 - 可以是每个模块中的预定义符号，也可以是模块中的特定函数或类实例。

实际上，我最近发布了一个包 ( [HipPocket](http://pypi.python.org/pypi/HipPocket) )，它提供了包装器来简化此模式的入门。它为此提供了两个类[`LateLoader`](https://github.com/svieira/HipPocket/commit/979af48cbfe74dd8aa3123de84cb1d5f6f1f2ff5#L3R92)和[`Mapper`](https://github.com/svieira/HipPocket/commit/979af48cbfe74dd8aa3123de84cb1d5f6f1f2ff5#L3R110). 使用 HipPocket，您的中央路由配置文件可能如下所示（假设包布局类似于[此处讨论的](http://flask.pocoo.org/docs/patterns/packages/#simple-packages)内容）：

**应用程序.py**

```
from flask import Flask

app = Flask("yourapp")
# ... snip ... 
```

**网址.py**

```
from .app import app
from hip_pocket import Mapper

mapper = Mapper(app)

mapper.add_url_rule("/", "index.index")
mapper.add_url_rule("/test", "index.test_endpoint", methods=["POST"])

mapper.add_url_rule("/say-hello/<name>",
                        "say_hello.greeter",
                        methods=["GET", "POST"]) 
```

**索引.py**

```
def index():
    return "Hello from yourapp.index.index!"

def test_endpoint():
    return "Got a post request at yourapp.index.test_endpoint" 
```

**say_hello.py**

```
def say_hello(name=None):
    name = name if name is not None else "World"
    return "Greetings {name}!".format(name=name) 
```

**运行应用程序.py**

```
from yourapp.app import app
from yourapp.urls import mapper
# We need to import the mapper to cause the URLs to be mapped.

if __name__ == "__main__":
    app.run() 
```

[欢迎请求请求](https://github.com/svieira/HipPocket/pulls)和[问题报告](https://github.com/svieira/HipPocket/issues)！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T20:06:55.160

根据我使用烧瓶的经验，您不能在中央文件中声明路由配置。路由处理是通过使用路由声明来完成的。根据我对 python 框架的经验，路由处理是在更精细的函数级别而不是文件级别完成的。即使在确实有更集中的路由配置设置的框架中，路由也被定义为与特定的视图/控制器功能相关联，而不仅仅是一个 python 文件。

如前所述，每个框架都以不同的方式处理它。我详细研究过的三个框架，django、pyramid 和 flask，都以不同的方式处理它。与您要查找的内容最接近的是 django，它有一个 urls.py 文件，您可以在其中放置所有 url 配置，但它再次指向功能级别项目，而不是更高级别的 .py 文件。Pyramid 将 url 声明的一部分放入**__ *init* __**主模块的 .py 文件并使用装饰器将命名路由与函数相关联。然后你有烧瓶，你提到已经看过它，它似乎只是为了“简单起见”而使用装饰器，因为它们试图减少需要使用或编辑来获取应用程序的整体文件和配置文件的数量概念进入服务空间。

# java - 如何从android中的另一个应用程序定义应用程序的屏幕方向？

> ID：11039288
> 
> 赞同：2
> 
> 时间：2012-06-14T18:35:25.607
> 
> 标签：java, android

我有一个应用程序，可以从中获取所有已安装应用程序及其图标的列表。这是我的代码：

```
package com.powergroupbd.appfilter;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.Iterator;
import java.util.List;

import android.app.Activity;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.graphics.drawable.Drawable;
import android.os.Bundle;
import android.util.Log;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class ApplicationFilterActivity extends Activity {
    /** Called when the activity is first created. */

    ListView appfilter;
    // ArrayAdapter<Applications> adapter;
    PackageManager pck;
     ArrayList<Applications> results = new ArrayList<Applications>();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        appfilter = (ListView) findViewById(R.id.lvApp);

        PackageManager packageManager = this.getPackageManager();
        List<PackageInfo> applist = packageManager.getInstalledPackages(0);
        Iterator<PackageInfo> it = applist.iterator();
        while (it.hasNext()) {
            PackageInfo pk = (PackageInfo) it.next();
results.add(new Applications(pk.applicationInfo.loadIcon(packageManager), ""+pk.applicationInfo.loadLabel(packageManager)));
            Log.i("AppName", ""+pk.applicationInfo.loadLabel(packageManager));
}

         Collections.sort(results, new Comparator<Applications>() {
         @Override
         public int compare(Applications c1, Applications c2) {
         return c1.getAppname().compareToIgnoreCase(c2.getAppname());
         }
         });

        appfilter.setAdapter(new Customarrayadapter(this, results));
    }
} 
```

但现在我希望如果我点击一个列表项，那么该特定应用程序将从下一次开始以横向打开，我需要想法我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:23:18.630

我个人的经验是，您尝试做的事情是不可能的。无法从另一个应用程序强制应用程序仅以横向模式显示。如果我对您的理解正确，即使设备处于纵向状态，您也希望以横向模式打开所选应用程序，对吗？

# php - preg_replace 图像源

> ID：11039292
> 
> 赞同：0
> 
> 时间：2012-06-14T18:35:36.793
> 
> 标签：php, preg-replace, data-uri

我正在尝试扫描我的内容并用其他东西替换图像源标签（更值得注意的是，支持时的 dataURIs） - 基于我在这里阅读的几个问题，我正在尝试`preg_replace()`：

```
// Base64 Encodes an image
function wpdu_base64_encode_image($imagefile) {
    $imgtype = array('jpg', 'gif', 'png');
    $filename = file_exists($imagefile) ? htmlentities($imagefile) : die($imagefile.'Image file name does not exist');
    $filetype = pathinfo($filename, PATHINFO_EXTENSION);
    if (in_array($filetype, $imgtype)){
        $imgbinary = fread(fopen($filename, "r"), filesize($filename));
    } else {
        die ('Invalid image type, jpg, gif, and png is only allowed');
    }
    return 'data:image/' . $filetype . ';base64,' . base64_encode($imgbinary);
}

// Do the do
add_filter('the_content','wpdu_image_replace');
function wpdu_image_replace($content) {
    $upload_dir = wp_upload_dir();
    return preg_replace( '/<img.*src="(.*?)".*?>/', wpdu_base64_encode_image($upload_dir['path'].'/'.\1), $content );
} 
```

我遇到的问题`wpdu_base64_encode_image($upload_dir['path'].'/'.\1)`是基本上输出`preg_replace`结果 - 目前得到：

```
Parse error: syntax error, unexpected T_LNUMBER, expecting T_STRING 
```

`$upload_dir['path']`正在正确输出我需要的图像文件夹的路径，但还有一些我已经尝试过但目前还无法实现的检查：

1.  检查图像源是否是相对的，如果是，则剥离域（目前可以这样做`site_url()`，我假设需要是的`preg_replace()`？）
2.  如果图像甚至不是服务器本地的（再次 - 我假设使用`site_url()`检查），请跳过它

`preg_replace()`如果有人有建议，我不那么熟悉，我会非常感激。谢谢！

**编辑：**我应该改用[http://simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)吗？看起来像一个相当重的锤子，但如果这是一种更可靠的方法，那么我完全赞成 - 有人以前用过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T22:40:59.963

通常，使用正则表达式解析 HTML 并不是一个好主意，您绝对应该考虑使用其他东西，例如适当的 HTML 解析器。您并不需要 simplehtmldom，它是内置的，`DOMDocument`并且[`getElementsByTagName`](http://www.php.net/manual/en/domdocument.getelementsbytagname.php)会很好地完成这项工作。

为了解决您当前的问题，这种类型的转换（您希望每个替换都是匹配的*任意函数*[`preg_replace_callback`](http://www.php.net/manual/en/function.preg-replace-callback.php)）使用以下方法完成：

```
$path = $upload_dir['path']; // for brevity

return preg_replace_callback(
    '/<img.*src="(.*?)".*?>/',
    function ($matches) use($path) { 
        return wpdu_base64_encode_image($path.'/'.$matches[1]);
    },
    $content
); 
```

您当前的代码尝试`\1`在完全不相关的上下文中使用占位符，这就是您收到解析错误的原因。

# javascript - 使用 .click() 两次

> ID：11039295
> 
> 赞同：-2
> 
> 时间：2012-06-14T18:35:44.910
> 
> 标签：javascript, jquery

我现在的功能设置为在鼠标悬停时为弹出窗口设置动画，并在鼠标离开该区域时关闭弹出窗口。

**我想调用 .click() 两次**。我一直在玩，`.click()`只能让它运行一次，因为当使用两次时，它会尝试同时调用这两个`.click()`函数。

我的功能是

```
$('#sdt_menu > li').bind('mouseenter',function(){
} 
```

和

```
.bind('mouseleave',function(){
} 
```

我尝试将点击放入其中一个功能，

```
$('#sdt_menu > li').bind('click',function(){
} 
```

效果很好，但我不能在它们两个中使用它，所以我想我需要为每个 .click() 重写并添加新函数，但我仍然不知道如何使用它两次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T20:02:00.117

我能够使用`toggle`jquery 的默认函数，它的基本功能是

```
$("#sdt_menu > li").toggle(
    function(){
        // hide...
    },
    function(){
        // show...
    }
); 
```

`std_menu > li`我提供的内容在哪里，然后在我的函数中输入了两个切换函数

# linux - linux进程不断断开连接

> ID：11039299
> 
> 赞同：1
> 
> 时间：2012-06-14T18:36:09.013
> 
> 标签：linux, tcp, boost-asio

我编写了一个当前在 Ubuntu 12.04 x64 VM 上运行的服务器应用程序。应用程序连接到另一台服务器，从该服务器获取一些数据，对其进行转换，然后将其发送回在其他地方运行的客户端应用程序。所有这些都超过了 TCP 之上的 boost::asio。IO相当重。

每天经过几个小时左右的操作后，我们都会看到我们的服务器断开客户端连接。当客户端尝试重新连接时，它们的连接一旦建立就会再次断开。boost::asio 的错误报告是“Connection reset by peer”。这似乎无限期地持续下去。在此期间，我可以 ssh 进入机器，并且从我们的应用程序到服务器进程的连接仍然健康。负载适中。重新启动我们的应用程序可以解决问题。

关于如何进一步调查的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:34:19.550

当 clinet 应用程序尝试连接时出现错误““对等连接重置”意味着端口应用程序尝试连接可能未打开或已打开，但无法接收其他连接（服务器具有最大数量的未接受连接）。

在网络级别上，您会看到`SYN`客户端发送到服务器，服务器以`RST`.

在服务器上运行`netstat -antp`并查看服务器端口是否处于`LISTEN`状态。

# nginx - 在 DNS 切换之前在 NGINX 上测试域

> ID：11039302
> 
> 赞同：1
> 
> 时间：2012-06-14T18:36:23.180
> 
> 标签：nginx, dns

我正在寻求一些帮助，以便在切换实际 DNS 之前为 nginx 配置我的 .conf 文件以指向域进行测试。

我有以下内容：

1.  Maindomain.com 运行 WordPress 安装
2.  comingsoon.com 在下面列出的目录中运行一个基本的 PHP 站点。

我想访问诸如 maindomain.com/comingsoon 之类的 url 上的comingsoon.com 内容

我觉得我走在正确的轨道上，但是当我得到 404 时可能会遗漏一些东西。

这是我的conf文件：

```
server {
  server_name maindomain.com;
  root /var/www/maindomain.com/public/;
  listen 8080;
  index index.html index.htm index.php;

  location / {
  try_files $uri $uri/ /index.php?q=$uri&$args;
  }                                      

  location /comingsoon { 
    root /var/www/comingsoon.com/public/;      
    index index.html index.htm index.php;
  }                                        

  location ~ \.php$ {
    fastcgi_intercept_errors on;
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    fastcgi_pass unix:/dev/shm/php-fpm-www.sock;
  }                                        
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:20:02.367

您始终可以通过在主机文件中添加记录来手动设置 www.comingsoon.com 以指向 nginx 服务器。除此之外，你为什么 gey 404 并不明显。首先猜测是：

```
location /comingsoon { 
    root /var/www/comingsoon.com/public/;
} 
```

这意味着**“index index.html index.htm index.php”**文件将被搜索到目录**/var/www/comingsoon.com/public/comingsoon/**。这是真正的目录吗？

编辑：为避免将位置添加到根目录，请使用别名：

```
location /comingsoon { 
    alias /var/www/comingsoon.com/public/;
} 
```

这样文件 /commingsoon/index.html 将在 /var/www/comingsoon.com/public/index.html 上提供。有关别名的更多信息 - 此处：[http ://wiki.nginx.org/HttpCoreModule#alias](http://wiki.nginx.org/HttpCoreModule#alias)

# jsf - Netbeans 中的 Facelets 页面更改未反映在浏览器中，项目中的文件上有感叹号

> ID：11039309
> 
> 赞同：0
> 
> 时间：2012-06-14T18:37:01.023
> 
> 标签：jsf, netbeans, facelets

我已将一个 JSF/Facelets 项目从 SVN 导入 Netbeans。我在 Facelets 页面中所做的任何更改都不会反映在浏览器中，即使我重新部署了项目。

`!`当我在 Netbeans 中检查我的项目的 webapp 文件夹时，我会在该 Facelets 文件上看到一个感叹号符号。同样在 Netbeans 中它变成了绿色，当我将鼠标悬停在它上面时，它说是本地修改的。

即使我保存页面，它似乎也忽略了我的更改。这是如何引起的，我该如何解决？

更新：我可以看到 http://localhost:8080/portal-war/pages/displayMain.jsf 中的页面。但是当我转到这个“http://localhost:8080/portal/pages/displayMain.jsf”时，变化并没有反映出来。数据库数据未显示在反映更改的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:51:25.413

SVN 概念：

*   绿色符号表示该文件类似于存储库的“最新”版本。这最后一次实际上意味着您最后一次结帐或更新。
*   感叹号 (!) 表示该文件已在本地进行了修改，并且未提交更改。从另一个角度来看，这意味着您正在使用该文件，并且在您提交更改时它会变成绿色。

也许你没有足够的权限在设置构建结果的文件夹中写入（这意味着带有 WAR 的文件夹），所以无论你尝试部署多少次，它总是会部署你的最后一个版本已从存储库中签出。

在最后一种情况下，您不能在该文件夹中写入，您可以使用包含转到文件夹的脏黑客，右键单击它并取消选中只读属性，但不要提交此更改！之后，尝试重建您的应用程序并查看您的更改是否对您可见。

# embedded-linux - 带有busybox自动登录的嵌入式linux

> ID：11039316
> 
> 赞同：1
> 
> 时间：2012-06-14T18:37:20.503
> 
> 标签：embedded-linux, autologin, busybox

我需要制作一个 QT 应用程序，以便在我制作的嵌入式 linux 系统启动时运行。我可以通过串口 ttySAC0 访问系统。我尝试将应用程序添加到 inittab ，它运行但 tslib 不工作，可能是因为它找不到它需要工作的环境变量，因为我在 /etc/.profile 文件中设置了这些环境变量，该文件在用户之后运行登录。我需要自动登录用户，以便设置环境变量以便 tslib 可以工作，或者在不登录的情况下设置这些环境变量。系统是用 buildroot 和 busybox 制作的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T15:32:32.230

我想通了，我做了这个shell脚本：

```
#!/bin/sh
#
#Sets necessary environment variables and runs the desktop
#

export TSLIB_TSDEVICE=/dev/touchscreen-1wire
export TSLIB_TSEVENTTYPE=INPUT
export TSLIB_FBDEVICE=/dev/fb0
export TSLIB_PLUGINDIR=/usr/lib/ts/
export TSLIB_CONSOLEDEVICE=none
export TSLIB_CONFFILE=/etc/ts.conf
export TSLIB_CALIBFILE=/etc/pointercal
export LD_LIBRARY_PATH=/usr/lib
export QTDIR=/usr/lib/qt
export QWS_MOUSE_PROTO=tslib:/dev/touchscreen-1wire

/path/to/application -qws 
```

然后使其可执行：

```
$chmod +x startup.sh 
```

然后将此行添加到inittab：

```
tty1::once:/path/to/startup.sh 
```

现在，当我启动时，应用程序在 tslib 上运行良好，并且我仍然可以在需要时通过串行线路访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T13:29:44.477

编写一个`/etc/init.d/S99myapp`脚本，在执行必要的`export VARIABLE=value`命令来定义您需要的所有环境变量后启动您的应用程序。例如，您可以`package/stunnel/S50stunnel`在 Buildroot 源代码中查看 initscript 的示例。

# iphone - UIDatePicker 8 小时前

> ID：11039319
> 
> 赞同：0
> 
> 时间：2012-06-14T18:37:25.220
> 
> 标签：iphone, objective-c, uidatepicker, release-management

我试图在 iPhone 上构建一个 datepicker 程序。但是，文本中显示的时间比我选择的时间早 8 小时。这是代码。

“h”文件：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController{
    UIDatePicker *datepick;
    IBOutlet UILabel *label;
    IBOutlet UITextField *textfield; 
}
-(IBAction)button;
@property (nonatomic, retain)IBOutlet UIDatePicker *datepick;
@end 
```

“m”文件：

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize datepick;

-(IBAction)button {
    NSDate *choice = [datepick date];
    NSString *words = [[NSString alloc]initWithFormat:@"The date is %@", choice];

    UIAlertView *alert =[[UIAlertView alloc]initWithTitle:@"the title" message:words
    delegate:nil cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
    [alert show];
    label.text = words;
    textfield.text = words;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:01:39.453

将所选日期转换为您当地的时区

```
NSDate *choice = [datepick date];

NSDateFormatter *dateFormat = [[NSDateFormatter new] autorelease];
[dateFormat setTimeZone:[NSTimeZone localTimeZone]];
[dateFormat setDateFormat:@"yyyy-MM-dd h:mma"];

NSString *strDate = [dateFormat stringFromDate:choice]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:00:39.363

从阅读您的评论来看，没有错，只是显示的时区与您预期的不同。默认情况下，NSDate 到字符串转到 GMT/UTC 时间。

使用 NSDateFormatter 来控制输出的时区：[Apple Documentation for NSDateFormatter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDateFormatter)

# c++ - 读取文件 C++ 时使用 getline 和 >>

> ID：11039323
> 
> 赞同：0
> 
> 时间：2012-06-14T18:37:38.793
> 
> 标签：c++, getline

因为文件中的数据如下所示：第 1 行是名称（第一个最后一个），下一行是分数（score1 score 2 ....score5）等等......所以我认为我需要 getline 作为 name 和 >> for分数

数据文件示例

```
David Beckham
80 90 100 20 50
Ronaldinho Gaucho
99 80 100 20 60
.... 
```

首先，我有结构

```
struct Player {
string name;
int score[5];
} player[size] 
```

从文件中读取数据时

```
int i = 0;
while(!file.eof())
    {
        for (int j = 0; j < 2; j++) //read each 2 two lines
        {               
            if(j==0) // name
            {               
                getline(file, player[i].name);  
            }
                        else if(j==1) // score
            {
                for(int k=0; k<5; k++) file >> player[i].grade[k];
            }
                }
         i++; //move to next player
    } 
```

问题是在阅读了所有分数（第一个玩家的）之后，似乎没有去下一行继续阅读下一个名字，那里有点乱。那么有什么建议可以纠正我的代码或新想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:40:42.737

读完最后一个分数后，换行符仍在输入缓冲区中。你需要跳过那个。该[`ignore`](http://en.cppreference.com/w/cpp/io/basic_istream/ignore)功能对此很有用。

```
getline(file, player[i].name);
for (int k = 0; k < 5; ++k)
  file >> player[i].grade[k];
file.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); 
```

根据需要检查错误。`>>`运算符、和`getline`都`ignore`返回流引用，您可以检查它是成功还是失败。

* * *

不需要那个`j`循环，因为每次迭代都会做完全不同的事情。只需在`j=0`case 之后立即编写`j=1`case，然后摆脱循环，就像我上面的代码一样。（请注意，`j`循环内永远不会等于 2，所以无论如何你的条件都是错误的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:22:12.140

您的主要问题是您正在使用 >> 直接从流中读取整数。这与从流中读取字符串相结合是一个坏主意。读取字符串会删除新行，使用 >> 读取不会删除新行。

最好不要混合这两种形式。要么总是使用>>，要么总是使用getline()。注意：我不是说最好，我说的是最简单。当您了解权衡以及如何补偿它们的使用差异时，您可以一起使用它们。

因此，将数字行读入字符串然后解析字符串更容易。

```
std::string  lineOfNumbers;
std::getline(file, lineOfNumbers);

// Now you have read all the numbers and the new line.
std::stringstream streamOfNumbers(lineOfNumbers);
while(streamOfNumbers >> value)
{
    // Do something with number.
} 
```

使用几乎总是错误的：

```
while(!file.eof()) 
```

这是因为在您阅读 eof 之后才设置 EOF 标志。请注意，最后一次读取将读取到但不会超过 eof。因此，即使没有可用数据，您也将进入循环。

标准模式是：

```
while(file >> object)
{
   // Action
} 
```

考虑到这一点，我将定义一个代表您想要的所有信息的类（即两行）。一个简单的版本是

```
class TwoLineReader
{
   public:
     std::string line1;
     std::string line2;
};
std::istream& operator>>(std::istream& stream, TowLineReader& record)
{
    std::getline(stream, record.line1);
    std::getline(stream, record.line2);
    return stream;
}

TowLineReader   obj;
while(file >> obj)
{
     // Do stuff
} 
```

如果您只想读取行，这很好。
但是数据看起来像是有结构的。所以我会构造一个代表数据的类，然后将数据直接读入该结构。所以这更多的是我会做的。我也会用算法替换 while() 循环。

标头

```
#include <algorithm>
#include <iterator>
#include <fstream>
#include <sstream>
#include <string>
#include <vector>

/*
 * Example Data

David Beckham
80 90 100 20 50
Ronaldinho Gaucho
99 80 100 20 60
 */ 
```

班上：

```
class Player
{
    std::string         name;
    std::vector<int>    goals;

    // Stream operator that reads a platers name and his goals.
    friend std::istream& operator>>(std::istream& stream, Player& record)
    {   
        // Read the name
        std::getline(stream, record.name);

        // Read the line of goals.
        // Copies the data into goals.
        std::string scores;
        std::getline(stream, scores);

        // std::copy replaces a while loop that pushes each number into the vector.
        std::stringstream scorestream(scores);
        std::copy( std::istream_iterator<int>(scorestream), 
                   std::istream_iterator<int>(), 
                   std::back_inserter(record.goals));

        return stream;
    }   
}; 
```

用法：

```
int main()
{

    std::ifstream   dataFile("data");
    std::vector<Player>   players;

    // Copy all players into a vetor
    std::copy( std::istream_iterator<Player>(dataFile), 
               std::istream_iterator<Player>(), 
               std::back_inserter(players));
} 
```

# sql - 将数据导出到csv文件的存储过程只导出到一个文件

> ID：11039324
> 
> 赞同：2
> 
> 时间：2012-06-14T18:37:56.003
> 
> 标签：sql, sql-server, sql-server-2008, tsql, stored-procedures

我有一个有趣的脚本：

```
DECLARE @StartDT DATE
DECLARE @MinDOS DATE
DECLARE @TableName VARCHAR(50)
SET @TableName = 'ViewAccountDetail'
SELECT @MinDOS = MIN(dos) FROM accn_demographics
SELECT @StartDT = 
    CAST(CAST(datepart(YYYY,@MinDOS) AS varchar) + '-' + CAST(datepart(mm,@MinDOS) AS varchar) + '-' + CAST('01' AS varchar) AS DATETIME)
DECLARE @FileLocation VARCHAR(50)

WHILE @StartDT < '20110901'
BEGIN
    SET @FileLocation='C:\test\'+@TableName+cast(@StartDT as varchar)+'.csv'
    EXEC BCP_Text_File @TableName, @FileLocation    
    SET @StartDT = DATEADD(MONTH,1,@StartDT)
END 
```

它应该做的是将数据导出到 csv 文件中。文件的名称应为：

```
C:\test\ViewAccountDetail2011-01-01.csv
C:\test\ViewAccountDetail2011-02-01.csv
C:\test\ViewAccountDetail2011-03-01.csv
C:\test\ViewAccountDetail2011-04-01.csv
C:\test\ViewAccountDetail2011-05-01.csv
C:\test\ViewAccountDetail2011-06-01.csv
C:\test\ViewAccountDetail2011-07-01.csv
C:\test\ViewAccountDetail2011-08-01.csv 
```

但它将所有数据存储到同一个数据中：

```
C:\test\ViewAccountDetail2011-01-01.csv 
```

我做了一个`print @FileLocation`并确认它正确更新了这个变量。

我在这里缺少什么明显的、明显的东西吗？

仅供参考：

```
EXEC BCP_Text_File @TableName, @FileLocation 
```

调用此过程：

```
 ALTER PROCEDURE [dbo].[BCP_Text_File]
    @table    NVARCHAR(255),  
    @filename VARCHAR(100)  
AS
BEGIN
  SET NOCOUNT ON;

  IF OBJECT_ID(@table) IS NOT NULL
  BEGIN
    DECLARE 
        @sql NVARCHAR(MAX), 
        @cols NVARCHAR(MAX) = N'';

    SELECT @cols += ',' + name
      FROM sys.columns
      WHERE [object_id] = OBJECT_ID(@table)
      ORDER BY column_id;

    SELECT @cols = STUFF(@cols, 1, 1, '');

    SET @sql = N'EXEC master..xp_cmdshell ''bcp "SELECT ''''' 
        + REPLACE(@cols, ',', ''''',''''') + ''''' UNION ALL SELECT ' 
        + 'RTRIM(' + REPLACE(@cols, ',', '),RTRIM(') + ') FROM ' 
        + DB_NAME() + '..' + @table + '" queryout "' + @filename + '" -c -T''';  

    EXEC sp_executesql @sql;
  END
  ELSE
  BEGIN
    SELECT 'The table '+@table+' does not exist in the database';
  END
END

GO 
```

非常感谢您的帮助和指导！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T19:56:27.550

似乎对我来说工作得很好。我有几个建议：

(1) 停止进行所有字符串连接来构建日期。您可以更轻松地执行以下操作：

```
SELECT @StartDT = DATEADD(MONTH, DATEDIFF(MONTH, '19000101', @MinDOS), '19000101'); 
```

(2)[停止`varchar`无长度](https://sqlblog.org/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length)声明。为了确保正确的输出，我更喜欢转换：

```
SET @FileLocation = 'C:\test\' + @TableName
   + CONVERT(CHAR(10), @StartDT, 120) + '.csv'; 
```

(3) 与其通过运行存储过程并检查文件夹中的输出来“调试”代码，不如先对输入进行完整性检查？另外，为什么要使用两个变量作为日期？

```
DECLARE 
   @StartDT DATE, 
   @TableName NVARCHAR(50), 
   @FileLocation VARCHAR(255);

SET @TableName = N'ViewAccountDetail';

SELECT @StartDT = DATEADD(MONTH, DATEDIFF(MONTH, '19000101', MIN(dos)), '19000101')
   FROM dbo.accn_demographics;

   PRINT @StartDT;
-- ^^^^^ debugging 101 - what month do we think we're starting at?

WHILE @StartDT < '20110901'
BEGIN
    SET @FileLocation = 'C:\test\' + @TableName
      + CONVERT(CHAR(10), @StartDT, 120) + '.csv';

      PRINT @FileLocation;
    --^^^^^ again, debugging 101 - what does the filename currently look like?

    --EXEC BCP_Text_File @TableName, @FileLocation    
    SET @StartDT = DATEADD(MONTH, 1, @StartDT);
END 
```

# c - 将 ULARGE_INTEGER 打印到控制台

> ID：11039327
> 
> 赞同：1
> 
> 时间：2012-06-14T18:38:13.297
> 
> 标签：c, windows, winapi, types

我想打印由 GetDiskFreeSpaceEx(...) 设置的根卷的大小，但它给我的值是 ULARGE_INTEGER。将其作为十进制数打印到控制台的最佳方法是什么？我正在使用普通的 C 和 Windows API 函数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T18:44:23.207

通过[http://msdn.microsoft.com/en-us/library/windows/desktop/aa383742(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383742(v=vs.85).aspx)，我很确定它会是这样的：

```
printf("%llu\n", some_ularge_integer.QuadPart); 
```

# c++ - 将两个整数合二为一，稍后解码

> ID：11039335
> 
> 赞同：2
> 
> 时间：2012-06-14T18:38:37.313
> 
> 标签：c++, integer

使用 C++，我需要将两个不同的 ID 组合成一个 16 位整数。然后稍后我需要将这个 16 位整数解码为两个原始 ID 值。

例子：

```
// Store two integers into one
unsigned short Identifier1 = 12793; //(maximum number 30000)
unsigned short Identifier1 = 5450; //(maximum number 30000)
unsigned short CombinedIDs = 34283; // this is example, I don't know the code for that

// Decode one integer into two
// At this point I only have CombinedIDs value, I need to extract it
// into the two original IDs

unsigned short OriginalIdentifier1 = ...CombinedIDs.. code to get 12793
unsigned short OriginalIdentifier2 = ...CombinedIDs.. code to get 5450 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-14T18:43:41.067

这是不可能的。

假设您的两个标识符可以在范围内`[0, 30000]`，则有 30000 x 30000 = ~2^30 对可能的标识符。但是，只有 2^16 个可能的 16 位数字。因此，您不可能将标识符对映射到 16 位整数并期望从中恢复标识符。

* * *

相反，您可以使用 32 位整数来存储组合，在这种情况下，编码和解码都很简单：

编码：

```
unsigned short Identifier1 = 12793;
unsigned short Identifier2 = 5450;
unsigned int CombinedIDs = (Identifier1 << 16) | Identifier2; 
```

解码：

```
unsigned short Identifier1 = CombinedIDs >> 16;
unsigned short Identifier2 = CombinedIDs & 0x0000FFFF 
```

请注意，现在不需要限制标识符在 [0, 30000] 范围内 - 它们是任何无符号短值。

* * *

**编辑**回答您的评论：4 位和 12 位是可能的。

编码：

```
unsigned short Identifier1;  // 4 bits
unsigned short Identifier2;  // 12 bits
unsigned short CombinedIDs = (Identifier1 << 12) | Identifier2; 
```

解码：

```
unsigned short Identifier1 = CombinedIDs >> 12;
unsigned short Identifier2 = CombinedIDs & 0x0FFF; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T18:44:12.700

您不能将两个小于 30000 的数字组合起来并将其填充为 16 位小数。

为了能够表达 30,000 个唯一的可能值，您至少需要 15 位（2^15 为 32,768）。

如果您必须选择两个数字，每 30,000 个唯一的可能值，则可能的总数为 900,000,000，这需要至少 30 位（2^30 为 1,073,741,824）。

尝试使用 int。

```
unsigned short Identifier1 = 29999;
unsigned short Identifier2 = 1;
unsigned int combined = identifier1<<16 + identifier2;

unsigned short extracted1 = (combined & 0xffff0000)>>16;
unsigned short extracted2 = combined & 0xffff; 
```

# android - 如何在使用支持库时使用 ListView 构建 AppWidget？

> ID：11039339
> 
> 赞同：2
> 
> 时间：2012-06-14T18:38:59.753
> 
> 标签：android, listview, widget

我想在 AppWidget 中的早期版本的 Android 上使用 ListView。
RagnarRs[在这个问题](https://stackoverflow.com/questions/8846743/app-widget-with-listview)上的回答表明他是通过支持库实现的，但他没有解释他是如何做到的。

有人知道他在说什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T20:42:33.320

> 我想在 AppWidget 中的早期版本的 Android 上使用 ListView。

这是不可能的。`ListView`仅适用于从 API 级别 11 开始的应用小部件。

> RagnarRs 在这个问题上的回答表明他是通过支持库实现的，但他没有解释他是如何做到的。

RagnarRs 非常困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:18:33.670

你说的早期版本是什么意思？你不能这样做吗[在 android 小部件中实现 ListView](https://stackoverflow.com/questions/6093256/implement-listview-in-android-widgets)

查看支持库，我看到有 CursorAdapter，它提供与 android 3.0+ 方法/构造函数的兼容性。

# c - C指针的大小取决于？

> ID：11039340
> 
> 赞同：4
> 
> 时间：2012-06-14T18:39:07.743
> 
> 标签：c, computer-science

C 指针的大小取决于什么？是数据总线的宽度，地址总线的宽度，还是CPU的字长？

我相信它应该取决于地址总线的宽度，因为指针必须寻址那么多位置。我对吗？

（我正在寻找依赖的原因，如果有的话）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-14T18:42:52.480

指针的大小取决于您的编译器实现。在实践中，它几乎总是您正在构建的架构的原生字长。

值得注意的是，C 语言标准允许指向不同类型的指针可能具有不同的大小，以便更好地支持具有不同大小的程序和数据存储器等的哈佛架构。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-14T18:41:28.727

这取决于所讨论的 CPU 架构。`intptr_t`您可以使用（仅限 C99）编写考虑到这一点的可移植代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T19:17:47.150

有点循环定义，但它取决于实现用来识别对象所在位置的地址空间的大小。这又可能取决于硬件、操作系统或 C 实现者的突发奇想。

因此，如果实现希望有 65535 个潜在位置来存储 a `char`，那么它将（至少）使用 16 位指针`char*`。对于 40 亿左右（或者可能是一半，某些实现不使用或不能使用指针的最高位），32 位。远远超过你的 RAM，64 位。

在实践中，该决定通常受实现期望程序在其上运行的操作系统的约束。如果操作系统的内存分配函数返回一个 64 位地址，那么实现使用较小的指针大小是相当不方便的，尽管在特定情况下可能会有一些技巧。

如果实现要在没有操作系统的情况下运行，那么它将使用适合其运行的硬件的内存映射大小的大小。如果它与操作系统一起运行，那么操作系统*可能*但*不一定*使用适合硬件的大小。我说不一定，因为现代 64 位操作系统有支持 32 位进程的习惯，因此在 64 位机器上运行的为 32 位环境编译的程序将使用 32 位指针。适用于硬件的指针大小可能与同一硬件上的字大小相同，也可能不同——通常是这样。

最后，由于某些类型大于 1 字节，原则上可以通过将较小的指针用于较大的类型来获得一些好处，并且标准允许这样做。想象一台具有 8 位字节、16 位整数和 128k 可寻址内存的机器，其`int`对象具有 2 字节对齐。那么 a`char*`至少需要 17 位（这将占用 3 个字节的存储空间），而原则上 an`int*`只需 16 位（2 个字节的存储空间），因为任何 int 的地址的最低有效位总是0，因此不需要严格存储。如果实现可以安排始终正确使用地址，则允许将`sizeof(int*) < sizeof(char*)`. 实际上，几乎没有人这样做过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-14T18:41:15.393

指针的大小取决于程序编译的 CPU 架构。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-06-14T18:42:14.860

所有指针在内存中占用相同数量的空间，而指针在内存中的大小取决于编译代码的 CPU 架构。

# c# - C# DispatcherOperation 循环永不中断

> ID：11039346
> 
> 赞同：1
> 
> 时间：2012-06-14T18:39:42.817
> 
> 标签：c#, multithreading, dispatcher

有人可以解释一下为什么这个循环永远不会“中断”并且永远持续下去吗？我如何告诉程序重新检查状态？我想做的就是在状态改变之前不进步。谢谢

```
DispatcherOperation dis = null;
for (int i = 0; i < 2; i++)
{
    updateTextBox(i.ToString());
    dis = Dispatcher.BeginInvoke(DispatcherPriority.Send, new Action(delegate
        {
            //yes, do nothing at all!!
        }
    ));
}

while(dis.Status != DispatcherOperationStatus.Completed)
{                 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:55:36.107

如果您在调度程序运行的同一线程上执行此操作，那么您的无限、不屈不挠的循环有效地使调度程序无法调度调用。无论如何，您都不应该像这样循环 - 至少在循环中放置一个 Sleep。

# python - Tkinter 段落

> ID：11039347
> 
> 赞同：0
> 
> 时间：2012-06-14T18:39:47.587
> 
> 标签：python, tkinter, paragraph

这显示了我拥有和想要的：

![显示所需 tkinter 布局的图像](../Images/7c73f19e94c19932b9ac4bb3ded5b784.png)

所以是的，正如你所看到的，我想要一个正好在红线位置的段落。按钮应出现在 2 个文本框下方。

当前的代码位：

```
window = Tk()
window.title("Taschenrechner")

window.label_zahl1 = Label(window, text = 'Zahl 1:', anchor = W, justify = LEFT)
window.label_zahl1.pack(side=LEFT)
window.entry_zahl1 = Entry()
window.entry_zahl1.pack(side=LEFT)

window.label = Label(window, text = '\n')
window.label.pack(side=LEFT)

window.label_zahl2 = Label(window, text = 'Zahl 2:')
window.label_zahl2.pack(side=LEFT)
window.entry_zahl2 = Entry()
window.entry_zahl2.pack(side=LEFT)

window.button_plus = Button(window, text = "+")
window.button_plus.pack(side=LEFT)

window.button_minus = Button(window, text = "-")
window.button_minus.pack(side=LEFT)

window.button_divi = Button(window, text = "/")
window.button_divi.pack(side=RIGHT)

window.button_mal = Button(window, text = "*")
window.button_mal.pack(side=RIGHT)

window.ausgabe = Label(master = window, text = "")                     
window.ausgabe.pack()
window.mainloop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T22:58:31.290

对于这个特定问题，简单的解决方案是使用`grid`允许为每个小部件指定行和列。

另一个简单的解决方案是使用分隔框架。将标签和条目放在一起，并`pack`像现在一样使用。然后，在第二帧中放入 h 按钮，再次`pack`以类似的方式使用。最后，使用`pack`将第一帧放在顶部，然后`pack`再次使用将第二帧放在第一帧下方。

# mfc - 无法将 Ansi char 数组分配给 MFC CStringW

> ID：11039355
> 
> 赞同：0
> 
> 时间：2012-06-14T18:40:05.870
> 
> 标签：mfc, windows-ce, cstring

我有一个 Ansi char 数组，想初始化一个 CStringW（CString 模板的 WCHAR 特化）。但是 CString 对象没有从数组中复制字符。

```
CStringW sSample = "ABC";
int length = sSample.GetLength(); // returns 3
PCWSTR wcsSample = (PCWSTR)sSample;
wcout << (int)wcsSample[0];  // output: 0 
```

*   版本：ATL/MFC 8.0 版
*   平台：Windows CE 5.0 (x86)

你看到任何解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T12:40:34.990

好吧，我自己找到了答案。这是 MFC 方法中的一个错误

```
CStringT& operator=( __in_z_opt PCYSTR pszSrc ) 
```

该方法计算所需缓冲区的长度并分配缓冲区。计算不包括终止空字符。此后，它调用 MultiByteToWideChar，将长度作为 cchWideChar 参数传递。

函数 MultiByteToWideChar 返回 0 作为失败指示，但 MFC 会忽略它。作为副作用，MultiByteToWideChar 会填充某些平台（如 Win32 和 Windows CE 5.0 (SH4)）上的输出缓冲区。

但是 Windows CE 5.0 (x86) 不会填充缓冲区。虽然分配的缓冲区太小，但在大多数平台上不可见该错误，但在 Windows CE 5.0 (x86) 上不可见。在这里，您在分配后得到一个空的 CString。

MFC 中的缺陷存在于所有 MFC 变体中。但它被一种`MultiByteToWideChar`在平台上表现不同的行为所覆盖。

# java - 无法在 GridLayout 中更改 JLabel 的大小

> ID：11039357
> 
> 赞同：0
> 
> 时间：2012-06-14T18:40:14.750
> 
> 标签：java, swing, user-interface, jlabel, layout-manager

我有一个标签，可以显示从“0 ft”到“999 ft”的字符串，因此最大需要大小为 6 的字符串。我正在使用网格布局，以便我可以将该标签放在它所在的特定列中应该。我也想要标签的背景。但问题是我无法正确设置背景的大小。

![我想将黑色部分缩小到我无法做到的所需数量](../Images/75b346a9f318abfb1d7ca515b104d722.png)

```
 public Controller() {
    super(new GridLayout(9, 9));
    try {
        Background = ImageIO.read(getClass().getResourceAsStream(
                "background.jpg"));
        TestImage = ImageIO.read(getClass().getResourceAsStream(
                "VTOLHorizontalLevelIndicator.png"));
        setPreferredSize(new Dimension(Background.getWidth(null),
                Background.getHeight(null)));

    } catch (IOException ex) {
        ex.printStackTrace();
    }

    for (Direction direction : Direction.values()) {
        directionMap.put(direction, false);
    }
    setKeyBindings();
    Timer timer = new Timer(TIMER_DELAY, new TimerListener());
    timer.start();
    int i = 3;
    int j = 11;
    JLabel[][] panelHolder = new JLabel[i][j];
    setLayout(new GridLayout(i, j));

    for (int m = 0; m <= 2; m++) {
        for (int n = 0; n <= 10; n++) {
            if (m == 1 && n == 1) {
                lblAltitude.setFont(new Font("Gotham Bold",1,12));
                lblAltitude.setToolTipText("Altitude");
                lblAltitude.setOpaque(true);
                lblAltitude.setBackground(Color.black);
                lblAltitude.setMinimumSize(new Dimension(50,25));
                add(lblAltitude);
            } else {
                panelHolder[m][n] = new JLabel(" ");
                add(panelHolder[m][n]);
            }
        }
    }

} 
```

上面的代码显示了我从中初始化 GridLayout 和标签的构造函数。 *我使用了正确的布局吗？* **我主要关心的是在正确的位置获取标签，可能不是网格方式，而是在此 GUI 中的某些坐标处。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:42:23.033

GridLayout 将扩展所有组件以填充面板（使每个组件大小相同）。

# .net - DLL 的运行时版本不变

> ID：11039359
> 
> 赞同：0
> 
> 时间：2012-06-14T18:40:25.360
> 
> 标签：.net, frameworks, version

当我查看在 Visual Studio 中引用的 dll 的属性时，我看到运行时版本是 v2.0.50727。我已经将 dll 重新编译为 .net 框架的 3.5 版本并重新导入了 dll，但运行时版本仍然是 v2.0.50727。我觉得有些东西我不明白。有人可以解释为什么现在不是 3.5。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:45:08.787

.NET 3.5 仍然使用 .NET 2.0 CLR - 这就是您看到的版本号。

我相信从 .NET 2.0 更新到 .NET 3.5 实际上会更新 CLR，但您通常可以*将*.NET 3.5 视为同一运行时之上的一组额外库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T18:45:38.103

.NET 3.5 建立在 .NET 2.0 之上并使用一些相同的程序集。您可能正在查看相同的程序集。

有关起点，请参阅[.NET Framework 版本和依赖项。](http://msdn.microsoft.com/en-us/library/bb822049%28v=vs.110%29.aspx)

# android - UnwindResume 和其他链接错误（针对 android 的交叉编译）

> ID：11039360
> 
> 赞同：0
> 
> 时间：2012-06-14T18:40:31.553
> 
> 标签：android, c++, linker, android-ndk

我正在尝试为 android 交叉编译一个大型开源库。我已经编辑了源代码以包含未共享的库的 android 版本，更改了字大小的定义等，并让库中的所有单个文件都可以编译而不会出现错误/警告。

在将所有目标文件链接到单个可执行文件的最终命令中，我收到一堆错误，所有表单都抱怨未定义对 _Unwind_Resume 和 __emutls_get_address 的引用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:52:57.337

在构建过程中添加对静态库 libgcc_eh 的引用：

```
LOCAL_LDLIBS := -lgcc_eh 
```

# boinc - BOINC 管理器的另一个实例已经在运行... - 客户端/密码是什么？

> ID：11039369
> 
> 赞同：0
> 
> 时间：2012-06-14T18:41:01.693
> 
> 标签：boinc

我关闭（或认为我已经关闭）BOINC 经理，但没有结束任务。当我再次打开管理器来管理任务时，我看到一个对话框，上面写着“BOINC 管理器的另一个实例已经在这台计算机上运行。请选择一个要监控的客户端”，并要求输入主机名和密码。

我要输入什么以使其连接到（可能）仍在运行的客户端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:35:17.243

这是因为`boincmgr`当管理器关闭时进程没有结束，正如`ps -e | grep boinc`显示管理器（和`boinc`进程）在窗口关闭时仍在运行中所证明的那样。

假设您没有进行其他设置，连接到现有主机的主机名是`localhost`，密码为空。

# exception - 如何为 Exception.Data 添加 IDictionary 扩展方法

> ID：11039370
> 
> 赞同：0
> 
> 时间：2012-06-14T18:41:04.830
> 
> 标签：exception, extension-methods, idictionary

我想为 IDictionary 集合 Exception.Data 创建一个扩展方法，该方法允许我将项目添加到字典中，而不必确保键是唯一的。

我无法显示扩展方法。

```
 public static void AddUnique<TKey, TValue>(this IDictionary<TKey, TValue> dictionary, TKey key, TValue value)
    {

    } 
```

你会像这样使用它

```
exception.Data.AddUnique("key", value); 
```

我究竟做错了什么？这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:46:26.653

你在哪里声明这个？理想情况下，您应该有一个静态类来包含此方法。然后，如果它在不同的命名空间中，您需要确保您有该命名空间的 using 语句。

```
namespace MyNamespace
{
    public static class MyExtensions
    {

        public static void AddUnique<TKey, TValue>(this IDictionary<TKey, TValue> dictionary, 
                                                   TKey key, 
                                                   TValue value)
        {
            // implementation code
        }
    }
} 
```

然后...

```
using MyNamespace;  // if required

//  in a method
exception.Data.AddUnique(key, value); 
```

**注意：** 您还拥有*key*作为*"key"*，这是一个字符串文字。如果您的 TKey 不是字符串，则可能无法正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:01:18.033

扩展方法中的类型必须与 Exception.Data 的类型完全匹配，即 System.Collections.IDictionary。

System.Collections.Generic.IDictionary <> System.Collections.IDictionary

System.Collections.IDictionary 没有类型参数，因此正确的代码是

```
 public static void AddUnique<TKey, TValue>(this System.Collections.IDictionary dictionary, TKey key, TValue value)
    {

    } 
```

# c# - 如何在 C# 的表单中拥有多个具有不同控件的面板

> ID：11039371
> 
> 赞同：2
> 
> 时间：2012-06-14T18:41:07.247
> 
> 标签：c#, .net, winforms

我是 C#.Net 的新手。我有一个表格，里面有一些面板。其中一个面板是 MainPanel。启动后，MainPanel 为空。根据用户选择，我想在其中加载一些控件。类似于 Java 中的 CardLayout 的东西！每个面板都有很多控件，我不想以编程方式添加它们。事实上，问题是“有没有办法让设计师设计一些面板并根据用户选择显示/隐藏它们，全部以一种形式？”

![在此处输入图像描述](../Images/771155a538d13165667ccf30567fff7e.png)

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:45:02.910

是的，在它们自己的类中创建名为 UserControls 的新对象。您可以通过编程方式添加和删除它们，但在设计器中创建它们。

为了避免在更改控件时出现闪烁，请执行以下操作：

```
Control ctlOld = frmMain.Controls[0]; // this will allow you to remove whatever control is in there, allowing you to keep your code generic.
ctlNextControl ctl = new ctlNextControl(); // this is the control you've created in another class
frmMain.Controls.Add(ctlNextControl);
frmMain.Controls.Remove(ctlOld); 
```

创建您的用户控件，并根据需要命名它们，我现在将命名一些示例：

```
ctlGear
ctlMap
ctlGraph
ctlCar
ctlPerson 
```

将这 5 个文件作为 UserControls 添加到您的项目中。随心所欲地设计它们。

为不同的按钮创建一个枚举以便于使用：

```
public enum ControlType {
    Gear,
    Map,
    Graph,
    Car,
    Person
} 
```

创建它们后，在每个按钮的按钮单击事件中，添加对这个新方法的调用：

```
private void SwitchControls(ControlType pType) {
    // Keep a reference to whichever control is currently in MainPanel.
    Control ctlOld = MainPanel.Controls[0];
    // Create a new Control object
    Control ctlNew = null;
    // Make a switch statement to find the correct type of Control to create.
    switch (pType) {
        case (ControlType.Gear):
           ctlNew = new ctlGear();
           break;
        case (ControlType.Map):
           ctlNew = new ctlMap();
           break;
        case (ControlType.Graph):
           ctlNew = new ctlGraph();
           break;
        case (ControlType.Car):
            ctlNew = new ctlCar();
            break;
        case (ControlType.Person):
            ctlNew = new ctlPerson();
            break;
        // don't worry about a default, unless you have one you would want to be the default.
    }

    // Don't try to add a null Control.
    if (ctlNew == null) return();

    MainPanel.Controls.Add(ctlNew);

    MainPanel.Controls.Remove(ctlOld);
} 
```

然后在你的按钮点击事件中，你可以有这样的东西：

```
private void btnGear.Click(object sender, EventArgs e) {
    SwitchControls(ControlType.Gear);
} 
```

其他点击事件也是如此，只需更改参数中的 ControlType 即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T18:44:09.650

只需在其他面板上设置[Visible属性。](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.visible)但是，LarsTech 是对的，最好在需要时将用户控件交换到主面板

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T18:43:28.290

尝试将这些其他“面板”创建为用户控件。您可以像设计表格一样设计它们。

或者，您可以在他使用 TabControl 但在运行时隐藏选项卡的地方使用这个 Hans Passant 答案： [Creating Wizards for Windows Forms in C#](https://stackoverflow.com/a/2342320/719186)

# php - 仅影响某些机器的 PHP 关联数组解析错误

> ID：11039379
> 
> 赞同：2
> 
> 时间：2012-06-14T18:41:42.703
> 
> 标签：php

此代码在某些机器上失败：

```
// Parse error: syntax error, unexpected '[' ...
return json_encode(self::GenerateSomeAssociativeArray($meta_file)["list"]); 
```

但是这个实际上相同的版本适用于所有机器：

```
$foo = self::GenerateSomeAssociativeArray($meta_file);
return json_encode($foo['list']); 
```

我认为这是一个版本问题，但我无法找到有关差异的信息，可能是因为我不熟悉要搜索的术语。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:46:05.193

您给出的第一个示例是针对 PHP 5.4 的，并且应该更高。请参阅以下 PHP 5.4 发布公告：

[http://php.net/releases/5_4_0.php](http://php.net/releases/5_4_0.php)

```
<?php
// Example #8 Array dereferencing

function getArray() {
    return array(1, 2, 3);
}

// on PHP 5.4
$secondElement = getArray()[1];

// previously
$tmp = getArray();
$secondElement = $tmp[1];

// or
list(, $secondElement) = getArray();
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T18:45:00.647

5.4 之前的 PHP 版本不允许将数组索引运算符 ( `[]`) 应用于除变量之外的任何内容。

对真的。

# python - 将从 SQL 查询返回的所有 NoneType 对象转换为字符串？

> ID：11039385
> 
> 赞同：0
> 
> 时间：2012-06-14T18:42:16.170
> 
> 标签：python, sql

有没有办法将从 SQL 查询返回的所有 NoneType 对象转换为空字符串？现在我正在做

```
curs.execute(query)
for foo, bar, baz in curs.fetchall():
    foo = foo or ''
    bar = bar or ''
    baz = baz or '' 
```

但我确信有更好的方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:46:16.120

像这样的东西

```
new_list = [ ('' if x is None else x) for x in curs.fetchall() ] 
```

# jquery - 处理表格单元格悬停时冒泡的jQuery事件

> ID：11039390
> 
> 赞同：0
> 
> 时间：2012-06-14T18:42:37.680
> 
> 标签：jquery, events, event-bubbling

我刚刚开始在 jQuery 中进行事件冒泡，所以我的理解非常有限。我需要处理父容器级别的 html 表（网格）行/单元格上发生的所有事件。示例： 1.当用户单击一行时，我不想将 click 事件绑定到每个我将其绑定到 parent 。2\. 当用户将鼠标悬停在单元格上时，我想显示工具提示，即需要将标题属性设置为单元格的文本元素。我也需要冒泡这个事件。

我能够解决我的要求的第一部分。这是第 1 部分的代码（下面添加了 jsFiddle）：

```
$('#grid').click(function(evt) {
    var row = $(evt.target).parent('tr'); // Get the parent row
    var cell= $(evt.target); //Get the cell
    alert('Row data: ' + row.text());
    alert('Cell data: ' + cell.text());
}); 
```

我认为实现悬停也很简单。但我无法捕获单个单元格的值。这是我在小提琴[jsFiddle 中的示例代码：在单元格悬停时冒泡事件的示例代码](http://jsfiddle.net/3xp7Q/2/)

另外，我注意到我在悬停时看到两次警报。我猜它是为单元格引发事件一次，然后为行/表引发事件。没有把握？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:55:36.210

您可以[`$.on`](http://api.jquery.com/on)像下面这样实现这一点。从 jQuery 1.7 开始，所有对`.live()`, `.bind()`, '.delegate()' 的调用都在后台使用`.on()`。并且`.on`仅在该元素上绑定事件`#grid`并拦截该元素上的事件，然后检查目标是否匹配第二个选择器。如果是，则执行该函数。

```
$('#grid').on('mouseenter','td', function(){
       console.log($(this).text());
   });​ 
```

[工作小提琴](http://jsfiddle.net/joycse06/4HzL4/)

# dom - Chrome 扩展内容脚本未访问注入它的页面的 DOM

> ID：11039391
> 
> 赞同：5
> 
> 时间：2012-06-14T18:42:40.233
> 
> 标签：dom, google-chrome-extension, content-script

我正在尝试从用户正在查看的页面中提取数据并将该数据发送到扩展弹出窗口。我在从当前页面提取信息时遇到了麻烦。在查看了谷歌代码教程后，我设置了我的清单和内容脚本，如下所示。当我转到一个跨度为 id="comments" 的测试页面时，来自注入内容脚本的变量总是以 null 结束。有人知道我可能会错过什么吗？谢谢！

```
manifest.json
=================
{
    "name": "Sample Extension",
    "version": "0.0.1",
    "description": "Sample extension",
    "icons": {"128": "icon.png"},
    "permissions": [
        "tabs", "<all_urls>"
    ],
    "browser_action": {
        "default_icon": "browseraction.png",
        "default_title": "Sample",
        "popup": "popup.html"
    },
    "content_scripts": [
        {
            "matches": ["http://*/*", "<all_urls>" ],
            "js": ["scripts/contentscript.js"]
        }
    ]
}

contentscript.js
===================
var comments = document.getElementById("comments");
alert( comments.innerText ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T18:47:54.857

执行脚本后可能会加载注释。

尝试在清单中设置它：

```
 "run_at" : "document_end", 
```

或者，如果您怀疑 AJAX 加载，稍后使用`setTimeout`.

当然，最好的方案将取决于精确的页面及其内部工作。

# wordpress - 在 WordPress 中使用自定义字段将 URL 添加到滑块

> ID：11039392
> 
> 赞同：0
> 
> 时间：2012-06-14T18:42:49.017
> 
> 标签：wordpress, slider

我正在尝试通过我创建的自定义字段为每张幻灯片添加一个 url。

这已经在代码中：

```
 <img src="<?php echo bfi_timthumber($largeImage, 980, (int)$sliderHeight)?>" width="980" height="<?php echo $sliderHeight ?>" title="#nivocaption<?php echo $i?>"/> 
```

所以我想如果我创建了自定义字段，我可以把它包装在这个：

```
 <a href="<?php echo get_post_meta($post->ID, 'slide_url', true); ?>"> ABOVE CODE HERE </a> 
```

但不幸的是，这不起作用。有什么想法吗？

这是完整的代码： http: [//pastebin.com/yNzk8izb](http://pastebin.com/yNzk8izb)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T07:08:27.673

好吧 - 我不知道你的主题/插件，但 $lardeImage 参数是你可能需要使用的参数。像你一样包装它显然会使它加倍，因为你并没有过度使用代码，你只是添加到它。

尝试 ：

```
$largeImage = get_post_meta($post->ID, 'slide_url', true); 
```

然后是代码。

注意：（它可能不起作用，因为就像我说的 - 我不知道插件/主题功能 - 但 $LargeImage 参数名称表明它只需要采用“完整”图像大小..）

但无论如何都要试一试。

# three.js - 如何将另一个场景对象附加到我的动画导入 collada 网格？

> ID：11039396
> 
> 赞同：2
> 
> 时间：2012-06-14T18:43:09.443
> 
> 标签：three.js

我使用 Three.js 设置了以下动画：

[http://frontier.lincoln.ac.uk/3d/development/Stage2/characters/man2.html](http://frontier.lincoln.ac.uk/3d/development/Stage2/characters/man2.html)

请忽略绳状加权网格，这是一个快速重新模拟。真正的交易可以在这里找到（[http://frontier.lincoln.ac.uk/3d/development/Stage2/characters/man.html](http://frontier.lincoln.ac.uk/3d/development/Stage2/characters/man.html)）

这就是问题所在。看到他的红帽子了吗？（在第一个 URL 中）。那应该在他的头上。所以，我创建了一个虚拟对象（角色头顶上的绿色小立方体）。这不是角色皮肤的一部分，可以作为皮肤的子对象来处理。

但是，由于角色网格受动画的支配（morphTargetInfulences 等 - 我还没有完全弄清楚它是如何工作的）我如何将帽子放置在虚拟对象所在的位置并让它移动它？

这是代码的业务端，但可以随意绕过上述文件的源：

```
if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

        var container, stats;

        var camera, scene, renderer;
        var particleLight, pointLight;
        var dae, skin, skin2, headgear, test2;

        var faceMaterial = new THREE.MeshFaceMaterial();
        var loader = new THREE.JSONLoader();
        loader.load('../../../models/test_models/hat.js', function colladaReady( geometry ) {
            headgear = new THREE.Mesh(geometry, faceMaterial);
            loadMan();
        });

        function loadMan(){

            var loader = new THREE.ColladaLoader();
            loader.load( '../../../models/test_models/test4.DAE', function colladaReady( collada ) {
                dae = collada.scene;
                skin = collada.skins[0];
                //this is the reference to the dummy object
                skin2 = collada.skins[0].children[0];
                dae.getChildByName( "node-CATRigHub001", true ).scale.set(0.1, 0.1, 0.1);
                dae.position.y = -2
                dae.scale.x = dae.scale.y = dae.scale.z = 0.1;
                dae.rotation.x = -Math.PI/2;
                //here is where i've added to the hat to the dummy object
                skin2.add(headgear);
                dae.updateMatrix();

                init();
                animate();
            } );

        }

        function init() {

            container = document.createElement( 'div' );
            document.body.appendChild( container );

            camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 2000 );
            camera.position.set( 2, 2, 3 );

            scene = new THREE.Scene();

            scene.add( dae );

            particleLight = new THREE.Mesh( new THREE.SphereGeometry( 4, 8, 8 ), new THREE.MeshBasicMaterial( { color: 0xcccccc } ) );
            scene.add( particleLight );

            // Lights

            scene.add( new THREE.AmbientLight( 0xcccccc ) );

            var directionalLight = new THREE.DirectionalLight(/*Math.random() * 0xffffff*/0xcccccc );
            directionalLight.position.x = Math.random() - 0.5;
            directionalLight.position.y = Math.random() - 0.5;
            directionalLight.position.z = Math.random() - 0.5;
            directionalLight.position.normalize();
            scene.add( directionalLight );

            pointLight = new THREE.PointLight( 0xcccccc, 3 );
            pointLight.position = particleLight.position;
            scene.add( pointLight );

            renderer = new THREE.WebGLRenderer();
            //renderer = new THREE.CanvasRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );

            container.appendChild( renderer.domElement );

            stats = new Stats();
            stats.domElement.style.position = 'absolute';
            stats.domElement.style.top = '0px';
            container.appendChild( stats.domElement );

        }

        var t = 0;
        function animate() {

            requestAnimationFrame( animate );

            if ( t > 24 ) t = 0;
            if ( skin ) {
                for ( var i = 0; i < skin.morphTargetInfluences.length; i++ ) {
                    skin.morphTargetInfluences[ i ] = 0;
                    skin2.morphTargetInfluences[ i ] = 0;
                }

                skin.morphTargetInfluences[ Math.floor( t ) ] = 1;
                skin2.morphTargetInfluences[ Math.floor( t ) ] = 1;

                t += 0.5;

            }

            render();
            stats.update();

        }

        function render() {

            var timer = Date.now() * 0.0005;

            camera.position.x = Math.cos( timer ) * 10;
            camera.position.y = 2;
            camera.position.z = Math.sin( timer ) * 10;

            camera.lookAt( scene.position );

            particleLight.position.x = Math.sin( timer * 4 ) * 3009;
            particleLight.position.y = Math.cos( timer * 5 ) * 4000;
            particleLight.position.z = Math.cos( timer * 4 ) * 3009;

            renderer.render( scene, camera );

        } 
```

提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T07:14:13.497

你可以做一些类似旧的 Quake MD2 模型的东西——每个道具也是动画变形，动画帧同步到基础网格的所有动画帧（例如 running_gun、idle_gun、running_hat、idle_hat）。

例如，请参见此处的武器：

[http://alteredqualia.com/three/examples/webgl_morphtargets_md2.html](http://alteredqualia.com/three/examples/webgl_morphtargets_md2.html)

您需要在导出模型时执行此操作，将所有道具与基础模型一起制作动画，然后逐个导出它们。

它不会非常优雅或高效，但它应该可以直接完成工作和工作（如 MD2 模型，最终也会作为变形，您只需将资产管道映射到 MD2 管道）。

正如您提到的 Collada，另一种选择可能是以某种方式在变形之外使用原始骨架（也就是说，如果您的模型确实有骨架，我认为 Collada 允许蒙皮和变形）。

虽然我猜这需要弄乱 ColladaLoader（变形是通过软件蒙皮烘焙的，所以关于骨骼框架的信息在某处，应该有类似“头骨”的东西）。

或者，除了蒙皮/变形的基础网格之外，您还可以以某种方式将道具的刚体动画分层到 Collada 中，类似于此处的动画部分：

[http://mrdoob.github.com/three.js/examples/webgl_loader_collada_keyframe.html](http://mrdoob.github.com/three.js/examples/webgl_loader_collada_keyframe.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T20:05:53.663

我认为您应该将帽子添加为您正在制作动画的皮肤的一部分。

# ruby-on-rails-3 - Rails 3路由约束，允许某些IP

> ID：11039397
> 
> 赞同：0
> 
> 时间：2012-06-14T18:43:12.987
> 
> 标签：ruby-on-rails-3, routes, ip, constraints

我的 Rails 应用程序的路由文件中有以下代码：

```
MyApp::Application.routes.draw do
constraints :ip => "123.123.123.123" do
    resources :sheets
    resources :consults
    resources :clinicals
    ...
 end
 end 
```

这成功地将 123.123.123.123 IP 地址路由到约束块内的控制器。

将另一个 IP 地址添加到约束块的最佳方法是什么，以便我可以将两个或更多路由到同一个控制器？像下面这样简单地添加另一个似乎不起作用：

```
constraints :ip => "123.123.123.123, 232.232.232.232" do 
```

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:01:28.127

也许是这样的？

```
constraints :ip => IpsRouting.new

class IpsRouting
  def initialize
    @ips = ["123.123.123.123", "345.345.345.345"]
  end

  def matches?(request)
    return false if @ips.include?(request.remote_ip)
    true
  end
end 
```

对这个答案的想法相同-> [Rails 3 Routing Constraint and Regex](https://stackoverflow.com/questions/5931439/rails-3-routing-constraint-and-regex)

另一个猜测... xD

# aloha-editor - 是否有我可以应用自定义预定义类的 Aloha 编辑器插件？

> ID：11039398
> 
> 赞同：3
> 
> 时间：2012-06-14T18:43:16.193
> 
> 标签：aloha-editor

我想使用 Aloha 编辑器将类应用于块元素。Core Aloha 编辑器可以应用块元素，如 p、h1、h2、h3。是否有插件可以将预定义的自定义类添加到这些块元素，例如 p.smaller 或 h2.crazy，所以结果 HTML 类似于`<h2 class="crazy">Loko headline here<h2>`？

# ios - 使用 Phonegap 搜索和添加 Facebook 好友

> ID：11039401
> 
> 赞同：1
> 
> 时间：2012-06-14T18:43:25.460
> 
> 标签：ios, facebook, cordova, contact, friend

我正在尝试开发一个提供此功能的 iOS 应用程序：使用某人的联系信息，例如姓名、电话号码和/或电子邮件地址，搜索该人的 Facebook 个人资料并向他们发送好友请求。

更重要的是，我知道如果我知道此人的 FBID，我可以发送好友请求；但是，我还没有找到使用此信息搜索某人的 FBID 的方法。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T21:02:16.697

如果个人资料是公开的，您可以将其用于电子邮件：

```
https://graph.facebook.com/search?q=alias@domain.com&type=user 
```

您还可以将电子邮件地址替换为电话号码

# asp.net - 如何使用 C#5 async / await 从 asp.net 托管模块调用异步进程？

> ID：11039411
> 
> 赞同：0
> 
> 时间：2012-06-14T18:43:47.527
> 
> 标签：asp.net, asynchronous, c#-5.0, nancy, async-await

我有一个通过 Nancy Module Get 方法调用的长时间运行的进程。我希望这个调用是异步的，而不是让浏览器在进程运行时挂起，换句话说，我希望 Get 方法立即返回并让长时间运行的进程去做它的事情。然后，我可以定期检查流程的状态并采取相应措施。

我是 C#5 的 async / await 特性的新手，但我确信这些特性仅用于此类任务。下面的代码显示了我的尝试。我已经添加了一些日志记录，证明它没有按预期异步运行。相反，长时间运行的进程会阻止 Get 方法，因此浏览器会挂起。

**模块**

```
public class TestModule : NancyModule
{            
    public TestModule(ITestService testService)
    {
        Get["/longprocess"] = _ =>
            {
                Log.Write("Module : Start");
                testService.LongProcess();
                Log.Write("Module : Finish");
                return HttpStatusCode.OK;
            };
    }
} 
```

**服务**

```
public interface ITestService
{
    Task<bool> LongProcess();
}

public class TestService : ITestService
{
    public async Task<bool> LongProcess()
    {
        await LongProcessAsynch();
        return true;
    }

    private Task<bool> LongProcessAsynch()
    {
        Log.Write("LongProcess : Start");
        Thread.Sleep(5000);
        //Task.Delay(5000); <- Has same effect
        Log.Write("LongProcess : Finish");
        return true.AsTask();
    }
} 
```

**扩展方法**

```
public static Task<T> AsTask<T>(this T candidate)
{
    var source = new TaskCompletionSource<T>();
    source.SetResult(candidate);
    return source.Task;
} 
```

**日志输出**

```
14/06/2012 19:22:29 : Module : Start
14/06/2012 19:22:29 : LongProcess : Start
14/06/2012 19:22:34 : LongProcess : Finish
14/06/2012 19:22:34 : Module : Finish 
```

您可以从上面的日志输出中看到`LongProcess()`阻塞了 Get 模块的返回。如果任务异步运行，我希望日志看起来像这样：

**预期日志**

```
Module : Start
LongProcess : Start
Module : Finish
LongProcess : Finish 
```

我认为实际需要的是把`await`NancyModule Get 方法。可能类似于下面的代码，但我不能这样做，因为我不能将模块构造函数标记为`asnyc`，所以我不能`await`在 Get 方法中使用（或者我目前相信）

```
Get["/longprocess"] = _ =>
    {
        Log.Write("Module : Start");
        await testService.LongProcess();
        Log.Write("Module : Finish");
        return HttpStatusCode.OK;
    }; 
```

感谢您提供任何帮助、示例或资源指针。

**编辑 1**

更多研究表明，`async`默认情况下，asp.net 似乎会主动阻止调用。我相信这与`Session`它处理非 UI 线程的方式有关。所以我在我的 web.config 中添加了以下内容（见下文）

*   使用TaskFriendlySynchronizationContext
*   enableSessionState="假"

不幸的是，它没有任何区别，我的`async`/`await`调用`LongProcess()`仍然阻塞。

```
<configuration>
  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
    <add key="webPages:Enabled" value="false" />
  </appSettings>
  <system.web>
    <httpRuntime targetFramework="4.5"/>
    <pages controlRenderingCompatibilityVersion="4.0" enableSessionState="false" />
    ... more config
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T13:54:58.540

> 我是 C#5 的 async / await 特性的新手，但我确信这些特性仅用于此类任务。

No. `async`/`await`旨在使异步编程*在单个进程的上下文中*变得容易。它们不会改变 HTTP 通信的性质。

当您`await`在 ASP.NET 服务器上使用时（在 HTTP 请求的上下文中），您将 ASP.NET 线程返回到线程池。但是，ASP.NET 知道 HTTP 请求尚未完成，因此它不会完成对客户端（浏览器）的响应。

这是设计使然。

您需要使用 AJAX、SignalR 或其他一些解决方案才能执行您想要的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-25T12:51:06.553

尝试在 aspx 页面中设置页面属性`Async="true"`后，它看起来像这样 `<%@ Page Language="C#" AutoEventWireup="true" CodeFile="XXX.aspx.cs" Inherits="xxx" Async="true" %>`

在 tcode behile 文件中，您可以制作异步类型的任务和方法，并从中调用`await` 任务......

它可能有效

# c# - 这种继承特性的用例是什么？

> ID：11039414
> 
> 赞同：18
> 
> 时间：2012-06-14T18:43:56.380
> 
> 标签：c#, inheritance, mono

继承继承的类时，新的 / 覆盖行为不是我所期望的：

```
$ cat Program.cs
using System;

class A {
    public virtual void SayHi() {
        Console.WriteLine("From A");
    }
}
class B : A { 
    public new virtual void SayHi()  {
        Console.WriteLine("From B");
    }
}
class C : B { 
    public override void SayHi() {
        Console.WriteLine("From C");
    }
}

public class Program {
    public static void Main() {
        A p = new C();
        p.SayHi();
    }
}

$ ./Program.exe 
From A 
```

由于 C 类覆盖了 sayHi() 方法，我希望输出为`From C`. 为什么B类的`new`修饰符在这里优先？那有什么用例？特别是因为它打破了让 C 真正覆盖 A 的明显用例。

请注意，上面的代码是在 Mono 2.10 上运行的，该版本在 Debian 派生发行版上运行。但我已经使用 MS Visual Studio 中的 C# 编译器确认了相同的行为。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-14T18:48:28.757

[`new`修饰符](http://msdn.microsoft.com/en-us/library/435f1dw2.aspx)导致成员隐藏，从而破坏了类层次结构中的多态关系。的`SayHi`方法`B`被视为与 's*不同*（而不是覆盖）`A`（因此选择单词“new”作为关键字）。`C`'s 方法然后覆盖`B`'s，而不是`A`'s（仍然隐藏）。

因此，当您通过引用调用实例`SayHi`时，运行时会将其解析为类型，而不是类型（其中是从 继承的“新”方法）。`C``A``A``C``SayHi``B`

另一方面，如果您要运行：

```
B p = new C();
p.SayHi(); 
```

…你会得到预期的多态结果：

```
From C 
```

**编辑**：由于您请求了一个用例，这是一个。在 .NET Framework 2.0 中引入泛型之前，成员隐藏有时被用作更改派生类中继承方法的返回类型的一种方法（在重写时不能这样做），以返回更具体的类型。例如：

```
class ObjectContainer
{
    private object item;

    public object Item 
    {
        get { return item; }
        set { item = value; }
    }
}

class StringContainer : ObjectContainer
{
    public new virtual string Item
    {
        get { return base.Item as string; }
        set { base.Item = value as string; }
    }
}

class QuotedStringContainer : StringContainer
{
    public override string Item
    {
        get { return "\"" + base.Item + "\""; }
    }
} 
```

类的`Item`属性`ObjectContainer`返回一个普通的`object`. 但是，在 中，这个继承的属性被隐藏了，而是`StringContainer`返回 a 。`string`因此：

```
ObjectContainer oc = new StringContainer();
object o  = oc.Item;   // Valid, since ObjectContainer.Item is resolved
string s1 = oc.Item;   // Not valid, since ObjectContainer.Item is still resolved
string s2 = ((StringContainer)oc).Item;   
                       // Valid, since StringContainer.Item is now resolved 
```

该类`QuotedStringContainer`覆盖 的`Item`属性`StringContainer`，继承其`string`返回类型；但是，它*仍然*隐藏在 的`object`-returning`Item`属性中`ObjectContainer`。如果不是这样，就没有办法调和它们不同的返回类型……</p>

```
ObjectContainer oc = new QuotedStringContainer();
object o  = oc.Item;   // Valid, since ObjectContainer.Item is resolved
string s1 = oc.Item;   // Not valid, since ObjectContainer.Item is still resolved
string s2 = ((StringContainer)oc).Item;   
                       // Valid, since QuotedStringContainer.Item is now resolved
                       // (polymorphism!)
string s3 = ((QuotedStringContainer)oc).Item;   
                       // Valid, since QuotedStringContainer.Item is now resolved 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-14T18:48:33.440

`C`正在覆盖方法的[阴影](http://www.java-forums.org/java-blogs/3934-method-shadowing-inheritance.html)版本（在中被[阴影](https://stackoverflow.com/questions/392721/difference-between-shadowing-and-overriding-in-c)`B`），而不是在`A`.

结果，当您使用类型的变量时`A`，`SayHi`定义的 in`A`被调用，因为*它*没有被覆盖 in `C`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-14T18:50:25.293

`C`覆盖`B`的方法，因此当您将其转换为 时`A`，您最终会调用`A`.

请参阅[ECMA 334：](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-334.pdf) 17.5.3 下的 C# 语言规范是您的示例（第 294 页）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-14T18:50:59.277

因为 C 类没有覆盖 A 类中的 SayHi 方法，它覆盖了 B 中的“新”方法。由于您的强制转换是 A，编译器将其解析为对 A.SayHi() 的调用而不是 C。打招呼（）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-14T18:52:47.007

此 msdn 页面的最后一个[示例](http://msdn.microsoft.com/en-us/library/aa645768%28v=vs.71%29)详细解释了此处发生的情况。

基本上， new 修饰符会导致 A 中的方法对 C 隐藏，并且由于在 C 覆盖时它是公共的，因此它会覆盖 B 中的方法（将其视为自己的不同方法）。

如果将 B 中的方法设置为私有，C 将再次覆盖 A 中的方法。

```
class B : A
{
    private new void SayHi()
    {
        Console.WriteLine("From B");
    }
} 
```

结果是：`From C`

# asp.net - Server.Transfer() 和 http 301

> ID：11039415
> 
> 赞同：0
> 
> 时间：2012-06-14T18:43:56.577
> 
> 标签：asp.net, http-status-code-301, server.transfer

会通过 server.transfer 发送 301 吗？

页面A.aspx：

```
protected void Page_Load(object sender, EventArgs e)
    {
        Response.Status = "301 Moved Permanently";
        Server.Transfer("/pageB.aspx");
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:48:01.813

如果您确实需要在 a 之后重定向`Server.Transfer`，您可以手动进行：

```
this.Response.Status = "301 Moved Permanently";
this.Response.RedirectLocation = "Default2.aspx"; 
```

细节：

`Server.Transfer`不会导致重定向

请参阅 MSDN：

> Server.Transfer 作为 Response.Redirect 方法的有效替代品。Response.Redirect 指定浏览器请求不同的页面。因为重定向强制一个新的页面请求，浏览器向 Web 服务器发出两个请求，所以 Web 服务器处理一个额外的请求。IIS 5.0 引入了一个新函数 Server.Transfer，它将执行转移到服务器上的不同 ASP 页。这避免了额外的请求，从而获得更好的整体系统性能以及更好的用户体验。

实际上我只是尝试了您的代码，但它不起作用。

**它确实发送了 301 状态：**

```
HTTP/1.1 301 Moved Permanently
Server: ASP.NET Development Server/10.0.0.0
Date: Thu, 14 Jun 2012 18:54:22 GMT
X-AspNet-Version: 4.0.30319
Cache-Control: private
Content-Type: text/html; charset=utf-8
Content-Length: 626
Connection: Close 
```

这是 Fiddler 的回复。

但它不工作

我认为它不起作用的原因是，当您从服务器发送 3xx 状态时，您需要发回用于重定向的 URL（这会导致对服务器的第二次请求）。这是在您使用时自动完成的`Response.Redirect`，但`Server.Transfer` **不会**，因此您从服务器发送重定向状态时没有 URL，这就是它不起作用的原因

# python - 如何使用 __str__ 打印字典中存储的数据

> ID：11039423
> 
> 赞同：-2
> 
> 时间：2012-06-14T18:44:40.263
> 
> 标签：python

每当我发出命令时，如何使用`__str__`打印字典存储的数据。`print`我在用：

```
def __str__(self):
    for atom in self.pdb_atoms().keys():
        return '%s'%self.pdb_atoms()[atom] 
```

如果我在 python 中有一个字典，它的索引有一个字符串和一个整数，比如`{ 'CA' 56: 'ATOM 727 HG2 57 -7.010000 11.418000 -23.532000'....}`

但这给了我对应于单个键而不是整个列表的数据；这仅打印 1344 行列表中的第 727 行。我不知道，我哪里错了。`pdb_atoms`是字典的名称

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T22:29:25.267

您认为`return`循环中可能意味着什么？`__str__`必须返回一个字符串。如果您的函数按预期工作，它会为每个原子返回一个字符串......然后呢？Python 应该如何知道如何在你不告诉它的情况下将它们组合成一个字符串？有*很多*方法可以将字符串粘合在一起，这甚至不是一种很可能解释多次返回的函数的方法（如果它返回数字怎么办？）。

但事实上，函数只能返回一次，这是我能想到的几乎所有语言的基本属性（逻辑编程语言除外）。因此，如果您放入`return`一个循环，所发生的一切就是该函数在循环的第一次迭代时返回并完成。这就是为什么你的函数只显示第一个键的原因！

有点类似的东西`return`可以多次使用：`yield`. 实际上，这使您可以将多个值作为迭代器返回（您只能通过循环循环一次**以**`for`再次将它们取回）。但这在这里对您没有帮助，因为`__str__`应该返回一个字符串，而包含多个字符串的迭代器不是字符串！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T03:11:16.360

```
def __str__(self):
    return '\n'.join(str(v) for v in self.pdb_atoms().itervalues()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:02:25.633

如果您想要一个所有值由换行符分隔的字符串，请尝试以下操作：

```
def __str__(self):
    return '\n'.join(self.pdb_atoms()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T18:50:09.677

您会看到问题，因为您是在构建整个列表之前从函数调用返回的。尝试以下操作以返回您的整个字典：

```
def __str__(self):
    return ''.join([self.pdb_atoms()[atom] for atom in self.pdb_atoms().keys()]) 
```

另外，请注意如何直接使用字符串对象而不必这样做`'%s'%(string)`

编辑：正如@Wooble 在评论中指出的那样，您不能调用字典对象。我假设您所说的 pdb_atoms 是一个返回字典的命令。如果没有，请删除`()`.

# java - 获取 LinkedHashMap 的子集并保留顺序

> ID：11039427
> 
> 赞同：3
> 
> 时间：2012-06-14T18:45:00.933
> 
> 标签：java, iterator, linkedhashmap

与 HashMap 不同，LinkedHashMap 中的顺序很重要。这里的顺序是插入顺序。

假设我有一个如下所示的 LinkedHashMap（从上到下排序，左侧是键，右侧是值）：

> 1：“一”
> 
> 2：“二”
> 
> 3：“三”
> 
> 4：“四”

然后我有一个键列表，其中包含（3,1）。

我想要做的是按顺序循环遍历 LinkedHashMap 并挑选出其键在列表中的条目。

所以我想要的结果是（1 仍然在 3 之前，因为这是过滤前的顺序）：

> 1：“一”
> 
> 3：“三”

这是我的代码：

```
import java.util.ArrayList;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

public class SelectCertainEntriesFromLinkedHashMap {
    public static void main(String args[]) {
    Map<Integer,String> linkedHashMap = new LinkedHashMap<Integer,String>();
    linkedHashMap.put(1, "One");
    linkedHashMap.put(2, "Twe");
    linkedHashMap.put(3, "Three");
    linkedHashMap.put(4, "Four");

    List<Integer> list = new ArrayList<Integer>();
    list.add(3);
    list.add(1);

    Map<Integer,String> selectedlinkedHashMap = new LinkedHashMap<Integer,String>();

    //will this iterator iterate the keys in the order of the map (1, 2, 3, 4)? Or just random order?
    Iterator<Integer> itr = linkedHashMap.keySet().iterator();
    while(itr.hasNext()) {
        Integer key = itr.next();
        if (list.contains(key)) {
            selectedlinkedHashMap.put(key, linkedHashMap.get(key));
            System.out.println(key + ":" + linkedHashMap.get(key));
        }
    }
}
} 
```

上面的代码返回我喜欢的结果。但我不确定它是否得到保证。

> 1：“一”
> 
> 3：“三”

问题是：Iterator itr = linkedHashMap.keySet().iterator(); 上面的行将从集合中获取迭代器，并且集合没有排序。那么这会导致密钥随机排列吗？如果是的话，我不能在过滤后保持我的地图的原始顺序（不能保证）......有人可以帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:50:26.930

从 keySet().iterator() 返回的迭代器应该返回一个有序集合。[地图 API](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)的文档：

```
The Map interface provides three collection views, which allow a map's contents to be 
viewed as a set of keys, collection of values, or set of key-value mappings. The order of 
a map is defined as the order in which the iterators on the map's collection views return   
their elements. Some map implementations, like the TreeMap class, make specific guarantees  
as to their order; others, like the HashMap class, do not. 
```

因此，在 LinkedHashMap 的情况下，我将其解释为迭代器将返回一个有序集合。确实，[LinkedHashMap API](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html)并没有明确说明这一点，但您可以尝试一下并观察您的输出。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-14T18:51:47.477

当您调用`keySet()`时，它会根据基础数据创建键的视图。诚然，它的文档记录不是很清楚，但由于它*只是*一个视图，因此以不同的顺序迭代该视图会非常奇怪。

您当然可以检查实施情况，但我相信这很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T18:54:42.283

你试过吗？我不确定它是否以与插入时相同的顺序返回它们，但在这种特殊情况下，您可以使用获得的 KeySet 创建一个 TreeSet，因为它们是整数，所以它会自然排序。1 然后 3。

有点像：

`Set<Integer> set = new TreeSet<Integer>(linkedHashMap.keySet());`

# objective-c - NSMutableArray 中带有 NIB 的多个对象

> ID：11039431
> 
> 赞同：0
> 
> 时间：2012-06-14T18:45:15.810
> 
> 标签：objective-c, nsarray, nib, multiple-instances

我有一个菜鸟问题，可能类似于[从 NIB 动态创建 UIView 的多个实例，](https://stackoverflow.com/questions/8280319/dynamically-create-multiple-instances-of-a-uiview-from-a-nib)但我错过了大局。

我有一个带有 NIB 的类，称为 UserViewController，我需要根据用户数量创建多个实例，将它们存储在一个数组中并能够在它们之间进行模态导航。

带有 NIB 的类，称为 SelectNumberOfUsersViewController 包含此 IBACTION 代码：

```
users = [[NSMutableArray alloc] init];
for (int i=0; i<numberOfUsers; i++) {
    user = [[UserViewController alloc] init];
    user.userid = i+1;
    [user doInitialization];
    [users addObject:user];
} 
```

我看到`initWithNibName`实例`user`的运行，但是我如何处理和显示`users`数组中第一个用户的 UI？我不确定命令是否像

```
myView = [[[NSBundle mainBundle] loadNibNamed:@"XXX" owner:self options:nil] objectAtIndex:0];
[[self view] addSubview:searchDateView] 
```

应该使用，因为该数组包含具有 NIB 和所有内容的 User 类的整个对象 - 或者......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T08:37:09.477

如果你想用一个 nib 文件初始化一个视图控制器，你应该使用：

```
user = [[UserViewController alloc] initWithNibName:@"NibName" bundle:nil]; 
```

如果您想推送该视图，您可以调用：

```
[self.navigationController pushViewController:user animated:true]; 
```

要展示它，请致电：

```
[self presentModalViewController:user animated:true]; 
```

如果您只想将视图添加到当前视图控制器，请使用：

```
[self.view addSubView:user.view]; 
```

但肯定也会删除前一个。

我希望这有帮助。

# wcf - 错误“此消息无法支持该操作，因为它已被读取”

> ID：11039434
> 
> 赞同：18
> 
> 时间：2012-06-14T18:45:39.243
> 
> 标签：wcf, wcf-binding

我有以下线程中列出的相同问题。

[客户端不发送 SOAPAction 的 WSDL 第一个 WCF 服务器](https://stackoverflow.com/questions/2805845/wsdl-first-wcf-server-where-client-does-not-send-soapaction/2806362#2806362)

我执行了同一线程中列出的步骤（如下所示）

1) 下载 Microsoft WCF 示例。从 WF_WCF_Samples\WCF\Extensibility\Interop\RouteByBody\CS\service 将以下文件添加到您的项目中

DispatchByBodyOperationSelector.cs

DispatchByBodyBehaviorAttribute.cs

2）将以下属性添加到您的界面（在您的ServiceContract旁边）

```
XmlSerializerFormat

DispatchByBodyBehavior 
```

3）将以下内容添加到您的服务接口

```
[OperationContract(Action = "")]

public void DoNothing()
{
} 
```

4) 对于我的服务，WrapperName 和 Wrappernamespace 对于所有消息都是空的。我必须进入 DispatchByBodyBehaviorAttribute 并编辑 ApplyDispatchBehavior() 以添加以下行来检查这一点：

```
 if (qname.IsEmpty) {
     qname = new XmlQualifiedName(operationDescription.Messages[0].Body.Parts[0].Name, operationDescription.Messages[0].Body.Parts[0].Namespace);
 } 
```

现在，我收到一条错误消息“此消息无法支持该操作，因为它已被读取”。我打开了跟踪并捕获了堆栈跟踪（如下）。如果有人对如何解决此问题有任何想法，如果您能发表一些评论，我将不胜感激。谢谢你的帮助！

```
at System.ServiceModel.Channels.Message.GetReaderAtBodyContents()
at System.ServiceModel.Dispatcher.OperationFormatter.DeserializeBodyContents(Message message, Object[] parameters, Boolean isRequest)
at System.ServiceModel.Dispatcher.OperationFormatter.DeserializeRequest(Message message, Object[] parameters)
at System.ServiceModel.Dispatcher.DispatchOperationRuntime.DeserializeInputs(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage41(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage4(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage3(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage2(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage11(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage1(MessageRpc&amp; rpc)
at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)
at System.ServiceModel.Dispatcher.ChannelHandler.DispatchAndReleasePump(RequestContext request, Boolean cleanThread, OperationContext currentOperationContext)
at System.ServiceModel.Dispatcher.ChannelHandler.HandleRequest(RequestContext request, OperationContext currentOperationContext)
at System.ServiceModel.Dispatcher.ChannelHandler.AsyncMessagePump(IAsyncResult result)
at System.ServiceModel.Dispatcher.ChannelHandler.OnAsyncReceiveComplete(IAsyncResult result)
at System.Runtime.Fx.AsyncThunk.UnhandledExceptionFrame(IAsyncResult result)
at System.Runtime.AsyncResult.Complete(Boolean completedSynchronously)
at System.Runtime.InputQueue`1.AsyncQueueReader.Set(Item item)
at System.Runtime.InputQueue`1.EnqueueAndDispatch(Item item, Boolean canDispatchOnThisThread)
at System.Runtime.InputQueue`1.EnqueueAndDispatch(T item, Action dequeuedCallback, Boolean canDispatchOnThisThread)
at System.ServiceModel.Channels.SingletonChannelAcceptor`3.Enqueue(QueueItemType item, Action dequeuedCallback, Boolean canDispatchOnThisThread)
at System.ServiceModel.Channels.HttpChannelListener.HttpContextReceived(HttpRequestContext context, Action callback)
at System.ServiceModel.Channels.SharedHttpTransportManager.OnGetContextCore(IAsyncResult result)
at System.ServiceModel.Channels.SharedHttpTransportManager.OnGetContext(IAsyncResult result)
at System.Runtime.Fx.AsyncThunk.UnhandledExceptionFrame(IAsyncResult result)
at System.Net.LazyAsyncResult.Complete(IntPtr userToken)
at System.Net.LazyAsyncResult.ProtectedInvokeCallback(Object result, IntPtr userToken)
at System.Net.ListenerAsyncResult.WaitCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* nativeOverlapped)
at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)
</StackTrace>

class DispatchByBodyElementOperationSelector : IDispatchOperationSelector
{
    Dictionary<XmlQualifiedName, string> dispatchDictionary;

    public DispatchByBodyElementOperationSelector(Dictionary<XmlQualifiedName, string> dispatchDictionary)
    {
        this.dispatchDictionary = dispatchDictionary;            
    }

    #region IDispatchOperationSelector Members

    private Message CreateMessageCopy(Message message, XmlDictionaryReader body)
    {
        //Message copy = Message.CreateMessage(message.Version, message.Headers.Action, body);
        //copy.Headers.CopyHeaderFrom(message, 0);
        //copy.Properties.CopyProperties(message.Properties);
        //return copy;    

        MessageBuffer buffer = message.CreateBufferedCopy(Int32.MaxValue);
        Message copy = buffer.CreateMessage();
        buffer.Close();
        copy.Headers.CopyHeaderFrom(message, 0);
        copy.Properties.CopyProperties(message.Properties);

        return copy;
    }

    public string SelectOperation(ref System.ServiceModel.Channels.Message message)
    {
        XmlDictionaryReader bodyReader = message.GetReaderAtBodyContents();

        XmlQualifiedName lookupQName = new XmlQualifiedName(bodyReader.LocalName, bodyReader.NamespaceURI);
        message = CreateMessageCopy(message,bodyReader);
        if (dispatchDictionary.ContainsKey(lookupQName))
        {
            return dispatchDictionary[lookupQName];
        }
        else
        {
            return null;
        }
    }

    #endregion
}

[AttributeUsage(AttributeTargets.Class|AttributeTargets.Interface)]
sealed class DispatchByBodyBehaviorAttribute : Attribute, IContractBehavior
{
    #region IContractBehavior Members

    public void AddBindingParameters(ContractDescription contractDescription, ServiceEndpoint endpoint, System.ServiceModel.Channels.BindingParameterCollection bindingParameters)
    {
        // no binding parameters need to be set here
        return;
    }

    public void ApplyClientBehavior(ContractDescription contractDescription, ServiceEndpoint endpoint, System.ServiceModel.Dispatcher.ClientRuntime clientRuntime)
    {
        // this is a dispatch-side behavior which doesn't require
        // any action on the client
        return;
    }

    public void ApplyDispatchBehavior(ContractDescription contractDescription, ServiceEndpoint endpoint, System.ServiceModel.Dispatcher.DispatchRuntime dispatchRuntime)
    {
        // We iterate over the operation descriptions in the contract and
        // record the QName of the request body child element and corresponding operation name
        // to the dictionary to be used for dispatch 
        Dictionary<XmlQualifiedName,string> dispatchDictionary = new Dictionary<XmlQualifiedName,string>();
        foreach( OperationDescription operationDescription in contractDescription.Operations )
        {
            XmlQualifiedName qname =
                new XmlQualifiedName(operationDescription.Messages[0].Body.WrapperName, operationDescription.Messages[0].Body.WrapperNamespace);

            if (qname.IsEmpty)
            {
                qname = new XmlQualifiedName(operationDescription.Messages[0].Body.Parts[0].Name, operationDescription.Messages[0].Body.Parts[0].Namespace);
            }

            dispatchDictionary.Add(qname, operationDescription.Name);                
        }

        // Lastly, we create and assign and instance of our operation selector that
        // gets the dispatch dictionary we've just created.
        dispatchRuntime.OperationSelector = 
            new DispatchByBodyElementOperationSelector(dispatchDictionary);
    }

    public void Validate(ContractDescription contractDescription, ServiceEndpoint endpoint)
    {
        // 
    }

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-14T19:08:28.060

你应该使用`MessageBuffer.CreateMessage`：

> 实例的主体`Message`只能使用或写入一次。如果您希望多次使用 Message 实例，则应使用`MessageBuffer`该类将整个`Message` 实例完全存储到内存中。

[http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.messagebuffer.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.messagebuffer.aspx)

我当前项目的代码：

```
public void AfterReceiveReply(ref System.ServiceModel.Channels.Message reply, object correlationState)
{
    MessageBuffer buffer = reply.CreateBufferedCopy(Int32.MaxValue);
    reply = buffer.CreateMessage();
    Message m = buffer.CreateMessage();
    LogMessage(m, " Response => ");
} 
```

添加参数并返回新消息`ref`。`Message`

```
 private Message CreateMessageCopy(ref Message message, XmlDictionaryReader body)
{
...
   message = buffer.CreateMessage(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-23T14:43:17.860

我有一个非常相似的问题，也使用了 WCF Samples 中的代码（确切地说是 RouteByBody），并且能够以不同的方式解决它，所以我会在这里发布它以防它帮助任何人。

**情况：** 客户端应用程序（消费者）可以在*Release*中工作，但是，当附加调试器时，它总是会失败，并显示错误*"This message cannot support the operation because it has been read"*。

经过大量跟踪和记录 WCF 消息后，对我有用的唯一解决方案原来如此简单：

我的服务托管在 IIS 上，并`debug="true"`在`<compilation>`web.config 部分中。

将其更改为`debug="false"` **服务**解决了我所有的问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-11-15T13:41:22.277

如果您正在调试服务，则 Dmitry Harnitski 的回答不起作用（它会给您一个“此消息无法支持该操作，因为它已被复制。”错误。）

这甚至在调试模式下也有效：

```
XmlDictionaryReader GetReader(ref Message message)
{
    MessageBuffer buffer = message.CreateBufferedCopy(Int32.MaxValue);
    message = buffer.CreateMessage();
    newMessage = buffer.CreateMessage();
    XmlDictionaryReader rv = buffer.CreateMessage().GetReaderAtBodyContents();
    buffer.Close();
    return rv;
}

static System.ServiceModel.Channels.Message newMessage = null;
static System.ServiceModel.Channels.Message lastMessage = null;

public string SelectOperation(ref System.ServiceModel.Channels.Message message)
{
    try
    {
        if(message == lastMessage)
            message = newMessage;

        XmlDictionaryReader bodyReader = GetReader(ref message);

        lastMessage = message;

        XmlQualifiedName lookupQName = new XmlQualifiedName(bodyReader.LocalName, bodyReader.NamespaceURI);
        if (dispatchDictionary.ContainsKey(lookupQName))
        {
            return dispatchDictionary[lookupQName];
        }
        else
        {
            return null;
        }
    }
    catch(Exception ex)
    {
        throw ex;
    }
} 
```

# jquery - jQuery 可以在动态插入脚本元素之前检查浏览器的缓存吗？

> ID：11039435
> 
> 赞同：1
> 
> 时间：2012-06-14T18:45:43.470
> 
> 标签：jquery, ajax, caching

我通过 AJAX 从服务器中提取了一些 HTML，其中包括`<script>`标签。在将这个新的 html 附加到文档中时，我发现——无论脚本是否已经存在于缓存中——我的浏览器都会再次通过 GET 请求访问服务器以跟踪`.js`文件。

在某些情况下，这会在 HTML 从初始 AJAX 调用返回与内容完全呈现并执行脚本之间产生相当大的时间间隔。

有趣的是 $(document).append(scripts) 似乎绕过了浏览器的正常缓存机制。有谁知道在添加脚本元素时强制 jQuery 检查缓存的好方法？

# xml - 从 fx:component flex 调用 AS 内部的函数

> ID：11039437
> 
> 赞同：0
> 
> 时间：2012-06-14T18:45:47.543
> 
> 标签：xml, actionscript-3, apache-flex, mobile, mxml

这个可能很简单，但我在网上找不到答案。这是我所拥有的：

```
<fx:Script>
        <![CDATA[
            protected function DestIsAirport(event:MouseEvent):void {
                navigator.pushView(AirportSelector);
            }
            protected function DestIsAddress(event:MouseEvent):void {
                navigator.pushView(DestinationInfoView);
            }
        ]]>
</fx:Script> 
```

然后我在它下面有一个弹出容器，它看起来像这样：

```
<fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
        <fx:Component className="DestAlert">
            <s:SkinnablePopUpContainer x="50" y="200">
                <s:TitleWindow title="Destination">
                    <s:VGroup horizontalAlign="center" verticalAlign="middle" paddingTop="8" paddingBottom="8" paddingLeft="8" paddingRight="8" gap="5" width="100%">
                        <s:Label text="Is your destination an airport?"/>
                    </s:VGroup>
                    <s:HGroup horizontalAlign="center" verticalAlign="middle" paddingTop="40" paddingBottom="8" gap="5" width="100%">
                        <s:Button label="Yes" bottom="10" left="10" width="100" fontSize="16" click="DestIsAirport(event)"/>
                        <s:Button label="No" bottom="10" right="10" width="100" fontSize="16" click="DestIsAddress(event)"/>
                    </s:HGroup>
                </s:TitleWindow>
            </s:SkinnablePopUpContainer>
        </fx:Component>
    </fx:Declarations> 
```

我希望这两个按钮从 AS3 脚本运行不同的功能。这会产生错误：1180：调用可能未定义的方法 DestIsAddress。1180：调用可能未定义的方法 DestIsAirport。

如何让这些按钮运行这两个功能？

整个源文件：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009"
        xmlns:s="library://ns.adobe.com/flex/spark" title="Enter Pick Up Address">

    <fx:Script>
        <![CDATA[
            protected function button1_clickHandler(event:MouseEvent):void
            {
                navigator.popView();
            }
            protected function DestIsAirport(event:MouseEvent):void {
                navigator.pushView(AirportSelector);
            }
            protected function DestIsAddress(event:MouseEvent):void {
                navigator.pushView(DestinationInfoView);
            }
        ]]>
    </fx:Script>
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
        <fx:Component className="DestAlert">
            <s:SkinnablePopUpContainer x="50" y="200">
                <s:TitleWindow title="Destination">
                    <s:VGroup horizontalAlign="center" verticalAlign="middle" paddingTop="8" paddingBottom="8" paddingLeft="8" paddingRight="8" gap="5" width="100%">
                        <s:Label text="Is your destination an airport?"/>
                    </s:VGroup>
                    <s:HGroup horizontalAlign="center" verticalAlign="middle" paddingTop="40" paddingBottom="8" gap="5" width="100%">
                        <s:Button label="Yes" bottom="10" left="10" width="100" fontSize="16" click="close()"/>
                        <s:Button label="No" bottom="10" right="10" width="100" fontSize="16" click="close()"/>
                    </s:HGroup>
                </s:TitleWindow>
            </s:SkinnablePopUpContainer>
        </fx:Component>
    </fx:Declarations>
    <s:actionContent>
        <s:Button label="Back" click="button1_clickHandler(event)"/>
    </s:actionContent>
    <s:TextInput top="6" horizontalCenter="-1" prompt="Address Line 1"/>
    <s:TextInput top="47" horizontalCenter="-1" prompt="Address Line 2"/>
    <s:RadioButton top="90" label="IL - Illinois" horizontalCenter="-94"/>
    <s:RadioButton top="90" label="WI - Wisconsin" horizontalCenter="72"/>
    <s:SpinnerListContainer bottom="60" width="320" height="211" horizontalCenter="0">
        <s:SpinnerList width="317" height="100%" labelField="data" selectedIndex="0">
            <s:ArrayList>
                <fx:Object data=""></fx:Object>
                <fx:Object data="Abbott Park"></fx:Object>
                <fx:Object data="Addison"></fx:Object>
                <fx:Object data="Algonquin"></fx:Object>
                <fx:Object data="Alsip"></fx:Object>

    </s:ArrayList>
        </s:SpinnerList>
    </s:SpinnerListContainer>
    <s:Button bottom="10" width="302" label="Next" click="(new DestAlert()).open(this, false)"
              fontSize="24" horizontalCenter="0"/>
</s:View> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T21:15:10.913

声明部分仅适用于用户不会看到的内容。你需要做几件事。

1.  获取声明部分中的组件并将其移动到它自己的文件中。
2.  通过弹出管理器显示组件的实例。

此外，重要的是要注意组件和父级将处于完全不同的范围内。但是，在创建弹出组件的新实例后，您可以使用对它的引用来添加侦听器。然后组件可以调度此类可以侦听的事件，然后调用函数。

这变得更加复杂，因为 popupmanager 是一个静态类，与您在此处添加的代码无关。让我知道这是否需要更多解释，因为我几乎觉得照片是有序的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:03:11.387

为什么不创建一个单独的动作脚本/mxml 文件？那很容易解决这个问题。

# websocket - 在 Windows 7 上使用 WebSocket

> ID：11039438
> 
> 赞同：34
> 
> 时间：2012-06-14T18:45:50.973
> 
> 标签：websocket, .net-4.5

我刚刚安装了 Visual Studio 2012 RC 并尝试使用启用 WebSocket 的 netHttpBinding 运行服务并收到以下错误：

> 此平台不支持服务器端 WebSocket。

我正在运行的示例来自[http://blogs.microsoft.co.il/blogs/idof/archive/2012/03/01/what-s-new-in-wcf-4-5-websocket-support-part -1-of-2.aspx](http://blogs.microsoft.co.il/blogs/idof/archive/2012/03/01/what-s-new-in-wcf-4-5-websocket-support-part-1-of-2.aspx)

WebSockets 可以在带有 Visual Studio 2012 RC 的 Windows 7 上工作吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-15T11:56:39.657

不，websockets 仅在 Windows 8 中由 Windows 原生支持，无论您使用的是哪个 Visual Studio 版本。

[http://www.paulbatum.com/2011/09/getting-started-with-websockets-in.html](http://www.paulbatum.com/2011/09/getting-started-with-websockets-in.html)

这是由于 Windows 7 中带有 http.sys 的一些低级问题。

[它可能会被反向移植，但似乎不太可能： http](http://weblogs.asp.net/owscott/archive/2012/03/01/what-s-new-in-iis-8.aspx) ://weblogs.asp.net/owscott/archive/2012/03/01/what-s-new-in-iis-8.aspx

要在 Windows 7 上使用 websocket，您必须编写自己的服务。

尝试将其用于客户端：[http ://websocket4net.codeplex.com/](http://websocket4net.codeplex.com/)

这对于服务器端：[http ://superwebsocket.codeplex.com/](http://superwebsocket.codeplex.com/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-28T10:24:52.153

我遇到了同样的问题并使用[Fleck](https://github.com/statianzo/Fleck)解决了它。实现起来非常简单：

一。NuGet 添加 Fleck 引用

二。创建您的网络服务器套接字

```
// Create Websocket server
websocketServer = new Fleck.WebSocketServer("ws://localhost:82");
websocketServer.Start(socket =>
{
    socket.OnOpen = () => Console.WriteLine("Open!");
    socket.OnClose = () => Console.WriteLine("Close!");
    socket.OnMessage = message => socket.Send(message);
}); 
```

我现在在一个端口上有一个 ASP.NET Self Host Web API，并且 websockets 连接在它旁边运行。

# android - ARToolki Qualcomm 共享对象构建错误

> ID：11039441
> 
> 赞同：1
> 
> 时间：2012-06-14T18:46:04.577
> 
> 标签：android, android-ndk, makefile

我试图构建一个共享对象，但出现错误。见下图。

[![错误图像](../Images/fdc34026e1dbde8c33e77ba2fec9b4ae.png)](https://i.stack.imgur.com/A5f12.png)

你认为它可以来自什么？

# c# - StackOverflowException 序列化 STE EF 对象图

> ID：11039450
> 
> 赞同：0
> 
> 时间：2012-06-14T18:46:22.177
> 
> 标签：c#, wcf, entity-framework, iis, serialization

我们有一个 .NET 4、WPF、WCF、EF 4、SQL 2008 应用程序。我们的 EF 模型之一是高度相关的，在我所描述的情况下，可能并且可能确实包含循环。我被要求对现场的一个案例进行故障排除，该案例中来自该 STE EF 模型的所有数据突然退出显示在 WPF 客户端中。经过仔细检查，我发现 IIS W3WP 进程在尝试检索（序列化）STE EF 对象图时崩溃。我使用调试诊断来捕获崩溃。

当我查看生成的崩溃报告时，我发现这是一个堆栈溢出异常（多么合适）。崩溃报告中的堆栈跟踪相当大，但堆栈顶部看起来像：

```
System.Xml.XmlBaseWriter.StartElement(System.String ByRef, System.String, System.String, System.Xml.XmlDictionaryString) 
System.Xml.XmlBaseWriter.WriteStartElement(System.String, System.Xml.XmlDictionaryString, System.Xml.XmlDictionaryString) 
System.Runtime.Serialization.XmlWriterDelegator.WriteStartElement(System.String, System.Xml.XmlDictionaryString, System.Xml.XmlDictionaryString) 
DynamicClass.WriteXXXDataToXml(System.Runtime.Serialization.XmlWriterDelegator, System.Object, System.Runtime.Serialization.XmlObjectSerializerWriteContext, System.Runtime.Serialization.ClassDataContract) 
System.Runtime.Serialization.ClassDataContract.WriteXmlValue(System.Runtime.Serialization.XmlWriterDelegator, System.Object, System.Runtime.Serialization.XmlObjectSerializerWriteContext) 
System.Runtime.Serialization.XmlObjectSerializerWriteContext.SerializeWithoutXsiType(System.Runtime.Serialization.DataContract, System.Runtime.Serialization.XmlWriterDelegator, System.Object, System.RuntimeTypeHandle) 
System.Runtime.Serialization.XmlObjectSerializerWriteContext.InternalSerialize(System.Runtime.Serialization.XmlWriterDelegator, System.Object, Boolean, Boolean, Int32, System.RuntimeTypeHandle) 
System.Runtime.Serialization.XmlObjectSerializerWriteContext.InternalSerializeReference(System.Runtime.Serialization.XmlWriterDelegator, System.Object, Boolean, Boolean, Int32, System.RuntimeTypeHandle) 
```

异常奇怪的是，当 WCF 服务托管在 Visual Studio 中并且我从开发环境中运行时，序列化工作完美，并且我在客户端上获取数据。

这可以通过 IIS 设置解决吗？为什么它可以与 Visual Studio 的开发 IIS 一起使用，但不能与生产 IIS 一起使用？

我不确定是什么导致了这个问题，或者为什么序列化器甚至在呕吐？

我应该尝试使用 STE EF4 的另一种 WCF 序列化方法吗？

任何输入表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T23:13:07.157

（默认情况下）IIS 将托管线程的堆栈大小限制为 256 KB。我不了解开发 Web 服务器，但托管线程的默认堆栈大小为 1 MB。此外，如果您在 64 位机器上运行，堆栈帧通常比 32 位机器上的堆栈帧大。因此，如果您的开发盒是 32 位的，您可能看不到您在生产中看到的内容。我在这里写了一点关于这个[http://blogs.msdn.com/b/xmlteam/archive/2011/09/26/effective-xml-part-5-something-went-really-wrong-outofmemoryexception-and- stackoverflowexception-throw-when-using-xslcompiledtransform.aspx](http://blogs.msdn.com/b/xmlteam/archive/2011/09/26/effective-xml-part-5-something-went-really-wrong-outofmemoryexception-and-stackoverflowexception-thrown-when-using-xslcompiledtransform.aspx)。这是一个有点不同的上下文，但关于 IIS、堆栈大小和帧大小的讨论仍然适用。

# php - 为什么当表为空时mysql插入查询*仅*失败？

> ID：11039452
> 
> 赞同：1
> 
> 时间：2012-06-14T18:46:39.617
> 
> 标签：php, mysql, insert

我在一些 PHP 代码中一个接一个地运行这两个语句。

```
INSERT INTO input (ID) VALUES('1');
UPDATE input SET `vendor_name` = 'some name' WHERE ID=1 
```

如果数据库表为空（意味着我只是截断了表），则**不会**创建数据，也不会出现警告。就好像我从未执行过查询一样。

如果我**再跑**

```
 INSERT INTO input (ID) VALUES('1'); 
```

在这个*完全相同的*透明表上，创建一个条目没有问题。之后，如果我再次运行*相同*的INSERT/UPDATE 查询

```
INSERT INTO input (ID) VALUES('2');
UPDATE input SET `vendor_name` = 'some name' WHERE ID=2 
```

然后创建数据并适当设置 vendor_name。这里发生了什么？？我似乎误解了将数据插入数据库的基本知识。我不能像这样在空表上连续执行语句吗？

为了抢占不可避免的愚蠢问题，例如“列是否存在？”，这里有一些额外的说明：

*   从未出现任何警告。这真的让我很烦。INSERT/UPDATE 似乎默默地失败了。（是的，是的，我已设置错误报告并检查了日志）

*   存在并定义了适当的列/表/数据库/权限（请记住，如果表中有空行，则查询可以正常工作）

*   ID 是主键。我用于 ID 的数字（1,2，等等）似乎并不重要。我也可以颠倒它们，或者使用 101 和 102，无论如何。

*   创建表如下所示： CREATE TABLE IF NOT EXISTS $tablename (ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY)。列由用户动态添加。所以现在表中有大约 100 列（请记住，这无关紧要。我只是想更新*一*列，如果表中有数据，更新工作正常）

*   在那里偷偷 Count(*) 查询表明该行*已*创建，但在 Update 语句之后消失。（也许该行没有完成，或者其他什么，我需要运行一个“确保插入完成”查询？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:07:09.387

试试这个代码......对我来说它的作品......

```
INSERT INTO `input` (ID) VALUES('1');
UPDATE `input` SET `vendor_name` = 'some name' WHERE ID=1 
```

# android - Android - 无法将图库图像设置为 ImageView

> ID：11039453
> 
> 赞同：3
> 
> 时间：2012-06-14T18:46:41.660
> 
> 标签：android, imageview, gallery, image

我浏览了很多帖子，无法弄清楚为什么我不能让它工作。我想要做的就是让用户单击一个打开画廊应用程序的按钮。然后用户选择一张图片，它会自动关闭图库并返回到我的应用程序，它会自动将该图像设置为 ImageView。

到目前为止，我一直在工作，直到它回到我的应用程序。看起来一切都很好，但图像从未出现在 ImageView 中。

这是 ImageView 的 XML 代码：

```
<ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="14dp"
        android:layout_gravity="center_horizontal" /> 
```

在我的活动开始时，我将 ImageView 设置为：

```
 ImageView targetImage; 
```

这是获取图像并将其设置到我的 ImageView 的其余代码。有一个按钮可以启动“setGunImage”。

```
public void setGunImage(View view) {
    Intent intent = new Intent();
    intent.setType("image/*");
    intent.setAction(Intent.ACTION_GET_CONTENT);
    startActivityForResult(Intent.createChooser(intent, "Select Picture"), SELECT_PICTURE);
}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {

if (resultCode == RESULT_OK) {
        if (requestCode == SELECT_PICTURE) {
            targetImage = (ImageView)findViewById(R.id.imageView1);
            Uri selectedImageUri = data.getData();
            targetImage.setImageURI(selectedImageUri);
        }
    }
} 
```

我已经在启用了 sd 卡的模拟器和加载到真实设备上的图像上对其进行了测试。两者都给出相同的行为。它通过图库步骤很好，但是当它返回到我的应用程序时，ImageView 中没有加载图像。

我尝试将数据更改为位图并进行设置，但它也从未出现过。我知道这可能是我没有看到的超级简单的事情，所以希望一双新的眼睛可以为我指明正确的方向。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:57:03.700

我认为 Imran 解决方案应该可以正常工作........您也可以尝试这种方式

```
 @Override
        protected void onActivityResult(int requestCode, int resultCode, Intent data) {
            InputStream stream = null;
         if( resultCode==RESULT_OK)
           {
              if(requestCode==SELECT_PICTURE)
               {
                try {
                    // We need to recyle unused bitmaps
                    if (bitmap != null) {
                        bitmap.recycle();
                    }
                    stream = getContentResolver().openInputStream(data.getData());
                    bitmap = BitmapFactory.decodeStream(stream);

                                targetImage = (ImageView)findViewById(R.id.imageView1);
                    targetImage.setImageBitmap(bitmap);
                } catch (FileNotFoundException e) {
                    e.printStackTrace();
                } finally {
                    if (stream != null)
                        try {
                            stream.close();
                        } catch (IOException e) {
                            e.printStackTrace();
                        }
                }
            super.onActivityResult(requestCode, resultCode, data);
        }

} 
```

从[链接](http://www.vogella.com/articles/AndroidIntent/article.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:53:59.787

您在 setImageURI 中传递 URI，因此首先使用`MediaStore.Images.Media.DATA`和 URI 获取图像路径，然后在 setImageURI 中传递图像路径。试试这种方式：

```
@Override
        protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if( resultCode==RESULT_OK)
        {
            if(requestCode==SELECT_PICTURE)
        {
            targetImage = (ImageView)findViewById(R.id.imageView1);
            Uri selectedImageUri = data.getData();
            String selectedImagePath=getPath(selectedImageUri);
            targetImage.setImageURI(selectedImageUri);
            }
        }
    }

    private String getPath(Uri uri)
        {    
        String[] projection={MediaStore.Images.Media.DATA}; 
        Cursor cursor=managedQuery(uri,projection,null,null,null);
        int column_index=cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA); 
        cursor.moveToFirst(); 
        return cursor.getString(column_index); 
    } 
```

# javascript - 如何使用数据 URI 将 MSWord 文档 (.docx) 传递到 Chrome？

> ID：11039456
> 
> 赞同：1
> 
> 时间：2012-06-14T18:46:48.867
> 
> 标签：javascript, google-chrome, ms-word, data-uri

我有一个 JavaScript 应用程序，它对文件进行客户端加密和解密，将加密数据存储在 Google Cloud Storage 中。所有加密和数据传输的东西都能正常工作，但我无法让所有文档类型在 Chrome 中打开。由于 Chrome 的内置 PDF 查看器，PDF 可以正常工作，但我也希望它能够自动打开其他文件类型。例如：

JavaScript 应用程序检索加密数据，然后对其进行解密以生成包含 Word 文档的字符串或字节数组。

我创建了一个数据 URI 并在其上调用 window.open()。在 PDF 情况下，将打开一个带有 PDF 文档的新选项卡。当数据 URI 是 Word 文档（MIME 类型 application/vnd.openxmlformats-officedocument.wordprocessingml.document）时，我得到一个（显然）没有内容的空白窗口。

我已经能够使用数据 URI 创建一个 <A> 标记，如果用户右键单击该链接，它会下载正确的数据，但是虽然我已将该 MIME 类型设置为在下载时自动打开，但 Chrome 不会打开它。（它会自动打开从具有该 MIME 类型的常规 HTTP 请求发送的 Word 文档。）

我想对我的解密数据做几件事，从客户端 JavaScript 字符串开始：

*   在新选项卡/窗口中打开（浏览器可以做的事情，或者有插件）
*   在外部应用程序中打开
*   另存为文件

对这些有帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:56:22.247

它还需要 Google Chrome 也有一个 MS Word 查看器。默认情况下不包含的东西，如 PDF 查看器......

# python - 如何将 Python 列表写入文件？

> ID：11039459
> 
> 赞同：0
> 
> 时间：2012-06-14T18:46:59.400
> 
> 标签：python, file, list

我正在尝试将字符串列表写入 Python 中的文件。这样做时我遇到的问题是输出的外观。我想在没有列表结构的情况下编写列表的内容。

这是将列表写入文件的代码部分：

```
loglengd = len(li)
runs = 0
while loglengd > runs:
    listitem = li[runs]
    makestring = str(listitem)
    print (makestring)
    logfile.write(makestring + "\n")
    runs = runs +1
print("done deleting the object")
logfile.close() 
```

这给我的输出如下所示：

```
['id:1\n']
['3\n']
['-3.0\n']
['4.0\n']
['-1.0\n']
['id:2\n']
['3\n']
['-4.0\n']
['3.0\n']
['-1.0\n']
['id:4\n']
['2\n']
['-6.0\n']
['1.0\n']
['-1.0\n'] 
```

这就是它应该看起来的样子：

```
id:1
3
-3.0
4.0
-1.0
id:2
3
-4.0
3.0
-1.0
id:4
2
-6.0
1.0
-1.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:53:49.893

1.  请学习如何使用循环（[http://wiki.python.org/moin/ForLoop](http://wiki.python.org/moin/ForLoop)）

2.  `li`似乎是列表列表，而不是字符串列表。因此，您必须使用`listitem[0]`来获取字符串。

如果您只想将文本写入文件：

```
text='\n'.join(listitem[0] for listitem in li)
logfile.write(text)
logfile.close() 
```

如果您还想在循环中执行某些操作：

```
for listitem in li:
    logfile.write(listitem[0] + '\n')
    print listitem[0]
logfile.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:31:39.233

```
for s in (str(item[0]) for item in li):
    print(s)
    logfile.write(s+'\n')

print("done deleting the object")
logfile.close() 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-14T18:56:19.660

您正在搜索的字符串函数是 strip()。

它是这样工作的：

```
logs = ['id:1\n']
text = logs[0]
text.strip()
print(text) 
```

所以我认为你需要这样写：

```
loglengd = len(li)
runs = 0
while loglengd > runs:
    listitem = li[runs]
    makestring = str(listitem)
    print (makestring.strip())     #notice this
    logfile.write(makestring + "\n")
    runs = runs +1
print("done deleting the object")
logfile.close() 
```

# wpf - Sqlite 和 fluent nhibernate 一起这么慢

> ID：11039461
> 
> 赞同：1
> 
> 时间：2012-06-14T18:47:00.393
> 
> 标签：wpf, sqlite, fluent-nhibernate

您好，我在 WPF 应用程序中使用 Fluent Nhibernate 和 SQLite。
Fluent Nhibernate 版本是“fluentnhibernate-NH3.1-1.2”，Sqlite 版本是“1.0.79”我的应用程序配置是

```
<configuration>
<runtime>
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
  <dependentAssembly>
    <assemblyIdentity name="System.Data.SQLite" publicKeyToken="DB937BC2D44FF139" culture="neutral"/>        
    <bindingRedirect oldVersion="0.0.0.0-1.0.79.0" newVersion="1.0.79.0"/>
  </dependentAssembly>
</assemblyBinding> 
```

**问题是他们处理非常慢的事务处理 3000 个事务需要 10 分钟才能完成 ** 我使用 Journal_mode = off 并且效果很好但是当我尝试执行 **急切加载 ** 500 kb 数据需要 5 分钟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:13:09.723

我终于找到了解决方案，在会话工厂构建器方法和 builschema 方法的配置中，有一行代码我不得不把它变成红色：showsql 指令是减慢进程的一条，现在我的应用程序能够进行 72000 次插入每秒

# sql - 类似 SQL 的运算符：将通配符附加到结果集中的列（在 SAP HANA 数据库上）

> ID：11039462
> 
> 赞同：1
> 
> 时间：2012-06-14T18:47:01.987
> 
> 标签：sql

~~我有如下 SQL 语句：~~

 ~~```
select A from table1, (select B from table2) where A like B 
```~~ 

我想知道是否可以在 where 语句中将通配符 '%' 附加到 B 中，例如：

```
where A like B% 
```

~~谢谢！~~

编辑：我正在研究 SAP HANA 数据库，我找到了正确的语法，它是：

```
where A like B || '%' 
```

感谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:48:10.833

是的，这是可能的，但语法因数据库而异。

**SQL 服务器**

```
WHERE A LIKE (B + '%') 
```

**甲骨文**

```
WHERE A LIKE (B || '%') 
```

**MySQL / Postgres**

```
WHERE A LIKE CONCAT(B, '%') 
```

# android - VideoView 初始显示导致布局扩大屏幕长度

> ID：11039466
> 
> 赞同：2
> 
> 时间：2012-06-14T18:47:15.810
> 
> 标签：android

每个人。我有一个项目，我需要在 VideoView 中以纵向显示视频，但过去几周我遇到了一个奇怪的问题。另请注意，此问题仅在 VideoView 首次加载数据时发生。

这是布局的一个非常精简的版本：

```
<RelativeLayout>
    <RelativeLayout>
       <VideoView /> <-- W:fill_parent, H:wrap_content
    </RelativeLayout>
</RelativeLayout> 
```

现在解决实际问题：当 VideoView 首次加载数据时，它的高度/宽度都填充整个屏幕（减去填充空间）不到一秒（最多 3 秒，取决于它是本地还是流媒体），然后它会神奇地将自己调整到预期的大小。

由于未存储在本地的视频需要更长的时间，我觉得问题似乎与 VideoView 需要时间来加载视频有关，并且没有立即正确调整其边界，这就是为什么它会扩展以填满屏幕，然后突然下降降到合适的大小。

现在，我相信它每次都没有这样做的原因是因为它每次加载时仍然使用相同的 VideoView 实例（因为它使用的是 ViewFlipper 而不是 setContentView，所以它没有创建它的新实例）。

但是，我以同样的方式将数据加载到 VideoView 中，我不明白为什么问题不会持续存在，这让我认为我对它为什么这样做的假设是错误的。

现在我尝试过：

我开始为 RelativeLayout 和 VideoView 设置宽度为 fill_parent 和高度为 wrap_content，这是我最初注意到这个问题的地方。另请注意：Eclipse 中的图形布局显示了与我试图解决的这些设置相同的问题：VideoView 被扩展以填充屏幕，减去它具有的填充）。

我尝试将布局强制为 XML 布局中的特定像素尺寸（我知道这很糟糕），然后为视图定义新的 LayoutParams 并在视频正确加载后设置它们。

我尝试动态创建一个新的 VideoView 并在加载后将其添加到布局中；仍然没有运气。

现在我没有想法了......其他人有吗？

并提前感谢您的帮助~

**编辑：**

同时，作为一种解决方法，我为 VideoView 创建了一个 onPreparedListener()，并保持视图隐藏，直到 onPreparedListener 被触发。这似乎解决了这个问题，但我更好奇为什么 VideoView 正在做它正在做的事情，而不一定只是如何解决它。

再次感谢~

# php - 当所有源文件都不在 webroot 中时，如何将项目添加到 Netbeans？

> ID：11039467
> 
> 赞同：2
> 
> 时间：2012-06-14T18:47:18.663
> 
> 标签：php, netbeans, xdebug

我的项目的目录结构是这样的：-

`/var/www/includes/`
`/var/www/classes/`

`/var/www/public/css/`
`/var/www/public/js/`
`/var/www/public/index.php`

webroot 是`/var/www/public`，因此访问测试域`localhost.dev`将提供目录内的`public`文件，因此会运行`/var/www/public/index.php`。无需访问喜欢`localhost.dev/public/index.php`

问题是当我在 Netbeans 中创建项目时，我必须设置索引文件，以便可以使用 xdebug 和 Netbeans 调试项目。

因此，当添加我`/var/www`作为项目源文件夹 ( `Sources Folder`)提供的项目时，`includes`并且`classes`在此文件夹中。在下一个项目配置屏幕 ( `Choose Project > Name and Location > file path is taken as Run Configuration`) 中，我被要求输入`Project URL`和`index file`. 由于该`index.php`文件实际上是在 下`/var/www/public/`，当我浏览文件并选择它时，索引页面的 url 被视为`localhost.dev/public/index.php`而不是只是`localhost.dev/index.php`. 这使我无法调试项目。

当所有源文件都不在 web 根目录中并且项目将使用 xdebug 进行调试时，任何人都可以指出如何将项目添加到 Netbeans。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-28T22:29:04.497

我还没有找到更好的方法，但我使用以下步骤：

1.  菜单：**项目属性**-> 链接：**运行配置**-> 按钮：**高级**
2.  调试 URL，选择：**每次询问**
3.  路径映射，服务器路径：[http](http://localhost.dev/) ://localhost.dev/ ，项目路径：/var/www/public/

现在，当您开始调试过程时，Netbeans 将显示**指定 URL**弹出窗口，您可以将其从[http://localhost.dev/public/index.php](http://localhost.dev/public/index.php)更改为[http://localhost.dev/index.php](http://localhost.dev/index.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T15:28:16.200

我有一个类似的设置，但有一个小区别：我的设置使用本地开发服务器上的远程站点。在项目属性的“运行配置”窗口中，我将“运行方式”设置为“远程网站（FTP、SFTP）”。我认为这不会影响我回答中的信息，但我只是为了以防万一。

转到项目属性的“源”窗口，找到“Web Root”条目，单击“浏览”并选择`/var/www/public`目录。这应该会导致 xDebug 使用[localhost.dev/index.php](http://localhost.dev/index.php)。当您转到“运行配置”窗口并浏览索引文件时，您会注意到浏览窗口将以“公共”而不是“www”开始。

**关于这种类型的配置的一个重要说明让我非常沮丧。**

使用 xDebug 时，您将希望能够在 Web 根（公共）目录之外设置断点并使用这些文件。因为您已将 Web 根目录设置为`/var/www/public`，所以您将无法使用`/var/www/includes`或中的文件`/var/www/classes`。

您需要做的是将 Web 根目录之外的文件添加到全局包含路径。

有两种方法可以将目录添加到全局包含路径，使用哪种方法取决于您如何配置项目。

在您的情况下，外部目录包含在您的项目中，因此您需要通过“选项”界面添加它们。转到*工具->选项*并选择“PHP”选项卡，然后将`/var/www/includes`和`/var/www/classes`文件夹添加到全局包含路径。

将文件添加到全局包含路径的另一种方法是用于位于项目源文件夹之外的文件。对于类似的目录`/var/folder_outside_www/`，您可以使用项目属性中的“PHP 包含路径”窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:56:30.827

我认为将所有项目文件直接放入`/var/www`.

我认为您永远不会在实际部署的项目中看到这一点。所以我的第一个建议是改变你构建项目的方式。如果这不可能，请在 Netbeans 中选择`/var/www/public`项目文件夹。

如果 Netbeans 需要引用 中的文件夹，请`/var/www`在 public 中创建符号文件夹，指向`/var/www`.

您拥有的最后一个资源是在 Apache 中创建一个重写规则以使其`localhost.dev/public`与`localhost.dev`. 您可以在[Apache 文档](https://httpd.apache.org/docs/2.0/misc/rewriteguide.html)中查找此内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-23T06:17:38.743

将 /var/www/public 设置为项目文件夹（包含 netbeans 项目文件夹）并包含在项目属性 /var/www/includes/ 和 /var/www/classes/ 中作为全局包含目录。或者最好的方法是使用 PHPStorm。

# html - WordPress 模板真的只是 HTML 和 CSS 吗？

> ID：11039471
> 
> 赞同：-6
> 
> 时间：2012-06-14T18:47:39.833
> 
> 标签：html, css, wordpress

WordPress 模板真的只是在 WordPress “循环”的上下文中使用 CSS 样式化的 HTML 吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:49:26.557

它们是 HTML、CSS、~~Javascript~~和**PHP**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T05:36:59.513

是的，一个 Wordpress 主题可以像一个[子主题](http://codex.wordpress.org/Child_Themes)一样简单，它只包含一个带有一些 css 覆盖的单个 css 文件，或者一个包含大量 php 等的完整[主题框架](http://codex.wordpress.org/Theme_Frameworks)......或者它们可以只是你的普通主题（通常包含 css、可能是 javascript 和 php 文件，这些文件可能仅利用 php 将 Wordpress 提供的内容集成到嵌入到 php 文件中的 html 文档中）。

开始玩主题的最佳方式是根据 Wordpress 制作的二十一或二十一这样的主题开始制作[子主题。](http://codex.wordpress.org/Child_Themes)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T20:01:05.020

[您可以在 Wordpress 的要求页面http://wordpress.org/about/requirements/](http://wordpress.org/about/requirements/)上找到您的问题的快速答案，您可以在其中看到需要 php 和 mysql。如果您浏览开发人员和高级主题部分，您将看到有关在 word press 中使用 javascript 和 ajax 的主题。我相信根据您的安装方式，还有其他可用的选项。

# node.js - 如何在 Jade 中生成这个 HTML

> ID：11039473
> 
> 赞同：0
> 
> 时间：2012-06-14T18:47:49.133
> 
> 标签：node.js, express, pug

如何使用 Jade 生成此 HTML

```
<a class="btn btn-primary btn-large" data-toggle="modal" href="#websiteModal">
<i class=" icon-map-marker icon-white"></i>
Configure for Website</a> 
```

我试过

```
a.btn.btn-primary.btn-large(data-toggle="modal",href="#websiteModal") Configure for Website
                i.icon-map-marker.icon-white 
```

但它会`<i>`在“为网站配置”文本之后放置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T19:11:16.483

你可以这样做：

```
a.btn.btn-primary.btn-large(data-toggle="modal",href="#websiteModal")
  i.icon-map-marker.icon-white
  | Configure for Website 
```

或者，如果你觉得很花哨：

```
a.btn.btn-primary.btn-large(data-toggle="modal",href="#websiteModal")='Configure for Website'
  i.icon-map-marker.icon-white 
```

# objective-c - 在其自定义设置器中使用 NSString 会导致无限线程

> ID：11039476
> 
> 赞同：1
> 
> 时间：2012-06-14T18:47:53.967
> 
> 标签：objective-c, ios, cocoa

首先，我为 NSString* 编写了我的自定义设置器，如下所示：

```
- (void)setDateString:(NSString *)newDateString {
    self.dateString = newDateString;
    NSInteger dateNumber = [dateString integerValue];
        // this line causes crash

    // do something here..blah blah
} 
```

然后程序由于执行 [XXX setDateString:] 的无限多线程而停止。

经过几次无用的尝试后，我发现这个[问题/答案](https://stackoverflow.com/questions/9712972/custom-setter-for-nsstring)告诉我

> 不要使用自我。在自定义访问器内部。直接访问变量，

所以我把我的代码变成了

```
- (void)setDateString:(NSString *)newDateString {
    //self.dateString = newDateString;
    dateString = newDateString;
    NSInteger dateNumber = [dateString integerValue];

    // do something here..blah blah
} 
```

然后一切都像魅力一样！

* * *

我是一些客观语言的初级开发人员，也是 Objective-C 的新手。

我想详细了解这个问题，而不是在不了解原因的情况下解决问题。

因此，请为我提供一些材料/网站以了解更多有关此内容的信息。

顺便说一句，我使用 ARC。

谢谢你们。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:51:37.057

问题实际上不是这一行：

```
NSInteger dateNumber = [dateString integerValue]; 
```

就是这一行：

```
self.dateString = newDateString; 
```

你看，等号类似于字面调用`[self setDateString:newDateString]`（事实上，这是编译器重新解释它的），它会创建一个无限循环。自然，注释掉该行一开始就不会创建该循环。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T18:51:54.527

```
self.dateString = newDateString; 
```

相当于

```
[self setDateString:newDateString]; 
```

所以这将导致无限*递归*，因为你在里面调用它`-setDateString:`。

另请参阅[self.ivar 和 ivar 之间的区别？](https://stackoverflow.com/questions/4142177/difference-between-self-ivar-and-ivar).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T18:52:29.007

发生的事情是你一次又一次地调用函数，导致调用函数陷入溢出

错在这一行

```
self.dateString = newDateString; 
```

这一行是一个客观的 c 属性，它有一个 getter 和 setters 方法，这些方法是在你 @synthesize 时自动生成的，dateString 的 setter 和 getters 方法是：

```
 - (void)setDateString:(NSString *)newDateString; 
```

和

```
 - (NSString*)dateString; 
```

所以当你调用`self.dateString = newDateString;` 这条线时会再次调用这个函数

```
- (void)setDateString:(NSString *)newDateString { 
```

而这个函数又包含了`self.dateString = newDateString;`，你的调用栈会越来越深，直到你的堆栈存储空间不足

# c# - 为什么使用 ToList 时此 Linq Cast 失败？

> ID：11039479
> 
> 赞同：39
> 
> 时间：2012-06-14T18:48:05.993
> 
> 标签：c#, linq, casting

考虑这个人为的、简单的例子：

```
 var foo = new byte[] {246, 127};
    var bar = foo.Cast<sbyte>();
    var baz = new List<sbyte>();
    foreach (var sb in bar)
    {
        baz.Add(sb);
    }
    foreach (var sb in baz)
    {
        Console.WriteLine(sb);
    } 
```

借助 Two's Complement 的魔力，-10 和 127 被打印到控制台。到目前为止，一切都很好。眼睛敏锐的人会看到我正在迭代一个可枚举并将其添加到列表中。这听起来像`ToList`：

```
 var foo = new byte[] {246, 127};
    var bar = foo.Cast<sbyte>();
    var baz = bar.ToList();
    //Nothing to see here
    foreach (var sb in baz)
    {
        Console.WriteLine(sb);
    } 
```

除了那不起作用。我得到这个例外：

> 异常类型：System.ArrayTypeMismatchException
> 
> 消息：源数组类型不能分配给目标数组类型。

我觉得这个例外很奇怪，因为

1.  `ArrayTypeMismatchException`- 我自己没有对数组做任何事情。这似乎是一个内部异常。
2.  `Cast<sbyte>`工作正常（如在第一个示例中），它是在使用时或`ToArray`问题`ToList`出现时。

我的目标是 .NET v4 x86，但在 3.5 中也是如此。

我不需要任何关于如何解决问题的建议，我已经设法做到了。我想知道的是为什么首先会发生这种行为？

**编辑**：

更奇怪的是，添加一个无意义的 select 语句会导致`ToList`正常工作：

```
var baz = bar.Select(x => x).ToList(); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-14T19:04:00.877

好的，这实际上取决于一些奇怪的组合：

*   即使在 C# 中您不能直接将 a`byte[]`转换为a `sbyte[]`，CLR 也允许它：

    ```
    var foo = new byte[] {246, 127};
    // This produces a warning at compile-time, and the C# compiler "optimizes"
    // to the constant "false"
    Console.WriteLine(foo is sbyte[]);

    object x = foo;
    // Using object fools the C# compiler into really consulting the CLR... which
    // allows the conversion, so this prints True
    Console.WriteLine(x is sbyte[]); 
    ```

*   `Cast<T>()`优化使得如果它认为它不需要做任何事情（通过`is`像上面的检查）它返回原始参考 - 所以这发生在这里。

*   `ToList()`委托给构造`List<T>`函数`IEnumerable<T>`

*   该构造函数已针对`ICollection<T>`使用进行了优化`CopyTo`......*这*就是失败的原因。这是一个没有方法调用的*版本*`CopyTo`：

    ```
    object bytes = new byte[] { 246, 127 };

    // This succeeds...
    ICollection<sbyte> list = (ICollection<sbyte>) bytes;

    sbyte[] array = new sbyte[2];

    list.CopyTo(array, 0); 
    ```

现在，如果您`Select`在任何时候使用 a ，您最终都不会得到 a `ICollection<T>`，因此它会通过每个元素的合法（对于 CLR）`byte`/`sbyte`转换，而不是尝试使用`CopyTo`.

# powershell - PowerShell - 用于处理 cmdlet 的动词是什么？

> ID：11039482
> 
> 赞同：8
> 
> 时间：2012-06-14T18:48:16.417
> 
> 标签：powershell

试图找到一个标准。

CmdLet 将处理数据 - 由参数定义的多个输入到输出。处理将需要很短的时间，大部分时间为 5 到 15 分钟，而系统会处理大量数据并对其进行分析。

“执行”给了我一个警告，但我发现的“常用动词”似乎都不合适。我发现没有那么多打开等，但没有“处理”或“执行”或“分析”。

有没有我忽略的特定标准动词？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T18:59:18.363

根据您提供的信息，我建议`Invoke`. 但是您可以在这些链接中找到一些关于 Cmdlet 动词的有用讨论：

*   **[MSDN 上的 Cmdlet 动词](https://web.archive.org/web/20171222220053/https://msdn.microsoft.com/en-us/library/windows/desktop/ms714428(v=vs.85).aspx)**
*   **[PowerShell：已批准的动词（通过 v3.0）](http://social.technet.microsoft.com/wiki/contents/articles/4537.powershell-approved-verbs-en-us.aspx)**

第一个链接的一些关键摘录：

> **调用**- 执行操作，例如运行命令或方法。
> 
> **Invoke** vs. **Start** *Invoke*动词用于执行通常是同步操作的操作，例如运行命令。*Start*动词用于开始通常是异步操作的 操作，例如启动进程。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-15T00:13:19.393

要获得批准的动词列表，请使用`Get-Verb`cmdlet。如果我想在不依赖 MSDN 或 Google（或 Bing 或 DuckDuckGo）的情况下找到合适的动词，我经常会发现这很有用。

```
PS> Get-Verb

Verb        Group
----        -----
Add         Common
Clear       Common
Close       Common
Copy        Common
Enter       Common
Exit        Common
Find        Common
Format      Common
Get         Common
Hide        Common
Join        Common
Lock        Common
Move        Common
New         Common
Open        Common
Pop         Common
Push        Common
Redo        Common
Remove      Common
Rename      Common
Reset       Common
Search      Common
Select      Common
Set         Common
Show        Common
Skip        Common
Split       Common
Step        Common
Switch      Common
Undo        Common
Unlock      Common
Watch       Common
Backup      Data
Checkpoint  Data
Compare     Data
Compress    Data
Convert     Data
ConvertFrom Data
ConvertTo   Data
Dismount    Data
Edit        Data
Expand      Data
Export      Data
Group       Data
Import      Data
Initialize  Data
Limit       Data
Merge       Data
Mount       Data
Out         Data
Publish     Data
Restore     Data
Save        Data
Sync        Data
Unpublish   Data
Update      Data
Approve     Lifecycle
Assert      Lifecycle
Complete    Lifecycle
Confirm     Lifecycle
Deny        Lifecycle
Disable     Lifecycle
Enable      Lifecycle
Install     Lifecycle
Invoke      Lifecycle
Register    Lifecycle
Request     Lifecycle
Restart     Lifecycle
Resume      Lifecycle
Start       Lifecycle
Stop        Lifecycle
Submit      Lifecycle
Suspend     Lifecycle
Uninstall   Lifecycle
Unregister  Lifecycle
Wait        Lifecycle
Debug       Diagnostic
Measure     Diagnostic
Ping        Diagnostic
Repair      Diagnostic
Resolve     Diagnostic
Test        Diagnostic
Trace       Diagnostic
Connect     Communications
Disconnect  Communications
Read        Communications
Receive     Communications
Send        Communications
Write       Communications
Block       Security
Grant       Security
Protect     Security
Revoke      Security
Unblock     Security
Unprotect   Security
Use         Other

PS> 
```

# jquery - jquery淡入淡出闪烁

> ID：11039486
> 
> 赞同：1
> 
> 时间：2012-06-14T18:48:28.790
> 
> 标签：jquery, css, menu, css-position

我希望有人可以帮助我。我有以下问题：

[http://jsfiddle.net/zhPAF/](http://jsfiddle.net/zhPAF/)

加价：

```
<nav>
                <ul id="topNav">
                    <li id="topNavFirst"><a href="pages/about/about.php" id="aboutNav">About Us</a></li>
                    <li id="topNavSecond"><a href="pages/people/our-people.php" id="peopleNav">Our People</a>
                        <ul id="subList1">
                            <li><a href="pages/people/mike-hadfield.php">Mike Hadfield</a></li>
                            <li><a href="pages/people/karen-sampson.php">Karen Sampson</a></li>
                            <li><a href="pages/people/milhana-farook.php">Milhana Farook</a></li>
                            <li><a href="pages/people/kim-crook.php">Kim Crook</a></li>
                            <li><a href="pages/people/amanda-lynch.php">Amanda Lynch</a></li>
                            <li><a href="pages/people/gideon-scott.php">Gideon Scott</a></li>
                            <li><a href="pages/people/paul-fuller.php">Paul Fuller</a></li>
                            <li><a href="pages/people/peter-chaplain.php">Peter Chaplain</a></li>
                            <li><a href="pages/people/laura-hutley.php">Laura Hutley</a></li>
                        </ul>
                    </li>
                    <li id="serviceNavDropdown"><a href="our-services.php" id="servicesNav">Our Services</a>
                        <ul id="subList2">
                            <li><a href="pages/services/company-and-commercial.php">Company &amp; Commercial</a></li>
                            <li><a href="pages/services/employment.php">Employment</a></li>
                            <li><a href="pages/services/civil-litigation.php">Civil Litigation</a></li>
                            <li><a href="pages/services/debt-recovery.php">Debt Recovery</a></li>
                            <li><a href="pages/services/conveyancing.php">Conveyancing</a></li>
                            <li><a href="pages/services/commercial-property.php">Commerical Property</a></li>
                            <li><a href="pages/services/wills-and-probate.php">Wills &amp; Probate</a></li>
                            <li><a href="pages/services/family.php">Matrimonial &amp; Family</a></li>
                        </ul>
                    </li>
                    <li><a href="pages/news/news.php" id="newsNav">News</a></li>
                    <li><a href="pages/careers/careers.php" id="careersNav">Careers</a></li>
                    <li><a href="pages/contact/contact.php" id="contactNav">Contact</a></li>
                </ul><!-- /topNav -->
            </nav>​ 
```

CSS

```
#topNav {
float:right;
height:30px;
margin:0;
font-size:12px;
}

#topNav li {
display:inline;
list-style:none;
color:#666;
border-left: 1px solid #666;
padding: 0 0 0 3px;
}

#topNav li a:hover {
}

#topNavFirst {
border-left: 1px solid transparent !important;
}

#topNav ul{
background:#fff url(images/people-ul-bg.png) no-repeat;
border:1px solid #666;
border-top:0px solid transparent;
border-bottom:2px solid #666;
list-style:none;
position:absolute;
left:-9999px;
width:90px;
text-align:left;
padding:5px 0 5px 0px;
z-index:10;
}

#topNav ul li{
display:block;
border-left:0px;
margin-bottom: 0px;
padding:0;
}

#topNav ul a{
padding:0 0 0 5px;    
}

#topNav li:hover ul{
left:auto;
margin-left:55px;
margin-top:-1px;            
}

#topNav li:hover a { 
color:#369;
}

#topNav li:hover ul a{ 
text-decoration:none;
color:#666;
}

#topNav li:hover ul li a:hover{ 
color:#fff;;
width:100%;
}

#topNav ul li:hover {
background:#369;
display: block;
}

#topNav ul li a {
display: block;
padding:0 0 0 4px;
}

#serviceNavDropdown ul{ 
background:#fff url(images/service-ul-bg.png) no-repeat;
width:135px !important;
margin-left:117px !important;
margin-top:-1px;        
} 
```

jQuery

```
jQuery(document).ready(function () {

        $('#subList1').css("display", "none");
        $('#topNavSecond').hover(function () {
            $('#subList1').fadeIn('slow');
        },
        function(){
            $('#subList1').fadeOut('slow');
        });
         $('#subList2').css("display", "none");
        $('#serviceNavDropdown').hover(function () {
            $('#subList2').fadeIn('slow');
        },
        function(){
            $('#subList2').fadeOut('slow');
        });
    });​ 
```

当 #topNavSecond ('Our People') 锚点悬停时，ul #subList1 应该淡入。现在，正如您从小提琴中看到的那样，它不会在第一次悬停时消失，而只会在随后的悬停时消失。同样，下一个锚点（“我们的服务”）也在做同样的事情，并且在它们之间移动时存在一些褪色问题。

我已经达到了 jquery 知识的极限（诚然，这并不多！）并且非常感谢一些帮助。

编辑>上面的代码是更正后的代码并且正在工作。但是下面的 jQuery 更好，添加了一些 .stop(true, true)：

```
jQuery(document).ready(function () {

        $('#subList1').css("display", "none");
        $('#topNavSecond').hover(function () {
            $('#subList1').stop(true, true).fadeIn('slow');
        },
        function(){
            $('#subList1').stop(true, true).fadeOut('slow');
        });
         $('#subList2').css("display", "none");
        $('#serviceNavDropdown').hover(function () {
            $('#subList2').stop(true, true).fadeIn('slow');
        },
        function(){
            $('#subList2').stop(true, true).fadeOut('slow');
        });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:53:32.360

您已将其设置`$('#topNavSecond').parent().hover(function ()`为#topNavSecond 的父级将是整个 UL。我相信你的意思 `$('#topNavSecond').hover(function ()`

见这里：http: [//jsfiddle.net/zhPAF/1/](http://jsfiddle.net/zhPAF/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:54:28.287

我没有看到任何闪烁，但也许我不理解。但是，您应该`.stop()`在动画发生之前添加一些 s，以防它没有完成。

```
 $('#subList1').css("display", "none");
        $('#topNavSecond').parent().hover(function () {
            $('#subList1').stop(true, true).fadeIn('slow');
        },
        function(){
            $('#subList1').stop(true, true).fadeOut('slow');
        });
         $('#subList2').css("display", "none");
        $('#serviceNavDropdown').parent().hover(function () {
            $('#subList2').stop(true, true).fadeIn('slow');
        },
        function(){
            $('#subList2').stop(true, true).fadeOut('slow');
        }); 
```

[http://jsfiddle.net/imoda/zhPAF/3/](http://jsfiddle.net/imoda/zhPAF/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:23:04.670

首先，我会为您的 css 做一些补充：将其添加到此：

```
#topNav li {
    position:relative;
} 
```

添加此规则：

```
#topNav li ul {
    position:absolute;
    display:none;
} 
```

现在，不要直接调用事物，而是使用 jQuery 通过标签类型和层次结构来获取它们：

```
$('#topNav li').hover(function () {
            $(this).children('ul').stop(true, true).animate({'opacity' : 'show'}, 'slow');
        },
        function(){
            $(this).children('ul').stop(true, true).animate({'opacity' : 'hide'}, 'slow');
        }); 
```

这将适用于 li 中包含的任何 ul，其中任何 id 为 topnav。使用 CSS 来指示定位。我选择了 animate，因为它的功能相同，并为您提供了更多控制……您可以轻松地添加 'height' : 'show' 和 'height' : 'hide' 以获得漂亮的动画效果。

我建议不要为 li 中的 ul 设置特定宽度。添加一个空格：nowrap; 到 li，然后使用一些填充在标签级别完成所有操作，ul 和 li 将形成这些。

另外，我会避免在除 a 之外的任何东西上使用 :hover，因为 IE 不能很好地处理它。

# php - $_SESSION 和 $_SERVER 变量究竟是如何请求的？

> ID：11039488
> 
> 赞同：-5
> 
> 时间：2012-06-14T18:48:35.310
> 
> 标签：php, arrays, session, optimization

我有一个简单的问题：数组变量`$_SESSION`和`$_SERVER`请求到底是怎样的？它们是否只是在请求页面时设置并在请求页面之前保持不变（例如

```
for($i=0, $i<100, ++$i) {
   echo $_SERVER['REQUEST_TIME'],'<br/>',$_SESSION['lastActive'],'<hr/>';
} 
```

只会对每个变量执行一个**请求**并发布 100 行）或者我应该简单地将它们绑定到一个变量以避免不必要的服务器请求，例如

```
$time=$_SERVER['REQUEST_TIME'];
$lastActive=$_SESSION['lastActive'];
for ($i=0, $i<100, ++$i) {
   echo $time,'<br/>',$lastActive,'<hr/>';
} 
```

如果这听起来像常识，我很抱歉，但我只是不喜欢在可以避免的地方设置额外的变量，因此尝试做尽可能多的研究。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:50:24.253

从未发出过任何请求（即 Web 请求）。即使在访问`$_GET`and时`$_POST`，客户端和服务器之间也没有来回通信来获取内容。

此外，如果您认为 PHP 在客户端上运行，它不会。

最后，如果您只是指加载： 的内容`$_SERVER`将在脚本开头或首次访问时设置，具体取决于您的`php.ini`设置。`$_SESSION`调用时会设置`session_start();`。

# .htaccess - 我删除了 .htaccess 但它的效果仍然存在

> ID：11039490
> 
> 赞同：0
> 
> 时间：2012-06-14T18:48:43.687
> 
> 标签：.htaccess, mod-rewrite

我开始使用 .htaccess 进行一些重定向，但我只是做错了。我试图在我写[http://www.mydomain.com/it/about](http://www.mydomain.com/it/about)时进行重定向，浏览器跳转到[http://www.mydomain.com/it/about.php](http://www.mydomain.com/it/about.php)但我写错了！我不记得我写了什么（我通过互联网多次获取了一些代码）但现在的问题是我已经删除了 .htaccess 但是当我尝试访问[http://www.mydomain.com/ it/about.php](http://www.mydomain.com/it/about.php)浏览器被重定向到[http://www.mydomain.com/it/about](http://www.mydomain.com/it/about)。怎么会这样？？？？没有任何 .htaccess 进入服务器！！！！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:50:55.370

如果您使用 301-Redirect ( `[R=301]`)，浏览器将缓存重定向。尝试其他浏览器或删除缓存

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:50:56.103

你确定没了？`.htaccess`为安全起见，文件被隐藏。

尝试上传一个空`.htaccess`文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:52:35.900

通过在终端中键入“a2dismod rewrite”禁用重写模块并重新启用它。这将消除 .htaccess 文件的影响。

# facebook - Facebook API - 按名称搜索用户，无需访问令牌

> ID：11039496
> 
> 赞同：1
> 
> 时间：2012-06-14T18:49:25.170
> 
> 标签：facebook, facebook-graph-api, facebook-access-token

我需要通过姓名（例如全名或名字）在 Facebook 上搜索某些用户。是否可以在没有用户访问令牌的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:56:00.317

不，你不能那样做，

最多，您可以搜索用户对象（注意，您必须提供搜索类型）（将包括与 jashwant 相关的所有内容）

```
http://graph.facebook.com/search?q=jashwant 
```

但是这个

```
http://graph.facebook.com/search?q=jashwant&type=user 
```

将 access_token 附加到请求的 URL。

# postgresql - 如何在没有用户输入/密码的情况下从命令行执行 PostgreSQL 脚本文件

> ID：11039499
> 
> 赞同：5
> 
> 时间：2012-06-14T18:49:32.533
> 
> 标签：postgresql, command-line, wix, command-line-arguments

在安装我的应用程序期间，我想创建一个 PostgreSQL 数据库以及一些表和函数。

为此，我使用 PostgreSQL 附带的 PSQL.EXE。我有 2 个脚本。第一个创建数据库和有权在该数据库上执行脚本的相应用户。我想以刚刚创建的用户身份执行第二个脚本。不幸的是，我找不到将该用户的密码作为命令行参数传递的方法。省略密码会导致执行停止并提示用户输入密码，我想避免这种情况 - 因为这是在我的应用程序安装期间执行的。

有什么方法可以将密码作为参数传递，或者我可以使用任何其他命令行工具吗？

进一步解释环境。我使用 WiX 3.5 设置作为“MSI-Builder”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T19:47:13.127

You can either use a pgpass file as dbenhur answerd, or you can set the environment variable PGPASSWORD before calling psql:

```
SET PGPASSWORD=my_very_secret_password
psql somedb someuser 
```

All supported environment variables are documented in the manual: [http://www.postgresql.org/docs/current/static/libpq-envars.html](http://www.postgresql.org/docs/current/static/libpq-envars.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-14T18:58:18.563

您不能通过 cmdline arg 提供密码（并且不希望这样做，因为这是糟糕的安全做法）。

您可以提供 .pgpass 文件来支持自动脚本身份验证。这是[文档](http://www.postgresql.org/docs/current/static/libpq-pgpass.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T19:43:20.823

更好的是，如果您有权创建 db 角色，那么您已经拥有所需的所有访问权限，而无需仔细使用密码登录。让第二个脚本在与第一个脚本相同的用户下运行，但包含以下行以切换用户：

```
set role my_new_user; 
```

`my_new_user`您要运行它的角色的名称在 哪里。

如果您因为登录名不同而仅划分脚本，那么它们可以进入同一个文件并在中途切换角色。

* * *

**注意：** 如果您没有以超级用户身份创建数据库和新角色，这可能会稍微复杂一些。如果是这种情况，您将需要使用以下命令创建新角色：

```
create role my_new_role ... ADMIN my_role; 
```

`my_new_role`您正在创建的角色在哪里，并且`my_role`是您的当前用户。然后当你简单地完成时：

```
revoke my_new_role from my_role; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-10-26T09:30:02.950

为了完成，您还可以使用 URI（[文档链接](https://www.postgresql.org/docs/9.6/static/libpq-connect.html)）

### 列出数据库

```
psql "postgresql://username:password@localhost/postgres" -l 
```

我还精心设计了这个命令，让它只有名字（如果你知道更好的方法，请告诉我）：

```
psql "postgresql://username:password@localhost/postgres" -l | awk -F '|' '{print $1}'| sed -e '/^\s*$/ d' -e '1,3d'|sed '$d'|awk '{print $1}' 
```

您还可以使用 unix socket 进行连接：

```
# ss -x -a |grep postgres|awk '{print $5}'
/var/run/postgresql/.s.PGSQL.5432 
```

注意使用socket的父目录：

```
# sudo -u postgres psql -d "postgresql:///postgres?host=/var/run/postgresql/" -l 
```

只有在您的 中有此行​​时，您才能执行此操作`pg_hba.conf`：

```
local   all     postgres                ident 
```

"ident" 使用 unix 用户进行身份验证

### 转储一个数据库

这里我添加了一个不同的端口号

```
pg_dump -Fc "postgresql://username:password@localhost:9001/${db}" > "backup_${db}.pgdump" 
```

使用 dumpall，您需要一个超级用户或角色（使用`CREATE ROLE ... SUPERUSER`）。它必须有权访问所有数据库。默认`postgres`可以。

但就我而言，我无法将 pg_dumpall 与 postgres 一起使用，因为他的密码已被开发人员删除。

所以我用：

```
 sudo -u postgres pg_dumpall -d "postgresql:///?host=/var/run/postgresql/" > all.dump 
```

### 测试版

```
# cat /opt/postgresql/PG_VERSION
9.6 
```

hth

# python - python re 用于操作码解析

> ID：11039500
> 
> 赞同：3
> 
> 时间：2012-06-14T18:50:05.213
> 
> 标签：python, regex, regular-language

我刚刚编写了一些代码来尝试从以下格式的 objdump 输出中解析操作码：-

```
 8048060:   89 e7                   mov    edi,esp
 8048062:   89 fe                   mov    esi,edi
 8048064:   6a 6b                   push   0x6b
 8048066:   58                      pop    eax
 8048067:   aa                      stos   BYTE PTR es:[edi],al
 8048068:   6a 65                   push   0x65
 804806a:   58                      pop    eax
 804806b:   aa                      stos   BYTE PTR es:[edi],al
 804806c:   6a 79                   push   0x79
 804806e:   58                      pop    eax
 804806f:   aa                      stos   BYTE PTR es:[edi],al
 8048070:   31 c0                   xor    eax,eax
 8048072:   aa                      stos   BYTE PTR es:[edi],al
 8048073:   40                      inc    eax
 8048074:   cd 80                   int    0x80 
```

我希望将操作码提取为`89 e7 89 f3 .... cd 80`. 我尝试使用以下正则表达式语句：-

```
opcode = ""
for line in f.readlines():
  match = re.search(r' ([\da-f]+):\s+([0-9a-f ]+)', line)
  opcode += match.group(2).strip() + " " 
```

虽然上面的代码片段有点适用于我的所有样本，但我确信在我有一条以 [af][space] 结尾的指令的情况下它会失败。

有人可以建议一个更好的正则表达式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:54:40.033

您可以尝试以下方法：

```
r' ([\da-f]+):\s+((?:[0-9a-f]{2} )+)' 
```

这应该在操作码之后更可靠地停止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T20:29:06.207

您不一定需要正则表达式。您可以只`split()`使用如下所示的字符串（注意：如果空格始终与示例数据中显示的完全一样，则此方法有效，因为它已生成，这似乎很可能）：

```
opcodes = []
for line in f.readlines():
    opcode = []
    for x in line.split(' ')[4:]:
        if x:
            opcode.append(x)
        else:
            opcodes.append(opcode)
            break
print opcodes 
```

**输出**：[['89', 'e7'], ['89', 'fe'], ['6a', '6b'], ['58'], ['aa'], ['6a', '65'], ['58'], ['aa'], ['6a', '79'], ['58'], ['aa'], ['31', 'c0'], [ 'aa'], ['40'], ['cd', '80']]

```
#if you need strings:
print [' '.join(sublist) for sublist in opcodes] 
```

**输出**：['89 e7'，'89 fe'，'6a 6b'，'58'，'aa'，'6a 65'，'58'，'aa'，'6a 79'，'58'，'aa '，'31 c0'，'aa'，'40'，'cd 80']

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T02:17:49.677

```
from itertools import chain

with open("objdump") as inf:
    opstrs = (line[9:35] for line in inf)
    ops    = (opstr.split() for opstr in opstrs)
    opcode = " ".join(chain(*ops)) 
```

结果操作码：

```
'89 e7 89 fe 6a 6b 58 aa 6a 65 58 aa 6a 79 58 aa 31 c0 aa 40 cd 80' 
```

# java - 通过移动设备访问 Java Web 应用程序

> ID：11039502
> 
> 赞同：2
> 
> 时间：2012-06-14T18:50:11.517
> 
> 标签：java, servlets, mobile, web

我有一个用 Java 编写的基本 Web 应用程序，在本地主机上的 tomcat 上运行。目前它只是一个简单的应用程序，带有一个我从浏览器访问的 servlet。我想编写一个移动 android 应用程序，它将成为我的 Java Web 应用程序的客户端。我希望 servlet 写入数据库并执行一些逻辑，但要从移动应用程序访问它。

目前我没有注册任何域名。

如何公开我的 Java Web 应用程序，以便在我的开发环境中能够通过我的移动设备访问它？意思是，目前它在我的 PC 上本地运行，我从浏览器（在本地主机上）访问。我想从不同的设备（移动设备）访问它 - 如何在我的家庭 LAN 中完成？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:05:29.873

如果 Web 应用程序托管在您的本地服务器上，您的手机将需要能够访问托管该应用程序的 IP 地址（即：192.168.1.100）和端口（即：8080）。

有几种方法可以让您的手机与桌面通信：

1.  通过 USB 或蓝牙直接连接。
2.  LAN 上的无线连接 - 如果您的手机可以无线连接到您的家庭 LAN，您应该能够访问您的 Web 应用程序（您的桌面防火墙可能必须打开您的 Web 端口）
3.  外部访问。这需要打开您的家庭网络以允许访问您桌面的 Web 端口。此外，您的互联网路由器必须配置为允许访问并可能进行 NAT 转换。请注意，在这种情况下，任何人都可以访问您的 Web 应用程序，因此请务必小心。您还需要使用外部 IP 地址而不是内部 LAN 地址。

域只需要允许使用名称 (http://www.example.com) 而不是您的 IP 地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:09:56.913

为了测试，如果您的移动设备与您的服务器在同一个 LAN 上，只需使用 LAN 上的服务器 ip 地址即可。给服务器一个静态IP地址和你的排序。

对于下一阶段的测试，您需要公开您的电脑以通过 Internet 访问。您通常通过在家庭路由器上配置 NAT 设置来做到这一点。你应该可以谷歌这个。

然后您的移动设备可以使用 3G 并且应该通过您的 ISP ip 地址与服务器通信。这将命中您的路由器，并且 NAT 路由会将其转发到您 LAN 上的服务器机器。

如果您需要任何澄清，请询问！

# c++ - C ++中的十六进制按位运算

> ID：11039507
> 
> 赞同：0
> 
> 时间：2012-06-14T18:50:38.667
> 
> 标签：c++, binary, hex, bit-manipulation, binaryfiles

通过在 c++ 中使用文件流，我已将二进制文件中的字符串读入缓冲区（4 个字节）。我知道缓冲区包含“ `89abcdef`”。缓冲区是这样的：

```
buffer[0] = 89
buffer[1] = ab
buffer[2] = cd
buffer[3] = ef 
```

现在，我想将这些数字恢复为一个十六进制数字`0x89abcdef`。然而，这并不像我想象的那么简单。我尝试了以下代码：

```
int num = 0;
num |= buffer[0];
num <<= 24;
cout << num << endl; 
```

此时，`num`显示为

```
ea000000 
```

当我对缓冲区的第二个元素尝试相同的算法时：

```
num = 0;
num |= buffer[1];
num <<= 16;
cout << num << endl; 
```

输出：

```
ffcd0000 
```

`ff`前面的对`cd`我来说将它们全部加在一起非常不方便（我打算让它看起来像`00cd0000`，然后将它添加到第一个`num`）。

谁能帮我恢复十六进制数`0x89abcdef`？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T18:52:41.110

直到最后不要修改实际数字：

```
num = buffer [0] << 24 | buffer [1] << 16 | buffer [2] << 8 | buffer [3]; 
```

`buffer [0] << 24`给你你的第一个结果，它与独立于第一个结果的第二个结果相结合，依此类推。

此外，正如所指出的，应该对无符号数字进行这样的操作，以便签名不会干扰结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T18:53:37.727

对于所有按位运算，您将要使用 unsigned int 而不是 int。通过这种方式，您可以避免遇到的各种符号扩展问题。

# android - Android NDK 指针算法

> ID：11039508
> 
> 赞同：0
> 
> 时间：2012-06-14T18:50:42.547
> 
> 标签：android, pointers, textures, tga, android-ndk

我正在尝试在 Android NDK 中加载 TGA 文件。

我使用 AssetManager 打开文件，将 TGA 文件的全部内容读入内存缓冲区，然后尝试从中提取像素数据。

我可以毫无问题地读取文件的 TGA 标头部分，但是当我尝试将内存指针前进到 TGA 标头时，应用程序崩溃了。如果我不尝试推进内存指针，它不会崩溃。

Android NDK 对指针运算是否有某种限制？

这是代码：

此函数打开资产文件：

```
char* GEAndroid::OpenAssetFile( const char* pFileName )
{
char* pBuffer = NULL;

AAssetManager* assetManager = m_pState->activity->assetManager;
AAsset* assetFile = AAssetManager_open(assetManager, pFileName, AASSET_MODE_UNKNOWN);
if (!assetFile) {
    // Log error as 'error in opening the input file from apk'
    LOGD( "Error opening file %s", pFileName );
}
else
{
    LOGD( "File opened successfully %s", pFileName );
    const void* pData = AAsset_getBuffer(assetFile);
    off_t fileLength = AAsset_getLength(assetFile);
    LOGD("fileLength=%d", fileLength);

    pBuffer = new char[fileLength];
    memcpy( pBuffer, pData, fileLength * sizeof( char ) );
}

return pBuffer;
} 
```

在我的纹理类中，我尝试加载它：

```
char* pBuffer = g_pGEAndroid->OpenAssetFile( fileNameWithPath );

TGA_HEADER textureHeader;
char    *pImageData = NULL;
unsigned int bytesPerPixel = 4;

    textureHeader = *reinterpret_cast<TGA_HEADER*>(pBuffer);
    // I double check that the textureHeader is valid and it is.

    bytesPerPixel   = textureHeader.bits/8;             // Divide By 8 To Get The Bytes Per Pixel
    m_imageSize     = textureHeader.width*textureHeader.height*bytesPerPixel;   // Calculate The Memory Required For The TGA Data

    pImageData = new char[m_imageSize];
    // the line below causes the crash
    pImageData = reinterpret_cast<char*>(pBuffer + sizeof( TGA_HEADER)); // <-- causes a crash 
```

如果我用下面的行替换上面的行（即使它不正确），应用程序就会运行，尽管很明显纹理被弄乱了。

```
 pImageData = reinterpret_cast<char*>(pBuffer); // <-- does not crash, but obviously texture is messed up. 
```

有人有想法么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:48:10.570

Sigh, I just realized the mistake. I allocate memory for pImageData, then set the point to the buffer. This does not sit well when I try to create an OpenGL texture with the pixel data. Modifying it so I memcpy the pixel data from (pBuffer + sizeof( TGA_HEADER) ) to pImageData fixes the problem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:04:58.850

为什么要 reinterpret_cast？您正在向 char* 添加一个整数；该操作产生一个 char*。不需要类型转换。

在 Android（以及一般的 ARM 设备上）指针杂耍的一个警告：ARM 无法从内存中读取/写入未对齐的数据。如果你读/写一个 int 大小的变量，它的地址必须是 4 的倍数；简而言之，是 2 的倍数。字节可以位于任何地址。据我所知，这不适用于呈现的代码段。但请记住。它偶尔会抛出二进制格式解析，尤其是从英特尔 PC 移植时。

简单地将未对齐的值分配给指针不会崩溃。取消引用它可能。

# c# - 在 wpf 中将 Tile Overlays 添加到 bing 地图时闪烁？

> ID：11039509
> 
> 赞同：2
> 
> 时间：2012-06-14T18:50:46.887
> 
> 标签：c#, wpf, bing

我正在尝试使用天气中心将天气叠加层添加到 WPF 中的 bing 地图上。我已经在一个 Web 应用程序中完成了这项工作，我尝试使用类似的逻辑并且它有点工作，但似乎我有一个错误。每次有视图更改时，我基本上都会调用新的叠加层并清除旧的叠加层，使用 bing 拥有的 {quadkey} 系统和天气中心可以使用。这在 Web 应用程序中有效，并且有点工作，但瓷砖一直在闪烁。似乎瓷砖适用于不同的缩放级别，无法决定选择哪个？我不太确定。谢谢你的帮助。

```
public partial class MainWindow : Window
{
    Microsoft.Maps.MapControl.WPF.MapTileLayer tileLayer;

    private double tileOpacity = .7;

    public MainWindow()
    {
        InitializeComponent();
        MapTileOverlay.ViewChangeEnd += new EventHandler<Microsoft.Maps.MapControl.WPF.MapEventArgs>(MapTileOverlay_ViewChangeEnd);
    }

    void MapTileOverlay_ViewChangeEnd(object sender, Microsoft.Maps.MapControl.WPF.MapEventArgs e)
    {
        MapTileLayer.Children.Clear();

        tileLayer = new Microsoft.Maps.MapControl.WPF.MapTileLayer();

        Microsoft.Maps.MapControl.WPF.TileSource tileSource = new Microsoft.Maps.MapControl.WPF.TileSource("http://datacloud.wxc.com/?type=tile&bing={quadkey}&datatype=forecast&var=Clouds&time=now&vs=0.9&passkey=our_key");

        tileLayer.TileSource = tileSource;
        tileLayer.Opacity = tileOpacity;
        MapTileOverlay.Children.Add(tileLayer);
    } 
```

}

# java - 在java中执行git blame命令

> ID：11039517
> 
> 赞同：1
> 
> 时间：2012-06-14T18:51:24.263
> 
> 标签：java, linux, git, github

我正在尝试使用以下 Java 语法来执行 Git blame 命令：

```
Process process = Runtime.getRuntime().exec("/usr/bin/git blame https://github.com/git/git/alloc.c > TestGit.txt"); 
```

但是，当我在 Java 中运行代码时，它没有给出任何结果。而且，当我尝试在终端中执行它时，它只会创建一个空的“TestGit.txt”文件，并且出现错误：`fatal: Not a git repository (or any of the parent directories): .git`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:55:36.850

确保在启动命令之前将目录更改为 git 存储库

```
Process process = Runtime.getRuntime().exec("cd /path/to/repository; /usr/bin/git blame https://github.com/git/git/alloc.c > TestGit.txt"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T02:46:10.633

以下是在 Java for linux 中执行 blame 命令的正确语法：

```
git --git-dir=/home/gh/git/.git --work-tree=/home/gh/git blame builtin/tag.c 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:56:12.077

我认为`git blame`要工作，您需要*在*存储库中。您需要在存储库目录中（这意味着您需要先检查它），然后运行：

```
git blame alloc.c 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T18:49:31.760

哈维尔方式：

```
Process process = Runtime.getRuntime().exec("/usr/bin/git blame https://github.com/git/git/alloc.c > TestGit.txt", null, new File('/path/to/repository')); 
```

# ruby - 使用 Ruby 1.9.3 和邮件 gem 进行字符编码

> ID：11039522
> 
> 赞同：9
> 
> 时间：2012-06-14T18:51:47.803
> 
> 标签：ruby, email, utf-8, character-encoding

我正在尝试使用[Ruby 邮件 gem](https://github.com/mikel/mail)解析电子邮件字符串，而我在字符编码方面遇到了麻烦。采取以下电子邮件：

```
MIME-Version: 1.0
Sender: foobar@example.com
Received: by 10.142.239.17 with HTTP; Thu, 14 Jun 2012 06:00:18 -0700 (PDT)
Date: Thu, 14 Jun 2012 09:00:18 -0400
Delivered-To: foobar@gmail.com
X-Google-Sender-Auth: MxfFrMybNjBoBt4O4GwAn9cMsko
Message-ID: <CAGErOzF3FV5NvzN3zUpLGPok96SFzK18Z4HerzyYNALnzgMVaA@mail.gmail.com>
Subject: Re: [Lorem Ipsum] Foo updated the forum topic 'Reply by email test'
From: Foo Bar <foo@example.com>
To: Foo <c49964d167e08e7d4a1930e6565f23c258be19a0@foo.example.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

This email has accents:=A0R=E9sum=E9
>
> --------- Reply Above This Line ------------
>
> Email parsing with accents: R=E9sum=E9
>
> Click here to view this post in your browser 
```

正确编码后的电子邮件正文应为：

```
This reply has accents: Résumé
>
> --------- Reply Above This Line ------------
>
> Email parsing with accents: Résumé
>
> Click here to view this post in your browser 
```

然而，我有一个魔鬼的时间实际上得到了重音标记。这是我尝试过的：

```
message = Mail.new(email_string)
body = message.body.decoded 
```

这给了我一个这样开头的字符串：

```
This reply has accents:\xA0R\xE9sum\xE9\r\n>\r\n> --------- Reply Above This Line ------------ 
```

最后，我试试这个：

```
body.encoding # => <Encoding:ASCII-8BIT>
body.encode("UTF-8") # => Encoding::UndefinedConversionError: "\xA0" from ASCII-8BIT to UTF-8 
```

有人对如何处理这个问题有任何建议吗？我很确定这与电子邮件中的“charset=ISO-8859-1”设置有关，但我不确定如何使用它，或者是否有办法使用邮件 gem 轻松提取它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-14T18:54:31.593

玩了一会儿，我发现了这个：

```
body.decoded.force_encoding("ISO-8859-1").encode("UTF-8") # => "This reply has accents: Résumé..."
message.parts.map { |part| part.decoded.force_encoding("ISO-8859-1").encode(part.charset) } # multi-part 
```

您可以像这样从消息中提取字符集。

```
message.charset #=> for simple, non-multipart
message.parts.map { |part| part.charset } #=> for multipart, each part can have its own charset 
```

小心非多部分，因为以下可能会导致麻烦：

```
body.charset #=> returns "US-ASCII" which is WRONG!
body.force_encoding(body.charset).encode("UTF-8") #=> Conversion error...

body.force_encoding(message.charset).encode("UTF-8") #=> Correct conversion :) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T08:36:48.093

这对我不起作用，所以我想我会坚持我得到的解决方案，以防它帮助任何人......

基本上必须添加编码默认值并将输出调整为合理的字符串。 [https://stackoverflow.com/a/26604049/2386548](https://stackoverflow.com/a/26604049/2386548)

# ios - 使用分发条款辞职应用程序

> ID：11039523
> 
> 赞同：0
> 
> 时间：2012-06-14T18:51:50.253
> 
> 标签：ios, jenkins

目前，我的笔记本电脑上有一个分发配置设置，可以在编译后分发企业应用程序，但是我也想将此过程引入 Jenkins。

我这样做的一个担忧是：

1) 我是否需要另一台计算机的新证书并完成为该 PC 创建配置文件的整个过程，或者我可以使用当前配置并在不同计算机上使用应用程序对其进行签名？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:12:52.437

您必须从钥匙串中导出您的证书并将其安装在您希望构建的 PC 上。右键单击开发或分发证书 -> 导出并选择 .p12，然后选择密码（如果需要）。然后，您可以将其安装在您的 jenkins 机器上，它为该机器提供与您最初制作证书的基本计算机相同的签名权限，并将您的配置文件也放在那里。希望有帮助。

# c# - C# DataGridView 更新只读列值

> ID：11039524
> 
> 赞同：-1
> 
> 时间：2012-06-14T18:51:53.283
> 
> 标签：c#, .net, winforms

我有一个 datagridview，它从 db 加载信息。但是，在运行时，我想允许用户更新一个单元格（默认情况下是只读的）但我不能这样做，我需要这样做，因为所有更改都保存在 db 中但是如果我重新加载它它，一些颜色样式等将消失，因此我只想根据请求从 db 重新加载并更改只读 col 的文本，请指导。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T20:24:24.327

这是 `Question`用户的实际情况

我在 datagridview 中有一个列，默认情况下（`I dont set it readonly anywhere in code`）是只读的。它来自一个`dataset which gets data from a stored procedure`，这个特定的字段是一个计算出来的，`so there is no column in the table for it`。我可以操作表中的所有其他字段，`except for this one`. 我需要（仅用于在 datagridview 中显示）在运行时更改此列值，这会导致只读错误

这是`Answer`解决用户问题的方法。

从数据集中读取数据后，它表示只读的列，尝试这样做 -`ds.Tables[0].Columns["Your New Column"].ReadOnly = false;`

`Read the comments below for more clarity please.`

**忽略下面的答案和代码，因为用户的实际问题在我上面写的下面的评论中。用户应该修改他的问题。它完全错误和误导**

添加一个 Winforms 项目，删除一个 DataGridView 和一个按钮。将单击处理程序添加到按钮。

在 DataGridView 中添加一列，并`DataProperty`在设计器中将该列命名为“名称”。将其标记为`Read-Only`。列 DataPropertyName 必须与数据库中的字段匹配。`I have a class called Books with a Property called Name`. `Name`因此在这种情况下应该调用它。

复制粘贴下面的代码，然后按 F5。

`Click the Button to update the read-only column value.`

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            List<Book> books = new List<Book>();
            books.Add(new Book() { Name = "C#" });

            InitializeComponent();

            dataGridView1.AutoGenerateColumns = false;
            dataGridView1.DataSource = books;
            dataGridView1.Refresh();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            dataGridView1[0,0].Value = "Winforms";
        }
   }

    public class Book
    {
        public string Name { get; set; }
    }
} 
```

**DataGridView 设计器代码供参考：-**

```
// 
            // dataGridView1
            // 
            this.dataGridView1.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.dataGridView1.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
            this.Column1});
            this.dataGridView1.Location = new System.Drawing.Point(42, 91);
            this.dataGridView1.Name = "dataGridView1";
            this.dataGridView1.Size = new System.Drawing.Size(270, 157);
            this.dataGridView1.TabIndex = 1;
            // 
            // Column1
            // 
            this.Column1.DataPropertyName = "Name";
            this.Column1.HeaderText = "Name";
            this.Column1.Name = "Column1";
            this.Column1.ReadOnly = true; 
```

# c#-4.0 - C# 解决方案中的多用户数据污染

> ID：11039529
> 
> 赞同：0
> 
> 时间：2012-06-14T18:52:10.160
> 
> 标签：c#-4.0, session-state

我有这个 Web Developer 应用程序，它将列表数据发送到另一组 .aspx/aspx.cs 文件，如下所示：

```
 Session.Add("Selected-List-Details", Selected-List-Details);
                Server.Transfer("new-file-name.aspx"); 
```

然而，问题是，如果多个用户同时尝试做某事，则数据会在两个会话之间交叉污染。

有一个更好的方法吗？有简单的解决方法吗？我是否忽略了有用的会话功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:18:53.463

[http://msdn.microsoft.com/en-us/library/ms525800(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/ms525800(v=vs.90).aspx)。似乎显示了如何使用您的 server.transfer 发送会话 ID

# c++ - ifstream.read() 如果读取少于可用，则设置失败位

> ID：11039530
> 
> 赞同：0
> 
> 时间：2012-06-14T18:52:11.413
> 
> 标签：c++, std

```
std::ifstream sr(path.c_str());
if (!sr)
    throw runtime_error("Could not open file '"+path+"\'");

sr.seekg(0, ios::end);
streampos lastPos = sr.tellg(); //returns 3161125
unsigned dataSize = (int)lastPos - 100; //dataSize becomes 3161025

char* data = (char*)malloc(dataSize);
if (!data)
    throw runtime_error("Out of memory whean allocating read buffer");
sr.clear();
sr.seekg(0, ios::beg);
sr.read(data, dataSize);  //sr.read(data, 3110000) works!
if(sr.fail()) //fails 
```

此代码失败，但如果我读取 3110000 字节，则`read()`成功并且`fail()`是`false`. 我可以像这样通过流迭代器加载文件：

```
string data(std::istreambuf_iterator<char>(sr),
            std::istreambuf_iterator<char>()); 
```

知道为什么`read()`会失败吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T19:00:54.633

只有当文件以二进制模式打开时， `seekg()`+返回的值才是可靠的。`tellg()`在文本模式下，行尾会被翻译，根据操作系统存储文件的方式，结果会有所不同。

具体来说，在 Windows 上，CR+LF 对被转换为单个字符`'\n'`。

# java - 非 servlet 从 web.xml 获取属性

> ID：11039532
> 
> 赞同：0
> 
> 时间：2012-06-14T18:52:32.313
> 
> 标签：java, tomcat, servlets

从 web.xml 获取属性值的非 servlet java 类有什么缺点吗？

网上的例子不多；我想知道这是否是一条可取的道路？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:58:04.510

这只是一个不必要的依赖。从类路径中的属性文件中获取属性值更容易，并且不需要在 servlet 容器中运行代码。

从 web.xml 读取属性将要求您的类访问 a `ServletConfig`，因此您的类都将依赖于 servlet。使用属性文件会好很多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:05:56.533

非 servlet 类查找 web.xml 中已经定义的内容的一种模式是通过使用 JNDI 属性（例如，一些共享/集群级别的属性定义这是否是开发/测试/生产环境）。

用例更细化，与属性文件中定义的用例不同。对于绝大多数用例，从属性文件中查找就足够了。

# eclipse - eclipse ide中的重复编辑

> ID：11039535
> 
> 赞同：0
> 
> 时间：2012-06-14T18:52:37.697
> 
> 标签：eclipse, ide

我的 eclipse ide 很奇怪：即使在我修改后它也会抱怨一些源错误，我必须切断整个编译单元并再次粘贴回来。并且，我在截断一个源文件的时候，还要截两次：ctrl-A、ctrl-X（内容还在）、ctrl-A、ctrl-X、ctrl-V。这个问题发生在我的两个 linux 机器上。

我应该怎么做才能修复它？

**补充**

eclipse 版本：Indigo Service Release 2。

我的盒子：debian 挤压。

.类路径：

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" output="class" path="source"/>
    <classpathentry kind="var" path="JRE_LIB" sourcepath="JRE_SRC"/>
    <classpathentry kind="con" path="/home/foo/big/build/class"/>
    <classpathentry kind="con" path="/home/foo/big/test/class"/>
    <classpathentry kind="lib" path="/home/foo/big/build/jar/big.jar"/>
    <classpathentry kind="lib" path="/home/foo/big/library/testng-6.3.jar"/>
    <classpathentry kind="output" path="bin"/>
</classpath> 
```

。项目：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>big</name>
    <comment></comment>
    <projects>
    </projects>
    <buildSpec>
        <buildCommand>
            <name>org.eclipse.jdt.core.javabuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
    </buildSpec>
    <natures>
        <nature>org.eclipse.jdt.core.javanature</nature>
    </natures>
    <linkedResources>
        <link>
            <name>class</name>
            <type>2</type>
            <location>/home/foo/big/build/class</location>
        </link>
        <link>
            <name>source</name>
            <type>2</type>
            <location>/home/foo/big/source</location>
        </link>
    </linkedResources>
</projectDescription> 
```

# javascript - 外部 Div 内的动画

> ID：11039540
> 
> 赞同：0
> 
> 时间：2012-06-14T18:52:47.570
> 
> 标签：javascript, jquery, animation

我在 div 中有旧文本。
我希望该文本向左飞出，而新文本从右侧飞入。

问题：
我不希望新文本从浏览器窗口中飞入，
而是从包含的 div 中飞入。

[http://jsfiddle.net/cabezud/XuyUb/1/](http://jsfiddle.net/cabezud/XuyUb/1/)

仅供参考，我正在使用 Jquery & jquery mobile。我在这里找到了另一个问题： [Jquery-animate question: how to constrain a DIV animation inside another DIV?](https://stackoverflow.com/questions/4533571/jquery-animate-question-how-to-constrain-a-div-animation-within-another-div) 但只需将外部 div 设置为 position:relative 不会改变任何内容。

根据评论，添加更多细节（而不仅仅是指向 jsfiddle 的链接）。

```
<div class="outer">
<p class="inner">click me</p>
</div> 
```

​ var fruit = ['apples', 'bananas', 'oranges', 'kiwis']; 变量数 = 0;

```
$('.outer').click(function(){
    next();
});

var next = function() {
num++;
$('.inner').animate({"right":"500%"},500, function() {
    $('.inner').text(fruit[num]).css({"right":"-500%"});
    $('.inner').animate({"right":"0%"},500);
});
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:55:15.777

添加`overflow:hidden;`到 .outer div

**[jsFiddle 示例](http://jsfiddle.net/j08691/XuyUb/2/)**。

# vim - 如何在 Vim 中展开文本？

> ID：11039544
> 
> 赞同：36
> 
> 时间：2012-06-14T18:53:09.160
> 
> 标签：vim

我通常在`tw=80`编辑文件时设置选项，尤其是 LaTeX 源。但是，比如说，我想在 Vim 中使用该`tw=80`选项撰写一封电子邮件，然后将其复制并粘贴到 Web 浏览器中。在我复制和粘贴之前，我想解开文本，这样每 80 个字符左右就没有换行符。我已经尝试过 `tw=0`then  `gq`，但这只是将文本包装为 80 个字符的默认宽度。我的问题是：如何解开文本，使我的电子邮件的每一段都显示为一行？有一个简单的命令吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-06-14T19:15:09.423

转到段落的开头并输入：

`v` `i` `p` `J`

（如果`J`不清楚，则为大写字母）

对于整个文档，将其与规范结合起来：

```
:%norm vipJ 
```

此命令只会打开段落。我想这是你想要的行为。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-15T05:26:37.287

由于使用普通模式命令连接段落行已经被另一个答案所涵盖，让我们考虑通过面向行的 Ex 命令来解决相同的问题。

假设光标位于段落的第一行。然后，要打开它，可以简单地将以下几行连接起来，直到该段落的最后一行。一种方便的方法是运行`:join`专门为此目的设计的命令。要定义命令操作的行范围，除了明显的起始行即当前行外，还需要指定结束行。可以使用匹配段落末尾的模式找到它，即一行中的两个换行符，或者等效地，一个换行符后跟一个空行。因此，将上述定义翻译成 Ex-command 语法，我们得到：

```
:,-/\n$/j 
```

对于要展开的所有段落，请在每个段落的第一行运行此命令。一个有用的工具来跳过它们，重复给定的动作序列，是`:global`命令（或`:g`简称）。当`:global`从上到下扫描行时，下一段的第一行只是那些未处理的行中的第一个非空行。这个观察给了我们命令

```
:g/./,-/\n$/j 
```

这比直接的普通模式对应物更有效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-04-12T17:59:37.893

问题`:%norm vipJ`在于，如果您的连续行少于 80 个字符，即使它们被空行分隔，它也会加入它们。例如下面的例子：

```
# Title 1

## Title 2 
```

会变成：

```
# Title 1 ## Title 2 
```

有了 ib 的回答，问题出在列表上：

```
- item1
- item2 
```

变成：

```
- item1 - item2 
```

多亏了[这个论坛帖子](http://vim.1045645.n5.nabble.com/Does-automated-quot-line-unwrap-quot-exist-td1157525.html)，我发现了另一种实现这一目标的方法，我将它封装在一个对我来说效果更好的函数中，因为它没有做任何事情：

```
function! SoftWrap()
    let s:old_fo = &formatoptions
    let s:old_tw = &textwidth
    set fo=
    set tw=999999 " works for paragraphs up to 12k lines
    normal gggqG
    let &fo = s:old_fo
    let &tw = s:old_tw
endfunction 
```

编辑：更新了方法，因为我意识到它不适用于 Linux 设置。删除包含`fo`此较新版本是否不适用于 MacVim 的行（我无法测试）。

# c# - 从 javascript 调用 ASP 函数

> ID：11039545
> 
> 赞同：1
> 
> 时间：2012-06-14T18:53:12.097
> 
> 标签：c#, asp.net, vb.net

你好我有这个问题我试图找到一种从asp控制器调用javascript函数的方法，我在这里做的是代码：

```
 <script type="text/javascript">
      function hello() { 
        alert("hello world")
    }
</script>
<  /head>
 <body>
<form id="form1" runat="server">
<div>
    <asp:Button ID="buttonme" runat="server" OnClientClick="javascript:hello()" 
 Text="click" /> 
```

现在可以说我有这个代码背后的功能

```
 Public Sub msg()
      MsgBox("hello world")
    End Sub 
```

我想从一个javascript函数中调用它，所以它就像控制器----调用---> javascript ---调用--->后面的代码

有没有办法做到这一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:03:10.467

在 Web 应用程序的某个类中定义您的方法。

```
[System.Web.Services.WebMethod]
public static string Msg()
{
     return "Hello world";
} 
```

在您的 aspx 页面中添加一个具有 EnablePageMethods=true 的脚本管理器

```
<asp:ScriptManager ID="someId" runat="server" EnablePageMethods="true">
</asp:ScriptManager> 
```

在javascript中调用方法

```
<script language="javascript" type="text/javascript">
    PageMethods.Msg(onSuccess);
    function onSuccess(response)
    {
        alert(response);
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:57:14.460

您必须以某种形式使用 AJAX，并公开您想通过 HTTP 调用的 ASP.NET 方法。

# android - Android：以编程方式更改选中/未选中的 CheckBoxPreference 图标

> ID：11039550
> 
> 赞同：0
> 
> 时间：2012-06-14T18:53:47.387
> 
> 标签：android, image, checkbox, icons, checkboxpreference

我有一些 CheckBoxPreferences 并且我通过 xml 更改它们的图标没有问题，如下所示和[这里](https://stackoverflow.com/questions/3192173/change-icons-of-checked-and-unchecked-for-checkbox-for-android)但是由于用户有其他方式来触发复选框的操作而不是直接单击它（即可能在另一个活动甚至另一个应用程序中）我希望能够根据与操作一起发生的值更改以编程方式设置图标。例如，如果蓝牙打开，我希望图标是一个图像，而当蓝牙关闭时，我希望它是另一个图像。是否可以以编程方式更改此图像？

```
<CheckBox xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+android:id/checkbox"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:button="@drawable/check_box_icon"
android:clickable="true"
android:focusable="false"
android:/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:44:44.487

找到了解决方案：

我使用在问题中提供的链接中找到的方法设置选择器，以便我可以根据复选框的当前状态将其与我的所有 CheckBoxPreferences 一起用于不同图像：-

```
<?xml version="1.0" encoding="utf-8"?>
//This is the xml selector "@drawable/checkbox"
<selector xmlns:android="http://schemas.android.com/apk/res/android">
 <item android:state_checked="false"
  android:drawable="@drawable/checkbox_off_background" />
 <item android:state_checked="true"
  android:drawable="@drawable/checkbox_on_background" />
</selector> 
```

因此，CheckBoxPreference 代码也发生了变化：-

```
<CheckBox android:layout_width="wrap_content"
android:layout_height="wrap_content" 
android:text="new checkbox"
android:button="@drawable/checkbox"
android:clickable="true"
android:focusable="false" /> 
```

现在，我可以调用**Checkbox.setChecked()**来检查它是否已启用，也可以通过将其设置为 true 或 false 来根据值进行更改。因此，根据 xml 属性，这也会自动更改图标。

# database - SQL Server 字段被截断

> ID：11039552
> 
> 赞同：10
> 
> 时间：2012-06-14T18:53:56.603
> 
> 标签：database, sql-server-2008, hibernate, varcharmax

好的，我正在使用 SQL Server 2008 并且有一个类型为 的表字段`VARCHAR(MAX)`。问题是使用 保存信息时`Hibernate`，`VARCHAR(MAX)`字段的内容被截断。我在应用服务器或数据库服务器上都没有看到任何错误消息。

该字段的内容只是一个纯文本文件。此文本文件的大小为 383KB。

到目前为止，这是我为解决此问题所做的工作：

1.  将数据库字段从`VARCHAR(MAX)`TEXT 更改为相同的问题。

2.  使用 SQL Server Profiler，我注意到数据库服务器正在接收全文内容
    ，但由于某种原因，在尝试查看具有截断问题的 SQL 时，分析器会冻结。就像我说的，就在它冻结之前，我
    确实注意到正在接收全文文件内容（383KB），所以看起来可能是数据库问题。

有没有人遇到过这个问题？任何想法是什么导致这种截断？

注意：只想提一下，我只是进入 SQL Studio，只是复制 TEXT 字段内容并将其粘贴到 Textpad。这就是我注意到它被截断的方式。

提前致谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-14T20:32:44.597

您的问题是您认为 Management Studio 将向您展示所有数据。它没有。转到工具 > 选项 > 查询结果 > SQL Server。如果您使用结果到网格，请将“检索到的最大字符数”更改为“非 XML 数据”（请注意，结果到网格将消除任何 CR/LF）。如果您使用“结果转文本”，请更改“每列中显示的最大字符数”。

![在此处输入图像描述](../Images/26d50762a6d9c71ebec2ba3d355bb8a0.png)

您可能想输入更多，但您可以在 Management Studio 中返回的最大值为：

```
65535 for Results to Grid
8192  for Results to Text 
```

如果您真的想查看 Management Studio 中的所有数据，可以尝试将其转换为 XML，但这也有问题。首先将 Results To Grid > XML data 设置为 5 MB 或无限制，然后执行以下操作：

```
SELECT CONVERT(XML, column) FROM dbo.table WHERE... 
```

现在这将产生一个网格结果，其中链接实际上是可点击的。这将打开一个新的编辑器窗口（它不是查询窗口，因此不会有执行按钮、IntelliSense 等），您的数据将转换为 XML。这意味着它将替换`>`为`&gt;`etc。这是一个简单的示例：

```
SELECT CONVERT(XML, 'bob > sally'); 
```

结果：

![在此处输入图像描述](../Images/56406711694c3eaba9069cab058d0668.png)

当您单击网格时，您会看到这个新窗口：

![在此处输入图像描述](../Images/01fdfbc36cfde1df43da96881a850d12.png)

（它确实有 IntelliSense，验证 XML 格式，这就是你看到波浪线的原因。）

**回到牧场**

如果您只想进行完整性检查并且不想将所有 383K 复制到其他地方，那就不要！只需检查使用：

```
SELECT DATALENGTH(column) FROM dbo.table WHERE... 
```

这应该表明您的数据已被数据库捕获，问题在于工具和您的验证方法。

（我已经[在这里写了一个关于这个的提示](http://www.mssqltips.com/sqlservertip/3185/validate-the-contents-of-large-dynamic-sql-strings-in-sql-server/?utm_source=AaronBertrand)。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-30T04:04:00.693

尝试使用 `SELECT * FROM dbo.table for XML PATH`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-06T00:02:30.890

我也有类似的情况。我有一张excel表格。工作表中的几列可能有超过 255 个字符，有时甚至 500 个。一种简单的方法是对数据行进行排序，将具有最多字符的行放在顶部。你实际上只需要一排。当 SQL 导入数据时，它会识别超过 255 个字符的字段并导入整个数据 :)

否则，他们建议使用 regedit 更改特定值。不想那样做。

希望这可以帮助

# windows - 在 Windows 下通过 Emacs/Anything 使用 Everything 搜索

> ID：11039556
> 
> 赞同：0
> 
> 时间：2012-06-14T18:54:10.720
> 
> 标签：windows, search, emacs

所以我开始在 Emacs 中使用任何东西。您可以对任何东西使用“定位”，但也可以使用 VoidTools 的“一切”（这实际上是“Windows-NT”系统的默认设置。

这需要一点点刺激，但我有命令行一切都在我的系统上工作。在使用anything-locate 或anything-for-files 时，我会从中得到结果。

一切正常，除了我在 es 返回给我的行的末尾得到了可怕的 ^M (control-M)。这意味着当我使用任何东西打开文件时，它都不起作用。

任何人都对如何修复 es 返回的值有任何帮助，或者在尝试打开文件之前剥离 ^M ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:41:18.297

啊哈，最后还是我的错。

在搞乱 process-coding-system-alist 时要小心，并确保它是真正需要做的事情。我过去修改了这个：

```
(setq process-coding-system-alist (cons '("bash" . (raw-text-unix . raw-text-dos)) 
                                 process-coding-system-alist)) 
```

我不再需要这样做了。这意味着从 Everything 传递的文件被解释为 Unix 风格，并且 CR/^M 出现了。通过注释掉这一行，我解决了我自己的问题。

# linux - rsync - mkstemp 失败：权限被拒绝 (13)

> ID：11039559
> 
> 赞同：68
> 
> 时间：2012-06-14T18:54:26.883
> 
> 标签：linux, permissions, rsync

我有以下设置来定期将文件从服务器 A rsync 到服务器 B。服务器 B 具有运行以下配置的 rsync 守护程序：

```
read only = false
use chroot = false
max connections = 4
syslog facility = local5
log file = /var/adm/rsyncd.log
munge symlinks = false
secrets file = /etc/rsyncd.secrets
numeric ids = false
transfer logging = true
log format = %h %o %f %l %b

[BACKUP]
        path = /path/to/archive
        auth users = someuser 
```

从服务器 AI 发出以下命令：

```
rsync -adzPvO --delete --password-file=/path/to/pwd/file/pwd.dat /dir/to/be/backedup/ someuser@192.168.100.100::BACKUP 
```

BACKUP 目录对每个人都是完全读/写/执行的。当我从服务器 A 运行 rsync 命令时，我看到：

```
afile.txt
         989 100%    2.60kB/s    0:00:00 (xfer#78, to-check=0/79) 
```

对于我希望备份的目录中的每个文件。当我开始编写 tmp 文件时它失败了：

```
rsync: mkstemp "/.afile.txt.PZQvTe" (in BACKUP) failed: Permission denied (13) 
```

经过数小时的谷歌搜索，我仍然无法解决看似非常简单的权限问题。建议？提前致谢。

**附加信息**

我刚刚注意到在过程开始时发生了以下情况：

```
rsync: failed to set permissions on "/." (in BACKUP): Permission denied (13) 
```

它是否试图在“/”上设置权限？

**编辑**

我以用户身份登录 - someuser。我的目标目录对每个人都有完全的读/写/执行权限，包括它的内容。此外，目标目录归 someuser 和 someuser 组所有。

**跟进**

我发现使用 SSH 可以解决这个问题

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-14T20:52:53.317

确保您在远程计算机上进行 rsync 的用户具有对文件夹内容和文件夹本身的写入权限，因为 rsync 试图更新文件夹本身的修改时间。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-10-18T13:55:30.767

即使你得到了这个工作，我最近也遇到了类似的遭遇，没有 SO 或谷歌搜索有任何帮助，因为它们都处理基本的权限问题，而下面的解决方案有点偏离设置，你甚至不会想到检查在大多数情况下。

需要通过权限检查的一件事是，我最近发现自己的 rsync 存在问题，其中包括所有者和组在内的两台服务器上的权限完全相同，但 rsync 传输在一台服务器上以一种方式工作，但不是另一种方式。

事实证明，服务器存在问题，即我在启用 SELinux 的情况下被拒绝权限，这反过来又覆盖了文件/文件夹的 POSIX 权限。因此，即使有问题的文件夹在 root 运行时可能是 777，但 SELinux 命令已启用，并且反过来会覆盖那些从 rsync 产生“权限被拒绝”错误的权限。

您可以运行该命令`getenforce`来查看机器上是否启用了 SELinux。

在我的情况下，我最终只是完全禁用了 SELINUX，因为它不需要并且已经在运行良好的服务器上被禁用并且只是导致启用问题。要禁用，打开`/etc/selinux/config`并设置`SELINUX=disabled`. 要暂时禁用，您可以运行`setenforce 0`将 SELinux 设置为`permissive`状态而不是`enforcing`状态的命令，该状态会导致它打印警告而不是强制执行。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-08-14T08:44:08.917

如果 Rsync 守护程序在 root 用户下运行，则默认情况下它对所有模块使用nobody/nogroup。所以你要么需要定义参数`uid`和`gid`你想要的用户，要么将它们设置为 root/root。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-06-30T04:06:05.243

我遇到了同样的问题并由`chown`目标文件夹的用户解决。当前用户没有读取、写入和执行目标文件夹文件的权限。尝试通过添加权限`chmod a+rwx <folder/file name>`。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-01-19T10:54:06.733

这可能不适合所有人，因为它不保留原始文件权限，但在我的情况下它并不重要，它为我解决了问题。rsync 有一个选项`--chmod`：

> **--chmod**此选项告诉 rsync 将一个或多个逗号分隔的 lqchmodrq 字符串应用于传输中文件的权限。结果值被视为发送方为文件提供的权限，这意味着如果未启用 --perms，此选项似乎对现有文件没有影响。

这会强制将所有文件/目录的权限设置为您想要的。例如：

```
rsync -av --chmod=Du+rwx SRC DST 
```

将为用户添加读取、写入和执行到所有传输的目录。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-09-02T22:37:58.380

I had a similar issue, but in my case it was because storage has only SFTP, without ssh or rsync daemons on it. I could not change anything, bcs this server was provided by my customer.

rsync could not change the date and time for the file, some other utilites (like csync) showed me other errors: "Unable to create temporary file Clock skew detected". If you have access to the storage-server - just install openssh-server or launch rsync as a daemon here.

In my case - I could not do this and solution was: **lftp**. lftp's usage for syncronization is below:

```
lftp -c "open -u login,password sftp://sft.domain.tld/; mirror -c --verbose=9 -e -R -L /srs/folder /rem/folder" 
```

/src/folder - is the folder on my PC, /rem/folder - is sftp://sft.domain.tld/rem/folder.

you may find mans by the link lftp.yar.ru/lftp-man.html

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-03-26T22:24:01.793

Windows：检查目标文件夹的权限。如果您必须向运行 rsync 服务的帐户授予权限，请取得所有权。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-03-06T09:38:57.090

在 CentOS 7 的情况下，我遇到了同样的问题。我浏览了很多文章、论坛，但找不到解决方案。问题出在 SElinux 上。在服务器端禁用 SElinux 有效。检查服务器端的 SELinux 状态（使用 rysnc 从那里提取数据） 检查 SELinux 状态并禁用它的命令

$getenforce

强制执行 ## 这意味着 SElinux 已启用

$setenforce 0

$getenforce

宽容的

现在尝试在客户端运行 rsync 命令，它对我有用。一切顺利！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-09-07T19:37:06.610

我遇到了同样的问题，所以我首先通过 SSH 连接到服务器，以确认我能够使用以下命令登录到服务器：

```
ssh -i /Users/Desktop/mypemfile.pem user@ec2.compute-1.amazonaws.com 
```

然后在***新航站楼***

我使用 SCP 将一个小文件复制到服务器，以确保能够建立连接：

```
scp -i /Users/Desktop/mypemfile.pem /Users/Desktop/test.file user@ec2.compute-1.amazonaws.com:/home/user/test/ 
```

然后在同一个新终端中，我尝试运行 rsync：

```
rsync -avz -e "ssh -i /Users/Desktop/mypemfile.pem" /Users/Desktop/backup/image.img.gz user@ec2.compute-1.amazonaws.com: 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-08-05T11:27:29.733

我有带有 rsyncd 的 Centos 7 服务器：/etc/rsyncd.conf

```
[files]
path = /files 
```

默认情况下，selinux 阻止 rsyncd 访问 /files 文件夹

```
# this sets needed context to my /files folder
sudo semanage fcontext -a -t rsync_data_t '/files(/.*)?'
sudo restorecon -Rv '/files'
# sets needed booleans
sudo setsebool -P rsync_client 1 
```

禁用 selinux 是一个简单但不是好的解决方案

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-01-04T20:41:32.343

如果您使用的是 Raspberry pi 或其他 Unix 系统，`sudo`则需要告诉远程机器`rsync`和`sudo`程序的位置。

为了安全起见，我输入了完整的路径。

这是我的例子：

```
rsync --stats -paogtrh --progress --omit-dir-times --delete --rsync-path='/usr/bin/sudo /usr/bin/rsync'  /mnt/drive0/ pi@192.168.10.238:/mnt/drive0/ 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-10-17T08:44:24.263

`/media/drivename`我想上面目前没有提到的一个常见错误是在未安装分区时尝试写入安装空间（例如， ）。这也会产生这个错误。

如果它是设置为自动挂载但没有自动挂载的加密驱动器，则可能是在尝试写入应该挂载的空间之前自动解锁加密分区的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-08-11T10:04:05.373

目标目录和子目录的组用户名应与每个用户相同。

如果用户是“abc”，那么目标目录应该是 lrwxrwxrwx 1 abc abc 34 Jul 18 14:05 Destination_directory

命令 chown abc:abc Destination_directory

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-12-29T04:46:55.127

还有另一种获得这种症状的方法：我正在通过 ssh 从远程机器同步到具有 NTFS-3G (FUSE) 文件系统的 Linux 机器。最初文件系统是在启动时挂载的，因此归根用户所有，当我从远程机器执行 rsync 推送时，我收到了这个错误消息。然后，作为推送 rsync 的用户，我做了：

```
$ sudo umount /shared
$ mount /shared 
```

并且错误消息消失了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-04-19T06:02:40.747

我在 Docker 容器内同步文件时遇到了同样的错误，并且目标是已安装的卷（Docker for mac），我`rsync`通过`su-exec <user>`. 我能够通过使用标志运行`rsync`来解决它（保留目标文件的所有者和组）。`root``-og`

我仍然不确定是什么导致了这个问题，目标权限还可以（我`chown -R <user>`之前为目标目录运行过`rsync`），可能与 Docker for Mac 慢速文件系统有关。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-04-01T16:26:48.677

注意**-e ssh**和**jenkins@localhost：**在下一个示例中：

```
rsync -r  -e ssh --chown=jenkins:admin --exclude .git --exclude Jenkinsfile --delete ./ jenkins@localhost:/home/admin/web/xxx/public 
```

这对我有帮助

**PS**今天，我意识到当您将 jenkins 用户更改（添加）到某个组时，从属（代理）重新启动后将应用权限。而我的解决方案（**-e ssh**和**jenkins@localhost:**）仅在您无法重新启动代理/服务器时才需要。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2019-09-01T01:08:00.247

令人惊讶的是，没有人提到所有强大的 SUDO。有同样的问题并 sudo 修复了它

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2014-11-04T08:51:10.027

在 root 访问 ssh 中运行应该可以解决这个问题

或者`chmod 0777 /dir/to/be/backedup/`

或者`chown username:user /dir/to/be/backedup/`

# java - 当使用 HBase 作为 MapReduce 的源时，我可以扩展 TableInputFormatBase 来为每个区域创建多个拆分和多个映射器吗？

> ID：11039562
> 
> 赞同：9
> 
> 时间：2012-06-14T18:54:35.403
> 
> 标签：java, performance, hadoop, mapreduce, hbase

我正在考虑使用 HBase 作为我的 MapReduce 作业之一的来源。我知道 TableInputFormat 为每个区域指定一个输入拆分（因此是一个映射器）。但是，这似乎效率低下。我真的很想让多个映射器同时在一个给定的区域上工作。我可以通过扩展 TableInputFormatBase 来实现这一点吗？你能给我举个例子吗？此外，这甚至是一个好主意吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:55:20.583

您需要一个扩展 InputFormat 的自定义输入格式。您可以从回答到[我想扫描大量数据（基于范围的查询）的问题中了解如何做到这一点，在写入数据时我可以做哪些优化，以便扫描变得更快](https://stackoverflow.com/questions/8427348/i-want-to-scan-lots-of-data-range-based-queries-what-all-optimizations-i-can/9080637#9080637)。如果数据处理时间比数据检索时间长，这是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T05:05:44.473

不确定是否可以为给定区域指定多个映射器，但请考虑以下事项：

如果您认为每个区域使用一个映射器效率低下（可能您的数据节点没有像 #cpus 这样的足够资源），您或许可以在文件 hbase-site.xml 中指定较小的区域大小。

如果您想考虑更改默认配置选项，这里是一个站点：http: [//hbase.apache.org/configuration.html#hbase_default_configurations](http://hbase.apache.org/configuration.html#hbase_default_configurations)

请注意，通过缩小区域大小，您将增加 DFS 中的文件数量，这可能会根据您的 namenode 的内存限制 hadoop DFS 的容量。请记住，namenode 的内存使用与 DFS 中的文件数量直接相关。这可能与您的情况相关，也可能不相关，因为我不知道您的集群是如何使用的。这些问题从来没有灵丹妙药的答案！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-28T18:16:45.443

1\. 只需确保映射器之间的键集是互斥的，就可以了。

2.  您没有创建太多客户端，因为这可能会导致大量 gc，因为在 hbase 读取期间会发生 hbase 块缓存搅动

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-08T08:51:03.200

使用此 MultipleScanTableInputFormat，您可以使用 MultipleScanTableInputFormat.PARTITIONS_PER_REGION_SERVER 配置来控制应针对单个区域服务器执行的映射器数量。该类将按其位置（区域服务器）对所有输入拆分进行分组，并且 RecordReader 将正确地遍历映射器的所有聚合拆分。

这是示例

[https://gist.github.com/bbeaudreault/9788499#file-multiplescantableinputformat-java-L90](https://gist.github.com/bbeaudreault/9788499#file-multiplescantableinputformat-java-L90)

您为单个映射器创建了多个聚合拆分的工作

```
private List<InputSplit> getAggregatedSplits(JobContext context) throws IOException {
final List<InputSplit> aggregatedSplits = new ArrayList<InputSplit>();

final Scan scan = getScan();

for (int i = 0; i < startRows.size(); i++) {
  scan.setStartRow(startRows.get(i));
  scan.setStopRow(stopRows.get(i));

  setScan(scan);

  aggregatedSplits.addAll(super.getSplits(context));
}

// set the state back to where it was.. 
scan.setStopRow(null);
scan.setStartRow(null);

setScan(scan);

return aggregatedSplits;
 } 
```

按区域服务器创建分区

```
 @Override
 public List<InputSplit> getSplits(JobContext context) throws IOException {
List<InputSplit> source = getAggregatedSplits(context);

if (!partitionByRegionServer) {
  return source;
}

// Partition by regionserver
Multimap<String, TableSplit> partitioned = ArrayListMultimap.<String, TableSplit>create();
for (InputSplit split : source) {
  TableSplit cast = (TableSplit) split;
  String rs = cast.getRegionLocation();

  partitioned.put(rs, cast);
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-01-22T15:20:32.537

如果您想使用仅找到几条记录的条件扫描来扫描大区域（数亿行），这将很有用。这将防止 ScannerTimeoutException

```
package org.apache.hadoop.hbase.mapreduce;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.util.Bytes;
import org.apache.hadoop.mapreduce.InputSplit;
import org.apache.hadoop.mapreduce.JobContext;

public class RegionSplitTableInputFormat extends TableInputFormat {

    public static final String REGION_SPLIT = "region.split";

    @Override
    public List<InputSplit> getSplits(JobContext context) throws IOException {

        Configuration conf = context.getConfiguration();
        int regionSplitCount = conf.getInt(REGION_SPLIT, 0);
        List<InputSplit> superSplits = super.getSplits(context);
        if (regionSplitCount <= 0) {
            return superSplits;
        }

        List<InputSplit> splits = new ArrayList<InputSplit>(superSplits.size() * regionSplitCount);

        for (InputSplit inputSplit : superSplits) {
            TableSplit tableSplit = (TableSplit) inputSplit;
            System.out.println("splitting by " + regionSplitCount + " " + tableSplit);
            byte[] startRow0 = tableSplit.getStartRow();
            byte[] endRow0 = tableSplit.getEndRow();
            boolean discardLastSplit = false;
            if (endRow0.length == 0) {
                endRow0 = new byte[startRow0.length];
                Arrays.fill(endRow0, (byte) 255);
                discardLastSplit = true;
            }
            byte[][] split = Bytes.split(startRow0, endRow0, regionSplitCount);
            if (discardLastSplit) {
                split[split.length - 1] = new byte[0];
            }
            for (int regionSplit = 0; regionSplit < split.length - 1; regionSplit++) {
                byte[] startRow = split[regionSplit];
                byte[] endRow = split[regionSplit + 1];
                TableSplit newSplit = new TableSplit(tableSplit.getTableName(), startRow, endRow,
                        tableSplit.getLocations()[0]);
                splits.add(newSplit);
            }
        }

        return splits;
    }
} 
```

# xcode - 故事板和一对多视图控制器

> ID：11039564
> 
> 赞同：0
> 
> 时间：2012-06-14T18:54:37.130
> 
> 标签：xcode

我正在编写一个具有一对多视图控制器关系的应用程序。

主 vc，比如 A 可以调用所有其他的（B，C，...），但子 vc 可以将控制权交还给 A。

我已经通过故事板内部的 segues 和 vc 作品之间的切换来定义关系。子 vc 应该能够在应用程序的生命周期内保存它们的状态。

现在我已经看到，每个 segue 都会创建一个新的 vc。所以我必须将状态数据传回给 A。这就是为什么我在 vc B 中创建了一个委托协议，将数据传回给 A。数据按预期返回到 A。但是，当我在 A 中执行下一个 prepareForSegue 以切换回 BI 时，我也在 vc A 的新对象中，但数据在 vc A 的旧对象中。

我真的必须将数据保存在文件系统上才能让它们在所有应用程序实时可用吗？这是正确的还是我错过了什么？

# python - 解析传入的电子邮件标题：发件人地址不可见。Ascii / Unicode 差异？

> ID：11039566
> 
> 赞同：1
> 
> 时间：2012-06-14T18:54:40.953
> 
> 标签：python, email

奇怪的问题在这里。

我使用 Python 99% 的时间都可以毫无问题地解析收到的电子邮件。最近出现了一个新问题，我的脚本无法确定从某些客户端发送的传入电子邮件地址是什么，例如 iPhone 上的内置电子邮件客户端。我的调试脚本会将 ["From"] 键列为不带电子邮件地址的名称。

我的期望：

```
Ryan Martin <ryan@grouped.com> 
```

我在日志中看到的内容（以及我的脚本试图处理的内容）：

```
Ryan Martin 
```

但是，如果我将日志发短信到我的手机，我会看到它正确列为

```
Ryan Martin <ryan@grouped.com> 
```

所以我的第一个想法是电子邮件地址被编码在我没有正确检测到的东西中。我知道这些信息在那里，因为我可以在手机上看到它。Python 脚本认为它是空白的，当保存到日志时它是空白的。

我正在解析电子邮件并使用以下代码进行测试：

```
parser = HeaderParser()
msg = parser.parsestr(self.message_as_string)
print msg["From"] 
```

我假设发件人名称是 ascii 并且实际的括号内的电子邮件地址是用其他东西编码的，但我不确定。

所以我的问题是：

> **如何确定发件人（“发件人”）的编码方式以及如何将其转换为我可以使用的东西？**

一如既往，谢谢。

这是标题的示例：

```
['Received: (qmail 16170 invoked by uid 110); 14 Jun 2012 10:49:02 -0700\n', 'Delivered-To: 1-etest@grouped.com\n', 'Received: (qmail 16167 invoked from network); 14 Jun 2012 10:49:02 -0700\n', 'Received: from mail-pz0-f46.google.com (209.85.210.46)\n', '  by grouped.com with (RC4-MD5 encrypted) SMTP; 14 Jun 2012 10:49:02 -0700\n', 'Received: by dady13 with SMTP id y13so2807279dad.5\n', '        for <etest@grouped.com>; Thu, 14 Jun 2012 10:49:01 -0700 (PDT)\n', 'DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;\n', '        d=gmail.com; s=20120113;\n', '        h=subject:references:from:content-type:x-mailer:in-reply-to\n', '         :message-id:date:to:content-transfer-encoding:mime-version;\n', '        bh=8ta00o/UsoBbe+qrLFMT/1rE1AHRZyQSK1Az6Ve7ffE=;\n', '        b=A4aSj5duxG4nWr1+Dn/X614kOMJWq+nYo6jo7ntsXNCZquoxPW/+1FBVXs96Qi73cR\n', '         jW5sIO33mCe1fsRQvDn+9Mp/i9kSNwzGX/+QwseBGy78bNf2ZDxDhbJZ7nKm9qlsvc2x\n', '         j9m/j8mZG7/j3ruz1b9O+j1KwCqzzl9Lgqj
 Lx0af7/MCEHVfE4rIpJsOBOzUJR8EA8MJ\n', '         5LvtdKxS3/8cqKX92plziGOWMiRjI+euBE3apHou7PUM9/BpHD4o2LH1OjSQKo6sVNmt\n', '         8CiB5vw3UvNDU+nMgjWcvirJsE8xzXDqkulbDiyI5Ba5QagfpwAKUb/OQpDlkY4gK+Bv\n', '         fTsg==\n', 'Received: by 10.68.225.6 with SMTP id rg6mr10617173pbc.100.1339696141712;\n', '        Thu, 14 Jun 2012 10:49:01 -0700 (PDT)\n', 'Return-Path: <some_sender@gmail.com>\n', 'Received: from [10.230.186.251] (125.sub-174-254-212.myvzw.com. [174.254.212.125])\n', '        by mx.google.com with ESMTPS id ol1sm10204626pbb.25.2012.06.14.10.48.53\n', '        (version=SSLv3 cipher=OTHER);\n', '        Thu, 14 Jun 2012 10:49:00 -0700 (PDT)\n', 'Subject: Re: Prempus Patterson replied to a post on etest\n', 'References: <20120614173822.12044.qmail@grouped.com>\n', 'From: Ryan Martin <some_sender@gmail.com>\n', 'Content-Type: multipart/alternative;\n', '\tboundary=Apple-Mail-17F5BF62-A532-49C2-BF72-499A1EEB510E\n', 'X-Mailer: iPhone Mail (10A5316k)\n', 'In-Reply-To: <
 20120614173822.12044.qmail@grouped.com>\n', 'Message-Id: <8321D4D0-E41A-4A1C-87DC-D7A2E462AC6A@gmail.com>\n', 'Date: Thu, 14 Jun 2012 10:48:48 -0700\n', 'To: Prempus Patterson <etest@grouped.com>\n', 'Content-Transfer-Encoding: 7bit\n', 'Mime-Version: 1.0 (1.0)\n', '\n', '\n', '--Apple-Mail-17F5BF62-A532-49C2-BF72-499A1EEB510E\n'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T20:30:26.600

找到一种方法将*原始*（离线）消息保存到文件中，并在十六进制编辑器中打开它。

或者，更直接地，在wireshark 中捕获传入的消息并查看`From:`行中的字节。然后你会看到标题中是否有一些奇怪的字符会弄乱解析器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T21:27:12.983

不幸的是，我不确定究竟是什么导致了我的问题，但我确实找到了一个目前有效的解决方案。振作起来，有点难看：

```
 # At this point, we know there is a < bracket in the 'From' value
    acceptable_chars = ["a", "b", "c", ... "6", "7", "8", "9", "0", "_", ".", "@"]
    from_str = msg["From"].lower().split("<")[-1]

    stripped_from = ''
    for letter in from_str:
        if letter in acceptable_chars:
            stripped_from += letter

    return stripped_from 
```

我不知道脚本为什么或如何能够以这种方式理解编码信息，但在评估整个字符串时不知道。我想这是因为在名称之后但在第一个括号之前有一个隐藏的 unicode 字符。

无论哪种方式，它都有效，但我愿意接受重写或其他建议。

# ruby-on-rails - Ruby on Rails + Backbone.js 路由

> ID：11039568
> 
> 赞同：0
> 
> 时间：2012-06-14T18:54:44.967
> 
> 标签：ruby-on-rails, ruby-on-rails-3, backbone.js, routing

我正在尝试将backbone.js 集成为我的rails 应用程序的前端框架。我在rails中有一个列表模型（等等）。

在设置我的主干前端时，我使用的是历史推送状态而不是主题标签。我希望主干/js 处理很多前端（登录的用户会影响标题等）并让应用程序具有“应用程序般的感觉”。

但是，当访问 /lists 时，它会转发到 rails 控制器，而不是骨干网。有没有解决方案，所以当rails和前端的url具有相同的名称时，我可以使用带有rails和backbone的内置会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T07:55:01.280

对于任何寻求答案的人：我们使用的解决方案只是让 Backbone 使用 API 调用控制除登录/注册表单之外的所有内容，我们的 iOS 应用程序也使用

# iphone - 删除核心数据中的对象

> ID：11039575
> 
> 赞同：28
> 
> 时间：2012-06-14T18:55:21.580
> 
> 标签：iphone, ios, xcode, core-data

如何删除我之前使用此代码添加的对象。它是一个收藏夹部分，在开始时，我添加了一个灰色星形，它添加了一个来自 fetch 的对象。然后它变成黄色，向后的方法应该是星黄色=删除。

但我不知道该怎么做。

```
-(IBAction)inFavoris:(id)sender {

AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

NSManagedObjectContext *context = [appDelegate managedObjectContext];
NSManagedObject *favorisObj = [NSEntityDescription
                            insertNewObjectForEntityForName:@"Favoris"
                            inManagedObjectContext:context];

[favorisObj setValue:idTaxi forKey:@"idTaxi"];
[favorisObj setValue:nomTaxi forKey:@"nomTaxi"];
[favorisObj setValue:taxiCB forKey:@"cb"];
[favorisObj setValue:taxiAvion forKey:@"avion"];
[favorisObj setValue:taxiColis forKey:@"colis"];
[favorisObj setValue:taxiHandicape forKey:@"handicape"];
[favorisObj setValue:taxiHoraires forKey:@"horaire"];
[favorisObj setValue:lugagge forKey:@"lugagge"];
[favorisObj setValue:luxury forKey:@"luxury"];
[favorisObj setValue:languesParlees forKey:@"langues"];
[favorisObj setValue:taxiNote forKey:@"note"];
[favorisObj setValue:taxiPassengers forKey:@"passenger"];
[favorisObj setValue:taxiVote forKey:@"etoiles"];
[favorisObj setValue:taxiTel forKey:@"tel"];

[self.view addSubview:favorisB];

} 
```

**更新**

我做了这个方法..它完成了工作:)

```
-(IBAction)outFavoris:(id)sender {

AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
NSString *testEntityId = idTaxi;
NSManagedObjectContext *moc2 = [appDelegate managedObjectContext];

NSFetchRequest *fetch = [[NSFetchRequest alloc] init];
fetch.entity = [NSEntityDescription entityForName:@"Favoris" inManagedObjectContext:moc2];
fetch.predicate = [NSPredicate predicateWithFormat:@"idTaxi == %@", testEntityId];
NSArray *array = [moc2 executeFetchRequest:fetch error:nil];

for (NSManagedObject *managedObject in array) {
    [moc2 deleteObject:managedObject];
}

[self.view addSubview:favorisO];

} 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-06-14T19:00:02.823

它很简单:)

```
[context deleteObject:favorisObj]; 
```

坏的对象都消失了。

**更新**

如果您需要一个按钮来删除对象，您只需使用类似的方式将其反转。

```
-(IBAction)removeFavoris:(id)sender {

    AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

    NSManagedObjectContext *context = [appDelegate managedObjectContext];

    [context deleteObject:favorisObj];
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-06-10T02:20:56.153

删除 NSManagedObject 后不要忘记保存 Context。所以这是通用代码；

```
NSManagedObjectContext * context = [self managedObjectContext];
[context deleteObject:objectToDelete];

NSError * error = nil;
if (![context save:&error])
{
    NSLog(@"Error ! %@", error);
} 
```

在您的情况下，它应该在 for 循环之后有代码段。

```
for (NSManagedObject *managedObject in array) {
    [moc2 deleteObject:managedObject];
}
NSError * error = nil;
if (![context save:&error])
{
    NSLog(@"Error ! %@", error);
} 
```

# dojo - 带有 lang.replace 的 Dojo i18n 不起作用

> ID：11039579
> 
> 赞同：0
> 
> 时间：2012-06-14T18:55:38.443
> 
> 标签：dojo

我有两个模板文件：一个用于表单（loginFormTemplate），一个用于对话框（dialogTemplate）。当我把它们放在一起时，我只会在我的表单上得到 i18n（比如 ${i18n.username} 等），而不是我的对话框 html，它显示的是 ${undefined}。我已经在我的 nls 文件中明确定义了它。为什么？这是我构建对话框时的代码。

```
 var template = lang.replace(dialogTemplate, {
            form: loginFormTemplate                
        });

        var contentWidget = new (declare(
            [_Widget, _TemplatedMixin, _WidgetsInTemplateMixin],
            {
                templateString: template,
                i18n: i18n   
            }
        )); 
```

我可以像在 dialoTemplate 中的表单一样创建“变量”并传递我的 i18n 值，但我觉得它不太优雅。我只想做一次。所以，它会是这样的。

```
 var template = lang.replace(dialogTemplate, {
            form: loginFormTemplate,
            _ok: i18n.okLabel,
            _cancel: i18n.cancelLabel
        });

        var contentWidget = new (declare(
            [_Widget, _TemplatedMixin, _WidgetsInTemplateMixin],
            {
                templateString: template,
                i18n: i18n   
            }
        )); 
```

**这是我用 phusick 回答的解决方案（我的表格用 %[] 表示）：**

```
var template = lang.replace(
                dialogTemplate,
                {form: loginFormTemplate},
                /\%\[([^\]]+)\]/g
            ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:49:00.153

我不在我的电脑旁，但我猜调用'lang.replace' 不仅会替换 {form}，而且你的 ${i18n.*} 也会替换为 undefined，因为调用 'lang.replace' 时只定义了 'form'。

编辑：您可以将“lang.replace”与自定义模式一起使用，以避免 i18n 和字符串连接之间的冲突：http: [//livedocs.dojotoolkit.org/dojo/_base/lang#advanced-usage](http://livedocs.dojotoolkit.org/dojo/_base/lang#advanced-usage)

# python - 从自定义包中导入大量模块

> ID：11039580
> 
> 赞同：4
> 
> 时间：2012-06-14T18:55:54.213
> 
> 标签：python, import, module, packages

说我有这个结构。

```
MyApp
├── main.py
└── package
    ├── __init__.py
    ├── a.py
    ├── b.py
    ├── c.py
    ├── d.py
    ├── e.py
    ├── f.py
    ├── g.py
    ├── h.py
    ├── ...
    └── z.py 
```

在`main.py`我需要使用所有模块，从`a.py`到`z.py`

我想知道如何使用一个导入语句导入所有这些模块。

所以而不是做

```
from package import a
from package import b
...
from package import z 
```

我可以只导入包并准备好所有模块。

**我尝试过的事情**

```
import package
a = package.a.A()
# AttributeError: 'module' object has no attribute 'a' 
```

现在我知道我可以输入一个代码`__init__.py`来将所有模块添加到 中`__all__`，但是根据我所读到的，我们应该避免“从包导入 *”

这样做的原因是包可能有越来越多的模块，我想在每次创建模块时在主代码中添加一个导入语句。理想情况下，我希望能够将模块放入包中并准备好使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:05:32.873

在`__init__.py`中，您可以：

```
import a, b, c, d... 
```

然后`package`在你做之后模块将被放置在命名空间中`import package`。

您真的想在 main.py 的命名空间中命名`a`,`b`等，并且毫不费力地发生这种情况，您无法避免`from package import *`；任何其他隐式导入它们的方法都将同样糟糕，因为它涉及使用您未显式导入的名称污染命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T19:18:05.810

您提出的建议是非常糟糕的设计实践，因为您导入了所有但不是所需的内容。一般来说，它会减慢程序加载速度——如果不是真的需要，就不要这样做。也不要初始化模块中未使用的变量，因为它浪费时间。

如果使用不当，两种解决方案不符合良好的设计实践。

检查这个答案[有人可以用 Python 解释 __all__ 吗？](https://stackoverflow.com/questions/44834/can-someone-explain-all-in-python).

您还可以使用`__import__`加载模块并`os.path.dirname(__file__)`列出目录中的所有文件名并作为模块加载。

顺便说一句，这种模式会导致严重的安全漏洞，因为您允许加载任何内容 - 它只需要创建权限即可破坏安全性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T19:18:37.107

我建议**不**要这样做。如果必须，这是我过去使用的方法：

```
# __init__.py

import os
import re

PACKAGE = 'MyApp.package'
MODULE_RE = r"^.*.py$"

for filename in os.listdir(os.path.dirname(__file__)):
  if not re.match(MODULE_RE, filename) or filename == "__init__.py":
    continue

  imported_module = __import__('%s.%s' % (PACKAGE, filename[:-3]),
                               {}, {},
                               filename[:-3]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-14T19:11:38.340

这段代码不是很漂亮，但我认为这是一个很好的解决方法

```
import os

for i in os.listdir('package'):
    if i.endswith('.py') and not i.startswith('__'):
        exec('from package import ' + i[:-3]) 
```

# c# - 在 C# 中嵌套 try-finally

> ID：11039591
> 
> 赞同：24
> 
> 时间：2012-06-14T18:56:32.717
> 
> 标签：c#, try-catch

为什么不是 "Console.WriteLine("asdf");" 行 执行？其他都是。不应该也是因为我们不能从finally范围中跳出来吗？

```
static bool Func()
{
    try
    {
        try
        {
        }
        finally
        {
            try
            {
                throw new ApplicationException();
            }
            finally
            {
                Console.WriteLine("asd");
            }

            Console.WriteLine("asdf");
        }
    }
    finally
    {
        Console.WriteLine("asd");
    }
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-14T18:59:04.590

finally 块仅保证（至少大部分保证，请参阅下面的 MSDN 摘录）在 try 块引发异常的情况下将***输入它们。***如果**在**finally 块中抛出异常，该异常将导致控制权离开 finally 块，并且该 finally 块中的其余代码将不会执行。

在您的情况下，未执行的行发生在同一个 finally 块中的异常之后，因此它被跳过。

来自[MSDN - try-finally](http://msdn.microsoft.com/en-us/library/zwc8s4fz.aspx)：

> **finally**块可用于清理在**try**块中分配的任何资源，以及运行任何必须执行的代码，即使在**try**块中发生异常也是如此。通常，**finally**块的语句在控制离开**try** 语句时执行，无论控制转移是由于正常执行、执行**break**、**continue**、**goto**或**return** 语句，还是传播异常而发生出**try**语句。
> 
> 在已处理的异常中，保证运行关联的**finally块。**但是，如果异常未处理， **finally**块的执行取决于异常展开操作的触发方式。反过来，这取决于您的计算机的设置方式。有关详细信息，请参阅 CLR 中的未处理异常处理。

*注意：[CLR 中的未处理异常处理](https://blogs.msdn.microsoft.com/msdnmagazine/2008/09/01/september-2008-msdn-magazine-now-online/)是对 MSDN 杂志 2008 年 9 月号中的一篇文章的引用。所有 2008 年及更早版本的 MSDN 杂志仅以 .chm 文件的形式提供，需要在查看前下载。*

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-06-14T19:15:04.887

我认为可以回答这个问题的最好方法是使用代码，因此使用下图 ![在此处输入图像描述](../Images/add6c32ef905202f47ab15c8ce2cb30c.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-14T18:59:30.217

因为在该 finally 块中引发了异常，所以它导致控制权落到最终的 finally 块中。所以“asdf”WriteLine 永远不会执行。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-14T18:59:02.077

在finally（或catch）块中抛出的异常会取消该finally（或catch）块的其余部分。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-14T19:01:05.477

错误发生在第三个 try 块内，导致其相应的 finally 被执行。但是，这会导致它从当前的 finally 中出错并被原始的 try-finally 块捕获。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-14T19:02:22.390

因为你已经抛出了 try 块，它会执行 finally 块`Console.WriteLine("asd");`并退出到外部 try catch

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-04-15T10:12:35.117

当我在跨不同主机平台部署的代码上使用 try-finally 块时，我发现：当 try 块上没有引发异常时。

一些 Windows 平台总是执行 finally 块，而一些平台从不执行 finally 块。

我的 finally 块包含关闭错误日志的指令，并且无法执行 finally 块总是在退出时引发另一个异常，只留下密码信息来找出导致错误的原因。对于我的应用程序，try finally 块比它们的价值更麻烦。

# mysql - Joomla 在线商店管理

> ID：11039592
> 
> 赞同：0
> 
> 时间：2012-06-14T18:56:33.073
> 
> 标签：mysql, joomla, virtuemart

有人对 Joomla 的非技术用户最好的在线商店有什么建议吗？有人告诉我，VirtueMart 是一个不错的选择。有更好的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:16:02.770

好的...这绝对不是 db/mysql 管理工具。VM 绝对是一个答案，尽管它有爱也有恨。它的功能有点广泛，所以如果这是一个问题，我会检查[Joomla 电子商务扩展目录](http://extensions.joomla.org/extensions/e-commerce/shopping-cart)以查看可能更合适的其他内容。他们被评为让您了解您正在寻找的东西。

# c++ - Qt：将包含二维数组的信号从一个线程传递到另一个线程

> ID：11039594
> 
> 赞同：0
> 
> 时间：2012-06-14T18:56:42.437
> 
> 标签：c++, multithreading, qt, signals

我正在尝试学习 Qt，我正在尝试通过制作一个小游戏来做到这一点。目前我有一个代表游戏板的二维数组。

每一秒，这个二维数组都会被一个线程更改（代表时间的流逝），然后这个线程发出一个信号，告诉主 GUI 根据新的游戏板进行更新。

我的线程如下：

**游戏线程.h**

```
#ifndef GAMETHREAD_H
#define GAMETHREAD_H
#include <QtCore>
#include <QThread>
#include<QMetaType>

class GameThread : public QThread
{
    Q_OBJECT

    public:
        explicit GameThread(QObject *parent = 0);
        void run();

    private:
        int board[20][10]; //[width][height]
        void reset();

    signals:
        void TimeStep(int board[20][10]);
};

#endif // GAMETHREAD_H 
```

**游戏线程.cpp**

```
#include "gamethread.h"
#include <QtCore>
#include <QtDebug>

//Game Managment
GameThread::GameThread(QObject *parent) :
    QThread(parent)
{
    reset();
}

void GameThread::reset()
{
    ...
}

//Running The Game
void GameThread::run()
{
    //Do Some Stuff
    emit TimeStep(board);
} 
```

应该接收信号并根据新板进行更新的主 UI 是：

**俄罗斯方块.h**

```
#ifndef TETRIS_H
#define TETRIS_H

#include <QMainWindow>
#include "gamethread.h"

namespace Ui{
    class Tetris;
}

class Tetris : public QMainWindow
{
    Q_OBJECT

    public:
        explicit Tetris(QWidget *parent = 0);
        ~Tetris();
        GameThread *mainThread;

    private:
        Ui::Tetris *ui;

    private slots:
        int on_action_Quit_activated();
        void on_action_NewGame_triggered();

    public slots:
        void onTimeStep(int board[20][10]);

};

#endif // TETRIS_H 
```

**俄罗斯方块.cpp**

```
#include <QMessageBox>
#include <QtGui>
#include <boost/lexical_cast.hpp>
#include <string>

#include "tetris.h"
#include "ui_tetris.h"

Tetris::Tetris(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::Tetris)
{
    ui->setupUi(this);
    mainThread = new GameThread(this);

    connect(mainThread, SIGNAL(TimeStep(int[20][10])),
            this, SLOT(onTimeStep(int[20][10])),
            Qt::QueuedConnection);
}

Tetris::~Tetris()
{
    delete ui;
}

void Tetris::onTimeStep(int board[20][10])
{
    //receive new board update my display
}

void Tetris::on_action_NewGame_triggered()
{
    mainThread->start();
} 
```

当我运行它时，我得到：

*QObject::connect: 无法对类型为“int[20][10]”的参数进行排队（确保使用 qRegisterMetaType() 注册了“int[20][10]”。）*

我研究了 qRegisterMetaType 和 Q_DECLARE_METATYPE 但我什至不确定如何使用它们，或者即使我必须使用它们。有人可以给QT新手一些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:16:25.460

您可以将板数据包装在一个类中。如果您只是对它进行类型定义，它将不起作用，因为 Qt 将尝试使用非数组运算符 new 来创建板数据的实例。编译器会检测到它并理所当然地抱怨。

像您正在做的那样从 QThread 派生并将其用作通用 QObject 是不好的风格。QThread 在概念上是一个线程控制器，而不是线程本身。请参阅[此答案](https://stackoverflow.com/a/11039216/1329652)以了解惯用的方法。您的 GameThread 应该是 QObject，而不是 QThread。

所以：

```
struct Board {
  int data[20][10];
}
Q_DECLARE_METATYPE(Board);

int main(int argc, char ** argv)
{
   QApplication app(argc, argv);
   qRegisterMetatype<Board>("Board");

   ...

   Game * game = new Game;
   QThread thread;
   game->connect(&thread, SIGNAL(started()), SLOT(start());
   game->connect(game, SIGNAL(finished()), SLOT(deleteLater()));
   thread.connect(&game, SIGNAL(finished()), SLOT(quit());
   game.moveToThread(&thread);

   thread.start(); // you can start the thread later of course
   return app.exec();
}

class Game: public QObject
{
QTimer timer;
Board board;
public slots:
   void start() {
     connect(&timer, SIGNAL(timeout()), SLOT(tick()));
     timer.start(1000); // fire every second
   }
   void finish() {
     timer.stop();
     emit finished();
   }
protected slots:
   void tick() {
      ... // do some computations that may take a while
      emit newBoard(board);
      // Note: it probably doesn't apply to trivial computations in
      // a Tetris game, but if the computations take long and variable
      // time, it's better to emit the board at the beginning of tick().
      // That way the new board signal is always synchronized to the timer.
   }  
signals:
   void newBoard(const Board &);
   void finished();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:06:17.330

如果后来你决定改变电路板的大小会发生什么？我认为最好将板的概念封装在一个对象中，并传递一个指向该对象的指针。

# actionscript-3 - 如何在 Flash Builder 4 中对文本输入应用 SSN 屏蔽？

> ID：11039596
> 
> 赞同：0
> 
> 时间：2012-06-14T18:56:49.923
> 
> 标签：actionscript-3, apache-flex, air, flash-builder

我想对需要从用户获取 SSN 的文本输入应用屏蔽，那么如何在 Flash Builder 4 中对文本输入应用 SSN 屏蔽？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T20:04:50.640

从长远来看，最优雅的解决方案是创建一个自定义组件，但也可以在现有的`TextInput`. 给出执行以下操作`TextInput`的`change`事件：

```
var s:String=textInput.text.replace(/[^0-9]/g,"");
textInput.text = s.substring(0,3) + 
    (s.length>3?"-"+s.substring(3,5)+
    (s.length>5?"-"+s.substring(5,9):""):"");
textInput.selectRange(textInput.text.length,textInput.text.length); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:11:08.207

这将掩盖字符：

`txtInput.displayAsPassword = true;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:13:18.433

`<s:TextInput displayAsPassword="true" restrict="0-9" maxChars="9"/>`将导致文本在用户输入时显示为星号，并且还会阻止他们输入超过 9 个字符或任何非数字字符，这两者都是 SSN 的要求。

# android - checkIfPhoneIsSilent() 方法未定义

> ID：11039597
> 
> 赞同：0
> 
> 时间：2012-06-14T18:56:51.843
> 
> 标签：android

我正在关注 Android Development for Dummies 中的示例应用程序，这是一个简单的应用程序，可以将铃声模式从静音切换到正常。出于某种原因，当我调用 checkIfPhoneIsSilent 方法时，它带有红色下划线，并带有错误消息“方法 checkIfPhoneIsSilent 未定义为 Main 类型” 这是到目前为止的代码：

```
import android.app.Activity;

import android.graphics.drawable.Drawable;

import android.media.AudioManager;

import android.view.View;

import android.view.View.OnClickListener;

import android.os.Bundle;

import android.widget.Button;

import android.widget.ImageView;

public class Main extends Activity {

    private AudioManager mAudioManager;
    private boolean mPhoneIsSilent;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mAudioManager = (AudioManager)getSystemService(AUDIO_SERVICE);
        checkIfPhoneIsSilent();
        setButtonClickListener();
    }

    private void setButtonClickListener() {
        Button toggleButton = (Button)findViewById(R.id.toggleButton);
        toggleButton.setOnClickListener(new OnClickListener() {

                public void onClick(View v) {
                    if (mPhoneIsSilent) {
                        //change back to normal
                        mAudioManager
                            .setRingerMode(AudioManager.RINGER_MODE_NORMAL);
                    }

                }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:02:22.480

**checkIfPhoneIsSilent**方法与添加此方法一样。您在代码中缺少它：

```
private void checkIfPhoneIsSilent() {
int ringerMode = mAudioManager.getRingerMode();
if (ringerMode == AudioManager.RINGER_MODE_SILENT) {
mPhoneIsSilent = true;
} else {
mPhoneIsSilent = false;
}
} 
```

# php - 如何使用 PHP 中的 imap 类从 GMail 邮箱中单独获取最近的电子邮件？

> ID：11039606
> 
> 赞同：1
> 
> 时间：2012-06-14T18:57:30.987
> 
> 标签：php, imap, gmail-imap

我想使用 PHP 的 imap 类从 GMail 获取电子邮件。

我试过了：

```
$val = date('Y-m-d H:i:s', 1337352811);
$recentMails = imap_search($this->imapInBox, 'SINCE $val', SE_UID); 
```

这没有用。

我试过了`<SINCE "4 Jun 2012">`。这行得通。

但是当我使用此选项时，我在下载附件时遇到了问题，这也会导致冗余并一次又一次地获取相同的电子邮件。我需要使用准确的时间（例如 Unix 时间戳）来仅获取最新的电子邮件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:11:05.017

看一下 RFC 的这段摘录：

```
 RECENT
     Messages that have the \Recent flag set.

  SINCE <date>
     Messages whose internal date (disregarding time and timezone)
     is within or later than the specified date. 
```

您只能根据日期进行搜索，不能比这更精细。

但是，您可以做的是取消设置`Recent`标志，然后搜索日期和`Recent`标志。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-14T19:02:05.153

谷歌“imap phph gmail”，你会发现很多教程和代码。例如： [使用 PHP 和 IMAP 检索您的 Gmail 电子邮件](http://davidwalsh.name/gmail-php-imap)

# magento - Magento 优惠券代码不计算任何东西

> ID：11039611
> 
> 赞同：0
> 
> 时间：2012-06-14T18:57:49.240
> 
> 标签：magento

我的magento优惠券代码有问题，我已经为所有产品设置了10％的购物车价格规则，但是在结账时，当我输入优惠券代码并单击应用时，页面刷新但没有从价格中扣除，谁能帮我解决这个问题，我一直在寻找解决方案几天了，仍然没有运气，在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:57:09.873

首先确保在规则信息中它是活动的并且所有主要的客户组都被检查过，并且开始日期和结束日期都包括今天（因为你今天正在测试它）。

您不需要任何条件来获得一揽子 10% 的折扣规则，但您的“操作”选项卡应该有；

1.  应用设置为“产品价格折扣百分比”
2.  折扣金额设置为 10。
3.  最大数量和折扣数量都设置为 0。

并且“应用规则”条件全部为空白。

抱歉，如果这一切看起来很明显并且没有帮助，我有一家商店，所有商品都可以享受 10% 的折扣，而这些设置都可以实现。祝你好运。

# javascript - Chrome 弹出窗口始终位于顶部

> ID：11039613
> 
> 赞同：3
> 
> 时间：2012-06-14T18:57:56.443
> 
> 标签：javascript, google-chrome, google-chrome-extension

我有一个打开弹出窗口的 Chrome 应用程序。我希望它能够保持领先，但目前无法这样做。

[Chat for Google](https://chrome.google.com/webstore/detail/nckgahadagoaajjgafhacjanaoiihapd)扩展会打开一个弹出窗口，该窗口不仅位于所有窗口的顶部，而且窗口本身似乎也具有完全自定义的外观。不幸的是，这个扩展中的所有 JavaScript 都被混淆了，我无法确定它的正面或反面。

[Chrome API](http://code.google.com/chrome/extensions/windows.html)将“alwaysOnTop”布尔值列为 Window 类型的一部分，但 create 和 update 函数都不允许更改此属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:06:11.430

它是一种`panel`窗户。使用参数调用[chrome.windows.create](http://code.google.com/chrome/extensions/windows.html#method-create)`type: 'panel'`。这目前仅适用于 dev 和 canary 频道。

# c++ - Ifstream在打开文件时崩溃程序

> ID：11039618
> 
> 赞同：1
> 
> 时间：2012-06-14T18:58:37.930
> 
> 标签：c++, file, io, fstream, ifstream

我已经缩小了我的代码范围，我找到了问题的根源，就是我打开一个文件的时候。该文件确实存在，并且在编译时我没有收到任何警告或错误。

```
int main(int argc, const char* args[]) 
{
    cout << "Wellcome" << endl;
    cout << args[1];
    ifstream exists(args[1]);
    if(!exists)
    {
        printf("FILE NOT FOUND");
        return 1;
    }
    exists.close();
    ifstream* in;
    in->open(args[1],ios::binary|ios::in);
    //do stuff
    in->close();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:00:58.567

您已经创建了一个指向`ifstream`对象的指针，但您从未分配过一个指针来`ifstream`指向它。要解决此问题，请考虑仅对其进行堆栈分配：

```
ifstream in;
in.open(args[1],ios::binary|ios::in);
//do stuff
in.close(); 
```

通常，您通常不需要动态分配对象，除非您希望它们比创建它们的函数寿命更长。

希望这可以帮助！

# c# - 如何测试和部署分布式应用程序？

> ID：11039619
> 
> 赞同：0
> 
> 时间：2012-06-14T18:58:39.547
> 
> 标签：c#, deployment

我编写了一个客户端-服务器应用程序。有一台计算机运行服务器应用程序，而多台计算机运行客户端应用程序。

到目前为止，每次我的应用程序有新版本/补丁时，我首先通过 VNC 将二进制文件复制到服务器应用程序，然后启动一个脚本，在客户端执行一个脚本，即将二进制文件复制到本地文件夹（网络执行不起作用！）...然后在每台客户端计算机上启动客户端应用程序...

那么有什么好的机会可以替代我的旧方法呢？

我尝试创建一个通过 http/ftp 更新的单击一次应用程序...但没有成功^^

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:23:06.303

我们使用一个名为 Presto 的开源应用程序：http: [//presto.codeplex.com/](http://presto.codeplex.com/)

完成初始设置后，每次部署只需两个手动步骤：
1\. 将二进制文件复制到网络位置
2\. 按 Presto 中的按钮启动新部署

Presto 的最大优势在于您可以使用它来初始设置您的应用程序和服务器，并为每个环境指定适当的配置设置。启动部署后，安装会自动进行，并将正确的值写入配置文件（QA 获取 QA 值，生产获取生产值，等等）。

使用 Presto，您可以停止服务、删除文件夹、复制新的二进制文件、更新配置文件等……而且这一切都是自动化的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:24:06.943

这就是 Web 前端如此受欢迎的原因 :)

尝试实现良好的自动更新机制和版本控制。客户端具有硬编码的服务器版本，第一次调用所有调用服务器都包含自己的版本。当版本不匹配时 - 自动更新时间。在服务器上 - 它只是下载客户端应用程序安装的端点，这是跨版本的标准。

所以客户端有外部更新程序，在客户端知道新版本存在后启动。更新程序过程的目标是下载新的安装/包，或者运行安装更新/重新安装客户端，或者解压缩并复制新的/修改的文件。

不使用某些外部库时。过程看起来像这样。

单击一次是另一种方法，也应该有效。

类似的问题在这里

[自动更新 .NET 应用程序](https://stackoverflow.com/questions/819647/auto-update-net-applications)

无论如何，您的客户端应用程序可能需要一个好的安装程序。当您有安装程序时，只需执行简单的下载器/更新器和服务版本控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:39:57.507

用更少的代码做到这一点并不难。

1.  在您的应用程序中设置 http 服务。
2.  创建一个列出当前版本的文件。
3.  在您的应用程序中设置 ftp 服务以提供新的二进制文件。
4.  将 Updater.exe 应用程序添加到客户端，这将通过 http 检查新更新并通过 ftp 下载新版本。还应该制作一个客户端版本文件。

因此，您只需再执行一次旧式方法即可完成！现在我不知道客户端应用程序是否可以运行服务器，如果是这样，我建议将服务（http、ftp）与服务器应用程序分开。

# c# - 无法让我的 DropDownListFor 在下拉菜单中选择选定的 SelectListItem 项

> ID：11039621
> 
> 赞同：3
> 
> 时间：2012-06-14T18:58:42.933
> 
> 标签：c#, asp.net-mvc, razor, drop-down-menu, model-binding

我有一个填充到下拉菜单中的项目集合：

```
string myUserName = "PopulatedWithSomeUser";

var users= from x in userRepository.GetAll()
    select new SelectListItem
       {
          Value = x.Id.ToString(),
          Text = x.Name,
          Selected = (x.Name == myUserName )
       }; 
```

这会正确填充对象并设置所选项目。接下来，我使用 ViewModel 将其传递给我的视图并尝试填充/选择：

我试过：

```
 @Html.DropDownListFor(model=>model.Users,new SelectList(Model.Users),new {id = "add-user-list", name="add-user-list"}) 
```

还

```
@Html.DropDownListFor(model=>model.Users,new SelectList(Model.Users,"Value","Text","Selected"),new {id = "add-user-list", name="add-user-list"}) 
```

还

```
@Html.DropDownListFor(model=>model.Users,Model.Users, new {id = "add-user-list", name="add-user-list"}) 
```

该列表已正确填充，但从未选择我的“选定”项目。我究竟做错了什么 ？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T00:06:21.043

作为第一个参数，您应该传递一个字段，用于在表单提交后接收数据。其他一切看起来都正确：

```
@Html.DropDownListFor(model=>model.UserId, Model.Users) 
```

或者，如果您要提供自己的 id 和名称 - 最好使用这个 ( [msdn](http://msdn.microsoft.com/en-us/library/dd470380%28v=vs.98%29.aspx) )：

```
@Html.DropDownList("add-user-list", Model.Users, new {id = "add-user-list"}) 
```

# css - 是否可以在 div 中垂直自动居中元素？

> ID：11039625
> 
> 赞同：0
> 
> 时间：2012-06-14T18:59:05.490
> 
> 标签：css, margin

我有一个在线照片库。缩略图页面是一个 150px x 150px div 的网格，缩略图图像设置在其中。

由于缩略图是矩形的，理想的做法是让它们在 div 中自动居中。

在这里阅读，我已经弄清楚如何将它们水平居中。我也一直在读到，在 CSS3 起飞之前，垂直自动居中是不可能的。这是真的？

我已经让水平图像自动居中：

```
.portrait_t {
width: auto;
height: 150px;
text-align: center;
display: block;
margin: 0 auto 0 auto;
} 
```

但是，垂直居中不适用于此：

```
.landscape_t {
width: 150px;
height: auto;
display: block;
margin: auto 0 auto 0;
} 
```

如果在 CSS3 之前无法做到这一点，那么我将不得不想出一个解决方法，但如果我遗漏了什么，请告诉我。

提前感谢大家的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T20:29:39.807

您有一个内联元素 (the `<img>`)，它位于大小合适的父`<div>`元素内：

```
<div>
    <img />
</div> 
```

您需要做的就是使其居中对齐。您将其与`text-align:center;`父级居中，并通过给出其全高来`<div>`将其居中对齐。此外，由于它是一个标签，因此无论它自己的大小如何，您都可以为该图像标签提供在其中完成的内容：`<div>``line-height``<img>``vertical-align:middle;`

![在此处输入图像描述](../Images/57bf701db5a9198f3dda069df58c81be.png)

示例/[演示](http://jsfiddle.net/fw4MA/)：

```
<style>
div {width:350px; height:350px; line-height:350px; text-align:center;}
  div img {vertical-align:middle;}​
</style>

<div>
  <img src="http://i.imgur.com/PKnWs.jpg">
</div>
<div>
  <img src="http://i.imgur.com/Az6NUl.jpg">
</div> 
```

# android - 滑动不显示下一个

> ID：11039632
> 
> 赞同：1
> 
> 时间：2012-06-14T18:59:27.223
> 
> 标签：android, jquery-mobile, cordova, swipe

我想使用插件[http://swipejs.com/](http://swipejs.com/)。它是一个用于滑动列表项的简单插件。我的问题是：列表项可以滑动，但它会立即返回到原始位置并且不会占用下一个列表项。

```
<div id='slider' class='swipe'>
              <ul>
                <li style='display:block'><div>1</div></li>
                <li style='display:none'><div>2</div></li>
                <li style='display:none'><div><img src="img/mimik1.jpg"></div></li>
                <li style='display:none'><div>4</div></li>
                <li style='display:none'><div>5</div></li>
              </ul>
            </div>
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
    <script src="js/app.js"></script>   
        <script src='js/swipe.js'></script>
<script>
new Swipe(document.getElementById('slider'));
</script> 
```

问题似乎是 jquery.mobile.js 。也许有些东西重叠？Any1有想法吗？div 拉开后只是向后滑动。

此致

# php - PHP GD Image - 输出动画 GIF

> ID：11039636
> 
> 赞同：0
> 
> 时间：2012-06-14T18:59:33.777
> 
> 标签：php, gd, gif, animated

我有一个想要作为水印的动画 GIF。如何包含动画 GIF？这支持吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T20:13:42.013

如果您希望它是一个实际的水印 - 下载时出现在整个图像中 - 那么您必须将整个图像转换为 gif 并用水印帧覆盖背景图像（每帧重复）。

你必须有动画水印吗？你能有一个静态水印，上面有动画水印吗？

归根结底，您无法为 jpg 制作动画，并且我会尽量避免将所有内容保存为 gif 格式

# rightfax - RightFax 10.0 与 C# 的集成

> ID：11039641
> 
> 赞同：1
> 
> 时间：2012-06-14T18:59:56.520
> 
> 标签：rightfax

如果我将值插入到 RightFax 的相应表中，它会自动传真还是我需要为此编写以下代码？

```
RFCOMAPILib.FaxServerClass faxserver = new RFCOMAPILib.FaxServerClass(); 
faxserver.ServerName = "ServerName"; 
faxserver.Protocol = RFCOMAPILib.CommunicationProtocolType.cpNamedPipes; 
faxserver.UseNTAuthentication = RFCOMAPILib.BoolType.True; 
faxserver.OpenServer(); 

RFCOMAPILib.Fax fax = (RFCOMAPILib.Fax) faxserver.get_CreateObject(RFCOMAPILib.CreateObjectType.coFax); 

// set up your 'fax' object the way you want it, below is just some sample options 
fax.ToName = "John Doe"; 
fax.ToFaxNumber = "4255551111"; 
fax.ToVoiceNumber = "4255550000"; 
fax.ToCompany = "ACME"; 
fax.FromName = "My Company"; 
fax.FromVoiceNumber = "4255552222"; 

fax.Send(); 
```

你能给我提供附件的示例代码吗？如果 RightFax 自动发送传真，那么我需要填写哪些表格才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:28:01.757

下面的代码是 vb.net，但会向您展示如何发送传真和添加附件，希望对您有所帮助。我在这里写了一篇关于这个的帖子，但[这里](http://rightfaxdeveloper.com/adding-a-attachment-via-the-rightfax-com-api/) 是下面的代码......

```
Dim FaxAPI As RFCOMAPILib.FaxServer
Dim fFax As RFCOMAPILib.Fax
FaxAPI = New RFCOMAPILib.FaxServer
FaxAPI.ServerName =something
FaxAPI.Protocol = RFCOMAPILib.CommunicationProtocolType.cpTCPIP
FaxAPI.UseNTAuthentication = RFCOMAPILib.BoolType.False
FaxAPI.AuthorizationUserID = something
FaxAPI.AuthorizationUserPassword = something
FaxAPI.OpenServer()
fFax = FaxAPI.CreateObject(RFCOMAPILib.CreateObjectType.coFax)
fFax.Attachments.Add(“D:\FilePickupIn\2222222222-20110322142718-01.tif”)
fFax.HasCoversheet = RFCOMAPILib.BoolType.False
fFax.ToFaxNumber = something
fFax.ToName = something
fFax.Send()
FaxAPI.CloseServer()
FaxAPI = Nothing
fFax = Nothing 
```

如果您遇到任何问题，很乐意提供帮助...

# c# - 反序列化 html 以调用解析 json 数据并将其反序列化并显示最终结果表的操作结果方法

> ID：11039644
> 
> 赞同：0
> 
> 时间：2012-06-14T19:00:14.387
> 
> 标签：c#, html, asp.net-mvc, json, deserialization

在我的视图窗口中，我有一个像这样调用 get 事件方法的表单

```
 <form action="GetEvent" method="post">

    <input type="submit" value="Click Me" />
    </form> 
```

这会在我的 Homecontroller 中调用我的 GetEvent 并像这样处理它

```
 public ActionResult GetEvent()
    {
        try
        {

            string at = "aa";
            string et = "KI";
            string t = "20";
            string _checkingUrl = String.Format("http://172.22.22.10/SampleAPI/Event/GetEvents?at={0}&et={1}&t={2}&responseFormat=json", at, et, t);
            System.Net.HttpWebRequest request=System.Net.WebRequest.Create(_checkingUrl) as System.Net.HttpWebRequest;
            System.Net.HttpWebResponse response=request.GetResponse() as System.Net.HttpWebResponse;
            System.IO.StreamReader _readResponse=new System.IO.StreamReader(response.GetResponseStream());
            //The encrypted dynamics response in either xml or json

            string _responseAsString=_readResponse.ReadToEnd();
            JavaScriptSerializer parseResponse = new JavaScriptSerializer();
            List<Event> events = parseResponse.Deserialize<List<Event>>
           (_responseAsString); 
```

我的事件我在我的模型视图中创建了一个类。它低于这种方法

```
 //return Content(_responseAsString);

            _readResponse.Close();
        }
        catch (Exception e)
        {
            //log error
        }
        return View();
    }

}

     public class Event
{
     // side note this variables are the name of the Json Data that i retrieved
    public string event_key { get; set; }
    public string user_token { get; set; }
    public string event_set_key { get; set; }
    public string event_type { get; set; }
    public string event_date { get; set; }
    public string event_amount { get; set; }
    public string event_location_key { get; set; }
    public string event_location_name { get; set; }
    public string event_location_city { get; set; }
    public string event_location_state { get; set; }
    public string event_location_country { get; set; }
    public string event_acknowledged { get; set; }
} 
```

现在的问题是。在我解析 Json 响应并将其放入对象列表中之后。如何在表格中显示它。所以在我单击“单击我”按钮后，它将通过该方法，然后应该出现一个页面，其中包含表中的偶数对象？我有点想通了。我想我可能是 viewbag.eventss = event; 中的事件。然后在 html 中使用它作为 foreach 循环

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:43:11.667

根据我对您需要实现的目标的假设，如果您已经将 JSON 反序列化为，`List<Event>`那么您所需要的只是一个使用的视图，`IEnumerable<Event>`并且您操作的最后一行`GetEvent`将类似于：

```
return View("MyEventListingView", events); 
```

这应该呈现你的`MyEventListingView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T12:03:35.613

首先，您不需要完成所有反序列化工作，ASP.NET MVC 框架具有`JsonValueProvider`帮助您通过模型绑定将输入 JSON 自动序列化为对象或集合的功能。

例如。如果您有一个允许某人编辑员工详细信息并将信息作为 JSON 提交给操作的表单`Edit`，那么您所要做的就是

```
[HttpPost]
public ActionResult Edit(Employee employee)
{
  .. save to db
} 
```

内置模型绑定功能`JsonValueProvider`会自动创建`Employee`并填充请求中可用的 json 数据的详细信息。因此，您无需`JavaScriptSerailizer`直接使用并完成所有这些工作。

其次，当您想从控制器操作传递一些数据以查看时，您可以通过不同的方式进行操作，但我建议使用强类型视图，以便您可以将其传递`List<Event>`给显示它们的视图，如下所示

```
return View(events); 
```

您应该避免`ViewData/ViewBag`在这些情况下使用。

# android - 显示具有多个航点的两点之间的路线

> ID：11039647
> 
> 赞同：4
> 
> 时间：2012-06-14T19:00:23.063
> 
> 标签：android, google-maps, google-maps-mobile

我是 android 新手，正在为 android 开发基于导航的应用程序。我的问题是我想在 Google 地图中显示一条在源节点和目标节点之间具有多个航路点的路线，但我不知道该怎么做。我已经搜索过这个，但大多数结果都是针对两点的。

请帮我解决我的问题

例如：- 当应用程序用户提交带有一些航点的目的地时，地图应在手机上显示从源到目的地的路线以及这些航点。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:19:12.597

“我已经搜索过这个，但大多数结果都是两点。” 您已经找到了执行此操作所需的一切。

为此，您不是“沿途绘制航路点”，您实际上必须为您拥有的每个航路点绘制 2 个点之间的路线：

IE。你想从 A 点到 D 点，途中有 B 点和 C 点。解决方法是画一条从 A 到 B，B 到 C，最后 C 到 D 的路线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T05:56:20.523

我不认为 Maps 意图提供这些功能，但您确实有一些其他选择

更好但更多的工作 1）创建您自己的地图活动，显示多地点的路线（使用地图视图和覆盖）。 以下是如何将 kml 文件转换为路线[的示例](https://stackoverflow.com/questions/3109158/how-to-draw-a-path-on-a-map-using-kml-file)

更快更容易 2）创建一个简单的 web 视图（或者您可以只使用给定的 url 意图一个新的）并动态构建带有航点的 google maps api 请求的 url。有关通过航点获取带有路线的地图的文档，请参阅[Google 的网站。](https://developers.google.com/maps/documentation/directions/#RequestParameters)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T13:08:01.237

您可以像这样使用地图意图：

```
 String address = "http://maps.google.com/maps?daddr=" + "Latitude" + "," + "Longitude" + "+to:" +"Latitude" + "," + "Longitude";
    Intent intent = new Intent(android.content.Intent.ACTION_VIEW, Uri.parse(address));                                                         
    startActivity(intent); 
```

在这种情况下，起点将是您当前的位置，您可以使用“+to:”添加任意数量的中间点

# .net - (string[] args) 和 System.Environment.CommandLine 有什么区别？

> ID：11039649
> 
> 赞同：8
> 
> 时间：2012-06-14T19:00:28.407
> 
> 标签：.net, parameters, command-line-arguments

我继承了几个控制台应用程序的维护，这些应用程序自然是使用`static void Main(string[] args)`. 但是，代码忽略了`args`数组，而是从`System.Environment.CommandLine`.

这里有功能差异吗？

内容看起来一样。如果有的话，我会怀疑调用会对性能造成一分钟的打击`System.Environment.CommandLine`（但还不足以让我担心或关心到足以衡量）。

* * *

更新：我怀疑它`System.Environment.CommandLine`应该包含可执行路径，但我没有看到它......因为我找错了地方。代码 ALSO 有`string[] arrCmdLine = System.Environment.GetCommandLineArgs();`....`System.Environment.CommandLine.ToLower()`检查是否存在“调试”，而所有其他参数都从中提取`GetCommandLineArgs()`，我在精神上将两者混为一谈，而我正在“为什么不只是使用`args[]`？”

多年来，我一直在为解析命令行参数的最佳方式而苦恼，而一直以来都是“将它们按正确的顺序放置！” [jk]

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-14T19:02:55.130

`System.Environment.CommandLine`包括作为单个字符串的可执行文件和参数。

```
// Sample for the Environment.CommandLine property.
using System;

class Sample 
{
    public static void Main() 
    {
        Console.WriteLine();
        //  Invoke this sample with an arbitrary set of command line arguments.
        Console.WriteLine("CommandLine: {0}", Environment.CommandLine);
    }
}

/*
This example produces the following results:

C:\>env0 ARBITRARY TEXT

CommandLine: env0 ARBITRARY TEXT
*/ 
```

[http://msdn.microsoft.com/en-us/library/system.environment.commandline.aspx](http://msdn.microsoft.com/en-us/library/system.environment.commandline.aspx)

参数是一个`args`参数数组。因此，虽然您可以解析 中的各个参数`System.Environment.CommandLine`，但我不确定您为什么要这样做。我能看到的唯一原因是您是否需要访问 之外的参数`Main()`，无论如何这可能是个坏主意。您的`Main()`方法应该处理参数并根据需要将它们传递给应用程序的其余部分。

# go - 添加一个从未调用过的函数可以改善行为？

> ID：11039652
> 
> 赞同：1
> 
> 时间：2012-06-14T19:00:46.930
> 
> 标签：go

下面的代码产生了不受欢迎的

> [20010101 20010102]。

当取消注释 String 函数时，它会产生更好的效果（但不是我的实现）：

> [{20010101 1.5} {20010102 2.5}]

但是，永远不会调用 String func。我看到 DateValue 中的 Date 是匿名的，因此`func (Date) String`DateValue 正在使用它。

所以我的问题是：

1) 这是语言问题、`fmt.Println`实现问题还是其他问题？注意：如果我从以下位置切换：

```
func (*DateValue) String() string 
```

至

```
func (DateValue) String() string 
```

我的函数至少被调用并且随之而来的是恐慌。因此，如果我真的想要调用我的方法，我可以这样做，但假设 DateValue 确实是一个非常大的对象，我只想通过引用传递它。

2) 将匿名字段与 Stringer 和 json 编码等在幕后使用反射的功能混合在一起的好策略是什么？例如，为碰巧用作匿名字段的类型添加 String 或 MarshalJSON 方法可能会导致奇怪的行为（就像您只打印或编码整体的一部分）。

```
package main

import (
    "fmt"
    "time"
)

type Date int64

func (d Date) String() string {
    t := time.Unix(int64(d),0).UTC()
    return fmt.Sprintf("%04d%02d%02d", t.Year(), int(t.Month()), t.Day())
}

type DateValue struct {
    Date 
    Value float64
}

type OrderedValues []DateValue

/*
// ADD THIS BACK and note that this is never called but both pieces of
// DateValue are printed, whereas, without this only the date is printed
func (dv *DateValue) String() string {
    panic("Oops")
    return fmt.Sprintf("DV(%s,%f)", dv.Date, dv.Value )
}
*/

func main() {
    d1, d2 := Date(978307200),Date(978307200+24*60*60)
    ov1 := OrderedValues{{ d1, 1.5 }, { d2, 2.5 }}
    fmt.Println(ov1)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:22:14.407

这是因为您传入了一个 DateValues 切片，而不是 DateValue 指针。由于您已经为 定义了 String 方法`*DataValue`，`*DateValue`因此实现了 Stringer 接口。这也阻止了 DateValue 通过其匿名 Date 成员实现 Stringer 接口，因为只有值类型 ( `DateValue`) 或指针类型 ( `*DateValue`) 之一可用于实现接口。因此，当 fmt.Println 打印切片的内容时，它会看到元素不是 Stringers，并使用默认的结构格式而不是您定义的方法，给出`[{20010101 1.5} {20010102 2.5}]`.

您可以将 OrderedValues 设为 a`[]*DateValue`或定义`func (dv DateValue) String() string`，而不是指针版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T02:34:12.317

Based on what @SteveM said, I distilled it to a simpler test case:

```
package main

import "fmt"

type Fooable interface {
  Foo()
}

type A int

func (a A) Foo() { }

type B struct {
  A
}

// Uncomment the following method and it will print false
//func (b *B) Foo() { }

func main() {
  var x interface{} = B{}
  _, ok := x.(Fooable)
  fmt.Println(ok) // prints true
} 
```

In other words, the `Foo` method is not part of the method set of `B` when the `Foo` method for `*B` is defined.

From reading the spec, I don't see a clear explanation of what is happening. The closest part seems to be in the section on [selectors](http://golang.org/ref/spec#Selectors):

> For a value x of type T or *T where T is not an interface type, x.f denotes the field or method at the shallowest depth in T where there is such an f.

The only way I can see this explaining what is going on is if when it is looking for a method `Foo` at shallowest depth in `B`, it takes into consideration the methods for `*B` too, for some reason (even though we are considering type `B` not `*B`); and the `Foo` in `*B` is indeed shallower than the `Foo` in `A`, so it takes that one as the candidate; and then it sees that that `Foo` doesn't work, since it's in `*B` and not `B`, so it gets rid of `Foo` altogether (even though there is a valid one inherited from `A`).

If this is indeed what is going on, then I agree with the OP in that this is very counter-intuitive that *adding* a method to `*B` would have the reverse consequence of *removing* a method from `B`.

Maybe someone more familiar with Go can clarify this.

# javascript - .show().clone() html 不同于 .clone().show()

> ID：11039653
> 
> 赞同：2
> 
> 时间：2012-06-14T19:00:48.817
> 
> 标签：javascript, jquery

我正在谈论的示例：http: [//jsfiddle.net/bsnxp/1/](http://jsfiddle.net/bsnxp/1/)

如果您检查来源`.show().clone()` `display`是`inline-block`（应该是什么）和`.clone().show()`是`display: block`（不是应该是什么）。

jQuery`.show`文档 (http://api.jquery.com/show/) 说“这大致相当于调用`.css('display', 'block')`，除了 display 属性恢复到最初的样子”。

克隆是否有理由从内存中删除原始 CSS 显示属性是什么？有没有比使用 .show().clone() 然后 .hide() 更好的方法来绕过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:05:22.043

`.clone`没有任何参数不会复制元素的数据 - 其中包括有关最初显示内容的信息。

也用于`.clone(true)`克隆数据。

[http://api.jquery.com/clone/](http://api.jquery.com/clone/)的文档`.clone()`

# php - php找出第二场比赛

> ID：11039655
> 
> 赞同：1
> 
> 时间：2012-06-14T19:00:57.163
> 
> 标签：php, preg-match-all

我试图从一个网站上抓取一些图片，但由于文件扩展名不同而被难住了......

我在 preg_match_all() 中有 2 个匹配项

```
if (preg_match_all('~http://foo.com/foo_(.*?).(.*?)~i', $returned_content, $matches)) { 
```

第一个是 img 名称，第二个是 img 扩展名，想弄清楚每个扩展名是什么，以便稍后在代码中使用它：

**更新，完整代码：**

```
 //cURL function here get_data()

 $returned_content = get_data('http://foo.com/page/2');

        if (preg_match_all('~http://foo.com/foo_(.*?)\.(.*?)~i', $returned_content, $matches)) {

   foreach ($matches[1] as $key) {

    $file = 'http://foo.com/foo_' . $key . 'correct extension';// Need to have correct extension here
        echo '<img src="' . $file . '" alt="" />';
           }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:06:05.753

```
<?php
$returned_content = "sdfasdfsdfshttp://foo.com/foo_sdfsdfsdf.fdfdsf";
preg_match_all('~http\://foo\.com/foo_(.*?)\.(.*?)$~i', $returned_content, $matches);
print_r($matches); 
```

退货

```
Array
(
[0] => Array
    (
        [0] => http://foo.com/foo_sdfsdfsdf.fdfdsf
    )

[1] => Array
    (
        [0] => sdfsdfsdf
    )

[2] => Array
    (
        [0] => fdfdsf
    )

) 
```

除非：和。位于字符块 []、: 和 . 被用作修饰符，它们必须被转义。

# javascript - 如何使用 JQuery/Javascript 检查选择框是否为空

> ID：11039658
> 
> 赞同：37
> 
> 时间：2012-06-14T19:01:13.680
> 
> 标签：javascript, jquery, html, jquery-mobile, jquery-selectbox

我有一个从数据库动态填充的选择框。截至目前，此复选框的人口工作完美无缺。

我添加了一个由点击调用的按钮组成的功能`isSelextBoxEmpty`。这个函数的工作是知道这个特定的复选框是否已经被填充；如果它没有，那么它将什么也不做。

**我的问题**是确定此选择框是否为空。

这是我正在处理的一个非常简化的示例：

```
<li>
    <label for="fruit_name">Fruit</label>
    <select name="some_fruit" id="fruit_name" onclick="populate_box('fruit', this);">
    </select>
</li> 
```

我的函数是从一个单独的按钮调用的，如下所示：

```
function isSelextBoxEmpty(selectBoxId) {
    var selected_value = $('#fruit_name');

    /* More options... still testing the proper way:
    var selected_value = $('#fruit_name').text;
    var selected_value = $('#fruit_name').value;
    var selected_value = $('#fruit_name').length;
    var selected_value = $('#fruit_name option:selected', this);
    var selected_value = document.getElementById('fruit_name');
    var selected_value = document.getElementById('fruit_name').length;
    var selected_value = document.getElementById('fruit_name').value;
    var selected_value = document.getElementById('fruit_name').innerHTML;
    */

    if (selected_value) {
        alert("NOT null, value: " + selected_value);
        // do something
    }
} 
```

不要担心这是做什么以及它是如何做到的。现在对我来说重要的是我无法检查复选框是否为空，我只是不知道该怎么做。我通过论坛和文档阅读了很多，但是这样做有很多含义，因为它取决于实现本身。

例如 using`document.getElementById(...)...`不一定会返回 false ，这取决于您如何使用它。在 jQuery 中使用`$("#someID")...`也可能会或可能不会产生所需的结果。*正如您在注释行*中看到的那样，我已经尝试了许多不同的时间，所有这些都可以在`if(...)`语句中进行评估。

您对如何实现这一目标有任何建议或想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-06-14T19:06:23.937

检查选择框是否有任何值：

```
if( $('#fruit_name').has('option').length > 0 ) { 
```

检查所选值是否为空：

```
if( !$('#fruit_name').val() ) { 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-14T19:04:27.507

获得选定值的一种正确方法是

```
var selected_value = $('#fruit_name').val() 
```

然后你应该做

```
if(selected_value) { ... } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-25T19:21:07.710

获取选定值的另一种正确方法是使用此选择器：

```
$("option[value="0"]:selected") 
```

最适合你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-13T09:22:49.487

检查这个答案，它经过测试并且运行良好

```
if( !$('#id').val() ) {
   // stuff here
} 
```

# installation - 使用 Powershell 安装 Microsoft 补丁

> ID：11039659
> 
> 赞同：0
> 
> 时间：2012-06-14T19:01:17.320
> 
> 标签：installation, powershell-2.0, windows-update

我正在编写一个脚本来在 Windows 机器上安装补丁。我能找到的最佳方法是：

1) 映射网络驱动器 2) 复制文件 3) 安装文件 4) 清理和记录 5) 删除网络驱动器

除了数字 3，我可以完成所有这些操作。如何通过 powershell 远程安装/执行文件？我想避免使用 PSEXEC；我想使用 powershell 提供的所有功能。

另外，有没有比我看到的更好的方法？我想最终将其扩展为可以审核并查看安装了哪些补丁的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:24:25.423

只要您启用了远程处理，invoke-item/invoke-command 应该可以工作（取决于补丁的打包方式）。

但是，您似乎正在尝试为上一段中已经解决的问题设计解决方案。[WSUS](http://technet.microsoft.com/en-us/windowsserver/bb332157.aspx)和[SCCM](http://www.microsoft.com/en-us/server-cloud/system-center/configuration-manager-2012.aspx)（或 System Center，正如他们现在所说的那样）旨在完全按照您的要求进行。

# tfs - TFS 签入策略 - 强制运行 shell 命令

> ID：11039661
> 
> 赞同：1
> 
> 时间：2012-06-14T19:01:24.680
> 
> 标签：tfs, checkin

在我目前正在工作的项目中，我需要在签入 TFS 之前对一些静态文件运行 shell 命令。

是否可以使用 TFS 签入策略强制开发人员在签入*之前*运行 shell 脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:58:37.960

签入政策就是为此目的而设计的：检查某些内容以“授权”签入。

你会在[这里](http://msdn.microsoft.com/en-us/vstudio/gg602484.aspx)找到一个关于如何开发的有趣视频。你会发现它真的很简单，一旦你做了你的第一个，你会想要定制更多的 TFS。

在您的情况下，您将有两个选择（恕我直言）：

1.  在签入策略的 Evaluate 方法中运行 shell 命令。
2.  检查用户是否在 Evaluate 方法中手动运行了 shell 命令。

第一个应该是最好的，但它让我有点困扰，因为预先执行任务并不是签入策略的真正目的，但我想不出为什么它不应该工作。也许你必须这样做，因为第二种解决方案是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T07:24:22.337

最后，我们不需要使用签入策略。

相反，当我发现`tf.exe checkin`从命令提示符运行时，没有任何进一步的参数，会导致 TFS 签入对话框弹出。

这意味着我们可以在运行的 shell 脚本末尾添加一个额外的步骤：

```
C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\tf.exe checkin 
```

# android - 显式上下文菜单调用在 Android 中不时起作用

> ID：11039664
> 
> 赞同：0
> 
> 时间：2012-06-14T19:01:34.043
> 
> 标签：android, contextmenu

我想在用户按下菜单按钮时显示上下文菜单。我找到并使用了以下代码片段：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)
{
  if((keyCode == KeyEvent.KEYCODE_MENU) && event.getRepeatCount() == 0)
  {
    ImageView v = (ImageView)findViewById(IMAGE_ID);
    Log.v("me", "menu " + v.toString());
    openContextMenu(v);
  }
  return true; // return false; doesn't work either
} 
```

该视图当然是为上下文菜单注册的，并且通过长按可以正常工作。问题是上述代码只能不时工作。也就是说，当我按下菜单按钮时，总是会触发日志消息，但在极少数情况下会显示上下文菜单。显示正常的唯一情况是在应用程序启动之后。换句话说，只有第一次尝试是成功的，其他的都是偶尔工作的，但大部分都没有。视图不会更改并且始终可以找到，否则可能会在日志记录行中产生此类问题和异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-15T21:17:24.497

事实证明，有一个错误`onCreateContextMenu`会阻止上下文菜单不时显示。事实上，它并没有用项目填充菜单，并且在 Android 的核心设计中会跳过一个空菜单。现在它按预期工作。

# mapreduce - 写入 HBASE 中的多个表

> ID：11039668
> 
> 赞同：3
> 
> 时间：2012-06-14T19:01:58.813
> 
> 标签：mapreduce, hbase

我在这里遇到一种情况，我需要写入两个 hbase 表，比如 table1，table 2。每当表 1 上发生写入时，我需要对表 2 执行一些操作，比如在表 2 中增加一个计数器（比如触发） . 为此，我需要在 map-reduce 程序的同一任务中访问（写入）两个表。我听说可以使用 MultiTableOutputFormat 来完成。但我找不到任何详细解释的好例子。有人可以回答是否可以这样做。如果是这样，我该怎么做/应该做。提前致谢。

请给我一个不应该包括协处理器的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-08T05:52:47.840

要在 map-reduce 作业中写入多个表，您必须在作业配置中指定。你是对的，这可以使用 MultiTableOutputFormat 来完成。通常对于您使用的单个表，例如：

```
TableMapReduceUtil.initTableReducerJob("tableName", MyReducer.class, job); 
```

而不是这样写：

```
job.setOutputFormatClass(MultiTableOutputFormat.class);
job.setMapperClass(MyMapper.class);
job.setReducerClass(MyReducer.class);
job.setNumReduceTasks(2);
TableMapReduceUtil.addDependencyJars(job);
TableMapReduceUtil.addDependencyJars(job.getConfiguration()); 
```

现在在表中写入数据时写为：

```
context.write(new ImmutableBytesWritable(Bytes.toBytes("tableName1")),put1);
context.write(new ImmutableBytesWritable(Bytes.toBytes("tableName2")),put2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T04:32:41.163

为此，您可以使用 HBase Observer，您必须创建一个观察者并且必须部署在您的服务器上（仅适用于 HBase 版本>0.92），它将自动触发到另一个表。
而且我认为 HBase Observer 具有类似 Aspects 的类似概念。
有关更多详细信息 -
[https://blogs.apache.org/hbase/entry/coprocessor_introduction](https://blogs.apache.org/hbase/entry/coprocessor_introduction)

# jquery - 如何让 div 从右到左滚动 jQuery 动画？

> ID：11039672
> 
> 赞同：0
> 
> 时间：2012-06-14T19:02:11.030
> 
> 标签：jquery, scroll

我想让图像（和/或单个宽图像）在幻灯片放映中从右到左缓慢移动，然后在鼠标悬停时暂停。我还想要左右箭头，这将在单击时改变幻灯片的方向。我不确定这叫什么或如何做。

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T12:53:38.603

使用 scrollLeft 向左或向右滚动 与当前问题没有太大关系，但肯定对其他用户有所帮助..

```
 $(document).ready(function () {

     // Creating two Left Right Scroll Button through JQuery
        var  btnRht= $("<input type='button' id='btnLeft' value='>>' class='ButtonStyle' width='5px' />");
     var  btnLeft = $("<input type='button' id='btnRight' value='<<' class='ButtonStyle' />");
           // appending buttons to a td inside a html div 
        $('#tdDoE').append(btnLeft);
    $('#tdDoE').append(btnRht);
    // Left / Rht Scroll scroll     
                $("#btnLeft").click(function () { 
                var leftPos = $('.DivDataMain').scrollLeft();
                $(".DivDataMain").animate({scrollLeft: leftPos + 250}, 600);
                });   
                    $("#btnRight").click(function () { 

                var leftPos2 = $('.DivDataMain').scrollLeft();
                $(".DivDataMain").animate({scrollLeft: leftPos2 - 250}, 600);
                });   

    }); 
```

HTML 代码：-

```
 <div style="width: 300px; overflow: hidden;" class="DivDataMain">
        <table>
            <tr>
                <td id="tdDoE">
                        Scroll Buttons will be appended after this text.
                </td>
            </tr>
        </table>
    </div> 
```

# objective-c - 从自定义 UITableViewCell 调用 UITableViewController 中的方法

> ID：11039676
> 
> 赞同：1
> 
> 时间：2012-06-14T19:02:24.993
> 
> 标签：objective-c, ios, uitableview, encapsulation

我需要调用一个方法并将一个对象从我的自定义`UITableViewClass`实现传递给我的`UITableViewController`类。我意识到在自定义 tableViewCell 中创建 tableViewController 的实例并调用 tableViewController 的方法是一种不好的做法。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:10:33.653

Objective-C 中的两个神奇概念是[委托](https://stackoverflow.com/questions/626898/how-do-i-create-delegates-in-objective-c)和[通知](https://stackoverflow.com/questions/2191594/how-to-send-and-receive-message-through-nsnotificationcenter-in-objective-c)。

委托允许您将控制器挂钩到单元格中引用的弱对象，这避免了保留周期，同时仍允许您向其发送消息。

通知允许您的 Cell 向任何处于活动状态并正在侦听它的类广播一般通知。

选择一个，无论哪个最简单，坚持下去。在这种情况下，两者基本相等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:10:46.930

在单元格内引用 tableController 确实是不好的做法

`@protocol`你可以通过为你实现一个特殊的`UITableViewClass` And 添加一个委托方法来解决这个问题，然后在里面实现这个方法`UITableViewController`，因为你的`UITableViewClass`委托是你的`UITableViewController`，那么你可以像在 UITableViewClass.m 中一样调用它

```
[delegate someMethod:data]; 
```

# c# - 当底层组合框项目描述更改时，组合框文本字段中的绑定不更新

> ID：11039678
> 
> 赞同：1
> 
> 时间：2012-06-14T19:02:25.747
> 
> 标签：c#, wpf, xaml, binding, wpf-controls

我的 ComboBox 出现绑定更新问题。我的 ComboBox 的 ItemSource 绑定到 LaneConfigurations 列表。ComboBox 的 SelectedItem 绑定到我的代码隐藏中的 SelectedLaneConfiguration 属性。我将 ComboBox 的 ItemTemplate 配置为显示每个 LaneConfiguration 的“DisplayID”属性。

这在大多数情况下都有效。但是，更改通道配置可能会导致 DisplayID 更改。如果您选择了一个特定的车道，并且它的 DisplayID 显示为 ComboBox 的“文本”，然后您更改了 LaneConfiguration 对象，则组合框的“文本”部分不会更新为应该显示的新“DisplayID” . 当我单击组合框上的下拉箭头时，在列表中显示为所选项目的项目显示正确的 DisplayID，但这与组合框顶部的“文本”中显示的“显示 ID”不匹配' 场地。

在我后面的代码中，我在“SelectedLaneConfiguration”属性上触发了一个 PropertyChanged 事件。如何让 ComboBox 意识到“DisplayID”属性需要更新？我试图为“DisplayID”属性触发一个 PropertyChanged 事件，但它是 LaneConfiguration 类的一部分，因此它似乎没有更新。

我在下面包含了 XAML 以及显示 ComboBox 文本显示与 ComboBox 下拉列表内容不同步的屏幕截图。

![截屏](../Images/3989f795d8c2acad9b1905c1bcb438d3.png)

部分 XAML：

```
<ComboBox x:Name="_comboBoxLanes" Height="26"
          ItemsSource="{Binding SensorConfiguration.LaneConfigurations}" 
          SelectedItem="{Binding Path=SelectedLaneConfiguration}">
     <ComboBox.ItemTemplate>
        <DataTemplate>
           <TextBlock Text="{Binding DisplayID, Mode=OneWay}"/>
        </DataTemplate>
     </ComboBox.ItemTemplate>
</ComboBox> 
```

一些代码隐藏：

```
 public partial class LaneManagement : INotifyPropertyChanged, IDisposable
    {
        ..
        ..

        public event PropertyChangedEventHandler PropertyChanged;

        private void FirePropertyChanged(string prop)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(prop));
            }
        }

        private void SensorConfiguration_Changed()
        {
            LaneTools.ResetLanePolygons();
            GenerateLaneTypeDropdowns();
            FirePropertyChanged("SensorConfiguration");
            FirePropertyChanged("SelectedLaneConfiguration");
            FirePropertyChanged("DisplayID");
        }
   }

   public class LaneConfiguration : PolygonConfiguration
   {
       public override string DisplayID
       {
          get
          {
              return IsLaneGroup?string.Format("Lanes {0} - {1}", ID, ID + LaneCount - 1):                                  string.Format("Lane {0}", ID);
          }
       }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T19:10:49.323

我为此创建了一个较短的示例并重新发布并得到了[答案](https://stackoverflow.com/a/11056423/1342454)。

我以为我只需要 INotifyPropertyChanged 在代码隐藏。我实际上在我的数据对象 LaneConfiguration 类中也需要它。我应该更加关注 Ali Adl 的评论。它会为我节省一天的挫败感..

感谢 Ali Adl 和 Tim 的有用回答！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T06:54:52.147

正确的方法是使您绑定的属性 - DependencyProperty - 自动更新不会有任何问题。

如果您使用 INotifyPropertyCahgnge ，则它必须有效，否则 - 检查 PropertyChanged 事件是否 == null。

# c# - 给定数据库架构，以编程方式生成 EF 源代码

> ID：11039679
> 
> 赞同：1
> 
> 时间：2012-06-14T19:02:26.243
> 
> 标签：c#, database, entity-framework

我们有一个由数据库设计驱动的项目。当有人进行数据库修改时，我想更新我的 EF 代码。所以，我想知道是否有一种方法可以在给定数据库连接字符串的情况下以编程方式生成 EF 源代码。然后，我计划将此生成的 EF 源代码附加到我的解决方案中。我现在不需要一个确切的解决方案，但如果有人能指出我正确的方向，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T21:47:25.167

实体框架开发有三种方法：数据库优先、模型优先和代码优先。您首先使用数据库。

[实体框架开发方法](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application)

我推荐 Julia Lerman 的书 Programming Entity Framework 2nd Edition。

我链接到的教程是针对 Code First 的，但它很好地介绍了存储库和工作单元模式，在使用这三种方法中的任何一种时，您都想知道这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:06:21.767

您可以查询 SQL Server 系统表并以这种方式生成代码，可能使用 XML 和 XSLT 或 T4 模板。

[http://msdn.microsoft.com/en-us/library/ms189082(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms189082(v=sql.105).aspx)

# tfs - 具有更多受让人的 TFS 任务

> ID：11039682
> 
> 赞同：2
> 
> 时间：2012-06-14T19:02:40.450
> 
> 标签：tfs

在 TFS 2010 中为多个用户存储任务的最佳方式是什么？我只能为一项任务分配一个。

（例如：当我计划向所有开发人员演示时）

（这是一个 Scrum Msf 敏捷项目，其中任务是用户故事的一部分）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T20:59:55.637

很遗憾地告诉您，您不能将多个用户分配给一个开箱即用的工作项。同时，我不建议这样尝试，因为它不适合 TFS 中的模型。处理此类场景的常规/推荐方法是创建多个任务；在这种情况下，每个开发人员都有一个。您可以通过使用 MS Excel 复制一组任务轻松完成此操作。另一种选择（给定您使用的示例）是创建一个具有多个下拉列表的“会议”工作项 - 每个人都将参加演示或技术审查等会议。

另一种选择是创建一个自定义控件来格式化和存储用户列表。维护起来可能相对复杂，因为您必须将其分发到每个用户的机器上（需要在本地安装），最后我检查您是否需要 2 个版本；一个用于 Team Explorer 用户界面，另一个用于 Web 访问工具，大多数人使用该工具从其 TFS 服务器上的网页创建工作项。TFS 的未来更新可能会破坏您的自定义控制。很少值得付出努力。另一个缺点是，您可能会受到如何使用 MS Excel 处理存储在自定义控件使用的字段中的数据的限制。如果您想进一步研究，可以在以下 CodePlex 项目中找到一些示例：[http ://witcustomcontrols.codeplex.com/](http://witcustomcontrols.codeplex.com/)

您可能会考虑跟踪您想要分配多人的会议和其他项目等事情的真正目标。任务是跟踪 MSF 敏捷模板中用户故事进度的核心。例如，跟踪会议出席情况通常与用户故事没有直接关系；因此它通常不会帮助您确定您离“完成”用户故事还有多远。如果您想利用现有报告，那么您应该组织您的任务，以便它们作为子工作项汇总到用户故事（或错误）工作项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:47:56.560

短篇小说：你不能。Microsoft 流程模板中的工作项旨在针对任何人或仅针对一个用户。

现在您可以自定义流程模板来更改它。以[这篇文章](http://ivanfioravanti.wordpress.com/2011/04/04/assigning-a-work-item-to-a-group-in-tfs/)为例，自定义适用于组。但我不建议您这样做，因为 TFS 基本上不是为此而设计的，您最终可能会感到失望。

# xcode - 将原型单元与 xcode 4 中的 plist 连接起来

> ID：11039684
> 
> 赞同：1
> 
> 时间：2012-06-14T19:02:57.303
> 
> 标签：xcode, properties, uitableview, nsdictionary

我正在制作我的第一个 iphone 应用程序，它是一个葡萄酒图表应用程序。它与 xcode 4.2 中的故事板一起使用。它基于一个带有 4 个选项卡的选项卡栏：信息、葡萄酒图表、搜索、收藏夹。我现在正在制作葡萄酒图表，在这个选项卡中，我放置了一个带有原型单元格的 TableView，我想用葡萄酒的名称、地区和图像填充这个单元格。到目前为止，我已经这样做了：

1：将第二个选项卡链接到导航控制器

2：将导航控制器链接到TableView（WinesViewController）

3：创建 WinesViewController.h/.m 类

4：添加了一个带有标识符的原型单元格：wineCell 和带有文本的标题和副标题标签：名称和地区。

5：制作一个包含所有瓶子WineName.png图像的文件夹

6：创建了一个 plist：Wine.plist，每个酒有 1 个字典，字典键 = 酒名。字典包含 19 个字符串，键为“Name”、“District”、“Image”、“Acid level”等。

这是列表：

[http://www.flickr.com/photos/80427098@N07/7372450200/in/photostream](http://www.flickr.com/photos/80427098@N07/7372450200/in/photostream)

这就是我到目前为止所做的一切，现在我想用 plist 中的字符串填充 tableview 中的单元格标签，按字母顺序按部分排序。我是新手，所以我不知道要使用哪些代码以及将它们放在哪里。有人可以帮助我更多地了解如何使用 plist 中的信息填充 tableview 吗？

有人告诉我，我不应该将代码直接放在 WinesViewController.h/.m 中。然后我被告知我可以创建一个 NSObject 的子类（我们称之为 WineObject.h/.m），在这里放一些 NSDictionary / NSEnumerator 代码，然后以某种方式将其链接到 WinesViewController 原型单元。但我真的不知道怎么做！我还没有那么有经验！我真的希望有人可以帮助我解决代码，将它们放在哪里以及如何将它们链接起来。那将是太棒了。我现在开始有点了解 X-Code 和 Objective C 编码（终于！），但这还很先进，现在我被困住的一些帮助会给我很多工作！对有用的教程、示例项目等的指导也值得赞赏。

让我知道您是否需要了解更多信息才能回答我的问题！我没有在 WinesViewController 或 WineObject 中写过一行代码，所以我真的需要完整的解释..

稍后我将在 DetailViewController 中使用来自同一 plist 的信息（带有葡萄酒信息的全屏视图），这就是为什么当我在 tableview 单元格中只使用 3 个值时 plist 中有这么多字符串的原因。搜索功能也将基于此 plist 中的数据进行。感谢您提供所有有用的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T04:54:40.140

你应该从阅读如何在 Objective-C 中使用[模型-视图-控制器范式开始。](https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/MVC.html)这将解释如何将您的数据与该数据的视图分开。一旦你理解了这一点，你就会更好地理解其余的内容。

我建议对您的 plist 文件进行一项更改。与其让顶层成为一个字典，其中每个酒名都是一个键，每个键的值是一个包含有关酒的信息的字典，我会让顶层成为一个字典数组。每一种酒都将是数组中的一个元素，并且将是一个字典，其中包含您当前拥有的所有信息以及酒的名称。这将更接近于您的数据模型的外观。像这样的东西：

```
<array>
    <dict>
        <key>Name</key>
        <string>J. P. Chenet Merlot</string>
        <key>Image</key>
        <string>JPChenet.png</string>
        ... the rest of the keys and values for this wine ...
    </dict>

    <dict>
        <key>Name</key>
        <string>Campo Viejo Crianza</string>
        ... the rest of the keys ...
    </dict>
</array> 
```

每个 wine 对象都将包含字典中每个元素的实例变量。（所以一个用于图像，一个用于名称，一个用于区域等）像这样的东西：

```
@class WineObject : NSObject { 
    NSString* name;
    NSString* imagePath;
    NSString* district;
    // ... etc.
}; 
```

您的模型可能只是`NSArray`. `WineObjects`您可以使用我在其他问题中提到的方法从 plist 中读取对象。它看起来像这样：

```
NSMutableArray* wineModel = [[NSMutableArray alloc] init];
NSArray* wines = [NSArray arrayWithContentsOfURL:<url of the plist file>];
NSEnumerator* wineEnum = [wine objectEnumerator];
NSDictionary* nextWine = nil;
while ((nextWine = [wineEnum nextObject]) != nil)
{
    // Get the wine data from the dictionary
    WineObject* newWine = [WineObject wineWithDictionary:nextWine];

    // Add the next wine to our model
    [wineModel addObject:newWine];
} 
```

然后，您的`WineObject`类将有一个类初始化程序，如下所示：

```
+ (id)wineWithDictionary:(NSDictionary*)wineDict
{
    name = [wineDict objectForKey:@"Name"];
    district = [wineDict objectForKey:@"District"];
    imagePath = [wineDict objectForKey:@"Image"];
    // ... extract the rest of the values from the dictionary ...
} 
```

# iphone - 如何实现 iPhone 应用的指令视图

> ID：11039685
> 
> 赞同：-1
> 
> 时间：2012-06-14T19:03:01.730
> 
> 标签：iphone, ios

我有 2 页我想在应用程序第一次运行时显示为说明。我将如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:06:20.080

你可以利用`NSUserDefaults`这样的东西。

```
 if(![[NSUserDefaults standardUserDefaults] boolForKey:@"didLoad"]) {

          //Show your instructions

       [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"didLoad"];
       [[NSUserDefaults standardUserDefaults] synchronize];

    } 
```

这样做是，检查`didLoad`布尔值是否为 FALSE（将在第一次加载时），如果是，则显示您的说明并将其设置`BOOL`为`YES`下一次启动。你可以把它放在你的`viewDidLoad`方法中。

# jquery - jquery 切换如何用于没有单个 id 的单个元素？

> ID：11039687
> 
> 赞同：0
> 
> 时间：2012-06-14T19:03:06.273
> 
> 标签：jquery, html, toggleclass

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>FAQ Section</title>
<link rel="stylesheet" type="text/css" href="styles.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){
  $("h2").click(function(){
    $("p").toggle("fast");
  });
}); </script>

</head>

<body>
    <h1>FAQ</h1>

  <div> 
    <!-- The FAQs are inserted here -->

      <h2>Question1?</h2>
      <p>Answer...</p>
      <h2>Question2?</h2>
      <p>Answer...</p>
      <h2>Question3?</h2>
      <p>Answer...</p>
  </div>

</body>

</html> 
```

这是我的示例页面：[http ://www.kursatkarabulut.com/kopya.html](http://www.kursatkarabulut.com/kopya.html)

我想要做的是我个人网站的常见问题解答页面。将有大约 40 个问题。我是 jQuery 的新手。我对每个问题都使用了切换。只有问题会在开始时显示，当用户点击一个问题时，它会显示在下方，再次点击它会隐藏。现在，当我单击一个问题时，它会扩展和收缩所有问题。

有没有办法在不为每个标题使用单独的 id 的情况下单独执行此操作？以及如何在关闭的情况下加载页面？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:09:11.970

试试这个...

```
 $("h2").click(function(){
    $(this).next().toggle("fast");
  }); 
```

这将使页面加载切换：

```
 $("h2").click(); 
```

或者，如果您不想在页面加载时切换动画，您可以这样做：

```
 $("p").toggle(); 
```

[有关工作示例，请参见此处](http://jsfiddle.net/GkpPn/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:09:20.323

尝试：

```
$("h2").click(function(){
    $(this).next().toggle("fast");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:11:17.930

试试这个

```
$(document).ready(function(){
  $("h2").click(function(){
    $(this).next("p").toggle("fast");
  });
}); 
```

# android - Eclipse 和 Android SDK（模拟器）在 Windows 或 Mac 机器上是否更快？

> ID：11039688
> 
> 赞同：1
> 
> 时间：2012-06-14T19:03:07.250
> 
> 标签：android, eclipse

我有 2 台机器，一台运行 Windows 7，另一台运行 Mac。两者的硬件配置几乎相同，2.4 4G RAM。

我注意到 android 模拟器在 Windows 7 中运行速度很慢，如果我在 Mac 机器上安装 Eclipse 和 Android SDK，它会运行得更快吗？

一般而言，Eclipse 和 Android SDK 怎么样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:16:48.887

我认为`android device`模拟器是更好的选择，它比模拟器快得多。如果您计划进行认真的开发，那么您应该购买一台 Android 设备。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:15:02.270

我有一台 13 英寸的 Macbook pro（2010 型号，2.4ghz，4 gig ram），模拟器运行速度很慢......我倾向于主要在我的 Linux 桌面上开发，这也是 2.4ghz 机器，而模拟器很慢，它仍然比 Mac 快得多。Eclipse 在两者上的运行大致相同......实际上 Mac 甚至可能会稍微快一些，因为它有一个 SSD。

我在观看其他 Mac 运行模拟器时的经验是，模拟器在 Mac 上运行速度很慢 :(

我知道谷歌最近更新了 ADK 以包括模拟器的速度改进，但我还没有尝试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T19:15:08.723

尝试在mac上运行它，我做了同样的事情，发现模拟器在mac上运行得比windows快得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-09T19:05:42.493

我有一台 2 年前的 Windows 7 笔记本电脑（8GB，i5）和 15 英寸 MacBook Pro 2012（16GB，i7）。我可能还注意到我主要是 .NET 开发人员，所以我应该偏向于 OSX。

我发现在mac上运行模拟器和ide比windows运行得快。我知道 mac 比我的 windows 盒子快得多，但是 eclipse/emulator 的速度差异并没有改变。模拟器运行更流畅。Eclipse 在我的 Mac 上编译得更快。调试器更快地建立/连接到硬件设备。

我在 Mac 上使用 Eclipse (Android SDK) 开发的体验比在 windows 上要愉快得多

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-01T04:31:04.387

我主要在运行 Windows 8 的桌面上开发，因为我们的大多数应用程序都是用 C# 编写的，我总是发现在三星 S3 和使用模拟器上调试都很痛苦。

我已经阅读过有关使用 Android SDK 下载器中提供的 Intel HAXM 的信息，但由于我也在桌面上使用 Hyper-V，因此从未启用它。

快进，我现在正在使用 MacBook Pro，因为还需要进行 iPhone 开发。我在 MacBook 上安装了 HAXM，它使 x86 Android 模拟器运行得非常快。

TLDR：在具有现代 CPU 的机器上安装 Intel HAXM，您会发现在您的机器上运行应用程序的速度明显更快。

如果您确实安装了 Hyper V，您可以通过创建一个引导项来临时禁用它，该引导项会导致 Windows 在禁用它的情况下启动。

# python - Python 机械化 javascript

> ID：11039693
> 
> 赞同：2
> 
> 时间：2012-06-14T19:03:21.137
> 
> 标签：python, mechanize, mechanize-python

我正在尝试使用机械化从该站点获取纽约地铁北部铁路的价格：http:
[//as0.mta.info/mnr/fares/choosestation.cfm](http://as0.mta.info/mnr/fares/choosestation.cfm)

问题是当您选择第一个选项时，该站点使用 javascript 来填充您的可能目的地列表。我已经在 python 中编写了等效的代码，但我似乎无法让它全部工作。这是我到目前为止所拥有的：

```
import mechanize
import cookielib
from bs4 import BeautifulSoup

br = mechanize.Browser()
br.set_handle_robots(False)
br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1)     Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]

br.open("http://as0.mta.info/mnr/fares/choosestation.cfm")

br.select_form(name="form1")
br.form.set_all_readonly(False)

origin_control = br.form.find_control("orig_stat", type="select")
origin_control_list = origin_control.items
origin_control.value = [origin_control.items[0].name]

destination_control_list = reFillList(0, origin_control_list)

destination_control = br.form.find_control("dest_stat", type="select")
destination_control.items = destination_control_list
destination_control.value = [destination_control.items[0].name]

response = br.submit()
response_text = response.read()
print response_text 
```

我知道我没有为您提供该`reFillList()`方法的代码，因为它很长，但假设它正确地创建了一个 mechanize.option 对象列表。Python 没有抱怨我任何事情，但是在提交时我得到了这个警报的 html：

“两条线路之间的票价信息无法在线获取。请致电 511 联系我们的客户信息中心，并要求与代表交谈以获取更多信息。”

我在这里错过了什么吗？感谢所有的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:29:34.993

如果您知道站 ID，则更容易自己发布请求：

```
import mechanize
import urllib

post_url = 'http://as0.mta.info/mnr/fares/get_fares.cfm'

orig = 295 #BEACON FALLS
dest = 292 #ANSONIA

params = urllib.urlencode({'dest_stat':dest, 'orig_stat':orig })
rq = mechanize.Request(post_url, params)

fares_page = mechanize.urlopen(rq)

print fares_page.read() 
```

如果您有代码可以找到给定起始 ID（即 的变体`refillList()`）的目标 ID 列表，则可以为每个组合运行此请求：

```
import mechanize
import urllib, urllib2
from bs4 import BeautifulSoup

url = 'http://as0.mta.info/mnr/fares/choosestation.cfm'
post_url = 'http://as0.mta.info/mnr/fares/get_fares.cfm'

def get_fares(orig, dest):
    params = urllib.urlencode({'dest_stat':dest, 'orig_stat':orig })
    rq = mechanize.Request(post_url, params)

    fares_page = mechanize.urlopen(rq)
    print(fares_page.read())

pool = BeautifulSoup(urllib2.urlopen(url).read())

#let's keep our stations organised
stations = {}

# dict by station id
for option in pool.find('select', {'name':'orig_stat'}).findChildren():
    stations[option['value']] = {'name':option.string}

#iterate over all routes
for origin in stations:
    destinations = get_list_of_dests(origin) #use your code for this
    stations[origin]['dests'] = destinations

    for destination in destinations:
        print('Processing from %s to %s' % (origin, destination))
        get_fares(origin, destination) 
```

# c++ - 结构错误：请求成员

> ID：11039694
> 
> 赞同：0
> 
> 时间：2012-06-14T19:03:27.330
> 
> 标签：c++, struct, compiler-errors

我正在制作一个程序来保存银行信息（即帐户、密码、余额）。我遇到了某个错误，但我不确定原因。

这是整个代码。

```
#include <iostream>
#include <string>
#include <fstream>
#include <cstdlib>

using namespace std;

int x = 0;

void addUser();
void login();
void deposit();
void withdrawl();

struct bankUser
{
    double balance;
    string account, password;
};

bankUser user[20];

int menu()
{
    ofstream myfile("bankmachine.txt", ios::app);
    char choice;

    cout << "1) Add account" << endl;
    cout << "2) Log in" << endl;
    cout << "3) Make deposit" << endl;
    cout << "4) Make withdrawl" << endl;
    cout << "5) Quit" << endl << endl;
    cout << "What would you like to do?: ";
    cin >> choice;
    cout << endl;

    switch (choice)
    {
        case '1':
            addUser();
            break;
        case '2':
            login();
            break;
        case '3':
            deposit();
            break;
        case '4':
            withdrawl();
            break;
        case '5':
            myfile << user[x].balance << endl;
            myfile.close();

            cout << "Thank you for using the banking system." << endl << endl;
            system ("pause");
            return 0;
            break;
        default:
            cout << "That is not a valid option. Please choose again." << endl << endl;
            menu();
    }
}

void addUser()
{
    if ((x >= 0) && (x < 20))
    {
        cout << "Please enter your desired account name: ";
        cin >> user[x].account; // Account name.
        cout << "Thank you, now please enter your desired password: ";
        cin >> user[x].password; // Account password.
        cout << "\nAccount created. You may now log in." << endl << endl;

        ofstream myfile("bankmachine.txt", ios::app); // Opens the text file at the end of the file (if data is already present).
        myfile << user[x].account << endl; // Writes to text file.
        myfile << user[x].password << endl; //  ^
        myfile.close(); // Close text file (important).

        x++; // Increases to simulate the addition of another user.
        menu();
    }

    else // Will display if user has entered 20 users.
    {
        cout << "You have entered the maximum number of users." << endl;
        menu();
    }
}

void deposit()
{
    int deposit;
    string answer;

    do
    {
        cout << "Please enter the amount of money that you would like to deposit: ";
        cin >> deposit;

        user[x].balance += deposit;

        cout << "Thank you. Your new balance is " << user[x].balance << "." << endl << endl;
        cout << "Would you like to make another deposit? (Y/N): ";
        cin >> answer;
    } while ((answer != "N") && (answer == "Y"));
    cout << endl;
    menu();
}

void withdrawl()
{
    int withdraw;
    string answer;

    do
    {
        cout << "Please enter the amount of money that you would like to withdraw: ";
        cin >> withdraw;

        if (withdraw <= user[x].balance)
        {
            user[x].balance -= withdraw;
        }

        else
        {
            cout << "\nSorry, you do not have sufficient funds to complete this withdrawl.\nPlease try again." << endl << endl;
            withdrawl();
        }

        cout << "Thank you. Your new balance is " << user[x].balance << "." << endl << endl;
        cout << "Would you like to make another withdrawl? (Y/N): ";
        cin >> answer;
    } while (answer != "N" && answer == "Y");
    cout << endl;
    menu();
}

void login() // Function to log in.
{
    string user, pw, usernameCheck, passwordCheck;
    double balance;

    cout << "Please enter your login information." << endl << endl;
    cout << "Account name: ";
    cin >> user;
    cout << "Password: ";
    cin >> pw;
    cout << endl;

    ifstream myfile("bankmachine.txt", ios::app);

    while (!myfile.eof()) // Loops until end of file.
    {
        getline(myfile, usernameCheck);
        if (usernameCheck == user)
        {
            getline(myfile, passwordCheck);
            if (passwordCheck == pw)
            {
                myfile >> balance;
                cout << "Login successful." << endl;
                cout << "Your balance is " << balance << "." << endl << endl;

                user[x].balance = balance;
            }

            else // If not, display:
            {
                cout << "Password incorrect." << endl << endl;
            }
        }
    }

    myfile.close(); // Close text file (important).
    menu();
}

int main()
{
    cout << "Welcome to the banking system." << endl << endl;
    menu();
} 
```

我不断收到此错误（第 172 行）：

```
request for member 'balance' in 'user.std::basic_string<_CharT, _Traits,
_Alloc>::operator[] [with _CharT = char, _Traits = std::char_traits<char>, _Alloc =
std::allocator<char>](((unsigned int)x))', which is of non-class type 'char'| 
```

这是什么原因造成的？我该如何解决？任何答案表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T19:06:28.880

从提供的错误来看，它似乎`user`不是类型`struct bankUser`，而是`std::string`.

您正在尝试将`std::string`( ) 分配给您named`balance`的偏移量处的字符，这注定会失败。`x``std::string``user`

^(**TL;DR** `user`未声明为`struct bankUser`.)

# c# - asp.net ListView 数字排序

> ID：11039700
> 
> 赞同：0
> 
> 时间：2012-06-14T19:03:45.723
> 
> 标签：c#, asp.net, listview, sorting, datatable

我有一个绑定到 DataTable 源的列表视图。排序工作，有点。

对于文本很好，但对于数字则不然。

例如，如果我对 1-12 进行降序排序，我得到 9,8,7,6,5,4,3,2,12,11,10,1。

如何获得正确的顺序？

我在用：

```
lvPos.Sort("Position", SortDirection.Descending); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:18:49.133

您可能不得不自己进行排序，而不是依赖 ListView 的排序方法。

如果您仅使用代码进行排序，这非常容易。只需将您的 DataTable 推入 DataView 并使用 DataView 的 Sort 方法。然后绑定到您的 DataView 而不是您的 DataTable。

```
var view = new DataView(dtTable);
view.Sort = "Position"; //or "Position DESC"
lvPos.DataSource = view;
lvPos.DataBind();  //use lvPos.DataBind(true) to raise the "OnDataBinding" event. 
```

如果您从 ListView 的排序方法进行排序（即，您在页面中有触发 ListView.Sorting/Sorted 事件的内容），那么您将不得不连接到 Sorting 事件并取消它。跟进之前将 DataTable 推入 DataView 的技术（或重新使用 DataView！），按新表达式排序，然后重新绑定数据。

```
private void lvPos_Sorting(object sender, ListViewSortEventArgs args)
{
   var view = new DataView(dtTable);
   view.Sort = args.SortExpression;
   lvPos.DataSource = view;
   lvPos.DataBind();
   args.Cancel = true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T21:51:17.407

像这样实际设置数据类型的最简单方法：

```
table.Columns[0].DataType = System.Type.GetType("System.Int32"); 
```

现在排序实际上按值将项目排序为整数，而不是字符串。

[看这里](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.datatype%28v=vs.71%29.aspx)

# php - PHP无法将文件从临时文件夹移动到指定文件夹

> ID：11039704
> 
> 赞同：1
> 
> 时间：2012-06-14T19:04:03.507
> 
> 标签：php

```
<?php
error_reporting(E_ALL);
include "func.php";
connectToDatabase("localhost","root","","test");
$fileName = $_FILES['name'];
$fileSize = $_FILES['size'];
$fileType = $_FILES['type'];
$fileTempName = $_FILES['temp_name'];
$uploaderID = $_SESSION['id'];
$date = date("d/m-Y");
$uploadDir = "avatarStor/";
$filePath = $uploadDir . $fileName;

if(!$fileName){
    echo "Error: value 'fileName' was undefined<br>";
}

$result = move_uploaded_file($fileTempName, $filePath);
if (!$result) {
    echo "Error: File could not be uploadet: ".$fileName;
    exit;
}

if(!get_magic_quotes_gpc()){
$fileName = addslashes($fileName);
$filePath = addslashes($filePath);
}

$result = mysql_query("UPDATE users SET profilepicture='$fileName' WHERE id='$uploaderID'") or die(mysql_error());

?> 
```

我无法`move_uploaded_file();`在此上传脚本中。我继续和`chmod 777`文件夹，但是，它失败了。PHP 在运行时不提供错误。 ![结果](../Images/cc7124b0c7c6ac1a0e005e81825043d1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T19:07:01.203

更改
`$fileTempName = $_FILES['temp_name'];`
为
`$fileTempName = $_FILES['that_input_name']['tmp_name'];`

# c# - 使用 WCF Duplex 回调更新 JQuery 进度条？

> ID：11039705
> 
> 赞同：3
> 
> 时间：2012-06-14T19:04:06.020
> 
> 标签：c#, jquery, .net, css, wcf

我在 IIS (.NET 4.x) 上托管了一个相当简单的 WCF 双工服务

一种特定的服务方法运行时间很长（1-3 分钟），当此方法由客户端触发时，**我想通过页面上的 JQuery 进度条向用户提供视觉反馈，该进度条基于期间传递的整数值进行更新多个回调。**

我愿意放弃双工实施，但当时这似乎是合乎逻辑的方法......

解决这个问题的最佳方法是什么，请记住，我想尽量减少开销，并且避免引入更多技术，如 silverlight（尽管我意识到这是解决这个问题的完美可行的解决方案）。

具体来说，一些代码示例可能会有所帮助。另请注意，我对 JQuery 和 WCF 都是新手。

*我不确定要提供哪些其他信息来使这个问题更清楚，所以如果您需要更多信息，请询问，我会修改原始问题。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T23:11:27.010

这在不迁移到 Silverlight 的情况下使用标准 WCF 是不可行的，因为您需要在浏览器中使用轮询双工通道。

[前段时间有一个 PollingDuplex 协议客户端的 AJAX 实现](http://tomasz.janczuk.org/2009/08/ajax-client-for-http-polling-duplex-wcf.html)，这将允许您更新客户端进度条以响应来自服务器的进度更新（有点 - 它仍然需要客户端轮询）。不确定它是否适用于最新版本的 PollingDuplex。

# data-warehouse - 维度建模 - 没有事实的查询

> ID：11039706
> 
> 赞同：2
> 
> 时间：2012-06-14T19:04:06.680
> 
> 标签：data-warehouse, dimensional-modeling

我正在为 VoIP 服务创建一个关于“通话记录系统”的维度模型。我将仅举一个小例子来说明我的问题。

假设我有一个代表单个呼叫的事实。我有一个维度叫做客户端，还有一个维度叫做提供者。（假设还有其他维度，例如日期，当然等等......）

```
(Dimension)Client ---> (Fact)Call <--- (Dimension)Provider 
```

有了这个，我将能够看到客户打了多少电话，或者通过提供商发送了多少电话，以及其他问题。

假设一个客户端与一个提供者相关联，一个提供者可以有多个客户端。

那么，问题来了。如何创建一个查询，例如：每个提供商有哪些客户？

这似乎是一个介于两个维度之间的查询。我不能涉及这个事实，因为如果客户从未使用过该服务，他将不会出现在调用事实表中，并且他不会出现在这个“每个提供商的客户”查询中。

我自己在想，一种方法是创建一个角色扮演维度，一个客户端维度的视图，并将其直接添加到提供者维度，只是为了进行这样的查询。它会是这样的：

```
(Dimension)Client ---> (Fact)Call <--- (Dimension)Provider <--- (Dimension)View Client 
```

当然，使用这种方法，用户必须非常小心不要将此 View Client 维度与事实表一起使用，因为它会重复事实行。

那么，这是我需要使用著名的无事实事实表的情况之一吗？

这样做的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T13:06:17.040

当您“回收”要在同一个事实表中多次使用的维度（即调用日期、服务日期等）时，应该使用角色扮演维度。

听起来这不是你要找的。相反，如果关系确实是一对多的，那么我将直接在客户端维度上添加提供者 ID（不需要视图或任何东西），并认识到这种关系与事实无关。

从本质上讲，当涉及到这种查询时，将“提供者”视为客户端的一个属性。

但是，听起来您可能希望确保客户端和提供者之间没有多对多关系（客户端可以使用多个提供者，并且提供者可以有多个客户端）。多对多关系在维度*上*建模为事实表。您的事实表可以是当前时间点的快照，有或没有历史。只需要两列，`Client`并且`Provider`. 如果您想在某个时间范围内记录客户/提供商关系，您只需添加一个日期戳。

请注意，一个无事实的事实也可以用来模拟一对多关系（如果模型在后端发生变化，那么您的 ETL 已经完成......）

# sql - 将临时表传递给另一个存储过程

> ID：11039707
> 
> 赞同：2
> 
> 时间：2012-06-14T19:04:16.910
> 
> 标签：sql, sql-server, sql-server-2008

我想这样做：

```
DECLARE @TmpTable TABLE = select * from someTable where someTable.Column1='BLAH' 
```

我需要`@TmpTable`成为的一个子集，`someTable`并且我不想隐式声明一个带有字段的结构`@TmpTable`，而是我希望它是从 someTable 动态创建的。

这可能吗？

非常感谢您的帮助和指导！

我已经接受了尝试临时表的建议。但是，我收到错误消息：

```
 The table #SubSet does not exist in the database 
```

这是代码：

```
DECLARE @StartDT DATE
DECLARE @MinDOS DATE
SELECT @MinDOS = MIN(dos) FROM accn_demographics
SELECT @StartDT = 
    CAST(CAST(datepart(YYYY,@MinDOS) AS varchar) + '-' + CAST(datepart(mm,@MinDOS) AS varchar) + '-' + CAST('01' AS varchar) AS DATETIME)
DECLARE @FileLocation VARCHAR(50)
DROP TABLE #SubSet
WHILE @StartDT < '20110901'
BEGIN
    SELECT * 
        INTO #SubSet
    FROM ViewAccountDetail
    WHERE datepart(yyyy,ViewAccountDetail.DOS) = datepart(yyyy,@StartDT)
        AND datepart(mm,ViewAccountDetail.DOS) = datepart(mm,@StartDT)
    SET @FileLocation='C:\test\'+'ViewAccountDetail'+cast(@StartDT as varchar)+'.csv'
    EXEC BCP_Text_File #SubSet, @FileLocation       
    SET @StartDT = DATEADD(MONTH,1,@StartDT)

    DROP TABLE #SubSet
END 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T19:12:21.487

```
select * 
into #temptable
from someTable 
where someTable.Column1='BLAH' 
```

只需将“@”更改为“#”；）您也可以使用 CTE。[关联](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:14:54.420

```
WITH A
AS
(
    select * from someTable where someTable.Column1='BLAH'
) 
```

`A`您的“临时表”的别名在哪里。之后，您可以像选择另一个普通表一样选择它。只知道你**不能**在`Order By``select * from someTable where someTable.Column1='BLAH'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:50:06.980

这就是我所做的！

```
DECLARE @StartDT DATE 
DECLARE @MinDOS DATE 
SELECT @MinDOS = MIN(dos) FROM accn_demographics 
SELECT @StartDT = 
CAST(CAST(datepart(YYYY,@MinDOS) AS varchar) + '-' + CAST(datepart(mm,@MinDOS) AS varchar) + '-' + CAST('01' AS varchar) AS DATETIME) 
DECLARE @FileLocation VARCHAR(50) 
DROP TABLE #SubSet 
WHILE @StartDT < '20110901' 
BEGIN 
SELECT * 
INTO SubSet 
FROM ViewTransactionDetails 
WHERE datepart(yyyy,ViewTransactionDetails.DOS) = datepart(yyyy,@StartDT) 
AND datepart(mm,ViewTransactionDetails.DOS) = datepart(mm,@StartDT) 
SET @FileLocation='C:\test\'+'ViewTransactionDetails'+cast(@StartDT as varchar)+'.csv' 
EXEC BCP_Text_File SubSet, @FileLocation    
SET @StartDT = DATEADD(MONTH,1,@StartDT) 

DROP TABLE SubSet 
END 
```

感谢大家的非凡帮助！

我选择了一张永久性的桌子，然后继续放下它！

# django - django 我可以将模型的类型存储在变量中以用于方法调用吗？

> ID：11039710
> 
> 赞同：0
> 
> 时间：2012-06-14T19:04:31.683
> 
> 标签：django

我不确定 python 对对象使用什么术语 - 请原谅我缺乏 python 知道如何！

实际上，我该怎么做：

```
strToObject = {'story':Story,'post':Post}

def post(self,request):
    type = request.POST['theTypeInTheForm']
    id = request.POST['idInTheForm']
    get_object_or_404(strToObject.get(type,None),id) 
```

所以这样做是从表单字段中获取一个值，计算出我们正在谈论的类型，然后从 db 中从 id 中提取正确的类型。

我不太清楚该怎么做。（这个表格真的是一个评级按钮，所以我并没有一个完整的表格！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:15:11.330

您可能想要使用[ContentTypes](https://docs.djangoproject.com/en/1.4/ref/contrib/contenttypes/)，它是一个包含应用程序中定义的所有不同模型的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:22:59.003

首先，您需要更加小心地从`strToObject`. 就目前而言，如果`type`不是“故事”或“帖子”之一，`get_object_or_404`将`None`作为模型提供，并且您的代码将爆炸。改为执行以下操作：

```
model = strToObject.get(type) # `None` is the "default" default
if model is not None:
    get_object_or_404(model, id=id) 
```

其次，正如我在上面的代码中指出的那样，您不能只将`id`原样传递给`get_object_or_404`，您需要指定模型上的哪个字段应该查找值，因此`id=id`.

第三，您应该使用`get`on`request.POST`来获取`type`和`id`. 就像现在一样，如果它们由于某种原因不在表单中，您的代码将爆炸`IndexError`：

```
type = request.POST.get('theTypeInTheForm')
id = request.POST.get('idInTheForm') 
```

`None`然后，您应该在继续之前检查这些值是否不是：

```
if type is not None and id is not None:
    # the rest of your code 
```

# php - 使用通配符“完成”文件名的其余部分

> ID：11039715
> 
> 赞同：0
> 
> 时间：2012-06-14T19:05:11.703
> 
> 标签：php

在 Wordpress 中使用 PHP 我有一组函数，这些函数当前返回每个帖子每个月和每年的点击次数，并按类型进一步分类。由于当前保存了所有这些信息，我想返回每个帖子的总点击次数，无论类型如何，也忽略时间。即提供运行总命中数。

目前的功能是：

```
 function icc_get_view_count($type,$month,$year) {
       global $post;
       if(!isset($month)||($month=='')||!isset($year)||($year=='')) {
       $month = date('m');
       $year = date('Y');
       }
       $post_type = $post->post_type;
       if($post_type == 'partners') {
$post->ID;
$current_views = get_post_meta($post->ID, "icc_views_".$type."_".$month."_".$year, true);
if(!isset($current_views) OR empty($current_views) OR !is_numeric($current_views) ) {
     $current_views = 0;
}
}

return $current_views;
}

function icc_show_views($type,$month,$year) {
   global $post;
   if(!isset($month)||($month=='')||!isset($year)||($year=='')) {
   $month = date('m');
   $year = date('Y');
   }

   $post_type = $post->post_type;
   if($post_type == 'partners') {
echo $current_views = icc_get_view_count($type,$month,$year);
   }
} 
```

然后由以下方式调用：

```
 <?php icc_show_views('single', $month, $year); ?> 
```

所有帖子都以“icc_views_”开头，然后附加“类型”、“月”和“年”。我试过使用 glob()

```
 $current_views = get_post_meta($post->ID, glob("icc_views_*"), true); 
```

完成文件名，因此无论如何都会返回类型、月份和年份，但似乎无法使其正常工作。

任何指针将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T15:01:36.270

谢谢您的帮助。我想也许我应该寻找一个更简单的答案，并通过首先从每个 post_id 获取命中总和然后根据需要排除来从另一端工作。所以我在阅读其他问题和答案后提出了这个基础：

```
function icc_show_total_views($hits) {
   global $post;
   $post_type = $post->post_type;
   if($post_type == 'partners') {
    echo $current_views = get_post_meta_hits($post_id);
   }
}

function get_post_meta_hits($post_id){

    global $wpdb;
    $data   =   array();
    $wpdb->query("
            SELECT sum('meta_value')
            FROM $wpdb->postmeta
            WHERE `post_id` = $post_id
                    ");

    foreach($wpdb->last_result as $k => $v){
        $data[$v->meta_value] =   $v->meta_value;
    };
    return $data;
} 
```

但这会返回单词“Array”。我在这里错过了一些基础知识吗？

再次感谢反馈，很有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:12:35.573

我认为你不能这样做：

1.  PHP“glob()”扩展文件系统（操作系统级别）路径名。我相信 Wordpress “get_post_meta()” 是指存储在*数据库*中的自定义字段。苹果和橙子。

2.  数据库通配符将是“%”。无论如何，我认为它不能与“get_post_meta()”一起使用。

'希望有帮助..

# php - MySQL PDO - try {块}里面应该是什么？

> ID：11039722
> 
> 赞同：10
> 
> 时间：2012-06-14T19:05:40.777
> 
> 标签：php, mysql, pdo

所以我正在努力学习 PDO，并从标准的 PHP MySQL 函数进行转换。但是，我有一个问题。关于这些`try {}`块，它们到底应该在里面，什么应该在外面？

使用的所有东西都应该`$sth-> ...`在里面`try {}`吗？是否应该只是从语句第一次准备到执行时？甚至比这还少？

任何帮助将不胜感激。:)

这是我在课堂上的一个示例方法。组织得当吗？注意我是如何把*所有东西都*放在里面`try {}`的。那是错的吗？这对我来说感觉不正确，但我不确定我应该如何改变它。

```
protected function authorized()
{
    try
    {
        // Attempt to grab the user from the database.
        $sth = $dbh->prepare("
            SELECT COUNT(*) AS num_rows
            FROM users
            WHERE user_id = :user_id
            ");

        $sth->bindParam(':user_id', $this->user_id);
        $sth->execute();

        // Check if user exists in database.
        if ($sth->fetch()->num_rows > 0)
        {
            // User exists in database, and is therefore valid.
            return TRUE;
        }
        else
        {
            // User does not exist in database, and is therefore invalid.
            return FALSE;
        }
    }
    catch (PDOException $e)
    {
        pdo_error($e);
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-14T19:19:34.297

try catch 应该**在函数之外**。

```
<?php

protected function authorized() {
    // Attempt to grab the user from the database.
    $sth = $dbh->prepare("
            SELECT COUNT(*) AS num_rows
            FROM users
            WHERE user_id = :user_id
            ");

    $sth->bindParam(':user_id', $this->user_id);
    $sth->execute();

    // Check if user exists in database.
    if ($sth->fetch()->num_rows > 0) {
        // User exists in database, and is therefore valid.
        return TRUE;
    }
    else {
        // User does not exist in database, and is therefore invalid.
        return FALSE;
    }
}

...

try {
    authorized()
}
catch (PDOException $e) {
    pdo_error($e);
} 
```

不要在方法内部处理异常。如果它发生，您**尝试**该*方法*并**捕获**结果异常。

# php - 奇怪的网站行为 - 具有特定值的 GET 参数导致网站重定向到 403

> ID：11039728
> 
> 赞同：5
> 
> 时间：2012-06-14T19:06:02.087
> 
> 标签：php, apache, joomla, phpmyadmin

我有一个网站正在运行`Joomla!`（它不是我的，所以我不知道它是如何构建的）。

我遇到了一个非常奇怪的问题：当我使用`phpMyAdmin`并且我想编辑表格中的条目时 - 我得到一个错误`403`。如果我复制按钮的链接位置`Edit`并将其放在新选项卡中 - 我会得到相同的结果。通过反复试验，我发现，如果我将`where_clause`GET 参数的值部分替换为`%60id%60`其他任何内容（例如，`%60foo%60`或`id`）- 一切都会按预期工作。

你有什么想法，什么会导致这种奇怪的行为？为什么`id`？为什么这么特别？

PS`%60`代表`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T08:45:49.513

几乎每次我发现这种奇怪的行为时，服务器中都有某种安全模块，无论是在[Web 服务器级别](http://www.modsecurity.org/projects/modsecurity/apache/)还是在[PHP 级别](http://www.hardened-php.net/suhosin/)。托管服务提供商通常甚至没有意识到这一点，可能是因为它是他们控制面板的默认组件。

您唯一的机会可能是找出确切的模块并阅读文档以确定您是否可以更改设置。

# arrays - 如何在 Scala 中编写多态输入函数？

> ID：11039729
> 
> 赞同：4
> 
> 时间：2012-06-14T19:06:02.007
> 
> 标签：arrays, scala, input, polymorphism

我正在尝试在 Scala 中编写一些方便的函数来读取值数组。

我从一个函数开始，它将“1 1 2 3 5 8”之类的字符串转换为 Array[Int]：

```
def readInts(in: String) = in.split(" ").map(_.toInt) 
```

这很好用，除了如果我想读取的不仅仅是 Ints 而是 Longs 或 BigInts 或 Doubles，我需要为每个函数定义一个函数，这似乎很浪费（特别是如果我推广到读取矩阵或其他复合数据）

我希望能够编写一个多态函数，如下所示：

```
def readArray[A](in: String) = in.split(" ").map(_.to[A]) 
```

据我了解，这是不可能的，因为 String 类没有多态的“to”方法。好吧; 我将尝试将其定义为辅助方法：

```
def to[A](in: String) = ??? 
```

似乎我需要根据类型参数有条件地定义方法 - 如果 A 是 Int，则调用`in.toInt`; 如果 A 是 Double，则调用`in.toDouble`; 如果 A 是 Tuple2[Int,Int]，则调用辅助方法`toTupleOfInts(in)`。据我所知，这也是不可能的。

在我知道的另一种函数式语言 Haskell 中，这个问题是由“Read”类型类处理的，它定义了一个多态函数“read”，它可以从 String 转换为所需的数据类型。

在 Scala 中执行此操作（即编写多态输入函数）的惯用方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T19:25:21.327

你可以做一些非常接近 Haskell 类型类的事情。但是，它不能自动派生（至少现在，也许宏会在将来的某个版本中允许这样做）

首先，定义一个特征，相当于类型类。

```
trait Read[A] {
  def read(in: String): A
} 
```

然后使一些实例隐式可用，最好在伴随对象中

```
object Read {

  implicit object ReadInt extends Read[Int] {
    def read(in: String): Int = in.toInt
  }

  implicit object ReadDouble ....

  implicit def readArray[A](implicit readItem: Read[A]) : Read[Array[A]]
    = new Read[Array[A]] {
      def read(in: String) = in.split(" ").map(readItem.read _)
    }

   implicit def readTuple[A,B](implicit readA: Read[A], readB: Read[B]) ...

} 
```

最后，定义一个方法，使`Read`易于访问

```
def read[A](in: String[A])(implicit reader: Read[A]) = reader.read(in) 
```

您可以对任何在隐式范围内有 Read 实例的类型调用 read。

# android - Android：获取 MapView 传输的字节数

> ID：11039744
> 
> 赞同：1
> 
> 时间：2012-06-14T19:06:29.560
> 
> 标签：android, android-mapview

正如标题所说，我需要获取 MapView 下载/上传的字节数？

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:35:30.377

您无法具体说明`MapView`. 您可以通过 告诉整个应用程序的数据传输`TrafficStats`。

# wcf-data-services - 生成的 OData 客户端库和 OpenType 属性

> ID：11039745
> 
> 赞同：0
> 
> 时间：2012-06-14T19:06:30.233
> 
> 标签：wcf-data-services, odata, datasvcutil

我正在开发具有包含 OpenType 属性的实体的 OData 服务器。两个新的客户端项目已经启动：一个用于 iOS，使用[OData4ObjC](http://odata.github.com/OData4ObjC/)，另一个使用生成的 .Net 库（通过 DataSvcUtil）。

据我所知——都不支持 OpenType 属性。这是真的？也许我错过了什么？有典型的解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T09:50:56.723

我不知道 iOS 版本，.NET 版本支持某些类型的开放属性用例。如果在客户端上您知道要访问哪些打开的属性，您可以手动将它们添加到生成的类中（生成的类是部分的）。然后，客户端会将它们视为任何其他属性，它应该可以工作。（您可能需要设置 DataServiceContext.IgnoreMissingProperties=true，以便在服务器的某个实例上不存在该属性时它不会失败）。

但是在.NET 客户端中没有实现对开放属性的完全支持（例如能够动态读取和写入服务器发送的任何内容）。您可以使用 ODataLib 来使用和生成此类有效负载，但它并不容易使用 (http://www.nuget.org/packages/Microsoft.Data.OData)

# ruby-on-rails-3 - SPSS Ruby 阅读器

> ID：11039748
> 
> 赞同：0
> 
> 时间：2012-06-14T19:06:48.733
> 
> 标签：ruby-on-rails-3, spss

我需要能够从我的 RoR 应用程序中读取 spss .sav 文件。有谁知道可以理解 spss .sav 文件的格式和语法的 gem 或 ruby​​ 代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T13:12:36.000

如果您可以在 Ruby 中处理 C 库，请查看 SPSS 社区网站 (www.ibm.com/developerworks/spssdevcentral) 上提供的免费 i/o 模块。

# c# - How do I open a picture after creating it in C#?

> ID：11039755
> 
> 赞同：-3
> 
> 时间：2012-06-14T19:07:24.067
> 
> 标签：c#, image, file-io

I'm writing a simple program to convert text to strings. One quick question, how can I open the image once I finished creating that? I don't want to have pictureBox in the program.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:24:14.607

I am *assuming* you mean that you want to load your image into your application without having to physically store it in a property inside of a PictureBox. To do so, you can use *Bitmap.FromFile* e.g.

```
var myBitmap = Bitmap.FromFile("c:\somefile.bmp"); 
```

This is given that you are are creating and then *saving* your image to an path on the file system.

# php - PHP 正则表达式：CSS 相对于绝对值

> ID：11039758
> 
> 赞同：1
> 
> 时间：2012-06-14T19:07:34.193
> 
> 标签：php, css, regex, url, relative-path

我有一个困难的正则表达式的问题。我有这个表达式来检测绝对网址（http 和 https

```
/(url {0,}\(( {0,}'| {0,}"|))(?!http|data\:).*?\)/im 
```

我想要做的基本上是`preg_replace`在 url 前面加上`$path`我的脚本中定义的路径。基本上这个正则表达式会产生两个捕获组：

```
group 1: (url {0,}\(( {0,}'| {0,}"|))(?!http).*?\)

group 2: ( {0,}'| {0,}"|) 
```

在 uri 开始之前，我怎样才能一直匹配，然后在它前面加上`$path`？我似乎无法正确获取捕获组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:37:13.340

你可以使用这样的东西：

```
$re = '/\b url \s*+ \( \s*+ (?| " ([^"]*+) " | \' ([^\']*+) \' | (\S*+) ) \s*+ \) /ix';

$str = preg_replace_callback($re, function ($match) {
    $url = $match[1];
    // do some check on the url
    if(whatever)
        return $match[0]; // return without change

    // do whatever you want with the URL
    // return new url
    return "url(\"$url\")";
}, $str); 
```

# objective-c - AppDelegate 没有找到 ViewController 的声明和合成属性

> ID：11039759
> 
> 赞同：3
> 
> 时间：2012-06-14T19:07:38.873
> 
> 标签：objective-c, ios, core-data, properties, uiapplicationdelegate

我的应用程序已经开发了几个月，现在被要求添加核心数据。SMH。它是一个 tabViewController 应用程序。我不知道这是否有助于回答。

所以在这里我试图添加它，但我遇到了错误。**我在AppDelegate.h**中为 Core Data 构建，所以我创建了这些 IVAR 并稍后在 .m 中适当地构建它们。

```
@property (readonly, strong, nonatomic) NSManagedObjectContext *managedObjectContext;
@property (readonly, strong, nonatomic) NSManagedObjectModel *managedObjectModel;
@property (readonly, strong, nonatomic) NSPersistentStoreCoordinator *persistentStoreCoordinator; 
```

在需要 CoreData 交互的 viewControllers 中，我已经给出了它们（在 .h 文件中）：

```
@property (strong, nonatomic) NSFetchedResultsController *fetchedResultsController;
@property (strong, nonatomic) NSManagedObjectContext *managedObjectContext; 
```

并在.m中合成它们：

```
@synthesize fetchedResultsController = __fetchedResultsController;
@synthesize managedObjectContext = __managedObjectContext; 
```

现在，回到**AppDelegate**。在 .m 中，当我尝试将 managedObjectContext 的指针从委托传递给视图时（就像这样）：

```
viewController1.managedObjectContext = self.managedObjectContext;
viewController2.managedObjectContext = self.managedObjectContext; 
```

我收到一个 XCode 错误（对于 viewController1 和 2）：

```
Property 'managedObjectContext' not found on object of type 'UIViewController *' 
```

我不明白这一点，因为两个视图控制器中的属性显然存在并且是合成的。

我什至尝试过退出并重新启动 XCode。可能是系统重启？<-- 这很荒谬吗？

（我知道我添加的内容超出了您的需要。）有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:54:50.390

首先，如果应用程序已经创建了`without`CoreData，那么使用 UIManagedDocument 来设置核心数据会更容易。

所以我会首先在 AppDelegate 中执行此操作。请参阅苹果开发者网站上的 UIManagedDocument 类参考以及我在此处的回答以寻求帮助：

[目标 c - 核心数据保存方法](https://stackoverflow.com/questions/10887437/objective-c-core-data-saving-approach/10887737#10887737)

其次，您的 appDelegate 应该知道您的初始视图控制器实际上是您的`UITabBarController`，并且您的标签栏控制器知道它的第一个视图控制器应该是您的上下文的目标，因此需要`NSManagedObejectContext`公共 API 中的属性。

所以我忘记了确切的代码，但它类似于：

```
// in appDidFinishLaunchingWithOptions or somewhere
UITabBarController* tabBarController = self.window.rootViewController;
UIViewController* viewController = [tabBarController.viewControllers objectAtIndex:[your first controller]];

// Pass your context
viewController.managedObjectContext = self.managedObjectContext;

// Be sure to #import your first viewControllers API so that propert is visible.
// That may have been your initial problem. 
```

希望这对你有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:15:30.507

*[我在另一篇文章](https://stackoverflow.com/questions/9345506/unable-to-pass-nsmanagedobjectcontext-to-my-view-controller)中找到了这个答案：*

“另一种方法是从您的应用程序委托中提取上下文 - 目前，如果您更改应用程序的组织方式，则必须重新编码应用程序委托。您可以在任何地方获得指向应用程序委托的指针，因此以下内容一段代码可以添加到任何视图控制器：

```
AppDelegate *delegate = (AppDelegate*)[[UIApplication sharedApplication] delegate];  
self.managedObjectContext = delegate.managedObjectContext; 
```

通常在 viewDidLoad 中。”

*感谢用户：[jrturton](https://stackoverflow.com/users/852828/jrturton "杰特顿")的回答*

# solr - HTML 解析器在 SOLR 3.6 中不起作用

> ID：11039760
> 
> 赞同：0
> 
> 时间：2012-06-14T19:07:39.187
> 
> 标签：solr

将 solr.jar 与 Apache Solr 3.6 下载中的示例一起使用，HTML 标记不会被剥离。

在 schema.xml 我添加了以下内容：

```
<!-- A text field that only splits on whitespace for exact matching of words -->
<fieldType name="text_html" class="solr.TextField" positionIncrementGap="100">
  <analyzer>
    <charFilter class="solr.HTMLStripCharFilterFactory"/>
    <tokenizer class="solr.StandardTokenizerFactory"/>
  </analyzer>
</fieldType>

<field name="title" type="text_html" indexed="true" stored="true" multiValued="true"/> 
```

另外，我将以下 JSON 发布到 SOLR：

```
[
{
    "id" : "978-064172344522",

    "title":"my <a href=\"www.foo.bar\">link</a>  power-shot PowerShot USC Utility <br>hello</br> Rejections Under 35 U.S.C. 101 and 35 U.S.C. 112, First Paragraph Petitions to correct inventorship of an issued patent are decided by the <Underline>Supervisory Patent Examiner</Underline>, as set forth"

} 
```

]

重启 SOLR 后，我搜索了 power-shot，结果仍然显示 HTML 标签

```
 <result name="response" numFound="1" start="0" maxScore="0.13561106">
 <doc>
 <float name="score">0.13561106</float>
 <str name="id">978-064172344522</str>
 <arr name="title">
 <str>my <a href="www.foo.bar">link</a> power-shot PowerShot USC Utility <br>hello</br> 
```

这里缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:34:50.563

您看到的是存储为最初发送到 Solr 的字段。例如，如果您搜索“title:href”，则不应找到该文档，因为应删除分析器链中的 html 内容

# java - java.lang.NoClassDefFoundError: com.lowagie.text.Document

> ID：11039762
> 
> 赞同：0
> 
> 时间：2012-06-14T19:07:43.123
> 
> 标签：java, android, noclassdeffounderror, android-droidtext

我一直在我的应用程序中使用 droidText.0.2.jar 来创建 pdf 文件，效果很好。今天我更新了eclipse，突然我收到以下错误“java.lang.NoClassDefFoundError：com.lowagie.text.Document”我检查了编译器设置，它似乎设置为JDK 1.6。我迫切需要尽快解决这个问题，但我完全没有想法。

# java - 计算第 N 个浮点数

> ID：11039768
> 
> 赞同：7
> 
> 时间：2012-06-14T19:08:45.673
> 
> 标签：java, c++, c

对于 32 位浮点数，我认为有 2^31 - 1 个可表示的浮点数。在java中，您可以使用现有的浮点数并使用数学库找到“下一个浮点数”。但是假设您没有起始浮点数，有没有办法计算第 n 个浮点数？我不在乎是什么语言，如果有一种带有库函数的语言，我会接受它。

当然，我可以简单地将所有浮点数放入一个数组中并对其进行索引，但这样空间效率很低。

这里有一些进一步的说明。我可以从 Float.MIN 开始并使用 nextFloat 递增 N 次，但这似乎效率低下，因为我需要多次执行此操作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T19:19:45.247

取决于您希望它们如何订购。请记住，并非所有的花车都是订购的。例如，一对不同的 NaN 是无序的（即它们不相等，但没有一个大于另一个）。

如果您不介意以这些结尾，则可以将整数重新解释为浮点数。您执行此操作的方式因语言而异；这是一个C实现：

```
float int_to_float(uint32_t in) {
    union {
        float f;
        uint32_t i;
    } u;

    u.i = in;
    return u.f;
} 
```

这具有为您提供大多数有序结果的便利属性——传入 0 得到 0.0，传入 1 得到 1.4e-45，2 得到 2.8e-45，依此类推。一旦你进入 NaN/Inf 值，结果就会开始变得疯狂，一旦你达到 0x80000000 (-0.0)，结果最终会开始*下降*，但现在应该已经足够好了。

# php - PHP-SQL 自动完成搜索

> ID：11039771
> 
> 赞同：0
> 
> 时间：2012-06-14T19:09:09.293
> 
> 标签：php, sql, search

我编写了一个代码来登录用户并显示他的各种详细信息。这工作得很好。除此之外; 我添加了一个似乎不起作用的自动完成搜索。我正在使用 Jquery 的自动完成功能。搜索框中的字段是从 SQL 中搜索的。

但什么也没有发生。我在文本字段中输入文本，但没有任何反应。

这是我整个更正的 PHP 代码（不包括连接文件）

```
<script>
$(document).ready(function() {
  $("input#autocomplete").autocomplete({
    source: keywordList,
    minLength: 1,

  });
});
</script>

<?php echo keywordArray(); ?>
<?php function keywordArray()
{
  $rsKeywords = mysql_query("SELECT * FROM job");

  $output = '<script>'."\n";
  $output .= 'var keywordList = [';

  while($row_rsKeywords = mysql_fetch_assoc($rsKeywords))
  {
    $output .= '"'.$row_rsKeywords['work'].'",';
  }

  $output = substr($output,0,-1); //Get rid of the trailing comma
  $output .= '];'."\n";
  $output .= '</script>';
  return $output;
}
?> 
```

//搜索脚本：

```
<?php
if(!isset($_POST['submit'])){
                        echo "Your search was invalid";
                        exit;
                    } 

                    $keyword = mysql_real_escape_string($_POST['keywords']);
                    $sql = "SELECT * FROM job WHERE work='$keyword' or work LIKE 'ANOTHER_PARAMETER' LIMIT 5";

                    $result = mysql_query($sql);
                    $numrows = mysql_num_rows($result);

                    echo //details etc
>? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:51:48.717

这是我整个更正的 PHP 代码（不包括连接文件）

```
<script>
$(document).ready(function() {
  $("input#autocomplete").autocomplete({
    source: keywordList,
    minLength: 1,

  });
});
</script>

<?php echo keywordArray(); ?>
<?php function keywordArray()
{
  $rsKeywords = mysql_query("SELECT * FROM job");

  $output = '<script>'."\n";
  $output .= 'var keywordList = [';

  while($row_rsKeywords = mysql_fetch_assoc($rsKeywords))
  {
    $output .= '"'.$row_rsKeywords['work'].'",';
  }

  $output = substr($output,0,-1); //Get rid of the trailing comma
  $output .= '];'."\n";
  $output .= '</script>';
  return $output;
}
?> 
```

//搜索脚本：

```
<?php
if(!isset($_POST['submit'])){
                        echo "Your search was invalid";
                        exit;
                    } 

                    $keyword = mysql_real_escape_string($_POST['keywords']);
                    $sql = "SELECT * FROM job WHERE work='$keyword' or work LIKE 'ANOTHER_PARAMETER' LIMIT 5";

                    $result = mysql_query($sql);
                    $numrows = mysql_num_rows($result);

                    echo //details etc
>? 
```

# javascript - 如何在java脚本中查询多个项目？

> ID：11039779
> 
> 赞同：-1
> 
> 时间：2012-06-14T19:09:47.950
> 
> 标签：javascript, rally

我正在 Rally 中开发图表和仪表板。因此，我需要查询迭代 1 和迭代 2 的信息。

```
queryConfig[2] = {
        type: 'release',
        key: 'release',
        fetch: 'ReleaseStartDate,ReleaseDate',
        query: rally.sdk.util.Query.or([
                       'Name = "IR 1"', 
                       'Name = "IR 2"'
                   ])
    }; 
```

您将在上面找到我如何查询迭代 1 和 2（即 IR 1 和 IR 2）的快照。这种方法似乎不起作用。感谢您在这方面的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T22:49:13.023

看起来它应该工作。迭代名称末尾是否有空格？尝试将 = 替换为包含。还可以尝试在搜索中添加更广泛的新内容，看看是否能给您带来任何好处。

这是一个例子

```
queryConfig[2] = {
    type: 'release',
    key: 'release',
    fetch: 'ReleaseStartDate,ReleaseDate',
    query: rally.sdk.util.Query.or([
                   'Name = "1"', 
                   'Name = "2"'
               ])
}; 
```

此外，如果您想调试您的查询，您可以使用这个[App](https://github.com/RallyCommunity/WsapiReference)。util 生成的查询将显示在您的控制台中，该 App 可以帮助您将其可视化。

```
console.log(rally.sdk.util.Query.or([
                   'Name = "1"', 
                   'Name = "2"'
               ]).toString()); 
```

# android - 我的安卓 JNI JPEG 编码器真的很慢

> ID：11039783
> 
> 赞同：5
> 
> 时间：2012-06-14T19:09:57.780
> 
> 标签：android, optimization, java-native-interface, jpeg, profile

我正在开发一个小型 Android 应用程序，以将一些相机镜头（作为一系列 JPEG）流式传输到我的计算机。在不进行任何处理的情况下，帧缓冲区以大约 18 fps 的速度接收相机预览图像。当我添加

```
YuvImage yuv = new YuvImage(data, ImageFormat.NV21, dimensions.width, dimensions.height, null);
yuv.compressToJpeg(new Rect(0, 0, dimensions.width, dimensions.height), 40, out); 
```

帧速率下降到约 7 fps。所以我想我会用 C 语言编写自己的 JPEG 编码器并加快速度。好吧，我是一个惊喜。我现在得到 0.4 fps！

所以现在我需要分析和优化我的 C 代码，但我真的不知道从哪里开始。我正在使用这些 GCC 标志：

```
-Wall -std=c99 -ffast-math -O3 -funroll-loops 
```

那里有什么我可以改进的吗？

除此之外，我的 JPEG 编码器只是一个简单的实现。写头信息，写量化和霍夫曼表，然后对数据进行熵编码。DCT 正在使用 AA&N 的方法，我相信这是最快的方法。

也许 JNI 开销有问题？

我正在使用 Java 分配内存：

```
frame_buffer = ByteBuffer.allocate(raw_preview_buffer_size).array();
jpeg_buffer = ByteBuffer.allocate(10000000).array(); 
```

然后用这段代码把它拉进去（现在请原谅意大利面）：

```
void Java_com_nechtan_limelight_activities_CameraPreview_handleFrame(JNIEnv* env, jobject this, jbyteArray nv21data, jbyteArray jpeg_buffer) {
    jboolean isCopyNV21;
    jboolean isCopyJPEG;
    int jpeg_size = 0;

    jbyte* nv21databytes = (*env)->GetByteArrayElements(env, nv21data, &isCopyNV21);
    jbyte* jpeg_buffer_bytes = (*env)->GetByteArrayElements(env, jpeg_buffer, &isCopyJPEG);

    if (nv21databytes != NULL) {
        if (jpeg_buffer_bytes != NULL) {
            jpeg_size = compressToJpeg((UCHAR*) nv21databytes, (UCHAR*) jpeg_buffer_bytes, 640, 480);
            (*env)->ReleaseByteArrayElements(env, jpeg_buffer, jpeg_buffer_bytes, 0);
            (*env)->ReleaseByteArrayElements(env, nv21data, nv21databytes, JNI_ABORT);
            }
        else {
            __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "JPEG data null!");
            }
        }
    else {
        __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "NV21 data null!");
        }

    } 
```

我在这里做一些低效的事情吗？什么是分析 JNI 代码的好方法？

除了这些，我唯一能想到的就是我将不得不阅读关于 NEON 的内容并将这些东西矢量化。啊...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:21:22.330

尝试使用内置编码器：

```
 private byte[] compressYuvToJpeg(final byte[] yuvData) {
    mJpegCompressionBuffer.reset();
    YuvImage yuvImage =
        new YuvImage(yuvData, ImageFormat.NV21, mPreviewWidth, mPreviewHeight, null);
    yuvImage.compressToJpeg(new Rect(0, 0, mPreviewWidth, mPreviewHeight), mJpegQuality,
        mJpegCompressionBuffer);
    return mJpegCompressionBuffer.toByteArray();
  } 
```

# c# - 格式化 Excel 存储过程的输出

> ID：11039789
> 
> 赞同：1
> 
> 时间：2012-06-14T19:10:56.247
> 
> 标签：c#, asp.net, export-to-excel

这个问题必须有一个简单的解决方案，但看在上帝的份上，我无法弄清楚！

我不太习惯将数据输出到 Excel，因为我通常使用 Business Objects 等报告工具。但是，我只是想修改现有 C# Web 应用程序上的现有报告。我将 25 个额外的数据列附加到 Excel 工作表。我编写了一个简单的存储过程，它接受参数并输出一行 25 列的数据。然后我调用这个函数来执行每个`mentee_id`我传入它的函数。它工作得很好，但它在 25 列之前添加了一个空白列。如果有人有任何建议，我将非常感激......

```
//here is the function that executes the stored procedure:
protected string GetServiceCodes_byColumns(object mentee_id)
{
    //string id = mentee_id.ToString();
    //string id = "4530";  //for testing            
    string value = "0";
    string retString = string.Empty;

    try
    {            
        //Displays current information from the database
        string strConn = ConfigurationManager.AppSettings.Get("SQLConnectionString");
        SqlConnection myDBConnection = new SqlConnection(strConn);
        string sProc = ("[spMSSreport_MenteeSummaryByCenter_ServiceCodes]");
        SqlCommand spCmd = new SqlCommand(sProc, myDBConnection);
        spCmd.CommandType = CommandType.StoredProcedure;
        SqlParameter pCntr = new SqlParameter("@cntr", ddlCenter.SelectedValue);
        SqlParameter pStartDate = new SqlParameter("@start", txtStartDate.Text);
        SqlParameter pEndDate = new SqlParameter("@end", txtEndDate.Text);
        SqlParameter pUserID = new SqlParameter("@userid", mentee_id);

        spCmd.Parameters.Add(pCntr);
        spCmd.Parameters.Add(pStartDate);
        spCmd.Parameters.Add(pEndDate);
        spCmd.Parameters.Add(pUserID);

        myDBConnection.Open();         
        SqlDataReader rdr = spCmd.ExecuteReader();     //should retrieve one row with 25 columns 
        rdr.Read();                      

        for (int i = 0; i < 25; i++)
        {
            retString += "<td align='right'>" + rdr.GetValue(i).ToString() + "</td>";               
        }
        value = retString;               

        dr.Close();
        myDBConnection.Close();
    }
    catch (Exception ex)
    {
        Response.Write(ex);
    }
    return value;
} 
```

// 这里是调用函​​数的aspx位（它是调用函数的最后一行）

```
<ItemTemplate>
    <tr valign="top">
        <td><%#DataBinder.Eval(Container.DataItem, "MentorName" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "MenteeName" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "MenteeWSUID" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "gender" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "sttype" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "ethniccd")%></td>
        <td><%#DataBinder.Eval(Container.DataItem, "center1" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "center2" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "TMPcollege" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "FCOC" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "CAMP" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "SSS" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "CSF" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "Lead1000" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "year" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "term" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "fieldofstudy" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "street" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "city" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "st" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "zip" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "phone" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "email" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "email2" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "AssignedMentor" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "AssignedMentor2" )%></td>
        <td><%#DataBinder.Eval(Container.DataItem, "AssignedMentor3" )%></td>
        <td><%#DataBinder.Eval(Container.DataItem, "AssignedMentor4" )%></td>
        <td><%#DataBinder.Eval(Container.DataItem, "AssignedMentor5" )%></td>
        <td><%#DataBinder.Eval(Container.DataItem, "mentor_and_mentee" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "active" ) %></td>
        <td><%#DataBinder.Eval(Container.DataItem, "inactive_reason" ) %></td>
        <td align="right"><%#GetEngagementLevel(DataBinder.Eval(Container.DataItem, "mentee_id") ) %></td>
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "A" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "B" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "C" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "D" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "E" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "F" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "G" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "H" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "I" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "J" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "K" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "L" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "M" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "N" ) %></td>  
        <td align="right"><%#DataBinder.Eval(Container.DataItem, "O" ) %></td> 
        <td align="right"><%#GetServiceCodes_byColumns(DataBinder.Eval(Container.DataItem, "mentee_id") )%></td>           
   </tr>       
</ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:26:29.820

看来您正在将 25 个 td 嵌入到最终的 td 中。从最后一行中删除 <td align='right' ，所以它很简单：

```
<%#GetServiceCodes_byColumns(DataBinder.Eval(Container.DataItem, "mentee_id") )%> 
```

# java - 使用 f:loadBundle 时出现 javax.el.PropertyNotFoundException ...这是正确实现规范吗？

> ID：11039791
> 
> 赞同：2
> 
> 时间：2012-06-14T19:11:04.700
> 
> 标签：java, jsf, tomcat, el, resourcebundle

我有一个 f:loadBundle 从我的类路径加载一个属性文件。

```
<f:loadBundle basename="com.xxx.ui.messages" var="msg" /> 
```

稍后，我尝试使用来自资源包的消息，语法如下：

```
<h:outputText value="test message: #{msg.does_not_exist} --"/> 
```

过去 JSF 会打印出“NOT FOUND”消息，但现在它抛出异常。规范是否发生了变化，或者这是正确的行为？

我使用 Mojarra 2.1.9 和 JUEL 2.2.4 作为 EL 解析器。这是堆栈跟踪：

```
javax.el.PropertyNotFoundException: /WEB-INF/xxx.xhtml @10,70 value="test message: #{msg.does_not_exist} --": Property 'does_not_exist' not found on type java.util.PropertyResourceBundle
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:111)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:182)
    at javax.faces.component.UIOutput.getValue(UIOutput.java:169)
    at com.sun.faces.renderkit.html_basic.HtmlBasicInputRenderer.getValue(HtmlBasicInputRenderer.java:205)
    at com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.getCurrentValue(HtmlBasicRenderer.java:355)
    at com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.encodeEnd(HtmlBasicRenderer.java:164) 
```

编辑：可以在这里验证正确的行为：http: [//javaserverfaces.java.net/nonav/docs/2.0/vdldocs/facelets/f/loadBundle.html](http://javaserverfaces.java.net/nonav/docs/2.0/vdldocs/facelets/f/loadBundle.html)

（这表示文字字符串 ???KEY??? 从 Map 返回，其中 KEY 是在 Map 中查找的键，而不是抛出 MissingResourceException）

编辑：即使在删除 JUEL 后也会出现同样的问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T14:39:14.807

所以答案实际上是盯着你的脸......@millimoose 的道具让我开始走上正确的道路。

请注意规范是这样说的：

> 文字字符串???KEY??? 从 Map 返回，其中 KEY 是在 Map 中查找的键，而不是 抛出***MissingResourceException 。***

但是我的堆栈跟踪是这样说的：

> javax.el. ***PropertyNotFoundException*** : /WEB-INF/xxx.xhtml @10,70 value="test message: #{msg.does_not_exist} --": 在 java.util.PropertyResourceBundle 类型上找不到属性“does_not_exist”

啊，一个可能的错误！

知道这个类将从 tomcat/lib 中提取，我[在这里](http://tomcat.apache.org/tomcat-7.0-doc/elapi/javax/el/ResourceBundleELResolver.html#getValue%28javax.el.ELContext,%20java.lang.Object,%20java.lang.Object%29)浏览了它们的源代码和 javadoc 。注意到“getValue()”上的 throws 声明了吗？

[这与这里](http://docs.oracle.com/javaee/5/api/javax/el/ResourceBundleELResolver.html#getValue%28javax.el.ELContext,%20java.lang.Object,%20java.lang.Object%29)的规范形成了鲜明的对比。

所以我从 tomcat/lib 中删除了 el-api 并将其替换为规范 jar（[此处](https://oss.sonatype.org/service/local/artifact/maven/redirect?r=central&g=javax.el&a=el-api&v=2.2&e=jar)）并解决了问题！

为什么 Tomcat 与规范如此不同，我无法理解……那些疯狂的 Apache 家伙。

# ios - 如何使用 AWS iOS SDK 从设备上传图像并设置为公共

> ID：11039794
> 
> 赞同：9
> 
> 时间：2012-06-14T19:11:09.783
> 
> 标签：ios, image, file-upload, permissions, amazon-s3

由于我们似乎受限于桶的数量，我试图弄清楚如何完成以下工作：

*   我有一个 iOS 应用程序，用户可以在其中上传个人资料图片。
*   任何人都可以查看个人资料图片（我希望它公开）。
*   理想情况下，我可以上传到单个存储桶（例如：myprofilepics.s3.amazonaws.com）
*   理想情况下，每个用户都可以上传到自己的子文件夹（例如：myprofilepics.s3.amazonaws.com/images/userXXX/
*   理想情况下，我上传图片，并将其设置为直接从应用程序公开访问，以便其他用户可以立即查看个人资料图片。

我在文档中遗漏了什么吗？感谢您对此问题的任何反馈。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-13T19:23:30.080

为了解决这个问题，我从亚马逊的 iOS SDK 中的示例代码开始，在[此处](http://aws.amazon.com/sdkforios/)找到。在 SDK zip 中，感兴趣的示例项目可以在`samples/S3_Uploader`.

要从该示例项目转到上传图片公开的项目，您只需在正确的位置添加一行：

```
por.cannedACL   = [S3CannedACL publicRead]; 
```

用于上传图像`por`的位置在哪里。`S3PutObjectRequest`

我的项目上传代码如下所示（看起来几乎与亚马逊的示例代码相同）：

```
NSString *uuid = @""; // Generate a UUID however you like, or use something else to name your image.
UIImage *image; // This is the UIImage you'd like to upload.

// This URL is not used in the example, but it points to the file
// to be uploaded.
NSString *url = [NSString pathWithComponents:@[ @"https://s3.amazonaws.com/", AWS_PICTURE_BUCKET, uuid ]];

// Convert the image to JPEG data. Use UIImagePNGRepresentation for pngs
NSData *imageData = UIImageJPEGRepresentation(image, 1.0);

// Create the S3 Client.
AmazonS3Client *s3 = [[AmazonS3Client alloc] initWithAccessKey:AWS_ACCESS_KEY_ID withSecretKey:AWS_SECRET_KEY];

@try {
    // Create the picture bucket.
    [s3 createBucket:[[S3CreateBucketRequest alloc] initWithName:AWS_PICTURE_BUCKET]];

    // Upload image data.  Remember to set the content type.
    S3PutObjectRequest *por = [[S3PutObjectRequest alloc] initWithKey:uuid inBucket:AWS_PICTURE_BUCKET];
    por.contentType = @"image/jpeg"; // use "image/png" here if you are uploading a png
    por.cannedACL   = [S3CannedACL publicRead];
    por.data        = imageData;
    por.delegate    = self; // Don't need this line if you don't care about hearing a response.

    // Put the image data into the specified s3 bucket and object.
    [s3 putObject:por];
}
@catch (AmazonClientException *exception) {
    NSLog(@"exception");
} 
```

`AWS_ACCESS_KEY_ID``AWS_SECRET_KEY`当然，它们是您的 AWS 凭证，并且是`AWS_PICTURE_BUCKET`您的图片存储桶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T21:32:26.813

如果您要管理自己用户的身份（即不是通过 AIM），您还必须管理有权访问的资源。我会加入一个瘦 Web 服务来管理对 S3 上文件的访问。

[或者，您可以使用临时安全凭证](http://docs.amazonwebservices.com/STS/latest/UsingSTS/Welcome.html)和安全策略为您的用户提供对 S3 的访问权限。您必须在设备上添加代码才能为您的用户获取临时令牌。

我会选择第一个解决方案，因为它使 Amazon S3 不在等式中，您可以在稍后阶段腾出双手来选择另一个后端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T21:08:19.413

这就是我最终做的事情：

```
 BOOL success = YES;

// Initialize the S3 Client.
AmazonS3Client *s3 = [[AmazonS3Client alloc] initWithAccessKey:ACCESS_KEY_ID withSecretKey:SECRET_KEY];

@try {
    // Create the picture bucket.
    [s3 createBucket:[[S3CreateBucketRequest alloc] initWithName:HOSTED_BUCKET]];

    NSString *remoteImagePath = [self pathWithImageType:SFHostedImageTypeProfile identiefier:@""];

    // Upload image data.  Remember to set the content type.
    S3PutObjectRequest *por = [[S3PutObjectRequest alloc] initWithKey:remoteImagePath inBucket:HOSTED_BUCKET];
    por.contentType = @"image/png";

    por.data        = UIImagePNGRepresentation(image);

    // Put the image data into the specified s3 bucket and object.
    [s3 putObject:por];
}
@catch (AmazonClientException *exception) {
    //        [Constants showAlertMessage:exception.message withTitle:@"Upload Error"];
    NSLog(@"Save Hosted Image Exception: %@", exception.message);

    success = NO;
}

return success; 
```

# c++ - 在 C++ 中使用无序 _map 将整数转换为字符

> ID：11039795
> 
> 赞同：3
> 
> 时间：2012-06-14T19:11:10.697
> 
> 标签：c++

我不确定我是否完全理解哈希表/无序映射。当我执行以下操作时，代码会编译并正常工作：

```
#include <tr1/unordered_map>

int main() {
    tr1::unordered_map<string, int> base;
    string string1;
    int integer1;

    base["A"] = 0;

    string1 = "A";
    integer1 = base[string1];
    cout << integer1 << endl;
    return 0;
} 
```

但这不会编译：

```
#include <tr1/unordered_map>

int main() {
    tr1::unordered_map<int, char> base;
    char char1;
    int integer1;

    base[1] = 'A';

    integer1 = 1;
    char1 = base[integer1];
    cout << char1 << endl;
    return 0;
} 
```

这会产生此错误：

> 错误：调用不匹配`'(std::tr1::unordered_map<int, char, std::tr1::hash<int>, s std::equal_to<int>, std::allocator<std::pair<const int, char> >, false>) (int*)'`

有人可以向我解释这个问题吗？我想我不明白 unordered_map 是如何工作的。我在 Apple 上使用 gcc 4.2.1 进行编译。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:21:35.310

以下编译并适用于 Visual C++ 10.0 和 MinGW g++ 4.6.1：

```
#include <iostream>
#include <unordered_map>

int main()
{
    using std::unordered_map;
    using std::cout;  using std::endl;

    unordered_map<int, char> base;
    char char1;
    int integer1;

    base[1] = 'A';

    integer1 = 1;
    char1 = base[integer1];
    cout << char1 << endl;
    return 0;
} 
```

**TR**是“技术报告”的缩写。TR1 是第一份技术报告，包含对标准库的扩展。这些扩展已经在 C++11 标准中采用，并且大部分已经在例如 Visual C++ 和 g++ 中实现。

所以，直接使用标准库即可。

# wordpress - WordPress 网站的自定义内容取决于访问者的位置

> ID：11039802
> 
> 赞同：0
> 
> 时间：2012-06-14T19:11:35.923
> 
> 标签：wordpress, location

我为我的客户建立了一个 Wordpress 网站。

作为下一步，我的客户希望他的网站显示不同的电话号码，并根据网站访问者的位置在某些页面上自定义内容。

例如，如果网站的访问者在洛杉矶，那么联系电话号码将是 (323)xxx-xxxx ，但如果访问者在比佛利山庄 - 电话号码将更改为 (310)-yyy-yyyy .

页面内容也是如此：他想将网站的副本自定义到访问者的位置。因此，在上面的示例中，如果用户从 Beverly Hills 访问该站点，则需要将整个站点中的“Los Angeles”一词替换为“Beverly Hills”。

我四处搜索，但没有看到如何最有效地完成这项工作。

提前感谢您抽出宝贵时间帮助我解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T23:16:35.377

可以根据访问者的 IP 地址确定位置，如果您有 IP 位置数据库就可以了。要在 WordPress 上实现它，您应该创建一些 PHP 函数并将其放在您的 WordPress 模板中。假设您要添加的内容在标题中，请编辑您的 header.php 模板以包含您编写的 PHP 函数/代码。

在整个网站上进行此操作可能会更复杂，但我相信并确信可以通过过滤器和许多其他方式来完成。对于页面内容（帖子/页面），您可以使用“the_content”过滤器。一个简单的例子：

在您的 function.php 模板上，添加如下内容：

```
add_filter( 'the_content', 'filter_the_content' );
function filter_the_content( $content ) {
    if ( $location == 'Beverly Hills' )
    str_replace( 'Los Angeles', 'Beverly Hills', $content );

    return $content;
} 
```

这只是一个示例，如果您使用上面的示例，它将不起作用。

反过来，是使用“简码”。您可以简单地添加一个短代码，例如`[location]`. 添加创建功能以替换简码以显示位置。

这只是对您可以使用 WordPress 做什么的简要说明。请务必查看法典：[http ://codex.wordpress.org/](http://codex.wordpress.org/)

# xml - SQL xml 列更新

> ID：11039804
> 
> 赞同：1
> 
> 时间：2012-06-14T19:11:52.520
> 
> 标签：xml, sql-server-2008

我有两张桌子。一张表包含键列和 xml 列。其他表保存数据。当我尝试从第二个表形成 xml 并更新第一个表时。它只更新一个节点，它忽略了第二个节点。请参考这个例子。

```
 declare @mytable table
    (
    col1 int,
    col2 varchar(100)
    )
    declare @mytable1 table
    (
    col1 int,
    col2 xml
    )
    insert into @mytable1 values(1,null)
    insert into @mytable1 values(2,null)

    insert into @mytable values(1,'abc')
    insert into @mytable values(1,'dcf')
    insert into @mytable values(2,'efg')
    insert into @mytable values(2,'hhh')

    update x set col2=  d.XMLCol from @mytable1 x
    inner join
    (select a.col1,  node.XMLCol from @mytable a join @mytable1 b on a.col1=b.col1 cross apply (select a.col1,a.col2 for xml path('record') , root ('myroot'), type
    ) as node(XMLCol)  )d
    on x.col1=x.col1

    select * from @mytable1 
```

实际结果是

```
1   <myroot><record><col1>1</col1><col2>abc</col2></record></myroot>
2   <myroot><record><col1>2</col1><col2>hhh</col2></record></myroot> 
```

预期结果是

```
1   <myroot><record><col1>1</col1><col2>abc</col2></record><record><col1>1</col1><col2>dcf</col2></record></myroot>
2   <myroot><record><col1>2</col1><col2>hhh</col2></record><record><col1>2</col1><col2>efg</col2></record></myroot> 
```

有人可以指出我做错了什么吗？

谢谢，

埃森。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T13:22:05.017

> 有人可以指出我做错了什么吗？

1.  您`@mytable1`在生产笛卡尔积的同一列上自行加入。`on x.col1=x.col1`.
2.  您的派生表为 中的每一行返回两行`@mytable1`。第一行带有第一个节点，第二行带有第二个节点。更新语句不会将这些行合并为一，它会选择其中之一。

改为这样做：

```
update x set 
  col2 = (
          select a.col1,
                 a.col2
          from @mytable as a
          where x.col1 = a.col1
          for xml path('record'), root('myroot'), type
         )
from @mytable1 x 
```

[SE-数据](https://data.stackexchange.com/stackoverflow/query/73307)

# ios - 使用 FFmpeg 设置 Red5 服务器以实时流式传输到 iOS

> ID：11039805
> 
> 赞同：5
> 
> 时间：2012-06-14T19:12:06.560
> 
> 标签：ios, ffmpeg, red5, http-live-streaming

我是一名应用程序开发人员，我需要实现 FFmpeg 以将 rtmp 直播流转码/更改为 http 直播流，以便我可以在任何 iOS 设备（iPhone 和 iPad）上播放它。

我的问题是我在服务器、媒体内容和 FFmpeg 方面相当陌生。而且我需要更改服务器，以便我可以在服务器端对实时流进行转码（我已经读过这是可能的）。任何提示、建议、示例代码或教程都会有很大帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T06:30:42.723

要通过 HTTP Live Streaming 流式传输到 iOS 设备，您需要使用 FFMpeg 转换您的媒体（FFMpeg 可以使用 rtmp:// 将实时流作为输入），然后将它们划分为段。[这是一个](http://www.ioncannon.net/programming/452/iphone-http-streaming-with-ffmpeg-and-an-open-source-segmenter/)可以提供帮助的链接。我自己没有试过，但我认为你需要重新编译 FFMpeg。你也可以试试 MEncoder。

# javascript - 为什么浏览器中的 mocha 会抛出从 url 而不是从 unc 路径检测到的全局泄漏？

> ID：11039811
> 
> 赞同：9
> 
> 时间：2012-06-14T19:12:37.403
> 
> 标签：javascript, testing, mocha.js

我正在创建一个 javascript 库并想使用 BDD，所以我尝试使用 mocha，但无法使其工作。我希望在客户端上使用该库，所以我假设让它从可浏览的 url 运行，在 Web 连接的上下文中运行是有意义的，而不仅仅是来自 unc 路径的沙箱。

这是虚拟起点文件 test/test.foobar.js

```
var assert = chai.assert;

var foobar = {
  sayHello: function() {
    return 'Hello World!';
  }
};

describe('Foobar', function() {
  describe('#sayHello()', function() {
      it('should work with assert', function() {
      assert.equal(foobar.sayHello(), 'Hello World!');
    });

  });
}); 
```

这是触发测试的html页面，test.html

```
<html>
<head>
  <meta charset="utf-8">
  <title>Mocha Tests</title>
  <link rel="stylesheet" href="testing/mocha.css" />
  <script src="testing/jquery.js"></script>
  <script src="testing/mocha.js"></script>
  <script>mocha.setup('bdd')</script>
  <script src="testing/chai.js"></script>
  <script src="test/test.foobar.js"></script>
  <script> $(function() { mocha.run(); }) </script>
</head>
<body>
  <div id="mocha"></div>
</body>
</html> 
```

当我在 chrome 或 safari 中打开时

```
file:///Users/me/dev/sandbox/test.html 
```

它按预期工作，测试通过，没有错误

当我在 chrome 或 safari 中打开时

```
http://localhost/sandbox/test.html 
```

我收到以下错误并且测试失败

```
Error: global leak detected: script1339700707078
    at Runner.checkGlobals (http://localhost/sandbox/testing/mocha.js:3139:21)
    at Runner.<anonymous> (http://localhost/sandbox/testing/mocha.js:3054:44)
    at Runner.emit (http://localhost/sandbox/testing/mocha.js:235:20)
    at http://localhost/sandbox/testing/mocha.js:3360:14
    at Test.run (http://localhost/sandbox/testing/mocha.js:3003:5)
    at Runner.runTest (http://localhost/sandbox/testing/mocha.js:3305:10)
    at http://localhost/sandbox/testing/mocha.js:3349:12
    at next (http://localhost/sandbox/testing/mocha.js:3233:14)
    at http://localhost/sandbox/testing/mocha.js:3242:7
    at next (http://localhost/sandbox/testing/mocha.js:3192:23) 
```

有人可以解释一下，更好的解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-23T02:39:48.520

这是将 jQuery 与 mocha 一起使用的问题。jQuery 创建具有唯一 id 的全局变量...在您的情况下`script133...`。最近在 mocha 1.2 中发布，您可以设置通配符忽略...

```
$(function(){
  mocha
    .globals([ 'script*' ]) // acceptable globals
    .run();
}); 
```

确保您是最新的，并进行适当的配置。

参考：[Mocha 1.2.0 上线通知](http://tjholowaychuk.com/post/25314967097/mocha-1-2-0-now-with-more-nyan)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:24:46.777

我找到了一个解决safari问题的解决方案......替换

```
<script> $(function() { mocha.run(); }) </script> 
```

经过

```
<script>
      onload = function(){
        var runner = mocha.run();
      };
</script> 
```

...但仍然在 chrome 中出现错误:-(

# sql-server-2008 - 使用 DateDiff 的 SQL Server SSAS 计算度量

> ID：11039813
> 
> 赞同：1
> 
> 时间：2012-06-14T19:12:52.473
> 
> 标签：sql-server-2008, ssas, mdx, datediff

我正在尝试使用 datediff 函数在 SSAS 中创建一个计算成员，但似乎根本无法让它工作。

要求如下，
datediff(day, XDate where Type = 2 AND St​​atus IN (1,2,3), XDate where Type = 3)

我不确定如何将其转换为正确的 MDX 以用于 SSAS 中的计算度量。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:21:21.547

下面是一个示例查询，显示了一个名为 DateDiff 的计算度量。我更喜欢将复杂的计算分解成更小的部分，以便于排除故障。如果你愿意，你可以组合。我在这里发明了一些维度和度量，但希望你能看到它是如何工作的并相应地进行调整。基本上，我得到了一个集合，它将记录与特定状态代码（或类型代码）相结合并获取所有相关日期，但只有那些具有事实表行的度量值称为状态计数（任意 - 事实上任何度量表会做）。然后我选择最后一个 - 假设所有都是按日期顺序排列的，如果你的维度排序是正确的，然后用 extract 选择日期 - 然后因为它是一个集合 - 将它减少为 Item(0) 的成员.项目（0）。然后获取它的名称以在 DateDiff 函数中使用。我'

```
 with 
    member [Measures].[First Date] as
      iif(Record.Record.CurrentMember Is [Record].[Record].[All],
      null,
Extract(
Tail(
NonEmpty(
    (Record.Record.CurrentMember, 
    {[Status Code].[Status].&[1],[Status Code].[Status].&[2],[Status Code].[Status].&[2]},
    [Date].[Date].[Date].Members),
    [Measures].[Status Count]), 1), [Date].[Date])
).Item(0).Item(0).Name

member measures.[Second Date] as

iif(Record.Record.CurrentMember Is [Record].[Record].[All],
null,

Extract(
Tail(
NonEmpty(
    (Record.Record.CurrentMember, 
    [Type].[Type].&[3],
    [Date].[Date].[Date].Members),
    [Measures].[Status Count]), 1), [Date].[Date])
).Item(0).Item(0).Name

member measures.[DateDiff] as 

iif(IsEmpty([Measures].[First Date]), null, 
datediff("d", [Measures].[First Date], [Measures].[Second Date]))

select
{[Measures].[Status Count], 
[Measures].[First Date], 
[Measures].[Second Date], 
[Measures].[DateDiff]}
on columns,
[Record].members on rows
from [status] 
```

# jquery - 带有类别的jquery ui自动完成组合框

> ID：11039814
> 
> 赞同：12
> 
> 时间：2012-06-14T19:12:55.063
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

我正在使用 jquery ui 自动完成组合框，它工作得很好，但现在我有点贪心了。我希望能够为其添加类别。组合框是从菜单生成的，所以如果我添加了类别，请参见下面的示例，标签会显示，就像类别在[jquery ui 自动完成类别版本中一样](http://jqueryui.com/demos/autocomplete/#categories)

```
<select>
<optgroup name="Cat 1">    
<option value="1a">One A</option>
<option value="1b">One B</option>
<option value="1c">One C</option>
</optgroup>
<optgroup name="Cat 2">    
<option value="2a">Two A</option>
<option value="2b">Two B</option>
<option value="2c">Two C</option>
</optgroup>
</select> 
```

我创建了一个[http://jsfiddle.net/nH3b6/11/](http://jsfiddle.net/nH3b6/11/)。

感谢您的任何帮助或指导。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-14T23:22:17.430

扩展@Jarry 的建议，我会更新您的代码以确定`optgroup`该选项属于什么。从那里，您可以使用在 jQueryUI 网站上找到的类似代码：

```
(function($) {
    $.widget("ui.combobox", {
        _create: function() {
            var input, self = this,
                select = this.element.hide(),
                selected = select.children(":selected"),
                value = selected.val() ? selected.text() : "",
                wrapper = this.wrapper = $("<span>").addClass("ui-combobox").insertAfter(select);

            input = $("<input>").appendTo(wrapper).val(value).addClass("ui-state-default ui-combobox-input").autocomplete({
                delay: 0,
                minLength: 0,
                source: function(request, response) {
                    var matcher = new RegExp($.ui.autocomplete.escapeRegex(request.term), "i");

                    response(select.find("option").map(function() {
                        var text = $(this).text();
                        if (this.value && (!request.term || matcher.test(text))) return {
                            label: text.replace(
                            new RegExp("(?![^&;]+;)(?!<[^<>]*)(" + $.ui.autocomplete.escapeRegex(request.term) + ")(?![^<>]*>)(?![^&;]+;)", "gi"), "<strong>$1</strong>"),
                            value: text,
                            option: this,
                            category: $(this).closest("optgroup").attr("label")
                        };
                        //MK
                        $('#test').attr('style', 'display: none;');
                    }).get());
                },
                select: function(event, ui) {
                    ui.item.option.selected = true;
                    self._trigger("selected", event, {
                        item: ui.item.option
                    });
                },
                change: function(event, ui) {
                    if (!ui.item) {
                        var matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex($(this).val()) + "$", "i"),
                            valid = false;
                        select.children("option").each(function() {
                            if ($(this).text().match(matcher)) {
                                this.selected = valid = true;
                                return false;
                            }
                        });
                        if (!valid) {
                            $('#test').attr('style', 'display: block;');
                            // remove invalid value, as it didn't match anything
                            //$( this ).val( "" );
                            //select.val( "" );
                            //input.data( "autocomplete" ).term = "";
                            //return false;                    
                        }
                    }
                }
            }).addClass("ui-widget ui-widget-content ui-corner-left");

            input.data("autocomplete")._renderItem = function(ul, item) {
                return $("<li></li>").data("item.autocomplete", item).append("<a>" + item.label + "</a>").appendTo(ul);
            };

            input.data("autocomplete")._renderMenu = function(ul, items) {
                var self = this,
                    currentCategory = "";
                $.each(items, function(index, item) {
                    if (item.category != currentCategory) {
                        if (item.category) {
                            ul.append("<li class='ui-autocomplete-category'>" + item.category + "</li>");
                        }
                        currentCategory = item.category;
                    }
                    self._renderItem(ul, item);
                });
            };

            $("<a>").attr("tabIndex", -1).attr("title", "Show All Items").appendTo(wrapper).button({
                icons: {
                    primary: "ui-icon-triangle-1-s"
                },
                text: false
            }).removeClass("ui-corner-all").addClass("ui-corner-right ui-combobox-toggle").click(function() {
                // close if already visible
                if (input.autocomplete("widget").is(":visible")) {
                    input.autocomplete("close");
                    return;
                }

                // work around a bug (likely same cause as #5265)
                $(this).blur();

                // pass empty string as value to search for, displaying all results
                input.autocomplete("search", "");
                input.focus();
            });
        },

        destroy: function() {
            this.wrapper.remove();
            this.element.show();
            $.Widget.prototype.destroy.call(this);
        }
    });
})(jQuery);

$(function() {
    $("#combobox").combobox();
    $("#toggle").click(function() {
        $("#combobox").toggle();
    });
}); 
```

**示例：http:** [//jsfiddle.net/gB32r/](http://jsfiddle.net/gB32r/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-02T07:26:39.957

jquery 10 有一些功能。我从 jquery ui 网站获取自动完成组合框：http: [//jqueryui.com/autocomplete/#combobox](http://jqueryui.com/autocomplete/#combobox) 并与 Andrew Whitaker 回答一起加入。

```
(function( $ ) {
$.widget( "custom.combobox_with_optgroup", {
    _create: function() {
        this.wrapper = $( "<span>" )
            .addClass( "custom-combobox" )
            .insertAfter( this.element );
        this.element.hide();
        this._createAutocomplete();
        this._createShowAllButton();
    },
    _createAutocomplete: function() {
        var selected = this.element.find( ":selected" ),
            value = selected.val() ? selected.text() : "";
        this.input = $( "<input>" )
            .appendTo( this.wrapper )
            .val( value )
            .attr( "title", "" )
            .addClass( "custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left" )
            .autocomplete({
                delay: 0,
                minLength: 0,
                source: $.proxy( this, "_source" )
            })
            .tooltip({
                tooltipClass: "ui-state-highlight"
            });
        this._on( this.input, {
            autocompleteselect: function( event, ui ) {
                ui.item.option.selected = true;
                this._trigger( "select", event, {
                    item: ui.item.option
                });
            },
            autocompletechange: "_removeIfInvalid"
        });

        this.input.data("uiAutocomplete")._renderMenu = function(ul, items) {
            var self = this,
                currentCategory = "";
            $.each(items, function(index, item) {
                if (item.category != currentCategory) {
                    if (item.category) {
                        ul.append("<li class='custom-autocomplete-category'>" + item.category + "</li>");
                    }
                    currentCategory = item.category;
                }
                self._renderItemData(ul, item);
            });
        };
    },
    _createShowAllButton: function() {
        var input = this.input,
            wasOpen = false;
        $( "<a>" )
            .attr( "tabIndex", -1 )
            .attr( "title", "Показать все" )
            .tooltip()
            .appendTo( this.wrapper )
            .button({
                icons: {
                    primary: "ui-icon-triangle-1-s"
                },
                text: false
            })
            .removeClass( "ui-corner-all" )
            .addClass( "custom-combobox-toggle ui-corner-right" )
            .mousedown(function() {
                wasOpen = input.autocomplete( "widget" ).is( ":visible" );
            })
            .click(function() {
                input.focus();

                if ( wasOpen ) {
                    return;
                }

                input.autocomplete( "search", "" );
            });
    },
    _source: function( request, response ) {
        var matcher = new RegExp( $.ui.autocomplete.escapeRegex(request.term), "i" );
        response( this.element.find( "option" ).map(function() {
            var text = $( this ).text();
            if ( this.value && ( !request.term || matcher.test(text) ) )
                return {
                    label: text,
                    value: text,
                    option: this,
                    category: $(this).closest("optgroup").attr("label")
                };
        }) );
    },
    _removeIfInvalid: function( event, ui ) {

        if ( ui.item ) {
            return;
        }

        var value = this.input.val(),
            valueLowerCase = value.toLowerCase(),
            valid = false;
        this.element.find( "option" ).each(function() {
            if ( $( this ).text().toLowerCase() === valueLowerCase ) {
                this.selected = valid = true;
                return false;
            }
        });

        if ( valid ) {
            return;
        }

        this.input
            .val( "" )
            .attr( "title", value + " не существует" )
            .tooltip( "open" );
        this.element.val( "" );
        this._delay(function() {
            this.input.tooltip( "close" ).attr( "title", "" );
        }, 2500 );
        this.input.data( "ui-autocomplete" ).term = "";
    },
    _destroy: function() {
        this.wrapper.remove();
        this.element.show();
    }
});
})( jQuery ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T19:39:32.090

正如您在[jQueryUI 文档](http://jqueryui.com/demos/autocomplete/#categories)中看到的那样，您必须自定义小部件才能做到这一点

```
_renderMenu: function( ul, items ) {
            var self = this,
                currentCategory = "";
            $.each( items, function( index, item ) {
                if ( item.category != currentCategory ) {
                    ul.append( "<li class='ui-autocomplete-category'>" + item.category + "</li>" );
                    currentCategory = item.category;
                }
                self._renderItem( ul, item );
            });
        } 
```

这没有经过测试，但应该是一个好的开始：

```
_renderMenu: function( ul, items ) {
            var self = this,
                currentCategory = "";
            $.each( items, function( index, item ) {
                if ( item.parent.attr('label') != currentCategory ) {
                    ul.append( "<li class='ui-autocomplete-category'>" + item.parent.attr('label') + "</li>" );
                    currentCategory = item.parent.attr('label');
                }
                self._renderItem( ul, item );
            });
        } 
```

如果这不起作用，也许您应该调试以查看`items`作为 _renderMenu 参数出现的数组中的内容。

附注：这称为[MonkeyPatching](http://en.wikipedia.org/wiki/Monkey_patch)，我不建议经常这样做，但由于文档显示它，我说这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-05T20:13:59.903

我在我的 web 应用程序上使用 jqueryui 自动完成小部件，带有组合框猴子补丁、optgroup（类别）以及在类别名称中搜索的能力。在 compatible option 和 optgroup 中也强调了 seach 术语。我使用了来自stackoverflow和jqueryui网站的几个答案来达到这一点，谢谢！

我喜欢让它在最新版本的 jqueryui 上运行。Jqueryui 1.9 和 1.11 引入了重大更改（在自动完成和菜单插件中，前者使用的是最新版本），我终于成功地使它与最新版本的 jqueryui (1.11.0) 和 jquery (2.1.1) 一起工作

[jsbin在这里](http://jsbin.com/sikuyo/1/)

重要部分：通过新项目选项更改菜单小部件选项以不将类别视为普通菜单链接（如此新，不在文档中，而是在 jqueryui 1.11 升级指南中

```
$.extend($.ui.menu.prototype.options, {
    items: "> :not(.aureltime-autocomplete-category)"
}); 
```

# java - 专用服务器：为什么我的 JAVA 应用程序无法连接到我的 MySQL 数据库？

> ID：11039815
> 
> 赞同：2
> 
> 时间：2012-06-14T19:12:59.803
> 
> 标签：java, mysql, linux, database-connection, debian

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T12:56:41.410

我终于使用 部署了它`mvn tomcat:deploy`，它工作。我之前是通过 Tomcat 的 manager/html 接口上传 WAR 文件的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:25:19.247

我猜你错过`port`了`<jdbc.url>`.

您可以将 url 从 修改`<jdbc.url>jdbc:mysql://localhost/mydatabase</jdbc.url>` 为`<jdbc.url>jdbc:mysql://localhost:port/mydatabase</jdbc.url>`。

港口大多是`3306`。

您可以输入 MySQL 服务器的 ip 而不是`localhost`端口，我认为它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:35:25.807

可能有防火墙规则。在服务器安装中很常见。

检查是否可以远程登录到 mysql 端口。如果没有，请与系统管理员联系。

# css - 跨浏览器的站点导航上的 CSS

> ID：11039816
> 
> 赞同：0
> 
> 时间：2012-06-14T19:13:09.930
> 
> 标签：css, navigation, css-tables

我一直在尝试解决我网站上的导航问题。(sequoiawaste.com) 问题出现在 iPhone 和 Internet Explorer 7 上。我使用`display:table-cell;`CSS 属性将选项卡保持在一行中。但是，似乎有两个问题：

1）在移动设备（尤其是 iPhone，但不是 iPad）上，该行超出了蓝色背景，并且笨拙地隐藏了我页面的搜索功能。

2) 在 IE 7 上，它忽略`display:table-cell;`并实际上垂直定向链接，类似于 a`table-row`将创建的内容。

`#globalnav`据我所知， enhanced.CSS 文件中定义的属性很少，可能会导致该问题。

我注意到的是，显示值因状态而异——从表格到表格单元格，然后到块。将它们中的任何一个（或全部更改为相同的显示器）只会让我的问题变得更糟。

有没有人有一些关于在这里做什么的指示？我不认为这是一个非常困难的问题，我只是在这里碰壁。

** 更新 **

我开始使用`float:left`，但这是一把双刃剑 - 它看起来更好，但要获得类似的格式，我必须将每个锚点设置为特定宽度。现在，当您单击我的搜索栏时，它不会动态调整锚点的大小。

嗯。有小费吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:17:46.247

试试`float: left`吧——这有更好的跨浏览器支持。您还需要设置每个项目的宽度，可能还需要设置一些其他属性以使其再次看起来不错。

* * *

编辑：是的，使用`float: left`将导致您的导航元素停止单独调整大小。如果不使用浏览器的表格布局算法，这可能很难做到。您可以尝试其他几种方法：

*   当您为搜索栏宽度设置动画时，还要同时为所有导航项的宽度设置动画（但这可能会很慢）
*   实际使用表格（这不是很好地分离标记和表示，但有时 CSS 是有限的）
*   使用条件注释来“欺骗” IE 来呈现表格（请参阅[https://stackoverflow.com/a/4193681/106302](https://stackoverflow.com/a/4193681/106302)）了解详细信息（但这并不能解决移动设备的问题）

根据您选择的方法，您可能仍需要为移动设备提供特殊规则。我喜欢这种效果，但使用不同的设计可能更实用。

# api - Twitter 应用程序分发

> ID：11039820
> 
> 赞同：0
> 
> 时间：2012-06-14T19:13:22.220
> 
> 标签：api, twitter, wordpress

我对此很陌生，如果这是一组非常基本的问题，我深表歉意。我想知道的是：

1.  我创建了一个应用程序，我使用自定义 WordPress 插件从我的博客发布推文。但是我想发布 WordPress 插件并希望人们能够使用我的应用程序。不过，我担心给出包含我所有访问令牌和密钥的代码。我如何能够将使用我的应用程序的插件发布给其他用户以将他们的帖子发布到 Twitter？

2.  我的应用程序向 Twitter 发送推文是否存在限制，或者是否针对每个用户发送？

预先感谢您的任何帮助。非常感激。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:04:50.257

考虑[ThinkUp 的方法](https://github.com/ginatrapani/ThinkUp/wiki/Configuration%3a-Twitter)。它要求用户在 Twitter 上注册他们自己的应用程序，以便他们拥有自己的 Twitter API 使用者密钥和秘密，并且任何 API 限制（或潜在的滥用）仅与他们安装插件有关。

# eclipse - 如何防止 Eclipse Indigo 在 45 秒后关闭我的服务器？

> ID：11039821
> 
> 赞同：1
> 
> 时间：2012-06-14T19:13:31.063
> 
> 标签：eclipse, tomcat, tomcat6, eclipse-indigo

我在尝试启动我的 Tomcat v6.0 服务器时遇到了 Eclipse Indigo 的问题。我将启动我的服务器，控制台将报告服务器已启动（经过这么多毫秒），服务器控制台看起来很好，服务器将正确接受请求。但是 45 秒后（或任何默认超时设置），Eclipse 将关闭服务器并说服务器遇到问题并且无法启动。

解决此问题的一种方法是将服务器超时时间更改为 9999 秒，而不是默认的 45 秒，但显然这并不理想。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:13:31.640

[我花了一些谷歌搜索，但我在http://dsamuel.kodingen.com/_writeit/wordpress/?p=18](http://dsamuel.kodingen.com/_writeit/wordpress/?p=18)找到了解决此问题的方法。您只需将主机名更改为默认名称“localhost”以外的其他名称（任何名称），这实际上可以解决问题。您可以通过双击您的服务器并在“常规信息”区域中对其进行编辑来更改主机名。

不知道为什么这可以解决问题，但确实可以。这似乎是 Eclipse Indigo 的一个错误，特别是因为它不会发生在 Helios 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T12:39:10.373

检查您的来源是否某些语句是错误的或与您正在使用的端口冲突。去服务中心检查一下祝你成功！！！

# android - 使用 ProgressBar 和 AsyncTask 发送短信 | 安卓

> ID：11039825
> 
> 赞同：2
> 
> 时间：2012-06-14T19:14:22.420
> 
> 标签：android, sms, progress-bar

我想在`AsyncTask`给定参数的情况下发送短信。SMS 正在正确发送，但我想在`ProgressBar`发送 SMS 之前显示一个，然后将用户带到一个新活动。我在互联网上查看了示例，但我无法弄清楚我想对我的案子做什么。下面是我的`AsyncTask`

```
public class sendSms extends AsyncTask<Void, Integer, Void>{            

         protected void onPreExecute() {
             pb.setVisibility(View.VISIBLE); //pb is the ProgressBar   
            }

        @Override
        protected Void doInBackground(Void... params) {
             SmsManager sms = SmsManager.getDefault();
             sms.sendTextMessage(phoneNumber, null, message, null, null);       
            return null;                
        }

        protected void onProgressUpdate(Integer... progress){
             //Not sure what to do here
        }

        protected void onPostExecute(){
            Intent intn = new Intent(CurrentActivity.this, NewActivity.class);
            startActivity(intn);
        }           
} 
```

我很感激任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:26:48.503

请检查源代码。

```
public class sendSms extends AsyncTask<Void, Integer, String>{            

         protected void onPreExecute() {
             pb.setVisibility(View.VISIBLE); //pb is the ProgressBar   
            }

        @Override
        protected Void doInBackground(Void... params) {
             SmsManager sms = SmsManager.getDefault();
             sms.sendTextMessage(phoneNumber, null, message, null, null);       
            return "Done";                
        }

        protected void onProgressUpdate(Integer... progress){
             //Not sure what to do here
        }

        protected void onPostExecute(String result){
if(result.equals("Done"))
        {
            pb.setVisibility(View.GONE);
            Intent intn = new Intent(this, NewActivity.class);
            startActivity(intn);
}
    } 
```

}

我认为它对你有帮助。

谢谢

# c# - 使用 c#-regex 替换给定文本中的特定值

> ID：11039826
> 
> 赞同：-1
> 
> 时间：2012-06-14T19:14:26.810
> 
> 标签：c#, regex

我需要使用 c# 替换给定文本中的某些值，最好使用正则表达式

输入：这是示例文本。我需要用新值替换 $100.00 值。

输出：这是示例文本。我需要用新值替换 $50.00 的值。

> **需要更换 $100 到 $50**

注意：数字应该是任意大小

解决方案：这适用于我的要求

Regex.Replace("这是示例文本。我需要用新值替换 $100.00 值。", "\$\d+(\.\d+)?" , "50", RegexOptions.IgnoreCase)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T19:16:23.810

如果您要替换常量值，则不需要正则表达式：

```
string output = text.Replace("$100", "$50"); 
```

如果您事先不知道数字，您可以使用正则表达式，但您需要弄清楚您想要什么模式。这是一个匹配美元符号后跟一个或多个数字，然后是小数点，然后是另外两个数字的示例：

```
string output = Regex.Replace(input, @"\$\d+\.\d{2}", "$50.00"); 
```

您将需要此`using`语句才能使上述代码正常工作：

```
using System.Text.RegularExpressions; 
```

您应该修改正则表达式以满足您的需要。您可能需要考虑需要匹配的所有输入：

*   你需要匹配小数点吗？
*   你需要匹配逗号吗？
*   你需要匹配负值吗？
*   您需要匹配“$1M”中的字母吗？
*   是否需要匹配货币代码而不是美元符号“10 USD”？
*   您是否需要匹配其他货币，如“100 欧元”？
*   ETC...

根据您对这些问题的回答，您将需要调整正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:17:13.763

你应该可以使用这个：

```
RegEx rex = new RegEx("\\$\\d+\\.\\d\\d"); 
```

然后只需使用替换功能。

```
rex.Replace(input, "$50.00"); 
```

如果您需要能够确定要动态替换的值，请根据匹配的数字查看[MatchEvaluator](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.matchevaluator)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:19:28.520

这用可选的十进制值替换任何值：

```
Regex.Replace( s, @"\$\d+(\.\d+)?", "$50" ) 
```

# android - 如何将视图引用传递给android自定义视图？

> ID：11039829
> 
> 赞同：24
> 
> 时间：2012-06-14T19:14:43.393
> 
> 标签：android, custom-view

我做了如下

1）创建样式

```
<declare-styleable name="Viewee">
    <attr name="linkedView" format="reference"/>
</declare-styleable> 
```

2) 定义自定义视图布局

```
<LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="#ffc0">
    <TextView
            android:id="@+id/custom_text"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="[text]"
            />
</LinearLayout> 
```

3）创建所需的类

```
public class Viewee extends LinearLayout
{
public Viewee(Context context, AttributeSet attributeSet)
{
    super(context, attributeSet);
    View.inflate(context, R.layout.viewee, this);
    TextView textView = (TextView) findViewById(R.id.custom_text);
    TypedArray typedArray = context.obtainStyledAttributes(attributeSet, R.styleable.Viewee);
    int id = typedArray.getResourceId(R.styleable.Viewee_linkedView, 0);
    if (id != 0)
    {
        View view = findViewById(id);
        textView.setText(((TextView) view).getText().toString());
    }

    typedArray.recycle();
}
} 
```

最后在下面的活动中

```
<LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:app="http://schemas.android.com/apk/res/com.ns"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical">
    <TextView
            android:id="@+id/tvTest"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="android"/>
    <com.ns.Viewee
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            app:linkedView="@+id/tvTest"
            />
</LinearLayout> 
```

`id`现在虽然我在 Viewee 构造函数中收到一个非零值，`findViewById(id)`但返回 null 并`NullPointerException`发生。

我错过了什么？

[我按照这里的描述做了](https://stackoverflow.com/questions/6426930/next-view-id-as-a-custom-attribute-in-android)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-14T22:14:08.790

我找到了答案！

问题出`findViewById(id)`在我叫它的地方。[如文档](http://developer.android.com/reference/android/view/View.html)`findViewById`所述，仅查找子视图而不是上层级存在的视图。所以我必须调用类似的东西，但这也会返回，因为我调用它的地方不正确。`getRootView().findViewById(id)``null`

在`Viewee`构造函数`Viewee`本身还没有附加到它的根上，所以调用会导致`NullPointerException`.

因此，如果我在施工后打电话到`getRootView().findViewById(id)`其他地方，它工作正常，两者`"@+id/tvTest"`都是`"@id/tvTest"`正确的。我已经测试过了！

答案如下

```
public class Viewee extends LinearLayout
{
    public Viewee(Context context, AttributeSet a)
    {
        super(context, attributeSet);
        View.inflate(context, R.layout.main6, this);
        TextView textView = (TextView) findViewById(R.id.custom_text);
        TypedArray t = context.obtainStyledAttributes(a, R.styleable.Viewee);
        int id = t.getResourceId(R.styleable.Viewee_linkedView, 0);
        if (id != 0)
        {
            _id = id;
        }

        t.recycle();
    }

    private int _id;

    public void Foo()
    {
        TextView textView = (TextView) findViewById(R.id.custom_text);
        View view = getRootView().findViewById(_id);
        textView.setText(((TextView) view).getText().toString());
    }
} 
```

并`Foo`在需要通过其在您的活动等其他地方的参考 id 处理附加视图时调用。

功劳完全归功于那些在[这篇文章](https://stackoverflow.com/questions/9624973/android-custom-view-with-object-reference-from-attrs-xml-always-null)中做出贡献的人。在提交问题之前我没有看到那个帖子。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-01-19T23:21:02.060

我知道这是一个老问题，但我想我会添加另一种方法，因为我想将所有内容封装到我的自定义视图中。

而不是从外部调用，另一种在层次结构中获得更高视图的方法，我已经挂钩了`onAttachedToWindow()`：

```
public class MyCustomView extends LinearLayout {
    private int siblingResourceId;
    private View siblingView;

    public MyCustomView(Context context, AttributeSet a) {
        super(context, attributeSet);
        inflate(context, R.layout.main6, this);
        TextView textView = (TextView) findViewById(R.id.custom_text);
        TypedArray t = context.obtainStyledAttributes(a, R.styleable.Viewee);
        siblingResourceId = t.getResourceId(R.styleable.MyCustomView_siblingResourceId, NO_ID);
        t.recycle();
    }

    @Override
    public void onAttachedToWindow() {
        super.onAttachedToWindow();
        if (siblingResourceId != NO_ID) {
            siblingView = ((View) getParent()).findViewById(siblingResourceId);
        }
    }
} 
```

`onAttachedToWindow`很早就被调用了，但显然已经足够晚了，以至于整个视图层次结构都已经解决了。它至少可以完美地满足我的需求，并且更加可控，并且不需要来自外部的交互即可工作；-)

**编辑：**添加了 Kotlin 代码

```
class MyCustomView(context: Context, attributeSet: AttributeSet) : LinearLayout(context, attributeSet) {
    private val siblingResourceId: Int
    private lateinit var siblingView: View

    // All other constructors left out for brevity.

    init {
        inflate(context, R.layout.main6, this)
        val textView = findViewById<TextView>(R.id.custom_text)
        val t = context.obtainStyledAttributes(a, R.styleable.Viewee)
        siblingResourceId = t.getResourceId(R.styleable.MyCustomView_siblingResourceId, NO_ID)
        t.recycle()
    }

    override fun onAttachedToWindow() {
        super.onAttachedToWindow()
        if (siblingResourceId != NO_ID) {
            siblingView = (parent as View).findViewById(siblingResourceId) 
        }
    }
} 
```

**注意：**我们假设`parent`这个习惯`View`的 是 a`View`本身。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T19:16:52.940

您的描述`android:id`设置为`app:linkedView="@+id/tvTest`。但是，`@+id/tvTest`用于创建一个名为“tvTest”的新 id。您要做的是使用`app:linkedView="@id/tvTest`.

# sql - Oracle SQL中如何根据日期进行过滤

> ID：11039830
> 
> 赞同：1
> 
> 时间：2012-06-14T19:14:48.677
> 
> 标签：sql, oracle

我的函数中有如下查询。在那我需要根据 a.submit_date 过滤

```
SELECT mail_id , mail_async, mail_priority FROM glms_mail_sys_mail_store a
WHERE                  
--(TO_DATE(a.submit_date,'dd-MM-yyyy HH:mm') >= '14-06-2012 18:30')
--AND (TO_DATE(a.submit_date,'dd-MM-yyyy HH:mm') <= '15-06-2012 18:50')

(TO_DATE(TO_CHAR(a.submit_date,'dd-MM-yyyy HH:mm'),'dd-MM-yyyy HH:mm') >= '14-06-2012 18:30')
AND (TO_DATE(TO_CHAR(a.submit_date,'dd-MM-yyyy HH:mm'),'dd-MM-yyyy HH:mm') <= '15-06-2012 18:30') 
```

在我的数据库中，a.submit_date 的值为 '14-06-2012 20:30'

但是它抛出无效的月份......任何人都可以帮助纠正这个问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-14T19:20:18.303

首先，在下面试试这个，它有效：

```
SELECT TO_DATE('14-06-2012 20:30','dd-MM-yyyy HH24:MI') FROM dual 
```

然后，您需要将不等式的右侧转换为日期。

```
a.submit_date >= TO_DATE('14-06-2012 18:30','dd-MM-yyyy HH24:MI') AND
a.submit_date <= TO_DATE('15-06-2012 18:50','dd-MM-yyyy HH24:MI') 
```

如果你想写得更干净一点，请`BETWEEN`改用：

```
a.submit_date BETWEEN
  TO_DATE('14-06-2012 18:30','dd-MM-yyyy HH24:MI') AND
  TO_DATE('15-06-2012 18:50','dd-MM-yyyy HH24:MI') 
```

**编辑：**

这是一个完整的例子：

```
CREATE TABLE foo (submit_date DATE);

INSERT INTO foo VALUES (to_date('14-06-2012 20:30','dd-MM-yyyy HH24:MI'));
INSERT INTO foo VALUES (to_date('14-07-2012 20:30','dd-MM-yyyy HH24:MI'));

SELECT * FROM foo a
WHERE
a.submit_date BETWEEN
  TO_DATE('14-06-2012 18:30','dd-MM-yyyy HH24:MI') AND
  TO_DATE('15-06-2012 18:50','dd-MM-yyyy HH24:MI') 
```

输出：

```
 SUBMIT_DATE
1   6/14/2012 8:30:00 PM 
```

# iphone - iPhone - 从协议请求访问文件

> ID：11039833
> 
> 赞同：0
> 
> 时间：2012-06-14T19:14:59.680
> 
> 标签：iphone, ios, file, protocols

我正在构建一个 iPhone 应用程序，我正在尝试使用嵌入内容的 Web 视图，并且我正在尝试从 Web 视图从应用程序协议请求文件时返回一个文件。例如，`protocol://app/style.css`将返回`style.css`Application Bundle 中的内容，同时从应用程序文档目录`protocol://documents/folder/image.png`访问文件。`folder/image.png`

Spotify Mac 应用程序通过他们的应用程序完成此操作，允许开发人员使用类似于上述`//app/style.css`方法的地址访问 Spotify 样式。从应用程序内部调用该方法时，将返回样式文件，而在应用程序外部调用该方法时，则简单地启动应用程序。

如何通过将 Web 视图位置设置为将主应用程序包中的文件包含到 Web 视图中`customProtocol://app/style.css`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T20:08:23.180

你可以使用 JS 替换函数，`protocol://`用真实的路径字符串替换

设置`webView.delegate = self;` 然后用真实路径`webViewDidFinishLoad`替换`protocol://`

```
- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    //Get the real path
    NSString *exactPath = [NSHomeDirectory() stringByAppendingPathComponent:@"Document/CorrectPath/"];

    //In head replace protocol with real path
    NSString *js = [NSString stringWithFormat:@"document.head.innerHTML = document.head.innerHTML.replace('protocol://','%@')", exactPath];

    //Execute javascript replace on head
    [webView stringByEvaluatingJavaScriptFromString:js];
} 
```

# ios - App 分布式 Ad Hoc 和发布版本

> ID：11039835
> 
> 赞同：1
> 
> 时间：2012-06-14T19:15:02.780
> 
> 标签：ios, adhoc

我目前正在对通过企业发行版发布的 iOS 应用程序进行更新。我们已经发布了第 1 版，现在正在为第 2 版添加新功能。我们打算有选择地分发 beta 版以进行实际测试，但这个 beta 版必须与第 1 版一起使用。两个 iOS 应用程序之间是否存在冲突？具有相同的 AppID，但发布的版本使用分发证书签名，并且是一个分发的临时版本？

我已经阅读[了这篇](https://stackoverflow.com/q/1618717/620197)文章，但它没有解决我的具体情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:25:32.373

如果您想分发临时构建而不覆盖当前的生产构建，您可以更改捆绑标识符。一旦更改此设置，它将不会安装在生产版本上，而是另一个应用程序。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:24:54.533

根据我的经验，如果它们具有相同的捆绑 ID，则最近安装的版本（通常是您的临时分发版本）只是安装在其他应用程序上。在我作为一名开发人员期间，我已经更新了设备，这些设备使用 ad-hoc 安装了应用商店，它只是简单地覆盖了已安装的设备

# geometry - 如何使用three.js绘制平行线？

> ID：11039841
> 
> 赞同：2
> 
> 时间：2012-06-14T19:15:29.647
> 
> 标签：geometry, three.js

我是矩阵变换概念的新手，我尝试在正交方向上偏移一条线。我想出的是：

```
line.translate( offsetPixels,  new THREE.Vector3( 1, 1, 0 )  ); 
```

它沿着向量中定义的轴平移一条线。所以我的问题是如何在向量中定义轴以获得平行线？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-17T13:06:53.927

也许我弄错了，但我看不到 THREE.Line 或其超类 THREE.Object3D 有一个名为 translate 的方法......当然你可以创建自己的翻译函数，这不会太难。

```
function translate(object, offset, direction) {
    if (offset <= 0) return false;
    if (!(object instanceof THREE.Object3D)) return false;
    if (!(direction instanceof THREE.Vector3)) return false;

    direction.normalize();
    object.position.x += offset * direction.x;
    object.position.y += offset * direction.y;
    object.position.z += offset * direction.z;

    return true;
} 
```

我编写的这个函数将翻译从类 THREE.Object3D 派生的任何类型的对象。您像上面一样传入一个偏移量以及一个指定方向的 Vector3。

此调用将 lineA 在负 x 方向上平移 30：

```
translate(lineA, 30, new THREE.Vector3(-1,0,0); 
```

以下是相同的，因为方向向量是归一化的（除以它的长度）：

```
translate(lineA, 30, new THREE.Vector3(-5,0,0); 
```

现在使用这样的翻译功能将不允许您创建平行线，因为此功能只会移动已经创建的线。我在**[这里创建了这个演示小提琴，](http://jsfiddle.net/CoryG89/eL8Ln/)**它创建了两条平行线（如果它们具有相同的斜率，则线是平行的）。如果您取消注释翻译调用，它将把第二行移到第一行之上。

# gcc - objdump/readelf 获取变量信息

> ID：11039843
> 
> 赞同：0
> 
> 时间：2012-06-14T19:15:37.537
> 
> 标签：gcc, objdump, readelf, debug-information

我需要从已编译的 c 程序中获取有关全局变量的信息。[我在这里](https://stackoverflow.com/a/11056685/637142)问了一个类似的问题。

我现在遇到的问题是我试图提取变量信息的程序非常大，只需要 4 秒才能获得文本中的树（`readelf -w[i] file.out`）。然后我必须解析来回跳跃的树才能到达我需要的地方。例如，如果一个变量是类型的，`const unsigned char * volatile MyVariable`那么我将不得不导航到树的 5 个不同节点，如果程序包含 1000 个变量，那么需要一段时间才能得到我需要的东西。

**所以我的问题是**如何更好地利用 readelf 命令来实现我所需要的。该`readelf -w[i] file.out`命令为我提供了我需要的更多信息（每个函数、子程序、局部变量等）。例如，我没有通过该命令的输出来获取全局变量，而是使用该`readelf -s --wide file.out`命令来获取变量。该命令只会给我变量的名称，所以我仍然需要在树中查看变量是否为整数。

在[此链接](http://dwarfstd.org/doc/DWARF4.pdf)的第 237 页上，我相信有一个示例说明如何获取有关类型的信息。这是一张照片：

![在此处输入图像描述](../Images/7a172104b0ea4a6bdb2c0e762412ef8c.png)

我需要大约 15 秒来解析我需要的内容，但仍然有几个错误。如果我不必重新发明轮子并更好地使用 readelf 命令，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:01:44.300

您可以尝试使用 Andy Wingo 的新[dltool](http://wingolog.org/archives/2012/06/19/dltool-mines-dwarf)实用程序，它会为您完成所有 DWARF 信息的解析。

# c# - 我应该如何在 WPF 中表示这些记录和字段？

> ID：11039847
> 
> 赞同：3
> 
> 时间：2012-06-14T19:15:46.453
> 
> 标签：c#, arrays, wpf

我对 C# 很陌生。您如何处理多维数组？我也在使用 WPF。

为了更清楚地了解我的问题，这是我正在尝试做的事情：

我有一个需要存储大约 200 条“记录”的数组，每条记录都有三个字段，用户使用文本框输入了这些字段。所以我认为这就是你设置数组的方式：

```
 string[,] Properties = new string[500, 3]; 
```

每次用户点击按钮时，我都会向该数组添加一个新的“记录”。我不知道你会怎么做。我确信我需要设置某种计数器。

我还必须更新和删除数组中的值。任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:19:35.943

我将总结其他人的建议，因为您是新手。

为您的记录创建一个类（此示例相当简单）：

```
class MyRecord
{
    public string Property1 {get; set; }
    public string Property2 { get; set; }
    public string Property3 { get; set; }
} 
```

然后创建这些记录的列表：

```
List<MyRecord> theList; 
```

用于`theList.Add`将新记录添加到列表中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T19:17:20.723

您无法轻松添加到数组中。您唯一的选择是用另一行分配一个新数组，复制所有旧项目并将新数据放在最后一行。

同样删除一行：您必须将删除行之后的所有项目“向上”移动并使数组更短。这归结为分配一个新数组并复制所有项目。往上看 ：-）

通常，数组是一种低级结构，开发人员很少在 C# 中使用。*特别是*如果您想为可变集合建模。如果你想要一个可变的事物集合，那么*使用*一个事物集合，`List<Thing>`例如。`Thing`将是一个包含构成您的记录的三个属性的类。

集合类处理所有常见情况，如插入和添加项目、删除任意位置的项目等。由于您提到了 WPF，它们还与 WPF 的数据绑定和模板功能很好地结合在一起，这些功能非常强大，可以在用户界面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T19:20:02.517

您可能应该改用列表

```
LinkedList<String[]> properties = new LinkedList<String[]>(); 
```

然后您可以添加/删除条目

```
properties.AddLast({"a","b","c"}); 
```

在数组上使用列表的优点是从任意位置删除元素很容易:)

# iphone - 我可以使用 3g ip 连接到我的 iphone 吗？

> ID：11039848
> 
> 赞同：0
> 
> 时间：2012-06-14T19:15:50.813
> 
> 标签：iphone, networking, tcp, 3g

这个问题纯粹是出于好奇。假设我在手机（或任何相关服务）上安装了 lighttpd。从我的电脑 ping ip 会导致连接超时，并且很明显 iphone 的内部防火墙不存在（我相信无论如何都不存在）。因此，要获得公认的答案，您将需要涵盖这些理由...

1.  如果提供商阻止此流量，那么 1 如何创建允许通过 3g 侦听端口上的 tcp 连接的应用程序？

2.  苹果推送服务/iMessage 如何将数据传输到设备？该服务本身不会使用侦听端口的 tcp 协议吗？

3.  同样，如果提供商阻止此流量，他们如何确定其是 iphone 而不是无线加密狗（它也使用 sim 卡，我认为允许外部连接，尽管我不是 100% 确定）。

我问的原因是因为我考虑了一个用于电话的网络服务器，它允许管理以及位置概述和状态等，但如果没有办法连接，这将毫无意义，并且关于动态 IP 的问题将通过更新来克服到外部服务器的 IP 地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:35:52.837

1.  您的提供商很可能会为您提供一个位于多对一 NAT 网关后面的 IPv4 地址。因此，它们本身并没有阻止您的 IP 地址，但是由于多对一 NAT 的状态性，您将无法从 NAT 外部访问 NAT 内部的任何内容。希望当 IPv6 开始在手机中流行时，这种情况会有所改变。由于这些 IP 地址并不短缺，因此不需要 NAT。

2.  与其他所有推送服务一样，它实际上可能是由手机发起的与 Internet 上知名服务器的连接。通知服务器在手机打开后通过此连接发送通知。

3.  是什么让您认为他们检测（或关心）电话、平板电脑、系留设备或 3G 加密狗是否连接在 PDP 上下文的另一端？

**关于 APN 的**更新****

 **您的运营商很可能会为您的手机提供经过 NAT 处理的 IP 地址，并为您的 3G 加密狗提供真正的公共 IP 地址，因为它们连接到不同的 APN。3G 加密狗正在使用的 APN 名称甚至可能是一个严密保密的秘密，以阻止想要通过将手机重新配置为使用用于加密狗的 APN 来为其手机获取公共 IP 地址的用户。该 APN 将在加密狗内部进行预配置，并且难以提取。这样做是因为公共 IP 地址供应有限，而且运营商不想将它们浪费在手机上（而且那里的手机比 3G 加密狗要多得多）。

上述段落是推测性的并且取决于运营商，但似乎一些运营商会这样做。**

# android - Android：如何修复 Necessitas (Qt) 的打包错误？

> ID：11039849
> 
> 赞同：2
> 
> 时间：2012-06-14T19:15:57.917
> 
> 标签：android, qt, packaging

有人可以帮我解决包装错误吗？在尝试在设备上启动程序时，我遇到了一个错误。Necessitas 数据包在执行 clean debug 命令的情况下给出以下错误：

> :-1: 错误：打包错误：命令 'C:\Users\iDom\necessitas/apache-ant-1.8.2/bin/ant.bat clean debug' failed.Exit code: 2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T11:59:57.367

看看[这个](https://groups.google.com/forum/#!msg/android-qt/WdcIb1p38zg/ltJzXjzRg8EJ).. 有同样的问题（缺少 tools.jar）

# php - Facebook 登录按钮变形

> ID：11039857
> 
> 赞同：-1
> 
> 时间：2012-06-14T19:16:58.803
> 
> 标签：php, javascript, facebook, facebook-javascript-sdk

我在我的网站上实现了 Facebook 注册。一切正常，除了按钮突然被渲染扭曲。我正在本地测试网站。 ![在此处输入图像描述](../Images/a7278eb33e6441374f4c091d38da0345.png)

这是html代码：

```
echo '<ul id="login_menu">
<li id="login_button"><a>Login</a></li>
<li class="register_button"><a href="register.php">Register</a></li>
<li>  <fb:login-button registration-url="registerwithfb.php" /> 
</li>
</ul>'; 
```

javascript:

```
<div id="fb-root"></div>

    <script type="text/javascript">
       window.fbAsyncInit = function() {
        FB.init({
                appId   : '<?php echo $facebook->getAppId(); ?>',
                session : <?php echo json_encode($session); ?>, // don't refetch the      session when PHP already has it
                status  : true, // check login status
                cookie  : true, // enable cookies to allow the server to access the   session
                xfbml   : true // parse XFBML
        });

        // whenever the user logs in, we refresh the page
        FB.Event.subscribe('auth.login', function() {
                window.location.reload();
        });
};

(function() {
        var e = document.createElement('script');
        e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
        e.async = true;
        document.getElementById('fb-root').appendChild(e);
}()); 
```

和CSS：

```
#login_menu{
float:right;
}
 #login_menu li{
 margin:0;
 padding:0;
 float:left;
  position:relative;
  }

   #login_menu li a{
   text-decoration:none;
    list-style:none;
   line-height:50px;
  text-decoration:none;
  height:55px;
   font-weight:900;
   font-size:13px;
  border-right: 1px solid #555;
  padding: 0 15px;
  color:#59b1da;
  }
 #login_menu li a:hover{
  color:#ffffff;

   } 
```

任何的想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:12:01.620

注释掉#login_menu li a

因为它可能一直在干扰。很高兴我能帮上忙。

# compiler-errors - 在gentoo上编译dev86包失败

> ID：11039858
> 
> 赞同：2
> 
> 时间：2012-06-14T19:17:04.280
> 
> 标签：compiler-errors, virtualbox, gentoo

当我尝试安装 virtualbox 时，在编译 dev86 包期间出现以下错误：

```
00159                                           mov     spbbp
***** comma expected.........................................^
***** factor expected........................................^
***** illegal indirect to indirect...........................^

00091 errors
00000 warnings
make[4]: *** [__ldivmod.o] Error 1
make[4]: Leaving directory `/var/tmp/portage/sys-devel/dev86-0.16.18/work/dev86-0.16.18/libc/bcc'
make[3]: *** [/var/tmp/portage/sys-devel/dev86-0.16.18/work/dev86-0.16.18/libc/libc.a] Error 1
make[3]: Leaving directory `/var/tmp/portage/sys-devel/dev86-0.16.18/work/dev86-0.16.18/libc'
make[2]: *** [library] Error 2
make[2]: Leaving directory `/var/tmp/portage/sys-devel/dev86-0.16.18/work/dev86-0.16.18'
make[1]: *** [all] Error 2
make[1]: Leaving directory `/var/tmp/portage/sys-devel/dev86-0.16.18/work/dev86-0.16.18'
make: *** [all] Error 2
emake failed
 * ERROR: sys-devel/dev86-0.16.18 failed (compile phase):
 *   (no error message)
 * 
```

我尝试将 make 降级到 v3.81，使用旧版本的 dev86 并使用，但没有帮助。我尝试在 cflags 和 cxxflags 中使用 -D_FORTIFY_SOURCE，但也没有任何改变。

```
gentoo herman # emerge --info dev86
Portage 2.1.10.65 (default/linux/amd64/10.0, gcc-4.5.3, glibc-2.15-r2, 3.3.1-gentoo x86_64)
=================================================================
                        System Settings
=================================================================
System uname: Linux-3.3.1-gentoo-x86_64-Intel-R-_Core-TM-2_Duo_CPU_T9400_@_2.53GHz-with-gentoo-2.1
Timestamp of tree: Thu, 14 Jun 2012 15:45:01 +0000
ccache version 3.1.7 [enabled]
app-shells/bash:          4.2_p20
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.2-r3, 3.2.2
dev-util/ccache:          3.1.7
dev-util/cmake:           2.8.8-r3
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1
sys-apps/openrc:          0.9.8.4
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.11.3, 1.12.1
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.5.3-r2, 4.6.3
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r3
sys-kernel/linux-headers: 3.2 (virtual/os-headers)
sys-libs/glibc:           2.15-r2
Repositories: gentoo
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -mcx16 -msahf -msse4.1 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=6144 -mtune=generic"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/themes/oxygen-gtk/gtk-2.0 /var/lib/hsqldb"
CONFIG_PROTECT_MASK="${EPREFIX}/etc/gconf /etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo"
CXXFLAGS="-march=core2 -mcx16 -msahf -msse4.1 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=6144 -mtune=generic"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs ccache config-protect-if-modified distlocks ebuild-locks fixlafiles news parallel-fetch parse-eapi-ebuild-head protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://ftp.vectranet.pl/gentoo/ http://gentoo.mirror.pw.edu.pl/"
LANG="pl_PL.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="pl"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY=""
SYNC="rsync://rsync7.pl.gentoo.org/gentoo-portage"
USE="X aac aacplus acl acpi alsa amd64 amr apache2 aperfmperf apic apng arch_perfmon asf ass avx berkdb bts bzip2 cleartype clflush cli cmov consolekit constant_tsc corefonts cpudetection cracklib crypt cups custom-cflags cx16 cx8 cxx dbus de declarative dirac djvu dri ds_cpl dtes64 dts dvd encode est ffmpeg flexpriority fontconfig fortran fpu fxsr gd gdbm gles gpm gtk gtk3 gudev hardcoded-tables ht iconv icu jack java jpeg kde kipi lahf_lm libnotify lm lm_sensors mca mce minizip mmx mmxext mng modules monitor mp3 msr mtrr mudflap multilib multimedia mysql ncurses nls nopl nptl nsplugin nx ogg opengl openmp pae pam pat pbe pcre pdcm pdf pdfimport pebs pge php png pni policykit ppds pppd pse pse36 python qalculate qt-faststart qt3support qt4 qwt rdesktop readline rep_good samba scanner schroedinger semantic-desktop sep session smx source spell sql ss sse sse2 sse4_1 ssl ssse3 static-libs subvesion svg syscall tcpd threads tm tm2 tools tpr_shadow truetype tsc type1 udev unicode upower usb vhosts vme vmx vnmi vorbis webkit wicd wifi win32codec wma-fixed x264 xinerama xorg xosd xtpr xvid zeroconf zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="mouse keyboard evdev synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LINGUAS="pl" NETBEANS_MODULES="php websvccommon" PHP_TARGETS="php5-3" PYTHON_TARGETS="python3_2 python2_7" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON 
```

有人有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T09:32:14.040

我尝试`sys-devel/dev86-0.16.18`在 5 台硬化的 gentoo amd64 机器上构建包，它们都成功了。

尽管该软件包在编译期间显示了很多警告，并且之后显示了大量的 QA Notices，但这很可能是您的问题的原因：

```
 * QA Notice: Package triggers severe warnings which indicate that it
 *            may exhibit random runtime failures.
 * floatop.c:33:7: warning: dereferencing type-punned pointer will break strict-aliasing rules
 * floatop.c:48:7: warning: dereferencing type-punned pointer will break strict-aliasing rules
 * genloads.c:391:5: warning: dereferencing type-punned pointer will break strict-aliasing rules
 * genloads.c:395:5: warning: dereferencing type-punned pointer will break strict-aliasing rules
 * loadexp.c:79:3: warning: dereferencing type-punned pointer will break strict-aliasing rules

 * QA Notice: Package triggers severe warnings which indicate that it
 *            may exhibit random runtime failures.
 * dbprintf.c:24:4: warning: implicit declaration of function ‘vdbprintf’
 * dbprintf.c:30:1: warning: implicit declaration of function ‘write’
 * dbprintf.c:110:9: warning: implicit declaration of function ‘strlen’
 * dumps.c:22:9: warning: implicit declaration of function ‘memcmp’
 * dumps.c:25:2: warning: implicit declaration of function ‘strlen’
 * ld.c:221:8: warning: implicit declaration of function ‘ld86r’
 * mkar.c:41:7: warning: implicit declaration of function ‘fatalerror’

 * QA Notice: Package triggers severe warnings which indicate that it
 *            may exhibit random runtime failures.
 * dbprintf.c:110:13: warning: incompatible implicit declaration of built-in function ‘strlen’
 * dumps.c:25:6: warning: incompatible implicit declaration of built-in function ‘strlen’

 * QA Notice: Package triggers severe warnings which indicate that it
 *            may exhibit random runtime failures.
 * input.c:400:10: warning: array subscript is below array bounds

 * QA Notice: Package triggers severe warnings which indicate that it
 *            may exhibit random runtime failures.
 * makeboot.c:1247:7: warning: too few arguments for format

 * Please do not file a Gentoo bug and instead report the above QA
 * issues directly to the upstream developers of this software.
 * Homepage: http://www.debath.co.uk/ 
```

如果您的工具链过于“严格”或配置不正确，它可能很容易破坏编码不佳的包。正如我在之前的评论中提到的，您`CFLAGS`没有遵循[Gentoo Wiki 在您的 CPU 架构上](http://en.gentoo-wiki.com/wiki/Safe_Cflags/Intel#Core_2_Duo.2FQuad.2C_Xeon_51xx.2F53xx.2F54xx.2F3360.2C_Pentium_Dual-Core_T23xx.2B.2FExxxx.2C_Celeron_Dual-Core)推荐的“安全”值，它为您的 CPU 推荐以下设置：

```
64 bit profile (amd64) for >= GCC 4.3

CHOST="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -O2 -pipe"
CXXFLAGS="${CFLAGS}" 
```

可能需要使用更保守的`CFLAGS`.

但是在你这样做之前（这显然需要很多时间），你可能会尝试一些在遇到编译错误时通常可以工作的东西：

1.  确保您的系统是最新的并且所有软件包都同步：

    `emerge --sync && emerge -uDNav --with-bdeps=y @world`

2.  解决与旧包和损坏库的任何差异：

    `emerge --depclean && revdep-rebuild`

3.  切换回稳定包。我注意到您使用 运行`ACCEPT_KEYWORDS="amd64 ~amd64"`，这可能会导致不稳定软件包之外的意外问题。您可能想尝试`~amd64`从那里删除并声明您想要特定软件包的不稳定版本`/etc/portage/package.keywords`（[请参阅有关此主题的 Gentoo 手册](http://www.gentoo.org/doc/en/handbook/handbook-amd64.xml?part=3&chap=3)）。设置正确的标志后重试步骤 1 和 2。

如果构建这个包仍然失败并且你还没有放弃，你可以通过以下方式继续重建工具链：

1.  首先将`CFLAGS`,`CXXFLAGS`和其他指令（如`USE`和）设置`LDFLAGS`为`/etc/make.conf`.
2.  使用新配置重新编译 GCC 并确保选择了正确的版本以供使用：

    ```
    emerge gcc
    gcc-config -l 
    [1] i686-pc-linux-gnu-4.4.5 * 
    [2] i686-pc-linux-gnu-4.5.3
    gcc-config 2
    env-update && source /etc/profile 
    ```

3.  重建工具链的其余部分（参考：[升级 GCC](http://www.gentoo.org/doc/en/gcc-upgrading.xml)和[升级 Gentoo](http://www.gentoo.org/doc/en/new-upgrade-to-gentoo-1.4.xml)）：

    ```
    emerge libtool glibc binutils 
    ```

4.  喝杯咖啡，看场电影，回来重试最初的编译。

运行上述所有步骤非常耗时，但可以解决大多数`emerge`编译错误（当然，如果包本身没有损坏）。

作为参考，这里是`emerge --info`成功编译此包的正常（硬化）机器：

```
Portage 2.1.10.49 (hardened/linux/amd64, gcc-4.5.3, glibc-2.14.1-r3, 3.2.2-hardened-r1-RMZv1si x86_64)
=================================================================
System uname: Linux-3.2.2-hardened-r1-RMZv1si-x86_64-Intel-R-_Xeon-TM-_CPU_3.40GHz-with-gentoo-2.1
Timestamp of tree: Fri, 15 Jun 2012 08:00:01 +0000
app-shells/bash:          4.2_p20
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.3-r2, 3.2.3
dev-util/cmake:           2.8.7-r5
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1-r1
sys-apps/openrc:          0.9.8.4
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.4_p6-r1, 1.11.1
sys-devel/binutils:       2.21.1-r1
sys-devel/gcc:            4.5.3-r2
sys-devel/gcc-config:     1.6
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82-r1
sys-kernel/linux-headers: 3.1 (virtual/os-headers)
sys-libs/glibc:           2.14.1-r3
Repositories: gentoo x-boxed-main kormoc x-portage
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=nocona -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt /usr/share/openvpn/easy-rsa /var/bind /var/qmail/alias /var/qmail/control /var/vpopmail/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=nocona -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks ebuild-locks fixlafiles news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="ftp://ftp.snt.utwente.nl/pub/os/linux/gentoo http://ftp.snt.utwente.nl/pub/os/linux/gentoo ftp://mirror.leaseweb.com/gentoo/ http://mirror.leaseweb.com/gentoo/ "
LANG="en_US.UTF-8"
LC_ALL="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/boxed-main /var/lib/layman/kormoc /usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="acl amd64 apache2 auth_digest bash bash-completion bzip2 caps cli cracklib crypt ctype cxx dba dri ftp gd gdbm gpm hardened iconv imap innodb intl ipv6 ithreads jpeg jpeg2k justify memcache memcached mmx modules mudflap multilib mysql ncurses nls nptl openmp pam pax_kernel pcre php pic png pppd raw readline session slang snmp sockets sse sse2 ssl suexec svg tcpd threads tiff unicode urandom usagi valias vhosts vpopmail wmf xml xorg zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias authn_alias authn_anon authn_dbm authn_dbd authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation setenvif speling ssl status unique_id usertrack auth_basic auth_digest rewrite userdir vhost_alias bw bandwidth cgid" APACHE2_MPMS="prefork" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" PHP_TARGETS="php5-4" PYTHON_TARGETS="python3_2 python2_7" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="fbdev glint intel mach64 mga neomagic nouveau nv r128 radeon savage sis tdfx trident vesa via vmware dummy v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LINGUAS, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON 
```

祝你好运！

# java - 遗传算法的并行化显着减慢了算法。为什么会这样？

> ID：11039862
> 
> 赞同：2
> 
> 时间：2012-06-14T19:17:23.607
> 
> 标签：java, performance, parallel-processing, genetic-algorithm

我编写了一个遗传算法，为了优化它的性能，我决定对个体的适应度测试进行并行化。为了了解这对我的算法产生了什么样的变化，我重新进行了我在并行化之前所做的测试运行，在该运行中我测试了 GA 针对不断增长的人口规模的性能。

GA 的并行版本实际上比原始版本花费了大约 50% 的时间。我意识到有时并行化的开销实际上可能比它节省的时间更多，但我怀疑这是否应该适用于这种情况——我的适应性测试正在寻找 Sheckel 的 Foxholes 函数的全局最小值（[http://extreme.adorio -research.org/download/mvf/html/node51.html](http://extreme.adorio-research.org/download/mvf/html/node51.html)），我的人口规模从 10 到 1000 不等。我希望在并行执行 1000 次 sheckel 散兵坑时，节省的时间将大大超过并行化的开销。

所以我的问题是：为什么并行化会减慢算法的速度（并且如此显着）？

作为记录，我正在使用 Java 进行编码，并且正在使用 CountDownLatch 进行并行化，该 CountDownLatch 在继续之前等待所有线程（适应性测试）执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T23:01:21.820

根据您的评论，您似乎在做相当合理的事情，除了线程数。但是你提到你正在使用 CountDownLatch 让我思考......

我强烈建议您使用 an 来代替您自己的代码`ExecutorService/Executors`进行并行化。将你的类设为 a `Callable`，创建一堆，然后调用 invokeAll()。这样，训练有素（不确定他们是否高薪）的专家完成了大部分编码工作。

有了`Executors`，就很容易控制最大线程数。您可以调用`Runtime.availableProcessors()`以了解一次运行多少个线程，然后进行一些测试和调整。

编辑：刚刚发布了[将算法转换为使用 ExecutorService 的介绍。](http://flyingspaniel.blogspot.com/2012/06/how-to-parallelize-your-algorithm-with.html)享受，并欢迎评论/反馈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:25:39.990

好的，答案是它并没有像你想象的那样并行化。问题是“为什么？” 不看代码就很难得到答案。但是有一些明显的地方可以看：

*   确保（你会讨厌这个）你为 Thread 使用了正确的入口点。保证您的线程将序列化并且不告诉您任何事情的一种方法是调用`run()`方法而不是`start()`方法。这听起来很傻，但我已经被这个咬了。

*   使用例如 jconsole 确保线程完全同时运行。如果没有，你有一个意想不到的锁定某事。

*   检查您同步的内容。检查您正在使用的集合类。其中一些根本不是线程安全的，其中一些是线程安全的，因为它们具有内部同步。在线程之间共享的任何 Collection 类都可能是不法之徒。

*   如果没有任何结果，请与同事一起在纸上完成代码执行并手写出线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T02:58:46.187

所以我弄清楚了问题所在——我曾假设我的体能测试花费的时间足够长，以至于并行化是值得的，但事实并非如此。我填充了适应度测试，人为地延长了它（它只是我用来监控 GA 性能的测试适应度测试），我现在看到执行时间存在显着差异 - 现在人口规模的增长导致将执行时间延长 1000 秒，而不是 10 秒。我应该指出，这是在实施 Executor 之前，正如我们所建议的那样。

感谢大家的帮助！

# javascript - Javascript中OOP中的重复事件

> ID：11039869
> 
> 赞同：4
> 
> 时间：2012-06-14T19:17:49.567
> 
> 标签：javascript, oop, event-handling, dom-events

我知道问题出在哪里，但我真的不明白为什么会这样。假设你有这个：

HTML：

```
<div><p>Hello</p><button>Fire</button></div>
<br/>
<button id="menu-button">Menu</button> 
```

JavaScript：

```
function myObject(container, buttonElement) {
    this.container = container;
}

myObject.prototype.change = function () {
    var box = this.container;
    console.log(box);
    box.find('button').on('click', function() {
        console.log('firing');
        box.find('p').toggle();
    });

};

var obj1 = new myObject($('div'));
$('#menu-button').on('click', function(){
    obj1.change();
});​ 
```

小提琴：http: [//jsfiddle.net/L24As/1/](http://jsfiddle.net/L24As/1/)

如您所见，当您单击“菜单”按钮并`obj1.change()`启动时，这会向“Fire”按钮添加一个事件处理程序，一切都按预期工作。但是，如果您再次单击“菜单”按钮，您正在创建另一个事件，所以现在`toggle()`不起作用，因为第一个事件被隐藏而第二个事件正在显示段落。这是为什么？我原以为该事件应该被覆盖。

我是这样解决的：

[http://jsfiddle.net/L24As/3/](http://jsfiddle.net/L24As/3/)

```
function myObject(container) {
    this.container = container;
    this.change = function () {
        var box = this.container;
        console.log(box);
        box.find('button').on('click', function() {
            console.log('firing');
            box.find('p').toggle();
        });
    };
}

var obj1 = new myObject($('div'));
obj1.change(); 
```

这是一个好的解决方案吗？该事件从一开始就附加在“Fire”按钮上，因此“Menu”按钮用于显示其他内容，这使得它们有点不同，尽管它们执行相同的任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:39:24.597

> 我原以为该事件应该被覆盖。

不，它不会被覆盖。它正在添加它们并将它们全部触发（参见函数后面的[addEventListener](https://developer.mozilla.org/en/DOM/element.addEventListener)`on`）。

您应该添加一次事件。你的解决方案是正确的。

这是问题的本质（见评论）：

```
myObject.prototype.change = function () {
    var box = this.container;
    console.log(box);
    box.find('button').on(
        'click',

        // Here you create a new function object.
        // Each time you call the `change` method,
        // it will add another function object as an event handler.
        function () {
            console.log('firing');
            box.find('p').toggle();
        }
    );
}; 
```

# java - 正确使用 ArrayList

> ID：11039871
> 
> 赞同：0
> 
> 时间：2012-06-14T19:17:55.407
> 
> 标签：java, arraylist

我正在学习斯坦福大学的 CS106A 课程，其中一项任务是建立一个特定城市之间可用航班的数据库。我为一个城市编写了一个类，但`addDestination`第一次调用该方法有效，当添加第二个目的地时，`ArrayList`最终为空。为什么？这个真让我着迷。

```
import java.util.*;
    //class for a city. destinations are stored in an ArrayList
public class City {

    //Constructor
public City(String name){
    CityName = name;
}

//returns the name of the city
public String getName(){
    return CityName;
}
    // takes in a destination and adds it to the ArrayList unless
    //the destination already exists in which case it returns false.
public boolean addDestination(String destination){
    if (destinations.indexOf(destination)==-1){
        destinations.add(destination);
        return true;
    }
    else return false;
}

public Iterator<String> destIter(){
    Iterator<String> it =destinations.iterator();
    return it;
}

private ArrayList<String> destinations = new ArrayList<String>();
private String CityName;
} 
```

* * *

这是创建城市数据库的代码。`hm`是一个`HashMap`，它读取一个 txt 文件，其中每一行类似于“旧金山 - >纽约”

```
BufferedReader rd = new BufferedReader(new FileReader(FileName));
     String line = "";
     while (line!=null){
        if (line.indexOf("->")!=-1){
            String From = line.substring(0, line.indexOf("->")-1);
            String To = line.substring(line.indexOf('>')+2);
            City city = new City(From);
            if (hm.containsKey(From)==false)hm.put(From, city);
            hm.get(From).addDestination(To);

        }   
        line = rd.readLine();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:30:33.183

城市包含目的地？我认为这一切发生的原因是`private ArrayList<String> destinations = new ArrayList<String>`，你为城市实例创建了一个成员，而不是城市类，所以这意味着每个实例都有一个数组列表，但你只需要一个数组列表就可以将所有目的地放在一起，它是空的，因为这是您创建的第二个城市的数组

更具体地说，我需要看看你的主要方法来确定它是否真的如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T20:57:57.853

除了将实例变量放在顶部之外，您的代码对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T21:01:53.683

我不确定为什么您的城市目的地列表是空的。我调试了你的逐字代码，它对我有用。

仔细检查以确保您检查的不是来自 的目的地`city`，而是 `hm.get(From)`。如果您已经找到了一个城市，那么您正在创建一个您最终不会再次提及的城市。

一个更有效的`while`-block 可能如下所示：

```
while (line != null) {
    if (line.indexOf("->") != -1) {
        String From = line.substring(0, line.indexOf("->")-1);
        String To = line.substring(line.indexOf('>')+2);

        if (! hm.containsKey(From)) {
            hm.put(From, new City(From));
        }
        hm.get(From).addDestination(To);
    }
} 
```

# java - sshj exec 没有按我预期的方式显示结果

> ID：11039872
> 
> 赞同：0
> 
> 时间：2012-06-14T19:17:55.727
> 
> 标签：java, sshj

我试图从 Java SSH 到服务器并运行多个命令。这些命令似乎工作正常，但我没有在 Java 中得到我想要的结果。

这是我的代码片段

```
 final Command cmd = session.exec("cd /app/t/backo/bin && ls -all && pwd && . setDBLApp && sudo -E -u deploy ./runDBLApp && sudo -E -u deploy ./nightlyDBL -type host ");

        System.out.println(IOUtils.readFully(cmd.getInputStream()).toString());
        cmd.join(30, TimeUnit.SECONDS);
        System.out.println("\n** exit status: " + cmd.getExitStatus()); 
```

这是我看到的输出。我认为这与 LocalWindow 大小有关，但我不知道如何解决它。这仅在我使用具有大量屏幕输出的 ssh 命令时发生（或似乎发生）

这是一个小片段，我得到了 100 行左右

```
14:56:48.957 [reader] INFO  n.s.s.c.c.direct.SessionChannel - Received window adjustment for 2097152 bytes
14:56:48.957 [reader] DEBUG n.s.s.c.channel.Window$Remote - Increasing by 2097152 up to 2097152
14:56:48.957 [reader] DEBUG net.schmizz.concurrent.Promise - Setting <<chan#0 / chanreq for exec>> to `SOME`
14:56:48.963 [reader] DEBUG n.s.s.c.channel.Window$Local - Consuming by 4096 down to 2093056
14:56:48.964 [reader] DEBUG n.s.s.c.channel.Window$Local - Consuming by 1002 down to 2092054
14:56:48.964 [reader] DEBUG n.s.s.c.channel.Window$Local - Consuming by 23 down to 2092031
14:56:49.090 [reader] DEBUG n.s.s.c.channel.Window$Local - Consuming by 141 down to 2091890
14:56:49.120 [reader] DEBUG n.s.s.c.channel.Window$Local - Consuming by 267 down to 2091623
14:56:49.230 [reader] DEBUG n.s.s.c.channel.Window$Local - Consuming by 309 down to 2091314
14:56:49.531 [reader] DEBUG n.s.s.c.channel.Window$Local - Consuming by 308 down to 2091006
14:56:49.532 [reader] DEBUG n.s.s.c.channel.Window$Local - Consuming by 306 down to 2090700 
```

我想看到的是 ssh 命令的屏幕输出，可能很冗长

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T15:35:07.373

您认为这可能与窗口大小有关是正确的。为来自服务器的输出而保存的本地窗口 sshj 可能已填满。默认规则是当您通过读取 API 提供的 stdout/stderr 流（即`channel.getInputStream()`/`channel.getErrorStream()`

你有两个选择：

*   在命令执行时继续排空 stdout 和 stderr 流。根据您的代码段，您实际上是从标准输出读取，而不是从标准错误读取。`available()`您可以使用已实现的on 方法多路复用来自 2 个流的读取`java.io.InputStream`。

*   设置`sessionChannel.setAutoExpand(true)`但请注意，这意味着无论产生多少输出，即使您没有通过读取 stdout/stderr 流来耗尽本地窗口，它们也会继续扩展。所以这有可能导致高内存消耗。

# android - 如果我没有网站的数据库，在 Android 应用程序中检索其信息的替代方法是什么？

> ID：11039873
> 
> 赞同：1
> 
> 时间：2012-06-14T19:17:57.933
> 
> 标签：android

我想开发一个应用程序来显示其网站上特定频道的节目时间表。我确实没有他们的网站，但是，是否有其他一些技术可以从页面中检索某些特定数据，在我的情况下是程序的名称及其传播时间。该网站也没有 RSS 提要。请问有什么想法吗？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T19:23:03.123

您拥有该网站吗？如果不是，您需要从网站上抓取它的数据以及您对数据的处理方式，那么您可能会遇到法律问题。

抓取数据基本上只是摄取 HTML 并解析页面中包含所需信息的字段。如果网站结构良好，它可以相当简单。也许你可以使用[JSOUP](http://jsoup.org/)

有关更多详细信息，请参阅[此](https://stackoverflow.com/questions/5173538/android-jsoup-example)线程

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T19:24:54.627

您可以检查该页面是否提供 API。如果是这样，您通常可以连接到 REST 服务，然后您可以通过 POST 或 GET 请求访问该服务。你通常会得到一个 xml 或 json 数组。

或者，如果他们不提供 API，您可以手动解析 (HTML) 数据。尽管我不建议这样做，因为大多数网站都禁止这样做，并且一旦更改元素就不会起作用。

# bash - 命令行终端上的乘法

> ID：11039876
> 
> 赞同：124
> 
> 时间：2012-06-14T19:18:09.893
> 
> 标签：bash, unix, command-line

我正在使用串行终端为我们的实验室实验提供输入。我发现使用

```
$ echo "5X5" 
```

只返回一个字符串`"5X5"`。是否有执行乘法运算的命令？

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2012-06-14T19:20:09.440

是的，你可以使用[bash 的内置算术扩展`$(( ))`](https://www.gnu.org/software/bash/manual/html_node/Arithmetic-Expansion.html)来做一些简单的数学运算

```
$ echo "$((5 * 5))"
25 
```

查看[Bash 参考手册中的 Shell Arithmetic 部分以](https://www.gnu.org/software/bash/manual/html_node/Shell-Arithmetic.html#Shell-Arithmetic)获取完整的运算符列表。

为了完整起见，正如其他人指出的那样，如果您需要任意精度，[`bc`](http://www.manpagez.com/man/1/bc/)或者[`dc`](http://www.manpagez.com/man/1/dc/)会更好。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2012-06-14T19:21:43.860

对于更高级和更精确的数学，请考虑使用 bc(1)。

```
echo "3 * 2.19" | bc -l 
6.57 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-06-14T19:30:27.610

### 内部方法

Bash[支持](http://www.gnu.org/software/bash/manual/html_node/Arithmetic-Expansion.html)使用`$(( expression ))`. 例如：

```
$ echo $(( 5 * 5 ))
25 
```

### 外部方法

许多实用程序提供算术，包括*bc*和*expr*。

```
$ echo '5 * 5' | /usr/bin/bc
25

$ /usr/bin/expr 5 \* 5
25 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-06-14T19:24:38.237

经典的解决方案是：

```
 expr 5 \* 5 
```

`expr`仅适用于整数操作数。另一个不错的选择是：

```
 echo 5 5\*p | dc 
```

`dc`可以使用非整数操作数。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-08-15T19:35:20.677

一个简单的 shell 函数（不需要 sed）应该可以解释 '5X5'

```
$ function calc { bc -l <<< ${@//[xX]/*}; };
$ calc 5X5
25
$ calc 5x5
25
$ calc '5*5'
25 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-06-14T20:54:21.883

我使用这个函数，它使用`bc`并因此支持浮点计算：

```
c () { 
    local a
    (( $# > 0 )) && a="$@" || read -r -p "calc: " a
    bc -l <<< "$a"
} 
```

例子：

```
$ c '5*5'
25
$ c 5/5
1.00000000000000000000
$ c 3.4/7.9
.43037974683544303797 
```

Bash 的算术扩展不支持浮点数（但 Korn shell 和 zsh 支持）。

例子：

```
$ ksh -c 'echo "$((3.0 / 4))"'
0.75 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-14T19:29:55.883

我有一个用于此目的的简单脚本：

`me@mycomputer:~$ cat /usr/local/bin/c`

```
#!/bin/sh

echo "$*" | sed 's/x/\*/g' | bc -l 
```

它更改`x`为`*`因为`*`是 shell 中的一个特殊字符。按如下方式使用它：

*   `c 5x5`
*   `c 5-4.2 + 1`
*   `c '(5 + 5) * 30'`（如果表达式包含任何括号，您仍然必须使用引号）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-01-05T17:38:24.480

如果你喜欢 python 并且可以选择安装包，你可以使用我制作的这个[实用程序。](https://github.com/bombs-kim/pythonp)

```
# install pythonp
python -m pip install pythonp

pythonp "5*5"
25

pythonp "1 / (1+math.exp(0.5))"
0.3775406687981454

# define a custom function and pass it to another higher-order function
pythonp "n=10;functools.reduce(lambda x,y:x*y, range(1,n+1))"     
3628800 
```

# php - 管理多个共享重叠函数和类的代码库

> ID：11039881
> 
> 赞同：4
> 
> 时间：2012-06-14T19:18:49.897
> 
> 标签：php, version-control

我们有一个网站，它有大约 9 个不同的代码库，用于它的各种功能，可以在不同的服务器上运行。

我们使用 SVN 和脚本将代码从 repo 复制到登台服务器进行测试，所以这一切都是自动化的。我的问题是，不同代码库中存在函数和类，它们需要保持同步。因此，修复一个获得时间偏移的函数中的一个小错误，将需要我手动编辑 5 个其他代码库中的 5 个其他文件。一旦代码占用量增加，我什至不会记得这个特定的功能也可能存在于其他 5 个地方。

处理这类东西的最佳方法是什么，而不是只创建 2-3 个大型“functions.php”文件并将它们每次都克隆到所有代码库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:26:54.103

我建议创建一个新的 SVN 存储库（其中包含共享类、文件等）并将其作为外部存储库链接到需要共享代码的其他项目存储库中。

例如，您有许多项目：

1.  项目A
2.  项目B

等等等等。

可以说这两个项目共享许多类。

我认为前进的一种方法是创建一个包含共享类的新 SVN 存储库，然后将此 SVN 存储库链接到您现有的存储库。

**优点**

将允许您将统一和共享的代码部署到所有项目，而无需在每次更新代码存储库时手动编辑 x 数量的文件。

此外，如果您还没有这样做，我会考虑使用[phing（一种部署工具）部署您的代码。](http://www.buildmeister.com/articles/automating_the_php_deployment_process_with_phing,_dbdeploy_and_ftp)它真的非常好用。提供的链接是一个很好的简单教程。

# javascript - 将 Onclick 函数转移到 jQuery

> ID：11039882
> 
> 赞同：1
> 
> 时间：2012-06-14T19:18:50.863
> 
> 标签：javascript, jquery

我有一个用主图像替换缩略图的 jQuery 函数。这是我用来替换主图像的代码：

```
$(document).ready(function(){
    $(".wheelFinishThumbs a").click(function() {
    var mainImage = $(this).attr("href");
    var mainTemp = mainImage.replace(/-mid/,'');
    var mainTemp = mainTemp.replace(/png/,'jpg');
    $("#main_view img").attr('src', mainImage );
    $("#main_view a").attr('href',mainTemp);
    return false;       
    }); 
```

我使用 PHP 函数通过更改标题值来下载（保存）图像。这是我用来下载图像的 HTML 代码

```
<a href="#" onclick="window.open('download.php?file=image.jpg','_self', 'download', 'status=0');">Click to download</a> 
```

但由于“image.jpg”必须是我的动态变量，所以我必须如何在 jQuery 图像替换函数中调用此参数，并在每次更改主图像时动态替换“image.jpg”。我想用`var mainImage`我的图像交换功能替换 image.jpg。

我的 jQuery 知识真的很有限，所以如果有人可以帮助我做到这一点，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:27:26.507

这应该可以工作，假设您使用的是 jQuery 1.7+

假设在您将 href 动态设置为新图像后，您的标签标记是这样的

```
<a href="urltoSomeImage.jpg" id="main_view">Download Image</a> 
```

JavaScript

```
$(function(){
  $(document).on("click","#main_view",function(e){
      e.preventDefault();
      var self=$(this);
      alert("replace this with awesome code")

      window.open('download.php?file='+self.attr("href")+,'_self', 'download', 'status=0');
  });
}); 
```

请注意，此函数仅适用于单个 a 元素，因为我们的目标是将功能绑定到 ID 为 main_view 的元素。由于 ID 在 DOM 中应该是唯一的，如果您想拥有许多 a 标签的功能，我会像这样向 a 标签添加一个通用类选择器

```
<a class="aDownloadble" href="urltoSomeImage2.jpg" id="main_view">Download Image2</a>
<a class="aDownloadble" href="urltoSomeImage4.jpg" id="main_view">Download Image4</a> 
```

并像这样更新我的脚本

```
$(function(){
  $(document).on("click",".aDownloadble",function(e){
      e.preventDefault();
      var self=$(this);
      alert("replace this with awesome code")

      window.open('download.php?file='+self.attr("href"),'_self', 'download', 'status=0');
  });
}); 
```

jQuery`on`不是必需的。您可以直接使用`click`事件绑定。但是，如果您通过 ajax 加载这些链接的标记/动态注入到 DOM，您应该使用`on`or `live`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:24:48.710

```
$(document).ready(){

    $("#main_view a").click(function() {
     // Code to run when user clicks on link
    });
}); 
```

# c# - 从html样式属性中解析引号

> ID：11039883
> 
> 赞同：1
> 
> 时间：2012-06-14T19:18:52.643
> 
> 标签：c#, html

我需要找到一种方法来删除字体系列样式中字体名称周围的单引号。

所以这...

```
<span style="font-family: 'Verdana'; color: #0000ff; font-size: 10pt;"><span style="font-family: 'Arial';"><strong>2.0: Scope</strong></span></span> 
```

会变成这样...

```
<span style="font-family: Verdana; color: #0000ff; font-size: 10pt;"><span style="font-family: Arial;"><strong>2.0: Scope</strong></span></span> 
```

我只关心用**双**引号括起来的样式属性。如果它们被单引号包围，那么我知道字体名称不会被单引号包围。

我必须在 C# 中执行此操作，因为处理此 Html 的应用程序作为 Windows 服务运行。

我知道通常使用正则表达式解析 Html 是不可以的，但我希望这可能是一个例外，因为我正在寻找一个非常具体的案例。我确实可以访问 Html 解析器，但与正则表达式相比非常慢。

这是我能想到的最好的……

```
var html = "<span style=\"font-family: 'Verdana'; color: #0000ff; font-size: 10pt;\"><span style=\"font-family: 'Arial';\"><strong>2.0: Scope</strong></span></span>";
var newHtml = Regex.Replace(html, "style(.*)=(.*)\"(.*)font-family:(.*?)[\">]", m => m.Value.Replace("'", "")); 
```

它实现了正确的目标，但并没有真正找到正确的匹配项。符合这个...

```
style="font-family: Verdana; color: #0000ff; font-size: 10pt;"><span style="font-family: Arial;" 
```

我想要做的是找到两个这样的匹配......

```
style="font-family: 'Verdana'; color: #0000ff; font-size: 10pt;"
style="font-family: 'Arial';" 
```

作为一个正则表达式新手，我似乎找不到正确的组合。

或者更具体地说，我需要一种方法来在由单引号包围的字体系列中找到一个值，然后从该值中删除单引号。

有人可以帮我想出适当的正则表达式吗？
在这种情况下，是否有替代正则表达式可以更好地工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:57:06.247

这是我解决它的方法...

```
var html = "<span style=\"font-family: 'Verdana'; color: #0000ff; font-size: 10pt;\"><span style=\"font-family: 'Arial';\"><strong>2.0: Scope</strong></span></span>"; 
var newHtml = Regex.Replace(html, "style\\s*=\\s*\"[^\"]*\\bfont-family:.*?'.*?(;|\")", m => m.Value.Replace("'", ""); 
```

感谢 Lou 引导我朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T20:01:34.043

发生这种情况是因为正则表达式匹配是贪婪的——它会尝试匹配最长的匹配字符串。

```
var newHtml = Regex.Replace(html, "style(.*)=(.*)\"(.*)font-family:(.*?)[\">]", m => m.Value.Replace("'", "")); 
```

你的问题是`(.*?)`字体系列之后 - 它甚至会继续过去关闭标签。一个简单的解决方法是

```
var newHtml = Regex.Replace(html, "style(.*)=(.*)\"(.*)font-family:([^>]*?)[\">]", m => m.Value.Replace("'", "")); 
```

`^`in`[^>]`表示不是这些字符。

当然，这些都是 hack —— 肯定有真正的 HTML 是行不通的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T20:11:29.997

将您进入此函数的每个字符串传递给：

```
private static string RemoveSingleQuote(string psHTML) {
    // If it starts with the single quote after "style=" then, just return the string.
    if (psHTML.StartsWith("<span style=\'")) return (psHTML);

    StringBuilder sb = new StringBuilder();

    foreach (char c in psHTML) {
        if (c != '\'') {
            sb.Append(c);
        }
    }

    return (sb.ToString());
} 
```

# javascript - ScrollIntoView() 导致整个页面移动

> ID：11039885
> 
> 赞同：173
> 
> 时间：2012-06-14T19:18:56.397
> 
> 标签：javascript, css

我正在使用 ScrollIntoView() 将列表中突出显示的项目滚动到视图中。当我向下滚动时， ScrollIntoView(false) 工作得很好。但是当我向上滚动时， ScrollIntoView(true) 会导致整个页面移动一点，我认为这是有意的。使用 ScrollIntoView(true) 时有没有办法避免整个页面移动？

这是我页面的结构 -

```
#listOfDivs {
  position:fixed;
  top:100px;
  width: 300px;
  height: 300px;
  overflow-y: scroll;
}

<div="container">
    <div="content"> 
         <div id="listOfDivs"> 
             <div id="item1"> </div>
             <div id="item2"> </div>
             <div id="itemn"> </div>
         </div>
    </div>
</div> 
```

listOfDivs 来自 ajax 调用。使用移动 Safari。

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2018-10-16T12:22:03.677

修复它：

```
element.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' }) 
```

见：[https ://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView)

* * *

## 回答 #2

> 赞同：158
> 
> 时间：2012-06-14T21:08:29.033

您可以使用`scrollTop`而不是`scrollIntoView()`：

```
var target = document.getElementById("target");
target.parentNode.scrollTop = target.offsetTop; 
```

jsFiddle：http: [//jsfiddle.net/LEqjm/](http://jsfiddle.net/LEqjm/)

如果要滚动多个可滚动元素，则需要根据中间元素`scrollTop`的 s 单独更改每个元素的 。`offsetTop`这应该为您提供细粒度的控制，以避免您遇到的问题。

编辑： offsetTop 不一定相对于父元素 - 它是相对于第一个定位的祖先。如果父元素未定位（相对、绝对或固定），您可能需要将第二行更改为：

```
target.parentNode.scrollTop = target.offsetTop - target.parentNode.offsetTop; 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2018-08-10T16:17:22.867

```
var el = document.querySelector("yourElement");
window.scroll({top: el.offsetTop, behavior: 'smooth'}); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2018-12-07T09:47:16.383

我也遇到了这个问题，花了很多时间来解决它。我希望我的决议仍然可以帮助一些人。

我的修复最终是：

*   对于 Chrome：更改`.scrollIntoView()`为`.scrollIntoView({block: 'nearest'})`（感谢 @jfrohn）。
*   对于 Firefox：应用于`overflow: -moz-hidden-unscrollable;`发生变化的容器元素。
*   未在其他浏览器中测试。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-03-11T18:37:53.197

玩弄`scrollIntoViewIfNeeded()`...确保浏览器支持它。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2020-04-30T11:33:54.577

在我的上下文中，他会将粘性工具栏从屏幕上推开，或者在绝对按钮旁边输入。

使用最近求解。

```
const element = this.element.nativeElement;
const table = element.querySelector('.table-container');
table.scrollIntoView({
  behavior: 'smooth', block: 'nearest'
}); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-09-01T12:40:09.537

我添加了一种方法来显示 ScrollIntoView 的不当行为 - [http://jsfiddle.net/LEqjm/258/](http://jsfiddle.net/LEqjm/258/) [应该是评论，但我没有足够的声誉]

```
$("ul").click(function() {
    var target = document.getElementById("target");
if ($('#scrollTop').attr('checked')) {
    target.parentNode.scrollTop = target.offsetTop;    
} else {
        target.scrollIntoView(!0);
}
}); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-06-15T07:02:50.787

## jQuery插件`scrollintoview()`增加了可用性

除了默认的 DOM 实现之外，您还可以使用动画移动并且没有任何不需要的效果的插件。这是使用默认值的最简单方法：

```
$("yourTargetLiSelector").scrollintoview(); 
```

无论如何，请访问此[博客文章](http://erraticdev.blogspot.ie/2011/02/jquery-scroll-into-view-plugin-with.html)，您可以在其中阅读所有详细信息，并最终将您带到该插件的[GitHub 源代码](https://github.com/litera/jquery-scrollintoview)。

该插件会自动搜索最近的可滚动祖先元素并滚动它，以便选定元素位于其可见视口内。如果元素已经在视口中，它当然不会做任何事情。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-02-04T11:20:20.110

添加更多信息以`@Jesco`发布。

*   [**`Element.scrollIntoViewIfNeeded()`**](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoViewIfNeeded) [*`non-standard WebKit method`*](https://gist.github.com/hsablonniere/2581101)适用于 Chrome、Opera、Safari 浏览器。
    *如果元素已经在浏览器窗口的可见区域内，则不会发生滚动*。
*   **`Element.scrollIntoView()`**方法将调用它的元素滚动到浏览器窗口的可见区域。

`mozilla.org` [`scrollIntoView()`](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView)在链接中尝试以下代码。^(发布以识别[浏览器](https://stackoverflow.com/a/9851769/5081877))

```
var xpath = '//*[@id="Notes"]';
ScrollToElement(xpath);

function ScrollToElement(xpath) {
    var ele = $x(xpath)[0];
    console.log( ele );

    var isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime);
    if (isChrome) { // Chrome
        ele.scrollIntoViewIfNeeded();
    } else {
        var inlineCenter = { behavior: 'smooth', block: 'center', inline: 'start' };
        ele.scrollIntoView(inlineCenter);
    }
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-06-06T12:58:34.790

使用 Brilliant 的想法，这是一个仅在元素当前不可见时才（垂直）滚动的解决方案。这个想法是获取视口的边界框和要在浏览器窗口坐标空间中显示的元素。检查它是否可见，如果不可见，则滚动所需的距离，以便元素显示在视口的顶部或底部。

```
 function ensure_visible(element_id)
    {
        // adjust these two to match your HTML hierarchy
        var element_to_show  = document.getElementById(element_id);
        var scrolling_parent = element_to_show.parentElement;

        var top = parseInt(scrolling_parent.getBoundingClientRect().top);
        var bot = parseInt(scrolling_parent.getBoundingClientRect().bottom);

        var now_top = parseInt(element_to_show.getBoundingClientRect().top);
        var now_bot = parseInt(element_to_show.getBoundingClientRect().bottom);

        // console.log("Element: "+now_top+";"+(now_bot)+" Viewport:"+top+";"+(bot) );

        var scroll_by = 0;
        if(now_top < top)
            scroll_by = -(top - now_top);
        else if(now_bot > bot)
            scroll_by = now_bot - bot;
        if(scroll_by != 0)
        {
            scrolling_parent.scrollTop += scroll_by; // tr.offsetTop;
        }
    } 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-11-07T16:42:09.203

只是根据我的最新经验和在 VueJs 上的工作添加一个答案。我发现下面的代码广告最好，无论如何它不会影响您的应用程序。

```
const el = this.$el.getElementsByClassName('your_element_class')[0];
if (el) {
   scrollIntoView(el,
                  {
                       block: 'nearest',
                       inline: 'start',
                       behavior: 'smooth',
                       boundary: document.getElementsByClassName('main_app_class')[0]
                    });
     } 
```

`main_app_class`是根类

`your_element_class`是您可以滚动到的元素/视图

对于不支持 ScrollIntoView() 的浏览器，只需使用下面的库，它的真棒 [https://www.npmjs.com/package/scroll-into-view-if-needed](https://www.npmjs.com/package/scroll-into-view-if-needed)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-04-12T20:04:06.090

我有同样的问题，我通过删除`transform:translateY`我放置在`footer`页面上的 CSS 来修复它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-03-23T23:04:17.703

ScrollIntoView() 导致页面移动。但是下面的代码对我来说很好，并将屏幕移动到元素的顶部：

```
window.scroll({
  top: document.getElementById('your-element')?.offsetParent.offsetTop,
  behavior: 'smooth',
  block: 'start',
}) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-11-01T17:51:11.387

FWIW：我发现（在 Chrome 95 和 Firefox 92（所有 Mac）中）使用：

.scrollIntoView({ behavior:'smooth', block:'center'});

在可滚动的选项列表上会稍微滚动一下 body 元素，所以我选择使用：

.scrollIntoView({ behavior:'smooth', block:'nearest'});

并选择一个**超过我想要居中**的选项（例如，在一个可滚动的元素中，可以查看 5 行/选项，我选择了第二个选项，超过了我想要居中的那个，从而使所需元素居中。

[![在此处输入图像描述](../Images/3509e7f5a6660d84e90ac2d87ed68190.png)](https://i.stack.imgur.com/Fvvrm.png)

# mysql - 查找从查询中找到的值的总和

> ID：11039887
> 
> 赞同：0
> 
> 时间：2012-06-14T19:19:03.470
> 
> 标签：mysql, sql

我有一个查询，它返回两行数据作为计数。我想找到列值的总和。我的 sql：

```
(SELECT count(memberid) count 
   FROM `friendRequest`, Member 
   where status = 2 and memberid = sender and receiver = 19) 
UNION 
(SELECT count(memberid) count 
   FROM `friendRequest`, Member 
   where status = 2 and memberid = receiver and sender = 19) 
```

我试过使用`Select Sum(my above query)`，但我收到错误。我只需要上面的一些值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:28:05.390

可以在单个查询中获取两个结果集：

```
SELECT count(memberid) count 
FROM `friendRequest`, Member 
WHERE status = 2 AND (
    (memberid = sender AND receiver = 19) OR 
    (memderid = receiver AND sender = 19)
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:20:47.540

尝试：

```
SELECT SUM(count)
FROM
  ...the rest of your query... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:30:15.510

如果要使用聚合，则需要使用以下内容对其进行分组`GROUP BY`

```
(SELECT count(memberid) SUM(count) 
   FROM `friendRequest`, Member 
   where status = 2 and memberid = sender and receiver = 19
   GROUP BY Member) 
UNION 
(SELECT count(memberid) SUM(count) 
   FROM `friendRequest`, Member 
   where status = 2 and memberid = receiver and sender = 19
   GROUP BY Member) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T19:30:23.463

以下应该按原样工作

```
SELECT SUM(count)
FROM   (
         (SELECT count(memberid) count 
          FROM `friendRequest`, Member 
          where status = 2 and memberid = sender and receiver = 19) 
          UNION 
         (SELECT count(memberid) count 
          FROM `friendRequest`, Member 
          where status = 2 and memberid = receiver and sender = 19)
       ) AS anyAliasWillDo 
```

但我强烈建议您停止使用隐式连接*（已过时）*并开始使用显式连接语法。然后声明变成

```
SELECT SUM(COUNT)
FROM   (
            SELECT  COUNT(memberid) AS COUNT 
            FROM    `friendRequest` AS fr
                    INNER JOIN Member AS m ON m.memberid = fr.sender
            WHERE   status = 2 AND receiver = 19 
            UNION ALL
            SELECT  COUNT(memberid) AS COUNT 
            FROM   `friendRequest` AS fr 
                    INNER JOIN Member AS m ON m.memberid = fr.receiver
            WHERE   status = 2 AND sender = 19
        ) AS AnyAliasWillDo 
```

# zend-framework - Zend Framework 应用程序的日志记录请求

> ID：11039889
> 
> 赞同：3
> 
> 时间：2012-06-14T19:19:07.320
> 
> 标签：zend-framework, logging, request

我需要帮助记录 Zend Framewrok 应用程序（版本 1.11），每个请求..

我需要知道请求的时间和执行请求的时间。我想将每个请求保存到数据库中，但我不确定我会在哪里捕获这些信息。

我可能可以通过一些 _init 方法在 bootstrap.php 中捕获请求的开始。但是，如果我需要连接到数据库，我应该在哪里缓存有关执行请求结束的信息？此外，我在我的控制器中使用 $this->_redirector->gotoSimpleAndExit() 并且我需要在这种情况下计数 - 没有呈现视图并且请求仅通过 exit() 函数完成。

我想每个请求只写一次日志信息。

感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T11:00:35.213

注册关闭功能非常有用。 [http://php.net/manual/en/function.register-shutdown-function.php](http://php.net/manual/en/function.register-shutdown-function.php)

我创建了自定义记录器（单例模式），我在引导程序中调用它......因为 php 5.4 可用 $_SERVER['REQUEST_TIME_FLOAT']。Logger 在构造函数中将他的方法注册为关闭函数，并在他的析构函数中调用它。防止多次调用关闭函数。

即使调用了 exit() 函数，此解决方案也有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T07:13:51.013

对于我的一个项目，我将“执行结束”日志记录代码放在我的布局脚本中。它应该是要执行的“最后”事情之一。

不过，我没有为这个项目使用重定向。所以，我不确定应该如何扩展它以考虑您的“gotoSimpleAndExit()”案例。

希望有帮助，

# javascript - Canvas Child 上的 JQuery 侦听器不起作用

> ID：11039890
> 
> 赞同：0
> 
> 时间：2012-06-14T19:19:08.380
> 
> 标签：javascript, jquery, html, canvas

我有一个问题，我正在画布上实现裁剪自定义矩形我在 Javascript 中创建了一个函数，当调用裁剪函数时，在现有画布上创建一个子项，然后使用 JQuery 侦听器绘制矩形。创建子节点正确，而听众不工作，他们没有得到事件。这是我的代码：

```
var dragging = false;
var xstart = 0;
var ystart = 0;
var width = 0;
var height = 0;
var ctxotmp = null;
var ctxtmp = null; 
var canvastmp = null;
var mycanvas = null;
function draw() {
 ctxtmp.fillRect(xstart, ystart, width, height);
}

function init() {
    mycanvas = $('#mycanvas')[0];
   // create temp canvas
    canvastmp = document.createElement('canvas');
    canvastmp.id = "mycanvastmp";
    canvastmp.width = mycanvas.width;
    canvastmp.height = mycanvas.height;
    mycanvas.parentNode.appendChild(canvastmp);
    $("#mycanvastmp").css({position:"absolute",top:$("#mycanvas").css("top"),left:$("#mycanvas").css("left")});
    canvastmp = $('#mycanvastmp')[0];
   ctxtmp = canvastmp.getContext('2d');
   ctxtmp.lineWidth = 1;
   ctxtmp.fillStyle = "rgba(0, 0, 0, 0.5)";
}
//listener
$('#mycanvastmp').mousedown(function(e) {
    var xoffs = $(this).offset().left;
    var yoffs = $(this).offset().top;
    xstart = e.pageX - xoffs;
    ystart = e.pageY - yoffs;
    dragging = true;
  });

  $('#mycanvastmp').mousemove(function(e) {
    if(dragging) {
      var xoffs = $(this).offset().left;
      var yoffs = $(this).offset().top;
      width = e.pageX - xoffs - xstart;
      height = e.pageY - yoffs - ystart;
      ctxtmp.clearRect(0, 0, $(this).width(), $(this).height());
      draw();
    }
  });

  $('#mycanvastmp').mouseup(function() {
    dragging=false;
    alert('The rectangle for crop (x, y, width, height): ' + xstart + ', ' + ystart + ', ' + width + ', ' + height);
  }); 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:31:05.350

您需要使用`.on` **[on 方法](http://api.jquery.com/on/)**将事件绑定到动态创建的对象。当您的页面最初加载并且 dom 触发时，它看不到`tempCanvas`，因此最初不会附加它们。

```
//listener
$('body').on('mousedown' ,'#mycanvastmp', function(e) {

    var xoffs = $(this).offset().left;
    var yoffs = $(this).offset().top;
    xstart = e.pageX - xoffs;
    ystart = e.pageY - yoffs;
    dragging = true;
  });

  $('body').on('mousemove' ,'#mycanvastmp', function(e) {
    if(dragging) {
      var xoffs = $(this).offset().left;
      var yoffs = $(this).offset().top;
      width = e.pageX - xoffs - xstart;
      height = e.pageY - yoffs - ystart;
      ctxtmp.clearRect(0, 0, $(this).width(), $(this).height());
      draw();
    }
  });

 $('body').on('mouseup' ,'#mycanvastmp', function(e) {
    dragging=false;
    alert('The rectangle for crop (x, y, width, height): ' + xstart + ', ' + ystart + ', ' + width + ', ' + height);
  });

init(); 
```

**[现场演示](http://jsfiddle.net/loktar/GbM25/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:32:09.767

看起来您在创建临时画布之前附加了事件。`init()`在将临时画布添加到 DOM 后附加函数中的事件或使用[.delegate()](http://api.jquery.com/delegate)或[.on()](http://api.jquery.com/on)

```
$("#mycanvas").on("mouseup", "#mycanvastmp", function() {
    //...
}); 
```

# c# - 创建异步 Web 服务

> ID：11039900
> 
> 赞同：3
> 
> 时间：2012-06-14T19:20:00.813
> 
> 标签：c#, service, asynchronous, web

是否可以创建一个可以异步调用的 C# Web 服务，而自动生成的客户端不需要通过多线程提供同步。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T19:20:54.310

是的，自动生成的代理始终包含每个方法的同步和异步版本。例如，如果服务器公开了一个名为 的方法`DoWork`，则代理将同时包含一个`DoWork`方法和一个`DoWorkAsync`方法。当方法的异步版本完成它的工作时，代理会引发一个完成的事件，在这种情况下`DoWorkCompleted`。该`DoWork`方法的返回值将包含在事件 args 中。

# jquery - 启用/禁用锚标签（类似于 twitter bootstrap .disabled 类）

> ID：11039907
> 
> 赞同：0
> 
> 时间：2012-06-14T19:20:12.987
> 
> 标签：jquery, twitter-bootstrap, anchor

我有一个页面，允许用户使用 html 编辑器小部件编辑页面内容。有一个用于编辑的锚标记。我想根据操作模式启用和禁用用于编辑的锚标记。如果用户未处于编辑模式，则启用锚标记，否则禁用它。我已经看到使用 twitter 引导程序禁用了带有 .btn .disabled 类的锚标记。我想要跨多个浏览器但不使用引导程序的类似功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:22:40.160

要禁用锚标记的默认行为，您可以使用：

```
 $("a").click(function(e) {
   e.preventDefault();
}); 
```

要取消绑定，这应该可以： `$('a').unbind('click');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:51:08.413

我不知道这是否是*正确*的方法，但我有

```
<a href="whatever">Link Text</a><span>Link Text</span> 
```

并简单地使用 css/jquery 来显示/隐藏链接或范围。

很可能有一种更优雅的方式来达到预期的效果。

# asp-classic - 使用 Windows 身份验证时 IIS7.5 中的 LDAP 错误

> ID：11039908
> 
> 赞同：1
> 
> 时间：2012-06-14T19:20:15.980
> 
> 标签：asp-classic, vbscript, ldap, iis-7.5, windows-authentication

我遇到了 LDAP 的问题，它有点奇怪。我的 Web 服务器是 IIS7.5（windows server 2008 R2）。其配置为使用 Windows 身份验证。我在下面粘贴了我的asp页面。

Web浏览器为IE8，已将网站添加到Intranet区域并启用发送，如果Intranet区域在安全选项卡->自定义级别中启用用户详细信息。在高级选项卡中启用了集成 Windows 身份验证。

一切正常 20 分钟（会话时间设置和其他默认超时设置为 20 分钟）。20 分钟后，我得到了 ASP 运行时错误。其中表示不支持对象 objUser 的方法或属性 memberOf。当我得到以下错误时，我将身份验证类型更改为基本身份验证。它提示输入 Windows 凭据并且工作正常。之后，我再次恢复到 Windows 身份验证。它可以工作一段时间。

不确定 IIS7.5 id 是否配置了启用基本身份验证和 IE8 配置如上，仍然为什么提示输入 windows 凭据。虽然 Windows 身份验证模式不会提示输入凭据，但它可以正常工作，但在一段时间内。谁能解释我为什么会出现这种奇怪的行为以及解决此问题的解决方案？

```
<%@ LANGUAGE="VBSCRIPT" %>
<%
 Option Explicit

Dim oADSysInfo
Dim objUser
Dim strGroupData
Dim strUserDN
 Dim arrGroups
 Dim strGroup
 Dim wsObject
 Dim netSys
 Dim strUsrDomain

 strGroupData = ""
    Set wsObject = CreateObject("WScript.Shell")
 Set netSys =   CreateObject("WScript.Network")

 strUsrDomain = netSys.UserDomain
Set oADSysInfo = CreateObject("ADSystemInfo")

 If err.number <> 0 Then
 'getLDAPGroupInfo = strGroupData
  'wsObject.popup("Error"& e.decription)
 'Exit Function
 End If
 strUserDN = oADSysInfo.UserName
 Set objUser = GetObject("LDAP://"& strUserDN)
 arrGroups = objUser.memberOf

  If IsEmpty(arrGroups) Then
  'Wscript.Echo "Member of no groups"
 ElseIf (TypeName(arrGroups) = "String") Then
  'Wscript.Echo "Member of group " & arrGroups
  strGroupData = arrGroups
 Else

  For Each strGroup In arrGroups
   strGroupData = strGroupData & "," & strGroup
 Next
  'strGroupData = arrGroups

 End If 
     Response.Write(strGroupData)
%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T19:14:01.000

我采用了相当简单的解决方案。

我采用的解决方案如下。

1.  我的应用程序在特定用户身份下运行（物理路径凭据和应用程序池身份设置为 DNS 帐户）

2.  我用上面的代码创建了另一个页面并在应用程序池标识（SPN）下运行，并在 Active Directory 服务器和 Webserver 服务器之间创建了一个主令牌键

3.  使用该密钥，我再次连接到 LDAP，通过在具有 Windows 身份验证并在用户身份下运行的虚拟目录下调用上述代码来查询用户相关信息，从而获取用户详细信息。

如果您使用 asp.net 以编程方式模拟用户并从 ldap 获取用户详细信息，并在应用程序启动时通过连接 ldap 创建主令牌，则主键将持续存在直到工作进程被杀死

# javascript - Asp.Net Button 回发不断触发

> ID：11039919
> 
> 赞同：1
> 
> 时间：2012-06-14T19:21:13.403
> 
> 标签：javascript, jquery, asp.net

出于某种原因，回发事件不断为我的按钮触发。如果我使用 Firebug 在 function(e) 部分设置断点，代码会直接跳过该函数。返回 false 也不起作用。

```
<script>
$(document).ready
(
$('#<%:FilterButton.ClientID %>').click 
  (
    function (e)
    {
      e.preventDefault();
      $('#Filter').toggle();
    }
   )
 );
</script> 
```

**编辑：** Kundan 和其他人指出我跳过了为 document.ready() 事件传入匿名函数。我粗心大意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T19:32:13.700

试试这个

```
<script>
$(document).ready(function() {
 $('#<%= FilterButton.ClientID %>').click(function (e){
      e.preventDefault();
      $('#Filter').toggle();
      return false;
 });
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:36:36.940

我认为您的代码存在一些问题，除非它只是一个糟糕的复制/粘贴工作。应该：

```
$(document).ready(function(){

    $('#<%=FilterButton.ClientID %>').click(function(e){
        e.preventDefault();
        $('#Filter').toggle();
    });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:25:42.423

改变

```
$('#<%:FilterButton.ClientID %>').click 
```

到

```
$('#<%=FilterButton.ClientID %>').click 
```

# c# - 如何在 .NET 中获取资源监视器值？

> ID：11039923
> 
> 赞同：3
> 
> 时间：2012-06-14T19:21:17.163
> 
> 标签：c#, .net, resources, monitor, performancecounter

我需要获取 Windows 7 资源监视器中的一些值。特别是每个进程的内存使用量、cpu 和带宽。我查看了 PerformanceCounter 类，但没有找到深入到进程级别的方法。资源监视器正是我想要的，在你问之前......我知道这是在重新发明轮子，但老板想要这个。我也研究了 WMI，似乎大多数人不建议使用它。

那么有谁知道我如何使用 .net 类在进程级别获得至少这些统计信息？

# jquery - & 符号使我的 XML 无法使用 jQuery 加载

> ID：11039924
> 
> 赞同：4
> 
> 时间：2012-06-14T19:21:20.863
> 
> 标签：jquery, xml, ajax

我在 XML 文档中显示了描述，然后使用 jQuery 将其加载到应用程序中。

当我尝试使用“&”时，它会破坏代码加载。我也试过

```
&#38; 
```

它也不起作用。

是否有解决方法可以让我在我的 XML 中包含“&”符号？

*编辑：结构是...*

```
<picture title="Name" description="A picture of Adam & Eve"></picture> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T19:52:39.223

您可以使用`&amp;`. xml 解析器将其视为[字符实体](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references)`&`的开始......并且其本身不是有效的字符实体。`&`

```
<picture title="Name" description="A picture of Adam &amp; Eve"></picture> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-14T19:23:50.657

尝试将其包装在 !<[CDATA 标记中。xml 中的解析器不允许使用 & 符号。

例如：

```
<title><![CDATA[Adam & Eve]]></title> 
```

[在这里](http://www.w3schools.com/xml/xml_cdata.asp)阅读更多

# javascript - 将值添加到选择和排序

> ID：11039928
> 
> 赞同：2
> 
> 时间：2012-06-14T19:21:39.023
> 
> 标签：javascript, jquery, html

我有几个相互依赖的 Select，如果我在其中一个中选择一个值被删除，并且前一个值被添加到其他值，我如何通过 JQuery 将前一个值添加到 Select？然后按字母顺序排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:26:13.613

不确定排序（不应该太难弄清楚），但您可以将一个`<option>`元素附加到这样的列表中：

```
$("#myselect").append(
    $("<option>").prop("selected", "selected").attr("value", "OptionValue").text("OptionText")
); 
```

第一次调用`prop()`仅当您需要元素成为列表中的选定元素时，否则您可以省略它。

编辑：我继续进行排序部分：

```
var elems = [];
$("#sortable > option").each(function () {
    elems.push({ key: $(this).val(), value: $(this).text() });
});

elems.sort(function (a, b) {
    if (a.value < b.value) return -1;
    if (a.value > b.value) return 1;
    return 0;
});

$("#sortable").empty();
$.each(elems, function (idx, item) {
    $("#sortable").append(
        $("<option>").attr("value", item.key).text(item.value)
    );
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T19:45:40.077

由于有加值的代码，这里是select中排序值的代码

```
function sortOptions()
{
    var arr = [];
    $("#myselect option").each(function(){
        arr.push($(this).html());
    });
    $('#myselect').empty();
    arr.sort();
    var html='';
    for(var i=0;i<arr.length;i++)
    {
        html+='<option>' + arr[i] + '</option>'
    }
    $('#myselect').html(html);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T19:27:37.960

我猜你不能真正“订购” DOM 元素。

最好的方法是读取 select 的所有元素，将元素添加到数组中，将新值添加到数组中，然后对其进行排序。当然，在此过程中应该删除 DOM 元素。之后，您以所需的顺序再次将新排序的元素添加到 DOM。

# jsf-2 - h:selectOneMenu 的 f:selectItems 未在弹出显示中呈现

> ID：11039931
> 
> 赞同：1
> 
> 时间：2012-06-14T19:21:48.243
> 
> 标签：jsf-2, richfaces

我有弹出窗口`h:selectOneMenu`。此弹出窗口将在`a4j:commandLink`单击时显示。

`h:selectOneMenu`在弹出式渲染中没有调用“值”属性（我使用 System.out.println() 对其进行了调试）。

由于这个值没有在弹出显示中更新，我看到的是最后一个操作值，即使我想在新操作中看到空列表。

有什么建议么？

注意：另一个观察结果是，如果在刷新 h:selectOneMenu 的弹出窗口中“添加”一些按钮，那么它工作正常。

我的代码看起来像这样：

```
<rich:popupPanel id="CModalPanel"
                 autosized="true"
                 resizeable="false"
                 moveable="true" domElementAttachment="parent">
    <f:facet name="header">
        <h:outputText value="Select list"/>
    </f:facet>

    <h:form id="cListID">
       <a4j:outputPanel id="panelID">
    <h:panelGroup>
           <h:selectOneMenu id="cListMenu"
                       value="#{myBean.currvalue}" >                        
                <f:selectItems value="#{myBean.plistItems}" />
            </h:selectOneMenu>
    </h:panelGroup>
    <h:panelGroup>
             <a4j:commandLink id="refreshButton" 
                         actionListener="#{anotherBean.addMethod}"
                         render=":cListID" >

             </a4j:commandLink>
     </h:panelGroup>
</a4j:outputPanel>
</h:form>
</rich:popupPanel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:39:19.937

您需要`<rich:popupPanel>`在打开它之前更新它的内容。

```
<a4j:commandLink ... render=":cListID" oncomplete="#{rich:component('CModalPanel')}.show()" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T07:11:18.697

这是一个相关的错误[https://community.jboss.org/thread/169542](https://community.jboss.org/thread/169542)

# vb.net - 调用 SQL Server 存储过程的 SqlCommand 超时

> ID：11039934
> 
> 赞同：2
> 
> 时间：2012-06-14T19:21:53.697
> 
> 标签：vb.net, stored-procedures, sqlcommand

我有一个转换实用程序，它基本上将值从一个表复制到另一个表。一段时间以来效果很好，但我遇到了一位客户的奇怪问题。他们使用该实用程序处理了 150 万条记录，但现在它已完全停止。

从 VB.Net 调用存储过程时，它只是挂起，直到 SqlCommand 超时。从 Management Studio 调用相同的存储过程会立即执行。我的 SqlCommand 的 VB.Net 代码如下（`insertConn`之前定义并打开，`dr`是一个 SqlDataReader，在上一步中从完全不同的 SqlConnection 和 SqlCommand 实例填充）：

```
Dim conn As New SqlConnection("connection string here")
Dim insertConn As New SqlConnection("connection string here")
Dim dr As SqlDataReader = Nothing
Dim readCommand As New SqlCommand("my query here", conn)
conn.Open()
insertConn.Open()
...
dr = readCommand.ExecuteReader()
...
While dr.Read()
    Using insertCommand = New SqlCommand("dmDocumentFieldInsert", insertConn)
        insertCommand.CommandType = CommandType.StoredProcedure

        insertCommand.Parameters.AddWithValue("@DocumentKey", dr("DocumentKey"))
        insertCommand.Parameters.AddWithValue("@FieldId", "TITLE")
        insertCommand.Parameters.AddWithValue("@FieldValue", dr("DocumentTitle"))
        insertCommand.ExecuteNonQuery()
    End Using
End While 
```

我尝试重新启动 SQL Server 以清除任何锁，重新编译存储过程，增加 SqlCommand 和 SqlConnection 超时都无济于事。

我检查了添加到参数中的数据，它是有效数据......如果我用相同的数据手动调用存储过程，它工作正常。

我最初没有使用该`Using`块，但更改了它以查看是否有一些资源问题没有被处理/关闭。该实用程序的内存使用量徘徊在 5MB 左右，因此似乎没有任何内存问题。

有没有人对下一步尝试解决方案有什么建议？

**编辑**每个评论请求添加循环和初始化代码

**编辑**我更新了统计信息并重建了表索引，没有变化。

**编辑**数据被复制到的表上有三个索引（dmDocumentField）。如果我禁用所有三个索引，那么存储过程会完美执行，尽管比索引存在时慢得多。如果我启用其中任何一个，那么该实用程序最多可以通过几百条记录，然后在 sproc 上以相同的超时终止。删除并重新创建索引无效。表结构和索引如下：

```
CREATE TABLE [dbo].[dmDocumentField](
[FieldKey] [bigint] IDENTITY(1,1) NOT NULL,
[DocumentKey] [char](36) NOT NULL,
[FieldId] [varchar](10) NOT NULL,
[FieldValue] [varchar](255) NOT NULL,
CONSTRAINT [PK_dmDocumentField] PRIMARY KEY NONCLUSTERED 
(
[FieldKey] ASC,
[DocumentKey] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

索引（除了 PK）：

```
CREATE NONCLUSTERED INDEX [dmDocumentField_DocumentKey] ON [dbo].[dmDocumentField]
(
[DocumentKey] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY] 
```

.

```
CREATE NONCLUSTERED INDEX [dmDocumentField_DocumentKey_IFieldId_IFieldValue] ON [dbo].[dmDocumentField]
(
[DocumentKey] ASC
)
INCLUDE (   [FieldId],
[FieldValue]) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:43:36.983

我会试试这个：

```
... 
dr = readCommand.ExecuteReader() 
... 
insertCommand = New SqlCommand("dmDocumentFieldInsert", insertConn) 
insertCommand.CommandType = CommandType.StoredProcedure 
insertCommand.Parameters.AddWithValue("@DocumentKey", string.Empty)) 
insertCommand.Parameters.AddWithValue("@FieldId", "TITLE") 
insertCommand.Parameters.AddWithValue("@FieldValue", string.Empty)) 

Dim tr As SqlTransaction
tr = insertConn.BeginTransaction
insertCommand.Transaction = tr
While dr.Read() 
        insertCommand.Parameters("@DocumentKey").Value = dr("DocumentKey") 
        insertCommand.Parameters("@FieldValue").Value = dr("DocumentTitle")
        insertCommand.ExecuteNonQuery() 
End While 

tr.Commit() 
```

这可能会占用更少的内存（创建命令、创建参数在循环内重复）并且有 150 万条记录可能会有所不同。
**注意**我不知道@DocumentKey 和@FieldValue 的真实数据类型，假定为字符串，但如果不是这种情况，则使用适当的虚拟值更改初始设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T20:38:09.327

好吧，在与此作斗争之后，我手动进行了转换，因为这对于一个特定的客户来说是一次性的问题。我仍然希望我知道为什么 SqlCommand 会超时，但 SSMS 没有，但此时它已经完成了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T00:20:28.517

您的命令是否对 DataReader 选择的同一个表执行操作？我有类似的情况，我正在做类似执行阅读器的事情

```
SELECT ID, Name FROM Table 1 
```

然后我超时的命令是遍历 DR 记录并执行类似的操作

```
UPDATE Table1 SET Name = 'foo' WHERE ID = 1 
```

当我将 SELECT 更改为使用 DataTable 而不是 DataReader 进行存储时，它立即工作，就像在 SSMS 中一样。

# c# - 通过gridview中的超链接传递数据

> ID：11039941
> 
> 赞同：0
> 
> 时间：2012-06-14T19:22:25.353
> 
> 标签：c#, asp.net, gridview

我想通过gridview中的超链接将数据从数据库列传递到另一个页面，我想传递的数据只是一堆文本。这是我的代码

```
<asp:HyperLinkField DataTextField="FullText" 
        DataTextFormatString="View Text" NavigateUrl="~/Abstract.aspx" 
        Target="_blank" /> 
```

这似乎可以打开正确的页面，但我不确定如何查看新页面上的文本，大多数帮助主题告诉你如何将数据传递到新的网格视图，但我只想查看页面或框内的数据或任何可行的方法。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:27:37.257

如果我的理解正确，您只想将作为查询字符串传递的文本显示到新页面，如果正确，只需读取查询字符串并将其显示在标签中。

为了使它起作用，您需要在网格内的链接中指定查询字符串，您的链接必须看起来像；

```
~/Abstract.aspx?d=your+text 
```

在您的数据网格中：

```
 <asp:TemplateColumn>
        <ItemTemplate>
            <asp:HyperLink
                NavigateUrl='<%# "~/Abstract.aspx?d=" + HttpUtility.UrlEncode(DataBinder.Eval(Container, "DataItem.Id").ToString()) %>' 
                runat="server"
                Text="Product" />
        </ItemTemplate>
    </asp:TemplateColumn> 
```

在目标页面中，您将拥有如下内容：

```
string text = string.Empty;
if (this.Request.QueryString["d"] == null)
   text = "Not found";
else
   text = Server.UrlDecode(this.Request.QueryString["d"]);

// encode the text to avoid XSS (cross-site scripting)
this.myLabel.Text = Server.HtmlEncode(text); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T19:31:14.680

在网格上

```
<asp:HyperLinkField DataTextField="FullText" 
    DataTextFormatString="View Text" 
    NavigateUrl='<%# "~/Abstract.aspx?ft=" +  System.Web.HttpUtility.UrlEncode(Eval("FullText").ToString() %>'
    Target="_blank" /> 
```

在您要阅读的参数的页面上，您将拥有

```
string fullText = Request.QueryString["ft"];
if (string.IsNullOrEmpty(fullText))
{
    fullText = HttpUtility.UrlDecode(fullText);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T19:29:33.887

您可能希望通过查询字符串传递一个关键参数来提取您想要查看的数据。

如果这不是您想要的，请让您的问题更具解释性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T19:30:00.470

您可以在会话或查询字符串 ( `Abstract.aspx?textid=1`) 中传递 ID。在页面加载事件中读取此 id 从数据库中获取数据并显示。

# c# - ServiceStack.Redis 配置连接

> ID：11039942
> 
> 赞同：2
> 
> 时间：2012-06-14T19:22:29.203
> 
> 标签：c#, redis, servicestack

我正在为 Redis 使用 ServiceStack.Redis 客户端。是否可以通过配置文件配置连接？

我还没有找到这方面的任何文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-01T19:43:15.237

您可以在 web.config 的 appSettings 中设置连接

```
 <appSettings>   
    <add key="redisUrl" value="127.0.0.1:6379"/>
  </appSettings> 
```

然后在 appHost 类

```
 public override void Configure(Funq.Container container){

      var redisCon = ConfigurationManager.AppSettings["redisUrl"].ToString();
      container.Register<IRedisClientsManager>(new PooledRedisClientManager(20, 60, redisCon));
      container.Register<ICacheClient>(c =>(ICacheClient)c.Resolve<IRedisClientsManager>().GetCacheClient());
    } 
```

# ios - UIImage 方面适合并对齐到顶部

> ID：11039943
> 
> 赞同：58
> 
> 时间：2012-06-14T19:22:29.973
> 
> 标签：ios, cocoa, uiimageview, aspect-fit

默认情况下，它看起来像`aspect fit`将图像对齐到框架的底部。有没有办法在保持完整的同时*覆盖*`aspect fit`对齐？

** 编辑 **

*这个问题早于自动布局。事实上，汽车布局在 WWDC 2012 中被披露，就在这个问题被问到的同一周*

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-15T00:00:42.957

简而言之，您不能使用`UIImageView`.

一种解决方案是对`UIView`包含 an 的a 进行子类化，`UIImageView`并根据图像大小更改其框架。例如，您可以[在此处](https://stackoverflow.com/questions/3272335/alignment-uiimageview-with-aspect-fit)找到一个版本。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-05-22T09:54:24.083

将`UIImageView`的底部布局约束优先级设置为最低（即 250），它将为您处理。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-07-21T11:07:03.863

这样做的方法是修改 UIImageView 层的 contentsRect。我的项目（UIImageView 的子类）中的以下代码假定 scaleToFill 并偏移图像，使其对齐顶部、底部、左侧或右侧，而不是默认的中心对齐。对于 aspectFit 将是一个类似的解决方案。

```
typedef NS_OPTIONS(NSUInteger, AHTImageAlignmentMode) {
    AHTImageAlignmentModeCenter = 0,
    AHTImageAlignmentModeLeft = 1 << 0,
    AHTImageAlignmentModeRight = 1 << 1,
    AHTImageAlignmentModeTop = 1 << 2,
    AHTImageAlignmentModeBottom = 1 << 3,
    AHTImageAlignmentModeDefault = AHTImageAlignmentModeCenter,
};

- (void)updateImageViewContentsRect {
    CGRect imageViewContentsRect = CGRectMake(0, 0, 1, 1);

    if (self.image.size.height > 0 && self.bounds.size.height > 0) {

        CGRect imageViewBounds = self.bounds;
        CGSize imageSize = self.image.size;

        CGFloat imageViewFactor = imageViewBounds.size.width / imageViewBounds.size.height;
        CGFloat imageFactor = imageSize.width / imageSize.height;

        if (imageFactor > imageViewFactor) {
            //Image is wider than the view, so height will match
            CGFloat scaledImageWidth = imageViewBounds.size.height * imageFactor;
            CGFloat xOffset = 0.0;
            if (BM_CONTAINS_BIT(self.alignmentMode, AHTImageAlignmentModeLeft)) {
                xOffset = -(scaledImageWidth - imageViewBounds.size.width) / 2;
            } else if (BM_CONTAINS_BIT(self.alignmentMode, AHTImageAlignmentModeRight)) {
                xOffset = (scaledImageWidth - imageViewBounds.size.width) / 2;
            }
            imageViewContentsRect.origin.x = (xOffset / scaledImageWidth);
        } else if (imageFactor < imageViewFactor) {
            CGFloat scaledImageHeight = imageViewBounds.size.width / imageFactor;

            CGFloat yOffset = 0.0;
            if (BM_CONTAINS_BIT(self.alignmentMode, AHTImageAlignmentModeTop)) {
                yOffset = -(scaledImageHeight - imageViewBounds.size.height) / 2;
            } else if (BM_CONTAINS_BIT(self.alignmentMode, AHTImageAlignmentModeBottom)) {
                yOffset = (scaledImageHeight - imageViewBounds.size.height) / 2;
            }
            imageViewContentsRect.origin.y = (yOffset / scaledImageHeight);
        }
    }
    self.layer.contentsRect = imageViewContentsRect;
} 
```

# 斯威夫特版本

```
class AlignmentImageView: UIImageView {

    enum HorizontalAlignment {
        case left, center, right
    }

    enum VerticalAlignment {
        case top, center, bottom
    }

    // MARK: Properties

    var horizontalAlignment: HorizontalAlignment = .center
    var verticalAlignment: VerticalAlignment = .center

    // MARK: Overrides

    override var image: UIImage? {
        didSet {
            updateContentsRect()
        }
    }

    override func layoutSubviews() {
        super.layoutSubviews()

        updateContentsRect()
    }

    // MARK: Content layout

    private func updateContentsRect() {
        var contentsRect = CGRect(origin: .zero, size: CGSize(width: 1, height: 1))

        guard let imageSize = image?.size else {
            layer.contentsRect = contentsRect
            return
        }

        let viewBounds = bounds
        let imageViewFactor = viewBounds.size.width / viewBounds.size.height
        let imageFactor = imageSize.width / imageSize.height

        if imageFactor > imageViewFactor {
            // Image is wider than the view, so height will match
            let scaledImageWidth = viewBounds.size.height * imageFactor
            var xOffset: CGFloat = 0.0

            if case .left = horizontalAlignment {
                xOffset = -(scaledImageWidth - viewBounds.size.width) / 2
            }
            else if case .right = horizontalAlignment {
                xOffset = (scaledImageWidth - viewBounds.size.width) / 2
            }

            contentsRect.origin.x = xOffset / scaledImageWidth
        }
        else {
            let scaledImageHeight = viewBounds.size.width / imageFactor
            var yOffset: CGFloat = 0.0

            if case .top = verticalAlignment {
                yOffset = -(scaledImageHeight - viewBounds.size.height) / 2
            }
            else if case .bottom = verticalAlignment {
                yOffset = (scaledImageHeight - viewBounds.size.height) / 2
            }

            contentsRect.origin.y = yOffset / scaledImageHeight
        }

        layer.contentsRect = contentsRect
    }

} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-10-07T03:58:10.630

这将使图像填充宽度并仅占用适合图像所需的高度（宽泛地说）

斯威夫特 4.2：

```
let image = UIImage(named: "my_image")!
let ratio = image.size.width / image.size.height
cardImageView.widthAnchor
  .constraint(equalTo: cardImageView.heightAnchor, multiplier: ratio).isActive = true 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-02-03T21:37:40.243

我有类似的问题。最简单的方法是创建自己的 UIImageView 子类。我添加了子类 3 属性，所以现在可以在不知道内部实现的情况下轻松使用它：

```
@property (nonatomic) LDImageVerticalAlignment imageVerticalAlignment;
@property (nonatomic) LDImageHorizontalAlignment imageHorizontalAlignment;
@property (nonatomic) LDImageContentMode imageContentMode; 
```

你可以在这里查看： [https ://github.com/LucasssD/LDAlignmentImageView](https://github.com/LucasssD/LDAlignmentImageView)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-10-03T12:31:11.007

1.  使用图像比例添加纵横比约束。
2.  不要将 UIImageView 固定到底部。
3.  如果要动态更改 UIImage，请记住更新纵横比约束。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-07T12:00:09.633

我通过在 UIImageView 的高度上设置约束来在 Interface Builder 中本地解决了这个问题，因为当图像大于屏幕尺寸时，图像总是会被“向上推”。

更具体地说，我将 UIImageView 设置为与其所在的 View 相同的高度（通过高度约束），然后在 IB 中使用间距约束定位 UIImageView。这导致 UIImageView 具有“Aspect Fit”，它仍然尊重我在 IB 中设置的顶部间距约束。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-05-24T19:54:25.673

如果您能够子类`UIImageView`化，那么您可以覆盖`image`var。

```
override var image: UIImage? {
    didSet {
        self.sizeToFit()
    }
} 
```

在 Objective-C 中，你可以通过重写 setter 来做同样的事情。

# c# - 使用 MVC 在 GenericPrincipal 中设置代理用户，同时保留旧身份

> ID：11039944
> 
> 赞同：1
> 
> 时间：2012-06-14T19:22:36.760
> 
> 标签：c#, asp.net-mvc, httpcontext, genericprincipal

我有一个网站，允许一些用户作为其他用户代理。当他们这样做时，他们应该看到整个站点，就像他们代理的用户所在的位置一样。我通过更改当前用户对象来做到这一点

```
internal static void SetProxyUser(int userID)
{
    HttpContext.Current.User = GetGenericPrincipal(userID);
} 
```

这段代码对我来说很好。

在站点上，为了代理，用户在我的 _layout 文件中呈现的下拉列表中选择一个值，以便它出现在所有页面上。

```
 @Html.Action("SetProxyUsers", "Home") 
```

SetProxyUsers 视图如下所示：

```
@using (@Html.BeginForm("SetProxyUsers", "Home")) {

@Html.DropDownList("ddlProxyUser", (SelectList)ViewBag.ProxyUsers_SelectList, new { onchange = "this.form.submit();" }) 
```

}

对此的控制器操作如下所示

```
 [HttpGet]
    public ActionResult SetProxyUsers()
    {
        ViewBag.ProxyUsers_SelectList = GetAvailableProxyUsers(originalUserID);

        return PartialView();
    }

    [HttpPost]
    public ActionResult SetProxyUsers(FormCollection formCollection)
    {
        int id = int.Parse(formCollection["ddlProxyUser"]);

        RolesHelper.SetProxyUser(id);

        ViewBag.ProxyUsers_SelectList = GetAvailableProxyUsers(originalUserID);

        return Redirect(Request.UrlReferrer.ToString());
    } 
```

所有这些都有效（除了 originalUserID 变量，我放在这里以象征我接下来要做什么。

我的问题是下拉列表中的值是基于登录用户的。因此，当我使用代理更改用户时，我还会更改代理下拉列表中的值（如果不允许“新”用户进行代理，则要么消失，要么显示“新”用户的可用代理用户列表）。

我需要让这个选择列表保持不变。如何存储原始用户的 ID？我可以将它存储在会话变量中，但我不想弄乱潜在的超时问题，所以这是最后的手段。

请帮忙，如果问题有任何不清楚的地方，请告诉我。

**更新**

我没有意识到`HttpContext`每个帖子都设置了。我之前并没有真正使用过这种东西，并且出于某种原因假设我正在为整个会话设置值（愚蠢，我知道）。但是，我使用的是 Windows 身份验证。如何更永久地更改用户（只要浏览器处于打开状态）？我假设我不能使用 FormAuthentication cookie，因为我使用 windows 作为我的身份验证模式，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:27:00.533

与其伪造身份验证，不如让它成为现实？在我工作的网站上，我们让管理员通过为要模拟的用户设置身份验证 cookie 来模拟其他用户。然后原始用户 ID 存储在会话中，因此如果他们从模拟用户帐户中注销，他们实际上会自动重新登录到其原始帐户。

**编辑**：

这是我如何进行模拟的代码示例：

```
[Authorize] //I use a custom authorize attribute; just make sure this is secured to only certain users.
public ActionResult Impersonate(string email) {
    var user = YourMembershipProvider.GetUser(email);

    if (user != null) {
        //Store the currently logged in username in session so they can be logged back in if they log out from impersonating the user.
        UserService.SetImpersonateCache(WebsiteUser.Email, user.Email);

        FormsAuthentication.SetAuthCookie(user.Email, false);
    }

    return new RedirectResult("~/");
} 
```

就那么简单！它工作得很好。唯一棘手的部分是存储会话数据（这当然不是必需的，它只是提供给我的用户的一个很好的功能，因此他们不必一直以自己的身份重新登录）。我正在使用的会话密钥是：

```
string.Format("Impersonation.{0}", username) 
```

*被模拟的用户*`username`的名称在哪里（该会话密钥的值是原始/管理员用户的用户名）。这很重要，因为当注销发生时，我可以说，“嘿，有任何模拟密钥给你吗？因为如果有，我将以存储在会话中的用户身份登录。如果没有，我就让你退出”。

 *这是 LogOff 方法的示例：

```
[Authorize]
public ActionResult LogOff() {
    //Get from session the name of the original user that was logged in and started impersonating the current user.
    var originalLoggedInUser = UserService.GetImpersonateCache(WebsiteUser.Email);

    if (string.IsNullOrEmpty(originalLoggedInUser)) {
        FormsAuthentication.SignOut();
    } else {
        FormsAuthentication.SetAuthCookie(originalLoggedInUser, false);
    }

    return RedirectToAction("Index", "Home");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:58:31.573

[我在这篇文章http://www.codeproject.com/Articles/43724/ASP-NET-Forms-authentication-user-impersonation](http://www.codeproject.com/Articles/43724/ASP-NET-Forms-authentication-user-impersonation)的评论中使用了 mvc 示例来

它使用 FormsAuthentication.SetAuthCookie() 来更改当前授权的 cookie，并将模拟的用户身份存储在 cookie 中。这样，它可以轻松地将您重新验证为原始用户。

我很快就让它工作了。使用它允许管理员以其他任何人身份登录。*

# internet-explorer-6 - 使用什么非 IE 软件版本来检查与 IE6 的兼容性？

> ID：11039949
> 
> 赞同：0
> 
> 时间：2012-06-14T19:22:48.600
> 
> 标签：internet-explorer-6

希望这个问题不是愚蠢的，因为我是一名业余网页设计师。我使用 Windows 7 并希望看到我制作的网站与 IE6 类似（将仅使用 html 和 css）。

但是，与其经历从 MS 下载虚拟机​​软件等的所有混乱，我想知道是否有任何其他浏览器，如旧的 Firefox 或 Netscape，我可以从 filehippo 安装，如果它们给出类似于 Internet Explorer 6 的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:28:34.203

Internet Explorer 因行为不端而臭名昭著。没有其他不是 IE6 的程序可以像 IE6 一样工作。

我的建议是使用像[Adob​​e 的 BrowserLab](https://browserlab.adobe.com/en-us/index.html)这样的网站。它可以让你选择一个 URL，然后它会在不同的浏览器和操作系统上拍摄它的快照。该列表远未完成，但它是我发现的最好的免费解决方案之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T22:38:19.380

答案取决于您对测试的精确度。

评论中已经提到了最简单的选项 - [IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)。它是 IE 的包装器，支持在同一窗口中运行所有版本的 IE，从 5.5 到 v9。它对于测试网站在旧版 IE 中的外观非常有用；我用它所有的时间。

不幸的是，它不是很稳定；它经常崩溃，尤其是当您在其中运行 IE6 或 IE7 时。它也不能很好地处理插件元素，如 flash。如果您的网站经常使用它们，那么您可能不走运。

但如果你能应付这些限制，那么这是一个很好的程序，它确实直接回答了你的问题。

更具体地说，您希望可以使用较旧的非 IE 浏览器来模拟 IE6。可悲的是没有。IE 是独一无二的（以一种糟糕的方式）；它具有现在或过去没有出现在任何其他浏览器中的功能、错误和怪癖。

您将获得的最接近的可能是一个非常旧的 Opera 版本——在早期，他们强调要与 IE 保持良好的兼容性，以实现一些 IE 的专有功能。但即便如此，它也从未如此接近。

一个真正厚颜无耻的选择可能是使用[Wine](http://www.winehq.com/)将 IE6 安装到 Linux 机器上。同样，它可能不稳定，但众所周知它可以工作。我有一段时间没有尝试过，但当时它还不错，同时 Wine 也有了很大的改进。

除此之外，唯一真正的选择是运行 IE6 的正版副本。最好的方法是安装一个带有完整 XP 副本的 VM。不是很好，但事实上，这是您获得 IE6 用户所见内容的真正 100% 准确图片的唯一方法。如果这对您很重要，那么您需要这样做。

但老实说，在大多数情况下，100% 并不重要。IETester 足以测试大多数网站，坦率地说，如果你还有一些奇怪的故障，不要太担心——IE6 用户现在已经习惯了网络对他们来说不太好用。

让它起作用; 不要让它完美。为此，IETester 应该足够好。

# grails - Grails：使用 Command 对象验证约束优于使用 Domain 对象的性能优势

> ID：11039956
> 
> 赞同：2
> 
> 时间：2012-06-14T19:23:18.100
> 
> 标签：grails

使用 Command 对象验证约束是否比使用 Domain 对象验证约束有任何性能优势

这意味着如果我拦截传入的参数并将其放置在命令对象中并调用 cmd.hasErrors() ，然后将其绑定到对象并尝试 obj.save() 并允许对象约束进行验证

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T18:19:58.927

我从未注意到任何性能优势 - 事实上，这样做可能会对性能产生轻微影响。您的命令对象将执行它的验证和绑定，而您的域对象仍将执行它的验证和绑定。这只是一个猜测，如果属实，它可能是一个相对较小的打击。

我的基本策略是，如果我正在为严格的单个类进行表单输入，我只使用域。如果在同一个表单上不需要域（如登录）或多个域（如作者和一本书），请使用命令对象。

# ajax - 文本框验证原型库+PHP

> ID：11039958
> 
> 赞同：1
> 
> 时间：2012-06-14T19:23:28.177
> 
> 标签：ajax, json

我在 abc.php 文件中有这个表单，我想验证带有 id 的“事件名称”和“代码名称”的文本框。用户必须填写这两项，“事件名称”应以 EV_ 开头，“代码名称”应以 CD_ 开头。我是 AJAX 和 JSON 的新手（刚下飞机：P）

```
<form class="abc" name="abc" id="form" action="validate.php" method="post">
<label for="event_name"> Event Name: </label>
<input type="text" class="required" name="event_name" id="Event Name"/><br/><br/>
<label for="code_name">   Code Name:  </label>
<input type="text" class="required"  name="code_name" id="Code Name"/><br/><br/>
</form> 
```

我正在使用原型库。基本上，AJAX 请求必须在提交时触发，并且 JSON 应该返回给客户端，要求用户输入指定的事件名称和代码名称。

我非常感谢您对此的任何帮助。我已经冲浪了 12 个小时，但在任何地方都找不到简单的代码。请帮帮我！

谢谢

# ios - 在 ViewController 之间共享数据

> ID：11039962
> 
> 赞同：1
> 
> 时间：2012-06-14T19:23:43.310
> 
> 标签：ios, viewcontroller

我有一个简单的单视图 iOS 5 应用程序，我添加了第二个视图控制器。我将这些嵌入到导航控制器中，并在我的 FirstViewController 上放置了两个按钮。这些按钮中的每一个都有一个用于 segue 的命名标识符，该标识符依次在 iPhone 应用程序的 UI 中显示我的 SecondViewController。

一切都按预期工作，但是，我想在第二个视图控制器的标签中显示一些简单的东西，比如“你点击了按钮 1”。我尝试将这些数据手动放置在我在 AppDelegate 中声明的 NSMutableString 变量中，我可以在我的第二个视图控制器中访问该变量，但我分配给它的值永远不会显示在屏幕上。

显然，创建了 SecondViewController 的新实例，这可能就是我没有看到它的原因。我创建了一个类型为 UILabel 的 IBOutlet，其名称为 myLabel，以保存该值，但唉，我看不到任何变化。

任何帮助将不胜感激。

注意：我很高兴发布代码，但我认为它不会真正帮助解决我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:28:46.817

在这种情况下，我的解决方案始终是自定义`-init`方法。如，

```
-initWithButtonPressedString:(NSString*)message; 
```

在第二个视图控制器中声明并调用：

```
self.secondView = [[SecondViewController alloc]initWithButtonPressedString:@"some conditional string"]; 
```

然后，所需要的只是第二个视图控制器中的 iVar 来处理传递的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:26:52.507

要在视图控制器之间传递数据，您应该考虑 1\. 为您的视图控制器进行自定义初始化，以传递附加信息或 2\. 在您从第一个视图控制器访问的第二个视图控制器上创建属性。

您可以为您创建的 IBOutlet 创建一个属性，但您需要确保如果您从第一个视图控制器访问它，它是在加载视图之后。

没有看到你当前的代码很难给你更多的方向

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T20:22:54.737

你使用故事板吗？无论如何，您是否已将 IBOutlet 连接到 Interface Builder 中的变量？

如果您使用 Storyboards，您可能会尝试使用名为 `- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender`

IE。

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"ChooseToDetailsSegue"]) {
        preparedSegue = segue;
        SaleDetailsViewController *saleDetailsVC = [preparedSegue destinationViewController];
        saleDetailsVC.saleDetailsProduct = [elementsArray objectAtIndex:selectedRow];
        saleDetailsVC.cardTransactionDetails = [[cardDetails alloc] init];
        saleDetailsVC.cardTransactionDetails.number = infoCardNumber;
        saleDetailsVC.cardTransactionDetails.month = infoExpiriationM;
        saleDetailsVC.cardTransactionDetails.year = infoExpiriationY;     
    }
} 
```

您只需要初始化新的 ViewController（您的目的地）并引用它们的变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-19T09:14:48.367

您还可以使用通知。在 FirstViewController 的第一个按钮的 IBAction 中，您可以添加

`NSNotification *messageFromFirstViewController = [NSNotification notificationWithName:@"firstbuttonMessage" object:@"You clicked Button 1"]; [[NSNotificationCenter defaultCenter] postNotification:messageFromFirstViewController];`

和你的第二个按钮的 IBAction 类似的东西。

在您的 SecondViewController 的 viewDidLoad 中，您可以添加

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(useNotification:) name:@"firstButtonMessage" object:nil]; 
```

创建 useNotification 方法来更改您的 myLabel：

```
-(void) useNotification:(NSNotification *)notification {
self.myLabel.text = notification.object;} 
```

# search - Dynamics CRM - 从 Web 表单发送搜索？

> ID：11039964
> 
> 赞同：0
> 
> 时间：2012-06-14T19:23:53.717
> 
> 标签：search, iframe, crm, microsoft-dynamics

我想知道是否可以从 Web 表单向 Dynamics CRM 发送搜索词？

我有一个 PHP 网页，它有一个搜索（输入）字段，一旦提交，页面就会刷新几个 iframe。在一个框架中，我加载了 Dynamics CRM“帐户”，但不知道如何将变量发送到 Dynamics 中的搜索字段。

这是否可以在不更改 Dynamics CRM 的情况下实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:22:13.337

对于任何有同样问题的人，我注意到这在 Dynamics CRM 2012 中是可能的。

# warnings - 删除警告：切入点中的 invalidAbsoluteTypeName

> ID：11039968
> 
> 赞同：1
> 
> 时间：2012-06-14T19:24:07.447
> 
> 标签：warnings, aspectj

我正在使用 LoadTime 编织。我的方面已经过测试并且工作正常。我的工作区中有几个项目，我试图清除一些警告只是为了保持“真实的”

这段代码给了我：[Xlint:invalidAbsoluteTypeName] 警告，我无法用@SuppressAjWarnings 清除它

```
 pointcut somePointcutName():
            call(*someMethod(..)) &&
            !adviceexecution(); 
```

所以我想知道是否有办法清除这些

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T21:58:28.870

好吧，我玩过，我想我知道那里发生了什么：无论您在`call`切入点中使用哪种类型签名，似乎您都使用了绝对的类型签名，例如

`* MyClass.doIt(..)`,

但是您还没有导入该类，因此无法像那样访问它。所以你要么需要

`import com.foobar.my.package.MyClass`

在你的方面或

`* *..MyClass.doIt(..)`

在你的切入点。我猜 Xlint 警告有点神秘，但基本上就是这个意思。

# android - 有没有办法使用android应用程序发送包含信息的数据库？

> ID：11039972
> 
> 赞同：0
> 
> 时间：2012-06-14T19:24:24.293
> 
> 标签：android, database, eclipse

这是我的第一个应用程序，我正在努力帮助我工作的企业。基本上我选择了 Android Tablet Application for Dummies 并一直使用它作为参考。我正在为我工​​作的企业制作一种考勤卡申请。我的目标是，我想获取工人在一天中输入的信息，并让他们通过电子邮件将其发送给编写工资单的人。有什么方法可以让我通过电子邮件发送包含所有内容的数据库吗？或者以另一种易于阅读的格式发送内容的简单方法？接受所有建议和替代方案，感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:33:06.427

原始 db 文件可能对发薪人员没有太大用处。

如果我是你，我会做一些事情来查询你的数据库中的所有行，一旦你有了结果游标，你就可以迭代它并将数据放入一些更有用的数据格式。

您选择的数据格式取决于您的情况。XML 或 CSV 似乎是不错的选择。CSV 可能会好一点，因为它可以在 Excel 中打开（工资单中的任何人都可能可以访问）

如果需要，您也可以制作自己的数据格式。某种普通的 txt 平面文件将是最简单的，并且非常易于阅读（对于薪资员工来说更容易）

像这样的东西：

```
IN Mike 2:31pm 6/14
IN Joe 2:45pm 6/14
OUT Mike 4:55pm 6/14
etc... 
```

然后，如果你很好，你会在最后做一些事情来计算当天和/或支付期间的总小时数

```
Total Hours for period
Mike: 25.4
Joe: 22.3
etc... 
```

**编辑：**网络上有很多 CSV 的例子。

[从这里开始](http://en.wikipedia.org/wiki/Comma-separated_values)了解它是什么。

一旦你理解了它是什么，你就需要学习如何在 java 中实现读/写。你可以很容易地使用纯 java 使用字符串来做到这一点。但是也有一些[库](http://www.bing.com/search?setmkt=en-US&q=java%20csv%20)可以让您更轻松地与 CSV 数据交互。

# doxygen - 在 Doxygen 中正确使用组？

> ID：11039975
> 
> 赞同：1
> 
> 时间：2012-06-14T19:24:36.020
> 
> 标签：doxygen

我正在尝试使用以下结构创建文档：

```
+ Header
+-+ A
+-+ B
+-+ C 
```

我的源代码是：

```
/**

\defgroup bigsection Header
@{

\defgroup sectionA A
@{
A 
@}

\defgroup sectionB B
@{
B
@}

\defgroup sectionC C
@{
C
@}

@}

*/ 
```

我最终得到的是以下结构：

```
+ Header
+-+ A
+-+ B
+ C 
```

有谁知道为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:41:53.993

看起来这是 Doxygen 中的一个错误。在以后的版本中解决。

# file - IIS 上使用 copyFile 的 ASP Classic 的权限错误

> ID：11039979
> 
> 赞同：1
> 
> 时间：2012-06-14T19:24:49.397
> 
> 标签：file, asp-classic, jscript

我正在编写一个在 IIS 7.0 上运行的 ASP 经典（使用 JScript）存储库，并且在移动文件时遇到了一些权限问题。我必须遵循总是给我一个权限被拒绝错误的通用函数。

```
function moveFile(source, target){
    fs = new ActiveXObject("Scripting.FileSystemObject");
    newloc = target + "\\" + source.name;
    debug("Copying file: " + source.path + " to " + newloc);
    fs.copyFile(source.path, Server.MapPath( "repository/" ), true);

} 
```

当我使用源和目标调用函数时`source.path`，我得到以下输出：`D:\Inetpub_EXT\wwwroot\builder\repo\dump\alicia.docx``D:\Inetpub_EXT\wwwroot\builder\repo\repository`

```
Treating dumpfile: alicia
Copying file: D:\Inetpub_EXT\builder\repo\dump\alicia.docx to 
D:\Inetpub_EXT\wwwroot\builder\repo\repository
Microsoft JScript runtime error '800a0046'
Permission denied 
```

我已经验证了文件夹和文件都存在，并且我在构建器中完全控制了 IIS_WPG、IUSR、Authenticated User、System 和 Administrators。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:08:10.140

仔细检查您的权限。小心假设。

例如，您可能假设如果 IIS 用户对`builder`目录具有权限，那么它对所有子目录都具有权限。这不是一个好的假设。如果您在`builder`目录上设置 ACL 以授予 IIS 权限，则在创建子目录后，这些子目录将不会自动继承您稍后应用到的权限`builder`。

您可以从命令行使用 icacls.exe 来查看权限：

```
 %windir\system32\icacls.exe  d:\inetpub\wwwroot\builder\foo\bar 
```

# passwords - 在 Jenkins 的“注入的环境变量”页面上屏蔽非存储密码参数

> ID：11039983
> 
> 赞同：3
> 
> 时间：2012-06-14T19:25:00.967
> 
> 标签：passwords, jenkins, parameterized

我觉得好像我必须在这里遗漏一些简单的东西——我想做的是创建一个参数化的构建，其中一个参数是密码。我不想将密码永久存储在 Jenkins 中。到目前为止，我已经能够使用“Mask Passwords”插件在控制台输出中屏蔽密码，但无论如何，任何构建上的 EnvInject 的“Injected environment variables”页面都会以纯文本形式显示密码。

我尝试了很多方法，包括但不限于： 将“掩码密码”密码命名为与我的密码参数之一相同 将“EnvInject”密码命名为与我的密码参数之一相同

我找到了 [https://issues.jenkins-ci.org/browse/JENKINS-12423](https://issues.jenkins-ci.org/browse/JENKINS-12423) 但我认为它只是指从控制台输出中屏蔽密码。

我已经在几个不同的操作系统和版本组合上尝试过这个，但现在我只是试图让它工作：Windows 7 64bit Jenkins ver。1.470 环境注入器插件 1.55 掩码密码插件 2.7.2

但我似乎无法弄清楚这一点。我觉得这可能不是一个非常罕见的设置，所以我可能只是错过了一些愚蠢的东西。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T11:50:17.937

您可以通过灵活发布插件使用注入环境变量插件在构建结束时将空值注入密码参数。在 Injected Vars 选项卡中，您将看到一个空值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-08T16:02:18.660

FWIW，Jenkins 的 Mask Password 插件（没有 EnvInject 插件）运行良好。它可以在 Invoke gradle 脚本任务中替换全局密码 w/ia 开关，例如：

```
-Psometask_password=${global_sometask_password} 
```

当我尝试在同一 gradle 任务的 Windows 批处理命令版本中使用该变量时，它不起作用。也许插件检测到 Invoke gradle 脚本任务中的“Switches”字段。

# html - 如何在点击网页时播放随机声音？

> ID：11039984
> 
> 赞同：1
> 
> 时间：2012-06-14T19:25:09.200
> 
> 标签：html

我希望在单击网页上的按钮时播放随机声音。我已经研究了很多，这个讨论对我帮助最大：[http ://www.elated.com/forums/topic/5196/](http://www.elated.com/forums/topic/5196/)

一位发帖人建议在单击按钮时运行 Javascript 函数，如下所示：

```
<script>
function playSound() {
  var sounds = [
    "http://www.mysite.com/1.wav",
    "http://www.mysite.com/2.wav",
    "http://www.mysite.com/3.wav"
  ];

  **// Choose a random sound here and play it**
}
</script> 
```

我了解制作一系列声音的部分。我想我已经弄清楚了选择随机数组元素的部分。我只是坚持如何按照海报的建议在 JS 函数中播放声音。我可以在 JS 函数中使用 HTML5 音频标签吗？

我不在乎实际播放文件的代码是在函数内部还是外部。其实我是先用JS随便选一个元素，然后让一行HTML播放JS函数返回的数组的元素。我放弃了，因为我不知道如何指定我想在 HTML 中播放 JS 函数的返回值。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:30:02.090

使用 JavaScript 添加声音

将以下脚本放在`<head>`您的 HTML 文档中：

```
<script language="javascript" type="text/javascript">
 function playSound(soundfile) {
 document.getElementById("dummy").innerHTML=
 "<embed src=\""+soundfile+"\" hidden=\"true\" autostart=\"true\" loop=\"false\" />";
 }
 </script> 
```

声音被放置在一个空的 Span 中

当脚本启动时，JavaScript 会在一个空的 span 标签内放置一个 embed 标签。因此，您需要在 HTML 页面正文中的某处添加以下 span 文件，最好靠近文档顶部：

```
<span id="dummy"></span> 
```

使用 onmouseover 或 onclick 属性调用脚本

您需要添加的最后一件事是您希望在单击或鼠标悬停时生成声音的元素。使用这些属性之一调用脚本：

```
<a href="#" onclick="playSound('URL to soundfile');">Click here to hear a sound</a>

 <p onmouseover="playSound('URL to soundfile');">Mouse over this text to hear a sound</p> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:28:06.443

如果你有你的音频元素的 ID，你可以这样做：

```
document.getElementById(theId).play(); 
```

音频元素可能如下所示：

```
<audio id="someId">
    <source src=sound/zbluejay.wav>
</audio> 
```

如果你需要它，你可以像这样动态添加音频元素：

```
document.write("<audio id=someId><source src=yourURL</audio>");
document.getElementById('someId').play();​​​​ 
```

[在这里](http://jsfiddle.net/dystroy/2ZfYe/)拉小提琴。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T19:32:45.907

没有测试过这个，但我想它应该可以工作。我基本上从数组中选择一个随机字符串，然后将一个嵌入元素放入 div 中，其 id 为“元素”，然后启动声音。

```
<script>
function playSound() {
  var sounds = new Array(
    "http://www.mysite.com/1.wav",
    "http://www.mysite.com/2.wav",
    "http://www.mysite.com/3.wav"
  );

$.("#element").html("<embed src=\""+Math.floor(Math.random()*(sounds.length+1))+"\" autostart=\"true\" />");

}
</script> 
```

**编辑：我测试了这个：**

```
<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script>
function playSound() {
  var sounds = new Array(
    "file:///X:/test.mp3"
  );

$("#element").html("<embed src=\""+sounds[Math.floor(Math.random()*(sounds.length+1))]+"\" hidden=\"true\" autostart=\"true\" />");
}
</script>
</head>
<body onload="javascript:playSound()">

<div id="element">
</div>
</body>

</html> 
```

# python - to_panel 用（看似）巨大的随机数填充不存在的值

> ID：11039985
> 
> 赞同：1
> 
> 时间：2012-06-14T19:25:11.843
> 
> 标签：python, pandas

（以下发生在 0.7.3 和 0.8-dev 版本中）

当使用 Panel 的轴“单元格”将正确的多索引 DataFrame 转换为 Panel 时，该`to_panels()`方法的每个 Item 中都会有巨大的随机数，导致 DataFrame 中不存在的“单元格”现在被随机填充，巨大的数字（有时是负数）。例如：如果 DataFrame 以宽度和长度为索引，两者的值都从 1 到 5，但 DataFrame 中没有 2,3 条目，则生成 2,3 主轴/次面板。

这是一个错误吗？或者我们可以做些什么来防止这种情况发生？

# c - 仅在项目发生更改时添加编译时间戳 (C)

> ID：11039993
> 
> 赞同：2
> 
> 时间：2012-06-14T19:25:49.083
> 
> 标签：c, eclipse, compilation, makefile

我目前正在创建一个新的 C 项目，我遇到了需要用一些数据（包括时间和日期）标记每个编译。

标准而简单的方法是：

1.  通过一个简单的脚本生成一个 .c 文件，添加所需的信息。使用此解决方案，项目将始终生成新的工件（例如 .o），即使项目本身没有发生任何更改（没有任何文件被更改）。

2.  已经准备好一个 .c 文件，如果需要，可以包含*time*，*date*和其他内容，仅在清理项目后编译它。项目中源文件或头文件的更改不会导致标记被更改（除非我们先清理项目）。

我正在寻找的是介于两者之间的东西：当项目文件更改时，只有在那时，确保添加编译标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T20:39:56.360

我不确定eclipse，但如果你使用`make`makefiles，你可以使用下面例子中的想法（在cygwin环境下工作）。

当`make`执行链接命令（最后一个）时，它还会编译包含时间的文件。当可执行文件是最新的时，不会调用链接，因此不会更改时间戳。为了使它起作用，您不应该告知`make`带有时间戳的文件是任何事情的先决条件。

```
# Makefile
a.exe: a.o # note: doesn't depend on mytime.c
    gcc a.o mytime.c -o a.exe # note: cannot use ld, must link with gcc

a.o: a.c
    gcc -c a.c

// mytime.c
char* mytime = __TIME__;

// a.c
#include <stdio.h>
extern char* mytime;
int main()
{
    printf("%s\n", mytime);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T21:02:01.350

每当运行 a或 a时，您还可以使用 git[挂钩](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)创建（未版本化的）时间戳 .c 文件。`git commit``git pull`

# javascript - Expressjs Mongoose 发现嵌套的嵌入文档未定义

> ID：11039997
> 
> 赞同：1
> 
> 时间：2012-06-14T19:26:12.500
> 
> 标签：javascript, node.js, mongodb, express, mongoose

我正在使用[nodejs](http://nodejs.org/) 0.6.18 [expressjs](http://expressjs.com/) 2.5.8 和[mongoose](http://mongoosejs.com/) 2.6.7 构建游戏。

我正在尝试使用 mongoose 存储和检索嵌入式文档。考虑这个例子：

**用户架构**

```
var User = module.exports = new Schema({
      username: { type: String }
    , characters: [Character]
    , created: { type: Date, default: Date.now }
}); 
```

**字符模式**

```
var Character = module.exports = new Schema({
      name: { type: String }
    , spells: [Spell]
    , created: { type: Date, default: Date.now }
}); 
```

**拼写模式**

```
var Spell = module.exports = new Schema({
      name: { type: String }
    , created { type: Date, default: Date.now }
}); 
```

**猫鼬**

```
var db = mongoose.createConnection('mongodb://localhost/mygame');
mongoose.model('User', require('./models/user'));
mongoose.model('Character', require('./models/character'));
mongoose.model('Spell', require('./models/spell') 
```

**路线**

```
app.get('/', function(req, res) {
  var User = db.model('User')
    , Character = db.model('Character')
    , Spell = db.model('Spell')
    , u = new User({username:'foo'})
    , c = new Character({name:'bar'});

  c.spells.push(new Spell({name:'fireball'}));
  c.spells.push(new Spell({name:'frozenball'}));
  u.characters.push(c);

  u.save(function(e, s) {
    User.find({username:'foo'}, function(err, success) {
      console.error(err);
      console.log(success);
    });
  });
}); 
```

**控制台输出**

```
null
[ { username: 'foo',
    _id: 4fda2c77faa9aa5c68000003,
    created: Thu, 14 Jun 2012 18:24:55 GMT,
    characters: [ undefined ] } ] 
```

看起来用户文档已被猫鼬正确保存和检索。但是，相关的嵌入文档是**undefined**。

我想确保我的文档已保存，所以我直接询问了 mongodb ：

```
$ mongo mygame
> db.users.find({username:'foo'})
{
    "username" : "foo",
    "_id" : ObjectId("4fda2c77faa9aa5c68000003"),
    "created" : ISODate("2012-06-14T18:24:55.982Z"),
    "characters" : [
        {
            "name" : "bar",
            "_id" : ObjectId("4fda2c77faa9aa5c68000004"),
            "created" : ISODate("2012-06-14T18:24:55.986Z"),
            "spells" : [
                {
                    "name" : "fireball",
                    "_id" : ObjectId("4fda2c77faa9aa5c68000005"),
                    "created" : ISODate("2012-06-14T18:24:55.987Z")
                },
                {
                    "name" : "frozenball",
                    "_id" : ObjectId("4fda2c77faa9aa5c68000007"),
                    "created" : ISODate("2012-06-14T18:24:55.990Z")
                }
            ]
        }
    ]
} 
```

如您所见，我的文档似乎已正确存储到 mongodb，但我无法检索谁嵌入了 mongoose。

我也尝试过不使用嵌套的嵌入式 Spell 文档，这会产生完全相同的问题。

**编辑**

@pat 你是对的。如果我以正确的顺序将所有模式直接放在同一个文件（例如主 app.js）中，它就可以工作。

事实是，我想尽可能地将每个模型保存在单独的文件中（它们会增长很多）。

例如，我的用户模型包含在一个名为 models/user.js 的文件中，并且*应该*可以使用`module.exports`上述方法进行访问。

但是，当我尝试将我的模型链接到另一个文件`mongoose.model('User', require('./models/user'));`中的猫鼬时：猫鼬 find 方法返回未定义的嵌入文档。

您对如何将我的猫鼬模型正确保存在单独的文件中有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T19:57:49.140

用户模式文件应该首先需要顶部的 CharacterSchema，然后将其传入：

```
var CharacterSchema = require('./character');

var User = module.exports = new Schema({
      username: { type: String }
    , characters: [CharacterSchema]
    , created: { type: Date, default: Date.now }
}); 
```

同样，CharacterSchema 文件应该首先需要顶部的 SpellSchema，然后传递它：

```
var SpellSchema = require('./spell');
var CharacterSchema = module.exports = new Schema({ spells: [SpellSchema] }) 
```

这将保留他们的订单。

注意：子文档并不是真正需要成为模型，因为模型被映射到集合，但只要您不`save`直接调用您的子文档，它们就不会被保存到数据库中的单独集合中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:54:49.270

我相信，用户模式需要在字符和拼写*之后声明。*