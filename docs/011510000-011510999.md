# StackOverflow 问答 11510000-11510999

# java - Spring bean 如何检测它本身是否被包装在 AOP 代理中？

> ID：11510003
> 
> 赞同：8
> 
> 时间：2012-07-16T18:09:05.210
> 
> 标签：java, spring, proxy, aop

我们正在使用 Spring`TransactionInterceptor`来设置一些数据库分区信息，`ThreadLocal`只要执行标记有`@Transactional`注释的 DAO 方法。我们需要它能够将我们的查询路由到不同的数据库分区。

这适用于大多数 DAO 方法：

```
// this causes the invoke method to set a thread-local with the host name of
// the database server the partition is on
@Transactional
public int deleteAll() throws LocalDataException { 
```

问题是当我们需要在 DAO 内部引用 DAO*代理*对象本身时。通常我们必须让调用者传入代理 dao：

```
public Pager<Foo, Long> getPager(FooDao proxyDao) { 
```

这看起来像下面的代码，显然很恶心。

```
fooDao.getPager(fooDao); 
```

问题是当我们在 FooDao 内部时，这`this`不是*我们*需要的代理 DAO。

是否有更好的机制让 bean 发现它周围有一个代理包装器？我查看了[Spring AOPUtils](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/aop/support/AopUtils.html)，但我看不到找到对象代理的方法。例如我不想`isAopProxy(...)`。我也阅读了[Spring AOP 文档](http://static.springsource.org/spring/docs/2.5.x/reference/aop-api.html)，但除非我实现自己希望避免的 AOP 本机代码，否则我看不到解决方案。

`ApplicationContextAware`我怀疑我可能能够使用实用程序 bean 和方法将 DAO 注入到自身中`setProxyDao(...)`，但这似乎也是一种 hack。任何其他想法如何检测代理以便我可以从 bean 本身中使用它？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T19:41:21.273

考虑到 AspectJ 编译时间或加载时间编织对您不起作用，按照您的建议提供了一个 hacky 解决方案：

按照以下思路创建接口：

```
public interface ProxyAware<T> {
    void setProxy(T proxy);
} 
```

让您的 Dao 实现 ProxyAware 实现，现在创建一个带有 Ordered 接口的 BeanPostProcessor 以最后运行，如下所示：

```
public class ProxyInjectingBeanPostProcessor implements BeanPostProcessor, Ordered {
    @Override
    public Object postProcessBeforeInitialization(Object bean, String beanName) {
        return bean;
    }

    @Override
    public Object postProcessAfterInitialization(Object bean, String beanName) {
        if (AopUtils.isAopProxy((bean))){
            try {
                Object target = ((Advised)bean).getTargetSource().getTarget();
                if (target instanceof ProxyAware){
                    ((ProxyAware) target).setProxy(bean);
                }
            } catch (Exception e) {
                // ignore
            }
        }
        return bean;
    }

    @Override
    public int getOrder() {
        return Ordered.LOWEST_PRECEDENCE;
    }
} 
```

这很丑陋，但有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T16:10:46.597

Spring 提供了一个方便的静态实用程序[`AopContext.currentProxy()`](http://static.springsource.org/spring/docs/2.5.6/api/org/springframework/aop/framework/AopContext.html#currentProxy%28%29)方法，该方法将代理返回到调用它的对象。

尽管使用它被认为是一种不好的做法，但从语义上讲，Java EE 中也存在相同的方法：[`SessionContext.getBusinessObject()`](http://docs.oracle.com/javaee/5/api/javax/ejb/SessionContext.html#getBusinessObject%28java.lang.Class%29).

我写了几篇关于这种实用方法和各种[陷阱](http://nurkiewicz.blogspot.no/2011/10/spring-pitfalls-proxying.html)的[文章](http://nurkiewicz.blogspot.no/2009/08/spring-aop-riddle.html)：[1、2、3](http://nurkiewicz.blogspot.no/2009/09/spring-aop-riddle-demystified.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T04:22:04.603

使用 Spring 将 bean 引用注入 bean，甚至是同一个 bean，就像您对任何其他 bean 引用一样。无需特殊操作。

这种变量的存在在类设计中明确承认该类期望以某种方式被代理。这不一定是坏事，因为 aop 可以改变破坏类契约的行为。

bean 引用通常是针对一个接口的，对于自引用的内部方法，该接口甚至可以是不同的接口。

把事情简单化。那就是疯狂。:-)

更重要的是，确保语义有意义。这样做的需要可能是代码味道，该类混合了多个职责，最好分解为单独的 bean。

# java - 每次都必须重新创建 ObjectOutputStream

> ID：11510005
> 
> 赞同：1
> 
> 时间：2012-07-16T18:09:07.513
> 
> 标签：java, objectoutputstream, objectinputstream

我见过一些人问过类似的问题，但任何人发布的唯一答案是你不应该这样做。

但我已经对它进行了两种方式的测试 - 它只能以这种方式工作。

服务器端

```
 try {
        // Obtain input and output streams to the client
        while(true) {
            ObjectOutputStream out = new ObjectOutputStream(socket.getOutputStream());
            ObjectInputStream in = new ObjectInputStream(socket.getInputStream());
            Object input = in.readObject();
            if(input == RequestEnums.GETCURRENTGRID) {
                out.writeObject(ContagionServerData.getImagePixels());
                out.writeObject(ContagionServerData.getImageHeight());
                out.writeObject(ContagionServerData.getImageWidth());
            }
        }
    } catch( Exception e ) {
        e.printStackTrace();
    } 
```

客户端

```
 try {
        inputStream = new ObjectInputStream(serverSocket.getInputStream());
        outputStream = new ObjectOutputStream(serverSocket.getOutputStream());
        outputStream.writeObject(RequestEnums.GETCURRENTGRID);
        int[] imagePixels = (int[]) inputStream.readObject();
        int imageHeight = (Integer) inputStream.readObject();
        int imageWidth = (Integer) inputStream.readObject();
        copyImage(background, imagePixels, imageHeight, imageWidth);
    } catch (IOException e) {
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    } 
```

这整天有效。

但如果我把它改成这个——

```
 try {
        // Obtain input and output streams to the client
        ObjectOutputStream out = new ObjectOutputStream(socket.getOutputStream());
        ObjectInputStream in = new ObjectInputStream(socket.getInputStream());

        while(true) {
            Object input = in.readObject();
            if(input == RequestEnums.GETCURRENTGRID) {
                out.writeObject(ContagionServerData.getImagePixels());
                out.writeObject(ContagionServerData.getImageHeight());
                out.writeObject(ContagionServerData.getImageWidth());
                out.flush();
            }
        }
    } catch( Exception e ) {
        e.printStackTrace();
    } 
```

（我在代码的更远处创建了输入和输出流）

```
 try {
        outputStream.writeObject(RequestEnums.GETCURRENTGRID);
        outputStream.flush();
        int[] imagePixels = (int[]) inputStream.readObject();
        int imageHeight = (Integer) inputStream.readObject();
        int imageWidth = (Integer) inputStream.readObject();
        copyImage(background, imagePixels, imageHeight, imageWidth);
    } catch (IOException e) {
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    } 
```

然后我第一次从服务器成功接收到正确的数据 - 但此后每次 - 我只收到相同的数据而不是更新的数据，并且没有错误说明原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:14:10.020

当您在对象流上发送数据时，它只会发送每个对象一次。这意味着如果您多次修改和反对并发送它，您需要使用`writeUnshared(mutableObject)`或`reset()`清除已发送对象的缓存。

* * *

您不能重复创建 ObjectOutput/InputStream。如果要确保发送数据而不是缓冲使用`flush()`。如果您发送数据`int`而不是对象，请尝试 DataOutput/InputStream。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T02:30:57.233

请参阅 Javadoc 了解`ObjectOutputStream.reset()`和`ObjectOutputStream.writeUnshared().`

# ajax - `$.ajax` 中的请求时间有时超过 1 秒，有时超过 30 毫秒

> ID：11510006
> 
> 赞同：2
> 
> 时间：2012-07-16T18:09:12.087
> 
> 标签：ajax, apache, xampp, response, delayed-execution

我在 Windows 7 上使用 xampp 版本 1.7.7。我正在尝试这样做，当您单击保存图像时，它会在后台向 save_record.php 发送信息。我这样做

```
$.ajax({
      url: 'save_record.php',
      data: values.join("&"),
      success: function(data) {
            //document.write(data);
          }
    }); 
```

这显然不是问题。问题是响应很慢，我找不到原因。下面我添加了我从 chrome 速度跟踪器收到的数据。Firebug 还显示 1 秒以上的所有响应。它们以 1055ms 或 1035ms 的格式出现，这让我觉得它在某处卡住了一秒钟。如果这还不够奇怪，它会在某个时间开始快速（30-50 毫秒）发出请求，这对我来说是一个完全可用的应用程序。否则 1 秒的延迟会杀死它。我曾经杀死进程 explorer.exe 并添加为新任务并且它有效。但下一次没有。我重新启动了电脑——一秒钟……当我输入这个问题时，它开始做那些快速的请求。一旦它开始快速完成它们，一切都很好，但是当我启动 xampp（或从睡眠状态打开我的笔记本电脑）时，它通常很慢（1sec+）。一段时间后（通常是 5-10 分钟），这是一个有点自我解决的问题，但它很烦人，而且很奇怪为什么会发生这种情况:) 希望我清楚这个问题。

PS 我测试过，从第一个 php 标签到最后一个标签的时间差约为 20 毫秒，所以我认为不是 PHP 缓存在起作用？

PS2。我会提供所需的任何其他数据，只是不确定要看什么:) 命名它。

![在此处输入图像描述](../Images/da2b180abd6791bb4344c6aa0dbae6fc.png)

**更新**：添加了 Chrome 的网络标签。

![在此处输入图像描述](../Images/dfa42a4fa28b6c9316d6b95236486f3d.png)

**更新**：重新安装 xampp 后问题仍然存在：

![在此处输入图像描述](../Images/fc1e1a79844a8223f2fbd65bbc0e5c7e.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-20T16:34:42.250

取消注释该行解决`127.0.0.1 localhost`了`C:\Windows\System32\drivers\etc\hosts`问题。速度简直莫名的快了起来。[我在这里](http://cubicspot.blogspot.com/2010/07/fixing-slow-apache-on-localhost-under.html)找到了这个建议。其实连Chrome打开其他页面的速度都提升了很多oO

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T11:02:07.643

save_record.php，如果你做任何数据库操作，你写了什么代码可能操作需要很多时间你能提供我“save_record.php”的代码，我可以优化响应或者可以解决你的查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T05:18:27.097

尝试更改`save_record.php`to的内容，`<?php die(); ?>`看看会发生什么。我怀疑在服务器端处理 save_record 操作时存在某种延迟（可能是 DB 是瓶颈，可能是文件 I/O 等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-20T04:54:35.940

您能否为需要一秒钟以上的请求截取网络 > 时间选项卡的 chrome 开发人员工具的屏幕截图并分享。例如。![在此处输入图像描述](../Images/aa00604b8e013a3a6e3686a818a4517f.png)

您必须分析该选项卡中提到的每个操作所花费的时间。并且还检查来自速度跟踪器的事件跟踪以获取更多信息。

# html - HAML - 带破折号的参数

> ID：11510010
> 
> 赞同：31
> 
> 时间：2012-07-16T18:09:28.743
> 
> 标签：html, haml

我怎样才能转换这条线

```
 <body data-spy="abcd"> 
```

到 HAML 语法？

这个给我一个错误

```
 %body{:data-spy => "abcd"} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-16T18:17:35.650

HTML5 数据字段的 HAML 语法：

```
%div{ :data => {:id => '555'} } 
```

现在，我开始搞砸了，看起来这只适用于“数据”——其他标签必须是：

```
%div{ "star-datas" => "hello!" } 
```

你的例子：

```
%body{:data => { :spy => 'abcd'}} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-07-16T18:28:23.513

我不知道为什么我没有首先发布这个。在HAML中编写标签的“正确”方法`<body data-spy="abcd">`是完全跳过`{}`并使用`()`：

```
%body(data-spy="abcd") 
```

如果您没有像 Ruby 一样评估属性的值，则根本不应该使用`{:key => value}`语法。坚持`(key="value")`静态 HTML 属性。

* * *

原答案：

HAML 具有处理数据属性的特定语法，[CrazyVipa 的回答](https://stackoverflow.com/a/11510130/229044)很好地总结了这一点。

为了完整起见，我将指出您也可以在此处和 Ruby 中您想在符号中使用连字符的任何其他地方使用带引号的符号语法：

```
%body{ :"data-spy" => "abcd" } 
```

通常，`:"text"`相当于`"text".to_sym`，允许您的符号包含由于解析器限制而通常不能包含的字符。以下都是有效符号：

```
:"symbol with spaces"
:"symbol-with-hyphens"
:"symbol
with
newlines"
:"def my_func(); puts 'ok'; end" 
```

请注意，带引号的符号*不适*用于 Ruby 1.9 的新哈希语法：

```
{ :"key-1" => "value" } # works in 1.8/1.9
{ "key-1": "value" }  # syntax error 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-02-05T23:57:06.107

### 对于 HAML 红宝石编译器：

```
%div{data: {some_hyphenated_id: 'value'}} 
```

和 HAML 自动将下划线转换为连字符，所以我得到：

```
<div data-some-hyphenated-id="value"></div> 
```

仅供参考：如果您需要空属性，只需使用`true`而不是`'value'`

### 例子：

哈姆尔：

```
%div{data: {topbar: true}}
%div{data: {image_carousel: true}} 
```

HTML：

```
<div data-topbar></div>
<div data-image-carousel></div> 
```

更具体地说，此语法对**ruby​​ haml gem**以及设置为的 grunt task grunt **-haml**`language`有效`ruby`（需要安装提到的 ruby​​ haml gem）

# javascript - .lrc 的任何 JavaScript 解析器？

> ID：11510012
> 
> 赞同：1
> 
> 时间：2012-07-16T18:09:33.120
> 
> 标签：javascript, parsing, .lrc

我使用的是[Kejun's Blog](http://hikejun.com/blog/2006/09/17/javascriptparsing-lrc-lyric/)中的代码。

我想解析一个 .lrc （基本上是一个歌词文件），以便获取时间变量以及字符串（读取歌词）。我尝试了这段代码，但似乎无法获得输出。

```
 <html>
<head> 
<script src="jquery-1.7.1.js"></script>
<script> 
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "a.txt",
        dataType: "text",
        success: function (data) {
            parseLyric(data);
        }
    });
});

var _current_lyric = new Array();

function convertLRCLyric(inf) {
    inf += "n";
    var lyric = inf.match(/([(d{2}:d{2}(.d{1,2}){0,1})]){1,}W*n|([(d{2}:d{2}:d{2}(.d{1,2}){0,1})]){1,}W*n/ig);
    var l_s = '',
        l_tt, l_ww, l_i, l_ii;
    if (!lyric || !lyric.length) {
        return;
    }

    for (l_i = 0; l_i < lyric.length; l_i++) {
        l_tt = lyric[l_i].match(/([d{2}:d{2}(.d{1,2}){0,1}])|([d{2}:d{2}:d{2}(.d{1,2}){0,1}])/ig);
        l_ww = lyric[l_i].replace(/[S+]/ig, '').replace(/n{1,}/ig, '');
        for (l_ii = 0; l_ii < l_tt.length; l_ii++) {
            l_tt[l_ii] = l_tt[l_ii].replace(/[/,'').replace(/]/, '');
            if (l_tt[l_ii].search(/d{2}:d{2}:d{2}.d{2}/g) >= 0) {
                _current_lyric[l_tt[l_ii].substring(0, l_tt[l_ii].length - 1)] = l_ww;
            } else if (l_tt[l_ii].search(/d{2}:d{2}:d{2}.d{1}/g) >= 0) {
                _current_lyric[l_tt[l_ii]] = l_ww;
            } else if (l_tt[l_ii].search(/d{2}:d{2}:d{2}/g) >= 0) {
                _current_lyric[l_tt[l_ii] + ".0"] = l_ww;
            } else if (l_tt[l_ii].search(/d{2}:d{2}.d{2}/g) >= 0) {
                _current_lyric["00:" + l_tt[l_ii].substring(0, l_tt[l_ii].length - 1)] = l_ww;
            } else if (l_tt[l_ii].search(/d{2}:d{2}.d{1}/g) >= 0) {
                _current_lyric["00:" + l_tt[l_ii]] = l_ww;
            } else if (l_tt[l_ii].search(/d{2}:d{2}/g) >= 0) {
                _current_lyric["00:" + l_tt[l_ii] + ".0"] = l_ww;
            }
        }
    }
}

function parseLyric(allText) {
    _current_lyric = [];
    convertLRCLyric(allText);
    var ly = "";
    for (var time in _current_lyric) {
        ly += time + "--" + _current_lyric[time] + "n";
    }
    alert(ly);
}
</script>
</head>
<body>

</body>
</html> 
```

但我一直收到空白警报。任何帮助都会很棒。提前致谢 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T14:57:30.043

**回答 ：**

好的，所以我构建了自己的解析器，这是代码

```
var contents = " " ;
function readMultipleFiles(evt) {
    //Retrieve all the files from the FileList object
    var files = evt.target.files;

    if (files) {
        for (var i = 0, f; f = files[i]; i++) {
            var r = new FileReader();
            r.onload = (function (f) {
                return function (e) {
                    contents = e.target.result;
                   processData(contents);
                };
            })(f);
            r.readAsText(f);
        }
    } else {
        alert("Failed to load files");
    }
}
document.getElementById('fileinput').addEventListener('change', readMultipleFiles, false);

var allTextLines = " ";
var lyrics = [];
var tim = [] ;
var line = " ";

// parsing the Lyrics 
function processData(allText) { // This will only divide with respect to new lines 
    allTextLines = allText.split(/\r\n|\n/);

     next();
   } 
 function next()
 {
for (i=0;i<allTextLines.length;i++)
{
if (allTextLines[i].search(/^(\[)(\d*)(:)(.*)(\])(.*)/i)>=0 )// any line without the prescribed format wont enter this loop 
{
    line = allTextLines[i].match(/^(\[)(\d*)(:)(.*)(\])(.*)/i);
        tim[i] = (parseInt(line[2])*60)+ parseInt(line[4]); // will give seconds 
        lyrics[i]= line[6] ;//will give lyrics 

 }
 }  

  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-15T04:01:10.423

代码 php：带格式

```
public function get_lrc_song($song) {
    $lyrics_file = $song ['lyrics_file'];
    $json = curlClass::getInstance ( true )->fetchURL ( $lyrics_file );
    $content = explode ( "\n", $json );
    $regix = "$\][^>]+$";
    $result = "";
    foreach ( $content as $item ) {
        $isHas = preg_match ( $regix, $item, $data );
        $dt = str_replace ( "]", "", $data[0] );
        if ($dt != ""){
            $result .= $dt . "\n";
        }
    }
    echo $result;
} 
```

# python - 需要帮助修复/改进python中的while循环和计算器

> ID：11510021
> 
> 赞同：-1
> 
> 时间：2012-07-16T18:10:09.453
> 
> 标签：python, sum, calculator

请记住，我对 python 编码仍然很陌生，因为我才刚刚进入我的 python 编码课程的第 5 章。牢记这一点，我正在尝试使用“while 循环”创建一个总和计算器以继续，直到用户输入负数而不是正数。

如果我对问题的描述不完全清楚，我将在此处发布确切的作业问题：

第 5 章，第 200 页，#8 数字之和

编写一个带有 while 循环的程序，要求用户输入一系列正数。用户应该输入一个负数来表示系列的结束。输入所有正数后，程序应显示它们的总和。

现在对于我到目前为止编写的代码：

```
def main():
    number = float(input('Please enter in a positive number: '))
    while number > 0:
        positiveNumber()
    while number < 0:
        calculateTotal()
        printTotal()

def positiveNumber():
    number = float(input('If you are finished please enter a negative number.' + \ 'Otherwise, enter another positive number: '))
    while number > 0:
        positiveNumber()
    while number < 0:
        calculateTotal()
        printTotal()

def calculateTotal():
    total = 0 + number

def printTotal():
    print('The sum of your numbers is: ', total)

main() 
```

*   在第 11 行，我有一个“+ \”符号，因为我想在那里输入一个空格，以便让文本看起来更清晰，但这似乎不起作用。

如果这个问题看起来“nooby”，我深表歉意，但我需要帮助制作一个更清洁/工作的总和计算器。如果有人可以查看此代码并希望能帮助我改进它，我将不胜感激。谢谢！

最终编辑：

谢谢大家提供的信息丰富的答案！我学到了很多东西（对于“新手”=]）。我在计算器上使用了 Talon876 的答案。再次感谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:18:42.063

如果要将单个字符串打印在多行上，`\n`请在字符串中输入 a。例如，

```
print "This is on the first line\nThis is on the second line" 
```

会输出

```
This is on the first line
This is on the second line 
```

看起来您正在将 while 循环与递归混合（从自身内部调用方法）。我建议使用单个 while 循环和输入变量来检查中断条件（输入 < 0）

它看起来像这样：

```
sum = 0
number = float(input('Please enter in a positive number: '))
while number > 0:
    sum = sum + number
    number = float(input('If you are finished please enter a negative number.' + \ 'Otherwise, enter another positive number: ')) #fix this line using the information from the first part of the answer 
```

这将循环直到用户输入负数或 0。如果您想接受 0 作为正数，请将 while 条件更改为`number > -1`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:35:19.557

如果不明确将其声明为全局变量，则无法更新 python 函数中的全局变量。观察：

```
a = 1
def foo():
    a = a + 6  #creates a new variable (a) that is confined to the "foo" namespace.
           #Note that it still uses a from the global namespace on the Right hand side
           #This is because python looks for a in the "foo" namespace first.  When
           #it isn't found there, it looks in the global namespace.  However, python
           #WON'T ASSIGN to something in the global namespace without being told 
           #to explicitly
    print (a)

foo() # 7
print (a)  # 1

def foo():
    global a #Tell python that it is OK to assign to variable "a" in the global namespace.
    a = a + 6
    print (a)

foo()   # 7
print (a) # 7 
```

然而，这种强大的力量伴随着巨大的责任。许多人会告诉你*永远不要使用全局变量*。在很多方面，它们是正确的，因为使用全局变量可以完成的任何事情都可以使用其他方法更干净地完成。我写这篇文章的希望不是说服您使用全局变量，而是帮助您理解代码中的错误之一。

您可能想要尝试的一件事是让您的函数接受输入数字作为参数以及到目前为止的总数，然后`return`是新的总数。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:42:20.880

问题是 1.您没有将函数中使用的变量声明为全局变量，请注意对它们所做的更改

2.如果您通过递归调用函数来实现它，则不需要while循环！您需要检查条件，如“if＆else”这里是while循环问题的简单实现：

```
def main():
total=0
number = float(input('Please enter in a positive number: '))
while(number>0):
    total=total+number
    number = float(input('Please enter in a positive number to continue or a negative no. to stop: '))
print('The sum of your numbers is: %d'% total)
main() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:42:50.400

我想你正在寻找这样的东西？但我不知道您需要使用什么样式约束。

```
number = float(input('Please enter in a positive number: '))
to_sum = []
while number > 0:
    to_sum.append(number)
    number = float(input('If you are finished please enter a negative number.\n' +
                         'Otherwise, enter another positive number: '))
print('The sume of your numbers is: ', sum(to_sum)) 
```

请注意，由于您尝试拆分为多行的语句已经在 () 的内部，因此您不需要 . 你可以打破界限。

作业要求你使用这么多疯狂的功能吗？另外，您使用的是哪个版本的 Python？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T19:38:38.697

您需要学习的一件事是如何将程序分解为函数。有些问题最好由单个代码块来处理，而不是被拆分，我认为这就是其中之一。

您需要计算一个总和。您可以使用单个变量来处理它，当用户输入它们时，您可以向其中添加更多数字。你的代码应该围绕这个变量来设计。如果您尝试将代码拆分为函数，则要么需要使用全局变量（不推荐！），要么需要在函数之间传递变量，或者您可以将变量放入对象中然后 make这些函数是对象上的“方法”函数。但最简单的方法是编写一些使用该变量的代码，并使所有这些代码成为单个代码块（一个函数，甚至只是 Python 程序中的代码）。

这是一个解决方案：

```
sum = 0.0  # initial value; we will add values to this
print('Welcome to this program')
while True:
    s = input('User: enter data value or a negative number to stop')
    x = float(s)
    if x < 0:
        break
    sum += x  # add this value to update the sum
print('Here is your sum: {}'.format(sum)) 
```

所以，这就是上面代码的优点。所有需要使用变量`sum`的地方都靠得很近，我们可以看到它们。我们不需要声明`sum`global，因为我们没有多个函数试图全部使用它。

看看那段代码，问问自己：如果我们把它分成多个函数，会更简单或更干净吗？如果没有，那就不要这样做。

这里唯一棘手的是我们使用`while True:`了循环。这是因为我们想做一些事情（获取输入），然后根据结果，决定是跳出循环还是继续，最后根据决定做其他事情（更新总和）。

可以重写它以使用“标志”变量，并进行循环`while flag:`，但我认为它不干净：

```
sum = 0.0  # initial value; we will add values to this
print('Welcome to this program')
continue_loop = True
while continue_loop:
    s = input('User: enter data value or a negative number to stop')
    x = float(s)
    if x < 0:
        continue_loop = False
    else:
        sum += x  # add this value to update the sum
print('Here is your sum: {}'.format(sum)) 
```

你认为有`continue_loop`flag 变量更清楚吗？有些教科书说你应该这样写代码，因为他们认为`break`在中间退出循环是一种罪过；他们认为循环应该只从通常的位置退出（对于`while`循环来说，它是顶部）。

如果你真的想使用函数怎么办？好吧，你可以，但你仍然不应该使用全局变量。实际上，如果您正在编写“函数式”解决方案，则根本不需要`sum`变量！

这是一个功能解决方案。

```
def ask_and_sum():
    s = input('Hey dude enter a value or a negative to stop')
    x = float(s)
    if x < 0:
        return 0
    else:
        return x + ask_and_sum()

print('Welcome to this program')
print('Your sum is: {}'.format(ask_and_sum())) 
```

这不是显式循环，而是使用“尾递归”，其中函数以对自身的另一个调用结束。在这种情况下，我个人更喜欢显式循环。你怎么看？

PS这个问题很简单，如果不给你完整的答案就很难讨论它。我为此道歉。但即使你只是复制代码，请看它，思考它，并确保你理解它。

# iphone - 为写在 UIIImage 上的文本添加阴影

> ID：11510025
> 
> 赞同：1
> 
> 时间：2012-07-16T18:10:16.563
> 
> 标签：iphone, objective-c, sdk, uiimage

我正在将文本写入图像，如下所示：

```
 -(UIImage *)addLabelToImage:(UIImage *)img
{
    UIFont *font = [UIFont boldSystemFontOfSize:20];
    UIGraphicsBeginImageContext(img.size);
    [img drawInRect:CGRectMake(0, 0,img.size.width,img.size.height)];
    CGRect rect = CGRectMake(60, 550, img.size.width, img.size.height);
    [[UIColor whiteColor] set];
    [[NSString stringWithFormat:@"%@, %@", [[NSUserDefaults standardUserDefaults] valueForKey:@"whatever"], [[NSUserDefaults standardUserDefaults] valueForKey:@"whatever2"]] drawInRect:CGRectIntegral(rect) withFont:font]; 
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return newImage;
} 
```

我将如何在此文本中添加阴影？我知道我可以将文本重绘为移动几个像素的黑色文本，但有没有更简单的方法？

干杯，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:14:18.087

在绘制文本之前，您可以像这样设置阴影：

```
//...
CGContextRef c = UIGraphicsGetCurrentContext();
CGSize offset = CGSizeMake(0, 1);
CGFloat blur = 2.0;
UIColor *shadowColor = [UIColor blackColor];
CGContextSetShadowWithColor(c, offset, blur, [shadowColor CGColor]);
//draw your text ... 
```

根据需要调整`offset`,`blur`和`shadowColor`参数以达到您想要的效果。对于锐利的阴影（如在 a 上`UILabel`），设置`blur`为`0`。

# ios - 透明 .png 在 iOS 4 中不透明，在 iOS 5 中看起来不错

> ID：11510028
> 
> 赞同：0
> 
> 时间：2012-07-16T18:10:25.610
> 
> 标签：ios, png

看一看：

![](../Images/1949a43a2146f4c3fb8a18656e2800e3.png)

![](../Images/5013e2720101f1ade9509b9fdd2b43c1.png)

这是我用来制作渐变的代码：

```
gradView = [[UIView alloc] initWithFrame:CGRectMake(0, 440, self.view.frame.size.width, 80)];
gradView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"sepGrad.png"]];
gradView.alpha = 0.2;
[self.view addSubview:gradView]; 
```

和 .png 文件：

![](../Images/1572b96a64a00c9056eb280882764168.png) ![](../Images/bb724d1bb7de8ee854a8bd0cfeac6dd1.png)

为什么 iOS4 无法正确显示透明的 .png？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:16:38.147

我认为这是 iOS 4.3 中的一个错误，请参阅此答案：[https ://stackoverflow.com/a/8896838/429331](https://stackoverflow.com/a/8896838/429331)

在你的情况下：

```
gradView = [[UIView alloc] initWithFrame:CGRectMake(0, 440, self.view.frame.size.width, 80)]; 
gradView.opaque = YES;
gradView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"sepGrad.png"]];
gradView.opaque = NO;
gradView.alpha = 0.2;
[self.view addSubview:gradView]; 
```

您也可以尝试省略`gradView.opaque = YES;`，我不确定是否真的有必要。

# r - R对输入执行grep

> ID：11510030
> 
> 赞同：2
> 
> 时间：2012-07-16T18:10:46.607
> 
> 标签：r

我有一个包含以下内容的文件

```
3594 -124.049541 44.429077
 -123.381222 44.530192
 -123.479913 44.625517
 -123.578917 44.720704
END
3595 -123.103772 45.009223
 -122.427717 45.101578
 -122.525757 45.198252
 -122.624122 45.294789
END
3676 -122.989567 44.147495
 -122.323040 44.238368
 -122.419523 44.335217
 -122.516322 44.431923
END
END 
```

我想将此文件读入 R，但我只想保留缩进的行。

这似乎是一份不错的工作`grep`，但我不知道如何让它发挥作用。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:18:27.730

您可以尝试，其中`file.txt`包含您的数据：

```
a <- readLines("file.txt")
a <- a[grepl("^ ", a)]
do.call("rbind", strsplit(a, " "))[, -1]
       [,1]          [,2]       
  [1,] "-123.381222" "44.530192"
  [2,] "-123.479913" "44.625517"
  [3,] "-123.578917" "44.720704"
  [4,] "-122.427717" "45.101578"
  [5,] "-122.525757" "45.198252"
  [6,] "-122.624122" "45.294789"
  [7,] "-122.323040" "44.238368"
  [8,] "-122.419523" "44.335217"
  [9,] "-122.516322" "44.431923"

# Alternatively you can get the data by read.table() as suggested by @Josh
read.table(textConnection(a))
         V1       V2
1 -123.3812 44.53019
2 -123.4799 44.62552
3 -123.5789 44.72070
4 -122.4277 45.10158
5 -122.5258 45.19825
6 -122.6241 45.29479
7 -122.3230 44.23837
8 -122.4195 44.33522
9 -122.5163 44.43192 
```

# .net - 创建了可绑定的 WindowsFormsHost，但子更新未反映到控件

> ID：11510031
> 
> 赞同：8
> 
> 时间：2012-07-16T18:10:46.957
> 
> 标签：.net, wpf, binding, windowsformshost

我创建了一个问题，我想将控件绑定到 windowsFormsHost 控件。但是众所周知，**Child**属性不是 DP，所以我创建了一个包装器。

```
/// <summary>
    ///     Bindable version of windows form hosts
    /// </summary>
    public class BindableWindowsFormsHost : WindowsFormsHost
    {
        /// <summary>
        /// Max value of the textbox
        /// </summary>
        public Control BindableChild
        {
            get { return (Control)GetValue(BindableChildProperty); }
            set 
            {
                SetValue(BindableChildProperty, value);
            }
        }

        // Using a DependencyProperty as the backing store for Max.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty BindableChildProperty =
            DependencyProperty.Register("BindableChild", typeof(Control), typeof(BindableWindowsFormsHost),  new FrameworkPropertyMetadata(new PropertyChangedCallback(OnBindableChildChanged)));

        /// <summary>
        /// Handles changes to the FlyoutWindowSize property.
        /// </summary>
        private static void OnBindableChildChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            ((WindowsFormsHost)d).Child = e.NewValue as Control;
        }
    } 
```

e.NewValue 获得了我想要的控件并正确设置它，但我没有看到更改被反映。孩子已设置，但无法看到带有新控件的 windowsFormsHost。

有人知道吗？

谢谢和问候， Kev84

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T19:34:59.647

您可以将 WindowsFormsHost 包装在 ContentControl 中，并通过绑定设置其 Content 属性，而不是创建包装器。这样可以避免 WindowsFormsHosts Child 属性不是依赖属性的问题。

XAML 中的类似内容：

```
<ContentControl Content="{Binding MyWindowsFormsHost}" /> 
```

..这在你的代码隐藏中：

```
public WindowsFormsHost MyWindowsFormsHost
{   
    get { return new WindowsFormsHost(){Child=myWinformsControl}; }   
} 
```

# java - 我如何确定某人是否正在使用 Python 或 Java 中的 Linux 计算机？

> ID：11510032
> 
> 赞同：2
> 
> 时间：2012-07-16T18:10:46.833
> 
> 标签：java, python

如果远程计算机没有被积极使用，我想编写一个将 ssh 放入远程盒子并在那里运行作业的程序。我将以 clusterJobRunner@remoteBox 身份登录，而另一个用户将以 someLocalUser@remoteBox 身份登录。

有没有办法查看远程用户是否正在使用 Python 或 Java 主动使用该框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:44:03.220

如果目的是避免打扰 someLocalUser，您可以考虑以较低的优先级运行您的作业。请参阅文档以获取[nice](http://linux.about.com/library/cmd/blcmdl1_nice.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:15:03.130

在 Java 中，您可以使用 执行`users`Linux 命令`Runtime.exec()`，获取标准输出并将其转换为可解析的`String`. 我认为没有任何独立于操作系统的方法可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:37:03.390

我认为“积极使用”的部分是棘手的部分。

如果检查其他用户是否登录就足够了，您可以使用命令`w`and`who`或者`last`and `lastlog`。所有这些命令都有几个参数，您可以在手册中查找。

在 Java / Python 中，您可以执行这些命令并解析它们的输出。

另一方面：工具`w`和`who`使用文件`utmp`来获取他们的信息。一个快速的谷歌没有为 Java 找到任何东西，但对于 Python，我找到了库[pyutmp](http://software.clapper.org/pyutmp/)，您可以使用它`utmp`直接读取文件而无需解析命令输出。

用户是否登录并去吃午饭（可能锁定屏幕）完全是另一回事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:49:42.960

我支持@Eero Aaltonen 的答案——你应该在`nice`. 一台 Linux 计算机可以在 100% CPU 繁忙的情况下运行，但如果额外的任务全部完成，用户会感觉良好且快速`nice`；调度程序只会`nice`在主用户的任务空闲时运行任务。

但是，如果您想弄清楚机器是否正在使用，我建议您查看`w`命令。按照您的提示尝试`man w`。该`w`命令打印机器的平均负载、用户列表以及他们使用了多少时间（包括他们正在运行的任何后台任务的组合时间，加上他们的主要任务的时间）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-25T08:29:32.413

您需要定义“积极使用”对您意味着什么。以下哪项定义了“积极使用”：

1.  用户已登录
2.  用户正在积极地与盒子互动，在他们的 ssh 会话中输入内容。
3.  用户正在运行作业

如果 #2 是您要查找的内容，并且用户仅使用 ssh 登录，您可能会挂接到 sshd 守护程序并监视它是否正在接收来自 ssh 客户端的输入。

例如，如果您将 strace 附加到已登录用户的 sshd，您可以监视来自 ssh 客户端的读取。这是一个对我有用的例子：

```
$ for x in $(ps aux | grep sshd | grep "@pts" | sed -E 's/[^ ]+ +([0-9]*).*/\1/'); do {(sudo strace -p $x -eread 2>&1 | grep 'read(4' )&}; done
[1] 166396
[2] 166397
[3] 166399
[4] 166402
read(4, "\206\261\364\271\204\\\26S\3\"El\365W\352\35\375\242\205Qlu@$\2538\306\2777oW\230"..., 16384) = 36
read(4, "@s\2733d\355\17~\2550=\316`)3|^\340\f\252\242_\251\377d[l\221\210|z\37"..., 16384) = 36
read(4, "\5\214\261\25\322\222\242\221\313\314\4$\344\273\200\220a\233\345*\7\17\274\331\246\363f.\346\365\22\255"..., 16384) = 36
read(4, "\325\220<\0:\34^\235\346y\223\304\3061\212\203\373\371rD Rs\254oL*\260\22\234\372\27"..., 16384) = 36
read(4, "TXD\7\373~.\214\321\35\201\350\22\211\34J~m\\\270\364\243\267\261\207\323\224\314x\240i'"..., 16384) = 36
read(4, "\347\320\243\v/Z\213n\7\264\376\27\0340\30\364u!9\n\326\314)c\331\362\346\256\317E8\317"..., 16384) = 36
read(4, "\7\264\207\232\252xT\271\240Aq\210\21m\232l\306i\225\311\356\3 
```

您在这里看到的是对使用 ssh 登录的每个用户的所有 sshd 分叉进程的文件描述符 4 上的读取调用。文件描述符 4 似乎是分配给连接到客户端 (YMMV) 的套接字的描述符。每行输出意味着一个用户（或脚本）正在从客户端向服务器发送一些东西，这似乎对应于用户在 shell 中输入一些东西。

您也许可以在此基础上再接再厉。

# ruby-on-rails - 我如何使用“.has_role”？来自 Tabulous 中的 Rolify？

> ID：11510034
> 
> 赞同：0
> 
> 时间：2012-07-16T18:10:48.860
> 
> 标签：ruby-on-rails, devise, cancan

我有一个使用 Rolify、Devise、CanCan 和 Tabulous 的应用程序。

在我的`tabulous.rb`文件中，我希望能够`Visibility?`通过调用来定义选项卡：

```
(current_user.has_role? :admin) 
```

所以`config.tabs`do 看起来像这样：

```
# TAB NAME | DISPLAY TEXT | PATH | VISIBILE? | ENABLED?
[ :admin_tab, 'ADMIN' , ingredients_path , (current_user.has_role? :admin) , true ], 
```

除了当我进入`/users/sign_in`路径时，大多数页面都可以正常工作；它返回以下错误：

```
NoMethodError in Devise/sessions#new

Showing /Users/[myname]/Projects/[project-name]/app/views/layouts/application.html.haml where line #24 raised:

undefined method `has_role?' for nil:NilClass 
```

第 24 行只是指向文件中的`=tabs`调用`applications.html`。

我知道问题是`/users/sign_in`无法访问该`.has_role?`功能。

**我怎样才能使`tabulous.rb`文件可以使用它？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T11:53:32.613

我已经尝试过这段代码并且工作了！

```
config.tabs do
  showTab = (current_user && (current_user.has_role? :admin))
  [
    [ :users_tab, "Users", users_path, showTab, showTab],
  ]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T16:35:08.093

如果我没记错的话，tabulous 在生产模式下缓存 tabulous.rb，所以虽然你的方法可能在开发中的大部分时间都有效，但它会在生产中中断，每个人最终都会得到相同的选项卡，一种方式或其他。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T04:21:18.650

可以在 `tabulous.rb 文件中完成一个简单的修复

```
[:admin_tab, 'Admin', users_path, current_user && current_user.has_role?(:admin), true], 
```

`current_user``tabulous.rb`用户退出时未定义，因此如果确实有定义，您还需要签入文件`current_user`。

# php - 如何将我的 ajax 数据放入 php 数组中？

> ID：11510036
> 
> 赞同：1
> 
> 时间：2012-07-16T18:11:01.070
> 
> 标签：php, jquery, ajax

我在 JS 脚本中有以下数据：

```
$("#holdSave").live('click', function () {
    var arr = {};
    var cnt = 0;

    $('#holdTable tbody tr').each(function () {
        arr[cnt] = {
            buyer: $(this).find('#tableBuyer').html(),
            sku: $(this).find('#tableSku').html(),
            isbn: $(this).find('#tableISBN').html(),
            cost: $(this).find('#tableCost').val(),
            csmt: $(this).find('#tableConsignment').val(),
            hold: $(this).find('#tableHold').val()
        };
        cnt++;
    }); //end of holdtable tbody function
    console.log(arr);
    $.ajax({
        type: "POST",
        url: "holdSave.php",
        dataType: "json",
        data: {
            data: arr
        },

        success: function (data) {

        } // end of success function

    }); // end of ajax call

}); // end of holdSave event 
```

我需要将此发送到 php 文件以更新数据库并通过电子邮件发送更新已完成。我的 console.log(arr); 当我在 firebug 中运行它时显示对象，但我无法获得 php 端的任何信息。这是我的 php 代码：

```
$data = $_POST['data']; 

print_r($data); die; 
```

在这一点上，我只是想验证是否有信息被发送过来。我的 print_r($data); 什么都不返回。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:14:18.950

使用`json_encode()`and`json_decode()`方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:22:14.270

`dataType: "json"`意味着您期望在您的请求中检索 json 数据，而不是您发送的内容。

如果要发送一个 json 字符串以通过`$_POST['data']`使用检索

```
data: {data: JSON.stringify(arr)}, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:16:35.350

使用下一个方法：

```
data = {key1: 'value1', key2: 'value2'};

$.post('holdSave.php', data, function(response) {
    alert(response);
}); 
```

注意：没有测试过，一定要查找解析错误。

# asp.net - 带有 URL 重写的 HTTPS 在 appharbor 上不起作用

> ID：11510037
> 
> 赞同：2
> 
> 时间：2012-07-16T18:11:09.763
> 
> 标签：asp.net, appharbor

我在托管在[AppHarbor](https://appharbor.com/)上的 asp.net 3.5 上构建了一个应用程序。问题是 HTTPS URL 重写不起作用。以下是在 SSL 上运行某些页面的代码：

```
string CurrentUrl = Request.Url.ToString();
string sPath = System.Web.HttpContext.Current.Request.Url.AbsolutePath;      
System.IO.FileInfo oInfo = new System.IO.FileInfo(sPath);
string sRet = oInfo.Name;       
string sDir = oInfo.Directory.Name;     
pageName = sRet;
if (sRet == "Register.aspx" || sRet == "Login.aspx" || sRet == "Post.aspx" || sRet == "ChangePassword.aspx" || sRet == "ChangeUserStatus.aspx" || sRet == "Verification.aspx" || sRet == "ContactInfo.aspx" || sRet == "Find.aspx" || sRet == "MyAccount.aspx" || sRet == "MyEmailAddresses.aspx" || sRet == "Load.aspx" || sRet == "MyPostedLoads.aspx" || sRet == "MySubmittedBids.aspx" || sRet == "MySavedAddresses.aspx" || sRet == "MyCarriers.aspx" || sRet == "MyPotentialLoads.aspx" || sRet == "MyFreightAlarms.aspx" || sRet == "MyFreightAlarmsPreferences.aspx" || sRet == "MyAddress.aspx" || sRet == "GetUserComments.aspx" || sRet == "MyCreditCard.aspx" || sRet == "MyWallet.aspx" || sRet == "InvoiceMe.aspx" || sRet == "MyShippers.aspx" || sRet == "MyCoWorkers.aspx" || sRet == "MyACH.aspx" || sRet == "RouteMap.aspx" || sRet == "Pricing.aspx" || sRet == "PricingPayment.aspx" || sRet == "PaymentProcessed.aspx")
{
    string NewUrl = "";

    if (!Request.IsSecureConnection && !string.Equals(HttpContext.Current.Request.Headers["X-Forwarded-Proto"], "https", StringComparison.OrdinalIgnoreCase))
    {
        NewUrl = Regex.Replace(CurrentUrl,
                               @"^https?(://[^/:]*)(:\d*)?", 
                               "https$1", 
                               RegexOptions.IgnoreCase);

        Response.Redirect(NewUrl);
    }
} 
```

以及 web.config 上的 URL 重写规则：

```
<rewrite>
  <rules>
    <rule name="Rewrite with .aspx" stopProcessing="true">
      <match url="^([^\.]+)$" />
      <action type="Rewrite" url="{R:1}.aspx" />
    </rule>
    <rule name="Redirect .aspx page requests" stopProcessing="true">
      <match url="(.+)\.aspx" />
      <action type="Redirect" url="{R:1}" />
    </rule>
  </rules>
</rewrite> 
```

问题是该页面仍处于无限循环中，无法正确重定向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-20T17:44:49.753

就像 EdSF 提到的那样，您遇到的问题是因为 SSL (HTTPS) 处于负载平衡器级别。这意味着，进入 ASP.NET 应用程序的所有请求都是 HTTP。

因此，在您在 AppHarbor 上运行的应用程序中，以下内容将始终为真：

```
Request : https://mysite.com/about
---------------------------------------------------------------------------------
-> Request.Url.Scheme // http
-> Request.Url.AbsoluteUri // http://mysite.com:port/about
-> Request.issecure // false 
```

您重写规则依赖于协议/方案`https`，它永远不会，导致无限循环。

在 AppHarbor 上运行的 ASP.NET 应用程序中检查 HTTPS 的方法如下：

```
string.Equals(Request.Headers["X-Forwarded-Proto"], 
              "https", 
              StringComparison.InvariantCultureIgnoreCase); 
```

我还在 AppHarbor 上托管我的 Web 应用程序，并且需要更好的解决方案，因此我创建了`SecurePages`项目 ( [NuGet](http://www.nuget.org/packages/SecurePages/) - [GitHub](https://github.com/webadvanced/Secure-Page-manager-for-asp.net) )。该项目允许您使用字符串文字和正则表达式配置安全/https URL。它还强制所有其他 URL 使用 HTTP。您还可以注册充当 HTTP 请求匹配规则的自定义谓词委托。因此，您可以为 AppHarbor 注册一个以检查标头：

```
//Secure a page    
secureUrls.AddUrl("/Register.aspx");

//Secure any page under /cart/*
secureUrls.AddRegex(@"(.*)cart", RegexOptions.IgnoreCase);

//Register a custom HTTPs match rule for AppHarbor
SecurePagesConfiguration.RegisterCustomMatchRule(
                c => string.Equals(c.Request.Headers["X-Forwarded-Proto"], "https", StringComparison.InvariantCultureIgnoreCase)); 
```

安全页面还支持使用 IIS Express 进行单元测试和本地浏览器测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:28:09.420

> RequireHttpsAttribute：如果您使用内置的 RequireHttpsAttribute 来确保控制器操作始终使用 HTTPS，您将遇到重定向循环。**原因是 SSL 在负载均衡器级别终止，**并且 RequireHttps 无法识别它用来指示请求是使用 HTTPS 发出的 X-Forwarded-Proto 标头。

“肉”是粗体。

请参阅：[AppHarbor SSL 常见问题解答](http://support.appharbor.com/kb/tips-and-tricks/ssl-and-certificates)- 特别是*故障排除*部分。

如果您的 Web 服务器前面有 SSL 集中器或类似设备，也会出现同样的问题。这在“云托管”环境中很常见......

嗯……

# c# - 正则表达式：长度未知的部分名称？

> ID：11510044
> 
> 赞同：2
> 
> 时间：2012-07-16T18:11:31.210
> 
> 标签：c#, regex

我有一个格式如下的文本块：

`1.2.3.4.5`或`1.2222.3.4.5`或`1`或`1.2` 等

未知数量的数字和点（法律文件的部分）

如何将整个部分 (1.2.3.4.5) 捕获到一个组中？

我使用 C#，但任何正则表达式都可以，我可以翻译它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:22:36.333

**更新**

使用这个`Regex`：

```
Regex.Matches(inputString, @"\d[\.\d]*(?<!\.)"); 
```

解释：

```
\d                       digits (0-9)

[.\d]*                   any character of: '.', digits (0-9) 
                         (0 or more times, matching the most amount possible))

(?<! subexpression)      Zero-width negative lookbehind assertion. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T18:29:35.297

```
string s = "1.2.3.4.5 or 1.2222.3.4.5 or 1 or 1.2 or 2222.3333.111.5 etc";
var matches = Regex.Matches(s, @"\d+(\.\d+)*").Cast<Match>()
    .Select(m => m.Value)
    .ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:14:21.800

好吧，如果你知道你不能超过 5，那么你可以做到

```
@"1+((.2+)((.3+)((.4+)(.5+)?)?)?)?" 
```

并且您可以为每个符号扩展该模式，最多为有限数量的符号

表示符号出现的`+`任意次数，但至少出现 1 次。如果 0 有效，则可以`*`改用

`?:`如果您**不**想像示例那样捕获模式，请放在左括号之后：我`(?:abc)`
省略了它们以使正则表达式更具可读性。

这 ？括号后，表示前一个符号的 1 或 0。

现在，如果你不知道你的字符串可以走多远，例如

`"1.2.3.4......252525.262626.272727.......n.n.n"`比我的直觉告诉我，你不能用正则表达式做到这一点。

# hook - Gitolite 更新挂钩排除存储库

> ID：11510046
> 
> 赞同：3
> 
> 时间：2012-07-16T18:11:38.543
> 
> 标签：hook, gitolite

我正在添加一个 gitolite 更新挂钩作为 VREF，并且想知道是否有办法将它应用于除 gitolite-admin 之外的所有存储库。

有一种更简单的方法而不是列出我想要应用挂钩的所有存储库会很棒。

目前我有：

```
repo @all
-    VREF/update    =   @all 
```

我正在考虑为 gitolite-admin 存储库添加一个例外。就像是：

```
repo gitolite-admin
RW+  VREF/update    =   @all

repo @all
-    VREF/update    =   @all 
```

有没有办法让这样的规则起作用？谢谢您的帮助！（我试过这种方式，但似乎没有用）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T06:30:41.807

仅适用于其他不太熟悉的读者`VREF`（以[“g3”或 Gitolite V3](http://sitaramc.github.com/gitolite/master-toc.html)介绍）。

[VREF 规则](http://sitaramc.github.com/gitolite/vref.html#vref-fallthru)背后的理念是：

> *   对于以适用于该用户的规则开头的每个 refex，都会触发`VREF/FOO/`对被调用程序的调用`FOO`。`VREF`请注意，如果该规则不适用于该用户，则甚至不会调用该程序。

这就是为什么人们可以定义一个 ' `update`' 钩子，即使该[`update`钩子是由 gitolite 保留的](http://sitaramc.github.com/gitolite/cust.html#hooks)。
一个普通的`update`钩子需要 3 个参数（参考、旧 SHA、新 SHA）。
任何 VREF 都会获得这三个，然后至少再获得 4 个。您的 ' `update`' VREF 应该忽略额外的参数。

> *   **[fallthru](http://foldoc.org/fallthru)**正在考虑成功（即你不会因为没有应用 VREF 而被拒绝在 repo 上执行 git 操作）
>     如果 fallthru 被认为是“失败”，你将被迫添加这样的“成功规则”您在此 repo 中使用的每个 vref，在每种情况下都列出了在该 vref 的上下文中未提及的每个用户

考虑到`update`VREF 程序，您可以添加一个参数，让您的更新脚本识别它在`gitolite-admin`上下文中被调用（并且应该什么都不做）：

```
repo gitolite-admin
-  VREF/update/donothing    =   @all

repo @all
-  VREF/update    =   @all 
```

# c# - Web 应用程序：站点在 IDE 上运行，而不是在公共服务器上运行

> ID：11510057
> 
> 赞同：3
> 
> 时间：2012-07-16T18:12:47.703
> 
> 标签：c#, asp.net, web-applications

我有一个几个月前离开的旧网站，它运行良好，但我决定不将其上传到真实服务器，因为当时我不确定它是否值得。

现在我终于决定了我想要做什么，所以我将网站上传到免费的公共服务器，但是在使用 Visual Studio 2010 启动该网站时出现了一个错误。

这是其中一页的链接：

[http://aspspider.org/thesamy3/MainPages/AluminumPage.aspx](http://aspspider.org/thesamy3/MainPages/AluminumPage.aspx)

您看到错误的地方应该是一个 iFrame，它显示了我使用 Flicker.Net API 从 Flicker 获得的照片库。

任何想法为什么现在会发生这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:17:00.277

> [WebException：无法解析远程名称：'api.flickr.com']

您的虚拟主机不允许您连接到其他服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T18:16:07.633

您的网络服务器是否有防火墙阻止它连接到远程资源？

好像达`api.flickr.com`不到

您可以编写一个测试页面，执行一个简单的测试请求：

```
// Create a new 'Uri' object with the specified string.
Uri myUri =new Uri("http://www.contoso.com");
// Create a new request to the above mentioned URL.    
WebRequest myWebRequest= WebRequest.Create(myUri);
// Assign the response object of 'WebRequest' to a 'WebResponse' variable.
WebResponse myWebResponse= myWebRequest.GetResponse(); 
```

# php - 试图通过 codeigniter 中的另一个变量值从 $this-> 获取值

> ID：11510059
> 
> 赞同：-2
> 
> 时间：2012-07-16T18:12:52.813
> 
> 标签：php, codeigniter, variables

好吧，所以我试图从中获取价值`$this->lang->line('test');`

我得到了另一个名为`$try`的变量，其中包含值`$this->lang->line('test');`。

我可以成功地让它打印出 name `$this->lang->line('test');`，但我不能让它打印出那个变量的值。

尝试使用`eval()`, 或`$$`时，我得到一个`undefined variable`错误。但是我已经通过成功进行了双重检查`echo $this->lang->line('test');`。

那么，有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:59:41.340

这是基于您的评论的答案。

当您调用 时`eval`，它会评估作为 PHP 代码给出的字符串。由于您调用`$newVar = eval("echo $test;");`，该值被`echo`编辑到标准输出。

正如[手册](http://php.net/eval)中关于返回值的说明`eval`，

> **eval()**返回`NULL`，除非在评估代码中调用***return***，在这种情况下，返回传递给***return***的值。如果评估代码中存在解析错误，则**eval()**返回`FALSE`并继续正常执行以下代码。

如果您想从`eval`ed 字符串中捕获值而不是回显它，请替换`echo`为`return`.

例子：

```
$newVar = eval("return $test;");
echo $newVar; 
```

# c# - 使用 AutoMapper 的原因

> ID：11510061
> 
> 赞同：1
> 
> 时间：2012-07-16T18:12:55.130
> 
> 标签：c#, .net, automapper

我想在我们公司开始使用 AutoMapper。我的团队成员没有看到任何好处。当我们可以编写自己的扩展方法来做同样的事情时，我们需要添加抽象的主要主张。

那么我可以提出反对的理由是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T18:27:24.110

我对 Automapper 的两个最大论点：

1.  当您可以依赖经过良好测试的、基于约定的库为您做事时，为什么还要编写自定义的东西呢？

> 是的，您可以编写扩展方法来在属性之间移动数据。但是，为什么我要编写无数的映射线只是为了跨类型传输数据，例如
> 
> `Property1 = original.Property1; Property2 = original.Property2;`
> 
> *特别是*当你做这样的事情时：
> 
> `Property1 = (MyEnum)Enum.Parse(typeof(MyEnum), original.Property1);`
> 
> 它是乱七八糟的管道代码，编写起来很费时间，而且你有更好的时间来做，比如构建有用的功能，来处理这样的事情。AutoMapper 提供了免费完成第一个案例所需的所有约定，以及用于管理更复杂的场景的简单模式，其中您正在减少形状或更改类型。

1.  地图本身很容易测试。

> 同样，您可以编写自己的方法。但是，如果您正确地做事，您将有相应的测试来涵盖您刚刚编写的自定义代码所固有的所有情况。 *或者*，您可以只加载您的地图并询问 AutoMapper 您的映射配置是否正确。

我对 Automapper 的警告论点：

*   如果您开始不得不向您几乎不再依赖配置的映射编写足够多的异常，那么它可能会成为一个泄漏的抽象。（实际上，问题可能在于您的域的设计，而 AutoMapper 只是表明上游问题的第一个约束）。

我并不是说它是映射代码的灵丹妙药（它有它的怪癖），但花在它上面看它是否适合你的解决方案的时间是值得投资的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T18:23:09.127

当您有很多只将一种类型映射到另一种类型的代码时，AutoMapper 很有用。

问问自己这个。什么将花费更少的时间来开发和维护：硬编码映射或设置像 AutoMapper 这样的框架？

以下主题可以帮助您确定自动映射框架是否对您的场景有用：

*   **散装**。有多少行代码将专门用于映射？需要映射多少个实体？10？100？1000？代码行数越多，您将从该框架中受益越多
*   **复杂性**。你的映射有多复杂？都是基本的一对一映射吗？对象是否需要展开或展平？对于复杂的场景，您很可能会受到自动映射框架的限制。
*   **非映射**。您当前的映射代码实际上是否 100% 专用于映射对象？它是否做其他事情，例如解析数据或检查业务规则？映射代码的职责越多，自动映射框架的用处就越少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:32:24.357

事务应用程序的一个常见挑战（针对 3NF 数据库的大量 CrUD 操作）是您经常必须将 3NF 数据库映射到对象模型（即业务对象/类），然后再映射到表示层。数据库将数据存储为元组（行和列），数据通常在应用程序中显示为元组（即网格），但对象模型是一个图形 - 这就像从 2 维（db）到 3（业务逻辑）回到 2（表示为网格）。ORM 映射器有助于将 3NF 转换为对象，但是为了在用户屏幕上表示而扁平化对象需要创建特定于表示的类。

Automapper 非常适合在这样的场景以及许多其他场景中从一种类型（业务对象）映射到另一种（数据传输对象）

# ruby-on-rails - 如何将 Rails 应用程序转换为 gem？

> ID：11510069
> 
> 赞同：7
> 
> 时间：2012-07-16T18:13:37.620
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems

我有一个 ruby​​ on rails 应用程序需要进行 gem 化。珠宝商，帮助创造基本的红宝石。但是，如何将 rails 应用程序打包为 gem？我有一个主应用程序，需要我的 rails 应用程序作为 gem。我无法将它们集成，因为主要的 rails 应用程序将用作管理应用程序来控制较小的应用程序，在其中作为 gems/engines 运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:05:55.157

从 Rails 3.0 开始，任何 Rails 应用程序都是引擎。要将您的应用程序包装到 gem 中，您应该：

1.  使用捆绑器或珠宝商或其他东西创建新宝石。
2.  将您的应用程序代码插入到 gem 的 lib/ 目录中。
3.  您的应用程序的所有类都应该在 MyGem 模块中，因此请在您的类名之前添加 MyGem，例如：Article => MyGem::Article。您的所有控制器、模型等都应使用模块 GemName 命名。
4.  您的文件 lib/my_gem.rb 应包含以下代码：

    ```
    module MyGem
      class Engine < Rails::Engine; end
    end 
    ```

**UPD**

或者如果您将使用可安装的引擎会更好：

```
$ rails plugin new MyGem 
```

它为测试和 gemspec 生成带有虚拟应用程序的可安装引擎。

# visual-c++ - 错误 LNK2019 无法解析 VS2008 的外部符号 - Unity 插件

> ID：11510070
> 
> 赞同：0
> 
> 时间：2012-07-16T18:14:04.663
> 
> 标签：visual-c++, linker, unity3d, kinect, xbox360

我正在尝试让我的 Unity Xbox 插件正常工作。对于不熟悉此过程的人，只需要一个 .cpp 文件以及要在 VC++ 目录选项中定义的库和头文件。但是，每当我进行构建时，我都会收到此错误：

```
error LNK2019: unresolved external symbol "struct _XMMATRIX __cdecl NuiTransformMatrixLevel(struct __vector4)" (?NuiTransformMatrixLevel@@YA?AU_XMMATRIX@@U__vector4@@@Z) referenced in function GetPlaySpaceFrustum    DLLProject.obj  DLLProject 
```

有问题的函数是通过我包含在 .cpp 文件中的 nuiapi.h 调用的。我的理解是，此错误通常发生在未链接库时，但由于 xbox 的所有库都链接在选项菜单的 VC++ 目录中，我认为我不会收到此错误。我应该得到这个错误还有另一个原因吗？

部分代码示例：

```
#ifdef _XBOX
     #include <xtl.h>
     #include <nuiapi.h>
#else
    #define WIN32_LEAN_AND_MEAN
    #include <windows.h>
#endif
#include <stdio.h>

extern "C" __declspec(dllexport)
void TestFunction(float GravX, float GravY, float GravZ, float GravW) {
     XMVECTOR NormalToGravity = {GravX, GravY, GravZ, GravW};
     XMMATRIX MatLevel = NuiTransformMatrixLevel(NormalToGravity); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:24:56.103

现在问题已经解决了。必须在为 Unity 设置开发环境的位置（通过代码）链接有问题的库，并将库添加到链接器的附加依赖项。

# android - 将封面艺术添加到 Android 上下载的 mp3

> ID：11510075
> 
> 赞同：1
> 
> 时间：2012-07-16T18:14:13.517
> 
> 标签：android, mp3, id3, download-manager, id3-tag

如何以编程方式将封面艺术（专辑艺术）添加到下载的 mp3？

我让我的应用程序通过 Android APIS 的 DownloadManager 下载一个 mp3 文件，如下所示：

```
private void startDownload(){
    Uri uri = Uri.parse(BASE_URL+DOWNLOAD+mp3+".mp3");

    filename = title+".mp3";

    Request request = new DownloadManager.Request(uri)
    .setDestinationInExternalPublicDir(MUSIC_PATH, filename);

    DOWNLOAD_MANAGER.enqueue(request);
} 
```

是否可以在下载的 mp3 文件中添加封面，以便手机上的 mp3 播放器在播放歌曲时显示图像？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T14:53:49.913

下载这个 jar 文件[MyID3_for_android](https://sites.google.com/site/eternalsandbox/myid3-for-android)并将其添加到项目的构建路径中。这是如何更改封面的示例代码

```
 File src = new File("filepath");
        MusicMetadataSet src_set = new MyID3().read(src);

        File img = (new File("imagePath"));

        Vector<ImageData> fileList = new Vector<ImageData>();
        ImageData data = new ImageData(readFile(img), "", "", 3);
        fileList.add(data);

        MusicMetadata metadata =  (MusicMetadata) src_set.getSimplified();
        metadata.setPictureList(fileList);

        File dst = new File("destinationPath");

        new MyID3().write(src, dst, src_set, metadata); 
```

您还需要[Jakarta Regex jar](http://archive.apache.org/dist/jakarta/regexp/jakarta-regexp-1.5.zip)

readFile 只是一个从 File 中获取 byte[] 的函数

```
public static byte[] readFile (File file) throws IOException {
    // Open file
    RandomAccessFile f = new RandomAccessFile(file, "r");

    try {
        // Get and check length
        long longlength = f.length();
        int length = (int) longlength;
        if (length != longlength) throw new IOException("File size >= 2 GB");

        // Read file and return data
        byte[] data = new byte[length];
        f.readFully(data);
        return data;
    }
    finally {
        f.close();
    }
} 
```

从 stackOverflow 得到它，不知道从谁:)

# jersey - 提供者媒体类型匹配？

> ID：11510079
> 
> 赞同：0
> 
> 时间：2012-07-16T18:14:23.440
> 
> 标签：jersey, jax-rs

任何想法如何匹配@Provider Produces/Consumes 类型？

我有一个生产和使用 Lua 的提供程序，我还希望能够使用内置提供程序使用 XML 或 JSON，并从我的提供程序使用 Lua 进行回复。

我似乎无法在我的 Lua Provider 中想出正确的 Produces/Consumes 值组合来实现这一点，但它似乎应该是可能的。

帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T16:37:36.680

应用程序输入错误，我们已经找到并修复了它。

# c# - 更改日期选择器的格式

> ID：11510081
> 
> 赞同：0
> 
> 时间：2012-07-16T18:14:40.960
> 
> 标签：c#, datepicker

我的应用程序中有一个日期选择器 ( `DateTimePicker`)。目前，当用户选择所需的日期时，输出结果如下：

代码：

```
private void btnEnter_Click(object sender, EventArgs e)
{
    string date = startDatePicker.Value.ToString();
    dateStart.Text = date;
} 
```

输出（dateStart 变成什么）

```
07/16/2012 1:18 PM 
```

但是，我需要像这样格式化日期：

```
2012/07/16 
```

另外，我不需要时间出现。有没有办法更改日期格式并阻止时间显示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:16:38.990

使用自定义格式

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.customformat.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.customformat.aspx)

# css - 带导航栏的 CSS 全高两列布局

> ID：11510085
> 
> 赞同：5
> 
> 时间：2012-07-16T18:14:49.547
> 
> 标签：css, twitter-bootstrap

我有一个包含两列的布局，一个侧边栏和主要内容，需要拉伸浏览器的**高度**。所以，`100%`减去我的 Twitter Bootstrap`navbar`最初`40px`的高度。`40px`如果您在狭窄的浏览器（例如在移动设备上）查看页面，这将通过 Twitter Bootstrap CSS 进行更改。新高度基于 中的链接数`navbar`，因此它是动态的。

我知道我可以想出一些 JavaScript 来调整`top`属性以“缩小”列的高度。但如果可以的话，我真的很想用 CSS 来做。

请注意，我不能通过更改`z-index`.

在此处查看实际模型：http: [//jsfiddle.net/flackend/mu4Ey/3/](http://jsfiddle.net/flackend/mu4Ey/3/)

**布局**

```
+ - - - - - - - - - - - - - - - - - - - - +
| navbar                                  |
+ - - - + - - - - - - - - - - - - - - - - +
|       |                                 |
|< 20% >|<-- 80% ------------------------>|
|       |                                 |
|       | Google Maps API map contained   |
|       | here.                           |
|       |                                 |
|       |                                 |
|       |                                 |
|       |                                 |
+ - - - + - - - - - - - - - - - - - - - - + 
```

**CSS**

```
.sidebar, .content {
    position: absolute;
    top: 40px;
    bottom: 0;
}

.sidebar {
    left: 0;
    right: 80%;
}

.content {
    left: 20%;
    right: 0;
}​ 
```

谢谢你的帮助！

**编辑**

在此处查看 Twitter 引导程序的示例：http `navbar`: [//jsfiddle.net/flackend/MDZaG/](http://jsfiddle.net/flackend/MDZaG/)

增加浏览器或“结果”框架的大小以查看未折叠的`navbar`.

另一个示例和文档：http: [//twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)

**编辑 2**

两列的内容不会影响列的高度；它们总是`100%`减去 的高度`navbar`：

![例子](../Images/cd4004096794d5eadc9bf048554fb5ef.png)

**编辑 3**

我更改了上面的 CSS 和 jsfiddle 链接，以便定位是`absolute`为了防止混淆。

**最后编辑：选择的解决方案**

由于似乎没有 CSS3 之外的 CSS 解决方案`calc`，我写了一些 js 来解决这个问题......

在这里看到它：http: [//jsfiddle.net/flackend/mu4Ey/5/](http://jsfiddle.net/flackend/mu4Ey/5/)

我搜索了 Twitter Bootstrap js 源代码，发现他们正在计算新的`navbar`高度`scrollHeight`。`top`我的 js 做同样的事情，并且稍微滞后地为CSS 属性设置动画以隐藏正文。这是一个可怕的解决方案，因为 Twitter Bootstrap 可能会改变动画速度并破坏我的 js。

我*应该*做的是找出如何定位支持 CSS3 的浏览器`calc`并让他们使用它并让所有其他浏览器使用 js。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:09:09.200

I don't think this is possible. Not without using css3 features which do not have the proper browser support yet ('flexbox', for example, might be able to achieve this - I'm not really sure as I haven't yet played enough with it. Again, I'm waiting for a better support).

That being said, what I would suggest would be to use media queries. Figure out where the layout breaks and add one around that point where you'd increase the height and adjust the top value for the content and sidebar divs. A better solution, imo, still using media queries, would be to put your nav inside a select element (or your own made dropdown) when you get below a certain width. That way you could keep the 'top' and 'height' unchanged.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:13:34.643

If they will always be 100% height, then create 3 absolutely positioned divs, like this:

[http://jsfiddle.net/ywySt/](http://jsfiddle.net/ywySt/)

# scala - Scala 在使用元组列表时混淆编译时错误

> ID：11510098
> 
> 赞同：0
> 
> 时间：2012-07-16T18:15:29.373
> 
> 标签：scala, functional-programming

我正在研究[99 个 Scala 问题](http://aperiodic.net/phil/scala/s-99/)以了解更多 Scala。我在 P12 上并为该问题编写了以下解决方案。

```
def decode(l : List[Tuple2[Int,Symbol]]) : List[Symbol] 
            = l foldLeft(List[Symbol]()) { (symbols:List[Symbol], e:Tuple2[Int, Symbol]) => symbols ::: List(e._2) } 
```

我收到以下编译器错误。

```
 error: type mismatch;
 found   : (List[Symbol], (Int, Symbol)) => List[Symbol]
 required: Int
                        = l foldLeft(List[Symbol]()) { (symbols:List[Symbol], e:
Tuple2[Int, Symbol]) => symbols ::: List(e._2) } 
```

是什么导致编译器错误？

Scala 版本：Scala 代码运行器版本 2.10.0-M3 -- 版权所有 2002-2011，LAMP/EPFL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:22:15.657

看起来这是您使用中缀 foldLeft 调用，您只需将其更改为：

```
def decode(l : List[Tuple2[Int,Symbol]]) : List[Symbol] 
        = l.foldLeft(List[Symbol]()) { (symbols:List[Symbol], e:Tuple2[Int, Symbol]) => symbols ::: List(e._2) } 
```

注意“l.foldLeft”而不是“l foldLeft”，我怀疑编译器不能完全确定什么是什么的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T21:14:35.637

解决方案已经给出，但我认为需要更多解释：

如果您的表达式位于操作符位置，您只能留下括号和点。如果表达式的形式为 ，则表达式处于操作符位置`<object> <method> <param>`。对于包含多个显式参数列表的方法，情况并非如此`foldLeft`。因此，您必须编写`<list>.foldLeft(<init>)(<function>)`. 尽管如此，Scala 有一个特殊的规则来解决这个问题——你可以插入另一组括号：`(<list> foldLeft <init>) (<function>)`. 此外，还有另一种称为 的方法`/:`，它是 的同义词`foldLeft`，定义为`def /:[B](z: B)(op: (B, A) => B): B = foldLeft(z)(op)`。它允许您编写`(<init> /: <list>) (<function>)`. 也许你刚刚注意到这里第一个括号之间的符号被交换了——这是因为每个以冒号结尾的方法都是右关联的而不是左关联的（[进一步解释](https://stackoverflow.com/questions/2827293/scala-operator-how-it-works)）。

现在我想给你一些进一步重构的提示：

*   `Tuple2[A, B]`可以写成`(A, B)`
*   您不必编写所有类型。其中一些可以 - 并且应该 - 留下来清理你的代码（我知道你是一个初学者并且想写这个。只是作为一个提示......）。但不要离开
*   列表大多被命名为`xs`或`ys`，因为这意味着“很多 x”或“很多 y”。这不是很重要但很常见
*   您可以对参数进行模式匹配以将它们提取为易于阅读的名称：`... { case (a, (b,c)) => ...}`
*   您的代码在声明任务时不起作用。你需要类似的东西`List.fill(<n>)(<elem>)`
*   不要将元素附加到列表中，这是`O(n)`. `:::`隐含地是一个追加操作 - 查看[源代码](https://github.com/scala/scala/blob/v2.9.2/src/library/scala/collection/immutable/List.scala#L107)。
*   对于这个任务`foldLeft`来说不是最好的解决方案。`foldRight`或者同义词`:\`可能更有效，因为该`:::`操作需要更少的元素来复制。但我更喜欢`flatMap`（见下文），这是一个`map+flatten`
    *   您可以使用 for-comprehension 来解决这个问题，这通常很容易阅读。有关如何在内部实现理解的更多信息，请参阅[此内容。](https://stackoverflow.com/a/1059501/465304)

总而言之，示例解决方案：

```
object Test extends App {
  def decode1(l: List[Tuple2[Int, Symbol]]): List[Symbol] =
    l.foldLeft(List[Symbol]()) { (symbols: List[Symbol], e: Tuple2[Int, Symbol]) => symbols ::: List.fill(e._1)(e._2) }

  def decode2(xs: List[(Int, Symbol)]): List[Symbol] =
    (xs foldLeft List.empty[Symbol]) { case (xs, (n, s)) => xs ::: List.fill(n)(s) }

  def decode3(xs: List[(Int, Symbol)]): List[Symbol] =
    (xs foldRight List.empty[Symbol]) { case ((n, s), xs) => List.fill(n)(s) ::: xs }

  def decode4(xs: List[(Int, Symbol)]): List[Symbol] =
    (List.empty[Symbol] /: xs) { case (xs, (n, s)) => xs ::: List.fill(n)(s) }

  def decode5(xs: List[(Int, Symbol)]): List[Symbol] =
    xs flatMap { case (n, s) => List.fill(n)(s) }

  def decode6(xs: List[(Int, Symbol)]): List[Symbol] =
    for {
      (n, s) <- xs
      ys <- List.fill(n)(s)
    } yield ys

  val xs = List((4, 'a), (1, 'b), (2, 'c), (2, 'a), (1, 'd), (4, 'e))
  val ys = List('a, 'a, 'a, 'a, 'b, 'c, 'c, 'a, 'a, 'd, 'e, 'e, 'e, 'e)

  println("start testing")

  val tests = List[List[(Int, Symbol)] => List[Symbol]](decode1, decode2, decode3, decode4, decode5, decode6)

  for (t <- tests)
    assert(t(xs) == ys)

  println("finished")
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:27:02.347

`foldLeft`如果您通过 using调用显式`l.foldLeft`，则错误消失：

```
def decode(l: List[Tuple2[Int,Symbol]]): List[Symbol] =
  l.foldLeft(List[Symbol]()){(symbols:List[Symbol], e:Tuple2[Int, Symbol]) =>
      symbols ::: List(e._2)} 
```

[查看这个问题](https://stackoverflow.com/questions/1181533/what-are-the-precise-rules-for-when-you-can-omit-parenthesis-dots-braces-f)的第一个答案，以获得对 Scala 调用语法的非常详细的解释，该语法也涵盖了您的情况。

# browser - 如何查看当前浏览器版本

> ID：11510101
> 
> 赞同：-1
> 
> 时间：2012-07-16T18:15:37.560
> 
> 标签：browser

我如何从下面的字符串中知道使用的浏览器。

Mozilla/4.0（兼容；MSIE 8.0；Windows NT 5.1；Trident/4.0；.NET CLR 1.1.4322；.NET CLR 2.0.50727；.NET CLR 3.0.4506.2152；.NET4.0C；.NET4.0E；MS- RTC LM 8)

提前感谢那些考虑这个问题的人。

问候戈哈尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:19:14.193

`MSIE 8.0`在 XP ( ) 上运行的Microsoft Internet Explorer 8 ( `Windows NT 5.1`)。关于 IE8 用户代理的[IE 博客](http://blogs.msdn.com/b/ie/archive/2009/01/09/the-internet-explorer-8-user-agent-string-updated-edition.aspx)

# wix - 安装程序条目在 Wix 的添加/删除程序中不可用

> ID：11510104
> 
> 赞同：0
> 
> 时间：2012-07-16T18:15:43.360
> 
> 标签：wix

我正在使用 wix 创建安装程序。我在产品中使用以下代码。

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
<Product Id="{98356803-6759-78F5-458F-378295D23DAF}" Name="Test Install" UpgradeCode="{345D4770-545D-4A53-BA07-EF52401F0CB4}" Language="1033" Version="1.1.1.1" Manufacturer="Installer. Inc">
    <Package Description="Sample Installer" Comments="Test Install" Manufacturer="Installer. Inc" InstallerVersion="200" Compressed="yes" /> 
```

我正在使用以下属性。

```
 <Property Id="ARPNOMODIFY" Value="1" />
    <Property Id="ARPNOREPAIR" Value="1" />
    <Property Id="ARPNOREMOVE" Value="1" />
    <Property Id="ARPSYSTEMCOMPONENT" Value="1" /> 
```

但我的安装程序条目在程序和功能 (Windows 7) 中不可用。有什么我错过的吗？请让我知道您需要的任何其他详细信息。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T18:46:04.197

它不存在，因为您将[ARPSYSTEMCOMPONENT](http://msdn.microsoft.com/en-us/library/windows/desktop/aa367750%28v=vs.85%29.aspx)属性设置为 1。

根据 MSDN 设置此属性：

> **使用命令行或转换将ARPSYSTEMCOMPONENT**属性设置为 1 可防止应用程序显示在**控制面板的****添加或删除程序列表**中。

# python - 文本表格模型，允许在不编辑代码的情况下添加/删除列

> ID：11510106
> 
> 赞同：-3
> 
> 时间：2012-07-16T18:15:56.910
> 
> 标签：python, django

我想创建一个模型，允许用户在表表示中存储信息。我想要实现的主要目标是允许手动更改表的可能性，例如删除/添加列，而无需编辑代码。

我不知道如何为此目的创建一个优雅的模型。能否请你帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:04:55.200

您不应该制作某种即时更改表的系统。这听起来像是一条疯狂的道路......相反，您可以使用您需要的数据类型对表格布局进行建模。

例如：

```
INTEGER, FLOAT, TEXT = range(3)

class Table(models.Model):
    columns = models.ManyToManyField('TableColumn')

class TableColumn(models.Model):
    name = ...
    data_type = models.SmallIntegerField(choices=[(INTEGER, 'Integer'), ...])

class TableRow(models.Model):
    order = ...
    column = models.ForeignKey('TableColumn')
    value_float = ...
    value_text = ...
    value_integer = ...

    def get_value(self):
        if self.column.data_type == INTEGER:
            return self.value_integer 
```

# java - 使用 httpclient 下载 JSON

> ID：11510110
> 
> 赞同：1
> 
> 时间：2012-07-16T18:16:08.240
> 
> 标签：java, json, caching, httpclient, threadpool

我想定期从我的应用程序中下载 JSON 提要，以便使用 GSON 或 Jackson 进行解析。我查看了以下 httpclient 示例[http://hc.apache.org/httpcomponents-client-ga/examples.html](http://hc.apache.org/httpcomponents-client-ga/examples.html) 我有几个问题：

1.  我想为其添加缓存我使用了[http://hc.apache.org/httpcomponents-client-ga/tutorial/html/caching.html](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/caching.html)中描述的 CachingHttpClient 。并在循环中获取 5 次 URL 进行测试。但是，每次我得到一个缓存未命中。我想知道我会做错什么。

2.  我看到了多线程请求执行的示例，其中为每个 URL 创建了一个线程。这是推荐的方式吗？我更多地考虑线程池，其中可以将 x url 分配给一个固定的池，比如 10 个线程。

3.  可能，一旦我对上述两个有了清晰的认识，我就可以实现一个缓存的线程池 httpclient。

谢谢，阿迪亚

# python - 从子包访问共享模块

> ID：11510119
> 
> 赞同：1
> 
> 时间：2012-07-16T18:16:59.037
> 
> 标签：python

我在我的项目中使用内部导入时遇到了困难。这是我的项目的部分树结构：

```
app
  |- Gui.py
  |- Main.py
  |- logger.py
  |- config.py
  |- WebParser (package)
        |- __init__.py
        |- LinksGrabber.py
        |- LyricsGrabber.py
        |- ImagesGrabber.py
  |- (Many other packages...) 
```

`logger.py`和模块在每个包的`config.py`模块中都是必需的，并且是独立的（仅使用内置模块）。从包内部访问这些模块很棘手。

这就是我尝试实现它的方式，用于启用配置访问和日志记录功能`WebParser\LinksGrabber.py`：

```
# WebParser\__init__.py:
sys.path.append('..') # for outside-package modules
import config
from logger import log

# WebParser\LinksGrabber.py:
import WebParser
config = WebParser.config
log = WebParser.log 
```

问题：

*   这有代码气味。我敢打赌有更好的方法来实现这种行为。
*   我想立即调用`import WebParser`并使用`WebParser.LinksGrabber`and `WebParser.LyricsGrabber`，而不是隐式导入它们。这可以通过导入内部的模块来完成`__init__.py`，但这是不可能的，因为每个包的模块都会导入包本身，并且会发出递归导入。

您能否提出更好的实现或不同的代码设计？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:25:09.810

你应该`app`通过给它一个`__init__.py`文件来制作一个包。python 相对导入系统仅适用*于 packages*。然后在您的 WebParser 模块中，您可以执行`from .. import config`,`from .. import Gui`等。

至于从其中的包中导入 WebPackage，这有点代码味道。为什么你需要这样做？例如，使用相对导入，您可以`from . import LinksGrabber`在 ImagesGrabber 等内部访问您需要的内容。如果许多子模块都需要属于 WebParser 包的一部分的函数，则应将它们拉出到 WebParser 中的单独模块中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:31:36.170

我会将整个外部（app）目录制作成一个 python 包（带有 __ init__.py）。

```
app_files
  |- ***setup.py***
  |- app
    |- ***__init__.py***
    |- Gui.py
    |- Main.py
    |- logger.py
    |- config.py
    |- WebParser (package)
          |- __init__.py
          |- LinksGrabber.py
          |- LyricsGrabber.py
          |- ImagesGrabber.py
    |- (Many other packages...) 
```

setup.py 会像这样简单：

```
#!/usr/bin/env python

from distutils.core import setup

setup(name='app',
      version='1.0',
      description='My app',
      author='Greg Ward',
      packages=['app'],
     ) 
```

然后你可以运行`python setup.py install`, 将“app”永久安装到 python 路径中。在我看来，这是最好的方法，而不是到处求助于 sys.path 黑客。

然后，从 python 中的任何地方，您都可以从完整的虚线路径中引用您的任何文件

IE

```
import app.logger
import app.config
import app.WebParser 
```

使 LinksGrabber 和 LyricsGrabber 仅可从导入 app.WebParser 使用的唯一方法是从 app.WebParser.__ init__ 导入它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:22:48.213

看来您可以在这里使用[相对导入](http://docs.python.org/tutorial/modules.html#intra-package-references)：

```
from .. import config
from ..logger import log 
```

# javascript - 如何通过 URI 引用外部二进制文件？

> ID：11510122
> 
> 赞同：0
> 
> 时间：2012-07-16T18:17:01.643
> 
> 标签：javascript, thunderbird, thunderbird-addon

我有一个 Thunderbird 扩展，它使用外部可执行文件来改变消息体。目前我做了一个黑客工作，只是把这个可执行文件放进去`/tmp/someBinary`，然后像这样调用它：

```
var exe = FileUtils.File("/tmp/someBinary");
var proc = Components.classes["@mozilla.org/process/util;1"]
                     .createInstance(Components.interfaces.nsIProcess);
proc.init(exe);
var args = [msgBody.path];
proc.run(true, args, args.length); 
```

这显然很愚蠢，最好通过 URI 调用它并将可执行文件与应用程序捆绑在一起。可悲的是，我有限的 JS 意味着我只想出了以下内容：

```
var URL = ios.newURI("chrome://myExtension/content/someBinary",null,null);
var exe = URL.QueryInterface(Components.interfaces.nsIFileURL).file; 
```

但这并不完全正确。有没有正常的方法来完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T10:16:16.660

您需要向 chrome 注册表询问您在那里的 URL 解析为：

```
var chromeRegistry = Components.classes["@mozilla.org/chrome/chrome-registry;1"]
                               .getService(Components.interfaces.nsIChromeRegistry);
var URL = ios.newURI("chrome://myExtension/content/someBinary", null, null);
URL = chromeRegistry.convertChromeURL(URL);
var exe = null;
if (URL instanceof Components.interfaces.nsIFileURL)
  exe = URL.file; 
```

请注意，`chrome://`URL 不一定会解析为`file://`URL。通常，扩展安装为打包的 XPI 文件，并且只会获得指向此存档中文件的链接，而不是操作系统可以执行的内容。因此，您需要在文件中指定[`<em:unpack>`标志](https://developer.mozilla.org/en/Install_Manifests#unpack)`install.rdf`。

这种方法很简单，但会降低启动性能（扩展管理器默认情况下不会解包扩展，这是有原因的）。因此，更好的解决方案可能是在您第一次需要时将可执行文件复制到临时目录中。

# cakephp - 如何使用 CakePHP 正确处理时间戳？

> ID：11510124
> 
> 赞同：1
> 
> 时间：2012-07-16T18:17:06.987
> 
> 标签：cakephp, datetime, timezone, timestamp, cakephp-2.0

请随意只回答部分问题，无论您可能有什么答案。

使用新的 2.2 版 cake 更好地支持时区，这是完美的时机，因为我正在开发一个非常“时间敏感”的应用程序。尽管尽我所能，但我根本无法让一切正常工作。所以这是我的问题：

日期时间条目（认为创建/修改）是否应该存储在 UTC 中？如果是这样，确保蛋糕使用 UTC 的最有效方法是什么？

时间戳（精确的时刻）应该存储为 int 还是 mysql 中的时间戳？

使用新蛋糕，我如何自动将 UTC int/timestamps 转换为默认站点时区？用户时区（存储在他们的用户元组中）？

如果日期时间（创建/修改）时间存储为 UTC，如何使用 cake 将它们转换为默认站点时区？用户时区？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T04:46:09.160

1.  如果您想为您的站点用户自定义时间设置，那么您应该使用全局时间设置，即 UTC 格式。以 UTC 格式保存到数据库中。在您的 app/Config/core.php 中，您将找到以下行。

    ```
    date_default_timezone_set('UTC');  // at line 232 
    ```

    因此，您可以确认 cake 将使用 UTC 时间格式，同时将时间保存到数据库中。

2.  以下项目总结了 MySQL 4.1.2 之前的 TIMESTAMP 初始化和更新属性：

    如果该列设置为 NULL 或根本未指定，则表行中的第一个 TIMESTAMP 列会在创建记录时自动设置为当前时间戳。

    当行中任何其他列的值发生更改时，表行中的第一个 TIMESTAMP 列会自动更新为当前时间戳，除非显式地为 TIMESTAMP 列分配除 NULL 以外的值。

    如果在创建表时为第一个 TIMESTAMP 列指定了 DEFAULT 值，它会被静默忽略。

    表中的其他 TIMESTAMP 列可以通过为它们分配 NULL 来设置为当前 TIMESTAMP，但它们不会自动更新。

我认为，如果您不想自动更改时间戳，最好将时间戳保存在整数字段中。

# c++ - 如何使用 dynamic_cast 运算符识别失败的强制转换？

> ID：11510128
> 
> 赞同：21
> 
> 时间：2012-07-16T18:17:31.373
> 
> 标签：c++, pointers, reference, dynamic-cast

`Scott Meyer`在他的书中`Effective C++`说`dynamic_cast`用于执行向下或跨继承层次结构的安全强制转换。也就是说，您使用 dynamic_cast 将指向基类对象的指针或引用转换为指向派生或同级基类对象的指针或引用，这样您就可以确定转换是否成功。

失败的转换由空指针（转换指针时）或异常（转换引用时）指示。

我想得到两个代码片段，在可以指示转换指针和转换引用的情况下显示失败的转换。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-16T18:22:10.540

对于指针，这是一个简单的空检查：

```
A* a = new A();
B* b = dynamic_cast<B*>(a);

if (b == NULL)
{
    // Cast failed
} 
```

作为参考，您可以捕获：

```
try {
    SomeType &item = dynamic_cast<SomeType&>(obj);
}
catch(const std::bad_cast& e) {
    // Cast failed
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T18:36:45.947

根据 OP 的评论（“我不明白 Scott 提到的演员阵容如何失败。”），这里真正的问题实际上是：“怎么会`dynamic_cast`失败？”

失败的时间是目标类型与对象的动态类型不匹配。举个简单的例子：

```
struct A {
   virtual ~A() {}
};

class B : public A {};

int main() { 
    A *a = new A;

    B *b = dynamic_cast<B *>(a);    // should fail
    if (b == NULL)
        std::cout << "First cast failed.\n";

    A *c = new B;
    b = dynamic_cast<B *>(c);       // should succeed
    if (b == NULL)
        std::cout << "Second cast failed.\n";
    return 0;
} 
```

这里虽然`a` *可以*指向一个类型的对象`B`，但它实际上*确实*指向了一个类型的对象`A`。当我们尝试做一个 dynamic_cast 让它指向 a`B`时，它失败了。在第二次尝试中，我们再次有一个指针，它不仅可以*而且确实*指向 type 的对象`B`。既然这样做了，那么`B *`在这种情况下，dynamic_cast 就会成功。

对于参考案例，基本情况并没有改变（很多），只是`a`,`b`并`c`成为引用而不是指针，我们通过捕获异常来记录失败（@ReedCopsey 已经很好地证明了这一点，我认为我没有任何要添加的新内容）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-16T18:38:17.150

这是一个完整的示例，显示了如何`dynamic_cast`无法生成指针。

```
class A
{
public:
    virtual void Foo();
};

class B: public A
{
};

class C: public A
{
};

void test()
{
    A a;
    B b;
    A* pA = &b;
    B* pB = dynamic_cast<B*>(pA);  // this works OK, returns the expected pointer
    C* pC = dynamic_cast<C*>(pA);  // this returns NULL because B isn't a C
} 
```

在现实世界中，您将尝试投射并非如此直接创建的指针，也许它们来自一个`vector`示例。

# tomcat - Alfresco 不在 tomcat 中启动

> ID：11510131
> 
> 赞同：1
> 
> 时间：2012-07-16T18:17:39.187
> 
> 标签：tomcat, tomcat7, alfresco

我是 alfresco 的新手，我正在尝试运行它，但我遇到了一个问题。在管理器应用程序页面的 tomcat 中，我有我的 alfresco 应用程序但没有运行（运行 = false）。如果我尝试启动 tomcat，则返回错误

“失败 - 无法启动上下文路径 /alfresco 的应用程序”

我使用 kubuntu 11.10、tomcat 7 和 alfresco 4

有人可以帮助我吗？

这是 catalina 日志[http://pastebin.com/NEPfRt8B](http://pastebin.com/NEPfRt8B)

编辑：

将 postgree 驱动程序添加到 lib 目录后

[http://pastebin.com/EzkpZPyE](http://pastebin.com/EzkpZPyE)

编辑2：

谢谢大家！我已经做到了。

对于其他有相同错误的用户，我建议使用 java-openjdk 而不是 java-sun

@drndivoje是的，它给了我这个错误，因为后台有一个java进程，我需要在安装时停止它，只要我想重新启动tomcat服务器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:58:55.840

*无法加载 JDBC 驱动程序类“org.postgresql.Driver”*

可能意味着您在 Tomcat 的 lib 子目录中缺少 Postgress JDBC 驱动程序。

如果您还没有这样做，请按照[这些](http://docs.alfresco.com/4.0/index.jsp?topic=/com.alfresco.enterprise.doc/tasks/postgresql-config.html)说明如何使用 PostgreSQL 配置 Alfresco 4

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T17:17:13.537

Alfresco 使用端口 50500 进行 RMI。该端口已在您的盒子上使用。您可以按照 Alfresco wiki [http://wiki.alfresco.com/wiki/Port_numbers的说明轻松更改 RMI 端口号](http://wiki.alfresco.com/wiki/Port_numbers)

第二种解决方案是手动终止该进程（不建议用于生产盒，但对于本地开发环境来说更容易做到）。用途：`netstat -tulpn | grep 50500`查找在 50500 端口上运行的进程。如果它是 RMI（在你的机器上最后一次 alfresco 重启后可能没有被杀死），开火 : `kill <pid>`。

希望它对你有用。

# javascript - 为什么 JavaScript 函数会因某些参数名称而失败？

> ID：11510133
> 
> 赞同：1
> 
> 时间：2012-07-16T18:17:42.047
> 
> 标签：javascript, jquery

下面的 JavaScript 函数应该进行一个简单的 JQuery 调用来加载页面并设置一个类：

```
function Lp(page,class) {
    $("#result").load(page);
    $('#nav').attr('class',class);
} 
```

然而，直到我凭直觉更改了第二个参数的名称，它才起作用：

```
function Lp(page,hilite) {
    $("#result").load(page);
    $('#nav').attr('class',hilite);
} 
```

当然参数名称是任意的，还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:18:43.723

`class`是 JavaScript 中的[保留关键字](https://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words)。这就是为什么。

# android - 如何解析此 url 以将其正确设置为 imageview 的源？

> ID：11510138
> 
> 赞同：1
> 
> 时间：2012-07-16T18:17:56.383
> 
> 标签：android, imageview

如何解析这个网址

```
http://ioe.edu.np/exam/notices/8560Result%20Diploma%20I_I.jpg 
```

正确，以便它可以用作 imageview 的源。我尝试使用 Uri.encode() 对其进行编码，但这没有帮助。

下面是我指的是从 url 加载图像的代码。从[Android 获得，在与 ImageView 的图像相同的 URL 处制作图像](https://stackoverflow.com/questions/3118691/android-make-an-image-at-a-url-equal-to-imageviews-image)

```
public class MainActivity extends Activity {

//  String imageUrl1 = "http://java.sogeti.nl/JavaBlog/wp-content/uploads/2009/04/android_icon_256.png";

String imageUrl = Uri.encode("http://ioe.edu.np/exam/notices/8560Result Diploma I_I.jpg");

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    try {
        ImageView i = (ImageView) findViewById(R.id.imageView1);
        Bitmap bitmap = BitmapFactory.decodeStream((InputStream) new URL(
                imageUrl).getContent());
        i.setImageBitmap(bitmap);
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

}

} 
```

请帮助我，并注意我无法控制图像文件的名称，所以我必须想办法让它在图像视图中正确加载。如果我用 imageUrl1 替换 imageUrl，那么图像会加载。但是对于 imageUrl，将空间编码为 html 实体似乎是个问题。请帮我解决一下这个。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:27:32.113

利用

```
String imageUrl ="http://ioe.edu.np/exam/notices/8560Result Diploma I_I.jpg";
    imageUrl =imageUrl .replaceAll(" ", "%20"); 
```

示例代码

```
String imageUrl ="http://ioe.edu.np/exam/notices/8560Result Diploma I_I.jpg";
    imageUrl =imageUrl .replaceAll(" ", "%20");
    try {
        Bitmap bitmap = BitmapFactory.decodeStream((InputStream) new URL(
                imageUrl).getContent());

        ImageView im=new ImageView(this);
        im.setImageBitmap(bitmap);
        setContentView(im);
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:26:50.703

这段代码适用于我的情况，

```
ImageView i = (ImageView) findViewById(R.id.imageView1);

try {
        URL url = new URL("http://ioe.edu.np/exam/notices/8560Result%20Diploma%20I_I.jpg");
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setDoInput(true);
        connection.connect();
        InputStream input = connection.getInputStream();
        Bitmap myBitmap = BitmapFactory.decodeStream(input);
        i.setImageBitmap(myBitmap);
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

还要在清单文件中添加权限，

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

**编辑：**

你也可以使用`UrlEncoder`.

```
String urlString = URLEncoder.encode("http://ioe.edu.np/exam/notices/8560Result Diploma I_I.jpg");
url = new URL(urlString); 
```

# php - 使用 PHP PDO 运行“显示从属状态”

> ID：11510140
> 
> 赞同：6
> 
> 时间：2012-07-16T18:18:04.537
> 
> 标签：php, mysql, pdo, master-slave

我正在尝试使用 PHP 的 PDO 实现来获取我的 MySQL 服务器的从属状态。运行`fetchAll()`返回一个空数组。

```
// DB IP, name, username, and password are fake here. I can connect.
$db = new PDO('mysql:host=192.168.0.0;dbname=production', 'username', 'password');
$result = $db->query("SHOW SLAVE STATUS");
$result->execute();

if ($result != false)
{
    $slave = $result->fetchAll(PDO::FETCH_ASSOC);
} 
```

我也尝试删除`->execute()`呼叫，但结果相同。我在这里遗漏了一些完全明显的东西吗？我查看了 PDO::query 文档，并没有太大帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:29:02.807

您是否有权执行查询？

尝试：

```
$db = new PDO('mysql:host=192.168.0.0;dbname=production', 'username', 'password');

$result = $db->query("SHOW STATUS");

if (!$result) {
    echo $db->errorInfo()[2]; // php 5.4
} else {
    foreach($result->fetchAll() as $row) {
        var_dump($row);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:27:45.203

这实际上是由于服务器上的权限问题。我错误地设置了我的复制用户，因此复制本身甚至无法正常工作。

# javascript - jQuery 找不到元素或其属性

> ID：11510142
> 
> 赞同：2
> 
> 时间：2012-07-16T18:18:12.117
> 
> 标签：javascript, jquery, getelementbyid

我有这个：

```
<h1 id="test" class="test"> 
```

在脚本部分中：

```
alert($('#test').id)
alert($('.test').id) 
```

jQuery 肯定已加载。但我在警告框中得到了*未定义*的 - 两次。如果我使用常规的*getElementById*，它可以工作并显示*test*。

到底怎么了（我）

这是一个例子[http://jsfiddle.net/tF6bd/](http://jsfiddle.net/tF6bd/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:20:32.637

改变：

```
alert($('#test').id) 
```

到：

```
alert($('#test').attr('id')) 
```

或者：

```
alert($('#test')[0].id) 
```

对于 jQuery 对象，您应该使用`attr()`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:38:18.057

可以使用`attr`or `prop`，不同的是如果没有设置属性则`attr`返回。`undefined`

**示例**：
`alert($('test').attr('id'));`
`alert($('test').prop('id'));`

**演示**：

*   [属性](http://jsfiddle.net/enZbG/1/)
*   [支柱](http://jsfiddle.net/enZbG/)

**参考资料**：

*   [属性](http://api.jquery.com/attr/)
*   [支柱](http://api.jquery.com/prop/)

# jquery - 事件的两个“或”条件？

> ID：11510144
> 
> 赞同：2
> 
> 时间：2012-07-16T18:18:13.203
> 
> 标签：jquery, button, click, radio, mouseup

小提琴：http: [//jsfiddle.net/TKWzH/8/](http://jsfiddle.net/TKWzH/8/)

“Test Pop”是项目的当前功能。“Test Pop 2”是我希望我的脚本发挥的作用。然而，实际的脚本在点击执行方面比仅仅关闭弹出窗口有更多的功能。

有没有办法将 on enter 和 on mouseup 命令组合成一行？

```
$("#popup2 label").on('keyup || mouseup', function (event) {
    $('#popup2').css('display', 'none');
}); 
```

类似的东西就是我正在寻找的东西，但我希望这个键只能用于 enterkey keyup。正如所写，它发生在任何键上。

我试图这样做的原因是因为我想让表单键盘可以访问。从小提琴中可以看出，如果您使用键盘在 Test Pop 中导航，则必须在选择单选按钮后重新打开对话框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:19:13.387

只需使用一个空间。

```
$("#popup2 label").on('keyup mouseup', function (e) {
    if (e.type == 'keyup' && e.which != 13) return;
    $('#popup2').css('display', 'none');
}); 
```

从[文档](http://api.jquery.com/on/)：

> ```
>  .on( events [, selector] [, data], handler(eventObject) ) 
> ```
> 
> **events**一种或多种以*空格分隔的*事件类型和可选的命名空间，例如“click”或“keydown.myPlugin”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:28:41.100

```
$("#popup2 label").on('keyup mouseup', function (e) {
    if (e.type==='keyup') { //key was pressed
        var code = (e.keyCode ? e.keyCode : e.which);
        if(code == 13) { //Enter was pressed
            //Do something
            $('#popup2').css('display', 'none');
        }
    }else{
        //mouseup was the trigger
        $('#popup2').css('display', 'none');
    }
}); 
```

可以简化很多，但只是为了展示它是如何完成的！

# amazon-dynamodb - 何时使用 EMR 或 Scan for Amazon 的 Dynamo-DB？

> ID：11510147
> 
> 赞同：1
> 
> 时间：2012-07-16T18:18:20.767
> 
> 标签：amazon-dynamodb

EMR 和 Scan 都将解析整个表并消耗请求积分，但 EMR 还需要使用 ec2 实例，因此成本更高。

所以，我想知道在哪种情况下 EMR 比 Scan on Amazon 的 Dynamo-DB 更适合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:36:29.233

对不起 - 我不完全确定我理解你的问题。

如果您问为什么要使用 EMR 扫描整个 DynamoDB 表而不是直接进行扫描，答案是速度和简单性。

如果您将 Hive 之类的东西与 DynamoDB Serde 一起使用，则可以比直接查询 DynamoDB 更快地提取 DynamoDB 表的全部内容，因为扫描将是并行的。

DynamoDB 经常支持一致的读取性能，当查询 DynamoDB 表时，瓶颈转移到客户端能够足够快地读取数据。

# php - PHP OOP - 在其他类中使用对象

> ID：11510148
> 
> 赞同：0
> 
> 时间：2012-07-16T18:18:20.033
> 
> 标签：php, oop

多年来，我一直是一名 php 程序员，但现在才开始接触 OOP。到目前为止，我有两个类，Item 和 List（我只是在这里简化，它们不是真正的类名。）我所有的数据都是通过使用 SOAP 的 Web 服务访问的。

我不确定实现获取 SOAP 客户端并在多个类中使用它的最佳方法是什么。例如，WSDL 定义了一个 addItem 函数和一个 getList 函数。我还需要为每笔交易向服务发送一个令牌。

我需要在每个类中定义一个新的 SoapClient 吗？像这样：

```
class Item {
  // item properties
  function addItem($itemName) {
     $client = new SoapClient('myfile.wsdl');
     $client->addItem($itemName);
     //service returns true or false
  }
}

class List {
  function getList($listName) {
     $client = new SoapClient('myfile.wsdl');
     return $client->getList($listName);
     //service returns array
  }
} 
```

或者有什么方法可以在各个类之外创建一个新的 SoapClient 并在每个类中使用相同的客户端对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:19:52.227

通过一些依赖注入将其传递给构造函数：

```
class Item {

  function __constructor(SoapClient &$s){
      $this->soap = $s;
  }
  // item properties
  function addItem($itemName) {
     $this->soap->addItem($itemName);
     //service returns true or false
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:26:24.110

根据您使用 SoapClient 的方式，您有几个选择。

如果您要在脚本执行期间多次使用该 SoapClient（并且它是线程安全的？），您可以使用[单例](http://en.wikipedia.org/wiki/Singleton_pattern)模式来获取 SoapClient 的实例。这将允许您只创建一个对象实例，然后在每次需要时再次获取它。

要获取代码看起来像的对象。

```
$soapclass = $SoapClassSingleton::getInstance() 
```

后面的课程看起来像

```
class SoapClassSingleton{
private instance;
public static function getInstance(){
    if(!self::instance){            
        self::$instance = new SoapClass();          
    }
    return self::$instance;
} 
```

这几乎就像拥有一个“全局”变量，但仅在您需要时才创建，然后其他类可以使用相同的对象。我使用这种设计来登录我的应用程序。

您还可以创建 SoapClient 的实例，并在创建时将其传递给 Class。请参阅 PHP 的构造函数以获取帮助。

或者，您的类可以扩展一个包含 SoapController 的类。这样做的缺点是现在您与超类紧密耦合。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T18:23:56.893

哦，亲爱的，有很多可能的方法可以做到这一点。如果您想在脚本的所有部分中保持完全相同...您可以使用单例类。

使用权：

```
MySoapConnection::instance()->function_calls_here 
```

班级：

```
class MySoapConnection {

  /* Singleton */
  private static $_instance;
  public static function instance()
  {
    if (! self::$_instance):
      self::$_instance = new self();
    endif;
    return self::$_instance;
  }

  function __constructor(SoapClient $s){
      $this->soap = $s;
  }
  // item properties
  function addItem($itemName) {
     $this->soap->addItem($itemName);
     //service returns true or false
  }
} 
```

*正如评论所述，我没有测试过。您也不应该复制/粘贴此代码。仅显示一个单例示例。不多，不多。PHP 不是为 OOP 构建的，我喜欢 PHP，它被改编为使用 OOP，而不是为它构建。*

# ruby-on-rails - 如何使用支付功能向用户付费？

> ID：11510152
> 
> 赞同：2
> 
> 时间：2012-07-16T18:18:33.240
> 
> 标签：ruby-on-rails, controller, action

对不起，但由于 SSL 证书的问题，我无法在开发模式下调试。

所以我将我的应用程序部署到 Heroku。

**稍后我将更改为真正的凭据。**

我在 MerchantsController 中有操作：

```
class MerchantsController < ApplicationController
 helper_method :send_money

 def send_money(to_email, how_much_in_cents, options = {})
credentials = {
  "USER" => 'pro._1342094044_biz_api1.gmail.com',
  "PWD" => '1342094095',
  "SIGNATURE" => 'AMVxTgrWf6tUTF0Rf0y4QsqTFFAcApSXcqINQj2b2-a5wFhIx3UG87E- ',
}

params = {
  "METHOD" => "MassPay",
  "CURRENCYCODE" => "USD",
  "RECEIVERTYPE" => "EmailAddress",
  "L_EMAIL0" => to_email,
  "L_AMT0" => ((how_much_in_cents.to_i)/100.to_f).to_s,
  "VERSION" => "51.0"
}
  endpoint = ENV["RAILS_ENV"] == 'production' ? "https://api-3t.paypal.com" : "https://api-3t.sandbox.paypal.com"
url = URI.parse(endpoint)
http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true
all_params = credentials.merge(params)
stringified_params = all_params.collect { |tuple| "#{tuple.first}={CGI.escape(tuple.last)}" }.join("&")
response = http.post("/nvp", stringified_params)
 end 
```

我添加了路线：

```
 match 'merchants/send_money' => 'merchants#send_money', :via => [ :post ] 
```

现在，我怎么称呼它，因为这是错误的（从视图中）：

```
 <%=  link_to "Pay", merchants_send_money_path('pro_1342434702_biz@gmail.com',1) %> 
```

Heroku 日志：

```
 ←[35m2012-07-16T18:02:02+00:00 app[web.1]:←[0m ActionView::Template::Error (undefined method `gsub' for nil:NilClass) 
```

我应该如何做到这一点？

# css - 随机线显示在移动设备中，但不是桌面

> ID：11510158
> 
> 赞同：0
> 
> 时间：2012-07-16T18:18:47.550
> 
> 标签：css, mobile

所以我正在开发一个移动网站，我遇到了一个问题，即在一个部分上方弹出一条随机线。我无法真正测试它，因为该行没有出现在桌面上。我正在使用带有 ICS 的全新 Android 手机，并且我也在其他几部手机上对其进行了测试。

![](../Images/17e71c8d0751bde5aa65916bb5a7cf43.png)

我的 HTML 结构是：

```
<footer>
    <div class="footer-top">
    </div>
    <div class="footer-main">
    </div>
</footer> 
```

我对这些部分的 CSS 是：

```
footer { margin-top: -18px; position: relative; z-index: 100; }
.footer-top { background: url(../images/footer-top.png) repeat center top; height: 35px; text-align: center; }
.footer-main { background: url(../images/footer_bg.jpg) repeat center; padding-bottom: 30px;} 
```

我只是找不到那条线出现的原因。有没有其他人遇到过这样的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:19:27.927

[我认为这可能是一个 webkit 范围的问题，尽管我认为这只是一个 iOS 问题](https://stackoverflow.com/questions/11450934/is-this-an-ios-safari-css-bug/11452955#11452955)。

基本上，这是一个渲染错误。您可能必须为您的 div 之一提供 1 或 2 个像素的负边距才能使其消失。您可以使用媒体查询来定位它，因此桌面不会受到影响。

# xamarin.android - Monodroid 的 TeeChart

> ID：11510162
> 
> 赞同：0
> 
> 时间：2012-07-16T18:19:11.013
> 
> 标签：xamarin.android, teechart

我正在尝试创建一个与 TeeChart 集成的 MonoDroid 应用程序，我想要一个活动来保存图表和其他一些组件，如 textview、按钮等。这是代码，

```
protected override void OnCreate(Bundle bundle)
        {
            base.OnCreate(bundle);

            SetContentView(Resource.Layout.Test);
            var testpanel = FindViewById<LinearLayout>(Resource.Id.MealChartPanel);

            Steema.TeeChart.TChart tChart1 = new Steema.TeeChart.TChart(this);

            Steema.TeeChart.Styles.Bar bar1 = new Steema.TeeChart.Styles.Bar();
            tChart1.Series.Add(bar1);

            bar1.Add(3, "Pears", Color.Red);
            bar1.Add(4, "Apples", Color.Blue);
            bar1.Add(2, "Oranges", Color.Green);
            Steema.TeeChart.Themes.BlackIsBackTheme theme = new Steema.TeeChart.Themes.BlackIsBackTheme(tChart1.Chart);
            theme.Apply();

            testpanel.AddView(tChart1);
        }

    <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
  <LinearLayout
     android:id="@+id/MealChartPanel"
     android:layout_width="fill_parent"
     android:layout_height="100dip"
     android:layout_marginLeft="5dip"
     android:layout_marginRight="5dip">
  </LinearLayout>
</LinearLayout> 
```

我使用了 testpanel.AddView(tChart1); 但是那里什么也没有，我怎样才能把图表放在 MealChartPanel 线性布局中？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T09:02:26.463

那是因为您需要指定图表维度。您可以设置绝对像素尺寸或使用 LayoutParams，例如：

```
 testpanel.AddView(tChart1, new ViewGroup.LayoutParams(ViewGroup.LayoutParams.FillParent, ViewGroup.LayoutParams.FillParent)); 
```

# java - Swing LayoutManager：在填充整个水平空间的同时保持统一的buttonSize

> ID：11510167
> 
> 赞同：1
> 
> 时间：2012-07-16T18:19:19.207
> 
> 标签：java, swing, layout

我正在尝试构建以下可调整大小的 JPanel：

```
+-----------------------+
|                       |
|                       |
|                       |
|                       |
|                       |
|     JScrollPane       |
|     (containing a     |
|        JTable)        |
|                       |
|                       |
|                       |
|                       |
|                       |
+-----------+-----------+
|  button1  |    b2     |
+-----------+-----------+ 
```

我希望 button1 和 b2 始终具有相同的宽度，这意味着当整个组件水平调整大小时，两个按钮应该获得或失去相同的宽度。按钮本身之间或按钮与面板边框之间不应有空间。也就是说，按钮应始终占据所有可用的水平空间。请注意，按钮上的文本长度不同。

当组件垂直调整大小时，我希望 JScrollPane 获得新的高度，而带有按钮的行应该始终保持相同的高度（基本上`button1.getPreferedSize().getHeight()`）。

我已经尝试了一大堆不同的 LayoutManager。我得到的最接近的是将两个按钮放在一个新的 JPanel 中并将该面板的 LayoutManger 设置为 `new GridLayout(0,2)`. 这至少保持了两个按钮的统一宽度并填充了所有水平空间。但是，当面板垂直调整大小时，它们仍然会改变高度。

使用 GroupLayout 等其他 LayoutManager 时，我可以通过链接按钮 ( `groupLayout.linkSize(button1, b2)`) 来保持相同的宽度，但无法让它们填满整个水平空间。

实现这一目标的最佳方法是什么，应该使用什么 LayoutManager？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:25:43.387

我强烈建议查看[MigLayout](http://www.miglayout.com/)。这是一个非常灵活且易于使用的布局管理器。

如果您不想使用它，我建议您制作一个带有 BorderLayout 的 JPanel 并将滚动窗格放在边框布局的中心。然后，使用 1 行 2 列的 GridLayout 制作另一个 JPanel，并将两个按钮都添加到其中。然后，将该面板添加到具有边框布局的 JPanel 的南部区域。

代码看起来像这样：

```
 JPanel mainPanel = new JPanel();
    mainPanel.setLayout(new BorderLayout());

    JPanel tablePanel = new JPanel();
    JScrollPane jsp = new JScrollPane(new JTable());
    tablePanel.add(jsp);
    mainPanel.add(jsp, BorderLayout.CENTER);

    JPanel buttonPanel = new JPanel();
    buttonPanel.setLayout(new GridLayout(1, 2));
    JButton button1 = new JButton("Button 1");
    JButton button2 = new JButton("Button 2");
    buttonPanel.add(button1);
    buttonPanel.add(button2);
    mainPanel.add(buttonPanel, BorderLayout.SOUTH);

    this.add(mainPanel); 
```

# mysql - MYSql 数据库关系

> ID：11510171
> 
> 赞同：0
> 
> 时间：2012-07-16T18:19:30.920
> 
> 标签：mysql

我想在 2 个不同数据库中的表之间建立关系，

数据库 1 表 1 表 2

数据库2表3表4

与数据库 1 中的表 1 与数据库 2 中的表 3 的关系

我想知道这在 MySQL 中是否可行？如果是，我已经在数据库中尝试过，但我想知道这是否可能

是

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:20:23.900

是的，使用“。”是绝对可能的。操作员。假设您有 2 个模式 db1 和 db2。table1 存在于 db1 中，而 table2 存在于 db2 中。

因此，如果您想加入表格，您可以：

```
Select * from 
db1.table1 inner join db2.table2 on column1=column2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:28:22.880

是的，这是可能的。建表时外键关系如下

创建表`database1`。`table1` （`1`INT，外键（`1`）参考`database2`。`table3`（`1`）更新级联）；

# filesystems - 获取完整目录大小的快速方法

> ID：11510172
> 
> 赞同：1
> 
> 时间：2012-07-16T18:19:30.733
> 
> 标签：filesystems, size, du

我的应用程序需要尽快获得总目录大小。对于大目录， Standart`du`命令运行缓慢。Linux 的可能解决方案`inotify`不适用于 NFS。所以我最终得到了这些变体：

*   跟踪应用程序中的文件更改（非常困难）
*   每天运行`du`一次命令以收集应用程序的数据
*   一个简单的索引器（具有类似`inotify`功能，可立即检测更改）

最后一种方法似乎是一个解决方案，但我没有找到这样的软件。它应该像 Dropbox 客户端那样工作。我不知道如何`dropbox`捕捉变化。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-03-19T15:55:03.117

我想我会记录目录（树中的每个节点），并且只有在它们被触及时（使用它的最后一次写入访问时间找出）我会`du`每天重做一次（或者在你的情况下似乎可行） .

当然，这只会发现由于文件的创建和删除（或重命名，但我猜这不是那么相关）而导致的更改。如果您在没有创建新文件的情况下更改了文件大小，这将无法正常工作。但在大多数用例中，这种方法可以很好地工作。

# php - cakephp 不区分大小写登录

> ID：11510180
> 
> 赞同：1
> 
> 时间：2012-07-16T18:20:04.190
> 
> 标签：php, cakephp, login

我正在尝试使用户名*不区分大小写*，但我仍然希望以与注册时相同的方式存储用户名。因此，如果约翰要登录，他将能够输入“约翰”和他的密码。

```
public function login() {
    if ($this->request->is('post')) {
        if ($this->Auth->login()) {
            $this->redirect($this->Auth->redirect());   
        } else {
            $this->Session->setFlash('Your username/password combination was incorrect');
        }
    }
} 
```

我会以某种方式调整上面的代码还是执行自定义 SQL 查询？

任何帮助将非常感激。非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:33:00.013

他的意思是将原始的“John”存储在数据库中，然后将数据库保存的值和登录表单上的输入名称降低。然后，您仍然拥有与注册方式相同的用户名。

示例添加：

登录.ctp

```
echo $this->Form->create('User', array('url' => array('controller' => 'users', 'action' => 'register')));
echo $this->Form->input('User.username', array('label' => 'First Name:'));
echo $this->Form->input('User.password', array('label' => 'Password', 'type' =>   'password', 'value' =>  false));
echo $this->Form->submit('Register');
echo $this->Form->end(); 
```

考虑到当用户在那里输入用户名和密码时。假设我使用的是用户名“John”。大写的 J 是我们要确保在数据库中的内容。我们不会在保存数据时使用 strtolower。因此，通过使用 cake 的 save() 方法，我们可以完成保存区分大小写的问题。

注册.ctp

```
public function register()
{

    if ($this->Auth->loggedIn()) {
        $this->redirect(array('controller' => 'users', 'action' => 'login'));
    }
    if ($this->request->is('post')) {
       if ($this->User->User->saveAll($this->request->data)
       {
           $this->Session->setFlash(__('Your account has been created', true));
           $this->redirect(array('controller' => 'users', 'action' => 'index'));
       }} 
```

现在，当我们执行登录操作时：

```
if ($this->request->is('post')) {
 if ($this->Auth->loggedIn()) {
       $logged = $this->User->query('Your sql query matching username/password with strtolower, if you need to implement security hash from cakephp you can do that through cakephp hash method');
     }
 } 
```

基本示例，但应该有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:22:06.967

只需`strtolower`在保存（或检查它）之前使用 php 函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:46:52.387

当您验证您的登录时，请执行以下操作：

```
$query = "SELECT * FROM table WHERE LOWER(username) = '". strtolower($username)."'"; 
```

这会将您的列、用户名小写，并评估它是否等于小写`$username`。这样，您可以将任何情况存储在您的数据库中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T19:44:42.380

CakePHP 不区分大小写。它构建了一个非常通用的查询来根据数据库中的用户名检查您的条目。

```
$conditions = array(
    $model . '.' . $fields['username'] => $username,
    $model . '.' . $fields['password'] => $this->_password($password),
); 
```

可能是数据库设置导致您的设置区分大小写。

例如，在我所有的网站上，我的用户名都不区分大小写，而且我没有对代码做任何特别的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T18:40:19.407

在调用 $this->Auth->login() 之前，添加以下行：

```
$this->request->data['User']['username'] = strtolower($this->request->data['User']['username']); 
```

简单的！

# sas - 两个日期之间的月数 SAS

> ID：11510188
> 
> 赞同：0
> 
> 时间：2012-07-16T18:20:31.180
> 
> 标签：sas

我有一堆看起来像这样的数据点数据。样本：

```
 Date_1              Date_2
   10FEB2010:00:00:00      02/07/08
   10FEB2010:00:00:00      03/10/08
   10FEB2010:00:00:00      04/07/08
   24MAY2010:00:00:00      05/09/08      
   24MAY2010:00:00:00      06/11/08      
   24MAY2010:00:00:00      07/11/08 
```

我想从月初开始索引两个日期，然后在名为“month_from”的新列中获取其间的月数。我想将新列“month_from”添加到我的示例数据集中，如下所示：

```
 Date_1              Date_2      month_from
   10FEB2010:00:00:00      02/07/08       -24
   10FEB2010:00:00:00      03/10/08       -23  
   10FEB2010:00:00:00      04/07/08       -22
   24MAY2010:00:00:00      05/09/08       -24
   24MAY2010:00:00:00      06/11/08       -23
   24MAY2010:00:00:00      07/11/08       -22 
```

我最初的尝试是：

```
 month_from=intck('month.1','Date_1'd,'Date_2'd); 
```

我是否使用了正确的功能？

如何将变量“month_from”添加到样本数据集中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:37:09.943

这似乎可以满足您的需求...无法确定您是否需要将 date_1 和 date_2 从字符转换为数字（日期）..所以我也包含了该代码。

（也没有费心去测试 INTCK 日期变量是否需要在当月 1 日才能给出正确的结果）

```
data have;
 length date_1 $18 date_2 $8;
 infile datalines delimiter=','; 
 input date_1 $ date_2 $;

 datalines;
10FEB2010:00:00:00,02/07/08
10FEB2010:00:00:00,03/10/08
10FEB2010:00:00:00,04/07/08
24MAY2010:00:00:00,05/09/08
24MAY2010:00:00:00,06/11/08
24MAY2010:00:00:00,07/11/08
;

data want (drop=date_1 date_2 dt);
 set have;
 dt=input(date_1,datetime.);
 date1=datepart(dt);
 date2=input(date_2,mmddyy10.);

 month_from=intck('month',intnx('month',date1,0,'b'),intnx('month',date2,0,'b'));
 format date1 date2 mmddyy10.;
run; 
```

# gwt - GWT：UiBinder 和 MVP

> ID：11510191
> 
> 赞同：2
> 
> 时间：2012-07-16T18:20:38.520
> 
> 标签：gwt, mvp, uibinder

我对 GWT 比较陌生，一直在尝试遵循活动和地点教程。在我不得不使用 SuggestBox 之前，一切都运行良好。在 SuggestBox 中，您在构造函数中传递 Oracle 并且没有 setOracle 方法。如果我理解正确，活动和场所教程中的想法是让视图只实例化一次，因为它们是昂贵的对象，但这会带来问题。如果我想将 oracle 保留在 Presenter 中并在 Presenter 之前创建视图，我如何才能一起工作？@UiField(provided=true) 并从演示者实例化建议框不会这样做，因为当我初始化小部件时 SuggestBox 不能为空......使用 CellTable 相当容易，因为有一个 setModel 方法但使用 SuggestBox 或 CellBrowser 我不知道如何进行。我是不是误会了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:46:06.020

实际上几乎没有理由从演示者那里*设置*`SuggestOracle`。

但是，如果您需要它，您可以轻松地制作一个`SuggestOracle`回调到演示者的 a，或者`SuggestOracle`简单地包装另一个 oracle 的 a，您可以在运行时交换一个，从而从演示者进行设置。

# android - Android OpenGL ES 纹理大小 2 的幂

> ID：11510194
> 
> 赞同：3
> 
> 时间：2012-07-16T18:20:51.967
> 
> 标签：android, opengl-es

我已经知道很多硬件需要两种尺寸的纹理。但是平方图像尺寸是强制性的吗？我的意思是 32x32 64x64 512x512。我可以在每个硬件中使用 512x256 尺寸的纹理吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:24:42.133

是的，纹理可以是非方形的，这没问题。只要你保持宽度和高度的两个幂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T03:50:39.927

不，它必须是 2base。但是，您可以通过在图像的顶部和/或底部添加黑条，然后使用纹理坐标数组来限制从图像映射纹理的位置来解决此问题。例如，假设您有一个 13 x 16 像素的纹理。您可以在右侧添加 3 个黑色像素，然后执行以下操作：

```
static const GLfloat texCoords[] = {
    0.0, 0.0,
    0.0, 13.0/16.0,
    1.0, 0.0,
    1.0, 13.0/16.0
}; 
```

所以你现在可以有任何尺寸

# java - 在 Java 中处理几个异常

> ID：11510197
> 
> 赞同：12
> 
> 时间：2012-07-16T18:20:58.873
> 
> 标签：java, exception, exception-handling

考虑以下 Java 代码：

```
try{

    // do something
    // this piece of code throws several checked exceptions.

} catch (IllegalArgumentException e) {
    handleException(e);
} catch (IllegalAccessException e) {
    handleException(e);
} catch (InvocationTargetException e) {
    handleException(e);
} catch (InstantiationException e) {
    handleException(e);
} catch (NoSuchMethodException e) {
    handleException(e);
} catch (IOException e) {
    handleException(e);
} catch (NoSuchFieldException e) {
    handleException(e);
} 
```

块中的代码`try`抛出了几个检查异常。我要做的就是在发生异常时记录一条消息（使用一些自定义消息字符串）。即我的异常处理逻辑对于*所有异常*都是相同的。

我觉得上面的代码看起来不太好（更多的 LOC 和降低的可读性）。

**有没有更好的方法来处理这种情况？**

以下解决方案不是最佳实践，因此不推荐（按 Check 样式）。

```
try{
    // do something very bad
} catch (Exception e) {
    handleException(e);
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-16T18:24:52.240

在 Java 6 中，没有比您已经建议的更有吸引力的选项了。

但是 Java 7 有一个可以使用的[multi-catch语句：](http://docs.oracle.com/javase/7/docs/technotes/guides/language/catch-multiple.html)

```
catch(IllegalArgumentException | IllegalAccessException | IOException exception) {
    handleException(e);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T18:25:17.017

我觉得在你的情况下，第二种选择会很好。如果每种情况的异常处理都相同，则无需使代码过于复杂。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T18:25:24.063

在 Java 7 中，有一个新的出色的解决方案：您可以编写：

```
try{

    // do something
    // this piece of code throws several checked exceptions.

} catch (IllegalArgumentException | IllegalAccessException | InvocationTargetException e) {
    handleException(e);
} catch ... 
```

在较旧的 Java 版本中，捕获常见的子类（`Exception`其中一种情况）确实不是一个坏主意。*总是*不加考虑地这样做是不好的，但是如果您考虑过并选择它作为最佳解决方案，就可以这样做。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-16T18:26:03.223

与 Java 6 或更低版本无关。

使用 java 7，您可以执行以下操作：

```
catch(InstantiationException | IOException | NoSuchFieldException exception) {
        // handle our problems here.
} 
```

在 java 6 中，另一个“坏习惯”（但可能对您有用）可以是：

```
catch (Exception e) {
   if(! e instanceof RuntimeException) // Only non-checked exceptions!
       throw e;
   handleException(e) // All checked exception.
} 
```

问题：您正在使用instanceof。但是你的代码看起来更好......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-16T18:29:57.793

这是检查异常如何使 Java 程序员的生活变得悲惨的另一个例子。仅仅因为一段代码可以引发检查异常，那么该特定代码很可能**不是**您想要处理它们的地方。如果您的应用程序设计良好，那么您已经有了一个中心位置，即*异常屏障*，您可以在其中处理（记录）您的异常。如果是这种情况，那么您应该将所有这些异常包装到 a 中`RuntimeException`并将它们传递给屏障。在这种情况下，这是处理代码：

```
try {
  // do stuff
} catch (RuntimeException e) { 
  throw e; 
} catch (Exception e) { 
  throw new RuntimeException(e); 
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-17T18:42:51.227

大家觉得这个解决方案怎么样？

```
try {
    // some code that might throw an exception.
} catch (Exception e) {
    if(e instanceof RuntimeException){
        throw (RuntimeException) e;
    }
    // log exception
} 
```

**优点：**

1.  **更少的代码，可以为所有检查的异常**保持相同的异常处理逻辑。
2.  不处理运行时异常和错误。抓住他们但把他们扔回去。

**缺点：**

1.  不要确认*最佳实践*检查，因为它仍然会捕获异常。（但要注意捕获运行时异常的情况，尽管检查样式可能会失败。）
2.  *向下转换为RuntimeException*的任何可能的副作用？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-16T18:27:15.187

看起来 Java 7 团队的人听到了你的抱怨 :-) [http://www.oracle.com/technetwork/articles/java/java7exceptions-486908.html](http://www.oracle.com/technetwork/articles/java/java7exceptions-486908.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-17T03:54:44.347

您的代码看起来像您打算这样做：

```
try{
    // do something very bad
} catch (Throwable e) {
    handleException(e);
} 
```

这不仅可以捕获所有异常，还可以捕获错误 - 可能在 try/catch 块中抛出的所有内容。

捕获所有异常并让所有错误通过很少是正确的事情，但捕获一长串任意选择的不相关异常则更不可能是正确的事情。

您的例外列表看起来相当可疑。即为什么你会捕捉到 IllegalArgumentException 而不是 NullPointerException 或 ClassCastException ，它们在语义上处于相似的级别。而且你似乎是在结合IO使用Reflection，所以你可能还要处理NoClassDefFoundError、ExceptionInInitializerError等错误。那么 StackOverflowError 甚至 OutOfMemoryError 呢...

# asp.net - url中的空格重定向到默认网站，如何更改根目录？

> ID：11510203
> 
> 赞同：0
> 
> 时间：2012-07-16T18:21:30.277
> 
> 标签：asp.net, iis, web-config, root

如果选定的值有空格，它将被重定向到默认网站。

这是页面代码。

```
Response.Redirect("~/tsAdmin/Marketing/OffersEdit.aspx?type=" + Server.UrlEncode(OfferTypeDropDownList.SelectedValue)) 
```

这将起作用

```
localhost:8011/tsAdmin/Marketing/OffersEdit.aspx?type=Shipping 
```

但这行不通

```
localhost:8011/tsadmin/marketing/offersedit.aspx?type=buy%20x%20get%20y%20by%20category 
```

它被重定向到`localhost/bvadmin/marketing/offersedit.aspx?type=buy%20x%20get%20y%20by%20category`

我假设这是一个 IIS 设置或在 web.config 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T18:24:53.057

这是 IIS 中的设置。需要将 .aspx 页面添加为可识别页面。

仍然不知道为什么它只有在参数有空间时才会崩溃，但它现在可以工作了。

# couchdb - 视图的 CouchDB 性能与 HTTP 批量获取

> ID：11510216
> 
> 赞同：0
> 
> 时间：2012-07-16T18:22:24.553
> 
> 标签：couchdb, mapreduce

我有几个 CouchDB 数据库，都在数百 GB，我需要以依赖于多个数据库的方式从中获取文档，例如（伪代码，前缀指示文档来自哪个数据库）：

```
for each Db1_Document in Db1
    if Db1_Document has field "Db2_match"
        Db2_Document = Db1_Document.Db2_match
        for each Db2_Reference in Db2_Document.references
            if Db2_Reference has empty field "Db1_match"
                add Db2_Reference to List bigList
        emit [Db2_Document, bigList] 
```

我可以用一组复杂（和骇人听闻的）视图来做到这一点。或者我可以批量 HTTP 获取我需要的文档并用 Java 进行处理。

与创建视图相比，批量 HTTP 获取的成本是多少？CouchDB 本身不支持视图链接的事实是否足以避免视图解决方案？

这是一个效率非常重要的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:32:58.710

在 Couch 中创建视图是 I/O 和 CPU 密集型的，特别是因为它会影响实例中的所有文档。

如果您的逻辑影响所有文档，那么创建视图可能是最有效的机制。如果您有一个相当粗略的视图已经为您提供了此处理所需的子集（或子集的超集，但少于整个 DB），那么最好简单地获取您需要的子集并在本地处理它.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:11:25.270

您可能会发现创建一个新数据库更容易/更好，该数据库使用过滤复制将所有信息从其他数据库提取到另一个数据库中。然后对其他数据库进行查询。您的数据会有点陈旧，但将所有相关数据放在一个数据库中的优势在于可以编写一个可以查看所有相关文档的视图。因此，当新文档从复制步骤到达时，该视图将被索引并增量更新。

这将提供世界上最好的：

*   您将能够编写有意义的视图。
*   您将只将您需要的数据提取到您的 Java 代码中。
*   您仍然会在运行时获得性能优势，因为视图将被编入索引，随着新数据从复制中到达，该视图将被增量更新。

# asp.net - 动态 DropDownList 回发导致触发动态图像按钮的单击事件

> ID：11510219
> 
> 赞同：0
> 
> 时间：2012-07-16T18:22:39.993
> 
> 标签：asp.net, dynamic, drop-down-menu, controls

我有一个带有 asp 表的编辑页面，其中一列包含一个带有 autopostback=true 的动态下拉列表，并且数据源是从数据库填充的数据表。还有另外几列具有动态图像按钮，用于在各自的列中添加和删除数据，但与下拉列表的列完全不相关或不受其影响。

如果我在最初填充该表之前更改下拉列表中的选择而不导致任何回发，它会触发动态创建的图像按钮之一的单击事件处理程序，并且下拉列表选择的值不会更改。但是，之后它会正常运行，或者如果我在更改下拉列表中的选择之前单击了这些图像按钮，它会正常运行。

为什么会发生这种情况的任何原因？

protected void Page_Load(object sender, EventArgs e) {

```
 if (pnl_Edit.Visible)
            {
                Client ClientToEdit = ClientController.ViewClient((int)Session["SelectedClient"]);
                PopulateEditClientPanel(ClientToEdit);
                //Combo boxes need to be databinded on every postback
                BindOperatingNameComboBox(rcb_OperatingName);
                BindParentCompanyComboBox(rcb_ParentCompany);
            }

    } 
```

protected void btn_Edit_Command(object sender, CommandEventArgs e) { Client ClientToEdit = ClientController.ViewClient(int.Parse(e.CommandArgument.ToString()));

```
 //Populate Client fields
        txt_ClientName.Text = ClientToEdit.ClientName;
        rcb_OperatingName.Text = ClientToEdit.OperatingName;
        rcb_ParentCompany.Text = ClientToEdit.ParentCompany;
        txt_Address1.Text = ClientToEdit.Address1;
        txt_Address2.Text = ClientToEdit.Address2;
        txt_Country.Text = ClientToEdit.Country;
        txt_Region.Text = ClientToEdit.Region;
        txt_City.Text = ClientToEdit.City;
        txt_PostalCode.Text = ClientToEdit.PostalCode;

        PopulateEditClientPanel(ClientToEdit);

        btn_SaveChanges.CommandArgument = e.CommandArgument.ToString();
     }

        protected void PopulateEditClientPanel(Client ClientToEdit)
        {
            //Populate the Services table
            TableHeaderRow HeaderRow = new TableHeaderRow();
            HeaderRow.BackColor = System.Drawing.Color.Blue;
            HeaderRow.ForeColor = System.Drawing.Color.White;
            TableHeaderCell HeaderCell = new TableHeaderCell();
            HeaderCell.Text = "Service";
            HeaderRow.Cells.Add(HeaderCell);
            HeaderCell = new TableHeaderCell();
            HeaderCell.Text = "Status";
            HeaderRow.Cells.Add(HeaderCell);
            HeaderCell = new TableHeaderCell();
            HeaderCell.Text = "Source(s)";
            HeaderRow.Cells.Add(HeaderCell);
            HeaderCell = new TableHeaderCell();
            HeaderCell.Text = "Contact(s)";
            HeaderRow.Cells.Add(HeaderCell);

            tbl_EditServices.Rows.Add(HeaderRow);

            TableRow Row;
            TableCell Cell;

            DataTable Statuses = PageController.GetStatuses();
            DataTable Sources = PageController.GetSourceList("");

            //Create a row for each service
            foreach (Service CurrentService in ClientToEdit.Services)
            {
                Row = new TableRow();
                Row.ID = CurrentService.ServiceDescription;
                Cell = new TableCell(); //Service
                Cell.ID = CurrentService.ServiceDescription + "Service";
                Cell.Text = CurrentService.ServiceDescription;
                Cell.VerticalAlign = VerticalAlign.Top;
                Row.Cells.Add(Cell);

                Cell = new TableCell(); //Status
                Cell.ID = CurrentService.ServiceDescription + "Status";
                DropDownList Status = new DropDownList();
                Status.AutoPostBack = true;
                Status.DataTextField = "StatusDescription";
                Status.DataValueField = "StatusID";
                Status.DataSource = Statuses;
                Status.DataBind();
                Cell.Controls.Add(Status);
                //Select the current status that is currently known for this service
                foreach (ListItem CurrentStatus in Status.Items)
                {
                    if (CurrentStatus.Text == CurrentService.Status)
                        CurrentStatus.Selected = true;
                    else
                        CurrentStatus.Selected = false;
                }
                Cell.VerticalAlign = VerticalAlign.Top;
                Row.Cells.Add(Cell);

                Cell = new TableCell(); //Sources
                Cell.ID = CurrentService.ServiceDescription + "Source";

                //Create a button to add another source
                ImageButton AddSourceButton = new ImageButton();
                AddSourceButton.ID = CurrentService.ServiceDescription + "$Source";
                AddSourceButton.ImageUrl = @"~/Images/add_icon.jpg";
                AddSourceButton.Width = 20;
                AddSourceButton.Height = 20;
                Cell.Controls.Add(AddSourceButton);
                Cell.VerticalAlign = VerticalAlign.Top;

                for (int i = 0; i < CurrentService.Sources.Count; ++i)
                {
                    Cell.Controls.Add(new LiteralControl("<br/>"));
                    //Create a remove button for each entry
                    ImageButton RemoveSourceButton = new ImageButton();
                    RemoveSourceButton.ImageUrl = @"~/Images/Delete.png";
                    RemoveSourceButton.Height = 20;
                    RemoveSourceButton.Width = 20;
                    RemoveSourceButton.CommandArgument = Session["SelectedClient"].ToString() + "," + CurrentService.ServiceDescription + "," + CurrentService.Sources[i];
                    RemoveSourceButton.Click += new ImageClickEventHandler(RemoveSourceButton_Click);
                    Cell.Controls.Add(RemoveSourceButton);

                    Cell.Controls.Add(new LiteralControl("&nbsp;&nbsp;&nbsp;" + CurrentService.Sources[i]));
                }

                Row.Cells.Add(Cell);

                Cell = new TableCell(); //Contact Name
                Cell.ID = CurrentService.ServiceDescription + "Contact";

                //Create a button to add another contact
                ImageButton AddContactButton = new ImageButton();
                AddContactButton.ID = CurrentService.ServiceDescription + "$Contact";
                AddContactButton.ImageUrl = @"~/Images/add_icon.jpg";
                AddContactButton.Width = 20;
                AddContactButton.Height = 20;
                Cell.Controls.Add(AddContactButton);

                for (int i = 0; i < CurrentService.Contacts.Count; ++i)
                {
                    Cell.Controls.Add(new LiteralControl("<br/>"));
                    //Create a remove button for each entry
                    ImageButton RemoveContactButton = new ImageButton();
                    RemoveContactButton.ImageUrl = @"~/Images/Delete.png";
                    RemoveContactButton.Height = 20;
                    RemoveContactButton.Width = 20;
                    RemoveContactButton.CommandArgument = Session["SelectedClient"].ToString() + "," + CurrentService.ServiceDescription + "," + CurrentService.Contacts[i].ContactID.ToString();
                    RemoveContactButton.Click += new ImageClickEventHandler(RemoveSourceButton_Click);
                    Cell.Controls.Add(RemoveContactButton);

                    //Create a link button for each contact which can be clicked to edit 
                    Cell.Controls.Add(new LiteralControl("&nbsp;&nbsp;&nbsp;"));
                    LinkButton Link = new LinkButton();
                    Link.ID = CurrentService.ServiceDescription + CurrentService.Contacts[i].ContactID.ToString();
                    Link.Click += new EventHandler(Link_Click);
                    Link.CommandArgument = CurrentService.Contacts[i].ContactID.ToString();
                    Link.Text = CurrentService.Contacts[i].ContactName;
                    Cell.Controls.Add(Link);
                }

                Cell.VerticalAlign = VerticalAlign.Top;
                Row.Cells.Add(Cell);

                tbl_EditServices.Rows.Add(Row); 
```

# java - logback 不生成文件

> ID：11510227
> 
> 赞同：6
> 
> 时间：2012-07-16T18:23:09.347
> 
> 标签：java, slf4j, logback

我是登录新手。我正在尝试登录文件。我`logback.xml`的是：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
            <Pattern>%d{yyyy-MM-dd_HH:mm:ss.SSS} %-5level %logger{36} - %msg%n
            </Pattern>
        </encoder>
    </appender>

    <appender name="FILE"
              class="ch.qos.logback.core.rolling.RollingFileAppender">
        <File>d:/walknshine.log</File>
        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
            <Pattern>%d{yyyy-MM-dd_HH:mm:ss.SSS} [%thread] %-5level %logger{36} -
                %msg%n
            </Pattern>
        </encoder>

        <rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">
            <FileNamePattern>d:/walknshine.%i.log.zip
            </FileNamePattern>
            <MinIndex>1</MinIndex>
            <MaxIndex>10</MaxIndex>
        </rollingPolicy>

        <triggeringPolicy
                class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">
            <MaxFileSize>1MB</MaxFileSize>
        </triggeringPolicy>
    </appender>

    <root level="INFO">
        <appender-ref ref="FILE" />
        <appender-ref ref="STDOUT" />
    </root>
</configuration> 
```

日志记录发生在控制台中，但在给定路径上没有生成文件。我的 Maven 依赖项是

```
 <!-- LOGGING DEPENDENCIES - LOG4J -->
    <dependency>
        <groupId>logback</groupId>
        <artifactId>logback-classic</artifactId>
        <version>1.0.6</version>
    </dependency>
    <dependency>
        <groupId>logback</groupId>
        <artifactId>logback-core</artifactId>
        <version>1.0.6</version>
    </dependency>
    <dependency>
        <groupId>logback</groupId>
        <artifactId>sl4j</artifactId>
        <version>1.6.0</version>
    </dependency> 
```

我将记录器用作：

```
private static final Logger logger = LoggerFactory
        .getLogger(Main.class);

logger.info("Logged Message"); 
```

请帮帮我......我错过了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T04:47:50.623

您确定您的 logback.xml 文件位于正确的位置并且正在被检测到吗？尝试故意在配置文件中输入错误，并查看是否在控制台中收到消息（Logback 会自动执行此操作）。此外，您可以要求 Logback[打印出其内部状态信息](http://logback.qos.ch/manual/configuration.html#automaticStatusPrinting)。

```
public static void main(String[] args) {
    // assume SLF4J is bound to logback in the current environment
    LoggerContext lc = (LoggerContext) LoggerFactory.getILoggerFactory();
    // print logback's internal status
    StatusPrinter.print(lc);
    ...
} 
```

# javascript - ajax responseText 验证功能冻结页面内容（异步）

> ID：11510229
> 
> 赞同：0
> 
> 时间：2012-07-16T18:23:15.953
> 
> 标签：javascript, ajax, responsetext, ajax-request

我写了一个很大的函数来更新我网站上的内容`Ajax Request`，但是这个函数在`responseText`我的页面上冻结了一些 ms。

**有人可以告诉我为什么会这样吗？**

*这是我的功能：*

```
//process Ajax responseText
window.processResponse = function(response) {
    if (!response) return;
    var div = document.createElement("div");
    div.innerHTML = response;
    var divElements = div.getElementsByTagName("*");
    var divChildren = div.children;
    //set unique id for each element and save all ids in array
    var ids = [];
    for (var i = 0; i < divElements.length; i++) {
        var em = divElements[i];
        if (!em.id) {
            var hash = (em.innerHTML || em.outerHTML).toHash();
            var o = 0;
            if (ids.inArray(hash)) em.id = hash + "_" + (++o);
            else em.id = hash;
        }
        ids.push(em.id);
    } //endfor
    for (var i = 0; i < divChildren.length; i++) {
        var root = divChildren[i];
        var documentRoot = document.getElementById(root.id);
        if (documentRoot) {
            if (documentRoot.getAttribute("page") != root.getAttribute("page")) {
                documentRoot.innerHTML = root.innerHTML;
                documentRoot.setAttribute("page", root.getAttribute("page"));
                return;
            }
            var pageHash = div.innerHTML.toHash();
            if (documentRoot.getAttribute("hash") == pageHash) {
                return;
            }
            documentRoot.setAttribute("hash", pageHash);
            var rootElements = root.getElementsByTagName("*");
            var node = null;
            var prevNode = {};
            var parentNode = null;
            var documentNode = null;
            var documentParentNode = null;
            var index = 0;
            var noChange = {};
            while (node = rootElements[index++]) {
                parentNode = node.parentNode;
                if (noChange[parentNode.id]) {
                    continue;
                }
                documentNode = document.getElementById(node.id);
                documentParentNode = document.getElementById(parentNode.id);
                if (!documentNode) {
                    //if element not exists then create new node
                    if (prevNode[parentNode.id]) documentParentNode.insertBefore(node, prevNode[parentNode.id].nextSibling);
                    else documentParentNode.insertBefore(node, documentParentNode.firstChild);
                    documentNode = node;
                    index--;
                } else {
                    //if node exists then check it's content
                    if (!node.children[0] && !documentNode.children[0]) {
                        var nodeHash = (node.innerHTML || node.outerHTML).toHash();
                        var documentHash = (documentNode.innerHTML || documentNode.outerHTML).toHash();
                        if (nodeHash != documentHash) {
                            documentNode.parentNode.insertBefore(node, documentNode.nextSibling);
                            documentNode.parentNode.removeChild(documentNode);
                            documentNode = node;
                            index--;
                        }
                    }
                    //if loaded node has no children then just replace old node with new one
                    else if (!node.children[0]) {
                        documentNode.parentNode.insertBefore(node, documentNode.nextSibling);
                        documentNode.parentNode.removeChild(documentNode);
                        documentNode = node;
                        index--;
                    } else {
                        var nodeHash = (node.innerHTML || node.outerHTML).toHash();
                        var documentHash = (documentNode.innerHTML || documentNode.outerHTML).toHash();
                        if (nodeHash == documentHash) noChange[node.id] = true;
                    }
                }
                //save previous node
                prevNode[parentNode.id] = documentNode;
            } //endwhile
            //remove unneded nodes
            var documentRootElements = documentRoot.getElementsByTagName("*");
            for (var j = 0; j < documentRootElements.length; j++) {
                if (!ids.inArray(documentRootElements[j].id)) {
                    documentRootElements[j].parentNode.removeChild(documentRootElements[j]);
                    j--;
                }
            } //endfor
        }
    } //endfor
};
//generate hashCode from string
String.prototype.toHash = function() {
    var hash = 0,
        i, chr;
    var str = this.clear();
    if (str.length == 0) return hash;
    for (i = 0; i < str.length; i++) {
        chr = str.charCodeAt(i);
        hash = ((hash << 5) - hash) + chr;
        hash = hash & hash;
    }
    return hash.toString();
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:10:26.470

好的，所以第一个问题是你有一个巨大的函数，它*不断地*抓取所有元素，然后在每个迭代级别重新抓取相同的节点。

至少在你这样做之前你没有将 div 附加到 DOM —— 那将是 JS 自杀。

为什么不使用递归进行深度优先遍历，这至少可以节省多次抓取所有子元素的时间（除非您确定这会破坏您的堆栈，在这种情况下，您几乎无能为力使其成为一项快速功能）？

另外：JS是单线程的。如果您一口气完成所有这些操作，那么您的 UI 将完全没有响应，直到您完成所有操作。

走递归路线，如果您将此功能分解为多个步骤，也可以让您恢复 UI。

如果你可以添加一个简单的 10 毫秒 setTimeout(recurseHTML, 10); 在那里（或包含您要发送的任何参数的匿名函数），这将使浏览器有时间完成用户一直在等待执行的任何交互。

这意味着您必须更加努力地考虑如何满足您的“已完成”条件，这意味着您必须等待一段时间才能完成该过程——但可用性胜过这两件事。

# html - 具有较宽的 HTML 块，在较窄的块内两侧具有相等的边距

> ID：11510231
> 
> 赞同：0
> 
> 时间：2012-07-16T18:23:23.567
> 
> 标签：html, css, margin

我正在使用一个 HTML 网站，该网站的设计固定在一定宽度上，以`auto`左右边距为中心。我正在开发一个交互式脚本，有时会创建一个大表格作为不适合此宽度的输出，它可能会更宽。

为了显示：

```
​&lt;html>
<body>
    <div style="margin: 10px auto; width: 300px; border: 1px blue solid;">
    &nbsp;
        <div style="margin: 10px auto; width: 400px; border: 1px red solid;">
        &nbsp;
        </div>
    </div>
</body>
</html>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

( [http://jsfiddle.net/ALPXn/](http://jsfiddle.net/ALPXn/) )

我的问题是，我如何将内部的红色 div 对齐在中心，无论它是否突出到蓝色 div 的两侧，而不给它一个明确的负左边距，因为我不知道最终宽度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:01:14.150

我认为你可以使用 jquery 来做到这一点。您可以动态更改 css，页面加载后您可以更改 css。代码将与此类似。

```
var x = $('outerDiv').width();
var y = $('innerDiv').width();
​$('innerDiv')​​​​.css('left',-(y-x)/2)​;​ 
```

为此，您必须将 divison id 指定为 outerDiv 和 innerDiv。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:12:27.927

这里的问题是你必须让子元素忽略父元素的宽度和位置才能工作。不过，通过一些 javascript 操作是可能的。通过将 css 位置更改为绝对位置，并将其相对于屏幕居中，它将有效地忽略父级，同时在技术上仍被它包含。

使用 offsetWidth 更新链接：http: [//jsfiddle.net/g6dGE/1/](http://jsfiddle.net/g6dGE/1/)

# html - 视口元标记与媒体查询？

> ID：11510232
> 
> 赞同：29
> 
> 时间：2012-07-16T18:23:25.707
> 
> 标签：html, css

我很想知道，要针对平板电脑、台式机和智能手机优化您的网站，最好使用什么：媒体查询或视口元标记？见代码：

```
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
```

对比

```
/* Smartphones (portrait and landscape) ----------- */
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {
/* Styles */
}

/* Smartphones (landscape) ----------- */
@media only screen 
and (min-width : 321px) {
/* Styles */
}

/* Smartphones (portrait) ----------- */
@media only screen 
and (max-width : 320px) {
/* Styles */
}

/* iPads (portrait and landscape) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) {
/* Styles */
}

/* iPads (landscape) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : landscape) {
/* Styles */
}

/* iPads (portrait) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : portrait) {
/* Styles */
}

/* Desktops and laptops ----------- */
@media only screen 
and (min-width : 1224px) {
/* Styles */
}

/* Large screens ----------- */
@media only screen 
and (min-width : 1824px) {
/* Styles */
}

/* iPhone 4 ----------- */
@media
only screen and (-webkit-min-device-pixel-ratio : 1.5),
only screen and (min-device-pixel-ratio : 1.5) {
/* Styles */
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-16T18:31:15.810

两者都是必要的。

**媒体查询**用于为不同的设备提供不同的 css，就像不同设备的 if 条件一样。

**Viewport** meta 标签是设置告诉设备根据这个标签取宽度。如果未使用的设备将根据其默认设置调整布局，则它就像对设备的重置。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-16T18:41:11.660

**更新：从 2020 年开始**

您需要一个视口元标记（总是）

`<meta name="viewport" content="width=device-width, initial-scale=1">`

[https://developer.mozilla.org/en-US/docs/Mozilla/Mobile/Viewport_meta_tag](https://developer.mozilla.org/en-US/docs/Mozilla/Mobile/Viewport_meta_tag)

并且几乎总是有几个@media 断点

但经常（最近）——人们尝试利用百分比、变量/相对单位、弹性框和自动填充类型的网格情况来避免@media 查询

我认为所有这些事情都可以一起工作以获得最佳结果。我喜欢@media 查询有很多原因。:) 它们都只是使用的工具！坚持目标——正确的工具就会出现。

这是一个涵盖整个思考过程[的视频。](https://vimeo.com/478753228)

这[是一篇](https://www.codementor.io/@sheriffderek/basics-of-responsive-design-media-css-at-rule-du107krxa)关于@media 规则的文章。

......

（背景故事的原始答案）

我会说每种情况都是不同的……这不是非此即彼的情况。您在那里拥有的视口元标记将使网站保持 1 比 1 的比例，这在很多情况下是好的。但是，它也被设置为用户可缩放的“否” - 这意味着用户将无法放大等...有时 ipad 和其他设备更改您的网站的方式是最好的...（取决于）

我发现的最好方法是使用媒体查询并选择 2 个方向之一：

1.  从小做起
2.  从大做起

将您的浏览器窗口拉伸得越来越大（或越来越小），然后当网站变得丑陋时，（就在之前）那是您的下一个断点......在那里进行媒体查询......并重复。不要关注所有的设备尺寸——这样你就会知道无论什么新设备等出现——你已经设计了它以在每个可能的尺寸上看起来都不错。（当它低于 320 时/我喜欢让网站变成名片/// 更好地为没有智能手机提供可读信息...）

然后在这一切之后......在设备上测试并尝试不同的视口元标记。

有很多关于它的好文章...使用诸如“响应式设计”或“自适应”或“RWD”响应式网页设计之类的关键字。还有祝你好运 ！！！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-16T18:31:17.367

这取决于你想达到什么目标。

如果您只想为桌面分辨率设计并且让移动浏览器“缩小”并假设桌面分辨率，那么您可以仅使用视口元标记，将宽度设置为固定值。

如果你想要一个真正的响应式设计，你应该将视口元标记设置为设备宽度，并使用媒体查询来规划不同分辨率的布局，如代码中所示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-04T02:21:29.923

@Media Query 用于响应我们的网站以获取其他设备。
例如，此查询仅适用于最小 768 像素宽度和最大 1024 像素的设备。

```
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) {
/* Styles */
} 
```

**什么是媒体查询？** 仅当某个条件为真时，它才使用@media 规则来包含 CSS 属性块。

示例 如果浏览器窗口为 600 像素或更小，则背景颜色将为浅蓝色：

```
@media only screen and (max-width: 600px) {
  body {
    background-color: lightblue;
  }
} 
```

**什么是元视图端口？？？**

视口是网页的用户可见区域。

视口因设备而异，在手机上会比在电脑屏幕上小。

在平板电脑和手机之前，网页只针对电脑屏幕设计，网页采用静态设计和固定大小是很常见的。

然后，当我们开始使用平板电脑和手机上网时，固定大小的网页太大而无法容纳视口。为了解决这个问题，这些设备上的浏览器缩小了整个网页以适应屏幕。

这并不完美！但是快速修复。

```
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
```

我希望这可以帮助您了解元视口和@Media 查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-31T08:35:05.130

不要小看任何一个！你需要：

*   视口元数据使您的文本真正可读
*   MQ 让您的网页在小屏幕上易于使用

# mvvm-light - 迁移到 SL5 的 v4 时，EventToCommand 不起作用

> ID：11510233
> 
> 赞同：0
> 
> 时间：2012-07-16T18:23:25.847
> 
> 标签：mvvm-light, silverlight-5.0

我有 MVVMLight 的 SL4 应用程序。我将它迁移到 SL 5 并在编译应用程序时出现以下错误：

XML 命名空间“clr-namespace:GalaSoft.MvvmLight.Command;assembly=GalaSoft.MvvmLight.SL5”中不存在标记“EventToCommand”

此错误的 xml 是：

```
 xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
  xmlns:cmd="clr-namespace:GalaSoft.MvvmLight.Command;assembly=GalaSoft.MvvmLight.SL5"

<i:Interaction.Triggers>
   <i:EventTrigger EventName="MouseLeftButtonUp">
       <cmd:EventToCommand Command="{Binding ResetPasswordCommand,Mode=OneWay}"                                             
        MustToggleIsEnabledValue="True" />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

很困惑。已为新平台更新所有程序集。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:46:39.993

弄清楚：应该使用 assembly=GalaSoft.MvvmLight.Extras.SL5 而不是 assembly=GalaSoft.MvvmLight.SL5。谢谢。

# mysql - MySQL 多表 SELECT 查询

> ID：11510241
> 
> 赞同：2
> 
> 时间：2012-07-16T18:24:15.100
> 
> 标签：mysql

假设你有 3 张桌子..

```
articles(id,id_cat)
categories(id)
messages(id,id_cat,id_article) 
```

..where与 or`articles`相关`categories`并且`messages`可以与`articles`or相关`categories`（用户可以在类别或文章中发布消息）

在假设的当前类别中`id=55`，我可以执行哪个查询来列出在当前类别和属于当前类别的文章中发布的所有消息？

**-- 联合解决方案 --**

Poodlehat 建议使用 UNION，对于这个特定问题，它是：

```
SELECT * FROM (
(SELECT m.id FROM messages AS m INNER JOIN categories AS c ON c.id=m.id_cat 
WHERE m.id_cat=55) 
UNION 
(SELECT m.id FROM messages AS m INNER JOIN articles AS a ON a.id=m.id_article 
WHERE a.id_cat=55)
) AS foo 
```

**----**

现在，**没有 UNION**有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:34:35.160

```
SELECT m.id    
FROM messages m 
WHERE m.id_cat=55
union 
SELECT m.id 
FROM messages m, articles a 
WHERE a.id_cat=55
AND m.id_article=a.id 
```

在没有工会的情况下这样做，嗯，现在你在挑战我......看看这是否有效

```
SELECT m.id 
FROM messages m LEFT OUTER JOIN articles a ON m.id_article=a.id
WHERE m.id_cat=55 OR a.id_cat=55 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T18:26:39.777

尝试这个 ：：

```
Select * from 
messages m 
inner join categories c on (m.id_cat=c.id)
inner join article a on (c.id=a.id_cat)
where m.id_cat=55 
```

# objective-c - 如何在目标 c 中访问新创建的类

> ID：11510249
> 
> 赞同：0
> 
> 时间：2012-07-16T18:24:44.643
> 
> 标签：objective-c, class

我觉得这是一个非常愚蠢的问题，但我无法在任何地方找到答案。我在一个名为“Word”的 XCode 项目中创建了一个新类，它有自己的 .h 和 .m 文件，这些文件继承自 NSString，并有自己声明的实例变量、方法等。如何在viewcontroller.h 和 .m 文件？我虽然它只会出现在 XCode 的小建议框中，就像预制类一样，但它没有。如何使用我的新课程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:26:47.653

```
#import "Word.h" 
```

我会注意到子类化`NSString`是非常罕见的，而且几乎从来不是你想要做的。你可能是想`Word`拥有一个`NSString`财产。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:26:50.143

在您的 .h 中，在顶部键入，`#import "`然后开始键入 Word.h。如果 .h 和 .m 文件在您的项目中正确，它应该会自动完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:26:44.190

您只需将以下内容添加到您的 ViewController.h

```
#import "Word.h" 
```

# datatables - DataTables.net fnServerParams 参数更改

> ID：11510250
> 
> 赞同：0
> 
> 时间：2012-07-16T18:24:46.997
> 
> 标签：datatables

如果我更新 fnServerParams() 中的某些参数，DataTables 表示层不会考虑它们，知道吗？

例如，假设 iDisplayStart=10 和 iDisplayEnd=20 是正确的值

```
'fnServerParams': function (aoData) {
    // Find i such as aoData[i]['name'] == 'iDisplayStart'
    aoData[i]['value'] = 10;
    // Find j such as aoData[j]['name'] == 'iDisplayEnd'
    aoData[j]['value'] = 20;
}, 
```

然后分页按钮仍然停留在第 1 页，而我希望它显示我的数据的第 2 页。排序参数也是如此。

编辑：初始化代码如下：

```
var oTable = $('#WEB_TABLE_ID').dataTable(
                       {'aaSorting': [[0, 'desc']],
                        'bProcessing': true,
                        'bServerSide': true,
                        'sAjaxSource': '../subscription/search_list.php',
                        'sServerMethod': 'POST',
                        'sPaginationType': 'full_numbers',
                        'iDisplayLength': 100,  // Default number of rows to display
                        'oLanguage': {'sSearch': "Search all",
                        'sLengthMenu': 'Display <select>   \
<option value="10">10</option>                             \
<option value="100">100</option>                           \
<option value="500">500</option>                           \
</select> entries',},
                        'bAutoWidth': false,
                        'sDom': "<'row'<'span8'l><'top'i>r>t<'row'<'bottom'i><'span8'p>>"
                        'fnServerParams': function (aoData) {
                            var sEcho = aoData[0].value;
                            if ('1' == sEcho) {
                                var params = <?=json_encode(Session::read(${CTL_DATAID}))?>;
                                if (! $.isEmptyObject(params)) {
                                    aoData.length = 0; // empty array
                                    $.each(params, function(name, value) {
                                        aoData.push({'name': name, 'value': value});
                                    });
                                }
                            }
                        },
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T08:49:39.953

对于我的问题，我没有直接的解决方案，但是因为它是为了保存 DataTable 的状态，所以我遇到了可以完成这项工作的 bStateSave 选项。

# ruby-on-rails - 如何使用我的网站图标修复此错误？

> ID：11510251
> 
> 赞同：1
> 
> 时间：2012-07-16T18:24:46.470
> 
> 标签：ruby-on-rails

在我的 rails 应用程序中，我删除了通用文件 favicon.ico 并将其替换为特定于我正在开发的应用程序的 favicon，其名称为 1.ico。在我的应用程序布局文件的头部，我插入了以下代码：

```
<link rel="shortcut icon" href="/1.ico" type="image/ico" /> 
```

当我在本地环境中打开我的应用程序时，网站图标不可见，并且我在终端中收到以下响应：

在 2012-07-16 13:33:22 -0400 ActionController::RoutingError 开始为 127.0.0.1 获取“/public/favicon.ico”（没有路由匹配 [GET]“/public/favicon.ico”）：

我不确定如何解决这个错误，所以任何帮助都会很棒！我意识到有很多与网站图标相关的问题，但在进行研究后，我没有找到任何有帮助的问题或答案。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T10:08:05.907

您传递给 favicon_link_tag 的路径可能不正确。如果您的 favicon 在公共目录中，则要传递 '/path/from/public/favicon.ico'，但如果它在资产目录中，则要传递 'path/from/assets/favicon.ico'。请注意，开头没有斜线

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:33:54.200

尝试删除之前的斜线符号`1.ico`。

```
<link rel="shortcut icon" href="1.ico" type="image/ico" /> 
```

**编辑**

尝试使用[Favicon Rails](http://apidock.com/rails/ActionView/Helpers/AssetTagHelper/favicon_link_tag)助手：

```
<%= favicon_link_tag '1.ico' %> 
```

# java - Java中的Parallel.For？

> ID：11510254
> 
> 赞同：1
> 
> 时间：2012-07-16T18:24:55.423
> 
> 标签：java, parallel-processing

> **可能重复：**
> [Java 的“Parallel.For”？](https://stackoverflow.com/questions/4010185/parallel-for-for-java)

.NET 有 Parallel.For，它允许您并行运行 for 循环，而无需直接使用线程。

[详情在这里](http://msdn.microsoft.com/en-us/magazine/cc163340.aspx)

Java中有类似的东西吗？我发现了完全相同的问题（[Here](https://stackoverflow.com/questions/4010185/parallel-for-for-java)），但是在最新版本的 java 出现之前就有人问了，它声称有：

“JSR 166 下的并发实用程序”

那么，他们放了什么东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:50:13.983

虽然可以建议 Parallel.For 类似于 ExecutorService.submit，但我怀疑它不是。

```
public static void main(String... args) throws InterruptedException {
    long start1 = System.nanoTime();
    int runs1 = 1000;
    final int[] a = new int[100];
    for (int j = 0; j < runs1; j++) {
        for (int i = 0; i < 100; i++) {
            a[i] = a[i] * a[i];
        }
    }
    long time1 = System.nanoTime() - start1;
    System.out.printf("Each loop took an average of %,d micro-seconds%n", time1 / runs1 / 1000);

    int processors = Runtime.getRuntime().availableProcessors();
    long start2 = System.nanoTime();
    ExecutorService executor = Executors.newFixedThreadPool(processors);
    for (int j = 0; j < runs1; j++) {
        for (int i = 0; i < 100; i++) {
            final int i2 = i;
            executor.submit(new Runnable() {
                public void run() {
                    a[i2] = a[i2] * a[i2];
                }
            });
        }
    }
    executor.shutdown();
    executor.awaitTermination(1, TimeUnit.SECONDS);
    long time2 = System.nanoTime() - start2;
    System.out.printf("Parallel: Each loop took an average of %,d micro-seconds%n", time2 / runs1 / 1000);
} 
```

印刷

```
Each loop took an average of 2 micro-seconds
Parallel: Each loop took an average of 149 micro-seconds 
```

这表明在这个例子中，使用多线程是一个**非常糟糕的主意**。所以我希望循环效率更高一些

```
 for (int j = 0; j < runs1; j++) {
        for (int i = 0; i < processors; i++) {
            final int i2 = i;
            executor.submit(new Runnable() {
                public void run() {
                    for (int i3 = i2 * 100 / processors; i3 < (i2 + 1) * 100 / processors && i3 < 100; i3++)
                        a[i2] = a[i2] * a[i2];
                }
            });
        }
    } 
```

印刷

```
Parallel: Each loop took an average of 28 micro-seconds 
```

如果您认为 Runnable 中的代码不是线程安全的，我怀疑 Parallel.For 做了一些完全不同或毫无意义的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:34:01.220

Java 8 中应该包含 Fork/Join 框架，以及 lambdas/closures... 就在最近，Java Champion 之一 Angelika Langer 就该主题发表了一场精彩的演讲

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:34:09.707

我的并行计算教授 Alan Kaminsky 和他的一群研究生编写了一个库，其中包含您需要的功能。

Javadocs、许可证、下载，甚至一本免费书籍都包含在信息页面上。

它是 GNU GPL 版本 3 下的自由软件。

[并行 Java 2 库](http://www.cs.rit.edu/~ark/pj2.shtml)

# heroku - 在 Heroku 上部署 Play 2.0.2 应用程序

> ID：11510256
> 
> 赞同：3
> 
> 时间：2012-07-16T18:25:03.100
> 
> 标签：heroku, playframework-2.0

我正在尝试在 Heroku 上部署一个全新的应用程序。它是使用 Play 制作的！框架 2.0.2。

我按照此页面的所有步骤操作：[https ://github.com/playframework/Play20/wiki/ProductionHeroku](https://github.com/playframework/Play20/wiki/ProductionHeroku)

但是当我部署它时，出现以下错误

```
> -----> Heroku 接收推送
    -----> 玩！检测到应用
    -----> 警告：玩！在 dependencies.yml 中未指定版本。默认版本
    : 1.2.4 正在使用....
    -----> 安装播放！1.2.4……
    -----> 完成
    -----> 安装 ivysettings.xml ..... 完成
    -----> 建筑游戏！应用...
           ~ _ _
           ~ _ __ | | __ _ _ _| |
           ~ | '_ \| |/ _' | || |_|
           ~ | __/|_|\____|\__ (_)
           ~ |_| |__/
           ~
           ~玩！1.2.4，http://www.playframework.org
           ~
           1.2.4
           建设游戏！目录中的应用程序 ./
           解决依赖关系： .play/play 依赖关系 ./ --forProd --forceCopy
    --silent -Duser.home=/tmp/build_2g0tyg50mwz8m 2>&1
           ~！！/tmp/build_2g0tyg50mwz8m/conf/dependencies.yml 不存在
           ~
           ~ 完成！
           ~
           预编译：.play/play 预编译 ./ --silent 2>&1
           〜哎呀。conf/routes 或 conf/application.conf 丢失。
           ~ /tmp/build_2g0tyg50mwz8m 似乎没有托管有效的应用程序。
           ~
     ！无法构建 Play！应用
     ！清除播放！来自缓存的框架
     ！Heroku push 被拒绝，无法编译 Play！应用程序`

```

所以它要求我在 dependencies.yml 定义版本。但是，如果在新版本的框架中没有这样的文件，我怎么能这样做呢？

我发现一个人说他通过将整个框架上传到 Heroku 来解决这个问题。但这对我来说似乎不正确。

有什么想法可以解决这个问题吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:18:53.200

确保您的项目位于 git 存储库的根目录中。

你也可以试试：

```
heroku config:add BUILDPACK_URL=https://github.com/heroku/heroku-buildpack-scala.git 
```

这将迫使 Heroku 使用 Play 2 buildpack。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:26:19.557

这是默认 buildpack 中的一个错误。我在这里记录了一个问题[https://github.com/heroku/heroku-buildpack-play/issues/17](https://github.com/heroku/heroku-buildpack-play/issues/17)

目前，詹姆斯的解决方案是一个很好的解决方法。

# c# - 如何验证正在添加到作为集合的属性的项目？

> ID：11510266
> 
> 赞同：0
> 
> 时间：2012-07-16T18:25:45.313
> 
> 标签：c#, .net

好的，我们有一个包含属性的类 Ticket：

```
List<TaskComment> Comments; 
```

我设置了一个 back 属性，以便我可以进行一些验证：

```
private List<TaskComment> _comments;
public List<TaskComment> Comment
{
   get
   { //stuff }
   internal set
   { //stuff }
} 
```

尽管将 set 设置为 internal，Add() 方法仍然暴露在程序集之外。但无论如何，我想要做的是在评论对象被添加到集合时设置它的 ticketId 属性。例如：

```
var ticket = new TaskTicket();
var comment = new TaskComment { //initializers }
ticket.Comments.Add(comment);

--inside the ticket:
public List<TaskComment> Comments
{
   get{ //stuff }
   set
   {
      ((TaskComment)value).TicketId = this._ticketId;
   }
} 
```

但这行不通。它告诉我它不能从 TaskComment 转换为 MyLibrary.TaskComment。这对我来说真的没有任何意义。但除此之外，这无论如何都感觉不对。那么在将传入的值/对象添加到类的集合之前，我究竟该如何修改呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:28:33.003

`Collection`以只读方式公开：

```
public IReadOnlyCollection<TaskComment> Comments
{
   get { return new ReadOnlyCollection(_comments); }
} 
```

使用以前的实现`_comments`现在向调用者公开。允许客户端添加/删除您要实现的项目`Add`以及`Remove`从内部列表中添加/删除的成员。

```
public void Add(Comment comment)
{
    /* code */
    _comments.Add(comment);
}

public void Remove(Comment comment)
{
    /* code */
    _comments.Remove(comment);
} 
```

或者，您可以[实现自己](http://msdn.microsoft.com/en-us/library/5y536ey6.aspx) 的，为您的和方法`IList`提供正确的实现。`Add``Remove`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:30:23.790

没有办法*限制*公开的 esposed`List<T>`课程。如果你`List<T>`在你的应用程序中没有过多地使用 ponetial，我建议你只包装那个列表。

说：

```
pulbic void AddComment(TaskComment task)
{
    /*Some validation on task parameter*/

    taskComments.Add(task);
} 
```

并从财产或整个财产本身中删除公共`get`访问者（**如果*可能的话）`Comments`

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:36:09.353

您的 setter 中的值对象将是 List 类型，因此当您将其转换为 TaskComment 类型时，它会引发错误。在您的代码中，您可以这样做

```
var comment = new TaskComment { //initializers } 
comment.TicketId = ticket.TicketId; //where TicketId is a public property for _ticketId
ticket.Comments.Add(comment); 
```

或者您可以重载 Add() 方法以将评论添加到 Comment 集合

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:59:50.390

将私有字段保留为列表，但更改您的属性，使其为只读且为 IEnumerable。然后像其他人建议的那样实现一个特定的 Add 方法来访问私有字段。这样，您的调用者可以自由地遍历集合，但必须使用 add 方法来添加它，给您一个验证的地方，等等，并抛出异常或返回成功代码。

返回具体的集合类型会限制您对未来更改的选择。然而，返回一个接口允许您更改底层集合，而不影响调用者。

当 List 具有隐式 IEnumerable 支持时，新建 ReadOnlyCollection 似乎很浪费。*

# windows-8 - 升级 windows 8 后无法捕捉

> ID：11510268
> 
> 赞同：1
> 
> 时间：2012-07-16T18:25:58.637
> 
> 标签：windows-8, microsoft-metro, windows-runtime

从 CP 更改为 RP windows 8 后，我无法再使用快照视图了。有人知道这个问题吗？好像 Virtualstate 没有响应

```
<Page x:Name="pageRoot"
    x:Class="World_Clock.MainPage"
    IsTabStop="false"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:World_Clock"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Viewbox x:Name="viewbox" HorizontalAlignment="Left" Height="auto" VerticalAlignment="Top" Width="auto" Stretch="UniformToFill">

        <ScrollViewer HorizontalAlignment="Left" Height="764" VerticalAlignment="Top" Width="1353" VerticalScrollMode="Disabled" IsVerticalRailEnabled="False">

            <Grid x:Name="maingrid" Height="auto" Width="auto">
                <Grid.Background>
                    <ImageBrush ImageSource="Assets/wp2.png" Stretch="UniformToFill"/>
                </Grid.Background>
                <Rectangle HorizontalAlignment="Left" Height="134" Margin="1025,358,0,0" VerticalAlignment="Top" Width="204" Fill="#FFCCE1CC"/>
               etc...
                </Grid>
<Image x:Name="image" HorizontalAlignment="Left" Height="768" VerticalAlignment="Top" Width="324" Source="Assets/Logo.png" Stretch="UniformToFill" Grid.RowSpan="2" Margin="1464,0,-422,0"/>

            </Grid>

        </ScrollViewer>
    </Viewbox>

<VisualStateManager.VisualStateGroups>
        <VisualStateGroup x:Name="ApplicationViewStates">
            <VisualState x:Name="Portrait">
                <Storyboard>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="grid1" Storyboard.TargetProperty="Margin">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="70,500,0,0"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="grid2" Storyboard.TargetProperty="Margin">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="48,900,0,-164"/>
                    </ObjectAnimationUsingKeyFrames>
                </Storyboard>
            </VisualState>

<VisualState x:Name="Snapped">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="image" Storyboard.TargetProperty="Margin">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="0,0,0,0"/>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
        </VisualStateGroup>

    </VisualStateManager.VisualStateGroups>

</Page> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:32:42.347

好消息！

测试了您的 XAML 和应用程序快照

```
<Page
x:Class="App4.MainPage"
IsTabStop="false"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="using:App4"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d">

<Viewbox x:Name="viewbox" HorizontalAlignment="Left" Height="auto" VerticalAlignment="Top" Width="auto" Stretch="UniformToFill">
    <ScrollViewer HorizontalAlignment="Left" Height="764" VerticalAlignment="Top" Width="1353" VerticalScrollMode="Disabled" IsVerticalRailEnabled="False">
        <Grid x:Name="maingrid" Height="auto" Width="auto" Background="white">
            <Rectangle HorizontalAlignment="Left" Height="134" Margin="1025,358,0,0" VerticalAlignment="Top" Width="204" Fill="#FFCCE1CC"/>
        </Grid>
    </ScrollViewer>
</Viewbox>

<VisualStateManager.VisualStateGroups>
    <VisualStateGroup x:Name="ApplicationViewStates">
        <VisualState x:Name="Portrait">
            <Storyboard>
                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="grid1" Storyboard.TargetProperty="Margin">
                    <DiscreteObjectKeyFrame KeyTime="0" Value="70,500,0,0"/>
                </ObjectAnimationUsingKeyFrames>
                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="grid2" Storyboard.TargetProperty="Margin">
                    <DiscreteObjectKeyFrame KeyTime="0" Value="48,900,0,-164"/>
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
        </VisualState>

        <VisualState x:Name="Snapped">
            <Storyboard>
                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="image" Storyboard.TargetProperty="Margin">
                    <DiscreteObjectKeyFrame KeyTime="0" Value="0,0,0,0"/>
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
        </VisualState>
    </VisualStateGroup>
</VisualStateManager.VisualStateGroups> 
```

会不会是你的分辨率太低了？检查分辨率，我相信捕捉功能在 1366 以下不起作用。

祝你好运！让我知道它是怎么回事以及问题是什么！

# css - html - 如何使用自动宽度进行滚动？

> ID：11510286
> 
> 赞同：4
> 
> 时间：2012-07-16T18:27:03.637
> 
> 标签：css, html, width, scrollbar

我有一个包含大量内容的 div，并尝试将宽度设置为父元素的 100%。这个 div 也使用填充，所以我认为我应该将宽度设置为自动。但由于某种原因，它总是扩展超过父宽度。我什至将溢出设置为滚动。

我想要的是 div 有一个滚动条（仅水平），它的宽度适合父宽度。

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:37:37.490

**其父级的 100% 宽度，带填充：**

鉴于您提到的填充应用于 100% 宽的元素，问题出在浏览器使用的[盒子模型](http://www.w3.org/TR/CSS2/box.html)中。如果你应用 100% 的宽度和一些填充，元素将得到`width + padding`它的完整宽度，从而导致它变得太大。有几种方法可以解决这个问题：

1.  CSS3 引入了一个名为 的新属性[`box-sizing`](https://developer.mozilla.org/En/CSS/Box-sizing)，通过将其设置为`border-box`，填充将添加到元素的给定宽度内，而不是添加到宽度导致元素变得“变大”。（请注意旧版浏览器缺乏支持）。

2.  我相信可以使用`left: 0; right: 0;`而不是使用`width: 100%;`. 在这种情况下，您可以添加填充，而元素不会变宽。

*实践中的第二种选择：*

```
<!-- The markup -->
<div class="parent">
    <div class="child">Child</div>
</div>​

/* The CSS */
.parent {
    width: 200px;
    height: 200px;
    position: relative;
    background-color: #666;
}

.child {
    position: absolute;
    left: 0;
    right: 0;
    padding: 10px;
    background-color: #888;
}
​ 
```

*这是第二个选项的工作示例：http: [//jsfiddle.net/mGLRD/](http://jsfiddle.net/mGLRD/)*

**水平滚动条：**

要获得水平滚动条，您必须查看[`overflow-x`](https://developer.mozilla.org/en/CSS/overflow-x)CSS 属性。通过将其设置为`scroll`，当没有要滚动的内容时，您将看到一个禁用的滚动条，因此滚动条始终可见。您的另一个选项是将其设置为`auto`，如果需要，滚动条将在该位置可见（可能因不同浏览器而异）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:33:36.103

尝试：

```
div#content {
    width:auto;
    padding:20px;
    overflow-x:auto;
} 
```

看我的演示：http: [//jsfiddle.net/HRRsU/3/](http://jsfiddle.net/HRRsU/3/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-11-05T09:49:59.620

```
box-sizing: border-box;
-webkit-box-sizing: border-box;
-moz-box-sizing: border-box; 
```

[http://www.w3schools.com/cssref/css3_pr_box-sizing.asp](http://www.w3schools.com/cssref/css3_pr_box-sizing.asp)

# javascript - 查找 div ID 并使用 jQuery 调用关联的 Javascript 变量

> ID：11510289
> 
> 赞同：1
> 
> 时间：2012-07-16T18:27:15.527
> 
> 标签：javascript, jquery, variables

我有几张鱼图片，在链接中，像这样列出......

```
<a href="#" class="trigger"><img src="img/fish1.png" id="fish1"/></a>
<a href="#" class="trigger"><img src="img/fish2.png" id="fish2"/></a> 
```

我想获取 id 'fish1'、'fish2' 等。（基于单击），并使用变量替换某些文本。

变量的名称是...

```
var fish1Hunger
var fish2Hunger 
```

我想用变量调用的函数是......

```
$(function() {
    $('a.trigger').click(function() {
        $('#popUp h3').html(REPLACE WITH VARIABLE ASSOCIATED WITH THE FISH);
    });
}); 
```

如何调用与 IMG id 关联的变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:29:16.200

`window[e.srcElement.id+"Hunger"];`

把它放在你的点击事件中，`e`作为事件（`function (e){...`），只要它在全局范围内，它就应该访问变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:32:36.493

## *[jsBin 演示](http://jsbin.com/anukig/3/edit)*

```
var fish1Hunger = "Fish 1 is hunger!! Feed him!"
var fish2Hunger = "Fish 2 is hunger!! Feed him!"

$('a.trigger').click(function (e) {
    e.preventDefault();
    var ImLookingFor = $(this).find('img').attr('id')+'Hunger';
    $('#popUp h3').html(eval(ImLookingFor));          
}); 
```

# android - 图层列表可绘制 - 按九个补丁剪辑位图？

> ID：11510292
> 
> 赞同：0
> 
> 时间：2012-07-16T18:27:30.057
> 
> 标签：android, bitmap, drawable, nine-patch

我想创建`Drawable`一个包含`nine-patch`和一个`Bitmap`.

我将它们放在 Layer List Drawable 中，但事实证明它`Bitmap`超出`nine-patch`了边缘。

有什么办法可以“剪裁”`Bitmap`以免重叠`nine-patch`？

编辑：实际上，我似乎想缩小背景以包装内容并在背景中引入大位图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T06:36:03.670

根据定义，九个补丁没有大小。

从你没有正确配置你的九个补丁的声音来看。

请附上您所看到的图像和源文件。

# html - CSS，显示属性（菜单栏）

> ID：11510294
> 
> 赞同：0
> 
> 时间：2012-07-16T18:27:44.017
> 
> 标签：html, css, inline, block

我正在尝试理解 html/css 菜单栏，而我的问题出在 display 属性上，

我对这个属性非常了解，但是如果你看一下这个[Link](http://www.dynamicdrive.com/style/csslibrary/item/matt_black_tabs/)，只是一个简单的菜单栏，但问题是我不明白为什么 css 样式的 li 标签和 a 标签在其中包含显示属性当浮动完成工作并且您可以删除它们并且菜单看起来相同时，我知道在两种标签样式中都有显示属性的原因，但我不明白，如果有人可以帮助我了解为什么显示属性在 li css 样式中具有 inline 的值，而在 css 样式的 li a 具有块的值，并且再次不是我不知道这个属性，只是我不明白为什么它在那里，谢谢大家，祝你有美好的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:37:25.920

`display:inline`在 li's 中使用的是使 li 水平或并排对齐。

`display:block`在 li a 中使用，因此 a 应该完整地使用 li，这样如果您单击 li 内的任何位置，该`<a>`标签将起作用，并且不仅会在单击文本时起作用。

# sql - SELECT 使用 GROUP BY 并且 HAVING 不返回记录

> ID：11510298
> 
> 赞同：0
> 
> 时间：2012-07-16T18:28:02.160
> 
> 标签：sql, sql-server, tsql

我正在尝试选择在 LASTNAME 列中具有重复值的所有记录。到目前为止，这是我的代码

```
If EXISTS( SELECT name FROM sysobjects WHERE name = 'USER_DUPLICATES' AND type = 'U' ) 
    DROP TABLE USER_DUPLICATES
GO

CREATE TABLE USER_DUPLICATES
(
    FIRSTNAME VARCHAR(MAX),
    LASTNAME VARCHAR(MAX),
    PHONE VARCHAR(MAX),
    EMAIL VARCHAR(MAX),
    TITLE VARCHAR(MAX),
    LMU VARCHAR(MAX)
)
GO

INSERT INTO USER_DUPLICATES
(
    FIRSTNAME,
    LASTNAME,
    PHONE,
    EMAIL,
    TITLE,
    LMU
)
SELECT
    FIRSTNAME,
    LASTNAME,
    PHONE,
    EMAIL,
    TITLE,
    LMU
FROM TM_USER
GROUP BY
    FIRSTNAME,
    LASTNAME,
    PHONE,
    EMAIL,
    TITLE,
    LMU
HAVING COUNT(LASTNAME) > 1 
```

它不返回任何记录。我改变了

```
HAVING COUNT(LASTNAME) > 1 
```

到

```
HAVING COUNT(LASTNAME) > 0 
```

它返回所有记录。我也确定有些记录具有相同的 LASTNAME 值。它是在 SQL Server 上使用 T-SQL 编写的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:40:45.357

试试这个：

```
SELECT
    a.FIRSTNAME,
    a.LASTNAME,
    a.PHONE,
    a.EMAIL,
    a.TITLE,
    a.LMU
FROM TM_USER a
INNER JOIN
(
    SELECT LASTNAME
    FROM TM_USER
    GROUP BY LASTNAME
    HAVING COUNT(1) > 1
) b ON a.LASTNAME = b.LASTNAME 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:43:23.423

您的 Group By 子句将按列表中的所有社区分组。这些列可能定义了 count = 1 的谨慎记录

您将需要执行以下操作：

```
Select LAST_NAME from TM_USER  GROUP BY LAST_NAME HAVING COUNT(LAST_NAME) > 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:44:59.007

COUNT 函数是针对所有分组表达式计算的，而不是针对 LASTNAME。

要获得唯一的姓氏，请使用

```
SELECT LASTNAME FROM TM_USER GROUP BY LASTNAME HAVING COUNT(LASTNAME) > 1 
```

如果您按几列分组，即使在单列值上计算 COUNT，您也会得到它们唯一组合的计数。

# linux - 无法在打开的 cv 中运行 stipdet

> ID：11510301
> 
> 赞同：0
> 
> 时间：2012-07-16T18:28:08.590
> 
> 标签：linux, opencv

我正在尝试在 Ubuntu 上运行一些预编译代码（源代码不可用），这需要安装 openCV。我昨天安装了最新版本的openCV（来自SVN），并根据openCV网站上的debian安装指南（cmake -> make -> sudo make install）安装了它，一切似乎都很好。

我试图运行 stipdet 程序，但这给了我以下错误。

**bash: ./stipdet: 无法执行二进制文件**

请问谁能帮我解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:04:49.240

有什么作用：

```
file $(which stipdet) 
```

...说？我猜它是为你没有的 CPU 构建的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-13T01:28:57.913

您需要运行`chmod 755 ./stipdet`以使 stipdet 可执行。

# c# - 如何调试无法重现的错误？

> ID：11510305
> 
> 赞同：3
> 
> 时间：2012-07-16T18:28:20.850
> 
> 标签：c#, asp.net, debugging

现在我的一个 asp.net 应用程序的使用率显着上升，出现了两个非常罕见的奇怪问题，而且我无法重现。

我不知道如何调试和解决这些问题。

这里有两个例子：

`!IsPostBack`我的一个 aspx 页面在(is `true`)上将会话状态值重置为 0 。但是，我在特定位置的一个用户经常会在该页面不是回发并且会话状态值没有在他的笔记本电脑上重置时访问该页面。（我的声明基于应用程序随后的行为，而不是在调试模式下运行）但是当我坐在他旁边使用相同的浏览器在我的笔记本电脑上运行应用程序时，代码有效并且会话状态在我的笔记本电脑上重置同时在同一个互联网连接上。当这个用户在家中在他的笔记本电脑上运行应用程序时，他有更好的互联网连接，他不会经常遇到问题。

我的应用程序中的一个 aspx 页面在运行将数据保存到`DB`. 几乎在 server.transfer 之后的所有时间，文本框都包含它们的默认值（因为它们应该自 以来`!isPostback==True`），但大约 1% 的时间文本框包含先前的值。我知道由于数据已保存，因此与服务器进行了往返。此问题发生在相同用户使用相同浏览器执行相同操作的相同电脑上。所以 99% 的时间它可以正常工作，而 1% 的时间他们做完全相同的事情却不能正常工作。

如果这些问题似乎是随机发生的，我该如何开始尝试找出导致这些问题的原因？

我怀疑互联网连接的质量是问题所在，因为它是一个正在发生变化的变量，但这些信息对我有什么帮助？

我不能通过在调试模式下运行我的应用程序来调试这些问题中的任何一个。

我正在使用`Asp .Net 3.5`，`C# 3.5`并且该应用程序在`IE 6-8`. （`IE 8`在兼容模式下）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T18:33:09.130

我会将日志记录添加到发生问题的代码中。然后通知有问题的用户尝试并记下他们遇到问题的时间。获得日志和大致时间后，您可以进入并倒在这些日志上，看看是否有任何东西指向正确的方向。我还会查看服务器上的 IIS 和事件日志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:31:27.650

您可以安装[Firefox Throttle](http://firefox-throttle.en.softonic.com/)插件来模拟慢速连接。在 ASP.NET 中可能会发生很多页面加载缓慢的情况。如果页面没有完全加载但项目是可点击的，ASP.NET 可能会对事件验证感到非常不安......等等

此外，我鼓励您开始记录和跟踪应用程序中的问题区域。然后，您可以将其与 IIS 请求日志关联起来，并相当准确地了解发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:37:32.153

看来您在使用[Session State](http://msdn.microsoft.com/en-us/library/ms178586.aspx)时遇到问题。默认情况下，ASP.NET 使用 InProc 会话状态模式，该模式使用服务器内存来存储值。在许多情况下，这可能会丢失或重置（应用程序池回收）。切换到[SQLServer 会话状态](http://support.microsoft.com/kb/317604)可能会帮助您解决问题。

# php - 用抽象方法继承 php

> ID：11510311
> 
> 赞同：0
> 
> 时间：2012-07-16T18:28:27.160
> 
> 标签：php

我尝试从抽象类继承到抽象类：

```
abstract class Android{
    public $description="unknown brand";
    public function __construct() {

    }
    public function get_description(){
        return $this->description;
    }    
    public abstract function cost();
}

abstract class FeaturesDecorator extends Android {
    public abstract function get_description();
} 
```

我收到此错误：

> 致命错误：无法在第 65 行的 C:\xampp\htdocs\jPlugin\DesignPatterns\Decorator\Decorator.php 中的类 FeaturesDecorator 中制作非抽象方法 Android::get_description() 抽象

为什么？什么破坏了遗产？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:30:25.153

该函数`get_description`已在您的父类中定义和声明，您不能在子类中使其抽象。

# vba - 如何检查word文档是否已经打印

> ID：11510315
> 
> 赞同：1
> 
> 时间：2012-07-16T18:28:54.560
> 
> 标签：vba, ms-word, word-2003

我只想在文档已经打印的情况下启用另一个功能“代码”，我在想一些类似的东西

```
Sub Testing
    Dim hasPrinted as boolean
    If ActiveDocument.PrintOut = True Then
        hasPrinted = True
        call code here...
    Else
        hasPrinted = False
        MsgBox "Please Print Before Adding"
    End If
End Sub 
```

我在“ActiveDocument.PrintOut”行收到一条错误消息，显示“编译错误、预期的函数或变量”。谁能给我一些指示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:18:18.853

在 Word VBA 中捕获打印事件并非易事。然而，这是一个巧妙的技巧:)

为此，请执行以下操作

创建一个类模块说`Class1`并粘贴此代码

```
Option Explicit

Public WithEvents oApp As Word.Application

Private Sub oApp_DocumentBeforePrint(ByVal Doc As Document, Cancel As Boolean)
    ActiveDocument.Bookmarks("DocWasPrinted").Delete
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DocWasPrinted"
        .DefaultSorting = wdSortByName
        .ShowHidden = True
    End With
End Sub 
```

现在插入一个模块并粘贴此代码

```
Option Explicit

Dim oAppClass As New Class1

Public Sub AutoExec()
    Set oAppClass.oApp = Word.Application
End Sub

Sub Testing()
    If hasPrinted = True Then
        MsgBox "Document was printed"
        '~~> Call your code
    Else
        MsgBox "Please Print Before Adding"
    End If
End Sub

Function hasPrinted() As Boolean
    If ActiveDocument.Bookmarks.Exists("DocWasPrinted") = True Then
        hasPrinted = True
    End If
End Function 
```

关闭您的文档并重新打开它。现在测试一下。

**逻辑：**

这段代码所做的是用户打印文档的那一刻，代码创建了一个名为的隐藏书签`DocWasPrinted`，在我的代码中，我检查是否创建了书签。

请记住删除文档退出上的书签。

```
Private Sub Document_Close()
     ActiveDocument.Bookmarks("DoWasPrinted").Delete
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:09:44.997

[此问题](https://stackoverflow.com/questions/1155970/is-there-a-documentafterprint-event-in-ms-word)提供有关在打印后创建临时文档事件的信息。

完成此操作后，您可以将布尔值更新为 true 以指示文档已打印。Word 不会以本机方式存储此信息。

# php - PHP Mysql 不区分大小写的表选择

> ID：11510316
> 
> 赞同：2
> 
> 时间：2012-07-16T18:29:01.957
> 
> 标签：php, mysql

我正在尝试检测数据库中的表是否已经存在。但是，我编写的以下代码似乎区分大小写。如果表名是 Test 并且 $name = TEST。下面的代码将不正确。有什么办法可以使这种情况变得不敏感？或者也许有更有效的方法？

```
if(mysql_num_rows(mysql_query("SHOW TABLES LIKE '$name'")) == 1) {
    ....
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:00:45.687

确保检查**lower_case_table_names**系统变量的值。默认值是根据您的操作系统分配的：

*   0 - UNIX/Linux

*   1 - 窗户

*   2 - 麦克

根据[MySQL 文档](http://dev.mysql.com/doc/refman/5.1/en/identifier-case-sensitivity.html)：

> *   0 - 表和数据库名称使用 CREATE TABLE 或 CREATE DATABASE 语句中指定的字母大小写存储在磁盘上。名称比较区分大小写。如果您在具有不区分大小写文件名的系统（例如 Windows 或 Mac OS X）上运行 MySQL，则不应将此变量设置为 0。如果在不区分大小写的文件系统上使用 --lower-case-table-names=0 将此变量强制为 0，并使用不同的字母大小写访问 MyISAM 表名，则可能会导致索引损坏。
>     
>     
> *   1 - 表名以小写形式存储在磁盘上，并且名称比较不区分大小写。MySQL 在存储和查找时将所有表名转换为小写。此行为也适用于数据库名称和表别名。
>     
>     
> *   2 - 表和数据库名称使用 CREATE TABLE 或 CREATE DATABASE 语句中指定的字母大小写存储在磁盘上，但 MySQL 在查找时将它们转换为小写。名称比较不区分大小写。这仅适用于不区分大小写的文件系统！InnoDB 表名以小写形式存储，如 lower_case_table_names=1。

当然，您可以更改**lower_case_table_names**的值，但您需要导出/导入数据才能影响当前的数据库表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:41:08.993

```
$name = "table_name";
$result = mysql_list_tables("mydb");
$num_rows = mysql_num_rows($result);
for ($i = 0; $i < $num_rows; $i++) {
    if (strtolower(mysql_tablename($result, $i)) == strtolower($name)) {
        echo "Table detected";

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T18:33:53.390

抱歉，无法使用该语法完成。您必须执行以下操作：

```
SELECT `TABLE_NAME`
FROM `INFORMATION_SCHEMA`.`TABLES`
WHERE `TABLE_CATALOG` IS NULL
AND `TABLE_SCHEMA` = 'yourdatabasename'
AND `TABLE_NAME` LIKE 'yourtablename' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:50:40.507

感谢您的回答，但似乎我已经回答了我自己的问题。我将使用 strtolower() 将所有表存储为小写

接着：

```
$LowerName = strtolower($name);
if( mysql_num_rows( mysql_query("SHOW TABLES LIKE '$LowerName'")) == 1)
{
   ....
} 
```

# java - 获取单个单元格值的sql语句

> ID：11510320
> 
> 赞同：2
> 
> 时间：2012-07-16T18:29:12.800
> 
> 标签：java, hibernate

我需要从表中获取单个单元格值。我正在将休眠与 Spring MVC 一起使用。

我做的是：

```
Session s = getSessionFactory().getCurrentSession();  
query q= s.createQuery("select xxx from abc where asd=:asd"); 
```

现在，我需要将这个单个值保存到一个字符串变量中，并且需要使用这个字符串变量与使用`<c:choose> <c:when> <c:otherwise>`标签的jsp页面中的其他字符串进行比较......

这就是我现在所拥有的。。

```
@Transactional
public String getUseNis(String code) {
Session s = getSessionFactory().getCurrentSession();
Query q = s.createQuery("select useNis from tle_location where code = :code");
q.setString("code", code);
String result = (String) q.uniqueResult();
return result; 
```

我需要在jsp页面中使用返回值来检查是或否...如何将它传递给我的jsp页面..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T09:04:48.213

要获得单个结果，请使用`getFirstResult()`或`getSingleResult()`。**请注意**，由于以下原因，两者都不是特别有用：

*   调用`getFirstResult()`将返回查询返回的集合中的第一个元素，该元素可能是也可能不是您要查找的元素。
*   调用*期望*`getUniqueResult()`查询只返回 一项，如果返回的集合为空或有多个条目，则引发异常。

 *与 的插图[`uniqueResult()`](http://docs.jboss.org/hibernate/core/3.2/api/org/hibernate/Query.html#uniqueResult%28%29)。

```
//sessionFactory = getHibernateTemplate().getSessionFactory();
Session session = getSessionFactory().getCurrentSession();
Query query = session.createQuery("select value from table where ...");
query.setParameters("param1", value1);
result = (Type) query.uniqueResult(); //The type is you desired result type.
//test for null here if needed 
```

确保查询只返回一个**结果**。它将抛出`NonUniqueResultException`- 如果找到多个匹配结果（因此`query.setMaxResults(1);`会更合适）。

[http://www.java2s.com/Code/Java/Hibernate/UniqueResultHQL.htm](http://www.java2s.com/Code/Java/Hibernate/UniqueResultHQL.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:13:51.000

首先，您必须为 :asd 设置值，但这可能很清楚。

然后你去执行查询并转换结果。因为您似乎期望此查询返回单个值，所以可以通过[Query.uniqueResult](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/Query.html#uniqueResult%28%29)执行它。如果您想在假设一个且只有一个非空结果错误的情况下采取一些具体措施，请对返回的空值做出反应或相应地抛出[NonUniqueResultException](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/NonUniqueResultException.html)。

查询结果如何转换为字符串当然取决于`xxx`字符串表示的类型和首选格式。一些例子如下：

```
//type of xxx is already string
String result = (String) q.uniqueResult();

//type of xxx is Integer
Integer res = (Integer) q.uniqueResult();
String result = res.toString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T08:17:07.750

在控制器中写下面的代码

```
// Fetch the result by executing query and store it into string variable as
String typeofpayment = serviceObj.getValueFromDB();
model.addAttribute("typeofpayment",typeofpayment); // This will pass attribute to jsp page 
```

现在在jsp中你可以使用

```
<c:set var="typeOfPaymentVar" value="${typeofpayment}" scope="request" />
<c:choose>
     <c:when test='${typeOfPaymentVar=="cash"}'>
          CASH
     </c:when>
     <c:otherwise>
          OTHER MODE OF PAYMENT
     </c:otherwise>
</c:choose> 
```*

# android - 在android eclipse中从edittext检索文本到数组字符串

> ID：11510321
> 
> 赞同：0
> 
> 时间：2012-07-16T18:29:14.937
> 
> 标签：android

我正在制作文本到语音转换应用程序。我想从用户那里获取文本并将其更改为语音。当我对输入文本进行硬编码时。我的应用程序完美运行。

```
static final String[] texts = {"what's up dude"};
TextToSpeech tts;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main); 
    Button b = (Button)findViewById(R.id.btexttovoice);
    b.setOnClickListener(this);
    tts = new TextToSpeech(textvoice.this,new TextToSpeech.OnInitListener(){

        @Override
        public void onInit(int status) {
            // TODO Auto-generated method stub
            if(status!= TextToSpeech.ERROR)
            {
                tts.setLanguage(Locale.US);

            }
            }
            });
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    if(tts!= null)
    {
        tts.stop();
        tts.shutdown();
    }
    super.onPause();
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    Random r = new Random();
    String random = texts[r.nextInt(3)];
    tts.speak(random, TextToSpeech.QUEUE_FLUSH, null);
} 
```

它很好用，但如果我想通过编辑文本从用户那里获取输入，我会进行以下更改：

```
String[] texts ;
text = (EditText)findViewById(R.id.ttexttovoice);
texts = text.getText().toString(); 
```

在这里我得到错误，因为 texts 是数组类型。如何从编辑文本中获取文本到字符串的数组类型？如果我在没有数组字符串的情况下这样做

```
String texts ;
text = (EditText)findViewById(R.id.ttexttovoice);
texts = text.getText().toString(); 
```

我没有收到任何错误，但我没有找到所需的输出。事实上，没有收到任何声音。

这似乎是一个简单的问题，但我被困在这里。请帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:31:33.843

```
String[] texts = new String[3];
text = (EditText)findViewById(R.id.ttexttovoice);
texts[0] = text.getText().toString(); 
```

# ubuntu - 我的终端发生了一个奇怪的情况，相对于 texlive

> ID：11510323
> 
> 赞同：1
> 
> 时间：2012-07-16T18:29:31.393
> 
> 标签：ubuntu, latex, terminal

现在我发现当我打开终端时，它总是显示这些消息：

```
bash: /usr/local/texlive/2012/texmf/doc/man:: No such file or directory
bash: /usr/local/texlive/2012/texmf/doc/info:: No such file or directory 
```

我不知道哪里错了。即使我不确定我做了什么导致这种情况。我检查了texlive，它可以正常编译tex文件。

请告诉我终端中出现的消息是什么意思，我该如何取消它？

我的系统是 ubuntu 12.03 ，并安装了 texlive 2012。

我是否需要提供更多关于我的设置的信息来处理我的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:04:44.997

我自己解决了这个问题。

我发现一些关于texlive2012的代码`/etc/bash.bashrc`搞砸了。我修补了它们，现在这些消息消失了。

解决方案是将这些代码添加到`/etc/bash.bashrc`texlive 手册中的指南中。

`PATH=/usr/local/texlive/2012/bin/i386-linux:$PATH; export PATH`

`MANPATH=/usr/local/texlive/2012/texmf/doc/man:$MANPATH; export MANPATH`

`INFOPATH=/usr/local/texlive/2012/texmf/doc/info:$INFOPATH; export INFOPATH`

# java - Apache Commons Math 中使用 RealVectors 的平方欧几里得距离

> ID：11510325
> 
> 赞同：3
> 
> 时间：2012-07-16T18:29:38.527
> 
> 标签：java, math, apache-commons, linear-algebra, euclidean-distance

我在 Java 中使用 Apache Commons RealVector 和 ArrayRealVector 类。我可以计算两个向量 v1 和 v2 之间的欧式距离为

```
double dist = v1.getDistance(v2); 
```

但是，我正在寻找平方欧几里得距离。我知道有一种方法可以使用 Apache Commons Vector3D 来做到这一点 - 只需使用 distanceSq 函数。我正在使用高维向量进行最近邻搜索，因此没有必要取平方根——这对我的需求来说只是计算上的浪费。

我可以做

```
ArrayRealVector diff = v1.subtract(v2);
double dist = diff.dotProduct(diff); 
```

当然，这涉及返回一个我想避免的中间 ArrayRealVector。我可以很容易地编写代码来获得平方欧几里得距离，但我想使用 Apache Commons 数学的解决方案。任何内置的解决方案都会很棒——即使是其他 Apache Math 类的解决方案也可能没问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:49:03.270

看到这个：

[http://svn.apache.org/repos/asf/mahout/trunk/core/src/main/java/org/apache/mahout/common/distance/EuclideanDistanceMeasure.java](http://svn.apache.org/repos/asf/mahout/trunk/core/src/main/java/org/apache/mahout/common/distance/EuclideanDistanceMeasure.java)

这导致我：

[https://builds.apache.org/job/Mahout-Quality/javadoc/org/apache/mahout/common/distance/SquaredEuclideanDistanceMeasure.html](https://builds.apache.org/job/Mahout-Quality/javadoc/org/apache/mahout/common/distance/SquaredEuclideanDistanceMeasure.html)

我怀疑您是否想引入 Mahout 进行如此简单的计算，但您可能只需复制他们正在使用的任何代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:28:31.050

首先，我建议平方根和乘法的开销可能与许多其他事情相比相形见绌。以简单的名义，我会一直坚持下去，`dist * dist`直到你确定这是瓶颈。

`getDistanceSquared()`由于这个原因，几乎可以肯定没有；我会说这就是 API 想要你做的。

例如，分配另一个`RealVector`.

如果真的很重要，只需将代码复制到`getDistance()`并取出平方根！

# php - 如何检查经度/纬度点是否在坐标范围内？

> ID：11510326
> 
> 赞同：5
> 
> 时间：2012-07-16T18:29:38.037
> 
> 标签：php, math, geolocation, coordinates, latitude-longitude

我有许多构成多边形区域的经度和纬度坐标。我还有一个经度和纬度坐标来定义车辆的位置。如何检查车辆是否位于多边形区域内？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T18:51:52.000

这本质上是球体上的[多边形中的点问题。](http://en.wikipedia.org/wiki/Point_in_polygon)您可以修改光线投射算法，使其使用大圆弧而不是线段。

1.  对于构成多边形的每一对相邻坐标，在它们之间画一个大圆段。
2.  选择不在多边形区域内的参考点。
3.  画一个从参考点开始到车辆点结束的大圆。计算该线段跨越多边形线段的次数。如果总次数是奇数，则车辆在多边形内。如果是偶数，则车辆在多边形之外。

或者，如果坐标和车辆足够靠近，并且不在两极或国际日期变更线附近，您可以假装地球是平的，并使用经度和纬度作为简单的 x 和 y 坐标。这样，您可以将光线投射算法与简单的线段一起使用。如果您对非欧几里得几何体不满意，这是最好的选择，但是由于弧线会变形，因此您的多边形边界周围会有一些变形。

编辑：更多关于球体上的几何。

一个大圆可以通过垂直于圆所在平面的向量来识别（AKA，[法线向量](http://en.wikipedia.org/wiki/Normal_vector)）

```
class Vector{
    double x;
    double y;
    double z;
};

class GreatCircle{
    Vector normal;
} 
```

[任何两个不是对映](http://en.wikipedia.org/wiki/Antipodes)的纬度/经度坐标都共享一个大圆。要找到这个大圆，请将坐标转换为穿过地球中心的线。这两条线的[叉积](http://en.wikipedia.org/wiki/Cross_product)是坐标大圆的法向量。

```
//arbitrarily defining the north pole as (0,1,0) and (0'N, 0'E) as (1,0,0)
//lattidues should be in [-90, 90] and longitudes in [-180, 180]
//You'll have to convert South lattitudes and East longitudes into their negative North and West counterparts.
Vector lineFromCoordinate(Coordinate c){
    Vector ret = new Vector();
    //given:
    //tan(lat) == y/x
    //tan(long) == z/x
    //the Vector has magnitude 1, so sqrt(x^2 + y^2 + z^2) == 1
    //rearrange some symbols, solving for x first...
    ret.x = 1.0 / math.sqrt(tan(c.lattitude)^2 + tan(c.longitude)^2 + 1);
    //then for y and z
    ret.y = ret.x * tan(c.lattitude);
    ret.z = ret.x * tan(c.longitude);
    return ret;
}

Vector Vector::CrossProduct(Vector other){
    Vector ret = new Vector();
    ret.x = this.y * other.z - this.z * other.y;
    ret.y = this.z * other.x - this.x * other.z;
    ret.z = this.x * other.y - this.y * other.x;
    return ret;
}

GreatCircle circleFromCoordinates(Coordinate a, Coordinate b){
    Vector a = lineFromCoordinate(a);
    Vector b = lineFromCoordinate(b);
    GreatCircle ret = new GreatCircle();
    ret.normal = a.CrossProdct(b);
    return ret;
} 
```

两个大圆在球面上的两点相交。圆圈的叉积形成一个通过这些点之一的向量。该向量的对映点通过另一点。

```
Vector intersection(GreatCircle a, GreatCircle b){
    return a.normal.CrossProduct(b.normal);
}

Vector antipode(Vector v){
    Vector ret = new Vector();
    ret.x = -v.x;
    ret.y = -v.y;
    ret.z = -v.z;
    return ret;
} 
```

一个大圆段可以用穿过该段起点和终点的向量来表示。

```
class GreatCircleSegment{
    Vector start;
    Vector end;
    Vector getNormal(){return start.CrossProduct(end);}
    GreatCircle getWhole(){return new GreatCircle(this.getNormal());}
};

GreatCircleSegment segmentFromCoordinates(Coordinate a, Coordinate b){
    GreatCircleSegment ret = new GreatCircleSegment();
    ret.start = lineFromCoordinate(a);
    ret.end = lineFromCoordinate(b);
    return ret;
} 
```

[您可以使用点积](http://en.wikipedia.org/wiki/Dot_product)来测量大圆弧段的圆弧大小或任意两个向量之间的角度。

```
double Vector::DotProduct(Vector other){
    return this.x*other.x + this.y*other.y + this.z*other.z;
}

double Vector::Magnitude(){
    return math.sqrt(pow(this.x, 2) + pow(this.y, 2) + pow(this.z, 2));
}

//for any two vectors `a` and `b`, 
//a.DotProduct(b) = a.magnitude() * b.magnitude() * cos(theta)
//where theta is the angle between them.
double angleBetween(Vector a, Vector b){
    return math.arccos(a.DotProduct(b) / (a.Magnitude() * b.Magnitude()));
} 
```

您可以通过以下方式测试大圆段是否与大圆`a`相交`b`：

*   找到向量`c`，`a`的整个大圆的交点 和`b`。
*   找到向量`d`， 的对映点`c`。
*   如果在and`c`之间，或在and之间，则与 相交。`a.start``a.end``d``a.start``a.end``a``b`

```
//returns true if Vector x lies between Vectors a and b.
//note that this function only gives sensical results if the three vectors are coplanar.
boolean liesBetween(Vector x, Vector a, Vector b){
    return angleBetween(a,x) + angleBetween(x,b) == angleBetween(a,b);
}

bool GreatCircleSegment::Intersects(GreatCircle b){
    Vector c = intersection(this.getWhole(), b);
    Vector d = antipode(c);
    return liesBetween(c, this.start, this.end) or liesBetween(d, this.start, this.end);
} 
```

`a`如果满足以下条件，则两个大圆线段`b`相交：

*   `a``b`与整个大圆相交
*   `b``a`与整个大圆相交

```
bool GreatCircleSegment::Intersects(GreatCircleSegment b){
    return this.Intersects(b.getWhole()) and b.Intersects(this.getWhole());
} 
```

现在您可以构建多边形并计算参考线经过它的次数。

```
bool liesWithin(Array<Coordinate> polygon, Coordinate pointNotLyingInsidePolygon, Coordinate vehiclePosition){
    GreatCircleSegment referenceLine = segmentFromCoordinates(pointNotLyingInsidePolygon, vehiclePosition);
    int intersections = 0;
    //iterate through all adjacent polygon vertex pairs
    //we iterate i one farther than the size of the array, because we need to test the segment formed by the first and last coordinates in the array
    for(int i = 0; i < polygon.size + 1; i++){
        int j = (i+1) % polygon.size;
        GreatCircleSegment polygonEdge = segmentFromCoordinates(polygon[i], polygon[j]);
        if (referenceLine.Intersects(polygonEdge)){
            intersections++;
        }
    }
    return intersections % 2 == 1;
} 
```

# php - E_NOTICE：修复每个问题真的有用吗？

> ID：11510328
> 
> 赞同：5
> 
> 时间：2012-07-16T18:29:42.783
> 
> 标签：php, error-handling

首先，我知道这个问题在这里不止一次出现：

*   [为什么要修复 E_NOTICE 错误？](https://stackoverflow.com/questions/5073642/why-should-i-fix-e-notice-errors)
*   [为什么要修复 E_NOTICE 错误？优点和缺点](https://stackoverflow.com/questions/10077164/why-should-i-fix-e-notice-errors-pros-and-cons)

但是我修复所有 E_NOTICE 的次数越多（正如人们所说的那样），我越注意到：

*   我正在微优化
*   我实际上正在编写更多代码并使我的代码更难维护和更慢

举个例子：

假设您使用 MongoDB PHP 驱动程序，并且您有一个`MongoDate`在类中命名的类 var 中的对象，`ts`该类表示数据库中集合中的单行。现在你像这样访问这个变量：`$obj->ts->sec`但是 PHP 抛出一个 fit (E_NOTICE) 因为`ts`在这种情况下它本身没有定义为一个对象，因为这个特定的行没有一个`ts`字段。所以你认为这没问题，这是期望的行为，如果它没有设置返回 null 并且我会在解释器自己的机器人工作之外自己处理它（因为你将它包装在一个`date()`函数中，`1970`如果 var 是`null`或`none-object`）。

但是现在要修复那个 E_NOTICE，因为另一个开发人员真的希望我这样做，因为拥有任何 E_NOTICE 是非常糟糕的，并且它会使代码变慢而不是根据错误来执行它。`$obj`因此，我在名为的类中创建了一个新函数，`getTs`并给它 3 行，实际上什么都不做，只是检查`ts`var 是否是一个`MongoDate`对象，如果是则返回它......

为什么？PHP 不能在其更快的解释器中为我做到这一点，而不是在应用程序本身的运行时中做到这一点吗？我的意思是我必须在我的代码中添加无用的颠簸的每个地方，几乎是空函数来检测我实际上只是用 PHP 自己处理的变量，当我真正需要时返回`null`或检查它们`instanceof`（当它对操作和所述函数的行为）并且不要让我开始使用`isset()`s 我已经添加了大约 300 行`isset()`s，它已经失控了。我当然必须实现这个`getTs`功能，因为你不能这样做：

```
class obj{
    public $ts = new MongoDate();
} 
```

我要么必须将其存储`ts`在其中`__constructor`（我对此也不太满意，我正在使用很多魔法），要么使用一个函数来检测它是否已设置（我现在这样做）。

我的意思是我明白为什么我应该修复：

*   未定义的变量
*   分配未设置变量 ( `null`vars)的属性
*   不断的错误等

但是，如果您已经测试过您的代码并且您知道它是安全的并且只会按照您希望的方式工作，那么修复所有的`undefined index`or`none-object`错误有什么意义呢？在你的代码中添加一堆`isset()`s 和 2 行函数实际上不是微优化吗？

在使我的一半站点符合 E_NOTICE 后，我注意到实际上它现在使用了更多的 CPU、内存和时间……那么处理每个 E_NOTICE 错误而不仅仅是那些错误的真正意义何在？

谢谢你的想法，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T19:21:20.987

通过使用，您确实会*获得*更好的性能`isset()`。不久前，我做了一些基准测试，只是隐藏错误的速度大约慢了 10 倍。

[http://garrettbluma.com/2011/11/14/php-isset-performance/](http://garrettbluma.com/2011/11/14/php-isset-performance/)

也就是说，性能通常不是 PHP 的关键因素。什么*，**个人*让我发疯的是无声***的错误***。

当解释器选择不将某些内容标记为错误（可能导致不稳定）时，这是一个大问题。PHP 尤其倾向于

*   **警告应该****出错**的事情（例如无法连接到数据库）和
*   发出关于应该**警告**的事情的**通知**（例如，尝试访问空对象的成员）。

 **也许我只是对这类东西过于固执己见，但我以前曾被这些无声的错误所困扰。**我建议始终在错误报告中包含 E_NOTICE。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T18:57:15.430

您是否应该修复它们当然是有争议的，并且仅取决于您的情况的回报；例如，如果代码具有更长的生命周期、更多的开发人员等，则更为重要。

通常，假设您的函数将被其他人使用（和误用）是最佳实践，因此您应该进行 isset/!empty/is_object 检查以解决此问题。通常，您的代码会发现它进入了您从未打算使用的用途和情况。

就性能而言，每次抛出任何类型的错误（包括 E_NOTICE）时，解释器都会启动错误处理程序，构建堆栈跟踪并格式化错误。关键是，无论您是否让他们报告，*错误总是会减慢执行速度；*因此，**避免 E_NOTICE 的 2-3 次函数调用仍将提高您的性能**。

**编辑：** 上述示例的替代方案

我不一定会创建额外的对象来避免错误；你可以优雅地避开它们。这里有几个选项：

1) 处理缺失 ts 的函数：

```
SpecialClass class {

    funciton getTs () {
        return !empty($this->ts) ? $ts->sec : false;
    }
} 
```

2）处理模板/过程中缺少的ts：

```
if (!empty($obj->ts->sec)) {
    //do something
} 
```

我特别喜欢`empty()`，因为您可以使用它来替换 of `(isset($var) && ($var or 0 != $var //etc))`，保存多个调用/比较，并且 empty 永远不会为目标 var 或属性抛出通知。如果您在不存在的变量的属性/成员上调用它，它将引发错误。**

# matlab - 不同斜率的线与圆的交点

> ID：11510330
> 
> 赞同：0
> 
> 时间：2012-07-16T18:29:55.373
> 
> 标签：matlab, line, geometry

> **可能重复：**
> [圆线碰撞检测](https://stackoverflow.com/questions/1073336/circle-line-collision-detection)

谁能建议如何找到线和圆的交点。

```
theta=0:.01:2*pi;

x1=4*cos(theta)+4;

y1=4*sin(theta)+4;

x=[0 1 3 5 8]

y=[0 1 1 3 3]

for i=2:length(x)    

    s(i)=(y(i)-y(i-1))/(x(i)-x(i-1));

end

s

inter=y

plot([x],[y],x1,y1,'-')

axis([0 10 0 10]) 
```

# c# - 序列化为 JSON，尽管指定了 NullValueHandling，但使用 Json.NET 和 Web API 忽略可空日期

> ID：11510333
> 
> 赞同：5
> 
> 时间：2012-07-16T18:30:04.703
> 
> 标签：c#, .net, serialization, json.net, asp.net-web-api

```
using Newtonsoft.Json;

namespace FAL.WebAPI2012.Controllers
{
    public class Person
    {
        public int Id {get;set;}
        public string FirstName {get;set;}
        public string LastName {get;set;}

        [JsonProperty(DefaultValueHandling = DefaultValueHandling.Include, 
            NullValueHandling = NullValueHandling.Include)]
        public DateTime? Dob { get; set; }
    }

    public class TestNullsController : ApiController
    {
        // GET api/<controller>
        public Person Get()
        {
            Person myPerson = new Person() { 
                Dob = null, FirstName = "Adrian", Id=1, LastName="Bobby"
            };

            return myPerson;
        }
    }
} 
```

如您所见，我的 Dob 字段设置为 null 但结果如下

```
{ "Id":1, "FirstName":"Adrian", "LastName":"Bobby" } 
```

并且`Dob`没有序列化为我需要的 null ！

（我已经测试过`JsonProperty`设置其他属性，如 name 并且它完美地改变了 JSON 输出。我只是无法序列化可空属性。另外，我已经测试了 Json.Net（见下面的答案），所以我的想法是该 web api 设置在某处覆盖了某些东西，很高兴知道在哪里）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:32:50.983

看来问题出在其他地方。我在控制台应用程序中完成了以下操作：

```
using System;
using System.IO;
using Newtonsoft.Json;

namespace JsonNetNullablePropertyTest
{
    class Program
    {
        static void Main()
        {
            var myPerson = new Person {
                Dob = null,
                FirstName = "Adrian",
                Id = 1,
                LastName = "Bobby"
            };

            using (var textWriter = new StringWriter())
            using (var writer = new JsonTextWriter(textWriter))
            {
                // Create the serializer.
                var serializer = new JsonSerializer();

                // Serialize.
                serializer.Serialize(writer, myPerson);

                // Write the output.
                Console.WriteLine(textWriter);
            }
        }
    }

    public class Person
    {
        public int Id { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }

        [JsonProperty(DefaultValueHandling = DefaultValueHandling.Include,
            NullValueHandling = NullValueHandling.Include)]
        public DateTime? Dob { get; set; }
    }
} 
```

输出是：

```
{"Id":1,"FirstName":"Adrian","LastName":"Bobby","Dob":null} 
```

正如预期的那样。

似乎问题在于您如何实际调用`JsonSerializer`来序列化`Person`实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T12:38:43.823

我收到了来自 Microsoft 的 web.api 成员的回复。

'你会很高兴知道自 RC 以来这已得到修复：

[http://aspnetwebstack.codeplex.com/workitem/243](http://aspnetwebstack.codeplex.com/workitem/243)

您可以升级到更新的软件包，也可以像这样覆盖我们的设置：

JsonFormatter.SerializerSettings = new JsonSerializerSettings() { NullValueHandling = NullValueHandling.Include };

希望有帮助'

因此，一切都适用于该更新。

# php - 如何使用子目录名称的前缀重命名子目录中的所有文件，然后将文件移动到新目录？

> ID：11510334
> 
> 赞同：1
> 
> 时间：2012-07-16T18:30:05.260
> 
> 标签：php, recursion, copy, rename, move

我基本上有这样的设置：

```
C:\Upload\A
C:\Upload\B
C:\Upload\C
C:\Upload\D
C:\Upload\E 
```

其中 A、B、C、D、E 总是不同的（产品 ID）并且总是不同的数量（它不会总是 5 个子目录）。这些子目录中的每一个都包含 24 个图像，编号为 01-24。

我需要创建一个通过 Web (IIS) 远程运行的 PHP 文件，该文件查看 Upload 目录，获取每个子目录的名称并将该名称附加到该子目录中包含的每个图像文件的开头。

因此，`C:\Upload\A\01.jpg`将`C:\Upload\A\A-O1.jpg`与每个子目录中的其他 23 个图像一样。

PHP 文件需要对 Upload 目录中的每个子目录执行相同的操作。

然后，一旦重命名完成，PHP 需要将所有目录（及其图像）从 Upload 目录复制到不同的目录。复制后，需要清除上传目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:55:05.797

这应该有效：

```
<?php
    define('START_DIR', '/opt/lampp/htdocs/start');
    define('DEST_DIR', '/opt/lampp/htdocs/dest');
    define('SEPARATOR', '\\');

    function firstStage() {
        $d = dir(START_DIR);
        while (false !== ($entry = $d->read())) {
            if($entry != '.' && $entry != '..')
                secondStage($entry);
        }
        $d->close();
    }

    function secondStage($prefix) {
        $d = dir(START_DIR . SEPARATOR . $prefix);
        while (false !== ($entry = $d->read())) {
            if($entry != '.' && $entry != '..')
                rename(START_DIR . SEPARATOR . $prefix . SEPARATOR . $entry, DEST_DIR . SEPARATOR . $prefix . '-' . $entry);
        }
        $d->close();
    }

    firstStage();
?> 
```

只需调用`firstStage()`即可开始该过程。确保您对`START_DIR`和`DEST_DIR`

# mysql - 存储排序顺序/优先级的最佳方式？

> ID：11510336
> 
> 赞同：8
> 
> 时间：2012-07-16T18:30:08.787
> 
> 标签：mysql, sorting

我正在使用 MySQL。我有一个表，我需要能够手动排序设置行的优先级/顺序。我最初想为每一行分配一个任意顺序（1、2、3 等），然后只是“交换”与移动的行的顺序，但我认为这不是最好的方法。

在阅读了一些相关问题之后（[比如这个](https://stackoverflow.com/questions/6804166/what-is-the-most-efficient-way-to-store-a-sort-order-on-a-group-of-records-in-a)），很多人说要根据 id 列（id * 1000）为优先级列分配一个值。要重新排列行，您将除/减列之间的差异。我不太明白这是如何工作的。

这是我需要排序的表格布局。

```
CREATE TABLE liability_detail (
   id int NOT NULL AUTO_INCREMENT,
   analysis_id int NOT NULL, //(many-to-one relationship with analysis table)
   other_columns various datatypes
   sequence int DEFAULT 0
) 
```

我想设置一种简单的方法来管理行的优先级，这样我就可以轻松地对它们进行排序，而无需编写大量代码来管理所有内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T02:04:38.090

我最终遵循了这个问题的建议：[https ://stackoverflow.com/a/6804302/731052](https://stackoverflow.com/a/6804302/731052)

我设置了排序顺序列 = id * 1000，所以我可以获得唯一的订单。到目前为止，这工作得很好，并且没有任何问题。

# objective-c - Objective-C：检查类类型，最好使用isKindOfClass，还是respondsToSelector？

> ID：11510337
> 
> 赞同：5
> 
> 时间：2012-07-16T18:30:12.483
> 
> 标签：objective-c

通过调用 isKindOfClass: 来检查类的类型是否更合适，或者仅通过 respondsToSelector: 检查它是否支持您正在寻找的方法来采取“鸭子打字”方法？

这是我正在考虑的代码，以两种方式编写：

```
for (id widget in self.widgets)
{
    [self tryToRefresh:widget];

    // Does this widget have sources? Refresh them, too.
    if ([widget isKindOfClass:[WidgetWithSources class]])
    {
        for (Source* source in [widget sources])
        {
            [self tryToRefresh:source];
        }
    }
} 
```

或者：

```
for (id widget in self.widgets)
{
    [self tryToRefresh:widget];

    // Does this widget have sources? Refresh them, too.
    if ([widget respondsToSelector:(@selector(sources))])
    {
        for (Source* source in [widget sources])
        {
            [self tryToRefresh:source];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T18:36:46.430

这取决于实际情况！

我的经验法则是，这只是给我的，还是我将它传递给其他人？

在您的示例中，`respondsToSelector:`这很好，因为您只需要知道您是否可以向对象发送该消息，因此您可以对结果做一些事情。上课真的没那么重要。

另一方面，如果您打算将该对象传递给其他一些代码，您不一定知道它打算发送什么消息。在这些情况下，您可能会投射对象以便传递它，这可能是您应该`isKindOfClass:`在投射之前检查它是否真的存在的线索。

要考虑的另一件事是模棱两可。`respondsToSelector:`告诉您一个对象将响应一条消息，但如果该对象返回的类型与您预期的不同，它可能会产生误报。例如，声明方法的对象：

```
- (int)sources; 
```

将通过`respondsToSelector:`测试，但当您尝试在 for-in 循环中使用其返回值时会生成异常。

发生这种情况的可能性有多大？这取决于您的代码、您的项目有多大、有多少人针对您的 API 编写代码等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T18:43:00.787

使用目标 C 稍微更惯用`respondsToSelector:`. Objective C 是高度动态的，因此您在设计时对类结构的假设不一定在运行时成立。`respondsToSelector:`通过为您提供查询类类型的最常见原因的快捷方式（是否执行某些操作）来解决此问题。

一般而言，如果几个同样吸引人的选择存在歧义，请选择可读性。在这种情况下，这意味着要考虑意图。您是否关心它是否特别是 a `WidgetWithSources`，或者您*真的*只关心它是否具有`sources`选择器？如果是后者，则使用`respondsToSelector:`. 如果是前者，并且在某些情况下很可能是这样，那么使用`isKindOfClass.`Readability，在这种情况下，意味着您没有要求读者在类型等价`WidgetWithSources`和调用`sources`. `respondsToSelector:`为读者建立联系，让他们知道您的实际意图。这是对你的程序员同事的小善举。

编辑：@benzado 的回答非常一致。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T19:44:36.880

@Tim & @benzado 给出了很好的答案，这里是主题的一个变体，之前先介绍了两个案例：

*   如果在某些时候您可能有对不同类的引用并且需要不同的类，那么这可能是一种情况，`isKindOfClass:`例如，颜色可能存储在首选项中作为一个`NSData`序列化`NSColor`，或者作为具有`NSString`标准之一的值姓名；`NSColor`在这种情况下获取`isKindOfClass:`对象返回的值可能是合适的。
*   如果您引用了单个类，但随着时间的推移，它的不同*版本*`respondsToSelector:`支持不同的方法，那么请考虑例如，许多框架类在更高版本的操作系统中添加了新方法，Apple 的标准建议是使用`respondsToSelector:`（和不是操作系统版本检查）。
*   如果您引用了不同的类并且您正在测试它们是否遵守一些*非正式协议*，那么：

    1.  如果这是您控制的代码，您可以切换到*正式协议*，然后`conformsToProtocol:`用作您的测试。这具有测试*type*而不仅仅是*name*的优点；否则
    2.  如果这是您无法控制的代码，请使用`respondsToSelector:`，但我们知道这*只是*测试是否存在具有相同*名称*的方法，而不是测试它采用相同*类型*的参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-16T19:14:49.580

检查任何一个都*可能*是一个警告，表明您将要制定一个骇人听闻的解决方案。小部件已经知道他的类和他的选择器。

所以第三种选择可能是考虑重构。将此逻辑移至 a`[widget tryToRefresh]`可能更简洁，并允许未来的小部件实现额外的幕后逻辑。

# mysql - 正则表达式匹配 MySQL 时间戳格式“YMD H:M:S”

> ID：11510338
> 
> 赞同：7
> 
> 时间：2012-07-16T18:30:18.083
> 
> 标签：mysql, regex

我正在尝试创建一个正则表达式来匹配包含 MySQL 时间戳格式的日期的字符串，例如“2012-07-16 02:04:33”。

这并不像听起来那么容易，例如，您不应该以 2 月 30 日结束。

我知道有更简单的方法可以做到这一点，但我依赖于能够传递一个字符串和一个正则表达式来评估该字符串。

我很高兴有任何建议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-19T09:55:18.340

正则表达式：

```
/^(((\d{4})(-)(0[13578]|10|12)(-)(0[1-9]|[12][0-9]|3[01]))|((\d{4})(-)(0[469]|1‌​1)(-)([0][1-9]|[12][0-9]|30))|((\d{4})(-)(02)(-)(0[1-9]|1[0-9]|2[0-8]))|(([02468]‌​[048]00)(-)(02)(-)(29))|(([13579][26]00)(-)(02)(-)(29))|(([0-9][0-9][0][48])(-)(0‌​2)(-)(29))|(([0-9][0-9][2468][048])(-)(02)(-)(29))|(([0-9][0-9][13579][26])(-)(02‌​)(-)(29)))(\s([0-1][0-9]|2[0-4]):([0-5][0-9]):([0-5][0-9]))$/ 
```

做这项工作。感谢您的输入。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-16T18:33:58.687

您应该分两步完成，而不是尝试使用非常复杂的正则表达式。

**Step1：**使用正则表达式检查格式是否正确。使用类似的东西

`/^\d\d\d\d-(\d)?\d-(\d)?\d \d\d:\d\d:\d\d$/g`

**步骤2：**如果匹配，请使用类似于`strtotime()`PHP 中的内容（或使用您使用的任何语言的日期时间函数进行解析）并检查结果是否有效，以消除像 2 月 30 日这样的日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-30T12:13:53.443

这应该适用于 2019-04-30 或 2019-04-30 12:12:12

```
/^([1-2][0-9]{3})-([0-1][0-9])-([0-3][0-9])(?:( [0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/ 
```

它还具有不验证 0000-00-00 的优点

# matlab - 在 Matlab 中将 .DAT 文件转换为 ASCII

> ID：11510341
> 
> 赞同：0
> 
> 时间：2012-07-16T18:30:31.910
> 
> 标签：matlab, ascii, fread

我有一些来自数据采集系统的 .dat 文件，我试图在 Matlab 中读取这些文件。

使用以下代码，我已经能够计算出每个 .dat 文件的最大公分母是 1640，形成一个 N x 1640 矩阵，但在那之后，我迷路了。

```
fid = fopen('VECTOR1.DAT');
A = fread(fid, '*uint8');
length(A) 
```

有什么建议么？我将非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:27:52.000

数据可能不是`uint8`，这就是为什么当您将其读取为 unint8 时认为您有乱码的原因。键入`doc fread`然后尝试按照表中显示的各种类型读取它，例如

```
figure,plot(fread(fid, 'single'));
figure,plot(fread(fid, 'double'));
figure,plot(fread(fid, 'int8'));
figure,plot(fread(fid, 'int16'));
figure,plot(fread(fid, 'int32'));
figure,plot(fread(fid, 'int64'));
figure,plot(fread(fid, 'uint8'));
figure,plot(fread(fid, 'uint16'));
figure,plot(fread(fid, 'uint32'));
figure,plot(fread(fid, 'uint64')); 
```

可能其中一个会给你一个比其他更好看的情节。

最好用谷歌搜索获取数据文件的设备的手册。该手册应该告诉您它制作的数据文件的格式是什么，它们是浮点（单或双）还是整数或无符号整数。

# c# - 从 WCF 服务返回数据表

> ID：11510348
> 
> 赞同：0
> 
> 时间：2012-07-16T18:30:59.733
> 
> 标签：c#, wcf, datatable

我是 WCF 的新手。

当使用数据表作为源时，这是从 WCF 服务返回数据的最佳方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:34:23.877

可以通过多种方式从 Web 服务返回数据。

最流行的是[XML](http://en.wikipedia.org/wiki/XML)和[JSON](http://www.json.org/)。

# android - Android NullPointer 错误 Fragment 自定义类？

> ID：11510351
> 
> 赞同：0
> 
> 时间：2012-07-16T18:31:12.470
> 
> 标签：android, android-fragments

Java 和 Android 编程相对较新，任何人都可以帮助我解释为什么我会得到一个`NullPointerException`?

```
 public class DpsFragment extends Fragment {
    Weapon weppy;

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

            weppy.setMaxdmg(200);
            weppy.setMindmg(100);
            TextView tv= (TextView) getView().findViewById(R.id.textView1); 
            tv.setText("hello");

            return inflater.inflate(R.layout.dpsfrag, container, false);

        }

    public class Weapon {
    private int mindmg;
    private int maxdmg;

    public Weapon(int mindmg, int maxdmg) {
    this.setMindmg(mindmg);
    this.setMaxdmg(maxdmg);
    }

    public int getMindmg() {
    return mindmg;
    }

    public void setMindmg(int mindmg) {
    this.mindmg = mindmg;
    }

    public int getMaxdmg() {
    return maxdmg;
    }

    public void setMaxdmg(int maxdmg) {
    this.maxdmg = maxdmg;
}
}} 
```

非常简单的代码，我知道，但我不知道我哪里出错了？谢谢你的帮助 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:32:40.067

`weppy is null`所以 NPE ...我想你忘了初始化它。

可能是`weppy = new Weapon(mindmg,maxdmg);`

**还**

```
 @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        weppy = new Weapon(100,200);  <<<<<<See here

        TextView tv= (TextView) getView().findViewById(R.id.textView1); 
        tv.setText("hello");

        return inflater.inflate(R.layout.dpsfrag, container, false);

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T11:30:48.090

您也不能在 onCreateView 中使用 getView() ，因为您正在访问的视图尚未创建。所以你应该这样做：

查看视图 = inflater.inflate(R.layout.dpsfrag, container, false);

TextView tv= (TextView) view.findViewById(R.id.textView1);

tv.setText("你好");

返回视图；

# android - Android - 在预制数据库中找不到表

> ID：11510354
> 
> 赞同：0
> 
> 时间：2012-07-16T18:31:23.283
> 
> 标签：android, sqlite, sqliteopenhelper

我正在尝试制作一个程序，该程序将采用我已经制作的 SQLite 数据库（称为 os.sqlite）并能够读取/写入该数据库。我按照[这里的代码](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)并且 Eclipse 在复制数据库的过程中似乎没有给我任何错误，但是当我尝试运行我的应用程序并显示表“OregonState”时，LogCat（我正在使用带有 ADT 插件的 Eclipse Juno 并运行我的应用程序在 SDK 模拟器上）一直告诉我没有名为“OregonState”的表，这是我知道我在项目中创建并放入我的资产文件夹中的数据库中的一个表（我什至可以看到该文件坐在那里）。在多次尝试失败后，我注意到 LogCat 还说它无法打开数据库，因为数据库被锁定。有人指出，我可能正确地打开和关闭，但是添加了这些，我的应用程序崩溃了。有谁能帮忙吗？

我创建了一个适配器（它还包含一个复制数据库的 SQLiteHelper 嵌套类）来访问数据库并允许我插入/删除/等。到桌子上。然后我的主要活动使用这个适配器。这是我的代码（为了彻底和完整，我已经包含了所有代码，不包括导入和包名称）：

```
public class SQLAdapter
{
private static final String TABLE_OSU = "OregonState";
private static final String COLUMN_ID = "_id";
private static final String COLUMN_NAME = "Name";
private static final String COLUMN_FIELD = "Field";

private static final String DATABASE_PATH = "/data/data/com.example.sql2/databases/";
private static final String DATABASE_NAME = "os.sqlite";
private static final int DATABASE_VERSION = 1;

MySQLiteHelper helper;
private final Context context;

public SQLAdapter(Context context)
{
    this.context = context;
    helper = new MySQLiteHelper(context);
}

private  class MySQLiteHelper extends SQLiteOpenHelper
{

    private final Context context;

    public MySQLiteHelper(Context context)
    {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        this.context = context;
    }

    @Override
    public void onCreate(SQLiteDatabase database)
    {
        try {
            createDatabase();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void createDatabase() throws IOException
    {
        boolean dbExist = checkDatabase();          
        if (dbExist)
        {
            // Nothing
        }
        else
        {
                copyDatabase();
        }
    }

    public boolean checkDatabase()
    {
        SQLiteDatabase checkDB = null;
        try
        {
            String path = DATABASE_PATH + DATABASE_NAME;
            checkDB = SQLiteDatabase.openDatabase(path, null, SQLiteDatabase.OPEN_READWRITE);
        } catch (SQLiteException e) {}
        if (checkDB != null)
            checkDB.close();
        return checkDB != null ? true : false;
    }

    public void copyDatabase() throws IOException
    {
        InputStream input = context.getAssets().open(DATABASE_NAME);
        String outFileName = DATABASE_PATH + DATABASE_NAME;
        OutputStream output = new FileOutputStream(outFileName);

        byte[] buffer = new byte[1024];
        int length;
        while ((length = input.read(buffer))>0)
            output.write(buffer, 0, length);

        output.flush();
        output.close();
        input.close();
    }

    public void openDatabase()
    {
        String path = DATABASE_PATH + DATABASE_NAME;
        SQLiteDatabase.openDatabase(path, null, SQLiteDatabase.OPEN_READWRITE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)
    {
        SQLiteDatabase database = this.getWritableDatabase();
        Log.w(DATABASE_NAME, "Upgrading database from " + oldVersion + " to " + newVersion + ", which will erase all data.");
        database.execSQL("DROP TABLE IF EXISTS " + TABLE_OSU);
        onCreate(database);
        database.close();
    }
}

public SQLiteDatabase open() throws SQLException
{
    SQLiteDatabase database = helper.getWritableDatabase();
    return database;
}

public void close()
{
    helper.close();
}

public long insert(SQLiteDatabase database, String name, String field)
{
    ContentValues values = new ContentValues();
    values.put(COLUMN_NAME, name);
    values.put(COLUMN_FIELD, field);
    long x = database.insert(TABLE_OSU, null, values);
    database.close();
    return x;
}

public int delete(SQLiteDatabase database, int id)
{
    int x = database.delete(TABLE_OSU, COLUMN_ID + "=" + id, null);
    return x;
}

public Cursor getAll(SQLiteDatabase database)
{
    return database.query(TABLE_OSU, new String[] {COLUMN_ID, COLUMN_NAME, COLUMN_FIELD}, null, null, null, null, null);
}

public Cursor get(SQLiteDatabase database, int id) throws SQLException
{
    return database.query(TABLE_OSU, new String[] {COLUMN_ID, COLUMN_NAME, COLUMN_FIELD}, COLUMN_ID + "=" + id, null, null, null, null);
}

public int update(SQLiteDatabase database, int id, String name, String field)
{
    ContentValues values = new ContentValues();
    values.put(COLUMN_NAME, name);
    values.put(COLUMN_FIELD, field);
    return database.update(TABLE_OSU, values, COLUMN_ID + "=" + id, null);
}
}

public class SQLTest extends Activity
{
SQLAdapter adapter;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    adapter = new SQLAdapter(this);
    getAll();
}

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    getMenuInflater().inflate(R.menu.activity_sqltest, menu);
    return true;
} 

public long insert(String name, String field)
{
    SQLiteDatabase database = adapter.open();
    long id = adapter.insert(database, name, field);
    adapter.close();
    return id;
}

public int delete(int id)
{
    SQLiteDatabase database = adapter.open();
    int rowsDeleted = adapter.delete(database, id);
    adapter.close();
    return rowsDeleted;
}

public void getAll()
{
    SQLiteDatabase database = adapter.open();
    TextView tv = new TextView(this);
    String table = "";
    try
    {
        Cursor cursor = adapter.getAll(database);
        if (cursor.moveToFirst())
        {
            do
            {
                table += "\n" + cursor.getString(0) + " " + cursor.getString(1) + " " + cursor.getString(2);
            } while (cursor.moveToNext());
        }
        cursor.close();
    } catch (Exception e) {}
    tv.setText(table);
    setContentView(tv);
    adapter.close();
}

public void get(int id)
{
    SQLiteDatabase database = adapter.open();
    Cursor cursor = adapter.get(database, id);
    TextView tv = new TextView(this);
    String table = "";
    if (cursor.moveToFirst())
        table += "\n" + cursor.getString(0) + " " + cursor.getString(1) + " " + cursor.getString(2);
    else
        table += "No hall found with ID: " + id;
    tv.setText(table);
    setContentView(tv);
    cursor.close();
    adapter.close();
}

public int update(int id, String name, String field)
{
    SQLiteDatabase database = adapter.open();
    int rowsUpdated = adapter.update(database, id, name, field);
    adapter.close();
    return rowsUpdated;
}
} 
```

我注意到[这个人](https://stackoverflow.com/questions/10927328/android-no-such-table-in-sqlite)也有类似的问题，虽然我的从来没有真正起作用，而他的确实如此。我稍微遵循了他的代码，这只会让我的应用程序开始崩溃。我只想发表评论，但我是新来的，所以没有足够的声誉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:49:15.320

我听从了 Yaqub Ahmad 和中提琴给我的指示！有效！我之前有一个 Adapter 类和一个 SQLiteOpenHelper 的迭代，但我认为可能与让 Helper 成为嵌套类有关可能会使事情变得更加困难。我实际上不确定我做错了什么，但我在 Ahmad 的[链接](https://stackoverflow.com/questions/9109438/using-already-created-database-with-android/9109728#9109728)上获得的代码似乎工作得很好，因为我的表格可以在应用程序中打印。谢谢你，亚古布·艾哈迈德。我已经提供了对我有用的代码的链接，以供遇到我的问题的任何人使用。

# database - 一次运行多个数据库平台有什么“不正确的”吗？

> ID：11510356
> 
> 赞同：1
> 
> 时间：2012-07-16T18:31:29.727
> 
> 标签：database, graph, relational-database

假设我有一个可以处理不同类型数据的应用程序。每种数据都是唯一的，不同的数据之间只是切线相关。将一种映射到 RDMS，将另一种映射到图形数据库可能非常困难。运行多个数据库平台来满足应用程序的各种需求有什么真正的危害吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:41:00.917

有很多特定于应用程序的问题。数据存储会直接相互通信吗？或者，他们会通过应用程序进行通信吗？

主要问题与长期维护有关。如果不同的数据库在同一台服务器上运行，那么您就会遇到维护问题。一个新的服务器操作系统补丁出现了，但只有部分软件可以与新补丁一起使用。你安装还是不安装？如果您出于其他原因*需要它怎么办？*

同样，如果所有软件都在单个服务器上运行，那么您可能需要更大的服务器，因为您有更多的软件。您将为按服务器大小定价的产品支付更多费用，即使额外的计算能力流向其他地方。

在某些情况下，您可能需要使用不同的产品。但是，通常更实际地使用一个产品有点次优，而不是维护一个具有大量单一用途软件组件的系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:39:25.903

它在技术上是可行的并且可以工作，但是构建系统的人员或团队需要具备所有技能来开发/测试/部署/维护/备份具有各种机制、程序和未来开发和升级路径的数据库（重复每种类型的数据/数据库）。我当然会尽量减少这些机制和程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:34:15.530

我认为只要您注意注射和其他安全问题，它就没有大问题（我不知道您如何将数据传递给数据库）

# php - 上传图片与注册相结合

> ID：11510364
> 
> 赞同：-1
> 
> 时间：2012-07-16T18:32:13.407
> 
> 标签：php, jquery, ajax

我想制作一个注册表单，用户应该能够在其中上传个人资料图片以及注册表单。我正在像这样使用ajax上传图片

```
 $(document).ready(function () {
     $('#UploadForm').on('submit', function (e) {
         e.preventDefault();
         $('#SubmitButton').attr('disabled', ''); // disable upload button
         //show uploading message
         $("#profile_picture").html('<div class ="update_load" style="padding:10px"><img class="load_pic" src="images/ajax-loader.gif" alt="Please Wait"/> </div>');
         $(this).ajaxSubmit({
             target: '#profile_picture',
             success: afterSuccess //call function after success
         });
     });
 }); 
```

ajax的反馈是这样的图片

```
echo '<img class="profile" src="uploads/'.$name.'.'.$ext.'" >'; 
```

现在我想将另一个 process.php 文件上的 $name 变量传输到我当前的 index.php 文件中，以便我可以使用 MySQL Query 插入它。我不知道该怎么做。我的第二个问题是，如果用户在注册表单中多次更改他的图片，我将如何删除他之前上传的所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:50:20.027

您可以编写一个以响应为参数的 afterSuccess 函数。

```
$(this).ajaxSubmit({
             target: '#profile_picture',
             success: afterSuccess(data) //call function after success
         });

function afterSuccess(data)
{
    //parse your response to take the name
    //make another ajax request to save it to database
} 
```

此功能也可以处理新图片上传。您将在 php 级别进行检查（称为 ajax）

像这样解析 img 字符串以获取 src ：

```
var img = $('<img class="profile" src="uploads/gaidouri.jpg" />');
var src = $(img).attr('src'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:03:04.187

好的，这就是我所做的，我相信这可以帮助你：

1）生成时间戳+随机数>**幻数**

2）使用uploadify jquery插件将照片上传到临时文件夹（*您可以从用户填写个人数据的同一表单上传照片*）

3）以幻数作为名称保存该文件（*您可以上传任意数量的文件，而不是前一个*文件）

4) 将生成的数字连同表单的其余部分与用户数据一起发布

选择一个数字 5):

5a) 保存数据时，只需将临时文件重命名为带有来自 mysql 的新 ID 的最终文件夹

5b）保持临时文件不变，只需将其移动到最终文件夹并使用幻数将其存储在数据库中

希望这可以帮助！

# c - 在C中将“，”分隔的列表拆分为数组的最佳方法是什么？

> ID：11510368
> 
> 赞同：-5
> 
> 时间：2012-07-16T18:32:24.840
> 
> 标签：c

> **可能重复：**
> [在 C 中使用分隔符拆分字符串](https://stackoverflow.com/questions/9210528/split-string-with-delimiters-in-c)

将“，”分隔的列表拆分为 C 中的数组的最佳方法是什么。我知道列表中有多少东西。

```
char list = "one,two,three,four";
int ENTServerAmount = 8;
char **ENTServer;
ENTServer = malloc(sizeof(char *) * ENTServerAmount);
*** Code that splits "list" into "ENTServer" *** 
```

另外我不是很擅长分配，所以如果我的分配语句有误，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:36:02.970

[`strtok()`](http://en.cppreference.com/w/c/string/byte/strtok)可能是您正在寻找的功能。

```
char list[] = "one,two,three,four";
int ENTServerAmount = 8;
char **ENTServer;

char *tmp = strtok (str, ",");

int index = 0;
while (pch != NULL)
{
   ENTSever[index++] = tmp;
   tmp = strtok (NULL, ",");
} 
```

# java - Apache Wink 和 Apache CXF JAX-RS 实现

> ID：11510369
> 
> 赞同：11
> 
> 时间：2012-07-16T18:32:31.860
> 
> 标签：java, apache, rest, cxf, jax-rs

为什么 Apache 有两种 JAX-RS 实现？

CXF 似乎是一个巨大的包，包括 jax-ws 和 jax-rs。Wink似乎更轻巧。那么哪个更好用呢？有人有使用一种或两种实现的经验吗？也许其中一个已经过时了？

我知道 jax-rs 还有其他实现，但我想获取有关这两个的信息。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-16T21:05:46.030

使用 CXF 2.6.x，您可以使用较小的 jars/bundles，如果您不需要它，它们不会拉入 jaxws 的东西。不过仍然可能比 Wink 大。

在大多数情况下，CXF 背后有一个更加活跃的社区，不断进行开发、增强等...... Wink 几乎已经死了，几乎没有任何活动。如果你需要一些高级的东西，CXF 绝对是更好的选择。诸如 OAuth/OAuth2、SAML、高级加密/安全、各种转换、额外类型选项等之类的东西......所有在 CXF 中得到积极支持和增强的领域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-02-01T15:24:32.913

Apache Wink[于 2017 年 4 月正式退役](https://wink.apache.org/)。

> **2017/04/25 - Apache Wink 已退役。**
> 欲了解更多信息，请探索[**阁楼**](http://attic.apache.org/)。

# php - 使用 php 对查询进行交叉制表

> ID：11510378
> 
> 赞同：0
> 
> 时间：2012-07-16T18:33:02.050
> 
> 标签：php, mysql

我试图想出一种有效的方式来显示一些数据，但根本没有成功。

该表是从几个表动态构建的，以显示一行标题，其中填充的列按站点显示结果，例如：

```
Site name | Column A | Column B | Column C => column headers continue from DB query
 Site A   | Result A | Result B | Result C
 Site B   | Result C | Result B | Result C
 Site C   | Result C | Result B | Result C

Results keep going vertically. 
```

这是我正在使用的查询

```
$risk_section=$row_risk_category['risksectid'];
    mysql_select_db($database_auditing, $auditing);
$qry_selfsites = sprintf("SELECT
tblself.siteid AS selfsite, 
tblsite.sitename AS sitename,
tblsite.address AS address, 
 tblpct.pctname AS pctname,
  tblresultsnew.total,
   tblresultsnew.auditid AS auditid,
    tblriskcategories.risksectid AS risksectid,
     tblriskcategories.risksection AS risksection
FROM tblself 
 LEFT JOIN tblresultsnew ON tblself.auditid = tblresultsnew.auditid 
  LEFT JOIN tblsite ON tblself.siteid = tblsite.siteid 
   LEFT JOIN tblpct ON tblsite.pctid = tblpct.pctid
    LEFT JOIN tblriskcategories ON
tblresultsnew.risksectid=tblriskcategories.risksectid 
WHERE tblsite.pctid IN (SELECT pctid FROM tblreportpcts WHERE
pctreportid='$pctreportid') 
 AND tblsite.sitetypeid IN (SELECT sitetypeid FROM tblreportsites WHERE
pctreportid='$pctreportid')
  AND tblself.year = %s 
   ORDER BY tblsite.pctid,tblsite.sitename", 
 GetSQLValueString($yearofrpt, "int"));
$selfsites = mysql_query($qry_selfsites, $auditing) or die(mysql_error());
$totalRows_selfsites = mysql_num_rows($selfsites); 
```

所以问题是，有没有办法从上述查询（或其改编版本）中获取数据以动态构建表，所有结果都正确排列？到目前为止，我只能让它垂直构建。

抱歉，编辑时间（使用下面的答案后，我意识到我没有很好地表达问题）

我想要得到的是来自查询 ( `tblriskcategories.risksection AS risksection`) 的一行列标题，它们水平填充以给出列名称。

然后在下面，显示站点名称，结果与上面的列标题对应，即

```
<table>
<tr>
<th>Sitename</th>
<?php while($row_selfsites=mysql_fetch_assoc($selfsites){  
 //loop through the section headers pulled from the DB (tblriskcategories)  
<th><?php echo $row_selfsites['risksection'];//show the section headers?></th>
<?php }   
//end header loop then start another loop to show a row for each site pulled
 //out by the query and show the relevant results in the correct column  
while($row_selfsites=mysql_fetch_assoc($selfsites)) {  
 //do the vertical drop matching the header rows with the sitenames from tblsite 
 //and the results from tblresultsnew 
?>  
<tr>  
<td><?php echo $row_selfsites['sitename'];?></td>  
<td><?php echo $row_selfsites['total'];  
//these need to grow to fit the headers and each site?></td>  
<tr>  
<?php } //end displayed data loop?>  
</table> 
```

相关表结构如下：
tblresultsnew resultsid,auditid,risksectid,total
tblriskcategories risksecid, risksection
tblself selfauditid,siteid,auditid
tblsite siteid,sitename

所以 tblself 保存我们需要数据的站点列表和相关的审计 ID，
tblresultsnew 保存结果 - 总列 - 对于每个风险分区和每个审计 ID，例如，一个审计 ID 可以有大约 8 个风险分区，每个都有相应的总
tblriskcategories 保存列标题
tblsite 保存站点数据以使其有意义，
我希望这能进一步解释这个问题。

再次感谢所有帮助。
戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:20:23.507

```
$rows = array(
0 => array('headingA' => 'results1a', 'headingB' => 'results1b',  ),
1 => array('headingA' => 'results2a', 'headingB' => 'results2b',  ),
2 => array('headingA' => 'results3a', 'headingB' => 'results3b',  ),
);
// $rows is spoofing a db result set as an array
//var_dump( $rows );

$first = true ;
$header_row = "START TABLE <br />" ;
$data_rows = "";
foreach( $rows as $row ) {
  foreach( $row as $key=>$value ){
    if( $first === true ){
    $header_row .= "$key  | ";
    }
  $data_rows .= "$value |";
  }
if( $first ) $header_row .="<br />";

$data_rows .= "<br />";
$first = false;
}
echo $header_row . $data_rows . "END TABLE"; 
```

给出：

```
START TABLE 
headingA | headingB | 
results1a |results1b |
results2a |results2b |
results3a |results3b |
END TABLE 
```

这是你所追求的解决方案吗？

# twitter - Twitter API GET 趋势 404 错误

> ID：11510382
> 
> 赞同：0
> 
> 时间：2012-07-16T18:33:23.063
> 
> 标签：twitter, http-status-code-404

我检查了关于 twitter 的 REST API 的趋势。[获取趋势](https://dev.twitter.com/docs/api/1/get/trends/%3awoeid) 通常它运作良好。但有时我会收到 404 错误。几分钟后它又回来了。

错误代码是：

```
{"errors":[{"message":"Sorry, that page does not exist","code":34}]} 
```

有人有这个问题吗？你会推荐什么 ？
请检查此链接，它现在给出 404。
[https://api.twitter.com/1/trends/1.json](https://api.twitter.com/1/trends/1.json)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:50:54.217

您多久访问一次此呼叫 - 您确定您没有违反速率限制吗？如果没有违反，这可能是 twitter 端的问题，您需要处理错误消息，为您的应用程序使用先前缓存的响应，直到您从 twitter 获得更新的提要。希望这可以帮助

# sharepoint - SharePoint 通过 appcmd 修改 web.config 文件

> ID：11510386
> 
> 赞同：1
> 
> 时间：2012-07-16T18:33:46.837
> 
> 标签：sharepoint, iis, sharepoint-2010, appcmd

我想通过命令行修改特定网站的设置，但找不到该命令的语法。

我想更改文件 c:/inetpub/wwwroot/wss/VirtualDirectories//web.config 中的以下 xml 部分。

```
<configuration>...
   <SharePoint>...
     <BlobCache location="x"> 
```

我知道我可以通过 appcmd 修改文件 C:\Windows\System32\inetsrv\config\applicationhost.conf，但我不知道如何修改特定网站的 web.config 文件。我猜我需要做这样的事情

```
appcmd set config "<site name>" /section:sharepoint/blobcache /enabled="true" /commit:site 
```

但这会尝试修改文件 applicationhost.conf。

修改 web.config 文件的语法是什么，或者是否有其他实用程序可以比 appcmd 做得更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:28:34.577

由于您使用 SharePoint 2010 标记了此问题，因此我建议您使用 PowerShell 脚本来执行此操作。[technet.com 上的 Scripting Guy 有一篇博客文章描述了如何做到这一点](http://blogs.technet.com/b/heyscriptingguy/archive/2010/09/14/use-powershell-to-script-changes-to-the-sharepoint-web-config-file.aspx)。

他的解决方案让您使用[SPWebConfigModification](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spwebconfigmodification.aspx)类来操作现有 Web 应用程序的 web.config。

# jquery - 全局变量在函数内为空

> ID：11510392
> 
> 赞同：0
> 
> 时间：2012-07-16T18:33:59.223
> 
> 标签：jquery, ajax, variables, global-variables, scope

我有这个代码[http://jsfiddle.net/meridius/ysDGm/](http://jsfiddle.net/meridius/ysDGm/)问题出`out.id`在部分变量上`append`。由于我无法解释的原因，该变量在那部分是空的。

我认为问题在于该变量的范围，我尝试了一切，但没有运气。请注意，问题不在于 AJAX，它可以正常工作！

这是该小提琴的缩短版本：

```
<tr>
    <td>one</td>
    <td>
        <select name="zadavatel">
            <option value="0">-- vyberte --</option>
            <option value="new">-- nový zadavatel --</option>
        </select>
    </td>
</tr> 
```

```
var out = {};
$('select').bind("change", function() {
  if ($(this).val() == "new") {
    var nazev = prompt('Question', 
                $(this).parent().siblings(':first-child').text());
    if (nazev == null) {
      $(this).val($.data(this, 'current'));
      return false;
    } else {
      var pole2 = {};
      pole2["nazev"] = nazev;
      $.ajax({
        type    : "POST",
        cache    : false,
        url      : "./pokus_zad.php",
        data    : JSON.stringify(pole2),
        success  : function(data) {
          out = JSON.parse(data);  //data.id
        }
      });
      out.id = 15;  // this work, but it SHOULD work without it (with AJAX)
      $(this).closest('table').find('select').each(
        function() {
          $(this).append($('<option>', { "value" : out.id }).text(nazev));
        });
      $(this).closest('select').val(out.id).attr('selected', 'selected');
    }
  }
  $.data(this, 'current', $(this).val());
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:44:00.473

AJAX 是异步的，因此在其中设置`out`变量将在函数的其余部分之后发生。

```
 $.ajax({
        type    : "POST",
        cache    : false,
        url      : "./pokus_zad.php",
        data    : JSON.stringify(pole2),
        success  : function(data) {
          out = JSON.parse(data);  //data.id
          $(this).closest('table').find('select').each(
            function() {
              $(this).append($('<option>', { "value" : out.id }).text(nazev));
            });
          $(this).closest('select').val(out.id).attr('selected', 'selected');
        }
      }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:44:43.703

您应该将附加代码放在成功块内。因为 ajax 调用是异步的，所以 append 语句在 ajax 回调设置 'out' 变量之前运行。

```
var out = {};
$('select').bind("change", function() {
  if ($(this).val() == "new") {
    var nazev = prompt('Question', 
                $(this).parent().siblings(':first-child').text());
    if (nazev == null) {
      $(this).val($.data(this, 'current'));
      return false;
    } else {
      var pole2 = {};
      pole2["nazev"] = nazev;
      $.ajax({
        type    : "POST",
        cache    : false,
        url      : "./pokus_zad.php",
        data    : JSON.stringify(pole2),
        success  : function(data) {
          out = JSON.parse(data);  //data.id
          $(this).closest('table').find('select').each(
            function() {
              $(this).append($('<option>', { "value" : out.id }).text(nazev));
            });
          $(this).closest('select').val(out.id).attr('selected', 'selected');
        }
      });
    }
  }
  $.data(this, 'current', $(this).val());
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T08:13:00.963

太好了，谢谢各位！

根据您的建议，我将附加代码移至 AJAX 函数的成功回调，**并且**我还必须为 $(this) 创建变量，因为 AJAX 内部的 $(this) 与外部不同。;)

工作的 JQuery 部分现在看起来像这样：

```
var out = {};
$('select').bind("change", function() {
    if ($(this).val() == "new") {
        var nazev = prompt('Zadejte název zadavatele', $(this).parent().siblings(':first-child').text());
        if (nazev == null) {
            $(this).val($.data(this, 'current'));
            return false;
        } else {
            var select = $(this);
            var pole2 = {};
            pole2["nazev"] = nazev;
            $.ajax({
                type        : "POST",
                cache       : false,
                url         : "./pokus_zad.php",
                data        : JSON.stringify(pole2),
                success : function(data) {
                    out = JSON.parse(data); //data.id
                    select.closest('table').find('select').each(
                        function() {
                            $(this).append($('<option>', { "value" : out.id }).text(nazev));
                        });
                    select.val(out.id).attr('selected', 'selected');
                }
            });
        }
    }
    $.data(this, 'current', $(this).val());
}); 
```

# php - 数组到字符串转换错误

> ID：11510398
> 
> 赞同：2
> 
> 时间：2012-07-16T18:34:15.510
> 
> 标签：php, arrays, string, codeigniter, implode

我有一个查询正在提取 ID 列表。这些 ID 在一个数组中，我需要使用这些 ID 搜索另一个表。我尝试使用 implode 使这些 ID 成为可以在 where 子句中使用的字符串，但我不断收到此错误。

我目前的代码是：

```
 $query = $this->db->query('
        SELECT *
        FROM system_scoperights
        WHERE user = '. $this->session->userdata('username') .'
    ');

    foreach ($query->result() as $row) {
        $scope = $row->site;
        $data[] = $scope;
    } 
    $dataScope[] = $data;

    $idList = implode(',', $dataScope);   <---- Error Line

    $where = 'WHERE scope_scopes.sc_ID IN '. $idList .''; 
```

我尝试了在论坛上找到的不同方法，例如：

```
 $idList = implode(',', array_values($dataScope)); 
```

和

```
 $idList = implode(',', join($dataScope)); 
```

但这些都不起作用。（我什至从未听说过加入功能）

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T18:36:47.087

```
$dataScope[] = $data; 
```

但

```
$data[] = $scope; 
```

因此`$dataScope`在它的数组中有一个数组。`implode`仅在一个级别上工作，这就是为什么您会收到此错误。

您应该注意，这在 SQL 中实际上是可能的：

```
 SELECT * FROM some_table WHERE id IN (SELECT site FROM another_table WHERE ... ) 
```

这将消除对这段代码的全部需求。

那是：

```
$where = 'WHERE scope_scopes.sc_ID IN (SELECT site
                                       FROM system_scoperights
                                       WHERE user = '. $this->session->userdata('username') . ')'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T18:44:36.673

我部分同意杰的回答......只需删除该行：

```
$dataScope[] = $data 
```

并`$data`直接使用变量，因为它已经是一个数组：

```
$idList = implode(',', $data); 
```

但是，您还应该在 where 子句中使用 ( and ) ：

```
$where = 'WHERE scope_scopes.sc_ID IN (' . $idList . ')'; 
```

在你的 where 子句中使用子查询，虽然它们有时确实有它们的位置，但会花费很多开销，尤其是使用 'SELECT *'。永远不要从你的数据库表中要求超过你需要的东西:)

# css - 在不替换 HTML 宽度/高度属性的情况下自动调整 CSS 中的图像大小？

> ID：11510399
> 
> 赞同：0
> 
> 时间：2012-07-16T18:34:22.187
> 
> 标签：css

我正在尝试使图像在不破坏布局的情况下很好地适应不同的屏幕尺寸。下面的 CSS 有帮助：

```
.viewer .main img {
    max-width: 100%;
    height: auto;
} 
```

但麻烦的是这个形象的*变化*。每次图像更改时，我都会使用一些 Javascript 创建一个新的 img 元素，而不是重用现有的元素。（这对于我正在做的事情似乎更可靠一些）。浏览器在加载之前不知道图像的大小，在此期间会产生明显的闪烁。我通过在 HTML 中设置图像的宽度和高度属性来处理这个问题。*如果没有*上面的 CSS 规则，它可以正常工作。

使用该 CSS，闪烁仍然存在。出于某种原因，当我创建一个新的 img 元素时，CSS 似乎导致浏览器忽略了它的宽度和高度属性，所以。它最终像以前一样不知道纵横比。

这是一个 jsfiddle 来说明这种情况： http: [//jsfiddle.net/7sDtN/](http://jsfiddle.net/7sDtN/) 里面的一张图片非常非常大（138 MB），所以如果你使用的是计量连接，请小心:)

我想要的是让图像根据我在 HTML 中设置的尺寸进行缩放。最好以一种不错的方式。Javascript 解决方案并不是世界末日（当然，我已经在使用它了），但是如果有一个优雅的 CSS 解决方案会非常好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T19:29:49.420

我最终以迂回的方式解决了这个问题，将图像包装在一个专用容器中，以及一些看起来很奇怪的 javascript 以在图像加载时将其保持在适当的位置。该容器的尺寸按照 Sven 的答案计算，但最终它让浏览器接管。通过这种方式，布局更改保持在相当小，我们最终只在图像之间的一小段时间里做这些疯狂的事情。

为了完整起见，这是一大堆代码：

```
function Viewer(container) {
    var viewer = this;

    container = $(container);

    var pictureBox = $('.picture', container);
    var img = $('<img>').appendTo(pictureBox);

    var hide = function() {
        /* [snip] */
    }

    var getPictureDisplayHeight = function(picture) {
        var ratio = picture.data.h / picture.data.w;
        var displayWidth = Math.min(pictureBox.width(), picture.data.w);
        var displayHeight = Math.min(displayWidth * ratio, picture.data.h);
        return displayHeight;
    }

    var stopLoadingTimeoutId = undefined;
    var stopLoadingTimeout = function() {
        container.removeClass('loading');
    }

    var showPicture = function(picture) {
        var imgIsChanging = img.data('picture') != picture;

        container.show();

        /* This code expects to be cleaned up by stopLoadingTimeout or onImgLoaded, which will not fire if img src doesn't change */
        if (imgIsChanging) {
            container.addClass('loading');
            window.clearTimeout(stopLoadingTimeoutId);
            stopLoadingTimeoutId = window.setTimeout(stopLoadingTimeout, 3000);
        }

        pictureBox.css({
            'min-height' : pictureBox.height()
        });

        var displayHeight = getPictureDisplayHeight(picture);
        if (displayHeight > pictureBox.height()) {
            /* Grow pictureBox if necessary */
            pictureBox.stop(true, false);
            pictureBox.animate({
                'height' : displayHeight
            }, 150);
        }

        /* I wish I could set width and height here, but it causes the current image to stretch */
        img.attr({
            'src' : picture.fullPath
        }).data('picture', picture);
    }

    var onImgLoaded = function(event) {
        /* The load event might not be fired, so nothing here should be essential */

        var picture = img.data('picture');

        container.removeClass('loading');

        var displayHeight = getPictureDisplayHeight(picture);
        pictureBox.stop(true, false);
        pictureBox.animate({
            'min-height' : 0,
            'height' : displayHeight
        }, 150, function() {
            pictureBox.css('height', 'auto');
        });

        window.clearTimeout(stopLoadingTimeoutId);
    }

    var onImgClicked = function(event) {
        selectNextPicture();
    }

    var onPictureSelectedCb = function(picture) {
        if (picture) {
            showPicture(picture);
        } else {
            hide();
        }
    }

    var init = function() {
        img.on('click', onImgClicked);
        img.on('load', onImgLoaded);
    }
    init();
} 
```

相关HTML：

```
<div class="viewer" style="display: none;">
    <div class="picture"></div>
    <div class="caption"><div class="caption-text"></div></div>
</div> 
```

和 CSS：

```
.viewer .picture img {
    display: block;
    margin: 0 auto;
    max-width: 100%;
    height: auto;
} 
```

这样，我们在图像周围留出空间，要么是下一个图像的大小，要么是当前图像的大小，而不是在加载新图像之前似乎发生的较小尺寸（由于某种原因，这种情况一直在发生）。可能有一百万种解决方案，而我的解决方案并不是特别直截了当，所以我当然很想看到其他人:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:11:29.720

如果我理解正确，您可以使用以下代码实现您的目标

HTML

```
<div id="Wrapper">
    <img id="MyPic" src="http://www.davidstorey.tv/wp-content/uploads/2012/05/image.php_.jpeg" alt="" width="300" height="200" />
</div> 
```

CSS

```
body{
    width:100%;
}

#Wrapper{
    width:98%;
    border:1px solid red;
} 
```

jQuery

```
$("document").ready(function(){
    var ratio=$("#MyPic").width() / $("#MyPic").height();
    $("#MyPic").css("width","100%");
    $("#MyPic").css("height", $("#MyPic").width()/ratio+"px");
}); 
```

这是[jsfiddle的链接](http://jsfiddle.net/utXum/)

# c# - JSON 无法获取数据

> ID：11510402
> 
> 赞同：0
> 
> 时间：2012-07-16T18:34:32.233
> 
> 标签：c#, json

您好我正在尝试在 C# 中解析 JSON 页面，但我似乎无法读取一些字符串，例如：

```
"versions": [
    {
        "date": 1340466559, 
        "dl_link": "http://dev.bukkit.org/media/files/599/534/NoSwear.jar", 
        "filename": "NoSwear.jar", 
        "game_builds": [
            "CB 1.2.5-R4.0"
        ], 
        "hard_dependencies": [], 
        "md5": "d0ce03e817ede87a9f76f7dfa67a64cb", 
        "name": "NoSwear v5.1", 
        "soft_dependencies": [], 
        "status": "Semi-normal", 
        "type": "Release"
    }, 
```

我怎么能读到呢？这是我现在拥有的代码，适用于除此之外的所有其他内容：

```
public static void GetMoreInfo(string plugin)
{
    try
    {
        string url = "http://bukget.org/api/plugin/";

        var wc = new WebClient();
        var json = wc.DownloadString(url + plugin);
        var moreInfo = JsonConvert.DeserializeObject<MoreInfo>(json);

        foreach (var category in moreInfo.categories)
        {
            Categories += category + ", ";
        }
        Categories = Categories.Remove(Categories.Length - 2, 2);
    }
    catch (Exception)
    {

    }
    finally
    {
        if (string.IsNullOrEmpty(Categories))
        {
            Categories = "No data found.";
        }
    }
}

public class MoreInfo
{
    public string[] categories;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:15:56.600

如何处理您的 json `dynamically`，而不是反序列化为具体类？

```
var wc = new WebClient();
var json = wc.DownloadString("http://bukget.org/api/plugin/test");

dynamic moreInfo = JsonConvert.DeserializeObject(json);

Console.WriteLine("{0} {1} {2}", moreInfo.name, moreInfo.desc, moreInfo.status);
string categories = String.Join(",", moreInfo.categories);
Console.WriteLine(categories); 
```

还是您更喜欢经典方法？

```
var plugin = JsonConvert.DeserializeObject<Plugin>(json);
string categories = String.Join(",",plugin.categories);

public class Plugin
{
    public List<string> authors;
    public string bukkitdev_link;
    public List<string> categories;
    public string desc;
    public string name;
    public string plugin_name;
    public string status;
    public List<Version> versions;
}

public class Version
{
    public string date;
    public string filename;
    public string name;
    //.......
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:42:03.783

我可能是错的，但是您收到的 JSON 是一个名为的数组`versions`，但您试图将其反序列化为一个`MoreInfo`对象，该对象公开一个名为的数组`categories`（除非它只是您的示例中的错字）。您是否尝试过重命名`MoreInfo.categories`为`MoreInfo.versions`？

**更新**

我认为这不会产生影响，因为 JSON 转换器不知道如何处理数组中的每个对象。您需要提供一个对象来反序列化 JSON 数组中的每个元素。

例如，尝试修改`MoreInfo`对象以包含与 JSON 字符串匹配的属性（数组中的元素）

```
[DataContract]
public class MoreInfo
{
  [DataMember]
  public DateTime date { get; set; }

  [DataMember]
  public string dl_link { get; set; }
  ...
} 
```

然后尝试将 JSON 字符串反序列化为`List<MoreInfo>`：

`JsonConverter.DeserializeObject<List<MoreInfo>>(json)`

然后，您必须修改其余代码以使用`MoreInfo`对象而不是数组中的字符串。

**参考这个答案**

看到这个问题，接受的答案应该可以帮助您解决问题：[Json.NET: Deserialization with list of objects](https://stackoverflow.com/questions/7523504/json-net-deserialization-with-list-of-objects)

# hadoop - oozie 可以忽略丢失的输入文件吗？

> ID：11510404
> 
> 赞同：1
> 
> 时间：2012-07-16T18:34:42.640
> 
> 标签：hadoop, oozie

在我的 oozie coordinator.xml 文件中，我将以下内容定义为输入目录：

```
<property>
    <name>countingHourlyInputDir</name>
    <value>${coord:dataIn('hourly-input')}/*Pattern1*,${coord:dataIn('hourly-input')}/*Pattern2*</value>
</property> 
```

这匹配文件名与“Pattern1”或“Pattern2”匹配的目录中的文件。如果目录包含文件 Pattern1 文件和 Pattern2 文件，我的作业运行没有问题。但是，如果该目录仅包含 Pattern1 文件或 Pattern2 文件，我的工作将失败，并且我收到如下错误：

> Oozie Launcher 失败，主类 [org.apache.oozie.action.hadoop.MapReduceMain]，main() 抛出异常，输入模式 hdfs://hdfsPath/logs/2012/07/09/02/ *Pattern1*匹配 0 个文件 org. apache.hadoop.mapreduce.lib.input.InvalidInputException：输入模式 hdfs://hdfsPath/logs/2012/07/09/02/ *Pattern1*匹配 0 个文件

有没有办法告诉 Oozie 忽略这个错误，以便 MapReduce 作业仍然在匹配 Pattern2 的文件上执行，而不是使整个作业失败？

* * *

**更新：**

我自己想出了解决方案，我将记录我所做的事情，以防其他人稍后遇到这个问题。

我创建了一个名为 RegexPathFilter 的类，它实现了 PathFilter 和 Configurable。我通过在 oozie workflow.xml 中指定*mapred.input.pathFilter.class*属性将此过滤器传递给 hadoop 作业。这是我的课程和我的配置片段：

```
public class RegexPathFilter implements PathFilter, Configurable {

    public static final String CONF_REGEX_PROPERTY = "regexPathFilter.regex";
    private static final Log LOG = LogFactory.getLog(RegexPathFilter.class);
    private String _regex;
    private Configuration _conf;

    public RegexPathFilter() {

    }

    @Override
    public void setConf(Configuration conf) {
        _conf = conf;
        //get regex from Configuration
        _regex = _conf.get(CONF_REGEX_PROPERTY);
    }

    @Override
    public Configuration getConf() {
        return _conf;
    }

    public boolean accept(Path path) {
        if(_regex == null) {
            throw new IllegalStateException("RegexPathFilter must be given a regex to filter with.");
        }

        boolean matches = path.toString().matches(_regex);

        LOG.info(path + (matches ? " matches " : " does NOT match ") + _regex);
        return matches;
    }
} 
```

工作流.xml：

```
<property>
    <name>mapred.input.pathFilter.class</name>
    <value>com.company.project.hadoop.util.RegexPathFilter</value>
</property>
<property>
    <name>regexPathFilter.regex</name>
    <value>.*(Pattern1|Pattern2).*</value>
</property> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T12:11:03.930

这个问题背后的原因是[https://issues.apache.org/jira/browse/HADOOP-8870](https://issues.apache.org/jira/browse/HADOOP-8870)

我也面临同样的问题，并通过对模式和零代码进行轻微更改来解决它。

代替

```
<property>
    <name>countingHourlyInputDir</name>
    <value>${coord:dataIn('hourly-input')}/*Pattern1*,${coord:dataIn('hourly-input')}/*Pattern2*</value>
</property> 
```

和

```
<property>
    <name>countingHourlyInputDir</name>
    <value>{${coord:dataIn('hourly-input')}}/{*Pattern1*,*Pattern2*}</value>
</property> 
```

在这个替换之后，只有当目录包含既不匹配 pattern1 也不匹配 pattern2 的文件时，hadoop 才会抛出错误。

# php - 仅选择有学分的网站

> ID：11510405
> 
> 赞同：0
> 
> 时间：2012-07-16T18:34:50.393
> 
> 标签：php, mysql, limit

我有一个交通交换网站，我在冲浪区有一个小问题。

通常脚本应该只选择有信用但没有信用的网站。

我在谷歌和这里也搜索，但我找不到我的答案。

```
$hour = date('Y-m-d:H');
$res = mysql_query("update site set hour='$hour', cth=0 where hour!='$hour' && cph!=0");
$query = "select id, url from site where usrid!=".$_SESSION['sess_data']['usrid']." && state='Enabled'";
if ($_SESSION['sess_data']['negact'] == 0) {
    $query = $query." && credits>=1";
}
$query = $query." && (cth<cph || cph=0)";
$query = $query." order by rand() limit 1";
$res = mysql_query($query);
if (mysql_num_rows($res) == 0) {
    $url = $default_site;
    $siteid = 0;
} else {
    $url = mysql_result($res, 0, "url");
    $siteid = mysql_result($res, 0, "id");
} 
```

如果我是对的，这就是脚本获取网站的部分。

```
$query = "select id, url from site where usrid!=" . $_SESSION['sess_data']['usrid'] . " && state='Enabled'"; 
```

在这一行中，我想添加一个限制，以选择具有 +5 积分的站点。（再次，如果我是对的）

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:39:03.720

使用“ `WHERE credits > 5`”或任何你的“学分”列。

# ios - 为什么我不能从父 VC 更改子 VC 的文本视图的文本？

> ID：11510407
> 
> 赞同：0
> 
> 时间：2012-07-16T18:34:59.643
> 
> 标签：ios, storyboard

我正在开发一个应用程序，我需要从父视图控制器中的方法更改子视图控制器的文本视图的文本。

我在子 VC 中有一个按钮，当按下它时，视图不会改变，但是会调用父 VC 中的一个方法，而父 VC 中的另一个方法会更改子 VC 中文本视图的文本。

```
[self.delegate buttonPressed];//in child VC, call method in parent VC 
```

在我使用情节提要之前它正在工作。在父vc中，我只有下面的代码，

```
childViewControler.textViewName.text=@"something"; 
```

现在我改为storyboard，通过使用NSLog，我知道改变文本的方法被调用了。但不显示任何文字。我想我可能会添加一些东西，因为我现在正在使用故事板？有人可以给我建议吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:26:33.480

父视图控制器中的`childViewControler`变量需要指向 segue 创建的子视图控制器类的实例。如果你不给它分配任何东西，它就是`nil`，并且任何给它的消息什么都不做。

从您发布的代码中不清楚它是属性、实例变量还是局部变量；这是使用实例变量执行此操作的方法：

```
@implementation ParentViewController
{
    ChildViewController *childViewController;
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    // if you have multiple segues, check segue.identifier
    // so you only do this for the correct segue
    childViewController = segue.destinationViewController;
}

- (void)buttonPressed
{
    childViewController.textViewName.text=@"something";
}
@end 
```

关键在于`prepareForSegue:sender:`——您需要确保`childViewController`变量指向由 segue 创建的视图控制器。

* * *

您的问题也可能是由于仍然有一些旧的故事板代码`alloc`和`init`子视图控制器并将其放入您的`childViewController`变量中。在这种情况下，您将拥有该视图控制器类的两个实例：由 segue 创建的一个和您创建的一个。只有由 segue 创建的一个被连接到 UI 中，因此您对另一个所做的任何更改都将不可见。您可以通过摆脱创建和呈现子视图控制器的任何代码来解决这个问题——故事板现在负责所有这些，并且`prepareForSegue:sender:`是您唯一需要获取对子视图控制器的引用的地方。

# java - 如何监控 ProcessBuilder 运行的外部进程？

> ID：11510409
> 
> 赞同：6
> 
> 时间：2012-07-16T18:35:14.607
> 
> 标签：java, multithreading, process

这应该很简单，但我在[JavaDocs](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ProcessBuilder.html)中看不到任何帮助。

我需要的是从我的 Java 代码运行一些外部进程，然后能够监视该进程是否已关闭。换句话说，我希望能够可靠地确定我的外部进程是否未被用户结束。

如果不存在跨平台解决方案，我将接受任何在 Linux 下工作的东西。

我当前的代码片段：

```
public static void main(String[] args) {
    ProcessBuilder pb = new ProcessBuilder("some proces name");

    try {
        Process p = pb.start();
        // p.isRunning(); <- now, that would be helpful :-)
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T18:50:35.377

启动一个新线程，该线程`Process.waitFor()`在该调用返回时调用并设置一个标志。然后，您可以随时检查该标志，以查看该过程是否已完成。

```
public class ProcMon implements Runnable {

  private final Process _proc;
  private volatile boolean _complete;

  public boolean isComplete() { return _complete; }

  public void run() {
    _proc.waitFor();
    _complete = true;
  }

  public static ProcMon create(Process proc) {
    ProcMon procMon = new ProcMon(proc);
    Thread t = new Thread(procMon);
    t.start();
    return procMon;
  }
} 
```

（省略了一些样板）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T18:40:25.587

我不确定我是否理解这个问题，但一种方法是调用`process.exitValue();`. 如果进程尚未终止，则会引发异常：

```
/**
 * Returns the exit value for the subprocess.
 *
 * @return  the exit value of the subprocess represented by this 
 *          <code>Process</code> object. by convention, the value 
 *          <code>0</code> indicates normal termination.
 * @exception  IllegalThreadStateException  if the subprocess represented 
 *             by this <code>Process</code> object has not yet terminated.
 */
abstract public int exitValue(); 
```

如果您不介意 hack，如果您在使用`UNIXProcess`该类的 ~Unix 系统上工作，则可以执行以下操作。但是，这确实使用了反射：

```
ProcessBuilder pb = new ProcessBuilder("/bin/sleep", "5");
Process process = pb.start();
// open accessability of the UNIXProcess.hasExited field using reflection
Field field = process.getClass().getDeclaredField("hasExited");
field.setAccessible(true);
// now we can get the field using reflection
while (!(Boolean) field.get(process)) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-12T17:49:06.107

根据问题的特定代码片段，我可能有用的是添加自 1.8 以来`Process`该类有一个`isAlive()`方法可用

文档链接：[https ://docs.oracle.com/javase/8/docs/api/java/lang/Process.html](https://docs.oracle.com/javase/8/docs/api/java/lang/Process.html)

祝所有阅读本文的人好运！

# python - 相当于 wxPython 中 SWT 的 .pack() 吗？

> ID：11510412
> 
> 赞同：2
> 
> 时间：2012-07-16T18:35:35.620
> 
> 标签：python, wxpython, size, swt, pack

在 wxPython 中，是否有以下简短形式：

```
size = object.GetBestSize()
object.SetSize(size) 
```

（对于控件或框架和对话框。）`.Layout()`仅调整子控件的大小。

在[SWT](http://www.eclipse.org/swt/)中有`.pack()`这个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:44:22.307

除非您明确设置小部件的大小，否则它们通常已经调整到正确的大小。如果您将小部件添加到 sizer 并告诉它们拉伸，那么当然不会出现这种情况。您也可以使用 sizer 的 Fit() 方法来强制它，尽管我很少认为这是必要的。

# java - 如何与其他开发者共享 Java 项目？

> ID：11510415
> 
> 赞同：1
> 
> 时间：2012-07-16T18:35:44.640
> 
> 标签：java, eclipse, code-sharing

我正在与一个合作者一起开发一个 Java 项目，我们都在使用 Eclipse 编辑器。我想做的是能够与他共享 .java 文件，这样我们就可以分别编辑它，但看看对方写了什么。目前，我通过共享一个包含项目的 Dropbox 文件夹来做这是一种临时的方式。但是，这种方法效果不佳，因为他使用的是不同版本的 Java（因为他运行的是 Mac，而我使用的是 Windows）。为了让我运行该项目，我必须清除他创建的所有 .class 文件，这些文件将出现在我的计算机上，因为 Dropbox 只是共享所有文件。

我听说过 CVS 是一种在开发人员之间管理文件共享的方法，但听起来工作量很大。例如，我不知道如何获得 CVS 服务器或如何使其工作。有没有一种简单直接的方法可以让我们在同一个 Java 项目上一起工作？GitHub 是答案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T18:44:28.960

这绝对是源代码控制的工作，正如其他答案所提到的，Git 或 SVN 可能是您的最佳选择。Git 是较新的，并且正在获得大量的人气（可能要感谢 GitHub）。

GitHub 非常容易学习，甚至可以使用他们新的[GitHub for Windows 客户端](http://windows.github.com/)为您处理许多更困难的任务。他们还有一个[GitHub for Mac 客户端](http://mac.github.com/)。一旦您对该工具更加熟悉，您就可以获得 Eclipse 的 EGit 插件，这样您就可以直接从 IDE 控制源代码控制。

此外，GitHub 还为学习 git创建了一个在线[互动教程。](http://try.github.com/levels/1/challenges/1)

至于清除类文件（以及来自 eclipse 的 .settings 和 .project 和 .classpath 文件），您可以指示 git 使用[.gitignore](https://help.github.com/articles/ignoring-files)文件忽略这些类型的文件。[您可以在此处](https://github.com/github/gitignore/blob/master/Java.gitignore)找到各种语言（包括 Java）的模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:39:35.850

你可以花时间学习 git：[https ://help.github.com/articles/set-up-git](https://help.github.com/articles/set-up-git)

这是一个非常有价值的工具，一旦你习惯了它，共享代码将非常容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:43:18.153

或者更好的是，Mercurial。它遵循与 Git 相同的方法，但更简单且工作轻松。要在当前目录中启动存储库，只需运行：

```
hg init 
```

查看[文档](https://www.mercurial-scm.org/)以获取更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:39:38.493

我推荐“Subversion”谷歌它并查看信息。您可以轻松签出文件并签入。祝您好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T18:41:27.170

CVS 正在变老，人们正在从它转向其他源代码控制工具

最著名的工具是 SVN 和 Git。还有其他工具，但不太出名我相信如果你要在团队中工作（或者甚至单独工作），你肯定需要一个软件修订工具，因为它标志着所做的更改，时间和人员等...例如，谷歌代码提供了一种简单的方法来在一分钟内设置您的 svn 存储库。根据您的需要，也有很多公司免费或以小额费用在线提供此类服务。所以如果你只需要一个沙箱，那么在谷歌代码上设置一个 svn 并尝试一下

代码修订工具几乎是每个程序员的必备品

祝你好运

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T18:40:45.373

根据您未来的计划，Git 或 Subversion 会很好。在使用了多年的 SVN 之后，我终于切换到了 Git。

请注意，除了 Github（这很棒）之外，还有一些其他存储库托管服务，其中一些提供免费的“个人”帐户（大多数将您的代码公开，但我认为一些仍然为您提供有限的空间自由的）。

# python - Python 显示错误 - 未定义名称“对象”

> ID：11510416
> 
> 赞同：10
> 
> 时间：2012-07-16T18:35:46.807
> 
> 标签：python

Python 解释器在使用 Object 时显示 NameError。

```
>>> class test(Object): pass
... 
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'Object' is not defined 
```

Python 版本是 2.7.3。

我无法删除此错误。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-16T18:37:19.533

[`object`](http://docs.python.org/reference/datamodel.html#basic-customization)必须是小写。尝试

```
>>> class test(object): pass 
```

在 Python 3.x 中，您也可以将其省略：

```
>>> class test: pass 
```

（在 2.x 中，在你准备好面对[经典类](http://docs.python.org/reference/datamodel.html#new-style-and-classic-classes)的怪物之前，你不应该这样做）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-06-03T14:31:06.887

是的，需要小写：

```
#define class

class Student(object):

print('start')

# name & score

def _init_(self, name, score):
        self.name = name
        self.score = score

    def printScore(self):
        print('%s: %s' % (self.name, self.score))

    def set_score(self, value):
        if not isinstance(value, int):
            raise ValueError('score must be an Integer')
        if value < 0 or value > 100:
            raise ValueError('score must between 0 ~ 100!')

        self.score = value

    def get_score(self):
        return self.score 
```

# java - Java效率——子对象引用父对象

> ID：11510422
> 
> 赞同：2
> 
> 时间：2012-07-16T18:36:11.860
> 
> 标签：java, android, oop, garbage-collection

我是 java/garbage 收集语言的新手，但我仍然对拥有对象引用的含义有所了解（因为我被告知它不是指针？）所以我正在思考这个问题：

我有一个父/子对象结构，其中父级将有几个包含多个子级的列表...是否有任何效率低下或任何其他原因不让每个子级中的指针返回其父级？在我以前的语言（Delphi）中，它是一个简单的指针，所以根本不是问题。Java中的这种做法是否有任何考虑？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:40:39.710

这里应该没有问题。从技术上讲是的，Java 引用不是指针，但对于大多数问题，您可以类似地考虑它们。对象引用是指向 Java 堆中位置的整数。因此，它存储的每个额外位置都是一个额外的整数。一般而言，相当小。

当涉及到对象管理时，您可以（通常！）相信 Java 会做正确的事情，并且不必过多担心垃圾收集或对象引用如何工作的复杂性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:40:31.060

据我所知，我会说你这样做会很好。Java 在清理垃圾方面做得很好，我通常在子类中有一个“父”字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:46:19.493

正如之前的答案所述，一般来说，GC 非常适合清理事情。你主要关心的是一旦你离开活动，坚持下去的事情，坚持上下文。这将导致您的 Activity 留在内存中，因为您对它的引用不在它的父子树中。

更多关于[这里](http://android-developers.blogspot.com/2009/01/avoiding-memory-leaks.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T18:47:04.003

我认为如果你也阅读参考类型会很有帮助——强、弱、幻像和软，因为它会有所帮助。此外，请阅读 GC 的工作原理（针对不同代 - 年轻/幸存者空间和老一代）、要使用的垃圾收集器以及您可以指定的 GC 参数。

# sql - 将递归限制在某个级别

> ID：11510426
> 
> 赞同：0
> 
> 时间：2012-07-16T18:36:42.133
> 
> 标签：sql, sql-server, sql-server-2008, recursion

我有一个名为 Player 的 SQL 表和另一个名为 Team 的 SQL 表。

*   每个玩家必须通过外键属于一个团队`TeamID`。
*   每个团队可以通过递归字段属于另一个团队`ParentTeamID`。

所以它可能是（自上而下）......

*   A队
*   B队
*   Team76
*   组8
*   播放器_ME

我的问题是，如果给我一个玩家`PlayerID`（那张桌子的 PK），那么获得顶级团队的最佳方式是什么？

到目前为止我的查询（获得所有团队）：

```
WITH TeamTree
    AS (
        SELECT ParentTeam.*, Player.PlayerID, 0 as Level
        FROM Team ParentTeam
        INNER JOIN Player ON Player.TeamID = ParentTeam.TeamID
        WHERE Player.PlayerID IN (SELECT * FROM dbo.Split(@PlayerIDs,','))
        UNION ALL 
        SELECT ChildTeam.*, TeamTree.PlayerID AS PlayerID, TeamTree.Level + 1
        FROM Team ChildTeam
                INNER JOIN TeamTree TeamTree
        ON ChildTeam.TeamID = TeamTree.ParentTeamID
    ) 
```

现在虽然我认为这是开始的正确地方，但我认为可能有更好的方法。另外我有点卡住了！我尝试在连接中（在子查询中）使用 Level，但它没有用。

关于如何在树上工作并仅获得顶级细节的任何想法？

编辑：

ParentTeam 可以是 ParentTeam（无限递归），但 Player 只能属于一个 Team。

数据结构团队：TeamID (PK)、Name、ParentTeamID（递归字段）

玩家：PlayerID (PK)、姓名、TeamID (FK)

样本数据：

```
Team:
1, TeamA, NULL
2, TeamB, 1
3, Team76, 2
4, Group8, 3

Player:
1, Player_ME, 4
2, Player_TWO, 2 
```

因此，使用上述数据，两个玩家都应该（在查询中）显示他们拥有 TeamA 的“TopLevelTeam”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:47:02.537

我相信这就是您正在寻找的东西，并免费提供了一些额外的信息 :-) Andrew 在他的编辑版本中有正确的想法，但我认为他的实现是不正确的。

架构和查询可在[SQL Fiddle获得](http://sqlfiddle.com/#!3/c4a4e/10)

```
with teamCTE as (
  select TeamID,
         TeamName,
         cast(null as int) as ParentTeamID,
         cast(null as varchar(10)) as ParentTeamName,
         TeamID TopTeamID,
         TeamName TopTeamName,
         1 as TeamLevel
    from team
   where ParentTeamID is null
  union all
  select t.TeamID,
         t.TeamName,
         c.TeamID,
         c.TeamName,
         c.TopTeamID,
         c.TopTeamName,
         TeamLevel+1 as TeamLevel
    from team t
    join teamCTE c
      on t.ParentTeamID = c.TeamID
)
select p.PlayerID,
       p.PlayerName,
       t.*
  from player p
  join teamCTE t
    on p.TeamID = t.TeamID 
```

**编辑 - 回答评论中的问题**

只需第二次加入 CTE，您就可以导航到玩家团队层次结构中的任何级别。在您的情况下，您要求排名第二的团队：[SQL Fiddle](http://sqlfiddle.com/#!3/c4a4e/18)

```
with teamCTE as (
  select TeamID,
         TeamName,
         cast(null as int) as ParentTeamID,
         cast(null as varchar(10)) as ParentTeamName,
         TeamID TopTeamID,
         TeamName TopTeamName,
         1 as TeamLevel
    from team
   where ParentTeamID is null
  union all
  select t.TeamID,
         t.TeamName,
         c.TeamID,
         c.TeamName,
         c.TopTeamID,
         c.TopTeamName,
         TeamLevel+1 as TeamLevel
    from team t
    join teamCTE c
      on t.ParentTeamID = c.TeamID
)
select p.PlayerID,
       p.PlayerName,
       t1.*,
       t2.TeamID Level2TeamID,
       t2.TeamName Level2TeamName
  from player p
  join teamCTE t1
    on p.TeamID = t1.TeamID
  join teamCTE t2
    on t1.TopTeamID = t2.TopTeamID
   and t2.TeamLevel=2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:10:57.273

```
WITH TeamTree
    AS (
        SELECT ParentTeam.*, Player.PlayerID AS UrPlayerID, 0 as Level
        FROM Team ParentTeam
        INNER JOIN Player ON Player.TeamID = ParentTeam.TeamID
        WHERE Player.PlayerID IN (SELECT * FROM dbo.Split(@PlayerIDs,','))
        UNION ALL 
        SELECT ChildTeam.*, TeamTree.PlayerID AS PlayerID, TeamTree.Level + 1
        FROM Team ChildTeam
                INNER JOIN TeamTree TeamTree
        ON ChildTeam.ParentTeamID = TeamTree.TeamID /* These were reversed, I think */
           AND UrPlayerID=ChildTeam.PlayerID /* ADDED */
    ) 
```

否则你会得到大量重复的行，比如玩家数量的平方，不是吗？

- （在下面的评论之后）非常正确，我误读了架构。看，直到最后你都不需要把玩家带进来。我认为团队树的排列可能因玩家而异，但事实并非如此。所以

```
WITH recursive TeamTree AS (
   SELECT TeamID, ParentTeamID FROM Team T1
   UNION ALL
   SELECT T1.TeamID, T2.ParentTeamID FROM T1 JOIN T2 ON T1.ParentTeamID=T2.TeamID
   )
 SELECT TeamTree.* FROM TeamTree JOIN Team T3 
      ON TeamTree.ParentTeamID=T3.TeamID WHERE T3.ParentTeamID IS NULL; 
```

这为您提供了每个团队及其根祖先的表。现在将它加入到玩家表中。

```
SELECT * FROM Player JOIN  (WITH TeamTree AS (
       SELECT TeamID, ParentTeamID FROM Team T1
       UNION ALL
       SELECT T1.TeamID, T2.ParentTeamID FROM T1 JOIN T2 ON T1.ParentTeamID=T2.TeamID
       )
     SELECT TeamTree.* FROM TeamTree JOIN Team T3 
          ON TeamTree.ParentTeamID=T3.TeamID WHERE T3.ParentTeamID IS NULL) teamtree2
     ON Player.TeamID=teamtree2.TeamID; 
```

`Team`如果您需要更多列，您可以重新加入。

# zend-framework - 清除视图中的占位符

> ID：11510435
> 
> 赞同：0
> 
> 时间：2012-07-16T18:37:01.223
> 
> 标签：zend-framework, placeholder

我的布局中有一个占位符，如下所示：

```
<?php if($this->placeholder('hide_login_form')) : echo new Default_Form_Login(); endif?> 
```

但是我需要在我的视图中删除/清除这个占位符，因为我不需要在另一个页面中使用这个相应的表单。

有人知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:52:04.027

`set`从您的角度来看，尝试使用空字符串调用占位符的方法：

```
$this->placeholder('hide_login_form')->set(''); 
```

这将用空值替换它包含的任何值。

# iphone - 使用 coredata iPhone 中的代码在两个实体之间创建关系

> ID：11510438
> 
> 赞同：0
> 
> 时间：2012-07-16T18:37:16.103
> 
> 标签：iphone, ios, core-data

在代码中创建 ManageObjectModel 时，我正在创建两个实体及其属性。但问题是我如何在两个实体之间创建关系 1 到多个关系。我的代码如下。我只想使用代码在两个员工和组织实体之间建立一对多的关系。

```
- (NSManagedObjectModel *)managedObjectModel
{
    if (__managedObjectModel != nil) {
        return __managedObjectModel;
    }

    __managedObjectModel = [[NSManagedObjectModel alloc] init];

    NSEntityDescription *employeeEntity = [[NSEntityDescription alloc] init];
    [employeeEntity setName:@"Employee"];
    [employeeEntity setManagedObjectClassName:@"Employee"];

    NSEntityDescription *organizationEntity = [[NSEntityDescription alloc] init];
    [organizationEntity setName:@"Organization"];
    [organizationEntity setManagedObjectClassName:@"Organization"];
    [__managedObjectModel setEntities:[NSArray arrayWithObjects:employeeEntity, organizationEntity, nil]];

    NSAttributeDescription *nameAttribute = [[NSAttributeDescription alloc] init];    
    [nameAttribute setName:@"name"];
    [nameAttribute setAttributeType:NSDateAttributeType];
    [nameAttribute setOptional:NO];    

    NSAttributeDescription *idAttribute = [[NSAttributeDescription alloc] init];    
    [idAttribute setName:@"id"];
    [idAttribute setAttributeType:NSInteger32AttributeType];
    [idAttribute setOptional:NO];

    NSArray *properties = [NSArray arrayWithObjects: nameAttribute, idAttribute, nil];
    [employeeEntity setProperties:properties];

    NSAttributeDescription *organizationNameAttribute = [[NSAttributeDescription alloc] init];
    [organizationNameAttribute setName:@"Name"];
    [organizationNameAttribute setAttributeType:NSStringAttributeType];
    [organizationNameAttribute setOptional:NO];        

    properties = [NSArray arrayWithObjects:organizationNameAttribute, nil];
    [organizationEntity setProperties:properties];

    return __managedObjectModel;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:12:37.020

如果您真的想在代码中执行此操作，则必须创建一个`NSRelationshipDescription`并将其添加到源对象的属性中。

这是[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSRelationshipDescription_Class/NSRelationshipDescription.html#//apple_ref/occ/cl/NSRelationshipDescription)。

创建对象并`setMaxCount:`在分配之前调用它。如果您查看该`isToMany`方法的文档，您会看到它说：

`YES if the receiver represents a to-many relationship (its maxCount is greater than 1) otherwise NO.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-04T18:32:41.017

这是我们`NSManagedObjectModel`从代码（Swift 4）进行配置的方式。

```
public class IssueList: NSManagedObject {

   @NSManaged public var title: String
   @NSManaged public var issues: Set<Issue>
}

public class Issue: NSManagedObject {

   @NSManaged public var title: String
   @NSManaged public var issueList: IssueList
}

class PCDBStack: DBStack {

   override func setupModel() -> NSManagedObjectModel {

      let issueListEntity = makeIssueListEntity()
      let issueEntity = makeIssueEntity()

      // To-many relationship from "IssueList" to "Issue"
      let issueListToIssueRelation = NSRelationshipDescription()

      // To-one relationship from "Issue" to "IssueList"
      let issueToIssueListRelation = NSRelationshipDescription()

      issueListToIssueRelation.name = #keyPath(IssueList.issues)
      issueListToIssueRelation.minCount = 0
      issueListToIssueRelation.maxCount = 0 // max = 0 for to-many relationship
      issueListToIssueRelation.deleteRule = .cascadeDeleteRule
      issueListToIssueRelation.destinationEntity = issueEntity
      issueListToIssueRelation.inverseRelationship = issueToIssueListRelation

      issueToIssueListRelation.name = #keyPath(Issue.issueList)
      issueToIssueListRelation.minCount = 0
      issueToIssueListRelation.maxCount = 1 // max = 1 for to-one relationship
      issueToIssueListRelation.deleteRule = .nullifyDeleteRule
      issueToIssueListRelation.destinationEntity = issueListEntity
      issueToIssueListRelation.inverseRelationship = issueListToIssueRelation

      issueListEntity.properties.append(issueListToIssueRelation)
      issueEntity.properties.append(issueToIssueListRelation)

      let model = NSManagedObjectModel()
      model.entities = [issueEntity, issueListEntity]
      return model
   }

   private func makeIssueListEntity() -> NSEntityDescription {

      let attributeTitle = NSAttributeDescription()
      attributeTitle.name = #keyPath(IssueList.title)
      attributeTitle.attributeType = .stringAttributeType
      attributeTitle.isOptional = false

      let entityDescription = NSEntityDescription()
      entityDescription.name = IssueList.entityName
      entityDescription.managedObjectClassName = IssueList.entityClassName
      entityDescription.properties = [attributeTitle]

      return entityDescription
   }

   private func makeIssueEntity() -> NSEntityDescription {

      let attributeTitle = NSAttributeDescription()
      attributeTitle.name = #keyPath(Issue.title)
      attributeTitle.attributeType = .stringAttributeType
      attributeTitle.isOptional = false

      let entityDescription = NSEntityDescription()
      entityDescription.name = Issue.entityName
      entityDescription.managedObjectClassName = Issue.entityClassName
      entityDescription.properties = [attributeTitle]

      return entityDescription
   }
} 
```

有用的`NSManagedObject`扩展：

```
extension NSManagedObject {

    public static var entityName: String {
        let className = NSStringFromClass(self) // As alternative can be used `self.description()` or `String(describing: self)`
        let entityName = className.components(separatedBy: ".").last!
        return entityName
    }

    public static var entityClassName: String {
        let className = NSStringFromClass(self)
        return className
    }
} 
```

# bash - 在 UNIX 中搜索目录或文件的最简单方法是什么？

> ID：11510440
> 
> 赞同：0
> 
> 时间：2012-07-16T18:37:20.067
> 
> 标签：bash, shell, unix, command-line

搜索包含“abc”的目录或文件最简单的命令是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:38:33.113

您可以使用[`find`](http://linux.die.net/man/1/find)命令：

```
find . -name "*abc*" 
```

前面的命令将在当前目录（及其所有子目录）中搜索包含“abc”的任何文件或目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:44:28.167

[定位](http://unixhelp.ed.ac.uk/CGI/man-cgi?locate%201)命令_

```
locate "*abc*" 
```

除了已经提到的[find命令之外，它也可以工作。](http://unixhelp.ed.ac.uk/CGI/man-cgi?find)

请注意，这可以通过查询通常作为 cron 作业定期运行的命令创建/更新/维护的数据库来*快速工作。*`updatedb`然而，这意味着如果文件刚刚创建，您可能在再次运行之前找不到它`updatedb`（或者您自己运行它，假设您有 sudo 特权）。在这些情况下`find`，可能是您最好的选择，虽然速度较慢，因为它会搜索您当时指定的目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:39:25.420

这应该这样做

```
find / -iname "*abc*" 
```

# linux - 使用 Perl Unix 命令转义序列

> ID：11510442
> 
> 赞同：0
> 
> 时间：2012-07-16T18:37:26.507
> 
> 标签：linux, perl, git, unix, escaping

我正在尝试从 perl 中执行以下 unix 命令

```
`git log --pretty=format:%H | grep $id | wc -l`; 
```

我不断收到错误消息

```
sh: -c : syntax error near unexpected token '|'
sh -c : '| wc -l' 
```

我该如何解决这个错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:52:27.927

问题是你有`123<NEWLINE>`而不是`123`in `$id`，所以你将以下内容传递给 shell：

```
git log --pretty=format:%H | grep 123
 | wc -l 
```

代替

```
git log --pretty=format:%H | grep 123 | wc -l 
```

修复中的值`$id`。最好的方法可能是通过[`chomp`](http://perldoc.perl.org/functions/chomp.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:41:06.660

如果您使用 Perl 子例程而不是外部 Unix 命令来实现其中的一些功能，您可能会拥有一个更健壮的脚本。

使用反引号对快速脚本很有好处，但它本质上是脆弱的，因为您会暴露于为运行脚本的用户配置的任何 Unix shell 的全部功能和怪异（使用通配符扩展、输入/输出重定向、管道、 ETC。）。这确实适用于任何编程语言，并且大多数语言（包括 perl）都有更安全的方法来运行外部命令，而无需使用 shell。但是创建 Perl 的原因之一是能够在一种编程语言下结合大量 Unix 命令的文本处理能力。

# iphone - 执行 presentViewController 时获取视图控制器 nil

> ID：11510446
> 
> 赞同：1
> 
> 时间：2012-07-16T18:37:39.510
> 
> 标签：iphone, uinavigationcontroller

单击的每一行都会将您带到另一个视图控制器

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
    if( indexPath.row == 0 ){
        titleController     = [[TitleFundraiserController alloc] initWithNibName:@"TitleFundraiserController" bundle:nil];
        [self.navigationController presentViewController:titleController animated:YES completion:nil];
    }
    if( indexPath.row == 1 ) {
        recipientController = [[RecipientController alloc] initWithNibName:@"RecipientController" bundle:nil];
        [self.navigationController presentViewController:recipientController animated:YES completion:nil];
    }
    if( indexPath.row == 2 ) {
        fundController      = [[FundingController alloc] initWithNibName:@"FundingController" bundle:nil];
        [self.navigationController presentViewController:recipientController animated:YES completion:nil];
    }
    if( indexPath.row == 3 ) {
        locationController  = [[LocationController alloc] initWithNibName:@"LocationController" bundle:nil];
        [self.navigationController presentViewController:locationController animated:YES completion:nil];
    }  
} 
```

但是，有时我会从控制台收到此错误，并且我的程序正在崩溃

```
 Terminating app due to uncaught exception 'NSInvalidArgumentException', reason:
 'Application tried to present a nil modal view controller on target <UINavigationController: 0x7c7a340>.' 
```

我不知道为什么这么说。

如果您以前遇到过此问题，请提供帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:46:22.660

我发现您的代码唯一有问题的是，在 presentViewController 之后，您还需要释放变量：

```
if ( indexPath.row == 0 ) {
            titleController     =   [[TitleFundraiserController alloc] initWithNibName:@"TitleFundraiserController" bundle:nil];
            [self.navigationController presentViewController:titleController animated:YES completion:nil];
            [titleController release];
    } 
```

我看不出您随机出现错误的任何原因，它不是总是在同一行吗？发生的事情是`ViewController`没有从笔尖加载，因此返回`nil`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:01:59.770

你`recipientController`在你的陈述中`if (indexPath.row == 2)`陈述你应该陈述的时候`fundController`

这是更正后的代码：

```
if( indexPath.row == 2 ) {
        fundController = [[FundingController alloc] initWithNibName:@"FundingController" bundle:nil];
        [self.navigationController presentViewController:fundController animated:YES completion:nil];
} 
```

您收到该错误，因为`recipientController`在此处展示时将为零

# objective-c - iOS - 为什么调用一个空的构造函数会破坏程序？

> ID：11510448
> 
> 赞同：1
> 
> 时间：2012-07-16T18:37:41.923
> 
> 标签：objective-c

我有一个这样的构造函数：

```
-(id) init 
{
    // do something here...not sure what yet  :)
} 
```

我可以很好地实例化这个类的对象，但是我在这个类上调用方法时遇到错误。为什么会这样？我在这里想念什么？我应该调用超类构造函数吗？还是以某种方式存在内存问题？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:40:23.120

> 我在这里想念什么？

您缺少对超类的指定初始化程序的调用、对 的赋值`self`和`return`语句。

您的最小未完成构造函数应如下所示：

```
-(id) init 
{
    if (self=[super init]) {
        // do something here...not sure what yet  :)
    }
    return self;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:41:17.370

你需要返回一些东西，通常是self，你指定你的方法返回类型（id）在objective-c中可以是任何东西，但你必须返回一些东西。

典型的初始化如下所示：

```
-(id) init 
{
    self = [super init];
    if (self) {
    // do something here...not sure what yet  :)
    }
    return self;
} 
```

# java - 我无法使用 java netbeans 从数据库中读取

> ID：11510450
> 
> 赞同：0
> 
> 时间：2012-07-16T18:37:47.723
> 
> 标签：java

我有这段代码，我遇到了一个问题，使用 java netbeans 从 MySQL 数据库读取信息，数据库 varchar 中的数据类型

```
import com.mysql.jdbc.Statement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.util.Scanner;

public class NewDataBase {
    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        try{
              Connection con = DriverManager.getConnection("jdbc:mysql://localhost/mydb","root", "password");
              Statement stmt = (Statement) con.createStatement();
              System.out.println("Enter name");
              String name =sc.next();
              String SQL = "select * from list where Name ='"+ name + "'";
              ResultSet rs = stmt.executeQuery(SQL);
              System.out.print("Name: " + rs.getNString("Name"));
              System.out.print("Number: " + rs.getNString("Number"));
              // while(rs.next())
              // {
              //   System.out.print("Name: " + rs.getNString("Name"));
              //  System.out.print("Number: " + rs.getNString("Number"));

              //}
        }catch(Exception e){
            System.out.print("Error:" + e.getMessage());
        } 
    }
} 
```

* * *

错误：当字段的字符集不是 UTF-8 时，无法调用 getNString()

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:39:48.783

尝试 `rs.getString("Name")`代替 `rs.getNString("Name")`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:02:13.833

采用：

```
 Properties props = new Properties(); 
    props.put("user", "root");         
    props.put("password", "password");
    props.put("useUnicode", "true");
    props.put("useServerPrepStmts", "false"); // use client-side prepared statement
    props.put("characterEncoding", "UTF-8"); // ensure charset is utf8 here

    String url = "jdbc:mysql://localhost/mydb";
    Connection connection = DriverManager.getConnection(url, props);

    PreparedStatement ps = 
        connection.prepareStatement("INSERT INTO list (Name, Number) VALUES (?, ?)");

    String testNumber = "12345";
    String testName = "name1";
    pstmt1.setNCharacterStream(1, new StringReader(testName), testName.length());
    ps.setNCharacterStream(2, new StringReader(testNumber), testNumber.length());
    ps.execute(); 
```

也不要忘记评论

```
if (rs.next()) {
    System.out.print("Name: " + rs.getNString("Name"));
    System.out.print("Number: " + rs.getNString("Number"));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-08T20:16:55.567

我 100% 确定这可行。这是我从 Namberi 那里得到的答案。

```
rs.getString("Name") instead of rs.getNString("Name") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T20:24:06.283

```
if (rs.next()) {
    rs.getString("Name");
}
rs.close();
stmt.close();
con.close(); 
```

是的，最好使用 PreparedStatement 进行 SQL 注入和转义反斜杠、引号等。

# asp.net - 在回发时从 URL 中删除 #FragmentIdentifier

> ID：11510453
> 
> 赞同：3
> 
> 时间：2012-07-16T18:38:16.990
> 
> 标签：asp.net, html

一些导航到我的页面的用户通过这样的 url 这样做：`http://domain/ProductDetail.aspx?Productid=123#Pricing`

在这个部分是一个 asp:button 来进行购买。此按钮会导致回发，并且当在浏览器中重新呈现页面时，FragmentIdentifier #Pricing 仍在地址窗口中。

这会导致问题，因为如果浏览器导航到#Pricing 部分，页面上呈现的新内容是不可见的。

如何防止回发时出现 FragmentIdentifier？

澄清：这个问题似乎发生在 Chrome 中，但在 IE8 或 FireFox 中没有发生。即使在 action 属性中没有引用它，Chrome 也会在回发后保留 #FragmentIdentifier。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:45:37.187

你不能，浏览器不发送它：

> 当使用 URI 引用对已识别的资源执行检索操作时，可选的片段标识符（由交叉线（“#”）字符与 URI 分隔）包含在检索后由用户代理解释的附加参考信息动作已成功完成。因此，它不是 URI 的一部分，但通常与 URI 结合使用。

[如何从服务器端获取 Url Hash (#)](https://stackoverflow.com/questions/317760/how-to-get-url-hash-from-server-side)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:47:16.170

您可以通过重定向到同一页面来强制浏览器摆脱 # 标记。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:03:36.813

浏览器不会在服务器端发送 URL 片段。您无法修改它们，您可以尝试的唯一选择是 URL 重写，如果有帮助的话。祝你好运...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-13T11:36:53.937

ASP.NET 引擎将导致没有任何给定 URL 的简单提交，因此浏览器被迫采用当前页面的 URL。

您可以在回发后摆脱散列，方法是将自执行 javascript 挂接到 HTML 中，将散列替换为空字符串。

这是一个例子：

```
if(this.Page.IsPostback)
{
    this.Page.ClientScript.RegisterStartupScript(this.GetType(), "RemoveHash", "window.location.hash=''", true);
} 
```

# java - 如何从 ClassRunner 内部获取测试类实例 JUnit 正在运行测试用例？

> ID：11510460
> 
> 赞同：4
> 
> 时间：2012-07-16T18:38:41.693
> 
> 标签：java, reflection, junit

我有一个扩展 BlockJUnit4ClassRunner 的自定义测试运行器，我想在我的自定义测试运行器中获取在 BlockJUnit4ClassRunner 中实例化的测试类的实例。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T22:25:37.143

我想出了这个。

您可以做的是`createTest()`在 BlockJUnit4ClassRunner 中覆盖，并将结果传递`super.createTest()`给您选择的方法。例如：

```
public class CustomTestRunner extends AbstractTestRunner {

    @Override
    public abstract void prepareTest(final Object test) {
     // have your way with the test object
    }
}

public abstract class AbstractTestRunner extends BlockJUnit4ClassRunner {

    @Override
    public Object createTest() throws Exception {
         Object test = super.createTest();
         prepareTest(test);
         return test;
    }

    public abstract void prepareTest(final Object test);
} 
```

# ms-access - 传参查询定义

> ID：11510462
> 
> 赞同：0
> 
> 时间：2012-07-16T18:38:51.657
> 
> 标签：ms-access, vba

以下代码执行存储过程传递查询。从表单接收参数并传递给存储过程。该错误表明它是无效的 SQL 语句。我需要知道代码是否正确以及如何连接到数据库。结果在记录集中返回。谢谢！

```
Private Sub Command10_Click()
Dim rs1 As DAO.Recordset
Dim DB As Database
Dim Q As QueryDef
Dim strSQL As String

Set DB = CurrentDb()
Set Q = DB.QueryDefs("Call_SP")

strSQL = "execute dbo.ix_spc_planogram_match " & [Forms]![start]![Selection]![cat_code]
Q.ReturnsRecords = True

Q.SQL = strSQL

Set rs1 = DB.OpenRecordset(strSQL)

Do While Not rs1.EOF

Debug.Print rs1.Fields.Item("POG_DBKEY").Value = "POG_DBKEY"
Debug.Print rs1.Fields.Item("COMP_POG_DBKEY").Value = "COMP_POG_DBKEY"
Debug.Print rs1.Fields.Item("CURR_SKU_CNT").Value = "CURR_SKU_CNT"
Debug.Print rs1.Fields.Item("COMP_SKU_CNT").Value = "COMP_SKU_CNT"
Debug.Print rs1.Fields.Item("SKU_TOTAL").Value = "SKU_TOTAL"
Debug.Print rs1.Fields.Item("MATCHD").Value = "MATCHD"

rs1.MoveNext
Loop
rs1.Close
Set rs1 = Nothing
Set rs1 = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:42:18.400

CurrentDB 是 MS Access，但您正在执行 SQL Server 存储过程。您需要针对与服务器的连接执行。

例如：

```
Dim objcon As New ADODB.Connection

scn = "Provider=sqloledb;Data Source=ServerName;" _
    & "Initial Catalog=DBNAME;User Id=USERNAME;Password=Password;"

objcon.Open scn

Set rs = objcon.Execute 
```

# python - 使用 Python 进行电子邮件管道/处理

> ID：11510465
> 
> 赞同：1
> 
> 时间：2012-07-16T18:39:10.170
> 
> 标签：python, pipe

我正在开发一个基于 Web 的应用程序，为此我需要能够将传入的电子邮件发送到特定地址（已经完成）到 python 脚本（已经完成）。我很容易地设置了管道，但是当我向目标地址发送电子邮件时，我得到了以下回复：

```
A message that you sent could not be delivered to one or more of its
recipients. This is a permanent error. The following address(es) failed:

  pipe to |/path/to/script.py
    generated by ****@****.com
    local delivery failed 
```

脚本如下所示（显然还没有做任何事情）：

```
#!/home2/tsassone/python/bin/python    
def main():    
    pass

if __name__ == '__main__':
    main() 
```

我知道路径都是正确的，并且 hash-bang 用于其他功能脚本。电子邮件需要做的就是提取消息的正文/内容并对其进行解析（将某些部分放入数据库中）。我需要做些什么来修复管道以防止错误，以及一旦我有如何访问电子邮件正文（我了解如何使用标准输入，并阅读了一些电子邮件解析，但这些都不起作用，尽管我'不确定那是因为管道坏了还是其他原因）。

感谢您的时间。

# powershell - 带有-NoMachineProfile的Powershell调用命令如何获取传递的参数

> ID：11510467
> 
> 赞同：1
> 
> 时间：2012-07-16T18:39:18.583
> 
> 标签：powershell, invoke-command

**问题**

有谁知道获取与 $MyInvocation 相同数据的方法？强烈的偏好是只使用内置的东西而不是第三方添加软件来实现这一点。

**问题**

当您使用 -NoMachineProfile 创建会话时，$MyInvocation 不会被填充。我希望有其他方法来获取信息，就像 [System.Environment]::Username 用于 $env:USERNAME 一样。

我无法改变调用事物的方式。请不要建议删除 -NoMachineProfile 作为解决方案，因为这不是一个选项。

我不想依赖 $args 因为那是后处理。即引号、变量和其他传递的参数不再与它们传递时的相同。

**背景**

$MyInvocation.line 包含提供 0 解析的确切命令。

例如 SomeScript.ps1

```
write-host ("Invoked line: "+$MyInvocation.line) 
```

.\somescript.ps1 foo bar "foo and bar" 产生以下输出

```
Invoked line: .\somescript.ps1 foo bar "foo and bar" 
```

引号和所有，这意味着它能够被剪切和粘贴，并且在 0 用户翻译的情况下完全以相同的方式运行。

**-NoMachineProfile 调用**

```
$SE_ADMIN_CREDENTIALS = Get-Credential
$PS_SESSION_OPTIONS = New-PSSessionOption -NoMachineProfile
$arrayRemoteTarget = "thehostname"
$strScriptToRun = ".\somescript.ps1"
$StrArguments = "arg1,arg2,arg3"

$icmCommand = "Invoke-Command -Credential `$SE_ADMIN_CREDENTIALS -SessionOption `$PS_SESSION_OPTIONS -ComputerName `$arrayRemoteTarget -FilePath `$strScriptToRun -ArgumentList (`$strArguments).Split("","")"

Invoke-Expression $icmCommand 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-09-09T21:26:23.610

```
-sessionoption (new-pssessionoption -nomachineprofile) 
```

是另一种方法。

至于传递论点，我相信

```
$using:variable 
```

是你要找的

例如

```
$listing = "*"
invoke-command -computername $computer -scriptblock {cd /; ls $using:listing} 
```

我希望这是有道理的。

否则你可以在文件中使用“arg[0]”或“args[0]”来运行脚本......应该可以......

最后一点，你的引号，可能会弄乱你的脚本，我只是替换`split("","")`为`split(',')`

# pentaho - 将字符串附加到 Pentaho 报表设计器中的数字字段

> ID：11510468
> 
> 赞同：1
> 
> 时间：2012-07-16T18:39:24.400
> 
> 标签：pentaho

我有一个数字字段，它是报表设计器中查询的输出，我想做的是将“AM - [number+1] AM/PM”附加到此字段。例如。查询输出 9、10、11、12、13 等。但是，而不是数字 9，我想将输出格式化为 9AM - 10AM，而不是 10、10AM -11AM，而不是 11、11AM - 12PM 等等。我在带有 IF 条件的数字字段的数据格式部分添加了一个公式来检查数字的值并相应地输出它，但它并没有按照我想要的方式工作。

请有人可以帮我解决这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T21:30:47.660

您可以使用值映射器转换，您需要每小时输入一个条目。或者，您可以使用几个用户定义的 Java 表达式来生成具有 (n)AM/PM 和 (n+1)AM.PM 的行，然后使用 Concat Fields 步骤来连接它们。

# java - 如何将字符串变量传递给Java中另一个程序的第一个文本框

> ID：11510471
> 
> 赞同：-2
> 
> 时间：2012-07-16T18:39:24.687
> 
> 标签：java, string, variables, textbox

我使用 Eclipse 在 Java 中使用以下内容通过下面的 Runtime 命令运行程序：

```
String[] cmd = { "C:\\Program Files\\Windows Live\\Messenger\\msnmsgr.exe",first,third }; 
```

请注意，第一个，第三个都是字符串变量，现在当这个命令运行程序时，我想将它们都传递到 2 个文本框中。我希望将这些字符串复制到我在这里运行文本框的程序中。只有我需要这一件事，我如何传递字符串，为什么有些用户告诉我使用这段代码来传递字符串变量，是指针问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:44:39.137

您根本无法做到这一点，除非您可以通过命令行传递参数，否则您无法与单独的程序界面进行交互。

# extjs - 使用电子邮件按钮从网格中通过电子邮件发送一行？

> ID：11510472
> 
> 赞同：0
> 
> 时间：2012-07-16T18:39:28.773
> 
> 标签：extjs

我是 extjs 的新手。我正在尝试根据用户行选择通过电子邮件发送一行用户首先必须从一行中选择一个复选框，然后单击工具栏面板底部的电子邮件按钮。网格底部只有一个电子邮件按钮。

当用户选择一个复选框以选择一行并单击电子邮件按钮以发送电子邮件并使用 extjs 在行中附加信息时，我如何通过电子邮件发送一行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T06:51:41.563

没有在 javascript 中发送电子邮件的选项（除了[mailto](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_mailto)），您必须将请求发送到您的服务器，在那里可以对其进行处理和发送电子邮件。

# jquery - 点击 - 导航前的延迟

> ID：11510478
> 
> 赞同：14
> 
> 时间：2012-07-16T18:39:44.897
> 
> 标签：jquery

是否有任何简单的方法来创建代码：如果 URL 更改或单击链接显示 div（如加载 gif 3 秒）然后显示页面？有点像加载 gif 旋转 3 秒然后显示页面的空白白页？

谢谢！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-16T18:53:44.283

给定一个`<a class="waitBeforeNavigate" href="somewhere.html">Go somewhere</a>`

```
function waitBeforeNavigate(ev) {
  ev.preventDefault();                    // prevent default anchor behavior
  const goTo = this.getAttribute("href"); // store anchor href

  // do something while timeOut ticks ... 

  setTimeout(function(){
    window.location = goTo;
  }, 3000);                               // time in ms
}); 

document.querySelectorAll(".waitBeforeNavigate")
  .forEach(EL => EL.addEventListener("click", waitBeforeNavigate)); 
```

使用 jQuery：

```
$('.waitBeforeNavigate').on("click", function (ev) {
  ev.preventDefault();                // prevent default anchor behavior
  const goTo = $(this).attr("href");  // store anchor href

  // do something while timeOut ticks ... 

  setTimeout(function(){
    window.location = goTo;
  }, 3000);                           // time in ms
}); 
```

# javascript - 浏览器会给 iframe 一个单独的 JavaScript 线程吗？

> ID：11510483
> 
> 赞同：66
> 
> 时间：2012-07-16T18:40:04.717
> 
> 标签：javascript, multithreading, browser

Web 浏览器是否在 iframe 中为 JavaScript 使用单独的执行线程？

我相信 Chrome 为每个选项卡使用单独的线程，所以我猜测 iframe 中的 JavaScript 将与其父窗口共享相同的线程，但是，这似乎也存在安全风险。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2018-08-05T11:03:45.853

最近测试了在 iFrame 中运行的 JavaScript 是否会阻止 JavaScript 在父窗口中运行。

与父级在同一域上的 iFrame：

*   Chrome 68.0.3440.84：块
*   Safari 11.0.2 (13604.4.7.1.3)：块
*   iOS 上的 Safari 15.1：块
*   Firefox 96：块

不同域上的 iFrame 作为父级

*   Chrome 68.0.3440.84：**不阻止**
*   Safari 11.0.2 (13604.4.7.1.3)：块（过时，但我没有 macbook）
*   iOS 上的 Safari 15.1：**不阻止**
*   Firefox 96：**不阻止**
*   适用于 Android 的 Chrome 96：有时阻止，有时不阻止（Android 版 Chrome 中有一些复杂的规则可确定 Android 版 Chrome 何时执行和不隔离进程，请参阅`chrome://process-internals`和`chrome://flags`）

父.html：

```
 <body>
    <div id="count"></div>
    <iframe src="./spin.html"></iframe>     
    <script>
        let i = 0;
        let div = document.getElementById("count");
        setInterval(() => {
            div.innerText = i++;
        }, 100);
    </script>
    </body> 
```

自旋.html：

```
 <body>
    <button id="spin">spin</button>
    <script>
        const spin = document.getElementById("spin");
        spin.addEventListener('click', () => {
            const start = Date.now();
            while (Date.now() - start < 1000) { }
        })
    </script>
    </body> 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-07-16T18:47:28.063

在 chrome 出现之前，任何浏览器的所有选项卡都共享同一个 JavaScript 单线程。Chrome 在这里升级了游戏，其他一些人也纷纷效仿。

这是一个浏览器实现细节，所以没有可靠的答案。较旧的浏览器肯定不会。我不知道任何浏览器肯定会为 iframe 使用另一个线程，但老实说，我从未真正研究过它。

这不是安全风险，因为线程执行不会带来任何对象。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2014-03-13T02:18:39.767

总结其他答案：不，**iFrame 通常与主页在同一线程/进程中运行**。

但是，Chromium 团队似乎正在努力在该领域进一步隔离：

[Chromium 问题 99379：进程外 iframe](https://code.google.com/p/chromium/issues/detail?id=99379) [抱歉，链接不起作用 - 如果您能找到有效问题的链接，请告诉我]

[进程外 iframe 的设计计划](http://www.chromium.org/developers/design-documents/oop-iframes)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-08-03T23:32:50.070

在检查任何现有答案之前，我今晚自己也有同样的问题。在我目前正在工作的项目中，我们必须加载一个使用不同框架的 iFrame，如果 iFrame 会以某种方式阻塞线程并影响我的应用程序，我很好奇。答案是肯定的，可以。

我的测试是在 Chrome 中完成的。在父级中，我加载了一个子 iFrame。在父级中，我设置了一个间隔来 console.log 每次发送一个文本。然后在 iFrame 中，我使用超时来启动阻塞线程的“while”。答案：iFrame 使用相同的线程。

例子：

在父级中：

```
setInterval(() => {
  console.log('iFrame still using the thread');
}, 3000) 
```

在 iFrame 中：

```
setTimeout(() => {
  console.log('now the thread is not working in the iFrame anymore');
  while (true) {
  }
}, 10000) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2020-06-23T08:46:41.740

**只有桌面（不，不是移动）**上的 chrome 和 firefox正在分离线程。****

 **我创建了一个小页面，在主页中以间隔运行长循环，并在主页和 iframe 中显示动画。您可以从要检查的浏览器访问该站点。

如果较低的动画（在“crossorigin”下）不停地运行，它有一个单独的线程。

[https://eylonsu.github.io/browser_thread/](https://eylonsu.github.io/browser_thread/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-06-20T18:31:00.967

今天在 Ubuntu 的 Chrome 28 中做了一些实验。使用此命令查看 Chrome 的线程和进程

`ps axo pid,nlwp,cmd | grep "chrome"`

看起来 Chrome 不会为 iframe 生成新线程或进程。有趣的是，它确实为开发工具窗格生成了一个新进程。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-11-19T15:57:06.013

晚了，但是......好点，因为 iframe js 似乎在 Firefox 16 中是并发的。
尝试使用警报功能（阻塞），你会看到对话框一起打开。
你不会在 Chrome 或 IE 中看到它。
iframe js 可以像往常一样访问 Firefox 16 中的父窗口，所以我可以想到可能出现的竞争条件。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2021-02-03T18:54:47.770

# 2021 年更新：

现在有`Origin-Agent-Cluster`允许您为 iframe 请求专用资源的标头。它目前在 Chrome (88+) 上得到支持，并得到 Mozilla 和 Safari 的好评。

> Origin-Agent-Cluster 是一个新的 HTTP 响应头，指示浏览器阻止同站点跨域页面之间的同步脚本访问。浏览器也可以使用 Origin-Agent-Cluster 来暗示您的源应该获得自己的独立资源，例如专用进程。

> [...] 例如，如果`https://customerservicewidget.example.com`希望使用大量资源进行视频聊天，并且将嵌入到各个来源`https://*.example.com`，则维护该小部件的团队可以使用 Origin-Agent-Cluster 标头来尝试降低其对性能的影响嵌入器。

> 要使用 Origin-Agent-Cluster 标头，请将您的 Web 服务器配置为发送以下 HTTP 响应标头：`Origin-Agent-Cluster: ?1`的值`?1`是布尔真值的结构化标头语法。

更多细节在这里：[https ://web.dev/origin-agent-cluster/](https://web.dev/origin-agent-cluster/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-25T23:39:04.387

# 2022 更新（实验性）

iframe 现在至少可以在桌面计算机上的 Chrome Canary 中并行运行，但这仍然是实验性的。

1.  下载 Chrome Canary ( [https://www.google.com/chrome/canary/](https://www.google.com/chrome/canary/) )。
2.  导航到“chrome://flags/”。
3.  启用“隔离沙盒 iframe”。
4.  使用以下内容创建“index.html”：

```
<h1>index.html</h1>
<iframe src="index-child.html" sandbox="allow-scripts"></iframe>
<script>
    setInterval(() => {
        console.log("index.html executed one iteration");
    }, 1000)
</script> 
```

5.  使用以下内容创建“index-child.html”：

```
<h1>index-child.html</h1>
<script>
    setTimeout(() => {
        console.log("index-child.html started continuous execution");
        while (true) {
        }
    }, 3000)
</script> 
```

6.  在浏览器中打开“index.html”。
7.  验证控制台是否始终如一地记录“index.html 执行一次迭代”。因此，iframe 是并行执行的。
8.  禁用“隔离沙盒 iframe”（或仅使用其他浏览器）并再次打开“index.html”。控制台不再持续记录“index.html 执行了一次迭代”。因此，iframe 不再并行执行。

**注意**：必须正确设置标签`sandbox`上的属性才能使其正常工作。`iframe`此外，目前每个站点只支持一个额外的进程，这意味着多个 iframe 不会全部并行运行。

来自“chrome://flags/”的具体说明：

> 隔离沙盒 iframe
> 启用后，将进程隔离应用于具有“沙盒”属性且未在该属性上设置“允许相同来源”权限的 iframe。当前的隔离模型是将来自给定站点的所有沙盒 iframe 放入同一进程中，但在未来的实验中可能会引入替代模型。– Mac、Windows、Linux、Chrome 操作系统、紫红色

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-03-06T07:53:10.990

对于 iFrame，没有。但是，如果您想在 JavaScript 中使用线程，您可以使用 Web Workers，这是新浏览器支持的工作 html5 草案。[http://www.w3.org/TR/2009/WD-workers-20091029/](http://www.w3.org/TR/2009/WD-workers-20091029/)**

# command-line - 从win7上的命令行，如何使用提升的UAC以管理员身份启动进程

> ID：11510484
> 
> 赞同：2
> 
> 时间：2012-07-16T18:40:05.567
> 
> 标签：command-line, process, batch-file, admin, uac

我有一个需要管理权限的程序，我想从批处理文件运行它。我可以从命令行运行什么命令将以管理权限运行我的程序？我同意弹出窗口请求许可。此外，该文件需要能够从计算机上的任何位置运行，以便从 ./src 运行其他文件。问题是，如果我右键单击并选择“以管理员身份运行”，它会更改我的当前目录，因此 ./src 不再有效。如果我在我的机器上禁用 UAC，那么一切运行正常。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T06:25:05.610

这很困难，Microsoft 没有提供任何实用程序来执行此操作（主要是因为提供了破坏安全性的批处理文件），除了 RunAs，并且需要激活管理员帐户。

有一个 JScript 程序可以做类似的事情，通过使用 SendKeys 打开开始菜单并键入 cmd[CTL]+[SHIFT]+[ENTER] 将启动命令行 shell。

将以下内容另存为 .js 文件，例如 StartAdmin.js：

```
var WshShell = WScript.CreateObject("WScript.Shell");
WshShell.SendKeys("^{esc}cmd^+{ENTER}");   The equivilent of [CTRL]+[ESC] cmd [CTRL]+[SHIFT]+[ENTER] 
```

要从批处理文件运行 StartAdmin.js，您将需要以下行：

```
wscript StartAdmin.js 
```

要从特定目录启动并启动批处理文件，请将 StartAdmin.js 中的第 2 行更改为：

```
WshShell.SendKeys("^{esc}cmd /C "cd %userprofile% & batchfile.bat"^+{ENTER}"); 
```

/C 开关告诉它运行命令，然后关闭命令行窗口。
/K 将在退出批处理文件后打开命令窗口。
为了帮助您理解 SendKeys 命令：

```
+=[Shift Key]
^=[Control Key]
{esc}=[Escape Key]
{enter}=[Enter Key] 
```

要了解有关使用 CMD.EXE 的更多信息，请键入 CMD /? 在命令提示符下。

这是一种非常不整洁和丑陋的方法，但这是我知道如何仅使用 Windows 附带的工具的唯一方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:34:38.983

看这里：[https ://superuser.com/a/269750/139371](https://superuser.com/a/269750/139371)

[提升](http://code.kliu.org/misc/elevate/)似乎正在工作，打电话

```
C:\Utils\bin.x86-64\elevate.exe -k dir 
```

`dir`在调用的“当前目录”中执行`elevate`。

# javascript - 根据模型属性对主干集合进行排序

> ID：11510490
> 
> 赞同：12
> 
> 时间：2012-07-16T18:40:25.670
> 
> 标签：javascript, backbone.js

我有一个在表格中呈现的骨干集合。我想根据集合具有的某些属性使表格可排序，例如“task_status”、“task_group”。我正在阅读有关 collection.comarator 和 collection.sort 的主干文档。我怎样才能完成这项工作？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-16T19:14:50.327

该[`comparator`](http://backbonejs.org/#Collection-comparator)函数用于比较集合中的两个模型，并且可以以任何（一致的）它想要的方式比较它们。特别是，它可以选择使用哪个模型属性，这样你的集合中就可以有这样的东西：

```
initialize: function() {
    this.sort_key = 'id';
},
comparator: function(a, b) {
    // Assuming that the sort_key values can be compared with '>' and '<',
    // modifying this to account for extra processing on the sort_key model
    // attributes is fairly straight forward.
    a = a.get(this.sort_key);
    b = b.get(this.sort_key);
    return a > b ?  1
         : a < b ? -1
         :          0;
} 
```

然后你只需要集合上的一些方法来改变`sort_key`and 调用[`sort`](http://backbonejs.org/#Collection-sort)：

```
sort_by_thing: function() {
    this.sort_key = 'thing';
    this.sort();
} 
```

在较旧的 Backbones 中，调用`sort`将触发一个`"reset"`事件，而较新的版本将触发一个`"sort"`事件。要涵盖这两种情况，您可以同时监听事件并重新渲染：

```
// in the view...
initialize: function() {
    this.collection.on('reset sort', this.render, this);
} 
```

演示：http: [//jsfiddle.net/ambiguous/7y9CC/](http://jsfiddle.net/ambiguous/7y9CC/)

您还可以使用[`listenTo`](http://backbonejs.org/#Events-listenTo)代替[`on`](http://backbonejs.org/#Events-on)来帮助您避免僵尸：

```
initialize: function() {
    this.listenTo(this.collection, 'reset sort', this.render);
} 
```

演示：http: [//jsfiddle.net/ambiguous/nG6EJ/](http://jsfiddle.net/ambiguous/nG6EJ/)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-17T12:22:43.313

@mu-is-too-short 的答案很好，除了有一种更简单的方法来比较字段值：

根据字段对集合进行排序的最简单方法是提供一个比较器函数，该函数返回您要排序的确切字段值。这种比较器导致 Backbone 调用`sortBy`函数，而不是`sort`，然后它自己进行复杂的比较，您不必担心逻辑。

所以本质上，您不必提供复杂的比较器功能，除非您对确定顺序有更高级的需求。

```
var myCollection = Backbone.Collection.extend({
    sort_key: 'id', // default sort key
    comparator: function(item) {
        return item.get(this.sort_key);
    },
    sortByField: function(fieldName) {
        this.sort_key = fieldName;
        this.sort();
    }
}); 
```

在此之后，您可以`sortByField`使用代表您要排序的键的字符串调用集合的 -function。例如：

```
collection.sortByField('name'); 
```

修改了@my-is-too-short 的演示：http: [//jsfiddle.net/NTez2/39/](http://jsfiddle.net/NTez2/39/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-28T18:03:03.717

@jylauril 的回答非常有帮助，但需要修改演示（可能自发布以来主干略有变化？）

看起来您需要在排序后触发渲染。

```
$('#by-s').click(function() {
  c.sortByField('s');
  v.render();
}); 
```

更新了@my-is-too-short 的演示：http: [//jsfiddle.net/NTez2/13/](http://jsfiddle.net/NTez2/13/)

# asp.net - 了解 runat 服务器属性

> ID：11510502
> 
> 赞同：56
> 
> 时间：2012-07-16T18:40:51.363
> 
> 标签：asp.net

我真的是 ASP.NET 的新手。我只是在检查一个默认的 ASP.NET Web 应用程序。它默认带有几个页面（Default.aspx、About.aspx 等）。

我注意到 Site.master 文件是我为我的页面创建主要布局的文件。但我也注意到`head`标签有一个`runat="server"`属性。

我知道这个标签是在`<asp:XXX>`标签中使用的，但为什么在`<head>`标签中？？？

此外，当我删除该属性时，所有样式都会从网页中消失。所以看起来它正在做某事。我只是不明白它到底在做什么......

那么为什么它会出现在一个 HTML 标签上……？？？我没有看到任何应该在服务器上运行的代码......

```
<head runat="server">
    <title>Hallo</title>
    <link href="~/Styles/Site.css" rel="stylesheet" type="text/css" />

    <!-- This part is run on the server. So why does the head tag
         also need a runat=server ?? -->
    <asp:ContentPlaceHolder ID="HeadContent" runat="server">
    </asp:ContentPlaceHolder>
</head> 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-05-24T06:59:19.893

`runat="server"`您问为什么从元素中删除时不再应用样式`<head>`。

很简单：通过在服务器端运行，解析器将`~/`样式表声明`<link href="~/Styles/Site.css" rel="stylesheet" type="text/css" />`中的 替换为应用程序的根路径。

在`~`URL 中是非法的。因此，如果它没有被解析器替换，则不会找到该文件，因此不会应用样式表。

哦，顺便说一句，`runat="server"`在元素上设置属性`<head>`将强制其所有子元素在服务器上运行，这就是为什么`<link>`元素在服务器上运行的原因。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-07-16T18:47:03.873

head 元素包含一个`runat="server"`属性，表明它是一个服务器控件（而不是静态 HTML）。所有 ASP.NET 页面都派生自 Page 类，该类位于 System.Web.UI 命名空间中。此类包含提供对页面区域的访问的 Header 属性。使用 Header 属性，我们可以设置 ASP.NET 页面的标题或向呈现的部分添加其他标记。然后，可以通过在页面的`Page_Load`事件处理程序中编写一些代码来自定义内容页面的元素。

```
' Programmatically add a <meta> element to the Header

Dim keywords As New HtmlMeta()
keywords.Name = "keywords"
keywords.Content = "master page,asp.net,tutorial"
Page.Header.Controls.Add(keywords) 
```

有关详细信息，请参阅[使用 VB.NET 在 ASP.NET 中指定元标记](http://www.asp.net/web-forms/tutorials/master-pages/specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb)。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-07-16T18:45:17.683

ASP.NET 中的 runat="server" 标记允许将大多数 HTML 元素转换/处理为服务器端控件，您可以在生成时通过代码对其进行操作。一些控件具有显式实现，而其他控件则简单地恢复为通用控件实现。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-07-16T18:44:44.617

该`runat`属性基本上告诉 ASP.Net 它需要*解析*元素、它的属性和它的内容作为服务器控件。在服务器上执行启用代码以配置响应。

没有它，该部分中包含的任何子控件`<head>`都不会被解析。因此，任何动态`head`er 包含、标题操作或任何其他服务器控件都不会被解释。

# jquery - 全日历重新获取事件

> ID：11510503
> 
> 赞同：4
> 
> 时间：2012-07-16T18:40:52.317
> 
> 标签：jquery, asp.net-mvc, fullcalendar

我需要重新获取完整日历的事件，不仅在日历按钮上，而且在我自己的下拉更改中，因为它们定义了事件搜索的标准。到目前为止，我可以使用 传递下拉列表值的唯一方法`$.ajax`，但现在事件没有进入日历。我遗漏了一些东西，因为我似乎并不完全理解该功能。

```
$(function () {
    InitializeCalendar();

    $("#ProjectId").change(function () {
        $('#calendar').fullCalendar('refetchEvents');
    });

    $("#JobId").change(function () {
        $('#calendar').fullCalendar('refetchEvents');
    });

    $("#StoreId").change(function () {
        $('#calendar').fullCalendar('refetchEvents');
    });

    $("#OrderType").change(function () {
        $('#calendar').fullCalendar('refetchEvents');
    });

    $("#ShippingId").change(function () {
        $('#calendar').fullCalendar('refetchEvents');
    });
});

function InitializeCalendar() {
    $('#calendar').fullCalendar({
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,agendaWeek,agendaDay'
        },
        events: function (start, end) {
            $.ajax({
                url: '/Calendar/GetEvents/',
                dataType: 'json',
                data: {
                    start: Math.round(start.getTime() / 1000),
                    end: Math.round(end.getTime() / 1000),
                    projectId: $("#ProjectId option:selected").val(),
                    storeId: $("#StoreId option:selected").val(),
                    jobId: $("#JobId option:selected").val(),
                    orderType: $("#OrderType option:selected").val(),
                    shippingId: $("#ShippingId option:selected").val()
                }

                **SOMETHING MISSING HERE** 

                //this puts calendar into infinite loop
                //$('#calendar').fullCalendar('refetchEvents');
            });
        }
    });
} 
```

控制器：

```
public JsonResult GetEvents(double start, double end, int? projectId, int? storeId, string orderType, int? shippingId, int? jobId)
{
    // Some code...

    IList<OrderEvent> events = orderDTOs.Select(orderDTO => new OrderEvent {
        id = orderDTO.OrderId,
        title = orderDTO.OrderId.ToString(), 
        start = ToUnixTimespan(orderDTO.CreatedDate), 
        end = ToUnixTimespan(orderDTO.CreatedDate.AddHours(1)), 
        url = "/Order/Search"
    }).ToList();

    return Json(events, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-23T03:03:58.573

为了未来读者的利益，这里是 FullCalendar v2 的正确解决方案。

```
events: function (start, end, timezone, callback) {
    $.ajax({
        url: '/Calendar/GetEvents/',
        dataType: 'json',
        data: {
            start: Math.round(start.getTime() / 1000),
            end: Math.round(end.getTime() / 1000),
            projectId: $("#ProjectId option:selected").val(),
            storeId: $("#StoreId option:selected").val(),
            jobId: $("#JobId option:selected").val(),
            orderType: $("#OrderType option:selected").val(),
            shippingId: $("#ShippingId option:selected").val()
        }
        success: function(data) {
            callback(data)
        }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:32:31.057

我不认为你应该把`refetchEvents`调用放在事件 ajax 调用中。将`refetchEvents`再次调用该 ajax - 因此是无限循环。

另外，我认为您从下拉菜单向日历发送数据的方式很好。尝试`refetchEvents`从 ajax 调用中删除调用，看看它是否有效。

如果需要，您可以使用 ajax 调用的成功回调来处理从控制器返回的事件。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-07-20T09:31:28.200

像这样的东西应该适合你。只需通过 ajax 调用的成功函数重新获取完整的日历事件，因此它应该只在每次调用后重新获取，而不是像当前那样无限地重新获取：

```
events: function (start, end) {
    $.ajax({
        url: '/Calendar/GetEvents/',
        dataType: 'json',
        data: {
            start: Math.round(start.getTime() / 1000),
            end: Math.round(end.getTime() / 1000),
            projectId: $("#ProjectId option:selected").val(),
            storeId: $("#StoreId option:selected").val(),
            jobId: $("#JobId option:selected").val(),
            orderType: $("#OrderType option:selected").val(),
            shippingId: $("#ShippingId option:selected").val()
        }

       **SOMETHING MISSING HERE**
       success: function(data) {
            $("#calendar").fullCalendar("refetchEvents");
            console.log('successfully refetched events');
       }

       //this puts calendar into infinite loop
       //$('#calendar').fullCalendar('refetchEvents');
    }); 
```

# python - 文件指针向下然后结束

> ID：11510504
> 
> 赞同：0
> 
> 时间：2012-07-16T18:40:54.037
> 
> 标签：python, file-io

**任务**

我正在用python编写一个运行SAP2000程序的程序，每次将一个新的.s2k文件导入到Sap2000程序中，然后通过导出数据的方式从上次运行的结果生成一个新文件。

该文件大约有 1,500 行，包含任意单词和数字。（为了更好地理解，请参阅：http: [//pastebin.com/8ptYacJz](http://pastebin.com/8ptYacJz)，这是我正在处理的文件。）

我需要替换文件中的一个数字。这个数字在第 800 行的中间。

**问题**

有谁知道一种有效的方法来移动到文件中第 800 行的中间以替换一个数字？

**我试过的**

正则表达式不起作用，因为可能有多个相同数字的实例。

所以我想出了模板化文件的解决方案，每次写入一个新文件，将要更改的数字作为模板参数。

该解决方案确实有效，但该人坚持认为我可以将文件指针向下移动到第 800 行，然后移到行的中间以替换数字。

这是我解决问题的唯一代码，它将文件缓冲区带到一行，然后在我尝试查找时回到开头。

```
import sys
import os
#open file
f = open("output.$2k")
#this will go to line 883 in text file
count = 0;
while count < 883:
    line = f.readline()
    count = count+1
#this would seek over to middle of file DOESN'T WORK
f.seek(0,0)
line = f.readline()
print(line)
f.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:01:32.540

好的，我不是专业程序员，但我的（愚蠢的）方法是：如果总是第 800 行，则在跟踪行号的同时逐行读取文件。然后直接写入新文件。读取第 800 行，更改它，写入它。然后写剩下的。愚蠢而不优雅，但它应该可以工作 - 除非我错过了我可能会做的事情。还有我微薄的名声：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:53:14.733

是和不是。考虑：

```
f=open('output.$2k','r+')
f.seek(300)
f.write('\n')
f.close() 
```

该脚本只是将您的 ascii 文件中的第 300 个字符更改为换行符。现在棘手的部分是没有办法知道 ascii 文件中一行的长度，除非你读到换行符。因此，将文件中的特定字符定位在第 800 行的中间并非易事。但是，如果您可以对行长做出保证（由于文件的编写方式），则可以毫无问题地计算位置。另请注意，替换`1`为`100`在这里不起作用。您需要用 1 个字符替换 1 个字符。

并且仅针对世界上所有其他 *NIX 用户......请不要`$`输入您的文件名。那只是一场噩梦……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:53:20.133

不。读取该行，对其进行操作，然后将其写入您之前打开的新文件中写入（并且一直在写入其他行，未修改）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:41:58.413

第一件事：

```
#this would seek over to middle of file DOESN'T WORK
f.seek(0,0) 
```

这不是真的。这将寻找文件的开头。

* * *

对于您的实际问题：

> 有谁知道一种有效的方法来移动到文件中第 800 行的中间以替换一个数字？

一般来说，没有。你需要重写文件。例如像这样：

```
# open the file in read-and-update mode
with open("file", 'r+') as f:
  # read all lines
  lines = f.readlines()

  # update 800'th line 
  my_line = lines[799].split()
  my_line[5] = "%s" % my_number # TODO: put in index of number and updated number 
  lines[799] = " ".join(my_line)

  # truncate and rewrite file
  f.truncate(0)
  f.writelines(lines) 
```

* * *

如果文件中数字的起始位置是可预测的（例如`number_starting_pos = 1234`从文件的开头）并且字符串表示的大小也是可预测的（例如`20`），您可以这样做。然后您可以重写数字并确保再次用空格填充填充以覆盖前一个条目的任何内容。与此类似：

```
with open("file", 'r+') as f:
  # seek to the number starting position
  f.seek(number_starting_pos, 0)

  # update number field, assuming width (20), arbitrary space-padding allowed
  my_number_string = "%19s " % my_number
  # make sure the string is indeed exactly of the specific size (it may be longer)
  assert len(my_number_string) == 20, "file writing would fail! aborting!"
  f.write(my_number_string) 
```

为此，您需要查看 SAP-thingy 的文档，并查看空格是否确实无关紧要。

* * *

然而，这两种方法都基于很多假设。根据您的用例，它可能很容易破坏您的代码，例如，如果在数字字段之前插入了一行，甚至插入了一个字符。

# apache - 如何在 Web 上托管 apache 服务器？

> ID：11510506
> 
> 赞同：-1
> 
> 时间：2012-07-16T18:40:59.337
> 
> 标签：apache, web-hosting

我已经在我的电脑上安装了 apache。现在我想知道如何在网络上托管我的服务器，以便其他人可以连接到我的服务器并查看我的站点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:42:26.043

如果您已经能够通过 localhost 查看您的网站，您应该能够通过防火墙进行端口转发以允许外部访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:46:12.587

*   确保您在 0.0.0.0 接口上运行您的网络服务器。这可以通过在 linux 上运行以下命令来检查`netstat -anlpt`。检查什么 ip 是端口 80（或 443）监听。它不应该是 127.0.0.1。
*   如果这是您的家用电脑：

    *   您需要将路由器上的 80 端口（如果使用 ssl，则为 443）转发到计算机的 80 端口。您的计算机的 IP 地址可以在`ifoncfig`或`ipconfig`(windows) 输出中看到。通常，您的路由器接口将在类似`http://192.168.0.1`或`http://192.168.1.1`（取决于您的路由器制造商和设置）的地址处可用。
    *   一旦您设置了端口转发，当您键入您的 IP 地址时，您的网站应该可以从 Internet 访问。您的 IP 地址如[http://whatismyip.com所示](http://whatismyip.com)
*   如果这不是您的家用计算机，那么您的网站应该可以通过服务器的公共 IP 地址访问。

*   如果您有一个域名，您需要更新该域的名称服务器配置，以放置一条指向您服务器 IP 地址的 A 记录，并在 apache 中创建一个等效的 vhost 条目。但是，查看您的网站不需要域名，只需[http://wxyz](http://w.x.y.z) IP 就足够了（其中 wxyz 是您的服务器/计算机的公共 IP）

# javascript - Drupal 7 + smoothdivscroll？

> ID：11510510
> 
> 赞同：0
> 
> 时间：2012-07-16T18:41:11.473
> 
> 标签：javascript, jquery, html, css, drupal

我在将脚本 smoothdivscroller 集成到页面内容时遇到问题，由于我对 html、css 和 js 的了解非常薄弱，我找不到问题——这是我的主题 .info 文件[http://www.fpaste.org /wcNv/](http://www.fpaste.org/wcNv/)这是内容 [http://www.fpaste.org/cDDm/](http://www.fpaste.org/cDDm/) 所以我没有让它正常工作，我得到的只是图像彼此相邻堆叠有什么问题？我只是按照文档

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:56:22.017

如果您在本地机器上进行测试，请使用 http 制作如下所示的 jquery 链接：

[http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js)

# python - 确定与 cdll.LoadLibrary 一起使用的库名称的系统级方法

> ID：11510515
> 
> 赞同：1
> 
> 时间：2012-07-16T18:41:41.323
> 
> 标签：python, linux, ctypes, loadlibrary

根据文件，

> 在 Linux 上，加载库*需要指定*包含扩展名的文件名，因此不能使用属性访问来加载库。应该使用 dll 加载器的 LoadLibrary() 方法，或者您应该通过调用构造函数创建 CDLL 实例来加载库：

我正在使用一组外部开发的 python 脚本。它们需要一个*相当*标准的 lib ( `liblzma`) 并使用`LoadLibrary`from`ctypes`来加载它——通过路径名。我的问题是这些脚本需要在几个不同的 linux 安装上运行，并且将来可能更多。*共享库的完整文件名及其`liblzma`位置因系统而异。*我已经针对各种 lib 版本进行了测试，没有发现任何冲突。

**我真正需要**的是一种方法来确定已*安装库*的基本名称，以便将适当的名称传递给`LoadLibrary`.

我考虑过仅`ldconfig -p`用于打印现有库并解析输出以查找库名称。还有其他想法吗？

诚然，我在这里有点不合时宜。有问题的脚本只是一个较大项目的必需部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:45:20.960

只要库位于加载器搜索路径中，您就可以通过相对名称指定它。

```
$ ls /usr/lib64/libXt.*
/usr/lib64/libXt.so.6.0.0

>>> ctypes.CDLL('libXt.so.6.0.0')
<CDLL 'libXt.so.6.0.0', handle 26b72b0 at 2723c90> 
```

# c++ - OpenCV 安装 VS 10 不会构建

> ID：11510521
> 
> 赞同：0
> 
> 时间：2012-07-16T18:42:13.750
> 
> 标签：c++, visual-studio-2010, opencv

我一直在尝试安装 OpenCV，但总是有问题。我尝试的最后一件事是：

[为 Visual Studio 2010 设置 OpenCV-2.3](https://stackoverflow.com/questions/7011238/opencv-2-3-c-visual-studio-2010/7014918#7014918)

但是在运行核心之后我得到了这个错误。

> 'open23.exe'：已加载 'C:\Users\Napster\Documents\Visual Studio 2010\Projects\open23\Debug\open23.exe'，已加载符号。“open23.exe”：已加载“C:\Windows\SysWOW64\ntdll.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\kernel32.dll”，已加载符号（已删除源信息）。'open23.exe'：已加载 'C:\Windows\SysWOW64\KernelBase.dll'，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Users\Napster\Documents\Visual Studio 2010\Projects\open23\Debug\opencv_highgui230.dll”，找不到或打开 PDB 文件“open23.exe”：已加载“C:\ Windows\SysWOW64\user32.dll'，符号加载（源信息剥离）。“open23.exe”：已加载“C:\Windows\SysWOW64\gdi32。dll'，符号加载（源信息剥离）。'open23.exe'：已加载 'C:\Windows\SysWOW64\lpk.dll'，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\usp10.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\msvcrt.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\advapi32.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\sechost.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\rpcrt4.dll”，已加载符号（已删除源信息）。'open23.exe': 加载'C:\Windows\SysWOW64\sspicli.dll', 已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\cryptbase.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\ole32.dll”，已加载符号（已删除源信息）。'open23.exe'：已加载 'C:\Windows\SysWOW64\oleaut32.dll'，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Users\Napster\Documents\Visual Studio 2010\Projects\open23\Debug\opencv_core230.dll”，找不到或打开 PDB 文件“open23.exe”：已加载“C:\ Windows\winsxs\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.4974_none_50940634bcb759cb\msvcp90.dll'，已加载符号。“open23.exe”：已加载“C:\Windows\winsxs\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729。4974_none_50940634bcb759cb\msvcr90.dll'，已加载符号。“open23.exe”：已加载“C:\Windows\winsxs\x86_microsoft.windows.common-controls_6595b64144ccf1df_5.82.7600.16385_none_ebf82fc36c758ad5\comctl32.dll”，已加载符号（已删除源信息）。'open23.exe'：已加载 'C:\Windows\SysWOW64\avifil32.dll'，已加载符号（已删除源信息）。'open23.exe'：已加载 'C:\Windows\SysWOW64\winmm.dll'，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\msacm32.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\msvfw32.dll”，已加载符号（已删除源信息）。'open23.exe': 加载'C:\Windows\SysWOW64\shell32.dll', 已加载符号（已删除源信息）。'open23.exe'：已加载 'C:\Windows\SysWOW64\shlwapi.dll'，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\avicap32.dll”，已加载符号（已删除源信息）。'open23.exe'：已加载 'C:\Windows\SysWOW64\version.dll'，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\msvcr100d.dll”，已加载符号。“open23.exe”：已加载“C:\Windows\SysWOW64\imm32.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\msctf.dll”，已加载符号（已删除源信息）。'open23.exe': 加载 'C:\Windows\SysWOW64\uxtheme.dll', 已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Program Files\CheckPoint\ZAForceField\WOW64\Plugins\ISWSHEX.dll”，找不到或打开 PDB 文件“open23.exe”：已加载“C:\Windows\winsxs\x86_microsoft .vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.6195_none_d09154e044272b9a\msvcr80.dll'，已加载符号。“open23.exe”：已加载“C:\Windows\SysWOW64\wintrust.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\crypt32.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\msasn1.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\winsxs\x86_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727。6195_none_d09154e044272b9a\msvcp80.dll'，已加载符号。“open23.exe”：已加载“C:\Windows\SysWOW64\ntmarta.dll”，已加载符号（已删除源信息）。“open23.exe”：已加载“C:\Windows\SysWOW64\Wldap32.dll”，已加载符号（已删除源信息）。'open23.exe'：已加载 'C:\Program Files\CheckPoint\ZAForceField\WOW64\AK\icsak.dll'，在 open23.exe 中的 0x7605b727 (KernelBase.dll) 处找不到或打开 PDB 文件第一次机会异常： Microsoft C++ 异常：内存位置 0x0015f4d0 处的 std::exception ..“open23.exe”：已加载“C:\Windows\SysWOW64\psapi.dll”，已加载符号（已删除源信息）。open23.exe 中 0x7605b727 (KernelBase.dll) 处的第一次机会异常：Microsoft C++ 异常：内存位置 0x0015f858 处的 std::exception.. 线程“Win32 线程”(0xd20) 已退出，代码为 0 (0x0)。程序“[2392] open23.exe: Native”已退出，代码为 -1 (0xffffffff)。

我的代码

> # 包括
> 
> # 包括
> 
> # 包括
> 
> int main(int argc, char* argv[]) { if (argc < 2) { printf("Usage: ./opencv_hello \n"); 返回-1；}
> 
> ```
> IplImage* img = cvLoadImage(argv[1], CV_LOAD_IMAGE_UNCHANGED); if (!img) {
> return -1; } 
> ```
> 
> cvNamedWindow("显示", CV_WINDOW_AUTOSIZE); cvShowImage("显示", img );
> 
> ```
> cvWaitKey(0);        
> 
> return 0; } 
> ```

额外信息：我将 dll 从 opencv 复制到调试文件夹，因为在我遇到错误之前找不到某些 dll。

另外，我是一个菜鸟，这是我的第一个主要的 C++ 个人项目。所以这是我第一次尝试使用额外的库来创建程序。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:37:05.343

牛米，

我使用了这段代码，它奏效了！

```
#include <cv.h>
#include <highgui.h> 
int main(int argc, char* argv[])
{
 IplImage* img = cvLoadImage( "funny-pictures-cat-goes-pew.jpg" );
 cvNamedWindow( "MyJPG", CV_WINDOW_AUTOSIZE );
 cvShowImage("MyJPG", img);
 cvWaitKey(0);
 cvReleaseImage( &img );
 cvDestroyWindow( "MyJPG" );
 return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:08:50.453

在 Visual Studio 中使用 opencv - 从这里开始[如何在 Microsoft Visual Studio 中使用 OpenCV 构建应用程序](http://docs.opencv.org/doc/tutorials/introduction/windows_visual_studio_Opencv/windows_visual_studio_Opencv.html#windows-visual-studio-how-to)，它解释了如何正确设置所有包含和库路径

此外，您正在混合 C++ 标头和旧的 C 函数名称 - 使用示例中的样式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-11T22:46:39.033

对于将来收到“无法找到或打开 PDB”警告并在谷歌上搜索此答案的任何人：这很可能意味着您包含 32 位（x86）openCV 库而不是 64 位（x64）库

# c# - Live SDK - 通过 Memory Stream 上传 XML 文件

> ID：11510522
> 
> 赞同：1
> 
> 时间：2012-07-16T18:42:14.380
> 
> 标签：c#, windows-phone-7, stream, live, onedrive

`client.UploadAsync`Live SDK（SkyDrive SDK）的方法有点问题。我的代码由于某种原因不起作用，或者更具体地说，它上传了一个空文件。它不会抛出任何错误，并且流的序列化工作（我肯定知道）。

甚至似乎内存流还可以。（因为我没有工具可以真正查看其中的数据，我只是通过查看它的“长度”属性来猜测它是可以的）。

UploadAsync 方法也很好，或者至少当我第一次将数据序列化为 IsolatedStorage 中的 .xml 文件，然后使用 IsolatedStorageFileStream 读取它，然后最终发送该流时，它运行良好。（然后它上传了数据）

关于为什么会发生这种情况的任何建议？

```
 public void UploadFile<T>(string skyDriveFolderID, T data, string fileNameInSkyDrive)
    {
        this.fileNameInSkyDrive = fileNameInSkyDrive;
        {
            try
            {
                memoryStream =  new MemoryStream();

                XmlWriterSettings xmlWriterSettings = new XmlWriterSettings();
                xmlWriterSettings.Indent = true;

                XmlSerializer serializer = new XmlSerializer(typeof(T));
                using (XmlWriter xmlWriter = XmlWriter.Create(memoryStream, xmlWriterSettings))
                {
                    serializer.Serialize(xmlWriter, data);
                }
                client.UploadAsync(skyDriveFolderID, fileNameInSkyDrive, true, memoryStream, null);

            }

            catch (Exception ex)
            {
                if (memoryStream != null) { memoryStream.Dispose(); }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:31:15.533

`UploadAsync`在调用该方法之前，您必须将内存流“倒回”到开头。想象一下记忆流就像你记录东西的磁带。“读/写头”总是漂浮在磁带的某个点上，这就是您的情况的结束，因为您刚刚将所有序列化数据写入它。上传方法试图通过在磁带上向前移动来读取它，意识到它已经到了结尾。因此，您会上传一个空文件。

您需要的倒带方法是：

```
memoryStream.Seek(0, SeekOrigin.Begin); 
```

此外，最好将`using`指令用于`IDisposable`对象，即内存流。这样你就不需要 a `try {...} finally { ...Dispose(); }`（这是由 完成的`using`）。

您的方法可能如下所示：

```
public void UploadFile<T>(string skyDriveFolderID, T data, string fileNameInSkyDrive)
{
    this.fileNameInSkyDrive = fileNameInSkyDrive;

    XmlWriterSettings xmlWriterSettings = new XmlWriterSettings();
    xmlWriterSettings.Indent = true;

    XmlSerializer serializer = new XmlSerializer(typeof(T));

    using (var memoryStream = new MemoryStream())
    {
        using (var xmlWriter = XmlWriter.Create(memoryStream, xmlWriterSettings))
        {
            serializer.Serialize(xmlWriter, data);
        }

        memoryStream.Seek(0, SeekOrigin.Begin);

        client.UploadAsync(skyDriveFolderID, fileNameInSkyDrive, true, memoryStream, null);
    }
} 
```

# actionscript-3 - Intellij 在 ActionScript 项目中不显示“bin”文件夹

> ID：11510530
> 
> 赞同：1
> 
> 时间：2012-07-16T18:42:47.610
> 
> 标签：actionscript-3, intellij-idea

我遇到了 Intellij 11 的问题。它没有在左侧的项目视图中显示“bin”文件夹（ActionScript 3 项目）。

在“Project Settings->Modules”下，“bin”是一个“Excluded”文件夹，但是没有选项可以改变它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:49:27.307

您应该能够单击树浏览`Excluded`器中的按钮。`Project Structure - Modules`

编辑：

我明白了，问题可能是 IntelliJ 默认排除了编译器输出文件夹。尝试更改`Project Structure - Project - Complier Output`文本框中的输出文件夹。

我怀疑你将无法改变这种行为。

# android - 通过 ADB shell 接受“强制关闭”对话框

> ID：11510535
> 
> 赞同：1
> 
> 时间：2012-07-16T18:43:04.220
> 
> 标签：android, adb

我试图弄清楚当Android应用程序因硬错误（特别是out_of_memory）崩溃时如何（或是否有可能）通过adb shell接受“强制关闭”对话框。我希望基本上用 bash 脚本循环一个应用程序，所以当它崩溃时我想重新启动它运行。这里缺少的步骤是我无法模拟按下对话框中间显示的“强制关闭”按钮。

同时，进程似乎并没有真正在运行（试图杀死 PID 不起作用），所以这有点奇怪，因为它似乎已经停止了，但是再次启动它（通过 adb shell am ...) 只是给了我'当前任务已被带到前面'。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T19:24:06.200

+1为[UncaughtExceptionHandler的](http://developer.android.com/reference/java/lang/Thread.UncaughtExceptionHandler.html)[DarkXphenomenon](https://stackoverflow.com/users/759019/darkxphenomenon)。

但是要终止进程，您应该使用**[am](http://developer.android.com/tools/help/adb.html#am)**：

```
am force-stop: force stop everything associated with <PACKAGE>.

am kill: Kill all processes associated with <PACKAGE>.  Only kills.
  processes that are safe to kill -- that is, will not impact the user
  experience. 
```

例如：

```
adb shell am force-stop <YOUR.PACKAGE.NAME> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T18:46:14.233

如果是您自己的应用程序，您可以添加[UncaughtExceptionHandler](http://developer.android.com/reference/java/lang/Thread.UncaughtExceptionHandler.html)并且不显示强制关闭对话框。如果没有，以下可能会起作用。

您也可以从 adb 中终止该进程。（[信用](https://stackoverflow.com/questions/6625824/is-it-possible-to-force-stop-an-application-i-am-debugging-using-adb-in-termin)）

```
adb shell kill $(adb shell ps | grep YOUR.PACKAGE.NAME | awk '{ print $2 }') 
```

之后，您可以使用`adb shell am ...`来重生该进程。

# php - 如何更新倒数第二行？

> ID：11510536
> 
> 赞同：1
> 
> 时间：2012-07-16T18:43:11.603
> 
> 标签：php, mysql

我需要在给定一组条件的情况下更新表中的倒数第二行。如果它是一个`SELECT`查询，它看起来像这样：

```
SELECT col_1 FROM table_1 WHERE id = id_# ORDER BY timestamp_col DESC LIMIT  1,1 
```

但是，当我执行以下操作时出现错误，但这是我想要的行为：

```
UPDATE table_1 SET col_1 = value_# ORDER BY timestamp_col DESC LIMIT 1,1 
```

我知道我可以写这个

```
UPDATE table_1 SET col_1 = value_# ORDER BY timestamp_col DESC LIMIT 1 
```

但我无法弄清楚如何在给定条件集的情况下更新倒数第二行。

更新倒数第二行的正确查询是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:52:21.567

MySQL 不支持[**UPDATE**](http://dev.mysql.com/doc/refman/5.0/en/update.html)或[**DELETE**](http://dev.mysql.com/doc/refman/5.0/en/delete.html)操作的`LIMIT`子句中的“偏移”功能。[](http://dev.mysql.com/doc/refman/5.0/en/update.html)**[](http://dev.mysql.com/doc/refman/5.0/en/delete.html)**

 ****但它***支持***SELECT[**语句**](http://dev.mysql.com/doc/refman/5.0/en/select.html)。

所以你可以做些什么来解决这个问题，将偏移`LIMIT`选择包装在一个连接的子选择中，***然后***只更新`id`and`timestamp_col`等于连接的行`id`，`timestamp_col`就像这样：

```
UPDATE table_1 a
INNER JOIN
(
    SELECT id, timestamp_col
    FROM table_1
    WHERE id = <id>
    ORDER BY timestamp_col DESC
    LIMIT 1,1
) b ON a.id = b.id AND a.timestamp_col = b.timestamp_col
SET a.col_1 = <value> 
```****

# c++ - 出现 OpenCV 错误：运行 OpenCV 示例程序时内存不足：“stitching_detailed.cpp”

> ID：11510545
> 
> 赞同：5
> 
> 时间：2012-07-16T18:44:10.243
> 
> 标签：c++, memory, opencv

我最近开始使用 OpenCV，目的是将大量图像拼接在一起以创建大量全景图。为了开始我的实验，我查看了 OpenCV 文件附带的示例程序，以了解如何实现 OpenCV 库。由于我对图像拼接感兴趣，我直接去了“stitching_detailed.cpp”。代码可以在以下位置找到：

[https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/cpp/stitching_detailed.cpp?rev=6856](https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/cpp/stitching_detailed.cpp?rev=6856)

现在，这个程序完成了我需要它做的大部分事情，但我遇到了一些有趣的事情。我发现，对于 15 个可选投影变形器中的 9 个，当我尝试运行程序时收到以下错误：

```
 Insufficient memory (Failed to allocate XXXXXXXXXX bytes) in unknown function, 
    file C:\slave\winInstallerMegaPack\src\opencv\modules\core\src\alloc.cpp, 
    line 52 
```

其中“X”标记在不同类型的投影之间变化的整数（好像不同的方法需要不同的空间量）。“alloc.cpp”的完整源代码可以在以下网站找到：

[https://code.ros.org/trac/opencv/browser/trunk/opencv/modules/core/src/alloc.cpp?rev=3060](https://code.ros.org/trac/opencv/browser/trunk/opencv/modules/core/src/alloc.cpp?rev=3060)

但是，在 alloc.cpp 中发出此错误的代码行是：

```
 static void* OutOfMemoryError(size_t size)
    {
    --HERE--> CV_Error_(CV_StsNoMem, ("Failed to allocate %lu bytes", (unsigned long)size));
        return 0;
    } 
```

因此，我对可能发生此错误的可能原因感到迷茫。我意识到如果系统内存不足，通常会​​发生此错误，但是根据我的任务管理器，当我使用我的测试图像运行此程序时，我从未使用超过 ~3.5GB 的 RAM。

此外，由于该程序是由 OpenCV 开发人员作为 OpenCV 拼接功能的示例编写的，我发现很难相信源代码中存在严重的内存错误。

最后，如果我使用一些变形方法，程序可以正常工作：

```
- spherical
- fisheye
- transverseMercator
- compressedPlanePortraitA2B1
- paniniPortraitA2B1 
- paniniPortraitA1.5B1) 
```

但是要求程序使用任何其他程序（通过命令行标记
--warp [PROJECTION_NAME]）：

```
- plane
- cylindrical
- stereographic
- compressedPlaneA2B1
- mercator
- compressedPlaneA1.5B1
- compressedPlanePortraitA1.5B1
- paniniA2B1
- paniniA1.5B1 
```

我收到上面提到的错误。我从transverseMercator project warper 得到了很好的结果，但我想特别测试立体图。谁能帮我解决这个问题？

我正在尝试处理的图片分辨率为 1360 x 1024，我的计算机具有以下统计信息：

```
Model: HP Z800 Workstation
Operating System: Windows 7 enterprise 64-bit OPS
Processor: Intel Xeon 2.40GHz (12 cores)
Memory: 14GB RAM
Hard Drive: 1TB Hitachi
Video Card: ATI FirePro V4800 
```

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T06:44:34.657

当我运行 OpenCV 的 APP traincascade 时，我得到和你一样的错误：

```
Insufficient memory (Failed to allocate XXXXXXXXXX bytes) in unknown function, 
    file C:\slave\winInstallerMegaPack\src\opencv\modules\core\src\alloc.cpp, 
    line 52 
```

当时，我的 RAM（6G）只有大约 70% 被占用。而当我一步步运行trainscascade时，我发现当它使用大约超过1.5G的RAM空间时会抛出错误。然后，我发现有两个参数可以控制应该使用多少内存：

> -precalcValBufSize -precalcIdxBufSize 所以我尝试将这两个设置为 128，它运行。希望我的经验可以帮到你。

我认为这个问题与内存泄漏无关，它只是与操作系统限制应用程序占用多少内存有关。我希望有人可以检查我的猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-05T09:27:26.470

这可能和拼接的顺序有关，我把一张大图分割成3*3，先逐行拼接没有问题，再逐列拼接出现和你一样的问题.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-23T14:37:00.253

我最近在 OpenCV 图像拼接方面遇到了类似的问题。我已经使用 create 方法创建了stitcher 实例，并提供了 5 张垂直顺序的图像来缝合方法，但是我收到了内存不足的错误。

设置后成功创建全景图：

`setWaveCorrection(false)`

如果您需要波浪校正，此解决方案将不适用。

# php - 使用 JavaScript 和 PHP 下载图像文件并返回一个 zip 文件

> ID：11510553
> 
> 赞同：0
> 
> 时间：2012-07-16T18:44:42.393
> 
> 标签：php, javascript, zip, archive, zepto

我正在为图像板类型的网站开发 Safari 扩展，我希望实现的更大功能之一是能够下载所有图像（发布的图像，而不是全局页面级图像）已发布。

这里已经有类似的问题，但我的有点不同，因为有问题的图像托管在完全不同的服务器上。我一直在集思广益，并认为将所有图像 URL 收集到 JS 数组中，然后将其发送到我的服务器以转换为 zip 文件（强制下载，而不仅仅是文件的链接）将是最好的要走的路。我还希望在用户下载后删除 zip。

我已经完成了大部分的扩展功能，但是这个让我很难过。任何帮助将不胜感激。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:40:09.573

您可以使用 PHP 的[`ZipArchive`](http://php.net/manual/en/class.ziparchive.php)类制作 ZIP，然后将其流式传输到浏览器。

```
<?php
// Create temp zip file
$zip = new ZipArchive;
$temp = tempnam(sys_get_temp_dir(), 'zip');
$zip->open($temp);

// Add files
$zip->addFromString('file.jpg', file_get_contents('http://path/to/file.jpg'));
$zip->addFile('/this/is/my/file.txt');

// Write temp file
$zip->close();

// Stream file to browser
header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename=myFile.zip');
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate');
header('Pragma: public');
header('Content-Length: ' . filesize($temp));

readfile($temp);

unlink($temp);
exit; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:48:27.060

您想要一个扩展来联系您的服务器进行下载吗？这是一个可怕的想法！在本地制作 zipfile - 它不是常规的 javascript，它是一个扩展 - 您拥有完全访问权限。

无论如何，假设您无论如何都想这样做，那么您遇到了什么麻烦？你得到一个 url 列表，将它们发送到你的服务器，你的服务器下载它们，压缩它们并将它们发送给用户。（“你的服务器下载它们”部分应该让你担心！）

你有什么问题？

# html - 使用 CSS 从顶部移动背景图像

> ID：11510563
> 
> 赞同：1
> 
> 时间：2012-07-16T18:45:25.343
> 
> 标签：html, css, background-image

基本上..

我想从顶部移动主 div 200px 的背景图像，然后在 y 轴上重复。所以我不希望它从 200px 开始；我可以通过 CSS 做到这一点吗？我能想到的唯一方法是在下面，但它不起作用。

我知道我做错了什么，但它是什么？

**这是DIV：**

```
<div class="main">
<p> Content Content </p>
</div> 
```

**这是CSS：**

```
.main { 
    background: url('/wp-content/themes/blue-and-grey/images/addedimages/main-bg.png');
    background-repeat:repeat-y; 
    background-position: 200px 0px 0px 0px; 
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:47:44.233

您想要该[`background-origin`属性](http://www.w3.org/TR/css3-background/#the-background-origin)（但请注意[有限的浏览器支持](http://caniuse.com/#search=background-origin)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:47:45.623

我会尝试用正边距将 div 向下移动，将 p 向上移动到负边距。也许你需要一些`postion: relative`，左右。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T18:58:09.823

背景位置只接受参数：左偏移，上偏移...

背景： url('image.url') 0px 200px 重复-y；

因此，如果您想剪切第一张图片的 200 像素（而不是重复整张图片），您的解决方案并不是完全错误的。

# java - 使用 jersey/apache REST 客户端解析多行、多列文本响应

> ID：11510570
> 
> 赞同：1
> 
> 时间：2012-07-16T18:45:50.743
> 
> 标签：java, rest, jersey

我正在尝试访问返回多行、多列响应的 REST 端点，例如：

```
A1 B1 C1
A2 B2 C2
A3 B3 C3
...
...

```

我目前正在使用 jersey-client 来访问这个端点，并试图寻找最简洁的方法来解析这个响应。在这里，每一行代表一个 bean，比方说`MyBean`，其中的每一列代表该 bean 中的一个属性。响应中值的顺序始终是固定的。

我可以将响应作为长字符串返回，将其拆分为换行符和制表符以获取单个值。

但是，我想知道是否有一种方法可以将结果作为 a 获得`List<String>`，其中的每个元素`List`将代表响应的一行。然后我可以将其拆分`\t`以获取单个值。

这是我尝试过的：

```
 WebResource resource = client.resource(NETSPEAK_URL)
                 .type(MediaType.TEXT_PLAIN)
                 .get(new GenericType<List<String>>(){}); 
```

但这会导致以下异常：

```
 A message body reader for Java class java.util.List, 
    and Java type java.util.List<java.lang.String>, 
    and MIME media type text/plain; charset=UTF-8 was not found 
```

如果我更贪婪，我想知道是否可以将各个列值映射到我的 bean 的属性，`MyBean`. 我考虑过在 周围创建一个包装器`MyBean`，以获得一个`MyBean`s 列表，但是我将如何对其进行注释以帮助解析？这对于 xml/json 响应是有意义的。但这是纯文本。

是否有可能以某种方式告诉 jersey-client 关于解析此文本/普通响应的信息？如果这可以通过 Apache HTTP 客户端实现，我已经准备好搬家了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:33:05.990

您可能想要实现一个代表您的 bean 列表的类，例如`class BeanList extends List<Bean>`，并实现一个`MessageBodyReader<BeanList>`（参见[http://jsr311.java.net/nonav/releases/1.1/javax/ws/rs/ext/MessageBodyReader.html](http://jsr311.java.net/nonav/releases/1.1/javax/ws/rs/ext/MessageBodyReader.html)）来教jersey 如何将字符串读取为`BeanList`.

然后，您可以使用`BeanList.class`而不是`List<String>`作为`get`调用的参数。

# actionscript - 将php时间戳转换为actionScript

> ID：11510571
> 
> 赞同：0
> 
> 时间：2012-07-16T18:45:56.887
> 
> 标签：actionscript

如何将 php 时间戳转换为可在 actionScript 中使用的内容？例如，我如何使用以下时间戳？2011-06-16 10:41:08 时间戳当前存储在 xml 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:47:58.137

这不是 PHP 时间戳，它只是一个格式化的字符串。PHP 时间戳与 unix 时间戳相同 - 一个整数，表示自 1970 年 1 月 1 日以来的秒数。

Actionscripts 时间戳是相同的，但以毫秒为单位。所以取一个原生的 PHP 时间戳，乘以 1000，就是你的 AS 时间戳。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:00:52.587

@Marc B 的回答是正确的。如果由于某种原因您不能使用 PHP 时间戳（自 1970 年 1 月 1 日以来的秒数），您可以尝试使用静态方法`Data.parse()`。

它将根据您的时间字符串返回自 1970 年 1 月 1 日以来的毫秒数。它将处理各种时间字符串格式，[这里是文档的链接](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Date.html#parse%28%29)。您可能必须将时间字符串调整为其中一种格式（在 Actionscript 端使用正则表达式，或在 PHP 端生成不同的字符串）。

一旦获得自 1970 年 1 月 1 日以来的毫秒数，您就可以从中创建一个新的 Actionscript`Date`对象：

```
var date:Date = new Date( Date.parse(myTimeString) ); 
```

# python - 在 Python 中列出具有任意数量变量的推导？

> ID：11510575
> 
> 赞同：3
> 
> 时间：2012-07-16T18:46:08.153
> 
> 标签：python, list-comprehension

我要解决的问题是获取集合 S，它包含 X 个整数的所有可能排列，使得所有整数都大于 0，并且当相加时等于某个 Y。

因此，如果 X 等于 2 并且 Y 等于 5，则可以通过以下列表推导解决问题：

```
[(a,b) for a in range(1,5) for b in range(1,5) if a+b==5] 
```

但是，我正在尝试解决任意 X 和任意 Y。我可以将其编写为一系列巨大的 if 语句，但我觉得我已经非常接近一个很好的、干净的列表理解来处理它了。有没有办法用列表推导来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:50:25.937

当然。但是你需要[`sum()`](http://docs.python.org/library/functions.html#sum)and [`itertools.product()`](http://docs.python.org/library/itertools.html#itertools.product)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:50:43.500

像这样的东西：

```
[x for x in itertools.product(*variables) if sum(x)==5] 
```

其中 variables 是您`range`的 s的列表/元组

# msmq - 找出从给定 MSMQ 队列中读取的程序

> ID：11510582
> 
> 赞同：0
> 
> 时间：2012-07-16T18:46:38.773
> 
> 标签：msmq

我有一个只能由特定程序读取的队列。但是，我发现其他一些程序正在从该队列中“窃取”消息。有没有办法确定哪个程序可以做到这一点？我什么都想不出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T06:56:03.707

对于给定的服务帐户，在队列上设置 read-message 和 peek-message 权限，然后确保只有使用者在该服务帐户下运行。

**更新**

在 Windows server 2008 或 Windows 7 或更高版本上，MSMQ 有一个专用的系统事件日志，用于记录 MSMQ 子系统所做的一切。可以通过这个查看哪个用户帐户正在访问队列。

# asp.net - 在服务器上部署后的报表查看器

> ID：11510584
> 
> 赞同：0
> 
> 时间：2012-07-16T18:46:45.670
> 
> 标签：asp.net

本地报告处理过程中发生错误。报告“D:\Inetpub\Vhosts\skyhighindustries.net\httpdocs\Sky\Report3.rdlc”的定义无效。报告处理中出现意外错误。拒绝访问路径“D:\temp\expression_host_7fc1e8bf42474ccfb1dbd1c05ceaa6e5.dll”。请帮助我在服务器上部署我的报告后遇到此错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:49:07.810

确保您的应用程序在 IIS 中使用的身份至少具有对您的报告服务实例的浏览器访问权限。

# ruby - 将 God 与多个应用程序一起使用，并在重新启动后自动启动它们

> ID：11510594
> 
> 赞同：2
> 
> 时间：2012-07-16T18:47:20.893
> 
> 标签：ruby, gem, centos, god, process-monitoring

我目前正在尝试使用 god 监视总共三个 Rails/Rack 应用程序的各种进程/守护进程。监控效果很好，问题是我无法将上帝配置为在重新启动后自动启动所有进程。

我的设置：我正在使用 Centos 和 Plesk 运行 Linux VPS。我有一个非 root linux 用户“部署者”，用于部署和运行三个 Rails/Rack 应用程序。两个应用程序正在使用乘客 apache 模块运行，第三个应用程序使用瘦服务器（这是必要的，因为该应用程序不能与 apache 一起使用）。使用乘客的两个 Rails 应用程序有额外的 rake 任务在后台运行 - 这些和瘦服务器由上帝监控。

神 gem 在所有三个应用程序的 Gem 文件中指定。

在每个 deploy.rb 文件中，我都有一个看起来像的方法

```
namespace :misc do
    desc "restart woekers using gog; restart webserver"
    task :restart, roles: [:web, :resque] do
        run "touch #{current_path}/tmp/restart.txt"
        god.all.start
        god.all.reload
        god.all.terminate
        god.all.start
    end
end 
```

重新启动服务器后，如果我手动为所有三个应用程序运行 cap misc:restart，所有进程都会启动并正确监控。

到目前为止，每次尝试在启动时自动启动 God 并启动所有必要的进程都失败了。我尝试了很多不同的东西，但没有任何效果。到目前为止，我的方法是使用 @reboot 创建一个运行以下三个脚本的 cron 任务：

```
#!/bin/bash -l

cd /path/to/app/ && bundle exec god -c /path/to/app/config/god/resque.god && bundle exec god load /path/to/app/config/god/resque.god && bundle exec god start resque 
```

这对第一个应用程序非常有用：上帝和所有进程都已启动。当为第二个应用程序执行脚本时（当然使用正确的路径），上帝无法启动任务。我启用了登录上帝，错误消息（在机架应用程序的情况下）是“瘦：找不到命令”。当我首先启动 Rack Application 时，thin 已正确启动，并且未找到其他任务的命令。

我不明白我的配置有什么问题。如上所示，我在上帝调用之前添加了 bundle exec 命令（因此这些命令应该在其各自应用程序的环境中执行） - 然而，它只是不起作用。

如果有人能帮助我让上帝自动启动，我将不胜感激。

如果您需要更多信息，请随时询问！

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T15:02:49.897

我正在做类似的事情并采取了这种方法：

使用 upstart 或类似的东西在系统启动时启动上帝守护进程，对我来说，这样做是这样的：

**/etc/init/god.conf**

```
description "god"

start on runlevel [2]
stop on runlevel [016]

console owner

exec /usr/local/rvm/bin/rvm_god -c /etc/god

respawn 
```

那家伙运行 god 指定*一个*带有 -c 选项的 ruby​​ god 配置文件：

**/etc/神**

```
# Load the configs

God.load "/home/dangerousbeans/kitten_smusher/config/config.god"
God.load "/home/dangerousbeans/irc_nommer/config/config.god" 
```

这个 ruby​​ dude 加载到单个应用程序 God 配置中，运行 God.load 会导致它们启动。

当我使用 RVM 时，我猜单个文件看起来像这样： **/home/dangerousbeans/irc_nommer/config/config.god**

```
God.watch do |w|
  w.dir = "/home/dangerousbeans/irc_nommer"
  w.name = "IRCnommer"

  # scary rvm magic begins
  gemsets_path = [
        "/home/dangerousbeans/.rvm/gems/ruby-1.9.3-p125@irc_nommer/bin",
        "/home/dangerousbeans/.rvm/rubies/ruby-1.9.3-p125/bin",
    "/home/dangerousbeans/.rvm/bin",
      ENV['PATH'] # inherit this
    ].join(':')

   w.env      = {
    "PATH"        => gemsets_path,
        "GEM_PATH"    => "/home/dangerousbeans/.rvm/gems/ruby-1.9.3-p125@irc_nommer"
    }
  # scary rvm magic ends

  w.log = "/tmp/ircnommer.log"

  w.start = "ruby /home/dangerousbeans/irc_nommer/irc_nommer.rb"
  w.keepalive
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-30T08:13:58.010

关键是手动和自动的环境不同，而上帝执行[start]命令。因此，您可以将命令添加`env`到命令中。喜欢：

```
God.watch do |w|
  w.start    = "cd #{your_app_directory}; env >> log/god.log; your-real-command >> log/god.log 2>&1"
end 
```

`env`当您在同一目录中键入时，会有一些差异。检查差异并将所需/正确的段落添加到上帝的环境中。

今天遇到一个问题，我在 1 个服务器上部署了 2 个 rails 应用程序，都使用了上帝。App#2 无法正确启动命令。经过上述测试，我找到了原因：上帝持有一个指向 App#1 的环境变量 [BUNDLE_GEMFILE]。所以我添加了一个简单的行然后错误消失了：

```
God.watch do |w|
  w.env = {
    "BUNDLE_GEMFILE" => "#{$rails_root}/Gemfile"
  }
end 
```

# gwt - 如何通过终端构建现有的 gwt 项目

> ID：11510595
> 
> 赞同：0
> 
> 时间：2012-07-16T18:47:25.267
> 
> 标签：gwt, ant, build

我想构建以下[gwt 教程项目](http://google-web-toolkit.googlecode.com/files/gwt_hibernate_dto.zip)

我习惯了 gwt Eclipse 插件，所以在通过命令行构建现有项目时不知所措，我尝试使用`ant build hosted`下载的项目文件夹中的命令，[就像教程中提到的那样](https://developers.google.com/web-toolkit/articles/using_gwt_with_hibernate)，并得到了这些错误：

```
 ant build hosted
    Buildfile: /home/antonio/Desktop/LABATI/MusicStoreDTO-NOECLIPSE/build.xml

    libs:

    BUILD FAILED
    /home/antonio/Desktop/LABATI/MusicStoreDTO-NOECLIPSE/build.xml:18: Warning: Could not find file /home/antonio/Desktop/LABATI/MusicStoreDTO-NOECLIPSE/C:/eclipse/plugins/com.google.gwt.eclipse.sdkbundle.win32_1.6.4.v200904062334/gwt-windows-1.6.4/gwt-servlet.jar to copy.

    Total time: 0 seconds

  [1]: http://google-web-toolkit.googlecode.com/files/gwt_hibernate_dto.zipTI/MusicStoreDTO-NOECLIPSE/build.xml%20%20libs:%20%20BUILD%20FAILED%20/home/antonio/Desktop/LABATI/MusicStoreDTO-NOECLIPSE/build.xml:18:%20Warning:%20Could%20not%20find%20file%20/home/antonio/Desktop/LABATI/MusicStoreDTO-NOECLIPSE/C:/eclipse/plugins/com.google.gwt.eclipse.sdkbundle.win32_1.6.4.v200904062334/gwt-windows-1.6.4/gwt-servlet.jar%20to%20copy.%20%20Total%20time:%200%20seconds 
```

我注意到 win32 所需的文件。我在 Ubuntu 12.04 机器上工作，这个源不能从非 Windows 机器构建吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:59:16.257

GWT 的当前版本是 2.5，`gwt-windows-1.6.4`自 2009 年以来已经过时。您应该遵循更新的教程，该教程指的是最新（或至少是最近的）版本。

# ruby-on-rails - 使用 rails ActionView::TemplateRenderer 在没有请求或会话的情况下呈现模板

> ID：11510597
> 
> 赞同：0
> 
> 时间：2012-07-16T18:47:31.507
> 
> 标签：ruby-on-rails, rendering

我需要在没有请求或会话的情况下呈现一些 Rails HAML 模板。

我找到了这个类：[http ://rubydoc.info/docs/rails/3.1.1/ActionView/TemplateRenderer](http://rubydoc.info/docs/rails/3.1.1/ActionView/TemplateRenderer)

...但我运气不好。

我无法弄清楚将什么作为“local_context”参数传递给构造函数（在 ActionView::AbstractRenderer 中定义）。

有人可以提供一个如何使用这个类的小例子吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:06:30.240

一位朋友传递了这个链接，结果证明它可以满足我的需求。

[http://haml.info/docs/yardoc/Haml/Engine.html](http://haml.info/docs/yardoc/Haml/Engine.html)

不过，我仍然有兴趣了解如何使用 ActionView::TemplateRenderer，因为它似乎提供了对更多格式的支持，并且可能还有其他优势。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T03:09:21.573

谷歌搜索包括短语“render rails view in rake task”出现了许多解决方案，其中一个似乎最好：

[http://mamykin.com/2011/06/28/how-to-render-view-from-rake.html](http://mamykin.com/2011/06/28/how-to-render-view-from-rake.html)

# java - 将带有图像的文件夹添加到 ant build

> ID：11510600
> 
> 赞同：0
> 
> 时间：2012-07-16T18:47:44.440
> 
> 标签：java, ant

很抱歉，这是一个新手问题，但我在使用 Ant 时遇到了一些问题，我不确定如何解决这些问题。

我不知道如何添加包含 png 和 jpg 图像的文件夹。稍后将显示这些图像，并将使用以下命令调用：

```
new URL("file:///" + System.getProperty("user.dir") + "\\img\\IMAGENAMEHERE.png") 
```

这些文件位于/src 旁边的文件夹中的文件夹/img 中。

所以，我有我的 ant 构建文件，我的类路径是：

```
<path id="classpath">
    <fileset dir="libs">
        <include name="**/*.jar" />
    </fileset>
    <pathelement location="${build}" />
    <pathelement location="${instrumented.dir}" />
    <pathelement location="${build}/tests" />
    <pathelement location="${libs}" />
    <pathelement location="${img}" />
</path> 
```

由于这不起作用，我尝试将图像复制到构建文件夹中（在 ant 构建文件中，我创建了一个构建文件夹和一个 bin 文件夹）

```
<target name="setup">
    <delete dir="${build}" />
    <mkdir dir="${build}"/>
    <mkdir dir="${build}/app"/>
    <mkdir dir="${build}/tests"/>

    <copy todir="${build}/img"> 
        <fileset dir="${img}" >
            <include name="**/*.png" />
            <include name="**/*.jpg" />
        </fileset> 
    </copy>
</target> 
```

但这也不起作用，我不知道该怎么办。问题是，~~当~~我用 Ant 编译后，在控制台调用中运行它时出现此错误`java StartProgram`：

```
Unable to obtain resource from C:\folder\img\salidaCerrada.png: java.util.zip.ZipException: error in opening z
ip file
    [junit] Unable to obtain resource from C:\folder\img\salidaCerrada.png:
    [junit] java.util.zip.ZipException: error in opening zip file
    [junit]     at java.util.zip.ZipFile.open(Native Method)
    [junit]     at java.util.zip.ZipFile.<init>(ZipFile.java:127)
    [junit]     at java.util.jar.JarFile.<init>(JarFile.java:135)
    [junit]     at java.util.jar.JarFile.<init>(JarFile.java:99)
    [junit]     at org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLo
ader.java:1006) 
```

任何的想法？事先谢谢你。

编辑：我忘了提到我不是在创建 .jar 文件，而只是测试我的应用程序并编译它（创建 .class 文件）。图像也不在 .jar 文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:36:41.020

我的第一个想法是您的 ${img} 元素没有指向任何地方。如果您使用工具来创建 build.xml 文件，那么它可能会创建 ${libs} 和其他属性。首先，您应该将 ${img} 替换为 'img'（无引号）。

我的第二个想法是您正在“工作”目录中寻找图像，但这可能没有设置为您认为应该的样子，特别是如果您在其他工具中运行。我建议你打印出 System.getProperty("user.dir") 的值，看看它到底是什么。根据您需要做什么，如果您从类路径加载图像，您可能会得到更好的结果（您应该能够找到一些关于如何从类路径加载资源流的好教程）。

# java - 输入时检测到文件结尾——请帮助

> ID：11510603
> 
> 赞同：0
> 
> 时间：2012-07-16T18:47:50.647
> 
> 标签：java, file

我尝试提交这个并且弹出一个错误说**** END OF FILE detected on input - EXIT ****。

我无法弄清楚这意味着什么，只是为了清楚我正在尝试建立一个系统，以便在循环中输入数据，除非值为 0。谢谢。

这是我的代码：

```
class Main
{
    public static void main( String args[] )
    {
        int SN = 1;
        while ( SN != 0)
        {
            System.out.print("#SN : " );
            SN = BIO.getInt();
            System.out.print("#CW : " );
            int CW = BIO.getInt();
            System.out.print("#EX : " );
            int EX = BIO.getInt();
            double Mark = CW + EX;
            System.out.printf("SN= " + SN + "EX= " + EX + "CW= " + CW + "Mark= " + "%6.1f", (double) Mark / 2      );
        }
    }
} 
```

这是生物代码：

```
class BIO
{
  private static final int EOF  = -1;
  private static final int NONE = -2;
  private static int nextChar = NONE;
  private static boolean EOFdetected = false;

  public static String getLineBASE()
  {
    String line = "";                                 // Line read 
    int    ch;                                        // Read ch 

    try
    {
      ch = System.in.read();                          // No next char 

      if ( ch == EOF ) 
      {
        System.out.println("**** END OF FILE " + 
                           "detected on input -- EXIT ****" );
        System.exit(-1);
      }
      while( ch != '\n'  )                            // Read loop 
      {
        if ( ch == EOF )
        {
          EOFdetected = true;
          return line;                                //  exit 
        }
        line = line + (char) ch;                      //  form line 
        ch = System.in.read();                        //  next ch 
      }
      return line;                                    // return line 
    }
    catch( IOException exp )                          // Problem 
    {
      System.exit(-1);                                // Exit ** 
    }
    return "";                                        // Blank line 
  }

 public static String getLine()
  {
    String line = getLineBASE();                      // Read line 
    //System.out.println( line ); 
    return line;
  }

  public static String getString()
  {
    String line = getLine();                          // Read line 
    return line.trim();
  }

  public static double getDouble()
  {
    String res = getLine();                           // Read line 
    double value = 0.0;                               // 
    try
    {
      value = Double.parseDouble( res.trim() );       // Convert 
    }
    catch ( NumberFormatException ex )                // Problem 
    {                                                 //  ignore 
    }
    return value;                                     // return 
  }

  public static int getInt()
  {
    String res = getLine();                           // Read line 
    int value = 0;                                    // 
    try
    {
      value = Integer.parseInt( res.trim() );         // Convert 
    }
    catch ( NumberFormatException ex )                // Problem 
    {                                                 //  ignore 
    }
    return value;                                     // return 
  }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:19:40.573

```
 try
{
  ch = System.in.read();  //reads from keyboard.

  if ( ch == EOF ) 
  {
    System.out.println("**** END OF FILE " + 
                       "detected on input -- EXIT ****" );
    System.exit(-1);
  }
} 
```

此代码段从键盘读取输入。如果您想从文件中读取内容（我假设您是，因为有一个 EOF）查找[Scanner](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html)类。如果这不是你想要的，我很抱歉，我只是在做假设。

# javascript - 无法使用 javascript 在网页上显示本地图像

> ID：11510610
> 
> 赞同：0
> 
> 时间：2012-07-16T18:48:13.373
> 
> 标签：javascript, android, android-webview

我正在尝试在网页视图中的网页上的网址之后添加一些本地图像图标。

试图执行的 JS 函数代码是

```
var anchors = document.getElementsByClassName('title');
var img = new Image(); 
img.src = 'file:///android_asset/high.png'; 
for (var i=0; i<anchors.length; i++)
{ 
    links.push(anchors[i].children[0].href); 
    var tag = anchors[i].children[0];
    tag.insertAdjacentHTML('AfterEnd', '&nbsp;&nbsp;<img src=img alt=\"My Image\"/>');
} 
```

看不到附加的图像，而我收到错误“不允许加载本地资源”我的问题是为什么我看不到图像？而且我也遇到了错误。

# algorithm - 通过浮点或双字段算法进行索引

> ID：11510612
> 
> 赞同：0
> 
> 时间：2012-07-16T18:48:56.860
> 
> 标签：algorithm

我的任务是通过某些对象的字段在巨大的内存对象数组中执行快速搜索。我需要选择满足某些条件的对象子集。

可以将标准指定为浮点值或此类值的范围（例如`2.5..10`）。

问题是要搜索的 float 属性分布不是很均匀；它可能包含几个具有值范围的对象`10-20`（例如）和另外一百万个具有值的对象`0-1`，以及另外一百万个具有值的对象`100-150`。

那么，建立索引以有效搜索这些对象的可能性有多大？欢迎使用代码示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:51:58.163

如果内存中的数组是有序的，那么二进制搜索将是我的第一次尝试。维基百科条目也有示例代码。

[http://en.wikipedia.org/wiki/Binary_search_algorithm](http://en.wikipedia.org/wiki/Binary_search_algorithm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:21:13.580

如果您只进行查找，则单一排序后跟多个二进制搜索是好的。

如果您想要最终的查找速度等等，您也可以尝试一个完美的哈希算法。

如果您需要的不仅仅是查找，请查看 treaps 和红黑树。前者平均速度快，而后者表现不错，操作持续时间可变性低。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T04:39:37.077

您可以尝试使用[范围树](http://en.wikipedia.org/wiki/Range_tree)来满足范围要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:38:07.853

我看不出值的分布与建立索引有什么关系（可能完全重复的例外）。由于数据适合内存，只需提取所有具有原始位置的字段，对它们进行排序，然后按照@MattiLyra 的建议使用二进制搜索。

我们错过了什么吗？

# javascript - 如何从内容脚本 1 到附加脚本到内容脚本 2 获取数据？

> ID：11510613
> 
> 赞同：1
> 
> 时间：2012-07-16T18:48:56.277
> 
> 标签：javascript, firefox-addon, firefox-addon-sdk

恐怕我还没有弄清楚脚本之间的通信是如何`port`工作的。在`panel.js`我听着要在面板中按下的提交按钮。我将值保存在一个数组中`vals`并将它们传递给：

```
self.port.emit("submitted", vals); 
```

听`main.js`：

```
panel.port.on("submitted", function(vals) { ... }); 
```

现在我想发送`vals`到另一个内容脚本（'page.js'），它将使用数据来操作网站的 DOM。

在 main.js 我试过：

```
require("page-mod").PageMod({
    include: "*",
    contentScriptWhen: 'end',
    contentScriptFile: data.url("page.js"),
    onAttach: function(worker) {
        panel.on('submitted', function(vals) {
            worker.port.emit('output', vals);
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T08:31:57.987

一般来说，你正在尝试的东西看起来会起作用——只是你可能想`panel.on`用`panel.port.on`. 但是，工人可以来来去去，你不想尝试与那些不再在那里的人交流。该[文档](https://addons.mozilla.org/en-US/developers/docs/sdk/1.8/packages/addon-kit/page-mod.html)有一个很好的示例，允许跟踪活跃的工作人员，可以根据您的目的对其进行微调：

```
var workers = [];

var pageMod = require("page-mod").PageMod({
  include: '*',
  contentScriptWhen: 'end',
  contentScriptFile: data.url('page.js'),
  onAttach: function(worker) {
    // Add new worker to the list
    workers.push(worker);
    worker.on('detach', function () {
      // Remove no longer active worker from the list
      var index = workers.indexOf(worker);
      if (index >= 0)
        workers.splice(index, 1);
    });
  }
});

panel.port.on('submitted', function(vals) {
  for (var i = 0; i < workers.length; i++)
    workers[i].port.emit('output', vals);
}); 
```

# macos - Github.app：无法连接到远程存储库（不在 github.com 上）

> ID：11510615
> 
> 赞同：0
> 
> 时间：2012-07-16T18:48:58.150
> 
> 标签：macos, git, ssh, github

我正在尝试在我自己的网络空间上托管一个 git 存储库。

存储库已通过终端+ ssh 设置，没有任何问题，我也对存储库进行了本地克隆，没有任何问题。

现在我正在尝试使用 github 应用程序同步/推送到导致大问题的外部存储库。github 应用程序不断提示输入 ssh 密码（我认为它是 ssh 密码 - 该框只显示“密码：”），即使我输入了正确的密码。

外部存储库的 url 似乎是正确的，我做错了什么（git 初学者 Oo）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T12:31:26.290

好的，我发现了我的错误：

要将您的外部非 github 存储库与本地存储库同步，您的外部存储库不能激活您要同步的分支。

我将外部存储库切换到一个虚拟分支，然后同步工作没有问题......

# javascript - 使用保存和取消按钮切换编辑按钮

> ID：11510619
> 
> 赞同：4
> 
> 时间：2012-07-16T18:49:04.007
> 
> 标签：javascript, jquery, html, button, toggle

我想在单击时更改按钮。最初只有一个“编辑”按钮。单击它后，它将变成一个“保存”按钮，我还想在它旁边显示一个“取消”按钮。我怎样才能做到这一点？我有下面的代码。

```
 <!DOCTYPE html>
    <html>
    <head>
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <meta charset=utf-8 />
    <title>demo by roXon</title>
    <!--[if IE]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    </head>

    <body>
    <button data-text="Save">Edit</button>
    <p>Hello</p>
    <p style="display: none">Good Bye</p>

<script>
$("button").click(function(){
    $(this).nextUntil('button').toggle();

    var btnText = $(this).text();
    $(this).text( $(this).data('text') );
    $(this).data('text', btnText );
});
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:02:12.127

您可以为取消添加一个新按钮，并根据需要将其隐藏。你可以按照[这里的演示](http://jsfiddle.net/WdezH/4/)

这是您需要的代码：

```
<button id='EditSave' data-text="Save">Edit</button>
<button id='Cancel' data-text="Cancel" style="display:none;">Cancel</button>
    <p>Hello</p>
    <p style="display: none">Good Bye</p>​

$("#EditSave").click(function(){
    var btnText = $(this).text();
    if(btnText == 'Edit')
    {
        $(this).text('Save');
        $('#Cancel').show();
    }
    else
    {
        $(this).text('Edit');
        $('#Cancel').hide();
    }
});

$('#Cancel').click(function(){
    $(this).hide();
    $('#EditSave').text('Edit');
});
​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:51:08.513

我建议像这个**[jsFiddle 示例](http://jsfiddle.net/j08691/JbZnf/2/)**这样的布局和 jQuery 。

**jQuery**

```
$('.edit').click(function() {
    $(this).hide();
    $(this).siblings('.save, .cancel').show();
});
$('.cancel').click(function() {
    $(this).siblings('.edit').show();
    $(this).siblings('.save').hide();
    $(this).hide();
});
$('.save').click(function() {
    $(this).siblings('.edit').show();
    $(this).siblings('.cancel').hide();
    $(this).hide();
}); 
```

​</p>

**HTML**

```
<form>
    <div>
    <input class="edit" type="button" value="Edit" />
    <input class="save" type="button" value="Save" /> 
    <input class="cancel" type="button" value="Cancel" />
    </div>
    <div>
    <input class="edit" type="button" value="Edit" />
    <input class="save" type="button" value="Save" /> 
    <input class="cancel" type="button" value="Cancel" />
    </div>
    <div>
    <input class="edit" type="button" value="Edit" />
    <input class="save" type="button" value="Save" /> 
    <input class="cancel" type="button" value="Cancel" />
    </div>
</form> 
```

**​CSS**

 **```
.save, .cancel {
display:none;
}​ 
```**

# mysql - 使用 mysql IN 找到相反的结果

> ID：11510621
> 
> 赞同：0
> 
> 时间：2012-07-16T18:49:11.760
> 
> 标签：mysql, subset

我有两个 mysql 表，event_template 和 event_occurrence，其中 event_occurrence 有一个带有 event_template id 的列。我想找到所有没有 event_occurrence 的 event_templates。

尝试这个查询我得到 0 行：

```
SELECT * FROM `event_template` where id NOT IN (SELECT event_template_id FROM event_occurrence) 
```

请注意，event_template 有 166 行，此查询返回 162 行：

```
SELECT * FROM `event_template` WHERE id IN (SELECT event_template_id FROM event_occurrence) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:01:29.870

您应该使用`NOT EXISTS`而不是`NOT IN`. 这应该适合你：

```
SELECT * 
FROM event_template et
WHERE NOT EXISTS (SELECT NULL FROM event_occurrence eo where eo.event_template_id = et.id) 
```

# antlr - 为什么这个语法给我一个“非 LL(*) 决定”错误？

> ID：11510624
> 
> 赞同：1
> 
> 时间：2012-07-16T18:49:35.433
> 
> 标签：antlr, antlrworks

我正在尝试在我的语法中添加对表达式的支持。我正在遵循[Scott Stanchfield 的 Antlr Tutorial](http://javadude.com/articles/antlr3xtut/)给出的示例。由于某种原因，添加规则导致错误。它导致非 LL(*) 错误说，“决策可以匹配输入，例如“'+'..'-' IDENT”，使用多种替代方案”

简单的输入如：

```
a.b.c + 4 
```

导致错误。我正在使用 AntlrWorks Interpreter 来测试我的语法。如何为一元 +/- 和添加规则构建树似乎存在问题。我不明白为什么有两种可能的解析。

这是语法：

```
path    :   (IDENT)('.'IDENT)* //(NAME | LCSTNAME)('.'(NAME | LCSTNAME))*
    ;

term    :   path
    |   '(' expression ')'
    |   NUMBER
    ;

negation 
    :   '!'* term
    ;

unary   :   ('+' | '-')* negation

    ;

mult    :   unary (('*' | '/' | '%') unary)*
    ;

add     :   mult (( '+' | '-' ) mult)*
    ;

relation 
    :   add (('==' | '!=' | '<' | '>' | '>=' | '<=') add)*
    ;

expression
    :   relation (('&&' | '||') relation)*
    ;

multiFunc   
    :   IDENT expression+
    ;

NUMBER  :   DIGIT+ ('.'DIGIT+)?
    ;

IDENT   :   (LCLETTER|UCLETTER)(LCLETTER|UCLETTER|DIGIT|'_')*
    ;

COMMENT
        :       '//' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
    |       '/*' ( options {greedy=false;} : . )* '*/' {$channel=HIDDEN;}
        ;

WS  :   (' ' | '\t' | '\r' | '\n' | '\f')+ {$channel = HIDDEN;}
    ;

fragment
LCLETTER 
    :   'a'..'z'
    ;

fragment
UCLETTER:   'A'..'Z'
    ;   

fragment
DIGIT   :   '0'..'9'
    ; 
```

我需要一双额外的眼睛。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:38:18.790

您让一个或多个表达式匹配的事实：

```
multiFunc   
 : IDENT expression+
 ; 
```

使你的语法模棱两可。假设您正在尝试`"a 1 - - 2"`使用`multiFunc`规则进行匹配。解析器现在有 2 种可能的方式来解析它：`a`被 匹配`IDENT`，但是 2 个减号`1 - - 2`会导致`expression+`. 以下 2 种解析是可能的：

## 解析 1

![在此处输入图像描述](../Images/0140497a9c167da17403c6054aa2b989.png)

## 解析 2

![在此处输入图像描述](../Images/70829e351de6603a0f1d62b0e08d763b.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:18:14.313

你的语法规则`multiFunc`有一个表达式列表。表达式可以以 开头`+`或`-`代表`unary`，因此由于列表的原因，它也可以后跟相同的标记。这与`add`规则相冲突：在继续和终止之间做出决定存在问题。

# windows - Win2003上的Apache找不到指定的路径

> ID：11510625
> 
> 赞同：0
> 
> 时间：2012-07-16T18:49:43.313
> 
> 标签：windows, filepath, apache2.2

在 Win2003 上全新安装 Apache 2.2。
使用 apache 工具验证配置，但当我尝试访问该站点时，浏览器显示内部错误。

Apache 日志显示：

> [Mon Jul 16 13:36:38 2012] [error] [client 10.162.9.158] (OS 3)系统找不到指定的路径。：无法生成子进程：D:/Heatmap/Webapp/public/dispatch.cg

文件系统显示：

> D:\Heatmap\Webapp\public>dir dispatch* 驱动器 D 中的卷是数据卷序列号是 C482-3950
> 
> D:\Heatmap\Webapp\public 目录
> 
> 05/02/2012 10:56 AM 445 dispatch.cgi 05/02/2012 10:56 AM 520 dispatch.fcgi 2 File(s) 965 bytes 0 Dir(s) 5,625,618,432 bytes free

由于我通常在 Linux 服务器上运行 Apache，因此我不知道根本原因是什么。系统找不到存在的路径。

请指路明灯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:42:54.000

消息的那部分*不能产生子进程*引起了我的注意。

研究表明，shebang 行实际上是由 Apache 使用的——除非 WinOS 级别的 Perl 将文件扩展名与解释器相关联——我需要在我的 .cgi 中更正它。

在 cgi 的 shebang 行中指定 Perl 的完整路径更正了该问题。

# python - Python 多处理负载均衡器

> ID：11510626
> 
> 赞同：3
> 
> 时间：2012-07-16T18:49:44.390
> 
> 标签：python, performance, parallel-processing, multiprocessing

简短的问题：是否有可能有`N`工作流程和一个`balancer`流程，它会找到此时什么都不做的工人并传递`UnitOfWork`给它？

长问题：想象这样的课程，女巫将被子类化以完成某些任务：

```
class UnitOfWork:
  def __init__(self, **some_starting_parameters):
    pass
  def init(self):
    # open connections, etc.
  def run(self):
    # do the job 
```

启动平衡器和工作进程：

```
balancer = LoadBalancer()
workers  = balancer.spawn_workers(10) 
```

部署工作（平衡器应该找到一个惰性工作人员，并将任务传递给它，否则如果每个工作人员都很忙，则将 UOW 添加到队列中并等待空闲工作人员）：

```
balancer.work(UnitOfWork(some=parameters))
# internally, find free worker, pass UOW, ouw.init() + ouw.run() 
```

这是可能的（或者是疯了）？

PS我熟悉`multiprocessing` `Process`类和进程池，但是：

*   每个`Process`实例都启动一个进程（是的:)）-我想要固定数量的工人
*   我想要`Process`可以进行通用工作的实例

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T21:11:26.947

我建议您看一下，`multiprocessing.Pool()`因为我相信它可以完全解决您的问题。它运行 N 个“工作进程”，当每个工作人员完成一项任务时，会提供另一个任务。而且不需要“毒丸”；这很简单。

我一直使用`.map()`池上的方法。

[Python multiprocessing.Pool：何时使用 apply、apply_async 或 map？](https://stackoverflow.com/questions/8533318/python-multiprocessing-pool-when-to-use-apply-apply-async-or-map)

编辑：这是我写给另一个问题的答案，我`multiprocessing.Pool()`在我的答案中使用了。

[并行文件匹配，Python](https://stackoverflow.com/questions/7623211/parallel-file-matching-python/7624949#7624949)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T19:36:37.723

您不需要平衡器中的任何智能；单独的队列会做你想做的事。将每个工作单元放入队列中，让工作人员循环，从队列中取出一个工作单元并在每次迭代中处理它。我认为通过队列传递 UnitOfWork 的实例没有任何问题。

如果你有固定的工作要做，你可以创建一个“没有更多工作要做”的工作单元（一个“毒丸”），告诉工人关闭，并且在所有常规工作都投入之后队列，将尽可能多的毒丸放入队列中，因为你有工人。

# c# - 使用 C# 应用程序更新 ASP.NET 网站上的内容

> ID：11510632
> 
> 赞同：-3
> 
> 时间：2012-07-16T18:50:10.113
> 
> 标签：c#, asp.net, .net, web-services

我将使用 ASP.NET 和 C# 构建一个网站，这将是一个基本的公告板。将要更新内容的人想要一个独立的应用程序来轻松地添加和删除网站上的公告。我是网络编程的新手，正在寻找关于如何最好地解决这个问题的建议。感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:52:29.193

[ASP.Net](http://www.asp.net)网站充满了信息。您可能想查看[WebMatrix](http://www.asp.net/web-pages)，它是免费的，是一个非常适合新程序员使用的非常好的工具。

# python - Python：奇怪的 for 循环行为

> ID：11510635
> 
> 赞同：1
> 
> 时间：2012-07-16T18:50:18.027
> 
> 标签：python, for-loop

我正在尝试解决这个问题：[CodeEval](http://www.codeeval.com/public_sc/60/)。

这个问题需要我浏览 XY 坐标中可能的候选点列表。然后，如果他们满足要求，我将它们添加到“已确认”列表中，然后将周围的点添加到“tosearch”列表中。然而，这根本不像我期望的那样表现。

**示例代码：**

```
Starting point
tosearch=[[0,0]] 

for point in tosearch:

    if conditions filled:
        confirmed.append(point)
        #Basically Im trying to add (x,y-1) etc. to the tosearct list
        tosearch.append([point[0],point[1]-1])  #1 
        tosearch.append([point[0]+1,point[1]])  #2
        tosearch.append([point[0]-1,point[1]-1])#3
        tosearch.append([point[0],point[1]+1])  #4
        tosearch.remove(point)
else:
     tosearch.remove(point) 
```

这似乎导致总是忽略一半的附加。所以在这种情况下 #1 和 #3 被忽略。如果我只留下 1&2 那么只有 2 会执行。我不明白...

也许问题出在其他地方所以这里是整个代码： [Pastebin](http://pastebin.com/1atyKW7T)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:53:26.180

您在迭代集合时正在修改集合。
2个选项：

1.  复制列表，迭代副本并更改原始列表。
2.  跟踪需要进行哪些更改，并在迭代后全部更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:04:32.243

问题是您正在`tosearch`迭代的循环体中进行修改`tosearch`。由于`tosearch`是变化的，它不能可靠地迭代。

您可能根本不需要迭代。只需使用一个`while`循环：

```
searched = set() # if you need to keep track of searched items
tosearch = [(0,0)] #use tuples so you can put them in a set
confirmed = []

while tosearch:
    point = tosearch.pop()
    searched.add(point) # if you need to keep track
    if CONDITIONS_MET:
        confirmed.append(point)
        # tosearch.append() .... 
```

# jquery - 为什么我的表单没有提交？在 jQuery 中使用事件

> ID：11510648
> 
> 赞同：-1
> 
> 时间：2012-07-16T18:50:45.317
> 
> 标签：jquery

我正在寻找为什么我的表单没有使用该代码提交：

```
$("#my_form").on('submit', function(e) {
    if (!myCondition) {
        if (anotherCondition === true) {

            e.preventDefault();
            $('#modal').modal('show');
            $("#btn_valid").on('click', function(e) {
                return true;
            });       
        }
    }
    return true;
}); 
```

（`modale`谁出现在 DOM 中）正在显示，但是如果我点击`#btn_valid`表单未提交并且模式停留在屏幕上。

如果我删除`e.preventDefault`，则该过程不会停止，这意味着模式正在显示并且在表单提交之后立即显示，而无需按下模式上的按钮。

我究竟做错了什么 ？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:15:14.237

试试这个：

```
$(function() {
    var submitForm = false;
    $('#my_form').submit(function(e) {
        if (!submitForm) {
            e.preventDefault();
            $('#modal').modal('show');
        }
    });

    $("#btn_valid").on('click', function(e) {
        submitForm = true;
        $('#my_form').submit();
    });
}); 
```

您会看到，一旦您在模式中单击按钮，它将设置`submitForm`为 true，当您输入表单提交回调处理程序时，您将通过 if 语句，最终像往常一样提交表单。

# javascript - MooTools 的表格数据无限滚动

> ID：11510651
> 
> 赞同：1
> 
> 时间：2012-07-16T18:51:10.480
> 
> 标签：javascript, html, mootools, infinite-scroll

是否有一个强大的基于 MooTools 的 JavaScript 库来实现表格数据的无限滚动？

因此，请考虑在 Excel 电子表格中显示部分数据（可能是 10000 行）——我们最初显示 500 行，然后向下滚动，然后加载接下来的 500 行。此外，如果 dom 太大，我们可能需要删除“第一”行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T17:28:36.917

You don't need a library for this sort of data manipulation/render.

If your data is contained in a javascript Array:

```
var dataArray = [
    [1, 5, 7, 9],
    [3, 6, 2, 86],
    [77, 3, 5, 14],
    ...
]; 
```

You only need to iterate through the array and render the rows as necessary.

```
function renderRows(startIndex, endIndex) {
    dataArray.slice(startIndex, endIndex);
    var numRows = dataArray.length;
    for(x=0;x<numRows;x++) {
        renderRow(dataArray[x]);
    }
}

function renderRow(data) {
    new Element('tr', {
        // ...
    }).inject(table);
} 
```

Likewise, if you need to prune the table:

```
function pruneTable(number) {
    // assuming "table" is defined elsewhere and points to the <table> element
    var rows = table.getElements('tr');
    for(x=0;x<number;x++) rows[x].destroy();
} 
```

This same set of functions can be easily modified to make ajax calls to "get" a set of *n* rows, and render them as they come in, etc etc.

Mootools isn't the end, it's simple a means to an end!

**Caveat**: This is all untested. I take no responsibility for any syntax errors!

# mysql - INT 上的 MySQL 和正则表达式

> ID：11510654
> 
> 赞同：0
> 
> 时间：2012-07-16T18:51:14.793
> 
> 标签：mysql, regex

此查询应返回 4 行，但返回 ID 为 62983 的 1。有什么原因吗？

```
SELECT *
    FROM sims_user_role_maps surm
    JOIN sims_role sr ON surm.role_id = sr.id
    WHERE 
        surm.user_id = 118730
        AND sr.organization_id REGEXP 62978|62981|62982|62983 
```

**SP 呼叫**

```
call schools_remove_for_user('f155ec0e-b9ce-11e1-a1fa-001cc4565d26', '62966|62969|62983') 
```

**SP**

```
CREATE PROCEDURE `schools_remove_for_user`(
    user_id NVARCHAR(255),
    school_ids LONGTEXT
)
BEGIN

DECLARE sims_user_id INT DEFAULT NULL;

SELECT u.sims_id 
INTO sims_user_id 
FROM user u 
WHERE u.id = user_id;

SET SQL_SAFE_UPDATES = 0;

DELETE FROM sims_user_role_maps
WHERE 
        user_id = sims_user_id
    AND role_id IN (
                SELECT role_id 
                FROM(
                    SELECT surm.role_id 
                    FROM sims_user_role_maps surm
                    JOIN sims_role sr ON surm.role_id = sr.id
                    WHERE 
                            surm.user_id = sims_user_id
                        AND sr.organization_id REGEXP school_ids) 
                A);

END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:54:33.863

您没有将正则表达式放在引号内，因此`|`按 [位 OR](http://dev.mysql.com/doc/refman/5.0/en/bit-functions.html#operator_bitwise-or)工作。

正确的语法是`AND sr.organization_id REGEXP '62978|62981|62982|62983'`. `sr.organization_id IN (x, y, z)`如果您只是想匹配特定的整数，您还可以考虑哪个更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:01:03.313

原因是删除语句中的 user_id。我添加了表名作为前缀。

```
DELETE FROM sims_user_role_maps
WHERE 
        sims_user_role_maps.user_id = sims_user_id
    AND sims_user_role_maps.role_id IN ( 
```

# git - 如何在没有 git 访问权限的情况下在远程网站上同步 git 分支？

> ID：11510657
> 
> 赞同：0
> 
> 时间：2012-07-16T18:51:19.303
> 
> 标签：git, ssh

我有一个需要在实时服务器上*拉取（git pull）的**实时*分支，但实时服务器无法访问 bitbucket。

 *虽然我使用登录/密码在远程服务器上具有 ssh 访问权限（不能使用 ssh-key），但同步远程服务器上指定分支的最佳方法是什么（更新和删除更改的文件）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:55:47.790

用于`scp`将文件从可以访问 bitbucket 的机器复制到服务器，而不是使用 git。从位桶中提取 cron 作业。使用 post receive 挂钩启动 scp 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:13:48.147

我使用 rsync 解决了这个问题。

使用 rsync 我可以检查女巫文件是否已修改并且在远程服务器上有所不同。

我还创建了一个名为*build.exclude.sync*女巫的文件，其中包含我想跳过的每个目录，并且在终端我可以使用：

```
rsync -avz --exclude-from=build.exclude.sync /home/path/to/local/dir/ -e ssh myuser@myremotehost.com:/path/to/remote/dir/ 
```

我使用 rsync 和[Apache Ant](http://ant.apache.org)来自动化构建过程。在我的 build.xml 文件中：

```
<exec executable="rsync" dir="." failonerror="true">
         <arg line="-avz --exclude-from=build.exclude.sync ${prod.local.deploydir} -e ssh  ${prod.sshusername}@${prod.sshhost}:${prod.homedir}"/>
</exec> 
```*

# ruby-on-rails - 如何更改 RoR 配置文件中的文本？

> ID：11510658
> 
> 赞同：0
> 
> 时间：2012-07-16T18:51:20.100
> 
> 标签：ruby-on-rails, unix, sed

我在 RoR 项目的 config/application.rb 文件中有以下几行：

```
 [other lines that i omitted here]
 config.app_type= :rewards # :classic / :rewards
 config.app_prefix= '' # '$ ' for :classic  / '' for :rewards
 config.app_suffix= ' pts' # ' MXN', ' USD' for :classic / ' pts' for :rewards 
```

我想用 sed 的脚本将文本更改为：

```
 [other lines that i omitted here]
 config.app_type= :classic # :classic / :rewards
 config.app_prefix= '$ ' # '$ ' for :classic  / '' for :rewards
 config.app_suffix= ' USD' # ' MXN', ' USD' for :classic / ' pts' for :rewards 
```

我怎么能用 sed 做到这一点？，我仍然没有用正则表达式和 sed 得到它......：S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:02:01.330

这应该有效。为命令使用文件`sed`可以避免转义引号的混乱。

内容`script.sed`：

```
s/^\( *config\.app_type= *:\)rewards/\1classic/
s/^\( *config\.app_prefix= *\)''/\1'$ '/
s/^\( *config\.app_suffix= *\)' pts'/\1' USD'/ 
```

像这样运行它：

```
sed -f script.sed infile 
```

具有以下输出：

```
[other lines that i omitted here]
config.app_type= :classic # :classic / :rewards
config.app_prefix= '' # '$ ' for :classic  / '' for :rewards
config.app_suffix= ' pts' # ' MXN', ' USD' for :classic / ' pts' for :rewards 
```

# jquery - 更改 iFrame 中 FancyBox2 上一个和下一个叠加层的大小？

> ID：11510659
> 
> 赞同：0
> 
> 时间：2012-07-16T18:51:25.650
> 
> 标签：jquery, fancybox, fancybox-2

我有一个很好的 FancyBox2 实现，它在 iFrame 中加载 html 页面作为画廊。

但是，我在 iframe 中加载的内容包括指向外部网站的链接，如果我使用允许用户滑动浏览所有图库项目的正常上一个和下一个导航，这些链接将被“阻止”。

如何更改上一个/下一个链接覆盖的大小，以便它们包含在左右边距中，以便我可以向用户公开内容链接？

或者

如果有一种方法可以相对于 FancyBox 的顶部而不是相对于页面的顶部定位按钮导航栏，则另一种方法是。在这种情况下，我会禁用内部的 prev/next 链接和箭头。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:33:18.360

**编辑**：如果您想更改上一个/下一个叠加层的大小，请在加载 fancybox CSS 文件**后添加此 CSS 内联声明：**

```
<style type="text/css">
.fancybox-nav {
  top: 50%;
  height: 34px;
  width: 36px;
 }
.fancybox-nav span {
  visibility: visible;
 }
.fancybox-next span {
  left: auto;
  right: 0px;
 }
.fancybox-prev span {
  left: 0px;
 }
</style> 
```

请注意，您必须使箭头永久可见，否则访问者将不知道悬停在哪里。

**注意**：这是为 fancybox v2.0.6+

另一方面，您不能将按钮导航栏设置为相对于 FancyBox 的顶部，因为它具有 a`position:fixed`并且它已附加到`body`标记。

但是，您可以尝试编辑 fancybox-buttons js 文件（第 69 行+/-）并将其附加到`.fancybox-skin`选择器，然后`#fancybox-buttons`使用 css 使用选择器的位置。

# java - Java Applet 可以最小化它的浏览器窗口吗？

> ID：11510661
> 
> 赞同：1
> 
> 时间：2012-07-16T18:51:36.247
> 
> 标签：java, applet

我的小程序会在浏览器窗口中弹出，然后创建一个单独的 JFrame。我想最小化原始托管浏览器窗口。我可以从小程序做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:58:48.530

您不能从 Applet 或使用 Javascript 最小化浏览器窗口。您可以尝试使用 Javascript 窗口`blur`，`focus`看看是否可以让它们为您工作。应该可以与 JS 进行通信，如下所示

```
import netscape.javascript.*;
import java.applet.*;
import java.awt.*;
class MyApplet extends Applet {
  public void init() {
    JSObject win = JSObject.getWindow(this);
    JSObject doc = (JSObject) win.getMember("document");
    JSObject loc = (JSObject) doc.getMember("location");

    String s = (String) loc.getMember("href");  // document.location.href
    win.call("f", null);                 // Call f() in HTML page
  }
} 
```

未经测试且取自[Oracle 文档的代码](http://java.sun.com/products/plugin/1.3/docs/jsobject.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:53:59.100

不，你不能这样做。您的小程序无法控制调用窗口，因此无法最小化（或以其他方式操作）该窗口。

# php - PHP - 计算两个日期之间的差异

> ID：11510668
> 
> 赞同：1
> 
> 时间：2012-07-16T18:51:58.543
> 
> 标签：php, sql

我想计算两个日期之间的年数。其中一个是从数据库中检索的，而另一个是从用户输入的日期格式中获取的。

我使用此代码从用户那里获取日期：

```
$today   = $_POST['to-day'];
$tomonth = $_POST['to-month'];
$toyaer  = $_POST['to-year'];
$dateto  = date("$toyaer-$tomonth-$today"); 
```

这是我用从数据库中检索到的计算它的方法，

```
$start      = $leaveresult['date']; // i took from database 
$end        = strtotime($dateto);   
$difference = abs($end - $start);
$years      = floor($difference / (60*60*24*365)); 
```

问题是我得到的结果总是`0`.

我尝试了不同的方法，但所有方法都产生了结果，`0`其中一种产生了巨大的数字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:01:40.873

这是未经测试的，但我认为这样的事情会起作用：

```
$today = $_POST['to-day'];
$tomonth = $_POST['to-month'];
$toyear = $_POST['to-year'];
$dateto = "$toyear-$tomonth-$today";

$start = $leaveresult['date'];// i took from database 
$end = strtotime($dateto);   
$difference = abs($end - $start);
$years = floor($difference / (60*60*24*365)); 
```

我假设`$leaveresult['date']`是unix时间戳

另请注意，我修复了 post 变量名称。

如果开始日期不在 unix 时间戳中，则使用

```
$start = strtotime($leaveresult['date']);// i took from database 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:32:04.180

[DateTime类通过为您提供](http://us2.php.net/manual/en/class.datetime.php)[diff](http://us2.php.net/manual/en/datetime.diff.php)方法来简化这一切。这将返回一个[DateInterval](http://us2.php.net/manual/en/class.dateinterval.php)对象，您可以获得您正在寻找的值。

假设`$_POST`看起来像这样：

```
$_POST = array(
    'to-year' => 2010,
    'to-month' => 8,
    'to-day' => 22
); 
```

`$leaveresult['date']`看起来像这样：

```
$leaveresult = array(
    'date' => date('Y-m-d H:i:s', strtotime('-5 years'))); 
```

你可以做这样的事情......

```
$input_date = new DateTime(sprintf("%d-%d-%d", $_POST['to-year'], $_POST['to-month'], $_POST['to-day']));
$database_date = new DateTime($leaveresult['date']);

$diff = $database_date->diff($input_date);

echo $diff->format('%r%y years') . PHP_EOL;
echo $diff->format('%r%m months') . PHP_EOL;
echo $diff->format('%r%d days') . PHP_EOL;

$years = $diff->y; 
```

哪个会产生

```
3 years
1 months
5 days 
```

并且`$years`将等于`3`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:25:39.800

在这两种情况下，您都需要一个时间戳-您格式化的一个（作为日期对象）和一个从数据库中获取的...所以我认为您的方法没有错，如果您在两种情况下都获得时间戳...但最后你尝试用 floor 取整数字……当然，如果不到一年，这将导致 0。在不先四舍五入的情况下对其进行测试，并测试您的时间戳，也许那里也有问题？

# android - 从 Android ListView 启动一个 Activity 并根据选择进行填充

> ID：11510672
> 
> 赞同：0
> 
> 时间：2012-07-16T18:52:03.217
> 
> 标签：android, listview, android-activity, click

我目前有一个 Android ListView 类，它显示了大约 20 个主题（字符串）的列表。我需要能够单击列表上的每个按钮并让该按钮打开特定于该主题的视图。

例如，如果这是一个菜谱列表，那么所有菜谱视图的布局可能是相同的，但是当用户从列表中单击特定菜谱时，程序必须将该菜谱加载到通用布局中并将用户查看该视图。

我认为我有 OnItemClickListener 工作，但我不确定如何实现其余部分。

每个食谱我都需要一个新的活动和布局吗？有没有更简单的方法来实现这一点，而无需制作数十个相同的布局和活动文件？

另外，我将如何使用配方填充视图？

非常感谢任何有用的想法！

--- 一些相关代码：Listview 活动代码

```
listAdapter = new ArrayAdapter<String>(this, R.layout.simplerow, studiesList);  

    // Set the ArrayAdapter as the ListView's adapter.  
    mainListView.setAdapter( listAdapter );    
    mainListView.setClickable(true);
    mainListView.setOnItemClickListener(new OnItemClickListener(){

        public void onItemClick(AdapterView<?> a, View view, int position, long id) { 

            switch( position )
            {
               case 0:  Intent intent = new Intent(StudyActivity.this, pos.class); 
                        startActivity(intent);
                        break; 
```

SimpleRow.xml 文件：（列表的按钮）

```
<?xml version="1.0" encoding="utf-8"?>
<Button xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >
</Button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:01:02.847

我想你会想要做的是在一个新的活动中打开食谱，它可以有一个标准的“食谱”视图。

要将数据传递给新 Activity，您可以向将启动新 Activity 的 Intent 添加额外内容（请参阅[Intent 和 Intent Filters-](http://developer.android.com/guide/components/intents-filters.html#extras) API 文档中的 Extras）。您可以传递一个 int 或一个 String 来标识您想要的配方。

在 Intent 中传递 extra 的基本大纲是：

```
Intent intent = new Intent(this, NextActivity.class);
intent.putExtra("EXTRA_ID", data);
startActivity(intent); 
```

然后，在新的 Activity 中，您可以获得这些值：

```
Bundle extras = getIntent().getExtras();
if(extras.hasExtra("EXTRA_ID")) {
    int value = extras.getString("EXTRA_ID");
} 
```

使用该值从您获取数据的任何来源加载配方，您应该一切就绪！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:11:58.613

您需要做的是创建一个具有一些属性的可序列化配方类，然后为 20 个配方中的每一个创建该类的新对象。

我想你会有类似的东西

```
public class Recipe extends Serializable{ 
private String name; 
private String ingredients; 

public Recipe(String name, String ingredients){
this.name = name;
this.ingredients = ingredients;
} 
```

}

然后制作这些对象的数组列表

```
ArrayList<Recipe> recipes = new ArrayList<Recipe>();
recipes.add(new Recipe("Chicken Curry", "Random cooking instructions")); 
```

并在您的列表适配器中使用该数组列表。

然后在您的 onItemClickListener 中，您需要类似

```
Intent i = new Intent(this, recipeDisplay.class)
i.putExtra("recipe",  listAdapter.getItemAtPosition(position)); 
```

并在您的食谱显示类中接收意图并使用该对象来填充您的活动字段。

```
Intent intent = getIntent():
intent.getSerializableExtra("recipe"); 
```

# java - 这段代码有什么问题？(java) ( 错误：找不到符号方法 getValue() )

> ID：11510673
> 
> 赞同：0
> 
> 时间：2012-07-16T18:52:08.903
> 
> 标签：java, jsoup

周围有**的地方抛出*cannot find symbol method getValue()*错误。

顺便说一句，代码是检查 minecraft 帐户名称有效性的程序的一部分；它们是否可用。

```
 public String connectToMigrate() {
  try {
  Connection.Response response = 
    Jsoup.connect("https://account.mojang.com/migrate").execute();
  Document doc = response.parse();
  Element authToken = doc.select("input[name^=authenticityToken]").get(0);
  Map cookies = response.cookies();
  Connection connection = 
    Jsoup.connect("https://account.mojang.com/migrate/check")
    .data("authenticityToken", authToken.val())
    .data("mcusername", this.username)
    .data("password", this.password)
    .method(Connection.Method.POST)
    .followRedirects(true);
  connection.timeout(10000);
  for (Object cookie : cookies.entrySet()) {
      connection.cookie((String) **cookie.getValue**(), (String)  **cookie.getKey**());
  }
  Connection.Response postResponse = connection.execute();
  if (postResponse.body().toLowerCase().contains("invalid username"))
    return "error";
  if (postResponse.body().toLowerCase().contains("already been migrated"))
    return "error";
  if (postResponse.body().toLowerCase().contains("locked out"))
    return "error";
  if (postResponse.body().toLowerCase().contains("bought minecraft"))
    return "error";
  if (postResponse.body().toLowerCase().contains("too many failed attempts")) {
    getNewProxy();
    return "try again";
  }
  if (postResponse.body().toLowerCase().contains("error")) {
    return "try again";
  }

  Map cookies2 = postResponse.cookies();
  Connection connection2 = 
    Jsoup.connect("https://account.mojang.com/migrate/chooseEmail");
  for (Object cookie : cookies2.entrySet()) {
      connection2.cookie((String) **cookie.getValue()**, (String) **cookie.getKey()**);
  }
  connection2.timeout(10000);
  Connection.Response postResponse2 = connection2.execute();
  String s = postResponse2.body().toLowerCase();
  s = s.split("i want to use <strong>")[1];
  s = s.split("</strong>")[0];
  String email = s;
  return email; } catch (Exception e) {
}return "try again";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:53:24.707

`cookie`是一个不包含`getValue()`方法的对象。您需要在调用之前将其转换为正确的类型`getValue()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:08:35.217

我认为您只是误解了如何在 java 中使用地图。这应该很容易，试试这个：

```
Map<String,String> cookies = response.cookies();
[...]
for ( Map.Entry<String,String> e : cookies.entrySet()){
    connection.cookie( e.getKey(), e.getValue() );
} 
```

但是，您可以通过执行以下操作一次复制所有 cookie：

```
connection.cookies( response.cookies() ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:02:37.030

`getCookies`在 JSoup`Connection.Response`对象上返回一个`Map<String, String>`.

所以在你的第一个`for`循环中：

```
for (Object cookie : cookies.entrySet()) 
```

each`cookie`是 a `Set`，并且`Set`不支持这些方法（请参阅[文档](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#entrySet%28%29)）。

相反，在这些循环中，您应该遍历`Map`键，这将是 cookie 名称：

```
for (Object cookie : cookies.keySet()) 
```

现在 each`cookie` **是**键，您可以使用 查询原始地图的值`cookies.get(cookie)`。

但是 Jsoup`Connection`已经允许您直接复制 cookie（请参阅[文档](http://jsoup.org/apidocs/org/jsoup/Connection.html#cookies%28java.util.Map%29)），无需循环：

```
connection.cookies(response.cookies()); 
```

# spring-mvc - Spring MVC - Bean 名称的 BindingResult 和普通目标对象都不能用作请求属性

> ID：11510676
> 
> 赞同：0
> 
> 时间：2012-07-16T18:52:18.850
> 
> 标签：spring-mvc

我是 Spring 3.1 MVC 的新手，我需要一些帮助。我一定错过了什么，但我不知道是什么。是的，我已经在 Google 上搜索过教程。我只是第一次尝试调用 JSP，我明白了。

```
SEVERE: Servlet.service() for servlet jsp threw exception
java.lang.IllegalStateException: Neither BindingResult nor plain target object for bean name 'comment' available as request attribute
    at org.springframework.web.servlet.support.BindStatus.<init>(BindStatus.java:141)
    at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:174)
    at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:194)
    at org.springframework.web.servlet.tags.form.LabelTag.autogenerateFor(LabelTag.java:129)
    at org.springframework.web.servlet.tags.form.LabelTag.resolveFor(LabelTag.java:119)
    at org.springframework.web.servlet.tags.form.LabelTag.writeTagContent(LabelTag.java:89)
    at org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:102)
    at org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:79)
    at org.apache.jsp.GuestBook_jsp._jspx_meth_form_005flabel_005f0(GuestBook_jsp.java:271)
    at org.apache.jsp.GuestBook_jsp._jspx_meth_form_005fform_005f0(GuestBook_jsp.java:216)
    at org.apache.jsp.GuestBook_jsp._jspService(GuestBook_jsp.java:127)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:393)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:320)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:266)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:263)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:584)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
    at java.lang.Thread.run(Unknown Source) 
```

这是我的 JSP 中的表单。

```
<form:form method="post" action="GuestBook.jsp" modelAttribute="comment">
    <table>
        <tr>
            <td><form:label path="comment.name">Name</form:label></td>
            <td><form:input path="comment.name" /></td>
        </tr>
        <tr>
            <td><form:label path="comment.message">Message</form:label></td>
            <td><form:textarea path="comment.message" rows="10" cols="50" /></td>
        </tr>
        <tr>
            <td><input type="submit" value="Submit comment" /></td>
            <td>&nbsp;</td>
        </tr>
    </table>
</form:form> 
```

这是我的控制器。

```
package com.controller;

import org.springframework.stereotype.Controller;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.SessionAttributes;
import org.springframework.web.servlet.ModelAndView;

import com.dao.CommentDAO;
import com.model.Comment;

@Controller
@RequestMapping("/GuestBook.jsp")
@SessionAttributes("comment")
public class CommentController {
    Comment comment;

    public Comment getComment() {
        return comment;
    }

    public void setComment(Comment comment) {
        this.comment = comment;
    }

    @RequestMapping(value = "/addComment", method = RequestMethod.POST)
    public String addComment(@ModelAttribute("comment") Comment comment, BindingResult result) {
        CommentDAO commentDAO = new CommentDAO();
        java.util.Date today = new java.util.Date();
        java.sql.Date date = new java.sql.Date(today.getTime());
        comment.setDate(date);

        if (commentDAO.writeComment(comment) == true) {
            return "redirect:GuestBook.jsp";
        }

        return "redirect:Oops.jsp";
    }

    @RequestMapping("/showComments")
    public ModelAndView showComments() {
        return new ModelAndView("comment", "command", new Comment());
    }
} 
```

这是 ghs1986-servlet.xml。

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

    <bean id="viewResolver"
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="suffix">
            <value>.jsp</value>
        </property>
    </bean>
    <bean name="comment" class="com.model.Comment" />

    <bean name="/GuestBook.jsp" class="com.controller.CommentController">
        <property name="comment" ref="comment" />
    </bean>
</beans> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-16T19:02:00.840

您必须将 bean 添加到负责将数据输入表单的控制器方法中的模型中。

只需将模型添加为方法参数，然后在正文中，将空注释 bean 添加到模型

# jquery - 使用 jquery 从 js 函数中获取父元素文本

> ID：11510684
> 
> 赞同：0
> 
> 时间：2012-07-16T18:52:35.353
> 
> 标签：jquery

我想找出一种方法来检索用户从我的 webapp 中单击的链接文本...我想知道 jquery 是否可以做到。

下面是链接的样子：

```
<span onclick="myfunction();">Link Text 1</span> 
```

函数“myfunction()”位于页面中包含的 .js 文件中

当用户单击 span 标签时，我想从调用 myfunction() 的 span 标签中捕获文本，然后将文本“Link Text 1”放入一个 js 变量中，然后我将使用它来更新我的数据库。

我知道我可以这样做：

```
<span onclick="var xx = $(this).text(); myfunction(xx);">Link Text 1</span> 
```

但是我对这个函数的调用太多了，重写点击事件太多了......我想知道如何从“myfunction（）”代码中使用jquery检索文本来完成同样的事情？

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:55:05.820

[试试这个：](http://jsfiddle.net/u5Zz2/)

```
<span>Link Text 1</span> 
```

```
$('span').click(function(e){
   var txt = $(this).text() // gets span's text
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:02:03.140

在 html 中：

```
<span onclick="myfunction(this)">Link Text 1</span> 
```

Javascript函数：

```
function myfunction(elem){
    var theText =$(elem).text();
} 
```

# java - 如何在 java swing 应用程序中显示验证码

> ID：11510688
> 
> 赞同：5
> 
> 时间：2012-07-16T18:53:01.493
> 
> 标签：java, swing, captcha

我需要在 java swing 应用程序中添加验证码。我一直在搜索一些库（JCaptcha 和 SimpleCatcha），但它们是用于 Web 开发的。

是否有任何图书馆可以在摇摆时使用验证码？如果不是，是否有带有一些验证码字符的网页或存储库来实现我自己的验证码？

我非常感谢您的时间和您的帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:34:43.687

JCaptcha 可以返回一个 BufferedImage。从那里使用 JLabel 使图像可见并不难：

```
BufferedImage captcha = // Get the captcha
// See also com.octo.captcha.service.image.AbstractManageableImageCaptchaService.getImageChallengeForID(String)
JLabel label = new JLabel(new ImageIcon(captcha));
// ... add that label to a visible container of your Swing application 
```

在 1.0 版中，您可以使用：http: [//jcaptcha.sourceforge.net/apidocs/1.0/com/octo/captcha/service/image/AbstractManageableImageCaptchaService.html](http://jcaptcha.sourceforge.net/apidocs/1.0/com/octo/captcha/service/image/AbstractManageableImageCaptchaService.html)

在 2.0-alpha1 中，有这个：http: [//jcaptcha.sourceforge.net/apidocs/2.0-alpha1/com/octo/captcha/service/image/AbstractManageableImageCaptchaService.html#getImageChallengeForID(java.lang.String)](http://jcaptcha.sourceforge.net/apidocs/2.0-alpha1/com/octo/captcha/service/image/AbstractManageableImageCaptchaService.html#getImageChallengeForID%28java.lang.String%29)

您还可以使用额外的`Locale`参数检查这些方法的重载版本。

在每种情况下，都有一个默认的实现类`DefaultManageableImageCaptchaService`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-02T06:28:51.650

```
BufferedImage captcha = // Get the captcha

// See also 
com.octo.captcha.service.image.AbstractManageableImageCaptchaService.getImageChallengeForID(String)

JLabel label = new JLabel(new ImageIcon(captcha));
// ... add that label to a visible container of your Swing application 
```

# jquery - 在彩盒模式中显示部分视图？

> ID：11510701
> 
> 赞同：0
> 
> 时间：2012-07-16T18:53:52.333
> 
> 标签：jquery, colorbox

我有一个 ajax 调用，它返回一个我想转储到颜色框模式的部分视图。我尝试了各种不同的方式，但它只是以“无法显示内容”之类的方式打开。我检查了返回的数据，它肯定是部分视图，所以我不知道为什么它无法显示它。我还尝试了 jQuery 插件 simple modal，我可以通过 $.modal(data) 轻松使用它来显示相同​​的局部视图。当我尝试以下不同方式时，我收到错误消息。

```
$.ajax({
  url: 'Controller/ControllerAction',
  success: function(data) {
  $(data).colorbox();

  }
});

 $.ajax({
  url: 'Controller/ControllerAction',
  success: function(data) {
  $.colorbox(data);

  }
});

 $.ajax({
  url: 'Controller/ControllerAction',
  success: function(data) {
  $.colorbox({html: data });

  }
}); 
```

任何想法都会受到极大的欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:58:31.863

尝试以下操作：

```
$.colorbox({
    href: 'Controller/ControllerAction'
}); 
```

# c# - 无法从 GetCustomAttributes 取回属性

> ID：11510703
> 
> 赞同：2
> 
> 时间：2012-07-16T18:53:56.540
> 
> 标签：c#, visual-studio-2010, reflection

在我的解决方案中的 MiddleTier 项目中，我有 Customer 类，其中一个用 Attribute1 定义

```
public class Customer2
{
    public string Name2 { get; set; }

    public int Age2 { get; set; }
}

[MyAttribute1]
public class Customer1
{
    [MyAttribute1(DefaultValue = "Must Enter Name")]
    public string Name { get; set; }

    [MyAttribute1(DefaultValue = "Must Enter Age")]
    public int Age { get; set; }
}

[AttributeUsage(AttributeTargets.All)]
public class MyAttribute1 : Attribute
{
    public string DefaultValue { get; set; }

} 
```

在一个单独的项目中，我引用了 MiddleTier DLL，我想枚举此 DLL 中的所有类并识别与 Attribute1 关联的 Customer1 类。

```
 Assembly assembly =  Assembly.LoadFrom(@"C:\myfolder\MiddleTier\bin\Debug\MiddleTier.dll");

            foreach (Type type in assembly.GetTypes())
            {

                var attribs = type.GetCustomAttributes(typeof(MyAttribute1), false); <--- problem
                if (attribs != null && attribs.Length > 0)
                {
....
                }
            } 
```

GetCustomAttributes调用**没有返回任何属性。**我究竟做错了什么？请帮忙。谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T20:30:49.157

问题是您实际上是从两个不同的位置加载程序集两次。这会导致程序集被加载到两个不同的上下文中，进而导致您的类型不兼容。当您尝试运行此代码时，您可以轻松验证这一点（当然，您需要更改程序集的路径）：

```
foreach (Type type in Assembly.LoadFrom(@"C:\ClassLibrary1.dll").GetTypes())
{
     MyAttribute1 attribute = type.GetCustomAttributes(false)
                                  .Cast<MyAttribute1>()
                                  .SingleOrDefault();
    if (attribute != null)
    {
       Console.WriteLine(type.Name);
    }

} 
```

这将导致引发以下异常：

> [A]ClassLibrary1.MyAttribute1 不能转换为 [B]ClassLibrary1.MyAttribute1。类型 A 源自 'ClassLibrary1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 在位置 'C:\ClassLibrary1.dll' 的上下文 'LoadFrom' 中。类型 B 源自 'ClassLibrary1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 在位置 'C:\Users\Nikola\Documents\Visual Studio 2010\Projects\ConsoleApplication12\ConsoleApplication12\bin 的上下文 'Default' 中\Debug\ClassLibrary1.dll'。

**那么，如何解决呢？**

您只需使用`Assembly.Load("ClassLibrary1")`. 这将确保您在单一上下文中工作，并且您的原始代码可以正常工作。

查看[这篇博](http://geekswithblogs.net/rupreet/archive/2010/02/16/137988.aspx)文，它处理了您遇到的完全相同的问题。[阅读有关加载上下文](http://msdn.microsoft.com/en-us/library/dd153782.aspx)的内容也可能会有所帮助。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-16T18:55:20.843

`var attribs = (MyAttribute1)type.GetCustomAttributes(typeof(MyAttribute1), false)[someIndex];`

# nsis - 从 NSIS 执行命令行命令

> ID：11510710
> 
> 赞同：18
> 
> 时间：2012-07-16T18:54:45.123
> 
> 标签：nsis

我正在创建我的第一个 NSI 脚本，我只是想知道是否可以从 NSIS 执行命令行命令，还是应该只执行批处理文件？我真的不知道从哪里开始，其他类似的话题也让我有点不知所措。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-18T14:15:04.483

我建议看一下 nsExec 插件。我最近遇到了一种情况，我需要从 NSIS 脚本中 ping 一个服务器，下面的代码对我来说非常有效。

```
nsExec::Exec '"C:\Windows\System32\PING.EXE" $URL' 
```

使用 nsExec 的好处是它执行命令时不会在屏幕上弹出 dos 框。返回值被压入堆栈，您也可以通过几种不同的方式访问程序的输出（如果存在）。

我可以在 NSIS 网站上找到关于该插件的大量信息，但以下链接应该可以让您朝着正确的方向开始：

[http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt](http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt)

编辑：

我注意到您专门询问了 COPY 命令，它是一个内部 DOS 命令，这意味着您将无法像我使用 ping 一样执行它。我可能弄错了，但您不需要使用任何外部程序来执行这样的基本命令。您应该能够使用 NSIS 命令复制大部分内部命令。

例如要复制一个文件（或多个文件），请使用 NSIS 命令：CopyFiles

[NSIS 脚本参考](http://nsis.sourceforge.net/Docs/Chapter4.html)是你的朋友 :)（ctrl+f 也是如此）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-16T21:47:27.170

尝试使用`exec`命令[http://nsis.sourceforge.net/Docs/Chapter4.html](http://nsis.sourceforge.net/Docs/Chapter4.html)：

**4.9.1.2 执行**

*命令*

执行指定的程序并立即继续。请注意，指定的文件必须存在于目标系统上，而不是编译系统上。`$OUTDIR`用于工作目录。如果无法启动进程，则会设置错误标志。请注意，如果命令可以包含空格，则应将其放在引号中以将其与参数分隔。例如：`Exec '"$INSTDIR\command.exe" parameters'`。如果你不把它放在引号中，它在有或没有参数的 Windows 9x 上都不起作用。

```
Exec '"$INSTDIR\someprogram.exe"'
Exec '"$INSTDIR\someprogram.exe" some parameters' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-07-13T12:50:17.823

我们可以从 NSIS 启动命令行命令，获取返回值，并在此基础上进一步开发安装逻辑。

示例：假设我们需要获取已安装的 clang 编译器版本。要获得我们必须启动的版本：

```
clang --version 
```

在 NSIS 中，我们使用[ExecToStack](https://nsis.sourceforge.io/NsExec_plug-in)执行此操作：

```
 nsExec::ExecToStack  'cmd /c "clang --version"'
     Pop $0
     Pop $0
     ;now we have the version in $0 
```

*警告*：只有第二个 Pop $0 得到我们想要的响应，在这种情况下是 clang 版本。第一个 Pop $0 获取退出代码。

# java - 用空格解析字符串到日期，导致 ParseException

> ID：11510713
> 
> 赞同：0
> 
> 时间：2012-07-16T18:54:48.817
> 
> 标签：java, android, date, simpledateformat

我有这种形式的日期字符串`Thu Aug 02 00:00:00 GMT+00:00 2012`

我尝试使用此方法在 Date 对象中解析这些字符串

```
public Date fromStringToDate(String data) {
        Date result;
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy MM dd HH:mm:ss");
        try {
            result = sdf.parse(data);
            return result;
        } catch (ParseException e) {
            e.printStackTrace();
            return null;
        }
    } 
```

但不起作用，我收到此错误

```
java.text.ParseException: Unparseable date: "Thu Aug 02 00:00:00 GMT+00:00 2012" 
```

我想问题是由错误引起的`SimpleDateFormat`，但我不知道修复它的正确语法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:12:18.840

您需要将日期格式调整为给定的字符串：

```
EEE MMM dd HH:mm:ss Z yyyy 
```

确保使用正确的占位符、区分大小写等。查看[Date and Time Patterns](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)。

抱歉，我对“z”模式有误，“Z”是：

```
SimpleDateFormat sdf = new SimpleDateFormat("EEE MMM dd HH:mm:ss Z yyyy", Locale.US); 
```

看一下`Locale.US`，申请很重要，因为月份和日期都是英文的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:19:39.003

使用此日期格式：

```
SimpleDateFormat sdf = new SimpleDateFormat("EEE MMM dd HH:mm:ss z yyyy") 
```

# ruby-on-rails - 无法在 Rails_Admin 中找出关联

> ID：11510715
> 
> 赞同：4
> 
> 时间：2012-07-16T18:54:57.593
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, rails-admin

我有两个这样的模型：

```
class Kid < ActiveRecord::Base
  belongs_to :sex
  attr_accessible :name
end

class Sex < ActiveRecord::Base
  attr_accessible :description
  has_many :kids
end 
```

但是对于我的生活，我无法弄清楚如何让关联出现在管理员中。当我去编辑一个孩子时，我看到一个性别标签，但没有下拉菜单，也没有任何提示 RailsAdmin 看到该关联。它只在下面显示标签名称、空格和“可选”一词。

我一遍又一遍地搜索dox，但我找不到解决方案。我是菜鸟，所以有可能我看过它，应该受到嘲笑。

我没有修改任何其他管理代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T22:28:03.987

该关系在 Kid 中应该是可访问的，尝试将 sex_id 添加到可访问的属性中。

```
`class Kid < ActiveRecord::Base
  belongs_to :sex
  attr_accessible :name, :sex_id
end` 
```

 `* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T21:35:36.430

感谢 Gaël Marziou，我想出了如何与中间*模型*（与 has_many :through... 关联使用的模型）“连接”，如下所示：

```
class CategoryPets < ActiveRecord::Base
  belongs_to :category
  belongs_to :pet

  attr_accessible :category_id, :pet_id
end 
````

# c++ - 如何使用 QUdpSocket 连接路由器后面的服务器和客户端？

> ID：11510716
> 
> 赞同：1
> 
> 时间：2012-07-16T18:54:59.363
> 
> 标签：c++, qt, networking, router, qudpsocket

假设我有一个直接连接到互联网的服务器和一个连接到路由器的客户端。客户端可以向服务器发送消息，因为它知道服务器的 IP 地址和端口。但是服务器如何将消息发送回客户端呢？它可以获取客户端的外部 IP 地址和端口，但它应该向该端口发送消息吗？客户端如何监听消息，它应该监听哪个端口？假设没有端口转发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:12:27.240

我认为困难在于您的客户端位于[NAT](http://en.wikipedia.org/wiki/Network_address_translation)防火墙后面。如果是这样，那么答案很简单：你没有。这就是 NAT 的全部意义所在。

但这也假设您正在谈论从服务器到客户端的新套接字的创建。如果套接字已经存在，您只需对其进行交谈，状态 NAT 路由器就会跟踪它需要做的事情才能让消息通过。

如果这些都不能回答你的问题，你需要重新制定它。

# perl - 对增量的误解

> ID：11510719
> 
> 赞同：2
> 
> 时间：2012-07-16T18:55:12.100
> 
> 标签：perl

在 Perl 中，我有以下代码：

```
my $val = "0";

for(my $z = 0; $z <= 14; $z++)
{
    ++$val;
    if($val == 9) {
        $val = "A";
    }
    print $val;
} 
```

它打印：

```
1 2 3 4 5 6 7 8 A B 1 2 3 4 5 
```

但它应该从B继续到C，从C到D等等，这背后的逻辑是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:59:36.127

[警告](http://perldoc.perl.org/warnings.html)会给你一个警告信息，比如：

> 参数“B”在数字 eq (==) 中不是数字

```
use warnings;
use strict;

my $val = "0";

for(my $z = 0; $z <= 14; $z++)
{
    ++$val;
    if($val eq '9') {   #   <------------------
        $val = "A";
    }
    print $val;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T19:00:27.083

引用[perlop](http://perldoc.perl.org/perlop.html#Auto-increment-and-Auto-decrement)：

> 如果你增加一个数字变量，**或者曾经在数字上下文中使用过**的变量，你会得到一个正常的增量。但是，如果该变量**自设置以来仅在字符串上下文中使用**，并且其值不是空字符串且与模式匹配`/^[a-zA-Z]*[0-9]*\z/`，则增量作为字符串完成，将每个字符保留在其范围内，并带有进位... *（强调）*

`$val == 9`是一个数字上下文。所以它打印 A（你只是设置它），然后你得到 B 的魔法增量（它还没有在数字上下文中使用），但是你点击了`==`（在数字上下文中使用它），所以当你`++$val`又回到了 B 被视为一个数字 (0) 并递增到 1。

您可以`eq`用来进行字符串比较，从而保留魔法增量，但您也可以只说：

```
print 1 .. 8, 'A' .. 'F'; 
```

# java - 使用 Java 在文件的每一行末尾附加一个字符

> ID：11510720
> 
> 赞同：0
> 
> 时间：2012-07-16T18:55:16.880
> 
> 标签：java

我想在我的文本文件的每一行的每一端放置一些字符/文本。

测试.txt

一种

b

C

在每一行附加一些字符后：

测试.txt

一个

乙乙

c C

这个过程可能会发生超过一百万次。

啊啊啊啊啊啊……

b B BB BBB...

c c c c c c c...

无论如何，我可以通过迭代每一行并在最后附加字符串来完成这个过程吗？（我知道有一种方法可以读取每一行并在末尾添加一个字符串并写入新的输出文件。但我需要的只是操作同一个文件）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:57:36.847

要插入文件，您必须重写文件（或至少从您插入的位置重写文件）

# jquery - 自动调整宽度未知的 2 个 div

> ID：11510724
> 
> 赞同：1
> 
> 时间：2012-07-16T18:55:47.083
> 
> 标签：jquery, css, autosize

我不完全确定这是可能的，但我希望完成的是这个。

我有两个 DIV 嵌套在一个 div 中，一个在右侧有图像，另一个在左侧有文本。我希望做的是根据图像的大小调整 DIV 的大小以适应。

例如，如果 DIV 的图像为 320w x 270h，整体空间为 720px，那么我希望将包含文本的 DIV 大致重新调整为 400px。我已经将左框宽度设置为自动以适应不同的图像尺寸，但我不知道如何将文本框设置为基于此的正确尺寸。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:16:44.263

这是你想要的东西：http: [//jsfiddle.net/RnUES/](http://jsfiddle.net/RnUES/)

**HTML**

```
<div class="container">
<div class="image"><img src="http://www.cs.cmu.edu/~chuck/lennapg/len_std.jpg" /></div>
<div class="text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent lectus magna, interdum et faucibus a, sagittis ac diam. Quisque elementum malesuada ligula. Duis lectus quam, tempor dictum pulvinar id, posuere ac dolor. Etiam et ligula odio, non adipiscing lacus. Maecenas sit amet elit at leo congue tempus ut non ante. Vestibulum mauris diam, tincidunt eu viverra sit amet, malesuada et diam. Morbi ligula nulla, tristique laoreet imperdiet sed, posuere et velit. Donec mattis enim in leo feugiat mollis. Donec neque mi, posuere at dapibus vel, vestibulum vel mauris. Donec vestibulum leo eget nulla luctus sed hendrerit mauris tempus. Nunc augue erat, pharetra et mollis laoreet, tempus quis orci. Vestibulum lobortis sodales placerat. Integer imperdiet rhoncus nisl eu tristique. Nunc commodo, nisl a aliquet feugiat, tortor lacus porttitor libero, ut sollicitudin justo ligula nec justo.</div>

</div>​ 
```

**CSS**

```
.container{width:720px; background:#ccc;}
.image{float:left;}
.text{overflow:hidden;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:10:33.290

你肯定需要 JavaScript/jQuery。这不能用纯 CSS 来完成。

[请参阅此 JSFiddle](http://jsfiddle.net/pgKX2/)。

基本上，使用jQuery，你可以得到容器宽度，右列宽度，然后将左列宽度设置为前两者的差：

```
$(document).ready(function(){
    var wrapWidth = $('#wrapper').width();
    var rightWidth = $('#right').width();
    var leftWidth = wrapWidth - rightWidth;
    $('#left').css('width', leftWidth + 'px');
});​ 
```

如果您查看 JS Fiddle，并更改图片的“宽度”属性，您可以看到左列如何更改大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:20:09.737

您可以为父 div 和子 div设置 css`display`样式。但是，IE < 8 不支持这些样式，因此如果您需要支持旧浏览器，则需要使用不同的解决方案。`table-row``table-cell`

# c - 为什么输出不一样？

> ID：11510726
> 
> 赞同：6
> 
> 时间：2012-07-16T18:55:47.973
> 
> 标签：c

请解释我为什么它的行为不同。

```
 int main() {
    int p;
    p = (printf("stack"),printf("overflow"));
    printf("%d",p);
    return 0;
  } 
```

这将输出作为 stackoverflow8。但是，如果我删除括号，那么：

`p = printf("stack"),printf("overflow");`给出输出为`stackoverflow5`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T18:58:04.630

[逗号运算符](http://en.wikipedia.org/wiki/Comma_operator)

逗号运算符的优先级低于赋值（它的优先级低于*任何*运算符），因此如果删除括号，则首先进行赋值，然后丢弃第二个表达式的结果。所以...

```
int a = 10, b = 20;
int x = (a,b); // x == 20
int y = a,b;   // y == 10
// equivalent (in terms of assignment) to
//int y = a; 
```

请注意，第三行将导致错误，因为它被解释为重新声明`b`，即：

```
int y = a;
int b; 
```

起初我错过了这个，但它是有道理的。`a`它与 and的初始声明没有什么不同`b`，在这种情况下，逗号不是运算符，而是分隔符。

# java - 从数据库中提取时间并在该特定时间发送消息

> ID：11510728
> 
> 赞同：3
> 
> 时间：2012-07-16T18:55:55.750
> 
> 标签：java, delay, sendmessage, tibco, kdb

我有 aq/kdb 数据库，其中一列有时间。我想获取每一行中的数据，并在每行时间列中指定的时间将其与 tibco 集合点发送出去。最好的方法是什么？

似乎可以使用 java timer 和 delay 类，或者使用一些第三方的东西。注意：这里的复杂部分是我没有定期发送，我需要去数据库确定每条消息的发送时间。

例如，如果列中的前两个值是 14:00:00.000 14:30:00.000，那么第一条消息将在下午 2 点发送，第二条消息将在下午 2:30 发送。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:15:13.647

看看`ScheduledExecutorService`，它有一个`schedule(Runnable command, long delay, TimeUnit unit)`方法可以做你想做的

# android - 消费者关闭输入通道或发生错误。事件=0x8

> ID：11510729
> 
> 赞同：4
> 
> 时间：2012-07-16T18:55:59.017
> 
> 标签：android, memory

所以，我在各种设备上测试我的应用程序，在一些内存较少的设备上，它决定在玩了一段时间后崩溃。我想我在某处有内存泄漏，但这不是问题。

当它死时，它不会抛出任何异常，这就是 logcat 给我的：

```
07-16 14:05:55.424  1318  1318 I ActivityManager: Starting: Intent {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000  cmp=org.waldev.platformer/.Menu } from pid 4631
07-16 14:05:56.213  1318  1349 I ActivityManager: Displayed org.waldev.platformer/.Menu: +613ms
07-16 14:05:58.252  1318  1509 I ActivityManager: Starting: Intent { cmp=org.waldev.platformer/.Platformer } from pid 4623
07-16 14:05:58.510  1220  1316 I ExtendFileSource:  filename = /data/app/org.waldev.platformer-1.apk
07-16 14:05:58.533  1220 10962 I ExtendFileSource:  filename = /data/app/org.waldev.platformer-1.apk
07-16 14:05:58.549  1220  7923 I ExtendFileSource:  filename = /data/app/org.waldev.platformer-1.apk
07-16 14:05:58.557  1220  1220 I ExtendFileSource:  filename = /data/app/org.waldev.platformer-1.apk
07-16 14:05:58.783  1318  1349 I ActivityManager: Resumed Activity:  org.waldev.platformer/.Menu totalTime: 3361 ms
07-16 14:05:58.783  1318  1349 I ActivityManager: Displayed org.waldev.platformer/.Platformer: +496ms
07-16 14:05:59.682  1220  1220 I ExtendFileSource:  filename = /data/app/org.waldev.platformer-1.apk
07-16 14:08:04.619  1220 10961 I ExtendFileSource:  filename = /data/app/org.waldev.platformer-1.apk
07-16 14:09:56.283  1318  1551 I ActivityManager: Process org.waldev.platformer (pid 4623) has died.
07-16 14:09:56.369  1318  1351 E InputDispatcher: channel '405409f8 org.waldev.platformer/org.waldev.platformer.Menu (server)' ~ Consumer closed input channel or an error occurred.  events=0x8
07-16 14:09:56.369  1318  1351 E InputDispatcher: channel '405409f8 org.waldev.platformer/org.waldev.platformer.Menu (server)' ~ Channel is unrecoverably broken and will be disposed!
07-16 14:09:56.416  1318  6514 I WindowManager: WIN DEATH: Window{40576908 org.waldev.platformer/org.waldev.platformer.Menu paused=false}
07-16 14:09:56.557  1318  1537 I WindowManager: WIN DEATH: Window{405409f8 org.waldev.platformer/org.waldev.platformer.Menu paused=false}
07-16 14:09:56.572  1318  2103 I WindowManager: WIN DEATH: Window{409f0b80 org.waldev.platformer/org.waldev.platformer.Menu paused=false}
07-16 14:09:56.580  1318  1464 I WindowManager: WIN DEATH: Window{40543cf0 org.waldev.platformer/org.waldev.platformer.Menu paused=false}
07-16 14:09:56.603  1318  1509 I WindowManager: WIN DEATH: Window{4090ec68 org.waldev.platformer/org.waldev.platformer.Platformer paused=false}
07-16 14:09:56.853  1318  1551 I ActivityManager: Start proc org.waldev.platformer for activity org.waldev.platformer/.Menu: pid=5332 uid=10103 gids={1015}
07-16 14:09:58.291  1318  1349 I ActivityManager: Displayed org.waldev.platformer/.Menu: +1s677ms 
```

似乎它决定在没有告诉我原因的情况下破坏我的流程。我环顾四周，看看是什么导致 android 这样做，但我什么也没看到。

我在这里看到了关于这个的其他问题，但他们似乎都没有真正回答它为什么这样做，而这正是我正在寻找的。有人知道吗？

# android - phonegap，android，后退按钮：不能让它工作

> ID：11510732
> 
> 赞同：-1
> 
> 时间：2012-07-16T18:56:25.773
> 
> 标签：android, jquery-mobile, cordova

Phonegap 1.8.1 -- 适用于 2.2 的 Android API -- jQuery 1.7.1 -- jQueryMobile 1.0

我制作了一个非常简单的应用程序来测试它，但我无法让它工作。这里是。

索引.HTML

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>TestApp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="jquery.mobile-1.1.0/jquery.mobile-1.1.0.min.css"/>
    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript" src="jquery.mobile-1.1.0/jquery.mobile-1.1.0.min.js"></script>
    <script type="text/javascript">
        function onDeviceReady() {

            document.addEventListener("backbutton", onBackButton);
        }

        function onBackButton(e){
            console.log("C'mon guv! Gimme a chance!");
        }

        document.addEventListener("deviceready", onDeviceReady, false);

    </script>
    <script type="test/javascript" src='cordova-1.8.1.js'></script>

</head>

<body>
<div id="homepage" data-role="page" data-theme="a">
    <div data-role="header">
        <h1>Work with me here</h1>
    </div>

    <div data-role="content">
        I am page 1.
        <a href="#char-1" data-role="button">Next</a>
    </div>
</div>

<div id="char-1" data-role="page" data-theme="a">
    <div data-role="content">HAHAHA!</div>
</div>

</body>
</html> 
```

AndroidManifest.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="com.example"
          android:versionCode="1"
          android:versionName="1.0">
    <uses-sdk android:minSdkVersion="2" android:targetSdkVersion="14"/>
    <supports-screens
        android:largeScreens="true"
        android:normalScreens="true"
        android:smallScreens="true"
        android:resizeable="true"
        android:anyDensity="true" />

    <application android:label="@string/app_name">
        <activity android:name="MyActivity"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

附录 - 我认为问题是在代码绑定到事件之前，'deviceready' 事件要么不触发，要么触发。不知道如何修复它。

如果我需要提供更多信息，请告诉我。我很难过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T04:34:10.853

据我所知，后退按钮按下事件在内部不起作用`onDeviceReady`。您必须在每个页面显示中触发事件。就我而言，它是这样工作的，

```
function onDeviceReady(){
    /*Back event handler for all pages navigation*/
    $(document).bind ('pageshow', function (e, data) {
        if ($.mobile.activePage.attr('id') == 'index') {
            document.addEventListener("backbutton", function () { 
                setTimeout( function() {navigator.app.exitApp();}, 100 );
            }, true);
        }
        else{
            document.addEventListener("backbutton", function () {
                setTimeout( function() {$.mobile.changePage("#index");}, 100 );
            }, true);
        }
    });

} 
```

在我的应用程序中，当您从第一个屏幕按下返回按钮时，它会退出应用程序，如果您在任何页面内按下，它会自动进入第一页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T01:23:56.487

我很惭愧地承认这一点。

```
<script type="test/javascript" src='cordova-1.8.1.js'></script> 
```

这不是测试/javascript ...它是文本/javascript。

:(

# php - php，如果数字是整数，则添加尾随零

> ID：11510733
> 
> 赞同：16
> 
> 时间：2012-07-16T18:56:26.393
> 
> 标签：php

简单的数学：

```
 $a=$b/$c; echo $a; 
```

如果 $b 等于 123.00 且 $c 等于 1，则 $a 变为 123。

如果 $b 是 123.50，$c 是 1，$a 是 123.50。但在前一种情况下，我希望 $a 为 123.00。

可以测试 $a 是否有任何非零小数部分，然后根据需要添加尾随零。

但我正在寻找 php 函数来做同样的事情。可能的？

**编辑 ：**

如果我不想要`number_format`那里的逗号怎么办？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-07-16T19:07:59.037

使用`sprintf("%0.2f",$a);`. [文档](http://php.net/sprintf)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-16T18:59:40.717

使用该[`number_format`](http://php.net/manual/en/function.number-format.php)功能。如果您不想要逗号分隔符，请像这样设置函数的所有四个参数（千位分隔符是第四个参数）：

```
$number = number_format(1234, 2, '.', ''); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T19:05:19.037

是的，使用[https://www.php.net/manual/en/function.number-format.php](https://www.php.net/manual/en/function.number-format.php)函数，如下所示：

```
$a = 123;
$answer = number_format($a,"2");
echo $answer; 
```

# ruby-on-rails - rails - has_many 类别

> ID：11510735
> 
> 赞同：0
> 
> 时间：2012-07-16T18:56:31.077
> 
> 标签：ruby-on-rails

从人员记录中，我需要能够添加/显示特定类型的文档。包括 category_id 的条件是可行的，但在这一点上，我不能假设类别 ID 会随着开发的进展而保持不变。这也是我只创建我需要的类别的测试的问题。

有没有办法可以动态设置category_id，例如这样的：

```
has_many :personal_documents, :as => :documentable, :conditions => "category_id = #{DocumentCategory.find_by_name('Personal').id}", class_name: 'Document' 
```

楷模：

```
Person < AR::Base
  has_many :documents, :as => :documentable
  has_many :personal_documents, :as => :documentable, #:conditions => "category_id = 1"
  has_many :legal_documents, :as => :documentable,  #:conditions => "category_id = 2"
end

Animal < AR::Base
  has_many :documents, :as => :documentable
end

Document < AR::Base
  belongs_to :person
  belongs_to :category
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:26:08.727

你能简单地使用带有静态 ID 的种子吗？

# sql - SQL：从同一个表连接时输出多行

> ID：11510738
> 
> 赞同：1
> 
> 时间：2012-07-16T18:56:33.713
> 
> 标签：sql, join, union

我的问题是：从同一个表加入时是否可以输出多行？例如，使用此代码，我希望它输出 2 行，每个表一个。相反，它的作用是给我 1 行的所有数据。

```
SELECT t1.*, t2.* 
FROM table t1
JOIN table t2 
    ON t2.id = t1.oldId
WHERE t1.id = '1' 
```

**更新**
好吧，我对 UNION/UNION ALL 的问题是：我不知道 t1.oldId 值等于什么。我只知道 t1 的 id。我试图避免使用 2 个查询，所以有没有办法可以做这样的事情：

```
SELECT t1.*
FROM table t1
WHERE t1.id = '1'

UNION

SELECT t2.*
FROM table t2
WHERE t2.id = t1.oldId 
```

**样本数据**

```
messages_users
id    message_id   user_id   box   thread_id   latest_id
--------------------------------------------------------
8     1            1         1     NULL        NULL
9     2            1         2     NULL        16
10    2            65        1     NULL        15
11    3            65        2     2           NULL
12    3            1         1     2           NULL
13    4            1         2     2           NULL
14    4            65        1     2           NULL
15    5            65        2     2           NULL
16    6            1         1     2           NULL

Query:
SELECT mu.id FROM messages_users mu
JOIN messages_users mu2 ON mu2.latest_id IS NOT NULL
WHERE mu.user_id = '1' AND mu2.user_id = '1' AND ((mu.box = '1' 
AND mu.thread_id IS NULL AND mu.latest_id IS NULL) OR mu.id = mu2.latest_id) 
```

这个查询解决了我的问题。但似乎我的问题的答案是不要使用 a`JOIN`而是 a `UNION`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:57:36.240

你的意思是 t1 的一排和 t2 的一排？

您正在寻找 UNION，而不是 JOIN。

```
select * from table where id = 1
union
select * from table where oldid = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:01:13.053

如果您尝试将表中的行相乘，则需要 UNION ALL（而不是 UNION）：

```
select *
from ((select * from t) union all
      (select * from t)
     ) t 
```

我有时也使用交叉连接来做到这一点：

```
select *
from t cross join
     (select 1 as seqnum union all select 2) vals 
```

交叉连接显式地将行数相乘，在这种情况下，附加了一个序列号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:48:38.190

好吧，因为它是同一张桌子，你可以这样做：

```
SELECT t2.*  
FROM table t1 
JOIN table t2  
  ON t2.id = t1.oldId 
  OR t2.id = t1.id
WHERE t1.id = '1' 
```

# javascript - jQuery：如何将事件附加到类内新创建的元素

> ID：11510739
> 
> 赞同：0
> 
> 时间：2012-07-16T18:57:11.053
> 
> 标签：javascript, jquery

我正在尝试创建一个 Object 类，它将获取数据并创建元素列表。我还想在触发类方法的新 LI 上附加一个单击事件。然而，当使用

```
el.click(function() {
    this.method();
}); 
```

`this`不再引用该类，因此单击该类`li`会给您一个未定义的方法错误。关于如何将类方法附加到新创建的元素的建议？

JS代码：

```
if (typeof Object.create !== 'function') {
    Object.create = function(o) {
        function F() {}
        F.prototype = o;
        return new F();
    };
}

var base = {
    init: function(data) {
        this.data = data;
        this.show_data();
    },

    show_data: function() {

        for (i = 0; i < this.data.bindings.length; i++) {

            var $item = $('<li>' + this.data.bindings[i].ircEvent + '</li>');
            $item.click(function() {
                this.show_clicked(i);
            });
            $('#it').append($item);
        }
    },

    show_clicked: function(index) {
        console.log('clicked in method');
    }
};

var extended = {

    show_alert: function() {
        alert('second class');
    }
};

var myObj = {
    "bindings": [
        {
        "ircEvent": "PRIVMSG",
        "method": "newURI",
        "regex": "^http://.*"},
    {
        "ircEvent": "PRIVMSG",
        "method": "deleteURI",
        "regex": "^delete.*"},
    {
        "ircEvent": "PRIVMSG",
        "method": "randomURI",
        "regex": "^random.*"}
    ]
};

$(document).ready(function() {

    var baseObj = Object.create(base);
    baseObj.init(myObj);

}); 
```

小提琴：http: [//jsfiddle.net/kmfstudios/EwC3r/5/](http://jsfiddle.net/kmfstudios/EwC3r/5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:07:16.793

为了使您的方法在 click 函数中起作用，只需引用包含该对象的全局变量。

该行：

```
 this.show_clicked(i); 
```

应改为：

```
 base.show_clicked(i); 
```

如果您希望索引值显示在最终结果中，则必须将其作为数据传递，或者使用 jquery 来确定单击了哪个索引。

这是一个更新的小提琴 - [http://jsfiddle.net/EwC3r/4/](http://jsfiddle.net/EwC3r/4/)

# php - PHP 致命错误：在 PDO 和 mysqli 中的非对象上调用成员函数 prepare()

> ID：11510742
> 
> 赞同：0
> 
> 时间：2012-07-16T18:57:15.553
> 
> 标签：php, pdo, mysqli

我已经尝试了几种使用参数化语句的方法，但我仍然遇到问题。

起初我尝试了参数化语句：

```
$dbc = new PDO("mysql:host=localhost;dbname=the_name", 'the_login', 'the_pass');
$query = $dbc->prepare('INSERT INTO req_form (lname, fname, email, address, city, state, zip, phone, affiliation, role, ip_address, abc, ace, carr, ema, tuac, olatc_temp) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)');
$query->execute(array($lname, $fname, $email, $addr, $city, $state, $zip, $phone, $affiliation, $prof_role, $_SERVER['REMOTE_ADDR'], enum($abc), enum($ace), enum($carr), enum($ema), enum($tuac), enum($last))); 
```

但得到“PHP 致命错误：在非对象上调用成员函数 prepare()”

现在我试过了：

```
$conn = new mysqli('localhost', 'the_login', 'the_password', 'the_name');
$sql = 'INSERT INTO req_form (lname, fname, email, address, city, state, zip, phone, affiliation, role, ip_address, abc, ace, carr, ema, tuac, olatc_temp) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)';
$query = $conn->prepare($sql);
$query->bind_param('ssssssissssssssss', $lname, $fname, $email, $addr, $city, $state, $zip, $phone, $affiliation, $prof_role, $_SERVER['REMOTE_ADDR'], enum($abc), enum($ace), enum($carr), enum($ema), enum($tuac), enum($last));
$query->execute(); 
```

我仍然收到错误消息，我是否可能在插入语句中使用了保留名称？

编辑（添加枚举函数）：

```
function enum($ar){
    if(count($ar)>1)
        return 'BOTH';
    else
        return $ar;
} 
```

编辑（phpinfo() 的 mysqli 部分的输出：

```
mysqli
MysqlI Support enabled 
Client API library version  mysqlnd 5.0.8-dev - 20102224 - $Id: SOME_VALUE_WAS_HERE $  
Active Persistent Links  0  
Inactive Persistent Links  0  
Active Links  0  

Directive Local Value Master Value 
mysqli.allow_local_infile On On 
mysqli.allow_persistent On On 
mysqli.default_host no value no value 
mysqli.default_port 3306 3306 
mysqli.default_pw no value no value 
mysqli.default_socket no value no value 
mysqli.default_user no value no value 
mysqli.max_links Unlimited Unlimited 
mysqli.max_persistent Unlimited Unlimited 
mysqli.reconnect Off Off 
```

当我把 var_dump($conn) 放在第一行之后它会打印出东西，如果我把它放在 $conn->prepare 的正上方，它会显示 NULL

# java - 验证数据时，Java 的 lastIndexOf 和 indexOf 的正确语法是什么？

> ID：11510744
> 
> 赞同：0
> 
> 时间：2012-07-16T18:57:21.457
> 
> 标签：java, string

e 有一个可以接受 2 位或 4 位数字年份的日期表格。我不是要为异常编写代码……只是年份为 2 或 4 位长的实例。我使用 lastIndexOf 来查找“/”的最后一个实例，如果斜线后的第三个字符是数字，我假设是 4 位数的年份。否则，这是一个两位数的年份。

我已经测试并验证了这是目前唯一给我带来问题的线路，

```
if (inputLine.lastIndexOf.isNumeric("/"))+3 {
   year = inputLine.trim().substring(inputLine.lastIndexOf("/")+1,input.lastIndexOf("/")+4).trim);
   else year = "0000"; 
```

我不断收到编译错误。对于我要添加到索引值的行，我有一个`bad operand for the binary operator`. 此外，找不到变量 lastIndexOf。

我在程序的开头调用下面的列表，据我所知，从 java 文档中可以看出，`io`并`lang`引入适当的方法和类。

```
import java.util.*;
import java.io.*;
import java.nio.file.*;
import java.lang.*; 
```

对于该`if`语句，虽然我的括号是*平衡*的，但我不知道是否在嵌套括号的正确级别内添加了附加字符（例如，索引值 + 3）。话虽如此，我已经尝试将这些整数添加到顶部，但几乎无济于事。

```
if (inputLine.lastIndexOf.isNumeric("/"))+3 {
   year = inputLine.trim().substring(inputLine.lastIndexOf("/")+1,input.lastIndexOf("/")+4).trim);
   else year = "00/00/0000"; 
```

我想知道一些事情：首先，我可以在单个语句中执行此操作，还是在一个语句中定义索引，然后在后续语句中定义 index+offset-value 更好？

当我在单个字段上使用多个方法和类时（例如，`.trim().substring.Indexof()`等等，Java 解析这些的顺序是什么？我想不明白这些语句是如何被解析的，所以我有更好的理解操纵变量和测试输出的最佳方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:02:09.903

您错误地使用了 +3。您将它放在 if(condition) 语句之外，它没有任何语法意义 - 它在您的代码中是 gobbledygook。

此外，如果您尝试测试 inputline.lastIndexOf('/') 的结果是否为数字，则它没有任何意义。如果指定的字符没有出现，lastIndexOf 不会抛出异常；它只会返回-1。您想测试结果是否大于/等于零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:00:58.170

您不能使用 trim() 然后使用原始字符串中的索引。您需要 trim() 字符串，然后使用修剪后的字符串中的索引（否则索引可能完全不正确）

也许使用带有`dd/MM/yyyy`格式的 SimpleDataFormat 或使用 split 会是更好的选择。

```
String[] parts = inputLine.trim().split("/");
String day = parts[0], month = parts[1], year = parts[2]; 
```

使用 trim() 和 lastIndexOf()

```
String trimmed = inputLine.trim();
int last = trimmed.lastIndexOf("/");
year = trimmed.substring(last+1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:08:10.893

关于你问题的最后一部分

当您执行方法链接时，`.trim().substring.Indexof()`每个方法都按从左到右的顺序调用。所以：

```
String myString = " string ";
int index = myString.trim.substring(3).indexOf('n'); 
```

相当于：

```
String myString = " string ";
String trimmedString = myString.trim(); // "string"
String subString = trimmedString.substring(3) // "ing"
int index = subString.indexOf('n'); // 1 
```

# iphone - 什么是 UINavigationTransitionView

> ID：11510748
> 
> 赞同：2
> 
> 时间：2012-07-16T18:57:39.517
> 
> 标签：iphone, cocoa-touch, ios5, rotation, transition

我正在尝试在视图中调试一些奇怪的旋转行为。查看视图层次结构，我可以看到旋转发生在 UINavigationTransitionView 的实例中。这是什么观点？它与 UINavigationController 有关吗？

我的层次结构如下所示：

```
MPMovieView
  UIView
    UIViewControllerWrappper
      UINavigationTransitionView
        UILayoutContainerView
          UIWindow 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T18:31:27.783

AFAIK UINavigationTransitionView 是一个用于动画 UINavigationController 子视图的类。它通常包含一个或两个 UIViewControllerWrapperView，每个都包含您的实际 UIViewController.view 如果您将 UINavigationController 子类化并覆盖 pushViewControllerAnimated: ，您可以在调用 [super pushViewControllerAnimated:] 之前和之后记录层次结构，您会注意到 VC 被推送到 rect从 {0, 20, 320, 480} 更改为 {-320, 20, 320, 480}根据此行为制作您的旋转解决方案。发布一个关于实际轮换问题的新问题，我们可以帮助您解决它，而无需使用私有 API

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T12:57:12.510

很多时候，Apple 在公共类中使用私有类来管理内部行为。这是其中一种情况。没有名为 UINavigationTranstionView 的公共类。如果您确信苹果有错，我要么在别处寻找错误，要么提交雷达。如果您决定继续查看您的代码，请考虑在此处发布一些代码并描述您的问题，以便我们提供帮助。

# vb.net - 如何遍历VB中类的属性？

> ID：11510749
> 
> 赞同：0
> 
> 时间：2012-07-16T18:57:42.667
> 
> 标签：vb.net, oop, class, syntax

如果我有一个类对象 A，并且它具有诸如 a0、a1、a2 之类的属性...如果此类具有 100 个这样的属性（最多 a99）。我想显示这些属性中的每一个，但我不想有 100 行代码来调用它，如下所示

```
print A.a0
print A.a1
print A.a2
...
print A.a99 
```

代码效率太低，所以我想知道是否有办法遍历这些属性。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:36:44.770

.NET 提供了通过称为*反射的过程在运行时检查对象的能力。*原始帖子的目的是以自动方式迭代对象的属性，而不是通过手动编码显示每个属性的显式语句，而反射就是完成这件事的过程。

出于这个特定目的，在运行时循环遍历对象的属性，您使用可用于每个类型的 GetProperties() 方法。在您的情况下，您要“反映”的类型是 A，因此 GetProperties 的特定类型版本返回该对象的实例属性列表。

当您要求 .NET 返回对象的属性时，您还可以指定所谓的*绑定标志*，它告诉 .NET 要返回哪些属性 - 公共属性、私有属性、静态属性 - 来自大约 20 个不同值的无数组合BindingFlags 枚举。出于本说明的目的，假设您的 A0-A999 属性已声明为公共，则 BindingFlags.Public 就足够了。要公开更多属性，只需将多个 BindingFlag 值与逻辑“或”组合。

所以，现在有了这些信息，我们需要做的就是创建一个类，声明它的属性，并告诉 Reflection 为我们枚举属性。假设您的 A 类存在且已定义属性名称 A0-A999，以下是您如何枚举以“A”开头的属性名称：

```
// Assuming Class "A" exists, and we have an instance of "A" held in 
// a variable ActualA...
using System.Reflection

// The GetProperties method returns an array of PropertyInfo objects...
PropertyInfo[] properties = typeof(ActualA).GetProperties(BindingFlags.Public);
// Now, just iterate through them.
foreach(PropertyInfo property in properties)
{
    if (property.Name.StartsWith("A")){
    // use .Name, .GetValue methods/props to get interesting info from each property.
        Console.WriteLine("Property {0}={1}",property.Name,
                                             property.GetValue(ActualA,null));
    }
} 
```

你有它。那是 C# 版本而不是 VB，但我认为一般概念应该很容易翻译。我希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:42:37.687

创建一个 VB.Net 控制台应用程序，将此代码复制并粘贴到 Module1.vb 文件中并运行它。

```
Module Module1

    Sub Main()
        For Each prop In GetType(TestClass).GetProperties()
            Console.WriteLine(prop.Name)
        Next

        Console.ReadKey(True)
    End Sub

End Module

Public Class TestClass
    Private _One As String = "1"
    Public Property One() As String
        Get
            Return _One
        End Get
        Set(ByVal value As String)
            _One = value
        End Set
    End Property

    Private _Two As Integer = 2
    Public Property Two() As Integer
        Get
            Return _Two
        End Get
        Set(ByVal value As Integer)
            _Two = value
        End Set
    End Property

    Private _Three As Double = 3.1415927
    Public Property Three() As Double
        Get
            Return _Three
        End Get
        Set(ByVal value As Double)
            _Three = value
        End Set
    End Property

    Private _Four As Decimal = 4.4D
    Public Property Four() As Decimal
        Get
            Return _Four
        End Get
        Set(ByVal value As Decimal)
            _Four = value
        End Set
    End Property
End Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:36:08.087

此 MSDN 代码示例说明了如何使用反射迭代类的属性：

[http://msdn.microsoft.com/en-us/library/kyaxdd3x.aspx#Y900](http://msdn.microsoft.com/en-us/library/kyaxdd3x.aspx#Y900)

# ios - Salesforce 移动 SDK iOS - SFNativeRestAppDelegate

> ID：11510751
> 
> 赞同：0
> 
> 时间：2012-07-16T18:57:54.120
> 
> 标签：ios, salesforce, salesforce-mobile-sdk

使用 Salesforce 移动 SDK iOS 框架模板

```
The SFNativeRestAppDelegate state tat you should override:
- (UIViewController*)newRootViewController {..} 
```

返回 UIViewController - 模板与 UITableViewController 一起使用，但在使用 UISplitViewController 时出现以下错误：

'应用程序试图以模态方式呈现拆分视图控制器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T16:16:00.343

Salesforce 框架将 rootViewController 显示为模式。解决方案是从 SFNativeRestAppDelegate 覆盖 - (void)setupNewRootViewController。

Salesforce 框架开发人员给了我解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:01:40.887

您不能以模态方式呈现拆分视图控制器，它被设计为始终作为根视图控制器。

# javascript - 通过 ajax 发送表单数组值

> ID：11510755
> 
> 赞同：0
> 
> 时间：2012-07-16T18:58:19.903
> 
> 标签：javascript, jquery, ajax

所以我的 php 需要 2 个值，`operation => string`并且`data => array`. 以下是表格（**动态生成的输入**）：

```
<form method="post" action="/operations.php">
        Title: <input type="text" value="valuehere" name="data[title]">
                    .
                    .
                    .
        Description: <textarea name="data[description]"></textarea><br>

        <button class="btn janitor_edit" type="submit">Edit Media</button>

                    <input type="hidden" value="operateMePls" name="operation"> 
        <input type="hidden" value="254" name="data[id]">
</form> 
```

现在我必须从`data[xyz]`表单中的所有内容创建一个数组，但我很难找到这样做的方法。我最接近的就是这样做：[link](http://hasin.me/2009/10/01/jqueryhooking-form-submit-and-making-it-an-ajax-request/)

我必须将数组存储为键/值，别无他法，所以我可以`ajax_request = { operation: operation_input, data : input_array_data };`。

哦，当提交“正常”的 POST 时，表单会按预期工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:29:43.123

如果表单自己工作，那么让 jQuery 负责[将数据转换为适合您的 XHR 表单](http://api.jquery.com/serialize/)。

```
data: $('#your_form').serialize(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:13:50.640

我使用了一个对象而不是一个数组。当您在 PHP 中进行 json_decode 时，将“true”作为第二个参数传递，数据将以数组的形式出现。我想这就是你想要的。如果您正在寻找不同的东西，请发表评论。

```
$(".janitor_edit").click(function () {
  var data = {};
  data.operation = $("input[name='operation']").val();
  data.data.id = $("input[name='data\\[id\\]']").val();
  data.data.title = $("input[name='data\\[title\\]']").val();
  data.data.description = $("input[name='data\\[description\\]']").val();
}); 
```

# c# - 如何从 WCF REST 服务流式传输字符串

> ID：11510756
> 
> 赞同：1
> 
> 时间：2012-07-16T18:58:27.593
> 
> 标签：c#, wcf, rest, stream, streaming

我用 C# 编写了一个非常基本的 WCF REST 服务，在服务接口中有以下内容：

```
[OperationContract]
[WebGet(UriTemplate = "/stream", ResponseFormat = WebMessageFormat.Xml)]
Stream streamTest(); 
```

在 Service.svc.cs 文件中，它具有此功能（显然 StreamUtility 作为参考包含在使用中）：

```
public Stream streamTest()
    {
        return StreamUtility.streamTest();
    } 
```

最后流函数本身看起来像这样：（它根据我在这里找到的源代码返回一个大的任意字符串作为内存流：http: [//www.codeproject.com/Articles/35982/REST-WCF-and-Streams -Getting-Rid-of-the-Names-Sp](http://www.codeproject.com/Articles/35982/REST-WCF-and-Streams-Getting-Rid-of-those-Names-Sp) )

```
public static Stream streamTest()
    {
        string result = "skdjdfnlsakdjfnasdlkjfnasdkjkfnasldkjfnasdlkjfnasdlkfjnasdldkfjnassdlfkjnadsdlfkjasndflkjsanflaskjdfnalskdkjnfalskfjnslidifubsaoicubuiewnfpoiowneflskjdfansdufawneifuenfgiwe";
        for (int i = 0; i < 5; i++)
        {
            result += result;
        }
        Encoding encoding = Encoding.GetEncoding("ISO-8859-1");
        byte[] returnBytes = encoding.GetBytes(result);
        return new MemoryStream(returnBytes);
    } 
```

不幸的是，这个功能似乎无法正常工作，我无法辨别。当我通过浏览器访问 localhost:XXXXX/Service.svc/stream 调用该函数时，它会显示一个加载图标，然后简单地冻结。

我已经能够找到一些试图回答这个问题的网站，但他们的代码都没有真正起作用。我发现上面代码的地方有一行不起作用：

```
WebOperationContext.Current.OutgoingResponse.ContentType = "text/plain"; 
```

此行加下划线是因为程序找不到 WebOperationContext 引用，而且我不知道它的位置，尽管已从该站点下载了源代码，该站点仅包含两个 C# 文件并且并未实际运行。

如果有人能准确地告诉我如何通过 WCF 中的 REST 服务流式传输数据（即使不是通过上述方法），那将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:09:17.273

如果您只想使用 GET 和 POST，以下文章可能会有所帮助：

[CodeProject 关于开发 RESTful WCF 服务](http://www.codeproject.com/Articles/275279/Developing-WCF-Restful-Services-with-GET-and-POST) （这是我个人采取的方式）

您可以使用此处描述的 WebHttpBinding，同时提供 PUT 和 DELETE：

[带有 JSON 的 WCF REST 服务](http://www.codeproject.com/Articles/327420/WCF-REST-Service-with-JSON)

一个更简单的例子是here（也使用WebHttpBinding）

[流式传输 WCF REST 上的 MS Social](http://social.msdn.microsoft.com/Forums/en/wcf/thread/fb9efac5-8b57-417e-9f71-35d48d421eb4)

# validation - 失败后 JSF2 BeanValidation 重置值

> ID：11510758
> 
> 赞同：2
> 
> 时间：2012-07-16T18:58:34.087
> 
> 标签：validation, user-interface, jsf-2, primefaces, bean-validation

我们 Web 应用程序的模块在中心显示数据表，在右侧显示所选记录的详细信息。每次用户选择主表的记录时，我们都会更新详细信息页面并显示所选记录的详细信息。现在我们有以下问题：

1.  用户在主表中选择一条记录，数据显示在明细区域。
2.  用户修改详细数据并单击保存。
3.  发生验证（bean 验证）错误，用户将看到错误消息）。
4.  用户没有更正错误的输入，而是选择了主表的另一条记录。
5.  所有没有错误状态的字段都将使用新记录的数据进行更新。之前错误的字段显示旧数据。旧记录的数据会一直保留到用户刷新页面。

有没有办法解决这个问题？我从 Primefaces 扩展中看到了一个 pe:resetInput 组件，但是这个组件需要一个 UICommand 组件才能工作。如果用户选择主表的另一个条目，我需要一个有效的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:09:09.937

您可以为此`ResetInputAjaxActionListener`使用[OmniFaces](http://omnifaces.org)。除了注册为 a 外`<f:actionListener>`，还可以全局注册为 a `PhaseListener`。

### 也可以看看：

*   [`ResetInputAjaxActionListener`展示示例](http://showcase.omnifaces.org/eventlisteners/ResetInputAjaxActionListener)
*   [`ResetInputAjaxActionListener`API 文档](http://omnifaces.org/docs/javadoc/current/org/omnifaces/eventlistener/ResetInputAjaxActionListener.html)
*   [`ResetInputAjaxActionListener`源代码](https://github.com/omnifaces/omnifaces/blob/master/src/org/omnifaces/eventlistener/ResetInputAjaxActionListener.java)

* * *

如果您打算自己动手，那么您基本上需要自己编写代码，它基本上可以完成以下操作：

*   在调用动作阶段，获取`UIInput`ajax 请求未执行/处理的待渲染组件。
*   在它们上调用`resetValue()`方法。

### 也可以看看：

*   [发生验证错误后，如何使用 PrimeFaces AJAX 填充文本字段？](https://stackoverflow.com/questions/6642242/how-can-i-populate-a-text-field-using-primefaces-ajax-after-validation-errors-oc)

# unit-testing - 为什么我应该避免使用 DbUnit 来测试 MySQL？

> ID：11510759
> 
> 赞同：6
> 
> 时间：2012-07-16T18:58:38.967
> 
> 标签：unit-testing, tdd, phpunit, dbunit

我最近参与了一些使用 PHPUnit 的 TDD。我必须测试一个数据库驱动的应用程序，并阅读我计划在未来几周内研究和实施的 DbUnit 扩展。

然而，我遇到了这个人自己的[演讲](http://sebastian-bergmann.de/archives/773-Testing-PHPMySQL-Applications-with-PHPUnitDbUnit.html)——塞巴斯蒂安·伯格曼——他有一张题为“如果可以的话，避免对 MySQL 进行测试”的幻灯片，这让我对我的冒险行为产生了一些怀疑。

有人可以解释为什么我不应该针对 MySQL 进行测试的原因吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T20:38:55.310

两个原因：

*   它很慢（并且单元测试需要很快）
*   它增加了您无法控制的额外故障点（当数据库连接失败时测试真的*失败了吗？）*

相反，正如作者建议的那样，您应该使用内存数据库（如 SQLite）测试您的 DAL。这消除了上述问题。

但是，这种方法也有其缺点 - 您可能在将 SQL 从一种数据库方言移植到 SQLite 时遇到问题。这自然意味着您将无法测试 DAL 的 MySQL 特定部分。一如既往，它是一把双刃剑——你获得了单元测试的速度和隔离，但你失去了可信度（如果我们可以这样称呼它）——如果它通过 SQLite，你能 100% 确定它在 MySQL 上工作吗？

将 DAL/DAO 测试的核心留给集成测试阶段可能不是一个坏主意，在那里您将使用您使用的真实数据库引擎对其进行测试，并将小东西留给单元测试；例如映射（如果您使用的是 ORM）。

**编辑**：*禁食*绝不是严格的要求——它只是一个很好的一般建议。在进行 TDD 时，您的开发人员会运行*很多*单元测试（这样想；每次提交到本地 repo/每个*重要的*代码更改都需要通过运行单元测试来检查代码库完整性）——也许不是全部，但肯定有一些。你希望这个过程很快。

现在，进行缓慢的测试通常会这样结束：

*   *“伙计，这东西运行得太慢了……”*
*   *“也许我可以只跑几个……我稍后再跑休息”*
*   在这一点上我们知道以后永远不会来
*   *“嘿，我最后一次提交没有破坏任何东西，我根本没有运行任何测试！”*
*   *“我为什么要运行它们呢？”*

编写未运行的测试几乎会扼杀编写它们的目的。

> [这件事发生在一个和我一起工作的朋友身上；他的团队有运行 +/- *20 分钟*的测试套件（DAL 测试做得很差，IoC 容器参与测试），开发人员开始运行*一些*测试，很快“当前构建破坏者”电子邮件成为每天的事情。他们有相当大的套房，但打破测试并*没有那么糟糕*。]

总体而言，您的方法似乎是正确的——我不会将测试转移到 SQLite。就像我建议的那样，使用集成测试套件对数据库层进行测试（这样它就可以与常规的单元测试套件分开运行）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-04T09:01:02.690

我完全不同意 Sebastian Bergmann 写的幻灯片 33 的标题。

> （因为幻灯片上的信息很容易被误解，我相信他在他的演讲中解释了真正的意思）

正如他在介绍中所说，**调试很糟糕，但测试很糟糕**。

如果实际环境使用 mySQL，则**必须**针对 mySQL 对其进行测试。否则你会发现自己在调试 SQLite 和 mySQL 之间的区别。

我相信他的方向是针对开发人员而不是单元测试人员，从这个意义上说，我还建议开发人员尽一切努力保持他们的代码数据库尽可能中立。它将提高项目整个生命周期的质量，而不仅仅是单元测试人员。它甚至可以保护 mySQL 本身的功能改进。（过去有很多问题）。

但是，在测试使用 SQL 的单段代码时，无论您已经进行了哪些其他测试，都**必须**针对真实事物进行测试。

我的做法是创建一个数据库连接的抽象层，并让测试与该层做出反应。随后，我为要测试的每个数据库服务器创建不同的具体类。

在给定的环境下，我们可以针对 SQLite 测试频率，但真正的测试每天至少运行一次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T20:53:41.320

我使用 DbUnit 来测试我的模型（说到 MVC，包括 ORM 模型），因为它们与数据库密切相关。对于其他一切（主要是控制器），我使用模拟对象。

单元测试的基本思想是一次只测试一个应用程序代码单元（即一个类），因此最好避免使用 DB，除非代码直接使用它。

当然，性能很重要。例如，我有大约 500 个模型测试，几乎所有模型都使用 DB 和固定装置。在一台速度相当快的计算机上执行所有这些测试大约需要 30-40 秒。代码覆盖率报告生成大约需要一分钟。

# settings - 常春藤配置：为什么有这些区别？

> ID：11510760
> 
> 赞同：2
> 
> 时间：2012-07-16T18:58:39.873
> 
> 标签：settings, ivy

```
<ivy-module version="2.0">
    <info organisation="com.travelclick" module="CoreWebServices" revision="4.1"/>
    <configurations defaultconfmapping="default">
        <conf name="runtime" visibility="public"/>
        <conf name="default" visibility="public"  extends="runtime"/>
    </configurations>

    <dependencies>
        <dependency org="com.travelclick"
            name="commons-all"
            rev="4.1"
            conf="default->default"/>

        <dependency org="com.sun.messaging.mq"
            name="jms"
            rev="4.5.2"
            conf="default->default"/>

        <dependency org="org.jboss.common"
            name="servlet-api"
            rev="4.2"
            conf="default->default"/>

        <dependency org="com.fiorano"
            name="framework"
            rev="2.0"
            conf="default->default"/>

        <dependency org="com.fiorano"
            name="fmq-client"
            rev="9.3.0"
            conf="default->default"/>

        <dependency org="commons-codec"
            name="commons-codec"
            rev="1.3"
            conf="default->default"/>

        <dependency org="commons-httpclient"
            name="commons-httpclient"
            rev="3.1"
            conf="default->default"/>

        <dependency org="commons-lang"
            name="commons-lang"
            rev="2.2"
            conf="default->default"/>

        <dependency org="commons-pool"
            name="commons-pool"
            rev="1.4"
            conf="default->default"/>
    </dependencies>
</ivy-module> 
```

请注意，所有依赖项都配置为`default->default`.

在我的`build.xml`中，我有以下陈述：

```
 <ivy:resolve conf="default"/>
 <ivy:cachepath pathid="all.libs" conf="default"/> 
```

注意我使用的是*默认*配置。

我使用`all.libs`路径将库下载到我正在构建的战争中。

我在战争中得到了以下库，这就是我想要的：

```
commons-all-4.1.jar
commons-codec-1.3.jar
commons-httpclient-3.1.jar
commons-lang-2.2.jar
commons-logging-1.0.4.jar
commons-pool-1.4.jar
fmq-client-9.3.0.jar
framework-2.0.jar
jms-4.5.2.jar
servlet-api-4.2.jar 
```

现在，我将删除配置信息。这`ivy.xml`与删除的`<configurations>`部分和所有`conf=default->default`删除的部分相同：

```
<ivy-module version="2.0">
    <info organisation="com.travelclick" module="CoreWebServices" revision="4.1"/>

    <dependencies>
        <dependency org="com.travelclick"
            name="commons-all"
            rev="4.1"/>

        <dependency org="com.sun.messaging.mq"
            name="jms"
            rev="4.5.2"/>

        <dependency org="org.jboss.common"
            name="servlet-api"
            rev="4.2"/>

        <dependency org="com.fiorano"
            name="framework"
            rev="2.0"/>

        <dependency org="com.fiorano"
            name="fmq-client"
            rev="9.3.0"/>

        <dependency org="commons-codec"
            name="commons-codec"
            rev="1.3"/>

        <dependency org="commons-httpclient"
            name="commons-httpclient"
            rev="3.1"/>

        <dependency org="commons-lang"
            name="commons-lang"
            rev="2.2"/>

        <dependency org="commons-pool"
            name="commons-pool"
            rev="1.4"/>
    </dependencies>
</ivy-module> 
```

当然，我还必须更改 by`build.xml`以删除对默认配置的引用：

```
 <ivy:resolve/>
 <ivy:cachepath pathid="all.libs"/> 
```

但是，现在看看包含的内容：

```
commons-all-4.1.jar
commons-codec-1.3.jar
commons-httpclient-3.1.jar
commons-lang-2.2.jar
commons-logging-1.0.4.jar
commons-pool-1.4.jar
fmq-client-9.3.0.jar
framework-2.0.jar
jms-4.5.2.jar
servlet-api-4.2.jar

commons-httpclient-3.1-sources.jar
commons-codec-1.3-javadoc.jar
commons-codec-1.3-sources.jar
commons-lang-2.2-javadoc.jar
commons-lang-2.2-sources.jar
commons-pool-1.4-sources.jar 
```

为什么，当我将所有内容设置为*default*时，只下载了实际的 jars 而不是 source 和 javadoc *jars*。然而，当我删除所有配置时，javadoc 和源*jar*也下载了。

其实Maven仓库中各种jar的配置存放在哪里呢？我可以在 Maven 存储库中看到 javadoc 和源代码，但我没有看到任何关于各种*配置*的信息。Ivy 如何知道是否包含*源代码*和*javadoc* jar？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:50:40.547

ivy中没有标准的默认[配置](https://ant.apache.org/ivy/history/trunk/ivyfile/configurations.html)。每个 ivy 文件在该部分中定义了自己的一组`conf`s `<configuration> ..</configuration>`。

在您的**第一个示例**中，您定义`default`并将其映射到`default`工件的配置。这些依赖项是 maven 工件，并且 ivy 将 maven 范围映射到`default`（Ivy 读取 maven pom 文件并在缓存中为其创建一个 ivy 文件）。所以基本上你很幸运，`default`conf 存在于配置的 ivy 文件中。

conf`default`是一个映射的 maven 范围，并不作为`conf`ivy 中的预定义标准存在。

在您的**第二个示例**中，您省略了`conf="default->default"`，[这等效于](https://ant.apache.org/ivy/history/trunk/ivyfile/configurations.html#defaultconfmapping) `conf="*->*"`并且意味着：将依赖项中的所有内容映射`conf`到此常春藤文件中的每个内容。

[这个问题回答了 ivy 如何将 maven 范围映射到 ivy 配置](https://stackoverflow.com/questions/7104364/how-are-maven-scopes-mapped-to-ivy-configurations-by-ivy)。

简而言之：

*   `default`映射到仅引用 jar 的 maven 范围默认值
*   声明 no scopes 映射到 ivy 配置`*`，它引用了所有可用的配置，因此也引用了所有可用的 Maven 工件。

# javascript - Javascript动画工具

> ID：11510763
> 
> 赞同：2
> 
> 时间：2012-07-16T18:58:46.783
> 
> 标签：javascript, animation, ide

是否有任何类似于 Flash 的编辑器或工具可以在 javascript 中生成动画？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:04:43.633

简单的动画可以在 jQuery 中完成。[http://api.jquery.com/category/effects/](http://api.jquery.com/category/effects/)

**[jQuery Transit](http://ricostacruz.com/jquery.transit/)**是一个简单有效的 JS 动画工具。它的**开源**并且在 GitHub 上可用： [https ://github.com/rstacruz/jquery.transit](https://github.com/rstacruz/jquery.transit)

**PS**：我知道您要求提供工具，但我向您展示了 jQuery Transit 中的框架。但是该框架非常简单，因此在其中编写代码比使用工具要快：P

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:04:19.460

[**煎茶动画师**](http://www.sencha.com/products/animator/)。如果你喜欢煎茶（我不喜欢）。不过，它是[商业许可](http://www.sencha.com/products/animator/license/)的。

此外，**Apple Keynote**可以将其神奇的动画优点导出到带有 CSS3 动画的 HTML 中。当然不是开源的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:00:40.927

我听说过[Edge](http://labs.adobe.com/technologies/edge/)，但我从未亲自尝试过。你可以试一试。不是开源的，但它是为 HTML5 制作的，与 Flash 不同。

# uiscrollview - 开始时从底部锚定的 UIScrollview

> ID：11510768
> 
> 赞同：0
> 
> 时间：2012-07-16T18:58:58.540
> 
> 标签：uiscrollview, anchor

我在 uiscrollview 中有一个真正高大的 uiimageview。滚动视图需要从图像视图（全屏）的底部开始，向下滚动时会显示顶部。但它只能让我向上滚动 - 这会将图像的底部移出屏幕。我知道这很容易，但我在这里间隔。

uiscroll 在 IB 中，在 viewdidload 中我执行以下操作：

```
 uisv_background.scrollEnabled = YES;
[uisv_background setDelegate:self];
self.uisv_background.contentSize = CGSizeMake(self.uisv_background.frame.size.width, 1024); 
```

因此，图像应该被“锚定”到 uiscrollview 的底部，并且下拉应该显示图像的顶部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:12:26.700

```
[self.uisv_background setContentOffset:CGPointMake(0,256)]; 
```

# silverlight - 在设计视图 Blend 4 中看不到 XAML

> ID：11510770
> 
> 赞同：1
> 
> 时间：2012-07-16T18:59:03.697
> 
> 标签：silverlight, expression-blend, silverlight-5.0, expression-blend-4

我已经安装了完整的 Expression Blend 4 Ultimate 包，我正在尝试加载 Silverlight 5 解决方案

虽然解决方案确实加载了我在设计视图中看不到任何东西

即使对于直接的“开箱即用”导航项目也会发生这种情况

我正在使用 VS 2010 SP1

有人遇到过这个问题吗？

我需要提到确保项目设置为 Silverlight，并确保安装了 blend 3 SDK

据我所知，这两个都适用

保罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:06:15.010

Silverlight 5 解决方案不会在 Expression Blend 4 中加载。

您需要下载 Expression Blend 5 预览版：

[www.microsoft.com/en-us/download/details.aspx?id=9503](http://www.microsoft.com/en-us/download/details.aspx?id=9503)

请注意，它有一些可能会影响您的视图的错误，主要是围绕从视图模型创建设计实例。

# ssis - SSIS 包将在一张表上成功，但不是全部？

> ID：11510771
> 
> 赞同：1
> 
> 时间：2012-07-16T18:59:09.790
> 
> 标签：ssis, bids, sql-job

请原谅我对这个主题的缺乏经验，因为这是我创建的第一个 SSIS 包。目标是基本上将架构/数据从 Access DB 复制到 SQL Server。我使用 BIDS 中的导入/导出向导来创建（总共有 470 个表）。如果我将其编写为仅执行一个表，则作业将运行并执行包，并且成功。当我尝试所有表时，我收到此错误：

> 以用户身份执行：DOMAIN\USER。Microsoft (R) SQL Server Execute Package Utility Version 10.50.2500.0 for 32-bit 版权所有 (C) Microsoft Corporation 2010。保留所有权利。开始时间：上午 11:47:53 错误：2012-07-16 11:48:03.65 代码：0xC0202009 源：数据流任务 1 目标 - 帐户 [55] 描述：SSIS 错误代码 DTS_E_OLEDBERROR。发生 OLE DB 错误。错误代码：0x80040E37。OLE DB 记录可用。源：“Microsoft SQL Server Native Client 10.0”Hresult：0x80040E37 描述：“无效的对象名称'dbo.Account'。”。结束错误错误：2012-07-16 11:48:03.65 代码：0xC0202040 源：数据流任务 1 目标 - 帐户 [55] 描述：无法打开“[dbo].[Account]”的快速加载行集。检查对象是否存在于数据库中。结束错误错误：2012-07-16 11:48:03.65 代码：0xC004706B 源：数据流任务 1 SSIS.Pipeline 描述：“组件“目标 - 帐户”(55)”验证失败并返回验证状态“VS_ISBROKEN”。结束错误错误：2012-07-16 11:48:03.65 代码：0xC004700C 源：数据流任务 1 SSIS.Pipeline 描述：一个或多个组件验证失败。End Error 错误：2012-07-16 11:48:03.65 代码：0xC0024107 来源：数据流任务 1 描述：任务验证期间出现错误。结束错误 DTExec：包执行返回 DTSER_FAILURE (1)。开始时间：上午 11:47:53 结束时间：上午 11:48:03 经过时间：10.562 秒。包执行失败。步骤失败。管道描述：“组件“目标 - 帐户”（55）”验证失败并返回验证状态“VS_ISBROKEN”。结束错误错误：2012-07-16 11:48:03.65 代码：0xC004700C 源：数据流任务 1 SSIS.Pipeline 描述：一个或多个组件验证失败。End Error 错误：2012-07-16 11:48:03.65 代码：0xC0024107 来源：数据流任务 1 描述：任务验证期间出现错误。结束错误 DTExec：包执行返回 DTSER_FAILURE (1)。开始时间：上午 11:47:53 结束时间：上午 11:48:03 经过时间：10.562 秒。包执行失败。步骤失败。管道描述：“组件“目标 - 帐户”（55）”验证失败并返回验证状态“VS_ISBROKEN”。结束错误错误：2012-07-16 11:48:03.65 代码：0xC004700C 源：数据流任务 1 SSIS.Pipeline 描述：一个或多个组件验证失败。End Error 错误：2012-07-16 11:48:03.65 代码：0xC0024107 来源：数据流任务 1 描述：任务验证期间出现错误。结束错误 DTExec：包执行返回 DTSER_FAILURE (1)。开始时间：上午 11:47:53 结束时间：上午 11:48:03 经过时间：10.562 秒。包执行失败。步骤失败。65 代码：0xC004700C 来源：数据流任务 1 SSIS.Pipeline 描述：一个或多个组件验证失败。End Error 错误：2012-07-16 11:48:03.65 代码：0xC0024107 来源：数据流任务 1 描述：任务验证期间出现错误。结束错误 DTExec：包执行返回 DTSER_FAILURE (1)。开始时间：上午 11:47:53 结束时间：上午 11:48:03 经过时间：10.562 秒。包执行失败。步骤失败。65 代码：0xC004700C 来源：数据流任务 1 SSIS.Pipeline 描述：一个或多个组件验证失败。End Error 错误：2012-07-16 11:48:03.65 代码：0xC0024107 来源：数据流任务 1 描述：任务验证期间出现错误。结束错误 DTExec：包执行返回 DTSER_FAILURE (1)。开始时间：上午 11:47:53 结束时间：上午 11:48:03 经过时间：10.562 秒。包执行失败。步骤失败。03 AM 经过：10.562 秒。包执行失败。步骤失败。03 AM 经过：10.562 秒。包执行失败。步骤失败。

作业的第一步从数据库中删除所有表。

```
EXEC sp_msforeachtable 'DROP TABLE ?' 
```

第二步执行包。

我在网上查遍了，一直没能找到解决办法。任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T05:33:27.290

对于第二个执行 SQL 任务，您必须将延迟验证属性设置为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-15T05:56:29.520

这花了我很*长时间*——几个月的时间——才弄清楚。

我在一个工作簿中将三个 SQL 数据表运行到三个 Excel 工作表中。我遇到了各种各样的数据损坏问题——在工作表之间，甚至是——以及 OLE 错误以及人们在这些线程中搜索的许多其他间歇性错误。

最后，问题是我将三个数据流嵌入到一个*数据*流中。事后看来，我想这很明显是个问题，但作为 SSIS 的新手，我认为处理过程会更深入地解决。错误的。

一旦我将流分成**三个连续**的数据流，一切都很好。

*后记*：在这个项目的过程中搞砸了 SSIS 之后，我确信它可能是我遇到的最简单的 MS 产品之一。太多的手动配置——当 SSIS 突然取消你所有繁琐的工作时重新配置！- 改变数据类型，将这个连接到那个。太可怕了。建议：尽可能避免。

# javascript - 有没有办法使用 unbind() 然后 bind() 和计时器？

> ID：11510774
> 
> 赞同：0
> 
> 时间：2012-07-16T18:59:28.990
> 
> 标签：javascript, jquery, timer, bind, unbind

如果条件为真，我想在所有链接上使用 unbind()，然后在 1.5 秒后再次绑定链接。我已经尝试过了，但它不起作用：

```
 if ( /*some condition*/) {
     $('a').unbind();
     setTimeout(function(){
     $('a').bind();
     }, 1500);
   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:02:39.077

您不能这样做，因为`.unbind()`删除了事件处理程序句号。有关他们的所有信息都将丢失。除非您已经在某处保存了单独的副本，否则您永远无法取回它们。

您*可以*做的是编写处理程序，使它们根据外部条件修改其行为。然后，您可以切换此条件，使其看起来好像处理程序根本没有绑定。

示例（*仅*用于说明；请不要使用全局变量！）：

```
$('a').click(function() {
    if (window.doNothing) {
        return;
    }
    // do something
});

if ( /*some condition*/) {
    window.doNothing = true;
    setTimeout(function(){
       window.doNothing = false;
    }, 1500);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:01:30.410

你需要`bind`一个特定的功能。

# android - 如何使用搜索对话框实现 AutoCompleteTextView

> ID：11510777
> 
> 赞同：0
> 
> 时间：2012-07-16T18:59:34.383
> 
> 标签：android

我想使用 Web 服务填充我的快速搜索框。我有一个网络服务，它从网络服务器中提取搜索数据以放入字符串数组中。我希望在用户输入搜索对话框时显示该数据列表。我相信默认的搜索对话框很简单`EditText`。如何将其设为“AutoCompleteTextView”并使用包含我的数据的字符串数组填充它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:06:34.280

首先，您必须解析来自网络服务的数据，然后将值/数据存储在字符串
示例中：`CricketTeams`

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                 android.R.layout.simple_dropdown_item_1line, CricketTeams);
         AutoCompleteTextView textView = (AutoCompleteTextView)
                 findViewById(R.id.countries_list);
         textView.setAdapter(adapter);
     } } 
```

板球队将从您的网络服务中获取数据。
更详细的例子[在这里](http://saigeethamn.blogspot.in/2010/05/auto-complete-text-view-android.html)

# mysql - 使用 where 子句搜索一对多数据库

> ID：11510785
> 
> 赞同：0
> 
> 时间：2012-07-16T18:59:55.703
> 
> 标签：mysql, sql, relational-database, normalization

我正在尝试构建一个查询，该查询将允许我拉出具有已定义属性的人。

```
+----------------------------------------------------+
TABLE: Person
+----------------------------------------------------+
owner_id | name
1        | kevin
2        | lee

+----------------------------------------------------+
TABLE: Attributes
+----------------------------------------------------+
id              | owner_id       | attributes_id
1               | 1              | 52
2               | 1              | 53
3               | 1              | 23
4               | 2              | 52

SELECT Person.name FROM Person LEFT JOIN `Attributes` ON `Attributes`.`owner_id` = `Person`.`owner_id` WHERE Attributes.attributes_id = 52 AND Attributes.attributes_id = 53; 
```

使用 where 子句没有返回 owner_id 1。如果有人能指出我正确的方向，我会非常感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:02:47.763

问题在于

```
WHERE Attributes.attributes_id = 52 AND Attributes.attributes_id = 53 
```

将其更改为

```
WHERE Attributes.attributes_id in (52,53) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T19:02:08.717

您是在告诉数据库同时查找两个不同事物的记录。单个字段不能**同时**是`52`AND `53`。但是，它可以是`OR`另一个，所以...

```
... WHERE Attributes.attributes_id = 52 OR Attributes.attributes_id = 53
or more succinctly
... WHERE Attributes.attributes_id IN (52, 53) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:09:26.823

```
SELECT Person.name 
FROM Person 
JOIN `Attributes` A1 ON A1.`owner_id` = `Person`.`owner_id` 
JOIN `Attributes` A2 ON A2.`owner_id` = `Person`.`owner_id` 
WHERE A1.attributes_id = 52 AND A2.attributes_id = 53; 
```

我假设您想要一个具有您列出的所有属性的人。我将您的左连接更改为内部连接，因为无论如何它都是有效的。您必须为所需的每个属性分别加入属性表。

另一种方法是：

```
SELECT Person.name 
FROM Person 
JOIN `Attributes`  ON `Attributes`.`owner_id` = `Person`.`owner_id` 
WHERE `Attributes`.attributes_id = 52 OR `Attributes`.attributes_id = 53
GROUP BY Person.name 
Having count(*) = 2; 
```

# javascript - 复制 JQuery/Javascript 函数

> ID：11510786
> 
> 赞同：0
> 
> 时间：2012-07-16T18:59:58.727
> 
> 标签：javascript, jquery

我有一个 jquery/javascript 函数，它创建一个数组以放置在表单的隐藏字段中。但是，这是一个嵌套表单，因此我需要多次调用此函数来填充所有子项的隐藏字段`test_suite_run[test_runs_attributes][//id][packages_id]`：这意味着我每次都需要使用不同的子 ID 运行此函数。

我已添加`//id`以指示许多函数调用之间的唯一区别。对于每个嵌套的子实例，我不知道如何在不手动复制多次并将 //id 替换为索引 0...n 的情况下复制此函数。这可以通过将参数传递给javascript函数来完成吗？

抱歉，如果这有点令人困惑，如果需要，我很乐意更详细地解释。

jQuery 函数

```
$(document).ready(function () {

    arr = new Array();

    $(document).on('change', 'select[id ^="s_package//id"]', function () {
        var arr = $('select[id ^="s_package//id"]').map(function () {
            return this.value
        })

        result = ""

        for (j = 0; j < arr.length - 1; j++) {
            result += (arr[j] + ", ");
        }

        result += (arr[arr.length - 1])

        $("input[name='test_suite_run[test_runs_attributes][//id][packages_id]']").val(result);

    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:29:43.287

您可以传递要在函数中使用的 id 数组并对其进行迭代：

```
function somethingMeaningful(ids) {
    for (var i = 0, l = ids.length; i < l; i++) {
        var id = ids[i];
        // do something with this id
    }
}

$(function() {
    somethingMeaningful(['id1', 'id2', 'idn']);
}); 
```

也可以简化选择器并在运行时计算 id，具体取决于它们的实际格式：

```
$(document).on('change', 'select[id^="s_package"]', function () {
    var id = $(this).attr('id').slice('s_package'.length);
    // Do stuff with real id
}); 
```

# java - 将 MapIterator 返回的 MultiKey 分解为各个键

> ID：11510788
> 
> 赞同：5
> 
> 时间：2012-07-16T19:00:08.733
> 
> 标签：java, apache-commons, apache-commons-collection

我正在使用 Apache Commons Collections 创建一个 MultiKeyMap，它将存储两个具有一个对应值的键，然后使用 MapIterator 遍历地图。我遇到的问题是我需要将 MapIterator 返回的键分解回单个键而不是单个“复合”。虽然我可以拆分包含“复合”键的字符串或使用反射，但这些选项都不是很优雅。

为了对问题进行建模，我创建了以下示例代码

```
MultiKeyMap multiKeyMap = new MultiKeyMap();

multiKeyMap.put("Key 1A","Key 1B","Value 1");
multiKeyMap.put("Key 2A","Key 2B","Value 2");
multiKeyMap.put("Key 3A","Key 3B","Value 3");

MapIterator it = multiKeyMap.mapIterator();

while (it.hasNext()) {
    it.next();
    System.out.println(it.getKey());
    System.out.println(it.getValue());
} 
```

`it.getKey()``myKey1 = it.getKey().keys[0]`返回 MultiKey[Key 3A, Key 3B] 但我想要做的是将键分配给单个变量，类似于`myKey2 = it.getKey().keys[1]`但我在 JavaDoc 中找不到任何东西来实现这一点。

是否可以在不使用反射或操作 it.getKey() 返回的字符串的情况下将 MapIterator 返回的键分解为单个键？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T20:42:05.207

我检查了commons 3.2 的[源代码](http://www.jarvana.com/jarvana/view/commons-collections/commons-collections/3.2/commons-collections-3.2-sources.jar!/org/apache/commons/collections/map/MultiKeyMap.java?format=ok)，MultiKeyMap 键是 MultiKey 的实例[，](http://www.jarvana.com/jarvana/view/commons-collections/commons-collections/3.2/commons-collections-3.2-sources.jar!/org/apache/commons/collections/keyvalue/MultiKey.java?format=ok)它有一个 getKey(int index) 方法。还有一个返回 Object[] 的 getKeys() 方法。它需要演员，但你可以这样做：

```
MultiKeyMap multiKeyMap = new MultiKeyMap();

multiKeyMap.put("Key 1A","Key 1B","Value 1");
multiKeyMap.put("Key 2A","Key 2B","Value 2");
multiKeyMap.put("Key 3A","Key 3B","Value 3");

MapIterator it = multiKeyMap.mapIterator();

while (it.hasNext()) {
    it.next();

    MultiKey mk = (MultiKey) it.getKey();

    // Option 1
    System.out.println(mk.getKey(0));
    System.out.println(mk.getKey(1));

    // Option 2
    for (Object subkey : mk.getKeys())
      System.out.println(subkey);

    System.out.println(it.getValue());
} 
```

# compiler-construction - Clang 中的语义分析步骤是编译器的重要组成部分吗？

> ID：11510792
> 
> 赞同：4
> 
> 时间：2012-07-16T19:00:28.670
> 
> 标签：compiler-construction, clang, semantic-analysis

我试图了解 Clang 的来龙去脉，但我不太确定“Sema”库。语义分析是否在编译器编译程序的路径中？还是只是程序员用来分析他/她的代码？

据我所知，解析器构建了一个 AST，然后有“AST 消费者”使用 AST 做不同的事情。因此，代码生成库将 AST 转换为 IR。语义分析库使用 AST 来分析代码。这种理解是正确的，还是语义分析器也用于编译？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:43:10.417

语义分析是编译分析过程的一部分，通常在词法和语法分析之后进行。语义分析器检查所用数据类型的有效性，进行类型转换等，如果有错误则报告错误。

换句话说，当涉及到语义分析时，编译器已经确定程序中使用了有效的词（词法），并且根据给定的语言语法（句法）正确地构建了句子。只剩下检查这些句子是否有意义——检查数据类型、返回值、大小边界、未初始化的变量等。

我对编译过程的了解对于 Clang 来说更笼统而非具体，但我认为语义分析肯定存在于代码分析中。

# php - 将 NSString 传递给 PHP POST 变量

> ID：11510801
> 
> 赞同：2
> 
> 时间：2012-07-16T19:01:02.243
> 
> 标签：php, objective-c, post, nsstring, asiformdatarequest

如果我的网站上有一个 php 文件，我如何将一个变量传递`NSString`给一个`POST`变量（使用objective-c），以便我可以将它回显到页面上？我是 php 新手，如果这很明显，我很抱歉。

使用`ASIFormDataRequest`：

```
NSURL *myURl = [[NSURL alloc] initWithString:@"http://www.mysite/something.php"];

ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:myURl];

[request setDelegate:self];
[request setUsername:@"username"];
[request setPassword:@"password"];
[request setPostValue:@"This is a string" forKey:@"phpVar"];

[request startAsynchronous]; 
```

委托方法调用：

```
-(void)requestFailed:(ASIHTTPRequest *)request
{
    NSError *error = [request error];
    NSLog(@"Failed %@ with code %d and with userInfo %@",[error domain],[error code],[error userInfo]);
}

-(void)requestFinished:(ASIHTTPRequest *)request
{
    NSLog(@"Finished : %@",[request responseString]);

} 
```

这里有几个问题：

1.  即使我输入了错误的凭据，也`requestFinished`只会被调用。

**编辑**——刚刚修复 (1)，创建了一个受密码保护的目录并将 php 文件粘贴在那里。

1.  “这是一个字符串”没有在 php 文件中传递给 phpVar 并且不会显示在页面上

这是我在php中写的：

```
<?php

$blah = $_POST['phpVar'];

echo $blah;

?> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T22:12:24.737

这个过程可能会在几个不同的地方发生故障。

1.  由于您试图在 ASIFormDataRequest 实例中设置文字，我们可以放心地假设它实际上包含该值。
2.  下一个要验证的项目是 POST 实际上是在访问 PHP 页面（但不一定传递正确的值）。有几种方法可以做到这一点，但最简单的可能是查看 Web 服务器的访问日志。如何完成此操作将因服务器（即 Apache、IIS 等）而异。
3.  如果脚本确实点击了页面，最后一步应该是验证传递了什么（如果有的话）请求参数。我建议您通过像这样的函数调用呼应它们来更广泛地查看所有请求值，而不是转储 $_POST 形式的奇异值：

.

```
<?php
var_dump($_REQUEST);
?> 
```

这应该详细地打印出 $_GET、$_POST 和 $_COOKIE 中的所有内容，以防万一值没有通过 POST 发送，正如您所期望的那样。如果该值存在，访问它或修改发送请求的方式应该很简单，以便按预期交付。

# android - ImageView 不会填充父级

> ID：11510804
> 
> 赞同：9
> 
> 时间：2012-07-16T19:01:10.693
> 
> 标签：android, scrollview, android-relativelayout

我的一个屏幕上有一个 ScrollView。我希望右边缘有阴影。我决定最简单的方法是让 ScrollView 的子级成为 RelativeLayout，并有两个 RelativeLayout 的子级 - 一个是 LinearLayout，它将容纳屏幕的布局，第二个 View 是阴影。

像这样...

```
<ScrollView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:scrollbars="none" >

            <RelativeLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" >

                <LinearLayout
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:orientation="vertical" >
                <!-- stuff -->
                </LinearLayout>

                <ImageView
                    android:layout_width="wrap_content"
                    android:layout_height="fill_parent"
                    android:src="@drawable/shadow"
                    android:layout_alignParentRight="true"
                    />
            </RelativeLayout>
        </ScrollView> 
```

不幸的是，这并不完全奏效。ImageView 强制其尺寸为图像文件的大小。它不会垂直拉伸到RelativeLayout 的高度。我也试过“match_parent”无济于事。图像是一个 9-patch。

想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-16T19:35:17.690

将可绘制内容应用为`ImageView`某种程度的来源带有一个内在要求，即您希望视图尽其所能容纳内容，而无需对内容本身进行太多修改。通常，这是您希望从`ImageView`.

您真正想要的是通过将可绘制内容设置为`background`视图获得的行为，您根本不需要`ImageView`。背景旨在简单地拉伸、填充等到视图的任何大小。此外，由于您正在使用，您可以通过添加一个和一些额外参数`RelativeLayout`来告诉视图与您正在遮蔽的视图的边界相匹配。`id``layout_align`

```
 <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <LinearLayout
                android:id="@+id/content_layout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical" >
            <!-- stuff -->
            </LinearLayout>

            <View
                android:layout_width="11dp"
                android:layout_height="fill_parent"
                android:layout_alignParentRight="true"
                android:layout_alignTop="@id/content_layout"
                android:layout_alignBottom="@id/content_layout"
                android:background="@drawable/shadow"
                />
        </RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-16T19:14:50.067

试试这个

```
<ImageView
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:background="@drawable/ic_launcher"
                android:scaleType="fitXY"
                android:layout_alignParentRight="true"
                /> 
```

这是我得到的

![在此处输入图像描述](../Images/d8b65487168c713a9bbf1aa67f321021.png)

和代码 id

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:fillViewport="true"
    android:scrollbars="none" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <!-- stuff -->
        </LinearLayout>

        <ImageView
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_alignParentRight="true"
            android:background="@drawable/ic_launcher"
            android:scaleType="fitXY" />
    </RelativeLayout>
</ScrollView> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:31:31.140

您的问题与 or 9-patch 本身无关`ImageView`，而是与您将所有内容都包装在`ScrollView`. A`ScrollView`将自动强制其~~子~~级直接子级包装其内容，无论您是否告诉它`FILL_PARENT`或`MATCH_PARENT`- 顺便说一句，两者都做完全相同的事情；唯一的区别是名称，它更好地反映了标志的实际行为。

幸运的是`ScrollView`，它提供了一种强制它用标志填充视口的方法，这将使行为与设置`FILL_PARENT`为常规视图非常相似。添加属性[`android:fillViewport`](http://developer.android.com/reference/android/widget/ScrollView.html#attr_android%3afillViewport)或[`setFillViewport()`](http://developer.android.com/reference/android/widget/ScrollView.html#setFillViewport%28boolean%29)从代码中使用。

**编辑：**为了清楚起见，您需要在`ScrollView`. 另外，如果它`ScrollView`应该有阴影，你能不把你的 9-patch 作为背景发送给它吗？我想这确实取决于您的实际图像的外观。关于您的评论：是的，RelativeLayout 在定位和调整子项大小方面是灵活的，但任何子项仍将绑定到其父项的大小。

我确实感觉我们中的一些人可能正在朝着与您的想法不同的方向努力。用一张简单的图画肯定会有助于澄清事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:11:33.000

您想要图像右侧的阴影，然后使用带有`Horizontal Orientation`的单一布局，您决定使用相对布局很好。采用

```
android:orientation="vertical" 
```

在此布局中，添加这两个图像。如果您仍有疑问，请给我那两张图片或示例图片，我会给您代码

# gcc - 安装scrapy的问题..缺少gcc 4.0

> ID：11510809
> 
> 赞同：0
> 
> 时间：2012-07-16T19:01:17.703
> 
> 标签：gcc, scrapy

我在使用easy_install 安装scrapy 时遇到问题，我得到：

无法执行 gcc-4.0：没有这样的文件或目录错误：安装脚本退出并出现错误：命令“gcc-4.0”失败，退出状态为 1

我有 gcc-4.2。我一直在尝试降级到 gcc-4.0 但想不出办法...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T21:08:56.257

您需要设置环境：

*   首先，[为 Xcode 安装命令行工具](https://developer.apple.com/downloads/index.action?name=for%20Xcode%20-)（我不能 100% 确定您可以在没有 XCode 的情况下安装，如果不能，则从 App Store 安装 XCode）。
*   然后安装[MacPorts](http://www.macports.org/)

要完成 macports 设置，请在 Terminal.app 中运行以下命令：

```
% sudo port selfupdate 
```

如果你完成了，那么你可以从 macports 安装 scapry：

```
% sudo port install py27-scrapy 
```

之后，您应该能够`scrapy`在 Terminal.app 中使用命令。

# android - Android 动态壁纸在单独的线程中绘制

> ID：11510810
> 
> 赞同：0
> 
> 时间：2012-07-16T19:01:18.233
> 
> 标签：android, multithreading, performance, drawing

我正在开发一个支持多点触控的动态壁纸。对于屏幕上的每个手指，它会在大位图上绘制一个小位图。

壁纸现在已经准备好了，但是当你用两个或更多手指触摸它时，壁纸会变慢，启动器也会变慢。

是否可以在单独的线程中绘制壁纸或防止启动器变慢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T07:19:30.513

我正在使用 OpenGL ES 2.0 和自定义片段着色器绘制壁纸，这样更快

# javascript - 滑动 jQuery 菜单

> ID：11510811
> 
> 赞同：1
> 
> 时间：2012-07-16T19:01:21.133
> 
> 标签：javascript, jquery, html, css

我正在尝试制作一个 jQuery 下拉菜单（更像是右下拉！）菜单。我需要的是，当鼠标悬停在主页按钮上时（例如），其他按钮滑出，内容框滑入。

我希望黑匣子（内容）从按钮的末尾滑入。对，框从屏幕的左边缘滑入......但我不希望那个框位于“主页”按钮下方，我希望它在它旁边。

这是我的小提琴：http: [//jsfiddle.net/TvNcD/](http://jsfiddle.net/TvNcD/)

它现在有问题......但我认为修复起来相当简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:41:50.883

希望它对你有用，虽然我认为应该有更好的方法来使用 CSS3 来做到这一点...... [http://jsfiddle.net/TvNcD/18/](http://jsfiddle.net/TvNcD/18/)

# android - 有没有办法从 Android 的自定义相机视图中删除暂停按钮？

> ID：11510816
> 
> 赞同：1
> 
> 时间：2012-07-16T19:01:30.643
> 
> 标签：android, android-camera, android-camera-intent

我正在构建一个使用手机相机功能的 Android 应用程序。我知道有一种方法可以构建自定义相机视图。相反，我选择通过意图使用相机应用程序，而不是构建自己的相机视图。我想在拍摄视频时禁用/使暂停按钮消失，并且只有停止按钮。我在 www.developer.android.com 上查找了相机 API 指南，但它没有说明我该如何做到这一点。有谁知道这样做的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:41:10.257

我不认为这是可能的。使用 Intents 只是告诉 Android “嘿，我想拍摄视频（照片，查看 MapView 等）。你能为我做吗？”的一种方式。根据用户安装的应用程序，它可能会触发一个或多个应用程序监听该 Intent。通常您只能通过 Intents 选择非常基本的选项，即拍摄视频/图片或告诉 MapView 它应该显示在哪个位置。这些选项在正常使用过程中通常也会出现在 App 内部。我从来没有看到没有暂停按钮的“CustomCamera-App”，或者可以在菜单中停用它的地方。因此，可以设置该特殊选项的机会趋于零。

# javascript - 有没有办法检测 Flash 视频何时播放完毕？

> ID：11510818
> 
> 赞同：0
> 
> 时间：2012-07-16T19:01:34.423
> 
> 标签：javascript, flash, actionscript

我在一个嵌入了来自许多不同网站的视频的网站上工作，来源的数量达到了数千个。对于 YouTube，他们的 JavaScript API 提供了一种检测视频何时结束的方法，并且可以在那个时候执行他想要的任何功能。但这仅适用于 youtube 视频。其他人呢？

那么是否有一种全局适用的方法来检测页面上的 Flash 视频何时停止使用 javascript 或动作脚本播放？“停止播放”是指在播放到结尾时停止播放，而不仅仅是中途暂停。

`<div>`PS 在页面上总是会有一个带有 id的嵌入视频`video`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:13:32.340

就像 YouTube 提供 API 一样，那些来自外部网站的播放器也必须提供自己的 API。没有一个简单的万能的解决方案可以在 JavaScript 中实现。

# mysql - 计算表中的唯一字符串

> ID：11510822
> 
> 赞同：1
> 
> 时间：2012-07-16T19:01:47.970
> 
> 标签：mysql

我有下表（是的，id_str 是格式化为文本的整数）：

```
messages
-------------------------
id (INT) id_str (VARCHAR)
-------------------------
1        3245346543343247
2        3245346543343247
3        3245346543343247
4        1214354546578886
5        9979679595696599
6        9979679595696599 
```

所需的输出是所有唯一 id_str 的计数：

```
id_str            cnt
---------------------
3245346543343247  3
1214354546578886  1
9979679595696599  2 
```

我正在尝试使用以下查询来完成此操作：

```
SELECT DISTINCT(id_str) AS id_str, COUNT(id) FROM messages 
```

但这会按原样返回确切的表格，消息总数作为第二列。我在拧什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T19:03:30.370

您需要使用`GROUP BY`：

```
SELECT id_str, COUNT(id) as cnt
FROM messages
GROUP BY id_str 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:04:38.107

尝试这个：

```
SELECT id_str AS id_str, COUNT(id) 
FROM messages group by id_str 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:05:21.333

这将为您提供 id_str 的每个不同值的行数。请注意，这将计算所有行。

```
SELECT id_str, COUNT(1) AS cnt FROM messages GROUP BY id_str 
```

如果您只想计算给定表达式不为空的行（例如，where`id`不为空），则可以将 COUNT 聚合应用于该表达式。只有表达式具有非 NULL 值的行才会包含在计数中（因此，在某些情况下，实际上可能返回零计数）：

```
SELECT id_str, COUNT(id) AS cnt FROM messages GROUP BY id_str 
```

（当然，如果`id`保证列不为空，那么这两个将返回相同的结果。）

注意：您不需要 DISTINCT 关键字，GROUP BY 子句可以满足您的需要。

您的查询相当于：

```
SELECT DISTINCT id_str, COUNT(id) FROM messages 
```

DISTINCT 关键字作用于 SELECT 列表中的所有表达式，而不仅仅是第一个。第一个表达式周围的括号不会改变行为。 `DISTINCT`是保留字，不是函数调用。查询中的`AS id_str`别名仅分配给 id_str 列，该列恰好包含在不必要的（但合法且允许的）括号中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:02:55.013

你需要一个group by。

```
SELECT DISTINCT(id_str) AS id_str, COUNT(id) FROM messages GROUP BY id_str 
```

# intersystems-cache - 保存使用缓存 sql 存储的缓存对象时更改 RowIds

> ID：11510823
> 
> 赞同：0
> 
> 时间：2012-07-16T19:01:54.800
> 
> 标签：intersystems-cache

首先，我为这个问题的长度表示歉意。我以下列方式进行了全局设置：

```
^WHEAIPP(1,116444,1)=3
^WHEAIPP(1,116444,1,1)="58898^^LSWELFER^58898,0"
^WHEAIPP(1,116444,1,2)="58898^59128^MPHILLIPS^59135,0"
^WHEAIPP(1,116444,1,3)="62626^62745^FXALTMAN^62626,58427^^^^^^2^"
^WHEAIPP(1,116444,2)=3
^WHEAIPP(1,116444,2,1)="59129^^MPHILLIPS^59910,0^^^^^^"
^WHEAIPP(1,116444,2,2)="59129^59547^SSNARE^59934,0^^^^^^"
^WHEAIPP(1,116444,2,3)="59129^62954^FXALTMAN^62654,32289^^^^^^3^"
^WHEAIPP(1,116444,3)=4
^WHEAIPP(1,116444,3,1)="60311^^SALFANO^60311,0^^^^^^"
^WHEAIPP(1,116444,3,2)="60311^^SSNARE^60754,0^^^^^^2"
^WHEAIPP(1,116444,3,3)="60311^^NEPAXSON^60757,0^^^^^^2"
^WHEAIPP(1,116444,3,4)="60311^62636^FXALTMAN^62626,58428^=^100^=^25^^5"
^WHEAIPP(1,116444,4)=4
^WHEAIPP(1,116444,4,1)="59548^^SSNARE^59550,0"
^WHEAIPP(1,116444,4,2)="59548^60310^SSNARE^59934,0^^^^^^2"
^WHEAIPP(1,116444,4,3)="62626^^FXALTMAN^62626,61050^^^^^^^1"
^WHEAIPP(1,116444,4,4)="62617^62647^FXALTMAN^62627,27518^^^^^^4" 
```

第一个下标是内部 Hmo，第二个是内部提供，第三个是行号，最后一个是行详细信息号。第 4 下标级别的数据是行的组合审计跟踪历史记录，最高行详细编号为当前行。

我有 3 个具有父子关系的类设置如下： 主类

```
Class XFXA.Try3.IppProv Extends (%Persistent, %Populate, %XML.Adaptor) [ ClassType =    
  persistent, Inheritance = right, ProcedureBlock, SqlRowIdName = Id, StorageStrategy   
  = SQLMapping ]
{

Property Hmo As %Integer [ Required ];

Property Keen As %Integer [ Required ];

/// Contains the array of data initially loaded into the class
Property OriginalData As %String [ MultiDimensional ];

Property ReadyToFile As %Boolean [ InitialExpression = 0, Transient ];

Relationship IppLines As XFXA.Try3.IppProvLine [ Cardinality = children, Inverse =    
relIppProv ];

Index iMaster On (Hmo, Keen) [ IdKey, PrimaryKey, Unique ];
.
.
.
<Storage name="SQLMapping">
<DataLocation>^[%extRef("UCKE"),%extRef("SYKE")]WHEAIPP</DataLocation>
<ExtentSize>100000</ExtentSize>   
<SequenceNumber>19</SequenceNumber>
<SQLMap name="DBMS">
<Global>^[%extRef("UCKE"), %extRef("SYKE")]WHEAIPP</Global>
<Structure>delimited</Structure>
<Subscript name="1">
<Expression>{Hmo}</Expression>
</Subscript>
<Subscript name="2">
<Expression>{Keen}</Expression>
</Subscript>
<Type>data</Type>
</SQLMap>
<StreamLocation>^XFXA.Try3.IppProvS</StreamLocation>
<Type>%Library.CacheSQLStorage</Type>
</Storage>
} 
```

线类

```
Class XFXA.Try3.IppProvLine Extends (%Persistent, %Populate, %XML.Adaptor) [ ClassType 
= persistent, Inheritance = right, ProcedureBlock, SqlRowIdName = Id, StorageStrategy 
=SQLMapping ]
{

Relationship relIppProv As XFXA.Try3.IppProv [ Cardinality = parent, Inverse = 
IppLines ];

Relationship IppLineDetail As XFXA.Try3.IppProvLineDetail [ Cardinality = children, 
Inverse = relIppProvLinex ];

Property Line As %String;

Property IppLineDetailCount As %String;

Index iMaster On Line [ IdKey, PrimaryKey, Unique ];
.
.
.
<Storage name="SQLMapping">
<ExtentSize>100000</ExtentSize>
<SequenceNumber>14</SequenceNumber>
<SQLMap name="DBMS">
<Data name="IppLineDetailCount">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>1</Piece>
</Data>
<Global>^[%extRef("UCKE"), %extRef("SYKE")]WHEAIPP</Global>
<Structure>delimited</Structure>
<Subscript name="1">
<Expression>{XFXA_Try3.IppProv.Hmo}</Expression>
</Subscript>
<Subscript name="2">
<Expression>{XFXA_Try3.IppProv.Keen}</Expression>
</Subscript>
<Subscript name="3">
<Expression>{Line}</Expression>
</Subscript>
<Type>data</Type>
</SQLMap>
<StreamLocation>^XFXA.Try3.IppProvLineS</StreamLocation>
<Type>%Library.CacheSQLStorage</Type>
</Storage>
} 
```

Line Detail Class Class XFXA.Try3.IppProvLineDetail Extends (%Persistent, %XML.Adaptor) [ ClassType = persistent, Inheritance = right, ProcedureBlock, SqlRowIdName = Id, StorageStrategy = SQLMapping ] {

```
Relationship relIppProvLinex As XFXA.Try3.IppProvLine [ Cardinality = parent, Inverse = 
IppLineDetail ];

Property LnDetail As %String;

Index iMaster On LnDetail [ IdKey, PrimaryKey, Unique ];
.
.
.
<Storage name="SQLMapping">
<ExtentSize>100000</ExtentSize>
<SQLMap name="DBMS">
<Data name="ClmAmtAllowed">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>6</Piece>
</Data>
<Data name="ClmLineAmtAllowed">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>8</Piece>
</Data>
<Data name="ClmLineOp">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>7</Piece>
</Data>
<Data name="ClmOp">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>5</Piece>
</Data>
<Data name="Deleted">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>11</Piece>
</Data>
<Data name="EffDt">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>1</Piece>
</Data>
<Data name="IppCode">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>10</Piece>
</Data>
<Data name="LastChgDt">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>4</Piece>
</Data>
<Data name="PxDxCdeFlag">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>9</Piece>
</Data>
<Data name="TermDt">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>2</Piece>
</Data>
<Data name="UserIni">
<Delimiter>"^"</Delimiter>
<Node>+0</Node>
<Piece>3</Piece>
</Data>
<Global>^[%extRef("UCKE"), %extRef("SYKE")]WHEAIPP</Global>
<Structure>delimited</Structure>
<Subscript name="1">
<Expression>{XFXA_Try3.IppProv.Hmo}</Expression>
</Subscript>
<Subscript name="2">
<Expression>{XFXA_Try3.IppProv.Keen}</Expression>
</Subscript>
<Subscript name="3">
<Expression>{XFXA_Try3.IppProvLine.Line}</Expression>
</Subscript>
<Subscript name="4">
<Expression>{LnDetail}</Expression>
</Subscript>
<Type>data</Type>
</SQLMap>
<StreamLocation>^XFXA.Try3.IppProvLineDetails</StreamLocation>
<Type>%Library.CacheSQLStorage</Type>
</Storage>
} 
```

当用户标记要删除的行时，在第 4 下标级别的当前详细信息行中将已删除标志设置为 1，如果该行不是最后一行，则归档代码移动到最后一行。如果我尝试在我的主类的删除方法中执行此操作，我会收到一条错误消息，指出不允许更新 RowIds。这是因为我试图操纵线类的 Line 属性移动线以将删除的线推到最后。对文档的检查发现 AllowRowIDUpdate 带有一些警告，但不清楚如何使用它的示例。有谁知道实现这一目标的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:47:44.717

好吧， AllowRowIDUpdate 上的文档说

> “仅当您在 BEFORE 触发器中进行自己的归档并使用 %SkipFiling 标志时才设置为 1。否则，使用默认值 0”。

如果您在 BEFORE 触发器中进行自己的归档并使用 %SkipFiling 标志，那么您通常不会使用 SQL 存储来存储数据，您只是公开自己的存储以便可以通过 SQL 使用它。

我建议最简单的方法是不更新 RowID。不要使用更新，而是使用插入和删除来移动行。这本质上与使用直接全局访问必须做的事情相同，因为您本身也无法更新下标。

此外，这超出了您的问题范围，但如果可以的话，我是否会考虑不同的存储。无论如何，当行号确实存储在某种类似 BTree 的结构中时，移动行号以便没有间隙似乎并没有太大的作用，所以也许你可以留下间隙？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:27:51.327

使用不需要更改的合成/代理键几乎总是更好。

# security - 如何获取库/可执行文件的可执行代码部分的大小？

> ID：11510831
> 
> 赞同：0
> 
> 时间：2012-07-16T19:02:06.560
> 
> 标签：security, executable, ldd

我正在分析各种代码库的可执行文件大小，并且我正在寻找有关库或可执行文件的可执行部分有多大的数据。我知道我可以通过查看来获得一个想法`/proc/xxx/maps`，但是有什么可以明确告诉我的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T14:44:08.940

原来这`size xxx`会给你。

# autohotkey - 自动热键 - 热键组合的输入 - 暂停一键 - 贯穿键

> ID：11510836
> 
> 赞同：1
> 
> 时间：2012-07-16T19:02:18.173
> 
> 标签：autohotkey

我如何能：

1.  读取（等待并记录）单次按下（即 Shift-Alt-F5 ）
2.  将此记录的组合键传递给程序（即 Photoshop），而不将其作为热键运行。

我试过这个，但它不适用于我的非 ASCII 热键。它适用于 t 热键。

```
F6::
Suspend, On
Input, OutputVar, L1 M
Send, %OutputVar% 
Suspend, Off
return

F5::Run explorer
t::Run notepad
!+5::Run cmd 
```

*   F5 是运行程序资源管理器的热键。
*   F6 是一个热键，一按即可暂停所有热键。并通过组合键作为非热键
*   当我在 Firefox 中时，如果我按 F6 F5 它将进入 Firefox 的刷新页面操作。
*   当我按 F5 时，没有前面的 F6，它将打开资源管理器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T11:29:51.467

根据您的笔记，我认为您想要执行以下操作。使用 #r 阻止任何输入并启动脚本，然后当您再次按 #r 时，脚本将停止并恢复输入。在这种情况下，你可以试试这个：

```
#Singleinstance force
$#r::
If (MyToggle := !MyToggle) ; Toggle the value MyToggle True/False
    {
        ToolTip,Input  blocked [Win]+r,A_ScreenWidth/2-50,0
        BlockInput, on ; In Vista and above, you need to run AHK as admin or run AHK in compatility mode with Windows XP SP 3
        SetTimer RunMyScript, 500 ; Start the actual script in 500 ms outside of this script, so you can toggle
        Return
    }
Else
    {
        Tooltip
        BlockInput, off
        ;Reload ; This will KILL the "RunMyScript" IMMEDIATELY at an unpredictable location.
        Return
    }
return

RunMyScript: ; This script runs independently from the script above. The script stops after 10 loops and resets the input. [Ctrl]+[Alt]+[Del] still kills any script.
SetTimer RunMyScript, Off ; Turn the 500 ms timer off
loop, 10
{
    if (!MyToggle) ; Check the MyToggle variable to see if you need to stop the script. This will Exit the script at a predictable location.
        Exit

    SoundBeep, 600,600
    Sleep, 1000
}
BlockInput, off ; Allow keyboard & mouse input again. Warning the [Win] key key may be left activated, causing keyboard actions to start applications
Tooltip
Return 
```

让我知道这是否是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:03:43.677

两种解决方案。

1.  将要捕获的热键添加到输入中，如下所示：

    ```
    Input, OutputVar, L1, {LControl}{RControl}{LAlt}{RAlt}{LShift}{RShift}{LWin}{RWin}{AppsKey}{F1}{F2}{F3}{F4}{F5}{F6}{F7}{F8}{F9}{F10}{F11}{F12}{Left}{Right}{Up}{Down}{Home}{End}{PgUp}{PgDn}{Del}{Ins}{BS}{Capslock}{Numlock}{PrintScreen}{Pause} 
    ```

否则，这些非 ascii 键将被输入忽略。

或者，使 F5 键应用程序的行为特定。

```
SetTitleMatchMode, 2
#IfWinNotActive, Firefox
    F5::Run explorer
#IfWinNotActive 
```

这样，您的`F5`密钥将始终启动 IE，除非您在 Firefox 中工作，然后`F5`重新`F5`加载您的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T08:09:29.293

可以通过这种方式将内容写入日志文件。在这里，我每天都会创建一个新的日志文件，并且对于每个条目，您必须重复最后两行（以获取实际时间）。

```
FormatTime, DateRef, %TimeNow%, yyyyMMdd ; Store current date in variable DateRef
MyLogFile = %A_ScriptDir%\LogFiles\LogFile-%DateRef%.txt ; Define the name of the log file.
FormatTime, TimeAbsolute, %TimeNow%, HH:mm:ss ; Use the current time to set the timestamp variable called TimeAbsolute used inside the Log File
FileAppend, `n`r| %TimeAbsolute% | Your hotkey and possibly in which application`n`r,%MyLogFile% ; Write logfile 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-28T10:25:25.963

我还没有检查过这个，但我认为这就是你要找的......

```
FormatTime, DateRef, %TimeNow%, yyyyMMdd ; Store current date in variable DateRef
MyLogFile = %A_ScriptDir%\LogFiles\LogFile-%DateRef%.txt ; Define the name of the log file.
FileAppend, `n`r| %TimeAbsolute% | Your hotkey and possibly in which application`n`r,%MyLogFile% ; Write logfile
Suspend, on ; Start with hotkeys disabled
Return

Pause:: ; Use pause key to 'activate' the hotkeys
Suspend, Off ; Activate the hotkeys
SetTimer, Stop, 10000 ; If no hotkey is pressed within 10 seconds, deactivate the hotkeys aagain
Return

Stop: ; Deactivate the hotkeys
Suspend, on ; Deactivate the hotkeys
SetTimer, Stop, Off ; turn the stop timer off
Return

q:: ; use a key (q) as a hotkey
Soundbeep, 600,600 ; sound a short beep to show that it works
HotKeyType = "q key"
WinGet, ApplicationType, ProcessName, A
GoSub, Write
Return

Write:
SetTimer, Stop, Off ; Make sure that the stop timer is turned off
FormatTime, TimeAbsolute, %TimeNow%, HH:mm:ss ; Use the current time to set  the timestamp variable called TimeAbsolute used inside the Log File
FileAppend, `n`r| %TimeAbsolute% | %HotKeyType% used in %ApplicationType%`n`r,%MyLogFile% ; Write logfile
Suspend, On ; Disable the hotkeys again
Exit 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-28T19:19:15.213

好吧，我认为这是最终的脚本......

通常，除非您按 F6，否则所有键都照常运行，然后在 3 秒钟内您可以使用热键。一旦您使用热键，行为就会再次恢复正常（3 秒仅在您不按热键的情况下）。当您按两次 F6 时，它将发送 F6。如果您找到了更简单的解决方案，请告诉我，因为这相对复杂。

```
FormatTime, DateRef, %TimeNow%, yyyyMMdd ; Store current date in variable DateRef
MyLogFile = %A_ScriptDir%\LogFile-%DateRef%.txt ; Define the name of the log file for today.
FormatTime, TimeAbsolute, %TimeNow%, HH:mm:ss
FileAppend, | %TimeAbsolute% | Your hotkey and possibly in which application`n`r,%MyLogFile% ; Write logfile
SpecialF6:=1
Suspend, On
Return

$F6::
Suspend, Permit
If SpecialF6
{
Suspend, Off
ToolTip Hotkeys On for 3 seconds,A_ScreenWidth/2-50,0
SpecialF6:=0
SetTimer, SuspendOn, 3000
Return
}
else
{
    Send, {F6}
    MyText = F6
    Gosub, WriteClose
}
Return

SuspendOn:
Suspend, On
SetTimer, SuspendOn, Off
ToolTip
SpecialF6:=1
return

F5::
Run explorer
MyText = F5 Run Explorer
Gosub, WriteClose
Return

t::
Run notepad
MyText = t Run Notepad
Gosub, WriteClose
Return

!+5::
Run cmd
MyText = Alt Shift 5 Run Command
Gosub, WriteClose
return

WriteClose:
Suspend, On
SetTimer, SuspendOn, Off
FormatTime, TimeAbsolute, %TimeNow%, HH:mm:ss
ToolTip
SpecialF6:=1
FileAppend, | %TimeAbsolute% | %MyText%`n`r,%MyLogFile% ; Write logfile
Exit 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-28T16:11:06.203

关于记录密钥，我专门将要在日志文件中打印的密钥类型定义为文本字符串，这样您就可以为每个不可打印的密钥定义自己的文本。

我用以下方式重新编写了脚本：当您按 F6 一次，然后按另一个键（在本例中为 F5）时，它将发出哔声（充当热键）。如果你按 F6 两次，if 将发送 F6，就好像没有设置热键一样。如果在没有先按 F6 的情况下按 F5，它只会发送 F5，就好像没有激活热键一样。希望这是你想要的......

```
$F6::
If (MySuspend := !MySuspend) ; Toggle the value MySuspend True/False
{
        ToolTip Hotkeys On (F6),A_ScreenWidth/2-50,0
}
Else
{
    Tooltip
    Send, {F6}
}
return

$F5::
If MySuspend
{
    SoundBeep, 600, 600
    MySuspend := 0
    ToolTip
}
else
{
    Send, {F5}
}
Return 
```

# python - Python 在类中执行函数

> ID：11510837
> 
> 赞同：1
> 
> 时间：2012-07-16T19:02:24.833
> 
> 标签：python, file, class

我正在努力了解如何有效地使用类。我编写了一个程序，希望计算 .txt 文件中短语或单词的出现次数。

我不太确定如何正确调用该函数，任何帮助将不胜感激。

谢谢。

```
class WordCounter:
    def The_Count(self):  
        print "Counting words..."       
        txt_doc = open("file")

        for line in txt_doc:
            if "word" in txt_doc:
                word_freq = word_freq + 1
                return word_freq

        print "Frequency of word: %s" % word_freq 
```

WordCounter.The_Count

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:17:55.833

使用类与您在这里尝试做的有点不同。更多地考虑在代码中保留变量和对象的状态。为了完成你的任务，更像下面的东西会起作用：

```
class CountObject(object):
    """Instance of CountObject for measuring file lengths"""
    def __init__(self, filename):
        self.filename = filename
    def getcount(self, word):
        count = 0
        infile = open(self.filename,'r')
        for line in infile.readlines():
            x = line.count(word)
            count = count + x
        return count

mycounter = CountObject('C:\list.txt')
print 'The occcurence of awesome is %s' %(str(mycounter.getcount('in'))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:17:59.403

首先，只是为了在名称上达成一致，类中的函数称为该类的*方法*。

在您的示例中，您的方法执行计算单词出现次数的操作，因此为了更清楚，您可以简单地调用您的方法`count`。另请注意，在 Python 中，方法名称以小写开头是一种[约定。](http://www.python.org/dev/peps/pep-0008/#method-names-and-instance-variables)

此外，使用所谓[的新样式类](http://docs.python.org/release/2.7/reference/datamodel.html#newstyle)是一种很好的做法，它们只是继承自`object`.

最后，在 Python 中，一个方法需要至少有一个参数，[按约定](http://docs.python.org/release/2.7/tutorial/classes.html#random-remarks)调用`self`，并且应该是该类的一个实例。

因此，如果我们应用这些更改，我们会得到类似的结果：

```
class WordCounter(object):

    def count(self):  
        print "Counting words..."

        # Rest of your code
        # ... 
```

现在你的类有了一个方法，你首先需要创建你的类的一个实例，然后才能调用它的方法。因此，要在 Python 中创建类的实例`Foo`，您只需调用`Foo()`. 一旦你有了你的实例，你就可以调用你的方法。使用您的示例

```
# Create an instance of your class and save it in a variable
my_word_counter = WordCounter()
# Call your method on the instance you have just created
my_word_counter.count() 
```

请注意，您不需要为 self 传递参数，因为[Python 解释器将替换](http://docs.python.org/release/2.7/tutorial/classes.html#method-objects) `self`为您的值`word_counter`，即它调用`WordCounter.count(my_word_counter)`.

### 关于 OO 的说明

其他人已经注意到，您的示例在 Python 中不是很好地使用类。OO 类旨在将行为（实例方法）与它们交互的数据（实例属性）放在一起。您的示例是一个简单的示例，没有与您的类相关联的真实内部数据。一个好的警告可能是您从不`self`在方法中使用。

对于与某些特定数据无关的行为，Python 为您提供了编写模块级函数的灵活性 - 相反，Java 强制您将所有内容都放在类中。

正如其他人所建议的那样，为了使您的示例更加面向对象，您可以将文件名作为参数传递给`__init__`并将其另存为`self.filename`. 可能更好的是让您`WordCounter`期望一个类似文件的对象，以便它不负责打开/关闭文件本身。就像是：

```
class WordCounter(object):

    def __init__(self, txt_doc):
        self.word_file = txt_doc

    def count(self):
        print "Counting words..."       

        for line in self.txt_doc:
            # Rest of your code
            # ...

with open(filename) as f:
    word_counter = WordCounter(f)
    word_counter.count() 
```

最后，如果你想了解更多关于 Python 类的详细信息，一个很好的信息来源总是[官方文档](http://docs.python.org/release/2.7/tutorial/classes.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:08:50.643

要调用类中的方法，首先必须创建该类的实例：

```
c = WordCounter() 
```

然后在该实例上调用该方法：

```
c.TheCount() 
```

但是，在这种情况下，您实际上并不需要课程；这可以只是一个顶级功能。当您希望每个对象都有自己的内部状态时，类是最有用的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:12:35.557

您在这里有几个问题，您发布的代码不是正确的python。类方法应该引用 self 作为参数：

```
def The_Count(self): 
```

您需要为没有字数的情况初始化 word_freq：

```
word_freq = 0 
```

正如其他人所提到的，您可以这样调用您的函数：

```
counter = WordCounter()
print(counter.The_Count()) 
```

将这些类型的无状态函数包装在类中并不是真正惯用的 Python，就像你在 Java 或其他东西中可能做的那样。我会把这个函数分成一个模块，让调用类处理文件 I/O 等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T19:19:17.663

对于这样一个小程序，可能不需要使用类。您可以简单地定义该函数，然后调用它。

但是，如果您想实现一个类设计，您可以使用（在类定义之后）：

```
if __name__ == "__main__":

wc = WordCounter() #create instance
wc.TheCount() #call method 
```

如果您以后想进一步扩展类的功能，则使用类设计将使用更好的设计原则，同时增加代码的可读性/灵活性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T19:21:52.473

在这种情况下，您必须将代码更改为：

```
class WordCounter:
    def CountWords(self):
        # For functions inside classes, the first parameter must always be `self`
        # I'm sure there are exceptions to that rule, but none you should worry about
        # right now.
        print "Counting words..."          
        txt_doc = open("file")   
        word_freq = 0

        for line in txt_doc:   
            if "word" in line:   # I'm assuming you mean to use 'line' instead of 'txt_doc'
                word_freq += 1   
                # count all the words first before returning it

        txt_doc.close()          # Always close files after you open them.  
                                 # (also, consider learning about the 'with' keyword)

        # Either print the frequency
        print "Frequency of word: %s" % word_freq 
        # ...or return it.
        return word_freq 
```

......然后打电话给它，你会做......

```
>>> foo = WordCounter()  # create an instance of the class
>>> foo.CountWords()     # run the function 
```

正如其他海报所指出的，这*不是*类的最有效用途。如果你把它变成一个顶级函数会更好，并将其更改为：

```
def CountWords(filename, word):
    with open(filename) as txt_doc:
        word_freq = 0
        for line in txt_doc:
            if word in line:
                word_freq += 1
    return word_freq 
```

...并这样称呼它：

```
>>> output = CountWords("file.txt", "cat")
>>> print "Frequency of word: %s" % output
39 
```

* * *

如果您有类似下面的内容，那么使用类会更有意义，其中有一堆变量和函数都与一个概念“对象”相关：

类 FileStatistics: def **init** (self, filename): self.filename = filename

```
def CountWords(self, word):
    pass   # Add code here...

def CountNumberOfLetters(self):
    pass

def AverageLineLength(self):
    pass

# ...etc. 
```

# android - 在 android API 版本 8/9 中，选择时的 ListView 项目着色无法正常工作

> ID：11510841
> 
> 赞同：3
> 
> 时间：2012-07-16T19:02:39.087
> 
> 标签：android, android-listview

我目前正在使用 ListView 来显示一种项目。我已经实现了一个动作模式来选择多个项目并大量删除，这在 android 4.x 中运行良好。但是当我尝试使用 API 版本 8 或 9 (android 2.2.x/2.3.x) 时，选择在内部按预期工作，但行项目的颜色是随机的。

如果用户选择第一行，则在内部选择第一行，但第 4 行是彩色的。当我单击另一行时，这一行和第一行是彩色的。这是一种奇怪的行为，我希望在 4.x 设备上正常工作。

长按覆盖以激活动作模式并检查 ListView 的长按项：

```
@Override
public boolean onItemLongClick(AdapterView<?> adapterView, View view, int position, long id) {
    if (actionMode == null) {
        listView.setOnItemClickListener(new CABClickListener());
        actionMode = startActionMode(new ListActionMode());
        // Check item pressed with long click
        listView.setItemChecked(position, true);
        view.setBackgroundColor(checkedColor);
        logger.debug("Item at pos. " + position + ", checked.");
    }
    return true;
} 
```

CABClickListener，负责勾选/取消勾选 ListView 的项目，在内部标记它们并改变它的背景颜色：

```
private final class CABClickListener implements AdapterView.OnItemClickListener {
    @Override
    public void onItemClick(AdapterView<?> adapterView, View view, int position, long id) {
        if (listView.isItemChecked(position)) {
            view.setBackgroundColor(checkedColor);
            logger.debug("Item at pos. " + position + ", checked.");
        } else {
            view.setBackgroundColor(uncheckedColor);
            logger.debug("Item at pos. " + position + ", unchecked.");
        }
    }
} 
```

这些类/方法在 Activity 内部，`listView`在其顶部声明。

更多注意事项：

*   使用 ActionBarSherlock（它显示了 CAB，但我认为这在这里并不重要）和 Roboguice，但我对此没有任何问题。
*   ~~我一直在用模拟器开发。此外，我无法使用 android 3.x 尝试我的应用程序（此版本出现问题，模拟器无法启动），所以我不知道这些版本是否仍然存在问题。~~更新：在 android 3.0 API 11 中测试，在 4.x 上运行良好。
*   我调试了代码，`View`两种方法中的 s 都可以，但是当我调用 时 `view.setBackgroundColor(checkedColor);`，另一个`View`是彩色的。

有什么建议吗？希望任何人都可以提供帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T18:44:17.607

哇，问题出在我自己的实现中`ArrayAdapter`，我尝试应用视图持有者模式。我最初放弃了这个，因为我用一个简单的方法测试了它`ArrayAdapter`，问题仍然存在。

android API 的区别在于，在 8-10 API 中单击 item 时，会重新绘制所有列表，重用现有视图。因此，当您单击一个项目（视图）时，它是彩色的，但 android 会立即重新绘制所有列表，重用视图，并使彩色视图处于其他位置。当在 >11 API 中单击列表视图项时，会重新绘制任何内容（是的，版本之间的性能改进很大）并且正确的项视图已成功绘制（正确调用`view.setBackgroundColor(checkedColor)`）。

最后，我解决了这种奇怪的行为，将检查状态存储在实体中。这样，当必须回收视图时，可以恢复检查值并且可以毫无问题地为列表项着色。

我发布了我的 GenericListAdapter.getView() 方法和相关的任何感兴趣的人。

`GenericListAdapter<T>.getView()`：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ItemViewHolder<T> viewHolder = null;

    if (convertView == null || !(convertView.getTag() instanceof ItemViewHolder<?>)) {
        logger.debug("New view: " + convertView + " at position: " + position);
        LayoutInflater mInflater = LayoutInflater.from(context);
        convertView = mInflater.inflate(resource, null);

        viewHolder = GenericViewHolderFactory.createInstance(clazz);
        viewHolder.setContext(context);
        viewHolder.saveViewContents(convertView);

        convertView.setTag(viewHolder);
    } else {
        logger.debug("Reusing view: " + convertView + ", at position: " + position);
        viewHolder = (ItemViewHolder<T>) convertView.getTag();
    }

    T entity = getItem(position);
    viewHolder.setViewFields(entity, convertView);

    return convertView;
} 
```

以及`ViewHolder`刷新回收视图的实现：

```
public class EventItemViewHolder implements ItemViewHolder<Event> {

...

    @Override
    public void setViewFields(Event event, View convertView) {
        name.setText(event.getName());
        amount.setText(event.getTotalAmount().toString());

        if (event.isChecked()) {
            convertView.setBackgroundColor(checkedColor);
        } else {
            convertView.setBackgroundColor(uncheckedColor);
        }
    }
} 
```

我希望我已经很好地解释了自己。

# javascript - 访问/更改同一页面上另一个 Web 部件中的类的 html

> ID：11510847
> 
> 赞同：0
> 
> 时间：2012-07-16T19:03:13.447
> 
> 标签：javascript, jquery, sharepoint, dom, sharepoint-2007

我的页面上的 webpart 中有一个 div `class='myDiv'`。我需要从我希望使用 javascript/jquery 的页面上的另一个 Web 部件访问该 div。由于它们不在同一个页面实用程序中，因此我无法使用 jquery 直接选择它，例如： `$('.myDiv').hide()`. 如何从我在同一页面上工作的 web 部件的另一个 web 部件中找到这个 div

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T10:07:02.157

最好为 div 控件提供一个 ID，然后使用下面的 javascript 访问其他控件来获取该控件。

```
var h = document.getElementsByTagName("input");
for (var i = 0; i < h.length; i++) {
    var j = h[i].id;
    if (j.indexOf('file') > 0) {
        alert(j);
    }
} 
```

# python - Python - Facebook API - 需要一个工作示例

> ID：11510850
> 
> 赞同：40
> 
> 时间：2012-07-16T19:03:32.627
> 
> 标签：python, facebook, api, signature, pyfacebook

好的，所以我用谷歌搜索了，我在 stackoverflow 上找到了线程，我已经检查了官方的 Facebook wiki 和.. 还有什么不是..

我现在希望你们中的一个人坐在 Python 的 Facebook API 示例代码上。这是我到目前为止所得到的，我得到的只是通过 PyFacebook 获得的“无效签名”，这似乎是一个死项目：

```
from facebook import Facebook

api_key = '123456789______'
secret  = '<proper secret key>'
OTK = 'XXXXX' # <-- You get this from: https://www.facebook.com/code_gen.php?v=1.0&api_key=123456789______
long_term_key = None

fb = Facebook(api_key, secret)

def generate_session_from_onetime_code(fb, code):
    fb.auth_token = code
    return fb.auth.getSession()
if not long_term_key:
    long_term_key = generate_session_from_onetime_code(fb, OTK)['session_key']
    print 'Replace None with this in the .py file for long_term_key:'
    print long_term_key

fb.session_key = long_term_key
fb.uid = 000000001  # <-- Your user-id
fb.signature = api_key # <-- This doesn't work at all, MD5 of what?
#fb.validate_signature(fb) # <-- doesn't work either, prob need to pass MD5 handle?
print fb.friends.get() # <-- Generates "Invalid Signature" 
```

我想要的“全部”是现在检索我的朋友列表，如果有更好的 API 将我指向正确的方向，但 Facebook 已正式宣布他们自己的 Python SDK 已死，而 pyfacebook 几乎对我有用，但并不完全......

所以，请帮忙。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-07-16T19:48:24.103

python sdk的[非官方分支](https://github.com/pythonforfacebook/facebook-sdk)对我来说仍然可以正常工作。

要检索您的朋友，请在此处生成访问令牌： [https ://developers.facebook.com/tools/access_token/](https://developers.facebook.com/tools/access_token/)

限制：

*   查看当前人的好友需要具有 user_friends 权限的用户访问令牌。
*   这只会返回任何使用（通过 Facebook 登录）提出请求的应用程序的朋友。
*   如果此人的朋友拒绝 user_friends 权限，该朋友将不会出现在此人的朋友列表中。

代码

> ```
> import facebook
> 
> token = 'your token'
> 
> graph = facebook.GraphAPI(token)
> profile = graph.get_object("me")
> friends = graph.get_connections("me", "friends")
> 
> friend_list = [friend['name'] for friend in friends['data']]
> 
> print friend_list 
> ```

# java - 在 java 和 android 中使用 final 变量的替代方法？

> ID：11510853
> 
> 赞同：0
> 
> 时间：2012-07-16T19:03:34.970
> 
> 标签：java, android, android-listview, final

我在构建的应用程序中遇到了问题，该问题似乎与我在内存中使用太多最终变量有关，当我在 android 2.3 及以下版本中测试该应用程序时，它工作正常，但 4.0 及以上版本的应用程序在一段时间后崩溃，如果列表太长了，我想弄清楚的是一种方法，我可以绕过使变量成为最终变量，或者一旦它们不在视图中就可能使它们为空？下面是我的代码，任何帮助都会有很大帮助，谢谢

```
 public View getView(int position, View convertView, ViewGroup parent) {
    View vi = convertView;
    final String url = (String) data.get(position).get(4);
    final String aviUrl = (String) data.get(position).get(2);
    final Date theTime = (Date) data.get(position).get(3);
    final String theTweetText = (String) data.get(position).get(1);
    final String theRealName = (String) data.get(position).get(0);
    final String theScreenName = (String) data.get(position).get(5);
    Boolean isRetweeted = (Boolean) data.get(position).get(6);
    final Long iD = (Long) data.get(position).get(7);
    final Integer totalTweets = (Integer) data.get(position).get(8);
    final Integer totalFollowers = (Integer) data.get(position).get(9);
    final Integer totalFollowing = (Integer) data.get(position).get(10);
    final Long tweetId = (Long) data.get(position).get(11);
    Date currentDate = new Date();

    if (convertView == null)
        vi = inflater.inflate(R.layout.item, null);

    if (isRetweeted == true) {
        final String theRetweetedTxt = (String) data.get(position).get(12);
        final String theRetweetedUser = (String) data.get(position).get(13);
        final String theRetweetedImgUrl = (String) data.get(position).get(14);
        final String theRetweetedScreenName = (String) data.get(position).get(15);
        final Long rTiD = (Long) data.get(position).get(16);
        final Integer rTtotalTweets = (Integer) data.get(position).get(17);
        final Integer rTtotalFollowers = (Integer) data.get(position).get(18);
        final Integer rTtotalFollowing = (Integer) data.get(position).get(19);
        final Long rtTweetId = (Long) data.get(position).get(20);

        TextView theTweet = (TextView) vi.findViewById(R.id.tweet_text);
        TextView username = (TextView) vi.findViewById(R.id.username);
        TextView realname = (TextView) vi.findViewById(R.id.realname);
        TextView theTimeTv = (TextView) vi.findViewById(R.id.theTime);

        ImageView aviimage = (ImageView) vi.findViewById(R.id.user_avatar);
        ImageView image = (ImageView) vi.findViewById(R.id.imageView1);
        ImageView retweeterimage = (ImageView) vi
                .findViewById(R.id.retweeter_avatar);
        ImageView replyImage = (ImageView) vi.findViewById(R.id.mentionbutton);
        ImageView retweetImage = (ImageView) vi.findViewById(R.id.retweetbutton);

        RelativeLayout profileImageLayout = (RelativeLayout) vi.findViewById(R.id.profileimagelayout);

        profileImageLayout.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                Context context = v.getContext();
                Intent intent=new Intent(context, FriendProfileActivity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                intent.putExtra("theuserid", rTiD);
                intent.putExtra("totaltweets", rTtotalTweets);
                intent.putExtra("totalfollowers", rTtotalFollowers);
                intent.putExtra("totalfollowing", rTtotalFollowing);
                intent.putExtra("useravatar", theRetweetedImgUrl);
                intent.putExtra("username", theRetweetedUser);
                intent.putExtra("screenname", theRetweetedScreenName);
                intent.putExtra("tweetid", rtTweetId);

                context.startActivity(intent);
            }
        });

        image.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                Context context = v.getContext();
                Intent intent=new Intent(context, LightboxActivity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

                intent.putExtra("thetweet", theRetweetedTxt);
                intent.putExtra("theimage", url);
                intent.putExtra("theuserid", rTiD);
                intent.putExtra("screenname", theRetweetedScreenName);
                intent.putExtra("tweetid", rtTweetId);

                context.startActivity(intent);
            }
        });

        replyImage.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                Context context = v.getContext();
                Intent intent=new Intent(context, TweetScreenActivity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                intent.putExtra("theuserid", rTiD);
                intent.putExtra("screenname", theRetweetedScreenName);
                intent.putExtra("tweetid", rtTweetId);
                intent.putExtra("isretweet", false);

                context.startActivity(intent);
            }
        });

        retweetImage.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {                   
                Context context = v.getContext();
                Intent intent=new Intent(context, TweetScreenActivity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                intent.putExtra("theuserid", rTiD);
                intent.putExtra("screenname", theRetweetedScreenName);
                intent.putExtra("tweetid", rtTweetId);
                intent.putExtra("isretweet", true);
                intent.putExtra("thetweet", theRetweetedTxt);

                context.startActivity(intent);
            }
        });

        String str = (String) DateUtils.getRelativeTimeSpanString(theTime.getTime(), currentDate.getTime(),
                0L, DateUtils.FORMAT_ABBREV_ALL);

        theTimeTv.setText(str);
        theTweet.setText(theRetweetedTxt);
        username.setText("RT by @" + theScreenName);
        realname.setText("@" + theRetweetedScreenName);

        imageLoader.DisplayImage(theRetweetedImgUrl, aviimage);
        imageLoader.DisplayImage(url, image);
        imageLoader.DisplayImage(aviUrl, retweeterimage);
        return vi;
    } else {
        TextView theTweet = (TextView) vi.findViewById(R.id.tweet_text);
        TextView username = (TextView) vi.findViewById(R.id.username);
        TextView realname = (TextView) vi.findViewById(R.id.realname);
        TextView theTimeTv = (TextView) vi.findViewById(R.id.theTime);

        ImageView aviimage = (ImageView) vi.findViewById(R.id.user_avatar);
        ImageView image = (ImageView) vi.findViewById(R.id.imageView1);
        ImageView replyImage = (ImageView) vi.findViewById(R.id.mentionbutton);
        ImageView retweetImage = (ImageView) vi.findViewById(R.id.retweetbutton);

        RelativeLayout profileImageLayout = (RelativeLayout) vi.findViewById(R.id.profileimagelayout);

        profileImageLayout.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                Context context = v.getContext();
                Intent intent=new Intent(context, FriendProfileActivity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                intent.putExtra("theuserid", iD);
                intent.putExtra("totaltweets", totalTweets);
                intent.putExtra("totalfollowers", totalFollowers);
                intent.putExtra("totalfollowing", totalFollowing);
                intent.putExtra("useravatar", aviUrl);
                intent.putExtra("username", theRealName);
                intent.putExtra("screenname", theScreenName);
                intent.putExtra("tweetid", tweetId);

                context.startActivity(intent);
            }
        });

        image.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                Context context = v.getContext();
                Intent intent=new Intent(context, LightboxActivity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

                intent.putExtra("thetweet", theTweetText);
                intent.putExtra("theimage", url);
                intent.putExtra("theuserid", iD);
                intent.putExtra("screenname", theScreenName);
                intent.putExtra("tweetid", tweetId);

                context.startActivity(intent);
            }
        });

        replyImage.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                Context context = v.getContext();
                Intent intent=new Intent(context, TweetScreenActivity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                intent.putExtra("theuserid", iD);
                intent.putExtra("screenname", theScreenName);
                intent.putExtra("tweetid", tweetId);
                intent.putExtra("isretweet", false);

                context.startActivity(intent);
            }
        });

        retweetImage.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {                   
                Context context = v.getContext();
                Intent intent=new Intent(context, TweetScreenActivity.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                intent.putExtra("theuserid", iD);
                intent.putExtra("screenname", theScreenName);
                intent.putExtra("tweetid", tweetId);
                intent.putExtra("isretweet", true);
                intent.putExtra("thetweet", theTweetText);

                context.startActivity(intent);
            }
        });

        ImageView retweeterimage = (ImageView) vi
                .findViewById(R.id.retweeter_avatar);
        retweeterimage.setImageBitmap(null);

        String str = (String) DateUtils.getRelativeTimeSpanString(theTime.getTime(), currentDate.getTime(),
                0L, DateUtils.FORMAT_ABBREV_ALL);

        theTimeTv.setText(str);
        theTweet.setText(theTweetText);
        username.setText(theRealName);
        realname.setText("@" + theScreenName);

        imageLoader.DisplayImage(aviUrl, aviimage);
        imageLoader.DisplayImage(url, image);
        return vi;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:06:48.930

'final' 关键字不会影响任何东西，它基本上只是告诉 JVM 该值不会改变，所以你的问题出在其他地方。

# mysql - 如何在mysql中匹配

> ID：11510855
> 
> 赞同：3
> 
> 时间：2012-07-16T19:03:39.263
> 
> 标签：mysql, sql

我有两张表，一张是候选人和他们的技能，另一张是工作和工作所需的技能，如下图所示：

CSID = 候选人技能 ID (PK)
CID = 候选人 ID (FK)
S_CODE = 技能代码 (FK)

这是候选技能表

```
+------------+---------+---------+
| CSID       | CID     |  S_CODE |
+------------+---------+---------+
| 1          | 1       | 5       |
| 2          | 1       | 9       |
| 3          | 2       | 5       |
| 4          | 2       | 10      |
+------------+---------+---------+ 
```

SJID = 技能作业 ID (PK)
JID = 作业 ID (FK)
S_CODE = 技能代码 (FK)

这是 Skill_job 表：

```
+------------+---------+---------+
| SJID       | JID     |  S_CODE |
+------------+---------+---------+
| 12         | 50      | 5       |
| 13         | 50      | 9       |
| 14         | 51      | 1       |
| 15         | 52      | 10      |
+------------+---------+---------+ 
```

因此，在此示例中，职位 50 的唯一候选人将是 1，因为两者的技能代码 (S_CODE) 都是 5 和 9，但我也希望候选人 2 与 52 匹配，因为它具有所需的工作技能和一个额外的。我尝试了几种方法来匹配工作和候选人，但我失败了，这种方法的一个例子是下面的代码：

```
 SELECT * , COUNT(skill_job.S_CODE) AS cnt FROM candidate_skill,
 skill_job WHERE candidate_skill.S_CODE = skill_job.S_CODE HAVING (cnt >=2) 
```

问题是，这只将找到的候选人限制为一个，如果我删除 COUNT 子句，它会列出所有仅与一项技能匹配的候选人，因此候选人 2 也将与工作 50 匹配。

这是来自 phpmyadmin 的表的 mysql 代码：

```
 -- phpMyAdmin SQL Dump
-- version 3.4.5
-- http://www.phpmyadmin.net
--
-- Host: localhost
-- Generation Time: Jul 16, 2012 at 09:27 PM
-- Server version: 5.5.16
-- PHP Version: 5.3.8

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;

--
-- Database: `employment`
--

-- --------------------------------------------------------

--
-- Table structure for table `candidate`
--

CREATE TABLE IF NOT EXISTS `candidate` (
  `CID` int(4) NOT NULL AUTO_INCREMENT,
  `title` varchar(5) NOT NULL,
  `fname` varchar(30) NOT NULL,
  `lname` varchar(30) NOT NULL,
  `dob` date NOT NULL,
  `email` varchar(50) NOT NULL,
  `address` varchar(255) NOT NULL,
  `city` varchar(50) NOT NULL,
  `postcode` varchar(10) NOT NULL,
  `phone_num` varchar(11) NOT NULL,
  `username` varchar(40) NOT NULL,
  `password` varchar(40) NOT NULL,
  `regdate` datetime NOT NULL,
  `acc_type` enum('c','s') NOT NULL DEFAULT 'c',
  `emailactivate` enum('0','1') NOT NULL DEFAULT '0',
  `cv_name` varchar(60) NOT NULL,
  `cv` blob NOT NULL,
  PRIMARY KEY (`CID`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 COMMENT='// this is the table for the candidates' AUTO_INCREMENT=175 ;

--
-- Dumping data for table `candidate`
--

INSERT INTO `candidate` (`CID`, `title`, `fname`, `lname`, `dob`, `email`, `address`, `city`, `postcode`, `phone_num`, `username`, `password`, `regdate`, `acc_type`, `emailactivate`, `cv_name`, `cv`) VALUES
(128, 'Mr', 'clement', 'Chilingulo', '0000-00-00', 'chlngl@yahoo.com', '28 oakfield Road', 'london', 'E6 1LW', '07771611873', 'casante', 'b59c67bf196a4758191e42f76670ceba', '0000-00-00 00:00:00', 'c', '0', '', '');
INSERT INTO `candidate` (`CID`, `title`, `fname`, `lname`, `dob`, `email`, `address`, `city`, `postcode`, `phone_num`, `username`, `password`, `regdate`, `acc_type`, `emailactivate`, `cv_name`, `cv`) VALUES
(134, 'Mr', 'rverv', 'revrb', '0000-00-00', 'tdbsdrt', 'trsbrtd', 'trbtrtrb', 'tbrfbgrts', 'trfbtrgbrfg', 'clement', 'b59c67bf196a4758191e42f76670ceba', '0000-00-00 00:00:00', 's', '0', '', '');
INSERT INTO `candidate` (`CID`, `title`, `fname`, `lname`, `dob`, `email`, `address`, `city`, `postcode`, `phone_num`, `username`, `password`, `regdate`, `acc_type`, `emailactivate`, `cv_name`, `cv`) VALUES
(165, 'Mr', 'oinInINOioni', 'ioin', '0000-00-00', 'inioimn', 'in', 'oin', 'oni', 'io', 'k', '7b8b965ad4bca0e41ab51de7b31363a1', '0000-00-00 00:00:00', 'c', '0', '', ''),
(166, 'Mr', 'pjINoNlkinoinoi', 'ino', '0000-00-00', 'oimpnponi', 'inoi', 'no', 'nj', 'nio', 'nio', 'eb5bc837d01b911029ae378e8a1c9f5d', '0000-00-00 00:00:00', 'c', '0', '', ''),
(167, 'Mr', 'vrae', 'ergvaer', '0000-00-00', 'aerbg', 'aergvera', 'aergvrea', 'aergvear', 'aergarev', 'grebvarvf', '609c1b136ec8d0d2dfdf9a2105fb605f', '0000-00-00 00:00:00', 'c', '0', '', ''),
(168, 'Mr', 'vrae', 'ergvaer', '0000-00-00', 'aerbg', 'aergvera', 'aergvrea', 'aergvear', 'aergarev', 'grebvarvf', '609c1b136ec8d0d2dfdf9a2105fb605f', '0000-00-00 00:00:00', 'c', '0', '', ''),
(169, 'Mr', 'ubp', 'bu', '0000-00-00', 'ubip', ';ub', 'ubi', 'ubo', 'buo', 'ubiipbu', '9f44ce1389a3e7372834ed730b559a5e', '0000-00-00 00:00:00', 'c', '0', '', ''),
(170, 'Mr', 'rvev', 'ferhbgetb', '0000-00-00', 'tsbtrb', 'trbstrb', 'trbsfb ', 'stb stb', 'vvfs', 'csdcdsvarewdcv', 'd41d8cd98f00b204e9800998ecf8427e', '0000-00-00 00:00:00', 'c', '0', '', ''),
(171, 'Mr', 'rvev', 'ferhbgetb', '0000-00-00', 'tsbtrb', 'trbstrb', 'trbsfb ', 'stb stb', 'vvfs', 'csdcdsvarewdcv', 'd41d8cd98f00b204e9800998ecf8427e', '0000-00-00 00:00:00', 'c', '0', '', ''),
(172, '', '', '', '0000-00-00', '', '', '', '', '', '', 'd41d8cd98f00b204e9800998ecf8427e', '0000-00-00 00:00:00', 'c', '0', '', ''),
(173, '', 'dds', 'vrv av', '0000-00-00', 'rvear', 'vreverav', 'rvedfsdv', 'frvdvf', 'fveavd', 'vdrareavdv', '84c71ac76340092398a1ed4bc7d6fe19', '0000-00-00 00:00:00', 'c', '0', '', ''),
(174, '', 'dds', 'vrv av', '0000-00-00', 'rvedwear', 'vreverav', 'rvedfsdv', 'frvdvf', 'fveavd', 'vdraredfcavdv', 'd41d8cd98f00b204e9800998ecf8427e', '0000-00-00 00:00:00', 'c', '0', '', '');

-- --------------------------------------------------------

--
-- Table structure for table `candidate_skill`
--

CREATE TABLE IF NOT EXISTS `candidate_skill` (
  `CSID` int(4) NOT NULL AUTO_INCREMENT,
  `CID` int(4) NOT NULL,
  `S_CODE` int(4) NOT NULL,
  PRIMARY KEY (`CSID`),
  KEY `CID` (`CID`),
  KEY `S_CODE` (`S_CODE`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 COMMENT='//match candidate and skill' AUTO_INCREMENT=131 ;

--
-- Dumping data for table `candidate_skill`
--

INSERT INTO `candidate_skill` (`CSID`, `CID`, `S_CODE`) VALUES
(114, 134, 2),
(116, 134, 9),
(121, 134, 5),
(126, 128, 1);

-- --------------------------------------------------------

--
-- Table structure for table `job`
--

CREATE TABLE IF NOT EXISTS `job` (
  `JID` int(4) NOT NULL AUTO_INCREMENT,
  `job_title` varchar(40) NOT NULL,
  `job_desc` varchar(255) NOT NULL,
  `start_date` date NOT NULL,
  `end_date` date NOT NULL,
  PRIMARY KEY (`JID`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 COMMENT='// this is the table for the job vacancies' AUTO_INCREMENT=10 ;

--
-- Dumping data for table `job`
--

INSERT INTO `job` (`JID`, `job_title`, `job_desc`, `start_date`, `end_date`) VALUES
(1, 'engineer', ' fix engineering ish that is messed ', '0000-00-00', '0000-00-00'),
(5, 'pilot', '', '0000-00-00', '0000-00-00'),
(8, 'Charity Helper', ' ', '0000-00-00', '0000-00-00'),
(9, 'accountant', '  ', '0000-00-00', '0000-00-00');

-- --------------------------------------------------------

--
-- Table structure for table `skill`
--

CREATE TABLE IF NOT EXISTS `skill` (
  `S_CODE` int(4) NOT NULL AUTO_INCREMENT COMMENT '// this is the skill primary key',
  `skill_name` varchar(40) NOT NULL,
  `skill_desc` varchar(255) NOT NULL,
  PRIMARY KEY (`S_CODE`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=11 ;

--
-- Dumping data for table `skill`
--

INSERT INTO `skill` (`S_CODE`, `skill_name`, `skill_desc`) VALUES
(1, 'speaking', 'English is your first language'),
(2, '  writing', 'You can write English very well'),
(3, ' public', ''),
(5, 'initiative', ''),
(6, 'interviewing', ''),
(7, 'negotiating', ''),
(8, 'leading', ''),
(9, '  energy', ''),
(10, ' organisation', '');

-- --------------------------------------------------------

--
-- Table structure for table `skill_job`
--

CREATE TABLE IF NOT EXISTS `skill_job` (
  `SJID` int(4) NOT NULL AUTO_INCREMENT,
  `JID` int(4) NOT NULL,
  `S_CODE` int(4) NOT NULL,
  PRIMARY KEY (`SJID`),
  KEY `S_CODE` (`S_CODE`),
  KEY `JID` (`JID`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=106 ;

--
-- Dumping data for table `skill_job`
--

INSERT INTO `skill_job` (`SJID`, `JID`, `S_CODE`) VALUES
(91, 5, 2),
(94, 5, 5),
(95, 5, 9),
(98, 1, 1),
(102, 1, 8),
(105, 8, 8);

--
-- Constraints for dumped tables
--

--
-- Constraints for table `candidate_skill`
--
ALTER TABLE `candidate_skill`
  ADD CONSTRAINT `candidate_skill_ibfk_3` FOREIGN KEY (`CID`) REFERENCES `candidate` (`CID`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `candidate_skill_ibfk_4` FOREIGN KEY (`S_CODE`) REFERENCES `skill` (`S_CODE`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `skill_job`
--
ALTER TABLE `skill_job`
  ADD CONSTRAINT `skill_job_ibfk_4` FOREIGN KEY (`JID`) REFERENCES `job` (`JID`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `skill_job_ibfk_5` FOREIGN KEY (`S_CODE`) REFERENCES `skill` (`S_CODE`) ON DELETE CASCADE ON UPDATE CASCADE;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:31:53.573

双重否定是你的朋友（虽然我对 MySQL 的了解还不足以判断它是否支持它）：

```
SELECT DISTINCT CS.CID, SJ.JID
FROM CANDIDATE_SKILL CS
JOIN SKILL_JOB SJ ON CS.S_CODE = SJ.S_CODE
WHERE NOT EXISTS(SELECT 1
                 FROM SKILL_JOB SJ2
                 WHERE SJ.JID = SJ2.JID
                   AND NOT EXISTS(SELECT 1
                                  FROM CANDIDATE_SKILL CS2
                                  WHERE CS.CID = CS2.CID
                                    AND SJ2.S_CODE = CS2.S_CODE)) 
```

对此的“人工翻译”是说不应该存在候选人不具备的工作所需的任何技能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:11:47.990

似乎您需要使用[INNER JOIN](http://www.w3schools.com/sql/sql_join_inner.asp)来组合您的两个表，然后比较它们的行值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:18:17.147

应该是这样的。。

```
SELECT
   CID
FROM 
   candidate_skill
WHERE
   S_CODE IN (
               SELECT S_CODE FROM skill_jobs where JID = 52 
             )
GROUP BY CID 
```

更正：先前的查询将无法匹配所有必需的 S_CODE

```
SELECT
   CID, COUNT(CSID) as cnt
FROM 
   candidate_skill
INNER JOIN skill_jobs 
WHERE
   S_CODE IN (
               SELECT S_CODE FROM skill_jobs where JID = 52 
             )
GROUP BY CID 
HAVING cnt = (
               SELECT count(*) from skill_jobs where JID = 52
             ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:38:58.573

您将需要更复杂的 JOIN，而且我认为没有简单的方法可以同时回答您的请求和显而易见的请求“候选人 X 与工作 Y 的匹配度如何？” 和“候选人 X 适合工作 Y 多少？”。

不管怎样，就到这里吧。

```
SELECT candidate_skill.CID, skill_job.JID, COUNT(*) AS has, sjtot.needed
    FROM skill_job JOIN candidate_skill ON (candidate_skill.S_CODE = skill_job.S_CODE)
    LEFT JOIN ( SELECT JID, COUNT(*) AS needed FROM skill_job GROUP BY JID ) AS sjtot
        ON ( skill_job.JID = sjtot.JID )
GROUP BY CID, JID
HAVING has >= needed; 
```

在实践中，我首先将所需技能分组到 Skill_job 上，这告诉我工作 50 需要两个技能。

有了这个，我 LEFT JOIN 要求和候选人技能；有些候选人会加入所有技能，有些则不会。然后只需计算匹配的数量即可。

```
+------+------+-----+--------+
| CID  | JID  | has | needed |
+------+------+-----+--------+
|    1 |   50 |   2 |      2 |
|    2 |   52 |   1 |      1 |
+------+------+-----+--------+ 
```

再三考虑，可能会选择所需的技能水平和提供的技能水平，并且 CASE WHEN 用于提取匹配项（如果提供 >= 需要，则为 1，否则提供/需要）。然后可以将结果值的平均值用作“技能匹配”指数。

至于“X如何匹配Y？” 问题，一旦您知道候选人 CID 1 适合 JID 50 的工作，您就可以在候选人和工作之间运行 LEFT JOIN。您已经知道，无论工作要求什么，候选人都具有，但是这样您就可以检索候选人具有哪些未要求的技能，以及其他相关价值。

一个嵌套查询加入上面的查询和最后一个查询可能会一口气告诉你一切，但我认为这将是一个代价高昂的一举：-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T19:47:28.257

如果您不关心跨 dbms 支持，您可以使用 mysql 特定的 group_concat 将两个 s_code 集减少为字符串，每个候选人/作业一个，然后像这样比较它们：

```
select * from 
(select cs.cid, group_concat(cs.s_code order by cs.s_code) skills 
    from candidate_skill cs group by cs.cid) cs, 
(select sj.jid, group_concat(sj.s_code order by sj.s_code) skills 
    from skill_job sj group by sj.jid) sj
where sj.skills = cs.skills 
```

请注意，当您的表增长时，最终 where 会越来越慢，并且您无法在 group_concat() 创建的字段上创建索引。

# android - 使用 Android NDK 调用嵌套函数后应用程序被挂起

> ID：11510856
> 
> 赞同：2
> 
> 时间：2012-07-16T19:03:40.973
> 
> 标签：android, android-ndk, fftw

我构建了 Android 项目，在其中使用带有[LibXTract](https://github.com/jamiebullock/LibXtract)的 Android NDK来提取音频特征。LibXTrac 使用[fftw3](http://www.fftw.org/)库。项目由运行简单示例形式 libxtract 的按钮组成：

```
JNIEXPORT void JNICALL Java_com_androidnative1_NativeClass_showText(JNIEnv *env, jclass clazz)
{
    float mean = 0, vector[] = {.1, .2, .3, .4, -.5, -.4, -.3, -.2, -.1}, spectrum[10];
    int n, N = 9;
    float argf[4];

    argf[0] = 8000.f;
    argf[1] = XTRACT_MAGNITUDE_SPECTRUM;
    argf[2] = 0.f;
    argf[3] = 0.f;

    xtract[XTRACT_MEAN]((void *)&vector, N, 0, (void *)&mean);
    __android_log_print(ANDROID_LOG_DEBUG, "AndNat", "com_androidnative1_NativeClass.c before");
    xtract_init_fft(N, XTRACT_SPECTRUM);
    __android_log_print(ANDROID_LOG_DEBUG, "AndNat", "com_androidnative1_NativeClass.c after");
    // Comment for test purpose
    //xtract_init_bark(1, argf[1], 1);
    //xtract[XTRACT_SPECTRUM]((void *)&vector, N, &argf[0], (void *)&spectrum[0]);
} 
```

libxtract 函数**xtract_init_fft**位于*jni/libxtract/jni/src/init.c*执行 fftw3 函数**fftwf_plan_r2r_1d**位于*jni/fftw3/jni/api/plan-r2r-1d.c*

```
__android_log_print(ANDROID_LOG_DEBUG, "AndNat", "libxtract/src/init.c before");
fft_plans.spectrum_plan = fftwf_plan_r2r_1d(N, input, output, FFTW_R2HC, optimisation);
__android_log_print(ANDROID_LOG_DEBUG, "AndNat", "libxtract/src/init.c after"); 
```

应用程序**挂**在**fftwf_paln_r2r_1d**内而没有崩溃或任何外部错误我必须强制它停止工作。

**fftwf_paln_r2r_1d**看起来像：

```
X(plan) X(plan_r2r_1d)(int n, R *in, R *out, X(r2r_kind) kind, unsigned flags)
{
    __android_log_print(ANDROID_LOG_DEBUG, "AndNat", "fftw3/api/plan-r2r-1d.c");
    return X(plan_r2r)(1, &n, in, out, &kind, flags);
} 
```

从 CatLog 我可以看到：

```
07-16 18:50:09.615: D/AndNat(7313): com_androidnative1_NativeClass.c before
07-16 18:50:09.615: D/AndNat(7313): libxtract/src/init.c before
07-16 18:50:09.615: D/AndNat(7313): fftw3/api/plan-r2r-1d.c 
```

我使用 gen.sh 脚本为 fftw3 和 libxtract 生成 config.h 并成功定位在源文件夹中。两个库都是静态构建的，并与共享库 libcom_androidnative1_NativeClass.so 链接

命令

```
nm -Ca libcom_androidnative1_NativeClass.so 
```

表明包含使用的功能。

应用程序构建并部署到设备没有任何问题。

我用标志 *--disable-alloca*，*--enable-float*和 LibXTract 用标志*--enable-fft*和*--disable-dependency-tracking构建 fftw3*

仅在库源代码中添加了 dbgprint 并从 LibXtract 中删除了定义 XTRACT_FFT，因为它无法检测到 fftw 库。

如果有人对我这种奇怪的行为有任何想法，请提供帮助。

* * *

在这里，我将整个项目放在 github 中，所以也许有人可以帮助我处理这个问题。

[https://github.com/bl0ndynek/AndroidNative1](https://github.com/bl0ndynek/AndroidNative1)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T08:00:23.580

感谢 FFTW3 维护者问题已解决。解决方案是在 FFTW3 中将优化级别从 FFTW_MEASURE 更改为 FFTW_ESTIMATE（从 1 到 0），
FFTW 的规划器（在 xtract_init_fft 中）实际上执行并计算不同的可能 FFT 算法，以便为给定的 n 选择最快的计划。然而，为了在尽可能短的时间内完成此操作，定时器必须具有非常高的分辨率，并且要完成此 FFTW3 使用大多数 CPU 上可用但 Android 默认 ARM 配置上不可用的硬件周期计数器。所以这个算法使用 gettimeofday() 巫婆具有低分辨率，并且在 ARM 上永远占用 xtract_init_fft。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:16:56.523

在我看来，您在递归函数中缺少一些终止条件，`X()`这会使您陷入无限循环。

# ruby-on-rails - 不允许用户为自己的帖子投票

> ID：11510860
> 
> 赞同：1
> 
> 时间：2012-07-16T19:03:55.417
> 
> 标签：ruby-on-rails, ruby

我有三个模型**User**，**Post**，**Vote**

我需要不允许用户为自己的帖子投票。我如何在我的模型中制作它并在 Rspec 中测试它？

岗位型号：

```
class Post < ActiveRecord::Base
  attr_accessible :title, :main_text, :video, :photo, :tag

  validates :title,     presence: true, length:  {minimum: 1, maximum: 200}
  validates :main_text, presence: true, length:  {minimum: 1}

  belongs_to :user
  has_many   :votes

end 
```

用户模型：

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :bio

  has_many :posts
  has_many :votes

  validates :name,  presence: true, length: {minimum: 1, maximum: 120}
  validates :email, presence: true, length: {minimum: 5, maximum: 250}, uniqueness: true, 
                    format: {:with => /^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}

end 
```

投票模型：

```
class Vote < ActiveRecord::Base

  attr_accessible :user_id, :post_id, :units

  belongs_to :user
  belongs_to :post

  validates :post_id, uniqueness: {scope: :user_id}  #does not allow user to vote for the same post twice

end 
```

我对投票的规范测试：

```
require 'spec_helper'

describe Vote do

  it "does not allow user to vote for the same post twice" do 
    user = User.create(name: "Nik", email: "nik@google.com" )
    post = Post.create(title: "New Post", main_text: "Many, many, many...")
    vote1 = Vote.create(user_id: user.id, post_id: post.id)  
    vote1.errors.should be_empty    
    vote2 = Vote.create(user_id: user.id, post_id: post.id)        
    vote2.errors.should_not be_empty      
  end 

  it "does not allow user to vote for his own post" do
    user = User.create(name:"Nik", email:"a@a.ru")
    post = Post.create(user_id: user.id, title: "New Post", main_text: "Many, many, many...")
    vote1 = Vote.create(user_id: user.id, post_id: post.id)
    vote1.errors.should_not be_empty
  end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:14:56.787

我没有测试以下代码，因此它无法工作甚至杀死你的猫，但如果投票的用户与帖子的用户相同，请尝试使用自定义验证添加错误。

请注意，如果用户或帖子出于明显的原因为零，我会返回。

```
# In your vote model
validate :users_cant_vote_their_posts

def users_cant_vote_their_posts
  return if user.nil? or post.nil?
  if user_id == post.user_id
    errors[:base] = "A user can't vote their posts"
  end
end 
```

**编辑**：这是一个可能的测试，这里我使用 FactoryGirl 来生成选票。再次，此代码未经测试（对不起双关语）

```
describe Vote do
  subject { vote }

  let!(:vote) { FactoryGirl.build(:vote) }

  it 'from factory should be valid' do
    should be_valid
  end

  context 'when user try to double vote' do
    before do
      # Create another vote from user to post
      FactoryGirl.create(:vote, :user => vote.user, :post => vote.post)
    end

    it { should_not be_valid }
  end

  context 'when user try to vote his posts' do
    before do
      # Set the user whom voted to the post's owner
      vote.user = vote.post.user
    end

    it { should_not be_valid }
  end

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:10:31.597

我不知道 ruby​​，但您应该检查登录的用户是否与发帖的用户匹配。如果确实如此，请拒绝投票请求。

对不起，如果这没有帮助:)

# php - modx 1.05 - 如何在 Ditto 的通话中删除新行

> ID：11510862
> 
> 赞同：0
> 
> 时间：2012-07-16T19:04:06.313
> 
> 标签：php, modx, ditto

当我通过以下方式调用项目 tpl 一段内容时：

```
<p>[+content:len:gt=`100`:then=`[+content:character_limit=`100`+]`:else=`[+content+]`+]</p> 
```

tinymce 有换行符（BR 或 \n\r）。我想删除它们 - 我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:21:32.793

避免像这样的 TinyMCE 格式化的*最快方法是将它们放在块或模板变量中（根据个人经验）。*

编辑：您还可以查看以下 TinyMCE 插件配置：

> 元素 > 管理元素 > 插件（选项卡） > TinyMCE 富文本编辑器

*您可以在自定义参数*文本区域中输入自定义 TinyMCE 参数。看看[http://www.tinymce.com/wiki.php/TinyMCE_FAQ#TinyMCE_adds_BR_elements_to_my_content](http://www.tinymce.com/wiki.php/TinyMCE_FAQ#TinyMCE_adds_BR_elements_to_my_content)

# java - Android：在运行时创建 EditText

> ID：11510863
> 
> 赞同：3
> 
> 时间：2012-07-16T19:04:10.010
> 
> 标签：java, android, view

我正在尝试创建一个视图，用户可以在其中单击“加号”按钮，并创建其他 EditTexts。目标是拥有 2 个 EditTexts 的基础，并且每次用户单击按钮时，再添加 2 个 EditTexts。

我怎样才能做到这一点？我可以从 Java 添加 EditTexts，但我不知道如何动态添加和处理它们的列表。

我希望采取许多对 EditTexts，并将其推送到键/值 HashMap 或其他东西中。

关于如何做到这一点的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:23:38.453

```
public class MyActivity extends Activity {

private LinearLayout main;
private int id = 0;
private List<EditText> editTexts = new ArrayList<EditText>();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    main = new LinearLayout(this);
    main.setOrientation(LinearLayout.VERTICAL);

    Button addButton = new Button(this);
    addButton.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View arg0) {
            addEditText();
        }
    });

    Button submit = new Button(this);
    submit.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View arg0) {
            for (EditText editText : editTexts) {
                editText.getText().toString();
                // whatever u want to do with the strings
            }
        }
    });

    main.addView(addButton);
    main.addView(submit);
    setContentView(main);
}

private void addEditText() {
    LinearLayout editTextLayout = new LinearLayout(this);
    editTextLayout.setOrientation(LinearLayout.VERTICAL);
    main.addView(editTextLayout);

    EditText editText1 = new EditText(this);
    editText1.setId(id++);
    editTextLayout.addView(editText1);

    editTexts.add(editText1);

    EditText editText2 = new EditText(this);
    editText2.setId(id++);
    editTextLayout.addView(editText2);

    editTexts.add(editText2);

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T19:05:33.513

在[ListView](http://developer.android.com/guide/topics/ui/layout/listview.html)中执行此操作。然后您可以将它们添加到 ListAdapter。

然后使用`adapter.notifyDatasetChanged()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T10:12:03.043

可能是我不清楚，但您可以在此处添加作为线性布局之类的组视图，而不是添加单独的编辑文本，您还可以使用任何标志值来添加动态名称转换。

您可以将该视图更新为列表视图，例如在列表视图中膨胀行......

# sql - Oracle中的LISTAGG返回不同的值

> ID：11510870
> 
> 赞同：113
> 
> 时间：2012-07-16T19:04:43.957
> 
> 标签：sql, oracle, aggregate-functions, listagg

我正在尝试`LISTAGG`在 Oracle 中使用该功能。我只想获取该列的不同值。有没有一种方法可以在不创建函数或过程的情况下仅获取不同的值？

```
  col1 col2 Created_by
   1 2 史密斯
   1 2 约翰
   1 3 阿杰
   1 4 公羊
   1 5 杰克

```

我需要选择 col1 和`LISTAGG`col2 的（不考虑第 3 列）。当我这样做时，我会得到这样的结果`LISTAGG`：*[2,2,3,4,5]*

我需要在这里删除重复的“2”；我只需要 col2 与 col1 的不同值。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-07-16T19:30:05.040

**19c 及更高版本：**

```
select listagg(distinct the_column, ',') within group (order by the_column)
from the_table 
```

**18c 及更早版本：**

```
select listagg(the_column, ',') within group (order by the_column)
from (
   select distinct the_column 
   from the_table
) t 
```

如果您需要更多列，您可能正在寻找类似这样的内容：

```
select col1, listagg(col2, ',') within group (order by col2)
from (
  select col1, 
         col2,
         row_number() over (partition by col1, col2 order by col1) as rn
  from foo
  order by col1,col2
)
where rn = 1
group by col1; 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2014-03-25T01:55:22.947

从 oracle 19C 开始，它是内置的，请参见[此处](https://stackoverflow.com/a/52020332/334106)

从 18C 及更早的组内尝试请参阅[此处](https://stackoverflow.com/a/11511203/334106)

否则使用正则表达式

以下是解决您的问题的方法。

```
select  
      regexp_replace(
    '2,2,2.1,3,3,3,3,4,4' 
     ,'([^,]+)(,\1)*(,|$)', '\1\3')

from dual 
```

返回

2,2.1,3,4

答案如下：

```
select col1, 

regexp_replace(
    listagg(
     col2 , ',') within group (order by col2)  -- sorted
    ,'([^,]+)(,\1)*(,|$)', '\1\3') )
   from tableX
where rn = 1
group by col1; 
```

注意：以上方法在大多数情况下都有效 - 列表应该排序，您可能需要根据您的数据修剪所有尾随和前导空格。

如果您在一个组中有很多项目 > 20 或大字符串大小，您可能会遇到 oracle 字符串大小限制“字符串连接的结果太长”。

从 oracle 12cR2 您可以抑制此错误，请参见[此处](https://stackoverflow.com/a/48643709/334106)。或者，为每个组中的成员设置一个最大数量。这仅在可以仅列出第一个成员的情况下才有效。如果您有很长的变量字符串，这可能不起作用。你将不得不进行实验。

```
select col1,

case 
    when count(col2) < 100 then 
       regexp_replace(
        listagg(col2, ',') within group (order by col2)
        ,'([^,]+)(,\1)*(,|$)', '\1\3')

    else
    'Too many entries to list...'
end

from sometable
where rn = 1
group by col1; 
```

希望避免 oracle 字符串大小限制的另一种解决方案（不是那么简单） - 字符串大小限制为 4000。感谢[user3465996](https://stackoverflow.com/a/30312735/334106)的[这篇文章](https://stackoverflow.com/users/3465996/user3465996)

```
select col1  ,
    dbms_xmlgen.convert(  -- HTML decode
    dbms_lob.substr( -- limit size to 4000 chars
    ltrim( -- remove leading commas
    REGEXP_REPLACE(REPLACE(
         REPLACE(
           XMLAGG(
             XMLELEMENT("A",col2 )
               ORDER BY col2).getClobVal(),
             '<A>',','),
             '</A>',''),'([^,]+)(,\1)*(,|$)', '\1\3'),
                  ','), -- remove leading XML commas ltrim
                      4000,1) -- limit to 4000 string size
                      , 1)  -- HTML.decode
                       as col2
 from sometable
where rn = 1
group by col1; 
```

V1 - 一些测试用例 - 仅供参考

```
regexp_replace('2,2,2.1,3,3,4,4','([^,]+)(,\1)+', '\1')
-> 2.1,3,4 Fail
regexp_replace('2 ,2 ,2.1,3 ,3 ,4 ,4 ','([^,]+)(,\1)+', '\1')
-> 2 ,2.1,3,4 Success  - fixed length items 
```

V2 - 项目中包含的项目，例如。2,21

```
regexp_replace('2.1,1','([^,]+)(,\1)+', '\1')
-> 2.1 Fail
regexp_replace('2 ,2 ,2.1,1 ,3 ,4 ,4 ','(^|,)(.+)(,\2)+', '\1\2')
-> 2 ,2.1,1 ,3 ,4  -- success - NEW regex
 regexp_replace('a,b,b,b,b,c','(^|,)(.+)(,\2)+', '\1\2')
-> a,b,b,c fail! 
```

v3 - 正则表达式感谢伊戈尔！适用于所有情况。

```
select  
regexp_replace('2,2,2.1,3,3,4,4','([^,]+)(,\1)*(,|$)', '\1\3') ,
---> 2,2.1,3,4 works
regexp_replace('2.1,1','([^,]+)(,\1)*(,|$)', '\1\3'),
--> 2.1,1 works
regexp_replace('a,b,b,b,b,c','([^,]+)(,\1)*(,|$)', '\1\3')
---> a,b,c works

from dual 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-08-29T11:01:22.173

您可以使用未记录`wm_concat`的功能。

```
select col1, wm_concat(distinct col2) col2_list 
from tab1
group by col1; 
```

此函数返回 clob 列，如果您愿意，可以使用`dbms_lob.substr`将 clob 转换为 varchar2。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-07-18T15:31:04.710

如果您想要跨 MULTIPLE 列的不同值，想要控制排序顺序，不想使用可能会消失的未记录函数，并且不想进行多次全表扫描，您可能会发现此构造很有用：

```
with test_data as 
(
      select 'A' as col1, 'T_a1' as col2, '123' as col3 from dual
union select 'A', 'T_a1', '456' from dual
union select 'A', 'T_a1', '789' from dual
union select 'A', 'T_a2', '123' from dual
union select 'A', 'T_a2', '456' from dual
union select 'A', 'T_a2', '111' from dual
union select 'A', 'T_a3', '999' from dual
union select 'B', 'T_a1', '123' from dual
union select 'B', 'T_b1', '740' from dual
union select 'B', 'T_b1', '846' from dual
)
select col1
     , (select listagg(column_value, ',') within group (order by column_value desc) from table(collect_col2)) as col2s
     , (select listagg(column_value, ',') within group (order by column_value desc) from table(collect_col3)) as col3s
from 
(
select col1
     , collect(distinct col2) as collect_col2
     , collect(distinct col3) as collect_col3
from test_data
group by col1
); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-06-27T06:48:10.830

我通过首先对值进行分组来克服这个问题，然后使用 listagg 进行另一个聚合。像这样的东西：

```
select a,b,listagg(c,',') within group(order by c) c, avg(d)
from (select a,b,c,avg(d)
      from   table
      group by (a,b,c))
group by (a,b) 
```

只有一个全表访问，相对容易扩展到更复杂的查询

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-01-24T20:36:36.410

如果打算将此转换应用于多个列，我扩展了 a_horse_with_no_name 的解决方案：

```
SELECT * FROM
(SELECT LISTAGG(GRADE_LEVEL, ',') within group(order by GRADE_LEVEL) "Grade Levels" FROM (select distinct GRADE_LEVEL FROM Students) t)                     t1,
(SELECT LISTAGG(ENROLL_STATUS, ',') within group(order by ENROLL_STATUS) "Enrollment Status" FROM (select distinct ENROLL_STATUS FROM Students) t)          t2,
(SELECT LISTAGG(GENDER, ',') within group(order by GENDER) "Legal Gender Code" FROM (select distinct GENDER FROM Students) t)                               t3,
(SELECT LISTAGG(CITY, ',') within group(order by CITY) "City" FROM (select distinct CITY FROM Students) t)                                                  t4,
(SELECT LISTAGG(ENTRYCODE, ',') within group(order by ENTRYCODE) "Entry Code" FROM (select distinct ENTRYCODE FROM Students) t)                             t5,
(SELECT LISTAGG(EXITCODE, ',') within group(order by EXITCODE) "Exit Code" FROM (select distinct EXITCODE FROM Students) t)                                 t6,
(SELECT LISTAGG(LUNCHSTATUS, ',') within group(order by LUNCHSTATUS) "Lunch Status" FROM (select distinct LUNCHSTATUS FROM Students) t)                     t7,
(SELECT LISTAGG(ETHNICITY, ',') within group(order by ETHNICITY) "Race Code" FROM (select distinct ETHNICITY FROM Students) t)                              t8,
(SELECT LISTAGG(CLASSOF, ',') within group(order by CLASSOF) "Expected Graduation Year" FROM (select distinct CLASSOF FROM Students) t)                     t9,
(SELECT LISTAGG(TRACK, ',') within group(order by TRACK) "Track Code" FROM (select distinct TRACK FROM Students) t)                                         t10,
(SELECT LISTAGG(GRADREQSETID, ',') within group(order by GRADREQSETID) "Graduation ID" FROM (select distinct GRADREQSETID FROM Students) t)                 t11,
(SELECT LISTAGG(ENROLLMENT_SCHOOLID, ',') within group(order by ENROLLMENT_SCHOOLID) "School Key" FROM (select distinct ENROLLMENT_SCHOOLID FROM Students) t)       t12,
(SELECT LISTAGG(FEDETHNICITY, ',') within group(order by FEDETHNICITY) "Federal Race Code" FROM (select distinct FEDETHNICITY FROM Students) t)                         t13,
(SELECT LISTAGG(SUMMERSCHOOLID, ',') within group(order by SUMMERSCHOOLID) "Summer School Key" FROM (select distinct SUMMERSCHOOLID FROM Students) t)                               t14,
(SELECT LISTAGG(FEDRACEDECLINE, ',') within group(order by FEDRACEDECLINE) "Student Decl to Prov Race Code" FROM (select distinct FEDRACEDECLINE FROM Students) t)          t15 
```

这是 Oracle Database 11g Enterprise Edition Release 11.2.0.2.0 - 64bit Production。
我无法使用 STRAGG，因为无法区分和排序。

性能线性扩展，这很好，因为我添加了所有感兴趣的列。以上 77K 行耗时 3 秒。仅一次汇总，0.172 秒。我有一种方法可以一次性区分表中的多个列。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-08-25T18:53:54.050

即将推出的 Oracle 19c 将`DISTINCT`支持`LISTAGG`.

> [带有 DISTINCT 选项的 LISTAGG](https://community.oracle.com/ideas/12533)：
> 
> **19c 附带此功能：**
> 
> ```
> SQL> select deptno, listagg (distinct sal,', ') within group (order by sal)  
>   2  from scott.emp  
>   3  group by deptno; 
> ```

* * *

**编辑：**

**[Oracle 19C 列表不同](https://livesql.oracle.com/apex/livesql/file/content_HT1O85E4BHSBWN93G1B3M8SI2.html)**

> **LISTAGG 聚合函数现在支持使用新的 DISTINCT 关键字消除重复。**LISTAGG 聚合函数根据 ORDER BY 表达式对查询中的每个组的行进行排序，然后将值连接到单个字符串中。使用新的 DISTINCT 关键字，可以在连接成单个字符串之前从指定的表达式中删除重复值。**这消除了在使用聚合 LISTAGG 函数之前创建复杂查询处理以查找不同值的需要。**使用 DISTINCT 选项，删除重复值的处理可以直接在 LISTAGG 函数中完成。结果是更简单、更快、更高效的 SQL。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-05-18T21:00:24.810

要解决字符串长度问题，您可以使用`XMLAGG`类似于`listagg`但它返回一个 clob。

然后，您可以使用解析`regexp_replace`并获取唯一值，然后使用`dbms_lob.substr()`. 如果您有大量不同的值，您仍然会以这种方式耗尽空间，但在很多情况下，下面的代码应该可以工作。

您还可以更改使用的分隔符。在我的情况下，我想要“-”而不是“，”，但你应该能够替换我的代码中的破折号，如果你愿意的话可以使用逗号。

```
select col1,
    dbms_lob.substr(ltrim(REGEXP_REPLACE(REPLACE(
         REPLACE(
           XMLAGG(
             XMLELEMENT("A",col2)
               ORDER BY col2).getClobVal(),
             '<A>','-'),
             '</A>',''),'([^-]*)(-\1)+($|-)', 
           '\1\3'),'-'), 4000,1) as platform_mix
from table 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-07-14T13:38:12.743

如何创建一个专门的功能来制作“独特”的部分：

```
create or replace function listagg_distinct (t in str_t, sep IN VARCHAR2 DEFAULT ',') 
  return VARCHAR2
as 
  l_rc VARCHAR2(4096) := '';
begin
  SELECT listagg(val, sep) WITHIN GROUP (ORDER BY 1)
    INTO l_rc
    FROM (SELECT DISTINCT column_value val FROM table(t));
  RETURN l_rc;
end;
/ 
```

然后用它来做聚合：

```
SELECT col1, listagg_distinct(cast(collect(col_2) as str_t ), ', ')
  FROM your_table
  GROUP BY col_1; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-12-07T13:39:02.393

[使用 DECODE vs CASE（我在这里看到](https://it.toolbox.com/blogs/ganotedp/listagg-unique-and-super-aggregates-grouping-sets-022015)）进一步完善 @YoYo 对 @a_horse_with_no_name 的基于 row_number() 的方法的更正。我看到@Martin Vrbovsky 也有这种案例方法的答案。

```
select
  col1, 
  listagg(col2, ',') within group (order by col2) AS col2_list,
  listagg(col3, ',') within group (order by col3) AS col3_list,
  SUM(col4) AS col4
from (
  select
    col1, 
    decode(row_number() over (partition by col1, col2 order by null),1,col2) as col2,
    decode(row_number() over (partition by col1, col3 order by null),1,col3) as col3
  from foo
)
group by col1; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-03-12T06:58:54.980

listagg() 忽略 NULL 值，因此在第一步中，您可以使用 lag() 函数来分析以前的记录是否具有相同的值，如果是则为 NULL，否则为“新值”。

```
WITH tab AS 
(           
          SELECT 1 as col1, 2 as col2, 'Smith' as created_by FROM dual
UNION ALL SELECT 1 as col1, 2 as col2, 'John'  as created_by FROM dual
UNION ALL SELECT 1 as col1, 3 as col2, 'Ajay'  as created_by FROM dual
UNION ALL SELECT 1 as col1, 4 as col2, 'Ram'   as created_by FROM dual
UNION ALL SELECT 1 as col1, 5 as col2, 'Jack'  as created_by FROM dual
)
SELECT col1
     , CASE 
       WHEN lag(col2) OVER (ORDER BY col2) = col2 THEN 
         NULL 
       ELSE 
         col2 
       END as col2_with_nulls
     , created_by
  FROM tab; 
```

结果

```
 COL1 COL2_WITH_NULLS CREAT
---------- --------------- -----
         1               2 Smith
         1                 John
         1               3 Ajay
         1               4 Ram
         1               5 Jack 
```

请注意，第二个 2 被 NULL 替换。现在你可以用 listagg() 包裹一个 SELECT 。

```
WITH tab AS 
(           
          SELECT 1 as col1, 2 as col2, 'Smith' as created_by FROM dual
UNION ALL SELECT 1 as col1, 2 as col2, 'John'  as created_by FROM dual
UNION ALL SELECT 1 as col1, 3 as col2, 'Ajay'  as created_by FROM dual
UNION ALL SELECT 1 as col1, 4 as col2, 'Ram'   as created_by FROM dual
UNION ALL SELECT 1 as col1, 5 as col2, 'Jack'  as created_by FROM dual
)
SELECT listagg(col2_with_nulls, ',') WITHIN GROUP (ORDER BY col2_with_nulls) col2_list
  FROM ( SELECT col1
              , CASE WHEN lag(col2) OVER (ORDER BY col2) = col2 THEN NULL ELSE col2 END as col2_with_nulls
              , created_by
           FROM tab ); 
```

结果

```
COL2_LIST
---------
2,3,4,5 
```

您也可以在多个列上执行此操作。

```
WITH tab AS 
(           
          SELECT 1 as col1, 2 as col2, 'Smith' as created_by FROM dual
UNION ALL SELECT 1 as col1, 2 as col2, 'John'  as created_by FROM dual
UNION ALL SELECT 1 as col1, 3 as col2, 'Ajay'  as created_by FROM dual
UNION ALL SELECT 1 as col1, 4 as col2, 'Ram'   as created_by FROM dual
UNION ALL SELECT 1 as col1, 5 as col2, 'Jack'  as created_by FROM dual
)
SELECT listagg(col1_with_nulls, ',') WITHIN GROUP (ORDER BY col1_with_nulls) col1_list
     , listagg(col2_with_nulls, ',') WITHIN GROUP (ORDER BY col2_with_nulls) col2_list
     , listagg(created_by, ',')      WITHIN GROUP (ORDER BY created_by) created_by_list
  FROM ( SELECT CASE WHEN lag(col1) OVER (ORDER BY col1) = col1 THEN NULL ELSE col1 END as col1_with_nulls
              , CASE WHEN lag(col2) OVER (ORDER BY col2) = col2 THEN NULL ELSE col2 END as col2_with_nulls
              , created_by
           FROM tab ); 
```

结果

```
COL1_LIST COL2_LIST CREATED_BY_LIST
--------- --------- -------------------------
1         2,3,4,5   Ajay,Jack,John,Ram,Smith 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-02-27T15:15:25.720

我实现了这个存储功能：

```
CREATE TYPE LISTAGG_DISTINCT_PARAMS AS OBJECT (ELEMENTO VARCHAR2(2000), SEPARATORE VARCHAR2(10));

CREATE TYPE T_LISTA_ELEMENTI AS TABLE OF VARCHAR2(2000);

CREATE TYPE T_LISTAGG_DISTINCT AS OBJECT (

    LISTA_ELEMENTI T_LISTA_ELEMENTI,
        SEPARATORE VARCHAR2(10),

    STATIC FUNCTION ODCIAGGREGATEINITIALIZE(SCTX  IN OUT            T_LISTAGG_DISTINCT) 
                    RETURN NUMBER,

    MEMBER FUNCTION ODCIAGGREGATEITERATE   (SELF  IN OUT            T_LISTAGG_DISTINCT, 
                                            VALUE IN                    LISTAGG_DISTINCT_PARAMS ) 
                    RETURN NUMBER,

    MEMBER FUNCTION ODCIAGGREGATETERMINATE (SELF         IN     T_LISTAGG_DISTINCT,
                                            RETURN_VALUE OUT    VARCHAR2, 
                                            FLAGS        IN     NUMBER      )
                    RETURN NUMBER,

    MEMBER FUNCTION ODCIAGGREGATEMERGE       (SELF               IN OUT T_LISTAGG_DISTINCT,
                                                                                        CTX2                 IN         T_LISTAGG_DISTINCT    )
                    RETURN NUMBER
);

CREATE OR REPLACE TYPE BODY T_LISTAGG_DISTINCT IS 

    STATIC FUNCTION ODCIAGGREGATEINITIALIZE(SCTX IN OUT T_LISTAGG_DISTINCT) RETURN NUMBER IS 
    BEGIN
                SCTX := T_LISTAGG_DISTINCT(T_LISTA_ELEMENTI() , ',');
        RETURN ODCICONST.SUCCESS;
    END;

    MEMBER FUNCTION ODCIAGGREGATEITERATE(SELF IN OUT T_LISTAGG_DISTINCT, VALUE IN LISTAGG_DISTINCT_PARAMS) RETURN NUMBER IS
    BEGIN

                IF VALUE.ELEMENTO IS NOT NULL THEN
                        SELF.LISTA_ELEMENTI.EXTEND;
                        SELF.LISTA_ELEMENTI(SELF.LISTA_ELEMENTI.LAST) := TO_CHAR(VALUE.ELEMENTO);
                        SELF.LISTA_ELEMENTI:= SELF.LISTA_ELEMENTI MULTISET UNION DISTINCT SELF.LISTA_ELEMENTI;
                        SELF.SEPARATORE := VALUE.SEPARATORE;
                END IF;
        RETURN ODCICONST.SUCCESS;
    END;

    MEMBER FUNCTION ODCIAGGREGATETERMINATE(SELF IN T_LISTAGG_DISTINCT, RETURN_VALUE OUT VARCHAR2, FLAGS IN NUMBER) RETURN NUMBER IS
      STRINGA_OUTPUT            CLOB:='';
            LISTA_OUTPUT                T_LISTA_ELEMENTI;
            TERMINATORE                 VARCHAR2(3):='...';
            LUNGHEZZA_MAX           NUMBER:=4000;
    BEGIN

                IF SELF.LISTA_ELEMENTI.EXISTS(1) THEN -- se esiste almeno un elemento nella lista

                        -- inizializza una nuova lista di appoggio
                        LISTA_OUTPUT := T_LISTA_ELEMENTI();

                        -- riversamento dei soli elementi in DISTINCT
                        LISTA_OUTPUT := SELF.LISTA_ELEMENTI MULTISET UNION DISTINCT SELF.LISTA_ELEMENTI;

                        -- ordinamento degli elementi
                        SELECT CAST(MULTISET(SELECT * FROM TABLE(LISTA_OUTPUT) ORDER BY 1 ) AS T_LISTA_ELEMENTI ) INTO LISTA_OUTPUT FROM DUAL;

                        -- concatenazione in una stringa                        
                        FOR I IN LISTA_OUTPUT.FIRST .. LISTA_OUTPUT.LAST - 1
                        LOOP
                            STRINGA_OUTPUT := STRINGA_OUTPUT || LISTA_OUTPUT(I) || SELF.SEPARATORE;
                        END LOOP;
                        STRINGA_OUTPUT := STRINGA_OUTPUT || LISTA_OUTPUT(LISTA_OUTPUT.LAST);

                        -- se la stringa supera la dimensione massima impostata, tronca e termina con un terminatore
                        IF LENGTH(STRINGA_OUTPUT) > LUNGHEZZA_MAX THEN
                                    RETURN_VALUE := SUBSTR(STRINGA_OUTPUT, 0, LUNGHEZZA_MAX - LENGTH(TERMINATORE)) || TERMINATORE;
                        ELSE
                                    RETURN_VALUE:=STRINGA_OUTPUT;
                        END IF;

                ELSE -- se non esiste nessun elemento, restituisci NULL

                        RETURN_VALUE := NULL;

                END IF;

        RETURN ODCICONST.SUCCESS;
    END;

    MEMBER FUNCTION ODCIAGGREGATEMERGE(SELF IN OUT T_LISTAGG_DISTINCT, CTX2 IN T_LISTAGG_DISTINCT) RETURN NUMBER IS
    BEGIN
        RETURN ODCICONST.SUCCESS;
    END;

END; -- fine corpo

CREATE
FUNCTION LISTAGG_DISTINCT (INPUT LISTAGG_DISTINCT_PARAMS) RETURN VARCHAR2
    PARALLEL_ENABLE AGGREGATE USING T_LISTAGG_DISTINCT;

// Example
SELECT LISTAGG_DISTINCT(LISTAGG_DISTINCT_PARAMS(OWNER, ', ')) AS LISTA_OWNER
FROM SYS.ALL_OBJECTS; 
```

很抱歉，但在某些情况下（对于一个非常大的集合），Oracle 可能会返回此错误：

```
Object or Collection value was too large. The size of the value
might have exceeded 30k in a SORT context, or the size might be
too big for available memory. 
```

但我认为这是一个很好的开始；）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-11-28T09:14:14.983

我认为这可能会有所帮助 - 如果列重复，则将列值设为 NULL - 然后它不会附加到 LISTAGG 字符串：

```
with test_data as 
(
      select 1 as col1, 2 as col2, 'Smith' as created_by from dual
union select 1, 2, 'John' from dual
union select 1, 3, 'Ajay' from dual
union select 1, 4, 'Ram' from dual
union select 1, 5, 'Jack' from dual
union select 2, 5, 'Smith' from dual
union select 2, 6, 'John' from dual
union select 2, 6, 'Ajay' from dual
union select 2, 6, 'Ram' from dual
union select 2, 7, 'Jack' from dual
)
SELECT col1  ,
      listagg(col2 , ',') within group (order by col2 ASC) AS orig_value,
      listagg(CASE WHEN rwn=1 THEN col2 END , ',') within group (order by col2 ASC) AS distinct_value
from 
    (
    select row_number() over (partition by col1,col2 order by 1) as rwn, 
           a.*
    from test_data a
    ) a
GROUP BY col1 
```

结果是：

```
COL1  ORIG         DISTINCT
1   2,2,3,4,5   2,3,4,5
2   5,6,6,6,7   5,6,7 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-11T20:43:12.343

有没有人想过使用 PARTITION BY 子句？在此查询中，它对我有用，以获取应用程序服务和访问权限的列表。

```
SELECT DISTINCT T.APP_SVC_ID, 
       LISTAGG(RTRIM(T.ACCESS_MODE), ',') WITHIN GROUP(ORDER BY T.ACCESS_MODE) OVER(PARTITION BY T.APP_SVC_ID) AS ACCESS_MODE 
  FROM APP_SVC_ACCESS_CNTL T 
 GROUP BY T.ACCESS_MODE, T.APP_SVC_ID 
```

我不得不为 NDA 删掉我的 where 子句，但你明白了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-02-14T18:38:00.453

我写了一个函数来使用正则表达式来处理这个问题。in 参数是：1）listagg 调用自身 2）分隔符的重复

```
create or replace function distinct_listagg
  (listagg_in varchar2,
   delimiter_in varchar2)

   return varchar2
   as
   hold_result varchar2(4000);
   begin

   select rtrim( regexp_replace( (listagg_in)
      , '([^'||delimiter_in||']*)('||
      delimiter_in||'\1)+($|'||delimiter_in||')', '\1\3'), ',')
      into hold_result
      from dual;

return hold_result;

end; 
```

现在您不必每次执行此操作时都重复正则表达式，只需说：

```
select distinct_listagg(
                       listagg(myfield,', ') within group (order by 1),
                       ', '
                       )
     from mytable; 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-10-16T14:24:33.090

我需要一个 DISTINCT 版本，并得到了这个。

```
RTRIM(REGEXP_REPLACE(
                       (value, ', ') WITHIN GROUP( ORDER BY value)), 
                            '([^ ]+)(, \1)+','\1'),', ') 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-04-21T00:35:11.667

您可以通过正则表达式替换来做到这一点。这是一个例子：

```
-- Citations Per Year - Cited Publications main query. Includes list of unique associated core project numbers, ordered by core project number.
SELECT ptc.pmid AS pmid, ptc.pmc_id, ptc.pub_title AS pubtitle, ptc.author_list AS authorlist,
  ptc.pub_date AS pubdate,
  REGEXP_REPLACE( LISTAGG ( ppcc.admin_phs_org_code || 
    TO_CHAR(ppcc.serial_num,'FM000000'), ',') WITHIN GROUP (ORDER BY ppcc.admin_phs_org_code || 
    TO_CHAR(ppcc.serial_num,'FM000000')),
    '(^|,)(.+)(,\2)+', '\1\2')
  AS projectNum
FROM publication_total_citations ptc
  JOIN proj_paper_citation_counts ppcc
    ON ptc.pmid = ppcc.pmid
   AND ppcc.citation_year = 2013
  JOIN user_appls ua
    ON ppcc.admin_phs_org_code = ua.admin_phs_org_code
   AND ppcc.serial_num = ua.serial_num
   AND ua.login_id = 'EVANSF'
GROUP BY ptc.pmid, ptc.pmc_id, ptc.pub_title, ptc.author_list, ptc.pub_date
ORDER BY pmid; 
```

还在这里发布：[Oracle - 唯一的 Listagg 值](https://stackoverflow.com/questions/35298782/oracle-unique-listagg-values/36757552)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-02-06T13:01:56.823

一个令人讨厌的方面`LISTAGG`是，如果连接字符串的总长度超过 4000 个字符（`VARCHAR2`SQL 中的限制），则会引发以下错误，这在 Oracle 版本高达 12.1 中很难管理

> ORA-01489: 字符串连接的结果太长

12cR2 中添加的一个新特性`ON OVERFLOW`是`LISTAGG`. 包含此子句的查询如下所示：

```
SELECT pid, LISTAGG(Desc, ' ' on overflow truncate) WITHIN GROUP (ORDER BY seq) AS desc
FROM B GROUP BY pid; 
```

以上会将输出限制为 4000 个字符，但不会抛出 `ORA-01489`错误。

这些是`ON OVERFLOW`条款的一些附加选项：

*   `ON OVERFLOW TRUNCATE 'Contd..'` ：这将显示`'Contd..'`在字符串的末尾（默认为`...`）
*   `ON OVERFLOW TRUNCATE ''` ：这将显示没有任何终止字符串的 4000 个字符。
*   `ON OVERFLOW TRUNCATE WITH COUNT`：这将在终止字符之后显示最后的字符总数。例如：-' `...(5512)`'
*   `ON OVERFLOW ERROR`：如果您希望`LISTAGG`失败并出现 `ORA-01489`错误（无论如何都是默认设置）。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-09-12T08:49:20.807

如果您不需要特定顺序的连接值，并且分隔符可以是逗号，则可以执行以下操作：

```
select col1, stragg(distinct col2)
  from table
 group by col1 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-11-16T19:48:27.107

`select col1, listaggr(col2,',') within group(Order by col2) from table group by col1` 意味着将字符串（col2）聚合到保持顺序 n 的列表中，然后将重复项按 col1 分组处理，这意味着将 col1 重复项合并到 1 个组中。也许这看起来应该是干净和简单的，如果你也想要 col3，你只需要再添加一个 listagg() 就是`select col1, listaggr(col2,',') within group(Order by col2),listaggr(col3,',') within group(order by col3) from table group by col1`

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-11-16T19:43:17.930

`SELECT DISTINCT ...`正如@a_horse_with_no_name 所指出的，在调用 LISTAGG 之前将其用作子查询的一部分可能是简单查询的最佳方式

但是，在更复杂的查询中，可能无法或不容易做到这一点。我在一个使用分析函数的 top-n 方法的场景中遇到了这个问题。

所以我找到了[`COLLECT`](http://docs.oracle.com/cd/E11882_01/server.112/e41084/functions031.htm#SQLRF06304)聚合函数。它被记录为具有可用的`UNIQUE`or`DISTINCT`修饰符。仅[在 10g 中](https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions024.htm)，它悄悄地失败了（它忽略了修饰符而没有错误）。但是，为了克服这个问题，我从[另一个答案](https://stackoverflow.com/a/37425042/744133)中得出了这个解决方案：

```
SELECT
  ...
  (
    SELECT LISTAGG(v.column_value,',') WITHIN GROUP (ORDER BY v.column_value)
    FROM TABLE(columns_tab) v
  ) AS columns,
  ...
FROM (
  SELECT
    ...
    SET(CAST(COLLECT(UNIQUE some_column ORDER BY some_column) AS tab_typ)) AS columns_tab,
    ...
) 
```

基本上，通过使用[`SET`](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions144.htm)，我删除了我收藏中的重复项。

您仍然需要将 定义`tab_typ`为基本集合类型，对于 a `VARCHAR`，这将是例如：

```
CREATE OR REPLACE type tab_typ as table of varchar2(100)
/ 
```

同样作为对@a_horse_with_no_name 在多列情况下的答案的更正，您可能仍希望在第三（或更多）列上进行聚合：

```
select
  col1, 
  listagg(CASE rn2 WHEN 1 THEN col2 END, ',') within group (order by col2) AS col2_list,
  listagg(CASE rn3 WHEN 1 THEN col3 END, ',') within group (order by col3) AS col3_list,
  SUM(col4) AS col4
from (
  select
    col1, 
    col2,
    row_number() over (partition by col1, col2 order by null) as rn2,
    row_number() over (partition by col1, col3 order by null) as rn3
  from foo
)
group by col1; 
```

如果您将`rn = 1`作为 where 条件保留给查询，则会错误地聚合其他列。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2017-02-24T10:50:28.927

处理多个 listagg 的最简单方法是每列使用 1 个 WITH（子查询因子），其中包含来自 select distinct 的该列的 listagg：

```
 WITH tab AS 
    (           
        SELECT 1 as col1, 2 as col2, 3 as col3, 'Smith' as created_by FROM dual
        UNION ALL SELECT 1 as col1, 2 as col2, 3 as col3,'John'  as created_by FROM dual
        UNION ALL SELECT 1 as col1, 3 as col2, 4 as col3,'Ajay'  as created_by FROM dual
        UNION ALL SELECT 1 as col1, 4 as col2, 4 as col3,'Ram'   as created_by FROM dual
        UNION ALL SELECT 1 as col1, 5 as col2, 6 as col3,'Jack'  as created_by FROM dual
    )
    , getCol2 AS
    (
        SELECT  DISTINCT col1, listagg(col2,',') within group (order by col2)  over (partition by col1) AS col2List
        FROM ( SELECT DISTINCT col1,col2 FROM tab)
    )
    , getCol3 AS
    (
        SELECT  DISTINCT col1, listagg(col3,',') within group (order by col3)  over (partition by col1) AS col3List
        FROM ( SELECT DISTINCT col1,col3 FROM tab)
    )
    select col1,col2List,col3List
    FROM getCol2
    JOIN getCol3
    using (col1) 
```

这使：

```
col1  col2List  col3List
1     2,3,4,5   3,4,6 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2020-06-15T15:02:42.350

非常简单 - 在您的查询中使用带有 select distinct 的子查询：

```
SELECT question_id,
       LISTAGG(element_id, ',') WITHIN GROUP (ORDER BY element_id)
FROM
       (SELECT distinct question_id, element_id
       FROM YOUR_TABLE)
GROUP BY question_id; 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2016-12-27T20:05:07.983

使用这样创建的 listagg_clob 函数：

```
create or replace package list_const_p
is
list_sep varchar2(10) := ',';
end list_const_p;
/
sho err

create type listagg_clob_t as object(
v_liststring varchar2(32767),
v_clob clob,
v_templob number,

static function ODCIAggregateInitialize(
sctx IN OUT listagg_clob_t
) return number,
member function ODCIAggregateIterate(
self IN OUT listagg_clob_t, value IN varchar2
) return number,
member function ODCIAggregateTerminate(
self IN OUT listagg_clob_t, returnValue OUT clob, flags IN number
) return number,
member function ODCIAggregateMerge(
self IN OUT listagg_clob_t, ctx2 IN OUT listagg_clob_t
) return number
);
/
sho err

create or replace type body listagg_clob_t is

static function ODCIAggregateInitialize(sctx IN OUT listagg_clob_t)
return number is
begin
sctx := listagg_clob_t('', '', 0);
return ODCIConst.Success;
end;

member function ODCIAggregateIterate(
self IN OUT listagg_clob_t,
value IN varchar2
) return number is
begin
if nvl(lengthb(v_liststring),0) + nvl(lengthb(value),0) <= 4000 then
self.v_liststring:=self.v_liststring || value || list_const_p.list_sep;
else
if self.v_templob = 0 then
dbms_lob.createtemporary(self.v_clob, true, dbms_lob.call);
self.v_templob := 1;
end if;
dbms_lob.writeappend(self.v_clob, length(self.v_liststring), v_liststring);
self.v_liststring := value || list_const_p.list_sep;
end if;
return ODCIConst.Success;
end;

member function ODCIAggregateTerminate(
self IN OUT listagg_clob_t,
returnValue OUT clob,
flags IN number
) return number is
begin
if self.v_templob != 0 then
dbms_lob.writeappend(self.v_clob, length(self.v_liststring), self.v_liststring);
dbms_lob.trim(self.v_clob, dbms_lob.getlength(self.v_clob) - 1);
else
self.v_clob := substr(self.v_liststring, 1, length(self.v_liststring) - 1);
end if;
returnValue := self.v_clob;
return ODCIConst.Success;
end;

member function ODCIAggregateMerge(self IN OUT listagg_clob_t, ctx2 IN OUT listagg_clob_t) return number is
begin
if ctx2.v_templob != 0 then
if self.v_templob != 0 then
dbms_lob.append(self.v_clob, ctx2.v_clob);
dbms_lob.freetemporary(ctx2.v_clob);
ctx2.v_templob := 0;
else
self.v_clob := ctx2.v_clob;
self.v_templob := 1;
ctx2.v_clob := '';
ctx2.v_templob := 0;
end if;
end if;
if nvl(lengthb(self.v_liststring),0) + nvl(lengthb(ctx2.v_liststring),0) <= 4000 then
self.v_liststring := self.v_liststring || ctx2.v_liststring;
ctx2.v_liststring := '';
else
if self.v_templob = 0 then
dbms_lob.createtemporary(self.v_clob, true, dbms_lob.call);
self.v_templob := 1;
end if;
dbms_lob.writeappend(self.v_clob, length(self.v_liststring), self.v_liststring);
dbms_lob.writeappend(self.v_clob, length(ctx2.v_liststring), ctx2.v_liststring);
self.v_liststring := '';
ctx2.v_liststring := '';
end if;
return ODCIConst.Success;
end;
end;
/
sho err

CREATE or replace FUNCTION listagg_clob (input varchar2) RETURN clob
PARALLEL_ENABLE AGGREGATE USING listagg_clob_t;
/
sho err 
```

# ruby - 为什么 Ruby bundler（w/whisky_disk 和 RVM）抱怨安装的 Gem 不是 >=0？

> ID：11510872
> 
> 赞同：1
> 
> 时间：2012-07-16T19:04:52.033
> 
> 标签：ruby, ruby-on-rails-3.2, rake, bundler

这是我的错误信息：

```
Running rake deploy:post_setup...
rake aborted!
You have requested:
  nokogiri >= 0

The bundle currently has nokogiri locked at 1.5.5.
Try running `bundle update nokogiri` 
```

这条消息是否告诉我 1.5.5 不知何故不符合 ">= 0" 要求？这听起来不对。

如果我在解释这个错误，我应该如何解释它？

（Ruby 是 jruby-1.6.7.2，bundle 是 1.1.4。这个 rake 任务实际上是通过whiskey_disk 运行的，如果这很重要的话。）

**== 八个月后 ==**

我发现同样的错误。同样，尝试使用whiskey_disk，所以我怀疑这是与whiskey_disk 相关的。

这一次，它与 bcrypt gem 一起使用。

```
3052 ~/dev/myproj$ bundle exec wd setup --to=grant
Deploying grant@<myserver>.com...
grant@<myserver>.com's password: 
Repository already cloned to [/home/grant/myproj].  Skipping.
Running rake deploy:post_setup...
rake aborted!
You have requested:
  bcrypt-ruby >= 0

The bundle currently has bcrypt-ruby locked at 3.0.1.
Try running `bundle update bcrypt-ruby` 
```

又是什么鬼？我要求大于 0 的东西，它在抱怨，因为捆绑包有 gem 并且它大于 0！有什么问题？

Gemfile 只包含`gem 'bcrypt-ruby'`- 没有指定版本。3.0.1 版应该是完全可以接受的。

我试过在目标服务器上做`bundle update`和`bundle update bcrypt-ruby`，但都没有改变任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T00:15:18.627

您可能没有使用正确的红宝石。ssh 进入机器后检查`which ruby`是否正在使用。如果您使用的是 rvm，我只会卸载系统 ruby​​。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T22:40:52.540

问题归结为我的 RVM 的 Ruby 没有被*任何*远程命令使用。他们继续使用发行版的非 RVM Ruby。

因此，需要两个修复：

1.  需要更改我的 .bashrc 中的 RVM 路径行：

    `PATH=**$PATH**:$HOME/.rvm/bin # Add RVM to PATH for scripting`

    需要更改以优先考虑 RVM，如下所示：

    `PATH=$HOME/.rvm/bin:**$PATH** # Add RVM to PATH for scripting`

2.  我需要在我的 post_setup.sh 和 post_deploy.sh 脚本中加载 RVM，以便后续的 rake 命令将使用我的 RVM ruby​​。

    这是通过将以下内容添加到每个内容来完成的：

    ```
    # Load RVM into a shell session *as a function*
    if [[ -s "$HOME/.rvm/scripts/rvm" ]] ; then
      # First try to load from a user install
      source "$HOME/.rvm/scripts/rvm"
    elif [[ -s "/usr/local/rvm/scripts/rvm" ]] ; then
      # Then try to load from a root install
      source "/usr/local/rvm/scripts/rvm"
    else
      printf "ERROR: An RVM installation was not found.\n"
      exit -1
    fi 
    ```

    （后者显然不是我写的，考虑到它是多么的精致。我从我公司的其他项目中提取了它，他们之前已经明确处理过这个问题。）

3.  我还需要`bundle install`在我的 post_setup.sh 和 post_deploy.sh 脚本中运行。这必须在whiskey_disk 开始运行Rake**之前**发生，因此将它包含在Rake 脚本本身中是不够的。

现在我的whiskey_disk 部署工作顺利。

# oracle - Liquibase：自定义 SQL 语句

> ID：11510875
> 
> 赞同：0
> 
> 时间：2012-07-16T19:04:58.933
> 
> 标签：oracle, postgresql-9.1, liquibase

我最初为 PostreSQL 定义了我的 liquibase 架构。现在，我必须修改架构文件以支持 Oracle。我有一个带有`<sql>`标签的变更集。它有一个查询访问`pg_catalog`表以设置序列的值。但是，这不适用于 Oracle。如果我删除它，Liquibase 会抱怨校验和验证失败。即使我有一个空`<sql>`标签或其中指定了一些其他查询，它也会抱怨。在这个变更集中，我有许多其他的 create-table 语句，所以我不能只从 dbms 属性中删除 oracle。有什么办法可以禁止此 sql 为 Oracle 运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:22:36.263

[变更集](http://www.liquibase.org/manual/changeset)上的 dbms 属性是旨在处理此问题的机制.....听起来您试图在一个变更集中做太多事情（但我想您已经弄清楚了）

校验和验证失败是 liquibase 的安全机制，旨在保护数据库免受有人篡改模式文件的影响。

解决方法是在运行 liquibase 时使用[clearChecksums](http://www.liquibase.org/manual/command_line)选项。它告诉 liquibase 重新计算数据库中已有变更集的校验和。这将使您的 postgres 数据库实例能够接受您为 Oracle 所做的更改集的更改。

# javascript - 从 Java 脚本返回多个值不能在 firefox 上运行（在 IE 上运行良好）

> ID：11510882
> 
> 赞同：-1
> 
> 时间：2012-07-16T19:05:47.087
> 
> 标签：javascript, jquery

我有一个主 js 文件（例如名称：my-dataTables.js）并从调用 my-dataTables.js 的函数的视图（groovy）访问它。

```
proto.dataTable = {
    'filterOptions': function( selectedFilter ) {

        var dCodes = "" ;
        var dCodes2 = "";  

        if ( selectedFilter == 'test1'  ) 
        {
            dCodes = "something 1";
            dCodes2 = "something 2";
        }
        else 
        {
            dCodes = "something 2";
            dCodes2 = "something 1";
        }

        return {
        'dCodes': dCodes,
        'dCodes2': dCodes2
        };  
 } 
```

并从视图（常规）访问它们：

```
$('#filter-status').change(function () {
    var filterOptions = proto.dataTable.filterOptions($(this).find('option:selected').text());

    var dCodes = filterOptions.dCodes;
    var dCodes2 = filterOptions.dCodes2;

    alert(dCodes + " isRegex : " + dCodes);
}); 
```

**在 IE 上工作正常，意味着“proto.dataTable.filterOptions”被调用并在 IE 上返回预期值。但是在 Firefox 上，它看起来像是达到了 $('#filter-status').change(function () 但不在 proto.dataTable.filterOptions() 内部。并且没有错误消息。不确定我错过了什么。可以一个帮助？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:48:57.863

**代码很好。这是浏览器缓存问题。我清理了缓存，代码按预期工作。**

# spring - spring beans 上下文配置

> ID：11510886
> 
> 赞同：4
> 
> 时间：2012-07-16T19:06:17.403
> 
> 标签：spring, frameworks

我是春豆的新手。我指的是书籍和博客。在某些情况下，上下文配置`<beans:bean>`以`<beans>`. 有什么不同？我们应该在上下文文件中给出 XML 命名空间吗？是否会在应用部署时参考实际站点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:24:00.673

就 Spring 而言，这无关紧要 - XML 必须是有效的，这样 Spring 才能理解它，仅此而已。这取决于您选择哪种格式。通常您使用默认命名空间以避免输入过多（所有示例均基于[附录 C. 基于 XML Schema 的配置](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/xsd-config.html)）：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="..."/>

</beans> 
```

`xmlns="..."`属性定义默认命名空间（如果您根本不指定任何命名空间，则使用该命名空间，例如`<beans/>`. 这很好，只要您仅使用单个`beans`命名空间并且偶尔使用来自其他命名空间的少量声明：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

    <bean id="..." class="...">
      <property name="isolation">
        <util:constant static-field="java.sql.Connection.TRANSACTION_SERIALIZABLE"/>
      </property>
    </bean>

</beans> 
```

但有时您会注意到与默认命名空间相比，您使用的来自不同命名空间的节点要多得多`beans`。一个很好的例子是[Spring Security 配置](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html)文件：

```
<beans xmlns:security="http://www.springframework.org/schema/security"
  xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security-3.0.3.xsd">

    <security:http auto-config='true'>
        <security:intercept-url pattern="/login.jsp*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <security:intercept-url pattern="/**" access="ROLE_USER" />
        <security:form-login login-page='/login.jsp'/>
        <security:session-management>
            <security:concurrency-control max-sessions="1" />
        </security:session-management>
        <security:openid-login>
            <security:attribute-exchange>
                <security:openid-attribute name="email" type="http://axschema.org/contact/email" required="true" />
                <security:openid-attribute name="name" type="http://axschema.org/namePerson" />
            </security:attribute-exchange>
        </security:openid-login>
    </security:http>

    <security:authentication-manager>
        <security:authentication-provider user-service-ref='myUserDetailsService'/>
    </security:authentication-manager>

    <bean id="myUserDetailsService" class="org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl">
        <property name="dataSource" ref="dataSource"/>
    </bean>

</beans> 
```

您会看到它是多么笨拙，因为`beans`很少使用默认命名空间，但整个文件必须用`security:`前缀弄乱？这个怎么样（注意`xmlns`命名空间声明是如何改变的）：

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security-3.0.3.xsd">

    <http auto-config='true'>
        <intercept-url pattern="/login.jsp*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <intercept-url pattern="/**" access="ROLE_USER" />
        <form-login login-page='/login.jsp'/>
        <session-management>
            <concurrency-control max-sessions="1" />
        </session-management>
        <openid-login>
            <attribute-exchange>
                <openid-attribute name="email" type="http://axschema.org/contact/email" required="true" />
                <openid-attribute name="name" type="http://axschema.org/namePerson" />
            </attribute-exchange>
        </openid-login>
    </http>

    <authentication-manager>
        <authentication-provider user-service-ref='myUserDetailsService'/>
    </authentication-manager>

    <beans:bean id="myUserDetailsService" class="org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl">
        <beans:property name="dataSource" ref="dataSource"/>
    </beans:bean>

</beans:beans> 
```

这两个配置文件在语义上是等价的（只是编码相同信息的不同方式）。但后者更具可读性。只要使用最常用的命名空间，就使用默认命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:23:38.480

它依赖于 XML 命名空间配置，不是 Spring 特性，对代码没有影响，对 coder 有一些影响，实际上只是`xmlns`在根 xml 元素上定义属性的效果。[在 Spring Security 的这一章中](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#d0e507)[了解更多信息`<beans:bean>`](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#d0e507)（实际上与 Spring Framework 不同，但很常见，并且在 XML 文件中使用自己的命名空间）。你可以写：

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security-3.1.xsd">

  <global-method-security pre-post-annotations="enabled">
    <expression-handler ref="expressionHandler"/>
  </global-method-security>

  <beans:bean id="expressionHandler" class=
        "org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler">
    <beans:property name="permissionEvaluator" ref="myPermissionEvaluator"/>
  </beans:bean>
</beans:beans> 
```

这相当于：

```
<beans xmlns="http://www.springframework.org/schema/beans" <!-- see the difference here? -->
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                           http://www.springframework.org/schema/security
                           http://www.springframework.org/schema/security/spring-security-3.1.xsd">
  <security:global-method-security pre-post-annotations="enabled">
    <security:expression-handler ref="expressionHandler"/>
  </security:global-method-security>

  <bean id="expressionHandler" class=
        "org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler">
    <property name="permissionEvaluator" ref="myPermissionEvaluator"/>
  </bean>
</beans> 
```

就我个人而言，我总是使用 bean 作为主要命名空间，但这是习惯问题。

# windows - 在 Windows XP 上将导出的 Mac 生成的 R 数据集导入 SAS？

> ID：11510891
> 
> 赞同：1
> 
> 时间：2012-07-16T19:06:53.007
> 
> 标签：windows, macos, r, sas

我有一个由 R 在 Mac 上生成的 .csv 文件。我想在 Windows XP 中将数据集导入 SAS。请注意，我的 .csv 文件 (NA) 中有许多缺失值。没有它们，我如何将数据集导入 SAS？我希望 SAS 自动将所有 NA 更改为“。”，但通常甚至很难将 Mac 生成的 .csv 文件放入 SAS 9.3。

我从外部库中尝试了“write.dbf()”并生成了一个 .dbf 文件，但不幸的是，SAS DBMS 不知道 .dbf。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:41:32.590

我不确定如何在您读取数据时执行此操作，但您应该能够使用普通的 infile 语句，然后使用 if/then。就像是：

```
DATA new;
infile 'C:\myfolder\mydataset.csv' dlm=',' firstobs=2;
if newvar1='NA' then newvar1=.; 
```

如果您向我提供有关您的数据集的更多详细信息，我可能会为您提供更多帮助。

我还想知道在将其导出以发送到 SAS 之前，是否可以通过在 R 中将 NA 替换为 ' ' 或 numeric(0) 来获得相同的效果？IMO R 更灵活，所以我更喜欢在那里进行数据操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T19:42:00.870

在R`write.table`函数中，有一个参数`na="NA"` 把这个改成`na="."`

您也可以在 excel 中使用查找和替换。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T19:58:59.517

您可以使用它`R`来编写 SAS XPORT 格式的文件。见[包装](http://cran.r-project.org/web/packages/SASxport/)`write.xport`内。[`SASxport`](http://cran.r-project.org/web/packages/SASxport/)

# r - r 中像树一样的连接线

> ID：11510893
> 
> 赞同：6
> 
> 时间：2012-07-16T19:07:08.013
> 
> 标签：r, plot, ggplot2

我有以下人类家庭的类型数据：

```
indvidual <- c("John",  "Kris", "Peter",  "King",  "Marry",  "Renu", "Kim",    "Ken", "Lu")
Parent1 <- c(    NA,     NA,     "John",  "John",   "John",    NA,    "Peter",  NA,    NA)
Parent2 <- c(    NA,     NA,    "Kris",   "Kris",  "Renu",   NA,      "Lu",     NA,   NA)
X <-       c(    2,     3,       2,       3,           4,     5,        1.5,      1,    1)
Y <-       c(    3,     3,       2,       2,           2,     3,        1,      3,    2)
pchsize <- c( 4.5,      4.3,     9.2,     6.2,         3.2,   6.4,      2.1,    1.9,  8)
fillcol <- c( 8.5,      8.3,     1.2,     3.2,         8.2,   2.4,      2.6,    6.1,  3.2)
myd <- data.frame (indvidual, Parent1, Parent2, X, Y, pchsize,fillcol)

 indvidual Parent1 Parent2   X Y pchsize fillcol
1      John    <NA>    <NA> 2.0 3     4.5     8.5
2      Kris    <NA>    <NA> 3.0 3     4.3     8.3
3     Peter    John    Kris 2.0 2     9.2     1.2
4      King    John    Kris 3.0 2     6.2     3.2
5     Marry    John    Renu 4.0 2     3.2     8.2
6      Renu    <NA>    <NA> 5.0 3     6.4     2.4
7       Kim   Peter      Lu 1.5 1     2.1     2.6
8       Ken    <NA>    <NA> 1.0 3     1.9     6.1
9        Lu    <NA>    <NA> 1.0 2     8.0     3.2 
```

我想绘制如下图，个人点连接到父母（最好与列出的 Parent1 和 Parent2 不同的线条颜色）。pch size 和 pch fill 也被缩放到其他变量 pchsize 和 fillcol。因此情节大纲是：

![在此处输入图像描述](../Images/71771ceb8616bd008ea6c31a695d3cda.png)

这是我在 ggplot2 中的进展：

```
require(ggplot2) 
ggplot(data=myd, aes(X, Y,fill = fillcol)) +
  geom_point(aes(size = pchsize, fill = fillcol), pch = "O") +
  geom_text(aes (label = indvidual, vjust=1.25)) 
```

![在此处输入图像描述](../Images/f301aeb3b9d3e59eb945012c6d2263e0.png)

未解决的问题：连接线，同时增大 pch 的大小和填充颜色。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T13:04:35.657

这是ggplot2解决方案

```
library(ggplot2)
individual <- c("John",  "Kris", "Peter",  "King",  "Marry",  "Renu", "Kim",    "Ken", "Lu")
Parent1 <- c(    NA,     NA,     "John",  "John",   "John",    NA,    "Peter",  NA,    NA)
Parent2 <- c(    NA,     NA,    "Kris",   "Kris",  "Renu",   NA,      "Lu",     NA,   NA)
X <-       c(    2,     3,       2,       3,           4,     5,        1.5,      1,    1)
Y <-       c(    3,     3,       2,       2,           2,     3,        1,      3,    2)
pchsize <- c( 4.5,      4.3,     9.2,     6.2,         3.2,   6.4,      2.1,    1.9,  8)
fillcol <- c( 8.5,      8.3,     1.2,     3.2,         8.2,   2.4,      2.6,    6.1,  3.2)
myd <- data.frame (individual, Parent1, Parent2, X, Y, pchsize,fillcol)

SegmentParent1 <- merge(
  myd[, c("individual", "X", "Y")], 
  myd[!is.na(myd$Parent1), c("Parent1", "X", "Y")], 
  by.x = "individual", by.y = "Parent1")
SegmentParent2 <- merge(
  myd[, c("individual", "X", "Y")], 
  myd[!is.na(myd$Parent1), c("Parent2", "X", "Y")], 
  by.x = "individual", by.y = "Parent2")
Segments <- rbind(SegmentParent1, SegmentParent2)

ggplot(data=myd, aes(X, Y)) + 
  geom_segment(data = Segments, aes(x = X.x, xend = X.y, y = Y.x, yend = Y.y)) + 
  geom_point(aes(size = pchsize, colour = fillcol)) + 
  geom_text(aes (label = indvidual), vjust = 0.5, colour = "red", fontface = 2) + 
  scale_x_continuous("", expand = c(0, 0.6), breaks = NULL) + 
  scale_y_continuous("", expand = c(0, 0.4), breaks = NULL) + 
  scale_size(range = c(20, 40)) + 
  theme_bw() 
```

![在此处输入图像描述](../Images/c8a40f29cc6171ec4b961e4491a05e59.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-20T16:32:41.500

这是一个仅使用`plot()`,`text()`和的解决方案`arrows()`。`for`循环有点混乱，但适用于更大的数据集，并且应该很容易使用绘图和箭头：

```
plot(myd$X,myd$Y, col='white', type="p", main="", ylab="", xlab="",
    axes = FALSE, ylim = c(min(myd$Y)*.8, max(myd$Y)*1.2),
    xlim = c(min(myd$X)*.8, max(myd$X)*1.2))

child = data.frame()
child = myd[!is.na(myd$Parent1),]
DArrows = matrix(0,nrow(child),4);
MArrows = matrix(0,nrow(child),4);

for (n in 1:nrow(child)){
    d<-child[n,];
    c1<-myd$indvidual==as.character(d$Parent1);
    b1<-myd[t(c1)];
    c2<-myd$indvidual==as.character(d$Parent2);
    b2<-myd[t(c2)];
    DArrows[n, 1]=as.double(d$X)
    DArrows[n, 2]=as.double(d$Y)
    DArrows[n, 3]=as.double(b1[4])
    DArrows[n, 4]=as.double(b1[5])    
    MArrows[n, 1]=as.double(d$X)
    MArrows[n, 2]=as.double(d$Y)
    MArrows[n, 3]=as.double(b2[4])
    MArrows[n, 4]=as.double(b2[5])
}

arrows(DArrows[,3],DArrows[,4],DArrows[,1],DArrows[,2],lwd= 2, col = "blue",length=".1")
arrows(MArrows[,3],MArrows[,4],MArrows[,1],MArrows[,2],lwd=2, col = "red",length=".1")

par(new=TRUE)

plot(myd$X,myd$Y,type = "p", main = "", ylab = "", xlab = "",cex = myd$pchsize,
axes = FALSE, pch = 21, ylim = c(min(myd$Y)*.8, max(myd$Y)*1.2),
xlim=c(min(myd$X)*.8, max(myd$X)*1.2), bg = myd$fillcol,fg = 'black')

text(1.12*myd$X, .85*myd$Y, myd$indvidual)

arrows((DArrows[,3]+DArrows[,1])/2, (DArrows[,4]+DArrows[,2])/2,
    DArrows[,1], DArrows[,2], lwd = 2, col = "blue", length = ".1")
arrows((MArrows[,3]+MArrows[,1])/2, (MArrows[,4]+MArrows[,2])/2,
    MArrows[,1], MArrows[,2], lwd = 2, col = "red", length = ".1") 
```

![在此处输入图像描述](../Images/9c4ae688085985fa7a70484d7a723bbb.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-18T21:19:13.247

我突然想到的一件事是把它当作一个网络——R 有很多包来绘制这些。

这是一个非常简单的解决方案：首先，我使用您的父列表来制作社会矩阵——您通常也可以使用边缘列表输入网络——这里我将 1 用于第一个父母关系，将 2 用于第二个。

```
psmat <- rbind(c(0, 0, 1, 1, 1, 0, 0, 0, 0),
          c(0, 0, 2, 2, 0, 0, 0, 0, 0),
          c(0, 0, 0, 0, 0, 0, 1, 0, 0),
          rep(0, 9),
          rep(0, 9),
          c(0, 0, 0, 0, 2, 0, 0, 0, 0),
          rep(0, 9),
          rep(0, 9),
          c(0, 0, 0, 0, 0, 0, 2, 0, 0)) 
```

然后，使用我刚刚点击的网络包：

```
require(network)
plot(network(psmat), coord = cbind(X, Y), vertex.cex = pchsize, 
  vertex.col = fillcol, label = indvidual, edge.col = psmat) 
```

这本身并不是非常漂亮，但我认为它为您提供了您想要的所有基本元素。

对于颜色，我相信小数位只是四舍五入——我不知道如何处理这些。

我知道我已经看到人们在 ggplot 中绘制网络，所以这可能会给你一个更好的结果。

![示例图片](../Images/853bc1b3301a7a1a7a0abfe36f5702a3.png)

编辑：所以这是一种将数据直接转换为网络对象的非常混乱的方法——其他人可能能够修复它。此外，我添加了一个边缘属性（命名为“P”表示父母身份），并将第一个设置的值设为 1，将第二个设置的值设为 2。这可以在绘图时用于设置颜色。

```
P1 <- match(Parent1, indvidual)
e1 <- cbind(P1, 1:9); e1 <- na.omit(e1); attr(e1, 'na.action') <- NULL
P2 <- match(Parent2, indvidual)
e2 <- cbind(P2, 1:9); e2 <- na.omit(e2); attr(e2, 'na.action') <- NULL

en1 <- network.initialize(9)
add.edges(en1, e1[,1], e1[,2])
set.edge.attribute(en1, 'P', 1)
add.edges(en1, e2[,1], e2[,2], names.eval = 'P', vals.eval = 2)

plot(en1, coord = cbind(X, Y), vertex.cex = pchsize, 
  vertex.col = fillcol, label = indvidual, edge.col = 'P') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T11:48:58.210

替代解决方案使用 igraph

```
library(igraph)
mm<-data.frame(dest=c(as.character(myd$Parent1),as.character(myd$Parent2)))
mm$orig<-myd$individual
g<-graph.edgelist(as.matrix(mm[!is.na(mm$dest),]))
rownames(myd)<-as.character(myd[,1])
l<-as.matrix(myd[V(g)$name,4:5])
plot(g,layout=l,vertex.color=myd[V(g)$name,6],vertex.size=myd[V(g)$name,6]) 
```

![在此处输入图像描述](../Images/ea4606aba21999585ffe15866f37e3b9.png)

只是玩一下颜色大小！

# ruby-on-rails - ActiveRecord 查询接口 - 与条件的关联

> ID：11510898
> 
> 赞同：0
> 
> 时间：2012-07-16T19:07:30.830
> 
> 标签：ruby-on-rails, activerecord

我有一个`Post`模型`has_many :comments`。问题是：如何使用*ActiveRecord 查询接口*构建查询，以检索所有帖子和每个帖子的**最后评论**？

我现在只有以下内容，但它不会过滤评论，我不知道下一步该做什么：

```
Post.includes(:comments) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:17:59.857

好吧，最简单的事情浮现在脑海中，这可能不是最好的，那就是创建一个范围。

```
class Post < ActiveRecord::Base
    # has_many or maybe a has_one ? I don't have time to fire up console again to check, sorry!
    has_many :last_comment, :class_name => 'Comment', :limit => 1, :order => 'comments.created_at DESC'
end 
```

然后使用

```
Post.includes(:last_comment) 
```

确保您的 SQL 中有索引。

# iphone - 构建应用程序时如何将文件放在特定目录中？

> ID：11510899
> 
> 赞同：0
> 
> 时间：2012-07-16T19:07:33.763
> 
> 标签：iphone, ios, file-management

我已经阅读了很多关于在 iPhone 应用程序中访问文件的内容，但我不知道如何首先将它们放到那里。我有许多对我的应用程序很重要的声音文件，还有更多可以使用 IAP 购买的文件。我知道这些文件应该放在我的 /Library/Application Support/ 目录中，但是我不知道如何将它们放在那里。我该怎么做呢？我确信我遗漏了一些非常明显的东西，但我无法弄清楚。此外，在我的应用程序中，有一个 UITableView 可以跟踪这些文件。当用户购买新声音时，使该表的数据源保持最新的最佳方法是什么？我认为在我的模型中保留一个数组是最好的，但我不确定如何读取数组的内容并将其写入磁盘。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:12:27.503

您可以使用此代码创建文件夹，然后将文件保存在那里。

```
NSArray *filePaths =    NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask,YES); 
NSString *path=[filePaths objectAtIndex: 0];
NSString *tempPath=[[NSString alloc]initWithFormat:@"%@/%@",path,@"TempFolder"];

BOOL bDir;
NSError *error;
if([[NSFileManager defaultManager] fileExistsAtPath:tempPath isDirectory:&bDir]==FALSE){
    [[NSFileManager defaultManager] createDirectoryAtPath:tempPath withIntermediateDirectories:YES attributes:nil error:&error];
} 
```

然后使用此代码将您的文件保存在您的文件夹中

```
NSArray *filePaths =    NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask,YES);
NSString *pathAndName=[[NSString alloc] initWithFormat:@"%@/TempFolder/%@",
                       [filePaths objectAtIndex: 0],
                       fileName];
NSData * data = //Load your file here
[data writeToFile:pathAndName atomically:YES]; 
```

# javascript - 如何加载js文件并动态应用于div？

> ID：11510903
> 
> 赞同：1
> 
> 时间：2012-07-16T19:08:08.583
> 
> 标签：javascript

如果我有一个完全干净的 HTML 页面，我如何使用 Javascript 来单击位于页面主体中的按钮，该按钮动态添加 div 和要包含的适当 .js 脚本以显示基本工作开放层地图？任何样品将不胜感激。我很容易单击一个按钮来动态添加一个 id 为“map”的 div，但我不确定如何动态包含 .js 脚本以将其应用于 div 标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:16:13.793

`<div>`当用户单击按钮时 创建并放置一个：[在按钮单击时动态加载 DIV 的最简单方法？](https://stackoverflow.com/questions/4883282/easiest-way-to-dyanmically-load-a-div-on-button-click)

动态加载 JavaScript 源代码： [在页面中动态添加 javascript 文件的方法](https://stackoverflow.com/questions/5751620/ways-to-add-javascript-files-dynamically-in-a-page)

# amazon-s3 - Redis 和 Amazon S3 的区别

> ID：11510906
> 
> 赞同：1
> 
> 时间：2012-07-16T19:08:26.277
> 
> 标签：amazon-s3, redis

我不确定 Redis 和 S3 之间的区别是什么。如果它们不同，它们可以交互的方式是什么？

我知道 Redis 是一个键值数据存储，而 S3 是一个在线网络存储。对我来说，这听起来很相似。有区别吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T19:41:23.567

它们是完全不同的东西。

如您所说，Redis 是键值数据存储；S3 是一个放置文件的地方，简单来说。您对待物理文件的方式与对待数据库的方式不同。

# ruby-on-rails - 超类不匹配只会随着活动管理文件的移除而消失

> ID：11510911
> 
> 赞同：2
> 
> 时间：2012-07-16T19:08:57.360
> 
> 标签：ruby-on-rails, activeadmin

我正在为一个项目使用 Rails 3.2.3 和 Active Admin。当我尝试 rake 数据库时，它说：“类 BillingCycle 的超类不匹配”并将类的名称更改为其他东西会产生相同的错误。如果我取出 Active Admin 的东西（初始化程序、管理文件夹、路由），我就可以运行它，但我需要一个不需要我为每个 db:migrate 都这样做的解决方案。完整的跟踪是：

```
 superclass mismatch for class BillingCycle
/Users/ashley/public_afme/db/migrate/20120711022055_billing_cycle.rb:   1:in `<top (required)>'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.3/lib/   active_support/dependencies.rb:251:in `require'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `block in require'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:537:in `load_migration'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:533:in `migration'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:528:in `migrate'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:720:in `block (2 levels) in migrate'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:775:in `call'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:775:in `block in ddl_transaction'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/transactions.rb:208:in `transaction'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:775:in `ddl_transaction'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:719:in `block in migrate'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:700:in `each'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:700:in `migrate'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:570:in `up'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/migration.rb:551:in `migrate'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.3/lib/active_record/railties/databases.rake:153:in `block (2 levels) in <top (required)>'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/Users/ashley/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/bin/rake:19:in `load'
/Users/ashley/.rvm/gems/ruby-1.9.2-p290/bin/rake:19:in `<main>' 
```

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T15:54:47.267

我认为您可能已将迁移命名为 BillingCycle。检查您的 BillingCycle 迁移文件顶部是否没有：class BillingCycle < ActiveRecord::Migration

如果是这样，将该类重命名为其他名称 - 也许是“AddingBillingCycle”。

# c# - WPF 流文档布局

> ID：11510914
> 
> 赞同：2
> 
> 时间：2012-07-16T19:09:05.977
> 
> 标签：c#, .net, wpf, printing, flowdocument

我正在尝试打印 WPF FlowDocument。版面需要采用每页4个文档的形式，布局如下：

```
 Doc1 | Doc2
-------------
 Doc3 | Doc4 
```

（抱歉，我想不出更好的方式来说明布局）。

页面需要填充，所以如果 Doc1 & 2 为空白或只有一两个字符，它仍然需要打印与 Doc3 & 4 相同的大小。

我正在使用的代码如下（对不起，它很长，我试图在可行的情况下进行删节）：

```
PrintDialog printDialog = new PrintDialog();
if ((bool)printDialog.ShowDialog().GetValueOrDefault())
{
    FlowDocument flowDocument = new FlowDocument();
    flowDocument.PageHeight = printDialog.PrintableAreaHeight;
    flowDocument.PageWidth = printDialog.PrintableAreaWidth;
    flowDocument.PagePadding = new Thickness(25);

    flowDocument.ColumnGap = 0;

    flowDocument.ColumnWidth = (flowDocument.PageWidth -
                                   flowDocument.ColumnGap -
                                   flowDocument.PagePadding.Left -
                                   flowDocument.PagePadding.Right);

    Table myTable = new Table();
    myTable.BorderThickness = new Thickness(3);

    AddCols(myTable);         // Add 2 cols

    TableRowGroup rg = new TableRowGroup();
    TableRow row = new TableRow();

    AddRows(myTable);         // Adds 2 rows

    TableCell cell = new TableCell(new Paragraph(new Run("Doc1")));                
    cell.BorderThickness = new Thickness(1);
    cell.BorderBrush = Brushes.Black;          
    // Repeat 4 times      

    row.Cells.Add(cell);

    myTable.RowGroups.Add(rg);

    doc.Blocks.Add(myTable);

    .... 
```

我遇到的问题是，尽管确实可以打印，但它并没有像上面描述的那样尝试使其适合页面。我正在尝试的是否可能，如果是，如何？

编辑：

从[这里](http://www.developmentnow.com/g/6_2009_8_0_0_1029107/Change-TableRow-height-in-FlowDocument-WPF.htm)看，我相信我真正需要的是一种计算段落高度的方法，以便我可以设置 Padding 属性。不幸的是，此链接中提出的解决方案不起作用！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T18:57:18.603

尝试将整个块放在一个网格中，以使其具有统一的布局，然后将网格放在块中，然后将块放在单个表格单元格中。看看这是否适合你 -

```
Grid grid = new Grid();
        grid.RowDefinitions.Add(new RowDefinition());
        grid.RowDefinitions.Add(new RowDefinition());
        grid.ColumnDefinitions.Add(new ColumnDefinition());
        grid.ColumnDefinitions.Add(new ColumnDefinition());

        Label text1 = new Label();
        text1.Content = "Doc1";
        grid.Children.Add(text1);
        Grid.SetColumn(text1, 0);
        Grid.SetRow(text1, 0);

        Label text2 = new Label();
        text1.Content = "Doc2";
        grid.Children.Add(text2);
        Grid.SetColumn(text2, 1);
        Grid.SetRow(text2, 0);

        Label text3 = new Label();
        text1.Content = "Doc3";
        grid.Children.Add(text3);
        Grid.SetColumn(text3, 0);
        Grid.SetRow(text3, 1);

        Label text4 = new Label();
        text1.Content = "Doc4";
        grid.Children.Add(text4);
        Grid.SetColumn(text4, 1);
        Grid.SetRow(text4, 1);

        BlockUIContainer block = new BlockUIContainer(grid);

        Table table = new Table();
        TableRowGroup rg = new TableRowGroup();
        TableCell cell = new TableCell();
        cell.Blocks.Add(block);
        TableRow row = new TableRow();
        row.Cells.Add(cell);
        rg.Rows.Add(row);
        table.RowGroups.Add(rg);
        doc.Blocks.Add(table); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T20:41:51.860

您可以创建自己的自定义 DocumentPaginator。看这里：

*   [http://www.codeproject.com/Articles/164033/WPF-Visual-Print-Component](http://www.codeproject.com/Articles/164033/WPF-Visual-Print-Component)

*   [http://www.codeproject.com/Articles/31834/FlowDocument-pagination-with-repeating-page-header](http://www.codeproject.com/Articles/31834/FlowDocument-pagination-with-repeating-page-header)

*   [http://www.switchonthecode.com/tutorials/wpf-printing-part-2-pagination](http://www.switchonthecode.com/tutorials/wpf-printing-part-2-pagination)

*   [http://www.codeproject.com/Articles/138233/Custom-Data-Grid-Document-Paginator](http://www.codeproject.com/Articles/138233/Custom-Data-Grid-Document-Paginator)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:36:17.593

这是你要找的吗？

[将 xaml 流文档转换为 xps](http://blogs.msdn.com/b/fyuan/archive/2007/03/10/convert-xaml-flow-document-to-xps-with-style-multiple-page-page-size-header-margin.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T22:29:29.290

问题，您将单元格添加到 row.cell 并将行组添加到表中，但是您是否将行添加到行组？

# c# - 使用指针和偏移量 C# 查找地址

> ID：11510923
> 
> 赞同：-3
> 
> 时间：2012-07-16T19:09:45.993
> 
> 标签：c#, memory, pointers, offset

我对记忆阅读做了很多研究，我到达了这里。我得到了指针和偏移值，通过手动添加地址并在作弊引擎上选择“指针”我可以获得地址。但我的问题是如何在 C# 上做到这一点？

**指针：** “client.dll”+0065F38

**偏移量：** E4

这两个值返回作弊引擎中的地址，我想知道如何在 C# 中制作它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:28:26.493

我不会讲太多细节，但`"client.dll"+0065F38`不会帮助你太多。
幸运的是，我写了一篇[关于如何用](http://haxordotnet.blogspot.co.il/2011/06/how-to-build-trainer-to-game-and-magic.html)C# 编写培训师的教程。

# ruby-on-rails - rake assets:precompile 给出“错误：堆栈空间不足”错误

> ID：11510924
> 
> 赞同：1
> 
> 时间：2012-07-16T19:10:13.123
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rake

嗨，当我运行 rake 命令时，它以“错误：堆栈空间不足”结束。

你能帮我么。我正在使用 rails 3.2.3 和 spree 1.1.1。

提前致谢

我在下面粘贴了错误日志。

```
** Invoke assets:precompile (first_time)
** Execute assets:precompile C:/Ruby192/bin/ruby.exe C:/Ruby192/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace
** Invoke assets:precompile:all (first_time)
** Execute assets:precompile:all
** Invoke assets:precompile:primary (first_time)
** Invoke assets:environment (first_time)
** Execute assets:environment
** Invoke environment (first_time)
** Execute environment
** Invoke tmp:cache:clear (first_time)
** Execute tmp:cache:clear
** Execute assets:precompile:primary rake aborted! Error: Out of stack space   (in C:/Users/Aahlad/Documents/new new rails/smockcouture/app/assets/javascripts/application.js) C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:68:in `extract_result' C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:28:in `block in exec' C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:41:in `compile_to_tempfile' C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:27:in `exec' C:/Ruby192/lib/ruby/gems/1.9.1/gems/uglifier-1.2.4/lib/uglifier.rb:101:in `compile' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/compressors.rb:74:in `compress' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/processing.rb:265:in `block in js_compressor=' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/processor.rb:29:in `call' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/processor.rb:29:in `evaluate' C:/Ruby192/lib/ruby/gems/1.9.1/gems/tilt-1.3.3/lib/tilt/template.rb:76:in `render' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/context.rb:177:in `block in evaluate' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/context.rb:174:in `each' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/context.rb:174:in `evaluate' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/bundled_asset.rb:26:in `initialize' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:244:in `new' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:244:in `build_asset' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/index.rb:89:in `block in build_asset' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/caching.rb:19:in `cache_asset' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/index.rb:88:in `build_asset' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:163:in `find_asset' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/index.rb:56:in `find_asset' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/static_compiler.rb:20:in `block in compile' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:212:in `block in each_logical_path' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:200:in `block (2 levels) in each_file' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:190:in `each' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:190:in `each_entry' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:198:in `block in each_file' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:197:in `each' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:197:in `each_file' C:/Ruby192/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:210:in `each_logical_path' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/static_compiler.rb:18:in `compile' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:56:in `internal_precompile' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:70:in `block (3 levels) in <top (required)>' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain' C:/Ruby192/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:60:in `block (3 levels) in <top (required)>' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain' C:/Ruby192/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>' C:/Ruby192/bin/rake:19:in `load' C:/Ruby192/bin/rake:19:in `<main>' Tasks: TOP => assets:precompile:primary rake aborted! Command failed with status (1): [C:/Ruby192/bin/ruby.exe C:/Ruby192/bin/rak...] C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/file_utils.rb:53:in `block in create_shell_runner' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `call' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `sh' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `sh' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/file_utils.rb:80:in `ruby' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `ruby' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:12:in `ruby_rake_task' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:21:in `invoke_or_reboot_rake_task' C:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:29:in `block (2 levels) in <top (required)>' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain' C:/Ruby192/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run' C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>' C:/Ruby192/bin/rake:19:in `load' C:/Ruby192/bin/rake:19:in `<main>' Tasks: TOP => assets:precompile 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:25:38.017

我不知道错误，但必须知道这是一个特定于 Windows 的错误。我复制了相同的应用程序并在 ubuntu 中执行了 rake 命令并且运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T15:21:19.777

当我尝试使用`ckeditor`gem 进行预编译时，我得到了相同的响应。init.js.erb 包含其他 JS 文件，其中一些文件已经“压缩”，因此，该文件本质上是一大串文本，没有任何换行符。如果我在 Komodoedit 中打开它，我会收到一条警告说信息被截断，因为它太长了。也许这就是 Uglifier 尝试读取然后压缩字符串数据时发生的情况。我不知道解决方案，因为它最近才发生在我身上。用于`rake assets:precompile --trace`查看错误实际出现的位置。

# c# - c#asp.net mvc如何提示打开文件

> ID：11510925
> 
> 赞同：1
> 
> 时间：2012-07-16T19:10:12.640
> 
> 标签：c#, asp.net, asp.net-mvc

我一直在尝试实现这样的东西，但它会在等待退出时超时？

我的目标是在记事本中打开客户端机器上的文件。下面的代码是我最初拥有的，但刚刚了解到这只适用于服务器，而不是客户端。

```
 public JsonResult Index()
    {
        System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.EnableRaisingEvents = false;
        proc.StartInfo.UseShellExecute = false;
        proc.StartInfo.FileName = "notepad";

        proc.StartInfo.Arguments =  @"\\share\test.XML";
        proc.Start();
        proc.WaitForExit();
    } 
```

有没有办法做到这一点？

我要做的就是在客户端机器上打开 test.xml 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:13:53.387

您在那里的代码将在服务器端执行；不在客户端。您无法从浏览器在客户端计算机上打开文件（或为此执行程序）。如果浏览器可以做到这一点，那将是一个主要的安全问题。

您可以做的最好的事情是创建一个指向该文件的超链接，格式为`file:///drive:/file.xml`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:23:23.873

您的代码将启动记事本应用程序并正确打开 test.xml 文件

因为您使用的是 WaitForExit 方法，所以记事本应用程序将保持打开状态直到关闭。

WaitForExit 方法指示 Process 组件无限期地等待相关进程退出。

你真的想在 MVC 操作中使用 WaitForExit

> **请阅读从 MSDN 获取的关于 WaitForExit 的备注**
> 
> WaitForExit() 重载用于使当前线程等待相关进程终止。此方法指示 Process 组件等待进程和事件处理程序退出的无限时间。这可能会导致应用程序停止响应。例如，如果您为具有用户界面的进程调用 CloseMainWindow，如果进程被写入永远不会进入其消息循环，则可能不会处理对操作系统终止关联进程的请求。
> 
> **注意：**在 .NET Framework 版本 3.5 和更早版本中，WaitForExit() 重载等待 MaxValue 毫秒（大约 24 天），而不是无限期地等待。此外，如果达到完整的 MaxValue 时间，以前的版本不会等待事件处理程序退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:24:09.350

我的体重一样，所以我用这个解决了

```
 using System.Xml;

   XmlTextReader reader = new XmlTextReader(
   Server.MapPath("mycompany.xml"));

    reader.WhitespaceHandling = WhitespaceHandling.None;
    XmlDocument xmlDoc = new XmlDocument();
    xmlDoc.Load(reader);
    reader.Close();        
    lbNodes.Items.Add("XML Document");
    XmlNode xnod = xmlDoc.DocumentElement;
    AddWithChildren(xnod, 1); 
```

您可以在此处查看完整示例 [http://www.codeproject.com/Articles/4902/Reading-an-XML-file-using-NET](http://www.codeproject.com/Articles/4902/Reading-an-XML-file-using-NET)

# magento - 如何在 Magento 的非 EAV 模型中使用 setPage() 进行分页/限制？

> ID：11510927
> 
> 赞同：2
> 
> 时间：2012-07-16T19:10:24.123
> 
> 标签：magento

我需要开始`$collection->setPage(0, 10);`使用我的非 EAV 模型，但它不起作用。我试过了，`$matches->getSelect()->setPage(0, 10);`但没有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:12:25.000

该`setPage()`方法仅适用于 Magento 中基于 EAV 的集合，因为它是在`Mage_Eav_Model_Entity_Collection_Abstract`类中定义的......

```
public function setPage($pageNum, $pageSize)
{
    $this->setCurPage($pageNum)
        ->setPageSize($pageSize);
    return $this;
} 
```

如您所见，它是一个很好的速记实用程序，可用于基于 EAV 的集合。对于基于非 EAV 的集合，您可以在集合类中创建自己的版本，或者在初始化集合时使用更详细的语法在客户端代码中设置页码和大小：

```
$collection->setCurPage($pageNum)
           ->setPageSize($pageSize)
; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-20T11:23:45.720

```
public function updateIndex()
{
    $productsCollection = Mage::getModel('catalog/product')->getCollection()
        ->addAttributeToSelect(array('name', 'image', 'url_key', 'price', 'visibility'));

    $productsCollection->setPageSize(100);

    $pages = $productsCollection->getLastPageNumber();
    $currentPage = 1;

    do {
        $productsCollection->setCurPage($currentPage);
        $productsCollection->load();

        foreach ($productsCollection as $_product) {

            $insertData = array(
                'entity_id' => $_product->getId(),
                'title' => $_product->getName(),
                'image' => $_product->getImage(),
                'url' => $_product->getUrlKey(),
                'price' => $_product->getFinalPrice(),
            );

            $this->_getWriteAdapter()->insertOnDuplicate(
                $this->getTable('atwix_sonar/suggestions'),
                $insertData,
                array('title', 'image', 'url', 'price')
            );
        }

        $currentPage++;
        //clear collection and free memory
        $productsCollection->clear();
    } while ($currentPage <= $pages);
} 
```

请参阅这个完整的示例，它准确地说明了如何使用 magento 集合寻呼机功能。资料来源： http: [//www.atwix.com/magento/working-with-large-collections/](http://www.atwix.com/magento/working-with-large-collections/)

# python - 在给定节点及其位置的python中创建树

> ID：11510931
> 
> 赞同：1
> 
> 时间：2012-07-16T19:10:38.083
> 
> 标签：python, tree

我有一个 XML 文件，其中包含我随机生成的不同数据节点。我想要做的是遍历每个节点并从中创建一棵树。我的定制软件使用 XML 数据直观地绘制这些节点及其连接。

哪个节点连接到哪个节点没有标准；给定 500 个节点，我希望能够生成具有相当复杂的广度和深度的树。

我正在使用自定义库在 python 中对此进行编码，该库使用 JgraphX 绘制图表，因此我没有必要显示确切的代码。但假设我有以下 3 个功能：

```
getXY_coord(a), get the XY coord of the node on the diagram
connectNodes(a,b), connects node a with b
getAllNodes(), returns list of all nodes on diagram 
```

我将如何制作这棵复杂的树？它甚至不必进行可视化组织，一个节点可以连接到图表另一侧的另一个节点，只要连接本身很复杂。

我唯一能做的就是随机化节点列表并连接列表中相邻的节点。然而，这并没有得到我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:26:38.910

[我建议查看像Prim's algorithm](http://en.wikipedia.org/wiki/Prim%27s_algorithm)这样的最小生成树算法。

该`networkx`模块将为您执行此操作 - 请参阅[文档](http://networkx.lanl.gov/reference/generated/networkx.algorithms.mst.minimum_spanning_tree.html#networkx.algorithms.mst.minimum_spanning_tree)。

# android - 吐司没有显示

> ID：11510934
> 
> 赞同：0
> 
> 时间：2012-07-16T19:10:48.210
> 
> 标签：android, toast

我想显示一条 toast 消息，但不知何故它没有被调用，下面是我的 oncreate 代码。

```
 public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            this.requestWindowFeature(Window.FEATURE_NO_TITLE);
            this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                    WindowManager.LayoutParams.FLAG_FULLSCREEN);
            setContentView(R.layout.alarm);

            mediaPlayer = MediaPlayer.create(getApplicationContext(),
                    R.raw.alarmclock);
            mediaPlayer.start();

            Toast.makeText(this, "Alarm time up", Toast.LENGTH_LONG);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:12:13.980

您必须在使用 makeText() 后调用 show() 来显示您的消息：

```
Toast.makeText(this, "Alarm time up", Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:13:32.343

你不见了

```
Toast.makeText(your_activity.this, "u clicked me", Toast.LENGTH_SHORT).show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:13:53.760

一个已知的错误...您忘记添加 show() 方法。应该

```
Toast.makeText(this, "Alarm time up", Toast.LENGTH_LONG).show(); 
```

# r - 读取包含 long 的 CSV 文件？

> ID：11510937
> 
> 赞同：0
> 
> 时间：2012-07-16T19:10:56.010
> 
> 标签：r

> **可能重复：**
> [导入多位数整数时 R 出现奇怪错误](https://stackoverflow.com/questions/11441035/weird-error-in-r-when-importing-integer-with-many-digits)

我在其中一列中有一个包含 long（长整数）的 CSV 文件。我如何将其读入 R？当我使用 just 以默认方式执行此操作时`read.csv`，long 似乎已损坏。

# audio - 让 jPlayer 停留在曲目的末尾

> ID：11510940
> 
> 赞同：0
> 
> 时间：2012-07-16T19:11:01.693
> 
> 标签：audio, html5-audio, jplayer

如[标准 jPlayer 演示](http://jsfiddle.net/jPlayer/Q4LMV/)中所示，当曲目结束时，播放器会将时间重置为零。有什么办法让它停留在赛道的尽头吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:18:42.477

将`ended()`事件与`playHead`方法结合使用，以在播放结束时将播放头保持在末尾。

修改示例，这是我得到的：

```
$(document).ready(function() {

    $("#jquery_jplayer_1").jPlayer({
        ready: function(event) {
            $(this).jPlayer("setMedia", {
                mp3: "http://www.jplayer.org/audio/mp3/TSP-01-Cro_magnon_man.mp3",
                oga: "http://www.jplayer.org/audio/ogg/TSP-01-Cro_magnon_man.ogg"
            });
        },
        swfPath: "http://www.jplayer.org/2.1.0/js",
        supplied: "mp3, oga",
        ended : function(){
            console.log("ended");
            $(this).jPlayer("playHead",100);
        }
    });
});                                      
​ 
```

**JSFiddle： http:** [//jsfiddle.net/wjsKa/2/](http://jsfiddle.net/wjsKa/2/)
**参考：** [http ://jplayer.org/latest/developer-guide/](http://jplayer.org/latest/developer-guide/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T16:25:12.070

jPlayer 是开源的，因此您可以根据需要调整代码。我建议获取 jquery.jplayer 源并从 jquery.jplayer.js 中删除第[973](https://github.com/happyworm/jPlayer/blob/master/jquery.jplayer/jquery.jplayer.js#L973)和[974](https://github.com/happyworm/jPlayer/blob/master/jquery.jplayer/jquery.jplayer.js#L974)行。然后，您只需保存自己的副本并在需要时对其进行压缩。

或者您可以使用[_updateInterface方法，这样当从](https://github.com/happyworm/jPlayer/blob/master/jquery.jplayer/jquery.jplayer.js#L1230)[“结束”事件处理程序](https://github.com/happyworm/jPlayer/blob/master/jquery.jplayer/jquery.jplayer.js#L964)调用时它不会移动搜索栏。

抱歉回答不完整，目前无法测试。

# python - 如何从类方法中全局使用定义为 ser 的序列？

> ID：11510941
> 
> 赞同：1
> 
> 时间：2012-07-16T19:11:08.410
> 
> 标签：python, python-2.7

当我在课外分配这个时`ser`，我如何使用`ser`来自类的方法？就像跟随它在 Window 中不起作用一样。

```
import socket, 
         datetime, 
           threading, 
             os,
               serial

# declare once 
ser = serial.Serial('COM3', 19200)

class AServer(threading.Thread):
  def __init__(self, port):
    threading.Thread.__init__(self)
    self.port = port

  def now(self):
    d = datetime.datetime.now()
    return d.strftime("%d/%m/%y %H:%M:%S")

  def run(self):
    host = ''
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.bind((host, self.port))
    print 'successfully, waiting...'
    s.listen(1)
    conn, addr = s.accept()
    print 'contact', addr, 'on', self.now()

    while 1:
      try:
        data = conn.recv(1024)
      except socket.error:
        print 'lost', addr, 'waiting..'
        s.listen(1)
        conn, addr = s.accept()
        print 'contact', addr, 'on', self.now()
        continue

      if not data:
        print 'lost', addr, 'waiting..'
        s.listen(1)
        conn, addr = s.accept()
        print 'contact', addr, 'on', self.now()
      else:    
        print "received msg:", data
        conn.send('roger')
        if data.startswith('blablabla'):
          ser.write('\x02\x01\x80\x00\x03\x80')
        else:
          print "not ok"

t = AServer(80)
t.start() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:26:43.360

这与 Python 的命名空间有关。你需要说你要访问全局`ser`变量

```
# declare once 
ser = serial.Serial('COM3', 19200)

class AServer(threading.Thread):
  def __init__(self, port):
    threading.Thread.__init__(self)
    self.port = port

    global se
    self._ser = ser # local reference to global variable 
```

# asp.net-mvc - MVC + EF Code First 多对多关系：使用复选框创建视图

> ID：11510942
> 
> 赞同：3
> 
> 时间：2012-07-16T19:11:11.290
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, razor, many-to-many

我是 MVC + EF Code First 的新手，对多对多关系有一些疑问。

我创建了 2 个具有多对多关系的表（用户资料和课程）。听起来很简单，但对我来说很复杂：

**我想查看“用户配置文件”的“创建”视图，并为每个“课程”现有选项选中复选框，并能够将其保存到相应的数据库中。**

我一直在阅读和寻找示例，但我没有解决这个问题（或找到关于这个特殊需求的任何相关信息（我发现类似的东西不适用）

我已经看过这篇文章，但它不是关于创建和不使用 EF (http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/updating-related-data-with- the-entity-framework-in-an-asp-net-mvc-application)

```
public class UserProfile
{
    [Key]
    public int Id { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Courses>  usercourses { get; set; }
}

public class Courses
{
    public int CourseID { get; set; }
    public string CourseDescripcion { get; set; }
    public virtual ICollection<UserProfile> UserProfiles { get; set; } 
}

 public class UserProfileDBContext : DbContext
{
    public DbSet<UserProfile> UserProfiles { get; set; }
    public DbSet<Courses> usrCourses{ get; set; }

} 
```

创建控制器：

```
 public ActionResult Create()
    {
        return View();
    } 

    [HttpPost]
    public ActionResult Create(UserProfile userprofile)
    {
        if (ModelState.IsValid)
        {
            db.UserProfiles.Add(userprofile);
            db.SaveChanges();
            return RedirectToAction("Index");  
        }
        return View(userprofile);
    } 
```

关于视图，我只想使用“@foreach”循环来生成保管箱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T19:36:43.127

你在我回答过的另一篇文章中问了几乎相同的问题。我已经逐步说明了如何做到这一点，所以你不会出错:)

[在 MVC 创建视图上保存多对多关系数据](https://stackoverflow.com/questions/11531769/saving-many-to-many-relationship-data-on-mvc-create-view/11593957#11593957)

# c# - 在 csproj 中包含文件但将其排除在发布之外？

> ID：11510944
> 
> 赞同：4
> 
> 时间：2012-07-16T19:11:26.180
> 
> 标签：c#, web-config-transform

我们使用带有数据库连接字符串的本地配置文件，以防我们需要将本地计算机连接到开发甚至生产数据库。我们调用这个文件`ConnectionStrings.local.config`，它包含在我们的 C# 项目中，因此我们可以轻松地对其进行编辑。

当我转到发布 Web 工具时，我**不**希望包含此文件，因为我们将使用配置转换来交换每个服务器上真实数据源的连接字符串属性。

我修改了我的`.csproj`文件如下：

排除

但 ConnectionStrings.local.config 文件在发布后仍显示在文件夹中。

如何在不从 Visual Studio 中排除文件的情况下将其从部署中删除？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:31:25.577

在给定文件的属性窗口中（来自 Visual Studio），将“复制到输出目录”设置为“不复制”，并确保“构建操作”为“无”。

另外，您是否先清除了 DESTINATION 目录？也许该文件是您之前发布的文件留下的？默认情况下，发布不会“清理”目标目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:17:20.013

排除文件 1\. 在解决方案资源管理器中，选择要排除的文件。2\. 在“属性”窗口中，选择“排除”属性并将其设置为 true。

# mysql - 列表中的 SQL 中缺少哪些值？

> ID：11510950
> 
> 赞同：5
> 
> 时间：2012-07-16T19:11:47.460
> 
> 标签：mysql, sql

我有一个值列表，比如说`1,2,3,4,5,6`。我有一个 SQL 表，其中有一个存储这些值的字段，但只有三行，比如`2,4,5`. 什么样的查询将为我返回三行`1,3,6`？（将所有六个存储在另一个表中并左加入是作弊。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T19:16:58.953

您没有说明您的 DBMS，所以这是 ANSI SQL 版本：

```
with the_values (id) as ( 
  values (1),(2),(3),(4),(5),(6)
)
select v.id 
from the_values v
  left join the_real_table t on t.id = v.id
where t.id is null; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T19:39:44.347

您也可以尝试使用 EXCEPT（类似于 Oracle 中的 MINUS）：

```
(SELECT 1
UNION
SELECT 2
UNION 
SELECT 3
UNION
SELECT 4
UNION
SELECT 5
UNION
SELECT 6)
EXCEPT
(SELECT 2
 UNION
 SELECT 3
 UNION
 SELECT 4) 
```

或者，与您的示例更相关：

```
(SELECT 1
UNION
SELECT 2
UNION 
SELECT 3
UNION
SELECT 4
UNION
SELECT 5
UNION
SELECT 6)
EXCEPT
(SELECT Field FROM Table) 
```

其中 Field 包含 2、4 和 5。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:15:48.943

操作员将`not in`进行您想要的检查。

```
declare @allValues table (value int)
insert @allValues values (1)
insert @allValues values (2)
insert @allValues values (3)
insert @allValues values (4)
insert @allValues values (5)
insert @allValues values (6)

declare @someValues table (value int)
insert @someValues values (2)
insert @someValues values (4)
insert @someValues values (5)

select
    *
from
    @allValues
where
    value not in (select value from @someValues) 
```

另一种可能更快的方法，使用连接：

```
select
    av.value
from
    @allValues av
    left join @someValues sv on (av.value = sv.value)
where
    sv.value is null 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:16:28.957

如果它完成了工作，这不是作弊。设置一个包含所有可能行的临时表或表变量，然后使用 WHERE NOT EXISTS 或 LEFT OUTER JOIN 结合 WHERE TableVariableID IS NULL。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-07-16T19:15:39.437

你可以使用一个`NOT IN`子句。

```
SELECT column FROM table WHERE column NOT IN (2,4,5) 
```

# node.js - nodejs v.0.8.2 cluster TypeError 对象不是函数

> ID：11510957
> 
> 赞同：1
> 
> 时间：2012-07-16T19:12:26.460
> 
> 标签：node.js

我正在尝试使用 node.js v0.8.2 和集群功能在我的四核机器的每个核心上设置一个 Web 服务器

但是我被困在 TypeError: Object is not a function 上，我确信这是一个简单的错误。

我究竟做错了什么。

这是我正在使用的代码

```
 var cluster = require('cluster')
  , http = require('http');

var server = http.createServer(function(req, res){
  console.log('%s %s', req.method, req.url);
  var body = 'Hello World';
  res.writeHead(200, { 'Content-Length': body.length });
  res.end(body);
});

cluster(server)
  .use(cluster.logger('logs'))
  .use(cluster.stats())
  .use(cluster.pidfiles('pids'))
  .use(cluster.cli())
  .use(cluster.repl(8888))
  .listen(3000); 
```

这是错误

```
 F:\nodeJS\module\one.js:11
cluster(server)
^
TypeError: object is not a function
    at Object. (F:\nodeJS\module\one.js:11:1)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:492:10)
    at process.startup.processNextTick.process._tickCallback (node.js:244:9)
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T20:04:38.003

看起来您正在尝试使用[LearnBoost 中的旧 Cluster 模块](http://learnboost.github.com/cluster/)。自从该模块发布以来，`cluster`它现在是[Node.js 中核心模块](http://nodejs.org/docs/latest/api/cluster.html)的名称，并且 using`require('cluster')`将始终返回核心模块。有关详细信息，请参阅[LearnBoost/集群问题 #166](https://github.com/LearnBoost/cluster/issues/166)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:19:10.577

看起来你过于复杂了集群的使用......试试这个：

```
var cluster = require('cluster')

if ( cluster.isMaster ) {
    for ( var i=0; i<2; ++i )
    cluster.fork();
} else {
    // includes for your app and app controller logic here  (just example using express, etc)
    ///////////////////
    // Server initiation
    ///////////////////
    var app = require('express').createServer(),
         redis = require("redis"), 
         Step = require("step"), 
         client = redis.createClient(siteConf.redisPort, siteConf.redisHost);

    // rest of your app here
} 
```

# php - 可以防止 MySQL 在“解压缩”之后重命名密钥吗？

> ID：11510963
> 
> 赞同：2
> 
> 时间：2012-07-16T19:12:47.803
> 
> 标签：php, mysql, associative, compression

所以我将一些 XML 存储在一个表中，并像这样使用 MySQL 'COMPRESS' 函数：

```
$query = "SELECT UNCOMPRESS(table_row) FROM database WHERE this = 'that'";
$mysqli = $this->ConnectDB();
$result = $mysqli->query($query);
$task_result = $task->fetch_assoc(); 
```

这当然有效，但是它将返回的关联数组中的键从`'table_row'`to重命名`'UNCOMPRESS(table_row)'`。

有没有办法防止这种重命名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:14:44.463

```
$query = "SELECT UNCOMPRESS(table_row) AS table_row 
          FROM database WHERE this = 'that'"; 
```

# wordpress - 函数未附加到 wp_footer 挂钩

> ID：11510966
> 
> 赞同：0
> 
> 时间：2012-07-16T19:12:58.397
> 
> 标签：wordpress, action, hook

我在使此功能正常工作时遇到了一些问题。这一定是我忽略的东西。这是我的代码：

```
if ( is_page_template('template-thankyou.php') ) {
    function eh_add_product_tracking_code(){
        $meta_key = 'product_code';
        $meta_value = get_post_meta($post->ID, $meta_key, true);

        return $meta_value;
    }

    add_action('wp_footer', 'eh_add_product_tracking_code');
} 
```

基本上，我试图从WordPress中的**functions.php文件中添加一个名为****template-thankyou.php**页面`product_code`的页脚的自定义字段。

 ****如您所见，我检查我们是否在使用正确模板的页面上。然后我使用一个函数来获取自定义字段文本并返回它。然后我将它添加到页脚。

页脚什么也不显示。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:22:05.563

添加**全局 $post;** 在你的功能开始。

您在 get_post_meta() 中使用的 $post 变量未指向帖子。****

# perl - 我可以将对象方法别名为不同对象上的不同方法吗？

> ID：11510973
> 
> 赞同：4
> 
> 时间：2012-07-16T19:13:42.247
> 
> 标签：perl

用一个例子更容易解释：

```
my $o = SpecialEffects->new( "config" => 'a' );
my $p = SpecialEffects->new( "config" => 'b' );

$o->sound(); # aliased to fizz(); same as $o->fizz()
$p->sound(); # aliased to clonk(); same as $p->clonk() 
```

在 Perl 中可以做到这一点吗？也许使用一些 typeglob 或 coderef 技巧？

我试图保持`SpecialEffects`界面简单。我不想开始构建对象层次结构。该`sound()`方法是公开的，只有它的行为可以稍微配置。

我已经知道您可以使用别名，`*sound = \&fizz;`但据我所知，这是一个全球性的事情，我希望它封装在对象中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:16:53.087

简单、容易、非巫术的方法是在你的`SpecialEffects`对象中存储一个方法名称，根据你想要发生的任何事情设置它，然后从`sound()`.

```
package SpecialEffects;

sub new {
    my $type = shift;
    my %options = @_;
    my $self = {};
    bless $self, $type;
    if($options{config} eq 'a') {
        $self->{sound_method} = 'fizz';
    } elsif($options{config} eq 'b') {
        $self->{sound_method} = 'clonk';
    }
    return $self;
}

sub sound {
    my $self = shift;
    my $method_name = $self->{sound_method};
    $self->$method_name();
}

sub fizz {
    print "fizz\n";
}

sub clonk {
    print "clonk\n";
} 
```

如果您想变得更聪明，您可以像方法名称一样轻松地存储和使用 coderef。

```
package SpecialEffects;

sub new {
    my $type = shift;
    my %options = @_;
    my $self = {};
    bless $self, $type;
    if($options{config} eq 'a') {
        $self->{sound_code} = $self->can('fizz');
    } elsif($options{config} eq 'b') {
        $self->{sound_code} = $self->can('clonk');
    }
    return $self;
}   

sub sound {
    my $self = shift;
    my $code = $self->{sound_code};
    $self->$code();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:23:03.770

`$o->{sound}()`AFAIK 如果不将引用存储在哈希中（可以完成），您将无法创建每个实例的方法。

方法绑定到类，对应于 perl 包。所以你应该别名化`*SpecialEffects::sound = &SpecialEffects::fizz`。这适用于一个类的所有对象。抱歉，这不是 javascript 等，我自己讨厌这个...

（你可以做一些半向导并动态创建一个包`SpecialEffects::clonky`（在运行时），它只包括`sound`别名`clonk`和 subclasses `SpecialEffects`。然后重新设置你的引用。这实际上是你不需要的层次结构，但你不必实际制作.pm 文件

编辑：我不确定这是如何完成的，但它遵循这些路线↓*如果*它有效，这是一个半优雅的解决方案（它会弄乱你的命名空间）

```
sub whatSoundShallIMake {
  my ($self, $sound) = @_;
  no strict 'refs';
  my $newPackageName = "SpecialEffects::make$sound";
  *{"$newPackageName\::sound"} = &{"SpecialEffects::$sound"}; # make the alias
  @{"$newPackageName\::ISA"} = qw(SpecialEffects); # subclass
  return bless $self, $newPackageName; # rebless
}

say ref $o;
# prints "SpecialEffects"
$o = whatSoundShallIMake($o, "fizz");
say ref $0;
# prints  "SpecialEffects::makefizz" 
```

)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T11:35:42.433

使用[驼鹿](http://moose.perl.org)：

```
package SpecialEffects;
use Moose;

has '_method' => (is => 'ro', isa => 'CodeRef');

around BUILDARGS => sub {
    my ($orig, $class, %args) = @_;
    my %map = (a => 'fizz', b => 'clonk');
    if (my $config = delete $args{config}) {
        $args{_method} = $class->can($map{$config});
    }
    return $class->$orig(%args);
};

sub sound {shift->_method->(@_)}
sub fizz  {return 'fizz';}
sub clonk {return 'clonk';}
1; 
```

* * *

```
use Test::More;
use SpecialEffects;

my $o = SpecialEffects->new(config => 'a');
is($o->sound, 'fizz');
my $p = SpecialEffects->new(config => 'b');
is($p->sound, 'clonk');

done_testing; 
```

* * *

代码学分转到[#moose](http://irc.perl.org)中的 omega ，评论：

> <omega> 但不是真的“干净”：p
> 
> <omega> 而不是那个 Moosey
> 
> <omega> 申请角色可能更好

# objective-c - NSURLConnection GET 最大超时 60 秒？

> ID：11510974
> 
> 赞同：0
> 
> 时间：2012-07-16T19:13:43.073
> 
> 标签：objective-c, timeout, nsurlconnection

我正在为我的项目使用 RestKit，我的请求需要超时，例如 10-20 分钟（600 - 1200 秒）。我可以将超时从 1 秒更改为 60 秒，这可以正常工作。但是当我尝试设置超过 60 秒（90-9999999）时，我在 60 秒后收到超时错误。RKRequest.m 中有这样的代码：

```
- (void)fireAsynchronousRequest {
    RKLogDebug(@"Sending asynchronous %@ request to URL %@.", [self HTTPMethod], [[self URL] absoluteString]);
    if (![self prepareURLRequest]) {
        // TODO: Logging
        return;
    }
    _isLoading = YES;

    if ([self.delegate respondsToSelector:@selector(requestDidStartLoad:)]) {
        [self.delegate requestDidStartLoad:self];
    }

    RKResponse* response = [[[RKResponse alloc] initWithRequest:self] autorelease];

    _connection = [[NSURLConnection connectionWithRequest:_URLRequest delegate:response] retain];

    [[NSNotificationCenter defaultCenter] postNotificationName:RKRequestSentNotification object:self userInfo:nil];
} 
```

我在 NSURLConnection init 之前添加了一行：

```
[_URLRequest setTimeoutInterval:1200]; 
```

但 60 秒后再次收到超时错误。RKResponse 对象是 NSURLconnection 的委托。所以我发现在 60 秒后调用 RKResponce.m 中的委托方法（即使我尝试在 [_URLRequest setTimeoutInterval:1200] 之后初始化 NSURLConnection 对象）：

```
- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    RKResponseIgnoreDelegateIfCancelled();
    _failureError = [error retain];
    NSLog(@"Error %@", error);
    [_request invalidateTimeoutTimer];
    [_request didFailLoadWithError:_failureError];
} 
```

对我来说很奇怪，我不能让 NSURLConnection 超时超过 60 秒。

今天我创建了新项目来测试这个问题。我有这个代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURL *url = [NSURL URLWithString: @"http://5.9.10.68:8182"];
    NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc] initWithURL:url];
    [urlRequest setHTTPMethod:@"GET"];
    [urlRequest setTimeoutInterval:300.0];
    NSLog(@"timeout %f",urlRequest.timeoutInterval);

    NSURLConnection*  urlConnection = [[NSURLConnection alloc] initWithRequest:urlRequest delegate: self];

}
- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {

    NSLog(@"Error request %@", error);

} 
```

所以这里是日志：

2012-07-17 14:37:58.627 f[76799:f803] 超时 300.000000
2012-07-17 14:39:14.488 f[76799:f803] 错误请求错误域=NSURLErrorDomain 代码=-1001“请求超时。 " UserInfo=0x687a690 {NSErrorFailingURLStringKey=http://5.9.10.68:8182/, NSErrorFailingURLKey=http://5.9.10.68:8182/, NSLocalizedDescription=请求超时。, NSUnderlyingError=0x687a070 "请求超时。"}

所以超时= 75，但不是300。很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:23:11.500

试过这种方式吗？

```
RKObjectManager *objectManager = [RKObjectManager objectManagerWithBaseURL:@"http://somewhere.com"];
objectManager.client.timeoutInterval = 600; 
```

# r - 更改公式中变量的名称

> ID：11510976
> 
> 赞同：3
> 
> 时间：2012-07-16T19:13:44.430
> 
> 标签：r

我正在尝试创建通用函数来处理具有多个合理值的数据框。我想要的是将公式传递给函数以执行回归，例如：

`f <- MRPCM ~ DSEX + IEP + ELL3 + SDRACEM + PARED`

该`MRPCM`变量实际上并不存在于数据框中。相反，确实存在五个变量、、`MRPCM1`、`MRPCM2`和。我想要做的是迭代和更新公式（此处）以创建五个公式。这可以做到吗？该功能似乎一次在整个左侧或右侧工作。我还应该注意，在此示例中，我希望更改的变量是因变量，因此可以正常工作。但是，我不知道变量出现在公式中的什么位置。`MRPCM3``MRPCM4``MRPCM5``f``update.formula``update(f, MRPCM1 ~ .)`

例如：

`f <- MRPCM + DSEX ~ IEP + ELL3 + SDRACEM + PARED`

`update.formula(f, as.formula('MRPCM1 ~ .'))`

结果（请注意，现在缺少 DSEX）：

`MRPCM1 ~ IEP + ELL3 + SDRACEM + PARED`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T20:18:16.203

这是一种方法的演示。更复杂的实现可能会更新拟合的线性模型（请参阅 参考资料`?update`），但这超出了您的问题的直接范围。

```
## Make a reproducible example!!
df <- 
setNames(as.data.frame(matrix(rnorm(96), ncol=8)), 
         c("MRPCM1","MRPCM2","MRPCM3","DSEX","IEP", "ELL3","SDRACEM","PARED"))

## Construct a template formula
f <- MRPCM ~ DSEX + IEP + ELL3 + SDRACEM + PARED

## Workhorse function
iterlm <- function(formula, data) {
    ## Find columns in data matching pattern on left hand side of formula
    LHSpat <- deparse(formula[[2]])
    LHSvars <- grep(LHSpat, names(data), value = TRUE)
    ## Run through matchded columns, repeatedly updating the formula,
    ## fitting linear model, and extracting whatever results you want. 
    sapply(LHSvars, FUN=function(var) {
        uf <- update.formula(f, as.formula(paste(var, "~ .")))
        coef(lm(uf, df))
    })
}

## Try it
iterlm(f, df)
##                  MRPCM1     MRPCM2      MRPCM3
## (Intercept)  0.71638942 -0.3883355  0.22202700
## DSEX        -0.07048994 -0.7478064  0.62590580
## IEP         -0.22716821 -0.2381982  0.12205780
## ELL3        -0.44492392  0.1720344  0.41251561
## SDRACEM      0.21629235  0.4800773  0.02866802
## PARED        0.07885683 -0.2582598 -0.07996121 
```

# java - Goo.gl API 自动添加斜杠

> ID：11510988
> 
> 赞同：0
> 
> 时间：2012-07-16T19:14:44.593
> 
> 标签：java, android, goo.gl

使用 Goo.gl API 时，有没有办法告诉它不要自动添加斜杠？因为它弄乱了很多网站，例如，如果您访问：[http](http://www.samsung.com/us/support/SupportOwnersFAQPopup.do?faq_id=FAQ00046726&fm_seq=49755) ://www.samsung.com/us/support/SupportOwnersFAQPopup.do?faq_id=FAQ00046726&fm_seq=49755带有斜杠，它不起作用！有什么建议么？

我的代码：

```
 address= "https://www.googleapis.com/urlshortener/v1/url?key=xxxxxxxxxxxxx"
  DefaultHttpClient client = new DefaultHttpClient();
  HttpPost post = new HttpPost(address);
           try {
                post.setEntity(new StringEntity("{\"longUrl\": \"" +longurl+ "/\"}"));
                post.setHeader("Content-Type", "application/json"); 
                if (userLogin == true) {
                    post.setHeader("Authorization", "OAuth "+accessToken);
                }

            } catch (UnsupportedEncodingException e) {
                e.printStackTrace();
            }
            try {
                org.apache.http.HttpResponse response = client.execute(post);
                String responseBody = EntityUtils.toString(response.getEntity());
                JSONObject object = (JSONObject) new JSONTokener(responseBody).nextValue();
                query = object.getString("id");
                shortUrl = query;
            } catch (ClientProtocolException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            } catch (JSONException e) {
                e.printStackTrace();
            } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:21:44.473

```
post.setEntity(new StringEntity("{\"longUrl\": \"" +longurl+ "/\"}"));
// I think I found the problem -------------------------------^ 
```

您在`longurl`自己之后添加斜线，goo.gl 没有这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T22:15:57.627

还可以考虑使用我制作的库，它提供了一个很好的界面来使用 Goo.gl 服务缩短您的网址。

它支持 api 密钥并且非常易于使用：

```
GoogleShortenerPerformer shortener = new GoogleShortenerPerformer(new OkHttpClient());

String longUrl = "http://www.andreabaccega.com/";

GooglShortenerResult result = shortener.shortenUrl(
    new GooglShortenerRequestBuilder()
        .buildRequest(longUrl)
    );
if ( Status.SUCCESS.equals(result.getStatus()) ) {
    // all ok result.getShortenedUrl() contains the shortened url!
} 
```

看看[这里的 github 存储库，](https://github.com/vekexasia/android-googl-shortener-lib)其中包含更多信息:)

# java - 获取 css 内容，然后为链接验证器解析外部 css 文件的图像引用

> ID：11510994
> 
> 赞同：0
> 
> 时间：2012-07-16T19:15:23.620
> 
> 标签：java, css, web-applications, jsoup

我正在创建一个链接验证器，它采用种子页面并验证该域中的所有链接。例如：[http](http://www.example.com/) ://www.example.com/它应该验证所有属于 example.com 的链接。

我有四种文件：

1.  内容页面
2.  图片
3.  CSS
4.  Javascript 文件

现在我将 JSOUP 库用于内容页面、图像和 Javascript 文件。对于外部的 CSS，问题是我想获取内容，然后获取它具有 URL 引用的所有选择器， `background-image : url('images.png'); border-image: url('border.png');` 因此如何将这些图像的 URL 解析为绝对 URL。我认为 JSOUP 目录不提供任何与 CSS 选择器相关的功能并将它们的值解析为绝对 URL。

是的，我可以进行繁琐的字符串操作，但我认为这很容易出错。所以我在考虑使用内置的东西。

我希望我说清楚了。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:22:28.053

我认为不需要太多的字符串操作，只需在 url 后面加上斜线和 css 引用。如果它有一个 ../ 你删除所有字符，直到“/”我不知道任何内置的东西，对不起。还要确保在链接验证器“点击”任何内部链接之前先完成这些图像，从而更改 URL。

# excel - 在 Excel VBA 中编码时将消息分解为可读

> ID：11510995
> 
> 赞同：0
> 
> 时间：2012-07-16T19:15:31.107
> 
> 标签：excel, vba

我有这个功能，是从另一篇文章中写的，除了我遇到了一个问题，我的消息需要冗长，这样最终用户就不会惊慌，也就是说，我如何在下面打断一个句子，这样它才能在阅读时我在编码？

我希望这是有道理的......谢谢。

```
Function GetErrMsg(ErNo As Long) As String
    Select Case ErNo
        Case 91
            GetErrMsg = "This is a long message that needs to be broken into sections so it can be read normally in the programming box"
    End Select
End Function 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:25:23.117

您可以使用下划线`_`来分解代码行，如下所示：

```
Function GetErrMsg(ErNo As Long) As String
    Select Case ErNo
        Case 91
           GetErrMsg = "This is a long message that needs to be broken into " & _ 
                "sections so it can be read normally in the programming box"
    End Select
End Function 
```

**笔记**

拆分字符串时，您需要以`"`

然后像上面的例子一样在下划线之前添加与符号`&`连接。`_`

这告诉 VBA 字符串已经结束，但将在下一行连接到字符串。

# javascript - Cookie Safari iOS

> ID：11510996
> 
> 赞同：1
> 
> 时间：2012-07-16T19:15:31.827
> 
> 标签：javascript, iphone, mobile-safari

我正在开发一个网站。第一次使用它时，它会显示一个包含一些信息的叠加层。当您从一个页面导航到另一个页面后，由于 cookie，覆盖不再显示。

这适用于每个桌面浏览器......但是当我在我的 iphone 上使用 safari 时，会显示覆盖层，并创建 cookie。如果我刷新页面，我的覆盖不会显示（这意味着我的 cookie 在那里）。

但是如果我要去另一个页面，那么覆盖就会显示..看起来cookie在不同页面之间不可用..

有人知道为什么吗？

谢谢