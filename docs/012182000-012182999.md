# StackOverflow 问答 12182000-12182999

# c# - 如何在 COM+ 服务器中读取配置文件

> ID：12182000
> 
> 赞同：3
> 
> 时间：2012-08-29T16:00:06.057
> 
> 标签：c#, .net, com+

我有一个从代理使用的 COM+ 服务器（项目输出 dll）（我猜这称为客户端应用程序并在 dllhost.exe 下运行）。COM+ 服务器通过服务器控制台应用程序（项目输出 exe）运行，该应用程序本身作为服务运行。

我需要读取 COM+ 服务器 (dll) 中的配置文件。我不知道

1.  我应该在哪里拥有配置文件并使用什么名称？存在一个名为 dllhost.exe.config 的代理配置文件。
2.  如何在 COM+ 服务器中读取此配置文件？
3.  如何在文件中保存我的自定义配置？

我在这里找到了这个[链接](https://stackoverflow.com/questions/516261/com-server-configuration-with-custom-configurationsection)，但我不知道该怎么做。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T09:21:57.013

1) 在 COM+ 应用程序根目录中，您必须放置两个文件：

*   `application.manifest`
*   `application.config`

2）您的`application.manifest`文件可以只有以下内容：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
</assembly> 
```

3）您的`application.config`文件必须与此类似：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings>
    <add key="myPropertyName" value="myPropertyValue"></add>
  </appSettings>
</configuration> 
```

4) 在 COM+ 源代码中，您可以使用

```
System.Configuration.ConfigurationSettings.AppSettings["myPropertyName"] 
```

为了读取配置属性（如果您使用的是 C#）。

**注意**：“应用程序根目录”可以通过使用 COM+ 管理控制台 ( `dcomcnfg.exe`) 的“激活”选项卡来确定。

# maven - Maven（MVN）失败时返回值？

> ID：12182002
> 
> 赞同：6
> 
> 时间：2012-08-29T16:00:26.193
> 
> 标签：maven, batch-file

当我们从批处理 (*.cmd) 脚本运行 mvn clean install 时，无论构建是成功完成还是失败，%ERRORLEVEL% 始终为 0。如何让 Maven 为失败返回一个非零代码？

```
mvn clean install   
echo error:%ERRORLEVEL% 
```

我们正在使用 Maven 2。

* * *

更新：

请注意，如果我们执行“mvn blah”，则由于目标错误导致失败后 ERRORLEVEL=1。

但是，如果我们执行“mvn clean install”，由于复杂错误导致构建失败，我们仍然会得到 ERRORLEVEL=0。

* * *

更新 2：

好的，这是因为我们正在运行 Maven，如下所示：

mvn 干净安装 | 三通 %LOGFILE%

我猜是 T 恤设置了 ERRORLEVEL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T17:18:17.697

好的，这是因为我们正在运行 Maven，如下所示：

mvn 干净安装 | 三通 %LOGFILE%

我猜是 T 恤设置了 ERRORLEVEL。

# java - 如何通过插件将 C++ 程序/图形 UI 集成到 Eclipse

> ID：12182005
> 
> 赞同：1
> 
> 时间：2012-08-29T16:00:35.433
> 
> 标签：java, c++, c, eclipse

我有一个分析媒体文件并输出其素材的c++程序，所以这个应用程序的图形屏幕很复杂，就像股票程序中的图形和图表一样。我现在想开发 eclipse 插件以将其集成到 eclipse 中（不是外部窗口），我知道这甚至是不可能的通过 swing/awt 重写图形 UI，有什么方法可以集成 c++ 程序和 UI 来显示蚀？

谢谢。任何指导方针将不胜感激。

# facebook - facebook 洞察 API 是否为评论以外的任何故事类型返回 post_impressions_by_story_type？

> ID：12182007
> 
> 赞同：0
> 
> 时间：2012-08-29T16:00:39.233
> 
> 标签：facebook, facebook-page, facebook-insights

查看我的帖子洞察 API 数据，该`post_impressions_by_story_type`指标似乎仅返回评论故事类型生成的印象的值。

对于类似的指标，例如`post_storytellers_by_action_type`见解 API 返回评论值、点赞、分享、关注和回答。

指标本身是否如此？有没有可能我的内容没有通过评论以外的动作/故事产生任何印象？

文档简单地将指标描述为

> 通过查看帖子的人的朋友发布的故事看到此帖子的次数

# ruby-on-rails - Watir/Ruby - 遍历搜索结果列表 - 搜索元素，如果找到元素 - 操作并退出循环

> ID：12182009
> 
> 赞同：0
> 
> 时间：2012-08-29T16:00:44.383
> 
> 标签：ruby-on-rails, watir-webdriver

我目前有一个搜索结果列表，我想循环并找到一个特定的元素。这个元素可以出现多次（从几次到数千次），但我只想找到元素的第一个实例，单击它然后退出我的循环。

尝试了以下，但认为我有点偏离

```
i = 0
@browser.div(:id=>"resultsList").lis.each do|li| -- loop through list
@browser.link(:href=>"linkname").exists --- check if element exists
@browser.goto(@browser.link(:href=>"linkname") --if it exists click

break if i == 1 ---then break out of loop

end 
```

任何指针将不胜感激谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:36:13.067

您不需要遍历元素。默认情况下，Watir-Webdriver 将返回第一个匹配的元素。

做就是了：

```
@browser.div(:id=>"resultsList").link(:href=>"linkname").click 
```

这将单击搜索结果中具有“链接名称”href 的第一个链接。请注意，如果您确实希望链接文本（而不是 href）与“链接名称”匹配，则应该是`link(:text=>"linkname")`.

# tomcat - Tomcat的Grails部署

> ID：12182019
> 
> 赞同：2
> 
> 时间：2012-08-29T16:01:13.837
> 
> 标签：tomcat, grails, war

我成功地制作了一个 Grails War 文件。当我将war文件（多站点）放在tomcat服务器（web-app文件夹）上并启动服务器时，URL不起作用“http://localhost:8080/multisite”。我收到“请求的资源不可用”的消息。感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T16:02:23.273

我以这种方式解决了这个问题。在 BuildConfig.groovy 文件中有 "grails.project.war.file = "target/${appName}-${appVersion}.war"。当我**只使用 war**命令时，它会产生**MultiSite-0.1.war**。我把这场战争在tomcat WebApp文件夹中的文件。我可以获取URL的第一页但不能获取其他页面。似乎其他URL是基于项目名称而没有任何版本。我更改了grails.project.war.file =“target/ ${appName}.war”，然后一切正常。

# lucene - Jackrabbit lucene ItemNotFoundException - 如何重现/导致索引损坏的原因

> ID：12182020
> 
> 赞同：0
> 
> 时间：2012-08-29T16:01:27.527
> 
> 标签：lucene, jackrabbit, corrupt

当我们看到这些异常突然发生时，我们的 lucene 索引似乎正在变得腐败。我们通过删除索引文件夹来修复它，以便重建索引。

问题是，我们无法可靠地重现此异常，因此很难找出导致它的原因。

任何人都知道哪种长耳兔动作最有可能破坏搜索索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T16:37:42.787

看来这可能是由于容器中断并击中了一只[长耳兔虫](https://issues.apache.org/jira/browse/JCR-3469)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T10:25:15.740

We have this kind of problems with hard 'reboot' of Jackrabbit like killing the server running the application. Maybe some of it will disappear with the use of Lucene 3.6 (in Jackrabbit 2.5.1).

# c# - C# 和模态窗口

> ID：12182021
> 
> 赞同：0
> 
> 时间：2012-08-29T16:01:28.583
> 
> 标签：c#, window, modal-dialog

我有以下情况：一些数据完成的主窗口，它也是一个按钮，打开一个新的模式窗口，您可以在其中选择产品和产品范围，我单击确定并进入下一个屏幕，其中选择数量，价格，并在我点击确定的数据批准后，我想访问主窗口中模式窗口中选择的数据，因为它可以使用 C# 来完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:08:25.273

你可以做一些看起来或多或少像这样的事情：

```
private void button1_Click(object sender, EventArgs e)
{
    Form2 firstPopup = new Form2();
    firstPopup.ShowDialog();
    var someData = firstPopup.SomeValue;

    Form2 secondPopup = new Form2();
    secondPopup.ShowDialog();
    var someOtherData = secondPopup.SomeValue;

    doSomeStuff(someData, someOtherData);
} 
```

在这种情况下`SomeValue`，表单上的属性具有公共 getter 和私有 setter。它的值将在表单关闭之前的某个时间设置。您可以在每个表单中拥有任意数量的此类属性，以及任意数量的表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:10:09.073

这类似于“打开”、“另存为”和“文件夹”对话框的工作方式。以打开文件对话框为例，一旦您单击确定，您就可以访问被选中的文件

建议：

在您的模态窗口中，设置一些保存数据的公共属性。设置 OK 按钮以将表单 DialogResult 设置为 OK，在您的父表单中，您可以执行以下测试（在这种情况下，DataModel 是您尝试访问的数据）

```
if(modalWindow.DialogResult == DialogResult.OK)
{
    this.DataModel = modalWindow.DataModel;
} 
```

以下是有关如何使用 DialogResult 的一些信息 [http://msdn.microsoft.com/en-us/library/system.windows.forms.form.dialogresult.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.dialogresult.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:11:06.860

通常，在模态窗口中，您遵循与 OpenFileDialog 使用的模式类似的模式，您可以在其中执行以下操作：

```
public class MyDialog : Form
{
  public MyResult Result { get { /* code elided */ } }
} 
```

即，除了具有模态表单的代码之外 - 您还公开了`Result`给定类型的公共属性，该属性可以提供在该表单的 UI 上输入的数据（这比在表单上公开控件更好，因为这意味着您可以自由更改所有这些都无需重新编码依赖它的任何其他形式）。

如果单击或（无论确认按钮是什么）按钮，请确保*保证*`Result`可用*且有效。*然后确保相应地设置表单的 （您也可以为每个按钮分配一个 - 例如取消按钮）。**`Ok``Yes``DialogResult``DialogResult.Cancel`**

 **然后，当您打开表单时，您会执行以下操作：

```
var form1 = new MyDialog();

if(form1.ShowDialog() != DialogResult.OK)
  return; //abort the operation, the user cancelled/closed the first modal

MyResult form1Data = form1.Result;  //get your actual data from that modal form.
//...and then on with your second modal 
```

因此，您可以在进行过程中从模式中收集数据，如果有任何被取消，则中止。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T16:24:18.507

尽量不要使用模态窗口！

如果你打电话

```
var dialog = new DialogWindow();
If (dialog.ShowDialog(mainWindow) == DialogResult.OK) {
    use the result of the dialog window
} 
```

对话窗口将是模态的，这意味着当它打开时您无法访问其他窗口。

使用以下代码，可以同时访问两个窗口。然而，问题是，在对话框运行时主窗口中的代码没有暂停。

```
var dialog = new DialogWindow();
dialog.Show(mainWindow);
You cannot use the result of the dialog window here! 
```

因此，您需要一种方法将对话框的完成传达给主窗口。为此，我建议在对话框窗口中创建一个事件

```
public class ProductResultEventArgs : EventArgs
{
    public ProductResultEventArgs(List<Product> products)
    {
        Products = products;
    }

    public List<Product> Products { get; private set; }
} 
```

在对话窗口中

```
public event EventHandler<ProductResultEventArgs> ProductsChosen;

private void OnProductsChosen(List<Product> products)
{
    var eh = ProductsChosen;
    if (eh != null) {
        eh(this, new ProductResultEventArgs(products));
    }
}

private BtnOk_Click(object sender, EventArgs e)
{
    OnProductsChosen(somehow get the product list);
} 
```

在主窗口中，您可以执行以下操作

```
var dialog = new DialogWindow();
dialog.ProcuctsChosen += Dialog_ProductsChosen
dialog.Show(mainWindow); 
```

并创建一个处理程序

```
private Dialog_ProductsChosen(object sender, ProductResultEventArgs e)
{
     use e.Products here
} 
```

* * *

注意：将主窗口作为参数传递给`ShowDialog`或`Show`使主窗口成为对话框的所有者。这意味着对话窗口将始终停留在主窗口的前面，而不会消失在主窗口后面。如果您最小化主窗口，这也会最小化对话窗口。**

# macos - Vim 中整个目录的 svn-diff 并排视图

> ID：12182024
> 
> 赞同：1
> 
> 时间：2012-08-29T16:01:30.423
> 
> 标签：macos, svn, vim, diff, macvim

我在我的 OSX 机器上安装了 MacVim，因此默认`Vim`应用程序（即：/usr/bin/vim）实际上是指向 MacVim 附带的命令行版本的 Vim 的符号链接（即：/Applications/MacVim.app /MacOS/vim)，因为它比 OSX10.6 附带的普通 Vim 提供了一些关键优势。

我需要定期准备一组文件之间的差异，并将其导出为彩色的并排查看 HTML 文件。这通常通过以下方式实现：

```
vim -d file1 file2
(Within Vim): toHTML 
```

这样做的问题是我必须手动检查这两组文件的 HEAD 版本和特定版本，并为每对文件执行此操作。这是非常耗时的。

是否可以将`svn diff`命令的结果通过管道传输到 Vim，这样我就可以为整个目录（即：PWD）提供一个彩色的并排视图差异，而不仅仅是统一的差异视图？

我发现了几个试图实现这一点的 Vim 脚本和 bash 脚本，但有两个关键问题：

1.  我希望显式调用`vim -d`diff 工具，而不是`vimdiff`，因为 MacVim 应用程序似乎没有附带`vimdiff`，所以在启动应用程序时我会使用错误的 Vim 版本

2.  我希望递归地针对整个目录生成多文件差异，而不是一次只生成一个或两个文件。

如果这不可行，我可能会创建一个或多或少实现此目的的 bash 脚本，但如果有更有效的方法可以做到这一点，我想避免将一个被黑/不可靠的脚本放在一起。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T04:34:00.027

`vimdiff`只是 的替代名称`vim`。二进制文件检查它是如何启动的并相应地确定它的行为。`gvim`（这就是为什么and没有不同的文件的原因`vim`。）

在我的 Mac OS 和 Linux 机器上，我创建了一个`~/bin`目录，然后在其中创建了从各种名称到我的 macvim 二进制文件的软链接。我`~/bin`很早就开始了我的道路。

我不在工作，我可以检查以确保，但我认为您可以更改默认的 SVN 差异以指向`vimdiff`~/.subversion/config。寻找`diff-cmd`部分。[https://stackoverflow.com/a/9604604/128421](https://stackoverflow.com/a/9604604/128421)也可能会为您提供一些有用的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:18:07.360

你可以试试我的[aurum](https://bitbucket.org/ZyX_I/aurum)插件，它附带的`:AuVimDiff`命令也能够通过 vimdiff split 查看多个选项卡中的所有更改：

```
AuVimDiff full HEAD 300 
```

并获得两个修订之间的差异，而无需手动签出它们：

```
AuVimDiff file file1 HEAD 300 
```

（`file file1`部分是可选的，如果省略，它将与当前文件打开 diffsplit。所有修订也是可选的，对于 subversion，指定一个修订就是将其与工作目录中的文件进行比较，并且不指定修订就像`svn diff`: 在 BASE 和工作目录之间。）

这里的 300 只是一个示例修订。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T20:26:56.843

从那以后，我在我最近的另一篇文章中完全解决了这个问题。为未来的读者发布一个回溯 URL：

[VIM - 通过命令行传递冒号命令列表](https://stackoverflow.com/questions/16701931/vim-passing-colon-commands-list-via-command-line)

# html - 如何在右侧制作一个固定宽度的列，该列在 IE 9 中的正常和兼容模式下工作？

> ID：12182025
> 
> 赞同：0
> 
> 时间：2012-08-29T16:01:33.183
> 
> 标签：html, css, cross-browser, internet-explorer-9, ie8-compatibility-mode

考虑以下 HTML：

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
<div style="border-style: solid; border-width: thin; width:100%">
    <input type="button" style="width:20px;float:right;" value="a" />
    <div style="padding-right:35px;">
            <input type="text" style="width: 100%;" />
    </div>
</div>
</body>
</html> 
```

这是正确的布局，以及它在正常模式下在 IE 9 中的外观。如果你拉伸浏览器，按钮保持在输入框的右侧，输入框也会相应地拉伸。

![IE 9 正常](../Images/8a514315937d4cfceb28a4923a56e0e4.png)

这就是它在兼容模式下在 IE 9 中的外观。如您所见，输入框跳转到下一行：

![IE 9 兼容模式](../Images/ca8559c186b3e771395eadd6edb00b56.png)

那么，有没有办法解决这个问题，无论是否设置了兼容模式，它都能正常工作？

显然，我正在寻找一个黑客行为最少的解决方案:)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:22:16.107

试试这个 HTML：

```
<div class="search"><input name="btn" type="button" value="a" /><span><input type="text" name="search_input" /></span></div> 
```

使用这个 CSS：

```
.search > span {
  display: block;
  overflow: hidden;
  padding-right: 10px;
}
.search input[type=text] {
  width: 100%;
}
.search input[type=button] {
  float: right;
} 
```

这是一个 jsfiddle 自己测试一下：

[http://jsfiddle.net/KVhUC/](http://jsfiddle.net/KVhUC/)

我能够让它与 FF、IE9 一起工作（有/无兼容模式）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:39:57.213

[http://jsfiddle.net/Cytkx/4/](http://jsfiddle.net/Cytkx/4/)

```
<div style="border-style: solid; border-width: thin;">
    <input type="button" style="width:20px;float:right;overflow:hidden;" value="a" />
    <div style="overflow:hidden;padding-right:10px;">
        <input type="text" style="display:block;width:100%;" />
    </div>
</div> 
```

我相信这与您正在寻找的内容很接近。请注意，这可能不向后兼容。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-29T16:08:50.087

您可以尝试使用`<Table> </Table>`而不是`Div`. 与 div 相比，它们是更好的容器。

# asp.net - 如何在 URL 中访问控制器而不是部分视图的控制器

> ID：12182030
> 
> 赞同：1
> 
> 时间：2012-08-29T16:02:01.187
> 
> 标签：asp.net, .net, asp.net-mvc-3

我有一个布局视图，在我调用的布局视图内

```
@Html.Action("ToolBarAction", "ToolBarController") 
```

在 ToolBarAction 返回的视图中，我想在 URL 中获取控制器，但是当我调用

```
ViewContext.Controller.ValueProvider.GetValue("controller").RawValue; 
```

..我得到“工具栏控制器”

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:16:44.020

你试过了吗？

~~`ViewContext.RouteData.Values["controller"]`~~

**更新**

```
ViewContext.ParentActionViewContext.RouteData.Values["controller"] 
```

# php - Cakephp 手动登录未启动会话

> ID：12182038
> 
> 赞同：1
> 
> 时间：2012-08-29T16:02:39.703
> 
> 标签：php, cakephp

我正在使用他们的 fb 用户 ID 登录用户。因此，我在登录用户时不需要用户名或密码。这工作正常。但是，当我尝试访问时，`$this->Auth->user`什么都没有保存。请看下面的代码。

```
$this->authUser = $this->User->findById($user_profile['id']);
        if($this->authUser){
            if($this->Auth->login($this->authUser)){
            $this->redirect('/Users/dash');
            } 
```

有任何想法吗？

如果我调试`$this->Auth`而不是进行重定向，我会得到以下信息：

```
object(AuthComponent) {
components => array(
    (int) 0 => 'Session',
    (int) 1 => 'RequestHandler'
)
authenticate => array(
    (int) 0 => 'Form'
)
authorize => array(
    (int) 0 => 'Controller'
)
ajaxLogin => null
flash => array(
    'element' => 'default',
    'key' => 'auth',
    'params' => array()
)
loginAction => array(
    'controller' => 'users',
    'action' => 'login',
    'plugin' => null
)
loginRedirect => null
logoutRedirect => array(
    'controller' => 'users',
    'action' => 'login',
    'plugin' => null
)
authError => 'You can't access that page'
allowedActions => array(
    (int) 0 => 'index',
    (int) 1 => 'view'
)
request => object(CakeRequest) {
    params => array(
        'plugin' => null,
        'controller' => 'Users',
        'action' => 'index',
        'named' => array(),
        'pass' => array()
    )
    data => array(
        'signed_request' => 'Xyx9uGB4OZT_S59w-sMmJe5ofuzCwib2F1dGhfdG9rZW4iOiJBQUFEcDlCdlpDMzRjQkFJSlBaQ3VwVGtoTlJRRGdIWkJEU0IxeWlTZDFhRTNLcXg1TzJma2Ewek1yOUlrTkVUZTBWbGNpaUxhMFpDUWFQd0ZOWVF3MnZyU1B4NXFrV2VqMjlOMzY4NXJ2d1pEWkQiLCJwYWdlIjp7ImlkIjoiMjQ3ODg2NjY1MzMxOTgwIiwibGlrZWQiOnRydW8BPoTx2YAtQtdin0.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIsImV4cGlyZXMiOjEzNDYyNjMyMDAsImlzc3VlZF9hdCI6MTM0NjI1NzU3NUsImFkbWluIjp0cnVlfSwidXNlciI6eyJjb3VudHJ5IjoiZ2IiLCJsb2NhbGUiOiJlbl9HQiIsImFnZSI6eyJtaW4iOjIxfX0sInVzZXJfaWQiOiI2NjEyNjMzODgifQ'
    )
    query => array()
    url => 'Users/index'
    base => ''
    webroot => '/'
    here => '/Users/index'
}
response => object(CakeResponse) {

}
settings => array(
    'authError' => 'You can't access that page',
    'authorize' => array(
        (int) 0 => 'Controller'
    )
)
Session => object(SessionComponent) {
    settings => array()
    components => array()
} 
```

}

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T06:23:08.500

试试这个（对我有用，我用它在帐户激活后自动登录用户）：

```
$user = $this->User->findById($id);
$user = $user['User'];
$this->Auth->login($user); 
```

$this->Auth->user 也不是属性。如果你想访问它，你必须写`$this->Auth->user();`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T04:42:36.060

您无法登录，因为查找结果包含散列密码。并且`$this->Auth->login()`方法将再次将其转换为散列密码。[您无法解密散列密码](https://stackoverflow.com/questions/4070987/cakephp-securitycipher-decrypt-not-working)。

您可以使用以下代码执行此操作：

```
 if($this->Auth->login($user_profile['id'])){
        $this->redirect('/users/dash');
        } 
```

Auth::login 接受用户名/密码组合或简单的用户 ID（数据库中用户模型的主键）。

# .net - 在可移植类库中，我是否可以从其 Silverlight 定义具有在 .NET Framework 中找不到的空构造函数的类继承？

> ID：12182040
> 
> 赞同：2
> 
> 时间：2012-08-29T16:02:47.313
> 
> 标签：.net, silverlight, .net-4.5, portable-class-library

我们有一个类 WeakRef，它继承自 WeakReference。此类最初是针对标准 .NET 框架的命名空间的一部分。最近，我们迁移到 .NET 4.5 并决定使用可移植类库。我们包含了 WeakRef，但在 Silverlight 应用程序中引用它会导致以下运行时异常：

*   $exception {System.TypeInitializationException: 'AxisModel.ImageDownloadAlert' 的类型初始化程序引发了异常。---> System.TypeLoadException：类型违反了继承安全规则：'Common.WeakRef`1'。派生类型必须要么与基类型的安全可访问性相匹配，要么难以访问。如果基类具有不透明的默认构造函数，则派生类也必须具有默认构造函数，并且方法继承规则适用于这两个方法。

    在 Common.WeakRefCallbackHostCore`1..ctor(Object syncRoot)
    在 AxisModel.ImageDownloadAlert..ctor()
    在 AxisModel.ImageDownloadAlert..cctor()

    --- 内部异常堆栈跟踪结束 ---
    在 SLWebApp.App..ctor()
    的 AxisModel.ImageDownloadAlert.get_Instance()}

    System.Exception {System.TypeInitializationException}

我注意到 Silverlight 版本的 WeakReference 有一个空的默认构造函数，而标准 .NET 版本的 WeakReference 则不是这种情况。我认为这是引发异常的原因，因为 WeakRef 不包含空构造函数。问题是向此类添加空构造函数会导致我们的 WPF 应用程序出现编译错误。

有没有办法在我们的 Silverlight 和 WPF 应用程序之间共享 WeakRef 而不会导致运行时和编译错误？我正在寻找微创解决方案。

**更新：**

已经有一些关于在 Silverlight 中继承 WeakReference 的讨论。显然，这是不可能的，因此必须创建一个包含 WeakReference 实例的类。但是，无论是否涉及 WeakReference，是否可以从类似于 WeakReference 的类继承，因为它的 Silverlight 定义有一个空的默认构造函数，而它的 .NET Framework 定义没有？

讨论可以在这里找到：

[继承的 WeakReference 在 Silverlight 中抛出 ReflectionTypeLoadException](https://stackoverflow.com/questions/3231945/inherited-weakreference-throwing-reflectiontypeloadexception-in-silverlight)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:19:23.743

什么是复制品？出于这个原因，我们不会在 Visual Studio 2012 的 RTM 位中公开 WeakReference 的默认构造函数。你用的是什么版本？

# java - 列表上同步的这两种用法之间的行为有什么区别

> ID：12182042
> 
> 赞同：6
> 
> 时间：2012-08-29T16:02:57.800
> 
> 标签：java, concurrency, synchronized

```
List<String> list = new ArrayList<String>();
list.add("a");
...
list.add("z");

synchronized(list) {
    Iterator<String> i = list.iterator();
    while(i.hasNext()) {
        ...
    }
} 
```

和

```
List<String> list = new ArrayList<String>();
list.add("a");
...
list.add("z");

List<String> synchronizedList = Collections.synchronizedList(list);

synchronized(synchronizedList) {
    Iterator<String> i = synchronizedList.iterator();
    while(i.hasNext()) {
        ...
    }
} 
```

`synchronized`具体来说，当同步列表提供对列表的线程安全访问时，我不清楚为什么在第二种情况下需要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T16:06:41.013

如果您不锁定迭代，如果另一个线程在循环期间修改它，您将收到 ConcurrentModificationException。

同步所有方法并不能阻止这一点。

这（以及许多其他事情）`Collections.synchronized*`是完全没用的原因。
您应该使用`java.util.concurrent`. （并且您应该仔细考虑如何保证您的安全）

作为一般经验法则：

> 对每个方法都加锁*不足以*使某些东西成为线程安全的。

有关更多信息，请参阅[我的博客](http://blog.slaks.net/2013-07-22/thread-safe-data-structures)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T16:19:53.393

`synchronizedList`只使每个调用原子。在您的情况下，循环进行多次调用，因此在每次调用/迭代之间，另一个线程可以修改列表。如果您使用其中一个并发集合，则不会出现此问题。

看看这个集合与 ArrayList 有何不同。

```
List<String> list = new CopyOnWriteArrayList<String>();
list.addAll(Arrays.asList("a,b,c,d,e,f,g,h,z".split(",")));

for(String s: list) {
    System.out.print(s+" ");
    // would trigger a ConcurrentModifcationException with ArrayList
    list.clear(); 
} 
```

即使列表被反复清除，它也会打印以下内容，因为这是创建迭代器时的内容。

```
a b c d e f g h z 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T16:20:50.387

由于同步列表的实现方式，第二个代码需要同步。这[在 javadoc 中](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29)有解释：

> 用户在迭代返回的列表时必须手动同步它

两个代码片段的主要区别在于`add`操作的效果：

*   `synchronizedList.get(..)`使用同步列表，您可以获得可见性保证：例如，如果其他线程调用，它们将看到新添加的项目。
*   使用 ArrayList，其他线程可能不会立即看到新添加的项目 - 他们实际上可能永远不会看到它们。

# g++ - 无法参考 uhd(USRP)

> ID：12182043
> 
> 赞同：0
> 
> 时间：2012-08-29T16:03:01.633
> 
> 标签：g++, ubuntu-12.04, gnuradio, uhd

编译使用 g++ 和 ubuntu 12.04 的 cpp 程序时存在一些链接器问题

从 repo 安装 uhd。libuhd.so 文件位于 /usr/lib

现在我的问题是

1.对于链接 uhd，我使用了 -luhd，但这给了我一个错误 undefined reference to `uhd::set_thread_priority_safe(float, bool)'

我应该将 libuhd 的库路径添加到 LD_LIBRARY_PATH 吗？

我通过命令 export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/libuhd.so 做到了这一点

在此之后我尝试再次编译但同样的错误？如果你能帮助我就太好了谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:41:22.137

uhd::set_thread_priority_safe 是您在整个程序中调用的唯一 UHD 函数吗？奇怪的是，这是您从程序中看到的唯一未定义的引用。如果它是那里唯一的功能，那么它根本就没有找到库。如果不是，听起来您拥有的 UHD 版本很奇怪。

您是否尝试过：

```
$ sudo ldconfig 
```

...在将库路径添加到 /etc/ld.so.conf 之后？

当你说你从 repo 安装它时，你指的是什么 repo？你在运行什么发行版？

# objective-c - 将颜色更改为 UITableView 中的标题

> ID：12182046
> 
> 赞同：0
> 
> 时间：2012-08-29T16:03:16.990
> 
> 标签：objective-c, uitableview, uiview

我想更改标题中的字体颜色，所以我委托 viewForHeaderInSection：

```
- (UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
     UIView *headerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, tableView.bounds.size.width, 30)];

     UILabel *headerLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, tableView.bounds.size.width, 30)];

    [headerLabel setBackgroundColor:[UIColor whiteColor]];
    [headerLabel setTextColor:[UIColor blackColor]];
    [headerView addSubview:headerLabel];

    return headerView;
 } 
```

背景颜色已设置，但文字喜欢透明，什么都没有。

我试图评论 backgroundColor 白色消失但文本没有。

我试图评论所有块，文本以默认颜色显示。

我的错误在哪里？先感谢您

我找到了，我错过了：

```
[headerLabel setText: @"myText"]; 
```

看起来：

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection: (NSInteger)section 
```

实现 viewForHeaderInSection 时不调用。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:28:30.240

希望 UITableViewDelegate 协议中的这个方法能让你开始：

```
- (UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
{
UIView *headerView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, tableView.bounds.size.width, 30)] autorelease];
 if (section == integerRepresentingYourSectionOfInterest)
 [headerView setBackgroundColor:[UIColor redColor]];
  else 
 [headerView setBackgroundColor:[UIColor clearColor]];
  return headerView;
} 
```

将 [UIColor redColor] 替换为您想要的任何 UIColor。您可能还希望调整 headerView 的尺寸。

# jquery - 使用jQuery淡入和淡出多个DIV

> ID：12182049
> 
> 赞同：2
> 
> 时间：2012-08-29T16:03:26.017
> 
> 标签：jquery, html, fadein, fadeout

你能这么好心并帮助解决我的 jQuery 问题吗？想想我已经没力气了。

我有这种结构：

```
<div id="trigger-1">Trigger 1</div>
<div id="trigger-2">Trigger 2</div>
<div id="trigger-3">Trigger 3</div>
 ...
<div id="trigger-n">Trigger n</div>

<div id="content-1">Content 1</div>
<div id="content-2">Content 2</div>
<div id="content-3">Content 3</div>
 ...
<div id="content-n">Content n</div> 
```

所有对象都是独立的，我的意思是没有关系父->子。我想要得到的是在元素 ID 中运行具有相同数字的触发器后淡入标记为内容的 DIV。如果我有例如 5 对 DIV，我知道如何获取它，但是如果我有无限对 div，我将无法创建脚本。

当然，如果 content-1 DIV 可见，按下 trigger-2 会触发 content-1 的淡出和 content-2 的淡入。

谢谢您的答复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:06:03.977

我建议：

```
$('div[id^="trigger"]').click(
    function(){
        var num = this.id.match(/\d+/);
        $('div[id^="content-"]').fadeOut();
        $('#content-' + num).fadeIn();
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/TNHHx/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:06:40.510

您可以使用`attribute starts with`选择器：

```
$('div[id^="trigger"]').click(function(){
   var id = this.id.slice(-1)
   $('div[id^="content"]').fadeOut();
   $('#content-'+id).fadeIn()
}) 
```

但最好使用类：

```
<div class='trigger' id="trigger-1">Trigger 1</div>
<div class='trigger' id="trigger-2">Trigger 2</div>
<div class='trigger' id="trigger-3">Trigger 3</div>
 ...
<div class='trigger' id="trigger-n">Trigger n</div>

<div class='content' id="content-1">Content 1</div>
<div class='content' id="content-2">Content 2</div>
<div class='content' id="content-3">Content 3</div>
 ...
<div class='content' id="content-n">Content n</div> 
```

```
$('.trigger').click(function(){
   var id = this.id.slice(-1)
   $('.content').fadeOut();
   $('#content-'+id).fadeIn()
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:06:25.543

伪代码：

```
for(i=1; i<n; i++) {
    $('#trigger-'+i).click(function() {
        if($('#content-'+(i-1)).visible) $('#content-'+(i-1)).fadeOut();
        $('#content-'+i).fadeIn();
    });
} 
```

# javascript - Cordova 启动画面在异步请求期间挂起

> ID：12182051
> 
> 赞同：1
> 
> 时间：2012-08-29T16:03:27.627
> 
> 标签：javascript, jquery-mobile, cordova

我正在构建一个 Cordova 应用程序，我们实际上已经完成，除了该应用程序在特定条件下表现不佳的事实。在这种情况下，会进行一系列异步 ajax 调用（在收到响应时大约需要 15 秒）。一旦页面已经加载并显示，就应该进行这些调用。因此，它们是在登录页面的 onpageshow 功能中制作的。问题是 Cordova 闪屏会一直显示到通话完成。我现在唯一的理论是，Cordova 在网络安静之前不会终止启动画面。有谁知道如何让 Cordova 忽略这些服务器调用？我试图打电话`cordova.exec(null, null, "SplashScreen", "hide", [])`在 deviceready 上，但这似乎并没有让它消失。如果它是相关的，那么当它已经在应用程序中被调用并且用户并不聪明时，这个完全相同的服务器调用异步运行就很好。问题似乎仅在于应用程序加载。

提前感谢您的任何帮助或想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:44:53.513

如果您在获得“deviceready”事件之前进行 AJAX 调用，则可能会延迟 Android 原生端的 onPageFinished 事件。尝试将 AJAX 调用放在您的 deviceready 事件处理程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T15:15:12.683

我们通过在启动异步请求的函数调用上设置 1 秒超时来解决此问题。我不会接受这个作为答案，因为它更像是一种变通方法而不是一种解决方案。从我花在这个问题上的时间来看，我只能说，Cordova 似乎在等待 javascript 空闲，然后再删除启动屏幕。由于异步调用是在 javascript 自然空闲之前进行的最后一次调用，因此设置 1 秒超时似乎可行。奇怪的是，鉴于这是一个异步调用，javascript 应该在调用之后直接空闲。也许科尔多瓦也在等待网络安静下来。这只是猜测，但希望它能给未来的读者一些关于如何解决问题的想法。

# python - 使用 pip 安装 Mayavi - 没有名为 vtk 的模块

> ID：12182052
> 
> 赞同：35
> 
> 时间：2012-08-29T16:03:29.260
> 
> 标签：python, installation, pip, vtk, mayavi

我想使用 Mayavi。

## 情况

*   我使用带有 OSX 10.7.3 的 MacBook Air。
*   我使用 Python 2.7.2
*   我已经`virtualenv`安装了。但是我没有将它用于此安装。

我已经手动安装了它的所有依赖项，包括`VTK`.

对于`VTK`，我按照它的安装指南安装了 python 包装器。

现在，如果我打开一个新的终端窗口并打开 python，我可以毫无错误地导入`vtk`。

## 问题

我尝试使用以下命令安装 Mayavi：

```
pip install mayavi 
```

但是会出现以下错误：

```
Downloading/unpacking mayavi
  Running setup.py egg_info for package mayavi
    build_src
    building extension "tvtk.array_ext" sources
    building data_files sources
    build_src: building npy-pkg config files

    no previously-included directories found matching 'artwork'
    no previously-included directories found matching 'docs/pdf'
Requirement already satisfied (use --upgrade to upgrade): apptools in /Library/Python/2.7/site-packages (from mayavi)
Requirement already satisfied (use --upgrade to upgrade): traits in /Library/Python/2.7/site-packages (from mayavi)
Requirement already satisfied (use --upgrade to upgrade): traitsui in /Library/Python/2.7/site-packages (from mayavi)
Requirement already satisfied (use --upgrade to upgrade): configobj in /Library/Python/2.7/site-packages (from apptools->mayavi)
Requirement already satisfied (use --upgrade to upgrade): pyface in /Library/Python/2.7/site-packages (from traitsui->mayavi)
Installing collected packages: mayavi
  Running setup.py install for mayavi
    Traceback (most recent call last):
      File "<string>", line 1, in <module>
      File "/Users/Yasser/build/mayavi/setup.py", line 498, in <module>
        **config
      File "/Library/Python/2.7/site-packages/numpy-1.6.1-py2.7-macosx-10.7-intel.egg/numpy/distutils/core.py", line 186, in setup
        return old_setup(**new_attr)
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/core.py", line 152, in setup
        dist.run_commands()
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 953, in run_commands
        self.run_command(cmd)
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
        cmd_obj.run()
      File "/Library/Python/2.7/site-packages/numpy-1.6.1-py2.7-macosx-10.7-intel.egg/numpy/distutils/command/install.py", line 57, in run
        r = self.setuptools_run()
      File "/Library/Python/2.7/site-packages/numpy-1.6.1-py2.7-macosx-10.7-intel.egg/numpy/distutils/command/install.py", line 31, in setuptools_run
        return old_install_mod._install.run(self)
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/command/install.py", line 573, in run
        self.run_command('build')
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/cmd.py", line 326, in run_command
        self.distribution.run_command(command)
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
        cmd_obj.run()
      File "/Users/Yasser/build/mayavi/setup.py", line 303, in run
        build_tvtk_classes_zip()
      File "/Users/Yasser/build/mayavi/setup.py", line 290, in build_tvtk_classes_zip
        gen_tvtk_classes_zip()
      File "tvtk/setup.py", line 46, in gen_tvtk_classes_zip
        from code_gen import TVTKGenerator
      File "tvtk/code_gen.py", line 10, in <module>
        import vtk
    ImportError: No module named vtk
    Complete output from command /usr/bin/python -c "import setuptools;__file__='/Users/Yasser/build/mayavi/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /var/folders/53/_trhc_0x0fb6kvx6bw_wrk500000gn/T/pip-Z4hpsW-record/install-record.txt:
    running install

running build

Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/Users/Yasser/build/mayavi/setup.py", line 498, in <module>

    **config

  File "/Library/Python/2.7/site-packages/numpy-1.6.1-py2.7-macosx-10.7-intel.egg/numpy/distutils/core.py", line 186, in setup

    return old_setup(**new_attr)

  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/core.py", line 152, in setup

    dist.run_commands()

  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 953, in run_commands

    self.run_command(cmd)

  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command

    cmd_obj.run()

  File "/Library/Python/2.7/site-packages/numpy-1.6.1-py2.7-macosx-10.7-intel.egg/numpy/distutils/command/install.py", line 57, in run

    r = self.setuptools_run()

  File "/Library/Python/2.7/site-packages/numpy-1.6.1-py2.7-macosx-10.7-intel.egg/numpy/distutils/command/install.py", line 31, in setuptools_run

    return old_install_mod._install.run(self)

  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/command/install.py", line 573, in run

    self.run_command('build')

  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/cmd.py", line 326, in run_command

    self.distribution.run_command(command)

  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command

    cmd_obj.run()

  File "/Users/Yasser/build/mayavi/setup.py", line 303, in run

    build_tvtk_classes_zip()

  File "/Users/Yasser/build/mayavi/setup.py", line 290, in build_tvtk_classes_zip

    gen_tvtk_classes_zip()

  File "tvtk/setup.py", line 46, in gen_tvtk_classes_zip

    from code_gen import TVTKGenerator

  File "tvtk/code_gen.py", line 10, in <module>

    import vtk

ImportError: No module named vtk

----------------------------------------
Command /usr/bin/python -c "import setuptools;__file__='/Users/Yasser/build/mayavi/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /var/folders/53/_trhc_0x0fb6kvx6bw_wrk500000gn/T/pip-Z4hpsW-record/install-record.txt failed with error code 1 in /Users/Yasser/build/mayavi
Storing complete log in /Users/Yasser/Library/Logs/pip.log
Traceback (most recent call last):
  File "/usr/local/bin/pip", line 8, in <module>
    load_entry_point('pip==1.1', 'console_scripts', 'pip')()
  File "/Library/Python/2.7/site-packages/pip-1.1-py2.7.egg/pip/__init__.py", line 116, in main
    return command.main(args[1:], options)
  File "/Library/Python/2.7/site-packages/pip-1.1-py2.7.egg/pip/basecommand.py", line 141, in main
    log_fp = open_logfile(log_fn, 'w')
  File "/Library/Python/2.7/site-packages/pip-1.1-py2.7.egg/pip/basecommand.py", line 168, in open_logfile
    log_fp = open(filename, mode)
IOError: [Errno 13] Permission denied: '/Users/Yasser/Library/Logs/pip.log' 
```

我认为问题出在`vtk`.

谁能帮我？

## 其他详情

跑步`sudo pip install mayavi`并不能解决问题。

我认为这可能会有所帮助

```
› which python
/usr/local/bin/python

› python
Python 2.7.2 (default, Feb 17 2012, 13:57:55) 
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import vtk
>>> vtk
<module 'vtk' from '/usr/local/Cellar/python/2.7.2/lib/python2.7/site-packages/VTK-5.10.0-py2.7.egg/vtk/__init__.pyc'>
>>> 
```

我`PYTHONPATH`的是空的。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-06-30T19:34:05.857

我在 Debian 上，但这也应该对你有用

我一直坚持将 vtk 安装到 virtualenv 中，经过数小时的搜索但没有任何结果，我做了以下操作并且它起作用了。

1.  从系统范围的存储库安装 python-vtk

2.  将 vtk 文件夹从 /usr/lib/pymodules/python2.7 复制到 /PATH/TO/YOUR/VIRTUALENV/lib/python2.7/site-packages

在您的情况下，系统范围的 python 包文件夹可能会有所不同，但您可以通过启动系统 python 并输入以下内容轻松找到它：

```
import vtk,sys
print(sys.modules['vtk']) 
```

在这个技巧之后，使用 pip install mayavi 和 pip install 将 Mayavi 成功安装到我的 virtualenv 中。

编辑：而不是复制它可能会更好地在步骤 2 中对文件夹进行符号链接

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-30T23:09:38.847

您`pip`可能正在使用不同`python`的类型，您已经`vtk`安装 using `/usr/local/bin/python`，而您的`pip`二进制文件使用`/usr/bin/python`.

核实：

```
$ head -n1 $(which pip) 
```

为了解决它，您可以选择使用 a`virtualenv`或`pip`使用安装`/usr/local/bin/python`：

```
curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | /usr/local/bin/python 
```

有关更多安装说明，请参阅[http://www.pip-installer.org/en/latest/installing.html](http://www.pip-installer.org/en/latest/installing.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-05-18T00:08:17.560

我遇到了同样的问题，第一个答案对我没有帮助，因为 pip 在正确的目录中，但事实证明我没有安装 vtk - 运行 sudo apt-get install python-vtk 解决了这个问题，我能够之后成功运行 pip install mayavi。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-19T14:13:25.897

我在pyenv中安装python安装mayavi时遇到了同样的问题，我通过将目录复制到解决了这个问题`/home/myname/.pyenv/versions/2.7.12/lib/python2.7/site-packages`，下面是我的方法：

1.  安装`vtk`和`python-vtk`

    ```
    sudo apt-get install vtk6
    sudo apt-get install python-vtk 
    ```

2.  尝试`python -c "import vtk"`，如果再次失败，请转到步骤 3

3.  导入错误可能是由于您当前的python中的vtk包文件夹丢失，所以我们应该找到vtk文件夹并复制到您当前的python（很可能是pyenv shims目录中的python）的目录。

    我的ubuntu中vtk文件夹的路径是

    ```
    /usr/lib/python2.7/dist-packages/vtk 
    ```

    只需将`vtk`文件夹复制到您当前的 python 中`/site-packages`，例如

    ```
    cp -r /usr/lib/python2.7/dist-packages/vtk /home/myname/pyenv/versions/2.7.12/lib/python2.7/site-packages 
    ```

4.  再试`python -c "import vtk"`一次。

5.  如果没有导入错误，就做

    ```
    pip install mayavi 
    ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-25T20:59:34.840

坚持`sudo`安装了好几次，终于解决了，不知道怎么解释。

```
sudo python2 -m pip install mayavi

sudo python3 -m pip install mayavi 
```

**更新**

我无法通过`pip`笔记本电脑安装。然后我安装最新`mayavi`的

```
git clone https://github.com/enthought/mayavi.git
cd mayavi
pip install -r requirements.txt
pip install PyQt5  # replace this with any supported toolkit
python setup.py install  # or develop 
```

安装后。测试

```
mayavi2 
```

然后报告说找不到`module PyQt5.Qtsvg`，所以

```
sudo apt install python3-pyqt5.qtsvg 
```

现在它起作用了。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-10-27T19:03:29.527

我使用 Homebrew 安装了 vtk：

```
$ brew install vtk 
```

希望这可以帮助。

# cookies - 是否可以将 cookie ASP.NET_sessionID 标记为安全

> ID：12182054
> 
> 赞同：3
> 
> 时间：2012-08-29T16:03:32.870
> 
> 标签：cookies, https, asp.net-mvc-4, session-state

经过安全审核后，我要求将 cookie ASP.NET_sessionID 设置为“安全”。

现在没有设置标志。

我可以使用 SessionIDManager 将其设置为安全吗？在使用以下代码登录后，我已经在使用它来更改 Session cookie 的值：

```
 System.Web.SessionState.SessionIDManager manager = new System.Web.SessionState.SessionIDManager();
            string oldId = manager.GetSessionID(System.Web.HttpContext.Current);
            string newId = manager.CreateSessionID(System.Web.HttpContext.Current);
            bool isAdd = false, isRedir = false;
            manager.SaveSessionID(System.Web.HttpContext.Current, newId, out isRedir, out isAdd); 
```

**编辑**

我看到我可以设置

```
<httpCookies httpOnlyCookies="false" requireSSL="true" /> 
```

但我只想让这个 cookie 安全

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-08T13:34:24.903

**只需编写代码即可通过安全审核。**

```
void Session_Start(Object sender, EventArgs e)
    {

        if (Request.IsSecureConnection)
            {
                Response.Cookies["ASP.NET_SessionId"].Secure = true;
            }

    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T23:39:14.617

这应该使您能够将 cookie 设置为安全：

```
void Application_EndRequest(object sender, EventArgs e)
{
    var sessionCookieKey = Response.Cookies.AllKeys.SingleOrDefault(c => c.ToLower() == "asp.net_sessionid");
    var sessionCookie = Response.Cookies.Get(sessionCookieKey);
    if(sessionCookie != null)
    {
        sessionCookie.Secure = true;
    }
} 
```

# visual-studio-2010 - VS2010 : 无法开始调试 找不到 Microsoft Internet Explorer

> ID：12182056
> 
> 赞同：4
> 
> 时间：2012-08-29T16:03:37.393
> 
> 标签：visual-studio-2010, silverlight

我创建了一个简单的 silverligth 项目，当我尝试开始调试时，我遇到了这个错误：

“无法开始调试。

找不到 Microsoft Internet Explorer。”

我在互联网上搜索过，我找到了两种解决方案：

第一个 ：

“导航到 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths 我发现 iexplore.exe 键丢失了。这就是我所做的：

将 iexplore.exe 键添加到注册表。将（默认）REG_SZ 值更改为 C:\Program Files\Internet Explorer\iexplore.exe 添加了一个名为 Path 的新 REG_SZ 值并将其设置为 C:\Program Files\Internet Explorer 重新启动了我的 Visual Studio。"

这不起作用，iexplore.exe 键在这里。

（默认） REG_SZ C:\Program Files (x86)\Internet Explorer\IEXPLORE.EXE

路径 C:\Program Files(x86)\Internet Explorer；

第二个是右键单击aspx文件并选择“Browse With ..”，并将Internet Explorer设置为默认值。

是不是已经...

我在 Silverlight 中启动了较旧的项目，但我遇到了同样的问题......

我想我有这个错误是因为我安装了 IE9 ...

任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T16:16:22.043

找到了答案：

导航到`HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\App Paths`我发现`iexplore.exe`钥匙丢失了。

所以这就是我所做的：

1.  将密钥添加`iexplore.exe`到注册表。
2.  将（默认）REG_SZ 值更改为`C:\Program Files\Internet Explorer\iexplore.exe`
3.  添加了一个名为的新 REG_SZ 值`Path`并将其设置为`C:\Program Files\Internet Explorer`
4.  重新启动我的 Visual Studio。

# python - 如何从 python 中的 QLineEdit 中读出文本？

> ID：12182057
> 
> 赞同：6
> 
> 时间：2012-08-29T16:03:36.503
> 
> 标签：python, qt-creator, qgis, qlineedit

我为我的插件创建了一个带有 3 个按钮的启动 GUI。这很好用，如果我单击其中一个按钮，则会启动特定操作。到目前为止，这有效。如果我单击其中一个按钮，则会出现一个带有“ok”和“cancel”两个按钮的新 GUI，然后会出现一个 lineedit。如果我按下取消，GUI 将关闭，如果我按下确定，我希望程序从编辑行读取文本并将其存储在变量中。到目前为止，这不起作用。

这是包含对话框的类：

```
from PyQt4.QtCore import pyqtSlot
from PyQt4.QtGui import QDialog, QLineEdit

from ui_grz import Ui_Dialog

class grzDialog(QDialog):

    def __init__(self):
        QDialog.__init__(self)
        # Set up the user interface from Designer.
        self.ui = Ui_Dialog()
        self.ui.setupUi(self) 
```

这是在使用 QT Designer 和命令 pyuic4 创建 GUI 后包含 GUI 结构的类：

```
from PyQt4 import QtCore, QtGui

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s

class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName(_fromUtf8("Dialog"))
        Dialog.resize(387, 153)
        self.buttonBox = QtGui.QDialogButtonBox(Dialog)
        self.buttonBox.setGeometry(QtCore.QRect(30, 110, 341, 32))
        self.buttonBox.setOrientation(QtCore.Qt.Horizontal)
        self.buttonBox.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
        self.buttonBox.setObjectName(_fromUtf8("buttonBox"))
        self.label = QtGui.QLabel(Dialog)
        self.label.setGeometry(QtCore.QRect(10, 10, 361, 51))
        self.label.setObjectName(_fromUtf8("label"))
        self.lineEdit = QtGui.QLineEdit(Dialog)
        self.lineEdit.setGeometry(QtCore.QRect(10, 60, 351, 31))
        self.lineEdit.setObjectName(_fromUtf8("lineEdit"))

        self.retranslateUi(Dialog)
        QtCore.QObject.connect(self.buttonBox, QtCore.SIGNAL(_fromUtf8("accepted()")), Dialog.accept)
        QtCore.QObject.connect(self.buttonBox, QtCore.SIGNAL(_fromUtf8("rejected()")), Dialog.reject)
        QtCore.QMetaObject.connectSlotsByName(Dialog)

    def retranslateUi(self, Dialog):
        Dialog.setWindowTitle(QtGui.QApplication.translate("Dialog", "GRZ Analyse", None, QtGui.QApplication.UnicodeUTF8))
        self.label.setText(QtGui.QApplication.translate("Dialog", "<html><head/><body><p><span style=\" font-weight:600;\">Bitte geben Sie hier den Schwellenwert fÃ¼r die GRZ-Analyse ein:</span></p><p>Bitte achten Sie auf eine korrekte Schreibweise (bspw. 2.5):</p></body></html>", None, QtGui.QApplication.UnicodeUTF8)) 
```

在这个类中，我需要变量：

```
# Import the PyQt and QGIS libraries
from PyQt4.QtCore import * 
from PyQt4.QtGui import *
from qgis.core import *

# Import the code for the dialog
from ubgrzdialog import grzDialog

class quickAnalysis:

    def __init__(self, iface):
        # Save reference to the QGIS interface
        self.iface = iface

    def grzAnalysis(self):

        dlg = grzDialog()
        dlg.show()
        result = dlg.exec_()
        if result == 1:

            text = dlg.text()
            QMessageBox.information(self.iface.mainWindow(),"test", "%s" %(text), QMessageBox.Ok) 
```

这只是课程的一小部分，但这是我对如何从 LineEdit 小部件读取文本有疑问的部分。

你有什么想法或建议吗？

谢谢和抱歉，如果这是一个双重职位，但我还没有找到适合我的问题的答案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T16:09:12.893

如[文档](http://www.pyside.org/docs/pyside-git/PySide/QtGui/QLineEdit.html#PySide.QtGui.QLineEdit.text)`QLineEdit`中所述，可以使用其方法检索a 的文本`text`。

```
text = dlg.ui.lineEdit.text() 
```

请注意，它是一个`QString`.，而不是常规字符串，但这应该不是问题，因为您使用`"%s" % text`.

# javascript - 有条件地编写html的方法

> ID：12182059
> 
> 赞同：0
> 
> 时间：2012-08-29T16:03:38.863
> 
> 标签：javascript, html

我想检测浏览器是否支持不同的功能：

```
 var useWrappedLayout = (document.getElementById != undefined); 
```

我必须支持相当旧的设备，这就是我检查 getElementById 的原因。

根据是否`useWrappedLayout`为真，我希望页面是否有一些 HTML 元素。

为了保持简单并举个例子，假设我只想拥有

```
 <p>Test</p> 
```

之间

```
 <b>A</b><i>C</i> 
```

如果`useWrappedLayout`是`true`。

我有什么方法？只有`innerHTML`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:17:02.443

使用 javascript 动态构建 HTML

```
<script type="text/javascript">
    var useWrappedLayout = (document.getElementById != undefined);
    document.write("<b>A</b>" + ((useWrappedLayout) ? "<p>Test</p>" : "") + "<i>C</i>");
</script> 
```

# r - 行的子集数据框等于一个值但另一个

> ID：12182060
> 
> 赞同：1
> 
> 时间：2012-08-29T16:03:38.877
> 
> 标签：r

假设我有一个这样的数据框：

```
df <- data.frame(id = rep(c(1001:1004), each = 3), value = c(1,1,4,1,2,3,2,2,5,1,5,6))

df
     id value
1  1001     1
2  1001     1
3  1001     4
4  1002     1
5  1002     2
6  1002     3
7  1003     2
8  1003     2
9  1003     5
10 1004     1
11 1004     5
12 1004     6 
```

什么是返回值等于`1`但的 ID 的好方法`3`，即，任何具有相应值等于的 ID`3`将被排除，但必须至少有一个值等于`1`？在这种情况下，`ID 1002`有`1`但也有`3`并且应该被排除。`ID 1003`没有任何值等于`1`并且也应被排除在外。所以`ID 1001 and 1004`会被退回。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:18:48.170

您可以获得包含 1`df$id[df$value == 1]`和 3的 ID `df$id[df$value == 3]`。要从另一组中排除一组，您可以使用`setdiff`.

在一个命令中：`with(df,setdiff(id[value == 1],id[value == 3]))`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-30T03:52:57.703

这是另一种选择。

```
unique(df$id[df$value==1][! df$id[df$value==1] %in% df$id[df$value==3]])
[1] 1001 1004 
```

# machine-learning - 如何计算线性回归中的正则化参数

> ID：12182063
> 
> 赞同：44
> 
> 时间：2012-08-29T16:04:04.237
> 
> 标签：machine-learning, data-mining, regression

当我们有一个高阶线性多项式用于拟合线性回归设置中的一组点时，为了防止过度拟合，我们使用正则化，并在成本函数中包含一个 lambda 参数。然后使用这个 lambda 更新梯度下降算法中的 theta 参数。

我的问题是我们如何计算这个 lambda 正则化参数？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-08-29T16:24:35.987

正则化参数 (lambda) 是模型的输入，因此您可能想知道如何*选择*lambda 的值。正则化参数减少了过度拟合，从而减少了估计回归参数的方差；但是，这样做的代价是增加了您的估计的偏差。增加 lambda 会减少过度拟合，但也会产生更大的偏差。所以真正的问题是“你愿意在你的估计中容忍多少偏差？”

您可以采取的一种方法是对数据进行多次随机二次抽样，然后查看估计值的变化。然后重复该过程以获得稍大的 lambda 值，以查看它如何影响估计的可变性。请记住，无论您决定适合您的子采样数据的任何 lambda 值，您都可以使用较小的值来在整个数据集上实现可比较的正则化。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2017-07-10T03:43:34.443

### 封闭形式（TIKHONOV）与梯度下降

你好！对那里的直观和一流的数学方法进行了很好的解释。我只是想添加一些不“解决问题”的特殊性，它们肯定有助于加快并为寻找良好正则化超参数的过程提供一些一致性。

我假设您正在谈论**L2**（又称“权重衰减”）正则化，由*lambda*项线性加权，并且您正在使用**封闭形式的[Tikhonov](https://en.wikipedia.org/wiki/Tikhonov_regularization)方程**优化模型的权重（强烈推荐用于低维线性回归模型），或**带有反向传播的梯度下降的**一些变体。在这种情况下，您希望为*lambda*选择提供最佳泛化能力的值。

* * *

### 封闭式 (TIKHONOV)

如果您能够使用您的模型采用 Tikhonov 方式（[Andrew Ng](https://www.youtube.com/watch?v=NN7mBupK-8o#t=12m45s)说在 10k 维度以下，但这个建议至少有 5 年的历史）[维基百科 - 确定 Tikhonov 因子](https://en.wikipedia.org/wiki/Tikhonov_regularization#Determination_of_the_Tikhonov_factor)提供了一个有趣的**封闭形式解决方案，已被证明提供最优值**。但是这个解决方案可能会引发一些我不知道的实现问题（时间复杂度/数值稳定性），因为没有主流算法来执行它。不过，这篇[2016 年的论文](https://arxiv.org/abs/1610.01952)看起来很有前途，如果您真的必须将线性模型优化到最佳状态，可能值得一试。

*   为了更快的原型实现，这个[2015](https://pypi.python.org/pypi/InverseProblem/1.0) Python 包似乎迭代地处理它，你可以让它优化然后提取 lambda 的最终值：

> 在这种新的创新方法中，我们推导出了一种迭代方法来解决一般的 Tikhonov 正则化问题，该方法收敛到无噪声解决方案，不强烈依赖于 lambda 的选择，但仍然避免了反演问题。

并且来自项目的[GitHub README](https://github.com/kathrynthegreat/InverseProblem)： `InverseProblem.invert(A, be, k, l) #this will invert your A matrix, where be is noisy be, k is the no. of iterations, and lambda is your dampening effect (best set to 1)`

* * *

### 梯度下降

*这部分的所有链接均来自 Michael Nielsen 的惊人在线书籍《神经网络与深度学习》，推荐阅读！*

对于这种方法，似乎更不用说：成本函数通常是非凸的，优化是在数值上执行的，模型的性能是通过某种形式的交叉验证来衡量的（参见[过度拟合和正则化](http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization)以及[为什么正则化](http://neuralnetworksanddeeplearning.com/chap3.html#why_does_regularization_help_reduce_overfitting)如果你还没有足够的，[帮助减少过度拟合）。](http://neuralnetworksanddeeplearning.com/chap3.html#why_does_regularization_help_reduce_overfitting)但即使在交叉验证时，尼尔森也提出了一些建议：你可能想看看[这个关于 L2 正则化如何提供权重衰减效果的详细解释](http://neuralnetworksanddeeplearning.com/chap3.html#regularization) ，但总结是它**与样本数量成反比`n`**，所以在计算带有 L2 项的梯度下降方程时，

> 像往常一样使用反向传播，然后添加`(λ/n)*w`到所有权重项的偏导数。

他的结论是，当想要具有不同样本数量的类似正则化效果时，必须按比例改变 lambda：

> 我们需要修改正则化参数。原因是因为`n`训练集的大小从`n=1000`变为`n=50000`，这改变了权重衰减因子`1−learning_rate*(λ/n)`。如果我们继续使用`λ=0.1`这将意味着更少的权重衰减，因此更少的正则化效果。我们通过更改为 来补偿`λ=5.0`。

这仅在将相同模型应用于不同数量的相同数据时才有用，但我认为它打开了一些关于它应该如何工作的直觉的大门，更重要的是，通过允许您微调 lambda 来加速超参数化过程在较小的子集中，然后扩大规模。

为了选择准确的值，他在关于[如何选择神经网络的超参数](http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network%27s_hyper-parameters)的结论中建议纯经验方法：从 1 开始，然后逐步乘以和除以 10，直到找到合适的数量级，然后在该数量级内进行局部搜索地区。在[这个 SE 相关问题](https://scicomp.stackexchange.com/a/10673)的评论中，用户 Brian Borchers 还提出了一种非常知名的方法，该方法可能对本地搜索有用：

1.  选取训练和验证集的一小部分（以便能够在合理的时间内完成其中的许多）
2.  在某个区域内开始`λ=0`并少量增加，对模型执行快速训练和验证并绘制两个损失函数
3.  你会观察到三件事：
4.  CV 损失函数将始终高于训练损失函数，因为您的模型专门针对训练数据进行了优化（*编辑：一段时间后，我看到了一个 MNIST 案例，其中添加 L2 有助于 CV 损失比训练损失下降得更快，直到收敛。可能是由于数据的荒谬一致性和次优的超参数化*）。
5.  训练损失函数将具有最小值`λ=0`，然后随着正则化而增加，因为阻止模型最佳拟合训练数据正是正则化所做的。
6.  CV 损失函数将从 开始高`λ=0`，然后减小，然后在某个点再次开始增加（*编辑：这假设设置能够过度拟合`λ=0`，即模型具有足够的功率并且没有大量应用其他正则化方法*）。
7.  的最佳值`λ`可能在 CV 损失函数的最小值附近，它也可能在一定程度上取决于训练损失函数的样子。请参阅图片以获取可能的（但不是唯一的）表示：而不是“模型复杂性”，您应该将 x 轴解释**为`λ`右侧为零并向左增加**。

[![L2 诊断：代替](../Images/904fcd3bd539beb4a5355906eb04b6db.png)](https://i.stack.imgur.com/ZTQSP.png)

希望这可以帮助！干杯，
安德烈斯

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-18T16:29:02.290

上述交叉验证是机器学习中经常使用的一种方法。然而，选择一个可靠和安全的正则化参数仍然是数学研究的一个非常热门的话题。如果你需要一些想法（并且可以访问一个体面的大学图书馆），你可以看看这篇论文： [http ://www.sciencedirect.com/science/article/pii/S0378475411000607](http://www.sciencedirect.com/science/article/pii/S0378475411000607)

# jquery - JQuery UI选项卡选择带有链接的当前选项卡并将类添加到子元素

> ID：12182065
> 
> 赞同：1
> 
> 时间：2012-08-29T16:04:15.157
> 
> 标签：jquery, user-interface, tabs

我需要有关 jQuery UI 选项卡功能的帮助。我目前可以单击链接并打开特定选项卡。我想为该功能添加更多内容，基本上仍然选择选项卡，然后在选择选项卡后，切换或添加一个类到选项卡式内容内的子元素。以下是当前功能：

```
$('#tabs').tabs();//ID is the container of the tabs and tabbed content
 //creates linkable tabs for FAQ page   
    $('#showTab_faq4').click(function() {  //links to tab ID questions
        $('#tabs').tabs('select', '#questions');
        $("h3.toggle2").addClass("expanded");
    }); 
```

在用户单击链接以显示选项卡“问题”后，我希望选项卡内的 H3 标记添加一个名为“扩展”的类。h3 有一个名为“toggle2”的类来将它绑定到这个函数。

有什么建议么？

# python - Python闭包函数失去外部变量访问

> ID：12182068
> 
> 赞同：14
> 
> 时间：2012-08-29T16:04:32.103
> 
> 标签：python, closures, decorator

我刚刚学习了python@decorator，很酷，但是很快我发现我修改后的代码出现了奇怪的问题。

```
def with_wrapper(param1):
    def dummy_wrapper(fn):
        print param1
        param1 = 'new'
        fn(param1)
    return dummy_wrapper

def dummy():
    @with_wrapper('param1')
    def implementation(param2):
        print param2

dummy() 
```

我调试它，它在 print param1 抛出异常

```
UnboundLocalError: local variable 'param1' referenced before assignment 
```

如果我删除 `param1 = 'new'`此行，而不对外部范围的变量进行任何修改操作（链接到新对象），则此例程可能会起作用。

这是否意味着我只复制了一份外部范围变量，然后进行修改？

* * *

谢谢德尔南，关闭是必不可少的。可能来自这里的答案： [与语言 X 闭包相比，Python 中的闭包有哪些限制？](https://stackoverflow.com/questions/141642/what-limitations-have-closures-in-python-compared-to-language-x-closures)

类似的代码如下：

```
def e(a):
    def f():
        print a
        a = '1'
    f()
e('2') 
```

而且这似乎是以前烦人的全局变量：

```
a = '1'
def b():
    #global a
    print a
    a = '2'
b() 
```

*这是通过添加全局*符号修复的。但是对于关闭，没有找到这样的符号。感谢 unutbu，Python 3 给了我们*nonlocal*。

我从上面知道直接访问外部变量是只读的。但是看到之前的读取变量（print var）也受到影响，这有点不舒服。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-29T16:11:40.550

当 Python 解析一个函数时，它会在发现赋值左侧使用的变量时记录下来，例如

```
param1 = 'new' 
```

它假定所有这些变量都是函数的局部变量。所以当你在这个任务之前

```
print param1 
```

发生错误是因为 Python 在执行 print 语句时没有此局部变量的值。

* * *

在 Python3 中，您可以通过声明它`param1`是非本地的来解决此问题：

```
def with_wrapper(param1):
    def dummy_wrapper(fn):
        nonlocal param1
        print param1
        param1 = 'new'
        fn(param1)
    return dummy_wrapper 
```

* * *

在 Python2 中，您必须使用一个技巧，例如在列表（或其他一些可变对象）中传递 param1：

```
def with_wrapper(param1_list):
    def dummy_wrapper(fn):
        print param1_list[0]
        param1_list[0] = 'new'   # mutate the value inside the list
        fn(param1_list[0])
    return dummy_wrapper

def dummy():
    @with_wrapper(['param1'])   # <--- Note we pass a list here
    def implementation(param2):
        print param2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:12:56.440

`param1`您在函数中分配，这会产生`param1`一个局部变量。但是，在您打印它时尚未分配它，因此您会收到错误消息。Python 不会回退到在外部范围内寻找变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-17T13:29:53.823

**对于临时情况或探索性代码很方便（但不是很好的做法）**：

如果您想在 Python 2.x 中从外部范围捕获变量，那么使用 global 也是一种选择（具有通常的附带条件）。

虽然以下将抛出（在 inner 中分配 outer1 使其成为局部的，因此在 if 条件中是无界的）：

```
def outer():
    outer1 = 1
    def inner():
        if outer1 == 1:
            outer1 = 2
            print('attempted to accessed outer %d' % outer1) 
```

这不会：

```
def outer():
    global outer1
    outer1 = 1
    def inner():
        global outer1
        if outer1 == 1:
            outer1 = 2
            print('accessed outer %d' % outer1) 
```

# xml - 相同或不同的 xml 命名空间？

> ID：12182074
> 
> 赞同：0
> 
> 时间：2012-08-29T16:05:23.770
> 
> 标签：xml, xml-namespaces

在我的项目中，有许多各种类型的 XML 文件，如 XSD、WSDL、参数映射等。它们都接收 IDE 生成的命名空间，但命名空间不是唯一的（跨项目 - 具有相同名称的元素会获得相同的命名空间）也不是描述性的（或令人困惑的——它们都以“http://www.ibm.com/...”开头，即使它们定义了我自己的实体，而不是 IBM 的实体）。那么命名空间重构是必要的。

我的疑问如下：

1) 每个元素应该有自己的命名空间，还是应该相关的元素共享它们的命名空间？例如，

*   SOAP 请求和响应消息应该属于同一个命名空间，还是应该有自己的命名空间？
*   WSDL 和相关的 XSD 应该使用相同的目标名称空间，还是不同？

例如：

```
http://www.xarx.com/xmlns/TheProject/Administration/wsdl/StartProcess
http://www.xarx.com/xmlns/TheProject/Administration/xsd/StartProcessRequest
http://www.xarx.com/xmlns/TheProject/Administration/xsd/StartProcessResponse 
```

或一切进入

```
http://www.xarx.com/xmlns/TheProject/Administration 
```

2) 所有生成的公开可见的命名空间必须得到纠正，当然。但是项目内部的那些呢？他们的重构是在浪费时间吗？它们可能出现在管理控制台或日志中，错误的命名空间可能会产生误导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T17:37:30.087

我们尝试在 WebSphere ESB 中为所有相关元素使用相同的 XML 名称空间，以下是我的经验：

所有相关的元素都可以使用相同的命名空间，IDE 和编译器都不用打扰。具有不同用途的元素通常具有不同的名称，因此它们不会导致名称冲突。但是 IDE 会生成大量 XML 文件，并且有时会发生生成的元素与您想要使用的名称相同的情况。（通常 XXX_Request 和 XXX_Response 是 Websphere Integration Developer 在派生的 WSDL 文件中生成的名称，因此我们必须使用 XXX_Req 和 XXX_Res 来代替。）

# android - 在构建期间添加资产

> ID：12182076
> 
> 赞同：0
> 
> 时间：2012-08-29T16:05:41.093
> 
> 标签：android, ant

情况是这样的，我有一些文件与我的 Android 应用程序位于不同的存储库中。我想通过提供带有这些文件路径的构建脚本，在构建过程中将其中一些资产添加到我的 apk 资产文件夹中。我也不希望我的存储库被修改。

Ant可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T07:55:19.223

如果我理解正确，您不想修改属于已提交结构的文件夹内容。所以我看到有两个变种：

1.  使用构建文件夹，您将在其中复制代码、资产、资源配置文件等。构建后删除/清理此文件夹。有时，当您拥有多个应用程序版本（如品牌）时，它很有用。
2.  `apk``zip`这样您就可以使用资产对其进行更新（请查看此[内容](https://stackoverflow.com/questions/4793220/repackage-apk-file-to-contain-custom-assets-what-build-tool-to-use)）。但是，如果您要更新已签名的内容，请小心`apk`

# c# - MonoGame Windows 8 - 可写位图

> ID：12182082
> 
> 赞同：3
> 
> 时间：2012-08-29T16:05:56.127
> 
> 标签：c#, .net, windows-8, monogame

如果您将以下代码放在 MonoGame 应用程序的游戏循环（更新或绘图）中（可以只是默认项目模板）：

```
new Windows.UI.Xaml.Media.Imaging.WriteableBitmap(150, 150); 
```

它抛出一个跨线程错误......

```
The application called an interface that was marshalled for a different thread. (Exception from HRESULT: 0x8001010E (RPC_E_WRONG_THREAD)) 
```

所以我尝试了这个：

```
var dispatcher = Windows.UI.Core.CoreWindow.GetForCurrentThread().Dispatcher;
dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, delegate
{
     new Windows.UI.Xaml.Media.Imaging.WriteableBitmap(150, 150);
}); 
```

同样的错误。

从幕后看，MonoGame 看起来不像在后台线程或任何东西上运行游戏循环。它使用同步循环。

`WriteableBitmap`在 MonoGame中使用的任何想法？（我需要用它来渲染一些活瓷砖）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:23:12.847

如果您使用的是 Game 类，那么您创建的应用程序默认不支持 XAML。

目前，在 MonoGame 应用程序中支持 XAML 的最佳方式是使用此线程中概述的 Siverlight 样式 XNA 游戏...

[http://monogame.codeplex.com/discussions/359544](http://monogame.codeplex.com/discussions/359544)

# html - 关机后 HTML5 LocalStorage 在黑莓上不持久

> ID：12182083
> 
> 赞同：0
> 
> 时间：2012-08-29T16:05:57.050
> 
> 标签：html, blackberry, cordova

我一直在使用 PhoneGap 开发适用于 Android、IOS 和 Blackberry 的应用程序，该应用程序使用 localStorage 在访问之间保留 auth_key。我的问题是，当我重新启动硬重置（电池拉动）时，黑莓的所有 localStorage 变量都丢失了。

Android 和 iOS 中的相同应用程序运行良好，在硬件重启和软复位（电池拉动 Android）之间维护数据。

黑莓是否需要做一些特别的事情才能通过电池拉动来维护这些数据？

以防万一..这是我用来设置和获取变量的代码

```
localStorage.setItem('key', '(some radomstring)');

var key = localStorage.getItem('key'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T09:37:57.867

您正在使用哪个版本的黑莓操作系统？我在 OS7 上运行的黑莓粗体 9900 上对此进行了测试。本地存储是完全持久的。下面是我使用的代码。

localStorage['auth_key'] = "xyz_key";

警报（本地存储['auth_key']）；

重启后它会完美地提醒“xyz_key”。

我什至没有在我的手机上安装 SD 卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T17:18:20.480

所以事实证明，在某些黑莓设备上，为了通过电池拉动来保留数据，您必须在手机中安装 SD 卡。

# asp.net - 如何为实体框架数据库使用 dbDacFx Web 部署提供程序？

> ID：12182086
> 
> 赞同：3
> 
> 时间：2012-08-29T16:06:08.760
> 
> 标签：asp.net, entity-framework, database-schema, visual-studio-2012, webdeploy

我正在 Visual Studio 2012 下编写一个 ASP.NET Web 窗体应用程序。我有一个 Entity Framework Code First 上下文类，它将我的 C# 对象与数据库链接起来。但是这个上下文是使用 Database First 方法自动生成的。我在我的数据库中使用诸如唯一索引和用户聚合等功能，EF 5 中的模型优先的代码优先方法不支持 AFAIK。

我正在使用[一键发布](http://msdn.microsoft.com/en-us/library/dd394698#dbdeployment)按钮来部署我的项目。我的数据库被识别为 EF 数据库，我看到“执行代码优先迁移”复选框，但它是灰色的：

![发布 Web 对话框](../Images/ac7742d4ad4fe65a59b0178d2ae442c2.png)

没关系，因为我使用的是数据库优先方法。但我想使用“更新数据库”选项，它出现在我的默认连接中，只是为了同步数据库模式。如此[处](http://msdn.microsoft.com/en-us/library/dd394698#dbdeployment)“dbDacFx Web 部署提供程序”部分所述。怎么做？

如果我理解正确，我总是可以为此手动使用 Microsoft SQL Management Studio。在这种情况下如何手动执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T01:28:48.190

您可以在 Web.config 文件的 connectionStrings 元素中创建另一个名称不同的连接字符串条目。它将显示在带有 dbDacFx 选项的发布对话框中。

该方案类似于在不使用迁移的情况下部署 Code First - 请参阅[http://msdn.microsoft.com/en-us/library/ee942158.aspx#deploy_code_first_without_migrations](http://msdn.microsoft.com/en-us/library/ee942158.aspx#deploy_code_first_without_migrations)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T18:37:14.047

Tom (tdykstra) 是正确的，您需要在 web.config 中创建一个新的连接字符串，以使用 dbDacFx 发布您的模型，而不是使用 EF CF 迁移。

Web 发布对话框支持两种类型的数据库发布机制：

1.  通过迁移发布 EF CF
2.  [通过dbDacFx](http://learn.iis.net/page.aspx/1305/dbdacfx-provider-for-incremental-database-publishing/)发布增量数据库模式

如果连接字符串与 EF CF 上下文相关联，则在发布对话框中，它将始终显示“已*执行代码优先迁移”*复选框。我们想让故事简单易懂，所以我们没有为此创建任何配置选项。对于不想使用发布对话框的高级用户，您可以创建具有正确内容的发布配置文件 (.pubxml) 文件，并使用该文件从命令行发布。为了让 VS 发布对话框支持这种情况，您必须将连接字符串添加到 web.config。

在您的情况下，您有一个连接字符串 DatabaseEntities，它由 EF CF 上下文使用。您应该在 DatabaseEntities-publish 中创建一个新的连接字符串`web.config`，该字符串仅在发布期间使用。您需要确保要发布到的连接字符串位于 DatabaseEntities 和 DatabaseEntities-publish 的文本框中。

# jquery - jquery 显示/隐藏单选按钮内容（默认选择必须显示内容）

> ID：12182087
> 
> 赞同：0
> 
> 时间：2012-08-29T16:06:09.667
> 
> 标签：jquery

我希望在选择按钮时显示/隐藏单选按钮内容，但我需要一个默认按钮（比如第一个按钮）作为默认按钮（并显示内容），然后从那里显示隐藏内容。

目前，默认情况下它们都是隐藏的，在类上显示：无。这是HTML：

```
<div style="float:left; width:300px;">
<div style="float:left;">
<form name="form1" id="my_form" method="post" action="">
  <div>
    <label>
    <input type="radio" name="group1" value="opt1" checked="checked" />
    opt1</label>
  </div>
  <div>
    <label>
    <input type="radio" name="group1" value="opt2" />
    opt2</label>
  </div>
  <div>
    <label>
    <input type="radio" name="group1" value="opt3" />
    opt3</label>
  </div>
  <input type="submit" value="Submit" />
</form>
</div>
<div style="float:right; width:200px;">
<div id="opt1" class="desc">
  <form>
    First name:
    <input type="text" name="FirstName" value="Mickey" />
    <br />
    Last name:
    <input type="text" name="LastName" value="Mouse" />
    <br />
  </form>
</div>
<div id="opt2" class="desc">
  <form>
    <input type="checkbox" name="vehicle" value="Bike" />
    I have a bike<br />
    <input type="checkbox" name="vehicle" value="Car" />
    I have a car
  </form>
</div>
<div id="opt3" class="desc">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus convallis commodo euismod. Morbi vitae libero erat, quis ultrices purus.</div>
</div>
</div> 
```

这是jQuery：

```
$(document).ready(function(){ 
$("input[name$=group1]").click(function() {
    var test = $(this).val();
    $(".desc").hide();
    $("#"+test).show();
}); 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:17:48.370

在 dom 上触发更改，为您检查的元素做好准备

```
$(document).ready(function() {

    $("input[name$=group1]").change(function() {
        var test = $(this).val();
        $(".desc").hide();
        $("#" + test).show();
    });
    $("input[name$=group1]:checked").change(); // <-- here
});​ 
```

[http://jsfiddle.net/8hU6K/2/](http://jsfiddle.net/8hU6K/2/)

# mongodb - 使用学说 2 或 mongodb 查询检索父文档

> ID：12182089
> 
> 赞同：0
> 
> 时间：2012-08-29T16:06:15.147
> 
> 标签：mongodb, symfony, doctrine-orm, symfony-2.1, doctrine-odm

我正在使用 Symfony 2.1 和 Doctrine - MongoDBBundle。

我有三个文件。第一个是一家公司，我称之为“机构”。第二个是机构内部的联系人，第三个是用户与联系人的谈话。

联系和交流嵌入到机构中，这在现实世界中是真实的。这不是问题。

但是一个联系人被引用到一个 Exchange 文档中。这似乎对教义2更复杂......

首先，我想构建一个表单，它仅建议（在“选项”字段中，即 Symfony 2.1 中的本地选择字段或文档字段）仅嵌入在当前“编辑”的机构中的联系人。

这个怎么做 ？

我尝试使用数据转换器。但这导致了另一个问题：如果我有 Contact 对象，我如何检索父“机构”对象？

这可能与 MongoDB 本机查询吗？还是使用查询生成器？

这是我的 YAML 映射：

对于机构：

```
SOFFT\ContactBundle\Document\Institution:
  type: document
  fields:
    id:
      id: true
      type: id
# ...
  embedMany:
    contacts:
      targetDocument: Contact
    exchange:
      targetDocument: Exchange 
```

联系方式：

```
SOFFT\ContactBundle\Document\Contact:
  type: embeddedDocument
  fields:
    id:
      id: true
#... 
```

换汇：

```
SOFFT\ContactBundle\Document\Exchange:
  type: embeddedDocument
  fields:
    id:
      id: true
#...
  referenceOne:
    contact:
      targetDocument: Contact 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:20:08.780

ODM 期望引用关系针对文档，而不是嵌入文档。虽然您当然可以将 ObjectId 存储在嵌入文档中，但 ODM 不知道如何解析引用，主要是因为：

*   联系人没有自己的存储库类
*   使用 Contact ObjectId 查询机构集合不会产生正确的结果
*   没有用于查询嵌入式 ObjectId 存储库的通用接口（沿着如何`DocumentRepository::find()`获取 ObjectId 的行）
*   没有将 ObjectId 存储在嵌入文档中的约定（与`_id`文档不同）

为了支持这一点，ODM 需要知道通过 查询机构集合`contacts.id`，从结果中提取适当的联系人并将其返回。理想情况下，我们希望使用字段选择来仅获取匹配的嵌入文档，如[SERVER-828](https://jira.mongodb.org/browse/SERVER-828)中所述（在今天发布的 MongoDB 2.2 中实现）。ODM 将来是否会获得此功能，它可能会利用该功能。

我的建议是避免在 Exchange 中使用 ODM 引用，而只需将 Contact ObjectId 存储在一个字段中。您仍然可以在机构的存储库上创建一个方法，以返回嵌入式联系人文档中所有 ObjectId 的列表，并将其提供给表单字段。我不确定 DoctrineMongoDBBundle 中的 DocumentType 字段在这里是否合适，但值得一试（我相信存储库方法是可配置的）。

最后，不要忘记在嵌入文档中为 ObjectId 指定唯一约束。

# html - 保证金是表格中预期大小的两倍 - 如何解决这些问题？

> ID：12182094
> 
> 赞同：0
> 
> 时间：2012-08-29T16:06:25.050
> 
> 标签：html, css, html-table, margin

我创建了这个小提琴[，它显示 div 对 div 的边距与表格中的 div 对 div 的边距](http://jsfiddle.net/gDuzC/2/)。

 `令人惊讶的是，后者的边距是两倍大，因为似乎边距对表格应用了两次——一次来自表格中的 div，一次来自下面的 div。在跨度的情况下不会发生这种情况。

我需要解决这个问题，而“不要使用表”的解决方案是无效的，因为这将应用于一个经常发生这些情况的大型框架。

基本上，这些表用于轻松地将事物放入列中。

**[编辑]**

好吧，我可以更改内联样式-是正确的-关键是-这是用于框架的。假设框架生成了一个包含一些内容的 div。这个，让我们称之为组件 - 应该可以放置在页面上的任何位置。框架不知道最后的边距大小。它只会将 friggn div 及其内容放在某处，我只希望 div 始终具有相同的边距，无论最后一项是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:20:34.767

顶部和底部边距通常会崩溃，并且较大的值获胜。但这仅在它们在 DOM 中处于同一级别时才有效。在您的示例中，表中的 div 与其他 div 在 DOM 中的级别不同。所以边距堆积起来。

您可以通过仅对 div 元素应用顶部或底部边距来解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:12:36.160

您可以单独指定特定 div 的 css；使用您为背景颜色指定的 CSS 选择器或内联样式。可以将上 div 的下边框设置为 0 或将下 div 的上边框设置为 0`

# jquery - 将表从最后一个索引移动到第一个

> ID：12182095
> 
> 赞同：0
> 
> 时间：2012-08-29T16:06:27.107
> 
> 标签：jquery, asp.net

我正在尝试将表中的最后一行移动到第一行。我将 asp:Wizard 的下一个导航表行移到顶部。

这是我的代码。我究竟做错了什么？该表有 8 行。它现在只是一个普通的简巫师。

```
 $(document).ready(function () {
        var wizard = $("#Wizard1");

        var k = $("#Wizard1 tbody tr td:first-child");
        var m = $("#Wizard1 tbody tr td:first-child").children(":eq(8)");

        var n = m.clone();

        m.remove();
        k.before(n);

    }); 
```

我最后做了什么，我应该想到的是，我删除了行并重新添加了订单。我的语法在 ? 虽然在重新检查树之后。对于造成的混乱，我深表歉意，但 IE 开发工具栏出于某种原因将树错误地放置在检查器中。

```
 $(document).ready(function () {
        var k = $("#Wizard1 tr:first-child td:last-child table tr:first-child");
        var n = k.clone();

        k.remove();
        $("#Wizard1 tr:first-child td:last-child table").append(n);

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:19:28.357

尝试这个

```
$(document).ready(function () {
    var wizard = $("#Wizard1");

    var k = $("#Wizard1 tbody tr:first-child");
    var m = $("#Wizard1 tbody tr:last-child");
    var n = m.clone();

    m.remove();
    k.before(n);

}); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:33:36.897

首先找出第一个和最后一个，然后移动它们的位置。

```
var firstRow = $('#Wizard1').find('tr').eq(0)
var lastRow =  $('#Wizard1').find('tr').eq($('#Wizard1').find('tr').length)

$('#Wizard1').prepend(lastRow);
$('#Wizard1').prepend(firstRow); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:26:41.647

我会这样做：

```
var wizard = document.getElementById("Wizard1");
var rows = wizard.getElementsByTagName("TR");
var firstRow = rows[0];
var lastRow = rows[rows.length - 1];
var rowParent = lastRow.parentNode; // You need the parent to manipulate the rows. Does not matter if it is tbody or the table element

rowParent.replaceChild(lastRow, firstRow);
rowParent.appendChild(firstRow); 
```

# ios - 从 iOS 应用程序将图像发布到用户的 Facebook 墙

> ID：12182096
> 
> 赞同：0
> 
> 时间：2012-08-29T16:06:33.913
> 
> 标签：ios, facebook, image, post, appdelegate

我正在尝试让我的应用与 Facebook 进行交互。我正在使用他们的 Facebook iOS SDK (3.0) 和 Xcode 4.2。到目前为止，我实现了一个登录方法，该方法还要求为我的应用程序提供适当的权限。当我单击视图控制器中的按钮时会调用此方法，该方法位于应用程序委托中。现在登录后我想要的是将照片发布到用户墙上；此按钮所在的视图控制器是照片查看器，因此我手头有图像。我看到的将图像发布到墙上的每种方法都包括在应用程序委托中包含 Facebook 类型对象的问题。为此，您需要导入已弃用的 Facebook.h，然后手动将其添加到项目中，以便导入会导致很多错误。那么我该怎么做呢？您如何使用已弃用的标头声明此 Facebook 对象？或者您可以在没有新 SDK 中的 Facebook 对象的情况下做到这一点吗？

* * *

好的。所以我用这个部分解决了它：

```
 - (void)facebookButtonHit:(id)sender{
  DrillDownAppAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
      [appDelegate openSessionWithAllowLoginUI:YES];
    if(FBSessionStateOpen){ NSString *linkul=@"";
    NSString *captt=@"";
        //seteaza link-ul postului
    if([self.optiune isEqualToString:@"SETURI TEMATICE"]){
       linkul=@"http://www.calinevents.com/seturi.html";}
        captt=@"SET TEMATIC CALIN EVENTS MODEL ";
        NSInteger i=_pageIndex+1;
        NSString *mno=[NSString stringWithFormat:@"%i",i];
        captt= [captt stringByAppendingString:mno];
        //seteaza parametrii postului
     NSString *Path1 = [[NSBundle mainBundle] bundlePath];
     NSString *Datele1 = [Path1 stringByAppendingPathComponent:@"Seturi.plist"];
     NSDictionary *tempDict = [[NSDictionary alloc] initWithContentsOfFile:Datele1];
    NSDictionary *tempdicty=[[tempDict objectForKey:@"Rows"] objectAtIndex:_pageIndex];
            NSString *tempurl=[tempdicty objectForKey:@"URL"];
    NSMutableDictionary *postParams = [[NSMutableDictionary alloc] initWithObjectsAndKeys:
     linkul, @"link",
     tempurl, @"picture",
     @"Imi place acest produs Calin Events", @"name",
     captt, @"caption",
     @"     ",@"description",
     nil];

        //posteaza pe Facebook
    UIAlertView *incarcare=[[UIAlertView alloc] initWithTitle:@""
                                message:@"Se publica imaginea...\nVa rugam asteptati"
                               delegate:self
                      cancelButtonTitle:nil
                      otherButtonTitles:nil];
    [incarcare setBackgroundColor:[UIColor blackColor]];
    [incarcare show];
    [FBRequestConnection
     startWithGraphPath:@"me/feed"
     parameters:postParams
     HTTPMethod:@"POST"
     completionHandler:^(FBRequestConnection *connection,
                         id result,
                         NSError *error) {
         NSString *alertText;
         if (error) {
             alertText = [NSString stringWithFormat:
                          @"S-a produs o eroare!\n Va rugam incercati din nou.",
                          error.domain, error.code];
         } else {
             alertText = [NSString stringWithFormat:
                          @"Imaginea a fost postata cu succes!\n Va multumim!",
                          [result objectForKey:@"id"]];
         }
         // Show the result in an alert

         [[[UIAlertView alloc] initWithTitle:@""
                                     message:alertText
                                    delegate:self
                           cancelButtonTitle:@"OK!"
                           otherButtonTitles:nil]
          show];
         [incarcare dismissWithClickedButtonIndex:0 animated:YES];
     }];
    }
} 
```

但现在我收到以下错误。第一次调用这个动作，它给出一个错误码=5，HTTP状态码=400；下次按下按钮时，它会起作用，并且图像会与所有信息一起正确发布。下次按下按钮时，它会再次输出错误，下次正确发布时。所以它会出错，发布，错误，发布等。我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T09:13:17.733

我把前几行代码改成这样，现在可以了：

```
DrillDownAppAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
   if(![FBSession.activeSession isOpen]){[appDelegate openSessionWithAllowLoginUI:YES];
                                            }
    if([FBSession.activeSession isOpen]){[appDelegate openSessionWithAllowLoginUI:NO];} 
```

# android - 列表视图下方的图像

> ID：12182097
> 
> 赞同：0
> 
> 时间：2012-08-29T16:06:38.433
> 
> 标签：android, android-layout

我有这个占据整个页面的列表视图。我希望它尽可能向下延伸，但我需要它下面的图像。现在列表一直延伸到我的标签栏所在的位置，但我需要介于两者之间的那张图片。在我的模拟器上它之前运行良好，但我有一个指定的高度，所以当我在手机上测试它时，高度是一团糟。

这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>  
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <RelativeLayout android:layout_width="wrap_content" android:layout_height="50dp">       
        <ImageView android:id="@+id/selfImage" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@drawable/navbar"/>
        <ImageView android:id="@+id/logoImage" android:layout_width="70dp" android:layout_height="46dp" android:layout_alignParentTop="true" android:layout_alignParentRight="true" android:background="@layout/border"/>
        <ImageView android:id="@+id/mainLogo" android:layout_width="50dp" android:layout_height="46dp" android:background="@drawable/corner_icon" android:layout_alignParentTop="true" android:layout_alignParentLeft="true"/>
        <TextView android:id="@+id/nameTitle" android:text="Help" android:layout_width="130dp" android:layout_height="46dp" android:layout_centerHorizontal="true" android:layout_centerVertical="true" android:gravity="center" android:textColor="#C6DE52"/>
    </RelativeLayout>

    <RelativeLayout android:layout_width="310dp" android:layout_height="40dp">
        <EditText android:id="@+id/search"
            android:layout_height="match_parent"
            android:layout_width="280dp"
            android:hint="Search"/>
        <ImageButton
            android:id="@+id/favButton"
            android:layout_width="20dp"
            android:layout_height="20dp"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true"
            android:background="@drawable/favorite" />

    </RelativeLayout>

   <ListView
       android:id="@+id/selfHelpList"
       android:layout_width="fill_parent"
       android:layout_height="wrap_content" >

   </ListView>

   <RelativeLayout android:layout_width="match_parent" android:layout_height="30dp">    
       <ImageView android:id="@+id/myImageView"
           android:layout_width="fill_parent"
           android:layout_height="wrap_content"
           android:background="@drawable/bottombar" />

       <TextView android:id="@+id/myImageViewText"
           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:layout_alignLeft="@+id/myImageView"
           android:layout_alignTop="@+id/myImageView"
           android:layout_alignRight="@+id/myImageView"
           android:layout_alignBottom="@+id/myImageView"
           android:layout_margin="1dp"
           android:layout_alignParentLeft="true"
           android:text="For immediate assisstance call"
           android:textColor="#C6DE52" />

       <Button android:id="@+id/urgentNumButton"
           android:layout_width="120dp"
           android:layout_height="match_parent"
           android:layout_alignParentRight="true"
           android:paddingLeft="5dp"
           android:paddingTop="2dp"
           android:textColor="#C6DE52"    
           android:gravity="left"           
           android:background="@android:color/transparent"
           android:onClick="onClick"/>
   </RelativeLayout>

</LinearLayout> 
```

这是屏幕应该做的，（图像有一个固定的高度。我试图远离那个）

![在此处输入图像描述](../Images/9ede056009e7471f2b28b2d2a1166e95.png)

这是它现在的样子。

![在此处输入图像描述](../Images/603a6841c448c387f99d68330036335f.png)

任何帮助都会很棒。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:24:49.147

更改`ListView`为：

```
<ListView
       android:id="@+id/selfHelpList"
       android:layout_width="fill_parent"
       android:layout_height="fill_parent"
       android:layout_weight="1" /> 
```

这将导致`ListView`接管整个屏幕，现在添加到上面和下面的所有视图中：

```
android:layout_weight="0" 
```

所以他们会根据需要占据尽可能多的空间，然后`ListView`将获得所有其余的高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-15T06:59:17.730

我有一个屏幕，其中 Imageview 位于 ListView 的上方和下方，这可能有帮助..

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:background="@drawable/bg">

    <ImageView
        android:id="@+id/dept_nav"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/dept_nav" />

      <ListView
        android:id="@+id/list_of_f"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"
        android:layout_margin="5dp"
        android:layout_below="@+id/dept_nav"
        android:layout_above="@+id/imageViewId"
        android:divider="@null"
        android:dividerHeight="0dp"
        android:listSelector="@android:color/transparent" >
    </ListView>

        <ImageView
        android:id="@+id/imageViewId"
        android:layout_alignParentBottom="true"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="2dp"
        android:scaleType="fitXY"
        android:src="@drawable/empty_cell" >
    </ImageView>

</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-04T00:52:21.653

已经在一个单独的问题中回答了这个[问题](https://stackoverflow.com/a/43196586/1016544)

您可以通过将 ImageView 添加为`Footer`ListView 来以更好的方式完成此操作。

# jquery - 简单的 JQuery 手风琴幻灯片问题和 Firefox 浏览器列表问题

> ID：12182104
> 
> 赞同：1
> 
> 时间：2012-08-29T16:06:54.487
> 
> 标签：jquery, accordion, slideshow

我创建的一个简单的手风琴幻灯片有一个奇怪的问题。目标是让它每 5 秒自动无限滚动一次，然后在单击特定图片时重新启动计时器。它似乎工作得很好，它将无限滚动并单击图片切换到正确的图片。但是，当我单击一张图片并且计时器重新启动时，它似乎在到达最后一项后停止循环回到第一张图片并卡在那里。我希望这不会令人困惑。基本上，在单击任何列表项后，一切都可以正常工作，直到到达列表末尾。

我遇到的另一个问题是图片没有出现在 Firefox 浏览器中，只是列表样式中的 alt 文本。我无法弄清楚我的 Firefox 浏览器的 CSS 需要有什么不同。

谢谢！

这是Javascript：

```
<script type="text/javascript">
$(function(){

activeItem = $("#slideshow li:first");
$(activeItem).addClass('active');

timeoutID = setTimeout(autoscroll, 5000);

function autoscroll(){
if($(activeItem).is("#slideshow li:last")){next = $("#slideshow li:first");}    
else{next = $(activeItem).next("#slideshow li");}
$(activeItem).animate({width: "75px"}, {duration:300, queue:false});
$(next).animate({width: "850px"}, {duration:300, queue:false});
activeItem = next;
timeoutID = setTimeout(autoscroll, 5000);}

$("#slideshow li").click(function(){
clearTimeout(timeoutID);
$(activeItem).animate({width: "75px"}, {duration:300, queue:false});
$(this).animate({width: "850px"}, {duration:300, queue:false});
activeItem = this;
timeoutID = setTimeout(autoscroll, 5000);
});

});</script> 
```

随之而来的 CSS：

```
#container{
width: 1100px;
margin: auto;
border: 1px solid black;}

#slideshow{
list-style: none;
margin: 0px;
padding: 0px;
height: 400px;}

#slideshow li{
float: left;
display: block;
height: 400px;
width: 75px;
padding: 15px 0;
overflow: hidden;
color: #fff;
text-decoration: none;
font-size: 16px;
line-height: 1.5em;
border-left: 1px solid #fff;}

#slideshow li img {
border: none;
border-right: 1px solid #fff;
float: left;
margin: -15px 15px 0 0;}

#slideshow li.active {
width: 850px;} 
```

HTML 只是一个简单的列表（图像已本地化）：

```
<div id="container"> 
 <ul id="slideshow">
  <li><a><img src="C:\Users\Scott\Google Drive\Website\Bella Bri.jpg" alt="boat"></a>   </li>
  <li><a><img src="C:\Users\Scott\Google Drive\Website\DREAMHACK-UCOS.jpg" alt="comp"></a></li>
  <li><a><img src="C:\Users\Scott\Google Drive\Website\manda-bay-lamu.jpg" alt="beach"></a></li>
  <li><a><img src="C:\Users\Scott\Google Drive\Website\car-picture.jpg" alt="car"></a></li>
 </ul>
</div> 
```

# r - 如何使用 ddply 关联多个列？

> ID：12182105
> 
> 赞同：0
> 
> 时间：2012-08-29T16:06:59.870
> 
> 标签：r, plyr, correlation

我有一个 data.frame，我想使用一列与其他列计算相关系数（框架中也有一些非数字列）。

```
ddply(Banks,.(brand_id,standard.quarter),function(x) { cor(BLY11,x) })
# Error in cor(BLY11, x) : 'y' must be numeric 
```

我针对 is.numeric(x) 进行了测试

```
ddply(Banks,.(brand_id,standard.quarter),function(x) { if is.numeric(x) cor(BLY11,x) else 0 }) 
```

但是每次比较都失败并返回 0 并且只返回一列，就好像它只被调用一次一样。传递给函数的是什么？刚来到 R，我认为我缺少一些基本的东西。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T16:59:50.493

来自？cor：

> 如果“x”和“y”是矩阵，则计算“x”列和“y”列之间的协方差（或相关性）。

所以你唯一真正的工作是删除非数字列：

```
# An example data.frame containing a non-numeric column
d <- cbind(fac=c("A","B"), mtcars)

## Calculate correlations between the mpg column and all numeric columns
cor(d$mpg, as.matrix(d[sapply(d, is.numeric)]))
     mpg       cyl       disp         hp      drat         wt     qsec
[1,]   1 -0.852162 -0.8475514 -0.7761684 0.6811719 -0.8676594 0.418684
            vs        am      gear       carb
[1,] 0.6640389 0.5998324 0.4802848 -0.5509251 
```

**编辑：**事实上，正如@MYaseen208 的回答所示，没有必要将 data.frames 显式转换为矩阵。以下两项工作都很好：

```
cor(d$mpg, d[sapply(d, is.numeric)])

cor(mtcars, mtcars) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T17:02:52.037

试试这样的

```
cor(longley[, 1], longley[ , sapply(longley, is.numeric)])

    GNP.deflator       GNP Unemployed Armed.Forces Population      Year  Employed
[1,]            1 0.9915892  0.6206334    0.4647442  0.9791634 0.9911492 0.9708985 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T16:51:31.890

此函数对块进行操作：

```
calc_cor_only_numeric = function(chunk) {
   is_numeric = sapply(chunk, is.numeric)
   return(cor(chunk[-is_numeric]))
 } 
```

并且可以用于`ddply`：

```
ddply(banks, .(cat1, cat2), calc_cor_only_numeric) 
```

我无法检查代码，但这应该可以帮助您入门。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T16:24:31.040

ddply 将 data.frame 拆分为块并将它们（较小的 data.frames）发送到您的函数。你`x`是一个 data.frame 与相同的列`Banks`。因此，`is.numeric(x)`是`FALSE`。 `is.data.frame(x)`应该返回`TRUE`。

尝试：

```
function(x) { 
  cor(x$BLY11, x$othercolumnname) 
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T16:37:30.027

看起来你正在做的事情也可以完成`sapply`：

```
with(Banks,
  sapply( list(brand_id,standard.quarter), function(x) cor(BLY11,x) )
) 
```

# c++ - 班内朋友的定义

> ID：12182108
> 
> 赞同：2
> 
> 时间：2012-08-29T16:07:17.357
> 
> 标签：c++

我可以将朋友函数/类的定义放在另一个类中吗？我的意思是这样的：

```
class Foo
{
    friend void foo() {} // 1
    friend class Bar {}; // 2
}; 
```

gcc 编译友元函数，但不能编译友元类。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T16:20:44.100

您可以在朋友声明中*定义*一个`friend`函数，它具有任何其他方式都无法获得的有趣行为（在封闭类型是模板的情况下）。

您不能在朋友声明中*定义*一个`friend`类，也没有必要这样做。如果要创建具有完全访问权限的*内联*新类型，只需创建*嵌套*类型即可。作为成员，它将拥有对封闭类型的完全访问权限。唯一的区别是在命名空间级别不会找到该类型，但如果需要，您可以添加 typedef（或者，在命名空间级别定义类并在类中声明友谊）。

```
class Outer {
   int x;
   class Inner {
      static void f( Outer& o ) { o.x = 5; } // fine
   };
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T16:11:06.433

n3337 11.3/2

> 类不应**在**友元声明中定义。[ 例子：
> 
> ```
> class A {
> friend class B { }; // error: cannot define class in friend declaration
> }; 
> ```
> 
> —结束示例]

但是你可以使用类似的东西

```
class Foo
{
    friend void foo() {} // 1
    class Bar { };
    friend class Bar; // 2
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T16:18:11.850

您可以创建一个嵌套类，[根据缺陷报告 45](http://www.open-std.org/JTC1/SC22/WG21/docs/cwg_defects.html#45)，该类可以访问该类的私有成员。这是你的意思吗？

“嵌套类是一个成员，因此具有与任何其他成员相同的访问权限。”

这可能不适用于所有编译器，因为在此 C++ 标准缺陷报告之前，嵌套类没有被授予特殊访问权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T16:12:02.977

将代码更改为：-

```
class Foo 
{
     friend void foo() {} // 1
     friend class Bar ; // 2 
}; 
```

# html - 展开 div 以包含绝对定位的内容

> ID：12182109
> 
> 赞同：7
> 
> 时间：2012-08-29T16:07:24.867
> 
> 标签：html, css, positioning

我有一个`div`包含一堆绝对定位的控件。这些控件是动态生成的，我希望`div`扩展它，以便它覆盖宽度和高度的所有内容。如何在 CSS 中做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-03-28T14:05:01.113

这可以通过[CSS 网格](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout/Basic_Concepts_of_Grid_Layout)实现：

```
.container {
  display: grid;
}

.container > * {
  grid-area: 1/1;
}

.child {
  /* Instead of using top/left, use margins: */
  margin-top: 10px;
  margin-left: 50px;
} 
```

这将创建一个只有一个单元格的网格，并且每个孩子都进入该单元格。

一个孩子的布局不会影响其他孩子，它们只是相互叠加，但网格 ( `.container`) 将扩展以适应所有孩子的边界。

演示：[https ://codepen.io/jaffathecake/pen/zWrvZx](https://codepen.io/jaffathecake/pen/zWrvZx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:20:13.727

这是很难实现的。当您有一个相对父级和绝对子级时，它们不会影响父级 div 的大小。

你也必须使用亲戚的孩子。为什么控件的位置是绝对的？

但是在 CSS 失败的地方，JavaScript 来拯救。所以这个可以解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-06T17:49:43.857

如果您知道容器的比例并且项目按该比例缩放，则可以使用纵横比来模拟控件的包含...

[https://developer.mozilla.org/en-US/docs/Web/CSS/aspect-ratio](https://developer.mozilla.org/en-US/docs/Web/CSS/aspect-ratio)

这是我使用这种方法的代码笔： [https ://codepen.io/cssguru/pen/yLoKYzR?editors=1100](https://codepen.io/cssguru/pen/yLoKYzR?editors=1100)

```
<div class="img-swap">
  <img src="https://via.placeholder.com/400x300/fff" />
  <img src="https://via.placeholder.com/400x300/fff" />
</div> 
```

```
html, body {
  margin: 0;
  padding: 1rem;
}

.img-swap {
  position: relative;
  aspect-ratio: 4 / 3;
  background: red;

  $pos-x: 10%;
  $pos-y: 10%;

  img {
    position: absolute;
    border-radius: .25rem;
    box-shadow: 0 10px 20px rgba(0,0,0,0.1), 0 3px 3px rgba(0,0,0,0.15);
    animation-duration: 14s;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
    animation-name: imgSwap;
    z-index: 1;
    bottom: $pos-y; 
    right: $pos-x;
    width: calc(100% - #{$pos-x});
  }

  img + img {
    animation-name: imgSwap;
    animation-delay: 7s;
    top: $pos-y; 
    left: $pos-x;
    z-index: 2;
  }

  @keyframes imgSwap {
    0% { opacity: 0; top: 0; left: 0; z-index: 1; }
    2% { opacity: 1; top: 0; left: 0; z-index: 1; }
    45% { opacity: 1; top: 0; left: 0; z-index: 1; }
    55% { opacity: 1; top: $pos-y; left: $pos-x; z-index: 2; }
    98% { opacity: 1; top: $pos-y; left: $pos-x; z-index: 2; }
    100% { opacity: 0; top: $pos-y; left: $pos-x; z-index: 2; }
  } 

} 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-08-29T16:10:42.633

如果我理解正确，你可以这样写：

```
.parent{
 position:relative;
 width:100px;
 height:100px;
}
.dynamicDiv{
 position:absolute;
 top:0;
 bottom:0;
 left:0;
 right:0;
} 
```

# javascript - RegExp - 我怎样才能匹配最短的金额？

> ID：12182110
> 
> 赞同：10
> 
> 时间：2012-08-29T16:07:26.640
> 
> 标签：javascript, regex, or-operator

我有我的正则表达式`/'(.*)(?:(?:'\s*,\s*)|(?:'\)))/`
和我的测试代码`('He said, "You're cool."' , 'Rawr')`
（我的测试代码模拟传递给函数的参数。）

我将按照我的理解解释我的正则表达式，希望你们中的一些人能对我的问题有所了解。

1)`/'`表示在匹配字符串的开头，需要有`'`

2)表示捕获除0 次或多次以外的`(.*)`任何字符 3)表示不捕获但尝试执行第 4 步，如果它不起作用，请尝试第 5 步 4 )表示不捕获但需要有 0 个或更多空白字符的 a 后跟具有 0 个或更多空白字符的 a 5)表示不捕获但需要有`\n`

`(?:(?:4)|(?:5))`

`(?:'\s*,\s*)``'``,`

`(?:'\))``')`

所以它似乎应该返回这个（这就是我想要的）：++但它返回：++
`'`如果 我将`He said, "You're cool."`我 的测试代码更改为（没有结束括号）它会返回我想要的，但是只要我添加它最后一个括号，那么我的 OR 运算符似乎可以为所欲为。我希望它首先测试是否有逗号，如果有逗号，则在此处中断，如果没有，则检查括号。 我试过切换第 4 步和第 5 步的位置，但 OR 运算符似乎总是默认放在一边。 **我怎样才能匹配最短的金额？**`' ,`

`'``He said, "You're cool."' , 'Rawr``')`

`('He said, "You're cool."' , 'Rawr'`

`(?:'\))`

 *** * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-29T16:16:54.897

我认为您的问题不是 OR 运算符，[而是](http://www.regular-expressions.info/repeat.html#greedy)`.*`. 它将匹配您的完整字符串，然后*返回*-track 直到以下表达式匹配。此回溯过程中的第一个匹配项将是`'He said, "You're cool."' , 'Rawr`+ `')`。试试`.*?`吧！**

# ruby - 通过动态创建 ruby 对象/变量来干燥代码

> ID：12182116
> 
> 赞同：0
> 
> 时间：2012-08-29T16:08:04.830
> 
> 标签：ruby, ruby-on-rails-3, dry

我对 Ruby 很陌生。我有几行代码要干燥它们。

```
foo_attributes = params[:foo]
params.delete(:foo)
bar_attributes = params[:bar]
params.delete(:bar) 
```

我正在尝试做这样的事情

```
["foo", "bar"].each do |par|
  par_attribute = params[:par]
  params.delete(:par)
end 
```

稍后在我的方法中，我需要调用传递对象 foo_attribute、bar_attribute 的其他方法。

喜欢：

```
call_foo_method(foo_attribute) 
```

我怎样才能在红宝石中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:35:06.213

你为什么不只保留`params`var？那么您根本不必分配任何其他变量吗？

您还可以通过组合两行来干燥第一个（和第二个示例）：

```
foo_attributes = params.delete(:foo)
bar_attributes = params.delete(:bar) 
```

# windows - 安装 Windows Phone SDK 时出错

> ID：12182120
> 
> 赞同：0
> 
> 时间：2012-08-29T16:08:18.370
> 
> 标签：windows, windows-phone-7, installation

在我安装 windows phone 7 SDK 时发生以下错误并且设置无法完成。

![安装 Windows Phone SDK 7.1 时出错](../Images/72893bbad1c4e0ce72456daceb5c5073.png)

任何人都知道如何解决此错误并安装 Windows Phone 7 SDK。

我已经安装了 Microsoft Visual Studio 2010 Ultimate，但仍然出现安装错误

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:11:53.507

但是你安装SP1了吗？如果没有，请继续安装：

[http://www.microsoft.com/en-us/download/details.aspx?id=23691](http://www.microsoft.com/en-us/download/details.aspx?id=23691)

# java - 在java中转义javascript字符串

> ID：12182121
> 
> 赞同：15
> 
> 时间：2012-08-29T16:08:19.743
> 
> 标签：java, javascript, jsp, escaping, html-escape-characters

我需要在java中把它变成一个字符串：

```
 <script type="text/javascript">document.write("<img src=\"UpArrow.png\" /> \"); </script> 
```

有人可以帮忙吗？我一直在尝试，结果是这样的......

```
return "<script type=\"text/javascript\">document.write(\"<img src=\"UpArrow.png\" /> \"); </script>"; 
```

这不起作用，因为我需要在 UpArrow.png 之前和之后双重转义引号。因为它需要在 javascript 中而不是在 java 中进行转义。

.

.

**2019 年更新：**如果你正在看这个，上帝保佑你的灵魂。这是一个糟糕的代码，如果你试图以这种方式做事，那么你做错了（正如其他人向我建议的那样）。

做到这一点的正确方法是 jquery 或现在存在的无数 DOM 修改框架之一，并将内容弹出/弹出 DOM 范围。

如果你这样做，你不应该看上面的代码或下面的解决方案，而应该去了解更多，因为这是制作意大利面条代码的途径。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-29T16:10:14.377

[Apache commons 在StringEscapeUtils](http://commons.apache.org/proper/commons-lang/javadocs/api-2.4/org/apache/commons/lang/StringEscapeUtils.html)中有一个专门用于此的方法：`escapeJavaScript`方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-08-23T21:32:37.590

看起来它已在 Apache Commons Lang 3 中移至 StringEscapeUtils 中的 ESCAPE_ECMASCRIPT。

[https://commons.apache.org/proper/commons-lang/javadocs/api-3.4/src-html/org/apache/commons/lang3/StringEscapeUtils.html#line.74](https://commons.apache.org/proper/commons-lang/javadocs/api-3.4/src-html/org/apache/commons/lang3/StringEscapeUtils.html#line.74)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-06-20T18:19:37.540

它似乎又移动了，现在它是“commons-text”的一部分并被命名为：

```
StringEscapeUtils.escapeEcmaScript 
```

但好在它仍然存在。

# javascript - 更改选择值后复制一个div

> ID：12182126
> 
> 赞同：0
> 
> 时间：2012-08-29T16:08:31.343
> 
> 标签：javascript, jquery, html

在更改此链接中的选择后，我试图复制一个 div：http: [//jsfiddle.net/ranell/mN6nm/5/](http://jsfiddle.net/ranell/mN6nm/5/) 我有 [object] 而不是我的列表 :( 有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:20:27.097

像这样**[的 jsFiddle 示例](http://jsfiddle.net/j08691/mN6nm/16/)**？

```
$('#sctChambre').change(function() {
    var total = parseInt($(this).val());
    for (i = 0; i < total; i++) {
        $('#dvCat').after($('#dvCatGr').clone().attr('id', 'c' + i));
    }
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:10:25.207

试试这个：（[jsFiddle](http://jsfiddle.net/mN6nm/20/)）：

```
$(document).ready(function () {
    var original = $("#dvCatGr");

    $('#sctChambre').change(function() {
        var total = parseInt($(this).val());

        $('#dvCat').empty();

        for (var i = 0; i < total; i++) {
            $("#dvCat").append($(original).clone().attr("id", "dvCatGr"+ i));
        }
    });
}); 
```

# xml - 在 perl 中使用 libXML 将字符串转换为哈希

> ID：12182129
> 
> 赞同：2
> 
> 时间：2012-08-29T16:08:43.160
> 
> 标签：xml, perl

我有一个 xml 格式的字符串，我希望使用 LIBXML 将其转换为哈希。我怎么能在 perl 中这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:22:03.163

[搜索](https://metacpan.org/search?q=dist%3AXML-LibXML&q=hash)[`XML::LibXML`](https://metacpan.org/release/XML-LibXML)分布，似乎对此类功能的支持仅限于属性，仅通过[`XML::LibXML::AttributeHash`](https://metacpan.org/module/XML%3a%3aLibXML%3a%3aAttributeHash).

引用[`XML::LibXML::DOM`](https://metacpan.org/module/XML%3a%3aLibXML%3a%3aDOM)：

> 还必须记住，这`XML::LibXML`是一个与 libxml2 节点的接口，它实际上位于`XML::LibXML`. 这意味着每个节点都是对不同于 perl 哈希或数组的结构的引用。访问这些结构值的唯一方法是通过`XML::LibXML`. 这也意味着， *不能*简单地继承一个`XML::LibXML`节点并添加新的成员变量，因为它们是哈希键。

但是，还有大量[其他](https://metacpan.org/search?q=xml+hash) [模块](https://metacpan.org/search?q=xml+tie+hash)可以散列 XML 字符串：

*   [`XML::Hash`](https://metacpan.org/module/XML%3a%3aHash)
*   [`XML::Twig`](https://metacpan.org/module/XML%3a%3aTwig)
*   [`XML::Fast`](https://metacpan.org/module/XML%3a%3aFast)
*   [`XML::Simple`](https://metacpan.org/module/XML%3a%3aSimple)
*   [`XML::Smart`](https://metacpan.org/module/XML%3a%3aSmart)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:19:31.757

[XML::LibXML](http://p3rl.org/XML%3a%3aLibXML)有一个非常好的 DOM 接口，但是如果你想“转换为散列”，你要么需要自己做一些 DOM 遍历，以将数据平滑成你想要的格式的散列，或者使用类似的东西[XML::Simple](http://p3rl.org/XML%3a%3aSimple)代替 libxml。XML::Simple 对于可靠的互操作来说有点可怕，但有时它是最简单的事情。

# jaxb - JAXB xjc 工具和非 ascii 字符

> ID：12182132
> 
> 赞同：2
> 
> 时间：2012-08-29T16:08:54.960
> 
> 标签：jaxb, xjc, non-ascii-characters

我有一个包含非 ascii 字符的 xsd 方案。

我想生成类，但强制 xjc 工具不要将这些字符转换为 unicode 格式 (\uXXXX)，并保持原样。

麻烦的是，当它将 unicode 表示形式的枚举值放入生成类的 XmlEnumValue 注释时，JAXB 解组器无法映射适当的字段。当我手动将其转换为普通状态时，它可以正常工作。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-05T12:50:28.707

您可以使用此代码将文件中的字符转换回本机表示：

```
import org.apache.commons.io.FileUtils;
import org.apache.commons.lang.StringEscapeUtils;

public void convertToNative(String filePath) throws IOException {
    File file = new File(filePath);
    FileWriter writer = new FileWriter(filePath + ".converted");
    try {
        String s = FileUtils.readFileToString(file, "utf-8");
        s = StringEscapeUtils.unescapeJava(s);
        writer.write(s);
    } finally {
        writer.close();
    }
} 
```

# qt - PyQt4：结合 textChanged 和 editingFinished 为 QLineEdit

> ID：12182133
> 
> 赞同：15
> 
> 时间：2012-08-29T16:08:56.890
> 
> 标签：qt, qt4, pyqt, pyqt4

有没有办法结合`textChanged`和`editingFinished`for `QLineEdit`？问题是`editingFinished`即使我只将光标移开`QLineEdit`而没有任何更改也会发出。而我只想在完成编辑后执行任何更改时才发出信号。

我可以想象只将当前文本存储在某个地方，将输入的文本与它进行比较，并且只有在它不同时才做某事。但我想知道是否有任何纯粹基于信号处理的解决方案。

**编辑：**最后我必须存储当前文本并与新文本进行比较，而不是遵循建议的解决方案。我意识到在我的应用程序中“1.2345”和“1.23”将是相同的文本，但在这种情况下我必须更新一些其他值等等。我非常感谢@Avaris 和@ekhumoro 的详细回答和评论，并且会接受它，因为它似乎解决了最初发布的问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-29T16:42:04.997

**编辑**

对于捕获手动编辑：

```
class MyLineEdit(QtGui.QLineEdit):
    textModified = QtCore.pyqtSignal(str, str) # (before, after)

    def __init__(self, contents='', parent=None):
        super(MyLineEdit, self).__init__(contents, parent)
        self.returnPressed.connect(self.checkText)
        self._before = contents

    def focusInEvent(self, event):
        if event.reason() != QtCore.Qt.PopupFocusReason:
            self._before = self.text()
        super(MyLineEdit, self).focusInEvent(event)

    def focusOutEvent(self, event):
        if event.reason() != QtCore.Qt.PopupFocusReason:
            self.checkText()
        super(MyLineEdit, self).focusOutEvent(event)

    def checkText(self):
        if self._before != self.text():
            self._before = self.text()
            self.textModified.emit(self._before, self.text()) 
```

**编辑 2**

用于捕获所有编辑（编程和手动）：

```
class MyLineEdit(QtGui.QLineEdit):
    textModified = QtCore.pyqtSignal(str, str) # (before, after)

    def __init__(self, contents='', parent=None):
        super(MyLineEdit, self).__init__(contents, parent)
        self.editingFinished.connect(self.checkText)
        self.textChanged.connect(lambda: self.checkText())
        self.returnPressed.connect(lambda: self.checkText(True))
        self._before = contents

    def checkText(self, _return=False):
        if (not self.hasFocus() or _return) and self._before != self.text():
            self._before = self.text()
            self.textModified.emit(self._before, self.text()) 
```

**编辑 3**

仅捕获用户的文本更改：

```
class MyLineEdit(QtGui.QLineEdit):
    textModified = QtCore.pyqtSignal(str, str) # (before, after)

    def __init__(self, contents='', parent=None):
        super(MyLineEdit, self).__init__(contents, parent)
        self.editingFinished.connect(self.__handleEditingFinished)
        self.textChanged.connect(self.__handleTextChanged)
        self._before = contents

    def __handleTextChanged(self, text):
        if not self.hasFocus():
            self._before = text

    def __handleEditingFinished(self):
        before, after = self._before, self.text()
        if before != after:
            self._before = after
            self.textModified.emit(before, after) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-29T18:33:12.513

如果您只想检测是否进行了*任何*更改（而不是文本是否与开始的方式不同），您可以使用信号的[`modified`](http://doc-snapshot.qt-project.org/4.8/qlineedit.html#modified-prop)属性：`QLineEdit`[`editingFinished`](http://doc-snapshot.qt-project.org/4.8/qlineedit.html#editingFinished)

```
 self.edit = QtGui.QLineEdit(self)
    self.edit.editingFinished.connect(self.handleEditingFinished)
    ...

def handleEditingFinished(self):
    if self.edit.isModified():
        # do interesting stuff ...
        print 'Editing Finished'
    self.edit.setModified(False) 
```

# wordpress - Wordpress 删除许多未使用的类别

> ID：12182134
> 
> 赞同：1
> 
> 时间：2012-08-29T16:09:06.700
> 
> 标签：wordpress, categories

我最近重新设计了一个网站并迁移到另一个域。新站点使用 Wordpress 作为整个站点的 CMS（它只是管理前一个站点的博客）。不知何故，在建立新网站的过程中，设计师添加了一大堆类别，准确地说是 953 个，其中大多数都附加了零帖子，并且永远不会使用。

我想清除这些零类别，但使用 WP 界面执行此操作需要很长时间，一次只能显示 20 个。有没有办法通过 MySQL 操作来做到这一点？我不愿意从类别表中删除它们，因为我不知道它们是如何链接到数据库中的其他地方的。OTOH 也许如果该类别的帖子为零，那没关系？

我知道有一些 WP 方法可以安全地执行此操作，因为当您删除类别时，仪表板上的类别页面必须调用它，但我无法通过查看表单来弄清楚它是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-04-09T23:56:00.080

对我有用的是：

```
DELETE FROM `wp_term_taxonomy` WHERE taxonomy = 'category' AND term_taxonomy_id NOT IN (SELECT term_taxonomy_id FROM `wp_term_relationships`);

DELETE FROM `wp_terms` WHERE term_id NOT IN (SELECT term_id FROM `wp_term_taxonomy`); 
```

注意 1：以前备份数据库可能是个好主意。

注意 2：这也会删除非空子类别的空父类别。如果您有这种情况，您必须`parent`在之后更新表中的列`wp_term_taxonomy`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T16:14:08.173

如果您单击控制面板顶部的“屏幕选项”按钮，您可以选择在 WP 界面中显示的类别数量，然后使用复选框进行批量删除。

# ruby-on-rails - 通过另一个计算资源？

> ID：12182139
> 
> 赞同：0
> 
> 时间：2012-08-29T16:09:15.670
> 
> 标签：ruby-on-rails, associations

这里是我的关系：

```
Account has_many :emails
Email has_many :recipients
Email belongs_to :account
Recipient belongs_to :email 
```

我想要做的是计算任何给定帐户有多少收件人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:19:37.610

您需要`:through`在模型中添加这样的关系`Account`：

```
class Account
  has_many :emails
  has_many :recipients, :through => :emails
end 
```

然后你可以这样做：

```
Account.first.recipients.count 
```

希望能帮助到你

# mysql - MySQL 语句有问题

> ID：12182141
> 
> 赞同：0
> 
> 时间：2012-08-29T16:09:37.903
> 
> 标签：mysql, sql, database

收到错误消息 [Err] 1060 - Duplicate column name 'id'

```
SELECT c.id, c.name, COUNT(all.id) 'All', 
       COUNT(unanswered.id) 'Unanswered',
       COUNT(unchecked.id) 'Unchecked'
FROM courses c
INNER JOIN courses-lessons cl ON c.id = cl.cid
INNER JOIN questions all ON cl.id = all.lid
INNER JOIN
(
    SELECT * 
    FROM questions
    WHERE id NOT IN (SELECT qid FROM answers)
) unanswered ON cl.id = unchecked.lid
INNER JOIN
(
    SELECT *
    FROM questions q
    INNER JOIN 
    (
        SELECT * 
        FROM answers
        WHERE id NOT IN (SELECT aid FROM answer_chk_results)
    ) a ON q.id = a.qid 
) unchecked ON cl.id = unchecked.lid
GROUP BY c.id, c.name 
```

我错过了什么？找不到问题所在。

# 更新

数据库结构

[https://docs.google.com/open?id=0B9ExyO6ktYcOenZ1WlBwdlY2R3c](https://docs.google.com/open?id=0B9ExyO6ktYcOenZ1WlBwdlY2R3c)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:18:51.747

您的问题和答案表都有 id 列。当您执行 SELECT * 时，您将获得两者的 id 列。尝试在 SELECT 中指定您需要的列，而不是使用 *

有关类似问题，请参见此处：[SQL Duplicate column name error](https://stackoverflow.com/questions/9260936/sql-duplicate-column-name-error)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:19:56.690

不确定它是否是您的问题的一部分，但您不应将表别名为“all”，因为它是 MySQL 关键字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:20:07.573

很可能在您查询的这一部分：

```
SELECT *
FROM questions q
INNER JOIN 
(
    SELECT * 
    FROM answers
    WHERE id NOT IN (SELECT aid FROM answer_chk_results)
) a ON q.id = a.qid 
```

外部查询将有两个名为 的字段`id`，您应该指定所需的`id`字段。`SELECT *`此外，您应该调出您需要的字段，而不是使用。

`ALL`也是一个[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)，我会考虑更改该别名或```在其周围使用反引号。

根据您的表结构，它看起来像您想要的：

```
SELECT c.id, 
    c.name, 
    COUNT(allq.id) 'All', 
    COUNT(unanswered.id) 'Unanswered',
    COUNT(unchecked.id) 'Unchecked'
FROM courses c
INNER JOIN courses-lessons cl 
    ON c.id = cl.cid
INNER JOIN questions allq 
    ON cl.id = allq.lid
INNER JOIN
(
    SELECT q.id, a.qid, q.lid
    FROM questions q
    INNER JOIN 
    (
        SELECT id, qid
        FROM answers
        WHERE id NOT IN (SELECT aid FROM answer_chk_results)
    ) a 
        ON q.id = a.qid 
) unchecked 
    ON cl.id = unchecked.lid
INNER JOIN
(
    SELECT id
    FROM questions
    WHERE id NOT IN (SELECT qid FROM answers)
) unanswered 
    ON cl.id = unchecked.lid
GROUP BY c.id, c.name 
```

# python - 弹出索引超出范围

> ID：12182147
> 
> 赞同：4
> 
> 时间：2012-08-29T16:09:58.847
> 
> 标签：python, list, indexing, range

```
N=8
f,g=4,7
indexList = range(N)
print indexList
print f, g
indexList.pop(f)
indexList.pop(g) 
```

在此代码中，我收到一条错误消息，指出`g`in的弹出索引`indexList`超出范围。这是输出：

```
[0, 1, 2, 3, 4, 5, 6, 7]
4 7
Traceback (most recent call last):
indexList.pop(g)
IndexError: pop index out of range 
```

我不明白，`g`值为 7，列表包含 7 个值，为什么无法返回列表中的 7？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T16:18:21.810

要获得弹出列表的最终值，您可以这样做：

```
>>> l=range(8)
>>> l
[0, 1, 2, 3, 4, 5, 6, 7]
>>> l.pop(4)                    # item at index 4
4
>>> l
[0, 1, 2, 3, 5, 6, 7]
>>> l.pop(-1)                   # item at end - equivalent to pop()
7
>>> l
[0, 1, 2, 3, 5, 6]
>>> l.pop(-2)                   # one left of the end 
5
>>> l
[0, 1, 2, 3, 6]
>>> l.pop()                     # always the end item
6
>>> l
[0, 1, 2, 3] 
```

请记住，[pop](http://docs.python.org/tutorial/datastructures.html#more-on-lists)会删除该项目，并且列表会在 pop 后更改长度。使用负数从可能改变大小的列表末尾开始索引，或者只使用没有参数的 pop() 结束项目。

由于弹出可能会产生这些错误，因此您经常会在[异常块](http://docs.python.org/reference/compound_stmts.html#try)中看到它们：

```
>>> l=[]
>>> try:
...    i=l.pop(5)
... except IndexError:
...    print "sorry -- can't pop that"
... 
sorry -- can't pop that 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-29T16:12:22.173

弹出 4 后，列表只有 7 个值。如果你`print indexList`在你的之后`pop(f)`，它会看起来像：

```
[0, 1, 2, 3, 5, 6, 7] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T16:24:23.810

与所有其他答案一样，该`pop()`函数的重要部分是它从数组中删除值，从而更改索引。弹出索引 4 后，您的列表中剩下 7 个项目。重要的是要知道 Python 索引从 0 开始，因此您的 7 项列表仅包含索引 0 到 6。这就是弹出索引 7 超出范围的原因，它不再存在。

通常在实现[堆栈](http://en.wikipedia.org/wiki/Stack_%28abstract_data_type%29)或[队列](http://en.wikipedia.org/wiki/Queue_%28abstract_data_type%29)时使用“弹出”函数，其中目标是从等待处理的值列表中获取值。为避免意外处理两次相同的数据，请确保在检索的同时将其删除。

有时堆栈和队列可以通过一个`peek`只返回值而不删除它的操作来实现，但是由于 Python 仅使用常规数组实现堆栈和队列，而没有任何特殊的包装器，因此您的 peek 函数将是标准`array[index]`调用。

**----EDIT----**
在我看来，可能不是删除*索引*7 处的项目，而是希望删除*值*7。如果是这种情况，您应该调用`indexList.remove(7)`. 这将删除`7`列表中的第一个实例，无论它的索引是什么（如果没有 value 则抛出错误`7`）。不过，我很确定你明白这`pop()`需要一个索引。

以防万一，请查看[Python 数据结构 API](http://docs.python.org/tutorial/datastructures.html)，以获取有关哪些函数可用、它们做什么以及它们采用哪些参数的更多信息。

# java - 将列表转换为多个嵌套地图

> ID：12182153
> 
> 赞同：1
> 
> 时间：2012-08-29T16:10:17.067
> 
> 标签：java

我得到一个这样的列表，每行一个对象包含纯字符串：

```
Vehicle, Name, Property, Value
------------------------------
Car, VW, Tires, 4
Car, VW, Doors, 4
Car, Porsche, Tires, 4
Car, Porsche, Doors, 2
Car, Porsche, Color, Red
Plane, A340, Tires, 12
Plane, A340, Color, White
Plane, A750, Doors, 6
Forklift, ABC345, Color, Orange
... and so on 
```

我想以 JSON 的形式返回它：

```
{ 
"Car" : {
     "VW":{ "Tires" : "4", "Doors": "4"},
     "Porsche":{ "Tires" : "4", "Doors": "2" }
     },
"Plane":{
     "A340":{ "Tires" : "12", "Color" : "White" },
     "A750":{ "Doors" : "6" }
     },
"Forklift" : {
     "ABC345": { "Color" : "Orange" }
     }
} 
```

我尝试使用一个奇怪的

```
HashMap<String, HashMap<String, HashMap<String, String>>> 
```

但老实说，我不知道如何正确设置它。当我遍历列表并写入 HashMap 时，Property 和 Value 总是被覆盖，所以我的结果如下所示：

```
{ 
"Car" : {
     "Porsche":{ "Tires" : "4" }
     },
"Plane":{
     "A750":{ "Doors" : "6" }
     },
"Forklift" : {
     "ABC345": { "Color" : "Orange" }
     }
} 
```

我对Java相当陌生，不知道如何处理这种嵌套的地图。

我的意思是，要求被宠爱有点尴尬，但也许有人可以告诉我如何以正确的方式做到这一点。

编辑：在这里我如何添加值，我没有粘贴这部分代码，因为我不知道如何检查和决定做什么。

```
HashMap<String, HashMap<String, HashMap<String, String>>> vehiclesData = new HashMap<String, HashMap<String, HashMap<String, String>>>();

for( VehicleReportRow vehicleReportRow : unpreparedRows ){
    String vehicle = vehicleReportRow.getVehicle();
    String name = vehicleReportRow.getName();
    String property = vehicleReportRow.getProperty();
    String value = vehicleReportRow.getValue();

    //the most inner dataset
    HashMap<String,String> propAndVal = new HashMap<String, String>();
   propAndVal.put(property, value);

    //the middle dataset            
    HashMap<String, HashMap<String,String>> nameToProps = new HashMap<String, HashMap<String,String>>();
    nameToProps.put(name, propAndVal);

    //and finally the outer dataset
    vehiclesData.put(vehicle, nameToProps);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:17:33.760

您正在使用两层深度的哈希图，而您的数据结构是三层深度。就像《盗梦空间》：“我们需要更深入！”

```
{ 
1: "Car" : {
2:     "VW":{ 
3:         "Tires" : "4", "Doors": "4"
       },
       "Porsche":{ 
           "Tires" : "4", "Doors": "2" 
       }
   },
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T17:58:30.423

现在看到您的代码后，问题正如我在评论中所暗示的那样。例如，您每次在循环中创建一个新的`nameToProps`和一个新`propAndVal`的，而不是检查是否存在您应该添加的现有的。您需要一些检查，例如：

```
for( VehicleReportRow vehicleReportRow : unpreparedRows ){
    String vehicle = vehicleReportRow.getVehicle();
    String name = vehicleReportRow.getName();
    String property = vehicleReportRow.getProperty();
    String value = vehicleReportRow.getValue();

    // check if we have an outermost entry for this vehicle type and if not then
    // create one and store it in vehiclesData so that next time we can get the same
    // map for this vehicle type
    HashMap<String, HashMap<String,String>> nameToProps = vehiclesData.get(vehicle);;
    if (nameToProps == null) {
        nameToProps = new HashMap<String, HashMap<String,String>>();
        vehiclesData.put(vehicle, nameToProps);
    }

    // similarly, check if we already have a props to values map for this name
    // and create and store one if not
    HashMap<String,String> propAndVal = nameToProps.get(name);
    if (propAndVal == null) {
        propAndVal = new HashMap<String, String>();
        nameToProps.put(name, propAndVal);
    }

    // store the property and value
    propAndVal.put(property, value);
} 
```

如果其中任何一个需要进一步解释，请告诉我。

# mobile - 宽度=设备宽度和原始大小的上限

> ID：12182155
> 
> 赞同：0
> 
> 时间：2012-08-29T16:10:20.753
> 
> 标签：mobile, jquery-mobile

在开发移动应用程序时，我设置了“width=device-width”。但是，这会导致在普通计算机中查看时图像被放大以填满屏幕。当然它应该是它应该做的，但是是否有可能使图像最多看起来与其原始尺寸一样大而不再有更多？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:11:25.787

使用 css：

```
max-width: "somethingpx"; 
```

# sql - 使用不同参数再次执行相同 sql 查询的替代方法

> ID：12182156
> 
> 赞同：0
> 
> 时间：2012-08-29T16:10:23.503
> 
> 标签：sql

我需要执行以下操作：

```
select table1.abc from table1 where col1 = ? and col2 = ? 
```

这里的问题是我需要从该表中获取 3 组 (col1, col2) 的数据。我不想为不同的参数执行相同的查询 3。

此外，我希望执行查询的结果集包含 3 列数据（每组 col1、col2 为 1）。

让我知道是否需要任何进一步的细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:18:12.223

如果您的查询只有一个结果，您可以只使用子选择：

```
select (select table1.abc from table1 where col1 = ? and col2 = ?),
    (select table1.abc from table1 where col1 = ? and col2 = ?),
    (select table1.abc from table1 where col1 = ? and col2 = ?)
from table1
limit 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:46:27.217

您可以将 OR 子句与具有不同参数集的 3 个集合一起使用

```
select table1.abc from table1 where (col1 = ? and col2 = ?)
OR (col1 = ? and col2 = ?) OR (col1 = ? and col2 = ?) 
```

# asp.net - IIS7 - 使用 ip 地址和端口号不会显示网站主页，但使用 localhost 会

> ID：12182159
> 
> 赞同：0
> 
> 时间：2012-08-29T16:10:28.793
> 
> 标签：asp.net, iis-7, localhost, default

使用 ASP.Net 我做了一个网站，在 VS2010 中按 F5 键时可以在浏览器窗口中加载它。

在浏览器窗口中，我注意到 VS2010 使用这样的地址来加载网站主页：

```
localhost:12345/ 
```

如果我尝试使用通过 ipconfig 找到的计算机的 IP 地址来加载主页，

```
1.2.3.4:12345 
```

我收到一条错误消息：

```
Could not connect to 1.2.3.4:12345 
```

如果我使用：

```
1.2.3.4 
```

我得到了 IIS7 默认页面。

我在这个例子中使用的实际地址和端口号与我实际使用的不同。

你能告诉我为什么 localhost 可以工作，但 1.2.3.4 不能工作吗？

你能告诉我是否需要对 IIS7 做一些额外的事情，因为我以前从未这样做过？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:17:28.137

有几件事要记住。您的计算机有两种类型的 IP 地址。第一个是私有 IP 地址，第二个是公共 IP 地址。IPConfig 将显示您的本地私有地址。您的私人地址将无法从 LAN 以外的任何地方访问。

如果您想从 localhost 在本地更改您的网站 URL，则需要更改 IDE 的开发设置。

这个[网站](http://weblogs.asp.net/scottgu/archive/2005/11/21/how-to-run-a-root-site-with-the-vs-vwd-2005-local-web-server.aspx)有一个关于如何做到这一点的很棒的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:02:39.097

首先，Visual Studio 为您提供的地址是与他们的开发服务器（Webdev.Webhost 或 Cassini）相对应的临时地址，该服务器不允许您连接计算机外部，这就是 localhost:1234 打开您的页面的原因，但 5.6.7.8:1234 没有。

其次，您似乎也配置了 IIS，但您需要将站点部署到 IIS，以下是有关部署站点的 Microsoft 信息：http: [//msdn.microsoft.com/en-us/library/20yh9f1b( v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/20yh9f1b(v=vs.100).aspx)，一旦部署，您可以在 IIS 或虚拟目录上创建一个应用程序，有关更多信息，您可以在这里查看：[http ://technet.microsoft.com/en-us/library/ cc772042(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc772042(v=ws.10).aspx)。

一旦您部署并配置了您的应用程序或虚拟目录，您就可以像这样访问您的站点：localhost/MyVirtualDirectory（假设您设置了一个虚拟目录）。

# php - 从变量调用函数

> ID：12182160
> 
> 赞同：-2
> 
> 时间：2012-08-29T16:10:32.790
> 
> 标签：php

```
$scripts[0] = 'Say Hello';
$scripts[1] = 'Dont Say Hello';
$scripts[2] = 'Welcome';

$function_name = str_replace(' ', '_', $scripts[0]);   //Name of the function "Say_Hello"

echo $function_name('Jolly');   // Should echo "Hello Jolly" 
```

我有一个巨大的数组，其中包含与函数相关的名称。通常，如果我们要调用函数**Say_Hello()**，我们会这样做：**Say_Hello('Jolly')**。但在我上面的例子中，函数的名称存储在一个变量中，那么我该如何调用它呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:14:29.667

查看 PHP 函数[`call_user_func`](http://php.net/manual/en/function.call-user-func.php)：

call_user_func — 调用第一个参数给出的回调

例子：

```
<?php
error_reporting(E_ALL);
function increment(&$var)
{
    $var++;
}

$a = 0;
call_user_func('increment', $a);
echo $a."\n";

call_user_func_array('increment', array(&$a)); // You can use this instead before PHP 5.3
echo $a."\n";
?> 
```

# c# - 使用 Web API 反序列化为具有抽象属性的类

> ID：12182164
> 
> 赞同：4
> 
> 时间：2012-08-29T16:10:45.107
> 
> 标签：c#, asp.net-web-api, json.net, deserialization

我正在尝试编写一组类来表示一个特别复杂的对象，在其中一个类中，我有一个属性被设置为三个可能的派生类的基（抽象）类。我正在设置一个 ASP.NET Web API 来处理序列化和反序列化，这意味着默认情况下，它使用 Json.NET 处理 JSON。如何让 Web API 将通过 POST 或 PUT 发送的 JSON 正确反序列化到正确的派生类中？

具有抽象成员的类看起来像这样（为了清楚起见，我包括了 Xml 装饰器，因为它们非常适合使用 XmlSerializer 反序列化 xml）

```
[Serializable]
public class FormulaStructure {
    [XmlElement("column", typeof(ColumnStructure))]
    [XmlElement("function", typeof(FunctionStructure))]
    [XmlElement("operand", typeof(OperandStructure))]
    public AFormulaItemStructure FormulaItem;
} 
```

抽象类非常基本：

```
[Serializable]
public abstract class AFormulaItemStructure { } 
```

抽象类有三个派生类：

```
[Serializable]
public class ColumnStructure: AFormulaItemStructure {
    [XmlAttribute("type")]
    public string Type;

    [XmlAttribute("field")]
    public string Field;

    [XmlAttribute("display")]
    public string Display;
}

[Serializable]
public class FunctionStructure: AFormulaItemStructure {
    [XmlAttribute("type")]
    public string Type;

    [XmlAttribute("name")]
    public string Name;

    [XmlElement("parameters")]
    public string Parameters;
}

[Serializable]
public class OperandStructure: AFormulaItemStructure {
    [XmlAttribute("type")]
    public string Type;

    [XmlElement("left")]
    public string Left;

    [XmlElement("right")]
    public string Right;
} 
```

目前，使用`[DataContract]`属性，Json.NET 格式化程序无法填充派生类，留下 property `null`。

* * *

### 问题

**我可以将** `XmlSerializer` **属性与** `DataContractSerializer` **同一类的属性混合吗？** 我使用 xml 是`XmlSerializer`因为我在设计的 xml 中使用了 xml 属性，但如果有必要，可以更改它，因为我自己正在开发 xml 模式。

**Json.NET 中的等价物是什么** `[KnownType()]` **？**`DataContractSerializer`Json.NET似乎不尊重`KnownType`. 我需要滚动自己的 JsonConverter 来确定正确的类型吗？

**我将如何装饰类以便** `DataContractSerializer` **或** `DataContractJsonSerializer` **将正确反序列化 Xml 和 Json 中的对象？** 我的目标是将其放入 ASP.NET Web API，因此我希望能够灵活地生成 Xml 或 Json，以适应所请求的类型。如果 Json.NET 不起作用，是否需要使用其他格式化程序来处理这个复杂的类？

*我需要能够在客户端生成对象，而不必在对象中包含 .NET 类名。*

* * *

### 测试和改进

在我对 Web API 的测试中，默认的序列化发送到客户端：

```
{"FormulaItem":{"type":"int","field":"my_field","display":"My Field"}} 
```

这对我的目的来说是理想的。但是，让它返回 API 并反序列化为正确的派生类型是行不通的（它会为属性生成 null）。

测试[Tommy Grovnes](https://stackoverflow.com/a/12184559/895646)下面的答案，`DataContractSerializer`他用于测试生成：

```
{"FormulaItem":{"__type":"column:#ExpressionStructureExperimentation.Models","display":"My Field","field":"my_field","type":"int"}} 
```

这对我或代码可维护性不起作用（如果我将整个命名空间硬编码到 JavaScript 中以生成这些对象，那么重构就变成了 PITA）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:47:21.310

你可以像已经提到的那样混合，但我认为你不需要，我自己没有使用过 WEB api，但是 WCF Rest 从 DataContracts 生成 xml 和 json（没有 Xml.. 标签），像这样标记你的类：

```
[DataContract]
public class FormulaStructure
{
    [DataMember]
    public AFormulaItemStructure FormulaItem;
}

[DataContract]
[KnownType(typeof(ColumnStructure))]
[KnownType(typeof(FunctionStructure))]
[KnownType(typeof(OperandStructure))]
public abstract class AFormulaItemStructure { }

[DataContract(Name="column")]
public class ColumnStructure : AFormulaItemStructure
{
    [DataMember(Name="type")]
    public string Type;

    [DataMember(Name = "field")]
    public string Field;

    [DataMember(Name = "display")]
    public string Display;
}

[DataContract(Name="function")]
public class FunctionStructure : AFormulaItemStructure
{
    [DataMember(Name = "type")]
    public string Type;

    [DataMember(Name = "name")]
    public string Name;

    [DataMember(Name = "parameters")]
    public string Parameters;
}

[DataContract(Name = "operand")]
public class OperandStructure : AFormulaItemStructure
{
    [DataMember(Name = "type")]
    public string Type;

    [DataMember(Name = "left")]
    public string Left;

    [DataMember(Name = "right")]
    public string Right;
} 
```

如果您需要对生成的 XML/JSON 进行更多控制，则可能需要进一步调整。我用这段代码来测试：

```
 public static string Serialize(FormulaStructure structure)
    {
        using (MemoryStream memoryStream = new MemoryStream())
        using (StreamReader reader = new StreamReader(memoryStream))
        {
            var serializer = new DataContractSerializer(typeof(FormulaStructure));
            serializer.WriteObject(memoryStream, structure);
            memoryStream.Position = 0;
            return reader.ReadToEnd();
        }
    }

    public static FormulaStructure Deserialize(string xml)
    {
        using (Stream stream = new MemoryStream())
        {
            byte[] data = System.Text.Encoding.UTF8.GetBytes(xml);
            stream.Write(data, 0, data.Length);
            stream.Position = 0;
            var deserializer = new DataContractSerializer(typeof(FormulaStructure));
            return (FormulaStructure)deserializer.ReadObject(stream);
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-25T14:04:36.527

在我之前的回答进一步遇到了一些问题之后，我发现了`SerializationBinder`JSON 可以用于序列化/反序列化命名空间的类。

## 代码优先

我生成了一个类来继承`SerializationBinder`：

```
public class KnownTypesBinder : System.Runtime.Serialization.SerializationBinder {
    public KnownTypesBinder() {
        KnownTypes = new List<Type>();
        AliasedTypes = new Dictionary<string, Type>();
    }
    public IList<Type> KnownTypes { get; set; }
    public IDictionary<string, Type> AliasedTypes { get; set; }
    public override Type BindToType(string assemblyName, string typeName) {
        if (AliasedTypes.ContainsKey(typeName)) { return AliasedTypes[typeName]; }
        var type = KnownTypes.SingleOrDefault(t => t.Name == typeName);
        if (type == null) {
            type = Type.GetType(Assembly.CreateQualifiedName(assemblyName, typeName));
            if (type == null) {
                throw new InvalidCastException("Unknown type encountered while deserializing JSON.  This can happen if class names have changed but the database or the JavaScript references the old class name.");
            }
        }

        return type;
    }

    public override void BindToName(Type serializedType, out string assemblyName, out string typeName) {
        assemblyName = null;
        typeName = serializedType.Name;
    }
} 
```

## 这个怎么运作

假设我有一组这样定义的类：

```
public class Class1 {
    public string Text { get; set; }
}

public class Class2 {
    public int Value { get; set; }
}

public class MyClass {
    public Class1 Text { get; set; }
    public Class2 Value { get; set; }
} 
```

## 别名类型

这样做是允许我为将要序列化/反序列化的类生成自己的名称。在我的`global.asax`文件中，我这样应用活页夹：

```
KnownTypesBinder binder = new KnownTypesBinder()
binder.AliasedTypes["Class1"] = typeof(Project1.Class1);
binder.AliasedTypes["WhateverStringIWant"] = typeof(Project1.Class2);

var json = GlobalConfiguration.Configuration.Formatters.JsonFormatter;
json.SerializerSettings.Binder = binder; 
```

现在，每当我将序列化为`MyClass`JSON 时，我都会得到以下信息：

```
{ 
    item: { 
        $type: "Project1.MyClass",  
        Text: {
            $type: "Class1",
            Text: "some value"
        },
        Value: {
            $type: "WhateverStringIWant",
            Value: 88
        }
    } 
} 
```

## 已知类型

我还可以选择剥离程序集信息并通过向以下内容添加信息来严格使用类名`KnownTypesBinder`：

```
KnownTypesBinder binder = new KnownTypesBinder()
binder.KnownTypes.Add(typeof(Project1.Class1));
binder.KnownTypes.Add(typeof(Project1.Class1)); 
```

在给出的两个示例中，`Class1`引用方式相同。但是，如果我重构`Class1`为 ，`NewClass1`那么第二个示例将开始发送不同的名称。这可能是也可能不是什么大问题，这取决于您是否使用这些类型。

## 最后的想法

AliasedTypes 的优点是我可以给它任何我想要的字符串，我重构代码的多少都没有关系，.NET 和 JavaScript（或任何消费者）之间的通信是不间断的。

注意不要将具有完全相同的类名的`AliasedType`s 和s 混在一起，因为编写的代码会胜过. 当活页夹无法识别类型（别名或已知）时，它将提供该类型的完整程序集名称。`KnownType``AliasType``KnownType`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T19:37:31.993

最后，我分解并将 .NET 类信息添加到字符串变量中的模块中，以使重构更容易。

```
module.net = {};
module.net.classes = {};
module.net.classes['column'] = "ColumnStructure";
module.net.classes['function'] = "FunctionStructure";
module.net.classes['operand'] = "OperandStructure";
module.net.getAssembly = function (className) {
    return "MyNamespace.Models." + module.net.classes[className] + ", MyAssembly";
} 
```

并将 JSON 生成为

```
{
    "FormulaItem": {
        "$type": module.net.getAssembly('column'),
        "type": "int",
        "field": "my_field",
        "display": "My Field"
    }
} 
```

# raphael - 用拉斐尔画一个矩形的线条

> ID：12182167
> 
> 赞同：1
> 
> 时间：2012-08-29T16:10:57.657
> 
> 标签：raphael, draw, rectangles

我想在动画中绘制矩形的线条。

这就是我得到的：

```
 window.onload = function() {  
        var paper = new Raphael(document.getElementById('ornament2'), 520, 520);

        var balk1 = paper.path("M10 10").animate({path: "M10 10 L510 10"}, 1000, function() {
            paper.path("M510 10").animate({path: "M510 10 L510 14"}, 80, function(){
                paper.path("M510 14").animate({path: "M510 14 L10 14"}, 1000, function(){
                    paper.path("M10 14").animate({path: "M10 14 L10 10"}, 80);
                });
            });
        }); 
      } 
```

绘制了矩形，但如果仔细观察，矩形的角并没有真正闭合。

看看这个例子：

```
var balk2 = paper.path ("M10 256 L510 256 L510 260 L10 260 z"); 
```

如果你用这种方式制作一个矩形，那么边角就会很锋利。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:56:11.877

更新为以前的白痴道歉：

我通常使用如下的实用函数在给定的时间段内绘制任意路径：

```
function drawpath( canvas, pathstr, duration, attr, callback )
{
    var guide_path = canvas.path( pathstr ).attr( { stroke: "none", fill: "none" } );
    var path = canvas.path( guide_path.getSubpath( 0, 1 ) ).attr( attr );
    var total_length = guide_path.getTotalLength( guide_path );
    var last_point = guide_path.getPointAtLength( 0 );
    var start_time = new Date().getTime();
    var interval_length = 25;
    var result = path;       

    var interval_id = setInterval( function()
    {
        var elapsed_time = new Date().getTime() - start_time;
        var this_length = elapsed_time / duration * total_length;
        var subpathstr = guide_path.getSubpath( 0, this_length );            
        attr.path = subpathstr;
        path.animate( attr, interval_length );                         
        if ( elapsed_time >= duration )
        {
            clearInterval( interval_id );
            if ( callback != undefined ) callback();
        }                                       
    }, interval_length );  
    return result;
} 
```

在这种情况下，您只需调用

```
var rectPath = drawpath( paper, "M10 10 L510 10 L510 14 L10 14 z", 4000, function()
    {
        // want to apply some other attributes to the finished rectangular path?  Here's where you'd do it.
    } ); 
```

This has the advantage of working with all sorts of complicated shapes, include textual paths if you're using `print`. That means you can accomplish moderately more impressive drawing effects, like [this](http://voidblossom.com/tests/pathTransform.php).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:23:47.213

不知道如何修复原件，但也许您可以删除原件，然后使用一条路径重绘

[http://jsfiddle.net/XhHgs/1/](http://jsfiddle.net/XhHgs/1/)

```
 window.onload = function() {  
        var paper = new Raphael(document.getElementById('ornament2'), 520, 520);

        var balk1 = paper.path("M10 10").animate({path: "M10 10 L510 10"}, 1000, function() {
                var path2=paper.path("M510 10");
                path2.animate({path: "M510 10 L510 14"}, 80, function(){
                var path3 = paper.path("M510 14");
                path3.animate({path: "M510 14 L10 14"}, 1000, function(){
                    paper.path("M10 14").animate({path: "M10 14 L10 10"}, 80).remove();
                    path3.remove();
                    path2.remove();
                    balk1.remove();
                    balk1  = paper.path ("M10 10 L510 10 L510 14 L10 14 z");
                });
            });
        }); 
      }​ 
```

编辑

在第二个想法只是使用这个

[http://jsfiddle.net/XhHgs/3/](http://jsfiddle.net/XhHgs/3/)

```
 window.onload = function() {  
        var paper = new Raphael(document.getElementById('ornament2'), 520, 520);

        var balk1 = paper.path("M10 10").animate({path: "M10 10 L510 10"}, 1000, function() {
                balk1 .animate({path: "M10 10 L510 10 L510 14"}, 80, function(){
                  balk1 .animate({path: "M10 10 L510 10 L510 14 L10 14"}, 1000, function(){
                   balk1.animate({path: "M10 10 L510 10 L510 14 L10 14 z"}, 80);
                });
            });
        }); 
      }​ 
```

# objective-c - UILocalnotification 没有触发

> ID：12182172
> 
> 赞同：1
> 
> 时间：2012-08-29T16:11:17.797
> 
> 标签：objective-c

由于我无法得到一个好的答案并且花了很多时间在这上面，我会详细地问我的问题

我想要的只是根据日期选择器创建一个警报。从现在开始将闹钟设置为 10 秒，效果很好。UIDatePicker，有效（打印日期，但不是我选择的日期，而是 3 小时后）我知道当地时间有问题，但我找不到任何好的解释。

我的建议，我想几乎每个人都不会参与当地时间，而是要带上每个用户的时钟，并根据他的时间设置闹钟。

我的代码不起作用，我不知道为什么。它没有触发（仅当我将其设置为 10 秒后）

拜托，我知道时区应该不同或其他什么，但如果你能解释到底要做什么以及如何做，那就太好了。谢谢。

这是代码：

```
-(void)setDatePicker
{
    CGRect pickerFrame = CGRectMake(0,265,0,0);

    UIDatePicker *myPicker = [[UIDatePicker alloc] initWithFrame:pickerFrame];
    [myPicker addTarget:self action:@selector(pickerChanged:) forControlEvents:UIControlEventValueChanged];

   [[[CCDirector sharedDirector] view] addSubview:myPicker];
     [myPicker release];
}

-(void)pickerChanged:(UIDatePicker*) datePicker
{

     date=datePicker.date;

     NSLog(@"value: %@",date);
} 
```

和本地通知：

```
-(void) scheduleNotificationForDate: (NSDate*)theDate
{

/* Here we cancel all previously scheduled notifications */
[[UIApplication sharedApplication] cancelAllLocalNotifications];

UILocalNotification *localNotification = [[UILocalNotification alloc] init];

//NSDateFormatter *dateFormat = [[[NSDateFormatter alloc]init]autorelease];
//[dateFormat setDateFormat:@"YYYY-MM-dd HH:mm:ss"];
//NSDate *notificationDate = [dateFormat stringFromDate:theDate];

localNotification.fireDate = theDate;
NSLog(@"Notification will be shown on: %@",localNotification.fireDate);

localNotification.timeZone = [NSTimeZone defaultTimeZone];
localNotification.alertBody = [NSString stringWithFormat:
                               @"Your notification message"];
localNotification.alertAction = NSLocalizedString(@"View details", nil);

localNotification.soundName = UILocalNotificationDefaultSoundName;
localNotification.applicationIconBadgeNumber = -1;

[[UIApplication sharedApplication] scheduleLocalNotification:localNotification];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:22:50.980

我得到了它 。

我不得不改变格式，它的工作。与区域无关。

```
NSDateFormatter *dateFormat = [[[NSDateFormatter alloc]init]autorelease];
     [dateFormat setDateFormat:@"YYYY-MM-dd HH:mm:ss"];
    NSString *dateString = [dateFormat stringFromDate:date];
    NSDate *notificationDate = [dateFormat dateFromString:dateString];

    localNotification.fireDate = notificationDate; 
```

# visual-c++ - 使用 mfc 从自定义对话框派生对话框

> ID：12182183
> 
> 赞同：0
> 
> 时间：2012-08-29T16:12:03.780
> 
> 标签：visual-c++, mfc, dialog, icons

我正在尝试定义一个自定义对话框模板，其中包含某些成员，例如`m_hImage`、`m_hName`和`m_hIcon`。然后我想使用这个模板派生对话框。

我没有在此模板中使用任何按钮（确定、取消等）。我还需要声明或定义`OnOk()`等`OnCancel()`吗？

谁能告诉我我需要在这个模板类中声明的其他方法是什么？

我的目标是只准备这个模板对话框，以便从这个模板派生的每个对话框都包含标题栏上的图标 ( `m_hIcon`)、`m_hImage`左上角的图像 ( ) 和右上角的图像名称 ( `m_hName`) .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T14:33:38.897

不，您不需要覆盖任何方法。但是，您可能需要覆盖`OnInitDialog`，否则您将没有任何对话框初始化。这是您可以设置对话框图标的覆盖方法。

# matlab - 在 MATLAB 中将 3D 曲面图覆盖在 3D 地球上

> ID：12182185
> 
> 赞同：2
> 
> 时间：2012-08-29T16:12:12.713
> 
> 标签：matlab, plot

我想在 MATLAB 中的地球上放置一个 3d 曲面图。我无法让它工作。

这是代码：

```
% Sampele Data
longitude = [1 2 3]
latitude = [3 2 1]
elevation = [12 21 13; 15 14 15; 12 16 15]

% Create Globe
figure
axesm('globe')
gridm('GLineStyle','-','Gcolor',[.8 .7 .6],'Galtitude', .02)
load coast
plot3m(lat,long,'k')
view(3)
axis off; zoom(2)

% Overlay Surface Plot
mesh(longitude,latitude,elevation)
surfm(longitude,latitude,elevation) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:42:43.960

虽然这并不明显，但您的代码实际上似乎工作正常。

要查看它，首先删除该线`mesh(longitude,latitude,elevation)`，因为它不在经纬度坐标中绘制。

现在的问题是，`surfm(longitude,latitude,elevation)`唯一绘制了一个很难发现的小区域。找到它，注释掉该行`plot3m(lat,long,'k')`，运行脚本并注意地球右半部的微小表面。

为了证明您的脚本正在运行，您还可以将最后一行替换为

```
surfm(lat(1:200),long(1:200), rand(200,200)) 
```

随机着色南极的一部分。

顺便说一句，你的最后一行不应该读`surfm(latitude,longitude,elevation)`吗？

# php - 在 google API 控制台中，我注册什么应用程序，我的应用程序何时位于内部服务器上

> ID：12182190
> 
> 赞同：1
> 
> 时间：2012-08-29T16:12:33.357
> 
> 标签：php, google-analytics

我的应用程序位于内部服务器上，并且由于 Google 正在将他们的 API 从 2.3 迁移到 2.4，我遵循迁移指南告诉我注册我的应用程序，问题是我的应用程序基于内部服务器，所以我不确定哪个要注册的类型。Web 应用程序似乎是一个合理的应用程序，但它们似乎只允许本地主机或外部域。但是当 localhost 是一个内部域时，这怎么可能呢？

# linux - 三通命令 unix

> ID：12182191
> 
> 赞同：1
> 
> 时间：2012-08-29T16:12:34.217
> 
> 标签：linux, bash, unix, ssh, tee

如何将所有这些服务放入日志文件：

```
stop service 1
stop service 2
stop service 3 
```

我希望所有这些服务日志都保存到一个文件中

我应该使用：

```
stop service 1 | tee log1.log
stop service 2 | tee log1.log
stop service 3 | tee log1.log 
```

或者：

```
stop service 1 
stop service 2 
stop service 3 | tee log1.log 
```

我还没有找到这样的问题谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T16:16:09.653

`tee`接受`-a`附加到文件的标志。因此，您应该能够通过执行以下命令将所有三个命令的输出重定向到单个文件：

```
stop service 1 | tee log1.log
stop service 2 | tee -a log1.log
stop service 3 | tee -a log1.log 
```

（第一个命令将截断任何现有文件）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T16:20:15.640

另一种不使用的方法`tee`是简单地使用带有单个重定向`stdout`到日志文件的 bash 命令组：

```
{ stop service 1; stop service 2; stop service 3 } > log1.log 
```

使用`>>`运算符附加到日志文件，或使用`&>>`运算符附加`stdout`和`stderr`。也可以使用 bash 子shell：

```
( stop service 1; stop service 2; stop service 3 ) > log1.log 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T16:25:01.180

```
{
stop service 1
stop service 2
stop service 3
} 2>&1 | tee log1.log 
```

这将使用单个重定向操作处理所有三个命令的输出。它还包括日志文件中的错误。

# java - 跨服务器实例管理共享属性文件

> ID：12182198
> 
> 赞同：1
> 
> 时间：2012-08-29T16:12:40.230
> 
> 标签：java, spring, properties

我开发了 Flex - Java - 我已部署到 Amazon EC2 映像中的 Spring Web 应用程序 - 一切看起来都很棒。

但是，我需要在位于不同机器上的应用程序的多个实例之间自动扩展和共享用户请求，即不在同一个 Tomcat 容器内。Amazon 管理负载平衡，应用程序使用 AMQ 主题在每个实例之间传达关键的应用程序级别更改。

这些通知之一可能是属性。我有几个属性文件，我使用 @Value 注释将它们注入到相关的 Spring bean 中。这些属性文件位于类路径根目录 (classpath:properties/) 的属性文件夹中

在单个节点上操作时，当我更新属性时，我使用 setter 更新内存中的值，并使用 FileInputStream 和 FileOutputStream 将更改写回相关的属性文件。这很容易。

但是，现在明显的问题是，当我自动缩放并在不同的容器中启动新实例时会发生什么？此应用程序将读取属性文件的已部署（旧）版本，并最终表现出与其他并行节点不同的行为。

如果可以的话，我*真的*很想在数据库上维护基于文件的配置——我知道数据库解决方案将是这里最普遍的响应，但任何建议都会受到赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:29:03.390

就您已经在使用 JMS 主题而言，我建议您使用持久订阅。

*如果客户端需要接收在某个主题上发布的所有消息，包括在订阅者处于非活动状态时发布的消息，它会使用持久的 TopicSubscriber。JMS 提供者保留此持久订阅的记录，并确保保留来自主题发布者的所有消息，直到它们被此持久订阅者确认或它们已过期。*

看看 JMS API：[http](http://docs.oracle.com/javaee/6/api/javax/jms/Session.html#createDurableSubscriber(javax.jms.Topic) ://docs.oracle.com/javaee/6/api/javax/jms/Session.html#createDurableSubscriber(javax.jms.Topic , java.lang.String)

# actionscript-3 - 将着色器过滤器应用于 BitmapData 对象会忽略传递的矩形 - 如何正确应用着色器过滤器？

> ID：12182199
> 
> 赞同：6
> 
> 时间：2012-08-29T16:12:42.073
> 
> 标签：actionscript-3, shader

我有以下代码，仅用于测试，因为这是我想要解决的一种错误：

```
 _shader = new Shader(new TheShader() as ByteArray);
        _shader.data.width.value = [64.0];
        _shader.data.height.value = [64.0];
        _shaderFilter = new ShaderFilter(_shader);
        _sequence = new Vector.<BitmapData>();
        var smallBD:BitmapData;
        var i:int;
        _delta = new Point();
        var megabase:BitmapData = new TheBitmap().bitmapData;
        var _rect:Rectangle = new Rectangle(0, 0, 64, 64);
        for (i = 0; i < 64; i++) {
            smallBD = new BitmapData(64, 64, true, 0x00808080);
            //_rect.x = i;
            _rect.y = i;
            smallBD.applyFilter(megabase, _rect, _delta, _shaderFilter);
            _sequence.push(smallBD);
        } 
```

然后我循环遍历 _sequence 以查看更改矩形是否确实有效。如果 _shaderFilter 实际上是一个着色器过滤器，它什么也不做。使用任何内置 Flash 过滤器进行测试都可以按预期工作，但使用 ShaderFilter 时，它有时会像提供的矩形显然是 sourceBitmapData.rect 一样工作，无论源位图是什么，有时它的行为就像没有传递数据一样，边界是位于奇怪的位置 - 使用大小为 512x384 的位图，传递给着色器的区域的边缘显然位于 (256,192) 或位图的中心。到目前为止，我只能实现一种解决方法，即首先将所需区域 copyPixels()，然后将 applyFilter() 到位。有人可以证明这是一个错误而不是我做错了什么吗？

PS：我正在使用 FlashDevelop，项目目标是 Flash Player 10.3，我不知道 FP11 是否修复了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:41:09.383

好吧，很遗憾我不能告诉你如何解决这个问题，但我可以确认这不是你的错！

问题似乎是 Flash`sourceRect`在使用自定义着色器时完全忽略了。起初我认为它可能会将值传递给着色器中未记录的参数，但后来我注意到输出位图的每个像素都发生了变化，即使`sourceRect`它更小或`destPoint`非零也是如此。而且似乎没有`inCoord()`匹配的功能`outCoord()`，所以看起来这不是开发人员所期望的用途！

我可以提供一个建议；无需将 ROI 复制到新`BitmapData`对象，而是将`float2 offset`参数添加到着色器，并按此值移动所有像素查找。它将节省一些处理。

这是我用来确认行为的简化测试用例：

ShaderTest.as：

```
package {
    import flash.display.Sprite;
    import flash.display.Bitmap;
    import flash.display.BitmapData;
    import flash.display.Shader;
    import flash.geom.Point;
    import flash.geom.Rectangle;
    import flash.filters.ShaderFilter;

    final public class ShaderTest extends Sprite {
        [Embed(source="test.pbj",mimeType="application/octet-stream")]
        private static const sCopy : Class;

        final private function R( x, y, w, h ) : Rectangle {
            return new Rectangle( x, y, w, h );
        }
        final public function ShaderTest( ) {
            super( );
            var
            s  : Shader = new Shader( new sCopy( ) ),
            f  : ShaderFilter = new ShaderFilter( s ),
            d1 : BitmapData = new BitmapData( 256, 256, false, 0 ),
            d2 : BitmapData = new BitmapData( 128, 128, false ),
            b1 : Bitmap = new Bitmap( d1 ),
            b2 : Bitmap = new Bitmap( d2 ),
            w  : Rectangle = R( 16, 16, 64, 64 );
            b2.x = 274;
            addChild( b1 );
            addChild( b2 );

            for( var i : int = 0; i < 8; ++ i ) {
                for( var j : int = 0; j < 8; ++ j ) {
                    d1.fillRect( R( i * 32 + 1, j * 32 + 1, 30, 30 ), (((i + j) & 1) * 0x00FF00) | (i << 21) | (j << 5) );
                }
            }
            d2.applyFilter( d1, w, new Point( 10, 10 ), f );
            d1.fillRect( R( w.x, w.y, 1, w.height ), 0xFF0000 );
            d1.fillRect( R( w.x, w.y, w.width, 1 ), 0xFF0000 );
            d1.fillRect( R( w.x, w.y + w.height - 1, w.width, 1 ), 0xFF0000 );
            d1.fillRect( R( w.x + w.width - 1, w.y, 1, w.height ), 0xFF0000 );
        }
    }
} 
```

测试.pbk：

```
<languageVersion:1.0;>

kernel bugtest <namespace:"Me";vendor:"Me";version:1;>{
    input image4 src;
    output pixel4 dst;
    void evaluatePixel(){
        dst = sampleNearest(src,outCoord());
    }
} 
```

输出：

![输出截图](../Images/2f9bc50c832844878753c79486b9d95b.png)

（右侧的小方块使用着色器从大方块复制而来。红色框显示的`sourceRect`是`destPoint`(10,10)。尽管有这两种设置，但它实际上渲染了整个位图）

# c# - 如果我需要保留“包装”流，我应该处置 BinaryReader 吗？

> ID：12182202
> 
> 赞同：11
> 
> 时间：2012-08-29T16:13:00.403
> 
> 标签：c#, .net, stream, dispose

两个`BinaryReader` [构造函数](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.binaryreader%28v=vs.100%29)都需要一个流参数。如果我在完成 后需要保持底层流原样`BinaryReader`，我还应该调用它`Dispose()`吗？如果没有，是否有任何其他清理不再需要`BinaryReader`？

[我问是因为我在MSDN 页面`BinaryReader.Dispose()`](http://msdn.microsoft.com/en-us/library/dd383354%28v=vs.100%29)上找不到明确的答案。

**小补充**

在我的上下文中，我使用读取几个字节，然后将流的位置设置回初始化`BinaryReader`之前的位置。`BinaryReader`

另外，我正在使用.Net 4。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-29T16:34:55.860

如果您（或其他阅读这些内容以寻找答案的人）正在使用带有 .NET 4.5（或更高版本）的 VS 2012，您可以创建一个`BinaryReader`不会关闭流的。例如：

```
using(var reader = new BinaryReader(theStream, new UTF8Encoding(), true)
{
//...
} 
```

`new UTF8Encoding`如果您使用 BinaryReader(Stream) 构造函数，则为默认值，如果您不想要 UTF8Encoding，则可以使用其他内容。表示“是的`true`，让流保持打开状态”。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-29T16:15:10.377

不，`BinaryReader`如果您想保持流打开，可以不处理。

我可能会添加一条评论来解释正在发生的事情 - 而且我不确定是否*保证*只会从流中`BinaryReader`读取，只要你从`BinaryReader`......它可能已经读到更多例如缓冲区。显然，如果您随后在流上搜索，这不是问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-16T07:33:10.153

已经有一个公认的答案，但这让我觉得很脏:-)我认为我们可以做得更好：

1.  如果您使用的是 .NET 4.5，则应使用 BinaryReader 的 3-arg 构造函数。完毕。
2.  如果您使用的是 .NET 3.5/4.0，则需要不同的解决方案

Jon Skeet（接受的答案）建议永远不要丢弃 BinaryReader。好吧，这当然可行，但可能会引起混乱。

另一种解决方案可能是将 Stream 包装在 NonClosingStreamWrapper 中，然后再将其传递给 BinaryReader。BinaryReader 将在处理包装器时关闭它，但 NonClosingStreamWrapper 不会处理您的底层流。您仍然可以在 binaryStream 上使用 .Dispose （或者更好的是使用模式）。

非常讽刺的是，@JonSkeet 已经创建了一个 NonClosingStreamWrapper 来做到这一点。这是他的[miscutil library](http://www.yoda.arachsys.com/csharp/miscutil/)的一部分。（但请注意许可证）

```
using(var reader = new BinaryReader(new NonClosingStreamWrapper(myStream)))
{
//...
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T16:35:05.657

如果是我，我会处理 BinaryReader，只是为了整洁......但我也会确保我`BinaryReader`用[这个构造函数重载](http://msdn.microsoft.com/en-us/library/gg712804.aspx)创建了：

```
public BinaryReader(
  Stream   input,
  Encoding encoding,
  bool     leaveOpen
  ) 
```

其中将`leaveOpen`参数指定为`true`指示读取器保持底层流打开。

走这条路，你明确了事物的范围和所有权。这样可以减少混淆和误解的空间。

# visual-studio-2010 - 可执行文件未重建，但目标文件已重新编译

> ID：12182203
> 
> 赞同：3
> 
> 时间：2012-08-29T16:13:02.860
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012

使用 Visual Studio 2012 构建一个基本的 C++ 项目。当我对源文件进行更改时：

*   编译相应的目标文件
*   编译器的 .tlog 文件已更新
*   PDB 文件已更新
*   但是，链接器的 .tlog 文件没有更改
*   链接器声明`All outputs are up-to-date.`并且不构建新的可执行文件。

构建可执行文件的唯一方法是删除它。跟踪系统似乎有问题，我想知道是否有人可以对这个问题有所了解。

这是我更改两个文件、完整路径和省略其他一些内容后的 msbuild 输出（此输出适用于 VS2010 工具集，但 2012 的行为相同）：

```
 1>Target "ClCompile" in file "C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Platforms\Win32\Microsoft.Cpp.Win32.targets"...
  Using "CL" task from assembly "Microsoft.Build.CppTasks.Win32, Version=4.0.0.0...
  Task "CL"
    Read Tracking Logs:
     cl.read.1.tlog
     CL.2520.read.1.tlog
     ...
    Outputs for ....
     XXX.OBJ
     YYY.OBJ
     ...
    xxx.cpp will be compiled as xxx.cpp was modified...
    yyy.cpp will be compiled as yyy.cpp was modified...
    Write Tracking Logs:
     cl.write.1.tlog
     CL.2520.write.1.tlog
     ...
    C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe ....
    Tracking command:
    C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\Tracker.exe ....
    xxx.cpp
    yyy.cpp
  Done executing task "CL".
1>Done building target "ClCompile" in project "xxx.vcxproj". 
```

到目前为止，一切都很好。现在链接器启动（好吧，它没有）：

```
1>Target "Link" in file "C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Platforms\Win32\Microsoft.Cpp.Win32.targets"....
  Using "Link" task from assembly "Microsoft.Build.CppTasks.Win32, Version=4.0.0.0...
  Task "Link"
    Using cached output dependency table built from:
    link.write.1.tlog
    Using cached input dependency table built from:
     ink.read.1.tlog
    Outputs for ....
     MY.EXE
     MY.PDB
    All outputs are up-to-date.
  Done executing task "Link".
  Task "Message"
    xxx.vcxproj -> my.exe
  Done executing task "Message".
1>Done building target "Link" in project "xxx.vcxproj". 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T12:42:16.197

在逐一检查属性表中的所有选项后，似乎这个问题的唯一来源是我们将中间目录设置为另一个驱动器上的目录。我们总是在 %TEMP% 中进行源代码外构建，并且大多数时候项目驻留在另一个驱动器上。

[在此处](https://connect.microsoft.com/VisualStudio/feedback/details/760370/linker-does-not-link-if-intermediate-directory-with-changed-object-files-is-on-another-drive)提交了错误报告，其中包括重现问题的简单步骤。希望这很快得到解决。当前的解决方案是将 IntDir 设置为与项目相同的驱动器上的目录。

**更新**

针对此问题提交的错误报告已按“设计”关闭：中间目录似乎不应该是 %TEMP% 或 %TMP% 或它们的任何子目录。令人不安，但至少我现在知道出了什么问题。

# drupal-6 - 将网络表单提交结果作为 Drupal 6 中的链接？

> ID：12182204
> 
> 赞同：4
> 
> 时间：2012-08-29T16:13:05.673
> 
> 标签：drupal-6, drupal-modules, drupal-webform

我是一个新手，在模块熟悉和模块配置方面`Drupal 6`我仍然*在黑暗中行走。*最近，我`Webform`为我的网站安装了该模块，以便让用户提交请求。在 my`Webform`中，有一个字段列出了我网站上`Select View`特定内容的所有内容。我能够将 a用作我的普通 webform 选择组件的数据源，这就是为什么我有一个自定义字段，它是我的. 现在，成功提交表单后，我去找到提交时保存的数据。我想要的是，在我的页面上，`Content Type``Drupal``View``Webform View Reference Component``<select>``Webform``Results``Results``selected`列表中的选项（基本上是视图）将链接到它们各自的视图。这就是它的样子，![在此处输入图像描述](../Images/885871a8c9d3f8210a211977a07db656.png) 我真的迷路了。有人可以帮助我如何使这成为可能吗？干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T11:30:21.263

安装此模块[http://drupal.org/project/webform_report](http://drupal.org/project/webform_report)它将以表格格式显示，您也可以自定义报告，它还将创建单独的内容类型。

以下是网络表单报告的屏幕截图，您还可以从报告本身查看、编辑和删除。

![在此处输入图像描述](../Images/a86dafce480a82050e1c8b1744d7d110.png)

# wcf - 通过 WCF 简化 IOC 容器的使用

> ID：12182211
> 
> 赞同：2
> 
> 时间：2012-08-29T16:13:25.447
> 
> 标签：wcf, iis, dependency-injection, inversion-of-control, ioc-container

在[一篇](http://www.i-avington.com/Posts/Post/usng-unity-with-a-wcf-service)又[一篇](https://stackoverflow.com/questions/7355501/using-unity-dependency-injection-with-wcf-services)[文章中](http://weblogs.asp.net/fabio/archive/2009/03/24/inversion-of-control-with-wcf-and-unity.aspx)，任何关于在IIS 中使用 IOC 容器（Unity、Windsor 等）的讨论都涉及到自定义 ServiceHostFactory 和自定义 ServiceHost 的创建。

我能看到的唯一原因是，可以将具有 IInstanceProvider 相关负载的自定义服务行为应用于所有服务。所以我试图理解为什么整个事件没有通过[匿名服务配置](http://social.msdn.microsoft.com/Forums/is/wcf/thread/c6678f2e-0234-4d47-86d9-3efdc2e6c682)来简化。这样的配置将允许将自定义行为应用于所有服务，而无需使用自定义 ServiceHostFactory 和自定义服务主机。

也就是说，我可以想象自定义服务主机是必要的唯一原因是自定义 IInstanceProvider 是否与每个 WCF 实例或上下文实例一起回收。当然，我希望每次启动 IIS ServiceHost 时只建立一次 IOC 容器绑定，而不是重复或不定期地建立。

如果我的自定义 IInstanceProvider 确实偶尔被回收，那么我可以将我的 IOC 容器放入自定义服务主机中 - 以确保它尽可能长时间地存在。

但同样，如果我的自定义 IInstanceProvider 将与内置服务主机一样长，那么为什么不跳过自定义服务主机工厂和自定义服务主机呢？

事实上，更进一步，如果我将 IOC Container 放入自定义 IInstanceProvider 的静态成员中，那么 IInstanceProvider 是否被不定期回收也没关系。它来了一个完整的循环：为什么我需要或想要自定义 ServiceHostFactory 和自定义 ServiceHost 来使用带有 WCF 的 IOC 容器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T06:28:01.163

出色地。这是因为大多数 IoC/WCF 集成（如[我](https://github.com/jgauffin/griffin.container)的）不仅仅是创建您的服务（及其依赖项）。

**自定义生命周期/处置**

当请求结束时，一切都应该得到正确的清理。您的服务和您的 IoC 类使用不同的生命周期。

仅在`InstanceProvider`.

**IContractBehavior / IServiceBehavior**

您可以在容器中注册行为并[自动](https://github.com/jgauffin/Griffin.Container/blob/master/Source/Griffin.Container.Wcf/ServiceLocatorServiceHost.cs)将它们添加到您的 WCF 服务中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T13:12:19.693

就个人而言，我喜欢使用不需要任何`ServiceHostFactory`、`ServiceHost`、`ServiceBehavior`和`InstanceProvider`组合的设计，并且不必在 .svc 文件中注册工厂。我喜欢我的 WCF 服务，它只是消息传递架构之上的一个非常薄的层，这使您免于使用这个 WCF 集成的东西。[您可以在此处](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=95)阅读有关此类设计的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T16:45:45.877

有趣的问题！我能想到这样做的唯一原因是您不希望将永远不会更改的项目（即 WCF 服务使用的 IoC 容器）弄乱您的 app.config。我尝试将 app.config 的使用限制为最终用户/开发人员可能想要更改而不重新编译的内容（在大多数情况下，不会太多）。这使其更具可读性，并且通常更容易以编程方式指定配置，因为与配置文件相比，程序代码中对智能感知和编译时检查有更好的支持。

但是，此论点可能不适用于您链接到的第一篇文章，因为他们实际上是通过 app.config 设置其 IoC 容器。所以在这种情况下，这可能是一个双重标准。我从来没有真正理解为什么人们想通过外部配置文件来设置他们的所有依赖项。在大多数情况下，在 app.config 中存储静态配置对我来说似乎有点过头了。

# php - 如何将输入字段动态添加到表单

> ID：12182213
> 
> 赞同：1
> 
> 时间：2012-08-29T16:13:27.517
> 
> 标签：php, javascript, jquery, html

我目前正在使用资产管理系统。该公司分布在不同的地点。

如果这些项目不使用，该系统可以将资产项目重新返回到存储。

我想要做的是退回项目有很多项目。所以我有这样的输入字段：

```
<td><input type="text" name="asset_id[]"/></td>
<td><input type="text" name="batch_code[]"/></td>
<td><input type="text" name="description[]"/></td>
<td><input type="text" name="status[]"/></td>
// current condition of the item 
```

我不能一次又一次地使用这些字段，我不知道每种特定情况需要多少个字段。

如果我可以让用户在需要时添加输入字段，我该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T00:26:29.707

在这里你可以看到类似 [http://jsfiddle.net/damian_silvera/ATzne/](http://jsfiddle.net/damian_silvera/ATzne/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:30:26.273

适当地使用 JS/jQuery：

HTML：

```
 <a href="#" id="plus_row">Add Row</a> 
```

jQuery

```
$(document).ready(function(){
   $("a#plus_row").click(function(){
     $("table#form_table").append($("table#form_table").find('tr').get(0));
   });
}); 
```

# jquery-plugins - 带有 jQ uery 迷你图的 Angular.js

> ID：12182214
> 
> 赞同：1
> 
> 时间：2012-08-29T16:13:37.257
> 
> 标签：jquery-plugins, angularjs, sparklines

新手问题：我正在尝试新的 Angular.js 框架，但似乎无法让我的迷你图显示在我的部分上。我想要绘制的数组确实以文本显示。

字符串何时加载到页面上以及何时调用 Sparklines 似乎是一个问题。我在`<head>`.

如何让这些在 ng-repeat 中显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:41:23.213

查看 AngularUI 项目中的 JQuery 包装器：

[https://github.com/angular-ui/angular-ui/blob/master/modules/directives/jq/jq.js](https://github.com/angular-ui/angular-ui/blob/master/modules/directives/jq/jq.js)

问题在于插件会更改 DOM 而不会提醒 AngularJS 发生更改。

# c# - 我没有从存储过程中得到正确的结果

> ID：12182215
> 
> 赞同：1
> 
> 时间：2012-08-29T16:13:38.287
> 
> 标签：c#, linq, stored-procedures

我有这个存储过程，用于从 3 个表中获取 Amount 的总和。

问题是我正在使用 Linq to Sql，当我将此过程放在我的 .dbml 文件中时，它有一个 ISingleResult(GetSurplusDataForConsolidationReportResult) 并且我无法得到我想要的总和。

我收到一个空的 ReceivablesSurplus 清单。

有任何想法吗？

```
ALTER PROCEDURE [dbo].[GetSurplusDataForConsolidationReport]
    @ID INT
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

          SELECT    SUM(RB.[Amount])
    FROM    [DBO].[ReceivablesSurplus] RB
    WHERE   RB.[Cycle] = @ID

    SELECT  SUM(DL.[Amount])
    FROM    [DBO].[DilutionsSurplus] DL
    WHERE   DL.[Cycle] = @ID

    SELECT  SUM(AC.[Amount])
    FROM    [DBO].[AccountablesSurplus] AC
    WHERE   AC.[Cycle] = @ID
END 
```

这是我的 .dbml 代码

```
[global::System.Data.Linq.Mapping.FunctionAttribute(Name="dbo.GetSurplusDataForConsolidationReport")]
        public ISingleResult<GetSurplusDataForConsolidationReportResult> GetSurplusDataForConsolidationReport([global::System.Data.Linq.Mapping.ParameterAttribute(Name="ID", DbType="Int")] System.Nullable<int> iD)
        {
            IExecuteResult result = this.ExecuteMethodCall(this, ((MethodInfo)(MethodInfo.GetCurrentMethod())), iD);
            return ((ISingleResult<GetSurplusDataForConsolidationReportResult>)(result.ReturnValue));
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:50:29.350

您应该能够`.ToList()`将值（作为`ISingleResult`implements `IEnumerable`）用于调用代码行，然后您可以获取从 sproc 返回的单独结果集。

例如

```
var results = dataContext.GetSurplusDataForConsolidationReport(123).ToList<int>(); // list of sums 
```

# visual-studio - 最早支持 64 位编译的 Visual Studio 版本是哪个？

> ID：12182220
> 
> 赞同：0
> 
> 时间：2012-08-29T16:13:56.237
> 
> 标签：visual-studio

是`Visual Studio 2005`吗？

我问的原因是因为我继承了一些旧代码（用 VS 6 编写），现在需要编译才能在 64 位系统上运行。不幸的是，代码无法使用 VS 2010 编译，所以我尝试使用最旧的版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:25:18.193

VS2002 (v7.0) 是最早的，但我推荐 VS2003 (v7.1)。在 Win 7 上安装任何一个都可能会遇到问题。

# javascript - 使用原型 JS 浮动小部件/横幅

> ID：12182221
> 
> 赞同：1
> 
> 时间：2012-08-29T16:14:03.273
> 
> 标签：javascript, widget, prototypejs, banner, floating

我使用 jQuery 的原件创建了一个脚本：http: [//terkel.jp/demo/jquery-floating-widget-plugin.html](http://terkel.jp/demo/jquery-floating-widget-plugin.html)

但是当键入原型 JS 时，它无法正常工作。它严格来说不能正确计算上下高度。

有什么想法吗？我附上了我的代码和链接以查看活动脚本。

在线问题：http: [//1.delnik20.cz/](http://1.delnik20.cz/)

原型：

```
document.observe('dom:loaded', function() {
    Element.addMethods({
        floatingWidget: function(el, classes) {
            var $this       = $(el),
            $parent         = $this.getOffsetParent(),
            $window         = $(window),
            top             = $this.positionedOffset().top - parseFloat($this.getStyle('marginTop').replace(/auto/, 0)),
            bottom          = $parent.positionedOffset().top + $parent.getHeight() - $this.getHeight();

            if ($parent.getHeight() > $this.getHeight()) {
                Event.observe($window, 'scroll', function (e) {
                    var y = document.viewport.getScrollOffsets().top;
                    if (y > top) {
                        $this.addClassName(classes.floatingClass);
                        if (y > bottom) {
                            $this.removeClassName(classes.floatingClass).addClassName(classes.pinnedBottomClass);
                        } else {
                            $this.removeClassName(classes.pinnedBottomClass);
                        }
                    } else {
                        $this.removeClassName(classes.floatingClass);
                    }
                });
            }
            return el;
        }
    });

    $('floating-widget').floatingWidget({
        floatingClass: 'floating',
        pinnedBottomClass: 'pinned-bottom'
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T07:29:55.330

Prototypejs 相当于 jQuery 的`offset()`is `cumulativeOffset()`，相当于`outerHeight()`is `measure('margin-box-height')`（可以使用 Element.Layout 对象进行优化）。因此，您的代码应如下所示：

```
floatingWidget: function(el, classes) {
    var $this        = $(el),
        $parent      = $this.getOffsetParent(),
        $window      = $(window),
        top          = $this.cumulativeOffset().top - $this.measure('margin-top'),
        bottom       = $parent.cumulativeOffset().top + $parent.getHeight() - $this.measure('margin-box-height');

if ($parent.getHeight() > $this.measure('margin-box-height')) {
... 
```

# php - 它在数据库中找不到正确的电子邮件地址

> ID：12182225
> 
> 赞同：-4
> 
> 时间：2012-08-29T16:14:17.297
> 
> 标签：php, database, mysqli

我想检查一个有效的电子邮件地址，然后查看该电子邮件地址是否在数据库中。目前，有效电子邮件地址的验证工作正常。但是，如果我输入数据库中的电子邮件地址，例如“nickfrosty@yahoo.com”，`You have entered in the Correct Email Address`它不会回显消息，而是回显完全相反的消息并回显`You entered in the Wrong Email Address`。所以这让我觉得即使我确定电子邮件地址在数据库中，它也无法在数据库中找到电子邮件地址。

所以我的问题是，为什么它不能在数据库中找到电子邮件地址，从而回显我在错误的电子邮件地址中输入的消息？

下面是代码（mysqli/php）：

```
if ( (strlen($email) >= 7) && (strstr($email, "@")) && (strstr($email, ".")) ){

echo "You have entered in the Correct Email Address";

}
else{
echo "You entered in the Wrong Email Address";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:18:19.277

```
$query = "SELECT TeacherUsername, TeacherEmail FROM Teacher WHERE TeacherUsername = ?"; 
```

意味着您检查输入而`TeacherUsername`不是`TeacherEmail`. 你可能想试试

```
$query = "SELECT TeacherUsername, TeacherEmail FROM Teacher WHERE TeacherEmail = ?"; 
```

# java - SQL Server + Spring JAVA 应用程序的奇怪性能问题

> ID：12182228
> 
> 赞同：2
> 
> 时间：2012-08-29T16:14:26.337
> 
> 标签：java, sql-server-2008, jdbc, prepared-statement, spring-jdbc

从基于 Spring 的应用程序访问 SQL Server 数据时，我遇到了一个奇怪的性能问题。在我当前的设置中，Spring java 应用程序运行在单独的机器上，从远程 SQL Server DB 访问数据。我在 Spring 中使用 NamedParameterTemplate，我相信它使用 Prepared Statement 来执行查询。由于某种原因，某些查询需要很长时间才能完成（大约 2 分钟）。JAVA 应用程序在运行 64 位版本 Java v1.6 的 64 位机器上运行，SQL Server 是 MS SQL Server 2008 R2。

奇怪的是，如果我从运行 Windows XP 32 位的笔记本电脑上运行相同的 Java 应用程序，运行相同版本的 Java v1.6，查询时间不到一秒钟，访问完全相同的远程数据库服务器（事实上，我已连接通过VPN）

这表明问题不在于 Spring 框架，而可能在于 SQL JDBC 驱动程序。我正在使用 Microsoft JDBC Driver 4.0 for SQL Server (sqljdbc.jar)

我完全一无所知，因为可能出了什么问题，并且不确定从哪里开始我的调试过程。我了解，我的问题中没有太多信息，所以如果您需要任何具体细节，请告诉我。

感谢您的任何帮助/建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-01T11:04:57.147

我认为这可能是由于您的 java 版本和 jdbc 驱动程序的组合未能与服务器握手连接。请参阅[Driver.getConnection hangs using SQLServer driver and Java 1.6.0_29](https://stackoverflow.com/questions/7841411/driver-getconnection-hangs-using-sqlserver-driver-and-java-1-6-0-29)和[http://blogs.msdn.com/b/jdbcteam/archive/2012/01/19/patch-available-for-sql-server-and-java- 6-update-30.aspx](http://blogs.msdn.com/b/jdbcteam/archive/2012/01/19/patch-available-for-sql-server-and-java-6-update-30.aspx)

如果是这样，切换到 1.6.0 升级 30 或更高版本并应用[kb 2653857](http://support.microsoft.com/kb/2653857/en-us)应该可以修复它。

# android - 当 forceLayout() 不起作用时，如何强制 requestLayout()？

> ID：12182231
> 
> 赞同：3
> 
> 时间：2012-08-29T16:14:57.750
> 
> 标签：android, android-layout, android-mediaplayer

我正在尝试编写视频播放器，它可以很好地播放视频，但我无法调整 SurfaceView 的大小。准备好 MediaPlayer 后，我设置了我想要的大小并调用 requestLayout 或 forceLayout，但没有附加任何内容。我的 LogCat 说：

```
08-29 17:42:38.915: I/SEC_Overlay(2707): overlay_setParameter param[4]=0
08-29 17:42:38.915: D/SEC_Overlay(2707): dst width, height have changed [w= 480, h= 800] -> [w=480, h= 800]
08-29 17:42:38.915: I/SEC_Overlay(2707): Nothing to do! 
```

它显然尝试调整大小，但发现没有任何变化，也没有调用 onMesured 或 onLayout

我的代码：

```
public class VideoSurface extends ViewGroup {
private final String TAG = "VideoSurface";
protected  int mWidth = 0 ;
protected  int mHeight = 0 ;
protected SurfaceView mSurfaceView;
protected SurfaceHolder mHolder;

public VideoSurface(Context context) {
    super(context);
    init(context);
}
public VideoSurface(Context context, AttributeSet attrs) {
    super(context,attrs);
    init(context);
}
public VideoSurface(Context context, AttributeSet attrs, int defStyle) {
    super(context,attrs,defStyle);
    init(context);
}

private void init(Context context){
    // Install a SurfaceHolder.Callback so we get notified when the
    // underlying surface is created and destroyed.
    mSurfaceView = new SurfaceView(context);
    this.addView(mSurfaceView);

    // Install a SurfaceHolder.Callback so we get notified when the
    // underlying surface is created and destroyed.
    mHolder=mSurfaceView.getHolder() ;
    mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
}

public Surface getSurface(){return mHolder.getSurface();}
public void setSize(Size size){
    mWidth = size.width ;
    mHeight = size.height ;
}
public void setSize(int w,int h){
    mWidth = w ;
    mHeight = h ;
}

protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    // We purposely disregard child measurements because act as a
    // wrapper to a SurfaceView that centers the camera preview instead
    // of stretching it.
    final int width = resolveSize(getSuggestedMinimumWidth(), widthMeasureSpec);
    final int height = resolveSize(getSuggestedMinimumHeight(), heightMeasureSpec);
    setMeasuredDimension(width, height);
    Log.d(TAG,"onMeasure:"+width+"x"+height);
}

@Override
protected void onLayout(boolean changed, int l, int t, int r, int b) {
    if (changed && getChildCount() > 0) {
        final View child = getChildAt(0);

        final int width = r - l;
        final int height = b - t;

        int previewWidth = width;
        int previewHeight = height;
        if ((mWidth != 0)&&(mHeight != 0)) {
            previewWidth = mWidth;
            previewHeight = mHeight;
        }
        Log.d(TAG,"onLayout L1: Desired:"+mWidth+"x"+mHeight+" Actual:"+previewWidth+"x"+previewHeight);

        // Center the child SurfaceView within the parent.
        if (width * previewHeight > height * previewWidth) {
            final int scaledChildWidth = previewWidth * height / previewHeight;
            child.layout((width - scaledChildWidth) / 2, 0,
                    (width + scaledChildWidth) / 2, height);
        } else {
            final int scaledChildHeight = previewHeight * width / previewWidth;
            child.layout(0, (height - scaledChildHeight) / 2,
                    width, (height + scaledChildHeight) / 2);
        }
    }
    Log.d(TAG,"onLayout L2:"+l+", "+t+", "+r+", "+b);
} 
```

和继承的类：

```
public class PlayerView extends VideoSurface implements SurfaceHolder.Callback {
private static final String TAG = "PlayerView";
private MediaPlayer mPlayer = new MediaPlayer() ;
private String mVideoPath = "" ;

public PlayerView(Context context) {
    super(context);
    init();
}
public PlayerView(Context context, AttributeSet attrs) {
    super(context,attrs);
    init();
}
public PlayerView(Context context, AttributeSet attrs, int defStyle) {
    super(context,attrs,defStyle);
    init();
}

private void init(){
    mHolder.addCallback(this);

    mPlayer.setOnVideoSizeChangedListener(new MediaPlayer.OnVideoSizeChangedListener(){
        @Override
        public void onVideoSizeChanged(MediaPlayer mp, int width, int height) {
            //TODO
            mHolder.setFixedSize(width,height);
            setSize(width,height) ;
            setLayoutParams(new LayoutParams(width, height));
            requestLayout() ;
            forceLayout();
            Log.d(TAG,"Size:"+width+"x"+height);
        }
    });
    mPlayer.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {
        @Override
        public void onPrepared(MediaPlayer mp) {
            // TODO 
            setSize(mPlayer.getVideoWidth(), mPlayer.getVideoHeight());
            mPlayer.start();
            Log.d(TAG,"Started");
        }
    });

    //TODO DEBUG
    mVideoPath = Environment.getExternalStorageDirectory().getPath()+"/external_sd/USB Storage/test.mp4" ;
}

private void prepareVideo(String path){
    stop() ;
    try {
        mPlayer.setDataSource(path) ;
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    //TODO
    //mPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);

    mPlayer.prepareAsync() ;
}

public void start(String path) {
    mVideoPath = path ;
    if (!mHolder.isCreating()){
        prepareVideo(path) ;
    }
}

public void stop() {
    if (mPlayer.isPlaying()) {
        mPlayer.stop();
    }
    mPlayer.reset();
}

public void onStop(){
    stop() ;
    mPlayer.release();
}

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    mPlayer.setDisplay(mHolder);
    if(!mVideoPath.isEmpty()){
        prepareVideo(mVideoPath) ;
    }
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
} 
```

}

即使 forceLayout() 不起作用，我如何强制 requestLayout() ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-12T10:14:22.637

你可以`requestLayout();`用来强制你的布局重绘，所以你需要调用

`yourLayout.requestLayout();` 在你的`init()`.

# mysql - 根据新要求修改架构

> ID：12182232
> 
> 赞同：0
> 
> 时间：2012-08-29T16:15:08.983
> 
> 标签：mysql, sql, database-design

我有一个用于管理商店系统的产品/项目的数据库。表结构看起来像

```
Categories
----------------------------
id
name
description
active
created
modified

Products
----------------------------
id
name
description
active
created
modified
id_category 
```

现在我有兴趣将这个数据库用于多个商店。修改架构的最佳方法是什么。通过`id_shop`在每个表中添加一个？或者，还有更好的方法

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:56:55.687

I think that a basic compromise is the following schema

![enter image description here](../Images/4a52b2b23cf7a36598701c5664f824f0.png)

In this case you can ad more categories to a single product

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:25:14.733

```
Shops
----------
shop_id
ShopName
AhopAddr
...

Categories
----------------------------
id
name
description
active
created
modified
shop_id

Products
----------------------------
id
name
description
active
created
modified
id_category
shop_id 
```

# iphone - .m 和 .h 类未更新

> ID：12182234
> 
> 赞同：0
> 
> 时间：2012-08-29T16:15:13.480
> 
> 标签：iphone, ios, xcode

问这个有点尴尬。但我似乎找不到解决方案，因为我不知道如何/在谷歌中搜索什么。它是这样的。在我的项目文件夹中，每当我点击我`Project.xcodeproj`编辑的最新代码时，我的意思是正确的，或者我的意思是在`XCODE`它打开时更新。

**问题：**

例如，当我尝试从最新的压缩项​​目中解压缩我的最新项目时（出于备份目的），当我打开文件夹（备份）时，然后单击`View1Controller.m`其中的代码并没有按照它们在`XCODE`if中的方式更新我点击那个`xcodeproj`部分。它在`XCODE`.

希望有人可以帮助我，并为我的问题解释一些好的方法/解决方案。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:32:03.887

我假设您正在压缩旧项目并保存它们以避免使用 git - 我不是 git 爱好者，但可以肯定它是一个更好的解决方案。

尝试使用 Xcode 同时查看旧项目和新项目的问题是（恕我直言）Xcode 似乎对项目中的文件感到困惑 - 如果您打开一个新文件和一个旧文件。

*   在 TextEdit 中打开旧文件，它应该正是您认为的那样

*   在 Xcode 中，打开当前项目，查看一些文件。关闭项目，然后打开旧项目。查看文件，它们应该是正确的[如果不是，请在项目打开之间关闭并重新打开 Xcode，但我怀疑这没有必要]

*   如果您确实需要在查看新项目时查看旧项目中的文件，则在 Finder 中重命名文件 - 在文件上添加“O”前缀，然后在 Xcode 中打开该文件（使用修改后的名称）

我在这个问题上的经验可以追溯到旧版本，但我确实强烈记得过去曾遇到过此类问题。

# jquery - jQuery捕获直接子类

> ID：12182236
> 
> 赞同：0
> 
> 时间：2012-08-29T16:15:18.170
> 
> 标签：jquery, jquery-selectors

我正在尝试将单击事件（到 slideToggle）连接到由 Raphael 绘制的下拉标题。我需要的是当用户点击灰色框时，内容会下拉 jQuery `slideToggle`。

这是一个示例渲染下拉。![渲染下拉](../Images/2801cc7b966336ce5886060442dc99ab.png)

我按班级抢

```
var title = $('.title'); //title div
var title_content = $('.title_content'); //title content div
var holder = $('.holder'); //holder div
var content = $('.content'); //content div 
```

绘制和文本换行（完美运行），但是当我到达连接点击事件的部分时，我无法让它们正确连接。如果我的想法是正确的，这将为每个持有的 div 在标题上创建一个单击事件，以将内容从下方滑出，或者至少这就是我想要的。

```
$(holder).each(function() {
                    $(this).closest('.title').click(function() {
                        $(this).closest('.content').slideToggle('fast');
                    });

                }); 
```

这是HTML的结构

```
<div class="holder">
        <div class="title">
            <div class="title_content" style="display: none;">
                Email Questions:
            </div>
        </div>
        <div class="content" style="display: none;">
            <p class="faqtitle">
                What type of email?</p>
            <div class="faqanswer">
                <p>
                    access the site.</p>
            </div>
            <p class="faqtitle">
                receive the email?</p>
            <div class="faqanswer">
                <p>
                    1 business day.</p>
            </div>
            <p class="faqtitle">
                email?</p>
            <div class="faqanswer">
                <p>
                    one-time email.</p>
            </div>
        </div>
    </div> 
```

另外作为旁注，我可以单击标题以使用以下方式打开所有切换

```
 title.click(function() {
                content.slideToggle('fast');
            }); 
```

## -------------------------------------------------- -----

答案是

```
$(title).each(function() {
      $(this).click(function() {
             $(this).next().slideToggle('fast'); 
      });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:20:57.940

你可以通过这种方式实现

```
$('.title').click(function(){function(){
   $(this).next().slideToggle('fast');
}}); 
```

并扩展每个

```
$('.title').each(function(){
   $(this).next().slideToggle('fast');
}); 
```

# c# - 在 .Net 中获取和读取非托管 C++ 指针

> ID：12182238
> 
> 赞同：0
> 
> 时间：2012-08-29T16:15:26.080
> 
> 标签：c#, c++, marshalling

我在从 C# 中的 P/Invoke 的 C++ API 获取正确数据时遇到问题。C++ 函数设置为采用一个指针来存储请求的数据，以及大小和要检索的确切参数。我的设置显然有问题，我正在寻找建议。谢谢！

C++ 原型：

```
DECL_FOOAPIDLL DWORD WINAPI FOO_GetVal(
VOID *Val,  //pointer to memory where the data will be stored by the function
DWORD Len,  //length of Val in bytes
DWORD Id    //identification number of the parameter
); 
```

C# P/Invoke 签名：

```
[DllImport(FOO_API, CharSet = CharSet.Auto)]
static public extern uint FOO_GetVal(IntPtr val, uint len, uint id); 
```

我的 C# 代码以获取有关设置的信息：

```
IntPtr Ptr = Marshal.AllocHGlobal(Marshal.SizeOf(typeof(IntPtr)));
uint hr = FOOWrapper.FOO_GetVal(Ptr, (uint)Marshal.SizeOf(Ptr), FOOWrapper.CMD_RUNNING);
int result = Marshal.ReadInt32(Ptr);
Marshal.FreeHGlobal(Ptr); 
```

所以最大的问题是我是否通过 Marshal.ReadInt32() 正确读取返回的指针？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:54:23.587

pinvoke 声明没有任何问题。您使用它的方式不正确，您正在为 IntPtr 保留空间但正在读取 int。正确的代码应该是：

```
uint len = (uint)Marshal.SizeOf(typeof(int));
IntPtr ptr = Marshal.AllocHGlobal(len);
uint hr = FOOWrapper.FOO_GetVal(ptr, len, FOOWrapper.CMD_RUNNING);
if (hr != 0) throw new COMException("FOO_GetVal failed", hr);
int result = Marshal.ReadInt32(ptr);
Marshal.FreeHGlobal(ptr); 
```

添加很重要，您当然不想忽略错误返回码。如果它实际上是一个错误代码，那么您对“hr”的使用表明它确实如此，但声明表明它不是。如果是实际数据的大小，则将其更改为：

```
uint actual = FOOWrapper.FOO_GetVal(ptr, len, FOOWrapper.CMD_RUNNING);
if (actual != len) throw new Exception("Improper data size"); 
```

这进一步假设您要求的参数实际上是一个 int。不可能说，但“CMD_RUNNING”听起来更像是一个布尔值，在 C++ 中是一个字节。

只需调试它以找出问题可能是什么。在“项目+属性”的“调试”选项卡中勾选“启用非托管代码调试”复选框。并在本机代码中的 FOO_GetVal() 函数上设置断点。

# 3d - 从静止点到任意点的 3D trig 转换

> ID：12182239
> 
> 赞同：2
> 
> 时间：2012-08-29T16:15:26.990
> 
> 标签：3d, rotation, translation, coordinates, trigonometry

我试图做的是建立一个相对坐标系。它所做的是获取点 A 的 XYZ 坐标。然后它应该将该位置平移到点 B 上以获得点 C 的位置，点 B 可以在所有三个轴上旋转和平移，但点 A 仅平移，不平移旋转。

基本上发生的事情是你有2个矩形，一个左下角在原点，一个左下角是B点。如果第一个矩形的**右上角**是A点，那么在第二个矩形的**右上角**是 C 点，无论第二个矩形如何旋转或平移，C 点始终位于第二个矩形的右上角。但是，如果 A 点移动到**右下角**，那么 C 点将始终位于第二个矩形的**右下角**。

我曾多次尝试评估正确的表达方式，而我想出的结果我认为很接近。我有一些变化：

X': Xcos(pitch) - Zcos(pitch) + Xcos(yaw) + Ysin(yaw) + X.pointB

Y': Ycos(yaw) + Xsin(yaw) + Ycos(roll) + Zsin(roll) + Y.pointB

Z': Ysin(roll) + Zcos(roll) + Xsin(pitch) + Zcos(pitch) + Z.pointB

其中方程中的 XYZ 是点 A 的坐标，俯仰角、偏航角和滚动角是第二个矩形的角度（以度为单位）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T18:10:20.037

一起表示旋转和平移的常用方法是使用[齐次坐标向量](http://en.wikipedia.org/wiki/Homogeneous_coordinates)和 4x4[变换矩阵](http://en.wikipedia.org/wiki/Transformation_matrix)。将向量乘以矩阵同时进行旋转和平移；并且将两个矩阵相乘会为您提供一个新矩阵，该矩阵*按顺序*执行这两个操作，这就是您想要解决的问题。这是基本的计算机图形数学（但它对几何和物理也很有用......）。

以这种方式表示向量和矩阵可能看起来多余甚至浪费，但它使数学和编程更简单。一旦你理解了数学是如何工作的，并且有了工作代码，你就可以根据需要返回并优化掉冗余数据；但是，您可能会发现这样做不值得。

* * *

您的问题中的公式不起作用 - 您需要确定要应用偏航、俯仰和滚动的顺序，生成适当的 X-、Y- 和 Z-[旋转矩阵](http://en.wikipedia.org/wiki/Rotation_matrix)，然后按该顺序将它们相乘（该链接为您提供了单个旋转矩阵以及组合旋转矩阵的示例）。

[平移矩阵](http://en.wikipedia.org/wiki/Translation_%28geometry%29)比计算旋转矩阵简单得多。将平移矩阵相乘基本上只是将平移向量相加，但是当旋转出现在图片中时，您会看到系统的优势：平移和旋转的*顺序*很重要，并且矩阵可以很容易地每次都正确处理。

* * *

最后，要实际解决您的问题：

*   计算固定平台上角色的组合旋转/平移矩阵。（理想情况下，您应该使用此矩阵来绘制原始字符）
*   计算“投影”平台的组合旋转/平移矩阵（也可用于绘制投影平台）
*   将两个矩阵相乘以确定“投影”字符的正确矩阵

请注意，唯一需要的三角函数是采用原始滚动/俯仰/偏航角的`sin()`和。`cos()`

# maven - browser-mob 代理 - 执行 maven 打包的 jar 时出现 java.lang.SecurityException

> ID：12182240
> 
> 赞同：0
> 
> 时间：2012-08-29T16:15:27.423
> 
> 标签：maven, maven-2, proxy

我在我的 Web 应用程序中使用 browser-mob 代理来模拟代理服务器。执行 mvn clean 包后，当我执行 jar 时，出现以下错误：

```
Exception in thread "main" java.lang.SecurityException: no manifiest section for signature file entry org/bouncycastle/asn1/ocsp/ResponderID.class
at sun.security.util.SignatureFileVerifier.verifySection(SignatureFileVerifier.java:399)
at sun.security.util.SignatureFileVerifier.processImpl(SignatureFileVerifier.java:250)
at sun.security.util.SignatureFileVerifier.process(SignatureFileVerifier.java:193)
at java.util.jar.JarVerifier.processEntry(JarVerifier.java:305)
at java.util.jar.JarVerifier.update(JarVerifier.java:216)
at java.util.jar.JarFile.initializeVerifier(JarFile.java:341)
at java.util.jar.JarFile.getInputStream(JarFile.java:406)
at sun.misc.URLClassPath$JarLoader$2.getInputStream(URLClassPath.java:752)
at sun.misc.Resource.cachedInputStream(Resource.java:77)
at sun.misc.Resource.getByteBuffer(Resource.java:160)
at java.net.URLClassLoader.defineClass(URLClassLoader.java:436)
at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:472) 
```

Meta-Inf 文件夹没有任何我可以在构建 jar 时排除的签名证书。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:58:05.783

我记得在一些 bouncycastle 课程中遇到了类似的问题。

我的问题是由一个“ueber-jar”（在我的例子中是 apache-ds-all）引起的，它不仅包含来自 apache-ds 项目的类，还包含来自 apache-ds 3rd Party 依赖项的所有类。

由于 bouncycastle 类最初是在一个签名的 jar 文件中提供的，所以当从不同位置加载的类时我得到了一个安全异常 - 这是首先签署一个 JAR 的重点。

我建议扫描类路径中的所有 JAR 文件，以查看 org/bouncycastle/asn1/ocsp/ResponderID.class 是否包含在非 bouncycastle 分发 jar 文件中。

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T11:16:02.907

我在 ic4u 包中遇到了安全问题。我只是将它排除在依赖关系之外，一切正常。

```
<dependency>
  <groupId>biz.neustar</groupId>
  <artifactId>browsermob-proxy</artifactId>
  <version>${browser-mob-version}</version>
  <exclusions>
    <exclusion>
      <groupId>org.seleniumhq.selenium</groupId>
      <artifactId>selenium-api</artifactId>
    </exclusion>
    <exclusion>
      <artifactId>icu4j</artifactId>
      <groupId>com.ibm.icu</groupId>
    </exclusion>
  </exclusions>
</dependency> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T18:24:43.240

`ResponderID`我对 iText 4.2.0 和 bouncycastle 库（与其他类相关的安全异常）有完全相同的问题。

我最终删除了`META-INF`iText 附带的签名 jar 中的目录。这可能不是最优雅的方式，但至少它为我解决了问题。

# ruby-on-rails - 两个测试中的相同问题：事件有问题

> ID：12182242
> 
> 赞同：1
> 
> 时间：2012-08-29T16:15:30.417
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, factory-bot, testunit

我认为在我的测试环境中创建事件有问题。

当我在浏览器中导航时，一切都很好。

我得到的两个错误是：

```
 1) Error:
test_should_post_save_period(PeriodRegistrationsControllerTest):
NoMethodError: undefined method `event' for nil:NilClass

 2) Error:
test_should_get_index(PeriodsControllerTest):
ActionView::Template::Error: undefined method `name' for nil:NilClass 
```

错误 1 ​​测试：

```
 def setup
    @period_registration= FactoryGirl.create(:period_registration)
  end
  test "should post save_period" do
    sign_in(FactoryGirl.create(:user))
     assert_difference('PeriodRegistration.count') do
      post :save_period, period_registration: FactoryGirl.attributes_for(:period_registration)
    end
    assert_not_nil assigns(:period_registration)

    # assert_response :success
  end 
```

错误 2 测试：

```
 test "should get index" do
        sign_in(FactoryGirl.create(:user, admin: true))
        get :index
        assert_not_nil assigns(:periods)
        assert_response :success
      end 
```

第一个错误对应于控制器中的此操作：

```
 def save_period
    @period_registration = PeriodRegistration.new(params[:registration])
    @period_registration.save
    flash[:success] = "Successfully Registered for Session."
    redirect_to event_url(@period_registration.period.event) #problem line
  end 
```

在我看来，第二个错误对应于这一行：

`<h6><%= period.event.name %> in <%= period.event.city %>, <%= period.event.state%></h6>`

这是我的事件工厂：

```
 factory :event do
    name 'First Event'
    street '123 street'
    city 'Chicago'
    state 'Iowa'
    date Date.today
  end

 factory :period do
    name 'First Period'
    description 'This is a description'
    start_time Time.now + 10.days
    end_time Time.now + 10.days + 2.hours
    event
    product
  end

factory :period_registration do
    user
    period
  end 
```

我的事件模型如下所示：

```
# == Schema Information
#
# Table name: events
#
#  id         :integer         not null, primary key
#  name       :string(255)
#  date       :date
#  street     :string(255)
#  city       :string(255)
#  state      :string(255)
#  created_at :datetime        not null
#  updated_at :datetime        not null
#

class Event < ActiveRecord::Base
  attr_accessible :city, :date, :name, :state, :street
  has_many :periods

  validates :name, presence: true
  validates :street, presence: true
  validates :city, presence: true
  validates :state, presence: true
end 
```

这是我的时期模型：

```
# == Schema Information
#
# Table name: periods
#
#  id          :integer         not null, primary key
#  name        :string(255)
#  event_id    :integer
#  created_at  :datetime        not null
#  updated_at  :datetime        not null
#  start_time  :time
#  end_time    :time
#  description :text
#  product_id  :integer
#

    class Period < ActiveRecord::Base
      attr_accessible :event_id, :name, :time, :start_time, :end_time, :description, :product_id
      belongs_to :event
      belongs_to :product
      has_many :period_registrations

      validates_time :end_time
      validates_time :start_time
      validates_presence_of :name
      validates_presence_of :start_time
      validates_presence_of :end_time
      validates_presence_of :description
    end 
```

关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T06:09:03.003

我认为这是因为`FactoryGirl.attributes_for(:period_registration)`返回 {} （空哈希）。您可以在 Rails 控制台中检查它。而且您的代码中有错字：在测试中您发送`period_registration: FactoryGirl.attributes_for(:period_registration)`，但在控制器中您期望`params[:registration]`。这导致在 db 中创建了空的 PeriodRegistration 模型。此模型不包含 event_id，当您从模型请求事件时，它返回 nil。

为什么你不使用模拟进行这些测试？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T05:31:42.063

我认为这是因为您缺少 User 模型的 Factory

# ruby-on-rails-3 - 创建 Ransack 对象而不查询数据库

> ID：12182244
> 
> 赞同：1
> 
> 时间：2012-08-29T16:15:36.787
> 
> 标签：ruby-on-rails-3, ransack

我希望能够创建一个 Ransack::Search 对象以传递给 search_form_for，但是搜索对象的初始创建会查询数据库，这是我不想要的。

我想显示一个带有 Ransack::Search 选项的初始空白表单进行搜索，而不调用数据库。

我怎样才能做到这一点 ？

谢谢，

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T12:02:20.517

Arel 关系（即查询）在第一次引用结果时延迟执行，因此您应该发现您可以创建一个搜索对象并将其传递给表单，而无需调用数据库，只要您不引用.result 方法在任何地方。

例如

```
// in your controller
my_query = MyModelClass.where{ id.gt(0) }
@q = my_query.search( params[:q] )

// in your view
search_form_for( @q, (...other options...) ) 
```

其中任何一个都将触发实际执行的 db 查询：

```
- @q.results.each do |result| 
- for result in @q.results
- @q.results.count
- @q.results.to_a
- @q.results.size
// ....etc 
```

但只要您只为表单使用搜索对象，它就不会被执行。

*当然，如果您是从控制台测试，请确保将其放在`;nil`行尾，否则控制台将打印最后评估的内容，这将导致查询运行！*

# git - 樱桃采摘的替代品

> ID：12182245
> 
> 赞同：11
> 
> 时间：2012-08-29T16:15:40.200
> 
> 标签：git

我们有一个*主*分支和一个*生产*分支。主分支包含当前的开发，而生产分支包含在服务器上运行的东西。有时，有一个重要的错误修复必须应用于两个分支。

目前，我们只是在主分支上创建提交后挑选提交。但这有时会在我们合并分支时产生合并冲突。**有替代品吗？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T16:20:01.353

您可以在and`bugfix-a`的合并基础上创建一个新分支（我们称之为）`master``production`

```
git checkout -b bugfix-a $(git merge-base master production) 
```

在该分支中应用您的错误修复

```
>>/path/to/file echo 'this fixes the bug'
git add /path/to/file
git commit -m 'important bugfix' 
```

然后，将这个新分支合并到主分支和生产分支：

```
git checkout master
git merge bugfix-a
git checkout production
git merge bugfix-a 
```

这样，您应该能够在以后合并 master 和 production，Git 将足够聪明地确定选择哪些提交。

（单调——是的，它不是 Git——称这个工作流为[daggy fix](http://wiki.monotone.ca/DaggyFixes/)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T16:21:11.413

为每个修补程序创建一个单独的分支，并将其合并到您的开发分支和生产分支中。

gitflow 模型通常工作得很好，我建议检查一下： http: [//nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

您的 master 分支类似于他们的开发分支，您的生产分支类似于他们的 master

![在此处输入图像描述](../Images/656f1cbe4ab9d9f45a94db2d366adbb3.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T16:21:46.033

你可以使用 Gitflow。我认为“修补程序”可以处理您的情况。

# excel - 根据范围动态格式化单元格

> ID：12182246
> 
> 赞同：0
> 
> 时间：2012-08-29T16:15:39.887
> 
> 标签：excel, formatting

我已经阅读了很多“条件格式”的答案，但似乎没有一个涵盖我正在尝试做的这方面......

我有两个问题：（Excel 2010 - Windows XP）1）我有一列计算每行的百分比 - 我在该行中还有另一个单元格，它有一个“基础”或“参考”百分比......突出显示计算百分比超出基于“基本”百分比的范围的单元格。

示例 - 基本百分比为 15.5% (A1) - 计算的行百分比为 17% (AA1) - 我想要这样的内容 IF AA1 < sum(A1*.9) AND AA1 > sum(A1*1.1) THEN highlight cell A1

需要注意的是，所有执行类似操作的“条件格式” - 使用 NOT BETWEEN - 似乎总是将单元格引用转换为 ABSOLUTE ......这意味着当我将该公式粘贴到 AA2 或 AA3 时 - 它保持引用为 $ 1澳元...

我需要它每行更改....

2）第二个问题 - 不相关 - 是否有某种方法可以锁定该列（在我的示例中为“AA”），因此人们无法将数据粘贴到我的公式区域？？？？？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:37:28.577

1) 在条件格式部分，使用公式标准。当您的公式返回 1 时，将应用格式设置，而 0 则不应用它。所以你可以这样做：

`IF (AND(AA1 < sum(A1*.9),AA1 > sum(A1*1.1)), 1, 0)`

作为您的条件格式公式。当您将其应用于范围时，它就像将公式从范围的左上角单元格拖动到右下角单元格一样。

# java - java正则表达式多模式顺序匹配

> ID：12182250
> 
> 赞同：2
> 
> 时间：2012-08-29T16:15:55.533
> 
> 标签：java, regex, loops, pattern-matching

我有一个具体的问题，我在网上找不到任何答案。基本上，我想对具有多种模式的文本运行模式匹配操作。但是，我不希望匹配器一次得到所有结果，而是在循环的不同阶段调用每个模式，同时在每个阶段执行特定操作。例如，假设我有`Pattern1`、`Pattern2`和`Pattern3`，我想要类似的东西：

```
 if (Pattern 1 = true) {
        delete Pattern1;
    } else if (Pattern 2 = true) {
        delete Pattern2;
    } else if (Pattern 3 = true) {
        replace with 'something;
    } .....and so on 
```

（这只是循环的说明，所以可能语法不正确，）

我的问题是：如何编译不同的模式，同时分别调用它们？（我只看到多个模式一起编译并在 AND/OR 等的帮助下一起搜索......不幸的是，这不是我想要的）我可以将模式保存在一个数组中并在我的环形？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:23:43.880

准备您的`Pattern`对象`pattern1, pattern2, pattern3`并将它们存储在任何容器（数组或列表）中。然后在每次迭代时使用对象的`usePattern(Pattern newPattern)`方法循环这个容器。`Matcher`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:26:17.647

您可以创建一个通用接口，并使用模式或任何其他您可能想要转换字符串的匿名实现：

```
interface StringProcessor {
    String process(String source);
}

StringProcessor[] processors = new StringProcessor[] {
    new StringProcessor() {
        private final Pattern p = Pattern.compile("[0-9]+");
        public String process(String source) {
            String res = source;
            if (p.matcher(source).find()) {
                res = ... // delete
            }
            return res;
        }
    }
,   new StringProcessor() {
        private final Pattern p = Pattern.compile("[a-z]+");
        public String process(String source) {
            String res = source;
            if (p.matcher(source).find()) {
                res = ... // replace
            }
            return res;
        }
    }
,   new StringProcessor() {
        private final Pattern p = Pattern.compile("[%^#@]{2,5}");
        public String process(String source) {
            String res = source;
            if (p.matcher(source).find()) {
                res = ... // do whatever else
            }
            return res;
        }
    }
};

String res = "My starting string 123 and more 456";
for (StringProcessor p : processors) {
    res = p.process(res);
} 
```

请注意， 的实现`StringProcessor.process`根本不需要使用正则表达式。底部的循环不知道正则表达式参与获取结果。

# javascript - .error() jquery 函数中的详细错误消息

> ID：12182252
> 
> 赞同：0
> 
> 时间：2012-08-29T16:16:03.600
> 
> 标签：javascript, jquery

我使用 .error() 作为 .post() 的回调。喜欢 ：

```
 $.post("url", function(data){})
 .error(function(){
          alert("some error");
 }); 
```

如果会发生一些错误，我想查看详细的错误消息。我怎么能看到呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:17:38.060

```
 $.post("url", function(data){})
 .error(function(event, jqXHR, ajaxSettings, thrownError){
     console.log(event, jqXHR, ajaxSettings, thrownError);
 }); 
```

# eclipse - 如何在 Eclipse Juno 中安装 Eclipse PDT 3.1？

> ID：12182255
> 
> 赞同：3
> 
> 时间：2012-08-29T16:16:08.877
> 
> 标签：eclipse, eclipse-pdt, eclipse-juno

使用以下更新站点：

*   [http://download.eclipse.org/releases/juno/](http://download.eclipse.org/releases/juno/)
*   [http://download.eclipse.org/eclipse/updates/4.2/](http://download.eclipse.org/eclipse/updates/4.2/)

Eclipse 4.2.0 Juno 安装 PDT 3.0.1。

[nightly developer builds](http://www.eclipse.org/pdt/downloads/) ，目前是 3.1.1，可以通过更新站点安装：

*   [http://download.eclipse.org/tools/pdt/updates/3.1.1/nightly](http://download.eclipse.org/tools/pdt/updates/3.1.1/nightly)

**如何安装稳定版 PDT 3.1.0？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-07T13:42:31.833

转到帮助->安装新软件，然后放上这个网址：

*   [http://download.eclipse.org/releases/juno](http://download.eclipse.org/releases/juno)

现在搜索 php 并选择那些数据包，按下下一步按钮并完成安装。之后重置 Eclipse-Ide，您将拥有 php 插件 :)

![在此处输入图像描述](../Images/7e386948916184999d82f1854bbcea07.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T19:53:51.263

你很可能[不能](http://www.eclipse.org/forums/index.php/t/366539/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-01T01:47:02.980

是的你可以。从以下链接中选择 PDT。 [http://download.eclipse.org/releases/indigo/](http://download.eclipse.org/releases/indigo/)

# jquery - 将 For-Each 绑定到 JQuery Accordion

> ID：12182256
> 
> 赞同：0
> 
> 时间：2012-08-29T16:16:09.673
> 
> 标签：jquery, foreach, knockout.js, accordion

我想使用 for each 循环创建一个手风琴用户界面。到目前为止，我有以下代码......

HTML

```
<div id="accordion" data-bind="foreach: fixtures">
   <h3><a href="#" data-bind="text: name"></a></h3>
   <div>Information</div>
</div> 
```

JAVASCRIPT

```
$("#accordion").accordion({ header: "h3", collapsible: true, active: true}); 
```

关于哪里出错的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:47:32.423

放入 $(document).ready(function () {...

```
$(document).ready(function () {
    ...
    $("#accordion").accordion({ header: "h3", collapsible: true, active: true });
}); 
```

# jquery - 单击寻呼机元素时，自定义 jCarousel 会导致奇怪的循环效果

> ID：12182258
> 
> 赞同：0
> 
> 时间：2012-08-29T16:16:18.593
> 
> 标签：jquery, html, css, jcarousel

好的，我会尽可能简单地说明这一点：

1）查看此页面并查看轮播：

[http://www.powellcreative.com/clients/StansellHealth/](http://www.powellcreative.com/clients/StansellHealth/)

2）jCarousel设置为圆形，只有3张幻灯片，从第5张幻灯片开始（第2张幻灯片，它的第2个实例[所以它会防止任何空白]

3) 如果您点击寻呼机上的“1”，它在这里看起来很棒并且工作得很好。

4）如果你从点击“3”开始，然而，轮播会像它应该的那样移动，但是在动画停止后左边的幻灯片会动态变为幻灯片“4”（这是不正确的，它应该像你一样停留在幻灯片“5”上目前在幻灯片“6”上）

5) 如果您从单击“1”开始，然后单击寻呼机中的任何其他数字，左侧幻灯片将始终动态更改为幻灯片“6”，而不是您单击项目之前的真正上一张幻灯片。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:34:42.733

这么简单的任务听起来很混乱，哈哈！

在我看来，您正试图用螺丝刀将钉子敲入一块木头。有个更好的方法。我建议看一下[Revolver.js 之](http://revolverjs.com)类的东西。它不是内容滑块，更像是构建滑块的框架。这就是您在这里尝试做的事情。

我知道您并没有特别要求替代解决方案，但我对此建议有强烈的感觉，并认为它可能对您有很大帮助。

**免责声明：**我是 Revolver.js 的首席开发人员，虽然推荐我制作的东西（确实如此）可能有点自私，但我仍然认为它很适合你。这就是我最初开始这个项目的原因。所以请原谅无耻的插件。:)

# python - 如何在不修改 Django 项目中的模型的情况下定义模型表名？

> ID：12182259
> 
> 赞同：1
> 
> 时间：2012-08-29T16:16:31.633
> 
> 标签：python, django, django-models

第三方 Django 应用程序安装在 Django 项目中，不应对其进行修改。

与提到的 Django Applicaction 中的模型关联的数据的表具有 Django 命名表的方式所不期望的名称。到目前为止，字段名称确实遵守约定。

如果我能够修改 Django 应用程序，我只需在模型定义中设置*db_table*元选项。事实上，分离应用程序的想法是 Django 的强项，所以不应该轻易修改应用程序。

改变表名的可能性是不可能的。

继承模型是不可能的，因为 Django 项目到处都有对模型的引用。

提出问题的另一种方法是：在将 db_table元选项用于连接数据库之前，我可以在代码中的何处将 db_table 元选项注入*模型***类？**这个问题是基于**Python**动态能力的想法。

# java - WebView.findAll 没有找到非英文字符

> ID：12182261
> 
> 赞同：1
> 
> 时间：2012-08-29T16:16:40.920
> 
> 标签：java, android, search, webview

我有一个包含 Html 文件的项目，我将它们显示在 a 中`WebView`，当用户尝试在文件中搜索时，我使用[WebView.findAll(String)](http://developer.android.com/reference/android/webkit/WebView.html#findAll%28java.lang.String%29)，它在 上工作正常`English keywords`，但`Arabic keywords`总是返回`0 (nothing found)`结果，怎么能我解决这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T21:53:07.820

我得到的问题来自：[Android webview：使用 javascript 突出显示页面中的特定单词？](https://stackoverflow.com/questions/5294562/android-webview-highlight-a-specific-word-in-a-page-using-javascript)

工具：[http](http://www.nsftools.com/misc/SearchAndHighlight.htm) ://www.nsftools.com/misc/SearchAndHighlight.htm （查看源代码）

这正是你想要的。我用阿拉伯语关键字对其进行了测试，并且有效。祝你好运！

如果你使用这个工具，你必须在你的 webview 上启用 Javascript：

```
webview.getSettings().setJavaScriptEnabled(true); 
```

# c# - 访问多个类的属性

> ID：12182267
> 
> 赞同：1
> 
> 时间：2012-08-29T16:17:02.820
> 
> 标签：c#, asp.net

我正在创建一个 Web 应用程序，我有两个类：

```
public class MOrderMain
{
    public int ID { get; set; }
    public int CompanyID { get; set; }
    public string CompanyName { get; set; }
    public DateTime OrderDate { get; set; }
    public string BillingName { get; set; }
    public string BillingAddress { get; set; }
    public string DeliveryName { get; set; }
    public string DeliveryAddress { get; set; }
}

public class MOrder
{
   public int ID { get; set; }
   public int OrhID { get; set; }
   public int ProID { get; set; }
   public string Name { get; set; }
   public int Quantity { get; set; }
   public double Rate { get; set; }
   public double Amount { get; set; }
   public int DeliveredQty { get; set; }
} 
```

我想从这两个类中检索详细信息。例如，我想 从 class`ID`和class 中获取所有属性。我怎样才能做到这一点？`Billing Name``MorderMain``MOrder`

我正在通过数据库获取值。我有查询，但我将如何分配数据以及如何从两者中检索？

```
var mylist = new List<MOrder>();
_con = _db.GetConnection();
if (_con.State.Equals(ConnectionState.Closed))
{
    _con.Open();
}
_cmd = new SqlCommand("Get_All_Order_Details", _con) 
           { CommandType = CommandType.StoredProcedure };
_dr = _cmd.ExecuteReader();

while (_dr.Read())
{
    mylist.Add(new MOrder
    {
        ID = Convert.ToInt32(_dr["ordID"]),
        OrhID = Convert.ToInt32(_dr["orhID"]),
        ProID = Convert.ToInt32(_dr["proID"]),
        Name = _dr["pName"].ToString(),
        Quantity = Convert.ToInt32(_dr["ordQty"]),
        Rate = Convert.ToDouble(_dr["ordRate"]),
        Amount = Convert.ToDouble(_dr["ordAmount"]),
        DeliveredQty = Convert.ToInt32(_dr["ordQtyDelivered"])
     });
}
return mylist; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:39:48.793

由于您要从数据库中的两个表中检索数据，但希望将它们组合到应用程序中，因此解决方案是创建一个包含从存储过程返回的数据的单个类：

```
public class MAllOrderDetails
{
   public int ID { get; set; }
   public string BillingName { get; set; }
   // include the other billing details you want here

   public int OrhID { get; set; }
   public int ProID { get; set; }
   public string Name { get; set; }
   public int Quantity { get; set; }
   public double Rate { get; set; }
   public double Amount { get; set; }
   public int DeliveredQty { get; set; }
} 
```

然后，您的查询更改为填写`List<MAllOrderDetails>`.

这使您的应用程序只需要处理单个类的集合，所有数据都很好地包含在单个对象中。

```
var mylist = new List<MAllOrderDetails>();
//...
while (_dr.Read())
{
    mylist.Add(new MAllOrderDetails
    {
        ID = Convert.ToInt32(_dr["ordID"]),
        BillingName = _dr["BillingName"].ToString(),
        // etc.
        OrhID = Convert.ToInt32(_dr["orhID"]),
        ProID = Convert.ToInt32(_dr["proID"]),
        Name = _dr["pName"].ToString(),
        Quantity = Convert.ToInt32(_dr["ordQty"]),
        Rate = Convert.ToDouble(_dr["ordRate"]),
        Amount = Convert.ToDouble(_dr["ordAmount"]),
        DeliveredQty = Convert.ToInt32(_dr["ordQtyDelivered"])
     });
} 
```

**更新**

作为不创建其他类的最接近的解决方案，您可能会侥幸逃脱：

```
class MAllOrderDetails
{
    public MOrder Order { get; set; }
    public MOrderMain OrderMain { get; set; }
} 
```

不过，我觉得，从可维护性的角度来看，这会比仅仅创建额外的类更让你头疼。

# javascript - Android下WebView中JavaScript创建的下拉列表故障

> ID：12182276
> 
> 赞同：3
> 
> 时间：2012-08-29T16:17:38.480
> 
> 标签：javascript, android, drop-down-menu, webview

我正在使用带有 Android 2.2 的 Galaxy Tab 测试我的应用程序，并在 WebView 组件中发现以下问题。我有本地 HTML 页面，即时生成。当我在 HTML 中有这样的 SELECT 时：

```
<select class='dd'>
    <option value='1'>1</option>
    <option value='2' selected=selected>2</option>
    <option value='3'>3</option>
</select> 
```

它会导致以下**问题**：

1.  您可以看到下拉列表，但无法选择它，直到您更改 WebView 中的缩放。
2.  在您可以选择下拉菜单并选择选项之后，初始选项值会保留在下拉菜单中（尽管已`onchange`被触发）： ![在此处输入图像描述](../Images/b6e37c1e02da23816a3fda62aeb53d12.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:47:01.570

对于第二个问题，请尝试：

```
sl.bind("ontouch", function(e) {
    e.preventDefault();
}); 
```

# javascript - jquery onmouseover 函数

> ID：12182282
> 
> 赞同：0
> 
> 时间：2012-08-29T16:18:09.720
> 
> 标签：javascript, jquery

我需要使用 Jquery 旋转图像 onmouseover 功能

**文件.js**

```
$("#logo").rotate({
        bind:
         {
             mouseover: function () 
             {$(this).rotate({ animateTo: 180 })},
             mouseout: function () 
             {$(this).rotate({ animateTo: 0 })}
        }
 }); 
```

**HTML**

```
<script type="text/javascript" src="../script/file.js"></script>
<img id="logo" src="../images/logo.png" alt="none" /> 
```

这段代码有什么问题吗？顺便说一句，我在互联网上找到了这个代码。JavaScript 中没有作为 rotate() 的函数调用，那么它是如何工作的呢？请提供任何链接，以便我理解。

如果问这个问题看起来很愚蠢，请忽略这个问题:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:20:30.543

`.rotate()`不是函数。您是否正确引用了任何插件？这一定是导致问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:22:16.747

看起来您正在尝试使用一些使用自定义 JQuery 插件的代码片段。

JQuery 中没有用于旋转图像的内置函数。有很多可用的插件，例如[http://code.google.com/p/jquery-rotate/](http://code.google.com/p/jquery-rotate/)和[http://code.google.com/p/jqueryrotate/](http://code.google.com/p/jqueryrotate/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:39:17.670

[从此处http://code.google.com/p/jquery-rotate/downloads/list](http://code.google.com/p/jquery-rotate/downloads/list)下载 jquery.rotate.1-1.js并将其包含在此调用之前的脚本标记中。

# ios - Facebook：iOS 应用程序中出现“无法点赞 URL，因为它已被阻止”错误

> ID：12182286
> 
> 赞同：3
> 
> 时间：2012-08-29T16:18:19.277
> 
> 标签：ios, facebook, facebook-like, facebook-ios-sdk

我正在开发一个 iOS 应用程序，该应用程序允许用户在应用程序中喜欢 Facebook 页面。我已经使用[FacebookLikeView](https://github.com/brow/FacebookLikeView)实现了这一点。在测试此功能的过程中，我多次喜欢和不喜欢同一个页面。不幸的是，这似乎触发了 Facebook 的垃圾邮件检测。现在，当尝试使用 FacebookLikeView 显示的点赞按钮点赞页面时，会出现以下错误：“无法点赞 URL，因为它已被阻止”。

根据通过搜索网络发现的相同问题的报告，我已填写[此表格](https://www.facebook.com/help/contact/?id=244560538958131)以请求 Facebook 删除阻止。但是，我没有收到他们的回复。我不确定如何进行。有没有其他人遇到过这个问题并成功解决了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T07:48:20.497

*每月在 Facebook 上共享数十亿条内容，而且不良行为者不断针对使用 Facebook 的人，防止垃圾邮件并不容易。正如社区依靠其公民举报犯罪一样，我们依靠您在遇到垃圾邮件时通知我们，垃圾邮件可以是您不认识的人发送的好友请求，也可以是包含指向某个网站的链接的消息。恶意网站。*

来自：[解释 Facebook 垃圾邮件检测](https://blog.facebook.com/blog.php?post=403200567130)

这不是答案，Donn Lee 所说的也许是最好的答案。

我对此的最佳猜测是向他们发送有关您测试应用程序而不是滥用系统的大量信息。您可以尝试截图、联系信息并解释您正在测试它的目的。

试试看：[Facebook 帮助中心](https://www.facebook.com/help/)

开发人员帮助：[速率限制、限制和禁用](https://www.facebook.com/help/?page=100502990045478)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T14:24:29.613

尝试在[Facebook Developers Bugreporter](https://developers.facebook.com/bugs)上提交错误。

如果一周后该网站仍被阻止，请在[此表单](https://www.facebook.com/help/contact/?id=244560538958131)上提交您的网站。

[如果没有其他选择， Facebook Newsroom](http://newsroom.fb.com)上还有不相关的联系信息，包括电子邮件地址[press@fb.com](http://mailto%3apress@fb.com)。

# iphone - 模型-视图-控制器

> ID：12182287
> 
> 赞同：0
> 
> 时间：2012-08-29T16:18:21.100
> 
> 标签：iphone, xcode, ipad

是的，我是 Xcode 的菜鸟。现在我正在阅读 Big Nerd Ranch IOS 编程书，我只需要对模型-视图-控制器位进行一点说明。

模型类称为“CellData”，NSObject View 类称为“CellView”，UIView Controller 类称为“CellAppDelegate”，UIResponder。

DrawRect 方法根据 CellData 类中的数据使用颜色进行大量绘图。到目前为止，一切*似乎*都告诉我，我不应该从我的“CellView”类中调用“CellData”方法。通常是的，当您只使用带有 TestFields 的 UIButtons 时，是的，非常有意义。

在这种情况下，我必须将一个值从“CellData”传递到“CellView”最多 6000 次才能刷新视图。继续在使用 CellAppDelegate 之间来回调用是否仍然有意义（计算机似乎需要做更多的工作），还是我真的“允许”从 CellData 检索值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:37:06.300

你自己真的回答了你的问题。不，每次渲染 6000 次调用不是正确的做法，尤其是在会频繁重绘的表格视图单元格上。

就个人而言，我认为控制器的工作是从模型层（业务逻辑等发生的地方）请求数据对象并将它们传递给视图。所以，在你的情况下，我只会将数据对象传递到你的单元格中。（我会将它作为您单元格上的一个属性，并带有一个也调用`[self setNeedsDisplay];`触发重绘的设置器）

话虽如此，我也倾向于支持模型层提供不可变的数据对象，这样控制器/视图就不会对它们做任何错事:) 使用这种方法，如果控制器想要编辑数据对象，它就必须调用模型层中的一个方法来做到这一点。

当然，这只是我个人对建筑的看法和选择。显然，对于现有的 UI 对象（即 UILabel 等），我无法传入数据对象，我必须直接从我的视图控制器设置 text 属性。

* * *

PS对于视图控制器来说`CellAppDelegate`是个坏名字——习惯是用 . 结尾的类名。这种命名方案可以很容易地在一周左右的时间内回到您的代码，并且仍然了解所有内容的作用:)`ViewController``CellAppViewController`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:43:00.447

> 到目前为止，一切似乎都告诉我，我不应该从我的“CellView”类中调用“CellData”方法。

这听起来像是一个误解。`CellView`控制器交给一个类似的东西是非常常见`CellData`的。视图可以自由查询它负责显示的模型对象。这不违反 MVC。它通常不应该*写入*模型对象，也不应该与*其他*模型对象对话。

# php - 这个 PHP 库中的“\”是什么意思？

> ID：12182289
> 
> 赞同：6
> 
> 时间：2012-08-29T16:18:21.710
> 
> 标签：php, oop, class

```
$mail = new SendGrid\Mail(); 
```

我不明白`\`中间`SendGrid`和`Mail()`上面的意思。谁能告诉我它是什么以及它的逻辑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T16:32:41.720

这定义了命名空间。所以 Mail 库位于 SendGrid 命名空间中。这是仅在 PHP 5.3+ 中可用的功能。

基本上，命名空间是一种限制可以拥有类名的范围的方法。它允许您在许多不同的名称空间中拥有具有相同名称的类，而不会在类定义之间发生冲突。它非常适合编写库，因为它使您的库的最终用户不受您的命名约定的限制。

# c# - F# 中的模式匹配比 C# 中的 If else / switch 慢得多？

> ID：12182291
> 
> 赞同：7
> 
> 时间：2012-08-29T16:18:22.417
> 
> 标签：c#, performance, f#, pattern-matching

> **可能重复：**
> [F# 似乎比其他语言慢……我能做些什么来加快它的速度？](https://stackoverflow.com/questions/6794138/f-seems-slower-than-other-languages-what-can-i-do-to-speed-it-up)

我对模式匹配的性能有点好奇，所以做了如下测试：

`poolEven`包含 0,1,2,3 的 10000 个元素，（2500 相等）

`testSize = 100000`

`IfelseEven(100000)` 需要 650 毫秒（切换会更快，但我没有附加代码），而`MatchEven(100000)`需要 7000 毫秒，这是 10 倍的时间

性能下降是从哪里来的`Array.Fold`？我 100% 确定，如果我继续前进，`IEnumerable.Aggregate`速度会大大降低。**但我认为 F#`Array.Fold`比 C# 处理得更好`IEnumerable.Aggregate`**。我想比较 2 种语言中最常见（等效）编码方式的性能，但不是让它们相同的严格方式。

测试在 x64 版本中完成，平均进行了 10 次以上的试验并进行了适当的预热

C＃：

```
public void IfelseEven(int testSize)
{
    Ifelse(testSize, poolEven);
}

void Ifelse(int testSize, int[] pool)
{
    long sum = 0;
    for (int i = 0; i < testSize; i++)
    {
        for (int j = 0; j < poolCapacity;j++ )
        {
            var item = pool[j];
            if (item == 0)
            {
                sum += 5;
            }
            else if (item == 1)
            {
                sum += 1;
            }
            else if (item == 2)
            {
                sum += 2;
            }
            else if (item == 3)
            {
                sum += 3;
            }
            else
            {
                sum += 4;
            }
        }
    }
}

public void MatchEven(int testSize)
{
    PatternMatch.myMatch(testSize, poolEven);
} 
```

F＃：

```
module PatternMatch

let mat acc elem =
    acc +
    match elem with
    | 0 -> 5L
    | 1 -> 1L
    | 2 -> 2L
    | 3 -> 3L
    | _ -> 4L

let sum (pool:int[])=
    Array.fold mat 0L pool;

let myMatch testSize pool=
    let mutable tmp = 0L
    for i=0 to testSize do
        tmp <- sum(pool) + tmp
    tmp 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-29T18:53:52.170

投票结束——我们可以整天玩这个游戏。有关为什么不同代码可能具有不同执行时间的更多评论，请参阅[此问题和答案](https://stackoverflow.com/questions/6794138/f-seems-slower-than-other-languages-what-can-i-do-to-speed-it-up)。如果你只是想加快你的 F# 函数，试试这个：

```
let ifElse testSize (pool: _[]) = 
  let mutable sum = 0L
  for i = 0 to testSize - 1 do
    for j = 0 to pool.Length - 1 do
      match pool.[j] with
      | 0 -> sum <- sum + 5L
      | 1 -> sum <- sum + 1L
      | 2 -> sum <- sum + 2L
      | 3 -> sum <- sum + 3L
      | _ -> sum <- sum + 4L
  sum 
```

根据我的测量，这可以轻松地舔 C# 函数（而且它仍然更短且更具可读性）：

C# 5655
F# 4003

顺便说一句，leppie 在评论中指出了这一点。我分析了你的代码，78% 的时间都花在了`Array.fold`——在一个紧密的循环中不好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-29T18:58:39.933

正如评论中所提到的，通过使用完全不同的模式，您并没有真正得到单独的`match`vs比较`if/elseif`。循环与折叠与递归的比较是一个完全不同的问题。

使用更直接的比较（循环，与丹尼尔的回应相同），我得到了以下结果。发布版本，.NET 4.5，x64 目标架构。

*   C# 和 F#`if\elseif`方法的运行方式几乎完全相同（在这个人为的示例中）。

*   F#`match`始终比`if\elseif`任何一种语言都快（在这个人为的示例中）

*   C#`switch`一直是最快的（在这个人为的例子中）。

# qt - 如何在 QWebView 中启用弹出窗口？[Qt]

> ID：12182292
> 
> 赞同：3
> 
> 时间：2012-08-29T16:18:30.823
> 
> 标签：qt, qtwebkit, qwebview, qwebpage

我有一个非常简单的 Qt 应用程序，它使用 QtWebkit 和 QWebPage 来呈现网页。问题是它似乎不支持弹出窗口。例如，在 google.com 中，当我单击“Gmail”时，Javascript 警报说我的浏览器已禁用弹出窗口...

还有一个带有以下“a”标签的html文件：`<a href = "index.html" target = "_blank">Link</a>`两者都不起作用。

有谁能够帮我？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T20:01:42.573

您需要重新定义或者`QWebPage::createWindow`创建`QWebView::createWindow`一个新的`QWebPage`和/或`QWebView`。

# ruby-on-rails - 如何获取 Rails 中关联表的某些列的值？

> ID：12182293
> 
> 赞同：0
> 
> 时间：2012-08-29T16:18:45.127
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, database-design, activerecord

如何通过 Record 模型获得产品重量？据我所知，可以获得特定记录的所有产品，但我无法找到获取特定产品重量的方法。

![在此处输入图像描述](../Images/7234f89a3d43d61dafb2b5aba46132c6.png)

```
class User < ActiveRecord::Base
  has_many :eatings
end

class Eating < ActiveRecord::Base
  belongs_to :user
  has_many :records
end

class Record < ActiveRecord::Base
  belongs_to :eating
end

class Product < ActiveRecord::Base
end

class WeightedProduct < ActiveRecord::Base
end 
```

Record 和 Product 模型应该与 WeightedProduct 有什么关系，以便用户能够通过一行 User.first.eatings.first.records.first.products.first.weight 获得某些产品的重量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:36:39.897

看起来你在这个之后：

```
class Record < ActiveRecord::Base
  belongs_to :eating
  has_many :weighted_products
end

class Product < ActiveRecord::Base
  has_many :weighted_products
end

class WeightedProduct < ActiveRecord::Base
  belongs_to :record
  belongs_to :product
end 
```

然后`User.first.eatings.first.records.first.weighted_products.first.weight`

我认为这应该有效，但尚未测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:47:15.547

似乎每个产品都有一个加权产品，那么在这种情况下你应该添加

```
class Product < ActiveRecord::Base
 has_one :weighted_product
end

class WeightedProduct < ActiveRecord::Base
 belongs_to :product
end 
```

和

```
 class Record < ActiveRecord::Base
  belongs_to :eating
  has_many :products 
 end 
```

# c# - 刚刚更新和处理 Gtk.Window 时的内存泄漏

> ID：12182294
> 
> 赞同：0
> 
> 时间：2012-08-29T16:18:47.237
> 
> 标签：c#, mono, gtk#

只是创建和处理 Gtk.Window 对象似乎会导致内存泄漏。

例如，下面的代码示例很快就占用了超过 1GB 的空间（如 Linux 系统监视器所示 - 几秒钟后 VM 和常驻内存）：

```
for(int i = 0 ; i < 10485760; i++)
  new Gtk.Window(Gtk.WindowType.Popup).Dispose(); 
```

本 GTK FAQ 页面参考需要调用 ref + sink [gtk faq (1.5)](http://developer.gnome.org/gtk/2.24/gtk-question-index.html "gtk 常见问题")

但我都试过了

```
var window = new Gtk.Window(Gtk.WindowType.Popup).Ref().Sink(); 
window.Unref();
window.Destroy(); 
```

和

```
new Gtk.Window(Gtk.WindowType.Popup).Destroy(); 
```

它似乎没有任何区别。

有谁知道在这个用例中防止内存泄漏意味着什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:19:53.570

啊 - 回答我自己的问题。

这似乎可以防止内存泄漏。

```
var window = new Gtk.Window(Gtk.WindowType.Popup);
window.Destroy();
window.Dispose(); 
```

# windows-phone-7 - 绑定 PivotItem 标头时出现静默异常

> ID：12182296
> 
> 赞同：0
> 
> 时间：2012-08-29T16:18:50.433
> 
> 标签：windows-phone-7, exception, binding, windows-phone-7.1, pivotitem

我注意到我的 Windows Phone 7.1 应用程序中有一个奇怪的异常，这真的让我抓狂。

这些都是事实...

我开始定义一个简单的`Pivot`项目，里面有两个简单`PivotItem`的：

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
    <controls:Pivot>
        <controls:PivotItem x:Name="PivotItem1"
                            Header="Test1" />
        <controls:PivotItem x:Name="PivotItem2"
                            Header="{Binding Path=Text2, Mode=OneWay}" />
    </controls:Pivot>
    <Button Content="Test" Click="Button_Click" />
</Grid> 
```

这是我的代码隐藏...

编辑：正如 Gambit 建议我的那样，我将向您展示更多代码。

在实际情况下，**我**确实有一个 MVVM，但在这种情况下，我简化了情况，让您以简单的方式重现问题......

对于这个测试，下一个是我的视图：

```
public partial class MainPage : PhoneApplicationPage, INotifyPropertyChanged
{
    private string _text2 = "<Missing>";

    public string Text2
    {
        get
        {
            return _text2;
        }
        private set
        {
            _text2 = value;

            NotifyPropertyChanged("Text2");
        }
    }

    public MainPage()
    {
        InitializeComponent();
    }

    private void PhoneApplicationPage_Loaded(object sender, RoutedEventArgs e)
    {
        this.DataContext = this;
    }

    public event PropertyChangedEventHandler PropertyChanged;

    public void NotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        this.Text2 = "Second page";
    }
} 
```

所以，这不仅仅是一个`NULL`值的参数初始化：你会看到异常。

显然，您是在要求我提供`controls`命名空间声明。这是：

```
xmlns:controls="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls" 
```

这是指程序集`Microsoft.Phone.Controls.dll`，版本**2.0.50727**。

我的问题与绑定有关（当我发现调查问题时）：

```
Header="{Binding Path=Text2, Mode=OneWay}" 
```

如果您不使用链接到 的`Header`属性的绑定`PivotItem`，则一切正常，否则...应用程序将抛出异​​常，完全静默，并且在任何情况下都不会出现（您只能在输出窗口）：

```
A first chance exception of type 'System.Exception' occurred in System.Windows.dll 
```

如果您`Header`手动分配属性，则不会引发异常。

我想完全删除这个异常，因为我对 Header 属性有很多绑定，我不想破坏我的 MVVM ......而且它也很烦人！

我真的很讨厌看到非托管异常...

有谁知道这个问题？

任何解决方案/解决方法？

任何帮助将不胜感激...谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:44:30.130

根据提供的代码，我怀疑问题是未设置 DataContext。在您的示例中， DataContext 是在 PhoneApplicationPage_Loaded 事件中设置的。但是，您似乎并未在任何地方注册此活动。在 MainPage 的构造函数中，添加如下一行：

```
this.Loaded += new RoutedEventHandler(PhoneApplicationPage_Loaded); 
```

# java - 将 Spring 从 3.0.7 升级到 3.1.2 会引发 NoSuchBeanDefinitionException

> ID：12182300
> 
> 赞同：3
> 
> 时间：2012-08-29T16:18:59.073
> 
> 标签：java, spring, exception, spring-mvc, autowired

您好我正在尝试将 Spring 从 3.0.7 升级到 3.1.2。在 3.0.7 中一切正常，但是当我提高 pom 中的值时，启动服务器时出现错误。我是春天的新手。

我得到的错误是

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'my.name.space.security.handler.AnnotationMethodHandlerAdapterConfigurer#0': Injection of autowired dependencies failed; 
nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter my.name.space.security.handler.AnnotationMethodHandlerAdapterConfigurer.adapter; 
nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)} 
```

就像我说我是 spring 新手，但是，它似乎在自动装配到原生 spring 类时遇到了问题。我正在运行 3.0.7，这一切都很好。这是我的堆栈跟踪。

```
2012-08-29 11:50:24,364 [localhost-startStop-1] ERROR org.springframework.web.servlet.DispatcherServlet - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.ns.web.security.handler.AnnotationMethodHandlerAdapterConfigurer#0': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter com.clovrmedia.web.security.handler.AnnotationMethodHandlerAdapterConfigurer.adapter; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
  at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
  at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
  at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
  at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
  at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)
  at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
  at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
  at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
  at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
  at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
  at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
  at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
  at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
  at javax.servlet.GenericServlet.init(GenericServlet.java:160)
  at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
  at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
  at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)
  at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5027)
  at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5314)
  at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
  at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
  at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
  at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)
  at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:650)
  at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1582)
  at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
  at java.util.concurrent.FutureTask.run(FutureTask.java:138)
  at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
  at java.lang.Thread.run(Thread.java:680)
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter com.clovrmedia.web.security.handler.AnnotationMethodHandlerAdapterConfigurer.adapter; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
  at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
  ... 34 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
  at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:952)
  at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:821)
  at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:735)
  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
  ... 36 more 
```

这是我认为引发此异常的课程：

```
package com.ns.web.security.handler;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter;

/**
 * This class is a bean post-processor for AnnotationMethodHandlerAdapter. This required to set the property values
 * in the instance of AnnotationMethodHandlerAdapter created by the spring framework when using the tag
 * <annotation-driven/>
 */
public class AnnotationMethodHandlerAdapterConfigurer {
    @Autowired
    private AnnotationMethodHandlerAdapter adapter;
    private int cacheSeconds = -1;

    public void init() {
        if(cacheSeconds > -1) {
            adapter.setCacheSeconds(cacheSeconds);
        }
    }

    public int getCacheSeconds() {
        return cacheSeconds;
    }

    public void setCacheSeconds(int cacheSeconds) {
        this.cacheSeconds = cacheSeconds;
    }
} 
```

这是一个 xml 声明，它规定了 spring 请求的行为

```
 <!-- Handles Spring requests -->
<servlet>
    <servlet-name>clovrpatch</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/nsWebMVCConfig.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet> 
```

这是上面xml类中引用的nsWebMVCConfig.xml文件。它包含引发异常的类的 bean 声明。

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beans xmlns="http://www.springframework.org/schema/beans"
      xmlns:context="http://www.springframework.org/schema/context"
      xmlns:mvc="http://www.springframework.org/schema/mvc"
      xmlns:p="http://www.springframework.org/schema/p"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:util="http://www.springframework.org/schema/util"
      xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
            http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

      <import resource="classpath:META-INF/spring/nsPropertyConfig.xml"/>

      <!-- The controllers are autodetected POJOs labeled with the @Controller annotation. -->
      <context:component-scan base-package="com.ns.web" use-default-filters="false">
            <context:include-filter expression="org.springframework.stereotype.Controller" type="annotation"/>
      </context:component-scan>

      <!-- Turns on support for mapping requests to Spring MVC @Controller methods
           Also registers default Formatters and Validators for use across all @Controllers -->
      <mvc:annotation-driven />

    <!-- This is a bean post-processor for AnnotationMethodHandlerAdapter-->
    <bean class="com.ns.web.security.handler.AnnotationMethodHandlerAdapterConfigurer" init-method="init">
        <property name="cacheSeconds" value="0" />
    </bean>

      <!-- register "global" interceptor beans to apply to all registered HandlerMappings -->
      <mvc:interceptors>
            <bean class="org.springframework.web.servlet.theme.ThemeChangeInterceptor"/>
            <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor" p:paramName="lang"/>

        <bean class="org.springframework.mobile.device.DeviceResolverHandlerInterceptor" />

    </mvc:interceptors>

      <mvc:view-controller path="/scrubbedout"/>
      <mvc:view-controller path="/scrubbedout"/>
      <mvc:view-controller path="/scrubbedout"/>
      <mvc:view-controller path="/scrubbedout" />
    <mvc:view-controller path="/scrubbedout" />
    <mvc:view-controller path="/scrubbedout" />

      <!-- store preferred language configuration in a cookie -->
      <bean class="org.springframework.web.servlet.i18n.CookieLocaleResolver" id="localeResolver" p:cookieName="locale"/>     

      <!-- resolves localized <theme_name>.properties files in the classpath to allow for theme support -->
      <bean class="org.springframework.ui.context.support.ResourceBundleThemeSource" id="themeSource"/>

      <!-- store preferred theme configuration in a cookie -->
      <bean class="org.springframework.web.servlet.theme.CookieThemeResolver" id="themeResolver" p:cookieName="theme" p:defaultThemeName="standard"/>

      <!-- allows for integration of file upload functionality -->
      <bean class="org.springframework.web.multipart.commons.CommonsMultipartResolver" id="multipartResolver"/>

    <!-- Enable @Annotation-drive bean configuration -->
    <context:annotation-config />

    <!-- Configures Spring Social -->
    <bean class="com.ns.web.social.SocialConfig" />

    <bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
            <property name="mediaTypes">
                  <map>
                        <entry key="html" value="text/html" />
                        <entry key="json" value="application/json" />
                  </map>
            </property>
            <property name="viewResolvers">
                  <list>
                        <bean class="org.springframework.web.servlet.view.UrlBasedViewResolver">
                              <property name="viewClass" value="org.springframework.web.servlet.view.tiles2.TilesView" />
                        </bean>
                  </list>
            </property>
            <property name="defaultViews">
                  <list>
                        <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
                              <property name="prefixJson" value="true" />
                        </bean>
                  </list>
            </property>
        <property name="defaultContentType" value="text/html"/>
      </bean>

    <bean class="org.springframework.web.servlet.view.tiles2.TilesConfigurer" id="tilesConfigurer">
        <property name="definitions">
            <list>
                <value>/WEB-INF/layouts/nsMainLayouts.xml</value>
            </list>
        </property>
        <property name="preparerFactoryClass" value="org.springframework.web.servlet.view.tiles2.SpringBeanPreparerFactory"/>
    </bean>

    <bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"/>

    <!-- Default route -->
    <bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="/">welcomeController</prop>
            </props>
        </property>
        <property name="rootHandler" ref="welcomeController" />
    </bean>
    <!-- these are static resources. By specifing them here, they will not go through the DispatcherServlet -->

    <mvc:resources mapping="/css/**"              location="/css/"/>
    <mvc:resources mapping="/images/**"           location="/images/"/>
    <mvc:resources mapping="/js/**"               location="/js/"/>
</beans> 
```

只是提出堆栈跟踪和几个文件并只是说'为我弄清楚'，我觉得很蹩脚。但是我在这里完全超出了我的深度，并且在过去的三天里一直在谷歌上搜索。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T17:15:46.027

我不熟悉 Spring 安全性，但自 Spring 3.1 以来`AnnotationMethodHandlerAdapter`已被替换。`RequestMappingHandlerAdapter`这也许是原因之一。你可以看看[链接](http://static.springsource.org/spring/docs/3.1.0.RC1/spring-framework-reference/html/new-in-3.1.html)。希望对您有所帮助。

# c# - 如何在 C# Web 浏览器的右键单击上下文菜单中查找属性

> ID：12182302
> 
> 赞同：0
> 
> 时间：2012-08-29T16:19:06.393
> 
> 标签：c#, browser, contextmenu

嗨，我有 ac# 应用程序和一个嵌入式浏览器，它的任务是找到一个链接，然后右键单击它并单击属性！

鼠标以编程方式移动，所以我需要在右键菜单中找到属性！

你能帮我怎么做吗？

我尝试在右键单击后按“r”，但它在某些计算机上不起作用！

所以我需要通过移动鼠标来做到这一点！

这是我查找链接并右键单击的代码：

```
int x = getXoffset(link);
int y = getYoffset(link);
webBrowser1.Document.Window.ScrollTo(x, y);
Linker.Win32.POINT p2 = new Linker.Win32.POINT();
webBrowser1.Focus();
p2.x = webBrowser1.Left + 10;
p2.y = webBrowser1.Top + 5;
Linker.Win32.ClientToScreen(this.Handle, ref p2);
Linker.Win32.SetCursorPos(p2.x, p2.y);
MouseOperations.GetCursorPosition();

MouseOperations.MouseEvent(MouseOperations.MouseEventFlags.LeftDown);
MouseOperations.MouseEvent(MouseOperations.MouseEventFlags.RightDown);
MouseOperations.MouseEvent(MouseOperations.MouseEventFlags.RightUp); 
```

欢迎在右键单击菜单上访问属性的任何其他想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:26:18.483

使用此代码：

```
 [DllImport("user32.dll", SetLastError = true)]
        static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);
        public static void PressKey(Keys key, bool up)
        {
            const int KEYEVENTF_EXTENDEDKEY = 0x1;
            const int KEYEVENTF_KEYUP = 0x2;
            if (up)
            {
                keybd_event((byte)key, 0x45, KEYEVENTF_EXTENDEDKEY | KEYEVENTF_KEYUP, (UIntPtr)0);
            }
            else
            {
                keybd_event((byte)key, 0x45, KEYEVENTF_EXTENDEDKEY, (UIntPtr)0);
            }
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            webBrowser1.Navigate("http://google.com");//Your link
            webBrowser1.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(webBrowser1_DocumentCompleted); 
        }

        void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
        {
            //Find your link and right click(automatically by your code)
            webBrowser1.Document.MouseDown += new HtmlElementEventHandler(Document_MouseDown);
        }

        void Document_MouseDown(object sender, HtmlElementEventArgs e)
        {
            if (e.MouseButtonsPressed == MouseButtons.Right)
            {
                Thread.Sleep(1000);
                PressKey(Keys.P, true);
                PressKey(Keys.P, false);
            }
        } 
```

# lua - 如何将 Lua 脚本设置为在每个 LPUSH 之后运行到某个列表？

> ID：12182304
> 
> 赞同：1
> 
> 时间：2012-08-29T16:19:26.860
> 
> 标签：lua, redis

我有兴趣使用 lua 脚本将进程元素发布到 Redis 列表。所以我想知道是否有办法告诉 Redis：“在将值推入列表 Y 后始终运行 lua 脚本 X”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:21:27.627

不，你不能那样做。除非您制作自己的命令（在 lua 中），否则它将调用 LPUSH 并执行您的后处理。您还必须让所有开发人员使用该命令而不是原始 LPUSH（当涉及相应的键时）。祝你好运:)

# sql-server - Sql Server 2008 R2 带数字的全文搜索查询不起作用

> ID：12182309
> 
> 赞同：1
> 
> 时间：2012-08-29T16:19:36.093
> 
> 标签：sql-server, sql-server-2008-r2

我在 SQL Server 2008 R2 Express 实例中设置了一个数据库。我们启用了全文支持。“员工”表之一是全文索引。有一个列“地址”也被索引。

该列的值如下：“Los Angeles 9”

当我们通过以下方式查询它时：

```
Select * from Employees Contains (Address, '"Los Ang*"')) 
```

它正确地获取行

但是当我们通过以下方式查询它时：

```
Select * from Employees Contains (Address, '"Los Angeles 9*"')) 
```

什么都没有得到

```
 Select * from Employees Contains (Address, '"Los Angeles*" AND "9"')) 
```

也没有获取。

我在我的数据库的存储部分添加了一个新的停止列表，并且只添加了一个粗略的停止项，因此不包括从索引中删除数字..

但即使在此之后，上述查询也一无所获。然后，我加载了系统默认停止列表，从中删除了数字 0 到 9，再次运行人口。仍然没有任何东西被提取......

还有什么要做的吗？？请给个建议。

# android - android：在Parent Activity中处理AlertDialog组件的事件

> ID：12182316
> 
> 赞同：0
> 
> 时间：2012-08-29T16:19:55.000
> 
> 标签：android, events, android-listview, android-activity, android-alertdialog

在我的应用程序中，我有一个场景，我需要在许多情况下显示带有标题的 listView。

所以我创建了一个 gen_list_layout.xml，其中包含一个 TextView 和一个 ListView。

现在要显示列表，我计划创建一个方法“public static AlertDialog createAlertDialog(String title, String[] items, Activity activity)”，我可以在其中创建相同的 AlertDialog。

```
 public AlertDialog createAlertDialog(Activity act, String title, String[] items) {
    LayoutInflater layoutInflater   = (LayoutInflater)this.getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
    View view = layoutInflater.inflate(R.layout.gen_list_layout,null);

    TextView titleTv = (TextView) view.findViewById(R.id.genListTitTv);
    titleTv.setText(title);

    ArrayAdapter<String> ad = new ArrayAdapter<String>(this, R.layout.list_item, R.id.genList, items);
    ListView listView = (ListView) findViewById(R.id.genList);
    listView.setAdapter(ad);
    listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);

     // I WANT THIS TO BE HNDLED IN THE ACTIVITY CALLING    
    listView.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> arg0, View v, int position,  long id) {              
        }

    });

    AlertDialog.Builder scrnDlg = new AlertDialog.Builder(act);
    scrnDlg.setView(view);

    final AlertDialog adg = scrnDlg.create();

    return adg;
} 
```

我将在需要列表的任何地方从不同的 Activity 调用 createAlertDialog()。

```
 AlertDialog ad = Components.createAlertDialog(RouteListActivity.this, title, items); 
```

现在如何处理 AlertDialog 中的 ListView 的点击事件？

任何线索，如何实施。

**更新** 我在实施您的方法后更新了我的 Q 并且我看到了一个异常。无法获取异常的原因。我创建了一个类并添加了 createAlertDialog ：

```
public class ListAlertDialog {

public AlertDialog createAlertDialog(Activity act, String title, String[] items, OnItemClickListener clickListener) {
    Log.i("ListAD", "Start to create Alert Dialog");
    LayoutInflater layoutInflater   = (LayoutInflater)act.getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
    View view = layoutInflater.inflate(R.layout.gen_list_layout, null);

    Log.i("ListAD", "Got View :" + view.getId());
    TextView titleTv = (TextView) view.findViewById(R.id.genListTitTv);
    titleTv.setText(title);
    Log.i("ListAD", "Set Title TV : " + titleTv.getId());

    ArrayAdapter<String> ad = new ArrayAdapter<String>(act, R.layout.list_item, R.id.genList, items);
    Log.i("ListAD", "Created Adapter");
    ListView listView = (ListView) view.findViewById(R.id.genList);
    listView.setAdapter(ad);
    listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
    Log.i("ListAD", "Got ListView :" + listView.getId() + " & Set Adapter");

    listView.setOnItemClickListener(clickListener);
    Log.i("ListAD", "Added Listerner to listView : " + clickListener.getClass());

    AlertDialog.Builder scrnDlg = new AlertDialog.Builder(act);
    scrnDlg.setView(view);
    Log.i("ListAD", "Set View of scrnDlg");

    final AlertDialog adg = scrnDlg.create();
    Log.i("ListAD", "Created Alert Dialog & returning it : " + adg );       
    return adg;
}
} 
```

我的 gen_list.layout.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent" android:layout_height="wrap_content" 
    android:orientation="vertical">
    <TextView android:id="@+id/genListTitTv" style="@style/inPageTitleStyle"             
        android:text="" />

    <ListView android:id="@+id/genList" android:layout_width="match_parent" android:layout_height="wrap_content"
        android:dividerHeight="0dp" android:divider="@null" />
</LinearLayout> 
```

在我的活动中，我调用为：

```
 ListAlertDialog lad = new ListAlertDialog();
    AlertDialog ad = lad.createAlertDialog(Mumbai77Activity.this, "Select", items, clickListener);
    Log.i(TAG, "Got the AD in Activity : " + ad + " ABT to Show");
    ad.show();
    Log.i(TAG, "Shown ad"); 
```

我在日志中得到的错误是 NullPointerException ：

```
08-30 12:52:00.247: I/ListAD(366): Start to create Alert Dialog
08-30 12:52:00.257: I/ListAD(366): Got View :-1
08-30 12:52:00.257: I/ListAD(366): Set Title TV : 2131230764
08-30 12:52:00.257: I/ListAD(366): Created Adapter
08-30 12:52:00.257: I/ListAD(366): Got ListView :2131230765 & Set Adapter
08-30 12:52:00.267: I/ListAD(366): Added Listerner to listView : class    org.mumbai77.core.Mumbai77Activity$2
08-30 12:52:00.267: I/ListAD(366): Set View of scrnDlg
08-30 12:52:00.267: I/ListAD(366): Created Alert Dialog & returning it : android.app.AlertDialog@44f29668
08-30 12:52:00.267: I/Mumbai77(366): Got the AD in Activity : android.app.AlertDialog@44f29668 ABT to Show
08-30 12:52:00.297: I/Mumbai77(366): Shown ad
08-30 12:52:00.417: D/AndroidRuntime(366): Shutting down VM
08-30 12:52:00.417: W/dalvikvm(366): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
08-30 12:52:00.437: E/AndroidRuntime(366): FATAL EXCEPTION: main
08-30 12:52:00.437: E/AndroidRuntime(366): java.lang.NullPointerException
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:353)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.ArrayAdapter.getView(ArrayAdapter.java:323)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.AbsListView.obtainView(AbsListView.java:1315)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.ListView.measureHeightOfChildren(ListView.java:1198)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.ListView.onMeasure(ListView.java:1109)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.view.View.measure(View.java:8171)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1012)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.LinearLayout.measureVertical(LinearLayout.java:381)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.LinearLayout.onMeasure(LinearLayout.java:304)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.view.View.measure(View.java:8171)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.widget.FrameLayout.onMeasure(FrameLayout.java:245)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.view.View.measure(View.java:8171)
08-30 12:52:00.437: E/AndroidRuntime(366):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
 ................ 
```

在查看异常时，我无法得到实际问题，但在查看我添加的日志时，我可以看到 Got View : -1 I beleive`View view = layoutInflater.inflate(R.layout.gen_list_layout, null);`有一些问题。它无法获得视图或类似的东西。

知道 View 可能有什么问题 - 为什么它没有获得布局视图？在布局或 inflate() 中对 b 进行了任何修改？

任何帮助都非常感谢..

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:51:10.167

您可以将 an`OnItemClickListener`作为参数传递给您的`createAlertDialog`方法。

创建者方法：

```
public AlertDialog createAlertDialog(Activity act, String title, String[] items, OnItemClickListener clickListener) {
LayoutInflater layoutInflater   = (LayoutInflater)this.getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
View view = layoutInflater.inflate(R.layout.gen_list_layout,null);

TextView titleTv = (TextView) view.findViewById(R.id.genListTitTv);
titleTv.setText(title);

ArrayAdapter<String> ad = new ArrayAdapter<String>(this, R.layout.list_item, R.id.genList, items);
ListView listView = (ListView) findViewById(R.id.genList);
listView.setAdapter(ad);
listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);

 // I WANT THIS TO BE HNDLED IN THE ACTIVITY CALLING    
listView.setOnItemClickListener(clickListener);

AlertDialog.Builder scrnDlg = new AlertDialog.Builder(act);
scrnDlg.setView(view);

final AlertDialog adg = scrnDlg.create();

return adg;
} 
```

您的活动：

```
OnItemClickListener clickListener = new OnItemClickListener() {
    public void onItemClick(AdapterView<?> arg0, View v, int position,  long id) {
         // Do some stuff in your activity's scope here. 
    }
}

AlertDialog ad = Components.createAlertDialog(RouteListActivity.this, title, items, clickListener); 
```

# xpages - Xpages 构建过程和复制

> ID：12182319
> 
> 赞同：3
> 
> 时间：2012-08-29T16:19:57.387
> 
> 标签：xpages

我想知道是否有人可以启发我一点关于 Xpages 构建过程以及它如何与数据库的其他副本副本一起使用。我看到的很多关于使用 Domino Designer 的建议都表明（逻辑上），在本地副本上工作，然后将它们复制到服务器上，您将获得更快的响应。

我通常会在本地保存我的更改，手动构建，然后复制到服务器，而且大多数时候，这似乎工作正常。但是，在某些情况下，我发现当我在服务器副本上查看我在浏览器中所做的工作时，它似乎并没有更新......实际上在一些可怕的事件中，它显示了一个几周前的版本（它甚至是从哪里得到的？？）。这不是浏览器缓存问题，我已经在服务器副本上打开了设计元素（xpages、自定义控件）并验证了更改是否存在。我最终不得不在应用程序的服务器副本（不仅仅是构建）上执行清理，然后它按预期显示。

这似乎是一个愚蠢的问题，但您不应该对每个副本执行构建，对吗？关于这里可能存在什么问题的任何想法？涉及到另一个开发人员，他直接在服务器上工作，因为他在同一个位置，但我们很少同时工作，而且从不在同一个元素上工作。我们目前没有使用源代码控制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T09:55:23.140

我们自己也看到过类似的行为。

在我们的例子中，我们在服务器上进行开发，清理/构建项目，然后将该数据库作为模板复制到部署服务器。从那里，我们更新生产数据库中的设计。

我们注意到构建过程有时会失败，尤其是在处理速度较慢的链接时。因此，我们总是重复几次清理/构建/刷新过程，并尝试在办公室时通过工作站和服务器之间的快速连接来执行此操作。

我们最近没有遇到过构建问题，因此重复构建过程显然会有所帮助。

我们还看到，在本地副本和服务器副本之间复制设计有时会导致与构建相关的问题，这可以解释您所看到的问题。因此，我们已经停止使用复制，现在总是直接在服务器副本上工作。

我认为您不使用源代码管理软件与此无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T06:42:24.027

我通常在本地模板中进行所有更改，然后执行“Project \ Clean”，然后更新服务器数据库中的设计。它适用于 99% 的情况。如果没有，我再次执行“Project \ Clean”。我讨厌这个，但看起来这是在生产中获得一致代码的唯一方法。

# html - IndexedDB 错误：在不允许突变的数据库上尝试了突变操作

> ID：12182320
> 
> 赞同：1
> 
> 时间：2012-08-29T16:19:58.717
> 
> 标签：html, indexeddb

```
console.log(db); //db object exists
console.log(db.objectStoreNames.contains('test')); //true - object store exists

var transaction = db.transaction(['test'], 'readwrite'); // this line is causing the error

A mutation operation was attempted on a database that did not allow mutations." code: "6 
```

为什么我会收到此错误？我的数据库和对象存储存在吗？我快疯了！:D 非常感谢任何帮助！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T16:30:03.747

I just try now on chrome, safari on Mac os x and found no error.

I do as follow on [http://dev.yathit.com/ydn-db/using/schema.html](http://dev.yathit.com/ydn-db/using/schema.html) (the page load ydn.db.Storage object)

```
schema = {stores: [{name: 'test'}]}
st = new ydn.db.Storage('test1', schema)
// ... wait for async
db = st.db()
db.transaction(['test'], 'readwrite') 
```

old chrome use 1 instead 'readwrite', but i don't think it a reason.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-02T09:40:35.330

有很多这样的错误发生。只有这篇文章[http://dev.opera.com/articles/introduction-to-indexeddb/](http://dev.opera.com/articles/introduction-to-indexeddb/)说明了原因-----“**使用 IndexedDB，我们数据库上的每个操作或事务都必须发生在回调函数**。”

这是我的简单示例，请使用 chrome 的 devtool->resource->indexedDB 进行检查；（如果 indexedDB 中没有任何内容，请尝试刷新浏览器）

html部分：

```
<form id="form1">
    <label for="task">What do you need to do?</label>
    <input type="text" name="task" id="task" value="" required>
    <button type="submit" id="submit">Save entry</button>
</form> 
```

脚本部分：

```
var idb = indexedDB.open('niangzi10', 2);
    var dbobject; // Define a global variable to hold our database object
    idb.onsuccess = function (evt) {
        console.log("success");
        if (dbobject === undefined) {
            dbobject = evt.target.result;
        }
    }
    idb.onupgradeneeded = function (evt) {
        dbobject = evt.target.result;
        if (evt.oldVersion < 1) {
            dbobject.createObjectStore('tasks', { autoIncrement: true });
        }
    }
    //transaction operation in callback function
    var form1 = document.getElementById('form1');
    form1.addEventListener('submit', function (evt) {
        'use strict';
        evt.preventDefault();

        var entry = {}, transaction, objectstore, request;
        entry = { name: document.querySelector("#task").value };

        // Open a transaction for writing
        transaction = dbobject.transaction(['tasks'], 'readwrite');
        objectstore = transaction.objectStore('tasks');
        // Save the entry object
        request = objectstore.add(entry);
        transaction.oncomplete = function (evt) {
            alert("'" + document.querySelector("#task").value + "'has been insert into indexedDB;please check it using chrome's devtool->resource->indexedDB(if nothing,refresh browser)；");
        };

    }); 
```

# jquery - 追加列表项计数jQuery

> ID：12182321
> 
> 赞同：0
> 
> 时间：2012-08-29T16:20:00.620
> 
> 标签：jquery, printing, count, append, populate

我正在使用它来根据多个选择框的值填充列表：

```
$(document).ready(function() {
    $("select").change(function() { // <-- bind change event handler to the drop downs
        var sel = "";
        $(".option-select option:selected").each(function() { // <-- then iterate each time it changes   
            if ($(this).index() !== 0) { // <-- only if not default
                sel += "<li>" + $(this).text() + "</li>";
            }
            $("ul.result ul").empty().append(sel); //<-- empty() to remove old list and update with new list
        });
    });
});​ 
```

但是，我不知道如何打印添加到列表中的选项数量，或选择值的选择框数量。我需要告诉用户他们选择了多少选项，并像我一样显示这些选项。我发现如何使用以下方法计算列表中的项目数：

```
var count = $("ul li").length; 
```

但无法弄清楚如何打印这个计数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:11:25.053

也许你想要这样的东西

```
$(document).ready(function() {
    $("select").change(function() {
        var list=$(this).children(':selected').not($(this).children()[0]);
        $('#result, #count').empty();
        if(list.length){
            list.each(function(){
                $('<li></li>').val($(this).val()).text($(this).text())
                .appendTo($('#result'));
                $('#count').html(list.length);
            });
        }
    });
}); 
```

[**演示**](http://jsfiddle.net/TAyPE/2/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:25:07.393

可以这样做

```
 $(document).ready(function() {
    $("select").change(function() { // <-- bind change event handler to the drop downs
        var sel = "";
        var counter = 0;
        $(".option-select option:selected").each(function() { // <-- then iterate each time it changes   
            if ($(this).index() !== 0) { // <-- only if not default
            {
                sel += "<li>" + $(this).text() + "</li>";
                counter++;
            }
            }    
            $("ul.result ul").empty().append(sel); //<-- empty() to remove old list and update with new list
        });
    });

//The Number of Option's Added
counter; 
```

或者只是将`enter code here`sel 转换为 Jquery

```
$(sel).length; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:26:58.663

我会制作一个元素并将值放在那里，如下所示：

```
<div id="count_holder">You have <span></span> options</div>
<script>
    $("#count_holder").find("span").text(count);
</script> 
```

# jquery - jquery插件.imagecube麻烦

> ID：12182328
> 
> 赞同：0
> 
> 时间：2012-08-29T16:20:15.233
> 
> 标签：jquery, html, plugins, effects

我正在使用[http://keith-wood.name/imageCube.html](http://keith-wood.name/imageCube.html)的 jquery 插件。

它是这样工作的，但是......

当我的页面加载列表中的第一个图像（AT_logo.png）时，它显示在我放置的正确位置，但是当 .imagecube 启动时它会移动。我注意到在它放入的 CSS 中，它的位置是绝对的，但我的图像在我的班级中浮动到左侧。

然后添加的“imagecubeshading”类最后不在图像之间，因此它像图像一样滚动浏览它们。

我的代码在底部。如果需要更多信息，请询问。

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script src="Scripts/imagecube.js" type="text/javascript"></script>

<script type="text/javascript">
$(document).ready(function () {
$('#logocube').imagecube();});
</script>

<div class="title_container">
    <div class="title_content1">
        <div class="title">title</div>
        <div class="sub_text">
            <a href="">Linked in</a>
            <b>Email</b>infp@email.com
        </div>
    </div>

    <div class="logo" id="logocube">
        <img src="images/AT_logo.png" title="logo"/>
        <img src="images/AT_logo_bl_gr.png" title="logo"/>
        <img src="images/AT_logo_bl_wh.png" title="logo"/>
        <img src="images/AT_logo_gr_wh.png" title="logo"/>
        <img src="images/AT_logo_wh_bl.png" title="logo"/>
        <img src="images/AT_logo_wh_gr.png" title="logo"/>
   </div>

    <div class="title_content2">
        <div class="title" style="float:right;;">title</div>
        <div class="sub_text" style="float:right;">sub text</div>
    </div>
</div> 
```

和CSS

```
.title_container
{
width:1265px;
height:380px;
margin-left:auto;
margin-right:auto;
position:relative;
background-color:transparent;
}

.title_content1
{
 width: 505px;
 height: 330px;
float: left;
background-image: url(/images/title_content_left.png);
background-repeat: no-repeat;
margin: 10px;
margin-top: 20px;
z-index:1;
}

.logo
{
width: 214px;
height: 198px;
float: left; 
margin-top: 40px;
margin-left: 162px;
margin-bottom: 72px;
z-index: 2;
position: absolute;
}

#logocube
{
width:214px;
height:198px;
}   

.title_content2
{
width: 505px; 
height: 330px;
float: right; 
background-image: url(/images/title_content_right.png);
background-repeat: no-repeat;
margin: 10px;
margin-top: 20px;
z-index:1;
} 
```

# php - 是否可以使用 PHP 与 Sagepay 虚拟终端集成？

> ID：12182331
> 
> 赞同：1
> 
> 时间：2012-08-29T16:20:23.507
> 
> 标签：php, terminal, virtual, opayo

我正在为客户创建 Sagepay Direct 实施，它处理存款和付款，以及退还存款。这对于在线支付来说很好，但客户也可以通过 Sagepay 的[虚拟终端](http://www.sagepay.com/telephone-payments)进行电话支付。我想通过我的系统处理这些付款，这将允许更高比例的退款自动化，但是，尽管搜索了 Sagepay 的资源、谷歌和 SO，我根本找不到任何与终端集成的信息。

所以，我想知道的是：

1.  是否有可能以这种方式进行整合，如果可以，我是否缺少一些资源？
2.  如果没有官方 API，Sagepay 是否会实施任何会阻止通过 CURL 或类似技术实现流程自动化的东西。

我以前使用过 Sagepay（直接和表单），对在线支付方面非常熟悉，但对终端不熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T10:47:36.677

好的，所以我与 Sagepay 支持人员进行了交谈，答案比我预期的要简单得多。我不需要与终端集成，我只需使用标准集成并将 AccountType 的值更改为“M”。

# castle-windsor - 缺少 WcfFacility

> ID：12182336
> 
> 赞同：0
> 
> 时间：2012-08-29T16:20:36.487
> 
> 标签：castle-windsor, windsor-facilities

我正在寻找应该在 Castle.Facilities.WcfIntegration 中的 WcfFacility。

情况有变化吗？它在哪里？我有最新的城堡（3.1 版）。

问题与此链接有关：

[城堡 wcf 集成](http://www.darkside.co.za/archive/2012/05/30/castle-windsor-wcf-self-hosted.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T21:31:10.583

我假设你问的是[你下载的包](http://www.castleproject.org/download/)在哪里？在那里。![WCF 设施，就在那里](../Images/e85db71de681af4f5555017097403b3f.png)

或者你的意思是[nuget包](http://nuget.org/packages/Castle.WcfIntegrationFacility)

# ios - 滑动删除不适用于从左到右滑动

> ID：12182337
> 
> 赞同：2
> 
> 时间：2012-08-29T16:20:42.567
> 
> 标签：ios, uitableview, ipad, swipe

我的 iPad 应用程序中的滑动删除有一个奇怪的问题。我在 UIViewController 中托管了一个 UITableView 控件。UIViewController 托管在 UISplitViewController 的“主”窗格中。我已经实现了 commitEditingStyle 来获得滑动删除功能，如果我从右向左滑动我会出现“删除”按钮，这工作正常。但是当应用程序处于横向模式时，从左到右的滑动不会被检测到。在纵向模式下，它工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:38:28.777

发现这是因为我在 UISplitViewController 上将 PresentWithGesture 设置为 YES - 这会影响在横向模式下从左到右的滑动。

# c# - LINQ to SharePoint 2010 出现错误“必须在提交更改之前添加/附加对象图中的所有新实体。”

> ID：12182339
> 
> 赞同：2
> 
> 时间：2012-08-29T16:20:45.610
> 
> 标签：c#, linq, sharepoint, sharepoint-2010

我遇到问题已经有一段时间了，我已经用尽了所有方法来为自己解决这个问题。

我在 MS Sharepoint 2010 环境中有 2 个列表，其中包含医疗组的个人医生数据……没什么特别的，主要是文本字段和一些查找选择字段。

我正在尝试编写一个程序，将数据从列表 A 迁移到列表 B。我正在使用 LINQ to Sharepoint 来完成此操作。一切都编译得很好，但是当它运行并点击 SubmitChanges() 方法时，我收到一个运行时错误，指出：

“必须在提交更改之前添加/附加对象图中的所有新实体。”

这个问题一定超出了我的 C# 知识范围，因为我根本找不到解决方案。问题肯定源于某些列属于“查找”类型的事实，因为当我在 LINQ 查询中创建新的“医师”实体时，如果我注释掉处理查找列的字段，一切都会运行完美。

在包含查找列的情况下，如果我在 SubmitChanges() 方法之前调试并点击断点，我可以查看从旧列表创建的新“医师”实体和字段，包括查找列中的数据，看起来不错，数据以我想要的方式在那里，每当它尝试用新实体实际更新新列表时，它就会消失。

我尝试了几种解决此错误的方法，但均无济于事。特别是，我尝试创建一个全新的 EntityList 列表并在创建每个新的“医师”实体后调用 Attach() 方法，但无济于事，它只是让我绕着一堆圈子，追逐其他错误，例如“ID 不能为空”、“不能插入已删除的实体”等，

我现在不比我第一次遇到此错误时更进一步，任何人都可以提供的任何帮助肯定会受到赞赏。

这是我的代码：

```
using (ProviderDataContext ctx = new ProviderDataContext("http://dev"))
        {

            SPSite sitecollection = new SPSite("http://dev");
            SPWeb web = sitecollection.OpenWeb();
            SPList theOldList = web.Lists.TryGetList("OldList_Physicians");

             //Create new Physician entities.
                    foreach(SPListItem l in theOldList.Items)
                    {
                        PhysiciansItem p = new PhysiciansItem()
                        {
                            FirstName = (String)l["First Name"],
                            Title = (String)l["Last Name"],  
                            MiddleInitial = (String)l["Middle Init"],
                            ProviderNumber = Convert.ToInt32(l["Provider No"]),
                            Gender = ConvertGender(l),
                            UndergraduateSchool =(String)l["UG_School"],
                            MedicalSchool = (String)l["Med_School"], 
                            Residency = (String)l["Residency"],
                            Fellowship = (String)l["Fellowship"], 
                            Internship = (String)l["Internship"],    
                            PhysicianType = ConvertToPhysiciantype(l),
                            Specialty = ConvertSpecialties(l),
                            InsurancesAccepted = ConvertInsurance(l),
                        };
                   ctx.Physicians.InsertOnSubmit(p);
                    }

                    ctx.SubmitChanges(); //this is where it flakes out
        }
    }

     //Theses are conversion functions that I wrote to convert the data from the old list to the new lookup columns.

    private Gender ConvertGender(SPListItem l)
    {
        Gender g = new Gender();
        if ((String)l["Sex"] == "M")
        {
            g = Gender.M;
        }
        else g = Gender.F;
        return g;

    }

    //Process and convert the 'Physician Type', namely the distinction between MD (Medical Doctor) and 
    //DO (Doctor of Osteopathic Medicine).  State Regualtions require this information to be attached 
    //to a physician's profile.
    private ProviderTypesItem ConvertToPhysiciantype(SPListItem l)
    {
        ProviderTypesItem p = new ProviderTypesItem();
        p.Title = (String)l["Provider_Title:Title"];
        p.Intials = (String)l["Provider_Title"];

        return p;
    }

    //Process and convert current Specialty and SubSpecialty data into the single multi-choice lookup column
    private EntitySet<Item> ConvertSpecialties(SPListItem l)
    {
        EntitySet<Item> theEntityList = new EntitySet<Item>();
        Item i = new Item();
        i.Title = (String)l["Provider Specialty"];
        theEntityList.Add(i);            

        if ((String)l["Provider SubSpecialty"] != null)
        {
            Item theSubSpecialty = new Item();
            theSubSpecialty.Title = (String)l["Provider SubSpecialty"];
            theEntityList.Add(theSubSpecialty);
        }

        return theEntityList;
    }

    //Process and add insurance accepted.
    //Note this is a conversion from 3 boolean columns in the SP Environment to a multi-select enabled checkbox
    //list.
    private EntitySet<Item> ConvertInsurance(SPListItem l)
    {
        EntitySet<Item> theEntityList = new EntitySet<Item>();
           if ((bool)l["TennCare"] == true)
                {
                    Item TenncareItem = new Item();
                    TenncareItem.Title = "TennCare";
                    theEntityList.Add(TenncareItem);

                }
         if ((bool)l["Medicare"] == true)
                {
                    Item MedicareItem = new Item();
                    MedicareItem.Title = "Medicare";
                    theEntityList.Add(MedicareItem);
                }
         if ((bool)l["Commercial"] == true)
                {
                    Item CommercialItem = new Item();
                    CommercialItem.Title = "Commercial";
                    theEntityList.Add(CommercialItem);
                }
         return theEntityList;

   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:33:51.173

所以这可能不是您正在寻找的答案，但它是过去对我有用的。我发现使用 Linq to Sharepoint 更新查找字段非常令人沮丧。它经常不起作用，或者不能有效地工作（迫使我通过 ID 查询项目只是为了设置查找值）。

您可以设置实体，使其具有用于查找 id 的 int 属性（对于每个查找字段）和用于查找值的字符串属性。如果，当您使用 SPMetal 生成实体时，您没有生成正在查找的列表，那么它将自行执行此操作。我喜欢做的是（以你的实体为例）

1.  `Physicians`为某个临时文件夹中的一个列表 ( ) 生成实体
2.  为每个查找（或我感兴趣的查找）提取查找 id 和值的属性（也将有私有的支持字段，也需要随之而来）
3.  在我的实际项目文件中创建一个部分类文件`Physicians`，以便正常重新生成整个 SPMetal 文件（不限于该列表）不会覆盖更改
4.  将查找 id 和值属性粘贴到此部分`Physicians`类中。

现在，每个查找字段都有 3 个属性。例如，因为`PhysicianType`会有：

*   `PhysicianType`，这是当前存在的那个。这在查询数据时非常有用，因为您可以非常轻松地执行连接等。
*   `PhysicianTypeId`如果您只需要 ID，这有时对查询很有用，因为它使它更简单一些，但大多数情况下，我在设置值时都会使用它。要设置查找字段，您**只需设置 ID**。这很容易，并且根据我的经验，在实际工作（正确）方面有着良好的记录。
*   `PhysicianTypeValue`如果您只需要查找值作为字符串，这在执行查询时可能很有用（这意味着它将是原始值，而不是如果它是多值字段或用户字段等已经解析的东西。有时我'我宁愿自己解析它，或者只是在开发时看看底层价值是什么。即使你不使用它并使用第一个属性，我也经常随身携带它，因为我已经做了大部分努力把这个`PhysicianTypeId`领域带过来。

这似乎有点 hacky，并且与 linq-to-SharePoint 的一般设计相反。我同意，但它也具有实际工作的优点，并且实际上并不那么难（一旦你掌握了它的节奏并了解了究竟需要复制什么以将属性从一个文件移动到另一个文件）。

# java - 如何在活动中创建的布局中添加背景图像

> ID：12182340
> 
> 赞同：0
> 
> 时间：2012-08-29T16:20:48.137
> 
> 标签：java, android, image, background

我在 java 代码中创建了一个 LinearLayout，但我不知道如何添加图像背景。

这是我为 LinearLayout 编写的代码：

```
LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(1);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    /** Create a new layout to display the view */
    LinearLayout layout = new LinearLayout(this);
    layout.setOrientation(1); 

    TextView variacion[];

     try {

        /** Handling XML */
        SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();

        /** Send URL to parse XML Tags */
        URL sourceUrl = new URL("http://www.bovalpo.com/cgi-local/xml_bcv.pl?URL=75");

        /** Create handler to handle XML Tags ( extends DefaultHandler ) */
        MyXMLHandler myXMLHandler = new MyXMLHandler();
        xr.setContentHandler(myXMLHandler);
        xr.parse(new InputSource(sourceUrl.openStream()));

        } catch (Exception e) {
            System.out.println("XML Pasing Excpetion = " + e);
        }

    /** Get result from MyXMLHandler SitlesList Object */
    sitesList = MyXMLHandler.sitesList;

    /** Assign textview array lenght by arraylist size */
    registro = new TextView[sitesList.getRegistro().size()];
//    nemotecnico = new TextView[sitesList.getNemotecnico().size()];
    variacion = new TextView[sitesList.getVariacion().size()];

   //category = new TextView[sitesList.getName().size()];

    /** Set the result text in textview and add it to layout */
    for (int i = 0; i < sitesList.getRegistro().size(); i++) {

        variacion[i] = new TextView(this);
        variacion[i].setText(sitesList.getVariacion().get(i));

        Pattern pattern = Pattern.compile("^\\+?[0-9]+([,\\.][0-9]*)?$");
        Matcher matcher = pattern.matcher(sitesList.getVariacion().get(i));
        if (!matcher.matches())

        variacion[i].setTextColor(Color.parseColor("#ff0000"));
        else
        variacion[i].setTextColor(Color.parseColor("#008000")); 

       layout.addView(variacion[i]);
    }   
    /** Set the layout view to display */
   setContentView(layout);

}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:23:24.220

采用：

```
 LinearLayout layout = new LinearLayout(this);
 layout.setOrientation(1);
 layout.setBackgroundResource(R.drawable.background); 
```

文件夹`background`中的背景图片在哪里。`res`

# mysql - 选择查询有效，删除无效？

> ID：12182352
> 
> 赞同：1
> 
> 时间：2012-08-29T16:21:05.583
> 
> 标签：mysql

我开发了一个查询来清除除最近添加的行之外的所有行，基于存储为文本的字段 -> 时间戳和用户 ID 字段。

还涉及到不断变化的日期格式，因此也涉及到一些合并。

这是删除查询->

```
DELETE
FROM `table` main
WHERE COALESCE(STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CDT %Y' ), STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CST %Y' )) <
  (SELECT  MAX(COALESCE(STR_To_DATE( sub.Timestamp , '%a %b %d %H:%i:%s CDT %Y' ), STR_To_DATE( sub.Timestamp , '%a %b %d %H:%i:%s CST %Y' ))) 
  FROM `table` sub
  WHERE sub.Retrieving_User = main.Retrieving_User ) 
```

这不运行，抛出此错误->

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'main WHERE COALESCE(STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CDT %Y' ),' at line 2 
```

我明白这是什么，只是不明白为什么会发生。如果我将查询更改为选择 ->

```
SELECT *
FROM `table` main
WHERE COALESCE(STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CDT %Y' ), STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CST %Y' )) <
  (SELECT  MAX(COALESCE(STR_To_DATE( sub.Timestamp , '%a %b %d %H:%i:%s CDT %Y' ), STR_To_DATE( sub.Timestamp , '%a %b %d %H:%i:%s CST %Y' ))) 
  FROM `table` sub
  WHERE sub.Retrieving_User = main.Retrieving_User ) 
```

它正确地抓取了我要删除的所有数据。

请告诉我，我不必更改查询的格式，因为我已经花了整个上午的时间。:(

编辑：

我通过研究发现，您无法从子查询中使用的同一个表中删除。所以我要为此创建一个很长的解决方法......稍后会更新......

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-29T16:27:33.750

```
DELETE from `table` where COALESCE(STR_To_DATE( Timestamp , '%a %b %d %H:%i:%s CDT %Y' ), STR_To_DATE( Timestamp , '%a %b %d %H:%i:%s CST %Y' )) in
(
SELECT COALESCE(STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CDT %Y' ), STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CST %Y' ))
FROM `table` main
WHERE COALESCE(STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CDT %Y' ), STR_To_DATE( main.Timestamp , '%a %b %d %H:%i:%s CST %Y' )) <
(SELECT  MAX(COALESCE(STR_To_DATE( sub.Timestamp , '%a %b %d %H:%i:%s CDT %Y' ), STR_To_DATE( sub.Timestamp , '%a %b %d %H:%i:%s CST %Y' ))) 
FROM `table` sub
WHERE sub.Retrieving_User = main.Retrieving_User)
) 
```

# c# - System.IO.DirectoryNotFoundException：找不到使用正确语法的路径的一部分

> ID：12182353
> 
> 赞同：0
> 
> 时间：2012-08-29T16:21:05.783
> 
> 标签：c#, asp.net

我后面有一个asp页面c#代码。

我正在尝试使用此行保存到服务器

```
File.Delete(@"C:\Webroot\Intranet\Intranet\Sales\Agreements_Marketing\test.xlsx"); 
```

我知道这是一个有效的路径和一个有效的文件，因为我可以在服务器上看到它。

我不明白为什么我会收到这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:40:12.560

这可能是因为不允许应用程序池用户（默认情况下，出于充分的理由，具有非常有限的权限）不允许查看该文件。

# objective-c - 施加特定的输入法

> ID：12182357
> 
> 赞同：0
> 
> 时间：2012-08-29T16:21:15.920
> 
> 标签：objective-c, ios, cocoa, input, handwriting

在一个应用程序中，我希望有一个文本字段，其中输入法总是应该是手写的简体中文，即使用户可能甚至没有在设置中激活这个输入法。

有没有办法强加特定的输入法？ `UITextField`有一个`inputView`可用于自定义输入视图的属性，也可以抓取现有输入法的视图并将其设置为`inputView`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T11:34:25.017

答案是不可能的，正如 phix23 在评论中所写的那样。唯一的选择是创建我自己的[自定义输入视图](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/InputViews/InputViews.html)。

# delphi - Embarcadero FireMonkey 3D 摄像机旋转和缩放

> ID：12182359
> 
> 赞同：2
> 
> 时间：2012-08-29T16:21:25.610
> 
> 标签：delphi, firemonkey

我在 FireMonkey 3D 中搜索相机旋转和缩放的示例。就像使用鼠标左键围绕场景旋转相机并使用鼠标滚轮放大和缩小一样。

有谁能够帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-04T22:56:36.650

下面的表格显示了一个简单的演示，只需保存 .fmx 和 .pas 文件并将表格添加到 FMX 应用程序。关键部分是将相机和嵌套的灯光对象放在单独的 X 和 Y 轴上，以作为相机目标的 DummyObject。将 X 和 Y 作为单独的虚拟对象使旋转垂直和水平，这在某些情况下是可取的。您还可以将 DummyX 和 DummyY 对象合并为单个 DummyXY 对象，这将提供更真实的世界旋转样式，但取决于您的需要，哪个更可取。

MainForm.pas：

```
unit MainForm;

interface

uses
  FMX.Forms, FMX.Materials, System.Math.Vectors, FMX.Types3D, FMX.Objects3D, FMX.Controls3D, FMX.Viewport3D,
  System.Classes, FMX.Types, FMX.Controls, FMX.Layouts, FMX.MaterialSources, System.Types, System.UITypes;

type

  TForm1 = class(TForm)
    Viewport3D: TViewport3D;
    DummyX: TDummy;
    DummyObject: TDummy;
    CameraZ: TCamera;
    Light1: TLight;
    LayoutMain: TLayout;
    DummyY: TDummy;
    Cone1: TCone;
    LightMaterialSource1: TLightMaterialSource;
    procedure Viewport3DMouseDown(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Single);
    procedure Viewport3DMouseMove(Sender: TObject; Shift: TShiftState; X, Y: Single);
    procedure Viewport3DMouseWheel(Sender: TObject; Shift: TShiftState; WheelDelta: Integer; var Handled: Boolean);
  private
    FDown: TPointF;
    procedure DoZoom(aIn: Boolean);
  public
  end;

var
  Form1: TForm1;

implementation

{$R *.fmx}

const
  CAMERA_MAX_Z = -2;
  CAMERA_MIN_Z = -200;
  ZOOM_STEP = 2;

procedure TForm1.DoZoom(aIn: Boolean);
var
  newZ: Single;
begin
  if aIn then
    newZ := CameraZ.Position.Z + ZOOM_STEP
  else
    newZ := CameraZ.Position.Z - ZOOM_STEP;

  if (newZ < CAMERA_MAX_Z) and (newZ > CAMERA_MIN_Z) then
    CameraZ.Position.Z := newZ;
end;

procedure TForm1.Viewport3DMouseDown(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Single);
begin
  FDown := PointF(X, Y);
end;

procedure TForm1.Viewport3DMouseMove(Sender: TObject; Shift: TShiftState; X, Y: Single);
begin
  if (ssLeft in Shift) then
  begin
    DummyX.RotationAngle.X := DummyX.RotationAngle.X - ((Y - FDown.Y) * 0.3);
    DummyY.RotationAngle.Y := DummyY.RotationAngle.Y + ((X - FDown.X) * 0.3);
    FDown := PointF(X, Y);
  end;
end;

procedure TForm1.Viewport3DMouseWheel(Sender: TObject; Shift: TShiftState; WheelDelta: Integer; var Handled: Boolean);
begin
  DoZoom(WheelDelta > 0);
end;

end. 
```

MainForm.fmx:

```
object Form1: TForm1
  Left = 0
  Top = 0
  Caption = 'Form1'
  ClientHeight = 592
  ClientWidth = 713
  FormFactor.Width = 320
  FormFactor.Height = 480
  FormFactor.Devices = [Desktop]
  DesignerMasterStyle = 0
  object LayoutMain: TLayout
    Align = Client
    Size.Width = 713.000000000000000000
    Size.Height = 592.000000000000000000
    Size.PlatformDefault = False
    TabOrder = 2
    object Viewport3D: TViewport3D
      Align = Client
      Camera = CameraZ
      Size.Width = 713.000000000000000000
      Size.Height = 592.000000000000000000
      Size.PlatformDefault = False
      UsingDesignCamera = False
      OnMouseDown = Viewport3DMouseDown
      OnMouseMove = Viewport3DMouseMove
      OnMouseWheel = Viewport3DMouseWheel
      object DummyX: TDummy
        Width = 1.000000000000000000
        Height = 1.000000000000000000
        Depth = 1.000000000000000000
        object DummyY: TDummy
          Width = 1.000000000000000000
          Height = 1.000000000000000000
          Depth = 1.000000000000000000
          object CameraZ: TCamera
            AngleOfView = 45.000000000000000000
            Target = DummyObject
            Position.Z = -20.000000000000000000
            Width = 1.000000000000000000
            Height = 1.000000000000000000
            Depth = 1.000000000000000000
            object Light1: TLight
              Color = claWhite
              LightType = Directional
              SpotCutOff = 180.000000000000000000
              Width = 1.000000000000000000
              Height = 1.000000000000000000
              Depth = 1.000000000000000000
            end
          end
        end
      end
      object DummyObject: TDummy
        Width = 1.000000000000000000
        Height = 1.000000000000000000
        Depth = 1.000000000000000000
        object Cone1: TCone
          Width = 1.000000000000000000
          Height = 1.000000000000000000
          Depth = 1.000000000000000000
          SubdivisionsCap = 3
          MaterialSource = LightMaterialSource1
        end
      end
    end
  end
  object LightMaterialSource1: TLightMaterialSource
    Diffuse = claWhite
    Ambient = xFF202020
    Emissive = claNull
    Specular = xFF606060
    Shininess = 30
    Left = 436
    Top = 56
  end
end 
```

我从某个地方的演示中提取了这个，但非常适合我的需求。应该适用于 Delphi XE5 及更高版本。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-20T12:59:50.013

您可以通过拖动旋转相机并使用滚轮进行缩放。重要的是，不同轴上的旋转都应该在不同的嵌套对象上处理，以便旋转计算应该像我们在现实世界中所期望的那样相互影响。

# database - 我如何在 neo4j 中编写遍历查询（gremlin/cypher 之一）？

> ID：12182361
> 
> 赞同：0
> 
> 时间：2012-08-29T16:21:31.777
> 
> 标签：database, neo4j, traversal, tree-traversal

Perferbly gremlin，但任何一个都可以；

我将节点存储在形成树状结构的数据库中。示例：/dir/inside_dir/alaskan-natives/story1

节点附加了一个名为**HAS_CHILD_NODE**的关系（如果向每个关系添加属性以加快查询或使其更合乎逻辑，请告诉我这一点更有效）。每个节点只能有一个父关联。在**一个**查询中 - 从我的应用程序中删除所有*循环*它的自身 - 我如何**遍历**每条*路径*只是为了获得指定的路径，直到我们达到*最终结果。*

假设我已经在“/”处进行了拼接，现在我们有一个可以附加到查询的层次项数组。

```
var array = ['dir', 'inside_dir', 'alaskan-natives', 'story1']; 
```

请记住，这必须是一个***动态查询***，允许沿树遍历任意数量的项目，并且具有交换层次名称的能力。请尝试并优化它。

只是一个简单的树来帮助理解；这与我的情况无关。 ![请查看此树示例](../Images/54934fd9ad6c73fd5fbdea3cc735a893.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T08:24:15.407

包含在 Neo4j 的邮件列表中，[https: //groups.google.com/group/neo4j/](https://groups.google.com/group/neo4j/)

# javascript - jQuery $(this) 引用未定义

> ID：12182362
> 
> 赞同：0
> 
> 时间：2012-08-29T16:21:37.423
> 
> 标签：javascript, jquery, this

我有一段 javascript 用于跟踪表单参与度。我使用 $(this) 将对象传递给脚本中的两个函数，但我接下来的几行代码没有执行，因为 Chrome 说“无法读取未定义的属性‘长度’。为什么我不能使用 $(this ) 参考了？

```
$('select').blur(function () {

                var input_category = get_input_category($(this));

                var form_identifier = get_form_identifier($(this));

                if($(this).attr('name').length) {
// This is where I get the error ^^
                    var object_identifier = $(this).attr('name');
                }
                else if($(this).attr('id').length) {
                    var object_identifier = $(this).attr('id');
                }
                else if($(this).attr('class').length) {
                    var object_identifier = $(this).attr('class');
                }
                else {
                    var object_identifier = null;
                }
}); 
```

编辑：选择框没有附加名称值。

```
 <select type="select">
                          <option value="volvo">Volvo</option>
                          <option value="saab">Saab</option>
                          <option value="mercedes">Mercedes</option>
                          <option value="audi">Audi</option>
                        </select> 
```

但这不是我的脚本要寻找的吗？如果它没有名字，我希望它继续前进。如何在不出错的情况下检查属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:27:33.900

正如 Vega 所看到的，问题在于`attr('name')`价值。

不要检查对象的长度来检查它是否已定义，因为当没有可以获取长度的对象时，这会引发错误。

只需使用通常的 js 模式检查它是否已定义并具有非空值：

```
if ($(this).attr('name')) 
```

代替

```
if ($(this).attr('name').length) 
```

请注意，第一个测试也检查 this is not `""`。因此，绝对没有理由同时检查对象是否已定义`""`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:29:48.600

从你所说的来看，在我看来你需要添加一些条件检查..试试下面，

```
$('select').blur(function () {

    var $this = $(this);
    var input_category = get_input_category($this);
    var form_identifier = get_form_identifier($this);

    var object_identifier = null;
    if(this.name) {
        object_identifier = this.name
    } else if(this.id) {
        object_identifier = this.id
    } else if(this.className) {
        object_identifier = this.className
    } 
}); 
```

# hl7 - 通过 Internet 交换 HL7 消息

> ID：12182364
> 
> 赞同：9
> 
> 时间：2012-08-29T16:21:54.920
> 
> 标签：hl7

我们是使用 HL7 的新手。目前，我们正在通过 TCP/IP 与标准 HL7 TCP/IP 侦听器/发送器交换 HL7 消息。这一切都很好，不会造成任何问题，但我们是一个托管的 EMR，我们必须在我们的服务器上创建和维护 VPN 才能做到这一点。

我的问题是这个。我们有没有办法绕过 VPN 并通过互联网 (HTTPS) 与我们的 Web 服务交换 HL7 消息？？？

我已经搜索和搜索，但我无法以一种或另一种方式找到任何答案。并且请不要对 HL7 版本 3 进行任何处理，因为 NOBODY 实际上似乎在使用它。我的客户都在使用 HL7 版本 2.3 到 2.5，已经使用了多年并且没有表现出改变的倾向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T14:26:51.720

是的，您现在可以使用一个可用的解决方案。另一个答案是正确的，通过互联网交换 HL7 的问题不是因为它很困难，而是因为 a) HL7 版本 2.xx 和 b) 没有（也永远不会）互联网“标准”） HL7 是双向对话，您无法控制双方。这意味着，如果您设计了自己的 Web 服务并且它运行良好，并且如果您确实找到愿意与您交换 HL7 的人，那么他们设计自己的漂亮 Web 服务的可能性甚至可能是他们希望您适应的，并且利用。

该解决方案必须是您可以单方面实施的解决方案，而无需您的 HL7 贸易伙伴更改其通常的 HL7 接口方法之外的任何内容。

看看[UltraPort HL7 Postmaster](http://www.hermetechnz.com/EasyHL7/Prod_FSPM.asp)

它实际上通过实现双接口解决了这个问题。一个是“向内指向”HL7 标准 TCP/IP 或基于文件的接口，第二个是“向外指向”自定义接口，可直接与您的 HL7 Web 服务交互。他们甚至会为您提供 ASP.Net shell 模板，以帮助您构建 Web 服务的“前门”。我曾与两个客户合作过，他们能够编译供应商提供的 DEMO Web 服务并将其发布到他们的测试服务器，并在不到 20 分钟的时间内运行。

它在在线帮助[Click Here](http://www.hermetechnz.com/documentation/UltraPort/FSPM/common_use_scenarios.htm)中有更详细的说明。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T20:57:14.983

对于大多数医疗保健组织来说，互联网上的 HL7 是相当新的。如果您想降低复杂性并完全独立于客户端系统和/或基础设施，恐怕 VPN 是您的最佳选择。人们信任它，而且部署起来相当容易。

如果您想摆脱 VPN 策略，向您发送 HL7 消息的系统必须能够将它们包装在 HTTPS 请求（或其他一些安全协议）中。很少有临床系统具有这种现成的协议调解功能。如果您将集成引擎添加到等式中，它将帮助您将 TCP 和 LLP 转换为 HTTPS 通信。您可以将此集成功能作为解决方案组件部署在客户站点，但通常会引入新的复杂性和成本。

如果您找到可行的替代方案，请告诉我…… ;-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T12:40:33.603

You might be able to use two instances of Mirth, as a HTTPS "relay". Inbound HL7 from system A, outbound thru HTTPS. Then the other way around. It should be possible to make this setup fairly transparent to the involved systems.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-22T22:56:58.677

Cloak Labs 有一个软件[HL7 安全解决方案](http://www.cloaklabs.com/secure-hl7 "解决方案")来解决企业之间安全传递 HL7 消息的问题。我们基本上采用 HL7 消息并在发送端对其进行加密（使用 AES256 和 RSA 保护的密钥，整个过程使用 RSA/SHA 签名）。消息通过 CloudPrime 冗余传递，并作为存储和转发消息路由到接收器，以便消息传递可以变为异步而不是同步。这消除了许多常见的错误来源（VPN 关闭或接收端关闭）。

与 HL7 的集成是通过特定于协议的 HL7*连接器*完成的，只需要很少的时间。无需添加额外的入站防火墙规则。密钥仅存在于端点上，因此除了发送者和接收者之外，没有人可以读取消息，甚至 Cloak Labs 的工程师或系统管理员也无法读取消息。端点只能与其他受信任的元素进行通信，以阻止任何类型的 DNS 攻击。

本质上，两个不同企业的应用程序可以安全地相互发送消息，而无需更改网络或新的 VPN。Cloak Labs 将为其服务签署 BAA 协议。

全面披露，我是 Cloak Labs 的首席执行官。我希望你觉得这有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-10T17:58:35.907

HAPI / HL7 社区最近发起了一项倡议，以指定 HL7 v2 消息应如何通过 HTTP(S) 传递。请参阅[http://hl7api.sourceforge.net/hapi-hl7overhttp/](http://hl7api.sourceforge.net/hapi-hl7overhttp/)了解更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-26T14:32:40.090

我建议在某些 Linux 发行版中设置 SFTP 服务器来上传消息。在两年内，需要加密协议才能拥有符合 HIPPA 的软件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-29T21:08:14.493

我们的安全人员建议在客户端和接收器上都进行 ssh 端口转发。在典型的接口引擎上部署没有顺利的方法。需要从侦听器端将公共 rsa 密钥共享给 hl7 tcp 发送者，并使用生成的 ssh 连接来推送 HL7 有效负载（带加密）。为此，发送方和侦听方都需要大量端口转发 ssh 守护进程。

菲尔 - 芝加哥大学医学院。

# python - 匹配包含撇号的字符串的问题

> ID：12182368
> 
> 赞同：1
> 
> 时间：2012-08-29T16:22:18.233
> 
> 标签：python, regex

我想在一些括号内匹配一个字符串。我的字符串可能有一些撇号。我正在使用以下模式进行匹配，但这并没有拾取字符串，我真的不明白为什么 - 任何想法？

```
pattern = re.compile('<([\w\s\']+)>', re.IGNORECASE) 
```

例如，`<Let's rock!>`会产生`Let's rock!`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T16:25:02.143

你没有撇号问题，你有一个感叹号问题。感叹号既不是单词 ( `\w`) 也不是空格 ( `\s`) 也不是撇号。`!`所以如果你想允许的话，你应该添加到你的角色类中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T16:24:54.357

你不能用一个简单的`.`，例如，逃脱`'<(.+)>'`吗？

此外，如果您需要在字符串中嵌入单引号，则通常不使用单引号会更容易，例如`"<([\w\s']+)>"`.

# r - 具有交互作用的线性回归图

> ID：12182373
> 
> 赞同：4
> 
> 时间：2012-08-29T14:57:01.217
> 
> 标签：r, regression, interaction

我需要创建以下公式的线性回归图，但我不明白在 R 中哪种方法是正确的：

```
lm.velocity_vs_Velocity_response = lm(scrd$Velocity~scrd$Velocity_response*scrd$Subject) 
```

scrd 是我的数据集，可以在这里下载：[https ://dl.dropbox.com/u/3288659/Velocity_vs_Velocity.csv](https://dl.dropbox.com/u/3288659/Velocity_vs_Velocity.csv)

对应于实验的数据集包含 2 个变量（Velocity 和 Velocity_response），我想知道两者之间是否存在线性相关性。假设第一个是在 4 种地形条件（雪、木头、砾石和“无声音”的材料）下行驶的汽车的速度，第二个是导体的感知速度。在实验中，4 个条件由 10 名参与者重复两次，在实验结束时，他们必须评估他们在这些条件下驾驶时的感知速度。在视觉模拟量表上进行评估，其中 0 = 非常慢，10 = 非常快。因此，我的回归中有 80 分（10 名参与者 * 2 次试验 * 4 次速度估计）。然而，在数据集中，我决定对 2 次试验的性能进行平均。

我用来进行回归的公式的输出，

```
 summary(lm.velocity_vs_Velocity_response) 
```

是

```
Residual standard error: 0.08377 on 20 degrees of freedom
Multiple R-squared:  0.91,  Adjusted R-squared: 0.8245 
F-statistic: 10.64 on 19 and 20 DF,  p-value: 1.085e-06 
```

从中我得出结论，两个变量之间存在很强的相关性（R^2 = 0.91 和 p 值 < 0.001）

现在，我想看到拟合这些数据的线性回归的线。它是如何在 R 中完成的？哪个是正确的公式？任何人都可以提供R中的代码示例吗？

问题是使用 plot 我得到一堆点，我看不到线性趋势。

在这里，我发布数据集的第一行

```
Subject     Material    Velocity    Velocity_response
Subject1    no_sound    1.41        7.8
Subject1    snow        1.255       4
Subject1    gravel      1.32        5.3
Subject1    wood        1.335       5.4
Subject2    no_sound    1.435       10
Subject2    snow        1.265       1.7
Subject2    gravel      1.3         8.5
Subject2    wood        1.355       5.3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T15:59:52.470

如果你像这样运行 lm ，你的生活会容易得多：

```
lm.velocity_vs_Velocity_response <- lm(Velocity~Velocity_response*Subject, data=scrd) 
```

然后查看TeachingDemos 包中的`Predict.Plot`和函数来探索关系和交互。`TkPredict`

# javascript - 请有人修复此 SHOW/HIDE Table Javascript 代码

> ID：12182382
> 
> 赞同：0
> 
> 时间：2012-08-29T16:22:57.503
> 
> 标签：javascript, html-table, hide, dreamweaver, show

**请有人修复此 Javascript 代码。**

该脚本实际上读取 URL 参数，然后根据参数显示/隐藏表行。

我在 Sack Overflow 上找到了这个脚本，但是在 Dreamweaver 上尝试它时，它不起作用..

请有人通过脚本并修复其中的错误....

脚本是：这里有两页......

首先是`First_page.html`：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>
<a href="Second_page.html?showid=tblRow14">First Row</a><br />
<a href="Second_page.html?showid=tblRow46">Second Row</a><br />
<a href="Second_page.html?showid=tblRow30">Third Row</a><br />
</body>
</html> 
```

如下`Second_page.html`：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<head>
<style>
#theTable>tbody>tr { display: none; } //hide rows by default
</style>
<script type="text/javascript">
function getUrlVar(varName) { //returns empty string if variable name not found in URL
  if (!varName) return ''; //no variable name specified. exit and return empty string

  varName = varName.toLowerCase(); //convert to lowercase
  var params = location.search; //get URL

  if (params == '') return ''; //no variables at all. exit and return empty string

  var vars = params.split('?')[1].split('&'); //get list of variable+value strings

  for (var i = 0; i < vars.length; i++) { //check each variable
   var varPair = vars[i].split('='); //split variable and its value

   if (varPair.length > 1) { //has "=" separator

     if (varPair[0].toLowerCase() == varName) { //same variable name?
       return varPair[1]; //found variable. exit and return its value
     } //else: check next variable, if any

   } //else: is not an array. i.e.: invalid URL variable+value format. ignore it
  }
  return ''; //no matching variable found. exit and return empty string
}

function show() {
  var value = getUrlVar('showid'); //get variable value
  if (!value) return; //variable not found
  if (parseInt(value) == NaN) return; //value is not a number

  var row = document.getElementById('tblRow' + value); //get the element by ID name
  if (!row) return; //element not found

  row.style.display = 'inherit'; //set element display style to inherited value (which is visible by default)
}
</script>
</head>

<body onLoad="show();">
<table id="theTable">
  <tr id="tblRow14"><td>row ID 14</td></tr>
  <tr id="tblRow46"><td>row ID 46</td></tr>
  <tr id="tblRow30"><td>row ID 30</td></tr>
</table>
</body>
</html> 
```

请修复它或帮助我找出与此相同的新 Javascript 代码...

请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:45:58.547

“value”变量已经具有 . 因此，只需更改此行：

```
var row = document.getElementById(value); 
```

它会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:48:10.633

url 中的参数 showid 必须是整数。更改 First_page.html 中的链接。

```
<a href="Second_page.html?showid=14">First Row</a><br />
<a href="Second_page.html?showid=46">Second Row</a><br />
<a href="Second_page.html?showid=30">Third Row</a><br /> 
```

# java - 当一个对象符合垃圾收集器的条件时？

> ID：12182383
> 
> 赞同：4
> 
> 时间：2012-08-29T16:23:02.273
> 
> 标签：java, garbage-collection, scjp

考虑这个示例代码：

```
1\.  public class GC {
2\.      private Object o;
3\.      private void doSomethingElse(Object obj) { o = obj; }
4\.      public void doSomething() {
5\.          Object o = new Object();
6\.          doSomethingElse(o);
7\.          o = new Object();
8\.          doSomethingElse(null);
9\.          o = null;
10\.     }
11\. } 
```

当调用 doSomething 方法时，第 5 行中创建的 Object 在哪一行之后可用于垃圾回收？

A. 5号线

B. 6号线

C. 7号线

D、8号线

E. 9号线

F. 10 号线

答案：D

为什么D？确实，当执行第 6 行时，在第 5 行中创建的对象现在由实例 var o 和本地 var o 引用，而当执行第 8 行时，对象现在仅由本地 ref var o 引用，所以为什么答案是 D，执行第 9 行后会发生什么？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T16:37:34.713

这个问题让 IMO 感到困惑的主要原因是有 2 个变量名为`o`. 一个是实例变量，另一个是方法内部`o`的局部变量。`o``doSomething()`

```
Time            instance var o    local var o
Before Line 5:            null               
Line 5:                   null       Object#1
Line 6:               Object#1       Object#1
Line 7:               Object#1       Object#2
Line 8:                   null       Object#2   <- No more references to Object#1 
```

依此类推（或执行后）第 8 行，Object#1 符合收集条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:38:17.240

这个问题有点令人困惑，因为它是在第二次调用第**3 行**`o`之后，该对象才符合条件，因为它清除了第二个引用。

# asp.net-mvc - ASP.NET MVC BuildManager.GetAssemblies()

> ID：12182384
> 
> 赞同：1
> 
> 时间：2012-08-29T16:23:04.127
> 
> 标签：asp.net-mvc, reflection, .net-assembly

我在一个 ASP.NET MVC 4 应用程序中工作，在应用程序启动时我正在寻找使用 BuildManager 来获取所有引用的程序集。我正在查看应用程序中的所有类型以找到我想要的一些（它是动态的所以在启动之前我不知道我需要什么类型）。

基本上我的代码如下所示：

```
var allTypes = BuildManager.GetReferencedAssemblies()
                  .Cast<Assembly>()
                  .SelectMany(a => a.GetTypes()); 
```

我在应用程序启动时调用它，但也在每个新请求开始时调用它以动态查找类型。

所以我的问题是：

1.  由于 ASP.NET 在需要它们之前不会加载程序集，因此通过调用`BuildManager.GetReferencedAssemblies()`我是否在需要它们之前加载所有程序集并导致性能问题？
2.  对于每个请求，遍历所有类型是一个坏主意吗？我可以缓存这些类型，但是 ASP.NET 可以选择在我缓存它们之后动态加载程序集，对吧？如果是这样，我可能会错过一些确实存在的类型。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:31:17.047

不要每次请求都做：尽早做缓存；反射很慢。

预加载所有程序集并在应用程序启动时执行；我有一个系统，我在我们的很多网站中都使用它，它必须根据已部署的程序集做很多动态的事情，我在启动时完成所有工作。

是的，因此启动速度较慢 - 但这比每个请求花费的时间更长的问题要小。

然后，您很可能会对我刚才询问并回答的关于如何可靠地预加载所有已部署程序集的问题感兴趣：[如何为 AppDomain 预加载所有已部署程序集](https://stackoverflow.com/questions/3021613/how-to-pre-load-all-deployed-assemblies-for-an-appdomain)。

直到今天我仍然使用相同的过程，它就像一个魅力。

# cakephp - CakePHP 表单输入 - 防止默认？

> ID：12182385
> 
> 赞同：1
> 
> 时间：2012-08-29T16:23:07.340
> 
> 标签：cakephp, form-helpers

我认为这是

```
<?=$this->Form->create('Company')?>
     <?=$this->Form->input('Company.company_category_id')?>
     <?=$this->Form->input('Company.county')?>
     <?=$this->Form->input('Company.name')?>
     // Here i intend to insert all model fields in order to export them
     <?=$this->Form->input('ExportField.company_category_id', array('label' => 'Categorie', 'type' => 'checkbox', 'options' => null))?>
     // ...
<?=$this->Form->end('Submit')?> 
```

我的问题是助手“自动”认为 ExportField.{field} 是表单的主要模型字段（在本例中为公司）。

我可以使用一种解决方法来解决这个问题，但我想知道我是否可以强制它以某种方式保持这种方法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T04:23:19.147

您可以使用以下内容：

```
<?php echo $this->Form->create(null, array('controller' => 'controller_name', 'action' => 'action_name')?>
 <?php echo $this->Form->input('Company.company_category_id')?>
 <?php echo $this->Form->input('Company.county')?>
 <?php echo $this->Form->input('Company.name')?>
 // Here i intend to insert all model fields in order to export them
 <?php echo $this->Form->input('ExportField.company_category_id', array('label' => 'Category', 'type' => 'checkbox'))?>
 // ...
<?php echo $this->Form->end('Submit')?> 
```

如果您将`ModelName`as null 用作`$this->Form->create()`方法中的第一个参数，那么您可以轻松实现所需的相同功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:27:13.970

您在以下位置声明模型：

```
<?=$this->Form->create('Company')?> 
```

正如 cake doc 所说，[所有参数都是可选的](http://book.cakephp.org/2.0/en/core-libraries/helpers/form.html)。尝试：

```
<?=$this->Form->create()?> 
```

# exception - cuda gdb：指示的内核不在代码中

> ID：12182390
> 
> 赞同：0
> 
> 时间：2012-08-29T16:23:26.420
> 
> 标签：exception, pointers, cuda, cuda-gdb

我最初的问题是，我的函数有很长的参数列表，超出了允许作为参数传递给 cuda 内核的内存（我不记得有多少字节，因为我已经有一段时间了处理）。所以，我绕过这个问题的方法是定义一个新结构，它的成员是指向其他结构的指针，我以后可以从内核中取消引用。

...这是当前问题开始的地方：在我试图从内核中取消引用指针（我之前创建的结构的成员）时，我得到`CUDA_EXCEPTION_5, Warp Out-of-range Address` ...来自 cuda-gdb。最重要的是，内核名称和参数（被报告为“此时不存在”，cuda-gdb 给出的错误信息不是我在代码中创建的。

现在，更多细节：

以下是涉及的结构：

```
typedef struct {

    int strx;
    int stry;
    int strz;
    float* el;

} manmat;

typedef struct {

    manmat *x;
    manmat *y;
    manmat *z;

} manmatvec; 
```

这就是我试图将内核的参数分组到 main 中的方式：

```
int main () {

...
...

    manmat resu0;
    resu0.strx = n+2;       resu0.stry = m+2;       resu0.strz = l+2;
    if (cudaMalloc((void**)&resu0.el,sizeof(float) * (n+2)*(m+2)*(l+2)) != cudaSuccess) cout << endl << " ERROR allocating memory for manmat resu0" << endl ;
    manmat resv0;
    resv0.strx = n+2;       resv0.stry = m+2;       resv0.strz = l+2;
    if (cudaMalloc((void**)&resv0.el,sizeof(float) * (n+2)*(m+2)*(l+2)) != cudaSuccess) cout << endl << " ERROR allocating memory for manmat resv0" << endl ;
    manmat resw0;
    resw0.strx = n+2;       resw0.stry = m+2;       resw0.strz = l+2;
    if (cudaMalloc((void**)&resw0.el,sizeof(float) * (n+2)*(m+2)*(l+2)) != cudaSuccess) cout << endl << " ERROR allocating memory for manmat resw0" << endl ;
    manmatvec residues0 ;

    residues0.x = &resu0;
    residues0.y = &resv0;
    residues0.z = &resw0;

    exec_res_std_2d <<<numBlocks2D, threadsPerBlock2D>>> (residues0, ......) ;

 .....
} 
```

...这就是内核中发生的事情：

```
__global__ void exec_res_std_2d (manmatvec residues, ......) {

    int i = blockIdx.x * blockDim.x + threadIdx.x;
    int k = blockIdx.y * blockDim.y + threadIdx.y;

    manmat *resup;
    manmat *resvp;
    manmat *reswp;

    resup = residues.x;
    resvp = residues.y;
    reswp = residues.z;

    manmat resu, resv, resw ;

    resu.strx = (*resup).strx;     //LINE 1626
    resu.stry = (*resup).stry;
    resu.strz = (*resup).strz;
    resu.el = (*resup).el;

    resv = *resvp;
    resw = *reswp;

    .....
} 
```

最后，这就是 cuda-gdb 给出的输出：

```
..................
[Launch of CUDA Kernel 1065 (exec_res_std_2d<<<(1,2,1),(32,16,1)>>>) on Device 0]
[Launch of CUDA Kernel 1066 (exec_res_bot_2d<<<(1,2,1),(32,16,1)>>>) on Device 0]

Program received signal CUDA_EXCEPTION_5, Warp Out-of-range Address.
[Switching focus to CUDA kernel 1065, grid 1066, block (0,0,0), thread (0,2,0), device 0, sm 0, warp 2, lane 0]
0x0000000003179020 in fdivide<<<(1,2,1),(32,16,1)>>> (a=warning: Variable is not live at this point. Value is undetermined.
..., pt=warning: Variable is not live at this point. Value is undetermined.
..., cells=warning: Variable is not live at this point. Value is undetermined.
...) at ola.cu:1626
1626    ola.cu: No such file or directory.
    in ola.cu 
```

我必须注意我没有定义任何函数，`__device__`或者`__global__`在我的代码中调用`fdivide`......

此外，可能很重要的一点是，在调试器内的程序运行开始时，尽管我用 编译了我的 cuda c 文件`-arch=sm_20 -g -G -gencode arch=compute_20,code=sm_20`，但我得到了，

```
[New Thread 0x7ffff3b69700 (LWP 12465)]
[Context Create of context 0x1292340 on Device 0]
warning: no loadable sections found in added symbol-file /tmp/cuda-dbg/12456/session1/elf.1292340.1619c10.o.LkkWns
warning: no loadable sections found in added symbol-file /tmp/cuda-dbg/12456/session1/elf.1292340.1940ad0.o.aHtC7W
warning: no loadable sections found in added symbol-file /tmp/cuda-dbg/12456/session1/elf.1292340.2745680.o.bVXEWl
warning: no loadable sections found in added symbol-file /tmp/cuda-dbg/12456/session1/elf.1292340.2c438b0.o.cgUqiP
warning: no loadable sections found in added symbol-file /tmp/cuda-dbg/12456/session1/elf.1292340.2c43980.o.4diaQ4
warning: no loadable sections found in added symbol-file /tmp/cuda-dbg/12456/session1/elf.1292340.2dc9380.o.YYJAr5 
```

非常欢迎任何可以帮助我解决此问题的答案或提示或建议！请注意，我最近才开始使用 cuda-c 进行编程，而且我对 cuda-gdb 的经验不是很丰富。我在 C 代码中进行的大多数调试都是通过检查代码各个点的输出来“手动”进行的。

此外，此代码在 tesla M2090 上运行，并且还编译为在 2.0 架构上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:51:00.647

这将是一个问题：

```
manmatvec residues0 ;

    residues0.x = &resu0;
    residues0.y = &resv0;
    residues0.z = &resw0; 
```

、和变量在主机内存`resu0`中分配 - 在主机堆栈上。您将主机地址放入 manmatvec 结构中，然后将 manmatvec 传递到内核中。在接收端，CUDA 代码无法访问结构中提供的主机内存地址。`resv0``resw0`

如果要传递`resu0`, `resv0`,`resw0`变量的地址，则需要从设备内存中分配它们。

我不知道这是否是整个问题，但我很确定这是一个顶级贡献者。

# code-coverage - 在发布模式下使用 dotCover 问题运行代码覆盖率

> ID：12182391
> 
> 赞同：3
> 
> 时间：2012-08-29T16:23:27.400
> 
> 标签：code-coverage, ncover, dotcover

有没有人成功地使用 dotCover（最好是 TeamCity）运行覆盖率报告，同时在应用程序中定位发布模式？这是我收到的错误消息（此配置在调试模式下工作）：

```
Generate dotCover report (6s)
[09:53:44][Generate dotCover report] Started dotCover: E:\BuildAgent3\tools\dotCover\dotCover.exe report F:\TCAgents\ag3temp\buildTmp\dotcover3521342814066873775.xml
[09:53:44]
[Generate dotCover report] Output: JetBrains dotCover Console Runner v2.0.425.62\. Copyright (c) 2009-2012 JetBrains s.r.o. All rights reserved.

[JetBrains dotCover] Report generation started [8/29/2012 9:53:43 AM]
[JetBrains dotCover] Report generation finished [8/29/2012 9:53:43 AM]
[Generate dotCover report] dotCover exited with code: 0
Generate dotCover HTML report
[Generate dotCover HTML report] No source files were found under the build checkout directory F:\TCAgents\ag3work\724608d32a4f6354\. No source files will be included in dotCover report as source code of classes. 
```

我们希望生成一组已编译的工件以通过交付管道（包括部署）。我们在使用 NCover 时没有遇到这个问题——它能够在我们的发布版本中产生覆盖。

注意：.pdb 文件是在发布模式下生成的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T14:58:01.397

根据日志，快照拍摄正常，必须提供覆盖率统计信息。看起来源代码构建和覆盖分析处于不同的构建配置中。您可以将构建和覆盖分析放在一个配置中，也可以通过 TC 参数配置源代码映射

```
dotNetCoverage.dotCover.source.mapping (format: path1 => path2) 
```

当前结帐目录可以指定为`% teamcity.build.checkoutDir%`

# mongodb - 在 upsert 查询中使用修饰符或提供对象

> ID：12182392
> 
> 赞同：0
> 
> 时间：2012-08-29T16:23:39.647
> 
> 标签：mongodb, upsert

在我的 upsert 请求中，我想要：

*   如果它在那里，更新对象，又名

    ```
    db.somecollection.update({x: 1}, {$inc: {x: 1}}); 
    ```

*   如果它不存在，则提供一个新对象，也就是

    ```
    db.somecollection.update({x: 1}, {whole: 0, new: 'yata', object: 42}); 
    ```

有没有办法做到这一点 ？

问题是 upsert 似乎只有在您首先提供对象而不是修饰符时才有效。

编辑：我会更具体。

我想更新表单的对象

```
{_id: 12, a: 123, b: 234, c: 345} 
```

我的更新只是在或之一`a`上增加 1 。如果对象不在基础中，那么我想创建一个形式的对象`b``c`

```
{_id: 13, a: 1, b: 0, c: 0} 
```

如果`a`是我试图增加的领域。

现在，如果我正确阅读手册，我可以写

```
db.somecollection.update({_id: 12}, {$inc: {a: 1}}, true); 
```

这可以很好地更新我的`a`字段，但不会创建字段`b`并且`c`如果对象不存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:42:12.190

Upserts 可以与修饰符一起使用；当需要创建新文档时，修饰符将应用于选择器/条件对象。见[这里](http://www.mongodb.org/display/DOCS/Updating#Updating-UpsertswithModifiers)。但是您确实需要在调用中将`upsert`参数设置为：`true``update`

```
db.somecollection.update({x: 1}, {$inc: {x: 1}}, true); 
```

**更新**

要获得您正在寻找的行为：

```
db.somecollection.update({_id: 12}, {$inc: {a: 1, b: 0, c: 0}}, true); 
```

# jquery - 将鼠标移到/移出 div 时淡入/淡出 div 中的元素

> ID：12182396
> 
> 赞同：3
> 
> 时间：2012-08-29T16:23:54.520
> 
> 标签：jquery, gallery, mouseover, fade, mouseout

对不起这个愚蠢的标题，我想不出其他任何东西，如果有人已经问过这个，我很抱歉，我找不到它。

无论如何，我正在用 jQuery 制作一个画廊。我在该 div 中有一个 div 和一个图片以及上一个/下一个按钮。这些按钮位于图片上，我希望它们默认隐藏，当我将鼠标移到 div 上时淡入，当我将鼠标移出 div 时淡出。问题是当我将鼠标从图片移动到按钮时，javascript 将其注册为 mouseout 事件，即使我实际上并没有离开保存图片和按钮的 div。我做了一个快速的小提琴向你展示发生了什么：http: [//jsfiddle.net/7Ppbm/](http://jsfiddle.net/7Ppbm/)

有没有人可以解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:41:20.900

您应该使用以下`hover`功能：

```
$("#button").hide();

$("#container").hover(function(){
    $("#button").fadeIn();
},function(){
    $("#button").fadeOut();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:25:00.840

你缺少的是一个超时，它会阻止它一次又一次地淡出。另外，请使用`.on()`jQuery 1.7.2 的新功能

```
$("#button").fadeOut();
var timer;

$("#container img").on({
    mouseover: function () {
        clearTimeout(timer);
        $("#button").fadeIn();
    },
    mouseout : function () {
        timer = setTimeout(function () { 
            $("#button").fadeOut();
        }, 100);
    }
}); 
```

[jsFiddle 更新了](http://jsfiddle.net/7Ppbm/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:52:13.890

为什么不使用 CSS 过渡呢？它们在除 IE < 10 之外的所有地方都受支持。 [http://caniuse.com/#search=transition](http://caniuse.com/#search=transition)

您的示例已修改：http: [//jsfiddle.net/b4e4M/](http://jsfiddle.net/b4e4M/)

# actionscript-3 - as3xls 特殊字符错误

> ID：12182397
> 
> 赞同：0
> 
> 时间：2012-08-29T16:23:57.477
> 
> 标签：actionscript-3, apache-flex

我可以很好地创建 excel 文件，唯一的问题是当一个字段有一个特殊字符时，它会显示如下：

在保存文件之前我应该​​做些什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-27T16:05:15.177

有一个版本的**as3xls**库可以处理特殊字符并解决其他问题

[GitHub 版本 as3xls](https://github.com/djw/as3xls)

下载库的 ZIP 并将“src/com”源文件包含到您的 Flash Builder 项目中

# android - 将 TextView 可绘制对象缩放到相同大小

> ID：12182398
> 
> 赞同：1
> 
> 时间：2012-08-29T16:23:57.373
> 
> 标签：android, textview, drawable, scaling

我有一个使用 gridview 实现的菜单，其中每个单元格都由一个带有可绘制图标的 TextView 组成。结果是屏幕上充满了图标，每个图标下都有描述。大多数图标都是从这样的资源加载的：

```
Drawable img = getResources().getDrawable(R.drawable.people);
textView.setCompoundDrawablesWithIntrinsicBounds(null, img, null, null); 
```

为了个性化菜单，一些图标从存储在数据库中的位图中加载，如下所示：

```
byte[] imageAsBytes = org.kobjects.base64.Base64.decode(base64BitmapString);
Bitmap bmp = BitmapFactory.decodeByteArray(imageAsBytes, 0, imageAsBytes.length);
Drawable img = new BitmapDrawable(parent.getResources(), bmp);
textView.setCompoundDrawablesWithIntrinsicBounds(null, img, null, null); 
```

我遇到的问题是从数据库加载的资源并不总是显示与从资源加载的图标相同的大小。在某些设备上它们的大小相同，但在其他设备上它们更小。

使所有可绘制对象缩放为相同大小的正确方法是什么？

所有图像均为 100x100 png 文件。Android SDK 目标版本为 8 及以上。

我正在编辑它以包含网格和网格单元格的 xml：

网格单元：

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/label"
    style="@style/ButtonGridCell"
    android:layout_centerHorizontal="true"
    android:drawablePadding="4dp"
    android:gravity="center" >
</TextView> 
```

带网格的页面：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    style="@style/PageLayout" >
    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >
        <ImageView
            android:id="@+id/homelogo"
            style="@style/HomeLogo" />
        <GridView
            android:id="@+id/button_grid"
            style="@style/ButtonGrid"
            android:layout_below="@id/homelogo" >
        </GridView>
    </RelativeLayout>
</RelativeLayout> 
```

款式：

```
<style name="ButtonGridBase">
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:layout_centerHorizontal">true</item>
    <item name="android:horizontalSpacing">15dp</item>
    <item name="android:verticalSpacing">18dp</item>
    <item name="android:gravity">center</item>
    <item name="android:stretchMode">columnWidth</item>
    <item name="android:layout_margin">8dp</item>
    <item name="android:fadeScrollbars">false</item>
</style>
<style name="ButtonGrid" parent="@ButtonGridBase">
    <item name="android:columnWidth">100dp</item>
    <item name="android:numColumns">auto_fit</item>
</style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-13T16:30:05.453

您应该加载正确缩放的图像。在此 anwser 中查看更多信息：[https ://stackoverflow.com/a/3331673/1096742](https://stackoverflow.com/a/3331673/1096742)

# java - 以编程方式组织 Java 导入

> ID：12182399
> 
> 赞同：0
> 
> 时间：2012-08-29T16:23:59.443
> 
> 标签：java, android, import, preprocessor

我为我的 android 应用程序编写了一个自定义构建脚本。我包括了一些“简单”的预处理，所以我可以定义像

```
//#ifdef something
... CODE
//#endif 
```

如果这样配置，就去掉 Code 部分。问题是，在预处理之后我不再需要一些模块，所以我把它们排除在外。如果我想最终构建应用程序，剩下的就是那个咬我的模块的导入语句。我正在我的预处理中寻找一种方法，在预处理发生后组织我的脚本中的 java Imports。任何不需要额外“点击”的解决方案都非常受欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T05:18:13.007

看看[http://code.google.com/p/java-comment-preprocessor/](http://code.google.com/p/java-comment-preprocessor/) ps 我的一个案例的使用示例 [http://code.google.com/p/java-comment-preprocessor/wiki /ExampleOfUsageForJ2ME](http://code.google.com/p/java-comment-preprocessor/wiki/ExampleOfUsageForJ2ME)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:43:18.933

有时你真的需要预处理器（非常罕见）。但是您实际上可以通过正确的构建过程实现相同的目标。

无论如何回到你可以使用下一个技术的问题：

```
//#ifdef something
... IMPORTS
//#endif 
```

# javascript - 如何在 JavaScript 中将数字增量添加到选定的类？

> ID：12182402
> 
> 赞同：1
> 
> 时间：2012-08-29T16:24:06.457
> 
> 标签：javascript, jquery

我正在使用 Drupal 动态生成内容。我正在运行将 div 放在另一个 div 之前的 javascript。代码工作正常，看起来像这样：

```
 $(function() {
    $('.views-row-1 .content .body').insertBefore('.views-row-1 .content .field-name-field-image-one');

   }); 
```

我的问题是，因为内容是动态生成的，所以“views-row-#”类会逐渐变化。例如，如果页面上有 3 个内容元素，Drupal 将为第一个创建类 views-row-1，第二个创建 views-row-2，第三个创建 views-row-3。

我所做的（这并不理想）是为每条内容写出一行代码，如下所示：

```
 $(function() {
    $('.views-row-1 .content .body').insertBefore('.views-row-1 .content .field-name-field-image-one'); // check before() examples
    $('.views-row-2 .content .body').insertBefore('.views-row-2 .content .field-name-field-image-one'); // check before() examples
    $('.views-row-3 .content .body').insertBefore('.views-row-3 .content .field-name-field-image-one'); // check before() examples
    $('.views-row-4 .content .body').insertBefore('.views-row-4 .content .field-name-field-image-one') 
   }); 
```

我永远不会知道会有多少内容，因为它是动态的，所以我希望让 javascript 将数字添加到类中。这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:31:08.193

```
$('[class^="views-row"]').each(function(){

    var className = //get classname to insert before 
   //not sure if .index() will help you since you have not posted your HTML

   $(this).find('.content .body').insertBefore(className);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:28:41.717

为每一行添加一个特定的类，在这里我们称之为“divAppend”。

然后做：

```
$('.divAppend').each(function() {
    $(this).insertBefore('whateveryouareinserting');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:43:29.410

我最终使用了它，因为 Drupal 还为每个内容创建了“view-row”类。感谢所有的帮助，很多创造性和有用的解决方案！

```
$('.views-row').each(function(i,e) {
  $('.content .body', e).insertBefore($('.content .field-name-field-image-one', e));
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T16:37:29.477

你可以尝试这样的事情：

```
function iterate () {
    var view = null;
    var i = 1;
    while ((view = $('.views-row-' + i + ' .content .body')).size() > 0) {
        alert(view.text());
        view.insertBefore('.views-row-' + i + ' .content .field-name-field-image-one');
        i++;
    }    
}
$(function() {
    iterate();
});
​ 
```

虽然它一点也不漂亮，但它可以工作。这是它的[小提琴](http://jsfiddle.net/bM4GK/)。​</p>

# android - 有没有办法在不设置 onTouch 的情况下禁用 Android Webview 中的滚动？

> ID：12182409
> 
> 赞同：2
> 
> 时间：2012-08-29T16:24:30.290
> 
> 标签：android, iframe, webview, scroll

我有一个 webview，它显示一个复杂的页面，里面有一堆 iframe。

基本上我想要做的是禁用页面的滚动，但没有设置 onTouch 侦听器来拦截触摸事件，因为我仍然需要在页面上的 iframe 中启用滚动。

我试过了：

```
webView.setHorizontalScrollBarEnabled(false); 
```

和

```
webView.setVerticalScrollBarEnabled(false); 
```

但是这些似乎只是关闭了滚动条的显示，并没有真正禁用滚动功能。

有什么解决办法吗？

# android - 图像显示的意图

> ID：12182421
> 
> 赞同：0
> 
> 时间：2012-08-29T16:25:27.353
> 
> 标签：android

我的 SD 卡上有一系列图像路径，并将它们显示在列表中。我想将 onitemclick 与图像可视化相关联，而不是创建我自己的活动，我想知道是否存在在给定图像路径的情况下显示它的意图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:35:12.700

此解决方案假定*您具有图像的路径*：

```
Intent intent = new Intent();
intent.setAction(android.content.Intent.ACTION_VIEW);
intent.setDataAndType(Uri.fromFile(new File(path)), "image/png");
startActivity(intent); 
```

# mysql - 主查询不返回记录时如何从子查询中获取计数

> ID：12182423
> 
> 赞同：1
> 
> 时间：2012-08-29T16:25:39.800
> 
> 标签：mysql, count, subquery

当在主查询中找到记录时，下面的 MYSQL 查询为我提供了我需要的输出，例如

返回：

```
username  |  total_favs
this_user |  4 
```

但是如果在主查询中没有找到任何记录，我什么也得不到。我想得到这样的东西：

返回：

```
username  |  total_favs
null |  4

SELECT 
  c.username,
  (SELECT COUNT(*) AS total_records FROM favourites f WHERE f.pic_id = 177) AS `total_favs`
FROM
  comments c
WHERE
  c.pic_id = 177 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:29:07.770

切换它`favourites`是主要查询：

```
SELECT c.username, COUNT(*) AS total_favs
FROM favourites f
LEFT OUTER JOIN comments c on f.pic_id = c.pic_id
WHERE f.pic_id = 177
GROUP BY c.username 
```

# iphone - UIWebView 到视图控制器？

> ID：12182424
> 
> 赞同：0
> 
> 时间：2012-08-29T16:25:54.800
> 
> 标签：iphone, ios, xcode

我想知道是否有人知道这是否可能？

我有一个 uiwebview 作为第一个视图控制器，它显示了我使用 Facebook 登录屏幕制作的基本 html 页面。您可以登录（在 uiwebview 中）并且一旦授权您（在 uiwebview 中）它会关闭并启动第二个视图控制器吗？

有谁知道这方面的好例子或教程？

如果没有，有人可以指出我在 Storyboard 而不是 XIB 中的一个好的 FacebookSDK 示例或教程的方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:45:57.960

您应该使用 Facebook SDK 的和类来登录。您可以使用来自这些的委托回调来驱动您的下一个视图控制器。 `[FBLoginView](https://developers.facebook.com/docs/sdk-reference/iossdk/3.0/class/FBLoginView/)` `[FBSession](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/)`

我想不出你想要在 a 中调出 facebook 登录页面 `UIWebView` 而不是执行上述操作的原因。如果由于某种原因您确实需要使用 a `UIWebView` ，则该方法可能会为您提供所需的钩子。 `[webViewDidFinishLoad:](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UIWebViewDelegate)` `UIWebViewDelegate`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:28:26.610

[从github](https://github.com/facebook/facebook-ios-sdk)下载 Facebook sdk并检查示例中的 SessionLoginSample。我认为它有你需要的一切

# android - 在 android 中，我可以在运行时更改操作栏窗口功能吗？

> ID：12182430
> 
> 赞同：0
> 
> 时间：2012-08-29T16:26:29.530
> 
> 标签：android, android-actionbar

理想情况下，我希望我的主要活动有 2 个视图，而不是开始一个新活动；目前我正在使用视图切换器从地图视图和列表视图切换。

在我的地图视图上，我想要一个透明的操作栏。

在列表视图上，我想要一个实心的（所以列表项在操作栏下是不可访问的）。

这是可能的吗？

或者我是否被迫创建 2 个单独的活动并通过捆绑传递自定义对象列表，以使视图之间的转换尽可能简单。

最终目标是在切换视图时拥有 iPhone 风格的鳍状肢动画，就像您正在查看地图视图背面的当前统计信息/详细信息一样。显然，活动之间可能无法实现这样的过渡动画，但我仍在研究它.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:47:36.650

您可以使用`actionBar.show()`和`actionBar.hide()`来切换 ActionBar 功能。

# java - org.postgresql.util.PSQLException：列索引超出范围：

> ID：12182431
> 
> 赞同：1
> 
> 时间：2012-08-29T16:26:30.043
> 
> 标签：java, jdbc

我正在使用 spring JDBC 模板，

```
 Map resultsMap = getStoryJdbcTemplate().call(
    new CallableStatementCreator() {

      public CallableStatement createCallableStatement(Connection pConn)
          throws SQLException {
        CallableStatement callable = pConn.prepareCall(DELETE_STORY);
        callable.setLong(1, pStory.getId());
        callable.setLong(2, pStory.getVersion());
        callable.registerOutParameter(3, Types.INTEGER);
        callable.registerOutParameter(4, Types.BIGINT);
        return callable;
      }
    },
    Arrays.asList(new SqlParameter[] { new SqlParameter(Types.BIGINT), 
        new SqlParameter(Types.BIGINT),
        new SqlOutParameter("rowCount", Types.INTEGER), 
        new SqlOutParameter("version", Types.BIGINT) })); 
```

当我执行以下查询时，我得到 The column index is out of range: 1, number of columns: 0.; 嵌套异常是 org.postgresql.util.PSQLException。

```
 private static final String DELETE_STORY = ""

+"Do $$"      
+ "DECLARE "
+ "   v_rowcount numeric; "
+ "   v_version numeric; "
+ "BEGIN "
+ "     DELETE FROM registrant_stories "
+ "     WHERE registrant_story_id = ? AND version = ? "
+ "     RETURNING version INTO v_version; "
+ "     GET DIAGNOSTICS v_rowcount := ROW_COUNT; "
+ "     ? := v_rowcount; "
+ "     ? := v_version; "
+ "END $$ ; "; 
```

错误跟踪是：

```
 org.springframework.dao.DataIntegrityViolationException: CallableStatementCallback; SQL []; The column index is out of range: 1, number of columns: 0.; nested exception is org.postgresql.util.PSQLException: The column index is out of range: 1, number of columns: 0.
at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:100) 
```

谢谢，请帮帮我..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-25T21:17:35.983

错误消息意味着您期望的列比返回的列更多。

# c++ - C++中的随机函数

> ID：12182441
> 
> 赞同：2
> 
> 时间：2012-08-29T16:27:24.670
> 
> 标签：c++, function, random

是否有一个函数可以在指定范围内生成 k 个随机数。例如，我想要 0 到 100 之间的 5 个随机数，有或没有替换。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T16:29:10.880

您可以将[std::generate_n](http://en.cppreference.com/w/cpp/algorithm/generate_n)与`rand()`新的[C++11 random number generators](http://en.cppreference.com/w/cpp/numeric/random)中的任何一个或一个生成器一起使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T16:37:16.067

例如，您可以使用 Boost 库来生成随机数。以下代码从 [0, 100] 生成 5 个随机数**并替换**：

```
#include <vector>
#include <boost/random/mersenne_twister.hpp>
#include <boost/random/uniform_int_distribution.hpp>

const int numWantedNumbers = 5;

int main()
{
    boost::random::mt19937 generator;
    boost::random::uniform_int_distribution<> distribution(0, 100);
    std::vector<int> result;
    for (int i = 0; i < numWantedNumbers; ++i)
        result.push_back(distribution(generator));
} 
```

如果要生成**不替换**的数字，只需检查它们是否仍然可用：

```
#include <algorithm>
#include <vector>
#include <boost/random/mersenne_twister.hpp>
#include <boost/random/uniform_int_distribution.hpp>

const int numWantedNumbers = 5;

int main()
{
    boost::random::mt19937 generator;
    boost::random::uniform_int_distribution<> distribution(0, 100);
    std::vector<int> result;
    while (result.size() < numWantedNumbers)
    {
        int number = distribution(generator);
        if (std::find(result.begin(), result.end(), number) == result.end())
            result.push_back(number);
    }
} 
```

**注意：**示例中不带替换的拒绝采样具有​​明显的缺点，即很难创建较长的向量。试着从 100 个数字中抽取 99 个，看看我的意思（或者更好地从 10000 个中抽取 9999 个）。如果这是一个问题，我建议创建所有可能数字的随机排列，然后以请求的大小切割向量：

```
#include <algorithm>
#include <vector>
#include <boost/random/mersenne_twister.hpp>
#include <boost/random/uniform_int_distribution.hpp>

const int numWantedNumbers = 5;

int main()
{
    boost::random::mt19937 generator;
    boost::random::uniform_int_distribution<> distribution(0, 100);

    // Generate a vector with all possible numbers and shuffle it.
    std::vector<int> result;
    for (int i = 0; i <= 100; ++i)
        result.push_back(i);
    for (int i = 0; i <= 100; ++i)
    {
        int x = distribution(generator);
        std::swap(result[i], result[x]);
    }

    // Truncate to the requested size.
    result.resize(numWantedNumbers);
} 
```

**根据[juanchopanza](https://stackoverflow.com/users/661519/juanchopanza)**的建议进行编辑：

在 C++11 方式中，最后一个变体看起来像这样

```
#include <algorithm>
#include <random>
#include <vector>

const int numWantedNumbers = 5;

int main()
{
    std::random_device device;
    std::mt19937 generator(device());
    std::uniform_int_distribution<> distribution(0, 100);

    // Generate a vector with all possible numbers and shuffle it.
    std::vector<int> result;
    for (int i = 0; i <= 100; ++i)
        result.push_back(i);
    std::random_shuffle(result.begin(), result.end());

    // Truncate to the requested size.
    result.resize(numWantedNumbers);
} 
```

`g++-4.6``-std=c++0x`如果您添加开关，则可以愉快地编译它。

**编辑：**利用`std::random_shuffle()`（[James Kanze](https://stackoverflow.com/users/649665/james-kanze)的坦克）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-10-20T11:32:18.597

是的，C++ 中有一个 rand() 函数，可以在程序中使用它，包括 cstdlib 头文件。您可以使用以下代码实现您的程序。

```
#include <iostream>
#include <cstdlib>
#include <ctime>
using namespace std;
int main()
{
  int max {100};
  int min {0};
  int number;
  int count = 5; //assuming that only 10 numbers we need to print
  srand(time(0));
  for(int i=1;i<=count;i++)
  {
      number = rand() % (max - min +1) + min;``
      cout<<number<<endl;
  }
} 
```

# java - mDNS 代码 bonjour

> ID：12182448
> 
> 赞同：-4
> 
> 时间：2012-08-29T16:27:35.193
> 
> 标签：java, service-discovery, mdns

我需要开发一些服务器发现协议，我试图获取 mDNS 文档，我可以在其中了解 mDNS 及其实现。但我无法得到..任何人都可以帮助我获得相同的基本代码会对我有很大帮助..

我打算使用 JAVA 实现发现协议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:30:50.463

快速谷歌搜索显示：

*   [http://code.google.com/p/mahalo-mdns/](http://code.google.com/p/mahalo-mdns/)
*   [http://jmdns.sourceforge.net/](http://jmdns.sourceforge.net/)

# c# - Linq OrderBy 计算属性（带连接 ）

> ID：12182451
> 
> 赞同：0
> 
> 时间：2012-08-29T16:27:50.480
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, linq

我有两个数据库表映射到我的 MVC 应用程序中的模型：

```
public class BuildingLocation
{
    public int id { get; set; }
    public double Lat { get; set; }
    public double Lng { get; set; }
}

public class Building
{
    public int id { get; set; }
    public string title { get; set; }
    //OTHER STUFF
} 
```

使用 Linq / Entities，我试图获取建筑物列表，按与地图上给定点的距离排序。

```
DefaultConnection db = new DefaultConnection();    

 public IEnumerable<dynamic> GetBuildings(double north, double south, double east, double west)
    {
        double centreX = (east - west) / 2;
        double centreY = (north - south) / 2;
        var query = from b in db.Building
                    join l in db.BuildingLocation on
                    b.id equals l.id
                    select new {b.id, b.title, l.Lat, l.Lng,
                            dist = Math.Sqrt(((centreX - l.Lat) * (centreX - l.Lat)) + ((centreY - l.Lng) * (centreY - l.Lng)))
                    };

        query = query.Where(l => l.Lat > west);
        query = query.Where(l => l.Lat < east);
        query = query.Where(l => l.Lng > south);
        query = query.Where(l => l.Lng < north);
        query = query.OrderBy(c => c.dist);
        return query.AsEnumerable();
       } 
```

所以，显然这根本行不通。我以前从未使用过Linq。如何根据计算设置 OrderBy？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:40:27.853

尝试这个 ：

```
public IEnumerable<dynamic> GetBuildings(double north, double south, double east, double west)
{
    double centreX = (east - west) / 2;
    double centreY = (north - south) / 2;
    var query = db.Building.Join(db.BuildingLocation.Where(l=> 
                             l.Lat > west &&  l.Lat < east 
                             && l.Lng > south && l.Lng < north), 
                             b => b.id , l => l.id, 
                             (b,l) => new {
                                            ID = b.id,
                                            Title = b.title,
                                            Lat = l.lat,
                                            Lng = l.Lng,
                                            dist =  Math.Sqrt(((centreX - l.Lat) * (centreX - l.Lat)) + ((centreY - l.Lng) * (centreY - l.Lng)))
                                          }).OrderBy(Q=>Q.dist);

    return query;
} 
```

上面的查询是用 lambda 表达式编写的。如果您希望在查询表达式中使用此代码，请使用以下代码：

```
var query =  from result in (from b in db.Building
                join l in db.BuildingLocation on
                b.id equals l.id
                where l.Lat > west &&  l.Lat < east && l.Lng > south && l.Lng < north
                select new {b.id, b.title, l.Lat, l.Lng,
                        dist = Math.Sqrt(((centreX - l.Lat) * (centreX - l.Lat)) + ((centreY - l.Lng) * (centreY - l.Lng))) })
                order by result.dist select result; 
```

这将解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T17:49:28.583

如果您使用实体框架，您可能会收到以下异常消息：

“LINQ to Entities 无法识别方法 'Double Sqrt(Double)' 方法，并且此方法无法转换为存储表达式。”

所以我会分两步解决这个问题，内部查询应该只从表中获取数据，而在外部（现在是内存查询）中将进行距离计算和排序：

```
double centreX = (east - west) / 2;
double centreY = (north - south) / 2;

var query = (from result in
                ((from b in db.Building
                    join l in db.BuildingLocation on b.id equals l.id
                    where l.Lat > west && l.Lat < east && l.Lng > south && l.Lng < north
                    select new { b.id, b.title, l.Lat, l.Lng }).AsEnumerable()
                )
            select new
            {
                id = result.id,
                title = result.title,
                Lat = result.Lat,
                Lng = result.Lng,
                dist = Math.Sqrt(((centreX - l.Lat) * (centreX - l.Lat)) + ((centreY - l.Lng) * (centreY - l.Lng)))
            }).OrderBy(e => e.dist); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:43:55.360

在我的帽子顶部，只是为了建筑物，我会做这样的事情：

```
public IEnumerable<Building> GetBuildings(double north, double south, double east, double west)
{
    double centreX = (east - west) / 2;
    double centreY = (north - south) / 2;

    db.BuildingLocation.Where(l => l.Lat > west && l.Lat < east && l.Lng > south && l.Lng < north)
        .Join(
            db.Building, 
            b => b.id, 
            l => l.id, 
            (l, b) =>  new {Building = b, l.Lat, l.Lng })
        .AsEnumerable()
        .OrderBy(l => Math.Sqrt(((centreX - l.Lat) * (centreX - l.Lat)) + ((centreY - l.Lng) * (centreY - l.Lng))))
        .Select(l => l.Building)
} 
```

我假设它不起作用，因为距离计算无法转换为 SQL，所以我在 OrderBy 之前插入了 AsEnumerable 调用——这意味着过滤发生在数据库端，但排序发生在——内存与 Linq to Objects。

# javascript - 意外行为：绝对位置g & $(window).resize()

> ID：12182454
> 
> 赞同：0
> 
> 时间：2012-08-29T16:28:01.240
> 
> 标签：javascript, jquery, css, window-resize

我使用的是绝对定位布局（有点类似于 pinterest）

所以我还需要在 window.resize 上重新计算位置：由于这个事件没有在 dom 就绪时触发，所以我手动进行。

```
$(document).ready(function(){
    $(window).resize();
});
$(window).resize(setupBlocks); 
```

现在，此函数 setupBlocks 检查 HTML 元素的大小以计算其新位置

```
function setupBlocks() {
    if ($('.fancyContent').length > 0) {
        if ($('.rightFixed').length > 0) $('.fancyContent').width($(window).width() - 320)
        windowWidth = $('.fancyContent').width();
        //colWidth = $('.fancyContent .widgetHelp').outerWidth();
        blocks = [];
        //console.log(blocks);
        colCount = Math.floor(windowWidth / (colWidth + margin * 2));
        for (var i = 0; i < colCount; i++) {
            blocks.push(margin);
        }
        $('.fancyContent .widgetHelp').css({
            'position': 'absolute',
            'width': colWidth
        });
        positionBlocks();
        var topFooter = $('.fancyContent .widgetHelp:last').offset().top + 350;
        $('footer').css({
            'position': 'absolute',
            'top': topFooter
        });
        //console.log(topFooter);
        $('.fancyContent').css('visibility', 'visible');
        $('#load').remove();
        //console.log($('#load').length);
    }
}

function positionBlocks() {
    $('.fancyContent .widgetHelp').each(function () {

        var min = Array.min(blocks);
        var index = $.inArray(min, blocks);
        var leftPos = margin + (index * (colWidth + margin));
        $(this).css({
            'left': leftPos + 'px',
            'top': min + 'px'
        });
        blocks[index] = min + $(this).outerHeight(true) + margin;
    });
} 
```

出乎意料的是，这是按预期执行的。但是在调整窗口大小之前，位置的计算并不是很好。然后位置变得准确。

我知道这是一个长镜头。但知道为什么它的行为会有所不同吗？

如果你自己测试它会更好：`http://209.51.221.243/integracion/login.php`

加载页面时，div 几乎没有问题（其中一些是垂直接触的），但是如果您调整 div 的大小，则 div 会很好地定位。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T02:36:19.690

不要运行`$(window).resize()`准备好的文档，而是在窗口加载时运行它。换句话说，改变

```
$(document).ready(function(){
    $(window).resize();
}); 
```

到

```
$(window).load(function(){
    $(window).resize();
}); 
```

由于文档准备好只是等到所有 DOM 元素就位，jQuery 无法检测到正确的块大小和位置，因为没有加载图像。图像加载后，尺寸会发生变化。如果您想尽快定位，请尝试为图像指定高度和宽度，这样当文档准备好（而不是加载窗口）时，jQuery 可以获取所有图像大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T02:46:55.140

当你写：

```
$(document).ready(function(){
    $(window).resize();
}); 
```

`setupBlocks`函数没有被调用，这样它是：

```
$(document).ready(function(){
    $(window).on('resize', setupBlocks); // window listens for resize events
    $(window).resize(); // fire window resize
}); 
```

现在您确定您的设置在页面加载时运行 [[小提琴](http://jsfiddle.net/jT6ma/)]。

# jenkins - Jenkins nodelabel 插件 .jpi 来自哪里？

> ID：12182457
> 
> 赞同：7
> 
> 时间：2012-08-29T16:28:15.840
> 
> 标签：jenkins, puppet

我正在编写一个 puppet 脚本，它将使用 nodelabel 参数插件自动设置一个 jenkins 实例。它成功下载了 .hpi，但插件仍然无法正常工作。

当我使用 Web UI 安装它时，我看到一个工作版本同时具有 .hpi 和 .jpi 文件。我在任何地方都找不到 .jpi 的链接，所以我猜这是从 .hpi 生成的。我想知道在自动安装过程中是否/如何创建它，以便我可以在 puppet 中模仿它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-16T23:34:30.630

.jpi 和 .hpi 文件只是 zip 文件（JPI = jenkins 插件，HPI = hudson 插件）。如果您将 .hpi 放在您的插件目录（可能是 /var/lib/jenkins/plugins）并重新启动 Jenkins，它将安装插件。

我发现 Jenkins-ci.org 存储 .hpi 文件，以这种方式安装会将它们保留为 .hpi 文件。通过 gui 安装会将它们更改为 .jpi。

您还可以查看 Jenkins 的现有 puppet 模块之一。

# encryption - Hadoop GPG SerDe

> ID：12182459
> 
> 赞同：1
> 
> 时间：2012-08-29T16:28:30.630
> 
> 标签：encryption, hadoop, hive, gnupg

我目前正在研究一个需要数据加密的 Hadoop 项目（因为数据将存储在 S3 中）。虽然我主要希望通过 Hive 访问数据，但能够通过 Pig 和任何其他 MapReduce 方法访问它会很好。

我知道 Hadoop 内置了对 gzip、snappy 等压缩编解码器的支持……是否也支持加密编解码器（特别是 GPG）？有没有人写过公开可用的 GPG SerDe（或类似的东西）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T04:32:48.473

最后我知道 Hadoop 对加密没有任何内部支持。似乎你可以用你的 GPG 代码重载 CompressionCodec，ala [http://www.mail-archive.com/common-user@hadoop.apache.org/msg06229.html](http://www.mail-archive.com/common-user@hadoop.apache.org/msg06229.html)

黑客攻击快乐，如果您找到解决方案，请告诉我们！

# c# - 在控制中初始化控制

> ID：12182464
> 
> 赞同：1
> 
> 时间：2012-08-29T16:28:42.117
> 
> 标签：c#, visual-studio-2010, controls

这是我的自定义控件类：

```
// Extended ComboBox where ill change some property.
public class ExtComboBox : ComboBox
{
    ...
}

// ExtButton is a control that i am going to drop on Form from ToolBox.
public partial class ExtButton : Button
{
    public ExtComboBox ComboBoxInsideButton { get; set; }

    public ExtButton()
    {
        InitializeComponent();

        ComboBoxInsideButton = new ExtComboBox();
        ComboBoxInsideButton.Text = "hi!";

        Controls.Add(ComboBoxInsideButton);
    }
} 
```

基本上，当我将此控件添加到表单时，顶部按钮上会出现 ComboBox。不要问我为什么需要这个：D

现在，如果我需要更改 ComboBox 文本，我只需使用：

```
extButton1.ComboBoxInsideButton.Text = "aaa"; 
```

一切正常.. 但是 :) 当我尝试在设计模式下更改某些 ComboBox 属性（窗口属性 -> 展开 ComboBoxInsideButton -> 将文本更改为“bbb”）时，在重建或运行项目 ComboBox 属性将被重置（ExtButton.Designer 。CS）

问题1：如何用一些默认属性值初始化子控件，所以当Form上的控件出现错误时，所有设置都会被添加？

和

问题2：如何在设计时更改子控件的属性。

**编辑：**
在这里回答：[设计器不会为子控件的属性生成代码。为什么？](https://stackoverflow.com/a/3701173)
添加`[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]`解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:46:04.970

我写了一篇关于如何创建自定义 UserControl 并[在此处](https://stackoverflow.com/questions/11955642/controls-for-list-of-objects/11959225#11959225)访问其成员的简短说明。几乎，您似乎想要向您添加属性以`ExtComboBox`公开`ComboBox`您想要更改的属性。然后，在 中`ExtButton`，您将能够`.`在运行时使用 来更改这些值。

另外，不要这样做：

```
public ExtComboBox ComboBoxInsideButton { get; set; }
...
ComboBoxInsideButton = new ExtComboBox(); 
```

做

```
public ExtComboBox comboBoxInsideButton = null;
...
comboBoxInsideButton = new ExtComboBox(); 
```

`private`请务必了解和之间的区别`public`。如果你把它放在另一个控件上，我不确定你是否想要你`ExtComboBox`。`public`

希望这可以帮助。

# django - ** 或 pow() 不支持的操作数类型：“元组”和“字典”

> ID：12182467
> 
> 赞同：7
> 
> 时间：2012-08-29T16:28:58.343
> 
> 标签：django

我正在关注本教程并进行了一些更改：[http](http://www.jacobian.org/writing/dynamic-form-generation/) ://www.jacobian.org/writing/dynamic-form-generation/ ，所有这些我将在下面作为片段发布。当我尝试访问通过我的动态表单视图的页面时，它会引发 TypeError。这是回溯：[http](http://dpaste.com/793196/) ://dpaste.com/793196/ 。

*forms.py（测试/forms.py）*

```
from django import forms

class TestForm(forms.Form):
    test_id = forms.CharField()
    user_id = forms.CharField()
    complete_time = forms.IntegerField()

    def __init__(self, *args, **kwargs):
        extra = kwargs.pop('extra')
        super(TestForm, self).__init__(*args **kwargs)

        for i, question in enumerate(extra):
            self.fields['custom_%s' % i] = forms.CharField(label=question)
    def extra_answers(self):
        for name, value in self.cleaned_data.items():
            if name.startswith('custom_'):
                yield (self.fields[name].label, value) 
```

*view.py (测试/views.py)*

```
def exam(request, test_id):
    user = request.user
    t = get_object_or_404(Test, pk=test_id)
    if user.is_authenticated():
        extra_questions = get_questions(request, test_id)
        if request.method == 'POST':

            form = TestForm(request.POST or None, extra=extra_questions)

            if form.is_valid():
                for (question, answer) in form.extra_answers():
                    save_answer(request, question, answer)
                return HttpResponseRedirect('/tests/')
        else:
            form = TestForm(None, extra=extra_questions)

        return render(request, 'testing/exam.html', { 't' : t, 'form' : form })
    else:
        return HttpResponseRedirect('/')

def get_questions(request, test_id):
    t = get_object_or_404(Test, pk=test_id)
    questions = t.question_set.all()
    for question in questions:
        title = question.question
        qlist = []
        qlist.append(title) 
```

任何帮助将不胜感激，因为我正在努力寻找答案。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-29T16:30:24.383

你不小心忘记了逗号。

```
super(TestForm, self).__init__(*args, **kwargs) 
```

# html - CSS调整具有显示的div：table-cell

> ID：12182471
> 
> 赞同：1
> 
> 时间：2012-08-29T16:29:11.653
> 
> 标签：html, css, centering, css-tables

我的网站上有一个标题，它有一个容器和三个 div。

标题容器高 100 像素。第一个 div 向左浮动，宽度为 150px 第二个 div 向右浮动，宽度为 150px 第三个 div 内部有另一个 div，默认调整大小以填充剩余空间。

我希望第三个 div 垂直居中。当我添加 display: table-cell 和 vertical-align: middle 时，div 会缩小到文本的大小。我只能使用固定大小调整 div 的大小。

```
<div id="#headingcontainer">
<div class="leftimg">Left</div>
<div class="rightimg">Right</div>
<div class="heading">Content to be centered horizontally and vertically</div>
</div>

#headingcontainer
{
border: none;
border-bottom: 2px solid #8c8cd4;
width: 100%;
height: 100px;
text-align: center;
background-color: #000;
margin-bottom: 10px;
margin-left: auto;
margin-right: auto;
}

div.heading
{
display: table-cell;
vertical-align: middle;
height: 100px;
text-align: center;
width: auto;
}

div.leftimg
{
width: 150px;
float: left;
}

div.rightimg
{
width: 150px;
float: right;
} 
```

谁能让我知道如何在不知道确切宽度的情况下将中间 div 居中？

如果我从标题类中取出 display: table-cell 它不再垂直居中而是水平居中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:53:31.950

我认为这可能是您正在寻找的...我将css中的div.header更改为顶部有填充，删除了表格单元并将边距设置为自动而不是宽度自动。看看这是否是你所希望的。您将不得不根据间距调整顶部的填充，但这对我来说似乎是最简单的方法。

```
#headingcontainer
{
border: none;
border-bottom: 2px solid #8c8cd4;
width: 100%;
height: 100px;
text-align: center;
background-color: #000;
margin-bottom: 10px;
margin-left: auto;
margin-right: auto;
}

div.heading
{
height: 100px;
text-align: center;
margin: auto;
padding-top:40px;
}

div.leftimg
{
width: 150px;
float: left;
}

div.rightimg
{
width: 150px;
float: right;
}

<div id="headingcontainer">
<div class="leftimg">Left</div>
<div class="rightimg">Right</div>
<div class="heading">Content to be centered horizontally and vertically</div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T12:46:48.110

我现在找到了适合我的答案。

首先是对 HTML 的小改动（标题中有两个额外的 div）：

```
<div id="#headingcontainer">
    <div class="leftimg">Left</div>
    <div class="rightimg">Right</div>
    <div class="heading"><div><div>Content to be centered horizontally and vertically<div></div></div>
</div> 
```

然后更改为 CSS：

```
#headingcontainer
{
    border: none;
    border-bottom: 2px solid #8c8cd4;
    background-color: #000;
    margin-bottom: 10px;
    width: 100%;
    height: 100px;
}

div.heading
{
    display: table;
    border-collapse: collapse;
    width: 100%;
    height: 100px;
    position: absolute;
}

div.heading div
{   
    display: table-row;
}

div.heading div div
{   
    display: table-cell;
    text-align: center; 
    vertical-align: middle;
} 
```

这允许最终的 div 包含垂直和水平居中的文本。帮助来自我在更多搜索后发现的另一个 Stack Overflow 问题 - 818725。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T13:33:16.857

试试这个[http://jsfiddle.net/KtgVN/20/](http://jsfiddle.net/KtgVN/20/)

# sharepoint - SharePoint 2010 中文档集的内容管理器规则问题

> ID：12182472
> 
> 赞同：0
> 
> 时间：2012-08-29T16:29:17.260
> 
> 标签：sharepoint, sharepoint-2010, contenttype, document-set

我在 SharePoint 2010 中为文档集创建了一个新的自定义内容类型。此内容类型通过内容联合中心发布。我还在同一个 Web 应用程序上创建了一个记录中心站点。这使用内容管理器规则将基于自定义内容类型的所有文档集路由到记录中心中的特定库。

我已经成功测试了这个内容管理器规则。但是，当我更新自定义内容类型以在现有字符串列上包含一个非常简单的验证（一个简单的检查以确保特定的字符串列包含 10 个字符的字符串）时，内容管理器规则将不会处理任何文档集使用内容类型。尽管测试文档集都有一个应该成功通过验证的 10 个字符串。发送到记录中心的任何文档集都保存在投递库中，并且会生成一封自动电子邮件，告诉内容管理器管理员文档“已提交到记录中心，但缺少所需的属性或与任何已定义的属性不匹配规则”。当我从列中删除验证时，

有没有人遇到过这个问题？如果是这样，您是否知道一种解决方法，可以让我进行必要的列验证并仍将文件发送到记录中心？

谢谢，魔术师安迪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T11:07:44.410

我想出了一个可能的解决方法。以前，列验证应用于内容类型。但是，如果从内容类型中删除验证，并改为在（源）列表级别应用，则文档集将正确路由到记录中心中正确的目标文档库。

为了完整起见，我们还测试了在源和目标（记录中心）列表上应用列验证。在这种情况下，文档集再次被搁置在归还库中，并且未被内容组织者规则处理。很明显，记录中心的目标列表上的列验证在应用于打包的文档集zip文件时会失败。

# php - 将时间添加到mysql时间戳列，有条件

> ID：12182475
> 
> 赞同：0
> 
> 时间：2012-08-29T16:29:19.413
> 
> 标签：php, mysql

我的表中有 3 个与时间相关的列：

```
vreme_od (TIME), vreme_do(TIME), datum(CURRENT TIMESTAMP) 
```

`vreme_od`并且`vreme_do`有`H:i:s`时间值（和之间的差`vreme_od`是`vreme_do`1 小时），`vreme_do`可以从脚本更新。

问题是，我必须想出一个更新`vreme_do`到某个时间的捕获，比如说，21:00。

因此，例如，如果您在 20:53 启动脚本，`vreme_od`则`vreme_do`其值为“20:53:00”，并且在第二天应为“07:53:00”。

有人可以帮我解决这个问题，我被困了好几天......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:23:24.903

使用 CASE 语句，（全局）示例进行更新：

```
UPDATE table
 SET `date` = CASE
              WHEN CURRENT_TIMESTAMP>'23:00:00' 
              THEN CURRENT_TIMESTAMP + INTERVAL 40 MINUTE
              ELSE CURRENT_TIMESTAMP END
 WHERE ... 
```

天数将自动递增。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:58:44.330

您可以使用[AddTime 函数](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_addtime)使用 MySql 内置函数在第二列中添加一些小时。

# c++ - 在 C++ 中监控内存分配

> ID：12182476
> 
> 赞同：2
> 
> 时间：2012-08-29T16:29:23.527
> 
> 标签：c++, memory, memory-management, new-operator

在源代码中监视内存分配/取消分配的最佳方法是什么。我有一个动态分配大量内存的 C++ 程序，我想跟踪哪个对象从哪个类中获取和释放内存。

我想要的程序输出是：

```
Creating Object from ClassA, Memory Usage ...
Creating Object from ClassB, Memory Usage ...
...
Freeing  Object from ClassA, Memory Freed ... 
```

我现在所做的只是重载全局 new 运算符，但我听说它不是**很安全**。此外，我需要一种不需要更改所有类的方法（即使用基类并且所有类都有一个字符串变量ClassName）。

-------------------------------------**编辑**------------ --------------------------

1-我不想使用外部工具，需要在代码中进行。

2-如果我重载全局 new 运算符，我如何访问类或其他成员的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:32:08.147

看看 MS 工具叫做 application verifier 也看看 VS2010 profiler。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T17:17:34.550

> 2-如果我重载全局 new 运算符，我如何访问类或其他成员的名称？

你不能。您必须了解 new 和 delete 运算符不是直接的函数调用。实际上，类似的语法`MyClass* p = new MyClass();`等价于：

```
MyClass* p = (MyClass*) malloc(sizeof(MyClass)); // A) allocate the memory.
new(p) MyClass(); // B) call constructor (via placement-new syntax (to illustrate)). 
```

而 a`delete p;`相当于：

```
p->~MyClass();  // C) call destructor.
free(p);        // D) free the memory. 
```

当您重载 new-delete 运算符时，编译器实际上允许您重载的只是步骤 A) 和 D)。换句话说，当您到达自定义 new 运算符的主体时，该对象尚未创建，因此，您无法访问或打印有关它的任何信息（类、名称等），除了它在内存中的地址，您可以在重载的 new 中打印。同样，当您到达自定义删除运算符时，该对象已被销毁，并且任何尝试使用可能仍悬在该内存中的任何信息的任何尝试都是未定义的行为，特别是如果您想使用虚拟函数或字符串值。

实际上，使用这种方法可以做的最好的事情是打印在 new 运算符中创建的指针并打印由 delete 运算符删除的指针。

而且，正如其他人所提到的，在 new-delete 运算符中进行操作时，您必须警惕无限递归。例如，一个简单的行，如：

```
std::cout << "Created pointer: " << reinterpret_cast<std::size_t>(p) << std::endl; 
```

几乎肯定会导致对 new 和 delete 的许多调用（创建临时字符串、扩展缓冲区等）。

因此，您可能必须想出一个聪明的方法来输出您想要输出的日志消息，而不会导致任何新删除发生，或者您必须将新删除运算符重载限制为仅你的框架。对于后者，最简单的就是把它放在一个基类中。另一种选择是使用一点 MACRO 魔法，但这仍然会很麻烦而且很麻烦。

而且，此时，如果您必须创建一个基类（对于所有库的类）来处理创建删除的日志记录（或创建一组宏以放入您创建的每个类中），您可能会最好使用构造函数/析构函数作为打印这些日志消息的地方，并保持新删除操作符不变。

> 1-我不想使用外部工具，需要在代码中进行。

为什么不？外部工具（如 Valgrind 之类的 VM，或通用分析器/内存跟踪器）很可能会比您做得更好，侵入性更小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T16:36:54.667

我讨厌这个跟踪内存泄漏的工具，但是为了监控 allocs/dellocs 它应该做你想做的事：[UMDH](http://msdn.microsoft.com/en-us/library/windows/hardware/ff558947%28v=vs.85%29.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T16:37:42.750

这在很大程度上取决于您是只想在开发中还是在生产中进行，以及您的性能要求是什么。对于 Linux 上的开发，您通常会从[Valgrind 的 Massif](http://valgrind.org/docs/manual/ms-manual.html)开始，如果您正在寻找更自定义的解决方案和/或生产模式，您可能会考虑将 malloc/calloc/realloc 覆盖代码（我的示例[在这里](http://bobah.net/d4d/tools/cpp-heapmap)）与[libunwind](http://www.nongnu.org/libunwind/)结合起来。

# spring - 将 Thymeleaf 与 Tiles2 和 Spring 一起使用

> ID：12182481
> 
> 赞同：1
> 
> 时间：2012-08-29T16:29:43.460
> 
> 标签：spring, spring-mvc, thymeleaf

我正在尝试使用[Thymeleaf 与 Apache Tiles 2.x 的集成](https://github.com/thymeleaf/thymeleaf-extras-tiles2)。他们有一个如何让它工作的指南，所以我跟着它，但现在我被卡住了。

基本上，这种集成允许同时使用 JSP 和 Thymeleaf 模板，并且根据指南，您应该能够通过`type`在标题定义文件中设置属性来判断使用哪个模板。默认选项是 Thymeleaf。

因为我是慢慢从JSP迁移过来的，绝大多数的模板都是JSP，所以我需要使用这个`type`属性，但是然后我得到一个错误，我的标题定义文件无效：

```
org.apache.tiles.definition.DefinitionsFactoryException: XML error reading definitions.
at org.apache.tiles.definition.digester.DigesterDefinitionsReader.read(DigesterDefinitionsReader.java:332)
at org.apache.tiles.definition.dao.BaseLocaleUrlDefinitionDAO.loadDefinitionsFromURL(BaseLocaleUrlDefinitionDAO.java:276)
at org.apache.tiles.definition.dao.CachingLocaleUrlDefinitionDAO.loadDefinitionsFromURLs(CachingLocaleUrlDefinitionDAO.java:251)
at org.apache.tiles.definition.dao.ResolvingLocaleUrlDefinitionDAO.loadDefinitionsFromURLs(ResolvingLocaleUrlDefinitionDAO.java:65)
at org.apache.tiles.definition.dao.ResolvingLocaleUrlDefinitionDAO.loadParentDefinitions(ResolvingLocaleUrlDefinitionDAO.java:58)
at org.apache.tiles.definition.dao.CachingLocaleUrlDefinitionDAO.loadDefinitionsFromURLs(CachingLocaleUrlDefinitionDAO.java:239)
at org.apache.tiles.definition.dao.ResolvingLocaleUrlDefinitionDAO.loadDefinitionsFromURLs(ResolvingLocaleUrlDefinitionDAO.java:65)
... 
```

这是我的瓷砖定义文件：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE tiles-definitions PUBLIC
       "-//Apache Software Foundation//DTD Tiles Configuration 2.1//EN"
       "http://tiles.apache.org/dtds/tiles-config_2_1.dtd">

<tiles-definitions>
    <definition name="default" template="/WEB-INF/layouts/default.jspx" type="jsp">
    </definition>
</tiles-definitions> 
```

如果我删除`DOCTYPE`部分，我会得到同样的错误。

知道如何让它工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T12:54:40.557

该`type`属性仅存在于`<put-attribute/>`元素中。相比之下，`<definition/>`元素需要调用您的属性`templateType`。

问候。

# php - 存储jquery附加值

> ID：12182482
> 
> 赞同：0
> 
> 时间：2012-08-29T16:29:47.530
> 
> 标签：php, jquery, mysql, forms

我有一个 html 表单，我在其中添加了一些元素，例如，当用户从列表中选择多个国家时，jquery 会遍历所选列表并为每个国家/地区创建一组表单字段。

假设用户选择了美国、中国和印度，那么将为每个国家创建表单字段，将 id asn 命名为 *countryName_indexValue, customeName_countryName_indexValue.*

**我的问题：** 当用户填写并点击提交按钮时，我需要通过 php 将此附加元素值提交到 mysql 数据库。我该怎么做？请帮我......

结果是这样的

```
<form>

<table>
<thead>
<tr>
<td>Country Name</td>
<td>Data01</td>
<td>Data02</td>
</tr>
</thead>

<!-- APPENDED ELEMENTS -->

<tbody>
<tr id="usa_0">
<td><input type="text" name="userCountry_usa_0" id="userCountry_usa_0"></td>
<td><input type="text" name="countryData01_usa_0" id="countryData01_usa_0"></td>
<td><input type="text" name="countryData02_usa_0" id="countryData02_usa_0"></td>
</tr>

<tr id="china_1">
<td><input type="text" name="userCountry_china_1" id="userCountry_china_1"></td>
<td><input type="text" name="countryData01_china_1" id="countryData01_china_1"></td>
<td><input type="text" name="countryData02_china_1" id="countryData02_china_1"></td>
</tr>

<tr id="india_2">
<td><input type="text" name="userCountry_india_2" id="userCountry_india_2"></td>
<td><input type="text" name="countryData01_india_2" id="countryData01_india_2"></td>
<td><input type="text" name="countryData02_india_2" id="countryData02_india_2"></td>
</tr>
</tbody>

</table>

</form> 
```

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:34:04.043

那么问题是什么？您在提交数据时遇到问题了吗？或者您是否正在努力处理 PHP 端的 $_POST ？

如果它正在处理 $_POST，我建议您将生成的表单字段更改为具有表单的 id`userCountry[countryName][indexValue]`而不是`userCountry_countryName_indexValue`.

这样，当提交表单时，$_POST 将由数组组成，然后您可以循环写入数据库，例如 $_POST 将具有以下内容：

```
$_POST['userCountry'] = array( 'usa' => array( '0' => 'someValue'),
                               'china' => array( '1' => 'someOtherValue'),
                               'india' => array( '2' => 'yetAnotherValue'),
                        ) 
```

然后你可以循环这个，例如：

```
foreach($_POST['userCountry'] as $country=>$subArray) {
    //code here to insert data
} 
```

您当前的实现也可以使用循环，只要您遍历整个 $_POST 对象，检查每个键，并查找特定的子字符串，在下划线上爆炸，然后处理，但它会有点难看.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-29T16:43:49.190

在表单提交事件或元素单击时，您可以使用 jQuery 的 .post() 或 .get() 函数将输入值发送到 php 文件。

以下是关于如何使用 .post() 的一些基本和更复杂的示例：http: [//api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

强烈建议 php 文件包含数据验证，然后您可以从那里发出带有 php 的 sql insert。

# spring - apache-commons-dbcp 连接池 - 在开发中工作，而不是在其他环境中

> ID：12182486
> 
> 赞同：0
> 
> 时间：2012-08-29T16:30:21.463
> 
> 标签：spring, apache-commons-dbcp

我有一个使用 Spring 和 apache-commons-dbcp 的 Struts2 WebApp。在我的本地开发环境中运行时，应用程序打开的连接数不超过 8 个，这是 maxActive 的默认值。

但是，一旦将 WAR 移动到测试服务器——运行与我的开发箱相同版本的 Tomcat（6.0.35）——应用程序打开更多的连接。几分钟后，我可以打开大约 40 个连接，而开发中的相同测试仅导致 8 个连接。

这似乎是两个环境之间的配置问题，但我不确定我在寻找什么。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:07:32.153

原来我的本地 Tomcat 实例正在设置这个 Java 选项：

-XX:+UseConcMarkSweepGC

测试和生产服务器不是。启用它解决了这个问题。

# html - Facebook - 更改缩略图

> ID：12182491
> 
> 赞同：2
> 
> 时间：2012-08-29T16:30:30.667
> 
> 标签：html, facebook, image, facebook-like, thumbnails

我需要像缩略图一样更改 facebook，我已经尝试过了

```
<link rel="image_src" href="thisurl" /> 
```

和这个

```
<meta property="og:image" content="thisurl"/> 
```

后来我意识到这需要放在头脑中，但是由于代码的结构，我无法在其中修改并仍然决定我需要哪个 url（我无法访问我为那里的图像所拥有的变量)，我可以这样修改

```
<html>
<head></head>
<body>
...
modify in here
...
</body>
</html> 
```

我还尝试在我可以更改的区域中使用 javascript 创建一个元标记，但这不会影响它

有谁知道我可以告诉facebook我想要哪个图像作为缩略图而无需修改头部元素内部的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:08:31.697

正如您所说，缩略图应该放在标题中，使用 rel="image_src" 或 opengraph 标签。

## 在您的 html 正文中指定缩略图

如果 Facebook 无法从标题中获取您的缩略图，它会尝试从内容中获取它。它通常采用它喜欢的第一张图片，因此如果您想强制页面中不包含特定的缩略图，请在标签之后放置一个不可见的图片（使用内联 css *display:none ）：*

```
<img src=”http://www.website.com/images/thumbnail.jpg” alt=”thumbnail” height=”200″ width=”250″ style=”display:none” /> 
```

这样做，请记住：

*   避免缩略图名称中的空格（FB 不能很好地管理空格）
*   使用 jpg（FB 不喜欢 png）
*   使用正确的尺寸（见下文）

## 检查缩略图的尺寸

Facebook 不喜欢各种尺寸的缩略图。最重要的是高度和宽度之间的比例应该小于1/3。所以 40 & 100 可以，但 30 & 100 不行。此外，Facebook 最近似乎更喜欢两个尺寸至少为 200 像素的图像（但不要忘记 1/3 规则）。

## 清理 Facebook 缓存

此外，您应该在每次测试之前使用 Facebook 调试工具（曾经称为*Facebook Linter*）清理 Facebook 缓存：http: [//developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)

在表单字段中插入您的网址，然后按调试。您将强制 Facebook 覆盖其有关您的链接的信息。有时您认为仍然有问题，但这只是因为它使用了错误的页面缓存版本。

关于 Facebook Linter，请注意（根据他的 OGraph 文档）：

> 您可以通过更新页面的标签来更新页面的属性。请注意，og:title 和 og:type 最初只能编辑 - 在您的页面收到 50 个赞后，标题变为固定，在您的页面收到 10,000 个赞后，类型变为固定。这些属性是固定的，以避免让已经喜欢该页面的用户感到惊讶。达到这些限制后更改标题或类型标签没有任何作用，您的页面将保留原始标题和类型。

# sql - 如何使用通配符连接两个表列？

> ID：12182493
> 
> 赞同：1
> 
> 时间：2012-08-29T16:30:36.667
> 
> 标签：sql, ms-access, jet

我正在使用访问 97。

这就是我想做的：

```
SELECT *
FROM CodeDIS, ListOfProducts
WHERE CodeDIS.IDNumber LIKE ListOfProducts.IDNumber*; 
```

有时 ListOfProducts 上的 IDNumber 有一个额外的字母，表示有关产品的一些信息。

所以我在 CodeDIS 上有 IDNumber AC244，但在 ListOfProducts 上有 AC244P。

我想要的只是在条件的末尾添加一个通配符。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:25:41.357

如果选择是 C 或 P，为什么不：

```
SELECT *
FROM CodeDIS, ListOfProducts
WHERE CodeDIS.IDNumber = ListOfProducts.IDNumber & "C"
OR CodeDIS.IDNumber = ListOfProducts.IDNumber & "P" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:34:35.837

怎么样：

```
SELECT * 
FROM CodeDIS, ListOfProducts 
WHERE CodeDIS.IDNumber LIKE left(ListOfProducts.IDNumber,5); 
```

或者如果你喜欢：

```
SELECT * 
FROM CodeDIS a inner join ListOfProducts b on a.IDNumber = left(b.IDNumber,5); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-16T21:26:02.443

我知道这是旧的，但我没有发布太多，如果有的话，我想我会在这里尝试。

如果最后一个数字始终是字符，为什么不使用带有 PATINDEX 测试的子字符串函数呢？我确定我的代码效率极低，但这是我的初学者尝试。我敢打赌，有些人会把我的案例陈述打得更小。

```
-- I used the code below
-- It only works if the final digit is lower or uppercase letter of 
-- specified language.
DECLARE @CodeDIS TABLE (IdNumber nvarchar(50), BaseRowNum nvarchar(50));

insert into @CodeDIS (IdNumber,BaseRowNum) values ('52352345','1')
insert into @CodeDIS (IdNumber,BaseRowNum) values ('134131','2')
insert into @CodeDIS (IdNumber,BaseRowNum) values ('1343141','3')
insert into @CodeDIS (IdNumber,BaseRowNum) values ('a143321','4')
insert into @CodeDIS (IdNumber,BaseRowNum) values ('c34324','5')
insert into @CodeDIS (IdNumber,BaseRowNum) values ('1343214','6')
insert into @CodeDIS (IdNumber,BaseRowNum) values ('%134324','7')
insert into @CodeDIS (IdNumber,BaseRowNum) values ('a%134324','8')
insert into @CodeDIS (IdNumber,BaseRowNum) values ('1413','9')
;
DECLARE @ListOfProducts TABLE (IdNumber nvarchar(50), UpdateSourceDataColumn nvarchar(50));

insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('52352345a','11')
insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('134131','22')
insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('1343141a','33')
insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('a143321','44')
insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('c343245','55')
insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('1343214Z','66')
insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('%134324','77')
insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('a%134324','88')
insert into @ListOfProducts (IdNumber,UpdateSourceDataColumn) values ('1413\','99')
;
SELECT a.*,b.IdNumber as IdNumber2, b.UpdateSourceDataColumn
    FROM @CodeDIS a 
    left join @ListOfProducts b
    on a.IdNumber = 
      case 
        when PATINDEX(
          '[a-zA-Z]', 
          substring(b.IdNumber,len(b.IdNumber),1) 
          COLLATE Latin1_General_CS_AS
        )=1
        then left(b.IdNumber,len(b.IdNumber)-1)
        else b.IdNumber
      end
    ;     
--IdNumber  BaseRowNum  IdNumber2   UpdateSourceDataColumn
--52352345  1           52352345a   11
--134131    2           134131      22
--1343141   3           1343141a    33
--a143321   4           a143321     44
--c34324    5           NULL        NULL
--1343214   6           1343214Z    66
--%134324   7           %134324     77
--a%134324  8           a%134324    88
--1413      9           NULL        NULL 
```

# c# - 从数据格式化字符串

> ID：12182494
> 
> 赞同：0
> 
> 时间：2012-08-29T16:30:38.147
> 
> 标签：c#, linq, grouping

我有这样的数据：

```
Name    Update
CC      12/31/2012
CS      12/31/2012
CI      04/30/2013
CR      04/30/2013 
```

我需要这个输出：

```
Annual CC/CS Update: 12/31/2012
Annual CI/CR Update: 04/30/2013 
```

但是，如果我的数据是这样的：

```
Name    Update
CC      12/31/2012
CI      04/30/2013 
```

我需要这个输出：

```
Annual CC Update: 12/31/2012
Annual CI Update: 04/30/2013 
```

不知道如何完成这项任务。

**顺便说一句，在 ASP.Net MVC3 中使用 Razor**

试试这个：（注意 AllianceDesignations 定义为 Designation[]）

```
<div class="span6">
    @AllianceDesignations.GroupBy(x => x.UpdateDue).Select(g => String.Format("<p>Annual {0} Update: {1}</p>", String.Join("/", g.Select(y => y.Name).ToArray()), g.Key))
</div> 
```

显示这个：

```
<div class="span6">
    System.Linq.Enumerable+WhereSelectEnumerableIterator`2[System.Linq.IGrouping`2[System.DateTime,MVC3MyPage.MyPageService.Designation],System.String]
</div> 
```

另外，我已经将它们放入字典中以供其他用途，如下所示：

```
Dictionary<string, Designation> Designations = new Dictionary<string, Designation>(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:58:13.100

```
var designationsByDate = allianceDesignations.GroupBy(designation => designation.UpdateDue).OrderBy(values => values.Key);
string[] rowsOfData = designationsByDate.Select(designationByDate => {
    string annual = designationByDate.Aggregate(string.Empty, (acc, designation) => acc + "/" + designation.Name);
    return string.Format("Annual {0} Update {1}", annual, designationByDate.Key);
}).ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:32:31.320

您可以利用 LINQ 的[GroupBy 扩展](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.groupby.aspx)。一旦你检索到你的记录（假设你的类是 Record），你就可以通过 LINQ 扩展查询你的结果。代码可能并不完美，但它应该给你正确的想法。

```
IEnumerable<Record> records = ....
var groups = records.GroupBy( f => f.Update );

foreach( IEnumerable<Record> r in groups ){
  Write( String.Join( "/", r.Select( rec => rec.Name ).ToArray() ), r.First().Update ) );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:33:11.243

首先[group by](http://msdn.microsoft.com/en-us/library/bb534501.aspx) `Update`，然后[`String.Join`](http://msdn.microsoft.com/en-us/library/57a79xd0.aspx)是每个组中的名称（未经测试）：

```
data.GroupBy(x => x.Update)
    .Select(g => String.Format("Annual {0} Update: {1}", String.Join("/", g.Select(y => y.Name).ToArray()), g.Key) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T16:51:41.710

如果您的数据源是 SQL，您可以尝试这样的查询：

```
select Update , Name
from my_table
order by Update , Name 
```

现在您的数据已正确排序。您可以在没有 linq 的情况下阅读并对其进行分组，如下所示：

```
using ( SqlConnection conn = new SqlConnection( "some connect string" ) )
using ( SqlCommand    cmd  = conn.CreateCommand() )
{
  cmd.CommandText = @"select Update , Name from my_table order by Update , Name" ;
  cmd.CommandType = CommandType.Text ;

  using ( SqlDataReader reader = cmd.ExecuteReader() )
  {
    DateTime     prev_update = DateTime.MinValue ;
    List<string> names       = new List() ;
    while ( reader.Read() )
    {
      DateTime update = reader.GetDateTime( 0 ) ;
      String   name   = reader.GetString(   1 ) ;

      if ( update != prev_update )
      {
        if ( name.Length > 0 )
        {
          Console.WriteLine( "Annual {0} Update: {1}" , string.Join( "/" , names ) , prev_update ) ;
        }
        names.Clear() ;
        prev_update = update ;
      }

      names.Add( name ) ;

    }
    reader.Close() ;
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T17:11:29.640

不确定您是否正在从文件中读取，并且对确切的格式有点不清楚，但这里有一些代码可以在从您指定的格式的纯文本文件中读取时执行您想要的操作。

```
//used to store converted data
Dictionary<string, string> data = new Dictionary<string, string>();

//open file, read line by line and store values as needed
using (TextReader tr = File.OpenText("test.txt"))
{
    //throw away header line
    string line = tr.ReadLine();
    while ((line = tr.ReadLine()) != null)
    {
        string[] values = line.Split((char[])null, StringSplitOptions.RemoveEmptyEntries);

        if (data.ContainsKey(values[1]))
            data[values[1]] += "/" + values[0];
        else
            data.Add(values[1], values[0]);
    }
}

//print results
foreach (string date in data.Keys)
    Console.WriteLine(String.Format("Annual {0} Update: {1}", data[date], date)); 
```

输入：

```
Name    Update
CS      12/31/12
CI      12/31/12
CL      01/16/13
CS      01/16/13 
```

输出：

```
Annual CS/CI Update: 12/31/12
Annual CL/CS Update: 01/16/13 
```

# varnish - 如何在 varnishlog 中生成 PASS url 列表？

> ID：12182500
> 
> 赞同：0
> 
> 时间：2012-08-29T16:30:53.617
> 
> 标签：varnish, varnish-vcl

我正在尝试生成一个简单的从 Varnish 获得“PASS”的 url 列表。varnishlog 是一个很棒的实用程序，但它似乎无法执行此任务，因为它主要记录 HITS，并且没有 PASS 标记。

知道是否有办法记录这个吗？也许在 vcl_pass 子程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:49:20.380

没关系……我明白了。

varnishlog -b -k 5000 -i TxURL

# arrays - AS2中的数组重复使用时是否必须重置到开头？

> ID：12182501
> 
> 赞同：-1
> 
> 时间：2012-08-29T16:30:58.877
> 
> 标签：arrays, flash, actionscript-2

我正在使用一组较旧且未记录的 ActionScript (AS2)，我发现一个数组在第二次循环遍历它时没有给出正确的结果。自从我使用 ActionScript 以来已经有一段时间了 - 是否需要在第二次通过另一个 for 循环之前重置数组？

例如 PHP 有 reset() ，它将数组的指针返回到数组中的第一项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:23:42.237

ActionScript 中没有指针之类的东西。您可以通过简单地使用 myArray[index] 来定位 Array 中的每个项目，并且无需重置指针即可重新读取它。

如果您的两个循环产生不同的结果，我建议您查看可以在两个循环之间或第一个循环中更改其中任何内容的代码。也许你可以把它贴在这里？

# javascript - 未找到 javascript 元素

> ID：12182503
> 
> 赞同：0
> 
> 时间：2012-08-29T16:31:16.180
> 
> 标签：javascript, .net, ajax

我的应用程序中有一个“导出到 excel”选项。当我单击该按钮时，我正在向用户显示一条确认消息。当用户单击确定时，我正在使用 JavaScript 调用单击事件。

```
<asp:Content ID="Content3" ContentPlaceHolderID="PagePlaceholder" runat="Server">
<asp:ScriptManager ID="smMainpage" runat="server">
</asp:ScriptManager>
<table style="width: 100%">
    <tr>
        <td colspan="2">
            <asp:UpdatePanel runat="server" ID="up">
                <ContentTemplate>
                    <div style="text-align: left; font-size: 8pt" id="div5" runat="server">
                        <table width="100%" cellpadding="0" cellspacing="0">
                            <tr>
                                <td align="right" style="width: 50%">
                                    <table>
                                        <tr>
                                            <td style="display: none">
                                                <asp:Button ID="btnblkupdate" runat="server" Text="None" OnClick="btnblkupdate_click" />
                                                <div>
                                                    <asp:Button ID="btnhdnExport" runat="server" OnClick="btnhdnExport_click" /></div>
                                            </td>
                                            <td>
                                                &nbsp;
                                                <asp:LinkButton ID="lnkExport" OnClick="lnkExport_Click" CssClass="customFont" runat="server"
                                                    Text="Export to Excel"></asp:LinkButton>
                                                &nbsp;
                                            </td>
                                            <td>
                                                &nbsp;
                                                <asp:LinkButton ID="lnkbtnFilter" OnClick="lnkbtnFilter_Click" CssClass="customFont"
                                                    runat="server" Text="Filter Data"></asp:LinkButton>
                                                &nbsp;
                                            </td>
                                            <td>
                                                <asp:LinkButton ID="lnkReset" OnClick="lnkReset_Click" Visible="false" CssClass="customFont"
                                                    runat="server" Text="Reset Filter"></asp:LinkButton>
                                                &nbsp;
                                            </td>
                                            <td>
                                                <asp:LinkButton ID="lnkbtnViewAll" OnClick="lnkbtnViewAll_Click" runat="server" Text="View All"></asp:LinkButton>
                                                &nbsp; Selected Records:<asp:Label ID="lblselTsks" Width="20px" Font-Size="10pt"
                                                    Font-Bold="true" runat="server" Text="0"></asp:Label>
                                                &nbsp;
                                            </td>
                                            <td>
                                                Total Records found:&nbsp;<asp:Label ID="lblTotRecCount" Font-Bold="true" runat="server"
                                                    ForeColor="Black" Font-Size="10pt" Text="0"></asp:Label>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </div>
                </ContentTemplate>
                <Triggers>
                    <asp:PostBackTrigger ControlID="lnkExport" />
                    <asp:PostBackTrigger ControlID="btnhdnExport" />
                </Triggers>
            </asp:UpdatePanel>
            <asp:UpdateProgress ID="UpdateProgress5" EnableViewState="false" AssociatedUpdatePanelID="up"
                DisplayAfter="10" runat="server">
                <ProgressTemplate>
                </ProgressTemplate>
            </asp:UpdateProgress>
        </td>
    </tr>
</table> 
```

```
protected void lnkExport_Click(object sender, EventArgs e)
{
    DataSet dsResult = new DataSet();
    try
    {
        string strName = string.Empty;
        clsSearch_BL clsObj = new clsSearch_BL();
        //dsResult = (DataSet)Session["SearchRes"];

        if (Session["detObj"] != null)
        {
            DetState detObj = (DetState)Session["detObj"];
            dsResult = clsObj.getSearchResults_BL(detObj);
            HashSet<string> orderIdclmtest = new HashSet<string>();
            int j = dsResult.Tables[0].Rows.Count;
            for (int k = 0; k < j; k++)
            {
               orderIdclmtest.Add( dsResult.Tables[0].Rows[k][1].ToString());
            }
             Session["orderIdclmtest"] = orderIdclmtest.ToString();

            HashSet<string> strtest = new HashSet<string>();
            strtest =(HashSet<string>)Session["orderIdclm"];

            var testttt=strtest.Except(orderIdclmtest).ToList();
            int cnt = testttt.Count;
            StringBuilder str = new StringBuilder();
            for (int i = 0; i < cnt; i++)
            {
                if (str.Length == 0)
                    str.Append(testttt[i]);
                else
                    str.Append(", " + testttt[i]);
            }
            ScriptManager.RegisterClientScriptBlock(this.up, this.GetType(), "export", "hdnExportExcel()", true);
            //if (testttt != null && testttt.Any())
            //{
            //    ScriptManager.RegisterClientScriptBlock(this.up, this.GetType(), "export", "hdnExportExcel('"+str+"')", true);
            //}
        }
    }
    catch (Exception ex)
    {
        log4net.Config.XmlConfigurator.Configure();
        log.Warn("Logging:" + ex);

    }
    finally {
        if(dsResult != null)
        dsResult.Dispose();
    }
}

function hdnExportExcel() {
if (confirm('You are about to miss the tasks do you want to continue?')) {
    document.getElementById('ctl00_PagePlaceholder_btnhdnExport').click();
}
else {
    return false;
}} 
```

我的问题是我得到`document.getElementById('ctl00_PagePlaceholder_btnhdnExport')`的是空的。但在页面的源代码中，我可以看到元素 ID 为`ctl00_PagePlaceholder_btnhdnExport`

我不知道为什么它不起作用。我猜这是因为更新面板中的回发触发器。我尝试放置`btnhdnExport`外部更新面板并将其从触发器选项中删除。但它没有用。有什么建议么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:01:46.480

正如 Ankur 所说，在加载 JavaScript 时（页面正在动态创建），您的元素 ID 无法访问。

我会建议改变

`document.getElementById('ctl00_PagePlaceholder_btnhdnExport')`

至

`document.getElementById('btnhdnExport')`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:55:47.820

当 UpdatePanel 更新时，它会替换其容器中的所有内容`<div>`。在调用您的 JS 代码时，该按钮实际上并不存在。解决此问题的一种方法是在 UpdatePanel 完成后使用 .NET 的 PageRequestManager 调用 JS 代码。尝试这样的事情：

```
function hdnExportExcel() {

  var prm = Sys.WebForms.PageRequestManager.getInstance();
  prm.add_pageLoaded(function() {

      if (confirm('You are about to miss the tasks do you want to continue?')) {
          document.getElementById('<%= btnhdnExport.ClientID %>').click();
      }
      else {
          return false;
      }
  }

} 
```

您会注意到我也没有对按钮的 ID 值进行硬编码。您需要避免对 .NET 动态生成的任何 id 值进行硬编码，因为它们会在您的页面结构将来发生变化时发生变化。在页面的其他地方进行不相关的更改并在测试或以后发现以前可靠的功能现在被破坏了，这并不有趣。

# spring - Spring测试@ContextConfiguration和静态上下文

> ID：12182505
> 
> 赞同：3
> 
> 时间：2012-08-29T16:31:18.530
> 
> 标签：spring, junit

我的抽象测试类有以下代码（我知道`XmlBeanFactory`with`ClassPathResource`已被弃用，但不太可能出现问题）。

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration
public abstract class AbstractIntegrationTest {

    /** Spring context. */
    protected static final BeanFactory context = new XmlBeanFactory(new ClassPathResource(
            "com/.../AbstractIntegrationTest-context.xml"));

    ...

} 
```

它加载默认的测试配置 XML 文件`AbstractIntegrationTest-context.xml`（然后我使用自动装配）。我还需要在用`@BeforeClass`and注释的静态方法中使用 Spring `@AfterClass`，所以我有一个单独的上下文变量指向同一个位置。但问题是这是一个单独的上下文，它将有不同的 bean 实例。那么如何合并这些上下文，或者如何`@ContextConfiguration`从我的静态上下文中调用 Spring 的 bean 初始化？

我想到了一个可能的解决方案，摆脱那些静态成员，但我很好奇，如果我可以通过对代码进行相对较小的更改来做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T16:38:57.063

您是对的，您的代码将生成两个应用程序上下文：一个将通过`@ContextConfiguration`注释为您启动、缓存和维护。您自己创建的第二个上下文。两者兼有并没有多大意义。

不幸的是，JUnit 不太适合集成测试——主要是因为你不能*在课前*和*课后*使用非静态方法。我看到你有两个选择：

*   切换到[testng](/questions/tagged/testng "显示标记为“testng”的问题") - 我知道这是一大步

*   仅在测试期间在上下文中包含的 Spring bean 中编码您的设置/拆除逻辑 - 但它只会在所有测试之前运行一次。

还有一些不太优雅的方法。您可以使用`static`变量并向其注入上下文：

```
private static ApplicationContext context;

@AfterClass
public static afterClass() {
    //here context is accessible
}

@Autowired
public void setApplicationContext(ApplicationContext applicationContext) {
    context = applicationContext;
} 
```

或者您可以使用一些测试 bean 注释您的测试类[`@DirtiesContext`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/test/annotation/DirtiesContext.html)并进行清理：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration
@DirtiesContext(classMode = AFTER_CLASS)
public abstract class AbstractIntegrationTest {

    //...

}

public class OnlyForTestsBean {

    @PreDestroy
    public void willBeCalledAfterEachTestClassDuringShutdown() {
        //..
    }

} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-06T07:20:55.040

不确定您是否在这里选择了任何方法，但我遇到了同样的问题并使用 Spring 测试框架的[`TestExecutionListener`](http://docs.spring.io/spring/docs/3.1.4.RELEASE/javadoc-api/org/springframework/test/context/TestExecutionListener.html#beforeTestClass%28org.springframework.test.context.TestContext%29).

有`beforeTestClass`and ，所以在 JUnit 中`afterTestClass`都等价于`@BeforeClass`and 。`@AfterClass`

我这样做的方式：

```
@RunWith(SpringJUnit4ClassRunner.class)
@TestExecutionListeners(Cleanup.class)
@ContextConfiguration(locations = { "/integrationtest/rest_test_app_ctx.xml" })
public abstract class AbstractIntegrationTest {
    // Start server for integration test.
} 
```

您需要创建一个扩展 AbstractTestExecutionListener 的类：

```
public class Cleanup extends AbstractTestExecutionListener
{

   @Override
   public void afterTestClass(TestContext testContext) throws Exception
   {
      System.out.println("cleaning up now");
      DomainService domainService=(DomainService)testContext.getApplicationContext().getBean("domainService");
      domainService.delete();

   }
} 
```

通过这样做，您可以访问应用程序上下文并在此处使用 spring bean 进行设置/拆卸。

希望这可以帮助任何尝试像我一样使用 JUnit + Spring 进行集成测试的人。

# c++ - Cocos2dx 动画（不使用过时的方法）

> ID：12182507
> 
> 赞同：0
> 
> 时间：2012-08-29T16:31:21.423
> 
> 标签：c++, objective-c, animation, cocos2d-x

我试图了解动画是如何工作的`cocos2dx`（我正在为 iPad 目标开发 OSX）。

我已按照本[教程](http://www.raywenderlich.com/1271/how-to-use-animations-and-sprite-sheets-in-cocos2d)尝试从`objective-c`到`C++`.

这是我的代码：

```
CCSpriteFrameCache::sharedSpriteFrameCache()->addSpriteFramesWithFile("oras.plist");

CCSpriteBatchNode* spriteBatchNode = CCSpriteBatchNode::create("oras.png", 8);
this->addChild(spriteBatchNode);

CCAnimation *bearWalkingAnimation = CCAnimation::create();

for (int i = 0 ; i < 8 ; ++i )
{

    std::stringstream ss;
    ss << "bear" << i + 1  << ".png";

    std::string name = ss.str();
    CCSpriteFrame* sprite =  CCSpriteFrameCache::sharedSpriteFrameCache()->spriteFrameByName(name.c_str());
    bearWalkingAnimation->addSpriteFrame(sprite);

}

CCSpriteFrame *startSpriteFrame = static_cast<CCSpriteFrame *> (bearWalkingAnimation->getFrames()->objectAtIndex(0));

//deprecated
CCSprite *startSprite = CCSprite::spriteWithSpriteFrameName("bear1.png"); 
startSprite->setPosition(ccp (size.width / 2 , size.height / 2));

CCAnimate *bearAnimate = CCAnimate::create(bearWalkingAnimation);

CCRepeatForever * animAction = CCRepeatForever::create(bearAnimate);
startSprite->runAction(animAction);

this->addChild(startSprite); 
```

Bear 正确渲染但没有动画。我有两个问题：

*   **首先也是最重要的**：我做错了什么，为什么？如何修复我的代码以使动画工作？
*   **第二个问题**：`spriteWithSpriteFrameName`不**推荐使用**。我应该改用哪种方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:10:01.603

第一的：

我认为您忘记为 CCAnimation 设置延迟。我对2.0不熟悉，但我想应该有一种方法可以设置延迟。或者您可以先创建一个 SpriteFrames 数组，然后使用该方法

```
CCAnimation::create(array,delay); 
```

第二：

```
CCSprite::createWithSpriteFrameName(); 
```

# javascript - 用于游戏声音的无头 jplayer

> ID：12182508
> 
> 赞同：2
> 
> 时间：2012-08-29T16:31:29.597
> 
> 标签：javascript, jplayer

是否可以在适合基于 HTML 的游戏的无头模式中使用 jplayer？如果是这样，怎么做？我想建立播放列表并用 JavaScript 播放它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-15T10:32:24.800

这不是 jPlayer，但我在[SoundJS](http://www.createjs.com/?_escaped_fragment_=/SoundJS#!/SoundJS)上取得了成功。

# c# - 玩弄 C# 加密

> ID：12182509
> 
> 赞同：1
> 
> 时间：2012-08-29T16:31:30.127
> 
> 标签：c#, powershell, encryption

一直在尝试冒险学习一些 C# 和 powershell，给自己一些小项目来尝试和学习。最近，我一直在尝试将一些代码从 powershell 转换为 C#，我相信我可以正常工作，但是在为 RijndaelManaged 创建 IV 时遇到了一些错误。

这是从互联网上提取的运行良好的 powershell 代码

```
function Decrypt-String($Encrypted, $Passphrase, $salt, $init="Yet another key")
{
   if($Encrypted -is [string]){
      $Encrypted = [Convert]::FromBase64String($Encrypted)
   }
   $r = new-Object System.Security.Cryptography.RijndaelManaged
   $pass = [System.Text.Encoding]::UTF8.GetBytes($Passphrase)
   $salt = [System.Text.Encoding]::UTF8.GetBytes($salt)

   $r.Key = (new-Object Security.Cryptography.PasswordDeriveBytes $pass, $salt, "SHA1", 5).GetBytes(32) #256/8

   $r.IV = (new-Object Security.Cryptography.SHA1Managed).ComputeHash( [Text.Encoding]::UTF8.GetBytes($init) )[0..15]

   $d = $r.CreateDecryptor()
   $ms = new-Object IO.MemoryStream @(,$Encrypted)
   $cs = new-Object Security.Cryptography.CryptoStream $ms,$d,"Read"

   $sr = new-Object IO.StreamReader $cs
   Write-Output $sr.ReadToEnd()
   $sr.Close()
   $cs.Close()
   $ms.Close()
   $r.Clear()
} 
```

这是我把它移到的 C# 代码

```
public static string Decrypt_String(string cipherText, string passPhrase, string Salt)
{
    string hashAlgorithm = "SHA1";
    int passwordIterations = 5;
    initName = "Yet another key";
    using (RijndaelManaged r = new RijndaelManaged())
    {
        byte[] cipherTextBytes = Convert.FromBase64String(cipherText);
        byte[] PassPhraseBytes = Encoding.UTF8.GetBytes(passPhrase);
        byte[] SaltBytes = Encoding.UTF8.GetBytes(Salt);
        byte[] initVectorBytes = Encoding.UTF8.GetBytes(initName);

        PasswordDeriveBytes password = new PasswordDeriveBytes(PassPhraseBytes,SaltBytes,hashAlgorithm,passwordIterations);
        byte[] keyBytes = password.GetBytes(32); //(256 / 32)
        r.Key = keyBytes;

        SHA1Managed cHash = new SHA1Managed();
        r.IV = cHash.ComputeHash(Encoding.UTF8.GetBytes(initName),0,16);

        ICryptoTransform decryptor = r.CreateDecryptor();
        MemoryStream memoryStream = new MemoryStream(cipherTextBytes);
        CryptoStream cryptoStream = new CryptoStream(memoryStream,
                                                  decryptor,
                                                  CryptoStreamMode.Read);
        StreamReader streamReader = new StreamReader(cryptoStream);
        string output = streamReader.ReadToEnd();
        return output;
    }

} 
```

目前 ComputeHash 正在吐出一个错误，告诉我该值无效。这是我从工作加密函数中使用的值

密文 = "s6ZqNpJq05jsMh2+1BxZzJQDDiJGRQPqIYzBjYQHsgw="

saltValue = "}=[BJ8%)vjJDnQfmvC))))3Q"

密码 = "S@lt3d"

关于为什么 IV 无法正确设置的任何想法？

编辑：对不起，例外是

```
Line 38:             r.IV = cHash.ComputeHash(initVectorBytes, 0, 16);

Exception Details: System.ArgumentException: Value was invalid. 
```

一种通用的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:17:47.417

@Nate 是正确的，您正在使用该`ComputeHash`方法的不同重载，并且您没有正确处理它：

```
Encoding.UTF8.GetBytes(initName) 
```

这将返回一个与您的字符串长度相同的字节数组 - **15**。但是通过传递`0`and `16`，您要求`ComputeHash`使用数组的前**16 个**元素。

```
cHash.ComputeHash(Encoding.UTF8.GetBytes(initName),0,16); 
```

因此，第一个解决方法是通过`0`and `15`（或者可能是`0`and `initName.Length`），或者更好的是，返回到您在 powershell 脚本中使用的重载，它会自动计算出数组长度：

```
cHash.ComputeHash(Encoding.UTF8.GetBytes(initName)); 
```

但是您需要缩短结果数组（它返回长度 20，但您只需要 16）：

```
using System.Linq;
...
cHash.ComputeHash(Encoding.UTF8.GetBytes(initName)).Take(16).ToArray(); 
```

# yii - 如何避免 Yii 使用我们的标签？

> ID：12182511
> 
> 赞同：0
> 
> 时间：2012-08-29T16:31:36.033
> 
> 标签：yii

如果我们这样称呼：

```
<?php echo $form->label($model,'Hello my friend'); ?> 
```

我们在视口上输出如下：

> “朋友你好”

在 CSS 上，我在任何**地方都****没有**说**大写**。

 **我们怎样才能改变这种行为？

我尝试编辑 CSS 并制作：

```
label {
text-transform: none !important;
} 
```

没运气。

我们怎么能有

> 朋友你好

完全按照我们写的那样打印？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T16:41:48.330

而不是在视图文件上这样做：

```
<?php echo $form->label($model, 'Hello my friend'); ?> 
```

我们已将其更改为：

```
<?php echo $form->label($model, 'hello_friend'); ?> 
```

其中 hello_friend 在相应的模型方法 attributeLabels() 上定义，如下所示：

```
'hello_friend' => 'Hello my friend') 
```

所以，正如 bool.dev 所说，我们必须放置属性名称而不是随机字符串。**

# matlab - MATLAB 向量、角度、绘图

> ID：12182512
> 
> 赞同：4
> 
> 时间：2012-08-29T16:31:39.490
> 
> 标签：matlab, vector, plot, angle

我为这个模棱两可的标题道歉，但我不完全确定如何表达这个标题。所以请耐心等待。

我有一个数据矩阵。每一列和每一行代表一个向量（第1列=第1行，第2列=第2行等），每个单元格值是对应向量之间的余弦相似度。所以矩阵中的每个值都是余弦。

我想做几件事。首先，我想创建一个显示其上所有向量的图形。我知道每个向量之间的角度的余弦，并且我知道每个向量的大小，但这是我拥有的唯一信息 - 是否有一些我可以实现的算法将贯穿所有不同的成对角度并显示它以图形方式显示？也就是说，我不知道所有向量之间的关系在哪里，并且有太多数据点无法手动执行此操作（例如，如果我只有三个向量，并且它们之间的角度都是 45、12 ，而 72 度将是微不足道的）。那么我该怎么做呢？我什至不知道我需要什么样的数学函数来做到这一点。（我有 83 个向量，所以有数千个余弦值）。

我想做的另一件事更简单，但我很难弄清楚。我可以将余弦值转换为笛卡尔坐标并将它们显示在散点图中。有没有办法将散点图的每个点连接到图上的（0,0）？

最后，在试图弄清楚如何自己完成上述一些操作时，我遇到了一些不一致的情况。我计算了 83 个向量中每个向量的平均角度和笛卡尔坐标。数学很简单，我已经检查并仔细检查了它。然而，当我尝试绘制它时，不同的绘制方法给了我完全不同的东西。因此，如果我将笛卡尔坐标绘制为散点图，我会得到：

![在此处输入图像描述](../Images/070beaebf709247202443375569f4575.png)

如果我在罗盘图中绘制平均角度，我会得到：

![在此处输入图像描述](../Images/c771c83d84d3ffa31ffbcc8af33cf7d1.png)

如果我使用箭袋图，我会得到这样的结果（我通过将原点向上和向右移动来稍微改变它，以便您可以更好地看到它）：

![在此处输入图像描述](../Images/f926a864f403c5f26f236d85257a0936.png)

我做错了什么，还是我误解了我正在使用的绘图功能？因为这些结果看起来都非常不一致。罗盘图上的平均角度都小于 30 度左右，但在箭袋图上有些似乎超过 90 度，在散点图上它们也延伸到 30 度以上。这里发生了什么？

（这是我的代码：）

```
cosine = load('LSA.txt');

[rows,columns]=size(cosine);
p = cosine.^2;
pp = bsxfun(@minus, 1, p);
sine = sqrt(pp);
tangent = sine./cosine;

Xx = zeros(rows,1);
Yy = zeros(rows,1);
for i = 1:columns
    x = cosine(:,i);
    y = sine(:,i);
    Xx(i,1) = sum(x) * (1/columns);
    Yy(i,1) = sum(y) * (1/columns);
end

scatter(Xx,Yy);

Rr = zeros(rows,1);
Uu = zeros(rows,1);
for j = 1:rows
    Rr(j,1) = sqrt(Xx(j,1).^2 + Yy(j,1).^2);
    Uu(j,1) = atan2(Xx(j,1),Yy(j,2));
end

%COMPASS PLOT
[theta,rho] = pol2cart(Uu,1);
compass(theta,rho);

%QUIVER PLOT

r = 7;
sx = ones(size(cosine))*2; sy = ones(size(cosine))*2;
pu = r * cosine; 
pv = r * sine;
h = quiver(sx,sy,pu,pv);
set(gca, 'XLim', [1 10], 'YLim', [1 10]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T21:13:44.270

在箭袋图中，您将绘制余弦和正弦矩阵中的所有数据。在其他图中，您只是在绘制均值。前两个地块似乎匹配，所以那里没有问题。

其他几件事。我注意到在

```
Uu(j,1) = atan2(Xx(j,1),Yy(j,2)); 
```

`Yy(j,2)`实际上并没有定义，所以看起来这段代码应该失败。

此外，您可以将 Yy 和 Xx 定义为：

```
Xx = mean(cosine,2);
Yy = mean(sine,2); 
```

并且还摆脱了另一个 for 循环：

```
Rr = sqrt(Xx.^2 + Yy.^2)
Uu = atan2(Xx,Yy) 
```

我仍然需要考虑您的第一个问题，但我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T05:25:07.513

你完全可以解决这个问题。[点积](http://en.wikipedia.org/wiki/Dot_product)计算余弦。这意味着您的矩阵实际上是`M=V'*V` 这应该可以通过特征值求解。你说你也有长度。

您唯一的问题 - 作为您的原始矩阵，向量将是 83 维的。不容易绘制 2 或 3 维。我认为您仅使用平均角度就过度简化了。有一些技术称为降维 - 这是一个[工具箱](http://homepage.tudelft.nl/19j49/Matlab_Toolbox_for_Dimensionality_Reduction.html)。我建议在（因为这将是单位球上的点的距离）上进行[sammon 投影](http://en.wikipedia.org/wiki/Sammon_projection)`1-cosine`来计算此类图的向量。

# c# - 我是否需要在 ToolStripPanel、ToolStrip 和 ToolStripItems 上调用 dispose？

> ID：12182520
> 
> 赞同：0
> 
> 时间：2012-08-29T16:32:16.533
> 
> 标签：c#, idisposable, toolstrip, toolstripbutton, toolstrippanel

`ToolStripPanel`我在代码中构建了一个我添加 a`ToolStrip`并随后添加几个`ToolStripButton`s 和`ToolStripSeparator`s 的代码。我是否需要手动完成并删除和/或调用 dispose ？也就是说，循环遍历按钮和分隔符并对它们调用 dispose，然后`ToolStrip`从`ToolStripPanel`和 dispose 中`ToolStrip`删除，最后`ToolStripPanel`从它的父控件中删除并处理它？

**更新**

阅读[Control.Dispose](http://msdn.microsoft.com/en-us/library/a4zkb31d.aspx)的文档，似乎调用`Dispose`父母会处置孩子。不清楚的是`ToolStripItem`s 是否是适当的“孩子”，`ToolStrip`因为您没有将它们添加到`ToolStrip.Controls`集合中，而是将它们添加到`ToolStrip.Items`集合中。查看[ToolStrip.Controls](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstrip.controls.aspx)文档时，它说此属性与此类无关。

与`ToolStripPanel`您不调用的情况相同`ToolStripPanel.Controls.Add(toolstrip)`，而是`ToolStripPanel.Join(toolstrip)`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:13:49.713

是的，ToolStripItems 被视为子项。ToolStrip.Dispose() 迭代 Items 集合并释放项目。这些项目*不会*添加到 Controls 集合中，因为它们不是从 Control 派生的类。它们是“无窗口”控件，并使用它们的父级来呈现自己。这使它们非常便宜。

ToolStripPanel.Join() 实际上确实将 ToolStrip 添加到 Controls 集合中（ToolStrip*确实*继承自 Control）。它只需要做一件额外的事情，它需要将条带移动到正确的位置。并且有 4 个重载。

所以不需要额外的工作，处理面板就足以处理它的工具条和它们的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:49:36.660

如果您在代码中添加这些组件，则必须手动处理它们或将它们（手动）添加到`components`集合中，它会为您处理它们）。

如果您使用/在设计器中添加这些控件/组件，则不必手动处理它们。它们将被添加到`components`由 Designer 生成的代码处理的集合中。该集合处理表单上的所有子项。

# android - SQLite 中的多个表

> ID：12182526
> 
> 赞同：-2
> 
> 时间：2012-08-29T16:32:46.447
> 
> 标签：android, sqlite, adapter

我真的需要某种帮助/参考来处理已经创建的具有多个表的数据库，从表中收集信息并在应用程序中使用该信息。我能找到的只是您从头开始创建数据库的示例/教程，或者它只处理 1 个数据库表。有谁知道那里有任何明确处理我需要的教程/参考资料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:42:24.023

```
private static final String PERSON_TABLE_CREATE =
                    "CREATE TABLE " + tbPerson +
                    " (" +
                    PERSON_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                    PERSON_NAME + " TEXT)";
private static final String COLOR_TABLE_CREATE =
                    "CREATE TABLE " + tbColor +
                    " (" +
                    COLOR_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                    COLOR_NAME + " TEXT)"; 
```

在你的数据库助手的 onCreate 方法中：

```
public void onCreate(SQLiteDatabase db) {
            mDatabase = db;
            mDatabase.execSQL(PERSON_TABLE_CREATE);
            mDatabase.execSQL(COLOR_TABLE_CREATE);
} 
```

教程 ：

[关联](http://androidforbeginners.blogspot.in/2010/01/creating-multiple-sqlite-database.html)

# warnings - 什么是 lisp 中的“样式警告：隐式创建新的泛型函数”？

> ID：12182529
> 
> 赞同：2
> 
> 时间：2012-08-29T16:33:02.077
> 
> 标签：warnings, common-lisp, sbcl

这个警告是什么意思？我有一个我在下面使用的示例，带有此警告。我在某处做错了吗？

```
(defvar B_00 0)
(defvar B_000 0)
(defvar w_000 0)
(defvar w_00 0)
(defconstant white 0)

(defclass board ()
 ((blocker    :accessor blocker    :initarg :blocker    :initform  0)
  (friends    :accessor friends    :initarg :friends    :initform (make-array '(2)))
  (kings      :accessor kings      :initarg :kings      :initform (make-array '(2)))
  (boards     :accessor boards     :initarg :boards     :initform (make-array '(2 7) :initial-element 0))
  (enpassant  :accessor enpassant  :initarg :enpassant  :initform -1)
  (color      :accessor color      :initarg :color      :initform  WHITE)
  (castling   :accessor castling   :initarg :castling   :initform  (logior B_000 B_00 W_000 W_00))
  (hasCastled :accessor hasCastled :initarg :hasCastled :initform  (make-array '(2) :initial-element nil))
  (fifty      :accessor fifty      :initarg :fifty      :initform 0)
  (checked    :accessor checked    :initarg :checked    :initform nil)
  (opchecked  :accessor opchecked  :initarg :opchecked  :initform nil)
  (arBoard    :accessor arBoard    :initarg :arBoard    :initform (make-array '(64))) 
  (hash       :accessor hash       :initarg :hash       :initform 0)
  (pawnhash   :accessor pawnhash   :initarg :pawnhash   :initform 0)
  (history    :accessor history    :initarg :history    :initform '())))

(defmethod ischecked ((b board)) b) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T17:47:23.033

在定义实现它的任何方法之前，您应该使用[DEFGENERIC](http://www.lispworks.com/documentation/HyperSpec/Body/m_defgen.htm)定义一个泛型函数。没有匹配泛型函数定义的方法定义将自动（即隐式）创建泛型函数。但是，如果您自己定义了一个通用函数，即使您不需要任何特定的功能`defgeneric`（尽管接口文档是个好主意），如果您在任何方法定义中拼错名称，您都会收到警告。它还清楚地说明了如果参数被更改并且在方法之间变得不匹配，它们应该是什么。

# c# - 在 Web 浏览器中单击按钮

> ID：12182530
> 
> 赞同：3
> 
> 时间：2012-08-29T16:33:04.213
> 
> 标签：c#, html, browser

我已经创建了网络浏览器，现在我想通过单击表单上的 button1 单击网络上的按钮。

```
private void button1_Click(object sender, EventArgs e)
{
    webBrowser1.Document.GetElementById("search").SetAttribute("value", IP.Text);
    webBrowser1.Document.GetElementById("").InvokeMember("click");
} 
```

但我无法从此字符串中获取按钮 ID

```
<input type="submit" value="→" class="button"> 
```

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T17:03:07.130

尝试迭代`<input>`网页中的所有元素。当您找到具有所需值的元素时，您可以单击该元素。

```
foreach (HtmlElement el in webBrowser1.Document.GetElementsByTagName("input")
{
    if (el.GetAttribute("value").Equals("→"))
    {
        el.InvokeMember("click");
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T16:58:19.367

The website doesn't prevent POSTing a form to it. So you could always just create your own webpage with the form that points to it.

HTML

```
<form id="search" action="http://whois-service.ru/lookup/" method="post">
    <input type="text" class="text" name="domain" id="domain" />
    <input type="submit" value="" class="button" />
    <input id="submit" type="hidden" name="real" value="true2.1simpleJ" />
</form> 
```

c#

```
private void button1_Click(object sender, EventArgs e)
{
    webBrowser1.DocumentText = "[The HTML from above here]";
    webBrowser1.Document.GetElementById("domain").SetAttribute("value", IP.Text);
    webBrowser1.Document.GetElementById("submit").InvokeMember("click");
} 
```

If you are planning on scraping the WHOIS information. You must ensure it's not against the terms and conditions to do so. Most WHOIS services don't allow automated checks.

If they do and that's what you are trying to do then you should consider using HttpWebRequest instead, it's much more efficient. See an example here on how to use [http://swhobby.blogspot.co.uk/2010/03/c-example-of-http-post.html](http://swhobby.blogspot.co.uk/2010/03/c-example-of-http-post.html)

# php - 使用 .htaccess 压缩文件时出现 500 错误

> ID：12182531
> 
> 赞同：16
> 
> 时间：2012-08-29T16:33:10.517
> 
> 标签：php, javascript, .htaccess, compression, gzip

我正在尝试使用 .htaccess 压缩文件，但出现 500 内部错误，

这是我正在尝试使用的代码。

```
# JavaScript compression htaccess ruleset
AddHandler application/x-httpd-php .js
php_value auto_prepend_file gzip-js.php
php_flag zlib.output_compression On 
```

我也试过这个但得到同样的错误，

```
<files *.html>
SetOutputFilter DEFLATE
</files> 
```

任何建议为什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-29T16:58:08.340

Do you have [`mod_deflate`](https://httpd.apache.org/docs/current/fr/mod/mod_deflate.html) installed? Try this instead and see if your error goes away.

```
<ifModule mod_deflate.c>
<Files *.html>
SetOutputFilter DEFLATE
</Files>
</ifModule> 
```

If this resolves the 500 error, then you probably don't have `mod_deflate` installed. You can test it by visiting [HTTP Compression Test](http://www.whatsmyip.org/http-compression-test/).

If you have access, you may be able to enable it by uncommenting the following lines in your `httpd.conf` file.

```
LoadModule filter_module modules/mod_filter.so
LoadModule deflate_module modules/mod_deflate.so 
```

Then you will need to add an output type for each file type you wish to compress.

```
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript 
```

As mentioned in the comments, `AddOutputFilterByType` depends on [`mod_filter`](https://httpd.apache.org/docs/2.4/fr/mod/mod_filter.html). If you still get a 500 error you should check that this module is loaded too.

You can read more here: [Use mod_deflate to Compress Web Content delivered by Apache](http://www.g-loaded.eu/2008/05/10/use-mod_deflate-to-compress-web-content-delivered-by-apache/)

I can't find any documentation that suggests whether Siteground supports `mod_deflate` or not. Their KB suggests using gZip from PHP.

[How to enable gZIP compression for your pages?](http://kb.siteground.com/article/How_to_enable_gZIP_compression_for_your_pages.html)
[How to compress my CSS with gZIP?](http://kb.siteground.com/article/How_to_compress_my_CSS_with_gZIP.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T13:08:18.737

经过数小时的搜索，我找到了这篇[文章](http://www.linuxjournal.com/article/6802)，认为其他人可能会觉得它有帮助，

享受。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-08T02:47:13.197

> ##放气##
> 
> #mod_filter.so 和 mod_deflate.so

应该开启！！！！

```
<ifmodule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/text text/html text/plain text/xml text/css application/x-javascript application/javascript
</ifmodule> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-02T13:03:15.483

这对我来说很好（粘贴`.htaccess`）：

```
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript 
```

# wpf - 动态显示/显示 wpf 内容

> ID：12182533
> 
> 赞同：0
> 
> 时间：2012-08-29T16:33:12.383
> 
> 标签：wpf, xaml, togglebutton, contentcontrol

正如标题所说，我想动态隐藏或显示一些内容。我有两个按钮像单选按钮一样工作。每个按钮都必须显示一个特定的内容，但不能同时显示两个内容（它是一种表单，我正在研究两个子类）。

我在 SO 上看到过两件有趣的事情，我想把它们混合起来。首先，使用带有 ToggleButton 的 ContentControl (http://stackoverflow.com/questions/7698560/how-to-bind-click-of-a-button-to-change-the-content-of-a-panel-网格使用 xaml）。其次，使用 ToggleButtons 作为 RadioButtons (http://stackoverflow.com/questions/2362641/how-to-get-a-group-of-toggle-buttons-to-act-like-radio-buttons-in-wpf 第二个答案31)

所以我决定从这样的事情开始：

```
<ContentControl>
    <ContentControl.Template>
        <ControlTemplate>
            <WrapPanel HorizontalAlignment="Center">
                <TextBlock Text="{x:Static Internationalization:Resources.MAINOPTIONSWINDOW_STATUSLINKSUPERVISOR}"/>
                <RadioButton Style="{StaticResource {x:Type ToggleButton}}" Content="Alarm" GroupName="Trigger"/>
                <RadioButton Style="{StaticResource {x:Type ToggleButton}}" Content="Event" GroupName="Trigger"/>

            </WrapPanel>
        </ControlTemplate>
    </ContentControl.Template>
</ContentControl> 
```

但 Visual Studio 强调

```
{StaticResource {x:Type ToggleButton}} 
```

在视觉上，我的按钮看起来像单选按钮而不是切换按钮。视觉 说：

> 无法解析资源“{StaticResource {x:Type ToggleButton}}”（从法语翻译；））

无论如何，这段代码在 ContentControl 之外可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:55:06.820

是的，首先，修复你的事件处理程序。不要将它们附加在模板上，可能会发生棘手的事情。

其次，您可以修改您的 ContentControl.Resources，并将其放在那里：

```
<Style BasedOn="{StaticResource {x:Type ToggleButton}}"
          TargetType="RadioButton"/> 
```

并删除您自己的样式定义。您甚至可以再提高一层（ContentControl 的父级）。还有一件事，您在代码隐藏中执行此操作，但我可以向您保证，WPF 的真正强大之处在于您不需要代码隐藏，至少对于这样的逻辑。

您提供的链接也是使用触发器。现在这不是什么大问题，但你应该知道这不是正确的方法。如果您想在内容之间切换，请查看 ContentControl Content、DataTemplates、DataTemplateSelector。这个想法是在内存中只有一个视图，而不是隐藏东西。

这可以赶上，如果你在做其他方式。它最终会增加启动时间和内存使用量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:59:10.510

在控件模板中，您通常不添加事件处理程序。

覆盖 OnApplyTemplate 并在那里添加处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T15:42:51.827

我终于找到了另一种方式

```
<RadioButton Content="Alarm" GroupName="TriggerStateInfo" Style="{StaticResource {x:Type ToggleButton}}"
      Command="{x:Static StateInfoTemplateToAlarmCommand}"/>
<RadioButton Content="Event" GroupName="TriggerStateInfo" Style="{StaticResource {x:Type ToggleButton}}"
              Command="{x:Static StateInfoTemplateToEventCommand}"/>
<ContentControl Content="{Binding Path=Trigger, ElementName=Window}">
    <ContentControl.Resources>
        <DataTemplate DataType="{x:Type States:AlarmTrigger}">
            <ComboBox ItemsSource="{Binding Path=AlarmTriggersCollection}" />
        </DataTemplate>
        <DataTemplate DataType="{x:Type States:EventTrigger}">
            <ComboBox ItemsSource="{Binding Path=EventTriggersCollection}" />
        </DataTemplate>
    </ContentControl.Resources>
</ContentControl> 
```

使用更改触发器类型的代码

# iphone - 录制现场直播

> ID：12182536
> 
> 赞同：0
> 
> 时间：2012-08-29T16:33:28.217
> 
> 标签：iphone, ios5, xcode4.3, audio-recording

目前我正在使用 MPMoviePlayerController 播放直播广播流。我想在我的应用程序中录制和保存广播节目。

有人可以帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:08:19.373

您可以使用 AVFoundation 来实现。

1.  使用流 url初始化[AVURLAsset](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVURLAsset_Class/Reference/Reference.html)的实例
2.  使用[AVAssetReader](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAssetReader_Class/Reference/Reference.html#//apple_ref/occ/cl/AVAssetReader)读取流字节
3.  使用[AVAssetWriter](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAssetWriter_Class/Reference/Reference.html)将字节写入新文件。

希望我能帮上忙

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:09:39.307

如果您正在查看音频部分，我制作了一个示例应用程序，可以在运行时记录 Pandora。希望这可以帮助！[https://github.com/casspangell/AudioMic](https://github.com/casspangell/AudioMic)

# php - 使用连接在php中执行sql查询

> ID：12182537
> 
> 赞同：2
> 
> 时间：2012-08-29T16:33:30.097
> 
> 标签：php, sql

> **可能重复：**
> [Mysql 一次不能执行超过 1 个查询](https://stackoverflow.com/questions/1942766/mysql-cant-perform-more-than-1-query-at-a-time)

```
 $query = "TRUNCATE TABLE nw_world;";
        $query = $query . " INSERT INTO `nw_world`";
        $query = $query . " SELECT * FROM `x_world` WHERE x <0 AND y >=0";
        $query = $query . " AND tid !=5 AND aid NOT IN ( 29, 908, 935, 941, 950 )";
        $query = $query . " AND population <=50";

        echo "$query";
        mysql_query($query,$con) or die("error ".mysql_error()); 
```

这会导致错误

```
error You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INSERT INTO `nw_world` SELECT * FROM `x_world` WHERE x <0 AND y >=0 AND tid !=5 ' at line 1 
```

但是当我在 mysql 中执行相同的查询时，它工作正常。因此，我有一种感觉，我在 php 编码中犯了一些错误。请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:35:58.020

`mysql_query`不允许您执行超过 1 个查询。使用[mysqli::multi_query](http://www.php.net/manual/en/mysqli.multi-query.php) 或单独执行每个命令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T16:36:28.517

默认情况下，PHP 每次调用 mysql_query 只会执行 1 个查询（安全措施）。

如果您想一次执行多个，请查看[http://se2.php.net/manual/en/mysqli.multi-query.php](http://se2.php.net/manual/en/mysqli.multi-query.php)

# facebook - 如何使用应用访问令牌从特定用户读取流

> ID：12182540
> 
> 赞同：1
> 
> 时间：2012-08-29T16:33:38.037
> 
> 标签：facebook, facebook-fql

我创建了请求附加权限 read_stream 和 publish_stream 的 facebook 应用程序。在用户接受应用程序并允许应用程序阅读帖子后，当我尝试使用 fql 查询获取帖子时，我得到空结果。

这是代码

```
$appAccessToken = APP_ID|APP_SECRET
$fql = 'SELECT post_id, type, likes, source_id, created_time, privacy, comments FROM stream WHERE source_id = xxxxxxxxxxxxx';
$param  =   array(
    'method'    => 'fql.query',
    'query'     => $fql,
    'callback'  => '',
    "access_token" => $appAccessToken
);
$fqlResult   =   $facebook->api($param); 
```

结果是空数组

`Array ( )`

我可以使用 user_access_token ("access_token" = $facebook->getAccessToken();) 甚至在 fql 查询中没有访问令牌来获取活动用户的结果。

问题是我需要访问所有使用应用程序的用户帖子，而不仅仅是活跃用户。离线用户阅读流的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:07:36.717

您可以请求长期访问令牌

```
https://developers.facebook.com/roadmap/offline-access-removal/ 
```

但您不能使用应用访问令牌来读取私人用户流。您只能使用用户 access_token 来读取他们的流，因为它是用户权限，因此需要他们的访问令牌来验证他们是否已使用该权限对您的应用程序进行了身份验证。实际上，如果您查看流表的文档，它提到您只能为当前会话用户阅读它（这是第一个 2 个要点上方的句子）

```
https://developers.facebook.com/docs/reference/fql/stream/ 
```

不过，应用访问令牌应该能够阅读用户的公开帖子。

我不确定存储长期访问令牌的含义是什么，因此您必须进行研究以确保您不违反任何 TOS。

# mysql - 使用语句格式写入二进制日志的不安全语句，因为 BINLOG_FORMAT = STATEMENT。

> ID：12182545
> 
> 赞同：3
> 
> 时间：2012-08-29T16:33:57.707
> 
> 标签：mysql, django-admin

尝试从 django 管理屏幕插入值时出现以下错误 -

```
Unsafe statement written to the binary log using statement format since BINLOG_FORMAT = STATEMENT. Statement is unsafe because it accesses a non-transactional table after accessing a transactional table within the same transaction.
Request Method: POST
Request URL:    *<My URL>*
Django Version: 1.3.1
Exception Type: Warning
Exception Value:    
Unsafe statement written to the binary log using statement format since BINLOG_FORMAT = STATEMENT. Statement is unsafe because it accesses a non-transactional table after accessing a transactional table within the same transaction.
Exception Location: /Library/<Application>/2.7/site-packages/MySQLdb/cursors.py in _warning_check, line 92
Python Executable:  /usr/bin/python
Python Version: 2.7.1 
```

我尝试在网上阅读，但无法正确解决该问题。有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T13:23:23.883

想通了问题并解决了。这是因为并非所有表都是在同一个引擎下创建的（由于 mysql 5.5，新表在“InnoDB”下，而由于 mysql 5.0，旧表在“MyISAM”下）。

这是详细说明 - [http://generics7.blogspot.com/2012/08/unsafe-statement-written-to-binary-log.html](http://generics7.blogspot.com/2012/08/unsafe-statement-written-to-binary-log.html)

在同一引擎下创建所有表后，它工作正常！

# c++ - C++：如何从外部调用父类函数

> ID：12182546
> 
> 赞同：9
> 
> 时间：2012-08-29T16:33:57.427
> 
> 标签：c++, inheritance, pointers, virtual

我有：

```
class A{
    public:
        virtual void foo();
};

class B : public A{
    public:
        void foo();
};

B *ptr = new B(); 
```

我想`foo()`使用'ptr'指针直接调用A。

当我尝试

```
(A*)ptr->foo(); 
```

它仍然调用 B 的版本`foo()`。我怎么称呼A的版本呢？

这可能吗？有哪些替代方案？谢谢你。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-29T16:35:52.900

当你用`::`作用域解析形式命名一个函数时，你调用了命名函数，就好像它不是虚拟的一样。

```
ptr->A::foo(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T16:36:45.587

您需要公开您的功能。您只需进行以下更改即可做到这一点：

```
class A{
    public:
        virtual void foo();
};

class B : public A{
    public:
        void foo();
}; 
```

如果您不这样做，这些功能将自动成为私有的，并且无法从“外部”访问。

# c++ - 括号前的否定

> ID：12182551
> 
> 赞同：0
> 
> 时间：2012-08-29T16:34:14.963
> 
> 标签：c++, random, operator-keyword

[这是此答案](https://stackoverflow.com/a/12157212/335858)的后续问题。我正在尝试构建一个循环，该循环产生一组三个随机数，直到它们匹配一组特定的预定义的三个任意选择的数字。

我仍在试图弄清楚程序使用哪些运算符以任何顺序接受随机数但没有任何结果。

我试过你的

```
!(first==one && second==two && third==three) 
```

但它似乎在 c++ 中不起作用。感谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:42:07.947

您尝试的条件意味着`first`,和与,`second`和`third`具有相同的特定顺序。您可以尝试所有六种排列方式，但这会导致程序难以阅读。更好的解决方案是将值添加到向量，对它们进行排序，然后比较是否相等，如下所示：`one``two``three`

```
vector<int> a;
a.push_back(first);
a.push_back(second);
a.push_back(third);
vector<int> b;
b.push_back(one);
b.push_back(two);
b.push_back(three);
sort(a.begin(), a.end());
sort(b.begin(), b.end());
if (a == b) ... // values match 
```

这是[ideone 上此片段的链接](http://ideone.com/tJQIj)。

# mongodb - SSH Tunnelier Rock Mongo - 从 win7 连接到 EC2

> ID：12182552
> 
> 赞同：0
> 
> 时间：2012-08-29T16:34:16.607
> 
> 标签：mongodb, ssh, ssh-tunnel

我正在尝试通过 SSH 隧道连接到我的 EC2 实例，以便可以使用 Rock Mongo 作为我的 dB 客户端。
我已经`mongodb`在 AWS 上进行了测试，它似乎工作正常，现在如果我只能使用客户端进行连接。

这是我的设置`Tunnelier` ![在此处输入图像描述](../Images/2547334c8d3b01742783fd73b71b1f31.png)

摘自 Rock Mongo 的`config.php`

```
$MONGO["servers"][$i]["mongo_name"] = "AWS";
$MONGO["servers"][$i]["mongo_host"] = "127.0.0.1:3000";
$MONGO["servers"][$i]["mongo_port"] = "27018";
$MONGO["servers"][$i]["control_users"]["admin"] = "admin";
$i ++; 
```

并从我的 EC2 实例的命令行执行

```
mongod --port 27018 
```

**但是**连接没有发生，我收到一条错误消息

```
Unable to connect MongoDB, please check your configurations. MongoDB said:failed to get host from :27018 of 127.0.0.1:3000:27018. 
```

**问题**这是正确的方法还是我应该使用不同的方法？

**这是解决**方法，以防有人遇到类似问题 ![在此处输入图像描述](../Images/36918e919d245e6df1668f235f787e57.png)

罗克蒙戈的`config.php`

```
$MONGO["servers"][$i]["mongo_name"] = "AWS";
$MONGO["servers"][$i]["mongo_host"] = "127.0.0.1";
$MONGO["servers"][$i]["mongo_port"] = "3306";
$MONGO["servers"][$i]["control_users"]["admin"] = "admin"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:44:40.497

我对 Tunnelier 不熟悉，但看起来您正在配置 HTTP 代理而不是实际的 SSH 端口转发。这些在[Tunnelier 功能列表](http://www.bitvise.com/tunnelier#port-forwarding)中有所区别。以下文章还包含一些 Tunnelier 界面的屏幕截图以及可能为您指明正确方向的评论：

*   [http://blog.balaji-dutt.name/2008/11/17/things-i-like-bitvise-tunnelier/](http://blog.balaji-dutt.name/2008/11/17/things-i-like-bitvise-tunnelier/)
*   [http://theillustratednetwork.mvps.org/Ssh/Configure-Tunnelier.html](http://theillustratednetwork.mvps.org/Ssh/Configure-Tunnelier.html)

我相信 C2S 或 S2C 选项卡是您应该研究的。

此外，您`127.0.0.1:3000`在 RockMongo 的配置中指定为主机名，然后还提供`27018`为端口。RockMongo 会将这些选项连接到 Mongo 的连接字符串中，这不是您想要的。如果您正在设置 SSH 端口转发，您的主机和端口可能会指向您的本地主机。Mongo 在 AWS 中运行的端口是无关紧要的，因为您在 AWS 之外的客户端只关心它自己的 SSH 隧道端。

# javascript - Node.js 什么时候使用异步有意义？

> ID：12182553
> 
> 赞同：1
> 
> 时间：2012-08-29T16:34:17.053
> 
> 标签：javascript, node.js, asynchronous, libuv

我问自己什么时候与 node.js 上的回调异步是有意义的。当我使用 I/O、数据库和其他所有阻塞或在我的其余代码中的所有内容时，它是否有用？

例如，我有一个棋盘游戏的“布局器”。它创建一个具有给定 json 布局的板实例。我知道将异步用于 I/O（读取 json 布局文件）是有意义的，因为这会阻塞。例如，foreach 循环怎么样？它应该是异步的吗？底层的 libuv 是否从中受益？

这是**带有**异步库的版本：

```
/*jshint node: true, strict: true, globalstrict: true*/
"use strict";

// Imports
var fs = require('fs');
var async = require('async');
var Figure = require('../models/figure.js');
var Field = require('../models/field.js');
var Board = require('../models/board.js');

/**
 * @param {Board} board
 * @param {Array} template
 * @param {string} owner
 * @param {function(Error)} callback
 */
var createFigures = function (board, template, owner, callback) {
    async.forEach(template, function (data, done) {
        var figure = new Figure(owner, data.kind);
        board.setFigure(data.x, data.y, figure);
        done();
    }, callback);
};

/**
 * @param {Board} board
 * @param {Array} fields
 */
var createFields = function (board, fields, callback) {
    async.series([
        function(done) {
            for (var x = 0; x < board.getSize().x; x++) {
                for (var y = 0; y < board.getSize().y; y++) {
                    var field = new Field(true, false);
                    board.setField(x, y, field);
                }
            }
            done();
        }, function(done) {
            async.forEach(fields, function(data, iteratDone) {
                var field = new Field(data.passable, data.corner);
                board.setField(data.x, data.y, field);
                iteratDone();
            });
            done();
        }
    ], callback);
};

/**
 * @param {{
 *  ....
 */
var build = function (layoutObj, callback) {
    var board = new Board(layoutObj.name, layoutObj.size.x, layoutObj.size.y);

    async.parallel([
        function (done) {
            createFigures(board, layoutObj.figures.white, Figure.owners.white, done);
        },
        function (done) {
            createFigures(board, layoutObj.figures.black, Figure.owners.black, done);
        },
        function (done) {
            createFields(board, layoutObj.fields, done);
        }
    ],
        function (err) {
            callback(err, board);
        }
    );
};

/**
 * @param string layoutPath
 * @param {function(Error, )} callback
 * @return {Board}
 */
var generateBoardWithLayout = function (layoutPath, callback) {
    async.waterfall([
        function(done) {
            fs.stat(layoutPath, function(err, stats) {
               done(null, stats);
            });
        }, function(stats, done) {
            if (stats.isFile()) {
                var jsonData = '';
                fs.readFile(layoutPath, function(err, data) {
                    jsonData += data;
                    done(null, jsonData);
                });
            } else {
                done(new Error("There is no '" + layoutPath + "'"));
            }
        }
    ], function(err, jsonData) {
        build(JSON.parse(jsonData), callback);
    });

};

module.exports.build = build;
module.exports.generateBoardWithLayout = generateBoardWithLayout; 
```

这就是**没有**异步链接的版本

```
/*jshint node: true, strict: true, globalstrict: true*/
"use strict";

// Imports
var Figure = require('../models/figure.js');
var Field = require('../models/field.js');
var Board = require('../models/board.js');

/**
 * @constructor
 */
function Layouter() {

}

Layouter.generateBoardWithLayout = function(layoutPath) {
    var fs = require('fs');

    var jsonData = fs.readFileSync(layoutPath);
    if (!jsonData) {
        throw new Error("There is no '" + layoutPath + "'");
    }

    return new Layouter().build(JSON.parse(jsonData));
};

Layouter.prototype = {

    /**
     * @param {{
     *     ....
     */
    build: function (layoutObj) {
        var board = new Board(layoutObj.name, layoutObj.size.x, layoutObj.size.y);

        this.createFigures_(board, layoutObj.figures.white, Figure.owners.white);
        this.createFigures_(board, layoutObj.figures.black, Figure.owners.black);
        this.createFields_(board, layoutObj.fields);

        return board;
    },

    /**
     * @param {Board} board
     * @param {Array} template
     * @param {string} owner
     * @private
     */
    createFigures_: function (board, template, owner) {
        template.forEach(function (data) {
            var figure = new Figure(owner, data.kind);
            board.setFigure(data.x, data.y, figure);
        });
    },

    /**
     * @param {Board} board
     * @param {Array} fields
     * @private
     */
    createFields_: function (board, fields) {
        for (var x = 0; x < board.getSize().x; x++) {
            for (var y = 0; y < board.getSize().y; y++) {
                var field = new Field(true, false);
                board.setField(x, y, field);
            }
        }

        fields.forEach(function (data) {
            var field = new Field(data.passable, data.corner);
            board.setField(data.x, data.y, field);
        });
    }

};

module.exports = Layouter;
module.exports.generateBoardWithLayout = Layouter.generateBoardWithLayout; 
```

谢谢你的时间！

问候，马库斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:06:58.410

看起来你只是在不做任何 I/O 的情况下创建了新的对象实例，在这种情况下，你不必要地使代码复杂化，这很丑陋。您只能在最后一个回调函数中继续您的程序，这会将您的整个流程限制为一个大的异步调用。

通常，在您的代码中，您的程序流程不应依赖于其先前的异步回调来首先执行

```
createFigure();  
createField(); 
```

两者都是一个异步调用，如果 createField 中的某些内容首先执行 createFigure 怎么办，在这种情况下，行为是未定义的。通常，除非您正在执行阻塞操作，否则不要使用 async

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T14:36:36.993

我认为你错过了 Node.js 中异步背后的想法。这不是关于使用`async`包（它只是可以与 Node 一起使用的 npm 包，而不是 Node 的内部包），而是关于以异步方式处理外部进程。例如，当您查询数据库时，您可能会在等待结果的同时做很多事情，就是这样。

如果您的代码不查询任何外部进程但它是纯 JavaScript，那么使用单个进程您无法直接从异步中受益（Node.js 是单线程的），但是您可以做的是将一些工作委托给不同的进程和与它通信（参见 child_process.fork）。

# c# - 在 Database First 中更改实体和属性名称

> ID：12182555
> 
> 赞同：11
> 
> 时间：2012-08-29T16:34:38.810
> 
> 标签：c#, entity-framework, entity-framework-4, database-first, ef-database-first

我正在启动一个新应用程序，该应用程序必须使用现有数据库，该数据库使用一些在 .net 中非常烦人的命名约定（表名以指定表的业务域的几个三元组开头，列名以表三元组开头，三元组大写，并用下划线等分隔，）。

我想做的是编写一个简单的重命名规则（这就像找到最后一个下划线并在之后的所有内容一样简单）并将其应用到实体框架中。我真的不想在编辑器中一一编辑名称，特别是因为数据库可能会更改，我不想多次这样做。

我正在使用 Database First（因为数据库已经存在并且它是“主数据库”）和 EF 4.x DbContext Generator，它开箱即用的效果非常好（尽管类和属性命名错误）。

我编辑了 T4 模板以重命名生成的实体和属性，但是当我尝试执行任何请求时，DbContext 对象找不到与我尝试请求的实体匹配的表，并且出现此异常：

> 实体类型 [Entity Name] 不是当前上下文模型的一部分。

这很明显为什么它找不到表：当我动态更改它时，没有任何东西告诉它如何匹配实体名称和表。我读到我可以在`OnModelCreating(DbModelBuilder modelBuilder)`方法中添加指令，但这在 Database First 中没有使用（并且默认的 T4 模板在其中添加了一个异常，以防万一）。

所以现在我被卡住了，我不知道如何指定匹配。

以下是我的几个想法，但不确定它是否正确或可行：

*   使用“复数/单数”API 更改实体名称？听起来像一个肮脏的解决方法。但它可能有效（虽然没有尝试）。
*   寻找一种即时编辑 EDMX 文件的方法。
*   之后编辑 EDMX，但它可能会使过程复杂化（在设计器中编辑，然后执行一个工具来改变 EDMX，然后运行自定义工具来重新生成实体和 DbContext ......而今天我只需要在设计器中进行编辑）。
*   使用 Code First（因为通过 DbContext 类中的属性或指令使用不同的实体名称似乎比表名称更容易），但听起来与现有数据库一起使用它不会更复杂。

任何想法 ？还是我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T16:39:00.237

您将无法为此使用 T4 转换，因为您想更改实际 .edmx 文件的内容以将商店实体名称（带有令人讨厌的前缀）映射到经过清理的概念实体名称。

相反，您最好编写一个应用程序，将 .edmx 文件作为输入并清理概念模型标签下的名称并修改映射名称以反映清理后的名称。我知道这是您的第三种选择，并且您希望尽可能避免这种情况，但这是最直接的方法。请记住，您只需在添加新表或列时运行此工具。

# function - 指向 MATLAB 函数的指针？

> ID：12182558
> 
> 赞同：2
> 
> 时间：2012-08-29T16:34:51.483
> 
> 标签：function, matlab, for-loop, switch-statement

所以我在 MATLAB 中有一个 for 循环，其中一个向量 x 将通过一个函数，比如 cos(x).^2，或者另一个选择，比如 sin(x).^2 + 9.* X。用户将在 for 循环之前选择他想要使用的那些函数。

我的问题是，我不希望循环检查用户在每次迭代中选择的内容。有没有办法使用指向函数的指针（用户定义的或其他方式），每次迭代都会自动使用？

顺便说一句，这是在脚本内部，而不是函数。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T16:43:18.780

您可以使用[function_handles](http://www.mathworks.com/help/techdoc/ref/function_handle.html)。对于您的示例（使用循环在所有可用函数上运行）：

```
x = 1:10; % list of input values
functionList = {@(x) cos(x).^2, @(x) sin(x).^2 + 9*x}; % function handle cell-array
for i=1:length(functionList)
    functionOut{i} = functionList{i}(x); % output of each function to x
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T16:50:21.033

您可以尝试以下方法：

```
userChoice = 2;

switch userChoice
    case 1
        myFun = @(x) sin(x).^2 + 9.*x;
    case 2
        myFun = @(x) cos(x).^2;
end

for k = 1:10
    x(k,:) = myFun(rand(1,10));
end 
```

# javascript - 我无法在 Chrome 中触发卸载事件

> ID：12182559
> 
> 赞同：11
> 
> 时间：2012-08-29T16:34:52.023
> 
> 标签：javascript, jquery

这段代码在 Firefox 上运行良好，**但我不能再让卸载事件在 Chrome 上**运行。Chrome 是否停止支持卸载事件？

这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>

<script type="text/javascript" src="../jquery/jquery.js"></script>

<script type="text/javascript">

    function pageHidden(evt) { alert("Are you sure 1?"); } //WORKS ON FIREFOX BUT NOT IN CHROME
    window.addEventListener("pagehide", pageHidden, false);

    window.onunload = function () { alert("Are you sure 2?"); } //TRIGGERS ON LOAD NOT ON UNLOAD

    $(window).unload(function () { //WORKS ON FIREFOX BUT NOT IN CHROME
        alert("Are you sure 3?");
    });

</script>
</head>

<body>
TEST WEBSITE
<a href="http://www.iamawesome.com">external link</a>
</body> 
</html> 
```

如何让卸载事件在 Chrome 中工作？

谢谢！

* * *

**答案：不要使用警报测试卸载事件；）**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-29T16:45:27.967

```
window.onunload = alert("Are you sure 2?"); 
```

这是不正确的。您正在设置`onunload`的结果`alert`，您需要将其设置为一个函数：

```
window.onunload = function(){
    alert("Are you sure?");
} 
```

如果您想使用 jQuery，这将适用于所有浏览器。

```
$(window).unload(function () {
     alert("Are you sure?");
}); 
```

**注意**：它*似乎*在 Chrome 中不起作用，但确实如此。那是因为 Chrome`alert`在`onunload`事件中阻止了 s。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T16:39:07.797

尝试：

```
window.onbeforeunload = function () {
    // code
}; 
```

或者

```
window.onpagehide = function () {
    // code
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-21T18:19:52.367

根据我的阅读，一旦触发该事件，Chrome 似乎会阻止警报。但是，您可以运行一些功能，但不能运行任何与用户交互的东西。

来自[Chrome 中的 window.onbeforeunload：最近的修复是什么？](https://stackoverflow.com/questions/9626059/window-onbeforeunload-in-chrome-what-is-the-most-recent-fix)，看来，如果您只想弹出一条确认消息，则必须通过从您设置为回调的函数中返回带有消息的字符串来做到这一点。

```
window.onbeforeunload = function() {
    // Some wrap up code (no alerts, confirms, redirects, etc)
    return 'My confirmation messsage'; 
} 
```

然后，文本“我的确认消息”将显示在 Chrome 选择的确认对话框中。Firefox[在这里](https://developer.mozilla.org/en-US/docs/Web/Reference/Events/beforeunload?redirectlocale=en-US&redirectslug=DOM/Mozilla_event_reference/beforeunload)记录了这种行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T16:42:42.443

您不会触发任何事情 - 您只需执行要添加为处理程序的表达式：

```
window.onunload = function(event) {
    alert("Are you sure 2?");
}; 
```

# asp.net-mvc-3 - 验证消息未显示在 mvc razor 的客户端

> ID：12182564
> 
> 赞同：0
> 
> 时间：2012-08-29T16:35:14.223
> 
> 标签：asp.net-mvc-3

我正在研究 MVC Razor，我想根据条件验证我的模型。codtion 是如果 IsDefaultMailingAddress 为真，那么只有 DeliveryLine 和 Zip 将是必需的，否则页面将被提交。我已经搜索了这么多的文章并得到了下面的 metion 博客 [http://blogs.msdn.com/b/simonince/archive/2011/02/04/conditional-validation-in-asp-net-mvc-3.aspx](http://blogs.msdn.com/b/simonince/archive/2011/02/04/conditional-validation-in-asp-net-mvc-3.aspx)

我已经在我的模型中实现**了 Reqiuedif**，如下所述

**我的模型：** RequiredIf("IsDefaultMailingAddress",true, ErrorMessage = "必须添加 DeliveryLine")] public string DeliveryLine { get; 放; }

RequiredIf("IsDefaultMailingAddress",true, ErrorMessage = "必须添加 Zip")] 公共字符串 Zip { get; 放; }

公共布尔 IsDefaultMailingAddress { 获取；放; }

一切正常，但问题是当我点击提交按钮时，它会进入服务器端，并且模型状态显示为 false。为什么在进入服务器之前它没有显示所有错误消息“必须添加 DeliveryLine 和必须添加 Zip”

请让我知道应该实施什么客户端验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:44:05.557

您应该必须启用 ClinetValidation 才能解决此问题。在视图中只需添加以下 html 帮助器。

```
@Html.EnableClientValidation() 
```

# ajax - 在jQuery中使用for循环缓存字符串

> ID：12182565
> 
> 赞同：0
> 
> 时间：2012-08-29T16:35:21.483
> 
> 标签：ajax, jquery

我对 jQuery 编程比较陌生，所以请耐心等待。

我正在尝试缓存我在 js 文件底部的列表，以便页面运行更流畅。

我要去的清单是这样的：

```
$(document).ready(function () {

  hover($('#rim-1'), 900); 
  hover($('#rim-2'), 800); 
  hover($('#rim-3'), 1000); 
  hover($('#rim-4'), 900); 
  hover($('#rim-5'), 800); 
  hover($('#rim-6'), 1000); 
  hover($('#rim-7'), 900); 
  hover($('#rim-8'), 800); 
  hover($('#rim-9'), 1000); 
  hover($('#rim-10'), 900); 
  hover($('#rim-11'), 800); 
  hover($('#rim-12'), 1000); 
  shadow($('#shadow-1'), 900); 
  shadow($('#shadow-2'), 800); 
  shadow($('#shadow-3'), 1000); 
  shadow($('#shadow-4'), 900); 
  shadow($('#shadow-5'), 800); 
  shadow($('#shadow-6'), 1000);
  shadow($('#shadow-7'), 900); 
  shadow($('#shadow-8'), 800); 
  shadow($('#shadow-9'), 1000); 
  shadow($('#shadow-10'), 900); 
  shadow($('#shadow-11'), 800); 
  shadow($('#shadow-12'), 1000);
} 
```

我想设置一个 for 循环，这样不仅“#rim”和“#shadow”得到递增的数字，而且它们的速度也递增 100。

我尝试构建的内容类似于：

```
var hover = $("#floating-rim-container").find(".floating-rim-wrapper");
for (i=0; i<6; i++) {
    var speed = speed + 100;
} 
```

当然，这还远远没有结束。我只是不确定我应该如何设置这个多方面的命令。我背后的理论是，也许我可以使用包装器将它们组合起来，用于所有不同的语句。在 html 中，它们看起来像：

```
<div id="floating-rim-container">

            <a href="#">
                <img src="images/rim-middle.png" class="floating-rim-wrapper" id="rim-7">
            </a>        
            <a href="#">
                <img src="images/rim-middle.png" class="floating-rim-wrapper" id="rim-8">
            </a>        
            <a href="#">
                <img src="images/rim-middle.png" class="floating-rim-wrapper" id="rim-9">
            </a>
            <a href="#">
                <img src="images/rim-middle.png" class="floating-rim-wrapper" id="rim-10">
            </a>
            <a href="#">
                <img src="images/rim-middle.png" class="floating-rim-wrapper" id="rim-11">
            </a>
            <a href="#">
                <img src="images/rim-middle.png" class="floating-rim-wrapper" id="rim-12">
            </a>
                <div id="shadow-container">
                    <img src="images/shadow.png" class="shadow">
                    <img src="images/shadow.png" class="shadow">
                    <img src="images/shadow.png" class="shadow">
                    <img src="images/shadow.png" class="shadow">
                    <img src="images/shadow.png" class="shadow">
                    <img src="images/shadow.png" class="shadow">
                </div>
            </div> 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:39:20.690

试试这个，

```
var i=900;
$("#floating-rim-container").find(".floating-rim-wrapper").each(function(){
  hover($(this),i);
  i=i+100;
}); 
```

类似的`shadow`

# android - Android：无法接收 PACKAGE_REMOVED 广播

> ID：12182566
> 
> 赞同：0
> 
> 时间：2012-08-29T16:35:23.620
> 
> 标签：android, broadcastreceiver

我有我的接收者代码

```
 BroadcastReceiver pkgRemoveReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            // do my stuff
        }
    };
    IntentFilter filter = new IntentFilter();
    filter.addAction(Intent.ACTION_PACKAGE_REMOVED);
    registerReceiver(pkgRemoveReceiver, filter); 
```

因此，每当从设备中删除应用程序时，我都会做一些簿记。但是，我无法接收广播。上面的代码有问题吗？

谢谢！拉胡尔。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T16:42:05.283

尝试：

```
 IntentFilter filter = new IntentFilter();
   filter.addAction(Intent.ACTION_PACKAGE_REMOVED);
   filter.addDataScheme("package"); // add addDataScheme
   registerReceiver(pkgRemoveReceiver, filter);

   BroadcastReceiver pkgRemoveReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        // do my stuff
        if (Intent.ACTION_PACKAGE_REMOVED.equals(action)) {
             Toast.makeText(context, "ACTION_PACKAGE_REMOVED", Toast.LENGTH_LONG).show();
           }
    }
}; 
```

# ios - 如何在第一个视图上获取 statusBarOrientation

> ID：12182570
> 
> 赞同：2
> 
> 时间：2012-08-29T16:35:48.840
> 
> 标签：ios, ipad, uiinterfaceorientation

如何在第一个视图中检测到应用程序的正确方向？我需要知道这样我才能显示纵向图像或横向图像作为背景。

`[[UIDevice currentDevice] orientation]`如果 iPad 平放在表面上，则无法正常工作。

`statusBarOrientation`似乎没有为加载的第一个视图返回正确的结果。我尝试在 and 中获取状态栏方向，`viewWillAppear`并且`viewDidLoad`两者都返回**Portrait**，即使在横向时也是如此。

我已经确认我`[self.window makeKeyAndVisible]`在我`AppDelegate.m`的 in 中`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`。这只会在第一个视图控制器上返回不正确的状态栏方向。

注意：我也尝试过无论如何仍然返回肖像`interfaceOrientation`的广告。`UIViewController`

任何想法如何解决这一问题？

编辑：

我正在使用`[[UIDevice currentDevice] orientation]`来检测它是纵向还是横向，但我的问题是如果 UIDevice 返回平面方向（非纵向或横向），则检测视图实际上是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:52:37.117

知道了！

我能够通过使用来解决问题

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration 
```

即使在视图加载时，如果方向不是 ，也会触发此方法`UIInterfaceOrientationPortrait`。

即使设备是平的，似乎也有足够长的延迟来纠正方向并检测它`UIView`是处于纵向还是横向模式。

编辑：

当`viewDidAppear`由 then 触发时，`[self interfaceOrientation]`具有正确的值。所以如果你可以等到那个方法，你也可以在那里得到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:41:32.623

许多应用程序都有这个问题。如果设备是平的，那么任何方向都是有效的。

`[[UIDevice currentDevice] orientation]`对于可以确定方向的情况，如果可能的话，最好的办法是使用来了解方向。但是当它是平坦的时，它将只是它最后的样子。

你有多少次看到人们打开他们的 iPad 来获得正确的风景方向。

# java - 从从 getProperty 提取的位置读取文件

> ID：12182574
> 
> 赞同：0
> 
> 时间：2012-08-29T16:35:59.943
> 
> 标签：java

我对 Java 不是很好，并且在理解如何有效地读取文件方面存在问题，因此它独立于我的应用程序执行的环境。下面我将尝试解释我正在尝试做的事情。我有一个 configProperty.java

```
private ConfigProperty() {
prop = new Properties();
InputStream in = getClass().getResourceAsStream("/test/util/CSV.properties");
try {
    prop.load(in);
    in.close();
} 
catch (IOException e) {
    e.printStackTrace();
}
} 
```

CSV.properties 看起来像这样

```
a=Folder\\1.csv
b=Folder\\2.csv
c=Folder\\3.csv 
```

然后在我使用这些的一堂课中，它类似于

```
ConfigProperty.getInstance();
String path = ConfigProperty.getProp().getProperty("a");
BufferedReader br = new BufferedReader(new FileReader(path)); 
```

通过在 BufferedReader(new FileReader) 参数中以这种方式使用字符串变量路径，我将我的应用程序限制为始终获取“Folder/1.csv”、“Folder/2.csv”和“Folder/3.csv”的路径" 从规范路径和规范路径似乎对于不同的 IDE 和环境是不同的。最后，我希望我在这里有意义并且能够传达我的问题。;)。另外，如果我可以要求，请详细解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:21:47.687

如果您只想阅读一些文件，最好的方法是将它们作为资源放入您的 jar 中。

如果您想在用户环境的某个地方读/写文件，最好的方法（在我看来）是在安装/应用程序的任何时候询问用户的位置。使用首选项保存位置。

# php - 在php数组中查找兄弟键的值

> ID：12182575
> 
> 赞同：2
> 
> 时间：2012-08-29T16:36:09.393
> 
> 标签：php, arrays, siblings

我在 PHP 中有一个数组，这是一个片段：

```
$locations = array(
    array(
        "id" => 202,
        "name" => "GXP Club - Fable"
    ),

    array (
        "id" => 204,
        "name" => "GXP Club - Gray"
    )
); 
```

我所知道的（来自 GET）是 ID（202）。我想显示的是“显示结果” `( where $locations[?][id] = $_GET['id'] { echo $locations[?][name] } )` ——如果你能原谅我使用伪代码的话。

不确定哪个函数最好，或者我是否需要遍历整个数组才能找到它。谢谢。

编辑：进一步澄清。我需要学习给定 [id] 的 [name]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:40:17.397

```
foreach( $locations as $arr ) {
    if($arr['id'] == $_GET['id']) {
        echo $arr['name'];
        break;
    }
} 
```

这应该够了吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:42:16.307

虽然遍历数组是上述问题的解决方案，但如果这是数组中的所有数据，将数组更改为`$id=>$name`键值对而不是命名键值似乎更理想，例如：

```
$locations = array( '202' => 'GXP Club - Fable',
                    '204' => 'GXP Club - Gray',
             ) 
```

或者，如果有更多数据，我会切换到嵌套数据结构，例如：

```
$locations = array( '202' => array( 'name' => 'GXP Club - Fable', 'prop2' =>$prop2, etc),      
                    '204' => array( 'name' => 'GXP Club - Gray', 'prop2' =>$prop2, etc),
             ) 
```

这使得您可以通过 ID（例如`$locations[$id]['name']`）访问数据，这似乎是您通常想要做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:53:43.270

您可以使用`array_map`将自定义操作应用于给定数组中的每个元素的函数。

```
array_map(
    function($arr) { if ($arr['id'] == $_GET['id']) echo $arr['name']; }, 
    $locations
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-20T17:10:49.943

使用 PHP 的内置数组函数^*避免`foreach`循环：

```
<?php
$locations = [["id"=>202, "name"=>"GXP Club - Fable"], ["id"=>204, "name"=>"GXP Club - Gray"]];

$col = array_search(array_column($locations, "id"), $_GET["id"]);
echo $locations[$col]["name"]; 
```

或者，使用不同的方法：

```
<?php
$locations = [["id"=>202, "name"=>"GXP Club - Fable"], ["id"=>204, "name"=>"GXP Club - Gray"]];

$result = array_filter($locations, function($v){ return $v["id"] == $_GET["id"]; });
echo array_shift($result)["name"]; 
```

* * *

^([* 值得注意的是，`array_column()`直到 PHP 5.5 才可用，在提出这个问题 10 个月后发布！])

# boost - Boost 测试框架返回码

> ID：12182577
> 
> 赞同：1
> 
> 时间：2012-08-29T16:36:13.497
> 
> 标签：boost, boost-test

`unit_test_main`Boost Testing Framework的函数返回码是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:17:13.650

正如您可以在[此处](http://www.boost.org/doc/libs/1_51_0/libs/test/doc/html/utf/user-guide/test-runners.html#utf.user-guide.runners-exit-status-summary)找到的那样，如果没有错误或其中任何一个错误，或者取决于是否存在未捕获的异常，`unit_test_main`则可以返回。`boost::exit_success``boost::exit_exception_failure``boost::exit_test_failure`

PS：如果你通过你的测试程序的命令行选项`--result_code=no`，`unit_test_main`总是会返回`boost::exit_success`。

# c# - 像属性参数一样使用枚举项名称

> ID：12182578
> 
> 赞同：7
> 
> 时间：2012-08-29T16:36:14.557
> 
> 标签：c#, .net, wcf-ria-services

我只是不想为每个属性使用“经理”并为此使用一些枚举。

但这似乎是不可能的还是我错了？

所以我尝试更换

```
[RequiresRole("Managers")] 
```

和

```
[RequiresRole(HardCodedRoles.Managers.ToString())]

...

public enum HardCodedRoles
{ 
            Administrators,
            Managers
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-29T17:01:13.580

一个类而不是一个枚举怎么样，使类静态以避免新的人：ing它？

```
public static class HardCodedRoles
{
    public const string Managers = "Managers";
    public const string Administrators = "Administrators";
}

[RequiresRole(HardCodedRoles.Managers)] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-01-10T10:19:51.137

您还可以使用 nameof 关键字，即：

```
[RequiresRole(nameof(HardCodedRoles.Managers))] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T16:51:43.570

您看到错误的原因是因为`ToString()`是一种*方法*，因此无法在编译时计算该值。

如果您可以改用 [RequiresRole(HardCodedRoles.Managers)]，您可以`ToString`在代码中的其他地方执行，这可以为您提供所需的功能。这将要求您将属性的参数从 更改`string`为`HardCodedRoles`。

（我想使用 a 是`const`行不通的，因为参数的类型仍然是`string`，所以输入不会受到限制。）

# database - 是否有任何现代语言允许记录级数据库访问？

> ID：12182580
> 
> 赞同：0
> 
> 时间：2012-08-29T16:36:18.483
> 
> 标签：database

熟悉 COBOL 和那个时代的语言的人可能还记得写过这种风格的代码

```
While records exist in table A
   Read a record from table A
   If some condition
      Read records in table B until match found
      If some condition in record B
         Read a record in table C
         repeat ad nauseum 
```

我们公司刚刚开始讨论将我们的 COBOL 代码库更新为更现代的东西，如果我们可以继续使用记录级访问，任何转换都会容易得多，至少在过渡期间是这样。用一种新语言重写所有内容*并将*所有内容转换为 SQL 可能需要承担的工作量太大。

**是否有任何现代语言/数据库组合可以让我们对数据进行记录级访问？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:46:17.047

答案取决于您的具体情况。大多数现代语言都应该提供某种形式的记录级访问。这是 Python 中的一个示例，假设数据文件是 Cobol 所说的“组织行顺序”。请注意，语法与您的示例没有太大不同。根据数据文件的结构，您可能需要使用类似 tableB.seek(0) 的东西在文件开头重新开始搜索。

```
tableA = open('tableA.txt', 'r')
tableB = open('tableB.txt', 'r')
tableC = open('tableC.txt', 'r')

for rowA in tableA:
    if some_Condition():
        for rowB in tableB:
            if rowA_rowB_match():
                if some_condition_in_record_B():
                    for rowC in tableC:
                        repeat ad nauseum
tableA.close()
tableB.close()
tableC.close()

def some_Condition():
    if x:
        return True
    else:
        return False

etc. 
```

# java - Hibernate 4.1 错误：无法为类型创建 DynamicParameterizedType：org.hibernate.type.EnumType

> ID：12182586
> 
> 赞同：1
> 
> 时间：2012-08-29T16:36:48.323
> 
> 标签：java, spring, hibernate, hibernate-4.x

我正在尝试将我的项目从休眠 3.6 升级到 4.1.6，我想我已经把所有的罐子都放在了正确的位置，等等，但现在我在谷歌搜索下面有这个异常没有得到答案。我的代码在 Hibernate 3.6 上运行良好，我不确定这是我的映射问题还是其他问题。我正在使用 JPA 方法使用 Spring 3.1.2 配置休眠 4.1。

```
Caused by: org.hibernate.MappingException: Could not create DynamicParameterizedType for type: org.hibernate.type.EnumType
        at org.hibernate.mapping.SimpleValue.createParameterImpl(SimpleValue.java:398)
        at org.hibernate.mapping.SimpleValue.getType(SimpleValue.java:304)
        at org.hibernate.mapping.SimpleValue.isValid(SimpleValue.java:294)
        at org.hibernate.mapping.Property.isValid(Property.java:238)
        at org.hibernate.mapping.PersistentClass.validate(PersistentClass.java:469)
        at org.hibernate.mapping.RootClass.validate(RootClass.java:270)
        at org.hibernate.cfg.Configuration.validate(Configuration.java:1294)
        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1738)
        at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:94)
        at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:905)
        ... 55 more
    Caused by: java.lang.ClassNotFoundException: char
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Class.java:186)
        at org.hibernate.internal.util.ReflectHelper.classForName(ReflectHelper.java:192)
        at org.hibernate.mapping.SimpleValue.createParameterImpl(SimpleValue.java:389)
        ... 64 more 
```

**更新：**我在休眠代码中设置了断点，该异常被捕获并找到了它不喜欢的映射，下面是它。

```
@Entity
@Table(name = "company_addresses")
public class CompanyAddress extends TimeStampedPersistableObject
{
public enum AddressType
{
    PUBLIC('p'), SHAREHOLDER('s');

    private final char typeCode;

    AddressType(char typeCode)
    {
        this.typeCode = typeCode;
    }

    public static AddressType parse(char c)
    {
        for (AddressType addressType : AddressType.values())
        {
            if (addressType.value() == c)
            {
                return addressType;
            }
        }
        return null;
    }

    public char value()
    {
        return typeCode;
    }
}

@Column(name = "address_type")
@Enumerated(EnumType.STRING)
private char type; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:27:38.167

事实证明，我有一个额外的 @Enumerated 被休眠 3.6 忽略，这让休眠 4.1 感到困惑

```
@Column(name = "address_type")
@Enumerated(EnumType.STRING)
private char type; 
```

I had forgotten @Enumerated on this field which has a char type but the setters and getter using a proper Enum. Removing @Enumerated fixed the problem, which was a bug in my mapping.

Hibernate 4.1 failed to indicated the name of the table and the name of the column which made it a bit hard to figure out which mapping was causing the problem.

# jquery - jQuery HTML5 Audio，旧浏览器的替代格式

> ID：12182589
> 
> 赞同：1
> 
> 时间：2012-08-29T16:36:54.543
> 
> 标签：jquery, html, audio, jquery-plugins

我是 jQuery 新手，我正在尝试开发一种能够在大多数浏览器上播放声音文件的解决方案。我有一段使用 jQuery 和 HTML5 音频支持的工作代码。它将支持大多数新浏览器，但不适用于旧浏览器。

是否有可以与旧版浏览器一起使用的 jQuery 插件。最坏的情况是，如果可能的话，我可以将 mp3 文件转换为 swf 并尝试使用 jQuery 播放它们。

这是我的代码

```
<html>
 <head>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {

    var sound = $("#sound")[0];
        $("#play").mouseover(function() {
            sound.play();
        }).mouseleave(function(){
            sound.pause();
            sound.currentTime = 0;
        });     
    });  
</script>

</head>

<body>
    <audio id="sound">
        <source src="sound.ogg" type="audio/ogg" />
        <source src="sound.mp3" type="audio/mp3" />
        Your browser doesn't support HTML5.
    </audio>

    <span id="play">Mouse over to play sound</span>

</body> 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:48:43.330

检查以下项目：

*   [播放器](http://www.jplayer.org/)
*   [音频.js](http://kolber.github.com/audiojs/)
*   [声音管理器 2](http://www.schillmania.com/projects/soundmanager2/)

如果需要，他们都将在旧版浏览器上使用 Flash。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T08:04:57.337

您可以简单地提供一个可以播放 MP3 文件的 Flash 播放器，这样您就可以默认使用它。您还应该提供相关音频文件的下载链接，以防用户没有安装 Flash。

例如：

```
 <audio controls>
      <source src="sound.ogg" type="audio/ogg">
      <source src="sound.mp3" type="audio/mp3">
      <object type="application/x-shockwave-flash" data="player.swf?audioUrl=sound.mp3" height="27" width="320">
         <param name="movie" value="player.swf?audioUrl=sound.mp3">
      </object>
      <a href="sound.mp3">Download the audio file</a>
   </audio> 
```

[您可以在此处](http://html5multimedia.com/code/ch3/audio-ogg-mp3-wav-flash-link.html)查看一个工作示例。

但是，您将无法通过 JavaScript 访问播放器的 Flash 控件。

# c# - 使用 LINQ to XML 查询以删除最后一个结果

> ID：12182590
> 
> 赞同：0
> 
> 时间：2012-08-29T16:36:55.320
> 
> 标签：c#, .net, xml, linq, linq-to-xml

我在解析 xml 文件时遇到问题。下面是一个示例。

```
<G_LOG>
  <LINE>9206</LINE>
  <TEXT>Generating 
</TEXT>
</G_LOG>
<G_LOG>
  <LINE>9207</LINE>
  <TEXT>Inserted Actual
</TEXT> 
```

好的，所以这只是文件中数千个节点的快照。我需要搜索 TEXT “Inserted Actual”，不仅要删除这个节点，还要删除前一个节点。所以它会在第 9207 行找到文本并删除 9206。（删除上述代码段中的所有内容）

我可以搜索要删除的行。

```
 XDocument xmlDoc = XDocument.Load(filename);
 var q = from c in xmlDoc.Descendants("G_LOG")
         where c.Element("TEXT").Value.Contains("Inserted Actual")
         select (string)c.Element("LINE");
 foreach (string name in q)
 {
     Console.WriteLine("Actuals Success on ID : " + name);           
 } 
```

但我不确定如何获取前一个节点并将其删除（没有代码桶）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:51:15.557

```
XElement xmlDoc = XElement.Load("c:\\temp.xml");
 var q = xmlDoc.Descendants("G_LOG").Where(c=>c.Element("TEXT").Value.Contains("Inserted Actual")).Select(d=>d.Element("LINE"));
foreach(XElement elm in q)
{
if(elm.Parent.ElementsBeforeSelf().Count()!=0)
elm.Parent.PreviousNode.Remove();
elm.Parent.RemoveNodes();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T17:23:40.273

```
var elementsToRemove =
    from logElement in xml.Descendants("G_LOG")
    where logElement.Element("TEXT").Value.Contains("Inserted Actual")
    from element in new[] { logElement, logElement.PreviousNode }
    select element;

foreach(var element in elementsToRemove.ToList())
{
    element.Remove();
} 
```

有几点需要注意：

1.  第二个`from`将每个节点及其前一个节点展平为一个序列
2.  急切地评估查询，确保我们在`.ToList()`评估时不会删除节点

# excel - 添加分析字段以访问查询的好方法？

> ID：12182591
> 
> 赞同：1
> 
> 时间：2012-08-29T16:36:59.827
> 
> 标签：excel, ms-access, vba, pivot-table

我正在使用 Excel 数据透视表来分析大型 Access 表中的记录值。

例如我有桌子

```
mark1 | mark2 | value
x     |y      |1
w     |z      |2
t     |l      |3 
```

现在我正在使用访问查询字段表达式添加一个字段“mymark”：

```
GROOPER: 
Switch(
[mark1]="x";"yes";
[mark2]="z";"no";
1=1;"dunno"
) 
```

甚至更复杂：

```
COMPLEXGROOPER: 
Switch(
([mark1]="x" or [mark1]="r") and [mark2]<>"";"yes";
[mark2]="z" or [mark2]="zz" or left([mark2],1)="z";"no";
1=1;"dunno"
) 
```

我的目标是以如下方式获得数据：

```
mark1 | mark2 | value| mymark
x     |y      |1     |yes
w     |z      |2     |no 
t     |l      |3     |dunno 
```

然后通过“mymark”在 Excel 数据透视表中进行分析

在我遇到 1023 个符号的表达式大小限制之前，表达式没问题。

有没有克服这个限制的好方法？

我还尝试将所有逻辑打包在 VBA 函数中，然后在访问表达式中使用函数名。它适用于在访问中生成查询结果，但是当我尝试使用该查询作为 Excel 数据透视表数据的源时，错误上升事实上我的自定义 vba 函数在表达式中未定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T07:27:51.313

1）如何将分组值放在单独的表中：

```
key   | value
--------------
x     | yes
y     | no 
```

和`LEFT JOIN`：

```
FROM mytable
LEFT JOIN keyvalueTable ON mytable.mark = keyvalueTable.key 
```

然后，要显示不在 keyvalueTable 中的值，`Nz`如果它不为 null，则使用返回第一个参数，否则返回第二个参数：

```
GROUPER: Nz(keyvalueTable.value, "dunno") 
```

如果您不能`Nz`在链接的 Excel 查询中使用，请尝试`Iif`：

```
GROUPER: Iif(keyvalueTable.value Is Null, "dunno", keyvalueTable.value) 
```

2) 根据您的需要，您还可以考虑在 Access 中使用交叉表查询，而不是从 Excel 中读取。您可以在交叉表查询中使用 VBA 函数。

# java - JavaFx 2.x - Swing：不在 FX 应用程序线程上

> ID：12182592
> 
> 赞同：17
> 
> 时间：2012-08-29T16:37:03.783
> 
> 标签：java, swing, exception-handling, javafx-2

我正在尝试通过使用附加 JFXPanel 的 JInternalFrame 来使用 JavaFx 2.x 和 Swing 应用程序

我的代码如下

```
public class InternalFrameWithJavafx extends javax.swing.JFrame {
/**
 * Creates new form InternalFrameWithJavafx
 */
public InternalFrameWithJavafx() {
    initComponents();

    final JInternalFrame frame = new JInternalFrame();
    frame.setTitle("test InternalFrame");
    frame.setVisible(true);        
    frame.setResizable(true);
    frame.setIconifiable(true);
    frame.setMaximizable(true);
    frame.setIconifiable(true);
    frame.setClosable(true);
    frame.setSize(800,600);
    frame.setLocation(0, 0);        
    frame.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

    SwingUtilities.invokeLater(new Runnable() {

    @Override
    public void run() {
    final JFXPanel javafxPanel = new JFXPanel();

    BorderPane pane = new BorderPane();
    javafxPanel.setScene( new Scene(pane) {
        Text text = new Text("Hello World");            

    });
    frame.getContentPane().add(javafxPanel, BorderLayout.CENTER);
    }
});        
    this.add(frame);    
}
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">                          
private void initComponents() {

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 400, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 300, Short.MAX_VALUE)
    );

    pack();
}// </editor-fold>                        

/**
 * @param args the command line arguments
 */
public static void main(String args[]) {
    try {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (UnsupportedLookAndFeelException e) {
        //handle exception
    } catch (ClassNotFoundException e) {
        //handle exception
    } catch (InstantiationException e) {
        //handle exception
    } catch (IllegalAccessException e) {
        //handle exception
    }
    java.awt.EventQueue.invokeLater(new Runnable() {

        public void run() {
            new InternalFrameWithJavafx().setVisible(true);
        }
    });
}                 
} 
```

我有这个例外

```
Exception in thread "AWT-EventQueue-0" java.lang.IllegalStateException: Not on FX application thread; currentThread = AWT-EventQueue-0
at com.sun.javafx.tk.Toolkit.checkFxUserThread(Unknown Source)
at com.sun.javafx.tk.quantum.QuantumToolkit.checkFxUserThread(Unknown Source)
at javafx.scene.Scene.<init>(Unknown Source)
at javafx.scene.Scene.<init>(Unknown Source)
at javafxapplication2.InternalFrameWithJavafx$1$1.<init>(InternalFrameWithJavafx.java:47)
at javafxapplication2.InternalFrameWithJavafx$1.run(InternalFrameWithJavafx.java:47)
at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:251)
at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:705)
at java.awt.EventQueue.access$000(EventQueue.java:101)
at java.awt.EventQueue$3.run(EventQueue.java:666)
at java.awt.EventQueue$3.run(EventQueue.java:664)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
at java.awt.EventQueue.dispatchEvent(EventQueue.java:675)
at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
at java.awt.EventDispatchThread.run(EventDispatchThread.java:90) 
```

出于我的目的，我必须使用 JInternalFrame：我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-29T18:26:53.477

请参阅[“Swing 中的 JavaFX”](http://docs.oracle.com/javafx/2/swing/swing-fx-interoperability.htm#CHDIEEJE)教程。您正在执行应该在 Swing 线程（事件调度线程）上的 JavaFX 线程上运行的 JavaFX 操作。

幸运的是，他们从以前的错误中吸取了教训，现在当您在错误的线程上执行操作时会抛出异常。那是您遇到的异常。

使用该`Platform#runLater`教程中所示的

```
Platform.runLater(new Runnable() {
        @Override
        public void run() {
          //javaFX operations should go here
        }
   }); 
```

罐子的构造`JFXPanel`保留在 EDT 上（该教程中也说明了这一点）

# delphi - 有没有办法在 Delphi 中修改 FD_SETSIZE (WinSock) 的值？

> ID：12182596
> 
> 赞同：1
> 
> 时间：2012-08-29T16:37:08.227
> 
> 标签：delphi, winapi, delphi-7

有没有办法[`FD_SETSIZE`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms739169%28v=vs.85%29.aspx)在 Delphi 7 应用程序中增加 (WinSock) 的值？

在 C++ 中，我可以在使用之前定义它`include`，但对于 Delphi，这是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:43:26.790

它被定义为一个常量，所以唯一的选择是直接在`WinSock.pas`.

![在此处输入图像描述](../Images/78ed9e036dd9d17942fa967f13c863cd.png)

# jquery - JqPlot 作为图像

> ID：12182598
> 
> 赞同：11
> 
> 时间：2012-08-29T16:37:14.597
> 
> 标签：jquery, jqplot

在最新的 JqPlot 示例中（请参阅[此处](http://www.jqplot.com/deploy/dist/examples/)，在一些图表下方有可以单击的按钮，并且 div 会随着图表作为图像向下滑动，允许您右键单击并另存为。

我已经检查了源代码，但我只是看不到发生这种情况的地方。我已经看到了有关此的各种讨论（请参阅[此处，](https://groups.google.com/forum/?fromgroups=#!topic/jqplot-users/mlif3cBmc8A)但是我的 javascript 充其量是基本的。但是，这是我想在我当前的项目中实现的东西。

是否有人知道有关如何执行此操作的完整教程，即从实际的 jquery 代码一直到 html 代码中的实现。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-30T17:55:48.863

这是我可以编写的最简单的示例：

```
//after creating your plot do
var imgData = $('#chart1').jqplotToImageStr({}); // given the div id of your plot, get the img data
var imgElem = $('<img/>').attr('src',imgData); // create an img and add the data to it
$('#imgChart1').append(imgElem);​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ // append the img to the DOM 
```

[在这里](http://jsfiddle.net/uGWnL/)拉小提琴。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-10T12:06:05.437

标记感谢您的贡献，有时您可能已经混入（包括）光标和缩放功能，您可能需要创建图表的一部分的图像，希望恢复缩放以创建其他图像部分。这可能并不容易，因为 jqPlot 不会为您将图形还原为原始图，因此您必须自己手动完成。

我的补救措施

1.  丰富您的 $.jqplot 选项

    `cursor: { show: true, zoom: true, looseZoom: true, showTooltip: false, **dblClickReset:true,** }`

    这使用户能够恢复到图形的初始外观。如果您选择这种方法，请记住通过建议说明向您的用户提供有关如何恢复的建议，例如

    `Double click on the Graph to Reset Zoom back to 100%` 出于可用性目的。

**对于那些更倾向于编码的人这里是一个补救措施，它包括马克介绍的一些代码（再次感谢）**

1.  在图的正下方创建一个按钮，为其提供一个 id 属性并将一个偶数处理程序附加到它的点击函数，

    ```
     <button id="show_revert_graph_btn" class="jqplot-replot-button" title="Reset Zoom back to 100%">Revert the Graph</button> 
    ```

2.  附加一个事件监听器并实现/注册一个像这样的处理程序

 `````
$('#show_revert_graph_btn').click(function(){
  // simulating a double click on the  canvas
  // not that the selecting expression includes 
  // the div id of where i chose to plot the chart "chart104" and the default class
  // provided to the canvas holding my chart i.e "canvas.jqplot-event-canvas"
  // then i double click it
        $('#chart104 canvas.jqplot-event-canvas').dblclick();
    }); 
````  `**缩放后的图像创建** 在我的应用程序中，我需要从图表的不同部分创建多个图像，因此缩放允许我放大这部分，画布到图像功能允许我保存在画布中显示的当前数据我放大了一点。*挑战是，如何重新加载我的新缩放点作为复制* **补救措施的新图像**

1.  为绘图图像创建按钮
2.  附加一个侦听器，到 jquery 的**切换**事件允许您显示和隐藏图像
3.  处理图像以管理缩放事件，即当我放大时生成新图像，这样当我单击时，我会看到放大部分的图像，而不是整个图表的旧图像

 `````
 $('#show_plotted_image_btn').toggle(
        function(){
            console.log('showing graph');
            // get the image
            function genImg(){
            var imgData = $('#chart104').jqplotToImageStr({});
       // given the div       id of your plot, get the img data
            var imgElem = $('<img/>').attr('src',imgData); // create an img and add the data to it
            $('#plotted_image_div').empty(); // remove the old graph
            $('#plotted_image_div').append(imgElem);
            };
            genImg();
            // show the image
            $('#plotted_image_div').css('display','block');

        },
        function(){
            // hide the image
            console.log('hiding graph');
            $('#plotted_image_div').css('display','none');
        }
    ); 
````  `*在我的实现中，我只想显示最新图像，因此每次我要求新图像时，我都会通过 $('#plotted_image_div').empty(); 摆脱旧图像，这只是清空旧图像然后附加新的。*

**这是我的 HTML，供可能需要进一步说明的人使用 **

 `````
<div id="chart104" class=""></div>

            <button id="show_plotted_image_btn" class="jqplot-image-button">View Plot Image</button>
            <span style="font-weight: bold; color:#FC2896;"> Double click on the Graph to Reset Zoom back to 100%</span>
            <button id="show_revert_graph_btn" class="jqplot-replot-button" title="Reset Zoom back to 100%">Revert the Graph</button>
            <div id="plotted_image_div" class="" style="display: none;"></div> 
```` 

`**祝你好运**`

 `* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T16:52:07.340

看起来他们正在使用 Canvas 的一个功能来渲染图像：

[https://bitbucket.org/cleonello/jqplot/src/0d4d1a4fe522/src/jqplot.toImage.js](https://bitbucket.org/cleonello/jqplot/src/0d4d1a4fe522/src/jqplot.toImage.js)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-08T09:37:07.950

当您遇到图像输出问题时，您必须更改`jquery.jqplot.js`. 在某些浏览器上，脚本会停止无限循环（Chrome 和 Firefox）。

**更改此代码：**

```
for (var i=0; i<wl; i++) {
    w += words[i];
    if (context.measureText(w).width > tagwidth) {
        breaks.push(i);
        w = '';
        i--;
    }   
} 
```

**对此：**

```
for (var i=0; i<wl; i++) {
    w += words[i];
    if (context.measureText(w).width > tagwidth && w.length > words[i].length) {
        breaks.push(i);
        w = '';
        i--;
    }   
} 
```

**将此添加到您的 html 中：**

```
<div id="chart"></div>
<div id="imgChart"></div> 
```

**这在你的 jqplot 代码之后给 jquery：**

```
$(document).ready(function(){
    //after creating your plot do
    var imgData = $('#chart').jqplotToImageStr({}); // given the div id of your plot, get the img data
    var imgElem = $('<img/>').attr('src',imgData); // create an img and add the data to it
    $('#imgChart').append(imgElem);​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ //
}); 
```

**[在此处](http://jsfiddle.net/fsms7koc/)查看演示**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-06T14:25:16.763

这个解决方案对我很有效。简单快捷。

```
//after creating your plot do
var imgData = $('#chart1').jqplotToImageStr({}); // given the div id of your plot, get the img data
var imgElem = $('<img/>').attr('src',imgData); // create an img and add the data to it
$('#imgChart1').append(imgElem);​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ // 
```

我正在使用 primefaces 3.2，因此无法使用 primefaces 中提供的新功能``````

# image-processing - 如何协调彩色图像

> ID：12182602
> 
> 赞同：1
> 
> 时间：2012-08-29T16:37:26.100
> 
> 标签：image-processing, opencv

我正在寻找一种方法来协调某些图像的颜色。

~~在 youtube 上，我找到了一个说明它的视频：http: [//youtu.be/DvrUYtLju4Y](http://youtu.be/DvrUYtLju4Y)但他们没有添加一些纸张或实现。~~

有人有想法吗？

**//更新**

好的，对不起。当然，在我问这个问题之前，我读了一篇论文。请参阅[颜色协调](http://www.igl.ethz.ch/projects/color-harmonization/harmonization.pdf)。在那里我读到了一些关于一些色调的东西——“协调模式”。他们从当前图像生成色调直方图，并将其与这些模板进行比较。我的问题是为当前图像找到最佳模板。2 个直方图的正常比较不起作用，因为存在角度。

**问题是如何找到最适合我的图像的图案？** ![协调模式](../Images/08cba69fb168fba8762ef90e28a1bde0.png)

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:40:47.300

谷歌搜索 5 秒后，我找到了关于使用视频图像的[颜色协调的文章。](http://www.igl.ethz.ch/projects/color-harmonization/harmonization.pdf)

这是[另一篇论文](http://graphics.stanford.edu/~niloy/research/vid_harmonize/paper_docs/vidHarmonize_icvgip_08.pdf)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T16:51:16.727

**OpenCV 中没有内置解决方案**。但是有关于这个主题的出版物。

检查： [增强现实的色彩协调](http://www.icg.tu-graz.ac.at/Members/denis/publication/colorharmonizationforaugmentedreality/)

# rest - 用于帐户转移的 REST 中的无状态与重载 POST 示例

> ID：12182609
> 
> 赞同：2
> 
> 时间：2012-08-29T16:37:43.733
> 
> 标签：rest

我正在阅读 RESTful Web 服务 (OReilly)。作者提到无状态（Application state 与 Resource state 相反）是 ROA 的主要特征之一。

在本书的后面，当他以账户转移为例来解释事务时，他提到了将事务公开为资源的选项，这比重载的 POST 更加 RESTful。

将交易公开为资源：从书中总结：

将 50 美元从 Checking ($200) 转移到 Savings ($200) 最终结果：Checking ($250) 和 Savings ($150)

支票账户资源暴露于`/accounts/checking/11`，储蓄账户资源暴露于`/accounts/savings/55`

```
POST /transactions/account-transfer HTTP/1.1
Host: example.com 
```

返回

```
201 Created
Location: /transactions/account-transfer/11a5 
```

在支票上投入 150 美元

```
PUT /transactions/account-transfer/11a5/accounts/checking/11 HTTP/1.1
Host example.com

balance=150 
```

并节省 250 美元

```
PUT /transactions/account-transfer/11a5/accounts/savings/55 HTTP/1.1
Host: example.com

balance=250 
```

最后把committed=true

```
PUT /transactions/account-transfer/11a5/1.1
Host: example.com

committed=true 
```

他说，这可以通过建立与交易相关的动作队列来实现。从书中：

*提交事务时，服务器可能会启动数据库事务，应用排队的操作，然后尝试提交数据库事务。*

我的问题是：

维护服务器上的操作队列不是有状态的（应用程序状态）吗？因此违反了无国籍状态？

**在 Kai Mattern 的回答之后进行编辑**

我认为您所说的是这个动作队列是资源状态而不是应用程序状态。这本书也做出了这种区分，并说资源状态是好的，但不是应用程序状态。

但是，当您考虑到可以在负载平衡的服务器上分发无状态应用程序这一事实时，上述一系列 POST 和 PUT 不会让您这样做。负载均衡器应将所有请求发送到 1 个特定服务器，因为在该 1 个服务器上维护一个操作队列。否则，如果将上述资源拆分为驻留在多台机器上（以启用负载平衡），则可能需要类似 RESTful 两阶段提交事务的东西。

因此，对于这个特定的示例，我们正在查看 2 个选项 Overloaded POST Stateless App Vs 2 phase commit Stateless App。

是这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:00:50.990

无状态并不意味着应用程序完全没有头绪。这只是意味着应用程序不会通过 url、cookie 以及更重要的数据库之外的其他方式记住其状态。

这导致您不应将数据保存在诸如服务器会话之类的东西中，除非该会话信息被映射到诸如会话资源之类的东西中。

因此，只要将操作映射到资源，它就有机会成为无状态的。

请注意，将操作映射到 url 通常会诱使您创建像 /transactions/startTransaction 这样的 url 之类的操作 - 这是错误的。将资源视为名词 - 而不是动词。

例如：

```
logging in -> create a session resource 
logging out -> delete the session resource 
```

您的示例显示的正是这种行为：您创建了一个资源（帐户转移）。您修改它以包含所有相关数据。然后你通过提交来改变它的状态（是的，状态）。

一旦提交标志被写入，后端就会处理这个事务。这可以通过将事务放入队列来完成。但那部分不是前端的一部分——无国籍状态可能会也可能不会止步于此。

因此，回答您的问题：不要将数据状态与应用程序状态混合。将动作队列作为资源维护是无状态的。在服务器内存中维护操作（有状态的应用程序服务器会话）不是。

# c# - 使用 Box, Inc c# sdk 创建多个文件夹会引发“参数计数不匹配”。例外

> ID：12182611
> 
> 赞同：2
> 
> 时间：2012-08-29T16:37:44.637
> 
> 标签：c#, box-api

当我使用 Box, Inc c# sdk 一次创建多个文件夹时，我遇到了一个 javascript 错误。我一直在使用一个由路径和字符串列表组成的类作为子目录的路径。但是，当我调用 CreateBoxFolders 方法时，它会随机引发参数计数不匹配异常。到目前为止，我无法确定原因。

```
 private void CreateBoxFolders(string dir, long boxfolderid)
    {
        string[] dirnames = dir.Path.Split('\\');

        CreateBoxFolder(dirnames[dirnames.Count() - 1], boxfolderid);

        long id = GetFolderId(dirnames[dirnames.Count() - 1], boxfolderid);

        // This is a class with a list that stores the folder structure and path 
        dir.ChildDirectories.ForEach(x =>
            CreateBoxFolders(x, id));
    }

    private void CreateBoxFolder(string name, long parent)
    {
        _BoxManager.CreateFolder(name, parent, false);
    }

    private long GetFolderId(string name, long parent)
    {
        var folders = _BoxManager.GetFolderStructure(parent,
                  BoxSync.Core.Primitives.RetrieveFolderStructureOptions.OneLevel);
        long number = folders.Folder.Folders.Where(x => x.Name == name.Trim()).First().ID;
        return number;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T16:36:37.020

我怀疑您的数组之一为空或为空。

```
long id = GetFolderId(dirnames[dirnames.Count() - 1], boxfolderid); 
```

此行可能在某些时候使用 id=0 的根文件夹。文件夹 0 是位于您帐户根目录的虚拟文件夹，没有任何目录结构。因此它是根。我怀疑（不是 C# 程序员）这是评估到

```
long id = ...(emptyarray[emptyarray.Count() -1], ... 
```

我怀疑空数组的计数可能为空或零。空会很糟糕......

# php - 运行带有指向另一个查询的链接的查询。

> ID：12182612
> 
> 赞同：4
> 
> 时间：2012-08-29T16:38:01.157
> 
> 标签：php, mysql, hyperlink

我希望第 1 列的结果 - 基金简称与每条记录的其他详细信息超链接。我将如何进行？或者只是调用一个指向另一个查询将运行的详细信息页面的链接会更好。这似乎更静态一些。

这是我正在使用的示例查询。

```
<?php
$con = mysql_connect("localhost","root","");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("bdcarterascv2", $con);

$COD_PAIS = '3';
$F_HASTACORTE = '2012-03-31 01:00:00';

$result = mysql_query("SELECT mcarteras.DES_CARTERA_CC                 AS 'Short Name of Fund'
     , mcarterasflias.DES_CARTERAFLIA           AS 'I/C'
     , msociedades.DES_SOCIEDAD_CORTO           AS 'Fund Manager Company'
     , mcarteras_clases.DES_CARTERACLASE        AS 'Class'
     , mcarteras_clasesesp.DES_CARTERACLASE_ESP AS 'Special Class'
     , dr_rentmovil_carteras.POR_RENTCARTERA    AS 'TTR year-to-date %'
     , dficha_mes.POR_REMUNERA_COBRADA          AS 'Mgmt Fee Effectively Charged'
     , dficha_mes.POR_GASTOS_TOTALESC           AS 'Total Expenses %'
     , dficha_mes.VR_CARTERA_FCORTE             AS 'Fund Size'

  FROM mcarteras
    INNER
 JOIN mcarterasflias
    ON mcarterasflias.ID_CARTERAFLIA           = mcarteras.ID_CARTERAFLIA
INNER
  JOIN msociedades
    ON msociedades.ID_SOCIEDAD                 = mcarteras.ID_SOCIEDADADM
INNER
  JOIN mcarteras_clases
    ON mcarteras_clases.ID_CARTERACLASE        = mcarteras.ID_CARTERACLASE
INNER
  JOIN mcarteras_clasesesp
    ON mcarteras_clasesesp.ID_CARTERACLASE_ESP = mcarteras.ID_CARTERACLASE_ESP  
INNER
  JOIN dr_rentmovil_carteras
    ON dr_rentmovil_carteras.ID_CARTERA        = mcarteras.ID_CARTERA   
   AND dr_rentmovil_carteras.COD_PAIS                                       = $COD_PAIS
   AND dr_rentmovil_carteras.F_HASTACORTE                                   = '$F_HASTACORTE'
   AND dr_rentmovil_carteras.ID_FORMATO = 1
   AND dr_rentmovil_carteras. ID_COLUMNA = 5
INNER
  JOIN dficha_mes
    ON dficha_mes.ID_CARTERA                   = mcarteras.ID_CARTERA   
   AND dficha_mes.COD_PAIS                                                  = $COD_PAIS
   AND dficha_mes.F_CORTE                                                   = '$F_HASTACORTE'

 WHERE mcarteras.COD_PAIS                                                   = $COD_PAIS
   AND mcarteras.ID_CARTERATIPO = 4
   AND mcarteras.ID_CARTERAFLIA IN ( 3,4 )
   AND mcarteras.IND_PUBLICACION = 1
   AND mcarteras.COD_ESTADO= 1

")
    or die(mysql_error());

// HTML ... Aliases from Mysql
echo "<table border='1'>
<tr>
<th>Short Name of Fund</th>
<th>I/C</th>
<th>Fund Manager Company</th>
<th>Class</th>
<th>Special Class</th>
<th>TTR year-to-date %</th>
<th>Mgmt Fee Effectively Charged</th>
<th>Total Expenses %</th>
<th>Fund Size</th>

</tr>";

//<tr> specifies table row. for each <td> (table data) will specify a new column.  The     $row specifies the mysql column name (in this case using an alias)
while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . $row['Short Name of Fund'] . "</td>";
  echo "<td>" . $row['I/C'] . "</td>";
  echo "<td>" . $row['Fund Manager Company'] . "</td>";
  echo "<td>" . $row['Class'] . "</td>";
  echo "<td>" . $row['Special Class'] . "</td>";
  echo "<td>" . $row['TTR year-to-date %'] . "</td>";
  echo "<td>" . $row['Mgmt Fee Effectively Charged'] . "</td>";
  echo "<td>" . $row['Total Expenses %'] . "</td>";
  echo "<td>" . $row['Fund Size'] . "</td>";

  echo "</tr>";
  }
echo "</table>";

mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:50:36.110

您要做的是，创建一个链接并将其映射到最传统的 ID 或 url 安全名称。

我会将其超链接到一个附加页面，因为我确定详细信息的格式与您的主表不同。

在您的 select 语句中添加一个 ID，或将以下内容更改为短名称：

```
...
echo "<td><a href=\"page.php?id={$row['ID']}\">{$row['Short Name of Fund']}</a></td>"; 
```

然后在`page.php`：

```
SELECT ... WHERE ID = $_GET['ID']; 
```

**当然，**请停止使用`mysql_*`这套代码，因为它已被弃用、不受支持，并且到处都是不良宣传。您应该使用`PDO`或`MySQLi`。

**注意**：以上内容不针对 SQL 注入进行保护。将您的驱动程序切换到`PDO`或`MySQLi`使用某种安全感。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:55:20.883

另一种选择是，如果您的详细信息通常是简短的详细信息，基本上是几个单词或短句，您始终可以将它们打印为 td 标题。

这样，如果用户需要了解有关某些数据的更多细节，他只需将鼠标悬停在它上面，然后就可以了。

或者更优雅的解决方案是使用 jquerys 工具提示插件，以防大量详细数据。Jquery tooltip 基本上可以在标题标签内显示任何 html 代码，它的美妙之处在于您唯一需要做的就是像定义任何其他标题标签一样定义一个 td 标题，在 html 标题中包含 jquery lib 和 tooltip lib，并使用像这样的一些 js 代码：

```
<script>
$('#tableid td').tooltip();
</script> 
```

您甚至可以从 css 编辑工具提示样式。

这里的演示：http: [//jquery.bassistance.de/tooltip/demo/](http://jquery.bassistance.de/tooltip/demo/)

唯一的问题是，如果您想在同一页面上使用太多工具提示，您的页面加载时间会增加。

# html - HTML5 边距/填充

> ID：12182617
> 
> 赞同：7
> 
> 时间：2012-08-29T16:38:34.997
> 
> 标签：html, css

`figure`如果其中有图像，HTML5 元素似乎会添加一些边距/填充。如果您在图形周围添加边框，您可以在元素内看到一个小填充。

```
<figure>
    <img src="image" alt="" />
</figure> 
```

我通过编写用 CSS 重置所有边距和填充`* { margin: 0; padding: 0 }`

有人知道如何处理吗？请看看这个小提琴：http: [//jsfiddle.net/74Q98/](http://jsfiddle.net/74Q98/)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-29T16:41:05.730

这不是错误 - 这是元素`<figure>`的正常行为`<img>`

要修复它试试这个 -[**演示**](http://jsfiddle.net/74Q98/1/)

```
img {
    border: 1px solid green;
    display: block;
    vertical-align: top;
} 
```

**更新**

默认情况下，任何图像都呈现为内联（如文本），因此下方的小额外空间是所有文本行所具有的空间（即 for`q`等`p`）

上面的答案结合了两种解决问题的方法。所以基本上你可以只使用其中之一：

```
img { display: block; } 
```

或者

```
img { vertical-align: top; } 
```

# c# - 方法范围的实例变量

> ID：12182620
> 
> 赞同：4
> 
> 时间：2012-08-29T16:38:40.820
> 
> 标签：c#, scope

我偶尔会发现自己有一个变量，该变量只能被类中的一种方法使用。目前我使用一个实例变量，但让这个变量对类的其余部分可见似乎是糟糕的设计。示例只是为了说明我想要的情况：

```
private Window _Window;
private void Show()
{
    if (_Window == null)
    {
        _Window = new Window();
        _Window.Closed += delegate { _Window = null; };
        _Window.Show();
    }
    _Window.BringIntoView();
} 
```

实例变量的存在只是为了防止一次创建多个窗口，因此类的其余部分没有理由知道它。我想起了 C++ 在函数中定义静态变量的能力。

有什么方法可以实现这样的C#吗？还是我坚持在糟糕的设计和糟糕的封装之间做出选择？（假设这个方法确实不能保证它自己的类。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T16:40:27.077

> 有什么方法可以实现这样的C#吗？

不。

> 还是我坚持在糟糕的设计和糟糕的封装之间做出选择？（假设这个方法确实不能保证它自己的类。）

好吧，我不确定你是否真的被其中任何一个所困扰。听起来这是对象状态的一部分，即使其他方法都不需要引用其状态的那个方面。同一个类中的其他代码引用状态的这个方面在*逻辑上*是错误的吗？如果是这样，为什么？

（诚​​然，我偶尔希望能够在属性声明“内”声明一个字段，从而强制类的其余部分通过该属性访问状态......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:40:03.447

> 有什么方法可以实现这样的C#吗？

不，不幸的是，C# 没有能力定义作用域为方法的类级别变量。

附带说明一下，Visual Basic 确实通过[Static 修饰符](http://msdn.microsoft.com/en-us/library/z2cty7t8.aspx)允许这样做。这会导致编译器创建一个（修饰的）类级变量，但语言只允许在定义它的 Sub 或 Function 中使用它。但是，其他语言会将其视为成员变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T23:48:00.093

我知道的唯一方法比你试图避免的混乱更糟糕。

```
// Constructor
public MyClass()
{
    {
        // _Window is private to this closure
        Window _Window;
        Show = () =>
        {
            if (_Window == null)
            {
                _Window = new Window();
                _Window.Closed += delegate { _Window = null; };
                _Window.Show();
            }
            _Window.BringIntoView();
        };
    }
}

// Replaces Show method
private Action Show; 
```

然后使用 Show.Invoke() 而不是 Show()。然而，这种方法在某些地方更好：[http](http://www.headspring.com/patrick/public-private-super-private/) ://www.headspring.com/patrick/public-private-super-private/ 。但是，在我看来，私有方法应该在 C#/Java 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T16:52:38.717

一种选择是让窗口类本身保持对自身实例的静态引用。您还将`Display()`在窗口类中公开一个静态方法，让窗口类处理实例的创建和处置。基本上你必须将你的代码移动到你的windows类中。

```
private static DisplayWindow _window;

public static void Display()
{
    if (_window == null)
    {
        _window = new DisplayWindow();
        _window.Closed += delegate { _window = null; };
        _window.Show();
    }
    _window.BringIntoView();
} 
```

在另一个班级

```
DisplayWindow.Display(); // No variable required here! 
```

* * *

如果您想禁止这种类型的窗口的“狂野”创建，请将窗口的构造函数设为私有

```
private DisplayWindow()
{
} 
```

`Display()`如果他们想打开这个窗口，这会强制其他类调用。

# php - 我应该使用哪种 SQL 类型来输入值 4.865472349

> ID：12182627
> 
> 赞同：6
> 
> 时间：2012-08-29T16:39:07.273
> 
> 标签：php, mysql, sql, types

PHP 运行一个正确计算值的脚本。当我回显该值时，它显示为 4.865472349

然后使用一个简单的更新脚本将值输入到我的数据库中。

```
$query = "UPDATE members
     SET rating = $r 
     WHERE username = '$username'";
mysql_query($query); 
```

当我这样做时，输入到数据库中的值为 5。

如果我将前面公式中的 $r 直接替换为 4.865472349，它会产生相同的结果。

显然这是因为我的 SQL 类型设置为“整数”

但我不知道要改成什么来解决这个问题。有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:44:46.640

如果您想要与 4.865472349 相同的精度，可以使用 DECIMAL(10,9)

参考

> 例如，DECIMAL(18,9) 列的小数点两侧各有 9 位，因此整数部分和小数部分各需要 4 个字节。DECIMAL(20,6) 列有 14 个整数位和 6 个小数位。整数位中的九位需要四个字节，其余五位需要 3 个字节。六个小数位需要 3 个字节。

假设您使用的是 MySql

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T16:43:08.490

您可能应该使用[DOUBLE](http://dev.mysql.com/doc/refman/5.0/en/floating-point-types.html)。它与 PHP 中的浮点数具有相同的精度和范围（在大多数配置中）。

使用 PHPMyAdmin 切换类型：

1.  点击表格
2.  点击结构
3.  点击评分旁边的更改（铅笔图标）
4.  在“类型”下选择“双”选项
5.  点击保存

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:44:16.500

编辑数据库中的列类型，使其能够容纳的不仅仅是一个整数。

```
ALTER TABLE members
CHANGE rating rating float(10,9); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T16:44:41.883

您可以使用浮点数、双精度数或十进制数，具体取决于您要存储的数字。我会说浮动已经足够好了。

# javascript - 根据星期几制作缓动滑块开始横幅

> ID：12182630
> 
> 赞同：0
> 
> 时间：2012-08-29T16:39:20.907
> 
> 标签：javascript, wordpress

我目前在 Wordpress 项目中使用 Easing Slider 插件，并且 Starter 横幅应取决于一周中的哪一天。例如：

星期天：第 1 号横幅，星期一：第 2 号横幅，星期二：第 3 号横幅，依此类推……

我怎么能做到？提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:54:57.800

在 Easing Slider Wordpress 插件中，StartItem 应该这样更改：

```
startItem: new Date().getDay() 
```

根据工作日启动滑块，在周日它将从第一个横幅开始，周一从第二个横幅开始，依此类推..

# objective-c - 获取 UITabBarController 中选定选项卡的标题

> ID：12182631
> 
> 赞同：2
> 
> 时间：2012-08-29T16:39:30.237
> 
> 标签：objective-c, ios5, uitabbarcontroller, appdelegate

我已经在我的 AppDelegate 文件中设置了所有五个选项卡的标题。我想在我的应用程序的另一个视图中访问该标题。我有下面的代码将所选选项卡的所选索引输出到日志窗口，但我真正想要的是该选项卡的标题。我确实查看了 UITabBarController 类参考，但没有看到任何可以让我这样做的东西。

我要避免的是某种 switch 或 if...else 语句，我在其中硬编码已经在另一个文件中手动设置的值。

```
- (void)viewDidLoad {
[super viewDidLoad];

AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
NSLog(@"The currently selected tab has an index of: %d", appDelegate.tabBarController.selectedIndex);

} 
```

此代码按预期工作。看到标题就很理想了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T17:24:13.510

```
UIViewController* vc = appDelegate.tabBarController.selectedViewController;
NSString* tabTitle = vc.tabBarItem.title; 
```

如果代码在选定的视图控制器中，那就更容易了：

```
NSString* tabTitle = self.tabBarItem.title; 
```

# rake - 如何使用 rake 将文件从 gem 复制到我的 rails 应用程序

> ID：12182632
> 
> 赞同：9
> 
> 时间：2012-08-29T16:39:43.507
> 
> 标签：rake, rakefile

我有一个带有默认配置 YAML 文件 some_config.yml 的 gem。我想创建一个 rake 任务来将该文件复制到我的 rails 应用程序的 config/ 目录中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-14T22:59:19.163

如果我们假设目标 gem 在您的 Gemfile 中，并且您想在 Rails Rakefile 中包含 Rake 任务，那么您可以尝试以下操作：

```
namespace :config do
  # desc "Copy the config"
  task :copy do
    source = File.join(Gem.loaded_specs["myGem"].full_gem_path, "config", "config.yml")
    target = File.join(Rails.root, "config", "myGemConfig.yml")
    FileUtils.cp_r source, target
  end
end 
```

# mod-rewrite - mod重写重定向

> ID：12182635
> 
> 赞同：0
> 
> 时间：2012-08-29T16:39:49.497
> 
> 标签：mod-rewrite, url-rewriting

全部，

我对mod重写很陌生。我需要将其网址中带有“citzenhawk”参数的任何用户重定向到我的网址

例如：

`http://www.mywebsite.com/?sc=CX12N003&cm_mmc=affiliate-_-citizenhawk-_-nooffer-_-na&prfc=5&clickid=0004c845fa9a87050a4277221a003262`

应该导致重定向到：

`http://www.mywebsite.com/`

这是我的重写条件：

```
RewriteCond %{QUERY_STRING} (&|^)cm_mmc=(.*)citizenhawk(.*)(&|$)$
RewriteRule ^/rrs/ [NC,R=302,L] 
```

我哪里错了？有人可以帮我举个例子吗。

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:13:00.900

尝试：

```
RewriteCond %{QUERY_STRING} ^cm_mmc=[^&]*citizenhawk [OR]
RewriteCond %{QUERY_STRING} &cm_mmc=[^&]*citizenhawk
RewriteRule .* / [R=permanent,L] 
```

这将重定向在名为 cm_mmc 的查询字符串变量中包含“citizenhawk”的任何请求。它发出一个永久（代码 301）请求，但将其保留为`R=302`好像这只是一个临时重定向。

目前尚不清楚您为什么要检查请求，`/rrs/`所以我曾经`.*`捕获所有请求。

# google-app-engine - 是否可以在谷歌应用引擎中的项目/应用之间共享数据存储实体？

> ID：12182643
> 
> 赞同：0
> 
> 时间：2012-08-29T16:40:25.977
> 
> 标签：google-app-engine

> **可能重复：**
> [Google App Engine - 一个用于不同域和应用程序的数据存储](https://stackoverflow.com/questions/811166/google-app-engine-one-datastore-for-different-domains-and-apps)

是否可以在谷歌应用引擎中的项目/应用之间共享数据存储实体？

如果我有两个项目都更新具有相同种类和标识符的实体，他们将能够访问同一个对象吗？

[名称空间](https://developers.google.com/appengine/docs/java/multitenancy/multitenancy#Using_Namespaces_with_the_Memcache)是否可以跨同一帐户中的应用程序访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:04:56.910

查看问题的答案[Google App Engine - 一个适用于不同域和应用程序的数据存储](https://stackoverflow.com/questions/811166/)。你基本上需要在同一个app_id下有两个版本。

# jsp - JSP servlet 映射

> ID：12182647
> 
> 赞同：3
> 
> 时间：2012-08-29T16:40:30.540
> 
> 标签：jsp, java-ee-6, servlet-3.0, url-mapping

随着[Servlet 3.0的引入，我们可以使用 web.xml 中的](http://today.java.net/pub/a/today/2008/10/14/introduction-to-servlet-3.html)[注释](http://docs.oracle.com/javaee/6/api/javax/servlet/annotation/WebServlet.html)和省略映射将 servlet 映射到 URL 模式。

我想知道是否有一些说明或特殊标签允许将 jsp 映射到页面代码中的 URL 而无需在 web.xml 中声明 servlet

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T17:09:08.400

没有这样的设施。

您可以做的最好的事情是将 JSP 隐藏在其中`/WEB-INF`（这样它就永远不会被 URL 直接请求），只需创建一个转发到该 JSP 的 servlet，最后将其映射到所需的 URL 模式。这很容易：

```
@WebServlet("/foo")
public class FooServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        request.getRequestDispatcher("/WEB-INF/foo.jsp").forward(request, response);
    }

} 
```

这样 JSP`/WEB-INF/foo.jsp`就可以通过`http://localhost:8080/context/foo`. [您可以使用前端控制器模式](https://stackoverflow.com/questions/3541077/design-patterns-web-based-applications/3542297#3542297)将其进一步抽象为一组 JSP 的单个 servlet 。

# jquery - jQuery onclick 正文中的所有图像

> ID：12182648
> 
> 赞同：2
> 
> 时间：2012-08-29T16:40:37.510
> 
> 标签：jquery, onclick, document, image

英语不是我的母语，所以请耐心等待。

我试图做到这一点，以便当用户单击我网站上的任何图像时，一个画廊类型的 div 将变得可见，其中包含最大尺寸的图像。

我现在的做法是；

```
 var image = $("body > image");

image.on('click', function(){
    var imageURL = $(this).attr('src');
    backgroundCurtain.css({"display": "block"});
    imageResized.attr("src", imageURL);
    var imageWidth = imageResized.width();
    pictureInner.css({"width" : imageWidth});
}); 
```

这不起作用，老实说，我没想到它会起作用。我该如何称呼它，以便正文中的每个图像元素。我如何“调用”体内的每个图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T16:41:40.967

要使用 jquery 引用所有图像，只需执行

```
var images = $("img"); 
```

但是，通常您不希望将其应用于所有图像（例如 imageResized 不应该在此集中）。一个好的解决方案是添加一个 css 类（例如`class="zoomable"`）到您想要可缩放的元素并使用此选择器：

```
var images = $("img.zoomable"); 
```

看看[这个参考](http://api.jquery.com/category/selectors/)。

请注意，大多数情况下，我们不会为更大的图像使用相同的 URL，因为这意味着要为缩略图加载大图像。我的做法是有一个像“someFile.jpg”和“someFile-big.jpg”这样的命名模式并做这样的事情：

```
$("img.zoomable").on('click', function(){
    var imageURL = $(this).attr('src');
    backgroundCurtain.css({"display": "block"});
    imageResized.onload = function(){
        var imageWidth = imageResized.width();
        pictureInner.css({"width" : imageWidth});
    };
    imageResized.attr("src", imageURL.split('.')[0]+'-big.jpg');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:42:50.050

```
var image = $("img");

image.on('click', function(){
    var imageURL = this.src;
    backgroundCurtain.css("display", "block");
    imageResized.attr("src", imageURL);
    var imageWidth = imageResized.width();
    pictureInner.css("width", imageWidth);
}); ​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T16:46:06.203

问题在于您的选择器。'>' 选择器指定一个直接子级`<body><img /></body>`。@dstroy 建议的选择器只会抓取整个页面上的任何图像。但是，这可能不是您想要完成的。

我假设您有一些表单元素（让我们假设一个 ID 为“gallery”的 DIV）包含您感兴趣的所有图像。然后您可以使用

```
var images = $("#gallery img"); 
```

这样，图标和“chrome”图像将不会显示在背景上。

# node.js - ExpressJS & Websocket & 会话共享

> ID：12182651
> 
> 赞同：30
> 
> 时间：2012-08-29T16:41:04.723
> 
> 标签：node.js, session, websocket, express

我正在尝试制作一个基于 Node.js 的聊天应用程序。我想强制 websocket 服务器（ws 库）使用 ExpressJS 会话系统。不幸的是，我被卡住了。用于获取会话数据的 MemoryStore 哈希与 cookie 中的会话 ID 不同。有人可以解释一下我做错了什么吗？

Websocket服务端代码部分：

```
module.exports = function(server, clients, express, store) {
  server.on('connection', function(websocket) {
    var username;

    function broadcast(msg, from) {...}

    function handleMessage(msg) {...}

    express.cookieParser()(websocket.upgradeReq, null, function(err) {
        var sessionID = websocket.upgradeReq.cookies['sid'];

            //I see same value in Firebug
        console.log(sessionID);

            //Shows all hashes in store
            //They're shorter than sessionID! Why?
        for(var i in store.sessions)
            console.log(i);

        store.get(sessionID, function(err, session) {
                websocket.on('message', handleMessage);

                //other code - won't be executed until sessionID in store

                websocket.on('close', function() {...});
        });
    });
});
} 
```

存储对象定义：

```
var store = new express.session.MemoryStore({
    reapInterval: 60000 * 10
}); 
```

应用配置：

```
app.configure(function() {
    app.use(express.static(app.get("staticPath")));
    app.use(express.bodyParser());
    app.use(express.cookieParser());

    app.use(express.session({
        store: store,
        secret: "dO_ob",
        key: "sid"
    }));
}); 
```

部分主要代码：

```
var app = express();
var httpServer = http.createServer(app);
var websocketServer = new websocket.Server({server: httpServer});
httpServer.listen(80); 
```

示例调试输出：

```
- websocket.upgradeReq.headers.cookie "sid=s%3A64a%2F6DZ4Mab8H5Q9MTKujmcw.U8PJJIR%2BOgONY57mZ1KtSPx6XSfcn%2FQPZ%2FfkGwELkmM"
- websocket.upgradeReq.cookies["sid"] "s:64a/6DZ4Mab8H5Q9MTKujmcw.U8PJJIR+OgONY57mZ1KtSPx6XSfcn/QPZ/fkGwELkmM"
- i "64a/6DZ4Mab8H5Q9MTKujmcw" 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2015-01-01T00:31:25.750

我发现这对我有用。不确定这是不是最好的方法。首先，初始化您的 express 应用程序：

```
// whatever your express app is using here...
var session = require("express-session");
var sessionParser = session({
    store: session_store,
    cookie: {secure: true, maxAge: null, httpOnly: true}
});
app.use(sessionParser); 
```

现在，从 WS 连接显式调用会话中间件。如果您正在使用该`express-session`模块，则中间件将自行解析 cookie。否则，您可能需要先通过 cookie 解析中间件发送它。

如果您正在使用该`websocket`模块：

```
ws.on("request", function(req){
    sessionParser(req.httpRequest, {}, function(){
        console.log(req.httpRequest.session);
        // do stuff with the session here
    });
}); 
```

如果您正在使用该`ws`模块：

```
ws.on("connection", function(req){
    sessionParser(req.upgradeReq, {}, function(){
        console.log(req.upgradeReq.session);
        // do stuff with the session here
    });
}); 
```

为方便起见，这是一个完整的示例，使用`express`、`express-session`和`ws`：

```
var app = require('express')();
var server = require("http").createServer(app);
var sessionParser = require('express-session')({
    secret:"secret",
    resave: true,
    saveUninitialized: true
});
app.use(sessionParser);

app.get("*", function(req, res, next) {
    req.session.working = "yes!";
    res.send("<script>var ws = new WebSocket('ws://localhost:3000');</script>");
});

var ws = new require("ws").Server({server: server});
ws.on("connection", function connection(req) {
    sessionParser(req.upgradeReq, {}, function(){
        console.log("New websocket connection:");
        var sess = req.upgradeReq.session;
        console.log("working = " + sess.working);
    });
});

server.listen(3000); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-05-06T08:55:31.567

我能够得到这个工作。我认为您需要在 cookieParser 而不是会话存储上指定秘密。

我的应用程序示例：

```
var app = express();
var RedisStore = require('connect-redis')(express);
var sessionStore = new RedisStore();
var cookieParser = express.cookieParser('some secret');

app.use(cookieParser);
app.use(express.session({store: sessionStore}));

wss.on('connection', function(rawSocket) {

  cookieParser(rawSocket.upgradeReq, null, function(err) {
    var sessionID = rawSocket.upgradeReq.signedCookies['connect.sid'];
    sessionStore.get(sessionID, function(err, sess) {
      console.log(sess);
    });
  });

}); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-11-03T14:15:22.663

**2022年2月更新：**

`verifyClient`现在是[气馁](https://github.com/websockets/ws/issues/377)。[问题评论](https://github.com/websockets/ws/issues/377#issuecomment-462152231)中描述了执行此操作的新方法。

有关完整的使用示例，请参阅[会话解析和验证的示例代码。](https://github.com/websockets/ws/blob/master/examples/express-session-parse/index.js)验证函数示例：

```
server.on('upgrade', function (request, socket, head) {
  console.log('Parsing session from request...');

  sessionParser(request, {}, () => {
    if (!request.session.userId) {
      socket.write('HTTP/1.1 401 Unauthorized\r\n\r\n');
      socket.destroy();
      return;
    }

    console.log('Session is parsed!');

    wss.handleUpgrade(request, socket, head, function (ws) {
      wss.emit('connection', ws, request);
    });
  });
}); 
```

**原答案：**

在 3.2.0 版本中，`ws`你必须做一些不同的事情。

回购中有一个快速会话解析的[完整工作示例](https://github.com/websockets/ws/blob/master/examples/express-session-parse/index.js)`ws`，特别是使用新功能`verifyClient`。

一个非常简短的使用总结：

```
const sessionParser = session({
  saveUninitialized: false,
  secret: '$eCuRiTy',
  resave: false
})

const server = http.createServer(app)
const wss = new WebSocket.Server({
  verifyClient: (info, done) => {
    console.log('Parsing session from request...')
    sessionParser(info.req, {}, () => {
      console.log('Session is parsed!')
      done(info.req.session.userId)
    })
  },
  server
})

wss.on('connection', (ws, req) => {
  ws.on('message', (message) => {
    console.log(`WS message ${message} from user ${req.session.userId}`)
  })
}) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-10-27T20:33:34.187

WS v3.0.0 及更高版本已经改变了行为，因此给定的答案对于这些版本不会开箱即用。对于当前版本，连接方法的签名是 [function(socket, request)] 并且套接字不再包含对请求的引用。

```
ws.on(
    'connection',
    function (socket, req)
    {
        sessionParser(
            req,
            {},
            function()
            {
                console.log(req.session);
            }
        );
    }
); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-07-18T17:01:33.523

目前，以下是我的工作正常的解决方法。我只是不知道它的缺点和安全性。如果它没有会话，我只是阻止服务器监听。（[从 express-session 到 ws 共享会话](https://stackoverflow.com/questions/44927250/share-session-from-express-session-to-ws)）

不过，我还没有完全测试过。

```
var http = require('http');
var express = require('express');
var expressSession = require('express-session');
var router = express.Router();
var app = express();

const server = http.createServer(app);

router.get('/', function(req, res, next) {
    if(req.session.user_id) {
        // Socket authenticated
        server.listen(8080, function listening(){});
    }
}); 
```

# git - 测试分支已删除：所有未提交的更改现在都在主分支上丢失了吗？

> ID：12182653
> 
> 赞同：0
> 
> 时间：2012-08-29T16:41:07.940
> 
> 标签：git, github

这是我第一次使用 git，我希望我没有犯大错。

我在 master 分支上的文件上工作了几个小时。

我创建了一个分支来朝着不同的方向工作，然后我决定不这样做。因此，在这个新分支中没有编辑任何文件。

所以我删除了新分支。

现在我在最后几个小时所做的所有更改都已在 master 分支中消失，我回到了上次提交的状态。

在创建分支之前，我没有提交任何东西。

我的所有更改现在都丢失了吗？

我虽然在处理第二个分支时甚至不会触及主分支，但当我删除它时，git 仍会等待更改提交。

真的希望你能在这里帮助我。我正在使用 mac 上的 github 应用程序。

**让我猜猜发生了什么：**

论文：永远不要在没有先提交更改的情况下切换到分支。

我想当我创建第二个分支时，这个分支当然是从上次提交中创建的。所以一切都已经设置回最后一次提交。所以切换回 master 分支的意思是一样的。这里没有要跟踪的文件，因为一切都回到了上次提交的状态。

我对吗？

因此，这意味着当您不总是提交更改时，丢失数据的风险很大。而且你总是应该在切换分支之前提交。对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:05:01.910

切换分支会随身携带未提交的更改。因此 github 认为您所做的更改是测试分支的一部分，而不是主分支。要么先提交，要么运行 git checkout 。撤消它们，或在切换之前运行 git stash 。（您可以使用 git stash apply 取回您的更改）。

> 在您的场景中，文件更改已经消失，因为您没有提交也没有隐藏。

# python - 在 Django/Python 中复制或克隆对象实例

> ID：12182657
> 
> 赞同：2
> 
> 时间：2012-08-29T16:41:19.897
> 
> 标签：python, database, django, oop, deep-copy

我有以下场景：

```
class CourseTemplate(models.Model):
    title = models.CharField(max_length=70)
    teacher = models.ForeignKey(User)
    description = models.TextField()

    max_students = models.IntegerField()
    sessions = models.ManyToManyField(CourseSession) # e.g. Session 1 Introduction, Session 2 Basics, etc.
    rating = models.ManyToManyFields(StudentRating)
    date_added = models.DateTimeField()

class CourseEnrollment(models.Model):
    course = models.OneToOneField(CourseTemplate) # Each enrollment needs a new CourseTemplate Instance, so I can track it
    students = models.ManyToManyField(User)

Class CourseSession(models.Model):
    title = models.CharField(max_length=50)
    date = models.DateTimeField()
    details = models.CharField(max_length=100)
    address = models.TextField()
    #parent_course = models.ForeignKey(CourseTemplate)

class StudentRating(models.Model):
    student = models.ForeignKey(User)
    rating = models.IntegerField()
    #course = models.ForeignKey(CourseTemplate) 
```

现在教师（=用户）可以先创建一个包含所有必需详细信息的 CourseTemplate。保存后，他可以创建一个具体的“注册”，例如本学期有 5 个会话。也许他在 8 次注册后改变了一些细节（例如 CourseTemplate.description 或课程现在只有 7 节课而不是 8 节课）。

我想在每个 CourseTemplate 实例和每个 CourseEnrollment 之间建立 1:1 的关系，所以我可以看到例如： - 老师 X 有 2012 年的三个 CourseEnrollment，其中两个是相同的，或者 - 他第二次获得的评分课程。

呈现的“模板”应该始终是“最新的”，所以我只需要通过 CourseTemplate.date_added 获取最新的实例。

有谁知道我怎样才能避免这个问题？

非常感谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-29T17:02:35.233

您可以通过清除其主键来复制任何现有的 django 模型实例，然后再次保存它。

```
ct = CourseTemplate.objects.all()[0]
print ct.pk
# some original pk

ct.pk = None
ct.save()
print ct.pk
# will be a new auto-incremented 
```

# java - Java - Jena API - 获取另一个类的属性

> ID：12182666
> 
> 赞同：2
> 
> 时间：2012-08-29T16:41:50.583
> 
> 标签：java, xml, rdf, jena, object-properties

我正在使用 java 和 Jena API。我有一个类婚姻，它有 3 个对象属性，称为“hasHusband”、“Haswife”和“dateOfMarriage”。前两个与 Person 类相关联，该类具有名字、姓氏、出生日期等数据类型属性...

我想检索妻子的名字和丈夫的名字。你能解释一下我该怎么做吗？

这是我的 rdf 文件的相关部分：

```
(...)

<j.0:FAMmariage rdf:about=http://www.fam.com/FAM#BrunoCatherine> 

 <j.0:FAMaDateMariage>25/07/2011</j.0:FAMaDateMariage>

 <j.0:FAMhasWife>
    <rdf:Description rdf:about="http://www.fam.com/FAM#Catherine20/03/1982">
    <j.0:FAMDateOfBirth>20/03/1980</j.0:FAMDateOfBirth>
    <j.0:FAMHasName>Gomez</j.0:FAMHasName>
    <j.0:FAMHasFirstName>Catherine</j.0:FAMHasFirstName>
  </rdf:Description>
 </j.0:FAMHasWife>

 <j.0:FAMHusband>
  <rdf:Description rdf:about="http://www.fam.com/FAM# Bruno15/06/1980 ">
    <j.0:FAMaDateOfBirth>15/06/1980 </j.0:FAMDateOfBirth>
    <j.0:FAMHasName>Jeandet </j.0:FAMHasName>
    <j.0:FAMHasFirstName>Bruno</j.0:FAMHasFirstName>
  </rdf:Description>
 </j.0:FAMHusband>

</j.0:FAMmariage>
(...) 
```

谢谢

**编辑** 通过下面的代码，我可以获得 hasWife 对象属性。我应该添加什么来获得 firstName 数据类型属性？

```
//Object Property hasWife

     StmtIterator iter = onto.model.listStatements(null,onto.hasWife,(RDFNode)null);  

     while (iter.hasNext()) 
     {
        Statement stmt = iter.nextStatement();  
        System.out.println(stmt.getObject().toString());                          
     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:19:10.077

这就是[SPARQL](http://en.wikipedia.org/wiki/SPARQL)的用途。看看[Jena 的 SPARQL 教程](http://jena.apache.org/tutorials/sparql.html)。

作为替代方案，您可以以编程方式搜索模型，如[查询模型](http://jena.apache.org/tutorials/rdf_api.html#ch-Querying%20a%20Model)中所述。例如，通过使用`listStatements(Subject, Predicate, Object)`where 您可以决定哪些参数应该是`null`.

在您的情况下，您可以使用`listStatements(null, hasWifeProperty, null)`和`listStatements(null, hasHusbandProperty, null)`访问结果的相应对象。

# jquery - 如何使颜色框响应

> ID：12182668
> 
> 赞同：41
> 
> 时间：2012-08-29T16:41:53.653
> 
> 标签：jquery, colorbox, responsive-design

我在响应式网站中使用颜色框。

我有一个要求：我希望 Colorbox 自动调整自己以适应屏幕/移动设备的大小和方向：如果我改变屏幕/移动设备的方向（即，如果我旋转我的手机以将水平和垂直图片调整为屏幕尺寸，我希望 Colorbor 自动调整到屏幕的新尺寸/方向）。目前，Colorbox 仅在加载新图片时自动调整自身（例如幻灯片）。

我在封闭的谷歌小组中问了这个问题：

[https://groups.google.com/group/colorbox/browse_thread/thread/85b8bb2d8cb0cc51?hl=fr](https://groups.google.com/group/colorbox/browse_thread/thread/85b8bb2d8cb0cc51?hl=fr)

我在 github 上创建了两个功能请求：

[https://github.com/jackmoore/colorbox/issues/158](https://github.com/jackmoore/colorbox/issues/158)

但我没有任何回应，所以我尝试堆栈溢出......

有谁知道是否可以让 ColorBox 根据方向变化自动调整大小（可能在解决方法中使用回调函数）？

提前感谢任何帮助。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-05-07T13:08:14.513

如开发人员网站上所述，我使用彩盒初始化时的**maxWidth**和**maxHeight选项解决了这个问题：**

```
jQuery(*selector*).colorbox({maxWidth:'95%', maxHeight:'95%'}); 
```

您还可以添加此代码段以在调整窗口大小或更改移动设备的方向时调整颜色框的大小：

```
/* Colorbox resize function */
var resizeTimer;
function resizeColorBox()
{
    if (resizeTimer) clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function() {
            if (jQuery('#cboxOverlay').is(':visible')) {
                    jQuery.colorbox.load(true);
            }
    }, 300)
}

// Resize Colorbox when resizing window or changing mobile device orientation
jQuery(window).resize(resizeColorBox);
window.addEventListener("orientationchange", resizeColorBox, false); 
```

最终，将**jQuery**替换为**$**。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-05-02T15:00:56.603

我在这里尝试了许多解决方案，但 github 上 @berardig 的以下内容对我来说效果很好

```
var cboxOptions = {
  width: '95%',
  height: '95%',
  maxWidth: '960px',
  maxHeight: '960px',
}

$('.cbox-link').colorbox(cboxOptions);

$(window).resize(function(){
    $.colorbox.resize({
      width: window.innerWidth > parseInt(cboxOptions.maxWidth) ? cboxOptions.maxWidth : cboxOptions.width,
      height: window.innerHeight > parseInt(cboxOptions.maxHeight) ? cboxOptions.maxHeight : cboxOptions.height
    });
}); 
```

来源：[https ://github.com/jackmoore/colorbox/issues/183#issuecomment-42039671](https://github.com/jackmoore/colorbox/issues/183#issuecomment-42039671)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-28T02:14:15.413

看起来这个问题已经讨论过了，作者的 github 上提供了可行的解决方案

[https://github.com/jackmoore/colorbox/issues/158](https://github.com/jackmoore/colorbox/issues/158)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-08-23T08:13:22.793

在窗口调整大小和/或“orientationchange”时调用它，其中 960 是我的颜色框的首选宽度，我的 maxWidth = 95%

```
var myWidth = 960, percentageWidth = .95;       
if ($('#cboxOverlay').is(':visible')) {         
    $.colorbox.resize({ width: ( $(window).width() > ( myWidth+20) )? myWidth : Math.round( $(window).width()*percentageWidth ) });
    $('.cboxPhoto').css( {
        width: $('#cboxLoadedContent').innerWidth(),
        height: 'auto'
    });
    $('#cboxLoadedContent').height( $('.cboxPhoto').height() );
    $.colorbox.resize();

} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-02-14T14:26:23.497

加载与颜色框相关的 js 和 jquery lib 文件后，将此添加到您的主 js 文件中。

```
(function ($, window, document, undefined) {
//Configure colorbox call back to resize with custom dimensions 
  $.colorbox.settings.onLoad = function() {
    colorboxResize();
  }

  //Customize colorbox dimensions
  var colorboxResize = function(resize) {
    var width = "90%";
    var height = "90%";

if($(window).width() > 960) { width = "860" }
if($(window).height() > 700) { height = "630" } 

$.colorbox.settings.height = height;
$.colorbox.settings.width = width;

//if window is resized while lightbox open
if(resize) {
  $.colorbox.resize({
    'height': height,
    'width': width
      });
    } 
  }

    //In case of window being resized
  $(window).resize(function() {
    colorboxResize(true);
  });

})(jQuery, this, this.document); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-25T17:02:08.290

您应该考虑使用 @media 查询 colorBox css 文件的“框架”，就像您对其余 css 所做的那样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-01-16T07:14:50.860

这个工作正常的兄弟。

```
jQuery( document ).ready( function(){
var custom_timeout = ( function() {
    var timers = {};
    return function ( callback, ms, uniqueId ) {
        if ( !uniqueId ) {
            uniqueId = "Don't call this twice without a uniqueId";
        }
        if ( timers[uniqueId] ) {
            clearTimeout ( timers[uniqueId] );
        }
        timers[uniqueId] = setTimeout( callback, ms );
      };
})(); 
$(".group1").colorbox({rel:'group1', width:"80%" }); 
$( window ).resize( function(){
    custom_timeout(function(){
        if( $('#cboxOverlay' ).css( 'visibility' ) ){
            $(".group1").colorbox.resize({ innerWidth:'80%' });
        }
    }, 500 );
}); 
```

});

访问[演示页面](http://4nton.com/how-to-make-a-jquery-colorbox-pop-up-page-responsive/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-02-12T06:02:49.333

在 jQuery.colorbox.js 文件中进行此更改

第 24 行：-

```
maxWidth: "100%", 
```

不要进行任何其他更改，所有响应效果都会正常工作:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-01-16T18:34:02.510

我在 CSS 中为 youtube 视频框制作了这个，但请注意，它可能会剪切一些垂直图像。

```
@media (max-width: 480px) {
#colorbox {
max-height:218px !important;
}
#cboxWrapper *, #cboxWrapper {
height:auto !important;
}
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-05-14T21:51:11.743

这是对我有用的解决方案，我取出了最初由 Shabith 发布的计时器内容。

```
 /**
     * Auto Re-Size function
     */
    function resizeColorBox()
    {
        if (jQuery('#cboxOverlay').is(':visible')) {
            jQuery.colorbox.resize({width:'100%', height:'100%'});
        }
    }

    // Resize Colorbox when resizing window or changing mobile device orientation
    jQuery(window).resize(resizeColorBox);
    window.addEventListener("orientationchange", resizeColorBox, false); 
```

致谢：[shabith](https://github.com/jackmoore/colorbox/issues/158)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-09-15T14:47:48.603

这是我在这个问题上使用过的最佳解决方案，即使您使用 CDN 来集成彩盒

在您添加脚本以集成您的颜色框的标题中，只需在脚本开始之前添加它

```
// Make ColorBox responsive
    jQuery.colorbox.settings.maxWidth  = '95%';
    jQuery.colorbox.settings.maxHeight = '95%';

    // ColorBox resize function
    var resizeTimer;
    function resizeColorBox()
    {
        if (resizeTimer) clearTimeout(resizeTimer);
        resizeTimer = setTimeout(function() {
                if (jQuery('#cboxOverlay').is(':visible')) {
                        jQuery.colorbox.load(true);
                }
        }, 300);
    }

    // Resize ColorBox when resizing window or changing mobile device orientation
    jQuery(window).resize(resizeColorBox);
    window.addEventListener("orientationchange", resizeColorBox, false); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-12T15:31:15.947

我在[Drupal 网站](http://drupal.org/node/1366542#comment-6644730)上找到的一个解决方案使用了 Colorbox 的 OFF 功能：

```
if (window.matchMedia) {
    // Establishing media check
    width700Check = window.matchMedia("(max-width: 700px)");
    if (width700Check.matches){
        $.colorbox.remove();
    }
} 
```

您需要在某个窗口大小上重新启动颜色框。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-04-18T08:22:35.177

当网站没有响应并且您希望颜色框在移动设备上可见时，我的解决方案会有所帮助。我个人用它来存储 reCaptcha 表单，所以它是强制性的。

```
 if( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
        $.colorbox({reposition: true, top: 0, left: 0, transition: 'none', speed:'50', inline:true, href:"#contactus"}).fadeIn(100);
    } else {
        $.colorbox({width:"400px", height:"260px", transition: 'none', speed:'50', inline:true, href:"#contactus"}).fadeIn(100);
    } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-01-06T05:17:47.477

彩盒所有者的回答。

```
window.addEventListener("orientationchange", function() {
if($('#cboxOverlay').is(':visible'){
    $.colorbox.load(true);
}
}, false); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-11-02T10:57:28.277

我想在这里添加一个答案。我需要通过尊重不同的断点宽度并根据窗口宽度更改弹出框的宽度来使颜色框响应。基本上，当颜色框显示在浏览器中时，我可以在颜色框的左侧和右侧留出空白空间，但在手机/平板电脑中显示时则不行。

我已经使用了这篇文章（[https://stackoverflow.com/a/23431190/260665](https://stackoverflow.com/a/23431190/260665)）中答案的概念，但做了一些修改：

```
/**
 * Raj: Used basic source from here: https://stackoverflow.com/a/23431190/260665
 **/

// Make sure the options are sorted in descending order of their breakpoint widths
var cboxDefaultOptions = 
        [   
            {
                breakpointMinWidth: 1024,
                values: {
                    width : '70%',
                    maxWidth : '700px',
                }
            },
            {
                breakpointMinWidth: 640,
                values: {
                    width : '80%',
                    maxWidth : '500px',
                }
            },
            {
                breakpointMinWidth: 320,
                values: {
                    width : '95%',
                    maxWidth : '300px',
                }
            }
        ];

$(window).resize(function(){
//  alert (JSON.stringify($.colorbox.responsiveOptions));
//  var respOpts = $.colorbox.attr('responsiveOptions');
    var respOpts = $.colorbox.responsiveOptions;
    if (respOpts) {
        var breakpointOptions = breakpointColorboxOptionsForWidth (window.innerWidth);
        if (breakpointOptions) {
            $.colorbox.resize({
                width: window.innerWidth > parseInt(breakpointOptions.values.maxWidth) ? breakpointOptions.values.maxWidth : breakpointOptions.values.width,
              });
        }
    }
});

function breakpointColorboxOptionsForWidth (inWidth) {
    var breakpointOptions = null;
    for (var i=0; i<cboxDefaultOptions.length; i++) {
        var anOption = cboxDefaultOptions[i];
        if (inWidth >= anOption.breakpointMinWidth) {
            breakpointOptions = anOption;
            break;
        }
    }
    return breakpointOptions;
} 
```

用法：

```
 $.colorbox.responsiveOptions = cboxDefaultOptions; 
```

当 colorbox 对象准备好时，只需将这个附加属性添加到它。我们还可以配置 cboxDefaultOptions 或提供不同的自定义值对象，`$.colorbox.responsiveOptions`以便在需要时加载不同的断点。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-03-16T16:57:13.420

在colorbox js lock之前，插入以下代码：

```
jQuery.colorbox.settings.maxWidth  = '95%';
jQuery.colorbox.settings.maxHeight = '95%';

var resizeTimer;
function resizeColorBox()
  {
      if (resizeTimer) clearTimeout(resizeTimer);
      resizeTimer = setTimeout(function() {
              if (jQuery('#cboxOverlay').is(':visible')) {
                      jQuery.colorbox.load(true);
              }
      }, 300);
  }
jQuery(window).resize(resizeColorBox);
window.addEventListener("orientationchange", resizeColorBox, false); 
```

将左侧、右侧、底部和顶部的值保留为“false”，它将自动进行计算。它对我有用，所以我要过去了！

# perforce - 在 perforce 中恢复文件时，恢复了哪个版本？

> ID：12182678
> 
> 赞同：1
> 
> 时间：2012-08-29T16:42:23.700
> 
> 标签：perforce

假设我在 Perforce 中打开一个文件进行编辑。其他人提交对该文件的更改。我恢复对文件的更改。我现在是否拥有执行签出时最新的文件版本，还是获得其他人签入的最新版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:17:06.427

好吧，由于没有人回答，我不得不自己查找。请参阅： [http](http://www.perforce.com/perforce/doc.091/manuals/cmdref/revert.html) ://www.perforce.com/perforce/doc.091/manuals/cmdref/revert.html “使用 p4 revert 放弃对打开所做的更改文件，将它们恢复为上次从软件仓库同步的 p4 版本。” 所以我的回答是，当我打开它进行编辑时，该文件将恢复为最新版本。

# php - preg 匹配字符串中的所有 href 和 src

> ID：12182681
> 
> 赞同：0
> 
> 时间：2012-08-29T16:42:34.670
> 
> 标签：php, regex

我正在尝试在这样的字符串中提取所有 href 和 src：

```
$content = "
At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium
voluptatum deleniti Image: <img src = 'http://example.com/check-3.png' /> Link: <a href ='http://example.com/test.xls'>test.xls</a>"; 
```

基本上我想做的是将example.com更改为不同的域名（例如test.com），然后从hrefs和srcs中提取所有文件名。我能够使用简单的 str_replace 进行域名替换，但现在我被困在尝试提取 href 和 srcs 的过程中。

这是我尝试使用的内容：

```
$regex = "/src=[\"' ]?([^\"' >]+)[\"' ]?[^>]*>.*?href=[\"' ]?([^\"' >]+)[\"' ]?[^>]*>/i"; 
```

如果 src （或 href ）和 = （例如 ）之间没有空格，这似乎有效，但如果有空格（例如 ），则它不起作用。我尝试添加空格字符，但预匹配失败。我不想使用像简单 HTML dom 这样的繁重库，此外我认为它不会因为它不是正确的 HTML 文档而工作。这是一个来自ckeditor的字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:47:16.590

为什么不在空间上添加量词？

```
$regex = "/src *= *[\"' ]?([^\"' >]+)[\"' ]?[^>]*>.*?href=[\"' ]?([^\"' >]+)[\"' ]?[^>]*>/i";
               ^  ^ 
```

# view - couchdb 替换字符串在临时视图中有效，但在永久视图中无效

> ID：12182687
> 
> 赞同：1
> 
> 时间：2012-08-29T16:42:55.923
> 
> 标签：view, mapreduce, couchdb

我正在编写一个 coucdhdb 视图，其中我省略了字符串中的单位（“秒”或“秒”）并将其转换为数字，然后再发出值。我无法控制数据的存储方式。

我的观点是这样的：

```
"map" : "function(doc)
  {
    if (doc['Elapsed Time']){
      var x = +doc['Elapsed Time'].replace(/ sec.*/, "");
      emit([doc.User, doc.Date], x);
    } 
```

它在临时视图中正常工作，但尝试使用 curl 放置它时出现以下错误：{“error”：“bad_request”，“reason”：“invalid UTF-8 JSON”}

如果我尝试将视图直接保存在 Futon 的永久视图中，它会告诉我：JSON.parse: expected ',' or '}' after property value in object, but all the {} match, and I've dinked with几乎在任何地方都放置“，”，但没有任何效果。

在临时视图中测试时是否有特殊字符或我必须在永久视图中避免的其他内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:41:25.580

而不是为此编写正则表达式，只需使用[`parseInt()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt?redirectlocale=en-US&redirectslug=Core_JavaScript_1.5_Reference/Global_Functions/parseInt)完全符合您要求的函数。

你就这样做吧。

```
"map": "function(doc) {
    if (doc['Elapsed Time']) {
      emit([doc.User, doc.Date], parseInt(doc['Elapsed Time'], 10));
    }
}" 
```

*注意：我写`parseInt(doc['Elapsed Time'], 10)`了**10**是您应该始终定义的基数。*

# objective-c - NSPanel 在全屏模式下到辅助屏幕

> ID：12182690
> 
> 赞同：0
> 
> 时间：2012-08-29T16:43:03.697
> 
> 标签：objective-c, macos, nswindow

当主窗口进入全屏模式时，我试图让 NSPanel 填充第二个监视器。

我将面板上的“全屏”设置为“辅助窗口”，它会留在屏幕上，我可以手动将它拖到另一台显示器上，这很好。但是，如果我尝试以编程方式执行此操作，它会移动到另一个空间（尽管它在正确的屏幕上最大化）。

```
-(void)windowDidEnterFullScreen:(NSNotification *)notification
{
    NSLog(@"Now in full screen");
    NSArray *screens = [NSScreen screens];

    for (NSScreen *screen in screens) {
        if ([self.window.screen isEqualTo:screen]) {
            NSLog(@"Main Window assigned to screen:%@",screen);
        } else {
            NSLog(@"Assigning auxPanel to screen:%@",screen);
            NSRect screenRect = screen.frame;
            [self.auxPanel setFrame:screenRect display:YES];
        }
    }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:56:30.433

I'm not sure why the Title Bar needs to be enabled, but I just added:

```
[self.auxPanel setStyleMask:NSBorderlessWindowMask]; 
```

and it seems to work well enough.

# java - 在具有提升权限的自己的目录中启动 .exe

> ID：12182691
> 
> 赞同：5
> 
> 时间：2012-08-29T16:43:03.833
> 
> 标签：java, exe, elevated-privileges

我的问题很简单，**我想在自己的目录中启动一个 .exe，但具有提升权限/特权。** 我知道这个问题之前已经提出过，但我没有找到解决问题的正确方法。

* * *

确实，我首先尝试了这个：

```
String workingDir = "C:\\TEST\\";
String cmd = workingDir + "game.exe";
Runtime.getRuntime().exec(cmd,null,new File(workingDir)); 
```

我收到以下错误：

```
CreateProcess error=740, The requested operation requires elevation 
```

* * *

然后我尝试了这个：

```
ProcessBuilder builder = new ProcessBuilder(
    new String[] {"cmd.exe", "/C","C:\\TEST\\game.exe"});
Process newProcess = builder.start(); 
```

* * *

它运行但不在自己的目录中。请问我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:45:46.690

看来您要设置

```
builder.directory(new File("C:\\TEST")); 
```

哪一个

> 设置此流程构建器的工作目录

* * *

否则，您似乎需要以管理员身份运行。

[https://www.google.co.uk/search?q=CreateProcess+error%3D740%2C+The+requested+operation+requires+elevation](https://www.google.co.uk/search?q=CreateProcess+error%3D740%2C+The+requested+operation+requires+elevation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:48:53.547

我认为不可能提升分叉进程的权限。您应该使用具有所需权限的帐户启动新流程

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T16:49:22.943

我想知道这是否可行：

```
String workingDir = "C:\\TEST\\";
ProcessBuilder builder = new ProcessBuilder(
    new String[] {"cmd.exe", "/C",workingDir+"game.exe"}
  );
builder.directory(new File(workingDir));
Process newProcess = builder.start(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T16:50:53.890

也许用 cd 和要运行的命令制作一个批处理文件，然后用 cmd 执行批处理文件。

# google-app-engine - 无法下载 google eclipse 插件。dl.google.com 有问题？

> ID：12182698
> 
> 赞同：1
> 
> 时间：2012-08-29T16:43:21.987
> 
> 标签：google-app-engine

道歉......，但我真的不确定在哪里提出这个问题......

我一直在尝试从以下位置安装 eclipse (4.2) 的 google 插件：

[https://dl.google.com/eclipse/plugin/4.2](https://dl.google.com/eclipse/plugin/4.2)

但看起来回购有问题。

Eclipse 在尝试安装时报告以下内容：

“未找到软件站点： [https](https://dl.google.com/eclipse/plugin/4.2) ://dl.google.com/eclipse/plugin/4.2 ”

我似乎对该站点具有路由能力...，可以连接...，但没有乐趣。

我的其他已安装插件的 Eclipse 实例在尝试访问存储库时也无法通过“更新”检查...，尽管对所有其他存储库的访问都成功。

这可能开始发生在当天上午晚些时候或下午早些时候。回购似乎在短时间内变得可以访问，但随后又消失了。

为了清楚起见......，是的，我是在 GAE 开发的背景下这样做的。

谢谢！ - 约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T08:38:48.963

从本地更新存档安装 Google Plugin for Eclipse

离线插件

[https://developers.google.com/eclipse/docs/install-from-zip](https://developers.google.com/eclipse/docs/install-from-zip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:48:41.473

不要使用`https`我今天早上安装的说明中给出的使用，它工作[正常](https://developers.google.com/eclipse/docs/install-eclipse-4.2)`http`。尝试这个：

```
http://dl.google.com/eclipse/plugin/4.2 
```

甚至`https`刚刚为我工作过。可能是互联网连接的问题。如果您正在使用代理，请检查其是否为 Eclipse 正确配置。

# c++ - 生成平方根的连分数

> ID：12182701
> 
> 赞同：12
> 
> 时间：2012-08-29T16:43:32.063
> 
> 标签：c++, math, square-root

我编写了这段代码来生成平方根 N 的连分数。
但是当 N = 139 时它会失败。
输出应该是`{11,1,3,1,3,7,1,1,2,11,2,1,1,7,3,1,3,1,22}`
虽然我的代码给了我一个 394 个术语的序列......其中前几个术语是正确的，但是当它达到 22 它给 12！

有人可以帮我吗？

```
vector <int> f;
int B;double A;
A = sqrt(N*1.0);
B = floor(A);
f.push_back(B);                 
while (B != 2 * f[0])) {
    A = 1.0 / (A - B);
    B =floor(A);                            
    f.push_back(B);     
}
f.push_back(B); 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-30T01:09:02.607

根本问题是您不能将非平方的平方根精确地表示为浮点数。

如果`ξ`是精确值和`x`近似值（这应该还是相当不错的，所以特别是`floor(ξ) = a = floor(x)`仍然成立），那么连分数算法的下一步之后的差异是

```
ξ' - x' = 1/(ξ - a) - 1/(x - a) = (x - ξ) / ((ξ - a)*(x - a)) ≈ (x - ξ) / (ξ - a)^2 
```

因此我们看到，在每一步中，近似值和实际值之间的差值的绝对值都会增加，因为`0 < ξ - a < 1`. 每次出现较大的偏商（`ξ - a`接近于 0）时，差值就会增加一个很大的倍数。一旦差值（绝对值）为 1 或更大，则保证下一个计算的部分商是错误的，但很可能第一个错误的部分商出现得更早。

[查尔斯](https://stackoverflow.com/users/341362/charles) [提到](https://stackoverflow.com/questions/12182701/generating-continued-fractions-for-square-roots-c#comment16312921_12183979)了一个近似值，即使用具有`n`正确数字的原始近似值，您可以计算出`n`连分数的部分商。这是一个很好的经验法则，但是正如我们所看到的，任何大的部分商都会花费更多的精度，从而减少可获得的部分商的数量，并且有时你会更早地得到错误的部分商。

的情况`√139`是一个相对较长的周期和几个大的部分商，所以在周期完成之前出现第一个错误计算的部分商也就不足为奇了（我很惊讶它没有更早发生）。

使用浮点运算，没有办法阻止这种情况。

但是对于二次曲线的情况，我们可以通过仅使用整数算术来避免这个问题。假设您要计算的连分数展开式

```
ξ = (√D + P) / Q 
```

其中`Q`除`D - P²`且`D > 1`不是完全平方（如果不满足可除性条件，您可以`D`用`D*Q²`、`P`with`P*Q`和`Q`with替换`Q²`；您的情况是`P = 0, Q = 1`，它很容易满足）。将完整的商写为

```
ξ_k = (√D + P_k) / Q_k (with ξ_0 = ξ, P_0 = P, Q_0 = Q) 
```

并表示部分商`a_k`。然后

```
ξ_k - a_k = (√D - (a_k*Q_k - P_k)) / Q_k 
```

并且，与`P_{k+1} = a_k*Q_k - P_k`，

```
ξ_{k+1} = 1/(ξ_k - a_k) = Q_k / (√D - P_{k+1}) = (√D + P_{k+1}) / [(D - P_{k+1}^2) / Q_k], 
```

所以`Q_{k+1} = (D - P_{k+1}^2) / Q_k`- 因为`P_{k+1}^2 - P_k^2`是 的倍数`Q_k`，归纳起来`Q_{k+1}`是一个整数并`Q_{k+1}`除以`D - P_{k+1}^2`。

实数的连分数展开式`ξ`是周期性的当且仅当`ξ`是二次 surd，并且当在上述算法中第一对`(P_k, Q_k)`重复时，周期完成。纯平方根的情况特别简单，周期在第一次`Q_k = 1`为 a时完成`k > 0`，并且`P_k, Q_k`始终为非负数。

，`R = floor(√D)`部分商可以计算为

```
a_k = floor((R + P_k) / Q_k) 
```

所以上述算法的代码变成了

```
std::vector<unsigned long> sqrtCF(unsigned long D) {
    // sqrt(D) may be slightly off for large D.
    // If large D are expected, a correction for R is needed.
    unsigned long R = floor(sqrt(D));
    std::vector<unsigned long> f;
    f.push_back(R);
    if (R*R == D) {
        // Oops, a square
        return f;
    }
    unsigned long a = R, P = 0, Q = 1;
    do {
        P = a*Q - P;
        Q = (D - P*P)/Q;
        a = (R + P)/Q;
        f.push_back(a);
    }while(Q != 1);
    return f;
} 
```

它很容易计算`√7981`周期长度为 182 的 (eg) 的连分数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T18:09:32.777

罪魁祸首不是`floor`。罪魁祸首是计算`A= 1.0 / (A - B);`深入挖掘，罪魁祸首是你的计算机用来表示实数的 IEEE 浮点机制。减法和加法失去精度。当你的算法反复做减法时，反复减法会失去精度。

当您计算出连分数项 {11,1,3,1,3,7,1,1,2,11,2} 时，您的 A 的 IEEE 浮点值仅适用于六位而不是十五或十六一个人会期望。当您到达 {11,1,3,1,3,7,1,1,2,11,2,1,1,7,3,1,3,1} 时，您的 A 值是纯垃圾. 它已经失去了所有的精确度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-29T15:14:27.393

数学中的 sqrt 函数并不精确。您可以使用任意高精度的 sympy 代替。这是一个非常简单的代码，可以计算 sympy 中包含的任何平方根或数字的连分数：

```
from __future__ import division #only needed when working in Python 2.x
import sympy as sp

p=sp.N(sp.sqrt(139), 5000)

n=2000
x=range(n+1)
a=range(n)
x[0]=p

for i in xrange(n):
    a[i] = int(x[i])
    x[i+1]=1/(x[i]-a[i])
    print a[i], 
```

我已将您的数字的精度设置为 5000，然后在此示例代码中计算了 2000 个连分数系数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-26T22:24:54.103

如果有人试图用一种没有整数的语言来解决这个问题，这里是来自接受的答案的代码，适用于`JavaScript`.

注意`~~`添加了两个（楼层操作员）。

```
export const squareRootContinuedFraction = D =>{
    let R = ~~Math.sqrt(D);
    let f = [];
    f.push(R);
    if (R*R === D) {
        return f;
    }
    let a = R, P = 0, Q = 1;
    do {
        P = a*Q - P;
        Q = ~~((D - P *P)/Q);
        a = ~~((R + P)/Q);
        f.push(a);
    } while (Q != 1);
    return f;
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T16:51:06.780

我在电子表格中使用了你的算法，我也得到了 12，我认为你的算法一定犯了错误，我尝试了 253 个值，但 B 没有达到它的最终值。

你能试着解释一下算法应该做什么以及它是如何工作的吗？

我想我得到了你的算法，而你在你的问题中犯了一个错误，应该是 12。为了将来参考，算法可以在这个页面[http://en.wikipedia.org/wiki/Continued_fraction](http://en.wikipedia.org/wiki/Continued_fraction)找到，它很容易如果反数值非常接近您要四舍五入的整数，则会出现十进制/数值计算问题。

在 Excel 下做原型时，我无法重现 3.245 的 wiki 页面示例，因为在某些时候 Floor() 将数字设为 3 而不是 4，因此需要进行一些边界检查以检查准确性......

在这种情况下，您可能想要添加最大迭代次数，检查退出条件的容差（退出条件应该是 A 等于 B btw）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-03-01T10:12:45.123

您的代码没有计算`n`. 它尝试计算已计算的连分数`√n`。我的意思是没关系，但是，如果它是正确的，你的方法更适合一般十进制到理性的转换。然而，对于常规（简单）连分数（所有分子都是 1）的 sqrt 函数，算法略有不同。

然而问题还没有结束。是的，作为一项规则，CF 系数`√n`是重复回文的形式，它以第一个非零系数的双倍结尾。比如`√31 =[5;1,1,3,5,3,1,1,10,1,1,3,5,3,1,1,10..]`。现在没有简单的方法来查询每个给定的回文长度`n`。有一些已知的模式，但它们远未定义所有的通用模式`n`。所以在第一个回文结束时停止迭代是一种非常不确定的方法。想象

```
 __
√226 =[15;30] 
```

尽管

```
 ____________________________________________________
√244 =[15;1,1,1,1,1,2,1,5,1,1,9,1,6,1,9,1,1,5,1,2,1,1,1,1,1,30] 
```

如果您决定在`2*f[0]`大多数情况下停止迭代，您会得到一个像 in 这样的错误近似值，或者像 in case`√226`这样一个过度计算的近似值。`√244`此外，一旦`n`成长，追逐回文的尽头变得更加没有意义，因为你永远不需要这样的精确度。

```
 ___________________________________________________________________________________________________________________________________________________________________________
√7114 = [84;2,1,9,3,1,10,2,23,1,1,1,1,1,2,1,27,2,1,1,3,1,2,1,1,1,16,4,3,1,3,2,1,6,18,1,1,2,6,11,11,6,2,1,1,18,6,1,2,3,1,3,4,16,1,1,1,2,1,3,1,1,2,27,1,2,1,1,1,1,1,23,2,10,1,3,9,1,2,168] 
```

在这种情况下，一旦获得必要的精度就停止迭代是合理的。正如我在开头提到的，有两种方法。

1.  一般的 Decimal to Rational 算法从任何十进制数中获得简单的连分数。这将使 CF 精确解析为该小数，而不会出现任何浮点错误。有关此算法的详细说明，您可以查看[我以前的答案](https://stackoverflow.com/a/71164857/4543207)。
2.  碰巧有一个更直接的算法，`√n`它与 1 基本相同，但针对平方根进行了调整。在这种情况下，您不提供`√n`but `n`。

思路如下。我们必须为在分子处包含平方根值的输入定义一个通用形式。然后我们尝试在连分数部分达到相同的表达式以便能够迭代。

让我们的输入是形式

```
q + √n
______
   p 
```

对于简单的平方根运算，我们可以假设`q`is`0`和`p`is `1`。如果我们可以在下一阶段建立这种形式，那么我们可以轻松地进行迭代。

从初始阶段开始，其中,`q = 0`是的整数部分和是浮点部分，我们的目标是带入形式；`p = 1``m``√n``1/x``x``(q + √n) / p`

```
 1            1             1       (√n + m)        √n + m
√n = m + ___ ⇒ x = _______ ⇒ x = ________ . ________ ⇒ x = ________
          x         √n - m        (√n - m)   (√n + m)        n - m^2 
```

现在`√n`在分子处，我们有以下形式；

```
 √n + q
x = ______
       p 
```

哪里`q = m`和`p = n - m^2`。就在这一点上，您可以计算`x`，然后`m'`按地板计算`x`。它成为了;

```
 √n + q         1                p          p(√n - (q - pm'))   p(√n + (pm' - q))
x = ______ = m' + ___ ⇒ x' = ______________ = _________________ = _________________
       p           x'         √n + (q - pm')    n - (q - pm')^2     n - (q - pm')^2 
```

此时`n - (q - pm')^2`分母的 at 可以被分子的 at 整除`p`。现在这是稳定的，我们可以根据需要扩展它。让我们为`q`and分配新的任务`p`；

```
q' = pm'-q;
p' = (n - q'^2)/p;

     √n + q'
x' = ______
        p' 
```

请注意，当`p'`变为 1 ( `n - q'^2 = p`) 时，我们处于回文的末尾。然而，为了决定在哪里停止，我使用了与我的 toRational 算法中描述的机制相同的机制，正如上面备选方案 1 中链接的那样。一旦达到 JS 浮点分辨率，它基本上就会停止。JavaScript 代码如下；

```
function rationalSqrt(n){
  var nr = Math.sqrt(n),
      m  = Math.floor(nr),
      p  = n-m**2,
      q  = m,
      cs = [m],
      n0 = 1,
      d0 = 0,
      n1 = m,
      d1 = 1,
      n2 = 0,
      d2 = 1;
  if (nr === m) return {n:m,d:1,cs};
  while (Math.abs(nr-n2/d2) > Number.EPSILON){
    m = Math.floor((nr+q)/p);
    q = m*p-q;
    p = (n-q**2)/p;
    cs.push(m);
    n2 = m*n1+n0;
    d2 = m*d1+d0;
    n0 = n1;
    d0 = d1;
    n1 = n2;
    d1 = d2;
  }
  return {n:n2,d:d2,cs};
} 
```

这两种算法略有不同。

1.  约 60% 的时间它们产生相同的分数。
2.  大约 27% 的时间`toRational`在 JS 浮点分辨率内给出更小的分子和分母。
3.  大约 13% 的时间`rationalSqrt`（这一次）在 JS 浮点分辨率内给出更小的分子和分母。
4.  `rationalSqrt`将产生精确的系数，正如人们期望的平方根一样，但一旦分辨率足够，就会被截断。
5.  `toRational`给出了预期的 couse 系数，但最后一个可能与您对平方根系列的期望完全无关。

一个这样的例子是；

```
rationalSqrt(511); //returns
{ n : 882184734
, d : 39025555
, cs: [22,1,1,1,1,6,1,14,4,1,21,1,4,14,1,6,1]
} 
```

尽管

```
toRational(Math.sqrt(511));
{ n : 1215746799
, d : 53781472
, cs: [22,1,1,1,1,6,1,14,4,1,21,1,4,14,1,10]
} 
```

**进一步的想法：**考虑给我们RCF系数。我们可以反转`rationalSqrt`算法来获得它的`(q + √n) / p`形式吗？这可能是一项有趣的任务。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-07-05T09:43:19.560

我使用 Surd Storage 类型来获得 n 的平方根的无限精度。

(b * \sqrt(n) + d)/c

=

(b * c * sqrt(n) - c * d + a_i * c^2) / (b^2 * n - d^2 - (a_i * c)^2 + 2* a_i * c * d)

sqrt(n) 的底值只使用一次。之后剩余的迭代存储为 surd 类型。这避免了其他算法中出现的舍入误差，并且可以实现无限（内存受限）分辨率。

a_0 = sqrt (n) 的底值

a_i = (b_i * a_0 + d_i) / c_i

b_i+1 = b_i * c

c_i+1 = (b_i)^2 * n - (d_i)^2 - (a_i * c_i)^2 + 2 * a_i * c_i * d_i

d_i+1 = a_i * (c_i)^2 - c_i * d_i

g = gcd(b_i+1 , c_i+1 , d_i+1)

b_i+1 = b_i+1 / g

c_i+1 = c_i+1 / g

d_i+1 = d_i+1 / g

a_i+1 = (b_i+1 * x + d_i+1) / c_i+1

然后对于 i=0 到 i=Maximum_terms 产生一个以 [a_0;a_1,a_2 ... ,2*a_0] 开头的连分数

当 a_i 项等于 a_0 的 2 倍时，我终止分数。这是序列重复的点。

数学是由 Electro World 完成的，关于数学的非常好的视频可以在这里找到 [https://youtu.be/GFJsU9QsytM](https://youtu.be/GFJsU9QsytM)

下面提供了用 Java 编写的 BigInteger 源代码。希望你喜欢。

如果找到重复序列，则返回布尔值 true；如果未找到所需精度的重复序列，则返回布尔值。

可以根据Maximum_terms轻松修改精度以适应。

平方根 139 [11;1,3,1,3,7,1,1,2,11,2,1,1,7,3,1,3,1,22] 重复长度 18

15 [3;1,6] 的平方根重复长度 2

2501 [50;100] 的平方根重复长度 1

10807 的平方根 [103;1,22,9,2,2,5,4,1,1,1,6,15,1,5,2,1,3,6,34,2,34, 6,3,1,2,5,1,15,6,1,1,1,4,5,2,2,9,22,1,206] 重复长度 40

一个可能的两倍加速将是查看系列的回文性质。在本例中为 34、2、34。只有一半的序列需要确定。

```
 public static Boolean SquareRootConFrac(BigInteger N) {
BigInteger A,B=BigInteger.ONE,C=B,D=BigInteger.ZERO;
BigInteger A0=N.sqrt(),Bi=B,Ci=C,Di=D,G;
BigInteger TwoA0 = BigInteger.TWO.multiply(A0);
int Frac_Length=0, Maximum_terms=10000; //Precision 10000 terms
String str="";
Boolean Repeat=false, Success=false, Initial_BCD=true;

while(!Repeat) {
    Frac_Length++;                         Success=!(Frac_Length==Maximum_terms);
    A=((B.multiply(A0)).add(D)).divide(C); Repeat=A.equals(TwoA0)||!Success;

    Bi=B.multiply(C);
    Ci=(B.multiply(B).multiply(N)).subtract(D.multiply(D)).subtract(A.multiply(A).multiply(C).multiply(C)).add(BigInteger.TWO.multiply(A).multiply(C).multiply(D));
    Di=(A.multiply(C).multiply(C)).subtract(C.multiply(D));
    G=Bi.gcd(Ci).gcd(Di);
    B=Bi.divide(G);C=Ci.divide(G);D=Di.divide(G);

    if(Initial_BCD) {str="["+A+";";System.out.print(str);Initial_BCD=false;}
    else            {str=""+A;System.out.print(str);if(!Repeat){str=",";System.out.print(str);}}
}
str="]";System.out.println(str);
str="repeat length ";System.out.print(str);
if(Success) {str=""+(Frac_Length-1);System.out.println(str);}
else        {str="not found";System.out.println(str);}
return Success;
} 
```

# sql-server - MSSQL - 在查询中进行多次计数不同的调用运行缓慢

> ID：12182704
> 
> 赞同：1
> 
> 时间：2012-08-29T16:43:36.330
> 
> 标签：sql-server, performance, distinct

我有具有以下架构的表：

## 设备

*   设备编号
*   姓名

## 服务

*   服务标识
*   姓名

## 软件

*   软件编号
*   姓名

## 设备_软件

*   设备编号
*   软件编号
*   发现日期

## 设备_服务

*   设备编号
*   服务标识
*   发现日期

现在，我正在尝试编写一个查询，给出一个设备，以及该设备拥有的不同软件和服务的数量。

如果我运行以下查询，我会在 5 秒内得到结果（设备有 50,000 行，软件和服务都有 200 行，链接表包括每个设备到每个软件和服务的链接。仅用于测试目的）。

```
SELECT
  device.name
  ,COUNT(DISTINCT(device_software.softwareId))
FROM
  device
LEFT OUTER JOIN
  device_software ON device.deviceId = device_software.deviceId
GROUP BY device.name 
```

但是，如果我尝试扩展查询以包括两者的计数，则需要更长的时间（约 30 分钟并且仍在继续）：

```
SELECT
  device.name
  ,COUNT(DISTINCT(device_software.softwareId))
  ,COUNT(DISTINCT(device_service.serviceId))
FROM
  device
LEFT OUTER JOIN
  device_service ON device.deviceId = device_service.deviceId
LEFT OUTER JOIN
  device_software ON device.dDeviceId = device_software.deviceId
GROUP BY device.name 
```

现在，由于这是在存储过程中，我可以单独获取两个计数并将其组合起来，但这似乎是一个 hack。我想知道是否有人知道在单个查询中执行此操作而不会对性能造成巨大影响的更好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:00:52.380

我会尝试以下方法，看看是否有区别：

```
SELECT
device.name
a.cntSft, b.cntSrv
FROM device
LEFT JOIN
 ( SELECT deviceId, COUNT(DISTINCT softwareId) as cntSft FROM device_software 
 GROUP BY deviceId) a (ON a.deviceId = device.deviceId)
LEFT JOIN 
( SELECT deviceId, COUNT(DISTINCT serviceId) as cntSrv FROM device_service 
 GROUP BY deviceId) b (ON b.deviceId = device.deviceId); 
```

您可能也不需要`COUNT DISTINCT`，但只需`COUNT`使用此版本的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:50:13.037

您可以考虑 Device_Software 和 Device_Service 的索引视图：

```
CREATE VIEW dbo.v_Device_Software
WITH SCHEMABINDING
AS
  SELECT DeviceId, SoftwareId, DeviceCount = COUNT_BIG(*)
    FROM dbo.Device_Software
    GROUP BY DeviceId, SoftwareId;
GO
CREATE UNIQUE CLUSTERED INDEX x ON dbo.v_Device_Software(DeviceId, SoftwareId);
GO

CREATE VIEW dbo.v_Device_Service
WITH SCHEMABINDING
AS
  SELECT DeviceId, ServiceId, DeviceCount = COUNT_BIG(*)
    FROM dbo.Device_Service
    GROUP BY DeviceId, ServiceId;
GO
CREATE UNIQUE CLUSTERED INDEX x ON dbo.v_Device_Service(DeviceId, ServiceId);
GO 
```

现在您的查询变为：

```
SELECT
  device.name
  ,COUNT(vsoft.DeviceId)
  ,COUNT(vserv.DeviceId)
FROM
  dbo.device
LEFT OUTER JOIN dbo.v_Device_Service AS vserv
  ON device.deviceId = vserv.DeviceId
LEFT OUTER JOIN dbo.v_Device_Software AS vsoft
  ON device.deviceId = voft.DeviceId
GROUP BY device.name; 
```

但是，有很多限制，您应该确保测试这对您的整个工作负载的影响，而不仅仅是这个查询。

# java - 从输入中查找多数元素

> ID：12182714
> 
> 赞同：2
> 
> 时间：2012-08-29T16:44:19.933
> 
> 标签：java, algorithm

我可以找到仅读取输入而不添加到数组的多数元素吗？我的代码在大输入时不起作用，数字差异很大。

我发现我的错误。有正确的代码：

```
int n = Integer.parseInt(bin.readLine()); // read number of data
int h = 0; //input data
int count = 1; //counter
int lf = 0; // last top counting
int first = 0; // top counter num

for (int x = 0; x < n; x++) {
    lf = h;
    h = Integer.parseInt(bin.readLine());//read input number
    if (x == 0) {
        first = h;
    }
    if (h == first) {
        count++;
    } else {
        count--;
    }
    if (count == 0) {
        first = lf; 
        count = 1;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:26:41.253

大输入不应该引起任何问题，您只是假设这是在（a）大文件上失败时的问题？）。

代码看起来或多或少还可以，但是如果计数器达到零，您必须选择（= 设置`first`为新值）*下一个*元素，而不是前一个元素。

# excel - 加载多个项目 DLL

> ID：12182715
> 
> 赞同：1
> 
> 时间：2012-08-29T16:44:28.397
> 
> 标签：excel, visual-c++, xll

有人可以帮我解决我面临的这个 XLL 负载问题吗？

我有一个 DLL 解决方案，在这个解决方案下我有 prj1 和 prj2。

prj1 有 prj1cppfile，它有几个我写的用户定义函数。

prj2 有 prj2cppfile，它有一些我写的更多用户定义的函数。

现在，我选择解决方案 make prj1 作为我的启动项目。

然后`F5`我开始在调试模式下使用我的代码。

我观察到的是（在打开的 Excel 电子表格中）我只有来自 prj1cppfiles 的函数。

当我选择 prj2 作为我的启动项目时，我看到了我在 prj2cppfiles 中拥有的功能。

现在我想要同时加载 prj1 和 prj2，以便我看到来自 prj1cppfile 和 prj2cppfile 的函数，它们位于两个不同的项目中。

有人可以帮我解决这个问题。我想以这样一种方式设置一个解决方案，无论我选择什么启动项目（prj1 或 prj2），我都应该能够在 excel 中公开所有功能（来自 prj1cppfile 和 prj2cppfile）。

我正在使用 Visual Studio 2008，我正在使用来自 Codeplex 的 Keith Lewis 代码的 XLL 代码。我是编写 XLL 的新手，所以在我尝试学习的过程中，请给我一个详细的答案。

* * *

我观察到的是在解决方案 prj1.dll 的调试文件夹中，并且 prj2.dll 存在。我选择 prj1 作为我的启动项目，然后按 f5 键打开 excel。然后我去调试文件夹并将prj2.dll拖放到打开的excel中。当我这样做时，我可以访问 prj1.dll 和 prj2.dll 中的所有功能。是否不可能拥有一个包含不同 dll 所拥有的所有功能的主 dll ？什么是设置这个主 dll 的方法。

最好的

# android - 程序崩溃，当屏幕方向改变和 AsyncTask 工作时

> ID：12182717
> 
> 赞同：0
> 
> 时间：2012-08-29T16:44:29.560
> 
> 标签：android, android-asynctask, android-orientation, orientation-changes

> **可能重复：**
> [屏幕方向锁定](https://stackoverflow.com/questions/6599770/screen-orientation-lock)

我需要一些帮助。在我的 android 应用程序中，我有一个活动，通过按下一个按钮，它将在与 Web 服务（在 asynctask 中）通信时运行一个进度条。这个活动只有一个布局，我添加了属性 android:configChanges="keyboardHidden|orientation 以便它不会在方向改变时崩溃。

现在我想要一些不同的东西。现在我需要这个活动有 2 种不同的布局，一种用于垂直方向，另一种用于水平方向。我认为消除该属性以启用方向而不崩溃的解决方案是，在单击将调用 WS 的按钮之后，我需要以某种方式禁用更改方向的可能性，然后再次启用方向和一切都会恢复正常，防止任何形式的崩溃。

我怎样才能做到这一点？任何人都可以帮助我吗？

谢谢

# dojo - 如何使道场图表支持镜像

> ID：12182721
> 
> 赞同：0
> 
> 时间：2012-08-29T16:44:47.010
> 
> 标签：dojo, mirroring, dojox.charting

我试图使 dojo 图表支持镜像（rtl 绘图）。在任何 dojo 图表中，x 轴和 y 轴（0,0）从屏幕的左下角开始绘制，并且两者的值都增加到右侧和向上。我想要的是让这些道场图表从屏幕的右下角开始绘制，并且值向右和向上增加。我刚开始学习道场，我不太擅长 javascript，但我的主要问题我不知道在哪里可以找到负责绘制图表的函数（在dojo lib中），这样我就可以理解它并进行必要的修改以达到我的目标。我希望有人能帮我找到它（甚至给我任何帮助的建议我完成了这个任务）....谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T05:36:17.887

轴可以放置在所有四个侧面。例如，如果您想在右侧放置一个垂直轴，只需`leftBottom: false`在将其添加到图表时在其参数中指定。

颠倒绘图顺序有点复杂。首要任务是反转`x`数据的坐标（诀窍是使用完整的数据点规范：）`{x, y, tooltip}`。您可能希望保留轴刻度上的原始值。为此，只需使用自定义标签，无论是静态生成的还是函数。

您可以在官方文档中阅读所有相关信息：[配置轴](http://dojotoolkit.org/reference-guide/1.8/dojox/charting.html#configuring-axis)和[数据管理](http://dojotoolkit.org/reference-guide/1.8/dojox/charting.html#data-management)，其中解释了所有细节并用代码片段说明它们。

# java - 将图像从 android 发送到远程 MySQL 数据库

> ID：12182724
> 
> 赞同：0
> 
> 时间：2012-08-29T16:45:29.117
> 
> 标签：java, php, android, mysql, base64

嗨，我正在做一个课程作业，我需要将数据发送到带有 PHP 后端的远程 MySQL 服务器。目前我在发送和接收图像时遇到了一些问题。

我目前正在做的是将图像编码为 base64 并通过 http post 将其发送到我的服务器。我已经检查了正在发送的数据，一切都很好。但是，我的 PHP 方面并没有正确处理它。

这就是我正在做的...

这是我用于将位图转换为字符串的方法...

```
 ByteArrayOutputStream baos=new  ByteArrayOutputStream();
  image.compress(Bitmap.CompressFormat.JPEG, 90, baos);
    byte [] b=baos.toByteArray();
    String imageString=Base64.encodeToString(b, Base64.DEFAULT); 
```

然后我在 http 帖子中发送这个 imageString，它被下面的 PHP 脚本接收

```
$uploadDIR = '../data/';
if ($_REQUEST['picture']!=null){

    $image = base64_decode($_REQUEST['picture']);
    $file = $uploadDIR . uniqid().'.jpeg';
file_put_contents($file, $image);
    $sql = "
                                            INSERT INTO comments
                                            (image)
                                            VALUES (
                                                    '".$file."'
                                                    )";

}
executeSQLQuery($sql); 
```

在尝试了几次之后，甚至文件都没有存储在该位置。

在此先感谢您的帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-11T08:06:19.783

java中的代码假设图像已经转换为位图：

```
ByteArrayOutputStream stream = new ByteArrayOutputStream();
bmIcone.compress(Bitmap.CompressFormat.PNG, 90, stream);
byte[] byte_arr = stream.toByteArray();
String image_str = Base64.encodeBytes(byte_arr);
namevaluepair.add(new BasicNameValuePair("image", image_str)); 
```

在服务器中：

```
$base= $_REQUEST['image'];
$buffer = base64_decode($base);

$buffer = mysql_real_escape_string($buffer); 
```

# c# - 从结果中删除的第一个 SQL 结果

> ID：12182726
> 
> 赞同：1
> 
> 时间：2012-08-29T16:45:32.273
> 
> 标签：c#, asp.net, sql

调用第一个文档的内容无关紧要，始终使用此代码将其从列表中排除。我可以对数据库运行相同的选择语句并显示正确的结果。我想我只是看了太多代码而没有看到问题。

```
SqlConnection objConn = new SqlConnection(ConfigurationManager.ConnectionStrings["DBName"].ToString());

            objConn.Open();

            string sTSQL =
                        "SELECT [filename]      " +
                        "FROM [DB].[dbo].[secure_files] ";

            SqlCommand objCmd = new SqlCommand(sTSQL, objConn);
            objCmd.CommandType = CommandType.Text;

            SqlDataReader dr = objCmd.ExecuteReader();
            dr.Read();

            html += "<ul>";

            while (dr.Read())
            {
                html += "<li><a href=\"/secure/secureDownload.aspx?query=" + dr[0].ToString() + "\">" + dr[0].ToString() + "</a></li>";
            }
            html += "</ul>";

            objConn.Close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:46:58.637

我想这是因为你打`dr.Read();`了两次电话。只需删除第一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:47:07.490

您正在阅读一次但没有保存您阅读的内容，然后您在循环开始时再次阅读。

删除你的第一`dr.Read()`行。你只想在循环中阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:47:31.490

```
dr.Read();

html += "<ul>";

while (dr.Read()) 
```

您的第一个 dr.Read() 跳过了第一条记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T16:48:09.400

摆脱 while 循环之外的第一个 dr.Read() 。它正在跳过第一条记录。

# mysql - 多次求和列

> ID：12182727
> 
> 赞同：2
> 
> 时间：2012-08-29T16:45:35.123
> 
> 标签：mysql, sql, sum

我有一张桌子，里面有一些产品。他们每个人都有一个价格。当用户看到他的购物篮时，我想显示他选择的所有产品的总金额。

我的问题是：是否可以通过 SQL 来完成，或者我是否可以在 PHP 请求之后完成？

其实我的要求是：

```
SELECT SUM(PRICE) FROM products WHERE ID IN(65,68,68); 
```

我会考虑这两个 68。

谢谢你，弗洛里安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T16:49:50.737

所以理想情况下你不会`IN`在这种情况下使用（事实上，你不能让它以这种方式工作）。您需要的是 JOIN 到 cart_products 表（或类似表）：

```
SELECT SUM(PRICE) 
FROM 
  cart_products
  JOIN products ON products.id = cart_products.product_id
WHERE 
  cart_products.cart_id = ? 
```

然后传入当前会话的cart_id。

请注意，如果您的购物车有 qty 选项，您可以将其用作 SUM 表达式：

```
SUM(products.PRICE * cart_products.qty) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:51:45.160

你可以动态生成你的 SQL，这样你最终会得到类似的东西：

```
SELECT SUM(PRICE)
FROM
(
    SELECT PRICE FROM products WHERE id = 65
    UNION ALL
    SELECT PRICE FROM products WHERE id = 68
    UNION ALL
    SELECT PRICE FROM products WHERE id = 68
) x 
```

但我想知道是否真的有道理。想必你已经在页面上显示了单价，所以你不能从你已经拥有的东西上加起来吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:53:20.057

我想一种方法，就是将你所有的物品放在一个临时表中，然后加入它并获取产品。因此，如果您有 3 次产品，您将插入 3 次，连接将 3 次，因此当您求和时，将获得正确的导入。

这是如果您将每个 Id 作为参数传递`PHP`

我不确定`MySQL`语法，但这应该可以

```
CREATE TEMPORARY TABLE BasketProducts(Id INT UNSIGNED NOT NULL)

Insert into BasketProducts values (--Insert everyId) 
```

然后加入

```
Select sum(P.price) from Products P
inner join BasketProducts  BP on P.Id = BP.Id 
```

# iphone - 在 facebook 和 twitter 上共享文本数据

> ID：12182737
> 
> 赞同：0
> 
> 时间：2012-08-29T16:46:19.903
> 
> 标签：iphone, objective-c, ios, xcode, sharekit

我正在开发一个 iphone 测验应用程序。现在我需要在 facebook 和 twitter 上分享测验结果。我想知道用什么。我尝试过使用**sharekit**但无法使用。请给我分享数据的逐步过程。任何其他选择将不胜感激。请为我提供尽可能多的选择。任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:00:05.563

您可以使用 FBConnect 发布到 Facebook

我在以下答案中发布了代码：

[在 iphone 上登录后在 facebook 上 postToWall](https://stackoverflow.com/questions/7792120/posttowall-on-facebook-after-login-in-iphone/7792257#7792257)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T21:04:25.493

原始的[ShareKit](http://www.getsharekit.com)已过时。你可以试试[ShareKit 2.0](https://github.com/ShareKit/ShareKit/)。确保您仔细遵循[install wiki](https://github.com/ShareKit/ShareKit/wiki/Installing-sharekit)。

# javascript - 根据内容获取和设置包装宽度

> ID：12182739
> 
> 赞同：-4
> 
> 时间：2012-08-29T16:46:22.600
> 
> 标签：javascript, jquery, css

我有以下设置：

```
<div id="wrapper">
    <div class="column1"></div>
    <div class="column3"></div>
    <div class="column2"></div>
</div> 
```

```
#wrapper {
    position:absolute;
} 
```

每个“列”都有不同的宽度和`float: left`. 所以这 3 列加起来就是 900 像素宽；但是如果我放置一个新列，我希望包装器自动获取它。

所以我想使用 JavaScript 根据它包含的列来获取和设置包装器的宽度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:52:42.817

```
$("#wrapper").width(function() {
    var width = 0;
    $(this).children('[class^="column"]').each(function() {
        width += $(this).width();
    });
    return width;
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:55:22.630

不要使用浮点数，但是`display:inline-block`（[演示](http://jsfiddle.net/Bgp4X/)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:53:41.023

```
var w = 0;
$('#wrapper > div').each(function(index) {
  w += $(this).outerWidth();
});
$('#wrapper').width(w); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T17:00:40.613

这是一个小提琴：http: [//jsfiddle.net/BramVanroy/sYMLr/](http://jsfiddle.net/BramVanroy/sYMLr/)

```
var totalWidth = 0;
$("div#wrapper > div").each(function(index) {
    totalWidth += parseInt($(this).outerWidth(true), 10);
});

$("div#wrapper").width(totalWidth);​ 
```

# php - PHP中GET和PUT的基本区别？

> ID：12182740
> 
> 赞同：1
> 
> 时间：2012-08-29T16:46:25.753
> 
> 标签：php, codeigniter

我有这条线

```
$data['name'] = $this->put('name'); 
```

除了 PHP 中的 $_GET 和 $_POST 之外，我还是第一次遇到这种情况。有人还告诉我，就像 GET & POST，还有一个 PUT 和 DELETE。

我只想要这四个之间的基本区别，我已经知道 GET 和 POST 之间的一些基本区别。任何外部链接也会有所帮助。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-29T17:51:11.573

来自维基百科：

> GET - 请求指定资源的表示。使用 GET 的请求应该只检索数据并且应该没有其他效果。（其他一些 HTTP 方法也是如此。）[1] W3C 已经发布了关于这种区别的指导原则，称“Web 应用程序设计应遵循上述原则，但也应遵循相关限制。”[11]请参阅下面的安全方法。
> 
> POST - 将要处理的数据（例如，从 HTML 表单）提交到已识别的资源。数据包含在请求的正文中。这可能导致创建新资源或更新现有资源或两者兼而有之。
> 
> PUT - 上传指定资源的表示。
> 
> DELETE - 删除指定的资源。

然而，这并不能真正让您了解何时使用 PUT 和 DELETE。我发现让我了解他们所做工作的最好方法之一就是修补 CouchDB。如果您不熟悉它，它是您通过 HTTP 访问的非关系型数据库。

在 CouchDB 中，您使用 GET 获取数据，使用 POST 更新数据，使用 PUT 插入数据，使用 DELETE 删除数据。如果您想探索它，在[http://guide.couchdb.org/draft/](http://guide.couchdb.org/draft/)上有一本非常好的书。浏览[http://guide.couchdb.org/draft/tour.html](http://guide.couchdb.org/draft/tour.html)和[http://guide.couchdb.org/draft/api.html](http://guide.couchdb.org/draft/api.html)可能会让您对它的工作原理有一个很好的了解。

# python - python pandas：将带有参数的函数应用于系列

> ID：12182744
> 
> 赞同：209
> 
> 时间：2012-08-29T16:46:39.007
> 
> 标签：python, pandas, apply

我想将一个带参数的函数应用于 python pandas 中的系列：

```
x = my_series.apply(my_function, more_arguments_1)
y = my_series.apply(my_function, more_arguments_2)
... 
```

该[文档](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.apply.html)描述了对 apply 方法的支持，但它不接受任何参数。是否有不同的方法可以接受参数？或者，我是否缺少一个简单的解决方法？

**更新（2017 年 10 月）：** 请注意，由于最初提出此问题，pandas`apply()`已更新为处理位置和关键字参数，上面的文档链接现在反映了这一点，并显示了如何包含任何一种类型的参数。

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2012-08-29T17:36:10.973

较新版本的 pandas*确实*允许您传递额外的参数（请参阅[新文档](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.apply.html#pandas.Series.apply)）。所以现在你可以这样做：

```
my_series.apply(your_function, args=(2,3,4), extra_kw=1) 
```

位置参数添加*在*系列元素之后。

* * *

对于旧版本的熊猫：

文档清楚地解释了这一点。apply 方法接受一个 python 函数，该函数应该有一个参数。如果您想传递更多参数，您应该`functools.partial`按照 Joel Cornett 在他的评论中的建议使用。

一个例子：

```
>>> import functools
>>> import operator
>>> add_3 = functools.partial(operator.add,3)
>>> add_3(2)
5
>>> add_3(7)
10 
```

您还可以使用 传递关键字参数`partial`。

另一种方法是创建一个 lambda：

```
my_series.apply((lambda x: your_func(a,b,c,d,...,x))) 
```

但我认为使用`partial`更好。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2017-04-17T22:15:26.613

**脚步：**

1.  创建数据框
2.  创建一个函数
3.  在 apply 语句中使用函数的命名参数。

**例子**

```
x=pd.DataFrame([1,2,3,4])  

def add(i1, i2):  
    return i1+i2

x.apply(add,i2=9) 
```

此示例的结果是数据框中的每个数字都将添加到数字 9。

```
 0
0  10
1  11
2  12
3  13 
```

**解释：**

“add”函数有两个参数：i1，i2。第一个参数将是数据框中的值，第二个参数是我们传递给“应用”函数的任何值。在这种情况下，我们使用关键字参数“i2”将“9”传递给应用函数。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2014-11-13T21:12:58.800

```
Series.apply(func, convert_dtype=True, args=(), **kwds)

args : tuple

x = my_series.apply(my_function, args = (arg1,)) 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2017-11-04T02:58:09.777

您可以将任意数量的参数传递`apply`给通过未命名参数、作为元组传递给`args`参数或通过参数内部捕获为字典的其他关键字参数来调用的`kwds`函数。

例如，让我们构建一个函数，它对 3 到 6 之间的值返回 True，否则返回 False。

```
s = pd.Series(np.random.randint(0,10, 10))
s

0    5
1    3
2    1
3    1
4    6
5    0
6    3
7    4
8    9
9    6
dtype: int64

s.apply(lambda x: x >= 3 and x <= 6)

0     True
1     True
2    False
3    False
4     True
5    False
6     True
7     True
8    False
9     True
dtype: bool 
```

这个匿名函数不是很灵活。让我们创建一个带有两个参数的普通函数来控制我们想要的系列中的最小值和最大值。

```
def between(x, low, high):
    return x >= low and x =< high 
```

我们可以通过将未命名的参数传递给来复制第一个函数的输出`args`：

```
s.apply(between, args=(3,6)) 
```

或者我们可以使用命名参数

```
s.apply(between, low=3, high=6) 
```

甚至两者的结合

```
s.apply(between, args=(3,), high=6) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-03-02T08:30:23.810

```
#sample dataframe

import pandas as pd

df1=pd.DataFrame({'a':[3,4,7],'b':[4,2,2]})

#my function

def add_some(p,q,r):return p+q+r

df2=df1[["a","b"]].apply(add_some, args=(3,2))

print(df2) 
```

> _ ab
> 
> 0 8 9
> 
> 1 9 7
> 
> 2 12 7

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-11-12T08:07:33.773

大多数内容都包含在其他答案中，想要重复您可能错过的内容，您需要在 args 元组中的参数后**添加逗号，请参见以下示例：**

```
df['some_column'].apply(function_name, args=(arg1 ,) #Here comma is necessary. 
```

# java - postgresql 中的日期

> ID：12182751
> 
> 赞同：0
> 
> 时间：2012-08-29T16:47:15.547
> 
> 标签：java, postgresql, date

如何将 java Date 对象插入 Postgresql DATE 单元格？

当我按照自己的方式做时，这是错误的：

```
Calendar date = Calendar.getInstance(); // wrong
Date date = new Date(); // wrong         

String addRecord = "INSERT INTO " + GlobalFields.PACJENCI_TABLE +
                                "VALUES (" + date + ");";
stat.executeUpdate(addRecord) 
```

我没有更多的想法...

PS：

```
public static void CreatePacjenciTable()
{
    try
    {
        Connection conn = DataBase.Connect();

        try
        {
            Statement stat = conn.createStatement();

            String createTable = "CREATE TABLE " + GlobalFields.PACJENCI_TABLE 
                + "(dataUrodzenia DATE);";

            stat.executeUpdate(createTable);
        }
        finally
        {
            conn.close();
        }
    }
    catch(SQLException e)
    {
        e.printStackTrace();
    } 
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T16:53:27.920

你根本不应该那样做！

永远不要构造带有参数的 SQL 字符串。相反，创建一个[PreparedStatement](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)并在其上设置参数。像这样：

```
 String addRecord = "INSERT INTO " + GlobalFields.PACJENCI_TABLE + "VALUES (?);";
    PreparedStatement stmt = conn.prepareStatement(addRecord);
    stmt.setDate(1, new Date(System.currentTimeMillis()));
    stmt.executeUpdate(); 
```

请注意，`Date`有一个[`java.sql.Date`](http://docs.oracle.com/javase/6/docs/api/java/sql/Date.html)，它是 normal 的子类，`java.util.Date`其中一天中的时间始终是午夜 UTC；它用于表示实际日期，而不是某个时刻。您也可以使用 a [`java.sql.Timestamp`](http://docs.oracle.com/javase/6/docs/api/java/sql/Timestamp.html)，它代表一个时刻。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T16:49:03.623

这就是问题：

```
String addRecord = "INSERT INTO " + GlobalFields.PACJENCI_TABLE +
                   "VALUES (" + date + ");"; 
```

您正在将其`Date`转换为字符串并将其包含在 SQL 中。不要那样做。这里根本不需要使用字符串转换。

相反，使用 a[`PreparedStatement`](http://docs.oracle.com/javase/7/docs/api/java/sql/PreparedStatement.html)并将值作为 a[`java.sql.Date`](http://docs.oracle.com/javase/7/docs/api/java/sql/Date.html)或可能[`java.sql.Timestamp`](http://docs.oracle.com/javase/7/docs/api/java/sql/Timestamp.html)通过参数插入。

您几乎应该*始终*避免将 SQL 中的值作为字符串包含 - 改用参数化 SQL，并在语句中设置值。这使您的 SQL（代码）与参数（数据）分离，避免了数据转换问题的风险，也避免了[SQL 注入攻击](http://bobby-tables.com)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T16:52:25.750

不要通过连接字符串来创建 SQL（这是这里的问题，因为 Postgres 肯定不理解 Java 的日期字符串表示），而是使用[PreparedStatement](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)并将日期作为参数传递。除了其他优点（预编译语句，...）之外，它还允许您传递日期`Date`并让 JDBC 和底层数据库驱动程序为您完成所有必要的数据转换工作。

# ruby - Ruby加密密码存储在配置文件中

> ID：12182756
> 
> 赞同：4
> 
> 时间：2012-08-29T16:47:27.063
> 
> 标签：ruby, rubygems

我正在寻找有关如何加密将存储在配置文件中的密码以使其不是明文的建议？在脚本读入密码后，我还需要一种方法来解密密码吗？脚本是一个简单的 ftp 脚本，配置文件非常简单，包含主机和用户凭据。我正在使用 yaml 作为配置文件。

```
host = 'ftp.someftp.com'
id = 'jdoe'
pw = 'encrypted password' 
```

如果有人能指出我正确的方向，我将不胜感激。必须有一种简单的方法可以做到这一点，或者有一个宝石可以做到这一点。

谢谢MM

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:53:23.963

查看[OpenSSL](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL.html)库。寻找基于密码的加密方法，例如 AES。您还需要一种在配置文件中将加密的二进制数据写入 ASCII 的方法。

警告：如果你可以加密它，任何可以阅读脚本的人也可以看到你是如何做到的，然后他们可以解密它。因此，只要您保护密码不被随意/意外查看，就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T17:31:22.817

对于加密，您还可以使用广泛使用且实用的[bcrypt gem 。](https://github.com/codahale/bcrypt-ruby)确保在系统上安装了 bcrypt，否则 gem 将无法工作。

要了解它是如何工作的，请查看它的自述文件，尤其是[如何在一般](https://github.com/codahale/bcrypt-ruby#how-to-use-bcrypt-ruby-in-general)部分中使用 bcrypt-ruby。

# php - 用 php 计算 JSON 数据

> ID：12182757
> 
> 赞同：1
> 
> 时间：2012-08-29T16:47:30.130
> 
> 标签：php, json

我有[这个](http://infoabout.me/ISS/facelikes.php)json 数据，所以我无法计算出现在这个数组中的人数，因为你可以看到每个元素的格式是`{"id":"1038863770","name":"Carol Rodovalho"}`. 我尝试使用 json decode 函数将格式更改为普通的 php var，然后我使用了“count”，但结果为 1，这不是真的，至少没有计算我需要的内容。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T16:49:56.407

您已经将所有内容都包装在 json 中的大数据对象中，因此请执行以下操作：

```
$data = json_decode($json_data, true);
$data = $data['data'];
echo count($data); 
```

[json_decode](http://php.net/manual/en/function.json-decode.php)的 PHP 手册。

# applescript - AppleScript 在终端中打开新标签不再在 Mountain Lion 中工作？

> ID：12182760
> 
> 赞同：4
> 
> 时间：2012-08-29T16:47:33.630
> 
> 标签：applescript, osx-mountain-lion

我曾经在 Lion 中运行以下代码来打开终端，更新项目，然后打开一个新选项卡，然后再次运行以更新第二个、第三个和第四个。自从山狮升级后，这不再有效。一半时间似乎在我的主目录中打开 Finder，另一半时间似乎打开 OSX 字体/文本对话框。我已经确认 Cmd+T 仍应打开一个新选项卡。知道为什么它坏了吗？

```
tell application "Terminal" to activate

tell application "Terminal"

    do script "cd Projects/blahblah/trunk" in front window
    do script "svn up" in front window

end tell

tell application "System Events" to tell process "Terminal" to keystroke "t" using command down 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T16:53:23.550

事实证明，出于某种原因，我需要告诉终端在每次通话之间激活。狮子从来没有让我这样做。

```
tell application "Terminal" to activate

tell application "Terminal"

    delay 0.25

    do script "cd Projects/firstone/trunk && svn up" in front window
end tell

tell application "Terminal" to activate

tell application "System Events" to tell process "Terminal" to keystroke "t" using command down

tell application "Terminal"

    delay 0.25

    do script "cd Projects/secondone/trunk && svn up" in front window

end tell 
```

# mysql - 设置默认排序规则 phpmyadmin

> ID：12182764
> 
> 赞同：4
> 
> 时间：2012-08-29T16:47:41.920
> 
> 标签：mysql, phpmyadmin

我正在尝试更改 phpmyadmin 中的默认排序规则，以便在创建表时，列的排序规则是 utf8_unicode_ci。我尝试了以下方法，但它不起作用。

```
[mysqld]
collation_server=utf8_unicode_ci
character_set_server=utf8
default-character-set=utf8 
```

这些列仍默认为 latin1_swedish_ci。有任何想法吗？

PHPmyadmin 3.5.2 MySQL 5.1.44

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T03:21:49.653

登录到 phpMyAdmin。从左侧的列表中选择您的数据库。单击顶部选项卡中的“操作”。在排序规则框中，从下拉菜单中选择新排序规则，然后单击执行。

# ios - 为什么 tableview.visibleCells 是空的？

> ID：12182767
> 
> 赞同：1
> 
> 时间：2012-08-29T16:47:56.983
> 
> 标签：ios, uitableview

一个明显可见且全宽的内容表格视图没有可见单元格怎么会发生？为什么 tableview.visibleCells 是空的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:01:10.380

我最好的猜测是说你在 tableview 有机会填充自己之前调用了这个方法。

确保在调用委托方法之后以及在屏幕上显示 tableview 之后调用它。

为了获得更准确的答案，我们需要提供有关您的问题的更多详细信息。

# php - X-Frame-Options SAMEORIGIN 在我的域上阻止 iframe

> ID：12182768
> 
> 赞同：10
> 
> 时间：2012-08-29T16:48:04.780
> 
> 标签：php, javascript, jquery, colorbox, x-frame-options

我正在使用[http://www.jacklmoore.com/colorbox](http://www.jacklmoore.com/colorbox)在灯箱中显示 url 的内容。实施后，彩盒没有显示任何内容。

后来，我注意到 chrome 日志中出现以下错误：

```
Refused to display document because display forbidden by X-Frame-Options. 
```

所以在记录之后，我将以下行添加到网站的根 .htaccess 中：

```
Header always append X-Frame-Options SAMEORIGIN 
```

允许 iframe 嵌入到我自己的域中。

但我仍然得到错误，我是 x-frame 的新手，我正在开发一个现有的应用程序，所以我认为 .htaccess 解决方案会很好，但它可以被一些代码覆盖吗？请注意，它不在服务器配置中。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-30T07:58:54.573

尝试发送另一个 X-Frame-Options 标头，添加

```
<?php header('X-Frame-Options: GOFORIT'); ?> 
```

到您的页面顶部。它应该禁用 SAMEORIGIN 命令。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T10:38:09.240

根据 moz 开发页面。这里是定义

> ***SAMEORIGIN***
> 页面只能显示在与页面本身同源的框架中。

这意味着只有当您包含您网站中的某些页面时才会显示。
假设

1.  [您在http://foo.com](http://foo.com)上有一个网站，并且您希望从[http://foo.com/sec_page](http://foo.com/sec_page)在 iframe 中显示一些内容，它将显示在 iframe 中
2.  但如果您嵌入相同的 iframe ( [http://foo.com/sec_page](http://foo.com/sec_page) ) 以加载到[http://bar.com](http://bar.com)则它不会显示任何内容。因为原产地会改变。

你可以在[这里阅读完整的注释](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-27T16:51:19.457

您可以从收到的响应中删除标头：

**header_remove("X-Frame-Options");**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-27T07:37:21.910

我已将其添加到`httpd.conf`：

```
 Header unset X-Frame-Options 
```

它有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-04T12:43:34.483

将 XFrame 选项设置为 DENY 或 Sameorigin。否则，如果您的网站容易受到 XSS 攻击，它可能有助于制作网络钓鱼攻击或框架注入。

# c++ - 指向字符串的指针大小与字符串大小的差异

> ID：12182772
> 
> 赞同：0
> 
> 时间：2012-08-29T16:48:24.270
> 
> 标签：c++, string, pointers, sizeof

> **可能重复：**
> [关于 C 中的指针和字符串的问题](https://stackoverflow.com/questions/4380090/question-about-pointers-and-strings-in-c)

```
#include<stdio.h>

int main()   
{    
char *str1="abcd";  
char str2[]="abcd";  
printf("%d %d %d\n",sizeof(str1),sizeof(str2),sizeof("abcd"));  
return 0;
} 
```

为什么这段代码给出相同的答案`sizeof(str2)`，`sizeof("abcd")`即使`str2`理想情况下就像指向字符串的指针一样`str1`，所以答案应该是 4 4 5

Ideone 上的代码：http: [//ideone.com/za8aV](http://ideone.com/za8aV)

答案：4 5 5

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T16:50:29.590

字符数组不是`char`指针。尽管数组在传递给函数时确实会衰减为指针，但它们本质上是不同的东西（具体来说，编译器在编译时知道它们的确切长度）。您看到 5 表示四字符字符串的原因是字符串文字`char`为终止零保留了一个。`4`另一方面，是系统相关的：在具有 32 位指针的系统上，您将看到`4`，而在具有 64 位指针的系统上，您将看到`8`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:52:26.100

您从哪里得到`str2`“理想情况下就像指向字符串的指针”的想法？它不是。`str2`是一个数组。当运算符`sizeof`应用于数组时，它以字节为单位返回数组对象的大小。

字符串文字也是一个数组，因此当`sizeof`应用于字符串文字时，它会返回该数组对象的大小（以字节为单位）。因此，期望`sizeof("abcd")`并`sizeof(str2)`产生相同的结果是完全自然的。他们做到了。

**PS** `%d`不是打印结果的适当格式说明符`sizeof`。`%d`需要`int`参数，同时`sizeof`产生一个`size_t`值。用于`%zu`打印`size_t`类型的值。

# c# - 弹性视频编解码器（功率损耗）

> ID：12182773
> 
> 赞同：2
> 
> 时间：2012-08-29T16:48:29.117
> 
> 标签：c#, .net, video, codec

对于我正在构建的系统，我需要一个对断电有弹性的视频编解码器 - 即，如果要切断电源，视频仍然需要可以从闪存盘上剩余的内容播放。

（车载PC项目，拔掉钥匙后电脑会立即关机，如果发生意外断电）。

任何人都可以推荐一个合适的编解码器（和与.net兼容的编码器），理想情况下需要低处理能力（最坏的情况下闪存盘可以以~6mbps的速度写入）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:28:58.140

任何编解码器都可以播放到断电为止。关键是正确的容器。使用传输流。[TS]。它会玩得很好。像 mp4 和 3gp 这样的容器是不对的。

如果您从逻辑上思考，任何流媒体格式都是可播放的。因为可以随时切断流。TS 流是为流媒体设计的，因此可以完美地播放到你失去力量的地步。您内部的视频和音频编解码器无关紧要。选择 H.264 和 aac 以获得良好的压缩功能。

Webm、mjpeg 也是可流式传输的格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:43:28.180

在编解码器级别，您真正需要担心的是 B 帧的存在。

H.264 基线或约束基线配置文件将起作用。这是节省空间的，但处理密集。

MJPEG 也可以工作，虽然非常占用大量空间，但 CPU 很少。

正如 user1559108 正确指出的那样，容器是另一回事。MP4 和变体可能是可修复的，但在这里仍然不是一个很好的选择。

实际上，如果您想确保获得每一帧，您可能只想编写一个原始流，并且（如果您有音频）事后担心复用，因为复用将不可避免地引入一些延迟。

# many-to-many - Ebean 多对多到同一实体

> ID：12182774
> 
> 赞同：0
> 
> 时间：2012-08-29T16:48:39.273
> 
> 标签：many-to-many, playframework-2.0, ebean

我正在尝试映射多对多的关系，其中每个用户都有一组朋友，这些朋友也是用户。在数据库表中，这是使用名为 user_friend 的关联表解决的。user_friend 表有两列 user1 和 user2 是用户表中用户 ID 的外键。

最佳解决方案是不为 user_friend 表创建 java ebean 模型，而是让 user 模型有一组用户，其中当前用户是 user_friend 表中的 user1 或 user2。然后映射必须以某种方式引用 user_friend 表中的两列......

这可能吗？

已编辑：添加了 1.sql 的 SQL

```
CREATE TABLE User (
id bigint(20) NOT NULL AUTO_INCREMENT,
email varchar2(255) NOT NULL UNIQUE,
password varchar2(255) NOT NULL,
name varchar2(255) NOT NULL,
PRIMARY KEY (id)
);

CREATE TABLE User_friend (
id bigint(20) NOT NULL AUTO_INCREMENT,
user1 bigint(20) NOT NULL,
user2 bigint(20) NOT NULL,
sent TIMESTAMP NOT NULL,
accepted TIMESTAMP,
PRIMARY KEY (ID),
FOREIGN KEY(user1) REFERENCES User(id),
FOREIGN KEY(user2) REFERENCES User(id)
); 
```

问题是，希望每个用户实例都有一组用户，他通过 user1 或 user2 链接到这些用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:17:31.730

听起来这正是 Ebean 为您设置的方式：

```
user_friend
   user1      user2
   (user_id)  (user_id) 
```

为什么要更改 ManyToMany 关系？您能否在“conf/evolutions/default”中向我们提供您的 1.sql 文件的相关部分？

更新：

如果您的 Java 代码如下所示：

```
@ManyToMany
public Set<User> friends = new HashSet<User>(); 
```

您应该能够通过引用 user.friends 来获得一组朋友。

问题是您似乎希望在 User_friend 表中包含其他字段（已发送、已接受）。因此，您需要创建一个公开这些字段的新模型 UserFriend。

# python - 有没有更好的方法在字符串列表上使用 strip() ？- Python

> ID：12182777
> 
> 赞同：21
> 
> 时间：2012-08-29T16:48:49.047
> 
> 标签：python, string, list, iterator, strip

现在我一直在尝试在字符串列表上执行 strip() 并且我这样做了：

```
i = 0
for j in alist:
    alist[i] = j.strip()
    i+=1 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-29T16:50:57.547

您可能不应该将其`list`用作变量名，因为它是一种类型。不管：

```
list = map(str.strip, list) 
```

这会将函数`str.strip`应用于 中的每个元素`list`，返回一个新列表，并将结果存储回`list`.

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-08-29T16:52:41.357

你可以使用列表推导

```
stripped_list = [j.strip() for j in initial_list] 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-29T17:25:25.727

这里发生了一些关于性能的有趣讨论，所以让我提供一个基准：

[http://ideone.com/ldId8](http://ideone.com/ldId8)

```
noslice_map              : 0.0814900398254
slice_map                : 0.084676027298
noslice_comprehension    : 0.0927240848541
slice_comprehension      : 0.124806165695
iter_manual              : 0.133514881134
iter_enumerate           : 0.142778873444
iter_range               : 0.160353899002 
```

所以：

1.  `map(str.strip, my_list)`是最快的方式，只是比理解要快一点。
    *   使用`map`或者`itertools.imap`如果你想应用一个函数（比如 str.split）
    *   如果有更复杂的表达式，请使用推导式
2.  手动迭代是最慢的方式；一个合理的解释是它需要解释器做更多的工作，而高效的 C 运行时做的更少
3.  继续分配结果，如`my_list[:] = map...`，切片表示法仅引入少量开销，如果对该列表有多个引用，则可能会为您避免一些错误。
    *   了解改变列表和重新创建列表之间的区别。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T16:51:55.423

我想你的意思是

```
a_list = [s.strip() for s in a_list] 
```

使用生成器表达式可能是更好的方法，如下所示：

```
stripped_list = (s.strip() for s in a_list) 
```

提供惰性求值的好处，因此`strip`仅在需要剥离给定元素时运行。

如果您需要对列表的引用在当前范围之外保持完整，您可能需要使用列表切片语法。：

```
a_list[:] = [s.strip() for s in a_list] 
```

对于对各种方法的速度感兴趣的评论者，看起来在 CPython 中生成器到切片的方法效率最低：

```
>>> from timeit import timeit as t
>>> t("""a[:]=(s.strip() for s in a)""", """a=[" %d " % s for s in range(10)]""")
4.35184121131897
>>> t("""a[:]=[s.strip() for s in a]""", """a=[" %d " % s for s in range(10)]""")
2.9129951000213623
>>> t("""a=[s.strip() for s in a]""", """a=[" %d " % s for s in range(10)]""")
2.47947096824646 
```

# vb.net - 如何根据 VB.NET 中的文件名将文件复制到文件夹？

> ID：12182786
> 
> 赞同：0
> 
> 时间：2012-08-29T16:49:22.790
> 
> 标签：vb.net, visual-studio-2010

例如，我有以下目录：

```
C:\test\folder100
C:\test\folder101
C:\test\folder102 
```

我还有以下文件：

```
C:\test\file100.txt
C:\test\file101.txt
C:\test\file102.txt 
```

当我试图找出一种复制`file100.txt`到 directory `folder100`、`file101.txt`to directory`folder101`等的方法时，我的问题就来了。

我可以轻松编写一个简单的代码来将每个文本文件复制到其相关文件夹，但是由于我有很多目录和文件要应用它，所以必须有一种方法来循环这个任务，我就是不能把我的头绕在这上面。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:00:35.577

这些方面的内容可能会有所帮助：

```
Private Function GetFolderPath(ByVal filePath As String) As String
    Dim fileName As String = Path.GetFileNameWithoutExtension(filePath)
    Dim folderName As String = fileName.Substring("file".Length)
    Return Path.Combine("C:\test", folderName)
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:23:04.983

```
 Dim mydir As New DirectoryInfo("c:\Mydir\")
    For Each myfile As FileInfo In mydir.GetFiles
        Dim newpath As String = myfile.FullName.Substring(0, myfile.Name.Length - myfile.Extension.Length)
        If New DirectoryInfo(newpath).Exists Then
            myfile.CopyTo(newpath)
        Else
            Directory.CreateDirectory(newpath)
            myfile.CopyTo(newpath)
        End If
    Next 
```

# objective-c - 备份/恢复 Coredata (sqlite)

> ID：12182790
> 
> 赞同：0
> 
> 时间：2012-08-29T16:49:25.600
> 
> 标签：objective-c, sqlite, core-data, backup, restore

我有一个标准的 iOS coredata 应用程序（sqlite）。用户要求他们能够备份他们的数据并从备份中恢复。谁能告诉我该怎么做？或者一些详细解释的链接？我不介意使用 iTunes 文件共享，但想知道如何实现这一点。

此外，如果用户在数据库不正确的情况下恢复数据库，则应在替换现有数据库之前将其拒绝。我已经在互联网上搜索了这个，但没有找到任何例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:27:25.903

我推荐 iCloud。iCloud API 旨在与 Core Data sqlite 数据库一起使用。有关更多信息，请阅读[将 Core Data 与 iCloud 发行说明一起使用](https://developer.apple.com/library/ios/ipad/#releasenotes/DataManagement/RN-iCloudCoreData/_index.html#//apple_ref/doc/uid/TP40011298)。

# php - 通过 URL 安全地上传/下载图像

> ID：12182792
> 
> 赞同：3
> 
> 时间：2012-08-29T16:49:39.037
> 
> 标签：php, image, download

所以，我想安全地从 URL 下载图像。当然，我的第一个想法是检查扩展 - 如果它兼容，只需下载它并使用好的扩展保存它（它应该是安全的，因为服务器不会运行存储在`.jpg`文件中的 PHP 代码（好吧，除非它是配置为这样做））。使用这种方法是否还有一些风险，是否有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-26T22:41:54.647

您应该检查它是否是图像，因为可以操纵扩展名。

```
$file = file_get_contents($url);
if(@imagecreatefromstring($file)) { 
  // it's a valid image file; handle it
}
else {
  // it's not an image file; error!
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:13:56.487

```
/* gets the data from a URL */
function get_data($url) {
  $ch = curl_init();
  $timeout = 5;
  curl_setopt($ch, CURLOPT_URL, $url);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
  $data = curl_exec($ch);
  curl_close($ch);
  return $data;
} 
```

要获取文件信息，您可以[在此处](https://stackoverflow.com/questions/2610713/get-mime-type-of-external-file-using-curl-and-php)`curl_getinfo()`使用 更多信息

这应该可以帮助您使用 php 通过 url 下载任何内容。关于上传？您想将文件保存在某处还是什么？

# ruby-on-rails - 黄瓜测试在不应该通过时通过

> ID：12182793
> 
> 赞同：0
> 
> 时间：2012-08-29T16:49:41.570
> 
> 标签：ruby-on-rails, tdd, cucumber

我对黄瓜很陌生。我正在尝试编写测试以确保用户不会创建重复的标签。于是写了一个功能，内容如下：

```
Scenario: Analyst adds a duplicate privacy tag
  Given I have a privacy tag called "Green"
  When I try to create a tag called "Green"
  Then I should be on the new privacy tag page
  And I should see an error message for "Green" 
```

我的步骤是这样定义的：

```
Given /^I have a privacy tag called "(.*?)"$/ do |tag|
    PrivacyTag.create(:content => tag)
end

When /^I try to create a tag called "(.*?)"$/ do |arg1|
    visit new_privacy_tag_path
    fill_in 'privacy_tag[content]', :with => arg1
    click_button 'Create'
end

Then /^I should be on the new privacy tag page$/ do
    new_privacy_tag_path
end

Then /^I should see an error message for "(.*?)"$/ do |arg1|
    page.should have_selector('div', :class => 'alert alert-error') do |flash|
        flash.should have_content fartknocker
    end
end 
```

所以奇怪的是，所有这些测试现在都通过了。当您尝试创建应用程序允许的重复隐私标签并最终进入隐私标签索引页面时，用户不会返回到 new_privacy_tag_path。但测试仍然通过。Cucumber 甚至连眼睛都不眨一下，因为在任何地方都没有定义名为 fartknocker 的变量，而且 fartknocker 这个词也没有出现在页面上的任何地方。测试仍然通过。是什么赋予了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:38:27.980

那是因为`page.should have_selector`不占用块。您可能正在寻找的是`within`方法：

```
page.within('div', :class => 'alert alert-error') do
    page.should have_content fartknocker
end 
```

编辑：由于在您的代码中，该行`flash.should have_content fartknocker`位于永远不会运行的块内，因此 Ruby 从不评估它，因此没有机会抱怨缺少的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:52:21.103

```
Then /^I should be on the new privacy tag page$/ do
  new_privacy_tag_path
end 
```

这没有任何断言。所以它永远是绿色的。

```
Then /^I should see an error message for "(.*?)"$/ do |arg1|
  page.should have_selector('div', :class => 'alert alert-error') do |flash|
    flash.should have_content fartknocker
  end
end 
```

你也必须小心`have_content`它`/matches/`与`"equals"`. Jon M 在他的回答中提到的是您需要解决的问题。

# android - Android openApp 标签

> ID：12182796
> 
> 赞同：0
> 
> 时间：2012-08-29T16:49:48.133
> 
> 标签：android, browser

脚本编写有点新……设备上安装了一个应用程序 my_app。我需要一个脚本命令来打开该应用程序并传递参数。类似于 iPhone 的 openApp 标签。

另外我如何将参数传递给 my_app.

10xs，尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:21:12.940

为了接收参数，您的应用程序必须设置为从启动它的 Intent 中提取参数。所有 android 应用程序都是围绕 Intent 和 Intent 处理构建的，而不是脚本启动和执行。 [如果您需要，请查看意图](http://developer.android.com/reference/android/content/Intent.html)以获取有关它们的更多信息，但基本上在设置您的应用程序时，假设您的脚本正在从您的桌面运行，启动命令将是

```
adb am start org.example.myapp.MyActivity -e arg1 foo; 
```

快速搜索显示了[另一个 SO 答案，它解释了](https://stackoverflow.com/questions/3228245/how-can-i-deliver-parameters-to-a-test-function-that-launched-using-adb-shell-a)am 的所有参数，而[这个答案](https://stackoverflow.com/questions/4233873/how-to-get-extra-data-from-intent-in-android)显示了如何从意图中提取额外内容。

# sql - SQL 查询：仅填充空值

> ID：12182798
> 
> 赞同：1
> 
> 时间：2012-08-29T16:49:50.713
> 
> 标签：sql, sql-server

我正在尝试使用 SQL Server Management Studio 2008 运行以下查询。

```
update Schema.[ClientNew]  
set [Notes] = ([Notes]+ char(10)+(Select [Notes] from Schema.[clientOld]
where  office = 90  and ID = '123456789AM')) where  office = 90  and ID= '123456789' 
```

基本上试图将我的笔记字段中的所有数据从clientOld合并到clientnew中的notes字段。

这只是代码的一部分。

分开时：

```
 Select [Notes] from Schema.[clientOld] where  office = 90  and ID = '123456789AM' 
```

给我备注字段中的数据。

但是当我运行查询时，clientNew 表上只出现 {null} 值。

我的查询错了吗？？或在某处写空值？

请指教，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:00:22.720

如果 `Schema.[ClientNew]`进入`Null`现场`[Notes]`，您的更新将不起作用。

这是因为您无法`Null`使用操作符进行操作`+`

例子：

做这个：

```
select null + 'a' 
```

结果将是`null`。所以，如果你的表 ClientNew 有 NULL 值，这个

```
([Notes]+ char(10)+(Select [Notes] from Schema.[clientOld]
where  office = 90  and ID = '123456789AM')) 
```

将返回 Null

尝试添加一个空字符串

```
(ISNULL([Notes], '') + char(10)+(Select [Notes] from Schema.[clientOld]
where  office = 90  and ID = '123456789AM')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:13:17.173

NULL + 任何东西总是等于 NULL，您需要使用 COALESCE 来防止 NULL：

```
UPDATE    [Schema].ClientNew
SET              Server = COALESCE([Schema].ClientNew, '') + COALESCE([Schema].clientOld, '')
FROM         [Schema].ClientNew INNER JOIN
                      [Schema].clientOld ON [Schema].clientOld.office = [Schema].ClientNew.office AND ID = [Schema].ClientNew.ID
WHERE     (office = 90) AND (ID = '123456789AM') 
```

# javascript - 扩展 bootstrap-typeahead 以获取对象而不是字符串

> ID：12182799
> 
> 赞同：21
> 
> 时间：2012-08-29T16:49:53.780
> 
> 标签：javascript, jquery, autocomplete, twitter-bootstrap

我扩展了 bootstrap-typeahead 以获取对象而不是字符串。
它有效，但我想知道这是做这些事情的正确方法。

谢谢。

参考： http:
[//twitter.github.com/bootstrap/javascript.html#typeahead](http://twitter.github.com/bootstrap/javascript.html#typeahead) [http://twitter.github.com/bootstrap/assets/js/bootstrap-typeahead.js](http://twitter.github.com/bootstrap/assets/js/bootstrap-typeahead.js)

```
_.extend($.fn.typeahead.Constructor.prototype, {
    render: function (items) {
        var that = this;

        items = $(items).map(function (i, item) {
            i = $(that.options.item)
                .attr('data-value', item[that.options.display])
                .attr('data-id', item.id);
            i.find('a').html(that.highlighter(item));
            return i[0];
        });

        items.first().addClass('active');
        this.$menu.html(items);
        return this;
    },
    select: function () {
        var val = this.$menu.find('.active').attr('data-value'),
            id = this.$menu.find('.active').attr('data-id');
        this.$element
            .val(this.updater(val, id))
            .change();
        return this.hide()
    }
});

return function (element, options) {
    var getSource = function () {
            return {
                id: 2,
                full_name: 'first_name last_name'
            };
    };

    element.typeahead({
        minLength: 3,
        source: getSource,
        display: 'full_name',
        sorter: function (items) {

            var beginswith = [],
                caseSensitive = [],
                caseInsensitive = [],
                item,
                itemDisplayed;

            while (item = items.shift()) {
                itemDisplayed = item[this.options.display];
                if (!itemDisplayed.toLowerCase().indexOf(this.query.toLowerCase())) {
                    beginswith.push(item);
                } else if (~itemDisplayed.indexOf(this.query)) {
                    caseSensitive.push(item);
                } else {
                    caseInsensitive.push(item);
                }
            }

            return beginswith.concat(caseSensitive, caseInsensitive);
        },
        highlighter: function (item) {
            var query = this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, '\\$&');

            return item[this.options.display].replace(new RegExp('(' + query + ')', 'ig'), function ($1, match) {
                return '<strong>' + match + '</strong>';
            });
        },
        matcher: function (item) {
            var value = item[this.options.display];

            return {
                value: ~value.toLowerCase().indexOf(this.query.toLowerCase()),
                id: item.id
            };
        },
        updater: function (item, userId) {
            options.hiddenInputElement.val(userId);
            return item;
        }
    });
}; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-06T20:19:18.743

我建议不要重写原型（这会影响您可以使用自动完成器的所有地方，而不仅仅是以下功能）。
此代码应该可以工作：

```
var getSource = function () {

    var users = new Backbone.Collection([
        {
            first_name: 'primo',
            last_name: 'ultimo',
            id: 1
        },
        {
            first_name: 'altro_primo',
            last_name: 'altro_ultimo',
            id: 2
        }
    ]).models;

    return _.map(users, function (user) {
        return {
            id: user.get('id'),
            full_name: user.get('first_name') + ' ' + user.get('last_name'),
            // these functions allows Bootstrap typehead to use this item in places where it was expecting a string
            toString: function () {
                return JSON.stringify(this);
            },
            toLowerCase: function () {
                return this.full_name.toLowerCase();
            },
            indexOf: function (string) {
                return String.prototype.indexOf.apply(this.full_name, arguments);
            },
            replace: function (string) {
                return String.prototype.replace.apply(this.full_name, arguments);
            }
        };
    });
};

$('.full_name').typeahead({
            minLength: 3,
            source: getSource(),
            display: 'full_name',
            updater: function (itemString) {
                var item = JSON.parse(itemString);
                $('.id').val(item.id);
                return item.full_name;
            }
}); 
```

演示：http: [//jsfiddle.net/hyxMh/48/](http://jsfiddle.net/hyxMh/48/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T13:06:01.310

除了@AntoJs 的回答，这里是一个ajax 版本（只是'源'部分）：

```
$('.full_name').typeahead({
    /* ... */
    source: function(query,process){
    $.ajax({
        url: 'your_url_here',
        data: {term: query, additional_data: 'some_data'},
        success: function(data){
            process($.map(data, function(user){
                return {
                    id: user.id,
                    full_name: user.first_name + ' ' + user.last_name,
                    toString: function () {
                        return JSON.stringify(this);
                    },
                    toLowerCase: function () {
                        return this.full_name.toLowerCase();
                    },
                    indexOf: function (string) {
                        return String.prototype.indexOf.apply(this.full_name, arguments);
                    },
                    replace: function (string) {
                        return String.prototype.replace.apply(this.full_name, arguments);
                    }
                }
            }));
        }
    });
    },
/* ... */
}); 
```

顺便说一句：@AntoJs - 非常感谢您的回答！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-18T12:28:23.790

@antonjs 的答案对我不起作用，我收到以下错误

TypeError：item.substr 不是函数

所以使用 jQuery v2.1.3 和 bootstrap3-typeahead.js v3.1.0 以下对我有用

```
var getSource = function () {

    var users = new Backbone.Collection([
        {
            first_name: 'primo',
            last_name: 'ultimo',
            id: 1
        },
        {
            first_name: 'altro_primo',
            last_name: 'altro_ultimo',
            id: 2
        }
    ]).models;

    return _.map(users, function (user) {
        return {
            id: user.get('id'),
            full_name: user.get('first_name') + ' ' + user.get('last_name'),
            // these functions allows Bootstrap typehead to use this item in places where it was expecting a string
            toString: function () {
                return JSON.stringify(this);
            },
            toLowerCase: function () {
                return this.full_name.toLowerCase();
            },
            indexOf: function (string) {
                return String.prototype.indexOf.apply(this.full_name, arguments);
            },
            replace: function (string) {
                return String.prototype.replace.apply(this.full_name, arguments);
            },
            substr: function(start, len){
                  return this.full_name.substr(start, len);
            }
        };
    });
};

$('.full_name').typeahead({
            minLength: 3,
            source: getSource(),
            display: 'full_name',
            updater: function (itemString) {
                var item = JSON.parse(itemString);
                $('.id').val(item.id);
                return item.full_name;
            }
});
```

# entity-framework - Linqpad 和 EF5 代码优先

> ID：12182801
> 
> 赞同：9
> 
> 时间：2012-08-29T16:50:05.253
> 
> 标签：entity-framework, ef-code-first, linqpad

尝试对 Linqpad 中的 dbcontext 程序集运行查询时出现以下错误。

> InvalidOperationException：支持“UserQuery”上下文的模型自数据库创建以来已更改。考虑使用 Code First 迁移来更新数据库 (http://go.microsoft.com/fwlink/?LinkId=238269)。

做了一些阅读后，似乎：

```
Database.SetInitializer<DiaryAssistantContext>(null); 
```

是需要的。但是，这已经在我的派生 DbContext 类中。

有人可以给我指点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-30T05:01:22.867

LINQPad 子类化您的类型化数据上下文，因此您可以在不引用实例的情况下运行查询。也许 SetInitializer 方法需要子类。

如果替换此代码会发生什么：

```
Database.SetInitializer<DiaryAssistantContext>(null); 
```

有了这个：

```
typeof (Database).GetMethod ("SetInitializer").MakeGenericMethod (GetType()).Invoke (null, new object[] { null }); 
```

?

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-19T19:56:51.530

虽然已经接受了一个答案，但就我而言，我想要一个对编译时更友好的解决方案。以下解决方案类似于使用反射的已接受答案中的示例，但会提供一些额外的编译时检查：

```
Expression<Action> setInitializerExpression = () => Database.SetInitializer<MyContext>(null);
var setInitializerCall = (MethodCallExpression) setInitializerExpression.Body;
var setInitializerMethodInfo =
    setInitializerCall.Method.GetGenericMethodDefinition().MakeGenericMethod(GetType());
setInitializerMethodInfo.Invoke(null, new object[] {null}); 
```

# javascript - YepNopeJS：在微型 JS 文件完全加载之前触发回调

> ID：12182805
> 
> 赞同：3
> 
> 时间：2012-08-29T16:50:15.120
> 
> 标签：javascript, undefined, modernizr, yepnope

我有一个使用 Modernizr.load（又名 YepNopeJS）加载各种外部脚本的网站。其中一个脚本是一个小型统计脚本（未压缩 3,5 kB），带有一个非常简单的回调函数：

```
Modernizr.load({
  load: 'http://res.xtractor.no/x.js',
  callback: function() { _pxReg(); }
}); 
```

_pxReg 只是在 x.js 脚本中定义的一个函数。在我大约 50% 的页面中，我收到错误消息“未定义变量：_pxReg”（Opera 12）或“'_pxReg' 未定义”（Internet Explorer 9）。Firefox 15 和 Chrome 22 从不出错。重新加载页面时永远不会发生该错误。

这似乎是某种时间错误。在 IE 开发者工具中，x.js 文件的源在错误发生的那一刻是空的。这似乎与 YepNope ( [http://yepnopejs.com/#twice](http://yepnopejs.com/#twice) ) 中的双重请求“错误”有关，因为在 IE 中，您会获得对每个加载的 JS 文件的两个引用，其中第一个始终为空。

我本来希望生成一个触发此错误的完整示例，但这似乎与页面的复杂性有关。页面的简化版本永远不会触发此错误。

有人知道什么可能导致这种情况，以及我应该如何解决它？网站地址是[http://www.husbanken.no/](http://www.husbanken.no/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-15T20:25:17.950

回调在每次资源加载时发生一次，这意味着它将在加载中执行一次： ['x.js', 'y.js']

如果您使用 yepnope.js（基本上是 Modernizr.load 具有更多功能：前缀、超时等）加载资源并提供回调，您可以捕获闭包中的键并执行您的函数，如下所示：

```
yepnope([{
    load : {'x':'//x.js'},
    callback : function(url, result, key){
        if("x" === key && result === true) { _pxReg() };
    },
    complete : function(){ console.log("all done..")}
}]) 
```

让我知道这是否有帮助:)

# spring - Spring 数据 CrudRepository 存在

> ID：12182809
> 
> 赞同：31
> 
> 时间：2012-08-29T16:50:28.637
> 
> 标签：spring, spring-data, spring-data-jpa

当我扩展`CrudRepository`接口时，我的子接口中有`exists(ID)`方法。我可以写`findBy<property>`方法。

是否有可能以某种方式编写`existBy<property>`将返回的方法`boolean`。或对其进行注释，`@Query(jpa query)`使其返回`boolean`。

我知道我可以做`select count(*)`并返回`long`，但是我必须`!=0`检查我的服务层。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-11-26T18:08:51.340

@Oleksandr 的回答是正确的，但我可以让它工作的唯一方法如下。我在 PostgreSQL 上使用 Eclipselink。

```
public interface UserRepository extends JpaRepository<User, Long>
{
    @Query("SELECT CASE WHEN COUNT(u) > 0 THEN 'true' ELSE 'false' END FROM User u WHERE u.username = ?1")
    public Boolean existsByUsername(String username);
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-08-31T18:28:22.547

实际上，您可以像这样使用 case 表达式：

```
select case when count(e) > 0 then true else false end from Entity e
where e.property = ?1 -- here go your conditions 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2017-04-20T02:50:26.150

从 Spring Data JPA`1.11.0.RELEASE`开始，您现在可以使用`exists`方法名称的查询派生。例如，如果您有一个`User`具有属性的实体`email`，您可以这样做：

```
public interface UserRepository extends JpaRepository<User, Long> {

    boolean existsByEmail(String email);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T17:35:16.637

如果您查看源代码，`org.springframework.data.jpa.repository.support.SimpleJpaRepository.exists(ID)`您将看到它使用 a`TypedQuery`来计算记录并返回：

```
query.getSingleResult() == 1 
```

您可以创建一个对您的`existsBy(...)`方法执行类似操作的查询。

# orchardcms - “用户”页面抛出错误 - 传入字典的模型项的类型为“ShapeProxy”

> ID：12182811
> 
> 赞同：0
> 
> 时间：2012-08-29T16:50:28.797
> 
> 标签：orchardcms

如果我单击管理仪表板中的用户链接，我会收到此错误。

传入字典的模型项的类型为“ShapeProxy2f6cb7cf1318421da23ef1f9d1ea66bf”，但该字典需要类型为“System.Collections.Generic.Dictionary`2[System.String,System.DateTime]”的模型项。

```
Line 21: 
Line 22:     Model.Metadata.Type = "Pager_Links";
Line 23:     IHtmlString pagerLinks = Display(Model);
Line 24: 
Line 25:     Model.Classes.Add("selector"); 
```

源文件：\Themes\TheAdmin\Views\Pager.cshtml 行：23

我在堆栈跟踪中看到对 C:\Users\sebros\My Projects\Clay... 的引用，那是什么？

```
[InvalidOperationException: The model item passed into the dictionary is of type 'ShapeProxy2f6cb7cf1318421da23ef1f9d1ea66bf', 
but this dictionary requires a model item of type 'System.Collections.Generic.Dictionary`2[System.String,System.DateTime]'.]
System.Web.Mvc.ViewDataDictionary`1.SetModel(Object value) +381
System.Web.Mvc.ViewDataDictionary..ctor(ViewDataDictionary dictionary) +692
System.Web.Mvc.WebViewPage`1.SetViewData(ViewDataDictionary viewData) +74
System.Web.Mvc.RazorView.RenderView(ViewContext viewContext, TextWriter writer, Object instance) +139
System.Web.Mvc.Html.PartialExtensions.Partial(HtmlHelper htmlHelper, String partialViewName, Object model, ViewDataDictionary viewData) +147
Orchard.DisplayManagement.Descriptors.ShapeTemplateStrategy.ShapeTemplateBindingStrategy.Render(ShapeDescriptor shapeDescriptor, DisplayContext displayContext, HarvestShapeInfo harvestShapeInfo, HarvestShapeHit harvestShapeHit) in c:\orchard-1.4\src\Orchard\DisplayManagement\Descriptors\ShapeTemplateStrategy\ShapeTemplateBindingStrategy.cs:137
Orchard.DisplayManagement.Descriptors.ShapeTemplateStrategy.<>c__DisplayClass28.<Discover>b__15(DisplayContext displayContext) in c:\orchard-1.4\src\Orchard\DisplayManagement\Descriptors\ShapeTemplateStrategy\ShapeTemplateBindingStrategy.cs:118
Orchard.DisplayManagement.Descriptors.<>c__DisplayClass5.<BoundAs>b__2(DisplayContext displayContext) in c:\orchard-1.4\src\Orchard\DisplayManagement\Descriptors\ShapeAlterationBuilder.cs:55
Orchard.DisplayManagement.Implementation.DefaultDisplayManager.Process(ShapeBinding shapeBinding, IShape shape, DisplayContext context) in c:\orchard-1.4\src\Orchard\DisplayManagement\Implementation\DefaultDisplayManager.cs:179
Orchard.DisplayManagement.Implementation.DefaultDisplayManager.Execute(DisplayContext context) in c:\orchard-1.4\src\Orchard\DisplayManagement\Implementation\DefaultDisplayManager.cs:88
Orchard.DisplayManagement.Implementation.DisplayHelper.ShapeExecute(Object shape) in c:\orchard-1.4\src\Orchard\DisplayManagement\Implementation\DisplayHelper.cs:71
ClaySharp.<>c__DisplayClass16.<InvokeMember>b__13() in C:\Users\sebros\My Projects\Clay\src\ClaySharp\ClayBehaviorCollection.cs:29
ClaySharp.ClayBehaviorCollection.Execute(Func`1 proceed, Func`3 linker) in C:\Users\sebros\My Projects\Clay\src\ClaySharp\ClayBehaviorCollection.cs:13
Orchard.Core.Shapes.CoreShapes.Pager_Links(Object Shape, Object Display, HtmlHelper Html, Int32 Page, Int32 PageSize, Double TotalItemCount, Nullable`1 Quantity, Object FirstText, Object PreviousText, Object NextText, Object LastText, Object GapText, String PagerId) in c:\orchard-1.4\src\Orchard.Web\Core\Shapes\CoreShapes.cs:500 
```

# wpf - 如何查找子窗口是否打开

> ID：12182815
> 
> 赞同：0
> 
> 时间：2012-08-29T16:50:52.193
> 
> 标签：wpf, silverlight, silverlight-4.0, timer, telerik

我有一个要求，我需要检查是否有任何记录已更改，这取决于我需要提醒用户。因此，每 5 秒使用一次计时器，我试图从数据库中进行验证并向用户显示警报窗口。工作得很好。

问题是，如果用户长时间处于空闲状态。随着时间的推移，我会收到多个警报窗口。（考虑每 2 秒的数据更改）。

所以我需要知道警报窗口是否已经打开，如何获取打开的窗口的实例，我可以对其进行一些操作。

在这里，我不想创建任何单个实例。请让我知道是否有任何方法可以直接在 Silverlight 中完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T19:17:50.450

Assuming you are using Telerik windows (because question is tagged Telerik), try

```
RadWindowManager.Current.CloseAllWindows(); 
```

Or if you need to have more control, you can iterate thru the currently open windows using

```
RadWindowManager.Current.GetWindows() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:39:28.927

您可以通过 Application.Current.Windows 进行枚举（包括您的应用程序创建的所有窗口）。您可以在那里找到您的警报窗口并将其置于前台或创建新窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T16:54:31.043

在您的应用程序中将您的子窗口创建为单例（声明私有成员），然后相应地打开和关闭它，并确保释放您的实例（等于 null）。有了它，您只需检查您的“子窗口”是否与 null 不同，这意味着它是打开的，如果不是，那么您创建一个实例并打开它。

# visual-studio-2010 - 位于“应用程序文件夹”中的无效图标文件

> ID：12182820
> 
> 赞同：32
> 
> 时间：2012-08-29T16:51:02.147
> 
> 标签：visual-studio-2010

在我的安装项目中，我现在删除图标并添加新图标，当我构建安装项目时出现此错误

**位于“应用程序文件夹”中的无效图标文件 xxx**

我使用 VS 2010

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-08-29T16:58:14.170

我认为这可能会对您有所帮助：

在项目中添加一个有效的图标。然后左键单击以选择安装程序项目（在解决方案资源管理器中）。转到属性窗口，更改**AddRemoveProgramsIcon**。浏览并将其设置为新添加的有效图标。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-08T17:52:24.613

或者，如果您还没有准备好指定图标文件，只需在安装项目中将 AddRemoveProgramsIcon 值更改为“None”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-30T15:18:24.627

我遇到了同样的问题，我的应用程序文件夹中有图标，我在资源管理器中看到它，一切看起来都很好，但是我遇到了**TFS**问题，来回前进然后问题出现了，我所做的是以下：

1.  转到我的 Setup 项目属性并在**AddRemoveProgramsIcon**属性上单击**Browse**，然后看到文件名在那里，但没有物理图标，如下图所示

![没有物理图标](../Images/0e8cf2853cc61615e0f98eaa710ea642.png)

2.  单击浏览并在应用程序文件夹中搜索我的图标，然后将其插入，然后看到如下图所示的物理图标

![在此处输入图像描述](../Images/538e1c5afdf76c291c009a134b30428c.png) ![在此处输入图像描述](../Images/c66cd274df3bcc93601e37135a214f88.png)

3.  然后重建，一切正常

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T17:18:16.403

我认为您正在使用该图标作为快捷方式，如果是这样，您必须重新影响新图标的所有快捷方式，当您删除程序集时也是如此，即使您用同名的新程序替换它，您也必须**重新影响所有人**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-21T14:07:22.523

使用不同的图标并再次重建项目。如果您使用不同的名称，它似乎会卡住。或者，您也可以关闭解决方案并再次重新打开以清除错误。

# c - 当初始化器的数量多于数组大小时，会有什么行为？

> ID：12182823
> 
> 赞同：3
> 
> 时间：2012-08-29T16:51:09.543
> 
> 标签：c, arrays, initialization, object-initializers, aggregate-initialization

我想知道当初始化器的数量超过数组大小时会发生什么，例如：

```
int t[3] = { 1, 2, 3, 4 }; 
```

当然，我的编译器会警告它。我期待未定义的行为，但我在 C11 标准中没有找到任何关于它的条款。那么，我错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T16:52:01.120

该代码在 C 和 C++ 中都是格式错误的。

C++11 §8.5.1[dcl.init.aggr]/6 状态：

> 如果*初始化器子句*的数量超过要初始化的成员或元素的数量，则*初始化器列表*是格式错误的。

 *C11 §6.7.9/2 规定：

> 任何初始化程序都不应尝试为未包含在正在初始化的实体中的对象提供值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:06:28.230

我查看了为您的示例生成的汇编程序 gcc，看起来它采用了“安全”路线；它根本不会加载超过数组大小的值：

```
void main() {
    int t[3] = { 1, 2, 3, 4 };
} 
```

生成以下程序集：

```
main:
    pushl %ebp
    movl  %esp, %ebp
    subl  $16, %esp
    movl  $1, -12(%ebp)
    movl  $2, -8(%ebp)
    movl  $3, -4(%ebp)
    leave
    ret 
```

这是使用 gcc 4.4.3 生成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T17:00:00.363

好吧，这取决于您的编译器。有些甚至不允许你用它来构建，Visual Express 给出：

```
error C2078: too many initializers 
```

gcc 允许它飞行但警告你元素太多......我认为在这种情况下没有预期的行为，因为它是未定义的，但它肯定不会工作。

前任：

```
int t[3] = { 1, 2, 3, 4 }; 
int i;

for(i = 0; i< 5; i++){
    printf("val = %d\n", t[i]);}

val = 1
val = 2
val = 3
val = 4
val = 134513760 
```

我没有进行反汇编，但我很确定它最后只是遇到了其他数据。*

# c# - “无法连接到远程服务器”WCF 错误

> ID：12182824
> 
> 赞同：0
> 
> 时间：2012-08-29T16:51:10.533
> 
> 标签：c#, wcf, windows-mobile, sync

嗨，我正在做一个 wcf 同步应用程序，只需遵循

[http://msdn.microsoft.com/en-us/library/cc488004(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/cc488004(v=vs.90).aspx)

这个演练，但它给了我一个网络异常，说无法连接到远程服务器 ![在此处输入图像描述](../Images/049186c9a87428c4a088dfe83547381b.png)

谁能帮我弄清楚我哪里出错了

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:00:22.983

这些类型的错误通常是两件事：

*   确保您连接的任何东西实际上都在接受连接（您可以在浏览器中测试服务）
*   确保您的客户端和服务器绑定以及端点配置正确

# javascript - 对 wcf 服务的 javascript 调用

> ID：12182833
> 
> 赞同：2
> 
> 时间：2012-08-29T16:51:28.537
> 
> 标签：javascript, wcf

我创建了一个 WCF REST 服务，它以 JSON 格式返回响应，现在我想
从 javascript 调用它。但是当我尝试调用它时，我看不到任何响应。为了进行 javascript 调用，我写了这个：

```
<script src="Scripts/jquery-1.5.2.min.js" type="text/javascript">
</script>
<script language="javascript" type="text/javascript">
function Greeting() {
    $("#btnWCFREST").click(function() {
        $.ajax({
            url:"http://localhost:8732/Services/RoleService/json/Role/provider",
            type:"GET",
            dataType:"json",
            contentType:"application/json; charset=utf-8",
            successs: function(msg) {
                         alert(msg);
            },
            Error: function(msg) {
                      alert("Failed");
            }
        });
    }
}
</script> 
```

我怎样才能得到回应。我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:56:41.477

你有一个额外`s`的`successs`。将其更改为`success`以使该功能正常工作。

此外，您`E`在`Error`. 我相信 Javascript 区分大小写，因此您可能需要将其更改为`error`（全部小写）。

传递给错误函数的第一个参数将是 jqXHR 对象，*第二个*参数是错误消息。因此，如果您确实想要获取错误消息（您可能不会，因为您没有使用它），那么您将需要向您的`error`函数添加另一个参数。

最后，正如@SeanVieira 指出的那样，您的`click`函数缺少右括号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T16:58:42.033

你有一个语法错误 - 你永远不会关闭你`click`的方法调用的括号：

```
 }); // end .ajax function
    } // // end .click function - should be });
} // end Greeting function declaration 
```

此外，`Error:`应该是`error:`（JavaScript 区分大小写）。

# javascript - 如何使用 Spring WebFlow 在 JavaScript 中处理 form.submit()

> ID：12182835
> 
> 赞同：0
> 
> 时间：2012-08-29T16:51:34.050
> 
> 标签：javascript, spring, spring-mvc, spring-webflow

如何使用 Spring WebFlow 在 JavaScript 中处理 form.submit()

我知道网络流和我正在处理的项目，使用 javascript 在将数据提交到服务器之前检查所有字段。

例子：

```
<INPUT tabIndex="46" value="Submit" type="button" name="_eventId_submit" OnClick="return checkrequired();"> 
```

这是javascript

```
<SCRIPT type="text/javascript">
function checkrequired()
{
.....
form.submit();
return true;
} 
```

但看起来 webflow 对提交没有帮助。有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:28:53.140

```
Try to update your HTML like this....
<pre><code>
<form action="" onsubmit="return checkrequired">
....
<INPUT tabIndex="46" value="Submit" type="submit" name="_eventId_submit">
</form>
function checkrequired()
{
.....
//form.submit(); remove this
return true;
}
</code></pre> 
```

# maven - Maven 和远程 Windows 共享存储库

> ID：12182836
> 
> 赞同：1
> 
> 时间：2012-08-29T16:51:37.037
> 
> 标签：maven, dependencies, share

我有 Windows 共享存储库（例如 \myhost\myrepo ）。我想从中检索文件，但我不知道如何。

包括我

```
<repositories>
    <repository>
        <id>MyRepo</id>
        <name>My Repository</name>
        <url>file://myhost/myrepo</url>
    </repository>
</repositories> 
```

在日志中我看到：

```
[DEBUG] Using connector WagonRepositoryConnector with priority 0 for file://myhost/myrepo
Downloading: file://myhost/myrepo/[groupId]/[artifactId]/[version]/[artifactId][version].jar 
```

由于未解决的依赖关系，构建失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T07:13:41.413

找到了一个解决方案（也许它不会在 non_windows 机器上工作，但仍然）：

网址标签必须是这样的：

```
<url>file://\\server\Maven\repo\</url> 
```

# c++ - OpenGL3 我怎样才能放大 GL_TEXTURE_RECTANGLE？

> ID：12182843
> 
> 赞同：1
> 
> 时间：2012-08-29T16:51:54.957
> 
> 标签：c++, opengl, sfml, opengl-3

GL_TEXTURE_RECTANGLE 以实际大小（纹理图像的分辨率）显示自己，但我想扩大我的以填满整个屏幕，无论设置哪种分辨率。

当我更改纹理坐标和 glTexImage2D() 以使用屏幕分辨率而不是图像大小时，屏幕上会出现难看的垃圾。我想知道如何使图像填满整个屏幕，而不必为每种可能的屏幕分辨率制作单独大小的图像文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:57:37.717

您不会更改纹理坐标；你改变*顶点*坐标。通过更改用于渲染的矩阵或更改顶点的位置。

您可以根本不使用矩阵来转换四边形的位置。在这种情况下，位置将只是 (-1, -1), (-1, 1), (1, 1), (1, -1)。这适用于任何屏幕分辨率（假设您正确设置了视口）。

# jsf-2 - ViewScoped bean 的内存泄漏？

> ID：12182844
> 
> 赞同：6
> 
> 时间：2012-08-29T16:52:00.210
> 
> 标签：jsf-2, memory-leaks, cdi, seam3, view-scope

在我们 在**JBoss 7.1.1上的****JavaEE6**项目（**EJB3**、**JSF2**）中，似乎我们有 SeamFaces 的内存泄漏。**`@ViewScoped`**

 **我们制作了一个小原型来检查事实：

*   我们使用 JMeter 调用一个页面 200 次；
*   该页面包含并调用一个视图范围的 bean，该 bean 注入了一个有状态的 EJB；
*   我们将会话超时固定为 1 分钟。

在测试结束时，我们使用 VisualVM 检查内存的内容，得到的结果如下：

*   使用`@ViewScoped`bean，我们仍然可以获得 200 个有状态实例`MyController`——并且该`@PreDestroy`方法永远不会被调用；
*   使用`@ConversationScoped`bean，`@preDestroy`方法被称为会话结束，然后我们得到一个干净的内存。

我们是否错误地使用了视图范围，或者它真的是一个错误？

* * *

这是 XHTML 页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:ui="http://java.sun.com/jsf/facelets"   
   xmlns:s="http://jboss.org/seam/faces">
   <f:metadata>
        <f:viewParam name="u" value="#{myBean.uselessParam}" />
        <s:viewAction action="#{myBean.callService}" />
   </f:metadata>
   <h:body >
        <f:view>
        </f:view>
   </h:body>    
</html> 
```

现在包含 bean `myBean`。对于该`@ConversationScoped`变体，所有已注释的部分均未注释。

```
@ViewScoped
// @ConversationScoped
@Named
public class MyBean implements Serializable 
{
    @Inject
    MyController myController;
    //@Inject
    //Conversation conversation;

    private String uselessParam;

    public void callService()
    {
        //if(conversation.isTransient())
        //{
        //            conversation.begin();
        //}
        myController.call();
    }

    public String getUselessParam() 
    {
        return uselessParam;
    }

    public void setUselessParam(String uselessParam) 
    {
        this.uselessParam = uselessParam;
    }
} 
```

然后注入的有状态bean `MyController`：

```
@Stateful
@LocalBean
public class MyController
{
   public void call()
   {
         System.out.println("call ");
   }

   @PreDestroy
   public void destroy()
   {
         System.out.println("Destroy");
   }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T03:25:12.437

我看到许多开发人员对 Myface CODI 中的 @ViewAccessScoped 感到满意。请你试一试并告诉反馈。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-03T15:26:32.887

我在 JSF 管理的 @ViewScoped bean 中遇到了上述问题。在参考了几篇博客后，我了解到 JSF 将视图 bean 状态保存在 http 会话中，并且只有在会话无效时才会被销毁。每当我们在每次创建页面中引用的新视图范围 bean 时单击 jsf 页面。我做了一个使用 Spring Custom View Scope 的工作。它工作正常。下面是详细代码。

对于 JSF 2.1：

第 1 步：创建一个 View Scope Bean Post Construct Listener，如下所示。

```
 public class ViewScopeBeanConstructListener implements ViewMapListener {

     @SuppressWarnings("unchecked")
     @Override
     public void processEvent(SystemEvent event) throws AbortProcessingException {
        if (event instanceof PostConstructViewMapEvent) {
            PostConstructViewMapEvent viewMapEvent = (PostConstructViewMapEvent) event;
            UIViewRoot viewRoot = (UIViewRoot) viewMapEvent.getComponent();
            List<Map<String, Object>> activeViews = (List<Map<String, Object>>) 
                 FacesContext.getCurrentInstance().getExternalContext().getSessionMap(). get("com.org.jsf.activeViewMaps");
            if (activeViews == null) {
                activeViews = new ArrayList<Map<String, Object>>();
                activeViews.add(viewRoot.getViewMap());
                FacesContext.getCurrentInstance().getExternalContext().getSessionMap(). put("com.org.jsf.activeViewMaps", activeViews);
            } else {
                activeViews.add(viewRoot.getViewMap());
            }
        }
    } 
```

第二步：在 faces-config.xml 中注册事件监听器

```
<system-event-listener>
    <system-event-listener-class>
         com.org.framework.custom.scope.ViewScopeBeanConstructListener
    </system-event-listener-class>
   <system-event-class>javax.faces.event.PostConstructViewMapEvent</system-event-class>
    <source-class>javax.faces.component.UIViewRoot</source-class>
</system-event-listener> 
```

第 3 步：创建一个自定义视图范围 bean，如下所示。

```
 public class ViewScope implements Scope {

    @Override
    public Object get(String name, ObjectFactory objectFactory) {
        Map<String, Object> viewMap = FacesContext.getCurrentInstance().getViewRoot().getViewMap();
            if (viewMap.containsKey(name)) {
                    return viewMap.get(name);
            } else {
                 List<Map<String, Object>> activeViewMaps = (List<Map<String, Object>>)
                 FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get("com.org.jsf.activeViewMaps");
                 if (activeViewMaps != null && !activeViewMaps.isEmpty() 
                     && activeViewMaps.size() > 1) {
                        Iterator iterator = activeViewMaps.iterator();
                     if (iterator.hasNext()) {
                             Map<String, Object> oldViewMap = (Map<String, Object>)
                             iterator.next();
                             oldViewMap.clear();
                             iterator.remove();
                     }
                  }
                Object object = objectFactory.getObject();
                viewMap.put(name, object);
                return object;
           }

    } 
```

注意：其他被覆盖的方法可以为空。

对于 JSF 2.2：

JSF 2.2 将“com.Sun.faces.application.view.activeViewMaps”中的 http 会话中的导航视图映射保存为键。因此，在 Spring Custom View Scope 中添加以下代码。不需要像 JSF 2.1 那样的监听器

```
public class ViewScope implements Scope {

    public Object get(String name, ObjectFactory objectFactory) {
         Map<String, Object> viewMap =  
           FacesContext.getCurrentInstance().getViewRoot().getViewMap();
              if (viewMap.containsKey(name)) {
                     return viewMap.get(name);
              } else {
                       LRUMap lruMap = (LRUMap) FacesContext.getCurrentInstance().
     getExternalContext().getSessionMap().get("com.sun.faces.application.view.activeViewMaps");
                if (lruMap != null && !lruMap.isEmpty() && lruMap.size() > 1) {
                   Iterator itr = lruMap.entrySet().iterator();
                   while (itr.hasNext()) {//Not req
                     Entry entry = (Entry) itr.next();
                     Map<String, Object> map = (Map<String, Object>) entry.getValue();
                     map.clear();
                     itr.remove();
                     break;
                   }
                }
                Object object = objectFactory.getObject();
                viewMap.put(name, object);
                return object;
        }
 } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T22:02:26.070

很可能这是一个错误。老实说，Seam 3 的实现并不是那么好，而 CODI 的实现（以及 DeltaSpike 中的实现）要好得多。**

# c++ - 多线程和标准输出的性能问题

> ID：12182847
> 
> 赞同：4
> 
> 时间：2012-08-29T16:52:08.417
> 
> 标签：c++, multithreading, pthreads, ipc

我正在开发一个基准应用程序，它使用用户定义的线程数来进行处理。我还在为基准测试结果开发可视化应用程序。

基准测试本身是用 C++ 编写的（并使用 pthreads 进行线程处理），而可视化工具是用 Python 编写的。

现在，我正在做的是`stdout`从基准到可视化器的管道。这样做的好处是能够使用一种工具，例如`netcat`在一台机器上运行基准测试并在另一台机器上运行可视化工具。

![应用程序的高级图](../Images/1228852868e6f3f6c769494b95f03908.png)

关于基准的一点：

*   它非常受 CPU 限制
*   每个线程每隔 10 毫秒写入一次重要数据（即我需要用于可视化器的数据）。
*   每个打印的数据是一行 5 到 20 个字符。
*   如前所述，线程数是高度可变的（可以是 1、2、40 等）
*   即使数据不被破坏很重要（例如，一个线程在`printf`/期间抢占另一个线程`cout`，导致打印的数据与另一个线程上的输出交错），写入正确完成并不是很重要命令。

关于最后一点的示例：

```
// Thread 1 prints "I'm one\n" at the 3 seconds mark
// thread 2 prints "I'm two\n" at the 4 seconds mark

// This is fine
I'm two
I'm one

// This is not
I'm I'm one
 two 
```

在基准测试中，我从 切换到`std::cout`，`printf`因为它更接近`write`(2)，以尽量减少不同线程输出之间交错的机会。

我担心`stdout`随着线程数量的增加，从多个线程写入会导致瓶颈。非常重要的是，基准的输出可视化部分对资源非常轻，以免扭曲结果。

我正在寻找一种有效的方法来让我的两个应用程序说话而不影响我的基准测试的性能而不是绝对必要的。有任何想法吗？你们中有人解决过这样的问题吗？任何更智能/更清洁的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T17:08:23.057

写入标准输出不太可能成为任何现实世界问题的性能瓶颈。如果是这样，您要么记录太多，要么对一项任务进行基准测试，该任务太快以至于无法根据背景噪音进行测量。然而，这是一个线程安全错误。您对 printf 与 cout 的选择只是巫术——两者都不是线程安全的。如果您想在多线程环境中使用缓冲 I/O，您需要自己序列化调用（使用`pthread_mutex_t`，或使用信号量实现队列等...）。如果您想依靠系统调用原子性为您执行此操作（在内部，内核执行完全相同的序列化），您需要自己进行系统调用，而不是依赖 printf “接近”写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:24:28.610

假设您有一个符合 POSIX 标准的标准库，则对 stdio 函数的每次调用相对于其他线程都是原子的，因此只要您通过一次`printf`调用打印出您的行，即使两个线程写一行，它们也不会混合在一起在同一时间。使用 C++进行的每次调用都是如此`iostream::operator<<`，但如果您编写类似`cout << "xxx " << var << endl;`的内容，那就是三个调用，而不是一个。

如果您想多次调用 stdio 函数并将其编写为一个单元，您可以使用flockfile(3)。例如：

```
flockfile(stdout);
printf("data: ");
print_struct(foo);  // a function that calls printf internally
printf("\n");
funlockfile(stdout); 
```

这将导致打印从换行到换行的整个内容，`data`而不允许其他线程交错。它对 C++ iostreams 也很有用：

```
flockfile(stdout);
cout << "data: " << x << endl;
funlockfile(stdout); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T17:13:15.607

首先，在我担心它之前，我会确保它是一个问题。如果写入仅每 10 或 20 毫秒一次，则它们很可能不会打扰任何事情。

否则：“写入”实际上包含两个操作：格式化输出，以及物理输出格式化的字节。第二个可能相当快，因为​​它只是将 5 到 20 个字符从您的进程复制到操作系统的问题。（操作系统将在您从`write`/`WriteFile`函数返回后进行物理写入。）如果您在本地格式化，使用`std::ostrstream`(已弃用，但应该可用) or `snprintf`，格式化为 local `char[]`，然后在结果上调用 `write`or `WriteFile`，您不需要不需要任何外部同步。

或者，您可以在单独的线程中完成所有写入，只需将请求（带有必要的数据）推送到队列（使用条件变量很容易实现）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T17:08:05.900

它们都可以将它们的输出行作为字符串推送到[队列](http://www.cplusplus.com/reference/stl/queue/)中，而另一个线程可以拉取它们并记录它们（单线程，缓冲输出，刷新频率较低）。

# php - php 问答题-随机

> ID：12182850
> 
> 赞同：0
> 
> 时间：2012-08-29T16:52:10.460
> 
> 标签：php, mysql, session

我必须开发一个在线测验，其中的问题跨越多个页面。我有两个问题。必须随机选择池。选择池后，必须以随机顺序向用户显示问题。它是一个单词答案测验。我打算使用 MySQL、apache 和 PHP 来实现这一点，因为我是 webapp 的新手，而且它们看起来很容易学习。您能帮我解决以下问题吗？

1.  如何每页显示一个问题？我只能找到在单页中显示所有问题的示例。
2.  我是否必须对池进行评分，显示的问题并将评分作为会话变量？
3.  据我了解，如果浏览器关闭，会话变量就会丢失。我是否必须将它们存储在数据库中，以便用户可以从他们离开的地方开始？如果是这种情况，那么每个问题我将不得不进行一次数据库操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T13:34:24.480

您将需要将问题存储在会话中的数组中。可以恢复会话，我通常绕过内置的会话处理程序并使用我自己的将对象存储在数据库中。

要每页显示一个问题，请使用 jquery 显示和隐藏 div。然后，如果需要，您可以通过 ajax 提交答案，或者等到所有问题都得到回答。

如果您需要随机化一组问题，请使用[shuffle](http://php.net/manual/en/function.shuffle.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:57:38.510

1.  MySQL`LIMIT 1`
2.  是的
3.  是的，关闭浏览器时会话丢失。你可以做两件事：

    1.  让用户注册一个帐户并将他的进程保存在数据库中。
    2.  Cookies（但要小心，用户可以操纵它们）。

# c# - 使用 C# EnumBuilder 创建带属性的 Enum

> ID：12182855
> 
> 赞同：0
> 
> 时间：2012-08-29T16:52:28.200
> 
> 标签：c#, reflection, enums, attributes, reflection.emit

我使用 C# 中的 EnumBuilder 根据我的数据库中的表创建枚举。然而，正如我的框架所设计的那样，我们拥有的枚举还包含一个属性，该属性通常是与数据库中的 ID 关联的名称。

我想要完成的是使与数据库表相关的枚举保持最新，而无需手动更新它们，并且不会丢失它当前具有的属性功能（即使它们很少使用）。

那么，是否可以构建一个也包含属性的枚举？

IE

```
public enum Example
{
   [StringValue("Some Name 1")]
   SomeName1 = 1,       
   [StringValue("Some Name 2")]
   SomeName2 = 2,
} 
```

**更新**

使用 SetCustomAttribute 我能够通过将以下内容添加到创建枚举的现有代码来添加属性。

```
Type myType = typeof(StringValueAttribute);
ConstructorInfo ci = myType.GetConstructor(new Type[] { typeof(string) });
// Other code
FieldBuilder fb = eb.DefineLiteral(name, result.ExampleID);
var cab = new CustomAttributeBuilder(ci, new object[] { result.Name });
fb.SetCustomAttribute(cab); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:58:01.073

我自己没有使用过`EnumBuilder`，但它的[`DefineLiteral`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.enumbuilder.defineliteral.aspx)方法返回 a[`FieldBuilder`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.fieldbuilder.aspx)反过来又暴露[`SetCustomAttribute`](http://msdn.microsoft.com/en-us/library/btz51t4a.aspx)了我怀疑你可以用来定义字段的属性。

# mysql - 将 MySQL @rowid 分配为值

> ID：12182857
> 
> 赞同：2
> 
> 时间：2012-08-29T16:52:31.070
> 
> 标签：mysql, sql

我有一个包含很多行（大约 10k 行）的现有表，其中两列作为主键，因为它充当其他两个表之间多对多关系的中间表。

对于新要求，我需要分配添加新列（例如`id`），该列必须是具有自动增量值的主键。我运行了以下查询：

```
ALTER TABLE  `momento_distribution` ADD  `id` INT( 11 ) NOT NULL FIRST;
ALTER TABLE  `momento_distribution` DROP PRIMARY KEY , ADD PRIMARY KEY (  `id` ); 
```

第一个查询成功运行，但第二个查询生成以下错误：

```
1062 - Duplicate entry '0' for key 'PRIMARY' 
```

原因很明显，新列`id`的默认值是 0，主键不能有重复值。

现在，在我可以运行第二个查询之前，我需要为新列设置增量值，如 1,2,3...

我知道，在 Oracle 中，这可以通过 rowid 来完成。MySQL 也有其等效的@rowid。有人可以建议一个查询来将@rowid 设置为 column 的列值`id`吗？

**请注意：这必须通过查询来完成，因为我无法手动更改 10000 行。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T16:58:44.653

You need to set it to AUTO_INCREMENT at the same time, that will populate it;

```
ALTER TABLE momento_distribution 
  ADD id INT NOT NULL AUTO_INCREMENT PRIMARY KEY FIRST; 
```

Demo [here](http://sqlfiddle.com/#!2/058f2/2).

EDIT: If you have an existing primary key, you'll need to drop that at the same time;

```
ALTER TABLE momento_distribution 
  DROP PRIMARY KEY, 
  ADD id INT NOT NULL AUTO_INCREMENT PRIMARY KEY FIRST; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T04:31:18.163

同一用户提出的相同问题不同。参考那个问题。

[MySQL 1062 - 键 'PRIMARY' 的重复条目 '0'](https://stackoverflow.com/questions/12179770/mysql-1062-duplicate-entry-0-for-key-primary/12189846#12189846)

简而言之，1\. 删除现有的 FK 2\. 删除现有的 PK 3\. 运行您的第一个查询

```
ALTER TABLE  `momento_distribution` ADD  `id` INT( 11 ) PRIMARY KEY AUTO_INCREMENT NOT NULL FIRST; 
```

这也将分配唯一编号而不依赖于@rowid 4\. 如果需要，将 FK 添加到较早的列。

# php - 使用 PHP 提交表单时返回 JSON 或 HTML？

> ID：12182864
> 
> 赞同：0
> 
> 时间：2012-08-29T16:52:58.707
> 
> 标签：php, jquery, ajax, forms, response

我需要在我的网站上添加一个小表单。我希望用户能够使用 jQuery 的 $.ajax() 提交表单，并通过使用类突出显示无效字段来显示错误。我在我的服务器上使用 PHP 使用 cURL 将数据提交到第三方服务器，该服务器以 JSON 格式返回响应。

如果服务器发回一条成功消息，我需要用成功消息替换小表单所在的 HTML，并显示一些用户可以再次提交的附加字段。

我对是否应该以 JSON 格式或 HTML 格式发回响应感到困惑？第二个表单需要包含可以包含在表单提交中的某种数据，以便服务器知道要更新哪个记录。

如果我以 HTML 格式发回响应，如何向每个 INPUT 字段添加一个类？如果我以 JSON 格式发回，如何显示带有附加字段的表单的 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:03:30.930

我要做的是发回 json 响应。您可以使用 javascript 检查响应并呈现适当的内容。您可以使用类型为“文本/模板”的脚本标记存储任何 html 以供以后在页面上使用。

```
HTML
<script id="response-form" type="text/template">
<div>
<span></span>
<form>
<input ... />
</form>
</div> 
```

.

```
JQuery
if (success)
$('originalContentElem').html($('#response-form').html()) 
```

您可以在此处阅读有关模板的更多信息： [<script type = "text/template"> ... </script> 的说明](https://stackoverflow.com/questions/4912586/explanation-of-script-type-text-template-script)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:02:18.463

好吧，由于您使用的是 jQuery，您可以将响应发送回 HTML，然后创建一个 jQuery 对象来添加类：

```
var html = $(responseHTML);

html.find('input').addClass('yourClass'); 
```

# algorithm - 如何对 N 位整数执行 K-swap 操作以获得最大可能数

> ID：12182865
> 
> 赞同：23
> 
> 时间：2012-08-29T16:53:06.740
> 
> 标签：algorithm

我最近参加了一次面试，被问到这个问题。让我正确解释这个问题：

> 给定一个数字 M（N 位整数）和 K 个交换操作（交换操作可以交换 2 个数字），设计一种算法来获得最大可能的整数？
> 示例：
> M = 132 K = 1 个输出 = 312
> M = 132 K = 2 个输出 = 321
> M = 7899 k = 2 个输出 = 9987

我的解决方案（伪代码中的算法）。我使用最大堆在每个 K 操作中从 N 位中获取最大位，然后适当地交换它。

```
for(int i = 0; i<K; i++)
{
    int max_digit_currently = GetMaxFromHeap();
    // The above function GetMaxFromHeap() pops out the maximum currently and deletes it from heap

    int index_to_swap_with = GetRightMostOccurenceOfTheDigitObtainedAbove();
    // This returns me the index of the digit obtained in the previous function  
    // .e.g If I have 436659 and K=2 given,   
    // then after K=1 I'll have 936654 and after K=2, I should have 966354 and not 963654.

    // Now, the swap part comes. Here the gotcha is, say with the same above example, I have K=3.
    // If I do GetMaxFromHeap() I'll get 6 when K=3, but I should not swap it, 
    // rather I should continue for next iteration and 
    // get GetMaxFromHeap() to give me 5 and then get 966534 from 966354.

    if (Value_at_index_to_swap == max_digit_currently)
        continue;
    else
        DoSwap();
} 
```

**时间复杂度： O(K*( N + log_2(N) ))**
// K-times [log_2(N) for pop up number from heap & N to get the most right index to swap with]

上面的策略在这个例子中失败了：
M = 8799 and K = 2
按照我的策略，我会在 K=1 之后得到 M = 9798，在 K=2 之后得到 M = 9978。但是，在 K=2 之后，我能得到的最大值是 M = 9987。

我错过了什么？
**还建议其他解决问题的方法和优化我的解决方案的方法。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:32:31.660

这是一个递归函数，它对每个（当前最大）数字的可能交换值进行排序：

```
function swap2max(string, K) {
    // the recursion end:
    if (string.length==0 || K==0)
        return string

    m = getMaxDigit(string)
    // an array of indices of the maxdigits to swap in the string
    indices = []
    // a counter for the length of that array, to determine how many chars
    // from the front will be swapped
    len = 0
    // an array of digits to be swapped
    front = []
    // and the index of the last of those:
    right = 0
    // get those indices, in a loop with 2 conditions:
    // * just run backwards through the string, until we meet the swapped range
    // * no more swaps than left (K)
    for (i=string.length; i-->right && len<K;)
        if (m == string[i])
            // omit digits that are already in the right place
            while (right<=i && string[right] == m)
                right++
            // and when they need to be swapped
            if (i>=right)
                front.push(string[right++])
                indices.push(i)
                len++
    // sort the digits to swap with
    front.sort()
    // and swap them
    for (i=0; i<len; i++)
        string.setCharAt(indices[i], front[i])
    // the first len digits are the max ones
    // the rest the result of calling the function on the rest of the string
    return m.repeat(right) + swap2max(string.substr(right), K-len)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T20:42:50.867

我认为缺少的部分是，在您按照 OP 描述的算法执行 K 交换之后，您会留下一些可以在它们之间交换的数字。例如，对于数字 87949，在初始算法之后我们将得到 99748。但是，之后我们可以“免费”交换 7 和 8，即不消耗任何 K 交换。这将意味着“我宁愿不将 7 与第二个 9 交换，而是与第一个交换”。

因此，要获得最大数字，可以执行 OP 描述的算法并记住向右移动的数字以及它们移动到的位置。然后，将这些数字按降序排序，并从左到右放置它们的位置。

这类似于将算法分为两个阶段 - 在第一个阶段中，您选择哪些数字应该放在前面以最大化前 K 个位置。然后，您确定将它们与他们所占据位置的数字交换的顺序，以便数字的其余部分也最大化。

并非所有细节都清楚，我也不是 100% 确定它可以正确处理所有情况，所以如果有人能破解它 - 请继续。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-04T13:52:06.663

这是我的方法（它不是万无一失的，但涵盖了基本情况）。首先，我们需要一个将 INT 的每个 DIGIT 提取到容器中的函数：

```
std::shared_ptr<std::deque<int>> getDigitsOfInt(const int N)
{
    int number(N);
    std::shared_ptr<std::deque<int>> digitsQueue(new std::deque<int>());
    while (number != 0)
    {
        digitsQueue->push_front(number % 10);
        number /= 10;
    }
    return digitsQueue;
} 
```

您显然想要创建与此相反的内容，因此将这样的容器转换回 INT：

```
const int getIntOfDigits(const std::shared_ptr<std::deque<int>>& digitsQueue)
{
    int number(0);
    for (std::deque<int>::size_type i = 0, iMAX = digitsQueue->size(); i < iMAX; ++i)
    {
        number = number * 10 + digitsQueue->at(i);
    }
    return number;
} 
```

您还需要找到 MAX_DIGIT。使用 std::max_element 会很棒，因为它会将迭代器返回到容器的最大元素，但如果还有更多，您需要最后一个。所以让我们实现我们自己的最大算法：

```
int getLastMaxDigitOfN(const std::shared_ptr<std::deque<int>>& digitsQueue, int startPosition)
{
    assert(!digitsQueue->empty() && digitsQueue->size() > startPosition);
    int maxDigitPosition(0);
    int maxDigit(digitsQueue->at(startPosition));
    for (std::deque<int>::size_type i = startPosition, iMAX = digitsQueue->size(); i < iMAX; ++i)
    {
        const int currentDigit(digitsQueue->at(i));

        if (maxDigit <= currentDigit)
        {
            maxDigit = currentDigit;
            maxDigitPosition = i;
        }
    }
    return maxDigitPosition;
} 
```

从这里开始，您必须做的事情非常简单，将最右边（最后一个）MAX DIGITS 放在他们的位置，直到您可以交换：

```
const int solution(const int N, const int K)
{
    std::shared_ptr<std::deque<int>> digitsOfN = getDigitsOfInt(N);

    int pos(0);
    int RemainingSwaps(K);
    while (RemainingSwaps)
    {
        int lastHDPosition = getLastMaxDigitOfN(digitsOfN, pos);
        if (lastHDPosition != pos)
        {
            std::swap<int>(digitsOfN->at(lastHDPosition), digitsOfN->at(pos));

            ++pos;
            --RemainingSwaps;
        }
    }

    return getIntOfDigits(digitsOfN);
} 
```

有未处理的极端情况，但我会留给你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T17:53:19.067

这都是伪代码，但很容易转换为其他语言。该解决方案是非递归的，并且在线性最坏情况和平均情况时间下运行。

为您提供以下功能：

```
function k_swap(n, k1, k2):
    temp = n[k1]
    n[k1] = n[k2]
    n[k2] = temp

int : operator[k]
    // gets or sets the kth digit of an integer

property int : magnitude
    // the number of digits in an integer 
```

您可以执行以下操作：

```
int input = [some integer] // input value

int digitcounts[10] = {0, ...} // all zeroes
int digitpositions[10] = {0, ...) // all zeroes
bool filled[input.magnitude] = {false, ...) // all falses

for d = input[i = 0 => input.magnitude]:
    digitcounts[d]++ // count number of occurrences of each digit

digitpositions[0] = 0;
for i = 1 => input.magnitude:
    digitpositions[i] = digitpositions[i - 1] + digitcounts[i - 1] // output positions

for i = 0 => input.magnitude:
    digit = input[i]
    if filled[i] == true:
        continue
    k_swap(input, i, digitpositions[digit])
    filled[digitpositions[digit]] = true
    digitpositions[digit]++ 
```

我会用数字走过它`input = 724886771`

```
computed digitcounts:
{0, 1, 1, 0, 1, 0, 1, 3, 2, 0}

computed digitpositions:
{0, 0, 1, 2, 2, 3, 3, 4, 7, 9}

swap steps:
swap 0 with 0: 724886771, mark 0 visited
swap 1 with 4: 724876781, mark 4 visited
swap 2 with 5: 724778881, mark 5 visited
swap 3 with 3: 724778881, mark 3 visited
skip 4 (already visited)
skip 5 (already visited)
swap 6 with 2: 728776481, mark 2 visited
swap 7 with 1: 788776421, mark 1 visited
swap 8 with 6: 887776421, mark 6 visited

output number: 887776421 
```

# 编辑：

这没有正确解决问题。如果我以后有时间，我会修复它，但我现在没有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T18:15:45.013

假设传递了一个幻想整数数组，其中每个元素代表一个十进制数字，我会怎么做（在伪 C 中——没什么特别的）：

```
int[] sortToMaxInt(int[] M, int K) {
    for (int i = 0; K > 0 && i < M.size() - 1; i++) {
        if (swapDec(M, i)) K--;
    }
    return M;
}

bool swapDec(int[]& M, int i) {
    /* no need to try and swap the value 9 as it is the 
     * highest possible value anyway. */
    if (M[i] == 9) return false;

    int max_dec = 0;
    int max_idx = 0;
    for (int j = i+1; j < M.size(); j++) {
        if (M[j] >= max_dec) {
            max_idx = j;
            max_dec = M[j];
        }
    }

    if (max_dec > M[i]) {
        M.swapElements(i, max_idx);
        return true;
    }
    return false;
} 
```

从我的头顶，所以如果有人发现一些致命的缺陷，请告诉我。

编辑：根据此处发布的其他答案，我可能严重误解了这个问题。有人愿意详细说明吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-29T18:47:53.290

你从`max-number(M, N, 1, K)`.

```
max-number(M, N, pos, k)
{
    if k == 0
        return M
    max-digit = 0
    for i = pos to N
        if M[i] > max-digit
            max-digit = M[i]
    if M[pos] == max-digit
        return max-number(M, N, pos + 1, k)
    for i = (pos + 1) to N
        maxs.add(M)
        if M[i] == max-digit
            M2 = new M
            swap(M2, i, pos)
            maxs.add(max-number(M2, N, pos + 1, k - 1))
    return maxs.max()
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-16T22:29:53.130

我假设 K = 2，但你可以改变这个值！

### Java 代码

```
public class Solution {
    public static void main (String args[]) {
        Solution d = new Solution();
        System.out.println(d.solve(1234));
        System.out.println(d.solve(9812));
        System.out.println(d.solve(9876));
    }
    public int solve(int number) {
        int[] array = intToArray(number);
        int[] result = solve(array, array.length-1, 2);
        return arrayToInt(result);
    }
    private int arrayToInt(int[] array) {
        String s = "";
        for (int i = array.length-1 ;i >= 0; i--) {
            s = s + array[i]+"";
        }
        return Integer.parseInt(s);
    }
    private int[] intToArray(int number){
        String s = number+"";
        int[] result = new int[s.length()];
        for(int i = 0 ;i < s.length() ;i++) {
            result[s.length()-1-i] = Integer.parseInt(s.charAt(i)+"");
        }
        return result;
    }
    private int[] solve(int[] array, int endIndex, int num) {
        if (endIndex == 0)
            return array;
        int size = num ;
        int firstIndex = endIndex - size;
        if (firstIndex < 0)
            firstIndex = 0;
        int biggest = findBiggestIndex(array, endIndex, firstIndex);
        if (biggest!= endIndex) {
            if (endIndex-biggest==num) {
                while(num!=0) {
                    int temp = array[biggest];
                    array[biggest] = array[biggest+1];
                    array[biggest+1] = temp;
                    biggest++;
                    num--;
                }
                return array;
            }else{
                int n = endIndex-biggest;
                for (int i = 0 ;i < n;i++) {
                    int temp = array[biggest];
                    array[biggest] = array[biggest+1];
                    array[biggest+1] = temp;
                    biggest++;
                }
                return solve(array, --biggest, firstIndex);
            }
        }else{
            return solve(array, --endIndex, num);
        }
    }
    private int findBiggestIndex(int[] array, int endIndex, int firstIndex) {
        int result = firstIndex;
        int max = array[firstIndex];
        for (int i = firstIndex; i <= endIndex; i++){
            if (array[i] > max){
                max = array[i];
                result = i;
            }
        }
        return result;
    }
} 
```

# javascript - Ember-Data：“映射”如何工作

> ID：12182866
> 
> 赞同：11
> 
> 时间：2012-08-29T16:53:06.850
> 
> 标签：javascript, asp.net-web-api, ember.js, ember-data, ember-old-router

我目前正在尝试将一些东西与 ember + emberdata + router + asp.net web api 放在一起。大多数似乎都有效，但是当 ember-data 尝试`findAll`通过我的模型的适配器时，我遇到了一条错误消息。

在我的后端，我有一个这样的模型（C#）：

```
public class Genre {
    [Key]
    public int Id { get; set; }
    [Required]
    [StringLength(50, MinimumLength=3)]
    public string Name { get; set; }
} 
```

在我的应用程序中，我使用 ember-data 像这样表示它：

```
App.Genre = DS.Model.extend({
    id: DS.attr("number"),
    name: DS.attr("string")
}).reopenClass({
    url: 'api/genre'
}); 
```

我还在我的应用程序中使用 RESTAdapter 定义了一个商店，如下所示：

```
App.store = DS.Store.create({
    revision: 4,
    adapter: DS.RESTAdapter.create({
        bulkCommit: false
    })
}); 
```

商店在我的控制器中使用如下：

```
App.GenreController = Ember.ArrayController.extend({
    content: App.store.findAll(App.Genre),
    selectedGenre: null
}); 
```

路由器定义为

```
App.router = Em.Router.create({
    enableLogging: true,
    location: 'hash',
    root: Ember.Route.extend({
        //...

        genre: Em.Route.extend({
            route: '/genre',
            index: Ember.Route.extend({
                connectOutlets: function (router, context) {
                    router.get('applicationController').connectOutlet('genre');
                }
            })
        }),

        //...
    })
}) 
```

当我运行我的应用程序时，对于具有相同结构的每个对象，我都会收到以下消息：

> 未捕获的错误：断言失败：您的服务器返回密钥为 0 的哈希，但您没有映射

作为参考，这里是服务返回的 json：

```
[
  {
    "id": 1,
    "name": "Action"
  },
  {
    "id": 2,
    "name": "Drama"
  },
  {
    "id": 3,
    "name": "Comedy"
  },
  {
    "id": 4,
    "name": "Romance"
  }
] 
```

我无法确切说出问题所在，并且由于断言提到我需要映射，所以我想知道：

1.  这个映射*是*什么以及如何使用它。
2.  由于返回的 json 是一个数组，我应该在我的应用程序中使用不同类型的控制器，还是在 ember-data 中使用这种类型的 json 时我应该知道什么？还是应该更改服务器中的 JsonFormatter 选项？

欢迎任何帮助。

如果您觉得这不足以理解问题，我绝对可以添加更多信息。

**编辑**：我在后端更改了一些东西，现在我`findAll()`在服务器中的等效操作将输出序列化为以下 json：

```
{
  "genres": [
      { "id": 1, "name": "Action" },
      { "id": 2, "name": "Drama" },
      { "id": 3, "name": "Comedy" },
      { "id": 4, "name": "Romance" }
   ]
} 
```

但是我仍然无法让它在客户端中填充我的模型，并且我的错误消息已更改为：

> 未捕获的错误：断言失败：您的服务器返回了包含关键类型的哈希，但您没有映射

不知道我可能做错了什么。

抛出此异常的方法是[`sideload`](https://github.com/emberjs/data/blob/master/packages/ember-data/lib/adapters/rest_adapter.js#L236-262)并检查如下映射：

```
sideload: function (store, type, json, root) {
        var sideloadedType, mappings, loaded = {};

        loaded[root] = true;

        for (var prop in json) {
            if (!json.hasOwnProperty(prop)) { continue; }
            if (prop === root) { continue; }

            sideloadedType = type.typeForAssociation(prop);

            if (!sideloadedType) {
                mappings = get(this, 'mappings');
                Ember.assert("Your server returned a hash with the key " + prop + " but you have no mappings", !!mappings);
//... 
```

此调用`sideloadedType = type.typeForAssociation(prop);`返回`undefined`，然后我收到错误消息。该方法检查返回空`typeForAssociation()`的 for键。`'associationsByName'``Ember.Map`

目前仍然没有解决方案。

***顺便一提...***

我的动作现在是这样的：

```
 // GET api/genres
    public object GetGenres() {
        return new { genres = context.Genres.AsQueryable() };
    }

    // GET api/genres
    //[Queryable]
    //public IQueryable<Genre> GetGenres()
    //{
    //    return context.Genres.AsQueryable();
    //} 
```

我不得不删除由[json.NET](http://json.codeplex.com/)序列化的原始实现，因为我找不到配置选项来生成 Ember-Data 期望的 json 输出（如中所示`{resource_name : [json, json,...]}`）。这样做的副作用是我失去了内置的 OData 支持，但我想保留它。有谁知道我如何配置它来为一个集合生成不同的 json？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-30T22:09:18.930

映射可以在 DS.RESTAdapter 中定义。我认为您可以尝试定义如下内容：

```
App.Store = DS.Store.extend({
  adapter: DS.RESTAdapter.create({
    bulkCommit: true,
    mappings: {
      genres: App.Genre
    },
    // you can also define plurals, if there is a unregular plural
    // usually, RESTAdapter simply add a 's' for plurals.
    // for example at work we have to define something like this
    plurals: {
      business_process: 'business_processes' 
      //else it tries to fetch business_processs
    }
  }),
  revision: 4
}); 
```

希望这可以解决您的问题。

***更新：***

目前，这没有很好的文档记录，我不记得我们是否通过阅读代码发现了它，或者可能是 Tom Dale 指出了它。
无论如何，这里是[复数](https://github.com/emberjs/data/blob/master/packages/ember-data/lib/adapters/rest_adapter.js#L205)的重点 对于映射，我认为我们是由与您相同的错误驱动的，要么我们尝试过，要么汤姆教我们这个。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-29T18:54:50.280

`RESTAdapter`期望返回的`JSON`形式为：

```
{
  "genres": [{
    "id": 1,
    "name": "action"
  },{
    "id": 2,
    "name": "Drama"
  }]
} 
```

测试是很好的文档来源，请参阅[https://github.com/emberjs/data/blob/master/packages/ember-data/tests/unit/rest_adapter_test.js#L315-329](https://github.com/emberjs/data/blob/master/packages/ember-data/tests/unit/rest_adapter_test.js#L315-329)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-28T09:10:35.087

我正在使用 Ember Data `rev. 11`，似乎其中的`plurals`配置`DS.RESTAdapter.create`永远不会起作用。我查看了代码并找到了以下解决方案：

```
App.Adapter = DS.RESTAdapter.extend({
  bulkCommit: false
})

App.Adapter.configure('plurals', {
  series: 'series'
}) 
```

# javascript - 带有预览的异常响应式拆分滑块

> ID：12182867
> 
> 赞同：1
> 
> 时间：2012-08-29T16:53:13.400
> 
> 标签：javascript, css, layout, slider, responsive-design

我查看了许多不同的滑块，但没有找到任何可以实现设计师想要的东西。下面的图片应该有助于解释。请注意，滑块上方和下方都有用于页眉/页脚内容的空间。

A. 基本上这个想法是使用一定数量的屏幕空间，比如 10%，让下一个图像 (2) 在右侧部分可见。

B. 当前图像 (1) 向左浮动并填充高度 - 它可能是宽图像或窄图像。

C. 以浅灰色显示的空间量取决于用户的可用屏幕空间。当图像达到全分辨率时，间隙将根据需要扩大。

D. 相反，随着可用空间的缩小，间隙也会缩小，并且

E. 间隙达到最小尺寸后，载玻片收缩。

F. 然后，如果需要，当前幻灯片 (1) 将开始从左右剪裁（宽图像）。

G. 对于动画，下一张幻灯片 (2) 滑过以填补空白，然后将当前幻灯片 (1) 凸出，在将下一张图片部分拉入之前留下空白。

是否有一个滑块已经做了类似的事情，还是我需要修改一个现有的？如果是这样，什么是一个好的起点？我试过像 Flexslider 这样的，但是 JS 调整大小会干扰在屏幕上显示两个。

还没有图片发布权限，所以这里是：http: [//imgur.com/swYtr](http://imgur.com/swYtr)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T15:29:02.887

试试这个....

[酷旋转木马](http://coolcarousels.frebsite.nl/c/44/)

查看网站上提供的更多示例......它可能有助于您的查询。
这是另一个 [http://jsfiddle.net/JCQ6Q/15/](http://jsfiddle.net/JCQ6Q/15/)
一切顺利。
如果对您有帮助，请投票。:)

# sql - 将所有表从 sql server 2008 批量复制到 Amazon RDS 上的 sql server express

> ID：12182870
> 
> 赞同：0
> 
> 时间：2012-08-29T16:53:18.643
> 
> 标签：sql, sql-server, amazon-rds, sql-server-2008-express

我正在尝试将大约 5GB 的参考数据从本地 SQL Server 2008 标准实例复制到 Amazon RDS 上的 SQL Server 2008 Express 实例。（这是一次性导入）

亚马逊建议对大于 ~ 1GB 的任何内容使用批量复制。我找到了使用批量复制来复制单个表但不用于复制数据库中所有表的示例。

谷歌给了我以下[http://support.microsoft.com/kb/176818](http://support.microsoft.com/kb/176818)但它有点过时了。

我目前的计划是更新上面的脚本来做我需要的，但想知道是否有人有更好的主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:27:28.683

我经常使用 SQL Azure 迁移向导进行快速导入 - 不确定这种大小的加载需要多长时间，但该工具非常易于使用。[从CodePlex](http://sqlazuremw.codeplex.com/)获取它，这里有一个简短的[截屏视频](http://www.youtube.com/watch?v=Yn6zn_Mcj6Q)，介绍如何使用这个免费工具来做到这一点。

# php - 我可以在 PHP EOD 中使用条件逻辑吗？

> ID：12182876
> 
> 赞同：3
> 
> 时间：2012-08-29T16:53:28.793
> 
> 标签：php

是否可以将条件逻辑放在 EOD 字符串中？

```
$str = <<<EOD

<table>
    <tr>
        <td>
            if ( !empty($var1) ) {
                {$var1}
            } else {
                {$var2}
            }
        </td>
    </tr>
</table> 
```

这对我不起作用，而且看起来好像不起作用，但我想我会采取行动。

另外，是`EOD`还是`EOT`？两者似乎都有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:55:01.380

不，您不能在[heredoc](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)中使用条件。

> 另外，是`EOD`还是`EOT`？

只要您的开头和结尾字符串匹配，您就可以使用任何内容：

```
 $x = <<<THOMAS
 Pick a string, any string
 THOMAS; 
```

该文档[包含几个示例来证明这一点](http://www.php.net/manual/en/language.types.string.php#example-74)

至于如何最好地实现您提供的示例，这将是我的第一个倾向：

```
$td = !empty($var1) ? $var1 : $var2;
$str = <<<EOD
<table>
    <tr>
        <td>
            {$td}
        </td>
    </tr>
</table>
EOD; 
```

# continuous-integration - 如何防止 Hudson 自动或空闲时进入关机模式？

> ID：12182882
> 
> 赞同：1
> 
> 时间：2012-08-29T16:53:45.357
> 
> 标签：continuous-integration, hudson, shutdown, python-idle

经过几个月的成功和纯粹的持续集成，我的 Hudson 实例在 Mac OSX 10.7.4 Lion 上运行，它决定在每 20-30 分钟不活动后进入关机模式。

对于熟悉关闭模式的人来说，实例当然不会关闭，但会产生（在这种情况下）阻止新作业启动的不良影响。

我知道我没有更改任何设置，所以这让我认为问题正在缓慢增长并不断触发关机模式。

我知道机器上有足够的存储空间可以使用 400+ GB，所以我想知道在不实际使用 Hudson 门户网站手动执行的情况下还有什么会触发关机模式。

如前所述，这个问题似乎也与不活动有关。我尝试创建一个快速修复，这是一个每 5 分钟不执行任何操作的构建作业。起初它似乎可以工作，但在长时间不活动后，我会发现它回到关机模式。

任何想法可能会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T07:14:53.930

解决方案：禁用thinBackup插件

...

我通过查看 Hudson 日志发现了这一点`http://localhost:8080/log/all`

每次 Hudson 实例进入关闭模式时，thinBackup 都会运行。

在不活动期间发生关闭模式的事实也与 ThinBackup 的行为一致。

然后我禁用了插件，Hudson 不再进入关机模式。奇怪的是，thinBackup 在此问题开始发生之前已经安装了一段时间。我正在从 ThinBackup 寻找解决方案，以重新启用插件而不会产生负面影响，如果我得到答案，我会在此处更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T13:26:34.670

根据[此链接](http://www.eclipse.org/forums/index.php/t/370806/)，thinBackup 插件故意将 Hudson 置于关闭模式以进行备份活动。一旦完成，它应该会自动退出关机模式。

我看到一些工作似乎停滞不前，而且永远不会在一夜之间完成，因此 Hudson 从未退出关闭模式，因为 ThinBackup 一定一直在等待工作完成。

# css - 如何用css从顶部固定下拉菜单？

> ID：12182884
> 
> 赞同：0
> 
> 时间：2012-08-29T16:53:58.783
> 
> 标签：css, drop-down-menu

我想制作一个像[http://www.homeshop18.com/](http://www.homeshop18.com/)中的下拉菜单，只有没有 jquery 的 css，特别是 All 类别菜单。我尝试过 css 下拉菜单，但问题是我无法修复顶部的二级菜单。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:27:18.617

从您发布问题的方式无法理解您的问题，但这是我整理的一个快速菜单，它仅使用 CSS，其功能类似于您发布的网站上的菜单[。](http://jsfiddle.net/CrMEc/1/)

HTML：

```
<ul class="main">
    <li>all
        <ul class="sub">
            <li>books
                <ul class="sub2">
                    <li>fiction</li>
                    <li>biography</li>                    
                </ul>
            </li>
            <li>mobile
                <ul class="sub2">
                    <li>android</li>
                    <li>cmda</li>                    
                    <li>battery</li>
                </ul>
            </li>            
        </ul>    
    </li>
</ul>​ 
```

CSS：

```
li {
 border:1px solid;
 padding:1px;
}

.main {
 list-style:none;
 position:relative;    
}

.sub, .sub2 {
 list-style:none;
 position:absolute;  
 display:none;
 width:75px;    
}

.sub2 { 
 float:left;
 left:75px; 
 top:0px;    
}

.main li:hover .sub,
.sub li:hover .sub2{
 display:block;    
} 
```

# c++ - 如何在 C++ 中滚动锁定报表样式列表视图的第一列

> ID：12182887
> 
> 赞同：1
> 
> 时间：2012-08-29T16:54:10.680
> 
> 标签：c++, winapi, listview

我想锁定报告样式列表视图的第一列以防止水平滚动。我正在使用 Win32（没有 .NET）在 C++ 中编程。此功能在标准列表视图中似乎不可用。关于如何使用 C++/Win32 实现这一点的任何建议？我已经看到在 .NET 中使用 DataGridView 的建议，但我没有使用 .NET ...

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:03:52.820

关于我能想到的唯一一件事是使用两个相邻的列表视图控件，一个具有从不滚动的单列，另一个具有所有其他列。这不是一个理想的解决方案，但没有办法让标准列表视图以这种方式运行。

或者，您可以编写自己的类似列表视图的控件。

# c# - 数据库的多线程应用程序死锁问题

> ID：12182890
> 
> 赞同：1
> 
> 时间：2012-08-29T16:54:15.333
> 
> 标签：c#, multithreading, console-application, deadlock, database-deadlocks

我正在使用多线程控制台应用程序，其中每个线程基本上都尝试获取满足某些条件的 TOP 1“文件”行并将其锁定。（发生这种情况时会填充一个 LockID 列，以便下一个线程拿起下一个可用的“解锁”“文件”行）

我们在 SQL Server DB 上放置了一个监视器，每次死锁发生在 2 个查询上。

```
SELECT TOP 1 F.Id, F.ContentTypeId, F.ManufacturerId, F.DocumentTypeId, F.Name, F.Description, F.VersionId, F.LastChangedVersionOn, F.ReferenceCount, F.LastChangedReferencesOn, F.LastChangedImageOn, F.ImageSize, F.IsStale, F.InvalidFile, CT.Id, CT.Name, CT.MimeType, CT.IsMimeAttachment, CT.Extensions, CT.CanTrackVersions, CT.UseRemoteSource, CT.FullTextFilter, CT.ContentHandler, V.Id, V.Size, V.Hash, V.Title, DT.Id, DT.Code, DT.Ordinal, DT.Name, DT.PluralName, DT.UrlPart
FROM Docs.Files F
INNER JOIN Docs.ContentTypes CT ON CT.Id = F.ContentTypeId
LEFT JOIN Docs.Versions V ON V.Id = F.VersionId
LEFT JOIN Docs.DocumentTypes DT ON DT.Id = F.DocumentTypeId
WHERE (F.LockId IS NULL OR F.LockedOn < DATEADD(hh,-1,GETUTCDATE()))
AND F.IsStale = 1 AND F.InvalidFile = 0 
```

和

```
(@Id int)UPDATE Docs.Files
SET LastChangedImageOn = GETUTCDATE(), ImageSize = (
    SELECT DATALENGTH(FileImage)
    FROM Docs.FileImages
    WHERE FileId = @Id)
WHERE Id = @Id;
SELECT TOP 1 LastChangedImageOn FROM Docs.Files WHERE Id = @Id 
```

第一个查询在创建新线程时运行，我们尝试获取新的“文件”行。

当线程（可能是先前创建的线程）几乎完成处理“文件”记录时，将运行第二个查询。此查询上的已使用事务。隔离级别为“ReadCommitted”。我很确定这两个查询都没有尝试访问相同的“FileID”，因为两个线程随后将永远不会处理相同的“FileID”。我对如何诊断这个问题感到非常困惑。什么可能导致这两个查询之间的死锁？如果有人能引导我朝着正确的方向前进，我将非常感激。提前非常感谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:38:05.257

嗯...自从我对 SQL Server 做任何事情以来已经有一段时间了。但是让我们尝试一下。

您提到“两个线程将永远不会处理相同的“FileID””，您如何确定这一点？ID 是从线程外部的源提供的吗？

# python - 使用 matplotlib 绘制图像颜色直方图

> ID：12182891
> 
> 赞同：10
> 
> 时间：2012-08-29T16:54:20.477
> 
> 标签：python, image, matplotlib

我正在尝试生成图像的颜色直方图。我正在使用 PIL 读取图像文件并尝试通过 matplotlib 绘制相同的图像。

```
im = Image.open(sys.argv[1])  
w, h = im.size  
colors = im.getcolors(w*h)  #Returns a list [(pixel_count, (R, G, B))] 
```

**更新**：经过反复试验，此代码绘制直方图，但不绘制颜色！（即使是 320x480 jpeg 也会耗费大量内存）

```
for idx, c in enumerate(colors):
    plt.bar(idx, c[0], color=hexencode(c[1]))

plt.show() 
```

在哪里，

```
def hexencode(rgb):
    return '#%02x%02x%02x' % rgb 
```

执行时，程序开始消耗无限内存并且不提供显示。操作系统内存使用量在几分钟内从 < 380 MB 变为 > 2.5 GB；我终止执行的帖子。我怎样才能解决问题？

这是具有主要红色阴影的图像的颜色直方图示例：

![这是具有主要红色阴影的图像的颜色直方图示例](../Images/9d5086b8f95bc8caf2faa69ed6a0d06c.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-29T17:33:05.520

我试过你的更新代码，效果很好。这正是我正在尝试的：

```
import PIL
from PIL import Image
from matplotlib import pyplot as plt

im = Image.open('./color_gradient.png')  
w, h = im.size  
colors = im.getcolors(w*h)

def hexencode(rgb):
    r=rgb[0]
    g=rgb[1]
    b=rgb[2]
    return '#%02x%02x%02x' % (r,g,b)

for idx, c in enumerate(colors):
    plt.bar(idx, c[0], color=hexencode(c[1]))

plt.show() 
```

**更新：**

我认为 matplotlib 试图在每个栏周围放置一个黑色边框。如果条形太多，则条形太细而没有颜色。如果您有工具栏，您可以放大绘图并查看条形确实有颜色。因此，如果您通过以下方式设置边缘颜色：

```
for idx, c in enumerate(colors):
     plt.bar(idx, c[0], color=hexencode(c[1]),edgecolor=hexencode(c[1])) 
```

有用！

要处理的图像： ![在此处输入图像描述](../Images/35f62efd82d47a848f130c6c534938f6.png)

结果： ![在此处输入图像描述](../Images/250fc8fc13e613948ee95346ca91b76d.png)

**按tottime**
*排序的分析：*

```
 ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   23.424   23.424   24.672   24.672 {built-in method mainloop}
   460645    8.626    0.000    8.626    0.000 {numpy.core.multiarray.array}
    22941    7.909    0.000   18.447    0.001 C:\Python27\lib\site-packages\matplotlib\artist.py:805(get_aliases)
  6814123    3.900    0.000    3.900    0.000 {method 'startswith' of 'str' objects}
    22941    2.244    0.000    2.244    0.000 {dir}
   276714    2.140    0.000    2.140    0.000 C:\Python27\lib\weakref.py:243(__init__)
  4336835    2.029    0.000    2.029    0.000 {getattr}
  1927044    1.962    0.000    3.027    0.000 C:\Python27\lib\site-packages\matplotlib\artist.py:886(is_alias)
   114811    1.852    0.000    3.883    0.000 C:\Python27\lib\site-packages\matplotlib\colors.py:317(to_rgba)
    69559    1.653    0.000    2.841    0.000 C:\Python27\lib\site-packages\matplotlib\path.py:86(__init__)
    68869    1.425    0.000   11.700    0.000 C:\Python27\lib\site-packages\matplotlib\patches.py:533(_update_patch_transform)
   161205    1.316    0.000    1.618    0.000 C:\Python27\lib\site-packages\matplotlib\cbook.py:381(is_string_like)
        1    1.232    1.232    1.232    1.232 {gc.collect}
   344698    1.116    0.000    1.513    0.000 C:\Python27\lib\site-packages\matplotlib\cbook.py:372(iterable)
    22947    1.111    0.000    3.768    0.000 {built-in method draw_path}
   276692    1.024    0.000    3.164    0.000 C:\Python27\lib\site-packages\matplotlib\transforms.py:80(__init__)
        2    1.021    0.510    1.801    0.900 C:\Python27\lib\site-packages\matplotlib\colors.py:355(to_rgba_array)
    22947    0.818    0.000   14.677    0.001 C:\Python27\lib\site-packages\matplotlib\patches.py:371(draw)
183546/183539    0.793    0.000    2.030    0.000 C:\Python27\lib\site-packages\matplotlib\units.py:117(get_converter)
   138006    0.756    0.000    1.267    0.000 C:\Python27\lib\site-packages\matplotlib\transforms.py:126(set_children) 
```

*按累计时间排序*

```
ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001   84.923   84.923 C:\Python27\test.py:23(imageProcess)
        1    0.013    0.013   44.079   44.079 C:\Python27\lib\site-packages\matplotlib\pyplot.py:2080(bar)
        1    0.286    0.286   43.825   43.825 C:\Python27\lib\site-packages\matplotlib\axes.py:4556(bar)
        1    0.000    0.000   40.533   40.533 C:\Python27\lib\site-packages\matplotlib\pyplot.py:123(show)
        1    0.000    0.000   40.533   40.533 C:\Python27\lib\site-packages\matplotlib\backend_bases.py:69(__call__)
    22943    0.171    0.000   24.964    0.001 C:\Python27\lib\site-packages\matplotlib\patches.py:508(__init__)
        1    0.000    0.000   24.672   24.672 C:\Python27\lib\site-packages\matplotlib\backends\backend_tkagg.py:68(mainloop)
        1    0.000    0.000   24.672   24.672 C:\Python27\lib\lib-tk\Tkinter.py:323(mainloop)
        1   23.424   23.424   24.672   24.672 {built-in method mainloop}
    22947    0.499    0.000   24.654    0.001 C:\Python27\lib\site-packages\matplotlib\patches.py:55(__init__)
    22941    0.492    0.000   20.180    0.001 C:\Python27\lib\site-packages\matplotlib\artist.py:1136(setp)
    22941    0.135    0.000   18.730    0.001 C:\Python27\lib\site-packages\matplotlib\artist.py:788(__init__)
    22941    7.909    0.000   18.447    0.001 C:\Python27\lib\site-packages\matplotlib\artist.py:805(get_aliases)
    72/65    0.071    0.001   17.118    0.263 {built-in method call}
    24/12    0.000    0.000   17.095    1.425 C:\Python27\lib\lib-tk\Tkinter.py:1405(__call__)
    22941    0.188    0.000   16.647    0.001 C:\Python27\lib\site-packages\matplotlib\axes.py:1476(add_patch)
        1    0.000    0.000   15.861   15.861 C:\Python27\lib\site-packages\matplotlib\backends\backend_tkagg.py:429(show)
        1    0.000    0.000   15.861   15.861 C:\Python27\lib\lib-tk\Tkinter.py:909(update)
        1    0.000    0.000   15.846   15.846 C:\Python27\lib\site-packages\matplotlib\backends\backend_tkagg.py:219(resize)
        1    0.000    0.000   15.503   15.503 C:\Python27\lib\site-packages\matplotlib\backends\backend_tkagg.py:238(draw) 
```

似乎所有的时间都花在了 matplotlib 上。如果您想加快速度，您可以找到不同的绘图工具或减少“条”的数量。尝试用画布上的矩形自己做。

定时：

1.  上面发布的代码：75s
2.  为每个画一条线，即 plt.plot([n,n],[0,count],etc..): 95s

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-11-22T22:00:13.353

我一直在研究类似的问题，并在 5 年后遇到了这个线程。对于较大的图像，接受的答案是花费太长时间来简单地“生成图像的颜色直方图”。

我使用 openCV 而不是 PIL 来生成直方图，它要快得多。

```
import cv2
import numpy as np
from matplotlib import pyplot as plt

file0 = 'image.jpg'
img = cv2.imread(file0)
color = ('b','g','r')
plt.figure()
for i,col in enumerate(color):
    histr = cv2.calcHist([img],[i],None,[256],[0,256])
    plt.plot(histr,color = col)
    plt.xlim([0,256])
plt.show() 
```

[![在此处输入图像描述](../Images/670d1edb09afc0326646e398bbf7504c.png)](https://i.stack.imgur.com/HFcoX.png)

# sublimetext2 - 在崇高文本中重新缩进快捷方式

> ID：12182896
> 
> 赞同：64
> 
> 时间：2012-08-29T16:54:39.733
> 
> 标签：sublimetext2, sublimetext

> **可能重复：**
> [在 Sublime 文本 2 中缩进代码？](https://stackoverflow.com/questions/9495007/indenting-code-in-sublime-text-2)

我正在尝试在 Sublime 中学习键盘快捷键。Sublime Text 2 中用于重新缩进的键盘快捷键是什么？根据某些页面，它应该`TAB`只是缩进，而不是重新缩进。

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2012-10-23T11:53:39.740

您可以在 中找到它`Edit>>Line>>Reindent`，但默认情况下它没有快捷方式。您可以通过转到菜单 Preferences - Keybindings-User 添加快捷方式，然后在此处添加（配置文件采用 JSON 格式）：

```
[
    { "keys": ["f12"], "command": "reindent"} 
] 
```

（使用该`F12`功能的密钥的示例）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-30T05:18:12.377

我使用`cmd-[`and`cmd-]`缩进，但我不确定你所说的“reindent”是什么意思......

啊，好的，我现在得到您的问题，您可以使用该命令重新计算并对文件应用正确的缩进。例如，如果您打开一个已经以编程方式更改并删除了空格或删除了制表符的文件，您将使用 reindent 命令恢复正确的格式。

# postgresql - 关注 Heroku 的外部数据库

> ID：12182899
> 
> 赞同：2
> 
> 时间：2012-08-29T16:55:00.030
> 
> 标签：postgresql, heroku, migration

是否可以将在 EC2 中运行的 Postgres 9.1 数据库配置为 Heroku Postgres 追随者数据库的源？换句话说：

```
$ heroku config:set MY_DATABASE_URL=postgres://my_user:my_pass@my_ec2_server:5432/my_db
$ heroku addons:add heroku-postgresql:ronin --follow MY_DATABASE_URL 
```

源数据库需要哪些设置才能实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T21:57:40.993

不，对不起，不可能。我们只能分叉或遵循我们提供的数据库。

# javascript - JQuery Mega 菜单全宽菜单项

> ID：12182902
> 
> 赞同：0
> 
> 时间：2012-08-29T16:55:13.020
> 
> 标签：javascript, jquery, css

我是 css 和 jquery 的新手，菜单项有问题。我有一个 Jquery Mega 菜单，我想让 Attorney Profile 菜单项是 1 行而不是现在的两个。通常我会发布代码，但代码太多了。因此，我将发布一个指向实际工作站点的链接。

**我尝试添加全角但没有成功。**

```
$(document).ready(function($){
    $('#mega-menu-tut').dcMegaMenu({
        rowItems: '1',
        speed: 'fast'
        fullWidth: true
  });
 }); 
```

**我也尝试在这里修改css：**

```
.dcjq-mega-menu ul.menu li .sub li.mega-hdr { /* Sub-menu headers - i.e. 2nd level navigation */
     float: left; /* Float the sub-menus and give them a fixed width to from the mega menu    rows */
     width: 130px; 
     height: 165px;
     margin: 0 2px 7px 2px;
     border: 3px solid #ccc;
} 
```

但这只是修改了实际的内部菜单。

**这是活动站点： http:** [//gdisinc.com/barker/default.php](http://gdisinc.com/barker/default.php)

请注意，如果您将鼠标悬停在“律师简介”上，它将显示两行。我怎样才能使这一行与网站的宽度相匹配，即 960 像素。谢谢！

**PS：我使用了这个菜单系统： http: [//www.designchemical.com/lab/jquery-mega-drop-down-menu-plugin/getting-started/](http://www.designchemical.com/lab/jquery-mega-drop-down-menu-plugin/getting-started/)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:19:58.147

您可以更改此样式的填充

```
.dcjq-mega-menu ul.menu li a 
```

至

```
padding:12px 20px; 
```

中的元素具有基于其内容的宽度，因此减小导航项的字体大小也可以。使用 Chrome 的 Web Inspector / Firefox 的 Firebug 等可以轻松找到此类问题的修复程序。

在联系我们选项卡之后没有小分隔线可能会很好。您可以通过添加这样的 :last-child 类来实现这一点：

```
.dcjq-mega-menu ul.menu li:last-child a { background:none; } 
```

问题是这里的 CSS 选择器可读性不是很好，以后可能会导致非常烦人的问题。如果可以的话，总是将这么长的声明更改为单个类：

```
.last-menu-item { background:none; } 
```

同样，请记住 :last-child 在 Internet Explorer < 9 上不受支持。 [http://caniuse.com/#search=last-child](http://caniuse.com/#search=last-child)

欢迎来到 CSS 的世界...... :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:10:29.750

看起来您需要在此处更改“rowitems”选项：

```
$(document).ready(function($){
  $('#mega-menu-tut').dcMegaMenu({
    rowItems: '3',
    speed: 'fast'
  });
}); 
```

如果将其更改为“5”，则应在同一行上显示所有项目。看看这些例子：

[http://www.designchemical.com/lab/jquery-mega-drop-down-menu-plugin/examples/](http://www.designchemical.com/lab/jquery-mega-drop-down-menu-plugin/examples/)

除非您将菜单拆分为单独的 MegaMenu 实例，否则似乎无法为每个菜单项配置此效果。

# unit-testing - 在 Play 中模拟记录器！2 框架

> ID：12182908
> 
> 赞同：1
> 
> 时间：2012-08-29T16:55:33.333
> 
> 标签：unit-testing, scala, mocking, playframework-2.0, mockito

我有戏！2 应用程序（Scala），我有一些类在遇到错误时需要执行日志记录。

我希望能够对这些日志记录操作实际发生在正确的条件下进行单元测试。为此，我需要能够模拟记录器，但我遇到了 Mockito 的一些问题。我所拥有的（简化的）看起来像

```
import play.api.{ Logger, LoggerLike }

trait BaseService {
  val log: LoggerLike

  def fail(reason: String) {
    log.error(reason)
   }
}

object Service extends BaseService {
  val log = Logger
} 
```

然后在测试中

```
import org.specs2.mutable._
import org.specs2.mock._
import services.BaseService

object Service extends BaseService with Mockito {
  val log = mock[play.api.Logger]

  def verify(key: String) = {
    there was one(log).error(key)
  }
}

class ServiceSpec extends Specification {
  "failures should be logged" in {
    Service.fail("foo")
    Service.verify("foo")
  }
} 
```

但我得到了错误

```
[error]     NullPointerException: null (Logger.scala:43)
[error] play.api.LoggerLike$class.isErrorEnabled(Logger.scala:43)
[error] play.api.Logger.isErrorEnabled(Logger.scala:147)
[error] play.api.LoggerLike$class.error(Logger.scala:127)
[error] play.api.Logger.error(Logger.scala:147)
[error] services.BaseService$class.fail(Service.scala:19)
[error] Service$.fail(ServiceSpec.scala:11)
... 
```

我尝试添加

```
log.isErrorEnabled returns true
log.error(any[String]) returns {} 
```

但随后即使服务的初始化也失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T07:10:20.313

我不是 Mockito 专家，但我认为您的模拟在这里出现故障，因为堆栈跟踪显示了`Logger`正在调用的实际播放方法。这可能是因为您试图在`object`这里模拟 Scala。相反，如果您像这样嘲笑特征

```
 val log = mock[play.api.LoggerLike] 
```

您将克服此特定错误并进入下一个问题 - 您的验证不起作用：

```
[error]   The mock was not called as expected: 
[error] Argument(s) are different! Wanted:
[error] loggerLike.error(
[error]     ($anonfun$apply$mcV$sp$1) <function0>
[error] );
[error] -> at Service$$anonfun$verify$1.apply$mcV$sp(ServiceSpec.scala:10)
[error] Actual invocation has different arguments:
[error] loggerLike.error(
[error]     ($anonfun$fail$1) <function0>
[error] );
[error] -> at services.BaseService$class.fail(x.scala:57)
[error]  (ServiceSpec.scala:17) 
```

这是由于日志消息作为按名称参数（因此是匿名函数）而不是字符串传递的事实引起的，请参阅[此问题](https://stackoverflow.com/questions/2152019/how-to-mock-a-method-with-functional-arguments-in-scala)以进行进一步讨论。

# awk - 使用 awk 从文件中提取特定行

> ID：12182910
> 
> 赞同：11
> 
> 时间：2012-08-29T16:55:57.813
> 
> 标签：awk, line

我有两个文件，一个文件是我的数据，另一个文件是我想从数据文件中提取的行号列表。我可以使用 awk 读取我的行文件，然后提取与行号匹配的行吗？

示例：数据文件：

```
This is the first line of my data
This is the second line of my data
This is the third line of my data
This is the fourth line of my data
This is the fifth line of my data 
```

行号文件

```
1
4
5 
```

输出：

```
This is the first line of my data
This is the fourth line of my data
This is the fifth line of my data 
```

我只使用过命令行 awk 和 sed 来处理非常简单的事情。这超出了我的范围，我已经在谷歌上搜索了一个小时而没有答案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-29T18:59:44.770

```
awk 'NR == FNR {nums[$1]; next} FNR in nums' numberfile datafile 
```

只需引用数组下标即可创建条目。循环遍历第一个文件，while `NR`(record number) 等于`FNR`(file record number) 使用`next`语句将所有行号存储在数组中。之后，当`FNR`数组中存在第二个文件时（true），将打印该行（这是“true”的默认操作）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-29T17:06:44.543

一种方法`sed`：

```
sed 's/$/p/' linesfile | sed -n -f - datafile 
```

您可以使用相同的技巧`awk`：

```
sed 's/^/NR==/' linesfile | awk -f - datafile 
```

### 编辑 - 巨大的文件替代

对于大量的行，将整个文件保存在内存中是不明智的。这种情况下的解决方案可以是对数字文件进行排序并一次读取一行。以下已使用 GNU awk 进行了测试：

*提取.awk*

```
BEGIN {
  getline n < linesfile
  if(length(ERRNO)) {
    print "Unable to open linesfile '" linesfile "': " ERRNO > "/dev/stderr"
    exit
  }
}

NR == n { 
  print
  if(!(getline n < linesfile)) {
    if(length(ERRNO))
      print "Unable to open linesfile '" linesfile "': " ERRNO > "/dev/stderr"
    exit
  }
} 
```

像这样运行它：

```
awk -v linesfile=$linesfile -f extract.awk infile 
```

测试：

```
echo "2
4
7
8
10
13" | awk -v linesfile=/dev/stdin -f extract.awk <(paste <(seq 50e3) <(seq 50e3 | tac)) 
```

输出：

```
2   49999
4   49997
7   49994
8   49993
10  49991
13  49988 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T17:20:06.327

这是一个 awk 示例。预先加载输入文件，然后输出匹配的数据文件记录。

```
awk \
  -v RS="[\r]*[\n]" \
  -v FILE="inputfile" \
  'BEGIN \
   {
     LINES = ","
     while ((getline Line < FILE))
     {
       LINES = LINES Line ","
     }
   }
   LINES ~ "," NR "," \
   {
     print
   }
  ' datafile 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-05T17:31:23.357

我有同样的问题。这是 Thor 已经发布的解决方案：

```
cat datafile \
| awk 'BEGIN{getline n<"numbers"} n==NR{print; getline n<"numbers"}' 
```

如果像我一样您没有数字文件，而是从标准输入传递过来并且您不想生成临时数字文件，那么这是一种替代解决方案：

```
cat numbers \
| awk '{while((getline line<"datafile")>0) {n++; if(n==$0) {print line;next}}}' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-12T12:00:42.387

```
while read line; do echo $(sed -n '$(echo $line)p' Datafile.txt); done < numbersfile.txt 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-03T16:00:40.447

这个解决方案...

`awk 'NR == FNR {nums[$1]; next} FNR in nums' numberfile datafile`

...仅打印数字文件中的唯一数字。如果 numberfile 包含重复的条目怎么办？然后 sed 是一个更好的（但慢得多）的选择：

`sed -nf <(sed 's/.*/&p/' numberfile) datafile`

# ruby - 通过 ruby -e 运行整个脚本的最佳方法

> ID：12182913
> 
> 赞同：0
> 
> 时间：2012-08-29T16:56:12.223
> 
> 标签：ruby, shell

我一直想在远程计算机上运行一些 ruby​​ 脚本（在 bash shell 中）

我可以创建一系列 bash 命令`ruby -e "<command>"`，但其中一些脚本超过 100 行。

`ruby -e`使用 HEREDOC 或`%{}`&`eval()`不适用于单引号和双引号的混合。

有没有更好的方法来尝试这个？

编辑：

使用的协议是 Apple Remote Desktop，它在远程 shell 范围内执行这些命令。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:16:01.363

如果我理解正确，您想通过 SSH 或类似协议在远程机器上运行本地 ruby​​ 脚本。如果脚本是非交互式的（即不需要任何用户输入），您可以在本地创建它并通过`stdin`.

换句话说，首先编写脚本并将其保存在本地，例如`foo.rb`. 然后：

```
ssh remotehost ruby < foo.rb 
```

启动 SSH 会话并执行远程 ruby​​ 解释器。在没有参数的情况下，ruby 解释器从标准输入执行命令，因此我们在标准输入上为 SSH 提供程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T18:33:33.980

这有效：

```
cat << 'EOF' > /tmp/myscript.rb

# ruby script contents go here. any syntax is valid, except for your limit string (EOF)

EOF

ruby /tmp/myscript.rb;
rm /tmp/myscript.rb; 
```

由于这不依赖于解释器二进制文件如何处理标准输入样式的命令，因此它也适用于大多数其他语言（python、perl、php）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T23:58:36.510

由于我*还想*通过 ARD 运行 ruby​​ 脚本（我认为它不能嵌入 ctrl-D），所以我首先认为您*可以*将 joraff 的解决方案（针对他自己的问题）与 Kelvin 的解决方案结合起来：

```
cat << ENDOFSCRIPT | ruby

#Here be code ...

ENDOFSCRIPT 
```

这可以节省创建/删除文件。

## 但是还有一个更好的方法：

事实证明 (duh) ARD 嵌入了一个 EOF，或者只是以其他方式终止它发送的内容，您可以简单地执行以下操作：

```
ruby

#Paste whole script here 
```

至少在 ARD 3.6.1 中有效。赢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:07:40.473

为什么不先将脚本发送过来？

```
scp foo.rb remotehost:
ssh remotehost "ruby foo.rb" 
```

您甚至可以在以下情况下清理文件：

```
ssh remotehost "rm foo.rb" 
```

# ios - NSJSON如何解析

> ID：12182914
> 
> 赞同：1
> 
> 时间：2012-08-29T16:56:19.587
> 
> 标签：ios, json, ios5, viewdidload, nsjsonserialization

我在通过特定的“”获取 json 格式时遇到问题。我可以看到它是一本字典，所以我把字典变成了一个数组是错误的吗？我正在尝试提取“isReserevble=true”的记录，然后根据用户从 UIDatepicker 中选择的时间在表格视图单元格中显示“开始”。json 是通过 NSlog 实现的，但我无法弄清楚这一点。谢谢

看起来我有一堆字典。我还会使用相同的方法吗？

这是我的代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    dispatch_async(kBgQueue, ^{
        NSData* data = [NSData dataWithContentsOfURL: 
                        kLatestKivaLoansURL];
        [self performSelectorOnMainThread:@selector(fetchedData:) 
                               withObject:data waitUntilDone:YES];

    });

}
- (void)fetchedData:(NSData *)responseData {
//parse out the json data

NSError* error;

NSDictionary* json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error];

NSArray* myslots =[json objectForKey:@"slots"];
NSLog(@"allslots: %@", myslots);

  NSMutableArray *datesArray = [[NSMutableArray alloc] init];
for (NSDictionary *slots in json){
    NSLog(@"isReservable = %@",[myslots objectForKey:@"isReservable"]);
    if ([[myslots objectForKey:@"isReservable"]isEqualToString:@"1"]) 
    {
        NSLog(@"begin = %@",[myslots objectForKey:@"begin"]);
        [datesArray addObject:[myslots objectForKey:@"begin"]];
        NSLog(@"slots array count = %d",[datesArray count]);
    }

}
NSLog(@"This is the begin: %@", datesArray);

} 
```

这是我的 NSLog 所有插槽的结果：

```
2012-08-29 11:54:26.531 GBSB[1137:15b03] allslots: {
    "2012-08-29 00:00:00 America/Los_Angeles" =     (
                {
            begin = "2012-08-29 00:00:00 America/Los_Angeles";
            end = "2012-08-29 08:00:00 America/Los_Angeles";
            isPending = 0;
            isReservable = 0;
            isReserved = 0;
            label = "&nbsp;";
            span = 1;
        },
                {
            begin = "2012-08-29 08:00:00 America/Los_Angeles";
            end = "2012-08-29 08:15:00 America/Los_Angeles";
            isPending = 0;
            isReservable = 1;
            isReserved = 0;
            label = "&nbsp;";
            span = 1;
        }
    );
} 
```

好的：这就是我现在得到的

```
2012-08-30 09:28:30.812 GBSB[835:15b03] its a dictionary
2012-08-30 09:28:30.812 GBSB[835:15b03] isReservable = (null)
2012-08-30 09:28:30.812 GBSB[835:15b03] isReservable = (null)
2012-08-30 09:28:30.812 GBSB[835:15b03] isReservable = (null)
2012-08-30 09:28:30.813 GBSB[835:15b03] This is the begin: (
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:31:39.220

错误消息 - 再次 - 有帮助。试着解释一下：

```
-[__NSCFString objectForKey:]: unrecognized selector sent to instance 0x81e1c80 
```

这意味着，您将`objectForKey:`消息发送到 JSON*字符串*对象而不是*解析的 NSDictionary*对象，这就是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:02:09.180

正是这一点给你带来了问题：

```
for (NSDictionary *tempDict in self.json) {
    [datesArray addObject:[tempDict objectForKey:@"slots"]];
} 
```

你认为你在询问`"slots"`你的 JSON 的属性，但你不是，你在询问JSON 中*每个子字典*`"slots"`的属性。

 *试试这个：

```
[datesArray addObject:[self.json objectForKey:@"slots"]]; 
```*

# javascript - Could someone explain to me an error I am getting?

> ID：12182915
> 
> 赞同：0
> 
> 时间：2012-08-29T16:56:24.140
> 
> 标签：javascript, python, ajax, xmlhttprequest

I have a CGI script that imports cgi, makes an accessor function, and then tries to look up variables. The function is:

```
cgi_form = cgi.FieldStorage()

def get_cgi(field, default=''):
    if cgi_form.has_key(field):
        return cgi_form[field].value
    else:
        return default 
```

Which is probably not necessary. But when I try to use it for email, one of the fields I attempted to send from an XHR, it errors out. The line of code triggering the problem is:

```
sys.stderr.write('email: ' + get_cgi('email')) 
```

The Apache log has:

```
[Wed Aug 29 11:25:33 2012] [error] [client ::1] Traceback (most recent call last):, referer: http://localhost/professional/calendar-todo/
[Wed Aug 29 11:25:33 2012] [error] [client ::1]   File "/Users/jonathan/mirror/professional/calendar-todo/create_account.cgi", line 26, in <module>, referer: http://localhost/professional/calendar-todo/
[Wed Aug 29 11:25:33 2012] [error] [client ::1]     sys.stderr.write('email: ' + get_cgi('email')), referer: http://localhost/professional/calendar-todo/
[Wed Aug 29 11:25:33 2012] [error] [client ::1]   File "/Users/jonathan/mirror/professional/calendar-todo/create_account.cgi", line 21, in get_cgi, referer: http://localhost/professional/calendar-todo/
[Wed Aug 29 11:25:33 2012] [error] [client ::1]     if cgi_form.has_key(field):, referer: http://localhost/professional/calendar-todo/
[Wed Aug 29 11:25:33 2012] [error] [client ::1]   File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/cgi.py", line 580, in has_key, referer: http://localhost/professional/calendar-todo/
[Wed Aug 29 11:25:33 2012] [error] [client ::1] TypeError: not indexable, referer: http://localhost/professional/calendar-todo/
[Wed Aug 29 11:25:33 2012] [error] [client ::1] Premature end of script headers: create_account.cgi, referer: http://localhost/professional/calendar-todo/ 
```

The client-side code that I was trying to emulate is:

```
document.getElementById('create_account_button').onclick = function()
    {
    var request = new XMLHttpRequest();
    request.open('POST', 'create_account.cgi');
    request.setRequestHeader('Content-Type', 'text/plain');
    request.send('email=' + encodeURIComponent(document.getElementById('create_email').value) + '&password=' + encodeURIComponent(document.getElementById('create_password').value) +  '&password_hint=' + encodeURIComponent(document.getElementById('create_password_hint').value));
    load_from_request(request);
    return false;
    } 
```

Am I sending things appropriately to the XHR in JavaScript? Why, in Python, is the debugging call to get_cgi('email') giving a "TypeError: not indexable" and what can I do to correct that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:18:04.247

第一个问题是请求标头未设置为`request.setRequestHeader("Content-type","application/x-www-form-urlencoded");`. 对于过早的标题问题，它是相同的概念。在打印任何数据之前，请确保您正在打印内容标题。

```
print "Content-Type: text/html" 
```

通常我会将内容类型打印输出放在代码的顶部，这样我就可以看到任何被发送回浏览器的内容。这样，当您的代码错误出现时，您至少可以看到问题所在。

# java - JUnit : When do I declare a TemporaryFolder object?

> ID：12182916
> 
> 赞同：2
> 
> 时间：2012-08-29T16:56:25.373
> 
> 标签：java, unit-testing, testing, junit, temporary-directory

I am trying to test a method that copies a source file to a dest file using JUnit's `TemporaryFolder`. I get a Java `IOException` when I try run this test however. Does it matter where I make the declaration for the folder? (My test class has several different tests in it). And if so, what is the proper way to do it? I ask because I currently have several unit tests above this code, then I try to set up the testing for the file copying. Maybe the `@Rule`-`@Before`-`@Test` block needs to be in its own class? Here is the snippet where I have coded the test:

```
...other tests...then:

@Rule
public static TemporaryFolder tmp = new TemporaryFolder();
private File f1, f2;

@Before
public void createTestData() throws IOException {
    f1 = tmp.newFile("src.txt");
    f2 = tmp.newFile("dest.txt");

    BufferedWriter out = new BufferedWriter(new FileWriter(f1));
    out.write("This should generate some \n" +
            "test data that will be used in \n" +
            "the following method.");
    out.close();
}

@Test
public void copyFileTest() {

    out.println("file 1 length: " + f1.length());
    try {
        copyFile(f1, f2);
    } catch (IOException e) {
        e.getMessage();
        e.printStackTrace();
    }

    if (f1.length() != f2.length())
        fail();
    else if (!f1.equals(f2))
        fail();
    assertSame(f1, f2);
} 
```

When I run this test class, all 11 of my tests now fail (which previously passed) and I get `java.io.IOException: No such file or directory`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:37:49.790

所以查看[JUnit Javadoc](http://junit-team.github.io/junit/javadoc/4.10/org/junit/Rule.html "JUnit Javadoc")，我发现任何声明都`@Rule`必须是 public 的，而**不是 static**。所以我拿出了静电，只是有：

```
@Rule
public TemporaryFolder tmp = new TemporaryFolder(); 
```

当您的班级中有其他不使用该声明的单元测试时，我仍然不确定在哪里进行此声明是否重要`@Rule`，但这确实让我能够成功地运行我的测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-18T00:12:51.737

如果你真的想将 TemporaryFolder 声明为静态的，你可以使用 @ClassRule 来注释包含 Rule 的静态字段。

```
@ClassRule
public static TemporaryFolder tmp = new TemporaryFolder(); 
```

参考：http: [//junit-team.github.io/junit/javadoc/4.10/org/junit/ClassRule.html](http://junit-team.github.io/junit/javadoc/4.10/org/junit/ClassRule.html)

# jquery - Change image src via jQuery - don't prompt for download

> ID：12182917
> 
> 赞同：1
> 
> 时间：2012-08-29T16:56:28.920
> 
> 标签：jquery, asp.net-mvc-3

I have been working on a way to dynamically change the image src on a webpage. I'm using ASP.NET MVC3 and have an image point to a controller action. This works great for first load. Then I have an upload control and refresh the img src via jquery to load the new image. I call the same controller action as before in the first load.

This work in all browsers except for IE. In IE when I change the image and load via jQuery, I get prompted to download the file.

How can I refresh the image and have my required functionality work in IE?

Thanks!

~ Steve

View:

```
 <img src="@Url.Action("ShowSavedImage", "DisplaySettings")" id="imgLogo" class="ContrainImage" /> 
```

Controller:

```
 public ActionResult ShowCachedImage()
  {        
    return File(user.TempLogoBytes, user.TempLogoContentType);            
  } 
```

JavaScript:

```
 $('#imgLogo').attr('src', '@Url.Content("DisplaySettings/ShowCachedImage/?v=")' + new Date().getTime()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:30:52.870

我发现问题根本不是 img src 刷新。我有一个控制器操作来处理图像保存异步（来自 kendoui 上传控件），它返回一个 JSON 结果，这就是浏览器中弹出的内容。我删除了它，一切正常。

# android - org.codehaus.jackson.map.JsonMappingException: No suitable constructor found for type

> ID：12182924
> 
> 赞同：0
> 
> 时间：2012-08-29T16:57:06.950
> 
> 标签：android, json, rest, parcelable

I'm coding a RESTful client for my AndroidApp. My rest webservice returns me a json and I pasrse it with springfreamwork into java class members. In this way my code is ok. I need to pass parameters from main activity to another one, so I implemented that class(Clinica.class see below) as PARCELABLE following the guide lines. Now app returns me this error

```
 org.springframework.http.converter.HttpMessageNotReadableException: Could not read JSON: No suitable constructor found for type [simple type, class it.stasbranger.clinigomobile.model.Clinica]: can not instantiate from JSON object (need to add/enable type information?)
 at [Source: libcore.net.http.ChunkedInputStream@41346758; line: 1, column: 3]; nested exception is org.codehaus.jackson.map.JsonMappingException: No suitable constructor found for type [simple type, class it.stasbranger.clinigomobile.model.Clinica]: can not instantiate from JSON object (need to add/enable type information?)
 at [Source: libcore.net.http.ChunkedInputStream@41346758; line: 1, column: 3] 
```

this is my Clinica.class

```
public class Clinica implements Parcelable {

        @JsonProperty
        private Integer idclinica;
        @JsonProperty
        private String nome;
        @JsonProperty
        private Long dataRegistrazione;
        @JsonProperty
        private Long version;
        @JsonProperty
        private String referente;
        @JsonProperty
        private String indirizzo;
        @JsonProperty
        private String cap;
        @JsonProperty
        private String telefono;
        @JsonProperty
        private String email;
        @JsonProperty
        private String sitoWeb;
        @JsonProperty
        private Boolean abilitata;
        @JsonProperty
        private Integer valutazione;
        @JsonProperty
        private Double rank;
        @JsonProperty
        private String nomeFatturazione;

        //getters and setters
            .......

        public Clinica (Parcel p){
            boolean[] booleans = new boolean[1];

            this.cap=p.readString();
            this.email=p.readString();
            this.indirizzo=p.readString();
            this.nome=p.readString();
            this.nomeFatturazione=p.readString();
            this.referente=p.readString();
            this.sitoWeb=p.readString();
            this.telefono=p.readString();

            this.idclinica=p.readInt();
            this.valutazione=p.readInt();

            this.dataRegistrazione=p.readLong();
            this.version=p.readLong();

            this.rank=p.readDouble();

            p.readBooleanArray(booleans);
            this.abilitata=booleans[0];
        }

        public int describeContents() {
            return 0;
        }

        public void writeToParcel(Parcel dest, int flags) {
            boolean[] booleans = new boolean[1];
            Arrays.fill(booleans, abilitata);
            dest.writeString(cap);
            dest.writeString(email);
            dest.writeString(indirizzo);
            dest.writeString(nome);
            dest.writeString(nomeFatturazione);
            dest.writeString(referente);
            dest.writeString(sitoWeb);
            dest.writeString(telefono);
            dest.writeInt(idclinica);
            dest.writeInt(valutazione);
            dest.writeLong(dataRegistrazione);
            dest.writeLong(version);
            dest.writeDouble(rank);
            dest.writeBooleanArray(booleans);
        }

        public static final Parcelable.Creator<Clinica> CREATOR = new Creator<Clinica>() {

            public Clinica[] newArray(int size) {
                return new Clinica[size];
            }

            public Clinica createFromParcel(Parcel source) {
                return new Clinica(source);
            }
        };

    } 
```

and this is my Async call to make request

```
......
Clinica data[] = restTemplate.getForObject(urls[0], Clinica[].class, vars); 
```

Any suggestions? Thanks in advance.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T12:58:52.140

The answer is simple: remove the constructor (also in parent class, if there is any inside) and everything will work! Maybe there is some annotation like @JsonIgnore, but it not work with constructors.

# ubuntu - How to format large USB external drive to FAT32 for Ubuntu

> ID：12182925
> 
> 赞同：-2
> 
> 时间：2012-08-29T16:57:31.723
> 
> 标签：ubuntu, backup, usb-drive, fat32

I am trying to help a friend back up some files to an external USB drive from a machine running Ubuntu. The drive is a 1.36 TB big and is using NTFS. From what I can tell I need to reformat it to FAT32\. But FAT32 does not seem to be able handle a drive that big.

I tried `mkfs -t vfat` but it still shows as NTFS on the Ubuntu machine. Which is funny because when I plug it into my Windows 7 machine to format it there it shows up as FAT32\. I also tried SwissKnife but it only offered me FAT16 - I want FAT32.

What can I do?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:12:37.373

当您手动将驱动器重新安装为 vfat 时会发生什么？

```
umount /MOUNTPOINT
mount -t vfat -v /dev/sdXX /MOUNTPOINT 
```

# c# - Linq to SQL to Linq compiled performance

> ID：12182926
> 
> 赞同：2
> 
> 时间：2012-08-29T16:57:34.030
> 
> 标签：c#, performance, linq

```
string id = (from c in context.Users
             where c.u_id == Id
             select c.u_id).SingleOrDefault(); 
```

1)How i can improve the performance for the above using Linq complied query for the above. We are limited to use .NET 3.5 only.

2)What will be performance gain using a complied linq query for the above code in terms of percentage?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T17:06:26.580

您将通过以下方式创建编译的查询：

```
Func<YourContextType, int, string> query = CompiledQuery.Compile(
       (YourContextType context, int id) => 
           context.Users.Where(u => u.u_id == id).Select(u => u.u_id)
                  .SingleOrDefault()
       ); 
```

然后，您将其用作：

```
string resultId = query(context, Id); 
```

至于性能增益，这可能很重要，但也可能很小。这实际上取决于执行查询的速度，以及重用已编译查询的频率。在许多情况下，使用 cmopiled 查询实际上更慢，因为编译的开销并不能弥补速度的提升。您需要衡量以确定这是否值得付出努力。

`FirstOrDefault()`请注意，如果您知道您只有一个唯一 ID，您还可以仅通过使用而不是来加速原始查询`SingleOrDefault()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T17:20:24.583

一个厚颜无耻的选择是：不要将 LINQ 用于这种微不足道但对性能至关重要的操作。例如，使用 dapper-dot-net：

```
string id = connection.Query<string>(
    @"select u_id from Users where u_id = @id",
    new { id = Id }).SingleOrDefault(); 
```

它完全避免了所有 LINQ 抽象，直接依赖于数据库（完全无参数等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T17:05:51.950

像这样声明你编译的查询：

```
static readonly Func<ENTITIES, YOUR_ID_TYPE, RETURN_VALUE_TYPE> compiledQuery  =
CompiledQuery.Compile<ENTITIES, YOUR_ID_TYPE, RETURN_VALUE_TYPE>(
(ctx, Id) => (from c in ctx.Users
where c.u_id == Id
select c.u_id).SingleOrDefault(); 
```

然后在您的代码中调用您编译的查询：

```
RETURN_VALUE_TYPE results = compiledQuery.Invoke(context, Id); 
```

关于性能改进可能取决于几件事，但是请记住，在 LINQ 查询执行范围内，查询编译是该过程中昂贵的部分。任何时候将 LINQ 查询逻辑添加到基于 LINQ to SQL 或 Entity Framework 的应用程序中，都应该考虑预编译查询并重用它们。

# xna - How to share collision layer to every objects?

> ID：12182929
> 
> 赞同：1
> 
> 时间：2012-08-29T16:57:39.397
> 
> 标签：xna, 2d, collision-detection, collision

Currently, each level has 3 layers :

*   background
*   collisions(walls, invisible walls, ground, etc)
*   foreground

My character sprite has 1 pixel to detect the collision. In this character class, there is a Color[] contains every pixels of the collision layer.

I calculate the position of the Character's pixel detection, and obtain an int that i can use with the `Color[]` ("CharactersPixel")

```
if ( Color[CharactersPixel].A != 0 )
    Then collision. 
```

It works perfectly.

But the collision layer has to be used by every others objects like particles, monsters etc.

The collision layer has about 3.800.000 pixels. so the `Color[]` has the same.

If I add this `Color[]` to every objects, this will use too much RAM, right ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:36:23.130

您只需向对象添加对碰撞层的*引用。*您不会将整个内容复制到每个对象。添加引用不会为您的对象增加太多内存。

但是，我建议通过在任何对象可访问的地方公开一些关卡数据，以更一般的方式使碰撞可用。也许您可以将数据作为可访问属性添加到您的类`Game`中。`CurrentLevel``CollisionData`

通常，您将碰撞数据与实际渲染颜色分开，并使用框等执行更简单的碰撞，而不是近似匹配碰撞数据的形状。这最终将使计算诸如影响环境的角度和计算适当的物理场之类的事情变得更容易。像素到像素的冲突很少见，从性能角度来看也可能存在问题。

# mongodb - 索引嵌入式数组的效率

> ID：12182930
> 
> 赞同：-1
> 
> 时间：2012-08-29T16:57:41.240
> 
> 标签：mongodb

我目前正在为一个用例评估不同数据库的效率。在 Mongodb 中，想要存储大约 100 万个具有以下结构的对象。每个对象将在 foo 数组中有 5 到 10 个对象。

```
{
   name:"my name",
   foos:[
      {
         foo:"...",
         bar:"..."
      },
      {
         foo:"...",
         bar:"..."
      },
      {
         foo:"...",
         bar:"..."
      }
   ]
} 
```

我经常需要搜索 foos 集合包含具有特定属性的对象的对象，例如：

```
// mongo collection
[
   {
      name:'my name',
      foos:[
         {
            foo:'one_foo',
            bar:'a_bar'
         },
         {
            foo:'two_foo',
            bar:'b_bar'
         }
      ]
   },
   {
      name:'another name',
      foos:[
         {
            foo:'another foo',
            bar:'a_bar'
         },
         {
            foo:'just another foo',
            bar:'c_bar'
         }
      ]
   }
]

// search (pseudo code)
{ foos: {$elemMatch: {bar: 'c_bar'}} }
// returns
{
      name:'another name',
      foos:[
         {
            foo:'another foo',
            bar:'a_bar'
         },
         {
            foo:'just another foo',
            bar:'c_bar'
         }
      ]
   } 
```

这可以用 mongo 有效地完成吗？应该如何设置索引？我不想让你为我评估性能，只是想知道 mongo 对我的用例的执行情况或优化的样子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:30:15.537

MongoDB 有文档解释如何通过点符号在嵌入式文档上创建索引：

[点符号（触及对象）](http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29)

```
> db.blogposts.findOne()
{ title : "My First Post", author: "Jane",
  comments : [{ by: "Abe", text: "First" },
              { by : "Ada", text : "Good post" } ]
}
> db.blogposts.find( { "comments.by" : "Ada" } )

> db.blogposts.ensureIndex( { "comments.by" : 1 } ); 
```

至于性能特征......只需使用您的数据集进行测试。

# php - Retrieve data from a link in php

> ID：12182931
> 
> 赞同：2
> 
> 时间：2012-08-29T16:57:52.050
> 
> 标签：php, variables

I have a popup php page that contains this link within the php file (not the browser):

[http://mydomain.com/member.php?id=75](http://mydomain.com/member.php?id=75)

how can I get the id value only to define another variables for the users on that page?

I used the $_SERVER['HTTP_REFERER']; to get the link where user came from.

many thanks,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:02:22.270

您可以只使用`$getId = explode("=", $_SERVER['HTTP_REFERRER']);` Then set `$id = $getId[1]`（因为数字将成为数组的第二个位置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:18:22.590

在这里试试这个代码：

```
$query=parse_url($_SERVER['HTTP_REFERER'], PHP_URL_QUERY);
$REFERER_GET=array();
foreach(explode('&', $query) as $kv) {
    list($key,$value)=explode('=', $kv);
    $REFERER_GET[$key]=$value;
}
echo($REFERER_GET['id']); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T17:10:13.507

url 中的 id 是 URL 参数，可以使用 $_GET 变量提取。

只需尝试打印 $_GET 变量。并选择 id 的值为 ($_GET["id"].

# c# - DateTime from XLS to C# conversion failure

> ID：12182935
> 
> 赞同：1
> 
> 时间：2012-08-29T16:58:12.130
> 
> 标签：c#, excel, date, type-conversion

I'm working on VS2008 .NET3.5 with a Office 2003 doc (.xls). I'm using Microsoft.Office.Interop.Excel to access to a document.

This works fine for my purpose but fails whenever I try to get a Date.

The way I'm using is the most common:

```
object date= xlWorkSheet.get_Range("E" + i, "E" + i).Value2;
double doubleDate = double.Parse(date);
DateTime finallyDate = DateTime.FromOADate(doubleDate); 
```

The date I have stored is 01/12/1961 (in Italian means first december and if I open excel it tolds me 1 december 1961).

When I run my app it happens that the value of the double become 15011.0 and when the finallyDate value is 2/4/1941 that's not right!

How can I solve this problem? Is there any way to convert (also manually) that 15011 number?

Thank you!!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:00:04.550

获取 Value 属性而不是 Value2，然后您将能够使用 Date 对象。您可能需要将其转换为 (DateTime)。

使用 Value2 得到的是 Date 的浮点值。

例如，查看下面的电子表格，其中 A1 包含日期：

![电子表格](../Images/3d523d7f247661f5c1c60858801c831e.png)

然后在 Excel 中，添加对 Microsoft.Office.Interop.Excel 的引用，并像这样获取 Value 和 Value2 属性：

```
var excel = new Excel.Application();

var workbook = excel.Workbooks.Open(@"C:\Test\Test.xlsx");
var worksheet = (Excel.Worksheet)workbook.Sheets[1];

Excel.Range range = worksheet.get_Range("A1");

var rangeAsValue = range.Value;
var rangeAsValue2 = range.Value2;

Console.WriteLine(rangeAsValue);
Console.WriteLine(rangeAsValue2);

Console.ReadLine(); 
```

我得到这个输出：

![输出](../Images/3f4bd47c02fb283139439bd6bcb4aa7d.png)

有趣的是，如果您在 .Net 4.5 应用程序中尝试此操作，它仍然有效，但类型`var`被解析为动态的`rangeAsValue`and `rangeAsValue2`，并且您失去了智能感知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:37:53.513

对于您问题的第一部分，*我该如何解决这个问题？*

确保

1.  文档已保存。
2.  您正在访问正确的单元格。

对于问题的第二部分，*有没有办法（也可以手动）转换 15011 号码？*

15011 实际上是从 1-1-1900 的天数。我通常只是将提到的数字除以 365 以获得*粗略*的日期。你会问为什么粗糙？因为有些年份有 366 天，我们需要考虑闰年。

如果您需要使用序列号准确计算日期，您可能需要使用此处找到的方法。[http://naspinski.net/post/Translate-an-Excel-Serial-Date-into-aC-DateTime.aspx](http://naspinski.net/post/Translate-an-Excel-Serial-Date-into-a-C-DateTime.aspx)

```
public DateTime ExcelSerialDateToDT(int nSerialDate)
 {
 int l = nSerialDate + 68569 + 2415019;
 int n = ((4 * l) / 146097);
 l = l - ((146097 * n + 3) / 4);
 int i = ((4000 * (l + 1)) / 1461001);
 l = l - ((1461 * i) / 4) + 31;
 int j = ((80 * l) / 2447);
 int nDay = l - ((2447 * j) / 80);
 l = (j / 11);
 int nMonth = j + 2 - (12 * l);
 int nYear = 100 * (n - 49) + i + l;

return DateTime.Parse(nMonth + "/" + nDay + "/" + nYear);
 } 
```

[您可以在http://www.codeproject.com/Articles/2750/Excel-serial-date-to-Day-Month-Year-and-vise-versa](http://www.codeproject.com/Articles/2750/Excel-serial-date-to-Day-Month-Year-and-vise-versa)上阅读更多关于 Microsoft Office Excel 上出现这种行为的原因

# php - How do I use "If statement" in echo function for PHP

> ID：12182940
> 
> 赞同：2
> 
> 时间：2012-08-29T16:58:17.687
> 
> 标签：php, if-statement, echo

For example, I would like to print total classes in the school

If.. that course has only one class, it will print "Total 1 Class" but if there are many classes in that course, it will print "Total 15 Classes"

So, I want to use syntax like

```
<?php echo "Total ".$attendance_setting->class_number.  
 if($attendance_setting->class_number==1) {echo " Class";} else {echo "
 Classes";} ?> 
```

Is it possible or I have to use If statement before I print it.

Thank you

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:08:18.540

我只是在回显语句之前执行 if 语句，如下所示：

```
<?php 

if($attendance_setting->class_number==1) {
    $class = " Class";
}
else {
    $class = " Classes";
} 

echo "Total " . $attendance_setting->class_number . $class;

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:01:04.343

尝试关注

```
echo class_number.($attendance_setting->class_number==1)?'class':'classes'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T17:01:52.490

您可以为此使用三元运算：

```
echo "Total " . $attendance_setting->class_number . " ";
echo ($attendance_setting->class_number > 0)
     ? echo "Classes"
     : echo "Class"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T17:14:28.953

您也可以使用 switch() 语句

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T17:05:06.267

我一般定义一个这样的函数。

```
function add_plural_s($int=0){
    return $int > 1 ? 's' : '';
} 
```

然后我写如下：

```
echo 'Class'.add_plural_s($attendance_setting->class_number); 
```

`Class`如果不应该是复数并且如果应该是复数，则打印`Classs`。

但是，我刚刚意识到，在您的情况下，它不会像我定义的函数那样工作，因为您需要的不仅仅是`s`. 但是你还是明白了。

# objective-c - How to substract string correctly?

> ID：12182942
> 
> 赞同：0
> 
> 时间：2012-08-29T16:58:27.870
> 
> 标签：objective-c, nsstring, substring, nsrange

i've got two strings in two objects:

```
&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://farm9.staticflickr.com/8448/7882675644_76605a2a3d_b.jpg&quot; border=&quot;0&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;&lt;

&lt;img src=&quot;http://farm9.staticflickr.com/8425/7881940452_d2a8e898a3_o.png&quot; border=&quot;0&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;&lt; 
```

And i'm trying to substract link to image.

i get link by using object method:

```
NSMutableString *string = [NSMutableString stringWithString:description];

int left = [string rangeOfString:@"http://"].location;

int right = 0;

if ([string rangeOfString:@".jpg"].location != NSNotFound) {
    right = [string rangeOfString:@".jpg"].location;
}
else if ([string rangeOfString:@".png"].location != NSNotFound){
    right = [string rangeOfString:@".png"].location;
}

NSString *sub = [string substringWithRange:NSMakeRange(left, right)];

NSLog(@"%@",sub); 
```

but the problem is when i print what i substract:

```
2012-08-29 18:53:30.716 MyApple[56335:c07] http://farm9.staticflickr.com/8448/7882675644_76605a2a3d_b.jpg" border="0" alt="" /></di
2012-08-29 18:53:30.717 MyApple[56335:c07] http://farm9.staticflickr.com/8425/7881940452_d2a8e898a3_o.png" bord 
```

IMO i substract from http:// to .jpg or .png, but it's not working correctly.

Thanks for help.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T17:09:07.657

的第二个参数`NSMakeRange()`是*长度*，所以你可能需要

```
NSString *sub = [string substringWithRange:NSMakeRange(left, right - left)]; 
```

你也应该看看`NSRegularExpression`！

# php - html quotations mix up with php

> ID：12182943
> 
> 赞同：2
> 
> 时间：2012-08-29T16:58:29.620
> 
> 标签：php, javascript, html, if-statement

I got some html code

```
<?php 
    if($loggedIn){
       echo "<div id='navigation'>
            <ul>
                <li>
                    <a href='javascript:toggleLayer('video');'>Global</a>
                </li>
                <li>
                    <a href='javascript:toggleLayer('info');'>About</a>
                </li>
                <li>
                    <a href='javascript:toggleLayer('register_main');'>Join!</a>
                </li>
            </ul>
        </div>"}; 
```

But when I click on the url's on the website, they happen not to execute the javascript code. after inspectiong one of the elements I found out that

```
<a video');'="" href="javascript:toggleLayer(">Global</a> 
```

is the code generated, which is wrong ofcourse.

My only clue would be that it should be

```
 <a href="javascript:toggleLayer('video');">Global</a> 
```

Though i have no clue how to fix that inside the echo, because it has to be in between the if-statement

Thanks in advance!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:01:51.457

代替：

```
<?php if($loggedIn){
   echo "<div id='navigation'>
        <ul>
            <li>
                <a href='javascript:toggleLayer('video');'>Global</a>
            </li>
            <li>
                <a href='javascript:toggleLayer('info');'>About</a>
            </li>
            <li>
                <a href='javascript:toggleLayer('register_main');'>Join!</a>
            </li>
        </ul>
    </div>"}; ?> 
```

和：

```
<?php if($loggedIn){ ?>
    <div id="navigation">
        <ul>
            <li>
                <a href="javascript:toggleLayer('video');">Global</a>
            </li>
            <li>
                <a href="javascript:toggleLayer('info');">About</a>
            </li>
            <li>
                <a href="javascript:toggleLayer('register_main');">Join!</a>
            </li>
        </ul>
    </div>
<?php } ?> 
```

在字符串中使用引号时`" I said "Hello" "`。您需要转义匹配的周围引号，例如：`" I said \"Hello\" "`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:01:31.270

尝试这个

```
...
<a href='javascript:toggleLayer(\"video\");'>Global</a>
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T17:05:04.857

问题是你的引号。您必须转义`<a>`为您的 javascript 函数设置参数的标签内的那些，例如“视频”

# c# - Ajax post returns other page instead of json

> ID：12182944
> 
> 赞同：0
> 
> 时间：2012-08-29T16:58:38.960
> 
> 标签：c#, ajax, asp.net-mvc, json, exception-handling

I am trying to post serialized data through ajax post to an action and it should return all the model errors through JSON. I have developed sample project and it is returning model errors in json format as I expected. But when I tried to apply the same thing in my project, instead of returning json result, it is returning a page where I have requested.

```
$.ajax(
{
    url: action,
    type: "POST",
    cache: false,
    dataType: "json",
    data: jsonSerializedData,
    success: function (result) {
        getValidationSummary($('#titleseparator')).html('');
        callback(result);
    },
    error: function (error, errorCode) {
        if (error.status == '530') {
            alert(error);
        }
        else if (error.status = '400' && error.responseText != '') {
            var jsonResponse = jQuery.parseJSON(error.responseText);

          //error.responseText should return json result but it returns a page with full view(which is the current page where I have requested)
        }
        else {
            alert(error);
        }
    }
}); 
```

**Action:**

```
[HttpPost]
[HandleModelState]
public ActionResult CreateEmployee(Employee emp)
{

    if (emp.Name.Length <= 5)
        ModelState.AddModelError("Name", "Name should contain atleast 6 characters");
    if (emp.Address.Length <= 10)
        ModelState.AddModelError("Address", "Address should contain atleast 11 characters");

    if (!ModelState.IsValid)
    {
        ModelState.AddModelError(string.Empty, "Please correct errors");
        throw new ModelStateException(ModelState);
    }
     return json();
} 
```

**Model State Action Filter:**

```
public sealed class HandleModelState : FilterAttribute, IExceptionFilter
{
    /// <summary>   
    /// Called when an exception occurs and processes <see cref="ModelStateException"/> object.   
    /// </summary>  
    /// <param name="filterContext">Filter context.</param>  
    public void OnException(ExceptionContext filterContext)
    {
        if (filterContext == null)
            throw new ArgumentNullException("filterContext");

        if (filterContext.Exception != null
            && typeof(ModelStateException).IsInstanceOfType(filterContext.Exception)
            && !filterContext.ExceptionHandled)
        {
            filterContext.ExceptionHandled = true;
            filterContext.HttpContext.Response.Clear();
            filterContext.HttpContext.Response.ContentEncoding = Encoding.UTF8;
            filterContext.HttpContext.Response.HeaderEncoding = Encoding.UTF8;
            filterContext.HttpContext.Response.TrySkipIisCustomErrors = true;
            filterContext.HttpContext.Response.StatusCode = 400;
            var errors = (filterContext.Exception as ModelStateException).Errors;
            filterContext.Result = new JsonResult
          {
              Data = new
              {
                  HasErrors = errors.Count > 0,
                  Errors = errors.Select(e => new { Name = e.Key, Error = e.Value });
              }
          };
        }
    }
} 
```

Please note that the above code working fine in my sample project but it is not working in my live project. I check web.config and everything is same.

***The following is the content I found in error.responseText:***

> Error Found The application has encountered an error, this may be that the page you requested does not exist, if you typed in the url please check that the url is correct. In any case it has suffered and irrevocable, fatal and otherwise irrecoverable error.
> 
> Click [Here] to continue.
> 
> Demos.SupplierPortal.Web.UI.ModelStateException: Experience Required Please provide Years of Experience at Demos.SupplierPortal.Web.UI.Controllers.SkillController.AddSkill(SkillsViewModel item) in E:\Demos\SP\CodeBase\SupplierPortal\Demos.SupplierPortal.Web.UI\Controllers\SkillController.cs:line 152 at lambda_method(Closure , ControllerBase , Object[] ) at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) at System.Web.Mvc.ControllerActionInvoker.<>c_*DisplayClass15.b*_12() at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass15.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName).Message

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T06:27:32.693

我得到了答案。我的控制器继承自处理异常的基本控制器（受保护的覆盖无效 OnException（ExceptionContext filterContext））。所以，我在这里检查了我的自定义异常，并告诉它不要处理它。

# java - Printing arrays: memory address or its content?

> ID：12182946
> 
> 赞同：1
> 
> 时间：2012-08-29T16:58:41.410
> 
> 标签：java, arrays, vector

Can you explain why this code

```
int[] test={0,0,0,0,0};
System.out.println(test); 
```

prints something like [I@42e816 (perhaps memory address) but this code

```
 Stack<Integer> stack = new Stack<Integer>();
 stack.push(1);
 stack.push(3);
 stack.push(5);
 stack.push(2);
 stack.push(4);
 System.out.println(stack); 
```

prints "[1, 3, 5, 2, 4]"? What's the difference?

If Stacks derive from Vectors and Vectors from arrays, what's the cause of this different behavior?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T17:01:55.137

这些集合有一个定义明确的 toString() 方法，但是数组被遗忘了恕我直言，并使用默认的 Object.toString() 以及来自 Object 的许多其他默认方法，这些方法也不是很有用。您需要调用后来添加的许多帮助类之一，以使数组更有用。

```
System.out.println(Arrays.toString(test)); 
```

十六进制是对象的默认 hashCode() 而不是地址。它可能不是唯一的，即使数组在内存中移动，这个数字也不会改变。

对于数组的帮助类

```
java.lang.reflect.Array
java.util.Arrays
java.lang.System.arraycopy(); // one method 
```

额外的

```
org.apache.commons.lang.ArrayUtils
org.uispec4j.utils.ArrayUtil
toxi.util.datatypes.ArrayUtil
net.sf.javaml.utils.ArrayUtils
com.liferay.portal.kernel.util.ArrayUtil 
```

还有很多。

并非数组不应该有自己的方法，而是有太多可供选择的方法。;)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T17:00:35.267

Stack 有一个重写的 toString() 方法，它遍历每个元素并打印它们，因此您会看到格式化的打印。

您可以使用`Arrays.toString(test)`格式化的方式打印数组的内容。到目前为止，您正在对数组对象执行 toString 而不是它的内容。

您可以参考[此](https://stackoverflow.com/questions/7060016/why-does-the-tostring-method-in-java-not-seem-to-work)内容来了解​​数组对象的默认 toString() 实现，从而了解您在打印测试数组时注意到的输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T17:04:43.147

`Stack`> `Vector`> `AbstractList`> `AbstractCollection`。

`AbstractCollection`定义`toString()`，这是被调用`System.out.println`以获取字符串表示形式。

`int[]`不是这些对象类型之一 - 它是本机数组，因此它使用`toString`Object 类中的默认实现。

# ms-access - 如何在 Access vba 中搜索、查找和过滤

> ID：12182955
> 
> 赞同：0
> 
> 时间：2012-08-29T16:59:08.773
> 
> 标签：ms-access, search, filter, vba

在我的 Access 数据库中，我正在尝试执行非常复杂的搜索和查找例程。基本上，我在这四个表中要查找 4 个标准：日期、服务、代码和功能。

有了这些信息，我进入一个表格，并在一个字段中搜索一个标准。在找到对应于 4 个条件之一的行后，我为所有正确匹配的行保存相邻字段的值。在此之后，我想将所有相邻字段的值保存为一个数组。然后重复这些步骤，我打算将所有 4 个搜索保存为 4 个单独的数组。

我的表的关系如下：

![表关系](../Images/1a8fe1663ad9e1966c6392611bf6b074.png)

我收到一个“需求”，它是一个请求，该请求中有四个标准：日期、服务、代码和功能。

在“Services_YES”表中，我查找与需求对应的**服务。**

在“Pool_Personnel”表中，我查找**与**需求相对应的功能。

在“Days_Available”表中，我查找与需求相对应的**日期**和**代码**（称为 Code_Horaire）。

从那里，我希望为找到的所有结果记录每个 Code_Personal，然后在所有 3 个表中找到匹配的 Code_Personal。

* * *

所以我的问题：

我如何进行搜索和查找函数，该函数为与条件行对应的所有代码创建一个数组？

我创建了伪代码来帮助解释，以防有人可以将其*翻译*成真正的 VBA：

```
While demandeTable.functionField.Value = poolpersonnelTable.Fonction1Field.Value
  get all poolpersonnelTable.codepersonalField.Value for all rows that match
  save fonctionArray = codepersonalField.Values
Loop 
```

我非常坚持如何完成这种“过滤”，并非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:33:32.093

使用 VBA 不是答案。

我最终创建了一个查询，并使用用户输入的文本来填写查询的可变部分：

```
comboService = Chr(34) & Me.Combo8.Value & Chr(34)
txtDate = Chr(34) & Me.Text15.Value & Chr(34)
comboCodeHoraire = Chr(34) & Me.Combo17.Value & Chr(34)

"SELECT tblPoolPersonnel.LName, tblPoolPersonnel.FName, tblPoolPersonnel.[Tel Natel], tblPoolPersonnel.[Tel Home], tblPoolPersonnel.Email" & vbCrLf
"FROM ((tblPoolPersonnel INNER JOIN tblFonction ON tblPoolPersonnel.Code_Personal = tblFonction.Code_Personel) INNER JOIN tblDayAvailable ON tblPoolPersonnel.Code_Personal = tblDayAvailable.Code_Personal) INNER JOIN tblServiceYES ON tblPoolPersonnel.Code_Personal = tblServiceYES.Code_Personal" & vbCrLf
"WHERE (((tblServiceYES.Service)=" & comboService & ") AND " + _
                "((tblDayAvailable.Availability)=True) AND " + _
                "((tblDayAvailable.Date)=" & txtDate & ") AND " + _
                "((tblDayAvailable.CodeHoraire1)=" & comboCodeHoraire & "))" 
```

# css - 第 n 个子选择器

> ID：12182958
> 
> 赞同：1
> 
> 时间：2012-08-29T16:59:21.650
> 
> 标签：css

在[此页面上](http://www.festivals.ie/festival/show/1)，我想将每张艺术家照片交替向左和向右旋转。我用来执行此操作的选择器是

```
.artistsList img:nth-child(2n+1) {
    -moz-transform: rotate(-4deg);
}

.artistsList img:nth-child(2n) {
    -moz-transform: rotate(4deg);
} 
```

但是由于某种原因，第一条规则被应用于所有图像，所以它们都被旋转到左边。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T17:03:53.687

这是因为您拥有的 HTML 结构。每个图像都是其父级的第一个子级。这些选择器应该更适合您：

```
.artistsList div.artistEntry:nth-child(odd) img { ... }
.artistsList div.artistEntry:nth-child(even) img { ... } 
```

# vba - 如何选择文件夹中的所有 .csv 文件，然后通过 VBA 编码将它们导入

> ID：12182959
> 
> 赞同：1
> 
> 时间：2012-08-29T16:59:31.440
> 
> 标签：vba, excel

我是 VBA 的新手，我正在尝试自动化一个将特定文件夹中的 4 个 .csv 文件导入 SQL 数据库的过程。我有一个代码，其中有 4 个命令按钮，在每个 4 个中，我选择文件，然后将它们导入 SQL。但是，我想知道是否有一种方法可以让我只有一个命令按钮，从该特定文件夹中选择所有 .csv 文件，然后将它们导入 SQL。假设文件夹名称为以下路径中的数据库：Y:\Data\Database

我有以下导入按钮代码，可将本地路径转换为 ​​SQL 服务器路径以及所有其他类型的函数以将数据导入 SQL 服务器。（fName1...fName4 是用户当前选择的 4 个文件路径的 TextBox 值）

```
Private Sub ImportButton_Click()
Dim fName1 As String
Dim fName2 As String
Dim fName3 As String
Dim fName4 As String
Dim perc As Single

Dim index As Integer
Dim subStr As String
Dim sqlStr As String
sqlStr = "E:\Analytics\"

'Convert the local path to SQL server path
fName1 = TextBox1.Value
index = InStr(1, fName1, "\")
subStr = Left(fName1, index)
fName1 = Replace(fName1, subStr, sqlStr, , 1)

fName2 = TextBox2.Value
index = InStr(1, fName2, "\")
subStr = Left(fName2, index)
fName2 = Replace(fName2, subStr, sqlStr, , 1)

fName3 = TextBox3.Value
index = InStr(1, fName3, "\")
subStr = Left(fName3, index)
fName3 = Replace(fName3, subStr, sqlStr, , 1)

fName4 = TextBox4.Value
index = InStr(1, fName4, "\")
subStr = Left(fName4, index)
fName4 = Replace(fName4, subStr, sqlStr, , 1)

'Modify the text captions for test purpose
TextBox1.Value = fName1
TextBox2.Value = fName2
TextBox3.Value = fName3
TextBox4.Value = fName4

Dim cnPubs As ADODB.Connection
Dim cmd As ADODB.Command

' Create a connection object.
Set cnPubs = New ADODB.Connection

' Provide the connection string.
Dim strConn As String

'Use the SQL Server OLE DB Provider.
strConn = "PROVIDER=SQLOLEDB;"

'Connect to the Pubs database on server hcdcd-actstat01 .
strConn = strConn & "DATA SOURCE=hcdcd-actstat01;INITIAL CATALOG=Analytics;"

'Use an integrated login.
strConn = strConn & " INTEGRATED SECURITY=sspi;"

'Now open the connection.
cnPubs.Open strConn

Set cmd = New ADODB.Command
cmd.ActiveConnection = cnPubs
cmd.CommandType = adCmdStoredProc
cmd.CommandText = "dbo.Proc_CapitalAllocation_Step1"
cmd.CommandTimeout = 1200 'Seconds

''cmd.Parameters.Append cmd.CreateParameter_(fName1, fName2, fName3, fName4)
Call cmd.Execute(Parameters:=Array(fName1, fName2, fName3, fName4), Options:=adCmdStoredProc)

End Sub 
```

任何帮助，将不胜感激。太感谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T17:12:22.230

这将帮助您遍历文件夹中的 .csv 文件。

```
Option Explicit

Sub LoopThroughFiles()

    Dim strFile As String, strPath As String

    strPath = "E:\Analytics\"
    strFile = Dir(strPath & "*.csv")

    While strFile <> ""

        '-> code upload the file to SQL Database

        strFile = Dir

    Wend

End Sub 
```

如果您需要更多细化，例如您只想要`.csv`文件夹中的某些文件，请在后面添加一条语句`While strFile <> ""`以清除您不想要的任何文件。就像是：

```
If InStr(1, strFile, "myName") > 0 Then
   '-> code to upload the file to SQL database
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-28T12:44:41.553

我用

```
SearchFile = Dir(SearchFolder & "*.csv") 
```

第一次通过代码成功仅选择 .csv 文件的行，但是当我使用遍历文件夹中的所有文件时

```
SearchFile = Dir 
```

在每个循环中，它选择其他文件类型，我还没有找到强制该行代码仅选择 .csv 的方法。所以我的解决方法是在检查它之后立即添加一个 IF 语句

```
 SearchFile = Dir         
CheckFile:
     If Right(SearchFile, 3) <> "csv" Then
         SearchFile = Dir
         GoTo CheckFile
     End If 
```

这样，如果文件夹中有其他文件类型，它就会跳过它们。我使用这种格式是因为我的子代码中有其他代码，但它可以重写为

```
CheckFile:
     SearchFile = Dir
     If Right(SearchFile, 3) <> "csv" Then
         GoTo CheckFile
     End If 
```

# unit-testing - Zend studio - 运行相关的单元测试

> ID：12182964
> 
> 赞同：1
> 
> 时间：2012-08-29T16:59:51.523
> 
> 标签：unit-testing, zend-studio

假设我有：

*   MyClass.php 定义了 MyClass
*   MyClassTest.php 定义了扩展 PHPUnit_Framework_TestCase 的 MyClassTest。

在 Netbeans (7.2) 中，在 MyClass.php 中，我可以点击键盘快捷键让它运行任何相关的单元测试。Netbeans 将查找任何具有相同名称并以Test 作为后缀的类（例如，MyClassTest 用于类MyClass），如果找到一个，它将运行它，如果找到很多，它会提示我运行哪一个。

我觉得这很有用，我想知道是否可以在 Zend Studio 9 中做同样的事情？

# php - Wordpress - 将页面变成帖子并显示所有父母的孩子，同时删除父母。

> ID：12182965
> 
> 赞同：0
> 
> 时间：2012-08-29T16:59:51.673
> 
> 标签：php, loops, wordpress-theming, wordpress

是）我有的：

*   家
*   关于
    *   项目
        *   项目页面 1
            *   项目一
        *   项目页面 2
            *   项目 2
        *   项目页面 3
            *   项目 3

我想循环浏览项目子页面，以便按所有子项目中最近的顺序显示页面，然后能够回显或拉出自定义字段，

```
<?php the_title();?> 
<?php the_excerpt();?> 
```

但是，我不想实际显示父页面，例如项目 1 或项目 2 或项目 3 等。

尝试了很多事情，但似乎无法使用 array_merge 或 wp_list_pages 来做到这一点。

任何帮助都会阻止我把头发拉出来。非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:41:47.113

阅读下面的 URL，我非常确定它对您很有帮助。

**如何在 WordPress 类别页面上从子类别中排除帖子**

[http://thesistut.com/2012/exclude-posts-from-children-category/](http://thesistut.com/2012/exclude-posts-from-children-category/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T14:50:31.180

我找到了怎么做。我使用了以下代码。我希望它可以帮助某人。

```
<?php
$args=array(
'post_type' => 'page',
'post__in' => array(345, 289),
'post_status' => 'publish',
'posts_per_page' => 2,
'caller_get_posts'=> 1
);
$my_query = null;
$my_query = new WP_Query($args);

if( $my_query->have_posts() ) {

while ($my_query->have_posts()) : $my_query->the_post();

?> 
```

这产生了 2 个页面作为页面，来自特定类别而不显示父级，避免使用`wp_list`但使用`new WP_Query`and `$args`。它作为临时修复工作，但确实有效。

# android - 屏幕锁定时当前活动消失

> ID：12182966
> 
> 赞同：1
> 
> 时间：2012-08-29T16:59:55.873
> 
> 标签：android, android-manifest, android-activity, android-lifecycle

所以这是我的活动。

```
<activity
            android:name=".MainActivity_Hard"
            android:configChanges="keyboardHidden|orientation|screenSize"
            android:label="@string/title_activity_main_activity__hard"
            android:noHistory="true"
            android:screenOrientation="portrait" >
        </activity> 
```

我将其标记为 android:noHistory="true" 因为我不希望将屏幕添加到活动堆栈中。

但是，当我锁定屏幕并解锁时。活动消失并出现上一个屏幕。这不应该发生。谁能告诉我为什么。

注意：它发生在 ICS（Samsung Galaxy Note）中，但不会发生在以前的设备（Gingerbread 等）中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T05:16:31.170

在您的活动中设置 noHistory 属性意味着一旦用户离开该活动 - 调出锁定屏幕 - 它的完成（）函数会自动调用，从而破坏它并返回到产生的前一个活动它。

这通常用于启动屏幕类型的活动，例如，仅充当启动器，并且您不希望用户能够从孩子返回到启动屏幕。

如果这不是您的意图，那么您应该考虑删除 noHistory 属性并自己管理活动生命周期。（例如，如果您不希望您的活动在堆栈中，那么只需在它开始另一个活动之后调用 finish() 。）

> [机器人：无历史](http://developer.android.com/guide/topics/manifest/activity-element.html#nohist)
> 
> 当用户离开它并且它在屏幕上不再可见时，是否应该从 Activity 堆栈中删除并完成（调用它的 finish() 方法） - 如果应该完成，则为“true”，如果应该完成，则为“false”如果不。默认值为“假”。“真”值意味着活动不会留下历史痕迹。它不会保留在任务的活动堆栈中，因此用户将无法返回它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:07:34.790

我不知道为什么。但是，如果您不想将此活动添加到当前堆栈。您可以设置 android:launchMode="singleTask"。当启动这个活动时，它将被添加到它自己的堆栈中。你可以在这里看到更多在这里[输入链接描述](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode) 希望它有帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T04:57:26.153

在 AndroidManifest.xml 中，将此权限标记放在应用程序标记上方。

```
<uses-permission android:name="android.permission.WAKE_LOCK" /> 
```

# asp.net-mvc - NHibernate 更新问题

> ID：12182969
> 
> 赞同：0
> 
> 时间：2012-08-29T17:00:07.780
> 
> 标签：asp.net-mvc, nhibernate, fluent-nhibernate, nhibernate-mapping

我有客户、客户组、组表。Customer 与 CustomerGroups 有 1:n，Groups 与 CustomerGroups 有 1:n。在创建客户屏幕中，用户可以选择现有客户的组信息。因此，当我创建新客户时，我正在从现有客户中检索组并添加它们

```
///
Customer cust = new Customer();
foreach(var item in getothercustomergroups())
cust.groups.add(item);
commit 
```

此代码正在生成更新语句并使用新添加的 customerid 更新 customergroups 表，而不是使用新的 customerid 插入新记录。因此，所有具有 prev 的组。客户走了。谁能解释一下这种行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:54:14.477

根据您的描述，我猜 getcustomergroups 已经通过 NHibernate 从现有客户那里获得了客户组。如果是这样，NHibernate 已将 foreach 循环中的每个项目与现有客户相关联，因此当您将项目添加到新客户时，新客户将承担该项目的所有权。

您可以通过克隆项目来避免这种情况。请参阅[如何使用 NHibernate 复制对象](https://stackoverflow.com/questions/4056327/how-do-i-copy-an-object-with-nhibernate)

# javascript - 在 DIV 中动态插入 HTML 并访问新元素

> ID：12182979
> 
> 赞同：0
> 
> 时间：2012-08-29T17:00:45.843
> 
> 标签：javascript, jquery, html

我正在使用 jQuery 将远程 HTML 加载到 DIV 中，并且需要访问其中包含的所有元素和 JS。似乎插入的 HTML 已添加并正确呈现，但元素不在 DOM 中。如何访问这些新元素？使用 document.getElementById('myDiv') 返回 null

var canvas .. 在下面的脚本中返回 null，我不明白为什么。

```
<script>

function draw(){
  var canvas=document.getElementById("pdf1");
  var pdf=canvas.getContext("2d");
// other code here populates canvas.....

}

</script>

<body>
<div>
<canvas  id="pdf1" width="801" height="1041"></canvas>
</div>
</body>
<script type="application/javascript">
$(window).load(draw());
</script>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:12:31.467

```
$('#new_html_wrapper').load('file.html', function(){

    // Access the new DOM elements here inside the load callback.

    $(this).on('#myDiv','click',function(){
        alert('You clicked on myDiv!');
    });

    $('#myDiv', this).css('background','red');

});

// Accessing the elements here will fail as they haven't been loaded yet. 
```

阅读更多：[http ://api.jquery.com/load/](http://api.jquery.com/load/)

也不要使用`document.getElementById('myDiv')`.

你已经加载了 jQuery，所以这样做：`$('#myDiv')`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:06:55.540

在插入 HTML 之前，您会尝试获取内容。
您应该尝试在插入内容后访问该元素。即如果你在插入内容后调用相同的函数，你可以得到div中的内容。

或者，如果您想在稍后出现的内容（如您的情况下插入数据）上绑定一些事件，如点击，您可以实时绑定事件，如下所示

$("div.className").live("click",function(){ alert('1'); })
或
$("document").on("div.className","click",function( ){ 警报('1'); })

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T17:02:46.883

如果您需要将事件绑定到这些新元素，请使用[.on() 函数](http://api.jquery.com/on/)

# c# - 生成与输入参数相关的随机数

> ID：12182983
> 
> 赞同：0
> 
> 时间：2012-08-29T17:00:52.847
> 
> 标签：c#, random

```
public float randomNumber(float x, float y, Random rnd)
{
    //Return a random number between 0 - 1
} 
```

所以我的问题是我需要随机数与 x 和 y 相关。如果我传入 x = 10, y = 5 并且当我再次传入 x = 10, y = 5 时得到 0.34567f，我需要再次得到 0.34567f 的结果。有谁知道这样做的方法？

**编辑：**根据下面的回复，我意识到我遗漏了一些东西。我传入 Random 对象的原因是它已在其他地方预先播种。因此，如果我为种子为 50 的随机对象传入 x = 10, y = 5 并输出 0.34567f 对种子为 51 的随机对象做同样的事情应该会给我一些不同的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T17:04:29.347

您可以将它们用作种子：

```
int seed = 
    BitConverter.ToInt32(BitConverter.GetBytes(
        x * 17 + y
    ));
new Random(seed).NextDouble(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T17:04:01.063

使用 x 和 y 作为种子值

```
public float RandomNumber(float x, float y)
{
    var rnd = new Random(x.GetHashCode() ^ y.GetHashCode());
    return (float)rnd.NextDouble();
} 
```

* * *

注意：`^`运算符对 x 和 y 的位执行 XOR 运算。

* * *

**更新**（回应 SLaks、Servy 和 Scott Chamberlain 的评论）

您的“随机数”根本不是随机数。您可能需要的是哈希码

```
public Hash(float x, float y)
{
    unchecked {
        return Math.Abs((527 + x) * 31 + y) % 1.0f;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T17:09:26.677

看来您真正需要的是哈希，而不是随机数。如果您需要基于两个浮点数的随机数*序列*，那么我建议使用这两个浮点数来制作种子，但是当您只需要一个效率低得多且对哈希也不是特别好的值时。你可以试试这样的。

```
public float GetHashCode(float x, float y)
{
    float somePrimeNumber = 17.0
    return Math.Abs(1.0 / (x.GetHashCode() * somePrimeNumber + y.GetHashCode() + 1));
} 
```

# org-mode - org-mode 的 noweb 风格文学编程中的 HTML 锚

> ID：12182988
> 
> 赞同：4
> 
> 时间：2012-08-29T17:01:09.667
> 
> 标签：org-mode, literate-programming, org-babel

这是我在 org 模式下的简单 C 源代码。

```
#+name: hello_one.c
#+begin_src C :noweb tangle :tangle hello_one.c
#include <stdio.h>

int main()
{
  printf("Hello, world!\n");
  reurn 0;
}
#+end_src 
```

也许我可以把整个事情分成很多块。

```
#+name:hello.c
#+begin_src C :noweb tangle :tangle hello.c
<<include>>
<<main>>
#+end_src

#+name: include
#+begin_src C
#include <stdio.h>
#+end_src

#+name: main
#+begin_src C 
int main()
{
  printf("Hello, world!\n");
  reurn 0;
}
#+end_src 
```

我可以成功地将它*缠结*成一个源代码“hello.c”，并且我可以成功地将它*编织*成一个 html 文档。但我想要一个 HTML 锚，正如您在[LiteratePrograms wiki](http://en.literateprograms.org)中看到的那样。一个例子是关于[Fibonacci Numbers](http://en.literateprograms.org/Fibonacci_numbers_%28C%29)的文章。

1.  正如您在此页面中看到的，您可以单击每个块名称（例如，'includes'、'fib'、'fastfib' 和 'main.），然后将您带到该块描述。

2.  并且每个块描述的名称都显示在开头。例如，如果您在有关斐波那契数的 LiteratePrograms 文章中点击锚点[“fib”](http://en.literateprograms.org/Fibonacci_numbers_%28C%29#chunk%20def%3afib)，它会为您带来块描述，并且该块以块名称“fib”开头。

有什么办法可以实现这两个功能？

# detect - 检测已被 Adblock Plus 删除的 JavaScript 横幅

> ID：12182991
> 
> 赞同：0
> 
> 时间：2012-08-29T17:01:17.867
> 
> 标签：detect, banner, banner-ads

AdBlock Plus 使用 MozBinding 来显示横幅已被删除。不幸的是，JavaScript 横幅并非如此。在那里，Adblock Plus 只是删除了将加载横幅的源代码。

遇到这个问题的人可能有解决方案或想法？

# javascript - 在其他页面上使用 JavaScript 发布

> ID：12182992
> 
> 赞同：0
> 
> 时间：2012-08-29T17:01:27.760
> 
> 标签：javascript, post, get

我得到了这个脚本来从这里获取带有获取请求表单的 [友好 URL... 带有获取请求表单的友好 URL](https://stackoverflow.com/questions/4507890/friendly-url-with-get-request-form) 这里是脚本

```
<form id='contactus' action='search_out.php' method='get' accept-charset='UTF-8'>
 <input type="text" name="first" value="" id="first">
    <input type="text" name="second" value="" id="second">
    <input type="text" name="third" value="" id="third">

    <p><input type="button" value="Continue &rarr;" onclick="submitFriendly();"></p>
</form>
<script type="text/javascript">
function submitFriendly() {
window.location.href = window.location.href  + '/Search/' + document.getElementById('first').value + '/' + document.getElementById('second').value + '/' + document.getElementById('third').value;
}
</script> 
```

我不擅长 javascript ...我想将此发布到新页面，即 search_out.php 但此脚本发布在同一页面上...有没有办法在其他页面上发布...

请帮助谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:07:21.733

脚本所做的是获取当前位置。给它一个新的。

```
window.location.href = "search_out.php/"+document.get....... 
```

# android - 将 arraylist 的每个元素显示到 setText

> ID：12182993
> 
> 赞同：0
> 
> 时间：2012-08-29T17:01:29.083
> 
> 标签：android, list, android-intent, arraylist

我想将 arraylist 的每个元素或值显示到 tv.setText。

arraylist 的值来自第一个活动（第一个屏幕），我想将它传递给第二个活动（第二个屏幕）的 tv.setText。

这是第一个活动的代码

```
List<String> class_code = new ArrayList<String>();
class_code.add("test");
class_code.add("test2");
Intent intent = new Intent(1stscreen.this,2nd_screen.class);
intent.putStringArrayListExtra("code", (ArrayList<String>) class_code); 
```

这是第二个活动的代码

```
tv.setText(getIntent().getExtras().getString("code")); 
```

但它显示了arraylist的所有值（test和test2）我只想得到arraylist的第一个值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T17:03:12.763

要在 TextView 中仅显示 ArrayList 中的一项，您只需传递*第一*项：

```
List<String> list = getIntent().getExtras().getStringArrayListExtra("code");
tv.setText(list.get(0)); 
```

如果你只打算在下一个 Activity 中使用这*一个*String，不要传递整个 ArrayList，只传递你要使用的 String：

```
Intent intent = new Intent(1stscreen.this, 2nd_screen.class);
intent.putString("code", class_code.get(0)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T13:08:20.393

我需要将值从第一个屏幕转发到第三个屏幕，所以我使用它解决了

第一个屏幕

```
intent.putStringArrayListExtra("class_code", (ArrayList<String>) class_code); 
```

第二屏

```
intent.putStringArrayListExtra("class_code", getIntent().getExtras().getStringArrayList("class_code")); 
```

第三屏

```
tv.setText(getIntent().getExtras().getStringArrayList("class_code").get(0)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T17:07:36.440

用这个：

```
List<String> list = getIntent().getStringArrayListExtra("code");
tv.setText(list.get(0)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T17:03:31.020

如果您只想要一个值，请使用此类 class_code.get(0)

```
intent.putString("code", class_code.get(0)); 
```

你可以从下一个活动中得到它

```
getintent().getExtras().getString("code"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T17:03:43.153

如果只想使用第一个值，则只传递第一个值。代替

```
intent.putStringArrayListExtra("code", (ArrayList<String>) class_code); 
```

试着把

```
intent.putStringExtra("code", class_code.get(0)); 
```